# StackOverflow 问答 10957000-10957999

# mysql - 如何将重复行更改为mysql中的唯一值？

> ID：10957000
> 
> 赞同：4
> 
> 时间：2012-06-08T23:06:36.203
> 
> 标签：mysql, unique

我有一个包含大约 1M 条记录的数据库表。我需要在此表中找到所有重复的名称并使它们唯一。

例如...

```
Id   Name
-----------
1    A
2    A
3    B
4    C
5    C 
```

应该改成...

```
Id   Name
-----------
1    A-1
2    A-2
3    B
4    C-1
5    C-2 
```

有没有一种有效的方法可以通过 mysql 查询或过程来做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-27T22:31:51.380

这有点棘手..我在本地主机上进行了测试，它可以满足您的需求..如果您有任何问题，请告诉我。[SQL 小提琴](http://sqlfiddle.com/#!2/dcd4661/10)

```
UPDATE temp t1, 
(
    SELECT 
        id as unique_id, 
        new_name 
    FROM(
        SELECT
          id,
          IF(@ROW = Name, @COUNT, @COUNT := 1),
          CONCAT(Name, ' - ', @COUNT) AS new_name,
          @ROW := Name,
          @COUNT := @COUNT + 1
        FROM temp
        JOIN (SELECT @COUNT := 0, @ROW := "") AS t
        WHERE Name IN(SELECT Name FROM temp
        GROUP BY Name
        HAVING COUNT(Name) > 1)
    ) AS temp_test
) as testing
SET t1.Name = testing.new_name where t1.id = testing.unique_id 
```

最终输出如下所示：[图片](http://screencast.com/t/nbXWEe3TPBM)

* * *

**编辑：** 为了性能，这可能会更好

**1.**首先运行这个查询

```
SET SESSION group_concat_max_len = 1000000;  -- longer if needed
SET @query1 := (
SELECT 
    GROUP_CONCAT(DISTINCT unique_name) 
FROM temp
JOIN(
    select Name as unique_name
    FROM temp
    GROUP BY name
    HAVING COUNT(Name) > 1
) as t
); 
```

**2.**然后运行此更新

```
UPDATE temp t1, 
(
    SELECT 
        id as unique_id, 
        new_name 
    FROM(
        SELECT
          id,
          IF(@ROW = Name, @COUNT, @COUNT := 1),
          CONCAT(Name, ' - ', @COUNT) AS new_name,
          @ROW := Name,
          @COUNT := @COUNT + 1
        FROM temp
        JOIN (SELECT @COUNT := 0, @ROW := "") AS t
        WHERE FIND_IN_SET (`name`, @query1)
    ) AS temp_test
) as testing
SET t1.Name = testing.new_name where t1.id = testing.unique_id 
```

我在我的本地测试了它并且它有效，所以你应该能够让它运行:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T17:20:20.930

```
UPDATE    table_x AS upd
    SET   upd.Name = CONCAT(upd.Name, '-', upd.Id)
    WHERE upd.id IN(
                    SELECT    sel.id
                        FROM  table_x AS sel
                        WHERE sel.Name = upd.Name
                          AND sel.Id != upd.Id
                 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-28T04:30:47.690

首先，您应该将重复的 Id 存储在临时表中。

* * *

```
Drop temporary table if not exist temp; 
```

* * *

```
Create temporary table temp (
Select max(id)'id' from table_x group by Name having count(*)>1
); 
```

* * *

```
Delete from table_x as x,temp as t where x.id = t.id; 
```

只需重复执行此操作...在为名称字段设置唯一键之后，您将获得唯一行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-10T08:10:16.423

一个可读的解决方案

```
CREATE TEMPORARY TABLE duplicate_names
SELECT name FROM records_table
GROUP BY name
HAVING count(name) > 1;

SET @row_number = 1;
SET @name = '';
CREATE TEMPORARY TABLE duplicates
SELECT 
CASE 
WHEN @name = name THEN @row_number:=@row_number + 1
  ELSE   
    @row_number:=1 
END AS identifier,
@name:=name AS name,id 
FROM
    records_table WHERE name IN (SELECT name FROM duplicate_names)
ORDER BY records_table.name;

UPDATE records_table INNER JOIN duplicates 
ON records_table.id = duplicates.id
SET records_table.name = 
CONCAT(duplicates.name,'-',duplicates.identifier); 
```

# xml - 避免多次调用 ImportXML

> ID：10957001
> 
> 赞同：0
> 
> 时间：2012-06-08T23:06:44.850
> 
> 标签：xml, xpath, google-sheets, google-sheets-importxml

我有一个谷歌电子表格，我用它来监控几个 YouTube 视频。对于每个视频，我使用 ImportXML 从各个 YouTube 视频页面中获取以下数据：

*   标题
*   意见
*   关键词

要清楚 - 我以这种方式使用 ImportXML 没有问题。这种方法效果很好。问题是这些单独的数据中的每一个都使用它自己的 ImportXML 调用。这将我限制为 16 个视频，因为 Google 对每张表设置了 50 个调用的合理限制。3 个数据 * 16 个视频 = 48 个呼叫，比最大值少 2 个。

我想我想做的是为每个视频打一个电话，抓取整个 HTML，将其填充到一个隐藏的单元格中，然后解析该单元格以获取数据。这样我就可以抓取 50 个视频，这显然更具吸引力。

我有计划，但不知道我是否可以用这种方式使用 XPath 解析 CELL。我看到的文档似乎不允许以这种方式使用 XPath，但这似乎很明显。有没有人这样做过，还是我在吠叫错误的树？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T14:40:17.137

在单个 importXML 调用中不能有多个 XPath 表达式。

您可以通过以下任一方式获得您的功能：

*   操纵您的 URL - 您可以调用特定的搜索页面，而不是调用视频页面。例如：`http://www.youtube.com/results?search_query=<your-user-name>`并使用特定的 XPath 表达式获取每一列，一次用于所有视频

*   拥有更通用的 XPath - 提取包含您的信息的所有标签，然后过滤您需要的标签。

# ant - 有没有办法使用 p4change Ant 任务设置多行描述？

> ID：10957006
> 
> 赞同：0
> 
> 时间：2012-06-08T23:07:16.977
> 
> 标签：ant, perforce

当我尝试以下操作时：

```
 <exec executable="ls" outputproperty="aoeu"/>
  <p4change description='${aoeu}'/>
  <echo message='${p4.change}'/> 
```

似乎 p4change 默默地失败了，上面的输出：

```
 [echo] ${p4.change} 
```

有没有办法使用 p4change Ant 任务设置多行描述？

FWIW，我们使用 Ant 1.8.2 和 Perforce Server 版本：P4D/LINUX26X86_64/2010.2/284433 (2011/01/28)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T20:01:12.437

我有幸直接从 Perforce 使用 P4Ant 库。

这是我的示例脚本：

```
<project name="p4ant-job" default="p4tasktest" basedir=".">
    <description>
        Perforce task test
    </description>

    <property name="p4.client" value="bruno_ws"/>
    <property name="p4.port" value="localhost:5000"/>
    <property name="p4.user" value="bruno"/>
    <property name="p4.passwd" value="brunopass"/>

    <taskdef resource="com/perforce/p4java/ant/tasks/P4Tasks.properties"
        classpath="p4ant-2010.1.293250.jar;p4java-2010.1.269249.jar" />

    <target name="p4tasktest" description="Perforce task test">
        <exec executable="ls" outputproperty="mydesc"/>
        <echo>${mydesc}</echo>
        <p4jchange
            description="${mydesc}"
            property="mycl">
        </p4jchange>
        <echo>Created ${mycl}</echo>
    </target>

</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T01:36:29.383

我不是 perforce 人，但其他人可能会发现您正在使用的软件版本（ANT 和 Perforce）有用。

谷歌搜索发现以下错误：

*   [https://issues.apache.org/bugzilla/show_bug.cgi?id=33260](https://issues.apache.org/bugzilla/show_bug.cgi?id=33260)

以及下面的邮件讨论

*   [http://markmail.org/message/ljglmkzffjdvswta](http://markmail.org/message/ljglmkzffjdvswta)

# ruby - 按包含值的长度对哈希进行排序

> ID：10957012
> 
> 赞同：6
> 
> 时间：2012-06-08T23:08:26.650
> 
> 标签：ruby

假设我有一个像这样的哈希：

```
foo = {
  :bar => ['r', 'baz'], # has a total str length of 4 characters inside of the array
  :baz => ['words', 'etc', 'long words'] # has a total str length of 18 characters inside of the array,
  :blah => ['at'] # has a total str length of 2 characters inside of the array
  # etc...
} 
```

我将如何按数组中包含的项目的总字符串长度对该哈希进行排序？在这种情况下，生成的哈希顺序应该是：`:blah, :bar, :baz`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-08T23:59:56.340

我会这样做：

```
Hash[foo.sort_by { |k, v| v.join.length }] 
```

我假设您不打算更改原始哈希值，只需重新排序即可。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T23:43:47.477

传统上，哈希没有排序，因此不可排序。Ruby 1.9 散列是有序的，但该语言没有提供重新排序元素的简单方法。就像在 1.8 中一样，对哈希进行排序会返回一个对数组：

```
{ c:3, a:1, b:2 }.sort => [ [:a,1], [:b,2], [:c,3] ] 
```

（实际上，1.8 会对此感到震惊，因为符号在 1.8 中无法比较，但没关系。）

但只要您对配对列表没问题，您就可以按您喜欢的任何方式对哈希（或数组）进行排序。只需使用 sort_by 并传递一个提取排序键的块，或者将 sort 与一个进行比较的块一起使用：

```
foo.sort_by { |key, strings| strings.join.length } 
```

或者，如果您首先想要最长的：

```
foo.sort_by { |key, strings| -strings.join.length } 
```

然后，如果您使用 1.9 并希望将结果转换回哈希，您可以这样做（感谢 Jörg W Mittag）：

```
Hash[ foo.sort_by { |key, strings| strings.join.length } ] 
```

...这与 d11wtq 的答案相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T23:42:53.870

```
 foo.sort_by { |_,v| v.reduce(:+).size } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T23:46:18.263

哈希在其概念中并不能确保键的顺序。但是在 Ruby 1.9 中，[Hash 的键顺序被保存了](http://www.igvita.com/2009/02/04/ruby-19-internals-ordered-hash/)。因此，如果您使用 1.9，则可以在其他答案中使用代码。

但我不想推荐依赖这种行为，因为它是隐含的行为，我害怕未来的变化。相反，使用按字符串长度总和的顺序产生哈希条目的方法。

```
def each_by_length(hash)
  hash = hash.sort_by { |_, strs| strs.map(&:length).inject(0, &:+) }
  hash.each do |k, v|
    yield k, v
  end
end 
```

# zend-framework - Zend Framework 内存使用与 ZfDebug

> ID：10957017
> 
> 赞同：1
> 
> 时间：2012-06-08T23:08:48.200
> 
> 标签：zend-framework, caching, optimization, doctrine, doctrine-orm

在我的应用程序开发中，我们安装了 ZFDebug。它在工具栏中显示基准测试结果，例如加载时间和内存使用情况，我觉得这非常有用。

我的应用程序平均使用大约 19000k 内存。

该应用程序使用 Doctrine 2 和 DQL 创建配置文件和主页提要结果。填充结果后，内存使用量可能高达 22000k 内存。

该应用程序还具有加载资源的复杂模块化结构，例如 javascript 库和其他使用插件的外部库。

就目前而言，我们还没有实现 Zend_Cache 进行优化。

我对如何使用这些基准测试结果进行应用程序优化有点困惑。我应该如何判断内存使用是否可以接受？例如，典型的 zend 框架应用程序内存使用情况是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:17:32.560

哦，美好的旧时光。那也是我的问题。

我从 2007 年开始使用 ZF。内存使用一直是 ZF 的问题。对于 ZF 中的简单 MVC，16-17M 是“正常的”。如果你添加 Doctrine，它会上升到 20M - 就像你说的那样。

首先，在您的服务器上安装 APC。这是最重要的事情，因为即使在默认设置下它也能加速一切。测量页面加载时间。在 APC 之后，您将至少获得 30% 的性能。

之后使用 Zend_Cache 和 APC 后端。Doctrine 允许缓存查询、结果和水合。也可以将它们与 APC 一起使用。

我看到你正在使用 ZFDebug。分析 Doctrine 查询并对其进行优化。在适当的地方添加索引。

我总是站在“可管理性优于性能”的一边。是的，采埃孚很慢。是的，Doctrine 让它变慢了。但是我的项目的规模需要使用框架和 ORM 以及依赖注入容器 ETC。所有这些都使我能够快速开发项目。

我是[Gazi 大学网页](http://gazi.edu.tr/)的开发者。自去年以来，我尝试将静态网页转换为我们所有学术和行政单位的 CMS。例如[iibf.gazi.edu.tr](http://iibf.gazi.edu.tr)和[bidb.gazi.edu.tr](http://bidb.gazi.edu.tr)使用相同的模板、相同的 CMS 和相同的数据库，但所有站点都有自己的子域。

哦，男孩，网站“上线”的那一天，我快死了。页面加载时间为 15 秒。15 秒。谷歌网站管理员工具说我比整个互联网慢。每个人都有超时。VM 的所有内核都以 100% 的速度工作。我什至无法通过 SSH 连接到机器！

页面上的每一部分都可以通过 CMS 管理界面进行控制（如果您可以登录到管理区域：D）。顶部的蓝色菜单？来自 CMS。消息？来自 CMS。公告？来自 CMS。快速链接区？来自 CMS。带有图标的快速链接？来自 CMS。甚至 twitter/facebook/youtube 链接都来自 DB，因为每个部门的链接都不同。

真正奇怪的部分是什么？我正在使用缓存！我正在缓存我在上一段中计算的每个部分。

现在？谷歌分析网站速度图在 1.5 秒内持平。谷歌网站管理员工具说我比互联网上 91% 的网站都快。该网站每天有 6 万访问者。

这是您可以做的一些事情的列表。但不要一次做所有事情。做一件事。测量新指标并迭代：

1.  配置您的页面。查看哪些代码会减慢页面速度。使用 Xdebug 和 CacheGrind。例如，如果您正在使用 Zend View 部分......只是不要使用它。使用 $this->render()。但是在你测量它之前，你无法知道是什么让你放慢了速度。做剖析！

2.  使用操作码缓存。正如我所说，APC 对于操作码缓存很酷。优化它。例如，禁用 apc.stat 设置，它会加快速度。（stat 检查文件是否在第一次缓存后发生更改，但它需要磁盘搜索并减慢速度。如果禁用此设置，速度会加快。但您必须在更改 PHP 文件后重新启动 PHP）

3.  数据库是另一个缓慢的东西。缓存结果集。没有人关心新闻条目在插入数据库后是否会延迟 1 分钟。相信我，即使是 1 分钟的缓存也会有所作为。

4.  使用 CDN 或至少配置您的 Web 服务器以设置静态内容的过期时间 +1 年。并从静态内容中删除会话 ID。静态内容需要 +1 年。去做吧。例如，我们有一个 620x327 jpg 横幅，它是我们总页面重量的 %20。

5.  了解您的网络堆栈的设置。配置 MySQL、Apache、PHP、PHP-FPM、Apache、Nginx 或任何你使用的东西。但是一次更改一个设置并测试至少 100 次。某些设置在第一次刷新时不会产生问题。

6.  跟踪您的指标。使用 strace、top、iostat、vmstat、htop 等。如果 mysql 总是使用 CPU 周期，则意味着您没有缓存查询结果。

7.  删除未使用的模块：删除 !#@$ LDAP 模块！你没有使用它。如果有一天你需要使用它，它一个“apt-get”，“yun install”就可以了。

8.  您的主页是最重要的。真实故事：我们的主页每月获得 200 万次浏览。下一个访问量最大的页面只有 420k。为您的主页使用“整页缓存”。但是不要忘记您不能使整页缓存无效，因为它是基于 URL 的，甚至不会触及您的 MVC 堆栈。正如我之前所说，将其缓存 1 分钟。即使是 1 分钟，对于高流量的网站也会产生巨大的影响。

9.  将尽可能多的工作推送到客户的计算机上。Google 不关心我们医学院实验室的 620x327 px jpg。甚至我们的访客也不在乎。在使用 AJAX 加载页面后加载它们。

这就是我能从我的经历中记住的一切。

# mongodb - 您如何决定何时在 MongoDB 中创建集合和嵌入文档？

> ID：10957018
> 
> 赞同：0
> 
> 时间：2012-06-08T23:08:53.387
> 
> 标签：mongodb, nosql

我目前正在通过 MongoDB 学习 noSQL，但我的学习和工作经验是使用关系数据库。

我目前有一个用户集合，我需要实现存储用户个人资料页面的网页点击量以及大约 5 个更多统计信息的功能。

我应该创建一个新集合来存储此信息，还是应该创建一个嵌入式文档来将这 6 条信息存储在用户集合中？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T05:40:51.340

创建嵌入式文档，直到它们不再适合包含在一个集合中。与用户文档相关的统计信息对存储嵌入内容是 100% 有意义的。简单地说......用户个人资料有统计数据。这些统计数据对任何其他集合都没有任何意义。

如果您最终拥有一个确实需要引用的集合，因为许多不同的集合可能会引用单个文档，那么将其拆分为一个集合并使用 id 引用是有意义的。当您开始考虑在一个嵌入式文档中更改某些内容时必须更新许多其他文档时，移动到一个唯一的集合可能会很好。这样每个文档只引用一个id，它可以随时更改其文档数据。

# c# - 如何修复从删除条件注释中删除 HTML 注释的正则表达式？

> ID：10957019
> 
> 赞同：3
> 
> 时间：2012-06-08T23:08:54.917
> 
> 标签：c#, regex

我有以下代码：

```
source = Regex.Replace(source, "<!--.*?-->", string.Empty, RegexOptions.Singleline | RegexOptions.IgnoreCase | RegexOptions.Compiled); 
```

...它工作正常，除了它还去掉了条件注释：

```
<!--[if IE]>???<![endif]--> 
```

有人可以告诉我如何更新正则表达式，使其不删除条件注释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T23:25:10.510

您可以使用[负前瞻和负前瞻](http://www.regular-expressions.info/lookaround.html)：

```
<!--(?!\[).*?(?!<\])--> 
```

应该只匹配`<!--`后面不带 [ 和`-->`前面不带 ] 的，当然还有 .*? 匹配中间的文本。

使用[Derek Slager](http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx)非常有用且快速的 RegEx 测试器进行了测试：

源文本：

```
<!--[if IE]>???<![endif]--> 
<!--Comment--> 
```

图案：

```
<!--(?!\[).*?(?!<\])--> 
```

结果：

找到 1 个匹配项：

```
1\. <!--Comment--> 
```

# asp.net-mvc-3 - Asp.net MVC 3 多对多关系使用 jquery 自动完成创建新项目

> ID：10957020
> 
> 赞同：1
> 
> 时间：2012-06-08T23:09:03.380
> 
> 标签：asp.net-mvc-3, many-to-many, jquery-autocomplete

我是 asp.net mvc 的新手，正在尝试创建一个简单的网站。有一个带有标签的帖子具有多对多关系。我已经阅读了[msdn](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)上的教程哦，如何做多对多，但我不明白。我想要做的就是在创建新帖子时，能够使用关键字标记帖子，就像在此网站上创建帖子的工作方式（stackoverflow）一样。我想让 jquery 在标签文本框中自动选择，然后在创建项目时在连接表中创建适当的条目。

所以我的问题是：

1.  如何在标签文本字段上设置 jquery 自动完成
2.  何使用选定的标签创建一个新帖子（在连接表中）

我已经看到了几个创建多对多的示例，您可以在其中从复选框中选择标签，但在这种情况下这是不切实际的，因为将有数百个标签可供选择。

```
public class Post
{
    public int PostId { get; set; }
    public string Title { get; set; }
    public string Content {get; set;}
    public virtual ICollection<Tag> Tags { get; set; }
}

public class Tag
{
    public int TagId { get; set; }
    public int Title { get; set; }
    public virtual ICollection<Post> Posts { get; set; }
}

public class PostEntities : DbContext
{
    public DbSet<Post> Posts { get; set; }
    public DbSet<Tag> Tags { get; set; }
} 
```

和创建控制器（自动生成）：

```
 [HttpPost]
    public ActionResult Create(Post post)
    {
        if (ModelState.IsValid)
        {
            db.Posts.Add(post);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        return View(post);
    } 
```

剃须刀：

```
@using (Html.BeginForm()) {
@Html.ValidationSummary(true)
<fieldset>
    <legend>Post</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.Title)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Title)
        @Html.ValidationMessageFor(model => model.Title)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Content)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Content)
        @Html.ValidationMessageFor(model => model.Content)
    </div>
    <div>
        <h3>Tags</h3>
        @Html.TextBoxFor(model => model.Tags, new { @id = "NewTags" })
    </div>
    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset> 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T13:42:34.963

如果您想将文本框用作多[选](http://harvesthq.github.com/chosen/)项目，则需要一个 jquery 插件，例如 selected 。然后你可以有一个 viewModel 像：

```
public class PostViewModel
{
    public Post Post { get; set;}
    public virtual ICollection<Tag> Tags { get; set; }
    public virtual ICollection<Tag> relatedTags { get; set; }

//in the constructor you can initialize the list
// with all the tags available in your system
public PostViewModel()
{
        foreach (var tagin new dbContext().Tags.GetList())
        {
            Tags.Add(tag);
        }
} 
```

}

然后在控制器中：

```
[HttpPost]
public ActionResult Create(PostViewModel post)
{
    if (ModelState.IsValid)
    {
        //Enumerate over the related tags selected from view 
        //and add the coincidences to the entity post.Post
        IEnumerator<String> it = post.relatedTags.GetEnumerator();
        while (it.MoveNext())
            post.Post.Tags.Add(db.Tags.Single(tag => tag.TagId == it.TagId));

        //Then you can save your changes to DB
        db.Posts.Add(post.Post);
        db.SaveChanges();
        return RedirectToAction("Index");  
    }

    return View(post);
} 
```

视图可能是：

```
@Html.ListBoxFor(model => model.relatedTags, new MultiSelectList(Model.Tags, "TagId", "Title"),
         new { data_placeholder = "Select related tags", style = "width:300px;", id = "relatedTagsToPost" }) 
```

其中 id "relatedTagsToPost" 由以下方式选择初始化：

```
$("#relatedTagsToPost").chosen(); 
```

就是这样，它没有经过测试，只是从我的项目调整到您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T10:55:22.330

Vic 的回答是一个很好的解决方案，但我更喜欢 Autocomplete jQuery 插件，因为您还可以添加新标签，而不仅仅是从预定义或远程加载的列表中选择标签......

看看：http: [//jqueryui.com/autocomplete/#multiple](http://jqueryui.com/autocomplete/#multiple)

然后，您必须编辑一点控制器的代码，用“，”分割输入标签，然后将它们保存在数据库中。

# c++ - 来自 Mat 的 OpenCV 访问元素

> ID：10957022
> 
> 赞同：5
> 
> 时间：2012-06-08T23:09:15.680
> 
> 标签：c++, opencv

我正在尝试学习 OpenCV，并且作为一个顽固的人，我正在尝试运行以下算法：

```
 cv::Mat cur_features;
 cv::goodFeaturesToTrack(current_image, cur_features, 400, 0.01, 0.01); 
```

现在，作为一个头脑冷静的人，我很想看看 cur_features 持有什么......我期望一个 400x2 cv::Mat 但我得到了一个 400x1 cv::Mat

没什么大不了的，我想也许它是一个直接索引。但是，对于我的一生，我无法从 cur_features.at(0) 中提取值并将其打印出来。

我究竟做错了什么？我看过 goodFeaturesToTrack_Demo.cpp。在那个演示中需要注意的一些事情对我来说是不同的。鉴于该示例，我尝试了以下调用：

```
 std::cout << cur_features.size() << std::endl; // This throws a compile time error even though its in the example
 std::cout << cur_features.at<Point2f>(0).x << std::endl; //This throws a run time error. 
```

谁能指导我阅读一些解释如何实现目标的文档？goodFeaturesToTrack 告诉您它返回一个 OutputArray，它是一个角向量，但它没有描述这些角的类型。如果我用其他方法得到它，我会在文档中的哪里寻找这个答案？

* * *

**编辑：** 另外，Mat::type() 的意义是什么。我找不到可以解释返回值的位置...我正在寻找文档中的枚举，但找不到它。

```
 std::cout << current_image.type() << std::endl; //This returns 0
 std::cout << cur_features.type() << std::endl; //This returns 13 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T11:34:01.220

作为建议，尝试使用维度和类型初始化矩阵

```
 cv::Mat cur_features(400,1,CV_32_FC1); //400x1 32 bits, 1 channel
 cv::Mat cur_features2(400,1,CV_32_FC2); //400x1 32 bits, 2 channels 
```

获取 Mat 的值

```
int pos = 0;
foat value = cur_features.at<float>(pos);
cv::Vec2f value2 = cur_features2.at<Vec2f>(pos); // for a two channel, CV_23F image 
```

还有一种方便的 Visual Studio 调试技术，对我帮助很大

*   1- 调试时右键单击 cur_features。
*   2-快速观看
*   3-写这个：

    (float*)cur_features.data,400

*   4-您将看到数组的所有值

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T23:33:29.470

事实证明，即使我的 goodFeaturesToTrack 返回 400x1，我也是在黑色图像上进行的，因此没有角落。这导致

```
 cur_features.data == NULL 
```

有趣的情况是，C 代码似乎比 C++ 代码更容易且对用户更友好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T23:28:27.590

它在这里说：http: [//opencv.itseez.com/modules/imgproc/doc/feature_detection.html](http://opencv.itseez.com/modules/imgproc/doc/feature_detection.html)

你应该给它一个`vector<Point2f>`作为输出数组。

它在我的本地 OpenCV 副本的 goodFeaturesToTrack_Demo.cpp 中声明为：

```
 vector<Point2f> corners;
  ...
  /// Apply corner detection
  goodFeaturesToTrack( src_gray, 
               corners,
               maxCorners,
               qualityLevel,
               minDistance,
               Mat(),
               blockSize,
               useHarrisDetector,
               k ); 
```

更新：我上面给出的链接使用角~~的模板~~ `OutputArray`参数。[http://opencv.willowgarage.com/documentation/cpp/imgproc_feature_detection.html](http://opencv.willowgarage.com/documentation/cpp/imgproc_feature_detection.html)的 2.1 版本库的文档确实说明了`vector<Point2f>`

# ruby - Rails 3按has_many的计数排序：通过

> ID：10957025
> 
> 赞同：9
> 
> 时间：2012-06-08T23:09:56.897
> 
> 标签：ruby, ruby-on-rails-3, activerecord, tagging

我有一个应用程序，我可以在其中列出项目并为每个项目添加标签。模型**项目**和**标签**的关联如下：

```
class Item < ActiveRecord::Base
  has_many :taggings
  has_many :tags, :through => :taggings
end

class Tagging < ActiveRecord::Base
  belongs_to :item
  belongs_to :tag
end

class Tag < ActiveRecord::Base
  has_many :taggings
  has_many :items, :through => :taggings
end 
```

所以，这种多对多的关系让我可以为每个Item设置**n个**标签，同一个标签可以多次使用。

我想列出按与此标签关联的项目数排序的所有标签。更多使用的标签，首先显示。少用，最后。

我怎样才能做到这一点？

问候。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T04:14:43.157

```
Tag.joins(:taggings).select('tags.*, count(tag_id) as "tag_count"').group(:tag_id).order(' tag_count desc') 
```

试试 desc, asc 看看有什么不同。

我们需要*select*，来拥有 tag_count 列，并且我们需要 tag_count 列来对其应用*顺序*，其余所有直接的*join*和*grouping*。

顺便说一句，你为什么不试试这个[https://github.com/mbleigh/acts-as-taggable-on](https://github.com/mbleigh/acts-as-taggable-on)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T03:58:35.053

您希望有更好的方法，但这对我有用（没有空格）。假设`name`是标签模型的名称属性。

```
foo = Tagging.select("name, count(item_id) as item_count")
      .joins("inner join tags on taggings.tag_id = tags.id")
      .group("name")
      .order("item_count DESC")

foo.each { |r| puts "number of items tagged #{r.name}: #{r.item_count}"}

-->"number of items tagged Bieber: 100"
-->"number of items tagged GofT: 99" 
```

# c++ - 为什么程序调用 strncat() 会产生分段错误？

> ID：10957028
> 
> 赞同：0
> 
> 时间：2012-06-08T23:10:13.117
> 
> 标签：c++, segmentation-fault

我无法弄清楚为什么我的 g++ 编译程序在`strncat()`调用时会出现段错误。

我一直在浏览这个网站和一般的谷歌搜索，发现了许多类似的问题，但没有找到任何适合我的解决方案。这是更大代码的一部分，我只能做很多事情来重新定义变量，因为代码不是我的。

所有这部分代码的目的是在文件的最后一行读取，删除相关数据并连接到 char*

当我运行它时，我在与`strncat(RAM,nextchar,1)`

```
char line[256]={"0"};
char nextchar[10]={"0"};
int length=0;
double rac;
double decc;
bool SPACE=false;
char * RAM="RA: ";
char * DECM="DEC: ";
if(AutoColData.good()){
    while(!AutoColData.eof()) AutoColData.getline(line,256);
    for(int i=0;i<strlen(line);i++){
        nextchar[0]=line[i];
        cout<<line[i];
        if(isspace(nextchar[0])&& !SPACE)   SPACE=!SPACE;
        else if(SPACE && !isspace(nextchar[0])){
            SPACE=!SPACE;
            length++;
        }
        if(length==6) {
          cout<<"\n"<<RAM<<nextchar<<"\n";
          strncat(RAM,nextchar,1);
        }
        else if(length==7) strcat(DECM,nextchar);
    }
} 
```

我知道这里有一些草率的选择（整个“空间”的东西很乱）。但我认为 Seg Fault 没有任何理由。它运行良好，直到使用 strncat() 的行。cout 工作正常，两个字符串都打印并在其中包含正确的数据，但是 strncat 失败。我尝试过使用 malloc()、字符串，但似乎没有任何效果。如果有人能指出我在做什么愚蠢的事情，那将非常有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T23:21:23.777

`RAM`被错误地声明为 a `char *`，而它实际上应该是 a `const char *`: 字符串文字是*只读的*，并且不允许您写入它们。您的`strncat`电话只是未定义的行为。

如果你想要一个可写的字符串，你可以制作一个足够大的 char 数组：（`char RAM[100] = "RA: ";`这将在后面补零），或者更好的是，只需使用`std::string`：

```
std::string RAM = "RA: ";
RAM += nextchar; 
```

# android - 无法使用 PopupWindow 点击键盘

> ID：10957039
> 
> 赞同：1
> 
> 时间：2012-06-08T23:11:41.243
> 
> 标签：android, android-softkeyboard, popupwindow

我动态创建的包含 EditText 的 PopupWindow 具有以下属性：

```
popup.setTouchable(true);  
popup.setFocusable(false); 
```

强制键盘显示：

```
InputMethodManager inputMgr = (InputMethodManager) activity.getSystemService(Context.INPUT_METHOD_SERVICE);
inputMgr.toggleSoftInput(InputMethodManager.SHOW_FORCED, 0);
inputMgr.showSoftInput(root, InputMethodManager.SHOW_IMPLICIT); 
```

显示键盘，但没有从键盘接收任何输入（即按下键不会将文本添加到文本编辑器）并且选择了文本编辑器，因为我可以看到光标闪烁。

我将 setFocusable 设置为 false，因为我不希望 PopupWindow 在我单击它外部时关闭。我怎样才能让键盘工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T04:11:03.057

您可以使用这些[`PopupWindow`](http://developer.android.com/reference/android/widget/PopupWindow.html)方法完成所有操作。

1.  您不需要`InputMethodManager`强制显示软键盘。

    ```
    // Shows soft keyboard if it is not already visible.
    popup.setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_VISIBLE); 
    ```

2.  然后，您需要允许键盘交互。

    ```
    // Allows interaction with the soft keyboard.
    popup.setInputMethodMode(PopupWindow.INPUT_METHOD_NEEDED); 
    ```

3.  此外，您无需更改可聚焦性即可更改外部触摸行为。

    ```
    // PopupWindow ignores outside touches.
    popup.setOutsideTouchable(false); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T23:17:56.097

我怀疑如果您将 setFocusable 设置为 false，那么发生的情况是键盘已启动，因为您将其强制启动，但它实际上并没有与该字段交谈。您应该使您的弹出字段成为一个主题为 Dialog... 的活动，这将产生相同的效果，并且您不需要弄乱焦点。

# ruby-on-rails-3 - Rails 3 通过 created_at 使用 sunspot 搜索多个模型

> ID：10957042
> 
> 赞同：0
> 
> 时间：2012-06-08T23:11:56.147
> 
> 标签：ruby-on-rails-3, sunspot

我正在尝试在我的 Rails 应用程序中使用“新增功能”部分，该部分考虑了为不共享任何关系的各种表创建的新记录。它们的共同点是它们都有一个 created_at 字段，我将使用它来确定它们是否确实是“新的”，然后我想按该公共字段对结果进行排序。我试着用太阳黑子做这个，但我不知道如何利用太阳黑子搜索返回的结果集......

例如在我的上传和文章模型中，我有：

```
searchable do
    time :created_at
end 
```

在我的搜索操作中，我会这样做：

```
@updates = Sunspot.search(Upload,Article) do
    with(:created_at).greater_than(1.hour.ago)
end 
```

如果我执行@updates.total，它似乎会返回一些东西，它会返回我期望找到的记录数。除此之外，我不确定如何实际使用这些记录。我想做的是将@updates 发送到视图并确定每条记录的模型类型，然后继续打印出相关信息，即名称、描述、父/子记录信息（例如upload.user.username ）。

我可能完全错了，对于我试图执行的简单搜索，也许有比太阳黑子更好的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T09:40:04.367

有关如何使用搜索结果的详细信息，请参阅[自述文件。](https://github.com/sunspot/sunspot/blob/master/README.md)您正在寻找的方法是“结果”，默认情况下会给您前 30 个结果：

```
@updates.results # array of first 30 results 
```

# asp.net - 如何设置 HtmlEditorExtender 的内容服务器端

> ID：10957048
> 
> 赞同：3
> 
> 时间：2012-06-08T23:12:46.600
> 
> 标签：asp.net, ajaxcontroltoolkit, asp.net-4.0

我在我的 ASP.NET 4.0 Web 应用程序中使用 AjaxControlToolkit 的 HtmlEditorExtender：

```
<asp:TextBox ID="myTxt" runat="server" TextMode="MultiLine" Height="80px" Width="100%" />
<act:HtmlEditorExtender ID="heMyTxt" runat="server" TargetControlID="myTxt">
  <Toolbar>
    etc...
  </Toolbar>
</act:HtmlEditorExtender> 
```

当我像这样设置文本框服务器端的内容时：

```
myTxt.Text = htmlStringFromDatabase; 
```

...文本框中的内容是文字的 HTML 标记（即`<b>Bold</b>`像那样显示，而不是像**Bold**那样显示）。格式不会转移，但扩展器确实在文本框上工作并设置其工具栏和按钮等。是否有不同的方式来设置内容？

编辑：原来我得到的HTML `myTxt`（扩展器附加到的控件）是编码的HTML。所以现在的问题是如何阻止控件对其内容进行编码。这个问题也出现在[这个问题](https://stackoverflow.com/questions/10825791/how-do-i-stop-htmleditorextender-encoding-html-in-postback)中，但我没有使用`LoadControl()`或设计器到我的页面；我已经手动编写了我的标记。

另外，我不知道这是否会有所不同，但我正在将文本从页面`Page_Load`处理程序的 TextBox 中提取出来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-14T06:05:36.240

尝试这样做，

```
myTxt.Text = HttpUtility.HtmlDecode(htmlStringFromDatabase); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T20:52:59.097

我能够像这样解决这个问题：

```
 Literal lit = new Literal();
        lit.Mode = LiteralMode.PassThrough;
        lit.Text = HttpUtility.HtmlDecode(HTMLTExt);
        TextBox1.Text = lit.Text; // The text box which HTMLEditorExtender is attached to 
```

# objective-c - 在 NSTextView 中捕获撤消和重做编辑文本组

> ID：10957049
> 
> 赞同：4
> 
> 时间：2012-06-08T23:12:57.303
> 
> 标签：objective-c, cocoa, nstextview, nsundomanager

我正在为现有应用程序编写插件，我需要捕获受撤消和重做操作影响的修改文本和范围。我可以访问应用程序创建的 NSUndoManager 和 NSTextView，并且可以注册通知。有没有办法利用这些元素来获取撤消/重做的文本组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:41:46.407

我没有这样做，所以我只是通过文档/知识。

因为您可以访问 textview，所以您可以成为 textview 代表。然后，您将收到有用的消息...

文字修改前：

*   textView:shouldChangeTextInRange:replacementString:
*   textView:shouldChangeTextInRanges:replacementStrings:
*   textView:shouldChangeTypingAttributes:toAttributes:

文字修改后：

*   textViewDidChangeTypingAttributes：

我不知道您是否会收到这些更改（UndoManager 会绕过这些内容吗？），但您可能会收到。在任何情况下，您都可以在处理之前的消息时查询选择设置。

在选择更改之前：

*   textView:willChangeSelectionFromCharacterRange:toCharacterRange:
*   textView:willChangeSelectionFromCharacterRanges:toCharacterRanges:

后：

*   textViewDidChangeSelection：

UndoManager 应该告诉您它正在执行 Undo，这意味着您可以区分普通更改和基于 undo 的更改。

这似乎足以继续，我希望它有所帮助。

# android - 如何扩展 ListView。dalvik.system 上的基本示例 ClassNotFoundExcpetion android.view.MyListView

> ID：10957051
> 
> 赞同：3
> 
> 时间：2012-06-08T23:13:29.423
> 
> 标签：android, listview, noclassdeffounderror, extends

我想扩展 ListView 但我不明白我做错了什么。这是我的代码，非常简单和基本：

清单.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.my.test"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".TrymylistviewActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

资源/布局/main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<MyListView android:id="@+id/android:list"
      android:layout_width="fill_parent"
        android:layout_height="wrap_content"/>

<TextView android:id="@+id/android:empty"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/hello"/>

</LinearLayout> 
```

TrymylistviewActivity.java

```
package com.my.test;

import android.app.ListActivity;
import android.os.Bundle;

public class TrymylistviewActivity extends ListActivity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}
} 
```

MyListView.java

```
package com.my.test;

    import android.content.Context;
    import android.util.AttributeSet;
    import android.widget.ListView;

    public class MyListView extends ListView {

public MyListView(Context context) {
    super(context);
}

public MyListView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}

public MyListView(Context context, AttributeSet attrs) {
    super(context, attrs);
}

    } 
```

如果我在 res/layout/main.xml 中使用 ListView 而不是 myListView，则应用程序在模拟器中运行。但当然，如果我用 MListview 扩展 ListView，那么我想使用它。我究竟做错了什么？

这是堆栈跟踪的开始和有趣的部分。

```
06-08 22:51:33.409: E/AndroidRuntime(1141): FATAL EXCEPTION: main
06-08 22:51:33.409: E/AndroidRuntime(1141): java.lang.RuntimeException: Unable to start       activity ComponentInfo{com.my.test/com.my.test.TrymylistviewActivity}:   android.view.InflateException: Binary XML file line #8: Error inflating class MyListView
06-08 22:51:33.409: E/AndroidRuntime(1141):     at   android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)... 11 more
....
06-08 22:51:33.409: E/AndroidRuntime(1141): Caused by: java.lang.ClassNotFoundException:   android.view.MyListView
06-08 22:51:33.409: E/AndroidRuntime(1141):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
06-08 22:51:33.409: E/AndroidRuntime(1141):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
....
06-08 22:51:33.409: E/AndroidRuntime(1141):     ... 21 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T23:16:29.217

您必须使用自己的命名空间：

```
 <MyListView android:id="@+id/android:list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"/> 
```

应该：

```
 <com.my.test.MyListView android:id="@+id/android:list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"/> 
```

# mysql - mysql部分索引，反向索引

> ID：10957053
> 
> 赞同：8
> 
> 时间：2012-06-08T23:13:58.000
> 
> 标签：mysql, database, indexing

我有一张包含单词列表的表格。

单词 VARCHAR(16)

我需要创建一个反向索引。IE。单词“apple”将索引为“elppa”，单词“banana”索引为“ananab”等等。

另外，是否可以索引单词的一部分？例如，跳过第一个/最后 1 或 2 个字符：

pple (苹果) anana (香蕉)

这些事情可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T00:58:08.510

您可以在受前缀长度限制的字段上创建索引，这意味着只会考虑前 n 个字符，但您不能使用任意开始和结束位置来执行此操作。[在 mysql 的CREATE INDEX](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)文档页面上阅读有关它的更多信息。

在这种情况下，我只需创建另一列，使用 mysql 的[REVERSE](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html)函数将其填充并在其上创建索引，这样您就可以获得一个字段来搜索原始单词的反向。

其他数据库（如 Postgresql）允许您对[表达式进行索引](http://www.postgresql.org/docs/8.2/static/sql-createindex.html)，这将有效地允许您在`reverse(col_name)`不创建额外列的情况下进行索引。所以这是可能的，只是现在不使用mysql。（因为我相信版本 9 potgresql 有 reverse() native）

# algorithm - 算法：按顺序记住最后 n 个唯一数字

> ID：10957054
> 
> 赞同：1
> 
> 时间：2012-06-08T23:14:07.123
> 
> 标签：algorithm

我想按顺序记住最后 n 个唯一数字。

这就是我的意思：假设 n = 4。

我当前的列表是`5 3 4 2`如果我添加 6，它会变成`3 4 2 6`. 如果我改为添加 3，则列表变为`5 4 2 3`，其中 3 移到前面。

我会这样做：将数字存储在队列中。添加新号码时，请在队列中搜索该号码。如果没有找到号码，则弹出最后的号码，并将新号码推到最前面。如果找到号码，则删除该位置的号码，然后将新号码推到前面。

现在显然，从队列中的任意位置删除一个数字，优化队列操作（如`std::deque`在 C++ 中）将非常慢。使用链接列表，虽然搜索列表会更慢。有没有更好的算法+数据结构组合来完成这类任务？

如果它有任何区别，我不一定关心“按顺序记住最后 n 个唯一数字”。我特别需要知道，添加时从列表中删除了哪些元素（如果有的话）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T23:48:05.740

您可以使用双向链表。您可以将要记住的 n 个数字添加到哈希表中，其中键是数字本身，值是指向包含该数字的链表节点的指针。

然后在您描述的步骤中 **搜索队列中**您更改它的数字，以**查看该数字是否在哈希表中**，这将是恒定时间而不是使用队列的线性时间。

如果您存储指向双向链表第一个元素的指针 p 和指向列表最后一个元素的指针 q，则您描述的 pop 和 push 操作可以在恒定时间内执行。

您的步骤**如果找到数字，**则可以在恒定时间内删除该位置的数字，因为您已经有了要删除的数字的位置。（位置是指您从哈希表中获得的指针）。

更新：

请注意，您必须更新哈希表以相应地删除和添加新数字。

# ruby-on-rails-3 - 使用 attr_encrypted (attr_encryptor) gem 时出现 MassAssignmentSecurity 错误

> ID：10957057
> 
> 赞同：2
> 
> 时间：2012-06-08T23:14:45.180
> 
> 标签：ruby-on-rails-3, mass-assignment, attr-encrypted

对于我的 rails 3.2.3 应用程序，我使用的是 attr_encryptor，它是 attr_encrypted 的 danpal 的一个分支。我已按照[此处](https://github.com/danpal/attr_encryptor#readme)给出的说明进行操作，但在尝试创建新`Patient`记录时收到以下错误消息：

```
ActiveModel::MassAssignmentSecurity::Error in PatientsController#create

Can't mass-assign protected attributes: mrn, last_name, first_name, date_of_birth(1i), date_of_birth(2i), date_of_birth(3i) 
```

正如说明所说，我在表中添加了`encrypted_#{field}`、`encrypted_#{field}_salt`和`encrypted_#{field}_iv`列，`Patients`同时删除了未加密的对应项。

`Patient`模型看起来像：

```
class Patient < ActiveRecord::Base
  attr_accessible :age, :gender
  attr_encrypted :last_name, :key => 'key 1'
  attr_encrypted :first_name, :key => 'key 2'
  attr_encrypted :mrn, :key => 'key 3'
  attr_encrypted :date_of_birth, :key => 'key 4'
  # ...
end 
```

我在控制器中的`create`方法如下所示：`Patient`

```
PatientsController < ApplicationController
  # ...
  def create
    @patient = Patient.new
    @patient.first_name = params[:patient][:first_name]
    @patient.last_name = params[:patient][:last_name]
    @patient.mrn = params[:patient][:mrn]
    @patient.date_of_birth = Date.new(params[:patient]['date_of_birth(1i)'],
                                      params[:patient]['date_of_birth(2i)'],
                                      params[:patient]['date_of_birth(3i)'])
    if @patient.save
      # do stuff
    else
      # do other stuff
    end
  end
  # ...
end 
```

我究竟做错了什么？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T05:13:29.207

您需要用`attr_accessible`以及标记这些属性，`attr_encrypted`因为后者并不意味着前者。

这也可能与日期字段有关：[处理与虚拟属性相对应的多参数属性的正确方法](https://stackoverflow.com/questions/17482507/correct-way-to-handle-multiparameter-attributes-corresponding-to-virtual-attribu)

# ruby - 如何在 ruby 中实现 argmax？

> ID：10957058
> 
> 赞同：1
> 
> 时间：2012-06-08T23:14:48.097
> 
> 标签：ruby, json

给定一个 json 数组：

```
[{ "x":"5", "y":"20" },{ "x":"6", "y":"10" },{ "x":"50", "y":"5" }] 
```

我想找到`argmax(x)`，这样我就可以做到`puts argmax(arr, :arg => "x").y`并得到`5`。如何在 Ruby 中优雅地实现这一点？

**编辑**：澄清一点。这个想法是您可以在列表中指定要最大化的元素的字段，并且该方法将返回最大化的元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T23:33:15.337

我想你想要`Enumerable#max_by`。就像你`y`说的那样，它将是：

```
arr.max_by {|hash| hash['x']}['y'] 
```

（嗯，实际上，你会希望数字是数字而不是字符串，因为 '50' 排序低于 '6'。但我想你明白了。你可以`to_i`或做任何你需要的处理来获得要排序的“真实”值。）

# python - 将单个 python 文件与“附加”包一起打包

> ID：10957061
> 
> 赞同：2
> 
> 时间：2012-06-08T23:15:07.747
> 
> 标签：python, namespaces, packaging

我目前有一个名为“peewee”的项目，它由一个 python 文件 peewee.py 组成。还有一个包含单元测试的模块“tests.py”。这太棒了，想要使用该库的人可以只获取一个文件并使用它运行。

我最近想添加一些额外的东西，但不知道如何做到这一点以使命名空间正确。如果您查看我的项目的根目录，它类似于：

```
peewee.py
tests.py 
```

我想添加以下内容：

```
extras/__init__.py
extras/foo.py
extras/bar.py 
```

这是棘手的部分。我想让使用单个文件的人仍然可以这样做，但如果你想要额外的东西，你也可以拥有它们。我希望将附加内容命名为：

```
from peewee.extras import foo
from peewee.extras.bar import Baz 
```

我的 setup.py 看起来有点像这样：

```
setup(
    name='peewee',
    packages=['extras'],
    py_modules=['peewee'],
    # ... etc ...
) 
```

但这并不完全奏效。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T05:31:09.420

## 设置包

正如@ThomasK 所说，最简单的方法是使用一个包。如果您命名您的包`peewee`，那么您可以编辑顶级`__init__.py`文件以允许用户继续以与以前相同的方式使用您的包。

首先，您的包和子文件夹的目录结构：

```
peewee/
    __init__.py
    peewee.py
    extras/
        __init__.py
        foo.py
        bar.py 
```

### `__init__.py`档案_

接下来，您需要在顶层添加几行`__init__.py`.

您可以采用快速而肮脏的方法，只需包括：

```
from peewee.peewee import * 
```

这会将所有内容都放在`peewee.py`包的顶级命名空间中。或者，您可以采用更传统的替代方案，并仅显式导入那些应该位于顶层的方法。

```
from peewee.peewee import funtion1, class1,... 
```

并且，为了向后兼容，您可以`__all__`将模块的属性显式设置为仅包含 peewee

```
__all__ = ['peewee'] 
```

`from peewee import *`如果他们真的需要，这将让人们继续使用。

### 写一个`setup.py`文件

最后，您还必须设置一些安装脚本等。Zed Shaw 的[Learn Python The Hard Way 练习 46](http://learnpythonthehardway.org/book/ex46.html)有一个简单而清晰的项目框架，您应该使用它。

最重要的部分是`setup.py`文件。示例页面并不太长，Zed 为制作一本非常棒的书付出了很多努力，所以我不打算在此处重新发布它（尽管整本书都是*免费*的）。您还可以阅读更长的说明/文档来[为 distutils 编写 setup.py 文件](http://docs.python.org/distutils/setupscript.html)，但是 LPTHW 将为您提供一些可以快速轻松地完成您想要的一切的东西。

### 总包目录结构

请注意，您的最终目录结构实际上会更大一些（名称`peewee-pkg`无关紧要，`bin`是可选的——子文件夹的名称很重要）

```
peewee-pkg/
    setup.py
    bin
    peewee/
        __init__.py
        peewee.py
        extras/
            __init__.py
            foo.py
            bar.py 
```

## 安装和使用

之后，如果您愿意，您实际上可以将您的包发布到 PyPi，或者您可以直接将其分发给用户。他们需要做的就是运行：

```
 python setup.py install 
```

一切都将提供给他们。

### 导入后安装

最后，如果您`peewee/__init__.py`如前所述在文件中执行特定导入，您的用户仍然可以执行以下操作：

```
from peewee import function1, class1, ... 
```

但现在他们也可以`import peewee.extras`用来获取额外功能（或`import peewee.extras.foo as foo`或`from pewee.extras.foo import extra_awesome`）等。而且，正如您在问题中所问的那样，他们也可以：

```
from pewee.extras import foo 
```

`foo`然后像文件在当前目录中一样访问's 函数。

## 开发包的有用说明

在您的计算机上，您应该运行：

```
python setup.py develop 
```

这会将软件包安装到您的路径中，就像使用`python setup.py install`; 但是，`develop`它告诉 python 每次使用该模块时都要重新检查文件，这样每次您进行更改时，它们都会立即提供给系统进行测试。

# magento - getRate() 和 Magento 税率

> ID：10957070
> 
> 赞同：6
> 
> 时间：2012-06-08T23:17:23.727
> 
> 标签：magento

我正在尝试获取给定邮政编码的税率（百分比，而不是货币），以便我可以在第三方报价 PDF 打印输出中显示它（与 Magento 用作购物车预结账的“报价”无关） . 虽然我对 Magento 还比较陌生，但 getRateRequest() 和 getRate() 似乎是两个主要函数，它们根据所有变量（产品税类、客户税类等）获取税率。

由于这是用于第三方扩展并且我们所有的产品都是应税的，我想我只需使用带有正确 Varien Object 输入的 getRate()，它就会返回税率。经过一周的反复试验，我无法弄清楚为什么我总是得到零利率。我已经确认我正在调用 getRate() 函数，并且它没有从检查 Country 和 Customer/Product 类 ID 的第一个 if() 语句返回零。此外，我已经确认所有变量都在 getRate() 函数本身中传递和访问。

我创建了一个带有以下输入的对象（基于 getRateRequest() 的输出），我使用 getRate() 调用该对象，并希望有人能阐明我的数据输入有什么问题或为什么 getRate() 函数是总是返回零的结果。（我实际上是在下面设置 $variables ，它们只是在前面定义的，下面是我的一个测试用例值）

```
 // UPDATED CODE (variable values come from 3rd party quote extension)

    $country = 'US';  // use short country code
    $region = '12';   // must be numeric!
    $postcode = '95050';
    // our quote extension stores the customer id ('2') which we use to get the tax class
    $customer = Mage::getModel('customer/customer')->load( '2' );
    $custTax = $customer->getTaxClassId();

    $TaxRequest  = new Varien_Object();
    $TaxRequest->setCountryId( $country );
    $TaxRequest->setRegionId( $region );
    $TaxRequest->setPostcode( $postcode );
    $TaxRequest->setStore( Mage::app()->getStore() );
    $TaxRequest->setCustomerClassId( $custTax );
    $TaxRequest->setProductClassId(2);  // 2=taxable id (all our products are taxable)

    $taxCalculationModel = Mage::getSingleton('tax/calculation');
    $rate = $taxCalculationModel->getRate($TaxRequest); 
```

我的备份计划是直接执行 SQL 查找公式，尽管这可能会有点混乱。由于我们的 Web 开发团队并未完全遵循良好的编码标准，因此一旦初始启动修复程序（全部 4 页）完成，最终的网站重写将在我的未来。

感谢您的帮助并花时间阅读本文。

编辑 - 堆栈溢出很棒:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T12:54:00.503

你也可以试试这个

```
$store = Mage::app()->getStore('default');
$request = Mage::getSingleton('tax/calculation')->getRateRequest(null, null, null, $store);
$taxclassid = $product->getData('tax_class_id');
$percent = Mage::getSingleton('tax/calculation')->getRate($request->setProductClassId($taxclassid)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T22:32:43.240

如果你改变：

```
$TaxRequest->setRegionId(California); 
```

到

```
 $TaxRequest->setRegionId($stateId); 
```

其中 $stateId 是数字区域 ID。你的代码应该可以工作。

# macos - firebreath firefox 插件未找到 MACOSX

> ID：10957074
> 
> 赞同：0
> 
> 时间：2012-06-08T23:18:35.210
> 
> 标签：macos, firefox, firebreath, browser-plugin

我一直在关注以下firebreath教程：

[http://www.firebreath.org/display/documentation/Mac+Video+Tutorial](http://www.firebreath.org/display/documentation/Mac+Video+Tutorial)

在第二个视频中，在我构建了我的插件并且我在 /Library/Internet/Plug-ins 部分中包含了 ScreenTutorialPlugin.plugin 文件后，当我去检查它时，它不会在 firefox 中显示 about:plugins ，它只是不显示。但是当我在终端中检查 /Library/Internet/Plug-ins 时，它确实显示了。

当我打开一个插件文件并在浏览器中打开时，它说该插件不起作用。

我认为这与 /plug-ins 部分中的文件链接部分 ln -s 有关。

或者可能是因为我使用了 3 种不同的浏览器？野生动物园，火狐和铬。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T04:20:04.190

根据所提供的信息，很难确定您的问题是什么，但这里有一些需要考虑/理解的事情：

*   FireBreath 插件是 NPAPI 插件，因此应该适用于您提到的所有三个浏览器
*   应该安装它的路径是“/Library/Internet Plugins”，而不是“/Library/Internet/Plugins”，如果您确实按照您的指示将它放在后一个目录中并且这不是错字，那么这绝对是你的问题的一部分
*   如果您创建指向实际 .plugin 目录的符号链接，则使用 ln -s 应该可以工作，但如果没有，您可以随时尝试复制文件本身
*   如果一切构建正确，您应该有一个名为 (plugin name).plugin/Contents/MacOS/(plugin name) 的二进制文件，其中 (plugin name) 是插件的名称

希望其中一些有所帮助；如果没有，请提供有关您尝试过的更多信息，我们会尽力提供更多帮助。你所做的绝对应该有效——我每天都在 Mac 上使用 FireBreath 创建的插件。

# android - 移至其自己的 Android 类后出现 JSON 解析器错误

> ID：10957076
> 
> 赞同：0
> 
> 时间：2012-06-08T23:18:52.447
> 
> 标签：android, json, parsing

我有一个 JSONParser 解析为从原始资源文件夹中提取的字符串。当它在活动中时，它工作得非常好。由于我需要在其他活动中重用它，所以我将它移到了自己的类中。

我现在不知道为什么或我有什么问题。它几乎没有变化......？请看看我的方法，看看你的想法。谢谢

片段活动：

```
@Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        InputStream file = getResources().openRawResource(R.raw.regulatory_list);
        JSONParser jParser = new JSONParser();
        JSONArray json = jParser.getJSONFromFile(file);
        callback(jParser);
    } 
```

解析器类：

```
 public class JSONParser {

    static JSONArray jArray = null;

    // constructor
    public JSONParser() {

    }

    public JSONArray getJSONFromFile(InputStream file) {

        Writer writer = new StringWriter();
        char[] buffer = new char[1024];
        try {
            Reader reader = new BufferedReader(new InputStreamReader(file, "UTF-8"));
            int n;
            while ((n = reader.read(buffer)) != -1) {
                writer.write(buffer, 0, n);
            }
        } catch (UnsupportedEncodingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } finally {
            try {
                file.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

        String jsonString = writer.toString();

        // try parse the string to a JSON object
        try {
            jArray = new JSONArray(jsonString);
        } catch (JSONException e) {
            Log.e("JSON Parser", "Error parsing data " + e.toString());
        }

        // return JSON String
        return jArray;
    }

} 
```

从 JSONException 到日志的错误：

```
06-08 16:04:21.504: E/JSON Parser(27082): Error parsing data org.json.JSONException: Value [{"title":"Advisory Circulators","label":"AC","date":"2008-03-03","_id":"1","gotoURL":null,"description":"Provides guidance such as methods, procedures, and practices for complying with regulations and requirements."},{"title":"Airworthiness Directives","label":"AD","date":"2012-06-08","_id":"2","gotoURL":"javascript:navClickListener('bodyContent', dns + '\/wiki\/index.php\/Airworthiness_Directive #content');","description":"Legally enforceable rules that apply to aircraft, aircraft engines, propellers, and appliances."},{"title":"Code of Federal Regulations","label":"CFR","date":"2012-01-31","_id":"3","gotoURL":"javascript:navClickListener('bodyContent',  dns + '\/wiki\/index.php\/Main_Page #content');","description":"Official Rulemaking documents of the CFR in Title 14 and have been published in the Federal Register"},{"title":"Parts Manufacturer Approvals","label":"PMA","date":"2012-01-31","_id":"4","gotoURL":null,"description":"Parts Manufacturer Approvals"},{"title":"Special Airworthiness Info Bulletins","label":"SAIB","date":"2012-01-31","_id":"5","gotoURL":null,"description":"Bulletins issued by manufacturers to provide modification or inspection instructions."},{"title":"Special Federal Aviation Regulation","label":"SFAR","date":"2012-01-31","_id":"6","gotoURL":null,"description":"Official Rulemaking documents that have changed the language of the CFR in Title 14 CFR for aviation."},{"title":"Supplemental Type Certificates","label":"STC","date":"2012-01-31","_id":"7","gotoURL":null,"description":"Document issued by the Federal Aviation Administration approving a product (aircraft, engine, or propeller) modification"},{"title":"Technical Standard Orders","label":"TSO","date":"2012-01-31","_id":"8","gotoURL":null,"description":"Minimum performance standards issued by the FAA for specified materials, parts, processes, and appliances used on civil aircraft."},{"title":"Type Certificate Data Sheets","label":"TCDS","date":"2012-01-31","_id":"9","gotoURL":null,"description":"Repository of Make and Model information of aircraft, engine or propeller including airspeed, weight, and thrust limitations, etc."}] of type org.json.JSONArray cannot be converted to JSONObject 
```

编辑后记录：

```
06-08 16:44:42.744: E/JSON Parser(27515): Error parsing data org.json.JSONException: Value [{"title":"Advisory Circulators","label":"AC","date":"2008-03-03","_id":"1","gotoURL":null,"description":"Provides guidance such as methods, procedures, and practices for complying with regulations and requirements."},{"title":"Airworthiness Directives","label":"AD","date":"2012-06-08","_id":"2","gotoURL":"javascript:navClickListener('bodyContent', dns + '\/wiki\/index.php\/Airworthiness_Directive #content');","description":"Legally enforceable rules that apply to aircraft, aircraft engines, propellers, and appliances."},{"title":"Code of Federal Regulations","label":"CFR","date":"2012-01-31","_id":"3","gotoURL":"javascript:navClickListener('bodyContent',  dns + '\/wiki\/index.php\/Main_Page #content');","description":"Official Rulemaking documents of the CFR in Title 14 and have been published in the Federal Register"},{"title":"Parts Manufacturer Approvals","label":"PMA","date":"2012-01-31","_id":"4","gotoURL":null,"description":"Parts Manufacturer Approvals"},{"title":"Special Airworthiness Info Bulletins","label":"SAIB","date":"2012-01-31","_id":"5","gotoURL":null,"description":"Bulletins issued by manufacturers to provide modification or inspection instructions."},{"title":"Special Federal Aviation Regulation","label":"SFAR","date":"2012-01-31","_id":"6","gotoURL":null,"description":"Official Rulemaking documents that have changed the language of the CFR in Title 14 CFR for aviation."},{"title":"Supplemental Type Certificates","label":"STC","date":"2012-01-31","_id":"7","gotoURL":null,"description":"Document issued by the Federal Aviation Administration approving a product (aircraft, engine, or propeller) modification"},{"title":"Technical Standard Orders","label":"TSO","date":"2012-01-31","_id":"8","gotoURL":null,"description":"Minimum performance standards issued by the FAA for specified materials, parts, processes, and appliances used on civil aircraft."},{"title":"Type Certificate Data Sheets","label":"TCDS","date":"2012-01-31","_id":"9","gotoURL":null,"description":"Repository of Make and Model information of aircraft, engine or propeller including airspeed, weight, and thrust limitations, etc."}] of type org.json.JSONArray cannot be converted to JSONObject 
```

有效的原始课程：

```
@Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        InputStream is = getResources().openRawResource(R.raw.regulatory_list);
        Writer writer = new StringWriter();
        char[] buffer = new char[1024];
        try {
            Reader reader = new BufferedReader(new InputStreamReader(is, "UTF-8"));
            int n;
            while ((n = reader.read(buffer)) != -1) {
                writer.write(buffer, 0, n);
            }
        } catch (UnsupportedEncodingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

        String jsonString = writer.toString();
        callback(jsonString);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:30:03.293

从日志它显示您的 JSON 是一个数组，即它看起来像这样：

```
 ["foo":bar] 
```

如果它是一个对象，它看起来像这样：

```
 {"foo":bar} 
```

您尝试做的第一件事是：

```
 new JSONObject(jsonString); 
```

但它是一个数组！所以你需要创建一个数组：

```
 new JSONArray(jsonString); 
```

然后，您可以通过遍历数组来获取对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T23:37:41.883

您的异常表明您正在尝试从 JSONArray 数据加载 JSONObject。

此[页面](http://www.json.org/)包含一些有关 JSON 数据格式的有用（且简洁！）信息，这些信息将帮助指导您使用 JSON 库。

# events - Ninject EventBroker 自动注册

> ID：10957079
> 
> 赞同：1
> 
> 时间：2012-06-08T23:19:02.880
> 
> 标签：events, ninject

是否可以让所有注入的项目自动注册到 EventBroker？另一种方法是在每种类型中注入 IEventBroker，但这很容易出错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:44:04.890

注入对象时无法注册它们。但是您可以在创建对象时使用`.RegisterOnGlobalEventBroker();`或/和`RegisterOnEventBroker("MyGlobalEventBroker")`从[https://github.com/ninject/ninject.extensions.bbveventbroker注册对象](https://github.com/ninject/ninject.extensions.bbveventbroker)

# hadoop - 访问元组的字段

> ID：10957081
> 
> 赞同：3
> 
> 时间：2012-06-08T23:19:45.970
> 
> 标签：hadoop, apache-pig, hdfs

我有以下猪脚本：
我的文件 1.txt 有 A 1
B 2
C 3
D 4

```
grunt> A = load '1.txt' using PigStorage(' ') as (a:chararray,b:int);  
grunt> B = foreach A generate A.a;  
grunt> dump B; 
```

它给了我以下错误

错误 org.apache.pig.tools.grunt.Grunt - 错误 2997：无法从支持的错误重新创建异常：org.apache.pig.backend.executionengine.ExecException：错误 0：标量在输出中包含多行。第一名：(A,1)，第二名：(B,2)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T13:18:26.040

您不必引用`a`as `A.a`。试试这个：

```
grunt> A = load '1.txt' using PigStorage(' ') as (a:chararray,b:int);  
grunt> B = foreach A generate a;  
grunt> dump B; 
```

`C.x`用于从袋子中取出“列”。说`C`是一袋物品，然后`C.x`将创建一个包含该袋中所有物品的新`x`袋。这不是你想要的。正在为`foreach`您遍历包。

# html - HTML/CSS：“透视背景”文本？

> ID：10957082
> 
> 赞同：20
> 
> 时间：2012-06-08T23:19:54.053
> 
> 标签：html, css

好的，这可能吗。

我有一张背景图片。最重要的是，我有一个用于内容的透明灰色框。我想在文本的顶部有标题，基本上是*暴露*背景的字母。因此，文本删除了灰色框并让背景显示出来。

我能看到的唯一 hacky 方法是创建一个在背景上具有相同灰色颜色的透明字母的图像，然后尝试以某种方式将其与灰色框对齐。

还有其他更好的方法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-08T23:58:25.080

一种方法是使用`-webkit-background-clip: text;`: **[demo here](http://jsfiddle.net/NT7z7/11/)**（显然只有 webkit）。

使用位置，我们可以同步两个背景：

```
#container, #container h1 {
    background: url(bg.png)
}

#container {
    position: relative;
}

#container #gray {
    background: rgba(0,0,0,.8);
    padding-top: 8em;
}

#container h1 {
    font-size: 8em;
    padding-top: /* padding + border of div */;
    position: absolute;
    -webkit-text-fill-color: transparent;
    -webkit-background-clip: text;
}​ 
```

或者您可以使用相同的方法并应用[svg mask](http://jsfiddle.net/NT7z7/12/)，这将适用于所有现代浏览器。

# python - Python：for循环

> ID：10957083
> 
> 赞同：0
> 
> 时间：2012-06-08T23:19:55.830
> 
> 标签：python, loops, for-loop

我正在尝试创建一个 for 循环来为已建立的字典中的键添加值。但是，我不断获得最后一个值而不是所有值。我做错了什么？

我现在的字典看起来像：

```
growth_dict = dict.fromkeys(conc[1:9], '')

growth_dict = {'100 ug/ml': '', '12.5 ug/ml': '', '50 ug/ml': '', 
    '0 ug/ml': '', '6.25 ug/ml': '', '25 ug/ml': '', '3.125 ug/ml': '', 
    '1.5625 ug/ml': ''}

cols_list = numpy.loadtxt(fn, skiprows=1, usecols=range(1,9), unpack=True)

numer = (0.301)*960 #numerator

for i in cols_list:

    N = i[-1]
    No = i[0]
    denom = (math.log(N/No)) #denominator
    g = numer/denom 
```

当我运行程序并输入“growth_dict”时，它会返回我的字典，其中只有最后一个值作为键：

```
growth_dict = {'100 ug/ml': 131.78785283808514, '12.5 ug/ml': 131.78785283808514, 
    '50 ug/ml': 131.78785283808514, '0 ug/ml': 131.78785283808514, 
    '6.25 ug/ml': 131.78785283808514, '25 ug/ml': 131.78785283808514, 
    '3.125 ug/ml': 131.78785283808514, '1.5625 ug/ml': 131.78785283808514} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:26:28.693

`conc[j]`每次执行此操作时，您都会覆盖字典条目的值：

```
growth_dict[conc[j]] = g 
```

如果您希望每个连续`g`的都附加到字典条目中，请尝试以下操作：

```
for j in conc:
    # The first time each key is tested, an empty list will be created
    if not instanceof(growth_dict[conc[j]], list):
        growth_dict[conc[j]] = []
    growth_dict[conc[j]].append(g) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T23:29:36.460

您还可以通过以下方式节省大量加载数据的精力

```
cols_list = numpy.loadtxt(fn, skiprows=1, usecols=range(1,9), unpack=True) 
```

# mysql - 如何修改谷歌地图代码以使用 sql 而不是硬编码的 xml

> ID：10957085
> 
> 赞同：0
> 
> 时间：2012-06-08T23:20:00.913
> 
> 标签：mysql, xml, google-maps, google-maps-api-3

我有 2 个谷歌地图脚本（都用于 api V3）。

一种设计用于使用硬编码的 xml 文件中的数据。另一个旨在使用“php”脚本通过在每次加载地图时从 sql 数据库中提取数据来创建 xml 文件。

我想使用第一个脚本（与第二个相比，它具有其他地图功能），但想从我的 sql 数据库中提取数据。

当我修改第一个文件中的脚本来执行此操作时，它不起作用（即地图中没有加载任何标记）。

这是xml文件代码

```
downloadUrl("categories.xml", function(doc) {
var xml = xmlParse(doc);
var markers = xml.documentElement.getElementsByTagName("marker");
for (var i = 0; i < markers.length; i++) {
var detail = markers[i].getAttribute("detail"); 
```

这是与mysql数据库一起使用的代码

```
 downloadUrl("genxml.php", function(data) {
  var xml = parseXml(data);
  var markers = xml.documentElement.getElementsByTagName("marker");
  for (var i = 0; i < markers.length; i++) {
  var detail = markers[i].getAttribute("detail"); 
```

所以我不确定为什么在第一个脚本中使用第二个脚本中的代码现在可以工作。

有没有人足够熟悉 google api 并使用 mySql 能够提供建议。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T00:33:39.993

我注意到一个脚本说`xmlParse`，而另一个，`parseXml`。这种不一致很可能是意外行为的原因。保持 JavaScript 控制台打开很有用，例如用于 Firefox 的 Firebug 或 Google Chrome 的开发人员工具（按 F12 或 Ctrl+Shift+I）。

# php - 在 CodeIgniter 中使用抽象的基本控制器

> ID：10957086
> 
> 赞同：2
> 
> 时间：2012-06-08T23:20:09.717
> 
> 标签：php, codeigniter

我有一组控制器，只有当您是管理员（而不是普通用户）时才能访问。

因此，在每个控制器的构造函数中，我会这样做：

```
public function __construct() {
    parent::__construct();
    if (! is_admin()) {
         show_404();
    }
} 
```

除了将此代码添加到每个 Admin Controller 的构造函数中，还有更好的方法吗？

我在想我可以创建一个名为的 Base 控制器`Admin_Controller`，如下所示：

```
public class Admin_Controller extends CI_Controller {

    public function __construct() {
         //the above code goes here
    }
} 
```

然后我所有的其他控制器都可以扩展这个类，而不是这个`CI_Controller`类。唯一的问题是，我需要将此文件包含在其他控制器的顶部，否则 CodeIgniter 找不到`Admin_Controller`.

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T23:56:33.207

将它放在您的应用程序/核心文件夹中：MY_Controller.php *（注意正确使用大写字母）*

```
class MY_Controller extends CI_Controller
{
public function __construct() 
{
     parent::__construct();
     if (! is_admin())
     {
          show_404();
     }
} 
```

然后在您希望用户登录的所有普通控制器中

```
class Whatever extends MY_Controller
{
   public function __construct() 
    {
         parent::__construct();
    } 
} 
```

[请参阅此处有关扩展核心类的用户指南](http://codeigniter.com/user_guide/general/core_classes.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T23:22:30.940

我认为你可以使用[Hooks](http://codeigniter.com/user_guide/general/hooks.html) 我做过同样的事情，但我需要更精确的控制，所以我必须检查每个控制器。并非所有控制器都禁止单个用户使用。

# java - 变量无法在 Java 中解析

> ID：10957087
> 
> 赞同：-1
> 
> 时间：2012-06-08T23:20:26.293
> 
> 标签：java, android

我正在使用 Db、Java 和 OOP 创建一个 Android 应用程序。

这是主要活动的来源：

```
public class EpsoftSMSActivity extends Activity {
    /** Called when the activity is first created. */

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        final MyDatabase db=new MyDatabase(getApplicationContext());

        db.open();  //apriamo il db

        if (db.listaParametri().getCount()==0)
        {
            setup_parametri();

             /*final Dialog dialog = new Dialog(this);
             dialog.setContentView(R.layout.login);
             dialog.setTitle("Login");
             dialog.setCancelable(true);
             //there are a lot of settings, for dialog, check them all out!

             //set up button
             Button registra = (Button) dialog.findViewById(R.id.registra);
             registra.setOnClickListener(new OnClickListener() {
                 @Override
                     public void onClick(View v) {

                         String username = dialog.findViewById(R.id.username).toString();
                         String password = dialog.findViewById(R.id.password).toString();

                         db.inserimentoParametri(username, password);
                         dialog.dismiss();
                     }
             });

             Button annulla = (Button) dialog.findViewById(R.id.annulla);

             annulla.setOnClickListener(new OnClickListener() {
                 @Override
                     public void onClick(View v) {
                        dialog.dismiss();

                     }
             });

             //now that the dialog is set up, it's time to show it    
             dialog.show();*/
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        getMenuInflater().inflate(R.layout.menu, menu);
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item)
    {
        switch (item.getItemId())
        {
            case R.id.chiudi:

                finish();
                System.exit(0);
                return true;

            case R.id.setup:

                setup_parametri();
                return true;

            case R.id.info:

                  final Dialog dialog = new Dialog(this);
                    dialog.setContentView(R.layout.dialog);
                    dialog.setTitle("Informazioni & Credits");
                    dialog.setCancelable(true);
                    //there are a lot of settings, for dialog, check them all out!

                  /*  //set up text
                    TextView text = (TextView) dialog.findViewById(R.id.TextView01);
                    //text.setText(R.string.lots_of_text);

                    //set up image view
                    ImageView img = (ImageView) dialog.findViewById(R.id.ImageView01);
                    img.setImageResource(R.drawable.ic_launcher);*/

                    //set up button
                    //set up button
                    Button button = (Button) dialog.findViewById(R.id.Button01);
                    button.setOnClickListener(new OnClickListener() {
                    @Override
                        public void onClick(View v) {
                            dialog.dismiss();

                        }
                    });
                    //now that the dialog is set up, it's time to show it    
                    dialog.show();

            return true;
        }
        return super.onOptionsItemSelected(item);
    }

    public void setup_parametri()
    {
         final Dialog dialog = new Dialog(this);
         dialog.setContentView(R.layout.login);
         dialog.setTitle("Login");
         dialog.setCancelable(true);
         //there are a lot of settings, for dialog, check them all out!

         //set up button
         Button registra = (Button) dialog.findViewById(R.id.registra);
         registra.setOnClickListener(new OnClickListener() {
             @Override
                 public void onClick(View v) {

                     String username = dialog.findViewById(R.id.username).toString();
                     String password = dialog.findViewById(R.id.password).toString();

                      db.inserimentoParametri(username, password);
                     dialog.dismiss();
                 }
         });

         Button annulla = (Button) dialog.findViewById(R.id.annulla);

         annulla.setOnClickListener(new OnClickListener() {
             @Override
                 public void onClick(View v) {
                    dialog.dismiss();
                 }
         });

         //now that the dialog is set up, it's time to show it    
         dialog.show();
    }
} 
```

在名为“setup_parametri”的最新函数中，我尝试调用“db.inserimentoParametri”，但 Eclipse 告诉我：

> “数据库无法解析”

Db 在 oncreate 中定义。

这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T23:22:52.660

`db`是内部声明的局部变量`onCreate()`。它对任何其他方法都不可见。您可能希望将其设置为 Activity 类的实例字段，这意味着它将可用于该类的所有方法。

在外部声明该字段`onCreate()`，但在内部对其进行初始化。像这样：

```
private MyDatabase db;

@Override
public void onCreate(Bundle savedInstanceState) {

    ....

    db = new MyDatabase(getApplicationContext()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T23:28:19.363

您已将 db 声明为内部变量，`onCreate()`但未将其传递给`setup_parametri()`

您需要将其设为类变量：

```
public class EpsoftSMSActivity extends Activity {
    /** Called when the activity is first created. */

    final MyDatabase db;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        db = new MyDatabase(getApplicationContext());

        db.open();  //apriamo il db 
```

或将签名更改`setup_parametri()`为`setup_parametri(MyDatabase db)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T23:25:01.737

运行 OnClickerListener 事件处理程序时，DB 变量不在范围内。

将 db 定义移到 onCreate 方法的范围之外，即使其成为成员变量。

# ruby - 使用 Ruby LibXML 在 Atom 中找不到节点

> ID：10957088
> 
> 赞同：0
> 
> 时间：2012-06-08T23:20:38.440
> 
> 标签：ruby, xml, libxml2, libxml-ruby

我有以下 XML 文档：

```
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<atom:entry xmlns:atom=\"http://www.w3.org/2005/Atom\" xmlns:apps=\"http://schemas.google.com/apps/2006\" xmlns:gd=\"http://schemas.google.com/g/2005\">
  <apps:property name=\"memberId\" value=\"Tom\"/>
</atom:entry> 
```

我要做的就是获取应用程序：属性节点。然而，我在 LibXML 中尝试的一切都没有返回。

从[此处](http://libxml.rubyforge.org/rdoc/)阅读LibXML::XML::XPath 的 LibXML 文档。我假设我不需要指定这两个命名空间，因为它们是在根节点上定义的。

这是我尝试过的：

```
@document.find('/apps:property')
@document.find('//apps:property')
@document.find('/atom:entry/apps:property')
@document.find('//atom:entry/apps:property')
@document.find('/property')
@document.find('/atom:entry')
@document.find('//property')
@document.find('/entry') 
```

以上都没有返回指定文档的结果。我也用 atom 和 apps 命名空间定义的不同组合尝试了它们，但似乎没有效果。

如果有人能告诉我我必须错过什么非常简单的事情，那将不胜感激。

* * *

事实证明，问题源于动态创建的文档，而不是从文件中读取。

当我将文档写入文件并读取它时，我可以搜索它。当我创建文档时，创建根元素并以编程方式添加子元素，每次尝试搜索时我都会得到 nil，奇怪的是每个都可以正常工作。在我可以搜索之前，我是否必须以某种方式“完成”或对文档做一些其他愚蠢的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T15:03:47.677

如果我明确解析文档，那么我可以搜索它。

看起来这可能是解决方案，除非可以在构建文档时生成解析树。

是时候看看我想的代码了。

# iphone - XCode中文件中的数组

> ID：10957092
> 
> 赞同：0
> 
> 时间：2012-06-08T23:21:26.380
> 
> 标签：iphone, ios, xcode

我正在制作一个任务管理器 iOS 应用程序。您键入一个任务，它会保存在一个数组中。我希望人们能够在手机之间共享任务，所以我添加了一种保存每个数组的方法。

现在我在本地使用我的想法。该页面有标题和密码。当按下保存按钮时，数组将保存到标题和密码唯一的文件中（效果很好，每次都保存）。

我需要找到一种方法，然后将文件中的所有信息返回到数组中，以便可以看到它。这是我尝试过的，请记住，除了“获取任务按钮”之外，一切正常，我的问题是`getFile`无效的：

## BNRAppDelegate.m

```
#import "BNRAppDelegate.h"

NSString *docPath()
{
    NSArray *pathList = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                                                            NSUserDomainMask,
                                                            YES);
    return [[pathList objectAtIndex:0] stringByAppendingPathComponent:@"data.td" ];
}

@implementation BNRAppDelegate

@synthesize window = _window;

#pragma mark - Application delegate callbacks

- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath 
{
    return YES;
}
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary     *)launchOptions
{
    NSArray *plist = [NSArray arrayWithContentsOfFile:docPath()];
    if (plist)
    {
        tasks = [plist mutableCopy];
    }
    else
    {
        tasks = [[NSMutableArray alloc] init];
    }

    CGRect windowFrame = [[UIScreen mainScreen] bounds];
    UIWindow *theWindow = [[UIWindow alloc] initWithFrame:windowFrame];
    [self setWindow:theWindow];

    [[self window] addSubview:taskTable];
    [[self window] addSubview:taskField];
    [[self window] addSubview:titleField];
    [[self window] addSubview:insertButton];
    [[self window] addSubview:clearButton];
    [[self window] addSubview:shareButton];
    [[self window] addSubview:passField];
    [[self window] addSubview:getButton];

    [[self window] setBackgroundColor:[UIColor whiteColor]];
    [[self window] makeKeyAndVisible];

    return YES;
}
- (void)addTask:(id)sender
{
    NSString *t = [taskField text];

    if ([t isEqualToString:@""]) {
        return;
    }

    [tasks addObject:t];
    [taskTable reloadData];
    [taskField setText:@""];
    [taskField resignFirstResponder];    
}
- (void)takeTask:(id)sender
{
    [tasks removeAllObjects];
    [taskTable reloadData];
    [tasks writeToFile:docPath()
            atomically:YES];
}
- (void)saveTask:(id)sender;
{
    if ([titleField text] == @""){
        //
    } else {
        NSString * original = [titleField text];
        NSString * pass = [passField text];
        NSString * step = [NSString stringWithFormat:@"%@.%@", original, pass];
        NSString * file = [NSString stringWithFormat:@"%@.plist", step];

        [tasks writeToFile:[NSString stringWithFormat:@"/tmp/%@", file] 
                atomically:YES];
        [tasks writeToFile:docPath()
                atomically:YES];
    }
}
- (void)getFile:(id)sender;
{
    NSString * original = [titleField text];
    NSString * pass = [passField text];
    NSString * step = [NSString stringWithFormat:@"%@.%@", original, pass];
    NSString * file = [NSString stringWithFormat:@"%@.plist", step];

    NSMutableArray *theTasks = [NSMutableArray arrayWithContentsOfFile:[NSString stringWithFormat:@"/tmp/%@", file]];
    tasks = [theTasks mutableCopy];

    [tasks writeToFile:docPath()
            atomically:YES];
}
- (void)tableView:(UITableView *)tableView commitEditingStyle:  (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{ 
    if (editingStyle == UITableViewCellEditingStyleDelete) { 
        [tasks removeObjectAtIndex:indexPath.row]; [tableView deleteRowsAtIndexPaths:[NSArray   arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade]; 
    } 
}

#pragma mark - Table View management

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return [tasks count];
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *c= [taskTable dequeueReusableCellWithIdentifier:@"Cell"];

    if (!c) {
        c = [[ UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"Cell"];
    }

    NSString *item = [tasks objectAtIndex:[indexPath row]];
    [[c textLabel] setText:item];

    return c;

} 
- (void)applicationDidEnterBackground:(UIApplication *)application
{
    [tasks writeToFile:docPath()
            atomically:YES];
}
- (void)applicationWillTerminate:(UIApplication *)application
{
    [tasks writeToFile:docPath()
            atomically:YES];
}

@end 
```

如果可以请帮忙谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T03:00:47.957

我认为你做错了。我不知道您的代码中 data.td 的用途是什么，因为您想将其保存为 username.password.plist

请尝试这个，它可能会指导您如何根据您的代码在本地保存和检索文件。

```
NSString *pathPlist(NSString *filename)
{
    NSArray *pathList = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                                                            NSUserDomainMask,
                                                            YES);
    return [[pathList objectAtIndex:0] stringByAppendingPathComponent:filename];
}

- (void)saveTask:(id)sender {
    NSString * original = @"Hello";
    NSString * pass = @"123";
    NSString * step = [NSString stringWithFormat:@"%@.%@", original, pass];
    NSString * file = [NSString stringWithFormat:@"%@.plist", step];

    NSString *path = pathPlist(file);
    NSMutableArray *array = [[NSMutableArray alloc] init];
    if (path) {
        NSArray *data = [NSArray arrayWithContentsOfFile:path];
        if (data) {
            [array setArray:data];
        }
        [array addObject:@"My Task"];
        BOOL iswritten = [array writeToFile:path atomically:YES];
        if (!iswritten) {
            NSLog(@"Failed");
        }
        [data release];
    }
}

- (void)getFile:(id)sender {
    NSString * original = @"Hello";
    NSString * pass = @"123";
    NSString * step = [NSString stringWithFormat:@"%@.%@", original, pass];
    NSString * file = [NSString stringWithFormat:@"%@.plist", step];

    NSString *path = pathPlist(file);
    NSMutableArray *array = [[NSMutableArray alloc] init];
    if (path) {
        NSArray *data = [NSArray arrayWithContentsOfFile:path];
        if (data) {
            [array setArray:data];
        }
    }
    NSLog(@"%@", array);
} 
```

注意： var 数组保存来自文件名(username.password.plist) 的数据

# php - php 是一个数组或对象的变量

> ID：10957100
> 
> 赞同：26
> 
> 时间：2012-06-08T23:22:37.747
> 
> 标签：php, arrays, string, object

试图弄清楚如何做相当于我在 javascript 中但在 php 中所做的事情。但我不确定运营商会这样做。在javascript中，我想查看传递的特定参数是对象还是数组..如果不是，那么它是字符串/整数，我所做的是类似于

```
if (str instanceof Array || str instanceof Object) 
{
   //code
}
else
{
   //code
} 
```

任何人都知道这相当于 php 吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-06-08T23:24:28.663

用于[`is_array`](http://php.net/is_array)检查变量是否为数组，类似地，用于[`is_object`](http://php.net/is_object)检查变量是否为对象。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-05-26T09:50:58.297

尝试使用：

```
if (!is_scalar($var)) {
    // Varible is object or array
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-14T16:38:42.733

我在寻找时遇到了这个问题`is_countable`。也许它对某人有些用处。 [https://www.php.net/manual/en/function.is-countable.php](https://www.php.net/manual/en/function.is-countable.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-25T08:24:09.207

## **对象（使用 is_object）--**

```
stdClass Object
(
    [rest_food_items_id] => 137
    [rest_user_id] => 42
) 
```

**数组（使用 is_array）----**

```
Array
(
    [rest_food_items_id] => 137
    [rest_user_id] => 42
) 
```

**

# 例子

**

```
if(is_object($data)){

}
if(is_array($data)){

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-03T14:34:07.350

从 PHP 8.0 开始，您可以在编写函数时使用[联合类型。](https://wiki.php.net/rfc/union_types_v2)这不是问题的直接答案，但它可能会帮助某人：

```
function test(array|object $something): void
{
    // Here, $something is either an array or an object
} 
```

# opengl - glsl 更新 2D 纹理的特定行

> ID：10957104
> 
> 赞同：2
> 
> 时间：2012-06-08T23:23:00.897
> 
> 标签：opengl, glsl, shader, textures

我正在使用 FBO 和附加的纹理使用“渲染到纹理”功能。

我的问题是在片段着色器中我不知道如何写入 2D 纹理的特定行。我确实有哪一行的信息（由一个统一的浮点变量表示），但我不知道如何在那里绘制。

这可能吗？或者有什么好方法可以知道我在片段着色器中的位置？

我的全局想法是从上到下将 1D 纹理的演变渲染为 2D 纹理。每个进化步骤由片段着色器计算（使用渲染到纹理乒乓方法，具有 2 个 FBO）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:30:26.273

我认为片段着色器不适合这个。

如果您只想写入 FBO 的单行，您不能将绘制调用的顶点设置为仅与您要绘制的像素重叠吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T03:39:30.580

您可以`discard;`在片段着色器中使用来丢弃您不想要的片段。就像是

```
if (gl_FragCoord.y != row_to_keep)
    discard; 
```

然后正常渲染你的场景，你最终只会写出一行输出。

# c# - 如何强制 Average 函数包含空值？

> ID：10957107
> 
> 赞同：2
> 
> 时间：2012-06-08T23:23:20.080
> 
> 标签：c#

我在我的 asp.net mvc 应用程序中写了以下内容：

```
double d = visits.Average(d=> d.amount); 
```

但是上面的代码忽略了任何为 Null 的对象，在我的例子中返回了一个不切实际的结果。如何强制 Average 函数将平均值计算为：

```
double d = visits.Sum(d=> d.amount)/visit.Count(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T23:26:07.353

所以你希望`null`值被解释为 0？

```
double d = visits.Average(d => d.amount ?? 0); 
```

# php - 我的 JOIN + GROUP BY ... HAVING COUNT 查询是否正确？

> ID：10957111
> 
> 赞同：1
> 
> 时间：2012-06-08T23:23:52.633
> 
> 标签：php, mysql, sql, count, group-by

我是 SQL 新手，我想实现以下查询：

我有两张桌子，`LicenseTbl`并且`UnlockTbl`：

`LicenseTbl`包含有关购买的软件许可证的信息：

> LicenseID, ProgramID, Owner, Location, OrderNo, BlockTime

`UnlockTbl`包含有关特定软件注册的信息：

> UnlockID、LicenseID（LicenseTbl 中的外键）、Timestamp、SerialNo、Key、UninstallTime

其中 BlockTime 和 UninstallTime 包含一个时间戳，如果许可证被阻止或软件被卸载等等`NULL`。

我想设计一个查询，为我提供满足以下条件的所有 LicenseID：

> *   属于给定的客户，
> *   没有被封锁，
> *   未在 UnlockTbl 中列出，或者在未标记为已卸载的行中有 < X 个不同的 SerialNo。

我已经写了这个，但我不确定它是否绝对正确（这是我的第一个 SQL 查询之一）：

```
SELECT LicenseID FROM LicenseTbl
JOIN UnlockTbl
   ON (LicenseTbl.LicenseID = UnlockTbl.LicenseID) 
WHERE  LicenseTbl.OrderNo   = '$givenOrderNo'
   AND LicenseTbl.Owner     = '$givenOwner'
   AND LicenseTbl.Location  = '$givenLocation'
   AND LicenseTbl.BlockTime IS NULL
   AND UnlockTbl.UninstallTime IS NULL
GROUP BY LicenseTbl.LicenseID, UnlockTbl.Key
HAVING COUNT(*) < $X 
```

（这应该意味着，列出同时使用少于 X 次的所有许可证。我更喜欢那些首先使用最少但不知道如何排序的许可证。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T23:51:53.507

这是一个好的开始，但我会将查询更改为以下内容......

```
SELECT
  LicenseID
FROM
  LicenseTbl
LEFT JOIN
  UnlockTbl
    ON  UnlockTbl.LicenseID = LicenseTbl.LicenseID
    AND UnlockTbl.UninstallTime IS NULL
WHERE
      LicenseTbl.OrderNo   = '$givenOrderNo'
  AND LicenseTbl.Owner     = '$givenOwner'
  AND LicenseTbl.Location  = '$givenLocation'
  AND LicenseTbl.BlockTime IS NULL
GROUP BY
  LicenseTbl.LicenseID
HAVING
  COUNT(DISTINCT UnlockTbl.SerialNo) < $X
ORDER BY
  COUNT(DISTINCT UnlockTbl.SerialNo) 
```

**1）。`LEFT JOIN`**

A`LEFT JOIN`确保`LicenseTbl`返回所有行，即使`UnlockTbl`表中没有匹配项。 *（如果没有匹配项，则`UnlockTbl`表的值都表示为`NULL`。）*

**2）。`UnlockTbl.UninstallTime IS NULL`在`JOIN`而不是`WHERE`**

该`WHERE`子句应用于. *_* `JOIN`这意味着任何具有实际值*（NOT NULL）*`UnlockTbl`的记录都会被加入，*然后*被过滤掉。这反过来意味着，如果 中的*所有*相关记录在 中具有非 NULL 值，则该许可证的所有行都将被过滤。`UninstallTime`***`UnlockTbl``UninstallTime`***

 *****3）。`GROUP BY`只是许可证，而不是密钥。**

简单地说，我不知道你为什么把它放在那里，而且它没有出现在你想要的英文描述中。

由于您需要 LicenseID 列表，因此*仅*按该字段分组可确保您获得每个 LicenseID 一条记录。

**4）。`HAVING`子句修改为查看`COUNT(DISTINCT SerialNo)`**

`COUNT(*)`计算所有记录。即使没有匹配*（所有`UnlockTbl`值都显示为 NULL）*，这也会返回`1`。

`COUNT(SerialNo)`只计算`SerialNo`不为空的记录。如果没有匹配*（所有`UnlockTbl`值都显示为 NULL）*，这将返回`0`。

`COUNT(DISTINCT SerialNo)`也只计算`SerialNo`不为 NULL 的记录，但将 sme 值的重复项视为仅 1 个条目。

**5）。`ORDER BY COUNT(DISTINCT SerialNo)`**

采用与在子句中过滤的值相同的值`HAVING`，并按其排序。***

# ruby - 如何修改此正则表达式以排除 URL 中的标点符号？

> ID：10957115
> 
> 赞同：0
> 
> 时间：2012-06-08T23:24:45.450
> 
> 标签：ruby, regex, pattern-matching

我已经修改了我在[这里](http://daringfireball.net/2010/07/improved_regex_for_matching_urls)找到的一个正则表达式，以便它可以接受各种英国和二级 TLD。

```
/\b((?:^https?:\/\/|^[a-z0-9.\-]+[.][a-z]{2,4})(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!@()\[\]{};:'".,<>?]))/i 
```

但是，正如您在我的测试数据中看到的那样[，](http://rubular.com/r/3KgVUrL1iz)正则表达式匹配 URL，例如`www.zapple.@com`和`https://m!crosoft.com`无效。

由于某种原因`@`，符号在 the 之前被排除在外，`.com`但在 the 之后`.`却没有。

根本不排除感叹号，这令人困惑，因为据我所知，句号之前只允许使用字母、数字和破折号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:17:10.770

@ 匹配于

```
[^\s()<>]+ 
```

和！标记为

```
(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+ 
```

我不知道，但这看起来不像是匹配 url 的好正则表达式

根据 RFC 3986 尝试以下匹配 url 绝对和相对 url'sare 支持。

将不区分大小写设置为 true

```
^
(# Scheme
 [a-z][a-z0-9+\-.]*:
 (# Authority & path
  //
  ([a-z0-9\-._~%!$&'()*+,;=]+@)?              # User
  ([a-z0-9\-._~%]+                            # Named host
  |\[[a-f0-9:.]+\]                            # IPv6 host
  |\[v[a-f0-9][a-z0-9\-._~%!$&'()*+,;=:]+\])  # IPvFuture host
  (:[0-9]+)?                                  # Port
  (/[a-z0-9\-._~%!$&'()*+,;=:@]+)*/?          # Path
 |# Path without authority
  (/?[a-z0-9\-._~%!$&'()*+,;=:@]+(/[a-z0-9\-._~%!$&'()*+,;=:@]+)*/?)?
 )
|# Relative URL (no scheme or authority)
 ([a-z0-9\-._~%!$&'()*+,;=@]+(/[a-z0-9\-._~%!$&'()*+,;=:@]+)*/?  # Relative path
 |(/[a-z0-9\-._~%!$&'()*+,;=:@]+)+/?)                            # Absolute path
)
# Query
(\?[a-z0-9\-._~%!$&'()*+,;=:@/?]*)?
# Fragment
(\#[a-z0-9\-._~%!$&'()*+,;=:@/?]*)?
$ 
```

**更新 1**

这不匹配 m!crosoft.com 和 @pple.com 这可能是由于与 Rublar 的关系。

![在此处输入图像描述](../Images/3871c78891db316dea3c9c609f22fe90.png)

# c++ - 混合数字类操作数重载 C++

> ID：10957116
> 
> 赞同：0
> 
> 时间：2012-06-08T23:24:49.350
> 
> 标签：c++, overloading, operands

所以我正在为我的 OO 课程编写一个[混合数字](http://en.wikipedia.org/wiki/Fraction_%28mathematics%29#Mixed_numbers)课程。我们需要重载每个比较和布尔操作数（除其他外），但我在如何考虑“<”和“>”操作数方面遇到了麻烦。这是我的 '==' 和 '!=' 操作数函数，用于某些上下文。

编辑：另外，如果有人对加法/减法方法有任何提示，我将不胜感激。

```
bool operator ==(Mixed& mn1, Mixed& mn2){

mn1.ToFraction();
mn2.ToFraction();

mn1.Simplify();
mn2.Simplify();

if(mn1.numerator == mn2.numerator && mn1.denominator == mn2.denominator)
    return true;
else
    return false;
} 
```

和

```
bool operator !=( Mixed& mn1,  Mixed& mn2){
mn1.ToFraction();
mn2.ToFraction();

mn1.Simplify();
mn2.Simplify();

if(mn1.numerator == mn2.numerator && mn1.denominator == mn2.denominator)
    return false;
else
    return true;
} 
```

如果有人可以提供一些指导，我将不胜感激。哦，我们不能将它们转换为小数进行比较。

编辑：这是我的标题。

```
#include <iostream>

using namespace std;

class Mixed
{
public:
Mixed(int integer, int numerator = 0, int denominator = 1);
Mixed(int integer = 0);
double Evaluate();
void ToFraction();
void Simplify();

friend istream& operator >>(istream& in, Mixed& mn);
friend ostream& operator <<(ostream& out, Mixed& mn);

friend bool operator ==( Mixed& mn1,  Mixed& mn2);
friend bool operator !=( Mixed& mn1,  Mixed& mn2);
friend bool operator >( Mixed& mn1,  Mixed& mn2);
friend bool operator <( Mixed& mn1,  Mixed& mn2);
friend bool operator <=( Mixed& mn1,  Mixed& mn2);
friend bool operator >=( Mixed& mn1,  Mixed& mn2);

friend const Mixed operator +( Mixed& mn1,  Mixed& mn2);
friend const Mixed operator -( Mixed& mn1,  Mixed& mn2);
friend const Mixed operator *( Mixed& mn1,  Mixed& mn2);
friend const Mixed operator /( Mixed& mn1,  Mixed& mn2);

private:
int GCD(int a, int b);
int integer, numerator, denominator;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T23:34:29.237

有理数非常简单：有理数是一对整数 (a, b)，通常写为`a / b`，直到 (a, b) ≡ (a', b') 当且仅当 ab' = a'b。

因此，如果您的类包含两个有代表性的整数`p`和`q`，您可以将相等运算符实现为：

```
struct Rational
{
    int p;            // numerator
    unsigned int q;   // denominator

    bool operator==(Rational const & rhs) const
    {
        return p * rhs.q == rhs.p * q;
    }

    // ...
}; 
```

对于两个*积极的*理性，你有不平等通过`p * rhs.q < rhs.p * q`。所有其他关系都可以根据这两者来实现，例如与等`x <= y`相同。`!(y < x)`

正如您似乎已经实现的那样，可以通过将分子和分母除以它们的 GCD 来取消有理数到最低项。

“混合”数字，即整数加上小于一的有理数，被简单地转换为通常的分子-分母有理数表示以进行操作，并通过整数除法和余数返回混合形式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T23:45:24.040

要比较有理数，您通常希望找到一个公分母，然后比较分子。对于这样的比较，您也不需要减少到最低的术语（尽管它足够快/容易，这样做通常是无害的）。

如果您决定保持相等比较的原样，您可以将它们简化为以下内容：

```
bool operator ==(Mixed mn1, Mixed mn2){    
    mn1.ToFraction();
    mn2.ToFraction();

    mn1.Simplify();
    mn2.Simplify();

    return mn1.numerator == mn2.numerator && mn1.denominator == mn2.denominator;
} 
```

# ruby-on-rails - Rails 路由-redirect_to 产生周期而不是反斜杠

> ID：10957117
> 
> 赞同：0
> 
> 时间：2012-06-08T23:24:51.320
> 
> 标签：ruby-on-rails

我想使用以下行：

```
redirect_to dispensers_url(current_user.id) 
```

生成以下内容：

```
dispensers/13 
```

但是我得到：

```
dispensers.13 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T23:27:59.770

助手应该是dispenser_url 而不是dispensers_url。后者用于索引操作。

# java - 从 N aire Tree 生成二 叉树 - 递归方法不起作用

> ID：10957124
> 
> 赞同：0
> 
> 时间：2012-06-08T23:25:46.523
> 
> 标签：java, tree, xml-parsing, binary-tree, jdom

我试图将一棵通用树（具有一个或多个子级的树）转换为二叉树。我的通用树由一个 XML 文件名“1.xml”表示，其中包含：

```
<A>
    <B/>
    <C>
        <E/>
        <F/>
    </C>
    <D/>
 </A> 
```

所以我可以像这样表示二叉树：

![在此处输入图像描述](../Images/294ce8eda2ddcfc9133a5adfb3c5ed60.png)

现在要将这棵树转换为二叉树，我使用以下方法：

```
 A ---- # -------- # ------ # 
        |          |        |
        B    C--#--#        D 
                |  |
                E  F 
```

（#(DIESE) 的数量是指给定节点的兄弟节点数）最右边的节点是树的根。

```
 A <---- # <-------- # <------ # 
          |           |         |
          B   C<--#<--#         D 
                  |   |
                  E   F 
```

更清楚二叉树就像这张图

![在此处输入图像描述](../Images/eb9781c114d1017a24692f3b4c1beb4b.png)

为此，我编写了以下代码：

```
public static Node NaireTreeToBinaryTree (Node node,Document d)
{

    if (isLeaf(node))
    {
        return node;            
    }
    else 
    {
        List<Element> liste = GetChildren(node);
        Node tmp= d.createElement(node.getNodeName());          
        for (int i=0;i<liste.size();i++)
        {
            Element root = d.createElement("DIESE");
            root.appendChild(tmp);

            Element child2 = d.createElement(NaireTreeToBinaryTree(liste.get(i),d).getNodeName());
            root.appendChild(child2);
            tmp=root;

        }
      return tmp;
    }

}

public static void WritingIntoXML (Node node ,Document d)
{
    try{

        d.appendChild(node);

        TransformerFactory transformerFactory = TransformerFactory.newInstance();
        Transformer transformer = transformerFactory.newTransformer();
        DOMSource source = new DOMSource(d);

        // Output to console for testing
        StreamResult result2 = new StreamResult(System.out);

        transformer.transform(source, result);

    }
    catch(Exception e)
    {
        e.printStackTrace();
    }

}

public static void main(String[] args) {

    Node root = GetNodeParent("1.xml"); // Get the node parent

    try{
    DocumentBuilderFactory docFactory = DocumentBuilderFactory.newInstance();
    DocumentBuilder docBuilder = docFactory.newDocumentBuilder();
    Document doc = docBuilder.newDocument();

    Node a =NaireTreeToBinaryTree (root, doc);

    WritingIntoXML (a ,doc);

    }
    catch (Exception e )
    {
        e.printStackTrace();
    }

} 
```

我得到这个结果（我把 DIESE（父节点的名称）而不是 # ）：

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
 <DIESE>
    <DIESE>
           <DIESE>
              <A/>
              <B/>
          </DIESE>
       <DIESE/>
    </DIESE>
    <D/>
</DIESE> 
```

有树缺少节点 C,E,F 所以我不知道为什么？是递归方法中的问题**NaireTreeToBinaryTree**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T01:02:10.613

正如您将看到的，一个复制错误，它用一个节点替换了一个新的子树。

```
public static Node naireTreeToBinaryTree (Node node,Document d)
{
    if (isLeaf(node))
    {
        //-return node;            
        return d.createElement(node.getNodeName());
    }
    else 
    {
        List<Element> liste = getChildren(node);
        Node tmp= d.createElement(node.getNodeName());          
        for (int i=0;i<liste.size();i++)
        {
            Element root = d.createElement("DIESE");
            root.appendChild(tmp);

            //-Element child2 = d.createElement(naireTreeToBinaryTree(liste.get(i),d).getNodeName());
            Node child2 = naireTreeToBinaryTree(liste.get(i),d);
            root.appendChild(child2);
            tmp=root;

        }
      return tmp;
    }
} 
```

# reporting-services - SSRS 如何更改 Web 部件中的参数位置？

> ID：10957125
> 
> 赞同：0
> 
> 时间：2012-06-08T23:25:48.443
> 
> 标签：reporting-services, position, ssrs-2008

目前，如快照所示，我的参数显示在 Web 部件的右侧。

![在此处输入图像描述](../Images/39faf642bb8ff42acb12d094fd1d6139.png)

但是，我需要将参数过滤器移动到 webpart 的顶部。此外，它应该仍在 webpart 中。我怎么能做这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:42:45.193

您无法使用现有的 Web 部件来做到这一点。如果您需要其他位置的参数，则需要创建自定义 Web 部件。

# sql-server-2008 - SQL Server 2008 - 将 7 个表连接在一起

> ID：10957129
> 
> 赞同：1
> 
> 时间：2012-06-08T23:26:27.143
> 
> 标签：sql-server-2008, tsql

我有七个表（它们有唯一的行，但有些列是相同的，但每个表都是我们唯一的）。我想创建所有七个表的一个表/视图，但在一个中显示具有相同名称的列。

**表格1**

```
custid, ref#, uniq1, uniq2, field3, fiel4 
```

**表2**

```
custid, ref#, uniq1, uniq2, field3, fiel4, field5, field6 
```

**表3**

```
custid, ref#, uniq1, uniq2, field5, field6, field7, field8 
```

**需要输出**

表/视图

```
custid, ref#, uniq1, uniq2, field3, field4, field5, field6, field7, field8 
```

会有很多空值，但这很好

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T00:17:48.970

应该注意的是，`Union`谓词将强制结果的唯一性。因此，您可能想要使用`Union All`不会“唯一化”结果的。此外，您需要为缺少的列添加占位符值（在本例中，我使用 NULL），以便每个 Select 语句返回相同数量的列：

```
Select custid, ref#, uniq1, uniq2, field3, fiel4, NULL As field5
    , NULL As field6, NULL As field7, NULL As field8
Union All
Select custid, ref#, uniq1, uniq2, field3, fiel4, field5, field6, NULL, NULL
Union All
Select custid, ref#, uniq1, uniq2, NULL, NULL, field5, field6, field7, field8 
```

最后，在 Union 或 Union All 查询中，第一个查询中的列名用于结果的列名。因此，对于第一个查询中的占位符值，您将需要添加列别名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T23:29:26.717

你想要一个联合，而不是一个连接：

```
select x, y from table1
union
select x, y from table2
... 
```

# jquery - 在 JSON 中解析 XML

> ID：10957133
> 
> 赞同：2
> 
> 时间：2012-06-08T23:27:15.117
> 
> 标签：jquery, xml, json, yql

我正在使用 YQL 在 jQuery 中进行跨域 REST 请求。我在 JSON 响应中获得了我想要的作为键值对的 XML 响应。

我提出的要求是：

```
http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20xml%20where%20url%3D%22https%3A%2F%2Fwww.quickbase.com%2Fdb%2Fmain%3Fact%3DAPI_Authenticate%26username%3Dsomething%40intuit.com%26password%3Dsomething%26hours%3D24%22&format=xml&callback=? 
```

我得到的回应是：

![在此处输入图像描述](../Images/a9dbb14168f4750ad0b7cc118d44803a.png)

现在，我的问题是，如何将 results[0] 解析为 XML 文档？任何帮助将不胜感激。

谢谢和问候， 阿什温

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:40:06.827

试试这个

```
var xml = $.parseXML( results[0] );
$(xml).find("qdbapi").each(
  function() {
     var action = $(this).attr("action");
  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:09:49.763

这对我有用。

```
if (window.DOMParser)
{
    parser=new DOMParser();
    xmlDoc=parser.parseFromString(results[0],"text/xml");
}
else
{
    xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
    xmlDoc.async=false;
    xmlDoc.loadXML(results[0]);
} 
```

# ruby - 为什么在带有块的数组上调用 zip 总是返回 nil

> ID：10957136
> 
> 赞同：16
> 
> 时间：2012-06-08T23:28:04.243
> 
> 标签：ruby, arrays

所以我试图取两个数组`a`并`b`返回第三个数组，使得第三个数组的第*n*^个元素是数组的第*n*^个`a`元素的和`b`。我正在研究`#zip`交错数组的方法，例如 if`a = [1, 2, 3]`和`b = [4, 5, 6]` `a.zip(b) = [[1, 4], [2, 5], [3, 6]]`. ruby-doc.org 说*如果给出了一个块，它会为每个输出数组调用......*虽然搞砸了它，但我发现了一些有趣的东西。如果你用一个块调用 zip，它似乎总是返回 nil。我在这里做错了吗？

```
c = a.zip(b) { |x| x.reduce(:+) } 
```

返回`nil`

```
c = a.zip(b).map { |x| x.reduce(:+) } 
```

返回想要的结果

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T23:48:10.607

### 不

无论好坏，这就是它的工作原理。它*要么*返回结果，*要么*将结果交给块；它不能两者兼得。

顺便说一句，在你的例子`a.zip(b)`中实际上是`[[1, 4], [2, 5], [3, 6]]`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T23:51:32.753

[Array#zip](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-zip)上的文档指出，如果给出一个块，则返回 nil。

# java - 创建计数数组的最有效方法

> ID：10957137
> 
> 赞同：0
> 
> 时间：2012-06-08T23:28:13.457
> 
> 标签：java, arrays, performance

制作给定长度数组的最有效方法是什么，每个元素都包含其下标？

我的虚拟级代码的可能描述：

```
/**
 * The IndGen function returns an integer array with the specified dimensions.
 *  
 *  Each element of the returned integer array is set to the value of its 
 *  one-dimensional subscript.
 *  
 *  @see Modeled on IDL's INDGEN function: 
 *      http://idlastro.gsfc.nasa.gov/idl_html_help/INDGEN.html 
 *  
 *  @params size
 *  @return int[size], each element set to value of its subscript
 *  @author you
 *  
 *  */

public int[] IndGen(int size) {
    int[] result = new int[size];
    for (int i = 0; i < size; i++) result[i] = i;
    return result;
} 
```

欢迎其他提示，例如文档样式。

## 编辑

我在其他地方读过`for`循环与其他方法相比效率低下，例如在[Copying an Array](http://www.javapractices.com/topic/TopicAction.do?Id=3)中：

> 使用克隆：93 毫秒
> 
> 使用 System.arraycopy：110 毫秒
> 
> 使用 Arrays.copyOf：187 毫秒
> 
> 使用 for 循环：422 毫秒

我对这个网站上一些问题的富有想象力的回答印象深刻，例如，[显示从 1 到 100 的数字，没有循环或条件](https://stackoverflow.com/questions/2044033/display-numbers-from-1-to-100-without-loops-or-conditions)。这是一个可能建议一些方法的答案：

```
public class To100 {
public static void main(String[] args) {
        String set = new java.util.BitSet() {{ set(1, 100+1); }}.toString();
        System.out.append(set, 1, set.length()-1);
    }
} 
```

**如果您无法解决这个具有挑战性的问题，则**无需发泄：只需继续下一个未回答的问题，您可以处理的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:57:05.390

由于一次使用 TB 的内存是不可行的，尤其是同时使用它们进行任何计算，您可能会考虑使用生成器。（您可能打算循环遍历数组，对吗？）使用生成器，您无需初始化数组（因此您可以立即开始使用它）并且几乎不使用内存（O(1)）。

我在下面包含了一个示例实现。它受到`long`原语的限制。

```
import java.util.Iterator;
import java.util.NoSuchElementException;

public class Counter implements Iterator<Long> {
    private long count;
    private final long max;

    public Counter(long start, long endInclusive) {
        this.count = start;
        this.max = endInclusive;
    }

    @Override
    public boolean hasNext() {
        return count <= max;
    }

    @Override
    public Long next() {
        if (this.hasNext())
            return count++;
        else
            throw new NoSuchElementException();

    }

    @Override
    public void remove() {
        throw new UnsupportedOperationException();
    }
} 
```

在下面找到一个使用演示。

```
Iterator<Long> i = new Counter(0, 50);
while (i.hasNext()) {
    System.out.println(i.next());  // Prints 0 to 50
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T23:39:48.380

我唯一能想到的是使用“++i”而不是“i++”，但我认为java编译器已经有了这个优化。

除此之外，这几乎是最好的算法。

你可以创建一个类，它就像它有一个数组但它没有，它只会返回它得到的相同数字（也就是身份函数），但这不是你所要求的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T00:15:31.697

正如其他人在他们的回答中所说，您的代码已经接近我能想到的最有效的，至少对于小型数组而言。如果您需要多次创建这些数组并且它们非常大，那么您可以一次创建所有数组，然后复制它们，而不是在 for 循环中不断迭代。如果数组非常大，复制操作将比遍历数组更快。它会是这样的（在这个例子中最多有 1000 个元素）：

```
public static int[][] cache = {{0},{0,1},{0,1,2},{0,1,2,3},{0,1,2,3,4}, ..., {0,1,2,...,998,999}}; 
```

然后，从您需要多次创建这些数组的代码中，您将使用如下内容：

```
int[] arrayOf50Elements = Arrays.copyOf(cache[49], 50); 
```

请注意，这种方式会使用大量内存来提高速度。我想强调的是，只有当您需要多次创建这些数组，数组非常大，并且最大速度是您的要求之一时，这才值得复杂化。在我能想到的大多数情况下，您提出的解决方案将是最好的解决方案。

**编辑：**我刚刚看到您需要的大量数据和内存。我提出的方法需要 n^2 级的内存，其中 n 是您期望拥有的最大整数。在这种情况下，这是不切实际的，因为您需要大量的内存。忘记这个吧。我离开这个帖子是因为它可能对其他人有用。

# javascript - 如何将下拉列表中所选项目的值作为参数传递给控制器 （谷歌图表）？

> ID：10957143
> 
> 赞同：0
> 
> 时间：2012-06-08T23:29:18.477
> 
> 标签：javascript, html, asp.net-mvc, razor

我试图在下拉列表中获取所选项目的值，然后将该值传递给 MVC 控制器，`GetChartData`以便我可以使用该值从数据库中获取数据。我正在使用谷歌图表来显示数据。到目前为止，这是我正在做的事情：

**已编辑**

```
var selectedValue = 0;
    $(document).ready(function () {
        $('input').click(function () {
            selectedValue = $('select option:selected').val();
            drawChart();
        });
    }); 
```

**结束编辑**

```
<form name="regionform" action="">
    <select name="selectregion">
        <option value="0" selected="selected">All Regions</option>
        @foreach (var region in Model.RegionData)
        {
            <option value="@region.regionID"> @region.regionName</option>
        }
    </select>
</form>

.....more code.....

google.load('visualization', '1', { 'packages': ['annotatedtimeline'] });

    google.setOnLoadCallback(drawChart);

function drawChart() {

        $.post('/metrics/GetChartData', { sID: "@Model.SiteId", **regionID : selectedValue** },
        function (data) {

.....code.....

        );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:39:48.663

好吧，您应该能够执行以下操作：

```
{ sID: "@Model.SiteId", region: $('#selectregion').val() } 
```

您需要为您的选择提供一个 id：

```
<select name="selectregion" id="selectregion"> 
```

然后，“区域”将在您的控制器中的表单数据中可用。

# android - Android以编程方式将XML形状设置为可绘制

> ID：10957145
> 
> 赞同：25
> 
> 时间：2012-06-08T23:29:27.037
> 
> 标签：android, xml, resources, drawable, shape

您好，我有一个可绘制的 myshape.xml，它包含一个`<shape>`并且我无法将 android:id 设置为形状。

在我的代码中，我想将视图的背景设置为此文件使用

`catAll.setBackgroundDrawable(getResources().getDrawable(R.id......???));`

其中 myshape.xml 没有出现在我的 R 文件中，因为它没有 id。我不能将 id 设置为对象。

在我的 XML 中，我通过简单地输入可绘制资源名称来设置形状。但我需要以编程方式执行此操作。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-08T23:30:42.050

您不需要自己获取可绘制对象。改用这个：

```
catAll.setBackgroundResource(R.drawable.myshape); 
```

为了将来参考，如果您**确实**希望获得可绘制对象，请记住可绘制对象存在于*R.drawable*命名空间中。所以你的代码会变成：

```
getResources().getDrawable(R.drawable.myshape); 
```

这类似于您在 XML 中所做的事情：

```
@drawable/myshape 
```

代替

```
@id/myshape 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-23T08:29:53.000

这个问题真的很老，但谷歌首先点击了这个线程的引用。

所以`getDrawable(id)`被弃用了。

简短的解决方案（科特林）

```
yourView.background = ContextCompat.getDrawable(context, R.drawable.your_ressource_id) 
```

有关更多信息，请阅读：[https ://stackoverflow.com/a/29146895/4420355](https://stackoverflow.com/a/29146895/4420355)

# html - 用于判断两个 html 页面是否是同一个“页面”的轻量级方法的启发式方法

> ID：10957149
> 
> 赞同：0
> 
> 时间：2012-06-08T23:29:40.803
> 
> 标签：html, comparison, webpage

我知道已经问过类似的问题，但我想知道是否存在一些代码\包，或者关于如何判断两个 url 是否是同一个页面的一些想法。

为了激励，假设我想做的是编写一个 chrome 扩展程序，告诉你有多少你的 facebook 朋友访问了一个链接。

当然，简单地比较 url 是行不通的，因为某些 url 参数可能很关键，而其他参数则不是，例如，与参数关键`google.com?query=help`的页面不同，而与（我当然正在编造这些示例）相同。`google.com?query=idea``query``google.com?referrer=facebook``google.com?referrer=twitter`

此外，比较页面的内容并不能保证有效，好像有随机部分（“相关故事”）或用户特定内容（标题“嗨，诺姆，我们有一段时间没见到你了”）。

当然，我并不是在寻找一种万无一失的方法，只是在大多数正常行为的网站上都可以使用。

关于如何做到这一点的包（任何语言）或想法的任何好的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T23:33:39.143

任何关于字符串比较的标准距离度量都应该为您提供各种 URL 内容的分数。据推测，更相似的内容将比不太相似的 URL 获得更好的分数，因此对结果进行排名并进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T23:47:35.363

无法确保两个页面相同。可能有用户特定的内容（某些用户的登录按钮，其他用户的个人问候）、广告、浏览器特定的内容（Chrome 的 CSS3、Opera 的 CSS2、IE6 用户的驱动下载利用 :)）

相同的资源可能在不同的 URL (`/article/4-funny-ways-to-encrypt-your-shellcode-123456`或`/article.php?id=123456`) 下可用。可能有我的两个域用于相同的内容（`www.domain.com`并且`domain.com`，甚至可能`domain.co.uk`）。您可以从可能包含文件修改日期的标题中获得一些线索`Last-Modified:`，但是当涉及到动态内容时，它也可以包含生成日期。`ETag`如果正确实施，至少在 ruby​​ on rails 中可能有一个包含底层资源哈希的标头，但这种情况并不常见。

因此，您可能唯一能做的就是比较这些页面并计算一些指标。我会考虑域、IP 地址和页面内容进行比较。IP 地址和域（或域分数）的权重更高。所以你可以计算出一定的概率，但是没有办法保证两个页面*是一样的*。

# string - 如何在 jtextarea(java) 中将颜色设置为字符串中的某些字符，而不是整个字符串？

> ID：10957150
> 
> 赞同：0
> 
> 时间：2012-06-08T23:30:02.217
> 
> 标签：string, jtextarea

如何在 jTextArea(java) 中设置字符串中的某些字符而不是整个字符串的颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:04:38.787

我已经有一段时间没有用 Java 编写代码了，但是您可以尝试创建要创建特定颜色的文本的子字符串，然后将子字符串的颜色设置为所需的颜色。我希望这是有道理的。

# objective-c - 重复符号错误 - 全局常量

> ID：10957152
> 
> 赞同：14
> 
> 时间：2012-06-08T23:30:17.473
> 
> 标签：objective-c, linker, compiler-errors, constants

在类的头文件中，在接口声明之外，我声明了全局常量：

```
NSString * const gotFilePathNotification = @"gotFilePath";
NSString * const gotResultNotification = @"gotResultOfType"; 
```

gotResultNotification 仅在此类中使用（还），但我在另一个类实现中引用了 gotFilePathNotificaion。为此，我导入了此标头。

当我尝试编译时，我在此标头中收到有关 gotFilePathNotification 的重复符号链接器错误。为什么会这样？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-08T23:39:29.157

您在文件范围内的两个不同编译单元中有两个同名的标识符。这违反了[一个定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)。相反，您需要 -

1.  在头文件中声明全局变量标记以具有外部链接。

    ```
    extern NSString * const gotFilePathNotification; 
    ```

2.  现在**只**在一个源文件中提供定义。

    ```
    NSString * const gotFilePathNotification = @"gotFilePath"; 
    ```

现在，无论您需要在哪里使用这些变量，都可以在源文件中包含标头。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T23:34:22.513

您需要在头文件中声明它们 extern 并在实现文件中定义它们。请参阅此问题以进行澄清。 [Cocoa/Objective-C 中的全局变量？](https://stackoverflow.com/questions/338195/global-variables-in-cocoa-objective-c).

第二个答复提供了我将在此重申的澄清。变量的默认存储限定符是静态的。这意味着当您尝试使用相同的变量链接两个不同的文件时，正如您导入头文件时会发生的那样，链接器将解释该变量是多重定义的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-27T20:37:12.697

还要确保包含 h 文件而不是 m 文件。这让我发疯了。

# javascript - 正则表达式根据下一个单词将 a 更改为 an

> ID：10957156
> 
> 赞同：0
> 
> 时间：2012-06-08T23:31:13.620
> 
> 标签：javascript, regex

所以我尝试编写一个脚本，将转向`a`（`an`必要时）。这比我想象的要难。

```
var txt = "This is a apple.";

var pos = txt.search(/a\s[aeiou]/i);
txt = pos != -1 ?
      txt.substring(0,pos+1) + "n" + txt.substring(pos+1,txt.length) :
      txt;
//"This is an apple." 
```

它正在工作，但是当我尝试时`"There are 60 minutes in a hour."`，它并没有`an`因为正则表达式而改变。所以我改变了它：

```
var pos = txt.search(/a\s([aeiou]|hour)/i); 
```

现在它正在工作（至少“小时”）。但是现在如果我放`"There are people in a university."`，它会变成`an university`，这是不正确的。

那么，有没有一个正则表达式可以涵盖英语中使用`a`and的规则呢？`an`谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T23:35:27.130

不久前在 StackOverflow 上有一个非常好的帖子：[如何正确地为单词添加“a”和“an”前缀？](https://stackoverflow.com/questions/1288291/how-can-i-correctly-prefix-a-word-with-a-and-an)

基本上共识是，最好的方法是从一个大型数据集进行学习，其次是一个发音词典，例如为语音合成而设计的 CMU dict。

举一个 CMU dict 的例子：

```
University comes out as:
Y UW N AH V ER S AH T IY . 

Umbrella is rendered as:
AH M B R EH L AH . 
```

# php - 尝试使用 post 到运行 codeigniter 项目的虚拟机服务器

> ID：10957157
> 
> 赞同：0
> 
> 时间：2012-06-08T23:31:19.220
> 
> 标签：php, jquery, firefox, google-chrome, debian

我正在我的计算机（debian 6.0.2.1）上运行一个运行 apache+php+mysql 服务器的虚拟机。在我的本地机器上，我安装了一个 WAMP 堆栈。在两台机器上，我都部署了 CodeIgniter 并运行了一个 RESTful API。

我想做的是从本地机器的应用程序与我的虚拟机通信。虚拟机的应用程序接受端点的 post 和 get 方法。例如 http:///thumbs/save/ 它应该返回一条消息。如果我在浏览器中测试它的 get 方法，它运行良好。问题是当我尝试使用 jquery post/get 从其他应用程序（本地机器部署）访问它时，我得到以下信息：对于 chrome 照常：XMLHttpRequest 无法加载 http:///api/thumbs/save。Access-Control-Allow-Origin 不允许来源“http://localhost”。

和 Firefox 只是抛出一个状态为 OK 的 200 但它显示为红色并且没有响应。

一点帮助将不胜感激。如果您需要代码示例，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:41:49.647

您看到该错误 Access-Control-Allow-Origin 的原因是为了防止称为 XSS（跨站点脚本）的安全问题。您的一个域是 localhost，另一个是 API。

看看这个问题/答案，了解一些解决方法。没有代码示例，因此不确定您使用的是什么方法/访问类型：[Access-Control-Allow-Origin error sent a jQuery Post to Google API's](https://stackoverflow.com/questions/6114436/access-control-allow-origin-error-sending-a-jquery-post-to-google-apis)

# symfony - Symfony2 Sonata 管理错误

> ID：10957158
> 
> 赞同：0
> 
> 时间：2012-06-08T23:31:44.913
> 
> 标签：symfony, symfony-sonata

我最近做了一个供应商/安装，现在我的奏鸣曲管理员因以下错误而崩溃：

SonataAdminBundle::standard_layout.html.twig 第 92 行中不存在“”的项目“角色”

这是树枝代码：

```
{% if app.security %}
  {% for role in app.security.token.roles %}
    {% if not allowed %}
      {% set allowed = role.role == 'ROLE_SONATA_ADMIN' %}
    {% endif %}
  {% endfor %}
{% endif %} 
```

有人有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T19:57:13.027

我搜索了带有责备选项的管理包，它来自 7 天前的提交

所以你要做的就是去 deps.lock

找到 adminBundle 提交哈希（在我的情况下，它以 4a.... 开头）用 25b401e6271ee0fd896d700d0328b06994e4e138 替换哈希，这是导致问题的提交之前的提交

我试过了，仪表板工作正常

祝你好运

***编辑***

注意不要使用 php bin/vendor update 因为它会更新提交哈希

使用 php bin/vendor 安装

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:12:21.953

这是修复：[https ://github.com/Wiakowe/SonataAdminBundle/commit/e139527c05b22176ee3efab987ebe752668d4489](https://github.com/Wiakowe/SonataAdminBundle/commit/e139527c05b22176ee3efab987ebe752668d4489)

删除第 90-99 行并替换为以下内容：

```
{% if app.security and is_granted('ROLE_SONATA_ADMIN') %} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T12:59:29.157

我对 SonataAdminBundle 的最新版本也有同样的问题。如果您允许所有人打开您的管理面板，则会出现此问题。至少对于工作站点来说，这不是通常的解决方案。

要授予所有人访问您的管理面板的权限，请执行以下操作。将路径**/admin**放在防火墙下，将行添加到**security.yml**部分中的文件**security.firewals中**

 **```
 admin_area:
        pattern: ^/admin
        anonymous: ~ 
```

因此，每个客户端都将被授权为具有现有令牌的**匿名用户**，并且不会出现错误。

PS对不起语法错误，但我想每个人都会理解我的:)**

# java - 使用 Eclipse 将所有外部类打包到我的 jar 中

> ID：10957159
> 
> 赞同：1
> 
> 时间：2012-06-08T23:32:02.933
> 
> 标签：java, eclipse, maven, hadoop

我正在 Eclipse 中开发一个 Hadoop 项目，该项目依赖于我的另一个项目；我在构建路径中包含了另一个项目，但是当我导出依赖项目时，它只包含来自同一个项目的类。

通常，这不会成为问题，因为我可以将另一个项目与 -cp 标志链接起来，但 Hadoop 要求您将 jar 作为参数传递，这意味着我的所有依赖项都必须在该 jar 中。

有没有办法在 Eclipse 中自动构建和包含您所依赖的项目中的类？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T04:59:51.500

您可以使用[Ant](http://ant.apache.org/)自动构建、测试和导出。它需要一些时间来学习它，但它是值得的。有可能的任务（文件集、zipgroupfileset、复制）将文件、jar（解压缩）或任何东西包含到最终的 jar 中。通过这种方式，您肯定知道分发 jar 中的内容，并且您不需要运行 ecipe 安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T13:19:29.000

我建议你看看 maven 作为构建工具。您在称为 pom 文件的文件中定义每个项目的依赖关系和构建步骤。Eclipse 的 maven 插件（m2e 插件）可以采用 pom 文件中的配置并设置您的 Eclipse 构建路径和项目描述，以便您可以访问 Eclipse 中其他项目中的类。Maven 还可以为您创建一个 jar，其中包含来自两个项目的类（“jar-with-dependencies”）。

在 Maven 术语中，您的两个项目被称为“工件”，其中一个项目依赖于另一个项目。

maven 的一个缺点（以及许多关于 maven 的负面评论的原因）是最初陡峭的学习曲线，这可能会令人沮丧。但是，您要尝试做的事情非常简单，我希望您能找到一些示例，向您展示您想要做什么。

第一步，这就是我的回答，是看看 maven。它可能看起来过于复杂，但随着您的 hadoop 应用程序变得越来越复杂，它可以扩展以处理您需要的几乎任何构建配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T02:25:53.977

您可以将项目导出为 Runnable jar，如果您想要一个包含依赖项的单个 jar，这可能会很有用。

选择项目。文件 > 导出。选择 Java 部分。选择可运行的 JAR 文件。

查看相关答案：

[Eclipse：如何使用外部 jar 构建可执行 jar？](https://stackoverflow.com/questions/502960/eclipse-how-to-build-an-executable-jar-with-external-jar)

# php - 带有 bind_param 的“无效对象或资源”

> ID：10957162
> 
> 赞同：1
> 
> 时间：2012-06-08T23:32:25.523
> 
> 标签：php, mysqli, prepared-statement

我正在为 MySQL 数据库制作 PHP 前端。我有一个名为“Regions”的表，其中包含 RegionID (int)、Name (string) 和 Country (string)。我正在尝试将 <select> 列表放入包含所有区域作为选项的表单上，使用 <optgroup> 来按国家/地区对区域进行分组。我已经通过嵌套的普通查询成功地完成了它，现在我正试图了解准备好的语句。

到目前为止，我得到的是：

```
// $DB is database object, already connected
// Error checking will be worked into this once I've worked out the basics...

$stmt_country = $DB->stmt_init();
$stmt_country->prepare("SELECT DISTINCT Country FROM Regions ORDER BY Country ASC");
$stmt_country->execute();
$stmt_country->bind_result($CountryName);

$stmt_region = $DB->stmt_init();
$stmt_region->prepare("SELECT RegionID,Name FROM REGIONS WHERE Country=? ORDER BY Name ASC");
$stmt_region->bind_param("s",$CountryName);

echo "<select name=\"RegionID\">\n";

while ($stmt_country->fetch()) {
    // Start 'country' option group

    echo "<optgroup label=\"$CountryName\">\n";

    // Execute the 'regions' query using the 'country' parameter

    $stmt_region->execute();
    $stmt_region->bind_result($RegionID,$RegionName);

    while ($stmt_region->fetch()) {
        // Output the regions matching that country 

        echo "<option value=\"$RegionID\">$RegionName</option>\n";
        }

    echo "</optgroup>\n";
    }

echo "</select>\n"; 
```

但是，当我运行它时，我得到：

```
Warning: mysqli_stmt::bind_param(): invalid object or resource 
```

上`$stmt_region->bind_param("s",$CountryName)`线。

通过对代码进行一些注释，我只得到了`$stmt_country`一半的工作（即只输出每个国家的 optgroups），然后以 的值为`$CountryName`，它的`$stmt_region`一半自己工作，但我无法得到两半一起工作。有人可以告诉我哪里出错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T23:36:59.437

我很确定在您完成整个结果集之前，您不能将 2 个语句绑定在同一个连接资源上。因此，您的第二个`stmt_init()`实际上并未返回声明。

看起来所有数据都在同一个表上，因此不需要 2 个查询。

如果数据在两个表上，那么仍然不需要 2 个查询，因为 oyu 可以使用连接：

即使不是这种情况，您也可以做并且应该做的是使用连接来一次获取所有内容：

```
SELECT DISTINCT r.RegionID, r.Country 
FROM Regions r, Country c
WHERE c.NAME = r.Country 
ORDER BY r.Country ASC 
```

无论哪种情况，您都可以获得如下所示的结果集：

```
RegionID    Country    Name
----------------------------------
1           US         Ohio
2           US         California
3           US         New York
4           CN         Guan Dong
5           CN         Hunan
6           CN         Szechuan 
```

由于排序，您可以使用单个循环将前一个循环与`Country`当前循环进行比较，以确定何时关闭/打开您的 opt 组标签。

# java - 为什么为 setter 而不是字段设置@Required？

> ID：10957163
> 
> 赞同：2
> 
> 时间：2012-06-08T23:32:26.560
> 
> 标签：java, spring, setter, required

如果我有以下课程：

```
package com.example;

import org.springframework.beans.factory.annotation.Required;

public class Customer 
{
    private Person person;

    public Person getPerson() {
        return person;
    }
    @Required
    public void setPerson(Person person) {
        this.person = person;
    }
} 
```

为什么在 Spring 中 @Required 标记与 setter 绑定，而不是字段，像这样？

```
package com.example;

import org.springframework.beans.factory.annotation.Required;

public class Customer 
{
    @Required
    private Person person;

    public Person getPerson() {
        return person;
    }
    public void setPerson(Person person) {
        this.person = person;
    }
} 
```

依赖项是属性已设置，但不需要绑定到填充该属性或字段的特定设置器，除非我遗漏了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:59:38.333

传统上，bean 具有定义为 getter 和/或 setter 的属性。可以省略私有字段（有时称为“虚拟”字段）。在新的 Java EE 标准中，bean 更加松散，并且可能还具有定义为公共字段的属性。

尽管如此，Spring 早于最新标准，并且在方法 io 字段上添加注释具有可以通过 AOP（简单字节码操作）拦截访问的优势。

# c# - 重用业务接口以实现 WCF 服务的未来实现

> ID：10957171
> 
> 赞同：0
> 
> 时间：2012-06-08T23:34:15.333
> 
> 标签：c#, asp.net, wcf, factory, factory-pattern

晚安，伙计们，

我正在 asp.net 中启动一个项目，最初不使用 wcf 服务，但我想让您为将来在 aspx 和业务层之间实现服务 wcf 做好准备。

问题：

wcf服务可以复用业务接口吗？

我的想法是在没有服务的情况下，创建一个架构，其中 aspx 将通过工厂调用业务层。所有业务类都将实现一个接口。

稍后我们将为每个业务提供一个服务，所以我想知道这是否是一个好主意，是否可以为 wcf 服务使用为每个业务实现的相同接口。

实现相同的接口，工厂将决定是返回业务实例还是服务实例。你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:04:09.620

WCF 要求在您的接口上声明类和方法属性，因此您最终会弄得一团糟。

由于这个和其他一些原因，我实际上并不是 WCF 的忠实粉丝。 [Service Stack](http://www.servicestack.net/)相当不错，它允许人们通过 HTTP 轻松地公开业务接口。

# objective-c - 等效于 AS3 的 getDefinitionByName 的 Objective-c？

> ID：10957180
> 
> 赞同：1
> 
> 时间：2012-06-08T23:36:32.637
> 
> 标签：objective-c, actionscript-3

有没有一种方法可以通过使用字符串在objective-c 中获取/创建一个类，就像我如何在AS3 中使用getDefinitionByName 一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T23:40:39.087

尝试：

`id object = [[NSClassFromString(@"NameofClass") alloc] init];`

从这个线程：

[按名称创建objective-c类实例？](https://stackoverflow.com/questions/1174093/create-objective-c-class-instance-by-name)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T23:40:33.883

我认为您正在寻找 NSClassFromString。它应该这样使用（我从[这个答案](https://stackoverflow.com/questions/2227085/nsclassfromstring-returns-nil)中借用了这个代码；代码来自 Dave DeLong）：

```
Class dictionaryClass = NSClassFromString(@"NSMutableDictionary");
id object = [[dictionaryClass alloc] init];
[object setObject:@"Foo" forKey:@"Bar"]; 
```

# c# - 使用 C# 从 WMP 中检索歌曲名称

> ID：10957181
> 
> 赞同：1
> 
> 时间：2012-06-08T23:36:49.063
> 
> 标签：c#, wmp, wmplib

使用 C# 我试图检索当前正在播放的歌曲的名称并将其显示在列表框中，因此每首播放的歌曲都显示在列表框中。

```
Using System;
Using WMPLib;
public IWMPMedia currentMedia { get; set; }
private void button1_Click(object sender, EventArgs e)
    {
        Player = new WMPLib.WindowsMediaPlayer();
        string song = Player.currentMedia.name.ToString();
        listBox1.Items.Add(song);
    } 
```

但这让我例外。“对象引用未设置为对象的实例”这里：

```
 string song = Player.currentMedia.name.ToString(); 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T16:40:40.213

您必须使用 COM/OLE 来执行此操作。不久前我做了一个程序，不幸的是我找不到我的客户端代码，但我仍然有为 WMPLib 实现 IOleClientSite/IOleServiceProvider 的代码。

我在以下 URL 找到了该代码：http: [//sirayuki.sakura.ne.jp/WmpSample/WmpRemote.zip](http://sirayuki.sakura.ne.jp/WmpSample/WmpRemote.zip)

如果我没记错的话，它的一些代码是由微软员工 Jonathan Dibble 编写的。Zip 中有一个 CHM，其中对每个类都有一些解释。

这是我仍然拥有的代码，以防链接断开，但就像我说的那样，我找不到使用它的代码。它几乎可以正常工作，但我记得留下的一个错误是它会在媒体播放器和我的应用程序关闭后留下 wmplayer.exe 进程。

**更新**！
找到一些客户端代码和 RemotedWindowsMediaPlayer.cs 的轻微修改版本

我刚刚找到了一些我测试过的代码，它可以工作。它来自一个 Winform 项目，您需要参考 WMPLib 才能使其工作。

在我的表单中，我添加了一个按钮和这段代码：

```
 /// <summary>
    /// Default Constructor
    /// </summary>
    RemotedWindowsMediaPlayer rm;
    public FrmMain()
    {
        //
        // Required for Windows Form Designer support
        //
        InitializeComponent();

        //Call me old fashioned - I like to do this stuff manually.  You can do a drag
        //drop if you like, it won't change the results.
        rm = new RemotedWindowsMediaPlayer();
        rm.Dock = System.Windows.Forms.DockStyle.Top;
        panel1.Controls.Add(rm);

        return;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        MessageBox.Show(((WMPLib.IWMPPlayer4)rm.GetOcx()).currentMedia.sourceURL);
    } 
```

RemotedWindowsMediaPLayer.cs：

```
namespace RemoteWMP
{
    using System;
    using System.Windows.Forms;
    using System.Runtime.InteropServices;
    using WMPLib;

    /// <summary>
    /// This is the actual Windows Media Control.
    /// </summary>
    [System.Windows.Forms.AxHost.ClsidAttribute("{6bf52a52-394a-11d3-b153-00c04f79faa6}")]
    [ComVisible(true)]
    [ClassInterface(ClassInterfaceType.AutoDispatch)]
    public class RemotedWindowsMediaPlayer : System.Windows.Forms.AxHost,
        IOleServiceProvider,
        IOleClientSite
    {

        /// <summary>
        /// Used to attach the appropriate interface to Windows Media Player.
        /// In here, we call SetClientSite on the WMP Control, passing it
        /// the dotNet container (this instance.)
        /// </summary>
        protected override void AttachInterfaces() 
        {

            try
            {
                //Get the IOleObject for Windows Media Player.
                IOleObject oleObject = this.GetOcx() as IOleObject;

                if (oleObject != null)
                {
                    //Set the Client Site for the WMP control.
                    oleObject.SetClientSite(this as IOleClientSite);

                    // Try and get the OCX as a WMP player
                    if (this.GetOcx() as IWMPPlayer4 == null)
                    {
                        throw new Exception(string.Format("OCX is not an IWMPPlayer4! GetType returns '{0}'",
                                                          this.GetOcx().GetType()));
                    }
                }
                else
                {
                    throw new Exception("Failed to get WMP OCX as an IOleObject?!");
                }

                return;
            }
            catch (System.Exception ex)
            {
                System.Diagnostics.Debug.WriteLine(ex.ToString());
            }
        }

        #region IOleServiceProvider Memebers - Working
        /// <summary>
        /// During SetClientSite, WMP calls this function to get the pointer to <see cref="RemoteHostInfo"/>.
        /// </summary>
        /// <param name="guidService">See MSDN for more information - we do not use this parameter.</param>
        /// <param name="riid">The Guid of the desired service to be returned.  For this application it will always match
        /// the Guid of <see cref="IWMPRemoteMediaServices"/>.</param>
        /// <returns></returns>
        IntPtr IOleServiceProvider.QueryService(ref Guid guidService, ref Guid riid)
        {
            //If we get to here, it means Media Player is requesting our IWMPRemoteMediaServices interface
            if (riid == new Guid("cbb92747-741f-44fe-ab5b-f1a48f3b2a59"))
            {
                IWMPRemoteMediaServices iwmp = new RemoteHostInfo();
                return Marshal.GetComInterfaceForObject(iwmp, typeof(IWMPRemoteMediaServices));
            }

            throw new System.Runtime.InteropServices.COMException("No Interface", (int) HResults.E_NOINTERFACE);
        }
        #endregion

        #region IOleClientSite Members
        /// <summary>
        /// Not in use.  See MSDN for details.
        /// </summary>
        /// <exception cref="System.Runtime.InteropServices.COMException">E_NOTIMPL</exception>
        void IOleClientSite.SaveObject() 
        {
            throw new System.Runtime.InteropServices.COMException("Not Implemented", (int) HResults.E_NOTIMPL);
        }

        /// <summary>
        /// Not in use.  See MSDN for details.
        /// </summary>
        /// <exception cref="System.Runtime.InteropServices.COMException"></exception>
        object IOleClientSite.GetMoniker(uint dwAssign, uint dwWhichMoniker)
        {
            throw new System.Runtime.InteropServices.COMException("Not Implemented", (int) HResults.E_NOTIMPL);
        }

        /// <summary>
        /// Not in use.  See MSDN for details.
        /// </summary>
        /// <exception cref="System.Runtime.InteropServices.COMException"></exception>
        object IOleClientSite.GetContainer() 
        {
            return (int)HResults.E_NOINTERFACE;
        }

        /// <summary>
        /// Not in use.  See MSDN for details.
        /// </summary>
        /// <exception cref="System.Runtime.InteropServices.COMException"></exception>
        void IOleClientSite.ShowObject()        
        {
            throw new System.Runtime.InteropServices.COMException("Not Implemented", (int) HResults.E_NOTIMPL);
        }

        /// <summary>
        /// Not in use.  See MSDN for details.
        /// </summary>
        /// <exception cref="System.Runtime.InteropServices.COMException"></exception>
        void IOleClientSite.OnShowWindow(bool fShow)        
        {
            throw new System.Runtime.InteropServices.COMException("Not Implemented", (int) HResults.E_NOTIMPL);
        }

        /// <summary>
        /// Not in use.  See MSDN for details.
        /// </summary>
        /// <exception cref="System.Runtime.InteropServices.COMException"></exception>
        void IOleClientSite.RequestNewObjectLayout()        
        {
            throw new System.Runtime.InteropServices.COMException("Not Implemented", (int) HResults.E_NOTIMPL);
        }

        #endregion          

        /// <summary>
        /// Default Constructor.
        /// </summary>
        public RemotedWindowsMediaPlayer() : 
            base("6bf52a52-394a-11d3-b153-00c04f79faa6") 
        {
        }        
    }   
} 
```

远程主机信息.cs

```
using System;

namespace RemoteWMP
{
    using System.Runtime.InteropServices;

    /// <summary>
    /// This class contains the information to return to Media Player about our remote service.
    /// </summary>
    [ComVisible(true)]
    [ClassInterface(ClassInterfaceType.None)]
    public class RemoteHostInfo : 
        IWMPRemoteMediaServices
    {
        #region IWMPRemoteMediaServices Members
        /// <summary>
        /// Returns "Remote" to tell media player that we want to remote the WMP application.
        /// </summary>
        /// <returns></returns>
        public string GetServiceType()
        {   
            return "Remote";
        }

        /// <summary>
        /// The Application Name to show in Windows Media Player switch to menu
        /// </summary>
        /// <returns></returns>
        public string GetApplicationName()
        {
            return System.Diagnostics.Process.GetCurrentProcess().ProcessName;
        }

        /// <summary>
        /// Not in use, see MSDN for more info.
        /// </summary>
        /// <param name="name"></param>
        /// <param name="dispatch"></param>
        /// <returns></returns>
        public HResults GetScriptableObject(out string name, out object dispatch)
        {
            name = null;
            dispatch = null;

            //return (int) HResults.S_OK;//NotImplemented
            return HResults.E_NOTIMPL;
        }

        /// <summary>
        /// For skins, not in use, see MSDN for more info.
        /// </summary>
        /// <param name="file"></param>
        /// <returns></returns>
        public HResults GetCustomUIMode(out string file)
        {
            file = null;

            return HResults.E_NOTIMPL;//NotImplemented
        }

        #endregion
    }
} 
```

COM 接口.cs

```
using System;

namespace RemoteWMP
{
    using System.Runtime.InteropServices;

    #region Useful COM Enums
    /// <summary>
    /// Represents a collection of frequently used HRESULT values.
    /// You may add more HRESULT VALUES, I've only included the ones used 
    /// in this project.
    /// </summary>
    public enum HResults
    {
        /// <summary>
        /// HRESULT S_OK
        /// </summary>
        S_OK = unchecked((int)0x00000000),
        /// <summary>
        /// HRESULT S_FALSE
        /// </summary>
        S_FALSE = unchecked((int)0x00000001),
        /// <summary>
        /// HRESULT E_NOINTERFACE
        /// </summary>
        E_NOINTERFACE = unchecked((int)0x80004002),
        /// <summary>
        /// HRESULT E_NOTIMPL
        /// </summary>
        E_NOTIMPL = unchecked((int)0x80004001),
        /// <summary>
        /// USED CLICKED CANCEL AT SAVE PROMPT
        /// </summary>
        OLE_E_PROMPTSAVECANCELLED = unchecked((int)0x8004000C),

    }

    /// <summary>
    /// Enumeration for <see cref="IOleObject.GetMiscStatus"/>
    /// </summary>
    public enum DVASPECT
    {
        /// <summary>
        /// See MSDN for more information.
        /// </summary>
        Content = 1,        
        /// <summary>
        /// See MSDN for more information.
        /// </summary>
        Thumbnail = 2,
        /// <summary>
        /// See MSDN for more information.
        /// </summary>
        Icon = 3,
        /// <summary>
        /// See MSDN for more information.
        /// </summary>
        DocPrint = 4
    }
    /// <summary>
    /// Emumeration for <see cref="IOleObject.Close"/>
    /// </summary>
    public enum TAGOLECLOSE :uint{
      OLECLOSE_SAVEIFDIRTY   = unchecked((int)0),
      OLECLOSE_NOSAVE        = unchecked((int)1),
      OLECLOSE_PROMPTSAVE    = unchecked((int)2) 
    } 

    #endregion

    #region IWMPRemoteMediaServices
    /// <summary>
    /// Interface used by Media Player to determine WMP Remoting status.
    /// </summary>
    [ComImport,
    ComVisible(true),
    InterfaceType(ComInterfaceType.InterfaceIsIUnknown),
    Guid("CBB92747-741F-44fe-AB5B-F1A48F3B2A59")]
    public interface IWMPRemoteMediaServices
    {

        /// <summary>
        /// Service type.
        /// </summary>
        /// <returns><code>Remote</code> if the control is to be remoted (attached to WMP.) 
        /// <code>Local</code>if this is an independent WMP instance not connected to WMP application.  If you want local, you shouldn't bother
        /// using this control!
        /// </returns>
        [return: MarshalAs(UnmanagedType.BStr)] 
        string GetServiceType();

        /// <summary>
        /// Value to display in Windows Media Player Switch To Application menu option (under View.)
        /// </summary>
        /// <returns></returns>
        [return: MarshalAs(UnmanagedType.BStr)] 
        string GetApplicationName();

        /// <summary>
        /// Not in use, see MSDN for details.
        /// </summary>
        /// <param name="name"></param>
        /// <param name="dispatch"></param>
        /// <returns></returns>
        [PreserveSig]
        [return: MarshalAs(UnmanagedType.U4)]
        HResults GetScriptableObject([MarshalAs(UnmanagedType.BStr)] out string name, 
            [MarshalAs(UnmanagedType.IDispatch)] out object dispatch);

        /// <summary>
        /// Not in use, see MSDN for details.
        /// </summary>
        /// <param name="file"></param>
        /// <returns></returns>
        [PreserveSig]
        [return: MarshalAs(UnmanagedType.U4)]
        HResults GetCustomUIMode([MarshalAs(UnmanagedType.BStr)] out string file);
    }

    #endregion

    #region IOleServiceProvider
    /// <summary>
    /// Interface used by Windows Media Player to return an instance of IWMPRemoteMediaServices.
    /// </summary>
    [ComImport,
    GuidAttribute("6d5140c1-7436-11ce-8034-00aa006009fa"),
    InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown),
    ComVisible(true)]
    public interface IOleServiceProvider
    {
        /// <summary>
        /// Similar to QueryInterface, riid will contain the Guid of an object to return.
        /// In our project we will look for <see cref="IWMPRemoteMediaServices"/> Guid and return the object
        /// that implements that interface.
        /// </summary>
        /// <param name="guidService"></param>
        /// <param name="riid">The Guid of the desired Service to provide.</param>
        /// <returns>A pointer to the interface requested by the Guid.</returns>
        IntPtr QueryService(ref Guid guidService, ref Guid riid);
    }

    /// <summary>
    /// This is an example of an INCORRECT entry - do not use, unless you want your app to break.
    /// </summary>
    [ComImport,
    GuidAttribute("6d5140c1-7436-11ce-8034-00aa006009fa"),
    InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown),
    ComVisible(true)]
    public interface BadIOleServiceProvider
    {
        /// <summary>
        /// This is incorrect because it causes our return interface to be boxed
        /// as an object and a COM callee may not get the correct pointer.
        /// </summary>
        /// <param name="guidService"></param>
        /// <param name="riid"></param>
        /// <returns></returns>
        /// <example>
        /// For an example of a correct definition, look at <see cref="IOleServiceProvider"/>.
        /// </example>
        [return: MarshalAs(UnmanagedType.Interface)]
        object QueryService(ref Guid guidService, ref Guid riid);
    }
    #endregion

    #region IOleClientSite
    /// <summary>
    /// Need to implement this interface so we can pass it to <see cref="IOleObject.SetClientSite"/>.
    /// All functions return E_NOTIMPL.  We don't need to actually implement anything to get
    /// the remoting to work.
    /// </summary>
    [ComImport,
    ComVisible(true),
    Guid("00000118-0000-0000-C000-000000000046"),
    InterfaceType(ComInterfaceType.InterfaceIsIUnknown) ]
    public interface IOleClientSite
    {
        /// <summary>
        /// See MSDN for more information.  Throws <see cref="COMException"/> with id of E_NOTIMPL.
        /// </summary>
        /// <exception cref="COMException">E_NOTIMPL</exception>
        void SaveObject();

        /// <summary>
        /// See MSDN for more information.  Throws <see cref="COMException"/> with id of E_NOTIMPL.
        /// </summary>
        /// <exception cref="COMException">E_NOTIMPL</exception>
        [return: MarshalAs(UnmanagedType.Interface)]
        object GetMoniker(uint dwAssign, uint dwWhichMoniker);

        /// <summary>
        /// See MSDN for more information.  Throws <see cref="COMException"/> with id of E_NOTIMPL.
        /// </summary>
        /// <exception cref="COMException">E_NOTIMPL</exception>
        [return: MarshalAs(UnmanagedType.Interface)]
        object GetContainer();

        /// <summary>
        /// See MSDN for more information.  Throws <see cref="COMException"/> with id of E_NOTIMPL.
        /// </summary>
        /// <exception cref="COMException">E_NOTIMPL</exception>
        void ShowObject();

        /// <summary>
        /// See MSDN for more information.  Throws <see cref="COMException"/> with id of E_NOTIMPL.
        /// </summary>
        /// <exception cref="COMException">E_NOTIMPL</exception>
        void OnShowWindow(bool fShow);

        /// <summary>
        /// See MSDN for more information.  Throws <see cref="COMException"/> with id of E_NOTIMPL.
        /// </summary>
        /// <exception cref="COMException">E_NOTIMPL</exception>
        void RequestNewObjectLayout();
    }
    #endregion

    #region IOleObject
    /// <summary>
    /// This interface is implemented by WMP ActiveX/COM control.
    /// The only function we need is <see cref="SetClientSite"/>.
    /// </summary>
    [ComImport, ComVisible(true),
    Guid("00000112-0000-0000-C000-000000000046"),
    InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    public interface IOleObject
    {
        /// <summary>
        /// Used to pass our custom <see cref="IOleClientSite"/> object to WMP.  The object we pass must also
        /// implement <see cref="IOleServiceProvider"/> to work right.
        /// </summary>
        /// <param name="pClientSite">The <see cref="IOleClientSite"/> to pass.</param>
        void SetClientSite(IOleClientSite pClientSite);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        [return: MarshalAs(UnmanagedType.Interface)]
        IOleClientSite GetClientSite();

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void SetHostNames(
            [MarshalAs(UnmanagedType.LPWStr)]string szContainerApp, 
            [MarshalAs(UnmanagedType.LPWStr)]string szContainerObj);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void Close(uint dwSaveOption);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void SetMoniker(uint dwWhichMoniker, object pmk);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        [return: MarshalAs(UnmanagedType.Interface)]
        object GetMoniker(uint dwAssign, uint dwWhichMoniker);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void InitFromData(object pDataObject, bool fCreation, uint dwReserved);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        object GetClipboardData(uint dwReserved);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void DoVerb(uint iVerb, uint lpmsg, [MarshalAs(UnmanagedType.Interface)]object pActiveSite, 
            uint lindex, uint hwndParent, uint lprcPosRect);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        [return: MarshalAs(UnmanagedType.Interface)]
        object EnumVerbs();

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void Update();

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        [PreserveSig]
        [return: MarshalAs(UnmanagedType.U4)]
        HResults IsUpToDate();

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        Guid GetUserClassID();

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        [return: MarshalAs(UnmanagedType.LPWStr)]
        string GetUserType(uint dwFormOfType);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void SetExtent(uint dwDrawAspect, [MarshalAs(UnmanagedType.Interface)] object psizel);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        [return: MarshalAs(UnmanagedType.Interface)]
        object GetExtent(uint dwDrawAspect);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        uint Advise([MarshalAs(UnmanagedType.Interface)]object pAdvSink);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void Unadvise(uint dwConnection);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        [return: MarshalAs(UnmanagedType.Interface)]
        object EnumAdvise();

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        uint GetMiscStatus([MarshalAs(UnmanagedType.U4)] DVASPECT dwAspect);

        /// <summary>
        /// Implemented by Windows Media Player ActiveX control.
        /// See MSDN for more information.
        /// </summary>
        void SetColorScheme([MarshalAs(UnmanagedType.Interface)] object pLogpal);
    }
    #endregion

} 
```

# facebook-opengraph - 如何测试music.listens？

> ID：10957198
> 
> 赞同：-1
> 
> 时间：2012-06-08T23:40:06.860
> 
> 标签：facebook-opengraph, spotify

我试图弄清楚如何使用 music.listens open graph api。这是我做的步骤

1.  打开 Spotify 应用程序，然后播放音乐，然后在 Facebook 上分享该音乐。
2.  登录到 facebook.com，然后导航到[https://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)
3.  然后从页面获取访问令牌。
4.  访问[https://graph.facebook.com/me/music.listens?access_token=AAAAAAITEghMBAIcvJFBXTz9Io9DlhF59TTbusrBjGto7ZCce783D1CSHkBgsknGZB2xubQNiEg6ZBxO1GZCpMZCGbJCsFAJKPNmUQU70uGQZDZD](https://graph.facebook.com/me/music.listens?access_token=AAAAAAITEghMBAIcvJFBXTz9Io9DlhF59TTbusrBjGto7ZCce783D1CSHkBgsknGZB2xubQNiEg6ZBxO1GZCpMZCGbJCsFAJKPNmUQU70uGQZDZD)

但它总是返回空。

我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:49:03.730

`me/music.listens`端点为当前应用程序提供数据。不是所有的应用程序。

只有拥有给定的权限，`user_actions.music`您才能访问所有应用程序。没有它，您只能访问当前的应用程序操作。

# objective-c - 一周内所有 NSDate 的数组

> ID：10957200
> 
> 赞同：1
> 
> 时间：2012-06-08T23:40:22.460
> 
> 标签：objective-c, ios, ios5, nsdate

我想要一个函数，它以周数作为输入并返回该特定周的所有 NSDates 的数组。

像这样的东西：

```
-(NSArray*)allDatesInWeek:(int)weekNumber {
    NSDate *today = [NSDate date];
    NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    [calendar setFirstWeekday:2];
    NSDateComponents *todayComp = [calendar components:NSYearCalendarUnit fromDate:today];
    int currentyear = todayComp.year;
    /* Calculate and return the date of weekNumber for current year */ 
```

}

如何以简单的方式做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-06T19:56:48.423

这个解决方案完全依赖于 NSCalendar，而不对用户的日历做任何假设。

```
-(NSArray*)allDatesInWeekContainingDate:(NSDate*)referenceDate {
    NSCalendar *calendar = [NSCalendar currentCalendar];
    NSInteger ordinalityOfInput = [calendar ordinalityOfUnit:NSWeekdayCalendarUnit
                                                      inUnit:NSWeekCalendarUnit
                                                     forDate:referenceDate];
    NSDateComponents *componentsToAdd = [[NSDateComponents alloc] init];
    componentsToAdd.day = -1 * (ordinalityOfInput - 1);
    NSDate *startDate = [calendar dateByAddingComponents:componentsToAdd toDate:referenceDate options:0];
    NSInteger numDaysInWeek = [calendar maximumRangeOfUnit:NSWeekdayCalendarUnit].length;
    NSMutableArray *allDays = [NSMutableArray arrayWithCapacity:numDaysInWeek];
    NSDateComponents *curDayOffset = [[NSDateComponents alloc] init];
    for (int curDay=0; curDay < numDaysInWeek; curDay++) {
        curDayOffset.day = curDay;
        [allDays addObject:[calendar dateByAddingComponents:curDayOffset toDate:startDate options:0]];
    }
    return allDays;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:14:49.890

经测试。

```
-(NSArray*)allDatesInWeek:(int)weekNumber {
   // determine weekday of first day of year: 
   NSCalendar *greg = [[NSCalendar alloc] 
      initWithCalendarIdentifier:NSGregorianCalendar];
   NSDateComponents *coms = [[NSDateComponents alloc] init];
   comps.day = 1;
   NSDate *today = [NSDate date];
   NSDate *tomorrow = [greg dateByAddingComponents:comps toDate:today];
   const NSTimeInterval kDay = [tomorrow timeIntervalSinceDate:today];
   comps = [greg components:NSYearCalendarUnit fromDate:[NSDate date]];
   comps.day = 1;
   comps.month = 1; 
   comps.hour = 12;
   NSDate *start = [greg dateFromComponents:comps];
   comps = [greg components:NSWeekdayCalendarUnit fromDate:start]; 
   if (weekNumber==1) {
       start = [start dateByAddingTimeInterval:-kDay*(comps.weekday-1)];
   } else {
       start = [start dateByAddingTimeInterval:
          kDay*(8-comps.weekday+7*(weekNumber-2))];
   }
   NSMutableArray *result = [NSMutableArray array];
   for (int i = 0; i<7; i++) {
       [result addObject:[start dateByAddingTimeInterval:kDay*i]];
   }
   return [NSArray arrayWithArray:result];
} 
```

这假设一周的第一天是星期日，如 NSDate API 中所述。如果需要，可以调整。

# wordpress - Htaccess重写不起作用

> ID：10957211
> 
> 赞同：0
> 
> 时间：2012-06-08T23:41:53.960
> 
> 标签：wordpress, .htaccess, mod-rewrite

免责声明：是的，我做了很多搜索。是的，我阅读了论坛。是的，我尝试自己解决此问题 30 分钟，但它只是无法正常工作，所以我正在寻求帮助。

一个简单的 htaccess 重写规则。这是我用于规则的内容：

```
RewriteRule ^downloads/([0-9])/$ /downloads?ID=$1 [NC,L] 
```

基本上我在看

`www.url.com/downloads/1`运行请求`/downloads?ID=1`

出于某种原因，我经常在我的网站上收到一个错误“没有找到”。运行一个 wordpress 网站。htaccess 的其余部分如下

```
# Use PHP5 Single php.ini as default
AddHandler application/x-httpd-php5s .php

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]

</IfModule>

# END WordPress

redirect 301 "/report2012/trends_2012/" "/2012-swanepoel-trends-report"
redirect 301 "/report2011/trends_2011/" "/2011-swanepoel-trends-report"
redirect 301 "/report2010/trends_2010/" "/swanepoel-trends-report"
redirect 301 "/report2009/trends_2009/" "/swanepoel-trends-report"
redirect 301 "/social_media/" "/social-media-report"
redirect 301 "/speaking-engagements/" "/trends-keynote"

RewriteRule ^item/([0-9])/$ /downloads?ID=$1 [NC,L] 
```

请帮助 - 我不确定它为什么不起作用。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T09:25:21.980

我将代码放在 WP 规则之上。我还输入了一行以防止 WP 表单试图解释这些下载 url。

```
# Use PHP5 Single php.ini as default
AddHandler application/x-httpd-php5s .php

# download links
RewriteRule ^downloads/([0-9])/$ /downloads?ID=$1 [L]
RewriteRule ^downloads - [L] 

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]

</IfModule>

# END WordPress

redirect 301 "/report2012/trends_2012/" "/2012-swanepoel-trends-report"
redirect 301 "/report2011/trends_2011/" "/2011-swanepoel-trends-report"
redirect 301 "/report2010/trends_2010/" "/swanepoel-trends-report"
redirect 301 "/report2009/trends_2009/" "/swanepoel-trends-report"
redirect 301 "/social_media/" "/social-media-report"
redirect 301 "/speaking-engagements/" "/trends-keynote" 
```

# box-api - Box API 2.0 不接受 auth_token，而 v1.0 接受

> ID：10957215
> 
> 赞同：1
> 
> 时间：2012-06-08T23:42:07.867
> 
> 标签：box-api

我正在尝试按照[Getting Started](http://developers.box.com/get-started)使用 Box v2 API 。一切都很好，直到我从 Box 收到 auth_token，当我用它做任何事情时，例如示例调用：

```
curl https://www.box.com/api/2.0/folders/0 \
-H "Authorization: BoxAuth api_key=API_KEY&auth_token=AUTH_TOKEN" 
```

我得到`401 Unauthorized`答复。

我确定我正确地发送了 auth_token，因为当我将它用于 Box v1 API 时，相同的 auth_token 可以工作。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T13:24:42.543

您的 curl 请求看起来正确，因此 401 可能意味着您的 auth_token 已过期或因某种原因无效。您的身份验证令牌可能包含双引号，这可能会使 curl 感到困惑。

我的建议是完成该过程并获得一个新的身份验证令牌。如果这不能解决问题，请向 Box 发送电子邮件至 api[at]boxDOTcom 并提供详细信息。

# jquery - 如何按顺序运行两个不同的 jquery 函数？

> ID：10957217
> 
> 赞同：3
> 
> 时间：2012-06-08T23:42:16.370
> 
> 标签：jquery, function, callback, sequence

我想使用 jQuery 制作滑动图像的效果。当我单击图像时，我想 1) 将框架宽度设为零，2) 更改为另一个图像，以及 3) 再次将框架宽度设为 100%。我使用了以下代码，无论我做什么，图像都会在帧扩展回 100% (1-> 3-> 2) 之前先发生变化。我尝试使用回调函数，但无法弄清楚。请问有什么建议吗？

```
$("#frame img").click(function(){
    $("#frame").animate({width:"0%", height:"100%"}, "slow"); //1
    $("#frame img").attr({src:"images2.png"}); //2
    $("#frame").animate({width:"100%", height:"100%"}, "slow"); //3
}); 
```

以下是我尝试过的回调函数（我认为这是完全错误的）：

```
$("#frame img").click(function(){
    $("#frame").animate(({width:"0%", height:"100%"}, "slow"), function(){
         $("#frame img").attr(({src:"images2.png"}), function(){
              $("#frame").animate({width:"100%", height:"100%"}, "slow");
              });
         )};
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T23:46:43.520

使用回调（如果可能，例如`.attr()`不支持回调）：

```
$("#frame img").click(function(){
    $("#frame").animate({width:"0%", height:"100%"}, "slow", function(){
        // a callback executed, when the first animation completes
        $("#frame img").attr({src:"images2.png"});
        $("#frame").animate({width:"100%", height:"100%"}, "slow");
    });
}); 
```

但是您的代码可以进行优化。其中一种方法可能如下所示：

```
var frame = $("#frame"); // cache frame
var images = frame.find("img"); // cache images within frame
images.click(function(){
    frame.animate({width:"0%", height:"100%"}, "slow", function(){
        // a callback executed, when the first animation completes
        images.attr({src:"images2.png"});
        frame.animate({width:"100%", height:"100%"}, "slow");
    });
}); 
```

（当然除非结果不随时间而改变`$("#frame")`）`$("#frame img")`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T23:48:00.390

有几个 jQuery 插件可以满足您的需求......如果我找到它，我会评论这个答案。现在，您可以这样做。

```
$("#frame img").click(function(){
    $("#frame").animate({width:0}, "slow", function(){
        $("#frame img").attr({src:"images2.png"}).ready(function(){
            $("#frame").animate({width:$("#frame img").width()}, "slow");
        });
    });
}); 
```

.ready 确保在重新动画之前加载图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T23:49:28.203

试试下面的例子，告诉我它是否适合你：

```
$('#clickme').click(function() {
  $('#book').animate({
    opacity: 0.25,
    left: '+=50',
    height: 'toggle'
  }, 5000, function() {
    // Animation complete.
  });
}); 
```

如需完整参考：[http](http://api.jquery.com/animate/) ://api.jquery.com/animate/并阅读完整功能

# java - NoClassDefFoundError：com/mysql/jdbc/StringUtils Tomcat 6

> ID：10957220
> 
> 赞同：0
> 
> 时间：2012-06-08T23:42:55.273
> 
> 标签：java, mysql, maven, jdbc, tomcat6

所以基本上我正在使用 maven 以与我一直做的相同方式组织我的项目，但是我在 catalina.out 中收到一个错误，告诉我它无法在 com.mysql.jdbc 中找到 StringUtils 类，即使我可以看到jar 在战争类路径中。我在不同的服务器上没有遇到与 Tomcat7 相同的问题，这让我相信某处有一个库类掩盖了我在实际项目中拥有的 jar 文件。这是一个例外：

引起：java.lang.NoClassDefFoundError: com/mysql/jdbc/StringUtils

我的maven依赖如下：

```
<dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.20</version>
        </dependency> 
```

当我可以在 WEB-INF 的 lib 部分中看到 jar 并且可以在 jar 中看到该类时，我只是无法理解如何在类路径中找不到该类。有人知道这里会发生什么吗？谢谢你的帮助。

如果您需要更多信息，请告诉我。

完整的堆栈跟踪：（我使用 Apache 的 BasicDataSource）。

```
 Throwable occurred: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'voiceManager' defined in class path resource [applicationContext.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [com.voiceforge.api.swift.VoiceManager]: Constructor threw exception; nested exception is org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is org.apache.commons.dbcp.SQLNestedException: Cannot create JDBC driver of class 'com.mysql.jdbc.Driver' for connect URL 'jdbc:mysql://localhost/vf2?autoReconnect=true'
    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:288)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1035)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:939)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:384)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3843)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4338)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)
    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:882)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:522)
    at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1283)
    at sun.reflect.GeneratedMethodAccessor66.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:611)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:297)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:848)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:773)
    at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1471)
    at org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:250)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:186)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:530)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    at java.lang.Thread.run(Thread.java:736)
Caused by: org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [com.voiceforge.api.swift.VoiceManager]: Constructor threw exception; nested exception is org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is org.apache.commons.dbcp.SQLNestedException: Cannot create JDBC driver of class 'com.mysql.jdbc.Driver' for connect URL 'jdbc:mysql://localhost/vf2?autoReconnect=true'
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:162)
    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:110)
    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:280)
    ... 48 more
Caused by: org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is org.apache.commons.dbcp.SQLNestedException: Cannot create JDBC driver of class 'com.mysql.jdbc.Driver' for connect URL 'jdbc:mysql://localhost/vf2?autoReconnect=true'
    at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:80)
    at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:382)
    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:456)
    at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:464)
    at com.voiceforge.api.dao.VoiceforgeDaoImpl.getVoiceList(VoiceforgeDaoImpl.java:86)
    at com.voiceforge.api.swift.VoiceManager.refreshVoices(VoiceManager.java:33)
    at com.voiceforge.api.swift.VoiceManager.<init>(VoiceManager.java:23)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:56)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:39)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:527)
    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)
    ... 50 more
Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot create JDBC driver of class 'com.mysql.jdbc.Driver' for connect URL 'jdbc:mysql://localhost/vf2?autoReconnect=true'
    at org.apache.commons.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1452)
    at org.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
    at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:111)
    at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:77)
    ... 61 more
Caused by: java.lang.NoClassDefFoundError: com/mysql/jdbc/StringUtils
    at com.mysql.jdbc.NonRegisteringDriver.parseURL(NonRegisteringDriver.java:582)
    at com.mysql.jdbc.NonRegisteringDriver.acceptsURL(NonRegisteringDriver.java:236)
    at java.sql.DriverManager.getDriver(DriverManager.java:443)
    at org.apache.commons.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1437)
    ... 65 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T01:08:18.353

这`NoClassDefFoundError`可能是很多事情的征兆，但首先要检查的是该类实际上是在您部署的 web 应用程序的类路径上。

*   检查 MySQL 连接器 JAR 是否在 webapp 的`WEB-INF/lib`目录中，并检查它是否实际包含`com.mysql.jdbc.StringUtils`异常表示它无法加载的类 ( )。

*   检查 Web 容器的核心或共享库类路径中没有 JAR 文件的杂散副本。

*   如果上述方法未能给出明确的原因，请检查日志以查找其他（早期）类加载异常。您向我们展示的那个可能存在嵌套异常。可能有更早的例外。例如，如果类初始化失败（由于未经检查的异常），那么所有后续加载该类或相关类的尝试都将抛出异常......而无需重新报告问题的原始原因。

另一种可能性是您的 WAR 文件 POM 正在合并到具有冲突依赖项的 JAR 中。或者您（实际上）允许使用依赖排除在模块构建链上进一步发生冲突。

* * *

stacktrace中有一条线索：

```
Caused by: java.lang.NoClassDefFoundError: com/mysql/jdbc/StringUtils
    at com.mysql.jdbc.NonRegisteringDriver.parseURL(NonRegisteringDriver.java:582)
    .... 
```

请注意，`NoClassDefFoundError`不会在`Class.forName(...)`通话中引发。您应该获取您正在使用的 JAR 版本的源代码，并查看它在该行做什么。

我怀疑这是抛出异常，因为之前的类加载尝试失败了。日志文件中是否有任何早期的堆栈跟踪？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T02:01:44.980

实际上，它可能不是找不到的 StringUtils 类。这可能会表现为 ClassNotFoundException。NoClassDefFoundError 有点不同，我的意思是找不到 StringUtils 依赖的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T18:15:53.773

我最终安装了 Tomcat 7，错误消失了。我不知道为什么这个错误会很不幸地出现，但希望这可以在未来帮助其他人。

# asp.net-mvc-3 - MSBuild IIS 问题

> ID：10957222
> 
> 赞同：7
> 
> 时间：2012-06-08T23:43:16.083
> 
> 标签：asp.net-mvc-3, iis, msbuild

我正在使用 MSBuild 打包和发布我的 Asp.Net MVC 3、.Net 4 应用程序。我已经成功地为 MVC 1.0、.Net 3.5 应用程序完成了这项工作。

每当我`IncludeIisSettings=true`在 .proj 文件中包含 IIS 设置 ( ) 时，都会出现以下构建错误：

> C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\Web\Microsoft.Web.Publishing.targets(2046, 5): error MSB4044: The "EscapeTextForRegularExpressions" task is not given an value for the required参数“文本”。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-18T08:48:31.550

我在构建服务器上遇到了同样的问题。

该软件包将在我的开发机器上完美构建，但会因与构建服务器上完全相同的错误而失败。对我来说，问题是由于在我的构建机器上，应用程序没有向 IIS 注册。

当我在项目中启用 IIS Express 中的本地测试并以某种间接方式启用`IncludeIisSettings=true`您提到的设置时，问题就开始了。这会导致 Web 部署管道向 IIS 查询站点的详细信息。由于构建服务器没有安装 IIS 7 或 IIS Express，因此无法获取这些设置。这最终导致了上面的错误，因为传递给`EscapeTextForRegularExpressions`任务的参数是空的。

我的解决方案是在应用程序 .wpp.targets 文件中设置`IncludeIisSettings`（`False`参见*此处*以[获取](http://www.asp.net/web-forms/tutorials/deployment/advanced-enterprise-web-deployment/excluding-files-and-folders-from-deployment)示例 .wpp.targets 文件）。如果您明确指定 IIS 的设置，那应该不是问题。

我还能够通过使用 WebMatrix 向 IIS Express 注册站点来修复构建。在 Visual Studio 中运行该站点应该具有相同的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-31T21:11:49.357

我遇到的问题是权限问题，特别是切换笔记本电脑后 Windows 7 中的 UAC 设置。

在仔细检查了我之前的配置后，我意识到我仍然拥有默认的 UAC 设置。要改变去`Start > Control Panel > User Accounts > User Accounts > Change User Account Control Settings`。然后将栏一直拖到`Never notify`。

以下是我观察到的一些其他症状，可能会有所帮助：

当我在本地运行 msbuild 时，`IncludeIisSettings=true`我收到了与问题中相同的错误。

在经历了一些挫折和错误的转折之后，我无法弄清楚为什么尽管我是管理员，但在相关领域却遇到了权限错误，例如，在设置`IncludeIisSettings=false`然后尝试运行部署文件时，我收到了权限错误。

因此，我决定探索 UAC 设置并找到解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-17T10:18:38.740

我们发现的解决方案具有 IncludeIisSettings=true 并且没有“EscapeTextForRegularExpressions”任务没有为所需参数“Text”提供值的情况下成功构建。错误是：

*   在构建服务器上安装 Visual Studio（已经完成）。
*   在构建服务器上安装 IIS。
*   在 IIS 中，在默认网站上，为 https（端口 443）添加绑定并使用 Visual Studio 安装的证书（IIS Express 开发证书）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-04-25T17:39:02.997

我必须在 web 应用程序的 properties\Web 中更改以下内容

在服务器部分将其从 IISExpress 更改为本地 IIS 并创建我的虚拟目录。当然，您自然必须在您的机器上安装 IIS。

# .htaccess - htaccess 用可选的查询字符串重写目录

> ID：10957229
> 
> 赞同：0
> 
> 时间：2012-06-08T23:44:23.713
> 
> 标签：.htaccess, mod-rewrite

我创建了一个视频页面，该页面将显示默认视频或加载通过查询字符串发送的视频。可以通过以下任何方式访问它：

```
/video.php
/video.php?id=VIDEO_ID
/video.php?id=VIDEO_ID&time_offset=TIME_OFFSET 
```

使用 htaccess rewrite 我希望有友好的 url 来重写它，如下所示：

```
/video -> video.php
/video/VIDEO_ID -> /video.php?id=VIDEO_ID
/video/VIDEO_ID/TIME_OFFSET -> /video.php?id=VIDEO_ID&time_offset=TIME_OFFSET 
```

例如：/video/cBPg3iof4J4/ -> /video.php?id=cBPg3iof4J4

由于用户可以 a) 进入视频页面，b) 进入具有视频 id 的视频页面，以及 c) 具有视频 id 和时间偏移量，我如何使用 .htaccess 重写来解决所有这些情况？我试过下面的代码：

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^video/$(.*) video.php?id=$1 [L]
RewriteRule ^video video.php [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T23:54:54.193

表示 url的`^`开始 表示 url`$`的结束。

```
RewriteEngine on
RewriteRule ^video/?$ video.php [L]
RewriteRule ^video/(.*)/(.*)/?$ video.php?id=$1&time_offset=$2 [L]
RewriteRule ^video/(.*)/?$ video.php?id=$1 [L] 
```

# mysql - "Incorrect string value" when trying to insert UTF-8 into MySQL via JDBC?

> ID：10957238
> 
> 赞同：293
> 
> 时间：2012-06-08T23:46:11.960
> 
> 标签：mysql, jdbc, utf-8, utf8mb4

This is how my connection is set:
`Connection conn = DriverManager.getConnection(url + dbName + "?useUnicode=true&characterEncoding=utf-8", userName, password);`

And I'm getting the following error when tyring to add a row to a table:
`Incorrect string value: '\xF0\x90\x8D\x83\xF0\x90...' for column 'content' at row 1`

I'm inserting thousands of records, and I always get this error when the text contains \xF0 (i.e. the the incorrect string value always starts with \xF0).

The column's collation is utf8_general_ci.

What could be the problem?

* * *

## 回答 #1

> 赞同：377
> 
> 时间：2012-06-09T09:16:18.103

MySQL's `utf8` permits only the Unicode characters that can be represented with 3 bytes in UTF-8\. Here you have a character that needs 4 bytes: \xF0\x90\x8D\x83 ([U+10343 GOTHIC LETTER SAUIL](http://www.fileformat.info/info/unicode/char/10343/index.htm)).

If you have MySQL 5.5 or later you can change the column encoding from `utf8` to [`utf8mb4`](http://dev.mysql.com/doc/refman/5.5/en/charset-unicode-utf8mb4.html). This encoding allows storage of characters that occupy 4 bytes in UTF-8.

You may also have to set the server property `character_set_server` to `utf8mb4` in the MySQL configuration file. It seems that [Connector/J defaults to 3-byte Unicode otherwise](http://dev.mysql.com/doc/connector-j/en/connector-j-reference-charsets.html):

> For example, to use 4-byte UTF-8 character sets with Connector/J, configure the MySQL server with `character_set_server=utf8mb4`, and leave `characterEncoding` out of the Connector/J connection string. Connector/J will then autodetect the UTF-8 setting.

* * *

## 回答 #2

> 赞同：133
> 
> 时间：2012-06-09T00:07:00.403

The strings that contain `\xF0` are simply [characters encoded as multiple bytes](http://en.wikipedia.org/wiki/UTF-8#Description) using UTF-8.

Although your collation is set to utf8_general_ci, I suspect that the character encoding of the **database, table or even column may be different**. They are [independent settings](https://stackoverflow.com/questions/341273/what-does-character-set-and-collation-mean-exactly). Try:

```
ALTER TABLE database.table MODIFY COLUMN col VARCHAR(255)  
    CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL; 
```

Substitute whatever your actual data type is for VARCHAR(255)

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2016-02-02T15:03:36.817

Got the same problem, to save the data with `utf8mb4` needs to make sure:

1.  `character_set_client, character_set_connection, character_set_results` are `utf8mb4`: `character_set_client` and `character_set_connection` indicate the character set in which statements are sent by the client, `character_set_results` indicates the character set in which the server returns query results to the client.
    See [charset-connection](http://dev.mysql.com/doc/refman/5.7/en/charset-connection.html).

2.  the table and column encoding is `utf8mb4`

For JDBC, there are two solutions:

### Solution 1 (need to restart MySQL):

1.  modify `my.cnf` like the following and restart MySQL:

    ```
    [mysql]
    default-character-set=utf8mb4

    [mysqld]
    character-set-server=utf8mb4
    collation-server=utf8mb4_unicode_ci 
    ```

this can make sure the database and `character_set_client, character_set_connection, character_set_results` are `utf8mb4` by default.

2.  restart MySQL

3.  change the table and column encoding to `utf8mb4`

4.  STOP specifying `characterEncoding=UTF-8` and `characterSetResults=UTF-8` in the jdbc connector,cause this will override `character_set_client`, `character_set_connection`, `character_set_results` to `utf8`

### Solution two (don't need to restart MySQL):

1.  change the table and column encoding to `utf8mb4`

2.  specifying `characterEncoding=UTF-8` in the jdbc connector,cause the jdbc connector doesn't suport `utf8mb4`.

3.  write your sql statment like this (need to add `allowMultiQueries=true` to jdbc connector):

    ```
    'SET NAMES utf8mb4;INSERT INTO Mytable ...'; 
    ```

this will make sure each connection to the server, `character_set_client,character_set_connection,character_set_results` are `utf8mb4`.
Also see [charset-connection](http://dev.mysql.com/doc/refman/5.7/en/charset-connection.html).

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-04-15T11:42:28.903

I wanted to combine a couple of posts to make a full answer of this since it does appear to be a few steps.

1.  Above advice by @madtracey

`/etc/mysql/my.cnf` or `/etc/mysql/mysql.conf.d/mysqld.cnf`

```
[mysql]
default-character-set=utf8mb4

[mysqld_safe]
socket          = /var/run/mysqld/mysqld.sock
nice            = 0

[mysqld]
##
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci
init_connect='SET NAMES utf8mb4'
sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION 
```

Again from advice above all jdbc connections had `characterEncoding=UTF-8`and `characterSetResults=UTF-8` removed from them

With this set `-Dfile.encoding=UTF-8` appeared to make no difference.

I could still not write international text into db getting same failure as above

Now using this [how-to-convert-an-entire-mysql-database-characterset-and-collation-to-utf-8](https://stackoverflow.com/a/27772624/755637)

Update all your db to use `utf8mb4`

```
ALTER DATABASE YOURDB CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; 
```

Run this query that gives you what needs to be rung

```
SELECT CONCAT(
'ALTER TABLE ',  table_name, ' CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;  ', 
'ALTER TABLE ',  table_name, ' CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;  ')
FROM information_schema.TABLES AS T, information_schema.`COLLATION_CHARACTER_SET_APPLICABILITY` AS C
WHERE C.collation_name = T.table_collation
AND T.table_schema = 'YOURDB'
AND
(C.CHARACTER_SET_NAME != 'utf8mb4'
    OR
 C.COLLATION_NAME not like 'utf8mb4%') 
```

Copy paste output in editor replace all | with nothing post back into mysql when connected to correct db.

That is all that had to be done and all seems to work for me. Not the -`Dfile.encoding=UTF-8` is not enabled and it appears to work as expected

**E2A Still having an issue ?** I certainly am in production so it turns out you do need to check over what has been done by above, since it sometimes does not work, here is reason and fix in this scenario:

```
show create table user

  `password` varchar(255) CHARACTER SET latin1 NOT NULL,
  `username` varchar(255) CHARACTER SET latin1 NOT NULL, 
```

You can see some are still latin attempting to manually update the record:

```
ALTER TABLE user CONVERT TO CHARACTER SET utf8mb4;
ERROR 1071 (42000): Specified key was too long; max key length is 767 bytes 
```

So let's narrow it down:

```
mysql> ALTER TABLE user change username username varchar(255) CHARACTER SET utf8mb4 not NULL;
ERROR 1071 (42000): Specified key was too long; max key length is 767 bytes
mysql> ALTER TABLE user change username username varchar(100) CHARACTER SET utf8mb4 not NULL;
Query OK, 5 rows affected (0.01 sec) 
```

In short I had to reduce the size of that field in order to get the update to work.

Now when I run:

```
mysql> ALTER TABLE user CONVERT TO CHARACTER SET utf8mb4;
Query OK, 5 rows affected (0.01 sec)
Records: 5  Duplicates: 0  Warnings: 0 
```

It all works

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-03-31T03:01:09.967

In my case, I tried everything above, nothing worked. I am pretty sure, my database looks like below.

```
mysql  Ver 14.14 Distrib 5.7.17, for Linux (x86_64) using  EditLine wrapper

Connection id:      12
Current database:   xxx
Current user:       yo@localhost
SSL:            Not in use
Current pager:      stdout
Using outfile:      ''
Using delimiter:    ;
Server version:     5.7.17-0ubuntu0.16.04.1 (Ubuntu)
Protocol version:   10
Connection:     Localhost via UNIX socket
Server characterset:    utf8
Db     characterset:    utf8
Client characterset:    utf8
Conn.  characterset:    utf8
UNIX socket:        /var/run/mysqld/mysqld.sock
Uptime:         42 min 49 sec

Threads: 1  Questions: 372  Slow queries: 0  Opens: 166  Flush tables: 1  Open tables: 30  Queries per second avg: 0.144 
```

so, I look up the column charset in every table

```
show create table company; 
```

It turns out the column charset is latin. That's why, I can not insert Chinese into database.

```
 ALTER TABLE company CONVERT TO CHARACTER SET utf8; 
```

That might help you. :)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-05-24T18:11:15.340

I had the same problem in my rails project:

```
Incorrect string value: '\xF0\xA9\xB8\xBDs ...' for column 'subject' at row1 
```

Solution 1: before saving to db convert string to base64 by `Base64.encode64(subject)` and after fetching from db use `Base64.decode64(subject)`

Solution 2:

Step 1: Change the character set (and collation) for subject column by

```
ALTER TABLE t1 MODIFY
subject VARCHAR(255)
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_unicode_ci; 
```

Step 2: In database.yml use

```
encoding :utf8mb4 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-05-23T15:17:43.270

just do

```
ALTER TABLE `some_table` 
CHARACTER SET = utf8 , COLLATE = utf8_general_ci ;

ALTER TABLE `some_table` 
CHANGE COLUMN `description_with_latin_or_something` `description` TEXT CHARACTER SET 'utf8' NOT NULL ; 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-03-02T12:04:17.063

Assuming you are using **phpmyadmin** to solve this error, follow these steps:

1.  **phpMyAdmin**
2.  **your_table**
3.  **"Structure tab"**
4.  change the Collation of your field from `latin1_swedish_ci` (or whatever it is) to `utf8_general_ci`

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-04-12T07:09:34.397

Its mostly caused due to some unicode characters. In my case it was the Rupee currency symbol.

To quickly fix this, I had to spot the character causing this error. I copy pasted the entire text in a text editor like vi and replaced the troubling character with a text one.

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-10-03T21:58:18.270

I you only want to apply the change only for one field, you could try serializing the field

```
class MyModel < ActiveRecord::Base
  serialize :content

  attr_accessible :content, :title
end 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-07-26T10:03:08.807

I had this problem with my PLAY Java application. This is my stack trace for that exception:

```
javax.persistence.PersistenceException: Error[Incorrect string value: '\xE0\xA6\xAC\xE0\xA6\xBE...' for column 'product_name' at row 1]
  at io.ebean.config.dbplatform.SqlCodeTranslator.translate(SqlCodeTranslator.java:52)
  at io.ebean.config.dbplatform.DatabasePlatform.translate(DatabasePlatform.java:192)
  at io.ebeaninternal.server.persist.dml.DmlBeanPersister.execute(DmlBeanPersister.java:83)
  at io.ebeaninternal.server.persist.dml.DmlBeanPersister.insert(DmlBeanPersister.java:49)
  at io.ebeaninternal.server.core.PersistRequestBean.executeInsert(PersistRequestBean.java:1136)
  at io.ebeaninternal.server.core.PersistRequestBean.executeNow(PersistRequestBean.java:723)
  at io.ebeaninternal.server.core.PersistRequestBean.executeNoBatch(PersistRequestBean.java:778)
  at io.ebeaninternal.server.core.PersistRequestBean.executeOrQueue(PersistRequestBean.java:769)
  at io.ebeaninternal.server.persist.DefaultPersister.insert(DefaultPersister.java:456)
  at io.ebeaninternal.server.persist.DefaultPersister.insert(DefaultPersister.java:406)
  at io.ebeaninternal.server.persist.DefaultPersister.save(DefaultPersister.java:393)
  at io.ebeaninternal.server.core.DefaultServer.save(DefaultServer.java:1602)
  at io.ebeaninternal.server.core.DefaultServer.save(DefaultServer.java:1594)
  at io.ebean.Model.save(Model.java:190)
  at models.Product.create(Product.java:147)
  at controllers.PushData.xlsupload(PushData.java:67)
  at router.Routes$$anonfun$routes$1.$anonfun$applyOrElse$40(Routes.scala:690)
  at play.core.routing.HandlerInvokerFactory$$anon$3.resultCall(HandlerInvoker.scala:134)
  at play.core.routing.HandlerInvokerFactory$$anon$3.resultCall(HandlerInvoker.scala:133)
  at play.core.routing.HandlerInvokerFactory$JavaActionInvokerFactory$$anon$8$$anon$2$$anon$1.invocation(HandlerInvoker.scala:108)
  at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:88)
  at play.http.DefaultActionCreator$1.call(DefaultActionCreator.java:31)
  at play.core.j.JavaAction.$anonfun$apply$8(JavaAction.scala:138)
  at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:655)
  at scala.util.Success.$anonfun$map$1(Try.scala:251)
  at scala.util.Success.map(Try.scala:209)
  at scala.concurrent.Future.$anonfun$map$1(Future.scala:289)
  at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:29)
  at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:29)
  at scala.concurrent.impl.CallbackRunnable.run$$$capture(Promise.scala:60)
  at scala.concurrent.impl.CallbackRunnable.run(Promise.scala)
  at play.core.j.HttpExecutionContext$$anon$2.run(HttpExecutionContext.scala:56)
  at play.api.libs.streams.Execution$trampoline$.execute(Execution.scala:70)
  at play.core.j.HttpExecutionContext.execute(HttpExecutionContext.scala:48)
  at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:68)
  at scala.concurrent.impl.Promise$KeptPromise$Kept.onComplete(Promise.scala:368)
  at scala.concurrent.impl.Promise$KeptPromise$Kept.onComplete$(Promise.scala:367)
  at scala.concurrent.impl.Promise$KeptPromise$Successful.onComplete(Promise.scala:375)
  at scala.concurrent.impl.Promise.transform(Promise.scala:29)
  at scala.concurrent.impl.Promise.transform$(Promise.scala:27)
  at scala.concurrent.impl.Promise$KeptPromise$Successful.transform(Promise.scala:375)
  at scala.concurrent.Future.map(Future.scala:289)
  at scala.concurrent.Future.map$(Future.scala:289)
  at scala.concurrent.impl.Promise$KeptPromise$Successful.map(Promise.scala:375)
  at scala.concurrent.Future$.apply(Future.scala:655)
  at play.core.j.JavaAction.apply(JavaAction.scala:138)
  at play.api.mvc.Action.$anonfun$apply$2(Action.scala:96)
  at scala.concurrent.Future.$anonfun$flatMap$1(Future.scala:304)
  at scala.concurrent.impl.Promise.$anonfun$transformWith$1(Promise.scala:37)
  at scala.concurrent.impl.CallbackRunnable.run$$$capture(Promise.scala:60)
  at scala.concurrent.impl.CallbackRunnable.run(Promise.scala)
  at akka.dispatch.BatchingExecutor$AbstractBatch.processBatch(BatchingExecutor.scala:55)
  at akka.dispatch.BatchingExecutor$BlockableBatch.$anonfun$run$1(BatchingExecutor.scala:91)
  at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
  at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:81)
  at akka.dispatch.BatchingExecutor$BlockableBatch.run(BatchingExecutor.scala:91)
  at akka.dispatch.TaskInvocation.run(AbstractDispatcher.scala:40)
  at akka.dispatch.ForkJoinExecutorConfigurator$AkkaForkJoinTask.exec(ForkJoinExecutorConfigurator.scala:43)
  at akka.dispatch.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
  at akka.dispatch.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
  at akka.dispatch.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
  at akka.dispatch.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
Caused by: java.sql.SQLException: Incorrect string value: '\xE0\xA6\xAC\xE0\xA6\xBE...' for column 'product_name' at row 1
  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1074)
  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4096)
  at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4028)
  at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2490)
  at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2651)
  at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2734)
  at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2155)
  at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2458)
  at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2375)
  at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2359)
  at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
  at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
  at io.ebeaninternal.server.type.DataBind.executeUpdate(DataBind.java:82)
  at io.ebeaninternal.server.persist.dml.InsertHandler.execute(InsertHandler.java:122)
  at io.ebeaninternal.server.persist.dml.DmlBeanPersister.execute(DmlBeanPersister.java:73)
  ... 59 more 
```

I was trying to save a record using io.Ebean. I fixed it by re creating my database with utf8mb4 collation, and applied play evolution to re create all tables so that all tables should be recreated with utf-8 collation.

```
CREATE DATABASE inventory CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-02-25T00:45:14.697

Hint: On **AWS RDS** you need a new **Parameter Group** for your MySQL DB with the params (instead of editing a my.cnf)

*   collation_connection: utf8mb4_unicode_ci
*   collation_database: utf8mb4_unicode_ci
*   collation_server: utf8mb4_unicode_ci
*   character_set_client: utf8mb4
*   character_set_connection: utf8mb4
*   character_set_database: utf8mb4
*   character_set_results: utf8mb4
*   character_set_server: utf8mb4

Note: character_set_system stays "utf8"

These SQL commands do ***NOT*** *WORK PERMANENTLY* - only in a session:

```
set character_set_server = utf8mb4;
set collation_server = utf8mb4_unicode_ci; 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-07-07T06:44:17.573

my solution is change the column type from varchar(255) to blob

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2019-07-07T06:25:03.427

If you are creating a new MySQL table, you can specify the charset of all columns upon creation, and that fixed the issue for me.

```
CREATE TABLE tablename (
<list-of-columns>
)
CHARSET SET utf8mb4 COLLATE utf8mb4_unicode_ci; 
```

You can read more details: [https://dev.mysql.com/doc/refman/8.0/en/charset-column.html](https://dev.mysql.com/doc/refman/8.0/en/charset-column.html)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-07-19T09:15:06.343

this is not the recommendation solution.. But worth to share. Since my project are upgrade the DBMS from old Mysql to newest (8). But I cant change the table structure, only the DBMS config (mysql). The solution for mysql server.

test on **Windows** mysql **8.0.15** on mysql **config** search for

> sql-mode="....."

uncomment it. Or in my case just type/add

> sql-mode="NO_ENGINE_SUBSTITUTION"

why not recommended solution. because if you use latin1 (my case).. the data insert successly but not the content (mysql not respond with error!!) . for example you type info like this

> bla \x12

it save

> bla [] (box)

okay.. for my problem.. I can change the field to UTF8.. But there is small problem.. see above answer about other solution is failed because the word is not inserted because contain more than 2 bytes (cmiiw).. this solution make your insert data become box. The reasonable is to use blob.. and you can skip my answer.

Another testing related to this were.. using **utf8_encode** on your code before save. I use on latin1 and it was success (I'm not using **sql-mode**)! same as above answer using **base64_encode** .

My suggestion to analys your table requirement and tried to change from other format to UTF8

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-10-25T07:21:24.280

You need to set utf8mb4 in meta html and also in your server alter tabel and set collation to utf8mb4

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-10-19T09:02:32.440

Droppping schema and recreating it with `utf8mb4` character set solved my issue.

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-06-09T21:27:18.920

I also had to drop and re-create all the database’s stored procedures (and functions too) in order that they execute within the new character set of utf8mb4.

Run:

```
SHOW PROCEDURE STATUS; 
```

…to see which procedures have not been updated to the server’s new character_set_client, collation_connection and Database Collation values.

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-11-22T17:50:49.607

However, it is important to note that the mysql connector driver version must be older than 5.1.47 and later.

# android - 当我的视图滚动出可见区域时如何收听

> ID：10957241
> 
> 赞同：2
> 
> 时间：2012-06-08T23:46:35.700
> 
> 标签：android

在我的 android 应用程序中，我有一个滚动视图，其中包含很多子视图。当视图由于用户的滚动操作而从可见切换到“用户不可见”时，如何监听事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:04:16.803

所以默认的 ScrollView 不提供任何类型的滚动监听器，但是`onScrollChanged()`当用户滚动时它会调用，所以你可以实现你自己的：

```
public class YourScrollView extends ScrollView {
  private ScrollListener scrollListener;

  ... // constructors etc

  public void setScrollListener(ScrollListener scrollViewListener) {
    this.scrollListener = scrollViewListener;
  }

  @Override
  protected void onScrollChanged(int x, int y, int oldx, int oldy) {
    super.onScrollChanged(x, y, oldx, oldy);

    if (scrollListener != null) {  //I don't care about the direction, you might.
      scrollListener.onScrollChanged(); 
    }
  }

  public static interface ScrollListener {
    public void onScrollChanged();
  }

} 
```

现在，您`onScrollChanged`可以浏览您的视图并检查它们是否可见：

```
int[] location = {0,0};
view.getLocationOnScreen(location);

//container height is the height of the scrollview
if (location[1] + view.getBottom() < 0 || location[1]  > containerHeight) {
  //your view is not visible
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:11:53.210

你想达到什么目的？也许我们可以提出其他解决方案。

您可以将`onVisibilityChanged`事件处理程序添加到子视图。当视图的可见性改变时调用。可以在[此处](http://developer.android.com/reference/android/view/View.html#onVisibilityChanged%28android.view.View,%20int%29)找到有关此的 Android 文档。

# cocoa - NSTextView 中的硬包装

> ID：10957243
> 
> 赞同：1
> 
> 时间：2012-06-08T23:47:21.710
> 
> 标签：cocoa, word-wrap, nstextview

我正在尝试创建一个 NSTextView，它的行为有点像一系列打字机页面——每个页面都有固定数量的可用行和列。

底层表示与显示完美匹配，而显示又与文件格式匹配。页面以换页符结尾`'\f'`。例如，两个 4x4 页面在保存时会如下所示（字符之间有空格以便于阅读）：

```
T  H  I  S  \n
P  A  G  E  \n
I  S  \n
F  U  L  L  \n
\f
N  O  T  \n
T  H  I  S  \n
O  N  E  \n
\n
\f 
```

需要注意的几点：

*   换行符和换页符不计入行/列总数
*   短于列数的行不会用尾随空格填充（尽管如果编辑器在覆盖模式下工作，它们可能是）
*   比行数短的页面**用**换行符填充

我尝试了几种方法，例如将文本转换`NSArray`为一行并在每个通知上拆分长行`textDidChange`，然后将文本设置为连接的行，但它确实效率低下，并且如果键入发生在除末尾之外的任何地方，则会丢失光标位置文档。

最后，我想我希望它表现为一个填充有空格的大页面，并且键入只发生在覆盖模式下，但在行尾换行。我不确定从哪里开始使用这种方法。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T01:02:46.397

我找到了一个可接受的（如果不是完美的）通过子类化包装的解决方案`NSTextStorage`。

在将文本添加到文档末尾时，无论是粘贴还是键入，它的行为都完全符合预期。它在删除或替换文本时也会起作用。唯一有点奇怪的地方是在已经满行的中间插入文本时。这将在插入的文本*之前导致换行。*它工作正常，但这意味着继续在该位置键入会创建许多短行。

例如，下面的文本在 20 列处换行。原始文本是`x`，插入文本是`o`。插入的文本从第二行的第 8 个字符开始。

```
xxxxxxxxxxxxxxxxxxxx
xxxxxxx
ooooooo
ooooooo
oooooooxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxx 
```

下面的代码：

```
- (void)breakLinesInArray:(NSMutableArray *)lines atLength:(NSUInteger)length
charsPreceding:(NSUInteger)preceding charsFollowing:(NSUInteger)following
{
    NSUInteger line = 0;
    while (line < [lines count]) {
        NSUInteger maxLineLength = length;
        if (line == 0) {
            maxLineLength = length - preceding;
        } else if (line == [lines count] - 1) {
            maxLineLength = length - following;
        }
        NSString *original = [lines objectAtIndex:line];
        if (maxLineLength > 0 && [original length] > maxLineLength) {
            NSString *first = [original substringToIndex:maxLineLength];
            NSString *second = [original substringFromIndex:maxLineLength];
            [lines replaceObjectAtIndex:line withObject:first];
            [lines insertObject:second atIndex:line + 1];
        }
        ++line;
    }
}

- (void)replaceCharactersInRange:(NSRange)range withString:(NSString *)str
{
    static const NSUInteger kMaxLineLength = 20;
    NSString *text = [text_ string];
    NSUInteger firstLineStart = 0;
    NSUInteger lastLineEnd = 0;
    NSMutableArray *lines = [NSMutableArray arrayWithArray:[str componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]];
    [text getLineStart:&firstLineStart end:nil contentsEnd:&lastLineEnd forRange:range];
    NSUInteger firstLineStartFragmentLength = range.location - firstLineStart;
    NSUInteger lastLineEndFragmentLength = lastLineEnd - (range.location + range.length);
    [self breakLinesInArray:lines atLength:kMaxLineLength charsPreceding:firstLineStartFragmentLength charsFollowing:lastLineEndFragmentLength];
    NSString *newString = [lines componentsJoinedByString:@"\n"];
    NSInteger changeInLength = [newString length] - range.length;
    NSInteger newLastLineLength = firstLineStartFragmentLength + lastLineEndFragmentLength + changeInLength;
    if ((firstLineStartFragmentLength || lastLineEndFragmentLength) && newLastLineLength > (NSInteger)kMaxLineLength) {
        newString = [@"\n" stringByAppendingString:newString];
        ++changeInLength;
    }
    [text_ replaceCharactersInRange:range withString:newString];
    [self edited:NSTextStorageEditedCharacters range:range changeInLength:changeInLength];
} 
```

# php - 如何在 PHP 中构图？

> ID：10957248
> 
> 赞同：0
> 
> 时间：2012-06-08T23:48:31.003
> 
> 标签：php, javascript, canvas, imagemagick

我想在另一张图片周围放置一个图片边框（框架）。我们如何使用 GD 库在 PHP 中实现这一点？我还需要使用 javascript/canvas 和 Image Magick 来实现相同的目的。

快速帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T09:32:46.670

通过 php exec() 使用 Imagemagick，您可以使用本网站上的示例：[http ://www.imagemagick.org/Usage/thumbnails/](http://www.imagemagick.org/Usage/thumbnails/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T23:51:55.950

[ImageMagick在这里](http://www.imagemagick.org/Usage/crop/#border)有一个简洁的教程。

对于 GD：

```
<?php 
$img = ImageCreateFromJPEG('img.jpg');  
$color_black = ImageColorAllocate($img, 0, 0, 0); 
drawBorder($img, $color_black, 3); 
header('Content-type: image/jpeg'); 
ImageJPEG($img); 

function drawBorder(&$img, &$color, $thickness = 1) 
    { 
        $x1 = 0; 
        $y1 = 0; 
        $x2 = ImageSX($img) - 1; 
        $y2 = ImageSY($img) - 1; 
    for($i = 0; $i < $thickness; $i++) 
        { 
            ImageRectangle($img, $x1++, $y1++, $x2--, $y2--, $color_black); 
        } 
    } 
?> 
```

# emacs - 如何在 emacs 中取消绑定 C-mouse-down-1

> ID：10957249
> 
> 赞同：3
> 
> 时间：2012-06-08T23:48:40.963
> 
> 标签：emacs, key-bindings

我在 G41R2F1 上使用 2010-05-08 的 GNU Emacs 23.2.1 (i386-mingw-nt6.1.7601)

我发现我无意中收到了 C-mouse-down-1 事件，该事件会弹出缓冲区菜单（笔记本电脑触摸板，否则在触摸灵敏度方面表现完美）。

我通过询问“鼠标缓冲区菜单在哪里”发现这是原因，emacs告诉我：

鼠标缓冲菜单开启

我还没有找到一种方法来告诉 global-unset-key 取消设置：

(global-unset-key "\C-mouse-down-1") ; 从谷歌搜索

(global-unset-key "C-mouse-down-1") ; 逻辑猜测

两者都抛出错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:17:10.357

没有 C-mouse-down-* 事件：您的意思是 C-mouse-1 吗？

尝试：(global-unset-key [C-mouse-1]) - 适用于我在 OSX 上运行的 Emacs 23.3。

# java - 在 AsyncTask 中使用从 LoaderManager 返回的游标

> ID：10957252
> 
> 赞同：6
> 
> 时间：2012-06-08T23:49:08.080
> 
> 标签：java, android, android-cursor, android-loadermanager

`onLoadFinished`我在回调（来自）上返回了一个游标`LoaderManager.LoaderCallbacks`，我想对这个游标进行一些（可能成本高昂的）后处理。所以，我正在启动一个`AsyncTask`使用此光标的程序。但是，我遇到了此异常的间歇性崩溃：

```
android.database.StaleDataException: Attempted to access a cursor after it has been closed. 
```

我怀疑这是因为游标（由 UI 线程中的加载程序管理）在后台线程完成之前关闭，因为这是一个托管游标。这是一些转述的代码：

```
private class LoaderListener implements LoaderManager.LoaderCallbacks<Cursor> {
    @Override
    public void onCreateLoader(int d, Bundle args) {
        return new CursorLoader(context, uri, projection, selection, selectionArgs, sortOrder);
    }

    @Override
    public void onLoadFinished(Loader<Cursor> loader, Cursor cursor) {
        processCursor(cursor)    
    }
}

private void processCursor(final Cursor cursor) {
    new AsyncTask<Void, Void, Result> {
        @Override
        Result doInBackground(Void... params) {
            while(cursor.isAfterLast() == false) {
                // doing some costly things with cursor
            }
        }
    }.execute();
} 
```

有没有可能，

1.  以某种方式标记光标以防止它从 UI 线程中关闭。

2.  通知经理游标仍在使用中。

3.  克隆它，以便克隆的实例不会被管理器关闭。

4.  另一个更好的解决方案？

然而，在 UI 线程上完成此后处理绝对不是一种选择，因为它可能非常昂贵。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:10:33.043

> 是否可以以某种方式标记光标以防止它从 UI 线程中关闭？

不（好吧，不是没有重写内部 API）。

> 是否可以通知经理游标仍在使用中？

和上面的回答一样。

> 是否可以克隆它以使克隆的实例不会被管理器关闭？

这听起来有点乱......而且仍然有可能`LoaderManager`在您完成克隆之前关闭光标。

> 有更好的解决方案吗？

是的。查询一个新游标，而不是尝试重用您传递给`LoaderManager`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-16T17:52:44.103

伙计，我面临着同样的问题。方法是在activity的onDestroy方法中取消asynctask。

```
private YourAsyncTask asyncTask

@Override
protected void onDestroy(){
    super.onDestroy();
    asyncTask.cancel(true);
} 
```

# clojure - Clojure：调试 Println、__LINE_NUMBER__ 和 __FILE_NAME__

> ID：10957257
> 
> 赞同：5
> 
> 时间：2012-06-08T23:49:51.567
> 
> 标签：clojure

## 语境

目前，

```
(println "x is" x) 
```

只是打印出来

```
x is 10 
```

现在，我想要的是这样的：

```
(my-println "x is" x) 
```

打印出来：

```
foo.clj:23> x is 10 
```

非正式地，我希望 my-println 将 _FILE_NAME_ 和 _LINE_NUMBER_ 附加到我的 println 中。

## 问题：

我知道如何使用宏。但是，我不知道如何从 Clojure 中的当前位置提取 _FILE_NAME_ 和 _LINE_NUMBER_（而 C 宏使这变得微不足道）。如何获取当前的 FILE_NAME_ 和 _LINE_NUMBER_ ？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T03:18:52.750

```
(defmacro my-println [x]
  `(do (printf "%s:%s> %s is %s\n"
               ~*file*
               ~(:line (meta &form))
               ~(pr-str x)
               ~x)
       (flush))) 
```

* * *

稍后再看这个答案，如果愿意，您可以更聪明一点，通过在编译时插入字符串常量来降低运行时成本：

```
(defmacro my-println [x]
  `(println ~(format "%s:%s> %s is"
                     *file*
                     (:line (meta &form))
                     (pr-str x))
            ~x)) 
```

从宏扩展中可以看出，不再需要在运行时调用相对昂贵的 printf 代码：

```
(let [x 5] (macroexpand '(my-println (+ x 5))))
(clojure.core/println "foo.clj:1> (+ x 5) is" (+ x 5)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T07:21:19.520

[像log4j](http://logging.apache.org/log4j/1.2/)和[logback](http://logback.qos.ch/)这样的Java 日志框架提供了这种功能。您可以配置日志系统以将行号添加到日志消息中。文件名可能更难，但至少你可以在那里拥有命名空间。

您可以使用[clojure.logging](http://richhickey.github.com/clojure-contrib/logging-api.html)为日志框架提供良好的接口。

# windows - 在 Amazon EC2 上创建 Windows 实例

> ID：10957259
> 
> 赞同：0
> 
> 时间：2012-06-08T23:50:41.913
> 
> 标签：windows, amazon-ec2

我在这里不是偷懒，只是想确保我不会意外向亚马逊支付任何费用。:)

我刚刚注册了一个 Amazon Web Service 帐户并创建了一个 windows 实例。在请求实例向导中，我选择了

> 带有 SQL Server Express 和 IIS 的 Microsoft Windows Server 2008 R2
> 
> Microsoft Windows Server 2008 R2 SP1 数据中心版，64 位架构，Microsoft SQLServer 2008 Express，Internet Information Services 7，ASP.NET 3.5。
> 
> 根设备大小：30 GB 64 位

这个家伙上面有一个黄色的星星，表示它符合免费等级的条件。

以下是我的问题：

*   我是否需要为我的实例的 RDP 付费？
*   我是否需要为实习生访问和下载实例内的内容付费？
*   “这些免费套餐仅适用于新的 AWS 客户，并且在您注册 AWS 后的 12 个月内可用。” “这些免费套餐在 12 个月后不会过期，并且可以无限期地提供给现有和新的 AWS 客户。” 我从亚马逊网站复制了 2 句话。我该相信哪一个？......
*   在我的实例中安装 java 和 tomcat 等软件是否需要付费？

更重要的是：

*   如何将文件从本地盒子传输到我的实例？...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:32:55.387

您无需为 RDP 付费，您需要为 Internet 访问付费，但仅针对传出的数据包，您可以自己免费安装 java，您可以通过 RDP 进行复制粘贴或通过网络共享、FTP 上传文件来将文件传输到实例等当您将文件下载到 Amazon EC2 时，您需要支付大约 100 美元的费用。1/24 的流量，所以如果你下载 24GB，你只需要支付 1GB 的费用。免费虚拟机在 1 年后到期。

# c++ - 将引用推入向量中，函数退出后引用是否有效？

> ID：10957271
> 
> 赞同：0
> 
> 时间：2012-06-08T23:53:31.697
> 
> 标签：c++, memory-management, memory-leaks

我创建了一个指向双数组的指针向量。这些指针在函数（即`InsertIntoVector`）退出后是否有效？如果我稍后获取指针`GetVecElement`，是否仍然保证指针指向它们分配的相同内存位置？

```
class A { 
   vector<double*> vec; 

   void insertIntoVector(double x, double y); 
   void GetVecElement(int i, double& x, double& y); 
}; 

A::insertIntoVector(double x, double y) { 
   double* xy = new double[2]; 
   xy[0] = x; xy[1] = y; 
   vec.push_back(xy);       
}

A::GetVecElement(int i, double& x, double& y)
{
    x = vec[i][0];       // will the reference to the double array still be valid? 
    y = vec[i][1];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T23:56:51.337

那些不是*参考*！那些是*指针*...

> 如果我稍后在 GetVecElement 中获取指针，是否仍然保证引用指向它们分配的相同内存位置？

您没有删除指针，`std::vector`也不会为您删除，所以是的，指针将保持有效。除非您在's 的析构函数中手动操作它们，否则它也会被*泄露。*但为此，您还需要一个*复制构造函数*和一个*赋值运算符*，以克隆.`delete``A`**`vector`**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:08:41.470

您使用 GetVecElement 函数通过引用参数获取的值是向量元素指向的堆栈上的数组值（您已在 insertIntoVector() 中分配。因为您不会在代码中的任何位置删除这些值（或者至少看起来）这些值仍然存在，但基本上你在这里所拥有的是内存泄漏，除非你有一些额外的代码正在清理这个内存并且你没有在你的例子中上传。当你的向量被删除或清除后，指向向量的 double* 元素的内存位置将持续存在，除非您主动实施一些代码来清理它（这将是一个好主意）。**

# c# - 调用运行时间长的存储过程

> ID：10957272
> 
> 赞同：3
> 
> 时间：2012-06-08T23:53:36.420
> 
> 标签：c#, sql-server, stored-procedures

我正在尝试使用 C# 调用存储过程。存储过程的运行时间很长（3 到 4 分钟），当我尝试运行它们时它们会导致超时异常。我怎样才能让他们在更长的超时时间内完成运行？

而当它抛出异常时，存储过程是继续在服务器上运行，还是停止？

我的应用程序是一个游戏服务器，存储过程运行以更新和删除邮件。它运行缓慢，因为有太多的记录和太多的连接，用户无法在 SP 运行的同时插入另一条记录。

**我只需要运行SP并等待服务器响应很长时间。**

@minitech 感谢您编辑我的问题

这是SP代码

```
ALTER    PROCEDURE [dbo].[SP_Mail_Scan]
 @NoticeUserID nvarchar(4000) output

AS  
Set @NoticeUserID=''
Declare @AuctionID Int        
Declare @AuctioneerID Int
Declare @AuctioneerName Nvarchar(100)
Declare @BuyerID Int
Declare @BuyerName Nvarchar(100)
Declare @ItemID Int
Declare @PayType Int
Declare @Price Int
Declare @Name Nvarchar(200)

Declare @MailID Int
Declare @SenderID Int
Declare @Sender Nvarchar(100)
Declare @ReceiverID Int
Declare @Receiver Nvarchar(100)
Declare @Title Nvarchar(1000)
Declare @Content Nvarchar(4000)
Declare @SendTime DateTime
Declare @IsRead Bit
Declare @IsDelR Bit
Declare @IfDelS Bit
Declare @IsDelete Bit
Declare @Annex1 Nvarchar(100)
Declare @Annex2 Nvarchar(100)
Declare @Gold Int
Declare @Money Int
Declare @Remark Nvarchar(200)
Declare @Annex3 Nvarchar(100)
Declare @Annex4 Nvarchar(100)
Declare @Annex5 Nvarchar(100)

Set @SenderID =0
Set @Sender =dbo.GetTranslation('SP_Mail_Scan.Sender')  --
Set @ReceiverID = ''
Set @Receiver = ''
Set @Title =dbo.GetTranslation('SP_Mail_Scan.Title')
Set @Content =dbo.GetTranslation('SP_Mail_Scan.Content')
Set @SendTime  = getdate()
Set @IsRead  = 0
Set @IsDelR = 0
Set @IfDelS = 0
Set @IsDelete =0
Set @Annex1 =''
Set @Annex2 =''
Set @Gold =0
Set @Money =0
Set @Annex3 =''
Set @Annex4 =''
Set @Annex5 =''

If object_id('tempdb..#PayMail') Is Not null
Drop Table #PayMail 

Create Table #PayMail 
(
id Int Identity(1,1), 
MailID Int Not Null,
SenderID Int Not Null,
Sender Nvarchar(200) Not null,
ReceiverID Int not null,
Receiver Nvarchar(200) not null,
Title Nvarchar(1000) not null,
Annex1 Nvarchar(100) not null,
Annex2 Nvarchar(100) not null,
Annex3 Nvarchar(100) not null,
Annex4 Nvarchar(100) not null,
Annex5 Nvarchar(100) not null,
) 

insert into #PayMail select [ID],SenderID,Sender,ReceiverID,Receiver,Title,isnull(Annex1,''),isnull(Annex2,''),isnull(Annex3,''),isnull(Annex4,''),isnull(Annex5,'') from User_Messages with(nolock) 
where IsExist=1 and Type>100 and datediff(hh,SendTime,getdate())>ValidDate and [Money]>0

  declare @NewTitle nvarchar(200)
  declare @NewContent nvarchar(200)
  set @NewTitle = dbo.GetTranslation('SP_Mail_Scan.Msg1')
  set @NewContent =dbo.GetTranslation('SP_Mail_Scan.Msg2')

set xact_abort on 
  begin tran

INSERT INTO User_Messages( SenderID, Sender, ReceiverID, Receiver, Title, Content, SendTime, IsRead, IsDelR, IfDelS, IsDelete, Annex1, Annex2, Gold, Money, IsExist,Type,Remark, Annex3, Annex4, Annex5) 
      select ReceiverID,Receiver,SenderID,Sender,@NewTitle+Title,REPLACE(@NewContent,'{0}',Receiver),getdate(), 0, 0, 0, 0,Annex1,Annex2,0,0,1,7,'Gold:0,Money:0,Annex1:'+Annex1+',Annex2:'+Annex2+',Annex3:'+Annex3+',Annex4:'+Annex4+',Annex5:'+Annex5,Annex3,Annex4,Annex5
    from #PayMail

  if @@error<>0 or @@ROWCOUNT =0
    begin
      rollback tran
      return 1 
   end

  update User_Messages set IsExist=0,@NoticeUserID = @NoticeUserID + cast(SenderID as nvarchar(50)) + ',' from User_Messages where [ID] in (select MailID from #PayMail)

  if @@error<>0 or @@ROWCOUNT =0
    begin
      rollback tran
      return 1 
   end

  commit tran
set xact_abort off

if len(@NoticeUserID)>0
begin
 set @NoticeUserID = substring(@NoticeUserID,1,len(@NoticeUserID)-1)
end
--set @NoticeUserID='100,200'

return 0 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T00:02:42.697

四分钟已经变得相当长了，如果以正确的方式设计和查询，即使是具有数百万行和大量要连接的表的数据库也可以在几秒钟内返回结果。

您需要花一些时间处理 sproc 和 Explain Plan 来弄清楚为什么它需要这么长时间。考虑数据分割，将查询拆分为离散的块、索引、连接的构建方式、子选择等。解释计划将告诉你它在哪里浪费时间。

存储过程不应该花费四分钟的时间来运行，尤其是当它们在某种客户端应用程序上运行时。

我有一个遗留查询需要 52 分钟才能运行，通过一个小的重构它是 40 秒，然后再过一点，6 秒。甚至 40 秒都在推动它。

如果您有如此庞大的查询并且它是基于报告的，请考虑使用数据仓库，因为它将具有更适合这些目的的模式设计。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-09T00:01:37.523

我想你正在使用 ADO.NET SqlCommand？

SqlCommand.CommandTimeout 将设置您需要的超时

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout(v=vs.80).aspx)

一旦客户端超时，存储过程就会停止。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-09T06:02:44.453

您可以使用[异步过程执行](http://rusanu.com/2009/08/05/asynchronous-procedure-execution/)。这是一种*可靠*的方式来执行该过程，而客户端不必等待它完成。

但是像您描述的过程（必须定期运行并扫描邮件）更有可能是一项*工作*，而[SQL 代理](http://msdn.microsoft.com/en-us/library/ms189237.aspx)更适合。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-06-17T05:08:20.867

根据您的示例代码，您对每个变量都使用了“声明”。为什么不对每个变量使用单个 Declare。像这样

```
Declare  @AuctionID Int        
        ,@AuctioneerID Int
        ,@AuctioneerName Nvarchar(100)
        ,@BuyerID Int
        ,@BuyerName Nvarchar(100)
        ,@ItemID Int
        ,@PayType Int
        ,@Price Int
        ,@Name Nvarchar(200)

        ,@MailID Int
        ,@SenderID Int
        ,@Sender Nvarchar(100)
        ,@ReceiverID Int
        ,@Receiver Nvarchar(100)
        ,@Title Nvarchar(1000)
        ,@Content Nvarchar(4000)
        ,@SendTime DateTime
        ,@IsRead Bit
        ,@IsDelR Bit
        ,@IfDelS Bit
        ,@IsDelete Bit
        ,@Annex1 Nvarchar(100)
        ,@Annex2 Nvarchar(100)
        ,@Gold Int
        ,@Money Int
        ,@Remark Nvarchar(200)
        ,@Annex3 Nvarchar(100)
        ,@Annex4 Nvarchar(100)
        ,@Annex5 Nvarchar(100) 
```

甚至你为什么不为每个变量使用单个“选择”而不是“设置”

```
Select   @SenderID =0
        ,@Sender = dbo.GetTranslation('SP_Mail_Scan.Sender')  --
        ,@ReceiverID = ''
        ,@Receiver = ''
        ,@Title = dbo.GetTranslation('SP_Mail_Scan.Title')
        ,@Content = dbo.GetTranslation('SP_Mail_Scan.Content')
        ,@SendTime  = getdate()
        ,@IsRead  = 0
        ,@IsDelR = 0
        ,@IfDelS = 0
        ,@IsDelete =0
        ,@Annex1 =''
        ,@Annex2 =''
        ,@Gold =0
        ,@Money =0
        ,@Annex3 =''
        ,@Annex4 =''
        ,@Annex5 ='' 
```

您已经为插入操作创建了#table，但您没有为该表指定任何键，我建议您应该定义主键

```
Create Table #PayMail 
(
     id Int Identity(1,1) Primary Key
    ,MailID Int Not Null
    ,SenderID Int Not Null
    ,Sender Nvarchar(200) Not null
    ,ReceiverID Int not null
    ,Receiver Nvarchar(200) not null
    ,Title Nvarchar(1000) not null
    ,Annex1 Nvarchar(100) not null
    ,Annex2 Nvarchar(100) not null
    ,Annex3 Nvarchar(100) not null
    ,Annex4 Nvarchar(100) not null
    ,Annex5 Nvarchar(100) not null
) 
```

并且您在插入#table 时使用了“with (Nolock)”，因此在从#table 中选择时也应该使用 with (Nolock)。如果您的#table 仅用于插入一次，那么我建议您应该使用 With CTE（通用表表达式），它可能会提高您的 SP 性能。

# java - Java中智能向上或向下舍入的函数？

> ID：10957273
> 
> 赞同：-4
> 
> 时间：2012-06-08T23:53:39.543
> 
> 标签：java, rounding

我正在寻找一个向上或向下四舍五入的 Java 函数，但通常情况下，如 3.2 到 3 和 3.6 到 4。有很多答案，但所有答案要么只向上取整，要么只向下取整。如果没有，那么我想我将不得不创建它，但只是想看看其他人是否曾经想要同样的东西并找到了它。提前致谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-08T23:54:59.927

[Math.round()](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#round%28float%29)：

> **public static int round(float a)**
> 
> 返回最接近参数的 int。通过加 1/2、取结果的底并将结果转换为 int 类型，将结果四舍五入为整数。换句话说，结果等于表达式的值：
> 
> (int)Math.floor(a + 0.5f)
> 
> 参数：
> 
> *   a - 要舍入为整数的浮点值。
> 
> 回报：
> 
> 参数的值四舍五入到最接近的 int 值。

# ruby - 用于 Ruby 的有状态 JSON 解析器

> ID：10957275
> 
> 赞同：0
> 
> 时间：2012-06-08T23:54:38.077
> 
> 标签：ruby, json, parsing, stateful

我有一个 Ruby 服务器，它每 1 秒左右从一个平面文件中读取数据，并且这个平面文件每隔 1 秒左右就不断地被另一台服务器更新为新数据。这个平面文件本质上是一个 JSON 文件。问题是，我不想一遍又一遍地阅读整个文件。相反，我希望 ruby​​ 服务器找出哪些内容是新的并且只读取那些部分。所以我猜我正在为 Ruby 寻找一个有状态的 JSON 解析器。由于我对 Ruby 很陌生，所以我不熟悉这样的库。有人可以建议在这种情况下可能有用的东西吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-09T00:01:49.473

没有“有状态的 JSON 解析器”之类的东西。有状态（如“有状态服务器”）意味着服务器（或解析器）在请求（解析）之间维护某种状态。但是无论如何您都必须阅读和解析整个文件，那么为什么要复杂化呢？

如果文件很小，每次都解析它。如果文件很大，请改用数据库。

# c++ - Eye of Gnome - 使用 shell 脚本在不同窗口上打开两个图像

> ID：10957281
> 
> 赞同：5
> 
> 时间：2012-06-08T23:55:08.747
> 
> 标签：c++, shell

这听起来像是一个愚蠢的问题，我试图解决这个问题一段时间，但我不知道如何解决它。

我有两个名为的图像`imagem.bmp`和`imagem2.bmp`一个 shell 脚本，它应该使用 gnome 之眼打开这两个图像。我在脚本中写了这个：

```
#!/usr/bash
eog imagem.bmp
eog imagem2.bmp 
```

问题是只打开了一个图像，即eog打开了第一个图像，然后在同一屏幕上加载了第二个图像。我只需要在两个单独的屏幕中打开它，以便我可以比较图像。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T23:59:47.747

帮助文本总是有用的：

```
$ eog --help
Usage:
  eog [OPTION...] [FILE…]

Help Options:
  -h, --help                         Show help options
  --help-all                         Show all help options
  --help-gtk                         Show GTK+ Options

Application Options:
  -f, --fullscreen                   Open in fullscreen mode
  -c, --disable-image-collection     Disable image collection
  -s, --slide-show                   Open in slideshow mode
  -n, --new-instance                 Start a new instance instead of reusing an existing one
  --version                          Show the application's version
  --display=DISPLAY                  X display to use 
```

注意这个选项：

```
-n, --new-instance       Start a new instance instead of reusing an existing one 
```

不是运行`eog`，而是运行`eog -n`以打开一个新实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T23:59:25.910

`bash`在开始另一个命令之前等待一个命令完成执行。您可以使用`&`“在后台”执行程序。试试这个：

```
#!/bin/bash
eog imagem.bmp &
eog imagem2.bmp & 
```

我也修复了这个`/usr/bash`错误。

严格来说，第二行不需要`&`，但这会更快地向您返回提示，而无需等待第二个`eog`进程终止。

# java - Eclipse 重命名元素键盘快捷键

> ID：10957284
> 
> 赞同：2
> 
> 时间：2012-06-08T23:55:56.130
> 
> 标签：java, eclipse, eclipse-plugin

我编写了一个显示元素树的 Eclipse 视图。

如何连接到标准的 Eclipse“重命名 - 重构”键盘快捷键，以便当我按下`Shift`+ `Alt`+`R`并选择我的树的一个元素时，我可以处理重命名该元素？

我想我可能需要使用 LTK 扩展点之一。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:49:48.413

我找到了正确的代码：

```
IActionBars actionBars = getViewSite().getActionBars();
actionBars.setGlobalActionHandler(ActionFactory.RENAME.getId(), new Action()
{
  @Override
  public void run()
  {
    ISelection viewSelection = viewer.getSelection();
    if (viewSelection instanceof IStructuredSelection)
    {
      IStructuredSelection selection = (IStructuredSelection)viewSelection;
      Object o = selection.getFirstElement();

      ....
    }
  }
}); 
```

[http://wiki.eclipse.org/FAQ_How_do_I_hook_into_global_actions,_such_as_Copy_and_Delete%3F](http://wiki.eclipse.org/FAQ_How_do_I_hook_into_global_actions,_such_as_Copy_and_Delete%3F)

# ruby-on-rails - 如何重构 Rails 模型中类似的 getter 和 setter 的重复？

> ID：10957288
> 
> 赞同：1
> 
> 时间：2012-06-08T23:57:20.137
> 
> 标签：ruby-on-rails, refactoring, dry

在我的 Rails 模型中，我有类似的东西

def price Money.new(price_cents, currency) end

```
def price=(val)
  price_cents = val.to_money.cents
end

def value
  Money.new(value_cents, currency)
end

def value=(val)
  value_cents = val.to_money.cents
end

def budget
  Money.new(budget_cents, currency)
end

def budget=(val)
  budget_cents = val.to_money.cents
end

def used
  Money.new(used_cents, currency)
end

def used=(val)
  used_cents = val.to_money.cents
end 
```

这显然不是很干。我怎么能重构这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:33:32.203

我假设 [thing]_cents 东西是指 ActiveRecord 模型的属性。如果是这样，我认为您可以按照这些方式做一些事情（很抱歉没有对此进行测试-希望它至少在方向上有帮助）：

```
[:price, :value, :budget, :used].each do |prefix|

  self.class.send(:define_method, "#{prefix}=") do |val|
    write_attribute("#{prefix}_cents".to_sym, val.to_money.cents)
  end

  self.class.send(:define_method, "#{prefix}") do
    Money.new(read_attribute("#{prefix}_cents".to_sym), currency)
  end

end 
```

# php - 加快对同一mysql服务器、不同表的请求

> ID：10957289
> 
> 赞同：0
> 
> 时间：2012-06-08T23:57:40.837
> 
> 标签：php, mysql

我有一个非常简单的mysql请求，1.请求调用表获取id，如果id存在函数结束，如果没有id，则id不被禁止，第二次请求，查看id是否存在于公共表中，如果不，它添加了，如果它添加了它，则页面视图计数为 1。

目前，此功能似乎正在导致严重的减速。af_ban 表有大约 8000 行 af_freefeed 表有大约 1,000,000 行。每天添加大约 10,000 行。

```
function pageview($pageid, $pagename){
$sql=mysql_num_rows(mysql_query("SELECT * FROM anotherfeedv3.af_ban WHERE pageid = '".$pageid."'"));
    if(!$sql){
        $sql=mysql_num_rows(mysql_query("SELECT pageid FROM anotherfeedv3.af_freefeed WHERE pageid = '".$pageid."'"));
            if(!$sql){
            $sql = 'INSERT INTO `anotherfeedv3`.`af_freefeed` (`id`, `pageid`, `userid`, `views`, `pagename`) VALUES (NULL, \''.$pageid.'\', \'\', \'1\', \''.htmlspecialchars($pagename, ENT_QUOTES).'\');';
            $insert=mysql_query($sql) or die ('Error! in Insert '.$pageid.' SQL');
            }else{
            $sql = 'UPDATE `anotherfeedv3`.`af_freefeed` SET `pagename` = \''.htmlspecialchars($pagename, ENT_QUOTES).'\', views=views+1 WHERE `af_freefeed`.`pageid` = '.$pageid.';';
            //$sql = 'UPDATE `anotherfeedv3`.`af_freefeed` SET views=views+1 WHERE `af_freefeed`.`pageid` = '.$pageid.';';
            $update=mysql_query($sql) or die ('Failed update of '.$pageid.' in mysql.');
        }
    }
}; 
```

有没有更好的方法可以写这个？

* * *

解决方案！

```
function pageview($pageid, $pagename){
$q = sprintf('SELECT COUNT(*) AS numrows FROM anotherfeedv3.af_ban WHERE pageid = %d', $pageid);
$r = mysql_query($q);
$a = mysql_fetch_assoc($r);
if($a['numrows'] > 0){ /* ... */ }else {
    $q = sprintf('SELECT COUNT(*) AS numrows FROM anotherfeedv3.af_freefeed WHERE pageid = %d', $pageid);
    $r = mysql_query($q);
    $a = mysql_fetch_assoc($r);
    if($a['numrows'] > 0){ /* ... */ 
    $sql = 'UPDATE `anotherfeedv3`.`af_freefeed` SET `pagename` = \''.htmlspecialchars($pagename, ENT_QUOTES).'\', views=views+1 WHERE `af_freefeed`.`pageid` = '.$pageid.';';
            //$sql = 'UPDATE `anotherfeedv3`.`af_freefeed` SET views=views+1 WHERE `af_freefeed`.`pageid` = '.$pageid.';';
    $update=mysql_query($sql) or die ('Failed update of '.$pageid.' in mysql.');
    }else {
    $sql = 'INSERT INTO `anotherfeedv3`.`af_freefeed` (`id`, `pageid`, `userid`, `views`, `pagename`) VALUES (NULL, \''.$pageid.'\', \'\', \'1\', \''.htmlspecialchars($pagename, ENT_QUOTES).'\');';
            $insert=mysql_query($sql) or die ('Error! in Insert '.$pageid.' SQL');
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:13:25.770

使用这些行：

```
$sql=mysql_num_rows(mysql_query("SELECT * FROM anotherfeedv3.af_ban WHERE pageid = '".$pageid."'"));
if(!$sql){ /* ... */ } 
```

您似乎只对结果是否存在感兴趣。

如果是这种情况，您可以将其替换为以下内容：

```
$q = sprintf('SELECT COUNT(*) AS numrows FROM anotherfeedv3.af_ban WHERE pageid = %d', $pageid);
$r = mysql_query($q);
$a = mysql_fetch_assoc();
if($a['numrows'] > 0){ /* ... */ } 
```

您可以将其浓缩，但为了便于理解，我将其拆分得很宽泛。

基本上，这让 MySQL 在不生成结果集的情况下确定行数。

此外，您可以使用此技术来组合前两个查询：

```
$q = 'SELECT (';
$q.= '    SELECT COUNT(*) FROM anotherfeedv3.af_ban WHERE pageid = %d';
$q.= ') AS banrows, (';
$q.= '    SELECT COUNT(*) FROM anotherfeedv3.af_freefeed WHERE pageid = %d';
$q.= ') AS freerows';
$r = mysql_query(sprintf($q, $pageid, $pageid);
$a = mysql_fetch_assoc(); 
```

查询的结果将是一行两列（banrows、freerows）。这些值将是与上述相应查询匹配的行数。

然后，您将使用`$a['banrows']`and`$a['freerows']`为您以后的逻辑获取行数。

如果您多次运行此查询，如果您使用 PDO 和[`PDO::prepare()`](http://www.php.net/manual/en/pdo.prepare.php).

# c - 将数组指针传递给结构并访问数组

> ID：10957292
> 
> 赞同：0
> 
> 时间：2012-06-08T23:58:46.590
> 
> 标签：c, arrays, pointers, struct

我需要将指向 char 数组的指针存储在结构中，然后修改/访问数组内容。我怎样才能做到这一点？

我只能想到类似的东西，但我没有得到完整的可编译解决方案。

```
struct foo {
    unsigned char *array;
}; 
```

进而：

```
unsigned char array[512];
struct foo *foo;
foo->array = array; 
```

在另一个接收指向结构的指针的函数中：

```
*(foo->array[0]) = 'K'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:00:09.333

你的代码几乎没问题：

```
foo->array[0] = 'K'; 
```

您的代码的问题`*(foo->array[0])`是您尝试取消引用`char`甚至不是指针的 a 。

您还需要为结构分配内存 - 当前`foo`指向一些随机内存位置，访问很可能会使您的程序崩溃：

```
struct foo *foo = malloc(sizeof(*foo)); 
```

# ruby-on-rails-3 - 设计不会在 Rails 引擎中选择命名空间模型

> ID：10957294
> 
> 赞同：1
> 
> 时间：2012-06-08T23:59:04.627
> 
> 标签：ruby-on-rails-3, devise, rails-engines

我想在单独的 Rails 引擎中提取我的管理界面。为管理员用户添加设计支持对我来说不太有效。这是引擎代码：

管理员用户模型：

```
AppEditorial::Admin 
```

发动机路线：

```
 devise_for :admins, :controllers => {
    sessions: "app_editorial/devise/sessions",
    registrations: "app_editorial/devise/registrations",
    confirmations: "app_editorial/devise/confirmations",
    class_name: "AppEditorial::Admin",
    module: :devise
  } 
```

这会引发错误：

```
/../inflector/methods.rb:229:in `block in constantize': uninitialized constant Admin (NameError) 
```

这是有道理的，因为模型被命名为*AppEditorial::Admin*。添加 *class_name* 选项也不起作用。

作为起点，我找到了本教程：[Use-devise-inside-a-mountable-engine](https://github.com/plataformatec/devise/wiki/How-To%3a-Use-devise-inside-a-mountable-engine)。

[devise_for](http://rdoc.info/github/plataformatec/devise/master/ActionDispatch/Routing/Mapper#devise_for-instance_method)的文档。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T10:30:08.870

霍普拉 明显错误：

它应该是：

```
 devise_for :admins, {
    controllers: {
      sessions: "app_editorial/devise/sessions",
      registrations: "app_editorial/devise/registrations",
      confirmations: "app_editorial/devise/confirmations",
    },
    class_name: "AppEditorial::Admin",
    module: :devise
  } 
```

跛脚:)

# php - PHP修复数组中的数字键

> ID：10957300
> 
> 赞同：16
> 
> 时间：2012-06-08T23:59:49.117
> 
> 标签：php, arrays, sorting

出于某种原因，从数组中删除项目时，我留下了 0、2、3、4、6、9 之类的键，而不是 0、1、2、3、4、5。所以我试图找出原因，并且我可以做些什么来修复它，而不用对所有东西进行排序，`sort()`因为那样会让东西井井有条。我只是想重新输入一个说话的问题。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-06-09T00:02:26.463

用于[`array_values()`](http://us.php.net/manual/en/function.array-values.php)获取原始数组的值并将它们返回到新数组。该新数组将包含新的数字键。

```
$new_array = array_values($old_array); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T00:28:44.100

您应该使用`array_splice()`从数组中删除元素，以便它同时以您希望的方式更改键。

您必须小心，`array_values()`因为它不会（或至少可能不会）工作，因为它可能会[重新排序您的数字索引](http://php.net/manual/fr/function.array-values.php#114941)。如果在索引 3 的值之后添加索引 0 处的值，则索引 0 处的值将放置在由 返回的数组的末尾`array_values()`，而它首先出现在您的数组中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-09T00:02:58.923

由于键不一定重要，您可以通过[`array_values()`](http://php.net/array_values). 它将所有值按原顺序保留，将所有键重置为顺序数值。

# c++ - 库中调用没有匹配的函数

> ID：10957303
> 
> 赞同：2
> 
> 时间：2012-06-09T00:00:00.253
> 
> 标签：c++

我在动态库中有一个带有公共函数的类：

```
void setActiveAnimation(std::shared_ptr<MaJR::Animation> anim); 
```

当我尝试这样称呼它时：

```
 MaJR::Actor actor;
    actor.setActiveAnimation(idleAnimation); 
```

我得到以下信息：

```
/home/mike/NixCraft/main.cpp||In function 'int main()':|
/home/mike/NixCraft/main.cpp|12|error: no matching function for call to 'MaJR::Actor::setActiveAnimation(MaJR::Animation&)'|
/home/mike/NixCraft/main.cpp|12|note: candidate is:|
/usr/include/MaJR/Actor.hpp|16|note: void MaJR::Actor::setActiveAnimation(std::shared_ptr<MaJR::Animation>)|
/usr/include/MaJR/Actor.hpp|16|note:   no known conversion for argument 1 from 'MaJR::Animation' to 'std::shared_ptr<MaJR::Animation>'|
||=== Build finished: 4 errors, 0 warnings ===| 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T00:04:39.477

该错误清楚地表明您正在尝试使用对`MaJR::Animation`而不是a 的引用来调用该函数`std::shared_ptr<MaJR::Animation>`。每当您声明`idleAnimation`时，您应该改为：

```
std::shared_ptr<MaJR::Animation> idleAnimation( new MaJR::Animation() ); 
```

或者更好：

```
std::shared_ptr<MaJR::Animation> idleAnimation = std::make_shared<MaJR::Animation>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:05:16.337

我看不到您是如何定义“idleAnimation”的，但我猜它不是指针，而是对实际对象的引用。setActiveAnimation() 需要一个指针，因此请相应地调整您的代码。

# git - 移动远程 git 存储库后，我不再可以从中获取

> ID：10957306
> 
> 赞同：1
> 
> 时间：2012-06-09T00:00:56.897
> 
> 标签：git

我切换了服务器，所以我只是简单地同步了远程 git 存储库，我将更改从该存储库推送到新服务器。现在我试图从中获取并收到错误：

```
ssh://user@domain.com:1234/home/user/gitrepos/project.git: 
cannot execute: git-upload-pack '/home/user/gitrepos/project.git' 
```

什么可能导致这个问题？如何进行故障排除？

PS 域和端口，以及文件 repo dir 位置都是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:01:25.283

当您在`git`远程服务器上使用时，还需要`git`安装远程对等方。（这有点像`rsync`——在远程端点上安装软件允许在远程对等点上计算详细信息，以避免不必要的网络流量。）

因此，请确保`git`在远程对等方上安装了全功能，命令位于您正常`PATH`登录时通过[georgebrock 指出的](https://stackoverflow.com/questions/10957306/after-moving-a-remote-git-repository-i-no-longer-can-fetch-from-it#comment14309935_10957306)，并且您的用户帐户具有执行命令的权限（如果您的登录 shell 是受限于[强制访问控制](http://en.wikipedia.org/wiki/Mandatory_access_control)工具，例如[AppArmor](http://wiki.ubuntu.com/AppArmor/)、[SELinux](http://en.wikipedia.org/wiki/Security-Enhanced_Linux)、[TOMOYO](http://tomoyo.sourceforge.jp/index.html.en)或[SMACK](http://schaufler-ca.com/)）。`ssh`

# xcode - 在 IB 中添加自定义子视图

> ID：10957307
> 
> 赞同：0
> 
> 时间：2012-06-09T00:01:06.070
> 
> 标签：xcode, cocoa, interface-builder

我有两个 nib 文件：主应用程序窗口和一个我想在其中使用的小视图。如何使用界面生成器将此视图的实例插入主窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:10:21.643

你不能。如果您想在主应用程序窗口中显示一个小视图，只需将自定义视图对象拖到主 nib 的窗口中即可。

您可以将第二个 nib 视图添加到主窗口，但这必须在代码中完成。通常的做法是在你的项目中添加一个新文件，它是 NSViewController 的子类——你会得到一个新的带有视图的 xib 文件。然后，您将分配 initWithNibName:bundle: 来创建视图控制器的实例，并将其视图添加到主窗口的 contentView。

# javascript - 从 node.js 返回文件的解析输出

> ID：10957310
> 
> 赞同：1
> 
> 时间：2012-06-09T00:01:23.003
> 
> 标签：javascript, node.js, asynchronous, express, fs

我有我的文件正在读取并被正确解析，但我似乎无法返回输出字符串。我希望能够从分配给客户端的变量中访问此字符串。我正在使用异步系列来帮助缓解回调地狱，并且输出可以很好地到达控制台。但是，如果我将返回输出放在同一个位置，它就不起作用。建议？

```
embed_analytics: function(){
    var output;

    async.series({
            read_file: function(callback){
               fs.readFile(__rootpath+'/apps/analytics/data/analytics.json', 'UTF-8', function(err,data){
                    if(err) {
                        console.error("Could not open file: %s", err);
                        process.exit(1);
                    }
                    try {
                        var config = JSON.parse(data);
                        callback(null, config);
                    }
                    catch(exception) {
                        console.error("There was an error parsing the json config file: ", exception);
                        process.exit(1);
                    }
                });
            }
        },
        function(err, results) {
            _.each(results.read_file, function(element){
                output+="$('"+element.Selector+"').click(function(){_gaq.push(['_trackEvent',"+element.Category+","+element.Action+","+element.Label+"]);});\n";
            });
            console.log(output);     
        }
    );
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:06:04.687

`return`来自异步函数的 ing，例如 的回调`async.series`，没有任何意义。您需要将回调传递给主函数，并使用以下命令调用它`output`：

```
embed_analytics: function(final_callback){
  ...
        },
        function(err, results) {
            _.each(results.read_file, function(element){
                output+="$('"+element.Selector+"').click(function(){_gaq.push(['_trackEvent',"+element.Category+","+element.Action+","+element.Label+"]);});\n";
            });
            final_callback(output);     
        }
    );
} 
```

然后像使用任何其他异步函数一样使用它：

```
embed_analytics(function(data) {
  // do something with data
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:06:12.003

它是异步的，你**不能**从异步函数返回一些东西。您必须接受在操作完成时调用的回调。Brandon Tilley 有正确的代码来做到这一点。

# c++ - Qt 调试：我正在实现一个使用时无法识别的 Qt 线程类，我做错了什么？

> ID：10957319
> 
> 赞同：2
> 
> 时间：2012-06-09T00:02:55.163
> 
> 标签：c++, qt, debugging, qthread

所以我在我的程序中实现了一个线程类，我试图从我的主窗口运行，但它没有被识别。我将在线程头和文件下方发布，以及主窗口头和文件。

CONTEXT：该线程包含一个循环，该循环遍历目录中的文件并发送信号以将标题打印到主窗口。

directoryprinter.h（线程头）

```
#ifndef DIRECTORYPRINTER_H
#define DIRECTORYPRINTER_H

#include <QThread>
#include <QtCore/QDir>
#include <QtCore/QDirIterator>

class DirectoryPrinter : public QThread
{
    Q_OBJECT
public:
    explicit DirectoryPrinter(QObject *parent = 0);
    void DirectoryParser();
    void run();

signals:
    void SendSignal(QString);

private:
    QDirIterator * it;    
};

#endif // DIRECTORYPRINTER_H 
```

线程类定义

```
#include "directoryprinter.h"

DirectoryPrinter::DirectoryPrinter(QObject *parent) :
    QThread(parent)
{
    it = new QDirIterator ("C:Users/Andrew/",QDirIterator::Subdirectories);
}

void DirectoryPrinter::DirectoryParser()
{
    while (it->hasNext())
    {
        QString String = it->next();
        SendSignal(String);
    }
}

void DirectoryPrinter::run()
{
    this->DirectoryParser();
} 
```

主窗口.h

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>
#include <QDebug>
#include <iostream>
#include "directoryprinter.h"

//UNINITIALIZED POINTERS??

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    void Print(QString String);
    ~MainWindow();

private slots:
    void on_pushButton_released();

private:
    Ui::MainWindow *ui;
    DirectoryPrinter *Name; //THIS LINE IS NOT RECOGNIZED
};

#endif // MAINWINDOW_H 
```

主窗口.cpp

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    connect(Name,SIGNAL(SendSignal(QString)),this,SLOT(Print(QString)));
    }

void MainWindow::Print(QString String)
{
    ui->textBrowser->setText(String);
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::on_pushButton_released()
{
    Name = new DirectoryPrinter();
    Name->start();
} 
```

程序退出：退出代码-1073741819

但是，我认为问题出在我上面评论的那一行。我不确定从哪里开始调试它，我有一些想法，但它们大多是猜测，而且我没有太多使用线程的经验。

提前致谢。让我知道是否需要任何进一步的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:10:03.723

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    connect(Name,SIGNAL(SendSignal(QString)),this,SLOT(Print(QString)));
} 
```

在`MainWindow`的构造函数中，您正在连接来自尚未初始化的对象的信号（在被调用`Name`之前您不会初始化`on_pushButton_released()`）。要解决此问题，`Name`请在构造函数中创建：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    Name = new DirectoryPrinter(this);//this is the parent; takes care of cleanup
    connect(Name,SIGNAL(SendSignal(QString)),this,SLOT(Print(QString)));
}

void MainWindow::on_pushButton_released()
{
    //Name = new DirectoryPrinter(); not needed here anymore
    Name->start();
} 
```

从下面的评论来看，这里还有另一个问题——即`MainWindow::Print`没有定义为`slot`（使用`slots:`宏）。它应该是：

```
class MainWindow : public QMainWindow
{
    Q_OBJECT
public:
    explicit MainWindow(QWidget *parent = 0);
    //void Print(QString String); // <-- not here...
    ~MainWindow();

public slots:
    void Print(QString String); // <-- here instead

// ...other class-definition stuff
}; 
```

# macos - 如何让 getpwuid 在我的 mac 应用程序中工作？

> ID：10957323
> 
> 赞同：0
> 
> 时间：2012-06-09T00:03:41.093
> 
> 标签：macos, mac-app-store, getpwuid

我正在尝试让我的沙盒 mac 应用程序访问用户的真实主文件夹。

这是我尝试过的

```
const char *home = getpwent()->pw_dir;
NSString *path = [[NSFileManager defaultManager] 
              stringWithFileSystemRepresentation:home
              length:strlen(home)];
NSURL *url = [NSURL fileURLWithPath:path isDirectory:YES]; 
```

但我收到了这个错误：

```
Member reference type 'int' is not a pointer 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:06:27.393

我忘了

```
 #include <pwd.h> 
```

我会留下问题，以防其他人遇到问题！

# iphone - 如何轮询 CoreLocation 而不是获取更新？

> ID：10957327
> 
> 赞同：1
> 
> 时间：2012-06-09T00:04:38.213
> 
> 标签：iphone, ios, gps, core-location

在具有 CoreLocation 框架（用于 GPS 跟踪）的 iOS 中，我如何询问位置而不是获取持续更新。我不希望每秒钟左右调用一次 didUpdateToLocation ，我只想在需要时获取位置。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:07:18.920

我不相信有办法做到这一点。您可以只启动更新，然后在 didUpdateToLocation 中禁用它们，这样您就只能得到一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:07:05.380

成功获取位置后停止定位服务

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T01:08:02.397

你不能。硬件（收音机等）不够快。相反，您必须在需要位置之前稍微调用 startUpdatingLocation 方法，并等待无线电获得您需要的准确修复（最初的几个位置回调可能不是非常准确或不如后来的回调准确） . 然后，如果您在很长一段时间内不需要位置更新，您可以停止它们，以帮助节省电池寿命。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T03:29:22.800

正如我在评论中建议的那样，您可以随意使用`-startUpdatingLocation`和的组合`-stopUpdatingLocation`，如果您在收到位置更新后停止更新，除非您再次启动它，否则它将不会继续。下面的例子：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {

    //Store your new location before stopping updates.

    [manager stopUpdatingLocation];
} 
```

现在，当您想在应用程序中的某个其他时间检索新位置时。不用担心它的更新频率，因为它只会更新一次。

```
[locationManager startUpdatingLocation]; 
```

希望这是有道理的，并有所帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-09T04:15:53.487

当您调用`startUpdatingLocation`方法时，它将首先返回缓存点。因此，在委托方法`didUpdateToLocation`中，您应该检查该位置的准确性。如果它不在可接受的范围内，则应忽略该位置。您应该继续获取位置，直到该点落在可接受的范围内。一旦收到这样的点，你应该打电话`stopUpdatingLocation`。

# mongodb - mongodb更新的搜索组件也是原子的吗？

> ID：10957330
> 
> 赞同：1
> 
> 时间：2012-06-09T00:05:09.263
> 
> 标签：mongodb, atomic

从[MongoDB Update 文档](http://www.mongodb.org/display/DOCS/Updating)中，他们谈到更新操作符是原子的。如果以下查询在同一时刻被调用五次并且 Zugwalt 的声誉从零开始，我希望最终声誉为 5：

```
db.rep.update({_id: "Zugwalt"}, {$inc: {reputation: 1}}); 
```

但是，如果更新查询是这样的呢？

```
db.rep.update({_id: "Zugwalt", reputation: {$lte: 3}}, {$inc: {reputation: 1}}); 
```

声望是否总是只更新 3 次，还是有一些奇怪的比赛条件可能会更多？

我的特殊情况是使用活动用户“声明文档”。我执行类似于以下的查询：

```
db.myCollection.update({_id: "doc_id", activeUser: {$exists: false}}, {$set: {activeUser: "Zugwalt"}}); 
```

理想情况下，如果此查询在同一实例中多次触发，则只有一次更新会导致集合被修改。但是，如果搜索组件在更新时不是原子的，我可以看到一个竞争条件，它首先更新为将 activeUser 设置为一个用户，然后立即设置为另一个用户。

旁注：[findAndModify](http://www.mongodb.org/display/DOCS/findAndModify+Command)命令具有这种原子性似乎更清楚，但是我不想使用它，因为在我们使用 node-js 驱动程序的经验测试中，在重负载下总体上看起来要慢得多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T06:50:55.933

在 MongoDB 中，更新是原子的。如果不需要取回文档，则不需要使用 findAndModify。

在您给出的场景中，预期的事情将会发生 - 在第一种情况下，声誉最终会是 5，在第二种情况下会是 4。

在您的情况下，只有一个更新会成功设置 activeUser。

这是一个讨论 MongoDB 中的原子操作的[链接。](http://www.mongodb.org/display/DOCS/Atomic+operation+examples)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:11:22.963

对于这种情况，您应该使用[`findAndModify`](http://www.mongodb.org/display/DOCS/findAndModify+Command). 它是完全原子的。

像这样的东西：

```
db.runCommand({findAndModify: 'myCollection',
               query: {_id: "doc_id", activeUser: {$exists: false}},
               update: {$set: {activeUser: "Zugwalt"}}}) 
```

# jquery - 获取动态创建的元素

> ID：10957332
> 
> 赞同：0
> 
> 时间：2012-06-09T00:06:00.783
> 
> 标签：jquery, dom

好的，我正在动态创建隐藏的输入字段，如下所示：

```
$("<input type='hidden' id=pid'"+postid+"-title name='posts["+postid+"][title]' value='' />" +
  "<input type='hidden' id=pid'"+postid+"-body name='posts["+postid+"][body]' value='' />" +
"<input type='hidden' id=pid'"+postid+"' class='category' name='posts["+postid+"][category]' value='' />" +
"<input type='hidden' id=pid'"+postid+"' class='author' name='posts["+postid+"][author]' value='' />"
).appendTo("#datatable"); 
```

为了方便调试，我把title输入的id改成了包含它的class（也就是title）。所以似乎我应该能够使用代码访问它`$('#pid'+id+'-title')`。然而，事实并非如此。相反，使用的结果`$("#pid"+id+"-title")toSource()`是`({context:({}), selector:"#pid0-title"})`. 顺便说一下，0 是正确的 ID。

我觉得我一定遗漏了一些关于 JQuery 和动态元素的明显内容。我显然找不到我的对象的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:36:44.857

你可以尝试这种方式更清晰有序：

```
var createInputs = function(postid) {

    var 
        input = $('<input type="hidden" value="" />'),
        createInput = function(id, type) {
            return input.clone()
                    .addClass(type)
                    .attr('id', 'pid' + id + '-' + type)
                    .attr('name', 'posts[' + id + '][' + type + ']');
        };

    $()
        .add(createInput(postid, 'title'))
        .add(createInput(postid, 'body'))
        .add(createInput(postid, 'category'))
        .add(createInput(postid, 'autor'))
        .appendTo('#datatable');

};    

createInputs(1);

console.log($('#datatable').html()); 
```

[例子](http://jsfiddle.net/adescalzo/DtNJ7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:08:38.530

您的 id 中有引号，也有重复的 id，它们都不是有效的。请只使用带有可接受字符的唯一 ID（以字母开头，可以包括数字和下划线，可能还有一些我忘记的其他 ID）

```
$("<input type='hidden' id='pid"+postid+"-title' name='posts["+postid+"][title]' value='' />" +
  "<input type='hidden' id='pid"+postid+"-body' name='posts["+postid+"][body]' value='cccc' />" +
"<input type='hidden' id='pid"+postid+"-category' class='category' name='posts["+postid+"][category]' value='' />" +
"<input type='hidden' id='pid"+postid+"-author' class='author' name='posts["+postid+"][author]' value='' />").appendTo("#datatable");

 alert($("#pid1-body").val()); 
```

以上在 jQuery 中工作，我可以按 ID 选择并获取如图所示的值，您的 id 中的撇号正在杀死代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T00:19:06.027

`ID`由于所有输入中的“单引号”位置错误，您的输入没有获得属性的值。

请参阅此[工作小提琴](http://jsfiddle.net/zuul/wtZ3Z/)示例！

**使您的代码适应此：**

```
$("<input type='hidden' id='pid"+postid+"-title' name='posts["+postid+"][title]' value='' />" +
"<input type='hidden' id='pid"+postid+"-body' name='posts["+postid+"][body]' value='' />" +
"<input type='hidden' id='pid"+postid+"' class='category' name='posts["+postid+"][category]' value='' />" +
"<input type='hidden' id='pid"+postid+"' class='author' name='posts["+postid+"][author]' value='' />"
).appendTo("#datatable"); 
```

*现在元素的选择应该没有任何问题。*

* * *

**注意：** 正如@Jeff Watkins 所提到的，您不应该`ID`在`document`.

`input.category`和`input.author`有相同的`ID`。

请参阅相关[文档](http://www.w3.org/TR/CSS2/selector.html#id-selectors)，其中内容为：

> ... ID 属性可用于唯一标识其元素。

# c#-4.0 - 当所有其他人工作时，C# Outlook 在特定 PC 上附加电子邮件附件系统异常

> ID：10957334
> 
> 赞同：1
> 
> 时间：2012-06-09T00:06:06.553
> 
> 标签：c#-4.0, outlook, add, email-attachments, outlook-2010

```
Outlook.MailItem newMail = (Outlook.MailItem)olook.CreateItem(Outlook.OlItemType.olMailItem);

...

Outlook.MailItem attachItem = olook.Session.GetItemFromID(AttachmentID);
Outlook.Attachment Attach3 = newMail.Attachments.Add(attachItem,  
   Outlook.OlAttachmentType.olEmbeddeditem); 
```

我从收件箱的显示中获得`AttachmentID`了 Outlook 。这适用于我所有的 Win7 Pro 工作站，*除了一个*.`EntryID``GridView`

 *我已经检查了 Outlook 中的高级设置和信任管理器设置。没有什么突出的。我怀疑问题是此工作站独有的 Outlook 或加载项设置。

堆栈跟踪不提供任何有用的细节。没有提供行号。没有其他解释。

我收到一个错误`Attachments.Add`：

> Outlook 错误：系统异常：Microsoft.Office.Interop.Outlook.Attachments.Add(...我的方法构造函数...)

任何想法或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T14:02:19.103

`System.Exception`可以是任何东西。我建议您将您的**方法构造函数**移动到不同的行，以便您可以查看是您的构造函数还是**Attachments.Add**导致了问题。我怀疑是后者。*

# django - 我可以将 Django 输出的选择框内的 HTML 实体标记为安全吗？

> ID：10957336
> 
> 赞同：1
> 
> 时间：2012-06-09T00:06:21.167
> 
> 标签：django, escaping, html-entities

我的 Django 表单上有一个包含`&reg;`HTML 实体的下拉框。有没有一种简单的方法可以让 Django 将其标记为安全？

这不起作用：

```
{{ form.myoptions.label_tag }}
{{ form.myoptions|safe }} 
```

编辑：

我应该提到下拉框是从一个`ForeignKey`字段生成的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:21:31.553

你是对的 - 它不起作用......我想最简单的方法是将它标记为对 python 安全。

```
from django.utils.safestring import mark_safe

MY_CHOICES = [
    ('foo', mark_safe('&amp; foo')),
    ('bar', 'bar'),
] 
```

根据来源，您可以`ModelChoiceField.choices`手动定义一个或编写一个新字段并覆盖`label_from_instance`。

```
class MyModelForm(forms.ModelForm):
    class Meta:
        model = Foo
    def __init__(self, *args, **kwargs):
        super(MyModelForm, self).__init__(*args, **kwargs)
        self.fields['foo'].choices = ((foo.id, mark_safe(foo.bar)) for foo in Foo.objects.all())

class SafeModelChoiceField(ModelChoiceField):
    def label_from_instance(self, obj): 
        return mark_safe(obj) 
```

我想我更喜欢自己构建选择，这样任何其他神奇`ModelForm` `field -> form field`的转换都不会被覆盖。

# php - 如何将php变量传递给javascript函数

> ID：10957341
> 
> 赞同：-3
> 
> 时间：2012-06-09T00:06:57.547
> 
> 标签：php, javascript, html

> **可能重复：**
> [如何将 PHP 变量传递给 Javascript？](https://stackoverflow.com/questions/3306314/how-to-pass-a-php-variable-to-javascript)

我需要以某种方式使这个函数接受参数。

### 索引.html

```
function dataOut(name2) {
    var names = name2.value;
    document.getElementById("output2").innerHTML = names;
    //even document.getElementById("output2").innerHTML= "blablabla"; 
    //just to show that it works
} 
```

该函数将从以下位置调用：

dbase.php

```
...
echo "<td><a href='javascript:dataOut(this.value)'>" . $row['FirstName'] . "</a></td>";
... 
```

我在显示表格时没有问题。该链接确实显示了它们各自的“$row['FirstName']”，它们是来自数据库的字符串。我尝试使用非参数函数：

```
function dataOut(){}
echo "<td><a href='javascript:dataOut()'>" . $row['FirstName'] . "</a></td>"; 
```

这些工作正常。

如果我尝试传递参数，该函数将不会做任何事情；即使我只想像函数的注释部分那样打印随机字符串。如果我将鼠标悬停在该表中创建的链接上，我会看到：

```
javascript:dataOut(firstname)
//where first name is the value of the $row['FirstName'] 
```

我尝试过的替代方案：

```
echo "<td><a href='javascript:dataOut(this.value)'>" . $row['FirstName'] . "</a></td>";
echo "<td><a href='javascript:dataOut($row['FirstName'])'>" . $row['FirstName'] . "</a></td>";
echo "<td><a href='javascript:dataOut('" . $row['FirstName'] .'")'>" . $row['FirstName'] . "</a></td>"; //this give me undefined variable error
echo "<td><a href='javascript:dataOut(". $row['FirstName']. ")'>" . $row['FirstName'] . "</a></td>"; // this no error 
```

任何帮助，将不胜感激。此外，我也尝试过，这也`<a onclick=dataOut ....>`不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:12:33.087

You shouldn't try to create JavaScript strings by concatenating quotes and plain strings. Use `json_encode()` instead which is guaranteed to output a valid JavaScript expression:

```
echo "<td><a href='javascript:dataOut(".json_encode($row['FirstName']).")'>" . $row['FirstName'] . "</a></td>"; 
```

* * *

On a side-note, using `javascript:` urls is generally a bad idea. Better use `onclick="dataOut(...); return false;"` instead and use a *useful* href value or `#` if no proper URL for people without JavaScript exists. Of course it would be even better to register the event properly instead of using an inline event, and storing the data in a `data-` attribute but this would be even more off-topic here.

# android - 验证 Android 位图是灰度

> ID：10957348
> 
> 赞同：2
> 
> 时间：2012-06-09T00:07:39.040
> 
> 标签：android, image-processing, bitmap, grayscale

我有一个疑问。当我从`Bitmap`Android 中的 a 获取像素时。我在里面加载了一张图片，这张图片是灰度图。如果我创建一个`getPixels()`并检查值，我可以看到 R != G != B 的值。

如果三张幻灯片（R，G和B）的值相同，我想我可以检查它是否是灰度，但我不可能。有办法验证吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T06:24:14.220

首先让我们说有几种方法可以实现这一点。

我会说使用（类似）获取图像的大小

```
int myHeight = myImage.getHeight();
int myWidth  = myImage.getWidth(); 
```

我想说在这种情况下，您可能还想验证位图的配置，因为它可能是 3 种不同格式之一

```
ALPHA_8, ARGB_8888, or RGB_565 
```

您可以使用

```
myImage.getConfig() 
```

常规。稍后我们将回到如何使用它。

既然您知道图像的大小，您应该运行一个双循环结构，如下所示：

```
boolean isGrayscaleImage = true;  // assume it is grayscale until proven otherwise

for(int i = 0; i < myWidth; i++){
    for(int j = 0; j < myHeight; j++){
        int currPixel = myImage.getPixel(i, j);

        if( false == isGrayScalePixel(currPixel) ){
            isGrayscaleImage = false;
            break;
        }
    }
} 
```

返回如何测试像素是否为灰度：如果图像存储为 ALPHA_8，则它确实不是灰度图像，但从技术上讲，可以通过将图像转换为 ARGB_8888 图像并将 Alpha 值设置为 0xFF 将其转换为灰度图像以及原始 8 位基于 ALPHA_8 的图像中提供的 alpha 值的每个 R、G 和 B 分量。

如果图像是 RGB_565 格式，这有点棘手，因为您必须自己使用 shift 和 MASKING 运算符将 R、G 和 B 值拆分为它们自己的字节。完成此操作后，它本质上就像处理 ARGB_8888 图像（在下面讨论）。

对于 ARGB_8888 图像：alpha 通道应始终为 0xFF。

正如您在问题中所述，如果 R == G == B SO（示例代码可能如下所示），则将像素视为灰度

```
boolean isGrayScalePixel(int pixel){
    int alpha = (pixel && 0xFF000000) >> 24;
    int red   = (pixel && 0x00FF0000) >> 16;
    int green = (pixel && 0x0000FF00) >> 8;
    int blue  = (pixel && 0x000000FF);

    if( 0 == alpha && red == green && green == blue ) return true;
    else return false;

} 
```

可以进行一些优化，但我正在尝试为您记录主要算法。

希望这可以帮助你 ：-）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T15:39:01.253

注意 && (boolean AND) 的使用，当掩码应该是一个 & (bitwise AND) 时，如下所示：

```
int alpha = (pixel & 0xFF000000) >> 24;
int red   = (pixel & 0x00FF0000) >> 16;
int green = (pixel & 0x0000FF00) >> 8;
int blue  = (pixel & 0x000000FF); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-20T09:01:19.023

如果您所要做的就是检查 R、G 和 B 值是否相同，那么只需使用`Colors.red()`,`Colors.green()`或`Colors.blue()`.

这是实际代码的一小部分。

```
for(int x=0;x< bmp.getWidth();x++) {
    for(int y=0;y< bmp.getHeight();y++) {    

        int pixel=bmp.getPixel(x,y);
        int alpha=Color.alpha(pixel);            
        int gray_color=Color.red(pixel);         
        int gray_color1=Color.green(pixel);

        //int gray_color=pixel&0x000000ff;
        //int gray_color1=(pixel&0x0000ff00)>>8;
        //int gray_color2=(pixel&0x00ff0000)>>16;
        //int gray_color3=Math.abs((pixel&0xff000000))>>24;

        int pixels= (int)Math.pow(gray_color,gamma);
        k.add(""+alpha+" "+gray_color+" "+gray_color1);
        bmp.setPixel(x,y,Color.argb(alpha,pixels,pixels,pixels));
    }
} 
```

你可以看到我已经评论了移位和遮罩部分。

# iphone - 从电子邮件重定向到移动浏览器，然后重定向到应用程序

> ID：10957351
> 
> 赞同：1
> 
> 时间：2012-06-09T00:08:10.770
> 
> 标签：iphone, ios, mobile, browser, safari

我想知道是否有人知道是否有可能构建一个向用户发送电子邮件的服务，并带有一个链接，如果他们安装了应用程序，它将通过浏览器将他们带到应用程序，如果没有，然后到应用商店，再次通过浏览器？我担心下次用户访问移动浏览器（safari）时，由于页面刷新，他将再次被定向到我的应用程序或应用程序商店，因为那是最后一次访问的页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:17:22.397

我认为这是一个类似的问题，这里有一些解决方案，[是否可以为 iPhone 应用程序注册一个基于 http + 域的 URL 方案，如 YouTube 和地图？](https://stackoverflow.com/questions/1108693/is-it-possible-to-register-a-httpdomain-based-url-scheme-for-iphone-apps-like/1109200#1109200)

希望这可以帮助 ！

# python - Django 使用 select_related 进行注释

> ID：10957354
> 
> 赞同：3
> 
> 时间：2012-06-09T00:08:44.613
> 
> 标签：python, django

我的应用程序中有一个名为“Orders”的模型，它与另一个名为“Clients”的模型有外键关系，该字段称为“client”。

我正在尝试做一个注释查询来总结数据库中的一个字段，以确定哪个客户购买的最多，同时还包括“客户”表中的相关数据。到目前为止，这是我想出的：

```
top_clients = Order.objects.values('client_id').annotate(total_business=Sum('grand_total')).order_by('-total_business').select_related('client') 
```

在我的模板中，我可以轻松访问“total_business”变量，但由于某种原因我无法访问相关的“客户”数据。这是我在模板中的循环；

```
 {% for c in top_clients %}
    <li>{{ c.total_business|currency }} {{ c.client.company_name }}</li>
    {% endfor %} 
```

知道为什么我无法访问相关数据吗？还是有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T07:19:28.923

您正在查询`top_clients`，因此最好以 w/ 开始`Client`：

```
top_clients = Client.objects.annotate(total_business=Sum('order__grand_total')).order_by('-total_business') 
```

然后在模板中

```
{% for c in top_clients %}
<li>{{ c.total_business|currency }} {{ c.company_name }}</li>
{% endfor %} 
```

# php - 我们如何使用 PHP 将 SWF 视频与任何其他类型的视频合并？

> ID：10957358
> 
> 赞同：-3
> 
> 时间：2012-06-09T00:09:44.630
> 
> 标签：php, video, flash

我想使用 PHP 将任何类型的视频合并到 .SWF 视频中。合并两个文件后，它应该创建第三个文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T01:20:53.260

这是一个简单的例子：

**加入两个视频文件：**

```
ffmpeg -i input1.avi -same_quant intermediate1.mpg
ffmpeg -i input2.avi -same_quant intermediate2.mpg
cat intermediate1.mpg intermediate2.mpg > intermediate_all.mpg
ffmpeg -i intermediate_all.mpg -same_quant output.swf 
```

在此处查看相关[链接](http://ffmpeg.org/faq.html#How-can-I-join-video-files_003f)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T01:18:55.480

我认为这会让你开始 [https://stackoverflow.com/questions/3992925/how-to-convert-a-video-to-swf](https://stackoverflow.com/questions/3992925/how-to-convert-a-video-to-swf)

并不是 php 不能完成这项工作，只是它会很慢，而且您可能不得不自己编写它。可能有一些利用（如 FFMPEG、vlc）可以完成这项工作，但它们最有可能是用 C/C++ 编写的。要使用它们，您可能需要运行更长的 perl 脚本来调用它们，然后更新数据库以让您知道工作已完成。

# geometry - 包含所有线交点的最小矩形

> ID：10957359
> 
> 赞同：3
> 
> 时间：2012-06-09T00:09:49.593
> 
> 标签：geometry, lines

我正在尝试找到一种算法，该算法将找到一组线的所有交点，并在 O(n log n) 时间内计算包含所有交点的最小矩形。到目前为止，我猜测它与对偶性和凸包有关，但我有点坚持它实际上如何帮助我解决这个问题。

如果有人对此有任何想法，请告诉我。谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T09:35:56.970

让我们从一个最小限制三角形中三个交点的框 B[0] 开始。

如果找不到三角形，那么我们有以下特殊情况之一，可以单独处理：

1.  所有的线都是平行的。
2.  所有的交叉点都在一条线上。如果除一条之外的所有线都是平行的，则可能会发生这种情况。
3.  所有线相交于一个点。

所以让我们忽略这些情况作为细节并假设可以找到一个三角形并且找到它不会给算法增加太多时间。

第 1 阶段 - 扩大框以包含每条线的一个交叉点：

1.  标记形成初始三角形的三条线。
2.  选择一条未标记的线，并找到与标记线的交点 P。这始终是可能的，因为至少存在三个不相互平行的标记线。
3.  扩大框以包含 P。
4.  从 2 开始重复，直到所有行都被标记，即它们都在框中至少有一个交点。

调用结果框 B[0]。

第 2 阶段 - 检测线是否在框外有交叉点：

这是关键的观察：对于在盒子内相交的两条线 A 和 B，顺时针绕盒子走，我们会遇到交替的线：例如 ABA B。对于在盒子外相交的两条线，顺时针走不交替：例如 ABB A. 当然也有可能是线在box边界上相交，或者是并发的，但是在描述了主要算法之后会作为一个细节来处理。

1.  选择线条的方向：如果线条不水平，让线条指向 +y 方向，让水平线条指向 +x 方向。线作为箭头的一件事，然后箭头都被选择为尽可能多地指向，或者如果它们是水平的，则指向右侧。有了这个方向，每条线都有一个进入盒子的点（定向线指向盒子的地方，还有一个出口点。这些可能是同一个点。
2.  通过绕边界顺时针方向走 EXITING 交叉点，从右上角开始，创建线路的“退出序列”。
3.  通过从框的右上角开始顺时针走 ENTERING 交叉点来创建线条的“输入序列”。
4.  如果所有交点都在盒子内部，则进入和退出序列将相互循环，B[i] 是交点的最小边界框。
5.  否则，将两个序列对齐到任意元素（通过循环旋转）。
6.  在序列中找到它们首先不同的元素。这两条线必须在框外有一个交点 P，因此通过增加 B[i] 以包含 P 来形成 B[i+1]。
7.  从 2 开始重复。

这并不完整，因为如果组线在边界上有一个共同的进入点或退出点，则进入和退出序列没有明确定义。对于具有公共入口或出口点的每组线 L，请使用稍大的框来订购 L。

请注意，此算法不会发出所有的交叉点，但它确实保证（我希望）盒子包含所有交叉点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:43:51.177

在 O(n log n) 时间内？哇。我没想到这是可能的。

我在这里没有看到任何其他答案，所以这里有一个想法——诚然，在黑暗中开枪。你可以随心所欲。

想法：首先按方位或坡度对线条进行排序。在其他条件相同的情况下，几乎平行的线似乎很可能在偏远点相交；当然，您感兴趣的是外围点。

您的凸包想法听起来应该是正确的，但考虑到凸包可能具有几乎平行的边，其切线或延伸与感兴趣的区域相交很远。总而言之，这听起来像是一项主要的编程工作。祝你好运。

# java - 即使 PNG 文件没有 alpha 通道，如何将它们加载为 ARGB_8888？

> ID：10957365
> 
> 赞同：2
> 
> 时间：2012-06-09T00:10:47.087
> 
> 标签：java, android, bitmap, format, alpha

我有以下代码来加载 png 文件：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inPreferredConfig = Bitmap.Config.ARGB_8888;
options.inDither = false;
map =  BitmapFactory.decodeResource(getResources(), mapid, options); 
```

不幸的是，如果图像没有 alpha 通道，它会将图像加载为 RGB_565。我怎样才能防止这种情况，并且每次都不变地加载它们（没有抖动、没有转换或其他任何东西）？

如果这是不可能的，那么是否有另一种方法可以在没有 BitmapFactory 的情况下将 PNG 文件加载为 ARGB_8888 ？

或者是否可以使用另一种格式来代替也支持 Alpha 通道并始终提供 ARGB_8888 位图的 PNG？

PS：我使用的是安卓 2.3.4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:15:39.487

我有个主意。

1.  尝试在没有 PreferredConfig 的情况下加载 PNG 位图。
2.  获取图像像素。
3.  使用您想要的首选配置 (ARGB_8888) 创建一个新位图。
4.  在新位图中设置 PNG 位图的像素。

我认为它应该运行。

# php - 我需要对每个 API 请求进行身份验证吗？

> ID：10957366
> 
> 赞同：1
> 
> 时间：2012-06-09T00:10:59.967
> 
> 标签：php, api, authentication, twitter, oauth

这似乎是一个简单的问题，但我在任何地方都找不到简单的解释。我确定我只是在寻找错误的东西，所以请多多包涵……

如果我使用[Twitter REST API](https://dev.twitter.com/docs/api)（例如）并使用 OAuth 对用户进行身份验证，在初始身份验证后发送 API 请求时，如何向 Twitter 验证我是否拥有适当的凭据？每次我想与 API 通信时，我是否应该提交 AuthToken（通过`GET`/变量）？`POST`看起来很简单，但 Twitter API 中没有针对这些方法的“可选”身份验证参数。

## 更新：

因为我使用 PHP 来访问 Twitter API，所以我偶然发现了这段代码：

```
$connection = getConnectionWithAccessToken("abcdefg", "hijklmnop");
$content = $connection->get("statuses/home_timeline"); 
```

这是否意味着您每次想要访问 API 时都只需进行身份验证？

例如：

```
In index.php:
    1\. authenticate
    2\. access desired API methods
    3\. Finish loading page

User navigates to page2.php

In page2.php:
    1\. authenticate...again
    2\. access desired API methods...again
    3\. Finish loading page

User navigates to page3.php

In page3.php:
    1\. authenticate...again!
    2\. access desired API methods...again
    3\. Finish loading page 
```

像这样每次都进行身份验证似乎令人沮丧，但似乎有必要。以上是否解释了 OAuth 的要点（更重要的是，一般的身份验证）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T14:04:00.180

OAuth 协议使用`access_token`类似于 Session ID，当您的用户已经授权到您的站点时，您可以使用`access_token`该 API 服务器为您提供访问他们的 API。

因此，从技术上讲，您并没有对每个请求进行身份验证，Twitter 仅使用“SessionID”来识别您的进一步请求。

# css - CSS3以第一个X元素的第一个文本字母为目标？

> ID：10957367
> 
> 赞同：0
> 
> 时间：2012-06-09T00:11:15.533
> 
> 标签：css, css-selectors

我目前正在使用这个选择器：

```
.entry > p:first-of-type:first-letter {
} 
```

为 .entry 下的第一个 P 元素的第一个字母做一个首字母下沉。

它在[这个页面](http://www.mossoreviews.com/8-amazon-kindle-fire-review/)上工作正常，但不是[这个](http://www.mossoreviews.com/16-asus-a53z-as61-15-6-inch-laptop-review/)。后者的问题可能是因为有一个 <a> 元素处理第一个 P 元素内的所有文本内容。

所以我的问题是如何解决这个问题？如何定位第一个 X 元素的第一个**文本**字母而不仅仅是第一个字母？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:58:25.667

您的第二页的问题是，第一页`<p>`只有一张图片。您的文本直到第二个才开始`<p>`。

如果您删除`<p>`图像周围的文字，那么文本“At $499..”将出现在第一个`<p>`，字母“A”将与您拥有的 CSS 选择器匹配。

# php - OOP 方法链可选返回

> ID：10957371
> 
> 赞同：3
> 
> 时间：2012-06-09T00:11:32.523
> 
> 标签：php, oop, inheritance, chaining

在这一点上，假设我有一个这样的课程：

```
class Sentence {
  __construct($content) {
    $this->content = $content;
  }
  public function grab_word($num) {
    $words = explode(" ", $this->content);
    return $words[$num+1];
  }
} 
```

所以给定的接口允许我创建一个`new Sentence`，然后我可以调用`grab_word()`类方法来获取句子中的一个单词：

```
$sentence = new Sentence("Lorem ipsum dolor sit amet");
echo $sentence->grab_word(2); 
```

但是，我想做的是添加另一个链式类方法，让我能够将这个词大写。

```
$sentence->grab_word(2); # -> ipsum
$sentence->grab_word(2)->caps(); # -> IPSUM 
```

显然，这是行不通的，因为链式方法需要对象继承。如果我要创建并链接该函数 - 由于返回不是继承的对象 `caps()`，它将返回一个错误。`Sentence`

总而言之，我的问题是如何实现可选地链接这些方法的能力，但在需要时仍返回非对象（如在我的输出示例中）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T00:26:04.687

```
class Sentence {
  function __construct($content) {
    $this->content = $content;
  }
  public function grab_word($num) {
    $words = explode(" ", $this->content);
    return new Sentence($words[$num+1]);
  }
  public function caps() {
    return new Sentence(strtoupper($this->content));
  }
  function __toString(){
      return $this->content;
  }
} 
```

但是，具有 __toString 方法的对象与字符串并不完全兼容。它仍然是一个对象，但是，当在字符串上下文中显式使用时，它将转换为字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T00:22:22.147

从广义上讲，您要问的是不可能的。为什么不总是返回有时需要链接方法调用的对象？只要回来`new Word($words[ ... ])`，你就会处于一个更好的位置。

现在，当我说“广义上”时，您可以做一些事情来调用不同的方法，这些方法可能存在于不同的类中。您可以使用`__call()`来实现类似于 ruby​​ 的 mixin 的东西，尽管确实很差。 `__call()`将只查看被调用的方法名称，然后迭代可能的目标列表并查看它们是否响应该方法，然后将调用委托给该对象（或引发异常）。

PS：这个问题与继承无关。方法链接需要返回一个对象，而不仅仅是实现继承层次结构。当然，你可以 return `$this`，这是有道理的，但通常你会返回另一个对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T00:36:21.007

在某些将 String 视为对象的语言中，您想要做的事情是相当合乎逻辑的。PHP 受到 Perl 和 C 的启发，并且在设计上“字符串”不是对象。

您可以使其成为将其封装到类中的对象：

```
class Word {
    private $content;
    function __construct($content){
        $this->content=$content;
    }
    function __toString(){
        return $this->content;
    }
    function caps(){
        strtoupper($this->content);
        return $this;
    }
}

class Sentence {
    function grab_word($num)
        $words = explode(" ", $this->content);
        return new Word($words[$num+1]);
    }
} 
```

您还应该查看@chris 的答案，因为它为您提供了略有不同的实现。我建议您不要在没有显式克隆的情况下创建新的对象实例，因为这会浪费资源，而且 PHP 的设计侧重于服务器的快速准确响应。

# java - 尝试在 Java 中实现 Iterable 时使用泛型时出错

> ID：10957374
> 
> 赞同：0
> 
> 时间：2012-06-09T00:11:53.383
> 
> 标签：java, generics, iterator, iterable

谁能解释我为什么会收到这个错误？

这是我使用双向链表实现的堆栈类：

```
import java.util.Iterator;

public class Stack<Item> implements Iterable<Item>{

private Node first;
private int N;

private class Node{
    private Node next;
    private Node prev;
    private Item item;
}

public Iterator<Item> iterator(){
    return new ReverseIterator<Item>();
}    

private class ReverseIterator<Item> implements Iterator<Item>{
    private Node x;

    private ReverseIterator(){
        if (first != null)
           x = first.prev;
    }

    public boolean hasNext(){
        return x != null;
    }

    public Item next(){
        Item i = x.item;
        x = x.prev;
        return i;
    }

    public void remove(){
    }
}

public void push(Item i){
    if (isEmpty()){
        first = new Node();
        first.item = i;
        first.next = first;
        first.prev = first;
    }
    else{
        Node x = new Node();
        x.item = i;
        x.next = first;
        x.prev = first.prev;
        first.prev.next = x;
        first.prev = x;
    }
    N++;
}

public Item pop(){
    assert !isEmpty() : "Stack is empty";

    Item i = first.prev.item;
    if (N == 1)
        first = null;
    else{
        first.prev.prev.next = first;
        first.prev = first.prev.prev;
    }

    N--;    
    return i;
}

public boolean isEmpty(){
    return N == 0;
}

public int size(){
    return N;
}

public static void main(String[] args){

}
} 
```

`Item i = x.item;`编译器说，预期的项目，找到的项目中存在错误。解决方案是替换`ReverseIterator<Item>`为`ReverseIterator`. 有人可以解释为什么我通过添加得到错误`<Item>`吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T00:26:15.280

仅仅因为您为类型变量 ( `Item`) 使用了相同的名称，并不意味着它代表相同的泛型类型。

如果`N<T>`在泛型类中声明嵌套类`C<T>`，则`T`from`C<T>`有效地隐藏在`N<T>`. `x`这与在该类中声明一个名为的类级别字段和声明一个方法参数的原理完全相同，也称为`x`. 你最里面的声明范围从外面隐藏了任何东西。

如果`ReverseIterator`是*静态*嵌套类，则必须在`<Item>`其声明中添加 ，因为它的实例不会有`Stack<Item>`. 即使在这种情况下不会有任何隐藏，也会导致同样的错误。实际上，您还需要添加类型变量`Node`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:29:41.703

你的问题在这里：

```
private class ReverseIterator<Item> implements Iterator<Item>{ 
```

在这里，您定义了一个处理对象类型的内部类，`Item`但这种类型`Item`与封闭`Stack`类的类型不同。结果，当您执行`Item i = x.item;` `x.item`is of type `Stack.Item`(sort of) while `i`is of type时`Stack.ReverseIterator.Item`。

您有两种选择，一种是按照您的做法做，让内部类使用与`Item`外部相同的类型，或者您可以让内部类使用`static`自己的内部`Item`类型（尽管在这种情况下，我建议使用不同的名称对于内部类型，否则您会再次感到困惑）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T00:28:55.950

试试这样：

```
import java.util.Iterator;

public class Stack<Item> implements Iterable<Item> {

    private Node first;
    private int N;

    private class Node {
        private Node next;
        private Node prev;
        private Item item;
    }

    @Override
    public Iterator<Item> iterator() {
        return new ReverseIterator();
    }

    private class ReverseIterator implements Iterator<Item> {
        private Node x;

        private ReverseIterator() {
            if (first != null) {
                x = first.prev;
            }
        }

        public boolean hasNext() {
            return x != null;
        }

        public Item next() {
            Item i = x.item;
            x = x.prev;
            return i;
        }

        public void remove() {
        }
    }

    public void push(final Item i) {
        if (isEmpty()) {
            first = new Node();
            first.item = i;
            first.next = first;
            first.prev = first;
        } else {
            Node x = new Node();
            x.item = i;
            x.next = first;
            x.prev = first.prev;
            first.prev.next = x;
            first.prev = x;
        }
        N++;
    }

    public Item pop() {
        assert !isEmpty() : "Stack is empty";

        Item i = first.prev.item;
        if (N == 1) {
            first = null;
        } else {
            first.prev.prev.next = first;
            first.prev = first.prev.prev;
        }

        N--;
        return i;
    }

    public boolean isEmpty() {
        return N == 0;
    }

    public int size() {
        return N;
    }

    public static void main(final String[] args) {

    }
} 
```

# svn - 如何在 VisualSVN 挂钩中获取更多相关信息？

> ID：10957375
> 
> 赞同：1
> 
> 时间：2012-06-09T00:12:32.087
> 
> 标签：svn, visualsvn, visualsvn-server, svn-hooks

Subversion（在我的情况下为 VisualSVN）允许您在不同时间启动脚本，例如提交前、提交后等。我想在提交发生时发送包含以下信息的电子邮件通知：

*   提交的SVN用户
*   用户输入的评论
*   承诺的 repo 的名称
*   修改文件列表
*   交易编号

不幸的是，这些钩子似乎只提供了其中的一些信息。该`post-commit`挂钩仅提供 repo 名称和事务 ID。具有`start-commit`用户和存储库名称，但没有事务 ID。而且我找不到任何提供提交消息或修改文件列表的钩子。

有没有办法让这些信息可供钩子使用？如果没有，还有其他方法可以在提交时邮寄这些信息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T06:14:35.430

您可以使用`svnlook`命令获取有关修订的信息：http: [//www.visualsvn.com/support/svnbook/ref/svnlook/](http://www.visualsvn.com/support/svnbook/ref/svnlook/)

或者，您可以在 VisualSVNServerHooks.exe 中使用 VisualSVN Server 内置的电子邮件通知命令。只需向您添加以下命令`post-commit hook`：

```
"%VISUALSVN_SERVER%\bin\VisualSVNServerHooks.exe" ^
     commit-notification "%1" -r %2 ^
     --from noreply@example.com --to svn-commits@example.com ^
     --smtp-server smtp.example.com 
```

您可以在 KB18 中找到更多信息：http: [//www.visualsvn.com/support/topic/00018/](http://www.visualsvn.com/support/topic/00018/)

# image - 命令行视频/图像淡入淡出

> ID：10957380
> 
> 赞同：2
> 
> 时间：2012-06-09T00:13:06.023
> 
> 标签：image, video, command-line, ffmpeg, mencoder

我有一个`test.avi` using`ffmpeg`或`mencoder`其他命令行实用程序，我想把`splash.png`它放在视频的开头，淡出，显示 test.avi，然后在 test.avi 的结尾，淡入淡出 splash.png。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T07:08:17.037

我会尝试将图像转换为视频[-f image2](http://ffmpeg.org/ffmpeg.html#image2-2)，然后使用[淡入/淡出效果](http://ffmpeg.org/ffmpeg.html#fade)

# objective-c - MKMapKit regionDidChangeAnimated 在点击自定义标注后停止

> ID：10957384
> 
> 赞同：6
> 
> 时间：2012-06-09T00:13:47.813
> 
> 标签：objective-c, ios, mkannotationview, mapkit

我正在使用此处解释的代码（Jacob 的代码）实现自定义 MKAnnotationView 标注，它实际上在选择注释时放置了另一个自定义 AnnotationView：

[MKAnnotationView - 锁定自定义注释视图以固定位置更新](https://stackoverflow.com/questions/6392931/mkannotationview-lock-custom-annotation-view-to-pin-on-location-updates/7363862)

一切正常，但我有一些奇怪的行为。在点击自定义标注后，它将关闭标注，但 regionDidChangeAnimated 委托方法在之后完全停止被调用。

我错过了什么？我可以像往常一样平移地图，但它不会调用该委托方法。尽管如果 a 进行放大或缩小，它确实会被调用。

在为我放置的 AnnotationView 添加自定义 CallOut 之前，这从未发生过。

提前谢谢。

问候，艾伦//

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T10:38:59.263

我从您提到的链接下载了 XCode 项目，并且能够重现该错误。以下答案有一个对我有用的解决方法

[MKMapView 没有在 Pan 上调用 regionDidChangeAnimated](https://stackoverflow.com/questions/9120961/mkmapview-not-calling-regiondidchangeanimated-on-pan)

为方便起见，我想重复解决方案以及我如何在上述项目中应用它

在`CustomCalloutViewController.h`添加`UIGestureRecognizerDelegate`

```
@interface CustomCalloutViewController : UIViewController 
<MKMapViewDelegate, UIGestureRecognizerDelegate> 
```

在`CustomCalloutViewController.m`方法中`viewDidLoad`添加之前`[super viewDidLoad];`

```
if (NSFoundationVersionNumber >= 678.58){

    UIPinchGestureRecognizer *pinch = [[UIPinchGestureRecognizer alloc] initWithTarget:self action:@selector(pinchGestureCaptured:)];
    pinch.delegate = self;          
    [mapView addGestureRecognizer:pinch];

    [pinch release];

    UIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panGestureCaptured:)];
    pan.delegate = self;
    [mapView addGestureRecognizer:pan];

    [pan release];
} 
```

然后仍然在`CustomCalloutViewController.m`添加以下

```
#pragma mark -
#pragma mark Gesture Recognizers

- (void)pinchGestureCaptured:(UIPinchGestureRecognizer*)gesture{
    if(UIGestureRecognizerStateEnded == gesture.state){
        ///////////////////[self doWhatYouWouldDoInRegionDidChangeAnimated];
    }
}

- (void)panGestureCaptured:(UIPanGestureRecognizer*)gesture{
    if(UIGestureRecognizerStateEnded == gesture.state){

        NSLog(@"panGestureCaptured ended");
        // *************** Here it is *********************
        ///////////////////[self doWhatYouWouldDoInRegionDidChangeAnimated];
        // *************** Here it is *********************
    }
}

-(BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer{
    return YES;
}

-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:   (UITouch *)touch{
    return YES;
} 
```

编辑：我在[这里](https://devforums.apple.com/message/525411#525411)找到了另一种解决方法（在底部也提到了上述解决方法）。我没有尝试，但听起来很有希望。我在这里重复一遍：

> 我的解决方法很简单：在您的视图控制器中，在 viewDidAppear: 中创建 MKMapView，并在 viewDidDisappear: 中销毁它。我意识到这对于那些使用 Interface Builder 的人来说不是一个友好的解决方法，但是，在我看来，它是最干净的，并且可能是在你的应用程序中节省内存的最好方法。

# php - php不要添加已经存在的url参数

> ID：10957385
> 
> 赞同：4
> 
> 时间：2012-06-09T00:13:53.990
> 
> 标签：php, url

在 php 中，我添加了一个额外的 URL 段`?sort`以按升序或降序对帖子进行排序。

```
 <?php
    //get current URL
    $url = "http://" . $_SERVER['HTTP_HOST']  . $_SERVER['REQUEST_URI'];

    //filter URL and create sorting links
    if(filter_var($url, FILTER_VALIDATE_URL))
    { ?>         
      <a href="<?php echo $url; ?>?sort=asc">Small</a>
      <a href="<?php echo $url; ?>?sort=desc">Large</a>
    <?php } ?> 
```

问题：每次我单击链接时，URL 段都会在 URL 中重复。

例子：`http://mysite.com/another_segment/?sort=asc?sort=asc?sort=asc`

为了禁止重复，当我单击两个排序链接之一时，如何替换 URL 段？我不需要用`&`符号分隔参数。我期待只有一个分隔符。我在分页脚本中使用它，因此当我浏览页面时参数需要保留在 URL 中。

我也在尝试避免使用 javascript

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:28:33.950

您应该使用以下函数删除现有 URL 中的“排序”键，然后追加。

```
function remove_querystring_var($url, $key) { 
  $url = preg_replace('/(.*)(?|&)' . $key . '=[^&]+?(&)(.*)/i', '$1$2$4', $url . '&'); 
  $url = substr($url, 0, -1); 
  return $url; 
} 
```

你的代码应该这样修改

```
 <?php
    //get current URL
    $url = "http://" . $_SERVER['HTTP_HOST']  . $_SERVER['REQUEST_URI'];
     $url = remove_querystring_var($url, "sort");
    //filter URL and create sorting links
    if(filter_var($url, FILTER_VALIDATE_URL))
    { ?>         
      <a href="<?php echo $url; ?>?sort=asc">Small</a>
      <a href="<?php echo $url; ?>?sort=desc">Large</a>
    <?php } ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T01:11:57.020

从附加的查询字符串中剥离`$url`并重建。`$_GET``&`

```
$url = 'http://'.$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];

// Strip the query string from URL
list($url,) = explode('?', $url);

// Remove 'sort' from querystring if exist
if (isset($_GET['sort']))
    unset($_GET['sort']);

// Rebuild query string, append with '&'
$url .= '?'. http_build_query($_GET).(count($_GET) ? '&' : '');

if (filter_var($url, FILTER_VALIDATE_URL))
{ ?>         
    <a href="<?php echo $url; ?>sort=asc">Small</a>
    <a href="<?php echo $url; ?>sort=desc">Large</a>
<?php } ?> 
```

这样，您可以拥有带有查询字符串参数的 URL，但只有一个`sort=asc|desc`：

```
http://example.com/some/path?page=1&last=1500&sort=asc
http://example.com/some/path?page=1&last=1500&sort=desc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T00:21:57.877

要从 中剥离查询字符串`$_SERVER['REQUEST_URI']`，请使用`$URI = strstr($_SERVER['REQUEST_URI'], "?", true);`.

[参考：php.net](http://php.net/manual/en/function.strstr.php)；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T00:51:55.110

```
<?php

$get_asc = $get_desc = $_GET;
$get_asc['sort'] = 'asc';
$get_desc['sort'] = 'desc';

if(filter_var($url, FILTER_VALIDATE_URL)) { ?> 
    <a href="<?php echo $url . '?' . http_build_query($get_asc); ?>">Small</a>
    <a href="<?php echo $url . '?' . http_build_query($get_desc); ?>">Large</a>
<?php } ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T00:20:30.993

尝试使用`$_SERVER['SCRIPT_NAME']`而不是`REQUEST_URI`.

# android - 实时表盘旋转动画？

> ID：10957387
> 
> 赞同：0
> 
> 时间：2012-06-09T00:14:07.580
> 
> 标签：android, xml, animation

如何创建一个在触摸和拖动时会旋转的转盘/滚轮？我看过很多关于单击事件动画的教程和帖子，即在单击时旋转一个圆圈。我需要一个拨盘/滚轮/圆圈，当我用手指拨盘时它会旋转。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:56:55.450

本[教程](http://mobile.tutsplus.com/tutorials/android/android-sdk-creating-a-rotating-dialer/)将逐步指导您如何构建旋转拨号器。

# python - 在 QListWidget 中上下移动项目？

> ID：10957392
> 
> 赞同：5
> 
> 时间：2012-06-09T00:14:58.560
> 
> 标签：python, qt4, pyqt4, qlistwidget

在 QListWidget 我有一组条目。现在我想允许用户通过两个按钮（向上/向下）对这些条目进行排序（重新排序）。

这是我的代码的一部分：

```
def __init__(self):
    QtGui.QMainWindow.__init__(self)

    self.ventana = Ui_MainWindow()
    self.ventana.setupUi(self)

    self.connect(self.ventana.btExit, QtCore.SIGNAL('clicked()'), QtCore.SLOT('close()'))

    self.connect(self.ventana.btAdd, QtCore.SIGNAL('clicked()'), self.addButton)
    self.connect(self.ventana.btQuit, QtCore.SIGNAL('clicked()'), self.quitButton)
    self.connect(self.ventana.btQuitAll, QtCore.SIGNAL('clicked()'), self.quitAllButton)
    self.connect(self.ventana.btUp, QtCore.SIGNAL('clicked()'), self.upButton)
    self.connect(self.ventana.btDown, QtCore.SIGNAL('clicked()'), self.downButton)

def addButton(self):
    fileNames = QtGui.QFileDialog.getOpenFileNames(self, 'Agregar archivos')
    self.ventana.listWidget.addItems(fileNames)

def quitButton(self):
    item = self.ventana.listWidget.takeItem(self.ventana.listWidget.currentRow())
    item = None

def quitAllButton(self):
    self.ventana.listWidget.clear()

def upButton(self):
   # HOW TO MOVE ITEM 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T20:17:44.423

好吧，在以不同的方式尝试之后，通过获取所选条目并将其插入新位置来解决此问题。

对于向上按钮是这样的：

```
 currentRow = self.ventana.listWidget.currentRow()
    currentItem = self.ventana.listWidget.takeItem(currentRow)
    self.ventana.listWidget.insertItem(currentRow - 1, currentItem) 
```

对于向下按钮，它是相同的，除了在第三行中的“-”符号被“+”更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2022-01-20T08:11:00.990

# 更好的方法

我知道你得到了答案。但这里有一个小建议，或者你可以说你的项目有进步。

```
listwidget.setDragDropMode(QAbstractItemView.InternalMove)
listwidget.model().rowsMoved.connect(lambda: anyfunction()) 
```

1.  此代码的第 1 行将允许您将项目拖动到任何位置并在几秒钟内更改它。
2.  此代码的第 2 行将允许在您完成拖放后触发一个函数。

# sql - 在不带 + 符号的 PL/SQL 中增加日期/日期

> ID：10957396
> 
> 赞同：2
> 
> 时间：2012-06-09T00:15:47.030
> 
> 标签：sql, plsql, oracle11g

有没有办法在没有 + 号的情况下增加天数？

代替

```
to_date('06/07/2012 08:00:00','mm/dd/yyyy hh24:mi:ss')+1 
```

让它增加一天或更长时间的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:58:46.020

保留用于将日期添加到日期的 Oracle PL/SQL 语法，并使用[URLEncode](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)对字符串进行编码，该字符串将对查询字符串中参数中的加号进行编码。

另请参阅[https://forums.oracle.com/forums/thread.jspa?threadID=740265&tstart=60](https://forums.oracle.com/forums/thread.jspa?threadID=740265&tstart=60)

但是，我们必须注意，这里存在 SQL 注入攻击的风险，即使它是内部 Web 应用程序，也最好避免这种攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T14:03:26.960

我知道这已经得到解答，但是避免 SQL 注入的最佳做法是使用绑定变量。因此，如果您有一个 pl/sql 过程，比方说（注意：绑定变量几乎可以在 Java、C、C# 每种语言中使用），那么您将如何使用绑定变量来完全避免 SQL 注入。

```
create or replace function increment_day(date_string_in varchar2)
return date
is

begin
   return to_date(date_string_in,'mm/dd/yyyy hh24:mi:ss')+1;

end; 
```

# png - 如何在我的游戏中制作非矩形图像？

> ID：10957397
> 
> 赞同：1
> 
> 时间：2012-06-09T00:16:07.297
> 
> 标签：png, sprite, allegro, allegro5

不要问问题，但基本上我的游戏有很多鼠标光标追逐玩家的光标。

我有一个黑色背景的小光标图像，我一直在使用它，但问题是它根本不是光标的形状。有微小的角落，当多个光标重叠时，它们会被.png背景的黑色部分部分隐藏。

如何剪切光标图像并具有实际的光标形状，从而实现更准确的视觉重叠和更准确的碰撞？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:24:20.853

使用一个好的图像编辑器（GIMP 可以）并将背景设置为透明。透明度是旧 Compuserve GIF 继承的功能之一。图像仍然是方形/矩形，但您的用户不会“看到”透明像素。

# java - List Array Shuffle 还是把我的头撞到墙上？

> ID：10957403
> 
> 赞同：1
> 
> 时间：2012-06-09T00:17:42.633
> 
> 标签：java, android, arrays, list

我正在尝试将数字列表从 1-15 随机排列。然后取前 5 个数字并将索引 1 分配给第一个 btn 的文本 第二个数字的文本分配给第二个 btn 等的文本......问题是我几乎尝试了我在 Stackoverflow 中读到的所有内容，但没有任何帮助. 请帮忙。

```
 public class MainActivity extends Activity implements  OnClickListener,  
CountdownTimerFinishedListener{
/** Called when the activity is first created. */
//SET UP SPINS

 private TextView spins;    
 private Button spin;
 private Button s_1;
 private Button s_2;
 private Button s_3;
 private Button s_4;
 private Button s_5;

  private static final Random rand = new Random();

int totalspins = 15;
int gamescore = 0;
int s1 = 0;
int s2 = 0;
int s3 = 0;
int s4 = 0;
int s5 = 0;
int[] b_list ={1,2,3,4,5,6,7,8,9,10,12,13,14,15};

     @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
    WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.play_layout);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

    gamescore=(0);
    score = (TextView) findViewById(R.id.score);
    score.setText(String.valueOf("SCORE: "+ gamescore));
    totalspins = (15);
    spins = (TextView) findViewById(R.id.spins);
    spins.setText(String.valueOf("SPINS: "+ totalspins));
    spin = (Button) findViewById(R.id.spin);
    s_1 = (Button) findViewById(R.id.spin_1);
    s_2 = (Button) findViewById(R.id.spin_2);
    s_3 = (Button) findViewById(R.id.spin_3);
    s_4 = (Button) findViewById(R.id.spin_4);
    s_5 = (Button) findViewById(R.id.spin_5);
    b_1 = (Button) findViewById(R.id.btn_1);
    b_2 = (Button) findViewById(R.id.btn_2);
    b_3 = (Button) findViewById(R.id.btn_3);
    b_4 = (Button) findViewById(R.id.btn_4);
    b_5 = (Button) findViewById(R.id.btn_5);

    //int randIntb1 = rand.nextInt(15)+1;
     b_1.setText(String.valueOf(b_list[0]));//randIntb1
    //int randIntb2 = rand.nextInt(15)+1;
    b_2.setText(String.valueOf(b_list[1]));//randIntb2
    //int randIntb3 = rand.nextInt(15)+1;
    b_3.setText(String.valueOf(b_list[2]));//randIntb3
    //int randIntb4 = rand.nextInt(15)+1;
    b_4.setText(String.valueOf(b_list[3]));//randIntb4
    //int randIntb5 = rand.nextInt(15)+1;
    b_5.setText(String.valueOf(b_list[4]));//randIntb5

     spin.setOnClickListener(new OnClickListener() {
        private Object Button;
        public void onClick(View v) {
            //spin.setEnabled(false);
            int randInts1 = rand.nextInt(17)+1;
            s_1.setText(String.valueOf(randInts1));
            s1=(randInts1);
            int randInts2 = rand.nextInt(17)+15;
            s_2.setText(String.valueOf(randInts2));
            s2=(randInts2);
            int randInts3 = rand.nextInt(17)+30;
            s_3.setText(String.valueOf(randInts3));
            s3=(randInts3);
            int randInts4 = rand.nextInt(17)+45;
            s_4.setText(String.valueOf(randInts4));
            s4=(randInts4);
            int randInts5 = rand.nextInt(17)+60;
            s_5.setText(String.valueOf(randInts5));
            s5=(randInts5);

            totalspins = (totalspins - 1);
            spins.setText(String.valueOf("SPINS: "+ totalspins));
            if(totalspins <= 0){
                totalspins =(15);
            }
            }

    });

    b_1.setOnClickListener(new OnClickListener() {
        private Object Button;
        public void onClick(View v){
            if (b_1.getText() == (s_1.getText())){
                gamescore =(gamescore + s1);
                score.setText(String.valueOf("SCORE: "+ gamescore));
                b_1.setText(String.valueOf(""));
                s_1.setText(String.valueOf(""));
                }
            }
    });
    b_2.setOnClickListener(new OnClickListener() {
        private Object Button;
        public void onClick(View v){
            if (b_2.getText() == (s_1.getText())){
                gamescore =(gamescore + s1);
                score.setText(String.valueOf("SCORE: "+ gamescore));
                b_2.setText(String.valueOf(""));
                s_1.setText(String.valueOf(""));
                }
            }
    });
    b_3.setOnClickListener(new OnClickListener() {
        private Object Button;
        public void onClick(View v){
            if (b_3.getText() == (s_1.getText())){
                gamescore =(gamescore + s1);
                score.setText(String.valueOf("SCORE: "+ gamescore));
                b_3.setText(String.valueOf(""));
                s_1.setText(String.valueOf(""));
                }
            }
    });
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T00:26:07.653

洗牌很容易：

```
ArrayList<Integer> numbers = new ArrayList<Integer>()
for(int i = 1; i <= 15; i++) {
    numbers.add(i);
}

Collections.shuffle(numbers); 
```

然后，当您想让它们成为按钮的文本时，只需执行以下操作：

```
b_1.setText(numbers.get(0).toString());
b_2.setText(numbers.get(1).toString());
b_3.setText(numbers.get(2).toString());
b_4.setText(numbers.get(3).toString());
b_5.setText(numbers.get(4).toString()); 
```

但是，将这些按钮保留在某种数据结构中可能会更好：

```
ArrayList<Button> buttons = new ArrayList<Button>();
//Fill list to your heart's content

Collections.shuffle(numbers);
for(int i = 0; i < buttons.length() && i < numbers.length(); i++) {
    buttons.get(i).setText(numbers.get(i).toString());
} 
```

*为我编辑忘记了 Java 列表使用 get() 而不是 at() 像 C++ 向量*

# coding-style - 装饰器中的 Python 命名约定

> ID：10957409
> 
> 赞同：31
> 
> 时间：2012-06-09T00:19:37.497
> 
> 标签：coding-style, python

Python 装饰器的内部是否有任何“公认的”命名约定？

[样式指南](http://www.python.org/dev/peps/pep-0008/)没有提到它，这个[关于装饰器的很棒的条目](https://stackoverflow.com/questions/739654/understanding-python-decorators)在为返回的最终函数使用“包装”的变体方面非常一致，但是在创建带参数的装饰器时使用的名称呢？

```
def decorator_name(whatevs):
    def inner(function):
        def wrapped(*args, **kwargs):
            # sweet decorator goodness
        return wrapped
    return inner 
```

具体来说，上例中 、 和 的约定`inner`是`function`什么`wrapped`？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-09T00:22:03.113

这些名称没有标准化的约定（例如 PEP）。如果您检查 python 标准库，您会发现这些函数有很多不同的名称。

但是，`decorator`装饰器函数是一个相当常见的名称`inner`。
调用你的`wrapped`函数并用包装函数来`wrapper`装饰它也很常见（这也是它的常用名称）。[`functools.wraps(f)`](http://docs.python.org/library/functools.html#functools.wraps)`f``func`

```
def decorator_name(whatevs):
    def decorator(f):
        @wraps(f)
        def wrapper(*args, **kwargs):
            pass # sweet decorator goodness
        return wrapper
    return decorator 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-25T12:32:10.683

根据定义，Python 中的装饰器可以是函数或类，因此实现类型（类或函数）是决定使用哪种命名约定的因素。一个常见的错误是在函数名称前加上关键字装饰器。有关装饰器的更多信息，请参见[链接](https://www.python.org/dev/peps/pep-0318/)

# video - 使用ffmpeg提取帧的最快方法？

> ID：10957412
> 
> 赞同：178
> 
> 时间：2012-06-09T00:20:26.537
> 
> 标签：video, ffmpeg

嗨，我需要使用 ffmpeg 从视频中提取帧。有没有比这更快的方法：

```
ffmpeg -i file.mpg -r 1/1 $filename%03d.jpg 
```

?

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2012-06-09T15:53:46.240

如果 JPEG 编码步骤的性能过于密集，您始终可以将未压缩的帧存储为 BMP 图像：

```
ffmpeg -i file.mpg -r 1/1 $filename%03d.bmp 
```

这还具有通过转码为 JPEG 进行量化不会导致更多质量损失的优点。（PNG 也是无损的，但编码时间往往比 JPEG 长得多。）

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2015-02-04T12:56:41.013

遇到这个问题，所以这里有一个快速比较。比较这两种从 38 分 7 秒长的视频中每分钟提取一帧的不同方法：

```
time ffmpeg -i input.mp4 -filter:v fps=fps=1/60 ffmpeg_%0d.bmp 
```

1m36.029s

这需要很长时间，因为 ffmpeg 会解析整个视频文件以获取所需的帧。

```
time for i in {0..39} ; do ffmpeg -accurate_seek -ss `echo $i*60.0 | bc` -i input.mp4   -frames:v 1 period_down_$i.bmp ; done 
```

0m4.689s

这大约快 20 倍。我们使用快速搜索到所需的时间索引并提取一帧，然后为每个时间索引调用几次 ffmpeg。请注意，这`-accurate_seek` [是默认设置](https://ffmpeg.org/ffmpeg.html#Main-options) ，并确保`-ss`在输入视频`-i`选项之前添加。

请注意，最好使用`-filter:v -fps=fps=...`而不是后者，`-r`因为[后者可能不准确。](https://trac.ffmpeg.org/wiki/Create%20a%20thumbnail%20image%20every%20X%20seconds%20of%20the%20video)虽然[票被标记为 fixed](https://trac.ffmpeg.org/ticket/1578)，但我还是遇到了一些问题，所以最好谨慎行事。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2021-03-08T03:54:44.663

到目前为止，这比所有其他命令都简单：

```
ffmpeg -i input.mp4 '%04d.png' 
```

更改`04`为保存所有帧所需的位数。确保`0`在数字之前始终有一个，因此输出帧名称是零填充的。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-03-23T22:25:25.977

如果您确切知道要提取哪些帧，例如 1、200、400、600、800、1000，请尝试使用：

```
select='eq(n\,1)+eq(n\,200)+eq(n\,400)+eq(n\,600)+eq(n\,800)+eq(n\,1000)' \
       -vsync vfr -q:v 2 
```

我将它与 Imagemagick 蒙太奇的管道一起使用，以从任何视频中获得 10 帧预览。显然，您需要使用的帧号`ffprobe`

```
ffmpeg -i myVideo.mov -vf \
    select='eq(n\,1)+eq(n\,200)+eq(n\,400)+eq(n\,600)+eq(n\,800)+eq(n\,1000)',scale=320:-1 \
    -vsync vfr -q:v 2 -f image2pipe -vcodec ppm - \
  | montage -tile x1 -geometry "1x1+0+0<" -quality 100 -frame 1 - output.png 
```

.

**小解释：**

1.  在 ffmpeg 中，表达式`+`代表 OR 和`*`AND
2.  `\,`只是逃避`,`角色
3.  没有`-vsync vfr -q:v 2`它似乎不起作用，但我不知道为什么 - 任何人？

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2020-10-08T10:27:52.753

每分钟输出一张图片，命名为 img001.jpg、img002.jpg、img003.jpg 等。%03d 表示每张输出图片的序号将使用 3 位进行格式化。

```
ffmpeg -i myvideo.avi -vf fps=1/60 img%03d.jpg 
```

将 更改为`fps=1/60`每`fps=1/30`30 秒捕获一次图像。同样，如果您想每 5 秒捕获一次图像，则更`fps=1/60`改为`fps=1/5`

来源：[https://trac.ffmpeg.org/wiki/每 X 秒的视频创建一个缩略图](https://trac.ffmpeg.org/wiki/Create%20a%20thumbnail%20image%20every%20X%20seconds%20of%20the%20video)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-01-30T14:28:50.497

我尝试过这个。32 秒内 3600 帧。你的方法真的很慢。你应该试试这个。

```
ffmpeg -i file.mpg -s 240x135 -vf fps=1 %d.jpg 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-07-13T10:32:13.253

这对我有用

`ffmpeg -i file.mp4 -vf fps=1 %d.jpg`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-15T15:10:38.020

就我而言，我至少每秒需要帧。我使用了上面的“寻求”方法，但想知道我是否可以并行化任务。我在这里使用了 N 个进程和 FIFO 方法： [https ://unix.stackexchange.com/questions/103920/parallelize-a-bash-for-loop/216475#216475](https://unix.stackexchange.com/questions/103920/parallelize-a-bash-for-loop/216475#216475)

```
open_sem(){
  mkfifo /tmp/pipe-$$
  exec 3<>/tmp/pipe-$$
  rm /tmp/pipe-$$
  local i=$1
  for((;i>0;i--)); do
    printf %s 000 >&3
  done
}
run_with_lock(){
    local x
    read -u 3 -n 3 x && ((0==x)) || exit $x
    (
    "$@" 
    printf '%.3d' $? >&3
    )&
}
N=16
open_sem $N
time for i in {0..39} ; do run_with_lock ffmpeg -ss `echo $i` -i /tmp/input/GOPR1456.MP4  -frames:v 1 /tmp/output/period_down_$i.jpg  & done 
```

本质上，我用 & 分叉了进程，但将并发线程的数量限制为 N。

就我而言，这将“寻找”方法从 26 秒提高到了 16 秒。唯一的问题是主线程没有干净地退出到终端，因为标准输出被淹没了。

# vb6 - VB6 - 游戏无法运行

> ID：10957420
> 
> 赞同：-1
> 
> 时间：2012-06-09T00:21:47.467
> 
> 标签：vb6

-我是 VB6 的菜鸟，我只需要知道我在代码中做错了什么我希望鼠标单击表单中的图片框，然后根据情况执行代码

这是我的代码：

```
Dim MineTotalHits As Integer
Dim MineTotal As Integer
Dim EmptySquare As Integer
Dim MineTotalMisses As Integer
Dim WinSnd As Boolean
Dim MinesInRow As Integer
Dim ShellCount As Integer
Dim MaxMines As Integer
Dim MinesLeft As Integer

Private Sub Form_Load()
    Snd.Hide
    Start.Show

    Dim Count(1 To 10) As Integer
    Dim RowMines(1 To 10) As Label

    EmptySquare = 50
    MaxMines = 50
    ShellCount = 90
    MinesLeft = 50
    MineTotal = 0
    MineTotalHits = 0
    MineTotalMisses = 0

    Do Until MineTotal = MaxMines
        Randomize (Int(99 * Rnd + 1))
        MineTotal = MineTotal + 1
    Loop      
End Sub

Public Sub WinGame(WinSnd As Boolean)
    Dim IntResponse As Integer

    If MinesLeft = 0 Then
        WinSnd = True
        MsgBox ("You have won the Game")
        IntResponse = MsgBox("Would You like to play a New Game?", vbYesNo Or vbQuestion, "NewGame?")

        If IntResponse = vbYes = 1 Then
            Snd.Show
        ElseIf IntResponse = vbNo = 2 Then
            Unload Me
        End If

    ElseIf ShellCount = 0 Then
        WinSnd = False
        MsgBox ("You have lost the Game")
        IntResponse = MsgBox("Would you Like to play a New Game?", vbYesNo Or vbQuestion, "NewGame?")

        If IntResponse = vbYes = 1 Then
            Snd.Show
        ElseIf IntResponse = vbNo = 2 Then
            Unload Me
        End If
    End If
End Sub

Private Sub Picture1_Click(Index As Integer)
    Dim Picture1(99) As PictureBox
End Sub

Private Sub MouseDown(Button As Integer, Index As Integer, Shift As Integer, X As Single, Y As Single)
    If Button = 1 Then Call MouseDown
        If Picture1(99) = MinesLeft Then
            MsgBox ("You have destroyed a mine")
            MineTotalHits = MineTotalHits + 1
            MinesLeft = MinesLeft - 1
            Picture1(Index).BackColor = vbBlack

        ElseIf Picture1(99) = EmptySquare Then
            MsgBox ("You have missed a mine")
            EmptySquare = EmptySquare - 1
            MineTotalMisses = MineTotalMisses + 1
            Picture1(Index).BackColor = vbRed
        End If
    End If
End Sub

Private Sub MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
    If Picture1().BackColor = vbBlack Or Picture1().BackColor = vbRed Then
        MsgBox ("This Square has already been hit")

    Exit Sub
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T00:50:25.617

在 VB6 中，事件处理程序采用 SourceObject_EventName 的形式。您的 MouseDown 不符合此规定。

# c# - Windows 应用程序中的 Console.Read 是否阻塞

> ID：10957430
> 
> 赞同：3
> 
> 时间：2012-06-09T00:24:06.110
> 
> 标签：c#, .net-4.0

调试时，我不断地从 Windows 应用程序模式切换到控制台模式。如果我的应用程序处于 Windows 模式，Console.Read 和 Console.ReadLine 会等待用户输入吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:44:18.710

在 Windows 应用程序中，`Console.Read`将始终返回 -1，`Console.ReadLine`将返回`null`，`ReadToEnd`将返回`string.Empty`，`Peek`并将返回`-1`；

这是因为`Console`该类将自动安装一个自定义`StreamReader`，`Console.In`因此这些调用避免出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:24:06.657

不，他们不会。他们会表现得好像他们不存在一样。不过需要注意的一点是，*ReadKey*会抛出一个异常，而不是像其他两个一样忽略它。如果您需要检查您是否在控制台中，请查看[此问题](https://stackoverflow.com/questions/10957440)。

# ios - 应用程序的 iTunes 连接创建不会加载

> ID：10957434
> 
> 赞同：1
> 
> 时间：2012-06-09T00:25:52.160
> 
> 标签：ios, app-store-connect

我已经注册了我的 bundle id，现在我正在尝试为我的应用创建排行榜。所以我去 iTunes 连接 - 管理应用程序 - 创建应用程序。我输入了所有信息，然后单击继续。然后页面将无法加载，我的应用程序未创建，并且在大约 5 分钟网关超时后出现以下错误

代理服务器没有收到上游服务器的及时响应。

帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:54:36.357

过去，我在使用 iTunes Connect 时遇到过这个问题。似乎这只是一个糟糕的连接（服务器端），通常会很快自行解决（最多大约 24 小时）。只要继续努力。

# android - Android - 切换到横向视图时将按钮移动到顶部

> ID：10957438
> 
> 赞同：1
> 
> 时间：2012-06-09T00:26:14.227
> 
> 标签：android, orientation, android-relativelayout

我有一个位于屏幕顶部中心的图像和一个 alignParentRight 按钮。并暂时设置为图像下方。我想要的是当它在横向视图时，图像不是那么长，我想将 Button 移动到顶部。有没有办法做到这一点？谢谢

纵向视图

```
 _________________
|[  <--Image-->  ]|
|         [Button]| 
```

横向视图

```
 _________________________________
|     [  <--Image-->  ]           |
|                         [Button]|
|                                 | 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:59:54.527

如果您不想根据屏幕方向切换到使用不同的布局，您可以执行以下操作。

注意屏幕方向。我不确定您的应用目前如何处理它。它是重新启动应用程序（默认行为）还是通过覆盖来阻止它`onConfigChanged`？

无论哪种情况，您都可以使用以下方法获取屏幕方向：

```
WindowManager windowManager =  (WindowManager) getSystemService(WINDOW_SERVICE);
windowManager.getDefaultDisplay().getOrientation(); 
```

现在您知道了屏幕方向，您可以通过编程方式设置按钮的布局。假设您正在使用 ，则`alignParentRight`可以`alignRightOf`相对于使用而不是。`ImageView``RelativeLayout`

以编程方式设置布局（参见[此处](https://stackoverflow.com/questions/4638832/how-to-programmatically-set-the-layout-align-parent-right-attribute-of-a-button)获取源代码）：

```
RelativeLayout.Layoutparams params = (RelativeLayout.LayoutParams)button.getLayoutParams();
params.addRule(RelativeLayout.RIGHT_OF, R.id.id_to_be_left_of);

button.setLayoutParams(params); //causes layout update 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:36:29.413

您应该为横向和纵向模式创建单独的布局。请参阅[此](http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)。

# c# - 如何在内部检测应用程序是在 C# 中处于控制台模式还是 Windows 模式

> ID：10957440
> 
> 赞同：3
> 
> 时间：2012-06-09T00:26:21.197
> 
> 标签：c#, .net-4.0

有没有办法从应用程序本身检查程序是处于控制台模式还是 Windows 模式？我知道 Read 和 ReadLine 可以以某种方式检测到这一点，但是如何呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T00:31:30.180

你应该可以检查一下`Console.In == StreamReader.Null;`

如果这是真的，则没有附加控制台。例如，以下内容适用于此：

```
public static bool IsConsoleApplication
{
    get { return Console.In != StreamReader.Null; }
} 
```

# .net - 用户“NT AUTHORITY\ANONYMOUS LOGON”的 Web 应用程序登录失败

> ID：10957443
> 
> 赞同：22
> 
> 时间：2012-06-09T00:27:17.353
> 
> 标签：.net, iis-6, windows-2003-webserver

我看到很多人都遇到了这个错误，但他们的情况似乎都和我的有点不同。

我有一个在 Windows 2003 服务器上的 IIS 6.0 中运行的 ASP.NET 4.0 Web 应用程序。

当我远程到 Web 服务器框并在那里登录并以**localhost**而不是机器名访问该站点时，Web 应用程序工作正常。但是，当我从另一台客户端计算机访问该网站时，我收到以下错误：

```
Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON' 
```

该网站已启用匿名访问 Windows 身份验证。该网络应用程序包含以下内容：

```
 <authentication mode="Windows">    </authentication>
    <identity impersonate="true"/>

  <connectionStrings>
      <add name="MyConnection" connectionString="Data Source=MyDbServer;Initial Catalog=MyDatabase;Integrated Security=True"
</connectionStrings> 
```

我的 Web 服务器在虚拟服务器上运行。这相关吗？我假设不是。

请注意，如果我在 Impersonation = TRUE 之后在 Web 配置中添加我的域\登录名和密码，则该站点可以正常工作。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-06-15T17:28:58.967

听起来您遇到了所谓的“双跳”问题，即不信任服务器将客户端的凭据传递到另一个框（跃点 1 是 IIS 框的凭据，跃点 2 是从 IIS 框到 SQL Server）。

当您直接登录到服务器时，不需要发生第二个跃点，因为它只是将凭据直接从客户端计算机（本场景中的 IIS 服务器）直接传递到 SQL Server。同样，如果 SQL Server 位于 IIS 框上，您也不会出现此错误，因为客户端只会向可以与 IIS 和 SQL Server 共享凭据的框发出一个请求。

要使委派工作需要执行相当多的步骤，例如信任服务器以进行委派、创建 SPN 并确保为 IIS 用于运行网站的帐户提供其他适当的权限。这里有一篇技术网文章可以帮助您完成许多必需的步骤： [https ://docs.microsoft.com/en-us/archive/blogs/taraj/checklist-for-double-hop-issues-iis -and-sql-server](https://docs.microsoft.com/en-us/archive/blogs/taraj/checklist-for-double-hop-issues-iis-and-sql-server)

**注意：**如果您使用的是 NTLM 而不是 Kerberos（或其他可委托协议），它将无法工作，因为中间服务器（IIS 服务器）需要有一个可以传递的令牌。由于 NTLM 是基于协商的，因此它不会起作用。

**2020 年更新：**如果您开始再次看到此问题弹出，并且它仅影响 Windows 10 用户或 Windows 2016+ 用户，则可能是在您用户的计算机上实施了“Credential Guard”（请参阅​​：[https:// /docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements)）。中断的事情之一是 Kerberos 无约束委派 - 因此，如果您遇到这种情况，您可能需要重新配置中间框（上例中的 IIS 服务器）以使用约束委派而不是无约束委派。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-11T04:14:04.980

这里的问题是你正在使用

```
<authentication mode="Windows">    </authentication> 
```

这需要您的浏览器发送`NTLM`凭据。Firefox 默认不发送。

当您在服务器上并使用 localhost 时，您的浏览器会将您的 Windows 登录凭据发送到服务器。它正在对用户 MyDomain\MyID 进行身份验证并授予访问权限。

ASP.NET 模拟 IIS 传递给它的令牌，该令牌可以是经过身份验证的用户，也可以是匿名 Internet 用户帐户 (IUSR_machinename)。

来自不在该域中的计算机的所有 Web 请求都将在匿名帐户下运行。在你的情况下，`NT AUTHORITY\ANONYMOUS LOGON`

您的连接字符串正在使用 , `Integrated Security=True`。这意味着 asp.net 线程正在处理的 Windows 帐户也必须有权访问数据库。如果要传递用于登录 IIS 的 Windows 凭据，则必须设置`Trusted_Connection=Yes`.

请参阅：[如何：使用 Windows 集成安全性访问 SQL Server](http://msdn.microsoft.com/en-us/library/bsz5788z.aspx)

我建议您查看**表单身份验证**，如果您打算在 Web 上公开此 Web 服务，或者如果您想让与您的服务器域不同的用户可以使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T00:38:34.980

我发现我的问题是在 IIS 中我启用了 Windows 身份验证而不是基本身份验证。切换到基本身份验证后，我就能够访问已登录帐户下的 SQL Server。

> 在 IIS 中，只有基本身份验证使用通过网络流向远程 SQL 服务器的安全令牌登录用户。默认情况下，与身份配置元素设置结合使用的其他 IIS 安全模式不会生成可以向远程 SQL Server 进行身份验证的令牌。

来自：http: [//msdn.microsoft.com/en-us/library/bsz5788z.aspx](http://msdn.microsoft.com/en-us/library/bsz5788z.aspx)

# ruby-on-rails - 使用一组精确的 has_many 查找记录：通过关联 ID

> ID：10957444
> 
> 赞同：1
> 
> 时间：2012-06-09T00:27:34.630
> 
> 标签：ruby-on-rails, associations

我正在尝试在创建新记录之前检查具有完全相同关联的现有 InvitationSearch 记录（以避免有 2 条相同的记录），但我不知道如何执行此操作。

```
class InvitationSearch < ActiveRecord::Base
  has_many :invitations
  has_many :brands, :through => :invitation_search_brands
  has_many :invitation_search_brands
  has_many :categories, :through => :invitation_search_categories
  has_many :invitation_search_categories
  has_many :sizes, :through => :invitation_search_sizes
  has_many :invitation_search_sizes
end

class Invitation < ActiveRecord::Base
  belongs_to :invitation_search
end

class InvitationSearchSize < ActiveRecord::Base
  belongs_to :invitation_search
  belongs_to :size  
end

class InvitationSearchBrand < ActiveRecord::Base
  belongs_to :invitation_search
  belongs_to :brand
end

class InvitationSearchCategory < ActiveRecord::Base
  belongs_to :invitation_search
  belongs_to :category
end 
```

在我的invitation_searches_controller create 方法中，我想在创建新的InvitationSearch 之前检查匹配项。

在我的参数中，我得到了gender、brand_ids、category_ids 和size_ids，我只关心具有确切性别和相同关联ID 集的记录，不多不少。

我知道我可以执行以下操作，但这会返回包含任何这些品牌的所有记录，而不是确切的集合。另外，我需要对每个关联执行操作，这似乎相当乏味。

```
InvitationSearch.includes(:brands).where(:brands => {:id => params[:invitation_search][:brand_ids]}) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:57:13.257

这看起来仍然很糟糕，但它是你想要返回的吗？

```
InvitationSearch.includes(:brands)
  .where(:brands => {:id => params[:invitation_search][:brand_ids]})
  .select { |i_s| i_s.brands.count == params[:invitation_search][:brand_ids].count } 
```

第二次尝试：

```
q = InvitationSearch.includes(:brands)
params[:invitation_search][:brand_ids].each do |brand_id|
  q = q.where(:brand_id => brand_id)
end 
```

仍然在第二次尝试中，如果您使用的是 ruby​​ 1.9.2+，您可以使用更新的 syntax `brad_id: brand_id`。

# cocoa - 我可以在 readFromData 中创建一个 Untitled NSDocument 吗？

> ID：10957445
> 
> 赞同：0
> 
> 时间：2012-06-09T00:27:57.950
> 
> 标签：cocoa, nsdocument

我正在重写我的应用程序，该应用程序读取和绘制由物理模拟程序创建的数据。原始版本读取数据文件但不保存任何类型的文档。我想添加编写包含演示状态和原始数据文件路径的文档文件的功能。因此，用户可以打开原始数据文件（假设它具有扩展名*.xxx*）或我的程序创建的文件（扩展名*.yyy*）。

如果用户打开*xxx*文件，我不希望文档将*xxx*文件视为其在磁盘上的表示。有没有办法`readFromData:ofType:error:`可以测试类型是否为*xxx*并创建一个无标题文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:39:27.510

在应用的文件类型清单中，将原始 .xxx 类型的 CFBundleTypeRole 设置为“Viewer”，将 .yyy 类型的角色设置为“Editor”。这应该让 Cocoa 的文档架构明白它应该以无标题的形式打开 .xxx 并提示另存为 .yyy。

# c# - 暂停和停止线程

> ID：10957447
> 
> 赞同：0
> 
> 时间：2012-06-09T00:28:22.497
> 
> 标签：c#, multithreading, events, backgroundworker, monitor

我有以下代码正在运行，但它很脏。实际上代码很好，除了我添加的部分：暂停和停止按钮。我是 c# 的新手，所以任何帮助都会受到赞赏。

```
 private void pause_button_Click(object sender, EventArgs e)
    {
        start = false; pause = true; stop = false;
        guiUpdate();
        PauseEvent.Reset();
    }

    private void stop_button_Click(object sender, EventArgs e)
    {
        if (pause == true)
        {
            PauseEvent.Set();
            pause = false;
            this.start_button.Click -= new System.EventHandler(this.resume_button_Click);
        }
        start = false; stop = true;
    }

    private int activeThreads = 0;
    private Thread thread;
    private void DoWork(object sender)
    {
        string line = null;
        ereader = new StreamReader(MY_LIST);
        do
        {
            lock (ereader)
            {
                PauseEvent.WaitOne();
                line = ereader.ReadLine();
            }

            //
            //other commands for processing & building the argument
            //

            lock (signal)
            {
                ++activeThreads;
            }

            thread = new Thread(new ParameterizedThreadStart(
                o =>
                {
                    processit((object)o);
                    lock (signal)
                    {
                        --activeThreads;
                        Monitor.Pulse(signal);
                    }
                }));
            thread.Start(argument);

            lock (signal)
            {
                while (activeThreads > maxthreads)
                    Monitor.Wait(signal);
            }

            lock (signal)
            {
                if (!start)
                {
                    showwaiting(true);//shows an animated gif with a "please wait" msg
                    while (activeThreads > 0)
                        Monitor.Wait(signal);
                    showwaiting(false);
                    if (stop == true)
                    {
                        this._BackgroundWorker.CancelAsync();
                        break;
                    }
                }
            }
        }
        while (ereader.Peek() != -1);
        showwaiting(true);
        lock (signal)
        {
            while (activeThreads > 0)
                Monitor.Wait(signal);
        }
        showwaiting(false);
    }

    private void _BackgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        start = false; stop = true;
        guiUpdate();
    } 
```

**我究竟能做些什么来避免循环内外的重复命令？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:53:29.980

问题评论中提到的是有关代码实践更改的建议。

*   在条件中检查布尔变量时不要使用`== true`or 。`== false`（杰夫）
*   使用枚举来表示状态而不是多个布尔变量。

我还要补充：

*   使用正确的 C# 命名约定。对于您的方法，如果有多个单词，请将所有单词大写。（例如，而不是`showwaiting`使用`ShowWaiting`）。

对于您的小循环，您实际上并不需要优化它们，尽管不仅仅是一个简单的循环。因此，您可以将它们与所有相同的代码一起重构为一个单独的方法：

```
private void ShowAndWait()
{
    showwaiting(true);
    lock (signal)
    {
        while (activeThreads > 0)
            Monitor.Wait(signal);
    }
    showwaiting(false);
} 
```

请注意，同一线程可以锁定它之前获得的监视器。这是一个快速操作，因为线程已经拥有锁。然后，您可以从这两个地方调用此方法。

# android - 当我在自定义对话框之外单击时，它被关闭

> ID：10957449
> 
> 赞同：4
> 
> 时间：2012-06-09T00:28:43.670
> 
> 标签：android, dialog

我有一个自定义对话框，当您在对话框外部单击时会关闭，这是我不想要的。拥有`dialog.setCanceledOnTouchOutside(false);`并不能解决问题。我究竟做错了什么？

```
dialog = new Dialog(context);
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
dialog.setCanceledOnTouchOutside(false);
dialog.setContentView(R.layout.twitter_dialog);
// set up edit text and other widgets
dialog.getWindow().setLayout(450, 280);
dialog.show(); 
```

编辑：我从另一个具有 setCanceledOnTouchOutside(true) 的对话框中调用此对话框。在调用此对话框之前，前一个对话框被关闭。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-08-21T11:58:36.973

你可以使用 getDialog().setCanceledOnTouchOutside(false);

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-08T05:04:20.460

这对我有用：

```
dialog.getWindow().addFlags(WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T19:22:53.117

我能够通过使用 AlertDialog 解决我的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-04T07:22:10.500

请检查示例代码

```
EditDialog newDialog = new EditDialog();
newDialog .setCancelable(false);   ///This will prevent closing the dialog on back button press/ touch outside
newDialog .show(getSupportFragmentManager(),"dialog"); 
```

# php - 如何为使用 php 执行的 ssh 命令设置超时？

> ID：10957455
> 
> 赞同：2
> 
> 时间：2012-06-09T00:30:13.547
> 
> 标签：php, timeout

我使用 php 通过包装函数通过 ssh 执行 scp 命令。移动是在本地和远程服务器之间进行的。

我大致知道脚本应该执行多长时间，如果 scp 进程花费的时间太长（由于目标服务器陷入困境或其他网络问题），我想终止它。当前发生这种情况时，scp 进程将完全锁定，直到重新启动目标服务器或从命令行手动终止 scp 进程。

我可以将某种超时传递给 shell_exec() 以退出其正在执行的工作并继续执行脚本吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T00:43:57.690

使用 UNIX`timeout`实用程序包装您的命令。

```
system('timeout n ../my/aa');
                ^ 
```

`n`以秒为单位的整数值在哪里。

> 如果命令超时，则以状态 124 退出。否则，以 COMMAND 状态退出。如果未指定信号，则在超时时发送 TERM 信号。TERM 信号会杀死任何不阻塞或捕获该信号的进程。对于其他进程，可能需要使用 KILL (9) 信号，因为无法捕获此信号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T21:12:11.333

您可以通过执行以下操作使用 phpseclib 执行此操作：

```
<?php
include('Net/SSH2.php');

$ssh = new Net_SSH2('www.domain.tld');
if (!$ssh->login('username', 'password')) {
    exit('Login Failed');
}

$ssh->setTimeout(5);
echo $ssh->read();
//$ssh->write('whatever');
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T00:42:58.120

您可以编写一个使用 shell_exec 调用的 shell 脚本，该脚本在一定时间后自动终止，然后您调用它而不是 scp 直接调用，这样的脚本将接受参数或将它们硬编码。这是一个脚本示例，它采用 2 个参数，2 秒是它在终止进程之前等待的秒数。（睡眠也接受分钟、我们的或天，只需附加 m、h 或 d）

```
 #!/bin/sh
 scp $1 &
 pid=$!
 sleep $2
 kill $pid 
```

编辑：或使用nickb的解决方案，那就更好了。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T00:47:27.137

您可以使用带超时的 PHP 套接字：

```
$process = proc_open($command,$descriptorspec,$pipes);
stream_set_timeout($pipes[1], 30);
$line=stream_get_contents($pipes[1]);    // read data
while($line)stream_get_contents($pipes[1]);
fclose($pipes[1]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T01:58:04.587

或者您可以使用 select 等待命令返回。这是从 php 手册复制的代码示例，您可以参考 proc_open() 和 stream_select()

```
<?php
$descriptorspec = array(
   0 => array("pipe", "r"),  
   1 => array("pipe", "w"),
   2 => array("file", "/tmp/error-output.txt", "a")
);

$pipes = array();
$process = proc_open('sleep 5 && echo hello', $descriptorspec, $pipes);
$timer = 0;
if (is_resource($process)) {
    while(true) {
        $write = null;
        $except = null;
        $read = array($pipes[1]);
        $ret = stream_select($read, $write, $except, 1);
        if ($ret === false) {
            echo "error";
            break;
        } else if ($ret == 0) {
            echo "waiting for " . ++$timer . "sec" . PHP_EOL;       
        } else {
            echo stream_get_contents($pipes[1]);
            break;
        }
    }
    fclose($pipes[1]);
    $return_value = proc_close($process);
    echo "command returned $return_value\n";
}

?> 
```

# scala - 如何强制惰性值计算

> ID：10957459
> 
> 赞同：9
> 
> 时间：2012-06-09T00:32:01.977
> 
> 标签：scala, lazy-evaluation

强制计算惰性值的惯用 scala 方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-09T00:51:56.600

只需调用它：

```
lazy val x = someOperation()
// ...
x 
```

# mysql - 无法验证 google mysql 命令行工具

> ID：10957460
> 
> 赞同：1
> 
> 时间：2012-06-09T00:32:49.397
> 
> 标签：mysql, cloud

我正在尝试使用 Google Mysql Cloud。我在验证 google 命令行工具时遇到问题。在谷歌网站（[https://developers.google.com/cloud-sql/docs/commandline](https://developers.google.com/cloud-sql/docs/commandline)）中，他们说我可以下载命令行工具并使用以下方式进行身份验证：

```
./google_sql.sh instance 
```

这是一个linux命令，我不能在windows中使用它。每次我使用此命令时，Windows 都会尝试询问我要使用什么应用程序来打开此文件。

我下载了一个 Cygwin 来运行脚本，但我收到了这样的错误：

```
Unable to access jarfile /d/google_sql.jar 
```

真的不知道。

任何人都可以帮助我吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T15:13:22.227

您无需安装 Cygwin 即可运行该脚本。事实上，您不需要运行 Linux shell 脚本，即 Windows 环境中带有 .sh 扩展名的脚本。

在 Google Cloud SQL 命令行工具的 zip 文件中，有一个带有 .cmd 扩展名的 Windows 命令批处理文件。你像这样执行它：

**google_sql**应用程序名称：sql 实例名称

您不需要添加 .cmd 扩展名，并且不要忘记将项目 ID 字符串和冒号放在 sql 实例名称之前。

命令及其输出如下所示：
C:\google_sql_tool>google_sql appname:sqlinstancename
请在以下位置为您的 Google 帐户授权 Google SQL 服务：
http://**.* */ ****** *网页 google 引导你获取授权码*
Enter Authorization Code: ***** ***** *long authorization code, paste here* ***** *****
sql>*

# javascript - 如何通过html显示php链接

> ID：10957462
> 
> 赞同：-1
> 
> 时间：2012-06-09T00:33:54.967
> 
> 标签：javascript, html, rotation, banner

我一直在尝试通过 js 在我的网站上插入旋转横幅。出于某种原因，我不能插入多个 JS 而不会消失。当我通过 php 查看 js 时，它工作正常。这是一个例子

[http://www.hificornershop.co.uk/banners/top.php](http://www.hificornershop.co.uk/banners/top.php)

rotate.js 在我的服务器上，top.php 插入了 js 代码来读取它

然后我通过我网站上的 iframe 显示了 php 文件，但我发现 iframe 很痛苦。无论如何我可以在没有 iframe 的情况下显示 php 文件，希望通过 html 代码我可以复制到我的网站中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:38:36.903

您可以“显示”输出 HTML 的 PHP 文件，只需将其包含在源代码中的某个位置即可。

```
<?php include "myfile.php"; ?> 
```

通过将其放在页面中的某个位置，任何`myfile.php`输出都将插入该位置。因此，如果您有一个脚本在每次页面加载时显示一个随机横幅，您可以将该文件包含在您的页面中，它应该可以工作。

# jquery - jQuery.getJson - json 文件或 js 中有错误吗？

> ID：10957464
> 
> 赞同：0
> 
> 时间：2012-06-09T00:34:09.477
> 
> 标签：jquery, getjson

我是 js 和 jQuery 的新手，所以仍然非常有感觉……但这让我困惑了几天。

我正在尝试做这 101 件事 - 使用 jQuery.getJson 读取然后对这里的文件做一些事情：[http ://www.metakarma.org/agame.json](http://www.metakarma.org/agame.json)

我无法弄清楚错误在哪里 - 在我的 js 或文件中。

这是我在js中尝试的：

```
<script type="text/javascript">
    $(document).ready(function () {
        $.getJSON("http://www.metakarma.org/agame.json", function (data) {
            $.each(data.moves, function (i, amove)
            $("#debug").append(amove.role + ' ' + amove.message + '<p>');
            });
        });
</script> 
```

当我在此处的 jQuery 参考页面上使用 js 示例从 Flickr 获取前 3 张猫照片时 - [http://docs.jquery.com/Getjson](http://docs.jquery.com/Getjson) - 它基本上可以按预期工作。但是我上面的代码/文件组合会产生完全的沉默。

我想我有两个问题：1.我如何有效地调试这个？2.什么是bug？

非常感谢指点我目前的洞！托尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T00:39:31.593

您可以使用诸如[jsonlint.com](http://jsonlint.com/ "jsonlint")之类的工具来验证 JSON（您的不是由于周围的括号），以将其缩小到处理或数据。

我还会使用诸如 firebug/wireshark/httpfox 等工具来观察网络流量，以查看您的呼叫是否正在返回数据，或者可能发生的其他情况。

# java - 在java中识别可搜索/不可搜索的文件

> ID：10957466
> 
> 赞同：0
> 
> 时间：2012-06-09T00:34:38.840
> 
> 标签：java

在我的应用程序中，我将收到一个文件。我必须检查文件是否具有可搜索的文本（文本内容）或不可搜索的文本（图像）并显示。

我不能使用文件扩展名，因为在 PDF 文件中，我们也可以有不可搜索的类型。

我需要为此的java代码。谁能帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T01:20:43.950

这个问题的一个实际解决方案是从文件内容中找出未知文件的 MIME 类型。然后，您需要构建从 MIME 类型到类的映射，以提取相应文件类型的文本。

有一些库用于执行第一部分（识别 MIME 类型），尽管这是一个启发式过程，并且可以（理论上）返回错误答案或（实际上）“未知”。以下是关于如何执行此操作的 SO 问题和其他参考的示例：

*   [在 Java 中获取文件的 Mime 类型](https://stackoverflow.com/questions/51438/getting-a-files-mime-type-in-java)
*   [java库从文件内容中查找mime类型](https://stackoverflow.com/questions/4348810/java-library-to-find-the-mime-type-from-file-content)
*   [从文件中获取 Mime 类型](http://www.rgagnon.com/javadetails/java-0487.html)
*   [jmimemagic](http://sourceforge.net/projects/jmimemagic/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T01:39:59.580

这属于[**数据挖掘**](http://en.wikipedia.org/wiki/Data_mining)领域，也属于**搜索引擎**（Lucene）。有很多转换器（pdftotext、htmltotext、unzip 等）。那么字符编码就起作用了；UTF16-LE 每个字符使用两个字节。某些文件类型具有识别标头、魔术 cookie（JPEG、GIF、PDF）。

最好对最适合您需求的项目进行互联网研究。然后在设计了功能正常的管道之后，逐步添加功能。

如果你需要一个设计，数据挖掘的死标准，JDM 2.0 可能会提供一个 API。

# python - Python，使用比较函数来寻找最佳对象

> ID：10957467
> 
> 赞同：1
> 
> 时间：2012-06-09T00:34:42.817
> 
> 标签：python, list, comparison

我有一个将 2 个对象作为参数的函数：`a`并且`b` 该函数检查（使用非常长的算法）这些对象中的哪一个更好。

如果 a 更好，则返回 -1，如果 b 更好，则返回 1，如果并列则返回 0

我的问题是：

我在一个列表中有 21 个这样的对象。

我需要找出，使用上面的函数（函数不能更改，唯一的方法是比较 2 个对象，这是一个非常复杂且冗长的算法），这 21 个对象中哪个是最好的。

我尝试了好几个小时思考如何有效地做到这一点而不进行太多次相同的比较，如何编写一个算法来找出哪个是最好的（如果它们中的两个是并列的并且它们都是最好的，它不会拿哪一个都没关系，虽然我认为平局是不可能的），而且我想不出什么好东西。

函数的名称是`handCompare(a, b)` 对象在名为 的列表中找到`Combos`，`len(combos)`是 21 我需要一个算法来找出组合列表中的最佳项目

感谢阅读，希望对您有所帮助：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T00:43:06.843

如果您更改`hand_compare()`为 return `1`if a 更好并且`-1`b 更好，这将起作用。

```
import functools
best = max(combos, key=functools.cmp_to_key(hand_compare)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:46:30.210

最直接的方法：为每个对象创建一个对象，比较函数为`__cmp__`（python 2.x）或定义`__lt__`和`__eq__`（python 3.x）。将每个存储在一个名为 list_ 的列表中。使用 min(list_) 找到最小的值。

如果可行，可能会有所帮助的优化：如果您能想出一种将对象映射到（可能很大）整数的方法，使得 x 的整数 < y 的整数，如果原始对象 ox 小于原始对象对象 oy，然后取整数的最小值。如果它适用于您的类型，这应该会稍微加快速度。

# coldfusion - CF10 是否支持安全 websocket wss？

> ID：10957468
> 
> 赞同：6
> 
> 时间：2012-06-09T00:35:02.817
> 
> 标签：coldfusion, coldfusion-10, cfwebsocket

使用 CF10 的人可以确认 CF10 是否支持安全 websocket`wss://`吗？

![在此处输入图像描述](../Images/8a2b9cd6bc83e07762f462094c1727d7.png)

[http://blog.kaazing.com/2012/02/28/html5-websocket-security-is-strong/](http://blog.kaazing.com/2012/02/28/html5-websocket-security-is-strong/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T15:16:05.290

我和赫曼特核实过。答案是否定的，现在不支持，但正在添加中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T07:16:14.167

基于在 CF10 文档（根据 Google）中没有提及“安全 websocket”或“wss”，并且在 Ray Camden 就该主题所做的所有博客中，也没有提及它，事实上，所有谷歌上唯一与“cf10 wss”相关的匹配就是回到这个问题，我会说“不”。

但我认为，这将是一个相当奇怪的实施遗漏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-03T17:01:45.420

我刚刚尝试在创建 URL 的 websocketChannel.js 文件上破解它（第 18 行）

```
var lURL="ws://"+(_7e0)+":"+_cf_websocket_port+"/cfusion"+"/cfusion"; 
```

试图这样做

```
var lURL= (location.protocol === "https:" ? "wss" : "ws") + "://"+(_7e0)+":"+_cf_websocket_port+"/cfusion"+"/cfusion"; 
```

但是 wss:// 连接永远不会连接。BS我告诉你..纯BS！唯一的问题确实是 IE10，因为它不会连接到从安全页面启动的不安全的 websocket 通道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T17:18:25.650

> 不，尚不支持。但是，它正在考虑用于 ColdFusion Splendor。

[https://twitter.com/rakshithn/status/352722362799624193](https://twitter.com/rakshithn/status/352722362799624193)

# objective-c - 解析器返回奇怪的脚本

> ID：10957469
> 
> 赞同：0
> 
> 时间：2012-06-09T00:35:09.590
> 
> 标签：objective-c, ios, parsing

我正在尝试解析[此页面](http://www.aliorbank.pl/pl/o_banku/kursy_walut/kursy_walut_aktualne/main)。NSLog 给了我奇怪的结果：

```
Aktualne kursy walut - Alior Bank
if( window.opera ) {
    if ('fast' == history.navigationMode) {
        history.navigationMode = 'automatic';
        location.reload();
    } else {
        history.navigationMode = 'fast';
    }
} 
```

它可以是什么？解析此页面的正确方法在哪里？我的工作代码：

```
NSError * error = nil;
    HTMLParser * parser = [[HTMLParser alloc] initWithContentsOfURL:[NSURL URLWithString:@"http://www.aliorbank.pl/pl/o_banku/kursy_walut/kursy_walut_aktualne/main"] error:&error];    
    if (error) {
        NSLog(@"Error: %@", error);
        parser = nil;
        return 0;
    }
    HTMLNode * bodyNode = [parser doc];

    NSLog(@"parser = %@", [bodyNode allContents]); 
```

**编辑** 我想用汇率值解析表格。但是，当我尝试使用“currencyTable”类搜索表时，我什么也得不到。我的代码：

```
HTMLNode * bodyNode = [parser doc];
HTMLNode *myNode = [bodyNode findChildOfClass:@"currencyTable"];
NSLog(@"table = %@", [myNode allContents]); 
```

NSLog 给了我“table =”。我怎样才能得到这张桌子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:02:25.777

我查看了源码

```
view-source:http://www.aliorbank.pl/pl/o_banku/kursy_walut/kursy_walut_aktualne/main 
```

^(（在 Chrome 中打开）)

该文件的，它似乎只返回标签之间的信息。

例如，标题标签是：

```
<title>Aktualne kursy walut - Alior Bank</title> 
```

您回复的第一部分是：

```
Aktualne kursy walut - Alior Bank 
```

下一段在标签之间有任何文本的 html 源代码是：

```
<script>
if( window.opera ) {
    if ('fast' == history.navigationMode) {
        history.navigationMode = 'automatic';
        location.reload();
    } else {
        history.navigationMode = 'fast';
    }
}
</script> 
```

再次，它返回这些标签之间的文本：

```
 if( window.opera ) {
    if ('fast' == history.navigationMode) {
        history.navigationMode = 'automatic';
        location.reload();
    } else {
        history.navigationMode = 'fast';
    }
} 
```

我不明白这是一个“奇怪”的结果。总的来说，我想我不得不问，**你期待什么？**

## 编辑

看过文档中的示例，我会这样尝试：

```
NSError * error = nil;
HTMLParser * parser = [[HTMLParser alloc] initWithContentsOfURL:[NSURL URLWithString:@"http://www.aliorbank.pl/pl/o_banku/kursy_walut/kursy_walut_aktualne/main"] error:&error];    
if (error) {
    NSLog(@"Error: %@", error);
    parser = nil;
    return 0;
}
HTMLNode * bodyNode = [parser body];
NSArray *tableNodes = [bodyNode findChildTags:@"input"];

HTMLNode *tableToParse = nil;
for (HTMLNode *tableNode in tableNodes) 
{
    if ([[tableNode getAttributeNamed:@"class"] isEqualToString:@"currencyTable"]) 
    {
         tableToParse = tableNode;
         break;
    }
}

//Proceed to parse this table node in a similar way.
NSLog(@"Table to parse : %@", [tableToParse rawContents]); 
```

请注意，我没有测试过这段代码，这只是从文档中编写的。

# c# - 理解字节序

> ID：10957472
> 
> 赞同：-3
> 
> 时间：2012-06-09T00:36:06.090
> 
> 标签：c#, stack, endianness

我正在用 C# 编写一个堆栈类，其行为类似于 x86 堆栈（字填充、推送和弹出不同大小的“对象”的能力等）

如果我打电话给`Push<int>(0x01234567)`，下面的 ASCII 艺术描述了应该发生的事情。这是大端还是小端。

```
| 0x01 | 0x23 | 0x45 | 0x67 |  ---- Low Address  (New  top)
   |      |      |      \----> 0x67
   |      |      \-----------> 0x45
   |      \------------------> 0x23
   \-------------------------> 0x01
                               ---- High Address (Orig top) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:47:31.930

最低有效字节（0x67）在最低地址中，所以小端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T05:50:45.693

这些是`int`值的单个字节还是只是以`int`块的形式显示 ' 的十六进制表示的一种奇怪方式？因为在little-endian 中，最低有效字节具有最低的内存地址，即它在内存中字节的原始十六进制视图中排在第一位。但是，在您的堆栈上，第一个字节存储在最高地址中，那么这将是大端。

# aspnetdb - ASPNETDB 登录页面不会加载

> ID：10957473
> 
> 赞同：0
> 
> 时间：2012-06-09T00:36:16.667
> 
> 标签：aspnetdb

新的 ASP NET 应用程序和 ASPNETDB 出现问题

安装在现有服务器上，该服务器已经有一个类似的应用程序，它愉快地使用 ASPNET DB 作为会员等。配置等非常相似。登录页面与另一个运行良好的应用程序中的相同。应用程序在 NETWORK SERVICE 下运行，其他应用程序也是如此。

使用一个漂亮的小应用程序[http://sourceforge.net/projects/aspnetdb/](http://sourceforge.net/projects/aspnetdb/)将新应用程序和管理员用户添加到现有的 ASPNETDB。查看了新应用程序、角色、用户的 ASPNETDB 中的条目 - 一切都很好。

在您尝试使用 asp:Login 控件导航到页面之前，应用程序看起来很好。进度条缓慢增长 - 显然是几个小时 - 但不会离开调用页面。没有错误，没有超时。

看看数据库活动监视器。显示了一个附加到 ASPNETDB 的进程，该进程似乎在不断地搅动。杀死它，页面导航完成，但出现有关进程不可用的错误。

另一个应用程序有一个类似的过程，它似乎只在导航到登录页面时触发一次。

有任何想法吗？

安装程序为 Windows Server 2003 标准版、.NET Framework 2.0.50727.3603、SQL Server 2005 标准版 9.00.3042.00

谢谢，杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T00:46:14.227

哎呀！找到它 - 我的代码中的一个错误。永远不要硬编码路径！！！！

# javascript - jQuery 循环列表

> ID：10957478
> 
> 赞同：0
> 
> 时间：2012-06-09T00:36:47.363
> 
> 标签：javascript, jquery, rotation

我正在尝试在表格中旋转项目列表（即：）。我想要做的是删除第一个项目并在表格末尾添加一个项目。我能够删除第一个项目，但我被困在如何每 10 秒不断重做一次。也许，查看代码会给出一个更好的主意。

代码：

```
 $num_ads = 0;
        if (isset($ads[0])) {
            foreach($ads as $row) {
                                    ...
                                    ...
                echo '<td class="featured_ads_td" id="featured_'.$num_ads.'">';
                                    ...
                                    ...
                                    $num_ads++
                            }
                    } 
```

所以我所做的是我给表中的每个项目一个唯一的ID。在这种情况下，第一项将是特色_0，然后是特色_1，特色_2..等

Javascript

```
<script src="/jquery-latest.min.js"></script>
<script type="text/javascript">
        var ad_refresh = setInterval(function(){
            $('#featured_0').fadeOut('slow');
            $('#featured_0').attr('id','removed');
        }2000);
</script> 
```

使用下面的这个脚本将删除我的第一个项目。但是无论如何我可以如何制作第一个 item_0 以便我可以每 2 秒递归一次？或者如果有更好的方法，请告诉我。我对 javascript 和 jquery 的了解仍然非常有限。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:50:41.273

如果我确实正确理解了您的问题，那么沿着这条线的某些内容将允许您淡出元素并将其放在其余元素之后：

请参阅此[工作小提琴](http://jsfiddle.net/zuul/qtjEh/)示例！

**jQuery**

```
var ad_refresh = setInterval(function(){
    var $target = $('.featured_ads_td:first-child');
    $target.fadeOut('slow', function() {
        $target.appendTo('tr').show();
    });
},2000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:55:49.697

@Lawrance，你可以这样做：http: [//jsfiddle.net/estevao_lucas/usXba/](http://jsfiddle.net/estevao_lucas/usXba/)

我唯一做的就是克隆并删除第一个元素，然后再次附加到表中。

# actionscript-3 - hitTestObject 输出不止一次？

> ID：10957481
> 
> 赞同：0
> 
> 时间：2012-06-09T00:37:41.500
> 
> 标签：actionscript-3, action

```
public class GameEnter extends MovieClip
{

  public function GameEnter()
  {
    addEventListener(MouseEvent.MOUSE_DOWN, shootBullet);
  }
    public var _bullet1:bullet = new bullet;
    public var angleRadian = Math.atan2(mouseY - 300,mouseX - 300);
    public var angleDegree = angleRadian * 180 / Math.PI;

    public function shootBullet(evt:MouseEvent)
    {
        _bullet1.x = 300;
        _bullet1.y = 300;
        _bullet1.angleRadian = Math.atan2(mouseY - 300,mouseX -300);
        _bullet1.addEventListener(Event.ENTER_FRAME, bulletEnterFrame);
        addChild(_bullet1);
    }

    public var speed1:int = 10;
    public function bulletEnterFrame(evt:Event) 
    {
        _bullet1.x += Math.cos(_bullet1.angleRadian) * speed1;
        _bullet1.y += Math.sin(_bullet1.angleRadian) * speed1;
        _bullet1.rotation = _bullet1.angleRadian*180/Math.PI;
        checkHit();
        if (_bullet1.x < 0 || _bullet1.x > 600 || _bullet1.y < 0 || _bullet1.y > 600) 
        {
            removeChild(_bullet1);
            _bullet1.removeEventListener(Event.ENTER_FRAME, bulletEnterFrame);
        }
    }

public function checkHit()
{
     if(_bullet.hitTestObject(enemy))
     {
          trace("Enemy hit");
     }
}

} 
```

基本上发生的事情是它打印出大约 10 次“Enemy hit”。我想知道：我怎样才能让它只追踪一次“敌人击中”？我认为问题在于，对于子弹在敌人身上的每一帧，它都会打印出来，我该如何解决这个问题，只打印一次？

我最终将替换 "trace("Enemy hit");" 有功能什么的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T23:13:12.327

每一帧都会调用 checkHit() 并且子弹只有在游戏区域外时才被移除？这意味着在 checkHit() 为真的每一帧都会跟踪“敌人命中”。一旦发生命中，您应该移除事件侦听器，类似于子弹移出屏幕时。

# symfony - Symfony2 Twig 加载模板

> ID：10957482
> 
> 赞同：1
> 
> 时间：2012-06-09T00:37:42.387
> 
> 标签：symfony, twig

我在告诉树枝要加载哪个模板时遇到了一些麻烦。

我有一个文件位于 MyBundle/Resources/Views/Admin/Project/list.html.twig

当我声明： return ' `MyBundle:Admin:Project:list.html.twig`' 我收到以下错误：

```
Unable to find template 
```

如果我将文件移出项目目录，即`MyBundle/Admin/list.html.twig`并声明：`return 'MyBundle:Admin:list.html.twig`' 将呈现模板。我错过了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T01:15:47.883

试试这个：

```
MyBundle:Admin:Project/list.html.twig 
```

# linux - 计算滚动总数的吞吐量

> ID：10957483
> 
> 赞同：3
> 
> 时间：2012-06-09T00:37:58.430
> 
> 标签：linux, bash, math

我不确定是不是我的系统中缺乏咖啡因，但我一生都无法弄清楚这样做的正确方法是什么（数学）。

我有一个脚本，它每隔“x”（在此测试期间为 6）秒记录解析的 ethtool -S 的值，直到它被手动停止。我有关于如何计算迭代等的代码，但我无法弄清楚如何正确计算每秒的平均字节数。

这是输出的样子：

```
Fri Jun  8 23:48:35 GMT 2012 {{{
============== Network Statistics ===============
IFNAME     rx_bytes        tx_bytes
eth0      27840111418      3083391508
eth4      6153013050      18478875401
eth5      686368648      238683883
eth6      53863181321      2119523154
eth7      23127231747      84602654827
eth8      399517273166      1686004510

Fri Jun  8 23:48:41 GMT 2012 {{{
============== Network Statistics ===============
IFNAME     rx_bytes        tx_bytes
eth0      27840118248      3083392896
eth4      6153014438      18478876789
eth5      686370036      238685271
eth6      53863182709      2119524542
eth7      23127238019      84602660337
eth8      399519325260      1686018706 
```

正如我们所看到的，字节都增加了，我将进行数千次迭代。

在每个接口的基础上完全计算这些数字并计算每秒平均字节数的*正确*方法是什么（我最终将通过 * 0.00000762939453 将其移动到 mbps）。

到目前为止，我尝试过的一切都失败了……悲惨：\

感谢您的时间/耐心/帮助！

编辑:: 我目前*认为*我需要做的是删除 rx/tx 字节的原始值以规范化数据。我当前（丑陋的）用于提取初始总和的字符串是这样的：

```
int1_rx_bytes=`cat $logfile | grep $int1 | awk '{print $2}' | awk '{sum+=$1} END {printf "%f", sum}'` 
```

出于减法目的，我会将原始数字放在哪里？作为参考，我已经有了一个名为 $int1_orig_rx_bytes 的变量

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T01:01:44.260

这两个脚本都未经测试。

对于移动平均线：

```
awk 'BEGIN {
    period = 10
    pcount=1
}
NR == 1 {
    baserx = $2
    basetx = $3
}
{
    rx[$1, pcount] = $2 - baserx
    tx[$1, pcount] = $3 - basetx
    ifaces[$1]
    if (c >= period) {
        rxsum = txsum = 0
        for (iface in ifaces) {
            for (i = 1; i <= period; i++) {
                rxsum += rx[iface, i]
                txsum += tx[iface, i]
            }
            print iface, rxsum / period, txsum / period
        }
    } else {
        c++
    }
    pcount = (pcount + 1) % period + 1
}' 
```

**编辑：**

对于所有条目的平均值：

```
awk '
NR == 1 {
    baserx = $2
    basetx = $3
}
{
    rx[$1] += $2 - baserx
    tx[$1] += $3 - basetx
}
END {
    for (iface in rx) {
        print iface, rx[iface] / NR, tx[iface] / NR
    }
}' 
```

不保证条目的输出顺序。如果你有`gawk`，你可以添加一个排序函数来处理这个问题，或者你可以使用该`sort`实用程序。

**编辑2：**

这更正了上述第二个版本的各种问题。

```
awk '
    BEGIN {
        OFMT = "%.4f"
    }

    /^[[:blank:]]*$/ { next }

    ! ($1 in prevrx) {
        prevrx[$1] = $2
        prevtx[$1] = $3
        next
    }
    {
        count[$1]++
        drx = $2 - prevrx[$1]
        dtx = $3 - prevtx[$1]
        rx[$1] += drx
        tx[$1] += dtx
        prevrx[$1] = $2
        prevtx[$1] = $3
    }
    END {
        for (iface in rx) {
            print iface, rx[iface] / count[iface], tx[iface] / count[iface]
        }
}' 
```

# c# - Google Docs：无法在 C# 中使用管理访问/模拟（禁止 403）导出/下载用户的文档

> ID：10957484
> 
> 赞同：0
> 
> 时间：2012-06-09T00:38:01.320
> 
> 标签：c#, google-docs, impersonation

我整天都在为此头疼，做了很多谷歌搜索，但无济于事。我正在编写一个将用户的所有 Google Docs 文件下载到本地磁盘的应用程序。我必须为多个用户执行此操作，并且只提供一个管理员帐户（通过模拟使用）。该问题仅适用于模拟用户尚未创作/共享的文档。在所有情况下，获取标题信息都可以正常工作（无论作者和共享设置如何）。下载由模拟帐户创作的文件也可以正常工作。但是，下载由其他用户创作的文件会失败，并出现 HTTP 401 或 403（权限被拒绝）。有人可以告诉我我做错了什么吗？下面是代码的精简版本。谢谢！

```
 using System.IO;
using Google.GData.Documents;
using Google.GData.Client;
using Google.GData.Extensions;
using Google.Documents;

void impersonateAndGetAllUsersDocs()
{
    string applicationName = "myapp";
    string username = "admin@domain.com";
    string password = "adminPassword";
    string accountToImpersonate = "someOtherUser@domain.com";

    DocRequest = new DocumentsRequest(new RequestSettings(applicationName, username, password));

    DocumentsListQuery docQuery = new DocumentsListQuery();
    docQuery.Uri = new Uri(docQuery.Uri.ToString().Replace("/default/", "/" + accountToImpersonate + "/"));

    AtomFeed docFeed = DocRequest.Service.Query(query);
    //process every document in the feed
    foreach (AtomEntry docEntry in docFeed.Entries)
    {
        //this line works for all docs (irrespective of who the author is)
        string title = docEntry.Title.Text;

        Document doc = new Document()
        {
            AtomEntry = docEntry;
        };

        //the next line throws an exception with HTTP 401 or 403 (permission) if the author is not the impersonated account
        Stream queryStream = DocRequest.Download(doc, Document.DownloadType.html)

        //do something with the stream, such as write to local disk

        //all done, close the stream
        if (queryStream != null)
            queryStream.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:46:58.810

冒充其他用户的正确方法是使用 2-legged OAuth 并将`xoauth_requestor_id`参数添加到 uri 以指定要为其请求数据的用户。

根据文档中的完整示例，这可以使用 .NET 客户端库轻松完成：

[https://developers.google.com/gdata/docs/auth/oauth#2LeggedOAuth](https://developers.google.com/gdata/docs/auth/oauth#2LeggedOAuth)

# jquery - Rails Server 回调到不同的域

> ID：10957485
> 
> 赞同：0
> 
> 时间：2012-06-09T00:38:02.220
> 
> 标签：jquery, ruby-on-rails, controller

我想做以下事情：客户端（来自不同的域，现在是我本地计算机上的 JQuery-Script）向服务器发送 Ajax-Post，服务器将结果保存到服务器并将 HTML/文本发送回将它注入到他的 HTML 中的客户端。

这是 Ajax 调用：

```
 var params = '{"comment": "Test", "creator": "Prof Frick", "name":     "Rainer", "url": "' + url + '"}';
  alert(params);
  $.ajax({
    type: "post",
    data: params,
    url: 'http://localhost:3000/pages/postjson/',
    success: function(data) {
      $('h1').html(data);
    }
  });
}); 
```

这是我的路线：

```
match '/pages/postjson/' => 'pages#postjson' 
```

这是控制器：

```
 def postjson
    parsed_json = ActiveSupport::JSON.decode(request.body.read) #
    @page = Page.where(:url => parsed_json["url"])
    new_obj = Page.new
    new_obj.name = parsed_json["name"]
    new_obj.creator = parsed_json["creator"]
    new_obj.url = parsed_json["url"]
    new_obj.comment = parsed_json["comment"]
    new_obj.save    
    render :json => @page[:name]
  end 
```

我认为我的错误是非常基本的，我非常感谢您的帮助。我的猜测是错误要么在

```
 @page = Page.where(:url => parsed_json["url"]) 
```

或在

```
 render :json => @page[:name] 
```

因为一切都通过了，json-data 被保存，浏览器甚至警告“成功”，但我想发布的只是消失了。

谢谢你的建议。一般的编码技巧也总是很受欢迎！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T19:38:42.493

我终于解决了这个难题（对我来说）：

在阅读了很多之后，我找到[了这个教程](http://davidsulc.com/blog/2011/04/10/implementing-a-public-api-in-rails-3/)

我将控制器更改为类似于以下内容：

```
respond_to do |format|
  format.js  { render :json => @page, :callback => params[:callback] } 
```

我的 JQuery-Function 看起来像这样：

```
$(document).ready(function() {
  $.ajax({
    type: "GET",
    processData: false,
    contentType: "application/json",
    dataType: "jsonp",
    url: 'http://localhost:3000/pages/postjson.js?callback=?',
    success: function(data) {
      $('h1').html(data.name);
      alert("Name: "+ data['name']);
    }
  });
}); 
```

很高兴它终于可以工作了:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:44:53.717

如果您使用`render :json => something`，您将获得一个 json 对象作为响应。在这种情况下，您需要的是一个`render :js`和一个被调用的视图`postjson.js.erb`（假设您使用的是 ERB）。在这种情况下，您必须编写必要的 JavaScript 代码来以您想要的方式操作 HTML。

# design-patterns - (JavaScript+Java+Rest) 应用程序设计方法

> ID：10957486
> 
> 赞同：1
> 
> 时间：2012-06-09T00:38:13.203
> 
> 标签：design-patterns, application-design, web-application-design

我正在使用一个名为“Play！Framework”的新框架，它遵循 MVC 模式。

我的 Web 应用程序在视图层有 java 模型和控制器类和 (html+javascript)。

此外，我们没有自己的数据库...应用程序数据来自基于休息的 Web 服务（按需），基于该 TAB/MENU 用户单击。

我的问题是——

1）我现在正在使用（jquery + play）语法从各种.html文件中调用各种java控制器......这是一个好方法吗？

2）在服务器端，我们有多个 REST 服务来获取不同类型的数据。我现在已经使用“DAO”来配置和点击 REST Web 服务和“DTO”来建模模型对象（这些对象将携带 REST 获取的数据）并分别在 JQuery DataTable 中呈现它们......这样可以吗？

3）REST返回给我们JSON数据，我们必须对其进行一些处理以使其适合显示到JQuery DataTable中......现在这个逻辑被写入Java Helper类中，用于我的Web应用程序的每个功能......是这行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:52:18.703

看起来不错，你是在正确的方式我使用相同的机制

但是当您使用 javascript 时，您的**Rest URI 会暴露给最终用户**，因此需要考虑安全性。

![在此处输入图像描述](../Images/c16878c3553d32129cb045ca34957b89.png)

# nintendo - 如何修改老式 NES 游戏？

> ID：10957490
> 
> 赞同：9
> 
> 时间：2012-06-09T00:39:17.263
> 
> 标签：nintendo

我有时会看到修改过的NES游戏，我想尝试一下。使用什么工具来实现这一点？是否有一些神奇的源代码存储库位于我不知道的某个地方？我的问题是，修改任意 NES 游戏的第一步是什么？（如果第一步是“保持头脑清醒”，那么请给我第一步到第三步。）

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T17:43:18.010

你所说的被称为“ROM hacking”。

现在你要小心，因为有严重的法律问题（注意，我不是律师）：首先，要破解游戏，你需要找到你试图破解的游戏的 ROM 映像。有些网站提供这些下载，但我**不会**链接到一个。你自己在这里。另一个问题是，被黑的游戏将被视为侵权衍生作品。然而，在实践中，游戏公司大多忽略了 ROM 黑客场景。

撇开法律问题不谈，这些是 ROM 黑客的基本要素：

*   您要破解的游戏的 ROM 映像（请参阅上面的警告）。
*   一个模拟器。从理论上讲，您可以将您的 hack 写入磁带并在 NES 上播放，但前提是您仍然拥有 NES，因此模拟器是次佳选择。请注意，模拟器是完全合法的（不是 ROM）；对于 NES ROM hacking 和 homebrew 开发，我会推荐[FCEUX](http://fceux.com)。它有一个内置的内存查看器和一个出色的调试器。
*   十六进制编辑器。我推荐[HexEdit](http://www.hexedit.com)。截至目前，它是免费软件。抱歉，它仅适用于 Windows。
*   一个平铺编辑器，用于编辑图形。我推荐[YY-CHR](http://www.romhacking.net/utilities/119/)。同样，它仅适用于 Windows。

[Romhacking.net 也](http://www.romhacking.net)提供其他有用的工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T00:42:38.417

您将需要 ROM 映像和反汇编程序，或者只是一个好的旧十六进制编辑器。除非您非常了解目标架构，否则这将是困难的。很多时候，在这些旧系统上，他们在角落里编码，以使东西适合少量可用的存储空间。这将导致一些非常奇怪的“副作用”代码，您可能会觉得很难理解。

我的建议是，使用现代硬件以现代语言从头开始创建游戏作为“封面版本”，您不必担心只有 4kb 内存！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-09T00:43:40.270

这与修改任何其他已编译的程序相同；在高层次上，您需要：

1.  将现有游戏的 ROM 映像从二进制反汇编成更高级别的语言（如汇编）
2.  修改装配体
3.  将更改后的汇编语言源重新组装到 Nintendo ROM 中

正如 Jeff Watkins 在他的回答中所说，您也可以直接使用十六进制编辑器修改 ROM，而无需先对其进行反汇编，但任务大致相同，只需您执行它而不是计算机即可。

关于提取数据块（精灵等）和理解实际程序流程有很多较低级别的问题。它绝对不会为您提供大量易于理解并带有注释的代码。

看看关于反汇编和修改 16 位游戏的[另一个问题。](https://stackoverflow.com/questions/2898451/how-to-decompile-sega-super-nintendo-roms)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T00:46:03.790

而且您必须非常了解硬件。有一些互联网资源可以提供很好的文档，比如[这个 wiki](http://wiki.nesdev.com/w/index.php/Nesdev_Wiki)

祝你好运！

# ruby-on-rails - rspec 登录测试说我使用 post 时出现路由错误

> ID：10957491
> 
> 赞同：0
> 
> 时间：2012-06-09T00:39:17.727
> 
> 标签：ruby-on-rails, rspec

我正在使用此脚本通过 rspec 测试我的登录页面

```
describe "Sessions" do
  describe "GET /sessions/new" do
    it "works! (now write some real specs)" do
      # Run the generator again with the --webrat flag if you want to use webrat methods/matchers
      post "/session/new", { :username => "user", :password => "pass" }
      response.should redirect_to("/dashboard")
    end
  end
end 
```

当我尝试这个时，rspec 说：

```
 ActionController::RoutingError:
 No route matches [POST] "/session/new" 
```

但我知道 /session/new 是一条有效的路线。此外，如果我只是尝试生成默认的 ie `get "sessions/new"`，而不是尝试`post`或`post_via_redirect`不尝试测试用户名和密码，它工作正常。所以基本上，我只是想测试用户发布用户名和密码的登录页面。我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T01:08:43.847

如果您使用的是 restful 路由，“/sessions/new”应该只响应 GET 请求。此 URL 用于将表单提供给用户提交。

您应该改为发布到“/会话”

# android - 我应该使用什么端口进行 TCP 数据包传输

> ID：10957492
> 
> 赞同：4
> 
> 时间：2012-06-09T00:39:24.657
> 
> 标签：android, sockets, tcp

嘿，我将使用 Android 和 java 通过 Wi-Fi 将数据发送到我的计算机，在我的服务器端（Windows PC）我有这个：

```
serverSocket = new ServerSocket(port); 
```

在客户端（Android）：

```
InetAddress remoteAddr = InetAddress.getByName(SERVERIP);
socket = new Socket(remoteAddr, port); 
```

问题是建议使用哪个端口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:48:40.090

选择任何未保留/未分配的 TCP 端口号。具体来说，它是 49152–65535 范围内的任意数字。

IANA 页面目前似乎无法正常工作，但这里有一个包含相同信息的wiki[页面。](http://en.wikipedia.org/wiki/Ephemeral_port)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T00:48:47.640

[除了可以在此处](http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xml)找到的保留端口外，您可以使用所需的每个端口

# ruby - 可以仅在一行中将集合枚举到数组吗？

> ID：10957496
> 
> 赞同：1
> 
> 时间：2012-06-09T00:41:01.433
> 
> 标签：ruby

在 Ruby 中，这可以简化为一行吗？

```
results = []
Object.all.each { |o| results <<  o if o == 1 }
results 
```

我在想它是 enum_for，但无法弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T00:43:01.000

看看[Enumerable](http://ruby-doc.org/core-1.9.3/Enumerable.html)中丰富的方法：

```
Object.all.select { |o| o == 1 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T00:43:34.413

也许这个？

```
Object.all.select{|o| o == 1} 
```

# hibernate - 当关系是从孩子到父母时，如何在休眠中删除孩子

> ID：10957500
> 
> 赞同：0
> 
> 时间：2012-06-09T00:42:54.000
> 
> 标签：hibernate, hibernate-mapping

我试图在删除父项时删除子记录。父表中没有引用子表的列。孩子指的是一对一可选关系中的父母。

当父级被删除时，由于事实关系仍然存在而引发约束。如果我将 set 关系添加到子端，则无济于事。Hibernate 不会删除子记录，因为我猜，从未获取过子记录。

有没有办法在拦截器中删除子记录？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T08:10:31.110

**我将提供类似情况的示例，将其应用于您的情况将解决问题。**

让我们假设 Employee 在它的表中有一个 Department_ID，并且 Department 没有任何列引用 Employee_ID。

我们使用连接列将员工与部门相关联。这样我们就得到了单向关联。

```
public class Employee {

    @OneToOne
    @JoinColumn(name = "DEPARTMENT_ID")
    private Department department;
} 
```

接下来，我们通过标记与[`mappedBy`](http://docs.oracle.com/javaee/5/api/javax/persistence/OneToOne.html#mappedBy%28%29)属性的关联来将部门与员工关联起来。它在 Employee 端引用关联的拥有字段。这样我们就得到了双向关联。

```
public class Department {

    @OneToOne(mappedBy = "department", cascade = CascadeType.ALL)
    private Employee employee;
} 
```

与 CascadeType.ALL 的标记关联将包括 CascadeType.REMOVE，它将在删除操作时级联到 Employee。现在，删除部门，将连同它一起删除员工。

# asp.net-mvc-3 - 将数据从动作传递到另一个动作

> ID：10957501
> 
> 赞同：5
> 
> 时间：2012-06-09T00:42:55.527
> 
> 标签：asp.net-mvc-3

您如何通过 RedirectAction 方法将模型从 (GetDate) 操作传递到另一个 (ProcessP) 操作？

这是源代码：

```
[HttpPost]
public ActionResult GetDate(FormCollection values, DateParameter newDateParameter)
{
    if (ModelState.IsValid)
    {
return RedirectToAction("ProcessP");
    }
    else
    {
return View(newDateParameter);
    }
}

public ActionResult ProcessP()
{
   //Access the model from GetDate here??
    var model = (from p in _db.blah
 orderby p.CreateDate descending
 select p).Take(10);

    return View(model);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T00:48:57.170

如果您需要将数据从一个操作传递到另一个选项，则可以使用[TempData](http://msdn.microsoft.com/en-us/library/system.web.mvc.tempdatadictionary.aspx)。例如，在 GetDate 中，您可以将数据添加到会话中，如下所示：

```
TempData["Key"] = YourData 
```

然后执行重定向。在 ProcessP 中，您可以使用之前使用的密钥访问数据：

```
var whatever = TempData["Key"]; 
```

为了获得体面的阅读，我建议通读此线程：[ASP.NET MVC - TempData - Good or bad practice](https://stackoverflow.com/questions/386681/asp-net-mvc-tempdata-good-or-bad-practice)

# ruby-on-rails - Heroku 上的 Rails Friendly_Id，Heroku 不更新 slug

> ID：10957505
> 
> 赞同：3
> 
> 时间：2012-06-09T00:43:12.017
> 
> 标签：ruby-on-rails, heroku, friendly-id

我已经设置了[friendly_id](https://github.com/norman/friendly_id/) gem，跟随它上面的[RailsCasts Screencast](http://railscasts.com/episodes/314-pretty-urls-with-friendlyid)。在本地这工作得很好，我安装了它，运行`User.find_each(&:save)`成功地更新了每个现有用户的 slug 字段，一切都很好。

我现在已经将它推送到 Heroku，尽管它对添加的任何新成员都有效，但 Heroku 并没有为我更新现有用户的用户 slug。

运行`heroku run console`然后`User.find_each(&:save)`什么也不做：

```
irb(main):001:0> User.find_each(&:save)
  User Load (20.2ms)  SELECT "users".* FROM "users" WHERE ("users"."id" >= 0) ORDER BY "users"."id" ASC LIMIT 1000
    (23.6ms)  BEGIN
    (2.0ms)  COMMIT
    (13.6ms)  BEGIN
    (21.1ms)  COMMIT
=> nil 
```

中的相关代码`models/user.rb`为：

```
extend FriendlyId
friendly_id :name, use: :slugged
def should_generate_new_friendly_id?
  new_record?
end 
```

而且我已经在 Heroku 上运行了所有数据库迁移，它们运行良好。我检查了一下，`users`表格确实有一个`slug`字段，但它是空的，我不确定我在哪里出错了。如果有人碰巧以前遇到过这种情况，任何建议将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T00:56:48.047

当然，这总是一些愚蠢的事情。我真的不知道我是怎么错过的：

这段代码：

```
def should_generate_new_friendly_id?
  new_record?
end 
```

如果更改名称，它会阻止新的蛞蝓制造，也会阻止它更新以前的帖子。

我通过注释掉这个问题解决了这个问题，推送，运行 Heroku 控制台然后`User.find_each(&:save)`工作得很好，然后我取消注释代码并再次推送到 Heroku，一切都很花哨。

希望这可以帮助将来的人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-06T13:16:17.880

就我而言，这是历史：

```
friendly_id :text, use: [:slugged, :history] 
```

必须是

```
friendly_id :text, use: :slugged 
```

为了让heroku保存工作......然后我阅读了历史部分

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-25T06:25:14.840

我能够通过改变我的`should_generate_new_friendly_id?`方法来解决这个问题

```
 def should_generate_new_friendly_id?
    title_changed?
  end 
```

到

```
 def should_generate_new_friendly_id?
    slug.nil? || title_changed?
  end 
```

# mysql - `WHERE` 子句中的 doubles `articles.id` 语句会发生什么情况？

> ID：10957513
> 
> 赞同：1
> 
> 时间：2012-06-09T00:44:26.027
> 
> 标签：mysql, sql, database, where-clause, where

我正在使用 MySQL，我想知道当我运行 SLQ 查询时，在以下情况下究竟会发生什么（或可能发生什么）

## 情况1

```
SELECT ... 
WHERE 'articles'.'author_id' = 2 
  AND (articles.id IN (46,4,5)) 
  AND (articles.id IN (4,5,16,40)) 
```

## 案例2

```
SELECT ... 
WHERE 'articles'.'author_id' = 2 
  AND (articles.id NOT IN (46,4,5)) 
  AND (articles.id IN (4,5,16,40)) 
```

*?*

特别是，我的意思是子句`articles.id`中的双精度语句会发生什么`WHERE`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T00:47:56.520

只是一个逻辑 AND

```
1 && 1 = 1
0 && 1 = 0
1 && 0 = 0
0 && 0 = 0 
```

应用于1.案例：

```
Value        IN (46,4,5)  AND  IN (4,5,16,40)    Result
4                 1                  1             1
5                 1                  1             1
46                1                  0             0
16                0                  1             0
40                0                  1             0 
```

应用于2.案例：

```
Value     NOT IN (46,4,5)  AND  IN (4,5,16,40)   Result
4                 0                  1             0
5                 0                  1             0
46                0                  0             0
16                1                  1             1
40                1                  1             1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:46:36.060

在这两种情况下，将不包括出现在 IN 集和 NOT IN 集中的任何给定 ID。

在检查 ID 为 4 的行时（例如），它必须满足布尔条件

4 在 (46,4,5) 和 4 不在 (46,4,5)

这是错误的，因此不会返回 ID 为 4 的行。

对于 ID 同时出现在 IN 子句和 NOT IN 子句中的任何其他行也是如此，因为给定的 ID 不能既存在又不存在于同一组 ID 中。

# php - 登录表单无法正常工作

> ID：10957514
> 
> 赞同：0
> 
> 时间：2012-06-09T00:44:43.297
> 
> 标签：php, mysqli

我的登录表单有一点问题。我认为问题在于 mysqli 代码，因为当代码是旧的 mysql 代码时，登录可以正常工作，但是自从我将其更改为 mysqli 后，它就不能正常工作了。

假设发生的是，用户将在登录表单中输入他们的用户名和密码，当用户单击“登录”按钮时，它将检查用户名和密码是否正确。如果正确，则导航到 menu.php 页面，否则如果登录不正确，则显示一条消息，说明登录不正确，重试。

相反，下面的代码所做的是，当用户输入他们的用户名和密码并单击“登录”按钮时，无论用户名和密码是否正确，它都会刷新来自，它不会导航到菜单。 php 页面或显示登录错误消息。

所以我的问题是为什么会发生这种情况，为什么登录后它不导航用户或显示不正确的登录消息？

下面是代码：

```
 <?php

    session_start(); 

    $username="xxx";
    $password="xxx";
    $database="xxx";

    $mysqli = new mysqli("localhost", $username, $password, $database)or die( "Unable to select database");

    foreach (array('teacherusername','teacherpassword') as $varname) {
            $$varname = (isset($_POST[$varname])) ? $_POST[$varname] : '';
          }

    ?>

    <form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post" id="teachLoginForm">        
    <p>Username</p><p><input type="text" name="teacherusername" /></p>      <!-- Enter Teacher Username-->
    <p>Password</p><p><input type="password" name="teacherpassword" /></p>  <!-- Enter Teacher Password--> 
    <p><input id="loginSubmit" type="submit" value="Login" name="submit" /></p>
    </form>

    <?php
    if (isset($_POST['submit'])) {

    $query = $mysqli->prepare("
    SELECT * FROM Teacher t  
    WHERE 
    (t.TeacherUsername = '".mysqli_real_escape_string($teacherusername)."')
    AND
    (t.TeacherPassword = '".mysqli_real_escape_string($teacherpassword)."')
    ");

    $query->bind_result($Teacher);

    $num = $query->num_rows($result = $query->execute());

    $loged = false;

    while($row = $result->fetch())
      {

          if ($_POST['teacherusername'] == ($row['TeacherUsername']) && $_POST['teacherpassword'] == ($row['TeacherPassword']))
          {
              $loged = true;
          }

$_SESSION['teacherforename'] = $row['TeacherForename'];
$_SESSION['teachersurname'] = $row['TeacherSurname'];
$_SESSION['teacherusername'] = $row['TeacherUsername'];

      }

      if ($loged == true){
      header( 'Location: menu.php' ) ;
    }else{
      echo "The Username or Password that you Entered is not Valid. Try Entering it Again.";
    }

    }
     ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T01:03:50.800

由于多种原因，这段代码确实很糟糕。让我尝试为您重写并解释原因。

首先，您正在获取并遍历数据库的***所有***行并检查匹配项，您应该在 SQL 查询中执行此操作。

其次，您尝试在发送输出后发送标头。如果您启用了错误报告，这将不起作用并且应该引发错误。

第三，您无缘无故地定义了变量`$teacherusername`，`$teacherpassword`甚至没有始终如一地使用它们。

第四，您似乎无缘无故地开始了一个会话。

第五，您的查询过于复杂。

第六，正如 Mike 所指出的，您将用户密码以明文形式存储在数据库中。

我会这样写：

```
<?php
// There can be nothing (HTML, whitespace, anything) above this php tag.

if(isset($_POST['teacherusername']) && isset($_POST['teacherpassword']))
{
    // Connect to Database
    $username="xxx";
    $password="xxx";
    $database="xxx";
    $mysqli = new mysqli("localhost", $username, $password, $database)or die( "Unable to select database");

    // Build Query
    $q = sprintf('SELECT * FROM Teacher t');
    $q.= sprintf(' WHERE t.TeacherUsername = %s', mysqli_real_escape_string($_POST['teacherusername']));
    $q.= sprintf(' AND t.TeacherPassword = %s', mysqli_real_escape_string($_POST['teacherpassword']));

    // Run Query
    $query->bind_result($Teacher);
    $res = $query->execute();
    $num = $query->num_rows();

    if($num == 1)
    {
        header('Location: menu.php' );
    }
    else
    {
        session_start();        // Do you need this?
        echo "The Username or Password that you Entered is not Valid. Try Entering it Again.";
    }
}
?>
<form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post" id="teachLoginForm">        
<p>Username</p><p><input type="text" name="teacherusername" /></p>      <!-- Enter Teacher Username-->
<p>Password</p><p><input type="password" name="teacherpassword" /></p>  <!-- Enter Teacher Password--> 
<p><input id="loginSubmit" type="submit" value="Login" name="submit" /></p>
</form> 
```

现在，这并不能解决您仍然将密码作为明文存储在数据库中的事实。这是不好的做法，但有点超出今天课程的范围:-)

在这里，PHP 首先运行，`header()`或者`session_start()`是第一个发送输出的东西——这很重要，因为它们都需要成为第一个发送输出的东西。

我还解决了你的验证循环。如果查询返回行，则数据库中有匹配项并且用户名和密码正确，无需循环。

# html - 配置颜色/背景颜色 CSS

> ID：10957516
> 
> 赞同：0
> 
> 时间：2012-06-09T00:45:40.730
> 
> 标签：html, css

在设计/更改页面布局时，我根据需要为每个 div/class 元素着色。这使我能够清楚地看到布局的结构。

在使用实际内容测试/呈现页面布局时，我有不同的配色方案。

我需要经常在两者之间切换。我怎样才能做到这一点？

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T00:49:59.383

使用两个 CSS 文件。每个具有相同的类但不同的颜色值等。有一个批处理文件来交换两者。您可以使用您的主机文件和您的网络服务器中的一些魔法来组合一个更漂亮的皮肤方法，但这对于您的需求来说可能是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T11:42:33.633

在测试时，您可以**将一个类添加**到您的`html`or`body`标记中

**例如** `<html class="testingMode">`

然后在您的**样式表**中，您可以**覆盖其他样式**

**例如**

```
/*Normal/Live mode*/
.divClass {
    background: none;
}

/*Testing mode*/
.testingMode .divClass {
    background: green;
} 
```

`testingMode`在你上线之前，你可以从你的标签中删除类，`html`这些覆盖样式将不会被应用。

# java - 如何使用 JAX-WS Metro 在端点（服务器）上实现 WS-SecurityPolicy？

> ID：10957518
> 
> 赞同：2
> 
> 时间：2012-06-09T00:46:12.697
> 
> 标签：java, web-services, soap, jax-ws, ws-security

我的 WSDL 文件中有以下策略：

```
<wsp:Policy wsu:Id="UsernameToken" 
   xmlns:wsp="http://www.w3.org/ns/ws-policy" 
   xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" 
   xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
   >
   <wsap:UsingAddressing xmlns:wsap="http://www.w3.org/2006/05/addressing/wsdl"/>
   <sp:SymmetricBinding>
       <wsp:Policy>
           <sp:ProtectionToken>
               <wsp:Policy>
                   <sp:SecureConversationToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient" />
               </wsp:Policy>
           </sp:ProtectionToken>
       </wsp:Policy>
   </sp:SymmetricBinding>
</wsp:Policy> 
```

我已将其包含在绑定中：

```
 <wsp:PolicyReference xmlns:wsp="http://www.w3.org/ns/ws-policy" URI="#UsernameToken"/> 
```

它似乎通过 WSDL，除了在我的处理程序中我这样做：

```
 List<?> securityList = soapEnvelope.getSecurity(null, true);

        if ((securityList == null) || (securityList.size() == 0))
        {
            securityList = soapEnvelope.getSecurity();
        } 
```

它返回**null**。这里的soapEnvelop 是：**WSSOAPEnvelope** soapEnvelope，而且它不为空；

非常感谢您的帮助！已经为此苦苦挣扎了一段时间。

我有一种感觉，安全标头正在从信封中裁剪出来。

此外，如果我从 WSDL 文件中删除策略定义，那么它会在没有 的情况下通过`soap:mustUnderstand="1"`，如果我确实包含此属性，那么它会给我错误消息：

```
MustUnderstand headers:[{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd}Security] are not understood 
```

# android - 在 android 上启用 AP 收听 UDP 广播

> ID：10957521
> 
> 赞同：1
> 
> 时间：2012-06-09T00:46:39.527
> 
> 标签：android, udp, wifi

场景是有两部 Android 手机 A 和 B。手机 A 启用了 AP，并在 UDP 端口 1234 上侦听了一个线程。手机 B 通过 Wifi 连接到手机 A，并在端口 1234 上发送广播消息。手机 A 会收到这些数据包吗？

我知道这是 Wifi Direct 的用途，但该场景涉及 AP。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:27:24.293

万一其他人想这样做，我在两部手机上尝试过，答案是肯定的:)

# python - 如何在 Python 中将字符串日期时间转换为时间戳？

> ID：10957522
> 
> 赞同：3
> 
> 时间：2012-06-09T00:46:53.493
> 
> 标签：python, datetime, timestamp

我想`datetimestring = 'Fri, 08 Jun 2012 22:40:26 GMT'`使用 python 将此字符串转换为时间戳。

我试过了

```
 timestamp = time.mktime(time.strptime(datetimestring, '%a, %d %B %Y %H:%M:%S GMT')) 
```

但报告正则表达式错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T00:52:45.767

您正在使用`%B`，它对应于完整的月份名称，但您只有缩写名称。您应该`%b`改用：

```
>>> import time
>>> datetimestring = 'Fri, 08 Jun 2012 22:40:26 GMT' 
>>> timestamp = time.mktime(time.strptime(datetimestring, '%a, %d %B %Y %H:%M:%S GMT'))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/_strptime.py", line 454, in _strptime_time
    return _strptime(data_string, format)[0]
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/_strptime.py", line 325, in _strptime
    (data_string, format))
ValueError: time data 'Fri, 08 Jun 2012 22:40:26 GMT' does not match format '%a, %d %B %Y %H:%M:%S GMT'
>>> timestamp = time.mktime(time.strptime(datetimestring, '%a, %d %b %Y %H:%M:%S GMT'))
>>> timestamp
1339209626.0 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-18T08:24:25.243

导入时间导入 dateutil.parser 作为 dateparser

```
datetimestring = 'Fri, 08 Jun 2012 22:40:26 GMT'
dt = dateparser.parse(datetimestring)
timestamp = int(time.mktime(dt.timetuple())) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-28T18:53:45.820

为此，您可以使用[dateparser](https://pypi.python.org/pypi/dateparser)。

```

`import dateparser
>>> dateparser.parse('Fri, 08 Jun 2012 22:40:26 GMT')
datetime.datetime(2012, 6, 8, 22, 40, 26)` 

```

# cursor - 侦听器端口重新启动重置消息光标

> ID：10957527
> 
> 赞同：0
> 
> 时间：2012-06-09T00:47:42.493
> 
> 标签：cursor, jms, listener, message, mq

IBM MQ JMS 侦听器环境。MQ 是基于优先级的队列而不是 FIFO。

场景：我收到所有相同优先级的消息。可以说，早上 6.50 和 9.30 收到的消息一直排在队列中，直到晚上。白天收到的许多消息正在得到处理。我认为这是消息光标的问题。当光标在早上 6.50 移动到 NEXT 位置时，同时收到一条消息，直到光标到达队列末尾并返回第一个位置，才会处理此消息。这个说法对吗？

下一个问题，当应用程序重新启动时，是否会将消息光标重置到第一个位置？

此外，当侦听器端口停止一段时间（假设是 10 分钟）并启动时，光标会移回第一个位置吗？

非常感谢任何指针/回复。

问候，阿比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T14:16:52.040

不确定我是否正确理解了场景。在任何情况下：如果您的所有消息具有相同的优先级，则消息将按 FIFO 传递。实际上，您的听众应该收到所有消息，直到晚上才应该有消息排队。

如果您的消息具有相同的优先级，您还可以将 MSGDLVSQ 更改为 FIFO。在`runmqsc`做一个`alter ql(WCFQ) MSGDLVSQ(FIFO)`改变。

当应用程序重新启动时，将收到队列顶部的消息，除非您设置了一些消息选择器。重新启动端口时也是如此。

# f# - F# 中的结构平等

> ID：10957528
> 
> 赞同：15
> 
> 时间：2012-06-09T00:47:51.060
> 
> 标签：f#, structural-equality

我有一个包含函数的记录类型：

```
{foo : int; bar : int -> int} 
```

我希望这种类型具有结构平等。有什么方法可以标记`bar`在平等测试中应该被忽略吗？或者还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-09T03:03:58.437

请参阅 Don关于此主题的[博客文章，特别是](https://web.archive.org/web/20190114102108/https://blogs.msdn.microsoft.com/dsyme/2009/11/08/equality-and-comparison-constraints-in-f/)**自定义平等和比较**部分。

他给出的示例与您提出的记录结构几乎相同：

```
/// A type abbreviation indicating we’re using integers for unique stamps on objects
type stamp = int

/// A type containing a function that can’t be compared for equality  
 [<CustomEquality; CustomComparison>]
type MyThing =
    { Stamp: stamp;
      Behaviour: (int -> int) } 

    override x.Equals(yobj) =
        match yobj with
        | :? MyThing as y -> (x.Stamp = y.Stamp)
        | _ -> false

    override x.GetHashCode() = hash x.Stamp
    interface System.IComparable with
      member x.CompareTo yobj =
          match yobj with
          | :? MyThing as y -> compare x.Stamp y.Stamp
          | _ -> invalidArg "yobj" "cannot compare values of different types" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-01-06T09:31:08.750

要更具体地回答您的原始问题，您可以创建一个自定义类型，其实例之间的比较始终为真：

```
[<CustomEquality; NoComparison>]
type StructurallyNull<'T> =
    { v: 'T } 

    override x.Equals(yobj) =
        match yobj with
        | :? StructurallyNull<'T> -> true
        | _ -> false

    override x.GetHashCode() = 0 
```

然后你可以这样使用它：

```
type MyType = { 
    foo: int; 
    bar: StructurallyNull<int -> int> 
} 
```

# javascript - 打印您的网页屏幕并发送带有打印图像的电子邮件

> ID：10957530
> 
> 赞同：5
> 
> 时间：2012-06-09T00:48:20.480
> 
> 标签：javascript, screenshot

> **可能重复：**
> [将 HTML Canvas 捕获为 gif/jpg/png/pdf？](https://stackoverflow.com/questions/923885/capture-html-canvas-as-gif-jpg-png-pdf)

有没有一种简单的方法来创建 JS onclick 功能，它将打印网站的当前屏幕，将其保存为图像（.jpg 或其他内容）并通过电子邮件发送。

我想为用户端创建此选项，因此用户无需使用键盘“Prnt Scr”，然后打开“画图”并粘贴并“另存为”图像，然后附加并通过电子邮件发送。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T00:58:19.630

有一些解决方案：

*   使用以下方法将网页转换为图像`wkhtmltox`：

    [使用 jquery 生成网站的屏幕截图](https://stackoverflow.com/q/4550947/352449)

*   利用`HTMLCanvasElement`对象的`toDataURL`功能：

    [如何使用 JavaScript 截取 div](https://stackoverflow.com/q/6887183/352449)

*   `html2canvas`脚本：

    [使用 HTML5/Canvas/Javascript 截图](https://stackoverflow.com/q/4912092/352449)

*   使用 PHP `wkhtmltoimage`：

    [用PHP截取网站截图](http://www.codediesel.com/php/taking-screenshots-of-websites-in-php/)

* * *

**ps：**一个简单的[谷歌搜索](https://www.google.com/search?hl=pt&client=ubuntu&hs=w6&channel=fs&q=jquery%20take%20screenshot%20page&oq=jquery%20take%20screenshot%20page&aq=f&aqi=&aql=&gs_l=serp.3...0.0.0.256821.0.0.0.0.0.0.0.0..0.0...0.0.ZHlBUOEzXWo)给你所有这些！

# c++ - C++ 向量迭代器：erase() 最后一项崩溃

> ID：10957531
> 
> 赞同：2
> 
> 时间：2012-06-09T00:48:27.387
> 
> 标签：c++, crash, iterator, erase

以下代码检查球是否与砖重叠。如果发生重叠，砖块会突出显示并从列表中删除。

*仅擦除矢量brickWall*中的最后一项时，我遇到了核心转储。评论*erase()*行，代码似乎运行良好。
在论坛上查看类似问题后，我相信我正在迭代并正确擦除矢量中的项目，但我怀疑情况可能并非如此。

对此代码的任何建议将不胜感激！

```
void Game::updateEntities()
{
    ballMother.update();
    for (std::vector<gdf::Entity>::iterator it = brickWall.begin(); it != brickWall.end(); ++it) 
    {
        if (it->getRect().intersects(ballMother.getRect())) {
            it->rect.setFillColor(sf::Color::Red);
            it = brickWall.erase(it);
        }
        else {
            it->rect.setFillColor(it->colour);                
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-09T00:50:08.020

通常的成语是

```
for (std::vector<gdf::Entity>::iterator it = brickWall.begin(); it != brickWall.end(); /*note nothing here*/) 
{
    if (it->getRect().intersects(ballMother.getRect())) {
        it->rect.setFillColor(sf::Color::Red);
        it = brickWall.erase(it);
    }
    else {
        it->rect.setFillColor(it->colour);                
        ++it;
    }
} 
```

否则，您将跳过元素，并最终通过结束而崩溃。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T01:00:08.680

K-ballo 发现了错误，并提出了一个很好的习语，但您可能会发现使用标准算法和擦除删除习语更容易。

```
struct Pred {
    Pred(const BallMother& ballMother) { 
        //save refs to whatever you need for the compare 
    }

    bool operator()(const gdf::Entity& item) {
        //collision logic here, return true if you want it erased
    }
}; 
```

现在在您的功能中：

```
std::vector<gdf::Entity>::iterator end_iter =
    std::remove_if(brickWall.begin(), brickWall.end(), Pred(ballMother));

brickWall.erase(end_iter, brickWall.end()); 
```

或者更简洁地说：

```
brickWall.erase(std::remove_if(brickWall.begin(), brickWall.end(), Pred(ballMother)),
                brickWall.end()); 
```

# python - 带有redis后端的芹菜

> ID：10957535
> 
> 赞同：3
> 
> 时间：2012-06-09T00:48:51.490
> 
> 标签：python, django, settings, redis, celery

好的，我已经正确安装了所有东西，以便在 django 中获得 celery + redis

我有

```
INSTALLED_APPS = (
    'djcelery',
    'kombu.transport.django',
) 
```

这些在我的设置中

```
CELERY_REDIS_HOST = 'localhost'
CELERY_REDIS_PORT = 8889
CELERY_REDIS_DB = 0
CELERY_RESULT_BACKEND = 'redis'

BROKER_URL = "redis://localhost:8889/0"

REDIS_CONNECT_RETRY = True
CELERY_IGNORE_RESULT = True
CELERY_SEND_EVENTS = True
CELERY_TASK_RESULT_EXPIRES = 60
CELERYBEAT_SCHEDULER= 'djcelery.schedulers.DatabaseScheduler' 
```

我让 redis 使用

```
./redis-server 
```

它每秒输出到终端，所以我也可以运行

```
./manage.py celeryd -E -B --loglevel=INFO -n w1.d820 
```

没有错误，我什至可以看到我的任务被添加并成功完成

```
./manage celeryev 
```

所以即使认为它被 celeryev 记录了，这段代码也不起作用：

```
from celery.task import task
@task
def add(x, y):
    return x + y

res = add.apply_async(args=[1,5])
print res.wait() 
```

它只是挂起而没有返回结果，我可以看到它实际上试图从 redis 获取它，因为如果我这样做了

```
./redis-cli
MONITOR 
```

我有很多 GET 试图获取不存在的密钥所以我的结论是 django 没有保存到后端我的设置有什么问题？我认为我错过了一些明显的东西，我看不到它，因为我与这个斗争太久了。帮助

顺便说一句，我不能使用标准端口 6379，因为我在共享服务器上。

使用这些更新

```
celery==2.5.3
django-celery==2.5.5
django-celery-with-redis==2.5 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T12:27:30.387

你有`import djcelery; djcelery.setup_loader()`吗`settings.py`？

您可以通过运行以下命令找出它尝试连接的位置：

```
 $ python manage.py celeryctl shell

 >>> celery.broker_connection().as_uri() 
```

'setup_loader' 非常重要，因此您必须确保包含它。

(the good news is that celery will support Django out of the box for version 2.7).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T01:49:46.743

在 ubuntu 10.10 中，当您安装 redis 时，它会在启动时自动启动，并且它与 celery 冲突，因为显然即使您告诉它使用这个或那个端口，如果 celery 可以在 6379 端口连接到 redis，它也会将其用作后端。我没有看到代码，但这是我的结论。所以我关闭了所有在我想要的任何端口上使用我的 redis.conf 运行的 redis 实例，然后我将它们放在我的设置中。

```
BROKER_URL = 'redis://localhost:8889/0'
REDIS_DB = 0
REDIS_CONNECT_RETRY = True
CELERY_RESULT_BACKEND = 'redis'
CELERY_REDIS_PORT = 8889
BROKER_PORT = 8889
CELERY_RESULT_PORT = 8889
CELERY_TASK_RESULT_EXPIRES = 10
CELERYBEAT_SCHEDULER= 'djcelery.schedulers.DatabaseScheduler' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T01:01:16.923

你用的是什么版本的芹菜？在开发版本中，看起来他们使用了不同的装饰器；

```
from celery.task import task

@celery.task()
def add(x, y):
    return x + y 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T02:01:29.003

你是在 8889 端口启动 Redis 服务器吗？

# matlab - 在 MATLAB 图的图例中设置线条颜色？

> ID：10957541
> 
> 赞同：4
> 
> 时间：2012-06-09T00:49:27.410
> 
> 标签：matlab, colors, plot, legend

我正在使用 BNT 的 plotgauss2d 函数来可视化当在网络的其他地方观察到证据时 2D 高斯节点的响应如何变化。

```
eng = jtree_inf_engine(bnet);
evidence = cell(1, 2)
eng = enter_evidence(eng, evidence);
marginals = marginal_nodes(eng, 1); p_1 = marginals.T
marginals = marginal_nodes(eng, 2); p_2 = marginals.T
marginals
clf; plotgauss2d(marginals.mu, marginals.Sigma);
hold all;
evidence{1} = 1;
marginals = marginal_nodes(enter_evidence(eng, evidence), 2);
p = plotgauss2d(marginals.mu, marginals.Sigma);
set(p, 'Color', 'green');
evidence{1} = 2;
marginals = marginal_nodes(enter_evidence(eng, evidence), 2);
p = plotgauss2d(marginals.mu, marginals.Sigma);
set(p, 'Color', 'red');
legend({'Unknown', 'Class 1', 'Class 2'});
hold off; 
```

![在此处输入图像描述](../Images/89c367b21168d9e0ad8b589ec3172dd9.png)

如您所见，图例没有选择我必须手动设置的更改的绘图颜色。（遗憾的是，plotgauss2d 不会像您希望的那样自动循环颜色。）

有没有办法设置图例中使用的线条颜色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T01:50:17.960

PLOTGAUSS2D函数返回一个由三个手柄[组成](http://code.google.com/p/bnt/source/browse/trunk/KPMtools/plotgauss2d.m)的向量，分别对应于短轴、长轴和椭圆。所以这里是一个如何存储句柄并在最后调用 LEGEND 的示例：

```
figure, hold on
h = zeros(3,3);
h(:,1) = plotgauss2d(rand(2,1), [1 0.5; 0.5 2]);
h(:,2) = plotgauss2d(rand(2,1), [2 -0.5; -0.5 1]);
h(:,3) = plotgauss2d(rand(2,1), [1 0; 0 2]);
hold off
set(h(:,1), 'Color','r')
set(h(:,2), 'Color','g')
set(h(:,3), 'Color','c')
legend(h(1,:), {'1','2','3'}) 
```

![截屏](../Images/dbffeec94fded15b918df4ae390f8dfc.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T01:23:27.990

图例确实选择了线条颜色、样式、标记等。

您必须`plot`在每个 中至少包含三个 s `plotgauss2d plot`。因此，您的`legend`命令将 应用于`legend`前三个`plot`s，所有从第一次调用到`plotgauss2d`.

跳过您的一些代码，您可以通过执行以下操作使您的图例正确：

```
p = plotgauss2d(marginals.mu, marginals.Sigma);
h = p(1);
hold all;
evidence{1} = 1;
marginals = marginal_nodes(enter_evidence(eng, evidence), 2);
p = plotgauss2d(marginals.mu, marginals.Sigma);
h(end+1) = p(1);
set(p, 'Color', 'green');
evidence{1} = 2;
marginals = marginal_nodes(enter_evidence(eng, evidence), 2);
p = plotgauss2d(marginals.mu, marginals.Sigma);
h(end+1) = p(1);
set(p, 'Color', 'red');
legend(h,{'Unknown', 'Class 1', 'Class 2'}); 
```

现在，您正在将每个呼叫`legend`应用`legend`到一个。`plot``plotgauss2d`

另外，我建议在最后添加一行：

```
axis equal; 
```

我想你会喜欢它的功能。

# java - 如何使用 Java 和 Apache POI 根据其内容更新 excel 单元格

> ID：10957544
> 
> 赞同：1
> 
> 时间：2012-06-09T00:49:45.750
> 
> 标签：java, excel, apache-poi

我有一个预定义的 excel 文件，这是一种已经提到了大部分信息的表格，但我只需输入我用 Java 制作的应用程序中的名称、地址等详细信息。

我可以存储单元格（如 A12、B20 等）并使用 Apache POI 库和方法轻松更新这些单元格。但我希望它是动态的。就像用户将名称单元格从 A12 更改为 B12 一样，不应修改 Java 代码。

有没有办法我们可以在 excel 单元格中存储一些可变名称并从 Java 更新该单元格的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T01:57:21.140

您可以使用[CellReference](http://poi.apache.org/apidocs/org/apache/poi/ss/util/CellReference.html#CellReference%28java.lang.String%29)

```
String sUserInput = "A1"; // A1 or whatever
CellReference ref = new CellReference (sUserInput);
ref.getRow ();
ref.getCol (); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-13T11:16:12.517

您可以编写一个 cron 作业来读取具有特定间隔的 excel 文件，并将单元格值与以前的值进行比较。

# regex - 从文件中只获取英文单词

> ID：10957552
> 
> 赞同：0
> 
> 时间：2012-06-09T00:52:04.970
> 
> 标签：regex, shell, unix

我在一个文件中有很多单词 [MM]。

我运行了这个命令：

```
cat file.txt | tr " " "\n"| sort | uniq  > uniq.out 
```

我发现有很多中文单词和一些字母数字和特殊字符

我想得到所有只是英语的单词 [AZ][az] ONLY

```
grep -E "[A-Za-z]" uniq.out | grep -Ev "[0-9]" | less 
```

上面的命令也匹配字母数字单词。

有什么建议么 ？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:54:45.777

采用

```
^[A-Za-z]+$ 
```

（您的正则表达式只是说它必须包含 1 个 az 字符才能使该行算作匹配）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T01:02:35.060

# ios - iOS：分段错误崩溃，可重复但调试器中断组装

> ID：10957553
> 
> 赞同：0
> 
> 时间：2012-06-09T00:52:35.813
> 
> 标签：ios, segmentation-fault

我在我们的游戏中遇到了一个崩溃错误，我已经尝试了很长时间，但没有取得太大进展。我有一组大部分可重复的步骤来导致它，我已经能够在连接时重现它，在它发生之前弄清楚我的代码的最后一点是什么。我已经设置了断点并逐步通过它......但是当崩溃发生时，它总是在程序集中，并且崩溃报告似乎总是来自运行循环，这不是很有帮助。

这是我如何重现该错误（大约 1/3 的时间）...

进入游戏关卡选择界面，场景完成4/5关卡。级别选择器将位于第 5 级。立即选择第 4 级。选择环将移动到第 4 级的气泡，大约 1/3 的时间……第 5 级的气泡会无缘无故消失，游戏会崩溃。

最令人沮丧的事情之一是，它不会总是返回相同的崩溃报告。将会出现两个不同的版本。

希望有人可以帮助解决这个问题，因为我很困惑。

这是第一个：

```
Error Message:
Segmentation fault: 11: Application recieved signal

Where:
Tilt, line 0

Backtrace:
Tilt:0:in `0x00086bdf ht_handle_signal + 102'
libsystem_c.dylib:1:in `0x32cf87ed _sigtramp + 48'
UIKit:2:in `0x334e0105 __38-[UIView(Geometry) hitTest:withEvent:]_block_invoke_0 + 80'
CoreFoundation:3:in `0x358e77e3 __NSArrayChunkIterate + 318'
CoreFoundation:4:in `0x358e06ff __NSArrayEnumerate + 570'
CoreFoundation:5:in `0x35845ed5 -[NSArray enumerateObjectsWithOptions:usingBlock:] + 64'
UIKit:6:in `0x33338339 -[UIView(Geometry) hitTest:withEvent:] + 668'
UIKit:7:in `0x334e0127 __38-[UIView(Geometry) hitTest:withEvent:]_block_invoke_0 + 114'
CoreFoundation:8:in `0x358e77e3 __NSArrayChunkIterate + 318'
CoreFoundation:9:in `0x358e06ff __NSArrayEnumerate + 570'
CoreFoundation:10:in `0x35845ed5 -[NSArray enumerateObjectsWithOptions:usingBlock:] + 64'
UIKit:11:in `0x33338339 -[UIView(Geometry) hitTest:withEvent:] + 668'
UIKit:12:in `0x334e0127 __38-[UIView(Geometry) hitTest:withEvent:]_block_invoke_0 + 114'
CoreFoundation:13:in `0x358e77e3 __NSArrayChunkIterate + 318'
CoreFoundation:14:in `0x358e06ff __NSArrayEnumerate + 570'
CoreFoundation:15:in `0x35845ed5 -[NSArray enumerateObjectsWithOptions:usingBlock:] + 64'
UIKit:16:in `0x33338339 -[UIView(Geometry) hitTest:withEvent:] + 668'
UIKit:17:in `0x334e0127 __38-[UIView(Geometry) hitTest:withEvent:]_block_invoke_0 + 114'
CoreFoundation:18:in `0x358e77e3 __NSArrayChunkIterate + 318'
CoreFoundation:19:in `0x358e06ff __NSArrayEnumerate + 570'
CoreFoundation:20:in `0x35845ed5 -[NSArray enumerateObjectsWithOptions:usingBlock:] + 64'
UIKit:21:in `0x33338339 -[UIView(Geometry) hitTest:withEvent:] + 668'
UIKit:22:in `0x33337ee7 +[UIWindow _hitTestToPoint:pathIndex:forEvent:] + 314'
UIKit:23:in `0x3331ed43 _UIApplicationHandleEvent + 1226'
GraphicsServices:24:in `0x374df22b PurpleEventCallback + 882'
CoreFoundation:25:in `0x358c0523       __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 38'
CoreFoundation:26:in `0x358c04c5 __CFRunLoopDoSource1 + 140'
CoreFoundation:27:in `0x358bf313 __CFRunLoopRun + 1370'
CoreFoundation:28:in `0x358424a5 CFRunLoopRunSpecific + 300'
CoreFoundation:29:in `0x3584236d CFRunLoopRunInMode + 104'
GraphicsServices:30:in `0x374de439 GSEventRunModal + 136'
UIKit:31:in `0x3334ecd5 UIApplicationMain + 1080'
Tilt:32:in `0x000025df main + 98'
Tilt:33:in `0x00002578 start + 40' 
```

这是第二个。

```
Error Message:
Segmentation fault: 11: Application recieved signal

Where:
Tilt1Scene, line 0

Backtrace:
Tilt1Scene:0:in `0x00087a6f ht_handle_signal + 102'
libsystem_c.dylib:1:in `0x33da17ed _sigtramp + 48'
QuartzCore:2:in `0x3540bfd3   _ZN2CA5Layer19collect_animations_EdPdPNS0_21CollectAnimationsDataE + 290'
QuartzCore:3:in `0x3540bfd3 _ZN2CA5Layer19collect_animations_EdPdPNS0_21CollectAnimationsDataE + 290'
QuartzCore:4:in `0x3540bfd3 _ZN2CA5Layer19collect_animations_EdPdPNS0_21CollectAnimationsDataE + 290'
QuartzCore:5:in `0x3540bfd3 _ZN2CA5Layer19collect_animations_EdPdPNS0_21CollectAnimationsDataE + 290'
QuartzCore:6:in `0x3540bfd3 _ZN2CA5Layer19collect_animations_EdPdPNS0_21CollectAnimationsDataE + 290'
QuartzCore:7:in `0x3540bfd3 _ZN2CA5Layer19collect_animations_EdPdPNS0_21CollectAnimationsDataE + 290'
QuartzCore:8:in `0x3540bead _ZN2CA5Layer18collect_animationsEPNS_11TransactionEdPd + 56'
QuartzCore:9:in `0x35405b97 _ZN2CA7Context18commit_transactionEPNS_11TransactionE + 1078'
QuartzCore:10:in `0x3540557f _ZN2CA11Transaction6commitEv + 314'
QuartzCore:11:in `0x353fd4b9 _ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv + 56'
CoreFoundation:12:in `0x31560b1b __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 18'
CoreFoundation:13:in `0x3155ed57 __CFRunLoopDoObservers + 258'
CoreFoundation:14:in `0x3155f0b1 __CFRunLoopRun + 760'
CoreFoundation:15:in `0x314e24a5 CFRunLoopRunSpecific + 300'
CoreFoundation:16:in `0x314e236d CFRunLoopRunInMode + 104'
GraphicsServices:17:in `0x329bb439 GSEventRunModal + 136'
UIKit:18:in `0x317e7cd5 UIApplicationMain + 1080'
Tilt:19:in `0x000030c7 main + 98'
Tilt:20:in `0x00003060 start + 40' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T21:41:31.717

根据 WDUK 上面提供的帮助，我找到了这个问题的答案。

问题是由屏幕上的一个 UIButtons 自动释放引起的。发生这种情况是因为我有一个单独的属性 currentSelectedLevelButton 被保留。但是，在部分代码中，我设置了 currentSelectedLevelButton 而不是 self.currentSelectedLevelButton。由于我没有使用该属性作为设置器，因此未使用该属性的保留部分，然后将其自动释放。修复它涉及找到我设置 currentSelectedLevelButton 的所有位置并将其更改为 self.currentSelectedLevelButton。

# c# - 除了系统时间，如何将时间保存在变量中？

> ID：10957554
> 
> 赞同：0
> 
> 时间：2012-06-09T00:52:40.510
> 
> 标签：c#, datetime

除了系统时间设置之外，我如何以变量`dd/mm/yyyy`（对于英国）和（对于美国）格式保存时间？`mm/dd/yyyy`我正在从 DateTimePicker 控件中获取数据。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:59:32.380

如果您尝试将它们保存为字符串，则可以使用[DateTime.ToString(string format)](http://msdn.microsoft.com/en-us/library/zdtaw1bw.aspx) function 。

有关格式字符串的列表，您可以查看有关[Standard Date and Time Format Strings](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)和[Custom Date and Time Format Strings](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)的 MSDN 文章。

您可以通过访问[DateTimePicker.Value](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)属性来获取 DateTimePicker 选择的 DateTime。

对于您的示例，以下内容就足够了：

```
DateTimePicker myDateTimePicker = new DateTimePicker();

// ... other code ...

DateTime dtm = myDateTimePicker.Value;
string dateUK = dtm.ToString("dd/MM/yyyy"); // dd/mm/yyyy (UK)
string dateUS = dtm.ToString("MM/dd/yyyy"); // mm/dd/yyyy (US) 
```

**更新：**我更新了代码以包括从 DateTimePicker 中检索 DateTime，而不是从任意 DateTime 变量中检索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T00:55:43.173

问题有点模糊...

如果您担心格式，请使用 DateTime.Parse 或使用 DateTime.ToUniversalTime 来保存与输入时间等效的 UTC。

# google-maps - LatLngBounds - 如何获得 SW 和 NE 点

> ID：10957559
> 
> 赞同：3
> 
> 时间：2012-06-09T00:53:46.670
> 
> 标签：google-maps, google-maps-api-3

我正在尝试使用谷歌地图的自动完成和偏向结果`LatLngBounds`。我希望能够在一个岛屿（比如夏威夷群岛）周围绘制一个矩形并以这种方式获得 LatLngBounds。有什么工具可以帮助我吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T01:09:25.290

很久以前，我写了一个“缩放窗口”，供您使用。它只是地图和矩形侦听器。

[http://jsfiddle.net/yV6xv/16/embedded/result/](http://jsfiddle.net/yV6xv/16/embedded/result/)

查看代码：

[http://jsfiddle.net/yV6xv/16/](http://jsfiddle.net/yV6xv/16/)

要使用它，首先放大并手动平移到您的岛屿。您要选择的整个区域必须在屏幕上可见。

然后单击一次以定义一个矩形角。将鼠标移向对角线的对角。（将出现一个矩形选择）。再次单击以定义矩形区域。地图上方的文本区域应该为您提供带有 SW 和 NE 点的选定 LatLngBounds。

在尝试包含国际日期变更线时，它的行为与预期不同。

```
 var map;

  var mapOptions = {
    center: new google.maps.LatLng(0.0, 0.0),
    zoom: 2,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var bounds;
  var pt1, pt2;
  var rect;

  function toLatLng(lat, lng) {
    return new google.maps.LatLng(lat, lng);
  }

  function toBounds(j,k) {
    var pts = [];
    var latMin, latMax, lngMin, lngMax;
    var sw, ne;

    latMin = Math.min(j.lat(), k.lat());
    latMax = Math.max(j.lat(), k.lat());

    lngMin = Math.min(j.lng(), k.lng());
    lngMax = Math.max(j.lng(), k.lng());

    sw = toLatLng(latMin, lngMin);
    ne = toLatLng(latMax, lngMax);
    return new google.maps.LatLngBounds(sw, ne);
  }

  function initialize() {
    map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    rect = new google.maps.Rectangle({
      fillColor: "#FFFF00",
      fillOpacity: 0.3,
      strokeColor: "#0000FF",
      strokeWeight: 2
    });

    // Activate the box
    google.maps.event.addListener(map, 'click', function(event) {
      pt1 = event.latLng;
      rect.setMap(map);
    });

    // Modify the box's size
    google.maps.event.addListener(map, 'mousemove', function(event) {
      if(rect.getMap() == map) {
        rect.setBounds(toBounds(pt1, event.latLng));
      }
    });

    // Remove the zoom window and zoom in
    google.maps.event.addListener(rect, 'click', function(event) {
      rect.setMap(null);
      pt2 = event.latLng;
      myBounds = toBounds(pt1, pt2);

      document.getElementById("selectedBounds").value = "new google.maps.LatLngBounds(new google.maps.LatLng" + myBounds.getSouthWest() + ", new google.maps.LatLng" + myBounds.getNorthEast() + ");";
    });

    // Allows shrinking the box
    google.maps.event.addListener(rect, 'mousemove', function(event) {
      if(rect.getMap() == map) {
        rect.setBounds(toBounds(pt1, event.latLng));
      }
    });
  } 
```

HTML

```
<textarea id="selectedBounds" cols="60" rows="4"></textarea>
<div id="map_canvas"></div>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T07:26:02.420

这是另一个与反经络没有问题的类似工具：http: [//maps.forum.nu/gm_drag_polygon.html](http://maps.forum.nu/gm_drag_polygon.html)

马塞洛。

# c++ - C++11 中 shared_ptr 的原子操作

> ID：10957561
> 
> 赞同：12
> 
> 时间：2012-06-09T00:54:20.490
> 
> 标签：c++, c++11, shared-ptr

通过阅读 c++11 草案[n3242](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3242.pdf)的第 20.7.2.5 节，看起来我们对 shared_ptr 进行了原子操作，这使我们能够对复杂结构进行无锁操作，而无需担心 GC/内存泄漏。

但是，我无法在 GCC-4.7.0 中成功使用它。我只是测试了以下程序

```
#include <atomic>
#include <memory>
#include <string>

struct X {
    int x;
    double y;
    std::string s;
};

int main() {
    std::shared_ptr<X> x(new X);
    auto p = std::atomic_load(&x);
} 
```

它有编译器错误：

```
c.cpp:13:33: error: no matching function for call to ‘atomic_load(std::shared_ptr<X>*)’ 
```

有谁知道我在这里错过了什么？还是只是 gcc 还没有实现呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-09T18:12:25.907

有提议弃用 shared_ptr 的这些 atomic_store/atomic_load 方法以支持新的 atomic_shared_ptr 类：[http ://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4162.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4162.pdf)

因此，当您获得带有 atomic_load 的 libstc++ 版本时，它很可能已经包含新的原子指针，这在几个方面都更好。

MSVC STL 不久前已经实现了这些方法，并且 libc++ 也声称完全符合 C++11/14，因此它们必须在其最新版本中可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T01:06:07.367

看起来它还没有在 libstdc++ 中。

它也不在 libc++ 中

VS11 beta 有它。我认为这是我在 VS11 的库中发现的第一个不在 libc++ 中的东西。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2015-07-09T14:10:33.567

使用带有 -std=c++11 的 clang++ 来编译应该让它工作的代码。

# android - Android：进度条从自定义列表视图中消失

> ID：10957571
> 
> 赞同：1
> 
> 时间：2012-06-09T00:56:39.230
> 
> 标签：android, listview, android-progressbar

我发现了一些类似的问题，但无法解决问题。我有一个自定义 Listview，其中每个项目都包含一个水平进度条。但是，当列表包含许多项目，并且我使用滚动条在列表视图中导航时，一些 ProgressBars 会消失。是什么原因造成的，我该如何解决？

```
public class AdapterMetas extends ArrayAdapter<Metas>{

    private int resource;    
    private Context mContext;

    public AdapterMetas(Context context) {
        super(context, R.layout.adaptermetas);
        this.resource = R.layout.adaptermetas;          
        mContext = context;     
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        Metas p = getItem(position);
        LinearLayout layout = null;         

        if (convertView == null) {
            LayoutInflater li = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            layout = (LinearLayout) li.inflate(resource, null);
        } else {
            layout = (LinearLayout) convertView;
        }                   

        int value = p.getiValueMeta();                      

        ProgressBar itemMetaBar = (ProgressBar) layout.findViewById(R.id.itemMetaBar);    

        itemMetaBar.setProgress(value);    

        return layout;
    }

} 
```

# android - 如何将 listview 自定义 cursoradapter 转换为 Android 3.0 及更高版本？

> ID：10957572
> 
> 赞同：1
> 
> 时间：2012-06-09T00:56:42.927
> 
> 标签：android, android-cursorloader, android-cursoradapter

相当noobish和我在这里的第一篇文章。我有一个在 2.3.3 中运行良好的应用程序，它使用自定义 baseadapter 填充列表视图。问题是我正在使用 Android 3/4 中已弃用的 startManagingCursor 和 requery。

我正在使用 sqlite 和一个数据库适配器，它包含我的所有查询和一个私有方法来从活动传递参数。您可以通过长按某个项目或单击某个项目以在新活动中打开它并在您成功返回列表更新时更新列表。

我知道我们不应该在主 UI 上运行这些类型的操作，但我无法弄清楚 cursorloader 并且我什至需要它吗？我是否应该使用 asynctask 之类的其他东西在不同的线程上运行。我只是不明白这一切是如何结合在一起的，任何朝着正确方向的帮助将不胜感激。谢谢。

这是我认为最相关的代码来自 MyActivity 的一个小样本

```
public class MyActivity extends ListActivity {

private MyDBAdapter dbAdapter;
private MyCursorAdapter mCursorAdapter;

@Override
    public void onCreate(Bundle savedInstanceState) {          

        super.onCreate(savedInstanceState); 
        setContentView(R.layout.mylayout);

    this.dbAdapter = new MyDBAdapter(this);
        this.dbAdapter.open();

    queryParams = getQueryParams();
    queryDB(queryParams);
}

private void queryDB(String qParams) {
    Cursor c = this.dbAdapter.fetchQuery(qParams);
    startManagingCursor(c);
        this.mCursorAdapter = new MyCursorAdapter(this, c);
        setListAdapter(this.mCursorAdapter);
        this.mCursorAdapter.changeCursor(c);
    }

public void updateStatus(long paramLong, int paramInt) {
    Cursor c = this.dbAdapter.updateDBStatus(paramLong, paramInt);
    startManagingCursor(c);
    this.mCursorAdapter.changeCursor(c);
}

@Override
protected void onDestroy() {
    super.onDestroy();
    if (this.dbAdapter != null) {
    this.dbAdapter.close();
    }
}
} 
```

和 CursorAdapter

```
public class MyCursorAdapter extends CursorAdapter {

public MyCursorAdapter(Context cxt, Cursor cur, int flags) {
        super(cxt, cur);
        mContext = cxt;
        mLayoutInflater = LayoutInflater.from(cxt); 
    }

    @Override
    public View newView(Context cxt, Cursor cur, ViewGroup parent) {
        View vw = mLayoutInflater.inflate(LAYOUT_ID, parent, false);
        return vw;
    }

    @Override
    public void bindView(View vw, Context cxt, Cursor cur) {

        int id = cur.getInt(cur.getColumnIndexOrThrow("_id"));
        String name = cur.getString(cur.getColumnIndexOrThrow("name"));
    int completed = cur.getInt(cur.getColumnIndexOrThrow("completed"));

    TextView tv = (TextView) vw.findViewById(R.id.name);

    if(completed == 1) {
        tv.setTextColor(0x7fffffff);
        } else {
        tv.setTextColor(0xffffffff);
        }
    }
} 
```

================ 编辑==================

我最终删除了 startManagingCursor() 和 requery() 并从兼容性包中添加了 import android.support.v4.widget.CursorAdapter 。由于我从不同位置多次调用，我创建了一个私有 Cursor mCursor 并使用 this.mCursorAdapter.changeCursor(mCursor) 来更新它。

现在这几乎可以工作，除了：

1.  你真的不应该这样做，因为它仍然在主 UI 上运行
2.  关闭光标取决于应用程序的设置方式

就我而言，我无法关闭光标，否则我的列表视图将为空。在 onDestroy() 中关闭它不能保证运行，并且在 onBackPressed() 中关闭它不起作用，因为您可以单击一个列表项，该列表项使用新光标打开一个新活动。当有人单击列表项然后单击后退按钮时，列表应该在同一个位置，因此关闭 onStop()（并在 onStart() 中打开）也不是答案。我也在所有活动中尝试了一个公共静态游标，但这也有问题。我没有尝试的另一件事是将光标信息立即加载到内存中，然后立即关闭它，但这似乎不太理想。

我真的很喜欢 CursorLoader 的想法，除了它只接受一个 URI 并且你需要一个内容提供者并且它不接受 rawQuery()。我的数据库中有数千个项目，并且使用我的数据库适配器进行了一百个不同类型的查询调用，而重新更改所有这些似乎是一件很痛苦的事情。我认为 CursorLoader 是最好的方法，但我对 android 实现它的方式感到失望。

我还看到有人写的[没有 ContentProvider 的 CursorLoader](https://stackoverflow.com/questions/7182485/usage-cursorloader-without-contentprovider/7422343)使用 AsyncTaskLoader，因此您不需要 ContentProvider。这可能是我现在最好的选择，但其他人指出没有刷新数据更改的机制。我将不得不调查一下。

# php - 不同 PHP 脚本和 CodeIgniter 之间的会话

> ID：10957578
> 
> 赞同：1
> 
> 时间：2012-06-09T00:57:30.810
> 
> 标签：php, codeigniter, session

在我的不同脚本中（不使用 Codeigniter，但它在同一个域上）我这样设置我的会话数据：

```
<?php
session_start();
$_SESSION['something'] = 'test'; 
```

它为什么在那个单独的文件中有效，但在 Codeigniter 会话中却无效？

当我`var_dump( $this->session->all_userdata() );`在任何 Codeigniter 控制器中时，它不会显示我的`'something'`会话数据。

怎么了？可以这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T01:06:56.190

Codeigniter 管理自己的会话，并有几种不同的存储方法（它不一定使用 php 的本机会话存储作为后端）。

您仍然应该能够`something`通过执行访问 codeigniter 中的变量

```
session_start();
var_dump($_SESSION); 
```

如果您不担心修改 CI 核心，您可以修改会话库以从 $_SESSION 中提取数据。

更简洁的解决方案是编写一个挂钩，将本机 CI 会话与默认的 PHP $_SESSION 超全局会话合并。

# performance - 如果元素没有 ID，DOM 搜索会更快吗？

> ID：10957581
> 
> 赞同：2
> 
> 时间：2012-06-09T00:58:10.757
> 
> 标签：performance, dom

我有一个包含无数元素的页面。如果我将具有 ID 的元素数量保持在最低限度，浏览器是否会更有效地工作（例如，getElementById），还是没有区别？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:46:29.597

通常，DOM 被加载到一个专门的树状数据结构中，而树是为快速查找而设计的。所以一旦页面在内存中，所有的搜索都会很快。如果文件较小，加载/解析会更快，即没有 IDs=less chars=less Bytes。但是一旦它们全部加载到内存中，它就无关紧要了。

它还取决于浏览器的 JavaScript 引擎为 getElementById() 方法实现的算法类型。我确信 Chrome 的做法与 IE 或 FF 不同，反之亦然。我不会担心这部分，因为您无法控制每个供应商如何实现他们的浏览器。

要点是，尽量保持文件较小。短节点名称和 ID 优于长节点名称和 ID，因为毕竟，字符串匹配发生在解析/搜索过程的某个步骤。

# session-cookies - 保持登录最佳实践：cookie 中的用户名如何使其更安全？

> ID：10957584
> 
> 赞同：10
> 
> 时间：2012-06-09T00:58:20.790
> 
> 标签：session-cookies, stay-logged-in

这是另一个问题的一个分支： [为网站实施“记住我”的最佳方式是什么？](https://stackoverflow.com/questions/244882/what-is-the-best-way-to-implement-remember-me-for-a-website)

最佳答案是实现这一点：http: [//jaspan.com/improved_persistent_login_cookie_best_practice](http://jaspan.com/improved_persistent_login_cookie_best_practice)

总结：

> 使用一个随机数作为系列令牌，另一个作为登录令牌。将它们与用户名一起放在保持登录状态 cookie 中。分配第二个正常的会话 cookie。每次用户在没有会话 cookie 的情况下到达时，使用保持登录 cookie。发行一个新的，这次使用新的随机登录令牌，保持系列令牌相同。

为什么要包含用户名？这有什么帮助？系列令牌应该足以识别用户和系列。在这种方法中添加了系列令牌以防止 DoS 攻击，在这种攻击中，攻击者只需猜测所有用户名并立即访问该站点，从而将所有人登出。但是为什么保留用户名有意义呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T01:05:46.123

在发出新的会话 cookie 之前，用户名和号码会在服务器上成对查找。如果没有用户名，它的安全性会降低（如果你偷了号码，可能会使用不同的用户重播）并且更难查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-30T09:53:07.937

我对此的猜测：

用户名用于审核。如果您要求客户端将其与令牌一起发送以进行身份​​验证，那么您就知道哪个用户尝试进行身份验证。这使您可以以某种理智的方式对令牌错误做出反应。

如果您只在身份验证期间请求令牌，那么您不知道哪个用户实际尝试了它，并且在匹配时只授予某人访问权限，但在失败时无法执行任何操作。有人可以尝试盲目地检查它们。

考虑到这一点，假设我们决定同时使用用户名和令牌。现在，如果令牌错误，我们可以删除该用户的所有其他令牌。但这会将系统打开到 DOS。攻击者可以随意注销任何人。因此，添加了该系列。

它不一定是用户名，其他一些可以识别用户的信息也可以。

# c - KissFFT正向/反向输出噪声，为什么？

> ID：10957604
> 
> 赞同：0
> 
> 时间：2012-06-09T01:02:58.983
> 
> 标签：c, fft, kissfft

我正在尝试在 Java 应用程序中本机使用 KissFFT，但输入信号的正向/反向没有按应有的方式返回：信号幅度几乎不存在。如果我去掉比例因子（除以 2N），结果就是谐波噪声。任何人都可以发现错误吗？

这是转发呼叫（从 GDX 复制，所以应该没问题！）：

```
JNIEXPORT void JNICALL Java_com_badlogic_gdx_audio_analysis_KissFFT_spectrum(JNIEnv* env, jclass clazz, jlong handle, jshortArray obj_samples, jfloatArray obj_spectrum) {
    short* samples = (short*)env->GetPrimitiveArrayCritical(obj_samples, 0);
    float* spectrum = (float*)env->GetPrimitiveArrayCritical(obj_spectrum, 0);

        KissFFT* fft = (KissFFT*)handle;
        kiss_fftr( fft->forwardConfig, (kiss_fft_scalar*)samples, fft->spectrum );

        int len = fft->numSamples / 2 + 1;
        for( int i = 0; i < len; i++ )
        {
            float re = scale(fft->spectrum[i].r) * fft->numSamples;
            float im = scale(fft->spectrum[i].i) * fft->numSamples;

            if( i > 0 )
                spectrum[i] = sqrtf(re*re + im*im);
            else
                spectrum[i] = sqrtf(re*re + im*im);
        }

    env->ReleasePrimitiveArrayCritical(obj_samples, samples, 0);
    env->ReleasePrimitiveArrayCritical(obj_spectrum, spectrum, 0);

} 
```

这是相反的（我写的，可能有错误；））：

```
JNIEXPORT void JNICALL Java_com_badlogic_gdx_audio_analysis_KissFFT_inverse(JNIEnv* env, jclass clazz, jlong handle, jshortArray obj_samples) {
    short* shortSamples = (short*)env->GetPrimitiveArrayCritical(obj_samples, 0);

//@line:108

        KissFFT* fft = (KissFFT*)handle;
        kiss_fft_cpx out[fft->numSamples];

        kiss_fftri( fft->inverseConfig, fft->spectrum, (kiss_fft_scalar*)out );

        for (int i=0; i < fft->numSamples; i++) {
            shortSamples[i] = (out[i].r) / (fft->numSamples*2);
        }

    env->ReleasePrimitiveArrayCritical(obj_samples, shortSamples, 0);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T15:32:32.657

根据受保护成员的要求，这是一个更完整的示例（无论如何，在本机方面）。我最终稍微修改了 libgdx 代码（使用 v.0.9.4）。我还使用浮点而不是固定进行编译，因为后者在反演时会引入量化噪声。这段代码*应该*适用于任何一个（因为kiss_fft_scalar 适应于short 或float 取决于编译器标志），但没有用fixed 重新测试，因为我发现它对fft->ifft 系列没有用。

我很想知道你是否成功，请告诉我！

（请注意，此代码遵循 libgdx，受 Apache 2.0 许可！）

```
#include <com.badlogic.gdx.audio.analysis.KissFFT.h>

#include <kissfft/kiss_fftr.h>
#include <stdlib.h>
#include <stdio.h>
#include <math.h>

struct KissFFT
{
    kiss_fftr_cfg forwardConfig;
    kiss_fftr_cfg inverseConfig;
    kiss_fft_cpx* spectrum;
    int numSamples;
    int spectrumSize;
};

JNIEXPORT jlong JNICALL Java_com_badlogic_gdx_audio_analysis_KissFFT_create(JNIEnv* env, jclass clazz, jint numSamples) {

    KissFFT* fft = new KissFFT();
    fft->forwardConfig = kiss_fftr_alloc(numSamples,0,NULL,NULL);
    fft->inverseConfig = kiss_fftr_alloc(numSamples,1,NULL,NULL);
    fft->spectrum = (kiss_fft_cpx*)malloc(sizeof(kiss_fft_cpx) * numSamples);
    fft->numSamples = numSamples;
    fft->spectrumSize = numSamples/2+1;
    return (jlong)fft;
}

JNIEXPORT void JNICALL Java_com_badlogic_gdx_audio_analysis_KissFFT_destroy(JNIEnv* env, jclass clazz, jlong handle) {

    KissFFT* fft = (KissFFT*)handle;
    free(fft->forwardConfig);
    free(fft->inverseConfig);
    free(fft->spectrum);
    free(fft);  
}

JNIEXPORT void JNICALL Java_com_badlogic_gdx_audio_analysis_KissFFT_spectrum(JNIEnv* env, jclass clazz, jlong handle, jfloatArray obj_samples, jfloatArray obj_mags) {

    kiss_fft_scalar* samples = (kiss_fft_scalar*)env->GetPrimitiveArrayCritical(obj_samples, 0);
    float* mags = (float*)env->GetPrimitiveArrayCritical(obj_mags, 0);

    KissFFT* fft = (KissFFT*) handle;

    kiss_fftr(fft->forwardConfig, samples, fft->spectrum);

    for(int i=0;i<fft->spectrumSize;i++) {
        mags[i] = hypotf(fft->spectrum[i].r,fft->spectrum[i].i);
    }

    env->ReleasePrimitiveArrayCritical(obj_samples, samples, 0);
    env->ReleasePrimitiveArrayCritical(obj_mags, mags, 0);
}

JNIEXPORT void JNICALL Java_com_badlogic_gdx_audio_analysis_KissFFT_inverse(JNIEnv* env, jclass clazz, jlong handle, jfloatArray obj_samples) {
    kiss_fft_scalar* samples = (kiss_fft_scalar*)env->GetPrimitiveArrayCritical(obj_samples, 0);

    KissFFT* fft = (KissFFT*)handle;

    kiss_fftri( fft->inverseConfig, fft->spectrum, samples );

    for(int i=0;i<fft->numSamples;i++) {
        samples[i] = samples[i] / (float)fft->numSamples;
    }

    env->ReleasePrimitiveArrayCritical(obj_samples, samples, 0);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T20:05:03.730

请参阅[我](https://stackoverflow.com/questions/10934378/kissfft-kiss-fftr-to-kiss-fftri-how-to-reconstruct-the-original-signal)对类似问题的回答。

或来自 Kissfft 自述文件：

```
        问：为什么我没有得到我期望的输出？
        答：这两个最常见的原因是
                1）缩放：你得到的和你想要的之间是否有一个恒定的乘数？
                2) 混合构建环境——所有代码必须使用相同的预处理器编译
                FIXED_POINT 和 Kiss_fft_scalar 的定义

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T22:24:17.473

哎呀！发现了问题。我应该一直对短数组进行逆变换：

```
kiss_fftri( fft->inverseConfig, fft->spectrum, shortSamples ); 
```

# c# - 如何读取 log4net 配置文件并记录到 inetpub/wwwroot 文件夹中的日志文件？

> ID：10957607
> 
> 赞同：0
> 
> 时间：2012-06-09T01:03:45.047
> 
> 标签：c#, wcf, web-services, iis, log4net

我正在使用 WCF Web 服务项目并使用 log4net，但除非我使用位于某个安全目录（如 C:\temp）中的外部 log4net 配置文件并创建日志，否则无法将其写入日志在某些安全目录中，例如 C:\temp。

我所说的“安全”目录实际上是任何不在 C:\users 或 C:\inetpub\wwwroot 下的目录。如果我尝试将 log4net 配置文件或日志本身放在`C:\inetpub\wwwroot\<projectName>`部署我的服务的文件夹中，它什么也不做（没有错误，只是没有创建日志，也没有任何反应）。但是，如果我从 C:\temp 下的 log4net 配置文件加载配置，并将我的日志写入 C:\temp，它就可以正常工作。

我不想使用 C:\temp，但我希望日志位于部署服务的 inetpub 中，就在 web.config 中。我知道这显然是用户权限问题，但可以做些什么呢？

另外，我无法让它从 web.config 文件中读取任何 log4net 配置；这就是为什么我首先尝试使用外部 log4j 配置文件。

我在这里阅读了很多帖子，并按照他们的说明进行了设置。我只需要朝着正确的方向推动为 IIS 托管的 WCF Web 服务存储 log4net 配置的最佳实践，以及我可以做些什么来存储我的登录`wwwroot/<myprojectfolder>`

我读过的帖子之一是这个... [IIS 7.5 托管的 WCF 中的 log4net 没有写入日志文件](https://stackoverflow.com/questions/7854656/log4net-in-wcf-hosted-by-iis-7-5-no-write-log-file)

这是我到目前为止所得到的......

在 AssemblyInfo.cs 文件中，我有以下内容。我尝试了两种指定配置文件的方法，以及让它尝试通过不指定配置文件来使用 web.config 的方法。

```
//[assembly: log4net.Config.XmlConfigurator(ConfigFile = "log4net.config", Watch = true)]
[assembly: log4net.Config.XmlConfigurator(Watch = true)] 
```

在我必须手动添加的 Global.asax 中，我有以下内容。如果我在调用 Configure() 时在 C:\temp 之类的安全目录中指定一个文件，则它可以工作...

```
XmlConfigurator.Configure(); 
var logger = LogManager.GetLogger(typeof(Global)); 
logger.Info("Starting up services"); 
```

在我的服务实现文件中，我有这个......

```
private static readonly log4net.ILog logger = log4net.LogManager.GetLogger
                (System.Reflection.MethodBase.GetCurrentMethod().DeclaringType); 
```

有任何想法吗？

编辑

我正在为我的开发盒使用带有 VS2008 的 Windows 7 Pro x86，并在本地 IIS 上进行部署。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:20:21.347

我是个傻瓜……我在这方面工作了太久，最后问了一个 StackOverflow 问题，仅仅通过问这个问题，我一定是在脑子里敲了一些东西，这让我想只是获得权限。

我通过向我的 IUSR、NETWORK SERVICE 和 IIS_IUSRS 用户授予部署我的服务的文件夹的写入和修改权限来解决此问题。瞧，它起作用了。

不确定所有这些用户都需要权限，但至少其中一个需要。

总之，问题解决了。

希望这对其他人有所帮助，并且无论如何都支持 SO 社区如此棒。

# version - 最新的 WebSphere MQ 客户端版本是什么？

> ID：10957612
> 
> 赞同：7
> 
> 时间：2012-06-09T01:04:22.273
> 
> 标签：version, ibm-mq

我在 IBM 网站上看到了 7.0.1.8 的下载，但同时我也看到了 7.1.0.1。我没有看到 7.1.0.1 客户端的下载...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T01:13:53.547

WMQ 客户端以[SupportPacs](http://ibm.co/SupptPacs)的形式提供。您可以下载以下内容之一：

*   WMQ V7.0 客户端 == SupportPac MQC7 -**不再支持撤回**
*   WMQ V7.1 客户端 == [SupportPac MQC71](http://ibm.co/SupptPacMQC71)
*   WMQ V7.5 客户端 == [SupportPac MQC75](http://ibm.co/SupptPacMQC75)
*   IBM MQ V8.0 客户端 == [SupportPac MQC8](http://www.ibm.com/support/docview.wss?uid=swg24037500)
*   IBM MQ V9.0 客户端 == [SupportPac MQC9](http://www.ibm.com/support/docview.wss?uid=swg24042176)

请务必使用您正在使用的客户端版本的知识中心！

*   [WMQ V7.0.1 知识中心](https://www.ibm.com/support/knowledgecenter/SSFKSJ_7.0.1/com.ibm.mq.helphome.v70.doc/WelcomePagev7r0.htm)
*   [WMQ V7.1 知识中心](https://www.ibm.com/support/knowledgecenter/SSFKSJ_7.1.0/com.ibm.mq.helphome.v71.doc/WelcomePagev7r1.htm)
*   [WMQ V7.5 知识中心](https://www.ibm.com/support/knowledgecenter/SSFKSJ_7.5.0/com.ibm.mq.helphome.v75.doc/WelcomePagev7r5.htm)
*   [WMQ V8.0 知识中心](https://www.ibm.com/support/knowledgecenter/SSFKSJ_8.0.0/com.ibm.mq.helphome.v80.doc/WelcomePagev8r0.htm)
*   [WMQ V9.0 知识中心](https://www.ibm.com/support/knowledgecenter/SSFKSJ_9.0.0/com.ibm.mq.helphome.v90.doc/WelcomePagev9r0.htm)

# algorithm - 投票系统的用户奖励/业力/声誉算法

> ID：10957621
> 
> 赞同：0
> 
> 时间：2012-06-09T01:08:15.557
> 
> 标签：algorithm

我计划为我的公告板引入一个投票系统，并且我正在寻找一种良好且有效的算法来奖励用户。我正在考虑的投票系统非常简单。让我给你解释一下。

*   用户发表的每个帖子只能被董事会上的其他所有用户投票赞成或反对一次。用户不能投票给自己的帖子。
*   赞成票需要 1 分，反对票需要 2 分（只是为了避免简单的抨击和围攻）。
*   每 X 天，板上的每个用户都会收到 A 点数，用于上下投票，投票基于一个简单的公式：

    ```
    A = 5 + AwardUserPerformance();
    Where AwardUserPerformance() is a function that returns a value between 0 and 10 depending on the performance of the user during the past X days. 
    ```

我可以在 AwardUserPerformance() 函数中使用以下变量来计算用户的表现：

1.  T = 用户在过去 X 天内在线花费的时间
2.  P = 用户在过去 X 天内发表的帖子数
3.  V = 过去 X 天内对用户帖子的反对票和赞成票的总和（例如，如果用户收到 3 次赞成票和 2 次反对票，则 V=1）

我只是想不出一个好的算法来从这些变量中获取 0 到 10 之间的数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T05:23:16.903

这不是一个微不足道的问题，而且我认为您无法获得“完美的独特答案”，因为您想要的功能在很大程度上取决于您希望奖励如何发挥作用。

最明显的方法是找到一种将每个指标标准化为 0（糟糕）和 1（完美）之间的方法。然后，您可以在每个度量上获得 0 到 1 之间的分数，将它们相乘，然后乘以 10，得到一个定义在 0 到 10 之间的数字。时间会相当容易（0 = 没有花费时间, 1 = 在线花费的全部时间），另外 2 个需要设置一些最小和最大阈值，截断上面的所有内容。例如：10 个或更多帖子 = 1，0 个帖子 = 0，中间是 n 个帖子 / 10。

不过，这也有问题。首先，由于乘法效应，3 个中的任何一个为 0 都会使总分归零。更一般地说，很难获得高分，因为任何维度的低分都会严重影响总分。然后，设置界限要么是任意的（您决定最小值和最大值是多少），要么有些复杂（例如，您可以根据观察到的用户帖子数来确定最大值，并选择 90% 的分位数作为您的最大界限） . 这是一个问题的原因是边界将取决于您网站上的活动。如果您从 100 个用户开始，获得 99 个支持将非常困难。一旦你达到 100 万用户，这将变得更容易，奖励系统应该（可能）调整到这一点。

除了使用普通线性函数之间的乘法，您可以使用任何将每个度量映射到 [0; 1]。例如，具有递减斜率的函数（如日志）将为中等活跃用户提供“简单点”，但获得高分会更难。这是我建议使用 Excel 的其中一种情况，以可视化各种功能会发生什么。

或者，为了避免乘法问题，您可以使用可分离函数，并以时间分数 + 帖子分数 + 投票分数来打破总分。在这种情况下，您只需要这些函数中的每一个都从 0 开始，并且它们的最大值必须总和为 10。

但是，我认为最好的系统只是使用收到的选票。它可能与其他 2 个相关（不发帖就不能投票，不上网就不能发帖）。

# javascript - 类上的 Javascript 事件处理程序 - 它们的效率如何？

> ID：10957626
> 
> 赞同：1
> 
> 时间：2012-06-09T01:09:33.873
> 
> 标签：javascript, class, event-handling

我曾经在通过 AJAX 创建给定类的每个元素时为其分配一个单独的事件处理程序，如下所示：

`$('#newId').on('click', function (e) {...`

我已更改为适用于所有元素的类的一个处理程序，如下所示：

`$('#container').on('click', '.myClass', function (e) {...`

我一直想知道当处理程序被触发时这到底是如何工作的，以及性能影响可能是什么。进一步来说，...

元素究竟是如何找到类处理程序的？这比每个元素一个处理程序慢吗？该类真的只有一个事件处理程序，还是以某种方式为类中的每个元素复制它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:29:40.460

正如评论中提到的，每种方法都有优点和缺点。

当您有一个带有子元素来来去去的容器时，事件委托通常很好。想象一个带有编辑/删除按钮的大型无序列表。单击删除按钮时，您很可能会删除它的父 li。如果没有事件委托，您将负责解除绑定在这些元素上的任何事件处理程序的绑定。

事件委托使用 DOM 的事件冒泡属性。当 #container 的子级上触发 click 事件时，该事件将在节点树中冒泡，一路搜索事件的处理程序。然后测试事件目标以查看它是否与选择器匹配。如果是这样，则调用绑定的单击处理程序。如果没有 jQuery，这可能看起来像......

```
function myclass_click_handler() {
    // an element with myClass has been called
}

document.getElementById('container').addEventListener('click', function(e) {
    if (e.target.className.indexOf('myClass') > -1) {
        myclass_click_handler();
    }
}); 
```

事件委托的缺点之一是它不适用于所有事件。从性能的角度来看，它实际上可以提高性能，因为内存泄漏的机会更少。

当基于类直接为元素分配回调时，每个元素都会获得对回调函数的引用。如果您需要随后删除任意数量的这些元素，则需要取消绑定这些元素的事件处理程序。当您使用 remove() 方法时，jQuery 通过删除绑定的事件处理程序来帮助解决这个问题。

希望这可以帮助！

# javascript - ASP.NET 检查数据库中是否存在电子邮件的最佳方法

> ID：10957627
> 
> 赞同：2
> 
> 时间：2012-06-09T01:09:35.670
> 
> 标签：javascript, asp.net, ajax, jquery

我们有一个 asp.net 网络应用程序，我们目前使用用户注册页面上的更新面板来检查用户是否存在。这样做有几个问题

1-更新面板很慢

2-当用户切换到下一个文本框时，焦点会丢失，因此用户必须手动返回该框，当更新面板在弹出窗口中时，情况会更糟

3-即使它不刷新页面，页面加载方法仍然会被调用，当我只需要调用触发的事件时。

我们使用 web 表单而不是 asp.net mvc

我们的问题是执行此操作的最佳方法是什么：检查用户名是否已经存在。

客户端：常规 JavaScript、JQuery、JSON，还有其他可能性吗？服务器端检查用户是否存在：另一个 aspx 页面、Web 服务、其他可能性？

还有哪些其他技术是可能的，或者你们使用的是什么？

提前致谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T01:15:46.253

这是一个来自客户端的示例：http: [//jsfiddle.net/HackedByChinese/XPd2G/2/](http://jsfiddle.net/HackedByChinese/XPd2G/2/)

我创建了一个名为 的简单插件`delayedkeyup`，它会在用户几毫秒后停止输入后触发一个事件。当事件触发时，我会进行 ajax 调用（在示例中，它是一个模拟的 JSON 端点；您可以将其替换为对 Web 服务的调用，或者用 标记的页面方法`WebMethod`，它会执行简单的 DB 查找）。ajax 调用返回一条 JSON 消息，指示电子邮件是否有效。

我为结果添加了一个视觉指示器（绿色轮廓是好的，红色是坏的）。您可以将其替换为您使用的任何验证方案，或显示一条消息，等等。

注意：如果您不喜欢使用delayedkeyup 进行验证，您可以将其替换为`.blur`or `.change`，因此当用户单击或从文本框中跳出选项卡或更改值（分别）时，就会完成查找。

`WebMethod`可能看起来像这样：

```
[WebMethod]
public string ValidateEmail(string email)
{
   var valid = IsEmailValid(email); // your validation routine
   return string.Format("{{ \"validEmail\":{0} }}", valid.ToString().ToLower());
} 
```

# ios - RestKit + CoreData：只有远程保存成功后，如何在本地保存对象？

> ID：10957628
> 
> 赞同：5
> 
> 时间：2012-06-09T01:09:37.893
> 
> 标签：ios, core-data, restkit

我在 iOS 5.0 部署目标上使用带有 Core Data 的 RestKit 0.10.1 来构建一个与自定义 RESTFul API 接口的应用程序。由于离线连接很重要，我在设备上的本地 CoreData 数据库中维护用户数据的缓存。

现在，RestKit 非常棒，设置一个 RKFetchResultsTableController 来轻松显示和保存我的数据非常容易。但是，RestKit 的一种行为似乎并不理想，我不知道如何更改。

我有一个名为“录音”的模型。要创建新的录音，我正在执行以下操作：

```
 Recording *r = [NSEntityDescription insertNewObjectForEntityForName:@"Recording" inManagedObjectContext:[[RKObjectManager sharedManager].objectStore managedObjectContextForCurrentThread]];

 r.name = newName; 

[[RKObjectManager sharedManager] sendObject:r toResourcePath:@"/recordings" usingBlock:^(RKObjectLoader *loader){
        loader.delegate = self; 
        loader.method = RKRequestMethodPOST;
        loader.serializationMIMEType = RKMIMETypeJSON;  

        loader.serializationMapping = [RKObjectMapping serializationMappingUsingBlock:^(RKObjectMapping *serializationMapping){
            [serializationMapping mapAttributes:@"name", nil];

        }];

        RBMappingProvider *mappings = (RBMappingProvider *)[[RKObjectManager sharedManager] mappingProvider];
        loader.objectMapping = [mappings recordingObjectMapping];

    }]; 
```

这将创建一个“记录”类型的新实体，然后在 POST 请求中将该实体发送到服务器。在成功的情况下，这很有效。

但是，问题是服务器有时会合法地拒绝这些创建。在这些情况下，我发现 Core Data 数据库中已经有一个实体的本地副本，其 id 为 0（id 是服务器设置的主键）。

删除本地实体的唯一方法是强制从服务器刷新本地数据。

有没有办法仅在服务器以 2xx 响应时将对象保存在本地？或者，如果服务器响应的不是 2xx，是否有办法撤消更改？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T17:15:28.073

Unfortunately, because Recording is an NSManagedObject, even your temporary instance needs to be inserted into the managed object context. @Mundi's solution of maintaining the reference and deleting it from the context after the error is the solution I would use. A bit of extra code beats a full refresh from the server.

Upgrading to 0.20.x will make this easier. The success and failure blocks that are used when sending a request make it very easy to keep this reference and delete it on failure. For example:

```
[_objectManager postObject:aMessage
                      path:@"message"
                parameters:parameters
                   success:^(RKObjectRequestOperation * operation, RKMappingResult * mappingResult){
                     // Success code here
                   }
                   failure:^(RKObjectRequestOperation * operation, NSError * error){
                     [_managedObjectContext deleteObject:aMessage];
                     [_managedObjectContext save:nil];
                   }]; 
```

# php - 冗余信息摄入

> ID：10957629
> 
> 赞同：0
> 
> 时间：2012-06-09T01:09:51.053
> 
> 标签：php, database, redundancy

**当前情况：**目前我有几十个网站将 html 表单数据发送到收集服务器。该收集服务器随后将数据重新发送到处理服务器。处理服务器宕机并不是什么大不了的事，但丢失表单数据意味着失去我的工作。

**目标：**我想确保没有单点故障会阻止收集 html 表单数据。

**可能的解决方案：**我的想法是拥有 3 台服务器，然后将 html 表单数据从网站发送给每个服务器。我想要某种方法来确保只有一个潜在客户副本从收集服务器传递到处理服务器。

```
#Users fill Form Data  It is Captured Redundantly  And processed here
website01    ->        collectionServer01    ->    processingServer
website06              collectionServer02
website24              collectionServer03
website#N 
```

我认为这称为分布式队列？

**问题：**假设这是我描述的分布式队列，这是实现我的目标的好方法吗？人们还有其他方法吗？您如何建议确保只有一份副本从 collectionServers 发送到 processingServer？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T01:23:38.210

如果我正确理解你的问题，你有这样的事情

```
Some Website

Another Website                Intake Server               Processing Server
                                (reliable)                    (unreliable)
Yet Another Website 
```

（客户？）线索从许多不同的网站流向您的接收服务器，然后被转发到处理服务器。您担心您的 Intake Server 出现故障，因为那是您负责跟上的。

这个问题的经典解决方案是在负载均衡器后面有 2 个或更多 Intake Server，并拥有一个 Master 和至少一个 Slave 数据库。

如果您丢失数据中心（还记得日本的海啸吗？），为了避免丢失服务的风险，请在多个数据中心运行您的设置，并使用地理负载平衡将流量发送到最近的数据中心，或者如果它失败了, 到其他数据中心之一。

在这种情况下，您可能希望在各个数据中心之间复制所有数据（例如，主/主数据库，具有本地从属以实现冗余，或者数据中心 A 中的主数据库加上数据中心 A 中的从属数据库以及数据中心 B 中主数据 A 的从属数据库） ， ETC。）。

我多次成功地使用了这种安排。有些服务以非常可靠的方式管理地理负载平衡（尽管它们并不便宜）。

如果 Intake Server 出现故障，负载平衡器会检测到这种情况并将流量路由到剩余的 Intake Server。如果 Master 数据库出现故障，则切换到 Slave 数据库并恢复 Master。

对于负载平衡，这里有一些[一般信息](http://en.wikipedia.org/wiki/Load_balancing_%28computing%29)。[我在使用NGinX](http://wiki.nginx.org/Main)和 HAProxy 作为负载平衡器 方面拥有丰富的经验。

如果您将所有数据发送到所有数据中心，那么当您考虑可能会丢失一个或多个数据中心时，协调哪个数据中心发送哪个导致处理服务器的任务非常重要（您怎么知道它发送了哪个数据中心？在它崩溃之前？你如何决定哪个数据中心应该发送哪个潜在客户？）。即使您有一个“主”数据中心和一个“热备用”数据中心，如果“主”出现故障，知道“热备用”需要在哪里工作也不是一件容易的事，如果他们不要像使用复制数据库解决方案那样不断地同步状态。

其中一位评论者（几次）提到可以使用分布式队列来解决这个问题。这也是一条可行的路线，但与我描述的解决方案相比，我的经验较少。

# ruby-on-rails - 有没有办法让 rake 从命令行显示任务的源代码？

> ID：10957631
> 
> 赞同：0
> 
> 时间：2012-06-09T01:10:25.400
> 
> 标签：ruby-on-rails, rake

`rake -T`可以使用或使 rake 显示所有可用任务`rake --tasks`。但是是否有可能在不四处寻找的情况下追踪这些任务的来源，或者更好的是，让 rake 为您显示任务来源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T01:10:26.197

当我输入这个时，我注意到它`rake --help`提供了两个具有相同描述的选项：

```
-D, --describe [PATTERN]         Describe the tasks (matching optional PATTERN), then exit.
-W, --where [PATTERN]            Describe the tasks (matching optional PATTERN), then exit. 
```

事实证明，它`rake -W <task>`确实输出了任务源的位置，尽管它看起来像是从堆栈跟踪中挑选出来的。

这回答了第一个问题。有谁知道是否可以直接从命令行打印任务源？

# flash - Adobe AMF 有时需要很长时间才能连接

> ID：10957635
> 
> 赞同：2
> 
> 时间：2012-06-09T01:11:18.393
> 
> 标签：flash, blazeds, amf

我的系统由 Flash Player 11.2.202.235、Robotlegs 1.4、Spring BlazeDS Integration 1.5（Spring 3.0、BlazeDS 4.0）和 Tomcat 6 组成。

当我的 Flash 应用程序请求 AMF 时，有时 (5%) 需要很长时间才能连接（例如 9.31 秒），如下所示，但大多数时间都非常快（< 百毫秒）。有时它会超时（我看到后端收到[flex.messaging.messages.CommandMessage PING，操作 5](https://stackoverflow.com/a/7502898/418439)）。

```
[BlazeDS]Deserializing AMF/HTTP request
Version: 3
  (Message #0 targetURI=null, responseURI=/1)
    (Array #0)
      [0] = (Typed Object #0 'flex.messaging.messages.CommandMessage')
        operation = 5
        correlationId = ""
        body = (Object #1)
        clientId = null
        messageId = "7C282B73-AC5A-D9DD-B77E-CCE10B1B479C"
        timeToLive = 0
        destination = ""
        timestamp = 0
        headers = (Object #2)
          DSId = "3A4FF978-3019-7B33-DF82-5A20F6187A7D"
          DSMessagingVersion = 1

[BlazeDS]Serializing AMF/HTTP response
Version: 3
  (Message #0 targetURI=/1/onResult, responseURI=)
    (Externalizable Object #0 'DSK')
      (Object #1)
        DSMessagingVersion = 1.0
        DSId = "3A4FF978-3019-7B33-DF82-5A20F6187A7D"
1.33917226495E12
(Byte Array #2, Length 16)
(Byte Array #3, Length 16)
(Byte Array #4, Length 16) 
```

我的问题：

1.  为什么连接需要这么长时间？（**更新**：我用Wireshark监控，有些请求直到9秒才发出）这不是第一个请求。
2.  我对 CommandMessage 的回复是否正确？我没有明确处理它。它是由 BlazeDS 处理的吗？

![在此处输入图像描述](../Images/7d3a931508d0049d7f747c08de6b6c0a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T06:48:24.623

我会升级到Tomcat7 for blazeds 4.0。响应“1/onResult”是正确的。

# ruby-on-rails - Rails 3无法访问服务器上的日志文件

> ID：10957645
> 
> 赞同：0
> 
> 时间：2012-06-09T01:14:36.880
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, production-environment

我正在将我的 Web 应用程序部署到我的服务器上，并且一切正常，除了我找不到摆脱以下错误消息的方法。在部署之前，我的日志中有一个 development 和 production.rb 文件，但是当推送到服务器时，那里什么都没有，我无法创建它。我一直在寻找其他解决方案，但到目前为止没有任何效果，我该如何解决这个错误？

```
Rails Error: Unable to access log file. Please ensure that
/var/www/websites/public/appname/releases/20120608236602/log/production.log
exists and is chmod 0666\. The log level has been raised to WARN and
the output directed to STDERR until the problem is fixed. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:19:29.127

正如该错误消息所述，日志记录进程无法访问日志文件。这将是由于对 `/var/www/websites/public/appname/releases/20120608236602/log`.

您可以使用以下命令更改该目录的权限：

```
chmod -R 0666 /var/www/websites/public/appname/releases/20120608236602/log 
```

# c# - 如何在第一个视频结束之前使用 mediaElement 加载下一个视频？

> ID：10957646
> 
> 赞同：1
> 
> 时间：2012-06-09T01:15:33.157
> 
> 标签：c#, .net, wpf

我有一个视频，我想永远重复这个视频；但是，我希望视频在完全结束之前重复播放。不幸的是，该事件`MediaEnded`仅在视频完成视频时触发。我正在寻找某种事件，如结束、播放或类似的东西来执行此操作。

```
string VideoFileLocation = sVideoLocation + @"\video\";
DirectoryInfo df = new DirectoryInfo(VideoFileLocation);

media_Figura1.Source = new Uri(VideoFileLocation + @"\Figuras_loop.mov");
media_Figura1.LoadedBehavior = MediaState.Manual;

if (df.Exists)
{
    media_Figura1.Play();
}
else
{
    System.Windows.Forms.MessageBox.Show("No se puede cargar el video loop (Figura1)", "Casino Krown");
}

private void media_Figura1_MediaEnded(object sender, RoutedEventArgs e)
{
    media_Figura1.UnloadedBehavior = MediaState.Manual;

    if (bLoop_1Figura)
    {
        TimeSpan ts = new TimeSpan(0, 0, 0, 0, 0);
        media_Figura1.Position = ts;
    }
} 
```

我还想在视频结束时保留视频的最后一帧，而不是默认的黑屏。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:24:56.540

为了更轻松的解决方案，您可以拥有 2 个视频、2 个 mediaElements，并且在第一个 videoEnded 时，重复两个 mediaElementes 媒体文件，并且，您可以使用 bool 变量来确定视频如何在第二个视频中播放并停止第一个视频.

您可以使用[此解决方案](http://www.youtube.com/watch?v=Tk2VrFB1qSg)并阅读视频评论。

# google-maps - 谷歌地图自动完成：如何获得纬度/经度？

> ID：10957649
> 
> 赞同：40
> 
> 时间：2012-06-09T01:16:02.653
> 
> 标签：google-maps, google-maps-api-3

我正在使用谷歌地图的自动完成功能进行地理编码。它似乎返回了很多数据，但不是 lat/lng。有没有办法获取这些信息？我想将它传回我的后端应用程序以进行进一步处理。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2014-11-06T03:46:11.283

几何对象的原型中存在称为 lat() 和 lng() 的方法。因此，要获取值，只需使用以下命令：

```
var place = autocomplete.getPlace();

var lat = place.geometry.location.lat(),
    lng = place.geometry.location.lng();

// Then do whatever you want with them

console.log(lat);
console.log(lng);

console.warn('Warning: I didn\'t test this code!'); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-06-09T02:19:28.580

好的，我不熟悉地点或自动完成功能。但看起来你正在寻找的是

```
autocomplete.getPlace().geometry.location 
```

为了演示，我采用了[这个示例](https://google-developers.appspot.com/maps/documentation/javascript/examples/places-autocomplete)并添加了上面的行来创建[这个 JSFiddle](http://jsfiddle.net/yV6xv/19/)，您可以在其中输入地名，当它被选中时，会创建一个带有 LatLng 的信息窗口。

特别是它监听用户的选择，然后刷新信息窗口。

```
google.maps.event.addListener(autocomplete, 'place_changed', function() {
      infowindow.close();
      var place = autocomplete.getPlace();
       ...
      infowindow.setContent('<div><strong>' + place.name + 
        '</strong><br>' + address + "<br>" + place.geometry.location); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2019-09-07T20:10:25.940

其他答案缺少一个关键组成部分。您需要`'geometry'`在调用时包含`setFields`. 请注意，更多字段可能会花费更多。

前任：

```
// Avoid paying for data that you don't need by restricting the set of
// place fields that are returned to just the address components.
autocomplete.setFields(['address_component', 'geometry']); 
```

[查看文档](https://developers.google.com/maps/documentation/javascript/examples/places-autocomplete)

# c - 在实时图中自动缩放 y 轴

> ID：10957650
> 
> 赞同：0
> 
> 时间：2012-06-09T01:16:12.167
> 
> 标签：c

我正在尝试绘制一个实时图表，其中 x 轴从 0 到 -40，y 轴从 0 到 200000000。如何在 C 中自动缩放这个图表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:08:32.327

不确定我是否正确理解了您的问题。如果您要归档的内容是将样本放入 WxH 像素的区域，您可以缩放它们：

```
float d = max_y - min_y;
float s = (sample - min_y) / d;
int y = s * height; 
```

# php - CodeIgniter 多次上传到 2 个不同的文件夹

> ID：10957651
> 
> 赞同：0
> 
> 时间：2012-06-09T01:16:29.037
> 
> 标签：php, codeigniter, file-upload

我正在尝试进行多个文件上传，其中一个`input['file']`用于图像，另一个用于视频

这是控制器

```
public function upload(){
  $data['errorPic'] = $this->validateUpload();  
  $data['errorVid'] = $this->validateUpload2();
}

public function validateUpload(){
    if ( $_FILES AND isset($_FILES['coverImage']['name']) ){
        $config['upload_path'] = 'blogpics/';
        $config['allowed_types'] = 'png|gif|jpg|jpeg';
        $config['max_size'] = '999999';

        $this->load->library("upload",$config);

        if(!$this->upload->do_upload("coverImage")){
            return $this->upload->display_errors();
        }
    }   
}

public function validateUpload2(){
    if ( $_FILES AND isset($_FILES['video']['name'])){
        $config['upload_path'] = 'blogvids/';
        $config['allowed_types'] = 'png|gif|jpg|jpeg';
        $config['max_size'] = '999999';

        $this->load->library("upload",$config);

        if(!$this->upload->do_upload("video")){
            return $this->upload->display_errors();
        }
    }
} 
```

只有第一个被调用的函数在工作

示例：如果我首先将`validateUpload2()`函数放在函数顶部，则顶部的`validateUpload()`第一个函数正在工作，第二个没有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T03:50:56.113

谢谢大家的回复

我已经解决了

我只是再次使用初始化上传

```
$this->upload->initialize(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T01:24:57.397

它不起作用的原因是因为上传的文件在移动之前是临时的。执行 move_uploaded_file 后，将无法再访问临时文件。如果在第二个函数中调用 is_uploaded_file，它将返回 false。

查看将您写入第一个目录的文件复制到第二个文件夹。

**编辑**

看起来你改变了你的帖子。这种情况与以前不同。

这一次，看起来有两个单独的文件正在上传。

看起来它应该可以工作，但我正在研究它。我想知道这是否与上传帮助程序类的重新初始化有关。

# objective-c - 如何在objective-c ios5中设置默认删除按钮的样式？

> ID：10957652
> 
> 赞同：4
> 
> 时间：2012-06-09T01:16:42.823
> 
> 标签：objective-c, ios5

我需要在目标 c，ios5 中的 tableview 单元格上设置默认删除按钮的样式。一般的想法是假设你可以做这样的事情：

```
 UIImage *addImage = [UIImage imageNamed:@"greenButtonDark.png"];
    UIButton *addButton = [UIButton buttonWithType:UIButtonTypeCustom];
    addButton.frame = CGRectMake(0, 0, addImage.size.width, addImage.size.height);

    [addButton setImage:addImage forState:UIControlStateNormal];
    [addButton addTarget:self action:@selector(pushAddItem) forControlEvents:UIControlEventTouchUpInside];

    UIBarButtonItem *addBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:addButton] ;

    self.navigationItem.rightBarButtonItem = addBarButtonItem; 
```

上面的代码在 viewDidLoad 方法中被调用，覆盖了表头的右键。我假设系统默认添加的任何按钮都有可比性，但我不知道如何访问这个特定的按钮。

如果我没有清楚地表达这一点，我所指的删除按钮是使用此代码自动生成的...

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if(editingStyle == UITableViewCellEditingStyleDelete)
    {
        //do something when someone hits delete
    }
} 
```

如果我需要澄清任何事情，请告诉我。谢谢。

![在此处输入图像描述](../Images/c74932136ac329880c45b136c0b9b70e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T13:05:19.703

看看这个答案[iPhone UITableView - Delete Button](https://stackoverflow.com/questions/2104403/iphone-uitableview-delete-button)，它应该基本上回答了你的问题。简而言之，您可能需要继承*UITableViewCell*并覆盖*-(void)willTransitionToState:(UITableViewCellStateMask)state*和*-(void)didTransitionToState:(UITableViewCellStateMask)state*并在此处修改按钮。

另一种选择可能是子类化*UITableViewCell并自己实现删除按钮功能（识别滑动手势，在按下按钮时呈现按钮和句柄，类似于**UITableView*委托的默认方法）。

# java - 如何在 Java 中快速制作所需的布局

> ID：10957655
> 
> 赞同：0
> 
> 时间：2012-06-09T01:17:11.123
> 
> 标签：java, layout, eclipse-plugin, swt, jface

我最近从 .net 切换到 Eclipse 插件开发。在某些情况下，我的公司要求我在 Eclipse 的 SWT/JFace 中创建一些复杂的布局，但我无法按时交付，因为我习惯于通过拖动来制作布局并使用 Visual Studio IDE 放置控件。java 中是否有任何 IDE 提供这种拖放功能来创建布局？建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:48:53.710

您可能想尝试[MigLayout](http://www.miglayout.com/)。它有一种控制布局的有趣方式。文档也相对较好。

对于 IDE [WindowBuilder](https://developers.google.com/java-dev-tools/wbpro/)是一个相当不错的 Eclipse 插件。WindowBuilder Pro 支持 MigLayout。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T12:27:50.710

如果您想在 Eclipse 中轻松拖放，您必须右键单击您的 xml 文件并选择“更改布局”选项。同样选择绝对布局，它就像拖放方式一样工作！希望这可以帮助。

# android - 在我的应用中使用 Android 设备设置

> ID：10957657
> 
> 赞同：0
> 
> 时间：2012-06-09T01:18:02.277
> 
> 标签：android, settings, wifi

我在 Android 2.3 上，需要使用默认系统 Wifi 设置屏幕作为我的应用程序的一部分。我希望找到一种“包装”它的方法，因为这是配置管理器应用程序的一部分。

所以如果没有配置Wifi，用户就无法继续。有没有简单的方法来显示底部带有“下一步>”按钮的 Wifi 设置屏幕？

编辑：这基本上是不可行的。这里唯一的选择是在我的应用程序中“重新创建”wifi 设置屏幕，这很痛苦，但它确实有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:26:45.470

查看[android.provider.Settings](http://developer.android.com/reference/android/provider/Settings.html)以了解可用于启动各种设置屏幕的一系列 Intent 操作（例如，ACTION_WIFI_SETTINGS）。

```
ConnectivityManager manager = (ConnectivityManager)getSystemService(MainActivity.CONNECTIVITY_SERVICE);

        /*
         * 3G confirm
         */
        Boolean is3g = manager.getNetworkInfo(ConnectivityManager.TYPE_MOBILE).isConnectedOrConnecting();

        /*
         * wifi confirm
         */
        Boolean isWifi = manager.getNetworkInfo(ConnectivityManager.TYPE_WIFI).isConnectedOrConnecting();

        if(is3g){
            textView.setText("3G");
        }else if(isWifi){
            textView.setText("wifi");
        }else{
            textView.setText("nothing");
         //Activity transfer to wifi settings
            startActivity(new Intent(Settings.ACTION_WIFI_SETTINGS));
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T02:33:29.180

干得好

在清单中包含以下权限。

```
<intent android:action="android.settings.WIRELESS_SETTINGS"/> 
```

您可以按照意图触发 WIFI 设置屏幕。

```
startActivity(new Intent(Settings.ACTION_WIFI_SETTINGS)); 
```

# ruby-on-rails - Rails 3 中的分页问题

> ID：10957658
> 
> 赞同：1
> 
> 时间：2012-06-09T01:18:05.010
> 
> 标签：ruby-on-rails, ruby-on-rails-3, will-paginate

我目前正在开发一个我在 Rails 2 中编写的 Reddit 克隆应用程序，我正在尝试使用 Rails 3 中的新功能使其跟上速度。该应用程序非常简单，它有一个 Links 脚手架，它有`:url`, `:description`, `:points`, 和`:created_at`. 该应用程序路由到`links#submissions`您可以查看所有提交的链接并提交新链接的位置。

`paginate`在提交页面上显示链接时，我遇到了 Rails 2 中的方法的问题。我目前正在运行 Rails 3.2.3，并且我知道我需要使用 Rails 3 中的 gem （`will_paginate`我已包含在我的`Gemfile`.`localhost:3000`

```
NoMethodError in LinksController#submissions...
undefined method paginate for #<LinksController:0x00000102ff5f98> 
```

特别是在 Links 控制器的第 90 行。

这是我在**LinksController.rb**中的内容（第 90-93 行）。

```
@link_pages, @Links = paginate :links, :order => order, :per_page => 20
@header_text = case ordering
    when 'hot' then 'Top rated submissions'
when 'new' then 'Latest submissions' 
```

这不是在 Rails 3 中使用分页的正确方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T01:28:47.383

对于`will_paginate`，你应该在你的控制器中使用这样的东西：

```
@links = Link.paginate(:page => params[:page], :per_page => 20) 
```

在您看来，给定页面的链接将存储在`@links`实例变量中。您可以遍历该集合并显示链接。

要显示指向其他页面（链接）的链接，您可以在视图中的某处使用它：

```
will_paginate @links 
```

您可以在这里找到更多帮助`will_paginate`：[https ://github.com/mislav/will_paginate](https://github.com/mislav/will_paginate)

`kaminari`但是，对于 Rails 3，我更喜欢`will_paginate`. 它使用 Rails 3 范围。

它在控制器中看起来像这样：

```
@links = Link.page(params[:page]).per(20) 
```

这在视图中：

```
paginate @links 
```

您可以在此处阅读更多信息`kaminari`：[https ://github.com/amatsuda/kaminari](https://github.com/amatsuda/kaminari)

你也可以在`kaminari`这里观看 Ryan 的 Railscast：[http ://railscasts.com/episodes/254-pagination-with-kaminari](http://railscasts.com/episodes/254-pagination-with-kaminari)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T01:24:07.410

你需要在模型上调用 paginate，所以

```
Link.paginate :page => params[:page], :per_page => 20 
```

或者

```
Link.[arel query].paginate :page => params[:page], :per_page => 20 
```

应该管用。

要按创建的降序示例排序，您可以执行以下操作：

```
Link.order("created_at DESC").paginate :page => params[:page], :per_page => 20 
```

# bash - ssh 主机'历史 | tail' 不产生任何输出

> ID：10957664
> 
> 赞同：3
> 
> 时间：2012-06-09T01:19:47.313
> 
> 标签：bash, ssh

任何人都可以解释以下内容吗？当我使用 ssh 远程执行历史记录时，不会产生任何输出，甚至其他远程命令也会产生输出，并且该机器上有历史记录。

```
ssh host 'history | tail' # produces no output
ssh host 'echo foo | tail' # produces 'foo' as output
ssh host
> history | tail # produces expected output 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T01:47:47.527

非交互式 shell 不会加载历史记录。您可以使用`tail`历史记录文件 ( `~/.bash_history`) 或打开历史记录并加载它。

```
set -o history
history -r 
```

从远程主机执行此操作所需的完整命令如下：

```
ssh host 'HISTFILE=~/.bash_history; history -r; history' | tail 
```

# parsing - 如何在Powershell中解析csv中的列中的字符串

> ID：10957666
> 
> 赞同：3
> 
> 时间：2012-06-09T01:20:21.983
> 
> 标签：parsing, powershell, csv, substring

我有一个这样配置的csv：

```
PK,INV_AMT,DATE,INV_NAME,NOTE
1,123.44,634,asdfljk,TEST 12OING 06/01/2010 DATE: 04/10/2012
2,123.44,634,wet aaa,HI HOW ARE YOU 11.11 DATE: 01/01/2011
3,123.44,634,dfssdsdfRR,LOOK AT ME NOW….HI7&&& DATE: 06/11/1997
4,123.44,634,asdfsdgg,LOOK AT ME NOW….HI7&&& DATE: 03-21-2097
5,123.44,634,45746345,LOOK AT ME NOW….HI7&&& DATE: 02/18/2000 
```

如何`DATE`使用powershell解析注释列中字符串“：”之后的日期？

例如，第一行在`TEST 12OING 06/01/2010 DATE: 04/10/2012`注释列中有字符串“”。我需要`04/10/2012`从该行中解析 ' '。

我希望能够从上面的 csv 文件中读取并解析出该日期并将其添加为 csv 文件中的新列。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T11:13:43.260

拆分 Note 属性的值（默认分隔符是空格），选择最后一个元素 (-1) 并将其转换为 datetime 对象。最后，将对象返回到管道 ($_)。

```
Import-Csv test.csv | Foreach-Object { $_.Note = [datetime]$_.Note.Split()[-1]; $_} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T03:24:00.060

由于该`DATE: ##########`部分位于末尾，并且您想将其分成自己的部分，只需替换`DATE:`为`,`作品：

```
# Open files for reading/writing line by line
$reader = New-Object System.IO.StreamReader("in.csv")
$writer = New-Object System.IO.StreamWriter("out.csv")

# Copy first line over, with an extra ",DATE"
$writer.WriteLine($reader.ReadLine() + ",DATE")

# Process lines until in.csv ends
while (($line = $reader.ReadLine()) -ne $null) {
    # Get index of last occurrence of "DATE: "
    $index = $line.LastIndexOf("DATE: ")

    # Replace last occurrence of "DATE: " with a comma
    $line = $line.Remove($index, 6).Insert($index, ',')

    # Write the modified line to the new file
    $writer.WriteLine($line)
}

# Close the file handles
$reader.Close()
$writer.Close() 
```

如果 之前总是有一个空格`DATE:`，那么替换`" DATE: "`而不是`"DATE: "`可能会稍微好一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T04:34:52.220

使用正则表达式的替代方法：

```
Get-Content in.csv |
# Perform a replace on each line with the DATE: pattern. For convenience,
# eliminate preceding whitespace.
Foreach-Object { $_ -replace "\s*DATE: (\d{1,2}[-/]\d{1,2}[-/]\d{2,4}).*",",`$1" } |
Set-Content out.csv 
```

**编辑：**针对 OP 关于在日期后消除杂散字符的问题进行了更新。

# php - 使用 (strip_tags, stripslashes, trim) 清除保存 URL 的变量是否安全

> ID：10957669
> 
> 赞同：0
> 
> 时间：2012-06-09T01:21:48.670
> 
> 标签：php, url, trim, strip-tags, stripslashes

很高兴在这里发布我的第一个问题:-)

我正在运行一个 URL 缩短/重定向服务，PHP 编写的。我的目标是在我的服务中尽可能多地存储和处理有效的 URL 数据。

我注意到有时，无效的 URL 数据被处理到数据库中，包含无效字符（如 URL 末尾或开头的空格）。

我决定在存储它们之前让我的 URL-Check 机制修剪、stripslashes 和 strip_tags 值。

据我所知，这些功能不会删除任何 URL 可能具有的有效承租人。

如果我走错了方向，请纠正我或建议我。

问候..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T14:12:42.230

如果您已经在修剪传入变量，并使用其他内置 PHP 方法对其进行过滤，但仍然遇到问题，请尝试将表的排序规则更改为 UTF-8，看看这是否有助于您摆脱你提到的特殊字符。（你能贴几个例子让我们知道吗？）

# android - 在 Android 设备上访问应用程序私有目录中的 MODE_WORLD_READABLE 文件

> ID：10957679
> 
> 赞同：1
> 
> 时间：2012-06-09T01:24:16.907
> 
> 标签：android, directory

我们已经构建了一个用于收集数据（用于排球统计数据）的 Android 应用程序。此应用程序创建一个数据文件，我们最终希望将其传输到台式计算机（Windows PC 和 Macintoshes）。

我们目前将数据作为简单字符流写入默认应用程序目录（data/data/appname/files），并在创建每个数据文件时指定 MODE_WORLD_READABLE。

问题是即使数据文件是 MODE_WORLD_READABLE，我们想用来传输数据的各种实用程序也看不到数据文件。我认为问题在于他们可能对文件具有读取权限，但对存储文件的目录没有读取权限。具体来说，我无法使用 Android 设备上的 ES 文件资源管理器应用程序浏览文件，并且当我将 Android 设备作为 USB 设备连接到 PC 或 Macintosh 时，我无法浏览文件。

是我将文件写入外部目录的唯一解决方案，还是我在这里缺少关于将 MODE_WORLD_READABLE 与应用程序目录一起使用的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T11:49:22.023

应用程序基目录（通常类似于`/data/data/com.package.app`）和其中的顶级目录（`databases`、`files`、`cache`、...）的文件访问模式是`rwxrwx--x`. 对于应用程序本身以外的其他用户，相关部分是`--x`，这意味着无法读取（浏览）目录但可以遍历它们。`MODE_WORLD_READABLE`因此，如果您确切知道要查找的内容（完整路径），则可以读取文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T02:28:04.580

> 我们目前将数据作为简单字符流写入默认应用程序目录（data/data/appname/files），并在创建每个数据文件时指定 MODE_WORLD_READABLE。

AFAIK 您无法从应用程序沙箱访问文件（即 /data/data/appname/files）。如果可能，那么您可能从未使用过内容提供程序。

我在这里看到的唯一解决方案是您想要实现的任何目标都只能在**Rooted Devices上实现**

# php - 类层次结构

> ID：10957682
> 
> 赞同：0
> 
> 时间：2012-06-09T01:25:27.677
> 
> 标签：php, scope

我有以下代码，我希望返回“WORKED”，但什么也不返回。

```
class Foo {
    public function __construct() {
        echo('Foo::__construct()<br />');
    }

    public function start() {
        echo('Foo::start()<br />');

        $this->bar = new Bar();
        $this->anotherBar = new AnotherBar();
    }
}

class Bar extends Foo {
    public function test() {
        echo('Bar::test()<br />');

        return 'WORKED';
    }
}

class AnotherBar extends Foo {
    public function __construct() {
        echo('AnotherBar::__construct()<br />');

        echo($this->bar->test());
    }
}

$foo = new Foo();
$foo->start(); 
```

**路由器**：

```
Foo::__construct() <- From $foo = new Foo();
Foo::start() <- From Foo::__construct();
Foo::__construct() <- From $this->bar = new Bar();
AnotherBar::__construct() <- From $this->anotherBar = new AnotherBar(); 
```

因为我`$bar`从`Foo`类定义，并且，扩展`AnotherBar`至`Foo`，我希望得到已经定义的变量`Foo`。

我看不出有什么问题。我从哪里开始？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T01:27:44.360

该`AnotherBar`实例从未`start`调用过它的方法，因此它`$this->bar`是未定义的。

显示错误时，您会收到以下消息：

> ```
> Notice: Undefined property: AnotherBar::$bar in - on line 20  
> Fatal error: Call to a member function test() on a non-object in - on line 20 
> ```

您可以`<?php`在行后立即包含以下代码以查看所有错误：

```
ini_set('display_errors', 'on');
error_reporting(E_ALL); 
```

当然，您也可以这样做，`php.ini`这将是一个更清洁的解决方案。

# css - css 对齐标题及其下方的所有内容

> ID：10957683
> 
> 赞同：-2
> 
> 时间：2012-06-09T01:26:14.917
> 
> 标签：css

我希望对齐标题和摘要（单击下面的加号站点），如屏幕截图所示我的网站 [http://pligg.marsgibson.info/](http://pligg.marsgibson.info/) 屏幕截图 [http://i47.tinypic.com/ntn55.jpg](http://i47.tinypic.com/ntn55.jpg)

为此建议css

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T01:35:28.160

在不更改当前标记的情况下，一个简单的修复可以是：

**CSS**

```
.title h2 {
    color: #187AAB;
    font-size: 14px;
    font-weight: bold;
    margin: 4px 0 0;
    padding: 0 20px 0 32px;
    position: relative;
}
.title h2 span {
  left: 0;
  position: absolute;
} 
```

**打印屏幕：** ![在此处输入图像描述](../Images/0c906e64df2b1496a05c65961994559e.png)

* * *

我所做的是为元素提供一些左右[填充](http://www.w3.org/wiki/CSS/Properties/padding)`h2`，以限制其中文本的可用空间。

然后，为了将头像放在正确的位置，我使用了 CSS [position](http://www.w3.org/wiki/CSS/Properties/position)。

* * *

# 已编辑

要解决触发元素的问题，请在其 CSS 中添加：

```
p.trigger {
    position: relative;
    z-index: 1;
} 
```

* * *

# 已编辑

解决评论中提到的身高问题！

请参阅此工作[小提琴示例](http://jsfiddle.net/zuul/Pwvfy/1/)！

**查询**

```
// run only if elements are found
if ($('.title').size()>=1) {

  // initialize variables
  var $target = $('.title'),
      size    = 0,
      count   = $('.title').size();

  // for each element found
  $target.each(function() {

    // check the tallest element
    if (size===0) {
        size = $target.outerHeight(true);
    } else {
        sizeTMP = $target.outerHeight(true);
        size = (sizeTMP> size) ? sizeTMP : size;
    }

    // decrease the counter
    count--;

    // counter is 0, set the height
    if (count===0) {
        $target.css({ "height" : size + "px" });
    }

  });
} 
```

**Ps:**类的 CSS`display`声明`.subtext1`必须更新为：`display:inline-block`.

# java - 运行时休眠级联

> ID：10957685
> 
> 赞同：0
> 
> 时间：2012-06-09T01:27:08.610
> 
> 标签：java, hibernate

我不确定我是否以应有的方式提出问题，但我正在尝试在我的项目中创建一个新帐户，并且我希望我的 USER Entity 为该方法`CascadeType.ALL`，但仅针对此创建帐户方法。不适用于使用 USER 类的任何其他方法。

就像我想`FetchType.LAZY`在运行时使用某些特定方法一样，我在标准中实现它`criteria.setFetchType.LAZY`而不是在我的实体中。

同样，我可以`CascadeType.ALL`在我的应用程序运行时实现吗？

这是我正在应用级联的实体类，它工作正常

```
public Class UserEntity implements Serializable

    @Cascade({ CascadeType.ALL })
    @JoinColumn(name="teamId")
    private TeamEntity teamId;
} 
```

这是我使用此级联功能的方法，现在我只想将此级联功能定义在此方法中并从实体中删除

那可能吗 ？

```
public String addTeam(UserEntity userInfoEntity) throws Exception{
    Session session = sessionFactory.openSession();
    try {
        Transaction tr = session.beginTransaction();
        Criteria crit = session.createCriteria(UserInfoEntity.class); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T07:55:21.077

将级联设置为`@Cascade({ CascadeType.Save })`然后仅保存操作（仅在创建用户时发生？）将级联。

# javascript - JavaScript中直线和圆之间的碰撞检测

> ID：10957689
> 
> 赞同：7
> 
> 时间：2012-06-09T01:28:12.967
> 
> 标签：javascript, canvas, line, collision-detection, geometry

我正在寻找一个明确的答案，也许是一个函数，因为我很慢，它将确定一条线段和圆是否在 javascript 中发生碰撞（使用画布）

像下面这样的函数，如果发生碰撞，则返回 true，否则返回 false。我什至可以给你捐一个婴儿。

```
function isCollided(lineP1x, lineP1y, lineP2x, lineP2y, circlex, circley, radius) {

    ...
} 
```

我找到了很多公式，[比如这个](https://stackoverflow.com/questions/1073336/circle-line-collision-detection)，但它们超出了我的想象。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T01:56:25.867

在这里你需要一些数学：

![在此处输入图像描述](../Images/a020cda92726b145b8e1d41226c52198.png) 如果您一般不知道如何求解方程，这是基本概念。我会把剩下的想法留给你。;) 弄清楚`CD`' 的长度并不难。

如果你问如何，那就是如何： ![在此处输入图像描述](../Images/f8d0a307f8453e5e9ef0fdab4aad7eeb.png) 在 JavaScript 中查找冲突有点复杂。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-03-06T05:39:36.337

我花了大约一天半的时间使它变得完美。希望这会有所帮助。

```
function collisionCircleLine(circle,line){ // Both are objects

    var side1 = Math.sqrt(Math.pow(circle.x - line.p1.x,2) + Math.pow(circle.y - line.p1.y,2)); // Thats the pythagoras theoram If I can spell it right

    var side2 = Math.sqrt(Math.pow(circle.x - line.p2.x,2) + Math.pow(circle.y - line.p2.y,2));

    var base = Math.sqrt(Math.pow(line.p2.x - line.p1.x,2) + Math.pow(line.p2.y - line.p1.y,2));

    if(circle.radius > side1 || circle.radius > side2)
        return true;

    var angle1 = Math.atan2( line.p2.x - line.p1.x, line.p2.y - line.p1.y ) - Math.atan2( circle.x - line.p1.x, circle.y - line.p1.y ); // Some complicated Math

    var angle2 = Math.atan2( line.p1.x - line.p2.x, line.p1.y - line.p2.y ) - Math.atan2( circle.x - line.p2.x, circle.y - line.p2.y ); // Some complicated Math again

    if(angle1 > Math.PI / 2 || angle2 > Math.PI / 2) // Making sure if any angle is an obtuse one and Math.PI / 2 = 90 deg
        return false;

        // Now if none are true then

        var semiperimeter = (side1 + side2 + base) / 2;

        var areaOfTriangle = Math.sqrt( semiperimeter * (semiperimeter - side1) * (semiperimeter - side2) * (semiperimeter - base) ); // Heron's formula for the area

        var height = 2*areaOfTriangle/base;

        if( height < circle.radius )
            return true;
        else
            return false;

} 
```

这就是你的做法..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-19T17:20:55.640

Matt DesLauriers 在[https://www.npmjs.com/package/line-circle-collision](https://www.npmjs.com/package/line-circle-collision)上为这个问题发布了一个 Javascript 库。API 很简单：

```
var circle = [5, 5],
    radius = 25,
    a = [5, 6],
    b = [10, 10]

var hit = collide(a, b, circle, radius) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-01T22:00:58.607

```
function pointCircleCollide(point, circle, r) {
    if (r===0) return false
    var dx = circle[0] - point[0]
    var dy = circle[1] - point[1]
    return dx * dx + dy * dy <= r * r
}

var tmp = [0, 0]

function lineCircleCollide(a, b, circle, radius, nearest) {
    //check to see if start or end points lie within circle
    if (pointCircleCollide(a, circle, radius)) {
        if (nearest) {
            nearest[0] = a[0]
            nearest[1] = a[1]
        }
        return true
    } if (pointCircleCollide(b, circle, radius)) {
        if (nearest) {
            nearest[0] = b[0]
            nearest[1] = b[1]
        }
        return true
    }

    var x1 = a[0],
        y1 = a[1],
        x2 = b[0],
        y2 = b[1],
        cx = circle[0],
        cy = circle[1]

    //vector d
    var dx = x2 - x1
    var dy = y2 - y1

    //vector lc
    var lcx = cx - x1
    var lcy = cy - y1

    //project lc onto d, resulting in vector p
    var dLen2 = dx * dx + dy * dy //len2 of d
    var px = dx
    var py = dy
    if (dLen2 > 0) {
        var dp = (lcx * dx + lcy * dy) / dLen2
        px *= dp
        py *= dp
    }

    if (!nearest)
        nearest = tmp
    nearest[0] = x1 + px
    nearest[1] = y1 + py

    //len2 of p
    var pLen2 = px * px + py * py

    //check collision
    return pointCircleCollide(nearest, circle, radius)
            && pLen2 <= dLen2 && (px * dx + py * dy) >= 0
}

var circle = [5, 5],
    radius = 25,
    a = [5, 6],
    b = [10, 10]

var hit = lineCircleCollide(a, b, circle, radius) 
```

# java - 类循环引用的原因？

> ID：10957694
> 
> 赞同：6
> 
> 时间：2012-06-09T01:29:09.693
> 
> 标签：java, circular-reference

我知道循环引用（A 类持有 B 类，B 类持有 A 类）。但是由于我的编程不够，我很难找到使用它们的理由。我想知道人们是否可以给我一些例子并解释使用它们的充分理由。

就我而言，现在我正在查看 2D 源代码教程，用户创建了一个相互引用的 Creature 和一个 CreatureAi 类。是什么原因？我还不知道，这就是为什么我正在寻找示例并仍在阅读的原因。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T01:32:42.907

您有一个类 Company，其中包含为其工作的个人列表。集合中的每个 Individual 类实例都包含对他们工作的公司的引用。

通过这种方式，您可以轻松找出哪些人为哪些公司工作。请注意，它可能不一定是最好的设计，特别是如果使用 ORM 或文档数据库将类持久化到数据库中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-09T01:38:50.503

循环引用最明显的例子是自引用：链表、树和许多其他递归结构都需要它。

循环引用通常隐含在相关类的层次结构中，例如具有任意嵌套的 UI 元素或表达式树。

最后，循环引用的一个常见情况是双向父子关系：父级（例如 UI 面板）持有对其子级数组的引用，每个子级（例如按钮、表格等）持有对其的引用。父母。父母需要向其孩子发送主题信息，告诉他们它已启用、禁用、可见或不可见；孩子可能会通知父母需要调整大小、更改视觉状态等。

最后一个示例可能类似于您的 Creature-CreatureAI 对：它们是独立的，因为它们的关注点不同，但它们相互引用，因为它们需要在不同的任务上进行合作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T01:50:06.667

自参考或参考周期有多种原因

*   它们可能是领域模型中固有的；例如，人们的孩子也是人，文件夹包含其他内容，包括其他文件夹。自引用或循环是实现这些东西的自然方式。

*   它们可能是通用或特定于应用程序的数据结构所固有的；例如。链表由节点组成，这些节点包括对列表中“下一个”和“上一个”节点的引用，这需要 Node 类引用自身。

*   循环引用背后的推理可能是应用程序设计的基本部分。

*   或者，它可以只是一种实现便利，或者是以前重构或代码库演变的历史产物。

基本上，您需要（全面地）查看应用程序代码库以找出这些循环依赖项存在的原因......以及它们是否真的有必要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T01:40:49.470

通常它不是绝对必要的，但为与对象一起工作的代码提供了高度的便利。

其他时候，确实需要。例如，某些关系需要在代码中表示为数据结构，并且该关系是自反的。

# objective-c - 自定义 UITableViewCell 未正确出列

> ID：10957695
> 
> 赞同：0
> 
> 时间：2012-06-09T01:29:10.050
> 
> 标签：objective-c, uitableview, reuseidentifier

我有一个带有 3 个自定义 UITableViewCells 的 UITableView，我目前正在像这样出队：

```
 if (indexPath.row == 0) {
         static NSString *CellIdentifier = @"MyCell1";
         MyCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
         if (cell == nil) {
             cell = [[[MyCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
         }
         return cell;
    }
    if (indexPath.row == 1) {
         static NSString *CellIdentifier = @"MyCell2";
         MyCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
         if (cell == nil) {
             cell = [[[MyCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
         }
         return cell;
    }
    if (indexPath.row == 2) {
         static NSString *CellIdentifier = @"MyCell3";
         MyCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
         if (cell == nil) {
             cell = [[[MyCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
         }
         return cell;
    } 
```

我尝试过多种方式，但问题是即使我仍然使用不同的标识符将它们全部出列，当我滚动 tableView 时，有时我的第一个单元格出现在我的第三个单元格的位置，反之亦然。似乎有一些奇怪的缓存正在进行。

有谁知道为什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:15:45.983

由于您总是分配相同的单元类，因此您发布的代码没有意义。单元标识符不用于标识特定单元，而是用于标识您正在使用的子类。

所以将代码更改为：

```
static NSString *CellIdentifier = @"MyCell";
MyCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
     cell = [[[MyCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
}
return cell; 
```

并根据 indexPath.section 和 indexPath.row 在 willDisplayCell 中正确设置单元格内容：

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath 
```

# regex - 正则表达式：如何在 Perl 中删除字符串之间的多余空格

> ID：10957697
> 
> 赞同：6
> 
> 时间：2012-06-09T01:30:30.637
> 
> 标签：regex, perl, user-input, filehandle, removing-whitespace

我正在开发一个程序，该程序需要用户输入两个文件名。不幸的是，如果用户不遵循指定的输入格式，程序很容易中断。我想编写代码来提高它对这些类型错误的弹性。当你看到我的代码时你就会明白：

```
# Ask the user for the filename of the qseq file and barcode.txt file
print "Please enter the name of the qseq file and the barcode file separated by a comma:";
# user should enter filenames like this: sample1.qseq, barcode.txt

# remove the newline from the qseq filename
chomp ($filenames = <STDIN>);

# an empty array
my @filenames;

# remove the ',' and put the files into an array separated by spaces; indexes the files
push @filename, join(' ', split(',', $filenames))

# the qseq file
my $qseq_filename = shift @filenames;

# the barcode file.
my barcode = shift @filenames; 
```

显然，如果用户输入了错误的文件名类型（.tab 文件而不是 .txt 或 .seq 而不是 .qseq），则此代码运行可能会出错。我想要可以进行某种检查的代码，以查看用户是否输入了适当的文件类型。

另一个可能破坏代码的错误是如果用户在文件名前输入了太多空格。例如：sample1.qseq,（这里想象6个空格）barcode.txt（注意逗号后面的很多空格）

另一个例子：（假设这里有6个空格）sample1.qseq,barcode.txt（这次注意第一个文件名前的空格数）

我还想要可以删除多余空格的代码行，这样程序就不会中断。我认为用户输入必须采用以下格式：sample1.qseq、barcode.txt。用户输入必须采用这种格式，以便我可以正确地将文件名索引到数组中并稍后将它们移出。

感谢任何帮助或建议非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T02:06:16.677

处理此类问题的标准方法是使用命令行选项，而不是从 STDIN 收集输入。[Getopt::Long](http://p3rl.org/Getopt::Long)随 Perl 一起提供，并且可以使用：

```
use strict; use warnings FATAL => 'all';
use Getopt::Long qw(GetOptions);
my %opt;
GetOptions(\%opt, 'qseq=s', 'barcode=s') or die;
die <<"USAGE" unless exists $opt{qseq} and $opt{qseq} =~ /^sample\d[.]qseq$/ and exists $opt{barcode} and $opt{barcode} =~ /^barcode.*\.txt$/;
Usage: $0 --qseq sample1.qseq --barcode barcode.txt
       $0 -q sample1.qseq -b barcode.txt
USAGE
printf "q==<%s> b==<%s>\n", $opt{qseq}, $opt{barcode}; 
```

shell 将处理任何无关的空白，试试看。您需要对文件名进行验证，我在示例中使用了正则表达式。使用[Pod::Usage](http://p3rl.org/Pod::Usage)以一种更好的方式向可能会出错的用户输出有用的文档。

CPAN 上有几十个更高级的 Getopt 模块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T01:48:22.863

首先，放在`use strict;`代码顶部并声明变量。

其次，这个：

```
# remove the ',' and put the files into an array separated by spaces; indexes the files
push @filename, join(' ', split(',', $filenames)) 
```

不会做你想做的事。split() 接受一个字符串并将其转换为一个数组。Join 接受一个项目列表并返回一个字符串。您只想拆分：

```
my @filenames = split(',', $filenames); 
```

这将创建一个您期望的数组。

此函数将安全地修剪字符串开头和结尾的空白：

```
sub trim {
    my $string = shift;
    $string =~ s/^\s+//;
    $string =~ s/\s+$//;
    return $string;
} 
```

像这样访问它：

```
my $file = trim(shift @filenames); 
```

根据您的脚本，将字符串作为命令行参数传递可能更容易。您可以通过@ARGV 数组访问它们，但我更喜欢使用 GetOpt::Long：

```
use strict;
use Getopt::Long;
Getopt::Long::Configure("bundling");

my ($qseq_filename, $barcode);

GetOptions (
    'q|qseq=s' => \$qseq_filename,
    'b|bar=s'  => \$barcode,
); 
```

然后，您可以将其称为：

```
./script.pl -q sample1.qseq -b barcode.txt 
```

并且变量将被正确填充，而无需担心修剪空白。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T01:47:53.607

在例程中处理文件名数据之前，您需要[修剪](http://p3rl.org/String::Strip)空格，您可以使用另一个正则表达式检查文件扩展名，正如[Perl 中是否有正则表达式以查找文件扩展名？](https://stackoverflow.com/questions/2467016/is-there-a-regular-expression-in-perl-to-find-a-files-extension). [如果它是对您而言重要的文件的实际类型，那么使用File::LibMagicType](http://p3rl.org/File::LibMagicType)来检查它可能更有价值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T01:49:54.897

虽然我认为您的设计有点不确定，但以下方法可行吗？

```
my @fileNames = split(',', $filenames);
foreach my $fileName (@fileNames) {
  if($fileName =~ /\s/) {
    print STDERR "Invalid filename.";
    exit -1;
  }
}
my ($qsec, $barcode) = @fileNames; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-09T02:13:55.587

这是您可以使用正则表达式执行此操作的另一种方法（如果您正在读取来自 的输入`STDIN`）：

```
# read a line from STDIN
my $filenames = <STDIN>;

# parse the line with a regex or die with an error message
my ($qseq_filename, $barcode) = $filenames =~ /^\s*(\S.*?)\s*,\s*(\S.*?)\s*$/
    or die "invalid input '$filenames'"; 
```

# objective-c - 检查 UILabel 之间的距离

> ID：10957698
> 
> 赞同：0
> 
> 时间：2012-06-09T01:31:12.947
> 
> 标签：objective-c, ios, xcode, uilabel

我正在尝试制作一个代数方程混乱的游戏。我已经为方程的每个分量分配了一个出口。例如，如果等式是：

x2 + y = 2(a+b)

那么 x2（即 x 的平方）、+、y、= 和 2(a+b) 都将是它自己的出口。但是方程式会变得混乱，我希望用户将标签出口移动到正确的顺序。我启用了 touchesMoved，但我的问题在于检查等式的顺序是否正确。我会将代码包装成一个`IBAction`按钮动作，但我该如何分析文本呢？我会检查每个标签之间的偏移量吗？有没有简单的方法/API来做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:56:33.620

假设您的标签被称为`xLabel`, `plusLabel`, `yLabel`, `equalsLabel`, and `abLabel`，您可以执行以下操作：

```
NSUInteger xLeftBorder = CGRectGetMinX(xLabel.frame);
NSUInteger plusLeftBorder = CGRectGetMinX(plusLabel.frame);
NSUInteger yLeftBorder = CGRectGetMinX(yLabel.frame);
NSUInteger equalsLeftBorder = CGRectGetMinX(equalsLabel.frame);
NSUInteger abLeftBorder = CGRectGetMinX(abLabel.frame);

if(xLeftBorder < plusLeftBorder && plusLeftBorder < yLeftBorder && yLeftBorder < equalsLeftBorder && equalsLeftBorder < abLeftBorder){

    //Correct!
}

else{
    //Incorrect
} 
```

这有点笨拙，但它有效。一个更好的方法是把它放在一个函数中，每个参数都是一个要检查的标签。例如：

```
bool isCorrect = [self checkIf:xLabel isLessThan: plusLabel isLessThan: yLabel isLessThan:equalsLabel isLessThan:abLabel]; 
```

这是假设您编写的函数返回一个布尔值。

希望这有帮助！

# f# - 签名的“.NET”和“OCaml”格式

> ID：10957700
> 
> 赞同：3
> 
> 时间：2012-06-09T01:31:57.883
> 
> 标签：f#

F# 允许签名的“.NET”和“OCaml”格式。当您养成使用一种样式的习惯，然后发现无法正确格式化所需签名的情况时，这可能会令人困惑。考虑这段代码，它需要一个灵活的类型作为函数输入到 foo 的输出：

```
let foo n (bar: int -> #seq<'a>) =
    (fun () -> Vector.ofSeq (bar n))

let foobar n = Array.ofSeq([1..n])

let x = foo 10 foobar 
```

我不知道如何以 OCaml 格式表达 #seq<'a>。是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T07:00:08.010

以下编译得很好：

```
type A<'a>(x) =
    member __.Get : 'a = x
    abstract PairWith : 'b -> ('a * 'b * int)
    default __.PairWith y = x, y, 1

type B<'a>(x) =
    inherit A<'a>(x)
    override __.PairWith y = x, y, 2

let pairAB (x : #A<'a>) y =
    x, x.PairWith y

type 'a X (x) =
    member __.Get : 'a = x
    abstract PairWith : 'b -> ('a * 'b * int)
    default __.PairWith y = x, y, 1

type 'a Y (x) =
    inherit X<'a>(x)
    override __.PairWith y = x, y, 2

let pairXY (x : #('a X)) y =
    x, x.PairWith y 
```

因此，您可以猜测（然后使用 F# Interactive 确认）您正在寻找`#('a seq)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T06:24:54.320

我不完全确定您的意思，但我假设您想将类型变量放在类型名称前面，例如`'a #seq`.

根据语言规范（§5.1.5），这是不可能的，因为：

> 表单`#type`的类型是具有子类型约束的匿名类型，等效于`'a when 'a :> type`，其中`'a`是新的类型推断变量。

所以你可以这样写你的类型：`'a when 'a :> seq<'b>`.

编辑：你实际上可以使用`#('a seq)`，但它看起来很尴尬，我怀疑这是你想要的。

EDIT2：没有看到 Ramon Snir 的回答 :)。

# javascript - element.onresize 有什么用？

> ID：10957701
> 
> 赞同：0
> 
> 时间：2012-06-09T01:32:01.363
> 
> 标签：javascript, html

[MDC](https://developer.mozilla.org/en/DOM/element.onresize)声明**element**有一个名为**onresize**的属性：

> 任何元素都可以被赋予一个 onresize 属性，但是只有 window 对象有一个 resize 事件。调整其他元素的大小（例如通过使用脚本修改 img 元素的宽度或高度）不会引发调整大小事件。

如果`element.onresize`调整元素大小不会引发调整大小事件，那有什么意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:36:28.553

这取决于浏览器。

> Firefox、Opera、Google Chrome 和 Safari 中的正文、框架集、文档和窗口元素支持 onresize 事件。它们是相同的，当浏览器窗口的大小改变时它们会触发。示例 1 和示例 2 对此进行了演示。

参考：[http ://help.dottoro.com/ljorlllt.php](http://help.dottoro.com/ljorlllt.php)

# c# - 如何在 C# 中修复协议冲突

> ID：10957706
> 
> 赞同：2
> 
> 时间：2012-06-09T01:32:44.810
> 
> 标签：c#, java, wcf

我有 ac#“客户端”和一个 Java“服务器”。java 服务器有一个 wsdl 服务于客户端。到目前为止，它适用于 c# 向服务器发出请求以执行肥皂操作。我的服务器获取soap请求执行该方法并尝试将结果返回给客户端。

但是，当我将响应发送到 c# 时，我得到“服务器违反了协议。Section=ResponseStatusLine”。

我花了一整天的时间试图解决这个问题，但没有想出任何可行的方法。如果我解释我做了什么，这篇文章会很长，所以我会保持简短。

我用谷歌搜索了几个小时，一切都告诉我我的“回复线”是正确的。我尝试关闭 Skype，重新安排响应热线，添加东西，拿走东西等等。一切都无济于事。

这是一个课堂作业，所以不，我不能使用 apis 来帮助。我必须在服务器端手动完成所有操作。这意味着手动解析，手动创建soap响应和http响应。只是想在你说使用对我有用的东西之前你想知道这一点。

我什至尝试通过创建一个“模仿”c# 的 java 客户端来确保我的服务器发送正确的标头，这样我就可以看到服务器返回的内容。但是，它返回的正是我告诉它发送的内容。

我试着告诉我的 java 客户端做同样的事情，但对一个实际运行的 c# 服务，看看一个真正的服务返回什么，它返回基本相同的东西。为了安全起见，我复制了它的响应并尝试将其发送到 c# 客户端，但它仍然抛出错误。

任何人都可以帮忙吗？我已经尝试了所有我能想到的方法，包括将 useUnsafeHeaderParsing 添加到我的应用程序配置中。什么都没有工作。我发送的正是真正的服务发送的，它对我大喊大叫。我把我想要的东西寄给它，它会大喊大叫。

我发送这个：

```
"200 OK HTTP/1.0\r\n" +
"Content-Length: 201\r\n" +
"Cache-Control: private\r\n" +
"Content-Type: text/xml; charset=utf-8\r\n\r\n"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T02:06:17.437

您的错误的原因是您的状态行语法错误。根据 RFC，状态行语法是：

> 状态行 = HTTP 版本 SP 状态代码 SP 原因短语 CRLF

您以错误的方式获得了响应状态行的部分……就像错误消息告诉您的那样！

* * *

一些忠告：

*   不要试图在这个级别谈论 HTTP 或 SOAP。这些协议很复杂，并且现有的执行良好、文档良好的库可以做这种事情。使用它们，不要浪费时间重新发明轮子。

*   如果您确实想要/需要自己实现这些东西，那么阅读并理解相关规范至关重要。使用 Google 很容易找到它们。

（我不打算提供链接~~，因为那只会鼓励你浪费时间在构建相当于方形轮子马车的软件上。~~因为你需要学会自己找到和使用它们......当然.)

# jquery - 我需要在删除元素之前取消绑定 jquery 事件吗？

> ID：10957709
> 
> 赞同：47
> 
> 时间：2012-06-09T01:33:05.297
> 
> 标签：jquery, jquery-on

我有一个使用 jquery-ui-dialog 的页面。每次对话框打开时，页面内容都会使用 ajax 加载。然后它使用 jquery "on()" 绑定一些事件。当对话框关闭时，它将清空其内容。

**问题是**，我是否需要在 $.empty() 之前取消绑定“.ajax-content”上的事件？

***编辑***： **关注 1.**任何可能降低 JS 性能？如果我以这种方式清空（）数百个节点。

***关注2.***删除元素是否也会从内存中删除事件（或jquery的任何执行/评估链）？

我暂时没有对他们做任何事情。如果对话框在没有刷新页面的情况下多次打开/关闭，会导致任何问题吗？

代码如下所示：

```
<div id="jquery-dialog" class="container">
  <div class="ajax-content">
    some buttons....
  </div>
</div>

------after each ajax load------------
$(".ajax-content").on("click", ".button", function(event) {
  //handles the click
});

------on dialog close------------
$("#jquery-dialog").empty(); 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-07-17T20:07:54.317

嘿，我知道这是一个老问题，但我认为接受的答案具有误导性。

虽然说您需要取消绑定原始 JS 上的事件以避免旧浏览器（ehem IE）上的内存泄漏是正确的，但调用 remove() 或 empty() 已经为您做到了。

所以你当前对 empty() 的调用应该足够了，它不需要在 unbind() 之前

来自 jQuery 文档 ( [http://api.jquery.com/empty/](http://api.jquery.com/empty/) )

> 为了避免内存泄漏，jQuery 在删除元素本身之前从子元素中删除其他构造，例如数据和事件处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T07:39:33.593

最好解绑，但必须。

大多数浏览器都会正确处理此问题并自行删除这些处理程序。

您还可以看到[do-i-need-to-remove-event-listeners](https://stackoverflow.com/questions/6033821/do-i-need-to-remove-event-listeners)

更好的方法来处理这个问题，你可以使用 Event Delegate。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-10T12:34:15.653

Oscar 的回答是不完整的，如果在您的局部（通过 ajax 加载的视图）中您使用 .on() 附加了事件，那么您必须在 .empty() 之前调用 .off()。

查看下面的代码，如果不调用 .off()，则在调用 .empty() 时删除通过标准 .click() 处理程序在 p1.html 中分配的事件，但通过 .on() 在 p2.html 中分配的事件是每次加载部分时都不会删除并重新分配。

**索引.html**

```
<html>
<body>
<script src="ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
    <div id='spi' style="padding: 20px; border: 1px solid #666;">
    </div>
    <br/>
    <a href="p1.html" class="spi">Load Partial 1</a> | 
    <a href="p2.html" class="spi">Load Partial 2</a>
    <script type="text/javascript">
    $(document).on('click', 'a.spi' , function(e) {
        e.preventDefault();

        /* 
        !!! IMPORTANT !!!
        If you do not call .off(), 
        events assigned on p2.html via .on()
        are kept and fired one time for each time p2.html was loaded
        */

        $("#spi").off();  

        $("#spi").empty();
        $("#spi").load($(this).attr('href'));
    });
    </script>
</body>
</html> 
```

**p1.html**

```
This is the partial 1<br/>
<br/>
<br/>
<a href="javascript:void(0)" id='p1_l1'>Link 1</a>
<br/><br/>
<a href="javascript:void(0)" id='p1_l2'>Link 2</a>
<br/><br/>
<a href="javascript:void(0)" id='p1_l3'>Link 3</a>

<script type="text/javascript">
    $("#p1_l1").click(function(e) {
        e.preventDefault();
        console.debug("P1: p1_l1");
    });
    $("#p1_l2").click(function(e) {
        e.preventDefault();
        console.debug("P1: p1_l2");
    });
</script> 
```

**p2.html**

```
This is the partial 2<br/>
<br/>
<br/>
<a href="javascript:void(0)" id='p2_l1'>Link 1</a>
<br/><br/>
<a href="javascript:void(0)" id='p2_l2'>Link 2</a>

<script type="text/javascript">
    $("#spi").on('click', 'a', function(e) {
        e.preventDefault();
        console.debug( 'P2: ' + $(this).attr('id') );
    });
</script> 
```

# php - mysql连接设计和并发连接

> ID：10957714
> 
> 赞同：2
> 
> 时间：2012-06-09T01:34:23.983
> 
> 标签：php, mysql

我的应用程序将托管在共享托管服务提供商中，Mysql 并发连接数限制为 25 个。下面是我连接到数据库的代码

```
function dbConnect() {
$dbHost = 'localhost';
$dbUser = 'user';
$dbPass = 'pass';
$dbName = 'dbase';  
    mysql_connect($dbHost, $dbUser, $dbPass)or die(mysql_error());
    mysql_select_db($dbName) or die(mysql_error());
   } 
```

我的应用程序更多的是数据库查询。仅主页就有至少 20 个 mysq_query。我编写主页的方式如下

```
include 'config.php';
dbConnect(); 
```

query1 ... //获取初始变量

导致多个查询的过程变量

query2... // 处理结果

query3...// 处理结果

等等直到....

query 20...// 处理结果

我不能再最小化查询，因为大多数查询是其他查询的先决条件。我预计每天至少有 1000 个用户，并且 50% 的用户可能会同时连接或至少相隔几秒钟。

1.  在连接数据库的设计上，我会很容易达到设置的连接限制吗？
2.  php是否在查询后立即关闭连接，这意味着它在第一次查询后关闭，然后在第二次打开并在之后再次关闭，依此类推，即使我自己没有关闭连接
3.  我的假设是否正确，即上述场景自动消耗了 20 个并发连接？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T09:51:05.530

对于它的价值，对 genpet 原始帖子的问题 2\. 和 3\. 的一些答案：

1.  PHP 关闭您与 MySQL 的连接当且仅当（假设它没有打开`mysql_pconnect()`）：

    *   你打电话`mysql_close()`
    *   你到达脚本的结尾
2.  因此，如果您在同一脚本中发送 20 个查询，则仅消耗 1 个连接

一个想法突然出现在我的脑海中。考虑这种模式：

*   打开/轮询连接`*_pconnect()`
*   运行查询，处理结果
*   尽快释放连接`*_close()`
*   如果您需要稍后在脚本中查询数据库，请再次打开/轮询

这样，我相信可以解决低并发连接限制（即使我同意人们建议您的托管计划可能不适合满足您的需求）

这是理论，虽然，我还没有在现实中尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T02:07:29.847

它不会让我将此作为上面的评论发布，因此这不是答案，而是我的第一条评论的扩展（“升级您的托管计划”）

IMO，您的连接设计不正确。“die” 是一个终端功能，如果您预计会失败，则内置一个重试选项和一个用户友好的错误处理功能。此外，每次打开和关闭数据库都是时间密集型的，您可能能够比关闭并再次打开一个查询更快地压缩三个查询（但这取决于几个因素，值得其他人建议添加共享池来减轻这些因素。 ) 但我的建议是升级托管计划并“正常”开发。那么你的风格就可以了，除了使用比“死”更友好的错误屏幕:-)以及pdo或mysqli，而不是mysql_函数

# c# - 从 memorystream 打开 excel 工作簿

> ID：10957715
> 
> 赞同：14
> 
> 时间：2012-06-09T01:34:53.173
> 
> 标签：c#, .net, excel

我正在尝试从内存流中打开一个 excel 工作簿。我有一个 excel 文件的网址，我所做的是从 url 下载数据，然后将其保存到内存流中，但我不知道如何从流中打开工作簿，这是我的代码的工作原理远的。

```
WebClient wc = new WebClient();

byte[] fileArray = wc.DownloadData("url is inserted here");

MemoryStream ms = new MemoryStream(fileArray); 
```

但是从这里我不确定如何从流中读取数据以创建工作簿，它看起来不像来自[http://msdn.microsoft.com/en-us/library/ff478410](http://msdn.microsoft.com/en-us/library/ff478410)的电子表格文档以我想要的方式工作，任何帮助或指示将不胜感激

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T02:00:38.893

SpreadSheetDocument 有一个[Open](http://msdn.microsoft.com/en-us/library/cc562185)静态方法重载，它将流作为文档源的参数，只需添加到您的代码中：

```
var doc = SpreadSheetDocument.Open(ms, isEditable); 
```

# ruby-on-rails - DateTime 类的意义何在？

> ID：10957717
> 
> 赞同：4
> 
> 时间：2012-06-09T01:35:09.520
> 
> 标签：ruby-on-rails, ruby, datetime, date, time

该类`DateTime`似乎是多余的，并且在阅读了该类的 Rails 扩展文档中的这一点之后，它似乎也有潜在的危险：

> DateTimes 不知道 DST 规则，因此在创建具有本地区域偏移量的 DateTime 时使用一致的非 DST 偏移量

在 Rails 文档中也有这个`DateTime#to_time`：

> 尝试将 self 转换为 Ruby Time 对象；如果超出 Ruby Time 类的范围，则返回 self。如果 self 的偏移量不是 0，则 self 将原样返回，因为没有干净的方法将其映射到 Time。

我认为最后一部分是由于`DateTime`不识别 DST。

在我看来，我们有这个：

*   该类`Date`表示没有时间的简单日期。
*   该类`Time`表示一个特定的时间点，其中隐含包含日期。
*   该类与类`DateTime`相同`Time`，但不了解 DST，有时无法转换为常规`Time`类。

那么应该`DateTime`从代码库中删除还是它是否有我所缺少的有用目的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T04:03:23.403

`DateTime``Time`在 Rubies < 1.9.2 的 32 位机器上具有优势-`Time`是[Y2K38 问题](http://www.venombytes.com/2011/04/11/32-bits-of-ruby-in-time)的受害者，并且仅限于 32 位范围。这个问题在 64 位机器和/或最近的 Ruby 版本中得到了解决。如果`DateTime`例如 1.8 兼容性是必须的，或者您依赖使用其 API 中的方法（通常与`Time`.

# checkbox - extjs4 网格校验列

> ID：10957724
> 
> 赞同：2
> 
> 时间：2012-06-09T01:38:10.263
> 
> 标签：checkbox, grid, extjs4

我们知道，extjs4 提供了一个网格内置的检查列，但似乎这种类型只能与特殊的 bool 类型绑定。我的要求只是想在网格中显示一个复选框，不想绑定到任何字段。

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T06:13:39.390

使用[CheckboxModel](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.selection.CheckboxModel)作为网格的选择模型。基本用法：

```
var grid2 = Ext.create('Ext.grid.Panel', {
    selModel: Ext.create('Ext.selection.CheckboxModel'),
    // ...
}); 
```

请参阅[官方示例页面上的](http://dev.sencha.com/deploy/ext-4.1.0-gpl/examples/grid/grid-plugins.html)*“带复选框选择和水平滚动的框架”*示例。

# html - 在 Firefox 或 Chrome 中调试 HTML 真的这么难吗？

> ID：10957729
> 
> 赞同：0
> 
> 时间：2012-06-09T01:38:56.997
> 
> 标签：html, debugging, firefox, google-chrome, firebug

如何使用 firebug 或 Chrome 调试器来调试 html？看起来应该很容易，但我不知道该怎么做？

例如，我有`<script poo="text/javascript" src="../src/JSTweener.js"></script>`并且调试器绝不会因为我`poo`在`script`标签中有错误而发现错误。我怎样才能调试这样的东西？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T01:40:32.707

[试用 W3C HTML 标记验证器](http://validator.w3.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T01:42:34.683

使用 html 验证器来找出实际标记中的问题。ie 开发者工具栏和萤火虫都有验证 Iirc。请记住，它是标记而不是命令式代码，因此调试的概念是错误的习惯用法。

# multidimensional-array - MKL 中是否有例程以 CSR 格式转置矩阵？

> ID：10957730
> 
> 赞同：1
> 
> 时间：2012-06-09T01:39:07.587
> 
> 标签：multidimensional-array, multiprocessing, fortran90

我只需要在一个大量使用 MKL 库的程序中转置压缩稀疏行 (CSR)（存储在多个处理器上）中的方阵。我找到了一个例程，但有兴趣查看是否有 MKL 库例程。

一种看待它的方法是从 CSR 到 CSC（压缩稀疏列）格式的转换。我得到了创建 CSR 矩阵的例程；它非常复杂，我不想改变它。

谢谢！

汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T04:17:40.903

mkl 包含矩阵格式转换器。mkl_?csrcsc 将从 csr 转到 csc ，反之亦然。这是我发现以 csr 格式转置稀疏矩阵的最简单方法。

# jquery - 如何将值放在响应 jquery.ajax() 的表中的最后一个 td 中？

> ID：10957731
> 
> 赞同：1
> 
> 时间：2012-06-09T01:39:19.127
> 
> 标签：jquery, html-table

我有以下问题：

当用户想要增加你想购买的电影数量时，我做的第一件事是通过 jQuery.ajax 发送电影的 ID，这涉及到一个 php 函数来更新，然后在同一个函数中执行一个 SELECT 来获取价格运行总计，然后返回变量totalpricemovie中的值，我希望将该值放置在表的最后一列中，显示TOTAL，但不是如何：S

**这是我的窗户** ![购物橱窗](../Images/1921120d8ea9684607aa79b0b4b86b1f.png)

**jQuery 代码将 ID 电影发送到 Update 并检索 totalprice 以在列 total TOTAL($) 中更新**

```
$('.quantitymovie').live('change',function() {
        claveMovie = $(this).attr('id');

        updateQuantityMovie = {
            idmovie : claveMovie,
            tag : 'updateQuantity'
        };

        $.ajax({
            type: "POST",
            url: "./php/processFunctions.php",
            data: updateQuantityMovie,
            success: function(response) {

                if(success.response == 'success') {

                    //put update price of a movie in last td of column called Total($)
                } else {
                    alert ("Error al actualizar la cantidad de películas");
                }
            }
        });
         return false;
    }); 
```

我认为它必须做一些事情，比如获取行的索引，然后找到最后一个包含变量 totalpricemovie 的单元格。

**HTML 代码表**

```
<div id="checkOutModal">
    <fielset>
    <legend>Datos de compra</legend>
    <form id="formCheckout" name="checkOut" method="POST" action="php/processFunctions.php">
        <table id="orderCheckout">
            <th scope="col">Películas</th>
            <th scope="col">Precio ($)</th>
            <th scope="col">Cantidad</th>
            <th scope="col">Total ($)</th>
        </table>
        <p>
        <label for="nombreCliente">Nombre completo</label>
        <input id="nombreCliente" class="required onlyLetter" name="nombreCliente" type="text"/>
        </p>
        <p>
        <label for="direccionCliente">Dirección</label>
        <input id="direccionCliente" class="required" name="direccionCliente" type="text"/>
        </p>
        <p>
        <label for="emailCliente">Correo electrónico</label>
        <input id="emailCliente" class="required" name="emailCliente" type="text"/>
        </p>
        <input id="finalizarCompra" name="finalizarCompra" type="submit" value="Finalizar"/> 
        <a href="#" id="contShopping">Seguir Comprando</a>
    </form>
    </fieldset>
</div> 
```

**注意：**表格的内容是用 jquery.ajax() 中的另一个函数生成的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T01:50:20.090

这些方面的东西应该适合你。如果你给我们你的html，我可以给你一个更具体的答案。

```
$('#' + claveMovie).parent('td').next('td').html(response.totalpricemovie); 
```

此代码将获取您控件的父 td，将 dom 遍历到下一个 td，然后将该 td 的 html 设置为您的新总数。

**编辑**：

您已经知道已更改的控件的 ID。

```
$('.quantitymovie').live('change',function() {
        // The id of the movie changed
        claveMovie = $(this).attr('id');

        updateQuantityMovie = {
            idmovie : claveMovie,
            tag : 'updateQuantity'
        };

        $.ajax({
            type: "POST",
            url: "./php/processFunctions.php",
            data: updateQuantityMovie,
            success: function(response) {
                if(success.response == 'success') {
                    $('#' + claveMovie).parent('td').next('td').html(response.totalpricemovie);
                } else {
                    alert ("Error al actualizar la cantidad de películas");
                }
            }
        });

        return false;
    }); 
```

# php - PHP搜索并显示带有关键字的结果

> ID：10957735
> 
> 赞同：-2
> 
> 时间：2012-06-09T01:40:17.497
> 
> 标签：php, search, scripting

我想要做的是我有一个看起来像这样的文件：

```
Blue = 1 = No = 20,
Arctic color = 2 = No = 20,
Pink = 3 = No = 20,
Arctic blue color = 4 = No = 20,
Red = 5 = No = 20,
Orange = 6 = No = 20, 
```

假设用户在表单中输入了短语“arctic color”。我想要我的代码做的是显示所有包含“北极颜色”短语的行。所以代码应该回显：

```
Arctic color = 2 = No = 20,
Arctic blue color = 4 = No = 20, 
```

我如何做到这一点？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:48:40.210

我建议将结构化数据存储在某种数据库中。例如，mysql。然后你可以发出一个`LIKE`查询。使用左侧的通配符，这将执行全表扫描，这可能不是问题，具体取决于您拥有的行数。

如果您需要更高性能的解决方案，则需要将数据转换为更易于搜索的格式。

* * *

**如果您只想解决您的确切问题：**

要查找包含所有单词的行：

```
$query = 'arctic color';

$terms = array_filter(array_map('trim', explode(" ", $query)));
$results = array();

foreach(file('file.txt', FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES) as $line) {
    $found = true;

    foreach($terms as $term) {
        if(strpos($line, $term) === false) {
            $found = false;
            break;
        }
    }

    if($found) {
        $results[] = $line;
    }
}

print_r($results); 
```

查找包含以下单词的行：

```
$query = 'arctic color';

$terms = array_filter(array_map('trim', explode(" ", $query)));
$results = array();

foreach(file('file.txt', FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES) as $line) {
    $found = false;

    foreach($terms as $term) {
        if(strpos($line, $term) !== false) {
            $found = true;
            break;
        }
    }

    if($found) {
        $results[] = $line;
    }
}

print_r($results); 
```

# ruby - 如何在 Haml 中使用 alias_method 来转义 html？

> ID：10957736
> 
> 赞同：0
> 
> 时间：2012-06-09T01:40:18.177
> 
> 标签：ruby, sinatra, haml

我想要做的是在 Haml 视图中使用别名方法（在 ruby​​ 文件中定义）。

我定义了一个别名方法，如下所示：

```
require 'sinatra'
require 'sinatra/base'
require 'data_mapper'
require 'haml'

helpers do
  include Haml::Helpers
  alias_method :h, :html_escape
end

class App < Sinatra::Base

  use Rack::MethodOverride

  # ...

end 
```

然后我`h()`在 Haml 视图中使用了如下方法：

```
- @notes.each do |note|
  %article{:class => note.complete? && "complete"}
    %p
      =h note.content 
```

但是当我打开页面时出现错误：

> NoMethodError - # 的未定义方法“h”：
> 
> ...

当我`Haml::Helpers.html_escape()`直接在haml文件上使用时，没有问题：

```
%p
  = Haml::Helpers.html_escape note.content 
```

如何在 haml 文件中使用我的别名方法而不会出错？

感谢您对此问题的任何建议或更正。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T03:49:59.060

您的助手在应用程序中得到定义。而是像这样在您的类中定义它们：

```
class App < Sinatra::Base
  helpers do
    include Haml::Helpers
    alias_method :h, :html_escape
  end

  # ...

end 
```

或者像这样在 Base 中：

```
Sinatra::Base.helpers do
  include Haml::Helpers
  alias_method :h, :html_escape                                                                                                                    
end 
```

# c# - 如何将我自己的节点模块组合成一个模块进行部署

> ID：10957738
> 
> 赞同：0
> 
> 时间：2012-06-09T01:40:35.713
> 
> 标签：c#, node.js, requirejs, npm

我已将旧的 C# 库移植到 Node.js 中。因为原始源代码都在单独的类文件中，所以我最终得到了一堆自定义模块（参见示例）。现在我想在使用 Node.js 和 express 构建的网站中使用这个“库”。将我的“库”部署到网站文件夹结构/存储库中的最佳方式是什么？我在想我应该“构建”或将所有这些模块组合成一个模块/文件，以便在网站结构中使用。如果不手工重新制作，我怎么能做到这一点？

foo_util.js

```
GLOBAL.pi = function () {
    return 3.142;
}; 
```

foo.js

```
var util = require('./foo_util');
exports.foo = function(name){
    this.name = name;
};
exports.foo.prototype.SayHello = function(nextPart){
    return 'Hello ' + this.name;
}; 
```

bar.js

```
var util = require('./foo_util');
var foo = require('./foo');
exports.bar = function(name, age){
    this.name = name;
    this.age = (age!=0?age:pi());
};
exports.bar.prototype = new foo.foo(); 
```

test_bar.js (nodeunit)

```
var foo = require('./foo');
var bar = require('./bar');
exports.SampleTest = function(Assert)
{
    var target = new bar.bar('Bob', 0);
    var msg = target.SayHello();
    Assert.strictEqual(target.age, 3.142,"child class attribute should be set");
    Assert.strictEqual(target instanceof bar.bar, true, "should be a bar");
    Assert.strictEqual(target instanceof foo.foo, true, "should also be a foo");
    Assert.strictEqual(msg, "Hello Bob","parent method should work");
    Assert.done();
}; 
```

# iphone - 更改 uitableviewcell 突出显示不起作用

> ID：10957740
> 
> 赞同：0
> 
> 时间：2012-06-09T01:40:56.323
> 
> 标签：iphone

我使用下面的代码来更改 uitabelviewcell 的突出显示颜色

```
#import <UIKit/UIKit.h>

@interface KUITableViewCell : UITableViewCell

-(void)setSelected:(BOOL)selected animated:(BOOL)animated;
-(void)setHighlighted:(BOOL)highlighted animated:(BOOL)animated;

@end
#import "KUITableViewCell.h"

@implementation KUITableViewCell

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
    }
    return self;
}

- (void)setHighlighted:(BOOL)highlighted animated:(BOOL)animated
{
    [super setHighlighted:highlighted animated:animated];
    if (highlighted) {
        self.backgroundColor = [UIColor grayColor];
    } else 
        self.backgroundColor = [UIColor clearColor];
    }
}

@end 
```

setHighlighted 被触发，但不改变 UITableviewCell 的高度颜色

欢迎任何评论

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:00:39.273

当单元格突出显示时，它`selectedBackgroundView`显示意味着您的代码正常工作并且您正在以错误的方式进行“突出显示的颜色”更改。要查看更改的颜色，您需要更改`selectedBackgroundView`.

# javascript - 将文本动态添加到 div 的底部，并以文本为焦点滚动

> ID：10957741
> 
> 赞同：0
> 
> 时间：2012-06-09T01:41:07.130
> 
> 标签：javascript, logging, mootools

我有一个脚本，当前使用 FireBug 控制台日志显示来自一系列函数的状态消息，我想在单个 div 中显示这些日志消息，因为它们的显示方式与它们在 FireBug 中的显示方式相同。

这是底部最新的，div 将自动向下滚动，每个新行超出 div 的高度。日志窗口。

我正在使用 JS Lib - Mootools 1.4.5

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-14T06:19:59.367

我认为应该这样做。

```
var log = 'This is awesome log';

function updateLog(logText)
{
    // update logContainer
    var logContainer = $('.logContainer');
    logContainer.set('html', logContainer.get('html') + '<br>' + logText);

    // scroll logContainer to the bottom
    logContainer.scrollTop = logContainer.scrollHeight;
}

updateLog(log); 
```

# python - django-piston 中的处理程序错误

> ID：10957743
> 
> 赞同：1
> 
> 时间：2012-06-09T01:42:00.663
> 
> 标签：python, django, get, django-piston

当我为我的 django-piston 实现另一个处理程序时，我在我的 django 项目中遇到了这个错误。

```
Request Method: GET
Request URL: http://127.0.0.1:8000/api/getdata/

Django Version: 1.3.1
Python Version: 2.7.1
Installed Applications:
['admin_tools.theming',
 'admin_tools.menu',
 'admin_tools.dashboard',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'app',
 'api',
 'south']
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware',
 'django.middleware.csrf.CsrfResponseMiddleware')

Traceback:
File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py" in get_response
  101\.                             request.path_info)
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in resolve
  252\.                     sub_match = pattern.resolve(new_path)
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in resolve
  250\.             for pattern in self.url_patterns:
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in _get_url_patterns
  279\.         patterns = getattr(self.urlconf_module, "urlpatterns", self.urlconf_module)
File "/usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py" in _get_urlconf_module
  274\.             self._urlconf_module = import_module(self.urlconf_name)
File "/usr/local/lib/python2.7/dist-packages/django/utils/importlib.py" in import_module
  35\.     __import__(name)
File "/home/agileone/workspace/proj/api/urls.py" in <module>
  15\. devdata_handler = Resource(DevDataHandler)
File "/usr/local/lib/python2.7/dist-packages/django_piston-0.3dev-py2.7.egg/piston/resource.py" in __init__
  36\.         self.handler = handler()

Exception Type: TypeError at /api/getdata/
Exception Value: DevDataHandler() takes exactly 1 argument (0 given) 
```

我不知道我得到这些的原因是什么。

这是我的`api/urls.py`

```
from django.conf.urls.defaults import *
from piston.resource import Resource
from api.handlers import *

from django.http import HttpResponse
from piston.handler import BaseHandler, AnonymousBaseHandler

class CsrfExemptResource(Resource):
    def __init__(self, handler, authentication=None):
        super(CsrfExemptResource,self).__init__(handler,authentication)
        self.csrf_exempt=getattr(self.handler,'csrf_exempt',True)

data_handler = CsrfExemptResource(DataHandler)
devdata_handler = Resource(DevDataHandler)
urlpatterns=patterns('',
    url(r'^getdata/$', data_handler,  {'emitter_format': 'ext-json'}),
    url(r'^getdevdata/$', devdata_handler,  {'emitter_format': 'ext-json'})
) 
```

这是我的`api/handlers.py`

```
from django.utils import simplejson
from piston.handler import BaseHandler, AnonymousBaseHandler
from app.models import *
from django.db.models import *
from piston.utils import rc, require_mime, require_extended, validate
import datetime

class DataHandler(BaseHandler):
    allowed_method = ('GET', 'POST', 'PUT', 'DELETE')
    fields = ('title')
    model = Data

    def read(self, request): 
        data = {"msg":"Hello world"}
        return data        

def DevDataHandler(BaseHandler):
    allowed_method = ('GET', 'POST', 'PUT', 'DELETE')
    fields = ('title')
    model = Data

    def read(self, request): 
        data = {"msg":"Hi world"}
        return data 
```

如果我不包括它，它会起作用，`devdata_handler = Resource(DevDataHandler)`但我真的需要它......

有人可以帮我解决我的问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T22:55:54.310

处理程序是类，而不是函数。改变：

```
def DevDataHandler(BaseHandler): 
```

至：

```
class DevDataHandler(BaseHandler): 
```

# templates - D中的结构和元组模板参数

> ID：10957744
> 
> 赞同：7
> 
> 时间：2012-06-09T01:42:08.317
> 
> 标签：templates, d, template-meta-programming

是否可以编写一个模板函数来增加不同结构的（数字）字段？例如：

```
struct Color
{
    ubyte a,r,g,b;
}

struct Point
{
    double x, y;
} 
```

我试过这样的事情：

```
T update(T, A)(T t, A a)
if (is(T == struct))
{
    auto vals = t.tupleof;
    foreach (i; 0 .. vals.length) {
        vals[i] += a; // error: i cannot be read at compile time
    }
    return T(vals); // convert back to struct
} 
```

我也尝试过编写接受元组的函数模板，但元组总是被扩展，这会阻止编译器匹配正确的模板。谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T06:36:24.847

好吧，我想说你正在尝试做的事情很奇怪，但这当然是可能的。最天真、就地的方式可能是：

```
void update(T)(ref T t)
    if(is(T == struct))
{
    foreach(ref var; t.tupleof)
        ++var;
} 
```

使用副本执行此操作的最简单方法可能是复制它然后更新它，而不是尝试使用更新的值构造一个新的（尽管我确信如果你真的想要也可以这样做）：

```
T update(T)(T t)
    if(is(T == struct))
{
    auto copy = t;

    foreach(ref var; copy.tupleof)
        ++var;

    return copy;
} 
```

当然，这里的主要问题是对这两者的模板约束太弱了。你所要做的就是在你的结构中有不可增加的类型，它不会工作。解决这个问题的最简单方法可能是创建一个同名模板来为您测试它：

```
T update(T)(T t)
    if(isIncrementableStruct!T)
{
    auto copy = t;

    foreach(ref var; copy.tupleof)
        ++var;

    return copy;
}

template isIncrementableStruct(T)
{
    enum isIncrementableStruct = is(T == struct) &&
                                 is(typeof({T t; foreach(var; t.tupleof) ++var;}));
} 
```

如果您希望能够增加所有可增加的字段而让其他字段保持不变，您可能会执行以下操作：

```
T update(T)(T t)
    if(is(T == struct))
{
    auto copy = t;

    foreach(ref var; copy.tupleof)
    {
        static if(canIncrement!(typeof(var)))
            ++var;
    }

    return copy;
}

template canIncrement(T)
{
    enum canIncrement = is(typeof({T var; ++var;}));
} 
```

无论如何，您似乎错过的主要事情是`tupleof`在使用时尝试直接迭代，`ref`以便更新元素而不是更新它们的副本。

# security - 对于大型网站，CakePHP 真的安全吗？

> ID：10957750
> 
> 赞同：0
> 
> 时间：2012-06-09T01:44:25.053
> 
> 标签：security, cakephp-2.0

我正在计划开发一个大型网站，我需要采取一些安全措施，我现在使用的是 CakePHP 2.0.1。

我需要使用哪些插件或组件，以免我的网站被黑客入侵。

我在 CakePHP 中发现了一个漏洞，我有一个更改密码的页面，它只有 2 个字段，更改密码和重复密码，但是当我尝试通过 firebug 在更改密码中添加以下内容时，它更新了数据库中的电子邮件字段。

```
<input type="text" id="UserEmail" value="admin123" maxlength="100" class="input-xlarge span6" name="data[User][email]"> 
```

我怎样才能摆脱这些类型的黑客？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:23:05.580

根据 CakePHP [http://www.hotscripts.com/](http://www.hotscripts.com/)使用 cakephp，它们很大。

尽管大小不应该对安全性产生影响。如果你更大，你可能会受到更多的攻击。但是，无论大小如何，您都应该始终保持安全。

# jquery - jQuery 切换按钮在点击时的可见性

> ID：10957751
> 
> 赞同：2
> 
> 时间：2012-06-09T01:45:55.360
> 
> 标签：jquery, visibility

我希望在单击事件的两个按钮之间“循环”。这很简单，但我想知道是否有比我下面的更简洁的方法来实现它。

```
$('button#start').click( function() {

    $(this).addClass('hide');
    $('button#stop').removeClass('hide');

});

$('button#stop').click( function() {

    $(this).addClass('hide');
    $('button#start').removeClass('hide');

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:04:20.100

**另一个简单的演示** [http://jsfiddle.net/S4d6j/](http://jsfiddle.net/S4d6j/)

好读：可见选择器：[http ://api.jquery.com/visible-selector/](http://api.jquery.com/visible-selector/)

您可以使用`.is(":visible")`来检查哪个是可见的并隐藏另一个，我们可以链接两个按钮。

希望能帮助到你

**代码**

```
$('#start,#stop').click(function() {

    if ((this.value === "start") && $(this).is(":visible")) {        
        $("#stop").show();
    } else if ((this.value === "stop") && $(this).is(":visible")) {
        $("#start").show();
    }

    $(this).hide();

});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T02:21:09.067

这让我很烦恼，我没有缓存它`$(this)`，但这不是必需的，在我看来也不会带来任何实现的性能提升。但是，我想这将尽可能短：

```
$('#start, #stop').click(function(){
    $(this).hide();
    $(this).siblings('button').show();
}); 
```

[http://jsfiddle.net/userdude/S4d6j/1/](http://jsfiddle.net/userdude/S4d6j/1/)

所以，这取决于你的 DOM 结构和元素的位置。另一种方法可能是仅用于`this.id`确定单击了哪个，然后相应地切换值：

```
$('#start, #stop').click(function(){
    var buttons = {start: 'stop', stop: 'start'};

    $(this).hide();
    $('#' + buttons[this.id]).show();
}); 
```

[http://jsfiddle.net/userdude/S4d6j/3/](http://jsfiddle.net/userdude/S4d6j/3/)

编辑：使它更加简洁`$(this).hide()`。

处理程序中没有任何技巧、尼克松三元组或重复。很好很简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T01:58:39.060

```
$('button').click(function(e){
    $(  
         $(this).addClass('hide').attr('id') == 'start' 
              ? '#stop' 
              : '#start'
    ).removeClass('hide');
}); 
```

这将在获取 id 时隐藏按钮，如果当前 id 属性为 start，它将选择停止 id，反之亦然。它使用隐藏和显示，但您可以替换为 addClass('hide') 等

# asp.net - ASP.Net Control.ResolveUrl 怪癖

> ID：10957753
> 
> 赞同：1
> 
> 时间：2012-06-09T01:46:45.463
> 
> 标签：asp.net

我有一个奇怪的问题。解析脚本元素的 url 时，src 元素必须在 ' ' 中。对于链接元素，href 必须在“”中，否则代码块由于某种原因被渲染为 html。下面的代码片段更清楚地说明了这个问题。为什么会这样？

```
<script src='<%:Page.ResolveUrl("~/JavaScript/jQuery/jquery-1.7.2.js") %>' type="text/javascript"/>

<link href="<%:Page.ResolveUrl("~/CSS/Foundation/foundation.css") %>" rel="stylesheet" type="text/css" /> 
```

**编辑** 刚刚注意到脚本元素 src 标签在包含在“”或“”中时工作正常，但链接元素 href 标签似乎只在包含在“”中时才有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T01:56:19.437

它不起作用，因为您`:`在脚本中使用了 a 。相反，您应该这样做（它可以使用单引号和双引号：

```
<link href="<%= ResolveUrl("~/Styles/site.css")%>" rel="stylesheet" type="text/css" /> 
```

观察上面我使用了 a`=`而不是 a`:`

或者，在某些情况下，您甚至可以使用`#`if 您，例如，`Page.Header.DataBind();`在母版页的代码隐藏中调用并且您在母版页中输出您的引用`<head>`：

```
<link href="<%# ResolveUrl("~/Styles/site.css")%>" rel="stylesheet" type="text/css" /> 
```

# c# - MVC 4 - 如何将模板传递给 html 辅助方法

> ID：10957755
> 
> 赞同：4
> 
> 时间：2012-06-09T01:47:19.157
> 
> 标签：c#, asp.net-mvc, razor

我需要将所有脚本放在页面底部，问题是当我有部分视图时，我不能使用“RenderSection”方法。找到了一个很好的示例，说明如何添加一个 HtmlHelper 扩展，该扩展采用脚本文件的名称，加载到堆栈中，然后另一个助手将其呈现在基本布局上： [来自局部视图的剃刀部分包含](https://stackoverflow.com/questions/9655113/razor-section-inclusions-from-partial-view)

太好了 - 但我不想为我想要放入的一小段脚本甚至 HTML 创建一个完整的 JS 文件。而且我不想将它全部作为字符串传递，我想要漂亮的格式和智能感知，所以我想使用一个模板，即：

```
@{Html.AddScript("test", @<text>
<script type="text/javascript">
    function RefreshPreview() {
        $('#AutoReplyHtml_Preview').html(
            $('#htmlTemplate').html()
                .replace('@@MESSAGE_TITLE@@', $('#AutoReplySubject').val())
                .replace('@@PRE_HEADER@@', $('#AutoReplyPreHeader').val())
                .replace('@@MESSAGE_BODY@@', $('#AutoReplyHtml').val())
        );

        $('#AutoReplyPlainText_Preview').html(
            $('#plainTextTemplate').html()
                .replace('@@MESSAGE_BODY@@', $('#AutoReplyPlainText').val())
        );
    }

    $(document).ready(function() {
        RefreshPreview();
    });
</script>
</text>);} 
```

问题是 - 如何将模板的值放入我的方法中，我有这个符合的代码，但不知道如何从“代码”参数中获取数据：

```
 public static string AddScript(this HtmlHelper htmlHelper, string title, Func<object, object> code) {
    var ctx = htmlHelper.ViewContext.HttpContext;
    Dictionary<string, string> scripts = ctx.Items["HtmlHelper.AddScript"] as Dictionary<string, string>;
    if (scripts == null) {
        scripts = new Dictionary<string, string>();
        ctx.Items.Add("HtmlHelper.AddScript", scripts);
    }

    scripts.Add(title, code.ToString()); //Doens't work!

    return string.Empty;
} 
```

我如何需要调整委托参数以获取模板内的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:03:39.353

帮助器体系结构的设计使其可以适应您提供模板的场景，该模板将在例如列表中的每个项目上进行操作。在这种情况下，您当然希望能够在遍历列表时将“当前”项传递给它。

但是，在其他情况下（例如您的情况），*没有 current item*。然而，正如您所发现的，您仍然必须将委托声明为方法的参数，该方法定义了使用一个参数的方法。没关系——因为你没有在你的助手中使用那个参数（你没有`item`在你的模板中使用有点神奇的参数）你可以`null`在你的实现中传递它。最好将您的参数声明为 a`Func<object, IHtmlString>`而不是 a `Func<object, object>`，但无论如何，只需调用`code(null).ToString()`以获取您需要呈现的 HTML 编码字符串。

# javascript - 在 mongoose/mongodb 中删除

> ID：10957758
> 
> 赞同：0
> 
> 时间：2012-06-09T01:47:55.283
> 
> 标签：javascript, mongoose

我正在尝试添加允许为授权用户删除帖子的新功能，因此他们只能删除他们创建的帖子。它仅适用于一个语句，因此我可以允许他们删除所有（仅他们的）帖子或删除选定的帖子，但删除所有用户。继承人代码：

```
article_collection.remove({ _id: article_collection.db.bson_serializer.ObjectID.createFromHexString(id) }, {authoro: user}, function(error, result) { 
```

当我添加 $and 函数时，它什么也不做，在上面发布的情况下，它允许所有用户删除任何帖子。我猜我需要将传递的帖子ID转换为十六进制？但如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T02:07:22.077

两个查询条件必须组合成一个对象：

```
article_collection.remove({_id: id, authoro: user}, function(error, result) { ... 
```

# cakephp - CakePHP 1.3：服务器断电。现在插件不起作用

> ID：10957761
> 
> 赞同：0
> 
> 时间：2012-06-09T01:48:49.843
> 
> 标签：cakephp

我的主机在他们的服务器上停电了，这引起了很多麻烦，包括一些损坏的数据库表。现在这一切似乎都已解决。但是，我在连接到我的插件时遇到问题。

当我尝试时，出现以下错误：

```
 Error: The requested address '/admin/paginas/paginas' was not found on this server. 
```

所有其他插件都显示类似的错误。

我上传了整个蛋糕库，认为那里的文件已损坏。但是它不起作用。我还上传了 routes.php。

我应该去哪里解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T12:26:29.907

固定的。我不知道为什么，但是在我的主机从 OUTAGE 中恢复文件后，`CACHE`最终以`/tmp/logs/`. 我把它移到`/tmp/`现在一切正常。相当奇怪

# javascript - 检测 Youtube 搜索事件

> ID：10957763
> 
> 赞同：2
> 
> 时间：2012-06-09T01:49:04.540
> 
> 标签：javascript, google-chrome-extension, youtube

我正在编写一个 Chrome 扩展程序来控制背景音乐（潘多拉、谷歌音乐等）以响应 Youtube 事件。

我可以通过向播放器添加事件侦听器来检测视频何时开始、暂停或停止。但是，视频在搜索时会从播放状态切换到暂停状态。当用户在视频中跳过时，这会导致背景音乐响应（取消暂停）。

有什么方法可以从 Javascript 中捕获此单击并拖动搜索事件？一种解决方法（这可能是正确的行为）是仅在视频结束时才取消暂停背景音乐 - 而不仅仅是暂停 - 但我很好奇是否有人以前处理过类似的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T02:30:39.393

搜索通常是一个相当短的事件，因此请在播放器暂停后几秒钟后才重新开始播放音乐。

# c++ - 简单的堆程序——这个变量有什么作用

> ID：10957764
> 
> 赞同：2
> 
> 时间：2012-06-09T01:49:09.677
> 
> 标签：c++, heap

```
void ReheapDown( int* heap, int top, int swpIndx, int numElements )  {
    int leftChild = 2 * top + 1;
    int rightChild = 2 * top + 2;
    int minChild;
    if (leftChild < numElements) {
        // find subscript of smallest child
        if (rightChild >= swpIndx || heap[leftChild] < heap[rightChild])
            minChild = leftChild;
        else
            minChild = rightChild;
        // if data at top is greater than smallest
        // child then swap and continue
        if (heap[top] > heap[minChild]) {
            swap( heap[top], heap[minChild] );
            ReheapDown( heap, minChild, swpIndx, numElements );
        }
    } 
```

这是一个简单的堆。ReheapDown 部分用于删除堆中的项目。有什么作用`swpIndx`呢？（我需要知道做作业，我应该在其中编写删除堆中某个键的函数。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:12:39.153

要从堆中删除一个键，我们可能希望在删除它之前将它与堆中的最后一个键交换，否则堆中会出现一个大洞。

但是，将最后一个节点与我们要删除的节点交换可能会打乱堆的顺序，这就是您提供的**ReheapDown方法的用武之地。**

我相信*swpIndex*参数是我们放置要删除的元素的索引。所以那部分代码基本上说：

```
if (there exists a left child) {
    if (there is no right child || left child < right child)
        minChild <- left child
    else
        minChild <- right child
} 
```

我认为该参数是不必要的，因为它的唯一目的似乎是检查左右孩子的存在；这也可以通过将 leftChild 和 rightChild 索引与 numElements 进行比较来完成。

希望这可以帮助 ：）

# file - 创建 MIDI 文件 - 标题块中的时间划分说明

> ID：10957770
> 
> 赞同：2
> 
> 时间：2012-06-09T01:50:15.240
> 
> 标签：file, audio, header, midi

**编辑：发布在音频/视频制作网站[https://video.stackexchange.com/questions/4148/creating-midi-files-explanation-of-time-division-in-header-chunk](https://video.stackexchange.com/questions/4148/creating-midi-files-explanation-of-time-division-in-header-chunk)**

我一直在阅读有关 MIDI 文件结构的信息，因为我有兴趣编写一个以这种格式读/写文件的应用程序，但我对标题块中的时间划分有点困惑。

我的理解是这部分本质上是 16 位，如果符号位为 1，则其余位指定 SMPTE 时间码，如果为 0，则这些位指定每四分音符 (PPQ) 的滴答声/脉冲数。

具体来说，我的问题是：

*   更高/更低的 PPQ 对 MIDI 文件有什么作用？这会改变声音的质量吗？我的理解是它不会影响节奏
*   SMPTE 时间码如何影响播放中的 MIDI 文件？

本质上，我试图理解这些对最终结果的实际意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T04:10:46.027

我没有在那个论坛上注册，所以我把它贴在这里：

我可以回答第 1 部分。

PPQ 绝对会影响 MIDI 文件的速度。它不会改变声音的质量，它会改变处理事件的速率。

速度以每四分音符的微秒数来定义。如果您更改四分音符 (PPQ) 中的节拍数（脉冲），您实际上会更改文件播放的速率。PPQ 的标准值是 480。如果您对文件所做的唯一更改是将 PPQ 加倍，那么您实际上将播放速率（速度）减半。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-31T15:27:36.557

我知道这是一个老问题，但没有完全或完全准确地回答。

所有 MIDI 文件都使用增量时间。MIDI 文件中没有绝对的时序，无论是否 SMPTE。

在原始 MIDI 格式文件中，标题时序信息指定 PPQN，或每四分音符的脉冲数。SetTempo 元事件指定每四分音符的微秒数（速度）。MIDI 事件增量信息指定此事件与上一个事件之间的脉冲数。

在 SMPTE 样式的 MIDI 文件中，标头时序信息指定了两个值 - 每秒帧数和帧细分。每秒帧数实际上是 FPS（需要调整一些值，例如 29 是真正的 29.97）。帧细分可以被认为是每帧的脉冲数。MIDI 事件增量信息指定自上次事件以来帧细分（或脉冲）的数量。

一个重要的区别是，SMPTE 文件不使用 SetTempo 元事件。所有时间尺度都由标头时间字段固定。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-09T11:07:20.653

@LeffelMania 说得对，但我只是想补充一点，SMPTE 只是另一种保持时间安排的方式。如果您使用 SMPTE，那么您将获得每个事件的绝对时间，否则这些事件与之前的事件相关。

根据我的经验，大多数 MIDI 文件使用相对事件计时的传统方式（即，不是 SMPTE），因为这更容易使用。

# ruby-on-rails - Rails 模型函数为真时为假

> ID：10957774
> 
> 赞同：1
> 
> 时间：2012-06-09T01:51:03.950
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model

我有一个模型和一个函数来检查它是否有效。问题是它总是返回假，即使它是真的。

这是功能：

```
def is_valid?
  if self.active == true && (self.end_date.nil? || self.end_date >= Time.now)
    return true
  else
    return false
  end
end 
```

这是控制台输出：

```
1.9.2p320 :013 > sd.active == true
 => true 
1.9.2p320 :014 > sd.end_date.nil?
 => false 
1.9.2p320 :015 > sd.end_date >= Time.now
 => true 
1.9.2p320 :016 > (sd.end_date.nil? || sd.end_date >= Time.now)
 => true 
1.9.2p320 :017 > sd.active && (sd.end_date.nil? || sd.end_date >= Time.now)
 => true 
1.9.2p320 :018 > sd.is_valid? 
 => false 
1.9.2p320 :019 > sd
 => #<SubscriptionDiscount id: 1, title: "Prueba de descuento", code: "TEST1",     monthly_discount: #<BigDecimal:902f748,'0.1E2',9(18)>, yearly_discount: #<BigDecimal:902f4f0,'0.1E3',9(18)>, active: true, end_date: "2012-08-01 00:00:00", created_at: "2012-06-06 00:04:10", updated_at: "2012-06-08 21:57:06"> 
```

为什么它不起作用？我没看到。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T02:09:10.847

让我们从简化开始

```
def is_valid?
  active? && (end_date.nil? || end_date >= Time.now)
end 
```

它仍然会吹应用程序吗？

如果是，请输入以下内容：

```
def is_valid?
  p active?
  p end_date.nil?
  p end_date >= Time.now
  active? && (end_date.nil? || end_date >= Time.now)
end 
```

并分享输出。

# mysql - 删除大约 50,000 行而不出现 505 错误

> ID：10957775
> 
> 赞同：0
> 
> 时间：2012-06-09T01:51:53.543
> 
> 标签：mysql, sql, wordpress, inner-join

我正在尝试运行下面的 sql 查询，但经过长时间的等待后出现 505 错误。wp_posts 表包含超过 50,000 行...目的是删除大约 50,000 行的重复帖子

```
DELETE bad_rows.*
FROM wp_posts AS bad_rows
INNER JOIN 
(
     SELECT post_title, MIN(id) as min_id
     FROM wp_posts
     GROUP BY post_title
     HAVING count(*) > 1
) AS good_rows 
ON good_rows.post_title = bad_rows.post_title
AND good_rows.min_id <> bad_rows.id; 
```

关于如何优化和运行的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T02:13:56.460

不要认为您需要使用子查询。这将选择所有具有相同标题的帖子对。

```
SELECT a.id, b.id
FROM wp_posts a
LEFT JOIN wp_posts b 
ON a.post_title = b.post_title
WHERE a.id > b.id 
```

如果您想保留最旧的帖子，请删除 ID 为 a.id 的所有帖子。如果您想保留最新的帖子，请删除所有 id 为 b.id 的帖子。

* * *

因此，要保留最旧的帖子：

```
DELETE FROM wp_posts a
LEFT JOIN wp_posts b 
ON a.post_title = b.post_title
WHERE a.id > b.id 
```

保持最新的帖子：

```
DELETE FROM wp_posts a
LEFT JOIN wp_posts b 
ON a.post_title = b.post_title
WHERE a.id < b.id 
```

# asp.net - 使用 Respnse.WriteFile 而不是用户控件

> ID：10957780
> 
> 赞同：0
> 
> 时间：2012-06-09T01:53:36.007
> 
> 标签：asp.net

我有一个要拆分的大 html 文件。我设法将它分开并将每个部分放在一个 htm 文件中。结果，我的结构现在看起来像：

![在此处输入图像描述](../Images/e1c086e1b4c25c0a1645486fc542e960.png)

请注意，文件夹中的所有文件仅特定于 Default.aspx 页面。我喜欢把我的代码分成几个部分；我发现这样编程更容易。

无论如何，为什么当我这样做时：

```
 <%   
        Response.WriteFile("_Menu.htm");        
    %> 
```

这会创建一个不同的输出，如果我去 _Menu.htm 复制整个内容并将其粘贴到那里？我知道我可以为每个文件创建一个用户控件。但是如果我这样做，我将不得不在每个文件的页面根目录处创建一个页面指令，而且我只需要放置静态内容，我不需要调用 aspx 页面。为什么 Response.WriteFile 包含我在文件中没有的东西。例如，只要我有一个段落，它就会放置'"'标记。

## 编辑

当我计划重用 html 时，我会使用用户控件。在这种情况下，我只是将一个页面分成几个页面。我希望将每个块的内容放在一个单独的文件中。

## 编辑 2

正在做：

```
 <%   

        //Response.WriteFile("_Menu.htm");

        Response.Write(System.IO.File.ReadAllText(@"A:\Users\Antonio\Dropbox\VisualStudio Projects\Websites\Boat\Boat\MasterPages\User\_Menu.htm"));        
    %> 
```

效果很好。为什么 Response.WriteFile 开头包含“（段落）”！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T02:23:53.720

创建您的 Response.Write 方法：

全局创建以下扩展方法，以便您的所有页面都可以访问它：

```
using System.Web.UI;

public static class StaticExtensionMethods
{
    public static void Include(this System.Web.UI.Page Page, string path)
    {
        Page.Response.Write(System.IO.File.ReadAllText(Page.Server.MapPath(path))); 
    }

} 
```

然后做：

```
 <%   
        this.Include("_Menu.htm");
    %> 
```

# javascript - 引导模式对话框中的谷歌地图自动完成结果

> ID：10957781
> 
> 赞同：77
> 
> 时间：2012-06-09T01:54:11.047
> 
> 标签：javascript, html, css, google-maps-api-3, twitter-bootstrap

我在 Twitter Bootstrap 模式对话框中有一个 Google Maps Autocomplete 输入字段，并且不显示自动完成结果。但是，如果我按向下箭头键，它会选择下一个自动完成结果，所以似乎自动完成代码工作正常，只是结果没有正确显示。也许它隐藏在模态对话框后面？

这是屏幕截图：

![在自动完成字段中键入内容什么也没有](../Images/224b2f35488dfc7a1ad2c359e3acb207.png) 在自动完成字段中键入内容什么也没有

![按向下箭头键给出第一个结果](../Images/b2decad4ae121ab70857cbb6e9f54258.png) 按向下箭头键给出第一个结果

和代码：

```
<div class="modal hide fade" id="map_modal">
<div class="modal-body">
    <button type="button" class="close" data-dismiss="modal">×</button>
    <div class="control-group">
        <label class="control-label" for="keyword">Cari alamat :</label>
        <div class="controls">
            <input type="text" class="span6" name="keyword" id="keyword">
        </div>
    </div>
    <div id="map_canvas" style="width:530px; height:300px"></div>
</div>
<div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">Close</a>
    <a href="#" class="btn btn-primary">Save changes</a>
</div> 
```

```
<script type="text/javascript">
$("#map_modal").modal({
    show: false
}).on("shown", function()
{
    var map_options = {
        center: new google.maps.LatLng(-6.21, 106.84),
        zoom: 11,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("map_canvas"), map_options);

    var defaultBounds = new google.maps.LatLngBounds(
        new google.maps.LatLng(-6, 106.6),
        new google.maps.LatLng(-6.3, 107)
    );

    var input = document.getElementById("keyword");
    var autocomplete = new google.maps.places.Autocomplete(input);
    autocomplete.bindTo("bounds", map);

    var marker = new google.maps.Marker({map: map});

    google.maps.event.addListener(autocomplete, "place_changed", function()
    {
        var place = autocomplete.getPlace();

        if (place.geometry.viewport) {
            map.fitBounds(place.geometry.viewport);
        } else {
            map.setCenter(place.geometry.location);
            map.setZoom(15);
        }

        marker.setPosition(place.geometry.location);
    });

    google.maps.event.addListener(map, "click", function(event)
    {
        marker.setPosition(event.latLng);
    });
});
</script> 
```

我已经尽力自己解决这个问题，但是由于我不知道自动完成结果的 html&css（检查元素什么也没给出），所以我现在迷路了。有什么帮助吗？

之前谢谢！

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-06-09T05:15:57.473

问题`z-index`在于`.modal`

使用这个**CSS**标记：

```
.pac-container {
    background-color: #FFF;
    z-index: 20;
    position: fixed;
    display: inline-block;
    float: left;
}
.modal{
    z-index: 20;   
}
.modal-backdrop{
    z-index: 10;        
}​ 
```

您也可以在[此处查看最终演示](http://jsfiddle.net/Y4WgX/14/)

**ps：**感谢@lilina 在 jsfiddle.com 上的演示

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2014-10-05T16:20:15.357

```
.pac-container {
    z-index: 1051 !important;
} 
```

为我做的

[https://github.com/twbs/bootstrap/issues/4160](https://github.com/twbs/bootstrap/issues/4160)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-10-08T09:24:04.317

Bootstrap 的`.modal` `z-index`默认值为 1050。

jQuery UI`.ui-autocomplete` `z-index`默认为 3。

所以把它放在CSS上：

```
/* Fix Bootstrap .modal compatibility with jQuery UI Autocomplete,
see http://stackoverflow.com/questions/10957781/google-maps-autocomplete-result-in-bootstrap-modal-dialog */
.ui-autocomplete {
    z-index: 1051 !important;
} 
```

创造奇迹！:)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-09-04T19:03:29.137

使用引导程序 3：

```
.pac-container {
  z-index: 1040 !important;
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-03-31T10:58:11.180

在我的场景中， .pac-container 的 z-index 值将是 init 并覆盖为 1000，即使我在 CSS 中设置。（可能通过谷歌 API？）

我的肮脏修复

```
$('#myModal').on('shown', function() {
     $(".pac-container").css("z-index", $("#myModal").css("z-index"));
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-07-26T18:06:10.047

我花了 2.3 个小时来挖掘 google places API drop down z index 的错误。最后我找到了这个。只需将此代码粘贴到您的 JS 脚本顶部并更新输入 ID 名称。

```
var pacContainerInitialized = false;
$("#inputField").keypress(function() {
  if (!pacContainerInitialized) {
    $(".pac-container").css("z-index", "9999");
    pacContainerInitialized = true;
  }
}); 
```

完整参考链接。 [https://groups.google.com/forum/#!topic/google-maps-js-api-v3/GZX0ynQNn1M](https://groups.google.com/forum/#!topic/google-maps-js-api-v3/GZX0ynQNn1M) 感谢 Gautam。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-08-21T08:56:21.640

通常，您可以将 .pac-container z-index 提高到 1050 以上的任何值，并且不需要其他 CSS 覆盖。

我发现 jQuery UI 对话框也存在这个问题。因此，如果它最终对其他人有所帮助，这里有一个关于 Bootstrap/jQuery UI 模态在 z 平面中的位置的快速参考：

```
jQuery UI Dialog - z-index: 1001
Bootstrap Modal - z-index: 1050 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-02-10T14:38:16.977

这对我有用。

```
 var pacContainerInitialized = false; 
                    $('#inputField').keypress(function() { 
                            if (!pacContainerInitialized) { 
                                    $('.pac-container').css('z-index','9999'); 
                                    pacContainerInitialized = true; 
                            } 
                    }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-09T09:20:43.800

如果您使用的是 Visual Studio，请在您的`style.css`页面上将 for 设置`z-index`为`.modal`20。

例如

```
.modal {
    z-index: 20 !important;
} 
```

# asp.net-mvc-3 - 如何使用 ASP.NET MVC 3 将字段的值绑定到具有不同名称的属性？

> ID：10957782
> 
> 赞同：2
> 
> 时间：2012-06-09T01:54:19.550
> 
> 标签：asp.net-mvc-3, c#-4.0

考虑以下模型，该模型使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)和[JSON.net](http://json.codeplex.com/)将对象序列化为相应的格式。

```
[XmlRoot("my_model")]
[JsonObject("my_model")]
public class MyModel {

    [JsonProperty("property1")]
    [XmlElement("property1")]
    public string Property1 { get; set; }

    [JsonProperty("important")]
    [XmlElement("important")]
    public string IsReallyImportant { get; set; }
} 
```

现在考虑以下 ASP.NET MVC 3 操作，它接受 JSON 或 XML 请求并以各自的格式返回模型（基于接受标头）。

```
public class MyController {
    public ActionResult Post(MyModel model) {

        // process model

        string acceptType = Request.AcceptTypes[0];
        int index = acceptType.IndexOf(';');
        if (index > 0)
        {
            acceptType = item.Substring(0, index);
        }

        switch(acceptType) {
            case "application/xml":
            case "text/xml":
                return new XmlResult(model);

            case "application/json":
                return new JsonNetResult(model);

            default:
                return View();
        }
    }
} 
```

JSON 和 XML 输入存在自定义[ValueProviderFactory实现。](http://msdn.microsoft.com/en-us/library/system.web.mvc.valueproviderfactory.aspx)就`IsReallyImportant`目前而言，当输入映射到 MyModel 时将被忽略。但是，如果我定义`IsReallyImportant`使用“isreallyimportant”的属性，那么信息就会被正确序列化。

```
[JsonProperty("isreallyimportant")]
[XmlElement("isreallyimportant")]
public string IsReallyImportant { get; set; } 
```

正如预期的那样，默认绑定器在将传入值映射到模型时使用属性名称。我查看了[BindAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.bindattribute.bindattribute)，但是属性不支持它。

如何告诉 ASP.NET MVC 3 该属性`IsReallyImportant`应该在传入请求中绑定到“重要”？

我有太多模型无法为每个模型编写自定义活页夹。请注意，我不使用 ASP.NET Web API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T22:59:30.947

您只能执行一个自定义 ModelBinder，它将查找 JSonProperty 和 XMLElement 属性以映射正确的属性。这样您就可以在任何地方使用它，而不必为每个模型开发模型绑定器。不幸的是，除了自定义模型绑定器之外，没有其他选项可以修改属性绑定。

# sql - 我可以将引用表中的所有行作为一种模板加入吗？

> ID：10957784
> 
> 赞同：0
> 
> 时间：2012-06-09T01:54:34.067
> 
> 标签：sql, sql-server, join, sql-server-2000

我正在开发一个具有一些调度功能的应用程序。作为其中的一部分，我需要选择一个人员列表，以及他们是否在一周的某个时间段安排了一些事情。

一周中的周期数是可变的，因此它们存储在参考表中，例如：

```
Period Reference Table

id   name       start                 end                     day
------------------------------------------------------------------
1    Morning    1900-01-01 4:00:00    1900-01-01 11:00:00     MON
2    Afternoon  1900-01-01 14:00:00   1900-01-01 20:00:00     MON  
3    Night      1900-01-01 20:00:00   1900-01-01 24:00:00     MON  
4    Morning    1900-01-01 4:00:00    1900-01-01 11:00:00     TUE
5    Afternoon  1900-01-01 14:00:00   1900-01-01 20:00:00     TUE  
6    Night      1900-01-01 20:00:00   1900-01-01 24:00:00     TUE 
```

我还有一个“人员参考”表和一个“人员日程”表。“person schedule”表只存储一个人在某个时间段内安排了某事的记录，这里是一个简化的例子：

```
Person Schedule Table

id    person_id     period_id
------------------------------
1     1             2
2     1             3
3     2             2
4     2             3
5     2             4 
```

现在我需要从这三个表中选择每个人的完整时期列表，以及他们在该时期是否有时间表记录（1 或 0）。换句话说，我需要为上面的示例数据获取此结果集：

```
person_id     period_id     is_scheduled
----------------------------------------
1             1             0
1             2             1
1             3             1
1             4             0
1             5             0
1             6             0
2             1             0
2             2             1
2             3             1
2             4             1
2             5             0
2             6             0 
```

是否可以在不进入动态 SQL 的情况下使用 select 语句来执行此操作？

这一切都是使用 SQL Server 2000 完成的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:49:41.680

```
SELECT 
  people.person_id, period_id = periods.id, is_scheduled = CASE
  WHEN schedule.person_id IS NOT NULL THEN 1 ELSE 0 END
FROM dbo.[period reference table] AS periods
CROSS JOIN 
(
  SELECT person_id 
    FROM dbo.[person schedule table] 
    GROUP BY person_id
) AS people
LEFT OUTER JOIN 
  dbo.[person schedule table] AS schedule
  ON people.person_id = schedule.person_id
  AND periods.id = schedule.period_id
ORDER BY 
  people.person_id, p.id; 
```

# python - 协议缓冲区python - unicode解码错误

> ID：10957786
> 
> 赞同：6
> 
> 时间：2012-06-09T01:54:51.273
> 
> 标签：python, unicode, utf-8, protocol-buffers

我需要在我的 python - tornado 服务器上接收协议缓冲区消息并从二进制消息中获取内容。

```
postContent = self.request.body
message = prototemp.ReqMessage()
message.ParseFromString(postContent) 
```

使用测试工具可以完美运行。当我在沙盒环境中运行它并模拟来自我的客户端的 1000 个请求时，它在某些情况下有效，但在大多数请求中，它会引发异常 -

```
 File "server1.py", line 21, in post
    message.ParseFromString(postContent)
  File "/usr/lib/python2.6/site-packages/protobuf-2.4.1-py2.6.egg/google/protobuf/message.py", line 179, in ParseFromString
    self.MergeFromString(serialized)
  File "/usr/lib/python2.6/site-packages/protobuf-2.4.1-py2.6.egg/google/protobuf/internal/python_message.py", line 755, in MergeFromString
    if self._InternalParse(serialized, 0, length) != length:
  File "/usr/lib/python2.6/site-packages/protobuf-2.4.1-py2.6.egg/google/protobuf/internal/python_message.py", line 782, in InternalParse
    pos = field_decoder(buffer, new_pos, end, self, field_dict)
  File "/usr/lib/python2.6/site-packages/protobuf-2.4.1-py2.6.egg/google/protobuf/internal/decoder.py", line 544, in DecodeField
    if value._InternalParse(buffer, pos, new_pos) != new_pos:
  File "/usr/lib/python2.6/site-packages/protobuf-2.4.1-py2.6.egg/google/protobuf/internal/python_message.py", line 782, in InternalParse
    pos = field_decoder(buffer, new_pos, end, self, field_dict)
  File "/usr/lib/python2.6/site-packages/protobuf-2.4.1-py2.6.egg/google/protobuf/internal/decoder.py", line 410, in DecodeField
    field_dict[key] = local_unicode(buffer[pos:new_pos], 'utf-8')
UnicodeDecodeError: 'utf8' codec can't decode byte 0xce in position 1: invalid continuation byte 
```

在其他一些情况下，它会给出这些错误 -

```
UnicodeDecodeError: 'utf8' codec can't decode byte 0xbf in position 3: invalid start byte

UnicodeDecodeError: 'utf8' codec can't decode byte 0xe7 in position 3: unexpected end of data 
```

可能是什么原因 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-10T20:17:42.117

我对 RabbitMQ 和协议缓冲区有完全相同的问题。问题是协议缓冲区假定输入为 str 类型，而 RabbitMQ 在某些情况下似乎将消息解码为 un​​icode（如果字节数组包含大于 127 的字节）。Tornado 也可能发生同样的情况。到目前为止，似乎可以通过以下代码解决该问题：

```
body = self.request.body
if type(body) == unicode:
    data = bytearray(body, "utf-8")
    body = bytes(data)
message = whatever.FromString(body) 
```

此代码将 unicode 字符串转换为 python 字节对象，它可以被协议缓冲区消息愉快地解析。不知道是否有更好的方法可以做到这一点，但至少这似乎有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-12T05:22:07.037

我遇到同样的问题。

这是一个参考[​​1]。

在这种情况下，我们应该使用字节。

谢谢。

[1] [https://developers.google.com/protocol-buffers/docs/proto#scalar](https://developers.google.com/protocol-buffers/docs/proto#scalar)

# coding-style - 在 Python 代码中为变量使用名称“函数”

> ID：10957789
> 
> 赞同：4
> 
> 时间：2012-06-09T01:55:44.673
> 
> 标签：coding-style, python

是否在 Python 代码中使用该词`function`作为参数名称被认为是不好的风格？

```
def conjunction_junction(function):
    pass # do something and call function in here 
```

这种模式一直存在，尤其是[在装饰器中](https://stackoverflow.com/questions/10957409/python-naming-conventions-in-decorators)。你看`func`，`fn`并且`f`一直使用，但我更喜欢尽可能避免使用缩写。它是一种类型的名称是否足以保证缩写它？

```
>> type(conjunction_junction).__name__
'function' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T02:01:43.480

它不是保留关键字，所以我不明白为什么不这样做。

来自[风格指南](http://www.python.org/dev/peps/pep-0008/#function-and-method-arguments)

> 如果函数参数的名称与保留关键字发生冲突，通常最好在结尾附加一个下划线，而不是使用缩写或拼写错误。因此 class_ 比 cls 好。（也许更好的是通过使用同义词来避免这种冲突。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T02:10:08.247

使用`function`完全没问题。

[样式指南](http://www.python.org/dev/peps/pep-0008/#function-and-method-arguments)中没有具体说明它。强烈建议不要使用和等类型名称的原因是因为它们在语言中具有`str`功能。`list`覆盖它们会掩盖代码的功能。`function`另一方面，什么也不做。

我怀疑`func`,`fn`和`f`被使用是因为它们都比打字短`function`；）

# file - 在 vfp 9.0 中打开文件夹时如何默认选择文件

> ID：10957790
> 
> 赞同：0
> 
> 时间：2012-06-09T01:55:47.500
> 
> 标签：file, directory, visual-foxpro

我想打开一个文件夹，默认选择一个文件。

我这样做：

```
Declare Long WinExec In kernel32 String @, Integer
WinExec("Explorer /select, C:\tt.txt",5) 
```

但如果文件夹已打开，则默认无法选择该文件。

怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T10:51:08.477

您提示用户选择特定文件的目的是什么...

您可以从 VFP 中获得的最接近的是“GetFile()”，您可以在其中给它一个您希望找到的文件的默认扩展名，它会弹出一个文件选择对话框。

lcFileSelected = GetFile( "Txt", "Caption left of combobox selection (but only shows about 16 chars)", "Button Caption", nOptionalButton )

例如：nOptionalButton 0 = 右下角没有额外的按钮，只有 OK、Cancel（其中 OK 被上面的“按钮标题”示例覆盖。

1 = 确定、新建、取消

2 = 确定、无、取消

如果选择了一个值，您将拥有文件名，否则为空白。

修改后的答案..

然后你想要的是 PUTFILE() ，它允许你提示用户一个简单的消息，类似于“保存到”，并允许放置一个完全限定的路径和文件名。返回时，很像 GETFILE() 将返回用户输入的最终路径/文件名。前任：

lcUserAnswer = PUTFILE("保存位置", "C:\program files\myTest.txt")

现在你可以用“lcUserAnswer”变量做任何事情......

# php - .htaccess 误读目录

> ID：10957796
> 
> 赞同：1
> 
> 时间：2012-06-09T01:57:07.357
> 
> 标签：php, apache, .htaccess, clean-urls

我有一个为索引页面设置变量的设置，但它对目录也有同样的作用，我不希望它这样做。这是我的 .htaccess 文件：

```
RewriteEngine On

RewriteCond %{REQUEST_URI} !^/(login|images|favicon\.ico|home|about|sitemap|contactus|termsandconditions|privacypolicy|signup|search|careers|error|css|js) [NC]

RewriteRule ^([a-zA-Z0-9]+)$ index.php?name=$1
RewriteRule ^([a-zA-Z]+)/$ index.php?name=$1

RewriteRule ^([a-zA-Z]+)/([a-zA-Z0-9_]+)$ index.php?name=$1&page=$2
RewriteRule ^([a-zA-Z]+)/([a-zA-Z0-9_]+)/$ index.php?name=$1&page=$2

RewriteRule ^php/$ error/ 
```

现在，通过这个设置，如果我输入`mysite.com/login`它将重定向到`index.php`页面并设置`login`为`name`变量。如何使它忽略目录？这让我很沮丧，我已经浏览了这个网站一个多小时来寻找答案，但找不到类似的问题（不过，我可能也很讨厌。哈哈！）。

此外，如果您查看最后一个`RewriteRule`，您会看到我正在尝试将任何访问我的`php/`文件夹的尝试重定向到我的`error/`文件夹。这也行不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:07:16.050

`RewriteCond`仅适用于紧随其后`RewriteRule`。此外，您可以通过`/?`在末尾使用分别组合第 3&4 行和第 5&6 行，这使得`/`可选（[regex](http://www.regular-expressions.info/)）。

您的文件可能与此类似：

```
RewriteEngine On
#the following line will not rewrite to anything because of "-", & stop rewiting with [L]
RewriteRule ^(login|images|favicon\.ico|home|about|sitemap|contactus|termsandconditions|privacypolicy|signup|search|careers|error|css|js)/?(.*)$ - [L,NC]
RewriteRule ^php/?(.*)$ error/ [L,NC]
RewriteRule ^([^/]+)/?$ index.php?name=$1 [L]
RewriteRule ^([^/]+)/([^/]+)/?$ index.php?name=$1&page=$2 [L] 
```

您可能对[Apache Mod_Rewrite 文档](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)感兴趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T02:06:59.300

```
RewriteCond %{REQUEST_URI} !^/(login|images|favicon\.ico|home|about|sitemap|contactus|termsandconditions|privacypolicy|signup|search|careers|error|css|js) [NC] !-d

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

要么不对目录或文件执行规则

[有关mod_rewrite](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)文档页面的更多信息，请搜索`CondPattern`

# javascript - 谷歌浏览器会话过期=null 不工作

> ID：10957800
> 
> 赞同：4
> 
> 时间：2012-06-09T01:58:38.410
> 
> 标签：javascript, session, node.js, google-chrome, express

根据[连接文档](http://www.senchalabs.org/connect/session.html)，当浏览器关闭时会话应该过期：

> 默认情况下`cookie.maxAge`是`null`，这意味着没有设置“过期”参数，因此 cookie 成为浏览器会话 cookie。当用户关闭浏览器时，cookie（和会话）将被删除。

我正在使用 express 3 和[connect-mysql](https://github.com/nathan-lafreniere/connect-mysql)进行会话存储（也尝试使用 connect-mongo 并且相同），这就是我设置会话数据的方式。

```
 req.session.userid = results[0].id;
 req.session.ip = req.connection.remoteAddress;
 req.session.useragent = req.headers['user-agent'];
 req.session.is_logged_in = true; 
```

出于某种原因，这一切都很好，除了在 google chrome 浏览器中（这是在 OS X Lion 中。我现在无法在 win 或 linux 下进行测试）。

有人在谷歌浏览器中遇到过这个问题并且知道解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T19:53:33.803

这是一个相当疯狂的猜测，但如果是这样，我不会太惊讶。如果您安装了任何使用此功能的扩展程序，Google chrome 将继续在后台运行。如果是这种情况，则应重置会话中的注销登录。

如果不是这样，您能否打开开发人员工具 ( `cmd+alt+i`) 并从那里复制有关 cookie 的所有信息 ( `resources`-> `cookies`-> `yourdomain.com`)。（尤其是`Expires`专栏里写的，因为应该说`Session`）

# windows-phone-7 - WP7 XNA：如何在代码中动态更改 SpriteFont 字体的大小或样式？

> ID：10957802
> 
> 赞同：1
> 
> 时间：2012-06-09T02:00:02.323
> 
> 标签：windows-phone-7, fonts, xna, spritefont

似乎没有办法更改代码中的字体大小或样式，对吧？似乎唯一的方法是复制字体文件并在程序启动时将它们全部加载？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T04:20:54.167

SpriteFonts 将带有样式、大小和其他参数的字体转换为基于像素的格式，以用作 XNA 中的纹理。这些像素是静态的，所以是的，没有办法改变它们，除非循环遍历每个像素。

然而，有缩放（虽然它看起来不会那么大缩放）以帮助进行所需的大小调整，而且您可以像您所说的那样，从相同的基本字体为不同的样式创建多个 SpriteFont 文件，并动态*选择*其中一个代码中的精灵字体“纹理”。

除此之外，对于真正的完全动态的运行时使用，您需要在内存中动态创建这些精灵字体纹理。这意味着您必须执行 SpriteFont Content Pipeline 项目所做的事情，但要在运行时执行。[这在 WinForms 中是可能的](http://create.msdn.com/en-US/education/catalog/sample/winforms_series_2)，但据我所知，您显然正在使用的 WP7 并不是一个真正的选项。

# jquery - jQuery 验证 Opera 中不需要的数字

> ID：10957806
> 
> 赞同：0
> 
> 时间：2012-06-09T02:00:45.457
> 
> 标签：jquery, forms, jquery-validate, validation, opera

我正在编写一个计划在 Opera 浏览器中使用的（本地主机）网站（因为我的网站使用的是 HTML5）。在网站的一部分，我有一个表格，其中一个字段是一个数字。我正在尝试使用 jQuery Validate 插件来验证条目是否为数字，但这不是必需的。

我希望这是解决方案，它适用于 Chrome，但在 Opera 中，验证被忽略

```
<form id="productForm">
<input type="text" name="MinPrice" id="Minprice" />
<input type="submit" value="OK" />
</form>​

$("#productForm").validate({
     rules: {
         MinPrice: {
             number: true
         }
     }
 });​ 
```

为了让 jQuery 验证 Opera 中的数字，看来我必须编写：

```
<form id="productForm">
<input type="text" name="MinPrice" id="Minprice" />
<input type="submit" value="OK" />
</form>​

$("#productForm").validate({
     rules: {
         MinPrice: {
             number: true,
             required: true
         }
     }
 });​ 
```

但问题是我不想要求 MinPrice，我只想在我在该字段中输入任何内容时验证它

谢谢，

营汤1988

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T05:48:27.593

这看起来像是插件中的错误（或在 Opera 中，取决于您的观点）。

您可以使用“依赖回调”来解决它，如下所示：

```
$("#productForm").validate({
    rules: {
        MinPrice: {
            required: function(el) {
                var $el = $(el);
                if(!$el.val()) { $el.val('0') };
                return false;
            },
            number: true
        }
    }
});​ 
```

如果我做对了，那么这应该通过插入“0”来强制该字段永远不会为空。

如果插件在其编号验证之前执行其“必需”验证，则此解决方法有可能起作用。

如果它不起作用，那么您可以使用绑定到该字段的“模糊”处理程序来实现相同的效果。

如果您需要区分用户输入的“0”和强制的“fudge-value”，那么您可以强制使用“-1”而不是“0”并相应地测试服务器端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T19:30:46.007

这里实际发生的是，在 Opera 中，如果输入的值不是有效数字，则 input.value（以及 Opera 提交的内容）是一个空字符串。有点令人困惑的是，用户输入的内容仍然留在输入中而没有被标记为无效，并且由于 .value 为空，JS 验证也没有发现任何问题。

[根据规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#number-state-%28type=number%29)，这是正确的，文本“值清理算法如下：如果元素的值不是有效的浮点数，则将其设置为空字符串”，但在 UI 方面它是仍然令人困惑，所以我认为 Opera 应该修复它。

# android - 如何在整个应用程序中正确使用相同的数据库和游标？

> ID：10957808
> 
> 赞同：0
> 
> 时间：2012-06-09T02:01:38.417
> 
> 标签：android, database, sqlite, global-variables

我在我的应用程序中处理了巨大的数据库（约 40K 行）。有一个活动有一个列表视图，它使用 CursorAdaptor 在整个数据库行中显示和搜索。每次用户处理数据库时，我打开数据库并创建所需的 Cursor，并在另一个线程中调用 Cursor.getCount() 以解决游标的惰性问题，并使其为将来的操作做好充分准备。为庞大的数据库完成 Cursor.getCount() 大约需要 7 秒。

用户可能会多次调用此活动，因此我将游标作为静态数据成员存储在全局类中，并且我总是重用同一个游标。

我想如果我没有正确关闭游标和数据库，我可能会得到奇怪的结果。正确的？！

我的问题是：什么时候应该关闭游标和数据库？

无法在 Activity.onStop() 中关闭数据库和游标，因为每次活动从不可见变为可见时，我都必须重新打开数据库和游标。如果我在 Activity.onDestroy 中关闭，那么应用程序可能会在调用 onDestroy 之前被操作系统杀死（当设备的可用内存不足时）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T04:13:22.183

你为什么不把这个全局静态类变成一个[单例](http://www.javaworld.com/javaworld/jw-04-2003/jw-0425-designpatterns.html)，这样你就不会遇到实例化问题，这听起来像是你在引用。在单例中调用 getInstance() 后，您将始终在该类中获得相同的游标和数据库连接。

# android - 我想让一个矩形在屏幕上慢慢延伸，在 android 中只需要 1 秒

> ID：10957810
> 
> 赞同：0
> 
> 时间：2012-06-09T02:02:00.723
> 
> 标签：android, graphics, timing

基本上，我正在制作一个代表武器电荷的矩形。我想要一个绿色矩形在一定时间后超过红色矩形。我的问题是时机。我不知道如何在android中做任何计时。我是相当新的，所以不要使用太多我可能不明白的东西。这一切都在一个视野之内。我研究了线程和处理程序，但只是感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:14:15.367

如果您想在不使用库的情况下支持 pre 3.0，请查看[View Animations 。](http://developer.android.com/guide/topics/resources/animation-resource.html#View)或[属性动画](http://developer.android.com/guide/topics/graphics/animation.html)，如果目标 3.0+ 是可以的。

我对 View Animations 有更多的经验，我可以告诉你，Scale 动画是你要找的。将您的 X 缩放到其大小的 100% 或许可以完成工作。

# python - 如何反向循环？

> ID：10957812
> 
> 赞同：2
> 
> 时间：2012-06-09T02:02:20.123
> 
> 标签：python, algorithm, loops, for-loop, simulation

我正在制作一个水模拟程序，我需要它通过 y，x 进行 for 循环。但我需要它先检查最底部的 y，然后再向上检查。这是我的等级：

```
lvl = [[0, 0, 1, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0]] 
```

我需要它来检查 lvl[4]，然后检查 lvl[3]、lvl[2] 等。请帮忙！

注意：我正在使用嵌套的 for 循环，所以我可以检查 y、x。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T02:08:17.943

您可以使用[`reversed`](http://docs.python.org/library/functions.html?highlight=reversed#reversed)内置方法来反转列表列表的顺序：

```
for li in reversed(lvl):
    print li 
```

输出：

```
[0, 0, 0, 0, 0]
[0, 0, 0, 0, 0]
[0, 0, 1, 0, 0]
[0, 0, 1, 0, 0]
[0, 0, 1, 0, 0] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T03:08:34.663

如果您正在使用`for`循环，则可以使用它[`range`](http://docs.python.org/library/functions.html#range)来生成要索引的反向序列`lvl`。

```
>>> range(4,-1,-1)
[4, 3, 2, 1, 0] 
```

即，可能类似于：

```
>>> for i in range(4,-1,-1):
...     print lvl[i]
...
[0, 0, 0, 0, 0]
[0, 0, 0, 0, 0]
[0, 0, 1, 0, 0]
[0, 0, 1, 0, 0]
[0, 0, 1, 0, 0]
>>> 
```

# google-analytics - 使用 Analytics 和 Shopify 应用商店

> ID：10957814
> 
> 赞同：2
> 
> 时间：2012-06-09T02:03:42.597
> 
> 标签：google-analytics, shopify

在应用商店中设置 Shopify 应用以进行展示时，有一个用于输入分析帐户 ID 的文本字段。我输入了一个应用程序的旧 Analytics ID，然后等待一段时间再检查结果。当我登录到我的 Analytics 帐户时，果然有一个漂亮的折线图显示来自 App Store 顾客的访问。

它向我展示了数百名来自美国的人访问了该应用程序，但没有别的。

有分析知识的人可以提出一些简单的方法来从这个功能中获得一些价值吗？也许一些关于如何配置分析以揭示访问的有趣内容的提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:33:57.340

您可以尝试“移动一些针”的事情：

*   更改简短描述上的应用名称、副本或应用横幅。此干预将影响您正在查看的访问次数。
*   更改应用列表页面上的文案、视频或卖点。这种干预，结合观察你的访问：安装率告诉你转化率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T21:57:52.117

在我看来，这些类型的列表最有趣的是推荐网站。这将让您知道人们是如何访问您的应用程序的，以及您可以在哪里提高曝光率。

将推荐网站与安装和评论等结果进行比较也很有用，因为您可以看到实际安装应用程序的人是如何到达那里的，评论者也是如此。在谷歌分析中设置目标将帮助您跟踪这些事情。

# python - 如果您是一名雇主，正在寻找一个新手程序员，您会认为一个足够复杂的项目来将他们视为有能力的程序员吗？

> ID：10957817
> 
> 赞同：-7
> 
> 时间：2012-06-09T02:04:29.830
> 
> 标签：python

我已经编程了几个月，并且已经完成了一些小程序（https://github.com/jlegs）。一位资深程序员的朋友向一家正在寻找 Python 编码员的公司建议他们来看看我。所以我今天进去见了他们。他们想从我那里看到更复杂的程序，以表明我处于更中间的水平。

所以一个问题：你们会说什么样的项目可以与中级程序员相提并论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:25:50.397

StackOverflow 上有很多写得很好的问题和答案，这将大大有助于让我相信你的批判性思考能力和与团队沟通的能力。

如果你能重新创建几十个 Unix 命令行过滤器，我那个时代的公司会很高兴。如今，这还不够。多语言的跨平台脚​​本是游戏的名称。SQL、php、Java 和各种风格的 C 语言很常见。申请人应该精通从 lambda 表达式和迭代器到复杂的正则表达式和 html 解析器的所有内容。然而，与其跳入研究所有这些事情，你应该知道你确实非常了解的事情，并能够与面试官深入讨论它们。

如果我要列出一个最终的任务列表，那就是编写[此页面](http://en.wikipedia.org/wiki/Software_design_pattern)中的模式示例。执行这些操作时不要将自己限制为 Python，如果对数据库的调用有效，则执行此操作，如果对命令行实用程序的调用满足该模式，则执行此操作。卖主的不是代码的复杂性，而是您对代码如何实现模式的理解和接口定义的清晰性。

# objective-c - 不懂线程 XCode

> ID：10957819
> 
> 赞同：-3
> 
> 时间：2012-06-09T02:04:41.997
> 
> 标签：objective-c, ios, cocoa-touch

我在 [[c textLabel] setText:item]; 得到一个线程。我不明白我需要更改什么才能让我的应用程序运行。线程说：​​线程 1：信号 SIGABRT。如果需要，我可以发布更多信息，请帮助。

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
return [tasks count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath

{
UITableViewCell *c= [taskTable dequeueReusableCellWithIdentifier:@"Cell"];

if (!c) {
    c = [[ UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"Cell"];
}

NSString *item = [tasks objectAtIndex:[indexPath row]];
[[c textLabel] setText:item];

return c;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T04:41:09.530

在行中： -

```
UITableViewCell *c= [taskTable dequeueReusableCellWithIdentifier:@"Cell"]; 
```

`taskTable`应该替换为`tableView`（指向tableView的委托方法而不是直接指向tableView。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T06:42:52.647

尝试检查警告。通常在 XCode 中，警告表示更多错误。

我认为，“c”值错误。

# python - 我如何写一个列表理解？

> ID：10957820
> 
> 赞同：-6
> 
> 时间：2012-06-09T02:04:53.543
> 
> 标签：python

我想编写一个列表理解，它将每隔一个元素从数组中打印一个元素。我该怎么做？

```
array = [1,2,3,4,5,6,7,8,9]
output: 2
3
4
5
6
7
8
9 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T02:18:25.447

```
array = [1,2,3,4,5,6,7,8,9]

newarray = [array[i] for i in range(0, len(array), 2)]

print(newarray) 
```

结果是`[1, 3, 5, 7, 9]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T02:36:18.697

这个问题有点不清楚代码的最终用途是什么，因此完成它的最佳方法是什么。但是如果你想从列表中选择第二个元素，你可以使用切片表示法：

```
>>> array = [1,2,3,4,5,6,7,8,9]
>>> odd = array[::2]
>>> odd
[1, 3, 5, 7, 9]
>>> even = array[1::2]
>>> even
[2, 4, 6, 8] 
```

这可以概括为通过更改 step 参数来选择每*第 n 个*元素，例如，选择每第三个元素：

```
>>> third = array[::3]
>>> third
[1, 4, 7] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T02:15:23.247

“数组中的一个*元素每隔一个元素*” ..意思是打印出每个其他元素？

如果你真的想使用列表推导，这里有两个，一个收集*偶数索引条目*，另一个收集各自列表中*的奇数，然后打印出来。*

```
evens = [elem for i, elem in enumerate(array) if not (i % 2)]
odds  = [elem for i, elem in enumerate(array) if i % 2]

print evens # entries at even index value
[1, 3, 5, 7, 9]

print odds  # entries at odd index values
[2, 4, 6, 8] 
```

# python - 在 Windows 上安装 Bellatrix 时遇到困难

> ID：10957821
> 
> 赞同：1
> 
> 时间：2012-06-09T02:04:57.253
> 
> 标签：python, windows, shell, pip

我已经在我的 Windows 机器上使用`pip install bellatrix`. 但是，当我尝试执行任何命令时，例如`bellatrix list`，我得到错误`'bellatrix' is not recognized as an internal or external command, operable program or batch file.`。有谁知道这里可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T10:57:08.747

这是贝拉特里克斯的作者。我刚看到这个问题（你应该先给我发电子邮件；））

Bellatrix 已在 Linux / Unix / Mac 中广泛使用，但在 Windows 中没有那么多。我从一位用户那里了解到他在 Windows 上的体验：http: [//mainlydata.kubadev.com/ec2/bellatrix-windows-users-two-things-to-remember/](http://mainlydata.kubadev.com/ec2/bellatrix-windows-users-two-things-to-remember/)

无论如何，我刚刚发布了 1.1.10，它带有一个不错的 Windows 桥接器，因此您将能够在 Windows 中无缝地使用相同的命令。

为了安装或升级到新版本，只需键入：

```
pip install bellatrix --upgrade 
```

如果您有任何问题，请告诉我。

# javascript - PhoneGap Android后退键需要按两次

> ID：10957824
> 
> 赞同：0
> 
> 时间：2012-06-09T02:05:42.700
> 
> 标签：javascript, android, cordova

当我导航到第二页并尝试使用每个 android 设备都有的默认后退按钮返回时，似乎我第一次点击它时，什么都没有发生。我必须再次点击它。有人知道为什么会这样吗？

我不确定我还需要提供什么信息。如果您需要更多信息，请具体要求您需要什么，我将尝试编辑问题。

编辑：我的主要活动扩展了 DroidGap 并且只有一种方法

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    super.loadUrl("file:///android_asset/www/index.html");
} 
```

我想我正在缩小问题的范围。在第二页上，有一个锚标记列表，单击时会执行 css 动画。

无论出于何种原因，这个 jsfiddle 都没有做动画，但这里是相关的标记、css 和 javascript

[http://jsfiddle.net/7fdQu/](http://jsfiddle.net/7fdQu/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:07:03.613

我不确定背景中发生了什么，但有一个确定的......

您可以在 Android 中对后退按钮进行编程，有一个代码。***phonegap***在 Android 中触发事件“后退按钮”。

```
document.addEventListener("backbutton", onBackKeyDown, false);

function onBackKeyDown() {
    window.location.href = 'URL';
} 
```

参考：

1.  [我应该在 JavaScript 中使用 window.navigate 还是 document.location？](https://stackoverflow.com/questions/948227/should-i-use-window-navigate-or-document-location-in-javascript)
2.  [http://docs.phonegap.com/en/1.0.0/phonegap_events_events.md.html#backbutton](http://docs.phonegap.com/en/1.0.0/phonegap_events_events.md.html#backbutton)

# ruby - 在 OSX 上的 Ruby 中同时上传文件夹中的文件

> ID：10957829
> 
> 赞同：2
> 
> 时间：2012-06-09T02:06:59.840
> 
> 标签：ruby, macos, ftp, automation

我以前见过类似的问题，但没有一个像我的一样基本。我知道可以使用`Net::FTP`和线程。我的问题是你如何创建一个线程并将其传递给一个文件以上传。我对线程的概念仍然很陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:37:56.527

对于 OSX，您还可以使用[Upload to FTP查看](http://editkid.com/upload_to_ftp/)[Automator](http://www.macosxautomation.com/automator/index.html)。

然而，对于 Ruby，可以使用这样的东西作为起点：

```
def ftp_send_file(file)
  Net::FTP.open("hostname") do |ftp|
    ftp.login("user", "password")
    ...
    ftp.putbinaryfile(file)
  end
end

8.times { |i|
  puts "Starting upload no. #{i}..."

  # Launch a new thread for file upload
  Thread.new { ftp_send_file("the_big_file_#{i}") }
}

# Main thread waits for all upload threads to finish
(Thread.list - [Thread.current]).each(&:join) 
```

正如你所看到的，启动一个线程并没有那么复杂。只需阅读[`Thread`文档](http://www.ruby-doc.org/core-1.9.3/Thread.html)。里面还有很多例子。

# php - 提交表单下载php脚本

> ID：10957833
> 
> 赞同：2
> 
> 时间：2012-06-09T02:07:43.433
> 
> 标签：php

当我提交此表单时，它会下载它引用的 php 脚本：

```
<form action="insertcustomer.php" method="post" class="myform">
<p>
    Name: &nbsp; <input type="text" name="name" size="20"/>
</p>
<p>
    Address: &nbsp; <input type="text" name="addr" size="40"/></p>
<p>
    City: &nbsp; <input type="text" name="city" size="20"/>
    State: &nbsp; <input type="text" name="state" size="3"/>
    Phone: &nbsp; <input type="text" name="phone" size="15"/>
</p>
<p>
    Account Balance: &nbsp; <input type="text" name="acct_balance" size="13"/>
</p>
<p class="bttn">
    <input class="b" type="submit" name="query" value="Insert Customer"/>&nbsp;
    <input class="b" type="reset" name="reset" value="Clear Form"/>
</p>

</form> 
```

插入客户.php：

```
$name = $_POST['name'];
$addr = $_POST['address'];
$city = $_POST['ccity'];
$state = $_POST['cstate'];
$phone = $_POST['phone'];
$acct_balance = $_POST['acct_balance']; 
```

代码有问题吗？我已按照[本文](http://maestric.com/doc/mac/apache_php_mysql_snow_leopard)中提到的所有步骤进行操作，但每次单击提交按钮时，它都会下载 php 文件。我提前道歉，因为我对 php 还很陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T02:19:46.843

*   确保您的代码包含在`<?php`和`?>`
*   你的服务器支持 PHP 吗？
*   您的服务器配置正确吗？

# facebook-fql - 使用大型 fql 查询的内部服务器错误

> ID：10957834
> 
> 赞同：0
> 
> 时间：2012-06-09T02:07:47.387
> 
> 标签：facebook-fql

我正在运行这个查询：

```
{"my_friends":"SELECT uid2 FROM friend WHERE uid1=me()",
 "check_ins":"SELECT coords, tagged_uids, author_uid, page_id, message, timestamp
              FROM checkin WHERE author_uid=me() OR author_uid
              IN (SELECT uid2 FROM %23my_friends)",
 "tagged_check_in_users":"SELECT uid from user
                          where ((uid in (select tagged_uids from %23check_ins))
                          OR (uid in (select author_uid from %23check_ins)))
                          AND uid <> me()"} 
```

当当前用户有很多朋友（超过 200 个，或多或少）时，我得到“内部服务器错误”。当我更改“my_friends”表查询并添加 100 个朋友的限制时，查询工作正常。

有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T14:18:57.323

我认为这可能是由于该`IN`条款的某些限制造成的。一些 SQL 数据库也有这个限制，例如 Oracle SQL 在`IN`子句中支持多达 1000 个元素。我没有发现 FQL 文档中提到的任何此类限制，但这并不意味着没有。

另外，我想一个朋友可以有多个签到，所以即使第一个`IN`子句工作得很好，第二个和第三个子句也可能是问题所在。因此，在人们进行大量签到的某些情况下，即使有限制，您也会收到错误消息。

尝试限制签入并告诉我它是否有效。但是，如果您需要保证查看了所有签到，这不是最佳解决方案。在这种情况下，我猜你将不得不创建两个查询，首先要求签入，然后在第二个查询中检索有关标签的信息，并有自己的限制。

# c - 在 C 中验证整数值

> ID：10957839
> 
> 赞同：1
> 
> 时间：2012-06-09T02:08:29.957
> 
> 标签：c

我已经在顶部的注释块中记录了程序规范。在函数 displayNameByValue 中，我传入了一个名为 passValue 的整数变量，它存储了用户名将显示到控制台的次数。我希望能够解决用户输入错误并验证用户传入的任何非整数表示的输入。处理这种情况的最佳解决方案是什么？

这是我的代码：

```
/*******************************************************************************
 Concept:
         1.) Display the Programmer's Name
         2.) Display the Programmer's Name Again
         3.) Display the Programmer's Name X Times
         4.) Display a Triangle of an Entered Character
         5.) Exit the Program 
*******************************************************************************/

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <limits.h>

char displayMenu();
void displayName(char *userName);
void displayNameAgain(char *userName);
int displayNameByValue(char *userName, int passValue);

char *userName = "Demetrius \n";

int main()
{
    char menuOption;
    int passValue = 0;

menuOption = displayMenu();
while(menuOption != 'E')
{
   switch(menuOption)
   {
     case 'A':
              displayName(userName);
              break;
     case 'B':
              displayNameAgain(userName);
              break;
     case 'C':
              displayNameByValue(userName, passValue);
              break;
     case 'D':
              // currently working @ the moment...
              break;
     default:
              printf("You've entered an invalid character entry! \n\n");
              break;
    }
              menuOption = displayMenu();
}

system("pause");
return 0;
}

char displayMenu()
{
char menuChoice;

printf("**********************************************************\n");
printf("A. Display the Programmer's Name                         *\n");
printf("B. Display the Programmer's Name Again                   *\n");
printf("C. Display the Programmer's Name X times                 *\n");
printf("D. Display a Triangle of an Entered Character            *\n");
printf("E. Exit the Program                                      *\n");
printf("**********************************************************\n\n");

printf("Enter a character that corresponds to the menu above :\n");
scanf("%s", &menuChoice);

menuChoice = toupper(menuChoice); // Assigns all menu submissions to uppercase 

return menuChoice;
}

void displayName(char *userName)
{
 printf("%s", userName);
}

void displayNameAgain(char *userName)
{
 printf("The programmer's name is : %s" , userName);
}

int displayNameByValue(char *userName, int passValue)
{
int index;

printf("Enter the number of times to display your name :");
scanf("%d", &passValue);

for(index = 0; index < passValue; index++)
{
          printf("%s\n", userName);
}

printf("Your name was displayed : %d times\n", index);

return passValue;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:25:59.623

由于参数`int passValue`是一个整数，它总是（根据定义）在 INT_MIN 到 INT_MAX 范围内的某个位置。

如果您有兴趣确保该值在较窄的范围内（例如至少 1 且小于 100），您可以在程序中为 MIN_ACCEPTABLE 和 MAX_ACCEPTABLE 值定义常量，并进行如下测试

```
if (passValue < MIN_ACCEPTABLE || passValue > MAX_ACCEPTABLE)
{
    // Report the error somehow
} 
```

编写的函数不允许“坏”（如非整数）输入，因为参数是整数类型。

如果您的意图是将 a 转换`char *`为 int，请查看[strtol](http://www.codingunit.com/c-reference-stdlib-h-function-strtol)。

# python - pyinotify 代码清理 smtplib

> ID：10957842
> 
> 赞同：0
> 
> 时间：2012-06-09T02:09:14.603
> 
> 标签：python, smtplib, pyinotify

新编码器在这里

我希望能够稍微清理一下这段代码。我希望能够将 smtplib 的内容移出课堂，但我仍然需要它来发送包含 pinotify 数据的电子邮件如果您查看我的代码，您会看到。这是非常多余的。

如果通知数据 > 发送包含文件创建数据的电子邮件

如果通知数据 > 发送包含文件已删除数据的电子邮件

我该如何巩固这一点。

```
import os, pyinotify, time, smtplib, string
from pyinotify import WatchManager, Notifier, ThreadedNotifier, EventsCodes, ProcessEvent

wm = WatchManager()
mask = pyinotify.IN_DELETE | pyinotify.IN_CREATE  # Watched Events

class PTmp(ProcessEvent):
  def process_IN_CREATE(self,event):
    output = "Created: %s " % os.path.join(event.path, event.name) 
    localtime = time.asctime( time.localtime(time.time()) )
    final = output + localtime
    SUBJECT = "Directory Changed"
    TO = "user@localhost"
    FROM = "user@domain.net"
    text = final
    BODY = string.join((
            "From: %s" % FROM,
            "To: %s" % TO,
            "Subject: %s" % SUBJECT ,
            "",
            text
            ), "\r\n")  
    s=smtplib.SMTP('localhost')
    s.sendmail(FROM, TO, BODY)
    s.quit()
  def process_IN_DELETE(self,event):
    output = "Removed: %s" % os.path.join(event.path, event.name)
    localtime = time.asctime( time.localtime(time.time()) )
    final = output + localtime
    SUBJECT = "Directory Changed"
    TO = "user@localhost"
    FROM = "user@domain.net"
    text = final
    BODY = string.join((
            "From: %s" % FROM,
            "To: %s" % TO,
            "Subject: %s" % SUBJECT ,
            "",
            text
            ), "\r\n")
    s=smtplib.SMTP('localhost')
    s.sendmail(FROM, TO, BODY)
    s.quit()

notifier=Notifier(wm, PTmp())
wdd=wm.add_watch('/var/test',mask,rec=True)

while True:  # Loop Forever
  try:
     # process the queue of events as explained above
     notifier.process_events()
     if notifier.check_events():
        # read notified events and enqeue them
        notifier.read_events() 

  except KeyboardInterupt:
     # Destroy the inotify's instance on this interupt(stop monitoring)
     notiifier.stop()
     break 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T07:51:43.183

如果你想让你的代码更好，可以做的第一件事就是将所有常量放在单独的文件中，比如 myapp.conf：

```
 SUBJECT = {'dc':'Directory changed', 'sf':'Server fault' and etc}
 TO = 'user@localhost'
 FROM = 'user@localhost'
 and etc ... 
```

为了形成邮件正文，您可以使用像 Mako 这样的模板引擎，并使用它您可以将邮件模板放置到另一个单独的文件中。你可以将你的类实现与主代码分开。之后，您的代码将保持更灵活，并且更易于维护。

# javascript - 覆盖元素而不替换它

> ID：10957844
> 
> 赞同：2
> 
> 时间：2012-06-09T02:09:34.323
> 
> 标签：javascript, jquery, html, css, dom

说我有这样的事情：

```
<a href="/ad.php?go=123">
    <div class="ad"></div>
</a> 
```

假设`<div>`它的高度为 50，宽度为 250，以及一些通用横幅的背景。

我想要做的不是替换它（这意味着删除原件），而是创建一个（我设想的）绝对定位的副本，除了背景为白色和更高`z-index`，使广告不可见。

可以把它想象成 adblock 所做的事情，除了没有切换实际的广告，而是用白色覆盖它。

做这样的事情的最好方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:23:49.403

只需选择锚点并设置`visibility:hidden`。元素将保留，布局将保持不变，但广告将不可见。

```
$('a').css('visibility', 'hidden'); // replace 'a' with the appropriate selector for your ads, of course 
```

**艰难地去做**

`.width()`使用和获取所选元素的尺寸`.height()`。使用 . 创建一个新元素并设置高度、宽度和 zindex `.css()`。糟糕的部分是定位它。通常，您只需使用`.offset()`获取顶部和左侧就可以逃脱。有时它更棘手。我推荐[jQuery UI 定位插件](http://jqueryui.com/demos/position/)。此外，调整浏览器窗口大小时，定位将关闭。您需要处理`$(window).resize()`和重新定位所有叠加层。它会闪烁，看起来像垃圾......这就是为什么你应该使用`visibility:hidden`. 但是，适合自己。

但至少：

```
var $a = $('.ad');

$a.each(function() {
    var $this = $(this);
    $this.before($('<div></div>')
         .addClass('ad-overlay')
         .css({
            height: $this.height(),
            width: $this.width(),
            'z-index': 1000,
            'background-color': 'white',
            position: 'absolute',
            top: $this.offset().top,
            left: $this.offset().left
        }));
}); 
```

这是一个小提琴。[http://jsfiddle.net/HakedByChinese/SF4tw/4/](http://jsfiddle.net/HackedByChinese/SF4tw/4/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T02:30:37.753

首先，您需要在网站底部放置一个 div 来放大并放置在顶部。

然后将其放大并将其放置在顶部。

```
<script type="text/javascript">
document.getElementsByTagName('body')[0].innerHTML += "<div id=\"adblocker\" style=\"background-color:#FFF; position:absolute; z-index:999; display:block;\"></div>"
var blocker = document.getElementById('adblocker');
var ad = document.getElementById('ad');
blocker.style.top = ad.offsetTop+"px";
blocker.style.left = ad.offsetLeft+"px";
blocker.style.width = ad.offsetWidth+"px";
blocker.style.height = ad.offsetHeight+"px";
</script> 
```

我已经在 Firefox 和 Chrome 中对此进行了测试，如果它不起作用，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T07:11:14.847

我会选择更通用的选项，将叠加层插入要隐藏的元素中

```
var overlayElement = function (element) {
    var originalDiv = element,
        overlayDiv = document.createElement('div'),
        overlayStyle = overlayDiv.style;
    originalDiv.style.position = 'relative';
    // either:
    overlayStyle.position = 'absoluete';
    overlayStyle.top = 0;
    overlayStyle.left = 0;
    overlayStyle.width = '100%';
    overlayStyle.height = '100%';
    overlayStyle.background = 'white';
    // or pre set it with a css class and:
    overlayDiv.className = 'overlay-div';
    // finally:
    originalDiv.appendChild(overlayDiv);
    return overlayDiv; // just so you can go on working with it
}
var myOverlayElement = overlayElement(document.getElementById('divId')); 
```

# onchange - 是否可以检测何时检测到新元素

> ID：10957846
> 
> 赞同：0
> 
> 时间：2012-06-09T02:09:54.260
> 
> 标签：onchange, emoticons

我正在编写这个在 Campfire 聊天中包含表情符号的脚本。我想知道是否可以检测到元素（A DIV）何时发生变化。

例如，如果我在该元素上附加一些东西，我可以使用这样的代码来查看它是否发生了变化。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:21:02.427

如果您想支持此 HTML5 功能，请捕获突变事件。否则定期遍历 DOM 树以查找更改。

如果只是文本，您可以使用 documenttext 属性将文档中的所有文本压缩为字符串。并查看它是否与您上次轮询时的文档文本匹配。

# windows - 共享分区 ubuntu 和 Windows

> ID：10957852
> 
> 赞同：3
> 
> 时间：2012-06-09T02:10:11.397
> 
> 标签：windows, linux, ubuntu, filesystems, operating-system

为了在 Ubuntu 和 Windows 中都可以访问一个分区，我有一个格式化为 fat32（或 vfat）的驱动器，我刚刚发现它不包含大小超过 ~4.3Gb 的单个文件。windows和linux都支持其他fs吗？我想从两个操作系统读取和写入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T02:24:24.990

你试过NTFS吗？它应该适用于两者。尽管您显然没有该文件系统的 Unix 权限。但是您应该能够将它安装在 Windows 和 Linux 上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T02:26:27.863

Linux 可以使用 NTFS 3g 读写 NTFS 分区。这可能是你最好的选择。

其他选项包括可以访问 ext-2、3 或 4 的基于 Windows 的实用程序，但很少集成为驱动程序，而且那些显然不可靠的。

# c# - 如何生成随机颜色？

> ID：10957854
> 
> 赞同：3
> 
> 时间：2012-06-09T02:10:34.103
> 
> 标签：c#, arrays, colors

所以我在 c# 中乱七八糟，想知道如何从数组生成我的字符串，但颜色是随机的：

```
 while (true)
        {
            string[] x = new string[] { "", "", "" };
            Random name = new Random();
            Console.WriteLine((x[name.Next(3)]));
            Thread.Sleep(100);
        } 
```

当我输出 x 时，我希望它是随机颜色。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T02:16:52.153

```
// Your array should be declared outside of the loop

string[] x = new string[] { "", "", "" }; 
Random random = new Random();     

// Also you should NEVER have an endless loop ;)
while (true)         
{            
     Console.ForegroundColor = Color.FromArgb(random.Next(255), random.Next(255), random.Next(255));

     Console.WriteLine((x[random.Next(x.Length)]));             
     Thread.Sleep(100);         
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T02:20:54.773

如果要使用标准控制台颜色，可以混合[ConsoleColor 枚举](http://msdn.microsoft.com/en-us/library/system.consolecolor.aspx)和[Enum.GetNames()](http://msdn.microsoft.com/en-us/library/system.enum.getnames.aspx)以获得随机颜色。然后，您将使用[Console.ForegroundColor](http://msdn.microsoft.com/en-us/library/system.console.foregroundcolor.aspx)和/或[Console.BackgroundColor](http://msdn.microsoft.com/en-us/library/system.console.backgroundcolor)来更改控制台的颜色。

```
// Store these as static variables; they will never be changing
String[] colorNames = ConsoleColor.GetNames(typeof(ConsoleColor));
int numColors = colorNames.Length;

// ...

Random rand = new Random(); // No need to create a new one for each iteration.
string[] x = new string[] { "", "", "" };
while(true) // This should probably be based on some condition, rather than 'true'
{
    // Get random ConsoleColor string
    string colorName = colorNames[rand.Next(numColors)];
    // Get ConsoleColor from string name
    ConsoleColor color = (ConsoleColor) Enum.Parse(typeof(ConsoleColor), colorName);

    // Assuming you want to set the Foreground here, not the Background
    Console.ForegroundColor = color;

    Console.WriteLine((x[rand.Next(x.Length)]));
    Thread.Sleep(100);
} 
```

# node.js - 如何处理 NodeJS 中的文件上传？

> ID：10957856
> 
> 赞同：0
> 
> 时间：2012-06-09T02:11:21.470
> 
> 标签：node.js, file-upload, request

我有这个代码：

```
http.createServer(function (req, res) {
  if (req.method.toLowerCase() === "post") {
    res.writeHead(200);
    req.on('data', function (data) {
      console.log(data.toString());
    });
    res.end();
  }
}).listen(8006); 
```

如果我尝试使用 curl 之类的命令上传文件`curl http://localhost:8006/upload -X POST -F file=@filetoupload.txt`，我将得到文件名和打印出的文件内容，在这种情况下如下：

```
------------------------------5d02ba973600
Content-Disposition: form-data; name="file"; filename="filetoupload.txt"
Content-Type: text/plain

<!-- start slipsum code -->

Do you see any Teletubbies in here? Do you see a slender
plastic tag clipped to my shirt with my name printed on
it? Do you see a little Asian child with a blank expression
on his face sitting outside on a mechanical helicopter that
shakes when you put quarters in it? No? Well, that's what
you see at a toy store. And you must think you're in a
toy store, because you're here shopping for an infant
named Jeb.

<!-- end slipsum code -->

------------------------------5d02ba973600-- 
```

现在的问题是，有没有什么好的方法可以捕获文件名的值和文件的内容？还是我必须使用某种正则表达式巫毒来提取上面内容的值？

我想在没有任何第三方模块（如 express）的情况下执行此操作，首先是因为我想了解它是如何工作的，其次是因为 express 的 bodyParser() 将所有文件保存到磁盘，然后像强大的其他模块必须从磁盘读取，并且我正在尝试制作将文件上传直接传输到 Rackspace CloudFiles 的东西，而无需先保存到磁盘。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T14:09:13.287

看看[http://www.componentix.com/blog/13/file-uploads-using-nodejs-once-again](http://www.componentix.com/blog/13/file-uploads-using-nodejs-once-again)它应该让你开始文件上传

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T03:23:31.660

通读 Formidable 中的代码（Connect 和 Express 用于处理文件上传）并将其用作起点，修改您不喜欢的行为（例如保存到磁盘）。

# python - 使用 inbox.py 和 nginx 处理电子邮件

> ID：10957863
> 
> 赞同：1
> 
> 时间：2012-06-09T02:12:46.497
> 
> 标签：python, email, nginx

我有一个在 gunicorn 和 Nginx 后面运行的 Flask Web 应用程序。Nginx 将任何流量代理`mysite.org`到正确的烧瓶应用程序。

我非常想使用 inbox.py 来处理一些传入的电子邮件。但是在我的服务器上运行 inbox.py 的示例然后向其发送电子邮件`hello@mysite.org`并不能按我的预期工作。inbox.py 服务器似乎没有收到任何内容，但电子邮件也没有退回。

我在概念上遗漏了一些东西——我需要配置 DNS 设置还是需要使用 Nginx 进行调整？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T12:08:30.123

简短的回答是阅读电子邮件（和 DNS）的工作原理，并研究 mysite.org 的电子邮件托管。请参阅电子邮件中的以下链接之一：

*   [http://en.wikipedia.org/wiki/Email](http://en.wikipedia.org/wiki/Email)
*   [http://computer.howstuffworks.com/e-mail-messaging/email.htm](http://computer.howstuffworks.com/e-mail-messaging/email.htm)
*   [http://www.niso.org/khelp/kmlm/user_help/html/how_email_works.html](http://www.niso.org/khelp/kmlm/user_help/html/how_email_works.html)

一个更长的答案是：对于电子邮件的工作，它依赖于名称解析和邮件服务器（SMTP 服务器和可能的 MDA 服务器 [例如 POP3、IMAP]）。对于要传送到 mysite.org 的邮件，必须有一个用于 mysite.org 的权威 dns 服务器，其 MX 记录指向接受 mysite.org 域的电子邮件的服务器（或名为 mysite.org 的服务器正在运行邮件服务器）。

我不确定 inbox.py 做了什么，但我认为它是某种网络表单到电子邮件脚本。如果是这种情况，那么上述步骤仍然适用，可能需要将 inbox.py 配置为将电子邮件转发到配置为处理 mysite.org 域的邮件的邮件服务器。

# css - 如何使用 CSS 继承来获取按钮颜色

> ID：10957864
> 
> 赞同：1
> 
> 时间：2012-06-09T02:12:54.197
> 
> 标签：css

我已经创建了一个基本的按钮样式。我想要一个蓝色版本和一个灰色版本。蓝色类选择器和灰色类选择器永远无法识别，为什么不呢？

```
a.checkout-button {
    -webkit-transition:border-color 0.218s;
    background-position: initial initial;
    background-repeat: initial initial;
    border:0 solid #DCDCDC;
    border-bottom-left-radius: 3px;
    border-bottom-right-radius: 3px;
    border-top-left-radius: 3px;
    border-top-right-radius: 3px;
    color: #EEEEEE;
    display: inline-block;
    font-family: 'Arimo', Arial, sans-serif;
    font-size: 16px;
    font-style: normal;
    font-variant: normal;
    font-weight: normal;
    line-height: normal;
    margin-right: 10px;
    padding: 4px 12px;
    position: relative;
    text-decoration: none;
    text-shadow: #FFFFFF 0 0 0;
    text-transform: uppercase;
}
a.checkout-button .blue {
    background: -webkit-gradient(linear,0% 10%,0% 70%,from(#4533A9),to(#202020));
    background: -moz-linear-gradient(linear,0% 10%,0% 70%,from(#4533A9),to(#202020));
}
a.checkout-button .gray {
    background: -webkit-gradient(linear,0% 10%,0% 70%,from(#4533A9),to(#202020));
    background: -moz-linear-gradient(linear,0% 10%,0% 70%,from(#4533A9),to(#202020));
} 
```

和html

```
<a class="checkout-button gray" id="cancel-btn" href="">Cancel</a>
<a class="checkout-button blue" id="express-checkout-btn" href="">Express Checkout</a> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T02:24:04.860

更改此行：

```
a.checkout-button .gray { 
```

对此：

```
a.checkout-button.gray { 
```

**并**更改此行：

```
.a.checkout-button .blue { 
```

对此：

```
a.checkout-button.blue { 
```

编辑：这样做的原因是正确的 css 格式是将类与中间的 a 串在一起`.`。如果你留下一个空格，像这样: `a.checkout-button .gray`，这会将样式应用于任何具有`gray`INSIDE 元素的类的`a.checkout-button`元素。

# objective-c - 一个UIButton两个场景只有一个segue，需要条件代码

> ID：10957865
> 
> 赞同：5
> 
> 时间：2012-06-09T02:13:18.287
> 
> 标签：objective-c, ios, xcode, presentmodalviewcontroller, uistoryboardsegue

我在我的 Xcode 项目的故事板文件中创建了几个场景，加载的第一个场景是用户登录屏幕。当用户登录 UIButton 时，“登录”会将用户带到欢迎屏幕。我使用模态segue在情节提要中设置它。我希望将名为“admin”的用户带到欢迎管理屏幕。我很确定只能将一个 segue 与一个对象关联，即情节提要中的 UIButton，所以我很困惑如何完成登录以将管理员带到管理员欢迎屏幕，并将所有其他用户带到用户欢迎屏幕。我真的不想创建两个单独的登录按钮，所以这不是一个选项。

我遇到了一些带有类似问题的 stackoverflow 帖子，但所有答案似乎都有些复杂。请记住，我是 Xcode 的新手，所以如果您在答案中粘贴代码，请指定代码应该放入哪个文件（这对我有很大帮助）。我将发布我的故事板到目前为止的样子，以帮助展示我正在谈论的内容的可视化图表。

![在此处输入图像描述](../Images/ce041c5e88193245c54c4b788113b845.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T02:51:03.540

如果我正确理解了您的问题，以下是您需要采取的步骤才能使其发挥作用：

1.  从`WelcomeViewController`- 你有用户名/密码登录按钮的地方，控制+拖动`UIViewController`到`WelcomeScreen`，然后`Modal`从弹出菜单中选择（*从 UIViewController 拖动*我的意思是，选择`UIViewController`故事板中的，底部有一个圆形图标，从那个到目标视图控制器）。将 segue 标识符命名为“UserSegue”

2.  重复步骤 1，但改为控制 + 将其拖动到`Admin`屏幕。将 segue 标识符命名为“AdminSegue”

3.  你现在需要子类化`WelcomeViewController`，

4.  实施`-(IBAction)login:(id)sender`

    > ```
    > - (IBAction)login:(id)sender {
    > 
    >     // assuming you have hooked up the user name text field
    > 
    >     if ([self.usernameTextField.text isEqualToString:@"admin"]) {
    >         [self performSegueWithIdentifier:@"AdminSegue" sender:sender];
    >     }
    >     else {
    >         [self performSegueWithIdentifier:@"UserSegue" sender:sender];
    >     }
    > } 
    > ```

5.  在情节提要中，将登录按钮连接到步骤 4 中的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T02:43:18.577

没错——你只能从一个按钮（或其他控件）获得一个传出的 segue。

但是，您可以从视图控制器获得任意数量的传出 segue。与附加到按钮（或其他控件）的那些不同，当点击控件时不会自动调用来自视图控制器的 segue - 您必须在代码中执行此操作，但在代码中执行此操作可让您灵活地根据到你需要的任何条件。

要从视图控制器进行转场，请从 IB 中其视图（橙色圆圈）下方的视图控制器图标或从其在场景轮廓中的条目进行控制拖动。创建segue 后，给它一个唯一的标识符（例如“mySegue”）。

然后，创建一个连接到您的按钮的操作方法。在该方法的实现中（大概在包含按钮的视图控制器中），测试您需要的任何条件，并调用`[self performSegueWithIdentifier:@"mySegue"]`以执行 segue。

如果有帮助，我[对类似问题的回答中](https://stackoverflow.com/a/10197503/957768)有更多解释。

# ruby-on-rails - 如何使用 webkit 或 selenium 驱动程序从 capybara 填充 ckeditor

> ID：10957869
> 
> 赞同：20
> 
> 时间：2012-06-09T02:14:50.220
> 
> 标签：ruby-on-rails, selenium, webkit, ckeditor, capybara

假设我正在使用像 capybara-webkit 或 selenium 这样的支持 javascript 的驱动程序，我如何填充 Capybara 中的 CKEditor 区域？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-09T02:14:51.297

受我在[这里](http://saratrice.com/2011/03/09/testing-ckeditor-in-ruby-on-rails-with-cucumbercapybara/)发现的启发，我想出了使用 javascript 将数据设置在隐藏对象`textarea`和`CKEditor`对象上的解决方案。两者似乎都不够，视情况而定。

```
def fill_in_ckeditor(locator, opts)
  content = opts.fetch(:with).to_json # convert to a safe javascript string
  page.execute_script <<-SCRIPT
    CKEDITOR.instances['#{locator}'].setData(#{content});
    $('textarea##{locator}').text(#{content});
  SCRIPT
end

# Example:
fill_in_ckeditor 'email_body', :with => 'This is my message!' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-06-09T12:57:49.033

[Marc-André 精彩回答的](https://stackoverflow.com/a/10957870/518204)一个小补充

`person_translations_attributes_2_biography`如果您在同一页面中使用嵌套表单或多个文本区域，则生成的 ID 非常难看，并且很难通过对他的方法的这个小补充写入测试（例如），您可以使用它们的标签而不是 ID 来定位 ckeditor

```
# Used to fill ckeditor fields
# @param [String] locator label text for the textarea or textarea id
def fill_in_ckeditor(locator, params = {})
  # Find out ckeditor id at runtime using its label
  locator = find('label', text: locator)[:for] if page.has_css?('label', text: locator)
  # Fill the editor content
  page.execute_script <<-SCRIPT
      var ckeditor = CKEDITOR.instances.#{locator}
      ckeditor.setData('#{params[:with]}')
      ckeditor.focus()
      ckeditor.updateElement()
  SCRIPT
end 
```

以这种方式而不是这样

```
fill_in_ckeditor 'person_translations_attributes_2_biography', with: 'Some text' 
```

你可以写这个

```
fill_in_ckeditor 'Biography', with: 'Some text' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-20T10:33:40.040

对我来说[，Marc-André 的回答](https://stackoverflow.com/questions/10957869/how-to-fill-ckeditor-from-capybara-with-webkit-or-selenium-driver/10957870#10957870)在 webkit 驱动程序中切换 iframe 上下文。请参阅[此 capybara-webkit 问题](https://github.com/thoughtbot/capybara-webkit/issues/620)

我找到了另一种填充 ckeditor 输入的方法，它不会改变 iframe 上下文：

```
 def fill_in_ckeditor(id, with:)
    within_frame find("#cke_#{id} iframe") do
      find('body').base.send_keys with
    end
  end 
```

并称之为

`fill_in_ckeditor 'comment', with: 'This is my message!'`

适用于 webkit 和 selenium 驱动程序

受[这篇文章的启发](https://medium.com/@jeffreyqua/capybara-and-div-contenteditable-ef3fe07de765)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-09T21:55:29.977

RSpec + Capybara 支持文件与 ckeditor 实例一起使用

```
module Ckeditor
  class Instance
    attr_reader :capybara
    private :capybara

    def initialize(instance_id, capybara)
      @instance_id, @capybara = instance_id, capybara
    end

    def val(value)
      capybara.execute_script "jQuery('textarea##{@instance_id}').val('#{value}')"
    end

    def reload_all
      capybara.execute_script "for(var instance in CKEDITOR.instances) { if(CKEDITOR.instances.hasOwnProperty(instance)) {CKEDITOR.instances[instance].destroy(true);} }"
      capybara.execute_script "CKEDITOR.replaceAll();"
    end
  end
end

# usage
# rte = Ckeditor::Instance.new(:my_instance_id, page)
# rte.val 'foo'
# rte.reload_all
# NOTE: page is provided by Capybara 
```

[https://gist.github.com/3308129](https://gist.github.com/3308129)

# ruby-on-rails - 多重验证 Rails 3 (Rails for Zombies; 2:3)

> ID：10957871
> 
> 赞同：8
> 
> 时间：2012-06-09T02:15:03.637
> 
> 标签：ruby-on-rails

我正在通过 Rails for Zombies 工作，喜欢有用的教程，顺便说一下对其他人感兴趣....

我的问题如下。

教程要求我

“使用新语法在一行上对僵尸名称进行唯一性和存在性验证”

我在 RfZ 的控制台中尝试了以下操作；

* * *

```
class Zombie < ActiveRecord::Base
  validates_uniqueness_of :name, validates_presence_of :name
end 
```

// 和 //

```
class Zombie < ActiveRecord::Base
  validates Name :uniqueness, :presence => true
end 
```

本教程要求使用新的 Rails 3 语法。我了解新语法允许在一行中使用多个验证参数。非常好，但我该怎么做呢？提前谢谢大家。

-瑞安

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-09T02:18:46.003

您的第二次尝试更接近，但并不完全正确。尝试这个：

```
class Zombie < ActiveRecord::Base
  validates :name, :uniqueness => true, :presence => true
end 
```

仅供参考，较旧的语法是：

```
class Zombie < ActiveRecord::Base
  validates_presence_of :name
  validateS_uniqueness_of :name
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T02:18:24.193

```
validates :name, :presence => true, :uniqueness => true 
```

# heroku - heroku dns 多个子域

> ID：10957872
> 
> 赞同：0
> 
> 时间：2012-06-09T02:15:16.133
> 
> 标签：heroku, dns

`example.com -> www.example.com`我使用我的 DNS 提供商重定向

我已经设置`hello.example.com to myapp.herokuapp.com` （CNAME）

并将 hello.example.com 添加到我在 heroku 应用程序上的域列表中。

现在，我想做的是，重定向

```
www.example.com -> hello.example.com 
```

我使用 CNAME 做到了这一点。*但是，除非*我将 www.example.com 添加到 heroku 应用程序的域列表中，否则这不起作用。但我想要的行为是，www 只是重定向到 hello，并且应用程序从 hello 获得服务——甚至不需要涉及 www。这感觉主要是一个 DNS 问题——想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T05:54:15.550

DNS 不执行重定向，尽管一些 DNS 提供商已经添加了看起来可能的功能。你会想在你的应用程序中使用类似 rack-redirect 的东西做某种重定向（如果你正在编写一个 Ruby 应用程序）。如果您不使用 Heroku，那么您的网络服务器通常会这样做。

您本质上想要做的是检查所请求的域，如果它不是您的主要域（即 hello.example.com），那么您将其重定向到 hello.example.com

```
MyApp::Application.config.middleware.insert_before(Rack::Lock, Rack::Rewrite) do 
 r301 %r{.*}, 'http://hello.example.com$&', :if => Proc.new {|rack_env| 
  rack_env['SERVER_NAME'] != 'hello.example.com' 
 } 
end if Rails.env == 'production' 
```

# python - 什么时候适合在 Python 中使用数据库

> ID：10957877
> 
> 赞同：14
> 
> 时间：2012-06-09T02:16:44.867
> 
> 标签：python, database, flat-file

我正在为游戏制作一个小插件，它需要存储有关玩家的信息：

*   用户名
*   IP地址
*   游戏中的位置
*   来自该 IP 的备用用户名或来自该用户名的备用 IP 地址的列表

前段时间看了一篇文章，说除非我存储大量无法保存在ram中的信息，否则我不应该使用数据库。所以我尝试在 python 中使用 shelve 模块，但我不确定这是否是个好主意。

你们认为什么时候使用数据库是一个好主意，什么时候以另一种方式存储信息更好，除了数据库和平面文件数据库之外，还有哪些其他方式来存储信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T02:49:43.443

最重要的是，除非您特别需要性能或高可靠性，否则请尽一切可能使您的代码最简单/最容易编写。

* * *

如果您的数据非常结构化（并且您知道 SQL 或愿意学习），那么使用类似的数据库`sqlite3`可能是合适的。（您应该忽略关于数据库大小和 RAM 的评论：由于数据的结构，有时数据库甚至适用于非常小的数据集。）

如果数据相对简单并且您不需要数据库（通常）具有的可靠性，那么在程序运行时将其存储在一种内置数据类型中可能没问题。

如果您希望存储在磁盘上的数据是人类可读的（并且可以通过一些努力进行编辑），那么像 JSON（有内置`json`模块）这样的格式很好，因为基本的 Python 对象可以毫不费力地序列化。如果数据不是那么简单，那么[YAML](https://en.wikipedia.org/wiki/YAML)本质上是 JSON 的扩展版本（[PyYAML](http://pyyaml.org/)非常好。）。类似地，您可以使用 CSV 文件（`csv`模块），尽管这不如 JSON 或 YAML 好，或者只是一种自定义文本格式（但要获得错误处理等方面的巧妙实现需要付出很多努力）。

最后，如果您的数据包含更高级的对象（例如递归字典或复杂的自定义数据类型），那么使用其中一种内置的二进制序列化技术（`pickle`等`shelve`）*可能*是合适的，但是，YAML 可以处理其中的许多事情（包括递归数据结构）。

一些一般要点：

*   纯文本格式很好，因为它们允许轻松调整值并且易于调试/测试
*   二进制格式很好，因为它们意味着值不能在没有一点额外努力的情况下进行调整（但这并不是说它们不能调整），并且文件大小更小（可能不相关）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-09T02:39:37.530

假设“数据库”是指“关系数据库”——即使是像 SQLite 这样的嵌入式数据库，与纯文本文件相比也会有一些开销。但是，有时与滚动自己的开销相比，这种开销是值得的。

您需要问的最大问题是您是否在存储关系数据 - 规范化和 SQL 查询之类的东西是否有任何意义。如果您需要使用连接在多个表中查找数据，您当然应该使用关系数据库——这就是它们的*用途*。另一方面，如果您需要做的只是根据其主键查找*一个表，那么您可能需要一个 CSV 文件。*如果您坚持的是您在程序中使用的对象，那么 Pickle 和 shelve 很有用 - 如果您可以将相关的魔术方法添加到现有的类中并期望这一切都有意义。

当然，“除非你有大量数据，否则你不应该使用数据库”不是最好的建议——如果你正在使用一个数据库，数据量更多地取决于你可能使用的数据库。例如，SQLite 不适合 Stackoverflow 大小的东西——但是，MySQL 或 Postgres 几乎肯定对于有五个用户的东西来说是矫枉过正的。

# java - 为什么我不能导入 java.util.concurrent.ConcurrentSkipListMap

> ID：10957882
> 
> 赞同：1
> 
> 时间：2012-06-09T02:17:40.050
> 
> 标签：java, import

这是我的代码：

```
package DavidPackages.Other;

import java.util.concurrent.ConcurrentSkipListMap;

public class SkipListTest {
} 
```

这是我得到的错误：

```
cannot find symbol class ConcurrentSkipListMap 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T02:20:15.680

确保您使用的是 Java 6。

[http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListMap.html](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)

# python - 输出：函数与分配给变量的函数

> ID：10957892
> 
> 赞同：2
> 
> 时间：2012-06-09T02:19:50.113
> 
> 标签：python, function, variable-assignment, function-calls

我认为我对函数的工作原理以及如何将它们分配给变量有一个不错的理解。然而，我只是在查看几个月前阅读的一些“艰难地学习 Python”练习（最值得注意的是练习 21），并注意到有关解释器输出的一些有趣的事情。

```
def add(a, b):
    print "ADDING %d + %d" % (a, b)
    return a + b 
```

输出：

```
>>> add(30, 5)
ADDING 30 + 5
35 
```

为什么显示为 35？你不应该写“print add(30, 5)”来显示返回值吗？

```
>>> age = add(30, 5)
ADDING 30 + 5

>>> age
35 
```

变量赋值看起来像它调用函数并输出打印语句而不是返回值......但变量本身显示值 35，为什么变量赋值不做同样的事情？

我希望这些问题是有意义的。我只是想更好地了解幕后发生的事情。如果有人有任何户外阅读，请告诉我！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T02:48:23.617

这是因为交互式解释器会显示您键入的任何表达式的返回值。

您发布的功能有两行。在第一行，它`print()`是标准输出的值。第二个`return`函数的值相同。正如我上面所说，这也被写入*交互式*解释器的标准输出中。

如果您要通过命令行运行脚本（即*不在*交互式解释器中：

```
python myscript.py 
```

您会注意到此返回值不再打印到标准输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T02:49:46.237

您在交互式 Python 提示符下执行此操作，为方便起见，它始终打印最后一个结果，而无需您要求它这样做。否则，您必须一直在打字`print`，这会很快变老。

在适当的脚本中，Python 不会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T02:25:23.767

**添加**两个打印件见：`print "ADDING %d + %d" % (a, b)` 并返回整数（**仅整数**）见：`return a + b`

它总是打印“ **ADDING x + y** ”，不管你想不想。

如果将函数分配给变量，让 cal 它**var**，那么**var**将只有整数，仅此而已（**这就是 add 返回的内容**）。

# python - 带有 FileHandler 的 Django 日志记录不起作用

> ID：10957902
> 
> 赞同：5
> 
> 时间：2012-06-09T02:23:31.290
> 
> 标签：python, django, logging, sentry

我正在使用下面的日志记录设置和一个 django 项目（也使用哨兵/乌鸦）。sentry/raven 位工作正常，但文件记录不是。创建了一个空的日志文件，但每当我使用`logging.info('foo')`时，日志文件中什么都没有出现（即它保持为空）。有什么建议么？

```
LOGGING = {
    'version': 1,
    'disable_existing_loggers': True,
    'root': {
        'level': 'WARNING',
        'handlers': ['sentry'],
    },
    'formatters': {
        'verbose': {
            'format': '%(levelname)s %(asctime)s %(module)s %(process)d %(thread)d %(message)s'
        },
    },
    'handlers': {
        'sentry': {
            'level': 'ERROR',
            'class': 'raven.contrib.django.handlers.SentryHandler',
        },
        'file': {
            'level': 'INFO',
            'class': 'logging.FileHandler',
            'filename': '/var/log/django/breeding.log',
        },
        'console': {
            'level': 'DEBUG',
            'class': 'logging.StreamHandler',
            'formatter': 'verbose'
        }
    },
    'loggers': {
        'django.db.backends': {
            'level': 'ERROR',
            'handlers': ['console'],
            'propagate': False,
        },
        'raven': {
            'level': 'DEBUG',
            'handlers': ['console'],
            'propagate': False,
        },
        'sentry.errors': {
            'level': 'DEBUG',
            'handlers': ['console'],
            'propagate': False,
        },
    },
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-23T15:35:08.503

我遇到了同样的问题。原来是权限问题。当我在配置日志记录后第一次运行开发服务器时，它`/var/log/django/request.log`使用模式 644 创建了我的本地用户 (stretch) 拥有的文件。

当我启动“生产”服务器（nginx/uwsgi）时，该服务将以 www-data 用户身份运行，并且无法打开`/var/log/django/request.log`写入。简单地删除日志文件并重新启动 uwsgi 就足以让它继续运行，但我必须想出一个更优雅的长期修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-23T06:43:36.390

## 这是一个[快速回答](https://stackoverflow.com/a/49974748/3702377)。

* * *

## 更完整：

在 Django 日志记录设置中，请遵循以下脚本：

```
LOGGING = {
    'version': 1,
    'disable_existing_loggers': True,
    'formatters': {
        'verbose': {
            'format': '%(levelname)3.3s %(asctime)22.22s [%(name)s:%(funcName)s] {%(process)d} %(message)s'
        }
    },
    'handlers': {
        'sentry-warn': {
            'level': 'WARNING',
            'class': 'raven.contrib.django.raven_compat.handlers.SentryHandler',
        },
        'sentry-info': {
            'level': 'INFO',
            'class': 'raven.contrib.django.raven_compat.handlers.SentryHandler',
        },
        'sentry-error': {
            'level': 'ERROR',
            'class': 'raven.contrib.django.raven_compat.handlers.SentryHandler',
        },
        'console': {
            'level': 'WARNING',
            'class': 'logging.StreamHandler',
            'formatter': 'verbose'
        },
        'mail_admins': {
            'level': 'ERROR',
            'class': 'django.utils.log.AdminEmailHandler',
        }
    },
    'loggers': {
        'sentry': {
            'level': 'DEBUG',
            'handlers': ['sentry-warn', 'console', 'file', 'sentry-info', 'sentry-error'],
            'propagate': False,
        },
        'sentry-warn': {
            'level': 'DEBUG',
            'handlers': ['sentry-warn', 'console', 'file'],
            'propagate': False,
        },
        'sentry-error': {
            'level': 'DEBUG',
            'handlers': ['console', 'file', 'sentry-error'],
            'propagate': False,
        },
        'sentry-info': {
            'level': 'DEBUG',
            'handlers': ['console', 'file', 'sentry-info'],
            'propagate': False,
        },
        'django': {
            'handlers': ['console', 'file', 'mail_admins'],
            'propagate': False,
        },
    },
    'root': {
        'handlers': ['console', 'file', 'mail_admins'],
        'level': 'INFO'
    },
} 
```

## 测试：

```
from logging import getLogger

logger = getLogger('sentry')
log_war = getLogger('sentry-warn')
log_inf = getLogger('sentry-info')
log_err = getLogger('sentry-error')

logger.warning('warn')
logger.info('info')
logger.error('error')

log_err.error('new error') 
log_war.warning('new warn')  
log_inf.info('new info') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-12T01:58:47.417

为了使其工作，您必须将“*文件*”处理程序添加到每个记录器，如下所示：

```
'loggers': {
    'django.db.backends': {
        'level': 'ERROR',
        'handlers': ['file','console'],
        'propagate': False,
    },
    'raven': {
        'level': 'DEBUG',
        'handlers': ['file','console'],
        'propagate': False,
    },
    'sentry.errors': {
        'level': 'DEBUG',
        'handlers': ['file','console'],
        'propagate': False,
    },
}, 
```

否则，记录器不会向指定文件写入任何内容。

# .net - 在二进制文件上调用 File.ReadAllText() 安全吗？

> ID：10957905
> 
> 赞同：0
> 
> 时间：2012-06-09T02:24:04.083
> 
> 标签：.net, regex, file, text, io

我正在编写一个小程序，它遍历目录中的所有文件并搜索子字符串。
基本上是这样的：

```
s = File.ReadAllText(FileName)
If s.Contains("Find this substring") Then
    MatchesFound += 1
End If 
```

我也有这个程序的正则表达式版本，但仍然使用 File.ReadAllText() 来读取文件。

我应该关心在二进制文件上调用 File.ReadAllText() 吗？
我不介意在搜索结果中出现一些误报，但我不希望我的程序崩溃。
MSDN 文档没有显示由于无法读取或解释文件数据而导致的此方法的任何异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:31:46.690

你的程序不会崩溃。如果文件太长，它可能会占用大量内存。ReadAllText 在返回给您之前释放文件句柄。因此，您的手柄将得到妥善处理。

您的字符串将仅具有二进制文件的文本表示形式。其中大部分可能是无效字符。框架内部使用 unicode 作为字符串 (UTF16)。

您唯一应该关心的是非常大的文件，例如 4GB 的 ISO 文件。如果您的目录中有那么大的文件，那么您可能应该制定更好的算法来提高代码效率，而不是盲目地获取 ReadAllText。

此外，在阅读之前，您可以检查文件大小；如果很明显它是一个纯二进制文件（例如 100MB zip 文件）；您可以跳过它并移至下一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T02:31:00.383

您的代码应该可以工作。调用方法 ReadAllText 返回一个字符串。因此，即使格式不好，最终还是会得到 String。

该方法本身应该为文件相关问题抛出异常；不适用于字符串格式问题。

我能想到的唯一问题是，如果您尝试打开一个太大而无法放入内存的文件，则会引发异常。否则，您的代码应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T06:03:31.737

请注意，这`ReadAllText`取决于猜测的文件编码。二进制文件中的字符串可以以任何编码存储，而不会因为二进制文件的标题而被猜测。另请注意，二进制文件可能会以使阅读器无法正确解码字符串的方式存储正确编码的字符串，例如，因为 UTF-16 字符串从文件中的奇数位置开始。如果读者猜到 UTF-8 编码，甚至还有可能导致字符串的第一个字符被解码为垃圾的编码错误的空间。

# objective-c - 找不到类的接口声明

> ID：10957908
> 
> 赞同：1
> 
> 时间：2012-06-09T02:25:02.267
> 
> 标签：objective-c

我重构了一些代码，在一个子类中没有错误，在第二个子类中我得到了这个错误。

在第一种情况下，界面如下所示：

```
#import <UIKit/UIKit.h>
#import <CoreData/CoreData.h>
#import <QuartzCore/QuartzCore.h>
#import "ResultsHeaderView.h"
#import "ManagingView.h"
#import "CommonEventsTableVC.h"
@class ResultCell;

@interface ResultsTableVC : CommonEventsTableVC <UITableViewDataSource, UITableViewDelegate, NSFetchedResultsControllerDelegate,  resultsHeaderDelegate>{ 
```

在第二种情况下，出现错误，界面如下所示：

```
#import <UIKit/UIKit.h>
#import <CoreData/CoreData.h>
#import "Constants.h"
#import "ManagingView.h"
#import "ResultsHeaderView.h"
#import "CommonEventsTableVC.h"
@class ResultCell;

@interface FavoritesTableVC : CommonEventsTableVC <UITableViewDataSource, UITableViewDelegate, NSFetchedResultsControllerDelegate,  resultsHeaderDelegate>{ 
```

第二种情况下@interface 行上的编译器错误是“找不到'CommonEventsTableVC' 的接口声明，'FavoritesTableVC' 的超类。

我看不出问题。

更新

我能够使用此代码进行无错误编译，但替代方法（如下所示）由于某种原因不起作用：

CommonResultsTableVC.h

```
#import <UIKit/UIKit.h>
#import <CoreData/CoreData.h>
//#import "MapController.h"
//#import "DataInterfaceObject.h"
#import "ManagingView.h"
#import "ResultsHeaderView.h"
@class MapController;
@class DataInterfaceObject;
@class ResultCell;

@interface CommonEventsTableVC : UIViewController {

@private
    DataInterfaceObject *dataInterface_;
    MapController *mapController_;
    id<managingView> managingViewDelegate_;

}

@property (nonatomic, assign) id<managingView> managingViewDelegate;
@property (nonatomic, assign) DataInterfaceObject *dataInterface;
@property (nonatomic, assign) MapController *mapController;

- (id) initWithFrame:(CGRect)frame andController:(id<managingView>)_managingViewController;

@end 
```

结果表VC.h

```
#import <QuartzCore/QuartzCore.h>
#import "CommonEventsTableVC.h"

@interface ResultsTableVC : CommonEventsTableVC <UITableViewDataSource, UITableViewDelegate, NSFetchedResultsControllerDelegate,  resultsHeaderDelegate>{

    NSFetchedResultsController *fetchedResultsController_;
    UITableView *tableView_;

}

... 
```

收藏夹TableVC.h

```
#import "Constants.h"
#import "CommonEventsTableVC.h"

@interface FavoritesTableVC : CommonEventsTableVC <UITableViewDataSource, UITableViewDelegate, NSFetchedResultsControllerDelegate,  resultsHeaderDelegate>{

...

}

...

@end 
```

这是替代方案，它不起作用。我不知道为什么。导入类头文件应该是替代@class 引用的可行方法，但是会发生各种错误。这些错误甚至在 import 语句引用的类文件中。

CommonResultsTableVC.h 替代方案（失败）

```
#import <UIKit/UIKit.h>
#import <CoreData/CoreData.h>
#import "MapController.h"         // uncommented
#import "DataInterfaceObject.h"   // uncommented
#import "ManagingView.h"
#import "ResultsHeaderView.h"
//@class MapController;
//@class DataInterfaceObject;
@class ResultCell; 
```

# maven - Maven插件类加载器找不到应该在类路径中的文件

> ID：10957911
> 
> 赞同：1
> 
> 时间：2012-06-09T02:25:41.807
> 
> 标签：maven, plugins, build, classloader, maven-plugin

我创建了一个新的 Maven 插件来为我正在处理的项目生成一些源文件。每个文件的顶部自然需要公司的版权信息。尽我所能，我想把版权信息放在一个单独的文本文件中，而不是硬编码在源代码中。

在我的插件中，我试图使用`getResourceAsStream()`类加载器提供的方法来获取这个文件：

```
 InputStream inputStream = MyClass.class.getClassLoader().getResourceAsStream(
        "/com/company/java-header.txt"
    ); 
```

当我单独测试插件时，此代码有效。`java-header.txt`正确放置在 Maven 的目标目录中的正确位置，并且测试通过。

现在下一步，我想在另一个 Maven 模块中使用这个插件。如果我不包含每个 java 文件的版权标头，插件将按预期工作。所以我知道我编写 Maven 插件的方式不是另一个问题。

当我使用上面的代码运行插件时，我得到以下异常：

```
 at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:137)
        ... 20 more
Caused by: java.lang.ExceptionInInitializerError
        at com.company.AbstractJavaSchemaFile.generate(AbstractJavaSchemaFile.java:12)
        at com.company.AbstractJavaSchemaFile.generateAndWriteToFile(AbstractJavaSchemaFile.java:8)
        at com.company.SchemaGenerator.generateSchemaBaseClass(SchemaGenerator.java:41)
        at com.company.SchemaGenerator.generateSchemaFiles(SchemaGenerator.java:36)
        at com.company.SchemaGenerator.execute(SchemaGenerator.java:28)
        at com.company.SchemaGenerator.execute(SchemaGenerator.java:20)
        at com.company.SchemaGeneratorMojo.execute(SchemaGeneratorMojo.java:37)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
        ... 20 more
Caused by: com.company.SchemaGeneratorException: Cannot find [com/company/java-header.txt] in your classpath.
        at com.company.JavaSchemaFileBuilder.verifyJavaHeaderIsFoundInClassPath(JavaSchemaFileBuilder.java:47)
        at com.company.JavaSchemaFileBuilder.readJavaHeader(JavaSchemaFileBuilder.java:31)
        at com.company.JavaSchemaFileBuilder.<clinit>(JavaSchemaFileBuilder.java:15) 
```

该错误`com.company.SchemaGeneratorException: Cannot find [com/company/java-header.txt] in your classpath`是自定义错误消息。当`InputStream`类加载器返回的是`null`.

有谁知道如何让 Maven 插件`java-header.txt`从类路径中读取这个文件？据我所知，它使用插件目录中的目标编译文件来运行插件。java-header.txt 文件在那里。这是 Maven 也打印出来的 url 信息：

```
**urls[0] = file:/C:/Path/to/my/project/my-maven-plugin/target/classes/**
urls[1] = file:/C:/Users/me/.m2/repository/org/codehaus/plexus/plexus-utils/2.0.6/plexus-utils-2.0.6.jar
urls[2] = file:/C:/Users/me/.m2/repository/org/codehaus/plexus/plexus-component-annotations/1.5.5/plexus-component-annotations-1.5.5.jar
urls[3] = file:/C:/Users/me/.m2/repository/org/sonatype/sisu/sisu-inject-bean/2.3.0/sisu-inject-bean-2.3.0.jar
urls[4] = file:/C:/Users/me/.m2/repository/org/sonatype/sisu/sisu-guice/3.1.0/sisu-guice-3.1.0-no_aop.jar
urls[5] = file:/C:/Users/me/.m2/repository/org/sonatype/sisu/sisu-guava/0.9.9/sisu-guava-0.9.9.jar
urls[6] = file:/C:/Users/me/.m2/repository/commons-io/commons-io/1.2/commons-io-1.2.jar
urls[7] = file:/C:/Users/me/.m2/repository/dom4j/dom4j/1.3/dom4j-1.3.jar 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T09:41:47.940

someClass.getResource() 将返回路径为 mvn:artifactID/groupID/version。而常规 JVM 中的 r 个文件返回文件协议。基于 OSGi 的 jvm 将返回 maven 路径。

# android - glGenFramebuffersOES 在 Android 中失败

> ID：10957915
> 
> 赞同：0
> 
> 时间：2012-06-09T02:26:24.523
> 
> 标签：android, opengl-es, android-ndk

我正在将游戏从 iPhone 移植到 Android。我正在使用 NDK 和 OpenGLES 2.0。
我在使用以下代码创建带有纹理的帧缓冲区时遇到问题，稍后我将使用该纹理对其进行渲染：

```
glGenFramebuffersOES(1, &glTextureFrameBuffer);
glBindFramebufferOES(GL_FRAMEBUFFER, glTextureFrameBuffer);

// attach renderbuffer
glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, glName, 0);

GLint status = glCheckFramebufferStatus(GL_FRAMEBUFFER);
if(status == GL_FRAMEBUFFER_COMPLETE) {
    cout << "Framebuffer completed" << endl;
} else {
    cout << "Framebuffer error: " << status << endl;
}

// unbind frame buffer
glBindFramebufferOES(GL_FRAMEBUFFER, 0);

cout << "CREATED FRAMEBUFFER ID: " << glTextureFrameBuffer << endl; 
```

这将打印以下内容：

```
Framebuffer error: 0
CREATED FRAMEBUFFER ID: 4294967295 
```

渲染到该纹理什么都不做，所以有些事情失败了，glGenFramebuffersOES (4294967295) 返回的 id 让我认为帧缓冲区永远不会生成。

该代码在 iOS 上运行良好。
知道可能是什么问题吗？

**编辑：**

我添加了错误检查：在 glFramebufferTexture2D 之后我得到了 GL_INVALID_OPERATION。
~~但是在 glGenFramebuffersOES 之后我也收到了 GL_INVALID_VALUE 错误。奇怪的是，在 iphone 上我也遇到了这个错误，但一切正常。~~

~~如果第一个参数为负，我已经阅读了 OpenGLES 文档和 glGenFramebuffersOES 设置 GL_INVALID_VALUE 错误，但事实并非如此。~~

**编辑2：**

我的错，glGenFramebuffersOES 没有设置任何错误，GL_INVALID_VALUE 之前被设置在某个地方。
但是，glFramebufferTexture2D 仍在设置 GL_INVALID_OPERATION，而且 glGenFramebuffersOES 返回的 id 是 4294967295 在我看来也很奇怪。

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T17:14:03.833

你为什么使用`glBindFramebufferOES`而不是`glBindFramebuffer`？OpenGL ES 2.0 在其核心规范中有帧缓冲区，而不是在 OES 扩展中（如 OpenGL ES 1.0 有）。

您已经在使用`glFramebufferTexture2D`函数 not `glFramebufferTexture2DOES`，对吗？所以使用`glGenFramebuffers`函数和也`glGenFramebuffers`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-06T02:44:56.900

如果其他人想知道为什么`glGenFramebuffersOES()`不起作用，我认为 Android 的 OpenGL 2.0 不支持它。

如果您删除 Android 中的显式版本设置`setEGLContextClientVersion(2);`，它应该允许您调用`GLES11Ext.glGenFramebuffersOES()`. 但是，您将失去使用 GLES20 库的所有能力。

这是基于我的猜测，因为当您`checkIfContextSupportsExtension(gl, "GL_OES_framebuffer_object");`使用以下代码调用时：

```
private boolean checkIfContextSupportsExtension(GL10 gl, String extension) {
    String extensions = " " + gl.glGetString(GL10.GL_EXTENSIONS) + " ";
    return extensions.indexOf(" " + extension + " ") >= 0;
} 
```

如果客户端版本设置为 2，它将返回 false

# php - 在下面的示例中将 mysql 转换为 mysqli

> ID：10957919
> 
> 赞同：1
> 
> 时间：2012-06-09T02:28:24.963
> 
> 标签：php, mysql, mysqli

我有一个在应用程序中正常工作的旧 mysql 代码：

```
 $query = "
SELECT * FROM Tutor t  
WHERE 
(t.Tutorusername = '".mysql_real_escape_string($tutorusername)."')
AND
(t.Tutorpassword = '".mysql_real_escape_string($tutorpassword)."')
";

$num = mysql_num_rows($result = mysql_query($query));

while($row = mysql_fetch_array($result))
  {

  ...

} 
```

但我现在想从 Mysql 更改为使用 mysqli。我的问题是下面的 mysqli 代码是否完全正确并且与上面的 mysql 代码相同？

```
$query = $mysqli->prepare("
    SELECT * FROM Tutor t  
    WHERE 
    (t.Tutorusername = '".mysqli_real_escape_string($tutorusername)."')
    AND
    (t.Tutorpassword = '".mysqli_real_escape_string($tutorpassword)."')
    ");

    $query->bind_result($Tutor);

    $num = $query->num_rows($result = $query->execute());

    while($row = $result->fetch())
      {

...

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T03:11:01.490

此处无需使用`preapre()`，因为您正在连接 sql 字符串。

```
$sql="SELECT * FROM Tutor t
        WHERE 
        t.Tutorusername='".mysqli_real_escape_string($tutorusername)."'
        AND 
        t.Tutorpassword = '".mysqli_real_escape_string($tutorpassword)."'");

$result=$mysqli->query($sql);
if($result)
{
 $row=$result->fetch_row();
 if($row)
    print_r($row);
} 
```

对于 prepare() 方法，您必须指定参数：

```
 $sql="SELECT * FROM Tutor t 
          WHERE t.Tutorusername=? AND t.Tutorpassword=?";

   $stmt=$mysqli->prepare($sql);
   $stmt->bind_param("s",$tutorusername);
   $stmt->bind_param("s",$tutorpassword);

   $stmt->execute(); 

   //I presume that the table "T" has three columns
   $stmt->bind_result($col1,$col2,$col2);
   while($stmt->fetch())
   {
     echo "<br/>", $col1,$col2,$col3;
    } 
```

PS：阅读 mysqli API 的 PHP 手册。

# c++ - 有什么方法可以检测函数是否存在并且可以在编译时使用吗？

> ID：10957924
> 
> 赞同：7
> 
> 时间：2012-06-09T02:30:53.587
> 
> 标签：c++, templates, metaprogramming

**编辑：**对我的问题的简短回答是，我对 SFINAE 可以做什么有一个错误的看法，它根本不检查函数体：[sfinae 是否实例化了函数体？](https://stackoverflow.com/questions/3071785/does-sfinae-instantiates-a-function-body)

我有一个类似的问题：[是否可以编写模板来检查函数的存在？](https://stackoverflow.com/questions/257288/is-it-possible-to-write-a-c-template-to-check-for-a-functions-existence/264088#264088)

不同的是，我不仅想检查函数是否存在，还想知道它是否真的会通过 SFINAE。这是我要完成的示例：

```
struct A
{
    void FuncA() { std::cout << "A::FuncA" << std::endl; }
};

struct B
{
    void FuncA() { std::cout << "B::FuncA" << std::endl; }
    void FuncB() { std::cout << "B::FuncB" << std::endl; }
};

template<typename T>
struct Inter
{
    void FuncA() { t.FuncA(); }
    void FuncB() { t.FuncB(); }

    T t;
};

// Always takes some sort of Inter<T>.
template<typename InterType>
struct Final
{
    void CallFuncs()
    {
        // if( t.FuncA() exists and can be called )
            t.FuncA();

        // if( t.FuncB() exists and can be called )
            t.FuncB();
    }

    InterType t;
};

void DoEverything()
{
    Final<Inter<A>> finalA;
    Final<Inter<B>> finalB;

    finalA.CallFuncs();
    finalB.CallFuncs();
} 
```

请注意，在 CallFuncs() 中，FuncA() 和 FuncB() 将始终存在，但根据 Inter 中使用的类型 T，它们可能无法编译。当我尝试在上面链接的问题中使用答案时，它似乎总是给我真实的，我猜是因为它只是检查函数是否存在，而不是它实际上可以编译（尽管我不能排除我没有搞砸什么...）

为了有条件地调用我认为我可以使用 enable_if 的函数：

```
template<typename InterType>
typename std::enable_if< ! /* how to determine if FuncA can be called? */>::type TryCallFuncA( InterType& i )
{
}
template<typename InterType>
typename std::enable_if</* how to determine if FuncA can be called? */>::type TryCallFuncA( InterType& i )
{
    i.FuncA();
}

template<typename InterType>
typename std::enable_if< ! /* how to determine if FuncB can be called? */>::type TryCallFuncB( InterType& i )
{
}
template<typename InterType>
typename std::enable_if</* how to determine if FuncB can be called? */>::type TryCallFuncB( InterType& i )
{
    i.FuncB();
}

template<typename InterType>
struct Final
{
    void CallFuncs()
    {
        TryCallFuncA(t);
        TryCallFuncB(t);
    }

    InterType t;
}; 
```

但我不确定是否有任何方法可以将布尔值传递给 enable_if。有什么办法可以做到这一点，还是我需要回退到某种手动维护的类型特征来指示函数是否存在？

就可用的 C++11 功能集而言，我使用的是 MSVC 2010。

**编辑**：添加一个重要说明，在我的实际情况下，在我需要确定 Inter::FuncA/FuncB 是否会编译的地方，类 Inter 的实现实际上是不透明的，所以我不能只是冒泡孩子类型并检查它们上是否存在函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T03:31:41.960

我现在没有时间检查这一点，但您可以添加`Final`: `template <typename T> struct Final< Inner<T> >;`( 这也有助于确保类型始终为`Inner`. 。您可以提取用于实例化的类型`Inter`。

现在第二个问题是如何使用SFINAE来检测成员函数是否存在。我相信这不应该太复杂（如果你不需要使这个通用）：

```
// Find out whether U has `void f()` member
template <typename U>
struct has_member_f {
    typedef char yes;
    struct no { char _[2]; };
    template<typename T, void (T::*)() = &T::f>
    static yes impl( T* );
    static no  impl(...);

    enum { value = sizeof( impl( static_cast<U*>(0) ) ) == sizeof(yes) };
}; 
```

You might be able to extend this a bit to make it a bit more generic, but the name of the function I don't think you can make generic. Of course, you could write that as a macro that generates `has_member_##arg` and uses `&T:: arg`. The type of the member is probably easier to generalize...

Alternatively, since I don't think this can be made generic, you can use the trick inside `has_member` directly in your type: provide two `callFuncA` overloads, one templated with the optional second argument with the signature that you want and defaulted to `&T::FuncA` that forwards the call, the other with ellipsis that is a noop. Then `callFuncs` would call `callFuncA` and `callFuncB`, and SFINAE will dispatch to either the forwarder or the noon and you get your desired behavior.

```
template<typename T>
struct Final< Inter<T> >
{
    template <typename U, void (U::*)() = &U::FuncA>
    void callFuncA( Inter<T>* x ) {
        x.FuncA();
    }
    void callFuncA(...) {}

    void CallFuncs() {
        callFuncA(&t);                 // Cannot pass nonPOD types through ...
        // Similarly TryCallFuncB(t);
    }
    Inter<T> t;
}; 
```

# javascript - 将下拉菜单选择保存在 cookie 中？

> ID：10957926
> 
> 赞同：11
> 
> 时间：2012-06-09T02:31:24.643
> 
> 标签：javascript, css, cookies, menu

我已经看过几次这个帖子，但我根本无法让代码正常工作。我需要帮助使此下拉菜单将其设置保存到 cookie，因此当用户再次访问该站点时，将保留他们之前的选择。

落下：

```
<select id="ThemeSelect">
    <option value="zelda">Zelda</option>
    <option value="smb2">SMB 2</option>
</select> 
```

作为参考，此代码与 Wordpress 小部件中的一些 Javascript 一起更改 css 代码，例如主题选择器。

我如何将此保存为cookie？我觉得我已经尝试了一切！

编辑：我应该说，但我使用这段代码来更改 CSS：

```
var saveclass = null;
var sel = document.getElementById('ThemeSelect');
sel.onchange = function(){
    saveclass = saveclass ? saveclass : document.body.className;
    document.body.className = saveclass + ' ' + sel.value;
}; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T02:37:36.527

这些方面的东西应该适合你。[在 javascripter.net 上的一篇文章Setting a Cookie from JavaScript](http://www.javascripter.net/faq/settinga.htm)中找到了通过 javascript 创建 cookie 的功能 。

**HTML**：

```
<select id="ThemeSelect" onchange="setCookie('theme', this.value, 365);">
    <option value="zelda">Zelda</option>
    <option value="smb2">SMB 2</option>
</select> 
```

**Javascript**：

```
function setCookie(cookieName, cookieValue, nDays) {
    var today = new Date();
    var expire = new Date();

    if (!nDays) 
        nDays=1;

    expire.setTime(today.getTime() + 3600000*24*nDays);
    document.cookie = cookieName+"="+escape(cookieValue) + ";expires="+expire.toGMTString();
} 
```

**编辑**：

**保存 cookie**

我已为您将这两个功能合二为一。

**HTML**：

```
<select id="ThemeSelect" onchange="saveTheme(this.value);">
    <option value="zelda">Zelda</option>
    <option value="smb2">SMB 2</option>
</select> 
```

**Javascript**：

```
var saveclass = null;

function saveTheme(cookieValue)
{
    var sel = document.getElementById('ThemeSelect');

    saveclass = saveclass ? saveclass : document.body.className;
    document.body.className = saveclass + ' ' + sel.value;

    setCookie('theme', cookieValue, 365);
}

function setCookie(cookieName, cookieValue, nDays) {
    var today = new Date();
    var expire = new Date();

    if (nDays==null || nDays==0)
        nDays=1;

    expire.setTime(today.getTime() + 3600000*24*nDays);
    document.cookie = cookieName+"="+escape(cookieValue) + ";expires="+expire.toGMTString();
} 
```

[现场演示](http://jsfiddle.net/DB2TQ/2/)

**返回页面时读取 cookie**

感谢邓斯莫尔布

我们可以使用这个功能获取cookie，[无耻地从这个问题中窃取](https://stackoverflow.com/questions/4003823/javascript-getcookie-functions)。

```
function readCookie(name) {
  var nameEQ = name + "=";
  var ca = document.cookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
  }
  return null;
} 
```

然后我们需要在页面加载时选择值。下面的代码将实现这一点：

```
document.addEventListener('DOMContentLoaded', function() {
    var themeSelect = document.getElementById('ThemeSelect');
    var selectedTheme = readCookie('theme');

    themeSelect.value = selectedTheme;
    saveclass = saveclass ? saveclass : document.body.className;
    document.body.className = saveclass + ' ' + selectedTheme;
}); 
```

[现场演示](http://jsbin.com/uwuwuw)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T03:05:10.243

**注意：这个答案增加了[Josh Mein 的答案](https://stackoverflow.com/a/10957943/672118)。随意合并它。**

我们可以使用这个功能获取cookie，[无耻地从这个问题中窃取。](https://stackoverflow.com/q/4003823/672118)

```
function readCookie(name) {
  var nameEQ = name + "=";
  var ca = document.cookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
  }
  return null;
} 
```

然后我们需要在页面加载时选择值。下面的代码将完成这一点。

```
document.addEventListener('DOMContentLoaded', function() {
  var themeSelect = document.getElementById('ThemeSelect');
  var selectedTheme = readCookie('theme');

  if (selectedTheme) {
    themeSelect.value = selectedTheme;
  }
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-09T02:38:36.450

您应该研究在 PHP 中创建 Session 变量。

[http://www.w3schools.com/php/php_sessions.asp](http://www.w3schools.com/php/php_sessions.asp)

您可以将变量保存到会话中，并在加载页面时检查您设置的变量的值，根据它的值，下拉菜单可能会以某种方式运行。也许将下拉项目的名称存储为会话变量？

# ruby-on-rails - 控制器重定向的定制

> ID：10957935
> 
> 赞同：0
> 
> 时间：2012-06-09T02:35:21.433
> 
> 标签：ruby-on-rails, devise, paperclip

我正在使用 devise gem 对我的用户进行 CRUD

有一个图像 - 头像 - 我想在用户编辑他的个人资料（注册）后使用回形针进行处理。所以要做到这一点，我想从注册控制器中的更新操作中为他呈现某些模板——它继承自 Devise::RegistrationsController。我不知道更新方法实现的细节，所以我调用超级方法 - 它重定向用户，因此，“渲染”导致双重渲染错误

是否有任何“神奇”的方式来调用模型的所有节省而不设计重定向

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T09:05:22.777

我认为您可以`after_update_path_for`在`RegistrationsController` [https://github.com/plataformatec/devise/blob/master/app/controllers/devise/registrations_controller.rb#L98重新定义](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/registrations_controller.rb#L98)

# ruby - 在 ruby 中访问类变量

> ID：10957936
> 
> 赞同：0
> 
> 时间：2012-06-09T02:36:06.873
> 
> 标签：ruby, class, variables

为什么 ruby​​ 中的类变量的行为不像静态变量，我如何简单地通过执行 Mytest.value 而不是 MyTest.new.value 来访问它？

```
class MyTest
  @@value=0

  def value
    @@value
  end
end

puts MyTest.new.value 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T02:47:53.210

你想要类似的东西

```
class MyTest
  @@value = 0
  def self.value
    @@value
  end
end 
```

`self`使其成为类方法，该类直接调用该方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T02:44:45.807

[编辑] 阅读评论以了解为什么不这样做。

```
class MyTest
  @value=0

  class << self
    attr_accessor :value
  end
end 
```

相反，如果你真的需要以这种方式访问​​变量，我建议使用一个简单的模块。

否则，就像 Joshua Cheek 在原始帖子中评论的那样，您应该为您的类使用实例变量并拥有访问器。

# bash - 使用 sed 或 awk 删除每行的特定索引内容以外的所有内容

> ID：10957944
> 
> 赞同：2
> 
> 时间：2012-06-09T02:37:49.077
> 
> 标签：bash, sed, indexing, awk

例如，

在 bash 中，当我键入时，`ps -wef`我会得到：

```
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 20:06 ?        00:00:01 /sbin/init
root         2     0  0 20:06 ?        00:00:00 [kthreadd]
root         3     2  0 20:06 ?        00:00:00 [ksoftirqd/0]
root         6     2  0 20:06 ?        00:00:00 [migration/0]
root         7     2  0 20:06 ?        00:00:02 [watchdog/0]
root         8     2  0 20:06 ?        00:00:00 [cpuset]
root         9     2  0 20:06 ?        00:00:00 [khelper]
root        10     2  0 20:06 ?        00:00:00 [kdevtmpfs]
root        11     2  0 20:06 ?        00:00:00 [netns]
root        12     2  0 20:06 ?        00:00:00 [sync_supers]
root        13     2  0 20:06 ?        00:00:00 [bdi-default]
root        14     2  0 20:06 ?        00:00:00 [kintegrityd]
root        15     2  0 20:06 ?        00:00:00 [kblockd]
root        16     2  0 20:06 ?        00:00:00 [ata_sff]
root        17     2  0 20:06 ?        00:00:00 [khubd]
root        18     2  0 20:06 ?        00:00:00 [md]
root        21     2  0 20:06 ?        00:00:00 [khungtaskd] 
```

我知道我想保留哪一列，例如我想保留第二列，即 PID 列，最终结果将是：

```
1 2 3 6 7 8 9 10 11 12 13 14 15 16 17 18 21 
```

ps原始结果的第一行将被删除。

如何使用 sed 或 awk 获得最终结果？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T02:41:09.807

```
 ps -wef | awk 'NR>1 {printf("%s ", $2)}END{printf("\n")' 
```

我希望这有帮助。，

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T04:29:42.433

您还可以使用该`-o`选项首先仅获取 PID 列：

```
ps --no-headers -eo pid 
```

我放弃了`-w`, `-f`, 因为你看到他们对输出的贡献被抛弃了，并用 . 删除了标题`--no-headers`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T07:05:36.283

这可能对您有用（GNU sed）：

```
sed '1d;s/\S*\s*\(\S*\).*/\1/' file 
```

更灵活的方法：

```
sed '1d;s/\(\(\S*\)\s*\)\{2\}.*/\2/' file 
```

因此，如果您想要该`TIME`列：

```
sed '1d;s/\(\(\S*\)\s*\)\{7\}.*/\2/' file 
```

# macos - NSDocument：无法自动保存文档。该文件已被另一个应用程序更改

> ID：10957946
> 
> 赞同：7
> 
> 时间：2012-06-09T02:37:54.160
> 
> 标签：macos, nsdocument, nspersistentdocument

搜索这篇文章的标题会发现它很常见；确实，我从 Xcode 得到了这个错误。但我似乎找不到任何修复方法。我现在在运行程序时看到它，它似乎发生在调用 changeCountTokenForSaveOperation 期间或之后。它似乎与撤消管理器有关，而不是与我使用核心数据的事实有关，但我可能错了。

有谁知道这是什么原因或如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-08-11T19:41:08.653

`managedObjectContext`当您在NSPersistentDocument 类的代码中执行手动保存时，NSPersistentDocument 可能会发生此错误。这里的问题是您正在修改 NSPersistentDocument 背后的磁盘上的文档。只需将保存操作留给 NSPersistentDocument，就不会发生错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-28T16:42:22.013

问题是手动保存 managedObjectContext。所以正确的解决方案是避免手动保存。如果无法避免，可以重写 NSDocument 的 fileModificationDate 方法，返回文件当前的文件修改日期。这样，文档不会显示错误消息。

```
- (NSDate *)fileModificationDate {
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSDictionary *attrs = [fileManager attributesOfItemAtPath:self.fileURL.path error:NULL];
    return attrs[NSFileModificationDate];
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-07-04T21:49:54.603

我认为这与您可以通过单击方法名称来导航到其他文件的事实有关。如果您在一个文件中进行更改，然后导航到另一个文件，则会留下前一个窗口。您可以单击“返回”三角形再次到达它（位于文件窗口左上角的正上方）。但是，如果它在那个现在黯然失色的窗口中有未保存的更改，并且您在不同的选项卡或窗口中再次编辑相同的文件，XCode 会询问您要保留上述消息中的哪一个。

发生这种情况时，我将磁盘上的文件复制到一个新名称，然后选择“仍然保存”并比较这两个文件。不幸的是，有时每个文件中都有重要的更改，我必须手动合并它们。

我对此感到非常沮丧，我想哭。

# sql-server-2008-r2 - 2008 R2 安装后缺少 SQL Server Management Studio

> ID：10957949
> 
> 赞同：20
> 
> 时间：2012-06-09T02:38:38.000
> 
> 标签：sql-server-2008-r2

刚刚在我的 XP 机器上安装了 SQL Server 2008 R2 Developer Edition。没有 SQL Server Management Studio (SSMS) 的迹象。阿尔格。而且我似乎看不到添加功能中可用的特定选项。我该怎么办？

我确实注意到我的机器已经安装了 SQL Server 2008 的安装文件。所以我卸载了所有东西——首先是 R2，然后是 2008 年的设置，现在当我重新安装 R2 时，功能列表中仍然没有 SSMS 选项。

帮助！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-09T03:13:13.390

您需要转到控制面板，添加/删除功能，选择 SQL Server 2008 R2，然后单击卸载/更改。

它会询问您是否要添加、修复或删除。选择添加。

此时，您必须指向设置文件。因此，如果您有 DVD，则需要指向 DVD 驱动器，否则如果您已安装 ISO 或在本地或网络上有安装文件，则必须指向包含`setup.exe`. 识别安装文件后，您将：

*   在“设置支持文件”对话框中说“确定”
*   在“设置支持规则”对话框中单击下一步
*   在“安装类型”对话框中选择“新安装或添加共享功能”，然后单击“下一步”
*   单击“产品密钥”对话框上的下一步（它应该为您预先填充，或者如果这是零售产品，您可能必须输入产品密钥）
*   接受许可条款并单击下一步
*   安装角色应为“SQL Server 功能安装”，然后单击下一步
*   在“功能选择”对话框中，您应该看到“管理工具 - 基本”和“管理工具 - 完整”选项 - 确保它们都被选中，然后单击“下一步”
*   单击下一步，下一步，下一步，下一步，安装

这是选中“管理工具 - 基本”和“管理工具 - 完成”后“功能选择”对话框的屏幕截图：

![特征选择](../Images/b57907936535a870f70d5f64a4e28387.png)

（如果它们已被选中，请取消并退出设置 - Management Studio 已安装。）

安装完成后，您应该`ssms.exe`在以下位置找到：

```
C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\ 
```

如果您使用的是 32 位机器，我很抱歉。您必须改为查看此处：

```
C:\Program Files\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\ 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-29T22:21:12.063

In some cases the option is just not anywhere on the installation menu. Check my [previous answer](https://stackoverflow.com/questions/5834191/sql-server-management-studio-missing/11713463#11713463).

Basically just use the [Web Platform Installer 4.0](http://www.microsoft.com/web/downloads/platform.aspx) and get this: Products > Database > "Sql Server 2008 R2 Management Objects". Then "Management Tools" will be available, and follow previous answers.

# php - jquery ajax 注销安全

> ID：10957951
> 
> 赞同：0
> 
> 时间：2012-06-09T02:39:25.020
> 
> 标签：php, jquery

当用户登录时，会相应地生成一个会话 ID。页面上有一个“注销”链接。单击链接时，将调用一个 jquery ajax 方法来执行一个 php 文件，该文件只是取消设置会话 id 变量。

如果任何用户使用 Firebug 或任何此类工具来查看调用的文件地址，那么他/她只需将文件地址放在地址栏中，然后按“Enter”键即可执行 php 文件，从而记录我不想发生的用户。

如何防止用户这样做？Http_referrer 或任何类似的东西？

脚本语言是php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T07:54:57.980

我猜您害怕其他人将您的网站注销链接发送给您的某些用户。为了确保您的用户真的想要注销，您可以要求一个必须发送到注销页面的 post 变量。当然，post 变量应该是唯一且保密的值，例如为每个会话生成的随机散列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T02:56:49.707

您可以让 AJAX 调用 POST 一个变量到 PHP 页面，PHP 页面在注销用户之前检查该变量。

如果要确保他们在注销后重定向到主页，请创建指向注销页面的链接，然后使用 PHP 发送`header("Location: home.php");`. 即使禁用了 JavaScript，这还有一个额外的好处。

# rdf - RDF 格式需要改进

> ID：10957955
> 
> 赞同：-3
> 
> 时间：2012-06-09T02:40:26.203
> 
> 标签：rdf, owl, rdflib, rdfs, rdfstore

我能够生成 RDF，但格式不正确，因为我无法触发正确的 Sparql QUERY ..我需要改进 RDF 的格式。我希望在 RDF 中有类、实例、属性对于 Objecttype，Attribbutetype，Relationtype ..你们能帮我推导出 RDF ..code snnipet 会很有帮助...

我粘贴了我能够生成的 rdf。

```
<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF
   xmlns:ns1="http://example.com/nodetypes/2012/04/24/vehicle/"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
 >
  <rdf:Description rdf:about="http://example.com/nodetypes/2012/04/24/vehicle/2">
    <ns1:nodetype_ptr_id>2</ns1:nodetype_ptr_id>
    <ns1:slug>vehicle</ns1:slug>
    <ns1:last_update>2012-04-24 23:49:36.633689</ns1:last_update>
    <ns1:end_publication>2042-03-15 00:00:00</ns1:end_publication>
    <ns1:tree_id>2</ns1:tree_id>
    <ns1:featured>False</ns1:featured>
    <ns1:parent_id>None</ns1:parent_id>
    <ns1:content></ns1:content>
    <ns1:rating_score>0</ns1:rating_score>
    <ns1:rating_votes>0</ns1:rating_votes>
    <ns1:start_publication>2012-04-24 23:49:15</ns1:start_publication>
    <ns1:level>0</ns1:level>
    <ns1:creation_date>2012-04-24 23:49:15</ns1:creation_date>
    <ns1:nodemodel>Objecttype</ns1:nodemodel>
    <ns1:status>2</ns1:status>
    <ns1:template>gstudio/nodetype_detail.html</ns1:template>
    <ns1:content_org>None</ns1:content_org>
    <ns1:excerpt></ns1:excerpt>
    <ns1:plural>vehicles</ns1:plural>
    <ns1:comment_enabled>True</ns1:comment_enabled>
    <ns1:password></ns1:password>
    <ns1:title>vehicle</ns1:title>
    <ns1:login_required>False</ns1:login_required>
    <ns1:pingback_enabled>True</ns1:pingback_enabled>
    <ns1:rurl></ns1:rurl>
</rdf:Description>
</rdf:RDF> 
```

在代码中有一个 rdf 描述

```
 <ns1:nodemodel>Objecttype</ns1:nodemodel>. 
```

因为它是一个对象类型，所以它应该放在 rdf:class 下。我是这个领域的新手，我对 RDF 了解不多。所以任何形式的帮助都会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T03:06:15.130

这些东西的存在不应影响您执行 SPARQL 查询的能力。

此外，这种信息通常在您的 OWL 本体中，而不是在 RDF 中。您可以放入 RDF 的漂亮格式只是……格式……不是信息性的。当您将 RDF 摄取到三重存储时，它就会消失。

# c# - 实时合并 3D 对象

> ID：10957957
> 
> 赞同：4
> 
> 时间：2012-06-09T02:42:31.507
> 
> 标签：c#, c++, 3d, xna, directx

我想知道人们将如何处理合并两个 3D 对象的问题？

用户可以在场景周围放置形状（立方体、长方体、球体、金字塔），当他移动一个对象以与另一个相交时，我希望该对象与另一个对象合并而不是穿过它。

这里有一个图表可以更好地解释： ![在此处输入图像描述](../Images/23bb4a8e716fb83185e853aab31af97f.png)

我在想可能会为这两个模型生成一个点云，然后从与球体相交的长方体中删除点，然后最终从这些点重新创建模型？

所有这些点数据肯定会是一个巨大的性能问题吗？也不太清楚如何从点数据重新创建模型。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T10:26:07.993

我建议看一下 Evan Wallace 写的很棒的[CSG 网站](http://evanw.github.com/csg.js/)。

那是实时代码，非常干净且有文档记录的 JavaScript（请参阅[文档](http://evanw.github.com/csg.js/docs/)），具有自由许可证。

移植到 C# 或 C++ 应该是一项有趣的任务。

# jquery - Jquery如果文本框> 0

> ID：10957960
> 
> 赞同：1
> 
> 时间：2012-06-09T02:43:51.487
> 
> 标签：jquery, syntax-error

所以我很糟糕的是 js，我正在尝试获取一个 jquery 脚本，以 onblur 检查文本框是否有内容，如果有，则继续执行脚本，这就是我所拥有的

```
<script type="text/javascript">
    $(document).ready(function() {
        $("#embed").blur(function (){
            $("#embed").val().length > 0){
                $("#fade").fadeIn(1000);olink = $("#embed").val(); 
                $("#oembed").oembed(olink, {
                    embedMethod: "append", 
                    maxWidth: 300, 
                    maxHeight: 150 
                });
            });
        }
    });
</script> 
```

但我在读取的行上遇到语法错误（dreamweaver）

> $("#embed").val().length > 0){

任何建议都会很棒...谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T02:47:13.793

您似乎没有 if 语句，请尝试：

```
$(document).ready(function() {
    $("#embed").blur(function () {
        if($("#embed").val().length > 0) {
            $("#fade").fadeIn(1000);
            olink = $("#embed").val(); 
            $("#oembed").oembed(olink, {
                embedMethod: "append", 
                maxWidth: 300, 
                maxHeight: 150 
            });
         }
    });
}); 
```

## 编辑

您可以像这样使您的代码更简洁：

```
$(document).ready(function() {
    $("#embed").blur(function() {
        var $this = $(this);
        var embed_val = $this.val();
        if(embed_val.length) {
            $("#fade").fadeIn(1000);
            $("#oembed").oembed(embed_val, {
                embedMethod: "append", 
                maxWidth: 300, 
                maxHeight: 150 
            });
         }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T02:49:44.087

```
<script type="text/javascript">
$(document).ready(function() {
  $("#embed").blur(function (){
    if ($("#embed").val().length > 0){
      $("#fade").fadeIn(1000);
      olink = $("#embed").val(); 
      $("#oembed").oembed(olink, {
        embedMethod: "append", 
        maxWidth: 300, 
        maxHeight: 150 
      });
    }
  });
});
</script> 
```

这应该够了吧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T03:09:07.913

这就是您的代码应该看起来的样子（当然，*在我看来*），格式正确：

```
$(document).ready(function() {
    var $embed = $("#embed"),
        $fade = $('#fade'),
        $oembed = $('#oembed'),
        oembed = {
            embedMethod: "append",
            maxWidth: 300,
            maxHeight: 150
        },
        olink;

    $embed.blur(function(){
        if ($embed.val().length){
            $fade.fadeIn(1000);

            olink = $embed.val(); 
            $oembed.oembed(olink, oembed);
        }
    });
}); 
```

除了混乱的混乱集群之外，您发布的代码有什么问题？你`if()`不在……那里。你漏掉`if(`了：

```
$(document).ready(function() {
    $("#embed").blur(function (){
        $("#embed").val().length > 0){ 
```

你能看见它吗？很难区分这三行。现在看看上面的代码，它...

1.  正确使用选择器缓存 ( `var $embed = $("#embed")`)。
2.  用于`var`声明所有变量，以 a 分隔，`,`因此它们都是本地的；还...
3.  制作`olink`一个适当的非全局范围的变量（嘿，由于闭包，它仍然有效，多么漂亮）。
4.  将对象（我从作为参数传递的`oembed`对象中创建）移动到适当的变量中，清理代码并缓存它。`{}`

我认为，如果您在格式化代码时小心并决定使用缓存和非全局变量等最佳实践，那么阅读和发现问题会更容易。这`if(`是最直接的问题，但整个代码都需要一些关注和一点爱心。

# mysql - 使用 mySQL 删除括号中的所有内容

> ID：10957963
> 
> 赞同：0
> 
> 时间：2012-06-09T02:44:47.367
> 
> 标签：mysql, sql

我有一个 mysql 表和字段中的一些元素，“标题”有“（一些文本）”。我想删除文本的括号部分。

所以

blah blah (blah) 会变成 blah blah

我将如何在 SQL 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T03:08:45.803

您可以在 MySQL 中使用替换功能

```
select replace(replace(title,'(', ''),')','') as  title
from table 
```

[http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_replace](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_replace)

# html - 这个 Twitter API 结果是如何自动变成 HTML 格式的？

> ID：10957964
> 
> 赞同：0
> 
> 时间：2012-06-09T02:45:04.170
> 
> 标签：html, xml, json, api, twitter

我知道[Twitter 是以 API 为中心的](http://engineering.twitter.com/2010/09/tech-behind-new-twittercom.html)，这意味着它与所有 Twitter 应用程序一样，通过 API 检索其数据。

当我访问[https://api.twitter.com/1/legal/tos.json](https://api.twitter.com/1/legal/tos.json)（或[.xml](https://api.twitter.com/1/legal/tos.xml)，如果您愿意）时，我会得到一个`JSON`似乎只包含纯文本且没有其他格式的格式化结果。话虽如此，如果我们假设[https://twitter.com/tos](https://twitter.com/tos)从同一个资源中检索它的数据，它是如何被格式化为**超链接**、**标题**等**的**？

我注意到有换行符`\n`将`JSON`响应分成多个部分。是否对这些数据进行了一些后处​​理，以用特定的 HTML 标记替换某些数量的换行符？

例如：

```
\n\n\n  =>  <h3>
\n\n    =>  <p>
Tip     =>  <p class="tip> 
```

但是，上述格式规则不会考虑散布在整个页面中的超链接。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T05:52:12.643

我的猜测是有一个格式为 HTML 的文本的主副本。格式化页面可以通过私有 API 或对公共 API 的不同请求访问文本的 HTML 版本。

另外，JSON 和 XML 版本由后端服务生成，该服务可以访问 HTML 格式的文本并将其转换为 JSON 或 XML 或 Twitter 想要的任何其他格式。

我认为 twitter 极不可能使用您链接到的文本的 JSON 或 XML 版本来构建他们的页面。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-09T03:24:59.623

你刚刚回答了你自己的问题。

他们使用预设格式 \n 和其他关键字（如tip）的想法。

```
\n\n for <p> 
\n\nTip for <p class="tip">
\n\nSecret would technically be for <p class="Secret">

\" for start of bold 
```

当他们从 API 检索数据时，他们将 \ns 替换为他们想要呈现的 html

# c# - 我想保存现有列表 到 C# 中的 XML 文件中

> ID：10957966
> 
> 赞同：2
> 
> 时间：2012-06-09T02:46:56.147
> 
> 标签：c#, xml, linq, xml-serialization

我有一个地方类定义如下：

```
 public class place
    {
            public string placeID { get; set; }
            public string placeCatID { get; set; }
            public string placeName { get; set; }
    } 
```

并将数据存储在列表调用 placelist 中

```
 List<place> placelist = new List<place>(); 
```

可以指导我如何将位置列表转换为字符串或将其导出并保存为 XML 文件格式，如下所示：

```
 <place>
            <pID>0001</pID>
            <pCatID>C1</pID>
            <pName>Location 1</pName>
    </place>
    <place>
            <pID>0002</pID>
            <pCatID>C1</pID>
            <pName>Location 2</pName>
    </place> 
```

使用的语言是 C#

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T02:54:00.153

您可以使用任何序列化为 XML 的序列化程序。我会建议 DataContractSerializer

来自 MSDN：

```
DataContractSerializer s = new DataContractSerializer(typeof(T));
    using (FileStream fs = File.Open("test" + typeof(T).Name + ".xml", FileMode.Create))
    {
        Console.WriteLine("Testing for type: {0}", typeof(T)); 
        s.WriteObject(fs, obj);
    } 
```

[http://msdn.microsoft.com/en-us/library/bb675198.aspx](http://msdn.microsoft.com/en-us/library/bb675198.aspx)

在您的情况下，将 T 替换为`List<T>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T02:58:14.423

简而言之，可以使用以下选项：

*   如何：使用 DataContractSerializer (C#) 进行序列化：[DataContractSerializer](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/how-to-serialize-using-datacontractserializer)
*   [LINQ to XML (C#)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/linq-to-xml)
*   您还可以从[XML 序列化示例中受益](https://msdn.microsoft.com/en-us/library/58a18dwa(v=vs.90).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T03:14:41.300

以下解决方案适用于`XmlSerializer`但您也可以使用`DataContractSerializer`。 `XmlSerializer`默认情况下序列化所有字段，`DataContractSerializer`您需要明确指定要序列化的内容。

添加序列化属性以具有自定义元素名称：

```
public class place
{
    [XmlElement("pID")]
    public string placeID { get; set; }
    [XmlElement("pCatID")]
    public string placeCatID { get; set; }
    [XmlElement("pName")]
    public string placeName { get; set; }
} 
```

序列化代码：

```
var ser = new XmlSerializer(typeof(List<place>));
TextWriter writer = new StreamWriter(@"C:\1.xml");
// o is List<place> here
ser.Serialize(writer, o); 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<ArrayOfPlace xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <place>
    <pID>1</pID>
    <pCatID>2</pCatID>
    <pName>3</pName>
  </place>
  <place>
    <pID>3</pID>
    <pCatID>4</pCatID>
    <pName>5</pName>
  </place>
</ArrayOfPlace> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-14T22:50:09.870

我刚刚写[了一篇关于将对象数据保存为 Binary、XML 或 Json 的博文](http://blog.danskingdom.com/saving-and-loading-a-c-objects-data-to-an-xml-json-or-binary-file/)。因为您希望类变量在 xml 文件中的名称与它们在代码中的名称不同，所以您需要使用 [XmlElement("NameToShowUpInXmlFileGoesHere")] 来装饰每个公共属性。

一旦你有了它，只需调用以下函数来保存对象实例并将其加载到文件中/从文件中加载。

注意：这需要将 System.Xml 程序集包含在您的项目中。

```
/// <summary>
/// Writes the given object instance to an XML file.
/// <para>Only Public properties and variables will be written to the file. These can be any type though, even other classes.</para>
/// <para>If there are public properties/variables that you do not want written to the file, decorate them with the [XmlIgnore] attribute.</para>
/// <para>Object type must have a parameterless constructor.</para>
/// </summary>
/// <typeparam name="T">The type of object being written to the file.</typeparam>
/// <param name="filePath">The file path to write the object instance to.</param>
/// <param name="objectToWrite">The object instance to write to the file.</param>
/// <param name="append">If false the file will be overwritten if it already exists. If true the contents will be appended to the file.</param>
public static void WriteToXmlFile<T>(string filePath, T objectToWrite, bool append = false) where T : new()
{
    TextWriter writer = null;
    try
    {
        var serializer = new XmlSerializer(typeof(T));
        writer = new StreamWriter(filePath, append);
        serializer.Serialize(writer, objectToWrite);
    }
    finally
    {
        if (writer != null)
            writer.Close();
    }
}

/// <summary>
/// Reads an object instance from an XML file.
/// <para>Object type must have a parameterless constructor.</para>
/// </summary>
/// <typeparam name="T">The type of object to read from the file.</typeparam>
/// <param name="filePath">The file path to read the object instance from.</param>
/// <returns>Returns a new instance of the object read from the XML file.</returns>
public static T ReadFromXmlFile<T>(string filePath) where T : new()
{
    TextReader reader = null;
    try
    {
        var serializer = new XmlSerializer(typeof(T));
        reader = new StreamReader(filePath);
        return (T)serializer.Deserialize(reader);
    }
    finally
    {
        if (reader != null)
            reader.Close();
    }
} 
```

## 例子

```
public class place
{
    [XmlElement("pID")]
    public string placeID { get; set; }
    [XmlElement("pCatID")]
    public string placeCatID { get; set; }
    [XmlElement("pName")]
    public string placeName { get; set; }
}

// To write the placeList variable contents to XML.
WriteToXmlFile<List<place>>("C:\places.txt", placeList);

// To read the xml file contents back into a variable.
List<place> placeList= ReadFromXmlFile<List<place>>("C:\places.txt"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T02:51:48.070

您可以编写自己的`ToXml()`方法或使用`DataContractSerializer`.

# c# - 每当我按 F5 时，如何让 Visual Studio 构建项目？

> ID：10957969
> 
> 赞同：0
> 
> 时间：2012-06-09T02:47:14.400
> 
> 标签：c#, visual-studio-2010, debugging, settings

在全新安装 Visual Studio 2010 时，我加载了我的配色方案，但现在每当我按 F5 时，我的更改都不可见。

如果项目发生更改，我怎样才能使它始终构建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T02:55:16.220

确保您的工具 -> 选项 -> 项目和解决方案 -> 构建和运行设置为在构建之前保存所有更改。

![在此处输入图像描述](../Images/d99a415ca583556f7f4990c7e5bebf32.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T02:55:10.840

您加载了更多选项，而不仅仅是配色方案......按照您想要的方式更改“运行前构建”选项。

# android - 使用 ormlite 创建时间戳列

> ID：10957983
> 
> 赞同：3
> 
> 时间：2012-06-09T02:50:38.057
> 
> 标签：android, mysql, ormlite

我有一个这样的专栏：

```
@DatabaseField(dataType = DataType.TIME_STAMP)
Timestamp time; 
```

当我创建 DAO 时，我得到了这个异常：

```
java.lang.IllegalArgumentException: Field class class java.sql.Timestamp for
    field FieldType:name=time,class=Vote is not valid for data persister
    com.j256.ormlite.field.types.TimeStampType@334ecfe8 
```

有一天，我尝试了不同的方法，但都没有奏效。请注意，我已将我的 ormlite jar 更新到 4.41。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T04:49:12.253

[ORMLite](http://ormlite.com/) 4.41 版中添加了对`java.sql.Timestamp`和`java.sql.Date`字段的支持，但它们有一个相关的错误。这些已在 4.42 版中修复。

同时，我认为您可以通过删除说明符来修复它`dataType`。我认为它应该能够自动检测类型。问题是当您指定数据类型时。

```
// no dataType specified
@DatabaseField
Timestamp time; 
```

# php - 使用 php 的 xpath 和 xquery

> ID：10957990
> 
> 赞同：1
> 
> 时间：2012-06-09T02:51:52.260
> 
> 标签：php, xpath

我有以下格式的 xml 文件。

```
<pages>
  <contents>
    <menu><![CDATA[menu1]]></menu>
    <texts><![CDATA[content1]]></texts>
  </contents>

  <contents>
    <menu><![CDATA[menu2]]></menu>
    <texts><![CDATA[content2]]></texts>
  </contents>

  <contents>
    <menu><![CDATA[menu3]]></menu>
    <texts><![CDATA[content3]]></texts>
  </contents>
</pages> 
```

在这里，我想传递一个带有菜单节点值的参数，例如传递了 menu1，我想获取文本节点，即 content1 左右。

我怎么能用 php/xquery 做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T14:30:45.347

**使用这样的东西**（我不知道 PHP）：

```
/pages/content[menu = $foo]/texts/text() 
```

**或者**

```
string(/pages/content[menu = $foo]/texts) 
```

其中变量是需要其“文本”`$foo`的元素的字符串值。`menu`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T03:09:43.167

查看[http://php.net/manual/en/simplexmlelement.xpath.php](http://php.net/manual/en/simplexmlelement.xpath.php)

```
/pages/contents/menu[text()='<![CDATA[$foo]]>'] 
```

# iphone - 带有 Mac 的 Iphone 生产者消费者本地网络

> ID：10957992
> 
> 赞同：0
> 
> 时间：2012-06-09T02:51:59.597
> 
> 标签：iphone, networking, local

我正在寻找一种从 iPhone 连接到 Mac 的方法，以便像生产者-消费者一样写入/读取文件并同步该文件。

我的想法是在 Mac 中创建一个文件，并在 iPhone 上读写，可能是一个 iPhone 应用程序要编写，另一个要读取。

在此先感谢，如果有人有更好的主意...请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T02:55:00.013

我说最理想的方法是通过 Bonjour 协议。

这是一篇关于这个主题的精彩文章， http: [//mobileorchard.com/tutorial-networking-and-bonjour-on-iphone/](http://mobileorchard.com/tutorial-networking-and-bonjour-on-iphone/)

# python - 减少文本文件大小的编程技术

> ID：10957993
> 
> 赞同：2
> 
> 时间：2012-06-09T02:52:59.147
> 
> 标签：python, optimization, file-io

我正在将多维数组数据写入文本文件。我这样做是明智的。文件的大小不断增长。我应该遵循哪些技术来获得尽可能小的输出文件大小？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T03:08:20.177

如果你的数组有很多零，你可以使用稀疏矩阵表示：而不是将整个矩阵写入文件，只写入非零元素（当然，你需要一个一个地写入每个元素及其索引）。假设你想写这个矩阵：

```
0 0 0 2
1 0 0 0
0 0 0 0
0 0 3 0
0 0 0 0 
```

您可以将其写入文件：

```
0 3 2
1 0 1
3 2 3 
```

在每一行中，第一个数字是行，第二个是列，第三个是存储的值。

如果将文件写为文本，可以切换为二进制格式：写文本时，每个数字使用一个字节；在二进制中，每个数字使用固定数量的字节，并且不必表示空格和换行符：

`100 200 300`如果使用文本格式，将数字写入文件需要 11 个字节。但是，如果您写入三个 16 位整数，它们可能会使用 6 个字节来写入。在 Python 中，使用 "wb" 和 "rb" 模式打开二进制文件，然后将它们写入字节：

```
f = open('file', 'wb')
f.write('%c' % 123)
f.close() 
```

或者——更有效地，

```
import array
f = open('file', 'wb')
data = array.array('B')
data.append(1)
data.append(2)
data.append(3)
data.tofile(f)
f.close() 
```

否则，您可能应该尝试使用标准技术压缩数据结构。既然您用 标记了您的问题`python`，您可能会对这些[用于数据压缩的 Python 库感兴趣](http://docs.python.org/library/archiving.html)

还有一个很好[的数据压缩介绍](http://www.cs.cmu.edu/~guyb/realworld/compression.pdf)，在理论上有点沉重，以防你想了解更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T03:10:27.510

因为数据比较稀疏，可以使用[SciPyPackages / Sparse](http://docs.scipy.org/doc/scipy/reference/sparse.html)关于 I/O 可以看[这个](http://www.scipy.org/SciPyPackages/Sparse#head-c3d2c28b185d1ddb210a2da2e484be7480ba5800)

稀疏矩阵只是具有大量零值的矩阵。

所以，如果你想自己写代码。保存时`sparse matrix`，只需要输出非零元素的位置和元素值即可。例如：

`sparse matrix`：_

```
1 0 0 1
0 0 0 0
0 0 5 0
0 0 0 10 
```

需要保存到文件的数据是：

```
0 0 1
0 3 1
2 2 5
3 3 10 
```

当`sparse matrix`种植者时，这种方法可以减少数据保存到`file`.

而何时使用`data file`，您只需`original matrix`要从数据中恢复。

祝你好运

# google-maps - 地图：在矩形内是 lat/lgn

> ID：10957994
> 
> 赞同：1
> 
> 时间：2012-06-09T02:53:19.420
> 
> 标签：google-maps, google-maps-api-3

假设由西南纬度/lgn (a,b) 和东北纬度/lng (c,d) 坐标定义的矩形：

```
 c,d
|-----------|
|           |
|           |
|           |
|-----------|
a,b 
```

如何确定另一对坐标 x,y 是否在该矩形内？这个对吗：

```
a < x < c AND b < y < d  <-- if true, it means x,y are in the rectangle??? 
```

我正在使用 Google Maps API 并从中获取这些 lat/lng 值。我只需要知道 x,y 是否确实在矩形内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T02:57:28.610

是的。对此进行编码的一种方法是

```
if (x < a) return false;
if (x > c) return false;
if (y < b) return false;
if (y > d) return false;
return true; 
```

请注意，如果一个点也正好在边界上，我的方式认为它在矩形“中”。你可能会也可能不会认为这是真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T03:02:33.153

`LatLngBounds`首先从西南和东北坐标创建一个，然后调用`contains`LatLng中传递的方法进行检查。

[https://developers.google.com/maps/documentation/javascript/reference#LatLngBounds](https://developers.google.com/maps/documentation/javascript/reference#LatLngBounds)