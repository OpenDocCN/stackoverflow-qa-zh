# StackOverflow 问答 12184000-12184999

# python - 在 Python 中，如何自然地对字母数字字符串列表进行排序，以使字母字符排在数字字符之前？

> ID：12184015
> 
> 赞同：1
> 
> 时间：2012-08-29T18:11:27.343
> 
> 标签：python, sorting

这是我最近遇到的一个有趣的小挑战。我将在下面提供我的答案，但我很想知道是否有更优雅或更有效的解决方案。

向我提出的要求的描述：

1.  字符串是字母数字的（参见下面的测试数据集）
2.  字符串应该自然排序（参见[这个问题](https://stackoverflow.com/q/4836710/1093087)的解释）
3.  字母字符应排在数字字符之前（即 'abc' 在 '100' 之前）
4.  alpha 字符的大写实例应排在小写实例之前（即'ABc'、'Abc'、'abc'）

这是一个测试数据集：

```
test_cases = [
    # (unsorted list, sorted list)
    (list('bca'), ['a', 'b', 'c']),
    (list('CbA'), ['A', 'b', 'C']),
    (list('r0B9a'), ['a', 'B', 'r', '0', '9']),
    (['a2', '1a', '10a', 'a1', 'a100'], ['a1', 'a2', 'a100', '1a', '10a']),
    (['GAM', 'alp2', 'ALP11', '1', 'alp100', 'alp10', '100', 'alp1', '2'],
        ['alp1', 'alp2', 'alp10', 'ALP11', 'alp100', 'GAM', '1', '2', '100']),
    (list('ra0b9A'), ['A', 'a', 'b', 'r', '0', '9']),
    (['Abc', 'abc', 'ABc'], ['ABc', 'Abc', 'abc']),
] 
```

* * *

**奖励测试用例**

这受到[Janne Karila 在](https://stackoverflow.com/questions/12184015/in-python-how-can-i-naturally-sort-a-list-of-alphanumeric-strings-such-that-alp#comment16314634_12184015)下面的评论的启发，即所选答案当前失败（但在我的情况下并不是一个实际问题）：

```
(['0A', '00a', 'a', 'A', 'A0', '00A', '0', 'a0', '00', '0a'],
        ['A', 'a', 'A0', 'a0', '0', '00', '0A', '00A', '0a', '00a']) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T19:33:00.977

```
re_natural = re.compile('[0-9]+|[^0-9]+')

def natural_key(s):
    return [(1, int(c)) if c.isdigit() else (0, c.lower()) for c in re_natural.findall(s)] + [s]

for case in test_cases:
    print case[1]
    print sorted(case[0], key=natural_key)

['a', 'b', 'c']
['a', 'b', 'c']
['A', 'b', 'C']
['A', 'b', 'C']
['a', 'B', 'r', '0', '9']
['a', 'B', 'r', '0', '9']
['a1', 'a2', 'a100', '1a', '10a']
['a1', 'a2', 'a100', '1a', '10a']
['alp1', 'alp2', 'alp10', 'ALP11', 'alp100', 'GAM', '1', '2', '100']
['alp1', 'alp2', 'alp10', 'ALP11', 'alp100', 'GAM', '1', '2', '100']
['A', 'a', 'b', 'r', '0', '9']
['A', 'a', 'b', 'r', '0', '9']
['ABc', 'Abc', 'abc']
['ABc', 'Abc', 'abc'] 
```

**编辑：**我决定重新审视这个问题，看看是否可以处理奖金案。它需要在密钥的决胜局部分更加复杂。为了匹配所需的结果，必须先考虑键的字母部分，然后再考虑数字部分。我还在键的自然部分和决胜局之间添加了一个标记，以便短键总是在长键之前出现。

```
def natural_key2(s):
    parts = re_natural.findall(s)
    natural = [(1, int(c)) if c.isdigit() else (0, c.lower()) for c in parts]
    ties_alpha = [c for c in parts if not c.isdigit()]
    ties_numeric = [c for c in parts if c.isdigit()]
    return natural + [(-1,)] + ties_alpha + ties_numeric 
```

这会为上面的测试用例生成相同的结果，以及额外用例的所需输出：

```
['A', 'a', 'A0', 'a0', '0', '00', '0A', '00A', '0a', '00a'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T16:11:12.603

这也适用于奖金测试：

```
def mykey(s):
    lst = re.findall(r'(\d+)|(\D+)', s)
    return [(0,a.lower()) if a else (1,int(n)) for n, a in lst]\
        + [a for n, a in lst if a]\
        + [len(n) for n, a in lst if n]

def mysort(lst):
    return sorted(lst, key=mykey) 
```

使用这种类型的模式，re.findall 将字符串分解为一个元组列表，例如

```
>>> re.findall(r'(\d+)|(\D+)', 'ab12cd')
[('', 'ab'), ('12', ''), ('', 'cd')] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:11:27.343

此函数目前不声明性能：

```
def alpha_before_numeric_natural_sensitive(unsorted_list):
    """presorting the list should work because python stable sorts; see:
    http://wiki.python.org/moin/HowTo/Sorting/#Sort_Stability_and_Complex_Sorts"""
    presorted_list = sorted(unsorted_list)
    return alpha_before_numeric_natural(presorted_list)

def alpha_before_numeric_natural(unsorted_list):
    """splice each string into tuple like so:
    'abc100def' -> ('a', 'b', 'c', 100, 'd', 'e', 'f') ->
    (ord('a'), ord('b'), ord('c'), ord('z') + 1 + 100, ...) then compare
    each tuple"""
    re_p = "([0-9]+|[A-za-z])"
    ordify = lambda s: ord('z') + 1 + int(s) if s.isdigit() else ord(s.lower())
    str_to_ord_tuple = lambda key: [ordify(c) for c in re.split(re_p, key) if c]
    return sorted(unsorted_list, key=str_to_ord_tuple) 
```

它基于[这个自然排序解决方案](https://stackoverflow.com/a/4836734/1093087)和我写的这个函数提供的洞察力：

```
def alpha_before_numeric(unsorted_list):
    ord_shift = lambda c: c.isdigit() and chr(ord('z') + int(c.lower()) + 1) or c.lower()
    adjust_word = lambda word: "".join([ord_shift(c) for c in list(word)])

    def cmp_(a, b):
        return cmp(adjust_word(a), adjust_word(b))

    return sorted(unsorted_list, cmp_) 
```

有关比较不同功能的完整测试脚本，请参阅[http://klenwell.com/is/Pastebin20120829](http://klenwell.com/is/Pastebin20120829)

# html - 无需内联的 SVG 样式的最佳方式

> ID：12184018
> 
> 赞同：2
> 
> 时间：2012-08-29T18:11:54.650
> 
> 标签：html, css, svg, css-selectors

我有一个大约 10 个项目的菜单。每个项目都有自己的图标。这个图标是一个 SVG 文件。

例如：

```
<li class="active">
    <a href="/home">
        <svg version="1.1" id="svg-menu-home"
             xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
             x="0px" y="0px" width="31px" height="31px" viewBox="-8 -8 31 31"
             overflow="visible" enable-background="new -8 -8 31 31" xml:space="preserve">
            <mask maskUnits="userSpaceOnUse" x="0" y="0" width="15" height="15" id="maskTop">
                <polygon fill="#FFFFFF" points="12,6.036 2,6.036 2,14.036 6,14.036 6,9.036 8,9.036 8,14.036 12,14.036"/>
                <polygon fill="#FFFFFF" points="7,0.036 0,7.036 14,7.036"/>
            </mask>
            <rect mask="url(#maskTop)" fill="#939598" width="15" height="15"/>
        </svg>
        <span>Home</span>
    </a>
</li> 
```

当用户与菜单项交互时，我可以为其分配一个类等（悬停、选择、活动）。

将整个源代码内联似乎是我可以使用 CSS 更改 SVG 的唯一方法，例如：

```
<style>
    li.active svg polygon {
       fill: red;
    }
</style> 
```

问题是：

1.  内联大量 SVG 文件会使代码不可读，并且
2.  如果您在其他地方引用 SVG，维护它并不容易。

我更愿意像使用 IMG ( ) 那样引用文件*src*`<img src="x.jpg"/>`并避免依赖于 Javascript 的解决方案。

然而，我所看到的所有方式都不允许 SVG 元素的 CSS 样式（或需要 JS）。

有什么想法/解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:25:46.617

可能不是最优雅的解决方案，但您可以将它们组织成 php 包括：

```
<?php include 'inc/svg-menu-home.svg.php'; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:38:14.523

我认为查看[http://raphaeljs.com/](http://raphaeljs.com/)并不是一个坏方法。它帮助我创建了这个[http://screencast.com/t/rNr0Cbqkb](http://screencast.com/t/rNr0Cbqkb)（每个区域都是 svg）

# sql - DB2 上数据库模式的虚拟实例

> ID：12184019
> 
> 赞同：1
> 
> 时间：2012-08-29T18:11:55.333
> 
> 标签：sql, database, db2, multi-tenant

我的问题很简单：

我正在开发一个系统，它将安装在几家公司中。我不想在每个表中使用一个字段来将一家公司的数据与另一家公司分开，我想使用更具可扩展性的解决方案。

我的想法是为单个数据库模式建模，并为我在系统中实例化的每个公司创建一个“实例”，从而备份单个数据库或基本模式，并通过修改我的基本模式来传播每个模式的更改。简而言之，将只有一个基本或物理模式和它的许多数据实例，由唯一的模式名称引用。

这可能吗？这种技术叫什么？（我将第一次使用这个概念）如何在 IBM DB2 上实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:20:20.960

如果我理解正确，我认为这是不可能的。我很确定这不实用。

想象一下将一列和该列上的索引添加到您的基本架构中。在一家没有大量数据的公司中，这种变化是相当微不足道的。但是拥有数百万行的公司可能会突然发现自己的磁盘空间不足。

DBA*可以*通过将索引或表移动到不同的磁盘或不同的文件系统来解决该问题，但如果数据库是从您的基本模式“实例化”的，这可能是不可能的。（取决于您所说的*instanced*的含义，它具有特定于 DB2 的含义以及更一般的 OOP 含义。）

*我认为*您正在寻找的术语是“多租户”。（*租户*和*客户*在这里的意思几乎相同。） SO 有一个“多租户”标签；我给你加，不合适的可以删。IBM 的 developerWorks 库有[一篇关于各种多租户架构的介绍性文章](http://www.ibm.com/developerworks/data/library/techarticle/dm-1201dbdesigncloud/)。

多租户架构的范围从“不共享”（每个租户都有自己的数据库）到“共享所有内容”（所有租户共享单个数据库中的表，每一行都有一个列来标识“拥有”该行的租户） .

在“不共享任何东西”和“共享一切”之间是“共享模式”（租户共享一个数据库；每个租户都有一个私有模式）。

最明显的区别在于定制、灾难恢复和数据隔离。这些差异也推动了架构的选择。

“无共享”使定制变得容易；更改数据库不会影响任何其他租户。灾难恢复也很简单；您只需从备份中恢复整个数据库。可以在数据库级别应用权限以实现近乎完美的隔离。

“共享一切”使定制变得困难；每一个变化都会在一定程度上影响到每个租户。容灾也难；对于单个公司的灾难，您必须将*一些*行（仅是单个公司“拥有”的行）恢复到每个表。数据隔离也更难，因为您部署的每个视图和查询都必须正确考虑租户标识符。忘记一次，你*可能*会倒闭。

# python - 使用 django 表单提交传递变量

> ID：12184022
> 
> 赞同：0
> 
> 时间：2012-08-29T18:12:08.677
> 
> 标签：python, django, forms, django-templates

我的侧边菜单顶部有一个搜索框。此搜索栏搜索所有视图（任务、列表和信息）。结果显示在这三个类别中，但默认情况下会折叠列表和信息以使视图更易于阅读。

相反，我想确定用户用于搜索的侧边菜单，并在返回结果时折叠其他两个类别。

因此，如果用户正在查看任务，搜索结果会列出任务，但返回列表和信息结果会折叠。如果用户在列表中使用搜索框，结果将列出列表项，但会折叠任务和信息。

相同的函数用于处理所有搜索结果：

```
def search(request):

    query_string = ''
    search_results = SortedDict([])

    if ('q' in request.GET) and request.GET['q'].strip():
        query_string = request.GET['q']

        entry_query = get_query(query_string, ['name', 'notes',]) 
```

getquery() 在数据库中搜索 query_string

从模板调用此函数：

```
<form method="get" action="{% url search %}" style="display:inline;" >
    <input name="q" class="span9" value="{{ request.GET.q }}" id="appendedInputButton" size="16" type="text">
    <button class="btn" type="submit">
        <i class="icon-search" title="Search"></i>
    </button>
</form> 
```

**我如何将当前 url 或其他模板变量与此表单提交一起传递，以便在搜索功能中获得一些可用的模板信息？** 然后，这将允许我将信息传递给搜索结果，告诉模板要折叠哪些类别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:22:16.017

最简单和最简单的方法是使用单独的按钮。如果您为每个视图命名，并且在特定视图处于活动状态时仅显示适当的视图，则您可以根据 POST 中按钮名称的存在来判断哪个视图处于活动状态。

唯一的其他途径是创建一个隐藏字段，并在视图更改时使用 JavaScript 适当地设置该字段的值。

# c++ - 未解析的外部符号“公共：__thiscall

> ID：12184027
> 
> 赞同：9
> 
> 时间：2012-08-29T18:12:33.633
> 
> 标签：c++

我看过了，我知道还有其他答案，但似乎没有一个能给我我正在寻找的东西，所以请不要将其报告为“转发”

我的 C++ 代码中出现未解决的外部符号“public: __thiscall”错误，我将把它踢出窗外，只是让我的 C++ 课程失败。请帮我！！！！

我的支票账户头文件

```
#include "BankAccount.h"
class CheckingAccount
{
private:
int numOfWithdrawls;
double serviceFee;
int AccountBal;

public:
bool withdraw (double wAmmt);
BankAccount CA;
CheckingAccount();
CheckingAccount(int accountNum);
}; 
```

及其CPP文件

```
#include <iostream>
using namespace std;
#include "CheckingAccount.h"

CheckingAccount::CheckingAccount()
{
CA;
numOfWithdrawls = 0;
serviceFee = .50;
}
CheckingAccount::CheckingAccount(int accountNum)
{
CA.setAcctNum (accountNum);
numOfWithdrawls = 0;
serviceFee = .50;
}
bool CheckingAccount::withdraw (double wAmmt)
{
numOfWithdrawls++;
if (numOfWithdrawls < 3)
{
    CA.withdraw(wAmmt);
}
else
{
    if (CA.getAcctBal() + .50 <=0)
    {
        return 0;
    }
    else
    {
        CA.withdraw(wAmmt + .50);
        return 1;
    }
}
} 
```

我的 BankAccount 头文件

```
#ifndef BankAccount_h
#define BankAccount_h
class BankAccount
{
private:
int acctNum;
double acctBal;

public:
BankAccount();
BankAccount(int AccountNumber);
bool setAcctNum(int aNum);
int getAcctNum();
double getAcctBal();
bool deposit(double dAmmt);
bool withdraw(double wAmmt);
};
#endif 
```

我的银行账户 CPP 文件

```
#include <iostream>
using namespace std;
#include "BankAccount.h"

BankAccount::BankAccount(int AccoutNumber)
{
acctNum = 00000;
acctBal = 100.00;
}
bool BankAccount::setAcctNum(int aNum)
{
acctNum = aNum;
return true;
}

int BankAccount::getAcctNum()
{
return acctNum;
}

double BankAccount::getAcctBal()
{
return acctBal;
}

bool BankAccount::deposit(double dAmmt)
{
acctBal += dAmmt;
return true;
}

bool BankAccount::withdraw(double wAmmt)
{
if (acctBal - wAmmt <0)
{
    return 0;
}
else
{
    acctBal -= wAmmt;
    return 1;
}
} 
```

我的错误：

```
1>BankAccountMain.obj : error LNK2019: unresolved external symbol "public: __thiscall BankAccount::BankAccount(void)" (??0BankAccount@@QAE@XZ) referenced in function "public: __thiscall SavingsAccount::SavingsAccount(void)" (??0SavingsAccount@@QAE@XZ)

1>CheckingAccount.obj : error LNK2001: unresolved external symbol "public: __thiscall BankAccount::BankAccount(void)" (??0BankAccount@@QAE@XZ) 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-29T18:15:26.350

“__thiscall”是噪音。继续阅读。错误消息正在抱怨`BankAccount::BankAccount(void)`。头文件说它`BankAccount`有一个默认构造函数，但没有定义它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-29T18:14:55.490

在您的 BankAccount 类中，您声明了一个不带参数的构造函数

```
 BankAccount(); 
```

但你没有实现它。这就是链接器找不到它的原因。在您的 .cpp 文件中提供此构造函数的实现，链接步骤应该可以工作。

# facebook - 打开带有复杂 url 的 Graph 图像错误

> ID：12184028
> 
> 赞同：2
> 
> 时间：2012-08-29T18:12:33.980
> 
> 标签：facebook, adobe, facebook-opengraph, scene7

我试图通过允许人们分享带有产品图像的产品来在我的页面上进行一些病毒式营销。这是一个正常的用例（甚至是陈词滥调），但图像源是 Adob​​e 的 Scene7。我使用了 facebook 提供的调试器工具，但他们能告诉我的最好的结果是“无法下载 og:image 标签的 url 引用的图像”。我知道 Scene7 url 非常复杂，并且有合理的机会这是 facebook 正在窒息的东西，但无论如何有这个限制吗？

我无法提供实际的 url（商业机密、保密协议等），但我们处理的 url 类似于`http://s7d4.scene7.com/ir/render/company/product?fmt=png&resmode=sharp2&wid=350&obj=scr&show&obj=cc&decal&src=is{company/style?$text1=H&$name1=namelong&$color1=Blue}&res=150&show`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:19:46.103

如果 URL 不公开（即：我打开新安装的浏览器并能够看到您的链接） - 我们的抓取工具也将无法看到该图像。鉴于您共享的详细信息，我认为没有任何解决方法，但如果从法律角度来看缩略图是可以的（缩略图最终会出现在 Facebook 上），您可以使用公共 URL 作为图像的缩略图您的产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:28:55.280

事实证明，问题在于 url 发生了一些自动编码，这在场景 7 中不起作用。

# python - python swig：ImportError错误的ELF类：ELFCLASS64

> ID：12184036
> 
> 赞同：-1
> 
> 时间：2012-08-29T18:12:51.940
> 
> 标签：python, swig, importerror

我正在尝试通过 swig 从 python 接口到 c++ 代码。我在尝试执行我的脚本时收到以下错误。

```
File "./driver.py", line 4, in <module>
  from fixMessageSim import *
File "/var/user/pradyotd/testframework/fixMessageSim.py", line 12, in <module>
  import MessageFactory
File "/var/user/pradyotd/testframework/MessageFactory.py", line 25, in <module>
  _MessageFactory = swig_import_helper()
File "/var/user/pradyotd/testframework/MessageFactory.py", line 21, in swig_import_helper
  _mod = imp.load_module('_MessageFactory', fp, pathname, description)
ImportError: /var/user/pradyotd/testframework/_MessageFactory.so: wrong ELF class: ELFCLASS64` 
```

当我在 .so 上运行文件时，我得到

```
_MessageFactory.so: ELF 64-bit LSB shared object, x86-64, version 1 (GNU/Linux), dynamically linked, not stripped 
```

同样对于python

```
/usr/bin/python: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, stripped 
```

所以我不清楚为什么 64 位 .so 会抱怨。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T18:24:48.533

看来，我认为我正在使用的解释器不是文件中的解释器。这似乎不是问题。

# windows - 任务列表显示所有窗口

> ID：12184041
> 
> 赞同：3
> 
> 时间：2012-08-29T18:13:07.107
> 
> 标签：windows, vbscript, cmd, tasklist

我正在运行以下批处理脚本：

```
@echo off
tasklist /nh /fi "Windowtitle eq Export to PDF - DOORS" | find /i "Export to PDF - DOORS" >nul && (
echo PDF is running
) || (
echo PDF is not running
) 
```

如果窗口当前处于活动状态，这只会回显“PDF 正在运行”。也许我使用了错误的命令（任务列表）。有没有办法在打开的窗口的完整列表中找到？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T17:57:09.033

我能够通过 VB 脚本获得所需的东西（感谢@JoshGuzman 的想法）：

```
Set Word = CreateObject("Word.Application")
Set Tasks = Word.Tasks

For Each Task in Tasks
  If Task.Visible Then
    If Task.name = "Export to PDF - DOORS" Then
      Wscript.Echo "PDF is Running"
    Else 
      Wscript.Echo "PDF is not Running"
    End If
  End If
Next

Word.Quit 
```

`wscript myScript.vbs`然后从命令提示符或批处理文件中调用 VB 脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T09:32:48.567

如果您愿意使用 Microsoft 的 PowerShell 而不是 cmd.exe（它也可以在我的旧 Windows XP 上运行，我只需要手动安装它；在较新的 Windows 版本上它是预安装的），您可以将[WASP](http://wasp.codeplex.com/)作为管理单元安装，然后然后这样做：

```
Select-Window | Format-Table processid,processname,title -AutoSize

AUSFÜHRLICH: Enumerating all windows

ProcessId ProcessName  Title
--------- -----------  -----
     7452 powershell   Windows PowerShell V2 (CTP3)
     2688 chrome       cmd - tasklist show all windows - Stack Overflow - Google Chrome
     2688 chrome       List all open window titles - PowerShellCommunity.org - Windows PowerShell Discussion Forums ...
     3572 TOTALCMD     Total Commander 8.0 - Scrum-Master.de  Inh. Alexander Kriegisch
     4152 eclipse      Java - dummy2/src/de/scrum_master/aop/log4j/Log4jAspect.aj - Eclipse Platform - Java, Scala, ...
     5608 Foxit Reader quick5A4.pdf - Foxit Reader
     2812 TextPad      TextPad - [C:\Dokumente und Einstellungen\Robin\Eigene Dateien\java-src\dummy2\bin\log4j.prop... 
```

如您所见，两个 chrome 窗口都被列出，而板载命令`Get-Process`只列出每个进程一个窗口，就像`tasklist`在`cmd.exe`：

```
Get-Process | Where {$_.mainwindowtitle} | Format-Table id,name,mainwindowtitle -AutoSize

  Id Name         MainWindowTitle
  -- ----         ---------------
2688 chrome       cmd - tasklist show all windows - Stack Overflow - Google Chrome
4152 eclipse      Java - dummy2/src/de/scrum_master/aop/log4j/Log4jAspect.aj - Eclipse Platform - Java, Scala, Aspec...
5608 Foxit Reader quick5A4.pdf - Foxit Reader
7452 powershell   Windows PowerShell V2 (CTP3)
2812 TextPad      TextPad - [C:\Dokumente und Einstellungen\Robin\Eigene Dateien\java-src\dummy2\bin\log4j.properties]
3572 TOTALCMD     Total Commander 8.0 - Scrum-Master.de  Inh. Alexander Kriegisch 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T02:09:16.953

这是解决方案...

```
@echo off
tasklist /FI "WINDOWTITLE eq Export to PDF - DOORS" | find /i "Image Name" >nul && (
echo PDF is running
) || (
echo PDF is not running
) 
```

这就是发生的事情

```
tasklist /FI "WINDOWTITLE eq myscript.bat - Notepad" 
```

如果**tasklist**找到任何匹配项，则将输出：

```
Image Name                     PID Session Name        Session#    Mem Usage
========================= ======== ================ =========== ============
notepad.exe                   3212 Console                    1     22,704 K 
```

所以你必须使用**find /i "Image Name"**因为如果**myscript.bat - Notepad** Windows Title 存在， **Image Name**就会出现。

 **哦，我差点忘了如果找不到匹配项，那么输出会：

**信息：没有任务正在运行与指定的条件匹配。**

请注意，“**图像名称**”一词不在此输出中。

希望这对您有所帮助。**

# c# - 如何在报表查看器中直接导出到 Word 文档

> ID：12184042
> 
> 赞同：5
> 
> 时间：2012-08-29T18:13:08.347
> 
> 标签：c#, reportviewer

我创建了一个包含一些数据的报告。我不希望用户必须单击表单导出按钮并将数据导出到 Word 文档。该文件保存得很好，问题是当我用word打开文档时，它只是一堆垃圾，而不是应该保存的报告。

我的保存按钮如下所示：

```
SaveFileDialog saveFileDialog = new SaveFileDialog();
saveFileDialog.InitialDirectory = @“C:\”;
saveFileDialog.RestoreDirectory = true;
savefileDialog.Title = “Browse Text Files”;
saveFileDialog.DefaultExt = “docx”;

saveFileDialog.Filter = “Word Doc (*.docx)|*.docx|PDF (*.pdf)| *.pdf”;
saveFileDialog.checkFileExists = false;
saveFileDialog.CheckPathExists = true;

Warning[] warnings;
string[] streams;
string mimeType;
string encoding;
string extension;

byte[] bytes = reportViewer1.LocalReport.Render(“Word”, null, out mimeType, out encoding, out extension, out streams, out warnings);

if (saveFileDialog.ShowDialog() == DialogResult.OK)
{
var filename = saveFileDialog.FileName;
System.IO.FileStream file = new FileStream(filename, FileMode.Create);
file.Write(bytes, 0, bytes.length);
file.close();
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-10-08T13:27:08.557

我知道这是旧的并且已经回答（有点），但我偶然发现了这个问题，你需要在渲染调用中使用“WORDOPENXML”而不是“Word”。这样它将导出到 docx。

使用 ListRenderingExtensions 查看可用的扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T01:00:47.237

LocalReport.Render for Word 仅导出为较旧的 Word 格式（我相信是版本 6）。不支持基于 XML（docx 扩展）的较新的开放格式。因此，通过使用 docx 扩展名，Word 期待更新的格式，而不是旧格式，因此它将所有内容都解释为垃圾。顺便说一句，将 Word 文档上的 docx 扩展名更改为 .zip，提取内容并在生成的文件夹周围戳一下。现在可见的东西非常有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T21:00:45.790

因此，在对这件事进行了大量工作之后，我发现改变了这一行：

```
saveFileDialog.Filter = “Word Doc (*.docx)|*.docx|PDF (*.pdf)| *.pdf”; 
```

到

```
saveFileDialog.Filter = “Word Doc (*.doc)|*.doc|PDF (*.pdf)| *.pdf”; 
```

解决了我的问题。无论出于何种原因，保存到 .docx 文件都会损坏数据。

# android - AsyncTask 已经开始 onCreate

> ID：12184049
> 
> 赞同：0
> 
> 时间：2012-08-29T18:13:51.873
> 
> 标签：android, multithreading, background, android-asynctask

当我尝试通过单击按钮执行 AsyncTask 时，我的应用程序说该任务已经启动。我不会在 onCreate 或 onResume 或类似的任何地方执行任务。可以在创建活动时启动任务而无需我以编程方式执行它吗？

```
 // Login button
    Button loginButton = (Button) findViewById(R.id.loginBtn);
    loginButton.setOnClickListener(new Button.OnClickListener() 
    {
        public void onClick(View v) 
        {                
            loginTask.execute("");
        }
    });

// Background login thread
private AsyncTask<Object, String, String> loginTask = new AsyncTask<Object, String, String>(){

    @Override
    protected String doInBackground(Object... arg0) 
    {
        Log.v(TAG, "Login task started");
        LoginManager lm = new LoginManager();
        String username = emailText.getText().toString();
        String password = passwordText.getText().toString();
        loginBundle = new Bundle();
        loginBundle.putString(Constants.LOGIN_HANDLER_ID, lm.login(username, password));
        loginMessage = Message.obtain(null, 0);
        loginMessage.setData(loginBundle);
        loginHandler.sendMessage(loginMessage);
        return "";
    }

}; 
```

这是我调用执行的唯一地方，它是我在 onCreate() 方法中创建的按钮。执行任务时，我收到任务已启动错误。

我想也许我没有正确取消线程，所以我重新启动了我的 Motrola Xoom。Xoom 启动后，我运行了该应用程序，但仍然出现此错误。我能做些什么？该应用程序使用的是 Android SDK 8 ......我在摩托罗拉 Xoom 上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:21:54.850

像这样调用你的 AsyncTask

```
new LoginTask().execute(""); 
```

在哪里

```
private class LoginTask extends
    AsyncTask<Object,String, String> {
.....

} 
```

# wpf - 在 bing 地图视图更改时查找目标边界矩形

> ID：12184050
> 
> 赞同：0
> 
> 时间：2012-08-29T18:13:54.837
> 
> 标签：wpf, bing-maps, bounding-box

我们正在使用 WPF Bing Maps 来可视化集群数据。我们正在尝试更新每个 OnViewChangeOnFrame 事件的数据（因为 OnViewChangeEnd 存在明显延迟）。然而，对每一帧进行缩放和更新会导致“抽搐”效果。这个想法是找出目标边界矩形 OnViewChangeStart 并在目标设置的缩放或平移开始时仅更新一次数据。

但是 Bing 地图存在一个问题 - 地图类不支持 TargetBoundingRectangle 属性。是否有一种算法知道视口大小、目标缩放级别和目标中心来计算 TargetBoundingRectangle 或者可能是另一个具有它的 Map 属性？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T17:04:01.603

从 MSDN 论坛得到[答案。](http://social.msdn.microsoft.com/Forums/en-US/bingmapssilverlightwpfcontrols/thread/34140328-5cbf-4260-a0c2-78e93302a79c/#34140328-5cbf-4260-a0c2-78e93302a79c)

WPF Bing Maps 目前不提供目标边界属性。

# iphone - 将子视图添加到另一个子视图不起作用

> ID：12184052
> 
> 赞同：0
> 
> 时间：2012-08-29T18:13:57.513
> 
> 标签：iphone, ios, ipad, view, addsubview

我正在尝试将标签（headerLabel）添加到另一个子视图（introPadTutorial），但它没有显示在屏幕上。有人可以帮我在哪里犯错吗？

```
//Header file

@property (nonatomic, retain) UIView *introPadTutorial;

//Implementation file

@synthesize introPadTutorial;

UIView *v = [_appDelegate getCurrentView];
CGRect tutorialFrame = [self getTableViewFrame];

introPadTutorial = [[UIView alloc] initWithFrame:CGRectMake(v.frame.size.width, 80, -tutorialFrame.size.width, v.frame.size.height)];
[introPadTutorial setBackgroundColor:[UIColor uberLightGray]];
[introPadTutorial setUserInteractionEnabled:YES];

UILabel *headerLabel = [[UILabel alloc] initWithFrame:CGRectMake(10, 10, 180, 180)];
[headerLabel setText:@"test test test"];
[headerLabel setBackgroundColor:[UIColor greenColor]];
[headerLabel setFont:[UIFont boldSystemFontOfSize:16.0f]];
[headerLabel setTextColor:[UIColor redColor]];
[headerLabel setShadowColor:[UIColor whiteColor]];
[headerLabel setShadowOffset:CGSizeMake(0, 1)];

[self.introPadTutorial addSubview:headerLabel];
[headerLabel release];

[v addSubview:introPadTutorial];
[introPadTutorial release]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:24:11.167

你的`introPadTutorial`观点出现了吗？`initWithFrame`你在它的调用中有一个负宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:25:01.780

可能是你的...

```
introPadTutorial = [[UIView alloc] initWithFrame:CGRectMake(v.frame.size.width, 80, -tutorialFrame.size.width, v.frame.size.height)]; 
```

其实应该...

```
introPadTutorial = [[UIView alloc] initWithFrame:CGRectMake(0, 80, tutorialFrame.size.width, v.frame.size.height)]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:03:19.060

不要使用负宽度来改变位置，使用原点来改变位置。

用这个：

```
introPadTutorial = [[UIView alloc] initWithFrame:CGRectMake(v.frame.size.width - tutorialFrame.size.width, 80, tutorialFrame.size.width, v.frame.size.height)]; 
```

我认为这应该有助于使子视图真正出现。

# php - 如何在 php 中比较 iPhone UDID

> ID：12184055
> 
> 赞同：1
> 
> 时间：2012-08-29T18:14:05.913
> 
> 标签：php, iphone, udid

我可以获取 iPhone udid 并将其发送到服务器。但是当我比较从 iPhone 发送的 udid 和从我的服务器发送的 udid 时，我的 php 代码从未找到任何匹配的东西。

我确信有一个与 iPhone 发送的匹配的 UDID，但我的 php 代码从未找到它。

```
$udid = $_POST["udid"]; // i.e: abcd1234 the udid from iPhone is trim and "-" removed.
$udid_from_server = "abcd1234";

if(strcasecmp($udid_from_server, $udid) == 0){
  //do something...
}else{
  //do something else
} 
```

php代码永远不会进入//做某事

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:29:25.243

您是否对两个字符串都进行了 var_dump 以验证 UDID 实际上已按照您的想法进行了清理（即删除了连字符、全部小写等）？

如果是这样，您应该能够进行比较

```
if($udid == $udid_from_server) {
    // match
} else {
    // not match
} 
```

顺便说一句，你不应该对从 iOS 设备获取 UDID 的想法感到满意，因为它的使用已被弃用，Apple 通常会拒绝要求使用 UDID 的应用程序提交。可能最好查看使用 MAC 地址或您自己的唯一标识符。

# ruby-on-rails-3 - Rails 3如何从belongs_to中的user_id列访问用户数据：用户关联

> ID：12184057
> 
> 赞同：0
> 
> 时间：2012-08-29T18:14:13.027
> 
> 标签：ruby-on-rails-3, associations

我正在尝试使用我的 TrainingSession 模型中的最新活动创建活动提要。

```
class User
  has_many :training_sessions
end

class TrainingSession
  belongs_to :user
end 
```

问题是我试图通过从 TrainingSessions 数据库表中实例化一个对象来访问视图页面中的用户数据（主要是用户名），如下所示：

```
<% @training_sessions.each do |training_session| %>
<%= training_session.user_id %> 
```

问题是，虽然我成功获取到了用户的id，却无法调用，例如：

```
training_session.user_id.name 
```

...否则我会得到如下所示的 NoMethodError：

```
undefined method `first_name' for 2:Fixnum 
```

所以我的问题是......如何从 TrainingSession 的对象访问用户的数据？

任何帮助将非常感激。相当难倒这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T06:49:37.220

您收到“nil:NilClass 的未定义方法‘名称’”错误的原因是某些培训课程不属于用户。解决方案是清理数据库：

```
DELETE FROM training_sessions WHERE user_id IS NULL 
```

如果预期行为具有不属于用户的培训课程，则必须检查该用户是否不在`nil`您的循环中：

```
<% @training_sessions.each do |training_session| %>
  <% unless training_session.user.nil? %>
    <%= training_session.user.name %>
  <% end %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:16:24.900

首先，您需要将模型名称 ( `TreningSessions`) 重命名为单数名称 ( `TreningSession`)。那是rails使用的约定。仅重命名模型，保持`has_many`不变。

现在是用户关联，你应该通过`user`对象调用它。`user_id`只是表示数据库中字段及其值的属性，而是`user`关联对象。试试这个：

`training_session.user.name`

[有关 ActiveRecord 关系的更多信息](http://guides.rubyonrails.org/association_basics.html#the-has_many-association)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:28:50.053

这是我最终要做的，创建一个包含 user_id 的本地用户变量，并使用该变量和用户模型上的 find 方法在我的控制器中实例化一个实例变量 @training_session_user，如下所示：

```
@training_sessions.each do |training_session|
  user = training_session.user_id
  @training_session_user = User.find(user)
end 
```

然后我认为这是：

```
@training_session_user.first_name 
```

它检索名称没有错误。

如果有人有更好的解决方案，请随意，但我现在将其标记为正确。

# php - 这个 OOP 代码基本上正确吗？

> ID：12184062
> 
> 赞同：0
> 
> 时间：2012-08-29T18:14:43.653
> 
> 标签：php, oop, data-structures, object-oriented-analysis

我目前正在尝试将我们的页面模板转换为 OOP，并且我感觉我为导航类提出的内容从根本上来说并不完全正确。

*   这些方法中的一些真的属于扩展类`drawNav`吗？
*   `getMenuBar`-> `generateMenuBar`->结构是否`generateMenuItems`过多分解？它应该只是`getMenuBar`，并把所有的内容从`generateMenuBar()`和`generateMenuItems()`到`getMenuBar()`？

我调用类和方法的方式：

```
$drawNav = new drawNav();

$breadcrumbTrail = $drawNav->getBreadcrumbTrail();
$menuBar = $drawNav->getMenuBar(); 
```

编码：

```
class drawNav { 

            public function __construct() {
                //I’ve not nothing to put here…                                
            }

            public function getMenuBar()
            {
               return $this->generateMenuBar();                          
            }

            public function getBreadcrumbTrail()
            {
                return $this->generateBreadcrumbTrail();                           
            }

            public function getSocialMediaButtons()
            {
                return $this->generateSocialMediaButtons();    
            }

            private function generateSocialMediaButtons()
            {
               //return the HTML code with the social media buttons
            }

            private function generateMenuBar()
            {
               //Generate the HTML containing the menu and social media buttons
               $this->generateMenuItems();
               $this->getSocialMediaButtons();
               //Generate the HTML closing tags for the container for the menu and social media buttons
            }

            private function generateMenuItems()
            {
                //Call to the database and generate each individual menu item and its dropdown
            }

            private function generateBreadcrumbTrail()
            {
                //Generate the HTML containing the breadcrumb trail
                $this->generateBreadcrumbs();
                //Generate the HTML closing tags for the container for the breadcrumbtrail
               }

            private function generateBreadcrumbs()
            {
                //Call to the database and generate the pieces of the breadcrumb trail
            }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T18:16:36.537

> `getMenuBar`-> `generateMenuBar`->结构是否`generateMenuItems`过多分解？

是的。绝对没有理由对包含私有方法的单行公共方法进行一对一映射。这不在任何人的最佳 OOP 实践列表中。

而不是这种奇怪：

```
 public function getSocialMediaButtons()
        {
            return $this->generateSocialMediaButtons();    
        }
        // ...
        private function generateSocialMediaButtons()
        {
           //return the HTML code with the social media buttons
        } 
```

你应该这样做：

```
 public function getSocialMediaButtons()
        {
            //return the HTML code with the social media buttons 
        } 
```

如果您担心能够在公共接口中混合和匹配私有方法，这在以后很容易重构。但是编写单行公共方法，其唯一目的是调用具有*几乎完全相同*名称的私有方法，这是一种巨大的代码气味。

否则，您的代码很好，但有一个警告：我希望您的“返回带有社交媒体按钮的 HTML 代码”正在呈现一些外部 HTML 模板文件，并且您没有在类内编写 HTML 内联。后端/前端逻辑的良好分离比代码部分的结构更重要；我宁愿看到清晰地分离业务/视图逻辑的过程代码，也不愿看到精心设计的将它们混合在一起的面向对象的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:19:08.877

我真的不认为你如何分离你的方法有什么大问题。我个人宁愿让类方法处理一些特定的操作，然后使用其他方法将“构建块”方法组合成更复杂的操作。例如，如果您需要更改面包屑数据库逻辑，则只需在该方法中更改它，并且该方法已从其他方法中抽象出来，足以使其不需要更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:22:22.247

你所拥有的似乎很好。

我会质疑你是否有一个 Navigation 类，因为这都可以添加到其中，或者作为 Navigation 类的扩展，以保持清洁。

# database - CodeIgniter 未知 SQL 错误

> ID：12184064
> 
> 赞同：0
> 
> 时间：2012-08-29T18:14:52.880
> 
> 标签：database, codeigniter

这是我从 db 中选择的代码：

```
$q = $this->db->like('Autor1' or 'Autor2' or 'Autor3' or 'Autor4', $vyraz)
    ->where('stav', 1)
    ->order_by('id', 'desc')
    ->limit($limit)
    ->offset($offset)
    ->get('knihy');

    return $q->result(); 
```

在哪里`$vyraz = "Zuzana Šidlíková";`

错误是：

> Nastala chyba 数据库
> 
> 错误号：1054
> 
> 'where 子句'中的未知列'1'
> 
> `SELECT * FROM (\`knihy`) WHERE `stav` = 1 AND `1` LIKE '%Zuzana Ĺ idlĂkovĂˇ%' ORDER BY `id` desc LIMIT 9
> 
> 文件名：C:\wamp\www\artbooks\system\database\DB_driver.php
> 
> 行号：330

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:18:41.607

您的语法对于您要执行的操作是错误的，但在技术上仍然有效，因为：

```
'Autor1' or 'Autor2' or 'Autor3' or 'Autor4' 
```

...实际上是一个有效的 PHP 表达式，其计算结果为`TRUE`（因为所有非空字符串都是“真实的”），当转换为字符串或`echo`ed 时输出为`1`，因此 DB 类正在寻找一个名为“ 1"。

[例子：](http://codepad.org/2eMcbbgC)

```
function like($arg1, $arg2)
{
    return "WHERE $arg1 LIKE '%$arg2%'";
}

$vyraz = 'Zuzana Šidlíková';
echo like('Autor1' or 'Autor2' or 'Autor3' or 'Autor4', $vyraz);

// Output: WHERE 1 LIKE '%Zuzana Šidlíková%' 
```

无论如何，这就是你需要的：

```
$q = $this->db
    ->like('Autor1', $vyraz)
    ->or_like('Autor2', $vyraz)
    ->or_like('Autor3', $vyraz)
    ->or_like('Autor4', $vyraz)
    ->where('stav', 1)
    ->order_by('id', 'desc')
    ->limit($limit)
    ->offset($offset)
    ->get('knihy'); 
```

# c++ - Visual Studio 2012 没有安装 C-Header？

> ID：12184065
> 
> 赞同：5
> 
> 时间：2012-08-29T18:14:53.467
> 
> 标签：c++, visual-studio-2012

我已经安装了 VisualStudio 2012 并使用它工作了大约 2 周。但现在我想开始一个 C++ 项目（我通常是 c# 程序员），我写了一些简单的代码。之后我想编译它，但我遇到了很多错误......没有标准的 c-header 文件。

我所做的：创建了一个新的 Win32 项目（空项目）使用这些创建的代码包括：

```
#include <windows.h>
#include <stdlib.h>
#include <string.h>
#include <tchar.h> 
```

Windows.h 发现其余的没有。有人有想法吗？我还查看了 IncludeDirectories：

```
$(VCInstallDir)include
$(VCInstallDir)atlmfc\include
$(WindowsSDK_IncludePath) 
```

就这样。有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-09T15:06:02.370

可能您发现了这个已知问题： [https](https://connect.microsoft.com/VisualStudio/feedback/details/774158/re-installed-visual-studio-2010-and-c-standard-headers-are-missing) ://connect.microsoft.com/VisualStudio/feedback/details/774158/re-installed-visual-studio-2010-and-c-standard-headers-are-missing 如果您安装 Visual Studio 2012 从 Visual Studio 2010 导入设置，然后卸载并重新安装，C++ 标准头文件不见了。

Jeff 在以下网址提出了一个对我有用的解决方案： [https ://social.msdn.microsoft.com/Forums/vstudio/en-US/a987f4fa-676f-4fda-ab69-2c6bcc2684c3/visual-studio-c- 2012 标准头文件丢失？forum=vssetup](https://social.msdn.microsoft.com/Forums/vstudio/en-US/a987f4fa-676f-4fda-ab69-2c6bcc2684c3/visual-studio-c-2012-standard-header-files-are-missing?forum=vssetup)

这需要使用 orca 修改 vc_librarycore.msi 的副本，然后运行它。这将安装包含文件所在的 VC 文件夹的一部分（请注意，按照答案建议直接修改原始 vc_librarycore.msi 不起作用，可能是因为权限，所以我将整个 vc_librarycore 文件夹复制到不同的目录）。另请注意，答案中使用的 UUID 可能会根据应用于 Visual Studio 2012 的更新而改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-25T02:34:43.290

你的安装肯定有问题，我建议重新安装。我可以在我的 VS2012 版本中使用这些内容。这是 Visual Studio 的 Express 版本吗？如果是这样，您可能还需要安装 Windows 平台 SDK。

# objective-c - 完成块？嵌入在同步工作流中的异步流程

> ID：12184068
> 
> 赞同：5
> 
> 时间：2012-08-29T18:15:03.543
> 
> 标签：objective-c, xcode, block

长期潜伏者，第一次海报。我对Objective-C比较陌生，所以如果我问一些相当简单的问题，我很抱歉。我的 google & stack overflow-fu 让我失望了，所以我想有人可以帮忙。

我有一个同步进程连续执行三个函数 - 称之为 A -> B-> C ，其中任务 A 执行，然后是 B，然后是 C。

现在，B 涉及一个异步过程，其中包含用于完成的委托回调。但是 B 必须在 C 执行之前完成，所以我需要一些机制使得 C 在 B 完成之前不会被触发。我想这个问题必须有一个共同的设计模式？

最初天真的解决方案是 -

执行 A
执行 B
而 (!B 完成) {}
执行 C

...但这似乎真的很蹩脚。

我怀疑我可以用某种块来做到这一点，但对于我的生活，我就是想不通。有人可以帮忙吗？

感谢任何帮助！

纪尧姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T12:58:07.480

感谢所有的反馈 - 很抱歉没有尽快回复。我现在以与建议略有不同的方式解决了这个问题：

首先，我将 NSObject 扩展为具有以下方法 -

```
#import "NSObject+LTExtensions.h"

@implementation NSObject (Testing)

- (void) performSelectorWithBlock: (SEL) selector withSemaphore:(dispatch_semaphore_t)semaphore
{
  [self performSelector:selector]; // This selector should complete the semaphore
  dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);
  dispatch_release(semaphore);
}

@end 
```

这允许我通过选择器执行一个块。当块执行时，执行它的线程将等待，直到由特定的调度信号量发出信号以继续。

那么我们可以做的如下：

*   呼叫 A
*   创建一个调度信号量并定义一个执行 B 的选择器
*   调用上面定义的方法执行B，等待选择器完成
*   当 B 完成时（通过委托回调），它向调度信号量发出信号以暂停等待
*   然后我执行 C

所以我们有

```
A
B -> Asynchronous with delegate callback
C 
```

这是一个如何实现上述内容的简单示例

```
-(void) methodA {

  // ... do something

  // Assign your semaphore (this is a dispatch_semaphore_t)
  self.semaphore = dispatch_semaphore_create(0);
  [self performSelectorWithBlock:@selector(methodB) withSemaphore:semaphore];
  [self methodC];
}

-(void) methodB {
  // ... do whatever needs to be done asynchronously
  CFRunLoopRun();
}

-(void) methodBDelegateCallBack {
  // This is called when B completes

  // Signal completion
  dispatch_semaphore_signal(self.semaphore);
  CFRunLoopStop(CFRunLoopGetCurrent());
}

-(void) methodC {
 ...
} 
```

效果很好，没有任何问题（但我是 Obj C 的新手，所以我的方法可能存在明显的问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T13:39:41.600

解决此问题的另一种方法可能如下：为异步任务创建一个辅助对象，并在调用该任务时复制一个完成块。异步任务完成后，使用委托方法调用完成块。因此，我们可能会按如下顺序执行任务：

```
FSTask      *taskA = [FSTask taskWithName:@"Task A"];
FSAsyncTask *taskB = [FSAsyncTask asyncTaskWithName:@"Task B"];
FSTask      *taskC = [FSTask taskWithName:@"Task C"];

[taskA performTaskWithCompletionBlock:^ (NSString *result) {
    NSLog(@"%@", result);

    [taskB performTaskWithCompletionBlock:^ (NSString *result) {
        NSLog(@"%@", result);

        [taskC performTaskWithCompletionBlock:^ (NSString *result) {
            NSLog(@"%@", result);

        }];
    }];
}]; 
```

那么这是如何实现的呢？好吧，看看下面的任务对象......

* * *

**FSTask.m** -*主线程上的同步工作......*

```
@interface FSTask ()

@property (nonatomic, copy) NSString *name;

@end

@implementation FSTask

@synthesize name = _name;

+ (FSTask *)taskWithName:(NSString *)name
{
    FSTask *task = [[FSTask alloc] init];
    if (task)
    {
        task.name = name;
    }
    return task;
}

- (void)performTaskWithCompletionBlock:(void (^)(NSString *taskResult))block
{
    NSString *message = [NSString stringWithFormat:@"%@: doing work on main thread ...", _name];

    NSLog(@"%@", message);

    if (block)
    {
        NSString *result = [NSString stringWithFormat:@"%@: result", _name];
        block(result);
    }
}

@end 
```

* * *

**FSAsyncTask.m** -*后台线程上的异步工作...*

```
@interface FSAsyncTask ()

@property (nonatomic, copy) void (^block)(NSString *taskResult);
@property (nonatomic, copy) NSString *name;

- (void)performAsyncTask;

@end

@implementation FSAsyncTask

@synthesize block = _block;
@synthesize name  = _name;

+ (FSAsyncTask *)asyncTaskWithName:(NSString *)name
{
    FSAsyncTask *task = [[FSAsyncTask alloc] init];
    if (task)
    {
        task.name = name;
    }
    return task;
}

- (void)performTaskWithCompletionBlock:(void (^)(NSString *taskResult))block
{
    self.block = block;

    // the call below could be e.g. a NSURLConnection that's being opened,
    //  in this case a NSURLConnectionDelegate method will return the result
    //  in this delegate method the completion block could be called ...

    dispatch_queue_t queue = dispatch_queue_create("com.example.asynctask", DISPATCH_QUEUE_CONCURRENT);
    dispatch_async(queue, ^ {

        [self performAsyncTask];

    });
}

#pragma mark - Private

- (void)performAsyncTask
{
    for (int i = 0; i < 5; i++)
    {
        NSString *message = [NSString stringWithFormat:@"%d - %@: doing work on background thread ...", i, _name];
        NSLog(@"%@", message);

        [NSThread sleepForTimeInterval:1];
    }

    // this completion block might be called from your delegate methods ...

    if (_block)
    {
        dispatch_async(dispatch_get_main_queue(), ^ {

            NSString *result = [NSString stringWithFormat:@"%@: result", _name];
            _block(result);

        });
    }
}

@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T13:14:01.453

这是我用来做这些事情的典型代码（当然，根据您的需要调整 completionBlock 签名和方法名称）

```
typedef void (^BCompletionBlock)(void);

@interface B : NSObject <BDelegate>
@property(nonatomic, copy) BCompletionBlock completionBlock;
-(void)doAsynchronousActionWithCompletion:(BCompletionBlock)aCompletionBlock;
@end

@implementation B
-(void)doAsynchronousActionWithCompletion:(BCompletionBlock)aCompletionBlock
{
    // Store the completion block for later use
    self.completionBlock = aCompletionBlock;
    // Then execute your asynchronous action, that will call some delegate method when done
    [self doYourAsynchronousActionWithDelegate:self];
}

-(void)yourBDelegateMethodCalledWhenDone
{
    // Upon your async task completion, call your completion block then
    if (self.completionBlock) self.completionBlock();
}
@end 
```

然后这里是一个示例用法：

```
-(void)doActions
{
    [a doSynchronousAction];
    [b doAsynchronousActionWithCompletion:^{
       [c doSynchronousAction];
       // A,B,C are now done
    }];
} 
```

我一直这样做是为了将使用委托方法的操作（告诉我它们何时完成）“转换”为使用完成块的操作（例如，有一些类可以为 UIAlertViews、UIActionsSheets 和更多案例执行此操作）和它就像一个魅力。

我发现在这种情况下使用完成块比使用委托机制更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T18:21:23.117

您可以将块属性分配给 B，在调用委托方法之前，它将用于执行代码块。就像是：

@property (nonatomic, copy)void(^yourBlock)(id blockParameter);

因此，在调用 B 的委托后，您可以调用此块并执行它。在这个块中，你可以调用 C 的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T18:22:46.930

我处理这个的方式是。

我在异步调用之前创建了一个 NSMutableDictionary。

然后我进行异步调用。并检查我正在等待的值

```
NSMutableDictionary *dictionary = [NSMutableDictionary dictionary];
[AsyncCallClass asyncCall:^{
    @synchronized(dictionary) {
        [dictionary setValue:myValue forKey:@"result"];
    }
}];

while (true){
    @synchronized(dictionary){
        if ([dictionary valueForKey:@"resultValue"] != nil){
            break;
        }
    }
    [NSThread sleepForTimeInterval:.25];
}
MyResultClass *result = [dictionary valueForKey:@"resultValue"]; 
```

您也可以为此添加超时时间以阻止它成为无限循环。但这是我的解决方案。它似乎工作得很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-10T18:35:09.573

您也可以像这样在块中传递 C...

定义一个自定义块

`typedef void(^myCompletion)(BOOL complete);`

创建你的 B 方法

```
-(void)performBWithCompletionBlock:(myCompletion)complete;
{
  // do your things

  [self.delegate delegateCallback];
  complete(YES);

} 
```

然后创建 BG / async ABC

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{ // now we're on a BG queue to perform our async tasks

             [self performA];
             [self performBWithCompletionBlock:^(BOOL complete) {

                if (complete == YES)
                    [self performC];
             }];
        }); 
```

如果您希望 C 在主线程上

```
dispatch_async(dispatch_get_main_queue(), ^{
    [self performC];
}); 
```

# embedded - NXP LPC17xx 挂起的中断

> ID：12184075
> 
> 赞同：0
> 
> 时间：2012-08-29T18:15:32.997
> 
> 标签：embedded, microcontroller, interrupt, lpc

LPC17xx 系列的外部中断遇到了一个奇怪的问题。

我有一个外部按钮设置为外部中断 1，下降沿与内部作为外部上拉电阻（p2.11）：

```
PinCfg.Funcnum = 1;
PinCfg.OpenDrain = 0;
PinCfg.Pinmode = PINSEL_PINMODE_PULLUP;
PinCfg.Pinnum = 11;
PinCfg.Portnum = 2;
PINSEL_ConfigPin(&PinCfg);
GPIO_SetDir(2,((uint32_t)1<<11),0); 
```

和：

```
EXTICfg.EXTI_Line = EXTI_EINT1;
EXTICfg.EXTI_Mode = EXTI_MODE_EDGE_SENSITIVE;
EXTICfg.EXTI_polarity = EXTI_POLARITY_LOW_ACTIVE_OR_FALLING_EDGE;
EXTI_Config(&EXTICfg);
EXTI_ClearEXTIFlag(EXTI_EINT1); 
```

和：

```
NVIC_SetPriority(EINT1_IRQn,1);
NVIC_EnableIRQ(EINT1_IRQn); 
```

这是 ISR 的一部分（包括 200 毫秒按钮去抖定时器）：

```
void EINT1_IRQHandler(void)
{
    EXTI_ClearEXTIFlag(1);

    uint32_t tim1Cnt = LPC_TIM1->TC;

    if (tim1Cnt > ButtDebounceUs)
    {
        LPC_TIM1->TC = 0x00000000;

        // Do work here
    }
} 
```

“在这里工作”部分可能需要一些时间（例如，在某些情况下超过 200 毫秒）。这是为了进一步执行程序而没有问题。

问题是，当第一次输入 ISR 并且在 ISR 执行时我第二次按下按钮（这必须快速完成）时，设置了一个挂起的中断并导致 ISR 在第一次结束时再次执行时间。我猜这是正常行为，因为 EXTI_ClearEXTIFlag(1) 不会清除 NVIC 中的任何未决中断。所以我添加了 NVIC_ClearPendingIRQ(EINT1_IRQn) 来清除 ISR 代码中几个位置的新挂起中断，以确保挂起的中断被清除。奇怪的是，这根本不起作用。

我的一些问题是，如何通过 JTAG/调试器（内存地址？）读取挂起的中断。这里发生了什么？有人可以解释这种行为，也许有线索如何解决它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:48:06.823

> 当第一次输入 ISR 并且我第二次按下按钮 [...]

这会再次触发 EINT1 标志，但*在*您先清除它之后。这就是为什么

> NVIC_ClearPendingIRQ(EINT1_IRQn) 清除新的挂起中断

does not work, as EINT1 still signals the interrupt line. You need to call

`EXTI_ClearEXTIFlag(1);`

again after the "work" to clear this flag.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T07:42:17.230

我知道做这么长的中断程序通常不是一个好主意。但正如我在问题中所说，这是有意的。我需要确保在 ISR 期间没有执行主要任务中的其他代码。

但回到这个问题：其他人指出，将 EXTI_ClearEXTIFlag(1) 移动到 ISR 的末尾可能是一个好主意。这样就不会产生外部中断，也不会在 ISR 执行期间设置任何挂起。这可行，但我仍然想知道为什么清除挂起的中断不起作用。也许这只适用于 GPIO 中断？

# salesforce - VISUALFORCE /APEX : 简单的电子邮件反馈表

> ID：12184078
> 
> 赞同：0
> 
> 时间：2012-08-29T18:15:43.220
> 
> 标签：salesforce, apex-code, visualforce, force.com

我正在 Visualforce 中开发一个站点，并希望为用户提供一个简单的表单，以便通过电子邮件向我发送反馈。将有 3-4 个字段，例如姓名、用户的电子邮件、原因和反馈以及“发送”按钮。单击发送按钮应该会自动将该消息发送到我的电子邮件地址。

我至少现在不想将表单数据存储在 salesforce 中......我在网上找到的所有关于 visualforce/apex 和电子邮件的内容都是关于将这些数据也保存到 salesforce。

我是否可以只使用 apex 的电子邮件功能并发送电子邮件，而不将这些数据存储在 salesforce 的任何位置？

谢谢，卡尔文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:50:08.200

在 VisualForce 页面上执行操作时，不需要插入/更新/删除数据库中的任何记录。您可以利用[出站电子邮件](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_email_outbound.htm)功能发送通知。对于这样的事情，您可能需要熟悉[SingleEmailMessage](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_email_outbound_single.htm)方法。

一个简单的例子来帮助你：

```
public PageReference actionSend() {
    String[] recipients = new String[]{'myemailaddress@somedomain.com'};
    Messaging.reserveSingleEmailCapacity(recipients.size());
    Messaging.SingleEmailMessage msg = new Messaging.SingleEmailMessage();
    msg.setToAddresses(recipients);
    msg.setSubject('Test Email Subject');
    msg.setHtmlBody('Test body including HTML markup');
    msg.setPlainTextBody('Test body excluding HTML markup');
    msg.setSaveAsActivity(false);
    msg.setUseSignature(false);
    Messaging.sendEmail(new Messaging.SingleEmailMessage[] {msg}, false);
    return null;
} 
```

如果您有兴趣从专用电子邮件地址（例如 noreply@somecompany.com）发送这些出站消息，您可以通过设置 -> 管理设置 -> 电子邮件管理 -> 组织范围的地址菜单进行设置。创建组织范围的地址后，从 URL 中获取 Id 并`setOrgWideEmailAddressId(Id)`在`Messaging.SingleEmailMessage`.

# google-maps - 点击地标会导致位置错误

> ID：12184080
> 
> 赞同：0
> 
> 时间：2012-08-29T18:15:50.407
> 
> 标签：google-maps, kml

以下简单示例说明了我在使用所有 KML 文件时遇到的问题：

[链接到简单 KML 示例](https://maps.google.ca/?q=https://sites.google.com/site/mbkmltest/my-kml-test/Test2.kml)

这是代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.0">
<Document>
  <name>KML Example file</name>
  <description>Simple markers</description>

  <Placemark>
    <name>Marker 1</name>
    <description>Some stuff to put in the first info window</description>
    <Point>
      <coordinates>-122.1,37.4,0</coordinates>
    </Point>
  </Placemark>

</Document>
</kml> 
```

它加载到谷歌地图就好了。一个 Placemarker Icon 出现在正确的位置，但是当我单击左侧面板中的标记 1 时，Google 地图会移动到加纳以南的大西洋。

我已经尝试过各种简单和复杂的 KML 文件，它们都适用于此。如果我对相同的文件使用“我的地点”上传功能，则不会发生这种特殊行为。

我正在使用 Chrome 21 和 Windows 7。

谢谢任何人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T14:02:27.847

@Mike，您正在使用似乎是较旧的名称空间：

```
<kml xmlns="http://earth.google.com/kml/2.0"> 
```

改用 KML 2.2 的明确命名空间可能会带来更好的运气：

```
<kml xmlns="http://www.opengis.net/kml/2.2"> 
```

我也强烈建议您使用这个著名的[KML Validator](http://www.kmlvalidator.com)。

# ruby-on-rails-3 - Rails 3：form_for忽略设置方法

> ID：12184082
> 
> 赞同：3
> 
> 时间：2012-08-29T18:15:54.623
> 
> 标签：ruby-on-rails-3, form-for

用户可以编辑他们的信用卡信息，如下所示：

信用卡控制器：

```
class CreditCardsController < ApplicationController
    before_filter :authenticate_user!
    respond_to :js

    def edit
      @cc = current_user.credit_cards.where(:id => params[:id]).first
      respond_with @cc
  end

end 
```

_form.html.erb：

```
<%= form_for @cc, :remote => true, :html => { :method => :put } do |f| %>
    <div id="cancel-subscription" class="modal-content">
        <div class="header dotted-border">
            <h2>Billing Information</h2>
            <p>Edit the fields below to update your information</p>
        </div>
        <div class="content dotted-border">
            <h2>Credit Card</h2>
        </div>
    </div>
<% end %> 
```

出于某种原因，即使我将其关闭，它也会`form_for`忽略该选项。`:method`它一直设置为`post`. 这是不正确的，因为我正在编辑/更新 CC 条目。还有其他人遇到这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:20:18.190

只需添加

```
 :html => { :method => put } 
```

将不起作用，因为 form_for 在更新和删除时生成带有表单的 _methode 隐藏元素。

只是使用

```
 :method => "put" 
```

形式上可能有效

# android - 数据时间存储格式

> ID：12184084
> 
> 赞同：0
> 
> 时间：2012-08-29T18:16:05.273
> 
> 标签：android, time

我正在从模拟器控件向模拟器发送短信..但它以某种不同的格式显示时间。任何人都可以帮助我理解该代码或格式。这是图片

![在此处输入图像描述](../Images/e01d209699e097ca44be9e935f146e61.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:22:07.007

它可能使用[System.currentTimeMillis()](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#currentTimeMillis%28%29)函数来访问时间，以毫秒为单位返回当前时间。如果您希望格式化日期，请使用：

```
long time = System.currentTimeMillis();
String timeString = new Date(time).toLocaleString(); 
```

或者，如果您只需要其中的时间部分，例如您展示的示例，那么：

```
SimpleDateFormat formater = new SimpleDateFormat("h:mm a");
String timeString = formater.format(new Date(time)); //time is the current time as a long value; 
```

* * *

## 至于如何存储日期：

System.currentTimeMillis()

> 返回当前时间与 UTC 时间 1970 年 1 月 1 日午夜之间的差异，以毫秒为单位。

这意味着，你得到的长数字是自 1970 年 1 月 1 日以来经过的毫秒数。从这个值很容易计算当前年份、月份日期等......

正如您在我之前的示例中所看到的，您可以将此 long 值转换为 Date 对象，方法是将其传递给 Date() 构造函数，您可以使用以下方法将 Date 对象转换为 long 值：

```
long time = dateObject.getTime(); 
```

我希望这有帮助！

# c++ - 我可以访问 Unity 背景元素吗？

> ID：12184086
> 
> 赞同：1
> 
> 时间：2012-08-29T18:16:18.097
> 
> 标签：c++, c, linux, ubuntu, effects

我对 Linux 不是很熟悉，但对 C 和 C++ 有一定的经验。我想联系一些 Visual FX 和/或 UI 开发（C 或 C++）。我想知道是否有可能在 Ubuntu 的[Unity UI](http://en.wikipedia.org/wiki/Unity_%28user_interface%29)上访问桌面的 GUI 元素。

我特别想做的是在桌面或窗口或整个屏幕上渲染动画。（用鼠标左右点击时的粒子效果）。

谁能指出我正确的方向？（图书馆，文件，...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:30:23.440

您想了解更多有关[GTK](http://www.gtk.org/)的信息。网上有很多文档（还有一些书籍）。您可以使用 GtkMM 在 C++ 中编写代码（但您也可以考虑使用 Qt）。GTK 本身是用*C*编码的，具有精心设计的编码风格和约定。查看其源代码是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:56:39.267

我认为必须为相应的窗口管理器专门设计桌面效果。我认为统一使用（某种）compiz，所以你应该研究compiz插件开发。

很多“我认为”，所以我不确定这是否会帮助你，但祝你好运。

# c - 具有中心枢轴元素的快速排序算法不起作用

> ID：12184092
> 
> 赞同：0
> 
> 时间：2012-08-29T18:16:34.313
> 
> 标签：c, algorithm

我是一个新手 C 程序员，并且一直在研究这个算法很长时间。我非常沮丧，因为我无法获得正确的非递减排序序列。

欢迎所有帮助。提前致谢。

这是我的代码：

```
#include <stdio.h>
#include <conio.h>

int swap(short* a, short fst , short scnd){
    short temp  = a[fst] ;
    a[fst]          = a[scnd] ;
    a[scnd]         = temp ;

    return 0 ;
}

int div(short* a ,short p,short middle ,short r){
    while( p < r ){
        if( p < middle ){       
            if( a[p]      > a[middle] ){
                swap(a ,p ,middle) ; 
            }
            p++ ; 
        }
        if( middle < r ){
            if( a[middle] > a[r] ){
                swap(a ,middle , r) ;      
            }         
            r-- ;
        }
    }

    return 0 ;
}

int fast(short* a , short p , short r){
    if( p < r){
        int middle = (p+r)/2 ;
        div(a, p, middle ,r ) ;
        fast(a, p ,middle-1 ) ;
        fast(a ,middle+1 ,r);
    }
}

int main(){
    short n ,i ;
    scanf("%hd",&n);
    short a[n+1] ;
    for(i=1 ; i<=n ; i++ ){
        scanf("%hd",&a[i]);
    }

    fast(a ,1 ,n ) ;
    i=1;
    while(i<=n){
        printf("%hd " , a[i]);
        i++ ;
    }
    getch() ;
    return 0 ;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:32:50.930

错误在于 div 函数本身，它没有遵循 QuickSort 逻辑。你可以在这里找到工作代码[Quicksort algorithm](http://cprogramminglanguage.net/quicksort-algorithm-c-source-code.aspx)

我建议复制粘贴代码并从它的编码标准中获得灵感，包括评论:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T20:51:43.220

我会更改您的 div 函数以返回分区的结果索引。这样，在 fast() 函数中，您可以在分区点的两侧进行递归。这会清理逻辑，并且应该可以轻松地单独测试 div 函数并找到逻辑中的弱点（它肯定在 div() 函数中）。

看起来目前您的代码假设分区总是发生在中间，而快速排序并非总是如此（实际上这是快速排序的微妙点之一）。

这是一个示例分区函数：

```
// please forgive any C-syntax errors not my best language
// low and high indicate a segment of the array to partition
// returns the index between low and high which serves as
// the partition point
int partition(short a[], int low, int high){
  int partition = low;
  int pivot = high;  // sub-optimal when a is already sorted
  for(int i=low; i<high; i++){
    if(a[i] < a[pivot]){
      swap(&a[i], &a[partition]);
      partition++;
    }
  }
  // places the pivot into its final sorted position at partition
  swap(&a[partition], &a[pivot]);
  return partition;
} 
```

这可以递归使用如下

```
sort(short a[], int low, high){
  if(high-low > 0){
    int partition = partition(a, low, high);
    // recurse to left and right of partition
    sort(a, low, partition-1);
    sort(a, partition+1, high);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T22:42:50.190

一个数据序列：
索引：1 2 3 4 5 6 7
数据：1 2 0 10 8 4 5
中间：(1 + 7) / 2 = 4
a[中间]=10
你的功能 div 想要什么？

# c# - Cost of assigning a variable

> ID：12184097
> 
> 赞同：1
> 
> 时间：2012-08-29T18:16:49.783
> 
> 标签：c#, performance, linq, data-structures

```
var addr = (from s in context.Addresses
            where (s.u_address_id == new Guid(this.Id).ToString("B"))
             select s).Single();    
Address Addr = new Address(addr.u_address_id); 
```

What is the cost of assigning a linq result to a variable instead of calling it directly in my usage as follow?

```
Address Addr = new Address(((from s in context.Addresses
                             where (s.u_address_id == new Guid(this.Id).ToString("B"))
                             select s).Single()).u_address_id); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:20:01.603

There is **no** cost in execution time or space consumption. In either case, a storage location is needed for a brief period of time. Some stack slot or register is briefly used to store a reference to the result of the `.Single()` call and pass it to the constructor. After that (assuming you don't use the variable again, which is heavily implied) it is not needed and can (will) be re-used.

More relevant factors could be readability, line length, coding standards, etc.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T18:42:12.537

None. They both do the same thing, but one names a local that would be hidden otherwise.

If you're that nuts for shaving every tiny cost away, why not do:

```
Address Addr = new Address((from s in context.Addresses
  where (s.u_address_id == new Guid(this.Id).ToString("B"))
  select s.u_address_id).Single()); 
```

Not getting all the fields could have an impact from absolutely minute, through pretty miniscule to enough that it would almost matter.

Even better:

```
string add_id = new Guid(this.Id).ToString("B");
if(context.Addresses.Count(s => s.u_address_id == add_id) != 1)
  throw new InvalidOperationException();
Address Addr = new Address(add_id); 
```

(With some sources, `.Where(s => s.u_address_id == add_id).Take(2).Count()` is better, with others not).

Or if you can be confident such a item exists in the source, you can just do:

```
Address Addr = new Address(new Guid(this.Id).ToString("B")); 
```

None of which are massive, but they're all much greater than the concern with giving a temporary a name. I think they get increasingly clear as to what they are actually doing as we go, too. I consider the last, the most readable.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T18:21:11.963

There really isn't much in the way of costs. You might (and yet might not) have a word or two of memory on the stack taken up for a bit longer in the first case, but that's pretty negligible in terms of costs. Readability varies a bit between the two, and that's always a bit of a subjective case. Here I'd say enough is going on that it's a bit more readable on two lines, and it could be a bit easier to debug when you aren't doing too much per line of code.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T18:30:26.947

Well, assuming that the variable is not optimized away by either the compiler or the JIT. Then you start worrying about storing 4 or 8 byte (32 or 64 bit) in RAM or a register.

Compare that to the rest of your code where your query is translated to SQL on the fly, sent over the network to a database server, parsed by the database server, executed by the database server, the result sent back over the network, the result materialized to an object that you can use.

Are you still worried about that 4 byte assignment? I'm not.

# iphone - 自定义键盘将输入发送到文本字段

> ID：12184098
> 
> 赞同：1
> 
> 时间：2012-08-29T18:16:54.140
> 
> 标签：iphone, keyboard, custom-controls

我有我的自定义键盘设置。我创建了按钮。但是我如何传递按下的值，就好像它是一个普通的键盘一样？

例如，如果点击我标记为“1”的按钮，我想将其发送到具有我的自定义输入的 uitextfield，因为它是 inputView，或者任何文本字段是我的自定义键盘的第一响应者。

我确定这很简单...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:45:39.753

您的自定义键盘有一个代表或应该有一个代表在您的自定义键盘视图上按下按钮，不是吗？如果是这样，按钮按下的示例性委托实现可能如下所示，例如对于自定义数字键盘：

```
- (void) customKeyboardView: (YourCustomKeyboardView*) customKeyboardView didTapButtonAtIndex: (NSUInteger) index {
    if (index == 9) {
        // Tapped empty button
    } else if (index == 11) {
        // Back Button Tapped
        NSString* input = self.yourTextField.text;
        if ([input length] > 0 )
            self.yourTextField.text = [input substringToIndex: [input length] - 1];
    } else {
        self.yourTextField.text = [NSString stringWithFormat:@"%@%@", self.yourTextField.text, [self titleForButtonAtIndex: index]];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:41:36.007

尝试这个：

```
UITextField textfield; //your textfield

- (void) whenButtonIsClicked{
    textfield.text = [NSString stringWithFormat:@"%@%@", textfield.text, NEW_CHARACTER_FROM_BUTTON_CLICK];
} 
```

# java - 二维球没有正确碰撞

> ID：12184100
> 
> 赞同：7
> 
> 时间：2012-08-29T18:17:00.083
> 
> 标签：java, 2d, collision-detection

我只是想编写一个漂亮的物理游戏。

球碰撞看起来不错，但如果球碰撞太慢，它们会“粘”在一起。我不知道他们为什么这样做。

这是我的碰撞功能：

```
private void checkForCollision(ArrayList<Ball> balls) {
    for (int i = 0; i < balls.size(); i++) {
        Ball ball = balls.get(i);
        if (ball != this && ball.intersects(this)) {
            this.collide(ball, false);
        }
    }
}

public boolean intersects(Ball b) {
    double dx = Math.abs(b.posX - posX);
    double dy = Math.abs(b.posY - posY);
    double d = Math.sqrt(dx * dx + dy * dy);
    return d <= (radius + b.radius);
}

private void collide(Ball ball, boolean b) {
    double m1 = this.radius;
    double m2 = ball.radius;
    double v1 = this.motionX;
    double v2 = ball.motionX;

    double vx = (m1 - m2) * v1 / (m1 + m2) + 2 * m2 * v2 / (m1 + m2);

    v1 = this.motionY;
    v2 = ball.motionY;
    double vy = (m1 - m2) * v1 / (m1 + m2) + 2 * m2 * v2 / (m1 + m2);

    if (!b)
        ball.collide(this, true);
    System.out.println(vx + " " + vy);
    motionX = vx * BOUNCEOBJECT;
    motionY = vy * BOUNCEOBJECT;
} 
```

但这就是它们以低速碰撞时发生的情况： ![在此处输入图像描述](../Images/c354ee56c94dd6225caddce457f0c785.png)

那么你有什么想法吗？

编辑：

**Alnitak**的更新效果非常好......但一个问题仍然存在......如果我像这样添加重力：

```
public void physic() {
    motionY += GRAVITY;                  // <= this part (GRAVITY is set to 0.3D)
    checkForCollision(screen.balls);
    keyMove();
    bounceWalls();

    posX += motionX;
    posY += motionY;
} 
```

他们仍然相互移动。我认为这是增加重力的错误方法，不是吗？

而且我认为我对碰撞公式做错了，因为它们不正确：

！![落球](../Images/c0f98c21b943bb473baafed60fe7ab64.png)

然后他们慢慢地沉入地下。

**编辑：** 发现了一个惊人的教程：[http ://www.ntu.edu.sg/home/ehchua/programming/java/J8a_GameIntro-BouncingBalls.html](http://www.ntu.edu.sg/home/ehchua/programming/java/J8a_GameIntro-BouncingBalls.html)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T18:20:19.223

这是一个常见的问题，因为有时弹跳球的 delta-v 不足以将其带出碰撞区域。

因此，碰撞程序再次反转方向，将其无限地带回另一个球内。

您应该为球的位置添加足够的偏移量（在碰撞力的方向上），以确保新计算的位置不再发生碰撞。

或者，检查添加新值后球是否*会发生碰撞：*`motion`

```
public boolean intersects(Ball b) {
    double dx = b.posX - (posX + motionX);  // no need for Math.abs()
    double dy = b.posY - (posY - motionY);
    double d = dx * dx + dy * dy;           // no need for Math.sqrt()
    return d < (radius + b.radius) * (radius + b.radius);
} 
```

但您也应该更改`ball.intersects(this)`为`intersects(ball)`.

它们可能看起来有点过早地碰撞，但在快速移动的球上它可能不会被看到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:19:17.753

```
(m1 - m2) * v1 / (m1 + m2) + 2 * m2 * v2 / (m1 + m2); 
```

这有一个整数值 2。请将其设为 2.0f 或 2.0d，然后检查一下。这一定是小速度的问题。因为整数常量自动转换成倍数。

如果这不起作用，那么**Alnitak**的回答会有所帮助。

如果你需要真正好的物理，你应该使用**force**然后将其转换为**velocity**然后将其转换为**displacement**。看看像**龙格库塔**和**欧拉积分这样的积分器技术**

```
Force-->acceleration-->velocity-->displacement 
```

如果发生碰撞，只需更新力，其余的就会流动。

----> [http://codeflow.org/entries/2010/aug/28/integration-by-example-euler-vs-verlet-vs-runge-kutta/](http://codeflow.org/entries/2010/aug/28/integration-by-example-euler-vs-verlet-vs-runge-kutta/) <-----

[http://www.forums.evilmana.com/game-programming-theory/euler-vs-verlet-vs-rk4-physics/](http://www.forums.evilmana.com/game-programming-theory/euler-vs-verlet-vs-rk4-physics/)

[http://www.newagepublishers.com/samplechapter/001579.pdf](http://www.newagepublishers.com/samplechapter/001579.pdf)

[http://cwx.prenhall.com/bookbind/pubbooks/walker2/](http://cwx.prenhall.com/bookbind/pubbooks/walker2/)

**Verlet 积分**是**Runge-Kutta-4**和**Euler 积分**之间的一个点，最好用于分子动力学（如果省略电场和键，这是弹跳球的一个很好的例子）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T20:12:33.260

刚刚找到了一个很棒的教程： [http ://www.ntu.edu.sg/home/ehchua/programming/java/J8a_GameIntro-BouncingBalls.html](http://www.ntu.edu.sg/home/ehchua/programming/java/J8a_GameIntro-BouncingBalls.html)

# python - 为什么 Python 2.x 的 write() 函数不返回写入的字节数？

> ID：12184101
> 
> 赞同：3
> 
> 时间：2012-08-29T18:17:08.363
> 
> 标签：python

我对导致 Python 2.x 的 write() 函数返回 None 而不是写入的字节数的设计决策最感兴趣。这意味着 File 对象有一些不同的心理模型——它不仅仅是一个围绕 UNIX 文件描述符的轻量级包装器。

这是我指的文档：http: [//docs.python.org/library/stdtypes.html#file.write](http://docs.python.org/library/stdtypes.html#file.write)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:20:11.700

来自 Python 官方手册 3.2.2：-

```
write(b) 
```

> **写入 bytes 或 bytearray 对象 b 并返回写入的字节数。**在非阻塞模式下，如果需要写出缓冲区但原始流阻塞，则会引发 BlockingIOError。

# asp.net-mvc-3 - 如何更新表单内容

> ID：12184102
> 
> 赞同：2
> 
> 时间：2012-08-29T18:17:09.693
> 
> 标签：asp.net-mvc-3

我正在使用 asp.net mvc 3 制作一个 Web 应用程序。

有一个表格：

```
@using (Html.BeginForm())
{
<div>
    <fieldset>
        <legend>Approvals</legend>
        <div>
            @Html.Label("Ticket ID")
            @Html.DropDownList("TicketID")
        </div>
        <div>
            @Html.Label("Distributor ID")
            @Html.TextBox("DistributorID", null, new { @readonly = "readonly" })
        </div>
        <div>
            @Html.Label("Description")
            @Html.TextArea("Description", new { @readonly = "readonly" })
        </div>
        <div>
            @Html.Label("Resolved")
            @Html.DropDownList("Resolved")
        </div>
        <div>
            @Html.Label("Date (yyyy/mm/dd)")
            @Html.TextBox("Date")
        </div>
        <div>
            @Html.Label("Time (HH:mm:ss)")
            @Html.TextBox("Time")
        </div>
    </fieldset>
    <input type="submit" value="Approve / Disapprove" />
</div>
} 
```

每当从 TicketID 下拉列表中选择票证 ID 时，如何在从数据库读取值后更新其他字段的数据。即，无论何时更改票证 ID，在从特定票证 ID 的数据库中读取数据后，其他字段中的数据也应相应更改，而无需提交表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:27:38.437

您可以使用 ajax 执行此操作：

```
$('select[name=TicketID]').change(function(){
    var selectedValue = $(this).find('option:selected').val();
    $.getJSON('/mycontroller/MyAction', selectedValue,
    function(result){
        $('input[name=DistributorID]').val(result.DistributorID);
        $('input[name=Description]').val(result.Description);
        $('input[name=Resolved]').val(result.Resolved);
        $('input[name=Date]').val(result.Date);
        $('input[name=Time]').val(result.Time);
    });
}); 
```

在控制器中：

```
public JsonResult MyAction(int selectedValue)
{
    var result = new
    {
        DistributorID = 1,
        Description = 1,
        Resolved= 1,
        Date= 1,
        Time= 1
    };
    return Json(result, JsonRequestBehavour.AllowGet);
} 
```

对不起，我可能有语法错误，我已经直接在这里写了代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:24:47.477

您可以通过 jquery ajax post 调用返回 json 结果的操作。

动作返回你想要的东西。

```
$('#TicketID').change(function(){
   $.ajax({
     url: '/ActionThatReturnsJsonResult',
     cache: false,
     type: 'post'
     success: function (data) {
         $('#DistributorID').val(data.DistributorIDFromDataBase);
     },
     error: function (e) {
         alert(e.responseText);                            
     }
   });
}); 
```

# c# - GridView PageIndexChanging

> ID：12184106
> 
> 赞同：0
> 
> 时间：2012-08-29T18:17:34.483
> 
> 标签：c#, asp.net, gridview, page-index-changed

我有一个gridview，当视图中有超过10个项目时，会添加一个新页面，非常简单......无论如何，当用户在第二页并单击该记录上的删除时，第一页中的项目该行被删除。示例：第 1 页有 10 个项目，第一行是零件号 1234，在第二页上第一行的零件号是 7890。如果用户单击删除 7890 记录，则从第一行删除 1234 记录，或者他们选择删除的相应行。

这是代码：

```
protected void griditems_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        griditems.PageIndex = e.NewPageIndex;
        BindData();
    } 
```

**编辑** 对不起大家......这是删除命令：

```
 protected void griditems_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {
            DataTable dt = (DataTable)Session["table"];
            if (dt.Rows.Count > 0)
            {
                dt.Rows.RemoveAt(e.RowIndex);
                griditems.DataSource = dt;
                BindData();
            }
        }
        catch
        {
            //error message
        }
    } 
```

在 aspx 中：

```
<asp:GridView ID="griditems" runat="server" onrowdeleting="griditems_RowDeleting" onrowediting="griditems_RowEditing" onrowupdating="griditems_RowUpdating"
                  AllowPaging="True" PageSize="10" onpageindexchanging="griditems_PageIndexChanging" Onrowcancelingedit="griditems_RowCancelingEdit" 
                  Caption="Order Details" AutoGenerateDeleteButton="True" AutoGenerateEditButton="True" onrowdatabound="griditems_RowDataBound" >            
        <EditRowStyle BackColor="#FF9900" BorderStyle="Double"/> 
        <RowStyle HorizontalAlign="Center"/>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:23:19.033

您还应该展示您的`griditems_RowDeleting`实现，但即使没有它，我也可以假设您只需要获取行的索引并将页码乘以每页中的记录数量。

```
Console.WriteLine(e.RowIndex); // 7
Console.WriteLine(griditems.PageIndex); // 3

// Assuming you have 10 records per page, you can safely say...
var realIndexOfRecord = e.RowIndex + griditems.PageIndex * 10; // 37 
```

**编辑后：**

```
protected void griditems_RowDeleting(object sender, GridViewDeleteEventArgs e)
{
    try
    {
        DataTable dt = (DataTable)Session["table"];
        if (dt.Rows.Count > 0)
        {
            // Replace `10` with the appropriate variable
            dt.Rows.RemoveAt(e.RowIndex + griditems.PageIndex * 10);
            griditems.DataSource = dt;
            BindData();
        }
    }
    catch
    {
        //error message
    }
} 
```

# java - jruby on rails - 使用星型服务器（rails s）命令时出错

> ID：12184111
> 
> 赞同：4
> 
> 时间：2012-08-29T18:18:20.203
> 
> 标签：java, ruby-on-rails, jruby, runtime-error

时抛出错误

```
 rails s 
```

命令在我的项目的上下文中使用。

以下是我的应用程序设置：

1.  JRuby (1.7.0.preview2)
2.  导轨 (3.2.8)
3.  IBM DB2 Express C (1.01)
4.  活动记录-jdbc-适配器 (1.2.2)

这是java错误：

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  EXCEPTION_PRIV_INSTRUCTION (0xc0000096) at pc=0x0155b803, pid=8552, tid=9692
#
# JRE version: 7.0_06-b24
# Java VM: Java HotSpot(TM) Client VM (23.2-b09 mixed mode, sharing windows-x86 )
# Problematic frame:
# C  0x0155b803
#
# Failed to write core dump. Minidumps are not enabled by default on client versions of Windows
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.sun.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#

---------------  T H R E A D  ---------------

Current thread (0x0155b800):  JavaThread "main" [_thread_in_native, id=9692, stack(0x00030000,0x00230000)]

siginfo: ExceptionCode=0xc0000096

Registers:
EAX=0x00000000, EBX=0x0022e4cc, ECX=0x4b918881, EDX=0x0155be70
ESP=0x0022c31f, EBP=0x00000000, ESI=0x6e2dd981, EDI=0x0155b928
EIP=0x0155b803, EFLAGS=0x00010212

Top of Stack: (sp=0x0022c31f)
0x0022c31f:   00000001 00000000 22c66800 22c31800
0x0022c32f:   1f22ce00 55b80005 4b520001 00000001
0x0022c33f:   00004c00 22c4e000 00189400 00124c00
0x0022c34f:   08000000 22c71411 22c36000 00004e00
0x0022c35f:   00000000 00000000 00000000 00000000
0x0022c36f:   00000000 00000000 00000000 00000000
0x0022c37f:   00000000 00000000 00000000 00010000
0x0022c38f:   00000000 00000000 00000300 00000700 

Instructions: (pc=0x0155b803)
0x0155b7e3:   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x0155b7f3:   00 00 00 00 00 00 00 00 00 00 00 00 00 84 e6 4c
0x0155b803:   6e 00 00 00 00 00 00 00 00 00 00 00 00 48 b4 55
0x0155b813:   01 b0 9e 55 01 00 00 00 00 00 00 00 00 00 52 4b 

Register to memory mapping:

EAX=0x00000000 is an unknown value
EBX=0x0022e4cc is pointing into the stack for thread: 0x0155b800
ECX=0x4b918881 is an unknown value
EDX=0x0155be70 is an unknown value
ESP=0x0022c31f is pointing into the stack for thread: 0x0155b800
EBP=0x00000000 is an unknown value
ESI=0x6e2dd981 is an unknown value
EDI=0x0155b928 is an unknown value

Stack: [0x00030000,0x00230000],  sp=0x0022c31f,  free space=2032k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
C  0x0155b803

[I have cut this in order to post the question]

---------------  P R O C E S S  ---------------

Java Threads: ( => current thread )
  0x05bb2800 JavaThread "JRubyJIT-2" daemon [_thread_blocked, id=7064, stack(0x06530000,0x06730000)]
  0x05bab800 JavaThread "JRubyJIT-1" daemon [_thread_blocked, id=9600, stack(0x06330000,0x06530000)]
  0x041b5c00 JavaThread "Service Thread" daemon [_thread_blocked, id=5368, stack(0x049a0000,0x04ba0000)]
  0x041b0400 JavaThread "C1 CompilerThread0" daemon [_thread_blocked, id=10100, stack(0x047a0000,0x049a0000)]
  0x041af400 JavaThread "Attach Listener" daemon [_thread_blocked, id=5224, stack(0x045a0000,0x047a0000)]
  0x041ac000 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=6284, stack(0x043a0000,0x045a0000)]
  0x014b7400 JavaThread "Finalizer" daemon [_thread_blocked, id=6280, stack(0x03fa0000,0x041a0000)]
  0x014b5800 JavaThread "Reference Handler" daemon [_thread_blocked, id=10156, stack(0x03da0000,0x03fa0000)]
=>0x0155b800 JavaThread "main" [_thread_in_native, id=9692, stack(0x00030000,0x00230000)]

Other Threads:
  0x014b4400 VMThread [stack: 0x03ba0000,0x03da0000] [id=6940]
  0x041d1800 WatcherThread [stack: 0x04ba0000,0x04da0000] [id=5440]

VM state:not at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread: None

Heap
 def new generation   total 4928K, used 637K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K,   4% used [0x14430000, 0x144636b8, 0x14880000)
  from space 512K,  84% used [0x14900000, 0x1496c0e0, 0x14980000)
  to   space 512K,   0% used [0x14880000, 0x14880000, 0x14900000)
 tenured generation   total 10944K, used 7202K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  65% used [0x1ead0000, 0x1f1d88c8, 0x1f1d8a00, 0x1f580000)
 compacting perm gen  total 13056K, used 12877K [0x33830000, 0x344f0000, 0x37830000)
   the space 13056K,  98% used [0x33830000, 0x344c37c8, 0x344c3800, 0x344f0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)

Card table byte_map: [0x039c0000,0x03af0000] byte_map_base: 0x0391de80

Polling page: 0x003f0000

Code Cache  [0x01940000, 0x01b78000, 0x03940000)
 total_blobs=1432 nmethods=1170 adapters=195 free_code_cache=30499Kb largest_free_block=31231360

Compilation events (10 events):
Event: 2.590 Thread 0x041b0400 1168             org.jruby.lexer.yacc.RubyYaccLexer::rightParen (66 bytes)
Event: 2.591 Thread 0x041b0400 nmethod 1168 0x01b76148 code [0x01b76260, 0x01b764cc]
Event: 2.591 Thread 0x041b0400 1169             org.jruby.parser.Ruby19Parser$43::execute (13 bytes)
Event: 2.591 Thread 0x041b0400 nmethod 1169 0x01b76648 code [0x01b76740, 0x01b76800]
Event: 2.598 Thread 0x041b0400 1170             org.jruby.Ruby::getDummy (5 bytes)
Event: 2.598 Thread 0x041b0400 nmethod 1170 0x01b76908 code [0x01b76a00, 0x01b76a80]
Event: 2.600 Thread 0x041b0400 1171             org.jruby.RubyModule::iterateConstantNoConstMissing (55 bytes)
Event: 2.601 Thread 0x041b0400 nmethod 1171 0x01b76ac8 code [0x01b76bf0, 0x01b76d48]
Event: 2.601 Thread 0x041b0400 1172             java.nio.CharBuffer::arrayOffset (35 bytes)
Event: 2.601 Thread 0x041b0400 nmethod 1172 0x01b76f08 code [0x01b77020, 0x01b77198]

GC Heap History (10 events):
Event: 1.702 GC heap before
{Heap before GC invocations=4 (full 0):
 def new generation   total 4928K, used 4928K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K, 100% used [0x14430000, 0x14880000, 0x14880000)
  from space 512K, 100% used [0x14880000, 0x14900000, 0x14900000)
  to   space 512K,   0% used [0x14900000, 0x14900000, 0x14980000)
 tenured generation   total 10944K, used 4557K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  41% used [0x1ead0000, 0x1ef436a8, 0x1ef43800, 0x1f580000)
 compacting perm gen  total 12288K, used 10858K [0x33830000, 0x34430000, 0x37830000)
   the space 12288K,  88% used [0x33830000, 0x342ca9d8, 0x342caa00, 0x34430000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
Event: 1.723 GC heap after
Heap after GC invocations=5 (full 0):
 def new generation   total 4928K, used 512K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K,   0% used [0x14430000, 0x14430000, 0x14880000)
  from space 512K, 100% used [0x14900000, 0x14980000, 0x14980000)
  to   space 512K,   0% used [0x14880000, 0x14880000, 0x14900000)
 tenured generation   total 10944K, used 6066K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  55% used [0x1ead0000, 0x1f0bc850, 0x1f0bca00, 0x1f580000)
 compacting perm gen  total 12288K, used 10858K [0x33830000, 0x34430000, 0x37830000)
   the space 12288K,  88% used [0x33830000, 0x342ca9d8, 0x342caa00, 0x34430000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
}
Event: 2.033 GC heap before
{Heap before GC invocations=5 (full 0):
 def new generation   total 4928K, used 4928K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K, 100% used [0x14430000, 0x14880000, 0x14880000)
  from space 512K, 100% used [0x14900000, 0x14980000, 0x14980000)
  to   space 512K,   0% used [0x14880000, 0x14880000, 0x14900000)
 tenured generation   total 10944K, used 6066K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  55% used [0x1ead0000, 0x1f0bc850, 0x1f0bca00, 0x1f580000)
 compacting perm gen  total 12800K, used 12666K [0x33830000, 0x344b0000, 0x37830000)
   the space 12800K,  98% used [0x33830000, 0x3448e800, 0x3448e800, 0x344b0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
Event: 2.046 GC heap after
Heap after GC invocations=6 (full 0):
 def new generation   total 4928K, used 512K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K,   0% used [0x14430000, 0x14430000, 0x14880000)
  from space 512K, 100% used [0x14880000, 0x14900000, 0x14900000)
  to   space 512K,   0% used [0x14900000, 0x14900000, 0x14980000)
 tenured generation   total 10944K, used 6577K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  60% used [0x1ead0000, 0x1f13c4e8, 0x1f13c600, 0x1f580000)
 compacting perm gen  total 12800K, used 12666K [0x33830000, 0x344b0000, 0x37830000)
   the space 12800K,  98% used [0x33830000, 0x3448e800, 0x3448e800, 0x344b0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
}
Event: 2.247 GC heap before
{Heap before GC invocations=6 (full 0):
 def new generation   total 4928K, used 4928K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K, 100% used [0x14430000, 0x14880000, 0x14880000)
  from space 512K, 100% used [0x14880000, 0x14900000, 0x14900000)
  to   space 512K,   0% used [0x14900000, 0x14900000, 0x14980000)
 tenured generation   total 10944K, used 6577K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  60% used [0x1ead0000, 0x1f13c4e8, 0x1f13c600, 0x1f580000)
 compacting perm gen  total 12800K, used 12728K [0x33830000, 0x344b0000, 0x37830000)
   the space 12800K,  99% used [0x33830000, 0x3449e270, 0x3449e400, 0x344b0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
Event: 2.257 GC heap after
Heap after GC invocations=7 (full 0):
 def new generation   total 4928K, used 189K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K,   0% used [0x14430000, 0x14430000, 0x14880000)
  from space 512K,  37% used [0x14900000, 0x1492f7d0, 0x14980000)
  to   space 512K,   0% used [0x14880000, 0x14880000, 0x14900000)
 tenured generation   total 10944K, used 7071K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  64% used [0x1ead0000, 0x1f1b7f38, 0x1f1b8000, 0x1f580000)
 compacting perm gen  total 12800K, used 12728K [0x33830000, 0x344b0000, 0x37830000)
   the space 12800K,  99% used [0x33830000, 0x3449e270, 0x3449e400, 0x344b0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
}
Event: 2.427 GC heap before
{Heap before GC invocations=7 (full 0):
 def new generation   total 4928K, used 4605K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K, 100% used [0x14430000, 0x14880000, 0x14880000)
  from space 512K,  37% used [0x14900000, 0x1492f7d0, 0x14980000)
  to   space 512K,   0% used [0x14880000, 0x14880000, 0x14900000)
 tenured generation   total 10944K, used 7071K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  64% used [0x1ead0000, 0x1f1b7f38, 0x1f1b8000, 0x1f580000)
 compacting perm gen  total 12800K, used 12762K [0x33830000, 0x344b0000, 0x37830000)
   the space 12800K,  99% used [0x33830000, 0x344a6950, 0x344a6a00, 0x344b0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
Event: 2.431 GC heap after
Heap after GC invocations=8 (full 0):
 def new generation   total 4928K, used 300K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K,   0% used [0x14430000, 0x14430000, 0x14880000)
  from space 512K,  58% used [0x14880000, 0x148cb268, 0x14900000)
  to   space 512K,   0% used [0x14900000, 0x14900000, 0x14980000)
 tenured generation   total 10944K, used 7071K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  64% used [0x1ead0000, 0x1f1b7f38, 0x1f1b8000, 0x1f580000)
 compacting perm gen  total 12800K, used 12762K [0x33830000, 0x344b0000, 0x37830000)
   the space 12800K,  99% used [0x33830000, 0x344a6950, 0x344a6a00, 0x344b0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
}
Event: 2.593 GC heap before
{Heap before GC invocations=8 (full 0):
 def new generation   total 4928K, used 4716K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K, 100% used [0x14430000, 0x14880000, 0x14880000)
  from space 512K,  58% used [0x14880000, 0x148cb268, 0x14900000)
  to   space 512K,   0% used [0x14900000, 0x14900000, 0x14980000)
 tenured generation   total 10944K, used 7071K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  64% used [0x1ead0000, 0x1f1b7f38, 0x1f1b8000, 0x1f580000)
 compacting perm gen  total 13056K, used 12830K [0x33830000, 0x344f0000, 0x37830000)
   the space 13056K,  98% used [0x33830000, 0x344b7ba8, 0x344b7c00, 0x344f0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
Event: 2.598 GC heap after
Heap after GC invocations=9 (full 0):
 def new generation   total 4928K, used 432K [0x14430000, 0x14980000, 0x1ead0000)
  eden space 4416K,   0% used [0x14430000, 0x14430000, 0x14880000)
  from space 512K,  84% used [0x14900000, 0x1496c0e0, 0x14980000)
  to   space 512K,   0% used [0x14880000, 0x14880000, 0x14900000)
 tenured generation   total 10944K, used 7202K [0x1ead0000, 0x1f580000, 0x33830000)
   the space 10944K,  65% used [0x1ead0000, 0x1f1d88c8, 0x1f1d8a00, 0x1f580000)
 compacting perm gen  total 13056K, used 12830K [0x33830000, 0x344f0000, 0x37830000)
   the space 13056K,  98% used [0x33830000, 0x344b7ba8, 0x344b7c00, 0x344f0000)
    ro space 10240K,  45% used [0x37830000, 0x37cb4988, 0x37cb4a00, 0x38230000)
    rw space 12288K,  54% used [0x38230000, 0x388b8030, 0x388b8200, 0x38e30000)
}

Deoptimization events (0 events):
No events

Internal exceptions (10 events):
Event: 2.514 Thread 0x05bab800 Threw 0x146c0b58 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.514 Thread 0x05bab800 Threw 0x146c3420 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.525 Thread 0x05bb2800 Threw 0x14716cf0 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.526 Thread 0x05bb2800 Threw 0x14719ae0 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.528 Thread 0x0155b800 Threw 0x147121c0 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.528 Thread 0x0155b800 Threw 0x147159f0 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.529 Thread 0x0155b800 Threw 0x147446b8 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.529 Thread 0x0155b800 Threw 0x14745148 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.529 Thread 0x0155b800 Threw 0x14748978 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166
Event: 2.529 Thread 0x0155b800 Threw 0x147496a8 at C:\jdk7u2_32P\jdk7u6\hotspot\src\share\vm\prims\jvm.cpp:1166

Events (10 events):
Event: 2.616 loading class 0x042b79b0 done
Event: 2.616 loading class 0x0429f000 done
Event: 2.616 loading class 0x042a2ff0
Event: 2.616 loading class 0x042a2ff0 done
Event: 2.617 loading class 0x05b0a4f8
Event: 2.617 loading class 0x05b0a4f8 done
Event: 2.617 Executing VM operation: Deoptimize
Event: 2.618 Executing VM operation: Deoptimize done
Event: 2.618 Executing VM operation: Deoptimize
Event: 2.618 Executing VM operation: Deoptimize done

Dynamic libraries:
0x00400000 - 0x00456000     C:\jruby-1.7.0.preview2\bin\jruby.exe
0x77a00000 - 0x77b3c000     C:\Windows\SYSTEM32\ntdll.dll
0x76020000 - 0x760f4000     C:\Windows\system32\kernel32.dll
0x75c70000 - 0x75cba000     C:\Windows\system32\KERNELBASE.dll
0x777a0000 - 0x77840000     C:\Windows\system32\ADVAPI32.DLL
0x77b50000 - 0x77bfc000     C:\Windows\system32\msvcrt.dll
0x77c10000 - 0x77c29000     C:\Windows\SYSTEM32\sechost.dll
0x76100000 - 0x761a1000     C:\Windows\system32\RPCRT4.dll
0x77450000 - 0x77519000     C:\Windows\system32\USER32.dll
0x77520000 - 0x7756e000     C:\Windows\system32\GDI32.dll
0x77b40000 - 0x77b4a000     C:\Windows\system32\LPK.dll
0x77230000 - 0x772cd000     C:\Windows\system32\USP10.dll
0x76000000 - 0x7601f000     C:\Windows\system32\IMM32.DLL
0x761b0000 - 0x7627c000     C:\Windows\system32\MSCTF.dll
0x684c0000 - 0x68532000     C:\jruby-1.7.0.preview2\bin\jruby.dll
0x77570000 - 0x775a5000     C:\Windows\system32\WS2_32.dll
0x771f0000 - 0x771f6000     C:\Windows\system32\NSI.dll
0x6e230000 - 0x6e57c000     C:\Program Files\Java\jdk1.7.0_06\jre\bin\client\jvm.dll
0x6f130000 - 0x6f137000     C:\Windows\system32\WSOCK32.dll
0x739c0000 - 0x739f2000     C:\Windows\system32\WINMM.dll
0x75ff0000 - 0x75ff5000     C:\Windows\system32\PSAPI.DLL
0x77e40000 - 0x77efe000     C:\Program Files\Java\jdk1.7.0_06\jre\bin\MSVCR100.dll
0x59220000 - 0x5922c000     C:\Program Files\Java\jdk1.7.0_06\jre\bin\verify.dll
0x59050000 - 0x59070000     C:\Program Files\Java\jdk1.7.0_06\jre\bin\java.dll
0x558b0000 - 0x558c3000     C:\Program Files\Java\jdk1.7.0_06\jre\bin\zip.dll
0x75640000 - 0x75656000     C:\Windows\system32\CRYPTSP.dll
0x753b0000 - 0x753eb000     C:\Windows\system32\rsaenh.dll
0x751b0000 - 0x751c7000     C:\Windows\system32\USERENV.dll
0x75b90000 - 0x75b9b000     C:\Windows\system32\profapi.dll
0x75b10000 - 0x75b1c000     C:\Windows\system32\CRYPTBASE.dll
0x509c0000 - 0x509d4000     C:\Program Files\Java\jdk1.7.0_06\jre\bin\net.dll
0x75600000 - 0x7563c000     C:\Windows\system32\mswsock.dll
0x755f0000 - 0x755f6000     C:\Windows\System32\wship6.dll
0x74540000 - 0x74550000     C:\Windows\system32\NLAapi.dll
0x6ead0000 - 0x6eae0000     C:\Windows\system32\napinsp.dll
0x6eab0000 - 0x6eac2000     C:\Windows\system32\pnrpnsp.dll
0x754c0000 - 0x75504000     C:\Windows\system32\DNSAPI.dll
0x6eaa0000 - 0x6eaa8000     C:\Windows\System32\winrnr.dll
0x6ea70000 - 0x6ea97000     C:\Program Files\Common Files\Microsoft Shared\Windows Live\WLIDNSP.DLL
0x76280000 - 0x762d7000     C:\Windows\system32\SHLWAPI.dll
0x750e0000 - 0x750e5000     C:\Windows\System32\wshtcpip.dll
0x74290000 - 0x742ac000     C:\Windows\system32\IPHLPAPI.DLL
0x74280000 - 0x74287000     C:\Windows\system32\WINNSI.DLL
0x6ea60000 - 0x6ea66000     C:\Windows\system32\rasadhlp.dll
0x74180000 - 0x741b8000     C:\Windows\System32\fwpuclnt.dll
0x55400000 - 0x5540f000     C:\Program Files\Java\jdk1.7.0_06\jre\bin\nio.dll
0x051f0000 - 0x0520b000     C:\jruby-1.7.0.preview2\lib\native\i386-Windows\jffi-1.2.dll
0x76480000 - 0x770ca000     C:\Windows\system32\shell32.dll
0x775b0000 - 0x7770c000     C:\Windows\system32\ole32.dll
0x75ac0000 - 0x75b0c000     C:\Windows\system32\apphelp.dll
0x508b0000 - 0x5099b000     C:\Windows\system32\dbghelp.dll

VM Arguments:
jvm_args: -Djdk.home= -Djruby.home=C:\jruby-1.7.0.preview2 -Djruby.script=jruby -Djruby.shell=cmd.exe -Djffi.boot.library.path=C:\jruby-1.7.0.preview2\lib\native\i386-Windows;C:\jruby-1.7.0.preview2\lib\native\x86_64-Windows -Xmx500m -Xss2048k -Djruby.memory.max=500m -Djruby.stack.max=2048k -Xbootclasspath/a:C:\jruby-1.7.0.preview2\lib\jruby.jar 
java_command: org.jruby.Main
Launcher Type: generic

Environment Variables:
CLASSPATH=.;C:\PROGRA~1\IBM\SQLLIB\java\db2java.zip;C:\PROGRA~1\IBM\SQLLIB\java\db2jcc.jar;C:\PROGRA~1\IBM\SQLLIB\java\sqlj.zip;C:\PROGRA~1\IBM\SQLLIB\java\db2jcc_license_cu.jar;C:\PROGRA~1\IBM\SQLLIB\bin;C:\PROGRA~1\IBM\SQLLIB\java\common.jar
PATH=C:\jruby-1.7.0.preview2\bin;c:\program files\common files\microsoft shared\windows live;C:\Windows\system32;C:\Windows;C:\Windows\system32\wbem;C:\Windows\system32\windowspowershell\v1.0\;c:\program files\microsoft sql server\110\dts\binn\;c:\program files\microsoft sql server\110\tools\binn\;c:\program files\microsoft sql server\110\tools\binn\managementstudio\;c:\program files\microsoft visual studio 10.0\common7\ide\privateassemblies\;c:\program files\windows live\shared;c:\program files\ibm\gsk8\lib;C:\PROGRA~1\IBM\SQLLIB\BIN;C:\PROGRA~1\IBM\SQLLIB\FUNCTION;C:\PROGRA~1\IBM\SQLLIB\SAMPLES\REPL
USERNAME=Joro
OS=Windows_NT
PROCESSOR_IDENTIFIER=x86 Family 6 Model 15 Stepping 13, GenuineIntel

---------------  S Y S T E M  ---------------

OS: Windows 7 Build 7601 Service Pack 1

CPU:total 2 (2 cores per cpu, 1 threads per core) family 6 model 15 stepping 13, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, tsc

Memory: 4k page, physical 3145272k(853168k free), swap 6288788k(2541460k free)

vm_info: Java HotSpot(TM) Client VM (23.2-b09) for windows-x86 JRE (1.7.0_06-b24), built on Aug  9 2012 23:02:07 by "java_re" with unknown MS VC++:1600

time: Wed Aug 29 21:06:00 2012
elapsed time: 2 seconds 
```

有谁知道为什么会发生这种情况以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T04:10:24.483

我不知道如何读取转储，但我可以告诉你 JVM 正在崩溃。

尝试：

1.  不同版本的JVM；Java 6 u35 或 Java 7 u7。
2.  禁用 JIT ( `jruby -Xcompile.mode=OFF`)
3.  为 JRuby 提供超过 500MB 的内存。

也可能是 JDBC 适配器的一些错误，但我不熟悉代码库。无论如何，最好提出一个可以观察到问题的最小测试用例。（理想情况下，这不会涉及 Rails。）

# sql - SQL：要优化的稍微复杂的查询

> ID：12184117
> 
> 赞同：0
> 
> 时间：2012-08-29T18:18:45.507
> 
> 标签：sql, database, query-optimization

好的，我们有一个数据库，它的表列布局不太好，用于一家在线运作的小型新闻机构。目前无法更改布局；所以，我专注于查询。

网页需要“来宾”作者列表。每个列表项应包含：

*   作者的形象（作者）
*   作者姓名（作者）
*   他/她写的最后一篇文章的标题（新闻）
*   那篇文章的 URI（新闻）

括号中是存储信息的表名。

在“作者”（40+ 条记录）中，相关列是：

*   图片
*   姓名
*   类型（我们将在此处查找值“Guest”）
*   ASCII（存储“名称”值但没有非英文字符和空格）

“新闻”（28k+ 条记录）表基本上是一个所有新闻和文章都涌入的池。感兴趣的列是：

*   id（主键：越高，越近）
*   类别
*   标题
*   URI

现在，“类别”有一大堆值；但是，如果特定记录是一篇文章，则此列包含“Authors”的“ASCII”（而不是它的“Id”，遗憾的是）。

有一个 PHP 代码，“同时”查询每个作者。当我看到它时，我想更换它。所以，我想，“嗯......如何一次性取出这些？” 并想出了这个：

```
-- Aliases are prefixed with 't' for tables and 'c' for columns.
SELECT
  tAu.Image, tAu.Name, tNw.Title, tNw.URI
FROM ( -- tAu & tNw

    SELECT * FROM ( -- tRc & Authors

        SELECT
          MAX(Id) cId, Category cCt -- Max Id for most recent
        FROM
          News
        GROUP BY
          cCt

    ) tRc -- table of categories with their most recent id's
    INNER JOIN
      Authors
    ON
      tRc.cCt = Authors.ASCII
    WHERE
      Authors.Type = 'Guest'

) tAu -- table of authors with their most recent id's
INNER JOIN
  News tNw
ON
  tAu.cId = tNw.Id -- merging authors with their latest article info 
```

目前，此查询大约需要 0.0364 秒。可能没那么糟糕；但是，我很好奇这是否可以做得更好（因为这个查询从新闻中选择了两次）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:31:31.867

我不知道它是否更快，但稍微清理了您的查询，这可能有助于优化器：

```
SELECT
  Authors.Image,
  Authors.Name,
  News.Title,
  News.URI

FROM (
    SELECT
      MAX(Id) TopNewsId,
      Category
    FROM News
    GROUP BY Category
) TopNewsPerCats

INNER JOIN News     ON News.Id       = TopNewsPerCats.TopNewsId

INNER JOIN Authors  ON Authors.ASCII = TopNewsPerCats.Category
                   AND Authors.Type  = 'Guest' 
```

`News`表应该有一个以 . 开头的索引`( Category, Id)`以加快内部`SELECT GROUP BY`.

# python - Python sqlite3 占位符

> ID：12184118
> 
> 赞同：6
> 
> 时间：2012-08-29T18:18:52.167
> 
> 标签：python, mysql, sqlite, placeholder

有没有办法在 sqlite3 中设置查询的占位符？我有一些可以与数据库一起使用的函数，如果它们可以同时与 mysql 和 sqlite 一起使用会更令人满意。Mysql 和 Postgres python apis 使用 %s 作为占位符，但 sqlite3 使用问号代替。

无论数据库引擎如何，我都在寻找一种使用相同占位符的方法。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:26:43.660

**更新以修复我之前关于如何使用`paramstyle`全局的错误**

如果您使用的 DB 模块遵循[Python 数据库 API 规范 v2.0](http://www.python.org/dev/peps/pep-0249/)，您可以获得模块全局`paramstyle`，它应该是以下任何一个：

1.  'qmark' 问号样式，例如'...WHERE name=?'
2.  'numeric' 数字，位置样式，例如 '...WHERE name=:1'
3.  'named' 命名样式，例如 '...WHERE name=:name'
4.  'format' ANSI C printf 格式代码，例如 '...WHERE name=%s'
5.  'pyformat' Python 扩展格式代码，例如'...WHERE name=%(name)s'

然后，您可以使用模块使用的占位符来编写 SQL 语句。你可以这样做：

```
import sqlite3

paramstyle = sqlite3.paramstyle

if paramstyle == 'qmark':
    ph = "?"
elif paramstyle == 'format':
    ph = "%s"
else:
    raise Exception("Unexpected paramstyle: %s" % paramstyle)

sql = "INSERT INTO foo VALUES (%(ph)s, %(ph)s, %(ph)s)" % { "ph" : ph } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T18:30:28.087

底层库[不支持`%s`](http://sqlite.org/c3ref/bind_blob.html)，所以需要手动替换。`paramstyle`检查属性并将查询中不同占位符的所有实例替换为适当的值可能会更容易。

# ruby-on-rails-3 - 获取 Rails 模型关联的关联

> ID：12184119
> 
> 赞同：0
> 
> 时间：2012-08-29T18:18:53.493
> 
> 标签：ruby-on-rails-3, activerecord

我有一个模型叫做`salon`that `has_many` `stylists`。`has_many` `appointments`

我当然可以做，`@salon.stylists`我可以做`@stylist.appointments`，但我做不到`@salon.appointments`。

这样的事情可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:23:09.313

您需要添加：

```
has_many :appointments, :through => :stylists 
```

到你的`salon`班级

# jquery - jquery：尝试获取 div 高度时的值错误

> ID：12184133
> 
> 赞同：11
> 
> 时间：2012-08-29T18:20:01.090
> 
> 标签：jquery, height

我有这个html结构：

```
<div class=container>
    <div class=content>
            Content goes here
    </div>
</div> 
```

我正在使用以下方法读出 div.content 高度：

```
var height = $("div.content").height(); 
```

将返回 17（在我的测试用例中）

到目前为止效果很好（将其与使用萤火虫的实际高度进行比较时）。问题是 - 当填充连续文本 > 2 行时，我得到了错误的值。2 行会给我 34（正确），但 3 行也会返回 34，尽管实际高度是 51。当然，当填写大量文本时，结果值都是错误的。对我来说似乎是一个 jquery bug .. 任何解决方法的想法？谢谢

ps：在 IE 中完美运行，firefox 返回错误值..

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-29T18:21:48.830

改为使用**`$("div.content").outerHeight();`**。

如果您还想包括所有边距和填充，则在括号中添加 -true- 。 `$('div.content').outerHeight(true);`

如果您没有非常好的**CSS 重置**，或者正在查看旧版浏览器（即 6/7），跨浏览器的高度可能会有所不同，但如果重置良好，它们的差异将非常微小。

[jsFiddle 演示](http://jsfiddle.net/yz3B6/2/)

# perl - Perl 1,000 子程序重新定义

> ID：12184134
> 
> 赞同：3
> 
> 时间：2012-08-29T18:20:03.463
> 
> 标签：perl

我有一个使用[Module::Reload::Selective](http://search.cpan.org/perldoc?Module%3a%3aReload%3a%3aSelective)加载模块的 Perl 脚本。perl 脚本或多或少看起来像这样。

```
#!/usr/bin/perl

use strict;
use warnings;
use Module::Reload::Selective;

&reload;

sub reload {
    Module::Reload::Selective->reload(qw(myModule));
    import myModule qw($reloadtime);
    $reloadtime = ${myModule::reloadtime};
} 
```

该模块如下所示：

```
package myModule;

use Config::General;
use Data::Dumper;
use DBI;
use HTTP::Request::Common qw { POST };
use HTTP::Headers;
use JSON::XS;
use LWP::UserAgent;
use Module::Pluggable search_path => "Bot";
use POSIX qw(strftime ceil);

# stuff here
1; 
```

当我运行主脚本时，我得到大约 100 个这样的：

```
Subroutine export_fail redefined at /usr/local/share/perl/5.14.2/Carp.pm line 64.
Subroutine _cgc redefined at /usr/local/share/perl/5.14.2/Carp.pm line 66.
Subroutine longmess redefined at /usr/local/share/perl/5.14.2/Carp.pm line 72.
Subroutine shortmess redefined at /usr/local/share/perl/5.14.2/Carp.pm line 92.
Subroutine croak redefined at /usr/local/share/perl/5.14.2/Carp.pm line 100.
Subroutine confess redefined at /usr/local/share/perl/5.14.2/Carp.pm line 101.
Subroutine carp redefined at /usr/local/share/perl/5.14.2/Carp.pm line 102. 
```

我注意到如果我注释掉模块中的一些“使用”语句，这些语句就会消失。但我需要那些。我已经到处搜索并尝试了很多东西。无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:36:26.247

有时可以重新定义子程序。如果您知道自己在做什么并想取消警告，只需输入

```
no warnings 'redefine'; 
```

在您的`reload`方法的顶部。

* * *

同样，只要您知道自己在做什么，另一种选择是暂时禁用内置警告处理程序：

```
sub reload {
    local $SIG{__WARN__} = sub {};
    ... do something that warns ...
} 
```

* * *

作为最后的手段，由于警告被写入`STDERR`，您可以暂时重定向`STDERR`。

```
sub reload {
    open my $devnull, '>/dev/null';  # Windows: >nul
    local *STDERR = *$devnull;
    ... do something that warns ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-25T19:06:08.583

我也有这个。就我而言，我将错误跟踪到 Module::Pluggable 中的 plugins() 调用。如果这也是您的噪音的来源，那么这也可能对您有用。

答案就在这里：[http ://cpansearch.perl.org/src/SIMONW/Module-Pluggable-5.1/lib/Module/Pluggable.pm](http://cpansearch.perl.org/src/SIMONW/Module-Pluggable-5.1/lib/Module/Pluggable.pm)

它解释了 plugins() 被调用超过必要的，这可能会变得昂贵，所以你做这样的事情：

```
package Foo;
  use strict;
  use Module::Pluggable sub_name => '_plugins';

  our @PLUGINS;
  sub plugins { @PLUGINS ||= shift->_plugins }
  1; 
```

起初这对我来说并不完全有效，但是当我将 plugins() sub 充实成几行并在我的 $self.

# windows - 我可以以编程方式访问 RSA 软令牌密码吗

> ID：12184135
> 
> 赞同：2
> 
> 时间：2012-08-29T18:20:07.910
> 
> 标签：windows, powershell, rsa

在我的办公室，我们使用 RSA“软令牌”软件来验证与 UNIX 服务器的连接。这需要输入 PIN，单击一个按钮生成密码，然后单击另一个按钮将新密码复制到 Windows 粘贴缓冲区，然后可以将其粘贴到“密码”提示中。

有没有办法以编程方式执行这些操作，也许是从命令提示符？我希望能够运行连接到服务器的“批处理”程序。

[这是一个类似的问题](https://stackoverflow.com/questions/12072628/is-it-possible-to-access-rsa-secure-id-programmatically-for-use-in-test-automati)，但不完全是。

我的猜测是答案是“不，你不能那样做”，但我想我会问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:29:30.397

看看我提供给这个[SO Question](https://stackoverflow.com/questions/12125959/power-shell-how-to-send-middle-mouse-click/12133352#12133352)的答案。它本质上涉及使用 SendKeys 来模拟对 RSA 应用程序的击键。

# c# - 将两列组合为一列并返回

> ID：12184142
> 
> 赞同：0
> 
> 时间：2012-08-29T18:20:19.687
> 
> 标签：c#, asp.net-mvc, json

我有一个返回 StudentID 的控制器操作。

```
[HttpPost()]
    public ActionResult DisplayStudents()
    {
        StudentDataContext db = new StudentDataContext ();

        var StudentID = (from s in db.vwStudents.Where(s => s.StudentID != null)
                          group s by s.StudentID into g
                          select g.Key).ToList();

         return Json(new {StudentID});

    } 
```

我也想从同一视图返回“StudentName”，但解析最终结果并返回“StudentID - StudentName”，例如“JD11212 - John Deat”

有没有一种方法可以将两列“StudentID”和“StudentName”组合在一起并返回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:22:36.487

```
...
group s by new {s.StudentID, s.StudentName} into g
... 
```

这将创建一个新的匿名类型 {StudentID, StudentName} 这应该是您正在寻找的。

# jquery - Django、django-tinymce、jQuery 和 HTML5 样板

> ID：12184143
> 
> 赞同：1
> 
> 时间：2012-08-29T18:20:21.340
> 
> 标签：jquery, django, tinymce, django-tinymce

我在我的[Django应用程序中使用](https://www.djangoproject.com/)[django-tinymce](https://github.com/aljosa/django-tinymce)和[HTML5 Boilerplate](http://html5boilerplate.com/) (H5BP) 。根据 H5BP 的明智建议，我已将[jQuery](http://jquery.com/)负载放在身体底部。我将 TinyMCE 编辑器附加到我的表单字段，如下所示：

```
 widgets = {
        'content': TinyMCE(attrs={'cols': 40, 'rows': 15}),
    } 
```

不幸的是，django-tinymce 在加载 jQuery 之前尝试通过附加到我的表单和表单集的标签来访问 jQuery。

有没有办法让 django-tinymce 在页面底部加载时与 jQuery 一起玩得很好？我宁愿不必在页面呈现之前加载脚本。

这是一个示例表格行：

```
<td>
<textarea rows="15" cols="40" name="form-0-content" id="id_form-0-content"></textarea>
<script type="text/javascript">tinyMCE.init({"spellchecker_languages": "Arabic=ar,Azerbaijani=az,Bulgarian=bg,Bengali=bn,Bosnian=bs,Catalan=ca,Czech=cs,Welsh=cy,Danish=da,German=de,Greek=el,+English / British English=en,Esperanto=eo,Spanish / Argentinian Spanish / Mexican Spanish / Nicaraguan Spanish=es,Estonian=et,Basque=eu,Persian=fa,Finnish=fi,French=fr,Frisian=fy,Irish=ga,Galician=gl,Hebrew=he,Hindi=hi,Croatian=hr,Hungarian=hu,Indonesian=id,Icelandic=is,Italian=it,Japanese=ja,Georgian=ka,Kazakh=kk,Khmer=km,Kannada=kn,Korean=ko,Lithuanian=lt,Latvian=lv,Macedonian=mk,Malayalam=ml,Mongolian=mn,Norwegian Bokmal=nb,Nepali=ne,Dutch=nl,Norwegian Nynorsk=nn,Punjabi=pa,Polish=pl,Portuguese / Brazilian Portuguese=pt,Romanian=ro,Russian=ru,Slovak=sk,Slovenian=sl,Albanian=sq,Serbian / Serbian Latin=sr,Swedish=sv,Swahili=sw,Tamil=ta,Telugu=te,Thai=th,Turkish=tr,Tatar=tt,Ukrainian=uk,Urdu=ur,Vietnamese=vi,Simplified Chinese / Traditional Chinese=zh", "elements": "id_form-0-content", "theme_advanced_buttons3": "forecolorpicker,fontselect,fontsizeselect", "custom_undo_redo_levels": 10, "skin": "o2k7", "cleanup_on_startup": true, "language": "en", "theme_advanced_buttons1": "bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect", "directionality": "ltr", "theme_advanced_buttons2": "bullist,numlist,|,outdent,indent,|,undo,redo,|,hr", "theme": "advanced", "strict_loading_mode": 1, "mode": "exact"})</script>
</td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-28T20:48:58.780

只需将您`tinyMCE.init({...})`放在 jQuery 的 'onDocumentReady' 中：

```
$(function() {
    tinyMCE.init({"spellchecker_languages": "Arabic=ar,Azerbaijani=az,Bulgarian=bg,Bengali=bn,Bosnian=bs,Catalan=ca,Czech=cs,Welsh=cy,Danish=da,German=de,Greek=el,+English / British English=en,Esperanto=eo,Spanish / Argentinian Spanish / Mexican Spanish / Nicaraguan Spanish=es,Estonian=et,Basque=eu,Persian=fa,Finnish=fi,French=fr,Frisian=fy,Irish=ga,Galician=gl,Hebrew=he,Hindi=hi,Croatian=hr,Hungarian=hu,Indonesian=id,Icelandic=is,Italian=it,Japanese=ja,Georgian=ka,Kazakh=kk,Khmer=km,Kannada=kn,Korean=ko,Lithuanian=lt,Latvian=lv,Macedonian=mk,Malayalam=ml,Mongolian=mn,Norwegian Bokmal=nb,Nepali=ne,Dutch=nl,Norwegian Nynorsk=nn,Punjabi=pa,Polish=pl,Portuguese / Brazilian Portuguese=pt,Romanian=ro,Russian=ru,Slovak=sk,Slovenian=sl,Albanian=sq,Serbian / Serbian Latin=sr,Swedish=sv,Swahili=sw,Tamil=ta,Telugu=te,Thai=th,Turkish=tr,Tatar=tt,Ukrainian=uk,Urdu=ur,Vietnamese=vi,Simplified Chinese / Traditional Chinese=zh", "elements": "id_form-0-content", "theme_advanced_buttons3": "forecolorpicker,fontselect,fontsizeselect", "custom_undo_redo_levels": 10, "skin": "o2k7", "cleanup_on_startup": true, "language": "en", "theme_advanced_buttons1": "bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect", "directionality": "ltr", "theme_advanced_buttons2": "bullist,numlist,|,outdent,indent,|,undo,redo,|,hr", "theme": "advanced", "strict_loading_mode": 1, "mode": "exact"})
}); 
```

# c# - 比较两个日期的最有效方法；一个有时间，一个没有

> ID：12184144
> 
> 赞同：1
> 
> 时间：2012-08-29T18:20:25.620
> 
> 标签：c#, datetime, webforms

我想比较两个日期；一个取自`Date`SQL 中的列和当前的`DateTime.Now`. 前者没有时间部分（从技术上讲，它确实如此，但它被归零了），当然后者将当前时间精确到毫秒。这是我现在正在做的事情，它似乎效率低下：

```
DateTime compareDate = Convert.ToDateTime(string.Format("{0:M/d/yyyy}", DateTime.Now));
if (myObj.EndDate < compareDate)
{
    myObj.Status = "PAST";
}
else if (myObj.StartDate <= compareDate && myObj.EndDate >= compareDate)
{
    myObj.Status = "ACTIVE";
}
else
{
    myObj.Status = "PENDING";
} 
```

有没有更好的方法来去除 DateTime 变量的时间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:21:45.083

是的，使用 DateTime 结构的[Date](http://msdn.microsoft.com/en-us/library/system.datetime.date.aspx)属性，或者只使用[DateTime.Today](http://msdn.microsoft.com/en-us/library/system.datetime.today)。

例如

```
DateTime compareDate = DateTime.Now.Date 
```

或者

```
DateTime compareDate = DateTime.Today 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:22:23.600

在要从中删除时间的 DateTime 变量上使用属性“Date”。

```
var pureDate = DateTime.Now.Date; 
```

# javascript - 在关闭按钮单击时为用户永久关闭灯箱

> ID：12184147
> 
> 赞同：1
> 
> 时间：2012-08-29T18:20:37.750
> 
> 标签：javascript, jquery, asp.net

我在我的 asp.net 页面（http://www.ericmmartin.com/projects/simplemodal/#demo）上使用了一个 jquery 插件（灯箱）。此灯箱使用此灯箱中的 iframe 加载页面。这个灯箱有一个关闭弹出窗口的图像。

我希望当用户单击此图像并再次加载页面时，不会出现此弹出窗口。现在每次用户按 F5 时都会出现弹出窗口。我想我需要在 JS/Jquery 中使用 cookie，但不完全确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:53:00.217

```
function setCookie(c_name, value, exdays) {
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString());
    document.cookie = c_name + "=" + c_value;

}

window.onload = function(){
    if(document.cookie.indexOf("popupopened")>-1){
        if(document.getElementById("your_popup_div")!=null){

                document.getElementById("your_popup_div").parentNode.removeChild(document.getElementById("your_popup_div"));

        return;
    }       
} else { 
    setCookie("popupopened", "Shouldn't open again", 10);
    }
} 
```

# php - 会话提前结束

> ID：12184148
> 
> 赞同：3
> 
> 时间：2012-08-29T18:20:37.737
> 
> 标签：php, session

我们最近从运行 xamp 的 Windows 2003 服务器迁移到运行 PHP 版本 5.3.3 的 apache 的 Centos 服务器。

最初，问题是用户在大约 24 分钟后被注销，所以我更改了 INI 变量`session.save_path`，从而解决了问题。然而，一些用户仍然会定期退出我们的网站，似乎是随机的。它发生在多个用户在不同时间使用不同浏览器的情况。有时在页面闲置之后，但有时在从一个页面浏览到另一个页面时。

以下是我们与会话相关的 INI 设置：

```
 session.save_handler = files  
    session.save_path = "/var/sessions"  
    session.use_cookies = 1  
    ;session.cookie_secure =  
    ;session.use_only_cookies = 1  
    session.name = PHPSESSID  
    session.auto_start = 0  
    session.cookie_lifetime = 86400  
    session.cookie_path = /  
    session.cookie_httponly =  
    session.serialize_handler = php  
    session.gc_probability = 1  
    session.gc_divisor = 1000  
    session.gc_maxlifetime = 86400  
    session.bug_compat_42 = Off  
    session.bug_compat_warn = On  
    session.referer_check =  
    session.entropy_length = 0  
    session.entropy_file =  
    ;session.entropy_length = 16  
    session.cache_limiter = nocache 
```

起初我认为这可能是浏览器中的 cookie 存在问题，因为其中一个用户将他的 cookie 设置为永不过期，即使代码将 cookie 设置为 24 小时后过期。但是，在删除 cookie 并让他重新登录后，它将 cookie 正确设置为 24 小时，他也遇到了同样的过早注销问题。

我创建了一个 cron 作业脚本，该脚本在每天凌晨 4 点删除所有会话，因为会话已移出 tmp 目录。

我今天发现服务器上的会话并没有被删除，但是当用户重新登录时，正在创建一个具有新会话 ID 的新会话，即使他们在服务器上仍然有一个现有会话。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T15:12:13.847

看来问题是由于我的服务器删除会话后我的 cookie 过期引起的。

我有一个脚本设置，每天早上 4 点从服务器手动删除会话，但是我的 cookie 设置为持续 24 小时。因此，即使在用户重新登录网站并在服务器上创建新会话后，cookie 的到期时间也没有更新。

我将 cookie 持续时间减少到 12 小时，这样 cookie 将始终在用户下次需要登录之前过期，问题就消失了。

# jquery - 自动完成组合框向上和向下键在 SlickGrid 中不起作用

> ID：12184151
> 
> 赞同：2
> 
> 时间：2012-08-29T18:20:51.157
> 
> 标签：jquery, jquery-ui, autocomplete, jquery-autocomplete, slickgrid

我创建了一个名为 AutoCompleteEditor 的自定义 SlickGrid 编辑器来挂钩需要成为自动完成组合框的相关字段。到目前为止它工作正常，除了尝试通过按键盘上的向上和向下键来向上和向下滚动项目。我相信问题在于这个自动完成组合框嵌入在 SlickGrid 中，当你按下向下键时，它会导航到网格中 activeCell 正下方的单元格。

所以我的问题是我应该如何在 SlickGrid 中嵌入的自动完成组合框中使用 UP/DOWN 按键来向上/向下滚动建议中的项目？

注意：我知道如何禁用左右键的功能，但上/下键的功能与左/右键不同。

这是自定义编辑器的源代码：

```
function AutoCompleteEditor(args) {
     var $input;
     var defaultValue;
     var scope = this;
     var calendarOpen = false;

     this.init = function () {

       $input = $("<INPUT id='tags' class='editor-text' />");
       $input.width($(args.container).innerWidth() - 28);
       $input.appendTo(args.container);

        $input.bind("keydown.nav", function (e) {
        if (e.keyCode === $.ui.keyCode.LEFT || e.keyCode === $.ui.keyCode.RIGHT) {
          e.stopImmediatePropagation();
        }
        else if (e.keyCode === $.ui.keyCode.UP || e.keyCode === $.ui.keyCode.DOWN) {
         // e.stopImmediatePropagation();

         e.stopImmediatePropagation();
        }
       });

       $( "<a>" )
            .attr( "tabIndex", -1 )
            .attr( "title", "Show All Items" )
            .appendTo( args.container )
            .button({
                icons: {
                    primary: "ui-icon-triangle-1-s"
                },
                text: false
            })
            .removeClass( "ui-corner-all" )
            .addClass( "ui-corner-right ui-combobox-toggle" )

            .click(function() {

                // close if already visible
                if ( $input.autocomplete( "widget" ).is( ":visible" ) ) {
                    $input.autocomplete( "close" );
                    return;
                }

                // work around a bug (likely same cause as #5265)
                $( this ).blur();

                // pass empty string as value to search for, displaying all results

                $input.autocomplete( "search", "" );

                //achieve the positioning in case of scrolling 
                $(".ui-autocomplete").position({
                    my: "left top",
                    at: "left bottom",
                    of: $("#tags"),
                    collision: "flip flip"
                 });

                $input.focus().select();
            });

       $input.focus().select();

       $input.autocomplete({
            delay: 0,
            minLength: 0,
            source: args.column.options
        });

     };

     this.destroy = function () {
       $input.autocomplete("destroy");
     };

     this.focus = function () {
       $input.focus();
     };

     this.position = function (position) {

     $(".ui-autocomplete").position({
        my: "left top",
        at: "left bottom",
        of: $("#tags"),
        collision: "flip flip"
     });

    };

     this.loadValue = function (item) {
       defaultValue = item[args.column.field];
       $input.val(defaultValue);
       $input[0].defaultValue = defaultValue;
       $input.select();
     };

     this.serializeValue = function () {
       return $input.val();
     };

     this.applyValue = function (item, state) {

        var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( state ) + "$", "i" ),
            valid = false;

        jQuery.each(args.column.options , function(index, value){

            if ( value.match( matcher ) ) {
                valid = true;
                item[args.column.field] = state;
                return false;
            }       
        });

        if ( !valid ) {
        // remove invalid value, as it didn't match anything
            $( this ).val( "" );
            $input.data( "autocomplete" ).term = "";
            item[args.column.field]="";
            return false;
        }

          // item[args.column.field] = matcher;
     };

     this.isValueChanged = function () {
       return (!($input.val() == "" && defaultValue == null)) && ($input.val() != defaultValue);
     };

     this.validate = function () {
       return {
         valid: true,
         msg: null
       };
     };

     this.init();
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:41:18.903

在您的 keydown 处理程序中调用 e.stopPropagation() 。

# sql - 如何获取对存储过程的直接 SQL 调用的结果？

> ID：12184152
> 
> 赞同：6
> 
> 时间：2012-08-29T18:20:52.590
> 
> 标签：sql, axapta, dynamics-ax-2009, x++

我正在通过 X++ 中的直接 SQL 调用存储过程，但我不知道如何从中获取整数返回值。0 是好的，-1 是坏的。

```
// Login to SQL DB
loginProperty = new LoginProperty();
loginProperty.setServer('localhost');
loginProperty.setDatabase('SQL_DB');
odbcConnection = new OdbcConnection(loginProperty);
statement = odbcConnection.createStatement();

/*
@in_customer_id                INT
,@status                        INT
,@dlvmode                        NVARCHAR(25)
,@dlvmodedesc                    NVARCHAR(50)
,@tracking_id                    NVARCHAR(50)
,@note                            NVARCHAR(MAX)
,@modified                        SMALLDATETIME = null
,@override_email                NVARCHAR(200) = null
*/

sqlStatement = strfmt(' EXEC pr_send_status_email ' +
                      ' %1,'        +   // CustomerId
                      ' %2,'        +   // Status
                      ' %3,'        +   // DlvMode
                      ' %4,'        +   // DlvMode description
                      ' %5,'        +   // Tracking #
                      ' %6,'        +   // Note
                      ' %7'             // DateTime
                      , 160308
                      , 2
                      , sqlSystem.sqlLiteral("FD1")
                      , sqlSystem.sqlLiteral("Fed Ex overnight")
                      , sqlSystem.sqlLiteral("1ZABCDEF")
                      , sqlSystem.sqlLiteral("Note Here")
                      , sqlSystem.sqlLiteral(DateTimeUtil::utcNow()));

sqlStatementExecutePermission = new SqlStatementExecutePermission(sqlStatement);
sqlStatementExecutePermission.assert();
//BP deviation documented
resultSet = statement.executeQuery(sqlStatement);
//info(strfmt("%1", statement.executeUpdate(sqlStatement))); // I Tried this too
CodeAccessPermission::revertAssert();

if (resultSet.next()) // Errors here
    info(strfmt("Return: %1", resultSet.getInt(1))); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T21:06:15.977

[executeUpdate](http://msdn.microsoft.com/en-us/library/statement.executeupdate.aspx)返回更新的行数；否则为 0 表示不返回任何内容的 SQL 语句。

[executeQuery](http://msdn.microsoft.com/en-us/library/statement.executequery.aspx)返回 ResultSet 类的实例，但调用存储过程不是选择，因此您违反了约定。

不支持您尝试执行的操作。

您可以使用 C# 作为[胶水代码或使用](http://msdn.microsoft.com/en-us/library/37hwc7kt.aspx)[.NET CLR Interop](http://msdn.microsoft.com/en-us/library/cc598160%28v=ax.50%29.aspx)直接使用 C# 类型。

# macos - 检查 NSDocument 是否是新的

> ID：12184157
> 
> 赞同：2
> 
> 时间：2012-08-29T18:21:13.060
> 
> 标签：macos, cocoa, nsdocument, document-based

你怎么知道a`NSDocument`是否是新的？

我目前正在使用`fileURL != nil`，但在文档中找不到任何地方可以证实这一点。

此外，在恢复的文档中`fileURL`返回`nil`（退出应用程序而不保存，然后再次打开应用程序后）。是否可以区分新文档和恢复的文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-18T19:16:53.223

答案是`-[NSDocument draft]`。

[https://developer.apple.com/documentation/appkit/nsdocument/1515065-draft](https://developer.apple.com/documentation/appkit/nsdocument/1515065-draft)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T00:08:10.770

通过反复试验：

```
- (BOOL) readFromURL:(NSURL *)url ofType:(NSString *)typeName error:(NSError *__autoreleasing *)outError {
    self.isNew = NO; // New documents don't call this method

    BOOL success = [super readFromURL:url ofType:typeName error:outError];

    // This must go after calling super
    self.isSaved = self.fileURL != nil; // Saved documents set fileURL
    self.isUnsaved = self.fileURL == nil; // Unsaved/restored documents don't set fileURL. The url parameter points to a temporary folder.

    return success;
} 
```

# php - mod_rewrite 无法识别文件

> ID：12184158
> 
> 赞同：3
> 
> 时间：2012-08-29T18:21:14.120
> 
> 标签：php, sql, mod-rewrite

我的 mod_rewrite 运行良好，但在 /calgary/ 之后它无法识别任何内容

那么，如果我去，`/calgary/login.php`它只看到**index.php**页面？它不会识别`/login.php`页面？

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /city_name

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule (.*)/?$ /city_name/index.php?page=$1 [L,QSA]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} /([^\./]+)\.php$
    RewriteCond %{DOCUMENT_ROOT}/city_name/%1.php -f
    RewriteRule ^(.*)/([^\./]+)\.php$ /city_name/?$2.php?page=$1 [L,QSA]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:12:02.480

您需要交换这两条规则：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /city_name

    # This used to be the 2nd rule
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} /([^\./]+)\.php$
    RewriteCond %{DOCUMENT_ROOT}/city_name/%1.php -f
    # there used to be a "?" here, remove it ----v
    RewriteRule ^(.*)/([^\./]+)\.php$ /city_name/$2.php?page=$1 [L,QSA]

    # this used to be the first rule
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule (.*)/?$ /city_name/index.php?page=$1 [L,QSA]
</IfModule> 
```

限制较少的规则（匹配的规则`(.*)/?$`）将`/calgary/login.php`在第二组规则开始执行其操作之前完全匹配，这似乎被重写为`/city_name/?login.php?page=calgary`.

这真的是你想要的吗？目标中有两个`?`。也许你只想要`/city_name/$2.php?page=$1`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:15:47.677

尝试从第一个重写规则中删除“L”，这会告诉 Apache 如果找到匹配项则停止处理进一步的规则。

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /city_name

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule (.*)/?$ /city_name/index.php?page=$1 [QSA]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} /([^\./]+)\.php$
    RewriteCond %{DOCUMENT_ROOT}/city_name/%1.php -f
    RewriteRule ^(.*)/([^\./]+)\.php$ /city_name/?$2.php?page=$1 [L,QSA]
</IfModule> 
```

# javascript - javascript sdk 正在打开多个登录对话框

> ID：12184159
> 
> 赞同：-1
> 
> 时间：2012-08-29T18:21:20.777
> 
> 标签：javascript, jquery, facebook, facebook-javascript-sdk

我遇到了 Javascript SDK 打开多个对话框以登录的问题。

如果我登录然后退出它工作正常，但下次我登录时会打开 2 个弹出窗口。下次它会打开3等等。

该页面使用 PHP、Javascript/Jquery

代码是本教程的调整版本 [http://thinkdiff.net/facebook/new-javascript-sdk-oauth-2-0-based-fbconnect-tutorial/](http://thinkdiff.net/facebook/new-javascript-sdk-oauth-2-0-based-fbconnect-tutorial/)

这是我的代码：

```
 <div id="fb-root"></div>

<script type="text/javascript">
        var button;

        window.fbAsyncInit = function() {
            FB.init({ appId: '<?php echo $facebook->getAppID() ?>',
                status: true,
                cookie: false,
                xfbml: true,
                oauth: true});

           function updateButton(response) {

                    if (response.authResponse) {
                    $('#loged').hide();
                    $('#logged').show();
                    //user is already logged in and connected
                    FB.api('/me', function(info) {
                        login(response, info);
                    });

                    $("#logged").click(function() {
                        FB.logout(function(response) {
                            logout(response);
                        });
                    });

                } else {
                    //user is not connected to your app or logged out
                    $('#logged').hide();
                    $('#loged').show();

                    $("#loged").click(function() {
                        showLoader(true);
                        FB.login(function(response) {
                            if (response.authResponse) {
                                FB.api('/me', function(info) {
                                    login(response, info);
                                });
                            } else {
                                //user cancelled login or did not grant authorization
                                showLoader(false);
                            }
                        }, {scope:'email,user_likes'});
                    })
                }
            }

            // run once with current status and whenever the status changes
            FB.getLoginStatus(updateButton);
            FB.Event.subscribe('auth.statusChange', updateButton);
        };
        (function() {
            var e = document.createElement('script'); e.async = true;
            e.src = document.location.protocol
                + '//connect.facebook.net/en_US/all.js';
            document.getElementById('fb-root').appendChild(e);
        }());

        function login(response, info){
            if (response.authResponse) {
                $('#loged').hide();
                $('#logged').show();
                showLoader(false);

            }
        }

        function logout(response){
            showLoader(false);
        }

        //shows ajax loader
        function showLoader(status){
            if (status)
                document.getElementById('loader').style.display = 'block';
            else
                document.getElementById('loader').style.display = 'none';
        }

    </script>

    <img id="loged" src="img/in.png"/>
    <img id="logged" hidden="hidden" src="img/out.png"/>
    <div id="loader" style="display:none">
    <img src="img/ajax-loader.gif" alt="loading" />
    </div>
    <br />
    <div id="user-info"></div>
    <br />
    <div id="debug"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T11:48:47.853

> 如果我登录然后退出它工作正常，但下次我登录时会打开 2 个弹出窗口。下次它会打开3等等。

您是否停留在同一页面上 - 没有在两者之间重新加载它？

这将解释您所描述的内容，因为每次`updateButton`调用您的函数并进入 else 分支时，它都会向 中添加一个*新*的附加单击事件处理程序`#loged`，因此它们将开始“累积”，因此 FB.login 将是多次调用——因为每次*单击*都会触发*多个*处理程序（它们都做同样的事情）。

# python - 从任何地方打开（文件）

> ID：12184161
> 
> 赞同：9
> 
> 时间：2012-08-29T18:21:22.763
> 
> 标签：python, macos, file-io

在 OS X Lion 上工作，我试图从终端的任何地方打开我的 python 程序中的文件。我在 .bash_profile 中设置了以下函数：

```
function testprogram() {python ~/.folder/.testprogram.py} 
```

这样我就可以（在终端中）从不同于我的 ~/.

现在，如果我在我的主目录中并运行该程序，则以下内容将起作用

```
infile = open("folder2/test.txt", "r+") 
```

但是，如果我在与我的主文件夹不同的目录中并在终端中写入“testprogram”，程序会启动但无法找到文件 test.txt。

有什么方法可以让 python 从不受我运行程序的位置影响的相同位置打开文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T18:27:54.020

如果你想让它成为多平台，我会推荐

```
import os
open(os.path.join(os.path.expanduser('~'),'rest/of/path/to.file')) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-29T18:24:02.433

使用波浪号来表示主文件夹，就像在 , 中一样`.bash_profile`，然后使用`os.path.expanduser`.

```
import os
infile = open(os.path.expanduser("~/folder2/test.txt"), "r+") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:24:43.817

这与通过 Python 之外的任何其他方式引用文件没有什么不同，您需要使用绝对路径而不是相对路径。

如果您想引用相对于脚本位置的文件，您还可以使用`__file__`模块中的属性来获取当前正在运行的模块的位置。

另外，不要使用 shell 函数，只需给你的脚本一个 shebang 行 ( `#!/usr/bin/env python`)，`chmod +x`它，然后把它放在你的`PATH`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T18:25:18.623

您可以简单地在子外壳中运行该函数，以便在运行它之前可以`cd`回家：

```
function testprogram() { (
    cd && python .folder/.testprogram.py
) } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T18:27:39.383

在 python`sys.argv[0]`中将设置为脚本的路径（如果已知）。您可以使用它加上函数`os.path`来访问与包含脚本的目录相关的文件。例如

```
import sys, os.path

script_path = sys.argv[0]
script_dir = os.path.dirname(script_path)

def script_relative(filename):
  return os.path.join(script_dir, filename)

infile = open(script_relative("folder2/test.txt"), "r+") 
```

David Robinson 指出这`sys.argv[0]`可能不是一个完整的路径名。如果是这种情况，`sys.argv[0]`您可以使用而不是使用。`__file__`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-29T18:27:07.137

使用任一完整路径，例如

```
/path/to/my/folder2/test.txt 
```

或缩写一个

```
~/folder2/test.txt 
```

# php - PHP 到 JavaScript 图表；显示带按钮

> ID：12184162
> 
> 赞同：0
> 
> 时间：2012-08-29T18:21:25.290
> 
> 标签：php, javascript

我使用的图表是用 JavaScript 编写的，所以我需要将 mysql 查询数组传输到 JavaScript，创建图表。mysql 查询由下拉菜单生成。网页上有一个按钮，单击该按钮应显示图表。所有内容都应显示在同一页面上。

我有两个下拉菜单，每个菜单都有跑步者的名字。通过 onChange，每个下拉菜单调用相同的 JavaScript 函数 -

主页.php

```
<form id='awayPick'>    
    <select name='awayRunner' id='awayRunner' onchange='Javascript: getitdone(this);/> 
        ...multiple options
</form>
<form id='homePick'>    
    <select name='homeRunner' id='homeRunner' onchange='Javascript: getitdone(this);/>
       ...multiple options
</form> 
```

js.js

```
function getitdone(str)
{
if (str=="")
    {
        document.getElementById("midSpa").innerHTML="";
        return;
    } 
if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp11=new XMLHttpRequest();
    }
else
    {// code for IE6, IE5
        xmlhttp11=new ActiveXObject("Microsoft.XMLHTTP");
    }
        xmlhttp11.onreadystatechange=function()
    {
        if (xmlhttp11.readyState==4 && xmlhttp11.status==200)
            {
                document.getElementById("midSpa").innerHTML=xmlhttp11.responseText;
            }
    }

var awayRunner = document.getElementById('awayRunner').value;
var homeRunner = document.getElementById('homeRunner').value;

var queryString = "?awayRunner=" + awayRunner + "&homeRunner=" + homeRunner;
xmlhttp11.open("GET","getRunners.php" + queryString,true);
xmlhttp11.send(null);

} 
```

getRunners.php

```
$home=$_GET['homeRunner'];
$away=$_GET['awayRunner'];
$db = db;

$homeRunner=array();
$awayRunner = array();
$leagueRunner = array();

$getHome="select ... from $db where ... = '$home'";
$result2 = mysql_query($getHome);
while($row = mysql_fetch_array($result2)){
    $homeRunner[]= $row['...'];

}
$getAway="select ... from $db where ... ='$away'";
$result22 = mysql_query($getAway);
while($row2 = mysql_fetch_array($result22)){
    $awayRunner[]= $row2['...'];

}
$week = 0;
while($week<20){
    $week++;
    $getLeague = "select ... from $db where ... = $week";
    $resultLeague = mysql_query($getLeague);
    while($row3 = mysql_fetch_array($resultLeague)){
    $leagueRunner[]=$row3['...'];
    }
} 
```

主页.php

```
<script type="text/javascript">
    function chartOne(){
$(document).ready(function() {
    var chart = new Highcharts.Chart({
          chart: {
             renderTo:'container', 
             zoomType:'xy'             },

        title:  {
                    text:

'title'
                },

        xAxis:  {
                    categories: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]
                },

        yAxis: [{ // Primary yAxis
        labels: {
            formatter: function() {
                return this.value + 'pts'
            },
            style: {
                color: '#89A54E'
            }
        },
        title: {
            text: 'text',
            style: {
                color: '#89A54E'
            }
        }
    }, { // Secondary yAxis
        title: {
            text:null,
            },

    }],
    tooltip: {
        formatter: function() {
            return '' +
                this.y + 
            (this.series.name == ' ' ?  ' mm' : 'pts');
        }
    },
        legend: {
                    layout: 'horizontal',
                    backgroundColor: '#FFFFFF',
                    align: 'left',
                    verticalAlign: 'top',
                    x: 69,
                    y: 20,
                    floating: true,
                    shadow: true,
                },

      plotOptions: {
                        column: {
                                    pointPadding: 0.2,
                                    borderWidth: 0
                                }
                    },

        series: [   {
                        name:'adfg',
                        data: [ <?php echo join($awayRunner, ',');?>],
                        type: 'column',
                        pointStart: 0
                        //pointInterval
                    },

                    {

                        name:'fghtrht',
                        data: [<?php echo join($homeRunner, ',');?>],
                        type: 'column',
                        pointStart: 0
                        //pointInterval
                    },

                    {
                        name: 'League Avg',
                        data: [ <?php echo join($leagueRunner, ',');?>],
                        type:'spline',
                        pointStart: 0
                        //pointInterval
                    },
                ]
        });
});
    }
    </script>

<input type='submit' value='chart One' onclick='chartOne()'></input>
<div id='container' style='width: 50%; height: 200px; float: left;'></div> 
```

如何将 php 数组返回到 javascript 的主页？我应该将 JavaScript 放在其他地方吗？

问题是，当我没有尝试传递跑步者的名字时，我已经让所有这些都在单独的页面上运行。如果我在 getRunners.php 页面上明确说明了跑步者的名字，一切都会很好。我无法将 php 变量插入 JavaScript 以生成图表。

我尝试将 js 代码分配给 getRunners.php 页面中的 php 变量，然后在 home.php 页面上回显该变量，但该变量不起作用。

看来，一旦主页被加载，JS 保持不变。如何在选择下拉选项后通过 PHP 变量，使图表仅在单击按钮后才显示？

谢谢你。我希望这比我之前的问题更清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:03:19.250

这是我如何使用 onchange 方法来刺激 MYSQL 查询并让 Highchart 显示结果。主要问题是返回的 JSON 数组是一个需要转换为 INT 的字符串。然后在数据中使用 resultArray 变量：highChart 的部分。

```
$(function(){
  $("#awayRunner").change(function(){ 
    $.ajax({
    type: "POST",    
    data: "away=" + $("#awayRunner").val(),
    dataType: "json",
    url: "/getCharts.php",
    success: function(response){
          var arrayLength = response.length;
          var resultArray = [];
          var i = 0;
          while(i<arrayLength){
              resultArray[i] = parseInt(response[i]);
              i++;
          } 
```

在 PHP 代码中，数组必须像这样返回为 JSON

echo json_encode($awayRunner);

# scala - 对scala'match'编译规则的误解

> ID：12184172
> 
> 赞同：4
> 
> 时间：2012-08-29T18:22:11.683
> 
> 标签：scala, compiler-errors, match

我一定对 Scala 的“匹配”语义或编译器逻辑有一些基本的误解。这段代码：

```
val stageStart:Int = 0
val stageShutDown:Int = Int.MaxValue
val stageErrorReport:Int = Int.MinValue

def stageString(stage:Int):String = stage match {
  case stageStart       => "Start"
  case stageShutDown    => "End"
  case stageErrorReport => "Error"
  case _                => "Step " + String.valueOf(stage)
} 
```

在最后 3 个“案例”语句中导致“无法访问代码”错误？如果您用实际值（0、Int.MaxValue、Int.MinValue）代替名称，它会编译——但现在我已经硬编码了应该由它们的名称引用的值（出于所有通常的原因）。既然“val”永远不会改变，那么第一个版本不应该也可以吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T18:32:07.757

有一个微妙而重要的特性：如果`case`规则中的标识符以小写字母开头，它们总是被视为**变量**。所以第一个`case`匹配总是（存储`stage`到变量`stageStart`中），其余的 3 个是无法访问的。您需要将带有大写字母的常量定义为

```
val StageStart:Int = 0
val StageShutDown:Int = Int.MaxValue
val StageErrorReport:Int = Int.MinValue

def stageString(stage:Int):String = stage match {
  case StageStart       => "Start"
  case StageShutDown    => "End"
  case StageErrorReport => "Error"
  case _                => "Step " + String.valueOf(stage)
} 
```

然后它们不会被视为变量，而是作为模式匹配的常量。

另请参阅[此答案](https://stackoverflow.com/a/9752606/1333025)以[了解 Scala 常量的命名约定？](https://stackoverflow.com/q/9745488/1333025)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-29T18:32:18.163

问题是当您使用以小写字符开头的变量时，模式匹配器认为您正在尝试**分配**给该变量。所以你会得到这种行为：

```
val stageStart = 0
val stage = 5
def stageString(stage: Int) = stage match {
  case stageStart => println(startStage)  // prints "5"
} 
```

当然，只是一个可赋值变量的模式将匹配*任何东西*，因此任何后续`case`都将无法访问。

要解决这个问题，您需要使用“稳定标识符”。这可以通过将小写变量放在反引号中来完成：

```
val stageStart = 0
def stageString(stage: Int) = stage match {
  case `stageStart` => "Start"
} 
```

或重命名变量，使其以大写字符开头：

```
val StageStart = 0
def stageString(stage: Int) = stage match {
  case StageStart => "Start"
} 
```

另外：`String.valueOf(stage)`应该改写为`stage.toString`.

# dataset - PCA降低数据集维数的简单解释

> ID：12184175
> 
> 赞同：0
> 
> 时间：2012-08-29T18:22:20.297
> 
> 标签：dataset, artificial-intelligence, pca

我知道**PCA 不会告诉您数据集的哪些特征最重要，而是哪些特征组合保持最大差异。**

您如何利用 PCA 旋转数据集以使其沿第一维具有最大方差、沿第二维具有最大方差等这一事实来降低数据集的维数？

我的意思是，更深入地说，前 N 个特征向量如何用于将特征向量转换为保持大部分方差的低维表示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T14:53:43.013

让`X`是一个`N x d`矩阵，其中每一行`X_{n,:}`都是来自数据集的向量。

然后`X'X`是协方差矩阵，并且特征分解给出`X'X=UDU'`其中`U`是`d x d`特征向量的矩阵，`U'U=I`并且`D`是特征值的`d x d`对角矩阵。

特征分解的形式`U'X'XU=U'UDU'U=D`意味着如果你转换你的数据集，`U`那么新的数据集`XU`, 将有一个对角协方差矩阵。

如果特征值从大到小排序，这也意味着第一个变换特征的均方值（由表达式 给出`U_1'X'XU_1=\sum_n (\sum_d U_{1,d} X_{n,d})^2`）将大于第二个，第二个大于第三个，等等。

如果我们将数据集的特征从平均值最大值到最小值排序，那么如果我们只是去掉平均值小的特征（并且大平均值的相对大小比小的平均值大得多），那么我们有没有丢失太多信息。这就是概念。

# sockets - 如何计算数据包的到达时间？

> ID：12184179
> 
> 赞同：4
> 
> 时间：2012-08-29T18:22:25.370
> 
> 标签：sockets, node.js

我想知道，如何计算从客户端发送的数据包的到达时间。我尝试使用数据包发送时间戳（自 1970 年以来的毫秒数），然后在服务器上像这样计算它。

> timestamp_on_server - timestamp_from_packet

但问题是我也得到负数，这是不正确的。

那么我该如何以正确的方式做到这一点呢？:-)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:08:16.923

当机器未正确同步到时间源时，这不起作用（请参阅[NTP](http://en.wikipedia.org/wiki/Network_Time_Protocol)）。

但总的来说，依靠在不同节点上采样的时间并不是最好的主意。您可以做的是测量[**往返时间**](http://en.wikipedia.org/wiki/Round-trip_delay_time)（发送到那里的数据包并在发送者的时间戳完好无损的情况下反射回来），因此您只能使用相同的时间源。

旁注：如果由某些特权进程强制调整，同一台机器上的时钟仍然可以跳回，因此忽略（并可能记录）负 RTT 值可能是个好主意。

# jsrender - 在 jsRender 中循环

> ID：12184182
> 
> 赞同：2
> 
> 时间：2012-08-29T18:22:30.950
> 
> 标签：jsrender

我知道`{{for}}`可以遍历一个集合。但是我可以根据总数循环吗？

说，如果我有`TotalPage`一个整数，我怎样才能创建一个分页列表，如：

```
{{for (Page=1; Page<=TotalPage; Page++;)}} // I made up this statement.
    {{if Page=CurrentPage}}
        <li class="selected">{{>Page}}</li>
    {{else}}
        <li>{{>Page}}</li>
    {{/if}}
{{/for}} 
```

这在 jsRender 中可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T13:34:15.553

这可以通过`#index`存在于 {{for /}} 块中的属性来完成。

```
{{for myModel.myArray }}
    <li>This is item number {{:#index}}</li>
{{/for}} 
```

`#index`包含正在呈现的数组的当前索引。但是，至少在本机上，您*不能*指定任意次数来呈现模板。正如马特鲍尔在评论中所说的那样，放在模板中的逻辑太多了。

但是，如果您下定决心，您可以在模型中创建一个任意大小的数组并对其进行迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-13T09:34:24.690

```
 {{for #data.pages}}
          {{if #data.page == currentPage }}  // data refers to the pages 
              <li class="selected">{{>Page}}</li>
          {{/if}}   
        {{else}}
               <li>{{>Page}}</li>   
        {{/for}} 
```

希望这是您正在寻找的结构，

# php - chrome 中的 Facebook JavaScript SDK 连接问题

> ID：12184187
> 
> 赞同：-1
> 
> 时间：2012-08-29T18:22:47.973
> 
> 标签：php, javascript, facebook

最近我决定尝试使用javascript sdk集成facebook api connect ..经过一些尝试后我注意到chrome的问题..可能我是唯一遇到此类错误的人..

：当我连接到 facebook 时，它会一次又一次地刷新.. 不停地我必须关闭那个标签.. 不知道会发生什么

我检查了 Mozilla 并且它工作正常.. 之后我在 chrome 中再次尝试了它仍然有同样的问题.. 如果你对此有任何了解，请在评论中写下它。

**后端**

```
 <?php if(!defined('DOCROOT')) exit('No directory browsing allowed!');
class fb_connect extends Frontend{

    private $allow_post = true;
    private $allow_get = true;

    function __construct(){
        parent::__construct();

    }

    function index(){

        $facebook = new Facebook(array(
          'appId'  => FBAPPID,
          'secret' => FBSECRETID,
        ));

        $user = $facebook->getUser();
        $outx = NULL;
        if ($user) {
            try {
                $user_profile = $facebook->api('/me');
                $output['user_profile'] =  $user_profile;
            } catch (FacebookApiException $e) {
                $user = null;
            }
        }
        $output['user'] =  $user;

        $this->tpl->contents['fb'] = $this->tpl->fetch('contents/fb_connect',$output);

        $this->tpl->meta['title'] = "Facebook Connect Test";
        //$this->tpl->meta['description'] = $this->lang['contact_meta_description'];
        //$this->tpl->meta['keywords'] = $this->lang['contact_meta_keywords'];
        $this->tpl->render('layouts/default');
    }
}
?> 
```

**正面**

```
 <?php if ($user) : ?>
      Your user profile is
      <pre>
        <?php print htmlspecialchars(print_r($user_profile, true)) ?>
      </pre>
      <a  onclick="FB.logout();">Logout</a> 
    <?php else : ?>
      <fb:login-button></fb:login-button>
    <?php endif; ?>

    <script>
      window.fbAsyncInit = function() {
        FB.init({
          appId: '<?php echo FBAPPID; ?>',
          cookie: true,
          xfbml: true,
          oauth: true
        });
        FB.Event.subscribe('auth.login', function(response) {
          window.location.reload();
        });
        FB.Event.subscribe('auth.logout', function(response) {
          window.location.reload();
        });
      };
      (function() {
        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol +
          '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
      }());
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:53:52.317

为什么？

```
FB.Event.subscribe('auth.login', function(response) {
  window.location.reload();
});
FB.Event.subscribe('auth.logout', function(response) {
  window.location.reload();
}); 
```

FB.Event.subscribe( *EVENT* , function(...) {...}) 将在每次触发*EVENT*时触发。这是你的无限循环。该块中的 console.log() 只会触发一次，但由于您重新加载整个页面，该事件将再次触发。

# excel - 在excel中查找倍数之间的差异的公式

> ID：12184188
> 
> 赞同：0
> 
> 时间：2012-08-29T18:22:48.350
> 
> 标签：excel, formula

公式是找出要在excel中用于订购表格的倍数的差异。例如，商品的订单必须以 6 的倍数排列，每订购 6 件，您就可以免费获得一件。因此对于 6 个计算结果需要显示“1 item free”。12个计算结果需要显示“2项免费”。对于 11，需要显示“多订购 1 件，或少订购 5 件”。

如何在 Excel 电子表格中定义此公式/计算？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:27:46.093

你想要[模块化数学](http://www.techonthenet.com/excel/formulas/mod.php)：

例如购买了 14 件商品，以 5 件为一组购买：

```
14 mod 5 = 4

buy 1 more (5 - 4) or 4 less. 
```

# javascript - 使用 JavaScript 使动态 HTML 页面重定向到 URL

> ID：12184190
> 
> 赞同：4
> 
> 时间：2012-08-29T18:23:02.947
> 
> 标签：javascript, html, redirect

我需要制作一个动态 HTML 页面以使用 JavaScript 重定向到一个 URL。
作为一个初学者，我需要你的帮助......
我想做的是通过一个 html 页面重定向到一个 url。
例如：假设一个页面地址是`www.example.com/pages.html?http://yahoo.com/news`这样`pages.html`的，在这种情况下，这个页面会将用户重定向到 yahoo.com/news ...。
我知道如何使用 PHP 来做到这一点，但我不明白我应该如何使用 javascript 和 HTML 来做到这一点。任何想法？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:26:43.813

这应该这样做：

```
 function Redirect(){
  var current = window.location.href;
  var exclude = current.indexOf('?');
  window.location = current.substr(exclude + 1);
 }
 setTimeout("Redirect()",5000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:24:42.837

您可以使用`window.location.href="new-url.html";`JavaScript 访问 URL。

要解析 URL，请使用`var theURL=window.location.href.split("?")[1];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:33:43.640

```
location.href = location.href.split("?")[1]; 
```

# iphone - 上传应用时支持 URL

> ID：12184194
> 
> 赞同：-1
> 
> 时间：2012-08-29T18:23:11.527
> 
> 标签：iphone, ios

在 iTunes 上上传应用程序时，支持 URL 应该是什么？它正在给出警告以填写支持网址，但我对此一无所知。任何人都可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:26:05.303

支持 URL 应指向您为支持您的应用而创建的网站。您可以创建一个快速网站，该网站本质上是您未来支持网站的占位符，但他们想要一些东西，或者只是使用免费博客，您可以在其中为您的应用程序提供支持信息。他们接受它并不一定很棒。

# javascript - 如何使用 ajax 和 jquery 动态更新数组表？

> ID：12184199
> 
> 赞同：2
> 
> 时间：2012-08-29T18:23:21.153
> 
> 标签：javascript, jquery, ajax, dynamic

我有两个文件php（gettable.php和index.php）索引文件显示gettable.php获得的结果每隔一个，我想在索引中动态更新我的表的内容（只有新的或改变的值必须改变) 使用 ajax，我是 ajax 的初学者。

请帮帮我谢谢

可获取的.php

```
 //
    //
    // I load data from the server(xml file) 
    $xml = simplexml_load_string($result);

    foreach($xml as $node)
    {
        $name = "";
        $value = -1;

        foreach($node->attributes() as $a => $b) {
            if($a == "name")
            {
                $name = (string)$b;
    }
    else if($a == "value")
    {
        $value = (string)$b;
    }
        }

        $vars[$name] = $value;
    }

    ?>
    <table border="1">
    <tr>
    <th>id</th>
    <th>abc</th>
    <th>def</th>
    </tr>
    <tr>
    <td><?php
    echo "<p>x: ".$vars["x"]."</p>";
    ?>
    </td>
    <td><?php
    echo "<p>y: ".$vars["y"]."</p>";
    ?>
    </td>
    <td><?php
    echo "<p>z: ".$vars[z"]."</p>";
    ?>
    </td>
    </tr>
    </table> 
```

文件 index.php

```
 <html>  
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script language="JavaScript">
    $('#data').load("gettable.php");
    setInterval( "SANAjax();", 1000 ); 

    $(function() {
        SANAjax = function(){

        $('#data').load("gettable.php");

        }
    });

</script>
</head>
<body>

    <div id="data">
        <?php include_once('gettable.php'); ?>
    </div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:27:39.257

脚本代码应该是这样的

```
$(function(){
  function loadData(){
    $('#data').load("gettable.php");
  }

  setInterval(function() { loadData(); }, 1000 ); 

}); 
```

# math - 运行 AGMG 时出现分段错误

> ID：12184201
> 
> 赞同：0
> 
> 时间：2012-08-29T18:23:30.500
> 
> 标签：math, linear-algebra, numerical-methods

我已将 C++ 程序与 AGMG 库中的 fortran dagmg.f90 例程链接起来。最初，稀疏矩阵由 Eigen 库以 CRS 格式构建，然后我将其转换为 fortran 例程所需的格式。AGMG 运行并计算非零数并显示未知数。但随后它突然显示分段错误。我无法弄清楚背后的原因是什么。

```
 int jatest[NNZ];
int iatest[nodes+1];
double bftest[nodes];
double VXtest[nodes];
// code to convert Af into a, ja, ia vectors for AGMG
double *aptr; int* japtr; int* iaptr;
aptr = Af.valuePtr();
japtr = Af.innerIndexPtr();
iaptr = Af.outerIndexPtr();
for (i = 0; i < NNZ ; i++ ){
  atest[i] = aptr[i];
  jatest[i] = japtr[i] + 1;
 // cout << atest[i] << "\t" << japtr[i] << endl;
}
for ( i = 0; i <= nodes; i++){
  iatest[i] = iaptr[i] + 1;
   }
 dagmg_(nodes,atest,jatest,iatest,bftest,VXtest,ijob,iprint,nrest,iter,tol); 
```

输出如下所示：

****进入 AGMG ** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ****

****未知数：17 **** 非零数：51（每行：3.00）**

 **分段故障

为什么我会出现这个错误？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T10:30:48.013

问题解决了 ：

实际上，问题在于 AGMG 调用 LAPACK 函数以直接解决最粗略的级别。更改链接到 AGMG 的 lapack 库后，解决了这个分段错误的问题。

仅供参考：

```
g++ *.o ~/lapack-3.4.1/liblapack.a ~/CLAPACK-3.2.1/lapack_LINUX.a ~/mylibs/blas_LINUX.a ~/CLAPACK-3.2.1/blas_LINUX.a ~/CLAPACK-3.2.1/F2CLIBS/libf2c.a ~/lapack-3.4.1/liblapack.a -o myexe -lgfortran 
```**

# ios6 - 如何处理新的权限/访问请求？

> ID：12184203
> 
> 赞同：1
> 
> 时间：2012-08-29T18:23:36.587
> 
> 标签：ios6

我正在尝试了解如何处理 iOS 6 中的权限/访问请求。到目前为止，我发现的所有内容都只是模糊地描述了这一点，而没有提供任何代码示例等。是否有任何好的资源/教程呢？

具体来说，我试图发现是否有办法以编程方式重新提示用户以允许访问地址簿等。或者只是关于如何将这些东西集成到应用程序中的一般信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T22:47:49.507

Under Address Book in the iOS 6 SDK Release Notes, it says:

> Users are able to grant or deny access to contact data on a per-app basis. To request access to contact data, call the ABAddressBookRequestAccessWithCompletion function after calling the ABAddressBookCreateWithOptions function. The ABAddressBookRequestAccessWithCompletion function does not block the app while the user is being asked to grant or deny access. Until access has been granted, the ABAddressBookRef object will not contain any contacts, and any attempt to modify contacts fails with a kABOperationNotPermittedByUserError error. **The user is prompted only the first time access is requested**; any subsequent calls to ABAddressBookCreateWithOptions will use the existing permissions. The completion handler is called on an arbitrary queue. If the ABAddressBookRef object is used throughout the app, then all usage must be dispatched to the same queue to use ABAddressBookRef in a thread-safe manner.

Although this is only speaking for the Address Book, I'm sure it applies to Photos, Contacts, etc.

[https://developer.apple.com/library/prerelease/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html#//apple_ref/doc/uid/TP40012166](https://developer.apple.com/library/prerelease/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html#//apple_ref/doc/uid/TP40012166)

# java - 本地方法调用 vs 对象方法调用

> ID：12184204
> 
> 赞同：0
> 
> 时间：2012-08-29T18:23:40.713
> 
> 标签：java, optimization, methods

抱歉，如果这是重复的并且我的 google-fu 很弱。

我的代码中有两个方法路由选项：

使用调用一堆对象属性的本地方法：

```
/* public class Manager */
public void onTouchEvent( Event event )
{
    Vec2 touch = new Vec2( event.getX(), event.getY() );
    for( GameObject o : mGameObjectList )
    {
        if ( isColliding( touch, o ) )
                o.onTouchEvent(event);
    }
}

public boolean isColliding( Vec2 touch, GameObject obj )
{
    if ( ( obj.mPosition[ 0 ] - obj.mScale[ 0 ] ) < touch.x && touch.x < ( obj.mPosition[ 0 ] +  obj.mScale[ 0 ] ) )
    {
        if ( ( obj.mPosition[ 1 ] - obj.mScale[ 1 ] ) < touch.y && touch.y < ( obj.mPosition[ 1 ] +  obj.mScale[ 1 ] ) )
        {
            return true;
        }
    }

    return false;
} 
```

调用一个对象方法，然后使用本地属性：

```
/* public class Manager */
public void onTouchEvent( Event event )
{
    for( GameObject o : mGameObjectList )
    {
        o.isColliding(event);
    }
}

/* public class GameObject */
public boolean isColliding( Event event )
{
    // code here to get touch from event ( or maybe pass in touch? )

    if ( ( mPosition[ 0 ] - mScale[ 0 ] ) < touch.x && touch.x < mPosition[ 0 ] + ( mScale[ 0 ] ) )
    {
        if ( ( mPosition[ 1 ] - mScale[ 1 ] ) < touch.y && touch.y < mPosition[ 1 ] + ( mScale[ 1 ] ) )
        {
            onTouchEvent(event)
        }
    }

    return false;
} 
```

哪组方法在编程上会更好（最佳、优雅、简单等）？

更新：固定代码部分。对不起，这一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:30:35.023

我会用一种`GameObject::containsPoint(x, y)`方法来写这个。这样，它不需要知道触摸事件，但你的触摸类也不需要知道计算交点。

### 编辑：

这就是我的做法。

```
/* class GameObject */
public boolean contains(int x, int y)
{  
    //Your use of parentheses here was really confusing!  
    return mPosition[0] - mScale[0] < x && x < mPosition[0] + mScale[0]
        && mPosition[1] - mScale[1] < y && y < mPosition[1] + mScale[1];

    /* alternatively:
    return Math.abs(x - mPosition[0]) < mScale[0]
        && Math.abs(y - mPosition[1]) < mScale[1];
    */
}

/* class Manager */
public void onTouchEvent( Event event )
{
    for( GameObject o : mGameObjectList )
    {
        if(o.contains(event.getX(), event.getY()))
        {
            o.onTouchEvent(event);
        }
    }
} 
```

我不确定转换到`Vec2`这里是否有效（或一致）。为什么将接触点提升为 a `Vec2`，却`GameObject::mPosition`是一个数组？

# macos - MAMP 加载页面非常缓慢，除非我以管理员身份登录

> ID：12184207
> 
> 赞同：1
> 
> 时间：2012-08-29T18:24:01.170
> 
> 标签：macos, osx-lion, mamp

**我没有**为我的网站使用 .local 地址。页面加载大约需要一分钟！基本无法使用。当我在 Snow Leopard 上运行 MAMP（非专业版）时，我没有遇到这个问题。

我尝试更改 /etc/hosts 文件中的一些语法 [详见下文]。这最初是有效的。但后来我又开始爬行了。我刚刚`/etc/hosts`再次编辑，页面再次快速加载。所以编辑`/etc/hosts`似乎有所作为......

**重要提示：** 每当我手动编辑 /etc/hosts 时，**我必须以管理员身份**（sudo？）登录才能进行更改。在接下来的几分钟里，我的页面非常快。然后我猜我的 sudo 凭证过期了，我回到以蜗牛的速度加载页面。

**问题：**为什么 MAMP 关心我当前是否使用 sudo，我可以做些什么来让我的 MAMP 网站一直快速加载？

（我正在运行：MAMP Pro v 2.0.5 OSX Lion v 10.7.4 Chrome v 21.0.1180.82 FireFox v 14.0.1）

注意：我最初对 /etc/hosts 所做的更改来自...

```
127.0.0.1 devsite1.dev
127.0.0.1 devsite2.dev
127.0.0.1 devsite3.dev 
```

...至...

```
127.0.0.1 devsite1.dev devsite2.dev devsite3.dev 
```

最初我认为它有效，但后来我意识到这些变化并没有起到什么作用。只是我必须输入管理员密码的事实。我可以通过添加/删除一个空行来重现这些结果。

# vb.net - vb.net 比较两个表并找出差异

> ID：12184212
> 
> 赞同：0
> 
> 时间：2012-08-29T18:24:12.857
> 
> 标签：vb.net, datatable, compare

我有两张结构相同的桌子。a.ID*(varchar(10)) *, a.CODE_ASS* (varchar(1))* 和 b.ID*(varchar(10)) *, b.CODE_ASS* (varchar(1))*

表“a”包含 2010 年数据，表“b”包含 2013 年数据。

这两个表中的行数不应相同，但公共 ID 应相同。我需要比较表格并找出差异。

![在此处输入图像描述](../Images/c553a7ec30fd5bd1bf49d65d3b9424fe.png)

正如您在此示例中所见，绿色行是可以的，红色行应该是错误的。ID 2、4 和 5 是错误的，因为存在一些差异。“a”表中的 ID 6 是可以的，即使它已在“b”表中被删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:52:19.297

如果您编写查询以连接 ID 上的数据并仅选择值不同的地方，那么您似乎正在使用 SQL 表。你真的想假设 0 = NULL 吗？

```
SELECT a.ID FROM a INNER JOIN  b ON a.ID = b.ID WHERE a.ID<>b.ID; 
```

如果您想要 0 = NULL，那么您需要将 NULL 更改为 0 - 如下所示。

```
SELECT a.ID FROM a INNER JOIN b ON a.ID = b.ID WHERE ISNULL(a.ID,0)<>ISNULL(b.ID,0); 
```

ISNULL(param, value) 将 NULL 更改为值，在本例中为 0。

我猜你正在使用一个记录集对象，所以你所要做的就是遍历结果。

# wordpress - 在搜索结果页面上显示网站的最新博客文章

> ID：12184214
> 
> 赞同：0
> 
> 时间：2012-08-29T18:24:30.250
> 
> 标签：wordpress

我的主要想法是，当我对我公司的信息进行谷歌搜索时，它会不断显示最新发布的帖子。每次我进行谷歌搜索时，我都想让信息相同。这肯定会展示我公司的良好形象。我正在使用 wordpress 来运行我公司的网站。我需要一些指导......谢谢......如果这是一个愚蠢的问题，请原谅我。如果有其他方法可以做到这一点，而不是使用 wordpress，请告诉我......将很高兴听到一些建议......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T03:25:19.977

这是一个很好的问题，我认为有几种方法可以做到。

想到的第一种方法是在主页上使用您网站的[元描述。](http://en.wikipedia.org/wiki/Meta_element)您的元描述是在搜索结果中您的网站标题下方以黑色字母显示的 156 个字符。

![元描述示例 SERP](../Images/a6a01586cca1e647ae3b1beb255f8bc4.png)

如果您希望元描述是静态且不变的，就像 LinkedIn 一样，您可以使用[Yoast 的 Wordpress SEO 插件在](http://yoast.com/wordpress/seo/)没有任何编码知识的情况下设置元描述。安装后，在 Wordpress Admin 中编辑您的主页并将元描述设置为您想要的文本。您可以为网站上的每个页面设置元描述，每个页面都会在搜索结果中显示相应的描述。

如果您希望您的元描述是最新的帖子，您需要在每次写新帖子时手动更改主页的元描述，或者您可以编写一些代码从前 156 个自动生成元描述您最新博客文章的字符。

但是，还有第二种方法可能效果更好。对于一个示例站点，我在 Google 上搜索了 CSSTricks.com。请注意，Google 似乎会自动拉入他们的最新帖子，而无需对元描述进行任何喧闹。

![没有元描述示例 SERP](../Images/5576de432f712789242b55e130e548cc.png)

因此，我使用 Google Chrome 访问 CSSTricks 并右键单击 -> Inspect Element 以查看网页的源代码，看看他们是如何做到的。（您可能需要在新选项卡中打开下图或将其保存到您的计算机才能阅读代码，因为它太小了）

![带有源代码的页面示例](../Images/e62b3eebb273ae75d1050fa3072e8ee1.png)

他们的网站上没有任何元描述，但他们使用的是[HTML5 文章标签](http://www.w3schools.com/html5/tag_article.asp)。谷歌似乎正在拉入嵌套在文章标签内的第一个 p 标签，然后将其显示为黑色文本来代替元描述。所以理论上，如果这确实是它的工作原理，那么您需要做的是编写主页的标记，以便它使用带有嵌套 p 标签的文章标签显示帖子内容，就像他们所做的那样。

希望这可以帮助！

# javascript - Google Maps Javascript API 地点库

> ID：12184220
> 
> 赞同：2
> 
> 时间：2012-08-29T18:25:05.163
> 
> 标签：javascript, google-maps

为什么 Google Maps Javascript API Places Library 在自动完成功能中为巴西国家/地区返回字符串“Republica Federativa do Brasil”而不是“Brasil”？

这给我的应用程序带来了几个问题。你能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:29:47.057

这看起来像一个语言环境问题。您可以指定要返回的语言环境。见这里： [https ://developers.google.com/maps/documentation/javascript/basics#Localization](https://developers.google.com/maps/documentation/javascript/basics#Localization)

```
&region=GB&language=en 
```

替换为您需要的语言环境代码。在此处查看[语言代码](https://spreadsheets.google.com/pub?key=p9pdwsai2hDMsLkXsoM05KQ&gid=1)

# c# - 如何通过 Windows 应用程序访问我的 Web.Config 文件中的连接字符串

> ID：12184221
> 
> 赞同：0
> 
> 时间：2012-08-29T18:25:08.533
> 
> 标签：c#, entity-framework

我在我的 Web.Config 文件中设置了我的实体连接字符串。在同一个解决方案中，我有一个 Windows 应用程序，我想访问我的实体的连接字符串。如何访问存在于我的 Web.Config 文件中的连接字符串？或者我必须在我的 Windows 应用程序中创建一个特定的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:34:25.787

如果您不熟悉将配置文件添加到 Windows 应用程序，则必须从添加新项目中选择“应用程序配置文件”，它将创建一个名为 App.Config 的文件，该文件将在编译时变为 YourProgramsName.exe.config 但在内部，它的工作方式与带有 appsettings 部分和 connectionstrings 部分以及所有其他正常部分的 web.config 类似。

在 Web 和 Win 配置文件之间共享此数据的最佳方式是：

创建一个单独的文件，如下所示：

```
 <connectionStrings>
    <add name="Name" 
     providerName="System.Data.ProviderName" 
     connectionString="Valid Connection String;" />
  </connectionStrings> 
```

并从两个配置文件中引用它：

```
<?xml version='1.0' encoding='utf-8'?>
<configuration>
    <connectionStrings configSource="connections.config"/>
</configuration> 
```

然后只需将connections.config（**通过链接**添加现有项目）添加到每个项目。

更多阅读：http: [//msdn.microsoft.com/en-us/library/ms254494.aspx](http://msdn.microsoft.com/en-us/library/ms254494.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:27:13.507

将连接字符串放入您的 Windows 应用程序的`App.config`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:29:55.337

使用此代码：

```
string connectionString = ConfigurationManager.ConnectionStrings["myConnectionString"].ConnectionString; 
```

# c# - 不能直接将泛型类型或作为运算符直接转换为具体类型

> ID：12184226
> 
> 赞同：-1
> 
> 时间：2012-08-29T18:25:40.790
> 
> 标签：c#, generics

请在代码中查看我的评论，我怎样才能获得具体的操作类型，为什么直接转换为 MyDto 不起作用？

```
 public class Gen1Layer<TData, TAction> : GenBaseLayer<TData, TAction>
        {

            public Gen1Layer(IGenBaseLayer<TData, TAction> layer) : base(layer) { }

            public override Document<TData, TAction> ProcessDocument(Document<TData, TAction> document)
            {
                // Does not work!
                // MyDto dto = (MyDto) document.Data;

                // Does cast!
                MyDto dto1 = document.Data as MyDto;

                // Does not work!
                MyConsts.ActionType bla =  document.ActionType as MyConsts.ActionType;

                // Does not work!
                MyConsts.ActionType bla = (MyConsts.ActionType)document.ActionType;

            }
        } 
```

Gen1Layer 是这样调用的：

```
IGenBaseLayer<MyDto,MyConsts.ActionType>  layer = new Gen1Layer<MyDto,MyConsts.ActionType>(null);
Document<MyDto,MyConsts.ActionType> doc = new Document<MyDto,MyConsts.ActionType>(new MyDto(),MyConsts.ActionType.Add,new Session());   
doc =  layer.ProcessDocument(doc);

public class Document<TData,TAction>
    {
        public Document(TData data, TAction actionType,Session session)
        {
            Data = data;
            ActionType = actionType;
            Session = session;
        }

        public TData Data { get; set; }
        public TAction ActionType { get; set; }
        public Session Session { get; set; }
    }

public class MyConsts
    {
        public enum ActionType
        { 
            Get,
            Add,
        }
    }

public interface IGenBaseLayer<TData, TAction>
    {
        Document<TData,TAction> ProcessDocument(Document<TData,TAction> document);
    }

public class GenBaseLayer<TData,TAction> : IGenBaseLayer<TData,TAction>
    {
        public GenBaseLayer(IGenBaseLayer<TData,TAction> layer)
        {
            NextLayer = layer;
        }

        public IGenBaseLayer<TData,TAction> NextLayer { get; set; }

        public virtual Document<TData,TAction> ProcessDocument(Document<TData, TAction> document)
        {
            Console.Write("Gen’s");
            return document;
        }
    } 
```

我想要实现的是拥有一个通用的基础层，而派生层是覆盖的 ProcessDocument 方法中的具体类型。我知道这会破坏 IGenBaseLayer 永远不会调用派生层实例的 ProcessDocument 方法的多态性。但这就是我需要的。每个层都可以拥有具有不同封闭通用类型的文档，例如 CustomerDto 或 SupplierDto 以及相关的 CustomerActionType 或 SupplierActionType。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:49:48.157

MyConsts 的 ActionType 属性是枚举类型，而 Document 的 ActionType 属性是 TAction 类型。TAction 看起来像引用类型，而枚举更像是值类型。如果引用类型继承自该类型，则只能将其强制转换为另一种类型。您不能将值类型转换为引用类型。最好的办法是在 Document 类上添加一个 getActionType() 方法，处理任何 TAction，并返回相应的枚举。在此之前，您应该使枚举对 Document 类可用（也许在 MyConsts 类之外定义它？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:20:30.963

虽然你正在做的事情似乎有点粗略

```
MyConsts.ActionType bla = (MyConsts.ActionType)Enum.
    ToObject(typeof(MyConsts.ActionType), System.Convert.ToInt32(document.ActionType)); 
```

将以牺牲类型安全为代价来完成你所追求的。

# actionscript-3 - 如何将存储在外部 swf 文件中的符号 ID 嵌入到我的 swf 应用程序中？

> ID：12184228
> 
> 赞同：1
> 
> 时间：2012-08-29T18:25:40.563
> 
> 标签：actionscript-3, flex4, flash-builder, flash

我的应用程序将在桌面上运行，我正在尝试嵌入一个 swf 文件，以使用其所有符号 ID，我尝试加载它，但是，我收到此错误：

```
SecurityError: Error #2148: SWF file file:///D|/my%20projects/bin/app.swf cannot access local resource file:///D|/my%20projects/bin/graphicsDLL.xml. Only local-with-filesystem and trusted local SWF files may access local resources.
    at flash.net::URLStream/load()
    at flash.net::URLLoader/load() 
```

所以，我尝试像这样嵌入每个符号的 ID：

```
[Embed(source="../../../swc/components.swf", mimeType="gxBattery")]
public var gxBattery:Class; 
```

但是，我收到此错误：

```
D:\my projects\src\com\components\Battery.as(34): col: 9: Error: no transcoder registered for mimeType 'gxBattery' 
```

但是，我确定我有一个带有 ID 的影片剪辑`gxBattery`

问题是，如何克服上述第一个错误中的安全问题？加载 swf 文件将使我的应用程序可以使用所有符号 ID，这正是我所需要的。

另外，如何通过嵌入符号 ID 来使用它们？我可以一次嵌入它们吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T13:42:04.290

你不应该使用`mimeType`but `symbol`：

```
[Embed(source="../../../swc/components.swf", symbol="gxBattery")]
public var gxBattery:Class; 
```

# c++ - 为什么我需要两次使用这个语句 - 矩阵乘法

> ID：12184233
> 
> 赞同：0
> 
> 时间：2012-08-29T18:26:01.490
> 
> 标签：c++, arrays, matrix-multiplication

我正在开发一个程序来查找矩阵乘法。

```
#include <iostream>

using namespace std;

int main()
{
    int a=0,b=0,c=0,d=0,e=0;
    cout<<"Enter the order of the first matrix  A  \n\nNumber of Rows : ";
    cin>>a;
    cout<<"\nNumber of Columns : ";
    cin>>b;
    cout<<endl;
    int matrixA[a][b];
    cout<<"Enter the matrix Elements "<<endl;
    for(int m=0; m<a; m++)
    {

        for(int n=0; n<b; n++)
        {
            cout<<"A ("<< m+1 <<" , "<<n+1<<" ) =";
            cin>>matrixA[m][n];
            //cout<<",";
        }
        cout<<endl;
    }

//////////////////////////  Startup

    cout<<"Enter the order of the Second matrix  A  \n\nNumber of Rows : "<<b;
    c=b;
    cout<<"\nNumber of Columns : ";
    cin>>d;
    cout<<endl;
    int matrixB[c][d];
    cout<<"Enter the matrix Elements "<<endl;
    for(int p=0; p<c; p++)
    {
        for(int q=0; q<d; q++)
        {
            cout<<"B ("<< p+1 <<" , "<<q+1<<" ) =";
            cin>>matrixB[p][q];
            //cout<<",";
        }
        cout<<endl;
    }

    ///////////// initialisting matrixAns
    int matrixAns[a][d];

    for(int p=0; p<a; p++)
    {
        for(int q=0; q<d; q++)
        {
            matrixAns[p][q]=0;    
        }    
    }

////////////////////  finding ans
    for(int r=0; r<a; r++)
    {
        for(int s=0; s<d; s++)
        {
            for(int t=0; t<b; t++)
            {    
                e = matrixA[r][t]*matrixB[t][s];       
            }
            matrixAns[r][s] = e+matrixAns[r][s];
            matrixAns[r][s] = e+matrixAns[r][s];   //dont know why i have to add this same code again
    }
    }

////////////////////// Ans Printing    
    cout<<"\nMatrix Multiplication Answer  \n"<<endl;
    for(int h=0; h<a; h++)
    {    
        for(int i=0; i<d; i++)
        {    
            cout<<" "<<matrixAns[h][i]<<" ";    
        }
        cout<<endl;
    }    
} 
```

还有一件重要的事情：这不是我的家庭作业或作业！

我使用的方法非常有效，但直到我使用此语句两次才给我正确的答案。（我通过试错法得到了这个）。

```
matrixAns[r][s] = e+matrixAns[r][s]; 
```

我还`matrixAns`使用循环初始化了（并将其设置为 0）。

我是 C++ 新手，想知道我遇到的错误是什么，以及这两个语句的使用如何给我正确的答案。

有没有办法在不破坏应用程序的情况下摆脱其中一个语句？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:42:49.807

在计算答案时，您没有正确地做点积。您需要将两个矩阵之间的单个单元格相乘，然后将**所有**这些乘积相加为您的答案中的单个单元格。

您的代码只取*最后一个*乘法`e`的in 乘积- 并丢弃前*N-1 个*乘积。添加- 最后一个乘法 - 一次、两次或 3 次都是不正确的，尽管它可能*看起来*适用于某些输入。*`matrix[r][b - 1] * matrixB[b - 1][s]`*`e`**

 ***您的答案循环，带有评论：

```
for(int r=0; r<a; r++)
{
    for(int s=0; s<d; s++)
    {
        for(int t=0; t<b; t++)
        {
            e = matrixA[r][t]*matrixB[t][s];
        }

        // now e only has the value from that final multiplication, of
        //    matrix[r][b - 1] * matrixB[b - 1][s]. All of the other
        //    products were lost.

        // so now it doesn't matter how many times you add e, you'll
        //    get the wrong product:
        matrixAns[r][s] = e+matrixAns[r][s];
        matrixAns[r][s] = e+matrixAns[r][s];
    }
} 
```

将您的答案循环更改为：

```
for(int r=0; r<a; r++)
{
    for(int s=0; s<d; s++)
    {
        for(int t=0; t<b; t++)
        {
            e = matrixA[r][t]*matrixB[t][s];

            // accumulation of the products should be INSIDE the loop:
            matrixAns[r][s] = matrixAns[r][s] + e;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:35:56.783

您是否打印了 matrixAns[r][s] 以确保它拥有某些东西？

听起来 matrixAns[r][s] 是空的；这就是我认为正在发生的事情：

```
matrixAns[r][s] = e+matrixAns[r][s]; //stores e in matrixAns[r][s]
matrixAns[r][s] = e+matrixAns[r][s]; //adds e to e (whats in matrixAns[r][s]) 
```***

# .net - .NET 4.0：如何将成员引用作为方法参数传递？

> ID：12184235
> 
> 赞同：1
> 
> 时间：2012-08-29T18:26:02.740
> 
> 标签：.net, vb.net, .net-4.0

我正在尝试将成员引用传递给另一个方法的参数。这是一个在第一次引用时初始化的惰性加载器属性（参见`Name`代码示例中的属性）。目标是能够将`Name`属性的引用传递给`GetName()`方法，而无需在`Get`传递时对其访问器进行评估。相反，我想在堆栈中更深入地引用它，以便`Get`在那时触发它的访问器。

在发生 Actions 之后，我越来越接近于弄清楚这一点。在我下面的代码中，我有`GetName(Function() (Name))`将属性引用传递给`GetName()`. 在`GetName()`' 内，我有`Name.Invoke()`. 我知道这是可行的，因为我在 get 访问器中放置的断点在通过该方法时没有被触发。它仅在我调用时调用`.Invoke()`。但是，我需要能够将 Name 属性的值作为它返回的字符串返回，而不是仅仅触发它而不返回任何内容。

此外，虽然这是在 VB 中，但我也精通 c#，但我可能会询问有关 VB.NET 等效语法的问题。

```
Class TestClass

    Private _Name As String
    Private ReadOnly Property Name As String
        Get
            If _Name Is Nothing Then _Name = "Bob"
            Return _Name
        End Get
    End Property

    Sub AccessPropertyValue()

        GetName(Function() (Name))

    End Sub

    Sub GetName(Name As Action)

        Name.Invoke()

    End Sub
End Class 
```

**更新**：感谢 ChaosPandion，我能够做到这一点：

```
Sub AccessPropertyValue()

    Dim s As String = GetName(Function() (Name))

End Sub

Function GetName(Name As Func(Of String)) As String

    Return Name.Invoke()

End Function 
```

我希望这对其他人有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T21:29:04.830

您将要使用`System.Func(Of String)`而不是`System.Action`哪个是 Sub。

# mysql - 尝试从两个不同的 mySQL 表中检查用户凭据

> ID：12184242
> 
> 赞同：0
> 
> 时间：2012-08-29T18:26:28.390
> 
> 标签：mysql

我正在尝试针对 2 个不同的表检查登录凭据，并且查询不断返回说用户不存在。我会试着解释我在做什么......

我有一个名为`customers`只存储客户数据的表。我有另一个名为`admins`仅存储管理员凭据的表。

我希望管理员能够使用与客户相同的登录屏幕登录网站。一旦他们登录，系统就会知道他们是管理员，并显示适当的小部件来管理网站上的产品数据。

我在表中插入了一个虚拟用户`admins`并运行了这个查询：

```
 $sql = mysql_query("SELECT EXISTS(
    SELECT 1 FROM `customers` WHERE `email` = 'johndeere@whatever.com' AND `password` = 'password'
    UNION
    SELECT 1 FROM `admins` WHERE `Email` = 'johndeere@whatever.com' AND `Password` = 'password'
    )");
    $result = @mysql_query($sql);
    if(!$result) {
        echo "User doesn't exist!";
    } else {
        echo "User exists!";
    } 
```

`admins`当我知道他们在表中的事实时，这个查询回来说“用户不存在” 。我确定我错过了一些非常简单的东西，并希望有人可以帮助我解决它是什么。

我对 mySQL 和 PHP 还是很陌生，但我学得很快。到目前为止，这是我无法解决或找到答案的唯一问题。非常感谢您的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:33:47.503

你为什么不使用，

```
SELECT 1 from dual where EXISTS(
    SELECT 1 FROM `customers` WHERE `email` = 'johndeere@whatever.com' AND `password` = 'password'
    UNION
    SELECT 1 FROM `admins` WHERE `Email` = 'johndeere@whatever.com' AND `Password` = 'password'
); 
```

您的查询将返回 0(false)、1(true)，如果您使用原始查询，则需要检查这些值

您不能使用`!$result`它，因为它只告诉天气查询是否合法。您需要检索数据。

参考这个：[http ://www.php.net/manual/en/function.mysql-query.php](http://www.php.net/manual/en/function.mysql-query.php)

# css - 输入标签更大的尺寸和输入标签中的文本垂直居中

> ID：12184243
> 
> 赞同：2
> 
> 时间：2012-08-29T18:26:30.097
> 
> 标签：css, input, textinput

这是我需要做的表格：

![在此处输入图像描述](../Images/ea5da1d317166f17de8b920bc85eac68.png)

现在我处于这一点：

![在此处输入图像描述](../Images/39de00edf5d5a6d8d8e10a384cf95c89.png)

如您所见，我需要创建更大的输入按钮。否则在视觉上它不会起作用。我的问题是如何垂直创建更大的输入按钮，并且输入文本保持垂直居中在框的中间。

CSS解决方案将是最好的。

如果有帮助，这是我的 html 代码：

```
<form name="bookingform" action="form-to-email.php" method="post">
                            <div id="form_box" class="gradient">
                                <div id="center_box">
                                    <h3>WANT TO BOOK ME?</h3>
                                    <div id="form_data">
                                        <br>
                                        <table>
                                            <tr>
                                                <td><input type="text" value="Company name" name="company" /></td>
                                                <td class="tdright"><input type="text" value="Name" name="name" /></td>
                                            </tr>
                                            <tr>
                                                <td><input type="text" value="Telephone" name="telephone" /></td>
                                                <td class="tdright"><input type="text" value="Email" name="email" /></td>
                                            </tr>
                                            <tr>
                                                <td><input type="text" value="Booking date" name="date" /></td>
                                                <td><input type="button" /></td>
                                            </tr>
                                        </table>
                                    </div>  
                                    <div id="form_text">
                                        <br>
                                        <textarea rows="10" cols="40" name="message">Your text...</textarea>
                                        <input type="submit" value="SEND" name="submit" />
                                    </div>
                                    <input type="image" src="" name="Send" />
                                </div>
                            </div>
                        </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:28:30.223

```
input[type=button] {
    height: 35px;      /* increase the height */
    line-height: 35px; /* vertically align the text */
} 
```

[**演示**](http://jsfiddle.net/Q7rxD/)

# drupal - 如何在drupal中添加模块链接到主菜单？

> ID：12184245
> 
> 赞同：1
> 
> 时间：2012-08-29T18:26:32.130
> 
> 标签：drupal

如何在 drupal 7/8 中的主页选项卡旁边添加模块链接到主菜单？这是我的代码

```
 <?php

function api_manager_menu() {

   $items = array();

   $items['api_manager'] = array(
    'title' => 'API Manager',
    'description' => 'Manage the  lifecycle of an API',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('api_manager_form'),
    'access arguments' => user_access('administer users'),
    'type' => MENU_NORMAL_ITEM
   );

   return $items;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:58:47.693

您只需要设置`menu_name`：

```
$items['api_manager'] = array(
  'title' => 'API Manager',
  'description' => 'Manage the  lifecycle of an API',
  'page callback' => 'drupal_get_form',
  'page arguments' => array('api_manager_form'),
  'access arguments' => user_access('administer users'),
  'type' => MENU_NORMAL_ITEM,
  'menu_name' => 'primary-links'
); 
```

有关更多信息，请参阅[hook_menu()](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_menu/7)文档。

# c++ - 重定向后重置 cout

> ID：12184251
> 
> 赞同：3
> 
> 时间：2012-08-29T18:26:59.867
> 
> 标签：c++, outputstream

我有一个 C++ 程序，在我使用的程序中：

```
static ofstream s_outF(file.c_str());
if (!s_outF)
{
    cerr << "ERROR : could not open file " << file << endl;
    exit(EXIT_FAILURE);
}
cout.rdbuf(s_outF.rdbuf()); 
```

意思是我将我的 cout 重定向到一个文件。将 cout 返回标准输出的最简单方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T18:30:14.140

`cout`在更改's streambuf之前保存旧的 streambuf ：

```
auto oldbuf = cout.rdbuf();  //save old streambuf

cout.rdbuf(s_outF.rdbuf());  //modify streambuf

cout << "Hello File";        //goes to the file!

cout.rdbuf(oldbuf);          //restore old streambuf

cout << "Hello Stdout";      //goes to the stdout! 
```

* * *

您可以编写一个`restorer`自动执行此操作：

```
class restorer
{
   std::ostream   & dst;
   std::ostream   & src;
   std::streambuf * oldbuf;

   //disable copy
   restorer(restorer const&);
   restorer& operator=(restorer const&);
  public:   
   restorer(std::ostream &dst,std::ostream &src): dst(dst),src(src)
   { 
      oldbuf = dst.rdbuf();    //save
      dst.rdbuf(src.rdbuf());  //modify
   }
  ~restorer()
   {
      dst.rdbuf(oldbuf);       //restore
   }
}; 
```

现在根据范围使用它：

```
cout << "Hello Stdout";      //goes to the stdout!

if ( condition )
{
   restorer modify(cout, s_out);

   cout << "Hello File";     //goes to the file!
}

cout << "Hello Stdout";      //goes to the stdout! 
```

最后一个`cout`将输出到`stdout`即使`condition`是`true`并且`if`块被执行。

# php - 在动态加载的 PHP 表单上放置一个 JavaScript 事件

> ID：12184253
> 
> 赞同：2
> 
> 时间：2012-08-29T18:27:01.647
> 
> 标签：php, javascript, jquery, ajax

**解决方案：**

感谢 Shmiddty，我发现了这一点：

```
$( static parent element ).on('submit', '#add_client', function(e) {
    e.preventDefault();
    firm.addUser( $(this), '/ci/firm/add_client', 'client' );
}); 
```

**描述：**

我为客户构建了一些表格。我希望根据他单击的链接动态创建此表单。此表单将自动填充一些数据。

这是`jQuery`将创建动态内容的内容：

```
$('.create').on('click', function(e) {
    e.preventDefault();
    utility.create_modal(); // dynamic div with form
}); 
```

这是创建 div 并将`PHP`表单放入的函数`html`：

```
$(document.createElement('div')).attr({
    'class' : 'span3'
}).html( create_div( '/ci/firm/return_user_form/client', 'html' ) ), 
```

这是`ajax`功能：

```
var result = '';
$.ajax({
    url: path, 
    type: 'get', 
     dataType: type,
     async : false,
     success: function(data) {
         result = data;
     } 
    });
return result; 
```

这是从`PHP`文件中提取的 html：（这是一个巨大的表单，我只是要包含有问题的按钮）

```
<input type="submit" name="submit" value="Add Client"  id="add_client"> 
```

**问题：**

这个动态`html`内容中有一个表格。我想在`JavaScript`我包含的表单上放置一个事件。这可能吗？如果是这样，我该怎么做？

这不起作用（`#add_client`是表单中按钮的 id）：

```
$('#add_client').on('click', function(e) {
    e.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:31:33.030

```
$('some_parent_selector').on('click', '#add_client', function(e) {
    e.preventDefault();
}); 
```

侦听器`on`需要一个父对象（不是动态的）来侦听冒泡的点击事件。然后，当事件冒泡到父级时，它会确定它是否来自`'#add_client'`，如果是，它会调用您的匿名函数。

# php - 如何从第三方代码中的“WHMCS 用户会话”中获取信息？

> ID：12184254
> 
> 赞同：0
> 
> 时间：2012-08-29T18:27:02.473
> 
> 标签：php, session, whmcs

我如何检测用户是否登录到 whmcs 并在第三方 PHP 代码中使用它？我注意到有一种方法（[AutoAuth](http://docs.whmcs.com/AutoAuth)）用于登录用户。但我也想知道用户是否已经登录。有什么API或方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:52:01.483

WHMCS 利用标准的 php 会话来检查用户是否登录。会话 ID 通常保存在*PHPSESSID* cookie 中。要知道，WHMCS 允许客户端拥有多个活动会话（fe 来自不同主机、浏览器等的并发登录）

要知道用户是否登录，您必须知道他是否至少有一个活动会话。我对 WHMCS 在会话中保存的数据一无所知。我不知道 WHMCS 是否也加密了这些数据。如果不是，您必须遍历所有会话并确定它是否处于活动状态并属于客户端。通常会话作为序列化数组存储在某个*tmp*文件夹中。实际上，任务可能相当复杂。

可能您想了解有关客户的不同信息，但我对上下文一无所知。

# php - 用于用户身份验证的 PHP 会话

> ID：12184259
> 
> 赞同：1
> 
> 时间：2012-08-29T18:27:13.910
> 
> 标签：php, session, authentication

我将使用 cookie 和会话来识别用户。因此，仅当用户选择“不要记住我”选项时才会使用会话。我在网站每个页面的顶部都包含了识别文件。用户的会话看起来像`$_SESSION['user']`

**而不是我的问题：**

我必须对认证文件进行`session_start()`说明吗？我问它是因为每次我使用此指令时都会创建新会话。

**更新** [http://pastebin.com/Nh3zj6mR](http://pastebin.com/Nh3zj6mR)用户识别脚本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:30:39.787

除非您执行`session_start()`，否则 PHP 的会话机制将**不会**激活。$_SESSION 将出现，您将能够读取/修改它，但它的值不会被持久化 - 例如......当脚本退出时内容将丢失。

如果您在每个使用会话数据的脚本中运行 session_start()，但没有显示会话数据，则可能是配置错误导致会话 cookie 丢失，并且 PHP 每次都在创建一个新会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:33:13.323

是的，您必须将**session_start()放置在每个****php**页面的顶部（在生成任何输出之前，之前必须没有发送任何标题）来告诉 php 接受/启动会话，期望您的**php.ini**已设置，**会话**自动启动.

> > 我问它是因为每次我使用此指令时都会创建新会话。<<

这是一个提示，您的**浏览器**会忽略（禁止）会话 cookie

# php - 使用 CodeIgniter 进行分页

> ID：12184261
> 
> 赞同：0
> 
> 时间：2012-08-29T18:27:21.923
> 
> 标签：php, mysql, codeigniter

嗨，我正在尝试使用代码点火器正确分页，但似乎它不想正常工作。我得到了第二页，但分页消失了，但我仍然得到了正确的表格，但我有 2 个错误：

```
A PHP Error was encountered
Severity: Notice
Message: Undefined offset: 0
Filename: models/evaluation_model.php
Line Number: 37

A PHP Error was encountered
Severity: Notice
Message: Trying to get property of non-object
Filename: models/evaluation_model.php
Line Number: 37 
```

控制器功能：

```
function showEvaluations($offset = 0)
        {
            if($this->login->is_logged_in())
            {
                $limit = 5;
                $result = $this->evaluation_model->getAllEvaluations($limit, $offset);

                if ($this->session->userdata('type') == 'admin')
                {
                    $data['evaluations'] = $result['evaluations'];
                    $data['total'] = $result['num_rows'];
                    $data['notallowed'] = false;
                    $config = array();
                    $config['base_url'] = base_url("evaluation/showEvaluations/");
                    $config['total_rows'] = $data['total'];
                    $config['per_page'] = $limit;
                    $config['uri_segment'] = 3;
                    $this->pagination->initialize($config);
                    $data['pagination'] = $this->pagination->create_links();
                    $this->load->view('allevaluations_view',  $data);
                }
                else
                {
                    $data['notallowed'] = true;
                    $this->load->view('allevaluations_view',  $data);
                }

                //$this->load->view('allevaluations_view',  $data);
            }
            else
            {
                $this->load->view('login_view');
            }
        } 
```

和模型：

```
function getAllEvaluations($limit, $offset)
        {
            $q = $this->db->select('tblPunten.PK_PuntID, tblPunten.Titel, tblPunten.Score, tblVakken.Vak, tblUsers.username, tblUsers.Voornaam, tblUsers.Achternaam')
                          ->from('tblPunten')
                          ->join('tblVakken', 'tblPunten.FK_VakID = tblVakken.PK_VakID')
                          ->join('tblUsers', 'tblPunten.FK_UserID = tblUsers.PK_UserID')
                          ->limit($limit, $offset);

            $query['evaluations'] = $q->get()->result();

            $q = $this->db->select('COUNT(*) as count', FALSE)
                          ->from('tblPunten')
                          ->limit($limit, $offset);
             $tmp = $q->get()->result();
             $query['num_rows'] = $tmp[0]->count;
             return $query;

        } 
```

第 37 行： `$query['num_rows'] = $tmp[0]->count;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:02:49.233

找到了，第二个查询：

```
$q = $this->db->select('COUNT(*) as count', FALSE)
                          ->from('tblPunten')
                          ->limit($limit, $offset); 
```

必须无限制：

```
$q = $this->db->select('COUNT(*) as count', FALSE)
                      ->from('tblPunten') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T05:44:39.280

在 codeigniter 中，`->result()`一个对象。

如果你想要那种形式的数组，那么我们可以使用`->result_array()`这样我们就可以得到数组形式的结果集。

```
$tmp = $q->get()->result_array();//made changes
$query['num_rows'] = $tmp[0]['count'];//will work 
```

# c# - 视觉工作室的奇怪崩溃 2010

> ID：12184263
> 
> 赞同：0
> 
> 时间：2012-08-29T18:27:33.517
> 
> 标签：c#, visual-studio-2010, visual-studio, crash

我不小心破坏了视觉工作室：

我有两个不同的版本：VS express 和 Ultimate。

一个月前我安装了一个插件，并且正在为某个项目工作。现在我为同一个项目工作了将近两个星期，现在表现得很奇怪。

经过一番编写后，我尝试对其进行调试，它已成功构建，但启动后 VS 崩溃了。

这是我尝试过的事情的清单：

1.  安全模式 - 有效
2.  重置为默认值 - 不起作用
3.  重新安装 - 不起作用
4.  试试快递 - 作品

谷歌没有帮助我。我正在编写一个 c# 控制台应用程序，但我不知道问题出在哪里。

如果有人知道问题出在哪里或遇到过类似的事情，请帮助我（：

PS对不起我的英语不好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:30:44.947

如果安全模式有效，那么我会说它可能是插件的错......我会删除插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T04:46:29.700

问题在于成就扩展。当插件试图通过转到其中一行来生成成就时，它会使插件粉碎所有 VS。我了解到插件不会通过删除 VS 工作室来删除。感谢所有试图提供帮助的人（：

# jquery - 如何知道 Struts2 中的 jsp 字段值是否改变？

> ID：12184264
> 
> 赞同：1
> 
> 时间：2012-08-29T18:27:36.830
> 
> 标签：jquery, struts2

我在我们的应用程序中使用struts2，我有两个页面，当我前进/上一个时存储在数据库中。当用户从第一页移动到第二页时，他来到上一页，如果用户点击下一个按钮，我将更新数据库带有值。在这种情况下，是否有任何客户端脚本或任何函数来识别用户是否修改了第一页中的任何字段。在我的页面中，我有文本字段、单选按钮、复选框、日期选择器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:51:29.937

您的问题可以解释为不同的用例，这里有一些解决问题的可能方法。

您可以使用令牌拦截器/令牌标记为每个页面生成唯一令牌。您的操作可以检查此令牌之前是否已提交并采取适当的操作（这将需要在您的应用程序中管理令牌）。

当按下后退按钮时，您可以创建一个 ajax 服务来检查令牌是否已被使用。这样，当按下后退按钮时，ajax 将调用该操作并能够识别它已被使用，然后警告用户。

再往下走客户端路线，您可以使用客户端存储在提交之前保存表单的状态，当按下后退按钮时，客户端存储将被检查并确认页面已提交。使用适当的 JS，您可以识别在先前提交和当前提交之间更改的值并执行您想要的操作。

# c# - 如何将 youtube 视频嵌入 WPF MediaElement 并保存视频？

> ID：12184268
> 
> 赞同：0
> 
> 时间：2012-08-29T18:27:41.477
> 
> 标签：c#, wpf, youtube, embed, mediaelement

有没有办法将 youtube 视频嵌入到 MediaElement 中并保存视频？我知道，一旦您在应用程序中有一个对象，您就可以对其进行某种控制（我认为）。如果我是正确的，是否可以将 youtube 视频嵌入到 MediaElement 中后保存？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T06:52:24.457

Youtube 视频不能作为文件提供，因为它们是流。这使得保存它们有点困难（实际上你可以，JDownloader 会这样做，但这违反了 YT 条款），但要播放，请查看[本指南](http://www.codeproject.com/Articles/27121/Stream-YouTube-Videos-in-WPF)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-14T11:12:07.607

您可以为此使用 webcontrol。设置源属性以使用视频的嵌入链接。它会正常工作。

```
<WebBrowser Source="https://www.youtube-nocookie.com/embed/W152nHe9rkM?rel=0&amp;showinfo=0" /> 
```

# javascript - 如何向 .apply() 方法添加回调？

> ID：12184278
> 
> 赞同：6
> 
> 时间：2012-08-29T18:28:17.720
> 
> 标签：javascript, jquery, callback

在我的代码中，我有一组函数调用。我遍历这些调用并使用 .apply() 来调用它们。问题是，如果新函数的调用需要任何时间，循环将 .apply() 并在前一个函数完成之前调用下一个函数。>.< 这是一个例子：

```
function someFunc(element, calls){
  if(calls.length){
    fn = calls[0];
    calls.shift();
    fn.apply(element, args);
    someFunc(element, calls);
  }
} 
```

因此，如果应用函数上有回调，那么这可以按我的意愿工作。IE

```
function someFunc(element, calls){
  if(calls.length){
    fn = calls[0];
    calls.shift();
    fn.apply(element, args, function(){
      someFunc(element, calls);
    });
  }
} 
```

我还有一个关于在回调函数中调用 someFunc 的问题。`calls`我数组中的函数会影响我的`element`变量。所以我想确保在它被改变之后，它会在回调中传递给 someFunc，这样下一个函数也可以操作它。`this`有时我只是对上下文感到困惑。:)

如果有帮助，我正在使用 jQuery。我知道如何向 jQuery 方法添加回调，但是当我处理本机 JavaScript 代码时，我不知道如何做到这一点。**如何向 .apply() 方法添加回调？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:47:22.290

确保您调用的每个函数都返回一个`promise`. 然后，您可以“等待”该承诺被“解决”，然后再继续执行列表中的下一个函数：

```
function someFunc(element, calls) {
    if (calls.length) {
        var fn = calls.shift();
        fn.apply(element, args).done(function(el) {  // what's args?
            el = el || element;   // default to previous element if necessary
            someFunc(el, calls);
        });
    }
} 
```

每个函数看起来像：

```
function myFunc1(el) {
    var def = $.Deferred();

    // do something async, and "resolve" the deferred object in the async callback
    ...(function() {
        def.resolve(el);  // this "el" will get passed to the next function
    });

    return def.promise();
} 
```

如果异步任务是 AJAX 调用，您可以直接返回`jqXHR`结果，`$.ajax`而不是创建新的延迟对象。

# java - 使用 JUnit 进行单元测试时如何处理异常？

> ID：12184281
> 
> 赞同：3
> 
> 时间：2012-08-29T18:28:31.923
> 
> 标签：java, exception-handling, junit

如果一个方法抛出异常，如何编写测试用例来验证该方法实际上是否抛出了预期的异常？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T18:32:15.140

在最新版本的 JUnit 中，它是这样工作的：

```
import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.ExpectedException;

public class NumberFormatterExceptionsTests {

    @Rule
    public ExpectedException thrown = ExpectedException.none();

    @Test
    public void shouldThrowExceptionWhenDecimalDigitsNumberIsBelowZero() {
        thrown.expect(IllegalArgumentException.class); // you declare specific exception here
        NumberFormatter.formatDoubleUsingStringBuilder(6.9, -1);
    }
} 
```

更多关于 ExpectedExceptions 的信息：

[http://kentbeck.github.com/junit/javadoc/4.10/org/junit/rules/ExpectedException.html](http://kentbeck.github.com/junit/javadoc/4.10/org/junit/rules/ExpectedException.html)

[http://alexruiz.developerblogs.com/?p=1530](http://alexruiz.developerblogs.com/?p=1530)

```
// These tests all pass.
 public static class HasExpectedException {
        @Rule
        public ExpectedException thrown= ExpectedException.none();

        @Test
        public void throwsNothing() {
    // no exception expected, none thrown: passes.
        }

        @Test
        public void throwsNullPointerException() {
                thrown.expect(NullPointerException.class);
                throw new NullPointerException();
        }

        @Test
        public void throwsNullPointerExceptionWithMessage() {
                thrown.expect(NullPointerException.class);
                thrown.expectMessage("happened?");
                thrown.expectMessage(startsWith("What"));
                throw new NullPointerException("What happened?");
        }
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T18:32:47.697

我知道的两个选项。

如果使用junit4

```
@Test(expected = Exception.class) 
```

或者如果使用 junit3

```
try {
    methodThatThrows();
    fail("this method should throw excpetion Exception");
catch (Exception expect){} 
```

这两个都捕获异常。我建议捕获您正在寻找的异常而不是通用异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:30:14.010

您可以尝试捕获所需的异常并执行以下操作`assertTrue(true)`：

```
@Test
testIfThrowsException(){
    try{
        funcThatShouldThrowException(arg1, agr2, agr3);
        assertTrue("Exception wasn't thrown", false);
    }
    catch(DesiredException de){
        assertTrue(true);
    }
} 
```

# mysql - 运行 rails g devise:install 在 os x 10.8 中生成 seg 错误

> ID：12184283
> 
> 赞同：0
> 
> 时间：2012-08-29T18:28:52.953
> 
> 标签：mysql, ruby-on-rails, macos, sqlite, rvm

我使用最新的 rvm，最新的 ruby​​，并且在运行各种处理数据库的事情时，我得到了 mysql2 和 sqlite3 的随机段错误。

```
#Ruby Version
$ ruby -v
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin12.0.0]

#Ruby Location
$ which ruby
/Users/mikedevita/.rvm/rubies/ruby-1.9.3-p194/bin/ruby

#RVM Version
-> rvm -v
rvm 1.15.8 (master) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/] 
```

**我尝试删除我的 gemset，然后重新安装它们，但我仍然遇到与此类似的错误（这是我的最后一个）：**

```
➜ rails g devise:install
/Users/mikedevita/.rvm/gems/ruby-1.9.3-p194@callcenter/gems/sqlite3-1.3.6/lib/sqlite3/sqlite3_native.bundle: [BUG] Segmentation fault
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0] 
```

我刚刚注意到，它从正确的 rvm 位置运行，但它在它下面显示 ruby​​ 1.8.7？

我正在使用 zsh & oh-my-zsh .. 所以这是我的 .zshrc 的一部分，与我的 PATH 设置有关：

```
# Customize to your needs...
PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/local/bin:/opt/local/sbin

# Add RVM to PATH for scripting
[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm"
# Load RVM function
PATH=$PATH:$HOME/.rvm/bin

#MySQL
PATH=$PATH:"/usr/local/Cellar/mysql/5.5.25a/bin" 
```

# 更新 1

现在我收到带有 sqlite3 的更大的 seg 错误消息 [https://gist.github.com/5717423dbc37286761e1](https://gist.github.com/5717423dbc37286761e1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:57:21.027

有两种可能性：

1.  你没有使用红宝石：

    ```
    rvm use 1.9.3@callcenter 
    ```

2.  您使用 clang 构建 ruby​​ - 这会产生`[BUG] Segmentation fault`错误。

使用 gnu 中的 gcc-4.2 重新编译您的 ruby​​（请阅读`rvm requirements`说明）：

```
rvm reinstall 1.9.3
rvm 1.9.3@gloabal,1.9.3,1.9.3@callcenter do rvm gemset pristine 
```

# sql - SQL 设计：查找不在不同表上的行

> ID：12184284
> 
> 赞同：0
> 
> 时间：2012-08-29T18:28:53.387
> 
> 标签：sql

简化情况：我有一个表，我们称它为表头，例如主键 header_ID 和其他一些属性

我将需要用不同的过滤器标记这些行。我无法提前知道有多少，但对于大多数行来说，它将在 0 到 10 之间。

所以，我想创建另一个表（我们称之为过滤器），其属性为 h_ID 和 filter_ID。因此，如果此表具有以下内容，则表示 header_ID=2 使用过滤器 1 和 3 进行标记，而 header_ID=3 使用过滤器 1

2 1 2 3 3 1

然后，另一个带有 filter_ID 的表和一个带有一些描述过滤器的文本的属性。

例如，我看到自己经常做的基本查询是“从没有任何过滤器的标题中获取某些行”。这是使这些类型的查询高效的设计吗？如果是这样，怎么做？

我正在考虑可能在标题中添加一个 filter_ID 列，并用 filter_ID 主键替换 header_ID 列，当没有分配过滤器时，标题中的值为 NULL。这是一个更好的主意吗？

感谢您的意见

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:50:41.980

您可以进行左连接，然后过滤以仅获取左表中具有空值的行。

```
SELECT [cols]
FROM header
LEFT JOIN filters 
ON header_id=h_id
WHERE [filter col] IS NULL 
```

根据您的表的描述，在标题表中有一个过滤器列将是一个非常糟糕的主意。这会导致一些非常低效的查询。

# url - CMS 的 nginx url 重写直接到 /[user]/index.php

> ID：12184285
> 
> 赞同：1
> 
> 时间：2012-08-29T18:29:04.560
> 
> 标签：url, url-rewriting, nginx

我正在尝试迁移到 nginx ......

我有一个使用以下 mod_rewrite 命令在 apache 中运行的应用程序：

```
RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
RewriteRule ^/([a-z\-0-9]+)/(.*)$ /$1/index.php/$2 [E=USERKEY:$1,L] 
```

我们使用的 PHP 支持以下列形式处理项目：

```
/[USERKEY]/index.php/[module]/[action]/[etc...] 
```

我们希望将每个命中（*磁盘上没有静态文件*）传递给**index.php**文件以进行处理，格式如下：

```
http://www.myapp.com/bobsmith/rockstar/add?q=45678 
```

将转化为：

```
/var/www/some_static_path/bobsmith/index.php/rockstar/add?q=45678 
```

我知道一些 CMS 产品做类似的事情，我找到了很多示例，但我们有这个奇怪的 USERKEY 有效负载（*它是 index.php 路径的一部分*）导致我的配置出现问题。此外，我在处理 index.php 之后的斜线 (/) 时遇到了困难。错误日志将显示：

```
"/bobmsith/index.php/login" failed (20: Not a directory) 
```

尝试浏览到：[http ://www.myapp.com/bobsmith/login](http://www.myapp.com/bobsmith/login)

我尝试过使用重写、if(s)、不同类型的位置正则表达式、try_files、fastcgi_split_path_info ......我找不到成功的鸡尾酒！

任何/所有帮助表示赞赏；谢谢大家！

# php - 显示个人资料照片而不是该照片的链接

> ID：12184288
> 
> 赞同：-2
> 
> 时间：2012-08-29T18:29:22.390
> 
> 标签：php, sql

我正在阅读关于二进制数据的书中的一章。我想做的是在我的数据库处理个人资料时自动显示一个人的图片。

到目前为止，我的解决方案有效，照片是最后一块拼图。

本书将带您进入将文件名链接输出到屏幕的阶段，单击此链接会显示图片。

我想要做的是让图片自动显示，例如在 Facebook 上。在那里，您不会看到指向您的个人资料图片的链接，而是看到实际图片本身。

代码如下所示：

INDEX.PHP（控制器）

```
<?php
include_once $_SERVER['DOCUMENT_ROOT'] . '/includes/magicquotes.inc.php';

if (isset($_POST['action']) and $_POST['action'] == 'upload')
{
  // Bail out if the file isn't really an upload
  if (!is_uploaded_file($_FILES['upload']['tmp_name']))
  {
    $error = 'There was no file uploaded!';
    include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php';
    exit();
  }
  $uploadfile = $_FILES['upload']['tmp_name'];
  $uploadname = $_FILES['upload']['name'];
  $uploadtype = $_FILES['upload']['type'];
  $uploaddesc = $_POST['desc'];
  $uploaddata = file_get_contents($uploadfile);

  include 'db.inc.php';

  try
  {
    $sql = 'INSERT INTO filestore SET
        filename = :filename,
        mimetype = :mimetype,
        description = :description,
        filedata = :filedata';
    $s = $pdo->prepare($sql);
    $s->bindValue(':filename', $uploadname);
    $s->bindValue(':mimetype', $uploadtype);
    $s->bindValue(':description', $uploaddesc);
    $s->bindValue(':filedata', $uploaddata);
    $s->execute();
  }
  catch (PDOException $e)
  {
    $error = 'Database error storing file!';
     include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php';
    exit();
  }

  header('Location: .');
  exit();
}

if (isset($_GET['action']) and
    ($_GET['action'] == 'view' or $_GET['action'] == 'download') and
    isset($_GET['id']))
{
  include 'db.inc.php';

  try
  {
    $sql = 'SELECT filename, mimetype, filedata
        FROM filestore
        WHERE id = :id';
    $s = $pdo->prepare($sql);
    $s->bindValue(':id', $_GET['id']);
    $s->execute();
  }
  catch (PDOException $e)
  {
    $error = 'Database error fetching requested file.';
    include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php';
    exit();
  }

  $file = $s->fetch();
  if (!$file)
  {
    $error = 'File with specified ID not found in the database!';
    include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php';
    exit();
  }

  $filename = $file['filename'];
  $mimetype = $file['mimetype'];
  $filedata = $file['filedata'];
  $disposition = 'inline';

  if ($_GET['action'] == 'download')
  {
     $mimetype = 'application/octet-stream';
     $disposition = 'attachment';
  }

  // Content-type must come before Content-disposition
  header('Content-length: ' . strlen($filedata));
  header("Content-type: $mimetype");
  header("Content-disposition: $disposition; filename=$filename");

  echo $filedata;
  exit();
}

if (isset($_POST['action']) and $_POST['action'] == 'delete' and
    isset($_POST['id']))
{
  include 'db.inc.php';

  try
  {
    $sql = 'DELETE FROM filestore
        WHERE id = :id';
    $s = $pdo->prepare($sql);
    $s->bindValue(':id', $_POST['id']);
    $s->execute();
  }
  catch (PDOException $e)
  {
    $error = 'Database error deleting requested file.';
    include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php';
    exit();
  }

  header('Location: .');
  exit();
}

include 'db.inc.php';

try
{
  $result = $pdo->query(
      'SELECT id, filename, mimetype, description
      FROM filestore');
}
catch (PDOException $e)
{
  $error = 'Database error fetching stored files.';
  include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php';
  exit();
}

$files = array();
foreach ($result as $row)
{
  $files[] = array(
      'id' => $row['id'],
       'filename' => $row['filename'],
       'mimetype' => $row['mimetype'],
       'description' => $row['description']);
}

include 'files.html.php'; 
```

PHOTO.HTML（查看）

```
<?php include_once $_SERVER['DOCUMENT_ROOT'] . '/includes/helpers.inc.php'; ?>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>PHP/MySQL File Repository</title>
  </head>
  <body>
    <h1>PHP/MySQL File Repository</h1>

    <form action="" method="post" enctype="multipart/form-data">
      <div>
        <label for="upload">Upload File:
        <input type="file" id="upload" name="upload"></label>
      </div>
      <div>
        <label for="desc">File Description:
        <input type="text" id="desc" name="desc" maxlength="255"></label>
      </div>
      <div>
        <input type="hidden" name="action" value="upload">
        <input type="submit" value="Upload">
      </div>
    </form>

    <?php if (count($files) > 0): ?>

    <p>The following files are stored in the database:</p>

    <table>
      <thead>
        <tr>
          <th>Filename</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <?php foreach($files as $f): ?>
        <tr>
          <td>
            <a href="?action=view&amp;id=<?php htmlout($f['id']); ?>"
                ><?php htmlout($f['filename']); ?></a>
          </td>
          <td><?php htmlout($f['mimetype']); ?></td>
          <td><?php htmlout($f['description']); ?></td>
          <td><?php htmlout($f['filedata']); ?></td>

          <td>
            <form action="" method="get">
              <div>
                <input type="hidden" name="action" value="download"/>
                <input type="hidden" name="id" value="<?php htmlout($f['id']); ?>"/>
                <input type="submit" value="Download"/>
              </div>
            </form>
          </td>
          <td>
            <form action="" method="post">
              <div>
                <input type="hidden" name="action" value="delete"/>
                <input type="hidden" name="id" value="<?php htmlout($f['id']); ?>"/>
                <input type="submit" value="Delete"/>
              </div>
            </form>
          </td>
        </tr>
        <?php endforeach; ?>
      </tbody>
    </table>

    <?php endif; ?>
  </body>
</html> 
```

感谢所有帮助。

当前照片的摘录.HTML

```
<?php foreach($files as $f): ?>
    <tr>
      <td>
        <a href="?action=view&amp;id=<?php htmlout($f['id']); ?>"
            ><?php htmlout($f['filename']); ?></a>

            <!-- attempt to output image not path -->
            <img src="<?php echo htmlout($f['filename']); ?>" />
      </td> 
```

辅助功能

```
<?php

function html($text)
{
    return htmlspecialchars($text, ENT_QUOTES, 'UTF-8');
}

function htmlout($text)
{
    echo html($text);
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:31:28.480

将其包装在`<img>`标签中。这会将其输出为图像。

IE`<img src="<?php echo $image; ?>">`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:32:55.553

在大多数情况下，通过将图像文件保存在通过 HTTP 公开可用的目录结构中的某个位置并将指向该图像位置的链接存储在数据库中，您会得到更好的服务。

因此，例如，当用户上传图像时，您将其放在您的 web 目录中的某个用户图像目录中，然后将图像的路径或 URL 存储在数据库中的 varchar 字段中。

这给您带来的好处是可以减小数据库大小，使您从数据库中查询图片信息的速度更快，改进浏览器对图像的缓存，并允许您将静态文件保存在一个地方（可能再次保存在 CDN 上）在最终用户的浏览器中具有更好的性能）。

# vector - 检查 PETSc 向量/矩阵是否已被破坏的优雅方法？

> ID：12184294
> 
> 赞同：2
> 
> 时间：2012-08-29T18:29:53.687
> 
> 标签：vector, matrix, petsc

对于单元测试，我试图确保 PETSc 向量已被销毁。但是，我似乎找不到合适的命令来优雅地执行此操作。我能做的最好的事情是调用 VecSetType(...) 并查看错误。但是，这个写 PETSC_ERROR 输出，我不想写，特别是因为我期待一个错误。有什么想法或建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-19T20:54:48.990

我不是经验丰富的 PetSc 用户，但我知道 XDestroy 函数将 Vec、Mat 等等同于 NULL。我想您可能会将您的 VEC 与 NULL 进行比较。对我来说，我正在使用终结器类来确保正确清理所有内容。希望有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-06T16:40:27.117

您可以使用 -log_summary 运行代码。剖析信息构成一个表格，其中包含已创建多少向量以及已销毁多少向量。

# jquery - 仅在选择单选按钮时验证

> ID：12184298
> 
> 赞同：0
> 
> 时间：2012-08-29T18:30:09.007
> 
> 标签：jquery, magento, magento-1.4

我正在尝试修改邮政信箱验证脚本以仅在选择“运送到此地址”时对其进行验证。该表单显然使用了[非常简单的表单验证](http://tetlaw.id.au/view/javascript/really-easy-field-validation)。表格部分是：

```
 <input type="radio" name="billing[use_for_shipping]" id="billing:use_for_shipping_yes" value="1" <?php if ($this->isUseBillingAddressForShipping()) {?> checked="checked"<?php }?> title="<?php echo  $this->__('Ship to this address') ?>" onclick="$('shipping:same_as_billing').checked = true;" class="radio" /><label for="billing:use_for_shipping_yes"><?php echo  $this->__('Ship to this address') ?></label></li>
    <li class="control">
        <input type="radio" name="billing[use_for_shipping]" id="billing:use_for_shipping_no" value="0" <?php if (!$this->isUseBillingAddressForShipping()) {?> checked="checked"<?php }?> title="<?php echo $this->__('Ship to different address') ?>" onclick="$('shipping:same_as_billing').checked = false;" class="radio" /><label for="billing:use_for_shipping_no"><?php echo $this->__('Ship to different address') ?></label> 
```

到目前为止，脚本是

```
Validation.add('validate-pobox', 'One or more items purchased cannot be shipped to a PO Box', function (v){
    var pattern =  /\b([P|p](OST|ost)?\.?\s?[O|o|0](ffice|FFICE)?\.?\s)?([B|b][O|o|0][X|x])\s(\d+)/;
    if( document.getElementById("billing:use_for_shipping_yes").checked) // this isn't working
        if (!pattern.test(v)) return true; else return false;
}); 
```

我对 jQuery 不是很熟悉（我正在慢慢学习！），但无论我尝试什么，无论选择哪个按钮，脚本仍然会验证地址字段。我也试过：

```
if( $("billing:use_for_shipping_yes").checked)
if( $("billing:use_for_shipping_yes").is("checked")) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:34:53.137

尝试添加一个冒号来检查。你忘了# 复选框的ID [http://jquery-howto.blogspot.com/2008/12/how-to-check-if-checkbox-is-checked.html](http://jquery-howto.blogspot.com/2008/12/how-to-check-if-checkbox-is-checked.html)

```
if( $("#billing:use_for_shipping_yes").is(":checked")) 
```

根据我可以看到的代码，它应该看起来像这样

```
Validation.add('validate-pobox', 'One or more items purchased cannot be shipped to a PO Box', function (v){
    var pattern =  /\b([P|p](OST|ost)?\.?\s?[O|o|0](ffice|FFICE)?\.?\s)?([B|b][O|o|0][X|x])\s(\d+)/;
    if( $("#billing:use_for_shipping_yes").is(":checked")) {
        if (!pattern.test(v)) {
            return true;
        } else { 
            return false;
        }
    }
}); 
```

# java - 删除邮箱 Java 电子邮件后立即出现异常

> ID：12184302
> 
> 赞同：2
> 
> 时间：2012-08-29T18:30:16.587
> 
> 标签：java, email

调用以下代码后，我编写了代码片段：

```
Message message_in  = null;
inbox instanceof IMAPFolder
IMAPFolder f = (IMAPFolder)inbox;
f.idle();
System.out.println("IDLE done");                                              
message_in = inbox.getMessage(inbox.getMessageCount());
message_in.setFlag(Flags.Flag.DELETED, true);
inbox.expunge(); 
```

我收到错误消息：

```
Got 1 new messages
***********************************************************
------------ Message 1 ------------
DONE
A4 OK IDLE completed.
A5 FETCH 13 (ENVELOPE INTERNALDATE RFC822.SIZE)
IDLE done
* 13 FETCH (ENVELOPE ("Wed, 29 Aug 2012 13:25:15 -0500" "Doc Com: Voice msg from Outside caller 5555555555 Unread:2" (("Support" NIL "support" "example.com")) NIL NIL (("Support" NIL "support" "example.com")) NIL NIL "<94BA85B8-FC4D-4193-B386-7FD2C1DE1B1F@example.com>" "<873439BD-8640-47D9-BF88-5FD3521B8173@example.com>") INTERNALDATE "29-Aug-2012 13:25:17 -0500" RFC822.SIZE 967)
A5 OK FETCH completed.
A6 STORE 13 +FLAGS (\Deleted)
* 13 FETCH (FLAGS (\Deleted \Recent))
A6 OK STORE completed.
A7 EXPUNGE
* 13 EXPUNGE
* 12 EXPUNGE
* 11 EXPUNGE
* 10 EXPUNGE
* 9 EXPUNGE
* 8 EXISTS
A7 OK EXPUNGE completed.
javax.mail.MessageRemovedException
    at com.sun.mail.imap.IMAPMessage.checkExpunged(IMAPMessage.java:205)
    at com.sun.mail.imap.IMAPMessage.loadBODYSTRUCTURE(IMAPMessage.java:1305)
    at com.sun.mail.imap.IMAPMessage.getContentType(IMAPMessage.java:450)
    at javax.mail.internet.MimeBodyPart.isMimeType(MimeBodyPart.java:1050)
    at javax.mail.internet.MimeMessage.isMimeType(MimeMessage.java:986)
    at com.example.vmmonitor.main.VMMonitor.getText(VMMonitor.java:211)
    at com.example.vmmonitor.main.VMMonitor.access$000(VMMonitor.java:27)
    at com.example.vmmonitor.main.VMMonitor$1.messagesAdded(VMMonitor.java:109)
    at javax.mail.event.MessageCountEvent.dispatch(MessageCountEvent.java:150)
    at javax.mail.EventQueue.run(EventQueue.java:134)
    at java.lang.Thread.run(Thread.java:680)
DEBUG IMAP: IMAPProtocol noop 
```

我能够通过添加`Thread.sleep()`如下来修补问题：

问题是什么？为什么我可以将邮件标记为`DELETED`但无法删除邮箱？

```
Message message_in  = null;
inbox instanceof IMAPFolder
IMAPFolder f = (IMAPFolder)inbox;
f.idle();
System.out.println("IDLE done");                                              
message_in = inbox.getMessage(inbox.getMessageCount());
message_in.setFlag(Flags.Flag.DELETED, true);
Thread.sleep(2000);/*****************bug patch***********/
inbox.expunge(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T19:26:05.857

这个多线程程序没有`inbox`以非线程安全的方式访问资源。该程序是在庄园中定义的，`inbox.expunge();`因此附加功能正在相互访问邮箱，因此引发异常。

# pdf - 从乱码PDF中提取文本

> ID：12184304
> 
> 赞同：10
> 
> 时间：2012-08-29T18:30:20.083
> 
> 标签：pdf, file-format, text-analysis

我有一个包含有价值的文本信息的 PDF 文件。

问题是我无法提取文本，我得到的只是一堆乱码。如果我将文本从 PDF 阅读器复制并粘贴到文本文件中，也会发生同样的情况。甚至Acrobat Reader 中的*文件 -> 另存为文本*也会失败。

我已经使用了所有可以使用的工具，结果是一样的。我相信这与字体嵌入有关，但我不知道究竟是什么？

我的问题：

*   **这个奇怪的**文字乱码****的罪魁祸首是什么**？**
***   **如何**从 PDF 中提取文本内容（以编程方式、使用工具、直接操作位等）？*   如何修复PDF在复制时不乱码？**

 *** * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-30T05:07:19.327

某些 PDF 文件是在没有特殊信息的情况下生成的，这些信息对于从中成功提取文本至关重要。甚至通过 Adob​​e 工具。基本上，此类文件不包含字形到​​字符的映射信息。

此类文件将很好地显示和打印（因为字符的形状已正确定义），但无法正确复制/提取其中的文本（因为没有关于使用的字形/形状的含义的信息）。

例如，当使用“最小文件大小”预设时，Distiller 会生成此类文件。

恐怕除了 OCR 之外，没有其他方法可以从此类文件中检索文本。我们最近发布了关于[如何在 .NET 中 OCR PDF](https://bitmiracle.com/blog/ocr-pdf-in-net)的指南。

* * *

## 补充原答案

原始答案提到了*“有关使用的字形/形状含义的信息”*。此信息应包含在称为`/ToUnicode`表格的 PDF 结构中。每个作为子集嵌入并使用非标准 ( `Custom`) 编码的字体都需要这样的表。

为了快速评估文本内容的可提取性，您可以使用`pdffonts`命令行实用程序。这以表格形式打印有关 PDF 使用的每种字体的一系列项目。表的存在`/ToUnicode`由列标题指示`uni`。

一些示例输出：

```
$ kp@mbp:git.PDF101.angea> pdffonts handcoded/textextract/textextract-good.pdf

    name                     type        encoding   emb sub uni object ID
    ------------------------ ----------- ---------- --- --- --- ---------
    BAAAAA+Helvetica         TrueType    WinAnsi    yes yes yes     12  0
    CAAAAA+Helvetica-Bold    TrueType    WinAnsi    yes yes yes     13  0

$ kp@mbp:git.PDF101.angea> pdffonts handcoded/textextract/textextract-bad1.pdf

    name                     type        encoding   emb sub uni object ID
    ------------------------ ----------- ---------- --- --- --- ---------
    BAAAAA+Helvetica         TrueType    WinAnsi    yes yes no      12  0
    CAAAAA+Helvetica-Bold    TrueType    WinAnsi    yes yes no      13  0

$ kp@mbp:git.PDF101.angea> pdffonts handcoded/textextract/textextract-bad2.pdf

    name                     type        encoding   emb sub uni object ID
    ------------------------ ----------- ---------- --- --- --- ---------
    BAAAAA+Helvetica         TrueType    WinAnsi    yes yes yes     12  0
    CAAAAA+Helvetica-Bold    TrueType    WinAnsi    yes yes no      13  0 
```

允许您正确提取两种字体的`good.pdf`文本内容，因为两种字体都有一个`/ToUnicode`附表。

对于`bad1.pdf`和 ，`bad2.pdf`文本提取仅对两种字体中的一种成功，而对另一种失败，因为只有一种字体有`/ToUnicode`表格。

我，[Kurt Pfeifle](https://stackoverflow.com/users/359307/kurt-pfeifle)最近创建了**[一系列手工编码的 PDF 文件](https://github.com/angea/PDF101/tree/master/handcoded/textextract)**，以展示 PDF 源代码中现有的、有缺陷的、被操纵的或缺失`/ToUnicode`的表格的影响。这些 PDF 包含大量注释，适合在文本编辑器的帮助下进行探索。上面`pdffonts`的输出示例是在这些手工编码文件的帮助下创建的。*（还有一些显示不同结果的 PDF，有兴趣的读者可能想探索一下……）*

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-31T17:27:10.293

我向很多人寻求帮助，OCR 是解决这个问题的唯一方法

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-19T09:46:28.430

我有同样的问题。将其上传到 Google Drive，使用 Google Docs 打开并从那里复制文本对我有用。**

# machine-learning - 这些数据集中的哪一个最适合通过支持向量机进行分类？

> ID：12184305
> 
> 赞同：1
> 
> 时间：2012-08-29T18:30:21.207
> 
> 标签：machine-learning, svm

我需要获得地面的 SVM 分类器。我对 SVM 没有太多经验，所以我想知道，只是粗略地看一下这些数据集（[http://archive.ics.uci.edu/ml/datasets.html](http://archive.ics.uci.edu/ml/datasets.html)），是否有一个特别是我应该使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:34:22.590

在这里，您对数据集样本有一个非常好的答案，并且对 SVM 有很好的解释： [Datasets to test Nonlinear SVM](https://stackoverflow.com/questions/5920859/datasets-to-test-nonlinear-svm)

从列表 ( [http://archive.ics.uci.edu/ml/datasets.html](http://archive.ics.uci.edu/ml/datasets.html) ) 我认为您应该尝试使用[虹膜数据集](http://archive.ics.uci.edu/ml/datasets/Iris)进行**多类分类**或使用[皮肤分割数据集](http://archive.ics.uci.edu/ml/datasets/Skin+Segmentation)进行**二元分类**。我认为有足够的连续数据来测试 SVM 是一个好的开始

# python - 如何使用 Homebrew 在我的 Mac 上安装 Python25

> ID：12184308
> 
> 赞同：3
> 
> 时间：2012-08-29T18:30:27.977
> 
> 标签：python, macos, homebrew

我是 Mac 和 Python 的新手。我想在 Mac (OS X 10.8.1) 上安装旧版本的 Python (2.5)。我正在使用自制软件，因为它比 MacPorts 更新，而且我不知道如何在它们之间进行选择。

按照说明我已经安装了 Rails、mySQL、budle、pow - 各种各样的东西，但是当我使用相同的技术安装 python 2.5 时它不起作用。

我试过：

```
Axolotl:.pow neil$ brew search python25
homebrew/versions/python25

Axolotl:.pow neil$ brew install python25
Error: No available formula for python25 
Axolotl:.pow neil$ brew install homebrew/versions/python25
Error: No available formula for python25 
```

我哪里错了？谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-05T04:20:49.520

python25 在 Homebrew-versions 水龙头中可用：

```
$ brew tap homebrew/versions
$ brew install python25 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-01-29T13:53:57.580

我认为`brew tap homebrew/versions`提示不再有效...

我已将其添加到我的 Homebrew 中，但它似乎指向此存储库：[https ://github.com/Homebrew/homebrew-versions](https://github.com/Homebrew/homebrew-versions)

...并且不包含任何 Python 版本。

```
$ brew search python25
No formula found for "python25". 
```

因此，如果您想安装最新的 2.7.x 或 3.xx 以外的特定版本，则需要不同的方法，对我有用的是：

```
brew install pyenv
(complete the install instructions)
pyenv install 2.5 
```

然后，您可以在全局（默认）或仅在当前 shell 会话中切换 Python 版本，请参阅：[https ://github.com/yyuu/pyenv](https://github.com/yyuu/pyenv)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T04:24:25.043

而不是使用 brew 将一个真正旧版本的 Python 安装到整个系统中；考虑改用[pythonbrew](https://github.com/utahta/pythonbrew)。它将隔离 python 安装 - 有点像虚拟环境，但针对 Python 本身。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T18:53:52.247

你没有做错什么，恐怕你只是运气不好。看看可用的公式[列表](https://github.com/mxcl/homebrew/tree/master/Library/Formula)：没有 Python2.5。

可能有一个解决方法：复制`python.rb`gem 并编辑提到版本号的行，从 2.7 切换到 2.5。小心第 31 行（`sha1`签名），您也需要对其进行编辑。

# c# - C#从一个类而不是另一个类访问方法

> ID：12184309
> 
> 赞同：1
> 
> 时间：2012-08-29T18:30:30.390
> 
> 标签：c#, methods, private-members

如果这个问题之前已经解决，请提前道歉。

我正在用 C# 创建一个小库，并希望 A 类能够修改 B 类的数据成员，其中 A 类和 B 类存在于同一个命名空间中，CD 虽然我想要类，但这不是问题要完成E，在命名空间 C 中，不能访问 B 的数据成员。

```
命名空间光盘
{
    B类
    {
        修饰符 int
            一种，
            乙;

        公共 B()
        {
        }
    }

    A级
    {
        公共 A() {}

        公共 B DoStuff()
        {
            B b = 新 B();
            巴 = 1; bb = 2;
            返回 b;
        }
    }
}

命名空间 C
{
    E级
    {
        静态无效主要（字符串 [] 参数）
        {
            A a = 新 A();
            B b = a.DoStuff();
        }
    }
}

```

在我上面的主要方法中，我希望命名空间 CD 中的每个类都能够更改 B 类对象的数据成员，尽管 CD 命名空间之外的任何东西都不能修改 B 类对象的数据成员。

有没有办法通过更改命名空间结构、修饰符或实现特定的设计模式来做到这一点？

谢谢大家。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:34:17.433

如果您愿意将 CD 中的相关类移动到单独的程序集中，则可以使用“内部”访问修饰符。

```
namespace C.D
{
    class B
    {
        internal int a;
        internal int b;

        public B()
        {
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:37:40.497

实现这一目标的一种方法是：

1.  将 A 类的定义移动到 B 类（将其嵌套在 中`class B { ... }`）

2.  制作 B 类的字段 (`a`和`b`) `private`。

IE

```
命名空间光盘
{
    B类
    {
        私人int a，b；

        公共 B()
        {
        }

        A级
        {
            公共 A() { }

            公共 B DoStuff()
            {
                B b = 新 B();
                巴 = 1; bb = 2;
                返回 b;
            }
        }
    }
}

命名空间 C
{
    E级
    {
        静态无效主要（字符串 [] 参数）
        {
            A a = 新 A();
            B b = a.DoStuff();
        }
    }
}

```

实现这一点的另一种方法是制作 B 类的字段`protected`，然后使所有应该有权访问 B 类字段的类都派生自 B 类。这样您就不需要将 A 类嵌套在 B 类中。即

```
命名空间光盘
{
    B类
    {
        受保护的int a，b；

        公共 B()
        {
        }
    }

    A类：B
    {
        公共 A() {}

        公共 B DoStuff()
        {
            B b = 新 B();
            巴 = 1; bb = 2;
            返回 b;
        }
    }
}

命名空间 C
{
    E级
    {
        静态无效主要（字符串 [] 参数）
        {
            A a = 新 A();
            B b = a.DoStuff();
        }
    }
}

```

# ruby-on-rails - 设计相关记录验证

> ID：12184311
> 
> 赞同：0
> 
> 时间：2012-08-29T18:30:37.903
> 
> 标签：ruby-on-rails, ruby-on-rails-3

# 我的背景

我~~是~~/曾经是 PHP 开发人员。已经15年了。Ruby 对我来说是新的（我的新挑战）！

# 当前设置

我正在使用带有用户模型的设计。
Rails：3.2.1
设计：2.1.2

# 用例

当用户注册时（通过设计控制器），我想创建用户记录，但也自动创建一个 Foo 记录。我创建了一个 after_create 来处理 Foo 记录的创建。

```
Class User < ActiveRecord::Base

  after_create :make_foo

  def make_foo
    Foo.create(
      :name => name,
      :user_id => id
    )
  end

end

Class Foo < ActiveRecord::Base

    belongs_to :user

end 
```

# 症状

我有一个问题，当没有创建 Foo 记录（例如验证）时，仍然创建了 User 记录（我不想要那个）。我在 after_create 中添加了一个引发异常，它会回滚用户创建。
但是，我更喜欢一些不错的错误处理而不是抛出异常。现在我得到一个带有该异常的 500 错误页面。我希望表格可以再次显示失败的原因。

```
Class User < ActiveRecord::Base

  after_create :make_foo

  def make_foo
    foo = Foo.create(
      :name => name,
      :user_id => id
    )
    if !foo.valid?
      raise Exception.new('Foo creation failed.')
    end
  end

end 
```

# 请求帮助

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:58:05.017

我最终覆盖了 Devise Resitrations Controller 并在 create 方法中放置了 begin...rescue...end。

```
# routes.rb
devise_for :users, :controllers => { :registrations => "my_devise/registrations" }

# app/controllers/my_devise/registrations_controller.rb
class MyDevise::RegistrationsController < Devise::RegistrationsController
  def create
    begin
      super
    rescue Exception
      self.resource.errors[:base] << "My error message here"
      clean_up_passwords resource
      respond_with resource
    end
  end
 end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:35:34.867

您可以通过在其中设置 flash 消息重定向回同一页面，而不是引发异常

```
 if !foo.valid? 
```

像这样阻止

```
 flash[:error] = 'error msg' 
```

并使用重定向

```
 session[:return_to] = request.referer
 redirect_to session[:return_to] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T21:59:01.783

您可能想查看[Rails3：设计用户 has_one 关系](https://stackoverflow.com/questions/6400363/rails3-devise-user-has-one-relationship)，看看更好的建模是否可以使问题更容易。

您现在对 user.rb 建模的方式确实是 User*可能*在没有 Foo 的情况下存在（但它*必须*属于 User），因此它只是`:make_foo`作为`after_create`回调调用而没有任何其他保证。

# c# - 我应该为 1,565,000.62 使用什么 C# 数据类型？

> ID：12184315
> 
> 赞同：1
> 
> 时间：2012-08-29T18:30:57.917
> 
> 标签：c#, sql-server, entity-framework, excel

我正在开发一个 C# 应用程序，该应用程序导入一个 Excel 文件以供应用程序用户上传。我的应用程序使用实体框架和 SQL Server 2008 数据库。

在我的 SQL Server 数据库中，我创建了一个列来保存这种格式的值：`1,565,000.62`. 我将列定义为因此在我的实体类中为相同的属性创建`decimal`了相应的属性。`decimal`

但是，当我将我的值添加到我的实体类中时，我得到一个无效的强制转换异常。

用于此类值（C# 和 SQL Server）的最佳数据类型是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:46:39.423

您应该使用 a`float`或 a `double`I beleive。

查看这个问题的第二个答案[Difference between decimal, float and double in .NET?](https://stackoverflow.com/questions/618535/what-is-the-difference-between-decimal-float-and-double-in-c) 它谈到了小数如何无法与没有强制转换的双精度或浮点数进行比较。

对于 Sql deciaml，请查看这个问题和答案：[What代表 SQL Server 中的双精度值？](https://stackoverflow.com/questions/1209181/what-represents-a-double-in-sql-server) 当您知道精确时，它谈论十进制，并谈论 c# 中的小数与 C# 小数形成对比。

# c# - Razor 中的变量范围问题

> ID：12184316
> 
> 赞同：3
> 
> 时间：2012-08-29T18:31:09.480
> 
> 标签：c#, razor

我对 razor 还很陌生，为了完成我对底层 c# 代码所做的一些更改，我有点糊涂，我遇到了一个问题。

我需要在底层对象上使用设置属性来获取正确的配置文件以从中提取图像位置。我正在尝试将硬编码的图像更改为可配置的图像。

到目前为止我所拥有的：

```
else
{
@{ 
     var prefix = Model.GetNameSpaceFromSettings();
     var configImgs = ChartColors.GetImgs(prefix);
}
<div style='float:left;'>
<img src='@Url.Content(Model.ComparisonChart(300, 250, false))' border='0' alt=''/>   
<p></p> 
<table width='295' cellpadding='2' cellspacing='1' border='0' class='summarygridtablebackground' align="left">                       
<tr class='summarygridbackground'>
<td>
<div style="float:left; width:125px;"><img src='@configImgs.MyImg' border='0'></div>//This is where I'm working
</td>
</tr>
//a few more rows where I'm trying to eventually do the same thing
</table>
</div>
} 
```

这不起作用，消息“当前上下文中不存在名称'configImgs'”。

我在另一个问题中读到，范围问题的常见解决方案是将变量放入 @functions 部分，所以我尝试了，它最终看起来像这样：

```
else
{
@functions{ 
      string prefix = Model.GetNameSpaceFromSettings();
      Images configImgs = ChartColors.GetImgs(prefix);
} 
```

这个失败并显示一条消息对，“非静态字段、方法或属性'System.Web.Mvx.WebViewPage.Model.get 需要一个对象”（我也尝试用'this'引用它，并且它说 'this' 在当前上下文中不可用）和“字段初始化程序无法引用非静态字段、方法或属性 'ASP.Myfile.prefix'”

我真的可以在这里使用一些帮助，谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T19:39:10.653

尝试在第一个 @{} 块内声明变量。然后，您将能够在视图中的任何位置使用该变量。

# objective-c - UIView中的圆柱形外观渐变

> ID：12184317
> 
> 赞同：0
> 
> 时间：2012-08-29T18:31:12.900
> 
> 标签：objective-c, ios, uiview, core-graphics

我想绘制具有圆柱形外观和阴影效果的条（如下图所示）。有人可以帮助为以下外观定义线性渐变。

![圆柱条形图](../Images/4cfcae000015d5de11dd03f5deeb7bed.png)

代码：

```
-(void)drawRect:(CGRect)rect {
    //UIview Back color is red or green
    CGGradientRef   glossGradient;
    CGColorSpaceRef rgbColorspace;
    CGContextRef    currentContext  = UIGraphicsGetCurrentContext();
    size_t          num_locations   = 4;
    CGFloat locations[4]            = { 0.0,0.7,0.9,1.0 };

    CGFloat components[16]          = { 0.0, 0.0, 0.0, 0.01,
                                        0.0, 0.0, 0.0, 0.1,
                                        0.0, 0.0, 0.0, 0.2,
                                        0.0, 0.0, 0.0, 0.5 
                                      };

    rgbColorspace        = CGColorSpaceCreateDeviceRGB();
    glossGradient        = CGGradientCreateWithColorComponents(rgbColorspace, components, locations, num_locations);

    CGRect currentBounds = self.bounds;
    CGPoint topCenter    = CGPointMake(CGRectGetMidX(currentBounds), 0.0f);
    CGPoint midCenter    = CGPointMake(CGRectGetMidX(currentBounds), currentBounds.size.height);

    CGContextDrawLinearGradient(currentContext, glossGradient, topCenter, midCenter, 0);
    CGGradientRelease(glossGradient);
    CGColorSpaceRelease(rgbColorspace); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:19:00.363

这是一个通用的渐变生成器：

```
 CGGradientRef makeGradient2(NSArray *colors, CGFloat *stops)
    {
        size_t nc = 4;
        NSInteger colorSize = nc * sizeof(CGFloat);
        CGFloat *theComponents = malloc( [colors count] * colorSize );
        CGFloat *compPtr = theComponents;

        for (int i=0; i < colors.count; i++){
            UIColor *color = [colors objectAtIndex:i];
            CGColorRef cgColor = [color CGColor];
            const CGFloat *components = CGColorGetComponents(cgColor);

            memmove(compPtr, components, colorSize);
            compPtr += nc;
        }
        CGColorSpaceRef cs = CGColorSpaceCreateDeviceRGB();
        CGGradientRef gradient = CGGradientCreateWithColorComponents (cs, theComponents, stops, colors.count);
        CGColorSpaceRelease(cs);
        free(theComponents);

        return gradient;
    } 
```

称之为（这会创建一个中间最亮的三部分灰色渐变）

```
 CGFloat stops[] = { 0.0, 0.5, 1.0};
    gradient = makeGradient2([NSArray arrayWithObjects:
                               [UIColor colorWithRed:.2 green:.2 blue:.2 alpha:1.0],
                               [UIColor colorWithRed:.5 green:.5 blue:.5 alpha:1.0],
                               [UIColor colorWithRed:.2 green:.2 blue:.2 alpha:1.0],
                               nil], stops); 
```

然后你可以用它来绘制（对于从左到右的渐变）：

```
 CGContextDrawLinearGradient(gc, gradient, CGPointMake(0.0, 0.0), CGPointMake(rect.size.width, 0.0), 0); 
```

# javascript - 如何在网站上显示天气雷达图？

> ID：12184321
> 
> 赞同：3
> 
> 时间：2012-08-29T18:31:33.407
> 
> 标签：javascript, html, wordpress, plugins, content-management-system

我正在专门寻找天气雷达地图，类似于在 Wordpress 网站上显示的地图：[http ://www.vantilburgfarms.com/weather_local_radar.htm](http://www.vantilburgfarms.com/weather_local_radar.htm)

上面的雷达动画并放大了美国俄亥俄州的印第安纳州，这正是我所需要的。**我不想从网站上窃取这张地图。**

我用谷歌搜索了这个，我唯一能找到的是 5 天的预测。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T15:10:26.710

NWS 创建的动画使用名为 FLAnis 的 flash 程序，您可以在此处找到更多信息：[http](http://www.ssec.wisc.edu/flanis/) ://www.ssec.wisc.edu/flanis/它非常易于使用和配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T19:01:02.383

查看他们的页面源，它​​的设置如下：

```
<a href="http://www.tephigram.weather.net/cgi-bin/razradar.cgi?zipcode=45822&amp;width=720&amp;height=486" target="main">
    <img border="0" dynsrc="http://www.tephigram.weather.net/cgi-bin/razradar.cgi?zipcode=45822&width=720&height=486" start="fileopen" src="http://www.tephigram.weather.net/cgi-bin/razradar.cgi?zipcode=45822&width=720&height=486">
</a> 
```

该网站的来源：

[http://www.tephigram.weather.net/cgi-bin/razradar.cgi?zipcode=45822&width=720&height=486](http://www.tephigram.weather.net/cgi-bin/razradar.cgi?zipcode=45822&width=720&height=486)

通过`dynsrc`：

[http://www.htmlcodetutorial.com/images/_IMG_DYNSRC.html](http://www.htmlcodetutorial.com/images/_IMG_DYNSRC.html) [http://www.citycat.ru/doc/HTML/IExplorer.30/mmedia.htm](http://www.citycat.ru/doc/HTML/IExplorer.30/mmedia.htm)

基本上，他们将常规 old`<img>`的来源设置为外部视频剪辑。

具有讽刺意味的是，看起来他们正在窃取它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T22:03:22.057

查看国家气象局雷达： [http ://radar.weather.gov/radar.php?rid=LOT&product=N0R&overlay=11101111&loop=yes](http://radar.weather.gov/radar.php?rid=LOT&product=N0R&overlay=11101111&loop=yes)

如果您启动 Fiddler 之类的东西，您可以看到用于制作“循环”的单个图像的请求。过去，我创建了一些将这些帧裁剪到特定区域，然后放入动画 GIF 的东西。这对于通常在 PHP 中可用的 ImageMagick 或 GD 来说是微不足道的。如果你对 DIV 溢出很狡猾，你也可以用 JavaScript 来做到这一点。

至于许可，我相信您可以在没有许可的情况下使用它，但您应该咨询确定的律师。我不是一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-30T21:00:39.157

好吧，我不完全确定如何不“窃取”它。`<div><img src="http:///images.intellicast.com/WxImages/RadarLoop/day_None_anim.gif" height="496" width="768"></div>`会工作，但正在从 WUNDERGROUND INTELLICAST 窃取。

# java - 如何在可调整大小的 JTable 的单列中水平滚动？

> ID：12184322
> 
> 赞同：2
> 
> 时间：2012-08-29T18:31:46.433
> 
> 标签：java, swing, scroll, jtable, horizontal-scrolling

我正在制作一个对话框以选择多个文件路径。我的对话框由两个面板组成。一个用于“添加”和“删除”等按钮，第二个面板包含一个包裹在滚动窗格中的 JTable。该表只有一列。表格的单元格不可直接编辑。当用户使用 JFileChooser 选择文件时，该文件的完整路径将添加到表中。尽管我的对话框是可调整大小的，但在文件路径长于用户屏幕宽度的情况下，我仍然需要水平滚动行为。

我研究了可调整大小的表格和水平滚动条的组合。那是相似的，但不是我的问题。典型的滚动行为是滚动列，而不是列的内容。我需要单列的内容水平滚动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T06:31:09.483

滚动多列还是仅滚动一列都没有关系：基本问题是让水平滚动条开始:-)

有两个螺丝需要调整： - 通过设置表格的 resizeMode 启用水平滚动：默认是始终使表格的大小适合 scrollPane 的大小，即不滚动 - 调整列宽以适合其内容

在映射成伪代码的核心 JTable 中

```
table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
// on receiving a TableModelEvent which might increase the column width
// calculate new width by measuring pref of the renderer
int newWidth = ... 
// set it as pref of the column 
table.getColumnModel().getColumn(0).setPreferredWidth(newWidth); 
```

问题是，如果没有 resizeMode，您始终负责调整列的大小：它的宽度小于 scrollPane，它的尾部有一个空白区域。

JXTable（[SwingX 项目](http://swingx.java.net)的一部分），支持添加大小模式，只要表格的 prefWidts 小于父宽度，就会填充可用的水平空间，并在需要时显示水平滚动条

```
table.setHorizontalScrollEnabled(true);
// on receiving a TableModelEvent which might increase the column width
// tell the table to re-evaluate 
table.packColumn(0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T14:35:54.630

我选择 kleopatra 的答案是正确的，因为它解决了我关于表格操作的具体问题。我添加这个答案是因为我最终以不同的方式解决了我的根本问题。

我选择使用[JList](http://docs.oracle.com/javase/6/docs/api/javax/swing/JList.html)来表示我的文件路径而不是单个列表。我想要使​​用 JTable 的唯一真正原因是因为表格的行列的外观，而且因为我不熟悉 JList。我发现了如何通过扩展[DefaultListCellRenderer](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/DefaultListCellRenderer.html)来编辑 JList 的外观。因为我现在知道如何编辑外观，所以 JList 的自然调整大小和滚动行为使它更自然地满足我的需要。

# grails - 在 grails 中获取域上的特定实例

> ID：12184323
> 
> 赞同：0
> 
> 时间：2012-08-29T18:31:59.910
> 
> 标签：grails

我有一个 gsp 文件，它调用这样的方法：

```
<g:link id="${child.id}" action="callChildProfile" controller="profile">${child.firstname}</g:link> 
```

调用此方法

```
 def callChildProfile(Long id){

           childInstance = Child.get(id)
           System.out.println(childInstance.firstname + "  child instance")
           redirect(action:  "index")

   } 
```

此方法将一个子实例设置为一个称为子实例的公共变量，但是当重定向发生时，该变量会被重置。我重定向的原因是因为我想从这个控制器加载索引页面。

索引如下所示：

```
 def index() {
        def messages = currentUserTimeline()
        [profileMessages: messages]
         System.out.println(childInstance + " child here")
        [childInstance : childInstance]
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T21:28:36.073

默认情况下，控制器是原型范围的，这意味着 used 的实例在调用的请求和`ProfileController`调用的请求之间是不同的。因此，对象级变量在请求之间将不可用。`callChildProfile``index``childInstance`

要`Child`在调用中使用实例，`index`请查看[链](http://grails.org/doc/latest/ref/Controllers/chain.html)方法：

```
callChildProfile(Long id){
    // do usual stuff
    chain(action:"index", model:[childInstance:childInstance])
}

def index() {
    // do other stuff
    [otherModelVar:"Some string"]
} 
```

当`Map`从`index`模型返回时，链调用将自动添加，因此您的`childInstance`from`callChildProfile`将可用于 gsp。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:40:33.310

控制器方法（动作）中的变量具有本地范围，因此只能在该方法中使用。您应该从新实例传递 id 并使用该 id 来检索对象。

```
redirect action: "index", id: childInstance.id 
```

和索引可能是

```
def index(Long id){
    childInstance = Child.get(id) 
```

然后可以断定不需要callChildProfile方法

或者你可以使用参数

```
def index(){
    childInstance = Child.get(params.id)
    if(childInstance){
        doSomething()
    }
    else{
        createOrGetOrDoSomethingElse()
    }
} 
```

# javascript - jQuery.data('itemname') 不工作，但 jQuery.attr('data-itemname') 工作

> ID：12184324
> 
> 赞同：2
> 
> 时间：2012-08-29T18:31:59.837
> 
> 标签：javascript, jquery

这是一种奇怪的行为，但是当我尝试使用 jQuery data() 函数访问某些数据属性时，它返回给我 undefined 但 attr() 返回给我实际值。我知道数据的工作方式不同，因为它第一次缓存然后从缓存中检索。我正在使用 jQuery 1.4.2，然后尝试使用 jQuery 1.7.1 进行查找，它确实有效。但我目前无法升级到 1.7.1。有什么想法吗？？

我将不胜感激提供的任何建议或帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:33:18.300

直到 jQuery 1.4.3 才完成`data-*`被拉入的HTML5对象：http: [//api.jquery.com/data/#data-html5](http://api.jquery.com/data/#data-html5)`.data`

也许您可以更新到 1.4.3？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:40:32.023

你回答了你自己的问题：`data`在 jQuery 1.4.2 中不起作用。如果你不能升级，你试试[这个插件](http://binarykitten.com/js/288-html5-data-attributes-and-jquerys-data-pairing-made-in-heaven.html)。

# c# - 如何使用 linq 以升序或降序对 SortedList 进行分页

> ID：12184325
> 
> 赞同：0
> 
> 时间：2012-08-29T18:32:00.540
> 
> 标签：c#, linq, pagination

这就是我想要的：

```
if (order == SortOrder.Ascending) {
    return list.Values.Skip(pageIndex * numberPerPage).Take(numberPerPage);
} else if (order == SortOrder.Descending) {
    return list.Values.Reverse().Skip(pageIndex * numberPerPage).Take(numberPerPage);
} 
```

但是，我不想每次调用它时都必须反转列表，我可以编写一个向后遍历列表的 for 循环并自己实现分页，但我正在寻找一种简单的方法来完成这件事 linq .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:38:42.120

几个想法。

1.  当他们更改排序顺序时，仅反转列表一次。然后正常调用分页：

    ```
    SortOrder oldOrder = SortOrder.Ascending;

    void SetSortOrder(SortOrder newOrder)
    {
        if(oldOrder != newOrder)
        {
            list.Values = list.Values.Reverse().ToList();
            oldOrder = newOrder;
        }
    }

    IEnumerable<Stuff> GetPage(int pageIndex, int numberPerPage, SortOrder order)
    {
        SetSortOrder(order);
        return list.Values.Skip(pageIndex * numberPerPage).Take(numberPerPage);
    } 
    ```

2.  在内存中保留升序*和降序列表：*

    ```
    List<Stuff> ascendingList, descendingList;

    void SetLists()
    {
        ascendingList = list.Values;
        descendingList = list.Values.Reverse().ToList();
    }

    IEnumerable<Stuff> GetPage(int pageIndex, int numberPerPage, SortOrder order)
    {
        return (order == SortOrder.Ascending ? ascendingList : descendingList).Skip(pageIndex * numberPerPage).Take(numberPerPage);
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:45:30.523

除了存储“排序”列表（调用`Reverse`实际上只是创建一个向后迭代器，它不会重新排序）。`Skip`如果您不想使用，则不必使用。

例如，如果您总是显示第 1 页，然后是第 2 页，然后是第 3 页，您可以简单地`Take`单独使用：

```
// done when user clicks something to change `order`
orderedEnumerator = order == SortOrder.Ascending ? list : list.Reverse();
//...
foreach(var e in orderedEnumerator.Take(pageSize)
{
// show first page
}
foreach(var e in orderedEnumerator.Take(pageSize)
{
// show second page
}
foreach(var e in orderedEnumerator.Take(pageSize)
{
// show third page
} 
```

实际`foreach`代码可能是在不同时间执行的相同代码块，例如：

```
IEnumerable<MyType> GetCurrentPage()
{
    return orderedEnumerator.Take(pageSize);
}

public void nextPageButton_Click(object sender, EventArgs e)
{
   foreach(var e in GetCurrentPage())
   {
      // elements in current page
   }
} 
```

# javascript - 即时更改javascript函数

> ID：12184326
> 
> 赞同：2
> 
> 时间：2012-08-29T18:32:03.090
> 
> 标签：javascript, javascript-events

好吧，这应该是一个简单的问题，但现在已经让我头疼了两天。我有以下内容：

```
<a href="javascript:void();" onclick="return manage(id, value)">Add or remove</a> 
```

管理功能如下

```
function manage(id, param){
    var my_value; 
alert(my_value); // this keeps giving me undefined. I want it to hold the last value of the param

    if(param!=0){ // value not empty, we are removing       
        my_value = remValue(id, param);
    }   
    else if(param==''){ // value is empty, so we are adding 
        my_value = addValue(id, param);
    }   
    alert(my_value);    
}

function addValue(id, param){
    param += 1; 
    return param;

}

function remValue(id, param){
    param -= 1; 
    return param;

} 
```

整个想法是在添加或删除操作之后将 param 的值分配给 my_value 。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:33:24.013

通过在函数`var my_value;` *内部*定义，您在每次函数调用时将变量重新声明为未定义的值。它仅对该调用是本地的，并且不会持续存在。

如果您需要它来保留该值，您只需`var`在更高的范围内声明它：

```
// Declare outside the function...
var my_value;
function manage(id, param){
    alert(my_value); // Should be undefined on first call, 
                     // or hold previous value on subsequent calls after assignment

    if(param!=0){ // value not empty, we are removing       
        my_value = remValue(id, param);
    }   
    else if(param==''){ // value is empty, so we are adding 
        my_value = addValue(id, param);
    }   
    alert(my_value);    
} 
```

# django - 将reportlab图表插入django模板

> ID：12184329
> 
> 赞同：1
> 
> 时间：2012-08-29T18:32:07.990
> 
> 标签：django, templates, charts, reportlab

我想在 django 模板中呈现 reportlab 条形图。

此[django 文档](https://code.djangoproject.com/wiki/Charts)为在 django 视图中实现 reportlab-chart 生成提供了极好的说明，此[stackoverflow 帖子](https://stackoverflow.com/questions/9847533/django-reportlab-using-drawing-object-to-create-pdf-and-return-via-httpresponse)建议将图表对象直接放在 HttpReponse 中：

```
binaryStuff = chart.asString('gif')
return HttpResponse(binaryStuff, 'image/gif') 
```

如何将 binaryStuff 插入 django 模板？例如：

```
#views.py
def barChart(request, word_id):
    from charts import BarChartDrawing

    word = get_object_or_404(Word, pk=word_id)
    e = word.choice_set.get(perspective='East')
    w = word.choice_set.get(perspective='West')
    b = word.choice_set.get(perspective='Both')
    data_string = `e.votes` + `w.votes` + `b.votes`

    chart = BarChartDrawing(data =[e.votes, w.votes, b.votes], title=word.word_text)
    binaryStuff = chart.asString('gif')

    return render_to_response('templates/myapp/barChart.html', {'word': word)

#urls.py
url(r'^(?P<pk>\d+)/barchart/$', DetailView.as_view(model=Word,
    template_name='templates/myapp/barChart.html'), name='barChart')

#barchart.html
{% extends "templates/myapp/base.html" %}

{% block title %}{{ block.super}}: {{ word.word_text }}{% endblock title %}

{% block content %}

  <div><img src="{{ binaryStuff }}" /></div>
  <a href="{% url templates_home %}">Return to Home</a>.

{% endblock content %} 
```

我是 django 的新用户 2 周 - 如果我未能找到现存的文档，我深表歉意，如果指向正确的位置，我将 RTM。非常感谢！

----对问题的回应------- 当我添加一个 print binaryStuff 这就是我得到的：

```
����JFIF��C     
2!!22222222222222222222222222222222222222222222222222����"��    
���}!1AQa"q2���#B��R��$3br� 
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������    
���w!1AQaq"2�B����  #3R�br�
$4�%�&amp;'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������?��(��
(��
(��
(��
(��
(��
(��
(��
(��
(��
(��
(��
(��-r���K��"X��E���b�7<d�ǭh�U�Q�Gtk�pȥ�L��I��ө�eJ�DC��J�So\��w�[��[�FX�n�+#B$fS�1@��8��'/�bA�q�בǽOEPEPEPEPEPEPEPEPEPEP\����qx�[hcFDEoHW-"��H�PT3�V=q]e&s�}hL��o��4�V+-�e1�j_ߴ��������+�j�A@y���N�i�o��<k���
�y�����ms�_3�ƯG-�ӯQƢ��>"���v��E�@�/���Z�"��f��}�\e�ea��g'�jw;?�Z�"��f��}�G�-o�3K���2�?�������N�g�[�_����(����/�i�ܕ�QG�V�Y�����kx����_��%�E�@�/���(����/���5;���-o�3K���/�I�5_i�]�a7�&lt;e�w,��߿��Ƽ���%ÿ��/��M\�N���]˥��)���QE|��Q@Q@Q@r�w���(s�6���$������r+���&lt;�޶��[4k,ЫFX���g���ڥ�p{���{�}�Kȭ��;��E�UL��@�1�8�I�]}��#(�Z������[�lJ�Yv��
g$��m���kB��(��H�U�U��cc�&gt;Y�m����]]QEQEQE���f�A����E,�|��H\�*G��xݟ¹o�L<Q�&gt;�?��-l�E��@�����E\�xٞ2�qTݮ�S*�i�_��������R��  ��?��G����W���o��$_��������R��  ��?��G����Q��o����Ϯ��}KG�&amp;(��]��QG��+��E��L<Q�&gt;�?��-�x��}t��Z�Eڸ���{I��0�G�����Ե���덨ŨAm���nX�P����V�������w��E
�2�uj��*=-ظM���QE��V.���kPYKnD2BҴ�$�hc�0���
N���4��?��Z�+��5{M[��Ih.6�����d����A?�u�W�_�����f�э_J��_�����f�э^�M�iz~�&amp;/�^��E�QEQEQE����(�����jȭ��@���|����W&?��~��kC���(��8���(��(��(��(��(��(��(��(��(�S�/������*����"����/�*��z�������]�QE�Q@Q@Q@m�?����x�P�J���� �����^�M����kK�;�(����*��-�\�&lt;�����v�F�Ì��8��tP?�5��_�V�
�����+�j�A@|��-���o����|��-���o���d�Ɨ��rb��-Q_Hy�EPEPEPZ���������I��������̿�M5rc�ݧ��F�?��}��+�X(��(��(��(��(��(��(��(��(���&gt;"�Ƞ����J��^�����(����Ҩ�������G�U�Q^)�QEQEQEV�������w��E
¡��'�   fD��Ą����jj浏�jZ����6i1�#��"F`�2Ձ��#9��K�5��_�V�
�t�"�I��������&9�{bG�]u�W������cWҵ�W������cW��^��ɋ���QE}!�Q@Q@Q@k�?�J���_�&amp;��+_���P<;�_2��4�ɏ�v�����"=��(��=`��(��|Q,�xGZ�'h�K  �
�A�k��mXƤ�:�H��7�XW�F�����Y�V�\�&amp;�-��_DϪ试��u_���7�G����A�W���⫟�B�fz��7�����&gt;���V����3���|��Uں��u_������B�f�7�����&gt;���V����3���|��Uں��u_������B�f�7�����&gt;���V����3���|��Uں��u_������B�f�7�����&gt;���V����3���|��Uw�5�]�s�^�E�ϲ{���d'�ZR�B��Rg&;�18*�IE�m�}t�{eQ]gυQ@��_����TU��Q��E�_�_�Ur����!��3
����+�2
(��
(��
(��
���� �����X�����?�A�]���B�\����?�֗�wQE}A�QE���C��W�ծ�����
�ڵ�P_5�k����F5}+_5�k����F5{7���z�EW�xQEQEQEV����xw��e��i�"���%ÿ��/��M\���i����#�h�����
(��1�[�"f��`����_�S��_Ox��D�w����-���ԧ���h�Ϸ�ϊ���+�&gt;�(��(��(��+��7�#���_�F�\w���x���k�����dx<K�"ʟ/��EW�~XQEr��P?��e��QW/]G�_����TU���gć���*(��(��(��(��+o����������bV�������w��E
�ro����CZ_�QE��\�=�x�O]>�&lt;�d�XM�ڹ��7�?�p�8 ���03���rZg���'�j��_��]�Ǜ�uu����C��W�ծ��
��[\�����1��Z��[\�����1��ɿ�/O�����Z(����(��(��(����%ÿ��/��MY����(�����j����O��h�EW��QE����5���趯�b�R���{ſ�&amp;k�����m_0���?��f;G�}�|U����}Q^a�AEPEPEP]����.����6:�+��7�#���_�F�]X/�#��_�T�~h�J(�������(���"����/�*��z�&gt;"�Ƞ����J��^�s;�$=�aWtQEx�AEPEPEP[�������+������?�?�(W���?G����(��7
(��KW��/�섖2�W�7f�
V����p��]r:f�i�x�I-�����}����'
��[\�����1��Z��[\�����1��ɿ�/O�����Z(����(��(��(����%ÿ��/��MY����(�����j����O��h�EW��QE����5���趯�b�R���{ſ�&amp;k�����m_0���?��f;G�}�|U����}Q^a�AEPEPEP]����.����6:�+��7�#���_�F�]X/�#��_�T�~h�J(�������(���"����/�*��z�&gt;"�Ƞ����J��^�s;�$=�aWtQEx�AEPEPEP[�������+������?�?�(W���?G����(��7
ϓK2j�}��v�O���^?��'��hQ@���?��Z�+�����p��]�W������cWҵ�W������cW��^��ɋ���QE}!�Q@Q@Q@k�?�J���_�&amp;��+_���P<;�_2��4�ɏ�v�����"=��(��=`��(ſ�&amp;k�����m_0���?�����L��q��ھa��J�+��v���~�ۿ��(���(��(��(�����&lt;]��5��lu�W�o�G���������_�G�Ŀ�,�����QE{��EP)��E�_�_�Ur��|E��@�����E\�|�w�Hz?�®�(���L��(��(��(�������?�?�(V%m�?����x�P�W&�x~��5���Q_Pn]@��ffAr�~b�@'���Ʀ���6K�~�fF� �����B��     �8���1�[�j�¿��t��E����#�7_K�y�2Ls��.ďº�+��ms�_3�Ư�k��ms�_3�Ưc&�4�?S��/Qh���C�
(��
(��
(��
�u`�����YS���(�����(�S�/������*����"����/�*��z�������]�QE�Q@Q@Q@m�?����x�P�J���� �����^�M����kK�;�(����(�������+�j�A\���?��Z�(������|�����������|����������NL_��E��+�&lt;(��(��(��+_���P<;�_2��4ՑZ���������I��L��?�և��QE|q�Q@�-��3]��}���j�/�)�诧�[�"f��`����_�S��^fc�~g��g�[���G�E�tQEQEQE�����������c�����&lt;]��5��luՂ�2<%��eO��t��+�?,
(��9O���(����Ҩ�����/������*���3��C��fwAEW�dQEQEQE����?�A�]���B�+o����������z�7�����/��(���p�?U�5h�A46�bqqo�O��9v`:�����ǰ�9�&gt;����U�  ��������k�o���5����@��5ny��T~~͞fѻns���y�I@��V�������&gt;l���ב�������{׵�ZҭR��7fL�+I'�
������o��_����A����^�Eo��w�|���'�
������o��_����A����^��j�G���q���[|�/��X�px�=~�$"����<��&�)�`��
��:p�ҏ�W���c���U������«���h?��+�?� Ӿ��s$��4���~�9KpS��� N����pC�V8��8�`��?�1_����{
}�+��W�?����7�Q�
��={f����P��̿���?���S>.����������
g�����9��O�H��ss�&amp;�X��v���:���#�e��: ����~V�r̃<q�#.u"����P��̿���?����S>.����������
�
��������}��VUE�q���Vݕ���l�]�}j�6�   "|�GC�&lt;� ��g��_0�c�������xo�#����x��~<7���½J�?��ȿ��rG����x��~<7���µ&lt;9��h�_�$��w"9�`mP����QZR�Q�.jq��9��?����۟YX\]2�l�D�nHPN?J��F���Ȋ��+�PEt:�(��(��(��(�
������q4&�u�F�nK@��x泮|+��R�w��r���S����H���J(����o��uu�e6��Wj� a���5l�^�̌��l�5����� <��&[��LQEh�|z]���I$@���r�X�ucV袀
(��
(��
(��
(��
i���-�ɽ�e��6>W������=�7��vݵnḞ��[��aWD$�w) ���#9�4Q@����;��UU��*�f��Uۅ�D�d�Ae�-o"��_]�O1;,���RLK�{c�(ON���-���Ey圙1��H�0�2��n�(��(��(��(��(��(�A#��\�^�㶱��/d6�Z��́�X�9���y�����EL��2��st��$�m)���r���8�q�Z�n��g�h��E�$�t��]˞��h��-�EQEQE�� 
```

当我将代码更改为 binaryStuff = chart.asString('pdf') 时，我得到的东西看起来好多了：

```
%PDF-1.4
%���� ReportLab Generated PDF document http://www.reportlab.com
% 'BasicFonts': class PDFDictionary 
1 0 obj
% The standard fonts dictionary
<< /F1 2 0 R
 /F2 3 0 R >>
endobj
% 'F1': class PDFType1Font 
2 0 obj
% Font Helvetica
<< /BaseFont /Helvetica
 /Encoding /WinAnsiEncoding
 /Name /F1
 /Subtype /Type1
 /Type /Font >>
endobj
% 'F2': class PDFType1Font 
3 0 obj
% Font Times-Roman
<< /BaseFont /Times-Roman
 /Encoding /WinAnsiEncoding
 /Name /F2
 /Subtype /Type1
 /Type /Font >>
endobj
% 'Page1': class PDFPage 
4 0 obj
% Page dictionary
<< /Contents 8 0 R
 /MediaBox [ 0
 0
 400
 200 ]
 /Parent 7 0 R
 /Resources << /Font 1 0 R
 /ProcSet [ /PDF
 /Text
 /ImageB
 /ImageC
 /ImageI ] >>
 /Rotate 0
 /Trans <<  >>
 /Type /Page >>
endobj
% 'R5': class PDFCatalog 
5 0 obj
% Document Root
<< /Outlines 9 0 R
 /PageMode /UseNone
 /Pages 7 0 R
 /Type /Catalog >>
endobj
% 'R6': class PDFInfo 
6 0 obj
<< /Author (anonymous)
 /CreationDate (D:20120829143153+06'00')
 /Creator (ReportLab PDF Library - www.reportlab.com)
 /Keywords ()
 /Producer (ReportLab PDF Library - www.reportlab.com)
 /Subject (unspecified)
 /Title () >>
endobj
% 'R7': class PDFPages 
7 0 obj
% page tree
<< /Count 1
 /Kids [ 4 0 R ]
 /Type /Pages >>
endobj
% 'R8': class PDFStream 
8 0 obj
% page stream
<< /Filter [ /ASCII85Decode
 /FlateDecode ]
 /Length 597 >>
stream
Gau0@hbSkY&:Q"cJ%/!S@dTH/QIdG3`:u)6n\P")-or/'kI/<Yhu7/rN<'>"!^1l(I:'1%+AdK[ID.<7`]7;]+<Z=7*KUpEq)qFB3;SK,k83OX(.Zr2!E/7$Jd9/2*)VXdE,3ZIZ<:>[L:X>.LRHt$Y/BJST7TV7L9QnTPQBa!;PZRB@S*#5VF=Lf-!gUBJn>"XT_.s&!#/UA!TR#s9ohlM,5r9%$;%%Xl9?O/6jOs^i"A>>N+qh)^G-C$_pgKIbe]nfJ!dTWh*R#&fBAmi?37$Jncb*;=ZSh5#GreV]3+,Xf+t'e3o_o^O@0V_,ZpUWHs0d(.aa6RTH'`'oLh%Ne_"Ng+eW0+2UA[.^U<eK/gdplY1Tg.+^[JuZ>iCo(t-,eQr>Fk4;H*ZP%9'(4UT;eAG]nr^N]9Z'uRG<WGg=*bNSRtR]pq9CD37FMbmTJEF^J$Mc3fMEKL%AQq@$ck)72E"KOUZlFYp3"KOVE$G1"ng>S5WarZIH(HT$J:=$@P[/bqha!UMcCkc>1:$eb:L*050M*mgD_9O"Q6ZipUSi3mT@?N8.Ico1o\/9AeD:n!Wp%i`0Cptcp+ccO%^c3k=~>endstream
endobj
% 'R9': class PDFOutlines 
9 0 obj
<< /Count 0
 /Type /Outlines >>
endobj
xref
0 10
0000000000 65535 f
0000000113 00000 n
0000000221 00000 n
0000000386 00000 n
0000000553 00000 n
0000000820 00000 n
0000000954 00000 n
0000001228 00000 n
0000001333 00000 n
0000002072 00000 n
trailer
<< /ID 
 % ReportLab generated PDF document -- digest (http://www.reportlab.com) 
 [(oyD\253\330\261\350\277\034\023\377\3373\025H!) (oyD\253\330\261\350\277\034\023\377\3373\025H!)] 

 /Info 6 0 R
 /Root 5 0 R
 /Size 10 >>
startxref
2123
%%EOF 
```

我并不特别喜欢图表的格式——如果我可以在 django 模板中使用 asString('pdf') 就可以了！（顺便说一句，即使使用 'jpg' 打印出来的东西很难看，它仍然会适当地保存 jpg 文件）

--------Response2--------- 图表仍然没有出现 - 两者都返回 render_to_response HttpResponse 给出一个空的图像源：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:03:08.023

你正在尝试这样做

```
<div><img src="{{ binaryStuff }}" /></div> 
```

但这行不通。src 属性需要一个资源的路径，或者如果您真的想将图像作为二进制文件包含，那么您必须将其编码为 base64，请参阅[此 wikipedia 链接](https://en.wikipedia.org/wiki/Data_URI_scheme)。

如果图表仍然是公开的，如果您的图表包含大量数据，那么它的生成可能不会很快，因此生成一次然后缓存它可能更有意义，因此后续请求可以重用相同的文件。否则，他们在这里拥有它的方式意味着将为每个请求再次计算图表。

> 图表仍然没有出现 - 两者都返回 render_to_response HttpResponse 给出一个空的图像源：

url 为空的原因是因为您没有在上下文中包含 binaryStuff

```
return render_to_response('templates/myapp/barChart.html', {'word': word, 'binaryStuff': binaryStuff}) 
```

# javascript - 如何使用 node.js 将 Web 和错误事件记录到 Splunk？

> ID：12184335
> 
> 赞同：3
> 
> 时间：2012-08-29T18:32:21.533
> 
> 标签：javascript, node.js, splunk

我找到了大量关于如何在 Node.js 中执行 Splunk 搜索的文档（主要感谢 Splunk javascript SDK 文档）。

然而，这不是我想要完成的。我希望使用 Splunk 作为由 node.js 驱动的站点的日志记录/监控/分析解决方案。我需要能够记录不同类型的事件（登录错误、页面请求/响应等），以便 Splunk 索引并使其可用。

如何实现？它是我忽略的 SDK（或 API 本身）的一部分吗？

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T04:12:59.697

在我们最近的 Splunk 会议上，我们举办了一场黑客马拉松，其中一位获胜者实际上为 Winston 开发了 Splunk 传输。[您可以从 github 获取它](https://github.com/erichelgeson/winston-splunk)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T21:19:01.957

看看[温斯顿](https://github.com/flatiron/winston)。这是一个类似于 Log4Net 或 Log4J 的框架，提供可变的日志级别和传输选项。

他们似乎没有 Splunk 的“传输”/插件，但他们有几个其他的，包括相对相似的 Loggly。他们也有关于滚动你自己的说明，所以它看起来是一个很好的起点。

# ios - 故事板 - 连接遥远的场景

> ID：12184336
> 
> 赞同：0
> 
> 时间：2012-08-29T18:32:35.900
> 
> 标签：ios, xcode, storyboard

我的故事板上有一堆控制器，但我很难以图形方式连接两个相距甚远的场景。

缩小时您似乎无法做到这一点，而当您放大时，您无法在情节提要上看到这两个场景。

建议？

==== 更新 ====

按住屏幕边缘的箭头做到了，但最初找到那个神奇的边界并不容易。勾选为正确答案，尽管不太确定 = 符号快捷方式的含义。

文档大纲很方便。对于那些想要使用它的人 - 故事板左下方有一个小箭头按钮。或使用编辑器 > 显示文档大纲（或在文档大纲中显示）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:40:19.867

如果您点击 = 符号，然后按 ctrl 从一个控制器拖动到另一个，它应该可以工作。您在屏幕边缘按住箭头的末端，它应该为您滚动屏幕。哦，您也可以使用文档大纲（导航器旁边的区域，该区域有向左的箭头，可以打开和关闭它）并 ctrl 从一个控制器拖动到另一个控制器。

# android - 以编程方式在android中裁剪屏幕截图

> ID：12184338
> 
> 赞同：0
> 
> 时间：2012-08-29T18:32:44.487
> 
> 标签：android, android-layout, bitmap

为了拍摄屏幕截图，我正在使用以下代码

```
 public void takeScreenShot(){
    File wallpaperDirectory = new File("/sdcard/Hello Kitty/");
    if(!wallpaperDirectory.isDirectory()) {
    // have the object build the directory structure, if needed.
    wallpaperDirectory.mkdirs();
    // create a File object for the output file
    }
    File outputFile = new File(wallpaperDirectory, "Hello_Kitty.png");
    // now attach the OutputStream to the file object, instead of a String representation
    // create bitmap screen capture
    Bitmap bitmap;
    View v1 = mDragLayer.getRootView();
    v1.setDrawingCacheEnabled(true);
    bitmap = Bitmap.createBitmap(v1.getDrawingCache(),0,0,v1.getWidth(),v1.getHeight());
    v1.setDrawingCacheEnabled(false);

    OutputStream fout = null;

    try {
        fout = new FileOutputStream(outputFile);
      //  Bitmap bitMap = Bitmap.createBitmap(src)
        bitmap.compress(Bitmap.CompressFormat.JPEG, 90, fout);
        fout.flush();
        fout.close();

    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

现在我想要一个裁剪的位图，我想从左边裁剪一些部分，从底部裁剪一些部分，所以我使用了这样的代码

```
 Bitmap.createBitmap(v1.getDrawingCache(),v1.getWidth()/10,v1.getHeight()/10,v1.getWidth(),v1.getHeight()); 
```

但我有一个错误

```
 08-29 23:41:49.819: E/AndroidRuntime(3486): java.lang.IllegalArgumentException: x +    width must be <= bitmap.width()
   08-29 23:41:49.819: E/AndroidRuntime(3486):  at android.graphics.Bitmap.createBitmap(Bitmap.java:410)
    08-29 23:41:49.819: E/AndroidRuntime(3486):     at android.graphics.Bitmap.createBitmap(Bitmap.java:383) 
```

谁能告诉我如何从左侧和底部裁剪位图的一部分谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T19:42:49.137

您似乎误解了该特定[`Bitmap.create(...)`](http://developer.android.com/reference/android/graphics/Bitmap.html#createBitmap%28android.graphics.Bitmap,%20int,%20int,%20int,%20int%29)功能的用法。而不是提供源的宽度和高度作为最后两个参数，您应该指定裁剪结果最终应该得到的宽度和高度。

该错误解释说，由于您指定了从左侧和顶部的偏移量，但传入了源的尺寸，因此裁剪结果将超出原始图像的范围。

如果您只想从左侧和顶部裁剪十分之一，只需从原始宽度/高度中减去偏移量：

```
Bitmap source = v1.getDrawingCache();
int x = v1.getWidth()/10;
int y = v1.getHeight()/10
int width = source.getWidth() - x;
int height = source.getHeight() - y;
Bitmap.createBitmap(source, x, y, width, height); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:53:18.993

而不是使用

```
Bitmap.createBitmap(v1.getDrawingCache(),v1.getWidth()/10,v1.getHeight()/10,v1.getWidth(),v1.getHeight()); 
```

您可以使用 `bitmap = Bitmap.createBitmap(width, height, Config.ARGB_8888);`

更多方法请参考[这里](http://developer.android.com/reference/android/graphics/Bitmap.html)

# sonarqube - SONAR 中的 Findbugs 验证正在跳过重要的违规行为

> ID：12184339
> 
> 赞同：0
> 
> 时间：2012-08-29T18:32:44.853
> 
> 标签：sonarqube, findbugs

我在 Sonar 中遇到违规问题，以便在我们公司的一些代码中找到一个基本问题。下面有一个测试类，代表我要澄清的情况：

```
import entity.Cidade;

public class TesteSonar {

    public void testarSonar() {

        Cidade cidade = testarSonar2();

        cidade.getEstado();

    }

    public Cidade testarSonar2() {

        return null;
    }

} 
```

在这个类中，我们遇到变量“cidade”接收到方法“testarSonar2()”的返回值为空的情况，然后我使用来自该对象的操作。很明显会抛出 NullPointerException。我的问题是：为什么 findbugs 没有发现这种问题？

这种情况表明我从该工具收到的结果中的 Sonar 存在可信度问题。任何人都可以帮助理解为什么会这样吗？

谢谢

来自巴西的亚历山大

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T07:53:58.330

我刚刚做了一个测试，确实没有报错。

但是，请注意问题来自 Findbugs，而不是 Sonar 本身 - 因为 Sonar 依赖外部工具进行错误检测。所以我建议你在 Findbugs 的邮件列表上提问。

# wordpress - Widget Logic WordPress 排除父类别及其子类别？

> ID：12184340
> 
> 赞同：0
> 
> 时间：2012-08-29T18:32:46.483
> 
> 标签：wordpress, parent, parent-child, categories

我试图只显示一个父类别，它是特定类别页面上的子类别。

如何排除所有其他父类别及其子类别？

我正在使用插件 Widget Logic。我已经完成了使用，并不能完全弄清楚。

我将其设置为仅在该类别页面上显示该类别的小部件，但它不会排除与该类别页面无关的类别。

我还尝试使用从我的“functions.php”访问的自定义代码，但不行。

帮助表示赞赏。

*** 这是我的小部件逻辑：***

```
is_category(6) || (is_single() && in_category(6)) 
```

***这是迄今为止的视觉结果：***

> **最近的灵感帖子**——小部件
> 
> 灵感测试 2012 年 7 月 20 日
> 
> 测试灵感 2012 年 5 月 24 日
> 
> **灵感类别**-- 小部件
> 
> *灵感*
> 
> ——灵感孩子
> 
> *新闻*（这是不应该列出的父类别？？？）
> 
> -- news child（这是一个不应该列出的子类别？？？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T19:08:00.227

好的，想通了这个。我其实想错了。不是小部件逻辑问题。我找到了这个插件。

AVH 扩展类别

此插件可让您在类别小部件中对特定类别进行分组、重新排序和显示。挺甜的。

# image-processing - 颜色共现直方图

> ID：12184344
> 
> 赞同：2
> 
> 时间：2012-08-29T18:32:56.740
> 
> 标签：image-processing, machine-learning, computer-vision, pattern-recognition

我浏览了以下论文：

[http://research.microsoft.com/pubs/68706/cvpr1.pdf](http://research.microsoft.com/pubs/68706/cvpr1.pdf)

这是关于物体识别的颜色共现直方图。与颜色直方图相比，它具有添加空间信息的优点。

我不明白如何有效地实施它。

有谁知道我在哪里可以获得此代码或使用matlab实现它的一些指南？

# mysql - 需要使用 mySql 以最有效/最快的方式查找所有客户端 ID

> ID：12184354
> 
> 赞同：0
> 
> 时间：2012-08-29T18:33:57.353
> 
> 标签：mysql

我有一个看起来像这样的桥接表

```
clients_user_groups
id = int
client_id = int
group_id = int 
```

我需要找到与client_id 46l属于同一组的所有client_id

我可以通过如下查询来实现它，从而产生正确的结果

```
SELECT client_id FROM clients_user_groups WHERE group_id = (SELECT group_id FROM clients_user_groups WHERE client_id = 46); 
```

基本上我需要找出的是，是否有一种方法可以在不使用 2 个查询或更快的方法的情况下获得相同的结果，或者是否是最佳解决方案之上的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:52:20.197

你也可以尝试自我加入

```
SELECT a.client_id
FROM   clients_user_groups a
LEFT JOIN clients_user_groups b on b.client_id=46 
Where b.group_id=a.group_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:54:47.407

```
set @groupID = (SELECT group_id FROM clients_user_groups WHERE client_id = 46);
SELECT client_id FROM clients_user_groups WHERE group_id = @groupID; 
```

您将有一个获取组 ID 的查询并将其存储到变量中。在此之后，您选择 group_id 与存储在变量中的值匹配的 client_id 值。如果为clients_user_groups.group_id 定义索引，则可以进一步加快查询速度。

注意1：我没有测试我的代码，希望没有错别字，但你已经明白了我的想法。

注意2：这应该在单个请求中完成，因为如果我们查看所需的时间，DB 请求非常昂贵。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:01:02.977

根据您对每个客户端只能属于一个组的评论，我建议更改架构以将 group_id 关系作为字段放入客户端表中。通常，人们会使用您所描述的那种 JOIN 表来表达关系数据库中的多对多关系（即，客户端可以属于许多组，而组可以有许多客户端）。

在这种情况下，无需像这样进行子选择即可进行查询：

```
SELECT c.client_id
FROM clients as c
INNER JOIN clients as c2 ON c.group_id = c2.group_id
WHERE c2.client_id = ? 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T18:38:44.267

您正在使用`WHERE`-clause 子查询，在 MySQL 中，最终会为表中的每一行重新评估。使用 a`JOIN`代替：

```
SELECT a.client_id
FROM   clients_user_groups a
JOIN   clients_user_groups b ON b.client_id = 46
                            AND a.group_id  = b.group_id 
```

由于您计划将来为拥有多个组的客户提供便利，因此您可能需要添加`DISTINCT`，`SELECT`以便`client_ids`在您切换时不会返回多个相同的组（因为客户端位于多个 client_id 46 组）。

如果您还没有这样做，请在以下位置创建以下复合索引：

`(client_id, group_id)`

在`client_id`索引中的第一个位置，因为它很可能提供最佳的初始选择性。此外，如果您的表中有大量行，请确保索引与`EXPLAIN`.

# c# - 按键事件和按钮事件冲突

> ID：12184356
> 
> 赞同：0
> 
> 时间：2012-08-29T18:34:05.023
> 
> 标签：c#, winforms

我正在使用 Microsoft Visual C# 2010 Express 编写一个窗口窗体应用程序。我正在写一个数独程序。我以前写过这个程序并让它工作。由于硬盘驱动器故障，我丢失了源代码。我在表格上画了一个网格。我让鼠标事件起作用。我得到了按键事件来工作。然后我在表单中添加了几个按钮并让它们工作。但随后出现问题。在我添加按钮并让它们工作后，按键事件停止工作。为什么按钮事件和按键事件会发生冲突？

这是具有相同问题的演示程序的代码。'代码' 私有 void doMouseDown（对象发送者，MouseEventArgs e）{ int i; 我 = 0; }

```
 private void DoKeyPress(object sender, KeyPressEventArgs e)\\   This worked until I added
    {
        int i;
        i = 1;
    }

    private void doClickButton(object sender, EventArgs e)   \\   This
    {
        int i;
        i = 2;
    } 
```

'代码'</p>

鼠标事件和按键事件被添加到表单中。

看起来我需要一种方法来将焦点设置在表单上。在使用按钮之前，程序需要在鼠标和键盘之间来回切换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:39:31.203

Set your forms [KeyPreview](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview%28v=vs.71%29.aspx) property to true

```
this.KeyPreview = true; 
```

# html - iOS 使用 Hpple 解析 HTML 属性

> ID：12184357
> 
> 赞同：0
> 
> 时间：2012-08-29T18:34:10.063
> 
> 标签：html, ios, parsing, hpple

我正在尝试在 HTML 的输入标记中检索属性。我的 NSLog 返回为空。我的语法有什么问题？我正在尝试在输入标签中检索“value=”的值。

这是我正在解析的 HTML：

```
<input name="hidXMLID" type="hidden" id="hidXMLID" value="0311sg55dbmnk0nsuzoflnij" /> 
```

下面是解析器语法：

```
NSURL *theURL = [NSURL URLWithString:@"http://www.wccca.com/PITS/"];
NSData *data = [[NSData alloc] initWithContentsOfURL:theURL];
xpathParser = [[TFHpple alloc] initWithHTMLData:data];
NSArray *elements = [xpathParser searchWithXPathQuery:@"//input[@id='hidXMLID']//@value"];
TFHppleElement *element = [elements objectAtIndex:0];
NSString *content = [element content];

NSLog(@"ID = %@",content); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:40:36.157

我想这可以通过不同的 XPath 查询和属性检查来更好地解决，可能类似于：

```
NSArray *elements = [xpathParser searchWithXPathQuery:@"//input[@id='hidXMLID']"];
TFHppleElement *element = [elements objectAtIndex:0];
NSDictionary *attributes = [element attributes];
NSString *idValue = [attributes objectForKey:@"id"]; 
```

从您的帖子和日志中，我认为这可能会在不更改查询的情况下起作用：

```
TFHppleElement *element = [elements objectAtIndex:0];
TFHppleElement *child = [element.children objectAtIndex:0];
NSString *idValue = [child content]; 
```

# javascript - 访问函数内部的函数属性

> ID：12184361
> 
> 赞同：1
> 
> 时间：2012-08-29T18:34:27.917
> 
> 标签：javascript

我希望能够将属性分配给函数本身内部的函数。我不想将它分配给调用对象。所以我想要这样做的等价物：

```
var test  = function() {                    
    return true;         
};

test.a = 'property on a function';
alert(test.a); 
```

取而代之的是，将属性分配给全局对象：

```
var testAgain = function() {
   this.a = "this property won't be assigned to the function";

   return true;  
};

testAgain();
alert(window.a); 
```

编辑：为了澄清，我想知道是否有这样的事情：

```
var test = function() {
   function.a = 'property on a function';
};
alert(test.a); // returns 'property on a function' 
```

在不知道该函数被称为测试或必须执行它的情况下。我当然知道这不是有效的语法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:40:22.967

> [有没有办法在函数上设置属性] 不知道函数被调用`test` **或必须执行它**。

强调我的。

您可以在函数上设置属性而不知道它的全局变量名称必然是什么，但是您*必须*以一种或另一种方式引用该函数。

模块模式与我能想到的一样接近：

```
window.test = (function () {
    //the function could be named anything...
    function testFn() {
        ...code here...
    }
    //...so long as the same name is used here
    testFn.foo = 'bar';
    return testFn;
}());
window.test.foo; //'bar' 
```

外部闭包防止`testFn`在全局任何地方访问，因此所有其他引用都必须使用`window.test`.

* * *

[这部分答案与问题的先前版本相关联。]

最简单的方法是使用命名函数：

```
var test = function testFn() {
    testFn.foo = 'bar';
    return true;
};

test.foo; //undefined
test();
test.foo; //'bar' 
```

更好的方法是使用模块模式，这样您就不会意外地产生全局泄漏问题：

```
var test = (function () {
    function ret() {
        ret.foo = 'bar';
        return true;
    }
    return ret;
}());

test.foo; //undefined
test();
test.foo; //'bar' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:41:25.320

```
var testAgain = function() {
    arguments.callee.a = "this property won't be assigned to the function";
    return true;  
};

testAgain();
alert(testAgain.a);​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:42:00.940

您可以通过简单地使用名称来分配属性，如下所示：

```
var test = function () {
    test.a = 'a';
    return true;
}; 
```

当`test`被调用时，该属性将被设置。

[演示](http://jsfiddle.net/amaan/rp33k/)

如前所述，您*可以*使用`arguments.callee`，`su-`但这被认为是非常糟糕的做法。此外，它不会在严格模式下工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T20:54:22.730

```
var test = function() {
    test.a = 'a';
}; 
```

或者您可以使用原型，[在此处](http://www.phpied.com/3-ways-to-define-a-javascript-class/)阅读更多内容。

# ajax - mvc3 ajax 服务器端验证

> ID：12184362
> 
> 赞同：2
> 
> 时间：2012-08-29T18:34:33.110
> 
> 标签：ajax, vb.net, asp.net-mvc-3, jquery, server-side

我创建了一个简单的登录表单，我想通过 ajax 进行验证。

显示 MVC 产生的服务器端验证错误的最合适方法是什么？是否将错误转换为 JSON 结果并适当地删除错误消息？如果不是，那会是什么？

目前我所拥有的发布正确，但整个表格都回来了。目标只是在没有回发/刷新的情况下在表单上显示服务器端错误。在此先感谢...这是我的代码：

## 主视图 - Login.vbhtml

```
@ModelType UHCO_MVC_Agency.LoginModel

<div class="error-container">@Html.ValidationSummary(True)</div>
<div class="row-fluid">
    <div class="span12">
        <div id="login-form" class="span6">
            @Using Html.BeginForm()
               @<fieldset>
                  <legend>Log in to your account now</legend>
                  <div class="row-fluid">
                     <div class="span12">
                        @Html.LabelFor(Function(m) m.UserName)
                        @Html.TextBoxFor(Function(m) m.UserName, New With {.class = "span12", .placeholder = "Username"})
                        @Html.ValidationMessageFor(Function(m) m.UserName)
                     </div>
                  </div>
                  <div class="row-fluid">
                     <div class="span12">
                        <label for="Password">Your password</label>
                        @Html.PasswordFor(Function(m) m.Password, New With {.class = "span12", .placeholder = "Password", .type = "password"})
                        @Html.ValidationMessageFor(Function(m) m.Password)
                     </div>
                  </div>
                  <div class="row-fluid">
                     <div class="span12">
                        <label for="RememberMe" class="checkbox clearfix">
                           @Html.CheckBoxFor(Function(m) m.RememberMe)
                           Remember me next time I visit
                        </label>
                     </div>
                  </div>
                  <button type="submit" class="btn btn-primary input-small" value="submit">Log in</button>
               </fieldset>
            End Using
         </div>
      </div>
</div> 
```

## 控制器 - AccountController.vb

```
<HttpPost()> _
Public Function Login(ByVal model As LoginModel, ByVal Username As String, ByVal Password As String, ByVal returnUrl As String) As ActionResult
   Dim res As New LoginResponse()
   Try
      'login here
   If Not String.IsNullOrEmpty(returnUrl) AndAlso Url.IsLocalUrl(returnUrl) Then
      res.Status = "Success"
      Return RedirectToAction("Welcome", "Account")
   End If
   Catch ex As Exception
      If Not HttpContext.Request.IsAjaxRequest() Then
         ModelState.AddModelError("", ExceptionWrapper.Wrap(ex).ExceptionMessage())
         Return View("Login", model)
      Else
         res.Status = "Failed"
         res.Errors.Add(ExceptionWrapper.Wrap(ex).ExceptionMessage())
         Return Json(res)
      End If
   End Try
   ' If we got this far, something failed, redisplay form
   Return View(model)
End Function 
```

## 应用程序.js

```
$("#login-form form").live().submit(function (e) {
  e.preventDefault();
  alert("ok");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T20:06:20.043

这是解决方案的 C# 版本。我相信，转换成相应的VB.NET版本应该很容易

使用**JSON**绝对是一个很好的方法。

第一件事。我将更改`POST`操作方法来处理我对 Ajax 请求的请求并返回`JSON`响应。

为了保持我的错误响应，我将创建一个这样的类

```
public class LoginResponse
{
  public string Status { set;get;}
  public List<string> Errors { set;get;}

  public LoginResponse()
  {
    Errors=new List<string>();   
  }       
} 
```

在我们的`POST`动作方法中

```
[HttpPost]
public ActionResult Login(LoginModel model)
{
  if(Request.Ajax)
  {
       var res=new LoginResponse();
     //Do your Validations, If everything is fine send Success JSON
        res.Status="Success";

     //else, Lets return a JSON with errors
        res.Status="Failed";
        res.Errors.Add("Email does not exist in Earth and Mars");
        res.Errors.Add("Password contain the word black magic");

     return Json (res);
  }
  else
  {
     //Do the normal Processing for Non Ajax requests here
  }
} 
```

所以如果有一些错误你想返回给客户端，你会以这种格式发送 JSON

```
{
    "Status": "Failed",
    "Errors": [  "Email does not exist",  "Passoword is worse"  ]
} 
```

如果一切正常，我们将像这样发送 JSON

```
{
    "Status": "Success"
} 
```

现在在我们看来，我们将摆脱 Ajax 表单并使用带有一些纯 jQuery 的 Normal 表单标签。

```
@ModelType UHCO_MVC_Agency.LoginModel
@using(Html.BeginForm())
{
  //Here your for elements

  <input type="submit" id="btnSubmit"/>
}
<script type="text/javascript">

$(function(){
   $("#btnSubmit").click(function (e) {
      e.preventDefault();
     $.post("@Url.Action("Login","User")", $("form").serialize(), function (r) {
       if(r.Status=="Success")
       {
         //Login is success . do whatever you want.
       }
       else
       {
         //Lets get the Errors from our JSON
         $.each(r.Errors,function(index,item){
             //Lets show the error
              $("#errorSummary").append(item);
         }  
       }
     });

});    
</script> 
```

**编辑：**像这样更改你的 js 代码，看看会发生什么

```
$("#login-form form").live('submit', function(e){
   e.preventDefault();
  //the code

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T20:07:23.133

无论如何，我不是一个 VB 人，但我认为你需要做的是：

1）在您的控制器中，您需要检查并查看您是否通过 AJAX 到达。您可以发送一条额外的信息以及数据来表明这一点，或者使用`SERVER['HTTP_X_REQUESTED_WITH']`并检查大多数常见库发送的 XMLHTTPRequest。

2) 如果页面实际上是通过 AJAX 请求的，那么您可以在打包输出时采用不同的过程。仅返回 JSON，然后在操作 DOM 的客户端解析它。

# sql - SQL 顶部和连接

> ID：12184363
> 
> 赞同：0
> 
> 时间：2012-08-29T18:34:34.920
> 
> 标签：sql, join, sap-ase

**业务规则**：我们只能每 90 天为后续事件计费。任何发生在前一个事件之后不到 90 天的事件都不能计费，但需要记录下来。

**用户要求**：他们希望在提交当前事件账单的选项卡上查看上次事件账单提交的日期，以直观地提示提交账单是否值得。

事件在表事件中有一个 event_id 和一个 event_date。event_id 是表 event_bill 中的外键，其中包含账单的提交日期。事件对于每个客户都有一个外键 customer_id，因此一个客户可以在任何时间段内有多个事件。

鉴于当前的 event_id 和 customer_id，我正在尝试获取最近一次活动的提交日期。

这是我尝试过的：

```
 SELECT TOP 1 (event_id) as prev_event_id
    INTO #tmp
    FROM  event 
    WHERE customer_id = @custID
    AND event_type = 'Followup'
    AND event_id < @eventID 
    ORDER BY event_date DESC

    SELECT eb.submitted_date
    FROM event_bill eb
    JOIN #tmp
    ON eb.event_id = #tmp.prev_event_id

    DROP TABLE #tmp 
```

这一切都很好，但是我的应用程序的数据库权限不允许创建临时表。

在没有临时表的尝试中，我得到了无法在派生表中使用 ORDER BY 的错误，但我需要确保我获得该客户当前事件之前的最后一个事件：

```
 SELECT eb.submitted_date
    FROM event_bill eb
    JOIN
    (
    SELECT TOP 1 (event_id) as prev_event_id
    FROM  event 
    WHERE customer_id = @custID
    AND event_type = 'Followup'
    AND event_id < @eventID 
    ORDER BY event_date DESC
    ) x
    ON eb.event_id = x.prev_event_id 
```

谁能给我一个更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:47:04.707

尝试这个 ：）

```
SELECT eb.submitted_date
FROM event_bill eb
WHERE
  eb.event_id IN (
    SELECT event.event_id 
    FROM event 
    WHERE 
      event.customer_id = @custID 
      AND event.event_type = 'Followup'
      AND event.event_id < @eventID
    ORDER BY event_date DESC
     LIMIT 1
   ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:47:56.203

也许它会帮助你

```
 SELECT eb.submitted_date
    FROM event_bill eb
    JOIN
    (
    SELECT event_id as prev_event_id
    FROM  event 
    WHERE customer_id = @custID
    AND event_type = 'Followup'
    AND event_id < @eventID 
    and event_date = 
    (
      select max(event_date)
      FROM  event 
      WHERE customer_id = @custID
      AND event_type = 'Followup'
      AND event_id < @eventID 
    )
    ) x
    ON eb.event_id = x.prev_event_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:48:13.197

我认为 ORDER BY 会被顶部接受。如果没有，您可以这样做：

```
 SELECT eb.submitted_date
 FROM event_bill eb JOIN
      event e
      on eb.event_id = e.event_id join
      (SELECT customer_id, MAX(eventdate) as maxdate
       FROM  event
       WHERE customer_id = @custID AND
            event_type = 'Followup' AND
            event_id < @eventID
       group by customer_id
      ) md
     ON e.customer_id = md.customer_id and
        eb.event_date = md.maxdate 
```

这会计算 maxdate，然后将其用于连接。

# c# - 从控制器中从 asp.net 中的选择标记中检索值以查看

> ID：12184366
> 
> 赞同：2
> 
> 时间：2012-08-29T18:34:44.623
> 
> 标签：c#, javascript, asp.net-mvc

我正在开发一个 asp.net webapp，在一个视图中，我有一个下拉列表，用户可以从中选择一个值。下拉列表工作得很好——菜单中显示了正确的文本。但是，当我尝试使用一些基本的 JS 来捕获该值时，我在 Chrome 的 JS 控制台中收到“未捕获的 TypeError：Object # has no method 'GetElementById'”。这是我的代码：

```
<select id="stop" onchange="sendInfo();">

@foreach(var blah in ViewBag.foobar)
{

<option value=@blah>@blah</option>

}
</select>

<script>
function sendInfo() {

    var stopId = document.GetElementById("stop").value;

}

</script> 
```

任何帮助将不胜感激，我对 MVC 和 asp.net 的东西非常陌生。

谢谢，

阿曼达

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:40:07.190

JavaScript 是一种区分大小写的语言，您正在寻找的方法是[getElementById](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)

所以你应该写：

```
var stopId = document.getElementById("stop").value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:47:34.710

您不需要调用`getElementById`函数，您可以通过传递给每个事件处理程序的事件对象访问 html 元素：

```
<select id="stop" onchange="sendInfo(event);">

@foreach(var blah in ViewBag.foobar)
{
     <option value=@blah>@blah</option>
}
</select>

<script>
function sendInfo(event) {
        var stopId = event.target.value;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:40:03.333

`getElementById...`

区分大小写很重要。

# sql - 通过记录类型 sql 为每个 id 拉一条记录

> ID：12184368
> 
> 赞同：1
> 
> 时间：2012-08-29T18:34:52.870
> 
> 标签：sql

我是 SQL 新手，我正在尝试编写一个查询来执行以下操作。

我有一个包含记录类型和 ID 的表。每个 ID 可以有重复和多种类型。

```
Type              ID
History            1
History            1
Geography          1
Geography          2
French             2
French             3
English            3
English            4 
History            4
History            4 
```

我想为每个 ID 创建一条记录，其中包含历史、地理、所有其他的“类型层次结构”。所以在上面的例子中，我正在寻找以下内容：

```
History   1
Geography 2
French    3
History   4 
```

换句话说，给我所有的历史记录，如果一个 ID 没有历史，给我地理记录，对于没有任何一个的 ID，给我任何记录类型之一。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:39:33.830

我认为类似的东西

```
SELECT Type, ID
GROUP BY Type, ID 
```

应该管用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T21:57:56.613

您没有告诉您的 RDMS，但以下代码适用于 Oracle（和 SQL Server，我想）。对于其他人，有**`row_number`**功能仿真。

```
--creating table..

CREATE TABLE "YOURTABLE" 
(   "TIP" VARCHAR2(20), 
"IDE" NUMBER
) 

--inserting experimental values..

insert into YOURTABLE (TIP, IDE)
values ('History', 1);
insert into YOURTABLE (TIP, IDE)
values ('History', 1);    
insert into YOURTABLE (TIP, IDE)
values ('Geography', 1);    
insert into YOURTABLE (TIP, IDE)
values ('Geography', 2);    
insert into YOURTABLE (TIP, IDE)
values ('French', 2);    
insert into YOURTABLE (TIP, IDE)
values ('French', 3);    
insert into YOURTABLE (TIP, IDE)
values ('English', 3);    
insert into YOURTABLE (TIP, IDE)
values ('English', 4);    
insert into YOURTABLE (TIP, IDE)
values ('History', 4);    
insert into YOURTABLE (TIP, IDE)
values ('History', 4);

 --code..

select m.*
      from (select *
              from YOURTABLE
             where tip = 'History'
            union
            select *
              from YOURTABLE
             where tip = 'Geography'
               and ide not in (select ide from YOURTABLE where tip = 'History')
            union
            select tip, ide
              from (select s.*,
                           ROW_NUMBER() OVER(PARTITION BY ide ORDER BY ide) ord
                      from YOURTABLE s
                     where tip not in ('History', 'Geography')
                       and ide not in
                           (select ide
                              from YOURTABLE
                             where tip in ('History', 'Geography')))
             where ord = 1) m 
```

结果表：

```
TIP                         IDE
-------------------- ----------
History                       1
Geography                     2
English                       3
History                       4 
```

你说：

> 历史、地理和所有其他的“类型层次结构”

在我的示例中，结果是英语而不是法语，但这不应该成为问题，因为“所有其他人”都是平等的。

# r - 逻辑回归：不是预测函数的实际输出

> ID：12184371
> 
> 赞同：0
> 
> 时间：2012-08-29T18:35:25.933
> 
> 标签：r, regression, predict

我是 R 新手，当我要使用 glm() 估计逻辑模型时，它不会预测响应，而是在调用预测函数时给出一个不实际的输出，比如我的预测函数中的每个输入的 1。

```
Code:

    ex2data1R <- read.csv("/media/ex2data1R.txt")
    x <-ex2data1R$x
    y <-ex2data1R$y
    z <-ex2data1R$z

    logisticmodel <- glm(z~x+y,family=binomial(link = "logit"),data=ex2data1R)
    newdata = data.frame(x=c(10),y=(10))
    predict(logisticmodel, newdata, type="response") 

Output:
> predict(logisticmodel, newdata, type="response") 
           1 
1.181875e-11 

Data(ex2data1R.txt) :
"x","y","z"
34.62365962451697,78.0246928153624,0
30.28671076822607,43.89499752400101,0
35.84740876993872,72.90219802708364,0
60.18259938620976,86.30855209546826,1
79.0327360507101,75.3443764369103,1
45.08327747668339,56.3163717815305,0
61.10666453684766,96.51142588489624,1
75.02474556738889,46.55401354116538,1
76.09878670226257,87.42056971926803,1
84.43281996120035,43.53339331072109,1
95.86155507093572,38.22527805795094,0
75.01365838958247,30.60326323428011,0
82.30705337399482,76.48196330235604,1
69.36458875970939,97.71869196188608,1
39.53833914367223,76.03681085115882,0
53.9710521485623,89.20735013750205,1
69.07014406283025,52.74046973016765,1
67.94685547711617,46.67857410673128,0
70.66150955499435,92.92713789364831,1
76.97878372747498,47.57596364975532,1
67.37202754570876,42.83843832029179,0
89.67677575072079,65.79936592745237,1
50.534788289883,48.85581152764205,0
34.21206097786789,44.20952859866288,0
77.9240914545704,68.9723599933059,1
62.27101367004632,69.95445795447587,1
80.1901807509566,44.82162893218353,1
93.114388797442,38.80067033713209,0
61.83020602312595,50.25610789244621,0
38.78580379679423,64.99568095539578,0
61.379289447425,72.80788731317097,1
85.40451939411645,57.05198397627122,1
52.10797973193984,63.12762376881715,0
52.04540476831827,69.43286012045222,1
40.23689373545111,71.16774802184875,0
54.63510555424817,52.21388588061123,0
33.91550010906887,98.86943574220611,0
64.17698887494485,80.90806058670817,1
74.78925295941542,41.57341522824434,0
34.1836400264419,75.2377203360134,0
83.90239366249155,56.30804621605327,1
51.54772026906181,46.85629026349976,0
94.44336776917852,65.56892160559052,1
82.36875375713919,40.61825515970618,0
51.04775177128865,45.82270145776001,0
62.22267576120188,52.06099194836679,0
77.19303492601364,70.45820000180959,1
97.77159928000232,86.7278223300282,1
62.07306379667647,96.76882412413983,1
91.56497449807442,88.69629254546599,1
79.94481794066932,74.16311935043758,1
99.2725269292572,60.99903099844988,1
90.54671411399852,43.39060180650027,1
34.52451385320009,60.39634245837173,0
50.2864961189907,49.80453881323059,0
49.58667721632031,59.80895099453265,0
97.64563396007767,68.86157272420604,1
32.57720016809309,95.59854761387875,0
74.24869136721598,69.82457122657193,1
71.79646205863379,78.45356224515052,1
75.3956114656803,85.75993667331619,1
35.28611281526193,47.02051394723416,0
56.25381749711624,39.26147251058019,0
30.05882244669796,49.59297386723685,0
44.66826172480893,66.45008614558913,0
66.56089447242954,41.09209807936973,0
40.45755098375164,97.53518548909936,1
49.07256321908844,51.88321182073966,0
80.27957401466998,92.11606081344084,1
66.74671856944039,60.99139402740988,1
32.72283304060323,43.30717306430063,0
64.0393204150601,78.03168802018232,1
72.34649422579923,96.22759296761404,1
60.45788573918959,73.09499809758037,1
58.84095621726802,75.85844831279042,1
99.82785779692128,72.36925193383885,1
47.26426910848174,88.47586499559782,1
50.45815980285988,75.80985952982456,1
60.45555629271532,42.50840943572217,0
82.22666157785568,42.71987853716458,0
88.9138964166533,69.80378889835472,1
94.83450672430196,45.69430680250754,1
67.31925746917527,66.58935317747915,1
57.23870631569862,59.51428198012956,1
80.36675600171273,90.96014789746954,1
68.46852178591112,85.59430710452014,1
42.0754545384731,78.84478600148043,0
75.47770200533905,90.42453899753964,1
78.63542434898018,96.64742716885644,1
52.34800398794107,60.76950525602592,0
94.09433112516793,77.15910509073893,1
90.44855097096364,87.50879176484702,1
55.48216114069585,35.57070347228866,0
74.49269241843041,84.84513684930135,1
89.84580670720979,45.35828361091658,1
83.48916274498238,48.38028579728175,1
42.2617008099817,87.10385094025457,1
99.31500880510394,68.77540947206617,1
55.34001756003703,64.9319380069486,1
74.77589300092767,89.52981289513276,1 
```

让我知道我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T19:13:05.303

我没有看到任何问题。以下是 x,y = 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100 的预测值：

```
newdata = data.frame(x=seq(30, 100, 5) ,y=seq(30, 100, 5))
predict(logisticmodel, newdata, type="response")
1            2            3            4            5            6 
2.423648e-06 1.861140e-05 1.429031e-04 1.096336e-03 8.357794e-03 6.078786e-02 
           7            8            9           10           11           12 
3.320041e-01 7.923883e-01 9.670066e-01 9.955766e-01 9.994218e-01 9.999247e-01 
          13           14           15 
9.999902e-01 9.999987e-01 9.999998e-01 
```

您预测 x=10, y=10 远远超出您的 x, y 值 (30 - 100) 的范围，但预测为零，符合这些结果。当 x 和 y 较低 (30 - 55) 时，z 的预测为零。当 x 和 y 很高（75 - 100）时，预测值为 1（或接近 1）。如果将结果四舍五入到几位小数，可能会更容易解释结果：

```
round(predict(logisticmodel, newdata, type="response") , 5)
      1       2       3       4       5       6       7       8       9      10 
0.00000 0.00002 0.00014 0.00110 0.00836 0.06079 0.33200 0.79239 0.96701 0.99558 
     11      12      13      14      15 
0.99942 0.99992 0.99999 1.00000 1.00000 
```

这是预测类别并将结果与​​数据进行比较的简单方法：

```
predict <- ifelse(predict(logisticmodel, type="response")>.5, 1, 0)
xtabs(~predict+ex2data1R$z)

ex2data1R$z
predict  0  1
      0 34  5
      1  6 55 
```

我们在您的原始数据上使用了 predict()，然后创建了一个规则，如果概率大于 .5，则选择 1，否则选择 0。然后我们使用 xtabs() 将预测与数据进行比较。当 z 为 0 时，我们正确预测 0 34 次，错误预测 1 6 次。当 z 为 1 时，我们正确预测 1 55 次，错误预测 0 5 次。我们 89% 的时间是正确的 (34+55)/100*100。如果您使用 0.45 或 0.55 而不是 0.5 作为截止值，您可以探索预测的准确性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T19:07:25.763

我认为一切都是正确的，您可以从 R 手册中阅读：

> **newdata** - 可选的，一个数据框，用于查找要预测的变量。如果省略，则使用拟合的线性预测变量。

如果您有包含 1 条记录的数据框，它将仅针对该记录生成预测。

有关更多详细信息，请参阅[R 手册/glm/predict](http://stat.ethz.ch/R-manual/R-patched/library/stats/html/predict.glm.html)

或者只是在 R 控制台中，加载库 glm 后：

```
?glm 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-13T08:44:32.907

您还可以使用以下命令来制作混淆矩阵：

```
predict <- ifelse(predict(logisticmodel, type="response")>.5, 1, 0)
table(predict,ex2data1R$z) 
```

# python - 在 Python Boto 的 DynamoDB API 中，Layer1 和 Layer2 有什么区别？

> ID：12184372
> 
> 赞同：3
> 
> 时间：2012-08-29T18:35:29.537
> 
> 标签：python, boto, amazon-dynamodb

应该使用哪个以及用于什么？一个比另一个有什么优势吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:58:37.740

这只是抽象级别的问题。在大多数情况下，您会希望使用最高级别的 API。

*   **Layer1** API 是 Amazon 的 API 的直接映射
*   **layer2** API 添加了一些不错的抽象，例如生成器`scan`和`query`结果以及答案清理。

当您调用 layer2 时，它会调用 layer1 最终生成 HTTP 调用。

# scala - 应用函子如何与并行算法联系起来？（斯卡拉和斯卡拉兹）

> ID：12184373
> 
> 赞同：9
> 
> 时间：2012-08-29T18:35:30.233
> 
> 标签：scala, parallel-processing, monads, functor, applicative

来自 Josh Suereth 的“Scala in Depth”：

“应用函子提供了一种方法来进行两个计算并使用函数将它们连接在一起。Traversable 示例强调了如何将两个集合并行化成对。应用函子和并行处理就像面包和黄油一样结合在一起。”

我对整个 functors/monads/applicative 的东西有一个模糊的概念，但对它的掌握并不完全（对整个 monad、functor 的东西来说都是新手）。我对单子（flatten，flatMap）和单子工作流程以及仿函数（地图）的概念有所了解。

任何人都可以详细说明它是如何完成的、示例和/或它与“传统”并行化相比的好处吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T18:47:27.630

我将问题转发给了 Josh Suereth。这是他的回复：

迈克-

> 我没有太多时间来回应，但我会提供一些例子来说明我的意思：
> 
> 示例 #1 - 表单验证。
> 
> 我想对输入进行一些验证并汇总*所有*错误，即*并行*检测它们。使用应用功能，我可以做到这一点。
> 
> 因此，给定一组“处理”函数，如下所示：
> 
> ```
> def processUser(data: Data): Validation[User] = {
>   if (data get "username" isEmpty) Failure("username must not be empty")
>   else {  
>      val Some(user) = data get "username"
>      if (user contains badCharacterRegex) Failure(s"username must not contain one of ${badchars}")
>      else Success(user)
>   }
> }
> def processCreditCard(data: Data): Validation[CreditCard] = ...
> def processAddress(data: Data): Validation[Address] = ...
> 
> def handleForm(data: Data): ??? = {
>   (processUser(data), processCreditCard(data), processAddress(data)) map { (user, card, address) =>
>     postPayment(user, address, card)
>   } recover {   (errors) =>
>      errors foreach println
>   } 
> ```
> 
> 现在处理表单将同时打印出带有 CreditCard/用户名 + 地址的错误，因为您已经使用应用函子将它们组合在一起。那是并行错误报告（尽管测试实际上并不是并行完成的）。
> 
> (2) 期货
> 
> 我想并行做一些事情并结合结果。Future 的“zip”方法实际上是一个变相的应用函子。我可以做这个：
> 
> ```
> Future(computation1) zip Future(computation2) map { case (one,two) => .... } 
> ```
> 
> 我刚刚使用 Applicative Functors 来“加入”并行计算。
> 它与表单验证示例完全相同。
> 
> 希望有帮助！- 乔什

（请注意，这些代码片段是不可编译的示例；我使用 SBT 的应用语法和 Scalaz 中的概念，因此您需要选择一个库来使用应用程序及其应用对象）

# r - 写入 csv 文件：使用 knitr/chunks 时出现错误消息

> ID：12184375
> 
> 赞同：0
> 
> 时间：2012-08-29T18:35:40.687
> 
> 标签：r, knitr

我有一个相当简单的数据框

```
str(match)

'data.frame':   261 obs. of  2 variables:
 $ country: chr  "Afghanistan" "Albania" "Algeria" "American Samoa" ...
 $ match  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ... 
```

如果我通过运行一行将其写入 .csv 文件，则一切正常。

```
write.csv(match.df, file = "match.csv") 
```

但是，当使用 knitr 生成 .pdf 时，我（当然）使用块。

```
<<worldmapmatch>>=
exo$match <- is.na(match(exo$iso2c, wrld_simpl@data$ISO2))
match <- exo[, c("country", "match")]

match.df <- data.frame(match)
head(match.df)
str(match.df)
write.csv(match.df, file = "match.csv")
save(exo, file = "exo.RData")
@ 
```

在这种情况下，我收到一条错误消息。

> 尺寸太大。

错误消息是针对“写...”的行给出的

有什么线索吗？

# php - 如何通过 FormBuilder 的字段传递树枝参数

> ID：12184376
> 
> 赞同：2
> 
> 时间：2012-08-29T18:35:46.720
> 
> 标签：php, forms, symfony, twig

[我已经以文档](http://symfony.com/doc/current/cookbook/form/form_customization.html#adding-help-messages)中的形式实现了帮助消息

```
{% extends 'form_div_layout.html.twig' %}

{% block field_widget %}
    {{ parent() }}
    {% if help is defined %}
        <span class="help">{{ help }}</span>
    {% endif %}
{% endblock %} 
```

为了呈现帮助部分，该示例说应该在 twig 文件中定义“帮助”，如下所示：

```
{{ form_widget(form.title, {'help': 'foobar'}) }} 
```

但是，我想将“帮助”定义为表单构建器中字段的选项，如下所示：

```
class myClassType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('title',null,array('help'=>'foobar'));
    }
} 
```

这没有产生任何结果（“选项“帮助”不存在“）。我也试过

```
$builder
   ->add('title',null,array('attr'=>array(help'=>'foobar'))); 
```

它也不起作用。

有什么想法可以让这样的事情发挥作用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T20:18:43.933

利用

```
$builder
->add('title',null,array('attr'=>array('help'=>'foobar'))); 
```

接着

```
{% if attr['help'] is defined %}
    <span class="help">{{ attr['help'] }}</span>
{% endif %} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T20:15:40.643

您可以使用最终实现`finishView`的方法。例如，`AbstractType``FormTypeInterface`

```
// Vendor/YourBundle/Form/Type/YourFormType

namespace Vendor\YourBundle\Form\Type;

// other use definitions
use Symfony\Component\Form\FormInterface;
use Symfony\Component\Form\FormView;
use Symfony\Component\Form\AbstractType;

class YourFormType extends AbstractType 
{
    // other methods.... 

    /**
     * {@inheritdoc}
     */
    public function finishView(FormView $view, FormInterface $form, array $options)
    {
        parent::finishView($view, $form, $options);
        $view['title']->vars['help'] = "Title help message";
        // same for other fields
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:53:09.387

我的猜测是您不能这样做的原因是表单字段帮助文本主要是视图/模板问题。我意识到这并不能完全回答你的问题。

# java - 排序 LinkedHashMap

> ID：12184378
> 
> 赞同：48
> 
> 时间：2012-08-29T18:35:49.290
> 
> 标签：java, linkedhashmap

鉴于 LinkedHashMap 包含字符串和整数，如何根据其值对 LinkedHashMap 进行排序。所以我需要根据整数值对其进行排序。非常感谢

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-08-29T18:40:19.633

```
List<Map.Entry<String, Integer>> entries =
  new ArrayList<Map.Entry<String, Integer>>(map.entrySet());
Collections.sort(entries, new Comparator<Map.Entry<String, Integer>>() {
  public int compare(Map.Entry<String, Integer> a, Map.Entry<String, Integer> b){
    return a.getValue().compareTo(b.getValue());
  }
});
Map<String, Integer> sortedMap = new LinkedHashMap<String, Integer>();
for (Map.Entry<String, Integer> entry : entries) {
  sortedMap.put(entry.getKey(), entry.getValue());
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2015-01-09T12:15:09.327

现在使用 Java 8 流要容易得多：您不需要中间映射来排序：

```
map.entrySet().stream()
    .sorted(Map.Entry.comparingByValue())
    .forEach(entry -> ... ); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T18:37:11.660

`LinkedHashMap`只是维护插入顺序。如果要根据值进行排序，则可能需要编写自己的`comparator`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-04T10:14:43.453

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.NavigableMap;
import java.util.SortedMap;
import java.util.TreeMap;

public class HashMapTest {

public static void main(String[] args) {

    Map<String, Integer> map=new LinkedHashMap<String, Integer>();

    map.put("a", 11);
    map.put("B", 12);
    map.put("c", 3);
    map.put("d", 4);
    map.put("e", 5);
    map.put("f", 6);
    map.put("g", 7);
    map.put("h", 8);
    map.put("i", 9);
    map.put("j", 3);
    map.put("k", 2);
    map.put("l", 1);

    List<Map.Entry<String, Integer>> entries = new 
    ArrayList<Map.Entry<String, Integer>>(map.entrySet());
            Collections.sort(entries,new CustomizedHashMap());

            Map<String, Integer> sortedMap = new LinkedHashMap<String, 
   Integer>();
            for (Map.Entry<String, Integer> entry : entries) {
              sortedMap.put(entry.getKey(), entry.getValue());
              System.out.print( sortedMap.put(entry.getKey(), 
          entry.getValue())+"  ");
            }
     }
    }

 class CustomizedHashMap implements Comparator<Map.Entry<String, Integer>> {

  @Override
  public int compare(Entry<String, Integer> o1, Entry<String, Integer> o2) {
    // TODO Auto-generated method stub
    return -o1.getValue().compareTo(o2.getValue());
  }

} 
```

# objective-c - 属性作为“当前 NSManagedObject”的视图控制器中的 NSManagedObject

> ID：12184389
> 
> 赞同：0
> 
> 时间：2012-08-29T18:36:29.033
> 
> 标签：objective-c, core-data, properties, nsmanagedobject

我有兴趣在视图控制器中将属性设置为 NSManagedObject 的子类，比如 Person，它将指定 person 的实例，以便我能够使用控制器中的方法进行更新。我可以这样做吗？

```
// Viewcontroller.h

@implementation

@property (nonatomic, retain) Person* currentPerson;

@end

// ViewController.m

@implementation

@dynamic currentPerson;

-(void) doSomethingToCurrentPerson {
    currentPerson.SomeAtrribute=somevalue;
}  

@end 
```

看起来如果这不是一个有效的方法，也可以设置一个唯一标识符，然后将 CurrentPersonUniqueID 存储为属性并使用 KVC。有没有办法让我发布的工作内容符合我的要求，或者我最好使用更接近 KVC 方法的东西，或者完全不同的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:48:07.017

`@dynamic`在您替换为之前，此代码将不起作用`@synthesize`。`@dynamic`告诉编译器`-setCurrentPerson:`并`-currentPerson`在其他地方实现，但事实并非如此。

因此`@synthesize currentPerson`将自动创建`currentPerson`'s getter/setter。这`Person`与`NSManagedObject`.

此外，您不能`currentPerson`直接使用此名称访问，您必须使用它的 getter：

```
self.currentPerson.attribute = something;
// or
[self currentPerson].attribute = something; 
```

**正确代码：**

```
// Viewcontroller.h
@implementation    
@property (nonatomic, retain) Person* currentPerson;
@end

// ViewController.m
@implementation
@synthesize currentPerson;

-(void) doSomethingToCurrentPerson {
    self.currentPerson.SomeAtrribute = somevalue;
}

@end 
```

# constructor - 如何定义一个aspectj切入点来挑选具有特定注释的类的所有构造函数？

> ID：12184391
> 
> 赞同：3
> 
> 时间：2012-08-29T18:36:32.393
> 
> 标签：constructor, annotations, aspectj, pointcut

这是注释：

```
@Target(value = ElementType.TYPE)
@Retention(value = RetentionPolicy.RUNTIME)
@Inherited
public @interface MyAnnotation {
    String name();
} 
```

这是一个带注释的类：

```
@MyAnnotation(name="foo")
public class ClassA {
    public ClassA() {
        // Do something
    }
} 
```

这是第二个带注释的类：

```
@MyAnnotation(name="bar")
public class ClassB {
    public ClassB(String aString) {
        // Do something
    }
} 
```

我正在寻找一个 aspectj 切入点，该切入点正确匹配 ClassA 和 ClassB 的构造函数，而不匹配任何其他未注释的类的任何其他构造函数`MyAnnotation`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T23:01:05.973

您的切入点应如下所示：

```
execution((@MyAnnotation *).new(..)) 
```

如果注解在另一个包中：

```
execution((@de.scrum_master.aop.demo.MyAnnotation *).new(..)) 
```

或者，如果您不想完全限定软件包：

```
execution((@*..MyAnnotation *).new(..)) 
```

* * *

**编辑：**好的，有关您的问题的更多信息在评论中：

构造函数执行没有可以捕获的返回值

```
after() returning(Object myObject) : myJoinpoint() 
```

这仅适用于方法。所以请使用

```
after(Object myObject) returning : myJoinpoint() && this(myObject) 
```

相反，如果您出于任何目的确实需要构造的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T04:11:00.320

这是 kriegaex 的完整工作解决方案：

```
public aspect AnnotationTests {
  public aspect AnnotationTests {
    after(Object myObject) returning : execution((@MyAnnotation *).new(..))
        && this(myObject) {
      System.out.println("Object class name: " + myObject.getClass().getName());
    }
  }
}

@MyAnnotation(name="foo")
public class ClassA {
  public ClassA() {
    // Do something
  }

  public static void main(String[] args) {
    ClassA classA = new ClassA();
    ClassB classB = new ClassB("");
    if (classA.getClass().getName().equals(classB.getClass().getName())) {
      throw new RuntimeException("Big problems!");
    }
  }
}

@MyAnnotation(name="bar")
public class ClassB {
  private final String aString;

  public ClassB(String aString) {
    this.aString = aString;
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T03:36:19.873

以下作品，但 kriegaex 不推荐。此处作为可能的材料提供，如果需要，可以重新利用。

这是我对部分使用initialization()切入点原语的问题的第一个可行解决方案。

```
public aspect AnnotationTests {
  private pointcut genericConstructor(): initialization(*.new(..));
  private pointcut withinMyAnnotation(): @within(MyAnnotation);
  private pointcut constructorInAnnotatedClass(): genericConstructor()
      && withinMyAnnotation();

  before(): constructorInAnnotatedClass() && !cflowbelow(constructorInAnnotatedClass()) {
    final Object objectInstance = thisJoinPoint.getTarget();
    System.out.println("Object class name at join point: "
        + objectInstance.getClass().getName());
  }
}

@MyAnnotation(name="foo")
public class ClassA {
  public ClassA() {
    // Do something
  }

  public static void main(String[] args) {
    ClassA classA = new ClassA();
    ClassB classB = new ClassB("");
    if (classA.getClass().getName().equals(classB.getClass().getName())) {
        throw new RuntimeException("Big problems!");
    }
  }
}

@MyAnnotation(name="bar")
public class ClassB {
  private final String aString;

  public ClassB(String aString) {
    this.aString = aString;
  }
} 
```

# c# - ApplicationPoolIdentity 下来自 C# 的远程 PowerShell 会话

> ID：12184393
> 
> 赞同：4
> 
> 时间：2012-08-29T18:36:38.353
> 
> 标签：c#, powershell-remoting

使用我从 Microsoft 找到的[库](http://archive.msdn.microsoft.com/psoutlooklive)，我一直在尝试（使用 C#）使用 Live@Edu 为我的用户配置电子邮件帐户，并且该库使用远程 PowerShell 会话来执行此操作。我用一个`using() { }`模拟本地管理员帐户的块包装了 PowerShell 调用。当我在自己的开发机器上运行代码时，它运行良好，并且在 Live@Edu 上配置了帐户，但是当我在生产服务器上运行相同的代码时，我`Access is Denied`从 PowerShell 中收到错误消息。

我刚刚注意到的是，如果我将服务器上的 IIS 应用程序池用户更改为我自己的域帐户，那么在生产服务器上一切正常，但让它`ApplicationPoolIdentity`不起作用。因此，即使在我的代码中我冒充本地管理员，这些凭据似乎也不会传递到 PowerShell 会话。奇怪的是，当脚本在我自己的机器上运行时，也`ApplicationPoolIdentity`没有问题，这让我相信脚本实际上是在我自己的机器上运行在我自己的帐户下（我是本地管理员）。

我确实有代码吐出了值，`$env:username`它给了我机器名称，我期待它给我它运行的实际用户名，因为这是我直接在 PowerShell 窗口中键入该命令时得到的。

当使用我在代码中模拟的凭据以交互方式登录到远程服务器时，我可以手动将所有 PowerShell cmdlts 键入到 PowerShell 窗口中，它们工作正常。

我不想让我的 IIS 应用程序池始终在管理员帐户下运行，因为这看起来很愚蠢，那么有没有办法以管理员身份运行 PowerShell 脚本，这比我当前的模拟更进一步？

**更新：**

发生了一件奇怪的事情，这对我来说是一种解决方案。将我的代码部署到我创建的服务器后，添加了一个本地管理员帐户。然后我去了 IIS 应用程序池并将所有者从`ApplicationPoolIdentity`我刚刚创建的管理员帐户更改。之后，该页面可以正常运行 PowerShell 脚本。我以前就知道这一点，但不想让 IIS 使用管理员帐户。然后我继续将应用程序池设置回`ApplicationPoolIdentity`并删除本地管理员帐户，页面仍然有效！？我重新启动了 IIS 和 Web 服务器本身，一切正常。我能想到的是，将应用程序池移至管理员帐户会永久更改应用程序池中的某些属性。我现在[在 ServerFault 上提出了一个修改后的问题](https://serverfault.com/questions/423001/does-changing-an-iis-application-pool-owner-permanently-modify-attributes)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-18T15:45:08.873

原来这个问题与`Load User Profile`IIS 应用程序池中的选项有关，因为我的应用程序被设置`False`在服务器上（`False`是 Windows Server 2008 的默认设置）。在阅读了这个属性之后，我不完全确定为什么这对我的场景很重要，但这是我本地机器上的 IIS 中的一个设置，与 Web 服务器的设置不同。现在，所有 PowerShell 调用都可以在服务器上完美运行。

# java - 构建器离线安装

> ID：12184394
> 
> 赞同：0
> 
> 时间：2012-08-29T18:36:42.497
> 
> 标签：java, rubygems, buildr

我有可以访问 Internet（在私有 Intranet 内）的离线 PC，我需要在这个盒子上设置构建器。

***是否可以在不访问 Internet 的情况下在机器上安装构建器？***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T19:51:17.907

当然。您需要收集 Buildr 依赖的 gems 及其所有依赖项，然后从 ruby​​gems.org 下载它们。然后，您将能够通过键入以下内容来安装构建器：

```
gem install buildr-1.4.7.gem 
```

这是另一个宝石 rails 的完整答案，最后一个答案似乎就在现场：

[离线 gem 依赖](https://stackoverflow.com/questions/4357895/offline-gem-dependencies)

```
gem fetch rails -y -t /path/to/flash_drive 
```

# c# - 关闭来自不同进程的套接字/端口连接

> ID：12184397
> 
> 赞同：1
> 
> 时间：2012-08-29T18:36:55.770
> 
> 标签：c#, c++, sockets, port

> **可能重复：**
> [如何获取特定套接字并关闭它](https://stackoverflow.com/questions/644256/how-to-get-a-specific-socket-and-close-it)

我想知道一种从不同进程（在 Windows 中）关闭现有套接字连接的方法。我没有套接字的句柄，我只知道端口号。我想我可能需要编写内核级代码来做到这一点。C# 或 C++ 中的任何引用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:48:07.330

有很多方法可以做到这一点。

其中之一是将dll注入目标进程，该进程将等待主进程发送的数据包或其他信号，然后关闭套接字。

![在此处输入图像描述](../Images/71678e9c07642f4f4cf48dc3465527c4.png)

或者您可以只向已经打开的套接字发送一个数据包，这将触发异常并因此删除套接字，但我怀疑这会比注入 DLL 更容易。

或者，也许您可​​以向打开的套接字发送一个 FIN 信号。

# django - django {% url %} 标签不带参数

> ID：12184398
> 
> 赞同：6
> 
> 时间：2012-08-29T18:36:56.643
> 
> 标签：django

我有一个定义如下的网址：

```
url(r'^details/(?P<id>\d+)$', DetailView.as_view(), name='detail_view'), 
```

在我的模板中，我希望能够获取以下 url：`/details/`从定义的 url。

我试过`{% url detail_view %}`了，但由于我没有指定`id`参数，所以出现错误。

我需要没有 ID 的 url，因为我将使用 JS 附加它。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T18:41:45.943

只需将此行添加到您的`urls.py`：

```
url(r'^details/$', DetailView.as_view(), name='detail_view'), 
```

**或者：**

```
url(r'^details/(?P<id>\d*)$', DetailView.as_view(), name='detail_view'), 
```

（这是一个更清洁的解决方案 - 感谢 Thomas Orozco）

您需要`id`在视图函数中指定它是可选的：

```
def view(request, id=None): 
```

# sql - SQL Max 获取最高id

> ID：12184399
> 
> 赞同：0
> 
> 时间：2012-08-29T18:37:03.947
> 
> 标签：sql

我在这里得到了这些查询字符串...

```
SELECT 
    c.clientid, c.clientname, c.billingdate, 
    i.total - (select ifnull(sum(p.amount), 0) from payment p 
               where p.invoice = i.invoiceid Order by i.invoiceid) AS remaining 
FROM 
    client c 
INNER JOIN 
    invoice i 
WHERE 
    c.clientid = i.client 
ORDER BY 
    clientname 
```

它的作用是获取所有客户的列表、他们的账单日期和余额。我也有客户的发票，每张发票都有余额。我要做的是为每个客户获取客户最新的余额（具有最高 id 值的发票）。

我有什么查询它多次列出每个客户，每张发票的每个剩余余额......就像这样

```
client 1 0.00
client 1 1.00
client 1 3.00 
```

我正在寻找的是

```
client 1 0.00
client 2 3.00
client 3 5.00 
```

我希望我想做的事情是有意义的。我也试过`Order by MAX(i.invoiceid)`，但只返回一个客户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:48:33.430

我不确定为什么 max invoiceid 对您不起作用

```
SELECT 
    c.clientid, c.clientname, c.billingdate, 
    i.total - (select ifnull(sum(p.amount), 0) from payment p 
               where p.invoice = i.invoiceid Order by i.invoiceid) AS remaining 
FROM 
    client c 
INNER JOIN 
    invoice i 
WHERE 
    c.clientid = i.client 
AND i.invoiceid = (SELECT MAX(i2.invoiceid) FROM invoice i2 WHERE i2.client = i.client) 
ORDER BY 
    clientname 
```

现在您应该只获得客户最新的发票

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:41:21.513

试试这个 ：

```
SELECT c.clientid, c.clientname, c.billingdate, i.total - 
(select ifnull(sum(p.amount), 0) from payment p where p.invoice = i.invoiceid Order by i.invoiceid DESC LIMIT 1) AS remaining 
FROM client c inner join invoice i where c.clientid = i.client ORDER BY clientname 
```

使用 DESCending 订单和 LIMIT 1，您只能为每个客户选择一个金额，即具有最高 id 的金额（因此是最新的）

# wordpress - WordPress - 如何添加自定义 500 服务器错误页面？

> ID：12184402
> 
> 赞同：7
> 
> 时间：2012-08-29T18:37:27.447
> 
> 标签：wordpress

在 WordPress 中为错误页面创建自定义错误页面似乎很容易，即找不到 404 - 只需在主题目录中创建 404.php 即可。

我想对服务器错误做同样的事情，比如如果我的 WordPress 网站上的 CGI 脚本做了一些愚蠢的事情，比如除以 0。

我尝试在我的主题目录中创建一个 500.php 页面，但它似乎被忽略了。而是调用主题目录中的 404.php 页面。

似乎 WordPress 以某种方式捕获了服务器错误并将其转换为“未找到”错误，然后使用 404.php

如果出现服务器错误 (500)，而不是简单的页面未找到 (404) 错误，如何让 WordPress 转到不同的自定义页面？

在您告诉我将 ErrorDocument 500 /path-to-custom-error-page 之类的内容放入 .htaccess 文件之前，已经尝试过 - 它被 Web 服务器忽略，可能是因为使用了同一文件中的 RewriteRule 指令由 WordPress 拦截和处理所有请求（不，无论 ErrorDocument 指令是高于还是低于 WordPress RewriteRule 部分都没有关系）。

（注意：我尝试自己研究这个，但搜索结果被人们抱怨使用 WordPress*获取*服务器错误，而不是询问如何创建自定义页面来处理它们。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T09:57:03.190

WordPress 将永远无法针对服务器错误 (500) 显示您的自定义错误页面。您需要在 WordPress 之外创建一个 .html 或 PHP 页面。您的主机可能已经有一些可以帮助您的东西，许多都有一个文件夹，您可以在其中放置自定义错误页面，位于网站的根文件夹之外。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-25T17:18:17.533

`wp_die()`从 WP 3.0 开始，您可以使用`wp_die_handler`过滤器覆盖使用的标准错误页面。

' *wp_die* ' 和 ' *wp_die_handler* ' 位于`wp-includes/functions.php`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-14T20:37:05.163

# javascript - javascript 交互式调试（相当于 python 的 pdb.set_trace()）

> ID：12184404
> 
> 赞同：8
> 
> 时间：2012-08-29T18:37:31.883
> 
> 标签：javascript, debugging, interactive

我正在使用一些 javascript 代码，我希望能够在函数调用的上下文中运行一个交互式控制台——也就是说，基本上正是 python 所`import pdb; pdb.set_trace()`完成的。有没有办法做到这一点？如果不是，那么最好的近似值是什么？

我目前正在使用 Chrome 的控制台来处理一些事情，我基本上很想被放到函数调用的中间，并使用 Chrome 的控制台来查看局部变量等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T18:41:58.663

设置断点，Chrome 的 Inspector 将允许您检查应用程序的状态。

*   单击行号。将出现一个蓝色标记。当您点击该行时，执行将暂停。 ![断点设置](../Images/d53e10c399e8860559ce63fa26f0ebef.png)

*   在你的代码中写一个`debugger`语句。当您点击该语句时，Inspector 将暂停。

    ```
    function something() {
        // do stuff
        debugger;
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:42:27.987

您可以在chrome开发者工具中设置断点，也可以在firefox中的firebug和ie 8及以上的开发者工具中设置断点。

# algorithm - 应用启发式方法寻找欧拉路径

> ID：12184405
> 
> 赞同：1
> 
> 时间：2012-08-29T18:37:39.390
> 
> 标签：algorithm, graph

我知道有很多算法可以在无向图中找到欧拉路径；据我所知，他们给出了一条随机（合法）的路径。

给定一个欧拉图，我想找到一条欧拉路径，它会尽快通过之前看到的顶点；也就是说，在沿着该路径在图上行走时，我将在第一步中访问以前访问过的顶点。可以更正式地说，当在图上行走时，以前未访问过的顶点的分布在路径上几乎是均匀的。

我知道我的请求不是很正式（我希望它被理解），因此我知道很难找到最佳解决方案，所以我正在寻找启发式方法来获得更好的路径。

# java - 解析 href 以捕获其中的一部分

> ID：12184408
> 
> 赞同：3
> 
> 时间：2012-08-29T18:37:50.880
> 
> 标签：java

```
 <ContentFragment><![CDATA[<a target=_blank href=$click_tracking_url$&landing_url=https://www.foo.com><img src='urltoimage.jpg' border='0' alt='' /></a>]]></ContentFragment> 
```

我有一个文件的这个 xml 片段，我可以通过 JAXB 访问 ContentFragment。并且 ContentFragment 是一个字符串。

我想了解如何捕获 a href 是否针对新窗口以及是否存在点击跟踪 URL。

就我所做的而言，我可以做一个`string.contains("_blank");`或者`string.contains("click_tracking_url");`然后我可以解析。

有没有更好的方法来做到这一点，例如将href解析成部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:05:44.473

有很多用于解析 XML 的 Java 库...

...并且有用于解析 HTML 的出色 Java 库...

...但是为了简单地解析元素内`<a>`标签内的“href” ：`[CDATA]`

`String.contains()`并且`String.indexOf()`应该绰绰有余。

恕我直言...

# postgresql - PostgreSQL 创建一个新列，其值以其他列为条件

> ID：12184409
> 
> 赞同：13
> 
> 时间：2012-08-29T18:37:59.897
> 
> 标签：postgresql, insert-update, conditional-statements

我使用 PostgreSQL 9.1.2，我有一个如下的基本表，其中我有一个条目的生存状态作为布尔值 `(Survival)`和天数`(Survival(Days))`。

我手动添加了一个名为的新列`1-yr Survival`，现在我想为表中的每个条目填写此列的值，条件是该条目`Survival`和 `Survival (Days)`列的值。一旦完成，数据库表将如下所示：

```
Survival    Survival(Days)    1-yr Survival
----------  --------------    -------------
Dead            200                NO
Alive            -                 YES
Dead            1200               YES 
```

输入条件值的伪代码`1-yr Survival`类似于：

```
ALTER TABLE mytable ADD COLUMN "1-yr Survival" text
for each row
if ("Survival" = Dead & "Survival(Days)" < 365) then Update "1-yr Survival" = NO
else Update "1-yr Survival" = YES
end 
```

我相信这是一个基本操作，但是我找不到执行它的 postgresql 语法。一些搜索结果返回“添加触发器”，但我不确定这是我需要的。我认为我在这里的情况要简单得多。任何帮助/建议将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T19:10:13.247

一次性操作可以用一个简单的来实现`UPDATE`：

```
UPDATE tbl
SET    one_year_survival = (survival OR survival_days >= 365); 
```

我建议不要在你的名字中使用驼峰式、空格和括号。虽然允许在双引号之间，但它通常会导致复杂化和混乱。[考虑手册中关于标识符和关键字](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS)的章节。

您是否知道可以使用 CSV*将查询结果导出*为 CSV [`COPY`](http://www.postgresql.org/docs/current/interactive/sql-copy.html)？
例子：

```
COPY (SELECT *, (survival OR survival_days >= 365) AS one_year_survival FROM tbl)
TO '/path/to/file.csv'; 
```

以这种方式开始时您不需要冗余列。

* * *

### 评论的附加答案

为避免空更新：

```
UPDATE tbl
SET    "Dead after 1-yr" = (dead AND my_survival_col < 365)
      ,"Dead after 2-yrs" = (dead AND my_survival_col < 730)
....
WHERE  "Dead after 1-yr" IS DISTINCT FROM (dead AND my_survival_col < 365)
   OR  "Dead after 2-yrs" IS DISTINCT FROM (dead AND my_survival_col < 730)
... 
```

就个人而言，如果我有令人信服的理由，我只会添加这些多余的列。通常我不会。如果是关于性能：你知道[表达式和部分索引](http://www.postgresql.org/docs/current/interactive/indexes.html)的索引吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-30T00:49:36.297

老实说，我认为您最好不要将数据存储在数据库中，因为数据库可以快速轻松地从存储的数据中计算出来。一个更好的选择是模拟一个计算字段（但是下面提到的问题）。在这种情况下，您将 9 更改空格等来下划线以便于维护：

```
CREATE FUNCTION one_yr_survival(mytable)
RETURNS BOOL
IMMUTABLE
LANGUAGE SQL AS $$
select $1.survival OR $1.survival_days >= 365;
$$; 
```

那么你实际上可以：

```
SELECT *, m.one_year_survival from mytable m; 
```

它会“正常工作”。请注意以下问题：

*   默认列列表不会返回 mytable.1_year_survival，并且
*   您不能省略表标识符（上例中的 m），因为解析器会将其转换为 one_year_survival(m)。

然而，好处是可以证明该值永远不会与其他值不同步。否则你最终会得到一个检查约束的老鼠巢。

你实际上可以采取这种方法很远。见[http://ledgersmbdev.blogspot.com/2012/08/postgresql-or-modelling-part-2-intro-to.html](http://ledgersmbdev.blogspot.com/2012/08/postgresql-or-modelling-part-2-intro-to.html)

# php - 让 apache 与 PHP 一起用于 REST 服务器

> ID：12184415
> 
> 赞同：2
> 
> 时间：2012-08-29T18:38:11.223
> 
> 标签：php, apache, .htaccess, rest, httpd.conf

我正在尝试在最顶部使用[此 php REST 教程中提供的代码。](http://net.tutsplus.com/tutorials/other/a-beginners-introduction-to-http-and-rest/)代码是 server.php，apache 配置是 apache.conf

无论如何，当我尝试运行该程序时，我得到一个“断开的链接”错误。但是，如果我只是简单地回显“hello”，它将显示回显语句。我在评论中做了一些挖掘，我认为这可能是 apache 的配置，但我没有运气弄清楚。

我用于 server.php 文件的路径位于 C:\xampp\htdocs\rest\server.php

我将以下内容添加到我的 httpd.conf 中，但没有任何改变。

```
RewriteEngine on
RewriteRule ^/.* rest/server.php 
```

看了一些评论，有人建议改成这个，但是也没用

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* rest/server.php/$0 [L] 
```

我不确定如何配置 .htaccess 文件（甚至不知道它会使用 xampp 去哪里），但这可能吗？

**编辑 - 仍然无法正常工作，我做了以下更改**

我在 httpd.conf 中改变了这个

```
<Directory />
 Options FollowSymLinks
 AllowOverride ALL 
 Order deny,allow
 Deny from all
</Directory> 
```

我制作了一个 .htaccess 文件并将其放在我的 htdocs 文件夹中（在 xampp 中），其中包含以下几行

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^/.* rest/server.php 
```

# jquery - 尝试动态创建模式并执行自定义脚本失败

> ID：12184416
> 
> 赞同：0
> 
> 时间：2012-08-29T18:38:11.963
> 
> 标签：jquery, asp.net, modal-dialog

首先，当我将我的数据和代码附加到包装器中时，它不会显示非常特殊的代码。当我用 Visual Studios 快速观看时。然后最后它根本不会显示模态。

代码：

```
var wrapper = $("<div>");
var data = $("<select>");
data.append('<option value = "17">Asset Name Read Only</option>').append('<option value = "18">Asset Type</option>').append('<option value = "19">Asset Code Read Only</option>').append('<option value = "20">Asset Parent</option>').append('<option value = "21">Asset Parent All</option>').append('<option value = "22">Asset Name Editable</option>').append('<option value = "23">Asset Code Editable</option>')
var code = $("<script>").attr("type", "text/javascript").html('$(".modal select option").click(function(){$(SELECTED_ELEMENT).attr("elType", $(this).val());});');
wrapper.append(data).append(code);
parent.showOverlay();
parent.showModal(wrapper); 
```

上面的语句“parent.showModal(wrapper)”如下：

```
function showModal(data){
  $("<div class = 'modal'>").css({
      top: $(window).height() / 2 - $("div.modal").height() / 2,
      left: $(window).width() / 2 - $("div.modal").width() / 2
  }).append(data).fadeIn();
} 
```

我不太确定发生了什么，即模式既没有显示也没有javascript被附加到包装器div的原因。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:07:37.183

不需要 appendTo("body") 来显示它。

至于脚本，不要将脚本发送给函数，而只是发送 HTML，因为它可以工作，然后在行之后就像：

parent.showModal（包装器）；wrapper.find("option").click(function(){ //在此处插入代码 });

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:37:26.427

你应该使用插件，这里是简单的代码

```
(function($){
    $.fn.modal = function(){
      //append div to body
     $("<div />").appendTo('body').attr("id","modal").css({width: 200, height:120, background-color:'red', position:'absolute', display:'none'});
    win_width = $(window).width(); //get the width of window
    win_height = $(window).height();
    mod_width = $('#modal').width();
    mod_height = $('#modal').height();
    //calculate values to center the modal
    m_top = (win_height / 2) - (mod_height / 2);
    m_left = (win_width / 2) - (mod_width / 2);
    //center modal
    $("#modal").css({top: m_top, left: m_left});
    $("#modal").fadeIn();
    }
})(jQuery); 
```

请务必调用它。

```
<button id = 'button'>CLick me</button> // html button
$('#button').modal(); // call plugin in js 
```

# azure - 使用 Umbraco 的新 Windows Azure 网站在安装过程中失败

> ID：12184418
> 
> 赞同：0
> 
> 时间：2012-08-29T18:38:18.210
> 
> 标签：azure, umbraco

有没有人使用 Umbraco 成功创建了 Windows Azure 网站？

我按照这些步骤创建了一个新的 Umbraco 站点，当我第一次运行该站点时，我得到了标准安装页面。当我到达 Create User 部分时，它会因 NullReferenceException 而失败。

注意：我没有将 Umbraco 安装到 Web 角色。这是新的 Windows Azure 网站预览。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T03:53:01.060

这些信息不足以指出错误，但是我已经解决了一些问题，其中当插件是 Umbraco 配置的一部分或连接 SQL 数据库时出现完全相同的错误。在您的 Umbraco 配置期间，您可能已经配置了 SQL 数据库连接，因此您可以验证相同的连接字符串是否可以在您的本地计算机上工作（我相信您可能必须正确设置防火墙）

您是否还收集了站点日志（FTP 到您的网站并查找日志文件夹）以查看是否有关于此问题的更多信息。您还可以选择直接在[Windows Azure 网站论坛上](http://social.msdn.microsoft.com/Forums/en-US/windowsazurewebsitespreview/threads)报告您的问题，并且网站团队的人员将帮助您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T09:25:58.020

在 Azure 中找到应用程序部分并从应用程序安装 Umbraco，然后它会正常工作

# java - 需要有关 java 中 ExecutorService 的建议

> ID：12184421
> 
> 赞同：1
> 
> 时间：2012-08-29T18:38:34.450
> 
> 标签：java, concurrency, executorservice

嘿，所以我为 ExecutorService 的 java 文档选择了这个示例。我想确认这段代码的流程，Executors.newFixedThreadPool 将创建一个线程池（我猜）。所以 serversocket 将等待一个连接，一旦它获得一个连接，它就会启动一个线程，所以现在 poolsize 减 1。一旦线程完成执行，poolsize 将再次增加 1，不是吗？线程会放弃它使用的资源吗？

```
class NetworkService implements Runnable {
 private final ServerSocket serverSocket;
 private final ExecutorService pool;

 public NetworkService(int port, int poolSize)
   throws IOException {
 serverSocket = new ServerSocket(port);
 pool = Executors.newFixedThreadPool(poolSize);
}

 public void run() { // run the service
 try {
   for (;;) {
     pool.execute(new Handler(serverSocket.accept()));
   }
 } catch (IOException ex) {
   pool.shutdown();
  }
 }
}

class Handler implements Runnable {
 private final Socket socket;
 Handler(Socket socket) { this.socket = socket; }
 public void run() {
  // read and service request on socket
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:41:39.240

> 一旦线程完成执行，池大小将再次增加 1，不是吗？

是的。线程将继续运行下一个`Handler`。

> 线程会放弃它使用的资源吗？

不是马上，不是。一旦`Handler` `run()`方法完成，`Handler`就会超出范围。但是，您必须等待垃圾收集器运行才能`Handler`释放实例。这将反过来释放`Socket`，然后成为垃圾收集本身的候选者。

如果您希望您`Socket`尽快被释放（我认为这是问题所在），那么应该在`run()`方法结束时完成。您可以在一个块中调用`socket.close()`（并且可能设置`socket`为）。建议使用以下内容：`null``finally`

```
class Handler implements Runnable {
    ...
    public void run() {
       try {
           // read and service request on socket
       } finally {
           // make sure we close the socket when the handler is finishing
           socket.close();
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:43:45.750

由于它是一个固定线程池，是的，每次将任务提交到池中时池大小都会减小，一旦线程完成运行提交的可运行（或可调用），池大小就会增加。向固定线程池提交更多数量的可运行程序将阻塞，直到池中的任何线程完成运行其先前提交的任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:40:25.213

所有线程所做的就是执行*你* `Runnable`的 s.
因此，如果您需要在完成任务后进行任何清理，*您*应该从`Runnable`. 池只是一种模式实现`Producer`，`Consumer`负责管理线程的生命周期。
线程执行您在队列中传递的任务，因此在您的情况下，`socket`线程之间不会重用。它的范围在`Runnable`

# python - 为什么genguid.exe 生成的clsid 不起作用？

> ID：12184425
> 
> 赞同：1
> 
> 时间：2012-08-29T18:38:47.303
> 
> 标签：python, com, pywin32, clsid

我正在尝试修改 pywin 演示中的 exceladdin.py 示例。

否则我可以修改它，但是当我替换示例中给出的 clsid 时：

```
"{C5482ECA-F559-45A0-B078-B2036E6F011A}" 
```

使用由 genguid.exe 或 pythoncom.CreateGuid() 生成的，例如：

```
"{E44EF798-7FDF-4015-AED6-00234CBBBA77}" 
```

com 插件停止工作。没有跟踪，没有错误，只是 excel com-objects 列表中的以下文本（翻译）“未加载加载项。加载 com 对象时运行时出错。”

我错过了生成 clsid 的步骤吗？

**编辑：**我想我发现了问题...... clsid 是 dll 的 id。在 python 的情况下，clsid 指的是 pythoncomloader27.dll。这是正确的吗？...但我仍然无法加载正确的 python 文件。clsid 以某种方式链接到 pythoncomloader 和原始 pythonfile。如果我生成一个新的 clsid，我必须将它链接到 pythonloader？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:41:31.927

好吧，我想我找到了答案……

除非您以 root（管理员）身份运行所有内容，否则无法将 python 安装在“程序文件”文件夹中。

`<pythonInstallationDir>/Lib/win32com/gen-py`注册 com-service 读取/写入目录的 python 程序。Word（或使用 com 服务的程序）也必须能够在那里写（？）。存在非人类可读的字典等。

将 python 安装到 c:/python27 解决了我的问题。现在只有注册程序必须以 root 身份运行。Word 可以作为普通用户运行。我认为在我的情况下，我第二次（我第一次正确注册它）没有给予足够的权限而弄乱了字典，并且它使用的是原始密钥。

# javascript - SCSS 中的 Javascript 表达式

> ID：12184426
> 
> 赞同：0
> 
> 时间：2012-08-29T18:39:00.617
> 
> 标签：javascript, ruby, compass-sass, sass

我的 SCSS 文件中有一个 @for 循环，例如：

```
@for $i from 1 through 12 {
    .cell:nth-child(#{$i}) {
        … //some code here
    }
} 
```

工作正常。但我需要使用 javascript 表达式计算一些属性`Math.sin()`，例如：

```
@for $i from 1 through 12 {
    .cell:nth-child(#{$i}) {
        top: Math.sin(90) * 150 * -1;
        left: Math.cos(90) * 150;
    }
} 
```

在 SCSS 编译器中获取错误。有什么方法可以使用 javascript 表达式还是滥用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T21:42:46.687

Sass 的核心数学相当简单，但[Compass](http://compass-style.org/)附带了大量的[helpers](http://compass-style.org/reference/compass/helpers/)，包括`sin()`和`cos()`函数。设置 Compass 后，您可以执行以下操作：

```
@for $i from 1 through 12 {
    .cell:nth-child(#{$i}) {
        top: sin(90) * 150 * -1;
        left: cos(90) * 150;
    }
} 
```

# sqlite - 将具有右外连接的访问 查询转换为 sqlite 查询

> ID：12184427
> 
> 赞同：1
> 
> 时间：2012-08-29T18:39:03.373
> 
> 标签：sqlite, ms-access, outer-join

`SELECT t13_Literature_Material_Codes.Databank, t13_Literature_Material_Codes.BASE_NUMB, t13_Literature_Material_Codes.BASE_SYMB, t13_Literature_Material_Codes.BASE_CHAR, t13_Literature_Material_Codes.BASE_MOLW, CorrosionRatesInfo.RatesValidFlag FROM CorrosionRatesInfo RIGHT JOIN t13_Literature_Material_Codes ON CorrosionRatesInfo.BASE_NUMB=t13_Literature_Material_Codes.BASE_NUMB;`

如何在 sqlite 中进行此查询？我看到人们使用左外连接。请提供使用类似结构的解决方案，然后我的 c++ 程序可以使用简单的解析器过程修改查询字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:34:31.860

要在 Sqlite 中执行此查询：

```
SELECT t13_Literature_Material_Codes.Databank, t13_Literature_Material_Codes.BASE_NUMB, 
t13_Literature_Material_Codes.BASE_SYMB, t13_Literature_Material_Codes.BASE_CHAR, 
t13_Literature_Material_Codes.BASE_MOLW, CorrosionRatesInfo.RatesValidFlag FROM 
CorrosionRatesInfo RIGHT OUTER JOIN t13_Literature_Material_Codes ON  
CorrosionRatesInfo.BASE_NUMB=t13_Literature_Material_Codes.BASE_NUMB; 
```

只需要添加 "RIGHT OUTER JOIN" 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-08T05:48:19.237

用户 UNION 来解决这个问题

例如

```
SELECT employee.*, department.*
FROM   employee 
       LEFT JOIN department 
          ON employee.DepartmentID = department.DepartmentID
UNION ALL
SELECT employee.*, department.*
FROM   department
       LEFT JOIN employee
          ON employee.DepartmentID = department.DepartmentID
WHERE  employee.DepartmentID IS NULL 
```

是的，[请参阅 Wikipedia 上的示例。](http://en.wikipedia.org/wiki/Join_%28SQL%29#Full%5Fouter%5Fjoin)

# php - php内爆巨大的数组

> ID：12184428
> 
> 赞同：0
> 
> 时间：2012-08-29T18:39:07.153
> 
> 标签：php, arrays, implode

我有一个巨大的 PHP 数组，形式如下：

```
Array
(
    [0] => ('A', 'B', 'C', 'D', 'E', 'F')
    [1] => ('G', 'H', 'I', 'J', 'K', 'L')
    [2] => ('M', 'N', 'O', 'P', 'Q', 'R')
    ....
    [30000] => ('S', 'T', 'U', 'V', 'W', 'X')
) 
```

如您所见，我的数组包含 30,000 个条目。我正在尝试使用[implode()](http://php.net/manual/en/function.implode.php)函数将我的数组转换为以下形式的字符串：

```
$values = ('A', 'B', 'C', 'D', 'E', 'F'), ('G', 'H', 'I', 'J', 'K', 'L'), ('M', 'N', 'O', 'P', 'Q', 'R'), ('S', 'T', 'U', 'V', 'W', 'X') 
```

能够进行 MySQL INSERT 查询。因此，换句话说，我试图一次性将 30,000 个条目插入到数据库表中（而不是在循环或其他方式中进行），例如：

```
INSERT INTO table_name VALUES $values; 
```

我遇到的问题是内爆函数似乎没有内爆我的巨大数组。当我尝试调试字符串以查看我的数组是否已内爆时，我得到空字符串或其他东西。

有谁知道我该如何解决这个问题，或者是否有更好的方法来做到这一点？同样，我不想查询我的数据库 30,000 次，我只想一次插入。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:43:45.323

用 PHP 来做这件事，这将处理你给的多维数组：

```
foreach($array as $arr){
    $values[] = "('".implode("','", $arr)."')";
}

$values = implode(",", $values);
INSERT INTO table_name VALUES $values; 
```

我建议你使用`transactions`. 在这里阅读[`MySQLi`](http://www.php.net/manual/en/mysqli.quickstart.transactions.php)或[`PDO`](http://us2.php.net/manual/en/pdo.transactions.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T18:41:26.013

`implode`不适用于多维数组。每个索引的值都应该用双引号括起来，以便将它们解释为字符串：

```
Array
(
    [0] => "('A', 'B', 'C', 'D', 'E', 'F')"
    [1] => "('G', 'H', 'I', 'J', 'K', 'L')"
    [2] => "('M', 'N', 'O', 'P', 'Q', 'R')"
    ....
    [30000] => "('S', 'T', 'U', 'V', 'W', 'X')"
) 
```

一旦你处理一个一维数组，`implode()`就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:43:13.450

为什么不使用事务（假设您使用的是 MySQL）？这样您就可以构建查询然后一次性提交？

看看[http://dev.mysql.com/doc/refman/5.0/en/commit.html](http://dev.mysql.com/doc/refman/5.0/en/commit.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T18:45:08.457

你没有加入字符串，你正在爆炸数组。如果您的数据结构是正确的字符串，它会转储更像

```
[0] => "(a,b,c)",
       ^-------^---
[1] => "(d,e,f)", 
       ^-------^--0
etc... 
```

请注意我在其中突出显示的引号。您首先必须单独内爆每个子数组，然后内爆父数组，例如 .

```
foreach ($yourarr as $key => $subarr) {
    $yourarr[$key] = "('" . implode("','", $subarr) . "')";
}
$bigstring = implode($yourarr); 
```

另外，这还取决于不包含 SQL 元字符的子数组中的各个值，例如`'`. 做这种事情要非常小心，因为你可以注入自己并杀死插入查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T18:45:38.583

快速解决：

```
$rows = array();

foreach($originalArray as $row){

   $rows[] = '(' . implode(',' $row) . ')';

}

$finalString = implode(',', $rows); 
```

虽然我会将查询拆分为 1000 行的块。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T18:45:53.880

Implode 不是这个工作，你想看看使用准备好的 SQL 语句，然后遍历数组，为每个数组执行语句。

[http://php.net/manual/en/mysqli.prepare.php](http://php.net/manual/en/mysqli.prepare.php)

```
foreach($your_array as $entry) {
    // execute the prepared sql statement here

} 
```

# android - 在 sqlite 数据库的特定行中编辑单个值

> ID：12184429
> 
> 赞同：0
> 
> 时间：2012-08-29T18:39:10.273
> 
> 标签：android, sqlite

假设我的数据库显示了一些具有 _id | 属性的游戏。姓名 | 播放器1 | 播放器2 | 胜1 | 胜2

现在我想实现一个增加 wins1 或 wins2 的方法（由于参数）。但是我不知道如何在不重新输入所有其他值的情况下编辑单个值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:40:24.327

您需要编写一个 sql 更新查询。

例子：

```
ContentValues args = new ContentValues();
args.put(yourColumnName, newValue);
db.update(DATABASE_TABLE, args, KEY_ROWID + "=" + rowID, null); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:41:48.317

# c++ - Win32 编辑控件显示“|” 每个新行的符号

> ID：12184430
> 
> 赞同：1
> 
> 时间：2012-08-29T18:39:23.113
> 
> 标签：c++, winapi, char, file-read, editcontrol

我正在从文件中读取文本并显示在编辑控件中。该文件有多行。但是每当一行结束时，编辑控件就会显示一个“|” 符号，然后转到新行。

例如，如果文件的内容是

```
First
Second
Third 
```

编辑控件显示

```
First|
Second|
Third 
```

请注意，编辑控件显示管道符号，**然后转到新行**。我认为该符号表示它无法正确显示的 \n 或 \r 。但是当我使用 MessageBox() 函数在循环内显示相同的文本时，我没有在每行的末尾得到管道符号。

**这是我的代码的相关部分：**

```
TCHAR buffer[256];
TCHAR file[256] = L"C:\\Documents and Settings\\Dil\\Desktop\\Test.txt";
FILE* fp;

_wfopen_s(&fp, file, L"rt");
while(fgetws(buffer, sizeof(buffer), fp) != NULL)
{
  int len = GetWindowTextLength(hDestEdit);
  SendMessage(hDestEdit, EM_SETSEL, (WPARAM)len, (LPARAM)len);
  SendMessage(hDestEdit, EM_REPLACESEL, 0, reinterpret_cast<LPARAM>(buffer));
}
fclose(fp); 
```

**用于创建编辑控件的代码：**

```
hDestEdit = CreateWindowEx(
    WS_EX_CLIENTEDGE, L"EDIT", L"",
    ES_MULTILINE|ES_AUTOVSCROLL|ES_AUTOHSCROLL|WS_TABSTOP|WS_VISIBLE|WS_CHILD,
    100,100,400,300, hWnd, (HMENU)IDC_DEST_EDIT, GetModuleHandle(NULL), NULL); 
```

如何阻止那个奇怪的角色出现在编辑控件中？

**编辑**

我使用调试器进行了检查。对于读入的每一行，`buffer`空终止符之前的最后一个字符是 0x000a - 换行符。回车 0x000D 不存在。

**编辑 2**

我尝试了以下代码；管道不在每条线的末端，但我在最后一条线的末端有 8 或 9 个连续管道。我无法在调试器中检查*缓冲区的单个字符。*

```
TCHAR * buffer;
int length;
wifstream is;
is.open (file, ios::binary );

// get length of file:
is.seekg (0, ios::end);
length = is.tellg();
is.seekg (0, ios::beg);

// allocate memory:
buffer = new TCHAR [length];

// read data as a block:
is.read (buffer,length);
is.close();

// send message to edit control
int len = GetWindowTextLength(hDestEdit);
SendMessage(hDestEdit, EM_SETSEL, (WPARAM)len, (LPARAM)len);
SendMessage(hDestEdit, EM_REPLACESEL, 0, reinterpret_cast<LPARAM>(buffer)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:56:45.900

你为什么不尝试：

```
_wfopen_s(&fp, file, L"rb"); 
```

我认为编辑控件实际上需要 \r\n 序列，但 fgetws() 将不再保留它们。

# javascript - 关闭 div jquery 手风琴后页面跳转到顶部

> ID：12184433
> 
> 赞同：1
> 
> 时间：2012-08-29T18:39:53.633
> 
> 标签：javascript, jquery, html, css, accordion

当您单击它们时，我有一些手风琴层展开。如果我关闭一层页面总是跳到顶部？有没有办法防止这种情况？谢谢

见这里：http: [//jsfiddle.net/Qc58K/](http://jsfiddle.net/Qc58K/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:41:14.687

当页面的高度降低时会发生这种情况。尝试增加身体的高度：

```
body { height:2000px; } 
```

[http://jsfiddle.net/Qc58K/1/](http://jsfiddle.net/Qc58K/1/)

# perl - perldoc 损坏 - eclipse / perl 5.16 / mac osx

> ID：12184434
> 
> 赞同：-2
> 
> 时间：2012-08-29T18:39:55.343
> 
> 标签：perl

我是 Perl 的新手。

从 Eclipse 开始，我希望在控制空格键时自动完成并显示文档。我以为我有这个功能，或者我弄错了。

我搞砸了我的 Perl 安装。并安装了 Perl 5.16。但是 perldoc 在新安装中不起作用。我不知道如何在我的终端中使用 perldoc 了。

:::::::::::::::::

更新：：

我可以从命令行执行 Perl 脚本。我正在使用 Epic 安装，现在使用 5.16 Perl。不确定我可以回滚或如何回滚。所以我现在要坚持这个。我还可以使用哪些其他轻量级 IDE？

如果我做 which perldoc - 我得到 /usr/bin/perldoc

如果我执行 perldoc perldoc - 我得到 perl 版本 5.16.0 无法运行 /usr/bin/perldoc。尝试替代方案：/usr/bin/perldoc5.10.0（使用 Perl 5.10.0）

这是否意味着 5.16 有另一种类型的 perldoc 可用？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T21:25:54.703

> 我是 perl 新手

[你好@airnet，欢迎使用这门美妙的语言:) 你可以在http://www.perl.org/](http://www.perl.org/)找到有关 Perl 以及如何学习它的信息

顺便说一句：该语言称为“Perl”，解释器称为“perl”。

> 我希望在控制空格键时自动完成工作并显示文档。

我个人不使用 Eclipse 进行 Perl 编程，而是更喜欢更轻量级的编辑器。你用的是什么*插件*？史诗？根据您编写的 Perl 代码类型，使用完全成熟的 IDE 可能是不明智的。

> 我搞砸了我的 perl 安装。

AFAIK OSX 预装了 perl。尽管您可能必须单独下载文档。您可以在线访问[http://perldoc.perl.org/的核心文档和](http://perldoc.perl.org/)[http://www.cpan.org/](http://www.cpan.org/)的模块文档。

> 并安装了 perl 5.16。

虽然新版本的 perl 是一件好事，但考虑到某些系统实用程序可能依赖于特定版本，简单地安装新的 perl 可能不是最佳选择。您可以使用（可从 CPAN 获得）安装多个 perl 版本，`perlbrew`但我不建议您这样做，直到您觉得需要特定功能或系统 perl 低于 v5.10

> 我不知道如何在我的终端中使用 perldoc

你输入`perldoc perldoc`;-) 命令`which perldoc`返回什么？程序是否丢失或您的 perl 不再工作？这个命令会打招呼吗？

```
$ perl -e 'print "Hello :-)\n"' 
```

如果没有，您的 perl 可执行文件因此`perldoc`不可用。你能以某种方式回滚你的安装并恢复默认的 perl 吗？

# vba - 将 Word Doc 保存为 PDF 的问题“这不是有效的文件名”

> ID：12184442
> 
> 赞同：2
> 
> 时间：2012-08-29T18:40:18.503
> 
> 标签：vba, ms-word

我正在尝试将 Word 文档另存为 PDF，但出现错误框

> “运行时错误 '-214747259 (80004005) 这不是有效的文件名。”

这是我的代码：

```
Option Explicit

Private Sub cmdSave_Click()

Dim equipName As String, equipError As String, fileDate As String, pdfName As String, filePath As String

filePath = "C:\"
equipName = Replace(Left(ActiveDocument.Tables(1).Cell(1, 2).Range.Text, _
    Len(ActiveDocument.Tables(1).Cell(1, 2).Range.Text) - 1), "/", "-")
equipError = Left(ActiveDocument.Tables(1).Cell(2, 2).Range.Text, Len(ActiveDocument.Tables(1).Cell(2, 2).Range.Text) - 1)
fileDate = Replace(Date, "/", "")
pdfName = equipName & "_" & equipError & "_" & fileDate

ActiveDocument.ExportAsFixedFormat OutputFileName:=filePath & pdfName & ".pdf", _
    ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _
    wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _
    Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _
    CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _
    BitmapMissingFonts:=True, UseISO19005_1:=False

End Sub 
```

将文件保存为 PDF 的代码是我从我 SaveAs-ing 记录的宏中获取的。实际的文件路径要长得多，但为了简单起见，我将其命名为“C:\”（这也不起作用）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:44:29.587

您在 Cell1,2 和 2,2 中的 ActiveDocument 中的文本可能包含特殊字符。如果您没有看到任何 Windows 保留字符，例如 \ / : * ？" < > | 那么你可能有一个奇怪的隐藏或白色字符。

此外，如果 DATE 有 : 在其中，那么它不会保存。您必须删除所有保留的字符，因为 Windows 文件名不能包含以下任何字符： \ / : * ? " < > |

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T20:08:55.473

这将去除不需要的字符：

```
Function CleanFilename(CurrentFilename As String) As String
Dim MyArray()
Dim x As Integer

    MyArray = Array("<", ">", "|", "/", "*", "\", "?", """", ":")
    For x = LBound(MyArray) To UBound(MyArray)
        CurrentFilename = Replace(CurrentFilename, MyArray(x), "_", 1)
    Next x
    CleanFilename = CurrentFilename
End Function 
```

我不建议在完全限定的路径名​​上运行它，但是在`pdfName`, else上`C:\test.pdf`会变成`C__test.pdf`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T13:28:18.673

好吧，我主要解决了这个问题。我不知道它为什么/在哪里这样做，但它正在添加一个“下一行”字符（Chr（13））。因此，在告诉它保存文件之前，我插入了以下行：

```
pdfName = Replace(pdfName, Chr(13),"") 
```

现在它可以毫无问题地保存。我的同事正在帮助我解决这个问题，他发现如果你采取：

```
pdfNameLen = Len(pdfName) 
```

它返回的长度比您计算可见字符的长度多 2（因为有 2 个单元格条目）。他曾经：

```
Left(*cell text*, Len(*cell text*) - 2) 
```

对于它收集两个单元格值的位置，唯一的区别是在最后（-2而不是-1，以摆脱单元格格式和Char（13））。与此同时，我们说“明白了！”。

谢谢大家，帮忙！最终代码：

```
Option Explicit

Private Sub cmdSave_Click()

Dim equipName As String, equipError As String, fileDate As String, pdfName As String, filePath As String, pdfLen As Integer

filePath = "C:\"
equipName = Replace(Left(ActiveDocument.Tables(1).Cell(1, 2).Range.Text, _
    Len(ActiveDocument.Tables(1).Cell(1, 2).Range.Text) - 1), "/", "-")
equipError = Left(ActiveDocument.Tables(1).Cell(2, 2).Range.Text, Len(ActiveDocument.Tables(1).Cell(2, 2).Range.Text) - 1)
fileDate = Replace(Date, "/", "")
pdfName = equipName & "_" & equipError & "_" & fileDate

pdfName = Replace(pdfName, Chr(13), "")

ActiveDocument.ExportAsFixedFormat OutputFileName:=filePath & pdfName, _
    ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _
    wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _
    Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _
    CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _
    BitmapMissingFonts:=True, UseISO19005_1:=False

End Sub 
```

# actionscript-3 - 升级到 Mountain Lion 后，Flex 应用程序无法在手机上加载

> ID：12184453
> 
> 赞同：2
> 
> 时间：2012-08-29T18:40:35.590
> 
> 标签：actionscript-3, flash, air, flash-builder, osx-mountain-lion

我使用 Adob​​e Air/Flash Builder 为市场上的 android 应用程序开发了两个 air ..

我刚刚购买了一台带有 Mountain Lion 的新 Mac 笔记本电脑，这是对我旧机器的一次重大升级。

问题是，当我将旧项目文件夹加载到新机器上的 Flash Builder 4.6 中时，它们编译得很好，没有错误。

当我点击运行时，它开始像往常一样将应用程序导出到 Android 设备，然后它使设备的屏幕变黑，就像应用程序正在启动一样......然后崩溃。

如果我点击调试，它会开始连接倒计时并且永远不会连接到调试器。然后它变黑并像以前一样崩溃。

它根本没有给我任何错误。我无法在模拟器中运行它，因为它有破坏它的扩展。

作为一个测试，我开始了一个新项目并在我的手机上运行它，它运行良好。所以只有旧项目不起作用..

疯狂的是完全相同的项目文件夹，如果我把它放在 USB 驱动器上，把它放在我的旧电脑上，或者我的朋友 Macbook with Lion 上，将它导出到 android 到同一个 Android 设备......它可以工作！......

我已经尝试过以下方法：

*   重新安装 flashbuilder 4.6，安装 4.7 并用它进行测试
*   从svn下载项目，直接从外部硬盘下载，看看是不是svn错误
*   删除了项目文件夹中可能包含机器特定信息的所有隐藏文件
*   以相同的名称开始一个新项目，手动重新创建所有文件夹并将每个单独的文件粘贴到其中
*   在多个设备上测试它是否只是我的手机

任何帮助将不胜感激，我完全不知所措，因为这些项目可以在我的旧电脑上使用 Snow Leopard，我朋友的电脑上使用 Lion，但根本无法在我的电脑上运行！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T07:30:16.447

> 在多个设备上测试它是否只是我的手机

结果如何？

您是否确保安装了正确的[USB 驱动](http://help.adobe.com/en_US/flex/mobileapps/WSa8161994b114d624-33657d5912b7ab2d73b-7fdf.html#WSa8161994b114d624-33657d5912b7ab2d73b-7fdc)程序以在 android 设备上进行远程调试？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:03:59.787

通常，当应用程序在本地进行测试时，它会尝试跨越一个或多个沙箱，尤其是在安全领域。加载本地资产与网络 URL 资产等。

据我所知，它今天仍然适用，但是如果您将开发文件夹放在“受信任”空间中，您的应用程序将获得更多自由。我假设 mac 世界要么相同，要么具有非常接近的等价物，但 PC 路线是 R-单击正在运行的闪存应用程序 > 全局设置 > 安全管理器 > 并将您的工作区添加到受信任的空间。

这可能会让你更快地到达那里：http: [//www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html](http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html)

如果它在你朋友的同等 cpu 上运行，你运行的是什么播放器版本与他/她运行的是什么？

# ios - 将字符串格式的日期转换为字符串日期前一天的 nsdate 结果

> ID：12184454
> 
> 赞同：4
> 
> 时间：2012-08-29T18:40:42.853
> 
> 标签：ios, nsdate

我搜索了我的问题，但没有找到任何相关的帮助...

故事：用户按名称、开始日期、结束日期和注释创建一个继续事件，因此将所有字段保存在 Sqlite 数据库中。两种日期格式均为“yyyy-MM-dd”。之后，当用户想要对事件执行操作时，应用程序会检查用户通过开始和结束日期选择的日期，以及输入的日期是在开始日期之前还是在结束日期之后通知用户。

问题：作为用户，我创建了一个从 18-8-2012 到 18-9-2012 的事件。然后我在 2012 年 8 月 18 日登录并收到通知。我调试了应用程序。我很惊讶。格式为“yyyy-MM-dd”的字符串中的日期对象是“2012-08-17 19:30:00 +0000”。代码是：

```
 #define kPickerDate @"yyyy-MM-dd"
           NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
           [formatter setDateFormat:kPickerDate];
           NSDate *sDate = [formatter dateFromString:start_date]; 
           NSDate *eDate = [formatter dateFromString:exam_date]; 
```

应用程序如何????????????????

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-29T19:55:13.213

An`NSDate`不仅仅是一个日期，也是一个时间。

您需要在每个阶段进行检查：

*   **解析时您的日期是否正确构建？**它应该是 UTC 午夜，而不是本地午夜。您可能正在`NSDateFormatter`为此使用 a 。确保它的时区设置为 UTC。
*   **您的日期是否正确存储在 SQLite 中？**同样，请确保将其存储为 UTC。但是，如果您正确解析它，则应该可以。
*   **您是否正确格式化输出？** 可能`NSDateFormatter`为此使用 a 。确保它的时区设置为 UTC。

只有当所有三个部分都完美时，您才能在这里摆脱潜在的错误。

要设置日期格式化程序的时区，请使用：

```
formatter.timeZone = [NSTimeZone timeZoneWithAbbreviation: @"UTC"]; 
```

不要试图通过采用当地时间来解决这个问题。

当地时间的问题：

*   在许多时区，时间每年会随着夏令时变化几次。一小时的差异会将您时间的日期部分抛到前一天！
*   如果用户处于没有夏令时的时区，他们可能会前往不同的时区。同样，您的时间中的日期部分可能会被丢弃一天。

唯一安全的做法是在任何地方使用 UTC。

（实际上我有点同情住在 UTC 的人；他们没有被迫从他们的应用程序中清除这些错误！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:47:57.650

您可以使用更好的方法创建 NSDate 对象。首先修改 NSDate 的@interface（你可以在任何地方这样做）。为此，请将其放在头文件中。

```
@interface NSDate (missingFunctions) 
+ (NSDate *)dateWithYear:(NSInteger)year month:(NSInteger)month day:(NSInteger)day;
@end 
```

然后在主文件中放：

```
@implementation NSDate (missingFunctions)
+ (NSDate *)dateWithYear:(NSInteger)year month:(NSInteger)month day:(NSInteger)day {
    NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    NSDateComponents *components = [[NSDateComponents alloc] init];
    [components setYear:year];
    [components setMonth:month];
    [components setDay:day];

    //BUT MOST IMPORTANTLY:
    [components setTimeZone:[NSTimeZone localTimeZone]];
    [components setHour:hour];
    [components setMinute:minute];
    [components setSecond:second];

    return [calendar dateFromComponents:components];
}   
@end 
```

然后从代码调用中的任何地方（例如）：

```
[NSDate dateWithYear:1969 month:8 day:15]; 
```

它将根据您的请求在正确的时区返回 NSDate。您还可以通过阅读官方苹果文档中有关[NSTimeZone的更多信息来更改要使用的时区。](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSTimeZone_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSTimeZone)

**请注意**，我不能因为编写此代码而受到赞扬，但我可以保证它可以正常工作。

# javascript - 我如何链接这些功能，以便一旦完成，下一个触发？

> ID：12184455
> 
> 赞同：1
> 
> 时间：2012-08-29T18:40:43.650
> 
> 标签：javascript, jquery

如果我有一个 div 可以清除其中的内容，但又想在其中放一些新的东西，我该如何将这些函数串起来，以便只有在前一个函数完成后才会触发

```
$('#nner_container').fadeOut(300, function(){

    $('#header_div').after('<div id="inner_container" style="dispay:none"></div>');
       //when this insertion of inner_container completes, fill it with some content
       //and when that completes, fadeIn inner_container

}); 
```

大多数 jquery 函数似乎都将附加函数作为最终参数，我认为它正是用于此目的。但不是这样`after()`。还是我做错了什么。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:44:03.010

添加新 div 后，只需淡入`inner_container`：

```
$('#inner_container').fadeOut(300, function(){

    $('#header_div').after('<div id="inner_container" style="dispay:none"></div>');
    $('#inner_container').fadeIn(300);
}); 
```

该`after`函数是同步的，这意味着在前一条语句完成之前，下一条语句不会执行。

另一方面，`fadeOut`异步`fadeIn`执行，这意味着下一条语句可能在效果完成之前执行。这就是为什么`fadeOut`and`fadeIn`函数需要在效果完成时执行回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:44:16.930

如果要替换内容，请尝试 .replaceWith() 函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:44:36.210

由于`.after`立即完成，因此不需要（或没有）回调，您可以通过将接下来要执行的操作放在下一行来链接它；

```
$('#inner_container').fadeOut(300, function(){    
    $('#header_div').after('<div id="inner_container" style="dispay:none"></div>');
    $('#inner_container').fadeIn(300);
}); 
```

异步方法通常是可能需要一段时间的方法，例如在这种情况下`FadeIn`，`FadeOut`需要一定的时间才能完成。大多数（如果不是全部）不是动画的 DOM 操作函数实际上是同步的，并且可以编码为没有回调的经典代码。

# css - 如何让另一个图像出现在悬停时

> ID：12184456
> 
> 赞同：0
> 
> 时间：2012-08-29T18:40:45.630
> 
> 标签：css, hover

这可能是一个简单的问题，但我似乎无法理解它的工作。这是基本设置（我错过了所有定位等，因为它不相关）：

```
<div id="wrapper">
<img class="album-pic-exit" src="images/exit.jpeg"> 
<img class="album-pic" src="images/blank.gif">
</div>

#wrapper.album-pic-exit { display:none; } 
#wrapper.album-pic:hover +.album-pic-exit { display:block } 
```

基本上，当光标悬停在“album-pic”上时，会出现“album-pic-exit”。我设法通过让“..exit”成为悬停时的非重复背景来完成这项工作，但是，我认为那是不干净的，肯定有一个更简单更直接的解决方案。我对此相对较新，但我相信我通过查看和试验自己而不是求助于谷歌来更好地工作，所以如果语法全错，我的坏事。ps我最好想要一个css而不是javascript或jquery的演练解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:49:44.283

你可以这样做；但是，您将不得不切换两个图像的顺序，如下所示：

```
<div id="wrapper">
  <img class="album-pic" src="images/blank.gif">
  <img class="album-pic-exit" src="images/exit.jpeg">
</div> 
```

然后使用这个 CSS：

```
.album-pic-exit {
  display: none;
}
.album-pic:hover + .album-pic-exit {
  display: inline;
} 
```

首先，我们用 隐藏`exit`图像`display: none`。然后，当另一张图像悬停在上面时，我们使用相邻兄弟选择器`+`来选择图像。`exit`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:51:54.187

很多可能性 :) 首先，CSS 中没有反向选择器，因此对于您的 CSS，您需要以下 HTML：

```
 <div id="wrapper">
    <img class="album-pic" src="images/blank.gif">
    <img class="album-pic-exit" src="images/exit.jpeg"> 
    </div> 
```

无论如何，这会更好：

```
<div id="wrapper"></div>

    #wrapper {
              width:ALBUM_PIC_WIDTH;
              height:ALBUM_PIC_HEIGHT;
              background:url(ALBUM_PIC_URL) 0 0 no-repeat;
}

#wrapper:hover {
              background:url(ALBUM_PIC_EXIT) 0 0 no-repeat;
} 
```

（当然，填写大写内容的 URL。）如果您需要这两个图像来解决编码问题，您也可以谷歌搜索“javascript rollover tutorial”。

询问您是否有问题:) Cheerz Simon

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:46:40.950

[Amazing Hover Effects with CSS3 是一个很好的教程：](http://bavotasan.com/2011/amazing-hover-effects-with-css3/) .
CSS：

```
 div.shadow {
    width: 300px;
    margin: 20px;
    border: 1px solid #ccc;
    padding: 10px;
    }
div.shadow:hover {
    -moz-box-shadow: 0 0 5px rgba(0,0,0,0.5);
    -webkit-box-shadow: 0 0 5px rgba(0,0,0,0.5);
    box-shadow: 0 0 5px rgba(0,0,0,0.5);
    } 
```

HTML：

```
 <div class="shadow">
Ut vulputate sem venenatis magna commodo ac semper nibh mollis. Pellentesque suscipit metus non lacus lacinia sed porttitor metus suscipit. Aenean egestas augue vel sem tincidunt scelerisque. Sed ullamcorper convallis arcu, vel euismod urna egestas in.
</div> 
```

# python - 使用非 python 的 pickle 二进制格式（使用 celery 和 rabbitmq）

> ID：12184460
> 
> 赞同：5
> 
> 时间：2012-08-29T18:41:10.260
> 
> 标签：python, rabbitmq, celery, pickle

我正在使用 Python、Celery 和 RabbitMQ 从松散耦合的系统中生成消息。但是，我担心互操作性。

当直接从 celery 生成的 RabbitMQ 检查消息有效负载时，我得到以下二进制格式：

![芹菜输出的二进制版本](../Images/1676ea7c2dc8ca04ca0cbd65231e5cf7.png)

我强烈怀疑这是一种二进制泡菜格式。但是，我一般很难找到有关二进制泡菜格式的信息。

所以，我真的有几个问题：

1.  这是二进制泡菜格式吗？
2.  有哪些资源可用于映射二进制格式？
3.  鉴于 celery 实际上会产生腌制数据，如果我想使用来自非 python 消费者（例如 c++ 或 php）的这些消息，我可以使用哪些选项？
4.  您是否有使用 Celery、RabbitMQ 以及与其他非 python 消费者进行互操作的经验。你对这个主题有什么建议吗？

提前致谢...

**更新：**

根据 Brendan 的建议，我已将其切换为 JSON 序列化程序：

```
add.apply_async(args=[10, 10], serializer="json") 
```

作为未来搜索者的参考，在这种特定的空情况下，JSON 格式似乎大了大约 15%（或 28 个字节）：

![来自 celery 的 JSON 序列化版本](../Images/8f270a682e872f36cef426dbe1f156eb.png)

此外，对于可能有兴趣从 C++ 中读取 pickle 格式的人，我发现这个问题很有帮助： [如何从 C 中读取 python pickle 数据库/文件？](https://stackoverflow.com/questions/1296162/how-can-i-read-a-python-pickle-database-file-from-c)

**更新 2：**

根据 Asksol 的建议，我尝试了 zlib 压缩：

```
async_result = add.apply_async( (x, y), compression='zlib' ) 
```

我认为有一些有趣的结果，所以他们在这里：

![格式对照表](../Images/f29ab5427e499b44f0c14bb86656d94b.png)

正如您在此示例中看到的，Pickle 格式小于 JSON。但是，当将压缩添加到组合中时，压缩后的 JSON 实际上比任何一个版本的 Pickle 都要小。我也很好奇这两种格式的解析时间。虽然 JSON 旨在提高解析器的性能，但 Pickle 是基于偏移量的，这意味着它不必被迭代。我想知道是否有人对这两种格式进行了任何性能基准测试，包括压缩和不压缩，并考虑了解析 CPU 时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:47:03.093

[根据文档](http://celery.github.com/celery/userguide/executing.html#serializers)，您可以让 Celery 改用 JSON。我建议这样做，因为它非常标准，无论您使用哪种语言。如果您使用大量二进制数据，则可能会增加消息的大小。

> 客户端和工作人员之间传输的数据需要序列化。默认序列化程序是 pickle，但您可以全局更改它或为每个单独的任务更改它。内置对 pickle、JSON、YAML 和 msgpack 的支持，您还可以通过将自定义序列化程序注册到 Kombu 序列化程序注册表中来添加自己的自定义序列化程序（请参阅 Kombu：数据序列化）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T18:51:41.983

1.  从[`pickletools`](http://docs.python.org/py3k/library/pickletools.html)模块的示例中，我推断这确实是一个泡菜流。
2.  格式没有准确记录。其实有好几个版本。但是您可以使用 pickletools 脚本（见上文）来分析 pickle 文件。
3.  您不能使用其他语言的 pickle 数据。该格式是高度特定于 Python 的，实际上执行 Python 代码（至少是对象构造）。
4.  我没有。Brendan Long 似乎找到了解决方案。您仍然需要一些专用代码来解析另一端的 JSON 消息（特别是如果您需要传输任何复杂的结构），但它不应该太难（尽管可能很脆弱）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:52:12.600

默认情况下，Celery 使用 pickle 来序列化消息。

[http://celery.github.com/celery/userguide/calling.html#calling-serializers](http://celery.github.com/celery/userguide/calling.html#calling-serializers)

如果要使用基于文本的序列化，可以将序列化程序更改为 json 或 jaml。

# ruby-on-rails - 仅当有文件扩展名时如何验证文件扩展名？回复：载波

> ID：12184463
> 
> 赞同：7
> 
> 时间：2012-08-29T18:41:18.853
> 
> 标签：ruby-on-rails, validation, ruby-on-rails-3.2, carrierwave, image-uploading

我正在使用[CarrierWave](https://github.com/jnicklas/carrierwave)，我想验证文件名，并且仅在扩展名为`.gif`, `.png`, `.jpg`,*或没有文件扩展*`.jpeg`名的情况下才允许文件上传。

 *有时用户上传没有扩展名的文件。例如：

[http://t2.gstatic.com/images?q=tbn:ANd9GcTCD2TLvYI8a4ChgBaYK_JaRfedvXLr3HXQfj0arXXAii3o2yjf](http://t2.gstatic.com/images?q=tbn:ANd9GcTCD2TLvYI8a4ChgBaYK_JaRfedvXLr3HXQfj0arXXAii3o2yjf)

我知道在 中取消注释以下行的可能性`uploaders/image_uploader.rb`，但我不知道另外说“*仅当存在文件扩展名时才允许任何这些扩展名*”的方式。

```
# Add a white list of extensions which are allowed to be uploaded.
# For images you might use something like this:
#def extension_white_list
#  %w(gif jpg jpeg png)
#end 
```

同样，在我的模型中，我进行了如下验证，但由于某种原因`bad-extension.bad`通过了。

```
validates :image, allow_blank: true, format: {
    with: %r{\.(gif|jpe?g|png)\z}i,
    message: 'must be a GIF, JPG, or PNG'
}, if: :filename_has_extension?

def filename_has_extension?
  image =~ /\./
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T17:27:54.353

那么为什么不在验证过程中使用文件的 Mimetype 比较有 ruby​​ gem call mimetype 可以帮助您完成任务

像这样的东西

```
AVAILABLE_MIMETYPE = %w(image/gif)

validate :mime_type_of ,:if => :if_changed?

private
def mime_type_of
  AVAILABLE::MIMETYPE.include?(MIME::Types.type_for[image_path][0]) 
end

def if_changed?
  new_record? or image_changed?
end 
```

甚至 CarrierWave 也包含 MimeType Gem 内部检查是否也有帮助

希望这个帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:15:11.537

`image`不是 a `String`，而是属于`ImageUploader`( `class ImageUploader < CarrierWave::Uploader::Base`) 类。

因此，这条线有问题：

```
image =~ /\./ 
```

通过将其转换为来更正它`String`：

```
image.to_s =~ /\./ 
```

也就是说，更好的表达方式是：

```
!(image.to_s =~ /\.[a-z]{1,4}\z/).nil? 
```

它确保扩展名由一到四个`a-z`字符组成。此外，如果没有找到， [=~](http://ruby-doc.org/core-1.9.3/String.html#method-i-3D-7E)返回`nil`，并且这一行考虑到了这一点。

如果*未*找到扩展名，则`=~`返回`nil`；所以`.nil?`会回来`true`；并将`!`其反转为`false`; 从而表明*没有*扩展。

另一方面，如果有*扩展*，则`=~`返回匹配开始的位置；哪个是`0`或更大，哪个*不是* `nil`；所以`.nil?`会回来`false`；当被 反转时`!`，`true`返回；从而表明存在*扩展*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-08T19:29:15.903

就我而言，我只是更改了我的 avatar_uploader.rb：

```
 def extension_white_list
    %w(jpg jpeg gif png) if model.avatar.file.extension.present?
  end 
```

:)*

# java - 绕过循环？

> ID：12184467
> 
> 赞同：4
> 
> 时间：2012-08-29T18:41:34.410
> 
> 标签：java, while-loop

所以我是一年级的comp sci学生，我必须创建一个程序，它需要一个数组对其进行打乱，然后再次对其进行排序。我几乎已经让它工作了，但由于某种原因，我的一个 while 循环将无法工作并且被完全绕过。我在这方面真的很新，所以所有的帮助都是值得的。我有排序和打印工作，争夺只是给我一些麻烦。

```
import java.io.*;
import java.util.Random;
public class Driver03
    {
     public static void main(String[] args)
      {
        int[] array = {100, 101, 102, 103, 104, 105, 106, 107, 108, 109};
        print(array);
        array = scramble(array);
        print(array);
        array = sort(array);
        print(array);
      }
      public static void print(int[] apple)
        {
            for(int x = 0; x < apple.length; x++){
                System.out.println(apple[x]+"");
                }
        }
      public static int max;
      public static int maxIndex;
      public static int temp;
      public static int[] sort(int[] grape)
        {
            for(int y = grape.length; y > 0; y--){
            for(int x = 0; x < y; x++)
              if (x==1){
                    if (grape[x] > grape[x-1]){
                        max = grape[x];
                        maxIndex = x;
                        }
                    else{
                        max = grape[x-1];
                        maxIndex = x - 1;
                        }
                    }
                 else{
                    if (grape[x] > max){
                        max = grape[x];
                        maxIndex = x;
                        }
                    }
                 temp = grape[maxIndex];
                 grape[maxIndex] = grape[y-1];
                 grape[y-1] = temp; 
                }
            return grape;
        }
     public static int temp1;
     public static boolean t;
     public static boolean u;
     public static int[] numbers;
     public static int[] tangerine;
     public static int[] scramble(int[] orange)
        {
        numbers = new int[10];
        tangerine = new int[10];
        Random rand=new Random();

        for(int x = 0; x < orange.length; x++){
            t=false;
            while (t=false){ //For some reason being bypassed
                int randn = rand.nextInt(9);
                for(int y = 0; y < numbers.length; y++){
                    if (numbers[x]==randn)
                        u = true;
                    }
                if (! (u==true))
                    {
                    numbers[randn] = randn;
                    tangerine[randn] = orange[x];
                    t = true;
                    }
                }           
            }
          return tangerine;
        }

    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T18:59:46.880

`t=false`将值分配`false`给`t`并评估为新值。因此，您刚刚编写了`while (false)`.

比较相等时，您需要使用`==`.

但是，在布尔值的情况下，使用`while (!t)`. 这既更具可读性，又不太可能因为错过第二个而出错`=`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T18:59:28.310

一个等号：`x = 4`用于为变量赋值。

两个等号：`x == 6`用于测试一个变量是否等于一个值。

* * *

if 语句中的某些语法是非正统的。

这很奇怪

`if (! (u==true))`

您可以改用它：

`if (!u)`

更好的是，您可以使用描述性变量名称并使其更具可读性：

```
if (!found) {
    shuffleItems();
} 
```

注意它的可读性：*如果没有找到，随机播放项目。*

现在你的代码文件本身！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:53:29.773

采用：

```
while (! t){ 
```

并记住使用 == 来比较值:)

# cocos2d-iphone - 在 tick 方法中破坏和重建关节

> ID：12184469
> 
> 赞同：0
> 
> 时间：2012-08-29T18:41:36.190
> 
> 标签：cocos2d-iphone, box2d, box2d-iphone

我创建了一个weldJoint 并将其销毁（请参阅下面代码中的更新方法）。在破坏焊接接头时，我设置了线速度以使一个物体朝向另一个物体，从而创建另一个焊接接头。焊缝永远不会被重新创建。我确信这是因为以下几行：

```
if (weldJoint == NULL) return;

world->DestroyJoint(weldJoint);
weldJoint = NULL; 
```

在代码中。因为在下一个时间步中它已经为 NULL，所以它不会创建焊接接头。起初我在破坏关节后尝试使用 break 语句，但我得到一个指向该行的 EXC_BAD_ACCESS 错误：

```
world->DestroyJoint(weldJoint); 
```

如何创建销毁并重新创建焊接接头？

更新方法：

```
-(void) update: (ccTime) dt
{

int32 velocityIterations = 8;
int32 positionIterations = 1;

// Instruct the world to perform a single step of simulation. It is
// generally best to keep the time step and iterations fixed.
world->Step(dt, velocityIterations, positionIterations);

// using the iterator pos over the set
std::set<BodyPair *>::iterator pos;

for(pos = bodiesForJoints.begin(); pos != bodiesForJoints.end(); ++pos)
{

b2WeldJointDef weldJointDef;

BodyPair *bodyPair = *pos;
b2Body *bodyA = bodyPair->bodyA;
b2Body *bodyB = bodyPair->bodyB;

weldJointDef.Initialize(bodyA, bodyB, bodyA->GetWorldCenter());

weldJointDef.collideConnected = false;
weldJoint = (b2WeldJoint*) world->CreateJoint(&weldJointDef);

// Free the structure we allocated earlier.
free(bodyPair);

// Remove the entry from the set.
bodiesForJoints.erase(pos);
}

for(b2Body *b = world->GetBodyList(); b; b=b->GetNext())    {
if (b->GetUserData() != NULL)
{
    CCSprite *mainSprite = (CCSprite*)b->GetUserData();
    if (mainSprite.tag == 1) {
        mainSprite.position = CGPointMake( b->GetPosition().x * PTM_RATIO, b->GetPosition().y * PTM_RATIO);
        CGPoint mainSpritePosition = mainSprite.position;
        if (mainSprite.isMoved) {

                    if (weldJoint == NULL) return; 

                    world->DestroyJoint(weldJoint);
                    weldJoint = NULL;

                    b2Vec2 velocity = b2Vec2(3.5, 2.2);
                    b->SetLinearVelocity(velocity);  

                }
        }
    }
}

} 
```

# javascript - Twitter Bootstrap 和 Javascript 加载中的活动选项卡

> ID：12184470
> 
> 赞同：0
> 
> 时间：2012-08-29T18:41:36.770
> 
> 标签：javascript, dom, javascript-events

我正在将 Twitter Bootstrap 用于选项卡式内容，但在加载另一个 javascript 库时遇到问题。本质上，允许缩放地图的 javascript 不会加载，除非它包含的选项卡是“活动的”。我猜这与它不可见或 DOM 的一部分有关，但我对 DOM 和 javascript 加载的理解非常少。

基本结构：

```
<div class="tab-content">
<div class="tab-pane" id="1">
     <script>....</script>
     <div id="zoom_container">
          <img src="..."/ id="bradley"> #the script alters this image
     </div>
</div>
<div class="tab-pane active" id="2">
     <script type="text/javascript">
       $('#second').ready(function($){
       $('#monde').smoothZoom({
        width:888,
        height:250                      
         })
        });
     </script>
     <div id="zoom_container2">
         <img src="..."/ id="monde"> #the script alters this image
     </div>
</div> 
```

“活动”的“选项卡窗格”中的代码加载得很好，但是当单击选项卡到其他窗格时，javascript 不会修改图像。有什么想法吗？这是标签如何加载的结果吗？

我能想到的唯一替代方法是使用 Ajax 加载内容，但我有点喜欢当前的设置，并且很乐意让这项工作发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T14:18:50.037

谢谢你的帮助克里斯，你给了我继续前进的力量。认为我解决了它，尽管我打赌仍然有一个更简单的方法。我做了以下事情：

1）为每个地图/脚本定义的功能：

```
function tour1Map(){
$('#bradley').smoothZoom({
    ...
    });
}; 
```

2）在每个标签导航链接下添加了以下脚本：

```
<a href="#tour1_pane" data-toggle="tab" id="tour1">Link Text</a>
<script>
    $("#tour1").click(function() {
        tour1Map();
    }); 
</script> 
```

这样，当包含图像的选项卡被加载时，脚本就会立即执行。仍然不确定“display：none”是否是罪魁祸首，但它确实有效。

# java - Java：为什么不能代表+128？

> ID：12184471
> 
> 赞同：4
> 
> 时间：2012-08-29T18:41:37.270
> 
> 标签：java, bitset

这部分代码应该返回以 LittleEndian 表示的 10000000，然后是 128，但它返回 -128。我知道 128 在二进制表示中与 -128 相同，但为什么不能表示 128？

```
BitSet bset = new BitSet();
bset.set(7);
byte[] bitarray = bset.toByteArray();
for (byte b: bitarray)
 System.out.println(b); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:42:59.220

因为Java中只有有*符号*整数类型。8 位 10000000 [2]字节的第一位是 1，[表示负数](http://en.wikipedia.org/wiki/Two%27s_complement)。因此`byte`Java中的类型范围是<-128；127>。看一下这个：

```
byte b = 127;
byte b2 = (byte)(b + 1);  //-128 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T18:43:21.047

Java 仅支持带符号[的 short/byte/integer/long](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)。

> byte：byte 数据类型是一个 8 位有符号二进制补码整数。它的最小值为 -128，最大值为 127（含）。字节数据类型可用于在大型数组中节省内存，其中内存节省实际上很重要。它们也可以用来代替 int ，它们的限制有助于澄清您的代码；变量范围有限的事实可以作为一种文档形式

# ios - 我是否需要实施两个内容存储/交付系统？

> ID：12184472
> 
> 赞同：1
> 
> 时间：2012-08-29T18:41:37.493
> 
> 标签：ios, in-app-purchase, ios6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:56:28.443

您不需要为您的 IAP 使用 Apple 的内容托管，即使在 iOS 6 中也是如此。

如果您的应用需要 iOS 6，您可以只使用 Apple 的内容托管。

如果您的应用程序在 iOS 6 之前的 iOS 版本上运行，您可能会发现将您的内容专门托管在您自己的服务器上（或专门将可购买的内容嵌入到您的应用程序中）最容易，即使用户有，也不要使用 Apple 的内容托管iOS 6。

# ios - iOS 应用程序开发 - 应用程序电子邮件订阅表单的规则？

> ID：12184475
> 
> 赞同：1
> 
> 时间：2012-08-29T18:41:47.003
> 
> 标签：ios, iphone

我想知道Apple是否有任何规则将电子邮件订阅表单集成到移动应用程序中，用户可以提交他们的电子邮件地址以接收有关应用程序的更新？我搜索了有关 iOS 应用程序开发的各种规则，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:48:36.073

这根本不应该是一个问题，因为用户知道他们正在为时事通讯输入他们的电子邮件地址。现在，如果您在应用程序打开时提示用户输入他们的电子邮件，而没有明确指示他们将订阅电子邮件列表，那么 Apple 可能会遇到问题。

为什么这不应该成为问题的一个例子是因为像 OpenFeint 这样的服务，它要求您提供电子邮件地址并让您注册他们的服务。

# sql - SQL Server 2005 需要在查询中创建假列

> ID：12184476
> 
> 赞同：2
> 
> 时间：2012-08-29T18:41:46.767
> 
> 标签：sql, sql-server, sql-server-2005, reporting-services, crystal-reports

嗨，这将是一个非常奇怪的问题，我的所有搜索都没有得到好的答案。基本问题将帮助我解决两个问题，一个在 Crystal Reports 中，一个在 SSRS 2005 中。我有两个需要相同解决方案的报表。请耐心等待，因为解释会有点冗长。

我需要以一种不寻常的方式使用 SSRS。我需要创建的报告将只有最少的数据，并且将在现场打印和手动填写。在这种情况下，它们被用作表单打印程序。

报告将有一个 tablix/Matrix 控件，我需要使用特定的列数来创建它，无论这些列是否存在数据。在一种情况下（SSRS），没有任何字段被用作将被求和的数据字段。

我有行和列的数据，但我需要创建 10 列的矩阵/tablix。因此，如果记录集只有 2 个构成列的数据实例，我仍然希望看到所有 10 列，但标题为空白。

所以它看起来像这样：

```
 Col1|Col2|Col3|Fake1|Fake2|Fake3|......
Row1
Row2
Row3
..... 
```

因此，如果我有 1 列或 10 列的数据，我仍然希望显示 10 列，其中 2 列带有真实标题，8 列带有空白标题。

这是我正在使用的 SQL。这是 SSRS 2005 中矩阵的基础。员工 ID 和姓名是行。JobAccount_Tracking_ID 是列。一条记录可以有 1 到 10 个 tracking_id。

我要返回的是总共 10 个跟踪 ID，而不管实际跟踪 ID 的数量是多少。额外内容将在矩阵中显示为空白列。

```
Declare @FieldLogID as int
Set @FieldLogID = 1018

SELECT DISTINCT
CustomizedFieldLogEmployee_1.Employee_EmployeeID, 
CustomizedFieldLogEmployee_1.Employee_FullName, 
CustomizedFieldLogEmployee_1.Injured_Today_Custom, 
CustomizedFieldLogJobAccount_1.JobAccount_TrackingID, 
CustomizedFieldLogEmployee_1.StartDateTime, 
CustomizedFieldLogEmployee_1.StopDateTime, 
CustomizedFieldLogEmployee_1.WorkHours
FROM
CustomizedFieldLogEmployee AS CustomizedFieldLogEmployee_1 LEFT OUTER JOIN CustomizedFieldLogJobAccount AS CustomizedFieldLogJobAccount_1 
ON CustomizedFieldLogEmployee_1.FieldLog_FieldLogID = CustomizedFieldLogJobAccount_1.FieldLog_FieldLogID
WHERE CustomizedFieldLogEmployee_1.FieldLog_FieldLogID = @FieldLogID 
```

任何想法我怎么能做到这一点？在 SSRS 案例中，我无法在数据库中创建视图，因为它是供应商的数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T04:42:34.780

所以这是逻辑：

1.  将主查询联合到包含 10 个附加联合的子查询（假设最大值为 10）。10 个工会将使用虚假的 TrakingID。zzz01 到 zzz10 在这种情况下确保它们在排序中显示在最后。如果 TrackingID 是整数，请使用 9999990 到 9999999。
2.  将整个内容包含在一个外部查询中，该查询使用诸如 Row_Number() 之类的排名函数通过在 userID 上对行进行分区并在 TrackingID 上排序来对行进行排名。zzz 或 999999 将确保假货排在最后。
3.  将整个内容再次包含在另一个外部查询中，该查询使用 where 子句中的排名函数来获取前 10 个。这将为您提供现有的跟踪 id 以及剩余的最多 10 个假的。

这是代码：

```
Declare @FieldLogID as int
Set @FieldLogID = 1018

Select Employee_EmployeeID,
Employee_FullName,
Injured_Today_Custom,
Case when JobAccount_TrackingID like'zzz%' then Null else JobAccount_TrackingID end as JobAccount_TrackingID,
StartDateTime, 
StopDateTime, 
WorkHours
from 
(
Select row_number() over (partition by Employee_EmployeeID order by JobAccount_TrackingID) row,*
from 
(
SELECT DISTINCT
CustomizedFieldLogEmployee_1.Employee_EmployeeID, 
CustomizedFieldLogEmployee_1.Employee_FullName, 
CustomizedFieldLogEmployee_1.Injured_Today_Custom, 
CustomizedFieldLogJobAccount_1.JobAccount_TrackingID, 
CustomizedFieldLogEmployee_1.StartDateTime, 
CustomizedFieldLogEmployee_1.StopDateTime, 
CustomizedFieldLogEmployee_1.WorkHours
FROM
CustomizedFieldLogEmployee AS CustomizedFieldLogEmployee_1 LEFT OUTER JOIN CustomizedFieldLogJobAccount AS CustomizedFieldLogJobAccount_1 
ON CustomizedFieldLogEmployee_1.FieldLog_FieldLogID = CustomizedFieldLogJobAccount_1.FieldLog_FieldLogID
WHERE CustomizedFieldLogEmployee_1.FieldLog_FieldLogID = @FieldLogID
Union
Select Distinct 
Employee_EmployeeID,
Employee_FullName,
null as Injured_Today_Custom,
fake_TrackingID,
null as StartDateTime, 
null as StopDateTime, 
null as WorkHours
FROM
CustomizedFieldLogEmployee
cross join
(
Select 'zzz01' fake_TrackingID
union Select 'zzz02' 
union Select 'zzz03' 
union Select 'zzz04' 
union Select 'zzz05' 
union Select 'zzz06' 
union Select 'zzz07' 
union Select 'zzz08' 
union Select 'zzz09' 
union Select 'zzz10' 
) a where FieldLog_FieldLogID = @FieldLogID
) b 
) c where Row<=10 
order by Employee_EmployeeID,JobAccount_TrackingID 
```

# java - 使用相同的端口（80）运行多个 java jetty 实例

> ID：12184479
> 
> 赞同：7
> 
> 时间：2012-08-29T18:41:58.703
> 
> 标签：java, webserver, jetty, subdomain, virtualhost

**例如：**

我有一个主临时域

```
www.product.com 
```

对于每个客户端，我需要将单独的子域映射到具有相同端口（80）但具有不同实例名称（不同的 .wars 文件）的同一服务器

```
www.client1.product.com
www.client2.product.com
www.clientn.product.com 
```

（如果我错了，请纠正我）据我所知，如果我启动码头实例，每个实例都将从单独的端口号开始

```
client1 war will start at port 3001
client2 war  will start at port 3002
client3 war will start at port 3003 
```

我的问题是如何将端口 80 的所有实例映射到适当的相同子域

如果我访问

`www.client4.product.com`，我需要让码头应用程序在 3004 端口运行

**更新：**

为了更好地了解我的架构，如果在 3002 端口上运行的 client2 jetty 实例由于运行时异常或内存泄漏或手动重启而进入 down 状态，则所有其他 jetty 实例都独立运行（类似于 google appengine 背后的架构使用 jetty）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T18:48:34.193

为此，请勿运行多个 Jetty 实例。使用多个 VirtualHost 运行一个实例。为此，您可以像这样配置码头：

```
 <Configure class="org.eclipse.jetty.webapp.WebAppContext">
    <Set name="war"><SystemProperty name="jetty.home"/>/webapps/client1.war</Set>
    <Set name="contextPath">/</Set>
    <Set name="virtualHosts">
      <Array type="java.lang.String">
        <Item>www.client1.product.com</Item>      
      </Array>
    </Set>
</Configure>
<Configure class="org.eclipse.jetty.webapp.WebAppContext">
  <Set name="war"><SystemProperty name="jetty.home"/>/webapps/client2.war</Set>
  <Set name="contextPath">/</Set>
  <Set name="virtualHosts">
    <Array type="java.lang.String">
      <Item>www.client2.product.com</Item>      
    </Array>
  </Set>
</Configure> 
```

查看[此页面](http://wiki.eclipse.org/Jetty/Howto/Configure_Virtual_Hosts#Configuring_Different_Webapps_for_Different_Virtual_Hosts.2C_But_at_the_Same_Context_Path)以获取有关如何配置它的更多信息。

或者，如果你真的想拥有多个 Jetty 实例，你可以在它前面使用另一个服务器，比如 Apache，它充当反向代理。然后可以通过编辑 httpd.conf 为 Apache 设置虚拟主机：

```
<VirtualHost *:80>
     ServerName www.client1.product.com
     ProxyRequests off
     ProxyPass / http://someInternalHost:3001/
     ProxyPassReverse / http://someInternalHost:3001/
</VirtualHost>

<VirtualHost *:80>
     ServerName www.client2.product.com
     ProxyRequests off
     ProxyPass / http://someInternalHost:3001/
     ProxyPassReverse / http://someInternalHost:3001/
</VirtualHost> 
```

您可以查看[apache 文档](http://httpd.apache.org/docs/2.2/vhosts/name-based.html)以获取更多信息。

# c# - 在 MVC 中的单个视图中列出和编辑

> ID：12184481
> 
> 赞同：1
> 
> 时间：2012-08-29T18:42:05.293
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, viewmodel

假设我的`Person`数据库中有一个表，并且我想要一个视图允许用户像这样编辑人员：

```
All People (Select One)
_______________________
|   Name        Planet
|----------------------
|   Bob         Mars
|   Alice       Venus
-----------------------

Edit Selected Person

Name: _________
Planet: _________
[Submit] 
```

基本上，用户会看到一个包含所有人员的表格，表格下方是一个允许用户编辑所选人员的表单（在同一页面上）。

这似乎是一个常见且模式良好的问题。像这样的事情通常会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:42:21.503

如果没有看到您的 HTML 标记，我们无法给出具体答案。

这是执行此操作的总体思路

使用javascript，获取要选择的行的点击事件，从行中获取记录的ID（记录ID）（假设你在行中的某个位置有它）。使用 jQuery ajax 将现有数据带入记录。在模型弹出窗口或现有页面的特定部分中显示它（显示具有输入元素的隐藏 div，以便用户可以编辑数据）。保存时，使用 jQuery ajax 保存数据。

# smalltalk - 迭代圆变形的直径

> ID：12184484
> 
> 赞同：2
> 
> 时间：2012-08-29T18:42:19.783
> 
> 标签：smalltalk, pharo, morphic

我有一个`CircleMorph`，我想扩大它的直径，可能是用它创建一个小动画。

```
b := CircleMorph new.
b color: Color transparent.
b borderWidth: 2.
b extent:100 @ 100.
b openInWorld. 
```

如果我使用循环或`step`方法来执行此操作会更好吗？如果您推荐该`step`方法，那么我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T20:26:48.107

你可以创建一个`CircleMorph`被调用的子类`GrowingCircleMorph`。然后实施`step`：

```
step
   self extent: (self extent) + 1.
   (self extent) > (200@200) ifTrue: [ self stopStepping ] 
```

现在，如果您在 World 中打开新的 GrowingCircleMorph 实例，它将开始增长到 201@201。

要更改速度，请实施`stepTime`并返回步骤之间的所需时间（以毫秒为单位）。

更新：如果您希望中心保持不变，请更改圆形变形的边界，而不是范围：

```
step
   self bounds: ((self bounds) expandBy: 1).
   (self extent) > (200@200) ifTrue: [ self stopStepping ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T06:57:39.203

如果你想玩这些东西，让它通用：

```
HOCanvasMorph>>drawOn: aCanvas
    super drawOn: aCanvas.

    drawBlock ifNotNil: [
      aCanvas
        translateBy: self bounds origin
        clippingTo: self bounds
        during: [:canvas | drawBlock value: canvas]]

    HOCanvasMorph>>drawBlock: aBlock
        drawBlock := aBlock.
        self changed.

HOCanvasMorph class>>example
|m|

m := HOCanvasMorph new openInWorld.

"to draw:"

m drawBlock: [:c |
    c line: 10@10 to: 100@100 color: Color red
]

HOCanvasMorph class>>napperons
"Some mathematical fun"

| m |
m := HOCanvasMorph new openInWorld. "to draw:"
m
    drawBlock: [ :aCanvas | 
        | n r t xa xc xb yc ya yb longueur nombreDeDroites |
        longueur := 150.
        nombreDeDroites := 30\.  "super drawOn: aCanvas."
        xc := 200.
        yc := 200.
        n := 15.
        r := 100.
        0 to: n - 2 do: [ :i | 
            t := 2 * Float pi * i / n.
            i + 1 to: n - 1 do: [ :j | 
                | tj |
                tj := 2 * Float pi * j / n.
                xa := xc + (r * t cos).
                ya := yc + (r * t sin).
                xb := xc + (r * tj cos).
                yb := yc + (r * tj sin).
                (aCanvas asBalloonCanvas) line: xa @ ya to: xb @ yb color: Color green ] ] ] 
```

由于块可以使用任何更改，因此将这些更改放在一个 step 方法中。

# iphone - 将图像从一个视图设置到另一个 xcode 4.4

> ID：12184486
> 
> 赞同：0
> 
> 时间：2012-08-29T18:42:44.503
> 
> 标签：iphone, objective-c, ios, xcode, uiimageview

我有 2 个视图，它们是 UITabBarController 的一部分。对于每个视图，我声明了一个不同的类。

`PictureViewController`使用方法：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo
{
    [imagePicker dismissModalViewControllerAnimated:YES];
    [imageField setImage:image];
} 
```

另一个视图：`AdjustViewController`使用另一个 UIImage：

```
@property (weak, nonatomic) IBOutlet UIImageView *viewImage; 
```

我想在上述方法中 - didFinishPickingImage 将 viewImage 的值设置为`AdjustViewController`所选图像。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:55:29.157

**编辑**：要在 AppDelegate 中设置您的图像，您必须在 AppDelegate 中为 UIImage *image 创建属性并像这样分配图像：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo
{ 
   MyAppDelegateClass *appDelegate = (MyAppDelegateClass  *)[[UIApplication sharedApplicaton] delegate];
  appDelegate.image=image; //your picked image here

  [imageField setImage:image];
  [imagePicker dismissModalViewControllerAnimated:YES];

} 
```

* * *

传递数据的快速而肮脏的方法是向应用程序委托添加属性，然后使用以下方法从视图控制器调用应用程序委托：

```
MyAppDelegateClass *appDelegate= (MyAppDelegateClass  *)[[UIApplication sharedApplicaton] delegate];
viewImage.image=appDelegate.image; 
```

检索变化数据的最佳位置是在 viewWillAppear 控制器方法中。这样，每次用户切换到该选项卡时，数据都会更新。

* * *

您可能需要考虑 NSNotificationCenter（参考）；您在应用程序通知中心注册一个视图控制器，并在做出选择时发送通知。当收到通知时，另一个视图控制器会相应地更新自己

请参阅[此](https://stackoverflow.com/questions/2363777/iphone-how-to-pass-data-between-several-viewcontrollers-in-a-tabbar-app?rq=1)链接的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:17:30.717

由于这两个都在 tabBarController 中，您可以使用`tabBarController`来获取对另一个视图控制器的引用并从那里访问它的属性。

像这样：

```
NSArray *theViewControllers = [self.tabBarController viewControllers];

//On this line, you will need to use the Index of the AdjustViewController (0 is on the left and then they go in order from left to right.)
AdjustViewController *adjViewController = (AdjustViewController *)[theViewControllers objectAtIndex:0];

adjViewController.viewImage.image = image; 
```

假设您使用正确的索引，这会将图像分配给该`viewImage`属性。`AdjustViewController``UITabBarController`

或者，如果您想将内容压缩到尽可能少的行中：

```
((AdjustViewController *)[[self.tabBarController viewControllers] objectAtIndex:0]).viewImage.image = image; 
```

# python - 端口转发 - Python 微框架

> ID：12184489
> 
> 赞同：0
> 
> 时间：2012-08-29T18:42:56.130
> 
> 标签：python, routing, port

我一直在尝试将 Python 作为服务器端语言。特别是，我正在研究微框架（因为这几天似乎很酷）。

我尝试使用多个框架。我正在使用的以下示例使用[itty](https://github.com/toastdriven/itty)。

```
$ python hello_world.py
itty starting up (using wsgiref)...                                                                                    
Listening on http://0.0.0.0:5000
Use Ctrl-C to quit. 
```

这工作得很好。我打了`http://0.0.0.0:5000`，它工作。但现在我无法理解如何在我的虚拟主机上做同样的事情。我可以很好地访问我的网站（例如 foo.com），但是在运行 hello_world.py 之后，我无法访问相应的 URL（例如 foo.com:5000）。

如何使用相应的端口访问 URL？我可以不指定端口（例如 bar.foo.com => foo.com:5000）吗？

我什至应该转发端口吗？我还有其他方法可以实现我的目标（即点击 Python 生成的网页）吗？

我怎么知道我是否有权进行这些更改？如果有帮助，我的虚拟主机是 1and1。

如果我无法在我的虚拟主机上完成此操作，我该如何在我拥有更多控制权的服务器（例如 EC2 实例）上完成此操作？（我也不确定，但我认为[这个问题](https://stackoverflow.com/questions/8374069/port-forwarding)可能是相关的）

我对端口和路由的工作知识很少，因此非常感谢任何知识或资源。

# javascript - 使用 for 循环访问嵌套数组的单元格

> ID：12184491
> 
> 赞同：3
> 
> 时间：2012-08-29T18:42:57.047
> 
> 标签：javascript

处理一个codecademy教程，我应该像这样打印出表格的“单元格”（数组中的数组）

```
Cell Cell Cell 
```

每个单元格之间有两个空格。我假设结果（对于第一个“行”）看起来像

```
Person  Age  City 
```

“行”的末尾不应有空格。

我在下面编写了灾难性的 for 循环，试图遵循 codecademy 的说明（复制如下），但无法使其正常工作。谁能帮帮我...

```
var table = [
    ["Person",  "Age",  "City"],
    ["Sue",     22,     "San Francisco"],
    ["Joe",     45,     "Halifax"]
];

for (var r in table) {       ////// I wrote this for statement
    var c;
    var cells = table[r]; 
    var rowText = ""; 
    for(c = 0; c < cells; c++){
        rowText += table[r][c];
        if(c < cells - 1){         //only adds the space if not at end of line
            rowText += "  "; 
        }
    }

    console.log(rowText); 

} 
```

**Codecademy.com 的说明**

> 我们想添加另一个 for 循环和一些格式化代码，以便我们可以按以下格式打印出三行中的每一行：
> 
> 细胞细胞细胞
> 
> 每个单元格值之间应该有两个空格，但不能在行尾。每行应该在单独的行上。
> 
> 练习提示中有深入的说明。
> 
> 删除 for 循环主体中的 console.log 语句。在 for 循环体中，定义一个变量 c。还要定义一个名为 cells 的变量并将其设置为等于当前行的长度（可以使用 table[r] 找到）。定义一个名为 rowText 的空字符串变量。确保将 rowText 设置为“”。在步骤 2 中的变量之后立即定义另一个 for 循环。
> 
> 在第一个循环参数中，将 c 设置为 0。在第二个循环参数中，确保循环在 c 比单元格小一后停止。在第三个循环参数中，递增 c。在第 3 步的循环体中，将当前单元格（可以使用 table[r][c] 找到）附加到 rowText。如果 c 不是该行中最后一个单元格的位置（当 c 小于单元格 - 1 时为真），则使用 if 语句还将两个空格字符（这是“”）附加到 rowText第 3 步，但在上一个练习的循环体内部，使用 console.log 打印 rowText。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:47:47.177

使用 cells.length 而不是我认为的单元格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:52:07.923

> 确保循环在 c 比单元格少一之后停止。

说明有点误导。真的，您希望您的`c`变量从 0 变为比数组长度小 1。

这一行：`for(c = 0; c < cells; c++){`

应该：`for(c = 0; c < cells.length; c++){`

因此，如果您的单元格数组具有三个元素，则应该执行循环的三个迭代。一次`c`等于`0`，另一个 where`c`是`1`，第三个 where`c`是 2。然后循环构造将继续，`c++`语句设置`c`为 3，但随后条件 ( `c < cells.length`) 将是`false`，因为它会是`3 < 3`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:54:31.020

```
var table = [
    ["Person",  "Age",  "City"],
    ["Sue",     22,     "San Francisco"],
    ["Joe",     45,     "Halifax"]
];

var text = "";

for( var i=0; i<table.length; i++ ){

    for( var j=0; j<table[i].length; j++ ){

        text += table[i][j];

        if( j < table[i].length-1 ){
            text += "  ";                
        }

    }        

    text += "\n";

}

console.log(text);
​ 
```

产量：

```
Person  Age  City
Sue  22  San Francisco
Joe  45  Halifax 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T18:58:16.350

> 定义一个名为单元格的变量并将其设置为等于当前行的长度

您正在设置`cells`行本身，而不是其长度。

```
var cells = table[r].length; 
```

# c# - Linq 查询 OrderBy 多个

> ID：12184493
> 
> 赞同：2
> 
> 时间：2012-08-29T18:42:58.040
> 
> 标签：c#, linq, linq-to-objects

我有一个`List<Employees>`我正在尝试选择`Active`员工的集合。

我一定是做错了什么，因为我在这里看到很多例子表明我可以做到这一点，但 Visual Studio 告诉我我不能，因为：

> 无法将类型“System.Linq.IOrderedEnumerable”隐式转换为“System.Collections.Generic.List”。存在显式转换（您是否缺少演员表？）

这张照片有什么问题？`LastName`和`FirstName`（您可能会怀疑）都是字符串值，并且`Active`是布尔值。

![范围变量](../Images/93dac94bf0e683164f762877a93059a4.png)

```
DataGridView1.DataSource = null;
List<AcpEmployee> emps = from e in employeeInfo.Employees
                         where e.Active 
                         orderby e.LastName, e.FirstName descending
                         select e; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T18:46:54.960

您应该`ToList`在查询结束时使用：

```
List<AcpEmployee> emps = (  from e in employeeInfo.Employees
                            where e.Active
                            orderby e.Active orderby e.LastName, e.FirstName descending
                            select e).ToList(); 
```

或直接使用方法：

```
List<AcpEmployee> emps = employeeInfo.Employees
    .Where(e => e.Active)
    .OrderBy(e => e.LastName)
    .ThenByDescending(e => e.FirstName)
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T18:45:29.020

如果您希望将结果作为列表，只需将 ToList() 附加到您的查询中。或者简单地声明 emps`var emps`将有一个类型`IOrderedEnumerable`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T18:52:17.393

之前已经在[这里回答过](https://stackoverflow.com/questions/298725/multiple-order-by-in-linq)，只需在 linq 中使用 orderby 关键字即可

```
var emps = from e in employeeInfo.Employees 
            where e.Active orderby e.LastName thenby e.FirstName select e; 
```

# grails - 用于简单一对多映射的 GORM 列名

> ID：12184495
> 
> 赞同：0
> 
> 时间：2012-08-29T18:43:00.133
> 
> 标签：grails, grails-orm

我有这个设置

```
class User {
  Date lastLogin

  // logins is a history of logins
  static hasMany = [logins : Date]

  def setLastLogin(Date date) {
    if (date) {
      lastLogin = date
      addToLogins(date) 
    }
  }
} 
```

GORM 正在生成一个表 MEMBER_LOGINS，目前看起来像这样：

```
USER_ID, LOGINS 
```

相反，我想

```
USER_ID, DATE 
```

我尝试在用户中添加映射

```
static mapping = {
  logins column: 'date';
} 
```

但这只是改变了外键，所以我现在有了

```
DATE, LOGINS 
```

如何更改 LOGINS 列？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:56:27.290

您可以使用休眠 hbm 文件来映射您的列

[http://grails.org/doc/latest/guide/hibernate.html](http://grails.org/doc/latest/guide/hibernate.html)

或者你可以做到

```
class User {
    static hasMany = [logins: Date]
    def setLastLogin ...
    static mapping = { 
        hasMany joinTable: 
            [name: 'logins', 
                key: 'person_id', 
                column: 'dates', 
                type: "date"] 
    } 
} 
```

# wordpress - Nginx - WordPress 上的 W3 缓存规则

> ID：12184496
> 
> 赞同：0
> 
> 时间：2012-08-29T18:43:03.040
> 
> 标签：wordpress, caching, nginx, gzip, browser-cache

首先，我对 nginx 很陌生。

我正在尝试在托管 wordpress 站点的一系列 Nginx 服务器上实现 gzip 压缩和浏览器缓存规则。我从以下页面获取了应该放在 nginx.conf 文件中的代码：http: [//codex.wordpress.org/Nginx](http://codex.wordpress.org/Nginx)

**W3 总缓存规则**

```
# BEGIN W3TC Browser Cache
gzip on;
gzip_types text/css application/x-javascript text/richtext image/svg+xml text/plain text/xsd text/xsl text/xml image/x-icon;
location ~ \.(css|js)$ {
    expires 31536000s;
    add_header Pragma "public";
    add_header Cache-Control "max-age=31536000, public, must-revalidate, proxy-revalidate";
    add_header X-Powered-By "W3 Total Cache/0.9.2.3";
}
location ~ \.(html|htm|rtf|rtx|svg|svgz|txt|xsd|xsl|xml)$ {
    expires 180s;
    add_header Pragma "public";
    add_header Cache-Control "max-age=180, public, must-revalidate, proxy-revalidate";
    add_header X-Powered-By "W3 Total Cache/0.9.2.3";
}
location ~ \.(asf|asx|wax|wmv|wmx|avi|bmp|class|divx|doc|docx|exe|gif|gz|gzip|ico|jpg|jpeg|jpe|mdb|mid|midi|mov|qt|mp3|m4a|mp4|m4v|mpeg|mpg|mpe|mpp|odb|odc|odf|odg|odp|ods|odt|ogg|pdf|png|pot|pps|ppt|pptx|ra|ram|swf|tar|tif|tiff|wav|wma|wri|xla|xls|xlsx|xlt|xlw|zip)$ {
    expires 31536000s;
    add_header Pragma "public";
    add_header Cache-Control "max-age=31536000, public, must-revalidate, proxy-revalidate";
    add_header X-Powered-By "W3 Total Cache/0.9.2.3";
}
# END W3TC Browser Cache
# BEGIN W3TC Skip 404 error handling by WordPress for static files
if (-f $request_filename) {
    break;
}
if (-d $request_filename) {
    break;
}
if ($request_uri ~ "(robots\.txt|sitemap(_index|[0-9]+)?\.xml(\.gz)?)") {
    break;
}
if ($request_uri ~* \.(css|js|html|htm|rtf|rtx|svg|svgz|txt|xsd|xsl|xml|asf|asx|wax|wmv|wmx|avi|bmp|class|divx|doc|docx|exe|gif|gz|gzip|ico|jpg|jpeg|jpe|mdb|mid|midi|mov|qt|mp3|m4a|mp4|m4v|mpeg|mpg|mpe|mpp|odb|odc|odf|odg|odp|ods|odt|ogg|pdf|png|pot|pps|ppt|pptx|ra|ram|swf|tar|tif|tiff|wav|wma|wri|xla|xls|xlsx|xlt|xlw|zip)$) {
    return 404;
}
# END W3TC Skip 404 error handling by WordPress for static files 
```

我尝试将其放在该`http {`部分并重新启动服务器，但它说位置在错误的位置。

需要进去`server {`吗？或者放置这个的最佳位置是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T09:11:46.710

从[http://nginx.org/en/docs/http/ngx_http_core_module.html#location](http://nginx.org/en/docs/http/ngx_http_core_module.html#location)我们了解到位置块的可接受上下文是服务器和位置。

所以是的，您需要将位置块放在服务器块内（或嵌套在另一个位置块内，但您的配置不这样做）

根据[http://nginx.org/en/docs/http/ngx_http_gzip_module.html#gzip，gzip](http://nginx.org/en/docs/http/ngx_http_gzip_module.html#gzip)位具有“http，服务器，位置，如果在位置”的允许上下文，因此您可以将它们放在您的 http或服务器块。

# java - 为 JTable 指定特定于列的 TableCellRenderers

> ID：12184497
> 
> 赞同：3
> 
> 时间：2012-08-29T18:43:03.877
> 
> 标签：java, swing, jtable, tablecellrenderer, tablecolumn

我有一个`JTable`显示双精度的多列，其中一些是比率，而另一些是美元值。我想指定一个`TableCellRenderer`用于比率，另一个用于美元值。

java教程说“要指定特定列中的单元格应使用渲染器，请使用该`TableColumn`方法`setCellRenderer`”。这很有帮助，但我不清楚我应该在什么时候在我`TableColumn`的 s. 有这样做的标准方法吗？我应该`JTable`在其构造函数中进行自定义吗？还是习俗`TableColumnModel`？理想情况下，我希望能够从`TableModel`我已有的习惯中做到这一点，尽管这似乎不太可能。

任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:47:52.193

您可以通过这种方式在列上设置渲染器：

```
table.getColumnModel().getColumn(0).setCellRenderer(new TableRendererExample()); 
```

你可以编写自己的渲染器实现：

```
 class TableRendererExample extends DefaultTableCellRenderer {
    @Override
    public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
      Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
      if (column == 1) {
        c.setForeground(Color.gray);
      }
      return c;
    }
  } 
```

# xcode - xcode 4.0.2 SOIL 库链接错误 (OSX 10.6.8)

> ID：12184499
> 
> 赞同：7
> 
> 时间：2012-08-29T18:43:13.477
> 
> 标签：xcode, soil

我的用户故事：我想将纹理加载到我的 openGL 程序中。

我的问题：如何在 xcode 4.0.2 中正确链接 SOIL 库

所以，在过去的几天里，我一直在谷歌上搜索我在 xcode4 中的链接器警告，但我无法自己回答——所以我敢于在这个主题上发布另一个线程......（谦虚的初学者把尾巴夹在两腿之间）。

我的基本复制步骤：

1.  我将“简单 OpenGL 图像库”解压缩到我的下载中
2.  我将 libSOIL.a 拖放到我的项目文件中

    *   在“构建阶段”下，libSOIL.a 会自动添加到“使用库链接二进制文件”
    *   在“构建设置”下，我的库搜索路径也会自动更新
    *   我的有效架构已经指定“i386 x86_64”

当我尝试运行我的程序时收到此警告：

ld：警告：忽略文件/Users/Scott/Developer/Projects/SpaceRanger/Code/Production/lib/libSOIL.a，文件是为存档而构建的，它不是被链接的架构（x86_64）

正如我所提到的，我对编程和 IDE 很陌生，所以我希望在 OpenGL（例如 SOIL）中加载纹理的更简单的方法对 SDL 甚至 GLFW 有利。如果我在只加载一个库时遇到这种麻烦，那肯定是我不知道的。

基于搜索的其他 Hit n' Miss 尝试：

*   将库添加到“编译源”只会产生更多警告
*   切换“仅构建活动架构”是/否
*   将方案设置为 32 位和 64 位
*   编写我自己的纹理加载器，使用 libjpg/DevIL/等。

恐怕我开始破坏我的项目只是试图链接这个库。如果有人可以帮助我在 xcode 4.0.2 中正确链接 SOIL 库，我将永远感激不尽。

提前深深感谢您。

-克罗普克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T00:10:08.297

我想补充一点，在过去的几天里，它让我发疯了。除了以上所有内容，我还必须确保以下内容。

在 Project > Target > Build Phases 中，在“Compile Sources”下，需要添加 .c SOIL 文件：

image_DXT.c、image_helper.c、SOIL.c、stb_image_aug.c。

只有现在它才能编译和运行。

// 不知道为什么要投反对票，希望有理由！

# cmake - 使用 CMake 构建的库上的链接器错误

> ID：12184501
> 
> 赞同：0
> 
> 时间：2012-08-29T18:43:21.267
> 
> 标签：cmake, static-libraries, static-linking

我对 CMake 很陌生，并尝试编写一个简单的静态库，使用 Qt4 进行一些图像处理。

```
cmake_minimum_required(VERSION 2.8)
project(timage)

find_package(Qt4 REQUIRED)
include(${QT_USE_FILE})
add_definitions(${QT_DEFINITIONS})

include_directories(
    "${PROJECT_SOURCE_DIR}/include"
)
add_library(
    timage
    ${PROJECT_SOURCE_DIR}/source/timage.cpp
)
target_link_libraries(
    timage
    ${QT_LIBRARIES}
) 
```

我可以配置和生成它，它甚至可以成功构建`libtimage.a`. 现在我想将它包含到我的主要项目中，这就是麻烦的开始。

我从一些单元测试开始，但我已经收到链接器错误（`undefined reference`对于类的每个函数调用`TImage`）。我用`g++ -Wall -Wextra -std=c++11 -I../include -L../bin -ltimage -o test spec.cpp`

除了 Qt4 工作之外，我个人看不出我对[初学者教程所做的工作之间的区别。](http://www.cmake.org/cmake/help/cmake_tutorial.html)如果有人可以在这里给我一个正确方向的提示，我将不胜感激。

**更新** 我刚刚发现，如果我用这个 CMake 文件构建我的测试：

```
link_directories(
    ${PROJECT_BINARY_DIR}
)
add_definitions("-std=c++11")
add_executable(
    test
    spec.cpp
)
target_link_libraries(
    test
    timage
) 
```

一切都按预期工作。我目前正在尝试找出 CMake 在做什么，而我不是。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T22:10:55.397

您的问题是 libtimage.a 可能不在`../bin`，但默认情况下会在`${PROJECT_BINARY_DIR}`- 您的构建目录中。

在您的 g++ 命令中，您将添加`../bin`到库搜索路径中，但您需要添加到任何`${PROJECT_BINARY_DIR}`位置。

这是在[`link_directories`](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#command%3alink_directories)命令中的第二个 CMakeLists 文件中实现的。但是，通常最好避免使用此命令（文档解释了原因）。

如果`timage`在您的测试的 CMakeLists.txt 中作为 CMake 目标可用，则无需使用`link_directories`- CMake 已经知道在哪里可以找到构建的库，并且会`-L`自动传递适当的标志。“CMake 目标”是指使用该`add_library`命令在该文件或父 CMakeLists.txt 中定义的。

如果`timage`不是测试 CMakeLists.txt 中的实际 CMake 目标（即，它是一个完全独立的项目，不是从公共父 CMakeLists.txt 调用的），那么您有几个选择。

您可以[`export`](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#command%3aexport)您的`timage`项目，以便测试项目可以使用 导入它[`include`](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#command%3ainclude)，或者您可以单独构建库，然后让测试使用[`find_library`](http://www.cmake.org/cmake/help/v2.8.9/cmake.html#command%3afind_library). 如果找到，这将产生 libtimage.a 的完整路径。

所有这些选项都将避免您必须使用`link_directories`.

另一点是，您可以通过执行确切地看到 CMake 正在调用的构建命令

```
make VERBOSE=1 
```

因此，当您构建测试时，您可以将 CMake 生成的命令与您自己的命令进行比较。

# python - 正则表达式 - 检测重复项

> ID：12184502
> 
> 赞同：0
> 
> 时间：2012-08-29T18:43:27.933
> 
> 标签：python, regex, csv

我有一个包含以下类型数据的数据集：

```
company_id, company_name, country
1, a Tech, germany
2, a Tech AG, germany
3, a Tech gmbh, germany
4, AF, germany
5, AF gmbh, vermany 
```

我已经根据将 ID 分配给完全匹配的初步搜索将 company_id 分配给这些公司。现在，我想做以下事情：

1) 编写一个正则表达式，判断一个公司名称是否与其下面的公司名称完全相同，只是第二个公司名称的末尾有后缀“gmbh”。

除了正确使用正则表达式背后的逻辑之外，我已经完成了所有工作。例如：

```
 for next_row in reader:
        first_name = first_row['company_name']
        next_name = next_row['company_name']

        if first_name == next_name:##FIX ME
            #do stuff
        writer.writerow(first_row)
        first_row = next_row 
```

相等性测试的逻辑不应该是如果 first_name == next_name-- 而是如果 first_name 等于 last_name 加上 gmbh...

非常感谢任何澄清！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T00:42:52.203

## 算法

1.  `(.*?)(\s+AG)?`在字符串中搜索正则表达式`first_name`并将其替换为`\1`. 这将为您提供不带`AG`.
2.  将结果分配给`first_name_without_AG`，然后执行以下操作：`next_name == first_name_without_AG + ' gmbh'`

## 示例实现

```
import re
first_name_without_AG = re.sub("(.*?)(\\s+AG)?", "\\1", first_name)
next_name == first_name_without_AG + ' gmbh' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:55:49.140

我想你想要的是

```
import re
regx = "([\w\s]+).*\1\s*gmbh"
re.findall(regx,my_target_text,re.MULTILINE) 
```

无论如何（我认为 \1 在正则表达式中捕获第一个括号......但那部分可能是错误的）

这听起来也有点像家庭作业，因为您正在询问使用正则表达式，但没有太多需要使用正则表达式

[编辑/注释] 这绝不是一个完整的实现，可能需要对正则表达式进行重大调整......（但它会很相似）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T01:11:19.217

他的例子有AG和gmhb？

为什么不尝试这样的事情。

```
for next_row in reader:
    first_name = first_row['company_name']
    next_name = next_row['company_name']
    checkLength = len(first_name)

    if first_name == next_name[:checkLength] :  ##FIX ME
        #do stuff
    writer.writerow(first_row)
    first_row = next_row 
```

这仅检查引入的名字的长度，并且在检查中忽略后缀。

# php - 寻找比 index.html 更好的索引

> ID：12184503
> 
> 赞同：0
> 
> 时间：2012-08-29T18:43:31.647
> 
> 标签：php, javascript, apache, web

所以我有一个小型网络服务器，用于存储我的 php/javascript 页面。

这些页面主要只是示例和练习文件，但我正在寻找一种显示页面预览的方法。

目前我使用默认的 Apache index.html，它只提供目录中所有文件的列表。

我正在寻找一个包含所有网页的图块并提供文件预览的页面。

或者您可能会推荐的任何其他更好的东西。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:10:29.657

这里有两个接近你想要的。您可能可以对它们进行一些自定义。

[PHP 目录列表脚本](http://www.evoluted.net/thinktank/web-development/php-directory-listing-script)

[PHP 目录列表](http://weitnahbei.de/php-directory-listing/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:14:54.840

可能有一个浏览器可以选择输出给定页面的屏幕截图，当请求索引文件时，您可以在服务器上运行该屏幕截图，但您可能希望缓存屏幕截图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:15:02.407

您可以使用 imagegrabscreen 创建页面预览 [http://php.net/manual/en/function.imagegrabscreen.php](http://php.net/manual/en/function.imagegrabscreen.php)

# colors - libyuv 是否有针对 NEON 优化的 YUV420ToRGB565 函数？

> ID：12184504
> 
> 赞同：1
> 
> 时间：2012-08-29T18:43:36.117
> 
> 标签：colors, neon, libyuv

libyuv 是否有针对 NEON 优化的 YUV420ToRGB565 函数？

从我在 libyuv 源代码中看到的内容来看，有一个函数 I420ToRGB565 但它首先转换为 ARGB，然后才转换为 RGB565，最后一次转换不是 NEON 优化的。我弄错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T01:20:27.797

你是对的，对于当前的 r396 版本。I420ToRGB565 对 I420ToARGB 使用 NEON，而对 ARGBToRGB565 使用 C。

霓虹灯 + C I420ToRGB565_OptVsC (12649 毫秒)

那是 1280x720 的 12.6 毫秒/帧。它比 C 更快：I420ToRGB565_OptVsC (81485 ms)

RGB24 是 1 步 NEON 用于比较。I420ToRGB24_OptVsC (3392 毫秒)

一个错误是将文件移植到 Neon [http://code.google.com/p/libyuv/issues/detail?id=103](http://code.google.com/p/libyuv/issues/detail?id=103)

# mediaelement.js - mediaelement.js - 仅隐藏第一个视频的控件

> ID：12184505
> 
> 赞同：0
> 
> 时间：2012-08-29T18:43:41.737
> 
> 标签：mediaelement.js

我正在尝试制作类似于此示例的广告前贴片（背靠背视频）：

```
<video width="640" height="360" src="video1.mp4" type="video/mp4" 
controls="controls" preload="none"></video>

<script>
$('video').mediaelementplayer({
    success: function(media, node, player) {
        media.addEventListener('ended', function() {

            media.setSrc('video2.mp4');
            media.load();
            media.play();

        }, false);
    }
});
</script> 
```

我需要隐藏在第一个视频中显示的播放器控件，然后添加第二个视频的控件。这是我尝试过的：

*   通过 jquery 隐藏控制栏的各种方法，但它总是在悬停时重新出现（在控件 div 上）。
*   解开那个悬停。没运气。
*   从视频标签中没有控件属性开始，然后为第二个视频添加它，但您始终可以在悬停时获得控件。

我唯一的另一个想法是将功能数组设置为第一个视频的进度条，然后为第二个视频添加其余的控制功能，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T17:44:08.053

看起来我在广告期间放置在播放器顶部的 div（以防止交互）没有覆盖播放器的最底部，导致悬停动作。正确覆盖 div 解决了我的问题。

# c++ - 为什么 glGetString(GL_VERSION) 返回 null / zero 而不是 OpenGL 版本？

> ID：12184506
> 
> 赞同：29
> 
> 时间：2012-08-29T18:43:44.340
> 
> 标签：c++, opengl, glut, glew

我在 Linux Mint 13 XFCE 上。我的问题是，当我在终端中运行命令时：

```
glxinfo | grep "OpenGL version" 
```

我得到以下输出：

```
OpenGL version string: 3.3.0 NVIDIA 295.40 
```

但是当我`glGetString(GL_VERSION)`在我的应用程序中运行时，结果为空。为什么这段代码没有得到`gl_version`？

```
#include <stdio.h>
#include <GL/glew.h>
#include <GL/gl.h>
#include <GL/glu.h>
#include <GL/glut.h>
#include <GL/glext.h>

int main(int argc, char **argv) {

    glutInit(&argc, argv);
    glewInit();

    printf("OpenGL version supported by this platform (%s): \n",
        glGetString(GL_VERSION));
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-29T18:48:50.623

`glutInit()`不创建[GL 上下文](https://www.khronos.org/opengl/wiki/OpenGL_Context) *或*使一个当前。您需要当前的 GL 上下文才能`glewInit()`工作`glGetString()`。

尝试这个：

```
#include <GL/glew.h>
#include <GL/glut.h>
#include <cstdio>

int main(int argc, char **argv)
{
    glutInit(&argc, argv);
    glutCreateWindow("GLUT");

    glewInit();
    printf("OpenGL version supported by this platform (%s): \n", glGetString(GL_VERSION));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-10T10:16:50.750

您还可以使用`glfw`以创建 GL 上下文，然后查询版本：

包括这些文件：

```
#include "GL/glew.h"
#include "GLFW/glfw3.h" 
```

然后你可以这样做：

```
 // Initialise GLFW
    glewExperimental = true; // Needed for core profile
    if (!glfwInit())
    {
        return "";
    }

    // We are rendering off-screen, but a window is still needed for the context
    // creation. There are hints that this is no longer needed in GL 3.3, but that
    // windows still wants it. So just in case.
    glfwWindowHint(GLFW_VISIBLE, GL_FALSE); //dont show the window

    // Open a window and create its OpenGL context
    GLFWwindow* window;
    window = glfwCreateWindow(100, 100, "Dummy window", NULL, NULL);
    if (window == NULL) {
        return "";
    }
    glfwMakeContextCurrent(window); // Initialize GLEW
    if (glewInit() != GLEW_OK)
    {
        return "";
    }

    std::string versionString = std::string((const char*)glGetString(GL_VERSION)); 
```

# colors - 更改单元格背景颜色

> ID：12184509
> 
> 赞同：0
> 
> 时间：2012-08-29T18:43:44.647
> 
> 标签：colors, background

[http://jsfiddle.net/mannagod/Zq6w4/](http://jsfiddle.net/mannagod/Zq6w4/)

```
 now = new Array("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec");
cells = document.getElementById('months').getElementsByTagName('td');
for (c = 0; c < cells.length; c++) {
    if (cells[c].firstChild.nodeValue == now) {
        cells[c].style.backgroundColor = 'red' //today's scripture reading
        cells[c].style.color = 'white'
    }
} 
```

我想更改当前月份单元格的背景和字体颜色。我为下表尝试了上面的代码，但我似乎无法使其工作......

```
<table class="hovertable" id="hovertable" name="hovertable">

<tbody id="months">
    <tr>
        <td class="style2">
            <a href="01.htm">Jan</a></td>
        <td class="style2">
            <a href="02.htm">Feb</a></td>
        <td class="style2">
            <a href="03.htm">Mar</a></td>
        <td class="style2">
            <a href="04.htm">Apr</a></td>
        <td class="style2">
            <a href="05.htm">May</a></td>
        <td class="style2">
            <a href="06.htm">Jun</a></td>
    </tr>
    <tr>
        <td class="style2">
            <a href="07.htm">Jul</a></td>
        <td class="style2">
            <a href="08.htm">Aug</a></td>
        <td class="style2">
            <a href="09.htm">Sep</a></td>
        <td class="style2">
            <a href="10.htm">Oct</a></td>
        <td class="style2">
            <a href="11.htm">Nov</a></td>
        <td class="style2">
            <a href="12.htm">Dec</a></td>
    </tr>
        </tbody>
    </table> 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:32:46.503

这个 javascript 应该做你想做的事：

```
now = new Array("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec");
var d = new Date();
cells = document.getElementById('months').getElementsByTagName('td');
for (c = 0; c < cells.length; c++) {
    if (c == d.getMonth()) {
        cells[c].style.backgroundColor = 'red' //today's scripture reading
        cells[c].style.color = 'white'
    }
} 
```

# android - Android 拖放 ACTION_DRAG_ENDED 未触发

> ID：12184511
> 
> 赞同：17
> 
> 时间：2012-08-29T18:43:45.463
> 
> 标签：android, drag-and-drop

我真的很花时间弄清楚这个，到目前为止找不到任何有相关经验的朋友。这是我发布我的第一个应用程序之前的最后一个功能，所以在看到结局的情况下陷入困境让我发疯！

如果我将对象放在可接受的区域中，我的拖放操作会非常完美。但是，如果拖放到其他地方，我不会收到事件，并且在拖放操作失败后无法清理。我需要触发 ACTION_DRAG_ENDED 事件。但是，如果我以 true 值响应 ACTION_DRAG_STARTED （这意味着它可以接受对象），这只会触发（根据文档）。问题是 ACTION_DRAG_STARTED 没有触发！

所以我认为问题的症结在于我没有得到 ACTION_DRAG_STARTED。我将所有相关的拖放代码（或至少几乎所有）放在这里：

```
private OnTouchListener onTouchListener = new OnTouchListener() {

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            Item current = (Item) ((View) v.getTag()).getTag();
            //ClipData data = ClipData.newPlainText("test", "testText");
            View dragView = (View) v.getTag();
            DragShadowBuilder shadowBuilder = new ItemDragShadowBuilder(dragView, 
                                new Point(v.getWidth()/2, v.getHeight()/2));
            dragSource = dragView;
            v.startDrag(null, shadowBuilder, current, 0);
            dragView.setVisibility(View.INVISIBLE);
            return true;
        } else {
            return false;
        }       
    }

};

private static class ItemDragShadowBuilder extends View.DragShadowBuilder {

    private Point touchPoint = null;
    private Point sizePoint = null;
    private View dragView = null;

    public ItemDragShadowBuilder(View dragView, Point touchPoint) {
        super();
        sizePoint = new Point(dragView.getWidth(), dragView.getHeight());
        this.touchPoint = touchPoint;
        this.dragView = dragView;
    }

    @Override
    public void onProvideShadowMetrics (Point size, Point touch) {
        size.set(sizePoint.x, sizePoint.y);
        touch.set(touchPoint.x,touchPoint.y);
    }

    @Override
    public void onDrawShadow(Canvas canvas) {

        dragView.setBackgroundColor(dragView.getContext().getResources().getColor(R.color.holoBlueDark));
        dragView.draw(canvas);

        //canvas.setBitmap(dragView.getDrawingCache());
        //canvas.drawColor(Color.WHITE);
        //dragView.setAlpha(1);

        //How do I change the transparency?
        //super.onDrawShadow(canvas);
    }

}

private View dragSource = null;

private OnDragListener onDragEventListener = new OnDragListener() {

    @Override
    public boolean onDrag(View v, DragEvent event) {
        final int action = event.getAction();

        switch (action) {
        case DragEvent.ACTION_DRAG_STARTED:
            Toast.makeText(v.getContext(), ((EditText) v.findViewById(R.id.edtParent)).getText().toString() + " started", Toast.LENGTH_SHORT/8).show();
            return true;
            //break;//DRAG AND DROP>>>START DOESN"T FIRE
        case DragEvent.ACTION_DROP:
            if ((dragSource != null) && (dragSource != v)) {
                Item source = (Item) dragSource.getTag();
                Item target = (Item) v.getTag();
                int sourcePos = source.getPosition();
                int targetPos = target.getPosition();
                if (targetPos < sourcePos)
                    source.moveUp(sourcePos - targetPos);
                else
                    source.moveDown(targetPos - sourcePos);
                dragSource.setVisibility(View.VISIBLE);
                dragSource = null;
                fireOnChecklistNeedsResetListener();
                return true;
            }
//              View view = (View) event.getLocalState();
//              Toast.makeText(v.getContext(), ((EditText) v.findViewById(R.id.edtParent)).getText().toString(), Toast.LENGTH_SHORT/8).show();
//              Toast.makeText(v.getContext(), ((EditText) view.findViewById(R.id.edtParent)).getText().toString(), Toast.LENGTH_SHORT/8).show();
            // Dropped, reassign View to ViewGroup
//              View view = (View) event.getLocalState();
//              ViewGroup owner = (ViewGroup) view.getParent();
//              owner.removeView(view);
//              LinearLayout container = (LinearLayout) v;
//              container.addView(view);
//              view.setVisibility(View.VISIBLE);
            break;
        case DragEvent.ACTION_DRAG_ENDED:
            dragSource.setVisibility(View.VISIBLE);
            dragSource = null;
            fireOnChecklistNeedsResetListener();
            if (!event.getResult())
                Toast.makeText(v.getContext(), "UNHANDLED", Toast.LENGTH_SHORT/8).show();

//              View vieww = (View) event.getLocalState();
//              Toast.makeText(v.getContext(), ((EditText) v.findViewById(R.id.edtParent)).getText().toString(), Toast.LENGTH_SHORT/8).show();
//              Toast.makeText(v.getContext(), ((EditText) vieww.findViewById(R.id.edtParent)).getText().toString(), Toast.LENGTH_SHORT/8).show();
            break;
        case DragEvent.ACTION_DRAG_ENTERED:

            v.setBackgroundColor(v.getContext().getResources().getColor(R.color.holoBlueLight));
            return true;
            //break;
        case DragEvent.ACTION_DRAG_EXITED:        
            v.setBackgroundColor(v.getContext().getResources().getColor(android.R.color.background_light));
            return false;
            //break;
        default:
            break;
    }
        return false;
    }

}; 
```

扩展信息：dragView 是列表视图（特别是可扩展列表视图）中的项目布局。接受触摸事件的视图是视图上的一个小字形，带有一个小夹子。这是一个正在进行拖动操作的屏幕截图（需要一些花哨的手指工作才能得到这个哈哈）：

![拖放屏幕](../Images/b7e2cf9489bd4fe4334ff5d499153ea9.png)

因此，如果我要将拖动的项目放在另一个项目上（这会重新排序它们），它会很好用。如果我把它丢到别的地方，就不会触发任何事件，所以我永远无法清理它。因此，例如在屏幕的上部，或者如果列表在空白区域或底部的蓝色条或任何系统区域中很短。

我也可以通过找出一种防止拖离有效区域的方法来解决这个问题，所以如果你知道如何做到这一点，那是另一种解决方法。我的最后一个选择是为屏幕上的每个可能视图实现一个事件（同样，这些是列表视图布局，在一个列表视图上，它在一个片段上，可能在各种活动上）所以显然这不是可取的。事实上，如果我这样做了，如果它掉到系统 UI 区域（如系统栏或电容式按钮区域），我仍然可能会遇到问题，但我不确定。

如果这里有帮助，我在列表视图适配器获取视图项方法中分配相关事件过程（我删除了不相关的行）：

```
public View getGroupEdit(int groupPosition, boolean isExpanded, View convertView,
        ViewGroup parent) {
    if (convertView != null) {
                //irrelevant stuff omitted
    } else
        convertView = inf.inflate(R.layout.edit_group_item, null);
    Item group = (Item) getGroup(groupPosition);
    convertView.setTag(group);
    EditText edtParent = (EditText) convertView.findViewById(R.id.edtParent);
    edtParent.setTag(convertView);
    scatterItemText(edtParent);

            //irrelevant stuff omitted

    ImageView imgGrip = (ImageView) convertView.findViewById(R.id.imgGrip);
    imgGrip.setTag(convertView);
             //irrelevant stuff omitted     

            imgGrip.setOnTouchListener(onTouchListener);
    convertView.setOnDragListener(onDragEventListener);
    return convertView;
} 
```

最后是 FWIW，这是列表项视图的布局 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="55dip"
android:orientation="horizontal" >
<ImageView 
    android:id="@+id/imgGrip"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:src="@drawable/dark_grip2"
    android:contentDescription="@string/strReorder"/>
<CheckBox 
    android:id="@+id/chkParent"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@id/imgGrip"
    android:checked="false"/>
<EditText
    android:id="@+id/edtParent"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@id/chkParent"
    android:layout_toLeftOf="@+id/btnInsert"
    android:textSize="17dip" 
    android:inputType="text"
    android:hint="@string/strItem"/>
<ImageButton
    android:id="@id/btnInsert"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:layout_toLeftOf="@+id/viewParent"
    android:src="@drawable/dark_content_new"
    android:clickable="true"
    android:hint="@string/strAddItemAbove"
    android:contentDescription="@string/strAddItemAbove" />   
<View 
    android:id="@id/viewParent"
    android:layout_height="match_parent"
    android:layout_width="0dp"
    android:layout_toLeftOf="@+id/btnExpand"/>    
<ImageButton 
    android:id="@id/btnExpand"
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:layout_alignParentRight="true"
    android:src="@drawable/dark_add_sub_item"
    android:clickable="true"
    android:hint="@string/strViewSubItems"
    android:contentDescription="@string/strViewSubItems"/>   
</RelativeLayout> 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T21:50:13.457

需要通知拖动事件的视图必须注册`OnDragListeners`。如果他们需要知道特定事物或事物类型何时移动，例如为了改变它们的外观（“把我拖到这里！”或“你不敢把它丢在我身上！”）。即使您的视图不是放置被拖动对象的有效位置，如果可以说它需要“拖动上下文感知”，它也会注册 an`OnDragListener`并返回 true for `ACTION_DRAG_STARTED`。

我从你非常彻底的问题中遗漏的一件事是你到底需要清理什么？如果您只需要做一些在活动范围内的通用事情，您可能会考虑向注册事件但等待提醒活动执行通用清理代码`OnDragListener`的基础添加不同的`RelativeLayout``ACTION_DRAG_ENDED`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-28T21:59:36.143

这可能与这个问题有关：

[https://code.google.com/p/android/issues/detail?id=25073](https://code.google.com/p/android/issues/detail?id=25073)

按照该链接的建议覆盖 dispatchDragEvent 函数对我有用：

```
@Override
public boolean dispatchDragEvent(DragEvent ev){
    boolean r = super.dispatchDragEvent(ev);
    if (r && (ev.getAction() == DragEvent.ACTION_DRAG_STARTED
            || ev.getAction() == DragEvent.ACTION_DRAG_ENDED)){
        // If we got a start or end and the return value is true, our
        // onDragEvent wasn't called by ViewGroup.dispatchDragEvent
        // So we do it here.
        onDragEvent(ev);
    }
    return r;
} 
```

# perl - 在 perl 中行走的 Dom

> ID：12184518
> 
> 赞同：0
> 
> 时间：2012-08-29T18:44:38.303
> 
> 标签：perl, dom

使用下面的示例。我有一个使用[Mojo::DOM](http://search.cpan.org/perldoc?Mojo::DOM)解析的 HTML 文件。但是，我在其中一个页面中遇到了一个场景，其中有两个类，我需要读取两个类（问题和答案），其中包括一个标签及其需要填充的相应文本框。我在检索标签及其相应的文本框时遇到问题，以便我可以将正确的值填写到正确的框中。

```
<td class="Question">1</td>
<td class="Answer"><input type="text"/></td>
<td class="Question">2</td>
<td class="Answer"> <input type="text"/></input></td>
<td class="Question">3</td>
</td class="Answer"><input type="text"/></td> 
```

请对我如何使用perl进行操作有任何想法？请注意，每个标签的内部文本会在每次脚本运行时发生变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T12:55:44.237

在摆弄 Mojo::Dom 之后，我能够选择标签的值，然后我将它与 WWW::Mechanize 结合起来，将其填充到输入文本框中。

```
my $url = "http://MyURL/Path"
my $mech  = WWW::Mechanize->new( agent => 'Mozilla/4.0 (compatible; MSIE 8.0; Windows 
NT 6.1)');
$mech->get($url);
$dom =  Mojo::DOM->new($mech->content);
my @temp =  $dom->find('.Question')->map(sub{$_->text})->each ; 
```

它返回的数组按照我想要的顺序离开它。我从[http://blogs.perl.org/users/joel_berger/2012/05/using-mojodom.html](http://blogs.perl.org/users/joel_berger/2012/05/using-mojodom.html)获得了参考，如果有人需要一个易于使用的工具，它确实很有帮助。

# html - 覆盖样式标题中的跨度样式

> ID：12184520
> 
> 赞同：0
> 
> 时间：2012-08-29T18:44:53.357
> 
> 标签：html, css

这应该是一个简单的解决方案，但我似乎无法弄清楚。看看[小提琴](http://jsfiddle.net/n9EKu/1/)。为什么我不能覆盖第二个跨度的字体大小？这是代码：

html:

```
<h1>
    <span>hello </span>
    <span id="span2">world</span>
</h1> 
```

CSS：

```
h1
{
    font-size:2em;
}
h1  #span2
{
    font-size:1em !important;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:48:05.313

因为您将字体大小设置`<h1>`为 2em。你内部的跨度`<h1>`是 1 em，这意味着类似于 100% 的继承字体大小。看看如果你设置`span2`to`0.5em` 和 btw 的字体大小会发生什么，你的第一个跨度缺少正确的结束标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:47:23.803

添加

```
 #span2     {
  font-size:1em !important;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:49:25.673

试试这个

```
h1 span
{
    font-size:2em;
}
h1 span#span2
{
    font-size:1em !important;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:00:15.440

em 是相对测量单位。你几乎可以用“%”代替“em”。因此，当您的跨度规则有“1em”时，它被解释为“让我 100% 成为我父母的大小”，因此没有效果。

如果你希望它是 h1 大小的一半，你需要：

```
#span2 {
   font-size: .5em;
} 
```

[看到这个更新的小提琴](http://jsfiddle.net/n9EKu/1/)。

# c# - 新的动态对象的列表<>

> ID：12184521
> 
> 赞同：3
> 
> 时间：2012-08-29T18:44:56.753
> 
> 标签：c#, asp.net, c#-4.0

我有一些代码给我带来了一些麻烦。

我正在尝试将图像列表捆绑到一个 zip 文件中。我遇到的问题是，有时，其中一个图像在访问时会被打开，从而导致异常。

我很确定这是一个时间问题，所以我正在编写一个“第二次机会”循环来捕捉失败的图像（与现有的行为相反，它会在任何错误时停止并返回它迄今为止所拥有的） .

我在 try 块中有可能出错的代码部分，如下所示

```
if (!Directory.Exists(physicalPath + "/" + fi.Description))
{
    Directory.CreateDirectory(physicalPath + "/" + fi.Description);
}
wc.DownloadFile(source, physicalPath + "/" + fileName);
ze = zip.AddFile(physicalPath + "/" + fileName, path);
ze.FileName = fileName; 
```

“ze”是 Ionic.Zip 库中的“ZipEntry”，“wc”是 WebClient。

在我的捕获中，我需要存储两条信息：'source' 和由'physicalPath + "/" + filename' 产生的字符串。

我知道 .NET 4 中有一种方法可以动态创建一个新对象来保存这些数据，但我不记得它叫什么了。这极大地阻碍了我的google-fu。

如何创建一个动态对象来保存一对字符串（最好在变量上带有属性名称）而不创建一个全新的类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:47:13.047

你指的是元组吗？

[http://msdn.microsoft.com/en-us/library/system.tuple.aspx](http://msdn.microsoft.com/en-us/library/system.tuple.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T18:50:32.230

您可以像这样创建[匿名类型](http://msdn.microsoft.com/en-us/library/bb397696.aspx)：

```
var obj = new { str1 = "something", str2 = "something else" };
Console.WriteLine(string.Format("str1: {0}, str2: {1}", obj.str1, obj.str2)); 
```

**编辑 #1** 制作匿名类型的数组...

```
var arr = new[] { 
            new { str1 = "a", str2 = "b" },
            new { str1 = "c", str2 = "c" },
        }; 
```

**编辑＃2**要从中制作*通用列表*，您必须变得更加花哨...

```
var obj = new { str1 = "", str2 = "" };
var type = typeof(List<>);
var listType = t.MakeGenericType(obj.GetType());
var list = (IList)Activator.CreateInstance(listType);
list.Add(new { str1 = "something", str2 = "something else" });

Console.WriteLine(((dynamic)list[0]).str1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T18:51:50.933

**如何创建一个动态对象来保存一对字符串（最好在变量上带有属性名称）而不创建一个全新的类？**

使用[元组](http://msdn.microsoft.com/en-us/library/system.tuple.aspx)。

```
// this uses a tuple to create a generic class that holds two string values.
// We also use string.Format instead of path + "/" + fileName to generate the second value.
var zipData = new Tuple<string, string>(source, string.Format("{0}/{1}", physicalPath, fileName)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-29T18:49:15.943

还是动态对象？[http://msdn.microsoft.com/en-us/library/dd264736.aspx](http://msdn.microsoft.com/en-us/library/dd264736.aspx)

# coldfusion - ColdFusion 9 中的 OpenID、Facebook Connect 和 Twitter OAuth

> ID：12184523
> 
> 赞同：1
> 
> 时间：2012-08-29T18:45:04.630
> 
> 标签：coldfusion, oauth, openid, coldfusion-9

有人可以帮助我在 ColdFusion 9 应用程序中将 OpenID、Facebook Connect 和 Twitter OAuth 实现为单点登录。我在[RiaForge](http://riaforge.org)上检查了基于 ColdFusion 的 OpenID 脚本，并在中间丢失了将返回的经过身份验证的数据存储到数据库中。我找不到关于这个的好的教程。如果有人可以指导我，那就太好了。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T21:50:43.360

ColdFusion Meetup 小组最近对此进行了介绍：

“CFMeetup：使用 Twitter/Facebook/Google/more 轻松进行身份验证”

[http://experts.adobeconnect.com/p6wit9dnz39/](http://experts.adobeconnect.com/p6wit9dnz39/)

Charlie Arehart 在此处维护大量 CF 演示文稿：http: [//www.carehart.org/ugtv/](http://www.carehart.org/ugtv/)

# c++ - C++：如何读取目录中的所有 jpg 文件？

> ID：12184527
> 
> 赞同：1
> 
> 时间：2012-08-29T18:45:17.767
> 
> 标签：c++, jpeg, readfile

如何读取目录中的所有 jpg 文件？这些文件是电影的帧，它们的名称是“0000.jpg”，“0001.jpg”，...。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:51:12.067

你在寻找类似的东西`dir *.jpg`吗`ls *.jpg`？如果您想在表单中使用 boost：

```
BOOST_FOREACH( const std::string& fname, ls( "./*.cpp" ))
    std::cout << fname << std::endl ; 
```

您可以使用此处的 ls 函数：http: [//greg-n-blog.blogspot.com/2010/01/ls-using-boost.html](http://greg-n-blog.blogspot.com/2010/01/ls-using-boost.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T20:03:17.723

libjpeg 是一个流行的 jpeg 解码器库

枚举目录可以使用 boost 库中的一个类来完成：

```
boost::filesystem::directory_iterator 
```

# jquery - 重用来自 jquery-ui 框架类的 css 属性？

> ID：12184536
> 
> 赞同：2
> 
> 时间：2012-08-29T18:45:58.673
> 
> 标签：jquery, css, jquery-ui, sass, less

jQueryUI 提供了一个方便的 css 框架：http: [//jqueryui.com/docs/Theming/API](http://jqueryui.com/docs/Theming/API)

[只需使用 jQueryUI 的 CSS 类（ui-widget-content、ui-widget-header 等），您就可以通过http://jqueryui.com/ThemeRoller](http://jqueryui.com/ThemeRoller)轻松创建可主题化的 html-snippets

我在设计我的应用程序时有时缺少的一个功能是重用 jquery-UI 的 CSS 类中的 css 属性，但不是所有属性。通过使用`none !important`.

例如，当您只想获得没有背景或边框的前景`color`时`.ui-widget-content`，您可以这样做：

```
<style>
.no-background { background: none !important; }
.no-border { border: none !important; }
</style>
<div class="ui-widget-content no-background no-border">
  hi world :)
</div> 
```

但是，有没有一种简单的方法可以在我自己的 CSS 类中获取并重用`background-color`它？`.ui-widget-header``color`

我为此做了一个快速而肮脏的解决方案：使用 JavaScript 和 DOM 操作填充样式标签。

JSBin：http: [//jsbin.com/ijuxar/7/edit](http://jsbin.com/ijuxar/7/edit)

HTML 代码：

```
<style class="computedStyles"></style>
<div class="cssHelper ui-helper-hidden-accessible" style="visibility: hidden">
  <div class="ui-widget-header"></div>
  <div class="ui-widget-content"></div>
  <div class="ui-state-default"></div>
  <div class="ui-widget-header ui-state-active"></div>
  <div class="ui-widget-header ui-state-hover"></div>
</div>
<h1 class="ui-color-2">Hi World</h1> 
```

JS代码：

```
$(document).ready(function () {
  var css= '', i, colors = [
      $('.cssHelper .ui-widget-content').css('color'),
      $('.cssHelper .ui-widget-header').css('background-color'),
      $('.cssHelper .ui-state-hover').css('background-color'),
      $('.cssHelper .ui-state-default').css('background-color'),
      $('.cssHelper .ui-widget-header.ui-state-active').css('background-color')
  ];
  for (i = 0; i < colors.length; i += 1) {
      css += '.ui-color-' + (i + 1) + ' { color: ' + colors[i] + '}\n';
  }
  $('style.computedStyles:first').text(css);
}); 
```

我觉得 JavaScript 解决方案有些邪恶。此外，它会在某些浏览器中导致[FOUC 。](http://www.bluerobot.com/web/css/fouc.asp/)

是否可以使用纯 CSS 和/或服务器端工具（SASS/LESS/...）来完成它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:00:06.390

CSS 代表层叠样式表。这意味着由类设置的样式将“级联”

因此，如果您有自己的 css 文件，并将其包含在 jquery css 之后。它将超越 jquery css。同样，如果您将 2 个类附加到一个 html 元素，则第 2 个类样式将覆盖第一个类。

另一种重写 CSS 类的特定样式的方法是在你的 CSS 上使用 !important 指示符。标记为 !important 的东西不会被与它们出现的顺序无关的东西覆盖。

所以回答你的问题。在您自己的 css 文件中，让您的类指定颜色，如下所示：

```
.myColour{
    background-:none!important;
    border:none!important;
} 
```

并像这样对你的元素进行分类：

```
<div class="ui-widget-content myColour" >
  hi world :)
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T11:19:40.920

由于您也用 less 标记了您的问题，我想您可以使用它。会有一个适合您的解决方案，也许并不完美，但 imo 比您现在使用的更干净。

您可能知道您可以在样式声明 B 中使用类名 A 将所有样式属性从 A 应用到类 B。它称为 Mixin： http: [//lesscss.org/#-mixins](http://lesscss.org/#-mixins)

我想你可以通过首先使用 mixin 然后覆盖它的属性来实现你所追求的。你的语法看起来像这样：

**少主：**

```
@import "jquery-ui.less"

 ... 

.myCustomWidget {
  .ui-widget-content;
  background: none;
  border: none;
}

... 
```

请注意，我将 jquery-ui.css 的扩展名更改为 .less 以使 less 编译器实际包含该文件，而不是保留 @import 语句。由于 css 也是有效的，所以你需要对它做的所有事情。

如果您随后将 less 编译为 css，您将获得一个类 .myCustomWidget，您可以在 HTML 中使用 apply，而无需额外的类。此外，如果您通过应用不同的主题或其他内容来更改 jquery-ui.css，则只需重新编译 master.less 即可合并更改。（我强烈建议你在本地或服务器端预编译你的less文件，而不是让它在客户端由js完成。这样可以防止你的样式依赖于js）

另请注意，您将不再需要链接到 html 中的实际 jquery-ui.css 文件，因为它将完全包含在已编译的 master.css 文件中。这意味着少了一个页面请求，这应该会给你一个性能奖金。

# wordpress - 替换 Wordpress 中的 query_posts() 函数

> ID：12184537
> 
> 赞同：0
> 
> 时间：2012-08-29T18:46:02.510
> 
> 标签：wordpress

我想创建一个自定义函数来替换 query_posts()。此自定义功能需要包含某些自定义帖子类型。

我知道您可以使用 query_posts() 并将 post_type 数组指定为参数，但由于这个特定的自定义查询帖子将用于多个页面模板，我想避免在创建新的自定义帖子类型时编辑多个模板。

所以，我正在寻找类似的东西

mycustom_query_posts($args) 调用我的页面模板。问题是，如何创建这个 mycustom_query_posts($args)？

预先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:19:25.287

Wordpress 已经为您做到了：

[WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

# java - Hibernate相同查询多个别名和性能问题

> ID：12184538
> 
> 赞同：3
> 
> 时间：2012-08-29T18:46:02.727
> 
> 标签：java, sql, performance, spring, hibernate

**有人可以解释为什么 Hibernate 会为同一个查询生成不同的别名吗？**(ABC1_25, ABC1_27 ...)

*如何配置 Hibernate 以重用具有相同别名的相同查询？查询如何被缓存或优化？*

我正在使用的应用程序正在生成具有不同别名的相同查询，如下所示：

```
 SELECT abc0_.ATTR_ID AS ABC1_25_,
     abc0_.ALLOW AS ALLOW2_25_,
     abc0_.ALTER_DATE AS ALTER3_25_,
     abc0_.CREATE_DATE AS CREATE6_25_,
 FROM ABCTABLE abc0_
 WHERE abc0_._ID = :1

 SELECT abc0_.ATTR_ID AS ABC1_27_,
     abc0_.ALLOW AS ALLOW2_27_,
     abc0_.ALTER_DATE AS ALTER3_27_,
     abc0_.CREATE_DATE AS CREATE6_27_,
 FROM ABCTABLE abc0_
 WHERE abc0_._ID = :1 
```

**这会导致处理器和内存消耗。**

我遇到了这个链接： [Hibernate 为每个查询生成不同的 SQL](https://stackoverflow.com/questions/9452183/hibernate-produce-different-sql-for-every-query)但没有找到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T21:38:10.783

Maybe you have several instances of the `SessionFactory`, instead of using a singleton. That's what the OP of the other question found.

# mysql - MySQL十进制列的值超出范围

> ID：12184539
> 
> 赞同：0
> 
> 时间：2012-08-29T18:46:12.830
> 
> 标签：mysql, decimal, range

搜索后，我发现很多超出范围的问题，人们不知道十进制（m，n）中的第一个数字 m 是数字的总数。然而，这不是我的问题。

对于有问题的专栏，我有以下内容：

```
Field | Type                   | Null | Key | Default | Extra
preco | decimal(50,2) unsigned | NO   |     | 0.00    | 
```

设置小数（50,2）比我真正想要或需要的要多得多。我真的只想要10位数。它是一个价格，所以任何超过 1 亿的东西都可能是荒谬的，所以 decimal(10,2) 可能更合适。但是，MySQL 不接受以下查询：

```
INSERT INTO `produto` (`tipo_id`, `preco`, `qtd`, `opcao1`) VALUES (110, '77888555.43', '10', 'Azul') 
```

我通过 CodeIgniter、phpMyAdmin 和直接在 MySQL 命令行客户端中尝试了查询。我也试过没有十进制值的引号，但我总是得到同样的错误：

“第 2 行的 'preco' 列的值超出范围”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:47:55.863

您将值`preco`作为字符串发送，MySQL 以与数值相同的方式接受该字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:15:21.010

我已经用[SQLyog](http://www.webyog.com/en/downloads.php)试过了，效果很好。我尝试通过 Table Data 选项卡和使用 Query在[SQLyog中直接更改两种方式。](http://www.webyog.com/en/downloads.php)它只是在工作。十进制范围似乎没有问题，但问题出在其他地方。请参阅随附的屏幕截图

直接通过表数据选项卡 ![直接通过表数据选项卡](../Images/9ccd2f132c134d806aea73227896252c.png)

通过插入查询 ![通过插入查询](../Images/40420478e27589f717d224929d5028d0.png)

表结构![在此处输入图像描述](../Images/6c711da489fb9116b37db1911826e4b9.png)

希望它有帮助...

# reporting-services - 如何动态更改 SSRS Report 的 tablix 的 DirectionLayout 属性以使报表支持英语和阿拉伯语

> ID：12184541
> 
> 赞同：2
> 
> 时间：2012-08-29T18:46:14.873
> 
> 标签：reporting-services

我正在一个支持英语和阿拉伯语的程序中工作，目前我们正在开发程序报告。

我们选择在 WindowsFormsApplication(C#) 中使用带有 ReportViewer 控件的 SSRS 我搜索了一种根据语言（LTR 英语、RTL 阿拉伯语）更改 tablix 的 DirectionLayout 属性的方法，我尝试了很多解决方案但没有成功。

我不想创建两个报告或创建一个包含两个 tablixes 的报告，每个表对应一种语言。

现在我正在尝试执行以下操作：

1.  使用 SSRS Web 服务获取报表定义
2.  编辑报表定义（将 Tablex DirectionLayout 转换为 RTL）
3.  使用 SSRS 执行服务加载定义并呈现报表
4.  将呈现的报表分配给 ReportViewr 控件

我想知道这可能吗？我在哪里可以搜索来完成这项任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T13:17:21.860

1）根据您使用的 SSRS 版本，您可以使用 GetReportDefinition 方法（[http://msdn.microsoft.com/en-us/library/reportservice2005.reportingservice2005.getreportdefinition(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/reportservice2005.reportingservice2005.getreportdefinition(v=sql.100).aspx)）或GetItemDefinition ( [http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.getitemdefinition.aspx](http://msdn.microsoft.com/en-us/library/reportservice2010.reportingservice2010.getitemdefinition.aspx) )

2) 您可以使用 RDL 对象模型来编辑 RDL，尽管这并不简单，并且 Microsoft.ReportingServices.RdlObjectModel 命名空间的类被标记为内部（SSRS 2008 R2 及更高版本）。您可以在[http://prologika.com/CS/blogs/blog/archive/2010/03/08/where-is-rdlom-in-r2.aspx](http://prologika.com/CS/blogs/blog/archive/2010/03/08/where-is-rdlom-in-r2.aspx)和 Lionel Ringenbach 在[https:// /github.com/Ucodia/Blog-CustomReportingServices](https://github.com/Ucodia/Blog-CustomReportingServices)。

有关 RDL 对象模型的类和方法的参考信息，请从[http://msdn.microsoft.com/en-us/library/ff493708](http://msdn.microsoft.com/en-us/library/ff493708)开始。

3-4）我认为将您编辑的报告部署回服务器然后使用 ReportViewer 控件调用它会更容易。然后，您可以直接利用可用的方法。ReportViewer 控件可以直接处理呈现。以下是通过 Web 服务进行部署的信息：http: [//tomyrhymond.wordpress.com/2011/08/07/sql-server-reporting-services-deploying-rdl-files/](http://tomyrhymond.wordpress.com/2011/08/07/sql-server-reporting-services-deploying-rdl-files/)

# java - Jasper 报告 -- Hashmap 或子报告

> ID：12184542
> 
> 赞同：0
> 
> 时间：2012-08-29T18:46:33.450
> 
> 标签：java, jasper-reports, ireport

Java应用程序的后端可以返回一系列的表，每个表的结构都是一样的，就像搜索“特定地区的学校信息”可以返回动态的学校数量及其信息一样，现在我们要让每一个学校详细信息作为表格。

```
-School A-
=============================
Name | Address | Student Name

-School B-
=============================
Name | Address | Student Name

....

-School N-
=============================
Name | Address | Student Name 
```

那么我们可以在 Jasper 中使用 HashMap 来省去子报表的麻烦，并且仍然保持一切动态吗？任何提示都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:42:07.303

你能在一张表中返回所有数据吗（你说你现在得到的表具有相同的结构）？

如果不是直接来自数据库，那么编写您自己的数据源类，将所有表包装到 Jasper 的一个数据源中。

然后把数据放到报表的detail中，告诉Jasper在School列上做分组。

# .htaccess - 仅当 HTTP 引荐来源不等于某些东西时，htaccess 才重定向

> ID：12184543
> 
> 赞同：2
> 
> 时间：2012-08-29T18:46:33.777
> 
> 标签：.htaccess, mod-rewrite, http-referer, http-accept-language

我有以下规则可以将中国用户重定向到网站的中文版本：

```
 RewriteCond %{HTTP:Accept-Language} ^zh [NC]
  RewriteCond %{HTTP_HOST} ^www\.example\.com$ [NC]
  RewriteRule ^(.*)$ http://ch.example.com/$1 [L,R=301]

  RewriteCond %{HTTP:Accept-Language} ^zh [NC]
  RewriteCond %{HTTP_HOST} ^example\.com$ [NC]
  RewriteRule ^(.*)$ http://ch.example.com/$1 [L,R=301] 
```

这很好用。

但是，应该有一个链接可以将他们带回到网站的英文版本，这只是普通域（www.example.com）。

但这只是将他们直接重定向回中文网站，因为它符合规则。所以我需要这样做，所以只有当引用者不是 ch.example.com 时才会触发上述规则。

我试过这样的事情：

```
 RewriteCond %{HTTP:Accept-Language} ^zh [NC]
  RewriteCond %{HTTP_HOST} ^www\.example\.com$ [NC]
  RewriteCond %{HTTP_REFERER} !^http?://ch\.example\.com/ [nc]
  RewriteRule ^(.*)$ http://ch.example.com/$1 [L,R=301] 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:52:55.360

当用户在英文网站上查看他们的第二个页面时，它会重定向到中文。一个更好的方法是设置一个cookie然后检查它：

例如：[http ://www.askapache.com/htaccess/htaccess-fresh.html#Set_Cookie_based_Requested_directory](http://www.askapache.com/htaccess/htaccess-fresh.html#Set_Cookie_based_Requested_directory)

# java - Safari 问题：java.lang.ClassFormatError：类文件中的魔法值 1013478509 不兼容

> ID：12184544
> 
> 赞同：0
> 
> 时间：2012-08-29T18:46:34.610
> 
> 标签：java, safari, applet, jnlp, japplet

在 Windows 中使用 Safari 浏览器上的 JNLP 文件从我的 jsf 页面调用 java 小程序时面临问题： **java.lang.ClassFormatError：类文件中不兼容的魔法值 1013478509**

我能够在**Firefox、Chrome 和 IE**中正确调用相同的小程序。

这就是我在我的面孔页面中使用 jnlp 参考的方式：

```
<object classid="java:my.oddc.client.SimpleScanApplet.class" 
                    type="application/x-java-applet"
                    height="100%" width="100%" >
    <param name="jnlp_href" value="/wcc/wcc/upload/scan_client.jnlp"/>
    <param name="ServerURL"
          value="#{pageFlowScope.UploadBean.scanFileURL}"/>
</object> 
```

或者，我尝试使用嵌入和小程序标签，但没有帮助。

另外，我有任务在调用后将一些参数传递给小程序。

scan_client.jnlp 文件包含对所需 jar 和 nativelibs 的引用。

帮助表示赞赏..如何使它在 Safari (Windows) 上运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T23:36:32.810

魔法值拼写`<htm`，因此那里很可能有一个 404（资源不是对象元素所暗示的位置。

# html - ics文件中的html限制

> ID：12184550
> 
> 赞同：3
> 
> 时间：2012-08-29T18:46:55.750
> 
> 标签：html, icalendar

我正在开发一个创建和下载 .ics 文件的函数（C#、ASP.NET 4）。

我试图弄清楚 X-ALT-DESC 属性中的 html 有哪些限制。例如，如果我发送这个：

```
X-ALT-DESC;FMTTYPE=text/html:<html><body><ul><li style="font-weight:bold">#1</li><li>#2</li></ul><table border=1><tr><td>table test</td></tr></table><span style="font-weight:bold">Site Visit Agenda</span><br/><span>8:00 AM</span><br/><span>Check in with management<br/>Facility Inspection<br/>Training and Meeting Setup</span></tr></table></body><html> 
```

当我打开下载的文件时，它会在 Outlook 2010 中打开，所以看起来没问题虽然列表内容按我预期的那样呈现，但表格边框没有显示，也没有呈现任何字体粗细设置。（从好的方面来说，html 标签不会呈现为文本，它只是不会像您在具有相同 HTML 的浏览器中看到的那样格式化 alt desc）。

当然，我们试图弄清楚我们可以使用和不能使用哪些 HTML 来格式化我们希望在 alt 描述中显示的信息。

环顾四周，我找不到任何谈论什么是允许的，什么是不允许的。

感谢任何有指针的人。

# php - 遍历数组以找到所有可能的重复组合

> ID：12184553
> 
> 赞同：-1
> 
> 时间：2012-08-29T18:47:06.380
> 
> 标签：php, arrays

我需要帮助遍历一个简单的数组并找到其元素的所有可能组合，如下所示：

```
array('a', 'b', 'c'); 
```

预期结果是：

```
array(
     0=>array('a', 'a', 'a'),
     1=> array('a', 'a', 'b')
); 
```

我完全不知所措，非常感谢任何帮助或指点！

这就是我到目前为止所拥有的。

```
$array = array('red', 'blue', 'green', 'white');
$count = count($array);

$current = array_fill(0, $count, $array[0]);
$last = array_fill(0, $count, end($array));

$output = array();
$i = 0;

while ($current != $last) {
    $indexes = str_pad($i, $count, "0", STR_PAD_LEFT);

    $j = str_split($indexes);

    foreach ($j as $a => $b) {
        if (isset($array[$b])) {
            $output[$i][] = $array[$b];
        }
    }
    $current = $output[$i];
    $i++;
}
// cleaver duplication removal
$result = array_map("unserialize", array_unique(array_map("serialize", $output)));

echo '<pre>';
    print_r($result);
echo '</pre>'; 
```

重复删除代码来自[这里](https://stackoverflow.com/questions/307674/how-to-remove-duplicate-values-from-a-multi-dimensional-array-in-php)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:52:05.813

```
function pc_permute($items, $perms = array( )) {
    if (empty($items)) { 
        print join(' ', $perms) . "\n";
    }  else {
        for ($i = count($items) - 1; $i >= 0; --$i) {
             $newitems = $items;
             $newperms = $perms;
             list($foo) = array_splice($newitems, $i, 1);
             array_unshift($newperms, $foo);
             pc_permute($newitems, $newperms);
         }
    }
} 
```

[资源。](http://docstore.mik.ua/orelly/webprog/pcook/ch04_26.htm)

# javascript - 乘除法

> ID：12184554
> 
> 赞同：0
> 
> 时间：2012-08-29T18:47:10.450
> 
> 标签：javascript

我正在和我的同事交谈，他说在代码中乘法比除法更好，但他没有争论为什么它更好，所以我决定找出来，所以：

例如，哪种情况更好：

```
var caseOne = x / 2; 
```

或者

```
var caseTwo = x * 0.5; 
```

以及每个人的表现如何？

感谢所有答案:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:48:53.350

这种微优化真的不值得付出可读性成本。你真的应该写出有意义的代码。无论如何，编译器通常都会进行优化。

编写将来易于阅读、维护和解释的代码，这样您就不必围绕您的解决方案工作，或者更糟的是，引入错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:52:02.663

看看这些测试：

*   [http://jsperf.com/efqw4/3](http://jsperf.com/efqw4/3)
*   [http://jsperf.com/multiply-vs-division](http://jsperf.com/multiply-vs-division)

这可能是一个很小的优化，你不应该担心它..

# python - 使用 Portable Python 轻松安装：没有名为 parse 的模块

> ID：12184558
> 
> 赞同：2
> 
> 时间：2012-08-29T18:47:18.957
> 
> 标签：python, pandas, easy-install, portable-python

我已经在 Windows XP 上安装了带有 Portable Python 2-7 的 easy_install（通过分发模块）。但是当我键入一个 DOS 命令时，例如

```
easy_install pandas 
```

我得到以下信息： ![在此处输入图像描述](../Images/6ac1ec9fba5d5e5084a1e723b924b068.png)

而且我在互联网上找不到任何“解析”模块（并且“easy_install parse”产生相同的输出）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:51:16.663

错误与模块有关`urllib.parse`，而不是`parse`。[urlparse 模块](http://docs.python.org/library/urlparse.html)的文档说：

> urlparse 模块在 Python 3 中重命名为 urllib.parse。

这意味着您的代码预计将与 Python 3 一起运行。您正在运行 Python 2.7，这意味着它将无法工作（因为该模块`urllib.parse`仍被称为`urlparse`）。也许您需要考虑安装支持 Python 3 的 Portable Python 版本？

# sql - GROUP BY 与 ORDER BY 结合

> ID：12184566
> 
> 赞同：13
> 
> 时间：2012-08-29T18:47:43.727
> 
> 标签：sql, oracle, group-by, sql-order-by

> GROUP BY 子句对行进行分组，但不一定按任何特定顺序对结果进行排序。要更改顺序，请使用 GROUP BY 子句之后的 ORDER BY 子句。**ORDER BY 子句中使用的列必须出现在 SELECT 列表中，这与 ORDER BY 的正常使用不同。**[Oracle 示例，第四版，第 274 页]

这是为什么？为什么使用 GROUP BY 会影响 SELECT 子句中所需的列？

此外，在我不使用 GROUP BY 的情况下：为什么我要对某些列进行排序，然后只选择列的一个子集？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T18:51:32.957

**实际上，正如 Dave Costa 的例子所示，**这种说法并不完全正确。****

 **Oracle 文档说可以使用表达式，但表达式必须基于选择列表中的列。

> expr - *expr*根据 expr 的值对行进行排序。该表达式基于选择列表中的列或 FROM 子句中的表、视图或实例化视图中的列。来源：Oracle® 数据库 SQL 语言参考 11g 第 2 版 (11.2) E26088-01 September 2011。第 19-33 页

来自同一工作页面 19-13 和 19-33（PDF 中的第 1355 和 1365 页）

![在此处输入图像描述](../Images/cfa22feb82eb102ee36ab706852a8856.png)

![在此处输入图像描述](../Images/6241232538f47ac3f7cd14260280a261.png)

[http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#SQLRF01702](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#SQLRF01702)

[http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#i2171079](http://docs.oracle.com/cd/E11882_01/server.112/e26088/statements_10002.htm#i2171079)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-29T18:56:14.840

您报价中的粗体文本不正确（在许多常见用例中这可能是一种过度简化，但严格来说，这并不是一个要求）。例如，这个语句执行得很好，虽然`AVG(val)`不在选择列表中：

```
WITH DATA AS (SELECT mod(LEVEL,3) grp, LEVEL val FROM dual CONNECT BY LEVEL < 100)
SELECT grp,MIN(val),MAX(val)
FROM DATA
GROUP BY grp
ORDER BY AVG(val) 
```

ORDER BY 子句中的表达式必须能够在 GROUP BY 的上下文中进行计算。例如，`ORDER BY val`在上面的示例中不起作用，因为表达式`val`对于分组产生的每一行没有不同的值。

至于你的第二个问题，你可能关心排序但不关心排序表达式的值。从选择列表中排除不需要的表达式可以减少实际上必须从服务器发送到客户端的数据量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T18:59:38.060

第一的：

group by 的实现是创建一个在结构上与原始 from 子句（表视图或某些连接表）不同的新结果集。该结果集由所选内容定义。

并非每个 SQL RDBMS 都有此限制，尽管始终要求排序的内容是非分组列（ 、 等）的聚合函数`AVG`或分组`SUM`的列之一，或基于多个列的函数那些结果（比如添加两列），因为这是分组操作结果的逻辑要求。

第二：

因为您只关心该列的排序。例如，您可能有一个最畅销单曲的列表，但没有给出他们的销量（《纽约时报》畅销书对其数据的一些细节保密，但确实有一个排名列表）。当然，您可以通过选择该列然后不使用它来解决此问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T18:54:12.067

数据在按 ORDER BY 排序之前进行聚合。

如果您尝试按任何其他列（不在 group by 列表或聚合函数中）排序，将使用什么值？没有用于排序的单一值。

我相信您可以使用值的组合进行排序。所以你可以说：

```
order by a+b 
```

如果 a 和 b 在 group by 中。您只是不能引入 SELECT 中未提及的列。但是，我相信您可以使用 SELECT 中未提及的聚合函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T18:52:44.207

样品表

```
sample.grades
Name   Grade    Score
Adam   A        95
Bob    A        97
Charlie C       75 
```

使用 GROUP BY 的第一个查询

```
Select grade, count(Grade) from sample.grades GROUP BY Grade 
```

输出

```
Grade Count
A     2
C     1 
```

使用 order by 的第二个查询

```
select Name, score from sample grades order by score 
```

输出

```
Bob    A        97
Adam   A        95
Charlie C       75 
```

使用 GROUP BY 和排序的第三个查询

```
Select grade, count(Grade) from sample.grades GROUP BY Grade desc 
```

输出

```
Grade Count
A     2
C     1 
```

一旦你开始使用像 Count 这样的东西，你必须有 group by。您可以将它们一起使用，但它们有非常不同的用途，我希望这些示例清楚地表明了这一点。

为了尝试回答这个问题，为什么 group by 会影响 select 部分中的项目，因为这就是 group by 的目的。如果您不按该列分组，则无法对列进行计数。

第二个问题，为什么要排序但不选择所有列？如果我想按分数排序，但不关心实际成绩甚至我可能会做的分数

```
select name from sample.grades order by score 
```

输出

```
Name
Bob
Adam
Charlie 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T18:52:12.673

您希望看到哪些结果按未列在选择列表中且未参与 group by 子句的列排序？在任何情况下，SELECT 列表列中未提及的所有排序方式都将被省略，因此 Oracle 人员正确添加了限制。

```
with c as (
select 1 id, 2 value from dual
union all
select 1 id, 3 value from dual
union all
select 2 id, 3 value from dual
)
select id
from c
group by id
order by count(*) desc 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-29T18:52:56.980

这里是我的理解

“GROUP BY 子句对行进行分组，但不一定按任何特定顺序对结果进行排序。”

-> 您可以使用 Group by 而无需 order by

“要更改顺序，请使用 GROUP BY 子句之后的 ORDER BY 子句。”

-> 行由默认主键选择，如果添加 order by 则必须在 group by 之后添加

“ORDER BY 子句中使用的列必须出现在 SELECT 列表中，这与 ORDER BY 的正常使用不同。”**

# javascript - 舍入日期（）毫秒

> ID：12184575
> 
> 赞同：1
> 
> 时间：2012-08-29T18:47:58.913
> 
> 标签：javascript

您好，我想`Date()`在几秒钟后将变量四舍五入为 3 位数，示例如下：

初始值：`2012-08-29T21:28:28.8789063+03:00`
我想要达到的值：`2012-08-29T21:28:28.88`

或者如果我真的不能这样做，我想从末尾开始删除 10 个字符，如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:51:16.053

使用 substring 或 substr 函数并从长度中减去 10 个字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:54:26.807

我使用[jQuery dateFormat 插件](https://github.com/phstc/jquery-dateFormat)来格式化日期。

要删除最后 10 个字符，请尝试：

```
date = dateObj.toString();
formattedDate = date.substr(0, date.length-10); 
```

# java - RandomAccessFile 将 ETX M 添加到文件开头

> ID：12184579
> 
> 赞同：0
> 
> 时间：2012-08-29T18:48:09.823
> 
> 标签：java, file-io

这是在 CentOS 6.2 上。我正在写入一个文本文件，它在开头添加了一个 ETX M。（ETX是角色的名字）

```
file.setLength(0);
file.seek(0);
file.writeUTF(somestring); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T20:00:57.017

从[文档](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html)中引用`RandomAccessile.writeUTF()`

> 首先，将两个字节写入文件，从当前文件指针开始，就好像通过 writeShort 方法给出了后面的字节数。这个值是实际写出的字节数，而不是字符串的长度。在长度之后，按顺序输出字符串的每个字符，对每个字符使用修改后的 UTF-8 编码。

如果您不想要这个，请手动将字符串转换为字节并使用基本`write()`方法写入这些字节（nb:`writeBytes()` *不是*您想要的）。但是，您将需要一些方法来跟踪字符串的大小以便再次读取它（除非您使用固定宽度的字段）。

# javascript - 将球体 a 旋转到 b 指向自身

> ID：12184589
> 
> 赞同：3
> 
> 时间：2012-08-29T18:48:48.030
> 
> 标签：javascript, math, webgl, three.js

我试图弄清楚如何将球体从自身的 A 点旋转到自身的 b 点。我找到了一些 Unity3d 代码：

```
Quaternion rot = Quaternion.FromToRotation (pointA, pointB);
sphere.transform.rotation *= rot; //Multiply rotations to get the resultant rotation 
```

通过[http://answers.unity3d.com/questions/21921/rotate-point-a-on-sphere-to-point-b-on-sphere.html](http://answers.unity3d.com/questions/21921/rotate-point-a-on-sphere-to-point-b-on-sphere.html)但我不知道如何在三中实现它。 js。

这是我的代码：

```
var s = sphere mesh
var va = 1st start vector
var vb = 2nd end vector;

var qa = new THREE.Quaternion(va.x, va.y, va.z, 1);
var qb = new THREE.Quaternion(vb.x, vb.y, vb.z, 1);
var qc = new THREE.Quaternion();

THREE.Quaternion.slerp(qa, qb, qc, 1);

s.useQuaternion = true;
s.quaternion = qc; 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:02:18.407

假设球体以原点为中心`A`并且`B`被归一化（即单位长度）。然后计算[叉积](http://en.wikipedia.org/wiki/Cross_product) `C = A×B`。这是代表旋转轴的矢量。旋转的角度由单位向量和的[点积](http://en.wikipedia.org/wiki/Dot_product)给出。请注意，这种情况下的角度通常以弧度为单位，而不是度数。`θ = cos^(-1)(A∙B)``A∙B``A``B`

如果球体以某个点`P`而不是原点为中心，或者它的半径不是单位长度，则必须在导出旋转之前平移和缩放 A 和 B。这看起来像：

```
A' ← (A-P)/|A-P|     // Normalized version of A
B' ← (B-P)/|B-P|     // Normalized version of B
V ← A'×B'            // Axis about which to rotate the system
θ ← cos^(-1)(A'∙B')      // Angle by which to rotate
```

然后，您可以使用`V`and`θ`作为构造四元数的参数，您将用于定义旋转。此旋转将以原点为中心，因此在应用它之前，先平移 -P，然后应用旋转，再平移回 P。

注意：此处可能存在符号错误。如果它不起作用，那是因为叉积的符号与点积的符号不匹配。如果这是一个问题，只需颠倒叉积中参数的顺序即可修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-08T11:36:57.560

```
var c = group.rotation.y;
var d = -b * (Math.PI / 180)%(2 * Math.PI);
var e = Math.PI / 2 * -1;
group.rotation.y = c % (2 * Math.PI);
group.rotation.x = a * (Math.PI / 180) % Math.PI;
group.rotation.y= d+e; 
```

其中 a= 纬度，b= 经度，group=Object3D（或球体）

# knockout.js - Knockout JS 和单选按钮在第一次点击时没有绑定

> ID：12184596
> 
> 赞同：4
> 
> 时间：2012-08-29T18:49:17.687
> 
> 标签：knockout.js

我正在使用淘汰赛 JS 开发瘦客户端，并且在单选按钮方面遇到了一些问题，希望这里的某个人能够提供一些见解，了解可能导致这种情况的原因以及我可以采取哪些措施来纠正这种情况。

我对一系列单选按钮有一个相当典型的布局。

```
<p data-bind="text: background().description"></p>
<div data-bind="foreach: backgroundOptions" class="bg-options">
    <p data-bind="text: description" class="color-swatch"></p>
    <input type="radio" name="backgroundsGroup" data-bind="checked: $parent.backgroundId, value:id"/>
</div>​ 
```

您可以看到我正在绑定到父对象的 backgroundId。

父对象和正在显示的对象的 JS 如下所示：

```
var CardBackground = function(imagePath, swatchPath, id, description) {
    var self = this;

    var _imagePath = imagePath;
    self.imagePath = ko.observable(_imagePath);

    var _id = id;
    self.id = ko.observable(_id);

    var _description = description;
    self.description = ko.observable(_description);

    var _swatch = swatchPath;
    self.swatchPath = ko.observable(_swatch);
};

var Card = function() {
    var self = this;
    getBackgrounds = function() {
        var bgs = [
            new CardBackground("noCardLarge.jpg", "card_swatch-blue.jpg", -1, "None Selected"),
            new CardBackground("greenCard.jpg", "card_swatch-green.jpg", 10, "Green Contour Card"),
            new CardBackground("purpleCard.jpg", "card_swatch-purple.jpg", 11, "Purple Contour Card"),
            new CardBackground("redCard.jpg", "card_swatch-red.jpg", 12, "Red Contour Card"),
            new CardBackground("whiteCard.jpg", "card_swatch-white.jpg", 13, "White Contour Card"),
            new CardBackground("yellowCard.jpg", "card_swatch-yellow.jpg", 14, "Yellow Contour Card")
            ];
        return bgs;
    }
    self.backgroundOptions = getBackgrounds();

    var _defaultBackground = self.backgroundOptions[0];
    self.defaultBackground = ko.observable(_defaultBackground);

    var _background = self.defaultBackground();
    self.background = ko.observable(_background);

    self.backgroundId = ko.computed({
        read: function() {
            var values = self.backgroundOptions;
            return values.length ? values[0] : [];
        },

        write: function(newValue) {
            for (var i = 0; i < self.backgroundOptions.length; i++) {
                if (self.backgroundOptions[i].id() == newValue) {
                    self.background(self.backgroundOptions[i]);
                    return;
                }
            }
        },
        owner: this
    });
}; 
```

现在只需单击两次即可使绑定最初采取行动，然后只需单击一下即可。

此外，即使设置了默认值，也不会选择相应的选项框。如果您更改默认背景上的索引，上面的描述是正确的，但单选按钮不正确。

我已经创建了一个例子。
[http://jsfiddle.net/JS2GV/2/](http://jsfiddle.net/JS2GV/2/)

任何人可能有的见解将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T20:04:50.420

为了让它在初始绑定时选择 defaultBackground，将 self.backgroudId 读取为...

```
return _background.id(); 
```

因此选中的绑定将获得“选定”背景的 id，然后将无线电输入绑定的顺序切换为...

```
"value:id, checked: $parent.backgroundId" 
```

因此值绑定将为使检查的绑定正常工作所需的输入分配一个值。

关于获得更改选项所需的双击，这是因为 ViewModel 中的 id 是整数，而生成的无线电输入中的值表示为字符串。要修复将视图模型中的所有 id 包装在引号中，以便它们是字符串。

这是一个更新的 jsfiddle... [http://jsfiddle.net/JS2GV/11/](http://jsfiddle.net/JS2GV/11/)

# php - 如何动态地将一个列值分配给另一个？

> ID：12184600
> 
> 赞同：0
> 
> 时间：2012-08-29T18:49:25.377
> 
> 标签：php, mysql, phpmyadmin

我有两个名为“关注”和登录的表。它包含以下字段。

```
Table Name: follow
Fields:     id,user_id,follow_id

Table Name: login
Fields:     id,email,username,password,phone 
```

我想在“登录”表中显示人名。我必须动态地提供他们的 user_id 以获取表中的 follow_id，并将上述 follow_id 分配为 user_id，然后获取 follow_id 以显示登录表中的名称。

我已经编写了如下查询，它返回空集。

```
SELECT DISTINCT follow.follow_id,follow.user_id,login.username 
FROM follow,login 
WHERE  follow.user_id =".$userid." 
    AND follow.user_id=follow.follow.id 
    AND login.id = follow.follow_id 
```

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:59:24.460

我认为有一个不必要的条件 `and follow.user_id=follow.follow.id`

您所说的“还将上述 follow_id 分配为 user_id”是什么意思。

# java - 在不使用 Servicefactory 的情况下获取 JDBC 数据库连接

> ID：12184602
> 
> 赞同：4
> 
> 时间：2012-08-29T18:49:28.713
> 
> 标签：java, jdbc, coldfusion

我正在使用以下 java 代码（在 ColdFusion 中）来获取数据库连接：

```
//Creating an object of servicefactory class
local.theServiceFactory = createObject('java','coldfusion.server.ServiceFactory');

//Creating the connection object simply by passing the DSN name
local.connect = theServiceFactory.getDataSourceService().getDataSource('dsnnane').getConnection(); 
```

效果很好。唯一的问题是我被告知`ServiceFactory`由于安全原因我不能使用。还有另一种获取连接对象的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T15:40:47.863

我不会在调用堆栈中降低执行此类操作，而是考虑直接通过 SQL 本身设置选项的方法。正如我在评论中发布的那样，您可以`autocommit` [通过 T-SQL](https://stackoverflow.com/questions/1090240/how-do-you-set-autocommit-in-an-sql-server-session)本身在 SQL Server 中设置值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-29T13:21:35.837

我这样用

```
var datasourceService = createObject("Java", "coldfusion.server.ServiceFactory").getDataSourceService();
    var ds = datasourceService.getDatasource(variables.dsn).getConnection().getPhysicalConnection();
    ds.setAutoCommit(false);
    ...
    ds.setAutoCommit(true); 
```

# sql - 两个表的并集，但显示数据来自哪个表

> ID：12184606
> 
> 赞同：4
> 
> 时间：2012-08-29T18:49:45.970
> 
> 标签：sql, union, highest

我有两张桌子：

```
 TABLE_A                 TABLE_B
Fields:    Trans   Amend           Trans   Amend 
data:      100       0             100      0
           100       1
           110       0         
                                   120      0
                                   120      1
           130       0             130      0 
                                   130      1
           140       0             140      0
           150       0             150      0
           150       1             150      1
           150       2 
```

我想要的是一个表（视图），它将把这些组合（联合）到表中，但只会显示每个 Trans 的最高修正

寻找这个作为答案：

```
Fields:    Trans   Amend   
data:      100       1
           110       0
           120       1
           130       1
           140       0 
           150       2 
```

然后让它变得更难，我想知道是否有一种方法可以告诉我数据来自哪个表。当记录 A 和记录 B 相等时，表 A 总是获胜 寻找这个作为答案：

```
Fields:    Trans   Amend    WhichTBL
data:      100       1      Table_A
           110       0      Table_A
           120       1      Table_B
           130       1      Table_B
           140       0      Table_A
           150       2      Table_A 
```

我知道无法使用 UNION 来获得此结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-01-23T17:35:52.763

如果您在选择中添加了一个字符串并将其别名为列怎么办？

```
SELECT Trans, Amend, 'Table_A' as WhichTBL
FROM (your 1st select query)
UNION
SELECT Trans, Amend, 'Table_B' as WhichTBL
FROM (your 2nd select query)
ORDER BY Trans 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:55:52.697

在 Teradata SQL 中，您将执行以下操作，但不确定 SQL Server：

```
select trans,amend,WhichTBL from
(
select trans,amend,'Table_A' WhichTBL from Table_A
union
select trans,amend,'Table_B' WhichTBL from Table_B
) X
qualify row_number() over(partition by trans order by amend desc, WhichTBL) = 1
order by trans; 
```

如果您的 SQL 没有 QUALIFY 子句，则使用 Lucero 建议的版本：

```
select trans,amend,WhichTBL from
(
   select x.*,row_number() over(partition by trans order by amend desc, WhichTBL) as rn
   (
      select trans,amend,'Table_A' as WhichTBL from Table_A
      union
      select trans,amend,'Table_B' as WhichTBL from Table_B
   ) Derived1 as X
) Derived2
where rn = 1
order by trans; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:56:00.043

这行得通吗？

```
SELECT 
    trans, MAX(max_amend) as max_max_amend
FROM
    (SELECT
        'a' AS src, trans, MAX(amend) AS max_amend
    FROM
        table_a
    GROUP BY
        trans

    UNION ALL

    SELECT
        'b' AS src, trans, MAX(amend) AS max_amend
    FROM
        table_b
    GROUP BY
        trans) m
GROUP BY
    trans 
```

* * *

## Lucero 下面的观点是正确的， min(src) 将在全局集上，而不是相关的 max()

我认为您必须将源值和表值组合成一列，您可以最大化。在您的示例中，只需将值加 1 即可区分来源，例如：

```
SELECT trans, Max(amend) AS MaxOfamend, 1+[amend] AS isa, 0 AS isb
FROM TableA
GROUP BY trans 
```

但是您可以添加 100，或乘以一个大值，或者任何适用于您的数据的方法。这个想法是将两条信息（修改值和来源）合并到一列中。

然后，在组合信息之后，您得到该值的最大值，然后通过取消组合来去除源标志（减去 1，除以 100，等等）

* * *

好的，这就是我得到的：

```
CREATE VIEW [dbo].[viewA]    AS
SELECT trans, MAX(amend + .20) AS srcIsA, 0 AS srcIsb
FROM  dbo.tableA
GROUP BY trans

CREATE VIEW [dbo].[viewB]    AS
SELECT trans, 0 AS srcIsA, MAX(amend + .10) AS srcIsB
FROM  dbo.tableB
GROUP BY trans

CREATE VIEW [dbo].[viewU]    AS
SELECT * from viewA
union all
select *
FROM  viewb

CREATE VIEW [dbo].[viewv]    AS
SELECT trans, srcIsA, srcIsb, srcIsA + srcIsb AS total
FROM  dbo.viewU

CREATE VIEW [dbo].[vieww]    AS
SELECT trans, MAX(total) AS max_total
FROM  dbo.viewv
GROUP BY trans

CREATE VIEW [dbo].[viewx] AS
SELECT trans, 
max_total, 
CAST(max_total AS int) AS maxval, 
CASE WHEN (max_total - CAST(max_total AS int)) = .1 THEN 'a' ELSE 'b' END AS src
FROM  dbo.vieww 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:00:34.897

我想提供的是，您可以使用标准 SQL 通过连接和聚合来做到这一点：

```
select coalesce(a.trans, b.trans) as trans,
       (case when coalesce(max(b.amend), -1) > coalesce(max(a.amend), -1)
             then max(b.amend)
             else max(a.amend)
        end) as amend,
       (case when coalesce(max(b.amend), -1) > coalesce(max(a.amend) , -1)
             then 'B' else 'A'
        end) as whichTable
from Table_A a full outer join
     Table_B b
     on a.trans = b.trans
group by coalesce(a.trans, b.trans) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T19:06:22.783

如果 Amend 只有值 1 和 0 则可以完成第一个问题

```
select Trans,sum(Amend) AmendMax from (select Trans,Amend from TABLE_A
union select Trans,Amend from TABLE_B) C group by Trans 
```

第二个问题是

```
select Trans,max(Amend) Amend,case when sum(s)=1 or  sum(s)=2 or  sum(s)=21 
then 'Table-A' when sum(s)=10 or  sum(s)=12 or sum(s)=20  then 'Table-B' 
when sum(s)=11 or  sum(s)=22 then 'Table-A and B' end s from 
(select case when max(Amend)=1 then 1 else 2 end s,Trans,max(Amend) Amend from TABLE_A 
group by Trans union select case when max(Amend)=1 
then 10 else 20 end s,Trans,max(Amend) Amend from TABLE_B group by Trans) C group by Trans 
```

# linq - 我有 2 个字符串列表。如何获得一个布尔值来告诉我一个列表是否包含另一个列表中的至少一个字符串？（使用 Lambda）

> ID：12184609
> 
> 赞同：1
> 
> 时间：2012-08-29T18:49:49.590
> 
> 标签：linq, list, lambda

这应该很简单，但我无法理解它。这就是我现在的做法，但它似乎很浪费。

有一个

```
List<string> committees 
```

和

```
List<string> P.committees 
```

我只想看看一个列表是否包含另一个列表中的任何字符串。

```
 List<Person> listFilteredCommitteesPerson = new List<Person>();

            foreach (Person p in listFilteredPerson)
            {
                foreach (string strCommittee in p.Committees)
                {
                       if (committees.Contains(strCommittee))
                       {
                           listFilteredCommitteesPerson.Add(p);
                       }
                }
            }

            listFilteredPerson = listFilteredCommitteesPerson; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:00:25.940

对于布尔值：

```
var match = 
   committees.Intersect(listFilteredPerson.SelectMany(p => p.Committees)).Any(); 
```

如果您想要一个匹配的集合，`Person`您可以使用：

```
var peopleThatMatch = 
    listFilteredPerson.Where(p => committees.Intersect(p.Committees).Any()); 
```

或者：

```
var peopleThatMatch = 
    listFilteredPerson.Where(p => p.Committees.Any(s => committees.Contains(s))); 
```

`HashSet<T>`如果您有大型集合，出于性能原因，您可能需要考虑另一种集合类型（例如）。

# c# - 以编程方式触发控件的事件

> ID：12184614
> 
> 赞同：36
> 
> 时间：2012-08-29T18:50:12.417
> 
> 标签：c#, winforms, events, controls

假设我有一个 WinFoms 项目。只有一个按钮（例如`button1`）。

问题是：是否可以`ButtonClicked`通过代码触发事件而无需真正单击它？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-29T18:52:36.420

按钮控件有一个可以调用的 PerformClick() 方法。

```
button1.PerformClick(); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-08-29T19:59:05.003

.NET 框架使用一种模式，其中每个事件`X`都有一个`protected void OnX(EventArgs e) {}`引发事件的方法`X`。请参阅此[Msdn 文章](http://msdn.microsoft.com/en-us/library/hy3sefw3%28v=vs.100%29.aspx)。要从声明类外部引发事件，您必须派生该类并添加公共包装方法。在这种情况下，`Button`它看起来像这样：

```
class MyButton : System.Windows.Forms.Button
{

    public void ProgrammaticClick(EventArgs e)
    {
        base.OnClick(e);
    }

} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-08-29T18:52:46.377

您可以直接调用事件处理函数并指定`null`发送者和`EventArgs.Empty`参数。

```
void ButtonClicked(object sender, EventArgs e)
{
    // do stuff
}

// Somewhere else in your code:
button1.Click += new EventHandler(ButtonClicked);

// call the event handler directly:
ButtonClicked(button1, EventArgs.Empty); 
```

或者，更确切地说，您可以将`ButtonClicked`事件中的逻辑移到它自己的函数中，然后您的事件处理程序和您拥有的其他代码将依次调用新函数。

```
void StuffThatHappensOnButtonClick()
{
    // do stuff
}

void ButtonClicked(object sender, EventArgs e)
{
    StuffThatHappensOnButtonClick();
}

// Somewhere else in your code:
button1.Click += new EventHandler(ButtonClicked);

// Simulate the button click:
StuffThatHappensOnButtonClick(); 
```

后一种方法的优点是可以让您将业务和 UI 逻辑分开。你真的不应该在你的控制事件处理程序中有任何业务逻辑。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-29T18:57:41.640

是的，只需像调用其他方法一样调用该方法。例如：

```
 private void btnSayHello_Click(object sender, EventArgs e)
    {
        MessageBox.Show("Hello World!");
    }

    private void btnTriggerHello_Click(object sender, EventArgs e)
    {
        btnSayHello_Click(null, null);
    } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-29T18:53:36.500

```
button1.PerformClick(); 
```

但是，如果您必须做这样的事情，也许最好将您在事件下的代码移动到新方法上？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-01-27T16:29:09.453

你为什么不把你的事件代码放到一个方法中。然后让事件执行该方法。这样，如果您需要执行与事件发生相同的代码，则可以，但只需调用“方法”。

```
void Event_Method()
{
    //Put Event code here.
    MessageBox.Show("Hello!");
}

void _btnSend_Click(object sender, EventArgs e)
{
    Event_Method();
}

void AnotherMethod()
{
    Event_Method();
} 
```

有道理？现在“点击”事件和代码中的任何地方都可以触发与“点击”事件相同的代码。

不触发事件，调用事件调用的方法。;)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-03T12:26:58.377

在大多数情况下，您不需要这样做。只需将您的功能包装在与特定目的（任务）相关的功能中。您可以在您的事件中和其他任何需要的地方调用此函数。

过度考虑你的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-09-01T18:48:48.537

我最近遇到了这个问题，我想以编程方式单击一个分配了多个事件处理程序的按钮（想想 UserControl 或派生类）。

例如：

```
myButton.Click += ButtonClicked1
myButton.Click += ButtonClicked2;

void ButtonClicked1(object sender, EventArgs e)
{
    Console.WriteLine("ButtonClicked1");
}

void ButtonClicked2(object sender, EventArgs e)
{
    Console.WriteLine("ButtonClicked1");
} 
```

当您单击该按钮时，这两个函数都将被调用。在您希望以编程方式为表单中的函数触发事件处理程序的情况下（例如，当用户在文本字段中按下回车键时，然后调用`InvokeOnClick`通过控件传递的方法。例如

```
this.InvokeOnClick(myButton, EventArgs.Empty); 
```

`this`您所在的 Form 实例在哪里。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2014-07-22T14:55:26.863

使用 for 循环调用 button_click 事件

```
private void btnadd_Click(object sender, RoutedEventArgs e)
{ 
    for (int i = 0; i <= 2; i++)
        StuffThatHappensOnButtonClick(); 
}

void StuffThatHappensOnButtonClick()
{
    ........do stuff
} 
```

我们假设您至少需要点击一次按钮

# java - 从列表中解析 爪哇

> ID：12184616
> 
> 赞同：2
> 
> 时间：2012-08-29T18:50:28.703
> 
> 标签：java, list, parsing, arraylist

我正在尝试解析 List 中声明的元素的值，如下所示：

```
 List<String> uniqueList = new ArrayList<String>(dupMap.values()); 
```

这些值是这样的：

```
a:1-2
b:3-5 
```

但我想要一个带有第一个数字（即 1、3）的 ArrayList 和另一个带有第二个数字（即 2、5）的 ArrayList。我已经解决了... Sorta：

```
String delims= "\t"; String delim2= ":"; String delim3= "-";
String splits2[]; String splits3[]; String splits4[];
Map<String,String> dupMap = new TreeMap<String, String>();
List<String> uniqueList = new ArrayList<String>(dupMap.values());
ArrayList<String> parsed2 = new ArrayList<String>();
ArrayList<String> parsed3 = new ArrayList<String>();
ArrayList<String> parsed3two= new ArrayList<String>();
double uniques = uniqueList.size();
for(int a=0;a<uniques;a++){
    //this doesn't work like it would for an ArrayList
    splits2 = uniqueList.split(delim2) ;
    parsed2.add(splits2[1]);
    for(int q=0; q<splits2.length; q++){
        String change2 = splits2[q];
        if(change2.length()>2){
           splits3 = change2.split(delim3);
           parsed3.add(splits3[0]);
           String change3=splits3[q];
           if (change3.length()>2){
               splits4 = change3.split(delims);
               parsed3two.add(splits4[0]);
           }
        }
     }
  } 
```

但是 uniqueList.split 不起作用，我不知道 List 是否有类似的功能。有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:57:26.113

如果您知道所有数据都在 form`[something]:[num]-[num]`中，则可以使用如下正则表达式：

```
Pattern p = Pattern.compile("^([^:]*):([^-]*)-([^-]*)$");

// I assume this holds all the values:
List<String> uniqueList = new ArrayList<String>(dupMap.values()); 

for (String src : uniqueList) {
    Matcher m = p.matcher(src); 
    if( m.find() && m.groupCount() >= 3) {
        String firstValue = m.group(1); // value to left of :
        String secondValue = m.group(2); // value between : and -
        String thirdValue = m.group(3); // value after -

        // assign to arraylists here
    }
} 
```

我实际上并没有将代码添加到特定`ArrayList`的 s 中，因为我无法从您的代码中完全分辨出哪个`ArrayList`应该保存哪个值。

**编辑**

根据 Code-Guru 的评论，使用的实现`String.split()`将如下所示：

```
String pattern = "[:\\-]";

// I assume this holds all the values:
List<String> uniqueList = new ArrayList<String>(dupMap.values()); 

for (String src : uniqueList) {
    String[] parts = src.split(pattern);
    if (parts.length == 3) {
        String firstValue = parts[1]; // value to left of :
        String secondValue = parts[2]; // value between : and -
        String thirdValue = parts[3]; // value after -

        // assign to arraylists here
    }
} 
```

这两种方法在效率方面几乎相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:00:54.223

根据我对您的问题的理解，我将进行如下处理：

```
for each String in uniqueList
    parse the string into a character and two integers (probably using a single call to [String.split()](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split(java.lang.String, int))
    insert the first integer into an List
    insert the second integer into another List 
```

这是伪代码。翻译成 Java 留给读者作为练习。

# php - 在以结尾的目录中显示最新图像

> ID：12184619
> 
> 赞同：0
> 
> 时间：2012-08-29T18:50:37.563
> 
> 标签：php

我想在以特定方式结束的目录中显示最后修改的图像。

我可以显示目录中的最后一个文件我只是不知道如何过滤结果以仅显示以“wide-block.jpg”结尾的目录中的最新文件

```
<?php
$base_url = 'images/folio/web-portfolio';
$newest_mtime = 0;
$show_file = 'images/folio/no-image.jpg';
if ($handle = opendir($base_url)) {
while (false !== ($latestFile = readdir($handle))) {
    if (($latestFile != '.') && ($latestFile != '..') && ($latestFile != '.htaccess')) {
       $mtime = filemtime("$base_url/$latestFile");
       if ($mtime > $newest_mtime) {
          $newest_mtime = $mtime;
          $show_file = "$base_url/$latestFile";
       }
    }
  }
}
echo '<img src="' .$show_file. '" alt="Latest from the web">';
?> 
```

我从其他地方获得了该代码，并意识到一旦我检查显示以“wide-block.jpg”结尾的最新文件，它就不需要列出！= 文件类型的第二个 if 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:56:05.103

这应该会为您解决，基本上只需添加另一个规则来过滤以您的必填字段结尾的图像。

基本上只需使用 strpos() 函数来确定您要查找的值是否在文件名中。

还将代码包装在一个函数中，允许机器人获得所需的文件夹位置，以及文件必须以所需的字符串结尾。

```
<?php
function getLatestImage($folderName, $imageEnding) {
    $newest_mtime = 0;
    $base_url = 'images/folio/'.$folderName;        
    $file_ending = $imageEnding;
    $show_file = 'images/folio/no-image.jpg';
    if ($handle = opendir($base_url)) {
        while (false !== ($latestFile = readdir($handle))) {
            if (($latestFile != '.') && ($latestFile != '..') && ($latestFile != '.htaccess') && (strpos($latestFile, $file_ending))) {
             $mtime = filemtime("$base_url/$latestFile");
                if ($mtime > $newest_mtime) {
                    $newest_mtime = $mtime;
                    $show_file = "$base_url/$latestFile";
                }
            }
        }
    }
    return $show_file;
}

echo '<img src="' .getLatestImage('foldername', 'file_ending.jpg'). '" alt="Latest from the web">';
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-09T07:39:54.270

这是我的方式，解决这个问题，我不是程序员，它是尝试错误产品:)

我在 wordpress 安装中使用它并且必须安装插件 **Allow PHP in Posts and Pages** （这就是为什么 php 标签不同，通常而不是 [PHP] [/PHP]）

* * *

```
[PHP]
global $path;    // path to directory has to be global, using it later in html

$dir = "Planetwebcam/";

$files = scandir($dir, 1);                // read directory backkwards

$picture = ($files[0]);                   // get las picture file name

$path = "http://www.yourdomain.ch/Planetwebcam/$picture";

[/PHP]

<a href="[PHP]global $path;echo $path; [/PHP]">
<img class="alignnone size-large" alt="Last picture" src="[PHP]global 
$path;echo $path; [/PHP]" width="1600" height="1200" /></a> 
```

# php - 使用 cURL 将表单发布到两个地方

> ID：12184620
> 
> 赞同：2
> 
> 时间：2012-08-29T18:50:40.367
> 
> 标签：php, forms, post, curl, mailchimp

昨天我问[了一个问题](https://stackoverflow.com/questions/12165649/how-can-i-execute-php-before-posting-to-someone-elses-script-from-a-form)，关于如何劫持我的 MailChimp 联系表以发送额外的电子邮件（当满足某些条件时）。

我使用类似于以下的代码`action="...`将 MailChimp URL 更改为我自己的：`process_email.php`

```
extract($_POST);
$url = 'http://myMailchimpUser.us2.list-manage.com/subscribe/post';
$fields = array(
    'u' => urlencode($u),
    'id' => urlencode($id),
    'group' => http_build_query ($group),
    'MERGE1' => urlencode($MERGE1),
    'MERGE2' => urlencode($MERGE2),
    'MERGE3' => http_build_query($MERGE3),
    'other_more_info_text' => urlencode($other_more_info_text),
    'submit' => urlencode($submit)
);

foreach($fields as $key=>$value) { $fields_string .= $key.'='.$value.'&'; }
rtrim($fields_string, '&');

$ch = curl_init();

curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_POST, count($fields));
curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);

$result = curl_exec($ch);
curl_close($ch); 
```

我还没有添加将电子邮件发送给自己的代码，但这应该是微不足道的。我在使用*此*代码时遇到的问题是，它没有将我重定向到 MailChimp 页面，而是实际在`process_email.php`其中加载（并且加载不正确以启动。）

我知道如果我使用 JavaScript，我可以完成我想做的事情，但在我看来，这不是正确的方法。谁能给我任何帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T03:14:30.190

如果我理解正确：您想先在本地发布数据，然后让表单发布到 Mailchimp。如果这就是你想要做的，那么使用一些连接到表单（或表单按钮）的 JS 可能是最好的方法。我认为这*是*适合您的情况的正确方法。

像下面这样的 jQuery 将首先在本地发布表单，一旦该请求完成，它将使用给定的操作 url (mailchimp) 提交表单。

```
$(document).ready(function(){
    $('#submit-button').click(function(event){
        event.preventDefault();
        $.post("your_email_parser.php", $('#form-id').serialize(), function(){
            $('#form-id').submit();
        });
    });
});

...

<form id='form-id' action='http://myMailchimpUser.us2.list-manage.com/subscribe/post' method='post'>
    ...
    <input type='submit' id='submit-button' />
</form> 
```

# javascript - 删除div标签+ jquery下的类属性

> ID：12184621
> 
> 赞同：1
> 
> 时间：2012-08-29T18:50:40.720
> 
> 标签：javascript, jquery

```
 <script type="text/javascript">
    var product_features = ['draggable','trackable','colorable'];

 $(document).ready(function () {

 $('div#input .feature draggable').remove();
}); 
```

```
<h3>Input</h3>
<div id="input">
    <div class="feature draggable">Drag 1</div>
    <div class="feature resizable">Resize</div>
    <div class="feature downloadable">Download</div>
    <div class="feature draggable">Drag 2</div>
    <div class="feature trackable">Track</div>
    <div class="feature colorable">Color</div>
</div>

<h3>Output</h3>
<div id="output"></div> 
```

​</p>

无法删除具有可拖动功能的 div 类元素

```
 $('div#input .feature draggable').remove(); 
```

这部分代码似乎有问题，有人可以指出这里有什么问题吗？

JS 小提琴：http: [//jsfiddle.net/9CzMG/47/](http://jsfiddle.net/9CzMG/47/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T18:52:03.033

我想你需要，

```
$('div#input .feature.draggable').remove(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T18:52:05.737

```
$('div#input .feature.draggable').remove(); 
```

[**小提琴**](http://jsfiddle.net/9CzMG/55/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T18:58:18.873

你可以这样使用

```
 $('div#input .draggable').remove(); 
```

# linux - 自动化两个连续 ssh 连接的脚本

> ID：12184623
> 
> 赞同：2
> 
> 时间：2012-08-29T18:50:44.180
> 
> 标签：linux, ssh

我知道可以编写一个 shell 脚本，将您的硬编码密码传递给 ssh 连接身份验证（使用期望）。但是，我需要的稍微复杂一些。

在我的大学里，我指定了一台台式电脑。我可以通过首先与某个服务器建立 ssh 连接，然后从该服务器与我指定的台式计算机建立另一个 ssh 连接来远程连接到这台计算机。这就像：

* * *

localuser@localcomputer:~$ ssh -X username@serveraddress

用户名@服务器地址密码：

服务器$ ssh -X 用户名@远程计算机地址

用户名@远程计算机地址密码：

用户名@远程计算机：~>

* * *

有没有办法编写一个可以自动执行上述操作的脚本（即执行两个连续的 ssh 连接）？

提前致谢！

ps：本地和远程计算机都在Linux上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:38:35.317

您可以通过以下方式交互地执行此操作：

```
ssh -t -X username@serveraddress ssh -t -X username@remotecomputeraddress 
```

请注意，这不是管道-第二个`ssh`是在第一个创建的连接上运行的命令`ssh`。这些`-t`选项是分配交互所需的伪 tty 所必需的（密码收集以及最终目标 - 远程系统上的交互式会话）。把它用`expect`左边作为一个练习给读者.... ;-)

设置正确的私钥/公钥对的奖励积分，`ssh-agent`因此不需要密码（当然，除非出于安全原因不允许这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:07:56.260

是的，你可以这样做。

假设你有你的 except 脚本`expect_script`：

```
cat expect_script | ssh -X username@serveraddress sh -s 
```

在这个 expect_script 中，您必须运行`ssh -X username@remotecomputeraddress`.

当然，您可以在两台主机上安装公钥并使用无密码身份验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T23:18:07.570

不久前，我用爆炸路径写了一些东西： [http ://stromberg.dnsalias.org/~strombrg/deep-ssh.html](http://stromberg.dnsalias.org/~strombrg/deep-ssh.html)

因此，您需要设置无密码、无密码认证（或使用代理作为密码），例如： [http ://stromberg.dnsalias.org/~strombrg/ssh-keys.html](http://stromberg.dnsalias.org/~strombrg/ssh-keys.html)

接着：

```
deep-ssh username@serveraddress!username@remotecomputeraddress command 
```

如果 bash 抱怨 !，你可以用反斜杠转义它。

老前辈们会认识到这是指定 UUCP 路径的方式。

# azure - 进行 Azure API 调用的实用程序？

> ID：12184624
> 
> 赞同：0
> 
> 时间：2012-08-29T18:50:49.713
> 
> 标签：azure

是否有一个通用的、简单的、简单的和肮脏的实用程序可以像下一个一样进行 Azure api 调用？ [http://msdn.microsoft.com/en-us/library/windowsazure/hh360996.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh360996.aspx)

我只想尽快完成它而不自己编程。只需在某个窗口中输入 url 和 xml 并发送即可。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:02:25.193

是的，您可以使用[Fiddler中的](http://www.fiddler2.com/fiddler2/version.asp)**Composer**选项卡。只需选择动词，输入网址、标题和正文即可：

![在此处输入图像描述](../Images/4db666289035286cf9b680306d3863ed.png)

# node.js - Nodejs Mongo插入子文档 - 动态字段名

> ID：12184626
> 
> 赞同：3
> 
> 时间：2012-08-29T18:51:05.767
> 
> 标签：node.js, mongodb, mongoskin

{用户名：'我'，公司：{“您的公司”：{...}}

我想将公司插入用户记录（用户集合），以进行：

{用户名：'我'，公司：{“您的公司”：{...}，“我的公司”：{...}}

但名字是动态的..

```
var companyid = "mycompany";

.collection('users').findAndModify(
{username: usern}, 
[['_id', 'asc']], 
{$set:{companies:{companyid: { desksmemberships:[] }}}},    
{new: true}, function(){...} 
```

给出这个.. {username:'me', Companies:{ "yourcompany":{...}, "companyid":{...} }

我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T19:32:33.773

您必须以`$set`编程方式构建修饰符：

```
var modifier = { $set: {} };
modifier.$set['companies.' + companyid] = { desksmemberships:[] }; 
```

然后`modifier`用作调用中的第三个参数`findAndModify`。

您可能还需要考虑更改`companies`为数组而不是嵌入对象。

**Node.js 4.x 更新**

您现在可以使用[计算属性](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer#Computed_property_names)语法直接在对象字面量中执行此操作：

```
collection('users').findAndModify(
    {username: usern}, 
    [['_id', 'asc']], 
    {$set:{['companies.' + companyid]: { desksmemberships:[] }}},    
    {new: true},
    function(){...}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-06T08:38:35.563

我在很多帖子上都看到过这个问题，其中一些非常复杂——叫我疯了，但你可以这样做（node + mongo）：

我的数据库架构“匹配”设置为一个数组。在 mongo 数据中 [match.matchId] 变为 '2028856183'。

```
db.update({key: value}, {matches: [{[match.matchId] : match}] }, callback);
db.update(what to find, what to change it to, what to do next) 
```

您可以使用括号中的任何变量。

# cordova - Cordova 无法启动地理定位服务

> ID：12184627
> 
> 赞同：1
> 
> 时间：2012-08-29T18:51:06.290
> 
> 标签：cordova, geolocation, cordova-2.0.0

在我的 phonegap 应用程序中，我收到错误代码 2，并显示消息“无法启动地理定位服务”。
我遵循了地理位置文档，并且在 AndroidManifest.xml 和 res/xml/config.xml 中拥有权限。

Android 4, Cordova 2 使用 cordova/emulate 和 cordova/debug 运行。

# eclipse - 使用 Eclipse 时如何更改 tomcat-users.xml？

> ID：12184633
> 
> 赞同：0
> 
> 时间：2012-08-29T18:51:21.977
> 
> 标签：eclipse, tomcat7, http-status-code-403

> Tomcat 7.0 + JSF 2

使用正确的凭据登录后，我立即收到 403 错误（错误的凭据按预期定向到 login.xhtml）。我在 apache 中创建了新用户，重新启动了 web 服务，但仍然无法连接。

tomcat-users.xml

```
<tomcat-users>
    <user name="lala" password="lala!!!" roles="admin-gui,manager-gui" />
    <role rolename="administrator"/>
    <user username="admin" password="admin" roles="administrator"/>
</tomcat-users> 
```

为什么我只能用 lala 而不是 admin 登录（我已经手动添加了）。任何 idia 为什么？

和 server.xml 中的一个领域（tomcat conf）

```
under <host>:
<Realm className="com.bannerplay.beans.Admin"> 
```

在项目的欢迎文件（login.xhtml）中，我使用了 j_security_check（基于表单的身份验证）

```
 <form method="post" action="j_security_check">
            <p>
                Enter user ID and password:<br/> <br/>
                User ID <input type="text" name="j_username"/> 
                Password  <input type="password" name="j_password"/> <br/><br/> 
                <input type="submit" value="Login"/>
            </p>

        </form> 
```

并像这样定义 web.xml：

```
 ...
<security-constraint>
    <display-name>Admin</display-name>
    <web-resource-collection>
        <web-resource-name>BannerPlay administration Tool</web-resource-name>
        <description/>
        <url-pattern>/admin/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <description/>
        <role-name>administrator</role-name>
    </auth-constraint>
</security-constraint>
<login-config>
    <auth-method>FORM</auth-method>
    <realm-name>com.bannerplay.beans.Admin</realm-name>
    <form-login-config>
        <form-login-page>/faces/login.xhtml</form-login-page>
        <form-error-page>/faces/login.xhtml</form-error-page>
    </form-login-config>
</login-config>
<security-role>
    <description/>
    <role-name>administrator</role-name>
</security-role> 
```

项目树： ![this is the project tree](../Images/02819c159662782a26b4b17818657683.png)

when trying to access localhost:8080/myProject/ i get to login.xhtml , when typing correct credentials( the 'lala' user works, not the admin ) i get 403\. when trying to access localhost:8080/myProject/main.xhtml i'm re-directed to login page again.(after correct credentials)

I've tried to add "administrator" role to user lala, but has the same results.

what should i do? thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T07:22:38.223

The solution is NOT to change the tomcat-users.xml file from the hard drive. It must be changed from eclipse. after changing it from HD I noticed it keeps coming back to old version of the file,instead of keeping my changes. this happens after running the project. Change it from eclipse and problem solved.

# tomcat - 从自定义 Tomcat 领域记录

> ID：12184638
> 
> 赞同：3
> 
> 时间：2012-08-29T18:51:32.667
> 
> 标签：tomcat, logging

这可能是一个非常愚蠢的问题，但我似乎无法找到答案。我有一个用于 Tomcat 的自定义领域，在上下文级别使用。我想记录失败和成功的登录。

有什么方法可以让我指定一个文件，或者获取对现有文件的引用，这将让我从领域的身份验证函数内部向它写入显式的日志行？

我尝试设置一个 log4j 文件和一个 JUL 文件并调用 getLogger 并尝试写入它，但没有运气。我还尝试了 getLogger("catalina") ，希望我也可以在没有运气的情况下访问内部日志记录过程。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T13:52:39.297

事实证明，使用 containerLog 非常简单。

好处是您可以利用服务器日志配置，这在使用 JULI 的 Tomcat 7 中特别好（作为对公共日志的改进）。

我唯一不喜欢的是 API 是公共日志记录的 API，不像 slf4j 那样友好。但是您也可以通过 log4j 配置 slf4j，在这种情况下，您必须在 tomcat/lib 中添加 JAR 文件，以便父类加载器在实例化您的领域时看到它们。

您还需要注意一件事：不要在领域构造函数中记录任何内容！我必须进行一些自定义初始化（加载自定义文件）并添加一些基本日志记录并以讨厌的 NullPointer 结束 - containerLog 不是在构造函数中初始化，而是在方法 initInternal() 中初始化。覆盖它，确保调用初始化记录器的 super.initiInternal () ，然后就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T22:26:47.490

您是否自定义 Realm 扩展`org.apache.catalina.realm.RealmBase`？

您可以访问一个受保护的属性`org.apache.catalina.realm.RealmBase.containerLog`（它是 的一个实例）。`org.apache.juli.logging.Log`这似乎是登录许多`org.apache.catalina.realm.*`实现的方法。

# c++ - 在 C++ 中，是否有更有效的方法来编写多个声明

> ID：12184649
> 
> 赞同：0
> 
> 时间：2012-08-29T18:52:03.060
> 
> 标签：c++

在 C++ 中，是否有更有效的编写方式：

```
ImageButton* imageButton;
ImageButton* imageButton1;
ImageButton* imageButton2;
ImageButton* imageButton3; 
```

等等而不写出所有的行？我有超过 1000 个按钮。我希望有更好的方法来写这个。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:58:19.047

如果您坚持使用多个变量，请在一行中执行此操作。

```
ImageButton *imageButton, *imageButton1, *imageButton2 ; 
```

您也可以通过某种方法消除星星，但这种方法仍然几乎与您的方法一样差或好。如果您使用对象数组会更好。

```
ImageButton [] ; 
```

或者一个动态的，如果你想在之后发展它。

```
ImageButton * imagebutton = new ImageButton [size] ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T18:57:19.387

你必须这样做：

```
ImageButton *imageButton, *imageButton1, *imageButton2, *imageButton3; 
```

换句话说，`*`必须分别为每个变量存在。或者你可以这样做：

```
typedef ImageButton* ImageButtonPtr ;
ImageButtonPtr imageButton, imageButton1, imageButton2, imageButton3; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:12:48.833

```
nButtons = 1000
std::vector<ImageButton> images;
images.assign(nButtons, ImageButton()) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-30T11:35:16.680

这个呢？：

```
#include<iostream>
using namespace std;

class ImageButton
{

};

int main()
{

    int i;
    int BUTTONSIZE=32*32;    // 32x32 pixels
    int BUTTONAMOUNT=1000;     // 1000 buttons

    ImageButton **imagebutton = 0;

    //memory allocated for 1000 elements , BUTTONAMOUNT=1000
    imagebutton = new ImageButton *[BUTTONAMOUNT] ;

    //memory allocated for  elements of each button.
    for(   i = 0 ; i < BUTTONAMOUNT ; i++ ) 
    {
        imagebutton[i] = new ImageButton[BUTTONSIZE];
        cout<<i<<".  \n";
    }

    //free the allocated memory
    for(   i = 0 ; i < BUTTONAMOUNT ; i++ )     delete [] imagebutton[i] ;
    delete [] imagebutton ;

    return 0;
} 
```

# c# - webform that automatically checks button if another button is checked

> ID：12184652
> 
> 赞同：1
> 
> 时间：2012-08-29T18:52:05.867
> 
> 标签：c#, asp.net, checkbox, webforms

I'm trying to create a webform in asp.net/c# that uses checkboxes. What I would like to do is automatically check one box if another is checked

for example if button2 is checked, automatically check button1, but don't automatically check if button1 is checked

tried doing an if statement that handles this like:

```
if(checkbox1.changed == true)
{
    checkbox2.changed == true;
} 
```

but this didnt work. anyone point me in right direction of where to look on how to do this.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:13:43.640

You mean something like this?

**default.aspx**

```
<form id="form1" runat="server">
    <asp:CheckBox ID="CheckBox1" runat="server" AutoPostBack="True" 
        oncheckedchanged="CheckBox1_CheckedChanged" Text="Box1" />
    <asp:CheckBox ID="CheckBox2" runat="server" Text="Box2" />
</form> 
```

**default.aspx.cs**

```
protected void CheckBox1_CheckedChanged(object sender, EventArgs e)
{
    if (CheckBox1.Checked)
        CheckBox2.Checked = true;
} 
```

This will check your checkbox2 if you check checkbox1\. Draw your attention on `AutoPostBack="True"` which causes your page to postBack to the server if you change checkbox1.

Anyway you should think over this kind of solution. I don't know exactly what you want to achieve, but it *may be a better solution to manage this on client via javaScript.*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:11:16.770

You can do this entirely on Javascript

```
<asp:CheckBox ID="CheckBox1" runat="server" onclick="changed(this);" />
<asp:CheckBox ID="CheckBox2" runat="server" /> 
```

And then the JS function that will check Checkbox2 if Checkbox1 is checked....

```
 function changed(element) {
        if (element.checked) {
            document.getElementById('<%=CheckBox2.ClientID%>').checked = element.checked;
        }

    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T19:12:27.957

you are doing a simple mistake. Checkboxes have a Checked property not changed.

```
if( checkbox1.Checked == true)
{
   checkbox2.Checked == true;
} 
```

Read more about CheckBox properties on [MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkbox_properties)

# javascript - 在 JQuery UI 对话框中输入键行为

> ID：12184653
> 
> 赞同：1
> 
> 时间：2012-08-29T18:52:06.383
> 
> 标签：javascript, jquery, html, jquery-ui, javascript-framework

如何修改下面的代码，以便在按下回车键时，jQuery 日期选择器将做出反应并将变量 (datePickerValue) 设置为自动突出显示的日期，即打开 jQuery 时的当前日期。我希望能够打开日期选择器，快速按回车键，它只需要今天并将其存储到 var 中。

```
<html>

<head>

<!-- LOAD JQUERY LIBRARY: -->  
    <link   href="jq/jquery-ui.css"         type="text/css" rel="stylesheet" />
    <script src="jq/jquery.min.js"          type="text/javascript"> </script>
    <script src="jq/jquery-ui.min.js"       type="text/javascript"> </script>

<script type="text/javascript">

window.onload = function() {

                $('#dd').dialog({ 
                                    autoOpen:   true,
                                    modal:      true,
                                    overlay:    { opacity: 0.5, background: 'black'},
                                    title:      'Select the date:',
                                    height:     215, 
                                    width:      234,
                                    draggable:  false, 
                                    resizable:  false

                });//end of dialog_atip

var datePickerValue = ""

$("#d1").show().unbind().datepicker().datepicker("show").change(function ()  {  
   //$('#d1').datepicker({onSelect:datePickerValue = $(this).val() }).hide();
   $('#d1').datepicker({onSelect:datePickerValue = $(this).val() })
   alert("You picked: " + datePickerValue);
   $("#dd").dialog("close")
});

}//end of window.onload

</script>

</head>

<body>
<div style="display:none" id="dd">
<div id="d1">
</div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:19:29.387

活动元素具有类`.ui-state-active`，因此您可以在按下回车键时模拟对该元素的单击，如下所示：

```
$(document).on('keypress', function (e){
    if(e.which == 13)
    {
        $('.ui-state-active').click();
    }
}); 
```

这是一个[小提琴](http://jsfiddle.net/9hUsU/)。焦点必须在文档上才能在那里工作（单击输出上的任意位置，然后按 Enter 键）。

# java - IntelliJ IDEA 中的自定义 Maven 目标

> ID：12184654
> 
> 赞同：18
> 
> 时间：2012-08-29T18:52:07.397
> 
> 标签：java, maven, intellij-idea, maven-3

我正在尝试找到在`IntelliJ`. 例如，我希望自定义目标是：`clean install -U`并且我想将其命名为：`update`，但我找不到如何在`IntelliJ`. 这甚至可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-29T19:03:32.680

你可以做两件事：

您可以在“Maven Projects”视图中右键单击项目根目录并选择“Create XXX [install]...”选项（其中 XXX 是您的项目/模块名称。然后，在随后的对话框中，指定`clean install -U`为命令line 选项。这将创建一个调用 maven 的运行配置（如果需要，您可以将其命名为“update”）。虽然它不会显示在 Maven 视图中，但可以从正常的运行/调试配置中访问它。

或者，您可以在 pom 中定义一个新的配置文件，将“install”重新绑定到“clean install -U”。您将无法在 intelliJ ui 中将其重命名为“update”，但您至少可以确保无论何时有人运行 install 目标时都会运行 clean 和 install。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-05-06T17:05:02.187

另一种方法是创建一个新的运行/调试 Maven 配置。在那里你可以指定完整的命令行参数和很多其他的东西。

```
Run\Edit configurations...
Select + (to create a new one)\Maven 
```

# java - 生成的点会变坏

> ID：12184659
> 
> 赞同：1
> 
> 时间：2012-08-29T18:52:18.027
> 
> 标签：java, drawing, trigonometry

这更像是一个有趣的实验而不是一个问题，我更好奇是什么原因造成的。

我正在生成 2D 点，存储为浮点数，以便在模式中绘制一组线条。生成新点时，我复制最后一个点，并根据航向 (x += cos(heading), y += sin(heading)) 将其移动到某个方向。航向也存储为浮点数。我以给定的速率（例如 90 度）更改航向，这意味着每个新点要么与最后一个点平行，要么与之成直角。

这是可行的，但经过多次（1000 次）迭代后，图案的外边缘开始变得稍厚，然后新绘制的点开始在稍微歪斜（但一致）的位置移动。然后整个图案开始旋转。

我很好奇的是不应该打破的东西如何打破。我最好的猜测是标题（一个不断减小的浮点数）在达到一定大小时会失去定义。

本质上，代码（用于生成下面的确切模式）看起来像这样

```
float distance = 25;
int theta = 90;
float heading = 0;

    public static void main(String[] args) {
    turnLeft();
    func();
    turnRight();
    func();
    turnRight();
    turnRight();
    func();
}

public void func() {
    drawForward();
    turnRight();
    drawForward();
    turnRight();
    turnRight();
    drawForward();
    turnRight();
    drawForward();
    drawForward();
}

    public void turnLeft() {
    heading += degToRad(theta);
}

public void turnRight() {
    heading -= degToRad(theta);
}

public float degToRad(float degrees) {
    return (float) (degrees * (Math.PI / 180.0));
}

public void drawForward() {
    FPoint newFp = new FPoint(array[array.length - 1]); //copy last point

    movePoint(newFp, (float) (distance * Math.cos(heading)),
            (float) (distance * Math.sin(heading)));

    appendPoint(newFp); //add point to end of array

}

public void movePoint(FPoint fp, float x, float y) {
    fp.x += x;
    fp.y += y;
} 
```

对此事的任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:02:55.473

当你向前和向后移动时，看看你是否在完全相同的地方。如果您不在同一位置，则从每次向前移动中减去一半的差异。

这可能与计算的**数值稳定性**和**精度**有关。[http://en.wikipedia.org/wiki/Numerical_stability](http://en.wikipedia.org/wiki/Numerical_stability) 。

由于您没有**后退**，您只需使用 forward + right + forward +right .... 直到到达起始位置，然后减去如果它与起始值不同。然后将其用作偏移误差值来减去（但首先将误差除以移动次数）（当然会像 "FRFRFRFECC" ）

这称为**BFECC**来回纠错补偿。如果是关于不可避免的错误，则大大减少错误。

我看到有人在 Zalesak 的 Turning Disk 上测试 BFECC，以查看磁盘在数千次旋转迭代后是否损坏。

# c# - 看起来像 excel 的 WPF 窗口

> ID：12184665
> 
> 赞同：0
> 
> 时间：2012-08-29T18:52:34.070
> 
> 标签：c#, wpf, visual-studio, datagrid

我是 WPF 和 c# 的新手，我正在尝试根据用户的需要创建一个具有固定列数和不同行数的 excel 表。人们建议使用数据网格，但我很困惑，有人说它主要用于显示数据源内容（如果我理解的话，它是数据库中包含的数据）。我还阅读了有关列表视图、将事物绑定到 itemsource 等的信息。这真的是很多信息的工作！我只需要一种方法来创建具有固定列的表，并在用户单击按钮时自动添加行，就是这样！没有绑定，或任何类似的东西。但是如何实现呢？另外，如果您有很好的网站教程来使用数据网格，我将非常感激（我发现的大多数教程都太复杂了，或者解释得不好）。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:17:12.503

您可以创建数据模板，将数据样式设置为您喜欢的样式 - 在本例中为 Excel 行。然后，您可以将此数据显示为项目控件中的 ItemsSource。由于您希望行数根据某些条件而变化，因此您的数据应该在 ObservableCollection 中。我不确定您如何设置标题，但我认为您可以设置一些容器的样式并将它们的宽度属性绑定到数据模板控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T05:42:43.727

如果您希望进行更多单元级别的自定义，那么您可以尝试 Grid [http://www.syncfusion.com/products/user-interface-edition/wpf/grid/grid-control](http://www.syncfusion.com/products/user-interface-edition/wpf/grid/grid-control)

# c# - 比较两个数字并返回 -1、0 或 1

> ID：12184667
> 
> 赞同：22
> 
> 时间：2012-08-29T18:52:39.217
> 
> 标签：c#

是否有一个简单的数学函数可以比较数字 x 和 y，当 x 小于 y 时返回 -1，当 x 大于 y 时返回 1，当它们相等时返回 0？

如果没有，是否有一个优雅的解决方案（没有任何`if`'s）将输出转换`Math.Max(x, y)`为这些返回？我正在考虑将数字除以它们，例如 123/123 = 1 但这会引入除以 0 的问题。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-29T18:56:50.497

对于您严格的 -1、0 或 1 要求，没有一种方法可以保证做到这一点。但是，您可以使用[`Int32.CompareTo`](http://msdn.microsoft.com/en-us/library/y2ky8xsk.aspx)和的组合[`Math.Sign`](http://msdn.microsoft.com/en-us/library/bd3y5wdf.aspx)：

```
int value = Math.Sign(x.CompareTo(y)); 
```

`CompareTo`或者，如果您对仅以负数、正数和 0 表示的正常合同感到满意，您可以单独使用`CompareTo`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-29T19:59:56.330

您可以在不使用任何 .NET 调用的情况下在 1 行上执行此操作。**注意**： Math.Sign 和 type.CompareTo 都使用逻辑 if 语句和您说要避免的比较运算符。

```
int result = (((x - y) >> 0x1F) | (int)((uint)(-(x - y)) >> 0x1F)); 
```

作为一个函数

```
//returns 0 if equal
//returns 1 if x > y
//returns -1 if x < y
public int Compare(int x, int y)
{
    return (((x - y) >> 0x1F) | (int)((uint)(-(x - y)) >> 0x1F));
} 
```

基本上，所有这些都是[将](http://en.wikipedia.org/wiki/Bitwise_operation#Bit_shifts)符号位一直移动到第一个位置。如果结果是无符号的，那么它将是 0；然后它执行相同的操作并翻转符号位，然后将它们[OR](http://en.wikipedia.org/wiki/Bitwise_operation#OR)在一起，结果是 1、0 或 -1。

结果为-1的情况

```
IS 12 > 15:

12 - 15 = -3            (11111111111111111111111111111101)
-3 >> 0x1F = -1         (11111111111111111111111111111111)

-(12 - 15) = 3          (00000000000000000000000000000011)
3 >> 0x1F = ((uint)0)=0 (00000000000000000000000000000000) cast to uint so 0

    11111111111111111111111111111111
OR
    00000000000000000000000000000000
=   11111111111111111111111111111111 (-1) 
```

结果为 1 的情况

```
IS 15 > 12:

15 - 12 = 3               (00000000000000000000000000000011)
3 >> 0x1F = 0             (00000000000000000000000000000000)

-(15 - 12) = -3           (11111111111111111111111111111101)
-3 >> 0x1F = ((uint)-1)=1 (00000000000000000000000000000001) cast to uint so 1

    00000000000000000000000000000000
OR
    00000000000000000000000000000001
=   00000000000000000000000000000001 (1) 
```

结果为 0 的情况

```
IS 15 == 15:

15 - 15 = 0               (00000000000000000000000000000000)
0 >> 0x1F = 0             (00000000000000000000000000000000)

-(15 - 15) = 0            (00000000000000000000000000000000)
0 >> 0x1F = ((uint)0)=0   (00000000000000000000000000000000) cast to uint so 1

    00000000000000000000000000000000
OR
    00000000000000000000000000000000
=   00000000000000000000000000000000 (0) 
```

这也应该比使用任何对 Math 或任何其他 .NET 方法的调用要快得多。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-29T18:54:56.067

```
x.CompareTo(y) 
```

直接来自[MSDN](http://msdn.microsoft.com/en-us/library/y2ky8xsk.aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T18:54:49.157

使用`CompareTo()`功能

```
int i = 5;
int n = 6;

int c = i.CompareTo(n); 
```

我通常在`if`语句中使用它：

```
int x = 34;
int y = 25;

if(x.CompareTo(y) == 0)
{
  Console.WriteLine("Yes, they are equal");
}
else
{
  Console.WriteLine("No, they are not equal");
} 
```

编辑：

在有人声称 Int32.CompareTo() 可以返回 -1|0|1 以外的值后，我决定自己研究这种可能性。

这是反映的代码`Int32.CompareTo()`。我看不到除了-1|0|1之外的任何一个都将返回任何东西。

```
[TargetedPatchingOptOut("Performance critical to inline across NGen image boundaries")]
public int CompareTo(int value)
{
    if (this < value)
    {
        return -1;
    }
    if (this > value)
    {
        return 1;
    }
    return 0;
}

public int CompareTo(object value)
{
    if (value == null)
    {
        return 1;
    }
    if (!(value is int))
    {
        throw new ArgumentException(Environment.GetResourceString("Arg_MustBeInt32"));
    }
    int num = (int) value;
    if (this < num)
    {
        return -1;
    }
    if (this > num)
    {
        return 1;
    }
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-29T18:54:30.293

这是 Math.Sign() 函数。

像这样：

```
return Math.Sign(x-y); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-29T18:55:42.593

您可以尝试使用此代码

```
var result = a.CompareTo(b); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-29T18:57:38.157

对整数使用[CompareTo方法：](http://msdn.microsoft.com/en-us/library/y2ky8xsk.aspx)

```
public int c(int x, int y)
{
  return x.CompareTo(y);
}

void Main()
{       
    Console.WriteLine(c(5,3));
    Console.WriteLine(c(3,3));
    Console.WriteLine(c(1,3));
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-29T19:06:10.897

你试过用`compareTo()`吗？看这里：http: [//msdn.microsoft.com/en-us/library/y2ky8xsk.aspx](http://msdn.microsoft.com/en-us/library/y2ky8xsk.aspx)

# sql-server - 使用 openquery 连接到 Active Directory

> ID：12184670
> 
> 赞同：2
> 
> 时间：2012-08-29T18:52:48.180
> 
> 标签：sql-server, active-directory

我有以下代码可以连接到我的活动目录，然后将用户拉到某个组中。由于代码在下面，它可以正常工作，但是我必须对我想要查看的部门进行硬编码。

我正在尝试将参数传递给 openqueries 第二个参数（第二个代码），但我一直收到错误消息，我知道它的引号有问题，任何帮助将不胜感激，谢谢，

```
select *
from openquery(ADSI, '

select
givenName, 
sn, 
sAMAccountName, 
displayName,
mail, 
telephoneNumber, 
mobile, 
physicalDeliveryOfficeName, 
department, 
division

from ''LDAP://DC=directorysync,DC=cfc, DC=com'' 
where objectCategory = ''Person'' 
and objectClass = ''user''
and department = ''Production''
AND displayname <> ''0_UW_Template_Remote''
ORDER BY displayName
')

select *
from openquery(ADSI, '

select
givenName, 
sn, 
sAMAccountName, 
displayName,
mail, 
telephoneNumber, 
mobile, 
physicalDeliveryOfficeName, 
department, 
division

from ''LDAP://DC=directorysync,DC=cfc, DC=com'' 
where objectCategory = ''Person'' 
and objectClass = ''user''
and department = '''+@Department+'''
AND displayname <> ''0_UW_Template_Remote''
ORDER BY displayName
') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:01:43.773

您不能在`openquery`调用中构造查询，您需要在变量中构建查询然后执行它。

```
declare @qry varchar(8000)
set @qry = 'select *
from openquery(ADSI, ''
    select
    givenName, 
    sn, 
    sAMAccountName, 
    displayName,
    mail, 
    telephoneNumber, 
    mobile, 
    physicalDeliveryOfficeName, 
    department, 
    division

    from ''''LDAP://DC=directorysync,DC=cfc, DC=com'''' 
    where objectCategory = ''''Person'''' 
    and objectClass = ''''user''''
    and department = '''''+@Department+'''''
    AND displayname <> ''''0_UW_Template_Remote''''
    ORDER BY displayName
'')'

exec(@qry) 
```

# java - Jstl 负零

> ID：12184677
> 
> 赞同：5
> 
> 时间：2012-08-29T18:52:59.063
> 
> 标签：java, jstl

如果您尝试以下位，您将得到 -0

```
<c:set var="demo" value="-0.04" />
<fmt:formatNumber maxFractionDigits="1" value="${demo}" var="demo" /> 
```

但如果你测试是否小于 0 它说的是真的

```
<c:if test="${demo < 0.00}">...</c:if> 
```

我该如何解决这个问题？这似乎没有意义，0 等于 -0，我用代数证明了它......在[这篇文章](https://stackoverflow.com/questions/4199808/is-there-a-negative-zero)中，他们指向 IEEE 参考，但我仍然无法解决问题

编辑：感谢您的评论，代码示例中有一个错误。我将四舍五入的值分配给演示变量。而且输出不是0，而是-0，我试了一下

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T11:00:03.870

在这里远射，但是否因为它将原始 -0.04 解析为字符串？

也许试试这个，我认为这会迫使它评估为一个数字：

```
<c:set var="demo" value="${-0.04}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T14:24:18.627

您可以编写自己的数字格式标签来弥补这一点。

```
// Read these values from tag attributes
String pattern = "0";
Double myNumber = -0.04d;

// Create a decimal format with correct rounding
DecimalFormat df = new DecimalFormat(pattern);
df.setRoundingMode(RoundingMode.HALF_UP);

// Format in two steps to compensate for '-0'
String temp = df.format(myNumber + 1);
String formatted = df.format(Double.valueOf(temp) - 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T13:24:28.400

好的，这次我想我可以解释一下了：它是 的一个错误（或功能）`java.text.DecimalFormat`，它是`<fmt:formatNumber />`在引擎盖下使用的。

这是我作为实验尝试的快速 Beanshell 会话的复制粘贴：

```
BeanShell 2.0b4 - by Pat Niemeyer (pat@pat.net)
bsh % import java.text.*;
bsh % fmt = new DecimalFormat();
bsh % fmt.setMaximumFractionDigits(1);
bsh % print(fmt.format(-0.04d));
-0
bsh % 
```

# msmq - 如何执行 MSMQ 跟踪

> ID：12184683
> 
> 赞同：0
> 
> 时间：2012-08-29T18:53:26.610
> 
> 标签：msmq, trace, etw

我正在寻找一种方法来跟踪 MSMQ 活动（API 调用，或类似的东西）

我看到几个提到 ETW 跟踪的参考资料，但它们不是很清楚或不完整。

有没有关于这个主题的简单教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T18:59:08.247

有一个实用程序可以做到这一点。不幸的是，输出是加密的，读取它的唯一方法是将其发送到 MS。

如果您有 MS 支持合同，我会打电话给他们。

[http://blogs.msdn.com/b/johnbreakwell/archive/2008/07/09/latest-version-1-5-of-the-logging-script-for-msmq-3-0.aspx](http://blogs.msdn.com/b/johnbreakwell/archive/2008/07/09/latest-version-1-5-of-the-logging-script-for-msmq-3-0.aspx)

该博客有一些很棒的 MSMQ 故障排除技巧，可能也会有所帮助。

# javascript - 使用jquery ui在jquery中动画（文本）颜色

> ID：12184685
> 
> 赞同：1
> 
> 时间：2012-08-29T18:53:30.870
> 
> 标签：javascript, jquery

```
<!-- include Google's AJAX API loader -->
<script src="http://www.google.com/jsapi"></script>
<!-- load JQuery and UI from Google (need to use UI to animate colors) -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.17/jquery-ui.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
$("#menuknop1").hover(function() {
    $(this).animate({"color":"black"}, "slow");
}, function() {
    $(this).animate({"color":"white"}, "slow");
});

});
</script>

<div id="menuknop1"><i>Home</i></div> 
```

我正在尝试为这段代码设置动画，以便文本在悬停时变为黑色，在离开该区域时变为白色。为什么这不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:55:17.477

首先加载 jQuery——jQuery-UI 是一个插件，不包含 jQuery 本身：

```
<!-- load JQuery and UI from Google (need to use UI to animate colors) -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script> 
```

除此之外，您的代码在这里工作得很好：http: [//jsfiddle.net/mblase75/pMeJc/——](http://jsfiddle.net/mblase75/pMeJc/)前提是您使用 jQuery 1.7.2。

jsFiddle 不允许我选择 jQuery UI 1.8.18 和 jQuery 1.8.0，[所以显然它与那个版本不兼容](http://jqueryui.com/docs/Upgrade_Guide)。根据 jQuery-UI 网站，“ [1.8.23 修复了 jQuery 1.8.0 的所有已知问题](http://blog.jqueryui.com/2012/08/jquery-ui-1-8-23/)。”

# java - JSON字符串到Java中的String数组

> ID：12184687
> 
> 赞同：0
> 
> 时间：2012-08-29T18:53:36.707
> 
> 标签：java, json

```
JSONArray cities = json.getJSONArray("city"); 
```

使用上面的代码得到以下输出：

```
{
"id":"1",
"name":"London"
"country":"United Kingdom"
},

{
"id":"2",
"name":"Madrid"
"country":"Spain"
},

{"id":"3",
"name":"Paris"
"country":"France"
},

{
"id":"3",
"name":"Zurich"
"country":"Switzerland"
} 
```

如何仅将 JSON 数组中的名称获取到字符串数组？

例如：`String[] s ={"London","Madrid","Paris","Zurich"}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:03:02.103

`cities`是 JSONObjects 的数组。遍历该 JSONObjects 数组，并`"name"`从每个对象中获取属性。请参阅@pb2q 的答案，其中代码已为您方便地编写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:04:47.157

```
// you should probably mention what json library you use in your question
String[] cities = new String[cities.length()];
for (int i = 0; i<cities.length(); i++) {
    cities[i] = cities.getJsonObject(i).getString("name");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:05:20.630

循环`JSONArray`并拉出`"name"`字段。这与您的`json.getJSONArray("city");`调用类似，只是在循环中：

```
JSONArray cities = json.getJSONArray("city");
JSONObject city = null;
String[] s = new String[cities.length()];

for (int i = 0; i < cities.length(); i++)
{
    city = cities.getJsonObject(i);
    s[i] = city.get("name");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T20:10:23.183

您可以尝试使用[JsonPath 之](http://code.google.com/p/json-path/)类的库。

代码会是这样的：

```
String rawJsonString = ...;
List<String> cities = JsonPath.read(rawJsonString, "$.city.name"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T18:47:35.163

使用 JsonPath [http://code.google.com/p/json-path/](http://code.google.com/p/json-path/)

```
<dependency>
    <groupId>com.jayway.jsonpath</groupId>
    <artifactId>json-path</artifactId>
    <version>0.8.1</version>
</dependency> 
```

您可以获得所有城市名称

```
String rawJsonString = "...";
List<String> cities = JsonPath.read(rawJsonString, "$.city[*].name"); 
```

# node.js - nodejs重新连接网络连接

> ID：12184688
> 
> 赞同：6
> 
> 时间：2012-08-29T18:53:40.240
> 
> 标签：node.js

我有一个到套接字的网络客户端连接（使用 net.createConnection(port,host)。这工作正常。

但是，有时服务器可能会断开连接，我希望网络连接在服务器备份和运行时自动重新连接

我可以捕获 on('end') 事件以捕获初始断开连接，并尝试重新连接。

但是，我如何检查客户端是否已连接，因为我想在退避策略上每 n 毫秒重试一次

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T02:21:14.690

在您的处理程序中，设置将重试连接的超时，并设置将取消超时`end`的一次性处理程序。`connect`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-25T16:33:43.513

这是另一种对我有用的方法。

```
if ( !client.readable )
    client.connect(PORT,HOST);
else
    logger.debug('Attempt to reconnect on an active connection. Ignored.'); 
```

如果连接处于活动状态，则使用 client.readable 将立即返回一个值。如果没有，那么只需重新连接。使用 client.writable 失败。

我发现这种方法更强大，因为有时 END 或 CLOSE 事件不会发生（例如：VPN 关闭、服务器端崩溃或电源故障等）

# c# - 在 Visual Studio C# 上启用 tls

> ID：12184689
> 
> 赞同：0
> 
> 时间：2012-08-29T18:53:41.573
> 
> 标签：c#, html, visual-studio-2010, ssl

在 SmtpClient 可用的下拉方法中，仅包括 EnableSsl，但不包括 tls。

> 在 visio studio c# 上启用 tls 的步骤是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:00:00.890

TLS 只是 v3 之后 SSL 的另一个名称；没有版本号，它们的含义基本相同。请注意，内置的 SMTP 客户端仅支持`STARTTLS`样式安全连接，而不支持 SMTPS（使用自己的单独端口的连接）。如果您需要 SMTPS 支持，您需要寻找第三方 SMTP 客户端或自行开发。

# ruby-on-rails-3 - Formtastic 删除数字

> ID：12184692
> 
> 赞同：0
> 
> 时间：2012-08-29T18:53:49.513
> 
> 标签：ruby-on-rails-3, formtastic

我有以下工作。

```
<%= semantic_form_for ([:admin,@client]) do |f| %>
  <%= f.inputs do %>
  <label class="formlabel">Name</label>
  <%= f.input :name, :input_html => { :class => 'text-input small-input'  }, :label => false, :hint => "Enter Company Name" %>
<% end %>
<%= f.actions %>
<% end %> 
```

这输出以下内容

1 名称文本字段用于输入

并保存

如何删除 Formtastic 中的“1”

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-06T16:30:47.360

您可以将以下行添加到您的`app/assets/stylesheets/client.css.scss`

```
.my_form ol, ul {
   list-style: none;
} 
```

然后用`:class => "my_form"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T20:03:06.240

您必须通过 CSS 删除这些。Formtastic 使用列表标签格式来写出它的表格。

我知道如果你使用 twitter-bootstrap 会有一个宝石，它会改变 formtastic 写出表格的方式。但是，编辑 CSS 通常很容易。

# sql - 查询获取路径

> ID：12184695
> 
> 赞同：0
> 
> 时间：2012-08-29T18:53:54.787
> 
> 标签：sql, sql-server, logic

我有一个包含以下数据的表：

```
Source | Destination
-------------------
46      47
47      49
48      49
49      50 
```

我想编写一个返回路径列表的 sql，即 For 46,50 作为输入查询应该返回 46,47,49,50 作为输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:40:34.037

在 SQL Server 中，您可以使用递归公用表表达式 (CTE)，如下所示：

```
declare @table Table(child int, parent int)

insert into @table(child, parent)
Values  
    (46, 47),
    (47, 49),
    (48, 49),
    (49, 50)

declare @start int
set @start = 46
;

with t1(child, parent) as (
select child, parent from @table t2
where child = @start
union all
select t.child,t.parent
from @table as t
join t1 on t1.parent = t.child
)
select parent from t1
union
select child from @table
where child = @start 
```

以下是上述查询的结果：

```
(4 row(s) affected)
parent
-----------
46
47
49
50

(4 row(s) affected) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:30:59.427

这是一个 WHILE 循环（伪/未测试）；您也可以尝试递归 CTE。

```
--INPUT VARS
@path_begin int
@path_end int

--FUNCTION OR PROC
DECLRE @source int
DECLRE @destination int
DECLRE @path varchar(max)
SET @path = 'No Path Exists'

SELECT @source = source FROM table WHERE source = @path_begin
SELECT @destination = destination FROM table WHERE destination = @path_end

IF @source is not null AND @destination is not null
BEGIN
   SET @path = @source
   WHILE @source < @destination
   BEGIN
      SELECT @source = min(source) FROM table WHERE source > @source AND @source < destination
      SET @path = @path + ',' + @source
   END
   SET @path = @source + ',' + @destination
END

RETURN @path 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:51:15.093

Derek Greer 上面关于使用公用表表达式的解决方案是不正确的，原因有几个。两个简单的是：

1.  它没有回答最初的问题，因为目标是提供起点和终点，但他的解决方案只有一个起点。
2.  如果样本表中的第二行 (47, 49) 被删除，它将消除从 47 到 50 的任何可能路径，并且应该返回一个空值。相反，提供的代码提供了错误的路径（46、47、48、49）

以下来自 tamago 的解决方案也不起作用。尝试一些简单的案例，包括您在问题中请求的 (46, 50) 示例，您会发现它不起作用。

答案是这是计算机科学中的一个经典问题，称为旅行商问题。您可以在 Wikipedia 上阅读更多相关信息，网址为[http://en.wikipedia.org/wiki/Travelling_salesman_problem](http://en.wikipedia.org/wiki/Travelling_salesman_problem)。

已经有许多关于这个主题的算法发表。最容易实现的方法是搜索所有可能的排列，但由于存在大量可能性，这只适用于小数据集。更高级的算法需要更长的时间来实现，但可以处理更大的数据集。

你也可以考虑寻找一个近似的解决方案。有一些近似算法可以处理更大的数据集，虽然它们会返回有效路径，但它们可能找不到最短路径。

# ember.js - Ember.js 中的车把助手

> ID：12184696
> 
> 赞同：4
> 
> 时间：2012-08-29T18:54:03.017
> 
> 标签：ember.js, handlebars.js

我一直在尝试获得一个看似简单的 Handlebars 助手，以便如果元素的 ID 与所选元素的 ID 匹配，我可以在 {{each}} 块中将元素标记为活动。

这是使用我在网上找到的一些帮手的[一次尝试。](http://jsfiddle.net/skawaguchi/73wtf/)

```
Handlebars.registerHelper('ifequal', function (val1, val2, fn, elseFn) {
    console.log(val1);
  console.log(val2);
  if (val1 === val2) {
    return fn();
  } else if (elseFn) {
    return elseFn();
  }
}); 
```

我的一个朋友也有一个[更“把手方式”的尝试](http://jsfiddle.net/arcosdev/Rxdbg/)。

因此，在每个人告诉我将我的元素包装在视图中并使用 didInsertElement 或其他东西之前，让我问我的实际问题：在这种情况下，ember 中的把手助手是否损坏？我的助手期待一个值，它得到一个字符串。这是预期的行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T20:13:36.863

看起来这是正常的行为，

您可以尝试以下方法：

```
var getPath = Ember.Handlebars.getPath;
Handlebars.registerHelper('ifequal', function (val1, val2, options) {
  var context = (options.fn.contexts && options.fn.contexts[0]) || this;
  var val1 = getPath(context, val1, options.fn);
  var val2 = getPath(context, val2, options.fn);
  console.log(val1);
  console.log(val2);
  if (val1 === val2) {
    return options.fn(this);
  } else{
    return options.inverse(this);
  }
}); 
```

小提琴：http: [//jsfiddle.net/73wtf/28/](http://jsfiddle.net/73wtf/28/)

Ref1：[https](https://github.com/emberjs/ember.js/blob/master/packages/ember-handlebars/lib/helpers/debug.js) ://github.com/emberjs/ember.js/blob/master/packages/ember-handlebars/lib/helpers/debug.js Ref2：[http ://handlebarsjs.com/block_helpers.html](http://handlebarsjs.com/block_helpers.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T21:32:55.387

在`registerHelper`中，它将绑定字符串而不是实际值传递给您的函数。所以你可以用它`getPath`来获取实际值。无论如何，我同意这种行为似乎“不自然”。我想使用绑定字符串的原因是为了使自动更新工作。

# php - 在 php 中回显 php 标签

> ID：12184698
> 
> 赞同：0
> 
> 时间：2012-08-29T18:54:16.890
> 
> 标签：php, echo

我想在 php 文件中打印 php 标签，所以我正在使用

```
$variable="<?php   
include("./$folder/$folder.php"); 
?>";
echo "$variable"; 
```

但它给了我错误

解析错误：语法错误，意外的 T_STRING

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T18:54:57.290

您需要使用反斜杠字符 ( `\`) 转义双引号：

```
$variable="<?php   
include(\"./$folder/$folder.php\"); 
?>"; 
```

您还可以通过删除不必要的引号来清理您的`echo`表达式：

```
echo $variable; 
```

# sql - Python计算数据库中唯一项目的总和

> ID：12184702
> 
> 赞同：1
> 
> 时间：2012-08-29T18:54:25.997
> 
> 标签：sql, tsql, python-2.7

**这是我所拥有的：**

一个 MSSQL 数据库和表，可以说 200 行

## Python 2.7 和 pyodbc

有一列，我们称之为类型，在它下面的行中包含未知数量的唯一值。例如，现在可能存在**a,b,c,d,e**和**f**的值*，但*在未来，**a**可能会消失，或者我们可能会添加**g**。

因此，我不相信我可以有一组预定义的变量或某种字典来参考。

我的目标是让 python/sql 查看表格，确定有多少唯一项目，然后计算每个唯一项目的总数，给我一个输出，如：*有 50 个 a 和 23 个 b 和 5 个 c*

是否有一些功能可以实现这一点，或者 SQL 中有什么东西可以为我做到这一点？我是否必须确定唯一项目的数量，然后为每个项目运行 sql 语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:56:22.073

你可能只想要这个[`count`功能](http://msdn.microsoft.com/en-us/library/ms175997.aspx)：

> ## 数数
> 
> 返回组中的项目数。

```
select count(*), type from that_one_table group by type 
```

[group by](http://msdn.microsoft.com/en-us/library/ms177673.aspx)的 MSDN 参考对它的描述比我想象的要好：

> ## 通过...分组
> 
> 根据 SQL Server 2012 中的一个或多个列或表达式的值将一组选定的行分组为一组汇总行。为每个组返回一行。SELECT 子句列表中的聚合函数提供有关每个组而不是单个行的信息。

# android - 我可以在同一个“onCreateDialog”中有 2 个对话框吗？

> ID：12184714
> 
> 赞同：0
> 
> 时间：2012-08-29T18:55:10.793
> 
> 标签：android, eclipse, datepicker, timepicker

我设置了一个 onCreateDialog，我需要放置 2 个对话框（Datepicker 和 Timepicker），但是当我将它们都放在 onCreateDialog 中时，它只会打开第一个是 Datepicker。

代码：

```
 @Override
protected Dialog onCreateDialog(int id) {
    //date picker
            switch (id) {
                case DATE_DIALOG_ID:
               // set date picker as current date
                    return new DatePickerDialog(this, datePickerListener, year, month,day);
                }
            //time picker
            switch (id) {
                case TIME_DIALOG_ID:
                    //set time picker as current time
                    return new TimePickerDialog(this, timePickerListener, hour, minute,false);
                    }
            return null;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T18:57:20.720

是的，你可以，但你`switch`的无效。的正确语法`switch`是：

```
switch( variable ) {
  case value1:
      ...
      break;
  case value X:
      ...
      break;
} 
```

并且可以选择`default`捕获您没有明确`case`的所有其他值。你有两个没用的开关。你正确的代码是：

```
AlertDialog myDialog = null;

switch (id) {
  case DATE_DIALOG_ID:
    // set date picker as current date
    myDialog = new DatePickerDialog(this, datePickerListener, year, month,day);
    break;

  case TIME_DIALOG_ID:
    //set time picker as current time
    myDialog = new TimePickerDialog(this, timePickerListener, hour, minute,false);
    break;

}

return myDialog; 
```

您的 ID 也必须是唯一的，但是一旦您修复了`switch`，如果您将其设置为相同的值，编译器将显示错误（因为给定的值不能超过一个`case`）。

```
public static final int TIME_DIALOG_ID = 1;
public static final int DATE_DIALOG_ID = 2; 
```

编辑：我再次修改了这个，因为我个人不喜欢该方法的多个退出点 - 你有很多`return`.

# spring - 用于 Xml 响应的 Spring RestTemplate POST 方法？

> ID：12184731
> 
> 赞同：4
> 
> 时间：2012-08-29T18:56:16.910
> 
> 标签：spring, resttemplate

我已经通过 REST API 工具测试了一个 POST 请求并以 XML 格式获取响应。

我不确定需要使用哪种方法以及上面的响应类型类应该是什么。

有人可以帮我提供相同的代码片段吗？

谢谢， 凯瑟尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T18:15:58.910

您需要添加 xml 消息转换器以将 xml 消息转换为 java 对象。

查看解决方案[堆栈溢出](https://stackoverflow.com/questions/5170698/how-to-use-spring-resttemplate-and-jaxb-marshalling-on-a-url-that-returns-multip)

您还可以捕获字符串格式的结果，然后手动处理它。例子 ：

```
String xmlData = restTemplate.postForObject(url, parameters, String.class);
// pass this string to xml parser and prepare java object 
```

[示例 xml 解析示例](http://www.genedavis.com/library/xml/java_dom_xml_creation.jsp)

希望这可以帮助

# jquery - (jquery-ui) 设置 CSS 颜色的项目上的 toggleClass 颜色转换

> ID：12184733
> 
> 赞同：0
> 
> 时间：2012-08-29T18:56:25.347
> 
> 标签：jquery, css, jquery-ui

我正在尝试使用 jquery-ui toggleClass（带有持续时间）将具有颜色的类添加到已经在 CSS 中明确设置了颜色的元素。

除非我将要切换*到*的类中的颜色标记为“！important”，否则一旦转换完成，这种颜色就不会粘住。如果我将其设置为“！important”，颜色会按预期向一个方向消失，但不会在另一个方向顺利返回。

我之前作为解决方法实施的一种解决方案是假设一个 2 色场景，并且只使用 jquery 的**动画**来手动设置悬停事件的颜色，而不是使用 toggleClass。但是，我现在尝试在应用此效果之前**不知道**元素的*起始颜色的情况下使用它。*

 **任何关于如何在两个方向上实现平稳过渡的想法都将不胜感激。

看到这个jsfiddle：http: [//jsfiddle.net/BM6NT/](http://jsfiddle.net/BM6NT/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:02:31.350

这将解决它 [http://jsfiddle.net/BM6NT/7/](http://jsfiddle.net/BM6NT/7/)

```
a.fancy, div.fancy {
    margin-left:5px;
    color:orange;
} 
```**

# python - Tkinter 弹出窗口中的小部件从另一个窗口中的小部件获取 Tab 焦点

> ID：12184739
> 
> 赞同：1
> 
> 时间：2012-08-29T18:56:51.107
> 
> 标签：python, tkinter

当我创建一个新的 Toplevel 弹出窗口（实际上是 tkSimpleDialog.Dialog 的子类）并尝试使用 Tab 键浏览其小部件时，我注意到我的 Tkinter 应用程序中的一个问题。它按预期工作，除了我在应用程序主窗口的列表框中选择的任何内容都未选中，就好像弹出窗口中的小部件从中获得了焦点一样。有谁知道为什么会发生这种情况以及如何防止它？我的 Tkinter 知识不包括窗口之间的交互如何影响焦点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:06:57.407

解决方案：在弹出窗口中创建条目小部件时，将它们的exportselection 属性设置为0。然后选择它们不会影响任何其他选择。

# javascript - 当我使用 JS/jQuery/任何插件单击图像时，如何使背景变暗 + 无法点击并且图像放大并居中？

> ID：12184740
> 
> 赞同：-3
> 
> 时间：2012-08-29T18:56:55.197
> 
> 标签：javascript, jquery

我目前正在玩弄 Flickr API，并正在尝试制作它，以便我可以搜索任何图像术语并且会出现一堆 Flickr 图像。但是，我也想要它，以便当我单击图像时，它会在背景和其他所有内容变暗时弹出，而您无法单击它。点击后我是否还需要一个“X”来关闭图片，以便用户可以继续浏览我的网站？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:07:45.340

[FancyBox](http://fancyapps.com/fancybox/)是你的新朋友，请善待他。

* * *

关于如何将 Flickr API 与 FancyBox 一起使用的一些指南：

[http://www.gregjopa.com/2010/12/flickr-feed-with-fancybox/](http://www.gregjopa.com/2010/12/flickr-feed-with-fancybox/)

[http://verivore.com/posts/6-flickr-photosets-and-fancybox-jquery](http://verivore.com/posts/6-flickr-photosets-and-fancybox-jquery)

[http://carst.me/2011/08/search-for-photos-using-jquery-flickr-api-and-fancybox-part-2/](http://carst.me/2011/08/search-for-photos-using-jquery-flickr-api-and-fancybox-part-2/)

[（在 Google 上搜索的前几条结果`Fancybox + Flickr`）。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:01:11.413

将内容放在绝对或固定定位的 div 中，并使用另一个半透明 div 作为背景

# android - Android 平板电脑与 Android 智能手机的屏幕关闭行为

> ID：12184741
> 
> 赞同：0
> 
> 时间：2012-08-29T18:56:57.923
> 
> 标签：android, android-intent, android-service

我们正在为业务用户构建一个特定的应用程序。应用程序记录 GPS 坐标并通过 HTTP 将其发布到服务。

在测试时我们发现了一个问题，即平板电脑（Android 3.3）屏幕关闭时，应用程序无法与外部服务通信。在我打开屏幕的那一刻，应用程序立即恢复，然后能够与外部服务进行通信。

我在智能手机（Android 2.2）上对此进行了测试，即使手机屏幕关闭，它也能完美运行。

我没有为我的应用程序使用任何类型的服务。我们开始开发时牢记智能手机，但后来也将其带到了平板电脑上。我们从未想过平板电脑的行为会有所不同。

该应用程序的核心概念是定期将 GPS 坐标发送到 Web 服务。

我可以在平板电脑上做些什么，让我的应用程序在屏幕关闭或平板电脑不是为此而构建时在后台运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:15:27.773

从上面评论中的讨论来看，您似乎需要从 PowerManager 获取部分唤醒锁。如果没有部分唤醒锁定，设备的正常行为是在屏幕关闭时暂停 CPU。

唤醒锁是一个有点棘手的 API，但其想法是，您可以通过保持屏幕打开、保持屏幕打开但昏暗或仅保持CPU 开启；然后在您想让设备进入睡眠状态时释放它。这将对您的用户的电池寿命产生不利影响，但从它的声音来看，优先级是了解设备位置。 [文档](http://developer.android.com/reference/android/os/PowerManager.html)很好地描述了所涉及的内容，并且有[一些教程](http://www.vogella.com/blog/2011/02/07/android-wakelock/)可以帮助您入门。

# ios - 随机 DatePicker 崩溃

> ID：12184742
> 
> 赞同：0
> 
> 时间：2012-08-29T18:56:59.170
> 
> 标签：ios, crash, uidatepicker

我有一个日期选择器并随机收到一个崩溃，说它有更多的 100,000 行。这怎么可能？有谁知道为什么会发生此错误，以及将来如何防止它？

```
- (void)showDatePicker
{   

    actionSheet = [[UIActionSheet alloc] initWithTitle:nil 
                                              delegate:nil
                                     cancelButtonTitle:nil
                                destructiveButtonTitle:nil
                                     otherButtonTitles:nil];

    [actionSheet setActionSheetStyle:UIActionSheetStyleBlackTranslucent];

    datePicker = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, 40, 0, 0)];
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    NSString *startTimeString = [MathFunctions minutesToTimeString:[appointment.start_time integerValue]];
    [dateFormatter setDateFormat:@"yyyyMMdd h:mm a"];
    [dateFormatter setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]];
    NSString *dateTimeString = [NSString stringWithFormat:@"%@ %@", appointment.date, startTimeString];

    datePicker.date = [dateFormatter dateFromString:dateTimeString];
    [actionSheet addSubview:datePicker];

    UISegmentedControl *closeButton = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObject:@"Done"]];
    closeButton.momentary = YES; 
    closeButton.frame = CGRectMake(260, 7.0f, 50.0f, 30.0f);
    closeButton.segmentedControlStyle = UISegmentedControlStyleBar;
    closeButton.tintColor = [UIColor blackColor];
    [closeButton addTarget:self action:@selector(changeDate:) forControlEvents:UIControlEventValueChanged];
    [actionSheet addSubview:closeButton];

    [actionSheet showInView:self.view];
    [actionSheet setBounds:CGRectMake(0, 0, 320, 485)];
    actionSheet.frame = CGRectMake(actionSheet.frame.origin.x, actionSheet.frame.origin.y, actionSheet.frame.size.width, 320);
} 
```

崩溃原因：

```
Reason: Failed to allocate data stores for 100000 rows in section 0\. Consider using fewer rows 
```

崩溃分析日志：

```
CoreFoundation  __exceptionPreprocess + 162
1    libobjc.A.dylib    objc_exception_throw + 32
2    CoreFoundation +[NSException raise:format:]
3    Foundation -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 90
4    UIKit  -[UISectionRowData refreshWithSection:tableView:tableViewRowData:] + 1780
5    UIKit  -[UITableViewRowData numberOfRows] + 108
6    UIKit  -[UITableView noteNumberOfRowsChanged] + 118
7    UIKit  -[UITableView reloadData] + 730
8    UIKit  -[UIPickerView layoutSubviews] + 3430
9    UIKit  -[UIDatePickerView layoutSubviews] + 62
10   UIKit  -[UIPickerView _selectRow:inComponent:animated:notify:] + 80
11   UIKit  -[UIDatePickerView _selectRow:inComponent:animated:notify:] + 50
12   UIKit  -[UIDatePickerView _loadDateAnimated:] + 836
13   UIKit  -[UIDatePickerView _updateBitsForDate:forced:andReload:animateIfNeeded:] + 696
14   UIKit  -[UIDatePickerView _setDate:animated:forced:] + 348
15   UIKit  -[UIDatePickerView setDate:animated:] + 30
16   UIKit  -[UIDatePicker setDate:] + 36 
```

# python - OpenCV 保存图像显着增加了 .tif 的文件大小

> ID：12184750
> 
> 赞同：3
> 
> 时间：2012-08-29T18:57:28.280
> 
> 标签：python, opencv, tiff

我在 Python 中使用[OpenCV使用](http://opencv.willowgarage.com/wiki/)[MatchTemplate](http://opencv.willowgarage.com/documentation/cpp/object_detection.html)方法在其他图像中查找图像。我注意到当我加载一个 .tif 文件然后重新保存它时，即使我没有更改 opencv 中的图像，文件大小也会急剧增加，例如，从 68kb 到 25mb。

我编写了一个非常基本的脚本来验证是否会在没有任何其他代码修改图像的情况下发生这种情况。

```
import cv, sys

filename = sys.argv[1]

image = cv.LoadImage(filename)
cv.SaveImage('test.tif', image) 
```

我没有看到任何优化图像的选项。关于我如何能够在 OpenCV 中保持原始文件大小的任何想法，或者这只是事后压缩的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:36:46.770

可能是源被压缩 tif 而重写的源未被压缩。

有关潜在的解决方案，请参阅[https://code.ros.org/trac/opencv/ticket/1080](https://code.ros.org/trac/opencv/ticket/1080)

# android - Android LocationManager 的互联网数据使用情况

> ID：12184760
> 
> 赞同：6
> 
> 时间：2012-08-29T18:58:05.553
> 
> 标签：android, gps, locationmanager

Android LocationManager 在获取定位时是否有时会使用数兆字节的互联网数据？如果是这样，在什么情况下？即使使用 LocationManager 的应用程序没有明确的访问互联网权限，它也会发生吗？

我问这个是因为我最近注意到“Android OS”使用的互联网数据（如我的带有 Android 4.0.4 的三星 Galaxy Note 上的“设置”->“数据使用”屏幕所报告的那样）有时每天 10 兆字节或更多。实验表明，仅当我运行我编写的应用程序并使用位置管理器提供的 GPS 位置数据时才会使用这种数据。当此应用未运行“Android OS”时，每天仅使用几千字节的数据。

应用清单中的唯一权限是“android.permission.ACCESS_FINE_LOCATION”和“android.permission.WRITE_EXTERNAL_STORAGE”。没有访问互联网的权限。

Activity 的 onStart() 方法包含以下代码：

```
 if (!mapview .ignoreGPS ) {
           lm.requestLocationUpdates(LocationManager. GPS_PROVIDER , gpsMinTime , gpsMinDistance , this );
    } 
```

当忽略 GPS 标志关闭时，会调用类似的代码。

还有一个包含代码的 gotoLastLocation() 方法：

```
 Location l = lm.getLastKnownLocation(LocationManager. GPS_PROVIDER );

           if (l == null ) {
                 l = lm .getLastKnownLocation(LocationManager. NETWORK_PROVIDER);
          } 
```

这个方法很少被调用，当ignoreGPS标志被关闭或者当用户选择一个菜单选项去最后一个已知位置时。

除了这个很少被调用的方法之外，没有提到“NETWORK_PROVIDER”。

GPS_PROVIDER 是否默认使用“辅助 GPS”？如果是这样，这可以使用数兆字节的数据吗？即使没有互联网许可？

如果 GPS_PROVIDER 无法从 GPS 信号中获得修复，LocationManager 默认使用手机网络吗？即使应用没有网络权限？这会被电话提供商算作互联网数据访问吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T14:49:55.130

不，从来没有，下载辅助数据的 SUPL 协议只使用几千字节的数据。即使您在白天经常运行它，与浏览器使用量相比也不会太多。

Google 有时会在使用`NETWORK_PROVIDER`. 但即使这样也不算多。

您可以尝试杀死所有后台进程或更好地卸载不需要的应用程序吗？

我最好的猜测是，您可能正在使用`MapView`下载地图图块和卫星图像的工具——这些数据很重

# xcode - 如何将文件添加到 Xcode 项目？（编写 Unity 插件）

> ID：12184762
> 
> 赞同：7
> 
> 时间：2012-08-29T18:58:15.867
> 
> 标签：xcode, plugins, unity3d, undefined-symbol

我敢打赌我的问题是非常基本的，所以请原谅我对 Xcode 不是很有经验，因为我在 Unity 工作并为我们的 iOS 项目使用现成的插件，所以直到现在才真正需要深入研究 Xcode。

我想编写一个非常基本的自定义插件，但无法让 Xcode 接受它。我按照 Unity 页面上的教程进行操作，并将我的 .h 和 .m 文件添加到 Assets / Plugins / iOS，其中（如教程所述）它们将自动合并到 Xcode 中。

构建后，Xcode 抛出两个错误： *"Undefined symbols for architecture armv7: "__XY", referenced from: __Z19RegisterMonoModulesv in RegisterMonoModules.o"* 和 armv6 相同。

正如我在这里读到的类似问题，这是因为文件没有添加到 Xcode 项目中，尽管事实上它们应该自动添加。在 Xcode 中，我可以在 Project Navigator 中看到我的两个文件。我还在 Build Phases 列表中看到了我的 .mm 文件。

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T22:53:25.990

看起来您遇到了链接器错误。如果你的文件出现在 XCode 和你的 Build Phase 列表中，那么让你的#include 语句都井井有条。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-20T08:58:52.440

我有同样的问题，将源文件添加到 xcode 项目。由于没有软件可以在不点击一些色彩鲜艳的界面的情况下完成这项工作，我开始了一个小项目来手动添加文件（CLI）：[XCodeControl](https://github.com/ikrabbe/XCodeControl)。它是一个简单的 macos 程序，应该可以正常工作，包括文档。

# c# - C#：将字符串转换为已知操作序列

> ID：12184765
> 
> 赞同：0
> 
> 时间：2012-08-29T18:58:23.133
> 
> 标签：c#, string, parsing, lexer

我想将 A 中给出的一串扑克牌转换为 B 形式，这样我就可以产生结果 C。

```
A: "(AK,AQ,(A2:*h*h)):*s*s!AsQs,(JJ:*s*h)"
B: (((AsKs union AsQs union (A2 intersect hand with two hearts)) intersect hand with two spades) less AsQs) union (JJ intersect hand with one spade one heart)
C: AsKs,JsJh 
```

操作的优先级是

*   1) 括号，'()'
*   2）相交和更少（左关联），'：！'
*   3）联合，'，'

我有在 B 中执行操作的功能，例如 Intersect("AA", "*s*s") == "AsAs"，但我需要一种方法来从表单 A 进入表单 B 的输入和我可以按顺序执行以到达 C 的相关操作。

我看过[Irony](http://irony.codeplex.com/releases/view/8499 "讽刺")和其他一些词法分析器/解析器解决方案，但对于这个问题，它们似乎有点矫枉过正。有没有更简单的解决方案？

*   也许递归地将字符串拆分为具有表示操作的节点的树？
*   以相反的优先顺序分解字符串并将其推入堆栈？如果是这样（大致）如何实施？

[这里](http://www.propokertools.com/simulations)给出了我试图模仿的一个工作示例。[您可以在此处](http://www.propokertools.com/simulations/generic_syntax)找到 A 语法的更详细说明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:09:44.547

您可以解析`A`以构造一棵指令树，然后从叶子开始执行它们（因为我假设您想先执行最里面括号的内容）。对于这个解析任务，你可以使用正则表达式，或者任何你想要的。在我的脑海中，我认为您可以首先查找括号和运算符符号来找出树结构，然后用实际的基本指令和运算符的每个连接点填充每个叶子。

存储的数据结构`A`可以由`Expression`实现接口的对象（调用它们）组成`IOperand`；每个都`Expression`应该有三个字段：

1.  一个字段`Operator`，它是 的一个实例`enum Operations {Union, Intersection, SetDiff}`，或者只是一个字符串，这取决于您喜欢哪个。
2.  两个字段`Operand1`and `Operand2`，可以是“Ah”（定义一组卡片）之类的东西，也可以是另一个`Expression`. 因此，它们应该被声明为`IOperand`.

你的持有一组卡片的类，比如“Ah”，也应该实现这个`IOperand`。接口`IOperand`本身实际上不需要做任何事情。

为了将每个给定指令与操作相匹配，您可以使用一个简单的开关，或者使用一个`Dictionary`of `string`(or `enum`) to `delegate IOperand SetOp(IOperand, IOperand);`，然后`Dictionary`使用（匿名）函数填充您的函数（其中包含 的指令`B`）。

在这种`Dictionary`情况下，您只需能够做到`instructionList[thisExpression.Operation](thisExpression);`（这可能会更优雅地完成以避免引用`thisExpression`两次）并且将执行字符串输入的适当 C# 翻译。

**概念证明**

我已经做了一个基本的实现和一个控制台应用程序来演示这里的用法：[https ://bitbucket.org/Superbest/lexer](https://bitbucket.org/Superbest/lexer)

如果你在整个练习中成功地保持理智（计算机会将你用作代理解析和操作库，祝你好运），那么最后一步应该要求你评估一个等于的表达式`C`，然后打印什么你刚回到你身边。（第一次运行时，你可能想遵守程序的指令。我怀疑很容易破坏代码并得到很多异常，如果你想一想你的无效发生了什么，你会很困惑输入。）

如果您按原样运行代码，请尝试以下答案序列（，= Enter）：

```
n, y, 2, n, n, n, y, 2, n, n, y, n, y, 2, n, n, n, n, alpha, beta, gamma 
```

您的输出将是：

```
gamma 
```

您应该能够简单地更新标记为过时的方法体并拥有一个工作程序。

如果您希望添加更多二进制操作，请参阅`Simplification.Simplification()`. 通过查看我已经进行的三个操作，适当的语法将是显而易见的；事实上，该代码仅支持二进制操作。如果您的方法使用字符串，则可以使用该`SimplifiedOperand.Symbol`字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T01:03:24.797

我想出了这个作为解决方案（使用 Superbest 回答中的树的想法）。对您将要更改的内容的任何评论将不胜感激！

*   输入：“AsQs,(JJ!ss:xy),(AA:xy!ss)”
*   漂亮的打印输出： AsQs union (((JJ less ss) intersection xy) union ((AA intersection xy) less ss))

```
 public class Node

{
    private string mStr;
    private string mOperation;
    private List mChildren = new List();
    //private Collection mCollection = new Collection();

    public Node(string input)
    {
        mStr = Regex.Replace(input, @"^\(([^\(\)]*)\)$", "$1");

        Init();
    }

    private void Init()
    {
        Split(mStr);

        return;
    }

    public Collection GenerateHands()
    {
        Collection collection = new Collection();

        if (Children == 0) { collection.Add(mStr); }

        if (Children > 0)
        {
            if (mOperation == "union") { collection = mChildren.ElementAt(0).GenerateHands().Union(mChildren.ElementAt(1).GenerateHands()); }
            if (mOperation == "intersect") { collection = mChildren.ElementAt(0).GenerateHands().Intersect(mChildren.ElementAt(1).GenerateHands()); }
            if (mOperation == "less") { collection = mChildren.ElementAt(0).GenerateHands().Less(mChildren.ElementAt(1).GenerateHands()); }
        }

        return collection;
    }

    public string PrettyPrint()
    {
        string print = "";

        if (Children == 0) { print += mStr; }

        if (Children > 0)
        {
            if (mChildren.ElementAt(0).Children > 0) { print += "("; }
            print += mChildren.ElementAt(0).PrettyPrint();
            if (mChildren.ElementAt(0).Children > 0) { print += ")"; }
            if (Children > 0) { print += " " + mOperation + " "; }
            if (mChildren.ElementAt(1).Children > 0) { print += "("; }
            print += mChildren.ElementAt(1).PrettyPrint();
            if (mChildren.ElementAt(1).Children > 0) { print += ")"; }
        }

        return print;
    }

    private void Split(string s)
    {
        // WARNING: Either could pass a,aa or a:aa

        // WARNING: This can hand down a 0 length string if ',' is at beginning or end of s.
        if (CommaOutsideBrackets(s) >= 0)
        {
            mChildren.Add(new Node(s.Substring(0, CommaOutsideBrackets(s))));
            mChildren.Add(new Node(s.Substring(CommaOutsideBrackets(s) + 1, s.Count() - CommaOutsideBrackets(s) - 1)));

            mOperation = "union";
        }

        // WARNING: This could throw negative if for example (aaaa)bb
        else if (OperatorOutsideBrackets(s) >= 0)
        {
            mChildren.Add(new Node(s.Substring(0, OperatorOutsideBrackets(s))));
            mChildren.Add(new Node(s.Substring(OperatorOutsideBrackets(s) + 1, s.Count() - OperatorOutsideBrackets(s) - 1)));

            if (s[OperatorOutsideBrackets(s)] == '!') { mOperation = "less"; }
            if (s[OperatorOutsideBrackets(s)] == ':') { mOperation = "intersection"; }
        }

        // We must be done?
        else
        {
        }
    }

    private int CommaOutsideBrackets(string s)
    {
        int countRound = 0, countSquare = 0;

        for (int i = 0; i = 0; i--)
        {
            if (s[i] == '!' || s[i] == ':') { return i; }
        }

        return -1;
    }

    public string Str
    {
        get { return mStr; }
    }

    public int Children
    {
        get { return mChildren.Count; }
    }
} 
```

# ios - 归档 iOS 时找不到 Phonegap CDVViewController.h 文件

> ID：12184767
> 
> 赞同：38
> 
> 时间：2012-08-29T18:58:29.597
> 
> 标签：ios, xcode, cordova

我目前正在使用 Phonegap 2.0 在 XCode 中开发 iOS 应用程序。该应用程序在模拟器和测试设备上构建和运行良好。

当我尝试存档应用程序以进行分发时出现问题。存档失败并显示以下消息：

未找到 CDVViewController.h 文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-09-26T07:45:54.527

**Xcode 6.x**

添加`$(OBJROOT)/UninstalledProducts/include`到 BuildSettings->Header Search Paths

**Xcode 7.x**

添加`$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include`到 BuildSettings->Header Search Paths

1.双击`<multiple values>`，你可以添加这个。

2.`$(OBJROOT)/UninstalledProducts/include`更改为`$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include`

[![在此处输入图像描述](../Images/d80fff4ac53a6e1a17277c6e33d5c6a8.png)](https://i.stack.imgur.com/PG89G.png)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2015-10-23T01:00:31.137

在**Xcode 7.1**上，您需要将**`header search paths`**字段更新`$(OBJROOT)/UninstalledProducts/include`为`$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include`

您可以**`header search paths`**在**`build settings`**->下找到**`search paths`**

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-24T16:14:43.950

设法修复它。

我的目标设置的构建设置中的“标题搜索路径”中缺少这些：

```
"$(TARGET_BUILD_DIR)/usr/local/lib/include"
"$(OBJROOT)/UninstalledProducts/include"
"$(BUILT_PRODUCTS_DIR)" 
```

从多个来源获取解决方案：

升级 Cordova iOS（从 31 开始）[http://docs.phonegap.com/en/2.0.0/guide_upgrading_ios_index.md.html#Upgrading%20Cordova%20iOS](http://docs.phonegap.com/en/2.0.0/guide_upgrading_ios_index.md.html#Upgrading%20Cordova%20iOS)

错误报告[https://issues.apache.org/jira/browse/CB-1122](https://issues.apache.org/jira/browse/CB-1122)

在 groups.google.com/forum/?fromgroups=#!topic/phonegap/IcR8-ijrUfk 讨论

在 groups.google.com/forum/?fromgroups=#!topic/phonegap/PzqZEm8QKmc 讨论

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-10-26T18:06:05.323

对于未来的参考：

我刚刚为自己解决了这个确切的问题。

如果您使用的是 Cordova cli，并且更新了 config.xml，则可以将 ios 作为平台删除并重新添加。然后再次从 XCode 归档。

```
cordova platform remove ios
cordova platform add ios 
```

希望对我有帮助，完美地工作，

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-05T19:47:14.573

我遇到了完全相同的问题。我相信它可能已经被引入，因为我在使用 Cordova 的工具创建 Xcode 项目后移动了它的位置。或者，也可能是我没有正确设置 Cordova iOS 工具集 - 也许我没有运行安装程序包（我已经重建了这台机器几次）。此外，我在 Google 上找到的所有相关答案都表明我需要更改 Cordova 的一些核心类——我不愿意这样做。

我的解决方案是使用 Cordova`create`命令构建一个全新的 Xcode 项目。我将原始项目的`www`目录复制到新项目中，然后重新配置新项目以匹配原始项目的设置。

新项目使用相同的插件、框架和构建设置成功地构建了一个存档，而原始项目却不能。这不是一个理想的解决方案 - 但它确实有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-21T22:05:11.567

将我的项目复制到另一个文件夹时，我遇到了同样的问题。我正在使用 Phonegap 2.0.0。在尝试了几种解决方案均未成功后，我运行 Product->Clean 并且一切正常。不要问我为什么，但这条路径已经解决了我必须处理的几个小故障，即更改了未在设备上更新的启动画面和图标文件。希望这有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-15T05:09:18.760

有时，一个公认的解决方案可能无法帮助每个人解决类似但可能不相关的问题。

我的观察结果类似（未找到 CDVViewController.h）。首先确保目标设置包括如上所述的“标题搜索路径”。

然后按照这个链接找到对我有用的东西：http: [//outof.me/embedding-cordovalib-in-your-iosphonegap-app-project/](http://outof.me/embedding-cordovalib-in-your-iosphonegap-app-project/)

本质上，我需要将cordova重新链接为目标依赖项，然后将其链接到我的库。

那么，如果您迁移到 cordova 2.5.0，您可能会遇到一个问题，该问题会吐出类似于以下内容：“_ALAssetPropertyDate”，引用自：

```
 ___23-[CDVFile getMetadata:]_block_invoke in libCordova.a(CDVFile.o)

  ___27-[CDVFile getFileMetadata:]_block_invoke in libCordova.a(CDVFile.o) 
```

“_OBJC_CLASS_$_ALAssetsLibrary”，引用自：

```
 objc-class-ref in libCordova.a(CDVFile.o)

  objc-class-ref in libCordova.a(CDVFileTransfer.o)

  objc-class-ref in libCordova.a(CDVURLProtocol.o) 
```

"

如果是 os，添加 AssetLibrary 框架并有一些平静。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-30T14:02:55.590

```
$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include 
```

将此添加到“构建设置”中的“搜索路径”部分可以完美地工作。

[XCode 构建设置中的搜索路径](http://i.stack.imgur.com/64mRR.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-17T03:28:18.063

您可能需要更新您的 CordovaLib 子项目参考。

启动终端 转到您在 bin 子文件夹中安装 Cordova 的位置。例如，`/Users/Shared/Cordova/phonegap-2.2.0/lib/ios/bin`

运行以下命令，其中第一个参数是项目的 .xcodeproj 文件的路径：

```
./update_cordova_subproject /path/to/your/project 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-16T00:31:28.107

Xcode 7.2 有点不同

```
$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include 
```

需要放在标题搜索路径中进行调试和发布。

![标头搜索路径具有调试和发布子字段](../Images/9c62c42395ef573670142ea16b4f93cb.png)

# c# - 无法在 Silverlight 应用程序中使用 WCF 导入 wsdl:portType、wsdl:binding、wsdl:port 错误

> ID：12184771
> 
> 赞同：5
> 
> 时间：2012-08-29T18:58:46.613
> 
> 标签：c#, .net, wcf, visual-studio-2012, silverlight-5.0

我有一个 Silverlight 应用程序，它通过 WCF 服务与服务器端的 ADO.Net 数据实体进行通信。实际上，我使用多个 WCF 服务与三个不同的数据 ADO.Net 数据实体进行通信。我最初在 Visual Studio 2010 上构建了这个项目，最近大约一周前转移到了 Visual Studio Professional 2012（试用版）。最初一切正常/移植良好，直到大约一个小时前我对服务没有任何问题。不到一个小时前，我实际上在我的代码中使用了这些相同的 WCF 服务。但是，当我添加一种将 xml 字符串插入数据库的方法时，我收到了这个错误：

```
Content Type text/xml; charset=utf-8 was not supported by service . The client and service bindings may be mismatched. 
```

但是我检查了绑定，据我从 ServiceReferences.ClientConfig 文件中可以看出，它们是 basicHttpBinding。我四处寻找解决方案，我能找到的唯一一个建议删除服务引用并在重新启动 Visual Studio 后阅读它，所以我终于尝试了，但是现在，即使删除了我添加的方法，我现在在我尝试在客户端上添加服务引用：

```
Warning 6   Custom tool warning: Cannot import wsdl:portType
Detail: An exception was thrown while running a WSDL import extension: System.ServiceModel.Description.DataContractSerializerMessageContractImporter
Error: Exception has been thrown by the target of an invocation.
XPath to Error Source: //wsdl:definitions[@targetNamespace='http://tempuri.org/']/wsdl:portType[@name='IXMonitorXMLDataService']    C:\Users\ckarrs\Documents\Visual Studio 11\Projects\SL_xMonitor_Frontend_RefactorV1_Backup82212\SL_xMonitor_Frontend_RefactorV1\Service References\XMonitorXMLDataService\Reference.svcmap  1   1   SL_xMonitor_Frontend_RefactorV1

Warning 7   Custom tool warning: Cannot import wsdl:binding
Detail: There was an error importing a wsdl:portType that the wsdl:binding is dependent on.
XPath to wsdl:portType: //wsdl:definitions[@targetNamespace='http://tempuri.org/']/wsdl:portType[@name='IXMonitorXMLDataService']
XPath to Error Source: //wsdl:definitions[@targetNamespace='http://tempuri.org/']/wsdl:binding[@name='BasicHttpBinding_IXMonitorXMLDataService']    C:\Users\ckarrs\Documents\Visual Studio 11\Projects\SL_xMonitor_Frontend_RefactorV1_Backup82212\SL_xMonitor_Frontend_RefactorV1\Service References\XMonitorXMLDataService\Reference.svcmap  1   1   SL_xMonitor_Frontend_RefactorV1

Warning 8   Custom tool warning: Cannot import wsdl:port
Detail: There was an error importing a wsdl:binding that the wsdl:port is dependent on.
XPath to wsdl:binding: //wsdl:definitions[@targetNamespace='http://tempuri.org/']/wsdl:binding[@name='BasicHttpBinding_IXMonitorXMLDataService']
XPath to Error Source: //wsdl:definitions[@targetNamespace='http://tempuri.org/']/wsdl:service[@name='XMonitorXMLDataService']/wsdl:port[@name='BasicHttpBinding_IXMonitorXMLDataService']  C:\Users\ckarrs\Documents\Visual Studio 11\Projects\SL_xMonitor_Frontend_RefactorV1_Backup82212\SL_xMonitor_Frontend_RefactorV1\Service References\XMonitorXMLDataService\Reference.svcmap  1   1   SL_xMonitor_Frontend_RefactorV1

Warning 9   Custom tool warning: No endpoints compatible with Silverlight 5 were found. The generated client class will not be usable unless endpoint information is provided via the constructor.  C:\Users\ckarrs\Documents\Visual Studio 11\Projects\SL_xMonitor_Frontend_RefactorV1_Backup82212\SL_xMonitor_Frontend_RefactorV1\Service References\XMonitorXMLDataService\Reference.svcmap  1   1   SL_xMonitor_Frontend_RefactorV1

Warning 10  Custom tool warning: Exception has been thrown by the target of an invocation.  C:\Users\ckarrs\Documents\Visual Studio 11\Projects\SL_xMonitor_Frontend_RefactorV1_Backup82212\SL_xMonitor_Frontend_RefactorV1\Service References\XMonitorXMLDataService\Reference.svcmap  1   1   SL_xMonitor_Frontend_RefactorV1 
```

我感到很困惑。其他服务引用保持不变，并且该服务完全正常工作，直到我尝试添加并更新引用。这是 VS 2010 和 2012 之间的兼容性问题吗？MSDN 网站称 VS 2012 向后兼容 VS 2010，一切似乎都可以正常迁移。非常感谢任何帮助，我很困惑。如果需要其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:07:04.930

我不是 WCF 专家，但我了解 .net Web 服务和 WSDL，所以如果信息与 WCF 无关，请更正。

错误说：`An exception was thrown while running a WSDL import extension`。这意味着，VS 无法正确读取服务 WSDL 文件，也无法创建它需要的代理客户端类，以便进行服务调用。

因为引用 Web 服务的 .net 应用程序会自动获取 WSDL，有时它不是它所期望的，这可能会导致麻烦。有一种方法可以配置 WSDL 文件的生成方式，但这并不容易（[在此处阅读更多内容](http://msdn.microsoft.com/en-us/library/aa738489.aspx)）

尝试通过`?wsdl`在浏览器中的服务 URL 后键入查询来获取 WSDL 文件，并查看其中的内容。如果服务器位于代理服务器后面，这可能会导致问题。在 WSDL 文件的末尾，您将找到“绑定”、“端点”和“端口”标签/属性。

根据您发布的错误消息，WSDL 不符合预期的架构，解析失败。

一个简单的解决方法是，如果您有权访问服务器，则将生成的 WSDL 文件保存在服务所在的同一目录中，根据您**的需要修改 WSDL 文件**，并在您的客户端应用程序。当然，这有一个副作用，即每次更改服务定义时文件都不同步。因此，如果您打算在将来大量更改方法，最好更改/修复自动[WSDL 生成](http://msdn.microsoft.com/en-us/library/ms734765.aspx)。

# c++ - 对 Windows HANDLE 使用 std::unique_ptr

> ID：12184779
> 
> 赞同：22
> 
> 时间：2012-08-29T18:59:20.810
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012, unique-ptr

我正在尝试使用 std::unique_ptrs 以异常安全的方式管理 Windows HANDLE。

首先我试过：

```
struct HandleDeleter
{
    void operator()( HANDLE handle )
    {
        if( handle )
        {
            FindVolumeClose( handle )
        }
    }
}
typedef std::unique_ptr< HANDLE, HandleDeleter > unique_vol_handle_t; 
```

稍后在我的代码中尝试使用它时：

`unique_vol_handle_t volH( FindFirstVolumeW( buffer, MAX_GUID_PATH ) );`

我从 Visual Studio 2012RC 收到以下错误：

```
1>          error C2664: 'std::unique_ptr<_Ty,_Dx>::unique_ptr(std::nullptr_t) throw()' : cannot convert parameter 1 from 'HANDLE' to 'std::nullptr_t'
1>          with
1>          [
1>              _Ty=HANDLE,
1>              _Dx=VolumeHandleDeleter
1>          ]
1>          nullptr can only be converted to pointer or handle types 
```

参考上面的 volH 声明行。

搜索了一段时间，找到[了一篇博客文章](http://codesequoia.wordpress.com/2012/08/26/stdunique_ptr-for-windows-handles/#comment-45)，基本上是这样说的，补充一下：

`typedef HANDLE pointer;`

到结构声明的顶部，一切都会好起来的。

我不相信，但我试过了，它确实解决了错误。我很困惑如何定义一个类型（甚至不引用它）会产生这样的差异。

两个问题：

1）你能解释一下原来的错误吗？我不明白为什么编译器指的是`std::nullptr_t/nullptr`.

2) typedef 是如何解决这个问题的（或者至少看起来是这样的）？对此是否有一个不那么“幽灵般的远距离行动”解决方案？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-29T19:14:35.893

`unique_ptr`检查删除器上是否存在`::pointer`类型的实现。如果删除器具有类型，`::pointer`则此类型用作`pointer`. `unique_ptr`否则使用指向第一个模板参数的指针。

根据[cppreference.com](https://en.cppreference.com/w/cpp/memory/unique_ptr#Member_types)，`unique_ptr::pointer`类型定义为

> `std::remove_reference<D>::type::pointer`如果该类型存在，否则`T*`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-29T19:17:28.903

从[MSDN 手册 unique_ptr](http://msdn.microsoft.com/en-us/library/ee410601%28v=vs.100%29.aspx)：

> 存储的指向拥有资源的`stored_ptr`指针具有类型指针。`Del::pointer`如果已定义，则为，如果未定义`Type *`。**如果删除器**是无状态的，则存储的**删除器**对象`stored_deleter`不占用对象中的空间。请注意，Del 可以是引用类型。

 **这意味着如果你提供一个删除器函子，它必须提供一个`pointer`用于`unique_ptr`. 否则它将是指向您提供的类型的指针，在您的情况下`HANDLE*`这是不正确的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-06-21T20:41:56.463

我一直在为 Windows 中的各种类型的句柄执行以下操作。假设我们已经在某处声明：

```
std::unique_ptr<void, decltype (&FindVolumeClose)> fv (nullptr, FindVolumeClose); 
```

这填充有：

```
HANDLE temp = FindFirstVolume (...);
if (temp != INVALID_HANDLE_VALUE)
    fv.reset (temp); 
```

无需声明单独的结构来包装删除器。因为`HANDLE`真的是一个`void *`作为`unique_ptr`它`void`的类型；对于使用`DECLARE_HANDLE`宏的其他类型的句柄，可以避免这种情况：

```
// Manages the life of a HHOOK
std::unique_ptr<HHOOK__, decltype (&UnhookWindowsHookEx)> hook (nullptr, UnhookWindowsHookEx); 
```

等等。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-12-21T22:58:19.183

用于 Windows HANDLE的正确（和安全）方法`std::unique_ptr`是这样的：

```
#include <windows.h>
#include <memory>

class WinHandle {
    HANDLE value_;
public:
    WinHandle(std::nullptr_t = nullptr) : value_(nullptr) {}
    WinHandle(HANDLE value) : value_(value == INVALID_HANDLE_VALUE ? nullptr : value) {}

    explicit operator bool() const { return value_ != nullptr; }
    operator HANDLE() const { return value_; }

    friend bool operator ==(WinHandle l, WinHandle r) { return l.value_ == r.value_; }
    friend bool operator !=(WinHandle l, WinHandle r) { return !(l == r); }

    struct Deleter {
        typedef WinHandle pointer;
        void operator()(WinHandle handle) const { CloseHandle(handle); }
    };
};

inline bool operator ==(HANDLE l, WinHandle r) { return WinHandle(l) == r; }
inline bool operator !=(HANDLE l, WinHandle r) { return !(l == r); }
inline bool operator ==(WinHandle l, HANDLE r) { return l == WinHandle(r); }
inline bool operator !=(WinHandle l, HANDLE r) { return !(l == r); }

typedef std::unique_ptr<WinHandle, WinHandle::Deleter> HandlePtr; 
```

这种方式`INVALID_HANDLE_VALUE`被隐含地视为 null，因此永远不会传递给`CloseHandle`函数，并且您永远不需要显式测试它。像往常一样使用`std::unique_ptr`'s `operator bool()`：

```
HandlePtr file(CreateFile(...));
if (!file) {
    // handle error
} 
```

**编辑：**我最初忘记了这`INVALID_HANDLE_VALUE` [不是](https://blogs.msdn.microsoft.com/oldnewthing/20040302-00/?p=40443)***该类型[的唯一](https://blogs.msdn.microsoft.com/oldnewthing/20040302-00/?p=40443)[**无效**](https://blogs.msdn.microsoft.com/oldnewthing/20040302-00/?p=40443)[*值*](https://blogs.msdn.microsoft.com/oldnewthing/20040302-00/?p=40443)，实际上它被许多（如果不是大多数）内核函数`HANDLE`视为[*有效*的伪句柄。](https://msdn.microsoft.com/en-us/library/windows/desktop/ms683179(v=vs.85).aspx)嗯，很高兴知道。***

 **** * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-15T23:44:39.637

我建议您查看[*A Proposal to Add additional RAII Wrappers to the Standard Library*](http://www.andrewlsandoval.com/scope_exit/)以及[*使用带句柄的智能指针的缺点*](https://stackoverflow.com/q/14878121)。

就个人而言，我正在使用该提案的参考实现，而不是在`std::unique_ptr`这些情况下使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-01-21T16:58:43.633

请查看[Window Implementation Libraries](https://github.com/Microsoft/wil/wiki/RAII-resource-wrappers) (WIL)，尤其是处理无效句柄值的`unique_handle`vs。`unique_hfile`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-12-19T09:45:06.670

虽然@Levi Haskell 他的回答考虑了 INVALID_HANDLE_VALUE 它没有考虑到 0 是一个有效的句柄值并将 INVALID_HANDLE_VALUE 和 0 （或 nullptr ）视为相同。这是不正确的：

我的建议（基于 Levi Haskell 他的代码，因此归功于他）

```
template<void *taInvalidHandleValue>
class cWinHandle 
{
    HANDLE value_ { taInvalidHandleValue };
public:
    cWinHandle() = default;
    cWinHandle(HANDLE value) : value_(value) {}
    ~cWinHandle()
    {
        reset();
    }

    explicit operator bool() const { return value_ != taInvalidHandleValue; }
    operator HANDLE() const { return value_; }

    HANDLE get() const { return value_; }
    HANDLE release() { HANDLE const result{ value_ }; value_ = taInvalidHandleValue; return result; }
    friend bool operator ==(cWinHandle l, cWinHandle r) { return l.value_ == r.value_; }
    friend bool operator !=(cWinHandle l, cWinHandle r) { return !(l == r); }
    void reset ()
    {
        if (value_ != taInvalidHandleValue)
        {
            CloseHandle(value_);
            value_ = taInvalidHandleValue;
        }
    }
};

inline bool operator ==(HANDLE l, cWinHandle<nullptr> r) { return cWinHandle<nullptr>(l) == r; }
inline bool operator !=(HANDLE l, cWinHandle<nullptr> r) { return !(l == r); }
inline bool operator ==(cWinHandle<nullptr> l, HANDLE r) { return l == cWinHandle<nullptr>(r); }
inline bool operator !=(cWinHandle<nullptr> l, HANDLE r) { return !(l == r); }
inline bool operator ==(HANDLE l, cWinHandle<INVALID_HANDLE_VALUE> r) { return cWinHandle<INVALID_HANDLE_VALUE>(l) == r; }
inline bool operator !=(HANDLE l, cWinHandle<INVALID_HANDLE_VALUE> r) { return !(l == r); }
inline bool operator ==(cWinHandle<INVALID_HANDLE_VALUE> l, HANDLE r) { return l == cWinHandle<INVALID_HANDLE_VALUE>(r); }
inline bool operator !=(cWinHandle<INVALID_HANDLE_VALUE> l, HANDLE r) { return !(l == r); } 
```*****

# spring - 当属性内部有占位符时，无法解析属性占位符

> ID：12184793
> 
> 赞同：0
> 
> 时间：2012-08-29T19:00:15.017
> 
> 标签：spring

我有一个属性文件 -

application.properties（内容如下）

```
core.microsite=q=MarketId:${marketId}&q=PresaleOff 
```

这是我的弹簧配置 xml -

```
<bean id="myBean" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="ignoreUnresolvablePlaceholders" value="true" />
        <property name="location" value="classpath:/application.properties" />
     </bean>

<bean id="MyQueryBuilder" class="com.search.builder.impl.MyQueryBuilder">
        <property name="queryTemplateMap">
            <map>
                <entry key="microsite" value="${core.microsite}" />
            </map>
        </property>
    </bean> 
```

现在在服务器启动（tomocat）我得到这个异常 -

```
ug 29, 2012 11:50:05 AM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name 'MyQueryBuilder' defined in URL [jar:file:/C:/apache-tomcat-6.0.35/webapps/my-service/WEB-INF/lib/my-app-1.0.2.RC8-SNAPSHOT.jar!/META-INF/spring/config/app-context.xml]: Could not resolve placeholder 'marketId'
    at org.springframework.beans.factory.config.PropertyPlaceholderConfigurer.processProperties(PropertyPlaceholderConfigurer.java:287)
    at org.springframework.beans.factory.config.PropertyResourceConfigurer.postProcessBeanFactory(PropertyResourceConfigurer.java:75)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:663) 
```

它显然失败了，因为 core.microsite 属性内部还有一个占位符**${marketId}**

如何解决这个问题？

将“ignoreUnresolvablePlaceholders”设置为 true 应该有效（理论上）。不知道现在该怎么办？

感谢任何指针！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T02:15:43.377

我不完全确定错误的根本原因，但可以推荐一些解决方法：

**解决方法 1**：以这种方式更改占位符的前缀：

```
 <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:/application.properties"/>
    <property name="placeholderPrefix" value="%{"></property>
</bean>

<bean id="MyQueryBuilder" class="com.search.builder.impl.MyQueryBuilder">
    <property name="queryTemplateMap">
        <map>
            <entry key="microsite" value="%{core.microsite}" />
        </map>
    </property>
</bean> 
```

**解决方法 2**：如果您绝对需要让您的属性值具有 $，则暂时将 ${marketId} 更改为其他名称，例如 %{marketId}，`@PostConstruct`在您的 MyQueryBuilder 上查看地图条目并查找并替换所有%{marketId} 与 ${marketId} 的出现

# shell - SSH 后运行脚本命令

> ID：12184794
> 
> 赞同：9
> 
> 时间：2012-08-29T19:00:15.503
> 
> 标签：shell, ssh

我需要编写一个脚本，将 SSH 连接到远程主机，然后在该远程主机上运行某些命令，然后退出。如果我只是这样做

```
ssh $host

#some command 
```

该脚本将通过 SSH 进入，等到我手动退出，然后运行命令。

如何在远程主机上运行这些命令？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-29T19:01:17.857

```
ssh $host 'command1; command2; command3' 
```

或者如果您只有一个命令：

```
ssh $host command1 
```

或者如果你有很多命令（一个脚本文件）：

```
cat file | ssh $host sh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-18T06:16:34.000

如果您有多个服务器，也可以使用它。

```
for ((i=1; i <= 10; i++))
do
echo $i
ssh host$i << EOF
cd /somedir
command1;
command2;
EOF
done 
```

# java - 比较java中的两个csv文件并为double做近似匹配

> ID：12184811
> 
> 赞同：0
> 
> 时间：2012-08-29T19:01:14.923
> 
> 标签：java, csv, junit

我需要编写一个 JUnit 测试，它将比较两个相同格式的 csv 文件，并且只有当它们的绝对差小于阈值时才会通过。我需要字符串和双精度匹配，它应该满足阈值标准。

CSV 格式：

```
第一个.csv
 名称 price-1 price-2
 项目 1 5.12 6.12
 项目 2 4.23 5.56
 项目 3 11.2 12.23

第二个.csv

 名称 price-1 price-2
 项目 1 5.12 6.10
 项目 2 4.20 5.50
 项目 3 11.19 12.19

```

现在假设差异阈值为 0.15。所以这里 first.csv 和 second.csv 中 item2 的 price1 之间的绝对差异是 0.03，那么它将通过 JUnit 测试，如果差异阈值为 0.02，那么它将失败。

有什么好的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T19:04:39.623

当您将 assertEquals 与 double 一起使用时，您可以传入一个阈值。这在junit中称为delta。

或者你可以使用

```
assertTrue (Math.abs(val1 - val2) < threshold); 
```

所以在你的例子中

价格 2 是 6.12 和 6.10

在第一个你可以使用

```
assertEquals(6.12d, 6.10d, 0.15) 
```

这会通过

或者

```
assertEquals(Math.abs(6.12d - 6.10d) < 0.15) 
```

这会过去的。

我建议使用 assertEquals 并插入数字，以便您了解 assertEquals 重载方法

当您从文件中读取时，您可能会读取字符串。让他们双倍然后做

```
try {
    Double d1 = Double.parseDouble(str1);
    Double d2 = Double.parseDouble(str2);
    assertEquals(d1, d2, 0.15);
}catch (NumberFormatException e) {
    //not a number so cannot compare - perhaps call fail("fail msg here")
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T19:03:56.683

您在标签中列出了 junit。

Junit 的 .equals(double, double, accuracy) 允许您指定它们与最后一个参数的接近程度。

我只是读入值并在测试中为每个调用 .equals ...

或者有什么我没有得到的问题吗？

要解析这些行，您的示例使用空格，但您说“CSV”（逗号分隔）。如果它们实际上是 CSV，你可以使用类似的东西：

```
String[] line = currentLine.split(",") 
```

在每一行。那会给你 line[0]="item1", line[1]="5.12", line[2]="6.12"

之后尝试使用 Double.parseDouble() 解析 line[1] 和 line[2]

顺便说一句，使用 assertEquals，而不是 assertTrue，更具体的 assertEquals 将显示您想要的值以及您在 junit 结果中作为错误的一部分获得的值。

我还建议您传入可选字符串。测试线如下所示：

```
assertEquals("item "+file1.line[0]+" values do not match",
    Double.parseDouble(file1.line[1]),
    Double.parseDouble(file2.line[1]),
    0.001) 
```

还有一个完整的问题是确保您为每个文件读取同一行 - 让它们正确配对。如果保证它们的顺序相同，那么你很好，但如果不是，你可能想通过 name 字段散列第一个文件：

```
for(String line: file1.readNextLine()) 
    file1hash.put(line.split(",")[0],line) 
```

然后，当您遍历第二个文件时，您可以轻松地执行以下操作：

```
for(String line2: file2.readNextLine())  {
    String line1=file1hash.get(line2.split(",")[0]) 
```

确保 line1 和 line2 指的是同一行。

# ruby-on-rails - Rails ActiveRecord 查询不等于

> ID：12184816
> 
> 赞同：64
> 
> 时间：2012-08-29T19:01:56.910
> 
> 标签：ruby-on-rails, activerecord

导轨 3.2.1

有没有办法（没有[squeel](https://github.com/activerecord-hackery/squeel)）使用 ActiveRecord 的哈希语法来构造一个`!=`运算符？

就像是`Product.where(id: !params[:id])`

生成`SELECT products.* FROM products WHERE id != 5`

寻找相反的`Product.where(id: params[:id])`

**更新**

在rails 4中有一个`not`操作员。

`Product.where.not(id: params[:id])`

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-08-29T19:16:24.240

您可以使用以下

```
Product.where('id != ?', params[:id]) 
```

这将生成您正在寻找的内容，同时参数化查询。

在 Rails 4 中，添加了以下语法以支持 not 子句

```
Product.where.not(id: params[:id]) 
```

添加多个带有链接的子句...

```
Product.where.not(id: params[:id]).where.not(category_id: params[:cat_id]) 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-08-29T19:16:26.710

没有任何内置方法可以做到这一点（从 Rails 3.2.13 开始）。但是，您可以轻松构建一种方法来帮助您：

```
ActiveRecord::Base.class_eval do
  def self.where_not(opts)
    params = []        
    sql = opts.map{|k, v| params << v; "#{quoted_table_name}.#{quote_column_name k} != ?"}.join(' AND ')
    where(sql, *params)
  end
end 
```

然后你可以这样做：

```
Product.where_not(id: params[:id]) 
```

**更新**

正如@DanMclain 回答的那样 - 这已经在 Rails 4 中为您完成（使用`where.not(...)`）。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-09-06T07:34:29.940

Rails 4 已经解决了这个问题。所以也许你可以更新你的 Rails 应用程序

```
Model.where.not(:id => params[:id]) 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-08-30T17:08:08.790

**Arel**可能是您可能想要探索的它我猜它包含在 Rails 3+ 中

在这里你如何使用**Arel**

```
Product.where(Product.arel_table[:id].not_eq(params[:id])) 
```

和

```
Product.where(Product.arel_table[:id].not_eq(params[:id])).to_sql 
```

会生成如下 SQL

```
SELECT `products`.* FROM `products`  WHERE (`products`.`id` != 1) 
```

希望这个帮助

# javascript - 如何从 django 表单库中隐藏复选框并使用 Javascript 切换其显示属性

> ID：12184818
> 
> 赞同：5
> 
> 时间：2012-08-29T19:02:06.500
> 
> 标签：javascript, django, django-models, django-forms, dom-events

我一直在用 html 制作一个带有复选框的表单，如果选中它，它会使用 Javascript 显示另一个复选框。我现在已经将该表单更改为使用 django 的表单库，但我不知道如何访问 django 输入字段的显示属性。我已经尝试过 HideInput 小部件，但所有这些并没有隐藏标签，只是盒子本身。

关于如何设置 django Form 对象的显示属性和/或如何使用 Javascript 切换这些属性和/或如何在 django Forms 上编写事件属性的任何帮助都会很棒！

模型.py：

```
class ContactForm(forms.Form):
Contact = forms.BooleanField(required=False, widget=CheckboxInput())
More = forms.BooleanField(required=False, widget=CheckboxInput()) 
```

html页面：

```
 <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
 <script type="text/javascript"> 

$(function(){
$('#id_Contact').click(function(){
 if($('#id_Contact').is(':checked')){
    $('#id_More').show();
 }
  });
});

    function ifChecked(id, id2){
        var ele = document.getElementById(id);
        var ele2 = document.getElementById(id2);

        if(ele.checked){
            ele2.style.display = "block";
        }
        else{
            ele2.style.display = "none";
        }
    }
</script>

<form action="/contact/" method="post">
{% for field in form %}
    <div class="fieldWrapper">
        {{ field.errors }}
        {{ field.label_tag }}: {{ field }}
    </div>
{% endfor %}
<p><input type="submit" value="Send message" /></p>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:13:07.960

你可以这样做。

```
from django.forms import CheckboxInput, HiddenInput

class ContactForm(forms.Form):
  Contact = forms.BooleanField(required=False, widget=CheckboxInput())
  More = forms.BooleanField(required=False, widget=HiddenInput()) 
```

你可以使用 jQuery

```
$(function(){
  $('#id_Contact').click(function(){
     if($('#id_Contact').is(':checked')){$('#id_More').show();}
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T19:45:35.797

你可以试试

{{ form.field_name_to_hide.as_hidden }}

在模板中

# backbone.js - Backbone Paginator - 在多个字段上使用 setFilter

> ID：12184822
> 
> 赞同：2
> 
> 时间：2012-08-29T19:02:17.840
> 
> 标签：backbone.js

我有一个主干应用程序，它返回一个分页集合，我把它放到一个表中。我可以一次在 1 列上应用过滤器，如下所示：

看法：

```
(function (views) {
    views.PaginatedView = Backbone.View.extend({
        events: {
            'click a.filter': 'filter'
        },
        getFilterField: function () {
            return $('#filterByOption').val();
        },
        getFilterValue: function () {
            return $('#filterString').val();
        },
        filter: function (e) {
            e.preventDefault();

            var fields = this.getFilterField(); // returns a value from a dropdown
            var filter = this.getFilterValue(); // returns a value from my input
            this.collection.setFilter(fields, filter);
            this.collection.pager();
        }
    });
})(app.views); 
```

模板：

```
<select id="filterByOption">
    <option value="Account">Account</option>
    <option value="Owner">Owner</option>
</select>

<span class="cell sort">
    <input id="filterString" type="text" class="cell" />
    <a href="#" class="filter btn small">Filter</a>
</span> 
```

我的问题是：我想对更多字段应用进一步的过滤器，但据我所知，该`setFilter`功能每次只允许过滤 1 个字段。例如：我想过滤帐户：123，其中有一个所有者：鲍勃。目前我只能过滤帐户或所有者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T08:04:11.603

据我所知，您可以`SeFilter`将`fields`.

因此，例如，您可以避免使用选择列表而只需设置：

```
var fields = ["Account","Owner"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:31:41.240

我不熟悉 setFilter 方法，但是为什么不使用下划线呢？一个例子是：

```
var filteredContent = _.filter(this.collection, function(model)
{  
    return model.Account === 123 && model.Owner === "Bob"; 
}); 
```

# android - ListView 在项目单击时更改文本

> ID：12184823
> 
> 赞同：3
> 
> 时间：2012-08-29T19:02:18.263
> 
> 标签：android, list, listview

我有一个由 textviews 构建的列表视图。

如果用户单击项目列表，单击项目的文本将被更改，我该怎么做？

我知道如何添加新项目，但更改其文本？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T19:15:27.520

首先，您需要在 ListView 中添加[一个](http://developer.android.com/reference/android/widget/ListView.html)[OnItemClickListener](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)：

```
mMyListView.setOnClickListener(new OnItemClickListener(
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
    }
)); 
```

在[OnItemClickListener](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html#onItemClick%28android.widget.AdapterView%3C?%3E,%20android.view.View,%20int,%20long%29)的[onItemClick](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)方法中有一个*视图*参数。它包含已单击的 ListView 的行。

使用该视图，您可以获取 TextView 然后更改文本：

```
public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
    TextView tv = (TextView) view.findViewById(R.id.your_text_view_id);
    tv.setText(...);
} 
```

如果您的 ListView 单元格仅包含 TextView，您可以安全地将视图直接转换为 TextView：

```
public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
    TextView tv = (TextView) view;
    tv.setText(...);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T19:11:54.287

您可以使用[AdapterView.OnItemClickListener](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)执行此操作。实现`onItemClick(AdapterView<?> parent, View view, int position, long id)`方法。`view`你在这里通过，是点击`TextView`项目的，所以应该足够了

```
((TextView)view).setText("Hey, I've just been tapped on!"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T19:20:50.847

```
 mListView.setOnClickListener(new OnItemClickListener(
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        TextView mTextView = (TextView) view;
        mTextView.setText("TextView was Clicked");
    }
)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-10T22:30:55.523

如果你有一个简单的适配器，它会起作用：

```
mListView.setOnClickListener(new OnItemClickListener(
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        TextView mTextView = (TextView) view;
        mTextView.setText("TextView was Clicked");
    }
)); 
```

但是，如果您有**自定义视图**，则需要查找视图来更改文本：

```
mListView.setOnClickListener(new OnItemClickListener(
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        //TextView mTextView = (TextView) view;
        //mTextView.setText("TextView was Clicked");
        ((TextView)(view.findViewById(R.id.description))).setText(""TextView was Clicked");
    }
)); 
```

# javascript - 在 Windows Metro 风格的 Javascript App 中读取文件内容

> ID：12184824
> 
> 赞同：1
> 
> 时间：2012-08-29T19:02:20.357
> 
> 标签：javascript, html, windows, microsoft-metro, windows-runtime

几个小时以来，我一直在努力，阅读（一遍又一遍）我可以在 MSDN 和 Windows Dev Center 上找到的教程；没有任何效果。

我似乎无法从纯文本文件中读取数据！

是的，我已经添加了文件关联，是的，我已经在我的项目中添加了声明。

来自msdn的代码：

```
(function () {
    "use strict";

    WinJS.UI.Pages.define("/pages/home/home.html", {
        // This function is called whenever a user navigates to this page. It
        // populates the page elements with the app's data.
        ready: function (element, options) {
            // TODO: Initialize the page here.

            Windows.Storage.FileIO.readTextAsync("AvailableBalance.sv").then(function (contents) {
                // Add code to process the text read from the file
                document.getElementById("AvailableBalanceText").innerText = contents;
            });
        }
    });
}); 
```

和：

`<h1 id="AvailableBalanceText"></h1>`

不工作。该应用程序加载正常 - 但只是不从文件中读取（或不显示数据）。

有人可以告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:34:11.753

`readTextAsync` [不需要文件名——它需要一个 IStorageFile](http://msdn.microsoft.com/en-us/library/windows/apps/hh701487.aspx)。

您需要在某处获取对文件的引用，而不仅仅是打开它。如果它是一个用户文件，那么您需要使用documentsLibrary打开它：

```
Windows.Storage.KnownFolders.documentsLibrary.getFileAsync("sample.dat").done(function (yourFileHandle) {
    // you now have a file handle.
}); 
```

请注意，这是在文档库中。如果您需要访问包中的文件或其他位置（您无法访问 Metro 中的任意路径，只能访问库、应用程序的本地数据和包），您需要使用其他 API 之一。我建议查看文件访问[示例](http://code.msdn.microsoft.com/windowsapps/File-access-sample-d723e597)。

# c++ - C++ std::vector 数组的编译器错误

> ID：12184828
> 
> 赞同：5
> 
> 时间：2012-08-29T19:02:39.263
> 
> 标签：c++, arrays, stdvector

以下代码无法使用 gcc 4.7.0 编译（使用 std=c++11 -O3）

```
int n;
std::vector< int[4] > A;
A.resize(n); 
```

错误消息是长度，但最终

```
functional cast to array type ‘_ValueType {aka int[4]}‘ 
```

它是否正确？还是应该编译？更重要的是，如何避免这个问题？（没有定义一个新的结构来保存`int[4]`）

编辑：

如何解决 C++98 的问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T19:16:44.247

您不能将数组存储在向量或任何其他容器中。要存储在容器中的元素的类型（称为容器的值类型）必须是可复制构造和可赋值的。数组都不是。

但是，您可以使用数组类模板，例如 Boost、TR1 和 C++0x 提供的模板：

```
std::vector<std::array<type, size> > 
```

（您需要将 std::array 替换为 std::tr1::array 以使用 C++ TR1 中包含的模板，或者将 boost::array 替换为[Boost 库](http://www.boost.org/doc/libs/1_45_0/boost/array.hpp)中的模板。或者，您可以自己编写；这很简单。）

[@来源](https://stackoverflow.com/questions/4612273/correct-way-to-work-with-vector-of-arrays)：詹姆斯麦克内利斯

所以代码看起来像：

```
int n;
std::vector<std::array<int,3>> A;
A.resize(n); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T19:09:18.373

> 没有定义一个新的结构来保存 int[4]

不可能的。您必须定义或找到一个结构 ( `std::array`, `std::tr1::array`, `boost::array`)。否则，此代码将永远无法编译。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T19:17:49.487

见 23.1/3：

> 这些组件中存储的对象类型必须满足 CopyConstructible 类型 (20.1.3) 的要求，以及 Assignable 类型的附加要求。

因此，在 C++03 中，`vector`要求包含的项目是可复制构造的，而 C 样式的数组则不是。错误消息是正确的，代码应该无法编译。只需在 C++11 中使用向量的向量、a`struct`来包装您的数组或向量。`std::array`

请注意，我相信可复制构造的限制在 C++11 中已在容器范围内解除，我不确定是否/如何将 C 样式的数组存储在一个数组中，或者是否更明确地禁止它。

# c - DOS中的“夏令时”

> ID：12184836
> 
> 赞同：2
> 
> 时间：2012-08-29T19:03:04.470
> 
> 标签：c, dos, ctime, watcom

我`time(NULL)`在 C 应用程序中使用该函数来获取自 1970 年以来的秒数。我注意到它返回的信息相差 1 小时。

然后我尝试使用 将结果转换为`tm`结构`localtime`，然后我注意到`tm_isdst`正在设置该字段。

代码是这样的：

```
time_t tempo;
struct tm sttime;

memset( &sttime, 0, sizeof( sttime ) );

tempo = time( NULL );  

printf( "%d\n", tempo );

sttime = *( localtime( &tempo ) );    
sttime.tm_isdst = 0;
tempo = mktime( &sttime );

printf( "%d\n", tempo ); 
```

首先`printf`，`tempo`以一小时的差异打印。第二，它正在打印正确的值。

我正在操作系统中运行该应用程序`Ms DOS 6.0`，并且该应用程序正在使用`Watcom v1.3`.

信息从何`Daylight Savings Time`而来？DOS 是否持有此信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:12:32.737

通过清除`sttime.tm_isdst`，您是在告诉`mktime`它比实际时间晚了一个小时（如果您在 DST 中，那么您似乎就是因为您说`sttime.tm_isdst`已设置）。

# c - 收缩 int 数组 C

> ID：12184837
> 
> 赞同：11
> 
> 时间：2012-08-29T19:03:10.590
> 
> 标签：c, arrays, trim, shrink

刚开始学习C，遇到以下问题：

我需要在 C 中缩小一个整数数组，最后删除元素。通过删除我的意思是释放。常见的答案是为较小的数组分配新内存，然后将原始数组的所有项（ -items to remove ）复制到新分配的内存中，然后 free() 原始数组。

因为我必须处理*非常*大的数组，所以我宁愿跳过复制部分。

是否可以创建一个指针变量，指向“接近原始数组的末尾”，大小为“数组末尾 - 接近末尾”，然后释放该指针？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T19:06:23.087

C 标准库中的[realloc](http://linux.die.net/man/3/realloc)函数可能是您想要的。

在您的情况下，它可能不会执行任何复制操作，因为内存管理器没有理由分配新的内存区域。只有新旧大小之间的差异*可能会*被系统回收为可用内存。

如果您使数组更大，则会发生复制，因为 malloc 和朋友不保证“当前”区域之后的内存实际上是空闲的。如果是，那么没关系，当前内存分配会被扩大。如果没有，则需要找到更大的可用内存区域，并且可以将其分配到内存中的几乎任何位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T19:11:16.723

你有没有想过使用`realloc`？

```
int main(void)
{
    int *array = NULL, *tmp;

    if(!(array = malloc(5 * sizeof(int)))) return 1;
    if(!(tmp = realloc(array, 2*sizeof(int)))) 
    {
        free(array);
        return 1;
    }
    array = tmp;
} 
```

您可以在没有`tmp`指针的情况下执行此操作，而只是拥有`array = realloc(array, 2*sizeof(int))))`，但这可能会导致以后出现问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:06:23.343

可以设计一个内存管理器来实现这一点，但没有一个常用的内存管理器具有此属性。您可以编写自己的 mm 并将其用于这些数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:06:37.673

我会使用[realloc](http://www.gnu.org/software/libc/manual/html_node/Changing-Block-Size.html)。Realloc 可能会复制内存，但这仍然比滚动您自己的内存管理来解决复制问题更有效。

有些人会告诉您，当结果大小较小时，不会复制任何表现良好的 C 库。他们可能是对的。但是，我不使用或编写商业 C 库，所以就我而言，这种说法是未经证实的。

# android - 寻找带有图像识别库的 AR

> ID：12184838
> 
> 赞同：6
> 
> 时间：2012-08-29T19:03:15.267
> 
> 标签：android, ios, mobile, augmented-reality

我正在做一个项目，我们必须在检测到玩具的脸后启动几个 AR 动画。有 36 个玩具模型，每个玩具都必须有特定的动画。

在其他类似的项目中，我们使用了常见的 AR 库，但我们从未遇到过图像识别问题。

你知道任何适合这种情况的图书馆吗？

在谷歌上搜索了很多之后，我发现了 qualcomm Vuforia，它看起来很有趣。您是否使用过它或听到过有关它的评论？

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T07:09:34.950

Qualcomm 是一个非常好的库，完全是最新的。我们已经使用它，并且结果很难与其他库一起改进。问题是它不是免费的。

如果您想要一个可以构建自己的 SDK 的免费库，那么 OpenCV 是您的选择。您拥有所需的所有功能。您将需要花一些时间来理解它和编码，但对于您的应用程序来说这很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T20:09:52.670

我会推荐[OpenCV](http://opencv.org/)。很棒的开源库，非常适合这样的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T21:32:29.313

我在以前的项目中使用过 Vuforia。它非常强大，但目标大小和跟踪稳定性是个问题（小目标有时不会触发，而且模型会跳来跳去，因为我们的目标很窄）。我们使用 Unity 插件，而不是 ios 本机，因为我们不想花时间编写 openGL。

它在 qualcomm 网站上有一个不错的社区，而且价格合适。它还没有提供一些更高级的 AR 功能（例如 pointcloud.io 或其他类似功能）。

# objective-c - 即使没有保存上下文，NSFetchedResultsController 委托也会触发

> ID：12184842
> 
> 赞同：2
> 
> 时间：2012-08-29T19:03:35.520
> 
> 标签：objective-c, core-data, nsfetchedresultscontroller

我有一个覆盖 validateForInsert 和 validateForUpdate 的 NSManagedObject 实体。

根据我编写的一些逻辑，当对象一致性出现问题时，此方法会正确返回 NO。

该应用程序是一个由 NSFetchedResultsController 支持的经典 uitableview，带有一个详细视图控制器。

当我添加一个新实体时，详细视图控制器使用 nil objectID 进行实例化，并推入导航堆栈。当我弹出细节控制器时，[context save:&error] 被调用，并且通过放置一些断点，我发现当我添加一个新实体时，获取的委托方法被触发一次，即使 validateForInsert 返回 NO，并且 includePendingChanges 设置为也没有。

当我再次尝试弹出详细信息控制器时，当然会再次调用保存，验证方法也是如此，但是这次 NSFetchedResultsControllerDelegate 没有被触发。

我想知道这是否是正常行为，或者我的模型中是否缺少某些内容。

[更新]

这是委托方法中断点后的堆栈跟踪：

```
#0  0x0003e5ba in -[MyTableViewController controller:didChangeObject:atIndexPath:forChangeType:newIndexPath:] at ......
#1  0x011512f9 in -[NSFetchedResultsController(PrivateMethods) _managedObjectContextDidChange:] ()
#2  0x00b46a29 in __57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke_0 ()
#3  0x01759855 in ___CFXNotificationPost_block_invoke_0 ()
#4  0x01759778 in _CFXNotificationPost ()
#5  0x00a8b19a in -[NSNotificationCenter postNotificationName:object:userInfo:] ()
#6  0x0106a673 in -[NSManagedObjectContext(_NSInternalNotificationHandling) _postObjectsDidChangeNotificationWithUserInfo:] ()
#7  0x01101f5e in -[NSManagedObjectContext(_NSInternalChangeProcessing) _createAndPostChangeNotification:withDeletions:withUpdates:withRefreshes:] ()
#8  0x01065ad3 in -[NSManagedObjectContext(_NSInternalChangeProcessing) _processRecentChanges:] ()
#9  0x0106916b in -[NSManagedObjectContext save:] ()
#10 0x00004490 in -[MyAppDelegate saveContext:] 
```

可以看出，即使在上下文中调用了 save，也没有调用 validate，因此这会使获取的控制器委托被触发。

[更新 2]

特别是，不知道它是否相关，这会导致controllerDidChangeObject中的异常（并非总是如此）：

> CoreData: error: Serious application error. An exception was caught from the delegate of NSFetchedResultsController during a call to -controllerDidChangeContent:. Invalid update: invalid number of rows in section 0\. The number of rows contained in an existing section after the update (4) must be equal to the number of rows contained in that section before the update (3), plus or minus the number of rows inserted or deleted from that section (0 inserted, 0 deleted) and plus or minus the number of rows moved into or out of that section (0 moved in, 0 moved out). with userInfo (null)

and infact in the origin table has three rows, just because the context bypass the validateFor methods when object is created in context seems that a row is inserted, there is inconsistency in rows number.

The controller delegate are quite simple and standard:

```
-(void)controllerWillChangeContent:(NSFetchedResultsController*)controller {
   [self.tableView beginUpdates];
}

- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type newIndexPath:(NSIndexPath *)newIndexPath {
   // for testing purpose I am not doing any modification
   return;
}

-(void)controllerDidChangeContent:(NSFetchedResultsController*)controller {
   [self.tableView endUpdates];
} 
```

Still I don't know who is updating the table view

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T12:42:04.280

I think this is normal behaviour; the fetched results controller doesn't require a save before it shows changes. If you don't want the changes made in your detail view to appear in the master before they're saved, you'll have to make a separate NSManagedObject context for the detail view. That way, only objects that are saved to the persistent store will make it back to the fetched results controller.

# c# - 为什么 Java 和 C# 为每个对象添加内部锁？

> ID：12184843
> 
> 赞同：17
> 
> 时间：2012-08-29T19:03:49.137
> 
> 标签：c#, java, synchronization, locking

使每个对象都可锁定看起来像是一个设计错误：

1.  您为创建的每个对象增加了额外的成本，即使您实际上只会在一小部分对象中使用它。
2.  锁的使用变得隐式，拥有`lockMap.get(key).lock()`比任意对象上的同步更具可读性，例如`synchronize (key) {...}`.
3.  同步方法可能会导致用户使用同步方法锁定对象的细微错误
4.  您可以确定，在将对象传递给 3rd parting API 时，它的锁没有被使用。

例如

```
class Syncer {
    synchronized void foo(){}
}
...
Syncer s = new Syncer();
synchronize(s) {
    ...
}
// in another thread
s.foo() // oops, waiting for previous section, deadlocks potential 
```

1.  更不用说每个对象的命名空间污染（在 C# 中至少方法是静态的，在 Java 中同步原语必须使用，而不是在...`await`中重载）`wait``Object`

但是我确信这种设计是有原因的。内在锁的最大好处是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-05-15T22:28:06.323

> 您为创建的每个对象增加了额外的成本，即使您实际上只会在一小部分对象中使用它。

这是由 JVM 实现决定的。[JVM 规范](https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5.monitorenter)说，“监视器与对象的关联可以通过各种超出本规范范围的方式进行管理。例如，监视器可以与对象同时分配和释放。或者，它可以在线程试图获得对对象的独占访问权时动态分配，并在稍后没有线程保留在对象的监视器中时释放。”

我还没有看过太多 JVM 源代码，但是如果任何常见的 JVM 处理这个效率低下，我会感到非常惊讶。

> 锁的使用变得隐含，lockMap.get(key).lock() 比任意对象上的同步更具可读性，例如 synchronize (key) {...}。

我完全不同意。一旦你知道 的含义`synchronize`，它就比一连串的方法调用更具可读性。

> 同步方法可能会导致用户使用同步方法锁定对象的细微错误

这就是为什么你需要知道 的含义`synchronize`。如果你阅读了它的作用，那么避免这些错误就变得相当微不足道了。经验法则：不要在多个地方使用同一个锁，除非这些地方需要共享同一个锁。任何语言的锁定/互斥策略都可以这样说。

> 您可以确定，在将对象传递给 3rd parting API 时，它的锁没有被使用。

正确的。这通常是一件好事。如果它被锁定，应该有一个很好的理由来锁定它。其他线程（第三方或非第三方）需要等待轮到它们。

如果您`myObject`为了允许其他线程同时使用而进行同步`myObject`，那么您做错了。如果有帮助，您可以轻松地同步相同的代码块`myOtherObject`。

> 更不用说每个对象的命名空间污染（在 C# 中至少方法是静态的，在 Java 同步原语中必须使用等待，而不是在 Object 中重载等待......）

该类`Object`确实包含一些与同步相关的便利方法，即`notify()`、`notifyAll()`和`wait()`。您不需要使用它们的事实并不意味着它们没有用。你可以很容易地抱怨`clone()`, `equals()`,`toString()`等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:08:24.120

实际上，您只能在每个对象中引用该监视器；只有当您使用同步时才会创建真正的监视器对象 => 不会丢失太多内存。

另一种方法是将手动监视器添加到您需要的那些类中；这会使代码非常复杂，并且更容易出错。Java 以性能换取生产力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:08:33.150

一个好处是在退出`synchronized`块时自动解锁，即使是例外。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:11:22.637

我假设像 toString() 一样，设计者认为好处大于成本。

必须做出很多决定，并且很多概念都未经测试（检查异常确认！），但总的来说，我确信它比显式的“锁定”对象更自由且更有用。

您还向语言或库添加“锁定”对象吗？似乎是一种语言结构，但库中的对象很少（如果有的话？）有特殊处理，但将线程更多地视为库结构可能会减慢速度。

# python - virtualenvs 应该在哪里创建？

> ID：12184846
> 
> 赞同：129
> 
> 时间：2012-08-29T19:04:00.277
> 
> 标签：python, virtualenv, virtualenvwrapper

我对应该将 virtualenvs 放在哪里感到困惑。

在我的第一个 django 项目中，我使用命令创建了项目

```
django-admin.py startproject djangoproject 
```

然后我进入 djangoproject 目录并运行命令

```
virtualenv env 
```

它创建了与内部目录相同级别的虚拟环境`djangoproject`目录。

这是为这个特定项目创建 virtualenv 的错误位置吗？

我得到的印象是，大多数人将他们所有的 virtualenvs 放在一个完全不同的目录中，例如`~/virtualenvs`，然后使用 virtualenvwrapper 在它们之间来回切换。

有没有正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-08-29T19:06:35.860

许多人使用[virtualenvwrapper](http://www.doughellmann.com/projects/virtualenvwrapper/)工具，它将所有 virtualenvs 保存在同一个地方（`~/.virtualenvs`目录），并允许创建和保存它们的快捷方式。例如，您可能会这样做：

```
mkvirtualenv djangoproject 
```

然后：

```
workon djangoproject 
```

将 virtualenv 目录保留在项目本身中可能是个坏主意，因为您不想分发它（它可能特定于您的计算机或操作系统）。[相反，使用pip](http://pypi.python.org/pypi/pip/)保留 requirements.txt 文件：

```
pip freeze > requirements.txt 
```

并分发它。这将允许使用您的项目的其他人将所有相同的要求重新安装到他们的 virtualenv 中：

```
pip install -r requirements.txt 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-05-08T14:46:21.273

**更改 virtualenv 目录的位置会破坏它**

这是将目录放在存储库树之外的一个优点，例如在`~/.virtualenvs`with下`virutalenvwrapper`。

否则，如果将其保留在项目树中，移动项目位置将破坏 virtualenv。

请参阅：[重命名 virtualenv 文件夹而不破坏它](https://stackoverflow.com/questions/6628476/renaming-a-virtualenv-folder-without-breaking-it)

有，`--relocatable`但众所周知它并不完美。

另一个小优势：您不必这样做`.gitignore`。

将 gitignored 放在项目树本身的好处是：

*   将相关的东西放在一起。
*   您可能永远不会跨项目重用给定的 virtualenv，因此将其放在其他地方并没有太大优势

在我看来，这是一个令人讨厌的设计缺陷。他们应该以一种与目录在哪里无关的方式实现virutalenv，因为在树中存储更简单、更孤立。Node.js 的 NPM 包管理器没有任何问题。当我们这样做时：pip 应该默认使用本地目录，就像 NPM 一样。拥有这个单独的 virtualenv 层是不稳定的。Node.js 只需 NPM 即可完成所有工作，无需额外输入。我不敢相信我在一篇 Python 帖子上赞美 JavaScript 生态系统，但这是真的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-29T19:06:42.367

普遍接受的放置它们的位置与默认安装的 virtualenvwrapper 放置它们的位置相同：`~/.virtualenvs`

相关：virtualenvwrapper 是一个优秀的工具，它为常见的 virtualenv 命令提供简写。[http://www.doughellmann.com/projects/virtualenvwrapper/](http://www.doughellmann.com/projects/virtualenvwrapper/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-13T10:16:20.220

如果您使用`pyenv install Python`，那么[pyenv-virtualenv](https://github.com/pyenv/pyenv-virtualenv)将是最佳实践。如果设置`.python-version`文件，它可以在您更改工作文件夹时自动激活或停用虚拟环境。`Pyenv-virtualenv`还将所有虚拟环境放入`$HOME/.pyenv/versions`文件夹中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-05-04T18:55:53.503

根据我的个人经验，我建议将所有虚拟环境组织在一个目录中。除非某人的记忆力非常敏锐并且可以记住分散在文件系统中的文件/文件夹。不喜欢使用其他工具来管理虚拟环境。在 VSCode 中，如果我 configure( `python.venvPath`) 目录包含所有虚拟环境，它可以自动识别所有虚拟环境。

# javascript - inDesign 脚本“对象无效”

> ID：12184848
> 
> 赞同：2
> 
> 时间：2012-08-29T19:04:13.753
> 
> 标签：javascript, adobe-indesign

我正在尝试以一种方式为表格的第一行设置高度和插图，然后将所有后续行设置为另一组值。

我在运行它时收到一条 JavaScript 错误消息：

```
Error Number:45
Error String: Object is invalid

Engine: main
File: C:\...
Line: 49
Source: app.activeDocument.stories.everyItem().tables.everyItem().rows[x].height = ".12 in"; 
```

不知道从这里去哪里？这是我当前脚本[http://pastebin.com/iUXgPZSM的 pastebin](http://pastebin.com/iUXgPZSM)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T13:52:36.990

该`everyItem()`方法并不总是适用于每种情况。在这种情况下，它不起作用，因为您正在设置一个属性，例如。`height = ".12 in"`. 如果您首先*使用*元素`getElements()`然后循环它们，它将起作用。

另外，请注意，您不能使行的高度小于文本大小。InDesign 就是不会这样做。在我提供的示例中，我使用`1 in`了因为它`.12 in`似乎小于默认文本大小。

最后，我查看了您的 pastebin 脚本，您可能可以通过使用变量而不是函数链来稍微清理一下它。它可能会占用更多的“垂直空间”，但最终对其他人来说更具可读性。

```
var doc = app.activeDocument;

var everyStory = doc.stories.everyItem();
var everyTable = everyStory.tables.everyItem();
var allRows = everyTable.rows.everyItem().getElements();

for (var i=1, l=allRows.length; i < l; i++) {
   var row = allRows[i];
   row.height = "1 in";
}; 
```

# php - 用于结束屏幕的 Youtube preg_match

> ID：12184853
> 
> 赞同：0
> 
> 时间：2012-08-29T19:04:46.200
> 
> 标签：php

我一直试图让 PHP`preg_match`与`feature=endscreen`youtube URL 一起工作，但没有成功。有什么建议么。

```
(preg_match('%(?:youtube(?:-nocookie)?\.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu\.be/)([^"&?/ ]{11})%i', $url, $match)) 
```

示例输入 = [http://www.youtube.com/watch?feature=endscreen&NR=1&v=uOHvZjiDANg](http://www.youtube.com/watch?feature=endscreen&NR=1&v=uOHvZjiDANg) 所需输出 = uOHvZjiDANg

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:37:31.200

这是我测试过的代码试试

```
<?php

function parse_yturl($url) 
{
    $pattern = '#^(?:https?://)?';    # Optional URL scheme. Either http or https.
    $pattern .= '(?:www\.)?';         #  Optional www subdomain.
    $pattern .= '(?:';                #  Group host alternatives:
    $pattern .=   'youtu\.be/';       #    Either youtu.be,
    $pattern .=   '|youtube\.com';    #    or youtube.com
    $pattern .=   '(?:';              #    Group path alternatives:
    $pattern .=     '/embed/';        #      Either /embed/,
    $pattern .=     '|/v/';           #      or /v/,
    $pattern .=     '|/watch\?v=';    #      or /watch?v=,    
    $pattern .=     '|/watch\?.+&v='; #      or /watch?other_param&v=
    $pattern .=   ')';                #    End path alternatives.
    $pattern .= ')';                  #  End host alternatives.
    $pattern .= '([\w-]{11})';        # 11 characters (Length of Youtube video ids).
    $pattern .= '(?:.+)?$#x';         # Optional other ending URL parameters.
    preg_match($pattern, $url, $matches);
    return (isset($matches[1])) ? $matches[1] : false;
}

echo parse_yturl('http://www.youtube.com/watch?feature=endscreen&NR=1&v=uOHvZjiDANg');

?> 
```

输出 = uOHvZjiDANG

来源：[https ://github.com/eyecatchup/php-yt_downloader/blob/master/youtube-dl.class.php#L406](https://github.com/eyecatchup/php-yt_downloader/blob/master/youtube-dl.class.php#L406)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:42:49.227

我建议不要尝试复杂的正则表达式：

1.  [使用parse_url 函数](http://php.net/manual/en/function.parse-url.php)解析 URL并提取查询字符串。
2.  从上述步骤中获取查询字符串并调用[parse_str 函数](http://www.php.net/manual/en/function.parse-str.php)将单独的查询参数转换为变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:34:40.417

尝试这个：

```
if(preg_match('/youtube\.com\/(v\/|watch\?v=)([\w\-]+)/', $url, $match)){; $vid=$match[2]; 
}
print "$vid"; 
```

# unix - Rsync 性能 - 同步单个大文件与同步多个小文件

> ID：12184855
> 
> 赞同：0
> 
> 时间：2012-08-29T19:04:56.560
> 
> 标签：unix, rsync, bigdata, file-copying

我正在使用 rsync 同步许多小文件（每个 4.5 MB）。我正在使用 18000 的 bwlimit。我将执行批量 rsync 命令，这样，

rsync -v dest_host:file1 dest_host:file2 dest_host:file3 dest_host:file4 dest_host:file5 ... src_dir。

但我观察到的是，在上述带宽下，我每分钟无法同步超过 4 个文件。这些是预期的吗？我想知道如果我同步一个 18 MB 的大文件，我可以更快地同步吗？

对于我的上述用例，是否有任何实用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-25T23:23:47.040

我设法回答了我自己的问题。

同步多个小文件会产生开销，例如在源和目标创建、打开、关闭文件。

当我们传输 100 个大小为 5 MB 的文件和一个大小为 500M MB 的文件时，这将非常重要。

因此，结论是，是的，同步单个大文件是有益的。

# java - 当字符串包含 [] 个字符时替换字符串中的子字符串

> ID：12184857
> 
> 赞同：3
> 
> 时间：2012-08-29T19:05:03.397
> 
> 标签：java

我想替换 substringin 字符串。例如：

```
localStringBuilder is for example "[sender] is xxxx xxxx xxx". 
```

当我跑步时

```
localStringBuilder.toString().replaceAll("[sender]", callerName); 
```

无法正常工作。问题在于`[]`字符。如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T19:06:19.433

只需使用`replace`代替`replaceAll`

`replaceAll`将 REGEX 作为输入，不是字符串，而是正则表达式。`[]`是用于对表达式进行分组的正则表达式的重要部分。

`localStringBuilder.toString().replace("[sender]", callerName);`将按照您的预期工作，因为它将普通字符串作为两个参数。

`is the same. Works when is no [] characters in string`– @mbrc 1 分钟前

不是真的，我已经**测试过**了：

```
public static void main(String[] args) {
    String s = "asd[something]123";
    String replace = s.replace("[something]", "new1");
    System.out.println(replace);
} 
```

**输出：asdnew1123**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:07:02.610

replaceAll 返回一个带有替换的新字符串。它不会替换原始字符串中的字符。

> String newString = localStringBuilder.toString().replaceAll("[sender]", callerName);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:07:39.167

用这个

```
 localStringBuilder.toString().replaceAll("\\[sender\\]", callerName); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:08:14.750

**这有效：**

```
locaStringBuilder.toString().replaceAll("\\[sender\\]", callerName); 
```

# html-lists - JQTouch - li 中的链接在滚动后不起作用

> ID：12184859
> 
> 赞同：0
> 
> 时间：2012-08-29T19:05:16.903
> 
> 标签：html-lists, jqtouch

我有一个使用 JQTouch 的排序列表。该列表包含大约 20 个包含不同链接的 li 元素。屏幕上没有滚动的第一个 li 工作得很好。但是当我在我的 iPhone 上向下滚动后，链接不再起作用。

这是代码片段：

```
<ul class="rounded">
<li class="arrow"><a id="1" href="#opdracht">1\. Typical Amsterdam</a></li>
<li class="arrow"><a id="2" href="#opdracht">2\. Route</a></li>
<li class="arrow"><a id="3" href="#opdracht">3\. Directions</a></li>
<li class="arrow"><a id="4" href="#opdracht">4\. Shops</a></li>
---
<li class="arrow"><a id="5" href="#opdracht">9\. Sightseeing</a></li>
<li class="arrow"><a id="6" href="#opdracht">10\. Contact</a></li>
</ul> 
```

我真的不知道我做错了什么。我希望有人可以帮助我。

例如，请在您的 iPhone 上访问：[http](http://www.wappdesign.nl/teamuitje) ://www.wappdesign.nl/teamuitje ，并在滚动后尝试访问该链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T06:23:32.110

在`jqtouch.min.js`文件中

在“handleTouch”功能中有：

```
startX = event.changedTouches[0].clientX,
startY = event.changedTouches[0].clientY, 
```

这些行需要更改为：

```
startX = event.changedTouches[0].pageX,
startY = event.changedTouches[0].pageY, 
```

请参考此链接 [https://github.com/senchalabs/jQTouch/issues/297](https://github.com/senchalabs/jQTouch/issues/297)

# iphone - 并排安装 xcode 4.4 和 xcode 4.5？

> ID：12184860
> 
> 赞同：5
> 
> 时间：2012-08-29T19:05:19.467
> 
> 标签：iphone, ios, xcode, ipad

这甚至可能吗？我似乎无法在互联网上找到任何关于此的资源。我一直在看到有关将它并排安装的线程..但不确定这是否有效

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T19:06:41.503

是的你可以。XCode 4.5 DP Preview 是一个独立的应用程序，它不能替代实际的 XCode (4.4)。

我昨天刚刚安装了它，它们一起工作得很好！

当然，如果你想用 iOS 6 模拟器测试应用程序，你必须打开 XCode 4.5，否则，用 XCode 4.4

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T19:08:09.357

是的，当然可以。我使用 Xcode 4.5 DP 因为 Xcode 4.4 的 ios 模拟器在 twitter 上有问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T15:21:01.540

是的，正如文档所暗示的那样。

[http://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/WhatsNewXcode/00-Introduction/Introduction.html#//apple_ref/doc/uid/TP40004635-SW1](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/WhatsNewXcode/00-Introduction/Introduction.html#//apple_ref/doc/uid/TP40004635-SW1)

> **Xcode 4.5 可以与以前版本的 Xcode 在 Mac 上共存。**

在**安装**部分

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:34:25.727

Xcode 已移至独立应用程序模型。这允许您在系统上并行运行这两个应用程序，几乎没有冲突。

话虽如此，我注意到此设置中存在一些问题。他们可能会或可能不会破坏交易，但需要注意。

*   当运行 4.5 Beta 模拟器并切换回 4.4（5.1 模拟器）时，它会崩溃或挂起您的模拟器（6.0）。来回切换时请务必关闭iOS模拟器，因为它们不能并排运行并且是单独的应用程序。
*   请注意不要使用 4.4 中不可用的任何 API/方法/文字。我认为大多数事情都是安全的，但是如果您在两种环境中测试应用程序，则需要注意一些事情。

在大多数情况下，并排运行时一切都很好。它没有做太多的宣传，但这可能是因为大多数测试版的东西都在 NDA 之下并且没有得到太多讨论。我没有看到讨论并排设置的危害。祝你好运。

# php - Zend 插件在 godaddy 主机帐户中不起作用

> ID：12184864
> 
> 赞同：0
> 
> 时间：2012-08-29T19:05:48.557
> 
> 标签：php, zend-framework

我创建了一个基于 Zend 的应用程序，它在我的本地主机（我的计算机）上运行，但它没有在我的共享主机帐户上运行。

普通应用程序（没有任何 Zend 插件）在我的帐户上运行良好，但是当我尝试在 applicaton.ini 文件中注册 Zend 插件时，我得到 500（内部服务器错误）

```
autoloaderNamespaces[] = "Addons"
resources.frontController.plugins.HeaderFormat = "Addons_HeaderFormat"
resources.frontController.plugins.ArchiveTagMenu = "Addons_ArchiveTagMenu" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T11:45:56.350

配置您的浏览器以查看详细错误而不是错误 500。然后您将知道问题出在哪里并尝试修复它。

# ios - UIScrollView 滚动时导航和工具栏不隐藏

> ID：12184865
> 
> 赞同：0
> 
> 时间：2012-08-29T19:05:50.107
> 
> 标签：ios, xcode, uiscrollview, contentoffset

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    lastOffset = scrollView.contentOffset;

    if (scrollView.contentOffset.y < lastOffset.y) {
        [self.navigationController setNavigationBarHidden:YES animated:YES];
        [self.navigationController setToolbarHidden:YES animated:YES];
    }
    else {
        [self.navigationController setNavigationBarHidden:NO animated:YES];
        [self.navigationController setToolbarHidden:NO animated:YES];
    }
} 
```

我究竟做错了什么？UIScrollViewDelegate 已在我的头文件中设置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T19:11:36.070

你应该搬家

```
lastOffset = scrollView.contentOffset; 
```

到方法结束，否则

```
scrollView.contentOffset.y < lastOffset.y 
```

永远不会是真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:14:02.623

它不是隐藏的，因为每次调用*else*部分中的代码。假设 contentOffset = (100, 100) 那么你将最后一个偏移量设置为等于 contentOffset 所以`if (scrollView.contentOffset.y < lastOffset.y)`它永远不会是真的。放在`lastOffset = scrollView.contentOffset;`scrollViewDidScroll方法的最后。

# android - 在android中打开任何文件-Phonegap

> ID：12184872
> 
> 赞同：2
> 
> 时间：2012-08-29T19:06:23.727
> 
> 标签：android, cordova

我想知道如果Android有正确的应用程序是否可以打开任何类型的文件......

就像我下载了一个 PSD 文件，用户有 Photoshop 阅读器并在那里打开它。

就像 iOS 中的“打开方式”一样？

还是我需要自己做？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:30:37.230

从根本上说，您需要做的就是`ACTION_VIEW`在该文件上触发 Intent 并让系统决定如何处理它。如果用户有更多的应用程序来处理某种文件类型（即多个 PDF 查看器），他将被询问使用哪一个。您只需要注意`catch`例外情况，以防没有该类型的应用程序（否则您的应用程序将崩溃）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T20:43:10.650

使用 WebIntent 插件启动视图应用程序。

[https://github.com/phonegap/phonegap-plugins/tree/master/Android/WebIntent/](https://github.com/phonegap/phonegap-plugins/tree/master/Android/WebIntent/)

# json - WCF 通过 Web 浏览器使用服务

> ID：12184897
> 
> 赞同：0
> 
> 时间：2012-08-29T19:08:05.700
> 
> 标签：json, wcf, service, web

我正在尝试使用网络浏览器来测试我所做的新服务，但没有运气。每当我点击 URL 时，它就会出现空白。这是我的配置，任何人都可以看到我的任何错误吗？

```
<?xml version="1.0"?>
<configuration>

  <connectionStrings>
    <add name="APerson"
         connectionString="data source=|DataDirectory|Database.sdf"
         providerName="System.Data.SqlServerCe.4.0"/>
  </connectionStrings>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="HighTech_API_Service" behaviorConfiguration="ServiceDebug">
        <endpoint
              behaviorConfiguration="web"
              address="http://localhost:54107/jsonservice"
              binding="webHttpBinding"
              contract="Some_API_Service.IJsonService" />
        <endpoint
           address="mex"
           binding="mexHttpBinding"
           contract="IMetadataExchange" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceDebug">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug httpHelpPageEnabled="true" includeExceptionDetailInFaults="true" />
        </behavior>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="web">
          <webHttp/>
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="false" />
  </system.serviceModel>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

</configuration> 
```

使用 WCF 测试客户端可以很好地操作我的服务，但我需要通过 URL 来完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T14:23:50.673

为了让它工作，我只是设置了 IIS 来托管服务......

# matlab - 如何在matlab中将行读入单元格数组

> ID：12184905
> 
> 赞同：4
> 
> 时间：2012-08-29T19:08:42.030
> 
> 标签：matlab, file-io

我想在 matlab 上将常规文本文件读入单元格数组。我怎样才能做到这一点 ？

我不想要任何格式。读作文字。

谢谢你。

它将是基于行的数组，如 100x1

```
example of reading : dd = {1;2;3} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-29T19:28:59.197

使用`textscan`, 所以每行有一个单元格元素：

```
fid = fopen('myFile.ext');
allData = textscan(fid,'%s','Delimiter','\n');

% allData{1} is a nLines-by-1 cell array with the lines of the file as text 
```

# android - layout_gravity 不起作用

> ID：12184907
> 
> 赞同：11
> 
> 时间：2012-08-29T19:08:57.207
> 
> 标签：android, layout, layout-gravity

为什么我的`TextView`不正确？

**更新：**嗯，现在我不只是需要设置`TextView`到右边。现在非常有趣的是为什么`layout_gravity`不能按预期工作，即 - 将其设置`View`为父容器内的位置。

![在此处输入图像描述](../Images/47d59c518aec3eb4ff6e533ece4a6557.png)

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="match_parent"
              android:layout_height="wrap_content"
              android:minHeight="?android:attr/listPreferredItemHeight"
              style="@style/activated_item"
              android:orientation="horizontal">

    <CheckBox
        android:id="@+id/star"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_marginLeft="8dp"
        style="?android:attr/starStyle"/>

    <TextView
        android:id="@+id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:layout_marginLeft="8dp"
        android:layout_gravity="right" //////// HERE I AM 
        android:textStyle="bold"
        android:textColor="@color/item_text_color"/>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-29T19:10:23.323

尝试使用[`gravity`](http://developer.android.com/intl/es/reference/android/widget/TextView.html#attr_android:gravity)而不是`layout_gravity`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-09-16T16:13:19.493

因为您设置`orientation`为水平，这意味着您无法手动更改子视图的水平位置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-25T18:24:29.147

我找到了两个解决方案：

1.  设置`android:orientation="vertical"`。
2.  使用`FrameLayout`而不是`LinearLayout`作为文本/复选框小部件的父级。这不是主要用法，`FrameLayout`但 Android 文档中也提到了该建议：

    > ...但是，您可以使用 android:layout_gravity 属性将多个子项添加到 FrameLayout 并通过为每个子项分配重力来控制它们在 FrameLayout 中的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:25:43.483

试试这个...

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent"
          android:layout_height="wrap_content"
          android:minHeight="?android:attr/listPreferredItemHeight"
          style="@style/activated_item"
          android:orientation="horizontal">

<CheckBox
    android:id="@+id/star"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginLeft="8dp"
    style="?android:attr/starStyle"/>

<TextView
    android:id="@+id/title"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textAppearance="?android:attr/textAppearanceMedium"
    android:layout_marginLeft="40dp"
    android:gravity="right" //////// HERE I AM 
    android:textStyle="bold"
    android:textColor="@color/item_text_color"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T19:33:07.443

你可以用重量也试试这个

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:minHeight="?android:attr/listPreferredItemHeight"
android:orientation="horizontal" >

<CheckBox
    android:id="@+id/star"
    style="?android:attr/starStyle"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginLeft="8dp"
    android:layout_weight="1" />

<TextView
    android:id="@+id/title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_marginLeft="8dp"
    android:text="TEST"
    android:textAppearance="?android:attr/textAppearanceMedium"
    android:textStyle="bold" />

</LinearLayout> 
```

重力只是使文本居中，使它正确的是重量

# ruby-on-rails - Coda Terminal 找不到铁轨

> ID：12184908
> 
> 赞同：0
> 
> 时间：2012-08-29T19:09:17.537
> 
> 标签：ruby-on-rails, terminal, coda

我已经使用 rvm 安装了 rails，并且使用 zsh 在开箱即用的终端中一切正常。我想我会简化一些事情并带出 Coda 的终端，但由于某种原因，当我运行时 `$ rails --version` 我收到错误消息说缺少依赖项或使用`$ rails new new_app`Coda 终端时告诉我没有安装 rails。运行`$ gem list`并`$ gem environment`在两个终端中给我相同的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:13:25.737

你需要在使用它之前加载 rvm 加载 rvm 脚本

```
 source ~/.rvm/bin/rvm 
```

# python - Python：模拟我正在测试的模块正在使用的模块

> ID：12184911
> 
> 赞同：2
> 
> 时间：2012-08-29T19:09:38.433
> 
> 标签：python, unit-testing, mocking

我想模拟某个模块以测试使用该模块的一段代码。

也就是说，我有一个`my_module`要测试的模块。`my_module`导入一个外部模块`real_thing`并调用`real_thing.compute_something()`：

```
#my_module
import real_thing
def my_function():
    return real_thing.compute_something() 
```

我需要模拟`real_thing`，以便在测试中它的行为类似于`fake_thing`我创建的模块：

```
#fake_thing
def compute_something():
    return fake_value 
```

测试调用`my_module.my_function()`which 调用`real_thing.compute_something()`：

```
#test_my_module
import my_module
def test_my_function():
    assert_something(my_module.my_function()) 
```

我应该在测试代码中添加什么以便在测试中`my_function()`调用`fake_thing.compute_something()`而不是`real_thing.compute_something()`？

我试图弄清楚如何使用[Mock](http://www.voidspace.org.uk/python/mock/index.html)做到这一点，但我没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:29:20.637

简单地说没有？破解 sys.modules

```
#fake_thing.py
def compute_something():
    return 'fake_value'

#real_thing.py
def compute_something():
    return 'real_value'

#my_module.py
import real_thing
def my_function():
    return real_thing.compute_something()

#test_my_module.py
import sys

def test_my_function():
    import fake_thing
    sys.modules['real_thing'] = fake_thing
    import my_module
    print my_module.my_function()

test_my_function() 
```

输出：'fake_value'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:13:36.633

[http://code.google.com/p/mockito-python/](http://code.google.com/p/mockito-python/)

```
>>> from mockito import *
>>> dog = mock()
>>> when(dog).bark().thenReturn("wuff")
>>> dog.bark()
'wuff' 
```

[http://technogeek.org/python-module.html](http://technogeek.org/python-module.html) - 如何替换，动态加载模块

# oop - 您将如何抽象此功能？

> ID：12184913
> 
> 赞同：2
> 
> 时间：2012-08-29T19:09:48.467
> 
> 标签：oop, design-patterns

观察以下类及其包含：

`Section`有一个`ItemList`有很多`Item`s

但是让我们说一个`Item`基于一些复杂的算法被渲染为不同的颜色，该算法基于`Section.name`它所包含的。

抽象此功能的正确/最佳方法是什么？在这样的情况下是否存在常见的设计模式？还是固有的设计有缺陷？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:17:39.633

您应该将数据结构/模型与逻辑和处理分开。也就是说，我会让你的 Item 有一个`Section`引用 it's 的引用`Section`，当你将 an 添加`Item`到 时`ItemList`，确保 add 方法查看`ItemList`s `Section`（父级）并将引用设置在`Item`. 中的设置器也是如此`ItemList`，`Section`它必须迭代每个`Item`并设置`Section`.

或者，您可以在惰性语义`Section`的 getter 上进行设置`ItemList`，这完全取决于您的使用情况`Section`，这两种方法之间的性能统计信息会有所不同。

此外，我会编写某种形式的渲染器，它采用`Item`并知道如何渲染它，它会查看`Section`on the`Item`和 the `Name`on that `Section`。

您可能想要渲染整个部分，但我会单独编写该渲染器，它会使用`ItemRenderer`来渲染每个`Item`.

顺便说一句，您可能希望使用一种形式`IObservableCollection`并拥有该`Item`工具`INotifyPropertyChanged`，以便您可以保持渲染版本和项目之间的同步，并通过更新属性的事件注册`Item`与`Section`它存在的同步`Section`适当地。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:17:44.380

渲染是做什么的？如果它在`Section`所有这些中或之外，但是从 s 访问`Item`s `Section`，那么就不需要更多了。

如果它在 中`Item`，那么您只需要确保`Item`知道`Section`它属于什么，或者可以获得它（例如，通过拥有一个它可以查找的 ID - 对于那些使处理循环引用变得棘手的语言很有用，但在其他方面没有不必要的麻烦） .

由于第一种情况不会造成任何困难，显然它优于第二种情况，因此最接近设计模式的是，如果您发现自己在包含的项目中进行此类工作，请尝试将其移动到容器中，或在它们之外。除此之外，没有太多需要解决的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:19:38.450

我会构建一个`ItemRenderer`知道算法的类，并将引用传递给`Item`您想要渲染的每个以及`Section`它包含在其中的引用。

让每个人都`Item`知道它所属的部分可能也很有意义，但我仍然会让`ItemRenderer`处理渲染。

# python - 在 django 查询中连接过滤器

> ID：12184914
> 
> 赞同：2
> 
> 时间：2012-08-29T19:09:55.187
> 
> 标签：python, django

我想做以下事情：

假设我有：

```
query_terms = ["A", "B"] 
```

需要的是以下查询：

```
House.objects.filter(
    Q(name__icontains="A") | Q(building__name__icontains="A",
    Q(name__icontains="B") | Q(building__name__icontains="B"
) 
```

我不知道如何将这个“OR”语句与具有动态 query_terms 列表的“AND”一起加入

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T19:14:18.890

```
full_query = None
for query in query_terms:
    q = Q(name__icontains=query) | Q(building__name__icontains=query)
    if full_query is None:
        full_query = q
    else:
        full_query = full_query & q 
```

我可能没有完全正确地优化这个，但是沿着这些思路应该可以工作。

# javascript - Javascript 数组和对象/类

> ID：12184915
> 
> 赞同：0
> 
> 时间：2012-08-29T19:09:59.013
> 
> 标签：javascript, arrays, class, object

我试图在屏幕上显示三张扑克牌，出于某种原因，每次我运行代码时都会出现类型错误，我已经尝试了一切尝试修复它，但没有任何效果。我认为问题出在数组/对象构造函数中，但我认为一切都在其中。

```
"use strict";

function main(){
var cvs = document.getElementById("foo");
var ctx = foo.getContext("2d");
function Card(posX, posY, imgX, imgY){
    this.posX = posX;
    this.posY = posY;
    this.imgX = imgX;
    this.imgY = imgY;
    this.width = 97;
    this.height = 129;
}
Card.img = new Image();
Card.img.src = "allcards.png";
var cards = [new Card(0,0,0,0), new Card(400,400,194,258), new Card(200,200,291,387)];
var greaterX = false;
var lessX = false;
var greaterY = false;
var lessY = false;
var offsetX;
var offsetY;
setInterval(draw, 10);

function draw(){
    ctx.fillStyle="rgb(0,255,255)";
    ctx.clearRect(0,0,600,600);
    ctx.drawImage(Card.img,cards[1].imgX,cards[1].imgY,Card.width,Card.height,cards[1].posX, cards[1].posY);
    ctx.drawImage(Card.img,cards[2].imgX,cards[2].imgY,Card.width,Card.height,cards[2].posX, cards[2].posY);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:52:40.633

您似乎将`Card`函数对象的静态属性与 Card 实例的静态属性混淆了 -`width`和`height`属性是实例属性。

```
var cvs = document.getElementById("foo");
var ctx = cvs.getContext("2d");

function Card(posX, posY, imgX, imgY){
    this.posX = posX;
    this.posY = posY;
    this.imgX = imgX;
    this.imgY = imgY;
}
// default values/methods, accessible and overwritable on all instances:
Card.prototype.width = 97;
Card.prototype.height = 129;
Card.prototype.draw = function() {
    ctx.drawImage(Card.img, this.imgX, this.imgY, this.width, this.height, this.posX, this.posY);
};

// static property:
Card.img = new Image();
Card.img.src = "allcards.png";
Card.img.onload = draw;

var cards = [new Card(0,0,0,0), new Card(400,400,194,258), new Card(200,200,291,387)];

function draw(){
    ctx.fillStyle="rgb(0,255,255)";
    ctx.clearRect(0,0,600,600);
    for (var i=0; i<2; i++)
        cards[i].draw();
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:21:26.487

var ctx = foo.getContext("2d");

这不应该是

var ctx = cvs.getContext("2d");

# android - 钛未捕获的错误：没有这样的表

> ID：12184917
> 
> 赞同：0
> 
> 时间：2012-08-29T19:10:05.970
> 
> 标签：android, ios, titanium

我正在使用钛合金并针对 android 模拟器进行测试 - 但也欢迎任何与 iOs 相关的建议！

我正在尝试将钛与数据库一起使用。我正在使用 firefox sql lite 插件来制作我的数据库 - 所以我制作了它，然后我去了

```
database > export database > to a location in my titanium app project that is under "Resources" folder 
```

好的，整洁。

然后我有这个代码：

```
var db = Ti.Database.install('/db/wibbler.sql','wibbler');

function getLanguages(){
var sql = 'select * from language order by name desc';

var results = [];

var resultSet = db.execute(sql);

while (resultSet.isValidRow()){
    results.push({
        name: resultSet.fieldByName('name'),
        id: resultSet.fieldByName('id'),
        desctiption: resultSet.fieldByName('description')
    });
    reultSet.next();
}
resultSet.close();
return results;
} 
```

如您所见，文件的位置是

```
Resources/db 
```

数据库文件名为“wibbler.sql”

问题是，当我运行我的应用程序时，它抱怨我正在使用的 sql 引用了一个不存在的表 - 即：

未捕获的错误：没有这样的表

什么是交易？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T21:01:58.167

首次运行`var db = Ti.Database.install('/db/wibbler.sql','wibbler');`时，数据库文件`Resources/db/wibbler.sql`将安装在私人文档 (iOS) 或内部或外部存储 (Android) 中。db 的这个新副本是您的 var db 将指向的位置。 [文档](http://docs.appcelerator.com/titanium/2.1/index.html#!/guide/Working_with_a_SQLite_Database-section-29004901_WorkingwithaSQLiteDatabase-CreatingandInstallingDatabases)。

当您第二次运行该应用程序时，由于数据库已经安装，它只会打开该副本。因此，如果您运行该应用程序，然后在 下的数据库文件中添加一个表，则`References`该新表将不会反映在 db.xml 的副本中。

要解决此问题，您可以执行以下操作之一：

*   从模拟器/模拟器中删除应用程序，以便在重新安装应用程序时复制更新的数据库文件
*   将安装命令中的数据库名称更改为类似`'wibbler2'`
*   直接在[模拟器](https://stackoverflow.com/questions/4644158/how-to-view-the-data-in-sqlite-fle-running-in-iphone-application/4644189#4644189)或[模拟器上访问和编辑数据库副本](https://stackoverflow.com/questions/1510840/where-does-android-emulator-store-sqlite-database)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T14:03:51.587

好的，所以答案有点混杂——亚当建议的一些东西，以及我没有意识到的其他一些东西

首先：我的文件只是一个导出的 sqllite 数据库。这是不对的 - 该文件应该是实际的数据库文件（所以，你知道，firefox 创建的数据库的“位置”应该位于 Resources 文件夹中的某个位置，并且 Titan 应该指向那个）。

本教程澄清了这一点：http: [//blogs.usask.ca/the_bolt/archive/2010/12/titanium_tutorial_database.html](http://blogs.usask.ca/the_bolt/archive/2010/12/titanium_tutorial_database.html)

如教程中所述，它已过时 - 但我只需要知道我在钛代码中使用了错误的文件。

接下来，正如亚当所提到的，android 将继续使用旧的数据库——你每次都可以清理它，但这很麻烦。试试这个：

```
var db = Ti.Database.open('wibbler');
db.remove();
db = Ti.Database.install('/db/wibbler.sqlite','wibbler'); 
```

找到数据库，杀死它，然后重新安装它。另请注意，我现在指向的是 sqlite 文件，而不是 sql 文件。

万岁！

# asp.net-mvc - 同时使用主机名和 IIS 托管 ASP.NET Web API

> ID：12184918
> 
> 赞同：0
> 
> 时间：2012-08-29T19:10:08.613
> 
> 标签：asp.net-mvc, iis-7, asp.net-web-api

我正在尝试与 IIS 一起托管 Web API 自托管应用程序。

我的 Web API 项目正在运行`subdomain1.domain.com`。我的 IIS 有一个站点配置在`subdomain2.domain.com`.

一旦我的 Web API 应用程序启动，它就会接管 80 端口上的所有内容并对其做出响应——无论主机名是什么。是否可以将这些并排运行到站点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:19:19.167

`HttpSelfHostConfiguration`您可以在构造函数中设置端口。有关示例，请参见此处的代码：http: [//www.matlus.com/self-host-asp-net-web-api/](http://www.matlus.com/self-host-asp-net-web-api/)

*编辑以指定评论的进一步答案：`selfHostconfiguration.HostNameComparisonMode = HostNameComparisonMode.Exact;`将允许在同一端口上运行站点。

# html - 在超链接列表块导航中对齐文本

> ID：12184922
> 
> 赞同：0
> 
> 时间：2012-08-29T19:10:13.157
> 
> 标签：html, css

[http://cssdesk.com/sv2Wq](http://cssdesk.com/sv2Wq)

我正在尝试垂直对齐相应的文本`<li>`。我构建它的方式似乎不太可能，因为盒子本身就是链接。

这是做一个简单导航栏的标准方法，对吧？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
<html>
<head>
<link rel="stylesheet" type="text/css" href="style.css" />
<title>
</title>
</head>
<body>
<div id="wrapper">
<div id="navbar">
<ul>
<li><a href="home.php">Home</a></li>
<li><a href="news.php">News</a></li>
<li><a href="roster.php">Roster</a></li>
<li><a href="forums.php">Forums</a></li>
<li><a href="contact.php">Contact</a></li>
</ul> 
</div>
</div>
</body>
</html> 
```

--

```
body, div, dl, dt, dd, ul, ol, h1, h2, h3, h4, h5, h6, pre, form, fieldset, input,textarea, p, blockquote, th, td {
margin: 0;
padding: 0;
}

body {
background-image:url("images/gradients/background_gradient.png");
}

#wrapper {
margin: auto;
min-height: 1152px;
width: 1536px;
}

#navbar {
border: 1px solid red;
height: 200px;
width: 100%;
font-size: 2em;
margin: 0;
}

#navbar a {
text-decoration: none;
}

#navbar ul {
display: block;
list-style-type: none;
}

#navbar ul li a {
float: left;
display: block;
height: 200px;
width: 20%;
text-align: center;
letter-spacing: -0.5px;
}

#navbar ul li :hover{
background-color: white;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:12:24.557

这是可能的 - 只需添加`line-height`

```
#navbar ul li a {
    display: block;
    float: left;
    height: 200px;
    letter-spacing: -0.5px;
    line-height: 200px; /* this */
    text-align: center;
    width: 20%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:13:04.163

将锚点的行高设置为与列表元素的高度相同的值。

编辑：太慢了:)

哦，顺便说一句：只要您的链接在一行上，它就可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:15:01.657

使用它在 html 框中垂直居中。对我来说很棒。确保它在链接css中。

```
display:table-cell;
vertical-align:middle; 
```

这是在css中...

```
#navbar ul li a {
float: left;
height: 200px;
width: 20%;
text-align: center;
letter-spacing: -0.5px;
    display:table-cell;
    vertical-align:middle;
} 
```

# bash - awk 扫描字符串以获取单引号字符

> ID：12184923
> 
> 赞同：3
> 
> 时间：2012-08-29T19:10:14.047
> 
> 标签：bash, awk, solaris

我有一行，我想知道它是否有任何嵌入的单引号字符。使用awk，我尝试了几种变体

```
badix = index($0,"\047") -- this does not find it
badix = index($0, "'") -- throws a fit
badix = index($0, "\'") -- throws a fit
badix = index($0, \') -- throws a fit 
```

这适用于 Solaris 10 上的 awk，因此 gawk 解决方案在这种情况下不适用。

有什么建议么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T19:38:38.510

您遇到了 shell 引用问题，我怀疑您将`awk`命令括在单引号中，即使转义，单引号本身也不能包含单引号。尝试`$'...'`引用，其中*可以*包含转义的单引号：

```
awk $'{
    # Lots of other awk code...

    badix=index($0, "\'") }'

    # The rest of the awk code
   }' 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-29T19:32:53.193

你应该使用：

```
badix = index($0, "'"'"'"); 
```

或使用十六进制值`\x27`作为单引号：

```
badix = index($0, "\x27"); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-29T19:43:08.837

这里有几个方法：

将 awk 脚本放在您运行的单独文件中`-f`，在这种情况下，您可以避免使用 shell 引号，因此`"'"`可以使用

```
$ cat awkscript
#!/bin/awk -f
BEGIN{print "'"}
$ awk -f awkscript </dev/null
'
$ chmod +x awkscript
$ ./awkscript </dev/null
' 
```

从 shell 运行它，将脚本括在 ' 引号中，结束 ' 引号，连接文字 ' 引号，然后开始一个新的 ' 引号。

```
awk 'BEGIN{print "'\''"}' </dev/null 
```

请改用 nawk，它安装为`/usr/xpg4/bin/awk`. 它是 posix 兼容的，而且更没用。

```
PATH=/usr/xpg4/bin:$PATH
awk -v q=\' 'BEGIN{print q}'
awk 'BEGIN{print "\x27"}'
awk 'BEGIN{print "\047"}' 
```

# php - 如果当前未被访问，则删除文件

> ID：12184926
> 
> 赞同：5
> 
> 时间：2012-08-29T19:10:29.783
> 
> 标签：php, filesystems

我正在寻找一种解决方案，我需要删除日志文件，但在进行删除调用时可能正在访问它们。通过被访问，我的意思是一个进程正在读取或写入文件。在这种情况下，我需要跳过文件而不是删除它。我的服务器也是 Linux 并且 PHP 在 Apache 上运行。

我正在寻找类似于（`in pseudo-code`）的东西：

```
<?php
$path = "path_to_log_file";
$log_file = "app.log"; 
if(!being_accessed($log_file))
{
  unlink($path.$log_file);
}
?> 
```

现在我的问题是如何定义`being_accessed`？我知道可能没有语言函数可以直接在 PHP 中执行此操作。我正在考虑使用`last_access_time`（也许？）和`flock`（但这仅在文件`flock`由访问应用程序编辑的情况下才有用）

欢迎任何建议/见解...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T19:16:36.093

一般来说，如果没有管理权限，您将无法找到它（即能够运行诸如`lsof`查看您的文件是否列出的工具。但是如果您的脚本在 linux/unix 服务器上运行（就是这种情况）大多数主机）然后你不需要打扰，因为文件系统会处理这个。例如，你有 1GB 文件并且有人正在下载这个文件。你可以安全地删除文件（使用`unlink()`或任何其他方式）事件如果该下载器刚刚启动并且不会干扰他的下载，因为文件系统知道该文件已经打开（某些进程拥有一个句柄）所以它只会标记它，比如说`invisible`对于其他人（因此，一旦您尝试列出文件夹内容，您将不再看到该文件，但如果您的文件足够大，您可以尝试检查可用磁盘空间（即使用`df`, 来查看它仍然被占用））但是那些如何保留了手柄仍然可以使用它。一旦所有进程关闭，它们的句柄文件将从媒体中物理删除并释放磁盘空间。因此，只需在需要时取消链接。如果您担心`unlink`可能会抛出警告（在 Windows 上可能会出现这种情况），那么只需在您的调用前加上`@`标记 ( `@unlink()`) 即可禁用此调用可能在运行时抛出的任何警告

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:18:26.303

您只需以这种方式更改代码（如果您重复执行此操作）：

```
<?php
$path = "path_to_log_file";
$log_file = "app.log"; 
@unlink($path.$log_file); 
```

注意@以避免在文件不可删除的情况下出现错误，并且缺少结束标记（结束标记是常见错误的来源，应该避免）

# html - CSS样式表中是否允许元素的空格？

> ID：12184930
> 
> 赞同：-1
> 
> 时间：2012-08-29T19:11:15.883
> 
> 标签：html, css

我实际上正在使用drupal，并且正在尝试使用“视图幻灯片”来定位元素。这不是一个真正的drupal问题，更多的是一个css问题，但是，我的一个元素被称为：

```
<div class="views-slideshow-controls-bottom clear-block"> 
```

这是元素的图像，以了解我在做什么。

[![截屏](../Images/c43645fd299115350115103c39d1f3c8.png)](https://i.stack.imgur.com/TqbZY.png)

但无论如何，我在样式表中创建了上面的那个类，但是我的页面上没有显示更改。我正在尝试将图像中突出显示的那些幻灯片预览“浮动”到图像的右侧，而不是现在的图像下方。我想了一个简单的“浮动：左；” 会做，但由于某种原因很清楚：两者都呆在那里，而且 floatleft 甚至没有出现。

那里的班级中间有一个空格，所以我想知道在样式表上是否允许这样做？

```
.views-slideshow-controls-bottom clear-block {
float:left;
 } 
```

例如，空格是否允许元素显示？谢谢，。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T19:12:20.013

您需要在您的 css 中使用`.`.

```
.views-slideshow-controls-bottom.clear-block {
float:left;           /* notice ^ */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T19:12:46.603

如果要基于两个类进行选择，请像这样链接它们：

```
.class1.class2 
```

这基本上转化为`any element with class "class1" and with class "class2"`

它的工作原理与`a.btn[href]`含义相同`any element with tag name "a" and class "btn" and an "href" attribute`- 通过不带空格的链接，您可以对当前元素应用进一步的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:13:12.797

你不能在类名中有空格，因为当你给类属性时，它将被视为两个单独的类

# .net - powershell webClient对couchDB的请求

> ID：12184936
> 
> 赞同：1
> 
> 时间：2012-08-29T19:11:29.137
> 
> 标签：.net, powershell

我正在编写一个脚本来自动化一些执行 Http 请求的测试。我已经粘贴了代码和响应。我认为解析器挂在指定端口的冒号上。

```
function executeRequest($url){
Write-Host "Entered executeRequest";
$webClient = New-Object net.WebClient;
$webClient.Credentials = New-Object System.Net.NetworkCredential("admin",   "password");
$webClient.Headers.Add("Conten-Type", "application/json");

$webClient.UploadFile("http://127.0.0.1:5984/my_couch_collection", "D:\myFile.json");
} 
```

代码错误：

```
> Exception calling "UploadFile" with "2" argument(s): "An exception
> occurred during a WebClient request." At
> D:\staging\scripts\_0001CreateFolderStructure.ps1:8 char:23
> +     $webClient.UploadFile <<<< ("http://127.0.0.1:5984/source_data", "D:\myFile.json");
>     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
>     + FullyQualifiedErrorId : DotNetMethodException 
```

我看过十几个教程，但每个教程的做法都不同，但是所有尝试都导致了某种引用“：”字符的问题。

# latex - 切换在 LaTeX 中包含文本

> ID：12184940
> 
> 赞同：2
> 
> 时间：2012-08-29T19:11:47.947
> 
> 标签：latex, customization

我正在尝试在 LaTeX 中制作一个完整的标题，以便以后编写测验和测试时节省时间。我想在 .tex 文件中包含每个问题的解决方案，并带有一些标志来切换它们是否在编译时出现。

所以在这样的文件中......

```
\begin{document}

Some question
\solution{ the answer to the question}

\end{document} 
```

..除非我包含“\showsolutions”标志，否则解决方案将是不可见的。

我可以创建一个可以执行此操作的命令吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T21:55:46.727

用于`\newif`创建新的 if-type 构造，并设置默认值。

```
\newif\ifshowsolutions
\showsolutionsfalse 
```

然后在你的`\solution`命令中使用它

```
\newcommand{solution}[1]{\ifshowsolutions #1 \fi} 
```

要打开解决方案，请使用

```
\showsolutionstrue 
```

# javascript - 获取上一个和当前的窗口宽度

> ID：12184943
> 
> 赞同：5
> 
> 时间：2012-08-29T19:11:55.050
> 
> 标签：javascript, jquery, resize

我正在尝试通过 JS 获取以前和当前的窗口宽度。我使用 jQuery 来捕获窗口调整大小事件。这是我的代码：

```
<script>
 function getWindowWidth() {
   var myWidth = 0, myHeight = 0;
     if( typeof( window.innerWidth ) == 'number' ) {
         myWidth = window.innerWidth; myHeight = window.innerHeight;
     } else if( document.documentElement && ( document.documentElement.clientWidth ||document.documentElement.clientHeight ) ) {
         myWidth = document.documentElement.clientWidth; myHeight = document.documentElement.clientHeight;
     } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
         myWidth = document.body.clientWidth; myHeight = document.body.clientHeight;
     }
     return myWidth;
 }
 var lastWindowWidth;
 $(document).ready(function() {
   $(window).resize(function() {
       $('#h1_text').text("Previous: "+ lastWindowWidth + " Current: " + getWindowWidth());
       lastWindowWidth = getWindowWidth();
     });
 });
</script> 
```

它返回给我：

```
Previous: 1685 Current: 1685 
```

为什么 Previous: 和 Current: 值都相似？提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T19:15:00.690

您**正在**使用 jQuery。

所以使用jQuery：

```
$(window).width(); 
```

* * *

```
 var lastWindowWidth;
 $(document).ready(function() {
   $(window).resize(function() {
       var $window = $(this),
           windowWidth = $window.width();
       $('#h1_text').text("Previous: "+ lastWindowWidth + " Current: " + windowWidth );
       lastWindowWidth = windowWidth;
     });
 }); 
```

小提琴：http: [//jsfiddle.net/maniator/pKfSN/5/](http://jsfiddle.net/maniator/pKfSN/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-12T08:08:44.340

答案的本质是在`previous_window_width`调整窗口大小之前捕获：

```
var previous_window_width = $(window).width();

...

$(window).resize(function() {
    var current_window_width = $(window).width();
    // do whatever you need with previous_window_width
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:18:45.127

你去[http://jsfiddle.net/B9chY/](http://jsfiddle.net/B9chY/)

```
var lastWindowWidth = $(window).width();

$(window).resize(function() {
   $('#h1_text').text("Previous: "+ lastWindowWidth + " Current: " + $(window).width());
       lastWindowWidth = $(window).width();
 }); 
```

根据评论：

```
var lessThan = false;

$(document).ready(function() {
    if ($(window).width() < 980) {
        lessThan = true;
    }
});

$(window).resize(function() {
   if ($(window).width() < 980) {
        lessThan = true;
    }
}); 
```

# android - OpenCV for iOS 移植到 Android

> ID：12184947
> 
> 赞同：-1
> 
> 时间：2012-08-29T19:12:18.223
> 
> 标签：android, ios, opencv

我已经在 iOS 中开发了一个应用程序，它使用[这个算法](https://stackoverflow.com/questions/8667818/opencv-c-obj-c-detecting-a-sheet-of-paper-square-detection)来检测一张纸，我正在将该算法转换为 Android 端口。

我应该如何将这个翻译成Java？

```
mixChannels(&blurred, 1, &gray0, 1, ch, 1); 
```

在哪里`blurred`和`gray0`在哪里`cv::Mat`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:38:40.183

使用[cvMixChannels](http://www.mon-club-elec.fr/mes_docs/my_javacv_javadoc/com/googlecode/javacv/cpp/opencv_core.html#cvMixChannels%28com.googlecode.javacv.cpp.opencv_core.CvArr%5B%5D,%20int,%20com.googlecode.javacv.cpp.opencv_core.CvArr%5B%5D,%20int,%20int%5B%5D,%20int%29)函数。[这里](http://opencv.willowgarage.com/documentation/cpp/core_operations_on_arrays.html#mixChannels)是参数说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T01:56:55.017

你会这样做：

```
MatOfInt fromto = new MatOfInt(ch);
List<Mat> blurredlist = new ArrayList<Mat>();
List<Mat> graylist = new ArrayList<Mat>();
blurredlist.add(0, blurred);
graylist.add(0, gray0);
Core.mixChannels(blurredlist, graylist, fromto); 
```

查看此实现以获取更多示例： [https ://code.google.com/p/scope-ocr/](https://code.google.com/p/scope-ocr/)

# svn - 将我的 VisualSVN 服务器移动到新位置 (IP) 时要进行的更改

> ID：12184948
> 
> 赞同：0
> 
> 时间：2012-08-29T19:12:18.393
> 
> 标签：svn, version-control, visualsvn-server

我正在移动我的 VisualSVN 服务器，更重要的是它的 IP。我该怎么做才能让服务器与新位置的客户端通信？

我假设我必须以某种方式在路由器上设置端口转发（我认为虚拟 SVN 是 8443），但我相信这是在我最初设置时自动处理的，我可以让它再次自动执行吗？

我在我的客户上使用乌龟 SVN，我发现了“重新定位”功能，所以我应该很好地让客户工作。

还有什么我需要做的吗？

# c# - 用于批量插入和删除的 WCF DataService 或 WCF 端点

> ID：12184951
> 
> 赞同：0
> 
> 时间：2012-08-29T19:12:24.790
> 
> 标签：c#, asp.net-mvc, wcf, wcf-data-services

我们有一个新的客户端应用程序，它将部署在远程服务器上，并出于各种原因通过某种类型的 WCF 服务与另一台服务器上的数据库进行交互。我负责构建 DataLayer 和 Servicelayer。

无论如何，问题是我正在开发 MVC 客户端应用程序的同志希望进行批量插入和更新。专门构建从父级到所有子级的整个对象，然后通过 WCF 提交，然后依次访问 EntityModel，一切都得到了处理。但是，我在使用 DTO 创建了一个服务层然后使用普通 WCF 端点之后，试图解决他的要求是一场噩梦，因为无论我是否将缓冲区大小设置为最大，都会抛出 413 错误，说大小太大.

所以后来我尝试了 WCF DataServices，我玩得越多，我就越喜欢它，但是现在似乎不需要带有 DTO 的服务层，我什至不知道如何为它设计一个。而且我不相信它会做他要求的批量交易类型，只有单独的对象，而不是嵌套的。此外，在没有服务层的情况下，由于使用 ODATA 通过 URI 进行调用的方式，他的存储库模式可能会膨胀。另外，我不是将 Presentation（客户端）与我的 DataLayer 紧密耦合吗？

我应该使用什么 WCF 类型，他的请求是否可行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T19:26:25.637

413 错误不是来自 WCF，而是来自 IIS。因此，您应该能够按照本文中的建议处理您的主要问题[（](https://stackoverflow.com/questions/2882011/wcf-iis6-0-413-request-entity-too-large)除非您的 WCF 消息大小大于 4GB，这完全是另一个问题）。

一旦您恢复了理智，您就可以回到 WCF 数据服务是否对您的情况有意义的问题。

# iphone - UIWebView 在处理 ajax 轮询网站时返回空白

> ID：12184953
> 
> 赞同：0
> 
> 时间：2012-08-29T19:12:34.060
> 
> 标签：iphone, objective-c, ios

每次我点击我的标签时，它都应该使用以下方法发送请求

```
[self loadingProgress];
    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.happy.com/ajax/index.php"]]]; 
```

但出于某种原因，它每次都会向我返回一个空白页面，我想知道什么是确保返回的好方法，这个问题与我的 ajax 代码有关吗？我每 2 秒进行一次长轮询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T20:31:54.633

Michael 是正确的，因为您以两秒的间隔长时间轮询并提交多个请求，您的 UIWebView 试图在旧请求完成之前加载每个新请求。

一种方法是使用 UIWebView 的`loading`属性，该属性将返回一个 BOOL，指示在您尝试传递另一个 NSUrlRequest 之前它是否仍在处理 NSUrlRequest。我还会参考[UIWebView 类参考](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIWebView_Class/Reference/Reference.html)文档以获取更多考虑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T20:06:02.347

如果您发布的代码每 2 秒执行一次，那么这就是问题所在。
您在前一个请求完成之前加载一个新请求。

# c++ - 在 C++ 中将项目添加到数组的最有效方法

> ID：12184954
> 
> 赞同：0
> 
> 时间：2012-08-29T19:12:45.320
> 
> 标签：c++, arrays, performance

我该怎么写：

```
 buttons[0] = imageButton;
    buttons[1] = imageButton1; 
```

等更有效。我有超过 1000 个按钮。我希望有更好的方法来写这个。

我尝试了以下操作，并被 XCode 强制插入 &。此代码使我的程序崩溃：

```
 for (int i = 0; i < numberOfButtons; i++)
    {

        buttons[i] = &imageButton[i];
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:14:32.077

如果你有一个指针向量并且想快速填充它，你可以使用这个：

```
std::vector<t_button*> buttons(1000, 0); // << is that what you wanted?
for (int i = 0; i < numberOfButtons; i++) {
    buttons[i] = &imageButton[i];
} 
```

当然，您需要确保添加到向量中的内容比向量本身的寿命更长，因为这是一个指向按钮的指针数组，而不是值。

如果您只有大量具有唯一地址和唯一名称且后缀单调递增的自由变量，那么如果您将这些值本身存储在向量中，从长远来看，您可能会更快乐：

```
std::vector<t_button> buttons(1000, 0); // << holds 1000 buttons by value 
```

总的来说，这个问题很难回答——它的措辞就像一个性能问题，但还有其他语义问题需要首先解决，并且缺少很多细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T19:17:35.930

如果您使用的是新的 C++，请记住 emplace_back 并尽可能移动。我猜按钮是一个指针？因为你 ”＆”。复制指针和整个对象是两个不同的东西。您应该添加按钮的定义。使用 .reserve 避免不必要的复制对象（ std::containers 默认复制对象）。

还要记住，在 boost 中的示例 ptr_vector 将帮助您保持清晰。

[http://www.boost.org/doc/libs/1_51_0/libs/ptr_container/doc/ptr_vector.html](http://www.boost.org/doc/libs/1_51_0/libs/ptr_container/doc/ptr_vector.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:30:37.167

如果要将 imageButton1 添加到 imageButton1000，我建议使用字符串连接宏

```
#define imagebutton(X) imageButton##X 
```

并且可以从您的循环中调用此函数。如果你有 imagebuttons 作为数组，你也可以做 memcpy

```
memcpy(button, imagebutton, noOfButtons) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T19:31:08.693

听起来您正在声明一千个名为`imageButton1`through的局部变量`imageButton1000`，现在您想将它们放入一个数组中。

```
Button imageButton1("Save");
Button imageButton2("Load");
//...etc...
Button imageButton1000("Reticulate Splines");

//now that we've exhaustively created all the buttons, exhaustively put them into the array

buttons[1] = &imageButton1;
buttons[2] = &imageButton2;
//...etc...
buttons[1000] = &imageButton1000; 
```

根据我的经验，在变量名中放一个数字是一个非常强烈的信号，表明数据不应该单独声明，而应该是类似对象集合的一部分。

```
buttons[0] = new Button("Save");
buttons[1] = new Button("Load");
//...etc...
buttons[999] = new Button("Reticulate Splines"); 
```

您仍然需要花费一千行来填充数组，但是如果您有一千个完全独特的对象，这是不可避免的。但至少这种方式不是*两千*行长。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T19:14:48.390

您可以使用矢量来保存按钮的地址

```
 std::vector< ImageButton* > Buttons;
    Buttons.push_back( &MyButton );

/* then */

   ImageButton* button = Buttons.at(i); // int i, is the index
   button->DoSomething(); 
```

例如你可以

```
std::vector< ImageButton* > Buttons;
for(int i=0;i<100;i++)
{
    ImageButton* button = new ImageButton;
    Buttons.push_back( button );
}

for(int i=0;i<100;i++)
{
    ImageButton* button = Buttons.at(i);
    button->DoSomething();
} 
```

如果您打算为容器使用固定大小，您不妨创建一个**Memory Pool**。这将使您免于堆碎片和令人讨厌的崩溃。

无论如何，我强烈建议使用**内存池**作为使用“**新**”的替代方案。1 个**新**的比 1000 个要好。它甚至可以快**2000% 。**

# android - 在不生根的情况下禁用系统/组合栏 Android ICS

> ID：12184961
> 
> 赞同：3
> 
> 时间：2012-08-29T19:13:06.370
> 
> 标签：android

我到处搜索，一直有人告诉我，“不，不扎根就完全抑制 ICS 平板电脑上的导航/组合栏是不可能的......然后我发现市场上有一个名为 Surelock 的应用程序正是这样做的.. 不幸的是，我自己正在构建一个启动器应用程序，所以我不能使用他们的启动器应用程序，但最大的问题是他们是如何做到的？有人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:13:42.217

SureLock 所做的一切都是在利用一些安全漏洞。总有一天，我会花时间找出他们在做什么，并将努力修复这个洞。

# ajax - Rails 3 MarkItUp 预览

> ID：12184966
> 
> 赞同：1
> 
> 时间：2012-08-29T19:13:20.673
> 
> 标签：ajax, ruby-on-rails-3, markitup

所以我在我的 Rails 应用程序中实现了[Markitup](http://markitup.jaysalvat.com/home/) bbcode 编辑器，我目前正在尝试让预览功能正常工作。我关注了一个 4 岁的博客条目[安装标记！在 Ruby on Rails](http://markmcb.com/2008/11/08/install-markitup-in-ruby-on-rails/)中，这让我非常接近我需要做的事情。到目前为止，当我按下预览按钮时，它会呈现一个 iframe，为我显示一个空白模板。

在我的 jquery.markitup.js 中，我将此行作为选项之一：

```
previewTemplatePath:    '/templates/preview', 
```

这将发出一个 ajax 请求来检索路由的页面：

```
resources :templates do
    collection do
      get :preview
    end
  end 
```

目前，预览操作只是设置`render :layout => false`，所以我不会复制 html。至于 preview.html.erb 页面本身，我只有：

```
<%= bb(params[:data]) %> 
```

这背后的想法是将编辑器中输入的标记发送到参数数据哈希中，然后通过我的 bb 代码助手传递它，该助手进行解析并返回一些 html。

**问题**

我不知道如何`params[:data]`用输入到标记编辑器中的 bb 代码来填充它。有人知道我怎么能把它寄出去吗？

**额外细节：** 我想我会包括我传递给markItUp的所有选项：

```
options = { id:                     '',
                    nameSpace:              '',
                    root:                   '',
                    previewInWindow:        '', // 'width=800, height=600, resizable=yes, scrollbars=yes'
                    previewAutoRefresh:     true,
                    previewPosition:        'after',
                    previewTemplatePath:    '/templates/preview',
                    previewParser:          false,
                    previewParserPath:      '',
                    previewParserVar:       'data',
                    resizeHandle:           true,
                    beforeInsert:           '',
                    afterInsert:            '',
                    onEnter:                {},
                    onShiftEnter:           {},
                    onCtrlEnter:            {},
                    onTab:                  {},
                    markupSet:          [   { /* set */ } ]
                }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:32:58.597

当我调用 markItUp! 时，需要设置**previewTemplatePath**和**previewParserPath选项。**

previewTemplatePath 指向显示渲染预览的视图， previewParserPath 旨在指向处理解析和数据参数的控制器操作。假设您遵循干燥的约定，两条路径都应该与我的情况相同。

为了更好地了解如何集成 markItUp！使用 rails 查看 branch14 的[markupitup gem](https://github.com/branch14/markitup)的源代码。

# umra - 记录错误说文件已加密但文件未加密

> ID：12184968
> 
> 赞同：0
> 
> 时间：2012-08-29T19:13:27.237
> 
> 标签：umra

我正在使用 Tools4ever 的 UMRA 并收到此错误。

> 解密文本时出错。无法分解编码和加密的输入文本。更改 Google 域“%GoogleSessionId%”中的 Google 用户“%username%”的密码时出现错误“-1”。解密密码时出错。“Google 用户更改密码”操作出错。脚本继续。

从中提取用户名和密码的文件是我通过右键单击并选择“新文本文件”并将信息粘贴到其中创建的文件。我还尝试将相同的信息输入到新文件中以排除任何可能随后发生了不应该发生的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-31T00:28:47.847

**确保在为Google 设置连接**设置密码或为 Google 设置操作时使用**设置加密变量**操作。如果您仍有问题，请拨打我们的支持热线或聊天**`reset password``Tools4ever.com`**

# javascript - 部署 ckeditor 时是否需要包含 plugins 文件夹？

> ID：12184972
> 
> 赞同：0
> 
> 时间：2012-08-29T19:13:44.773
> 
> 标签：javascript, ckeditor

我正在使用 ckEditor 为我的用户提供所见即所得的编辑

部署 ckeditor 时是否需要包含 plugins 文件夹？还是将基本使用所需的所有插件都打包到ckeditor.js中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T21:01:25.933

您必须一一检查文件夹。

有些是核心中不包含的可选插件，而其他文件夹包括对话框，它们不包含在核心中，除非您创建包含所需内容的新构建。

# android - 如何使用scene2d绘制TiledMap

> ID：12184973
> 
> 赞同：4
> 
> 时间：2012-08-29T19:13:49.007
> 
> 标签：android, libgdx, box2d, scene2d

我想使用 libgdx 创建一个基于平铺的游戏，我找到了这个教程

[Box2d 平铺地图](http://dpk.net/2011/05/08/libgdx-box2d-tiled-maps-full-working-example-part-1/)

TileMapRenderer 有它自己的渲染器来绘制瓷砖地图。我想使用scene2d 进行平铺渲染，因为我习惯于使用Scene2d 做事。同样使用 Stage 类，输入之类的事情更容易做到。是否可以使用 Actor 类实现此图块渲染？我可以只使用场景图而不使用 Actor 类的 draw 方法中传递的 spritebatch 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T15:21:29.213

不，the`TileMapRenderer`和scene2d `Stage`/ `Actor`API 是不同的。瓦片地图 API 不扩展或利用 scene2d API。

您可以在一个应用程序中同时使用这两种方法（例如，用图块渲染您的游戏区域，用scene2d 渲染您的用户界面）。

有一个新的和改进的（截至 2012 年 2 月）Libgdx Tile Map API： [http](http://code.google.com/p/libgdx/wiki/GraphicsTileMaps) ://code.google.com/p/libgdx/wiki/GraphicsTileMaps ，它有一个[示例游戏](https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/superkoalio/SuperKoalio.java)，可能有助于澄清事情。

# java - 为什么 Hadoop API FSDataInputStream 读取小于缓冲区大小？

> ID：12184975
> 
> 赞同：1
> 
> 时间：2012-08-29T19:13:54.683
> 
> 标签：java, hadoop

我在 hadoop 分布式文件系统上有一个要读取的二进制文件。我正在使用 FSDataInputStream （扩展 DataInputStream ）。我有长度为 "len" 的缓冲区。我使用 readBytes = stream.read(buffer) 方法将“len”字节数从文件读入缓冲区。但是实际读取的字节数（ readBytes ）小于缓冲区大小（ len ），即使我知道文件中存在“len”字节数。那么为什么 FSDataInputStream 读取的字节数比我要求它读取的少？任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T19:16:58.533

JavaDocs[`DataInputStream.read(byte[]) and InputStream(byte[])`](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#read%28byte%5B%5D,%20int,%20int%29)非常清楚地表明该方法将读取“一些字节数”，直到字节数组的长度。在字节数组被填充之前代码可能会返回有几个原因。

您不应该只调用`read(byte[])`一次该方法来消耗流中的字节 - 您需要循环并继续从流中读取，直到它返回`-1`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-28T21:50:49.410

如果您位于文件块的末尾附近，使得从该位置向前的“len”字节位于下一个块中的某个位置，那么当您使用 stream.read(buffer) 时，您将只获得块中剩余的字节. 在随后的读取中，您将开始从文件的下一个块中获取字节。

# php - PoEdit 不识别 _n() 复数

> ID：12184978
> 
> 赞同：2
> 
> 时间：2012-08-29T19:14:19.590
> 
> 标签：php, localization, gettext, poedit, xgettext

我在 POEdit 的源关键字中设置了这个：

```
_
__
_e
_ex
_n
esc_attr_e
_x
_nc 
```

它有效，但是当我使用`_n()`函数（二十一主题）时，我只得到第一个字符串：

`<?php printf(_n('One Comment', '%s Comments', get_comments_number(), 'twentyeleven'), number_format_i18n(get_comments_number())); ?>`

任何想法如何让它识别`_n()`？这正是我遇到的问题，但没有解决方案：[http ://www.poedit.net/trac/ticket/307](http://www.poedit.net/trac/ticket/307)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-18T16:28:17.873

您应该在 poedit 中设置一个关键字，以便您拥有

**关键词**

```
n
_n:1,2 
```

例如，这是我的来源关键字

![复数形式 poedit](../Images/02b150ce997675eb267974da601684b7.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-30T10:59:13.720

关键字规范在[xgettext 手册页](http://www.gnu.org/savannah-checkouts/gnu/gettext/manual/html_node/xgettext-Invocation.html)中有详尽的解释。

# java - Java中的JComboBox，声明错误

> ID：12184980
> 
> 赞同：0
> 
> 时间：2012-08-29T19:14:32.773
> 
> 标签：java, swing, compiler-errors, jcombobox

我得到了下一个用 Java 编写的简单程序，我在网上得到了它，因为我正在尝试学习 Java，但不知道如何解决它：

```
import javax.swing.*;
        import java.awt.*;
        import java.awt.event.*;

        public class java2 extends JPanel {

            public java2 () {
                setLayout(new Gridlayout(2,1));
                JList lista = new JList(java2.ids);
                add(new JScrollpane(lista));
                JComboBox combo=new JComboBox();
                for (int i=0;i<100 ;i++ ) {
                    combo.addItem(Integer.toString(i));
                    add(combo);
                }
            }
        public static void main(String args[]) {
            java1 lista=new Java1();
            JFrame ventana=new JFrame();
            ventana.getContentPane().add(lista,BorderLayout.CENTER);
            ventana.addWindowListener(new WindowAdapter(){public void windowClosing(WindowEvent evt){System.exit(0);}});
            ventana.setSize(200,200);
            ventana.setVisible(true);
        }
        } 
```

正如我所说，我每次编译时都会遇到下一个问题，我是 java 新手，可以说我知道如何修复它们：

```
java2.java:8: error: cannot find symbol
        setLayout(new Gridlayout(2,1));
                      ^
  symbol:   class Gridlayout
  location: class java2
java2.java:9: error: cannot find symbol
        JList lista = new JList(java2.ids);
                                     ^
  symbol:   variable ids
  location: class java2
java2.java:10: error: cannot find symbol
        add(new JScrollpane(lista));
                ^
  symbol:   class JScrollpane
  location: class java2
java2.java:18: error: cannot find symbol
    java1 lista=new Java1();
    ^
  symbol:   class java1
  location: class java2
java2.java:18: error: cannot find symbol
    java1 lista=new Java1();
                    ^
  symbol:   class Java1
  location: class java2
Note: java2.java uses unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
5 errors 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T19:18:11.887

试试这个：

```
import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JScrollPane;

public class JavaDemo extends JPanel {

  public JavaDemo() {
    setLayout(new GridLayout(2, 1));
    JList lista = new JList(new String[] {"1", "2", "3", "4"});
    add(new JScrollPane(lista));
    JComboBox combo = new JComboBox();
    for (int i = 0; i < 100; i++) {
      combo.addItem(Integer.toString(i));
      add(combo);
    }
  }

  public static void main(String args[]) {
    JavaDemo lista = new JavaDemo();
    JFrame ventana = new JFrame();
    ventana.getContentPane().add(lista, BorderLayout.CENTER);
    ventana.addWindowListener(new WindowAdapter() {
      public void windowClosing(WindowEvent evt) {
        System.exit(0);
      }
    });
    ventana.setSize(200, 200);
    ventana.setVisible(true);
  }
} 
```

# python - 如何允许版本低于 python2.7 的 python 用户运行使用 `sysconfig` 的程序？

> ID：12184984
> 
> 赞同：3
> 
> 时间：2012-08-29T19:14:35.487
> 
> 标签：python, module, version, packaging, pypi

我制作了一个使用该`sysconfig`模块的python程序。如何允许 python 版本低于 python2.7 的 python 用户也运行该程序？我在`PyPI`.

之前我也使用过`argparse`，并且默认情况下也没有在低于 python2.7 的 python 版本中安装它。但我可以将它添加到我的需求文件中，因为它可以使用`pip`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T19:17:25.307

您需要编写一个无需 sysconfig 即可工作的代码版本 - 您的代码将如下所示：

```
try:
    import sysconfig
    HAS_SYSCONFIG = True
except ImportError:
    HAS_SYSCONFIG = False

...

if HAS_SYSCONFIG:
    # sysconfig code here
else:
    # compatibility code here 
```

您也可以尝试向后移植`sysconfig`到早期版本的 python 并将其包含在您的脚本中，但这可能比它的价值更多。

# php - PHP 表单 - 哪个输入不正确？

> ID：12184996
> 
> 赞同：0
> 
> 时间：2012-08-29T19:15:35.370
> 
> 标签：php, forms, error-handling

如果我有疑问，

```
SELECT (...) FROM User WHERE Username = (...) AND Password = (...); 
```

并且用户输入了无效的用户名，有没有办法确定它是不正确的用户名？

这样我就可以向用户提供更具体的错误消息，例如“用户不存在”等......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:17:58.043

```
SELECT COUNT(*) AS `count` FROM `User` WHERE `Username` = ...;

if( $result['count'] < 1 )
{
  // no user
}

// repeat for pass. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:18:47.677

如果密码匹配，我会选择用户名，然后选择一个位字段。所以从 WHERE 子句中删除密码部分，并将其移动到 SELECT 子句中。然后，没有匹配的行意味着用户名无效，如果有一行，则需要检查该字段以查看密码是否匹配。

```
SELECT (...) IF(password=?, 1, 0) as success
FROM User
WHERE Username = ? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T19:19:35.260

如果你**坚持**这样做，你可以这样做：

```
SELECT password FROM user WHERE username = ? 
```

如果没有找到记录，则用户名不存在。如果是这样，您现在可以比较密码。

# scala - Scala 和前向引用

> ID：12184997
> 
> 赞同：27
> 
> 时间：2012-08-29T19:15:44.823
> 
> 标签：scala, reference, compilation

> **可能重复：**
> [Scala：前向引用 - 为什么这段代码可以编译？](https://stackoverflow.com/questions/7762838/scala-forward-references-why-does-this-code-compile)

```
object Omg {

  class A

  class B(val a: A)

  private val b = new B(a)

  private val a = new A

  def main(args: Array[String]) {
    println(b.a)
  }

} 
```

以下代码打印“null”。在爪哇。由于无效的前向引用，类似的构造无法编译。问题是 - 为什么它在 Scala 中编译得很好？这是设计使然，在 SLS 中描述还是只是 2.9.1 中的错误？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-29T20:18:08.753

这不是错误，而是学习 Scala 时的经典错误。初始化对象时`Omg`，首先将所有值设置为默认值（`null`在这种情况下），然后运行构造函数（即对象主体）。

要使其工作，只需`lazy`在前向引用的声明前添加关键字（`a`在这种情况下为值）：

```
object Omg {

  class A

  class B(val a: A)

  private val b = new B(a)

  private lazy val a = new A

  def main(args: Array[String]) {
    println(b.a)
  }
} 
```

`a`然后将根据需要初始化值。

这种构造速度很快（所有应用程序运行时的值只初始化一次）并且是线程安全的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-29T20:23:58.723

据我了解，这与 Scala 类的创建方式有关。在 Java 中，上面定义的类将内联初始化变量，由于`a`尚未定义，因此无法编译。但是，在 Scala 中，它更相当于 Java 中的 this（在相同的场景中也应该产生 null）：

```
class Omg {
  private B b = null;
  private A a = null;

  Omg(){ 
    b = new B(a);
    a = new A();
  }
} 
```

或者，您可以声明`b`惰性，这将推迟设置值直到它被调用（此时将设置 a）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-30T05:35:05.580

如果这是一个问题，请在开发期间编译`-Xcheckinit`并迭代直到异常消失。

Spec 5.1 用于按顺序执行的模板主体语句；4.0 开始，用于块中的前向引用。

[前向引用 - 为什么这段代码会编译？](https://stackoverflow.com/questions/7762838/scala-forward-references-why-does-this-code-compile)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T20:23:38.977

正如@paradigmatic 所说，这并不是一个真正的错误。它是初始化顺序，它遵循声明顺序。在这种情况下，当被声明/初始化`a`时为空。`b`

将行更改`private val b = new B(a)`为`private lazy val b = new B(a)`将解决问题，因为使用惰性会延迟初始化。b 的第一次使用。

这种行为很可能在 SLS 中有所描述。