# StackOverflow 问答 000360000-000360999

# .net - 如何从 axd 转换为 ashx？

> ID：360007
> 
> 赞同：3
> 
> 时间：2008-12-11T16:39:19.437
> 
> 标签：.net, asp.net, elmah, ashx, axd

我正在尝试部署[elmah](http://code.google.com/p/elmah/)。由于莫名其妙的原因，我收到一个错误：.axd 文件被明确禁止。我已经修复了我可以控制的内容（我的 web.config），并且需要系统管理员协作的解决方案*不可*用（例如编辑机器 web.config 或更新 IIS 映射）。我还验证了它在其他几台具有普通配置的机器上也能正常工作。

Ashx 应该像 axd，那么在从一种转换到另一种时，我应该考虑到 axd 和 ashx 之间有什么区别吗？

更新：我想我回答了我自己的问题。我将 web.config 更改为阅读

```
 <add verb="POST,GET,HEAD" path="elmah.ashx" type="Elmah.ErrorLogPageFactory, Elmah" /> 
```

它似乎工作。elmah 的源代码中甚至没有字符串 axd。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T16:32:48.750

答案是将 web.config 更改为如下所示：

```
<add verb="POST,GET,HEAD" path="elmah.ashx" type="Elmah.ErrorLogPageFactory, Elmah" /> 
```

事实上，网络上的一些消息来源说，除非您是微软，否则您不应将任何处理程序命名为 axd，以免您与 ASP.NET 的未来版本发生名称冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T03:33:20.380

很高兴看到你得到答案:)

axd 扩展通常用于仅使用 .NET 1.1 或更早版本的情况。并且开发人员无权修改 IIS 6 或更早版本中允许的扩展。

在您的情况下，似乎服务器上的所有跟踪都已从更高的配置级别禁用。

您找到的答案应该可以正常工作而不会出现问题。

# java - 学习 GWT 有多大用处？

> ID：360008
> 
> 赞同：9
> 
> 时间：2008-12-11T16:39:20.810
> 
> 标签：java, gwt

我开发 Web 应用程序，到目前为止，在我的工作中，每当发生一些 JS 或 CSS 怪癖时，我一直在与各种浏览器进行斗争。我相信使用 GWT 将极大地帮助我从我从[这个](http://code.google.com/webtoolkit/)描述中理解的内容：

> 今天编写 Web 应用程序是一个乏味且容易出错的过程。开发人员可以将 90% 的时间用于解决浏览器的怪癖。此外，构建、重用和维护大型 JavaScript 代码库和 AJAX 组件可能既困难又脆弱。Google Web Toolkit (GWT) 允许开发人员使用 Java 编程语言快速构建和维护复杂但高性能的 JavaScript 前端应用程序，从而减轻了这一负担。

GWT 的普遍看法是什么？学习和使用它有多容易？

编辑：我是一名 Java 开发人员！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-11T18:31:16.870

你没有说你是否有任何Java背景。如果你不这样做，那么，好吧，我无法说出你的学习曲线可能是什么。

然而...作为一个使用 Java 大约 9 年，并且大部分时间都在使用 Swing 的人，我发现 GWT 非常容易学习。

这些小部件与 Swing 不同，因此需要一些时间来适应。但是，从我的角度来看，这与学习任何其他图书馆并没有什么不同。

就个人而言，我喜欢使用 IntelliJ（我选择的编辑器）并利用所有出色的 Java 工具来帮助我编写更好的代码。（顺便说一句……这是[GWT 任务](http://code.google.com/webtoolkit/makinggwtbetter.html#introduction)的一部分。）

我喜欢这样一个事实，即这是一个充满活力且高度活跃的工具包，有很多人真的有兴趣让它变得更好。（再次，看看讨论组，甚至浏览[贡献者的讨论组](http://groups.google.com/group/Google-Web-Toolkit-Contributors)。）

如果您想访问更多或不同的小部件，有很多项目希望填补空白：

*   [GWT-分机](http://code.google.com/p/gwt-ext/)
*   [外部GWT](http://extjs.com/products/gxt/)
*   [SmartGWT](http://code.google.com/p/smartgwt/)
*   [高级 GWT 组件](http://advanced-gwt.sourceforge.net/)
*   [GWT 孵化器](http://code.google.com/p/google-web-toolkit-incubator/)（来自 GWT 团队的许多有趣想法的发源地）

（注意：我不支持任何这些项目或评论它们的相对优点，只是试图提供一些参考......）

我认为，如果您在网络上四处搜索，尤其是查看[GWT 讨论组](http://groups.google.com/group/Google-Web-Toolkit/)，您可以很好地了解其他人使用 GWT 所做的事情。

说了这么多，请注意...您仍然会发现在 IE6 与 IE7 与 FireFox 3 上的渲染方式存在一些问题，与...不能说 GWT 在这方面有多好。我所知道的是，在我开发的应用程序的 10 多个月的工作中，我们只遇到过少数情况，我们必须为一个或另一个浏览器专门化 CSS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T18:49:24.557

如果您具有 Java 背景或习惯于 Swing 之类的东西，我认为使用 GWT 是有意义的，因为它可以让您在熟悉的环境中使用熟悉的概念进行编码。使用 GWT 的另一个好理由是，如果您的团队主要由 Java 开发人员组成，而 Web 开发人员很少。在这些情况下，它应该很容易学习和使用。

另一方面，我不确定它是否适合构建大多数 Web 应用程序的抽象级别，特别是如果您不是构建类似桌面的应用程序而是构建具有丰富功能的网页时。

Javascript 是一种强大的语言，在某些方面比 Java 更适合 Web（Groovy 可以修改这一点，但我不确定与 GWT 集成有多容易），有很多成熟的 JS 框架可以让你远离大多数浏览器的怪癖并提供恰到好处的抽象级别，有针对 JS 的单元测试框架，还有一些好的编程实践可以让您的代码更易于管理。

对于编写 Web 应用程序，我更喜欢在客户端上进行客户端开发，并且希望看到浏览器朝着这个方向发展，而不是成为各种沙箱（如 Flex 或 GWT）的容器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T19:11:47.630

我来自 C# 背景，切换到 Java 和 GWT 并不痛苦。一旦你理解了异步 RPC 调用、JSNI 和类似的概念，你就走在了正确的道路上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-10T12:15:05.807

就个人而言，如果你能找到 Ext-GWT 的替代品，因为支持很糟糕，整个事情都是错误的，而且构思不周。此外，我还没有找到任何关于在 Eclipse 中运行 Ext-GWT 的教程。我已经成功地在 Eclipse 中安装并运行了一个 GWT 示例应用程序，但现在我想使用 Ext-GWT 库，它们不能一起玩。Eclipse GWT 插件建立了它自己的小环境，它不能容纳 Ext-GWT 组件，反之亦然。例如，当 Ext-GWT 需要自己的入口点时，它如何与 GWT 模块OnloadFunction 配合使用？工作中经常使用JS库，还不错，但是论坛太烂了，版主经常粗鲁，或者太含糊，似乎没有“简单的答案”之类的东西

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-25T19:37:26.417

我参加聚会可能有点晚了……但对于未来的读者……

我已经构建 GWT 应用程序不到 3 年了，所以我可能能够很好地回答“学习 GWT 有多容易”这个问题。

当我决定编写 GWT 应用程序时，我的 Java 技能并没有那么好，所以我的 GWT 学习之旅有些坎坷。当我的 Java 成为我想要的时候，Marius Andreiana 的[在线书籍](https://code.google.com/p/gwt-gae-book/)让我的 GWT 学习体验变得更好。

一般意见？从Ray Cromwell[的 Google Web Toolkit 的历史和未来 Google I/O 2012](https://www.youtube.com/watch?v=VOf27ez_Hvg)演讲中，他将 GWT 描述为一种工具，可帮助 Java 开发人员为 Web 开发而无需学习任何额外的技术、测试框架、构建工具等等。它有点像[Phone-gap](http://phonegap.com/)是为 Web 开发人员制作的移动开发工具。

现在，到发布这个问题的时候，如果提到[克伦威尔的演讲](https://docs.google.com/presentation/d/1pC9WK80-fzIs2iMQOO3Jsvfmqv2erI9xucuF3lHOE7Q/edit?pli=1#slide=id.p18)，GWT 并没有那么大的感觉，至少，当人们从它现在的位置看它时；社区很强大，[文档](http://www.gwtproject.org/)是一件艺术品，当然还有[更多书籍](http://www.amazon.com/s/ref=nb_sb_ss_c_0_15?url=search-alias%3Dstripbooks&field-keywords=google+web+toolkit&sprefix=google+web+toolkit%2Caps%2C543&rh=n%3A283155%2Ck%3Agoogle+web+toolkit)，我个人最喜欢的是[Daniel Guermeur 和 Amy Unruh](https://rads.stackoverflow.com/amzn/click/com/B0056ZUIYC)的书。但是，我仍然觉得 YouTube 上似乎存在 GWT 教程的不足，但是，一切都在适当的时候。

最后，HTML/CSS/JavaScript 世界也发生了翻天覆地的变化，更好的前端框架、构建自动化、依赖管理、测试等等。就个人而言，我在构建 google app engine 应用程序时选择编写 GWT，以便它的所有 java 代码，并选择依赖于 CSS/JavaScript 框架的其余时间。

# iphone - UITableView，拦截Edit模式

> ID：360013
> 
> 赞同：13
> 
> 时间：2008-12-11T16:41:23.490
> 
> 标签：iphone, cocoa-touch

我很好奇是否可以在 UITableView 上拦截“编辑”模式的默认方法。通常，如果您侧滑具有与其关联的委托方法的 UITableViewCell，您将获得一个免费的“删除”按钮。我想将删除更改为其他一些任意选择器。而不是删除单元格，我只想运行一个 hello world 警报对话。这种程度的事情是可能的吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-08-08T20:04:48.163

编辑是作为 UITableView 的委托对象上的一种方法实现的。在您的表格控制器中，让任何激活编辑的控件调用此：

```
[tableView setEditing: YES animated: YES]; 
```

然后，确保您的委托对象实现了这一点：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {
    if (editingStyle == UITableViewCellEditingStyleDelete) {
            UIAlertView *alert = [[UIAlertView alloc] 
                initWithTitle: @"Delete" 
                message: @"Do you really want to delete “George W. Bush”?" 
                delegate: self
                cancelButtonTitle: @"Cancel"
                otherButtonTitles: @"Of course!", nil];
    }
} 
```

……或者更标准的动作可能是：

```
[itemList removeObjectAtIndex:indexPath.row];
[table deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:YES]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-03T18:11:35.867

@JFMartin and Marco - to replace the standard 'Delete' button use the following UITableview delegate method

```
- (NSString *)tableView:(UITableView *)tableView titleForDeleteConfirmationButtonForRowAtIndexPath:(NSIndexPath *)indexPath 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-13T11:00:51.340

UITableViewCell 上有一个名为的属性，`editAction`它被记录为允许您更改用于在单个单元格上插入或删除的操作（它也使用单元格的`target`属性）。我尚未对其进行测试，但这听起来可能会满足您的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T03:42:26.790

我将实现 UITableViewCell 的子类并在其中处理触摸事件。您可能必须自己完成所有动画制作，但我认为这可能是最简单的解决方案。没有更改删除按钮的“支持”方法，我不认为

# svn - 崩溃的 SVN 存储库

> ID：360016
> 
> 赞同：0
> 
> 时间：2008-12-11T16:42:04.843
> 
> 标签：svn, crash, windows-server-2003, repository

今天，我们存储 SVN 存储库的虚拟 W2003 服务器（也）变得非常非常繁忙。原来它在 C: 驱动器上只剩下 88KB 的可用空间。没那么好。由于访问问题，我们可以通过从任务管理器（McAffee、SqlServer、services.exe）中杀死繁忙的进程然后优雅地重新启动来重新启动它的唯一方法。我们释放了一些空间，机器又开心了，但我们的 SVN 存储库不再可用。

如果我从客户端连接，它会给出消息“ *No repository found in 'svn://[mymachine]/repos/[myapp]'* ”但是，从服务器我可以使用“ *svnlook tree [rootFolder]* ”看到内容命令。

如果我使用 Windows 资源管理器导航到根文件夹，则以下文件夹为空（我不知道这是否正常）：

*   *[根文件夹]/trunk*
*   *[根文件夹]/标签*
*   *[根文件夹]/分支*

但是，*[rootFolder]/db*包含许多具有相应修订名称的文件。头部的大小应该在 600MB 左右，但我们也有许多分支。[rootFolder] 的总大小现在约为 600MB。我们松了树枝吗？明天我们还将知道我们的备份系统是否运行良好。无论如何，有人有任何想法吗？

*[找到解决方案后更新]*

感谢所有提交答案的人，他们在解决问题方面非常有用。崩溃期间，SVN 服务被破坏，而数据保持完好。重新安装服务解决了这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T16:54:32.510

在存储库框中，尝试修复和验证。

```
svnadmin repair [rootFolder]
svnadmin verify [rootFolder] 
```

如果这没有帮助，希望您的备份有效。

不要太担心大小与头部大小有关。分支就像符号链接，只存储通常很小的差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T16:56:40.523

听起来你只需要重新启动`svnserve`。

如果您按照[Subversion Book](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.svnserve.html#svn.serverconfig.svnserve.invoking.winservice)设置服务`sc`：

```
net start [service]

net start subversion 
```

或者，直接：（理论上......我自己使用`sc`and `net`）

```
svnserve.exe --service -r [rootFolder] 
```

# .net - 如何在 .net 中以编程方式设置连接字符串配置？

> ID：360024
> 
> 赞同：61
> 
> 时间：2008-12-11T16:44:53.467
> 
> 标签：.net, configuration, connection-string

我想以编程方式设置连接字符串，绝对不会更改任何配置文件/注册表项。

我有这段代码，但不幸的是它抛出了“配置是只读的”异常。

```
ConfigurationManager.ConnectionStrings.Clear();
string connectionString = "Server=myserver;Port=8080;Database=my_db;...";
ConnectionStringSettings connectionStringSettings = 
  new ConnectionStringSettings("MyConnectionStringKey", connectionString);
ConfigurationManager.ConnectionStrings.Add(connectionStringSettings); 
```

**编辑：** 问题是我有从配置中读取连接字符串的现有代码。因此，手动或通过资源设置配置字符串似乎不是有效的选项。我真正需要的是一种以编程方式修改配置的方法。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2008-12-18T11:29:00.747

[我在我的博客上的一篇文章](http://davidgardiner.blogspot.com/2008/09/programmatically-setting.html)中写过这个。诀窍是使用反射来插入值作为访问非公共字段（和方法）的一种方式。

例如。

```
var settings = ConfigurationManager.ConnectionStrings[ 0 ];

var fi = typeof( ConfigurationElement ).GetField( "_bReadOnly", BindingFlags.Instance | BindingFlags.NonPublic );

fi.SetValue(settings, false);

settings.ConnectionString = "Data Source=Something"; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-07-31T15:41:12.187

解决此问题的另一种方法是直接对集合进行操作：

```
var settings = ConfigurationManager.ConnectionStrings;
var element = typeof(ConfigurationElement).GetField("_bReadOnly", BindingFlags.Instance | BindingFlags.NonPublic);
var collection = typeof(ConfigurationElementCollection).GetField("bReadOnly", BindingFlags.Instance | BindingFlags.NonPublic);

element.SetValue(settings, false);
collection.SetValue(settings, false);

settings.Add(new ConnectionStringSettings("ConnectionStringName", connectionString));

// Repeat above line as necessary

collection.SetValue(settings, true);
element.SetValue(settings, true); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-09-20T11:06:48.750

我正在寻找关于允许用户通过选择本地 SQL Server 在单击一次应用程序中修改连接字符串的相同问题的答案。

下面的代码显示了一个用户表单，它联系所有本地可用的 SQL Server 并允许他们选择一个。然后它为该服务器构造一个连接字符串，并从表单上的一个变量中返回它。然后代码修改配置文件并保存它。

```
string NewConnection = "";
// get the user to supply connection details
frmSetSQLConnection frm = new frmSetSQLConnection();
frm.ShowDialog();
if (frm.DialogResult == DialogResult.OK)
{
    // here we set the users connection string for the database
    // Get the application configuration file.
    System.Configuration.Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
    // Get the connection strings section.
    ConnectionStringsSection csSection = config.ConnectionStrings;
    foreach (ConnectionStringSettings connection3 in csSection.ConnectionStrings)
    {
        // Here we check for the preset string - this could be done by item no as well
        if (connection3.ConnectionString == "Data Source=SQL204\\SQL2008;Initial Catalog=Transition;Integrated Security=True")
        {
             // amend the details and save
             connection3.ConnectionString = frm.Connection;
             NewConnection = frm.Connection;
             break;
        }
    }
    config.Save(ConfigurationSaveMode.Modified);
    // reload the config file so the new values are available

    ConfigurationManager.RefreshSection(csSection.SectionInformation.Name);

    return clsDBMaintenance.UpdateDatabase(NewConnection))
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-08-21T15:42:01.693

我发现这对我有用：

```
Configuration config = WebConfigurationManager.OpenWebConfiguration("~");
ConnectionStringsSection section = config.GetSection("connectionStrings") as         ConnectionStringsSection;
if (section != null)
{
    section.ConnectionStrings["MyConnectionString"].ConnectionString = connectionString;
    config.Save();
} 
```

这会覆盖现有的连接字符串。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-11T16:57:48.043

我目前正在使用依赖注入来处理 dev/prod 与测试环境中的不同连接字符串。如果我想在 dev 和 prod 之间移动，我仍然必须手动更改 webconfig，但是为了测试，我有一个 IConnectionStringFactory 接口，它有一个查看 web 配置的默认实现和一个返回静态值的替代测试配置。这样，当我测试时，我只需将工厂设置为测试实现，它将返回测试连接字符串以获取我要求的密钥。否则它将在 webconfig 中查找。

我可以将其扩展到 dev 与 prod 的另一个实现，但我更愿意在我的生产程序集中使用 IConnectionStringFactory 的单个实现，在我的测试程序集中使用测试实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T16:50:49.740

您可以将其放在资源文件中。它没有 ConfigurationManager 类的内置功能，但可以工作。

假设 Resources.resx：

`Resources.Default.ConnectionString = "Server=myserver;" // etc`

然后在您的代码中：

`conn.ConnectionString = Resources.Default.ConnectionString`

这是一个黑客，我知道。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T10:10:42.217

除了给出的其他答案，并且假设连接字符串不仅仅是另一个配置变量或整体常量，您可能会考虑使用[SqlConnectionStringBuilder](https://docs.microsoft.com/en-US/dotnet/api/system.data.sqlclient.sqlconnectionstringbuilder?redirectedfrom=MSDN&view=netframework-4.7.2)类而不是直接将字符串连接在一起。

编辑：Ups，抱歉刚刚看到您基本上想从另一个来源读取您的连接字符串（我猜是完整的）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-19T19:46:16.833

从 .net Core 2.1 起，名称似乎已更改 修改 David Gardiner 的回答 这种方式应该适用于引用新旧版本：

var 设置 = ConfigurationManager.ConnectionStrings[0]；

```
var fi = typeof( ConfigurationElement ).GetField( "_bReadOnly", BindingFlags.Instance | BindingFlags.NonPublic );

if(fi == null)
{
  fi = typeof(System.Configuration.ConfigurationElementCollection).GetField("_readOnly", BindingFlags.Instance | BindingFlags.NonPublic);
}

fi.SetValue(settings, false);

settings.ConnectionString = "Data Source=Something"; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-11T16:55:53.567

ConfigurationManager 用于*读取*配置文件。

您的解决方案是简单地将 conn.ConnectionString 设置为您需要的 conn 字符串。

# java - Hibernate：如果子级以多对一的方式链接到父级，则在删除父级时如何使 Hibernate 从子表中删除记录？

> ID：360026
> 
> 赞同：5
> 
> 时间：2008-12-11T16:45:07.693
> 
> 标签：java, mysql, database, hibernate, cascade

可以说我有两个表 - 具有多对一关系的“子”和“父”。如果父记录被删除，我需要删除子条目。

如果我通过在 parent.hbm 中创建一对多关联并设置 cascade="all-delete-orphan" 来链接父表的子表，这不是问题。

问题是我不想在父端建立一对多的关系，所以我在子端创建了多对一。原因是子表很大，我不想每次使用父表时都提取数百条记录。所以我的配置是这样的：

child.hbm:

```
<many-to-one name="parent" class="com.example.Parent" column="parentid"/> 
```

而 parent.hbm 与孩子没有关联。

问题是：**如果子级以多对一的方式链接到父级，则在删除父级时如何使 Hibernate 从子表中删除记录？**

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T20:09:34.927

几个选项：

*   使用级联删除将一对多添加到父级，但使用延迟加载减轻性能损失。

*   使用[Hibernate 拦截器](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Interceptor.html)（或 AOP 环境中的方面）来检测父记录删除和删除子记录。

我个人倾向于第一个选项，因为它可以让您的数据模型更紧密地反映数据中的真实关系。

**编辑：**还有第三种选择，但它并不令人愉快 - 使用数据库触发器，并刷新您的 Hibernate 缓存（或使用非缓存会话）。

# release - 您应该多久发布一次软件更新？

> ID：360028
> 
> 赞同：17
> 
> 时间：2008-12-11T16:45:29.550
> 
> 标签：release, release-management

不久前[，杰夫阿特伍德在推特上说](http://twitter.com/codinghorror/status/1051535711)：

> 看，我喜欢快速发布新软件，但 WordPress 发布的频率实在是太荒谬了。

这让我想到，**您应该多久发布一次软件更新？**

*   日常？
*   每周？
*   每月？
*   每年？

最好的发布策略是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-11T16:57:57.650

我想说，在 WordPress 的特定情况下，**它们将“安全更新”和“功能更新”混为一谈**。这是不好的。

这就像每次发现安全漏洞时都必须就地重新安装 Windows，而不是每周简单地下载一个小补丁。

WordPress 需要有一个简单、快速、易于安全更新的安全补丁机制。与新版本的正常升级流程不同的过程。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T16:50:18.743

Wordpress 发布的频率如此频繁，因为他们关心安全性并发布能够尽快修复已知漏洞的更新。对 Wordpress 的功能更新发生的频率要低得多，我认为在每 4 到 6 个月的范围内。

我认为这是一个很好的模型。通过定期发布新功能让您的客户满意，但如果您发现安全漏洞，请立即发布修复程序。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-11T16:57:58.977

我将建议以下内容：

updateTime (in seconds) - 用户执行更新的平均时间

releaseDelta（以天为单位） - 发布之间的最短时间

```
releaseDelta = updateTime/((1/365)*(60*60*8)) 
```

这个公式基于我的理论，即用户在任何一年中等待应用程序更新的时间都不应超过 8 小时。

这也允许频繁更新，只要更新以透明的方式完成，而不会干扰最终用户。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T16:49:04.347

我认为这在很大程度上取决于您的具体情况。话虽如此，我认为任何严肃的商业应用程序的每日发布都是完全可笑的。如果您每天都发布，那么可能会出现严重问题，除非您处于业务规则不断变化或类似情况的非常奇怪的情况下。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T16:49:49.493

比 iTunes 更新频率低。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-11T16:55:20.357

我尝试使用以下（希望是简单的）两部分指南：

1.  如果它要求用户下载和/或安装某些东西，或者更改他们维护的现有代码库，那么版本需要提供显着的优点。此版本添加了重要的新功能，修复了大量问题，或修复了较少数量的紧迫问题。
2.  如果它不需要用户下载和/或安装版本，则将计划发生，如迭代所指示的。如果在迭代结束时有一个可发布的产品，它将被部署。迭代将包含在迭代开始之前确定的技术和业务需求。

因此，对我们而言，桌面应用程序或 Web 服务之类的东西通常属于第一条规则，而我们的网站之类的东西则属于第二条规则。我们进行了相当大的迭代——目前大约需要四到六周的开发时间，明年会减少到两到四周。这是我们对 Scrum 混合的“介绍”。

请注意，产品不必总是处于开发阶段（或参与迭代）。如果第一条规则适用，那么产品很可能会保持陈旧状态，直到需要进行更改。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-11T21:50:42.227

这取决于客户对配置控制的方法。

他们有选择，你知道的。最终他们可以选择不使用你的产品。

如果客户愿意接受你每天更换的东西，而且他们不在乎，而且对培训或配置管理没有影响；有自动更新。

拥有 SOE（标准操作环境）的客户讨厌更新。

意识到有些客户不会接受“打电话回家”的软件。他们将希望托管自己的更新。他们的 IT 人员将不得不参与进来。这对他们来说是更多的工作。

一些客户想要/需要自己做 QA；取决于客户和软件类型。

如果客户需要进行测试/工作以接受/部署软件，请发布测试/部署周期长度的一些倍数。除非客户对交错部署和测试感到满意。这就是他们一直在测试新版本并推出的地方。

例如：2周测试，不超过每8周发布一次。

在结果关键软件中，发布测试可能需要客户数月时间。他们将自己的业务押在结果上，并且有理由保持谨慎。所以每 6 个月左右发布一次。

在安全关键软件中，可能需要几个月的时间。每年或大约每 18 个月一次并不少见。甚至更少是很正常的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-11T16:51:28.693

没有正确的答案，这真的取决于产品。

我说最多每月一次。每周/每天太频繁了，当然除非应用程序更新是以自动化和透明的方式完成的，例如 Firefox 的更新系统

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-11T16:51:58.677

您可以根据需要随时释放它们。让用户感到沮丧的是不知道他们是否需要您的新版本。这意味着您需要非常清楚自己实现了哪些新功能、修复了哪些错误以及是否修复了任何安全问题。更重要的是，您的用户希望能够相信，如果他们确实安装了新版本，则没有任何问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-11T16:52:18.520

我认为如果可能的话，**您应该**在需要时自动更新您的软件，以**使整个更新过程尽可能顺畅且**对用户不可见。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-11T16:55:10.607

对于我工作的领域，工业控制，很少见。我们通常会在 2 年内发布一个主要版本。次要版本可能每 3 到 6 个月发布一次。错误补丁当然是另一回事，它们会根据需要发布。即使这样，也很少有客户会升级现有系统。当然在其他领域，升级更容易被接受。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-11T16:54:55.753

当然，当您有值得发布的新功能/错误修复时？为什么要按计划进行？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-11T16:58:36.403

我不反对安全漏洞一经发现就得到修复——尽管我希望他们首先编写更健壮的代码。我反对（至少就 Wordpress 而言）是增强版本，它可能会破坏插件发生得太快。从 2.5 到 2.6 需要多长时间？并且 2.7 也将很快发布。

自动或半自动升级可以缓解一些问题，但前提是插件编写者也升级，或者如果他们将安全修复与功能更改分开，这样我就可以坚持使用 2.5，但仍保持最新的安全性补丁，直到我确定我使用的所有插件都适用于 2.6 或 2.7 或（到那时）4.0。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-11T17:23:48.597

每当需要它们时。请记住，一些用户觉得定期更新更安全，而另一些用户则对每天弹出“有 129 个新更新要安装！单击此处等待 20 分钟下载，然后再安装 10 个！”感到恼火。 ……你明白我的意思。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-12T02:25:14.200

这取决于升级的性质和完成升级所需的用户干预量。

如果是网站，你可以每天升级，只要不破坏任何东西。

如果它是免费的安全更新，我们总是很感激尽快。

免费的错误修复升级，如果必须由用户安装，不应该超过每两个月。

任何必须支付的费用都不能超过一年一次，否则人们会开始感到被利用了。对于某些类别的软件（例如操作系统）更是如此。

# java - 将数组中的变量直接设置为 Java 中的变量列表

> ID：360030
> 
> 赞同：0
> 
> 时间：2008-12-11T16:46:06.007
> 
> 标签：java, function, return

我有一个返回双精度数组的 Java 方法。然后我想将这些值存储在调用函数的各个变量中。在Java中是否有一种优雅的方式来做到这一点。

我可以这样写：

```
double[] returnValues = calculateSomeDoubles();
double firstVar  = returnValues[0];
double secondVar = returnValues[1]; 
```

我只是想知道是否有某种方法可以将其压缩为一行？就像是：

```
(firstVar, secondVar) = calculateSomeDoubles(); 
```

这种类型的事情在编写脚本时很容易，但 Java 的强大类型意味着它可能是不可能的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T17:03:51.837

基本上不，这是不可能的。

您必须返回一个包含这些值的对象。

```
MyObject myObject = calculateMyObject(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T16:52:04.450

唯一的方法是使用反射，前提是您事先知道“calculateSomeDouble”方法将返回多少项。

***[这](https://stackoverflow.com/questions/271109/iterate-static-int-values-in-java#271127)***将需要一个变体。但正如您所见，还有更多需要编写的代码。

那么提出的问题是？你想要这个自动化的东西吗？还是为了节省开发时间（避免复制/粘贴）？

如果您想自动化某些任务（例如在运行时填充对象），那么值得进行反射调用并编写方法。

您将需要设置该值，而不仅仅是打印它。

客户端调用应如下所示

```
 SomeUtility.fill( myObject , withDoublesFromMethod() ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T17:34:00.997

当您不希望获得 2 个双精度值时，您可以通过引用调用您的方法 usig 调用

```
void methode(double[] array) 
```

您可以提交一个长度为 2 的数组并将值放在方法旁边。

或者，如果返回的值可以更改，则返回 Collection。

```
List methode() 
```

我不是返回值的朋友

```
double[] methode() 
```

当您使用列表或集合时，方法不像您处理数组那样是静态的。您可以在其他项目中更好地重用该方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T17:40:05.600

我的第一反应是质疑你做这种事情的动机。如果您的程序中有一组相关的双精度数，为什么不将它们存储在一个列表中？

如果你是你可以做这样的事情：

```
List<Double> myVars = Arrays.asList(calculateSomeDoubles()); 
```

但是，如果您必须将它们存储在单独的变量中，则无法在一行中干净地完成。我建议您*不要*使用一些建议的基于反射的解决方案。按照您最初的建议，简单地在多行中写出您的作业可能会好得多。

# python - 在python中的N个单词后拆分HTML

> ID：360036
> 
> 赞同：7
> 
> 时间：2008-12-11T16:47:38.530
> 
> 标签：python, html, plone, zope

有没有办法在 N 个单词之后拆分一长串 HTML？显然我可以使用：

```
' '.join(foo.split(' ')[:n]) 
```

获取纯文本字符串的前 n 个单词，但这可能会在 html 标签的中间拆分，并且不会生成有效的 html，因为它不会关闭已打开的标签。

我需要在 zope / plone 站点中执行此操作 - 如果这些产品中有标准可以执行此操作，那将是理想的。

例如，假设我有以下文字：

```
<p>This is some text with a 
  <a href="http://www.example.com/" title="Example link">
     bit of linked text in it
  </a>.
</p> 
```

我要求它在 5 个单词后拆分，它应该返回：

```
<p>This is some text with</p> 
```

7个字：

```
<p>This is some text with a 
  <a href="http://www.example.com/" title="Example link">
     bit
  </a>
</p> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T18:03:44.803

看看 django.utils.text 中的[truncate_html_words](http://code.djangoproject.com/browser/django/trunk/django/utils/text.py)函数。即使您不使用 Django，那里的代码也完全符合您的要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T16:58:58.243

听说[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)非常擅长解析html。它可能能够帮助您获得正确的 html。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T17:07:16.230

我要提到的是用 Python 构建的基本[HTMLParser](http://docs.python.org/library/htmlparser.html#module-HTMLParser)，因为我不确定你想要达到的最终结果是什么，它可能会或可能不会让你到达那里，你将主要使用处理程序

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T18:24:11.800

你可以混合使用正则表达式、BeautifulSoup 或 Tidy（我更喜欢 BeautifulSoup）。这个想法很简单——首先去掉所有的 HTML 标签。找到第 n 个单词（这里 n=7），找到第 n 个单词出现在字符串中的次数，直到 n 个单词 - 因为你只寻找最后一次出现以用于截断。

这是一段代码，虽然有点乱但有效

```
import re
from BeautifulSoup import BeautifulSoup
import tidy

def remove_html_tags(data):
    p = re.compile(r'<.*?>')
    return p.sub('', data)

input_string='<p>This is some text with a <a href="http://www.example.com/" '\
    'title="Example link">bit of linked text in it</a></p>'

s=remove_html_tags(input_string).split(' ')[:7]

###required to ensure that only the last occurrence of the nth word is                                                                                      
#  taken into account for truncating.                                                                                                                       
#  coz if the nth word could be 'a'/'and'/'is'....etc                                                                                                       
#  which may occur multiple times within n words                                                                                                            
temp=input_string
k=s.count(s[-1])
i=1
j=0
while i<=k:
    j+=temp.find(s[-1])
    temp=temp[j+len(s[-1]):]
    i+=1
####                                                                                                                                                        
output_string=input_string[:j+len(s[-1])]

print "\nBeautifulSoup\n", BeautifulSoup(output_string)
print "\nTidy\n", tidy.parseString(output_string) 
```

输出是你想要的

```
BeautifulSoup
<p>This is some text with a <a href="http://www.example.com/" title="Example link">bit</a></p>

Tidy
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<meta name="generator" content=
"HTML Tidy for Linux/x86 (vers 6 November 2007), see www.w3.org">
<title></title>
</head>
<body>
<p>This is some text with a <a href="http://www.example.com/"
title="Example link">bit</a></p>
</body>
</html> 
```

希望这可以帮助

**编辑：**更好的正则表达式

```
`p = re.compile(r'<[^<]*?>')` 
```

# inno-setup - 在 Inno Setup 中，是否可以将条件语句添加到 [Run] 部分执行的内容中？

> ID：360037
> 
> 赞同：10
> 
> 时间：2008-12-11T16:47:58.513
> 
> 标签：inno-setup

或者是否可以手动更新内置进度条？基本上，我包含 2 个 MSI，并使用 Inno Setup 作为引导程序，并且根据用户输入，将安装一个或两个 MSI。我在 CurStepChanged 中使用 Exec 语句进行了一些工作，但是在提取文件时它不会更新进度条，并且看起来安装程序已停止。我想最终结果是我想要一些进度条更新，同时将文件提取到临时文件夹。以下是我当前的代码：

```
procedure CurStepChanged(CurStep: TSetupStep);
var
    ResultCode: Integer;
begin
    if(CurStep = ssInstall) then begin
        if(InstallServer) then begin
            ExtractTemporaryFile('ServerSetup.msi');
            Exec('msiexec',ExpandConstant('/i "{tmp}\ServerSetup.msi" /qb INSTALLDIR="{code:GetInstallPath}\Server\" ALLUSERS=2'),'', SW_SHOW, ewWaitUntilTerminated, ResultCode);
        end;
        if(InstallClient) then begin
            ExtractTemporaryFile('ClientSetup.msi');
            Exec('msiexec',ExpandConstant('/i "{tmp}\ClientSetup.msi" /qb INSTALLDIR="{code:GetInstallPath}\Client\" ALLUSERS=2'),'', SW_SHOW, ewWaitUntilTerminated, ResultCode);
        end;
    end;
end; 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-11T17:53:34.153

为什么不简单地尝试这样的事情：

```
[Files]
Source: ClientSetup.msi; DestDir: {tmp}; Flags: deleteafterinstall; Components: Client
Source: ServerSetup.msi; DestDir: {tmp}; Flags: deleteafterinstall; Components: Server

[Run]
Filename: msiexec.exe; Parameters: /i "{tmp}\ClientSetup.msi" /qb INSTALLDIR="{code:GetInstallPath}\Client\" ALLUSERS=2; WorkingDir: {tmp}; StatusMsg: Installing client; Components: Client
Filename: msiexec.exe; Parameters: /i "{tmp}\ServerSetup.msi" /qb INSTALLDIR="{code:GetInstallPath}\Server\" ALLUSERS=2; WorkingDir: {tmp}; StatusMsg: Installing server; Components: Server

[Components]
Name: Client; Description: Client Installation
Name: Server; Description: Server Installation 
```

当然，您不一定必须使用`Components`. 您没有写出如何决定运行哪个安装程序。如果您需要更复杂的逻辑，您还可以使用以下[`Check`函数](http://www.jrsoftware.org/ishelp/topic_scriptcheck.htm)：

```
[Files]
Source: ClientSetup.msi; DestDir: {tmp}; Flags: deleteafterinstall; Check: CheckClient
Source: ServerSetup.msi; DestDir: {tmp}; Flags: deleteafterinstall; Check: CheckServer

[Run]
Filename: msiexec.exe; Parameters: /i "{tmp}\ClientSetup.msi" /qb INSTALLDIR="{code:GetInstallPath}\Client\" ALLUSERS=2; WorkingDir: {tmp}; StatusMsg: Installing client; Check: CheckClient
Filename: msiexec.exe; Parameters: /i "{tmp}\ServerSetup.msi" /qb INSTALLDIR="{code:GetInstallPath}\Server\" ALLUSERS=2; WorkingDir: {tmp}; StatusMsg: Installing server; Check: CheckServer

[Code]
function CheckClient: Boolean;
begin
  Result := WhateverCondition;
end;

function CheckServer: Boolean;
begin
  Result := WhateverOtherCondition;
end; 
```

# algorithm - 哈希查找和二分查找哪个更快？

> ID：360040
> 
> 赞同：74
> 
> 时间：2008-12-11T16:48:12.290
> 
> 标签：algorithm, hash, hashmap, lookup, binary-search

当给定一组静态对象（从某种意义上说是静态的，一旦加载它就很少改变），需要以最佳性能重复并发查找，哪个更好，`HashMap`或者使用一些自定义比较器进行二进制搜索的数组？

答案是对象还是结构类型的函数？散列和/或相等的函数性能？哈希唯一性？列表大小？ `Hashset`尺寸/设置尺寸？

我正在查看的集合的大小可以从 500k 到 10m 不等——以防该信息有用。

虽然我正在寻找 C# 答案，但我认为真正的数学答案不在于语言，所以我不包括那个标签。但是，如果需要注意 C# 特定的事情，则需要该信息。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-12-11T16:52:00.080

对于非常小的集合，差异将可以忽略不计。在您的范围的低端（500k 项），如果您进行大量查找，您将开始看到差异。二进制搜索将是 O(log n)，而哈希查找将是 O(1)，[摊销](https://stackoverflow.com/questions/200384/constant-amortized-time)。这与真正的常数不同，但您仍然必须拥有一个非常糟糕的哈希函数才能获得比二分搜索更差的性能。

（当我说“可怕的哈希”时，我的意思是：

```
hashCode()
{
    return 0;
} 
```

是的，它本身非常快，但会导致您的哈希映射成为链表。）

[ialashkevich](https://stackoverflow.com/a/28566419/1288)使用数组和字典编写了一些 C# 代码来比较这两种方法，但它使用 Long 值作为键。我想测试在查找过程中实际执行哈希函数的东西，所以我修改了那个代码。我将其更改为使用字符串值，并将填充和查找部分重构为它们自己的方法，以便在分析器中更容易看到。我还保留了使用 Long 值的代码，作为比较点。最后，我摆脱了自定义的二进制搜索功能，并使用了`Array`课堂上的那个。

这是代码：

```
class Program
{
    private const long capacity = 10_000_000;

    private static void Main(string[] args)
    {
        testLongValues();
        Console.WriteLine();
        testStringValues();

        Console.ReadLine();
    }

    private static void testStringValues()
    {
        Dictionary<String, String> dict = new Dictionary<String, String>();
        String[] arr = new String[capacity];
        Stopwatch stopwatch = new Stopwatch();

        Console.WriteLine("" + capacity + " String values...");

        stopwatch.Start();

        populateStringArray(arr);

        stopwatch.Stop();
        Console.WriteLine("Populate String Array:      " + stopwatch.ElapsedMilliseconds);

        stopwatch.Reset();
        stopwatch.Start();

        populateStringDictionary(dict, arr);

        stopwatch.Stop();
        Console.WriteLine("Populate String Dictionary: " + stopwatch.ElapsedMilliseconds);

        stopwatch.Reset();
        stopwatch.Start();

        Array.Sort(arr);

        stopwatch.Stop();
        Console.WriteLine("Sort String Array:          " + stopwatch.ElapsedMilliseconds);

        stopwatch.Reset();
        stopwatch.Start();

        searchStringDictionary(dict, arr);

        stopwatch.Stop();
        Console.WriteLine("Search String Dictionary:   " + stopwatch.ElapsedMilliseconds);

        stopwatch.Reset();
        stopwatch.Start();

        searchStringArray(arr);

        stopwatch.Stop();
        Console.WriteLine("Search String Array:        " + stopwatch.ElapsedMilliseconds);

    }

    /* Populate an array with random values. */
    private static void populateStringArray(String[] arr)
    {
        for (long i = 0; i < capacity; i++)
        {
            arr[i] = generateRandomString(20) + i; // concatenate i to guarantee uniqueness
        }
    }

    /* Populate a dictionary with values from an array. */
    private static void populateStringDictionary(Dictionary<String, String> dict, String[] arr)
    {
        for (long i = 0; i < capacity; i++)
        {
            dict.Add(arr[i], arr[i]);
        }
    }

    /* Search a Dictionary for each value in an array. */
    private static void searchStringDictionary(Dictionary<String, String> dict, String[] arr)
    {
        for (long i = 0; i < capacity; i++)
        {
            String value = dict[arr[i]];
        }
    }

    /* Do a binary search for each value in an array. */
    private static void searchStringArray(String[] arr)
    {
        for (long i = 0; i < capacity; i++)
        {
            int index = Array.BinarySearch(arr, arr[i]);
        }
    }

    private static void testLongValues()
    {
        Dictionary<long, long> dict = new Dictionary<long, long>(Int16.MaxValue);
        long[] arr = new long[capacity];
        Stopwatch stopwatch = new Stopwatch();

        Console.WriteLine("" + capacity + " Long values...");

        stopwatch.Start();

        populateLongDictionary(dict);

        stopwatch.Stop();
        Console.WriteLine("Populate Long Dictionary: " + stopwatch.ElapsedMilliseconds);

        stopwatch.Reset();
        stopwatch.Start();

        populateLongArray(arr);

        stopwatch.Stop();
        Console.WriteLine("Populate Long Array:      " + stopwatch.ElapsedMilliseconds);

        stopwatch.Reset();
        stopwatch.Start();

        searchLongDictionary(dict);

        stopwatch.Stop();
        Console.WriteLine("Search Long Dictionary:   " + stopwatch.ElapsedMilliseconds);

        stopwatch.Reset();
        stopwatch.Start();

        searchLongArray(arr);

        stopwatch.Stop();
        Console.WriteLine("Search Long Array:        " + stopwatch.ElapsedMilliseconds);
    }

    /* Populate an array with long values. */
    private static void populateLongArray(long[] arr)
    {
        for (long i = 0; i < capacity; i++)
        {
            arr[i] = i;
        }
    }

    /* Populate a dictionary with long key/value pairs. */
    private static void populateLongDictionary(Dictionary<long, long> dict)
    {
        for (long i = 0; i < capacity; i++)
        {
            dict.Add(i, i);
        }
    }

    /* Search a Dictionary for each value in a range. */
    private static void searchLongDictionary(Dictionary<long, long> dict)
    {
        for (long i = 0; i < capacity; i++)
        {
            long value = dict[i];
        }
    }

    /* Do a binary search for each value in an array. */
    private static void searchLongArray(long[] arr)
    {
        for (long i = 0; i < capacity; i++)
        {
            int index = Array.BinarySearch(arr, arr[i]);
        }
    }

    /**
     * Generate a random string of a given length.
     * Implementation from https://stackoverflow.com/a/1344258/1288
     */
    private static String generateRandomString(int length)
    {
        var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        var stringChars = new char[length];
        var random = new Random();

        for (int i = 0; i < stringChars.Length; i++)
        {
            stringChars[i] = chars[random.Next(chars.Length)];
        }

        return new String(stringChars);
    }
} 
```

以下是几种不同大小的集合的结果。（时间以毫秒为单位。）

> 500000 长值...
> 填充长字典：26
> 填充长数组：2
> 搜索长字典：9
> 搜索长数组：80
> 
> 500000 个字符串值...
> 填充字符串数组：1237
> 填充字符串字典：46
> 排序字符串数组：1755
> 搜索字符串字典：27
> 搜索字符串数组：1569
> 
> 1000000 长值...
> 填充长字典：58
> 填充长数组：5
> 搜索长字典：23
> 搜索长数组：136
> 
> 1000000 个字符串值...
> 填充字符串数组：2070
> 填充字符串字典：121
> 排序字符串数组：3579
> 搜索字符串字典：58
> 搜索字符串数组：3267
> 
> 3000000 长值...
> 填充长字典：207
> 填充长数组：14
> 搜索长字典：75
> 搜索长数组：435
> 
> 3000000 字符串值...
> 填充字符串数组：5553
> 填充字符串字典：449
> 排序字符串数组：11695
> 搜索字符串字典：194
> 搜索字符串数组：10594
> 
> 10000000 长值...
> 填充长字典：521
> 填充长数组：47
> 搜索长字典：202
> 搜索长数组：1181
> 
> 10000000 字符串值...
> 填充字符串数组：18119
> 填充字符串字典：1088
> 排序字符串数组：28174
> 搜索字符串字典：747
> 搜索字符串数组：26503

为了比较，这是程序最后一次运行的分析器输出（1000 万条记录和查找）。我强调了相关的功能。他们非常同意上面的秒表计时指标。

[![用于 1000 万条记录和查找的 Profiler 输出](https://i.stack.imgur.com/wzhDA.png)](https://i.stack.imgur.com/wzhDA.png)

您可以看到字典查找比二分查找快得多，并且（正如预期的那样）集合越大，差异越明显。所以，如果你有一个合理的散列函数（相当快，几乎没有冲突），散列查找应该胜过二进制搜索在这个范围内的集合。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-12-11T16:54:03.197

Bobby、Bill 和 Corbin 的答案是错误的。对于固定/有界 n，O(1) 不比 O(log n) 慢：

log(n) 是常数，所以它取决于常数时间。

对于慢速散列函数，听说过 md5 吗？

默认的字符串散列算法可能涉及所有字符，并且很容易比长字符串键的平均比较慢 100 倍。去过也做过。

您可能能够（部分）使用基数。如果您可以分成 256 个大致相同大小的块，那么您正在查看 2k 到 40k 的二进制搜索。这可能会提供更好的性能。

[编辑] 太多人投票否决他们不理解的内容。

用于二进制搜索排序集的字符串比较有一个非常有趣的特性：它们越接近目标越慢。首先他们会在第一个字符上中断，最后只在最后一个字符上中断。假设他们的时间恒定是不正确的。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-12-11T16:50:51.503

这个问题唯一合理的答案是：视情况而定。这取决于数据的大小、数据的形状、哈希实现、二进制搜索实现以及数据所在的位置（即使问题中没有提到）。其他几个答案也说了这么多，所以我可以删除它。但是，将我从反馈中学到的内容分享给我的原始答案可能会很好。

1.  我写道，“*哈希算法是 O(1)，而二进制搜索是 O(log n)。* ” - 正如评论中所指出的，大 O 表示法估计复杂性，而不是速度。这是绝对正确的。值得注意的是，我们通常使用复杂度来了解算法的时间和空间要求。因此，虽然假设复杂性与速度完全一样是愚蠢的，但在没有时间或空间的情况下估计复杂性是不寻常的。我的建议：避免使用大 O 符号。
2.  我写道，“*所以当 n 接近无穷大*......” - 这是我可以在答案中包含的最愚蠢的事情。无穷大与您的问题无关。你提到了1000万的上限。无视无穷。正如评论者所指出的，非常大的数字会产生各种散列问题。（非常大的数字也不会让二进制搜索在公园里散步。）我的建议：除非您的意思是无限，否则不要提及无限。
3.  同样来自评论：当心默认字符串散列（你在散列字符串吗？你没有提到。），数据库索引通常是 b-trees（值得深思）。我的建议：考虑你所有的选择。考虑其他数据结构和方法......比如老式的[trie](https://en.wikipedia.org/wiki/Trie)（用于存储和检索字符串）或[R-tree](https://en.wikipedia.org/wiki/R-tree)（用于空间数据）或[MA-FSA](http://stevehanov.ca/blog/index.php?id=115)（最小无环有限状态自动机 - 小存储空间）。

鉴于评论，您可能会认为使用哈希表的人精神错乱。哈希表是鲁莽和危险的吗？这些人疯了吗？

事实证明他们不是。正如二叉树擅长某些事情（按顺序数据遍历、存储效率）一样，哈希表也有其大放异彩的时刻。特别是，它们可以非常擅长减少获取数据所需的读取次数。哈希算法可以生成一个位置并直接在内存或磁盘上跳转到该位置，而二进制搜索在每次比较期间读取数据以确定接下来要读取的内容。每次读取都有可能导致缓存未命中，这比 CPU 指令慢一个数量级（或更多）。

这并不是说哈希表比二分查找更好。他们不是。这也不意味着所有哈希和二进制搜索实现都是相同的。他们不是。如果我有一个观点，那就是：这两种方法的存在都是有原因的。由您决定哪个最适合您的需求。

原答案：

* * *

> 哈希算法是 O(1)，而二进制搜索是 O(log n)。因此，当 n 接近无穷大时，哈希性能相对于二分查找有所提高。您的里程将根据 n、您的哈希实现和您的二进制搜索实现而有所不同。
> 
> [关于 O(1) 的有趣讨论](https://stackoverflow.com/questions/332952/whats-up-with-o1)。释义：
> 
> O(1) 并不意味着瞬时。这意味着性能不会随着 n 大小的增长而改变。你可以设计一个非常慢的散列算法，没有人会使用它，它仍然是 O(1)。但是，我相当确定 .NET/C# 不会受到成本过高的散列的影响；）

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-12-11T17:33:24.897

好的，我会尽量简短。

C# 简短回答：

测试两种不同的方法。

.NET 为您提供了通过一行代码改变方法的工具。否则，请使用 System.Collections.Generic.Dictionary 并确保使用大量初始化它作为初始容量，否则由于 GC 必须执行收集旧存储桶数组的工作，您将在余生中插入项目。

更长的答案：

哈希表具有几乎恒定的查找时间，并且在现实世界中获取哈希表中的项目不仅需要计算哈希。

要获取某个项目，您的哈希表将执行以下操作：

*   获取密钥的哈希
*   获取该哈希的桶号（通常映射函数看起来像这个桶 = hash % bucketsCount）
*   遍历从该存储桶开始的项目链（基本上它是共享相同存储桶的项目列表，大多数哈希表使用这种处理存储桶/哈希冲突的方法）并将每个键与您尝试添加的项目之一进行比较/删除/更新/检查是否包含。

查找时间取决于您的哈希函数有多“好”（输出有多稀疏）和快，您使用的桶数以及键比较器的速度有多快，这并不总是最好的解决方案。

更好更深入的解释：[http ://en.wikipedia.org/wiki/Hash_table](http://en.wikipedia.org/wiki/Hash_table "维基百科：哈希表")

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-11T21:40:54.397

如果您的对象集是真正静态且不变的，则可以使用[完美哈希](http://en.wikipedia.org/wiki/Minimal_perfect_hashing)来保证 O(1) 性能。我见过几次提到[gperf](http://www.gnu.org/software/gperf/)，虽然我自己从来没有机会使用它。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-11T16:58:07.153

哈希通常更快，尽管二进制搜索具有更好的最坏情况特征。哈希访问通常是通过计算获得哈希值以确定记录将在哪个“桶”中，因此性能通常取决于记录分布的均匀程度以及用于搜索桶的方法。对桶进行线性搜索的不良哈希函数（留下一些包含大量记录的桶）将导致搜索缓慢。（另一方面，如果您读取的是磁盘而不是内存，则哈希桶可能是连续的，而二叉树几乎可以保证非本地访问。）

如果您希望通常快速，请使用哈希。如果你真的想要保证有界的性能，你可以选择二叉树。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-11T23:04:27.413

令人惊讶的是，没有人提到 Cuckoo 散列，它提供了保证 O(1)，并且与完美散列不同，它能够使用它分配的所有内存，而完美散列最终可以保证 O(1)，但浪费了它的大部分分配。警告？插入时间可能非常慢，尤其是当元素数量增加时，因为所有优化都是在插入阶段执行的。

我相信其中的某些版本在路由器硬件中用于 ip 查找。

见[链接文字](http://en.wikipedia.org/wiki/Cuckoo_hashing)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-02-17T16:40:03.403

与数组相比，字典/哈希表使用更多内存并且需要更多时间来填充。但是通过字典而不是数组内的二进制搜索来完成搜索更快。

这是要搜索和填充的**1000**万个**Int64项目的数字。**加上您可以自己运行的示例代码。

字典内存： **462,836**

阵列内存： **88,376**

填充字典：**402**

填充阵列： **23**

搜索词典： **176**

搜索数组： **680**

```
using System;
using System.Collections.Generic;
using System.Diagnostics;

namespace BinaryVsDictionary
{
    internal class Program
    {
        private const long Capacity = 10000000;

        private static readonly Dictionary<long, long> Dict = new Dictionary<long, long>(Int16.MaxValue);
        private static readonly long[] Arr = new long[Capacity];

        private static void Main(string[] args)
        {
            Stopwatch stopwatch = new Stopwatch();

            stopwatch.Start();

            for (long i = 0; i < Capacity; i++)
            {
                Dict.Add(i, i);
            }

            stopwatch.Stop();

            Console.WriteLine("Populate Dictionary: " + stopwatch.ElapsedMilliseconds);

            stopwatch.Reset();

            stopwatch.Start();

            for (long i = 0; i < Capacity; i++)
            {
                Arr[i] = i;
            }

            stopwatch.Stop();

            Console.WriteLine("Populate Array:      " + stopwatch.ElapsedMilliseconds);

            stopwatch.Reset();

            stopwatch.Start();

            for (long i = 0; i < Capacity; i++)
            {
                long value = Dict[i];
//                Console.WriteLine(value + " : " + RandomNumbers[i]);
            }

            stopwatch.Stop();

            Console.WriteLine("Search Dictionary:   " + stopwatch.ElapsedMilliseconds);

            stopwatch.Reset();

            stopwatch.Start();

            for (long i = 0; i < Capacity; i++)
            {
                long value = BinarySearch(Arr, 0, Capacity, i);
//                Console.WriteLine(value + " : " + RandomNumbers[i]);
            }

            stopwatch.Stop();

            Console.WriteLine("Search Array:        " + stopwatch.ElapsedMilliseconds);

            Console.ReadLine();
        }

        private static long BinarySearch(long[] arr, long low, long hi, long value)
        {
            while (low <= hi)
            {
                long median = low + ((hi - low) >> 1);

                if (arr[median] == value)
                {
                    return median;
                }

                if (arr[median] < value)
                {
                    low = median + 1;
                }
                else
                {
                    hi = median - 1;
                }
            }

            return ~low;
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-11T17:11:30.730

我强烈怀疑在大小约为 1M 的问题集中，散列会更快。

只是为了数字：

二分查找需要~ 20 次比较（2^20 == 1M）

哈希查找需要对搜索键进行 1 次哈希计算，之后可能需要进行少量比较以解决可能的冲突

编辑：数字：

```
 for (int i = 0; i < 1000 * 1000; i++) {
        c.GetHashCode();
    }
    for (int i = 0; i < 1000 * 1000; i++) {
        for (int j = 0; j < 20; j++)
            c.CompareTo(d);
    } 
```

时间：c = "abcde"，d = "rwerij" 哈希码：0.0012 秒。比较：2.4 秒。

免责声明：实际上对哈希查找与二进制查找进行基准测试可能比这个不完全相关的测试更好。我什至不确定 GetHashCode 是否在后台被记忆

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-11T16:54:54.007

我想说这主要取决于哈希和比较方法的性能。例如，当使用非常长但随机的字符串键时，比较总是会产生非常快的结果，但默认哈希函数将处理整个字符串。

但在大多数情况下，哈希映射应该更快。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-11T21:46:06.570

我想知道为什么没有人提到[完美散列](http://en.wikipedia.org/wiki/Perfect_hash_function)。

仅当您的数据集长期固定时才有意义，但它会分析数据并构造一个完美的哈希函数以确保没有冲突。

非常简洁，如果您的数据集是恒定的并且与应用程序运行时间相比计算函数的时间很短。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-11T16:53:40.203

这取决于您如何处理哈希表的重复项（如果有的话）。如果您确实希望允许哈希键重复（没有完美的哈希函数），主键查找仍然是 O(1)，但在后面搜索“正确”值可能代价高昂。答案是，理论上大多数时候，散列更快。YMMV 取决于你放在那里的数据......

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-11T18:00:34.017

[这里](http://cs.unc.edu/~plaisted/comp122/13-hashing.ppt)描述了哈希是如何构建的，并且因为键的宇宙相当大，并且哈希函数被构建为“非常内射”，因此很少发生冲突，哈希表的访问时间实际上不是 O(1) ......基于某些概率的东西。但是，可以合理地说，哈希的访问时间几乎总是小于时间 O(log_2(n))

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-08-17T19:03:15.850

这个问题比纯算法性能的范围更复杂。如果我们去掉二分查找算法对缓存更友好的因素，散列查找在一般意义上更快。最好的解决方法是构建一个程序并禁用编译器优化选项，我们可以发现哈希查找更快，因为它的算法时间效率在一般意义上是 O(1)。

但是，当您启用编译器优化并尝试使用较少的样本（例如少于 10,000 个）进行相同的测试时，通过利用其缓存友好的数据结构，二分查找优于哈希查找。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-11T16:59:53.560

当然，对于这么大的数据集，哈希是最快的。

由于数据很少更改，因此加快速度的一种方法是以编程方式生成临时代码以将第一层搜索作为一个巨大的 switch 语句（如果您的编译器可以处理它），然后分支到搜索结果桶。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-01-22T11:09:55.100

答案取决于。让我们认为元素“n”的数量非常大。如果您擅长编写更好的散列函数以减少冲突，那么散列是最好的。 **请注意，** 哈希函数仅在搜索时执行一次，并指向相应的存储桶。所以如果 n 很高，这不是一个很大的开销。
**哈希表中的问题：** 但是哈希表中的问题是，如果哈希函数不好（发生更多冲突），那么搜索就不是 O(1)。它趋向于 O(n)，因为在桶中搜索是线性搜索。可能比二叉树更糟糕。 **二叉树中的问题：** 在二叉树中，如果树不平衡，它也趋向于 O(n)。例如，如果您将 1,2,3,4,5 插入到更可能是列表的二叉树中。 **所以，** 如果你能看到一个好的散列方法，使用散列表如果没有，你最好使用二叉树。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-01-01T10:30:35.243

这更像是对比尔答案的评论，因为他的答案有很多赞成票，即使它是错误的。所以我不得不发布这个。

我看到很多关于在哈希表中查找的最坏情况复杂性是什么的讨论，以及什么被认为是摊销分析/什么不是。请检查下面的链接

[哈希表运行时复杂度（插入、搜索和删除）](https://stackoverflow.com/questions/9214353/hash-table-runtime-complexity-insert-search-and-delete)

与比尔所说的相反，最坏情况的复杂性是 O(n) 而不是 O(1)。因此他的 O(1) 复杂度没有被摊销，因为这种分析只能用于最坏的情况（他自己的维基百科链接也是这样说的）

[https://en.wikipedia.org/wiki/Hash_table](https://en.wikipedia.org/wiki/Hash_table)

[https://en.wikipedia.org/wiki/Amortized_analysis](https://en.wikipedia.org/wiki/Amortized_analysis)

# sql-server - SQL Server 数据库邮件的 Web 前端

> ID：360047
> 
> 赞同：1
> 
> 时间：2008-12-11T16:49:51.990
> 
> 标签：sql-server, email

SQL Server 2005 引入了[数据库邮件](http://msdn.microsoft.com/en-us/library/ms175887.aspx)，用于以稳健的方式从 SQL Server 数据库引擎发送电子邮件。数据库邮件带有许多有趣的[视图](http://msdn.microsoft.com/en-us/library/ms188023.aspx)，例如`sysmail_allitems`、`sysmail_sentitems`、`sysmail_faileditems`、和。在这些视图之上是否有任何已知的独立且友好的 Web 前端（最好在 ASP.NET 中）可供管理员（理想情况下也是用户）用于故障排除和监控？`sysmail_unsentitems``sysmail_mailattachments``sysmail_event_log`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T07:51:08.150

不，那里没有。您可以手动查询 DMV 以查看其中的数据。设置任何类型的漂亮界面都没有多大用处，因为除了查看它们之外，您无法对这些 DMV 做任何事情。

数据库邮件是一个非常强大的系统。

您要解决哪些具体问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T17:37:16.690

据我所知没有。什么样的用户会在后端闲逛——他们会做什么？设置完成后，邮件过程似乎运行得非常顺利。您是否经常遇到问题？

# language-agnostic - 是否有替代超缩进代码的方法？

> ID：360063
> 
> 赞同：8
> 
> 时间：2008-12-11T16:52:21.517
> 
> 标签：language-agnostic, coding-style, indentation

我经常遇到必须执行大量检查的代码，最终在真正做任何事情之前至少要缩进五六级。我想知道存在哪些替代方案。

下面我发布了一个我正在谈论的示例（这不是实际的生产代码，只是我想出的东西）。

```
public String myFunc(SomeClass input)
{
    Object output = null;

    if(input != null)
    {
        SomeClass2 obj2 = input.getSomeClass2();
        if(obj2 != null)
        {
            SomeClass3 obj3 = obj2.getSomeClass3();
            if(obj3 != null && !BAD_OBJECT.equals(obj3.getSomeProperty()))
            {
                SomeClass4 = obj3.getSomeClass4();
                if(obj4 != null)
                {
                    int myVal = obj4.getSomeValue();
                    if(BAD_VALUE != myVal)
                    {
                        String message = this.getMessage(myVal);
                        if(MIN_VALUE <= message.length() &&
                           message.length() <= MAX_VALUE)
                        {
                            //now actually do stuff!
                            message = result_of_stuff_actually_done;
                        }
                    }
                }
            }
        }
    }
    return output;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-11T16:54:39.017

请参阅[展平箭头代码](http://www.codinghorror.com/blog/archives/000486.html)以获取帮助。

> 1.  用保护条款替换条件。
> 2.  将条件块分解为单独的函数。
> 3.  将否定检查转换为肯定检查。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-11T16:54:44.087

早点回来：

```
if (input == null) {
    return output;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-11T17:49:05.770

## 是的，有一个替代方案。

并且请永远不要这样编码（除非您正在维护自己的代码）

我不得不维护这样的代码，并且像 Charles_Bronsonn 的电影一样糟糕（尽管有些人喜欢那些电影）

无论如何，这种代码通常来自过程语言，例如 C（是 C 过程：P）。

这就是 ObjectOrientedProgrammng 成为主流的原因。它允许您创建对象并向它们添加状态。创建具有该状态的操作。他们不仅是财产持有者。

我知道您编造了这种情况，但大多数情况下，所有这些条件都是**业务规则！**. 大多数情况下，这些规则会发生变化，如果原始开发人员不再存在（或者已经过去几个月），就没有可行的方法来修改该代码。规则很难读。很多痛苦由此而来。

## 你能做什么？

**1.) 使用私有**成员变量（AKA 属性、属性、实例变量等）将对象的状态保持在对象内部

2.) 将方法设为私有（这就是访问级别的用途），因此没有人可以错误地调用它们并将程序置于 NullPointerException 领域。

3.) 创建定义条件的方法。这就是他们所说的*自我记录代码*

所以而不是

```
// validates the user has amount
if( amount > other && that != var || startsAligned() != false  ) {
} 
```

创建一个方法

```
if( isValidAmount() ) {
}

private boolean isValidAmount() {
   return ( amount > other && that != var || startsAligned() != false  );
} 
```

我知道它看起来很冗长，但允许人类能够阅读代码。编译器不关心可读性。

那么使用这种方法看起来像你的超嵌套呢？

像这样。

```
// these are business rules
// then it should be clear that those rules are
// and what they do.

// internal state of the object.
private SomeClass2 obj2;
private SomeClass3 obj3;
private SomeClass4 obj4;

//public String myFunc( SomeClass input ) {
public String myComplicatedValidation( SomeClass input ) {
    this.input = input;
    if ( isValidInput() && 
        isRuleTwoReady() &&
        isRuleTreeDifferentOf( BAD_OBJECT ) &&
        isRuleFourDifferentOf( BAD_VALUE ) && 
        isMessageLengthInRenge( MIN_VALUE , MAX_VALUE ) ) { 
                message = resultOfStuffActuallyDone();
    }
}

// These method names are self explaining what they do.
private final boolean  isValidInput() {
    return  this.input != null;
}
private final boolean isRuleTwoReady() {
    obj2 = input.getSomeClass2();
    return obj2 != null ;
}
private final boolean isRuleTreeDifferentOf( Object badObject ) {
    obj3 = obj2.getSomeClass3();
    return obj3 != null && !badObject.equals( obj3.getSomeProperty() );
}
private final boolean isRuleFourDifferentOf( int badValue ) {
    obj4 = obj3.getSomeClass4();
    return obj4 != null && obj4.getSomeValue() != badValue;
}
private final boolean isMessageLengthInRenge( int min, int max ) {
    String message = getMessage( obj4.getSomeValue() );
    int length = message.length();
    return length >= min && length <= max;
} 
```

我知道，它看起来像更多的编码。但是想想这个。规则几乎是人类可读的

```
 if ( isValidInput() && 
        isRuleTwoReady() &&
        isRuleTreeDifferentOf( BAD_OBJECT ) &&
        isRuleFourDifferentOf( BAD_VALUE ) && 
        isMessageLengthInRenge( MIN_VALUE , MAX_VALUE ) ) { 
                message = resultOfStuffActuallyDone();
    } 
```

几乎可以读作

```
if is valid input 
and rule two is ready 
and rule three is not BAD OBJECT 
and rule four is no BAD_VALUE 
and the message length is in range 
```

并且通过保持规则的变化很小，编码人员可以很容易地理解它们，而不用害怕刹车。

可以在以下位置阅读更多信息：**[http ://www.refactoring.com/](http://www.refactoring.com/)**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T16:56:36.127

是的，您可以按如下方式删除缩进：

基本上按顺序进行检查，并与失败而不是成功进行比较。它消除了嵌套并使其更易于遵循（IMO）。

```
public String myFunc(SomeClass input)
{
    Object output = null;

    if (input == null)
    {
        return null;
    }

    SomeClass2 obj2 = input.getSomeClass2();
    if (obj2 == null)
    { 
        return null;
    }

    SomeClass3 obj3 = obj2.getSomeClass3();
    if (obj3 == null || BAD_OBJECT.equals(obj3.getSomeProperty()))
    {
        return null;
    }

    SomeClass4 = obj3.getSomeClass4();
    if (obj4 == null)
    {
        return null;
    }
    int myVal = obj4.getSomeValue();
    if (BAD_VALUE == myVal)
    {
        return null;
    }
    String message = this.getMessage(myVal);
    if (MIN_VALUE <= message.length() &&
       message.length() <= MAX_VALUE)
    {
        //now actually do stuff!
        message = result_of_stuff_actually_done;
    }
    return output;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T16:54:49.717

您可以使用保护子句摆脱一些嵌套。

```
public String myFunc(SomeClass input)
{
    Object output = null;

    if(input == null) return "";

    SomeClass2 obj2 = input.getSomeClass2();
    if(obj2 == null) return "";

    SomeClass3 obj3 = obj2.getSomeClass3();
    if(obj3 == null || BAD_OBJECT.equals(obj3.getSomeProperty()))
    {
        return "";
    }

    SomeClass4 = obj3.getSomeClass4();
    if(obj4 == null) return "";

    int myVal = obj4.getSomeValue();
    if(BAD_VALUE == myVal) return "";

    String message = this.getMessage(myVal);
    if(MIN_VALUE <= message.length() &&
           message.length() <= MAX_VALUE)
    {
         //now actually do stuff!
         message = result_of_stuff_actually_done;
    }

    return output;
} 
```

`return "";`不过，将我用来说明这一点的所有语句更改为引发描述性各种异常的语句。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T16:58:19.053

如果您不需要处理停止，请不要嵌入。

例如，您可以这样做：

```
if(input == null && input.getSomeClass2() == null && ...)
    return null;

// Do what you want. 
```

假设您正在使用像 Java 这样对条件进行排序的语言。

或者，您可以：

```
if(input == null && input.getSomeClass2() == null)
    return null;

SomeClass2 obj2 = input.getSomeClass2();
if(obj2 == null)
    return null;

...

// Do what you want. 
```

对于更复杂的情况。

如果您不需要处理，这个想法是从该方法返回。嵌入一​​个大的嵌套 if 几乎是不可能的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T17:08:21.187

如果这只是一个可读性问题，您可以通过将嵌套移动到另一种方法来使其更清晰。如果您愿意，还可以转换为后卫风格。

```
public String myFunc(SomeClass input)
{
    Object output = null;

    if (inputIsValid(input))
    {
      //now actually do stuff!
      message = result_of_stuff_actually_done;
    } 

    return output;
}

private bool inputIsValid(SomeClass input)
{

    // *****************************************
    // convert these to guard style if you like   
    // ***************************************** 
    if(input != null)
    {
        SomeClass2 obj2 = input.getSomeClass2();
        if(obj2 != null)
        {
            SomeClass3 obj3 = obj2.getSomeClass3();
            if(obj3 != null && !BAD_OBJECT.equals(obj3.getSomeProperty()))
            {
                SomeClass4 = obj3.getSomeClass4();
                if(obj4 != null)
                {
                    int myVal = obj4.getSomeValue();
                    if(BAD_VALUE != myVal)
                    {
                        String message = this.getMessage(myVal);
                        if(MIN_VALUE <= message.length() &&
                           message.length() <= MAX_VALUE)
                        {
                            return true;
                        }
                    }
                }
            }
        }
    }
    return false;
} 
```

# sql-server - 新服务器的 SQL Server tempdb 优化技巧？

> ID：360088
> 
> 赞同：17
> 
> 时间：2008-12-11T16:57:50.913
> 
> 标签：sql-server, performance, configuration, tempdb

我计划在一台新机器上全新安装**SQL Server 2005**，我必须订购。我知道**tempdb 调优**对 SQL Server 实例的整体**性能**非常重要。

我读过最好的做法是创建与 CPU（或内核？）一样多的 tempdb 文件。那是对的吗？是否有任何其他建议，例如我应该注意的硬盘/RAID 设置配置？

*谢谢！*

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-12T12:41:34.023

*这是我从各种来源进行的研究。*

为了优化 tempdb 性能，请注意物理磁盘配置、文件配置以及数据库内部的一些设置。

**物理磁盘配置**

tempdb 应该驻留在它**自己的专用物理磁盘上**。这允许它从 SQL Server 上的其余卷中拆分 I/O 事务。

要将 tempdb 移动到新磁盘驱动器，请使用`ALTER DATABASE`. 它是执行此操作的关键 T-SQL 命令。Microsoft 在 SQL Server 2005 联机丛书中提供了一个很好的示例。文章名称是 ALTER DATABASE (Transact-SQL)，具体部分是*'G. 将 tempdb 移动到新位置。*

tempdb 是一个非常高写入的数据库。因此，RAID 5 阵列不适合它。您应该将 tempdb**放在 RAID 0 或 RAID 10 阵列**上，因为它们已针对高写入应用程序进行了优化。如果您可以为 tempdb 的每个物理数据库文件提供额外的 RAID 0 或 RAID 10 阵列，您将获得更高的性能。

**数据库文件**

**服务器中的每个 CPU 核心**应该有一个物理文件。所以，如果你有一个双芯片、双核服务器，你应该有四个用于 tempdb 数据库的物理数据库文件。添加更多数据库文件时，将文件配置为**相同的初始大小和相同的增长设置**非常重要。这样，SQL Server 将尽可能均匀地跨文件写入数据。

**数据库文件大小**

tempdb 数据库的大小会影响系统的性能。例如，如果为 tempdb 定义的大小太小，则系统处理负载的一部分可能会**被自动增长的 tempdb 占用到每次重新启动 SQL Server 实例时支持工作负载所需的大小**。您可以通过增加 tempdb 数据和日志文件的大小来避免这种开销。

在生产环境中确定适当的 tempdb 大小取决于许多因素，包括现有工作负载和使用的 SQL Server 功能。Microsoft 建议您通过在 SQL Server**测试**环境中执行以下任务来分析现有工作负载：

1.  为 tempdb 设置自动增长*（在测试环境中！）*。
2.  执行单个查询或工作负载跟踪文件并监控 tempdb 空间使用情况。
3.  执行索引维护操作，例如重建索引和监控 tempdb 空间。
4.  使用前面步骤中的空间使用值来预测您的总工作负载使用情况；为预计的并发活动调整此值，然后相应地设置 tempdb 的大小。

tempdb 的最小大小建议如下：

```
 Envir. Size  DB Size (MB)  Log Size (MB)
   -----------  ------------  -------------
   Small                1024            256
   Medium               5120           1024
   Large               10024           2048 
```

**数据库设置**

**您可以通过禁用自动更新统计信息**来进一步提高 tempdb 性能，这将为您的 tempdb 节省一些工作。您还可以将**自动创建统计信息选项设置为 false**。

*免责声明：应谨慎更改设置。根据您对 tempdb 施加的负载类型，更改设置可能会对系统性能产生不利影响。*

要获得最佳 tempdb 性能，请遵循[优化 tempdb 性能](http://msdn.microsoft.com/en-us/library/ms175527.aspx)中提供的指南和建议。

**如何监控 tempdb 的使用情况？**

**tempdb 中的磁盘空间不足**会**导致 SQL Server 生产环境严重中断**，并可能阻止正在运行的应用程序完成操作。

您可以使用`sys.dm_db_file_space_usage`动态管理视图来监控这些功能在 tempdb 文件中使用的磁盘空间。此外，要在会话或任务级别监视 tempdb 中的页面分配或解除分配活动，您可以使用`sys.dm_db_session_space_usage`动态`sys.dm_db_task_space_usage`管理视图。

这些视图可用于识别使用大量 tempdb 磁盘空间的大型查询、临时表或表变量。还有几个计数器可用于监视 tempdb 中的可用空间以及正在使用 tempdb 的资源。

**链接：**

*   Microsoft Technet：[在 SQL Server 2005 中使用 tempdb](http://www.microsoft.com/technet/prodtechnol/sql/2005/workingwithtempdb.mspx)
*   SearchSQLServer.com：SQL [Server tempdb 最佳实践提高性能](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1307255,00.html)
*   MSDN 库：[优化 tempdb 性能](http://msdn.microsoft.com/en-us/library/ms175527.aspx)
*   SearchSQLServer.com：[配置 SQL Server 2005 TempDB 以提高性能](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1180698,00.html)
*   MSDN 库：[tempdb 的容量规划](http://msdn.microsoft.com/en-us/library/ms345368.aspx)
*   MSDN 库：[对 tempdb 中的磁盘空间不足进行故障排除](http://msdn.microsoft.com/en-us/library/ms176029.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T17:22:57.727

另请参阅此发布的[SQL Server 事务日志 RAID](https://stackoverflow.com/questions/294408/sql-server-transaction-log-raid#294539)，其中包含有关服务器布局的讨论，涉及有关 tempdb 的一些问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T17:14:13.330

根据我的阅读，最好将 tempDB 放在它自己的物理磁盘（或阵列）上。为了获得最大速度，您可以放入 raid 0 阵列。但是，如果其中一个磁盘发生故障，数据库服务器将无法运行。如果您想要更多冗余，请将其放在 raid 10 阵列上。真正的关键似乎是将它与其他数据库分开，因为 TempDB 中可能有如此多的活动。

你能走多远真的取决于服务器上的其他数据库以及它们是否对临时表等进行了大量工作。

我还没有听说过关于基于 CPU 或内核数量的多个文件的任何信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T00:31:23.423

我建议在 1/2 和 1/4 * 核心数之间创建数据文件。您应该将这些文件放在您拥有的最快的磁盘上

有关详细信息，您可以查看此处： [SQL Server tempdb 配置](http://www.sqlserveroptimizer.com/2013/03/how-to-configure-sql-server-tempdb-for-optimal-performance/)

# virtual-pc - 跨越多个文件的虚拟 PC 硬盘？

> ID：360094
> 
> 赞同：1
> 
> 时间：2008-12-11T16:58:26.713
> 
> 标签：virtual-pc

我花了过去几个小时搜索，但似乎无法找到答案。希望这里有人知道。

我想使用 Virtual PC 2007 创建虚拟机，但我希望 VM 的硬盘位于 USB 硬盘上。我不担心虚拟机的性能，我只是希望虚拟机离开我的主硬盘。问题是 USB 硬盘是 FAT32 格式的，我更愿意保持这种格式。在 VMWare 中，可以将硬盘“分块”成 2 GB 的文件，以便适合主机硬盘驱动器。在 VPC 中是否可以做类似的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T17:08:29.720

“如果磁盘映像变得大于主机文件系统上支持的最大文件大小，Microsoft Virtual Server 2005 之前的版本支持拆分磁盘映像。

某些文件系统（例如 FAT32 文件系统）对文件大小有 4 GB 的限制。如果硬盘映像扩展超过 4 GB，Microsoft Virtual PC 2004 和以前的版本会将硬盘映像拆分为另一个文件。拆分文件没有任何页眉或页脚，只有原始数据。最后一个拆分文件的页脚存储在文件末尾。拆分磁盘映像中的第一个文件具有 .vhd 的扩展名。以下拆分文件使用 .v01、.v02、... 文件扩展名。拆分文件将与主硬盘映像位于同一目录中。可以存在的最大拆分文件数为 64。拆分文件的大小无法更改。”

[http://www.wirwar.com/blog/2007/10/26/splitting-a-virtual-pc-vhd/](http://www.wirwar.com/blog/2007/10/26/splitting-a-virtual-pc-vhd/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-02T12:44:32.583

这里解释了如何拆分 vhd 文件（如果上面答案中的链接不起作用）： http: [//leonzandman.com/2007/10/26/splitting-a-virtual-pc-vhd/](http://leonzandman.com/2007/10/26/splitting-a-virtual-pc-vhd/)

# .net - 我可以跳过 MIME 解析来获取附件吗？

> ID：360097
> 
> 赞同：1
> 
> 时间：2008-12-11T16:58:44.343
> 
> 标签：.net, vb.net, windows-mobile, mime

我是新来的，所以首先向你问好

我正在编写一个在我的 Windows Mobile（掌上电脑）上运行的应用程序。仅供参考，我正在使用 VB.NET。

我的想法是在我的提供商处使用我的电子邮件帐户，该提供商给了我很多 GB:s 供我使用，作为虚拟在线存储磁盘。简而言之，或多或少类似于您可能已经阅读过的 GMAIL 驱动器。我已经编写了代码来使用 telnet-socket 连接到我的提供商的 SMTP、POP3 和 IMAP 帐户。我可以登录，因此到目前为止一切顺利。

在我的具体情况下，我对电子邮件本身不感兴趣，但实际上附件将是我在这个虚拟存储卡上的文件。我发现了很多免费课程，主要是 C#，用于下载带有附件的电子邮件，最重要的是 MIME 解析。不幸的是，所有这些类都以一种或另一种方式使用了 Net Framework 的类/命名空间，这些类/命名空间不包含在 Windows Mobile 使用的 NET Compact Framework 中。对于我和我的知识来说，自己编写一个 MIME 解析器太复杂了。

因此，至少关于我通过 POP3 或 IMAP 接收的代码，我在想，一旦我下载了设备上的所有字节，我只需解析完整的电子邮件（验证边界在哪里）并获取部分(s) 已在 Base64 中编码，然后使用我在发送时在电子邮件的主题字段中写入的文件的名称和扩展名对其进行解码并重命名。通过这种方式，我也许可以避免所有关于 MIME 及其所有含义的东西......

怎么样，通过 SMTP 发送，我仍然需要调查它。任何想法，将不胜感激。

对不起这个浪漫 - 你怎么看 - 我可以跳过获取 MIME 解析器而只使用普通的字符串解析吗？

亲切的问候，莫斯特67

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T17:04:21.367

MIME 解析器只是一个字符串解析器。它们很容易编写，特别是如果您知道您只想要/需要 MIME 类型的子集。查找 RFC 并自己实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T17:12:19.400

您可以尝试在邮件标题中查找[边界](http://en.wikipedia.org/wiki/MIME#Multipart_messages)，然后在此字符串上拆分电子邮件。恕我直言，解析子部分是必要的（想到编码和字符集；在大多数情况下，仅删除标头是行不通的），但比一次处理整个消息要容易一些。

提醒一句：这是一种脆弱的方法——它适用于某些消息，但会破坏其他消息（例如嵌套的多部分消息、更改边界字符串（不应该，但可能发生）等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-01T20:10:22.800

编写邮件消息的字符串解析器实际上是编写一个简单的 MIME 解析器。您可以在几个小时内编写一个快速而简单的 MIME 解析器。如果您将使用它来解析类似的邮件（例如，由同一客户端软件从一个位置发送），它应该是您所需要的。

有关 MIME 的详细信息，请参阅

*   [RFC 2045](http://www.ietf.org/rfc/rfc2045.txt)
*   [RFC 2046](http://www.ietf.org/rfc/rfc2046.txt)
*   [RFC 2047](http://www.ietf.org/rfc/rfc2047.txt)
*   [RFC 2048](http://www.ietf.org/rfc/rfc2048.txt)
*   [RFC 2049](http://www.ietf.org/rfc/rfc2049.txt)
*   RFC 847、3217、3370、3852、3851、3850 也是相关的，但您可以跳过它们开始

几天的工作应该是现实的。我参与了一个简单的内部 MIME 解析器的开发（花了几天时间破解并解析了 95% 的收到的电子邮件），它涉及到一个商业产品（几个月的工作、大量的单元测试和数百封非常奇怪的测试电子邮件从野外），然后进行了修改，以便可以在 Compact Framework 中使用（由于内存受限的设备而发生的变化，由于只有一小部分 .NET 框架被移植到 .NET CF 而发生的变化）。并添加对大部分 CryptoAPI 功能的重写，以使签名和加密的 S/MIME 电子邮件在 .NET CF 上工作。

MIME 解析器是 Rebex Secure Mail for .NET/.NET CF 组件的一部分，可以从[http://www.rebex.net/secure-mail.net/下载](http://www.rebex.net/secure-mail.net/)

支持所有版本的 .NET 和 .NET CF。甚至 .NET CF1 恐龙 ;-)。但是，它不是免费的。

# c# - 有没有办法在不指定每种情况的情况下将对象转换回原始类型？

> ID：360111
> 
> 赞同：2
> 
> 时间：2008-12-11T17:01:34.867
> 
> 标签：c#, casting, syslog, udpclient

我有一个不同类型对象的数组，我使用 BinaryWriter 将每个项目转换为其二进制等效项，以便我可以通过网络发送结构。

我目前正在做类似的事情

```
for ( i=0;i<tmpArrayList.Count;i++)
{
   object x=tmpArrayList[i];
   if (x.GetType() ==  typeof(byte))
   {
      wrt.Write((byte)x);
   }
   ........ 
```

问题是，如果错过了它们的类型，我的代码将来可能会中断。

我想做类似的事情。

```
object x=tmpArrayList[i];
wrt.Write(x); 
```

但除非我每次都做演员，否则它不起作用。

编辑：

在咨询了答案之后，这就是我想出的功能。为了测试这个函数，将数组发送到 syslog。

```
 private void TxMsg(ArrayList TxArray,IPAddress ipaddress)
  {
     Byte[] txbuf=new Byte[0];
     int sz=0;

     // caculate size of txbuf
     foreach (Object o in TxArray)
     {
        if ( o is String ) 
        {
           sz+=((String)(o)).Length;
        }
        else if ( o is Byte[] )
        {
           sz+=((Byte[])(o)).Length;
        }
        else if ( o is Char[] )
        {
           sz+=((Char[])(o)).Length;
        }
        else // take care of non arrays
        {
           sz+=Marshal.SizeOf(o);
        }
     }
     txbuf = new Byte[sz];

     System.IO.MemoryStream stm_w = new System.IO.MemoryStream( txbuf, 0,txbuf.Length);
     System.IO.BinaryWriter wrt = new System.IO.BinaryWriter( stm_w );

     foreach (Object o in TxArray)
     {
        bool otypefound=false;
        if (o is String) // strings need to be sent one byte per char
        {
           otypefound=true;
           String st=(String)o;
           for(int i=0;i<st.Length;i++)
           {
              wrt.Write((byte)st[i]);
           }
        }
        else
        {
           foreach (MethodInfo mi in typeof(BinaryWriter).GetMethods())
           {
              if (mi.Name == "Write")
              {
                 ParameterInfo[] pi = mi.GetParameters();
                 if ((pi.Length == 1)&&(pi[0].ParameterType==o.GetType()))
                 {
                    otypefound=true;
                    mi.Invoke(wrt, new Object[] { o });
                 }
              }
           }
        }
        if(otypefound==false)
        {
           throw new InvalidOperationException("Cannot write data of type " + o.GetType().FullName);
        }
     }
     IPEndPoint endpoint = new IPEndPoint(ipaddress, 514); //syslog port
     UdpClient udpClient_txmsg = new UdpClient();
     udpClient_txmsg.Send(txbuf, txbuf.Length,endpoint); // send udp packet to syslog             
  } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-11T17:05:16.857

不。强制转换必须在编译时知道，但实际类型只在执行时知道。

但是请注意，有更好的方法来测试调用 GetType 的类型。代替：

```
if (x.GetType() == typeof(byte)) 
```

采用：

```
if (x is byte) 
```

编辑：回答额外的问题：

“所有类型是什么？” 好吧，我想看看 BinaryWriter 的文档...

“我需要担心字节和字节吗？” 不，byte 是 C# 中 System.Byte 的别名。他们是同一类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T17:09:30.733

乔恩是对的，但我有另一个想法，你可能会觉得有用。您是否考虑过在每个对象的传输中添加另一个字节，然后将该字节用作类型代码，告诉您在另一端将其转换为什么？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T17:41:26.817

您是否考虑过使用[BinaryFormatter](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter(VS.80).aspx)而不是 BinaryWriter？

**好处**

*   您可以传递*object* s（即任何东西），因此它解决了您的铸造问题。
*   自动类型管理（实际上将类型标头写入流）。
*   也支持复杂的引用类型。

**缺点**

在内部使用序列化，因此：

*   应该比较慢吧。
*   字节流变大（由于类型标头）。
*   您无法控制字节格式，因此在互操作方案中不是一个选项。
*   潜在的版本问题（序列化类型的不同程序集版本之间的兼容性）。
*   需要序列化代码访问权限（部分信任场景相关）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T18:07:15.140

这是使用反射的 BinaryWriter 的解决方案。

这基本上扫描 BinaryWriter 以查找名为 Write 的方法，该方法只接受一个参数，然后构建一个字典，其中哪个方法处理哪种类型，然后为每个要写入的对象，找到正确的方法并在 writer 上调用它。

肮脏，您可能应该寻找更好的方法来完成整个事情（不仅仅是写作部分），但它应该适合您当前的需求：

```
using System.IO;
using System;
using System.Reflection;
using System.Collections.Generic;
namespace ConsoleApplication14
{
    public class Program
    {
        public static void Main()
        {
            Dictionary<Type, MethodInfo> mapping = new Dictionary<Type, MethodInfo>();
            foreach (MethodInfo mi in typeof(BinaryWriter).GetMethods())
            {
                if (mi.Name == "Write")
                {
                    ParameterInfo[] pi = mi.GetParameters();
                    if (pi.Length == 1)
                        mapping[pi[0].ParameterType] = mi;
                }
            }

            List<Object> someData = new List<Object>();
            someData.Add((Byte)10);
            someData.Add((Int32)10);
            someData.Add((Double)10);
            someData.Add((Char)10);
            someData.Add("Test");

            using (FileStream file = new FileStream(@"C:\test.dat", FileMode.Create, FileAccess.ReadWrite))
            using (BinaryWriter writer = new BinaryWriter(file))
            {
                foreach (Object o in someData)
                {
                    MethodInfo mi;
                    if (mapping.TryGetValue(o.GetType(), out mi))
                    {
                        mi.Invoke(writer, new Object[] { o });
                    }
                    else
                        throw new InvalidOperationException("Cannot write data of type " + o.GetType().FullName);
                }
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T17:15:33.107

您要的是**Dynamic Dispatch**，而 C# 3.0 没有它。

您至少应该使用运行时检查来验证您没有丢失类型。

`Dictionary`如果您有从类型映射到处理函数的映射，您也许可以做一些聪明的事情。您可以在一处填写所有处理功能的映射。与在处理发生的任何地方编写开关相比，您更有可能做到这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T17:29:38.180

这是需要称为[Double Dispatch](http://c2.com/cgi/wiki?DoubleDispatch)的情况。

我将假设 wrt 对象是您自己编写的对象（假设它是 Writer 类型）。这是您可以执行的操作：

```
class Writer
{
    void write(byte b)
    {
        // write bytes here
    }

    void write(Writable something)
    {
        something.writeOn(this);
    }
}

interface Writeable
{
    void writeOn(Writer writer);
}

class SomeObject implements Writeable
{
    private Object someData;
    private Object moreData;

    void writeOn(Writer writer)
    {
        writer.write(convertToByte(someData));
        writer.write(convertToByte(moreData));
    }
}

class AnotherObject implements Writeable
{
    private int x;
    private int y;
    private int z;

    void writeOn(Writer writer)
    {
        writer.write((byte)x);
        writer.write((byte)y);
        writer.write((byte)z);
    }
} 
```

Writer 正在做的是分派回输入，告诉它使用它（Writer）来写入，但是这是为那个对象完成的，这是无法提前知道的。

# c# - IE6：window.onresize 在 IIS 上工作，在 asp.net 开发服务器上爆炸

> ID：360116
> 
> 赞同：1
> 
> 时间：2008-12-11T17:03:23.553
> 
> 标签：c#, asp.net, javascript, visual-studio, internet-explorer

**更新 1：**
无法在同事的计算机上重现此问题（与我的设置相同）所以我认为这是我的工作站的问题，而不是一般的问题。

如果有人能结束这个问题，我将不胜感激，因为我自己没有足够的声誉来做这件事。

@马修马丁。感谢您的意见 ：-）

* * *

**更新 2：**
与我的同事不同，我的机器上安装了**VS90sp1-KB945140-ENU.exe (SP1)**和**VS90SP1-KB957912-x86.exe**（JS Intellisense 修补程序）。这*似乎*是我们的设置之间的唯一区别。我删除了它们，但这并没有解决我的问题。

* * *

在我的 asp.net (C#) 页面中，当用户调整窗口大小时，有一点点 Javascript 来调整对象的大小。

当我在我的 DEV 服务器 (IIS) 上使用 IE6 访问该页面时，它**可以工作**。
当我使用 F5 或 CTRL-F5（两者都启动 ASP.NET 开发服务器）通过 VS2008 使用 IE6 访问页面时，它**失败**了。它似乎进入了一个调整大小的无限循环，`adjSpreadsheetSize`函数触发 window.resize 事件，该事件调用`adjSpreadsheetSize`... 无限重复

我看到很多人抱怨 IE6 无法正确处理 onresize 事件，但似乎没有人遇到这个确切的问题。

**知道为什么这段代码可以在 IIS 上运行，但不能在 ASP.NET 开发服务器上运行吗？**

这是代码的相关部分：

```
[snip]
<head>
[snip]
<script language="javascript" type="text/javascript">
    window.onresize = adjSpreadsheetSize;
    window.onload = pageSetup;

    //Change spreadsheet size to fill the window (viewport) below the entry form
    function adjSpreadsheetSize() {
        var objSS = document.getElementById("OWC_data");
        var winWidth = document.documentElement.clientWidth;
        var winHeight = document.documentElement.clientHeight;

        winHeight -= document.getElementById('form_body').offsetHeight;

        objSS.height = winHeight;
        objSS.width = winWidth;
        return false;
    }

    function pageSetup() {
        adjSpreadsheetSize();
    }
</script>

[snip]
</head>
<body>
<form id="form1" runat="server" action="rawdata.aspx" method="get">
<div id="form_body">
[snip]
</div>
</form>
<div id="OWC_container">
    <object id="OWC_data" classid="clsid:0002E559-0000-0000-C000-000000000046">
    </object>
</div> 
```

我的设置：

*   WinXP 专业版 SP2
*   Microsoft Visual Studio 2008 版本 9.0.21022.8 RTM
    *   安装版：专业版
    *   微软视觉基础 2008
    *   微软视觉 C# 2008
    *   微软视觉 C++ 2008
    *   适用于 Office 的 Microsoft Visual Studio 2008 工具
    *   微软视觉网页开发者 2008
    *   适用于 Visual Studio 2008 的 Crystal Reports Basic
*   Microsoft .NET 框架版本 3.5 SP1
*   网站项目位于 DEV 服务器上（映射为本地驱动器）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T20:02:31.290

由于这是您尝试加载的 activex 对象，也许您的 MSIE 配置为信任[http://localhost](http://localhost)多于[http://localhost:1235/foo](http://localhost:1235/foo)？

IIS 与 ASP.NET 开发服务器的其他区别：

IIS 只将一些文件交给 aspnet 过滤器，ASP.NET 开发服务器全部交给 IIS。

此外，有时端口# 的变化会改变行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T20:45:27.147

我添加了
`alert("Viewport: " + document.documentElement.clientHeight + " - formHeight: " + formHeight + " = " + winHeight);`

出于某种原因，div“form_body”在“421”和“435”之间来回翻转（相差 14）。所以我添加了一个边框来尝试看看变化发生在哪里...... `<div style="border: solid 1px red;" id="form_body">`

当边界在那里时，调整大小就可以了。易于重现...添加边框样式，调整大小触发 3~5 次。移除边框，只要我愿意坐下来观看，它就会反复触发。

怎么回事？

# .net - 从 WebService 调用中获取响应标头？

> ID：360129
> 
> 赞同：2
> 
> 时间：2008-12-11T17:08:55.897
> 
> 标签：.net, web-services

有没有办法从.net 上的 Web 服务调用中获取响应标头？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T20:38:23.047

从 WebMethod（Web 服务方法）内部编写以下代码

您可以使用 for 循环遍历 Header 中的所有键值对

```
int Count = HttpContext.Current.Request.Headers.Count;
for (int i = 0; i < Count; i++)
{
    string key = HttpContext.Current.Request.Headers.GetKey(i);
    string keyValue = HttpContext.Current.Request.Headers.Get(i);
    //Do something
} 
```

# asp.net - 在加载母版页时禁用用户控件

> ID：360134
> 
> 赞同：2
> 
> 时间：2008-12-11T17:10:46.953
> 
> 标签：asp.net

我在某些页面上使用母版页。该母版页正在加载用户控件。所以我想在某些具有母版页的页面加载上禁用或启用用户控制。

* * *

无论如何我可以禁用母版页上的用户控制 Page_load()

* * *

```
<div class="ucTabCtrl" >
    <uc1:TLTabControl ID="ctrlname" runat="server" Visible="False" />
</div>

Master Page_load()
{
 // checking some condition if true
 ctrlname.visible = true;
} 
```

但问题是我无法获取用户 ctrl 的实例，简而言之 ctrlname 一直为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T19:24:22.083

你的问题有点难以理解，但我认为你正在寻找的是这样的：

```
public partial class Site1 : System.Web.UI.MasterPage
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Page is WebForm1 || Page is WebForm2)
        {
            webUserControl11.Visible = false;
        }
    }
} 
```

或者，您可以在指示此行为的页面上实现一个接口。类似的东西：

```
public partial class Site1 : System.Web.UI.MasterPage
{
    protected void Page_Load(object sender, EventArgs e)
    {
        ISpecialPage specialPage = Page as ISpecialPage;

        if (specialPage != null && specialPage.ShouldDisableUserControl)
            webUserControl11.Visible = false;
    }
}

public interface ISpecialPage
{
    bool ShouldDisableUserControl { get; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T17:15:07.477

您想在子页面上禁用它吗？您可以在 Page_Load() 方法中执行以下操作：

```
if (null != this.Master)
{
    userControl.Enabled = false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T03:02:30.983

用户控件未在 MasterPage 中声明为局部变量。您需要使用 FindControl() 函数来获取对控件的引用。

这是一个工作示例：

```
Dim userControl As WebControl = ContentPlaceHolder1.FindControl("someControl")
If userControl IsNot Nothing Then
   CType(userControl, WebControl).Enabled = False
End If 
```

# video - 敏捷开发 101 视频

> ID：360139
> 
> 赞同：8
> 
> 时间：2008-12-11T17:11:54.580
> 
> 标签：video, agile

我一直在努力寻找一个可以在敏捷开发/Scrum 的“午餐和学习”中展示的好视频。我们的组织主要是瀑布，大多数人甚至从未听说过敏捷开发，更不用说对该主题有任何具体的了解了。那里有很多很棒的资源谈论敏捷，但它们似乎都假设了敏捷的基本工作知识。对于那些一无所知的人，我找不到一个很好的、脚踏实地的、关于敏捷开发的介绍。

谁能提供这样的链接？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-11T19:42:11.517

敏捷视频系列的**秋天**正是您正在寻找的。

它由 Steve 制作，他在[http://unhandled-exceptions.com](http://unhandled-exceptions.com/)上写博客。

**[http://www.autumnofagile.net/](http://www.autumnofagile.net/)**

演讲的质量和深度非常好。你会印象深刻的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T22:31:04.817

将此处的答案汇总为一个答案：

视频链接

*   [面向传统项目经理的敏捷简介](http://www.infoq.com/presentations/Introduction-Agile-Stacia-Broderick)
*   [敏捷之秋](http://www.autumnofagile.net/)
*   [Scrum 等人：谷歌技术讲座](http://video.google.com/videoplay?docid=-7230144396191025011)
*   [关于敏捷与商业的 YouTube 视频](http://de.youtube.com/watch?v=OWvSnYjqOTQ)
*   [不到 10 分钟的 Scrum](http://www.youtube.com/watch?v=Q5k7a9YEoUI) (Hamid Shojaee)

资源链接

*   [肯施瓦伯视频和链接](http://www.controlchaos.com/)
*   [Scrum 联盟](http://www.scrumalliance.org/)
*   [介绍性 Podcast Re Scrum（仅限音频）](http://channel9.msdn.com/shows/ARCast+with+Ron+Jacobs/ARCastnet-The-Agile-Architect-with-Jeffrey-Palermo/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T19:07:45.267

当我看到它时，我喜欢它：

[面向传统项目经理的敏捷简介](http://www.infoq.com/presentations/Introduction-Agile-Stacia-Broderick)

从网站：

在 Agile 2007 期间拍摄的这个演示文稿中，Stacia Broderick 通过比较项目管理协会 (PMI) 的最佳实践和等效的敏捷技术，向受过传统培训的项目经理介绍了敏捷。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T18:03:20.343

这是一个名为“Scrum et al”的视频。这是 Ken Schwaber 在 Google 技术讲座上介绍该主题。

“Google 技术讲座 2006 年 9 月 5 日 Ken Schwaber 共同开发了敏捷流程 Scrum。他是敏捷联盟和 Scrum 的创始人......”

[http://video.google.com/videoplay?docid=-7230144396191025011](http://video.google.com/videoplay?docid=-7230144396191025011)

您还可以在此处找到资源：

[http://www.scrumalliance.org/](http://www.scrumalliance.org/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T19:27:58.253

有 2 个关于敏捷开发的系列视频，来自 .Net Rocks!。谷歌的“Venkat Subramaniam on Fundamentals of Agile Design”，我认为没有。73，看看它是否适合你的观众。这里还有一个介绍性播客：http: [//channel9.msdn.com/shows/ARCast+with+Ron+Jacobs/ARCastnet-The-Agile-Architect-with-Jeffrey-Palermo/](http://channel9.msdn.com/shows/ARCast+with+Ron+Jacobs/ARCastnet-The-Agile-Architect-with-Jeffrey-Palermo/)，但只是音频。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T22:21:32.403

Ken Schwaber 在[http://www.controlchaos.com/](http://www.controlchaos.com/)上有很多视频。它们有点短，但我发现观看视频然后讨论各个主题是一种很好的会议形式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-12T07:38:16.917

[Hamid Shojaee](http://community.axosoft.com/blogs/hamids/)制作了一个**[关于 Scrum 的十分钟视频](http://www.youtube.com/watch?v=TWSXETDWGQ4)**（也有[高清](http://www.youtube.com/watch?v=Q5k7a9YEoUI)视频）。这是非常有节奏和有趣的。可能是一个很好的开始讨论你的午餐学习。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T17:34:48.857

我没有任何链接给你，但是当你找不到你需要的资源时，我确实有一条建议适用：你自己创建它。

如果您费力寻找又找不到适合您团队的视频，您可以随时投入一些时间来制作该视频。然后确保它在互联网上的显眼位置，并且您的其他人将拥有他们需要的视频。

# sql-server-2008 - 如何连接到 SQL Server 2008 Express 的本地实例

> ID：360141
> 
> 赞同：228
> 
> 时间：2008-12-11T17:12:15.143
> 
> 标签：sql-server-2008, ssms

我刚刚在我的 Vista SP1 机器上安装了 SQL Server 2008 Express。我以前在这里有 2005，并且在旧的 SQL Server Management Studio Express 上使用它就很好。我能够毫无问题地连接到我的 PC-NAME\SQLEXPRESS 实例（不，PC-NAME 不是我的计算机名 ;-)。

我卸载了 2005 和 SQL Server Management Studio Express。然后，我在我的机器上安装了 SQL Server 2008 Express，并选择让它安装 SQL Server Management Studio Basic。

现在，当我尝试连接到 PC-NAME\SQLEXPRESS（使用 Windows 身份验证，就像我一直做的那样）时，我收到以下消息：

*无法连接到 PC-NAME\SQLEXPRESS。建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）（Microsoft SQL Server，错误：-1） 如需帮助，请单击：http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL +Server&EvtSrc=MSSQLServer&EvtID=-1&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=-1&LinkId=20476)*

当我安装 SQL Server 2008 时，我让它使用 SQLEXPRESS 作为本地实例名称。据我所知，通过 SQL Server 配置管理器，SQL Server 被配置为允许远程连接。

当我转到它提到的帮助链接时，帮助页面建议以下内容：

*   确保 SQL Server Browser 服务已在服务器上启动。
*   使用 SQL Server 外围应用配置工具使 SQL Server 能够接受远程连接。有关 SQL Server 外围应用配置工具的详细信息，请参阅服务和连接的外围应用配置。

好吧，据我所知，我的系统上没有 SQL Server Browser 服务（在 MMC 中查找了一个，但找不到）。

SQL Server 外围应用配置工具在 SQL Server 2008 中不存在。微软的帮助文档做得很好；-)。

我不知道现在该做什么。在升级到 2008 年之后，我希望今天完成很多工作（与我一起工作的人顺利启动并运行它，并告诉我这很容易 - 他在数据库方面的表现也比我好得多是）。有谁知道可能出了什么问题？我真的很感激。如果我不能在几个小时内完成这项工作，我将回到 SQL Server 2005（如果它甚至可以工作，唉......）。

编辑：我尝试关闭 Windows 防火墙，但没有帮助。另外，我注意到我的 SQL Server 2008 安装目录树下没有“数据”目录——我安装它时可能设置了错误吗？

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2010-08-11T19:09:53.093

请检查您提供的 ServerName。它应该与 UserName 文本框中显示的下面的名称匹配，并且该名称后面应带有`\SQLEXPRESS`：

![连接对话框](https://i.stack.imgur.com/6Dqbk.png)

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2012-09-20T19:33:44.440

**启动本地 SQL Server 服务**

*   **启动 SQL 配置管理器：** 单击开始 -> Microsoft SQL Server 2008 R2 -> SQL Server 配置管理器
*   **启动 SQL 服务：** 将 SQL Server (SQLEXPRESS) 和 SQL Server Browser 服务设置为自动启动模式。右键单击每个服务 -> 属性 -> 进入服务选项卡

如果您重新启动计算机，这将确保它们再次启动。请检查以确保两种服务的状态均为“正在运行”。

![启动本地 SQL Server 2008 服务](https://i.stack.imgur.com/lO2tA.jpg)

**使用本地 SQL Server 登录并进行身份验证**

*   现在打开 SQL Server Management Studio 并单击“连接到对象资源管理器”并选择服务器名称：

*[您的电脑名称]\SQLEXPRESS*

**示例：** *8540P-KL\SQLEXPRESS 或 (localhost)\SQLEXPRESS*

*   要查找您的 PC 名称：右键单击我的电脑 -> 属性 -> 计算机名称选项卡

*   **备选方案：** 使用 Windows 身份验证登录：使用用户名 [您的域]/[您的用户名]

![SQL Server 2008 用户帐户设置](https://i.stack.imgur.com/Bptt6.png)

**设置用户帐户**

*   **创建一个新的登录帐户：** 在 SQL Mgmt Studio -> 展开本地服务器 -> 安全 -> 右键单击​​登录 -> 新登录

*   **在新用户帐户上设置密码设置：** 取消选中强制密码策略、密码过期和用户必须更改 pw（因为这是本地）默认数据库 -> 您的数据库

*   **向新用户帐户授予角色：** 用户映射页面 -> 映射到您的数据库并授予 db_owner 角色状态页面 -> 授予连接和启用登录的权限

![SQL Server 2008 用户设置本地数据库](https://i.stack.imgur.com/jBo4B.png)

**为用户设置访问权限/设置**

*   **启用所有身份验证模式：**右键单击本地服务器 -> 属性 -> 安全选项卡 -> 启用 SQL Server 和 Windows 身份验证模式
*   **启用 TCP/IP：** 打开 SQL Server 配置管理器 -> SQL Server 网络配置 -> SQLEXPRESS 协议 -> 启用 TCP/IP
*   **重启 SQL Server 服务：** 启用 TCP/IP 后必须重启 SQL Server(SQLEXPRESS)

![SQL Server 2008 服务器权限](https://i.stack.imgur.com/rlmgE.png)

**Spring 项目的数据库属性文件**

*   database.url=jdbc:jtds:sqlserver://[本地 PC 计算机
    名称];instance=SQLEXPRESS;DatabaseName=[数据库名称];

*   database.username=[您的用户名] database.password=[您的密码]

*   database.driverClassName=net.sourceforge.jtds.jdbc.Driver

如果您想查看更大的屏幕截图和更好的答案格式以及更多详细信息，请查看下面的博客文章： [设置 SQL Server 2008 的本地实例博客文章：](http://codedevstuff.blogspot.com/2014/02/how-to-set-up-sql-server-2008-local.html)

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2015-12-29T17:26:03.573

我使用**(LocalDB)\MSSQLLocalDB**作为服务器名称，然后我可以看到所有本地数据库。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-12-11T19:11:22.827

哈哈，天哪，我想通了。不知何故，不知何故，我在安装 SQL Server 2008 时没有安装数据库引擎。我不知道我是怎么错过的，但这就是发生的事情。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2012-05-02T21:13:50.167

我知道这个问题很老，但如果它可以帮助任何人确保 SQL Server Browser 在 Services MSC 中运行。我安装了 SQL Server Express 2008 R2，并且 SQL Server Browser 服务设置为已禁用。

1.  开始->运行->Services.msc
2.  找到“SQL Server Browser”->右键->属性
3.  将启动类型设置为自动->单击应用
4.  重试连接。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2014-08-07T10:39:23.760

我刚刚解决了一个与此相关的问题，这可能对其他人有所帮助。

最初在加载 MSSMSE 时，它有服务器`PC_NAME\SQLEXPRESS`，当我尝试连接时它给了我`Error: 26 - Error Locating Server/Instance Specified`，所以我进入 SQL Server 配置管理器检查我的`SQL Server Browser`和`SQL Server`服务是否正在运行并设置为自动，结果发现它没有说它`SQL Server (SQLEXPRESS)`说`SQL Server(MSSQLSERVER)`.

然后我尝试连接到`PC-NAME\MSSQLSERVER`，这一次得到了`SQL Network Interfaces, error: 25 - Connection string is not valid) (MicrosoftSQL Server, Error: 87) The parameter is incorrect`，所以我用谷歌搜索了这个错误，发现有人建议不要在服务器连接接口上使用`PC-NAME\MSSQLSERVER`仅用`PC-NAME`作服务器名称，这似乎有效。

这里有一个链接[http://learningsqlserver.wordpress.com/2011/01/21/what-version-of-sql-server-do-i-have/](http://learningsqlserver.wordpress.com/2011/01/21/what-version-of-sql-server-do-i-have/)这说明 MSSQLSERVER 是默认实例，可以通过仅使用您的主机名。

我认为这可能是因为我在过去的某个时候安装了 SQL Server 2008。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-12-11T18:37:19.010

在您的实例的配置管理器和网络配置和协议下是否启用了 TCP/IP？这可能是问题所在。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2011-02-16T11:13:41.023

```
var.connectionstring = "server=localhost; database=dbname; integrated security=yes" 
```

或者

```
var.connectionstring = "server=localhost; database=dbname; login=yourlogin; pwd=yourpass" 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-01-29T12:53:58.753

对我来说，我只能通过使用“。”来让它工作。在服务器名称字段中；尝试了一段时间的用户名和服务器名的不同组合。请注意，在安装服务器（即此文件：SQLEXPR_x64_ENU.exe）期间，我检查了默认实例，该实例默认名称为 MSSQLSERVER；上述高票数的答案可能最好用于单独的命名（即当您需要超过 1 个）服务器实例。

这两个视频都帮助了我：

*   使用点作为服务器名称：[https ://www.youtube.com/watch?v=DLrxFXXeLFk](https://www.youtube.com/watch?v=DLrxFXXeLFk)
*   一般设置：[https ://www.youtube.com/watch?v=vng0P8Gfx2g](https://www.youtube.com/watch?v=vng0P8Gfx2g)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-10-07T17:22:34.857

您应该检查的第一件事是 SQL Server (MSSQLSERVER) 是否已启动。您可以转到服务控制台 (services.msc) 并查找 SQL Server (MSSQLSERVER) 以查看它是否已启动。如果没有，则启动服务。

您也可以通过提升的命令提示符键入来执行此操作`net start mssqlserver`。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-03-19T01:20:55.430

对我来说，这是一个 Windows 防火墙问题。允许传入连接。打开端口不起作用，但允许程序起作用。

[关联](http://technet.microsoft.com/en-us/library/ms345343.aspx)

[链接2](https://docs.microsoft.com/en-us/archive/blogs/sqlexpress/how-to-configure-express-to-accept-remote-connections)

# sharepoint - 您可以在 SharePoint wiki 中创建“评论”部分吗？

> ID：360148
> 
> 赞同：1
> 
> 时间：2008-12-11T17:14:30.177
> 
> 标签：sharepoint, comments, wiki

我正在尝试在我的 wiki 中创建一个评论部分。Web 上有一个解决方案涉及创建“列”，但这似乎只是在主要文章块下创建了第二个文本块。这是不切实际的，因为后续的编辑不会创建新的评论——它们似乎只是编辑现有的评论。外面还有几个人问这个问题。有没有人做过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T17:52:06.340

我的第一个建议是尝试获得不同的 wiki 解决方案。我试图让 Sharepoint wiki 被采用，但它以比预期更大的方式失败了。然后我说服我的公司，问题出在维基上。在切换 wiki 之后，我们经历了更多的采用。

也就是说，我在 Sharepoint wiki 上发表评论的方式是为我想要评论的每个页面创建一个单独的页面。然后在页面顶部我会有一个标准表。

```
The Page   |  Comments 
```

该表会将您链接到维基百科上的类似谈话页面。这在一定程度上解决了我的问题。

查看[Confluence](http://www.atlassian.com/software/confluence/)，这是我目前最喜欢的 wiki 软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T12:52:38.673

将以下行添加到企业 wiki 的页面布局中为我工作

```
<SharePointPortalControls:SocialCommentWebPart id="noteboard" ChromeType="None" runat="server" /> 
```

# xml - 保存程序数据

> ID：360151
> 
> 赞同：0
> 
> 时间：2008-12-11T17:15:52.450
> 
> 标签：xml, io, binary

我正在寻找一些信息和一点历史。我正在编写一个程序，我想在不使用数据库的情况下保存一些数据。我假设我可以使用 XML，但我还能使用什么？如何将数据保存到文件中，然后在没有 XML 和纯文本的情况下检索它们？什么是二进制格式，可以使用吗？微软以前用于 Office 文件的不是二进制格式吗？我不确定如何解决这个问题，如果有任何帮助，我将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T17:24:04.010

为什么要避免使用数据库？如果只是开销，您是否考虑过[sqlite](http://www.sqlite.org/)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T17:21:44.640

您要保存什么样的数据？是否有理由避免使用纯文本、XML 和数据库？我可以理解避免使用数据库，因为您可能不想处理开销，如果您指的是保存类似于 Word 文件的信息，那么使用除平面文件以外的任何东西都没有多大意义（除非您'正在开发一个 Web 应用程序，在这种情况下我收回该声明）。

你用的是什么开发平台？在 Java 中，您可以使用 FileReader 和 FileWriter 来读取和写入文件。如果您想在创建文件之前对其进行格式化，您可以编写一个方法来执行此操作。其他语言也有类似的功能，只需要搜索*“用languageX读写文件”*即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T17:23:36.727

“二进制格式”是一个非常模糊的术语。基本上它是“纯文本格式以外的任何东西”。

您可以选择任何您想要将数据写入磁盘的格式。如果您使用现有格式（XML、ini 文件、Protocol Buffers、Thrift 等），您将受益于已经有代码来编写/解析数据。如果您编写自己的自定义格式，则可以根据您的确切要求对其进行定制。

这个问题在[另一个问题](https://stackoverflow.com/questions/352117)中讨论过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T17:38:17.680

我正在使用 C#。我可能会使用 XML，但我只是在学习，我想知道一些替代方案。基本上，我希望我的程序类似于 Office 之类的程序，您可以在其中添加一些内容，然后将其保存到文件中以供将来检索。如果您要在文本编辑器中查看 Office 文件，它会全是乱码，我认为它是二进制文件。那么当您检索文件时，它是否只是提取信息并将其保存到集合或其他东西中？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T17:45:57.133

> Blockquote “二进制格式”是一个非常模糊的术语。基本上它是“纯文本格式以外的任何东西”。您可以选择任何您想要将数据写入磁盘的格式。如果您使用现有格式（XML、ini 文件、Protocol Buffers、Thrift 等），您将受益于已经有代码来编写/解析数据。如果您编写自己的自定义格式，则可以根据您的确切要求对其进行定制。

很有趣，所以我就是这么想的。显然已经有像 XML 这样的现有格式，但您也可以使用其他格式或创建自己的格式。您是否碰巧知道在 XML 之前常用的是什么，或者大多数大公司只是编写自己的？我假设编写自己的代码非常困难

# c++ - 本机 C++ SQL 框架

> ID：360154
> 
> 赞同：1
> 
> 时间：2008-12-11T17:16:30.687
> 
> 标签：c++, sql, mysql, oracle, native

我需要一个用于 SQL 的原生 C++ 中的高性能框架。我需要它能够使用 MySQL、Oracle 和 Microsoft SQL Server，并从不同供应商的 DBMS 所需的每种不同语法中发现的低级问题/特性提供抽象。类似于 C# 和 VB .Net 的 LINQ。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T17:27:38.403

我相信 Qt 至少有一些你正在寻找的东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T18:54:29.007

就个人而言，我喜欢[数据库模板库](http://dtemplatelib.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-19T12:04:11.873

[http://cppcms.com/sql/cppdb/index.html](http://cppcms.com/sql/cppdb/index.html)真的很棒。

作为一个减号 - 它至少在 ODBC 后端使用不是非常有效的方法，但对于一般（不是高负载）目的，它纯粹是很棒的。

# vba - Excel 中的命名列表中区分大小写的验证

> ID：360158
> 
> 赞同：2
> 
> 时间：2008-12-11T17:17:48.050
> 
> 标签：vba, excel

我在 Excel 2003 中使用 VBA 应用验证以将验证应用于命名列表中的给定单元格范围。然后，用户可以从值的下拉列表中进行选择。

编辑：这是我设置验证的方式，给定一个名为“MyLookupList”的命名范围

```
 With validatedRange.Validation
            .Delete
            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
                Operator:=xlBetween, Formula1:="=MyLookupList"
            .ErrorMessage = "Invalid value. Select one from the dropdown list."
            .InCellDropdown = True
        End With 
```

一切正常，但问题是当从命名列表应用验证时，它不区分大小写。即，如果下拉选项是“John Smith”，那么用户可以在经过验证的单元格中输入“john smith”或“john SmiTh”，Excel 仍会将其视为有效条目。

我知道通过 Tools-->Validation... 手动创建一个列表将使查找验证区分大小写，但对我而言，这是不可行的——我必须填充命名列表并以编程方式分配验证。

有谁知道如何确保基于命名列表的 Excel 验证区分大小写？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T20:21:02.717

好吧，您可以在给定验证范围的情况下构建验证列表（假设它不是太大）

```
Dim sValidationList As String
Dim iRow As Integer

  'build comma-delimited list based on validation range
  With oValidationRange
    For iRow = 1 To .Rows.Count
      sValidationList = sValidationList & .Cells(iRow, 1) & ","
    Next
  End With

  'trim trailing comma   
  sValidationList = Left(sValidationList, Len(sValidationList) - 1)

  'apply validation to data input range
  With oDataRange.Validation
    .Delete
    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _
      Operator:=xlBetween, Formula1:=sValidationList
    .ErrorMessage = "Invalid value. Select one from the dropdown list."
    .InCellDropdown = True

  End With 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T22:43:47.627

看看这个：

[http://www.contextures.com/xlDataVal14.html](http://www.contextures.com/xlDataVal14.html)

我没有测试过它，它有点复杂，但我认为它会做你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T21:04:05.970

StrComp 怎么样？如果使用 vbBinaryCompare，StrComp 字符串比较区分大小写。例如：

```
 Set c = Range("MyLookupList").Find(Range("ValidateRange"), _
         LookIn:=xlValues)
    If Not c Is Nothing Then
        If StrComp(c, Range("ValidateRange"), vbBinaryCompare) = 0 Then
            'Match '
            MsgBox "OK"
        Else
            MsgBox "Problem"
        End If
    End If 
```

# c++ - 混合 Qt 和 Boost

> ID：360160
> 
> 赞同：66
> 
> 时间：2008-12-11T17:18:00.717
> 
> 标签：c++, qt, boost

我正在考虑使用 Qt 4 框架在 C++ 中启动一个项目（需要跨平台 GUI）。我从朋友和网上听到了关于 Boost 库的好消息。我已经开始阅读两者，并想在深入之前问一个粗略的问题：这两个开发“系统”是否相互排斥？

我最初的搜索和阅读显示在信号处理、自定义构建系统和其他低级原语中存在一些重叠。

在同一个项目中同时使用它们是否有意义？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-11T17:30:43.153

是的，这很有意义。我通常更喜欢在可能的情况下使用 boost/stdlib 函数，而不是它们的 Qt 替代品。

它使代码更容易移植到下一个框架。
它使新的非 Qt 程序员更容易上手。
Boost 有一些很棒的功能，并且一直在变得越来越多。

注意：到/来自小部件的字符串可能是主要的例外 - 在 GUI 内，我会使用 Qt 字符串来保存到处乱七八糟的转换。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-03-29T21:14:16.033

[这篇论文](http://www.elpauer.org/stuff/a_deeper_look_at_signals_and_slots.pdf)非常体面地比较了 QT 和[Boost::Signal中的](http://www.boost.org/doc/html/signals.html)[信号槽机制。](http://doc.qt.io/qt-4.8/signalsandslots.html)对于那些对这种组合有点好奇的人来说，这是必读的。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-03-03T11:36:41.053

尤其是因为你要跨平台，你应该有一个很好的分层架构，业务逻辑和数据访问尽可能从 GUI 中删除。在这种情况下，在编写应用程序的后端时使用 Boost 是有意义的，而前端只跳转到 Qt，并在胶水中完成强制转换。

如果您的“引擎”与您的 GUI 选择是分开的，那么将来您将能够以最小的努力将 Qt 换成其他东西（也许是本机库）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-12T12:41:56.737

我们（Last.fm）同时使用它们，虽然我们才刚刚开始这样做，所以还没有很多经验。到目前为止一切都很好:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T16:25:52.333

将 Boost.Signals 与 QT 一起使用存在潜在问题。这些都记录在[Boost.Signals FAQ](http://www.boost.org/doc/libs/release/doc/html/signals/s04.html)中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-01-18T13:57:19.627

考虑到[Boost Signals2](http://www.boost.org/doc/libs/1_45_0/doc/html/signals2.html)可用，并且它们是线程安全的。

# .net - 如何从 gridview 获取副本？

> ID：360161
> 
> 赞同：0
> 
> 时间：2008-12-11T17:18:13.883
> 
> 标签：.net, gridview

我试图从 gridview 获取完整的数据副本，itryed clone()，尝试从 DataSouce 转换 DataView，但总是得到空值或无法获取数据，请存在一种从 gridview 复制数据的方法，修改它然后重新加载它？或者直接修改gridview中的一些行？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T18:11:59.920

你可以尝试使用 OnRowDataBound 属性来做这样的事情

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.Header)
    {
        //HeaderStuff
    }
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        ObjectTye objectType = (ObjectType)e.Row.DataItem;
        // and doing some stuff with the properties
        e.Row.Cells[0].Text = objectType.SomeProperty.ToString();
        LinkButton deleteLnk = (LinkButton)e.Row.FindControl("lnkDelete");
        deleteLnk.Attributes.Add("onclick", "javascript:return " + 
            "confirm('Are you sure you want to delete this')");
        deleteLnk.CommandArgument = e.Row.RowIndex.ToString();
    }
}
protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
{
    int rowIndex = int.Parse(e.CommandArgument.ToString());
    GridViewRow row = GridView1.Rows[rowIndex];

    ObjectType objectType = new ObjectType();
    objectType.StringProperty = row.Cells[0].Text;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T17:39:09.597

你到底想用数据做什么？它也是数据网格还是数据视图，在什么框架中？如果它是您尝试从中复制行的数据网格，请遍历数据网格行并将行值添加到数组列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T18:21:23.020

为什么不将第二个网格绑定到第一个网格绑定到的同一源？

```
DataGridView1.DataSource = yourList;
DataGridView1.DataBind();
...
DataGridView2.DataSource = yourList; //or = DataGridView1.DataSource;
DataGridView2.DataBind(); 
```

只要数据没有改变，你就应该得到一个精确的副本。

# web-applications - 对于用户反馈，您会推荐哪个 Web 应用程序？

> ID：360163
> 
> 赞同：6
> 
> 时间：2008-12-11T17:18:36.877
> 
> 标签：web-applications, feedback, get-satisfaction

对于用户反馈，您会推荐哪个 Web 应用程序？

*   获得满足感 ( [http://getsatisfaction.com](http://getsatisfaction.com) )
*   用户语音 ( [http://uservoice.com](http://uservoice.com) )
*   功能列表（[http://featurelist.org](http://featurelist.org)）
*   或其他推荐？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-31T15:02:14.337

鉴于只有 UserVoice 提供非英语版本，如果您需要它，这很容易。

getsatisfaction 比 uservoice 范围更广；虽然后者专注于引导改进建议，但前者是一种更通用的反馈解决方案，包括对任何与产品相关的事物的赞美和抨击。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T17:33:37.940

看到用户语音与 SO 的成功，以及它的易用性，我会推荐它。一些用户认为 User Voice 上的注册过程很麻烦，但只需要一分钟，他们甚至添加了 OpenID 支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T17:20:47.217

用户声音

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T21:36:10.540

我作为客户和管理员都使用过 UserVoice，我强烈推荐它。两种方式都很容易使用，而且 UserVoice 的创建者都是很棒的人，并且在 Twitter 和其他通信媒体上非常活跃

公平地说，我从未使用过任何其他服务，所以我不能说太多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-19T17:04:29.860

试试谷歌汇问。您必须有一个 Google 帐户，但这比 getatifaction 或 uservoice 帐户麻烦得多。它更简单但更易于使用和理解。您可以使用 Google Moderator API 在您的网站上托管它，并让用户在您的网站上使用他们的帐户登录。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T17:30:58.787

Get Satisfaction 似乎是我所见过的最快的。出于这个原因，我会使用它，如果客户已经有一个帐户并且在他们更有可能同时使用并且不会对系统感到沮丧之前已经使用过一次或两次。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-14T17:12:59.880

不喜欢[GetSatisfaction](http://getsatisfaction.com/)方法，即在网上建立社区，让员工去认领它。向用户传达错误的印象。

在我的公司，我们已经确定需要一站式解决方案来处理来自用户的任何事情。单纯的反馈支持平台不符合要求。这就是我喜欢[Zendesk](http://www.zendesk.com)、[UserRules](http://www.userrules.com/pricing)、[UserVoice](http://www.uservoice.com)采用的方法的地方。Zendesk 从 HelpDesk 开始，现在提供社区论坛。UserRules 和 UserVoice 都为公司引入了 KnowledgeBase，但是 UserRules 的实施符合 Zendesk 的要求。

不用说，任何具有尖端功能集和简单、干净的界面的产品都是我们这个时代的需要。有点像 UserVoice 和 UserRules 的设计，而不是 Zendesk。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T17:36:23.953

严格从客户的角度来看，我喜欢与 User Voice 进行交互 - 简单、快速和干净。（注意：我从来没有使用过获得满意，所以我无法比较）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-19T16:46:42.620

尽管 Get Satisfaction 的 UI 看起来更流畅、更丰富，但两者都有其缺陷 - 例如，您可以发布图像 - 我不确定您可以使用 UserVoice 做什么？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-11-22T11:03:50.377

为什么不使用 Google 表单？它是免费的，它与 Google Docs 集成得非常好，并且具有非常易于使用的 API。看看这里：[http ://www.google.com/google-ds/forms/](http://www.google.com/google-d-s/forms/)

# wpf - 让工具栏在 ItemsControl 中托管项目

> ID：360167
> 
> 赞同：2
> 
> 时间：2008-12-11T17:19:57.123
> 
> 标签：wpf

我想在 ItemsControl 的 ToolBar 中托管自定义项目。但是，我添加的按钮在工具栏下方呈现为常规按钮，而不是在具有工具栏外观的工具栏中。

这可以用几行 Xaml 来重现（我已经排除了默认内容）。自定义 ItemsControl：

```
<ToolBar ItemsSource="{Binding Items}" /> 
```

示例窗口：

```
<StackPanel Orientation="Vertical">
    <local:UserControl1>
        <Button>control button</Button>
    </local:UserControl1>
    <Button>standard button</Button>
    <ToolBar>
        <Button>window toolbar button</Button>
    </ToolBar> 
```

我希望“控制按钮”的呈现方式类似于“窗口工具栏按钮”，而不是像空工具栏下方的“标准按钮”一样呈现。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T18:28:06.003

像这样在按钮上设置样式：

```
Style="{DynamicResource {x:Static ToolBar.ButtonStyleKey}}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-24T01:47:05.523

我最终通过命名自定义工具栏获得了我想要的行为，然后在代码隐藏中添加一个属性，控件的使用者可以使用该属性通过代码添加项目。

# c# - 更改 Web.config 中的键/值对

> ID：360177
> 
> 赞同：2
> 
> 时间：2008-12-11T17:22:19.333
> 
> 标签：c#, asp.net, web-config, appsettings

如何更改 web.config 中的键值，该键值在 asp.net 中代码后面的 appSettings 标记之间定义

谢谢..

问候...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T17:28:11.630

从 .Net 2.0 开始，有一个用于在运行时修改 Web 配置的[API](http://www.aspnetpro.com/newsletterarticle/2007/02/asp200702jk_l/asp200702jk_l.asp)。

但是请注意，对 Web 配置所做的任何更改都会导致 Web 应用程序重新启动，因此您希望尽可能少地使用它。

# database - 从数据库中检索分层数据的最佳方法

> ID：360188
> 
> 赞同：3
> 
> 时间：2008-12-11T17:27:13.537
> 
> 标签：database, hierarchical-trees

我必须将博客风格的评论存储在数据库中。每个评论都可以有一个父评论。

我正在使用一个名为“parentComment”的列来做这件事，当它是顶级评论时它有一个空值，或者如果它是对另一个评论的响应则有一个值。

检索评论及其所有子项的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T17:30:17.587

一种非常常见的技术是与树的“根”也有（重复的，间接的）关系，这意味着您可以在一个整洁的选择中选择完整的树。否则它很快就会变脏。

# c++ - 二维数组错误 C++

> ID：360195
> 
> 赞同：0
> 
> 时间：2008-12-11T17:30:28.100
> 
> 标签：c++, multidimensional-array

我正在尝试运行一个 c++ 2d 数组（非常简单的文件）并且它可以工作，但是最后会出现一个错误（至少我认为这是一个错误）。

数组的代码是；

```
int myArray[10][10];
for (int i = 0; i <= 9; ++i){

    for (int t = 0; t <=9; ++t){

        myArray[i][t] = i+t; //This will give each element a value

    }

}

for (int i = 0; i <= 9; ++i){

    for (int t = 0; t <=9; ++t){

        cout << myArray[i][t] << "\n";

    } 
```

这会正确打印数组，但会添加

“0x22fbb0”

最后。这是什么，为什么会发生？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T17:39:10.377

到目前为止，您显示的代码很好。打印的地址似乎不是从代码的那部分打印出来的。我可以想象两种情况。

*   您不小心打印了 myArray[i] 或 myArray 并忘记应用其他索引。当数组值转换为其第一个元素的地址时，它会导致打印一个地址。
*   你不小心像 cout << cout 一样打印 cout 本身。cout 隐式转换为指针类型（它用于检查类似 in 的健全状态`if(cout) { ... }`），这也会导致打印地址。

这可能是完全不同的情况。你能粘贴两个循环之后出现的代码吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T17:38:54.433

错误不在您发布的代码中。之后你有另一个 cout 吗？

0x22.... 看起来像一个内存地址，所以特别是你可能有一行读取

cout << myArray;

某处。

# shell - 当我的 shell 脚本退出时，如何终止后台进程/作业？

> ID：360201
> 
> 赞同：240
> 
> 时间：2008-12-11T17:33:00.950
> 
> 标签：shell

当我的顶级脚本退出时，我正在寻找一种清理混乱的方法。

特别是如果我想使用`set -e`，我希望脚本退出时后台进程会死掉。

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2008-12-11T17:57:33.040

收拾一些乱七八糟的，`trap`可以用。它可以提供特定信号到达时执行的内容列表：

```
trap "echo hello" SIGINT 
```

但也可用于在 shell 退出时执行某些操作：

```
trap "killall background" EXIT 
```

它是内置的，所以`help trap`会给你信息（与 bash 一起使用）。如果你只想杀死后台作业，你可以做

```
trap 'kill $(jobs -p)' EXIT 
```

注意使用 single `'`，以防止 shell`$()`立即替换。

* * *

## 回答 #2

> 赞同：212
> 
> 时间：2010-01-31T21:28:36.737

这对我有用（感谢评论者的改进）：

```
trap "trap - SIGTERM && kill -- -$$" SIGINT SIGTERM EXIT 
```

*   `kill -- -$$`向整个进程组发送[SIGTERM ，从而杀死后代。](http://www.opengroup.org/onlinepubs/009695399/functions/kill.html)

*   使用时指定信号`EXIT`很有用`set -e`（更多细节[在这里](http://www.davidpashley.com/articles/writing-robust-shell-scripts.html)）。

* * *

## 回答 #3

> 赞同：136
> 
> 时间：2014-03-25T19:04:22.193

更新：[https](https://stackoverflow.com/a/53714583/302079) : //stackoverflow.com/a/53714583/302079 通过添加退出状态和清理功能改进了这一点。

```
trap "exit" INT TERM
trap "kill 0" EXIT 
```

为什么要转换`INT`并`TERM`退出？因为两者都应该触发`kill 0`而不进入无限循环。

为什么触发`kill 0`？`EXIT`因为正常的脚本退出也应该触发`kill 0`。

为什么`kill 0`？因为嵌套的子壳也需要被杀死。这将取下[整个进程树](https://unix.stackexchange.com/a/67552/23316)。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-04-07T19:42:19.087

> 陷阱 'kill $(jobs -p)' 退出

我只会对 Johannes 的回答进行微小的更改，并使用 jobs -pr 来限制对正在运行的进程的终止，并在列表中添加更多信号：

```
trap 'kill $(jobs -pr)' SIGINT SIGTERM EXIT 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2015-02-05T00:06:03.610

[@tokland 的答案](https://stackoverflow.com/a/2173421/804678)`trap 'kill 0' SIGINT SIGTERM EXIT`中描述的解决方案非常好，但是最新的 Bash在使用时会[因分段错误而崩溃](https://bugs.launchpad.net/ubuntu/+source/bash/+bug/1337827)。这是因为从 v. 4.3 开始的 Bash 允许陷阱递归，在这种情况下它变得无限：

1.  shell 进程接收`SIGINT`or `SIGTERM`;`EXIT`
2.  信号被捕获，正在执行`kill 0`，它发送`SIGTERM`到组中的所有进程，包括 shell 本身；
3.  转到 1 :)

这可以通过手动取消注册陷阱来解决：

```
trap 'trap - SIGTERM && kill 0' SIGINT SIGTERM EXIT 
```

允许打印接收到的信号并避免“终止：”消息的更奇特的方式：

```
#!/usr/bin/env bash

trap_with_arg() { # from https://stackoverflow.com/a/2183063/804678
  local func="$1"; shift
  for sig in "$@"; do
    trap "$func $sig" "$sig"
  done
}

stop() {
  trap - SIGINT EXIT
  printf '\n%s\n' "received $1, killing child processes"
  kill -s SIGINT 0
}

trap_with_arg 'stop' EXIT SIGINT SIGTERM SIGHUP

{ i=0; while (( ++i )); do sleep 0.5 && echo "a: $i"; done } &
{ i=0; while (( ++i )); do sleep 0.6 && echo "b: $i"; done } &

while true; do read; done 
```

**UPD**：添加了一个最小示例；改进`stop`的功能，以避免捕获不必要的信号并从输出中隐藏“终止：”消息。感谢[特雷弗博伊德史密斯](https://stackoverflow.com/questions/360201/kill-background-process-when-shell-script-exit/2173421?noredirect=1#comment45402351_2173421)的建议！

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-06-15T03:51:21.247

为了安全起见，我发现最好定义一个清理函数并从陷阱中调用它：

```
cleanup() {
        local pids=$(jobs -pr)
        [ -n "$pids" ] && kill $pids
}
trap "cleanup" INT QUIT TERM EXIT [...] 
```

或完全避免该功能：

```
trap '[ -n "$(jobs -pr)" ] && kill $(jobs -pr)' INT QUIT TERM EXIT [...] 
```

为什么？因为通过简单地使用`trap 'kill $(jobs -pr)' [...]`一个假设，当陷阱条件发出信号时，*将会有后台作业运行。*当没有作业时，您将看到以下（或类似）消息：

```
kill: usage: kill [-s sigspec | -n signum | -sigspec] pid | jobspec ... or kill -l [sigspec] 
```

因为`jobs -pr`是空的——我在那个“陷阱”中结束​​了（双关语）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-12-10T22:23:27.013

```
function cleanup_func {
    sleep 0.5
    echo cleanup
}

trap "exit \$exit_code" INT TERM
trap "exit_code=\$?; cleanup_func; kill 0" EXIT

# exit 1
# exit 0 
```

像[https://stackoverflow.com/a/22644006/10082476](https://stackoverflow.com/a/22644006/10082476)一样，但添加了退出代码

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-09-14T21:01:41.507

一个在 Linux、BSD 和 MacOS X 下工作的好版本。首先尝试发送 SIGTERM，如果不成功，则在 10 秒后终止进程。

```
KillJobs() {
    for job in $(jobs -p); do
            kill -s SIGTERM $job > /dev/null 2>&1 || (sleep 10 && kill -9 $job > /dev/null 2>&1 &)

    done
}

TrapQuit() {
    # Whatever you need to clean here
    KillJobs
}

trap TrapQuit EXIT 
```

请注意，作业不包括孙进程。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-06-30T23:32:25.630

当我注意到如果我正在运行前台进程不会触发时，我结合了来自[http://veithen.github.io/2014/11/16/sigterm-propagation.html](http://veithen.github.io/2014/11/16/sigterm-propagation.html)的知识，对@tokland 的答案进行了改编`trap`（没有背景`&`）：

```
#!/bin/bash

# killable-shell.sh: Kills itself and all children (the whole process group) when killed.
# Adapted from http://stackoverflow.com/a/2173421 and http://veithen.github.io/2014/11/16/sigterm-propagation.html
# Note: Does not work (and cannot work) when the shell itself is killed with SIGKILL, for then the trap is not triggered.
trap "trap - SIGTERM && echo 'Caught SIGTERM, sending SIGTERM to process group' && kill -- -$$" SIGINT SIGTERM EXIT

echo $@
"$@" &
PID=$!
wait $PID
trap - SIGINT SIGTERM EXIT
wait $PID 
```

它的工作示例：

```
$ bash killable-shell.sh sleep 100
sleep 100
^Z
[1]  + 31568 suspended  bash killable-shell.sh sleep 100

$ ps aux | grep "sleep"
niklas   31568  0.0  0.0  19640  1440 pts/18   T    01:30   0:00 bash killable-shell.sh sleep 100
niklas   31569  0.0  0.0  14404   616 pts/18   T    01:30   0:00 sleep 100
niklas   31605  0.0  0.0  18956   936 pts/18   S+   01:30   0:00 grep --color=auto sleep

$ bg
[1]  + 31568 continued  bash killable-shell.sh sleep 100

$ kill 31568
Caught SIGTERM, sending SIGTERM to process group
[1]  + 31568 terminated  bash killable-shell.sh sleep 100

$ ps aux | grep "sleep"
niklas   31717  0.0  0.0  18956   936 pts/18   S+   01:31   0:00 grep --color=auto sleep 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-12-11T17:48:03.853

所以编写脚本的加载。运行`killall`脚本完成后立即执行的（或您的操作系统上可用的任何内容）命令。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-12-11T22:15:57.197

另一种选择是让脚本将自己设置为进程组负责人，并在退出时在进程组上捕获 killpg。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-12-12T11:37:48.233

如果在子 shell 中调用，jobs -p 不能在所有 shell 中工作，可能除非它的输出被重定向到文件而不是管道。（我认为它最初仅用于交互式使用。）

以下情况如何：

```
trap 'while kill %% 2>/dev/null; do jobs > /dev/null; done' INT TERM EXIT [...] 
```

Debian 的 dash shell 需要调用“jobs”，如果当前作业 (“%%”) 丢失，它将无法更新它。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2019-02-08T13:30:49.150

只是为了多样性，我将发布[https://stackoverflow.com/a/2173421/102484](https://stackoverflow.com/a/2173421/102484)的变体，因为该解决方案会在我的环境中导致消息“终止”：

```
trap 'test -z "$intrap" && export intrap=1 && kill -- -$$' SIGINT SIGTERM EXIT 
```

# c# - 从接口强制可序列化而不强制类在 C# 中自定义序列化

> ID：360208
> 
> 赞同：12
> 
> 时间：2008-12-11T17:34:20.370
> 
> 标签：c#, interface, serialization

我有一个接口，它定义了一些我希望某些类实现的方法。

```
公共接口IMyInterface
{
    方法A；
    方法B；
}

```

此外，我希望所有实现此接口的类都是可序列化的。如果我更改接口定义以实现 ISerializable 如下...：

```
公共接口 IMyInterface : ISerializable
{
    方法A；
    方法B；
}

```

...据我所知，所有类现在都必须显式实现序列化，因为如果实现 ISerializable，则必须实现 GetObjectData 成员（以及反序列化所需的构造函数）。

如何坚持使用我的接口的类是可序列化的，但又不强制它们自定义实现序列化？

谢谢，威尔

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T20:37:53.543

**似乎没有办法做到这一点**，但我希望有。

不过要注意两点：

*   **Serializable 属性不能从基类继承**，即使基类被标记为抽象。

*   如果您 **使用的是 XmlSerializer** ，从技术上讲，您**不需要 Serializable 属性，**因为它不使用对象图。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T18:14:06.187

如果要使用默认序列化，则需要添加 SerializableAttribute 。一种替代方法是使用抽象类而不是接口，然后将 SerializableAttribute 添加到抽象类。如果您正在实现自己的自定义序列化，那么您希望实现 ISerializable，否则坚持使用 SerializableAttribute。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-02T16:21:33.383

编写一个实现 ISerializationSurrogate 的类，并使用它来序列化不可序列化的类或您不确定序列化实现的类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T17:36:12.037

您可以编写自定义 FxCop 规则并根据它验证签入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T22:51:45.107

感谢您的回复。能够强制从接口派生的类实现序列化而不这样做，然后强制它们自定义序列化，但这似乎是不可能的。

# sql-server - SQLServer2005：将某些长文本数据类型的完整查询结果保存在文件中

> ID：360211
> 
> 赞同：2
> 
> 时间：2008-12-11T17:34:59.167
> 
> 标签：sql-server, sql-server-2005, file, text, ssms

假设有一张桌子

```
t (id int, someVeryLongText text) 
```

并希望存储查询结果：

```
select someVeryLongText from t where id = 1 
```

在文件中。

在 Managemant Studio 中，当我选择**Tools->Options->QueryResults**并选择**Results to File 时**，似乎只有前 8192 个字符被写入文件。

是否有一个选项可以强制它包含来自文本数据类型字段的所有数据而没有大小限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T18:09:30.033

尝试`SET TEXTSIZE <size_in_bytes>`获取要检索的最大文本量。

# sharepoint - Edit.aspx 中的 Sharepoint 条件字段

> ID：360216
> 
> 赞同：1
> 
> 时间：2008-12-11T17:36:52.673
> 
> 标签：sharepoint, sharepoint-2007, infopath, sharepoint-designer

我想根据字段的值在编辑表单中显示某些元数据字段。

示例：用户将文档上传到 Doclib 以由那里的经理批准。他们可以更改元数据名称、案例编号、位置，直到项目得到经理的批准。一旦项目获得批准，我想将名称和案例编号设置为只读。

满足此要求的最佳方法是什么？

如果批准 = 是，则设置名称和案例编号 = 只读 否则什么也不做。

* * *

我已经尝试了这种方法大约 5 个小时。我相信这对于 ModerationStatus 可能有所不同。可能需要一些特别的东西

```
print("<xsl:choose>
<xsl:when test="@_ModerationStatus != '0;#approved'">               
<SharePoint:FormField runat="server" id="ff12{$Pos}" ControlMode="Edit" FieldName="Test_x0020_Session" __designer:bind="{ddwrt:DataBind('u',concat('ff12',$Pos),'Value','ValueChanged','ID',ddwrt:EscapeDelims(string(@ID)),'@Test_x0020_Session')}"/>
<SharePoint:FieldDescription runat="server" id="ff12description{$Pos}" FieldName="Test_x0020_Session" ControlMode="Edit"/>                      
</xsl:when>
<xsl:otherwise>
     <xsl:value-of select="@Test_x0020_Session"></xsl:value-of>
</xsl:otherwise> 
```

");

我可以让它与其他领域一起工作，但不是 ModerationStatus。我也尝试将其更改为 !='0' 和 !='Approved' 和 '0;#Approved'。有什么我做错了吗？

似乎它停留在 0;#Approved

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-14T20:14:58.457

这可以通过 SharePoint Designer 轻松解决。

*   您将需要为您的列表修改**EditForm.aspx**
*   隐藏默认的**ListFormWebPart**（不要删除它！）
*   插入自定义编辑项表单（[更多详细信息...](http://office.microsoft.com/en-us/sharepointdesigner/HA101191111033.aspx)）

自定义表单看起来与默认表单完全相同，但您可以使用 SharePoint Designer 对其进行自定义。下面的代码可用于默认 WSS 问题列表。*当Issue Status = Closed*时，它会将问题标题显示为只读。

```
<xsl:choose>
    <xsl:when test="@Status != 'Closed'">
        <SharePoint:FormField runat="server" id="ff1{$Pos}" ControlMode="Edit" FieldName="Title" __designer:bind="{ddwrt:DataBind('u',concat('ff1',$Pos),'Value','ValueChanged','ID',ddwrt:EscapeDelims(string(@ID)),'@Title')}"/>
        <SharePoint:FieldDescription runat="server" id="ff1description{$Pos}" FieldName="Title" ControlMode="Edit"/>
    </xsl:when>
    <xsl:otherwise>
        <xsl:value-of select="@Title"></xsl:value-of>
    </xsl:otherwise>
</xsl:choose> 
```

您可以为您的自定义列表或/和要求应用相同的逻辑。

像往常一样，您可能会遇到一些其他问题。我无法在数据视图 Web 部件中获取 @_ModerationStatus 的值。我不知道确切的原因...

这是一个简单的解决方法：

1.  在您的文档库中创建一个列
2.  在工作流 SharePoint Designer 中新建一个。

它应该在项目更改时触发并将批准状态的值复制到新创建的列。

您可以使用自定义列进行条件格式设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-18T13:05:09.913

遵循 Toni 的评论，但对于您的*_ModerationStatus*字段，请使用以下 XSLT 函数：

```
<xsl:when test="not(starts-with(@_ModerationStatus,'0'))"> 
```

# perl - 如何跳到 Perl 中的特定输入行？

> ID：360219
> 
> 赞同：5
> 
> 时间：2008-12-11T17:37:49.630
> 
> 标签：perl, loops

我想跳到包含“include”的第一行。

```
<> until /include/; 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-11T17:46:28.520

match 运算符默认为 using `$_`，但默认情况下该`<>`运算符不会存储到`$_`其中，除非它在 ​​while 循环中使用，因此没有任何内容存储在`$_`.

来自`perldoc perlop`：

```
   I/O 操作符
   ...

   通常你必须将返回的值赋给一个变量，但是
   是发生自动分配的一种情况。当且仅当
   输入符号是“while”条件内的唯一内容
   语句（即使伪装成“for(;;)”循环），值是自动的
   自动分配给全局变量 $_，销毁所有
   以前有。（这对你来说可能看起来很奇怪，但你会
   几乎在您编写的每个 Perl 脚本中都使用该结构。） $_ 变量
   能够不是隐式本地化的。您必须输入“本地 $_;”
   如果您希望发生这种情况，请在循环之前。

   以下几行是等效的：

       而 (定义($_ = )) { 打印; }
       而 ($_ = ) { 打印; }
       while () { 打印；}
       对于 (;;) { 打印; }
       定义时打印（$_ = ）；
       打印而 ($_ = );
       打印而；

   这也表现类似，但避免了 $_ ：

       而 (我的 $line = ) { 打印 $line }

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T17:51:41.817

`<>`只是`while(<>)`构造中的魔法。否则它不会分配给`$_`，因此`/include/`正则表达式没有可匹配的内容。如果你用`-w`Perl 运行它会告诉你：

```
Use of uninitialized value in pattern match (m//) at .... 
```

您可以使用以下方法解决此问题：

```
$_ = <> until /include/; 
```

为了避免警告：

```
while(<>)
{
    last if /include/;
} 
```

# web-services - JMeter 和 Java Web 服务在下班后停止

> ID：360225
> 
> 赞同：2
> 
> 时间：2008-12-11T17:38:27.150
> 
> 标签：web-services, jmeter

我正在尝试使用 JMeter 测试 Web 服务的压力测试，但请求在大约 4 小时后继续停止。

我每秒从 JMeter 提交 10 个请求。JMeter 完成后，Web 服务仍然正常运行。我只使用了 1 个肥皂请求，并且我没有指定对肥皂响应进行辐射。

为什么JMeter在一定时间后放弃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-07T21:45:46.907

有几个建议可以检查：

1.  使用最新版本的 JMeter。
2.  使用最新/不同的 JDK 版本/供应商。
3.  尝试在命令行模式下运行 JMeter（如果您之前在 GUI 中运行过它）。
4.  检查客户端和服务器之间的网络/防火墙设置。

# emacs - 修改缓冲区时如何运行 Emacs 挂钩？

> ID：360232
> 
> 赞同：4
> 
> 时间：2008-12-11T17:41:23.617
> 
> 标签：emacs, tabs, elisp, buffer

建立在[让 Emacs 在保存某些文件类型（并且只有那些文件类型）时取消制表符](https://stackoverflow.com/questions/318553/getting-emacs-to-untabify-when-saving-files)的基础上，我想在我开始修改缓冲区时运行一个挂钩来取消我的 C++ 文件的制表符。我尝试添加钩子以在加载时取消缓冲，但随后它取消了我所有在 emacs 启动时自动加载的可写文件。

（对于那些想知道我为什么这样做的人，这是因为我工作的地方强制在文件中使用制表符，我很乐意遵守。问题是我标记了我的文件以告诉我何时行太长，但正则表达式匹配行中的字符数，而不是行占用多少空间。一行中的 4 个制表符可以将其推到远远超过我的 132 个字符限制，但该行不会被正确标记。因此，我需要一种自动制表和取消制表的方法。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T18:41:43.200

看一下变量“before-change-functions”。

也许沿着这条线（警告：代码未测试）：

```
(add-hook 'before-change-functions 
          (lambda (&rest args) 
            (if (not (buffer-modified-p))
                (untabify (point-min) (point-max))))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T18:36:03.337

这是我添加到我的 emacs 文件以在加载时取消制表符的内容：

```
(defun untabify-buffer ()
  "Untabify current buffer"
  (interactive)
  (untabify (point-min) (point-max)))

(defun untabify-hook ()
  (untabify-buffer))

; Add the untabify hook to any modes you want untabified on load
(add-hook 'nxml-mode-hook 'untabify-hook) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T18:58:42.900

这个答案是切线的，但可能有用。

当光标经过给定列时，包 wide-column.el[链接文本](http://homepages.cs.ncl.ac.uk/phillip.lord/download/emacs/wide-column.el)会更改光标颜色 - 实际上光标颜色可能会因设置而异。这听起来像一个比您的正则表达式代码更少侵入性的解决方案，但它可能不适合您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T19:12:22.700

还有一个不同的切线答案。

您提到您的正则表达式不足以判断何时达到 132 个字符的限制。也许一个更好的正则表达式......

假设制表符宽度为 4，此正则表达式将匹配超过 132 个字符的行。（我想我的数学是正确的）

```
"^\\(?: \\|[^   \n]\\{4\\}\\)\\{33\\}\\(.+\\)$" 
```

最后一个带括号的表达式是超出限制的字符集。第一个带括号的表达式是[shy](http://www.gnu.org/software/emacs/elisp/html_node/Regexp-Backslash.html)。

# asp.net - 读取 XML 节点

> ID：360234
> 
> 赞同：0
> 
> 时间：2008-12-11T17:43:10.103
> 
> 标签：asp.net, xml, readxml

我想读取一个特定的 xml 节点，例如它的值

```
<customers>
<name>John</name>
<lastname>fetcher</lastname>
</customer> 
```

我背后的代码应该是这样的（我不知道它应该是怎样的 :)）

```
Response.Write(xml.Node["name"].Value) 
```

呸呸呸。正如我所说，这只是一个例子，因为我不知道该怎么做。所以你能帮我吗？

谢谢。

问候..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T17:48:06.553

您使用的是哪个版本的 .NET？如果您使用的是 .NET 3.5 并且可以使用 LINQ to XML，那么它很简单：

```
document.Descendant("name").Value 
```

（除了一些错误处理！）如果你对 DOM API 很感兴趣，你可能想要：

```
document.SelectSingleNode("//name").InnerText 
```

请注意，这并没有显示任何关于您如何阅读 XML 的信息 - 如果您需要这方面的帮助，请在问题中提供更多详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T17:50:31.930

最基本的答案：
假设“xml”是一个 XMLDocument、XMLNodeList、XMLNode 等......

```
Response.Write(xml.SelectSingleNode("//name").innerText) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T17:52:13.377

如果使用早期版本的 .Net 框架，请先查看[XMLDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)类，因为这是您将 XML 字符串加载到其中的内容。[XMLElement](http://msdn.microsoft.com/en-us/library/system.xml.xmlelement.aspx)和[XMLNode](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.aspx)等子类也可用于完成其中的一些工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T17:54:32.030

尚未尝试对其进行测试，但无论如何都应该为您指明正确的方向

```
 'Create the XML Document
 Dim l_xmld As XmlDocument
'Create the XML Node
        Dim l_node As XmlNode

            l_xmld = New XmlDocument

            'Load the Xml file
            l_xmld.LoadXml("XML Filename as String")

            'get the attributes
            l_node = l_xmld.SelectSingleNode("/customers/name")

           Response.Write(l_node.InnerText) 
```

# algorithm - 烟雾中寻路

> ID：360236
> 
> 赞同：0
> 
> 时间：2008-12-11T17:43:17.280
> 
> 标签：algorithm, path-finding, fluid

我曾经发现一篇关于通过涉及烟雾（一般是流体）的模拟来寻找路径的论文。有没有人读过这样的东西？我不记得论文的名字或作者的名字。如果你知道这样的论文，请告诉我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T18:05:51.977

这看起来像这样的论文：

[使用流体模拟进行逼真的人体路径规划](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.59.5987)

# opengl - 动态更改 3D RGBA 纹理的 Alpha 值

> ID：360238
> 
> 赞同：1
> 
> 时间：2008-12-11T17:43:24.953
> 
> 标签：opengl

我正在使用 3D 纹理对原始数据进行体积渲染。原始数据可以是 Luminance-Alpha 或 RGBA。

目前，我读取原始数据并设置 alpha 值，使得最远的行（或切片）将是不透明的（Alpha = 1），而最近的切片将是“透明的”（比如 alpha = 0.1），并且 alpha 值被插值.

在 opengl 中有什么方法可以动态更改这些 alpha 值。即基于像旋转这样的事件？这样最远的切片总是不透明的？

我正在使用场景图工具 (www.openrm.org) 进行基于纹理的体积渲染。

我想我不是在寻找代码，而是我可以使用 OpenGL 在 GPU 中有效地做到这一点的任何想法。

* * *

这一篇讲的是“per slice alpha weight”，这是我打算做的（看最后的伪代码）

[http://www.ifi.uzh.ch/staff/stern/SciVis_WS2004/chstern/v100105/VolumeRendering/kulick/](http://www.ifi.uzh.ch/staff/stern/SciVis_WS2004/chstern/v100105/VolumeRendering/kulick/)

现在，诀窍是随着方向的变化重新计算每个切片的 alpha 权重。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T22:24:23.623

听起来像是着色器的完美工作......

但是，如果您使用轴对齐切片并在 CPU 上创建它们，您可以设置一个带有 alpha-component <= 1.0 的 glColor4f，并将 glTexEnv 设置为 GL_MODULATE。然后颜色值将与纹理的颜色值相乘。

# asp.net - 在构建时将库项目 XML 输出到 asp.net bin 文件夹？

> ID：360241
> 
> 赞同：0
> 
> 时间：2008-12-11T17:44:24.313
> 
> 标签：asp.net, xml, visual-studio, projects-and-solutions

我有一个 Visual Studio 2005 解决方案，它有一个 Web 应用程序和一个类库项目。Web 应用程序具有对库项目的引用。我希望库项目的代码文档 XML 与库的 DLL 一起输出到 Web 应用程序的 bin 文件夹。我似乎找不到任何简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T17:49:27.063

也许是构建后步骤？有点难看，但我认为它会工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T17:51:33.783

在库项目上使用构建后事件，将 Xml 文件复制到 Web 应用程序的 bin 文件夹。

例如，您可以使用类似：复制 $(TargetDir)\ $(SolutionDir)\

这是未经测试的，因此您需要对其进行调整。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T15:42:44.983

不确定这在 VS 2005 中是否可行，但在 VS 2010 中：

右键单击您的 xml 文件并转到属性将“复制到输出目录”更改为“如果较新则复制”或“始终复制”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T16:52:25.853

这是有效的构建后命令：

```
copy "$(TargetDir)$(TargetName).xml" "$(SolutionDir)MyWebProject1\bin\$(TargetName).xml"
copy "$(TargetDir)$(TargetName).xml" "$(SolutionDir)MyWebProject2\bin\$(TargetName).xml" 
```

此解决方案固有的几个问题：

*   即使该网站不是当前构建的一部分，也始终会复制 xml……因此文档可能与 bin 文件夹中的 dll 不同步，直到下一次构建该 Web 项目。
*   如果我们添加一个引用该库的新 Web 项目，我们需要添加另一个构建后命令，而不是让这一切自动发生。

我接受这是一个笨拙但可行的解决方案......如果有人有更优雅的建议，请告诉我！

# delphi - 我可以在事件处理程序上使用闭包吗（即 TButton OnClick）

> ID：360254
> 
> 赞同：14
> 
> 时间：2008-12-11T17:49:24.897
> 
> 标签：delphi, delphi-2009

如果我尝试在事件处理程序上使用闭包，编译器会抱怨：

不兼容的类型：“方法指针和常规过程”

我理解..但是有没有办法在方法指针上使用 clouser？以及如何定义是否可以？

例如：

```
Button1.Onclick = procedure( sender : tobject ) begin ... end; 
```

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-04-13T10:13:15.553

```
@Button1.OnClick := pPointer(Cardinal(pPointer( procedure (sender: tObject) 
begin 
  ((sender as TButton).Owner as TForm).Caption := 'Freedom to anonymous methods!' 

end )^ ) + $0C)^; 
```

2010年在德尔福[工作](http://codenoid.blogspot.com/2011/04/anonymous-methods-as-events-in-delphi.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-23T11:45:54.777

一个很好的问题。

据我所知，在当前版本的 Delphi 中是不可能的。这是非常不幸的，因为这些匿名过程非常适合快速设置对象的事件处理程序，例如在 xUnit 类型的自动测试框架中设置测试装置时。

CodeGear 应该有两种方式来实现这个特性：

1：允许创建匿名方法。像这样的东西：

```
Button1.OnClick := procedure( sender : tobject ) of object begin
  ...
end; 
```

这里的问题是把什么作为匿名方法的自指针。可以使用创建匿名方法的对象的自指针，但只能从对象上下文创建匿名方法。一个更好的主意可能是在幕后简单地创建一个虚拟对象来包含匿名方法。

2：或者，可以允许事件类型同时接受方法和过程，只要它们共享定义的签名。通过这种方式，您可以按照您想要的方式创建事件处理程序：

```
Button1.OnClick := procedure( sender : tobject ) begin
  ...
end; 
```

在我看来，这是最好的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-04T09:35:39.483

在以前的 Delphi 版本中，您可以通过将隐藏的 self 指针添加到参数并对其进行硬类型转换来使用常规过程作为事件处理程序：

```
procedure MyFakeMethod(_self: pointer; _Sender: TObject);
begin
  // do not access _self here! It is not valid
  ...
end;

...

var
  Meth: TMethod;
begin
  Meth.Data := nil;
  Meth.Code := @MyFakeMethod;
  Button1.OnClick := TNotifyEvent(Meth);
end; 
```

我不确定上面是否真的编译，但它应该给你一个大致的想法。我以前做过这个，它适用于常规程序。因为我不知道编译器为闭包生成什么代码，所以我不能说这是否适用于它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-18T16:35:28.813

它很容易扩展下面来处理更多的表单事件类型。

用法

```
procedure TForm36.Button2Click(Sender: TObject);
var
  Win: TForm;
begin
  Win:= TForm.Create(Self);
  Win.OnClick:= TEventComponent.NotifyEvent(Win, procedure begin ShowMessage('Hello'); Win.Free; end);
  Win.Show;
end; 
```

代码

```
unit AnonEvents;

interface
uses
  SysUtils, Classes;

type
  TEventComponent = class(TComponent)
  protected
    FAnon: TProc;
    procedure Notify(Sender: TObject);
    class function MakeComponent(const AOwner: TComponent; const AProc: TProc): TEventComponent;
  public
    class function NotifyEvent(const AOwner: TComponent; const AProc: TProc): TNotifyEvent;
  end;

implementation

{ TEventComponent }

class function TEventComponent.MakeComponent(const AOwner: TComponent;
  const AProc: TProc): TEventComponent;
begin
  Result:= TEventComponent.Create(AOwner);
  Result.FAnon:= AProc;
end;

procedure TEventComponent.Notify(Sender: TObject);
begin
  FAnon();
end;

class function TEventComponent.NotifyEvent(const AOwner: TComponent;
  const AProc: TProc): TNotifyEvent;
begin
  Result:= MakeComponent(AOwner, AProc).Notify;
end;

end. 
```

# c# - 自动完成 - 附加并仅获取用户在组合框中输入的文本

> ID：360257
> 
> 赞同：1
> 
> 时间：2008-12-11T17:49:43.443
> 
> 标签：c#, winforms, autocomplete

我有一个`ComboBox`这样设置的：

```
this.cmbCustomerJob.DisplayMember = "display";
this.cmbCustomerJob.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
this.cmbCustomerJob.AutoCompleteSource = AutoCompleteSource.ListItems;
this.cmbCustomerJob.DropDownStyle = ComboBoxStyle.DropDown; 
```

但是我搞乱了`KeyPressed`事件以防止用户在 中输入新术语`ComboBox`，但是当我这样做时，`cmbCustomerJob.Text`它甚至会返回建议的部分，我怎样才能只获得用户输入的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T19:09:16.810

我找到了答案，我这样做了：

```
strNew = ((ComboBox)sender).Text.Substring(0, ((ComboBox)sender).SelectionStart) + c.ToString(); 
```

`Text`它从开始 ( `0`) 到选择开始 ( `SelectionStart`)抓取，`c.ToString()`是`KeyPressEventArgs.KeyChar`

# c++ - SFTP C++ 库？

> ID：360259
> 
> 赞同：9
> 
> 时间：2008-12-11T17:50:44.800
> 
> 标签：c++, sftp

任何人都可以推荐一个体面的 SFTP 库来与 Windows C++ 应用程序一起使用吗？如果可以使用跨平台的，那就更好了，但这不是必需的。它用于商业应用程序，因此付费不是问题。

我正在使用支持 FTP-S 但不支持 SFTP 的出色的[Ultimate TCP/IP](http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx)库（是的，我知道，不是很混乱！）。

我遇到过[Chilkat](http://www.chilkatsoft.com/ssh-sftp-c++.asp)图书馆，它看起来很不错，但想知道是否还有其他人用过。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T17:58:06.797

查看[libcurl](http://curl.haxx.se/libcurl/)。

> libcurl 是一个免费且易于使用的客户端 URL 传输库，支持 FTP、FTPS、HTTP、HTTPS、SCP、SFTP、TFTP、TELNET、DICT、LDAP、LDAPS 和 FILE。libcurl 支持 SSL 证书、HTTP POST、HTTP PUT、FTP 上传、基于 HTTP 表单的上传、代理、cookie、用户+密码身份验证（Basic、Digest、NTLM、Negotiate、Kerberos4）、文件传输恢复、http 代理隧道等等！
> 
> libcurl 是高度可移植的，它可以在多种平台上构建和工作，包括 Solaris、NetBSD、FreeBSD、OpenBSD、Darwin、HPUX、IRIX、AIX、Tru64、Linux、UnixWare、HURD、Windows、Amiga、OS/2、BeOs、Mac OS X、Ultrix、QNX、OpenVMS、RISC OS、Novell NetWare、DOS 等...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T17:58:53.893

[OpenSSH](http://www.openssh.com/)将是一个不错的选择。它是跨平台的，并附带 BSD 许可证，因此您可以在商业应用程序中使用它，而无需透露您的源代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-24T00:33:12.047

您可以在 windows 下使用 libssh 进行 SFTP。编译时必须有 ssh.lib，执行程序时必须有 ssh.dll。它对我来说很好。此示例代码是使用 ssh1 的客户端，我还支持大文件（4GB 及更多）和暂停/恢复。客户端将与任何 ssh（和/或 SFTP）服务器一起使用。由于 stackoverflow 中消息长度的限制，我无法为您复制整个代码。

```
main()
{
pSFTPConnector  sshc = new  SFTPConnector(L".\\", L"127.0.0.1", 22, L"sftpuser",L"sftppassword");  // change the hostname , port , username, password to your sftp server, your credentials

FILE *nullfile = fopen("null", "w");  
sshc->setLogFile(nullfile);
sshc->setVerbosity(SSH_LOG_DEBUG);  // you can change the verbosity as appropriate for you

int i=  sshc->InitSession();
if (i != E_OK) wprintf(L"%s",sshc->errstring.c_str() );
i=sshc->ConnectSession();
if (i != E_OK) wprintf(L"%s", sshc->errstring.c_str());

i = sshc->InitSFTP();
if (i != E_OK) wprintf(L"%s", sshc->errstring.c_str());

i = sshc->SFTPrename("renamed_myfile.txt", "myfile.txt");  //change these file names
i = sshc->Makedir("sftpdir");
i = sshc->testUploadFile("myfile2.txt", "1234567890testfile");

// change these file names to whatever appropriate

i = sshc->SFTPreget("c:\\testdir\\reget_downloaded_CAR_HIRE_FINAL.jpg", "CAR_HIRE_FINAL.jpg", 64 * 1024);
sshc->setBlockTransferDelay(1);

i = sshc->GetSessionStatus();
i = sshc->SFTPreput("c:\\testdir\\CentOS-6.5-x86_64-bin-DVD1.iso", "reput_CentOS-6.5-x86_64-bin-DVD1.iso", 64 * 1024);
i = sshc->SFTPreput("c:\\testdir\\Reget_CentOS-6.5-x86_64-bin-DVD1.iso", "reput2_CentOS-6.5-x86_64-bin-DVD1.iso", 64 * 1024);

if (i != E_OK) wprintf(L"%s", sshc->errstring.c_str());
delete sshc;
getchar();
return 0;
} 
```

这是类文件：

```
// filename ssh.h
// SFTP Connection class with Pause/Resume largfiles capability
// uses libssh for sftp functionality.
// Author Desphilboy
// Written 21 Sep 2014

// needed include files on a windows system
// for linux, native file open and read/write functions must be changed.

#include <libssh\libssh.h>
#include <libssh\sftp.h>
#include <Windows.h>
#include <string>
#include <fcntl.h>
#include  <sys\types.h>
#include <sys\stat.h>
#include <time.h>
#include <fstream>
#include <iostream>
#include <process.h>
using namespace std;

// constant to limit length of character strings
#define SHORT_BUFF_LEN          1024
#define INITIALBLOCKTRANSDELAY          10          // mili seconds, this is the delay that we put after  each block transfer to make it posssible for network to absorb the data.

// these values will be returned by functions to report error or success
typedef enum sshconerr{
    E_OK = 1, E_SESSION_ALOC = -1, E_SSH_CONNECT_ERR = -2, E_SFTP_ALLOC = -3, E_INIT_SFTP = -4, E_CREATE_DIR = -5, E_FILEOPEN_WRITE = -6, E_WRITE_ERR = -7
    , E_FILE_CLOSE = -8, E_FILE_OPEN_READ = -9, E_INVALID_PARAMS = -10, E_SFTP_ERR = -11, E_SFTP_READ_ERR = -12, E_SFTP_READBYTES_ERR = -13, E_GET_FILEINF = -14
    , E_LOCAL_FILE_NOTFOUND = -15, E_RENAME_ERR = -16, E_MEM_ALLOC = -17, E_LOCAL_FILE_READ = -18, E_LOCAL_FILE_RDWR = -19, E_REMOTEFILE_SEEK = -20
    , E_REMOTE_FILE_OPEN = -21, E_DELETE_ERR = -22, E_RENAME_LOCAL_FILE = -23, E_LOCAL_DELETE_FILE = -24, E_FILEOPEN_RDONLY = -25, E_SFTP_READ_EOF=-26
    ,E_AUTHENTICATE=-27                 ,E_UNKNOWN=-999 } ESSHERR;

// status of transfers;
typedef enum sftpstat{ ES_DONE=0 , ES_INPROGRESS , ES_FAILED, ES_STARTING, ES_PAUSED, ES_RESUMING, ES_CANCELLED,  ES_NONE  } ESFTPSTAT;

using namespace std;

// statistics about the transfer;
typedef struct transferstatstruct {
    string remote_file_name;
    string local_file_name;
    __int64  initially_transferred;
    __int64  total_size;
    __int64  transferred;
    __int64  averagebps;
    __int64 seconds_elapsed;
    __int64     seconds_remained;
    int percent;    
    ESFTPSTAT transferstate;
} TTransStat;

#define E_SESSION_NEW   -1

// these libraries are required
#pragma comment(lib, "ssh.lib")         // for ex4ecution in windows, ssh.dll is needed

// this is the main class that does the majority of the work

typedef class CSFTPConnector{

private:

    ssh_session  session;                 // ssh session
    sftp_session sftp;                      // sftp session
    sftp_file file;                         // structure for a remote file
    FILE *localfile;                        // not used in windows but could be local file pointer in UNIX
    FILE *logfile;                          // the file for writing logs, default is set to stderr
    string filename;                        // file name of the transfer;
    string localfilename;                   // file name of local file;
    string      tempfilename;               // a temporaty file name will be used during the transfer which is renamed when transfer is completed.
    ESFTPSTAT transferstatus;               // state of the transfer which has one of the above values (ESFTPSTAT)

    __int64 transferstarttime;              // time of start of the transfer
    wchar_t username[SHORT_BUFF_LEN];
    wchar_t password[SHORT_BUFF_LEN];
    wchar_t hostname[SHORT_BUFF_LEN];       // hostname of the sftp server
    wchar_t basedir[SHORT_BUFF_LEN];        // this base dir is the directory of public and private key structur ( NOT USED IN THIS VERSION)
    int port;                               //  port of the server;
    int verbosity;                          //  degree of verbosity of libssh
    __int64  filesize;                      //  total number of bytes to be transfered;
    DWORD  local_file_size_hiDWORD;         //  Bill Gates cannot accept the file size without twisting the programmers, so he accepts them in 2 separate words like this
    DWORD  local_file_size_lowDWORD;        //  these 2 DWORDs when connected together comprise a 64 bit file size.
    __int64 lfilesize;                          // local file size
    __int64 rfilesize;                          // remote file size
    __int64 transfered;                         // number of bytes already transfered
    __int64 initially_was_transferred;          // this is the number of bytes which was transferred before pause or interrupt of a transfer and used when resuming a transfer.
    bool pause;                                 // pause flag
    TTransStat stats;                           // statistics of the transfer
    HANDLE  localfilehandle;                    // windows uses handles to manipulate files. this is the handle to local file.
    int blocktransferdelay;

    ESSHERR CSFTPConnector::rwopen_existing_SFTPfile(char *fn);         // open a file on remote ( server ) read/write   for upload
    ESSHERR CSFTPConnector::rdopen_existing_SFTPfile(char *fn);         // open a file on remote ( server ) read only    for download
    ESSHERR createSFTPfile(char *fn);                                   // create a file on server;
    ESSHERR writeSFTPfile(char *block, size_t blocksize);               // write a block of data to the  open remote file
    ESSHERR readSFTPfile(char *block, size_t len, size_t *bytesread);   // read a block of data from the  open remote file
    ESSHERR readSFTPfile(char *block, __int64 len, DWORD *bytesread);
    ESSHERR closeSFTPfile();        // closes the remote file;
    ESSHERR openSFTPfile(char *fn);  // opens the remote file
    ESSHERR getSFTPfileinfo();          // gets information about the remote file

public:
    wstring errstring;      // the string describing last error 
    ESSHERR Err;                // error code of last error
    CSFTPConnector();           // default constructor;
    CSFTPConnector(wchar_t *dir, wchar_t *hn, int hostport, wchar_t *un, wchar_t *pass);  // constructor
    void setVerbosity(int v);       
    int  getVerbosity();
    ESSHERR InitSession();          // must be called befor doing any transfer
    ESSHERR ConnectSession();       // connnects to the  ssh server
    ESSHERR InitSFTP();     // must be called befor doing any transfer
    ESSHERR Makedir(char *newdir);
    ESSHERR testUploadFile(char *fn, char *block);          // do not use this , only for test purposes for myself
    ESSHERR SFTPput(char *lfn, char *rfn, size_t blocksize);            // Upload a file from start
    ESSHERR SFTPreput(char *lfn, char *rfn, size_t blocksize);          // checks for previouse interrupted transfer, then either continues the previouse transfer ( if there was any) or starts a new one (UPLOAD)
    ESSHERR SFTPrename(char *newname, char *oldname);                   // renames a remote file( must be closed)
    ESSHERR CSFTPConnector::SFTPdelete(char *remfile);                  // deletes a remote file
    TTransStat *getStatus();                                                // gets statistics of the transfer
    ESSHERR CSFTPConnector::SFTPget(char *lfn, char *rfn, size_t blocksize);    // Downloads a file from  sftp server
    ESSHERR CSFTPConnector::SFTPreget(char *lfn, char *rfn, size_t blocksize);  // checks for previouse interrupted transfer, then either continues the previouse transfer ( if there was any) or starts a new one (DOWNLOAD)
    void    CancelTransfer();
    void    PauseTransfer();
    void    setLogFile(FILE *logf);         // sets the log file, if not set stderr will be used. by default.
    void    CloseLocalFile();
    void    CloseRemoteFile();
    int GetSessionStatus();
    bool  IsConnected(); 
    void setBlockTransferDelay(int miliseconds);
    ESFTPSTAT getTransferStatus();
    ~CSFTPConnector();

} SFTPConnector, *pSFTPConnector ;

sftpstat CSFTPConnector::getTransferStatus()
{
    return  transferstatus;
}

void CSFTPConnector::setBlockTransferDelay(int miliseconds)
{
    blocktransferdelay = miliseconds;

}

bool CSFTPConnector::IsConnected()
{
    if (ssh_is_connected(session) == 1) return true;
    return false;
}

int CSFTPConnector::GetSessionStatus()
{
    return ssh_get_status(session);
}

void    CSFTPConnector::CloseLocalFile()
{
    CloseHandle(localfilehandle);
}

void    CSFTPConnector::CloseRemoteFile()
{
    sftp_close(file);
}

void    CSFTPConnector::setLogFile(FILE *logf)
{
    logfile = logf;
}

void    CSFTPConnector::CancelTransfer()
{
    transferstatus = ES_CANCELLED;

}
void    CSFTPConnector::PauseTransfer()
{
    transferstatus = ES_PAUSED;
    pause = true;
}

//----------------------------------------

// SFTPreger starts or resumes a download.
ESSHERR CSFTPConnector::SFTPreget(char *lfn, char *rfn, size_t blocksize)
{
    ESSHERR     result;
    int rc;
    BOOL  bresult;
    DWORD bytesread;
    DWORD byteswritten;
    filesize = 0;
    transfered = 0;
    initially_was_transferred = 0;
    lfilesize = rfilesize = 0;
    pause = false;
    transferstatus = ES_NONE;
    char *block;
    struct stat st;
    wchar_t temp[SHORT_BUFF_LEN];
    size_t tempsize;
    wstring wlfn;
    int loopcounter = 0;

    localfilename = lfn;
    filename = rfn;

    tempfilename = string(lfn) + ".sftp_temp";
    mbstowcs_s(&tempsize, temp, tempfilename.c_str(), SHORT_BUFF_LEN);

    localfilehandle = CreateFile(temp, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
    if (localfilehandle == INVALID_HANDLE_VALUE)
    {
        transferstatus = ES_FAILED;
        errstring = L"Could not open local file:" + wstring(temp) +L" for read and write";
        Err = E_LOCAL_FILE_RDWR;
        return E_LOCAL_FILE_RDWR;
    }
    local_file_size_lowDWORD = GetFileSize(localfilehandle, &local_file_size_hiDWORD);
    lfilesize = (local_file_size_hiDWORD * 0x100000000) + local_file_size_lowDWORD;

    if (lfilesize < 0) {
        transferstatus = ES_FAILED;
        Err = E_LOCAL_FILE_NOTFOUND;
        errstring = L"Could not get size info for file:" + wstring(temp); 
        CloseLocalFile();
        return E_LOCAL_FILE_NOTFOUND;
    }

    transfered = lfilesize;
    initially_was_transferred = lfilesize;

    __int64 tempi64 = transfered & 0x00000000FFFFFFFF;
    DWORD dwlow = tempi64;
    tempi64 = (transfered  & 0x7FFFFFFF00000000);
    tempi64 = tempi64 >> 32;
    long  dwhi = tempi64;
    DWORD dwResult = SetFilePointer(localfilehandle, dwlow, &dwhi, FILE_BEGIN);
    if (dwResult == INVALID_SET_FILE_POINTER)
    {
        errstring = L"could not set file pointer for localfile" + wstring(temp);
        transferstatus = ES_FAILED; Err = result; 
        CloseLocalFile();
        return result;
    }

    block = (char*)malloc(blocksize + 1);
    if (block == NULL) {
        Err = E_MEM_ALLOC;
        transferstatus = ES_FAILED;
        errstring = L"Could not allocate memory for file block size";
        CloseLocalFile();
        return E_MEM_ALLOC;
    }

    result = rdopen_existing_SFTPfile((char *)rfn);

    if (result == E_OK){
        getSFTPfileinfo();
        filesize = rfilesize;       
    }
    else
    {
        Err = E_REMOTE_FILE_OPEN;
        transferstatus = ES_FAILED;
        errstring = L"Could not open remote file";
        CloseLocalFile();
        delete block;
        return E_REMOTE_FILE_OPEN;
    }

    rc=sftp_seek64(file, transfered);
    if (rc != SSH_OK)
    {
        Err = E_REMOTEFILE_SEEK;
        transferstatus = ES_FAILED;
        errstring = L"Could not set pointer for remote file";
        CloseRemoteFile();
        CloseLocalFile();
        delete block;
        return E_REMOTEFILE_SEEK;
    }

        transferstatus = ES_RESUMING;

    sftp_file_set_blocking(file);

    transferstarttime = time(NULL);
    transferstatus = ES_INPROGRESS;

    while (transferstatus != ES_FAILED && transferstatus != ES_PAUSED &&  transferstatus!=ES_CANCELLED  &&transferstatus != ES_DONE)
    {
        loopcounter++;

        result = readSFTPfile(block,blocksize, (size_t *) &bytesread);
        if (result != E_OK && result != E_SFTP_READ_EOF)
        {
            errstring = L"Error reading from remote sftp server file.";
            Err = result;
            transferstatus = ES_FAILED;
            CloseRemoteFile();
            CloseLocalFile();
            delete block;
            return result;
        }
        if (result == E_SFTP_READ_EOF)  transferstatus = ES_DONE;
        fprintf(logfile, "Read %d bytes from input file. Number of packets: %d , %llu from %llu bytes\n", bytesread, loopcounter, transfered, filesize);

        bresult = WriteFile(localfilehandle, (LPVOID)block, bytesread, &byteswritten, NULL);
        if (byteswritten < bytesread)
        {
            if (bresult == FALSE)
            {
                errstring = L"Error writing to local file.";
                Err = E_LOCAL_FILE_RDWR;
                transferstatus = ES_FAILED;
                CloseRemoteFile();
                CloseLocalFile();
                delete block;
                return E_LOCAL_FILE_RDWR;
            }
            else if (bytesread == 0)
            {
                errstring = L"Transfer done.";
                Err = E_OK;
                transferstatus = ES_DONE;
                continue;
            }
        }

        Err = E_OK;

        if (pause == true) transferstatus = ES_PAUSED;
        if (bresult == TRUE &&  bytesread == 0)
        {
            // at the end of the file
            transferstatus = ES_DONE;
        }
        Sleep(blocktransferdelay);
        if (loopcounter % 71 == 0)Sleep(7 * blocktransferdelay);
        if (loopcounter % 331 == 0)Sleep(77 * blocktransferdelay);
        if (loopcounter % 3331 == 0)Sleep(777 * blocktransferdelay);

    }
    result = closeSFTPfile();
    CloseHandle(localfilehandle);
    Sleep(1000);

    if (transferstatus == ES_DONE)
    {
        wchar_t temp2[SHORT_BUFF_LEN];
        mbstowcs_s(&tempsize, temp2, lfn, SHORT_BUFF_LEN);
        bresult = MoveFile(temp, temp2);
        if (bresult != TRUE)
        {
            Err = E_RENAME_LOCAL_FILE;
            errstring = L"Could not rename local file: " + wstring(temp);
            transferstatus = ES_FAILED;
            delete block;
            return E_RENAME_LOCAL_FILE;
        }
    }

    if (transferstatus == ES_CANCELLED)
    {
        wchar_t temp2[SHORT_BUFF_LEN];
        mbstowcs_s(&tempsize, temp2, lfn, SHORT_BUFF_LEN);
        bresult = DeleteFile(temp);
        if (bresult != TRUE)
        {
            Err = E_LOCAL_DELETE_FILE;
            errstring = L"Could not rename local file: " + wstring(temp);
            transferstatus = ES_FAILED;
            delete block;
            return E_LOCAL_DELETE_FILE;
        }
    }

    delete block;
    return result;
}

//---------------------------------------

TTransStat * CSFTPConnector::getStatus()
{
    stats.seconds_elapsed = time(NULL); 
    stats.seconds_elapsed -= transferstarttime;
    stats.averagebps = ((transfered- initially_was_transferred) * 8) / stats.seconds_elapsed;
    if (filesize > 0) {
        stats.percent = (transfered *100)/ filesize;
        stats.seconds_remained = ((filesize - transfered) * 8) / stats.averagebps;
    }
    else
    {
        stats.percent = -1;
        stats.seconds_remained = -1;
    }
    stats.total_size = filesize;
    stats.transferstate = transferstatus;
    stats.remote_file_name = filename;
    stats.local_file_name = localfilename;
    stats.transferred = transfered;
    stats.initially_transferred = initially_was_transferred;

    return &stats;
}

ESSHERR CSFTPConnector::SFTPrename(char *newname, char *oldname)
{

    int rc=sftp_rename(sftp, oldname, newname);
    if (rc !=SSH_OK){
        return E_RENAME_ERR;
    }

    return E_OK;
}

ESSHERR CSFTPConnector::SFTPdelete(char *remfile)
{

    int rc = sftp_unlink(sftp,remfile);
    if (rc != SSH_OK){
        return E_DELETE_ERR;
    }

    return E_OK;
}

// SFTPreput
ESSHERR CSFTPConnector::SFTPreput(char *lfn, char *rfn, size_t blocksize)
{
    ESSHERR     result;
    BOOL  bresult;
    DWORD bytesread;
    filesize = 0;
    transfered = 0;

    pause = false;
    transferstatus = ES_NONE;
    char *block;
    struct stat st;
    wchar_t temp[SHORT_BUFF_LEN];
    size_t tempsize;
    wstring wlfn;
    int loopcounter = 0;

    localfilename = lfn;
    //wlfn = wstring(lfn);
    //localfile = fopen(lfn, L"r");
    filename = rfn;
    mbstowcs_s(&tempsize, temp, lfn, SHORT_BUFF_LEN);

    //filesize = getFileSize(localfilename);

    /*if(filesize < 0) {
    transferstatus = ES_FAILED;
    Err = E_LOCAL_FILE_NOTFOUND;
    return E_LOCAL_FILE_NOTFOUND;
    }*/

    localfilehandle = CreateFile(temp, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
    if (localfilehandle == INVALID_HANDLE_VALUE)
    {
        transferstatus = ES_FAILED;
        Err = E_LOCAL_FILE_NOTFOUND;
        return E_LOCAL_FILE_NOTFOUND;
    }
    local_file_size_lowDWORD = GetFileSize(localfilehandle, &local_file_size_hiDWORD);
    filesize = (local_file_size_hiDWORD * 0x100000000) + local_file_size_lowDWORD;

    if (filesize < 0) {
        transferstatus = ES_FAILED;
        Err = E_LOCAL_FILE_NOTFOUND;
        CloseLocalFile();
        return E_LOCAL_FILE_NOTFOUND;
    }

    block = (char*)malloc(blocksize + 1);
    if (block == NULL) {
        Err = E_MEM_ALLOC;
        transferstatus = ES_FAILED;
        errstring = L"Could not allocate memory for file block size";
        CloseLocalFile();
        return E_MEM_ALLOC;
    }

    tempfilename = string(rfn) + ".sftp_temp";

    result = rwopen_existing_SFTPfile((char *)tempfilename.c_str());
    if (result == E_OK){
        getSFTPfileinfo();
        sftp_seek64(file, rfilesize);
        __int64 tempi64 = rfilesize & 0x00000000FFFFFFFF;
        DWORD dwlow = tempi64;
        tempi64 = (rfilesize & 0x7FFFFFFF00000000);
        tempi64 = tempi64 >> 32;
        long  dwhi = tempi64;
        DWORD dwResult=SetFilePointer(localfilehandle, dwlow,&dwhi , FILE_BEGIN);
        if (dwResult == INVALID_SET_FILE_POINTER)
        {
            transferstatus = ES_FAILED; Err = result;  return result;
        }
        transferstatus = ES_RESUMING;
        transfered = rfilesize;
        initially_was_transferred = rfilesize;

    }
    else{
        result = createSFTPfile((char *)tempfilename.c_str());
        transferstatus = ES_STARTING;
        rfilesize = 0;
        initially_was_transferred = 0;
        if (result != E_OK)  {
            transferstatus = ES_FAILED; 
            Err = result;
            CloseLocalFile();
            return result;
        }
        }
        sftp_file_set_blocking(file);
        transferstarttime = time(NULL);
        transferstatus = ES_INPROGRESS;

    while (transferstatus != ES_FAILED && transferstatus != ES_PAUSED && transferstatus != ES_DONE)
    {
        loopcounter++;
        bresult = ReadFile(localfilehandle, (LPVOID)block, blocksize, &bytesread, NULL);
        fprintf(logfile, "Read %d bytes from input file. Number of packets: %d , %llu from %llu bytes\n", bytesread, loopcounter, transfered, filesize);
        if (bytesread < blocksize)
        {
            if (bresult == FALSE)
            {
                errstring = L"Error reading from local file.";
                Err = E_LOCAL_FILE_READ;
                transferstatus = ES_FAILED;
                CloseRemoteFile();
                CloseLocalFile();
                return E_LOCAL_FILE_READ;
            }
            else if (bytesread == 0)
            {
                errstring = L"Transfer done.";
                Err = E_OK;
                transferstatus = ES_DONE;
                continue;
            }
        }

        result = writeSFTPfile(block, bytesread);
        if (result != E_OK && bytesread>0 )
        {
            errstring = L"Error transmitting to remote sftp server file.";
            Err = result;
            transferstatus = ES_FAILED;
            CloseRemoteFile();
            CloseLocalFile();
            return result;
        }

        Err = E_OK;
        //transfered = transfered + bytesread;
        if (pause == true) transferstatus = ES_PAUSED;
        if (bresult == TRUE &&  bytesread == 0)
        {
            // at the end of the file
            transferstatus = ES_DONE;
        }
        Sleep(blocktransferdelay);
        if (loopcounter % 71 == 0)Sleep(7 * blocktransferdelay);
        if (loopcounter % 331 == 0)Sleep(77 * blocktransferdelay);
        if (loopcounter % 3331 == 0)Sleep(777 * blocktransferdelay);

    }

    CloseRemoteFile();
    CloseLocalFile();
    Sleep(1000);

    if (transferstatus == ES_CANCELLED)
    {
        result = SFTPdelete((char *)tempfilename.c_str());
        if (bresult != E_OK)
        {
            Err = E_DELETE_ERR;
            errstring = L"Could not delete remote file.";
            transferstatus = ES_FAILED;
            return E_DELETE_ERR;
        }
    }
    if (transferstatus == ES_DONE) result = SFTPrename(rfn, (char *)tempfilename.c_str());
    delete block;
    return result;
}

ESSHERR CSFTPConnector::getSFTPfileinfo()
{
    sftp_attributes fileinf = sftp_fstat(file);

    if (fileinf == NULL){
        return E_GET_FILEINF;
    }

    rfilesize = fileinf->size;

    sftp_attributes_free(fileinf);
    return E_OK;
}

ESSHERR CSFTPConnector::closeSFTPfile()
{
    int rc = sftp_close(file);
    if (rc != SSH_OK)
    {
        fprintf(logfile, "Can't close the written file: %s\n",
            ssh_get_error(session));
        return E_FILE_CLOSE;
    }
    return E_OK;
}

ESSHERR CSFTPConnector::writeSFTPfile(char *block, size_t blocksize)
{
    size_t nwritten = sftp_write(file, block, blocksize);
    if (nwritten != blocksize)
    {
        fprintf(logfile, "Can't write data to file: %s\n",
            ssh_get_error(session));
        //sftp_close(file);
        transfered = transfered + nwritten;
        return E_WRITE_ERR;
    }

    transfered = transfered + nwritten;
    return E_OK;
}
ESSHERR CSFTPConnector::readSFTPfile(char *block, __int64 len, DWORD *bytesread)
{
    DWORD readbytes;
    *bytesread = 0;
    if (len <= 0) return E_INVALID_PARAMS;
    if (bytesread == NULL || block == NULL) return E_INVALID_PARAMS;

    readbytes = sftp_read(file, block, len);
    if (readbytes < 0)
    {
        fprintf(logfile, "Can't read  from  remote file: %s  %s\n", filename.c_str(), ssh_get_error(session));
        *bytesread = 0;
        return E_SFTP_READ_ERR;
    }

    if (readbytes <  len)
    {
        *bytesread = readbytes;
        return E_SFTP_READ_EOF;
    }

    *bytesread = readbytes;
    transfered = transfered + readbytes;

    return E_OK;

}

ESSHERR CSFTPConnector::createSFTPfile(char *fn)
{

    int access_type = O_CREAT | O_RDWR | O_APPEND;
    int rc, nwritten;

    filename = string(fn);
    file = sftp_open(sftp, fn,access_type,  S_IREAD | S_IWRITE);
    if (file == NULL)
    {
        fprintf(logfile, "Can't open file for writing: %s\n",
            ssh_get_error(session));
        return E_FILEOPEN_WRITE;
    }
    return E_OK;
}

ESSHERR CSFTPConnector::openSFTPfile(char *fn)
{
    int access_type = O_RDONLY;
    int rc, nwritten;

    filename = string(fn);
    file = sftp_open(sftp, fn,
        access_type, S_IWRITE);
    if (file == NULL)
    {
        fprintf(logfile, "Can't open file for writing: %s\n",
            ssh_get_error(session));
        return E_FILE_OPEN_READ;
    }
    return E_OK;

}

ESSHERR CSFTPConnector::Makedir(char *newdir)
{
    int rc;
    rc = sftp_mkdir(sftp, newdir, S_IFDIR);
    if (rc != SSH_OK)
    {
        if (sftp_get_error(sftp) != SSH_FX_FILE_ALREADY_EXISTS)
        {
            fprintf(logfile, "Can't create directory: %s\n",
                ssh_get_error(session));
            return E_CREATE_DIR;
        }
    }

        return E_OK;
}

SFTPConnector::CSFTPConnector()
{
    //libssh2_init(0);
    session = ssh_new();
    if (session == NULL)
    {
        Err = E_SESSION_ALOC;
        errstring = L"Could not allocate a session.";

    }
    wcscpy(hostname, L"localhost" );
    wcscpy(username, L"User");
    wcscpy(password, L"Password");
    wcscpy(basedir, L".\\");
    port = 22;
    verbosity = SSH_LOG_RARE;
    filesize = 0;
    transfered = 0;

    pause = false;
    transferstatus = ES_NONE;
    logfile = stderr;
    blocktransferdelay = INITIALBLOCKTRANSDELAY;

}

CSFTPConnector::CSFTPConnector(wchar_t *dir, wchar_t *hn, int hostport, wchar_t *un, wchar_t *pass)
{

    //libssh2_init(0);
    session = ssh_new();

    if (session == NULL)
    {
        Err = E_SESSION_ALOC;
        errstring = L"Could not allocate a session.";

    }
    wcscpy(hostname, hn);
    wcscpy(username, un);
    wcscpy(password, pass);
    wcscpy(basedir, dir);
    port = hostport;
    verbosity = SSH_LOG_RARE;
     filesize=0;
     transfered=0;

     pause=false;
     transferstatus = ES_NONE;
     logfile = stderr;
     blocktransferdelay = INITIALBLOCKTRANSDELAY;

}

ESSHERR  CSFTPConnector::InitSFTP()
{
    int rc;
    sftp= sftp_new(session);
    if (session == NULL)
    {
        Err = E_SFTP_ALLOC;
        errstring = L"Could not allocate a sftp session.";

    }

    rc = sftp_init(sftp);
    if (rc != SSH_OK)
    {
        fprintf(logfile, "Error initializing SFTP session: %s.\n",
            sftp_get_error(sftp));
        sftp_free(sftp);
        return E_INIT_SFTP;
    }

    return E_OK;
}

ESSHERR  CSFTPConnector::ConnectSession()
{
    char temp[SHORT_BUFF_LEN];
    size_t n_of_chars;
    wcstombs_s(&n_of_chars, temp, SHORT_BUFF_LEN, (const wchar_t *)password, SHORT_BUFF_LEN);
    int ir;

    ir=ssh_connect(session);
    if (ir != SSH_OK){
        errstring = L"Could not connect the ssh session.";
        return E_SSH_CONNECT_ERR;
    }

    ir=ssh_userauth_password(session, NULL, temp);
    if (ir != SSH_OK){
        errstring = L"Could not authenticate with the ssh server.\r\n";
        return E_AUTHENTICATE;
    }
    return E_OK;
}

ESSHERR  CSFTPConnector::InitSession()
{
    char temp[SHORT_BUFF_LEN];
    size_t n_of_chars;
    wcstombs_s(&n_of_chars, temp,SHORT_BUFF_LEN, (const wchar_t *) hostname, SHORT_BUFF_LEN);
    ssh_options_set(session, SSH_OPTIONS_HOST,temp);
    ssh_options_set(session, SSH_OPTIONS_LOG_VERBOSITY, &verbosity);
    ssh_options_set(session, SSH_OPTIONS_PORT, &port);
    wcstombs_s(&n_of_chars, temp, SHORT_BUFF_LEN, (const wchar_t *)username, SHORT_BUFF_LEN);
    ssh_options_set(session, SSH_OPTIONS_USER,temp);
    wcstombs_s(&n_of_chars, temp, SHORT_BUFF_LEN, (const wchar_t *)basedir, SHORT_BUFF_LEN);
    ssh_options_set(session, SSH_OPTIONS_SSH_DIR, temp);

    return E_OK;
}

void  CSFTPConnector::setVerbosity(int v)
{
    verbosity = v;
}

int  CSFTPConnector::getVerbosity()
{
    return verbosity;
} 
```

# java - 比较两个对象是否相等的替代方法是什么？

> ID：360265
> 
> 赞同：3
> 
> 时间：2008-12-11T17:53:05.857
> 
> 标签：java, equals

[http://leepoint.net/notes-java/data/expressions/22compareobjects.html](http://leepoint.net/notes-java/data/expressions/22compareobjects.html)

> 事实证明，定义 equals() 并非易事。事实上，要做到这一点相当困难，尤其是在子类的情况下。Horstmann 的 Core Java Vol 1 对这些问题的最佳处理。

如果 equals() 必须始终被覆盖，那么什么是避免被迫进行对象比较的好方法？有哪些好的“设计”替代品？

编辑：

我不确定这是否符合我的预期。也许这个问题应该更像是“你为什么要比较两个对象？” 根据您对该问题的回答，是否有替代解决方案来进行比较？我不是说，equals 的不同实现。我的意思是，根本不使用平等。我认为关键是从这个问题开始，为什么要比较两个对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T18:12:39.607

我不认为 equals 应该总是被覆盖。据我了解，规则是覆盖 equals 仅在您清楚如何定义语义等效对象的情况下才有意义。在这种情况下，您也可以覆盖 hashCode() ，这样您就没有定义为等效返回不同哈希码的对象。

如果你不能定义有意义的等价，我看不到好处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T19:28:20.140

> 如果 equals() 必须始终被覆盖，那么什么是避免被迫进行对象比较的好方法？

你误会了。您应该尽可能少地覆盖 equals。

* * *

所有这些信息都来自[Effective Java, Second Edition](http://java.sun.com/docs/books/effective/) ( [Josh Bloch](http://en.wikipedia.org/wiki/Joshua_Bloch) )。这方面的第一版章节仍然可以免费[下载](http://developer.java.sun.com/developer/Books/effectivejava/Chapter3.pdf)。

*从有效的Java：*

> 避免问题的最简单方法是不要重写 equals 方法，在这种情况下，类的每个实例都只与自身相等。

任意覆盖 equals/hashCode 的问题是继承。一些 equals 实现提倡像这样测试它：

```
if (this.getClass() != other.getClass()) {
    return false; //inequal
} 
```

事实上，当您使用源工具生成方法时， [Eclipse](http://www.eclipse.org/) (3.4) Java 编辑器就是这样做的。根据布洛赫的说法，这是一个错误，因为它违反了里氏[替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。

*从有效的Java：*

> 没有办法在保留 equals 契约的同时扩展一个可实例化的类并添加一个值组件。

*类和接口*一章描述了两种最小化相等问题的方法：

16.  优先组合而不是继承
17.  设计和文件继承或禁止它

* * *

据我所知，唯一的选择是以类外部的形式测试相等性，以及如何执行将取决于类型的设计和您尝试使用它的上下文。

例如，您可以定义一个接口来记录如何进行比较。在下面的代码中，Service 实例可能在运行时被同一类的较新版本替换——在这种情况下，具有不同的 ClassLoader，equals 比较将始终返回 false，因此覆盖 equals/hashCode 将是多余的。

```
public class Services {

    private static Map<String, Service> SERVICES = new HashMap<String, Service>();

    static interface Service {
        /** Services with the same name are considered equivalent */
        public String getName();
    }

    public static synchronized void installService(Service service) {
        SERVICES.put(service.getName(), service);
    }

    public static synchronized Service lookup(String name) {
        return SERVICES.get(name);
    }
} 
```

* * *

> “你为什么要比较两个物体？”

一个明显的例子是测试两个 Strings 是否相同（或两个[Files](http://java.sun.com/javase/6/docs/api/java/io/File.html)或[URIs](http://java.sun.com/javase/6/docs/api/java/net/URI.html)）。例如，如果您想构建一组文件来解析怎么办。根据定义，该集合仅包含唯一元素。Java 的[Set](http://java.sun.com/javase/6/docs/api/java/util/Set.html)类型依赖 equals/hashCode 方法来强制其元素的唯一性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T18:06:27.060

做对了怎么样？

这是我的 equals 模板，它是 Josh Bloch 从 Effective Java 中应用的知识。阅读本书了解更多详情：

```
@Override
public boolean equals(Object obj) {
    if(this == obj) {
        return true;
    }

    // only do this if you are a subclass and care about equals of parent
    if(!super.equals(obj)) {
        return false;
    }
    if(obj == null || getClass() != obj.getClass()) {
        return false;
    }
    final YourTypeHere other = (YourTypeHere) obj;
    if(!instanceMember1.equals(other.instanceMember1)) {
       return false;
     }
     ... rest of instanceMembers in same pattern as above....
     return true;
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T18:04:21.293

嗯嗯

在某些情况下，您可以使对象不可修改（只读）并从单点创建它（工厂方法）

如果需要两个具有相同输入数据（创建参数）的对象，工厂将返回相同的实例引用，然后使用“==”就足够了。

这种方法仅在某些情况下有用。而且大多数时候看起来有点矫枉过正。

看看[这个答案](https://stackoverflow.com/questions/334518/java-strings-string-s-new-stringsilly#336291)，了解如何实现这样的事情。

*警告这是很多代码*

简而言之，看看包装类是如何[从 java 1.5 开始工作的](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html#valueOf(int))

```
Integer a = Integer.valueOf( 2 );
Integer b = Integer.valueOf( 2 );

a == b 
```

是真的，而

```
new Integer( 2 ) == new Integer( 2 ) 
```

是假的。

如果输入值相同，它会在内部保留引用并返回它。

如您所知，整数是只读的

与该问题有关的 String 类也发生了类似的情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T19:19:20.580

也许我错过了这一点，但使用 equals 而不是**用不同的名称**定义自己的方法的唯一原因是因为许多集合（可能还有 JDK 中的其他东西或现在所谓的任何东西）都期望使用 equals 方法定义一个连贯的结果。但除此之外，我可以想到您想要在 equals 中进行的三种比较：

1.  这两个对象实际上是同一个实例。使用 equals 是没有意义的，因为你可以使用 ==。另外，如果我忘记了它在 Java 中是如何工作的，请纠正我，默认的 equals 方法使用自动生成的哈希码来执行此操作。
2.  这两个对象具有对相同实例的引用，但不是同一个实例。这很有用，呃，有时......特别是如果它们是持久对象并引用数据库中的同一个对象。你必须定义你的 equals 方法来做到这一点。
3.  这两个对象具有对值相等的对象的引用，尽管它们可能是也可能不是相同的实例（换句话说，您在整个层次结构中一直比较值）。

为什么要比较两个对象？好吧，如果他们是平等的，你会想做一件事，如果他们不是，你会想做别的事。

也就是说，这取决于手头的情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T22:13:37.063

在大多数情况下覆盖 equals() 的主要原因是检查某些集合中的重复项。例如，如果您想使用 Set 来包含您创建的对象，则需要在您的对象中覆盖 equals() 和 hashCode()。如果您想将自定义对象用作 Map 中的键，这同样适用。

这一点很重要，因为我看到很多人在实践中犯了一个错误，即在没有覆盖 equals() 和 hashCode() 的情况下将自定义对象添加到 Sets 或 Maps。这可能特别阴险的原因是编译器不会抱怨，您最终可能会得到多个对象，这些对象包含相同的数据，但在不允许重复的 Collection 中具有不同的引用。

例如，如果您有一个名为 NameBean 的简单 bean，它有一个字符串属性“name”，您可以构造两个 NameBean 实例（例如 name1 和 name2），每个实例都具有相同的“name”属性值（例如“Alice”）。然后，您可以将 name1 和 name2 添加到 Set 中，并且该集合的大小为 2，而不是预期的大小 1。同样，如果您有一个 Map （例如 Map）以便将名称 bean 映射到其他对象，并且您首先将 name1 映射到字符串“first”，然后将 name2 映射到字符串“second”，那么您将拥有两个键/值对在地图中（例如 name1->"first", name2->"second"）。因此，当您进行地图查找时，它将返回映射到您传入的确切引用的值，即 name1、name2 或另一个名为“的引用”

这是一个具体示例，前面是运行它的输出：

输出：

```
Adding duplicates to a map (bad):
Result of map.get(bean1):first
Result of map.get(bean2):second
Result of map.get(new NameBean("Alice"): null

Adding duplicates to a map (good):
Result of map.get(bean1):second
Result of map.get(bean2):second
Result of map.get(new ImprovedNameBean("Alice"): second 
```

代码：

```
// This bean cannot safely be used as a key in a Map
public class NameBean {
    private String name;
    public NameBean() {
    }
    public NameBean(String name) {
        this.name = name;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    @Override
    public String toString() {
        return name;
    }
}

// This bean can safely be used as a key in a Map
public class ImprovedNameBean extends NameBean {
    public ImprovedNameBean(String name) {
        super(name);
    }
    @Override
    public boolean equals(Object obj) {
        if (this == obj) {
            return true;
        }
        if(obj == null || getClass() != obj.getClass()) {
            return false;
        }
        return this.getName().equals(((ImprovedNameBean)obj).getName());
    }
    @Override
    public int hashCode() {
        return getName().hashCode();
    }
}

public class MapDuplicateTest {
    public static void main(String[] args) {
        MapDuplicateTest test = new MapDuplicateTest();
        System.out.println("Adding duplicates to a map (bad):");
        test.withDuplicates();
        System.out.println("\nAdding duplicates to a map (good):");
        test.withoutDuplicates();
    }
    public void withDuplicates() {
        NameBean bean1 = new NameBean("Alice");
        NameBean bean2 = new NameBean("Alice");

        java.util.Map<NameBean, String> map
                = new java.util.HashMap<NameBean, String>();
        map.put(bean1, "first");
        map.put(bean2, "second");
        System.out.println("Result of map.get(bean1):"+map.get(bean1));
        System.out.println("Result of map.get(bean2):"+map.get(bean2));
        System.out.println("Result of map.get(new NameBean(\"Alice\"): "
                + map.get(new NameBean("Alice")));
    }
    public void withoutDuplicates() {
        ImprovedNameBean bean1 = new ImprovedNameBean("Alice");
        ImprovedNameBean bean2 = new ImprovedNameBean("Alice");

        java.util.Map<ImprovedNameBean, String> map
                = new java.util.HashMap<ImprovedNameBean, String>();
        map.put(bean1, "first");
        map.put(bean2, "second");
        System.out.println("Result of map.get(bean1):"+map.get(bean1));
        System.out.println("Result of map.get(bean2):"+map.get(bean2));
        System.out.println("Result of map.get(new ImprovedNameBean(\"Alice\"): "
                + map.get(new ImprovedNameBean("Alice")));
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T08:04:06.737

平等是逻辑的基础（参见恒等律），没有它就没有多少编程可以做。至于比较您编写的类的实例，这取决于您。如果您需要能够在集合中找到它们或将它们用作 Maps 中的键，则需要进行相等性检查。

如果您已经用 Java 编写了多个重要的库，您就会知道很难做到等式，尤其是当胸部唯一的工具是`equals`和`hashCode`. 平等最终与类层次结构紧密耦合，这使得代码变得脆弱。更重要的是，没有提供类型检查，因为这些方法只接受 Object 类型的参数。

有一种方法可以使相等检查（和散列）更不容易出错并且更安全。在[Functional Java](http://functionaljava.org/)库中，您会发现[`Equal<A>`](http://functionaljava.googlecode.com/svn/artifacts/2.16/javadoc/fj/pre/Equal.html)（和相应的[`Hash<A>`](http://functionaljava.googlecode.com/svn/artifacts/2.16/javadoc/fj/pre/Hash.html)）等式被解耦为单个类。它具有`Equal`从现有实例为您的类组合实例的方法，以及使用and代替and的 Collections、 [Iterables](http://functionaljava.googlecode.com/svn/artifacts/2.16/javadoc/fj/data/IterableW.html)、[HashMap](http://functionaljava.googlecode.com/svn/artifacts/2.16/javadoc/fj/data/HashMap.html)和[HashSet](http://functionaljava.googlecode.com/svn/artifacts/2.16/javadoc/fj/data/HashSet.html)的包装器。`Equal<A>``Hash<A>``equals``hashCode`

这种方法的最佳之处在于，您永远不会忘记在调用 equals 和 hash 方法时编写它们。类型系统将帮助您记住。

# sql-server - SQL Server 2005 变更审核

> ID：360273
> 
> 赞同：1
> 
> 时间：2008-12-11T17:56:37.953
> 
> 标签：sql-server, sql-server-2005, audit, auditing, ddl-trigger

SQL Server 2005 中是否有内置的方式来审计特别是删除存储过程之类的事情？有我可以查询的历史记录表吗？我们有一个神秘的sproc，现在已经消失了几次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T17:59:50.943

您可以使用 DDL 触发器构建它：

[http://msdn.microsoft.com/en-us/library/ms190989.aspx](http://msdn.microsoft.com/en-us/library/ms190989.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T18:00:16.403

仅当您使用[DDL 触发器](http://msdn.microsoft.com/en-us/library/ms190989.aspx)或使用探查器跟踪文本“%DROP%PROC%procname%”时

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:27:45.080

请注意，在 SQL Server 2008 中，他们现在还具有 AUDIT 来替换 Profiler Traces 以进行审计活动。类似但有自己的配置UI和查看结果的UI

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T16:26:40.153

您可以设置探查器跟踪以捕获审核架构对象管理事件并根据您关心的数据库名称进行过滤。每当创建、删除、编辑模式中的对象时，它都会在分析器中触发一个事件，其中包括进行更改的人员和存储过程的名称。

您至少需要以下分析器列： ApplicationName - 应用程序用户在进行更改时正在运行的名称 DatabaseName - 包含更改的对象的数据库 EventSubClass - 操作类型显示 Alter、Modify、Drop、Create 等 LoginName - 用户进行更改 ObjectName - 对象做作的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-23T20:56:09.840

[较晚的一个，但添加了有关如何在审计系统实施之前查看谁进行了更改的详细信息]

其他人已经介绍了您可以开始审计数据以监控未来变化的不同方式，但是如果您最初没有任何审计系统，那么很难找出历史上谁做了什么以及什么时候做了什么。

唯一的选择是尝试读取事务日志，假设数据库处于完全恢复模式。问题是默认情况下不支持此功能。选项是：

*   第三方工具，例如[ApexSQL Log](http://www.apexsql.com/sql_tools_log.aspx)或[Quest Toad](http://www.quest.com/)
*   未记录的函数，例如 DBCC LOG 或 fn_dblog

有关更多详细信息，请参阅这些主题：

[如何在 SQL Server 2008 中查看事务日志](https://stackoverflow.com/questions/4507509/how-to-view-transaction-logs-in-sql-server-2008)

[SQL Server 事务日志浏览器/分析器](https://stackoverflow.com/questions/3789443/sql-server-transaction-log-explorer-analyzer)

[如何在 SQL Server Management Studio 中查看查询历史记录](https://stackoverflow.com/questions/5299669/how-to-see-query-history-in-sql-server-management-studio)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-29T03:36:57.277

我同意。它可以是带有过滤器的 SQL Server 分析器。DDL 触发器存在于 SQL Server 中。你可以创建这样的东西：

```
 CREATE TRIGGER ddl_drop_procedure 
    ON DATABASE 
    FOR DROP_PROCEDURE
   AS 
     RAISERROR ('You deleted a stored procedure',10, 1)

   GO 
```

另一种选择是使用第三方工具，例如来自 codeplex 的 Auto Audit 或 apexSQL 触发器。

# c# - 将整个对象转储到 C# 中的日志的最佳方法是什么？

> ID：360277
> 
> 赞同：158
> 
> 时间：2008-12-11T17:58:32.473
> 
> 标签：c#, visual-studio, debugging, object, logging

因此，对于在运行时查看当前对象的状态，我真的很喜欢 Visual Studio 即时窗口给我的东西。只是做一个简单的

```
? objectname 
```

会给我一个格式很好的对象“转储”。

**有没有一种简单的方法可以在代码中做到这一点，所以我可以在记录时做类似的事情？**

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2014-10-03T15:14:47.027

对于更大的对象图，我第二次使用 Json，但策略略有不同。首先，我有一个易于调用的静态类和一个包装 Json 转换的静态方法（注意：可以使它成为扩展方法）。

```
using Newtonsoft.Json;

public static class F
{
    public static string Dump(object obj)
    {
        return JsonConvert.SerializeObject(obj);
    }
} 
```

然后在你的`Immediate Window`,

```
var lookHere = F.Dump(myobj); 
```

lookHere 将自动显示在`Locals`带有 $ 前缀的窗口中，或者您可以向其中添加手表。在检查器的列的右侧`Value`，有一个放大镜，旁边有一个下拉插入符号。选择下拉插入符号并选择 Json 可视化工具。

![Visual Studio 2013 Locals 窗口的屏幕截图](https://i.stack.imgur.com/mmRwQ.png)

我正在使用 Visual Studio 2013。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-12-11T18:07:45.403

[您可以基于Linq 示例](http://code.msdn.microsoft.com/csharpsamples/Release/ProjectReleases.aspx?ReleaseId=8)附带的 ObjectDumper 代码。
还请查看此[相关问题](https://stackoverflow.com/questions/852181/c-printing-all-properties-of-an-object)的答案以获取示例。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-06-23T10:01:40.950

您可以使用 Visual Studio 即时窗口

只需粘贴这个（`actual`显然更改为您的对象名称）：

```
Newtonsoft.Json.JsonConvert.SerializeObject(actual); 
```

它应该以 JSON 格式打印对象 ![在此处输入图像描述](https://i.stack.imgur.com/SpFp6.png)

您应该能够将其复制[到 textmechanic 文本工具](http://textmechanic.com/Find-and-Replace-Text.html)或[notepad++](https://notepad-plus-plus.org/downloads/)上，并将转义引号 ( `\"`)替换为空格，`"`换行符 ( `\r\n`) 替换为空格，然后`"`从开头和结尾删除双引号 ( ) 并将其粘贴到[jsbeautifier](http://jsbeautifier.org/)以使其更具可读性。

**更新 OP 的评论**

```
public static class Dumper
{
    public static void Dump(this object obj)
    {
        Console.WriteLine(Newtonsoft.Json.JsonConvert.SerializeObject(obj)); // your logger
    }
} 
```

这应该允许您转储任何对象。

希望这可以节省您一些时间。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2008-12-11T18:08:54.140

我确信有更好的方法可以做到这一点，但我过去曾使用类似以下的方法将对象序列化为我可以记录的字符串：

```
 private string ObjectToXml(object output)
  {
     string objectAsXmlString;

     System.Xml.Serialization.XmlSerializer xs = new System.Xml.Serialization.XmlSerializer(output.GetType());
     using (System.IO.StringWriter sw = new System.IO.StringWriter())
     {
        try
        {
           xs.Serialize(sw, output);
           objectAsXmlString = sw.ToString();
        }
        catch (Exception ex)
        {
           objectAsXmlString = ex.ToString();
        }
     }

     return objectAsXmlString;
  } 
```

您会看到该方法也可能返回异常而不是序列化对象，因此您需要确保要记录的对象是可序列化的。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2010-08-18T16:04:34.090

[ServiceStack.Text](https://github.com/ServiceStack/ServiceStack.Text)有一个[T.Dump() 扩展方法](https://docs.servicestack.net/dump-utils)可以做到这一点，递归地以一种可读的格式递归地转储任何类型的所有属性。

示例用法：

```
var model = new TestModel();
Console.WriteLine(model.Dump()); 
```

和输出：

```
{
    Int: 1,
    String: One,
    DateTime: 2010-04-11,
    Guid: c050437f6fcd46be9b2d0806a0860b3e,
    EmptyIntList: [],
    IntList:
    [
        1,
        2,
        3
    ],
    StringList:
    [
        one,
        two,
        three
    ],
    StringIntMap:
    {
        a: 1,
        b: 2,
        c: 3
    }
} 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2014-06-10T21:08:11.407

这是编写平面对象的一种非常简单的方法，格式很好：

```
using Newtonsoft.Json.Linq;

Debug.WriteLine("The object is " + JObject.FromObject(theObjectToDump).ToString()); 
```

发生的事情是对象首先通过 转换为 JSON 内部表示`JObject.FromObject`，然后通过 转换为 JSON 字符串`ToString`。（当然，JSON 字符串是简单对象的一种非常好的表示形式，尤其是因为`ToString`将包含换行符和缩进。）“ToString”当然是无关紧要的（因为它暗示了`+`用于连接字符串和对象），但是我有点想在这里指定它。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-11T18:05:35.363

您可以使用反射并循环遍历所有对象属性，然后获取它们的值并将它们保存到日志中。格式非常简单（您可以使用 \t 缩进对象属性及其值）：

```
MyObject
    Property1 = value
    Property2 = value2
    OtherObject
       OtherProperty = value ... 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-11T19:05:22.980

我喜欢做的是覆盖 ToString() 以便我获得超出类型名称的更有用的输出。这在调试器中很方便，您可以查看您想要的有关对象的信息，而无需扩展它。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-02-16T03:02:14.333

以下是另一个执行相同操作（并处理嵌套属性）的版本，我认为它更简单（不依赖于外部库，并且可以轻松修改以执行日志记录以外的操作）：

```
public class ObjectDumper
{
    public static string Dump(object obj)
    {
        return new ObjectDumper().DumpObject(obj);
    }

    StringBuilder _dumpBuilder = new StringBuilder();

    string DumpObject(object obj)
    {
        DumpObject(obj, 0);
        return _dumpBuilder.ToString();
    }

    void DumpObject(object obj, int nestingLevel = 0)
    {
        var nestingSpaces = "".PadLeft(nestingLevel * 4);

        if (obj == null)
        {
            _dumpBuilder.AppendFormat("{0}null\n", nestingSpaces);
        }
        else if (obj is string || obj.GetType().IsPrimitive)
        {
            _dumpBuilder.AppendFormat("{0}{1}\n", nestingSpaces, obj);
        }
        else if (ImplementsDictionary(obj.GetType()))
        {
            using (var e = ((dynamic)obj).GetEnumerator())
            {
                var enumerator = (IEnumerator)e;
                while (enumerator.MoveNext())
                {
                    dynamic p = enumerator.Current;

                    var key = p.Key;
                    var value = p.Value;
                    _dumpBuilder.AppendFormat("{0}{1} ({2})\n", nestingSpaces, key, value != null ? value.GetType().ToString() : "<null>");
                    DumpObject(value, nestingLevel + 1);
                }
            }
        }
        else if (obj is IEnumerable)
        {
            foreach (dynamic p in obj as IEnumerable)
            {
                DumpObject(p, nestingLevel);
            }
        }
        else
        {
            foreach (PropertyDescriptor descriptor in TypeDescriptor.GetProperties(obj))
            {
                string name = descriptor.Name;
                object value = descriptor.GetValue(obj);

                _dumpBuilder.AppendFormat("{0}{1} ({2})\n", nestingSpaces, name, value != null ? value.GetType().ToString() : "<null>");
                DumpObject(value, nestingLevel + 1);
            }
        }
    }

    bool ImplementsDictionary(Type t)
    {
        return t.GetInterfaces().Any(i => i.Name.Contains("IDictionary"));
    }
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-08-25T12:06:50.697

我找到了一个名为[ObjectPrinter](https://github.com/drewburlingame/ObjectPrinter)的库，它可以轻松地将对象和集合转储到字符串（以及更多）。它完全符合我的需要。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-02-26T17:45:50.027

您可以编写自己的 WriteLine 方法-

```
public static void WriteLine<T>(T obj)
    {
        var t = typeof(T);
        var props = t.GetProperties();
        StringBuilder sb = new StringBuilder();
        foreach (var item in props)
        {
            sb.Append($"{item.Name}:{item.GetValue(obj,null)}; ");
        }
        sb.AppendLine();
        Console.WriteLine(sb.ToString());
    } 
```

像使用它 -

```
WriteLine(myObject); 
```

要编写一个集合，我们可以使用 -

```
 var ifaces = t.GetInterfaces();
        if (ifaces.Any(o => o.Name.StartsWith("ICollection")))
        {

            dynamic lst = t.GetMethod("GetEnumerator").Invoke(obj, null);
            while (lst.MoveNext())
            {
                WriteLine(lst.Current);
            }
        } 
```

该方法可能看起来像 -

```
 public static void WriteLine<T>(T obj)
    {
        var t = typeof(T);
        var ifaces = t.GetInterfaces();
        if (ifaces.Any(o => o.Name.StartsWith("ICollection")))
        {

            dynamic lst = t.GetMethod("GetEnumerator").Invoke(obj, null);
            while (lst.MoveNext())
            {
                WriteLine(lst.Current);
            }
        }            
        else if (t.GetProperties().Any())
        {
            var props = t.GetProperties();
            StringBuilder sb = new StringBuilder();
            foreach (var item in props)
            {
                sb.Append($"{item.Name}:{item.GetValue(obj, null)}; ");
            }
            sb.AppendLine();
            Console.WriteLine(sb.ToString());
        }
    } 
```

以这种方式使用`if, else if`和检查接口、属性、基类型等和递归（因为这是一种递归方法）我们可以实现对象转储器，但它肯定是乏味的。使用 Microsoft 的 LINQ 示例中的对象转储程序可以节省您的时间。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-11-11T22:09:24.897

基于@engineforce 的回答，我制作了我在 Xamarin 解决方案的 PCL 项目中使用的这个类：

```
/// <summary>
/// Based on: https://stackoverflow.com/a/42264037/6155481
/// </summary>
public class ObjectDumper
{
    public static string Dump(object obj)
    {
        return new ObjectDumper().DumpObject(obj);
    }

    StringBuilder _dumpBuilder = new StringBuilder();

    string DumpObject(object obj)
    {
        DumpObject(obj, 0);
        return _dumpBuilder.ToString();
    }

    void DumpObject(object obj, int nestingLevel)
    {
        var nestingSpaces = "".PadLeft(nestingLevel * 4);

        if (obj == null)
        {
            _dumpBuilder.AppendFormat("{0}null\n", nestingSpaces);
        }
        else if (obj is string || obj.GetType().GetTypeInfo().IsPrimitive || obj.GetType().GetTypeInfo().IsEnum)
        {
            _dumpBuilder.AppendFormat("{0}{1}\n", nestingSpaces, obj);
        }
        else if (ImplementsDictionary(obj.GetType()))
        {
            using (var e = ((dynamic)obj).GetEnumerator())
            {
                var enumerator = (IEnumerator)e;
                while (enumerator.MoveNext())
                {
                    dynamic p = enumerator.Current;

                    var key = p.Key;
                    var value = p.Value;
                    _dumpBuilder.AppendFormat("{0}{1} ({2})\n", nestingSpaces, key, value != null ? value.GetType().ToString() : "<null>");
                    DumpObject(value, nestingLevel + 1);
                }
            }
        }
        else if (obj is IEnumerable)
        {
            foreach (dynamic p in obj as IEnumerable)
            {
                DumpObject(p, nestingLevel);
            }
        }
        else
        {
            foreach (PropertyInfo descriptor in obj.GetType().GetRuntimeProperties())
            {
                string name = descriptor.Name;
                object value = descriptor.GetValue(obj);

                _dumpBuilder.AppendFormat("{0}{1} ({2})\n", nestingSpaces, name, value != null ? value.GetType().ToString() : "<null>");

                // TODO: Prevent recursion due to circular reference
                if (name == "Self" && HasBaseType(obj.GetType(), "NSObject"))
                {
                    // In ObjC I need to break the recursion when I find the Self property
                    // otherwise it will be an infinite recursion
                    Console.WriteLine($"Found Self! {obj.GetType()}");
                }
                else
                {
                    DumpObject(value, nestingLevel + 1);
                }
            }
        }
    }

    bool HasBaseType(Type type, string baseTypeName)
    {
        if (type == null) return false;

        string typeName = type.Name;

        if (baseTypeName == typeName) return true;

        return HasBaseType(type.GetTypeInfo().BaseType, baseTypeName);
    }

    bool ImplementsDictionary(Type t)
    {
        return t is IDictionary;
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-06-01T15:24:51.700

到目前为止，对我来说最简单和最整洁的方法是使用 package.json 的序列化器`YamlDotNet`。

```
using YamlDotNet.Serialization;

List<string> strings=new List<string>{"a","b","c"};
new Serializer().Serialize(strings) 
```

会给你

```
- a
- b
- c 
```

一个更全面的例子在这里[https://dotnetfiddle.net/KuV63n](https://dotnetfiddle.net/KuV63n)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-09-27T09:11:35.653

上述所有路径都假定您的对象可序列化为 XML 或 JSON，
或者您必须实现自己的解决方案。

但最终你仍然需要解决诸如

*   对象中的递归
*   不可序列化的对象
*   例外
*   ...

加日志您想了解更多信息：

*   事件发生时
*   调用栈
*   哪三个
*   网络会话中的内容
*   哪个ip地址
*   网址
*   ...

有最好的解决方案可以解决所有这些问题以及更多问题。
**使用这个 Nuget 包：[Desharp](https://www.nuget.org/packages/Desharp/)。**
适用于所有类型的应用程序 - **Web 和桌面应用程序**。
请参阅它的**[Desharp Github 文档](https://github.com/debug-sharp/desharp)**。它有**许多配置选项**。

随便打电话：

```
Desharp.Debug.Log(anyException);
Desharp.Debug.Log(anyCustomValueObject);
Desharp.Debug.Log(anyNonserializableObject);
Desharp.Debug.Log(anyFunc);
Desharp.Debug.Log(anyFunc, Desharp.Level.EMERGENCY); // you can store into different files 
```

*   它可以将日志保存为漂亮的 HTML（或 TEXT 格式，可配置）
*   可以选择在后台线程中编写（可配置）
*   它具有最大对象深度和最大字符串长度的选项（可配置）
*   它对可迭代对象使用循环，对其他所有对象使用反向反射，
    实际上对于**您在 .NET 环境中可以找到的任何东西**。

我相信它会有所帮助。

# java - 在 Eclipse 中使用的最佳 Java 代码生成工具或插件是什么？

> ID：360282
> 
> 赞同：20
> 
> 时间：2008-12-11T17:59:25.080
> 
> 标签：java, eclipse, code-generation

我知道内置代码生成和重构可以使用 Eclipse 中的“源”和“重构”菜单项来完成。

我还使用 Commonclipse 插件来轻松使用构建 hashCode、toString、equals 方法的 Apache Commons 类。

为了在 Eclipse IDE 下轻松生成 Java 源代码，我应该注意哪些其他插件或工具？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-12-05T18:03:42.240

**Telosys** ( [http://www.telosys.org/](http://www.telosys.org/) ) 是一个简单而高效的 Java 代码生成工具。

此代码生成器可作为**Eclipse 插件**( [http://marketplace.eclipse.org/content/telosys-tools](http://marketplace.eclipse.org/content/telosys-tools) ) 和**命令行界面**( [https://github.com/telosys-tools-bricks/telosys- cli/wiki](https://github.com/telosys-tools-bricks/telosys-cli/wiki) )。

定义所有实体的模型可以从头开始（DSL 文本模型）或从现有数据库（DB 模型）创建。

这些模板基于**Velocity** ( [http://velocity.apache.org](http://velocity.apache.org) )，可以从 GitHub 下载。所有模板都是可定制的，如有必要，可以从头开始创建新模板。现有模板可以为 JPA、Spring MVC、数据库文档、REST API 等生成代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-15T08:04:15.300

[Project Lombok](http://projectlombok.org/)使您能够有效地以速记方式进行编码。例如，你可以声明一个类，添加一个 lombok 注解，它会自动生成 getter、setter、equals、hashCode、toString 和构造函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-10-07T13:14:03.393

您可以查看[http://fast-code.sourceforge.net/](http://fast-code.sourceforge.net/)以了解基于弹簧的应用程序。您只需键入 foo 即可创建 FooService 和 FooServiceImpl 以及配置。它也有很好的方法来创建单元测试。可以在这里查看所有模板：http: [//fast-code.sourceforge.net/templates-config.xml](http://fast-code.sourceforge.net/templates-config.xml)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-03T15:34:40.417

[Eclipse Xtend](http://www.eclipse.org/xtend/)是一个非常强大的代码生成器，除其他外，它支持闭包和数据类 - 自动 getter/setters/hashCode/equals。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T21:55:46.380

如果您有兴趣在代码生成方面更进一步并进入模型驱动的软件开发，您应该看看[openArchitectureWare](http://www.openarchitectureware.org)。

如果您完成了[入门](http://www.openarchitectureware.org/pub/documentation/4.3/html/contents/emf_tutorial.html)教程，您应该可以很快上手。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-05-17T15:25:11.390

以下是您可能会感兴趣的三个 java 代码生成器：

*   [picocog](https://github.com/ainslec/picocog)：一个用 Java 编写的小型代码生成库（< 8 KB），可用于任何目的，但非常适合 JSR-269。[dev.to](https://dev.to/ainslec/metaprogramming-with-picocog-44od)和[dzone.com](https://dzone.com/articles/introducing-picocog-a-lightweight-code-generation)上提供了教程。

*   [JmrTeam 生成器](https://github.com/JmrTeam/generator)：Eclipse 可用的 Jet 模型机器人化（IDEA 即将推出），可用于在任何类型的项目（Maven、Gradle、Java、Python、Php 等）、任何类型的框架（springboot/spring）中管理和生成代码/springMVC、React/Vue/Angular、hibernate、mybatis、struts、JPA 等）。

*   [javapoet](https://github.com/square/javapoet)：用于生成 .java 源文件的 Java API。

*   [jhipster](https://www.jhipster.tech/)：一个用于创建 Spring Boot + Angular/React/Vue 项目的开源应用程序平台。生成器源代码可[在此处获得](https://github.com/jhipster/generator-jhipster)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T12:39:20.487

我不认为这真的是你要问的，但是对于模型驱动的开发，我认为[**Borland's Together**](http://www.borland.com/us/products/together/index.html)仍然是目前最好的基于 Eclipse 的工具。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-11T19:05:35.100

这真的取决于你想做什么？J2EE、Web 服务、Swing ...

我做了很多 Web 服务开发并严重依赖：

*   [Web 服务资源管理器](http://www.eclipse.org/webtools/initial-contribution/IBM/evalGuides/WebServicesToolsEval.html)

对于 Axis2 开发：

*   [Eclipse 插件的代码生成器向导指南](http://ws.apache.org/axis2/tools/1_4_1/eclipse/wsdl2java-plugin.html)
*   [Eclipse 插件的 Service Archive Generator 向导指南](http://ws.apache.org/axis2/tools/1_4_1/eclipse/servicearchiver-plugin.html)

有一个关于 Axis2 插件的很好的教程，称为[使用 Apache Axis2 Eclipse 插件开发 Web 服务 - 第 1 部分](http://wso2.org/library/1719)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-09-04T17:08:37.973

我刚刚发布了我的个人 Java 代码生成器：JCG。你可以在

[https://github.com/makkax/JavaCodeGenerator](https://github.com/makkax/JavaCodeGenerator)

它是一个用 Java 编写的生成器，您可以在其中直接编写所有 Java 类型、字段、方法和注解，而无需模板。

使用 JCG，您可以轻松地生成任意数量的具有复杂相互依赖性的 Java 类型。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-11T22:06:33.737

我不知道您是否是 UML 的忠实粉丝，但[IBM Rational 套件](http://www.ibm.com/developerworks/rational/library/05/ahmed/)非常强大。

我用它从 UML 转移到生成的模拟对象，但这只是它可以做的一小部分

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-03-21T09:17:20.613

如果要生成独立于技术的代码，Zontroy 是一个不错的选择。所以你不需要考虑你的项目是否是JavaEE项目。您可以从数据库中以任何技术生成任何文件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-05-15T16:52:43.223

[jsoncafe.com](http://www.jsoncafe.com)用于 JAVA、Android Gson、Swift Class、Swift Codable、c# 等模型类的在线代码生成器。

# php - Cake PHP中的控制器继承？

> ID：360288
> 
> 赞同：3
> 
> 时间：2008-12-11T18:00:55.963
> 
> 标签：php, cakephp, inheritance

有没有人尝试过这个？有没有可能，如果有的话，如果我尝试完成它会遇到什么样的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T13:55:11.813

如果您的目标是在控制器之间共享逻辑：

*   将逻辑添加到 AppController 以与应用程序中的所有控制器共享。

*   制作一个组件并将其添加到 $this->components 以供您要共享的控制器使用。

在控制器之间添加额外的继承只能作为最后的手段，因为您必须特别注意如何处理组件和助手。例如，您必须手动将 $this->components 和 $this->helpers 与 AppController 和您继承的控制器合并。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-17T09:55:30.280

我在 AppController 和应用程序中的一些特殊控制器之间添加了一个附加层。

您将遇到的唯一问题是 $helpers 和 $components 类属性的合并。在 CakePHP 中，覆盖控制器中的这些变量*不会*覆盖 AppController 设置的变量，但会合并它们。

这是通过 Controller 基类中名为 __mergeVars() 的特殊方法完成的，不幸的是，它只针对默认控制器结构执行此操作。如果您希望 $helpers 和 $controllers 从 AppController 继承到您的控制器，您的附加层将不会正确合并。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-10T12:31:59.100

您将遇到属性不合并而是覆盖的`$components`问题。`$helpers`请务必定义`protected $_mergeParent = 'YourParentClass'`正确完成此操作。默认值为`'AppController'`.

源代码： [http ://api.cakephp.org/2.4/source-class-Controller.html#294-301](http://api.cakephp.org/2.4/source-class-Controller.html#294-301)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T19:01:34.983

为什么不试试？至少，它已经通过 Controller -> AppController -> MyController 类完成了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T20:23:07.893

当然，您可以轻松地在 Cake 中对控制器进行子类化。然后您通常会利用它们的钩子函数（例如“beforeFilter”、“afterFilter”等）将运行时逻辑添加到您的控制器中。我通常会放置至少 1 个抽象控制器在 cakes 控制器和您在路由中配置的最终控制器之间。

# delphi - 寻找进程间通信中使用的 windows 消息的替代方案

> ID：360289
> 
> 赞同：10
> 
> 时间：2008-12-11T18:00:56.527
> 
> 标签：delphi, winapi, windows-vista, window-messages

我有一个多线程应用程序 (MIDAS)，它使用 Windows 消息与自身通信。

主要形式

主窗体接收 RDM LogData('DataToLog') 发送的 windows 消息

因为使用了 windows 消息，所以它们具有以下属性

1.  收到的消息是不可分割的
2.  收到的消息按发送顺序排列

**问题：**

你能建议一个更好的方法来做到这一点而不使用 Windows 消息吗？

**主格式代码**

```
const
    UM_LOGDATA      = WM_USER+1002;

type

  TLogData = Record
      Msg        : TMsgNum;
      Src        : Integer;
      Data       : String;
  end;
  PLogData = ^TLogData;

  TfrmMain = class(TForm)
  //  
  private
    procedure LogData(var Message: TMessage);        message UM_LOGDATA;
  public
  //        
  end;

procedure TfrmMain.LogData(var Message: TMessage);
var LData : PLogData;
begin
    LData  :=  PLogData(Message.LParam);
    SaveData(LData.Msg,LData.Src,LData.Data);
    Dispose(LData);
end; 
```

**RDM 代码**

```
procedure TPostBoxRdm.LogData(DataToLog : String);
var
  WMsg  : TMessage;
  LData : PLogData;
  Msg   : TMsgNum;
begin
  Msg := MSG_POSTBOX_RDM;
  WMsg.LParamLo := Integer(Msg);
  WMsg.LParamHi := Length(DataToLog);
  new(LData);
    LData.Msg    := Msg;
    LData.Src    := 255;
    LData.Data   := DataToLog;
  WMsg.LParam := Integer(LData);
  PostMessage(frmMain.Handle, UM_LOGDATA, Integer(Msg), WMsg.LParam);
end; 
```

编辑：

为什么我想摆脱 Windows 消息：

*   我想将应用程序转换为 Windows 服务
*   当系统繁忙时——windows消息缓冲区已满，速度变慢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-11T20:46:32.277

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T18:05:43.817

选项 1：自定义消息队列

您可以构建自定义消息队列，将消息推送到队列中，根据业务规则对队列进行排序，并从主线程从队列中弹出消息进行处理。使用临界区进行同步。

选项 2：回调

使用回调从线程来回发送数据。同样，使用临界区进行同步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T19:39:22.647

[OmniThreadLibrary](http://otl.17slon.com/)在单元中包含非常高效的消息队列`OtlComm.pas`。

目前文档不是很好（[从这里开始](http://17slon.com/blogs/gabr/2008/07/omnithreadlibrary-internals-otlcomm.html)），但您可以随时使用[论坛](http://otl.17slon.com/forum/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T20:37:01.500

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T12:27:36.190

Windows 消息仍然可以在 Windows Vista 中使用！手头的问题是 vista 中称为用户界面特权隔离 (UIPI) 的技术可防止具有较低完整性级别 (IL) 的进程将消息发送到具有高 IL 的进程（例如，Windows 服务具有高 IL 和用户模式应用程序具有中等 IL）。

但是，这可以被绕过，并且可以允许中等 IL 应用程序将 wm 发送到高 IL 进程。

[维基百科说得最好：](http://en.wikipedia.org/wiki/User_Interface_Privilege_Isolation)

> **UIPI 不是安全边界**，并不旨在防止所有粉碎攻击。UI 可访问性应用程序可以通过将其“uiAccess”值设置为 TRUE 作为其清单文件的一部分来绕过 UIPI。这要求应用程序位于 Program Files 或 Windows 目录中，并由有效的代码签名机构签名，但这些要求不一定会阻止恶意软件尊重它们。
> 
> **此外，仍然允许通过某些消息，例如 WM_KEYDOWN**，它允许较低的 IL 进程将输入驱动到提升的命令提示符。
> 
> **最后，函数 ChangeWindowMessageFilter 允许中等 IL 进程**（除 Internet Explorer 保护模式外的所有非提升进程）**更改高 IL 进程可以从较低 IL 进程接收的消息。这有效地允许绕过 UIPI，** 除非从 Internet Explorer 或其子进程之一运行。

Delphi-PRAXIS 的某个人（链接是德语。使用 Google 翻译页面）已经解决了这个问题，并使用 ChangeWindowMessageFilter 发布了他们的代码。我相信他们的问题是 WM_COPYDATA 在他们修改代码以绕过 WM_COPYDATA 的 UIPI 之前无法在 Vista 上运行。

[原始链接（德语）](http://www.delphipraxis.net/post798158.html)

```
unit uMain; 

interface 

uses 
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms, 
  Dialogs, ExtCtrls, StdCtrls, uallHook, uallProcess, uallUtil, uallKernel; 

type 
  TfrmMain = class(TForm) 
    lbl1: TLabel; 
    tmrSearchCondor: TTimer; 
    mmo1: TMemo; 
    procedure FormCreate(Sender: TObject); 
    procedure tmrSearchCondorTimer(Sender: TObject); 
    procedure FormDestroy(Sender: TObject); 
  private 
    { Private-Deklarationen } 
    fCondorPID : DWord; 
    fInjected : Boolean; 
    fDontWork : Boolean; 
    procedure SearchCondor; 
    procedure InjectMyFunctions; 
    procedure UnloadMyFunctions; 
    function GetDebugPrivileges : Boolean; 
    procedure WriteText(s : string); 
    procedure WMNOTIFYCD(var Msg: TWMCopyData); message WM_COPYDATA; 
  public 
    { Public-Deklarationen } 
  end; 

var 
  frmMain: TfrmMain; 
  ChangeWindowMessageFilter: function (msg : Cardinal; dwFlag : Word) : BOOL; stdcall; 

implementation 

{$R *.dfm} 

type Tmydata = packed record 
       datacount: integer; 
       ind: boolean; 
     end; 

const cCondorApplication = 'notepad.exe'; 
      cinjComFuntionsDLL = 'injComFunctions.dll'; 

var myData : TMydata; 

procedure TfrmMain.WMNOTIFYCD(var Msg: TWMCopyData); 
begin 
  if Msg.CopyDataStruct^.cbData = sizeof(TMydata) then 
  begin 
    CopyMemory(@myData,Msg.CopyDataStruct^.lpData,sizeof(TMyData)); 
    WriteText(IntToStr(mydata.datacount)) 
  end; 
end; 

procedure TfrmMain.WriteText(s : string); 
begin 
  mmo1.Lines.Add(DateTimeToStr(now) + ':> ' + s); 
end; 

procedure TfrmMain.InjectMyFunctions; 
begin 
  if not fInjected then begin 
    if InjectLibrary(fCondorPID, PChar(GetExeDirectory + cinjComFuntionsDLL)) then fInjected := True; 
  end; 
end; 

procedure TfrmMain.UnloadMyFunctions; 
begin 
  if fInjected then begin 
    UnloadLibrary(fCondorPID, PChar(GetExeDirectory + cinjComFuntionsDLL)); 
    fInjected := False; 
  end; 
end; 

procedure TfrmMain.SearchCondor; 
begin 
  fCondorPID := FindProcess(cCondorApplication); 
  if fCondorPID <> 0 then begin 
    lbl1.Caption := 'Notepad is running!'; 
    InjectMyFunctions; 
  end else begin 
    lbl1.Caption := 'Notepad isn''t running!'; 
  end; 
end; 

procedure TfrmMain.FormDestroy(Sender: TObject); 
begin 
  UnloadMyFunctions; 
end; 

function TfrmMain.GetDebugPrivileges : Boolean; 
begin 
  Result := False; 
  if not SetDebugPrivilege(SE_PRIVILEGE_ENABLED) then begin 
    Application.MessageBox('No Debug rights!', 'Error', MB_OK); 
  end else begin 
    Result := True; 
  end; 
end; 

procedure TfrmMain.FormCreate(Sender: TObject); 
begin 
  @ChangeWindowMessageFilter := GetProcAddress(LoadLibrary('user32.dll'), 'ChangeWindowMessageFilter'); 
  ChangeWindowMessageFilter(WM_COPYDATA, 1); 
  fInjected := False; 
  fDontWork := not GetDebugPrivileges; 
  tmrSearchCondor.Enabled := not fDontWork; 
end; 

procedure TfrmMain.tmrSearchCondorTimer(Sender: TObject); 
begin 
  tmrSearchCondor.Enabled := False; 
  SearchCondor; 
  tmrSearchCondor.Enabled := True; 
end; 

end. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T22:47:23.250

madExcept 库等的创建者提供了可用于代替 Windows 消息的 IPC 功能。

[http://help.madshi.net/IPC.htm](http://help.madshi.net/IPC.htm)

我在一个阶段开发了一个 Windows 屏幕保护程序，我想让我的屏幕保护程序向另一个程序发送一些通知，当屏幕保护程序处于活动状态时，我无法让窗口消息在两个应用程序之间工作。

我用上面提到的 IPC 功能替换了它。

工作了一个款待。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-22T07:01:06.563

我将此库用于 IPc（使用共享内存 + 互斥锁）：http: [//17slon.com/gp/gp/gpsync.htm](http://17slon.com/gp/gp/gpsync.htm)

它有 TGpMessageQueueReader 和 TGpMessageQueueWriter。在名称前使用“Global\”，以便在用户登录时使用它在 Windows 服务和“Service GUI Helper”之间进行通信。（由于会话安全环，Vista 需要 Global\ 前缀，也适用于用户会话之间的 Windows XP/2003）。

它非常快，多线程等。我会使用它而不是 WM_COPYDATA （如果你经常使用它会很慢而且开销很大，但对于小事消息可以）

# oracle - 无法查看数据源中的所有表

> ID：360294
> 
> 赞同：0
> 
> 时间：2008-12-11T18:03:00.140
> 
> 标签：oracle, birt

我正在使用Birt 3.4.1。我能够创建一个数据源..但我看不到数据库中的所有表。当我尝试创建数据库时，我在 Oracle 10g 数据库中看到了 1/3 的表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T18:13:35.033

所有表都在同一个模式中吗？

# multithreading - 多核 + 超线程 - 线程如何分布？

> ID：360307
> 
> 赞同：27
> 
> 时间：2008-12-11T18:07:22.193
> 
> 标签：multithreading, operating-system, multicore, hyperthreading

我正在阅读对新 Intel Atom 330 的评论，他们注意到任务管理器显示 4 个内核 - 两个物理内核，再加上两个由超线程模拟的内核。

假设你有一个有两个线程的程序。还假设这些是唯一在 PC 上做任何工作的线程，其他一切都是空闲的。操作系统将两个线程放在同一个内核上的概率是多少？这对程序吞吐量有很大的影响。

如果答案不是 0%，除了创建更多线程之外，还有其他缓解策略吗？

我预计 Windows、Linux 和 Mac OS X 会有不同的答案。

* * *

使用[sk 的答案](https://stackoverflow.com/questions/360307/multicore-hyperthreading-how-are-threads-distributed#360326)作为谷歌素材，然后按照链接，我在 Windows 中找到了[GetLogicalProcessorInformation](http://msdn.microsoft.com/en-us/library/ms683194(VS.85).aspx)函数。它谈到“共享资源的逻辑处理器。这种类型的资源共享的一个例子是超线程场景。” 这意味着[jalf](https://stackoverflow.com/questions/360307/multicore-hyperthreading-how-are-threads-distributed#360385)是正确的，但它不是一个确定的答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T19:04:10.750

Linux 有一个非常复杂的线程调度程序，它支持 HT。它的一些策略包括：

被动负载平衡：如果一个物理 CPU 正在运行多个任务，调度程序将尝试在第二个物理处理器上运行任何新任务。

主动负载平衡：如果有 3 个任务，一个物理 cpu 上 2 个，另一个物理 cpu 上 1 个，当第二个物理处理器空闲时，调度程序将尝试将其中一个任务迁移到它。

它在尝试保持线程亲和性的同时这样做，因为当线程迁移到另一个物理处理器时，它必须从主内存重新填充所有级别的缓存，从而导致任务停止。

所以回答你的问题（至少在 Linux 上）；给定双核超线程机器上的 2 个线程，每个线程将在其自己的物理内核上运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T19:10:26.387

一个健全的操作系统会尝试在它们自己的内核上安排计算密集型任务，但是当你开始上下文切换它们时就会出现问题。现代操作系统仍然倾向于在调度时没有工作的内核上调度事情，但这可能导致并行应用程序中的进程相当自由地从内核交换到内核。对于并行应用程序，您不希望这样，因为您丢失了该进程可能一直在其核心缓存中使用的数据。人们使用处理器亲和性来控制这一点，但在 Linux 上，sched_affinity() 的语义在发行版/内核/供应商等之间可能会有很大差异。

如果您使用的是 Linux，则可以使用[Portable Linux Processor Affinity Library (PLPA)](http://www.open-mpi.org/projects/plpa/)以便携式方式控制处理器关联。这是[OpenMPI](http://www.open-mpi.org/)在内部使用的，以确保进程在多核和多插槽系统中被调度到它们自己的内核；他们刚刚将该模块分离为一个独立的项目。OpenMPI 在洛斯阿拉莫斯以及其他许多地方都使用，因此这是经过良好测试的代码。我不确定 Windows 下的等价物是什么。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-28T22:22:59.340

我一直在寻找有关 Windows 上的线程调度的一些答案，并且有一些经验信息，我将在此处发布，以供将来可能偶然发现这篇文章的任何人使用。

我编写了一个启动两个线程的简单 C# 程序。在我的四核 Windows 7 机器上，我看到了一些令人惊讶的结果。

当我没有强制关联时，Windows 将两个线程的工作负载分散到所有四个内核上。有两行代码被注释掉 - 一行将线程绑定到 CPU，另一行建议使用理想的 CPU。该建议似乎没有效果，但设置线程亲和性确实会导致 Windows 在各自的内核上运行每个线程。

要获得最佳结果，请使用 .NET Framework 4.0 客户端附带的免费提供的编译器 csc.exe 编译此代码，并在具有多核的计算机上运行它。注释掉处理器关联行后，任务管理器显示线程分布在所有四个内核上，每个内核运行率约为 50%。设置关联性后，两个线程以 100% 的速度将两个核心最大化，而其他两个核心处于空闲状态（这是我在运行此测试之前所期望看到的）。

编辑：我最初发现这两种配置的性能存在一些差异。但是，我无法复制它们，所以我编辑了这篇文章以反映这一点。我仍然发现线程亲和力很有趣，因为它不是我所期望的。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Threading.Tasks;

class Program
{
    [DllImport("kernel32")]
    static extern int GetCurrentThreadId();

    static void Main(string[] args)
    {
        Task task1 = Task.Factory.StartNew(() => ThreadFunc(1));
        Task task2 = Task.Factory.StartNew(() => ThreadFunc(2));
        Stopwatch time = Stopwatch.StartNew();
        Task.WaitAll(task1, task2);
        Console.WriteLine(time.Elapsed);
    }

    static void ThreadFunc(int cpu)
    {
        int cur = GetCurrentThreadId();
        var me = Process.GetCurrentProcess().Threads.Cast<ProcessThread>().Where(t => t.Id == cur).Single();
        //me.ProcessorAffinity = (IntPtr)cpu;     //using this line of code binds a thread to each core
        //me.IdealProcessor = cpu;                //seems to have no effect

        //do some CPU / memory bound work
        List<int> ls = new List<int>();
        ls.Add(10);
        for (int j = 1; j != 30000; ++j)
        {
            ls.Add((int)ls.Average());
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-26T03:17:04.320

这是一个非常好的和相关的问题。众所周知，超线程内核并不是真正的 CPU/内核。相反，它是一个虚拟 CPU/核心（从现在开始我会说核心）。从 Windows XP 开始，Windows CPU 调度程序应该能够区分超线程（虚拟）内核和真实内核。您可能会想象，在这个完美的世界中，它“恰到好处”地处理它们，这不是问题。你会错的。

Microsoft 自己的优化 Windows 2008 BizTalk 服务器的建议建议禁用超线程。这表明，对我来说，超线程内核的处理并不完美，有时线程会在超线程内核上获得时间片并遭受惩罚（真实内核性能的一小部分，10% 我' d 猜测，微软猜测 20-30%）。

Microsoft 文章参考，他们建议禁用超线程以提高服务器效率：http: [//msdn.microsoft.com/en-us/library/cc615012 (BTS.10).aspx](http://msdn.microsoft.com/en-us/library/cc615012(BTS.10).aspx)

这是 BIOS 更新后的第二个建议，这就是他们认为的重要性。他们说：

**来自微软：**

> "**在 BizTalk Server 和 SQL Server 计算机上禁用超线程**
> 
> 为BizTalk Server 计算机**关闭超线程至关重要。**这是 BIOS 设置，通常可以在 BIOS 设置的处理器设置中找到。超线程使服务器看起来比实际拥有更多的处理器/处理器内核；然而，超线程处理器通常提供物理处理器/处理器内核的 20% 到 30% 的性能。当 BizTalk Server 统计处理器数量以调整其自调整算法时；超线程处理器会导致这些调整出现偏差，这对整体性能不利。"

现在，他们确实说这是因为它抛弃了自调整算法，但接着又提到了争用问题（这表明这是一个更大的调度问题，至少对我来说是这样）。随意阅读，但我认为它说明了一切。超线程在使用单 CPU 系统时是一个好主意，但现在只是一个复杂的问题，可能会损害这个多核世界的性能。

除了完全禁用超线程之外，您还可以使用 Process Lasso（免费）等程序为关键进程设置默认 CPU 关联性，以便它们的线程永远不会被分配给虚拟 CPU。

所以....仍然不完美。事实上，它可能永远不会完美，因为操作系统不知道哪些线程最好放在这些较慢的虚拟内核上。这可能就是问题所在，也是微软建议在服务器环境中禁用超线程的原因。

还要记住，即使没有超线程，也会出现“核心抖动”的问题。如果您可以将线程保留在单个内核上，那是一件好事，因为它可以减少内核更改的损失。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-11T18:31:34.687

操作系统不会使用尽可能多的物理内核的概率基本上是 0%。你的操作系统并不愚蠢。它的工作是安排一切，它完全知道它有哪些可用的内核。如果它看到两个 CPU 密集型线程，它将确保它们在两个物理内核上运行。

*编辑* 只是为了详细说明一下，对于高性能的东西，一旦你进入 MPI 或其他严肃的并行化框架，你肯定想要控制每个内核上运行的内容。

操作系统将尽最大努力尝试利用所有内核，但它没有您所做的长期信息，即“该线程将运行很长时间”或“我们'将有这么多线程并行执行“。所以它不能做出完美的决定，这意味着你的线程会不时被分配到一个新的核心，这意味着你会遇到缓存未命中等类似情况，这会花费一些时间。对于大多数用途来说，它已经足够好了，您甚至不会注意到性能差异。如果这很重要，它还可以与系统的其他部分配合使用。（在某人的桌面系统上，这可能相当重要。在一个有几千个 CPU 专用于这个任务的网格中，你并不是特别想玩得好，

因此，对于大型 HPC 的东西，是的，您会希望每个线程都保持在一个核心上，并且是固定的。但是对于大多数较小的任务，这并不重要，您可以信任操作系统的调度程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-11T18:14:01.990

您可以通过为它们提供处理器亲和性来确保为相同的执行单元安排两个线程。这可以在 windows 或 unix 中通过 API（因此程序可以请求它）或通过管理界面（因此管理员可以设置它）来完成。例如，在 WinXP 中，您可以使用任务管理器来限制进程可以在哪些逻辑处理器上执行。

否则，调度将基本上是随机的，您可以预期每个逻辑处理器上的使用率为 25%。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-11T18:32:32.483

我不知道其他平台，但就英特尔而言，他们在[英特尔软件网络](http://software.intel.com/en-us/)上发布了很多[关于线程的信息](http://software.intel.com/en-us/multi-core)。他们还有一个免费的时事通讯（英特尔软件调度），您可以通过电子邮件订阅，并且最近有很多这样的文章。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-06T22:39:49.740

操作系统将 2 个活动线程分派到同一个内核的机会**为零**，除非线程绑定到特定内核（线程关联）。

这背后的原因主要与硬件有关：

*   操作系统（和 CPU）希望使用尽可能少的功率，以便尽可能高效地运行任务，以便尽快进入低功耗状态。
*   在同一个核心上运行所有东西会导致它更快地升温。在病态条件下，处理器可能会过热并降低其时钟以冷却。过热还会导致 CPU 风扇转得更快（想想笔记本电脑）并产生更多噪音。
*   系统永远不会真正空闲。ISR 和 DPC 每毫秒运行一次（在大多数现代操作系统上）。
*   在 99.99% 的工作负载中，由于线程从内核跳到内核导致的性能下降可以忽略不计。
*   在所有现代处理器中，最后一级缓存是共享的，因此切换内核并不是那么糟糕。
*   对于多插槽系统 (Numa)，操作系统将最大限度地减少从插槽到插槽的跳跃，以便进程保持“靠近”其内存控制器。在优化此类系统（数十/数百个内核）时，这是一个复杂的领域。

顺便说一句，操作系统知道 CPU 拓扑的方式是通过 ACPI - BIOS 提供的接口。

总而言之，这一切都归结为系统电源考虑因素（电池寿命、电费、冷却解决方案的噪音）。

# actionscript-3 - CRUD vs AGUD vs AFUD ...您的偏好命名约定是什么

> ID：360321
> 
> 赞同：9
> 
> 时间：2008-12-11T18:12:57.593
> 
> 标签：actionscript-3, naming-conventions, crud

你写`createSomething()`还是`addSomething()`？

你写`readSomething()`，`getSomething()`还是`fetchSomething()`？

这完全是一个小小的抱怨。在会议室中，我们将其称为 CRUD，但在实际代码中，它正在变成 AGUD。

您偏好的命名约定是什么？有关系吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T04:07:03.063

我更喜欢**CRUD**而不是**AGUD**和**AFUD**。

* * *

**创建**与**添加**

我们试图用这两个词来表示我们正在构建新的东西。 **CREATE**没有解释的余地​​；以前不存在的东西现在正在建造中。 **ADD**可能有点令人困惑，因为它可能暗示我们正在添加一些已经存在的东西。

* * *

**阅读**与。**获取**/**获取**

对我来说，这里**GET**和**FETCH**的问题可以解释为获取对象的唯一实例以对其进行修改。我喜欢使用**READ**，因为从某种意义上说，我想在一个对象的实例中读取是很清楚的，并且修改修改对象需要单独的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T20:24:41.697

BREAD - 浏览、阅读、编辑、添加、删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T18:19:28.593

我认为这取决于问题/技术的背景 - CREATE 和 ADD 可能不同。

例如我可以创建一个标签。

然后我可以将该标签添加到页面。

我们使用存储库来管理我们的数据访问，根据 Eric Evans 在他的[领域驱动设计](http://books.google.co.uk/books?id=7dlaMs0SECsC&dq=domain+driven+design&pg=PP1&ots=ulAXXY_cv4&source=bn&sig=8XAWjS01zPeAhz-BbtMOk1TCqCY&hl=en&sa=X&oi=book_result&resnum=4&ct=result)书中的说法，您应该将对象添加和删除到存储库中，就好像它是一个内存中的集合一样——即使在幕后它使用的是数据库。

但在回答最初的问题时，我仍然在谈论 CRUD，因为我的内心深处是一个 SQL 粉丝！:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T04:35:21.463

CRUD 作为首字母缩写词效果更好。在实践中，我一般使用 IACREUD：

*   **索引**列出了可编辑的元素；还显示删除表单。
*   **Add**是用于显示添加内容的表单的视图；
*   **Create**是处理 Add 表单的后端代码；
*   **Retrieve**是前端应用程序中使用的唯一视图；
*   **Edit**是用于显示用于编辑现有内容的表单的视图；
*   **更新**是处理编辑表单的后端代码；
*   **Delete**是处理删除表单的后端代码。

我真的想不出一个好的缩写词。。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-09T07:22:14.477

我更喜欢`readXXXX()`，`getXXXX()`因为`getXXX()`可能会引用的`getter / setter`方法`bean`，并且可能会在维护代码时造成混乱

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T18:20:45.847

我认为这是相当普遍的。我们的 DAO 肯定是 Add、Get、Update、Delete（将状态设置为 'C'ancelled 等）方法名称。在数据库级别，它们是插入、选择、更新和删除 - ISUD。

它可以是持久化、获取、删除。根据需要坚持添加或更新。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T03:28:54.007

> 你是写 createSomething() 还是 addSomething()？

当某些东西不存在时，我使用 createThing()，如果某些东西确实存在，我使用 addThing() *，*我们将向它添加不同的东西。

> 你会写 readSomething()、getSomething() 还是 fetchSomething()？

如果我正在读取字节（或类似内容），我会使用 readThing()，如果我正在访问属性，我会使用 getThing()，如果我正在访问外部源，我会使用 fetchThing()。

取决于上下文和偏好。LSS，*创建*东西肯定不同于*添加*东西。就个人而言，我觉得它们不可互换。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T18:36:02.087

我创建一些东西，然后将它添加到其他东西中。添加可以是创建的一部分，有时也可以是包含对象的更新。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-11T18:29:47.030

通常，“获取”是高级别的——从任何地方获取它：缓存、磁盘、配置。“检索”从持久存储中获取值——如果它不在缓存中，通常由“获取”调用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T15:34:18.217

这取决于公司的偏好和标准。这通常不取决于我，这对我来说没问题。一个好的程序员是灵活的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-13T04:39:29.940

当我能想到合适的动词时（凌晨 4 点很难），我会尝试使用更具体的动词。对于大多数事情来说，add/edit/delete/get 已经足够好了，也足够短了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-12T13:40:27.120

归根结底，这取决于您作为一个人，这是您对项目感到满意的地方。我通常使用获取、添加、搜索或类似的东西。问候马克

# visual-studio-2008 - 使用 ReSharper Test Runner 运行 MSTest 单元测试

> ID：360322
> 
> 赞同：3
> 
> 时间：2008-12-11T18:13:06.440
> 
> 标签：visual-studio-2008, unit-testing, resharper, mstest, gallio

我需要使用 ReSharper Unit Test Runner 在 VS 2008 上运行我的 MSTest 单元测试。我听说过使用“Gallio”来执行此操作，但我不知道 Gallio 是什么（它似乎是一些通用的 VS 可扩展性框架） . 有谁知道使用 ReSharper Test Runner 运行 MSTest 单元测试的最佳方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T08:07:30.777

请注意，您可以通过 Early Access Program 获得 ReSharper 4.5，它将支持开箱即用的 MSTest。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T19:37:47.083

看：

[通过 Gallio 使用 Resharper 单元测试运行器进行 MSTest](https://stackoverflow.com/questions/94057/using-resharper-unit-test-runner-for-mstest-via-gallio)

和

[http://www.jameskovacs.com/blog/IntroducingVstsUnitPluginForReSharper.aspx](http://www.jameskovacs.com/blog/IntroducingVstsUnitPluginForReSharper.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:25:35.333

我尝试了最新的 ReSharper 4.5 nightly build（2009 年 2 月 27 日/#1181），它运行良好，但我必须明确地将测试或固定装置添加到单元测试会话中。不幸的是，我无法从项目或解决方案中运行所有测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T07:21:04.607

您不需要 resharper 来支持独立的 mstest 安装。我在这里的帖子中解释了如何在没有 VS 的情况下进行独立的 mstest 安装 - [http://www.shunra.com/shunrablog/index.php/2009/04/running-mstest-without-visual-studio](http://www.shunra.com/shunrablog/index.php/2009/04/running-mstest-without-visual-studio)

# c# - ADO.NET 数据服务

> ID：360329
> 
> 赞同：2
> 
> 时间：2008-12-11T18:14:43.223
> 
> 标签：c#, .net, ado.net, ado.net-entity-data-model

我正在考虑将 ADO.NET 数据服务与 silverlight 一起使用。我一直在查看 msdn 上的 [数据模型和数据服务实现（ADO.NET 数据服务/Silverlight）](http://msdn.microsoft.com/en-us/library/cc838239(VS.95).aspx)主题。在他们的示例中，他们构建了从数据库生成的数据模型，并在数据模型中查询实体。就我而言，我想使用存储过程，所以我创建了数据模型并添加了存储过程而不是表和视图，但现在我不确定如何执行它们。有人有示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T18:26:15.010

只需在构建实体框架模型时指定存储过程。有[很多关于此的文档](http://msdn.microsoft.com/en-us/library/bb399203.aspx)。您还可以观看[截屏视频](http://www.asp.net/learn/3.5-SP1/video-245.aspx)。

作为澄清点，我认为您的问题没有任何特定的数据服务。这更像是一个实体框架问题。

# hardware - 多核编程

> ID：360330
> 
> 赞同：5
> 
> 时间：2008-12-11T18:15:00.350
> 
> 标签：hardware, multicore

我想进入多核编程（不是特定于语言）并且想知道可以推荐哪些硬件来探索这个领域。我的目标是升级我现有的桌面。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T19:00:46.857

如果可能的话，我建议买一台双路机器，最好是四核芯片。您当然可以获得单插槽机器，但双插槽会让您开始看到 NUMA 内存的一些影响，随着核心数量越来越多，这些影响将会加剧。

你为什么在乎？现在多核开发者面临两个巨大的问题：

1.  **编程模型** 并行编程很难，并且（目前）无法解决这个问题。四核系统将让您开始使用真正的并发性和所有流行的范例（线程、UPC、MPI、OpenMP 等）。

2.  **内存** 每当您开始拥有多个线程时，就会出现资源争用，并且内存墙越来越大。arstechnica[最近的一篇文章](http://arstechnica.com/news.ars/post/20081207-analysis-more-than-16-cores-may-well-be-pointless.html)概述了桑迪亚的一些（非常初步的）研究，表明如果当前趋势继续下去，这可能会变得多么糟糕。多核机器将不得不让所有东西都吃饱，这将要求人们非常熟悉他们的内存系统。双插槽将 NUMA 添加到组合中（至少在 AMD 机器上），这应该让您开始走上这条艰难的道路。

如果您对有关多插槽机器的性能不一致的更多信息感兴趣，您还可以查看[此主题的技术报告](http://www.renci.org/publications/techreports/TR-08-07.pdf)。

此外，其他人建议使用支持 CUDA 的 GPU 的系统，我认为这也是进入多线程编程的好方法。它比我上面提到的东西级别低，但如果可以的话，在你的机器上扔一个。新的 Portland Group 编译器[临时支持使用 CUDA 优化循环](http://www.pgroup.com/resources/accel.htm)，因此即使您不想自己学习 CUDA，也可以使用 GPU。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T18:44:08.217

四核，因为它允许您解决并发进程数大于 2 的问题，这通常不会使问题变得简单。

*对于纯粹的 geek squee* ，我也会选择一张漂亮的 NVidia 卡并使用 CUDA API。如果你有钱，有一个独立的 CUDA 工作站，它通过电缆和扩展槽插入你的主计算机。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T19:08:22.397

这取决于你想做什么。

如果您想学习多线程编程的基础知识，那么您可以在现有的单核 PC 上进行。（如果您有 2 个线程，那么操作系统将在单核 PC 上在它们之间切换。然后当您转移到双核 PC 时，它们应该会自动在单独的内核上并行运行，以实现 2 倍的加速）。这样做的好处是免费！缺点是您不会看到加速（事实上，由于开销，并行实现可能会稍微慢一些），并且错误代码的工作机会略高。

但是，尽管您可以在单核机器上学习多线程编程，但双核（甚至超线程）CPU 将有很大帮助。

如果你想对你正在编写的代码进行真正的压力测试，那么正如“蓝色燕尾服”所说，你应该尽可能多地使用你能负担得起的内核，如果可能的话，还要使用超线程。

如果您想了解在显卡上运行的算法（这与 x86 多核非常不同），请获取 CUDA 并购买支持它的普通 nVidia 显卡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T18:16:54.590

我建议至少使用四核处理器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T18:20:51.073

您可以尝试修补[CUDA](http://www.nvidia.com/object/cuda_home.html#)。它是免费的，使用起来并不难，并且可以在任何最新的 NVIDIA 卡上运行*。*

或者，您可以获得 PlayStation 3 和[Linux SDK](http://moss.csc.ncsu.edu/~mueller/cluster/ps3/)，并研究如何对 Cell 处理器进行编程。请注意，Cell BE 开发的下一个最便宜的选择是比 PS3 贵一个数量级。

最后，任何采用 Core Quad 或四核 Opteron 的现代主板（从华硕或其他知名制造商处获得好的主板）都可以让您以合理的价格试用多核 PC 系统。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T19:56:16.077

我同意，根据您最终想要做什么，您可能只使用当前的单核系统即可。多核编程基本上是多线程编程，你当然可以在单核芯片上做到这一点。

当我还是学生的时候，我们的一个项目是为 C 构建一个线程安全的 malloc 库实现。即使在单核处理器上，这也足以治愈我对多线程编程的渴望。在你开始考虑花很多钱之前，我会尝试一些类似的小东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-11T18:55:59.880

多线程/核心编程的困难在于它打开了一个全新的蠕虫罐。您将面临的错误通常不是您习惯的错误。竞争条件可能会在很长一段时间内保持休眠状态，直到它们咬人并且您的主流语言编译器不会以任何方式帮助您。您将获得每天/每周/每月/每年仅发生一次的随机数据和/或崩溃，通常是在最神秘的条件下......

幸运的是，一件事仍然正确：计算机表现出的并发性越高，您将揭示的竞争条件就越多。

因此，如果您对多线程/内核编程很认真，那么请尽可能多地使用 cpu**内核**。请记住，超线程和 SMT 都不允许多核提供的并发级别。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T18:39:46.260

我同意其他我将升级到四核处理器的观点。我也是华硕主板的忠实粉丝（P5Q Pro 非常适合 Core2Quad 和 Core2Duo 处理器）！

多核编程的吸引力在于您拥有更多资源来更快地完成工作。如果你对多核编程很认真，那么我绝对会买一个四核处理器。我不认为你应该从英特尔获得新的 i7 架构来利用多核处理，因为任何为利用 Core2Duo 或 Core2Quad 而编写的东西都会在新架构上运行得更好。

如果你打算涉足多核编程，那么我会得到一个好的 Core2Duo 处理器。请记住，这不仅仅是您拥有多少核心，还有核心处理作业的速度有多快。运行在 4GHz 的 Core2Duo 通常比运行在 2.4GHz 的 Core2Quad 更快地完成工作，即使使用多核程序也是如此。

让我知道这是否有帮助！联合部队

# networking - IP-in-IP的必要性是什么？

> ID：360331
> 
> 赞同：2
> 
> 时间：2008-12-11T18:15:30.507
> 
> 标签：networking, language-agnostic, ip-protocol

IP封装中甚至还有一个IP[标准。](http://www.networksorcery.com/enp/protocol/ip-ip.htm)这里的用例是什么？我可以理解 TCP over DNS 之类的东西，其中 IP 可能不可用，但如果你可以在 IP 中做 IP，你不能简单地做常规 IP 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T18:24:42.173

明显的例子：您的网关将数据包丢弃到主机 A，但您可以将数据包发送到主机 B，而主机 B 可以发送到主机 A。因此，您通过隧道连接到 B，然后转发到 A。IP 中的 IP 只允许您在独立于应用程序的方式，与应用程序级代理不同，并且您保留 TTL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T07:28:46.727

这是一个隧道案例。您可以通过在每一端的网关上终止的链路连接两个远程办公室。这些网关只允许来自对等网关的流量。位于网关后面的 LAN 上的主机无法直接访问远程办公室中的另一台主机。它需要它的网关来封装指定它自己的IP作为源的数据包，以便对等网关将接受它，解封装并将它发送到局域网上的远程主机。正如 Moocha 所说，从一个网关到另一个网关的旅程将被视为一跳。

# image - 使用经典 ASP 上传图片

> ID：360334
> 
> 赞同：4
> 
> 时间：2008-12-11T18:17:00.473
> 
> 标签：image, asp-classic, upload, components

嘿，我想知道是否有任何方法可以在 ASP 中上传图像？我正在我学校的服务器上工作，我真的不知道安装了什么，什么不是我用谷歌搜索了一下并想出了“Persits.Upload.1”我试图用这一行实例化对象：

`Set Upload = Server.CreateObject("Persits.Upload.1")`

它给了我这个错误，

> 服务器对象错误“ASP 0177：800401f3”
> Server.CreateObject 失败

我是否假设该组件未安装在服务器上和/或我应该如何上传图片？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T18:26:37.270

听起来它无法加载类，但我的 ASP 很生锈。

该组件是商业组件，因此除非有人付费，否则您可能没有安装它。

我已经使用过免费的 asp 上传[http://www.freeaspupload.net/](http://www.freeaspupload.net/)几次，虽然已经有一段时间了，但这对你来说可能是一个相当容易的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T18:25:30.347

文件上传是 html 的内置部分，您可以在 asp 中处理它而无需任何自定义组件。以下是更多信息： [http ://www.4guysfromrolla.com/webtech/LearnMore/Upload.asp](http://www.4guysfromrolla.com/webtech/LearnMore/Upload.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T18:26:27.130

这是 ASPJpeg 库的一部分，需要购买（来自 Persits.com）。

我过去曾使用此库上传多个项目。

要上传单个文件，您可以使用`<INPUT type=file name=filename>`. 虽然这只是 HTML，但应该适用于所有浏览器

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T18:27:51.853

如果是出于教育目的，可能值得给[Persits](http://www.aspupload.com/support.html)发送一封电子邮件，看看他们是否会给你免费许可证。

他们在其网站上提供 30 天免费试用。

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T18:28:49.480

Will Rickards 的链接很好。您还需要 IUSR 的权限才能在您上传的任何目录中创建文件。

IIS（我认为是 6？）上传文件的限制为 200K。只有服务器管理员可以更改它以允许更多。

如果您可以让您的学校服务器安装 COM 对象，那么有许多免费的上传工具可以让事情变得非常简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T18:29:26.453

我有使用 Persits Software AspUpload 组件的较旧的经典 ASP 应用程序。如果您需要在上传过程中调整图像大小、获取图像尺寸等，它会非常有用。它是您需要购买的组件，并且需要安装在 Web 服务器上才能正常工作。它不是 ASP 的核心部分。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-01T14:16:44.207

顺便说一句，您的代码中有错字，是

```
Server.CreateObject("Persist.Upload.1") 
```

并不是

```
Server.CreateObject("Persits.Upload.1") 
```

我敢打赌，如果您更正此问题，代码将会顺利进行：D

# database - 数据库数据上传设计题

> ID：360335
> 
> 赞同：1
> 
> 时间：2008-12-11T18:17:12.187
> 
> 标签：database, shell

我在这里寻找一些设计帮助。

我正在为一个客户工作，该客户需要我存储有关他们数以万计员工的数据。数据以 Excel 电子表格的形式提供给我，每个城市/国家/地区都有办事处。

我有一个包含电子表格表和数据表的数据库。数据表有一个电子表格_id 列，它将它链接回电子表格表，以便我知道每个数据行来自哪个电子表格。我还有一个简单的 shell 脚本，可以将数据上传到数据库。

到目前为止，一切都很好。但是，原始电子表格中缺少一些数据，客户并没有只给我丢失的数据，而是给了我原始电子表格的修改版本，并附加了新数据。我不能简单地覆盖原始数据，因为数据已经被使用并且还有其他表链接到它。

问题是 - 我该如何处理？在我看来，我有以下选择：

1.  上传整个修改后的电子表格，并将原始电子表格标记为“非活动”。

    优点：它简单、直接且易于自动化。
    缺点：有很多冗余数据不必要地存储在数据库中，尤其是在电子表格多次更改时。

2.  对电子表格进行比较，仅上传更改的行。

    优点：加载到数据库中的数据更少。
    缺点：它至少部分是手动的，因此容易出错。这也意味着数据库将不再讲述整个故事 - 例如，如果某些数据在以后丢失，我将无法权威地说我只是通过查询数据库从未得到数据。即使我必须多次做差异，是否会继续工作？

3.  编写一个过程，将每个电子表格行与数据库中的内容进行比较，插入已更改数据的行，并将原始数据行设置为非活动状态。（我还必须跟踪原始数据，所以我不能覆盖它。）

    优点：它是自动化的。
    缺点：编写和测试这样的过程需要时间，而且我很难证明花费的时间是合理的。

我希望提出第四个更好的解决方案。关于那可能是什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T18:28:49.387

如果您无法 100% 确定您可以避免选项 2 中的人为错误，请不要这样做。

选项 3：编写一个为您进行比较的 VBA 脚本应该不会太困难（或耗时）。VBA 并不*快*，但你可以让它运行一夜。不应该花费超过一两个小时才能让它运行无错误。

选项 1：这将是我的首选方法：快速、简单，而且我现在想不出任何可能出错的地方。（好吧，您应该先将原始数据标记为“非活动”，然后上传新的数据集 IMO）。尤其是如果这种情况在未来会更频繁地发生，那么有一个稳定而快速的流程来处理它就很重要。

如果您真的担心所有不活动的条目，您也可以在更新后删除它们（`delete from spreadsheets where status='inactive'`或类似的）。但到目前为止，我在工作中看到的所有数据库都有很多这样的数据库。我不会太担心它。

# c++ - C#/Java 程序员再次学习 C++。项目文件结构？

> ID：360338
> 
> 赞同：3
> 
> 时间：2008-12-11T18:18:27.660
> 
> 标签：c++

正如问题所述，我是一名对（重新）学习 C++ 感兴趣的 C#/Java 程序员。如您所知，C#/Java 的项目文件结构有些严格（尤其是 Java）。我发现这个结构非常有帮助，我想知道它是否是 a) 在 C++ 中做类似结构的好习惯，b) 如果是，那么设置它的最佳方法是什么？

我知道有基本的“标题”和“源”文件夹，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T18:28:27.733

我发现java项目的结构相当不错。我这样做（root是根目录）

*root/include/foo/bar/baz.hpp*变成

```
namespace foo { 
namespace bar {
    // declare/define the stuff (classes, functions) here
} } // foo::bar 
```

在代码中。

我保留源代码

*根/src/foo/bar/baz.cpp*。如果我有一些没有暴露在外面的东西，我会把它放到一个*detail/*目录和命名空间中。我将 makefile 保存在*root/*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T19:10:31.813

> a）（是）在 C++ 中做类似结构的好习惯，

找出答案的一种方法是下载一些开源项目并查看它们的文件结构。

以我的经验，使用的构建工具最终决定了文件结构。如果使用您选择的构建工具拥有很多子目录有点痛苦，那么您将不会有很多子目录。

> b) 如果是这样，最好的设置方法是什么？

这取决于您的构建/开发环境。我个人使用 vim 和 Linux 文件工具，所以我手动设置了这一切。使用 Eclipse 或 Visual Studio 的人可能有许多向导可供使用。

# linux - 在 Ubuntu 上具有多个用户的 Git 存储库

> ID：360348
> 
> 赞同：12
> 
> 时间：2008-12-11T18:20:52.307
> 
> 标签：linux, security, git, ubuntu, repository

我有一个位于 /home/myaccount/git/project 的现有裸 git 存储库。我目前正在本地机器上通过 ssh 使用它，没有任何问题。我想在服务器上添加第二个用户，该用户只能访问这个 git 存储库（也许将存储库移到我的帐户文件夹之外？）。如何？在 slicehost 上使用最新版本的 git 和 ubuntu。

我有这个设置：用户：sleepyhead 用户：developer1 组：git。sleepyhead 和 developer1 都是该组存储库 /home/sleepyhead/git/project1 的成员

我想：将存储库移动到适当的位置，/home/git/project1 或 /usr/local/git/project1。推荐什么？developer1 应该具有使用 git 读写 project1 的权限。不应授予其他权限。

我不知道如何正确设置权限并将 developer1 限制为只能使用 git 访问 project1。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T22:06:02.850

让他创建一个 ssh 密钥对并向您发送公钥。

将公钥添加到您的`~/.ssh/authorized_keys`文件中，并添加将`command="..."`其限制为 git-shell 的选项 - 请参阅[此链接](http://kitenet.net/~joey/blog/entry/locking_down_ssh_authorized_keys/)以获取示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T23:24:27.497

Orip 的答案可能就是您所需要的。如果你想要一些更自动化的东西，你可能想看看[gitosis](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T02:35:09.500

您可能还希望将这两个用户都放在同一个用户组中，并确保您对存储库具有组写入权限。

# actionscript-3 - 有什么方法可以将 ActionScript 3 中的常规字符串转换为 Latin-1 字符代码的 ByteArray？

> ID：360353
> 
> 赞同：6
> 
> 时间：2008-12-11T18:22:53.953
> 
> 标签：actionscript-3, erlang, utf-16, iso-8859-1

我将字符串转换为 UTF-16 编码字符的 byteArray 没有问题，但是我尝试与之通信的应用程序（用 Erlang 编写）只理解 Latin-1 编码。有什么方法可以从 Actionscript 3 中的字符串生成一个充满 Latin-1 字符代码的 byteArray？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-11T20:49:35.267

byteArray.writeMultiByte(string, "iso-8859-1");

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/utils/ByteArray.html#writeMultiByte()](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/utils/ByteArray.html#writeMultiByte())

# inversion-of-control - Castle Windsor - Null 构造函数参数

> ID：360362
> 
> 赞同：6
> 
> 时间：2008-12-11T18:26:15.803
> 
> 标签：inversion-of-control, castle-windsor

如何使用 Castle Windsor 传递空构造函数参数？我认为以下会起作用

```
<parameters>
  <repository>null</repository>
  <message>null</message>
</parameters>` 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-31T22:15:01.323

If you want them to be null, it means that they are non-essential dependencies. By having them as ctor arguments you suggest otherwise. You should redesign your class to have another constructor that takes only essential dependencies, if you wish that they not change throughout the lifetime of an object (be readonly), or expose them as properties.

With Windsor you can't make it to pass nulls, for reasons mentioned in the other answer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T18:31:44.297

简单地拥有一个不接受这些参数的额外公共构造函数不是更好，那么您就不需要在配置中注册参数了吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T18:32:11.563

这在邮件列表上讨论过一段时间，当时我查看了代码。空值被故意过滤掉（主要是因为复杂的类型解析）。

我找不到一种简单的方法来制作特殊情况来添加它们。

# iphone - 将 UIImage 保存到相册，然后打开照片应用程序

> ID：360365
> 
> 赞同：1
> 
> 时间：2008-12-11T18:26:45.600
> 
> 标签：iphone

目前我正在使用 UIImageWriteToSavedPhotosAlbum 将 UIImage 保存到相册，效果很好。

有没有办法打开显示刚刚保存的照片的照片应用程序？（我假设我的应用程序必须在打开照片之前关闭，这很好。）

如果上述情况不可行，只需将照片应用程序打开到已保存的相册将不是一个很好的选择。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T12:37:28.530

无法打开照片应用程序。但是，作为一种解决方法，您可以使用 .打开保存照片的相册`UIImagePickerViewController`。然后，用户可以单击图像并查看它。这样，他们甚至不必退出您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T19:10:09.553

不，使用 SDK 是不可能的。如果这是您认为需要的，您应该[提交增强请求](http://bugreporter.apple.com)。

# unix - 响应式轻量级远程 GUI 连接

> ID：360366
> 
> 赞同：2
> 
> 时间：2008-12-11T18:27:15.177
> 
> 标签：unix, virtualization, xserver

目前我知道几种远程连接到 GUI 或远程运行 GUI 应用程序的方法：

1.  Microsoft 终端服务（仅适用于远程窗口；安装）；
2.  VNC（很慢）；
3.  XDMCP（需要远程 X 服务器运行，没有会话持久性）；
4.  本地 X 作为应用程序的远程 DISPLAY（最佳解决方案，但 - 没有会话持久性）。

我们正在尝试为我们的开发人员创建可以替代本地工作站的 Solaris 开发环境。因此，要求之一是会话持久性和/或会话移动性。另一个要求是它要快，并且必须在 Solaris/UNIX 上运行。

有什么轻量级的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T18:39:11.363

NoMachine ( [http://www.nomachine.com/](http://www.nomachine.com/) ) 或 FreeNX ( [http://freenx.berlios.de/](http://freenx.berlios.de/) ) 听起来像你想要的。快速，在您的连接断开时保持会话，甚至可以通过 SSH 工作，因此您的连接被加密。

# python - python中类的Lambda函数？

> ID：360368
> 
> 赞同：11
> 
> 时间：2008-12-11T18:27:21.107
> 
> 标签：python, lambda

必须有一种简单的方法来做到这一点，但不知何故我可以绕着它走。我可以描述我想要的最好的方法是一个类的 lambda 函数。我有一个库，它期望使用一个未实例化的类版本作为参数。然后它实例化类本身以进行处理。问题是我希望能够动态地创建类的版本，以传递给库，但我不知道该怎么做，因为库需要一个未实例化的版本。下面的代码描述了这个问题：

```
class Double:
    def run(self,x):
        return x*2

class Triple:
    def run(self,x):
        return x*3

class Multiply:
    def __init__(self,mult):
        self.mult = mult
    def run(self,x):
        return x*self.mult

class Library:
    def __init__(self,c):
        self.c = c()
    def Op(self,val):
        return self.c.run(val)

op1 = Double
op2 = Triple
#op3 = Multiply(5)

lib1 = Library(op1)
lib2 = Library(op2)
#lib3 = Library(op3)

print lib1.Op(2)
print lib2.Op(2)
#print lib3.Op(2) 
```

我不能使用通用的 Multiply 类，因为我必须先实例化它，这会破坏库“AttributeError：Multiply 实例没有**调用**方法”。在不更改 Library 类的情况下，有没有办法可以做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-11T18:44:54.597

库是否真的指定它想要一个“未初始化的版本”（即类引用）？

在我看来，图书馆好像真的想要一个对象工厂。在这种情况下，可以输入：

```
lib3 = Library(lambda: Multiply(5)) 
```

要了解 lambda 的工作原理，请考虑以下事项：

```
Multiply5 = lambda: Multiply(5)
assert Multiply5().run(3) == Multiply(5).run(3) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-11T18:53:30.070

根本不需要 lambda。lambda 只是定义一个函数并同时使用它的语法糖。就像任何 lambda 调用都可以用显式 def 替换一样，我们可以通过创建一个满足您需求的真实类并返回它来解决您的问题。

```
class Double:
        def run(self,x):
            return x*2

class Triple:
    def run(self,x):
        return x*3

def createMultiplier(n):
    class Multiply:
        def run(self,x):
            return x*n
    return Multiply

class Library:
    def __init__(self,c):
        self.c = c()
    def Op(self,val):
        return self.c.run(val)

op1 = Double
op2 = Triple
op3 = createMultiplier(5)

lib1 = Library(op1)
lib2 = Library(op2)
lib3 = Library(op3)

print lib1.Op(2)
print lib2.Op(2)
print lib3.Op(2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T18:39:04.110

这有点作弊，但你可以给你的 Multiply 类一个`__call__`返回自身的方法：

```
class Multiply:
    def __init__(self,mult):
        self.mult = mult
    def __call__(self):
        return self
    def run(self,x):
        return x*self.mult 
```

这样，当库调用`c()`它时，它实际上会调用`c.__call__()`它返回你想要的对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T18:42:25.663

```
def mult(x):
    def f():
        return Multiply(x)
    return f

op3 = mult(5)
lib3 = Library(op3)
print lib3.Op(2) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T18:50:19.360

`Library`如果我正确理解了您的问题空间，则您有一个通用接口，该接口接受 1 个使用该类调用的参数。不幸的是，不是调用函数，而是`Library`假设函数被包装在一个带有`run`方法的类中。

您当然可以以编程方式创建这些类。类可以由方法返回，并且由于闭包的概念，您应该能够将任何函数包装在满足您需求的类中。就像是：

```
def make_op(f):
  class MyOp(object):
    def run(self, x):
      return f(x)
  return MyOp

op1 = make_op(lambda x: return x*2)
op2 = make_op(lambda x: return x*3)

def multiply_op(y):
    return make_op(lambda x: return x*y)

op3 = multiply_op(3)

lib1 = Library(op1)
lib2 = Library(op2)
lib3 = Library(op3)

print( lib1.Op(2) )
print( lib2.Op(2) )
print( lib3.Op(2) ) 
```

话虽如此，将库更改为获取函数然后提供函数可能是执行此操作的更强大的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-03T18:09:12.623

由于`type`是 python 类对象的默认类，调用一个类会创建该类的一个新实例，`type`使用正确的参数调用将产生一个新类。

```
my_class = type("my_class", (object,), {"an_attribute": 1}) 
```

`my_class`现在引用一个名为“my_class”的新类，它是 的子类`object`，具有一个名为“an_attribute”的属性，其值为 1。由于方法也只是指向函数对象的类属性，因此您可以将它们添加到字典中属性以及：

```
{"an_attribute": 1, "a_method": lambda self: print("Hello")} 
```

这就是它的工作原理。我不建议这样做，除非你绝对需要。在 99% 的情况下，你没有。请参阅@Parker Coates 的回答，了解实现目标的干净方式。

# wpf - WPF：将listviewitem的背景颜色绑定到对象的十六进制字符串属性

> ID：360369
> 
> 赞同：5
> 
> 时间：2008-12-11T18:27:28.297
> 
> 标签：wpf, listview, binding, colors, listviewitem

嘿。我有一个对象，它有一个名为 BackgroundColor 的字符串属性。此字符串是颜色的十六进制表示。我无法更改此对象。

我将这些对象的集合绑定到 listView。我想做的是将列表视图行的背景绑定到行中显示的对象的 BackgroundColor 属性。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T19:33:00.023

您需要使用 Style 将 ListViewItem 的背景绑定到该行的项目。该项目是 ListViewItem 的默认 DataContext 所以这应该很简单：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid.Resources>
        <x:Array x:Key="colors" Type="{x:Type sys:String}">
            <sys:String>Red</sys:String>
            <sys:String>Yellow</sys:String>
            <sys:String>#0000FF</sys:String>
        </x:Array>
    </Grid.Resources>
    <ListView ItemsSource="{StaticResource colors}">
        <ListView.Resources>
            <Style TargetType="{x:Type ListViewItem}">
                <Setter Property="Background" Value="{Binding .}"/>
            </Style>
        </ListView.Resources>
    </ListView>
</Grid> 
```

您将绑定到 BackgroundColor，而不是绑定到整个项目，但它应该与上述类似。您必须使用带有绑定前缀的转换器“#”，这是内置 BrushConverter 将其解析为十六进制的信号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T19:25:05.140

我认为使用[IValueConverter](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)是合适的解决方案。您可以制作一个 HexConverter，将字符串十六进制值转换为颜色。该链接应该可以帮助您入门。

# xml - Castle Windsor：如何将我的连线 xml 文件分解为多个文件？

> ID：360373
> 
> 赞同：2
> 
> 时间：2008-12-11T18:28:48.840
> 
> 标签：xml, configuration, castle-windsor

我记得不久前在一个示例中看到，可以将 windsor 配置文件分解为多个文件，然后从 app.config 中以自动解析的方式引用它们。

当然，我没有为它添加书签，现在我找不到它，而且我的 Windsor.Config.xml 文件正在爬上 600 行。谁能告诉我该怎么做？

目前我只是直接从文件中实例化我的容器： IWindsorContainer container = new WindsorContainer("Windsor.Config.xml");

但我想分解它，引用 app.config 中的 xml 并自动包含它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T18:35:59.780

我认为您的意思是使用包括：

[http://www.castleproject.org/container/documentation/v1rc3/usersguide/includes.html](http://www.castleproject.org/container/documentation/v1rc3/usersguide/includes.html)

您需要做的就是指定一个包含 Uri 的包含节点，该 Uri 将用于创建正确的资源。例如，以下将使用 FileResource：

该文件相对于包含以下内容的配置文件：

```
<include uri="file://Configurations/facilities.xml">
<include uri="file://Configurations/services.xml"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T18:35:11.840

[您可以使用包含](http://castleproject.org/container/documentation/trunk/usersguide/includes.html)将城堡配置分解为多个文件

# wpf - 如何在初始化后激活/停用模块的视图？

> ID：360378
> 
> 赞同：3
> 
> 时间：2008-12-11T18:29:41.443
> 
> 标签：wpf, prism, modularity, cag

这与 WPF 或 Prism 的复合应用程序指南有关。

我的外壳中有一个“MainRegion”。我的各种模块将被加载到这个主要区域。我可以在菜单中填充可用模块的列表并选择它们进行加载。单击菜单，我会执行以下操作：

```
var module = moduleEnumerator.GetModule(moduleName);
moduleLoader.Initialize(new[] { module }); 
```

第一次一切正常，因为执行了模块的Initialize()方法，但是在Module1，Module2和Module3初始化之后，再次点击加载Module2时没有任何反应。

我的问题：在执行了初始化方法后，如何按需激活模块？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T10:22:13.213

您实际上并没有激活该模块。您激活区域中的视图。阅读这篇[文章](http://compositewpf.codeplex.com/Thread/View.aspx?ThreadId=42862)。

Initialize 方法只对任何模块调用一次。当您调用 LoadModule 时，您看到模块中的视图被激活，我猜这是因为 Initilalize 方法正在向区域注册视图。这将激活视图。如果您有多个视图，则最后注册的将是活动视图。

要激活视图，您需要调用区域的激活方法（假设注入了 IUnityContainer 和 IRegionManager）...

```
// Get a view from the container.
var view = Container.Resolve<MyView>();

// Get the region.
var region = RegionManager.Regions["MyRegion"];

// Activate the view.
region.Activate(view); 
```

根据区域控件的类型，这将替换那里的视图或添加到其中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-10T21:46:53.537

您可以通过调用 Regions 的 Remove 方法来删​​除视图。

```
public void RemoveViewFromRegion(string viewName, string regionName, object defaultView)
    {
      IRegion region = regionManager.Regions[regionName];
      object view = region.GetView(viewName);
      region.Remove(view);
      region.Activate(defaultView); 
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T21:50:19.433

您应该有一个 ContentControl 将成为您的区域。然后，您需要将所有模块添加到该区域。当您单击菜单时，您应该使用该区域的 Activate(...) 方法来激活特定模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-05T23:20:47.837

这是否意味着当你激活模块时，可能被它重叠的其他模块设置为Visibility.Collapsed？

# c# - 计划任务在路径中有空格

> ID：360392
> 
> 赞同：0
> 
> 时间：2008-12-11T18:35:05.490
> 
> 标签：c#, .net, .net-2.0, c#-2.0

我们正在以编程方式安排任务。但是，要调度的可执行文件可以安装在包含空格的路径中。即 c:\program Files\folder\folder\folder program\program.exe

当我们将此路径作为参数提供给任务调度程序时，它无法启动，因为它找不到可执行文件。它显然需要用引号 (") 括起来。

我们遇到的问题是，即使我们将路径作为参数传递时用引号括起来（cmd + "\" + path + "\"），它仍然不包含用于调度的路径中的引号任务。

任何人都知道如何强制将引号包含在路径中？

**编辑：回答评论：**

我们有同样的想法，这就是问题所在。~1 格式基于文件夹的索引，所以如果说你有这 3 个文件夹：

```
Program Applications
Program Files
Program Zips 
```

那么路径将是：progra~2

现在，如果您说这些文件夹中有 10 个以上，则路径可能如下所示：progr~12。

现在，并不是说这不是一个可行的解决方案，而是必须计算文件夹以找到正确的文件夹，然后使用索引来构建路径有点麻烦，而且 IMO 也不是很干净。

我们希望有更好的方法。

**编辑 2：添加了适用的代码片段**

您要求提供代码：这就是我们构建传递给调度程序的 Args 字符串的方式：

```
string args = "/CREATE /RU SYSTEM /SC " + taskSchedule + " /MO " + taskModifier + " /SD " + taskStartDate + " /ST " + taskStartTime + " /TN " + taskName + " /TR \"" + taskSource + "\""; 
```

其中 taskSource 是应用程序的路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T20:02:19.107

看来您正在使用 schtasks.exe - 我花了更长的时间才弄清楚这一点，而不是找到答案！请提供更多详细信息！[:) 我通过快速谷歌搜索](http://tinyurl.com/6z6m8j)找到了答案

试试这个代码：

```
string args = "/CREATE /RU SYSTEM /SC " + taskSchedule + " /MO " + taskModifier + " /SD " + taskStartDate + " /ST " + taskStartTime + " /TN " + taskName + " /TR \"\\\"" + taskSource + "\"" 
```

它在 TR 参数值的前面添加了一个 \"。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T18:58:52.073

您可以将程序文件替换为 progra~1
并将文件夹程序替换为文件夹~1（第一个 6 个字母和 ~1）以使其正常工作，直到有人发布正确的答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T18:59:09.373

你能显示代码吗？

即使上面示例中的路径为“路径”（带引号），然后进行调用

这可能也有帮助 [http://www.jguru.com/faq/viewquestion.jsp?EID=768691](http://www.jguru.com/faq/viewquestion.jsp?EID=768691)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T19:17:38.947

猜测短名称不是一个好方法，因为它是一个实现细节，并且可以随每个 Windows 版本而改变。

如果您需要简称，请索取：[http ://www.c-sharpcorner.com/UploadFile/crajesh1981/RajeshPage103142006044841AM/RajeshPage1.aspx](http://www.c-sharpcorner.com/UploadFile/crajesh1981/RajeshPage103142006044841AM/RajeshPage1.aspx)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-11T20:08:33.413

将批处理文件放在没有空格的位置。

在批处理文件中，运行带有空格的程序命令。

# csv - 在 Hyperion v8.3 中更新导入的 .csv

> ID：360402
> 
> 赞同：0
> 
> 时间：2008-12-11T18:38:16.497
> 
> 标签：csv, import, hyperion, brio

我有一个 csv 导入到我的 Hyperion v8.3 bqy 文件中。我已经创建了一些自定义列和一个数据透视表。我只想刷新数据。过去，我会点击 Process Current，它会将我定向到我的计算机，然后我可以选择要更新的 csv 文件。现在它不会那样做。它根本不去我的电脑。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-29T15:49:41.223

埃里克，

我不是高级用户，但我通过确保在导入原始 csv 和“处理所有”的相同位置有一个同名文件来完成同样的事情。这允许我更新数据并将其导入我的 bqy 并自动更新基于 csv 的任何报告。

不知道这是否有帮助。

丹尼斯 dennis.van.camp@vanderlande.com

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-17T02:51:33.020

当您将文件作为部分导入 Hyperion 时，它会维护一个指向现有文件的链接，以获取确切的路径和文件名。当该链接断开并且该部分获得处理或刷新命令时，它只会提示您输入新文件。否则，它将刷新现有数据。

因此，如果您想强制它提示您输入新文件，则必须移动或重命名旧文件。

但是，您正在寻找要刷新的 Pivot 和 Computed 列。有两件事...

> **计算列：**如果其余数据是最新的，则不必重新导入文件。可以通过右键单击、修改，然后单击确定来单独刷新每一列。您不必更改任何代码；只需点击 OK 而不是 Cancel。
> 
> **Pivot：**在菜单中，您必须适当地设置您的数据透视选项，以便在您处理（实际上是处理基础数据时）或手动（当您处理该部分时）进行更新。

# .net - 读/写/修改 XML

> ID：360409
> 
> 赞同：4
> 
> 时间：2008-12-11T18:40:26.087
> 
> 标签：.net, asp.net, xml

我有一个这样的 XML 文件

```
<?xml version="1.0" encoding="utf-8" ?>

    <Configurations>

            <EmailConfiguration>
                <userName>xxxx</userName>
                <password>xxx</password>
                <displayName>xxxxx</displayName>
                <hostAddress>xxxx</hostAddress>
                <sslEnable>xxx</sslEnable>
                <port>xxx</port>
            </EmailConfiguration>

            <LogConfiguration>
                <logEnable>true</logEnable>
                <generalEnable>true</generalEnable>
                <warningEnable>true</warningEnable>
                <errorEnable>true</errorEnable>
            </LogConfiguration>

        </Configurations> 
```

我将它用作我的代码的配置文件，我想像这样检索它们的值（innerText）

```
bool logEnable = value comes from XML (logEnable)
bool warningEnable = value comes from XML (warningEnable)
bool errorEnable = value comes from XML (errorEnable)
bool generalEnable = value comes from XML (generalEnable) 
```

那么如何读取它们的值以将它们分配给布尔变量，如果我想用 false 更改它们的值之一，我将如何做到这一点？

谢谢...

问候...

Ps：如果您写了更多解释性代码，将不胜感激。

再次感谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T19:11:22.203

```
public class Options
{
    public string UserName { get; set; }
    public string Password { get; set; }
    public string DisplayName { get; set; }
    public string HostAddress { get; set; }
    public bool SSL { get; set; }
    public string Port { get; set; }

    public bool LogEnable { get; set; }
    public bool GeneralEnable { get; set; }
    public bool WarningEnable { get; set; }
    public bool ErrorEnable { get; set; }

    public static Options Load(string path)
    {
        Options options = new Options();
        XmlDocument xml = new XmlDocument();
        xml.Load(path);

        XmlNodeReader input = new XmlNodeReader(xml);

        while (input.Read())
        {
            var elementname = input.Name.ToLower();

            switch (elementname)
            {
                case "username":
                    options.UserName = input.Value;
                    break;
                // all other cases
                case "logenable":
                    options.LogEnable = Boolean.Parse(input.Value);
                    break;
                // continue with other cases
            }
        }
    }

    public static void Save(Options options, string path)
    {
        XmlTextWriter writer = new XmlTextWriter(path);

        xmlWriter.WriteStartDocument(true);
        xmlWriter.WriteStartElement("configuration");
        xmlWriter.WriteStartElement("emailConfiguration");

        xmlWriter.WriteStartElement("userName");
        xmlWriter.WriteString(options.UserName);
        xmlWriter.WriteEndElemement();

        // continue for all elements

        xmlWriter.WriteEndElement();
        xmlWriter.WriteStartElement("logConfiguration");

        xmlWriter.WriteStartElement("logEnable");
        xmlWriter.WriteString(options.LogEnable.ToString());
        xmlWriter.WriteEndElemement();

        // continue for all elements

        xmlWriter.WriteEndElement();
        xmlWriter.WriteEndElement();

        xmlWriter.Close();
    }
} 
```

我留下了一些工作让你完成；）另外，我没有写这是 Visual Studio，我也没有事先编译它。此代码按原样提供，不提供任何保证或担保。;)

这是 .NET 中的基本 XML 读/写过程，尽管有很多选项。您可以使用 XPath 查询，或者如果您使用的是 .NET 3.5，您可以使用 Linq to Sql，这会让您在街头获得酷孩子的信任。但是上面的示例应该可以让您快速启动并运行，只要保证您也会对这些其他事情进行一些研究，您会因此变得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T19:14:39.077

最佳做法是实际使用 web.config 或 app.config 文件。它也使这个过程变得更加容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T20:18:17.873

我找到了类似的东西，这实际上满足了我的需求:) **但我想知道这是从 XML 检索数据的有效方法？** 这是代码：

```
XmlDocument doc = new XmlDocument();

            doc.Load(HttpContext.Current.Server.MapPath("config.xml"));

            logEnable = Convert.ToBoolean(doc["Configurations"]["LogConfiguration"]["logEnable"].InnerText);
            warningEnable = Convert.ToBoolean(doc["Configurations"]["LogConfiguration"]["warningEnable"].InnerText);
            errorEnable = Convert.ToBoolean(doc["Configurations"]["LogConfiguration"]["errorEnable"].InnerText);
            generalEnable = Convert.ToBoolean(doc["Configurations"]["LogConfiguration"]["generalEnable"].InnerText); 
```

# css - 定义类组合的样式

> ID：360421
> 
> 赞同：2
> 
> 时间：2008-12-11T18:43:48.233
> 
> 标签：css

有没有办法为类组合定义样式？例如，我希望我的 HTML 看起来像这样，但输出以适当的颜色呈现：

```
<span class="red">Red Text</span><br/>
<span class="green">Green Text</span><br/>
<span class="red green">Yellow Text</span><br/> 
```

**编辑：**以上只是一个例子，似乎让人困惑；所以这是另一个例子：

```
<style>
    .style1 { background-color: #fff; }
    .style2 { background-color: #eee; }
    .style1.highlight { color: red; }
    .style2.highlight { color: blue; }
</style>

<ul>
    <li class="action style1">Do Action 1</li>
    <li class="action style2">Do Action 2</li>
    <li class="action style1 highlight">Do Action 1</li>
    <li class="action style2 highlight">Do Action 2</li>
</ul>

<script language="javascript" type="text/javascript">
$("li.action").bind("click", function(e) {
    e.preventDefault();

    // Do some stuff 

    $(this).addClass("highlight");
    $(this).unbind("click");
});
</script> 
```

同样，这只是一个*例子*，所以不要纠结于交替元素或类似的东西。我要避免的是必须为每个不同的 styleN 复制绑定函数，或者必须编写一个 elseif 结构来检查每个 styleN 类。不幸的是，此代码在 IE 6 或 7 中不起作用 - .style1 和 .style2 元素的突出显示文本最终都是蓝色的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-11T18:52:16.343

您可以选择多个类：

```
span.red.green { color: yellow; } 
```

这将适用于任何具有红色和绿色类的 span 元素。这可能不是您想要的，因为它也适用于：

```
<span class="red green blue">white</span> 
```

请注意，这在 IE 6 中不起作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T18:53:19.087

当然。

```
.red { color: red; }
.green { color: green; }
.red.green { color: yellow; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T18:54:28.570

您可以使用 Javascript 执行此操作，尽管我最好创建一个黄色类，如果您对 javascript 方法感兴趣，请发表评论（我需要考虑一下，在您的逻辑层）

**编辑**| **更多编辑（为当前颜色添加正则表达式）**
好吧，你不感兴趣，但我还是会写它，因为它看起来很有趣：

```
var re = /([0-9]?)/g;
$("span").each(函数(){
 $这个 = $(这个);
 结果 = re.exec($this.css('background-color')); // 背景类似于：'rgb(0, 132, 12)'
 var sRed = 结果[1];
 var sGreen = 结果[2]；
 var sBlue = 结果[3]；
 /* 老的！
 var sRed = '0';
 var sGreen = '0';
 var sBlue = '0';*/
 if($this.hasClass('red')) { sRed = '255'; }
 if($this.hasClass('green')) { sGreen = '255'; }
 if($this.hasClass('blue')) { sBlue = '255'; }
 $this.css('背景色', 'rgb(' + sRed + ',' + sGreen + ',' + sBlue ')';
});

```

您将需要 jQuery，尽管您可能不使用 jQuery。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T19:49:52.360

你为什么要这样做？这可能是可能的，但我没有看到好处。您是否还要定义 class="short fat" 和 class="tall thin" 或者 class="light dark" 呢？为了清晰和重用，类应该简单而具体。当多重继承（假的或其他的）是不必要的并且可能令人困惑时，应该避免它。

```
class="red green" 
```

令人困惑

```
class="yellow" 
```

简洁明了

编辑：我看到了第二个例子，我的建议保持不变。一类简洁明了，二类可能令人困惑。假设这应该有效（我认为确实有效），那么在最流行的浏览器 (IE) 中花费大量精力来解决错误可能是不值得的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T03:39:33.003

这是我的解决方法：

```
<style>
    .style1 { background-color: #fff; }
    .style2 { background-color: #eee; }
    .style1 .highlight { color: red; }
    .style2 .highlight { color: blue; }
</style>

<ul>
    <li class="action style1"><span>Do Action 1</span></li>
    <li class="action style2"><span>Do Action 2</span></li>
    <li class="action style1"><span class="highlight">Do Action 1</span></li>
    <li class="action style2"><span class="highlight">Do Action 2</span></li>
</ul>

<script language="javascript" type="text/javascript">
$("li.action").bind("click", function(e) {
    e.preventDefault();

    // Do some stuff 

    $(this).children("span").addClass("highlight");
    $(this).unbind("click");
});
</script> 
```

它不像我希望的那样优雅。它为每个项目使用一个额外的元素；但至少它仍然相当干净。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-11T18:52:52.693

也许是这样的

```
.red
{
color: red;
}

.red_green
{
color: #AS8324;
} 
```

你可以使用你的html代码

```
<span class="red">Red Text</span><br/>
<span class="green">Green Text</span><br/>
<span class="red_green">Yellow Text</span><br/> 
```

我不知道这正是你想要的，但这是我的方法。我希望它有所帮助。

# c# - 为什么 GetProperty 找不到它？

> ID：360422
> 
> 赞同：14
> 
> 时间：2008-12-11T18:43:56.003
> 
> 标签：c#, reflection, properties

我正在尝试使用反射从类中获取属性。这是我所看到的一些示例代码：

```
 using System.Reflection;
namespace ConsoleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            PropertyInfo[] tmp2 = typeof(TestClass).GetProperties();
            PropertyInfo test = typeof(TestClass).GetProperty(
               "TestProp", BindingFlags.Public | BindingFlags.NonPublic);
        }
    }

    public class TestClass
    {
        public Int32 TestProp
        {
            get;
            set;
        }
    }
} 
```

当我追踪它时，这就是我所看到的：

*   当我使用 获取所有属性`GetProperties()`时，生成的数组有一个条目，用于 property `TestProp`。
*   当我尝试使用 获取时`TestProp`，`GetProperty()`我得到了 null 回来。

我有点难过；我无法在 MSDN 中找到任何有关`GetProperty()`向我解释此结果的内容。有什么帮助吗？

编辑：

如果我添加`BindingFlags.Instance`到`GetProperties()`通话中，则找不到任何属性，句号。这更加一致，并且让我相信`TestProp`由于某种原因它不被视为实例属性。

为什么会这样？我需要对该类做什么才能将此属性视为实例属性？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-11T18:46:36.293

添加`BindingFlags.Instance`到`GetProperty`通话中。

编辑：回应评论......

以下代码返回该属性。

注意：在您尝试检索它之前实际让您的属性做一些事情是个好主意（VS2005）:)

```
using System.Reflection;
namespace ConsoleApplication
{
    class Program
    {
        static void Main(string[] args)
        {
            PropertyInfo[] tmp2 = typeof(TestClass).GetProperties();
            PropertyInfo test = typeof(TestClass).GetProperty(
                "TestProp",
                BindingFlags.Instance | BindingFlags.Public |
                    BindingFlags.NonPublic);

            Console.WriteLine(test.Name);
        }
    }

    public class TestClass
    {
        public Int32 TestProp
        {
            get
            {
                return 0;
            }
            set
            {
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T18:48:56.773

尝试添加以下标签：

```
System.Reflection.BindingFlags.Instance 
```

**编辑：**这有效（至少对我来说）

```
PropertyInfo test = typeof(TestClass).GetProperty("TestProp", BindingFlags.Public | BindingFlags.Instance);

Console.WriteLine(test.Name); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T18:46:41.490

您还需要指定它是静态的还是实例（或两者）。

# jquery - 我可以使用 jQuery 打开下拉列表吗

> ID：360431
> 
> 赞同：87
> 
> 时间：2008-12-11T18:46:56.747
> 
> 标签：jquery, html, drop-down-menu

对于 HTML 中的此下拉列表：

```
<select id="countries">
<option value="1">Country</option>
</select> 
```

我想打开列表（与左键单击相同）。这可能使用 JavaScript（或更具体地说是 jQuery）吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2010-12-21T10:36:06.200

我试图找到同样的东西并感到失望。我最终更改了选择框的属性大小，因此它似乎打开了

```
$('#countries').attr('size',6); 
```

然后当你完成

```
$('#countries').attr('size',1); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-11T18:59:22.617

您可以轻松[模拟对元素](http://docs.jquery.com/Events/click)的单击，但单击 a`<select>`不会打开下拉菜单。

使用多个选择可能会出现问题。也许您应该考虑容器元素内的单选按钮，您可以根据需要扩展和收缩。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-11-09T19:22:12.390

我遇到了同样的问题，我有一个解决方案。一个名为 ExpandSelect() 的函数模拟鼠标单击“选择”元素，它通过创建另一个绝对定位的元素来实现，并通过设置属性`<select>`一次显示多个选项。`size`在所有主流浏览器中测试：Chrome、Opera、Firefox、Internet Explorer。解释它是如何工作的，以及这里的代码：

**编辑（链接已损坏）**。

我在 Google Code 上创建了一个项目，去那里找代码：

[http://code.google.com/p/expandselect/](http://code.google.com/p/expandselect/)

# 截图

模拟点击的时候，GUI有一点区别，不过没关系，自己看吧：

**鼠标点击时：**

[![鼠标点击](https://i.stack.imgur.com/kVf6s.jpg)](https://i.stack.imgur.com/kVf6s.jpg)
[（来源：[googlecode.com](http://expandselect.googlecode.com/hg/mouseclick_manyoptions.jpg)）]

**模拟点击时：**

[![模拟点击](https://i.stack.imgur.com/um21N.jpg)](https://i.stack.imgur.com/um21N.jpg)
[（来源：[googlecode.com](http://expandselect.googlecode.com/hg/emulateclick_manyoptions.jpg)）]

项目网站上的更多屏幕截图，上面的链接。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-10-10T10:57:16.787

这应该涵盖它：

```
 var event;
 event = document.createEvent('MouseEvents');
 event.initMouseEvent('mousedown', true, true, window);
 countries.dispatchEvent(event); //we use countries as it's referred to by ID - but this could be any JS element var 
```

例如，这可以绑定到按键事件，因此当元素具有焦点时，用户可以键入并且它会自动展开......

- 语境 -

```
 modal.find("select").not("[readonly]").on("keypress", function(e) {

     if (e.keyCode == 13) {
         e.preventDefault();
         return false;
     }
     var event;
     event = document.createEvent('MouseEvents');
     event.initMouseEvent('mousedown', true, true, window);
     this.dispatchEvent(event);
 }); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-06-01T04:53:21.393

这是从上面的答案中整理出来的，并使用选项的长度/数量来符合实际有多少选项。

希望这可以帮助某人获得他们需要的结果！

```
 function openDropdown(elementId) {
        function down() {
            var pos = $(this).offset(); // remember position
            var len = $(this).find("option").length;
                if(len > 20) {
                    len = 20;
                }

            $(this).css("position", "absolute");
            $(this).css("zIndex", 9999);
            $(this).offset(pos);   // reset position
            $(this).attr("size", len); // open dropdown
            $(this).unbind("focus", down);
            $(this).focus();
        }
        function up() {
            $(this).css("position", "static");
            $(this).attr("size", "1");  // close dropdown
            $(this).unbind("change", up);
            $(this).focus();
        }
        $("#" + elementId).focus(down).blur(up).focus();
    } 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-01-19T20:33:43.813

简单简单的方法。

```
function down(what) {
  pos = $(what).offset();  // remember position
  $(what).css("position","absolute");
  $(what).offset(pos);   // reset position
  $(what).attr("size","10"); // open dropdown
}

function up(what) {
$(what).css("position","static");
$(what).attr("size","1");  // close dropdown
} 
```

现在你可以像这样调用你的 DropDown

```
<select onfocus="down(this)" onblur="up(this)"> 
```

非常适合我。

也许更好，因为您对页面上其他元素的位置没有任何问题。

```
function down(was) {
a = $(was).clone().attr('id','down_man').attr('disabled',true).insertAfter(was);
$(was).css("position","absolute").attr("size","10");
}

function up(was) {
$('#down_man').remove();
$(was).css("position","static");
$(was).attr("size","1");
} 
```

将 ID 更改为固定值 mybe 不聪明，但我希望你能看到 idee。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-11T18:51:46.360

javascript不可能“点击”一个元素（你可以触发附加的`onclick`事件，但你不能从字面上点击它）

要查看列表中的所有项目，请将列表设为`multiple`列表并增加其大小，如下所示：

```
<select id="countries" multiple="multiple" size="10">
<option value="1">Country</option>
</select> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-11T19:20:03.433

不，你不能。

您可以更改大小以使其更大...类似于 Dreas 的想法，但它是您需要更改的大小。

```
<select id="countries" size="6">
  <option value="1">Country 1</option>
  <option value="2">Country 2</option>
  <option value="3">Country 3</option>
  <option value="4">Country 4</option>
  <option value="5">Country 5</option>
  <option value="6">Country 6</option>
</select> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-04-19T19:06:25.937

我尝试使用 mrperfect 的答案，但出现了一些故障。通过一些小的更改，我能够让它为我工作。我只是更改了它，以便它只会执行一次。退出下拉菜单后，它会回到常规的下拉菜单方法。

```
function down() {
    var pos = $(this).offset(); // remember position
    $(this).css("position", "absolute");
    $(this).offset(pos);   // reset position
    $(this).attr("size", "15"); // open dropdown
    $(this).unbind("focus", down);
}
function up() {
    $(this).css("position", "static");
    $(this).attr("size", "1");  // close dropdown
    $(this).unbind("change", up);
}
function openDropdown(elementId) {
    $('#' + elementId).focus(down).blur(up).focus();
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-05-02T18:30:23.517

这没有回答的一件事是，当您在完成 size = n 并使其成为绝对定位后单击选择列表中的选项之一时会发生什么。

因为 blur 事件使其 size = 1 并将其更改回它的外观，所以您也应该有这样的东西

```
$("option").click(function(){
    $(this).parent().blur();
}); 
```

此外，如果您对显示在其他元素后面的绝对定位选择列表有问题，只需放一个

```
z-index: 100; 
```

或类似选择风格的东西。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-05-25T12:41:22.923

超级简单：

```
var state = false;
$("a").click(function () {
    state = !state;
    $("select").prop("size", state ? $("option").length : 1);
}); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-11T19:15:04.520

如前所述，您不能`<select>`使用 JavaScript 以编程方式打开一个。

但是，您可以自己编写*`<select>`*管理整个外观和感觉的自己。类似于您在[Google](http://www.google.com/)或[Yahoo!上看到的自动填充搜索字词！](http://www.yahoo.com/)[或The Weather Network](http://www.theweathernetwork.com/)的 Search for Location 框。

[我在这里](http://sharebrain.info/brainpicks/scripting/jquerycombobox-dropdown-list/3873/)找到了一个用于 jQuery的。我不知道它是否会满足您的需求，但即使它不能完全满足您的需求，也应该可以对其进行修改，以便在其他操作或事件时打开它。[这个](http://jonathan.tang.name/code/jquery_combobox)实际上看起来更有希望。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-12-13T09:06:03.973

我刚刚添加

```
select = $('#' + id);
length = $('#' + id + ' > option').length;
if (length > 20)
    length = 20;
select.attr('size', length);
select.css('position', 'absolute');
select.focus(); 
```

并添加到选择中

```
onchange="$(this).removeAttr('size');"
onblur="$(this).removeAttr('size');" 
```

使外观与经典外观相同（与 html 的其余部分重叠）

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-08-20T09:02:46.967

也许晚了，但这就是我解决它的方法：http: [//jsfiddle.net/KqsK2/18/](http://jsfiddle.net/KqsK2/18/)

```
$(document).ready(function() {
  fixSelect(document.getElementsByTagName("select"));
                      });                       

   function fixSelect(selectList)
            {
            for (var i = 0; i != selectList.length; i++)
              {

                 setActions(selectList[i]);
              }
            }

   function setActions(select)
            {
               $(select).click(function() {
                   if (select.getElementsByTagName("option").length == 1)
                        {
                          active(select);
                        }
                      });
                $(select).focus(function() {
                       active(select);
                       });
                $(select).blur(function() {
                       inaktiv(select);
                       });
                $(select).keypress(function(e) {
                      if (e.which == 13) {

                      inaktiv(select);
                          }
                       });
                  var optionList = select.getElementsByTagName("option");

                  for (var i = 0; i != optionList.length; i++)
                           {
                                setActionOnOption(optionList[i], select);
                           }
      }

  function setActionOnOption(option, select)
      {
                    $(option).click(function() {
                                inaktiv(select);
                        });
      }

  function active(select)
      {
          var temp = $('<select/>');
              $('<option />', {value: 1,text:$(select).find(':selected').text()}).appendTo(temp);
               $(temp).insertBefore($(select));

              $(select).attr('size', select.getElementsByTagName('option').length);
              $(select).css('position', 'absolute');
              $(select).css('margin-top', '-6px');
              $(select).css({boxShadow: '2px 3px 4px #888888'});

                        }

        function inaktiv(select)
                   {
                 if($(select).parent().children('select').length!=1)
                     {
                                             select.parentNode.removeChild($(select).parent().children('select').get(0));
                                }
                $(select).attr('size', 1);
                $(select).css('position', 'static');
                $(select).css({boxShadow: ''});
                $(select).css('margin-top', '0px');

                  } 
```

# c++ - c++ 3d 数组

> ID：360449
> 
> 赞同：0
> 
> 时间：2008-12-11T18:52:14.660
> 
> 标签：c++, arrays, 3d

我正在尝试运行一个 3d 数组，但是当我运行它时，代码只是在 Windows 中崩溃，这是我的代码；

```
#include <iostream>

using namespace std;

int main(){

    int myArray[10][10][10];

    for (int i = 0; i <= 9; ++i){
        for (int t = 0; t <=9; ++t){            
            for (int x = 0; x <= 9; ++t){

                myArray[i][t][x] = i+t+x; 

            }

        }

     }

    for (int i = 0; i <= 9; ++i){
        for (int t = 0; t <=9; ++t){
            for (int x = 0; x <= 9; ++t){

                cout << myArray[i][t][x] << endl;

            }

        }

    }

    system("pause");

} 
```

有人可以给我一个快速修复/解释吗

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-11T18:55:50.347

你有两次线

```
for (int x = 0; x <= 9; ++t){ 
```

当你的意思是

```
for (int x = 0; x <= 9; ++x){ 
```

经典的复制粘贴错误。

顺便说一句，如果你在调试器中运行它并查看变量的值，很容易看出发生了什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T19:36:10.797

大卫的回答是正确的。

顺便说一句，约定是使用 i、j 和 k 作为嵌套迭代器索引，并且还使用 < array_length 而不是 <= array_length -1 作为终止符。

如果你这样做，那么你可以使数组大小成为一个常数并摆脱一些幻数。

此外，在您使用数组索引时的断言可能会指出错误。

结果可能如下所示：

```
const std::size_t ARRAY_SIZE = 10;

int myArray[ARRAY_SIZE][ARRAY_SIZE][ARRAY_SIZE];

for (std::size_t i = 0; i < ARRAY_SIZE; ++i) 
{
    for (std::size_t j = 0; j < ARRAY_SIZE; ++j)
    {
        for (std::size_t k = 0; k < ARRAY_SIZE; ++k)
        {
            std::assert (i < ARRAY_SIZE && j < ARRAY_SIZE && k < ARRAY_SIZE);
            // Do stuff
        }
    }
} 
```

# iphone - iPhone 上的 HTTPS

> ID：360452
> 
> 赞同：1
> 
> 时间：2008-12-11T18:53:06.343
> 
> 标签：iphone, cocoa-touch, ssl, https

我需要能够使用 https 连接到服务器，我想知道是否有*推荐*的方法在 iPhone 上执行此操作不是： - 未记录的 api 调用 - 不需要在应用程序包中手动存储证书

谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T20:00:56.877

NSURLRequest 和 NSURLConnection 是你要找的。从这些文档开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T10:34:27.227

使用 https 有什么问题？URL 加载系统（即 NSURLConnection）和 WebKit 都支持它开箱即用。我知道的唯一问题是使用不受信任的证书，而我知道的唯一解决方案是（不幸的是）使用私有 API 调用。但是你不应该发布一个依赖于与使用不受信任证书的服务器通信的应用程序。

# pseudocode - 您在现实世界中使用伪代码的频率如何？

> ID：360454
> 
> 赞同：9
> 
> 时间：2008-12-11T18:53:19.430
> 
> 标签：pseudocode

回到大学，在我的课程中，只有伪代码的使用比 OOP 得到了更多的宣传。就像评论（和其他宣扬的“最佳实践”）一样，我发现在关键时刻伪代码经常被忽视。所以我的问题是......谁实际上经常使用它？还是仅在您很难完全在脑海中概念化算法时才使用它？我对每个人的回应都很感兴趣：耳后湿透的初级开发人员到打孔卡时代就在身边的头发花白的老兵。

就我个人而言，我主要只将它用于困难的事情。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-11T18:59:57.500

我用它所有的时间。每当我必须解释设计决策时，我都会使用它。与非技术人员交谈，我会使用它。它不仅适用于编程，还适用于解释任何事情是如何完成的。

与在多个平台上的团队合作（在这种情况下，Java 前端和 COBOL 后端）使用伪代码解释一段代码的工作原理比显示真实代码要容易得多。

在设计阶段，伪代码特别有用，因为它可以帮助您了解解决方案以及它是否可行。我见过一些看起来非常优雅的设计，只是为了尝试实现它们并意识到我什至无法生成伪代码。事实证明，设计师从未尝试过思考理论上的实现。如果他试图编写一些伪代码来代表他的解决方案，我就不必浪费 2 周的时间来弄清楚为什么我不能让它工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T18:58:47.610

我在远离计算机并且只有纸和笔时使用伪代码。担心无法编译的代码（无法编译论文）的语法没有多大意义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-11T19:02:51.737

我现在几乎总是在创建任何重要的例程时使用它。我将伪代码创建为注释，并继续扩展它，直到我可以在它下面编写等效代码为止。我发现这显着加快了开发速度，减少了“只写代码”综合症，这种综合症通常需要重写最初没有考虑过的事情，因为它迫使您在编写实际代码之前仔细考虑整个过程，并作为良好的基础编写后的代码文档。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-11T19:18:14.467

我和我团队中的其他开发人员一直在使用它。在电子邮件、白板或只是在会议中。伪代码可以帮助您以您需要的方式思考，以便能够编程。如果您真的不了解伪代码，您几乎可以掌握任何编程语言，因为它们之间的主要区别在于语法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T19:05:26.117

如果我正在解决一些复杂的问题，我会经常使用它，但我会将它用作注释。例如，我将删除程序，并放入我认为需要执行的每个步骤。当我写代码时，我会留下评论：它说明了我想要做什么。

```
procedure GetTextFromValidIndex (input int indexValue, output string textValue)
// initialize
// check to see if indexValue is within the acceptable range
//    get min, max from db
//    if indexValuenot between min and max
//       then return with an error
// find corresponding text in db based on indexValue
// return textValue
   return "Not Written";
end procedure; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-11T19:11:11.347

在编写程序之前，我从来没有，甚至一次都不需要编写程序的伪代码。

但是，有时我不得不在编写代码*之后*编写伪代码，这通常发生在我试图描述程序的高级实现以使某人在短时间内掌握新代码的速度时。“高级实现”是指一行伪代码描述了大约 50 行 C#，例如：

```
Core 将一堆 XML 文件转储到一个文件夹并运行 process.exe
  带有一些命令行参数的可执行文件。

process.exe 读取每个文件
    每个文件逐行读取
    从存储在数据库中的文件中提取唯一词
    文件在完成处理后被删除

```

这种伪代码足以描述大约 1000 行代码，并且足以准确地告知新手程序实际在做什么。

在很多情况下，当我不知道如何解决问题时，我实际上发现自己在白板上以非常高级的术语绘制我的模块，以清楚地了解它们如何交互，绘制数据库模式的原型，绘制一个数据结构（尤其是树、图、数组等），以便很好地处理如何遍历和处理它等。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-11T19:22:24.210

我在解释概念时使用它。它有助于删除不必要的语言部分，以便示例仅包含与所问问题相关的细节。

我在 StackOverflow 上大量使用它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-11T19:52:31.043

我不使用学校教的伪代码，并且很长时间没有使用。

当逻辑足够复杂时，我会使用算法的英文描述；它们被称为“评论”。;-)

在向他人解释事情或在纸上解决问题时，我尽可能使用图表 - 越简单越好

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-08-31T02:33:59.543

Steve McConnel 的[Code Complete](https://rads.stackoverflow.com/amzn/click/com/0735619670)在其第 9 章“伪代码编程过程”中提出了一个有趣的方法：当编写一个超过几行的函数时，使用简单的伪代码（以注释的形式）来概述函数/过程需要什么在编写执行它的实际代码之前做。然后伪代码注释可以成为函数体中的实际注释。

我倾向于将它用于任何功能，这些功能超出了通过查看一屏（最大）代码可以快速理解的功能。如果您已经习惯于在代码“段落”中分隔函数体，它会特别有效 - 由空行分隔的语义相关代码单元。然后“伪代码注释”就像这些段落的“标题”一样工作。

PS：有些人可能会争辩说*“你不应该评论什么，而是为什么，只有当一个比你更了解所讨论语言的读者理解并不是一件容易的事时”*。我大体上同意这一点，但我确实为 PPP 开了一个例外。评论的存在和形式的标准不应该是一成不变的，但最终还是要以[明智、深思熟虑的常识应用](https://rads.stackoverflow.com/amzn/click/com/0321344758)为准。如果你发现自己拒绝仅仅为了某个主观的“规则”而尝试稍微弯曲，你可能需要退后一步，意识到你是否没有足够批判地面对它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-11T19:00:53.893

主要用于编写非常复杂的代码，或者向其他开发人员或了解系统的非开发人员解释代码时。

在尝试执行上述操作时，我还会使用流程图或 uml 类型图...

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-11T19:02:29.287

我通常在开发多个嵌套的 if else 语句时使用它，这可能会造成混淆。

这样我就不需要回去记录它，因为它已经完成了。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-11T19:02:38.960

很少见，尽管我经常在编写方法主体之前记录一个方法。

但是，如果我正在帮助其他开发人员解决问题，我会经常写一封带有伪代码解决方案的电子邮件。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-11T19:03:37.023

我根本不使用伪代码。我对 C 风格语言的语法比对伪代码更舒服。

出于设计目的，我经常做的事情本质上是一种功能分解的编码风格。

```
public void doBigJob( params )
{
    doTask1( params);
    doTask2( params);
    doTask3( params);
}
private void doTask1( params)
{
    doSubTask1_1(params);
    ...
} 
```

在理想世界中，随着方法变得越来越琐碎，最终会变成工作代码。然而，在现实生活中，有大量的重构和重新思考设计。

我们发现这很有效，因为我们很少遇到同时具备以下两种算法的算法：极其复杂且难以编码，并且使用 UML 或其他建模技术无法更好地解决。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-11T19:14:23.413

我从未使用或使用过它。

当我需要做一些复杂的事情时，我总是尝试用真实的语言进行原型设计，通常首先编写单元测试来弄清楚代码需要做什么。

# php - 在版本控制中跨环境维护运行时设置？

> ID：360461
> 
> 赞同：0
> 
> 时间：2008-12-11T18:55:08.507
> 
> 标签：php, magento, version-control, e-commerce

我们正在调查 Magento 电子商务平台并完善我们的部署和版本控制策略。

目前，当涉及在管理界面中调整的设置（例如添加产品、系统配置值、启用运输/付款）时，我们正在寻找使多个环境（例如 QA/开发环境/生产）保持同步的最佳方法模块/ Magento 连接模块安装）

我们计划在颠覆中维护我们或自己的自定义模块和设计。

我们正在寻找使我们的多个环境保持同步的建议和/或最佳实践。这将支持需要最少点击配置值和人工干预的可重复/可编写脚本的部署策略。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-30T08:46:12.213

由于 Magento 环境设置保存在数据库中，我建议使用相同的加密密钥 (app/etc/local.xml) 进行安装。稍后，您将定义方便的时间间隔（每天、每周）从一个数据库转储到另一个数据库。要自动执行此操作，您可以使用 Magento cron 作业。

# c# - 在 T4 中获取 .tt 文件的位置

> ID：360462
> 
> 赞同：8
> 
> 时间：2008-12-11T18:55:24.280
> 
> 标签：c#, .net, t4

使用 T4，我想根据检查相对于正在执行的模板文件的目录中的文件来生成一些代码。

c#中有没有办法识别当前模板文件的路径是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-29T15:15:57.250

*   您需要将指令的`hostspecific="true"`属性设置为.`<#@ template``True`
*   这将使 T4 生成一个名为 的特殊属性`Host`，它使您可以访问`ResolvePath`方法和`TemplateFile`属性。
    *   `Host`是类型[`ITextTemplatingEngineHost`](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.texttemplating.itexttemplatingenginehost?view=visualstudiosdk-2019)。
    *   [`TemplateFile`是一个`String`](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.texttemplating.itexttemplatingenginehost.templatefile?view=visualstudiosdk-2019#Microsoft_VisualStudio_TextTemplating_ITextTemplatingEngineHost_TemplateFile)通常是文件的文件系统路径的[值](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.texttemplating.itexttemplatingenginehost.templatefile?view=visualstudiosdk-2019#Microsoft_VisualStudio_TextTemplating_ITextTemplatingEngineHost_TemplateFile)`.tt`- 但是其他 T4 主机（即除 Visual Studio 之外的主机）可能会在内存中加载 T4 文件，或者可能返回一些其他值，因为模板文件没有存在于磁盘上。
*   您可以在此处找到详细信息：[http ://www.olegsych.com/2008/02/t4-template-directive/](https://web.archive.org/web/20160315051742/http://olegsych.com/2008/02/t4-template-directive/)

例如：

```
<#@ template hostspecific="true" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="Microsoft.VisualStudio.TextTemplating" #>
<#
    ITextTemplatingEngineHost t4Host = this.Host;
    FileInfo t4FileInfo = new FileInfo( t4Host.TemplateFile );
#>

// This file generated by <#= t4FileInfo.FullName #> 
```

# c# - 不为访问者触发事件的用户控件

> ID：360466
> 
> 赞同：1
> 
> 时间：2008-12-11T18:57:01.513
> 
> 标签：c#, asp.net, user-controls

此 UpdatePanel 包含在 UserControl 中。当 LinkBut​​ton 被按下时，箭头应该被添加到另一个 GridView 中。当用户登录时，此控件运行良好。当用户未登录并尝试按下该按钮时会出现问题。没有事件触发器。有人建议我在 web.config 中授予访问此控件的权限。那没有用。有人有其他想法吗？

```
<asp:UpdatePanel runat="server" UpdateMode="Conditional" EnableViewState="true" ID="IngredientsUpdatePanel">
<ContentTemplate>
    <asp:ObjectDataSource ID="sourceIngredients" runat="server" SelectMethod="GetAll">
    </asp:ObjectDataSource>
    <asp:GridView ID="Ingredients" AllowPaging="true" runat="server" DataKeyNames="IngredientId"
        EnableViewState="true" DataSourceID="sourceIngredients" PageSize="5"
        AutoGenerateColumns="false" HorizontalAlign="Center" OnSelectedIndexChanged="Ingredients_SelectedIndexChanged">
         <RowStyle HorizontalAlign="Center"  />  
         <HeaderStyle Font-Bold="true" ForeColor="Black" /> 
         <Columns>                        
                <asp:TemplateField HeaderText="Ingrediente" ItemStyle-Font-Size="10">                
                    <ItemTemplate>
                        <asp:Label ID="lblId" Text='<%# Bind("IngredientId") %>' Visible="false" runat="server"/>
                        <asp:Label ID="lblPrice" Text='<%# Bind("Price") %>' Visible="false" runat="server"/>
                        <asp:Label ID="lblDescr" Text='<%# Bind("Description") %>' Visible="false" runat="server"/>
                        <asp:Label ID="lblName" Text='<%# Bind("Name") %>' Visible="false" runat="server"/>
                        <asp:Label ID="lblPict" Text='<%# Bind("Picture") %>' Visible="false" runat="server"/>
                        <div style="text-align:left;">                        
                            <img id="img" style="float:right;" src='<%# Eval("Picture") %>'
                                height="75" runat="server" alt="Picture" />                                                    
                            <b>
                                <%# Eval("Name") %>
                            </b>
                            <br />
                            <br />
                            Price: <b><%# Eval("Price") %></b>
                            <br />
                            <br />
                            <br />
                        </div>                    
                        <hr />
                        <div style="text-align:left;">
                        <b>Description</b>
                        </div>
                        <div style="width:300px;">
                            <%# Eval("Description") %> 
                        </div>
                        <br />
                        <asp:LinkButton Enabled="true" runat="server" Text="Add" CommandName="Select" ID="cmdAdd" />                           
                       </ItemTemplate>            
                </asp:TemplateField>
             </Columns>
    </asp:GridView>
</ContentTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T08:44:24.610

我以一种棘手的方式解决了这个问题。我删除了 LinkBut​​ton，在 TemplateField 之前我放了一个 ButtonField，一切正常。现在代码看起来像：

```
 <Columns>
  <asp:ButtonField Text="Add" CommandName="Select" />                 
      <asp:TemplateField>
            ......
      </asp:TemplateField>
 </Columns> 
```

我仍然不明白为什么控件有这种行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T18:27:08.727

不要忘记在 web.config 中给 webresource.axd 足够的权限？

# sql - MySQL - 将字段的默认值设置为字符串连接函数

> ID：360467
> 
> 赞同：10
> 
> 时间：2008-12-11T18:57:46.927
> 
> 标签：sql, mysql, function, default-value

我有一张桌子，看起来有点像这个演员（名字，姓氏，舞台名）；

我想更新 stage_name 使其具有默认值

```
forename." ".surname 
```

以便

```
insert into actors(forename, surname) values ('Stack', 'Overflow'); 
```

会产生记录

```
'Stack'     'Overflow'    'Stack Overflow' 
```

这可能吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-11T19:03:56.743

MySQL 不支持`DEFAULT`列定义选项中的计算列或表达式。

您可以在触发器中执行此操作（需要 MySQL 5.0 或更高版本）：

```
CREATE TRIGGER format_stage_name 
BEFORE INSERT ON actors
FOR EACH ROW
BEGIN
  SET NEW.stage_name = CONCAT(NEW.forename, ' ', NEW.surname);
END 
```

您可能还想创建一个类似的触发器`BEFORE UPDATE`。

注意`NULL`名字和姓氏，因为 a`NULL`与任何其他字符串的连接会产生 a `NULL`。`COALESCE()`根据需要在每一列或连接的字符串上使用。

**编辑：**以下示例`stage_name`仅在`NULL`. 否则，您可以`stage_name`在`INSERT`语句中指定，它会被保留。

```
CREATE TRIGGER format_stage_name 
BEFORE INSERT ON actors
FOR EACH ROW
BEGIN
  IF (NEW.stage_name IS NULL) THEN
    SET NEW.stage_name = CONCAT(NEW.forename, ' ', NEW.surname);
  END IF;
END 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T19:01:57.120

根据[10.1.4。数据类型默认值](http://dev.mysql.com/doc/refman/5.0/en/data-type-defaults.html)不，你不能那样做。您只能使用常量或`CURRENT_TIMESTAMP`。

OTOH，如果您是最新的，您可能可以使用[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)来完成同样的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T19:13:12.557

我的第一个想法是，如果您在其他字段中有这两个值，那么将它们冗余存储在第三个字段中的迫切需要是什么？它违背了规范化和效率。

如果您只是想存储连接的值，那么您可以简单地创建一个视图（或者 IMSNHO 甚至更好的存储过程），将值连接到一个伪`actor`字段中，并直接从视图/存储过程而不是表中执行读取。

如果您绝对必须存储连接的值，您可以通过两种方式处理：

1) 使用存储过程而不是直接 SQL 进行插入。通过这种方式，您可以接收值并为您希望填充的字段构造一个值，然后构建插入语句，包括actors 字段的连接值。

2）所以我不会画太多火焰，请谨慎对待这个建议。仅作为最后手段使用。如果它为空，您可以通过添加触发器来构建该值来破解此行为。一般来说，触发器并不好。它们将看不见的成本和交互添加到相当简单的交互中。但是，您可以在插入或更新记录后使用 CREATE TRIGGER 更新参与者字段。[这](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)是参考页面。

# language-agnostic - 建模无序列表（即集合）的最佳方法是什么？

> ID：360473
> 
> 赞同：0
> 
> 时间：2008-12-11T18:59:17.703
> 
> 标签：language-agnostic

对形成集合的一组对象进行建模的最自然方法是什么？例如，您可能有一堆用户对象，它们都是邮件列表的订阅者。

显然，您可以将其建模为一个数组，但是您必须对元素进行排序，并且使用您的界面的任何人都可能会对您为什么要编码任意排序数据感到困惑。

您可以使用哈希，其中成员是映射到“1”或“true”的键，但在大多数语言中，哈希键可以是什么数据类型都有限制。

用现代语言（PHP、Perl、Ruby、Python 等）执行此操作的标准方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T19:02:25.280

在 Python 中，您将使用[`set`](http://docs.python.org/library/stdtypes.html#types-set)数据类型。A`set`支持包含任何可散列对象，因此如果您有一个需要存储在集合中的自定义类并且默认的可散列行为不合适，您可以实现`__hash__`以实现您想要的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T19:05:28.720

C# 具有 HashSet<T> 泛型集合。

```
public class EmailAddress  // probably needs to override GetHashCode()
{
   ...
}

var addresses = new HashSet<EmailAddress>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T19:07:15.847

大多数现代语言都将具有某种形式的 Set 数据结构。Java 有[HashSet](http://java.sun.com/j2se/1.4.2/docs/api/java/util/HashSet.html)，它实现了[Set](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Set.html)接口。

在 PHP 中，您可以使用数组来存储数据。在添加新元素之前搜索数组，或者在插入所有元素后使用[array_unique](http://us3.php.net/manual/en/function.array-unique.php)删除重复项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T19:38:27.327

在c中作为直接理解机器的替身：

*   对于小的、离散的和明确定义的范围：使用按位数组来指示每个可能项目的存在（设置为存在，未设置为不存在）。
*   对所有其他情况使用哈希表。

根据需要编写函数来实现添加和删除项目、测试是否存在、测试子集等。

* * *

但是，正如其他答案所指出的那样，如果您只想要该功能，请使用已经调试好的语言功能或第三方库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T20:12:26.213

很多时候，基于散列的集合是正确的使用方法，但是如果您不需要进行基于键的查找并且不担心强制执行唯一值，那么向量或列表就可以了。毕竟，哈希表是有开销的。

您似乎担心人们会认为向量中的顺序很重要，但我认为这是一种足够普遍的用法，通过文档，您不应该混淆人们。

这实际上取决于您希望如何访问和使用数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T20:19:48.603

而数组通常是最简单的数据存储方式，没有任何其他要求。通常出于不同的原因使用其他数据类型（您想要附加数据，您想要在恒定时间内搜索数据，您需要快速设置联合/交集等）如果您唯一关心的是抽象，您可以将其包装在某种无序的门面。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T20:24:22.587

在 Perl 中，我肯定会使用哈希。在其他语言中，我会为缺少哈希而感到遗憾。

# delphi - 在图像上写入透明文本

> ID：360476
> 
> 赞同：6
> 
> 时间：2008-12-11T19:00:17.157
> 
> 标签：delphi, image-processing

如何在图像（Jpg，Bmp）或透明文本（与背景图像相同的颜色）上写半透明文本但带有阴影，我想做的事情是给图像加水印。

我想使用 Delphi win32 来完成。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T15:48:17.423

一种选择是在 Windows.pas 单元中使用 AlphaBlend 函数。像这样的东西会产生覆盖在图像上的半透明文本（带有阴影 - 基于 Jim McKeeth 的响应）：

```
 uses Windows, Graphics;
.
.
.
var
  BackgroundImage: Graphics.TBitmap; { need to call out specifically for Graphics.TBitmap
                                       because the Windows unit also has a TBitmap
                                       declaration }
  TextImage: Graphics.TBitmap;
  BlendFunc: BLENDFUNCTION;
begin
  BlendFunc.BlendOp := AC_SRC_OVER;
  BlendFunc.BlendFlags := 0;
  BlendFunc.SourceConstantAlpha := $C0; { a hex value from $00-$FF (0-255).
                                          Represents the percent of opaqueness:
                                          $00 is completely transparent, 
                                          $FF is completely opaque.
                                          $C0 is 75% opaque }
  BlendFunc.AlphaFormat := AC_SRC_ALPHA;

    { BackgroundImage is for holding the image you want to overlay text onto }
    BackgroundImage := Graphics.TBitmap.Create;
    try
      BackgroundImage.LoadFromFile('yourimagehere.bmp');

      { Create another TBitmap to hold the text you want to overlay }
      TextImage := Graphics.TBitmap.Create;
      try
        { Set this bitmap to have the same dimensions as the
          background image you want the text to appear on. }
        TextImage.Height := BackgroundImage.Height;
        TextImage.Width := BackgroundImage.Width;

        { In my limited experience with AlphaBlend, Black is always 100%
          transparent. So, paint TextImage completely Black. Play around
          with this to see the effect it has on the final outcome. }
        TextImage.Canvas.Brush.Color := clBlack;
        TextImage.Canvas.FloodFill(0, 0, clNone, fsBorder);

        TextImage.Canvas.Font.Style := [fsBold];

        { Write the shadow first }
        TextImage.Canvas.Brush.Style := bsClear;
        TextImage.Canvas.Font.Color  := clDkGray;
        TextImage.Canvas.TextOut(11, 11, 'Test');

        { Then put the text on top (slightly offset) }
        TextImage.Canvas.Brush.Style := bsClear;
        TextImage.Canvas.Font.Color  := clMaroon;
        TextImage.Canvas.TextOut(10, 10, 'Test');

        { Use the AlphaBlend function to overlay the bitmap holding the text
          on top of the bitmap holding the original image. }
        Windows.AlphaBlend(BackgroundImage.Canvas.Handle, 0, 0,
                           TextImage.Width, TextImage.Height,
                           TextImage.Canvas.Handle, 0, 0, TextImage.Width,
                           TextImage.Height, BlendFunc);

        { Assign the now updated BackgroundImage to a TImage control for display }  
        Image1.Picture.Bitmap.Assign(BackgroundImage);
      finally
        TextImage.Free;
      end;
    finally
      BackgroundImage.Free;
    end;
  end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T20:54:46.580

阴影很简单：

```
// Bold shows up better when over an image
image1.Canvas.Font.Style := [fsBold]; 
// Write the shadow first
image1.Canvas.Brush.Style:=bsClear;
image1.Canvas.Font.Color := clGrayText;
image1.Canvas.TextOut(1, 1, 'hi there');
// Then put the text on top (slightly offset)
image1.Canvas.Brush.Style:=bsClear;
image1.Canvas.Font.Color :=clBlack;
image1.Canvas.TextOut(0, 0, 'hi there'); 
```

这是具有透明背景的文本。还是您希望文本本身是半透明的？这有点棘手。您需要手动绘制它。一种简单的方法是对您在图像上书写的区域的颜色进行平均采样。然后将你的字体颜色设置为更亮一点，你的阴影设置为更暗一点。然后它有点融入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T21:03:18.843

我认为您要完成的工作比简单地编写具有透明背景的文本要复杂一些；即，您正在尝试在图像上写入某种形式的 alpha 混合文本。
最简单的方法是使用 GDI+ 例程。它们为 delphi 封装，可从[http://www.progdigy.com/](http://www.progdigy.com/)下载。那里有许多示例，应该可以用作示例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T19:04:42.810

我还没有测试它，但它会给你一些想法去哪里。关键是画笔风格。

像这样的东西：

```
img.Canvas.Brush.Style:=bsClear;
img.Canvas.Font.Color:=clBlack;
img.Canvas.TextOut(0, 0, 'hi there'); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-06T12:45:06.303

这个函数是基于 Dave Elsberry 的想法。

有什么不同：

*   仅透明地绘制阴影
*   它使用的 RAM 几乎减少了 2 倍
*   参数

* * *

```
{-------------------------------------------------------------------------------------------------------------
  DrawTextShadowBox
    Draws text in a semi-transparent rectangle with shadow text.
    The shadow text is blended to the background and then blurred.

  Variant:
     1: Draws text in a box that is as wide as the BMP and can be aligned to top or bottom
     2: Draws text in a box that is as wide as text and is placed into the image at coordinates x,y

  Parameters:
     Opacity a value from 0-255\. 0 => Shadow is completelly transparent
     To set the Font color/size, the caller should do: aCanvas.Font.Size:= x

  Issues:
     The blurring function cuts too suddenly. The rectangle that was blurred is too visible. Do a blur that slowly fades at the edges.
     Might be slow becuase of the alpha blending and because of the blur.

 Important!
     The input img must be pf24bit.
     When the AlphaFormat member is AC_SRC_ALPHA, the source bitmap must be 32 bpp. If it is not, the AlphaBlend function will fail.
-------------------------------------------------------------------------------------------------------------}
procedure DrawTextShadowBox(BMP: TBitmap; CONST Text: string; AlignTop: Boolean; ShadowColor: TColor= clTextShadow; ShadowOpacity: Byte= 20; Blur: Byte= 2);
VAR
   Shadow: Vcl.Graphics.TBitmap;
   BlendFunc: BLENDFUNCTION;
   x, y: Integer;
   BmpRect: TRect; { Rectangle in the original bitmap where we want to draw the shadowed text }
   ShadowRect: TRect;
   TextWidth, TextHeight: Integer;
   OriginalColor: TColor;
begin
  Assert(BMP.PixelFormat= pf24bit, 'Wrong pixel format!!');
  OriginalColor:= bmp.Canvas.Font.Color;
  TextWidth := BMP.Canvas.TextWidth (Text);
  TextHeight:= BMP.Canvas.TextHeight(Text);

  { Write the shadow on a separate bitmap (overlay) }
  Shadow := TBitmap.Create;
  TRY
    { Bitmap setup }
    Shadow.Canvas.Font.Assign(BMP.Canvas.Font);
    Shadow.PixelFormat:= pf24bit;
    Shadow.SetSize(BMP.Width, TextHeight);

    { Bitmap rectangle as big as ShadowBMP }
    ShadowRect.Left:= 0;
    ShadowRect.Top := 0;
    ShadowRect.Right := Shadow.Width;
    ShadowRect.Bottom:= Shadow.Height;

    { Fill shadow rectangle }
    Shadow.Canvas.Brush.Color := clBlack;                                        { In AlphaBlend, Black is always 100% transparent. So, paint Shadow completely Black. }
    Shadow.Canvas.FillRect(ShadowRect);

    BmpRect.Left  := 0;
    BmpRect.Right := Shadow.Width;
    if AlignTop
    then BmpRect.Top := 0
    else BmpRect.Top := BMP.Height- TextHeight;
    BmpRect.Bottom:= BmpRect.Top+ TextHeight;

    { Blend rectangle with orig image }                                          { Use the AlphaBlend function to overlay the bitmap holding the text on top of the bitmap holding the original image. }
    BlendFunc.BlendOp    := AC_SRC_OVER;
    BlendFunc.BlendFlags := 0;
    BlendFunc.SourceConstantAlpha := ShadowOpacity;
    BlendFunc.AlphaFormat         := 0;                                          //AC_SRC_ALPHA; //  if I put this back, the shadow will be completly invisible when merged with a white source image
    WinApi.Windows.AlphaBlend(BMP.Canvas.Handle, BmpRect.Left, BmpRect.Top, BmpRect.Right, TextHeight, Shadow.Canvas.Handle, 0, 0, Shadow.Width, Shadow.Height, BlendFunc);

    { Copy the blended area back to the Shadow bmp }
    Shadow.Canvas.CopyRect(ShadowRect, BMP.Canvas, BmpRect);

    { Diagonal shadow }
    x:= (BMP.Width  - TextWidth) DIV 2;   // Find center
    Shadow.Canvas.Brush.Style:= bsClear;
    Shadow.Canvas.Font.Color := ShadowColor;
    Shadow.Canvas.TextOut(x, 0, Text);

    { Blur the shadow }
    janFX.GaussianBlur(Shadow, Blur, 1);

    { Paste it back }
    BMP.Canvas.CopyRect(BmpRect, Shadow.Canvas, ShadowRect);
  FINALLY
    FreeAndNil(Shadow);
  END;

  { Draw actual text at 100% opacity }
  if AlignTop
  then y := 0
  else y := BMP.Height- TextHeight;
  BMP.Canvas.Brush.Style:= bsClear;
  BMP.Canvas.Font.Color := OriginalColor;
  BMP.Canvas.TextOut(x, y, Text);
end;

procedure DrawTextShadowBox(aCanvas: TCanvas; CONST Text: string;  X, Y: Integer; ShadowColor: TColor= clTextShadow; ShadowOpacity: Byte= 20; Blur: Byte= 2);
VAR
   Shadow: Vcl.Graphics.TBitmap;
   BlendFunc: BLENDFUNCTION;
   H, W: Integer;
   OriginalColor: TColor;
   R, R2: TRect;
CONST Edge= 5;
begin
 OriginalColor:= aCanvas.Font.Color;

 { Write the shadow on a separate bitmap (overlay) }
 Shadow := TBitmap.Create;
 TRY
   { Assign font }
   Shadow.Canvas.Font.Assign(aCanvas.Font);
   Shadow.PixelFormat:= pf24bit;

   { Compute overlay size }
   W:= Shadow.Canvas.TextWidth (Text);
   H:= Shadow.Canvas.TextHeight(Text);
   Shadow.SetSize(W, H);

   { Fill shadow rectangle }
   R:= Rect(0, 0, Shadow.Width, Shadow.Height);
   Shadow.Canvas.Brush.Color := clBlack;                               { In AlphaBlend, Black is always 100% transparent. So, paint Shadow completely Black. }
   Shadow.Canvas.FillRect(R);

   { Blend rectangle with orig image }                                 { Use the AlphaBlend function to overlay the bitmap holding the text on top of the bitmap holding the original image. }
   BlendFunc.BlendOp := AC_SRC_OVER;
   BlendFunc.BlendFlags := 0;
   BlendFunc.SourceConstantAlpha := ShadowOpacity;
   BlendFunc.AlphaFormat := 0;                                         //AC_SRC_ALPHA; //  if I put this back, the shadow will be completly invisible when merged with a white source image
   WinApi.Windows.AlphaBlend(aCanvas.Handle, x, y, Shadow.Width, Shadow.Height, Shadow.Canvas.Handle, 0, 0, Shadow.Width, Shadow.Height, BlendFunc);

   { Copy the blended area back to the Shadow bmp }
   R2:= rect(x, y, x+Shadow.Width, y+Shadow.Height);
   Shadow.Canvas.CopyRect(R, aCanvas, R2);

   { Diagonal shadow }
   Shadow.Canvas.Brush.Style:= bsClear;
   Shadow.Canvas.Font.Color := ShadowColor;
   Shadow.Canvas.TextOut(0, 0, Text);

   { Blur the shadow }
   janFX.GaussianBlur(Shadow, blur, 1);

   { Paste it back }
   aCanvas.CopyRect(R2, Shadow.Canvas, R);
 FINALLY
   FreeAndNil(Shadow);
 END;

 { Draw actual text at 100% opacity }
 aCanvas.Brush.Style:= bsClear;
 aCanvas.Font.Color := OriginalColor;
 aCanvas.TextOut(x, y, Text);
end;

procedure TfrmTest.UseIt;
VAR BackgroundImage: tbitmap;
begin
 BackgroundImage := Graphics.TBitmap.Create;   
 try
   BackgroundImage.LoadFromFile('c:\test.bmp');
   DrawShadowText (BackgroundImage.Canvas, 'This is some demo text', 20, 40, 140, clRed, clSilver);
   Image1.Picture.Bitmap.Assign(BackgroundImage);
 FINALLY
   BackgroundImage.Free;
 end;
end; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-11T23:17:53.780

您可以使用[bitblt](http://users.telenet.be/ws36637/transbmp.html)例程将图像合并到公共画布，然后再次保存图像。

# algorithm - C# 中的 ISO 9797-1 算法 1 [CBC-MAC]

> ID：360480
> 
> 赞同：10
> 
> 时间：2008-12-11T19:00:58.667
> 
> 标签：algorithm, cbc-mac

CBC-MAC算法似乎有6种变体。我一直在尝试匹配 PINPad 1000SE 上的 MAC 算法 [根据手册是 ISO 9797-1 算法 1]。

我从[这里](http://bytes.com/topic/net/answers/654069-iso-iec-9797-1-cbc-mac-using-vb-net)有了一个很好的开始。

我将算法编码如下：

```
public static byte[] CalculateMAC(this IPinPad pinpad, byte[] message, byte[] key)
{
    //Divide the key with Key1[ first 64 bits] and key2 [last 64 bits]
    var key1 = new byte[8];
    Array.Copy(key, 0, key1, 0, 8);

    var key2 = new byte[8];
    Array.Copy(key, 8, key2, 0, 8); //64 bits

    //divide the message into 8 bytes blocks
    //pad the last block with "80" and "00","00","00" until it reaches 8 bytes
    //if the message already can be divided by 8, then add 
    //another block "80 00 00 00 00 00 00 00"
    Action<byte[], int> prepArray = (bArr, offset) =>
                                     {
                                         bArr[offset] = 0; //80
                                         for (var i = offset + 1; i < bArr.Length; i++)
                                             bArr[i] = 0;
                                     };
    var length = message.Length;
    var mod = length > 8? length % 8: length - 8;

    var newLength = length + ((mod < 0) ? -mod : (mod > 0) ? 8 - mod : 0);
    //var newLength = length + ((mod < 0) ? -mod : (mod > 0) ? 8 - mod : 8);
    Debug.Assert(newLength % 8 == 0);

    var arr = new byte[newLength];
    Array.Copy(message, 0, arr, 0, length);
    //Encoding.ASCII.GetBytes(message, 0, length, arr, 0);
    prepArray(arr, length);
    //use initial vector {0,0,0,0,0,0,0,0} 
    var vector = new byte[] { 0, 0, 0, 0, 0, 0, 0, 0 };

    //encrypt by DES CBC algorith with the first key KEY 1
    var des = new DESCryptoServiceProvider { Mode = CipherMode.CBC };
    var cryptor = des.CreateEncryptor(key1, vector);
    var outputBuffer = new byte[arr.Length];
    cryptor.TransformBlock(arr, 0, arr.Length, outputBuffer, 0);

    //Decrypt the result by DES ECB with the second key KEY2 [Original suggestion]
    //Now I'm Encrypting
    var decOutputBuffer = new byte[outputBuffer.Length];
    des.Mode = CipherMode.ECB;
    var decryptor = des.CreateEncryptor(key2, vector);
    //var decryptor = des.CreateDecryptor(key2, vector);
    decryptor.TransformBlock(outputBuffer, 0, outputBuffer.Length, decOutputBuffer, 0);

    //Encrypt the result by DES ECB with the first key KEY1
    var finalOutputBuffer = new byte[decOutputBuffer.Length];
    var cryptor2 = des.CreateEncryptor(key1, vector);
    cryptor2.TransformBlock(decOutputBuffer, 0, decOutputBuffer.Length, finalOutputBuffer, 0);

    //take the first 4 bytes as the MAC
    var rval = new byte[4];
    Array.Copy(finalOutputBuffer, 0, rval, 0, 4);
    return rval;
} 
```

然后我发现有 3 种填充方案，而让我开始的那个可能不一定是正确的。手册又来救我了。似乎该设备仅用 0 填充。也没有提到其他块，所以我做了以下更改：

```
 Action<byte[], int> prepArray = (bArr, offset) =>
                                     {
                                         bArr[offset] = 0; ... } 
```

没有额外的块（如果 mod 0 [可被 8 整除] 不改变数组长度）

```
var newLength = length + ((mod < 0) ? -mod : (mod > 0) ? 8 - mod : 0); 
```

最初的建议希望我在第二步解密......但[这里](http://www.derkeiler.com/Newsgroups/microsoft.public.dotnet.security/2005-04/0180.html)的 Valery 建议它一直加密。所以我将解密更改为加密。但我仍然无法获得必要的 MAC ......

手册说密钥“6AC292FAA1315B4D8234B3A3D7D5933A”[因为密钥应该是 16 个字节，我认为这里的密钥是十六进制字符串，所以我取了 6A、C2、92、FA 的字节值 ... new byte[] { 106, 194, 146, ...] 如果消息是 [0x1a + MENTERODOMETER 的字节数组]，MAC 应该是 7B,40,BA,95 [4 个字节]

有人可以帮忙吗？请？

* * *

由于 Pinpad 要求消息中的第一个字符是 0x1a...

```
public static byte[] CalculateAugmentedMAC(this IPinPad pinpad, string message, byte[] key)
{
    var arr = new byte[message.Length + 1];
    var source = Encoding.ASCII.GetBytes(message);
    arr[0] = 0x1a; //ClearScreenIndicator
    Array.Copy(source, 0, arr, 1, source.Length);
    return CalculateMAC(pinpad, arr, key);
} 
```

我用这个输入调用上面的代码：

```
var result = pad.CalculateAugmentedMAC("MENTERODOMETER", new byte[] { 106, 194, 146, 250, 161, 49, 91, 77, 130, 52, 179, 163, 215, 213, 147, 58 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-22T12:46:34.433

大多数 CBC MAC 算法都在[BouncyCastle](http://www.bouncycastle.org)的 JCE 提供程序中实现。

看：[BouncyCastleProvider.java](http://bouncycastle.org/viewcvs/viewcvs.cgi/java/crypto/src/org/bouncycastle/jce/provider/BouncyCastleProvider.java?rev=1.83&content-type=text/vnd.viewcvs-markup)

您可能正在寻找`DESEDEISO9797ALG1MACWITHISO7816-4PADDING`，它是 的别名`DESEDEMAC64WITHISO7816-4PADDING`，在此处实现（嗯，它是使用 DESedeEngine 和 ISO7816d4Padding 的 CBCBlockCipherMac 的特定配置，您必须在一些类之间跳转才能获得完整的图片）： [JCEMac.java](http://bouncycastle.org/viewcvs/viewcvs.cgi/java/crypto/src/org/bouncycastle/jce/provider/JCEMac.java?rev=1.5&content-type=text/vnd.viewcvs-markup)

另外，看看jPos：

[JCESecurityModule.java](http://jpos.svn.sourceforge.net/svnroot/jpos/trunk/jpos6/modules/security/src/org/jpos/security/jceadapter/JCESecurityModule.java)

以及他们贡献的零售 MAC 算法实现：

[零售-mac-contributed-by-vsalaman.zip](http://jpos.svn.sourceforge.net/svnroot/jpos/trunk/incoming/retail-mac-contributed-by-vsalaman.zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-04T15:49:46.090

无法回答您的特定终端，但我用它来测试 MAC。

```
public static byte[] GenerateMAC(byte[] key, byte[] data)
{
    using (MACTripleDES mac = new MACTripleDES(key))
        return mac.ComputeHash(data);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-22T12:51:30.990

我很确定（IIRC）你需要`TransformFinalBlock`在最后（每个加密器）调用。

# asp.net - 使用具有多个实体的母版页

> ID：360481
> 
> 赞同：1
> 
> 时间：2008-12-11T19:01:22.940
> 
> 标签：asp.net, hierarchy

我开始计划对我们部门的 Intranet 页面进行彻底的重新设计。就目前而言，每个部门在根目录下都有自己的文件夹。它们都具有相同的外观和感觉，但不使用 CSS 每个文件中的所有内容都是直接静态文本。基本上，如果必须对标题进行更改，*每个*文件必须更改。文件的数量在数百个中。由于我们正在获得新的外观和感觉，我认为这也是重新设计整个结构的合适时机。我的想法是创建一个新的 C# Web 项目来利用 C# 母版页。在该项目中，每个页面都将使用母版页。因为我知道他们喜欢进行许多小的外观更改，所以母版页会使事情变得更简单，坦率地说，我没有时间手动编辑标题 564（随机）次。该站点的另一个方面是根目录将包含一个文档文件夹，其中包含与我们每个部门相关的子文件夹。

我想我的问题是，有没有人解决过这样的问题，并且可以阐明他们是如何解决它的。

此外，是否值得将 IIS 和 .NET 升级到最新版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T19:56:10.507

如果您已经在 .NET 2.0 中工作，那么您不需要进行任何升级，也不会产生任何额外的基础架构成本。

我强烈建议使用母版页，因为它们确实可以让您的整个网站具有共同的外观和感觉。

母版页的另一个很酷的功能是您可以[将它们嵌套在一起](http://msdn.microsoft.com/en-us/library/x2b3ktt7.aspx)。这会让你在所有页面之间有一个共同的感觉。然后每个部门都会有自己的母版页嵌套到您的顶级页面中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T19:39:49.603

我将从成本问题开始。您需要使用 ASP.NET 2.0 或更高版本才能利用母版页。从技术上讲，.NET 框架是免费的，但 Visual Studio 不是。Visual Web Developer 是免费的，但许可证可能仅适用于非商业项目。我不知道。IIS 也是免费的，Windows Server 2008 不是。您可以在 XP 或 Server 2000/2003 上正常运行。真的没有任何升级的理由。

我不能说我已经解决了与您的问题完全一样的问题，但听起来您需要的是一个内容管理系统。一些例子是[cuyahoga 项目](http://www.cuyahoga-project.org/)或[Umbraco](http://umbraco.org/)。这些系统允许您创建一般的外观和感觉，并将所有内容存储在数据库或 xml 文件中，并提供在线内容编辑器，因此页面的内容可以由不一定了解 HTML 或编程的人管理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T21:59:06.640

您可以有一个母版页层次结构：

*   每个人的母版页
    *   部门 A 的母版页
    *   B 部门的母版页

您在第一个母版页中设置的每个人的共同点。

然后为部门 A 页面制作母版页 - 此母版页的母版页是第一个。

# fastcgi - 在 Windows IIS 服务器上处理 Fast CGI 中的终止

> ID：360483
> 
> 赞同：0
> 
> 时间：2008-12-11T19:01:48.277
> 
> 标签：fastcgi

事实证明，寻找 Windows FastCGI 帮助非常困难。任何帮助将不胜感激。

FastCGi 的概念是进程在请求中存活下来，允许您在调用之间保持状态。这意味着您没有在调用之间打开数据库等的开销。

除此之外，FastCGI 是完全多路复用的： [http ://cryp.to/publications/fastcgi/#MULTIPLEXING](http://cryp.to/publications/fastcgi/#MULTIPLEXING)

问题出在 C API

libfcgi.dll 的源代码可在此处获得：http: [//www.fastcgi.com/drupal/node/5](http://www.fastcgi.com/drupal/node/5)

MS 不支持这一点，因为任何与 FCGI 或 IIS 相关的人都匆忙指出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T20:39:54.053

需要一个新的 Windows FastCGI 库来实现 FastCGI SIGTERM 处理程序 www.coastrd.com

# jquery - 使用 jQuery 抓取文本时如何去除空格？

> ID：360491
> 
> 赞同：185
> 
> 时间：2008-12-11T19:03:40.567
> 
> 标签：jquery

我想使用 jQuery 来包装 mailto: 围绕电子邮件地址的锚点，但它也抓住了 CMS 生成的空白。

这是我必须使用的 HTML、我拥有的脚本和输出的副本。

HTML

```
<div class="field field-type-text field-field-email">
  <div class="field-item">
    name@example.com    </div>
</div> 
```

jQuery JavaScript

```
$(document).ready(function(){
  $('div.field-field-email .field-item').each(function(){
    var emailAdd = $(this).text();
      $(this).wrapInner('<a href="mailto:' + emailAdd + '"></a>');
   });
 }); 
```

生成的 HTML

```
<div class="field field-type-text field-field-email">
  <div class="field-items"><a href="mailto:%0A%20%20%20%20name@example.com%20%20%20%20">
    name@example.com    </a></div>
</div> 
```

尽管我怀疑其他阅读此问题的人可能只想去掉前导和尾随空格，但考虑到这是我要包装的电子邮件地址，我很高兴丢失所有空格。

* * *

## 回答 #1

> 赞同：336
> 
> 时间：2008-12-11T19:04:46.163

使用`replace`js中的函数：

```
var emailAdd = $(this).text().replace(/ /g,''); 
```

这将删除所有空格

如果您只想删除前导和尾随空格，请**使用**jQuery $.trim 方法：

```
var emailAdd = $.trim($(this).text()); 
```

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2013-04-03T15:13:26.993

Javascript 已内置修剪：

```
str.trim() 
```

它在 IE8 中不起作用。如果您必须支持较旧的浏览器，请使用[Tuxmentat](https://stackoverflow.com/a/360533/8554766)或[Paul 的](https://stackoverflow.com/a/9931128/8554766)答案。

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2008-12-11T19:15:49.543

实际上，jQuery 有一个内置的修剪功能：

```
 var emailAdd = jQuery.trim($(this).text()); 
```

有关详细信息，请参见[此处](http://docs.jquery.com/Utilities/jQuery.trim#str)。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-03-29T18:19:09.423

`str=str.replace(/^\s+|\s+$/g,'');`

# regex - Yahoo! 上的正则表达式 管道

> ID：360492
> 
> 赞同：3
> 
> 时间：2008-12-11T19:03:44.043
> 
> 标签：regex, yahoo-pipes

我在和[雅虎开玩笑！管道](http://pipes.yahoo.com)，我正在用一些正则表达式撞墙。现在我熟悉 Perl 的正则表达式，但 Yahoo! 中的规则似乎有所不同！管道。

[![我的管道截图](https://i.stack.imgur.com/6I6Ok.png)](https://i.stack.imgur.com/6I6Ok.png)

我正在做的是获取一个页面并尝试将其转换为提要，我用于从 HTML 中删除链接的正则表达式工作正常，但我想成为*<i>*标签中的标题只是输出原始文本.

[在 Perl 和此在线正则表达式测试器](http://www.quanetic.com/regex.php)中匹配的示例文本：

> <a rel="nofollow" target="_blank" HREF="http://changed.to/protect/the-guilty.html"><i>“Fee Fi Fo Fun”（英国人）</i>< /a> （另请参阅此其他站点 <a rel="nofollow" target="_blank" href="http://stackoverflow.com">Nada</a>）此处的其他一些文本

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T19:38:50.417

正则表达式的标题：

```
(?i).*?<i>([^<]*).*               [ ] g  [x] s  [ ] m  [ ] i 
```

链接的正则表达式：

```
(?i).*?href="([^"]*).*            [ ] g  [x] s  [ ] m  [ ] i 
```

不知何故，不区分大小写的复选框似乎坏了。幸运的是，您可以替换为`(?i)`，效果很好。

这是一个很好的 web2.0-ish 工具，用于测试正则表达式：[RegExr](http://gskinner.com/RegExr/)。但由于某种原因，它仍然是测试版。;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-07T17:00:19.657

使用 YP 需要注意的一件重要事情是不要相信调试屏幕，它有一个小怪癖，即在视图中隐藏一些标签，在尝试正则表达式时可能会导致无休止的混乱。要公开任何隐藏的 html，请将 '<' 替换为 '#'

# c# - 在方法的开头没有一堆if的情况下对方法强制输入参数？

> ID：360507
> 
> 赞同：3
> 
> 时间：2008-12-11T19:08:33.050
> 
> 标签：c#, .net

我想知道在我的方法中是否有一种不那么冗长的方法来进行输入验证。例如，我通常写这样的东西：

```
public string SomeFunction(string param1, int param2)
{
    if(string.IsNullOrEmpty(param1)){
        throw new ArgumentException("bla", "param1");
    }
    if(param2 < 0 || param2 > 100 || param2 == 53)
    {
         throw new ArgumentOutOfRangeException("eek", "param2");
    }
} 
```

现在，我想知道是否有办法对参数设置约束并让编译器已经为我处理了？我相信这被称为“合同”，我记得看到 Spec# 应该这样做，但目前这似乎是一个实验性研究项目。

所以我想知道：对于.net 3.5 SP1 和理想情况下.net 3.0 的输入参数，是否有任何东西可以为.net 3.5 SP1 和理想的.net 3.0 的输入参数提供明确的约束（至少是简单且经常重复出现的约束，如string.IsNullOrEmpty）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T19:13:09.593

好吧，你可以用 AOP 做点什么，看看[PostSharp](http://www.postsharp.org)。

这可以用来只注入必要的代码，但它增加了一些开销，无论是编译步骤还是编译代码。

[代码合同也计划包含在 .NET 4.0 中，请在此处](http://msmvps.com/blogs/jon_skeet/archive/2008/11/06/net-4-0-s-game-changing-feature-maybe-contracts.aspx)阅读有关此内容的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T19:21:10.547

您可以引入 CheckParameter 方法，这样您的原始方法中只有一行代码。

像这样的东西：

```
public string SomeFunction(string param1, int param2)
{
    CheckParameterNotNull(param1);
    CheckParameterRange(param2, 0, 100, 53); 
...
} 
```

当然，您需要一些智能 CheckParameter 方法来适应您的所有情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T19:27:01.673

三个字：[合同设计](http://en.wikipedia.org/wiki/Design_by_contract)

可以在此处找到 C# 的一种实现：http: [//www.codeproject.com/KB/cs/designbycontract.aspx](http://www.codeproject.com/KB/cs/designbycontract.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T20:02:03.317

考虑 Microsoft Research 的“Spec#”：[http ://research.microsoft.com/SpecSharp/](http://research.microsoft.com/SpecSharp/)

它扩展了 C# 以允许您定义合同，并且他们在将合同放入 BCL 和其他东西方面投入了大量工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T23:44:11.247

您可以保持所有参数检查代码不变，然后将实际工作委托给私有函数。私有函数不会进行参数检查，因为它只会被公共网守函数调用。

```
private string InternalSomeFunction(string param1, int param2)
{
  /* implementation goes here */
}

public string SomeFunction(string param1, int param2)
{
  if (string.IsNullOrEmpty(param1)) {
    throw new ArgumentException("bla", "param1");
  }
  if (param2 < 0 || param2 > 100 || param2 == 53) {
    throw new ArgumentOutOfRangeException("eek", "param2");
  }
  return InternalSomeFunction(param1, param2);
} 
```

它和原来的一样冗长，但至少你的 main 函数没有杂乱无章的东西，这些东西并不是方法实现的真正核心。

另一方面，通过将参数检查代码从实现的其余部分移开，这也消除了检查的一些自记录方面。例如，当您查看 时`InternalSomeMethod`，不再有提示`param1`始终是有效的非空字符串，因此您或维护程序员可能会想稍后在内部方法中添加检查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T23:58:24.353

在 WebForms 类型世界之后建模，您可以使用一组[ErrorProvider](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)控件并将它们附加到有问题的关键文本框、复选框等。您可以在用户更改焦点时或您喜欢的频率更改时对这些字段进行检查。

然后，您可以创建一个名为 IsFormValid 的方法，该方法将检查所有 ErrorProviders 并在所有 ErrorProviders 检出时返回一个简单的 True 值。

然后在你所有的主要代码中，你所要做的就是把你的处理包装起来..

```
if (IsFormValid)
{
   // Processing Magic Goes here.
} 
```

这样做的好处是，根据特定方法试图完成的任务，您可能会拥有不同的“有效”状态。当然电话号码字段可能无效并显示一个小红点，但这不应阻止 UpdateFirstLastName 方法触发。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T18:01:45.797

与此同时，自从提出这个问题以来，代码合同已经进化，看起来就像银弹。

当前的 CTP[可在此处获得](http://msdn.microsoft.com/en-us/devlabs/dd491992.aspx)（适用于 .net 3.5），它是 .net 4.0 的一部分。

# sql-server - SQL Server 2005 - 查看在 SP 内部执行的 SP

> ID：360510
> 
> 赞同：4
> 
> 时间：2008-12-11T19:09:45.827
> 
> 标签：sql-server, sql-server-2005, sql-server-profiler

我想知道是否可以在 Sql Server Profiler 中看到其他存储过程正在执行的存储过程，是否有可能，如果可以，如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T21:51:30.507

如果您使用 SP::Starting 事件进行分析，您可以看到所有已执行的存储过程。您要确保包含几个配置文件列：

NestLevel - 这显示了相互调用的 SP 的嵌套级别 - 因此，如果 Test 调用 EmbeddedTest，则 Test 的 SP::Starting 事件将显示 NestLevel=1，而 EmbeddedTest 的事件将显示 NestLevel=2

ObjectName - 这显示正在执行的存储过程的名称

SPID - 连接的会话 ID

因此，要查找调用序列，您需要查找 NestLevel 大于 1 的事件，然后在调用之前的同一 SPID 上查找 NestLevel=1。当然，这也适用于更深的嵌套级别。

# tfs - 如何在 Team Foundation Server 中更改我的用户帐户域

> ID：360512
> 
> 赞同：4
> 
> 时间：2008-12-11T19:10:12.690
> 
> 标签：tfs

我们正在从一个域迁移到另一个域，我希望能够保留相同的工作区、用户设置、历史记录等。

有什么方法可以在 Team Foundation Server 中仅更改我的域或登录名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T09:39:37.550

我不知道答案，但我确实对 TFS 了解得足够多，以至于对此有点害怕。

如果我对您的理解正确，您想要更改您的用户正在验证的域，但您想要保持所有相同的用户 ID 指向 TFS 中的相同帐户？

TFS 与 Active Directory 高度集成，并在各处存储 AD SID。它对 AD 配置的变化也非常敏感。

我似乎记得我认识的一位客户以前做过这件事，但我现在找不到它的详细信息。我认为您最好的选择是致电 Microsoft 产品支持并提出有关它的支持事件，因为我有一个模糊的记忆，有一些特殊的工具必须运行 - 但我可能弄错了。

祝你好运，

马丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T19:12:26.740

我知道您的登录名是通过您的域控制器完成的，但我不知道这将如何与切换您的 TFS 所在的域一起工作。您是否尝试移动 TFS 安装所在的域或您的 PC 所在的域？

# java - 使用 Spring Security 进行单元测试

> ID：360520
> 
> 赞同：166
> 
> 时间：2008-12-11T19:11:43.840
> 
> 标签：java, security, unit-testing, spring, spring-security

我的公司一直在评估 Spring MVC，以确定我们是否应该在下一个项目中使用它。到目前为止，我喜欢我所看到的，现在我正在查看 Spring Security 模块以确定它是否是我们可以/应该使用的东西。

我们的安全要求非常基本；用户只需要能够提供用户名和密码即可访问网站的某些部分（例如获取有关其帐户的信息）；并且网站上有一些页面（常见问题解答、支持等）应该允许匿名用户访问。

在我创建的原型中，我在 Session 中为经过身份验证的用户存储了一个“LoginCredentials”对象（仅包含用户名和密码）；例如，一些控制器会检查该对象是否处于会话中以获取对登录用户名的引用。我正在寻找用 Spring Security 替换这种本土逻辑，这将有一个很好的好处，即删除任何类型的“我们如何跟踪登录的用户？” 和“我们如何验证用户？” 从我的控制器/业务代码。

似乎 Spring Security 提供了一个（每线程）“上下文”对象，以便能够从应用程序中的任何位置访问用户名/主体信息......

```
Object principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal(); 
```

...在某种程度上，这似乎非常不像 Spring，因为这个对象是一个（全局）单例。

我的问题是：如果这是在 Spring Security 中访问有关经过身份验证的用户的信息的标准方法，那么将 Authentication 对象注入 SecurityContext 以便在单元测试需要时可用于我的单元测试的可接受方法是什么？认证用户？

我需要在每个测试用例的初始化方法中连接它吗？

```
protected void setUp() throws Exception {
    ...
    SecurityContextHolder.getContext().setAuthentication(
        new UsernamePasswordAuthenticationToken(testUser.getLogin(), testUser.getPassword()));
    ...
} 
```

这似乎过于冗长。有没有更简单的方法？

`SecurityContextHolder`物体本身看起来很不像春天......

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2013-06-20T18:17:21.720

只需按照通常的方式进行操作，然后将其插入`SecurityContextHolder.setContext()`到您的测试类中，例如：

控制器：

```
Authentication a = SecurityContextHolder.getContext().getAuthentication(); 
```

测试：

```
Authentication authentication = Mockito.mock(Authentication.class);
// Mockito.whens() for your authorization object
SecurityContext securityContext = Mockito.mock(SecurityContext.class);
Mockito.when(securityContext.getAuthentication()).thenReturn(authentication);
SecurityContextHolder.setContext(securityContext); 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-12-16T19:27:37.913

问题是 Spring Security 没有使 Authentication 对象作为容器中的 bean 可用，因此无法轻松地注入或自动装配它。

在我们开始使用 Spring Security 之前，我们会在容器中创建一个会话范围的 bean 来存储 Principal，将其注入到“AuthenticationService”（单例）中，然后将此 bean 注入需要了解当前 Principal 的其他服务中。

如果您正在实现自己的身份验证服务，您基本上可以做同样的事情：创建一个具有“主体”属性的会话范围 bean，将其注入您的身份验证服务，让身份验证服务将属性设置为成功身份验证，然后根据需要让其他 bean 可以使用 auth 服务。

使用 SecurityContextHolder 我不会觉得太糟糕。尽管。我知道这是一个静态/单例，Spring 不鼓励使用这样的东西，但它们的实现会根据环境注意适当的行为：Servlet 容器中的会话范围，JUnit 测试中的线程范围等。真正的限制因素单例是指它提供了一种对不同环境不灵活的实现。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2016-05-25T19:13:26.853

在没有回答有关如何创建和注入 Authentication 对象的问题的情况下，Spring Security 4.0 在测试方面提供了一些受欢迎的替代方案。`@WithMockUser`注释使开发人员能够以简洁的方式指定模拟用户（具有可选的权限、用户名、密码和角色）：

```
@Test
@WithMockUser(username = "admin", authorities = { "ADMIN", "USER" })
public void getMessageWithMockUserCustomAuthorities() {
    String message = messageService.getMessage();
    ...
} 
```

还有一个选项可以`@WithUserDetails`用来模拟`UserDetails`从 中返回的`UserDetailsService`，例如

```
@Test
@WithUserDetails("customUsername")
public void getMessageWithUserDetailsCustomUsername() {
    String message = messageService.getMessage();
    ...
} 
```

更多详细信息可以在 Spring Security 参考文档中的[@WithMockUser](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test-method-withmockuser)和[@WithUserDetails](http://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/#test-method-withuserdetails)章节中找到（上面的示例是从中复制的）

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2008-12-28T09:41:52.170

你的担心是对的——静态方法调用对于单元测试来说尤其成问题，因为你不能轻易地模拟你的依赖关系。我将向您展示的是如何让 Spring IoC 容器为您完成繁琐的工作，为您留下整洁、可测试的代码。SecurityContextHolder 是一个框架类，虽然可以将您的低级安全代码绑定到它，但您可能希望向您的 UI 组件（即控制器）公开一个更简洁的界面。

clone.meyers 提到了一种解决方法——创建自己的“主要”类型并将实例注入消费者。2.x 中引入的 Spring < [aop:scoped-proxy](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-scopes-other-injection) /> 标签结合请求范围 bean 定义，工厂方法支持可能是获得最可读代码的门票。

它可以像下面这样工作：

```
public class MyUserDetails implements UserDetails {
    // this is your custom UserDetails implementation to serve as a principal
    // implement the Spring methods and add your own methods as appropriate
}

public class MyUserHolder {
    public static MyUserDetails getUserDetails() {
        Authentication a = SecurityContextHolder.getContext().getAuthentication();
        if (a == null) {
            return null;
        } else {
            return (MyUserDetails) a.getPrincipal();
        }
    }
}

public class MyUserAwareController {        
    MyUserDetails currentUser;

    public void setCurrentUser(MyUserDetails currentUser) { 
        this.currentUser = currentUser;
    }

    // controller code
} 
```

到目前为止没有什么复杂的，对吧？事实上，您可能已经完成了大部分工作。接下来，在您的 bean 上下文中定义一个请求范围的 bean 来保存主体：

```
<bean id="userDetails" class="MyUserHolder" factory-method="getUserDetails" scope="request">
    <aop:scoped-proxy/>
</bean>

<bean id="controller" class="MyUserAwareController">
    <property name="currentUser" ref="userDetails"/>
    <!-- other props -->
</bean> 
```

由于 aop:scoped-proxy 标签的魔力，静态方法 getUserDetails 将在每次新的 HTTP 请求进入时调用，并且对 currentUser 属性的任何引用都将被正确解析。现在单元测试变得微不足道：

```
protected void setUp() {
    // existing init code

    MyUserDetails user = new MyUserDetails();
    // set up user as you wish
    controller.setCurrentUser(user);
} 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-03-07T21:03:26.710

就我个人而言，我只会在你的单元/集成测试中使用 Powermock 和 Mockito 或 Easymock 来模拟静态 SecurityContextHolder.getSecurityContext() 例如

```
@RunWith(PowerMockRunner.class)
@PrepareForTest(SecurityContextHolder.class)
public class YourTestCase {

    @Mock SecurityContext mockSecurityContext;

    @Test
    public void testMethodThatCallsStaticMethod() {
        // Set mock behaviour/expectations on the mockSecurityContext
        when(mockSecurityContext.getAuthentication()).thenReturn(...)
        ...
        // Tell mockito to use Powermock to mock the SecurityContextHolder
        PowerMockito.mockStatic(SecurityContextHolder.class);

        // use Mockito to set up your expectation on SecurityContextHolder.getSecurityContext()
        Mockito.when(SecurityContextHolder.getSecurityContext()).thenReturn(mockSecurityContext);
        ...
    }
} 
```

诚然，这里有相当多的样板代码，即模拟 Authentication 对象，模拟 SecurityContext 以返回 Authentication，最后模拟 SecurityContextHolder 以获取 SecurityContext，但是它非常灵活，允许您对 null Authentication 对象等场景进行单元测试等，而无需更改您的（非测试）代码

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-02-04T12:59:51.983

在这种情况下使用静态是编写安全代码的最佳方式。

是的，静态通常是不好的 - 通常，但在这种情况下，静态就是你想要的。由于安全上下文将 Principal 与当前运行的线程相关联，因此最安全的代码将尽可能直接地从线程访问静态。将访问隐藏在注入的包装类后面，为攻击者提供了更多攻击点。他们不需要访问代码（如果 jar 已签名，他们将很难更改代码），他们只需要一种覆盖配置的方法，这可以在运行时完成或将一些 XML 滑入类路径。即使使用注解注入也可以被外部 XML 覆盖。此类 XML 可能会向正在运行的系统注入恶意主体。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-19T21:45:04.540

[我自己在这里](https://stackoverflow.com/questions/248562/when-using-spring-security-what-is-the-proper-way-to-obtain-current-username-i)问了同样的问题，并刚刚发布了我最近找到的答案。简短的回答是：注入 a `SecurityContext`，并仅在您的 Spring 配置中引用`SecurityContextHolder`以获取`SecurityContext`

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-11-16T11:52:58.703

# 一般的

与此同时（由于[SEC-2298 ，自 3.2 版起，2013 年），可以使用注解](https://jira.spring.io/browse/SEC-2298?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel)[@AuthenticationPrincipal](http://docs.spring.io/spring-security/site/docs/3.2.3.RELEASE/reference/htmlsingle/#mvc-authentication-principal)将身份验证注入 MVC 方法：

```
@Controller
class Controller {
  @RequestMapping("/somewhere")
  public void doStuff(@AuthenticationPrincipal UserDetails myUser) {
  }
} 
```

# 测试

在您的单元测试中，您显然可以直接调用此方法。在集成测试中，`org.springframework.test.web.servlet.MockMvc`您可以使用`org.springframework.security.test.web.servlet.request.SecurityMockMvcRequestPostProcessors.user()`这样的方式注入用户：

```
mockMvc.perform(get("/somewhere").with(user(myUserDetails))); 
```

然而，这将直接填充 SecurityContext。如果您想确保用户是从测试中的会话加载的，您可以使用以下命令：

```
mockMvc.perform(get("/somewhere").with(sessionUser(myUserDetails)));
/* ... */
private static RequestPostProcessor sessionUser(final UserDetails userDetails) {
    return new RequestPostProcessor() {
        @Override
        public MockHttpServletRequest postProcessRequest(final MockHttpServletRequest request) {
            final SecurityContext securityContext = new SecurityContextImpl();
            securityContext.setAuthentication(
                new UsernamePasswordAuthenticationToken(userDetails, null, userDetails.getAuthorities())
            );
            request.getSession().setAttribute(
                HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY, securityContext
            );
            return request;
        }
    };
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-11T19:20:09.893

我会看一下[这里](http://static.springframework.org/spring/docs/2.5.x/reference/testing.html)讨论的 Spring 的抽象测试类和模拟对象。它们提供了一种强大的自动连接 Spring 托管对象的方法，使单元和集成测试更容易。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-06-20T18:39:31.223

身份验证是服务器环境中线程的属性，就像它是操作系统中进程的属性一样。拥有一个用于访问身份验证信息的 bean 实例将是不方便的配置和布线开销，没有任何好处。

关于测试身份验证，有几种方法可以让您的生活更轻松。我最喜欢的是制作一个自定义注释`@Authenticated`和测试执行侦听器来管理它。检查`DirtiesContextTestExecutionListener`灵感。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-06-11T10:59:08.483

经过大量工作后，我能够重现所需的行为。我已经通过 MockMvc 模拟了登录。对于大多数单元测试来说它太重了，但对集成测试很有帮助。

当然，我很愿意看到 Spring Security 4.0 中的那些新特性，它们将使我们的测试更容易。

```
package [myPackage]

import static org.junit.Assert.*;

import javax.inject.Inject;
import javax.servlet.http.HttpSession;

import org.junit.Before;
import org.junit.Test;
import org.junit.experimental.runners.Enclosed;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.security.core.context.SecurityContext;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.web.FilterChainProxy;
import org.springframework.security.web.context.HttpSessionSecurityContextRepository;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.test.context.web.WebAppConfiguration;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.*;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;

@ContextConfiguration(locations={[my config file locations]})
@WebAppConfiguration
@RunWith(SpringJUnit4ClassRunner.class)
public static class getUserConfigurationTester{

    private MockMvc mockMvc;

    @Autowired
    private FilterChainProxy springSecurityFilterChain;

    @Autowired
    private MockHttpServletRequest request;

    @Autowired
    private WebApplicationContext webappContext;

    @Before  
    public void init() {  
        mockMvc = MockMvcBuilders.webAppContextSetup(webappContext)
                    .addFilters(springSecurityFilterChain)
                    .build();
    }  

    @Test
    public void testTwoReads() throws Exception{                        

    HttpSession session  = mockMvc.perform(post("/j_spring_security_check")
                        .param("j_username", "admin_001")
                        .param("j_password", "secret007"))
                        .andDo(print())
                        .andExpect(status().isMovedTemporarily())
                        .andExpect(redirectedUrl("/index"))
                        .andReturn()
                        .getRequest()
                        .getSession();

    request.setSession(session);

    SecurityContext securityContext = (SecurityContext)   session.getAttribute(HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY);

    SecurityContextHolder.setContext(securityContext);

        // Your test goes here. User is logged with 
} 
```

# php - Eclipse PDT HTML属性赋值运算符颜色？

> ID：360530
> 
> 赞同：2
> 
> 时间：2008-12-11T19:15:04.067
> 
> 标签：php, eclipse, syntax, colors, eclipse-pdt

我想知道如何在eclipse PDT IDE中更改html文档的等号和双引号的颜色。我可以在 Preferences -> Web & XML -> HTML Files -> syntax coloring 中更改大多数颜色，但不能更改字符`=`或`"`例如在锚标记`<a href="">`中。

如何改变这些颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T20:53:26.240

它是通用文本编辑器选项中唯一被默认*前景色覆盖的剩余元素。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T21:03:21.907

您可能还想查看[Web Tools Platform](http://www.eclipse.org/webtools/)插件和[Apatana](http://www.aptana.com/)，它们都为您提供了更多的语法颜色突出显示控制（以及更多）。

# sql-server - SQL Server 撤消

> ID：360543
> 
> 赞同：2
> 
> 时间：2008-12-11T19:19:48.693
> 
> 标签：sql-server, transactions

我是一名兼职开发人员（全日制学生），我工作的公司使用 SQL Server 2005。我对 SQL Server 感到奇怪的是，如果您执行涉及插入、更新等的脚本，则没有任何真正的方法撤消它，除了回滚或使用事务。

你可能会说这两个选项有什么问题？好吧，例如，如果有人执行更新语句并忘记输入`WHERE`子句，您会突然发现自己更新了 13k 行，并且突然该表中的所有客户端都被命名为“bob”。现在你要面对 13k bob 的愤怒，因为那个“某人”忘记了使用事务，如果你进行回滚，你将撤消其他领域所需的关键更改。

在我的学习中，我有甲骨文。在 Oracle 中，您可以先运行脚本，然后如果您发现没有任何错误，则提交它。我想知道在 SQL Server 中是否有一些我错过的东西，因为我在工作的开发人员世界中仍然相对较新。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T19:25:34.750

我不相信你错过了什么。使用事务来防止此类错误是最好的机制，这与 Oracle 用来保护最终用户的机制相同。不同之处在于 Oracle 为您隐式启动事务，而在 SQL Server 中您必须显式执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T20:05:17.243

SET IMPLICIT_TRANSACTIONS 是您可能正在寻找的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T19:24:30.523

我不是数据库/sql 服务器专家，我不确定这是否是您要查找的内容，但可以创建数据库的快照。快照允许您随时将数据库恢复到该状态。

检查此链接以获取更多信息：http: [//msdn.microsoft.com/en-us/library/ms175158.aspx](http://msdn.microsoft.com/en-us/library/ms175158.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T19:28:14.697

我认为交易运作良好。您可以回滚数据库（到以前的备份或日志中的点），但我认为事务要简单得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T19:29:08.080

据我了解，SQL Server 2008 添加了一个审计功能，可以记录用户对各种数据库所做的所有更改，并且还可以选择在事后回滚它们。

同样，这是我从我们的 DBA 那里读到或听到的内容，但可能值得研究。

编辑：在调查之后，它似乎只能回滚模式更改，而不是数据修改（DDL 触发器）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T19:35:57.443

怎么样：永远不要对尚未在您的开发服务器上测试过的生产数据库进行更改，并且在尝试任何未经证实的事情之前始终进行备份。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-01T16:51:09.807

如果我在 SQL Server 中做任何有风险的事情，我会这样编写脚本：

开始传输

插入....随便

更新....随便

- 犯罪

最后一行是故意的注释：我首先运行之前的行，然后确保没有错误，然后仅突出显示单词 Commit 并执行它。这是因为在 Management Studio 中，您可以选择 T-SQL 的一部分并只执行选定的部分。

有几个优点： 隐式事务也有效，但它不是 SQL Server 的默认设置，因此您必须记住打开它或设置选项来执行此操作。此外，如果它一直处于开启状态，我发现人们很容易“忘记”并让未提交的事务处于打开状态，这可能会阻止其他人。这主要是因为它不是默认行为，SQL Server 的人不习惯它。

# sql-server-2005 - 如何更改 SQL2005 中脚本对象文件的文件命名约定？

> ID：360569
> 
> 赞同：0
> 
> 时间：2008-12-11T19:28:42.777
> 
> 标签：sql-server-2005, tsql

SQL Server 2005 Express Edition SP2 支持将对象编写成单独的文件。默认情况下，文件名包括对象所有者的名称、SQL 对象的名称和对象类型。例如，dbo.Employee.Table.sql 或 dbo.GSP_EmployeeUpdate.StoredProcedure.sql。尽管这种命名约定可能有助于快速确定给定文件中的脚本，但它对文件组织没有帮助（即我不能按对象类型排序。）因此，我想更改文件命名约定。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T13:03:20.737

我不知道这样的定制是否可行，但是使用这样的小[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)怎么样：

```
 ls | % {rni -path $_.Name -new ($_.name.Split('.')[0] + "." + $_.name.Split('.')[2] + "." +$_.name.Split('.')[1] + "." +$_.name.Split('.')[3])} 
```

也许有人可以提供更好的片段？

# web-services - LinkageError: 使用 resteasy 在 Websphere6.1 中链接 javax/xml/namespace/QName 时违反加载程序约束

> ID：360590
> 
> 赞同：1
> 
> 时间：2008-12-11T19:35:32.420
> 
> 标签：web-services, websphere

进行 Web 服务调用时出现此错误。我想不出一个解决方法。任何帮助是极大的赞赏。

我拥有的相关库是：axis-1.3.jar
axis-jaxrpc-1.3.jar
axis-saaj-1.3.jar
axis-wsdl4j-1.5.1.jar

jaxb-api-2.1.jar jaxb-impl-2.1.8.jar jaxen-1.1-beta-9.jar jaxrs-api-1.0-beta-9.jar

在 websphere 61 中，管理员设置如下：企业应用程序 -> WAR 类加载器模式：PARENT_LAST * Web 模块：-> 类加载器模式：application_FIRST

原因：java.lang.LinkageError：在 com.sun.xml.bind.v2.model.impl.RuntimeBuiltinLeafInfoImpl.(RuntimeBuiltinLeafInfoImpl.java:224) 处链接 javax/xml/namespace/QName 类时违反了加载程序约束。 .xml.bind.v2.model.impl.RuntimeTypeInfoSetImpl.(RuntimeTypeInfoSetImpl.java:61) 在 com.sun.xml.bind.v2.model.impl.RuntimeModelBuilder.createTypeInfoSet(RuntimeModelBuilder.java:127) 在 com.sun。 xml.bind.v2.model.impl.RuntimeModelBuilder.createTypeInfoSet(RuntimeModelBuilder.java:79) 在 com.sun.xml.bind.v2.model.impl.ModelBuilder.(ModelBuilder.java:152) 在 com.sun.xml .bind.v2.model.impl.RuntimeModelBuilder.(RuntimeModelBuilder.java:87) 在 com.sun.xml.bind.v2.runtime.JAXBContextImpl.getTypeInfoSet(JAXBContextImpl.java:432) 在 com.sun.xml.bind。 v2.runtime.JAXBContextImpl。(JAXBContextImpl.java:297) 在 com.sun.xml.bind.v2.ContextFactory.createContext(ContextFactory.java:139) 在 com.sun.xml.bind.v2.ContextFactory.createContext(ContextFactory.java:117) 在sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 在 java.lang.reflect.Method。在 javax.xml.bind.ContextFinder.find(ContextFinder.java:372) 在 javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:211) 在 javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:211) 调用(Method.java:585) .newInstance(JAXBContext.java:574) 在 org.jboss.resteasy.plugins.providers.jaxb.JAXBContextWrapper.(JAXBContextWrapper.java:74) 在 org.jboss。resteasy.plugins.providers.jaxb.JAXBContextWrapper.(JAXBContextWrapper.java:99) at org.jboss.resteasy.plugins.providers.jaxb.XmlJAXBContextFinder.createContextObject(XmlJAXBContextFinder.java:48) at org.jboss.resteasy.plugins.providers .jaxb.AbstractJAXBContextFinder.createContext(AbstractJAXBContextFinder.java:114) 在 org.jboss.resteasy.plugins.providers.jaxb.XmlJAXBContextFinder.findCachedContext(XmlJAXBContextFinder.java:39) 在 org.jboss.resteasy.plugins.providers.jaxb.AbstractJAXBProvider .findJAXBContext(AbstractJAXBProvider.java:49) at org.jboss.resteasy.plugins.providers.jaxb.AbstractJAXBProvider.getMarshaller(AbstractJAXBProvider.java:112) at org.jboss.resteasy.plugins.providers.jaxb.AbstractJAXBProvider.writeTo(AbstractJAXBProvider .java:88) 在 org.jboss.resteasy.client.core。MessageBodyParameterMarshaller$ClientRequestEntity.(MessageBodyParameterMarshaller.java:88) at org.jboss.resteasy.client.core.MessageBodyParameterMarshaller.buildRequest(MessageBodyParameterMarshaller.java:51) at org.jboss.resteasy.client.core.ClientInvoker.invoke(ClientInvoker.java :197) at org.jboss.resteasy.client.core.ClientProxy.invoke(ClientProxy.java:46) at $Proxy51.updateAccount(Unknown Source) at com.amg.brides.wedsimple.client.WedSimpleClientImpl.updateAccount(WedSimpleClientImpl. java:72) 在 com.amg.brides.wedsimple.web.AbstractWedSimpleAccountEvent.execute(AbstractWedSimpleAccountEvent.java:35) 在 com.amg.com.amg.brides.wedsimple.web.WedSimpleUpdateAccountEvent.invokeClient(WedSimpleUpdateAccountEvent.java:24) .brides.util.WebEventProcessor.processEvents(WebEventProcessor.爪哇：29）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-11T20:23:01.577

基本问题是您正在从不正确的 jar 加载一个或多个与 xml 相关的类文件。您的应用程序服务器不允许您更改这些库，因为它已经从不同的实现加载了大部分解析器。我试图检查寻找 javax/xml/namespace 的 jar 文件的内容，但中途停止了。如果你找到它，你很有可能得到一个没有违规课程的课程。众所周知，人们会从外部 jar 中手动删除此类文件。

您可能可以打开 som vm 选项以在容器运行时记录类加载。这是 java -verbose:class 选项。

对不起，我无法确定确切的问题；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-12T10:50:46.813

**可能的解决方案（为我工作）**

在 Websphere 7 中，轴 1.3 和 1.4 有同样的问题 我已经解决了从 WEB_INF\lib 中的 axis-jaxrpc-1.3.jar 中删除 QName.class

这是因为 QName.class 已经存在于其他 jar 文件中。

# delphi - 我需要在派生类的构造函数声明之后放置重载或覆盖词吗？

> ID：360597
> 
> 赞同：8
> 
> 时间：2008-12-11T19:36:38.313
> 
> 标签：delphi, inheritance, constructor

我有一个类层次结构，这个：

```
type
TMatrix = class
    protected
      //...
    public
      constructor Create(Rows, Cols: Byte);
    //...
type
  TMinMatrix = class(TMatrix)
    private
      procedure Allocate;
      procedure DeAllocate;
    public
      constructor Create(Rows, Cols: Byte);
      constructor CreateCopy(var that: TMinMatrix);
      destructor Destroy;
  end; 
```

如您所见，派生类和基类构造函数都具有相同的参数列表。我从派生的一个显式调用基类构造函数：

```
constructor TMinMatrix.Create(Rows, Cols: Byte);
begin
   inherited;
   //...
end; 
```

Delphi中是否需要显式调用基类构造函数？可能我需要超载或覆盖以清除我打算做什么？我知道如何在 C++ 中做到这一点——只有当你想向它传递一些参数时，你才需要显式调用基类构造函数——但我在 Delphi 编程方面没有太多经验。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-11T20:04:23.610

据我所知，这里有两个不同的问题：

### 确保子类的构造函数调用基类的构造函数

您必须*显式*调用基类的构造函数：

```
constructor TMinMatrix.Create(Rows, Cols: Byte);
begin
   inherited;
   //...
end; 
```

### 确保子类的构造函数覆盖基类的构造函数

您*还*必须创建子类的构造函数`override`和基类的构造函数`virtual`，以确保编译器看到两者之间的关系。如果您不这样做，编译器可能会警告您 TMinMatrix 的构造函数“隐藏”了 TMatrix 的构造函数。所以，正确的代码是：

```
type
TMatrix = class
    protected
      //...
    public
      constructor Create(Rows, Cols: Byte); virtual;    // <-- Added "virtual" here
      //...
type
  TMinMatrix = class(TMatrix)
    private
      //...
    public
      constructor Create(Rows, Cols: Byte); override;   // <-- Added "override" here
      constructor CreateCopy(var that: TMinMatrix);
      destructor Destroy; override;                     // <-- Also make the destructor "override"!
  end; 
```

请注意，您还应该使您的析构函数`override`。

### 引入具有不同参数的构造函数

请注意，您只能覆盖具有相同参数列表的构造函数。如果子类需要不同参数的构造函数，并且你想防止基类的构造函数被直接调用，你应该写：

```
type
TMyMatrix = class(TMatrix)
//...
public
  constructor Create(Rows, Cols, InitialValue: Byte); reintroduce; virtual;
//...
end

implementation

constructor TMyMatrix.Create(Rows, Cols, InitialValue: Byte);
begin
  inherited Create(Rows, Cols);   // <-- Explicitly give parameters here
  //...
end; 
```

我希望这能让事情更清楚......祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T20:07:08.237

重载，告诉编译器一个方法同名但参数不同。

Override，告诉编译器一个方法覆盖它在基类中声明的虚拟或动态。

重新引入，将隐藏基类中声明的虚拟或动态方法。

这些定义来自 Ray Lischner 的书 {Delphi in a nutshell}

```
type
  TFirst = class
  private
    FValue: string;
    FNumber: Integer;
  public
    constructor Create(AValue: string; ANumber: integer);

    property MyValue: string read FValue write FValue;
    property MyNumber: Integer read Fnumber write FNumber; 
  end;

  TSecond = class(TFirst)
  public
    constructor Create(AValue: string; ANumber: Integer);
  end;

constructor TFirst.Create(AValue: string; ANumber: integer);
begin
  MyValue := AValue;
  MyNumber := ANumber;
end;

{ TSecond }

constructor TSecond.Create(AValue: string; ANumber: Integer);
begin
  inherited;
end; 
```

声明的 TSecond 将调用 TFirst 的创建，如果没有继承，TSecond 成员将保持为空。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T18:42:08.680

您需要显式调用继承的方法；德尔福不会为你做这件事。这是设计使然，因为在某些情况下您正在使用虚拟方法，例如，当您不想调用继承的行为时。

另外，出于个人喜好，我喜欢完整地写出继承的调用。(**继承**Create(Rows, Cols); 而不是仅仅**继承;**原因很简单：它使遍历代码变得更加容易。如果你写出了一个方法调用，你可以控制并单击它并获取到祖先方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T20:02:34.940

如果两个构造函数具有相同的名称，则它们需要重载。

```
type
  TMatrix = class
  protected
    //...
  public
    constructor Create(Rows, Cols: Byte);
    //...
type
  TMinMatrix = class(TMatrix)
  public
    constructor Create(Rows, Cols: Byte); overload;
    constructor Create(var that: TMinMatrix); overload;
  end; 
```

调用继承的构造函数是个好习惯。

```
constructor TMinMatrix.Create(Rows, Cols: Byte);
begin
   inherited Create(Rows, Cols); // Need to call the full name if the parameters are changed.
   //...
end; 
```

# python - unicode 字符串中的正则表达式

> ID：360600
> 
> 赞同：1
> 
> 时间：2008-12-11T19:37:45.317
> 
> 标签：python, regex

我有一些我想使用正则表达式清理的 unicode 文本。例如，我有 u'(2' 的情况。这是因为出于格式化原因，右括号最终出现在相邻的 html 单元格中。我对这个问题的最初解决方案是向前看下一个单元格的内容并使用字符串函数确定它是否持有结束括号。我知道这不是一个很好的解决方案，但它有效。现在我想修复它，但我似乎无法使正则表达式工作。

```
missingParen=re.compile(r"^\(\d[^\)]$") 
```

我对我认为我在做什么的理解：
^ 在我想要找到的字符串的开头
（一个开放的括号，括号必须是反斜杠，因为它是一个特殊字符
\d 我也想找到一个数字
[ I正在创建一个特殊字符类
^ 我不想找到后面的内容），它是 字符串末尾的
近括号$

当然，情节变厚了我做了一个愚蠢的假设，因为我放置了一个 \d 我找不到 (33 但我错了，所以我在正则表达式中添加了一个 {1} 并没有帮助，它匹配 (3333,所以我的问题比我想象的要复杂。我希望字符串只是一个开放的括号和一个数字。这是更聪明的方法吗

```
missingParen=re.compile(r"^\(\d$") 
```

并注意 S Lott _我已经将其标记为初学者，因此您无法获得任何便宜点并不是说我不欣赏您的见解我一直想读您的书，它可能有答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T20:13:47.193

好吧，很抱歉使用这个意识流思维刺激器，但写出我最初的问题似乎让我走上了这条道路。在我看来，这是我正在尝试做的事情的解决方案：

```
 missingParen=re.compile(r"^\(\d$") 
```

# python - 哪个 GUI 工具包最适合 Windows 和 Linux 中的 Python 本地 LAF？

> ID：360602
> 
> 赞同：4
> 
> 时间：2008-12-11T19:38:02.197
> 
> 标签：python, windows, linux, native, gui-toolkit

我需要决定一个 GUI/Widget 工具包与 Python 一起用于一个新项目。目标平台将是带有 KDE 和 Windows XP（可能还有 Vista）的 Linux。哪个 Python GUI 工具包看起来最好并且与运行时平台的本机外观和感觉一致？

如果可能，请列举建议工具包的优点和缺点。

谢谢，

路易斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T01:48:15.303

Wx 的 Python 绑定非常强大，因为至少有一个核心开发人员本身就是一个 Python 人。WxWdgets 是健壮的、经过时间证明的稳定、成熟的，但也不仅仅是 GUI。甚至在 WxPython 中也遗漏了很多东西——因为 Python 本身已经提供了这一点——你可能会发现这对你的项目来说更加方便。Wx 是最快的，尤其是在 Win 上，因为它可以渲染操作系统，是的，WxLicense 是事实上的 LGPL。使用 XRC，您还可以像 Glade 一样将您点击到一个 UI，您可以通过不同的项目和语言重用该 UI。我使用 Wx 的一个主要原因是快速且有帮助的邮件列表，从未见过激烈的争吵，你甚至经常从那里的核心开发人员那里得到答案，比如臭名昭著的 vadim zeitlin++。Wx 唯一的缺点是曾经从 MS MFC 发展而来的 API，并且仍然有其较暗（不优雅）的角落，

QT 做了一些不错的事情，特别是扭曲了语言，但在 python 下不算数。他们还发明了许多额外的小部件。在 wx 中，您还结合了更复杂的小部件，例如用于配置对话框的小部件，但这并没有 QT 中的那么远。

你当然可以使用 GTK。在linux下与Wx几乎没有区别，但在win下有点陌生和慢。但也是免费的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T00:33:32.147

对于 KDE 和 Windows，[Qt](http://www.trolltech.com/)是最佳选择。Qt 也适用于 Gnome/Windows，但在这种情况下，您可能更喜欢[WxWidgets](http://wxwidgets.org)。

python的Qt绑定在[这里](http://www.riverbankcomputing.co.uk/software/pyqt/intro)。

请记住，对于封闭源代码开发，您需要 Qt 许可证*和*PyQt 许可证。对于开源它应该是免费的，但我对 PyQt 许可不是很熟悉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T05:49:18.610

就像其他人说的那样，PyQt 或 wxPython ......两者之间的技术差异或多或少是想象的 - 这是您对重要工具包的舒适度的问题，真的。

# vb.net - 使用 LINQ to SQL 处理“类型”表的最佳方法是什么？

> ID：360607
> 
> 赞同：3
> 
> 时间：2008-12-11T19:38:30.527
> 
> 标签：vb.net, linq-to-sql, enums

我有一些代表各种类型的表格。它们通常只包含一个 ID (int) 和一个名称。理想情况下，我会把它放在一个枚举中。有没有办法将这样的表映射到枚举上？

编辑：如果除了 ID 和 Name 之外还有其他字段，我将如何处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T20:13:11.453

如果它只是一个 id 和一个名字，我通常会这样做：

```
public enum FootScent : int
{
Unknown = 0,
Mild = 1,
Sweaty =2,
SteppedInSomething = 3
} 
```

然后在 LINQ 实体属性上：

```
[Column("foot_scent_id", DbType = "Int NOT NULL")]
public FootScent Scent { get; set; } 
```

对于需要“id”和“name”以外的列的查找表，我通常只为它们创建一个普通的 LINQ 实体，尽管根据您的实现，可能值得缓存这些以最大程度地减少对 DB 的访问。

# asp.net - 您实施/使用 WebDAV 的经验是什么？

> ID：360609
> 
> 赞同：6
> 
> 时间：2008-12-11T19:38:45.597
> 
> 标签：asp.net, windows, macos, filesystems, webdav

对于当前的项目，我正在考虑实施 WebDAV 来呈现客户可以访问的虚拟文件存储。到目前为止，我只做过谷歌研究，但看起来我只需要实现两种方法就可以逃脱：

```
GET, PROPFIND 
```

我认为这很棒。不过我只是好奇。如果我想通过以下方式实现文件上传：

```
PUT 
```

我还没有实现它，但它似乎很简单。我唯一担心的是，如果用户使用标准 Vista Explorer 或 OSX Finder，是否会为用户显示进度表。

我想我正在寻找一些有 WebDAV 经验的人的故事。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T11:29:02.107

对于许多 WebDAV 客户端，甚至对于只读访问，您还需要支持 OPTIONS。如果要支持上传，显然需要 PUT，并且某些客户端（MacOS X？）将需要锁定支持。

（顺便说一句，[RFC 4918](http://www.webdav.org/specs/rfc4918.html)是权威的信息来源）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T03:25:52.663

聚会有点晚了，但我已经实现了大部分 webdav 协议，我可以自信地告诉你，你需要实现大部分协议。

对于 OS/X，您需要 class-2 WebDAV 支持，其中包括 LOCK 和 UNLOCK（我发现完全实现 http If: 标头特别困难，但对于 Finder，您只需要一点。）

以下是我个人的一些发现：

[http://sabre.io/dav/clients/windows/](http://sabre.io/dav/clients/windows/) [http://sabre.io/dav/clients/finder/](http://sabre.io/dav/clients/finder/)

希望这可以帮助

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-09-23T19:43:11.523

我在大约一天的工作中实现了大部分 WebDAV 协议：http: [//github.com/nfarina/simpledav](http://github.com/nfarina/simpledav)

我用 Python 编写了它以在 Google App Engine 上运行，我希望任何其他语言都会做出类似的努力。总而言之，它大约是两页代码。

我实现了以下方法：OPTIONS、PROPFIND、MKCOL、DELETE、MOVE、PUT、GET。到目前为止，我已经测试了 Transmit 和 Cyber​​duck，两者都很好用。

希望这可以为下一个对实现 WebDAV 服务器感兴趣的人提供一些指导。这不是一个困难的协议，它只是非常密集的抽象语言，如“深度”和“集合”等等。

这是规范：[http ://www.webdav.org/specs/rfc4918.html](http://www.webdav.org/specs/rfc4918.html)

但理解协议的最佳方式是观察客户端与工作服务器的交互。我使用 Transmit 连接到 Box.net 的 WebDAV 服务器并使用 Charles Proxy 监控流量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T19:48:58.507

如果您在 Tomcat 下运行 Apache Jackrabbit，则可以将其配置为提供 WebDAV 并存储上传的文件。也许这将是一个有用的模型，甚至是计划实施的足够好的替代品。

[Apache Jackrabbit 对 WebDAV 的支持](http://jackrabbit.apache.org/jackrabbit-webdav-library.html)

此外，您可能想了解 BitKinex 客户端（30 天免费试用），我发现它是测试 WebDAV 服务器的有用工具。

[BitKinex 主页](http://www.bitkinex.com/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-11T19:56:03.987

我们在内部使用 WebDAV 为防火墙外的客户端提供基于文件夹的某些文件共享视图。我们为此使用 IIS6。

基本上，它归结为在 IIS 中创建一个虚拟目录，该目录映射到您希望通过 WebDAV 提供的每个网络文件系统。使用来自“位于另一台计算机上的共享”的内容进行设置——使用共享的 UNC 路径作为网络目录值。我们打开除索引此资源之外的所有选项。禁用所有默认内容页面。打开 Windows 集成身份验证（我们也使用 SSL 设置）。我将 root 设置为拒绝访问匿名用户并允许访问任何经过身份验证的用户。我们还有一个通配符 MIME 映射（.* 到 application/octet-stream）。在 IIS 中启用 WebDAV Web 服务扩展。您还需要设置 Web 服务器以将权限委派给您可能正在访问的所有文件服务器，以便它可以传递用户的凭据。

如果您有 Macintosh 客户端，您可能还需要一个 ISAPI 过滤器，用于将 Darwin 客户端的 401 映射到 403 错误。当您没有写入目录的权限时，Microsoft 和 Apple 在如何处理这种情况上存在分歧。Apple 不断重新发送 401（拒绝访问）错误的凭据，将其转换为 403（禁止访问）错误可防止这种情况发生。默认情况下，Apple 喜欢在它访问的每个目录中写入一个“点”文件。如果您没有过滤器，则浏览您没有写入权限的目录最终会导致 Finder 崩溃。如果需要，我有这方面的源代码。

**这一切都在我的脑海中。有可能（可能？）我可能错过了一些东西。如果您有任何问题，请随时通过我网站上的联系信息与我联系。**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T11:42:07.703

我们的基于 Web 的产品上有一个 webDAV servlet。

我发现 Apache Jackrabbit 对实现它很有帮助。但是 webDav 在客户端支持上是一个严肃的 PITA。

许多客户端实现的行为差异很大，您很可能必须支持几种不同类型的错误实现。

一些示例：MS vista 仅支持通过 SSL 进行身份验证

大多数基于 Windows 的 webDAV 客户端假定您的 webdav-server/let 是一个共享点服务器，并且会相应地采取行动（因此不根据 webDAV 协议）

一个例子是您需要在服务器的根目录上允许未经身份验证的 LOCK 请求（即 yourdomain.com/ 而不是 yourdomain.com/where/webdav/should/live），否则您将无法在 MS 中获得写入权限视窗。（这是您的东西通常位于 server.com/servlets/paths/thelocation 的 Tomcat 机器上的一个严肃的 PITA）

大多数（全部？）版本的 MS Office 对 webdav 链接的响应不同。

我想我的观点是将 webdav 支持集成到现有产品中可能比您预期的要困难得多。如果可能的话，我建议使用（半）独立的 webDAV 服务器，例如 jackrabbit webdavServer 或 apache mod_webdav

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T01:33:25.317

我发现 OS X 的 Finder WebDAV 支持非常挑剔。为了获得读写支持，除了其他位之外，您还必须实现 LOCK。

我为 Postres 数据库编写了一个 WebDAV 接口，其中 python 模块以分层文件夹式结构存储在数据库中。使用 cadaver 访问它工作正常，IIRC 一个 GUI windows 浏览器也可以工作，但 Finder 拒绝将共享挂载为只读以外的任何内容。

所以，我不知道是否会给出一个进度条。我正在处理的文件足够小，以至于读取/复制它们几乎是瞬时的。我认为使用 Finder 复制一个大文件可能会提供一个进度条——它适用于任何其他类型的挂载共享。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-14T16:09:43.167

这是 WSGI WebDAV 的另一个开源项目 [http://code.google.com/p/wsgidav/](http://code.google.com/p/wsgidav/) 我在其中选择了 PyFileServer 项目。

# emacs - 是什么让你想学习 Common Lisp？你想从中得到什么？

> ID：360612
> 
> 赞同：16
> 
> 时间：2008-12-11T19:39:21.100
> 
> 标签：emacs, lisp, common-lisp

我正在为刚接触 Common Lisp 的人开发一个工具包（类似于 Live-CD Lisp-in-a-Box），我想确保它得到广泛的满足。Lisp 有什么吸引你的地方？你需要做什么/做了/会什么让你开始并保持你的兴趣？

到目前为止我所拥有的：SBCL 10.22、Emacs 22.3、SLIME 和 LTK 捆绑在一起并配置在完全引导到 RAM 的 Linux live-CD 上。

* * *

我现在已经发布了这个结果；它可在[Thnake 网站上找到](http://www.jasonfruit.com/thnake)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-11T20:09:49.323

我至少会包括 cl-ppcre、clx、Hunchentoot 和 Weblocks。

我想您将不得不与各自的作者协商，但包括“On Lisp”、“Practical Common Lisp”和“Successful Lisp”对于 CD 来说是一笔巨大的财富。

真正好的是将 stumpwm 用作 Live CD 上的窗口管理器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-11T23:05:52.933

Emacs 几乎阻止了我学习 Common Lisp。费了很大的力气才熬过去。Emacs 和 SLIME 对初学者来说太多了，永远不会让初学者广泛满意。如果我想学习一门新的编程语言，我希望在我学习它的同时，其他一切都不会妨碍我。学习 Lisp 的任务已经够难了，没有额外的技术细节和设置环境的复杂性。隔离变量。

[使用rlwrap](http://utopia.knoware.nl/~hlub/uck/rlwrap/)或等效工具设置 SBCL 。rlwrap 支持非常基本的括号匹配和历史搜索，甚至可以进行制表符补全。不像 SLIME 那样花哨，但初学者不需要 SLIME。初学者需要能够在`hello-world`不花费一个小时与 Emacs 对抗的情况下运行。提供 Emacs/SLIME 作为选项，但不是必需的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-11T19:48:43.953

[我的建议是包括一个像Hunchentoot](http://www.weitz.de/hunchentoot/)这样的 HTTP 服务器和一个流行的 Web 框架。我怀疑现在大多数想学习 Lisp 的人都是因为阅读了 Paul Graham，并且想模仿他在构建 Viaweb 方面的成功，因此能够轻松创建和修改强大的 Web 应用程序将是您生活的一个强大卖点光盘。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T14:40:09.137

当然，包括 Emacs，但您可能想要更温和的东西。

我发现最容易进入的 Lisp 环境是带有 FRED 编辑器的 Macintosh Common Lisp（Fred Resembles Emacs Deliberately）。Digitool 没有成功进入当前的 Mac 时代，但他们在折叠时开源了很多东西。试试 www.clozure.com 或在 Google 上搜索“openmcl”。

有一个项目让 Fred 环境在 Openmcl 上运行，但我不知道状态（我很长时间没有用 Lisp 做过任何事情，也没有关注邮件列表）。

所以，我的建议：

询问 Paul Graham 是否可以包含“On Lisp”。由于他免费提供下载，他很可能会给予许可。（他的另一本优秀的 Lisp 书，“ANSI Common Lisp”，显然仍在销售，所以他不太可能在那儿给你许可。）

至少检查一下 MCL 的东西，看看是否有什么可以让它变得更容易。Emacs 是一个很棒的 Lisp 环境，但是对于初学者来说有点吓人。

我最近没有看过 SBCL 文档。它是否相当易读且对初学者友好？也许有人可以写一些关于如何开始和如何调试的快速说明。首先强调鼠标的使用，即使使用 Emacs。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-11T23:11:20.893

真正让我对 Common Lisp 感兴趣的是 .net 或 Java 级别的一组现代库，以及一些非常好的文档。在软件方面，一个不错的*gui*编辑器沿着 notepad++ 或 jEdit 行会很好。Emacs/vi 和基于文本的编辑器对于严肃的开发来说总是显得古怪而陈旧。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-11T21:28:40.290

clbuild ( [http://common-lisp.net/project/clbuild](http://common-lisp.net/project/clbuild) ) 中的所有内容都应该是一个很好的候选对象。顺便说一句，您列表中除 Emacs 之外的所有软件包也由 clbuild 管理。我认为，如果 clbuild 中的项目集合能够为标准通用 lisp-library-hood 收集一些动力，那就太好了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-11T21:12:36.687

阅读[Paul Graham](http://paulgraham.com/)让我想学习 Common Lisp。但如果我真的坐下来尝试学习它，这种冲动就会消退。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-12T14:16:41.803

Emacs 确实有一点学习曲线，但它非常适合认真的开发——在（基于文本的）代码的方式中没有讨厌的鼠标驱动的 gui bling。

这些天启用了开箱即用的 CUA 模式（因此 Cx、Cc、Cv 工作“标准”），并且有一个带有文件操作的菜单，如保存等，所以它不应该那么难slog，如果它都是预先包装好的。*但是预先配置 .emacs 文件以*确保启用 CUA 模式，SLIME 不必由用户配置等是必须的 - 加上为 .emacs 配置的用户提供更多文档 - 链接到 EmacsWiki等（hrm，如果这是在 CD 上，用户不太可能自己配置它，不是吗....）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-11T19:45:35.520

这样做：

[http://www.joelonsoftware.com/articles/ThePerilsofJavaSchools.html](http://www.joelonsoftware.com/articles/ThePerilsofJavaSchools.html)

当然，我还想了解更多 Python 3.0、erlang 和 F#。我相信函数式语言（并不是说 Python 是一种函数式语言）只是提供了不同的视角。您拥有的视角越多，您可以构建的解决方案就越好。这也是为工作使用正确的工具，但如果您至少不熟悉某些东西，您可能永远不会想到使用特定工具解决问题。我想这可以追溯到那句老话，对木匠来说，一切看起来都像钉子。当有更好的解决方案可用时，我不想在所有事情上都使用 C#。此外，时代变迁，时尚也随之而来。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-02-08T18:51:31.290

我对学习 Lisp 有点兴趣，但我不“喜欢”大多数可用资源。为了使 Common Lisp 更流行和更容易学习，如何将这个项目扩展到创建某种负责提供教程或其他东西的“社区”？坏/奇怪/无用的想法？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-17T08:59:33.683

你当然也应该添加 Vim，配置[RainbowParenthsis](http://www.vim.org/scripts/script.php?script_id=1561)插件。

SBCL 的 rlwrap 是一个好主意，（需要 :sb-aclrepl）也是如此。

Weblocks 应该带有 cl-prevalence，也可能带有 Elephant/BDB。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-18T22:11:36.473

我认为包括教程的想法是一个很好的想法。

除了已经提到的那些之外，还有最简单的关于 lisp 的新手书（符号计算的简单介绍）和一些隐藏在网络上的**优秀**网站，人们应该知道这些网站。他们来了：

*   [符号计算的简要介绍](http://www.cs.cmu.edu/~dst/LispBook/index.html)
*   [学习 Lisp](http://www.cs.sfu.ca/CC/310/pwfong/Lisp/)
*   [施法](http://lisperati.com/casting.html)
*   [快速学习 Lisp](http://cs.gmu.edu/~sean/lisp/LispTutorial.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-21T17:05:44.290

据我了解，你正在做 Thnake。

感谢您提供出色的现场发行版！

几天前我尝试过，发现它相当令人印象深刻和有趣。

它显然缺少一些东西，例如[LTK](http://www.peter-herth.de/ltk/) ，因为您已经包含了 Common Lisp 和 Tcl/Tk。并且由于有 gtk，您可以包含 CL 和 Python 的绑定和文档。

Lisp Hyperspec 中也需要预先配置 Slime 来使用它。（对于 Python 和 Tcl 的文档也是如此）可能最好添加[emacs-w3m](http://www.emacswiki.org/emacs/emacs-w3m)以便快速方便地浏览文档。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-23T20:35:03.977

[总有 Practical Common Lisp](http://gigamonkeys.com/book/)，一本关于 Common Lisp 的书，可以在网上完整阅读。还有一个带有 CL 实现的 Emacs 包装，旨在与本书一起使用。

# sql - mysql - 在另一个查询中嵌入计数查询

> ID：360615
> 
> 赞同：1
> 
> 时间：2008-12-11T19:40:26.433
> 
> 标签：sql, mysql, nested-queries

在 postgres 我相当确定你可以做这样的事情

```
SELECT
  authors.stage_name, 
  count(select id from books where books.author_id  = authors.id) 
FROM
  authors,
  books; 
```

本质上，在这个例子中，我想在同一个查询中返回一个作者列表以及每个作者写了多少本书。

这可能吗？我怀疑这种方法相当幼稚..

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T19:51:37.053

好吧，一方面，它将所有作者的笛卡尔积返回到所有书籍，而不管该作者是否写了那本书。

以下是我编写查询以获得您想要的结果的方式：

```
SELECT a.stage_name, COUNT(b.id)
FROM authors a
  LEFT OUTER JOIN books b ON (a.id = b.author_id)
GROUP BY a.id; 
```

如果您使用 SQL，则需要学习如何编写连接查询。连接之于 SQL，就像循环之于应用程序编程语言一样。即，它是您需要了解的基本编程结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T19:51:27.847

如何使用连接：

```
SELECT authors.stage_name, count(*) 
FROM authors INNER JOIN books on books.author_id = authors.id
GROUP BY authors.stage_name 
```

# database - 使用 Web 服务来保护数据库

> ID：360625
> 
> 赞同：4
> 
> 时间：2008-12-11T19:44:38.003
> 
> 标签：database, web-services, security

有一些谣言说我公司的团队很快就会使用 Web 服务进行所有未来的应用程序开发。架构应该是这样的：

应用程序 --> Web 服务 --> 数据库

其背后的既定理由是安全性。这听起来像是在浪费大量时间，如果有什么好处的话。我的问题是，Web 服务在哪些方面使您的数据比数据库更安全？我认为，如果攻击者想要获取您的所有数据并且已经进入应用服务器，那么弄清楚应用程序如何获取它的数据将是相当简单的。

请记住，这些 Web 服务将纯粹用于数据，几乎没有业务/验证逻辑，并且也将超出应用程序开发人员的控制范围（至少这是它与所有以前使用 Web 的应用程序一起工作的方式）服务）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-11T20:01:22.710

Web 服务的一个重要方面是互操作性，以便以后来自不同平台的不同应用程序可以使用服务和数据。这样做会使您的公司受益匪浅。而且您对安全性的看法是正确的，这绝对是使用 Web 服务而不是公开数据库的公共端点的好理由之一，这很危险！

Web 服务可以访问您的数据，例如，您的数据可以通过 javascript 在浏览器中访问。无法直接在 Javascript 中访问服务器上的数据库。

总而言之，去吧，这是正确的做法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-11T20:02:16.203

如果 Web 服务上确实没有业务逻辑或验证，那么添加额外的抽象层只会带来有限的安全优势。我说有限是因为您的应用程序和数据库之间的接口仍然比它们直接相互通信时更加有限。

如果您将验证和业务逻辑添加到等式中，则会有显着的安全优势，因为有权访问应用程序帐户的任何人都只能执行应用程序能够执行的数据库操作。此外，这是一个更好的设计，因为它减少了应用程序与数据如何存储在数据库中的实现细节之间的耦合。如果您想更改数据库模式，您只需要更新 Web 服务，而不是整个应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T20:05:21.767

安全论点有问题；对 Web 服务进行身份验证与对数据库进行身份验证没有什么不同

一般来说，将数据库操作转移到 Web 服务和 SOA 是有正当理由的，但安全性不是其中之一

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T19:48:31.643

如果您希望使用 Web 服务，那么在将数据发送到数据库时也会使用某种队列。如果您使用的是 Web 服务和队列组合，那么安全性就会到位，丢失数据的可能性会更小。如果您没有 web 服务和队列组合，如果您将数据发送到数据库并且它永远不会到达那里，那么您就不会让它消失。

你是对的，但如果有人想闯入你的系统，webservice 不会有任何帮助，如果你公开 webservice 并且他们找到你的 webservice 的名称可能会使情况变得更糟，因为这样他们就可以使用 webservice 查询你的数据库您服务器上的任何安全功能都会认为是您的应用程序获取信息。

# javascript - 将 xsl 嵌入到 XML 文件中

> ID：360628
> 
> 赞同：6
> 
> 时间：2008-12-11T19:45:28.173
> 
> 标签：javascript, xml, internet-explorer, xslt, embed

我正在尝试将 xsl 嵌入到 XML 文件中。这样做的原因是创建一个可以移动到不同计算机的单个文件，这将避免移动 xsl 文件的需要。

xsl 文件正在创建一个表并从 xml 中获取一个测试步骤，以及它是通过还是失败，非常简单。
我认为，我遇到的问题是 xsl 有 javascript，并且在 IE 中加载 xml 时会显示它。

当我用 IE 加载 xml 文件时，javascript 显示在表格上方，而 xml 显示在表格下方。

这是我的文档的布局方式：

```
<!DOCTYPE doc [
<!ATTLIST xsl:stylesheet
  id    ID  #REQUIRED>
]>

<doc>    

<xsl:stylesheet id="4.1.0" 
    version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" 
    xmlns:user="http://www.ni.com/TestStand" 
    xmlns:vb_user="http://www.ni.com/TestStand/" >

<xsl:template match="xsl:stylesheet" />
     <xsl:text disable-output-escaping="yes">

    <msxsl:script language="vbscript" implements-prefix="vb_user">
        option explicit
        'This function will return the localized decimal point for a decimal number
        Function GetLocalizedDecimalPoint ()
            dim lDecPoint
            lDecPoint = Mid(CStr(1.1),2,1)
            GetLocalizedDecimalPoint = lDecPoint
        End Function
    </msxsl:script>
    <msxsl:script language="javascript" implements-prefix="user"><![CDATA[
        // This style sheet will not show tables instead of graphs for arrays of values if 
        // 1\. TSGraph control is not installed on the machine
        // 2\. Using the stylesheet in windows XP SP2\. Security settings prevent stylesheets from creatign the GraphControl using scripting. 
        //     Refer to the TestStand Readme for more information.

//more javascript functions
//code to build table and insert data from the xml

</xsl:stylesheet>

<Reports>
<Report Type='UUT' Title='UUT Report' Link='-1-2008-12-3-10-46-52-713' UUTResult='Failed' StepCount='51'>

// rest of xml

</Report>

</Reports>
</doc> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T22:28:25.207

[**尽管 W3C XSLT Spec 支持将 XSLT 样式表嵌入**](http://www.w3.org/TR/xslt#section-Embedding-Stylesheets)XML 文档，但 IE 和 Firefox 似乎不支持这一点。

**更新**：根据 Robert Niestroj 的评论，多年后，2014 年 10 月，这适用于 FireFox 33。

**但是，有一个很好的选择：将 XML 文档嵌入到 XSLT 样式表**中。

下面是一个例子。

**包含嵌入式 XML 文档的 XSLT 样式表**：

```
<?xml-stylesheet type="text/xsl" href="myEmbedded.xml"?>
<xsl:stylesheet 版本="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:输出省略-xml-declaration="yes"/>
    <xsl:变量名="vEmbDoc">
        <文档>
            <头></头>
            <正文>
                <para id="foo">你好我是 foo</para>
            </正文>
        </doc>
    </xsl:变量>
    <xsl:template match="para">
      <h1><xsl:value-of select="."/></h1>
    </xsl:模板>
    <xsl:template match="xsl:template"/>
</xsl:样式表>

```

在 IE 中打开 tis 文件时，浏览器会显示想要的结果：

# 你好我是foo

**请注意**，有必要包含忽略大多数 XSLT 指令的模板（在这种情况下，我们`<xsl:template>`通过简单地没有模板主体来忽略任何指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-25T18:29:33.237

大多数浏览器都可以嵌入样式表，但 IE 除外。在下面的帖子中找到对描述和示例的引用。

IE6/7/8 默认不支持嵌入样式表。

您可能希望使用使 IE 从此处处理嵌入式样式表的解决方法：

[http://www.biglist.com/lists/lists.mulberrytech.com/xsl-list/archives/201001/msg00390.html](http://www.biglist.com/lists/lists.mulberrytech.com/xsl-list/archives/201001/msg00390.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-28T01:34:18.080

因为您的样式表使用了 msxsl，所以之前为 IE 浏览器启用样式表嵌入的技术应该适合您。

如果您想要适用于所有浏览器的样式表嵌入，您可能需要为所有浏览器使用[样式表嵌入技术支持](http://forums.devshed.com/xml-programming-19/embedded-xslt-77694.html#post2420740)。

# flash - Flash 网络摄像头视频质量设置

> ID：360631
> 
> 赞同：0
> 
> 时间：2008-12-11T19:46:21.913
> 
> 标签：flash, video, streaming

我正在开发 Flash 中的视频流应用程序，有人告诉我我需要添加质量选择工具。要求是“低”、“中”和“高”质量。我试图弄清楚实际应用哪种质量设置（帧速率和视频质量设置）。我觉得必须为此制定某种标准，因为我经常看到这样的控件，但我无法在网上找到任何参考。

有谁知道来自网络摄像头的实时流视频的“低”、“中”和“高”质量的任何标准设置？或者甚至是一个很好的参考作为提出我自己价值观的起点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T19:58:11.517

最好只定义带宽点，然后查看您的编解码器以确定给定点的最佳质量。然后你可以给每个带宽点一个“正常”的名字。喜欢：

*   56k 是 320x240 @ 8fps 并且是“低质量”
*   256k 是 640x480 @ 8fps 并且是“中等质量”
*   512k 是 640x480 @ 24fps 并且是“高质量”

这只是我的猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T20:45:08.240

我最终提出了一些值，尽管它们可能不是标准的。

在提出这个问题后，我意识到我的需求可能不符合标准，因为我的分辨率固定为 160x120，因为这是观看视频的组件的大小。我刚刚结束了对不同设置使用 100、80 和 60 的视频质量设置。最终比我预期的要简单得多（我最初想用帧率和分辨率以及质量值来处理问题，但最终不需要它）。

# msbuild - 使用 NAnt 构建 .NET 2.0 项目

> ID：360635
> 
> 赞同：0
> 
> 时间：2008-12-11T19:48:13.767
> 
> 标签：msbuild, .net-2.0, nant

我有一个 .NET 1.1 项目，我使用以下代码段在 NAnt 中构建了该项目：

```
<property name="Refs.dir" value="Refs" readonly="false"/>
<property name="OAIDLLs.dir" value="OAI\bin\ServerDebug"/>

<solution 
   solutionfile="OAI\CC.OAI.sln" 
   configuration="ServerDebug" 
   outputdir="${OAIDLLs.dir}">

   <assemblyfolders>
      <include name="${Refs.dir}"/>
   </assemblyfolders>
</solution> 
```

现在有人将项目转换为 .NET 2.0，而 NAnt 无法再构建它了。
很容易将*解决方案*标签替换为

```
<exec program="msbuild">
    <arg value="OAI\CC.OAI.sln" />
</exec> 
```

但我不知道如何将*assemblyfolders*标记中的值传递给 msbuild。对于那些不知道的人，*assemblyfolders*标签指定了项目应该在其中查找依赖程序集的文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T00:14:46.637

可以使用 /p 开关指定其他属性。这里可能感兴趣的属性是：

> **AdditionalLibPaths** - 指定编译器应在其中查找参考程序集的其他文件夹。
> 
> **AssemblySearchPaths** - 在构建时参考程序集解析期间要搜索的位置列表。路径在此列表中出现的顺序是有意义的，因为前面列出的路径优先于后面的条目。

要使用带有 exec 任务的 msbuild 指定其他属性：

```
<exec program="msbuild">
    <arg value="OAI\CC.OAI.sln" />
    <arg value="/p:AssemblySearchPaths=c:\path1" />
</exec> 
```

[另一方面， NAntContrib](http://nantcontrib.sourceforge.net/)提供了一个[msbuild](http://nantcontrib.sourceforge.net/release/0.85/help/tasks/msbuild.html)任务。

# html - ASP.Net MVC：如何根据 url 的内容动态生成元标记？

> ID：360637
> 
> 赞同：0
> 
> 时间：2008-12-11T19:48:25.203
> 
> 标签：html, asp.net-mvc

这是想法：

当用户想要查看/controller/action 时，我希望页面有一个“robots”元标记，其值设置为“all”。当用户想要查看/controller/action?sort=hot&page=2（即它有一个查询字符串）时，我希望页面有一个“robots”元标记，其值设置为“noindex”。当然这只是一个例子，它可能是这个问题存在的另一个标签。

在 MVC 架构的哪个阶段，我可以放置一个钩子，以便视图在母版页中生成我想要的标记？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T20:06:54.697

我为生成页面标题做了类似的事情，效果很好。像往常一样将您的标签放在您的母版页中：

```
<%= Html.Encode(ViewData["Title"]) %> 
```

然后子类化`ActionFilterAttribute`并覆盖`OnActionExecuting`。从那里您可以访问控制器上下文，并可以将您的视图数据设置为您想要的任何内容。

```
public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        filterContext.Controller.ViewData["title"] = "whatever";
    } 
```

最后一步是将要使用过滤器上下文的控制器属性。如果要将属性添加到所有类，可以从基本控制器继承。如果要传递参数，也有重载。在我的应用程序中。我实际上通过了页面标题。

希望有帮助。

# file - 在同一个文件中有多个类是不好的做法吗？

> ID：360643
> 
> 赞同：87
> 
> 时间：2008-12-11T19:50:37.303
> 
> 标签：file, class, oop, language-agnostic

我曾经有一个文件一个类。例如*car.cs*有*car*类。但是当我编写更多类时，我想将它们添加到同一个文件中。例如*car.cs*有*car*类和*door*类等。

我的问题适用于 Java、C#、PHP 或任何其他编程语言。我应该尝试不在同一个文件中包含多个类还是可以？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-12-11T19:54:03.287

我认为您应该尝试将代码保持为每个文件 1 个类。

我建议这样做，因为以后更容易找到您的课程。此外，它会更好地与您的源代码控制系统配合使用（如果文件更改，那么您就知道特定类已更改）。

我认为每个文件使用多个类是正确的唯一一次是当您使用内部类时......但内部类在另一个类中，因此可以留在同一个文件中。内部类角色与外部类密切相关，因此将它们放在同一个文件中就可以了。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-11T20:03:07.917

在 Java 中，每个文件一个*公共*类是该语言的工作方式。可以将一组 Java 文件收集到一个包中。

然而，在 Python 中，文件是“模块”，通常有许多密切相关的类。Python 包是一个目录，就像 Java 包一样。

这为 Python 提供了额外级别的类和包之间的分组。

没有一个与语言无关的正确答案。它因语言而异。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-12-11T20:14:48.690

每个文件一个类是一个很好的规则，但有一些例外是合适的。例如，如果我在一个大多数类都有关联的集合类型的项目中工作，我通常会将类及其集合保存在同一个文件中，例如：

```
public class Customer { /* whatever */ }

public class CustomerCollection : List<Customer> { /* whatever */ } 
```

最好的经验法则是每个文件保留一个类，除非这开始使事情变得更难而不是更容易。由于 Visual Studio 的“在文件中查找”非常有效，因此您可能不必花费太多时间查看文件结构。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2010-01-11T19:02:28.577

不，我不认为这是一个完全不好的做法。我的意思是，一般来说，每个类最好有一个单独的文件，但肯定有很好的例外情况，最好在一个文件中包含一堆类。一个很好的例子是一组异常类，如果给定组有几十个这样的类，那么为每两个班轮类分别设置一个单独的文件真的有意义吗？我认为不是。在这种情况下，在一个类中包含一组异常就不会那么麻烦和简单了，恕我直言。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-12-11T19:54:06.877

我发现，每当我尝试将多种类型组合到一个文件中时，我总是会返回并分离它们，只是因为这样更容易找到它们。每当我结合时，总有一个时刻我试图弄清楚我定义的类型 x。

所以现在，我个人的规则是每个单独的类型（可能除了子类，这意味着类中的类，而不是继承的类）都有自己的文件。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2016-11-16T15:28:18.323

由于您的**IDE**为您提供了“**导航到”功能，并且您可以对类中的****命名空间**进行一些控制，因此在同一个文件中拥有多个类的以下好处对我来说是非常值得的。

**父子类**

在许多情况下，我发现在其**基**类文件中包含**继承**类非常有帮助。

 **然后很容易查看您的子类继承了哪些属性和方法，并且该文件提供了对整体功能的更快概述。

**公共：小 - 助手 - DTO 类**

当您需要几个**普通**和**小型**类来实现**特定功能**时，我发现拥有一个包含所有引用的文件并仅包含一个**4-8 Liner**类是非常多余的.....

**只需滚动一个文件而不是在 10 个文件之间切换，代码导航**也更容易......当您只需要编辑一个引用而不是 10 个引用时，它也更容易**重构......**

总体而言，打破**每个文件 1 个类的 Iron 规则**为组织代码提供了一些额外的**自由。**

然后会发生什么，实际上取决于您的 IDE、语言、团队沟通和组织技能。

但是，如果您想要这种自由，为什么要为铁律而牺牲它呢？

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-12-11T20:06:34.290

我一直遵循的规则是在同名文件中有一个*主类。*我可能会或可能不会在该文件中包含辅助类，具体取决于它们与文件主类的耦合程度。支持类是独立的，还是它们本身有用？例如，如果一个类中的一个方法需要一个特殊的比较来对某些对象进行排序，那么将比较函子类捆绑到与使用它的方法相同的文件中并不会打扰我。我不希望在其他地方使用它，而且它本身没有意义。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-12-11T19:55:39.400

如果您在团队中工作，将类保存在单独的文件中可以更容易地控制源并减少冲突的机会（多个开发人员同时更改同一个文件）。我认为它也可以更轻松地找到您正在寻找的代码。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-12-11T19:55:09.557

从未来的开发和可维护性的角度来看，它可能很糟糕。如果您有 Car.cs 类，则更容易记住 Car 类的位置。如果 Widget.cs 不存在，你会在哪里寻找 Widget 类？它是汽车小部件吗？它是一个引擎小部件吗？哦，也许它是一个百吉饼小部件。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-12-11T19:58:36.103

我**唯一**考虑文件位置的时候是我必须创建新类的时候。否则我*从不*按文件结构导航。我使用“去上课”或“去定义”。

我知道这在某种程度上是一个培训问题；将自己从项目的物理文件结构中解放出来需要练习。不过，这是非常有益的；）

如果将它们放在同一个文件中感觉很好，请成为我的客人。虽然不能用 java 中的公共类来做到这一点；）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-02-22T16:21:58.567

你应该避免这样做，除非你有充分的理由。

一个包含多个相关小类的文件比多个文件更具可读性。例如，当使用“案例类”来模拟联合类型时，每个类之间都有很强的关系。对多个类使用同一个文件的优点是可以为读者直观地将它们组合在一起。

在您的情况下，汽车和门似乎根本不相关，并且在 car.cs 文件中找到门类是出乎意料的，所以不要。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-11T19:58:51.827

根据经验，一个类/一个文件是要走的路。不过，我经常将多个接口定义保存在一个文件中。一个文件中有几个类？仅当它们以某种方式*非常*密切相关且非常小（< 5 个方法和成员）

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-11T20:19:28.213

就像在编程中的大部分时间一样，这在很大程度上取决于情况。

例如，所讨论的类的内聚性是什么？它们是紧密耦合的吗？它们是完全正交的吗？它们在功能上是否相关？

Web 框架提供一个通用的 widgets 并不会不合时宜。无论文件包含 BaseWidget、TextWidget、CharWidget 等。

框架的用户在定义 more_widgets 文件以包含他们从框架小部件中为他们的特定域空间派生的其他小部件时不会不合时宜。

当类是正交的并且彼此无关时，分组到单个文件中确实是人为的。假设有一个应用程序来管理一个制造汽车的机器人工厂。一个包含 CarParts 和 RobotParts 的名为 parts 的文件是毫无意义的……维修备件的订购与工厂制造的零件之间可能没有太大的关系。这种加入不会增加有关您正在设计的系统的信息或知识。

也许最好的经验法则是不要用经验法则来限制你的选择。经验法则是为第一次切割分析创建的，或限制那些无法做出正确选择的人的选择。我认为大多数程序员都愿意相信他们有能力做出正确的决定。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-01-11T19:12:15.110

Smalltalk 的答案是：你不应该有文件（用于编程）。它们使版本控制和导航变得痛苦。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-11T19:59:47.550

每个文件一个类更易于维护，并且对于其他查看您的代码的人来说更清晰。它也是强制性的，或者在某些语言中非常受限制。

例如，在 Java 中，您不能为每个文件创建多个顶级类，它们必须位于类名和文件名相同的单独文件中。

# css - 使用 css 垂直堆叠表 td 元素

> ID：360649
> 
> 赞同：5
> 
> 时间：2008-12-11T19:51:43.417
> 
> 标签：css

有没有办法垂直堆叠选定的 td 元素？我想拥有同一张桌子，尽管仅使用 css 以不同方式显示它。这可能吗，还是我必须有单独的 html 标记？我想尝试使用相同的 html 标记，尽管对不同的站点/外观使用不同的 css。

```
<table>
  <tr>
     <td class="vertical" id="one" >i'm</td>
     <td class="vertical" id="two" >above</td>
     <td class="vertical" id="three" >this</td>
     <td class="horizontal" id="four" >i'm horizontal</td>
  </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-11T20:01:35.143

您也可以让它们显示：块，但我不太确定这会对表格布局产生什么影响。

```
。垂直的{
 显示：块；
}

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-02-26T11:47:46.110

对于其他试图实现这一目标的人，出于任何奇怪的原因，您可以使用

```
.vertical{
    display:flex;
} 
```

[https://jsfiddle.net/mr5dhwj3/](https://jsfiddle.net/mr5dhwj3/)

在表格正常水平呈现但在某些情况下仅垂直呈现的响应性情况下，我需要这个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-11T19:58:33.917

您需要创建堆叠的表格

```
<table>
  <tr>
     <td class="vertical">i'm</td>
     <td class="horizontal" rowspan="3">i'm horizontal</td>
  </tr>
  <tr>
     <td class="vertical">above</td>
  </tr>
  <tr>
     <td class="vertical">this</td>
  </tr>
</table> 
```

这就是桌子的用途。如果你想使用 CSS，你必须使用 DIV。

# asp.net - How to set columns widths in a GridView control to the widest necessary width

> ID：360654
> 
> 赞同：2
> 
> 时间：2008-12-11T19:53:05.940
> 
> 标签：asp.net, gridview

I have a gridview control that can get loaded with multiple pages worth of data. When I switch pages, the columns widths will change to accommodate the largest value in the column for *that page*.

If possible, I would like to set the widths of each column to the widest necessary width for the entire dataset.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T20:56:22.070

You can set the ItemStyle-Width property on each TemplateField, BoundField, etc. in your gridview to whatever you want. That should hold across paging. You will want to either not set the gridview width, or be sure you don't use a percentage if you do.

If you want to figure this out dynamically, you will have to examine your data first, before binding your grid, figure out the width that you want, then bind your gird and dynamically set the ItemStyle-Width in the RowDataBound event of the gridview.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-25T22:13:31.790

Tring things, in the edit colum menu of your grid you should try the auto size mode, I configure my to cell and it work pretty well for my needs..

This is available when you are not autogenerating the columns.

Try it.

# mysql - 如何从已处理的查询中获取有关已使用表的信息？

> ID：360658
> 
> 赞同：1
> 
> 时间：2008-12-11T19:54:32.803
> 
> 标签：mysql, get

以前的程序员给我留下了一段“漂亮”的代码，他有点忘了在上面应用一些东西。有一个查询从几个表中选择几个项目。

可以选择6个项目。这意味着可以选择 6 张桌子，但可以选择更多桌子 - 甚至 20 张桌子。我需要从已处理的查询中获取该表列表。

确实，有可能吗？是否有任何命令可以获取查询使用的表列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T00:56:53.817

我不确定我是否正确理解了这个问题，但可能值得“解释”查询并查看正在使用哪些表，如下所示。

> **EXPLAIN** SELECT * FROM table1 JOIN table2 USING (id)

# c# - 当需要批准才能实际进行更改时如何保存对象？

> ID：360670
> 
> 赞同：2
> 
> 时间：2008-12-11T19:56:56.293
> 
> 标签：c#, nhibernate

所以我有一个对象图，假设它是一个订单。您有订单类、行项目类、跟踪号类、付款类。你明白了。

现在业务要求是任何用户都可以更改订单，但订单更改必须得到经理的批准。在经理批准之前没有任何变化。经理可以随时更改任何内容，无需批准。

处理此类情况的最佳做法是什么？保存订单对象的许多（可能的）不同状态并最终批准或拒绝更改。

我正在使用 C# 和 Nhibernate。

谢谢，凯尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T20:20:03.703

我会创建一个事务表。它将记录每个未决更改。它将引用订单表。

所以会创建一个订单，但有一个待处理的更改；一条记录将被插入到订单表中，状态列为待处理，一条记录将被插入到 OrderTransaction 表中。

对于每次更改，都会将另一条记录插入 OrderTransaction 表中。

我还将设置一个 RequestedChanges 表，其中包含所有可能的请求更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T20:30:26.567

类似于 Sam Williamson 关于事务表的想法，我会使用临时表。

不是经理的人所做的更改，转到临时表中的新订单对象。经理将有一个界面来审查这些待批准的订单，并且系统将保存所有更改，但在标准职位之外。

这也可能是用户界面的问题，他们必须并排查看订单的正式版本和待定修订版本才能理解对象的状态。

无论如何，我认为您最好的选择是将对象正常存储，但在与官方记录不同的表格中，等待经理审查。这个临时表不应该变得非常大，因为它代表了经理必须获得的批准积压。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-11T20:10:26.593

我对 nHibernate 没有任何经验。

对于这样的场景，最好让数据库存储订单（状态 = ForManagerToApproveOrReject），然后可以查询以查看哪些订单正在等待批准/拒绝（从经理的角度来看）

然后经理可以批准/拒绝它。保存订单（ApprovedOrder，RejectedOrder）的继承方式似乎有点奇怪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T20:37:20.750

一个简单的解决方案是创建另一个订单，该订单是原始订单的副本，其中应用了更改，状态设置为 PendingApproval，并且版本号自动递增。更改表的主键以包含 ApprovalDate。然后，当前已批准的订单始终是具有最近批准日期的订单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T20:39:53.867

如果订单在批准之前未完成，您可能希望有一个待处理的订单和已完成的订单表结构。待处理的订单可能只是序列化的对象，并且只有在获得批准后才将其写入订单、订单行等。

If you allow changing orders after approval it become more complicated, you may also need to take into account post approval steps, payment received, picking, packing, shipping etc.

There are lots of ways to do this type of thing, how you do it will really depend on what the real business requirements are. i.e. you say managers can change orders at any time, but should they really be allowed to change a shipped order?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T20:15:36.927

我理解那部分，我遇到的问题是在订单未获批准时弄清楚如何/在哪里保存所有更改。例如，用户 A 添加付款，用户 B 更改地址，用户 C 添加新行项目。

直到经理批准订单保持最初创建（或从数据库中检索）的状态。一旦经理进入批准屏幕，他/她就可以批准/拒绝每个更改。更改将写入原始订单并保留审核。用户 A 在 yyy 更改了 xxx，由 aaa 的 zzz 批准。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T20:39:34.647

您所描述的是一个工作流，在我看来，它实际上是[Windows Workflow Foundation](http://msdn.microsoft.com/en-us/library/ms735927.aspx)的一个很好的候选者。如果您的工作流程对业务至关重要，我倾向于将其从您的数据库逻辑中分离出来，WWF 将允许您这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T20:58:06.450

thanks for all the answers. The actual business use case is not creating orders, but if I tried to explain the actual business I'd have to write a couple paragraphs. The bottom line is managers need to moderate changes on a deeply nested object graph, before they "go live."

I like the transaction table idea.

I also like saving two versions of the "order," one with changes, one without.

I guess I'll have to dive into both and see what happens.

# gradient - 仅使用 html 和 css 和 javascript 的渐变？

> ID：360673
> 
> 赞同：5
> 
> 时间：2008-12-11T19:58:26.523
> 
> 标签：gradient

有没有办法在 css/html/javascript 中进行渐变，只适用于所有主要浏览器？（MS IE 5+、Firefox、Opera、Safari）？

编辑：我想为背景（标题、主面板、侧面板）执行此操作。另外，也希望有垂直线渐变。

编辑：阅读回复后，让我们也将其开放给 Javascript 解决方案，因为 HTML/CSS 本身使其更难实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T20:43:32.250

我以前做过这个作为一个噱头，使用像这样的javascript：

```
var parent = document.getElementByID('foo');
for(var i=0; i< count; i++) {
    var div = document.createElement('div');
    div.style.position = 'absolute';
    div.style.width='100%';
    div.style.height = 1/count+"%";
    div.style.top = i/count+"%";
    div.style.zIndex = -1;
    parent.appendChild(div);
} 
```

如果您的要求只是要有一个渐变，那么您真的应该在 css 中使用设置为背景图像的渐变图像。就我而言，我也在为渐变的颜色和位置设置动画。我现在不能保证它是跨浏览器（对于初学者，请确保父级应用了一些位置，否则它将不是绝对定位的位置容器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T20:00:42.947

我不清楚您正在寻求的实施细节（例如背景，或者只是窗口一侧的边框等）；然而，这可能虽然有点乏味。

想到的一个例子是拥有 n 块级元素，例如 div，然后给它们每个小高度（例如几个像素），然后逐渐改变每个后续元素的背景颜色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T18:40:33.623

我使用 colorzilla 的渐变 CSS 代码生成器：http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

它有 IE 的 polyfills - 但不确定它有多远。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-09T03:21:32.160

There are lots of ways to create a gradient now. 1\. You can create image for it. 2\. Use CSS3 Gradient, it can be linear, radial and repeating.

Syntax for linear :

```
linear-gradient: ([angle | to ] ,[ [color-stop], [color-stop]+); 
```

Syntax for radial :

```
linear-gradient: ([angle | to ] ,[ [color-stop], [color-stop]+); 
```

For IE6 to IE 9 we can use the filter property or you can also use [CSS3Pie](http://css3pie.com/).

Following are some referances that will help:

[Mozilla MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/linear-gradient)

[CSS3File](http://www.css3files.com/gradient/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T20:27:08.557

我认为简短的回答是否定的。

您可以仅使用 css 创建看起来像渐变的东西，但是然后像图像背景一样使用它......我认为这有点推动它。

**编辑（感觉很傻）**

我找到了解决方案：[http ://en.wikipedia.org/wiki/JPEG](http://en.wikipedia.org/wiki/JPEG)

# c# - 谷歌地图 - ASP.Net 中的简单方法？

> ID：360677
> 
> 赞同：11
> 
> 时间：2008-12-11T19:59:02.653
> 
> 标签：c#, asp.net, google-maps

我想使用谷歌地图并在网络上查看一百万种方法。有些是javascript方法，有些是asp.net服务器组件，我碰巧碰运气。使用 c# 和 asp.net 最简单、最可靠的方法是什么？

我有我的位置数据，包括数据库中的地理编码。我想为用户提供一种查找某些位置的方法。从那里，我的代码将为谷歌地图提供一个地理编码表，地图上的标记对应于找到的条目。用户可以看到每个条目，如果返回多行，则需要能够分辨出哪个是哪个条目。

有没有好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-11T20:02:09.153

Google Maps API 是通过 JavaScript 访问的（任何服务器控件都只是从您那里抽象出来）。在您描述的情况下，您需要动态输出所需的 JavaScript 来告诉地图 API 要显示什么。

请参阅[http://dotnet.sys-con.com/node/171162](http://dotnet.sys-con.com/node/171162)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-11T20:08:03.773

有一些服务器控件可以做到这一点，就像[这样](http://googlemaps.subgurim.net/)，但你必须学习如何以一种方式（服务器控制）或另一种方式（Javascript Google API）来做事。

我推荐使用 Google API，因为它在整个网络上都有更多示例，并且您可以在 Google 发布新功能后立即使用它们，而不必等待服务器控件开发人员执行此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T20:07:55.850

我建议使用直接 JavaScript 来创建 Google 地图。这是相当直接的，然后您将能够了解幕后发生的事情。

谷歌有一些很好的教程和文档可以让你快速上手。将一个添加到您的站点后，设置您需要的其余自定义设置将变得非常容易。

看看这个网站的例子。

[http://code.google.com/apis/maps/documentation/examples/](http://code.google.com/apis/maps/documentation/examples/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-11T20:08:05.567

像往常一样，我指向 ComponentOne，它有一个很好的 SilverLight 控件，可以使用谷歌地图或微软的 Live Maps，它使用 Silverlight Deep Zoom 来很好地处理它：http: [//www.componentone.com/SuperProducts/MapsSilverlight/](http://www.componentone.com/SuperProducts/MapsSilverlight/)

现场示例： [http ://demo.componentone.com/Silverlight/Factories/](http://demo.componentone.com/Silverlight/Factories/)

（我不是来自 ComponentOne，只是一个满意的客户）；）

我知道您可以使用脚本和其他方式自己完成，但使用全读代码更有趣。;)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-11T20:39:45.503

[谷歌地图或雅虎地图的最佳 .NET 包装器？](https://stackoverflow.com/questions/38070/best-net-wrapper-for-google-maps-or-yahoo-maps)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-15T17:00:46.693

顺便说一句：我在这里找到了一篇很棒的帖子，其中有一个关于如何进行商店查找的示例。效果很好。我建议！！

[http://blog.donnfelker.com/post/HOWTO-Build-a-Store-Locator-in-ASPNET.aspx](http://blog.donnfelker.com/post/HOWTO-Build-a-Store-Locator-in-ASPNET.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T00:47:11.310

看看这个例子：[ASP.Net 中的数据驱动谷歌地图](http://blog.aggregatedintelligence.com/2009/02/aspnet-data-driven-google-map-example.html)

我使用 ASP.Net Ajax 创建了一个可从 JavaScript 调用的 Web 服务。Web 服务与数据库对话并填充一个非常基本的对象。ASP.Net Ajax，然后使我的客户端 javascript 可以使用该对象。其余的很简单：在客户端中，您从 Javascript 调用 Web 服务，读取返回的数据并使用简单的 Google Maps API 调用填充 Google Maps。

[在链接文本](http://www.aggregatedintelligence.com/Samples/GMapsInASP/default.aspx)中查看网站

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-04T11:42:12.180

请尝试我[的 ASP.NET 的 GoogleMaps 控件](http://en.googlemaps.subgurim.net/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-10T18:56:50.513

如果您需要服务器端 API，这个开源项目可以帮助您很多 - [http://code.google.com/p/google-maps/](http://code.google.com/p/google-maps/)

我帮助查询 google-maps api 并获取静态地图的链接。

# asp.net - Web 应用程序使用窗口域帐户进行身份验证

> ID：360694
> 
> 赞同：8
> 
> 时间：2008-12-11T20:02:43.457
> 
> 标签：asp.net, security, active-directory, windows-authentication

如果您有一个将在网络中运行的 Web 应用程序，那么它支持 Windows 身份验证（活动目录？）是有意义的。

使用 AD 安全模型是否有意义，或者我是否会制作自己的角色/安全模块，一些管理员必须为每个用户配置？

我以前从未处理过 Windows 安全问题，因此对于如何处理在 Windows 网络中运行的 Web 应用程序的安全性，我感到非常困惑。

我想我必须解决两个主要问题：

```
1\. authentication
2\. authorization 
```

我有一种感觉，最佳实践会说自己处理授权，但使用 AD 身份验证对吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T20:08:49.530

基本上windows处理一切，你从不存储用户名或密码，AD和IIS为你完成所有工作

将此添加到您的`web.config`

```
 <system.web>
  ...
  <authentication mode="Windows"/>
  ...
 </system.web> 
```

配置 Windows 身份验证

1.  启动 Internet 信息服务 (IIS)。
2.  右键单击应用程序的虚拟目录，然后单击“属性”。
3.  单击目录安全选项卡。
4.  在匿名访问和身份验证控制下，单击编辑。
5.  **确保未选中匿名访问复选框**并且**集成 Windows 身份验证是唯一选中的复选框**。

然后您可以再次处理业务或授权使用`web.config`。例如

```
<authorization>
 <deny users="DomainName\UserName" />
 <allow roles="DomainName\WindowsGroup" />
</authorization> 
```

在此处阅读更多信息：http: [//msdn.microsoft.com/en-us/library/ms998358.aspx](http://msdn.microsoft.com/en-us/library/ms998358.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T20:17:44.050

这个问题由 Scott Guthrie 先生在 [Link 1](http://weblogs.asp.net/scottgu/archive/2006/07/12/Recipe_3A00_-Enabling-Windows-Authentication-within-an-Intranet-ASP.NET-Web-application.aspx)和[Link 2中详细解决](http://weblogs.asp.net/scottgu/pages/Recipe_3A00_-Implementing-Role_2D00_Based-Security-with-ASP.NET-2.0-using-Windows-Authentication-and-SQL-Server.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T20:05:09.800

我在一些内部站点上使用了 Windows 安全性。

基本上我设置它的方式是我在 IIS 中删除匿名访问，然后通过标准 Windows 安全模型分配站点文件的权限。

我不确定这是否是最佳做法，但它一直对我很有效。

# iis - WMI/PowerShell 错误：为什么 CreateSite 突然创建 *两个 * 站点？

> ID：360695
> 
> 赞同：1
> 
> 时间：2008-12-11T20:02:48.777
> 
> 标签：iis, powershell, wmi

我有一个简单的 PowerShell 脚本，它使用 WMI 在 Vista 盒子上创建一个网站。是的，我知道 PowerShell 有一个用于 IIS 7 的 IIS 提供程序，但是这个脚本也必须支持 IIS 6.0，所以排除了这种情况。

无论如何，脚本运行得很好，但是突然之间（我的意思是，我对脚本进行了零代码更改）它开始为每次调用 CreateNewSite 方法创建第二个损坏的站点。下面是脚本。有人有想法么？

```
$path = "C:\My Path\WebSite"
$site = "TestSite"
$hostHeader = "demo.blah.com"

$service = Get-WmiObject -namespace "root\MicrosoftIISv2" -class "IIsWebService"

$bindingClass = [wmiclass]'root\MicrosoftIISv2:ServerBinding'
$bindings = $bindingClass.CreateInstance()
$bindings.IP = ""
$bindings.Port = "80"
$bindings.Hostname = $hostHeader

$result = $service.CreateNewSite($site, $bindings, $path) 
```

上面的脚本*只是*创建了一个名为“TestSite”的站点，但现在它还创建了一个名为“SITE_1786339847”的站点（数字发生了变化，但始终与此相似）。我已经逐步执行了一次执行一行的脚本，并且在调用 CreateNewSite 方法之前都没有创建任何站点。WMI 只是错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T20:47:03.087

哎呀，回答了我自己的问题。我检查了原始 IIS 7.0 配置文件，发现一个孤立的虚拟目录与 ID 为 1786339847 的站点相关联。当我从配置文件中删除该虚拟目录时，脚本再次开始正常工作。

如果有人遇到类似情况，请在删除之前从 IIS 管理器中获取坏站点的站点 ID，然后打开 C:\Windows\system32\inetsrv\config\applicationHost.config。扫描该 ID 的文件并查找对其的任何孤立引用。 **确保您首先有备份。**

# sqlite - 使用 System.Data.Sqlite 时“在 DLL sqlite3 中找不到入口点 sqlite3_open_v2”

> ID：360705
> 
> 赞同：2
> 
> 时间：2008-12-11T20:05:34.387
> 
> 标签：sqlite, system.data.sqlite, entrypointnotfoundexcept

我在通过 System.Data.Sqlite 连接到 Sqlite 数据库时遇到问题。我试图使用 FluentNhibernate 但这不起作用，所以我回到基础但得到了同样的错误：在 DLL sqlite3 中找不到入口点 sqlite3_open_v2。

这是我的（我相信相当简单）代码：

```
using (SQLiteConnection connection = new SQLiteConnection("Data Source=Stripper.s3db;Initial Catalog=main;"))
            {
                using (SQLiteCommand cmd = new SQLiteCommand("select * from album", connection))
            {
                cmd.Connection.Open();
                object t = cmd.ExecuteScalar();
                cmd.Connection.Close();
            }
        } 
```

我有对 System.Data.SQLite 的引用，所以对我来说一切都很好。互联网上的一些解释（你几乎不能称它们为教程）并没有帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T20:20:28.133

它可能是您正在使用的 Sqlite3 版本。V2 方法相对较新 -[在 v3.5 中引入](http://www.sqlite.org/34to35.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T20:51:40.143

另一种可能的解释是您在 64 位应用程序中使用了 32 位版本的提供程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T11:15:52.803

我刚刚从 System.Data.Sqlite 网站 (sqlite.phxsoftware.com/) 下载了 v1.0.60.0，它指向[http://sourceforge.net/project/showfiles.php?group_id=132486](http://sourceforge.net/project/showfiles.php?group_id=132486)。正如你所看到的，没有太多选择，所以我不能认为我在那里做错了什么。如果我没记错的话，Sqlite3 包含在 System.Data.Sqlite 中，所以人们会期望它是好的版本。我肯定在 32 位应用程序上使用 32 位版本。我已经下载了安装程序并将尝试使用它（我使用的是二进制文件）。

# c++ - 使用 DirectShow 将字幕文件与 MPEG 视频进行帧精确同步

> ID：360707
> 
> 赞同：1
> 
> 时间：2008-12-11T20:06:30.640
> 
> 标签：c++, video, directshow, mpeg

这是我一直在处理的一个问题，并且无法得到一个好的答案（甚至来自微软）。我正在使用通用转储过滤器将硬件压缩的 MPEG 文件写入磁盘。在图中，我还有一个 SampleGrabber 过滤器，它在每一帧都被调用。从 SampleGrabber 回调中，我得到一个字幕以及 DirectShow 时间戳，并将它们写入 SAMI (.smi) 字幕文件。这一切似乎都在工作，因为 SAMI 文件包含每一帧的正确字幕。但是，我有几个问题：

1.  前几个（通常是 3 或 4 个）DirectShow 时间戳都是 0。如果我从 SampleGrabber 获得回调，这些时间戳不应该递增吗？

2.  当我开始播放时，显示的第一个时间戳是 SAMI 文件中大约 10-20 个字幕。我假设第一帧将显示文件中的第一个时间戳。

3.  这可能与＃2有关，但字幕未同步到文件中的相应帧。它们有时可能会迟到 40 帧。

我通过 C++ 使用 DirectShow，在 Windows XP SP3 下使用 Hauppauge HVR-1800 捕获（最新驱动程序 09/08/2008），并在 Media Player Classic 6.4.9.0 下播放。欢迎任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T14:26:46.293

您是否正在使用获取传入的 IMediaSample 的 GetTime 或 GetMediaTime。GetTime 是您想要的，因为它代表了流演示时间。

一定要检查传入的 IMediaSample 的[isPreRoll](http://msdn.microsoft.com/en-us/library/ms785993(VS.85).aspx)函数。应忽略预卷样本，因为它们将在播放期间再次输出。我要做的另一件事是确保您的样本采集器尽可能位于您的过滤器图中的下游。最好在任何解复用器和渲染器之后。

另请参阅DirectShow 文档中有关[时间戳的文章。](http://msdn.microsoft.com/en-us/library/ms787792%28VS.85%29.aspx)它概述了使用时间戳的其他注意事项。

当然，即使经过上述所有提示，仍然不能绝对保证特定 DirectShow 过滤器的行为方式。

# ms-word - 自动更新 rtf 文档中的 pageref 字段

> ID：360722
> 
> 赞同：0
> 
> 时间：2008-12-11T20:10:16.360
> 
> 标签：ms-word, rtf

我正在处理的应用程序将文档输出为 rtf 格式，并且 PAGEREF 字段用于目录页和索引页。问题是在打开文档时，字段不会更新并保持空白。如果您手动更新 Word 中的字段，它们可以正常工作。有没有办法让这些字段在 RTF 规范中自动更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T20:34:25.670

您可以尝试创建 Document_Open() 宏，尽管您可能无法将宏添加到 rtf 文件。您也许可以在模板 (.dot) 中添加宏并让 .rtf 文件引用该模板。

```
Private Sub Document_Open()
End Sub 
```

# .net-3.5 - 跨框架性能命中

> ID：360723
> 
> 赞同：0
> 
> 时间：2008-12-11T20:10:22.053
> 
> 标签：.net-3.5, .net-2.0, .net-1.1, .net-3.0

我有一个 .NET 3.5 WinForms 项目，它使用了几个 3rd 方控件和几个为 1.1 框架编译的自制组件。

使用 1.1 组件是否会影响性能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T20:21:50.297

不，因为框架的 1.1 版应该可以在 2.0 附带的 CLR 运行时上正常运行。除非您做一些奇怪的事情，否则您的应用程序仅在一个可能是 2.0 的 AppDomain 中运行，因此该 AppDomain 中的所有内容都应该在 2.0 上运行，包括您的 1.1 库。

.NET 3.5 框架是 2.0 框架的扩展。因此，当我说 2.0、3.0 和 3.5 包含在其中时。

所以从运行时的角度来看，你完全没问题。不了解这些库的更多信息，您可能正在使用已在新框架中改进的过时 API，但这是您可能遇到问题的唯一地方

# php - 如何将数组的所有值转换为 PHP 中的浮点数？

> ID：360725
> 
> 赞同：9
> 
> 时间：2008-12-11T20:10:44.050
> 
> 标签：php

我正在从我的数据库中获取一个浮点数组，但我得到的数组已将值转换为字符串。

如何在不循环遍历数组的情况下再次将它们转换为浮点数？
或者，如何从数据库中获取值而不将它们转换为字符串？

* * *

### 编辑：

*   我正在使用 Zend 框架，我正在使用 PDO_mysql。这些值每列存储一个，这是一项要求，因此我无法对它们进行序列化。

*   `array_map('floatval', $array)`仅适用于一维数组。

*   当我使用它们时，我不能`floatval`使用单个元素，因为我必须将一个数组传递给我的闪存图表。

*   暂时的非通用解决方案是提取行并`array_map('floatval',$array)`处理每一行。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-11T20:15:04.213

你可以使用

```
$floats = array_map('floatval', $nonFloats); 
```

有选项`PDO::ATTR_STRINGIFY_FETCHES`，但据我记得，MySQL 总是将其作为`true`

编辑：参见[Bug 44341](http://bugs.php.net/bug.php?id=44341)，它确认 MySQL 不支持关闭 stringify。

编辑：您还可以像这样映射自定义函数：

```
function toFloats($array)
{
    return array_map('floatval', $array);
}

$data = array_map('toFloats', $my2DArray); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T20:19:34.717

你是如何获取数据的？mysql，mysqli 或 PDO，其他方式甚至其他数据库？

你可以像这样使用`array_map`with `floatval`： `$data = array_map('floatval', $data);` 但这仍然会执行一个循环，我认为它假设你的数据中只有一列。

如果必须的话，当你使用你的价值时，你可能最好选择浮动。无论如何，php 可能会很好地解释它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T21:29:05.203

大声笑...您在从事与我 tharkun 相同的项目吗？

我刚刚完成（昨晚）在一个基于 ZF 的项目中创建了一些东西，它使用 pdo_mysql 来检索和格式化数据，然后将其输出为 xml 以在 Flash 片段中使用。这些值作为字符串输入，但需要是浮点数。因为我也是编写获取数据部分和创建数据库的人，所以我只是确保数据在进入数据库之前转换为浮点数。

我只是将这些值转换为浮点数作为其他格式的一部分，因为它是值得的。

```
protected function _c2f($input)
    {
        $input = (float)$input;
        $output = round(($input * 1.8) + 32, 2);

        return $output;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-31T09:40:48.053

我为这个操作找到了一个简单的方法。您可以通过在代码中添加 foreach 循环来做到这一点。foreach 循环用于一一获取您的数组字符串数据。然后，您可以通过函数 number_format 简单地转换它。我在转换为浮点值后使用了 2 个位置。即它用于在点值 2 位之后打印值。

```
 $example= array("12.20", "15.05", "55.70");
    foreach($example as $float) 
{
 $update_value = number_format($float,2);
 echo $update_value."<br>";
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-11T20:48:54.237

不知道你在这里问什么？您可以使用 将字符串转换为浮点数，`(float) $string`但由于 PHP 是动态类型的，因此无论如何都会在需要时发生。没有理由进行显式强制转换。

你用浮点值做什么？

# database - 嵌套间隔是嵌套集（修改的前序遍历）RDBMS 性能下降的可行解决方案吗？

> ID：360738
> 
> 赞同：11
> 
> 时间：2008-12-11T20:16:27.627
> 
> 标签：database, algorithm, nested-sets

Joe Celko 的嵌套集（修改的前序遍历）的已知限制之一是随着树增长到较大的大小，性能会显着下降。

Vadim Tropashko 提出了嵌套区间，并在本文中提供了示例和理论解释：http: [//arxiv.org/html/cs.DB/0401014](http://arxiv.org/html/cs.DB/0401014)

这是一个可行的解决方案吗，是否有任何可行的示例（以任何语言）从本地 DB 层抽象出来？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T21:32:48.087

[虽然我已经看到了嵌套集的示例](http://www.sitepoint.com/article/hierarchical-data-database/)，但我并没有看到太多关于嵌套区间的示例，尽管理论上从一种转换到另一种应该不难。与其进行前序遍历来标记节点，不如进行广度优先递归。诀窍是找出标记节点的 n 个子节点的最有效方法。由于 a/b 和 c/d 之间的节点是 (a+c)/(b+d)，因此病态插入（例如，从左到右插入子节点）存在创建相同指数增长的风险在索引值中，例如，使用完整的[物化路径](http://www.dbazine.com/oracle/or-articles/tropashko4)。抵消这种影响并不难 - 一次创建一个新索引，将每个索引插入到产生最低结果分母的位置。

就性能下降而言，很大程度上取决于您打算执行的操作。仍然有一些操作需要对整个树进行完全重新标记 - 嵌套集或嵌套间隔方法都最适合很少更改的结构。如果您要对层次结构进行大量结构更改，则“标准”父子表结构可能更易于使用。还要记住，使用嵌套集的整数标记比区间方法更容易一些操作（例如后代的数量）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T23:36:06.663

我编写了一个 gem，它抽象出所有嵌套间隔的计算，以便与 Rails 的 ActiveRecord [https://github.com/clyfe/acts_as_nested_interval/](https://github.com/clyfe/acts_as_nested_interval/)在多个系统的生产中使用。

# time-complexity - 斐波那契数列的计算复杂度

> ID：360748
> 
> 赞同：373
> 
> 时间：2008-12-11T20:20:25.107
> 
> 标签：time-complexity, big-o, complexity-theory, fibonacci

我了解 Big-O 表示法，但我不知道如何为许多函数计算它。特别是，我一直试图弄清楚斐波那契数列的原始版本的计算复杂性：

```
int Fibonacci(int n)
{
    if (n <= 1)
        return n;
    else
        return Fibonacci(n - 1) + Fibonacci(n - 2);
} 
```

斐波那契数列的计算复杂度是多少，它是如何计算的？

* * *

## 回答 #1

> 赞同：408
> 
> 时间：2008-12-11T20:29:12.750

您将要计算的时间函数建模为要计算的时间加上要计​​算的时间加上将它们加在一起的时间的总和 ( `Fib(n)`) 。这是假设对相同的重复评估花费相同的时间 - 即不使用记忆。`Fib(n-1)``Fib(n-2)``O(1)``Fib(n)`

`T(n<=1) = O(1)`

`T(n) = T(n-1) + T(n-2) + O(1)`

你解决这个递归关系（例如使用生成函数），你最终会得到答案。

或者，您可以绘制递归树，它将具有深度`n`并直观地找出该函数是渐近的。然后你可以通过归纳证明你的猜想。`O(2`^(`n`)`)`

基数：`n = 1`很明显

假设，*因此*`T(n-1) = O(2`^(`n-1`)`)`

 *`T(n) = T(n-1) + T(n-2) + O(1)` *这等于*

`T(n) = O(2`^(`n-1`)`) + O(2`^(`n-2`)`) + O(1) = O(2`^(`n`)`)`

但是，正如评论中所指出的，这不是严格的限制。关于这个函数的一个有趣的事实是，T(n)与的值渐近**相同**`Fib(n)`，因为两者都定义为

`f(n) = f(n-1) + f(n-2)`.

递归树的叶子总是返回 1。 的值`Fib(n)`是递归树中叶子返回的所有值的总和，等于叶子的计数。由于每个叶子都需要 O(1) 来计算，`T(n)`所以等于`Fib(n) x O(1)`。因此，此函数的紧密界限是斐波那契数列本身 (~ )。您可以通过使用我上面提到的生成函数来找出这个紧密的界限。`θ(1.6`^(`n`)`)`

* * *

## 回答 #2

> 赞同：155
> 
> 时间：2008-12-11T20:26:21.553

问问自己需要执行多少条语句`F(n)`才能完成。

对于`F(1)`，答案是`1`（条件的第一部分）。

对于`F(n)`，答案是`F(n-1) + F(n-2)`。

那么什么函数满足这些规则呢？尝试一个^n (a > 1)：

a ^n == a ^((n-1)) + a ^((n-2))

除以^((n-2))：

一个² == 一个 + 1

解决就`a`得到`(1+sqrt(5))/2 = 1.6180339887`，也就是所谓的[黄金比例](https://en.wikipedia.org/wiki/Golden_ratio)。

所以它需要指数级的时间。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2014-04-15T21:38:56.573

我同意 pgaur 和 rickerbh 的观点，递归斐波那契的复杂度是 O(2^n)。

我通过一个相当简单的结论得出了同样的结论，但我相信仍然是有效的推理。

首先，这一切都是为了弄清楚在计算第 N 个斐波那契数时调用了多少次递归斐波那契函数（从现在开始为 F() ）。如果它在序列 0 到 n 中的每个数字被调用一次，那么我们有 O(n)，如果它被每个数字调用 n 次，那么我们得到 O(n*n) 或 O(n^2)，等等。

因此，当为数字 n 调用 F() 时，对于 0 到 n-1 之间的给定数字调用 F() 的次数会随着我们接近 0 而增加。

作为第一印象，在我看来，如果我们以视觉方式表示，每次为给定数字调用 F() 绘制一个单位，湿得到一种金字塔形状（也就是说，如果我们将单位水平居中）。像这样的东西：

```
n              *
n-1            **
n-2           ****  
...
2           ***********
1       ******************
0    *************************** 
```

现在的问题是，随着 n 的增长，这个金字塔的底部扩大的速度有多快？

让我们来看一个真实的案例，例如 F(6)

```
F(6)                 *  <-- only once
F(5)                 *  <-- only once too
F(4)                 ** 
F(3)                ****
F(2)              ********
F(1)          ****************           <-- 16
F(0)  ********************************    <-- 32 
```

我们看到 F(0) 被调用了 32 次，即 2^5，对于这个示例，它是 2^(n-1)。

现在，我们想知道 F(x) 被调用了多少次，我们可以看到 F(0) 被调用的次数只是其中的一部分。

如果我们将 F(6) 到 F(2) 行中的所有 * 移到 F(1) 行中，我们会看到 F(1) 和 F(0) 行现在长度相等。这意味着，当 n=6 时调用 F() 的总次数为 2x32=64=2^6。

现在，就复杂性而言：

```
O( F(6) ) = O(2^6)
O( F(n) ) = O(2^n) 
```

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-12-11T21:10:03.057

[麻省理工学院](http://courses.csail.mit.edu/6.01/spring07/lectures/lecture4.pdf)对这个特定问题进行了很好的讨论。在第 5 页，他们指出，如果假设加法需要一个计算单位，则计算 Fib(N) 所需的时间与 Fib(N) 的结果密切相关。

因此，您可以直接跳到非常接近斐波那契数列的近似值：

```
Fib(N) = (1/sqrt(5)) * 1.618^(N+1) (approximately) 
```

并因此说，朴素算法的最坏情况性能是

```
O((1/sqrt(5)) * 1.618^(N+1)) = O(1.618^(N+1)) 
```

PS：如果您想了解更多信息，请在 Wikipedia上讨论[Nth Fibonacci 数的封闭形式表达式。](http://en.wikipedia.org/wiki/Fibonacci_number#Closed_form_expression)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2017-08-10T15:39:12.740

您可以扩展它并进行可视化

```
 T(n) = T(n-1) + T(n-2) <
     T(n-1) + T(n-1) 

     = 2*T(n-1)   
     = 2*2*T(n-2)
     = 2*2*2*T(n-3)
     ....
     = 2^i*T(n-i)
     ...
     ==> O(2^n) 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2018-11-29T06:30:13.600

通过绘制递归树可以更好地估计递归算法的时间复杂度，在这种情况下，绘制递归树的递归关系为 T(n)=T(n-1)+T(n-2)+O(1) 注意每一步都需要 O(1) 表示恒定时间，因为它只进行一次比较来检查**if**块中 n 的值。递归树看起来像

```
 n
   (n-1)      (n-2)
(n-2)(n-3) (n-3)(n-4) ...so on 
```

这里让我们说上面树的每个级别都用 i 表示，因此，

```
i
0                        n
1            (n-1)                 (n-2)
2        (n-2)    (n-3)      (n-3)     (n-4)
3   (n-3)(n-4) (n-4)(n-5) (n-4)(n-5) (n-5)(n-6) 
```

假设在 i 的特定值处，树结束，这种情况将是当 ni=1 时，因此 i=n-1，这意味着树的高度为 n-1。现在让我们看看树中 n 层的每一层做了多少工作。请注意，每一步都需要 O(1) 时间，如递归关系中所述。

```
2^0=1                        n
2^1=2            (n-1)                 (n-2)
2^2=4        (n-2)    (n-3)      (n-3)     (n-4)
2^3=8   (n-3)(n-4) (n-4)(n-5) (n-4)(n-5) (n-5)(n-6)    ..so on
2^i for ith level 
```

因为 i=n-1 是树的高度，在每个级别完成的工作将是

```
i work
1 2^1
2 2^2
3 2^3..so on 
```

因此，完成的总工作将是每个级别完成的工作的总和，因此它将是 2^0+2^1+2^2+2^3...+2^(n-1)，因为 i=n-1。通过几何级数，这个总和是 2^n，因此这里的总时间复杂度是**O(2^n)**

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2014-02-28T01:21:33.270

证明答案很好，但我总是必须手动进行几次迭代才能真正说服自己。所以我在白板上画了一个小的调用树，开始计算节点。我将计数分为总节点、叶节点和内部节点。这是我得到的：

```
IN | OUT | TOT | LEAF | INT
 1 |   1 |   1 |   1  |   0
 2 |   1 |   1 |   1  |   0
 3 |   2 |   3 |   2  |   1
 4 |   3 |   5 |   3  |   2
 5 |   5 |   9 |   5  |   4
 6 |   8 |  15 |   8  |   7
 7 |  13 |  25 |  13  |  12
 8 |  21 |  41 |  21  |  20
 9 |  34 |  67 |  34  |  33
10 |  55 | 109 |  55  |  54 
```

立即跳出来的是叶子节点的数量是`fib(n)`。需要更多迭代才能注意到的是内部节点的数量是`fib(n) - 1`。因此节点总数为`2 * fib(n) - 1`。

由于在对计算复杂度进行分类时会丢弃系数，因此最终答案是`θ(fib(n))`.

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-12-11T21:03:08.937

它的下端以 2^n 为界，`2^(n/2)`上端以 2^n 为界（如其他评论中所述）。该递归实现的一个有趣事实是它具有 Fib(n) 本身的严格渐近界。这些事实可以概括为：

```
T(n) = Ω(2^(n/2))  (lower bound)
T(n) = O(2^n)   (upper bound)
T(n) = Θ(Fib(n)) (tight bound) 
```

如果您愿意，可以使用其[封闭形式](http://en.wikipedia.org/wiki/Fibonacci_number#Closed_form_expression)进一步减少紧密绑定。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-12-20T22:40:22.527

通过绘制函数调用图很容易计算。只需为每个 n 值添加函数调用，然后查看数字如何增长。

**大 O 是 O(Z^n)，其中 Z 是黄金比例或大约 1.62。**

随着 n 的增加，莱昂纳多数和斐波那契数都接近这个比率。

与其他大 O 问题不同，输入没有可变性，算法和算法的实现都明确定义。

不需要一堆复杂的数学。简单地画出下面的函数调用并将函数与数字相匹配。

或者，如果您熟悉黄金比例，您就会认出它。

这个答案比公认的答案更正确，后者声称它将接近 f(n) = 2^n。它永远不会。它将接近 f(n) = golden_ratio^n。

```
2 (2 -> 1, 0)

4 (3 -> 2, 1) (2 -> 1, 0)

8 (4 -> 3, 2) (3 -> 2, 1) (2 -> 1, 0)
            (2 -> 1, 0)

14 (5 -> 4, 3) (4 -> 3, 2) (3 -> 2, 1) (2 -> 1, 0)
            (2 -> 1, 0)

            (3 -> 2, 1) (2 -> 1, 0)

22 (6 -> 5, 4)
            (5 -> 4, 3) (4 -> 3, 2) (3 -> 2, 1) (2 -> 1, 0)
                        (2 -> 1, 0)

                        (3 -> 2, 1) (2 -> 1, 0)

            (4 -> 3, 2) (3 -> 2, 1) (2 -> 1, 0)
                        (2 -> 1, 0) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-11-18T00:46:27.003

好吧，据我`O(2^n)`所知，在这个函数中，只有递归需要相当长的时间（分而治之）。`F(n-(n-1))`我们看到，上面的函数将继续在一棵树中，直到我们到达层级时叶子接近`F(1)`。因此，在这里，当我们记下每个树深度遇到的时间复杂度时，求和序列为：

```
1+2+4+.......(n-1)
= 1((2^n)-1)/(2-1)
=2^n -1 
```

即`2^n [ O(2^n) ]`.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-09-30T22:21:52.600

由于计算中的重复，斐波那契的朴素递归版本在设计上是指数的：

从根本上讲，您正在计算：

F(n) 取决于 F(n-1) 和 F(n-2)

F(n-1) 再次取决于 F(n-2) 和 F(n-3)

F(n-2) 再次取决于 F(n-3) 和 F(n-4)

那么您在每个级别 2 递归调用都在计算中浪费了大量数据，时间函数将如下所示：

T(n) = T(n-1) + T(n-2) + C，其中 C 常数

T(n-1) = T(n-2) + T(n-3) > T(n-2) 然后

T(n) > 2*T(n-2)

...

T(n) > 2^(n/2) * T(1) = O(2^(n/2))

这只是一个下限，就您的分析而言应该足够了，但实时函数是相同斐波那契公式的常数因子，并且已知[封闭形式](https://en.wikipedia.org/wiki/Fibonacci_number)是黄金比例的指数。

此外，您可以使用如下动态编程找到优化的斐波那契版本：

```
static int fib(int n)
{
    /* memory */
    int f[] = new int[n+1];
    int i;

    /* Init */
    f[0] = 0;
    f[1] = 1;

    /* Fill */
    for (i = 2; i <= n; i++)
    {
        f[i] = f[i-1] + f[i-2];
    }

    return f[n];
} 
```

这是优化的，只做**n**步，但也是指数级的。

成本函数定义为从输入大小到解决问题的步骤数。当您看到 Fibonacci 的动态版本（计算表格的**n**步）或了解数字是否为素数的最简单算法时（使用**sqrt(n)**分析数字的有效除数）。您可能认为这些算法是**O(n)**或**O(sqrt(n))**但这根本不是真的，原因如下：算法的输入是一个数字：**n**，使用二进制表示法的输入大小整数**n**是**log2(n)**然后做一个变量改变

```
m = log2(n) // your real input size 
```

让我们找出步数作为输入大小的函数

```
m = log2(n)
2^m = 2^log2(n) = n 
```

那么作为输入大小函数的算法成本是：

```
T(m) = n steps = 2^m steps 
```

这就是成本呈指数增长的原因。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-01-10T22:59:17.053

没有答案强调可能是计算序列的最快和最节省内存的方法。斐波那契数列有一个封闭形式的精确表达式。它可以通过使用生成函数或使用线性代数来找到，就像我现在要做的那样。

设`f_1,f_2, ...`为 的斐波那契数列`f_1 = f_2 = 1`。现在考虑一个二维向量序列

```
f_1  ,  f_2  ,  f_3  ,  ...
f_2  ,  f_3  ,  f_4  ,  ... 
```

观察`v_{n+1}`向量序列中的下一个元素是`M.v_{n}`其中 M 是由下式给出的 2x2 矩阵

```
M = [0 1]
    [1 1] 
```

由于`f_{n+1} = f_{n+1} and f_{n+2} = f_{n} + f_{n+1}`

M 在复数上可对角化（实际上在实数上也可对角化，但通常情况并非如此）。M 有两个不同的特征向量

```
1      1
x_1    x_2 
```

其中 x_1 = (1+sqrt(5))/2 和 x_2 = (1-sqrt(5))/2 是多项式方程 的不同解`x*x-x-1 = 0`。对应的特征值为 x_1 和 x_2。将 M 视为线性变换并更改您的基础以查看它等效于

```
 D = [x_1  0]
     [0  x_2] 
```

为了找到 f_n 找到 v_n 并查看第一个坐标。要找到 v_n，对 v_1 应用 M n-1 次。但是应用 M n-1 次很容易，只要将其视为 D。然后使用线性可以找到

```
f_n = 1/sqrt(5)*(x_1^n-x_2^n) 
```

由于 x_2 的范数小于 1，对应的项随着 n 趋于无穷大而消失；因此，获得小于 (x_1^n)/sqrt(5) 的最大整数就足以准确地找到答案。通过利用重复平方的技巧，这可以仅使用`O(log_2(n))`乘法（和加法）操作来完成。内存复杂性更令人印象深刻，因为它可以以一种方式实现，即您始终需要在内存中最多保存 1 个值小于答案的数字。但是，由于这个数字不是自然数，这里的内存复杂度会根据您是否使用固定位来表示每个数字（因此进行错误计算）（在这种情况下为 O(1) 内存复杂度）或使用更好的模型（如图灵机，在这种情况下需要更多的分析。

# ios - 我可以在 iPhone 应用程序中嵌入自定义字体吗？

> ID：360751
> 
> 赞同：786
> 
> 时间：2008-12-11T20:21:11.203
> 
> 标签：ios, cocoa-touch, fonts

我想让一个应用程序包含一个用于呈现文本的自定义字体，加载它，然后将它与标准`UIKit`元素（如`UILabel`. 这可能吗？

* * *

## 回答 #1

> 赞同：647
> 
> 时间：2010-04-11T05:01:05.527

iOS 3.2 及更高版本支持此功能。直接来自*iPhone OS 3.2*文档中的新增功能：

> **自定义字体支持**
> 想要使用自定义字体的应用程序现在可以将这些字体包含在其应用程序包中，并通过在其 Info.plist 文件中包含 UIAppFonts 键向系统注册这些字体。该键的值是一个字符串数组，用于标识应用程序包中的字体文件。当系统看到密钥时，它会加载指定的字体并使它们对应用程序可用。

在 中设置字体后`Info.plist`，您可以将自定义字体用作 IB 中的任何其他字体或以编程方式使用。

Apple 开发者论坛上有一个正在进行的主题：
[https](https://devforums.apple.com/thread/37824) ://devforums.apple.com/thread/37824 （需要登录）

这是一个关于如何实现这一目标的优秀而简单的 3 步教程（已删除断开的链接）

1.  使用 Xcode 作为资源将自定义字体文件添加到项目中
2.  为您的文件添加一个`Info.plist`名为`UIAppFonts`.
3.  将此键设为数组
4.  对于您拥有的每种字体，输入字体文件的全名（包括扩展名）作为`UIAppFonts`数组的项目
5.  节省`Info.plist`
6.  现在，在您的应用程序中，您可以简单地调用`[UIFont fontWithName:@"CustomFontName" size:12]`以获取自定义字体以用于您的**UILabels**和**UITextViews**等......</li>

另外：确保字体在您的 Copy Bundle Resources 中。

* * *

## 回答 #2

> 赞同：300
> 
> 时间：2009-04-30T21:57:27.177

**编辑：从 iOS 3.2 开始，这个功能是内置的。如果你需要支持 pre-3.2，你仍然可以使用这个解决方案。**

我创建了一个简单的模块来扩展`UILabel`和处理加载 .ttf 文件。我在 Apache 许可下将其开源并放在 github 上[。](http://git://github.com/zynga/FontLabel.git)

重要的文件是`FontLabel.h`和`FontLabel.m`。

它使用了[Genericrich 回答](https://stackoverflow.com/questions/360751/can-i-embed-a-custom-font-in-an-iphone-application/370257#370257)中的一些代码。

[在此处](http://github.com/zynga/FontLabel/tree/master)浏览源代码。

或者

*   将字体文件复制到资源中

*   向您的文件中添加一个`Info.plist`名为 UIAppFonts 的密钥。（“应用程序提供的字体）

*   将此键设为数组

*   对于您拥有的每种字体，输入字体文件的全名（包括扩展名）作为 UIAppFonts 数组的项目

*   节省`Info.plist`

*   现在在您的应用程序中，您可以简单地调用`[UIFont fontWithName:@"CustomFontName" size:15]`以获取自定义字体以用于您的`UILabels`and`UITextViews`等...</p>

[了解更多信息](http://iosdevelopertip.blogspot.in/2013/12/custom-fonts-in-iphone.html)

* * *

## 回答 #3

> 赞同：117
> 
> 时间：2010-07-07T21:05:57.717

**在iOS 4**中有一种使用自定义字体的简单方法。

1.  将您的字体文件（例如，`Chalkduster.ttf`）添加到XCode 中项目的*Resources*文件夹。
2.  打开`info.plist`并添加一个名为`UIAppFonts`. 这个键的类型应该是数组。
3.  将您的自定义字体名称添加到此数组中，包括扩展名 ( `Chalkduster.ttf`)。
4.  现在您可以`[UIFont fontWithName:@"Chalkduster" size:16]`在您的应用程序中使用。

不幸的是，IB 不允许使用自定义字体初始化标签。看到[这个问题](https://stackoverflow.com/questions/2802391/iphone-sdk-3-2-and-uiappfonts)来解决这个问题。我最喜欢的解决方案是使用自定义`UILabel`子类：

```
@implementation CustomFontLabel

- (id)initWithCoder:(NSCoder *)decoder
{
    if (self = [super initWithCoder: decoder])
    {
        [self setFont: [UIFont fontWithName: @"Chalkduster" size: self.font.pointSize]];
    }
    return self;
}

@end 
```

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2012-10-17T13:29:50.893

在 Info.plist 中添加条目“应用程序提供的字体”并将字体名称包含为字符串：

```
Fonts provided by application
           Item 0        myfontname.ttf
           Item 1        myfontname-bold.ttf
           ... 
```

然后检查以确保通过运行包含您的字体：

```
for (NSString *familyName in [UIFont familyNames]) {
    for (NSString *fontName in [UIFont fontNamesForFamilyName:familyName]) {
         NSLog(@"%@", fontName);
    }
} 
```

请注意，您的 ttf 文件名可能与您在为标签设置字体时使用的名称不同（您可以使用上面的代码获取“fontWithName”参数）：

```
[label setFont:[UIFont fontWithName:@"MyFontName-Regular" size:18]]; 
```

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2009-04-30T23:25:43.907

**编辑：此答案自 iOS3.2 起已失效；使用 UIAppFonts**

我能够成功加载 custom`UIFont`的唯一方法是通过私有 GraphicsServices 框架。

以下将加载`.ttf`应用程序主包中的所有字体：

```
BOOL GSFontAddFromFile(const char * path);
NSUInteger loadFonts()
{
    NSUInteger newFontCount = 0;
    for (NSString *fontFile in [[NSBundle mainBundle] pathsForResourcesOfType:@"ttf" inDirectory:nil])
        newFontCount += GSFontAddFromFile([fontFile UTF8String]);
    return newFontCount;
} 
```

加载字体后，就可以像使用 Apple 提供的字体一样使用它们：

```
NSLog(@"Available Font Families: %@", [UIFont familyNames]);
[label setFont:[UIFont fontWithName:@"Consolas" size:20.0f]]; 
```

GraphicsServices 甚至可以在运行时加载，以防 API 将来消失：

```
#import <dlfcn.h>
NSUInteger loadFonts()
{
    NSUInteger newFontCount = 0;
    NSBundle *frameworkBundle = [NSBundle bundleWithIdentifier:@"com.apple.GraphicsServices"];
    const char *frameworkPath = [[frameworkBundle executablePath] UTF8String];
    if (frameworkPath) {
        void *graphicsServices = dlopen(frameworkPath, RTLD_NOLOAD | RTLD_LAZY);
        if (graphicsServices) {
            BOOL (*GSFontAddFromFile)(const char *) = dlsym(graphicsServices, "GSFontAddFromFile");
            if (GSFontAddFromFile)
                for (NSString *fontFile in [[NSBundle mainBundle] pathsForResourcesOfType:@"ttf" inDirectory:nil])
                    newFontCount += GSFontAddFromFile([fontFile UTF8String]);
        }
    }
    return newFontCount;
} 
```

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2014-09-02T08:08:45.983

使用`iOS 8`+ 和`Xcode 6`+ 你可以很容易地做到这一点。以下是步骤：

1) 将字体拖放到`Xcode`Supporting Files 文件夹。不要忘记在**添加到目标**部分标记您的应用程序。从这一刻起，您可以使用此字体`IB`并从字体托盘中选择它。

![在此处输入图像描述](https://i.stack.imgur.com/Ovbpb.png)

2) 要在您的设备中使用此字体，请打开您的`info.plist`并添加`Fonts provided by application`密钥。它将包含 Item 0 键，您必须添加您的字体名称作为值。字体名称可能与您的字体文件名不同。但首先，在大多数情况下，尝试添加您的文件名。

![在此处输入图像描述](https://i.stack.imgur.com/ak315.png)

如果没有，[这篇文章](http://codewithchris.com/common-mistakes-with-adding-custom-fonts-to-your-ios-app/#findfontname)总是对我有帮助。

这是本文中的快速代码片段，可帮助您找到字体名称。

```
func allFonts(){

   for family in UIFont.familyNames(){

       println(family)

       for name in UIFont.fontNamesForFamilyName(family.description)
       {
           println("  \(name)")
       }

   }

} 
```

### 编辑

我想提一下，您需要将字体文件添加到**Target 的 Build Phases**，**Copy Bundle Resources**。没有它，您将不会在设备上看到您的字体。它可能导致意想不到的行为。

例如，我遇到一个`bug`, 当`UITextField`有自定义字体时，但该字体不在**Copy Bundle Resources**中。当我继续`viewcontroller`使用 this时，在调用函数`textfield`之前会有大约 4 秒的延迟。`viewDidLoad`解决字体问题消除了这种延迟。所以，建议检查两次。(rdar://20028250) 顺便说一句，我无法重现该错误，但我确定问题出在字体上。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2008-12-16T01:28:57.433

我已经这样做了：

加载字体：

```
- (void)loadFont{
  // Get the path to our custom font and create a data provider.
  NSString *fontPath = [[NSBundle mainBundle] pathForResource:@"mycustomfont" ofType:@"ttf"]; 
  CGDataProviderRef fontDataProvider = CGDataProviderCreateWithFilename([fontPath UTF8String]);

  // Create the font with the data provider, then release the data provider.
  customFont = CGFontCreateWithDataProvider(fontDataProvider);
  CGDataProviderRelease(fontDataProvider); 
} 
```

现在，在您的 中`drawRect:`，执行以下操作：

```
-(void)drawRect:(CGRect)rect{
    [super drawRect:rect];
    // Get the context.
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextClearRect(context, rect);
    // Set the customFont to be the font used to draw.
    CGContextSetFont(context, customFont);

    // Set how the context draws the font, what color, how big.
    CGContextSetTextDrawingMode(context, kCGTextFillStroke);
    CGContextSetFillColorWithColor(context, self.fontColor.CGColor);
    UIColor * strokeColor = [UIColor blackColor];
    CGContextSetStrokeColorWithColor(context, strokeColor.CGColor);
    CGContextSetFontSize(context, 48.0f);

    // Create an array of Glyph's the size of text that will be drawn.
    CGGlyph textToPrint[[self.theText length]];

    // Loop through the entire length of the text.
    for (int i = 0; i < [self.theText length]; ++i) {
        // Store each letter in a Glyph and subtract the MagicNumber to get appropriate value.
        textToPrint[i] = [[self.theText uppercaseString] characterAtIndex:i] + 3 - 32;
    }
    CGAffineTransform textTransform = CGAffineTransformMake(1.0, 0.0, 0.0, -1.0, 0.0, 0.0);
    CGContextSetTextMatrix(context, textTransform);
    CGContextShowGlyphsAtPoint(context, 20, 50, textToPrint, [self.theText length]);
} 
```

基本上，您必须在文本中进行一些蛮力循环并使用幻数来查找字体中的偏移量（在这里，请参阅我使用 29），但它可以工作。

此外，您必须确保字体是合法嵌入的。大多数不是，而且有专门从事这类事情的律师，所以要小心。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2008-12-12T01:18:13.070

是的，您可以包含自定义字体。参考 UIFont 的文档，具体来说就是`fontWithName:size:`方法。

1）确保在资源文件夹中包含字体。

2）字体的“名称”不一定是文件名。

3) 确保您拥有使用该字体的合法权利。通过将它包含在您的应用程序中，您也在分发它，您需要有权这样做。

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2012-03-27T19:45:33.570

如果您正在使用`xcode 4.3`，则必须根据线程中的 https://stackoverflow.com/users/1292829/arne 添加`font`，`Build Phase`自定义`Copy Bundle Resources`字体[Xcode](https://stackoverflow.com/users/1292829/arne) [4.3](https://stackoverflow.com/questions/9432373/custom-fonts-xcode-4-3)。这对我有用，这是我为自定义字体在我的应用程序中工作所采取的步骤：

1.  将字体添加到您的项目中。`OTF`我将（或）文件拖放`TTF`到我创建的新组中，并接受了 xcode 选择的`copying the files over to the project folder`.
2.  创建`UIAppFonts`数组，将您的字体列为数组中的项目。只是`names`，而不是扩展名（例如“ `GothamBold`”、“ `GothamBold-Italic`”）。
3.  单击屏幕左侧`project name`顶部的路径。`Project Navigator`
4.  单击`Build Phases`出现在 xcode 主要区域中的选项卡。
5.  展开“ `Copy Bundle Resources`”部分并单击`"+"`以添加字体。
6.  从文件导航器中选择字体文件，当您单击`"+"`.
7.  为您必须的每种字体执行此操作`add to the project`。

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2015-09-29T16:53:57.063

我建议您在此处遵循我最喜欢的简短教程之一：http: [//codewithchris.com/common-mistakes-with-adding-custom-fonts-to-your-ios-app/](http://codewithchris.com/common-mistakes-with-adding-custom-fonts-to-your-ios-app/)，此信息来自该教程。

**第 1 步 - 将 .ttf 或 .otf 从 Finder 拖到您的项目中**

*注意 - 确保单击主应用程序目标上的“添加到目标”框*

[![将字体文件拖到您的项目中，然后单击以将它们添加到您的目标中](https://i.stack.imgur.com/U611W.png)](https://i.stack.imgur.com/U611W.png)

如果您忘记单击将其添加到目标，请单击项目层次结构中的字体文件，然后在右侧面板上单击*目标成员*部分中的主应用程序目标

[![如果您忘记了如何将字体添加到应用程序目标](https://i.stack.imgur.com/PhI5I.png)](https://i.stack.imgur.com/PhI5I.png)

为了确保您的字体是您的应用程序目标的一部分，请确保它们显示在*构建阶段的**复制捆绑资源中*

 *[![如何检查资源以查看字体是否是应用程序目标的一部分](https://i.stack.imgur.com/awWkY.png)](https://i.stack.imgur.com/awWkY.png)

**第 2 步 - 将字体文件名添加到您的 Plist**

转到您的*信息部分中的**自定义 iOS 目标属性*，并为该部分中的项目添加一个键（您应该在键入时看到它作为一个选项出现，它将自己设置为一个数组。单击小箭头打开数组项并输入您添加的 .ttf 或 .otf 文件的名称，让您的应用知道这些是您想要的字体文件*`Fonts provided by application`*

 **注意 - 如果您的应用在此步骤后立即崩溃，请检查您在此处添加的项目的拼写*

[![添加了自定义字体的示例 plist](https://i.stack.imgur.com/kiVl8.png)](https://i.stack.imgur.com/kiVl8.png)

**第 3 步 - 找出字体的名称，以便您可以调用它们**

通常，您的应用程序看到的字体名称与您认为基于该字体的文件名的字体名称不同，请将其放入您的代码中并查看您的应用程序生成的日志以查看在您的代码中调用的字体名称

*迅速*

```
for family: String in UIFont.familyNames(){
  print("\(family)")
  for names: String in UIFont.fontNamesForFamilyName(family){
      print("== \(names)")
  }
} 
```

*目标 C*

```
for (NSString* family in [UIFont familyNames]){
    NSLog(@"%@", family);
    for (NSString* name in [UIFont fontNamesForFamilyName: family]){
        NSLog(@"  %@", name);
    }
} 
```

您的日志应如下所示：

[![搜索日志以查找字体名称的示例](https://i.stack.imgur.com/bR2xl.png)](https://i.stack.imgur.com/bR2xl.png)

**第 4 步 - 使用第 3 步中的名称使用新的自定义字体**

*迅速*

```
 label.font = UIFont(name: "SourceSansPro-Regular", size: 18) 
```

*目标 C*

```
 label.font = [UIFont fontWithName:@"SourceSansPro-Regular" size:18]; 
```

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2011-03-22T05:59:09.057

这是一步一步的说明如何做到这一点。不需要额外的库或任何特殊编码。

[http://shang-liang.com/blog/custom-fonts-in-ios4/](http://shang-liang.com/blog/custom-fonts-in-ios4/)

大多数时候问题出在字体而不是方法上。最好的方法是使用肯定会起作用的字体，比如 verdana 或 geogia。然后更改为预期的字体。如果它不起作用，可能是字体名称不对，或者字体不是格式正确的字体。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2012-03-30T10:12:55.133

在您现有的 iOS 应用程序上添加新字体非常容易。

您只需将字体（例如 font.ttf）添加到您的资源文件夹中。

打开您的应用程序`info.plist`。添加一个新行作为“应用程序提供的字体”，并将字体名称键入为 font.ttf。

设置字体时，请按`setFont:"corresponding Font Name"`

您可以通过 . 检查您的字体是否被添加`NSArray *check = [UIFont familyNames];`。

它返回您的应用程序支持的所有字体。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2010-12-07T01:16:18.193

在查找器和“获取信息”中找到 TTF。在“全名：”标题下，它给了我一个名称，然后我就可以使用它了`fontWithName`（我只是复制并粘贴了确切的名称，在这种情况下不需要“.ttf”扩展名）。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2009-04-27T22:56:36.797

还没有出来，但是下一个版本的 cocos2d（2d 游戏框架）会支持变长位图字体作为字符映射。

[http://code.google.com/p/cocos2d-iphone/issues/detail?id=317](http://code.google.com/p/cocos2d-iphone/issues/detail?id=317)

作者没有确定此版本的发布日期，但我确实看到一个帖子表明它将在未来一两个月内发布。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2011-01-15T16:40:06.250

一个重要的注意事项：您应该使用与字体关联的“PostScript 名称”，而不是其全名或姓氏。此名称通常与字体的正常名称不同。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2013-03-09T04:34:15.520

按照这个步骤

1）在你的项目中复制你的字体

2）`.plist`以源代码模式打开文件...（注意-不要打开`info.plist`）

3）在此之前 - 右键单击​​您的字体并在 fontforge 或类似的编辑器中打开它并 `install`在您的系统中，它应该是`install`

4）输入这个

```
 <key>UIAppFonts</key>
<array>
    <string>MyriadPro.otf</string>
</array> 
```

5）在您的`class .m`

```
 [lblPoints setFont:[UIFont fontWithName:@"Myriad Pro" size:15.0]]; 
```

这里的 lblPoints 会随着你的改变而改变`UILabel`

完毕！！如果您的字体仍然无法正常工作，请先检查您的字体兼容性

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2009-05-01T01:04:44.387

也许作者忘记给字体一个[Mac FOND 名称](http://www.asy.com/glossary.htm#FOND)？

1.  [在FontForge](http://fontforge.sourceforge.net/)中打开字体，然后转到 Element>Font Info
2.  有一个“Mac”选项，您可以在其中设置 FOND 名称。
3.  在文件>导出字体下，您可以创建一个新的 ttf

您也可以在导出对话框中尝试“Apple”选项。

**免责声明**：我不是 iPhone 开发者！

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2009-10-28T14:22:02.927

我一直在 iOS 3.1.2 上尝试此页面上的各种建议，这些是我的结论：

简单地使用`[UIFont fontWithName:size:]`Resources 目录中的字体是行不通的，即使 FOND 名称是使用 FontForge 设置的。

`[UIFont fontWithName:size:]`如果首先使用 GSFontAddFromFile 加载字体，它将起作用。但`GSFontAddFromFile`它不是 iOS 3.1.2 的一部分，因此必须按照@rpetrich 的描述动态加载。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2009-04-09T11:59:46.893

抬头`ATSApplicationFontsPath`

一个简单的 plist 条目，允许您将字体文件包含在您的应用程序资源文件夹中，并且它们在您的应用程序中“正常工作”。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2011-03-16T09:24:23.027

更好的解决方案是在`Fonts provided by application`您的`info.plist`文件中添加一个新属性“”。

然后，您可以像 normal 一样使用自定义字体`UIFont`。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2011-12-29T19:20:31.990

iOS 3.2及以上：使用上面几个提供的方法，分别是：

1.  将您的字体文件（例如**Chalkduster.ttf**）添加到 XCode 中项目的 Resources 文件夹。
2.  打开 info.plist 并添加一个名为 UIAppFonts 的新键。这个键的类型应该是数组。
3.  将您的自定义字体名称添加到此数组，包括扩展名（“ **Chalkduster.ttf** ”）。
4.  在您的应用程序中使用`[UIFont fontWithName:@"Real Font Name" size:16]`。

**但是** “真实字体名称”并不总是您在 Fontbook 中看到的那个。最好的方法是询问您的设备它看到哪些字体以及确切的名称是什么。

我使用 uifont-name-grabber 发布在： [uifont-name-grabber](http://forgecode.net/2010/08/uifont-name-grabber/)

只需将您想要的字体放到 xcode 项目中，将文件名添加到它的 plist，然后在您正在构建的设备上运行它，它会通过电子邮件向您发送使用`UIFont fontWithName:`预期名称的完整字体列表。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2012-09-03T16:13:27.170

我已将此页面上的一些建议合并到适用于 iOS 5 的内容中。

首先，您必须将自定义字体添加到您的项目中。然后，您需要遵循@iPhoneDev 的建议并将字体添加到您的 info.plist 文件中。

在你这样做之后，这有效：

```
UIFont *yourCustomFont = [UIFont fontWithName:@"YOUR-CUSTOM-FONT-POSTSCRIPT-NAME" size:14.0];
[yourUILabel setFont:yourCustomFont]; 
```

但是，您需要知道字体的 Postscript 名称。只需按照@Daniel Wood 的建议并在 FontBook 中按 command-i 即可。

然后，享受您的自定义字体。

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2012-09-26T09:58:53.227

首先将 .odt 格式的字体添加到您的资源中，在这种情况下，我们将使用 DINEngschriftStd.otf，然后使用此代码将字体分配给标签

```
[theUILabel setFont:[UIFont fontWithName:@"DINEngschriftStd" size:21]]; 
```

要确保您的字体已加载到项目中，只需调用

```
NSLog(@"Available Font Families: %@", [UIFont familyNames]); 
```

在 .plist 上，您必须声明字体。只需添加“应用程序提供的字体”记录并添加带有字体名称的项目 0 字符串 (DINEngschriftStd.otf)

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2013-03-19T23:39:34.097

从 iOS 4.1 开始，有一种使用自定义字体的新方法。它允许您动态加载字体，无论是来自应用程序中包含的文件、下载的数据还是您拥有的文件。它还允许您根据需要加载字体，而旧方法在应用程序启动时加载它们，如果您有很多字体，这可能需要很长时间。

新方法在[ios-dynamic-font-loading中描述](http://www.marco.org/2012/12/21/ios-dynamic-font-loading)

您使用该`CTFontManagerRegisterGraphicsFont`函数，为它提供一个包含字体数据的缓冲区。`UIFont`就像旧方法一样，它随后可用于Web 视图。这是该链接中的示例代码：

```
NSData *inData = /* your font-file data */;
CFErrorRef error;
CGDataProviderRef provider = CGDataProviderCreateWithCFData((CFDataRef)inData);
CGFontRef font = CGFontCreateWithDataProvider(provider);
if (! CTFontManagerRegisterGraphicsFont(font, &error)) {
    CFStringRef errorDescription = CFErrorCopyDescription(error)
    NSLog(@"Failed to load font: %@", errorDescription);
    CFRelease(errorDescription);
}
CFRelease(font);
CFRelease(provider); 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2015-10-29T10:53:54.010

# Swift，代码方式：（也适用于 swift 2.0）

将需要的字体添加到你的项目中（就像添加图片一样，直接拖到Xcode中），确保它们是针对你的项目
添加这个方法并加载自定义字体（推荐在`appDelegate didFinishLaunchingWithOptions`）

```
func loadFont(filePath: String) {

    let fontData = NSData(contentsOfFile: filePath)!

    let dataProvider = CGDataProviderCreateWithCFData(fontData)
    let cgFont = CGFontCreateWithDataProvider(dataProvider)!

    var error: Unmanaged<CFError>?
    if !CTFontManagerRegisterGraphicsFont(cgFont, &error) {
        let errorDescription: CFStringRef = CFErrorCopyDescription(error!.takeUnretainedValue())
        print("Unable to load font: %@", errorDescription, terminator: "")
    }

} 
```

使用示例：

```
if let fontPath = NSBundle.mainBundle().pathForResource("My-Font", ofType: "ttf"){
      loadFont(fontPath)
} 
```

使用字体：

```
UIFont(name: "My-Font", size: 16.5) 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2012-10-23T06:53:33.037

您可以在资源文件夹中添加所需的“字体”文件。然后转到项目`Info.plist`文件并使用“应用程序提供的字体”键和值作为“字体名称”。

然后就可以调用方法了`[UIFont fontwithName:@"FONT NAME" size:12];`

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2013-01-28T15:34:35.410

我使一切成为可能，但没有出现新字体，所以我找到了解决方案：

当您拖动 fot 文件（otf 或 ttf）时，不要忘记选中“添加到目标”下的复选框。

这样做之后，您的字体将出现，一切都会正常工作。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2013-05-10T21:29:10.473

虽然上面的一些答案是正确的，但我已经为仍然遇到字体问题的人写了一个详细的视觉教程。

上面的解决方案告诉您将字体添加到 plist 并使用

```
[self.labelOutlet setFont:[UIFont fontWithName:@"Sathu" size:10]]; 
```

是正确的。请现在使用任何其他骇人听闻的方式。如果您仍然面临查找字体名称和添加它们的问题，这里是教程 -

[在 ios 应用程序中使用自定义字体](http://www.codigator.com/tutorials/using-custom-fonts-in-ios-application/)

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2013-12-11T09:11:38.483

是的，您可以在应用程序中使用自定义字体

一步一步跟随那里：

*   在支持文件中将自定义字体文件添加到项目中
*   向您的文件中添加一个`Info.plist`名为 UIAppFonts 的密钥。
*   将此键设为数组
*   对于您拥有的每种字体，输入字体文件的全名（包括扩展名）作为 UIAppFonts 数组的项目
*   立即保存`Info.plist` 在您的应用程序中，您只需调用`[UIFont fontWithName:@"your Custom font Name" size:20]`即可获取自定义字体以与您的应用程序一起使用`UILabels`

应用后如果你没有得到正确的字体然后你双击自定义字体，仔细查看顶部字体名称，复制这个字体，粘贴，在这里`[UIFont fontWithName:@" here past your Custom font Name" size:20]` 我希望你能得到正确的答案

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2014-03-26T07:00:11.707

是的，您可以在应用程序中使用自定义字体

一步一步跟随那里：

在支持文件中将自定义字体文件添加到项目中

向名为 UIAppFonts 的 Info.plist 文件添加一个键。

将此键设为数组

对于您拥有的每种字体，输入字体文件的全名（包括扩展名）作为 UIAppFonts 数组的项目

保存 Info.plist 现在，在您的应用程序中，您只需调用 [UIFont fontWithName:@"your Custom font Name" size:20] 即可在应用此自定义字体后与您的 UILabels 一起使用，如果您没有获得正确的字体，则双击在自定义字体上，仔细查看顶部字体名称并复制此字体，粘贴到此处 [UIFont fontWithName:@" here past your Custom font Name" size:20]

我希望你能得到正确的答案

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-08-12T08:57:20.490

作为@bdev's [answer](https://stackoverflow.com/a/12935465/188331)的增强，这里是仅列出自定义字体的更新版本。

**第 1 步：使用@bdev 的答案找出所有系统字体并保存到文件。**

将以下代码放在第一个 View Controller 中`-(void)viewDidLoad`，之后`[super viewDidLoad]`（或在 App Delegate 中）：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                                                     NSUserDomainMask, YES);
NSMutableArray *system_fonts = [NSMutableArray array];
for (NSString *familyName in [UIFont familyNames]) {
    for (NSString *fontName in [UIFont fontNamesForFamilyName:familyName]) {
        [system_fonts addObject:fontName];
    }
}
if([paths count] > 0) {
    [system_fonts writeToFile:[[paths objectAtIndex:0]
                               stringByAppendingPathComponent:@"array.out"] atomically:YES];
} 
```

运行应用程序一次。之后停止它。

**第 2 步：将自定义字体添加到项目中**

使用接受的答案中显示的方法，添加您的自定义字体（记得更新`.plist`并添加字体文件以通过检查来构建`Add To Target`。

**步骤 3：将系统字体与当前字体列表进行比较**

将步骤 1 中的代码替换为：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                                                     NSUserDomainMask, YES);
NSMutableArray *system_fonts = [NSMutableArray arrayWithContentsOfFile:[[paths objectAtIndex:0]
                                                                        stringByAppendingPathComponent:@"array.out"]];

for (NSString *familyName in [UIFont familyNames]) {
    for (NSString *fontName in [UIFont fontNamesForFamilyName:familyName]) {
        if (![system_fonts containsObject:fontName]) {
            NSLog(@"%@", fontName);
        }
    }
} 
```

运行应用程序，您添加的自定义字体列表将显示出来。

这适用于 iOS 3.2 到 iOS 6（未来的版本可能运行良好）。也适用于`.ttc`和`.ttf`。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2017-10-11T15:35:35.440

正如所有先前的答案所表明的那样，这很有可能，并且在较新的 iOS 版本中非常容易。

我知道这不是一个技术性的答案，但是由于很多人确实做错了（因此实际上违反了许可证，如果你被起诉可能会花费你很多钱），让我在这里强调一个警告：嵌入自定义iOS（或任何其他类型）应用程序中的字体基本上是**重新分配**字体。大多数商业字体的许可证都**禁止**重新分发，因此请确保您按照许可证行事。

# multithreading - TDD 测试重构以支持多线程

> ID：360753
> 
> 赞同：7
> 
> 时间：2008-12-11T20:21:57.037
> 
> 标签：multithreading, tdd, mvp

所以我是 TDD 的新手，我成功地使用 MVP 模式创建了一个不错的小示例应用程序。我当前解决方案的主要问题是它阻塞了 UI 线程，所以我试图设置 Presenter 以使用 SynchronizationContext.Current，但是当我运行测试时 SynchronizationContext.Current 为空。

线程前的演示者

```
public class FtpPresenter : IFtpPresenter
{
    ...
    void _view_GetFilesClicked(object sender, EventArgs e)
    {
        _view.StatusMessage = Messages.Loading;

        try
        {
            var settings = new FtpAuthenticationSettings()
            {
                Site = _view.FtpSite,
                Username = _view.FtpUsername,
                Password = _view.FtpPassword
            };
            var files = _ftpService.GetFiles(settings);

            _view.FilesDataSource = files;
            _view.StatusMessage = Messages.Done;        
        }
        catch (Exception ex)
        {
            _view.StatusMessage = ex.Message;
        }
    }
    ...
} 
```

穿线前测试

```
[TestMethod]
public void Can_Get_Files()
{
    var view = new FakeFtpView();
    var presenter = new FtpPresenter(view, new FakeFtpService(), new FakeFileValidator());

    view.GetFiles();
    Assert.AreEqual(Messages.Done, view.StatusMessage);
} 
```

现在，在向 Presenter 添加了 SynchronizationContext 线程后，我尝试在我的假视图上为 StatusMessage 设置 AutoResetEvent，但是当我运行测试时 SynchronizationContext.Current 为空。我意识到我在新的 Presenter 中使用的线程模型并不完美，但这是测试多线程的正确技术吗？为什么我的 SynchronizationContext.Current 为空？我应该怎么做？

线程后的演示者

```
public class FtpPresenter : IFtpPresenter
{
    ...
    void _view_GetFilesClicked(object sender, EventArgs e)
    {
        _view.StatusMessage = Messages.Loading;

        try
        {
            var settings = new FtpAuthenticationSettings()
            {
                Site = _view.FtpSite,
                Username = _view.FtpUsername,
                Password = _view.FtpPassword
            };
            // Wrap the GetFiles in a ThreadStart
            var syncContext = SynchronizationContext.Current;
            new Thread(new ThreadStart(delegate
            {
                var files = _ftpService.GetFiles(settings);
                syncContext.Send(delegate
                {
                    _view.FilesDataSource = files;
                    _view.StatusMessage = Messages.Done;
                }, null);
            })).Start();
        }
        catch (Exception ex)
        {
            _view.StatusMessage = ex.Message;
        }
    }
    ...
} 
```

穿线后测试

```
[TestMethod]
public void Can_Get_Files()
{
    var view = new FakeFtpView();
    var presenter = new FtpPresenter(view, new FakeFtpService(), new FakeFileValidator());

    view.GetFiles();
    view.GetFilesWait.WaitOne();
    Assert.AreEqual(Messages.Done, view.StatusMessage);
} 
```

假视图

```
public class FakeFtpView : IFtpView
{
    ...
    public AutoResetEvent GetFilesWait = new AutoResetEvent(false);
    public event EventHandler GetFilesClicked = delegate { };
    public void GetFiles()
    {
        GetFilesClicked(this, EventArgs.Empty);
    }
    ...
    private List<string> _statusHistory = new List<string>();
    public List<string> StatusMessageHistory
    {
        get { return _statusHistory; }
    }
    public string StatusMessage
    {
        get
        {
            return _statusHistory.LastOrDefault();
        }
        set
        {
            _statusHistory.Add(value);
            if (value != Messages.Loading)
                GetFilesWait.Set();
        }
    }
    ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T20:31:39.000

我在 ASP.NET MVC 中遇到了类似的问题，其中缺少 HttpContext。您可以做的一件事是提供一个备用构造函数，它允许您注入一个模拟 SynchronizationContext 或公开一个做同样事情的公共 setter。如果您无法在内部更改 SynchronizationContext，则在默认构造函数中创建一个设置为 SynchronizationContext.Current 的属性，并在整个代码中使用该属性。在您的备用构造函数中，您可以将模拟上下文分配给属性——或者如果您给它一个公共设置器，您可以直接分配给它。

公共类 FtpPresenter ： IFtpPresenter { public SynchronizationContext CurrentContext { get; 放; }

```
 public FtpPresenter() : this(null) { }

   public FtpPresenter( SynchronizationContext context )
   {
       this.CurrentContext = context ?? SynchronizationContext.Current;
   }

   void _view_GetFilesClicked(object sender, EventArgs e)
   {
     ....
     new Thread(new ThreadStart(delegate
        {
            var files = _ftpService.GetFiles(settings);
            this.CurrentContext.Send(delegate
            {
                _view.FilesDataSource = files;
                _view.StatusMessage = Messages.Done;
            }, null);
        })).Start();

    ...
   } 
```

我要进行的另一项观察是，我可能会让您的演示者依赖于 Thread 类的接口，而不是直接依赖于 Thread。我不认为您的单元测试应该创建新线程，而是与模拟类进行交互，以确保调用创建线程的正确方法。您也可以注入该依赖项。

如果在调用构造函数时 SynchronizationContext.Current 不存在，您可能需要将 Current 的赋值逻辑移动到 getter 中并进行延迟加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T19:04:52.997

您的演示者中有很多应用程序逻辑。我会将上下文和线程隐藏在具体模型中并单独测试功能。

# svn - 将 Subversion 存储库移动到另一台服务器

> ID：360758
> 
> 赞同：68
> 
> 时间：2008-12-11T20:23:41.230
> 
> 标签：svn, backup, restore

我有一个托管我的 Subversion 代码库的服务器。该服务器当前是[Windows Server 2003 机器](http://en.wikipedia.org/wiki/Windows_Server_2003)，我的 IT 管理员想要将其更新到[Windows Server 2008](http://en.wikipedia.org/wiki/Windows_Server_2008)。

这意味着我需要在构建服务器时移动我的 Subversion 存储库，并且想知道将存储库移动到新服务器的最佳实践是什么。

看来，在网上看，推荐的方法是使用：

```
svnadmin dump /path/to/repository > repository-name.dmp 
```

然后使用：

```
svnadmin create repository-name
svnadmin load repository-name< repository-name.dmp 
```

导入存储库。

上面的方法似乎是最好的方法吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-12-11T20:50:12.737

是的，转储和加载存储库是一种方法。当且仅当您确定在复制过程正在进行时没有人会访问存储库时，直接复制存储库文件夹是一个可行的选择（或者您可以对存储库进行“热复制”，这可以处理这些情况以安全的方式）。

您还需要重新签出所有工作副本，或使用**svn switch**命令，该命令仅重写 URL。更方便的方法是使用 TortoiseSVN 的**Relocate**命令，它可以降低在重定位过程中出错的风险。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-12-11T21:06:57.900

我的恢复脚本是这样的：

```
svnadmin create repository-name --fs-type fsfs
svnadmin load   repository-name --force-uuid < repository-name.dmp 
```

第一行确保存储库使用`FSFS`后端（许多来源都推荐使用后端，包括这个：[如何 FSFS 更好](http://web.mit.edu/ghudson/info/fsfs)，AFAIK 较新的 Subversion 版本默认使用它）。[FSFS](https://en.wikipedia.org/wiki/Apache_Subversion#FSFS)是 Subversion 文件系统实现的名称。

第二行保留存储库的 UUID，以便更轻松地转换（没有`--force-uuid`切换，工作副本重定位将失败）。

一些链接：

*   [Subversion 管理员 - 移动存储库](http://rextang.net/blogs/work/archive/2006/05/03/3697.aspx)
*   [将 Subversion 存储库移动到另一台服务器](http://www.petefreitag.com/item/665.cfm)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-12T12:31:11.080

您还可以使用[svnsync](http://svnbook.red-bean.com/en/1.4/svn.ref.svnsync.html)移动存储库；这样您就可以传输所有数据，而无需关闭“旧”存储库。这也是我所知道的从托管环境中获取数据的唯一方法，在这些环境中，您没有 shell 访问权限或转储存储库的权限。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-10-27T07:48:19.953

另一种选择：

使用 svnrdump。 [http://www.crowbarsolutions.com/backing-up-restoring-a-remote-svn-repository/](http://www.crowbarsolutions.com/backing-up-restoring-a-remote-svn-repository/)

“您将需要一个名为 svnrdump 的工具。正如 Apache 所描述的，“svnrdump 复制了 svnadmin dump 和 svnadmin load 的功能，但适用于远程存储库，而不需要管理员（本地文件系统）访问源或目标存储库。”</p>

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-11T20:37:47.210

如果您使用的是文件系统类型的存储库，您可以直接获取包含存储库的文件夹并移动它。如果您正在更改服务器，那么您可能需要使用“重新定位”命令更改本地工作目录查找存储库的位置。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-04-16T06:35:39.350

最简单的方法是使用：

```
svnadmin hotcopy path/to/your_current_directory /path/to/your_destination_directory 
```

# php - 删除除文件名 php 以外的所有内容

> ID：360762
> 
> 赞同：3
> 
> 时间：2008-12-11T20:25:14.630
> 
> 标签：php

我试图摆脱文件名 ex 之前的所有内容：

```
/home/mike/whatever/test_1.txt 
```

只离开`test_1.txt`

最简单的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-11T20:28:13.373

[`basename()`](http://uk3.php.net/basename)

# wix - 为什么每次卸载并重新安装我的应用程序时，添加/删除程序中的应用程序大小都会增加？

> ID：360763
> 
> 赞同：1
> 
> 时间：2008-12-11T20:25:36.967
> 
> 标签：wix, windows-installer, addremoveprograms

这是一个 WiX MSI 安装程序，每次我在我的虚拟机环境中卸载并重新安装它时，添加/删除程序中报告的大小都会变大。当安装的文件只有 30MB 多一点时，它现在高达 200MB。知道这是怎么发生的以及我可能做错了什么吗？

编辑：不使用任何自定义操作，并且我没有任何用于卸载的东西，只是假设 WiX 会在卸载后自行清理，而且似乎如此。据我所知，报告的大小不正确，我找不到任何重复的文件或任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T20:31:25.910

你能把你的ARP条目吗？另外，您如何处理 wix 元素中的 RemoveOnuninstall 属性？

您是否有写入数据的 CustomAction？卸载时是否删除该数据...

尽可能填写详细信息。

我找到了这篇文章，然后它将解释您[在这里](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg15656.html)的情况，以及如何计算或几乎[计算 arp 大小](http://blogs.msdn.com/oldnewthing/archive/2004/07/09/178342.aspx)的链接；）

# java - Java 形式类型参数定义（泛型）

> ID：360766
> 
> 赞同：8
> 
> 时间：2008-12-11T20:26:14.220
> 
> 标签：java, generics

我想定义一个泛型类型，其实际类型参数只能是

1.  数字原始包装类之一 ( `Long`, `Integer`, `Float`, `Double`)
2.  `String`

我可以用这样的定义满足第一个要求

```
public final class MyClass<T extends Number> {
    // Implementation omitted
} 
```

但我不知道如何满足他们两个。我怀疑这实际上是不可能的，因为AFAIK在定义正式类型参数时无法指定“或”语义，尽管您可以使用诸如

```
public final class MyClass<T extends Runnable & Serializable > {
    // Implementation omitted
} 
```

干杯，唐

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T20:39:29.950

Java 泛型不支持联合类型（此参数可以是 A 或 B）。

在某些人可能感兴趣的相关说明中，如果您想强制执行多个限制，它确实支持多个边界。[这是 Java泛型教程](http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf)中提到的 JDK 的一个示例：

```
public static <T extends Object & Comparable<? super T>> T max(Collection<? extends T> coll) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T09:27:17.747

您可以对所有支持的类型使用工厂方法，并使构造函数私有/受保护。无论如何，您必须在构造函数中修复泛型类型以使其有意义，因此您可能可以像这样编写它：

```
public final class MyClass<T> {
    public static MyClass<Integer> newInstance(int i) {
        return new MyClass<Integer>(i);
    }
    public static MyClass<String> newInstance(String s) {
        return new MyClass<String>(s);
    }
    //More factory methods...

    protected MyClass(T obj) {
        //...
    }
} 
```

或者如果你不想要构造函数参数，像这样： public final class MyClass { public static MyClass newIntegerInstance() { return new MyClass(); } //... }

正如埃里克森所说，无论如何，通用实现只能依赖于 Object，因此唯一的限制是，除了原始类型和 String 之外，您还可以为其他类型创建其他实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T21:49:53.943

虽然泛型在这里不起作用，但具有派生类型的基类型 for`Number`和`String`会。由于泛型类型`Object`无论如何都会被删除，因此您放置在那里的任何功能都可以放在抽象基类中。您可能只需要子类上的特定于类型的访问器来获取值。

另外，`Number`上课要小心。它不限于装箱原始类型，因为任何人都可以扩展它——例如，`BigInteger`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-11T20:36:10.020

很有趣的问题，让我有些吃惊。然而显然这是不可能的。我尝试了几种不同的技巧，但都没有真正奏效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-12T13:03:46.167

也许您可以执行以下操作：

1.  制作`MyClass<T>`一个包默认类，对其他组件不可见，或者至少只使用包默认ctors，这样它就不能在包之外扩展或实例化。
2.  在以下包中创建两个公共类`MyClass<T>`：

> ```
> MyNumericClass<T extends Number> extends MyClass<T>
> MyStringClass extends MyClass<String> 
> ```

这样，MyClass 的所有子类将被限制为使用 Number 子类或 String 参数化的那些。

# flash - FLASH 自动循环禁用

> ID：360777
> 
> 赞同：2
> 
> 时间：2008-12-11T20:31:00.357
> 
> 标签：flash, loops

我有一个动画，我希望它只播放一次。我可以从哪里设置，所以当我导出到 SWF 时，默认设置为禁用自动循环。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T21:46:57.303

在最后一帧插入关键帧并放置一个 stop(); 那里？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-05T07:41:02.550

请按照代码

```
<param name='loop' value='false' />

<object type='application/x-shockwave-flash' data='sourcefile' width='300' height='120' loop='false'> 
```

这完美地工作

# python - 在python中提取ipv6前缀

> ID：360782
> 
> 赞同：1
> 
> 时间：2008-12-11T20:33:39.183
> 
> 标签：python, ipv6

给定 IPv6 地址的二进制或字符串表示形式及其前缀长度，在 Python 中提取前缀的最佳方法是什么？

是否有图书馆可以为我做这件事，或者我必须：

1.  将地址从字符串转换为 int (inet_ntop)
2.  屏蔽前缀
3.  将前缀转换回二进制
4.  将二进制转换为字符串 (inet_ntop)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T21:21:41.753

请参阅[http://code.google.com/p/ipaddr-py/](http://code.google.com/p/ipaddr-py/)

有了这个，你可以做

```
py> p=ipaddr.IPv6("2001:888:2000:d::a2")
py> p.SetPrefix(64)
py> p
IPv6('2001:888:2000:d::a2/64')
py> p.network_ext
'2001:888:2000:d::' 
```

等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-05T12:10:32.453

使用 python [netaddr](https://github.com/drkjam/netaddr)库：

```
>>> from netaddr.ip import IPNetwork, IPAddress
>>> IPNetwork('2001:888:2000:d::a2/64').network
2001:888:2000:d:: 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-31T12:47:19.117

您还可以编写一个自己的小函数来提取 IPv6 前缀：

```
# Returns the IPv6 prefix
def getIPv6Prefix(ipv6Addr, prefixLen):
    prefix = ""
    curPrefixLen = 0
    ipv6Parts = ipv6Addr.split(":")
    for part in ipv6Parts:
        if not prefix == "": # if it's not empty
            prefix = prefix + ":"
        prefix = prefix + part
        curPrefixLen += 32
        if int(curPrefixLen) >= int(prefixLen):
            return prefix
    return prefix 
```

# c# - 在 C# 中，在继续处理 UI 更新的同时等待主线程？（.NET 2.0 CF）

> ID：360789
> 
> 赞同：3
> 
> 时间：2008-12-11T20:37:07.787
> 
> 标签：c#, multithreading

我想以其他方式阻止主线程上的代码执行，同时仍允许显示 UI 更改。

我试图想出一个我正在尝试做的简化示例版本；这是我能想到的最好的。显然，它不能证明我想要的行为，否则我不会发布问题。我只是希望它提供一些代码上下文来支持我对我希望解决的问题的糟糕解释。

在表单上的按钮单击处理程序中，我有这个：

```
 private void button2_Click(object sender, EventArgs e)
    {
        AutoResetEvent autoResetEvent = new AutoResetEvent(false);

        new Thread(delegate() 
        {
            // do something that takes a while.
            Thread.Sleep(1000);

            // Update UI w/BeginInvoke
            this.BeginInvoke(new ThreadStart(
                delegate() { 
                    this.Text = "Working... 1";
                    this.Refresh();
                    Thread.Sleep(1000); // gimme a chance to see the new text
                }));

            // do something else that takes a while.
            Thread.Sleep(1000);

            // Update UI w/Invoke
            this.Invoke(new ThreadStart(
                delegate() {
                    this.Text = "Working... 2";
                    this.Refresh();
                    Thread.Sleep(1000); // gimme a chance to see the new text
                }));

            // do something else that takes a while.
            Thread.Sleep(1000);

            autoResetEvent.Set();
        }).Start();

        // I want the UI to update during this 4 seconds, even though I'm 
        // blocking the mainthread
        if (autoResetEvent.WaitOne(4000, false))
        {
            this.Text = "Event Signalled";
        }
        else
        {
            this.Text = "Event Wait Timeout";
        }
        Thread.Sleep(1000); // gimme a chance to see the new text
        this.Refresh();
    } 
```

如果我没有在 WaitOne() 上设置超时，则应用程序将在 Invoke() 调用上死锁。

* * *

至于我为什么要这样做，我的任务是移动应用程序的一个子系统以在后台线程中工作，但它仍然只有时会阻塞用户的工作流（主线程），并且对于某些类型的仅与该子系统相关的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T20:43:53.123

您想使用“ [BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx) ”类，它将为您消除大部分痛苦。但如前所述，您还需要对其进行结构化，以便主线程正在更新 UI，而工作者是做繁重的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T21:11:22.693

这比你想象的要容易。

建议：当你需要一个线程来执行一些偶尔的工作时，从线程池中获取它，这样你就不需要奇怪/容易出错的回收代码。

当您希望另一个线程上的某些内容更新您的 UI 时，您只需要对表单的引用并调用 Form.Invoke 传递您希望主线程执行的 UI 代码；最好的做法是尽快释放 UI 线程。

IE：

```
private void button1_Click(object sender, EventArgs e)
{
    // this is the UI thread

    ThreadPool.QueueUserWorkItem(delegate(object state)
    {
        // this is the background thread
        // get the job done
        Thread.Sleep(5000);
        int result = 2 + 2;

        // next call is to the Invoke method of the form
        this.Invoke(new Action<int>(delegate(int res)
        {
            // this is the UI thread
            // update it!
            label1.Text = res.ToString();
        }), result);
    });
} 
```

希望这对你有帮助:)

编辑：对不起，我没有阅读“阻止用户工作流程”部分。

WindowsForms 不是为此而设计的，阻塞主线程是不好的（它处理来自操作系统的消息）。

您不必通过冻结表单来阻止用户工作流程（然后将被窗口视为“不响应”），阻止用户工作流程的方法是禁用您想要的任何控件（如果来自另一个，则使用上面的 Invoke 方法线程），甚至整个表格！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T21:11:25.363

“阻塞”主线程的常见活动是打开消息框或模式对话框之类的事情。主代码似乎在 MessageBox 或 ShowDialog 调用处阻塞。

这些项目的工作方式（MessageBox 只是一个专门的模式对话框）是它们在阻塞时包含自己的消息泵。

虽然这是一个令人讨厌的 hack，但您可以在您的应用程序中执行类似的操作，方法是循环调用 Application.DoEvents() 以在您等待其他任务完成时保持用户消息不断涌现。您需要小心，因为像这样的泵送消息可能会导致各种讨厌的事情 - 例如有人关闭表单或重新输入您当前的消息处理程序 - 模式对话框通过有效地禁用启动它们的表单的输入来避免这种情况。

我的意思是说 BackgroundWorker 是一个更好的解决方案，如果你能使它适合的话。我有时将它与模态“进度对话框”结合起来，为我提供后台线程/消息泵送和 UI 线程的阻塞。

编辑 - 扩展最后一点：

我使用的一种方法是创建一个“进度表单”类，该类将 BackgroundWorker 对象作为构造函数参数，并包含传递给它的后台工作者的进度和完成事件的处理程序。

想要完成工作的表单会创建后台工作人员并连接“工作”事件（现在不记得它叫什么了），然后创建一个进度对话框，它将后台工作人员传递给该对话框。然后它以模态方式显示进度对话框，这意味着它将等待（但泵送消息）直到进度对话框关闭。

进度表单负责从其 OnLoad 覆盖启动 BackgroundWorker，并在看到 BackgroundWorker 完成时自行关闭。显然，您可以在进度表单中添加消息文本、进度条、取消按钮等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-11T20:41:01.883

构建您的应用程序，以便主线程仅执行 UI 更新，而所有其他工作都通过工作队列在辅助线程上完成；然后在主线程中添加一个 waiting-for-godot 标志，并使用它来保护将项目添加到工作队列的方法

出于好奇：你为什么要这样做？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-11T21:18:52.633

您可能应该按照其他人的建议重构您的代码，但根据您正在寻找的行为，您可能还想看看在后台工作线程上使用 Thread.Join。Join 实际上允许调用线程在等待其他线程完成时处理 COM 和 SendMessage 事件。这似乎在某些情况下可能很危险，但我实际上有几个场景，这是等待另一个线程干净完成的唯一方法。

> Thread..::.Join 方法
> 
> 阻塞调用线程直到线程终止，同时继续执行标准 COM 和 SendMessage 泵送。

（来自[http://msdn.microsoft.com/en-us/library/95hbf2ta.aspx](http://msdn.microsoft.com/en-us/library/95hbf2ta.aspx)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T21:24:42.807

我同意其他建议您使用后台工作人员的观点。它完成了繁重的工作并允许 UI 继续。您可以使用后台工作人员的报告进度来启动可以将主窗体设置为在后台执行操作时禁用的时间，然后在“某些实例”完成处理后重新启用。

让我知道这是否有帮助！联合部队

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T21:46:41.250

如果您可以调整代码，以便在流程开始后设置一个标志，然后在开始其他操作之前在 UI 中检查它，我认为您可以更轻松地编写此代码。我将创建一个委托，该委托可以从线程池中的线程或用户创建的线程中调用，以更新 UI 中的进度。后台进程完成后，切换标志，现在可以继续正常的 UI 操作。您需要注意的唯一警告是，当您更新 UI 组件时，您必须在创建它们的线程（主/UI 线程）上执行此操作。为了实现这一点，您可以在该线程上的任何控件上调用 Invoke() 方法，并将调用它所需的委托和参数传递给它。

这是我前段时间写的关于如何使用 Control.Invoke() 的教程的链接：

[http://xsdev.net/tutorials/pop3fetcher/](http://xsdev.net/tutorials/pop3fetcher/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T08:56:31.053

只是一个代码片段：没有太多时间抱歉:)

```
 private void StartMyDoSomethingThread() {
        Thread d = new Thread(new ThreadStart(DoSomething));
        d.Start();
    }

    private void DoSomething() {
        Thread.Sleep(1000);
        ReportBack("I'm still working");
        Thread.Sleep(1000);
        ReportBack("I'm done");
    }

    private void ReportBack(string p) {
        if (this.InvokeRequired) {
            this.Invoke(new Action<string>(ReportBack), new object[] { p });
            return;
        }
        this.Text = p;
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-15T18:45:50.123

最好调度工作，但如果必须，也许是这样的。只需调用此方法等待信号而不是调用waitone。

```
private static TimeSpan InfiniteTimeout = TimeSpan.FromMilliseconds(-1); 
private const Int32 MAX_WAIT = 100; 

public static bool Wait(WaitHandle handle, TimeSpan timeout) 
{ 
    Int32 expireTicks; 
    bool signaled; 
    Int32 waitTime; 
    bool exitLoop; 

    // guard the inputs 
    if (handle == null) { 
        throw new ArgumentNullException("handle"); 
    } 
    else if ((handle.SafeWaitHandle.IsClosed)) { 
        throw new ArgumentException("closed wait handle", "handle"); 
    } 
    else if ((handle.SafeWaitHandle.IsInvalid)) { 
        throw new ArgumentException("invalid wait handle", "handle"); 
    } 
    else if ((timeout < InfiniteTimeout)) { 
        throw new ArgumentException("invalid timeout <-1", "timeout"); 
    } 

    // wait for the signal 
    expireTicks = (int)Environment.TickCount + timeout.TotalMilliseconds; 
    do { 
        if (timeout.Equals(InfiniteTimeout)) { 
            waitTime = MAX_WAIT; 
        } 
        else { 
            waitTime = (expireTicks - Environment.TickCount); 
            if (waitTime <= 0) { 
                exitLoop = true; 
                waitTime = 0; 
            } 
            else if (waitTime > MAX_WAIT) { 
                waitTime = MAX_WAIT; 
            } 
        } 

        if ((handle.SafeWaitHandle.IsClosed)) { 
            exitLoop = true; 
        } 
        else if (handle.WaitOne(waitTime, false)) { 
            exitLoop = true; 
            signaled = true; 
        } 
        else { 
            if (Application.MessageLoop) { 
                Application.DoEvents(); 
            } 
            else { 
                Thread.Sleep(1); 
            } 
        } 
    } 
    while (!exitLoop); 

    return signaled;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-20T16:31:07.443

我选择了一些我还没有看到的东西，那就是使用 MessageQueues。

*   MainThread 在等待队列中的下一条消息时阻塞。
*   后台线程将不同类型的消息发布到 MessageQueue。
*   一些消息类型向 MainThread 发出信号以更新 UI 元素。
*   当然，还有一条消息告诉 MainThread 停止阻塞和等待消息。

考虑到 Windows 消息循环已经存在于某处，似乎太过分了，但它确实有效。

# servlets - Liferay：servlet和portlet的初始化顺序

> ID：360805
> 
> 赞同：0
> 
> 时间：2008-12-11T20:41:41.600
> 
> 标签：servlets, portlet, liferay

我认为过去的情况是，在 Liferay 4 中，如果战争同时包含 portlet 和 servlet，则 servlet 在 portlet 之前被初始化。现在有了 Liferay 5，我注意到情况正好相反。如何设置我的 Web 应用程序或 Liferay 以始终在 portlet 之前初始化 servlet？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T22:18:27.100

虽然 Liferay 4 延迟加载 portlet，但由于性能相关问题，Liferay 5 在部署 Web 应用程序时积极加载 portlet。

因此，解决方案是在初始化 servlet 时代替（或另外）进行初始化，而是在初始化 servlet 上下文侦听器时进行，这发生在初始化 portlet 之前。[这些说明](http://www.orbeon.com/ops/doc/integration-portlets#portlet-deployment-liferay)的第 1 步中有更多详细信息。

# jquery - jquery 日期选择器

> ID：360816
> 
> 赞同：2
> 
> 时间：2008-12-11T20:45:25.773
> 
> 标签：jquery

出于某种原因，我不能将`runat="server"`其用作输入标记的属性，以便 jQuery 显示图像按钮并正常工作。没有 有什么问题`runat="server"`吗？它工作正常。我希望格式为“yyyy/mm/dd”，并且我也需要它用于服务器，因为这是我检查手动输入的日期是否为有效日期以及它是否与接受的格式匹配的地方。我真的很想使用 an`asp:button`但由于我不能使用`runat="server"`属性我不知道该怎么做，因为这是 asp 控件所必需的

```
<script language="javascript" type="text/javascript">

  $(document).ready(function(){
    $("#datepicker").datepicker({ showOn: "both", 
                                  buttonImage: "/Content/img/calendar.gif", 
                                  buttonImageOnly: true });
  }); 

</script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-11T20:50:40.957

当您使用 runat='server' 时，它会将您的 id 从“#datepicker”更改为“form1_ctl01_ctl05_datepicker”或其他内容

编辑：对于解决方案，您可以根据 css 类而不是 ID 来选择它

```
<input id='datepicker' runat='server' class='datepicker' />

$(document).ready(function(){
$(".datepicker").datepicker({ showOn: "both", 
                              buttonImage: "/Content/img/calendar.gif", 
                              buttonImageOnly: true });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T20:59:28.990

对于带有 runat="server" 的控件，aspnet 会为呈现的 html 控件生成自己的、相当难看的 id。

如果您的脚本在实际页面上，您可以将
$("#datepicker") 替换为 $("#<%= datepicker.ClientID %>")，
这将输出 aspnet 生成的损坏的 id，或者，如 Jimmy 建议的那样，改为使用 css 类来定位它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T22:21:29.313

为后代：

使用`runat='server'`标签时，添加`clientidmode='static'`到您的元素标签以防止生成的 id 被破坏。在复杂或嵌套的表单上，这可能会混淆控件 ID 的唯一性，这就是为什么它们默认以元素父级的 ID 为前缀的原因。

ps css 类可能是处理日期选择器的最佳方式（恕我直言），因此接受的答案看起来不错。

# javascript - 哪个 javascript 缩小库产生更好的结果？

> ID：360818
> 
> 赞同：12
> 
> 时间：2008-12-11T20:46:05.647
> 
> 标签：javascript, benchmarking, jscompress, minify

[雅虎](http://developer.yahoo.com/yui/compressor/)之间！[UI Compressor](http://developer.yahoo.com/yui/compressor/)、[Dean Edwards Packer](http://dean.edwards.name/packer/)和[jsmin](http://www.crockford.com/javascript/jsmin.html)，它们产生了更好的结果，无论是在占用空间方面还是在混淆时的错误更少。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-11T21:26:40.090

比较最佳压缩器的一个好方法是Arthur Blake[的 JavaScript CompressorRater](http://compressorrater.thruhere.net/)。

您通常感兴趣的是使用 GZIP 压缩后的大小（您应该配置您的 Web 服务器以执行压缩）。

最好的结果通常来自[YUI Compressor](http://developer.yahoo.com/yui/compressor/)或[Dojo ShrinkSafe](http://dojotoolkit.org/docs/shrinksafe)。差异是如此之小，以至于过了一会儿我停止了比较，我只使用了 YUI Compressor。

**编辑：** 自从最初提出这个问题以来，已经发布了 2 个新的缩小器。它们通常至少与 YUI Compressor 一样好，甚至更好。

*   谷歌的[闭包编译器](http://code.google.com/closure/compiler/)。包括有时适用的激进的[高级优化](http://code.google.com/closure/compiler/docs/api-tutorial3.html)模式。
*   Microsoft 的 Ajax Minifier（[在此页面](http://aspnet.codeplex.com/releases)搜索“minifier”）

**编辑2：**

*   [UglifyJS](https://github.com/mishoo/UglifyJS)，由 jQuery 团队选择用于官方 1.5 版本

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T20:59:25.463

更好在这里有点主观，因为需要考虑多个因素（甚至超出您列出的因素）：

1.  压缩大小并不能说明全部情况，因为在浏览器解释之前运行解包代码需要额外的时间，因此激进的压缩器可能会导致运行时性能变慢。
    *   当您控制输入代码时，最容易避免错误 - 明智地使用分号大有帮助。在您的代码上运行 JSLint，并修复任何报告的问题。
    *   当然，代码本身的样式和大小会影响结果。
    *   最后，值得牢记的是，服务器端 gzip 压缩总是会比任何代码压缩产生更小的下载量，尽管一些代码压缩工具会更有效地与 gzip 结合使用。

我的建议是通过多个压缩器运行您打算压缩的代码（诸如[CompressorRater](http://compressorrater.thruhere.net/)之类的自动比较工具可以帮助...），并根据结果进行选择 - 记住在之后测试、分析和比较实际的页面加载时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T22:17:30.597

一定要看看[Dojo Shrinksafe](http://dojotoolkit.org/docs/shrinksafe)。它最近被重新设计，显然性能得到了改善。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-25T14:36:06.140

完全披露，我支持：[http](http://www.toptensoftware.com/minime) ://www.toptensoftware.com/minime ，它进行缩小、混淆和一组合理的 lint 样式检查。目前它产生的输出比 Yui 小，不如 Closure 好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-29T09:10:53.273

这是一个老问题，当时还不存在[Google Closure Compiler 。](http://code.google.com/closure/compiler/)我还没有使用它，但它看起来**非常**好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T20:56:00.697

作为一名 Mootools 用户，我注意到 Mootools 已经用 YUI Compressor 取代了 Dean Edwards 的 Packer。我还记得 Ajaxian.com 上有一个讨论，其中 Julien（Compressor 的作者）指出了 YUI Compressor 做得更好的领域。我使用了 Compressor 并且从未发现任何问题，但我从未研究过在混淆时哪个产生的错误更少。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T21:13:54.313

YUI Compressor 的压缩比 Packer 更安全、更紧凑。我相信 Packer 需要完美地形成 JavaScript，否则在加载脚本时会导致 JavaScript 错误。尽管如此，无论您使用哪个，通过 Gzip 压缩文件，您都将获得最大的性能提升。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T02:11:03.753

[Codeplex 上还有一个用于 .NET 的 YUICompress](http://www.codeplex.com/YUICompressor "继续 - 点击我！")端口（其中包括 TFS 的构建任务）。

# sql-server - SQL Server 到 Excel 2007 - 新行

> ID：360830
> 
> 赞同：1
> 
> 时间：2008-12-11T20:50:22.393
> 
> 标签：sql-server, excel, csv, sql-server-2000

我正在尝试从 SQL Server 2000 服务器检索数据，并将其放入 Excel。我知道这听起来很简单。我目前正在从 Management Studio 复制并粘贴到 Excel 中

问题是其中一列是地址，它没有保留换行符。这些新行必须保留在 excel 中的同一单元格中，IE 不能占用 3 行，用于 3 行地址。

在 SQL 数据中包含 CHAR(10) 和 CHAR(13)，并且其他软件正确地选择了这些。

编辑：对不起，我忘了提及，我希望这些线条出现在单元格中，但不跨越多个单元格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-11T21:01:32.357

尝试在工作表上运行此宏。（右键单击工作表选项卡，然后单击“查看代码”以调用 VB IDE。）

```
Sub FixNewlines()
    For Each Cell In UsedRange
        Cell.FormulaR1C1 = Replace(Cell.FormulaR1C1, Chr(13), "")
    Next Cell
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T21:08:53.247

出于某种原因，Excel 似乎以相反的方式使用这些字符，即：

```
"a" & Chr(13) + Chr(10) & "b" 
```

# c# - SOAP Web 服务：多台服务器，一个接口

> ID：360831
> 
> 赞同：2
> 
> 时间：2008-12-11T20:50:39.977
> 
> 标签：c#, .net, web-services, soap, wsdl

我有一个场景，我需要任意数量的服务器来提供相同的 SOAP Web 服务。我想生成一组代理类，并能够为它们提供一个位置，以便在运行时将它们指向不同的服务器。不幸的是，它看起来好像`wsdl:port`节点（`wsdl:service`) 要求对特定服务器的地址进行硬编码。看来，由于这个原因，URL 将被烘焙到我的代理类中。我知道我可以通过手动编辑生成的代理类或修改代码生成来修改它，但我真的不想诉诸于此。我觉得必须有更好的方法来解决这个问题。我只想将接口定义与服务所在的位置分离。如果有任何帮助，我正在使用 VS2008 和 C#.NET，尽管最好是针对此问题的与语言无关（特定于 SOAP 或 WSDL）的通用解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-11T21:17:10.017

不，在 .NET 中，您可以在运行时更改 URL。

```
Service svc = new Service ();
svc.url = "Value read from config. file or some such"
output = svc.method (input); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-11T21:19:34.503

如果您使用 WebReference（WCF 之前的版本）访问 Web 服务，则可以在创建 Web 服务代理类后简单地设置 Url 属性。

对于 WCF，您可以为代理类构造函数提供不同的端点地址，而不是使用默认值（以及其他可能的解决方案）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T21:46:36.117

为什么不对 Web 服务器进行负载平衡，然后为负载平衡的 IP 地址创建一个 DNS 条目……本质上是创建一个 Web 场。这将允许您引用主机名而不是静态 IP 地址，如果您需要更改负载均衡器或 Web 服务器的 IP 地址，则只需一次更改。此外，您还可以进行冗余和性能控制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T12:41:25.757

这是关于如何确定 WSDL 的 URL 的提示。我只是在更改端口，但当然可以使其更先进。

```
public class PortChangeReflector : SoapExtensionReflector
{     
    public override void ReflectDescription()
    {
        ServiceDescription description = ReflectionContext.ServiceDescription;
        foreach (Service service in description.Services)
        {
            foreach (Port port in service.Ports)
            {
                foreach (ServiceDescriptionFormatExtension extension in port.Extensions)
                {
                    SoapAddressBinding binding = extension as SoapAddressBinding;
                    if (binding != null && !binding.Location.Contains("8092"))
                    {
                        binding.Location = binding.Location.Replace("92", "8092");
                    }
                }
            }
        }
    }
} 
```

将其放入您的`Add_Code`并将以下引用添加到您的*web.config*。

```
<webServices>
     <soapExtensionReflectorTypes>
          <add type="Dev.PortChangeReflector,App_Code"/>
     </soapExtensionReflectorTypes>
</webServices> 
```

我希望你能对此有新的想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T20:44:31.073

最简单的解决方案是使用软件负载平衡器，例如[HAProxy](http://haproxy.1wt.eu/)。以更高的成本，您可以使用[Big-IP](http://www.f5.com/products/big-ip/)等硬件解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T20:57:47.573

当您向项目添加 Web 引用时，它会将 Web 服务的地址放入您的应用程序/Web 应用程序的 .config 文件中。然后，您可以简单地在配置文件中更改此设置以指向不同的 Web 服务位置，当然假设服务是相同的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T22:00:29.850

客户端代理具有您可以在运行时设置的 URL 属性。为了使其更简单，wsdl.exe 实用程序具有`/appsettingurlkey`密钥。当您生成客户端代理时，它的构造函数将检查 appSettings 中的密钥并相应地设置服务 URL。我相信 WCF 也有这个功能。

但是，我同意@Matt 并建议您从长远来看将负载平衡视为最佳解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T06:54:00.960

1.  Is this for scaling (each server provides the same data) or
2.  for same API different data on each server?

For 2, then you can do as above, just change the service URL in code.

For 1, you could use round-robin DNS (e.g. you see multiple servers with at the command line type `nslookup www.google.com`).

# sharepoint - 使用“查找版”共享点列表中的字段

> ID：360833
> 
> 赞同：2
> 
> 时间：2008-12-11T20:50:56.900
> 
> 标签：sharepoint, sharepoint-2007

我有两个 Sharepoint 列表： - 作业 - 活动

由于活动（例如 X 的每月回顾）与任务相关，因此活动列表具有任务列表的查找字段。

我的问题是，如何使用标准 Sharepoint 2007 在活动视图中显示作业中的其他字段（我们对使用 SP Designer 或 Visual Studio 有限制，因为它是“标准”企业环境）？

前任

**作业**

```
Assignment    Frequency    Area       Assigned To 
Read X        Monthly      Finance    Bill 
```

**活动**

```
Assignment    Date        Action
Read X        2-Mar-08    No actions needed
Read X        3-Apr-08    Adjust Y 
```

**所需的 SharePoint 列表（查看/排序/筛选）**

```
Assignment    Frequency    Area       Assigned To    Date        Action
Read X        Monthly      Finance    Bill           2-Mar-08    No actions needed
Read X        Monthly      Finance    Bill           3-Apr-08    Adjust Y 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T15:19:34.563

如果您不能使用 SPD 中的数据视图 Web 部件，那么我认为您将不得不使用内容编辑器 Web 部件并在 javascript 中完成这一切。[介绍文章](http://www.cleverworkarounds.com/2008/02/28/more-sharepoint-branding-customisation-using-javascript-part-2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T16:55:49.413

我想出了一个不使用 Sharepoint 设计器的解决方法，但它有点破解。在 MS Access 中，我将两个表链接到我的每个 Sharepoint 列表，并创建了一个将它们链接在一起的查询。然后我创建了一个 Excel 文件并将其放在引用 MS Access 文件的 Sharepoint 上（Excel 文件有一个指向编辑字段的超链接）。

# .net - 从页面后面的代码调用用户控件中的函数

> ID：360836
> 
> 赞同：5
> 
> 时间：2008-12-11T20:51:47.867
> 
> 标签：.net, asp.net, user-controls, .net-2.0, code-behind

现在这一切都被简化了，但这里是：

我有一个仅包含一个 *.ascx 文件的用户控件。该控件没有代码隐藏：它只是一个带有一些函数的脚本，如下所示：

```
<%@ Control Language="VB" EnableViewState="False" ClassName="MyControlType" %>
<script runat="server">
    Public Function MyFunction() As String
       return "CalledMyFunction!"
    End Function
</script> 
```

这就是整个文件。我可以使用如下标记成功将此控件添加到 aspx 页面：

```
<%@ Register Src="~/path/to/Control.ascx" TagPrefix="aaa" TagName="MyControl" %>
...
<aaa:MyControl runat="server" id="MyControl1" /> 
```

现在我想做的是从页面的代码隐藏中调用 MyFunction ，如下所示：

```
Dim someString As String = MyControl1.MyFunction() 
```

不幸的是，我不能那样做。相反，我得到一个编译错误，效果是“ `'MyFunction' is not a member of 'System.Web.UI.UserControl'.`”

我也试过这个：

```
Dim someString As String = DirectCast(MyControl1, MyControlType).MyFunction() 
```

然后编译器告诉我，“ `Type 'MyControlType' is not defined.`”

我已经玩了很多次，但我就是无法让它发挥作用。将 MyControl1 转换为更精确类型的所有努力都失败了，其他解决方法也是如此。我怀疑问题是没有代码隐藏的 ascx 文件无法编译为程序集，但代码隐藏想要编译为程序集，因此编译器对控件的类型感到困惑。

我需要做什么才能调用该函数？

[编辑]
所以我只需要为用户控件添加代码隐藏。无论如何，这是我想做的。不过，我仍然想知道如何在不需要的情况下做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T21:42:31.150

奇怪对我有用。

```
Imports Microsoft.VisualBasic

Public Class MyControlType
    Inherits UserControl
End Class 
```

.

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="Default.aspx.vb" Inherits="_Default" %>
<%@ Register Src="~/WebUserControl.ascx" TagPrefix="aaa" TagName="MyControl"  %>
...
<aaa:MyControl runat="server" id="MyControl1"  /> 
```

.

```
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Overrides Sub OnLoad(ByVal e As System.EventArgs)
        Dim someString As String = MyControl1.MyFunction()
    End Sub

End Class 
```

.

```
<%@ Control Language="VB" EnableViewState="False"  %>
<script runat="server">
    Public Function MyFunction() As String
       return "CalledMyFunction!"
    End Function
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T01:45:44.450

这就是我所做的。

1.  创建一个新网站。
2.  添加新的 Web 用户控件 - 确保取消选中该对话框上的“将代码放在单独的文件中”复选框。
3.  将函数放在生成的 .ascx 中
4.  在 default.aspx 中注册控件并运行

WebUserControl.ascx 的内容

```
 <%@ Control Language="VB" ClassName="WebUserControl" %>

<script runat="server">
    Public Function MyFunction() As String
        Return "CalledMyFunction!"
    End Function
</script> Default.aspx 的内容

```
 <%@ Page Language="VB" AutoEventWireup="false" CodeFile="Default.aspx.vb" Inherits="_Default" %>
<%@ Register Src="WebUserControl.ascx" TagPrefix="aaa" TagName="MyControl" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    <aaa:MyControl runat="server" ID="mycontrolid" />
    <%
        Dim i As String = mycontrolid.MyFunction()
        Response.Write(i)
     %>
    </div>
    </form>
</body>
</html> 
```

            回答 #3

赞同：0

时间：2008-12-11T21:35:02.523

我做的 VB 不多（更像是一个 C# 人），但我认为我已经完成了这项工作！

你在 runat 上有一个错字：

```
<script ruant="server"> 
```

尝试修复它，它的工作原理！

            回答 #4

赞同：0

时间：2008-12-11T21:41:33.897

我相信你需要从 WebUserControl 派生。

在您的 .ascx“控制”标签中放置以下内容：

继承="WebApplication1.WebUserControl1"

当然，您需要使用正确的名称。

            回答 #5

赞同：0

时间：2008-12-11T20:59:33.403

确保代码隐藏中的 MyControl1 对象是 MyControlType 类型，并且在调用该函数时被强制转换。编译器声明它在 UserControl 的基类中找不到方法 MyFunction()。

            回答 #6

赞同：0

时间：2008-12-11T23:23:16.720

该问题与没有定义该类的代码隐藏文件有关。只要将公共函数放在代码隐藏文件中，它就可以工作。我认为 ASP.NET 将该函数更像是匿名函数而不是类中的实际函数。

反正这是我的想法。

            回答 #7

赞同：-1

时间：2010-03-11T15:38:22.960

将其放在声明后面的代码中

```
protected <solutionName>.<controlName> myControl1; /*C#*/ 
```

这里 myControl1 是您的用户控件的 id。现在你可以调用这个控件的公共函数了。

            回答 #8

赞同：-1

时间：2014-02-05T09:06:08.887

您必须在 vb 文件中添加您的 vb 代码

```
Public Function MyFunction() As String
        Return "CalledMyFunction!"
    End Function 
```

        c# - 如何将集成安全性和自己的用户数据库与 IIS/C# 3.5 混合使用？

ID：360838

赞同：1

时间：2008-12-11T20:52:38.630

标签：c#, security, iis, authentication

是否可以在一个站点中混合所有这些访问控制？

我有一个要求说

*   a) 必须允许 AD 中的用户使用集成安全性进行访问
*   b) 必须允许来自其他 AD 的用户访问；可能通过登录
*   c) 不在 AD 中的用户应该能够在网站上创建一个新帐户。

现在，当然，我希望该站点不关心用户在哪里进行了身份验证；只是他是。

实现这一目标的最佳方法是什么？

            回答 #1

赞同：1

时间：2008-12-11T21:44:39.117

不久前我在一个项目上做了这样的事情，它的工作原理是这样的：

我将应用程序设置为使用表单身份验证，并在 IIS 中启用匿名访问。

我创建了一个标准的表单身份验证登录页面，该页面接受用户 ID 和密码来进行非集成登录。

我还为集成安全登录制作了一个特殊的 .aspx 页面，并仅设置该页面以在 IIS 中使用集成安全（而不是匿名访问）。此页面根据来自 IIS 的凭据手动创建了表单身份验证票证。

在主 Forms Authentication 登录页面中，我查看了请求中的传入地址，看它是否来自 LAN，如果是，则重定向到集成安全登录页面（因此没有提示用户输入用户 ID 和密码，它只是用集成的安全性登录它们）。

我还使表单身份验证登录页面足够智能，可以根据您的用户 ID 确定您是否是 AD 用户，如果是，则针对 AD 执行 LDAP 查找以检查您的密码。这使得拥有 AD 帐户的用户即使不在 LAN 上也可以使用其 AD 凭据登录（因此不使用集成安全性）。对于非 AD 用户，验证是针对应用程序维护的用户 ID 和密码哈希的单独列表进行的。

            回答 #2

赞同：0

时间：2008-12-11T21:42:16.143

[我想这个人自己](http://www.mail-archive.com/advanced-dotnet@discuss.develop.com/msg12098.html)有一个答案。基本上，您应该使用通常的 asp.net 会员提供程序模型。但是创建您自己的自定义提供程序来包装活动目录和 sql 提供程序。也许是两个不同的活动目录提供商。

        asp.net - 从 JavaScript 调用多个 __doPostBack

ID：360843

赞同：0

时间：2008-12-11T20:54:23.150

标签：asp.net, asp.net-ajax, updatepanel, postback

我在一个页面上有多个 UpdatePanel，我正在通过调用 __doPostBack 手动更新其中的 2 个。然而问题是，当第二次调用时，第一次调用似乎被重置（它永远不会更新我要求首先更新的面板）。我已经将这些调用包含在 setTimeout 中，但它似乎没有帮助。

关于如何使这两个电话工作的任何建议？

            回答 #1

赞同：1

时间：2008-12-11T23:19:26.023

您可能可以在服务器端执行此操作：

```
UpdatePanel1.Update();
UpdatePanel2.Update(); 
```

这会导致提交的返回包含两个面板的更新信息，而不是一次只有一个。但是，我相信需要为条件更新设置更新面板。

另外，另一个问题，您是否有在更新面板中调用 setTimeout 的脚本？还是在其他地方，这可能是罪魁祸首，但我不知道那个。

        mysql - MySQL按位运算，布隆过滤器

ID：360844

赞同：9

时间：2008-12-11T20:54:38.640

标签：mysql, bit-manipulation

我想使用 MySQL 实现一个[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter)（其他建议的替代方案）。

问题如下：

假设我有一个存储 8 位整数的表，具有以下值：

```
1: 10011010
2: 00110101
3: 10010100
4: 00100110
5: 00111011
6: 01101010 
```

我想找到所有按位与此的结果：

```
00011000 
```

结果应该是第 1 行和第 5 行。

但是，在我的问题中，它们不是 8 位整数，而是 n 位整数。我如何存储它，以及如何查询？速度是关键。

            回答 #1

赞同：19

时间：2008-12-11T21:45:07.947

创建一个带有 int 列的表（使用[此链接](http://dev.mysql.com/doc/refman/5.0/en/integer-types.html)选择正确的 int 大小）。不要将数字存储为 0 和 1 的序列。

对于您的数据，它将如下所示：

```
number

154
53
148
38
59
106 
```

并且您需要找到匹配 24 的所有条目。

然后你可以运行一个查询

```
SELECT * FROM test WHERE number & 24 = 24 
```

如果您想避免在应用程序中转换为 10 个基数，您可以将其交给 mysql：

```
INSERT INTO test SET number = b'00110101'; 
```

像这样搜索

```
SELECT bin(number) FROM test WHERE number & b'00011000' = b'00011000' 
```

            回答 #2

赞同：8

时间：2008-12-14T05:37:13.487

考虑不为此使用 MySQL。

首先，可能没有超过 64 位表的内置方法。您必须求助于用 C 编写的用户定义函数。

其次，每个查询都需要进行全表扫描，因为 MySQL 不能为您的查询使用索引。所以，除非你的桌子很小，否则这不会很快。

            回答 #3

赞同：2

时间：2008-12-17T18:23:35.637

切换到 PostgreSQL 并使用 bit(n)

            回答 #4

赞同：2

时间：2015-02-13T11:39:04.083

布隆过滤器本质上需要表扫描来评估匹配。在 MySQL 中，没有布隆过滤器类型。简单的解决方案是将布隆过滤器的字节映射到 BitInteger（8 字节字）上并在查询中执行检查。因此，假设布隆过滤器 8 个字节或更少（一个非常小的过滤器），您可以执行如下准备好的语句：

`SELECT * FROM test WHERE cast(filter, UNSIGNED) & cast(?, UNSIGNED) = cast(?, UNSIGNED)`

并将参数替换为您要查找的值。但是，对于较大的过滤器，您必须创建多个`filter`列并将目标过滤器拆分为多个单词。您必须强制转换为 unsigned 才能正确进行检查。

由于许多合理的布隆过滤器的大小都在千字节到兆字节范围内，因此使用 blob 来存储它们是有意义的。一旦切换到 blob，就没有本地机制来执行字节级别的比较。并且通过网络拉动整个大 blob 表以在本地进行代码过滤并没有多大意义。

我找到的唯一合理的解决方案是 UDF。UDF 应该接受 a`char*`并对其进行迭代，将其强制转换`char*`为 an`unsigned char*`并执行`target & candidate = target`检查。这段代码看起来像：

```
my_bool bloommatch(UDF_INIT *initid, UDF_ARGS *args, char* result, unsigned long* length, char *is_null, char *error)
{
    if (args->lengths[0] > args->lengths[1])
    {
        return 0;
    }
    char* b1=args->args[0];
    char* b2=args->args[1];
    int limit = args->lengths[0];
    unsigned char a;
    unsigned char b;
    int i;
    for (i=0;i<limit;i++)
    {
        a = (unsigned char) b1[i];
        b = (unsigned char) b2[i];
        if ((a & b) != a)
        {
            return 0;
        }
    }
    return 1;
} 
```

此解决方案已实施并可[在此处获得](https://github.com/Claudenw/mysql_bloom)

            回答 #5

赞同：1

时间：2017-12-17T12:06:41.463

对于最多 64 位，您可以使用 MySQL 整数类型，如 tinyint (8b)、int (16b)、mediumint (24b) 和 bigint (64b)。使用无符号变体。

64b 以上，使用 MySQL (VAR)BINARY 类型。这些是原始字节缓冲区。例如 BINARY(16) 适用于 128 位。

为了防止表扫描，您需要每个有用位的索引，和/或每组相关位的索引。您可以为此创建虚拟列，并在每个列上放置一个索引。

            回答 #6

赞同：1

时间：2019-10-15T15:10:29.313

要使用数据库实现布隆过滤器，我会以不同的方式考虑它。

我会做一个两级过滤器。使用单个多位散列函数生成一个 id（这将更像是一个散列表桶索引），然后将行中的位用于更经典类型的剩余 k-1 散列函数。在该行内，它可能是（比如说）100`bigint`列（我也会比较性能与 BLOB）。

它实际上是 N 个单独的 Bloom 过滤器，其中 N 是您的第一个哈希函数的域。这个想法是通过选择散列桶来减小所需的布隆过滤器的大小。它不会具有内存中 Bloom 过滤器的全部效率，但与将所有值放入数据库并对其进行索引相比，它仍然可以大大减少需要存储的数据量。大概首先使用数据库的原因是完整的布隆过滤器内存不足。

        tdd - TDD - 什么时候可以编写不失败的测试？

ID：360849

赞同：8

时间：2008-12-11T20:55:16.643

标签：tdd, failing-tests

据我了解，在 TDD 中，您必须先编写一个失败的测试，然后编写代码使其通过，然后重构。但是，如果您的代码已经说明了您要测试的情况怎么办？

例如，假设我正在对排序算法进行 TDD（这只是假设）。我可能会为几种情况编写单元测试：

输入 = 1, 2, 3

输出 = 1, 2, 3

输入 = 4, 1, 3, 2

输出 = 1, 2, 3, 4

等等...

为了使测试通过，我最终使用了一个快速的“n 脏冒泡排序”。然后我重构并用更有效的合并排序算法替换它。后来，我意识到我们需要它是一个稳定的排序，所以我也为此编写了一个测试。当然，测试永远不会失败，因为归并排序是一种稳定的排序算法！无论如何，我仍然需要这个测试，以防有人再次重构它以使用不同的、可能不稳定的排序算法。 

这是否打破了始终编写失败测试的 TDD 口头禅？我怀疑有人会建议我浪费时间来实现一个不稳定的排序算法，只是为了测试测试用例，然后重新实现合并排序。你多久遇到一次类似的情况，你会怎么做？

            回答 #1

赞同：16

时间：2008-12-11T21:07:37.243

首先编写失败的测试然后让它们运行有两个原因；

首先是检查测试是否真的在测试你写它的目的。您首先检查它是否失败，更改代码以使测试运行，然后检查它是否运行。这看起来很愚蠢，但我有几次为已经运行的代码添加了一个测试，后来发现我在测试中犯了一个错误，使它始终运行。

第二个也是最重要的原因是防止您编写过多的测试。测试反映您的设计，您的设计反映您的需求和需求变化。发生这种情况时，您不想重写大量测试。一个好的经验法则是让每个测试只因为一个原因而失败，并且只有一个测试因为这个原因而失败。TDD 试图通过为每个测试、每个特性和代码库中的每个更改重复标准的红绿重构循环来强制执行此操作。

但当然，规则是用来打破的。如果您牢记为什么首先制定这些规则，您可以灵活地使用它们。例如，当您发现您有测试不止一件事的测试时，您可以将其拆分。实际上，您已经编写了两个以前从未失败过的新测试。打破然后修复你的代码以查看你的新测试失败是仔细检查事情的好方法。

            回答 #2

赞同：5

时间：2008-12-15T20:10:55.267

我怀疑有人会建议我浪费时间来实现一个不稳定的排序算法，只是为了测试测试用例，然后重新实现合并排序。你多久遇到一次类似的情况，你会怎么做？

让我成为那个推荐它的人。:)

所有这些都是在您花费的时间与您减少或减轻的风险以及您获得的理解之间进行权衡。

继续假设的例子......

如果“稳定性”是一个重要的属性/特性，并且您不会通过使其失败来“测试测试”，那么您可以节省做这项工作的时间，但会承担测试错误并且永远是绿色的风险。

另一方面，如果您通过破坏功能并观察其失败来“测试测试”，则可以降低测试的风险。  

而且，通配符是，您可能会获得一些重要的知识。例如，在尝试编写“坏”排序并导致测试失败时，您可能会更深入地考虑您正在排序的类型的比较约束，并发现您使用“x==y”作为equivalence-class-predicate 用于排序，但实际上 "!(x<y) && !(y<x)" 对您的系统来说是更好的谓词（例如，您可能会发现错误或设计缺陷）。

所以我说错误的是'花费额外的时间让它失败，即使这意味着故意破坏系统只是为了在屏幕上得到一个红点'，因为虽然这些小“转移”中的每一个都会招致一些时间成本，每隔一段时间就会为你节省*一大笔钱*（例如，哎呀，测试中的一个错误意味着我从未测试过我系统最重要的属性，或者哎呀，我们对不等式谓词的整个设计都是一团糟向上）。这就像玩彩票，只是从长远来看，赔率对你有利；每周你花 5 美元买票，通常你会输，但每三个月你会赢得 1000 美元的头奖。

            回答 #3

赞同：4

时间：2008-12-11T21:00:01.097

首先让测试失败的一大优势是，它可以确保你的测试真的是在测试你的想法。您的测试中可能存在细微的错误，导致它根本无法真正测试任何东西。

例如，我曾经在我们的 C++ 代码库中看到有人签入测试：

```
assertTrue(x = 1); 
```

显然，他们没有编程以使测试首先失败，因为这根本不测试任何东西。

            回答 #4

赞同：3

时间：2008-12-15T10:28:04.430

简单的 TDD 规则：您编写的测试*可能会*失败。

如果软件工程告诉我们什么，那就是你无法预测测试结果。甚至没有失败。事实上，对我来说，看到已经发生在现有软件中的“新功能请求”是很常见的。这很常见，因为许多新功能都是现有业务需求的直接扩展。底层的正交软件设计仍然有效。

即新功能“列表 X 必须最多容纳 10 个项目”而不是“最多 5 个项目”将需要一个新的测试用例。当 List X 的实际实现允许 2^32 个项目时，测试将通过，但在运行新测试之前您无法确定这一点。

            回答 #5

赞同：2

时间：2008-12-11T21:00:49.953

核心 TDDers 会说你总是需要一个失败的测试来验证一个肯定的测试不是一个误报，但我认为实际上很多开发人员都会跳过失败的测试。

            回答 #6

赞同：2

时间：2008-12-11T21:00:58.410

如果您正在编写一段新代码，则编写测试，然后编写代码，这意味着您第一次**总是**有一个失败的测试（因为它是针对一个虚拟接口执行的）。然后你可能会重构几次，在这种情况下你可能不需要编写额外的测试，因为你拥有的可能已经足够了。

但是，您可能希望使用 TDD 方法维护一些代码；在这种情况下，您首先必须将测试编写为特征测试（根据定义，它**永远不会**失败，因为它们是针对工作接口执行的），然后重构。

            回答 #7

赞同：2

时间：2008-12-11T21:26:05.160

除了“测试优先”开发之外，还有理由在 TDD 中编写测试。

假设您的排序方法除了直接排序操作之外还有一些其他属性，例如：它验证所有输入都是整数。您最初并不依赖它，它不在规范中，因此没有测试。

稍后，如果您决定利用此附加行为，则需要编写一个测试，以便其他任何出现并进行重构的人都不会破坏您现在依赖的此附加行为。

            回答 #8

赞同：1

时间：2008-12-11T21:00:23.980

呃...我将 TDD 周期读为

*   先写测试，这会失败，因为代码只是一个存根
*   编写代码以使测试通过
*   必要时重构

没有义务继续编写失败的测试，第一个失败是因为没有代码可以做任何事情。第一个测试的重点是决定接口！

编辑：似乎对“红绿重构”的口头禅有些误解。根据[维基百科的 TDD 文章](http://en.wikipedia.org/wiki/Test-driven_development)

在测试驱动开发中，每个新特性都从编写测试开始。这个测试必然会失败，因为它是在功能实现之前编写的。

换句话说，必须失败的测试是针对*新功能*，而不是针对额外的覆盖范围！

编辑：当然，除非您正在谈论编写回归测试来重现错误！

            回答 #9

赞同：1

时间：2008-12-11T21:36:33.360

但是，如果您的代码已经说明了您要测试的情况怎么办？

这是否打破了始终编写失败测试的 TDD 口头禅？

是的，因为你已经打破了在代码之前编写测试的口头禅。您可以删除代码并重新开始，或者只是接受从头开始的测试。

            回答 #10

赞同：1

时间：2009-01-11T18:29:00.503

您提供的示例是 IMO 编写通过第一次尝试的测试的适当时间之一。正确测试的目的是记录系统的***预期行为***。可以在不更改实现的情况下编写测试以进一步阐明预期的行为是什么。

附言

据我了解，这就是您希望测试在通过之前失败的原因：

你“写一个你知道会失败的测试，但在让它通过之前测试它”的原因是每隔一段时间，最初假设测试肯定会失败是错误的。在这些情况下，测试现在使您免于编写不必要的代码。

            回答 #11

赞同：1

时间：2009-01-26T05:59:36.853

正如其他人所说，TDD 的口号是“没有失败的单元测试就没有新代码”。我从未听过任何 TDD 从业者说“没有缺少代码就没有新测试”。新的测试总是受欢迎的，即使它们“碰巧”“意外”通过。无需更改代码即可中断，然后将其更改回以通过测试。

            回答 #12

赞同：0

时间：2009-01-26T04:48:41.193

我已经多次遇到这种情况。虽然我推荐并尝试使用 TDD，但有时它会过多地破坏流程以停止和编写测试。

我有一个两步解决方案：

1.  一旦你有你的工作代码和你的非失败测试，​​故意在代码中插入一个更改以导致测试失败。
2.  从您的原始代码中删除该更改并将其放在注释中 - 无论是在代码方法中还是在测试方法中，这样下次有人想确定测试仍然出现故障时，他们知道该怎么做。这也可以作为您确认测试失败的证据。如果它最干净，请将其留在代码方法中。您甚至可能想要使用条件编译来启用*测试断路器*。

        asp.net - 在 asp.net 中使用 Bind 表达式时如何连接文本

ID：360851

赞同：15

时间：2008-12-11T20:55:35.253

标签：asp.net, data-binding, syntax, binding

将文本连接到 asp.net 网页 (aspx) 的绑定表达式的语法是什么。

例如，如果我有一个像这样绑定的超链接：

```
<asp:HyperLink id="lnkID" NavigateUrl='<%# Bind("Link") %>' Target="_blank" 
                        Text="View" runat="server"/> 
```

例如，您如何更改 Text 以将绑定值与字符串连接起来？像这样的变化并不完全正确。

```
Text='<%# Bind("ID") + " View" %>' 
```

也没有

```
Text='<%# String.Concat(Bind("ID"), " View") %>' 
```

            回答 #1

赞同：35

时间：2008-12-11T21:09:31.980

请改用 Eval。

```
Text='<%# Eval("ID", "{0} View") %>' 
```

如果不打算更新值，则 Eval 也更好，其中 Bind 允许两种方式的数据绑定。

            回答 #2

赞同：8

时间：2008-12-12T22:10:11.553

如果使用模板字段，您还可以将“连接”放在标签的文本部分：

```
<asp:TemplateField HeaderText="Name" SortExpression="sortName">
<ItemTemplate>
   <asp:LinkButton ID="lbName" runat="server" OnClick="lbName_Click" CommandArgument='<%# Eval("ID") %>'>
         <%--Enter any text / eval bindind you want between the tags--%>
         <%# Eval("Name") %> (<%# Eval("ID") %>)
   </asp:LinkButton>
</ItemTemplate> 
```

这导致输出如下：

姓名（身份证）

模板列的内部。

            回答 #3

赞同：3

时间：2008-12-11T20:58:43.920

我以前用过`String.Format("{0}{1}"`……效果很好。

            回答 #4

赞同：1

时间：2019-11-13T09:39:53.890

您可以使用以下内容：

```
CommandArgument='<%#String.Format("{0}|{1}", Eval("ArgZero"), Eval("ArgOn"))%>' 
```

        cocoa - 如何强制 NSPopUpButtonCell 重新显示自身？

ID：360856

赞同：0

时间：2008-12-11T20:57:15.577

标签：cocoa, user-interface, nspopupbuttoncell

我正在创建 NSPopUpButton 和 NSPopUpButtonCell 的自定义子类，以在按钮顶部显示一个单独的图标，而不是通常的文本。

为此，我将覆盖

```
- (void)drawInteriorWithFrame:(NSRect)cellFrame inView:(NSView *)controlView 
```

在我的按钮单元子类中以适当的大小和位置绘制我的图标。当用户将鼠标悬停在按钮上时，我想更改图像。我唯一的问题是我无法弄清楚如何重新显示按钮单元格（通过再次调用 drawInterior...）。默认情况下，它似乎只在单击按钮或焦点移动到另一个窗口时重新显示。我试过 setNeedsDisplay:YES 但这似乎没有。

            回答 #1

赞同：2

时间：2008-12-11T22:31:28.663

我发现这样做的方法是插入一个调用

```
[self updateCell:self.cell]; 
```

在我更改单元格显示的图像之后，立即在我的 NSPopUpButton 子类中。

        architecture - 什么是领域逻辑？

ID：360860

赞同：53

时间：2008-12-11T20:57:54.093

标签：architecture, terminology, business-logic

什么是领域逻辑？域逻辑的维基百科页面重定向到业务逻辑。它们是同一件事吗？如果不是，它们有何不同？

            回答 #1

赞同：42

时间：2008-12-11T21:04:04.487

域就是您要建模的内容。

如果您正在为业务问题建模，它们是相同的。

如果您正在建模其他东西，例如物理，您的系统中可能没有业务逻辑，但物理部分仍然是域逻辑。

            回答 #2

赞同：42

时间：2008-12-12T13:40:11.957

域是您的应用程序所在的世界。因此，如果您正在开发一个航班预订系统，那么应用程序域将是航班预订。

另一方面，业务逻辑是整个应用程序域的一个更离散的块。业务逻辑通常是为执行特定业务流程而构建的一段代码。因此，您将有业务逻辑来进行预订。另一个业务逻辑是退还已取消门票的代码。

支持您的业务流程的对象将成为您的业务对象！

            回答 #3

赞同：21

时间：2010-10-27T20:27:52.103

业务逻辑是目的论的（关注如何实现目标），而领域逻辑是本体论的（存在什么，或用于推理的对象模型）

            回答 #4

赞同：4

时间：2008-12-12T14:07:38.437

领域逻辑适用于问题领域，例如“订单处理”。领域逻辑是关于您使用的实体（对象模型）及其关系。

业务逻辑包含特定于您的上下文的规则，例如“当超过金额 Z 时，将使用折扣 Y 处理来自 X 组客户的订单”。业务“逻辑”是关于编码有关您的业务（或使用该程序的客户的业务）的事实。

            回答 #5

赞同：4

时间：2016-07-11T09:38:21.357

让我们介绍一个场景。  

你有一个 XYZ 约束的客户，他希望你让他的系统在线。

用户可以在线下订单，跟踪订单，付款等。    

从客户的角度来看，这个系统将被称为**商业理念**
，而“在线下订单”据说是**业务流程**之一，如果用户在线下订单，客户想要用户的每个细节，想要在屏幕上显示等等说是**业务逻辑**。  

现在，您将把他的商业理念建模到您的观点中，这样您的系统可以完成他的所有业务流程或他的完整商业理念，称为**问题域**或**应用程序域**或**您的应用**程序域。  

现在您将首先识别所有业务流程。并识别实体或对象以完成业务流程。那些对象被**称为 Business Obect**或**Domain Object**以及实现业务流程的方法或逻辑，例如 placeOrder 被称为**Domain Logic**。  

所以**业务逻辑**是客户想要的，因为它在客户业务领域和**领域逻辑**是你实现它的方式。因为它在您的应用程序域中。

            回答 #6

赞同：3

时间：2008-12-11T21:02:42.400

特定于特定专业领域/领域的业务逻辑。

            回答 #7

赞同：1

时间：2009-04-29T17:38:02.893

我会说业务逻辑与：

域中实体之间的任何逻辑或关联。

那么学生如何与班级或学生相关联。如何创建新班级以及如何为该班级注册学生

与业务规则、确定结果、服​​务、事件、流程、计算、转换和相关数据操作/创建有关的任何事情。

我发现很难找到好书/老师来帮助构建领域逻辑。构建域很容易。但在我看来，域逻辑似乎是一个没人想去的地方。

            回答 #8

赞同：0

时间：2008-12-12T13:45:46.813

我的领域是制药。它涉及隔间、剂量、微分方程和统计数据。如果您想称其为我的“业务”，那么我猜它是“业务逻辑”。

            回答 #9

赞同：0

时间：2010-11-06T01:37:57.497

*   业务逻辑关注协调视图和模型（用户界面和数据）之间的有效交互。
*   域逻辑是关于在应用程序的两侧（客户端和服务器）保持内部一致的模型表示。

        java - GridLayout 的参数是什么？

ID：360877

赞同：6

时间：2008-12-11T21:00:18.677

标签：java, layout, grid-layout

```
private static final GridLayout layout = new GridLayout( 3, 1, 1, 0 ); 
```

在这行代码中，数字代表什么以及如何使用它们来排列窗口中的复选框和按钮？

            回答 #1

赞同：9

时间：2008-12-12T00:57:36.170

网格[布局](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/GridLayout.html)类：

```
public GridLayout(int rows,
                  int cols,
                  int hgap,
                  int vgap)

Creates a grid layout with the specified number of rows and columns. All components in the layout are given equal size.
In addition, the horizontal and vertical gaps are set to the specified values. Horizontal gaps are placed between each of the columns. Vertical gaps are placed between each of the rows.

One, but not both, of rows and cols can be zero, which means that any number of objects can be placed in a row or in a column.

All GridLayout constructors defer to this one.

Parameters:
rows - the rows, with the value zero meaning any number of rows
cols - the columns, with the value zero meaning any number of columns
hgap - the horizontal gap
vgap - the vertical gap 
```

            回答 #2

赞同：6

时间：2008-12-11T21:20:56.997

我推荐你：http: [//java.sun.com/javase/6/docs/api/java/awt/GridLayout.html](http://java.sun.com/javase/6/docs/api/java/awt/GridLayout.html)

        php - 将数据从一个页面发送到另一台服务器。语言不可知论者

ID：360880

赞同：0

时间：2008-12-11T21:00:48.003

标签：php, javascript, web-services, webserver

我会尽量保持简短。我还没有开始为这个项目编写代码，但我现在正在努力解决预编码后勤问题。

我要做的是创建一种将数据从一个/任何站点发送到另一个远程服务器的方法，这将为请求发送数据的用户生成响应。

具体来说，网页设计师应该能够获取我在我的网站上可用的代码片段，将其实现到他们自己的页面中，并且当用户浏览他们的页面时，我的服务将可用。

一个具体的例子，一个有网站（`helloworld.com`）的网页设计师可以将我的代码实现到他们的页面（`helloworld.com/index.html`）中。当用户查看页面时`/index.html`(选项将是“Define 'lemonade' at Dictionary.com”），如果选择该选项，将在此处处理，并且将从我的远程服务器返回响应（`myremoteserver.com`）

显然，我希望设计师将使用的代码尽可能轻量和独立。关于如何执行此操作的任何想法？我应该研究的资源，以及我可以实施的方法？

            回答 #1

赞同：3

时间：2008-12-11T21:37:05.933

如果我不小心将鼠标悬停在该单词上，请不要再创建一个令人讨厌的双下划线网站内容中的单词然后在内容上弹出丑陋、加载缓慢的广告的服务。因为这听起来像你在做什么。

如果你无论如何都要这样做，那么“远程服务器”实际上可能是一些客户端 JavaScript，在这种情况下[JSON](http://json.org/)可能是你最好的选择。XML 也可以工作，但即使 JavaScript 不在另一边，我更喜欢 JSON 作为一种[序列化](http://en.wikipedia.org/wiki/Serialization)技术，因为它的紧凑性和可读性。

            回答 #2

赞同：0

时间：2008-12-11T21:34:17.407

我认为您在谈论超链接。

让您感到困惑的部分是您希望在客户端站点上的交互级别。无论您想在链接周围使用哪种简洁的 UI 界面，都可能会在 javascript 中完成，并且需要提供给该站点。你所要求的核心

文本...如果被选中，将被处理，并且将从我的远程服务器（myremoteserver.com）返回响应

只是一个超链接。

不过，可能还有更多。解释一下，我们会尽力提供帮助。

            回答 #3

赞同：0

时间：2008-12-11T22:45:27.920

我将详细说明并进一步解释说，我并不是在制作那些将资源丰富的信息变成笨重广告牌的“烦人”网络服务之一。我打算制作一个低图形（每个菜单选项最多 16x16 图标）资源链接工具，可用于将本地服务器上的资源连接到其他资源，无论是本地还是远程。

可以通过向我的网络服务器发送请求并在弹出框中返回响应来访问此数据（此响应当然基于查询） 响应将显示在一个简短的选项菜单中，例如 Wikipedia 条目、链接在流行的引擎等上进行洪流搜索。

它不会抑制选择、滚动、单击预定义的超链接或任何内容，因为您需要将文本悬停几秒钟。

我只是在寻找有助于设计此类服务的资源。

        svn - 使用版本控制进行家庭开发？

ID：360887

赞同：138

时间：2008-12-11T21:01:54.773

标签：svn

到目前为止，我一直在家里开发我的个人和学校项目，而没有使用任何形式的修订控制软件来处理我的更改等等。

我的问题是，**将版本控制应用程序**（例如[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)）**用于我为自己做的个人项目**（甚至学校项目）的可行性如何？

是否值得为“家庭项目”而不是仅仅进行手动备份而进行检查、提交更改和所有这些日常工作的麻烦？

**链接**：

*   [乌龟SVN](http://tortoisesvn.tigris.org/)
*   [SvnServe 服务器](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup-svnserve.html)

            回答 #1

赞同：192

时间：2008-12-11T21:02:57.547

完全地。

也[归功于 http://blogs.embarcadero.com/nickhodges/2010/04/23/39416](http://blogs.embarcadero.com/nickhodges/2010/04/23/39416)：

*   **有时我们会犯愚蠢的错误。**拥有源代码控制安全网是必须的。
*   **标记重要的里程碑。**即使在家庭开发中，您也可能希望将一组文件和修订标记为特定的软件版本。
*   **你为你的职业生涯而训练。**将与使用源代码控制相关的工作方法放在您的脑海中，可以让您做好专业的准备。
*   **存储效率。**当前的源代码控制系统将修订存储为与先前修订的差异差异。这意味着它的磁盘效率更高，因为不存储整个文件而只存储差异。
*   **您拥有所有源代码树的历史记录。**您可以快速查看更改的内容以及更改的时间。比较不同版本的文件并轻松合并。
*   **您可以分支进行实验。**如果您有一些实验，您可以创建一个分支（一个新的独立开发线）并对其进行测试。最后，如果您对结果满意，将其合并到 HEAD（主开发线）中。您无需创建副本即可免费获得所有这些，并且即使在试验期间也可以从使用源代码控制中获得相同的好处。

            回答 #2

赞同：31

时间：2008-12-11T21:24:42.403

这是完全值得的。

请注意，您也不必设置成熟的 SVN 服务器。您可以在本地文件系统中创建一个存储库，并使用 file:// URL 语法进行连接。这意味着您不必经历设置 SVN 守护程序的麻烦（这对于单用户项目来说可能是多余的）

您还可以查看重量更轻的选项，例如 git，它将所有工作文件保存在本地，甚至无需创建单独的存储库。Git 还为您提供了更多选项来设置源代码控制。

            回答 #3

赞同：8

时间：2008-12-11T21:30:11.830

使用源代码控制也有利于备份。如果您总是检查所有内容，那么您可以通过备份所有存储库来备份所有源代码项目。如果您有多台机器，那么您不必担心最新版本的代码实际在哪里——它在存储库服务器上。

            回答 #4

赞同：6

时间：2008-12-11T21:22:29.600

我把我的整个硕士论文都放在源代码控制之下——代码和论文本身——所以我强烈主张这样做，而不仅仅是代码。

对于单个项目，主要优势是可以自由更改和进行实验，知道如果它不起作用，您总是可以恢复到以前的版本。它为你的工作提供了隐式备份（只要确保你的 svn repo 至少在与你的主要工作不同的硬盘上）

            回答 #5

赞同：5

时间：2008-12-11T21:33:37.550

绝对，这是值得的。它使您能够尝试疯狂和疯狂的重构，然后在它们不起作用时轻松地退出它们。它还为您是否/何时与团队进行更多协作建立了良好的习惯。

使用 Subversion（至少）你甚至不需要有一个“服务器”——一个简单的目录可以作为你的存储库，如果你使用“file://”类型的 url 访问它。甚至还有一本免费的书，其中包含了您入门所需的几乎所有内容：

[http://svnbook.red-bean.com/nightly/en/index.html](http://svnbook.red-bean.com/nightly/en/index.html)

            回答 #6

赞同：4

时间：2008-12-11T21:12:00.790

我发现设置 SVN 服务器非常有帮助，因为我发现自己正在回顾修订和其他“丢弃”项目，因为我记得一些我现在可以使用的功能或做某事的方式。有了 SVN 服务器，我知道代码存储在家里，我可以稍后将其拉出来。

            回答 #7

赞同：4

时间：2008-12-15T20:53:49.063

修订控制很棒，因为它可以让你进行更多的实验，知道如果你的实验失败了，你有一些东西可以回退。

        windows - 是否有用于捕获和播放修改后的 UDP 数据包的 Windows 工具？

ID：360889

赞同：12

时间：2008-12-11T21:02:13.120

标签：windows, udp, packet, packet-capture

我正在寻找一种适用于 Windows 的工具（或一组工具），它将执行以下操作：

1.  将来自特定网络接口的 UDP 数据包捕获到文件中。
2.  通过网络接口播放来自文件的数据包流。
3.  除 2：将原始数据包重播到与原始主机不同的主机。

我已经有了 1 和 2，但是我找不到执行 3 的工具。

对于捕获，我可以使用[Wireshark](http://www.wireshark.org)来播放[Colaso​​ft Packet Player](http://www.colasoft.com/packet_player/index.php?click=text)，但我找不到更改数据包发送到的主机的方法。

该工具应该可以在 Windows XP SP2/3 上运行。

            回答 #1

赞同：4

时间：2008-12-15T09:58:35.767

你提到了 Colaso​​ft Packet Player，它听起来像是一个有用的工具，所以我检查了它。在查看他们的网站时，我发现他们也有[Packet Builder](http://www.colasoft.com/packet_builder/)。

看来这个工具可以导入 pcap 文件（和一些其他格式）并编辑它们。然后它可以再次导出编辑的数据包，但只能导出到 Colaso​​ft Capsa Packet 文件（Colaso​​ft 自己的捕获文件格式）。但这应该不是问题，因为 Packet Player 能够读取自己的格式。

不幸的是，似乎无法同时编辑多个数据包，因此编辑大量数据包是一个乏味的过程。

            回答 #2

赞同：4

时间：2012-10-24T17:52:38.130

BitTwist ( [http://bittwist.sourceforge.net ) 编辑](http://bittwist.sourceforge.net)**器**命令行程序 ( ) 允许您更改目标 IP 地址（和端口号）等。`bittwiste`

在超级用户站点上查看类似的问题（和有效的答案）：[Replay UDP Packet Capture](https://superuser.com/questions/382264/replay-udp-packet-capture)

            回答 #3

赞同：2

时间：2008-12-17T08:16:02.743

试试[WinPCap](http://www.winpcap.org/misc/features.htm)，它允许非常低级的拦截和注入数据包。它是一个开源项目，许多其他状态数据包检测程序（例如[Ethereal](http://www.ethereal.com/)）都基于它。

            回答 #4

赞同：2

时间：2013-06-03T17:43:43.483

我使用十六进制编辑器对 PCAP 文件进行全局搜索和替换，以更改目标 MAC 和 IP。对于单播，您需要同时更改两者 - 而不仅仅是 IP。

您可以更改的不仅仅是地址，但对于 quick-n-dirty 来说没关系。

            回答 #5

赞同：1

时间：2008-12-13T10:40:55.327

我发现[tcprewrite](http://tcpreplay.synfin.net/trac/wiki/tcprewrite)工具为 .pcap 文件提供了编辑功能。不幸的是，它不支持 Windows。

            回答 #6

赞同：1

时间：2008-12-17T08:38:10.530

Bork Blatt 提到了 Ethereal，由于各种原因已经更名为[Wireshark](http://www.wireshark.org/)，所以直接去新站点。我从未尝试在 Wireshark 中编辑数据包，但您确实可以选择保存数据包，以便您可以离线使用文件来更改数据包。开始吧，请查看[libpcap 文件格式](http://wiki.wireshark.org/Development/LibpcapFileFormat)文档。

            回答 #7

赞同：0

时间：2017-04-25T13:08:02.307

对于目视检查，您可以使用线鲨工具，但您需要高级工具，然后使用 wpdpack 库。它可以在这个网站上找到。

[https://www.winpcap.org/devel.htm](https://www.winpcap.org/devel.htm)

与线鲨类似，您可以使用 TestPacketCapture 视觉工作室解决方案进行捕获。

        3d - 在 3D 场景中处理 2D z-indexing 的正确方法 (DirectX)

ID：360890

赞同：0

时间：2008-12-11T21:02:21.217

标签：3d, directx, 2d, orthogonal

我需要实现以下目标：

两个 2D 四边形看起来好像一个在另一个之上（就像同一纹理的两半），但实际上在 z 轴上被 n 个坐标分开。因此，如果 3D 对象在它们之间经过，则一半出现在对象前面，另一半出现在对象后面。

我可以通过对两个四边形应用正交投影然后对其余 3d 数据应用正常透视来实现这一点吗？这会丢失深度数据吗？

我希望我的例子不会太误导！

            回答 #1

赞同：1

时间：2009-01-22T00:15:50.460

简单的答案是肯定的，如果您在渲染四边形时打开了 z write。除非您明确执行，否则您的 z 数据永远不会被丢弃。

然而，让正交深度与投影深度很好地配合可能会很棘手。（我从未尝试过，但我想它不会很好地排列。）在这种情况下，最好执行以下操作之一：

*   在透视图中渲染所有几何图形
*   在正交视图中渲染所有几何体
*   在非 z 测试的排序层中渲染正交几何（从后到前），在两者之间渲染透视几何。

我假设您已经知道前两种方法的缺点，所以这取决于您是否可以接受。我认为第三种方法是最传统的。

        java - 复选框显示？

ID：360898

赞同：2

时间：2008-12-11T21:03:29.030

标签：java, swing, checkbox

```
JCheckBox special = new JCheckBox ("\nSpecial - $17.95" + "\nMeatball, Sausage, Mushroom, Onion, Pepperoni & Pepper"); 
```

在这行代码中，如何使复选框使“...”变成两行？

            回答 #1

赞同：6

时间：2008-12-11T21:31:13.263

最简单的方法是使用[HTML 3.2](http://www.w3.org/TR/REC-html32)对其进行格式化：

```
 JCheckBox checkBox = new JCheckBox("<HTML>" + "Special - $17.95"
            + "<BR>"
            + "Meatball, Sausage, Mushroom, Onion, Pepperoni & Pepper"
            + "</HTML>"); 
```

另一种方法是设置自定义[ButtonUI](http://java.sun.com/javase/6/docs/api/javax/swing/plaf/ButtonUI.html)，尽管这是一种相当复杂的方法。

        c# - C# 数学问题

ID：360899

赞同：1

时间：2008-12-11T21:03:45.173

标签：c#, math

我一天中的大部分时间都在处理这个问题，但我似乎无法让这部分代码工作。代码的目的是允许用户输入一组值以计算缺失值。作为一个附加功能，我在表单上放置了一个复选框，以允许用户进行进一步的计算。这就是我的问题所在。我知道代码有效，因为如果我更改公式，tb3_aic.Text 中出现的值会根据公式而变化。但是，当我使用下面的答案时，答案并没有改变。请参考随附的代码。如果需要公式的 jpg 图像，我可以通过电子邮件发送。

```
 void Calc3Click(object sender, EventArgs e)

    {
       if (String.IsNullOrEmpty(tb3_skv.Text) | String.IsNullOrEmpty(tb3_kva.Text) | String.IsNullOrEmpty(tb3_z.Text))
    {
        MessageBox.Show("Enter all required values", "Missing Data", MessageBoxButtons.OK);
    }   //If user does not enter all the values required for the calculation show error message box
    else

    {
        if (!String.IsNullOrEmpty(tb3_skv.Text) & !String.IsNullOrEmpty(tb3_kva.Text) & !String.IsNullOrEmpty(tb3_z.Text))

        { //If motor load check box is not checked and required values are entered calculate AIC based on formula.
            int y; 
            decimal x, z, a;
            x = decimal.Parse(tb3_skv.Text);      
            y = int.Parse(tb3_kva.Text);
            a = decimal.Parse(tb3_z.Text);
            z = (y * 1000) / (x * 1.732050808m) / (a / 100); //the m at the end of the decimal allows for the multiplication of decimals
            tb3_aic.Text = z.ToString();
            tb3_aic.Text = Math.Round(z,0).ToString();
        }

        if (cb3_ml.Checked==true) 
        {//If Motor Load CB is checked calculate the following
            int y, b;
            decimal x, z, a;
            x = decimal.Parse(tb3_skv.Text);
            y = int.Parse(tb3_kva.Text);
            a = decimal.Parse(tb3_z.Text);
            b = int.Parse(tb3_ml.Text);
            z = ((y * 1000) / (x * 1.732050808m) / (a / 100))+((b / 100)*(6*y)/(x*1.732050808m)*1000);
            tb3_aic.Text = z.ToString();
            tb3_aic.Text = Math.Round(z,5).ToString();
        }

     } 
```

我很感激可以提供的任何帮助。

谢谢你，格雷格·拉特利奇

            回答 #1

赞同：5

时间：2008-12-11T21:13:56.247

在不真正知道问题所在的情况下，有些事情看起来有点奇怪：

*   此外，除非您真的知道自己在做什么，否则在计算中混合使用 decimal 和 int 可能会导致意外结果。我建议只使用小数（或双精度，速度更快，通常具有足够的工程计算精度）。
*   您还设置了 tb3_aic.Text 两次，我假设您决定稍后舍入并忘记删除第一个。

**编辑：这在 C# 中显然是错误的：**

*   您在 if 子句中使用按位与 (&)，您可能表示逻辑与 (&&)。

与布尔操作数一起使用时，它们之间的唯一区别是 && 短路（如果左侧为假，则不评估右侧操作数）。学到东西了，谢谢评论的人。:)

            回答 #2

赞同：3

时间：2008-12-11T21:11:34.753

改变这个：

```
int y, b; 
```

对此：

```
int y;
decimal b; 
```

根据这个测试，它可以工作：

```
 public void Test2()
    {
        int y;
        decimal b;
        decimal x, z, a;
        decimal z1, z2;
        x = 480m;
        y = 2500;
        a = 5.75m;
        b = 10;
        z1 = ((y * 1000) / (x * 1.732050808m) / (a / 100));
        z2 = ((b / 100) * (6 * y) / (x * 1.732050808m) * 1000);
        z = z1 + z2;
        Console.WriteLine("{0}, {1}", z1, z2);
        Console.WriteLine(Math.Round(z, 0).ToString());
    } 
```

原因是整数 10 除以整数 100 是整数 0，零是整个 z2。

            回答 #3

赞同：0

时间：2008-12-11T21:12:12.677

我不知道这是否很大，但是当您尝试连接时，您将 tb3_aic 文本框的文本设置了两次？

```
tb3_aic.Text = z.ToString();
tb3_aic.Text = Math.Round(z,0).ToString(); 
```

您似乎在这两种方法中都这样做。  

我看的越多，这可能是一个问题，因为您在第一个 if 中设置它，然后如果选中该复选框，第二个 If 将覆盖它。

            回答 #4

赞同：0

时间：2008-12-11T21:15:51.577

样本输入，第一个公式 x = 480 y = 2500 a = 5.75

对于第一个公式，输出应为 52296

样本输入，第二个公式 x = 480 y = 2500 a = 5.75 b = 10

对于第一个公式，输出应为 54100.42

希望这可以帮助

            回答 #5

赞同：0

时间：2008-12-11T21:18:26.613

不需要这条线，虽然它不是错误，但它总是评估为 true    

```
if (!String.IsNullOrEmpty(tb3_skv.Text) & !String.IsNullOrEmpty(tb3_kva.Text) & !String.IsNullOrEmpty(tb3_z.Text)) { 
```

        data-warehouse - Datamart vs.reporting Cube，有什么区别？

ID：360900

赞同：18

时间：2008-12-11T21:03:46.453

标签：data-warehouse, cubes, datamart

这些术语到处都在使用，我不知道清晰的定义。我很确定我知道什么是数据集市。我还使用 Business Objects 和 Cognos 等工具创建了报告多维数据集。

也有人告诉我，数据集市不仅仅是多维数据集的集合。

我也有人告诉我，数据集市是一个报告立方体，仅此而已。

你理解的区别是什么？

            回答 #1

赞同：29

时间：2008-12-11T22:28:13.523

[Cube](http://en.wikipedia.org/wiki/Olap_cube)可以（并且可以说应该）意味着一些非常具体的东西 - 通过[OLAP 服务器](http://en.wikipedia.org/wiki/MOLAP)呈现的 OLAP 工件，例如[MS Analysis Services](https://docs.microsoft.com/en-us/sql/analysis-services/analysis-services?view=sql-server-2017)或 Oracle（nee Hyperion）[Essbase](https://www.oracle.com/technetwork/middleware/essbase/overview/index.html)。但是，它的使用也更加松散。这种类型的 OLAP 多维数据集使用可感知多维数据集的查询工具，这些工具使用与标准关系数据库不同的 API。通常 OLAP 服务器维护自己的优化数据结构（称为[MOLAP](http://en.wikipedia.org/wiki/MOLAP)），尽管它们可以实现为关系数据源的前端（称为[ROLAP](http://en.wikipedia.org/wiki/ROLAP)）或以各种混合模式（称为[HOLAP](http://en.wikipedia.org/wiki/HOLAP)）

我试着具体一点，并专门使用“立方体”来指代 OLAP 服务器（如 SSAS）上的立方体。  

[Business Objects](https://www.sap.com/products/bi-platform.html)通过一个或多个源（可以是关系数据库、OLAP 多维数据集或平面文件）查询数据并创建称为[MicroCube](http://business-objects-xi.blogspot.com/2013/10/what-is-micro-cube-in-sap-business.html)的内存数据结构来支持交互式切片和切块活动。Analysis Services 和 MSQuery 可以制作一个[立方体 (.cub) 文件](https://support.office.com/en-us/article/work-with-offline-cube-files-a1014690-efb7-480d-b717-308a39063235)，该文件可由 AS 客户端软件或 Excel 打开并以类似方式切片和切块。IIRC 最近版本的 Business Objects 也可以打开 .cub 文件。  

为了迂腐，我认为 Business Objects 位于真正的 OLAP 系统（如 ProClarity）和临时报告工具（如[Report Builder](http://msdn.microsoft.com/en-us/library/ms155933.aspx)、[Oracle Discoverer](https://en.wikipedia.org/wiki/Oracle_Discoverer)或[Brio](https://en.wikipedia.org/wiki/Brio_Technology) ）之间的“半结构化报告”空间中。往返查询面板使它作为一个纯粹的思想流 OLAP 工具有点笨拙，但它确实提供了传统报告所不具备的交互性水平。我认为 Business Objects 的最佳点在于两个地方：由不一定熟悉 SQL 的员工提供临时报告，以及提供以交互式格式交付的计划报告，允许深入研究数据。

[“数据集市”](http://en.wikipedia.org/wiki/Datamart)也是一个相当宽松的术语，可以指数据仓库系统的任何面向用户的数据访问介质。该定义可能包括也可能不包括报告工具和元数据层、报告层表或其他项目，例如多维数据集或其他分析系统。

我倾向于将数据集市视为完成报告的数据库，特别是如果它是整个数据仓库架构的一个易于定义的子系统。然而，将其视为面向用户的报告层是非常合理的，特别是如果有允许最终用户直接获取数据的业务对象或 OLAP 系统等临时报告工具。

            回答 #2

赞同：10

时间：2009-01-07T03:52:02.950

术语“数据集市”变得有些含糊不清，但它传统上与组织信息系统的面向主题的子集相关联。数据集市并未明确暗示存在诸如 OLAP 之类的多维技术，并且数据集市并未明确暗示存在汇总数值数据。

另一方面，多维数据集往往意味着数据是使用多维命名法（通常是 OLAP 技术）呈现的，并且数据通常被概括为多个层次结构的交集。（即您家庭的净资产与您的个人净资产以及介于两者之间的一切） 通常，“立方体”意味着非常具体的东西，而“数据集市”往往更笼统一些。  

我想在 OOP 中你可以准确地说数据集市“有一个”立方体、“有一个”关系数据库、“有一个”漂亮的报告界面等等……但说任何一个都不太正确那些单独的“is-a”数据集市。术语数据集市更具包容性。

            回答 #3

赞同：4

时间：2011-09-30T07:37:22.007

数据集市是特定业务流程的数据集合。数据的存储方式无关紧要。与具有行和列的表不同，多维数据集以一种特殊的方式、多维存储数据。olap 数据库中的多维数据集类似于传统数据库的表。数据集市可以有表或多维数据集。多维数据集使分析更快，因为它提前预先计算聚合。

            回答 #4

赞同：4

时间：2012-11-20T22:26:04.397

顾名思义，多维数据集是结构化的多维数据集（通常三个维度，每个维度代表多维数据集的三个边）。数据集市只是一个容器，而不是其本身的结构，尽管它包含按维度和事实平面组织（如表）的数据集。

多维数据集的结构使得沿着多维数据集的各个维度可视化或概念化数据变得容易。因此，大多数业务分析师或开发人员发现查询多维数据集并与之交互很容易。

由于数据集市只是一个包含一堆表的容器；在查询和分析数据之前，用户需要首先概念化和理解维度结构。

            回答 #5

赞同：3

时间：2009-01-07T04:27:33.300

数据集市传统上是指静态数据，通常面向日期/时间，由分析师用于统计、预算、绩效和销售报告以及其他计划活动。

Cube 是一个 OLAP 数据库，它非常详尽地将 OLTP 数据转换为静态的、面向日期/时间的模式，该模式使用的查询语言不是 SQL，而是专门为回答数据集市类型的问题而构建的。它使用度量、维度、星型模式等术语，而不是表、列和行。最熟悉的类比可能是电子表格中的数据透视表。

            回答 #6

赞同：3

时间：2014-01-03T00:43:33.900

记住：

**数据仓库**是从遗留和事务数据库系统中获取数据并将其转换为用户友好格式的有组织信息的过程，以鼓励数据分析并支持基于事实的业务决策。

**数据仓库**是一个系统，它提取、清理、整合源数据并将其交付到维度数据存储中，然后支持和实现查询和分析以用于决策。

例如，KIMBALL 一直将数据集市定义为基于原子数据基础的整个组织数据的面向过程的子集，它仅取决于数据测量事件的物理特性，而不取决于预期的用户问题。

*   数据集市基于数据源，而不是部门对数据的看法。
*   数据集市包含支持向下钻取到最低级别所需的所有原子细节。
*   数据集市可以集中控制或分散。

**正确的定义**

*   基于过程
*   原子数据基金会
*   数据测量

**错误的定义**

*   基于部门
*   仅聚合数据
*   基于用户问题

            回答 #7

赞同：1

时间：2008-12-11T21:07:43.123

对我来说，数据集市只是数据以相对扁平、不可用的格式转储的地方。

Cube 正在获取这些数据并让它跳舞。

            回答 #8

赞同：1

时间：2012-05-03T12:26:35.220

我同意马修的观点。我们倾向于将术语“数据集市”用于存储通用数据和跨企业中各种应用程序使用的映射的任何数据源。我们不在数据集市中存储可测量的数据，因此我将数据集市视为多维数据集的多个数据源之一。然而，这就是*我们*的做法。我确信没有什么可以阻止您将可测量的数据存储在数据集市中。

        python - 使用 SSPI 通过 Apache 服务访问 CVS

ID：360911

赞同：0

时间：2008-12-11T21:05:20.023

标签：python, apache, cvs, sspi

我正在使用 mod_python、Python 2.5 和 Django 运行 Apache 服务器 (v2.2.10)。我有一个小型 Web 应用程序，它将显示我们在 CVS 中拥有的当前项目，并允许用户构建不同项目（构建检查项目，并复制某些文件并去除源代码）。

在 Django 开发服务器上，一切正常。我可以看到 cvs 中的项目列表、签出等。在生产服务器（Apache 的服务器）上，我收到以下错误：

[8009030d] 无法识别提供给包的凭据

我正在尝试使用 SSPI 登录到 CVS 服务器。在 shell 中输入相同的命令将正确执行。

这是我正在使用的代码：

```
 def __execute(self, command = ''):
        command = 'cvs.exe -d :sspi:user:password@cvs-serv.example.com:/Projects ls' 
        p = subprocess.Popen(command, stdout=subprocess.PIPE, stderr = subprocess.STDOUT, shell=True)
        return p.communicate() 

```

我已经尝试了许多不同的变化，但我似乎无法让它发挥作用。现在我相信 Apache 是罪魁祸首。

任何帮助，将不胜感激

            回答 #1

赞同：0

时间：2008-12-11T22:28:00.200

SSPI 的使用让我觉得你使用的是 CVSNT，因此是 Windows 系统；您正在运行 Apache 的用户是什么？服务的默认用户是 SYSTEM，它与您的当前用户不共享相同的注册表。

        visual-studio - 如何使用 Visual Studio 调试进程？

ID：360912

赞同：5

时间：2008-12-11T21:05:24.627

标签：visual-studio, debugging

如果应用程序†崩溃，

[![在此处输入图像描述](https://i.stack.imgur.com/o8DiZ.png)](https://i.stack.imgur.com/o8DiZ.png)

我点击“调试”，Visual Studio 是我当前注册的即时 (JIT) 调试器：

[![在此处输入图像描述](https://i.stack.imgur.com/SKRAS.png)](https://i.stack.imgur.com/SKRAS.png)

出现 Visual Studio，但无法调试任何内容：

[![在此处输入图像描述](https://i.stack.imgur.com/Yc8tK.png)](https://i.stack.imgur.com/Yc8tK.png)

*   我没有看到任何拆卸
*   我没有看到任何寄存器（假设它在带有寄存器的 CPU 上运行）
*   调用栈为空（假设CPU有栈指针）
*   我没有看到任何符号（假设它有任何符号）
*   我没有从反射中看到重构的源代码（假设它是托管的）

其他 JIT 调试器产品能够显示反汇编，但它们要么基于命令行（[Windows 调试工具](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)），要么不支持符号（[OllyDbg](http://www.ollydbg.de/)、[Delphi](http://en.wikipedia.org/wiki/Borland_Delphi)）。此外，我的问题是关于使用 Visual Studio 进行调试，因为我已经安装了它，而且它已经是我注册的 JIT。

如何使用 Visual Studio 调试程序？

**或者**：是否有人编写了支持 Microsoft 符号服务器的图形调试器？

† 不一定是用 Visual Studio 编写的。

**编辑：**将标题更改为**process**而不是**application**，因为后者以某种方式暗示“*我的*应用程序”。

**编辑：**假设原始应用程序是由 Steve Gibson 用汇编语言编写的。也就是说，没有源代码或调试信息。Visual Studio 应该仍然能够向我显示程序集转储。

            回答 #1

赞同：3

时间：2010-03-18T13:04:41.027

查看屏幕截图，似乎 Visual Studio 当前正在运行模式下进行调试 - 您需要先中断进程的执行，然后才能查看调用堆栈等内容......

要中断进程的执行，您需要打断点，或者您可以随时使用暂停/中断所有工具栏项 ( `Control`+ `Alt`+ `Break`) 中断进程的执行。

然后您应该能够在 Debug -> Windows 菜单下访问以下窗口：

*   拆卸窗口
*   寄存器窗口
*   调用堆栈窗口
*   模块窗口显示已加载模块的列表及其相应符号的加载位置（如果已加载）

其他一些有用的窗口：

*   如果您一次调试多个进程，则进程窗口很有用
*   线程窗口
*   内存窗口（有四个）
*   当地人窗口

默认情况下，其中一些可能不可见，具体取决于您在首次启动 Visual Studio 时选择的窗口配置 - 如果找不到它们，则右键单击工具栏并转到自定义以添加它们。

Visual Studio 不会从反汇编中重建源代码 - 您确实需要有原始源代码可供您使用，否则这些符号几乎肯定不会与您正在调试的源代码匹配。

**如果您在没有源代码的情况下调试非托管模块，那么我建议您至少尝试一下[WinDbg](http://en.wikipedia.org/wiki/WinDbg)** - 它的用户界面有时有点笨拙，并且确实有一个陡峭的学习曲线，但是它是一个非常强大的调试器，支持 Visual Studio 的许多功能不是 - 它可能更适合您需要做的那种调试。

（Visual Studio 是一个很棒的调试器，但它主要用于调试源代码可用的模块，因此它缺乏某些功能以提供更好的用户体验）。

            回答 #2

赞同：2

时间：2008-12-11T21:14:05.793

假设这是您在 VS 中编写的应用程序，只需按 F5 运行程序并使用断点或手动中断程序以开始调试。

            回答 #3

赞同：1

时间：2009-12-21T17:51:56.523

最后一个屏幕截图中的问题是 Visual Studio 没有自动进入中断模式。这似乎是一个错误。如果您点击工具栏上的“暂停”按钮，它将进入中断模式，为您提供反汇编和调用堆栈。

根据最后一个屏幕截图，您实际上已附加到程序......输出窗口显示它为 OLE 和 crt 加载了剥离的符号。

            回答 #4

赞同：1

时间：2009-12-22T16:16:15.533

如果您有可用于该程序的调试信息，则可以使用 Visual Studio 调试该程序。这是编译发布版本（通常没有调试信息）和编译调试版本之间的区别。

如果您正在测试您自己编写的程序的调试版本，这个调试程序的对话框非常方便。您可以将它“即时”附加到您的 Visual Studio 调试器并查找问题。

如果它不是您的程序或者是您的程序，但没有提供 Visual Studio 可以理解的调试信息，那么您就不走运了。

            回答 #5

赞同：1

时间：2010-03-17T17:39:16.810

使用菜单*Debug* -> *Windows* -> *Disassembly*（我认为键盘快捷键是`Alt`+ `8`，但我配置为 VC 6.0 绑定，因为这就是我滚动的方式，它可能已经改变）。

您可以从 获取操作系统的公共符号`http://msdl.microsoft.com/download/symbols`。将其添加到菜单*Tools* -> *Options* -> *Debugging* -> *Symbols* -> *Symbol file locations*的列表中。

此外，请确保您以与应用程序相同的完整性级别运行。或者始终以管理员身份运行 Visual Studio。

            回答 #6

赞同：0

时间：2011-12-08T18:31:41.703

我猜你已经处于调试模式。“运行”按钮被禁用。只需转到 Debug -> windows -> Disassembly 即可查看反汇编。

        svn - 如何在颠覆中更新属性

ID：360913

赞同：0

时间：2008-12-11T21:05:39.930

标签：svn

如何更新我的 subversion 存储库，以便它可以接受对日志消息字段的更新？我已经安装了 Windows，并且我将 pre-revprop-change.tmpl 文件名更改为批处理文件，但是现在当我尝试更新日志消息属性时，我的 tortoise svn 只是挂起并且属性没有更新。难道我做错了什么？

由于它很小，我的 pre-revprop-change.bat 文件在下面

```
REPOS="$1"
REV="$2"
USER="$3"
PROPNAME="$4"
ACTION="$5"

if [ "$ACTION" = "M" -a "$PROPNAME" = "svn:log" ]; then exit 0; fi

echo "Changing revision properties other than svn:log is prohibited" >&2
exit 1 
```

            回答 #1

赞同：1

时间：2008-12-11T21:33:09.157

这是我最终使用的文件，我无法调试检查以确保日志消息不为空的部分，如果有人可以的话，我会很感激。显然，我意识到我已将其注释掉。

```
@ECHO OFF 

set repos=%1 
set rev=%2 
set user=%3 
set propname=%4 
set action=%5 

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
:: Only allow changes to svn:log. The author, date and other revision 
:: properties cannot be changed 
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
if not %propname%==svn:log goto ERROR_PROPNAME 

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
:: Only allow modifications to svn:log (no addition/overwrite or deletion) 
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
if not %action%==M goto ERROR_ACTION 

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
:: Make sure that the new svn:log message contains some text. 
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: 
::set bIsEmpty=true 
::for tokens=* %%g in (find "") do ( 
:: set bIsEmpty=false 
::) 
::if %bIsEmpty%==true goto ERROR_EMPTY 

exit 0

:ERROR_EMPTY 
echo Empty svn:log properties are not allowed. >&2 
goto ERROR_EXIT 

:ERROR_PROPNAME 
echo Only changes to svn:log revision properties are allowed. You tried %propname% >&2 
goto ERROR_EXIT 

:ERROR_ACTION 
echo Only modifications to svn:log revision properties are allowed. >&2 
goto ERROR_EXIT 

:ERROR_EXIT 
exit 1 
```

            回答 #2

赞同：1

时间：2008-12-11T21:10:01.560

那不是一个合适的批处理文件；您需要使用 cmd.exe 批处理语法。

[这](http://svn.haxx.se/users/archive-2006-03/0107.shtml)是您可能想尝试的示例（可能在调整后）。

        asp.net - Uri.EscapeDataString(Request.Url.AbsoluteUri) 在不同的环境中是错误的，我还应该使用什么？

ID：360918

赞同：0

时间：2008-12-11T21:06:17.883

标签：asp.net, httpwebrequest, request, httprequest

我正在生成一个返回 url 链接，因此当用户点击此页面上的关闭按钮时，他们将返回此 ReturnUrl。

即
[http://localhost:42605/Search.aspx?ReturnUrl=http%3A%2F%2Flocalhost%3A42605%2FStuff%2FViewStuff.aspx%3FProjectId%3D2246](http://localhost:42605/Search.aspx?ReturnUrl=http%3A%2F%2Flocalhost%3A42605%2FStuff%2FViewStuff.aspx%3FProjectId%3D2246)

这在开发环境中工作正常，但在 uat 环境中我有

[http://app-uat.com/Search.aspx?ReturnUrl=http%3A%2F%2Fapp-uat-01.com%2FStuff%2FViewStuff.aspx%3FProjectId%3D2246](http://app-uat.com/Search.aspx?ReturnUrl=http%3A%2F%2Fapp-uat-01.com%2FStuff%2FViewStuff.aspx%3FProjectId%3D2246)

请注意 ReturnUrl 参数上的额外 01。

所以要生成我目前正在使用的 ReturnUrl 位

Uri.EscapeDataString(Request.Url.AbsoluteUri)

由于我没有直接访问 uat 环境的权限，因此我不知道在发布周期之后什么会起作用，所以如果我能避免第一次出错，那将是有帮助的。

查看 Request.Url 调试我的可能性

DnsSafeHost 或主机

可以与

AbsolutePath 或 LocalPath 或 PathAndQuery

或者我有

原始字符串

或者我也许可以使用推荐人？

            回答 #1

赞同：1

时间：2008-12-12T07:04:53.573

PathAndQuery 为您提供了带有查询字符串变量的相对路径，因此您不必担心域上的额外“01”。只处理相对路径。

出于好奇，你的uat环境负载均衡了吗？您的应用似乎对它响应的域感到困惑。如果请求直接到达平衡服务器而不是负载平衡点，或者负载平衡器将请求转发到特定于机器的域，这可能（可能）发生？

我会向您的网络管理员索取信息。如果您非常详细地描述您正在做的事情，尤其是您的应用有时认为它正在响应 app-uat-01，他们可能会立即看到问题。

        sql-server - SQL Server 索引没有帮助

ID：360928

赞同：0

时间：2008-12-11T21:07:43.437

标签：sql-server, indexing, sql-server-2000

我有一个包含超过 10,000,000 条记录的表 (SQL 2000)。记录以每周大约 80,000-100,000 条的速度添加。每周一次，从数据中生成一些报告。报告的运行通常相当缓慢，因为索引很少（可能是为了加快 INSERT）。一份新报告可以真正受益于特定“char(3)”列的附加索引。

我已经使用企业管理器添加了索引（管理索引 -> 新建 -> 选择列，OK），甚至重建了表上的索引，但是 SELECT 查询根本没有加速。有任何想法吗？

**更新**：

表定义：

```
ID, int, PK
Source, char(3)  <--- column I want indexed
...
About 20 different varchar fields
...
CreatedDate, datetime
Status, tinyint
ExternalID, uniqueidentifier 
```

我的测试查询只是：

```
select top 10000 [field list] where Source = 'abc' 
```

            回答 #1

赞同：5

时间：2008-12-11T21:55:42.230

您需要查看查询计划并查看它是否正在使用该新索引 - 如果没有，则有几件事。一 - 它可能有一个正在使用的缓存查询计划，该计划自创建新索引以来尚未失效。如果不是这种情况，您还可以尝试索引提示 [ With (Index (yourindexname)) ]。

10,000,000 行并非闻所未闻，它应该很快就能读出来。

            回答 #2

赞同：1

时间：2008-12-11T21:44:15.407

使用 SQL 查询分析器中的 Show Execution Plan 查看是否使用了索引。

如果还没有，您也可以尝试将其设为聚集索引。

            回答 #3

赞同：0

时间：2008-12-11T21:10:38.063

对于这种大小的表，您最好的选择可能是对表和索引进行分区。

            回答 #4

赞同：0

时间：2008-12-11T23:19:38.567

```
 select top 10000 
```

你的资源有多独特？SQL 引擎通常会忽略具有很少值的字段的索引。它们使查询变慢。如果您的 SOURCE 字段只有少数值，您可能想要删除该索引并查看它是否更快。

        asp.net - 使用子页面中的数据更新母版页上的链接

ID：360935

赞同：1

时间：2008-12-11T21:09:27.923

标签：asp.net, master-pages

我的母版页中有一个报告链接菜单。每当用户更改子页面上的值时，我都需要在每个末尾附加一个 ID。有什么好方法可以做到这一点？

更新：我应该提到子更新发生在 UpdatePanel 中，这意味着发生更改时不会重新加载母版页。

            回答 #1

赞同：2

时间：2008-12-11T21:25:36.707

MasterPage 实际上是它所控制的页面的子控件。您可以像控制页面上的任何其他控件一样控制 MasterPage（几乎）。您需要做的就是获取它的引用。

您将属性添加到 MasterPage 的代码中，因此其代码可能如下所示：

```
public partial class _default : System.Web.UI.MasterPage
{
    protected string m_myString = string.Empty;
    public string myString
    {
        get { return m_myString; }
        set { m_myString = value; }
    }
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

然后您必须将 this.Master 属性转换为您的 MasterPage

```
public partial class index : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        // Cast here to get access to your MasterPage
        _default x = (_default)this.Master;
        x.myString = "foo";
    }
} 
```

            回答 #2

赞同：0

时间：2008-12-12T07:14:42.337

回应您的更新：

更新后的面板可以将 ID 写入隐藏字段，菜单事件可以在`Request.Form["fieldName"]`.

请注意，您不应该这样`fieldName.Text`做，因为 ASP.NET 在为已 AJAX 处理的字段返回正确值方面做得不好。

        c# - 从文件中读取文本并对其应用一些操作

ID：360943

赞同：0

时间：2008-12-11T21:11:00.450

标签：c#

例如，我对如何从文件中读取文本并对其执行操作有疑问

我有这个文本文件，其中包括

//名字-//性别----------//出生//m1//m2//m3

```
fofo, male,    1986, 67, 68,  69
momo, male,    1986, 99, 98,  100
Habs, female,  1988, 99, 100, 87
toto, male,    1989, 67, 68,  69
lolo, female,  1990, 89, 80,  87
soso, female,  1988, 99, 100, 83 
```

现在我知道如何逐行阅读直到达到 null 。

但这次我想稍后执行平均函数来获得第一列数字 m1 的平均值

然后获得仅女性和男性的 m1 平均值

以及我可以做的其他一些操作没问题

我需要帮助我不知道如何得到它我想到的是读取文本文件中的每一行并将其放入一个字符串然后拆分字符串 (str.Split(','); ) 但如何获取每个字符串上的 m1 记录我真的很困惑我应该使用正则表达式来获取整数吗？我应该使用二维数组吗？我完全迷路了，有什么想法吗？

如果您可以通过一个很棒的代码示例和您的善意启蒙来改进任何想法，请。

完成后，我会将其发布给你们检查。

{ 作为一个女孩，我认为我加入 IT 社区的决定是错误的 :-( }

            回答 #1

赞同：5

时间：2008-12-11T21:29:44.997

尝试这样的事情。

```
 var qry = from line in File.ReadAllLines(@"C:\Temp\Text.txt")
            let vals = line.Split(new char[] { ',' })
            select new
            {
              Name = vals[0].Trim(),
              Sex = vals[1].Trim(),
              Birth = vals[2].Trim(),
              m1 = Int32.Parse(vals[3]),
              m2 = Int32.Parse(vals[4]),
              m3 = Int32.Parse(vals[5])
            };

  double avg = qry.Average(a => a.m1);
  double GirlsAvg = qry.Where(a => a.Sex == "female").Average(a => a.m1);
  double BoysAvg = qry.Where(a => a.Sex == "male").Average(a => a.m1); 
```

            回答 #2

赞同：1

时间：2008-12-11T21:22:59.270

（注意：这似乎是一个过于复杂的解决方案，但我假设源数据很大（很多行），因此将其加载到 a`List<T>`中可能不可行）

使用迭代器块可以很好地完成文件读取......如果数据很大，您一次只想处理一行，而不是二维数组。

这实际上看起来很适合[MiscUtil](http://www.pobox.com/~skeet/csharp/miscutil/)的 PushLINQ 方法，它可以在数据流上*同时*执行多个聚合，而无需缓冲......

下面是一个例子...

**为什么这有用？**

因为它允许您使用标准 LINQ 语法在数据源上编写多个查询，但只能读取一次。

**例子**

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using MiscUtil.Linq;
using MiscUtil.Linq.Extensions;
static class Program
{

    static void Main()
    {
        // prepare a query that is capable of parsing
        // the input file into the expected format
        string path = "foo.txt";
        var qry = from line in ReadLines(path)
                  let arr = line.Split(',')
                  select new
                  {
                      Name = arr[0].Trim(),
                      Male = arr[1].Trim() == "male",
                      Birth = int.Parse(arr[2].Trim()),
                      M1 = int.Parse(arr[3].Trim())
                      // etc
                  };

        // get a "data producer" to start the query process
        var producer = CreateProducer(qry);

        // prepare the overall average
        var avg = producer.Average(row => row.M1);

        // prepare the gender averages
        var avgMale = producer.Where(row => row.Male)
                    .Average(row => row.M1);    
        var avgFemale = producer.Where(row => !row.Male)
                    .Average(row => row.M1);

        // run the query; until now *nothing has happened* - we haven't
        // even opened the file    
        producer.ProduceAndEnd(qry);

        // show the results
        Console.WriteLine(avg.Value);
        Console.WriteLine(avgMale.Value);
        Console.WriteLine(avgFemale.Value);
    }
    // helper method to get a DataProducer<T> from an IEnumerable<T>, for
    // use with the anonymous type
    static DataProducer<T> CreateProducer<T>(IEnumerable<T> data)
    {
        return new DataProducer<T>();
    }
    // this is just a lazy line-by-line file reader (iterator block)    
    static IEnumerable<string> ReadLines(string path)
    {
        using (var reader = File.OpenText(path))
        {
            string line;
            while ((line = reader.ReadLine()) != null)
            {
                yield return line;
            }
        }
    }

} 
```

            回答 #3

赞同：1

时间：2008-12-11T21:32:58.720

是否有理由不创建存储文件字段、字符串、布尔值（对于 m/f）、整数和 3 个整数的数据结构，您可以将其制成一个存储值然后循环的列表通过它来计算各种总和、平均值以及您想要的任何其他聚合函数。

            回答 #4

赞同：1

时间：2008-12-11T21:19:26.813

不久前我写了一篇博文，详细介绍了读取 CSV 文件并解析其列的行为：

[http://www.madprops.org/blog/back-to-basics-reading-a-csv-file/](http://www.madprops.org/blog/back-to-basics-reading-a-csv-file/)

我采用了您提到的方法（拆分字符串），然后使用 DateTime.TryParseExact() 和相关方法将各个值转换为我需要的类型。

希望帖子有帮助！

            回答 #5

赞同：0

时间：2008-12-11T21:25:16.253

我推荐使用 FileHelpers 库。在此处查看示例：[快速入门](http://www.filehelpers.com/quick_start.html)

您可以像页面上的那样计算 foreach 循环中的平均值。

            回答 #6

赞同：0

时间：2008-12-11T22:21:55.687

苏珊娜，我提前道歉，但我并不是要冒犯你。你已经说过“作为一个女孩，你做出了加入 IT 的错误决定……”，我之前一直从我的姐妹们那里听到我试图帮助她们选择职业时的说法。但是，如果您在遵循上述答案时遇到概念上的困难，而不仅仅是复制和粘贴代码，我认为您只是验证了部分陈述。     

话虽如此，IT 领域不仅仅是编写代码。换句话说，编码可能不仅适合您，而且您可能会在 IT 的其他领域表现出色，包括有一天成为一名经理。我遇到过很多经理，他们用任何语言都无法做到以上这些，但他们在管理人员、项目和资源方面做得很好。

相信我，从这里开始只会越来越难。这是编程中非常基本的任务。但是，如果您很快意识到这一点，您可以与您的经理交谈，询问公司中的非编码挑战。QA 也可能是另一种选择。再说一次，我只是想帮忙，如果你被冒犯了，我很抱歉。祝你好运。        

            回答 #7

赞同：0

时间：2008-12-12T05:10:04.133

重新跟进“如果”；您只需循环：

```
// rows is the jagged array of string1, string2 etc
int totalCounter = 0, totalSum = 0; // etc
foreach(string[] row in rows)
{
    int m1 = int.Parse(row[3]);
    totalCounter++;
    totalSum += m1;
    switch(row[2]) {
        case "male":
            maleCount++;
            maleSum += m1;
            break;
        case "female":
            femaleCount++;
            femaleSum += m1;
            break;
    }
} 
```

等等。然而，虽然这有效，但您可以在 C# 3.0 中使用 LINQ 更方便/更富有表现力地做同样的事情，这是*许多*现有回复试图展示的......事实上，Tim J 的帖子已经做这一切：

*   ReadAllLines：获取每行的行数组
*   拆分：获取每行的数据数组
*   “select new {...}”：将数据解析成方便的东西
*   3“avg”行显示如何对过滤后的数据取平均值

我要做的唯一改变是我会在某个地方添加一个 ToArray() ，所以我们只读取一次文件......

        sql-server-2005 - SQL 排序和连字符

ID：360950

赞同：8

时间：2008-12-11T21:12:09.043

标签：sql-server-2005, sorting, hyphen

有没有一种方法可以在 SQL Server 2005 中轻松排序，同时忽略字符串字段中的连字符？目前我必须做一个 REPLACE(fieldname,'-','') 或一个函数来删除排序子句中的连字符。我希望可以在存储过程的顶部设置一个标志或其他东西。

Access 和 GridView 默认排序似乎忽略了字符串中的连字符。

            回答 #1

赞同：19

时间：2008-12-11T21:37:21.393

我学到了一些新东西，就像你一样

我相信区别在于“**字符串排序**”与“**单词排序**”（忽略连字符）

WORD 排序和 STRING 排序之间的示例区别
[http://andrusdevelopment.blogspot.com/2007/10/string-sort-vs-word-sort-in-net.html](http://andrusdevelopment.blogspot.com/2007/10/string-sort-vs-word-sort-in-net.html)

来自微软
[http://support.microsoft.com/kb/322112](http://support.microsoft.com/kb/322112)

例如，如果您使用 SQL 排序规则“SQL_Latin1_General_CP1_CI_AS”，则非 Unicode 字符串“ac”小于字符串“ab”，因为连字符 (“-”) 被排序为位于“b”之前的单独字符. 但是，如果将这些字符串转换为 Unicode 并执行相同的比较，则认为 Unicode 字符串 N'a-c' 大于 N'ab'，因为 Unicode 排序规则使用忽略连字符的“单词排序” .

我做了一些示例代码，您也可以使用 COLLATE 来找到适合您排序的代码

```
DECLARE @test TABLE
(string VARCHAR(50))

INSERT INTO @test SELECT 'co-op'
INSERT INTO @test SELECT 'co op'
INSERT INTO @test SELECT 'co_op'

SELECT * FROM @test ORDER BY string --COLLATE SQL_Latin1_General_Cp1_CI_AS
--co op
--co-op
--co_op

SELECT * FROM @test ORDER BY CAST(string AS NVARCHAR(50)) --COLLATE SQL_Latin1_General_Cp1_CI_AS
--co op
--co_op
--co-op 
```

        database-design - 购物车的数据库表结构

ID：360959

赞同：2

时间：2008-12-11T21:13:59.163

标签：database-design

我是 SQL 的初学者，正在研究我的第一个数据库。我正在尝试创建一个非常精简的购物车，并且目前正在努力在开始编码网站之前将数据库放在一起。

我正在努力解决的一件事是如何构建数据库的产品部分。如果我所有的产品都是单独的物品，那就没问题了。我的问题是，我还希望能够创建各种“包装”，将几种产品组合成一个具有自己唯一 ID 但价格不同的包装/产品。

有没有人解决过这个问题......哎呀，我相信有人有。我的问题是：是否有一种最佳实践方法来构造数据库表以允许这种事情？从逻辑上讲，我很难理解这个问题。

            回答 #1

赞同：3

时间：2008-12-11T21:37:40.053

Ayende Rahien（来自 RhinoMocks）最近做了一系列关于构建购物车的工作，从这里开始： http: [//ayende.com/Blog/archive/2008/12/07/designing-a-shopping-cart.aspx](http://ayende.com/Blog/archive/2008/12/07/designing-a-shopping-cart.aspx)。它确实使用了类图，但您应该能够将概念转换为数据库图。

            回答 #2

赞同：1

时间：2008-12-11T21:21:37.183

我可能会创建一个包含包裹 ID 和价格的包裹表，然后在包裹和产品之间创建一个中间（交叉引用）表，其中包含包裹 ID（作为包裹表的 FK）和相应的产品 ID（作为 FK到产品表）。

            回答 #3

赞同：1

时间：2008-12-11T22:08:22.503

Ayende 所做的任何事情都会超出初学者的想象。要回答您的问题，您需要 3 张桌子。一种用于您的产品，一种用于您的包裹，另一种用于将产品“链接”到包裹。我假设你已经涵盖了前两个。第三种称为多对多关系。

它应该被称为 ProductsPackages 并且有两列（PackageId 和 ProductId）。您应该为 Products 和 Packages 表创建外键约束。

现在，要将产品添加到包中，请将每个产品的 id 插入 ProductsPackages 表中。

            回答 #4

赞同：1

时间：2008-12-11T23:06:39.577

避免额外表但施加一些限制的一种方法是简单地将自引用“ParentID”字段添加到产品表。那个“ParentID”只是指向相关的包产品。由于都是同一张表，因此您的包裹与您的单个产品具有相同的字段（价格等）。要查找组成包的产品，只需查询具有包的“ProductID”的“ParentID”的所有产品。

限制是产品只能是一个包装的一部分。因此，如果您销售棒球、球棒和手套，以及包含这三者的“棒球”包装，则该手套永远不会成为“足球”包装的一部分。

然而，一个优点是“棒球”和“足球”包装以及“教练手册”产品都可以成为“完整运动”包装的一部分。如果您将球棒从“棒球”包装中取出，它也会从“完整运动”包装中取出。所有这些都无需添加单个表。

当然，每个产品的单一包装限制意味着这肯定不会适用于所有情况。

        sql - MySql 查询，选择大于

ID：360961

赞同：11

时间：2008-12-11T21:14:19.473

标签：sql, mysql

我有一个名为 faq_questions 的表，其结构如下：

```
id int not_null auto_increment,
question varchar(255),
sort_order int 
```

我正在尝试构建一个给定排序顺序的查询，选择具有下一个最高排序顺序的行。  

例子：

```
id  question                sort_order
1   'This is question 1'    10
2   'This is question 2'    9
3   'This is another'       8
4   'This is another one'   5
5   'This is yet another'   4 
```

好的，假设我为已知的排序顺序（id 4）传入 5，我需要它返回 id 为 3 的行。由于不能保证 sort_order 是连续的，我不能只选择 known_sort_order + 1。  

谢谢！

            回答 #1

赞同：23

时间：2008-12-11T21:18:36.610

这似乎太简单了，但它看起来像你需要的：    

```
SELECT id,question FROM `questions` 
WHERE `sort_order` > sort_order_variable
ORDER BY sort_order ASC 
LIMIT 1 
```

            回答 #2

赞同：3

时间：2008-12-11T21:22:23.437

```
SELECT * FROM table_name WHERE sort_order > 5 ORDER BY sort_order ASC LIMIT 1 
```

            回答 #3

赞同：2

时间：2008-12-11T21:18:37.873

你可以用`TOP`or来做`LIMIT`：

```
SELECT TOP 1 * FROM faq_questions
WHERE sort_order > 5
ORDER BY sort_order ASC 
```

但这不像优雅或便携

```
SELECT *  
FROM faq_questions AS f1  
LEFT JOIN faq_questions AS f2  
    ON f1.sort_order > f2.sort_order  
    AND f2.sort_order = 5  
LEFT JOIN faq_questions AS f3  
    ON f3.sort_order BETWEEN f1.sort_order AND f2.sort_order  
WHERE f3.id IS NULL 
```

            回答 #4

赞同：0

时间：2008-12-11T21:20:20.930

```
SELECT 
    id, question, sort_order
FROM faq_questions 
WHERE sort_order in 
(SELECT 
        MIN(sort_order) 
    FROM faq_questions 
    WHERE sort_order > ?); 
```

这似乎有效

        objective-c - Objective-C 中的类别使用

ID：360968

赞同：6

时间：2008-12-11T21:17:30.687

标签：objective-c

我看到一些我继承的代码如下所示：

```
@interface SomeClass (private) 
```

这是在`SomeClass.m`实现文件中。附带的头文件并不表明该类正在使用类别。在`(private)`这种情况下，只是给一个类别一个糟糕的名字`SomeClass`吗？而且我假设在实现中指定诸如此类的类别是完全合法的？

            回答 #1

赞同：30

时间：2008-12-11T21:58:53.783

使它成为私有的并不是“私有”这个名字。这些方法是私有的，因为它们位于实现文件中声明的类别中。

一个类别有三种用途，每一种都向一个类添加方法（注意：只有方法，不是 iVars）

**扩展现有的 Cocoa 类**

这使您可以将自己的方法添加到现有类中。例如，如果你想扩展 NSString 以应用特殊的大写，你可以创建一个名为 NSString+Capitals 的新类。在 NSString+Capitals.h 中，您将拥有：

```
@interface NSString (Capitals)

-(NSString *)alternateCaps:(NSString *)aString;

@end 
```

在 NSString+Capitals.m 中，您将实现该方法

```
@implementation NSString (Capitals)
-(NSString *)alternateCaps:(NSString *)aString
{
    // Implementation
} 
```

**类的私有方法**

这与上面相同，只是在实现文件（.m）中声明和定义了额外的方法通常是一种拥有私有方法的方式 - 因为它们不在.h文件中（这是一个#imported by other类）它们根本不可见。在这种情况下，方法的实现在它们自己的实现块中完成。例如

```
// someClass.m
@interface someClass (extension)
-(void)extend;
@end

@implementation someClass
    // all the methods declared in the .h file and any superclass
    // overrides in this block
@end

@implementation someClass (extension)
-(void)extend {
    // implement private method here;
} 
```

**类扩展**（10.5 Leopard 的新功能）

拥有私有方法的更简单方法。在这种特殊情况下，类别名称为空，并且私有方法与所有其他类方法在同一块中实现。

```
// someClass.m
@interface someClass ()
-(void)extend;
@end

@implementation someClass
    // all the methods declared in the .h file and any superclass
    // overrides in this block
    // Implement private methods in this block as well.
-(void)extend {
    // implement private method here;
}

@end 
```

这是关于类别和扩展的 Apple 文档的[链接。](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html)

            回答 #2

赞同：2

时间：2008-12-11T21:28:35.983

“私有”只是一个名称，表明方法不是公共的，并且用于类的内部实现，但在类别的声明中没有任何强制执行的内容。

此外，类别中定义的方法在运行时添加到类定义中，因此随附的头文件无需声明它正在使用类别——它会自动“使用”。

            回答 #3

赞同：2

时间：2008-12-11T21:57:18.920

我用它来给我一个地方来声明（并因此记录，以及关闭编译器）不需要在公共接口中的辅助方法。然后类的“消费者”（默认情况下，考虑到除了礼貌之外没有什么可以阻止他们）限制使用头文件中定义的方法。

        valgrind - 如何检测是否在 make 文件或 shell 脚本中运行在 valgrind 下？

ID：360970

赞同：0

时间：2008-12-11T21:18:07.220

标签：valgrind

我需要检测我的 Makefile 是否在 valgrind 下运行（间接地，使用 valgrind --trace-children=yes），我知道如何从 C 中执行此操作，但我还没有找到从脚本中执行此操作的方法，

较早的答案仅适用于 Linux。对于 Mac OS XI，除非有人有更好的主意，否则我会在环境中使用 grep 查找 VALGRIND_STARTUP_PWD。

            回答 #1

赞同：3

时间：2008-12-11T21:31:04.933

从外壳：

`grep -q '/valgrind' /proc/$$/maps && echo "valgrindage"`

这确定 valgrind 预加载的库是否存在于进程的地址映射中。这是*相当*有效的，但如果你碰巧有一个共享“/valgrind”名字的非 valgrind 相关库，那么你会得到一个误报（不太可能）。

[我将 grep 模式从 vg_preload 更改为 /valgrind，因为在 Debian/Ubuntu 上的测试显示库名称不同，而 valgrind 的目录匹配最有可能成功。]

        c# - 日期时间格式，如 HH:mm 24 小时，无 AM/PM

ID：360982

赞同：11

时间：2008-12-11T21:19:51.447

标签：c#, datetime, formatting

我在这里搜索有关将“16:20”之类的字符串转换为 DateTime 类型而不丢失格式的信息，我说我不想添加 dd/MM/yyy 或秒或 AM/PM，因为 db 只接受这种格式。

我尝试过文化

提前致谢

            回答 #1

赞同：23

时间：2012-08-23T10:40:42.020

只需为您的 dateTime 提供日期格式。

`string DateFormat = "yyyy MM d "`这将为您提供**年份月份和日期**。继续后； 
`string DateFormat = "yyyy MM d HH:mm:ss "`  在这里，**大写 H**将为您提供`24 hours time format`小写`"h" will give you the 12 hours time`格式...

当您将 Dateformat 作为字符串提供时，您可以对日期和时间做任何您想做的事情。

```
string DateFormat = "yyyyMMdHHmmss";
string date = DateTime.Now.ToStrign(DateFormat); 
```

或者

```
Console.writeline(DateTime.Now.ToStrign(DateFormat)); 
```

**输出：**

```
20120823132544 
```

            回答 #2

赞同：15

时间：2008-12-11T21:45:23.920

所有 DateTime 对象都必须有日期和时间。

如果您只需要时间，请使用 TimeSpan：  

```
TimeSpan span = TimeSpan.Parse("16:20"); 
```

如果您需要 DateTime，请将该时间添加到最小值：

```
TimeSpan span = TimeSpan.Parse("16.20");
DateTime dt = DateTime.MinValue.Add(span);
// will get you 1/1/1900 4:20 PM which can be formatted with .ToString("HH:mm") for 24 hour formatting 
```

            回答 #3

赞同：3

时间：2008-12-11T21:23:47.023

DateTime.Now.ToString("hh:mm") - 如果是 C#。

哦。只阅读标题。

```
DateTime dt = new DateTime(2008, 12, 11, Convert.ToInt32("16"), Convert.ToInt32("32"), 0); 
```

            回答 #4

赞同：1

时间：2008-12-11T21:26:57.140

“丢失格式”是什么意思。

如果将其转换为 DateTime 类型，则 DateTime 对象将具有 dd/mm/yy 和其他属性。根据您打算如何使用该对象，您可以“恢复”您的原始设置，方法是像这样格式化字符串输出：DT.ToString("HH:mm");

            回答 #5

赞同：1

时间：2008-12-11T21:27:21.383

由于您没有规定您使用的是哪个 DBMS，因此很难知道哪个答案会对您有所帮助。如果您使用 IBM Informix Dynamic Server，您只需使用数据类型“DATETIME HOUR TO MINUTE”，它将以 24 小时制记录值。

            回答 #6

赞同：1

时间：2008-12-11T21:29:33.000

```
DateTime.Parse("16:20") 
```

            回答 #7

赞同：0

时间：2008-12-11T21:24:11.890

我想解决你问题的这一部分：

不丢失格式

数据库通常会以标准的通用格式存储所有日期时间值，这种格式甚至不是人类可读的。如果您使用日期时间列，则原始格式将被破坏。

但是，当您检索该值时，您会将其转换回您想要的任何格式。如果你愿意`HH:mm`，你可以得到它。

        linq - 如何从模型 LINQ 中获取列名？

ID：360990

赞同：3

时间：2008-12-11T21:22:17.180

标签：linq, reflection

我正在寻找从模型返回的列名列表。任何人都知道如何做到这一点，任何帮助将不胜感激。

示例代码：

```
var project = db.Projects.Single(p => p.ProjectID.Equals(Id)); 
```

此代码将返回 Projects 对象，我将如何获取此模型中所有列名的列表。

谢谢

            回答 #1

赞同：15

时间：2008-12-12T18:39:30.573

这将是很好的扩展方法：

```
public static class LinqExtensions
{
  public static ReadOnlyCollection<MetaDataMember> ColumnNames<TEntity> (this DataContext source)
  {
      return source.Mapping.MappingSource.GetModel (typeof (DataContext)).GetMetaType (typeof (TEntity)).DataMembers;
  }
} 
```

例子：

```
var columnNames = myDataContext.ColumnNames<Orders> (); 
```

            回答 #2

赞同：6

时间：2008-12-12T13:39:35.263

谢谢你们，你们让我开始走上正轨。我使用以下代码找到了我的解决方案。然后，我可以遍历 DataMembers 并提取它们的各个属性，例如名称、类型等。

```
var db = new GMPDataContext();
var columnNames = db.Mapping.MappingSource
                    .GetModel(typeof(GMPDataContext))
                    .GetMetaType(typeof(Project))
                    .DataMembers; 
```

            回答 #3

赞同：3

时间：2008-12-11T22:05:21.790

您的项目包装器将具有一组属性，每个属性都有一个 [Column] 属性。所以只需使用反射来枚举具有该属性的属性。

            回答 #4

赞同：2

时间：2011-03-31T14:01:50.483

使用 Todd Smiths(+1) 解决方案，您可以获得所有属性（包括实体集等）。要过滤掉所有非列属性，这将起到作用：

```
var columnNames = db.ColumnNames<Orders>().Where(n => n.Member.GetCustomAttributes(typeof(System.Data.Linq.Mapping.ColumnAttribute), false).FirstOrDefault() != null).Select(n => n.Name); 
```

            回答 #5

赞同：1

时间：2008-12-11T22:17:10.783

对不起，我没有使用 LINQ 的工作经验。

这纯粹是基于查看 MSDN。

`DataContext`有一个`Mapping`属性，它返回一个[`MetaModel`](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.metamodel.aspx). 

`MetaModel`有`GetMetaType`，它需要一个`Type`。在你的情况下，它可能是`typeof(Project)`. 

`GetMetaType`返回`MetaType`具有[`GetDataMember`](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.metatype.getdatamember.aspx)方法的a，该方法带有[`MemberInfo`](http://msdn.microsoft.com/en-us/library/system.reflection.memberinfo.aspx)参数。您必须在`Projects`对象上使用反射来获取`MemberInfo`对象。

返回的[`MetaDataMember`](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.metadatamember.aspx)实例`GetDataMember`应该有你需要的所有东西。

我希望我的方向有点正确（纯粹看 MSDN 和遍历）

            回答 #6

赞同：0

时间：2008-12-11T22:03:19.610

您的列应映射为项目模型上的属性。我不确定在使用 LINQ to SQL 时是否可以获得底层数据库结构。LINQ to SQL 的全部意义在于将数据库抽象出来。

            回答 #7

赞同：0

时间：2014-01-07T10:08:46.480

这是另一种方式：

```
 public string[] GetColumnNames()
        {
            var propnames = GetPropertyNames(_context.Users);
            return propnames.ToArray();
        }

        static IEnumerable<string> GetPropertyNames<T>(IEnumerable<T> lst)
        {
            foreach (var pi in typeof(T).GetProperties())
            {
                yield return pi.Name;
            }
        } 
```

        objective-c - 协议与类别

ID：360992

赞同：39

时间：2008-12-11T21:22:23.373

标签：objective-c, objective-c-category, objective-c-protocol

谁能解释一下Objective-C 中**协议**和**类别之间的区别？**你什么时候使用一个而不是另一个？

            回答 #1

赞同：91

时间：2008-12-11T21:40:27.097

协议与 Java 中的接口相同：它本质上是一个约定，**“任何实现此协议的类也将实现这些方法”。**

另一方面，类别只是将方法绑定到一个类。例如，在**Cocoa**中，我可以为其创建一个类别，`NSObject`这将允许我向`NSObject`该类（当然还有所有子类）添加方法，*即使我真的无法访问`NSObject`*.

**总结一下：**协议指定类将实现哪些方法；类别将方法添加到现有类。

那么，每种方法的正确使用应该很清楚：**使用协议来声明类必须实现的一组方法，并使用类别向现有类添加方法。**

            回答 #2

赞同：29

时间：2008-12-11T21:56:44.820

一个协议说，“这里有一些我希望*你*实现的方法。” 一个类别说：“我正在使用这些附加方法扩展这个类的功能。”

现在，我怀疑您的困惑源于 Apple 使用了“非正式协议”一词。这是关键（也是最令人困惑的）点：非正式协议实际上根本不是协议。它实际上是 NSObject 上的一个类别。Cocoa 普遍使用非正式协议来为委托提供接口。由于该`@protocol`语法在 Objective-C 2.0 之前不允许使用可选方法，因此 Apple 实现了不做任何事情（或返回虚拟值）的可选方法，并要求方法抛出异常。无法通过编译器强制执行此操作。

现在，在 Objective-C 2.0 中，`@protocol`语法支持`@optional`关键字，将协议中的一些方法标记为可选。因此，只要你的类实现了所有标记为 的方法，它就符合协议`@required`。编译器可以确定您的类是否也实现了所有必需的方法，这可以节省大量时间。iPhone SDK 专门使用 Objective-C 2.0`@protocol`语法，我想不出在任何新开发中不使用它的充分理由（除了需要在早期版本的 Mac OS X 上运行的 Mac OS X Cocoa 应用程序） .

            回答 #3

赞同：16

时间：2008-12-11T21:41:31.777

**分类：**  

类别是一种在不修改类本身的情况下向现有类的所有实例添加新方法的方法。

当您想将功能添加到现有类而不从该类派生或重写原始类时，您可以使用类别。

假设您`NSView`在 cocoa 中使用对象，并且您发现自己希望所有实例`NSView`都能够执行某些操作。显然，您不能重写`NSView`该类，即使您从它派生，也不是`NSView`程序中的所有对象都属于您的派生类型。解决方案是在 上创建一个类别`NSView`，然后在程序中使用它。只要您`#import`的头文件包含您的类别声明，它就会看起来好像*每个* `NSView`对象都响应您在类别源文件中定义的方法。

**协议：**

协议是任何类都可以选择实现的方法的集合。

当您想要保证某个类将响应一组特定的方法时，您可以使用协议。当一个类采用协议时，它承诺实现协议头中声明的所有方法。这意味着使用该类的任何其他类都可以确定将实现这些方法，而无需了解有关该类的任何其他信息。

这在创建所有需要与公共“控制器”类通信的类似类家族时很有用。控制器类和受控类之间的通信都可以打包成一个协议。

旁注：objective-c 语言不支持多重继承（一个类只能从一个超类派生），但协议可以提供许多相同的功能，因为一个类可以符合几个不同的协议。

            回答 #4

赞同：5

时间：2008-12-11T21:44:35.997

据我了解，协议有点像 Java 的接口。协议声明方法，但实现取决于每个类。类别似乎类似于 Ruby 的 mixins。使用类别，您可以将方法添加到现有类。甚至内置类。

            回答 #5

赞同：4

时间：2011-09-04T18:53:37.887

协议允许您声明不限于任何特定类或类别的方法列表。协议中声明的方法可以被任何类/类别采用。采用协议的类或类别必须实现协议中声明的所有必需方法。

类别允许您向现有类添加额外的方法，但它们不允许额外的实例变量。类别添加的方法成为类类型的一部分。  

            回答 #6

赞同：1

时间：2009-03-19T10:11:56.047

协议是实现指定方法的合约。任何符合协议的对象都同意为这些方法提供实现。协议的一个很好的用途是为委托定义一组回调方法（委托必须响应所有方法）。

类别提供通过向其添加方法（类或实例方法）来扩展当前对象的能力。类别的一个很好的用途是扩展 NSString 类以添加以前没有的功能，例如添加一个方法来创建将接收器转换为 1337 5P34K 的新字符串。

```
NSString *test = @"Leet speak";
NSString *leet = [test stringByConvertingToLeet]; 
```

            回答 #7

赞同：1

时间：2012-06-14T11:00:00.947

SGKochan 的“Objective-C 编程”中的定义：

**分类：**

类别为您提供了一种简单的方法，可以将类的定义模块化为相关方法的组或类别。它还为您提供了一种扩展现有类定义的简单方法，甚至无需访问该类的原始源代码，也无需创建子类。

**协议：**

协议是类之间共享的方法列表。协议中列出的方法没有对应的实现；它们是由其他人实施的（比如你！）。协议提供了一种方法来定义一组与指定名称相关的方法。这些方法通常会记录在案，以便您知道它们是如何执行的，并且如果需要，您可以在自己的类定义中实现它们。协议列出了一组方法，其中一些您可以选择实现，而另一些则需要您实现。如果您决定为特定协议实现所有必需的方法，则称您符合或采用该协议。您可以定义一个协议，其中所有方法都是可选的，或者所有方法都是必需的。

```*******