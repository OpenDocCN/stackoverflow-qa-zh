# StackOverflow 问答 000099000-000099999

> ID：99000
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99001
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99002
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99003
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99004
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99005
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99006
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99007
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99008
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99009
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99010
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99011
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99012
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99013
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99014
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99015
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99016
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99017
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99018
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99019
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99020
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99021
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99022
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99023
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99024
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99025
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99026
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99027
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99028
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99029
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99030
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99031
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99032
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99033
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99034
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99035
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99036
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99037
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99038
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99039
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99040
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99041
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99042
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99043
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99044
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99045
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99046
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99047
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99048
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99049
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99050
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99051
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99052
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99053
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99054
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99055
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99056
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99057
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99058
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99059
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99060
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99061
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99062
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99063
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99064
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99065
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99066
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99067
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99068
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99069
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99070
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99071
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99072
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99073
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99074
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99075
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99076
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99077
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99078
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99079
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99080
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99081
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99082
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99083
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99084
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99085
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99086
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99087
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99088
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99089
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99090
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99091
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99092
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99093
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99094
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99095
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99096
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99097
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99098
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99099
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99100
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99101
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99102
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99103
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99104
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99105
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99106
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99107
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99108
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99109
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99110
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99111
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99113
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99114
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99115
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99116
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99117
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99118
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：99119
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# makefile - 使用 mkdir 时如何防止生成文件中出现“目录已存在错误”

> ID：99132
> 
> 赞同：117
> 
> 时间：2008-09-19T03:01:16.987
> 
> 标签：makefile, directory, exists

我需要在我的 makefile 中生成一个目录，并且我不想一遍又一遍地得到“目录已经存在错误”，即使我可以很容易地忽略它。

我主要使用 mingw/msys，但也希望能在其他 shell/系统上工作。

我试过这个，但它没有用，有什么想法吗？

```
ifeq (,$(findstring $(OBJDIR),$(wildcard $(OBJDIR) )))
-mkdir $(OBJDIR)
endif 
```

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2011-05-29T20:36:55.020

查看[官方 make 文档](http://www.gnu.org/software/make/manual/make.html#Prerequisite-Types)，这是一个很好的方法：

```
OBJDIR := objdir
OBJS := $(addprefix $(OBJDIR)/,foo.o bar.o baz.o)

$(OBJDIR)/%.o : %.c
    $(COMPILE.c) $(OUTPUT_OPTION) $<

all: $(OBJS)

$(OBJS): | $(OBJDIR)

$(OBJDIR):
    mkdir -p $(OBJDIR) 
```

您应该在这里看到 | 的用法。管道运算符，定义仅订单的先决条件。这意味着`$(OBJDIR)`目标应该存在（而不是*更近*的）才能构建当前目标。

请注意，我使用了`mkdir -p`. `-p`与文档示例相比，添加了该标志。请参阅其他答案以获取另一种选择。

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2008-09-19T03:07:29.313

在 UNIX 上只需使用这个：

```
mkdir -p $(OBJDIR) 
```

如果目录存在，mkdir 的 -p 选项可防止出现错误消息。

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2008-09-19T03:09:34.283

您可以使用测试命令：

```
test -d $(OBJDIR) || mkdir $(OBJDIR) 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2010-09-18T00:06:42.547

这是我使用 GNU make 创建编译器输出目录的技巧。首先定义这个规则：

```
 %/.d:
          mkdir -p $(@D)
          touch $@ 
```

然后使进入该目录的所有文件都依赖于该目录中的 .d 文件：

```
 obj/%.o: %.c obj/.d
    $(CC) $(CFLAGS) -c -o $@ $< 
```

注意使用 $< 而不是 $^。

最后防止 .d 文件被自动删除：

```
 .PRECIOUS: %/.d 
```

跳过 .d 文件并直接依赖于目录将不起作用，因为每次在该目录中写入文件时都会更新目录修改时间，这将在每次调用 make 时强制重建。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-09-19T03:04:36.760

如果目录已经存在对您来说不是问题，您可以为该命令重定向 stderr，摆脱错误消息：

```
-mkdir $(OBJDIR) 2>/dev/null 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-19T03:07:36.113

在你的makefile里面：

```
target:
    if test -d dir; then echo "hello world!"; else mkdir dir; fi 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2010-07-21T14:39:17.373

在 Windows 上

```
if not exist "$(OBJDIR)" mkdir $(OBJDIR) 
```

在 Unix 上 | Linux

```
if [ ! -d "$(OBJDIR)" ]; then mkdir $(OBJDIR); fi 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-06T19:15:38.743

```
ifeq "$(wildcard $(MY_DIRNAME) )" ""
  -mkdir $(MY_DIRNAME)
endif 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-04T14:47:37.777

```
$(OBJDIR):
    mkdir $@ 
```

这也适用于多个目录，例如。

```
OBJDIRS := $(sort $(dir $(OBJECTS)))

$(OBJDIRS):
    mkdir $@ 
```

添加`$(OBJDIR)`为第一个目标效果很好。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-04-11T06:19:33.643

它在 mingw32/msys/cygwin/linux 下工作

```
ifeq "$(wildcard .dep)" ""
-include $(shell mkdir .dep) $(wildcard .dep/*)
endif 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-30T00:00:04.010

比拉斯的回答简单一点：

```
something_needs_directory_xxx : xxx/.. 
```

和一般规则：

```
%/.. : ;@mkdir -p $(@D) 
```

无需清理或制作 .PRECIOUS 的触摸文件 :-)

如果您想查看另一个通用的小 gmake 技巧，或者如果您对具有最少脚手架的非递归 make 感兴趣，您可能需要查看该博客中的[两个更便宜的 gmake 技巧](https://mischasan.wordpress.com/2012/07/05/two-more-cheap-gmake-tricks-creating-directories-and-printing-variables/)和其他与 make 相关的帖子。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-10T07:12:13.007

如果您显式忽略返回码并转储错误流，那么如果发生错误，您的 make 将忽略该错误：

```
mkdir 2>/dev/null || true 
```

这不应该在平行制造中造成种族危险——但我还没有测试过它来确定。

# search - 你如何让 Vim 不突出你搜索的内容？

> ID：99161
> 
> 赞同：250
> 
> 时间：2008-09-19T03:05:24.980
> 
> 标签：search, vim, highlight

我在文件中搜索“nurple”。我找到了，太好了。但是现在，每次出现的“nurple”都会在黄色上呈现出病态的黑色。永远。

永远，也就是说，直到我搜索我知道不会找到的东西，例如“asdhfalsdflajdflakjdf”，这样它就会清除以前的搜索突出显示。

我不能在搜索完成后按一个魔法键来杀死高光吗？

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2008-09-19T03:08:49.950

`:noh`（缩写`nohighlight`）将暂时清除搜索突出显示。下一次搜索仍将突出显示。

* * *

## 回答 #2

> 赞同：188
> 
> 时间：2008-09-19T03:09:27.730

把它放在你的 .vimrc 中

```
" <Ctrl-l> redraws the screen and removes any search highlighting.
nnoremap <silent> <C-l> :nohl<CR><C-l> 
```

* * *

## 回答 #3

> 赞同：88
> 
> 时间：2008-09-19T03:15:32.163

`/lkjasdf`一直比`:noh`我快。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2013-11-09T14:38:53.890

```
" Make double-<Esc> clear search highlights
nnoremap <silent> <Esc><Esc> <Esc>:nohlsearch<CR><Esc> 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-09-19T06:02:25.570

然后我更喜欢这个：

```
map  <F12> :set hls!<CR>
imap <F12> <ESC>:set hls!<CR>a
vmap <F12> <ESC>:set hls!<CR>gv 
```

为什么？因为它**会切换**开关：如果突出显示处于打开状态，则按下`F12`将其关闭。反之亦然。HTH。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2008-09-19T03:12:19.613

将以下行附加到您的末尾`.vimrc`以完全防止突出显示：

```
set nohlsearch 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-09-19T03:10:44.950

```
            *:noh* *:nohlsearch*
:noh[lsearch] 停止 'hlsearch' 选项的高亮显示。它
            使用搜索时自动重新打开
            命令，或设置 'hlsearch' 选项。
            此命令在自动命令中不起作用，因为
            高亮状态被保存和恢复时
            执行自动命令 |autocmd-searchpat|。
            调用用户函数时也是如此。

```

我在 下找到它`:help #`，我一直在点击它，它突出显示当前页面上的所有单词，就像当前页面一样。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-19T06:59:16.290

我经常搜索，以至于我发现映射下划线键以删除搜索突出显示很有用：

```
nnoremap <silent> _ :nohl<CR> 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-11-08T18:26:04.150

我认为最好的答案是有一个领导者捷径：

```
<leader>c :nohl<CR> 
```

现在，每当您的文档都被突出显示的术语弄得乱七八糟时，您只需点击`,`+ `C`（我将我的领导者映射到逗号）。它完美地工作。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-19T03:12:32.263

有`hlsearch`和`nohlsearch`。 `:help hlsearch`将提供更多信息。

如果您想绑定`F12`以打开/关闭它，您可以使用它：

```
map     <F12>   :nohlsearch<CR>
imap    <F12>   <ESC>:nohlsearch<CR>i
vmap    <F12>   <ESC>:nohlsearch<CR>gv 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-19T13:21:26.660

我的 .vimrc 中有这个：

```
nnoremap ; :set invhlsearch<CR> 
```

这样，`;`将切换搜索突出显示。通常，该`;`键会重复最新的 t/T/f/F 命令，但我从未真正使用过该功能。我发现此设置更有用，因为我可以非常快速地打开和关闭搜索突出显示，并且可以轻松地一目了然地了解我的搜索结果在哪里。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-04-02T09:46:13.030

我认为“ [Vim clear last search highlighting](https://stackoverflow.com/questions/657447/vim-clear-last-search-highlighting/657484#657484) ”中的这个答案更好：

```
:let @/ = "" 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-25T08:59:41.803

此外，如果您想要一个工具并确保下次搜索时重新激活突出显示，您可以使用它

```
nmap <F12> :set hls!<CR>
nnoremap / :set hls<CR>/ 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2014-05-01T21:27:04.633

我将以下映射添加到我的 ~/.vimrc

```
map e/ /sdfdskfxxxxy 
```

在 ESC 模式下，我按`e/`

# java - 使用 for 循环或 while 循环进行迭代？

> ID：99164
> 
> 赞同：42
> 
> 时间：2008-09-19T03:06:18.223
> 
> 标签：java, for-loop, iterator

我经常看到这样的代码：

```
Iterator i = list.iterator();
while(i.hasNext()) {
    ...
} 
```

但我这样写（当 Java 1.5 不可用或每个都不能使用时）：

```
for(Iterator i = list.iterator(); i.hasNext(); ) {
    ...
} 
```

因为

*   它更短
*   它保持`i`在较小的范围内
*   它减少了混淆的机会。（是`i`在while外面用的？在哪里`i`声明的？）

我认为代码应该尽可能简单易懂，这样我只需要编写复杂的代码来完成复杂的事情。你怎么看？哪个更好？

来自：http: [//jamesjava.blogspot.com/2006/04/iterating.html](http://jamesjava.blogspot.com/2006/04/iterating.html)

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-09-19T03:07:42.993

我更喜欢 for 循环，因为它还将迭代器的范围设置为仅 for 循环。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-19T03:20:00.170

while、for 和 foreach 结构有适当的用途：

*   `while`- 如果您正在迭代并且是否循环的决定因素仅基于条件，请使用此选项。在这个循环结构中，保持索引只是次要问题；一切应视情况而定

*   `for`- 如果您正在循环并且您主要关心的是数组/集合/列表的索引，请使用此选项。如果您最有可能以特定顺序遍历*所有*元素（例如，向后遍历排序列表），则使用 for 会更有用。

*   `foreach`- 如果您只需要浏览您的收藏而不考虑顺序，请使用此选项。

显然上述情况也有例外，但这是我在决定使用哪个时使用的一般规则。话虽如此，我倾向于`foreach`更频繁地使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-19T03:09:39.540

为什么不使用 for-each 构造？（我有一段时间没用过 Java，但这存在于 C# 中，我很确定 Java 1.5 也有这个）：

```
List<String> names = new ArrayList<String>();
names.add("a");
names.add("b");
names.add("c");

for (String name : names)
    System.out.println(name.charAt(0)); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T03:13:23.603

正如您所指出的，我认为范围是这里最大的问题。

在“while”示例中，迭代器是在循环外声明的，因此在循环完成后它会继续存在。如果稍后再次使用相同的迭代器，这可能会导致问题。例如。您可能会忘记在另一个循环中使用它之前对其进行初始化。

在“for”示例中，迭代器是在循环内部声明的，因此它的范围仅限于循环。如果您尝试在循环后使用它，您将收到编译器错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T03:08:30.620

如果您只打算使用一次迭代器并将其丢弃，则首选第二种形式；否则你必须使用第一种形式

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-08T18:24:05.600

恕我直言，如果您从英语的角度来看这段代码，那么在这种情况下**for循环的可读性较差。**我正在编写一个作者滥用**for**循环的代码，它并不漂亮。比较以下：

```
for (; (currUserObjectIndex < _domainObjectReferences.Length) && (_domainObjectReferences[currUserObjectIndex].VisualIndex == index); ++currUserObjectIndex)
    ++currNumUserObjects; 
```

对比

```
while (currUserObjectIndex < _domainObjectReferences.Length && _domainObjectReferences[currUserObjectIndex].VisualIndex == index)
{
    ++currNumUserObjects;
    ++currUserObjectIndex;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T03:10:27.933

我同意“for”循环在迭代时更清晰、更合适。

“while”循环适用于轮询，或者满足退出条件的循环数将根据循环内的活动而改变。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T03:30:25.950

这在这种情况下可能并不重要，但是编译器、虚拟机和 CPU 通常具有他们在后台使用的特殊优化技术，这将使 for 循环性能更好（并且在不久的将来并行），通常他们不会这样做while 循环（因为它更难确定它实际上将如何运行）。但在大多数情况下，代码清晰度应该胜过优化。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-06T14:29:17.167

**使用 for 循环，您可以使用单个变量，因为它仅设置当前工作 for 循环的变量范围。但是，这在 while 循环中是不可能的**。例如：
int i; for(i=0; in1;i++) 做某事..

for(i=0;i n2;i+=2) 做一些事情。

所以在第一个循环结束后 i=n1-1 。但是在使用第二个循环时，您可以再次将 i 设置为 0。 **但是**

诠释我=0；

而（我小于限制）{做某事..; 我++；}

因此 i 最后设置为 limit-1。所以你不能在另一个 while 循环中使用相同的 i 。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T03:07:42.773

哪一个都好。我自己用for()，不知道有没有编译问题。我怀疑它们都被优化到几乎相同的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T03:13:47.783

虽然两者都很好，但我倾向于使用第一个示例，因为它更易于阅读。

使用 while() 循环在每一行上发生的操作更少，这使得代码新手更容易理解正在发生的事情。

这种类型的构造还允许我将初始化分组到一个公共位置（在方法的顶部），这也简化了我的评论，以及第一次阅读它的人的概念化。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T03:15:47.123

我同意应该尽可能使用 for 循环，但有时会有更复杂的逻辑来控制循环体中的迭代器。在这种情况下，您必须使用 while。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T03:24:37.057

为了清楚起见，我是 for 循环。当我遇到一些不确定的情况时，我使用*while 循环。*

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T11:51:03.677

两者都很好，但请记住，有时直接访问 Iterator 很有用（例如，如果您要删除符合特定条件的元素 - 如果您在 for(T o 中执行 collection.remove(o) 操作，则会收到 ConcurrentModificationException ：集合）循环）。

我几乎总是更喜欢编写 for(blah : blah) [foreach] 语法，因为它对我来说似乎更自然易读。一般来说，迭代器的概念在编程之外并没有真正的相似之处

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T12:02:35.430

学术界倾向于使用 while 循环，因为它可以减少对程序的复杂推理。我更喜欢 for 或 foreach 循环结构，因为它们使代码更易于阅读。

# user-interface - 是否应该按首字母选择尽可能多地以该字母开头？

> ID：99187
> 
> 赞同：4
> 
> 时间：2008-09-19T03:09:32.130
> 
> 标签：user-interface

当我在列表中并按下一个字母以跳转到以该字母开头的第一个条目时，为什么它会将该条目留在可见条目的底部？它应该使条目成为可见的顶部条目，以便可以看到许多以该字母开头的条目。

更具体地说，如果我从下拉列表中选择一个州并按“w”，它应该使“华盛顿”在顶部而不是底部可见，这样我就可以在不滚动的情况下看到威斯康星州。

同意？是否有充分的理由保持目前的方式？

来自：http: [//jamesjava.blogspot.com/2005/05/gui-designers-take-note-selecting-by.html](http://jamesjava.blogspot.com/2005/05/gui-designers-take-note-selecting-by.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T03:43:35.327

以您按下的字母开头的第一个选项位于所看到的字母*中间*怎么样？

为了扩展您的示例，如果您在 State 下拉菜单中按“N”，您看到的选项可能是：

*   密苏里州
*   蒙大拿
*   内布拉斯加州 <-- 第一个“N”选项
*   内华达州
*   新罕布什尔

现在，您不仅可以看到之后发生的事情，还可以看到您选择之前发生的事情。这使您可以找到以您的选择开头的前几个选项*和*以您选择之前的字母开头的最后几个选项。

如果按“O”，则查找以“N”开头但接近“Ns”结尾的州（如“北卡罗来纳州”）会更快，因为它更接近“俄亥俄州”而不是“内布拉斯加州”：

*   北卡罗来纳
*   北达科他州
*   俄亥俄州 <-- 第一个“O”选项
*   俄克拉荷马州
*   俄勒冈

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T03:11:29.240

我同意。特别是如果您必须继续点击该字母才能进入下一个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T03:13:46.253

我认为这可能只是 Windows 处理更改默认组合框控件的选定索引的默认方式。它只会向下滚动以显示所选项目，它不关心之前或之后的内容。

# ruby-on-rails - 如何让 Haml 与 Rails 一起工作？

> ID：99211
> 
> 赞同：77
> 
> 时间：2008-09-19T03:12:47.537
> 
> 标签：ruby-on-rails, ruby, netbeans, haml

我正在尝试让 Haml 与我的 Ruby on Rails 项目一起工作。我是 Ruby on Rails 的新手，我真的很喜欢它。但是，当我尝试为视图添加`aplication.html.haml`或`index.html.haml`时，我只会收到错误消息。

我使用 NetBeans 作为我的 IDE。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2010-05-22T12:22:33.880

## 带有 Rails 3 的 Haml

对于 Rails 3，您需要做的就是添加`gem "haml", '3.0.25'`到您的`Gemfile`. 无需安装插件或运行`haml --rails .`.

只是：

```
$ cd awesome-rails-3-app.git
$ echo 'gem "haml"' >> Gemfile

```

你完成了。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2011-02-17T21:15:44.603

上面的答案很到位。你只需要把`gem 'haml'`你的`Gemfile`.

另一个未提及的提示：要使用 rails 生成器`haml`而不是`erb`，请将以下内容添加到`config/application.rb`：

```
config.generators do |g|
  g.template_engine :haml

  # you can also specify a different test framework or ORM here
  # g.test_framework  :rspec
  # g.orm             :mongoid
end 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-09-19T20:54:02.670

首先，**将haml安装**为捆绑器中的gem，方法是将其添加到您的`Gemfile`：

```
gem "haml" 
```

运行`bundle install`，然后确保您的视图以***.html.haml**扩展名命名。例如：

```
`-- app
    `-- views
        |-- layouts
        |   `-- application.html.haml
        `-- users
            |-- edit.html.haml
            |-- index.html.haml
            |-- new.html.haml
            `-- show.html.haml 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-05-08T17:55:45.890

将 haml 添加到您的 Gemfile 中：

```
gem "haml" 
```

如果您也想使用脚手架功能，请在您的开发组中添加 haml-rails：

```
gem 'haml-rails', :group => :development 
```

不要忘记运行：

```
$ bundle install 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-04-21T18:44:50.537

在您的 rails 应用程序中尝试使用 haml 之前，您可以验证命令行可执行文件是否已正确安装：

```
$ haml
%p 
  %span Hello World! 
```

然后按 CTRL-D 你应该看到：

```
<p>
  <span>Hello World!</span>
</p> 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-09-20T00:23:45.507

首先，确保您拥有 HAML gem。

```
gem list --local | grep haml 
```

如果 haml 没有出现在列表中，请执行以下操作：

```
sudo gem install haml 
```

然后从您的项目目录执行此操作：

```
# cd ../
# haml --rails <yourproject> 
```

这应该会安装您需要的一切，并且 HAML 视图应该停止抱怨并正确解析。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-05T09:50:42.780

这可能是一个老问题，但我认为答案是在[https://github.com/indirect/haml-rails使用 haml-rails](https://github.com/indirect/haml-rails)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-22T21:16:30.920

如果由于某种原因您安装了haml，但您的haml 没有启动。尝试

```
sudo ln haml /usr/bin/ 
```

在你的 haml gem 的 bin 目录中

由于某种原因，这并没有在我的 ubuntu 9.04 Jaunty 上自动发生。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-09T03:53:48.493

如果您正在使用[Pow](http://pow.cx/)，您还需要重新启动它。理想情况下，您使用的是[粉末](http://rubygems.org/gems/powder)（gem install powder），因为这样您就可以在终端上运行它

```
$ powder restart 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-09T14:13:54.730

确保将`haml`gem 添加到您的`Gemfile`

# iphone - 使用 UIWebView 时，有什么方法可以从 Objective-C 访问 DOM？

> ID：99241
> 
> 赞同：6
> 
> 时间：2008-09-19T03:18:32.437
> 
> 标签：iphone, objective-c

UIWebView 可以很好地显示 HTML，但我想从我的 Objective-C 程序中修改加载的 DOM。有人知道该怎么做吗？这是一个第三方页面，所以我不能真正包含任何自定义 JS 来这样做......除非我可以以某种方式修改 DOM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T12:49:15.287

这可能会有所帮助，以免在链接中抄袭解决方案提供商，这是链接： http: [//lists.apple.com/archives/safari-iphone-web-dev/2008/Sep/msg00001.html](http://lists.apple.com/archives/safari-iphone-web-dev/2008/Sep/msg00001.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T23:55:15.293

一些围绕 Obj-C / JS 通信的更多相关技术：

使用 UIWebView 获取本地资源：

[http://dominiek.com/articles/2008/7/19/iphone-app-development-for-web-hackers](http://dominiek.com/articles/2008/7/19/iphone-app-development-for-web-hackers)

iPhone 版谷歌地图 API：

[http://code.google.com/p/iphone-google-maps-component/](http://code.google.com/p/iphone-google-maps-component/)

Obj-C 和 Javascript 之间的双向调用：

[http://tetontech.wordpress.com/2008/08/14/calling-objective-c-from-javascript-in-an-iphone-uiwebview/](http://tetontech.wordpress.com/2008/08/14/calling-objective-c-from-javascript-in-an-iphone-uiwebview/)

# java - RMI 服务器：rmiregistry 或 LocateRegistry.createRegistry

> ID：99242
> 
> 赞同：14
> 
> 时间：2008-09-19T03:19:11.327
> 
> 标签：java, rmi, rmiregistry

对于服务器端的 RMI，我们需要启动`rmiregistry`程序，还是只调用`LocateRegistry.createRegistry`？如果两者都可以，有什么优点和缺点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T03:27:58.297

它们是同一件事......`rmiregistry`是一个单独的程序，您可以从命令行或脚本运行它，同时`LocateRegistry.createRegistry`以编程方式执行相同的操作。

根据我的经验，对于“真正的”服务器，您将希望使用`rmiregistry`它，以便您知道它始终在运行，无论客户端应用程序是否启动。`createRegistry`对于测试非常有用，因为您可以根据需要在测试中启动和停止注册表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-12T09:43:27.587

如果我们先启动 rmiregistry，RmiServiceExporter 会将自己注册到正在运行的 rmiregistry。在这种情况下，我们必须将系统属性“java.rmi.server.codebase”设置为可以找到“org.springframework.remoting.rmi.RmiInvocationWrapper_Stub”类的位置。否则，RmiServiceExporter 将不会启动并得到异常“ ClassNotFoundException class not found: org.springframework.remoting.rmi.RmiInvocationWrapper_Stub; nested exception is: ...”

如果您的 rmi 服务器、rmi 客户端和 rmiregistry 可以访问同一个文件系统，您可能希望系统属性自动配置为可以在共享文件系统上找到 spring.jar 的位置。以下实用程序类和弹簧配置显示了如何实现这一点。

```
abstract public class CodeBaseResolver { 
  static public String resolveCodeBaseForClass(Class<?> clazz) {
    Assert.notNull(clazz);
    final CodeSource codeSource = clazz.getProtectionDomain().getCodeSource();
    if (codeSource != null) {
      return codeSource.getLocation().toString();
    } else {
      return "";
    }
  }
}

public class SystemPropertyConfigurer {
  private Map<String, String> systemProperties;
  public void setSystemProperties(Map<String, String> systemProperties) {
    this.systemProperties = systemProperties;
  }

  @PostConstruct
  void init() throws BeansException {
    if (systemProperties == null || systemProperties.isEmpty()) {
      return;
    }
    for (Map.Entry<String, String> entry : systemProperties.entrySet()) {
      final String key = entry.getKey();
      final String value = SystemPropertyUtils.resolvePlaceholders(entry.getValue());
      System.setProperty(key, value);
    }
  }
}

<bean id="springCodeBase" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
  <property name="staticMethod" value="xx.CodeBaseResolver.resolveCodeBaseForClass" />
  <property name="arguments">
    <list>
      <value>org.springframework.remoting.rmi.RmiInvocationWrapper_Stub</value>
    </list>
  </property>
</bean>

<bean id="springCodeBaseConfigurer" class="xx.SystemPropertyConfigurer"
  depends-on="springCodeBase">
  <property name="systemProperties">
    <map>
      <entry key="java.rmi.server.codebase" value-ref="springCodeBase" />
    </map>
  </property>
</bean>

<bean id="rmiServiceExporter" class="org.springframework.remoting.rmi.RmiServiceExporter" depends-on="springCodeBaseConfigurer">
  <property name="serviceName" value="XXX" />
  <property name="service" ref="XXX" />
  <property name="serviceInterface" value="XXX" />
  <property name="registryPort" value="${remote.rmi.port}" />
</bean> 
```

The above example shows how system property be set automatically only when rmi server, rmi client and rmi registry can access the same filesystem. If that is not true or spring codebase is shared via other method (e.g. HTTP), you may modify the CodeBaseResolver to fit your need.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T03:53:39.123

如果您正在编写一个独立的 java 应用程序，您会想要启动自己的 rmiregistry，但是如果您正在编写一个显然在 J2EE 容器内运行的 J2EE 应用程序，那么您想要“LocateRegistry”，因为已经有一个在应用程序服务器上运行！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-20T03:57:16.117

如果您使用 Spring 导出您的 RMI 服务，它会自动启动一个注册表（如果尚未运行）。请参阅[RmiServiceExporter](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/remoting/rmi/RmiServiceExporter.html)

# visual-studio - 需要使用 Visual Studio Professional 而不是 Standard 的最常见功能是什么？

> ID：99262
> 
> 赞同：3
> 
> 时间：2008-09-19T03:22:51.163
> 
> 标签：visual-studio, visual-studio-2008

恐怕我对 VS 2008 的试用版很快就要用完了，除非客户为此付费，否则我可能会为此掏出一些现金。我一直在查看[比较表](http://msdn.microsoft.com/en-us/vs2008/products/cc149003.aspx)来比较 VS Professional 和 Standard，到目前为止我认为我是安全的。我想听听您关于我将缺少哪些最重要的功能。

当然，你不知道我的情况的所有细节 - 但请根据你认为最重要的内容来回答。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T03:24:57.693

开发 Windows Mobile 应用程序和数据库项目的可用性对我来说是最重要的（这适用于 Visual Studio 2008）。

就是这样。不过这对我来说是个大问题，因为我想参加这个移动应用程序编程竞赛，但当我发现我无法使用 Standard 时感到很沮丧。

否则，您可以使用标准版。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T03:36:13.160

Express Edition 的主要缺点是它们不支持插件 - 因此您必须确保您的源代码管理软件有一个独立的客户端。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T03:27:44.957

远程调试、服务器资源管理器、紧凑型开发（使用设备模拟器）。这确实取决于您的情况，但我认为您一般不会没有桨。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T04:22:34.840

“附加到远程进程”是必须的。它允许您在运行不同 Windows 版本的多个虚拟（或物理）机器上调试您的应用程序，而无需在每台此类机器上安装 Visual Studio：您可以在主开发计算机上运行 Visual Studio，并将其附加到在另一台计算机上运行的应用程序实例机器，并以这种方式调试它。这是我调试应用程序的唯一方法，我从不在开发计算机上调试它们。HTH。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T03:25:38.490

两者差别很小。我唯一能想到的是远程调试在标准中不可用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T03:29:37.807

您可能想查看 VS 2008 Express 版本。安装它们，看看您是否可以完成使用 Express 版本所需的一切。您需要/使用的大多数东西都在 Express 版本中，而且它们是免费的。此外，您可以根据需要将它们用于商业用途。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T03:40:19.793

对我来说，“标准”中的 OMP 支持是很高兴的，如果你喜欢的话

# c# - C# COM 办公自动化 - RPC_E_SYS_CALL_FAILED

> ID：99271
> 
> 赞同：5
> 
> 时间：2008-09-19T03:24:15.030
> 
> 标签：c#, com, ms-office

我正在编写一个充当 PowerPoint 2007 插件的 C# 程序。在某些机器上，对 PowerPoint 对象模型的某些调用会抛出`COMException`带有消息的`RPC_E_SYS_CALL_FAILED`。我找不到任何关于如何处理此错误或如何避免它的具体建议。从谷歌搜索来看，它看起来与消息队列或单线程公寓有关。还是我走远了？

错误消息的示例是：

> 系统调用失败。（来自 HRESULT 的异常：0x80010100 (RPC_E_SYS_CALL_FAILED)）
> 在 Microsoft.Office.Interop.PowerPoint._Presentation.get_FullName()

不幸的是，问题发生在客户端的机器上，所以我没有简单的方法来调试它！每当我收到此错误时，我是否应该重试呼叫？

任何帮助我解决这个问题的建议将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-26T21:48:11.380

我不知道这与您的问题有关，但您的所有 COM 调用必须来自创建加载项的同一线程。如果您创建了新线程，则必须特别小心。这两篇文章中有详细描述：

*   [在 Office 加载项中实现 IMessageFilter](http://blogs.msdn.com/andreww/archive/2008/11/19/implementing-imessagefilter-in-an-office-add-in.aspx)和
*   [为什么你的 COMAddIn.Object 应该从 StandardOleMarshalObject 派生](http://blogs.msdn.com/andreww/archive/2008/08/11/why-your-comaddin-object-should-derive-from-standardolemarshalobject.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T04:22:47.133

您是从设置了 ApartmentState 的线程进行调用吗？如果不是，那可能是罪魁祸首 - COM 互操作对这类事情非常挑剔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T18:16:01.917

客户端的安全设置是什么？客户端的安全设置（Windows/OS 设置或 PowerPoint/App 设置）很可能不允许您的插件通过 RPC 进行通信。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T22:26:25.670

如果您从后台线程对 Powerpoint 对象模型进行任何调用，这很容易发生。一种可能的情况是有一个计时器定期检查某种状态值。如果在计时器触发时，Powerpoint 正忙（例如打开了一个对话框），则呼叫将失败。

这篇 Microsoft 文章概述了 Office 中的线程支持：http: [//msdn.microsoft.com/en-us/library/8sesy69e.aspx](http://msdn.microsoft.com/en-us/library/8sesy69e.aspx)

# html - 您如何解析网页并提取所有 href 链接？

> ID：99279
> 
> 赞同：15
> 
> 时间：2008-09-19T03:26:35.960
> 
> 标签：html, parsing, groovy

我想在 Groovy 中解析一个网页并提取所有的 href 链接和相关的文本。

如果页面包含这些链接：

```
<a href="http://www.google.com">Google</a><br />
<a href="http://www.apple.com">Apple</a> 
```

输出将是：

```
Google, http://www.google.com<br />
Apple, http://www.apple.com 
```

我正在寻找一个 Groovy 的答案。又名。最简单的方法！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-02T18:18:55.827

假设 XHTML 格式正确，读取 xml，收集所有标签，找到“a”标签，然后打印出 href 和文本。

```
input = """<html><body>
<a href = "http://www.hjsoft.com/">John</a>
<a href = "http://www.google.com/">Google</a>
<a href = "http://www.stackoverflow.com/">StackOverflow</a>
</body></html>"""

doc = new XmlSlurper().parseText(input)
doc.depthFirst().collect { it }.findAll { it.name() == "a" }.each {
    println "${it.text()}, ${it.@href.text()}"
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T03:28:55.173

一个快速的谷歌搜索出现了一个漂亮的可能性，[TagSoup](http://blog.foosion.org/2008/06/09/parse-html-the-groovy-way/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T07:14:56.270

我不知道 java，但我认为 xpath 比经典正则表达式要好得多，以便获得一个（或多个）html 元素。

它也更容易书写和阅读。

```
<html>
   <body>
      <a href="1.html">1</a>
      <a href="2.html">2</a>
      <a href="3.html">3</a>
   </body>
</html> 
```

对于上面的 html，这个表达式“/html/body/a”将列出所有的 href 元素。

这是一个很好的分步教程[http://www.zvon.org/xxl/XPathTutorial/General/examples.html](http://www.zvon.org/xxl/XPathTutorial/General/examples.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T03:52:34.633

使用 XMLSlurper 将 HTML 解析为 XML 文档，然后使用带有适当闭包的 find 方法选择 a 标签，然后使用 GPathResult 上的 list 方法获取标签列表。然后，您应该能够将文本提取为 GPathResult 的子项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T03:41:42.677

尝试正则表达式。像这样的东西应该工作：

```
(html =~ /<a.*href='(.*?)'.*>(.*?)<\/a>/).each { url, text -> 
    // do something with url and text
} 
```

看看[Groovy - Tutorial 4 - Regular expressions basics](http://groovy.codehaus.org/Tutorial+4+-+Regular+expressions+basics)和[Anchor Tag Regular Expression Breaking](http://weblogs.asp.net/scottcate/archive/2004/12/13/281955.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T07:39:28.870

仅当 HTMl 格式正确时，使用 XMlSlurper 进行解析才有效。

如果您的 HTMl 页面包含格式不正确的标签，请使用正则表达式来解析页面。

前任：`<a href="www.google.com">`

在这里，“a”不是封闭的，因此格式不正确。

```
 new URL(url).eachLine{
   (it =~ /.*<A HREF="(.*?)">/).each{
       // process hrefs
   }
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-02T18:34:04.213

Html 解析器 + 正则表达式 任何语言都可以，尽管我认为 Perl 是最快的解决方案。

# java - 向堆栈跟踪添加额外信息是否有用？

> ID：99285
> 
> 赞同：1
> 
> 时间：2008-09-19T03:27:47.970
> 
> 标签：java, language-agnostic

能够标记对象的值 ofString.valueOf() 将包含在任何堆栈跟踪中是否有用。在下面的示例中，我使用了“跟踪”。未在堆栈跟踪点声明的变量将被导入。这将使调试变得更加容易，并且使编写易于调试的程序变得更加容易。

以下代码的示例堆栈跟踪：

```
java.lang.NullPointerException:
    at Test.main(Test.java:7) index=0, sum=3, obj=null

public class Test {
  Object obj;
  public void main(String[] args) trace obj {
    trace int sum = 0;
    for(trace int index = 0; index < args.length; index++) {
      sum += Integer.parseInt(args[index]);
      sum += obj.hashCode();//Will cause NullPointerException
    }
  }
} 
```

来自：http: [//jamesjava.blogspot.com/2005/04/extra-info-in-stack-traces.html](http://jamesjava.blogspot.com/2005/04/extra-info-in-stack-traces.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T19:04:07.163

很诱人，但我不认为这个特性需要在 Java 中使用新的关键字（并且该语言的复杂性要高得多）。

我发现 Throwable.printStackTrace 的使用通常足以快速指出需要我注意的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T03:45:56.723

这可能很有用，但我认为它会使代码混乱 - 大概当代码工作时，您会想要删除“跟踪”关键字；也许某种形式的元数据会更合适

然后总是有打印语句...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T08:23:07.537

也许我没有抓住重点，但为什么不使用合适的日志框架（例如 Log4j）呢？然后，您可以使用嵌套/映射的诊断上下文（[NDC](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/NDC.html) / [MDC](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/MDC.html)）来输出变量值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-22T08:38:00.427

我更喜欢一种标准的（基于注释的）方式来描述程序员的空值意图（FindBugs，JSR 305）。我曾经考虑过不仅有行号，还有列号包含在异常消息中，因此在长链调用中，您可以更容易地看到哪个点运算符导致了 NPE。正如其他人在 StackOverflow 上的 NPE 相关问题中所述，在大多数情况下，您会通过尝试访问空对象上的字段/方法来获得 NPE。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T13:51:26.900

Eh. Personally I don't think it would be that useful. If I'm running my code and hitting exceptions I can more easily set a breakpoint and step into the code and see what all of the variables are at that point and figure out where it's really breaking.

Using this trace method not only would I have to keep adding and removing keywords from in front of variables as I worked on different bugs but I don't think that it would be any real improvement over just adding good logging/debugging messaging (which is much easier to remove or disable when pushed to production).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T03:48:27.467

是的，它可能非常有用。我自己经常做这种事情，但我通常只把它编译成非生产代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T03:52:30.327

我喜欢的是异常的一个属性，它将是导致抛出的所有方法签名的字符串数组......而不必从异常文本中解析它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T04:02:29.867

Visual Studio C# 调试器的调用堆栈窗口包括一个堆栈跟踪，其中显示了所有参数值。

# c++ - 虚函数和vtable是如何实现的？

> ID：99297
> 
> 赞同：125
> 
> 时间：2008-09-19T03:29:44.873
> 
> 标签：c++, polymorphism, virtual-functions, vtable

我们都知道 C++ 中的虚函数是什么，但是它们是如何在深层次上实现的呢？

可以在运行时修改甚至直接访问 vtable 吗？

vtable 是否存在于所有类，还是只存在于至少具有一个虚函数的类？

抽象类是否只是为至少一个条目的函数指针设置了一个 NULL 值？

拥有一个虚函数会减慢整个班级的速度吗？还是只调用虚拟函数？如果虚拟功能实际上是否被覆盖，速度是否会受到影响，或者只要它是虚拟的就没有影响。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2008-09-19T03:36:24.610

## 虚函数是如何深层次实现的？

来自[“C++ 中的虚拟函数”](http://wayback.archive.org/web/20100209040010/http://www.codersource.net/published/view/325/virtual_functions_in.aspx)：

> 每当程序声明了虚函数时，都会为该类构造 av - table。v-table 由包含一个或多个虚函数的类的虚函数地址组成。包含虚函数的类的对象包含一个虚指针，它指向内存中虚表的基地址。每当有虚函数调用时，都会使用 v-table 解析到函数地址。包含一个或多个虚拟函数的类的对象在内存中对象的最开始包含一个称为 vptr 的虚拟指针。因此，在这种情况下，对象的大小会增加指针的大小。这个 vptr 包含内存中虚拟表的基地址。请注意，虚拟表是特定于类的，即 一个类只有一个虚表，与它包含的虚函数数量无关。该虚拟表又包含该类的一个或多个虚拟函数的基地址。在对象上调用虚函数时，该对象的 vptr 提供了该类在内存中的虚拟表的基地址。该表用于解析函数调用，因为它包含该类的所有虚函数的地址。这就是在虚函数调用期间解决动态绑定的方式。该对象的 vptr 提供了该类在内存中的虚拟表的基地址。该表用于解析函数调用，因为它包含该类的所有虚函数的地址。这就是在虚函数调用期间解决动态绑定的方式。该对象的 vptr 提供了该类在内存中的虚拟表的基地址。该表用于解析函数调用，因为它包含该类的所有虚函数的地址。这就是在虚函数调用期间解决动态绑定的方式。

## 可以在运行时修改甚至直接访问 vtable 吗？

总的来说，我相信答案是“不”。你可以做一些内存修改来找到 vtable，但你仍然不知道函数签名是什么样子的。您想通过这种能力（语言支持）实现的任何事情都应该可以在不直接访问 vtable 或在运行时修改它的情况下实现。另请注意，C++ 语言规范**没有**指定 vtable 是必需的 - 但是大多数编译器都是这样实现虚函数的。

## vtable 是否存在于所有对象，或者仅存在于具有至少一个虚拟功能的对象？

我*相信*这里的答案是“它取决于实现”，因为规范首先不需要 vtables。然而，在实践中，我相信所有现代编译器只有在一个类至少有 1 个虚函数时才会创建一个 vtable。存在与 vtable 相关的空间开销和与调用虚拟函数与非虚拟函数相关的时间开销。

## 抽象类是否只是为至少一个条目的函数指针设置了一个 NULL 值？

答案是语言规范未指定它，因此它取决于实现。如果未定义（通常未定义），则调用纯虚函数会导致未定义的行为（ISO/IEC 14882:2003 10.4-2）。实际上，它确实在 vtable 中为函数分配了一个槽，但没有为其分配地址。这使得 vtable 不完整，需要派生类来实现功能并完成 vtable。一些实现只是在 vtable 条目中放置一个 NULL 指针；其他实现会放置一个指向虚拟方法的指针，该方法执行类似于断言的操作。

请注意，抽象类可以定义纯虚函数的实现，但该函数只能使用限定 ID 语法调用（即，在方法名称中完全指定类，类似于从派生类）。这样做是为了提供易于使用的默认实现，同时仍需要派生类提供覆盖。

## 拥有一个虚拟函数会减慢整个类的速度还是只减慢对虚拟函数的调用？

这是我知识的边缘，所以如果我错了，请有人在这里帮助我！

我*相信*只有类中的虚拟函数才会经历与调用虚拟函数与非虚拟函数相关的时间性能损失。无论哪种方式，课程的空间开销都是存在的。请注意，如果有 vtable，则每个*class*只有 1 个，而不是每个*object*一个。

## 如果虚拟功能实际上是否被覆盖，速度是否会受到影响，或者只要它是虚拟的就没有影响？

与调用基本虚函数相比，我不相信被覆盖的虚函数的执行时间会减少。但是，与为派生类和基类定义另一个 vtable 相关联的类有额外的空间开销。

## 其他资源：

[http://www.codersource.net/published/view/325/virtual_functions_in.aspx](http://wayback.archive.org/web/20100209040010/http://www.codersource.net/published/view/325/virtual_functions_in.aspx)（通过回程机器）
[http://en.wikipedia.org/wiki/Virtual_table](http://en.wikipedia.org/wiki/Virtual_table)
[http://www.codesourcery.com/public/ cxx-abi/abi.html#vtable](http://www.codesourcery.com/public/cxx-abi/abi.html#vtable)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-19T13:39:41.653

*   可以在运行时修改甚至直接访问 vtable 吗？

不是便携式的，但如果你不介意肮脏的把戏，当然！

> **警告**：不建议儿童、[969](https://en.wikipedia.org/wiki/Methuselah)岁以下的成年人或来自 Alpha Centauri 的毛茸茸的小动物使用此技术。副作用可能包括[从你的鼻子飞出的恶魔，](http://www.catb.org/jargon/html/N/nasal-demons.html)突然出现[Yog-Sothoth](https://en.wikipedia.org/wiki/Yog-Sothoth)作为所有后续代码审查所需的批准者，或追溯添加[`IHuman::PlayPiano()`](http://unsongbook.com/interlude-%D7%90-the-cracks-in-the-sky/)到所有现有实例]

在我见过的大多数编译器中，vtbl * 是对象的前 4 个字节，而 vtbl 内容只是那里的成员指针数组（通常按照声明它们的顺序，基类的第一个）。当然还有其他可能的布局，但这是我通常观察到的。

```
class A {
  public:
  virtual int f1() = 0;
};
class B : public A {
  public:
  virtual int f1() { return 1; }
  virtual int f2() { return 2; }
};
class C : public A {
  public:
  virtual int f1() { return -1; }
  virtual int f2() { return -2; }
};

A *x = new B;
A *y = new C;
A *z = new C; 
```

现在拉一些恶作剧......

在运行时更改类：

```
std::swap(*(void **)x, *(void **)y);
// Now x is a C, and y is a B! Hope they used the same layout of members! 
```

替换所有实例的方法（monkeypatching 一个类）

这有点棘手，因为 vtbl 本身可能在只读存储器中。

```
int f3(A*) { return 0; }

mprotect(*(void **)x,8,PROT_READ|PROT_WRITE|PROT_EXEC);
// Or VirtualProtect on win32; this part's very OS-specific
(*(int (***)(A *)x)[0] = f3;
// Now C::f1() returns 0 (remember we made x into a C above)
// so x->f1() and z->f1() both return 0 
```

由于 mprotect 操作，后者很可能使病毒检查程序和链接唤醒并引起注意。在使用 NX 位的过程中，它很可能会失败。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-04-09T18:51:04.160

## 拥有一个虚函数会减慢整个班级的速度吗？

> 还是只调用虚拟函数？如果虚拟功能实际上是否被覆盖，速度是否会受到影响，或者只要它是虚拟的就没有影响。

拥有虚函数会减慢整个类的速度，因为在处理此类的对象时，必须再初始化、复制一项数据……。对于一个有六个左右成员的班级，差异应该可以忽略不计。对于只包含单个`char`成员或根本不包含成员的类，差异可能很明显。

除此之外，重要的是要注意并非每次对虚函数的调用都是虚函数调用。如果您有一个已知类型的对象，编译器可以为正常的函数调用发出代码，甚至可以内联所述函数，如果它感觉喜欢的话。只有当您通过可能指向基类对象或某些派生类对象的指针或引用进行多态调用时，您才需要 vtable 间接并在性能方面为其付费。

```
struct Foo { virtual ~Foo(); virtual int a() { return 1; } };
struct Bar: public Foo { int a() { return 2; } };
void f(Foo& arg) {
  Foo x; x.a(); // non-virtual: always calls Foo::a()
  Bar y; y.a(); // non-virtual: always calls Bar::a()
  arg.a();      // virtual: must dispatch via vtable
  Foo z = arg;  // copy constructor Foo::Foo(const Foo&) will convert to Foo
  z.a();        // non-virtual Foo::a, since z is a Foo, even if arg was not
} 
```

无论功能是否被覆盖，硬件必须采取的步骤基本相同。从对象中读取 vtable 的地址，从相应的槽中检索函数指针，并通过指针调用函数。就实际性能而言，分支预测可能会产生一些影响。因此，例如，如果您的大多数对象引用给定虚拟函数的相同实现，那么分支预测器就有可能在检索到指针之前正确预测要调用哪个函数。但是哪个函数是通用函数并不重要：它可能是委托给非覆盖基本情况的大多数对象，或者是属于同一子类并因此委托给相同覆盖情况的大多数对象。

## 它们是如何在深层次上实施的？

我喜欢 jheriko 使用模拟实现来证明这一点的想法。但是我会使用 C 来实现类似于上面的代码的东西，以便更容易看到低级别。

### 父类 Foo

```
typedef struct Foo_t Foo;   // forward declaration
struct slotsFoo {           // list all virtual functions of Foo
  const void *parentVtable; // (single) inheritance
  void (*destructor)(Foo*); // virtual destructor Foo::~Foo
  int (*a)(Foo*);           // virtual function Foo::a
};
struct Foo_t {                      // class Foo
  const struct slotsFoo* vtable;    // each instance points to vtable
};
void destructFoo(Foo* self) { }     // Foo::~Foo
int aFoo(Foo* self) { return 1; }   // Foo::a()
const struct slotsFoo vtableFoo = { // only one constant table
  0,                                // no parent class
  destructFoo,
  aFoo
};
void constructFoo(Foo* self) {      // Foo::Foo()
  self->vtable = &vtableFoo;        // object points to class vtable
}
void copyConstructFoo(Foo* self,
                      Foo* other) { // Foo::Foo(const Foo&)
  self->vtable = &vtableFoo;        // don't copy from other!
} 
```

### 派生类 Bar

```
typedef struct Bar_t {              // class Bar
  Foo base;                         // inherit all members of Foo
} Bar;
void destructBar(Bar* self) { }     // Bar::~Bar
int aBar(Bar* self) { return 2; }   // Bar::a()
const struct slotsFoo vtableBar = { // one more constant table
  &vtableFoo,                       // can dynamic_cast to Foo
  (void(*)(Foo*)) destructBar,      // must cast type to avoid errors
  (int(*)(Foo*)) aBar
};
void constructBar(Bar* self) {      // Bar::Bar()
  self->base.vtable = &vtableBar;   // point to Bar vtable
} 
```

### 函数 f 执行虚函数调用

```
void f(Foo* arg) {                  // same functionality as above
  Foo x; constructFoo(&x); aFoo(&x);
  Bar y; constructBar(&y); aBar(&y);
  arg->vtable->a(arg);              // virtual function call
  Foo z; copyConstructFoo(&z, arg);
  aFoo(&z);
  destructFoo(&z);
  destructBar(&y);
  destructFoo(&x);
} 
```

所以你可以看到，一个vtable只是内存中的一个静态块，主要包含函数指针。多态类的每个对象都将指向对应于其动态类型的 vtable。这也使得 RTTI 和虚函数之间的联系更加清晰：你可以通过查看它指向的 vtable 来检查一个类是什么类型。上面的内容在很多方面都得到了简化，例如多重继承，但总体概念是合理的。

如果`arg`是类型`Foo*`和你取`arg->vtable`的，但实际上是类型的对象`Bar`，那么你仍然得到正确的地址`vtable`。这是因为`vtable`始终是对象地址的第一个元素，无论它是被调用`vtable`还是`base.vtable`在正确类型的表达式中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T03:31:21.110

通常带有一个 VTable，一个指向函数的指针数组。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-07-26T14:50:33.940

这是现代 C++ 中虚拟表的**可运行**手动实现。它具有明确定义的语义，没有 hack 并且没有`void*`.

注意：`.*`and是与and`->*`不同的运算符。成员函数指针的工作方式不同。`*``->`

```
#include <iostream>
#include <vector>
#include <memory>

struct vtable; // forward declare, we need just name

class animal
{
public:
    const std::string& get_name() const { return name; }

    // these will be abstract
    bool has_tail() const;
    bool has_wings() const;
    void sound() const;

protected: // we do not want animals to be created directly
    animal(const vtable* vtable_ptr, std::string name)
    : vtable_ptr(vtable_ptr), name(std::move(name)) { }

private:
    friend vtable; // just in case for non-public methods

    const vtable* const vtable_ptr;
    std::string name;
};

class cat : public animal
{
public:
    cat(std::string name);

    // functions to bind dynamically
    bool has_tail() const { return true; }
    bool has_wings() const { return false; }
    void sound() const
    {
        std::cout << get_name() << " does meow\n"; 
    }
};

class dog : public animal
{
public:
    dog(std::string name);

    // functions to bind dynamically
    bool has_tail() const { return true; }
    bool has_wings() const { return false; }
    void sound() const
    {
        std::cout << get_name() << " does whoof\n"; 
    }
};

class parrot : public animal
{
public:
    parrot(std::string name);

    // functions to bind dynamically
    bool has_tail() const { return false; }
    bool has_wings() const { return true; }
    void sound() const
    {
        std::cout << get_name() << " does crrra\n"; 
    }
};

// now the magic - pointers to member functions!
struct vtable
{
    bool (animal::* const has_tail)() const;
    bool (animal::* const has_wings)() const;
    void (animal::* const sound)() const;

    // constructor
    vtable (
        bool (animal::* const has_tail)() const,
        bool (animal::* const has_wings)() const,
        void (animal::* const sound)() const
    ) : has_tail(has_tail), has_wings(has_wings), sound(sound) { }
};

// global vtable objects
const vtable vtable_cat(
    static_cast<bool (animal::*)() const>(&cat::has_tail),
    static_cast<bool (animal::*)() const>(&cat::has_wings),
    static_cast<void (animal::*)() const>(&cat::sound));
const vtable vtable_dog(
    static_cast<bool (animal::*)() const>(&dog::has_tail),
    static_cast<bool (animal::*)() const>(&dog::has_wings),
    static_cast<void (animal::*)() const>(&dog::sound));
const vtable vtable_parrot(
    static_cast<bool (animal::*)() const>(&parrot::has_tail),
    static_cast<bool (animal::*)() const>(&parrot::has_wings),
    static_cast<void (animal::*)() const>(&parrot::sound));

// set vtable pointers in constructors
cat::cat(std::string name) : animal(&vtable_cat, std::move(name)) { }
dog::dog(std::string name) : animal(&vtable_dog, std::move(name)) { }
parrot::parrot(std::string name) : animal(&vtable_parrot, std::move(name)) { }

// implement dynamic dispatch
bool animal::has_tail() const
{
    return (this->*(vtable_ptr->has_tail))();
}

bool animal::has_wings() const
{
    return (this->*(vtable_ptr->has_wings))();
}

void animal::sound() const
{
    (this->*(vtable_ptr->sound))();
}

int main()
{
    std::vector<std::unique_ptr<animal>> animals;
    animals.push_back(std::make_unique<cat>("grumpy"));
    animals.push_back(std::make_unique<cat>("nyan"));
    animals.push_back(std::make_unique<dog>("doge"));
    animals.push_back(std::make_unique<parrot>("party"));

    for (const auto& a : animals)
        a->sound();

    // note: destructors are not dispatched virtually
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T04:01:47.637

此答案已纳入[社区 Wiki 答案](https://stackoverflow.com/questions/99297/at-as-deep-of-a-level-as-possible-how-are-virtual-functions-implemented#99341)

*   **抽象类是否只是为至少一个条目的函数指针设置了一个 NULL 值？**

答案是它是未指定的 - 如果未定义（通常未定义）调用纯虚函数会导致未定义的行为（ISO/IEC 14882:2003 10.4-2）。一些实现只是在 vtable 条目中放置一个 NULL 指针；其他实现会放置一个指向虚拟方法的指针，该方法执行类似于断言的操作。

请注意，抽象类可以定义纯虚函数的实现，但该函数只能使用限定 ID 语法调用（即，在方法名称中完全指定类，类似于从派生类）。这样做是为了提供易于使用的默认实现，同时仍需要派生类提供覆盖。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-19T14:41:32.037

您可以在 C++ 中重新创建虚函数的功能，使用函数指针作为类的成员，静态函数作为实现，或者使用指向成员函数的指针和实现的成员函数。这两种方法之间只有符号上的优势……事实上，虚函数调用本身只是一种符号上的便利。事实上，继承只是一种符号上的便利……它都可以在不使用继承的语言特性的情况下实现。:)

下面是未经测试的废话，可能有错误的代码，但希望能证明这个想法。

例如

```
class Foo
{
protected:
 void(*)(Foo*) MyFunc;
public:
 Foo() { MyFunc = 0; }
 void ReplciatedVirtualFunctionCall()
 {
  MyFunc(*this);
 }
...
};

class Bar : public Foo
{
private:
 static void impl1(Foo* f)
 {
  ...
 }
public:
 Bar() { MyFunc = impl1; }
...
};

class Baz : public Foo
{
private:
 static void impl2(Foo* f)
 {
  ...
 }
public:
 Baz() { MyFunc = impl2; }
...
}; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-04-14T12:16:20.763

我会尽量让它简单:)

## 我们都知道 C++ 中的虚函数是什么，但是它们是如何在深层次上实现的呢？

这是一个带有函数指针的数组，函数是特定虚函数的实现。此数组中的索引表示为类定义的虚函数的特定索引。这包括纯虚函数。

当一个多态类派生自另一个多态类时，我们可能有以下几种情况：

*   派生类不会添加新的虚函数，也不会覆盖任何虚函数。在这种情况下，此类与基类共享 vtable。
*   派生类添加和覆盖虚拟方法。在这种情况下，它有自己的 vtable，其中添加的虚函数的索引从最后一个派生的开始。
*   继承中的多个多态类。在这种情况下，我们在第二个和下一个基数之间有一个索引移位，以及它在派生类中的索引

## 可以在运行时修改甚至直接访问 vtable 吗？

不是标准方式 - 没有 API 可以访问它们。编译器可能有一些扩展或私有 API 来访问它们，但这可能只是一个扩展。

## vtable 是否存在于所有类，还是只存在于至少具有一个虚函数的类？

只有那些具有至少一个虚函数（甚至是析构函数）或派生至少一个具有其 vtable 的类（“是多态的”）。

## 抽象类是否只是为至少一个条目的函数指针设置了一个 NULL 值？

这是一种可能的实现，但没有实践。相反，通常有一个函数可以打印类似“调用的纯虚函数”并执行`abort()`. 如果您尝试在构造函数或析构函数中调用抽象方法，则可能会调用它。

## 拥有一个虚函数会减慢整个班级的速度吗？还是只调用虚拟函数？如果虚拟功能实际上是否被覆盖，速度是否会受到影响，或者只要它是虚拟的就没有影响。

减速仅取决于呼叫是作为直接呼叫还是虚拟呼叫解决。其他都不重要。:)

如果你通过一个指针或一个对象的引用来调用一个虚函数，那么它总是会被实现为虚调用——因为编译器永远无法知道在运行时会给这个指针分配什么样的对象，以及它是否属于是否覆盖此方法的类。只有在两种情况下，编译器才能将对虚函数的调用解析为直接调用：

*   如果您通过值（返回值的变量或函数的结果）调用该方法 - 在这种情况下，编译器不会怀疑对象的实际类是什么，并且可以在编译时“硬解析”它.
*   如果在类中声明了虚拟方法，则`final`您有一个指针或引用通过该类调用它（**仅在 C++11 中**）。在这种情况下，编译器知道这个方法不能再被重写，它只能是这个类的方法。

请注意，尽管虚拟调用仅具有取消引用两个指针的开销。使用 RTTI（尽管仅适用于多态类）比调用虚拟方法要慢，如果您找到一种以两种方式实现相同事物的案例。例如，`virtual bool HasHoof() { return false; }`仅定义然后覆盖 as`bool Horse::HasHoof() { return true; }`将为您提供`if (anim->HasHoof())`比尝试更快的调用能力`if(dynamic_cast<Horse*>(anim))`。这是因为`dynamic_cast`在某些情况下必须遍历类层次结构，甚至递归地查看是否可以从实际指针类型和所需的类类型构建路径。虽然虚拟调用始终相同 - 取消引用两个指针。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T03:33:03.573

每个对象都有一个指向成员函数数组的 vtable 指针。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-04-12T19:42:16.710

在所有这些答案中都没有提到的是，在多重继承的情况下，基类都具有虚拟方法。继承类有多个指向 vmt 的指针。结果是这样一个对象的每个实例的大小都更大。每个人都知道一个具有虚方法的类有 4 个额外的 vmt 字节，但在多重继承的情况下，它是每个具有虚方法的基类乘以 4。4 是指针的大小。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T04:55:19.117

除了问题之外，Burly 的答案在这里是正确的：

*抽象类是否只是为至少一个条目的函数指针设置了一个 NULL 值？*

答案是根本没有为抽象类创建虚拟表。没有必要，因为无法创建这些类的对象！

换句话说，如果我们有：

```
class B { ~B() = 0; }; // Abstract Base class
class D : public B { ~D() {} }; // Concrete Derived class

D* pD = new D();
B* pB = pD; 
```

通过 pB 访问的 vtbl 指针将是 D 类的 vtbl。这正是多态性的实现方式。即如何通过 pB 访问 D 方法。B类不需要vtbl。

## 回应迈克在下面的评论......

如果我描述的 B 类有一个未被 D 覆盖的虚拟方法*foo()和一个被覆盖的虚拟方法**bar()*，那么 D 的 vtbl 将有一个指向 B 的*foo()*和它自己的*bar()*的指针. 仍然没有为 B 创建 vtbl。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-01-18T03:37:45.180

我早些时候做了非常可爱的概念证明（看看继承顺序是否重要）；让我知道你的 C++ 实现是否真的拒绝它（我的 gcc 版本只给出分配匿名结构的警告，但这是一个错误），我很好奇。

**CCPolite.h**：

```
#ifndef CCPOLITE_H
#define CCPOLITE_H

/* the vtable or interface */
typedef struct {
    void (*Greet)(void *);
    void (*Thank)(void *);
} ICCPolite;

/**
 * the actual "object" literal as C++ sees it; public variables be here too 
 * all CPolite objects use(are instances of) this struct's structure.
 */
typedef struct {
    ICCPolite *vtbl;
} CPolite;

#endif /* CCPOLITE_H */ 
```

**CCPolite_constructor.h**：

```
/** 
 * unconventionally include me after defining OBJECT_NAME to automate
 * static(allocation-less) construction.
 *
 * note: I assume CPOLITE_H is included; since if I use anonymous structs
 *     for each object, they become incompatible and cause compile time errors
 *     when trying to do stuff like assign, or pass functions.
 *     this is similar to how you can't pass void * to windows functions that
 *         take handles; these handles use anonymous structs to make 
 *         HWND/HANDLE/HINSTANCE/void*/etc not automatically convertible, and
 *         require a cast.
 */
#ifndef OBJECT_NAME
    #error CCPolite> constructor requires object name.
#endif

CPolite OBJECT_NAME = {
    &CCPolite_Vtbl
};

/* ensure no global scope pollution */
#undef OBJECT_NAME 
```

**主.c**：

```
#include <stdio.h>
#include "CCPolite.h"

// | A Greeter is capable of greeting; nothing else.
struct IGreeter
{
    virtual void Greet() = 0;
};

// | A Thanker is capable of thanking; nothing else.
struct IThanker
{
    virtual void Thank() = 0;
};

// | A Polite is something that implements both IGreeter and IThanker
// | Note that order of implementation DOES MATTER.
struct IPolite1 : public IGreeter, public IThanker{};
struct IPolite2 : public IThanker, public IGreeter{};

// | implementation if IPolite1; implements IGreeter BEFORE IThanker
struct CPolite1 : public IPolite1
{
    void Greet()
    {
        puts("hello!");
    }

    void Thank()
    {
        puts("thank you!");
    }
};

// | implementation if IPolite1; implements IThanker BEFORE IGreeter
struct CPolite2 : public IPolite2
{
    void Greet()
    {
        puts("hi!");
    }

    void Thank()
    {
        puts("ty!");
    }
};

// | imposter Polite's Greet implementation.
static void CCPolite_Greet(void *)
{
    puts("HI I AM C!!!!");
}

// | imposter Polite's Thank implementation.
static void CCPolite_Thank(void *)
{
    puts("THANK YOU, I AM C!!");
}

// | vtable of the imposter Polite.
ICCPolite CCPolite_Vtbl = {
    CCPolite_Thank,
    CCPolite_Greet    
};

CPolite CCPoliteObj = {
    &CCPolite_Vtbl
};

int main(int argc, char **argv)
{
    puts("\npart 1");
    CPolite1 o1;
    o1.Greet();
    o1.Thank();

    puts("\npart 2");    
    CPolite2 o2;    
    o2.Greet();
    o2.Thank();    

    puts("\npart 3");    
    CPolite1 *not1 = (CPolite1 *)&o2;
    CPolite2 *not2 = (CPolite2 *)&o1;
    not1->Greet();
    not1->Thank();
    not2->Greet();
    not2->Thank();

    puts("\npart 4");        
    CPolite1 *fake = (CPolite1 *)&CCPoliteObj;
    fake->Thank();
    fake->Greet();

    puts("\npart 5");        
    CPolite2 *fake2 = (CPolite2 *)fake;
    fake2->Thank();
    fake2->Greet();

    puts("\npart 6");        
    #define OBJECT_NAME fake3
    #include "CCPolite_constructor.h"
    fake = (CPolite1 *)&fake3;
    fake->Thank();
    fake->Greet();

    puts("\npart 7");        
    #define OBJECT_NAME fake4
    #include "CCPolite_constructor.h"
    fake2 = (CPolite2 *)&fake4;
    fake2->Thank();
    fake2->Greet();    

    return 0;
} 
```

输出：

```
part 1
hello!
thank you!

part 2
hi!
ty!

part 3
ty!
hi!
thank you!
hello!

part 4
HI I AM C!!!!
THANK YOU, I AM C!!

part 5
THANK YOU, I AM C!!
HI I AM C!!!!

part 6
HI I AM C!!!!
THANK YOU, I AM C!!

part 7
THANK YOU, I AM C!!
HI I AM C!!!! 
```

请注意，由于我从不分配我的假对象，因此无需进行任何破坏；析构函数被自动放在动态分配对象范围的末尾，以回收对象字面量本身和 vtable 指针的内存。

# performance - 冗余限定符有什么缺点吗？有什么好处吗？

> ID：99299
> 
> 赞同：2
> 
> 时间：2008-09-19T03:29:50.070
> 
> 标签：performance, duplicates, qualifiers

例如，引用 System.Data.Datagrid 而不仅仅是 Datagrid。请提供例子和解释。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T03:34:42.070

您对所引用的类型非常明确，这是一个好处。虽然，在同一个过程中，您放弃了代码清晰度，这在我的情况下显然是一个缺点，因为我希望代码具有可读性和可理解性。我会选择简短版本，除非我在不同的命名空间中存在冲突，这只能通过显式引用类来解决。除非我使用以下关键字为其创建别名：

```
using Datagrid = System.Data.Datagrid; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T03:35:38.887

实际上完整路径是`global::System.Data.DataGrid`. 使用更合格的路径的目的是避免使用额外的 using 语句，特别是如果引入另一个 using 将导致类型解析问题。存在更多完全限定的标识符，以便在需要显式时可以显式，但如果类的命名空间清晰，则`DataGrid`版本对许多人来说更清晰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T03:38:53.980

好处是您不需要为您使用的所有内容添加导入，特别是如果它是您从特定命名空间使用的唯一内容，它还可以防止冲突。

当然，不利的一面是代码会膨胀，并且使用特定限定符的次数越多，就越难阅读。

就个人而言，我倾向于对大多数事情使用导入，除非我确定我只会使用来自特定命名空间的东西一次或两次，因此它不会影响我的代码的可读性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T03:39:37.143

我通常使用可用的最短形式，以保持代码尽可能干净和可读。毕竟，这就是 using 指令的用途，VS 编辑器中的工具提示可让您即时详细了解类型的出处。

我还倾向于在 COM 互操作层中为 RCW 使用命名空间标记，以在代码中显式调用这些变量（它们可能需要特别注意生命周期和集合），例如

```
using _Interop = Some.Interop.Namespace; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T03:48:18.480

在性能方面没有上升/下降。一切都在编译时解决，无论您是否使用完全限定的名称，生成的 MSIL 都是相同的。

它在 .NET 世界中普遍使用的原因是因为自动生成的代码，例如设计器标记。在这种情况下，最好使用完全限定名称（如类名），因为可能与代码中可能存在的其他类发生冲突。

如果您有像 ReSharper 这样的工具，它实际上会告诉您哪些完全限定的引用是不必要的（例如，通过将它们变灰），因此您可以将它们删除。如果您经常在各种代码库中剪切粘贴代码，则必须完全限定它们。（再说一遍，你为什么要一直做剪切粘贴；这是一种不好的代码重用形式！）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T03:35:07.217

我认为没有真正的缺点，只是可读性与实际花费的编码时间。一般来说，如果你没有带有模糊对象的命名空间，我认为它不是真正需要的。要考虑的另一件事是使用水平。如果您有一种使用反射的方法，并且您可以输入 System.Reflection 10 次，那么这没什么大不了的，但是如果您打算大量使用命名空间，那么我会推荐一个包含。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T03:37:08.960

根据您的情况，额外的限定符会产生警告（如果这就是您所说的冗余）。如果您随后将警告视为错误，那将是一个非常严重的缺点。

例如，我在 GCC 上遇到过这个问题。

```
struct A {
    int A::b; // warning!
} 
```

# java - 在任何 NullPointerException 消息中包含类名和变量名是否有用？

> ID：99302
> 
> 赞同：1
> 
> 时间：2008-09-19T03:30:20.990
> 
> 标签：java

在任何 NullPointerException 消息中包含类名和变量名是否有用？我知道由于 JIT 所做的更改，它可能并不总是可能的，但似乎信息应该经常可用（班级成员等）。

来自：http: [//jamesjava.blogspot.com/2005/04/what-was-null.html](http://jamesjava.blogspot.com/2005/04/what-was-null.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T03:41:52.740

那要看。如果您获得堆栈跟踪，则很清楚是哪个类引发了异常。这通常会确保您的环境在出现未处理的异常时为您提供堆栈跟踪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T03:36:53.453

在错误期间提供尽可能多的信息是一件好事……对吗？

帮助跟踪错误。

**编辑：（**是的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T08:38:14.197

不，我认为这根本不会“有用”。

相反，您应该注意不要一开始就抛出 NPE。在使用它们之前检查您的值（`null`验证）等。这应该*在*调用库方法之前和返回结果*之后*发生（如果 API 指定该方法可能返回`null`。当然，有时它无论如何都会这样做，但那是一个错误）。

如果您认为 NPE 应该携带此信息进行调试，请再想一想。这就是调试器的好处。一个例外只是通知您出了问题。请记住，未经检查的异常发生在运行时 - 并且必须在那里生成。为了让异常知道包含哪个*变量*`null`，**字节** **码**必须知道变量名。你不想用这样的东西来膨胀你的字节码。类名包含在我从程序收到的每个日志输出中。这就是日志记录的好处。

Java 通过为您提供行号和完整的堆栈跟踪已经大大简化了调试过程。C 程序以`Segmentation fault`. 您必须使用`strace`或调试器才能获得如此多的信息。

请注意，它`javac` *确实*包含一个编译时选项以在编译时包含源文件信息，但这旨在由调试器使用，**而不是**被抛出的随机异常。引用 Sun 的`javac`手册页：

```
             -g 生成所有调试信息，包括局部变量。
                默认只有行号和源文件信息
                生成。

             -g：无
                不要生成任何调试信息。

             -g:{关键字列表}
                仅生成某些类型的调试信息，指定
                通过逗号分隔的关键字列表。有效的关键字是：

                资源

                   源文件调试信息

                线条
                   行号调试信息

                变量
                   局部变量调试信息

```

长话短说：使用调试器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T04:02:11.287

是的，那会很有用。特别是如果您有一种机制，错误消息 ( `exception.getMessage()`) 会显示在屏幕上，但实际的堆栈跟踪会隐藏在您无法立即访问的日志文件中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-19T03:41:30.540

你在扔`NullPointerException`吗？我认为您可能应该`null`在代码中进行验证。我还会考虑使用开源日志工具，例如`Log4J`.

# java - 将 java 更改为同时支持静态和动态类型是否有用？

> ID：99315
> 
> 赞同：-3
> 
> 时间：2008-09-19T03:32:45.490
> 
> 标签：java, language-design

如果 Java 允许静态和动态类型怎么办。这可能允许两全其美。IE：

```
String str = "Hello";
var temp = str;
temp = 10;
temp = temp * 5; 
```

1.  那可能吗？
2.  那会有好处吗？
3.  目前是否有任何语言支持这两种语言以及它的效果如何？

这是一个更好的例子（不能使用泛型，但程序确实知道类型）：

```
var username = HttpServletRequest.getSession().getAttribute("username");//Returns a String
if(username.length() == 0) {
    //Error
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T03:47:02.103

C# 有一个以您描述的方式使用的“var”关键字，但它最终成为一个强类型变量，基于类型检查建议将进入它的值的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T03:35:15.017

你能解释一下你的例子和

```
String str = "Hello";
Object temp = str;
temp = 10; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T03:43:43.983

动态类型变量只有**Universal**类型，因此其他所有类型都是**Universal**的子类型。所有类型都继承自这种通用类型的任何语言（例如 Java 模未装箱值）已经具有此功能。至于有用性 - 取决于你在做什么。我更喜欢一个完全静态的类型系统，它可以很容易地创建安全的标记联合，因此我可以将我需要的任何值放入变量中，但比**Universal**更受控制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T03:44:23.717

是的，这将是有益的，但不适用于您展示的示例。我认为这样的事情会更好

```
public void f(var o)
{
   o.method();
} 
```

而且我可以使用名为 method() 的方法对任何对象调用 f ，而无需引入接口。对于有约定但不一定有接口的地方来说，这很好。它对于与具有动态调度的语言的互操作也很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T08:00:04.477

@Lou: It would be just syntactic sugar for:

```
void doSth(Object foo) throws Exception{
        Method m = foo.getClass().getMethod("foo", String.class);
        m.invoke(foo, "baz");       
} 
```

I do use reflection, but I prefer it to be ugly so it's not abused.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-20T15:21:28.687

动态类型语言使编码变得更加简单和快速，但它们这样做的代价是将错误从编译时（非常容易找到）推到运行时（难以找到且不可预测）。如果 Java 引入它并且它变得流行，我会寻找另一种更关心代码质量和我的时间的语言。

我在工作中作为 Java 工作的前端进行了很多 Flex 开发，当我使用带参数的 Flex 方法工作时，开发人员大部分时间都使用 Object 作为参数，这让我感到非常沮丧类型，我完全不知道如果不运行带有断点的程序并希望我已经测试了对该方法的所有可能调用，它将具有哪些属性/方法。即使他们为参数使用了特定的类，也没有说没有添加或删除属性/方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T07:33:19.780

1.  那可能吗？
    几乎不。Java 是一种类 C 语言，最初设计为仅支持静态类型。将这个特性引入 Java 需要很多时间，我认为开发人员不会花时间在这上面。
2.  那会有好处吗？
    不，Java 是一门传统语言，静态类型是基本原则之一或它的架构。事实上，静态类型在编程中仍然更流行（你可以在[这里](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)查看有趣的统计数据）。
3.  目前是否有任何语言支持它，它的效果如何？
    嗯，有很多语言支持动态类型，但我想你知道这一点。如果该语言支持动态类型，那么将静态类型引入该语言是没有意义的......

此外，您在示例中显示的功能可以通过静态类型来实现。jon 给了你一个 Java 中的“Object”类的例子。您可以在 C/C++ 中使用 void* 进行类似操作。尽管如此，这并不能使语言动态类型化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-20T14:21:06.000

动态类型当然有它的用途。

但是，我认为将其添加到 Java 中没有意义——Java 被设计为静态类型语言，此时尝试和移植动态类型将是哲学和架构上的巨大转变。

如果您想要正确的动态类型，但仍想成为 Java 生态系统的一部分，请查看支持动态类型的其他出色 JVM 语言之一：例如 Clojure 和 Groovy。

# ruby - 理解 [ClassOne, ClassTwo].each(&:my_method)

> ID：99318
> 
> 赞同：12
> 
> 时间：2008-09-19T03:33:05.990
> 
> 标签：ruby

> **可能重复：**
> [map(&:name) 在 Ruby 中是什么意思？](https://stackoverflow.com/questions/1217088/what-does-mapname-mean-in-ruby)

我正在观看 railscast 并看到了这段代码。

```
[Category, Product].(&:delete_all) 
```

关于清除数据库。

我询问了 IRC 中的线路并被告知

```
(&:delete_all) 
```

是一条捷径

```
{|model| model.delete_all} 
```

我用以下方法对此进行了测试

```
class ClassOne
  def class_method
    puts 1
  end
end

class ClassTwo
  def class_method
    puts 2
  end
end

[ClassOne, ClassTwo].each(&:class_method) 
```

我收到一条错误消息

```
Wrong Argument type Symbol (expected Proc) 
```

我也试过

```
one = ClassOne.new
two = ClassTwo.new

[one, two].each(&:class_method) 
```

但这仍然失败了。

如果我将其修改为阅读

```
[one, two].each{|model| model.class_method} 
```

一切都按预期工作。

那么，`&:delete_all`实际上是做什么的呢？文档说`delete_all`是一种方法，所以我对这里发生的事情感到困惑。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-19T03:36:00.820

这依赖于 Ruby 1.9 扩展，可以在 1.8 中通过包括以下内容来完成：

```
class Symbol
    def to_proc
      proc { |obj, *args| obj.send(self, *args) }
    end
end 
```

我相信 Rails 在`ActiveSupport`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T03:36:54.250

这是一些 Rails 特定的 Ruby 补丁，[是 proc 的符号](http://blog.hasmanythrough.com/2006/3/7/symbol-to-proc-shorthand)。

# flash - 从 as3 中的 POST 上传中获取 ProgressEvent

> ID：99319
> 
> 赞同：6
> 
> 时间：2008-09-19T03:33:11.327
> 
> 标签：flash, actionscript-3, actionscript

有什么方法可以跟踪 AS3 中已发布上传的状态吗？有一个 ProgressEvent，但它会返回有关响应的数据，而不是实际的 POST 上传。我正在发布图像的二进制数据，因此它通常在 50-100kb 范围内。

图像数据是在 Flash 内部生成的，所以我不能使用上传方法 - 至少据我所知。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T12:30:14.457

也许您可以在服务器端使用一个函数将进度事件发送到 flash 对象？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-22T03:45:40.927

他不是在询问文件参考列表..

他和我有同样的问题，没有一种方法可以进行后期数据传输。我认为唯一的方法是上面建议的方法，从 PHP 发送到 flash 一个 progressEvent 检查接收到的数据的大小（如果可能的话..）；

再见

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T15:03:52.093

看一下[FileReference](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/FileReference.html)类。其中的进度事件将为您提供有关上传的数据：

> 在文件上传或下载操作期间定期调度。progress 事件在 Flash Player 向服务器传输字节时调度，并且在传输期间定期调度，即使传输最终不成功。要确定文件传输是否以及何时真正成功并完成，请侦听完成事件。

# bash - 如何更改 cygwin rxvt 中显示的颜色？

> ID：99348
> 
> 赞同：1
> 
> 时间：2008-09-19T03:38:29.410
> 
> 标签：bash, cygwin, rxvt

当我打印时，`"\[\e[34m\]sometext"`我得到一些蓝色的文本，但是我可以在某处指定蓝色的阴影吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T23:24:44.493

如果您的 rxvt 启用了 256 种颜色，您可以使用扩展颜色代码（例如“^[[38;5;36m”）。试试这个[脚本](http://www.vim.org/scripts/script.php?script_id=1349)来测试你的终端是否启用了 256 色。可能您需要修补/重新编译它或下载另一个版本。我推荐[这个](http://www.frexx.de/xterm-256-notes/)教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T04:59:54.800

您正在使用 ANSI 转义序列，它的颜色选项非常有限。我使用 .Xdefaults 文件（在[本教程](http://freemode.net/archives/000121.html)中进行了说明）。这些选项不会让你的 shell 提示变得丰富多彩，但会被 vim 等编辑器使用。

请注意，.Xdefaults 对 UNIX (CR) 与 Windows (CRLF) 行尾可能很挑剔。根据需要使用 d2u 或 u2d 切换行尾。

# php - 将 PHP 关联数组传入和传出 XML

> ID：99350
> 
> 赞同：17
> 
> 时间：2008-09-19T03:39:11.200
> 
> 标签：php, xml, xml-serialization

有没有一种简单的方法可以将 PHP 关联数组与 XML 编组？例如，我有以下数组：

```
$items = array("1", "2",
    array(
        "item3.1" => "3.1",
        "item3.2" => "3.2"
        "isawesome" => true
    )
); 
```

如何以尽可能少的行将其转换为类似于以下 XML 的内容，然后再返回？

```
<items>
    <item>1</item>
    <item>2</item>
    <item>
        <item3_1>3.1</item3_1>
        <item3_2>3.2</item3_2>
        <isawesome>true</isawesome>
    </item>
</items> 
```

我真的不在乎是否必须稍微更改数组结构，或者输出的 XML 是否与上面的示例不同。我一直在尝试使用 PHP 的[XMLReader](http://php.net/manual/en/book.xmlreader.php)和[XMLWriter](http://php.net/manual/en/book.xmlwriter.php)，但是文档太差了，因此我生成的代码看起来不像我认为的那样：

```
$xml = SomeXMLWriter::writeArrayToXml($items);
$array = SomeXMLWriter::writeXmlToArray($xml); 
```

在不编写我自己的自定义类的情况下获得 PHP 数组的基本原始 XML 转储真的比这更难吗？

我尽量避免梨。除了我在使用它时遇到的配置问题之外，我从未使用过我曾经使用过的任何软件包。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-19T03:44:52.327

[SimpleXML](http://php.net/simplexml)非常适合您使用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-07T09:32:31.677

对于那些不使用 PEAR 包但已安装 PHP5 的人。这对我有用：

```
/**
 * Build A XML Data Set
 *
 * @param array $data Associative Array containing values to be parsed into an XML Data Set(s)
 * @param string $startElement Root Opening Tag, default fx_request
 * @param string $xml_version XML Version, default 1.0
 * @param string $xml_encoding XML Encoding, default UTF-8
 * @return string XML String containig values
 * @return mixed Boolean false on failure, string XML result on success
 */
public function buildXMLData($data, $startElement = 'fx_request', $xml_version = '1.0', $xml_encoding = 'UTF-8') {
    if(!is_array($data)) {
        $err = 'Invalid variable type supplied, expected array not found on line '.__LINE__." in Class: ".__CLASS__." Method: ".__METHOD__;
        trigger_error($err);
        if($this->_debug) echo $err;
        return false; //return false error occurred
    }
    $xml = new XmlWriter();
    $xml->openMemory();
    $xml->startDocument($xml_version, $xml_encoding);
    $xml->startElement($startElement);

    /**
     * Write XML as per Associative Array
     * @param object $xml XMLWriter Object
     * @param array $data Associative Data Array
     */
     function write(XMLWriter $xml, $data) {
         foreach($data as $key => $value) {
             if(is_array($value)) {
                 $xml->startElement($key);
                 write($xml, $value);
                 $xml->endElement();
                 continue;
             }
             $xml->writeElement($key, $value);
         }
     }
     write($xml, $data);

     $xml->endElement();//write end element
     //Return the XML results
     return $xml->outputMemory(true); 
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T06:57:52.560

我遇到了一些同样的问题，所以我创建了两个类：

**bXml**

一个扩展 SimpleXml 并纠正其存在的一些问题的类。就像无法添加 CData 节点或 Comment 节点一样。我还添加了一些附加功能，例如使用 php 流功能添加子节点`$oXml->AddChild("file:///user/data.xml")`或添加 XML 字符串子节点，`$oXml->AddChild("<more><xml>yes</xml></more>");`但基本上我只是想修复 simpleXML 问题。

**数组**

我扩展了 ArrayObject 类，以便所有数组功能都可以面向对象且一致，因此您无需记住 array_walk 通过引用对数组进行操作，而 array_filter 通过值对数组进行操作。因此，您可以执行类似`$oArray->flip()->Reverse()->Walk(/*callback*/);`then 的操作，但仍以您通常希望的方式访问该值`$oArray[key]`。

这两种方法都将自身输出为 Arrays 和 Xml，因此您可以在它们之间无缝跳转。所以你可以`$oXml->AsArray();`或者`$oArray->AsXml();`我发现这样做比在 array2xml 或 xml2array 方法之间不断地来回传递东西更容易。

[http://code.google.com/p/blibrary/source](http://code.google.com/p/blibrary/source/browse/#svn/trunk/classes)

这两个类都可以被覆盖以制作您选择的自定义类，并且可以彼此独立使用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-07T09:49:40.010

```
class Xml {

    public static function from_array($arr, $xml = NULL)
    {
        $first = $xml;
        if($xml === NULL) $xml = new SimpleXMLElement('<root/>');
        foreach ($arr as $k => $v) 
        {
            is_array($v)
                ? self::from_array($v, $xml->addChild($k))
                : $xml->addChild($k, $v);
        }
        return ($first === NULL) ? $xml->asXML() : $xml;
    }

    public static function to_array($xml)
    {
        $xml = simplexml_load_string($xml);
        $json = json_encode($xml);
        return json_decode($json,TRUE);
    }

}

$xml = xml::from_array($array);
$array = xml::to_array($xml); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T03:42:35.687

你见过 PEAR 包 XML_Serializer 吗？

[pear_php_XML_Serializer](http://pear.php.net/package/XML_Serializer)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T04:38:17.003

一般尝试 Zend_Config 和 Zend Framework。

我想这将是一个两步过程：数组到 Zend_Config，Zend_Config 到 XML。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-19T07:38:17.850

听起来像是 SimpleXML 的工作。

我会建议一个稍微不同的 XML 结构..

并且想知道为什么您需要从数组转换 -> XML 并返回。如果您可以按照您所说的修改数组结构，为什么不直接生成 XML 呢？如果已经存在采用该数组配置的某些代码，只需将其修改为接受 XML。然后你有1种数据格式/输入类型，根本不需要转换..

```
<items>
  <item id="1"/>
  <item id="2"/>
  <item id="3">
  <subitems>     
    <item id="3.1"/>
    <item id="3.2" isawesome="true"/>
  </subitems>
  </item>
</items> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-06-04T16:39:13.020

这是我编写的一个函数，用于获取 XML 并将其转换为 PHP 关联数组。一个警告是 id 当前不处理属性或 c 数据。尽管它将通过将重复的 XML 标记放入以标记命名的数组中来处理同一级别的重复 XML 标记。

```
 <?php

$xml_req1 = <<<XML
<?xml version="1.0"?>
<Vastera:CustomerValidation_RequestInfo
      xmlns:Vastera="http://ndc-ah-prd.am.mot.com:10653/MotVastera_CustomerValidation/MC000078/Docs/">
  <PartnerID>5550000100-003</PartnerID>
  <PartnerType>PTNR_INTER_CONSIGNEE</PartnerType>
  <OperatingUnit>100</OperatingUnit>
  <Status>ACTIVE</Status>
  <CustomerSeqNumber>111</CustomerSeqNumber>
  <CustomerName>Greg Co</CustomerName>
  <Address1>123 Any Ln</Address1>
  <Address2>?</Address2>
  <Address3>?</Address3>
  <Address4>?</Address4>
  <Address5>?</Address5>
  <City>Someplace</City>
  <PostalCode>603021</PostalCode>
  <State>CA</State>
  <CountryCode>US</CountryCode>
  <TaxReference>222</TaxReference>
  <PartyRelated>Y</PartyRelated>
  <BusinessUnit>GSBU</BusinessUnit>
  <Region>GSRGN</Region>
  <LocationName>DBA Mac Head Computing</LocationName>
  <LoadOnly>N</LoadOnly>
  <VSTM>333</VSTM>
  <MilitaryCustomerFlag>Y</MilitaryCustomerFlag>
  <USFederalGovernmentCustomer>Y</USFederalGovernmentCustomer>
  <Non-USGovernmentCustomer>Y</Non-USGovernmentCustomer>
  <Vastera:EPCIActivity>
    <EPCIActivityNuclearCode>NUCLEAR</EPCIActivityNuclearCode>
    <EPCIActivityNuclearValue>N</EPCIActivityNuclearValue>
    <EPCIActivityNuclearApproveDate>2011-05-16:07:19:37</EPCIActivityNuclearApproveDate>
    <EPCIActivityNuclearExpireDate>2056-12-31:12:00:00</EPCIActivityNuclearExpireDate>
    <EPCIActivityNuclearCountry>US</EPCIActivityNuclearCountry>
    <EPCIActivityChemBioCode>CHEM_BIO</EPCIActivityChemBioCode>
    <EPCIActivityChemBioValue>N</EPCIActivityChemBioValue>
    <EPCIActivityChemBioApproveDate>2011-05-16:07:19:37</EPCIActivityChemBioApproveDate>
    <EPCIActivityChemBioExpireDate>2056-12-31:12:00:00</EPCIActivityChemBioExpireDate>
    <EPCIActivityChemBioCountry>US</EPCIActivityChemBioCountry>
    <EPCIActivityMissileCode>MISSILE</EPCIActivityMissileCode>
    <EPCIActivityMissileValue>N</EPCIActivityMissileValue>
    <EPCIActivityMissileApproveDate>2011-05-16:07:19:37</EPCIActivityMissileApproveDate>
    <EPCIActivityMissileExpireDate>2056-12-31:12:00:00</EPCIActivityMissileExpireDate>
    <EPCIActivityMissileCountry>US</EPCIActivityMissileCountry>
  </Vastera:EPCIActivity>
  <SourceSystem>GSB2BSS</SourceSystem>
  <CreatedDate>2011-05-16:07:18:55</CreatedDate>
  <CreatedBy>c18530</CreatedBy>
  <LastModifiedDate>2011-05-16:07:18:55</LastModifiedDate>
  <LastModifiedBy>c18530</LastModifiedBy>
  <ContactName>Greg, "Da Man" Skluacek</ContactName>
  <ContactTitle>Head Honcho</ContactTitle>
  <ContactPhone>555-555-5555</ContactPhone>
  <ContactFax>666-666-6666</ContactFax>
  <ContactEmail>gskluzacek@gregco.com</ContactEmail>
  <ContactWeb>www.gregco.com</ContactWeb>
</Vastera:CustomerValidation_RequestInfo>
XML;

$xml_req2 = <<<XML
<?xml version="1.0"?>
<order>
    <orderNumber>123</orderNumber>
    <customerAddress>
        <type>Ship To</type>
        <name>Bob McFly</name>
        <addr1>123 Lincoln St</addr1>
        <city>Chicago</city>
        <state>IL</state>
        <zip>60001</zip>
    </customerAddress>
    <customerAddress>
        <type>Bill To</type>
        <name>McFly Products Inc.</name>
        <addr1>P.O. Box 6695</addr1>
        <city>New York</city>
        <state>NY</state>
        <zip>99081-6695</zip>
    </customerAddress>
    <item>
        <line>1</line>
        <part>123001A</part>
        <qty>5</qty>
        <price>10.25</price>
    </item>
    <item>
        <line>2</line>
        <part>456002B</part>
        <qty>3</qty>
        <price>20.50</price>
    </item>
    <item>
        <line>3</line>
        <part>789003C</part>
        <qty>1</qty>
        <price>41.00</price>
    </item>
    <orderSubTotal>133.25</orderSubTotal>
    <tax>6.66</tax>
    <shipping>10.00</shipping>
    <orderTotal>149.91</orderTotal>
</order>
XML;

$doc = new DOMDocument();
$doc->preserveWhiteSpace = false;
$doc->loadXML($xml_req1);

$arr = xml_to_arr($doc->documentElement);

print "\n\n----\n\n";

print_r($arr);

print "\n\n----\n\n";

$doc2 = new DOMDocument();
$doc2->preserveWhiteSpace = false;
$doc2->loadXML($xml_req2);

$arr2 = xml_to_arr($doc2->documentElement);

print "\n\n----\n\n";

print_r($arr2);

print "\n\n----\n\n";

exit;

function xml_to_arr($curr_node) {
    $val_array = array();
    $typ_array = array();

    foreach($curr_node->childNodes as $node) {
        if ($node->nodeType == XML_ELEMENT_NODE) {

            $val = xml_to_arr($node);

            if (array_key_exists($node->tagName, $val_array)) {

                if (!is_array($val_array[$node->tagName]) || $type_array[$node->tagName] == 'hash') {
                    $existing_val = $val_array[$node->tagName];
                    unset($val_array[$node->tagName]);
                    $val_array[$node->tagName][0] = $existing_val;
                    $type_array[$node->tagName] = 'array';
                }
                $val_array[$node->tagName][] = $val;

            } else {

                $val_array[$node->tagName] = $val;
                if (is_array($val)) {
                    $type_array[$node->tagName] = 'hash';
                }

            } // end if array key exists

        } // end if elment node
    }// end for each

    if (count($val_array) == 0) {
        return $curr_node->nodeValue;
    } else {
        return $val_array;
    }

} // end function xml to arr

?> 
```

示例输出

```
 ----

Array
(
    [PartnerID] => 5550000100-003
    [PartnerType] => PTNR_INTER_CONSIGNEE
    [OperatingUnit] => 100
    [Status] => ACTIVE
    [CustomerSeqNumber] => 111
    [CustomerName] => Greg Co
    [Address1] => 123 Any Ln
    [Address2] => ?
    [Address3] => ?
    [Address4] => ?
    [Address5] => ?
    [City] => Somplace
    [PostalCode] => 60123
    [State] => CA
    [CountryCode] => US
    [TaxReference] => 222
    [PartyRelated] => Y
    [BusinessUnit] => GSBU
    [Region] => GSRGN
    [LocationName] => DBA Mac Head Computing
    [LoadOnly] => N
    [VSTM] => 333
    [MilitaryCustomerFlag] => Y
    [USFederalGovernmentCustomer] => Y
    [Non-USGovernmentCustomer] => Y
    [Vastera:EPCIActivity] => Array
        (
            [EPCIActivityNuclearCode] => NUCLEAR
            [EPCIActivityNuclearValue] => N
            [EPCIActivityNuclearApproveDate] => 2011-05-16:07:19:37
            [EPCIActivityNuclearExpireDate] => 2056-12-31:12:00:00
            [EPCIActivityNuclearCountry] => US
            [EPCIActivityChemBioCode] => CHEM_BIO
            [EPCIActivityChemBioValue] => N
            [EPCIActivityChemBioApproveDate] => 2011-05-16:07:19:37
            [EPCIActivityChemBioExpireDate] => 2056-12-31:12:00:00
            [EPCIActivityChemBioCountry] => US
            [EPCIActivityMissileCode] => MISSILE
            [EPCIActivityMissileValue] => N
            [EPCIActivityMissileApproveDate] => 2011-05-16:07:19:37
            [EPCIActivityMissileExpireDate] => 2056-12-31:12:00:00
            [EPCIActivityMissileCountry] => US
        )

    [SourceSystem] => GSB2BSS
    [CreatedDate] => 2011-05-16:07:18:55
    [CreatedBy] => c18530
    [LastModifiedDate] => 2011-05-16:07:18:55
    [LastModifiedBy] => c18530
    [ContactName] => Greg, "Da Man" Skluacek
    [ContactTitle] => Head Honcho
    [ContactPhone] => 555-555-5555
    [ContactFax] => 666-666-6666
    [ContactEmail] => gskluzacek@gregco.com
    [ContactWeb] => www.gregco.com
)

----

Array
(
    [orderNumber] => 123
    [customerAddress] => Array
        (
            [0] => Array
                (
                    [type] => Ship To
                    [name] => Bob McFly
                    [addr1] => 123 Lincoln St
                    [city] => Chicago
                    [state] => IL
                    [zip] => 60001
                )

            [1] => Array
                (
                    [type] => Bill To
                    [name] => McFly Products Inc.
                    [addr1] => P.O. Box 6695
                    [city] => New York
                    [state] => NY
                    [zip] => 99081-6695
                )

        )

    [item] => Array
        (
            [0] => Array
                (
                    [line] => 1
                    [part] => 123001A
                    [qty] => 5
                    [price] => 10.25
                )

            [1] => Array
                (
                    [line] => 2
                    [part] => 456002B
                    [qty] => 3
                    [price] => 20.50
                )

            [2] => Array
                (
                    [line] => 3
                    [part] => 789003C
                    [qty] => 1
                    [price] => 41.00
                )

        )

    [orderSubTotal] => 133.25
    [tax] => 6.66
    [shipping] => 10.00
    [orderTotal] => 149.91
)

-------- 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-07-30T02:06:34.340

嘿@Conrad，我只是修改了您的代码以与数字数组一起使用：

```
/**
 * Build A XML Data Set
 *
 * @param array $data Associative Array containing values to be parsed into an XML Data Set(s)
 * @param string $startElement Root Opening Tag, default fx_request
 * @param string $xml_version XML Version, default 1.0
 * @param string $xml_encoding XML Encoding, default UTF-8
 * @return string XML String containig values
 * @return mixed Boolean false on failure, string XML result on success
 */
public static function arrayToXML($data, $startElement = 'fx_request', $xml_version = '1.0', $xml_encoding = 'UTF-8'){
    if(!is_array($data)){
        $err = 'Invalid variable type supplied, expected array not found on line '.__LINE__." in Class: ".__CLASS__." Method: ".__METHOD__;
        trigger_error($err);
        if($this->_debug) echo $err;
        return false; //return false error occurred
    }
    $xml = new XmlWriter();
    $xml->openMemory();
    $xml->startDocument($xml_version, $xml_encoding);
    $xml->startElement($startElement);

    /**
     * Write XML as per Associative Array
     * @param object $xml XMLWriter Object
     * @param array $data Associative Data Array
     */
    function write(XMLWriter $xml, $data){
        foreach($data as $key => $value){
            if (is_array($value) && isset($value[0])){
                foreach($value as $itemValue){
                    //$xml->writeElement($key, $itemValue);

                    if(is_array($itemValue)){
                        $xml->startElement($key);
                        write($xml, $itemValue);
                        $xml->endElement();
                        continue;
                    } 

                    if (!is_array($itemValue)){
                        $xml->writeElement($key, $itemValue."");
                    }
                }
            }else if(is_array($value)){
                $xml->startElement($key);
                write($xml, $value);
                $xml->endElement();
                continue;
            } 

            if (!is_array($value)){
                $xml->writeElement($key, $value."");
            }
        }
    }
    write($xml, $data);

    $xml->endElement();//write end element
    //returns the XML results
    return $xml->outputMemory(true);
} 
```

所以你可以转换这个：

```
$mArray["invitations"]["user"][0]["name"] = "paco";
$mArray["invitations"]["user"][0]["amigos"][0] = 82;
$mArray["invitations"]["user"][0]["amigos"][1] = 29;
$mArray["invitations"]["user"][0]["amigos"][2] = 6;

$mArray["invitations"]["user"][1]["name"] = "jose";
$mArray["invitations"]["user"][1]["amigos"][0] = 43;
$mArray["invitations"]["user"][1]["amigos"][1]["tuyos"] = 32;
$mArray["invitations"]["user"][1]["amigos"][1]["mios"] = 79;
$mArray["invitations"]["user"][1]["amigos"][2] = 11;

$mArray["invitations"]["user"][2]["name"] = "luis";
$mArray["invitations"]["user"][2]["amigos"][0] = 65; 
```

进入这个 xml：

```
<invitations>
<user>
    <name>paco</name>
    <amigos>82</amigos>
    <amigos>29</amigos>
    <amigos>6</amigos>
</user>
<user>
    <name>jose</name>
    <amigos>43</amigos>
    <amigos>
        <tuyos>32</tuyos>
        <mios>79</mios>
    </amigos>
    <amigos>11</amigos>
</user>
<user>
    <name>luis</name>
    <amigos>65</amigos>
</user> 
```

我希望我能帮助别人

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-19T08:02:18.277

我同意这是 PHP 文档已经放弃的一个领域，但对我来说，我总是将 SimpleXML 与 xml2Array 函数之类的东西混合使用。借助 print_r 之类的转储函数，您从 simpleXML 获得的 XML 并不难导航。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-06-11T17:32:44.980

这建立在 Ángel López 的回答之上。添加了对属性的支持。如果元素有属性，则在它们前面加上@，并以空字符串作为键来引用实际元素内容。

```
/**
 * Build an XML Data Set
 *
 * @param array $data Associative Array containing values to be parsed into an XML Data Set(s)
 * @param string $startElement Root Opening Tag, default fx_request
 * @param string $xml_version XML Version, default 1.0
 * @param string $xml_encoding XML Encoding, default UTF-8
 * @return string XML String containig values
 * @return mixed Boolean false on failure, string XML result on success
 */
function arrayToXML($data, $startElement = 'fx_request', $xml_version = '1.0', $xml_encoding = 'UTF-8'){
  if(!is_array($data)){
    $err = 'Invalid variable type supplied, expected array not found on line '.__LINE__." in Class: ".__CLASS__." Method: ".__METHOD__;
    trigger_error($err);
    //if($this->_debug) echo $err;
    return false; //return false error occurred
  }
  $xml = new XmlWriter();
  $xml->openMemory();
  $xml->startDocument($xml_version, $xml_encoding);
  $xml->startElement($startElement);

  /**
   * Write keys in $data prefixed with @ as XML attributes, if $data is an array. When an @ prefixed key is found, a '' key is expected to indicate the element itself.
   * @param object $xml XMLWriter Object
   * @param array $data with attributes filtered out
   */
  function writeAttr(XMLWriter $xml, $data) {
    if(is_array($data)) {
      $nonAttributes = array();
      foreach($data as $key => $val) {
        //handle an attribute with elements
        if($key[0] == '@') {
          $xml->writeAttribute(substr($key, 1), $val);
        } else if($key == '') {
          if(is_array($val)) $nonAttributes = $val;
          else $xml->text("$val");
        }

        //ignore normal elements
        else $nonAttributes[$key] = $val;
      }
      return $nonAttributes;
    }
    else return $data;
  }

  /**
   * Write XML as per Associative Array
   * @param object $xml XMLWriter Object
   * @param array $data Associative Data Array
   */
  function writeEl(XMLWriter $xml, $data) {
    foreach($data as $key => $value) {
      if(is_array($value) && isset($value[0])) { //numeric array
        foreach($value as $itemValue){
          if(is_array($itemValue)) {
            $xml->startElement($key);
            $itemValue = writeAttr($xml, $itemValue);
            writeEl($xml, $itemValue);
            $xml->endElement();
          } else {
            $itemValue = writeAttr($xml, $itemValue);
            $xml->writeElement($key, "$itemValue");
          }
        }
      } else if(is_array($value)) { //associative array
        $xml->startElement($key);
        $value = writeAttr($xml, $value);
        writeEl($xml, $value);
        $xml->endElement();
      } else { //scalar
        $value = writeAttr($xml, $value);
        $xml->writeElement($key, "$value");
      }
    }
  }
  writeEl($xml, $data);

  $xml->endElement();//write end element
  //returns the XML results
  return $xml->outputMemory(true);
} 
```

所以你可以转换这个：

```
$mArray["invitations"]["user"][0]["@name"] = "paco";
$mArray["invitations"]["user"][0][""]["amigos"][0] = 82;
$mArray["invitations"]["user"][0][""]["amigos"][1] = 29;
$mArray["invitations"]["user"][0][""]["amigos"][2] = 6;

$mArray["invitations"]["user"][1]["@name"] = "jose";
$mArray["invitations"]["user"][1][""]["amigos"][0] = 43;
$mArray["invitations"]["user"][1][""]["amigos"][1]["tuyos"] = 32;
$mArray["invitations"]["user"][1][""]["amigos"][1]["mios"] = 79;
$mArray["invitations"]["user"][1][""]["amigos"][2] = 11;

$mArray["invitations"]["user"][2]["@name"] = "luis";
$mArray["invitations"]["user"][2][""]["amigos"][0] = 65; 
```

进入这个 xml：

```
<invitations>
  <user name="paco">
    <amigos>82</amigos>
    <amigos>29</amigos>
    <amigos>6</amigos>
  </user>
  <user name="jose">
    <amigos>43</amigos>
    <amigos>
      <tuyos>32</tuyos>
      <mios>79</mios>
    </amigos>
    <amigos>11</amigos>
  </user>
  <user name="luis">
    <amigos>65</amigos>
  </user>
</invitations> 
```

谢谢天使。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-06-28T15:12:28.130

根据这里的答案，我制作了 github repo [https://github.com/jmarceli/array2xml](https://github.com/jmarceli/array2xml)

也许不是互联网上最漂亮的 repo，但代码似乎运行良好。

这是可以使用的代码：

```
// Based on: http://stackoverflow.com/questions/99350/passing-php-associative-arrays-to-and-from-xml
class ArrayToXML {
  private $version;
  private $encoding;
  /*
   * Construct ArrayToXML object with selected version and encoding 
   *
   * for available values check XmlWriter docs http://www.php.net/manual/en/function.xmlwriter-start-document.php
   * @param string $xml_version XML Version, default 1.0
   * @param string $xml_encoding XML Encoding, default UTF-8
   */
  public function __construct($xmlVersion = '1.0', $xmlEncoding = 'UTF-8') {
    $this->version = $xmlVersion;
    $this->encoding = $xmlEncoding;
  }
  /**
   * Build an XML Data Set
   *
   * @param array $data Associative Array containing values to be parsed into an XML Data Set(s)
   * @param string $startElement Root Opening Tag, default data
   * @return string XML String containig values
   * @return mixed Boolean false on failure, string XML result on success
   */
  public function buildXML($data, $startElement = 'data'){
    if(!is_array($data)){
      $err = 'Invalid variable type supplied, expected array not found on line '.__LINE__." in Class: ".__CLASS__." Method: ".__METHOD__;
      trigger_error($err);
      //if($this->_debug) echo $err;
      return false; //return false error occurred
    }
    $xml = new XmlWriter();
    $xml->openMemory();
    $xml->startDocument($this->version, $this->encoding);
    $xml->startElement($startElement);
    $this->writeEl($xml, $data);
    $xml->endElement();//write end element
    //returns the XML results
    return $xml->outputMemory(true);
  }
  /**
   * Write keys in $data prefixed with @ as XML attributes, if $data is an array. 
   * When an @ prefixed key is found, a '%' key is expected to indicate the element itself, 
   * and '#' prefixed key indicates CDATA content
   *
   * @param object $xml XMLWriter Object
   * @param array $data with attributes filtered out
   */
  protected function writeAttr(XMLWriter $xml, $data) {
    if(is_array($data)) {
      $nonAttributes = array();
      foreach($data as $key => $val) {
        //handle an attribute with elements
        if($key[0] == '@') {
          $xml->writeAttribute(substr($key, 1), $val);
        } else if($key[0] == '%') {
          if(is_array($val)) $nonAttributes = $val;
          else $xml->text($val);
        } elseif($key[0] == '#') {
          if(is_array($val)) $nonAttributes = $val;
          else {
            $xml->startElement(substr($key, 1));
            $xml->writeCData($val);
            $xml->endElement();
          }
        }
        //ignore normal elements
        else $nonAttributes[$key] = $val;
      }
      return $nonAttributes;
    }
    else return $data;
  }
  /**
   * Write XML as per Associative Array
   *
   * @param object $xml XMLWriter Object
   * @param array $data Associative Data Array
   */
  protected function writeEl(XMLWriter $xml, $data) {
    foreach($data as $key => $value) {
      if(is_array($value) && !$this->isAssoc($value)) { //numeric array
        foreach($value as $itemValue){
          if(is_array($itemValue)) {
            $xml->startElement($key);
            $itemValue = $this->writeAttr($xml, $itemValue);
            $this->writeEl($xml, $itemValue);
            $xml->endElement();
          } else {
            $itemValue = $this->writeAttr($xml, $itemValue);
            $xml->writeElement($key, "$itemValue");
          }
        }
      } else if(is_array($value)) { //associative array
        $xml->startElement($key);
        $value = $this->writeAttr($xml, $value);
        $this->writeEl($xml, $value);
        $xml->endElement();
      } else { //scalar
        $value = $this->writeAttr($xml, $value);
        $xml->writeElement($key, "$value");
      }
    }
  }
  /*
   * Check if array is associative with string based keys
   * FROM: http://stackoverflow.com/questions/173400/php-arrays-a-good-way-to-check-if-an-array-is-associative-or-sequential/4254008#4254008
   *
   * @param array $array Array to check
   */
  protected function isAssoc($array) {
    return (bool)count(array_filter(array_keys($array), 'is_string'));
  }
} 
```

之后，只需使用`ArrayToXML`该类。例子：

```
$xml = new ArrayToXML();
print $xml->buildXML($input); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-11T05:48:30.590

下面的类使用simplexml来实现相同的，你只需要遍历数组并调用ximplexml的addchild。

[http://snipplr.com/view.php?codeview&id=3491](http://snipplr.com/view.php?codeview&id=3491)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-09-13T15:54:06.810

从 xml 字符串获取 assoc 数组的最简单方法：

```
<?
$data_array = (array) simplexml_load_string($xml_string);
?> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-28T08:32:19.927

```
/**
 * Write XML as per Associative Array
 * @param object $xml XMLWriter Object
 * @param array $data Associative Data Array
 */
function writeXmlRecursive(XMLWriter $xml, $data){
    foreach($data as $key => $value){
        if (is_array($value) && isset($value[0])){
            $xml->startElement($key);
            foreach($value as $itemValue){

                if(is_array($itemValue)){
                    writeXmlRecursive($xml, $itemValue);
                }
                else
                {
                    $xml->writeElement($key, $itemValue."");
                }
            }
            $xml->endElement();

        }else if(is_array($value)){
            $xml->startElement($key);
            writeXmlRecursive($xml, $value);
            $xml->endElement();
            continue;
        }

        if (!is_array($value)){
            $xml->writeElement($key, $value."");
        }
    }
} 
```

这是最终版本，它给了我想要的 4 个嵌套级别的数组

```
<items>
<item>
  <id_site>59332</id_site>
  <id>33</id>
  <code>196429985</code>
  <tombid>23</tombid>
  <tombcode>196429985</tombcode>
  <religion></religion>
  <lastname>lastname</lastname>
  <firstname>name</firstname>
  <patronymicname>patronymicname</patronymicname>
  <sex>1</sex>
  <birthday>2</birthday>
  <birthmonth>4</birthmonth>
  <birthyear>1946</birthyear>
  <deathday>13</deathday>
  <deathmonth>5</deathmonth>
  <deathyear>2006</deathyear>
  <s_comments></s_comments>
  <graveyard>17446</graveyard>
  <latitude></latitude>
  <longitude></longitude>
  <images>
   <image>
    <siteId>52225</siteId>
    <fileId>62</fileId>
    <prefix>0</prefix>
    <path>path</path>
   </image>
   <image>
    <siteId>52226</siteId>
    <fileId>63</fileId>
    <prefix>0</prefix>
    <path>path</path>
   </image>
  </images>
 </item>
<items> 
```

# graphics - 如何测试线段是否与二维中的轴对齐矩形相交？

> ID：99353
> 
> 赞同：39
> 
> 时间：2008-09-19T03:39:35.117
> 
> 标签：graphics, geometry, 2d

如何测试线段是否与二维中的轴对齐矩形相交？该段由其两端定义：p1，p2。矩形由左上角和右下角点定义。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-15T21:07:35.647

最初的海报想要检测线段和多边形之间的交点。没有必要找到交叉口，如果有的话。如果这就是你的意思，你可以做的工作比 Liang-Barsky 或 Cohen-Sutherland 少：

令线段端点为 p1=(x1 y1) 和 p2=(x2 y2)。
让矩形的角为 (xBL yBL) 和 (xTR yTR)。

那么你所要做的就是

A. 检查矩形的所有四个角是否都在直线的同一侧。通过 p1 和 p2 的直线的隐式方程为：

F(xy) = (y2-y1)*x + (x1-x2)*y + (x2*y1-x1*y2)

如果 F(xy) = 0，则 (xy) 在线。
如果 F(xy) > 0，则 (xy) 位于该线的“上方”。
如果 F(xy) < 0，则 (xy) 位于该线的“下方”。

将所有四个角都代入 F(xy)。如果它们都是负面的或都是正面的，那么就没有交集。如果有些是正面的，有些是负面的，请转到步骤 B。

B. 将端点投影到 x 轴上，并检查线段的阴影是否与多边形的阴影相交。在 y 轴上重复：

如果 (x1 > xTR 和 x2 > xTR)，则没有交点（直线在矩形的右侧）。
如果 (x1 < xBL 和 x2 < xBL)，则没有交点（直线在矩形的左侧）。
如果（y1 > yTR 和 y2 > yTR），则没有交点（直线在矩形上方）。
如果（y1 < yBL 和 y2 < yBL），则没有交点（直线在矩形下方）。
否则，有一个交叉点。做 Cohen-Sutherland 或您问题的其他答案中提到的任何代码。

当然，你可以先做 B，然后做 A。

阿莱霍

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-19T07:07:52.417

写了非常简单且有效的解决方案：

```
 bool SegmentIntersectRectangle(double a_rectangleMinX,
                                 double a_rectangleMinY,
                                 double a_rectangleMaxX,
                                 double a_rectangleMaxY,
                                 double a_p1x,
                                 double a_p1y,
                                 double a_p2x,
                                 double a_p2y)
  {
    // Find min and max X for the segment

    double minX = a_p1x;
    double maxX = a_p2x;

    if(a_p1x > a_p2x)
    {
      minX = a_p2x;
      maxX = a_p1x;
    }

    // Find the intersection of the segment's and rectangle's x-projections

    if(maxX > a_rectangleMaxX)
    {
      maxX = a_rectangleMaxX;
    }

    if(minX < a_rectangleMinX)
    {
      minX = a_rectangleMinX;
    }

    if(minX > maxX) // If their projections do not intersect return false
    {
      return false;
    }

    // Find corresponding min and max Y for min and max X we found before

    double minY = a_p1y;
    double maxY = a_p2y;

    double dx = a_p2x - a_p1x;

    if(Math::Abs(dx) > 0.0000001)
    {
      double a = (a_p2y - a_p1y) / dx;
      double b = a_p1y - a * a_p1x;
      minY = a * minX + b;
      maxY = a * maxX + b;
    }

    if(minY > maxY)
    {
      double tmp = maxY;
      maxY = minY;
      minY = tmp;
    }

    // Find the intersection of the segment's and rectangle's y-projections

    if(maxY > a_rectangleMaxY)
    {
      maxY = a_rectangleMaxY;
    }

    if(minY < a_rectangleMinY)
    {
      minY = a_rectangleMinY;
    }

    if(minY > maxY) // If Y-projections do not intersect return false
    {
      return false;
    }

    return true;
  } 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-19T03:51:35.290

由于您的矩形是对齐的，Liang-Barsky 可能是一个很好的解决方案。如果这里的速度很重要，它比 Cohen-Sutherland 快。

[Siggraph 解释](http://www.siggraph.org/education/materials/HyperGraph/scanline/clipping/cliplb.htm)
[另一个很好](http://www.cs.helsinki.fi/group/goa/viewing/leikkaus/intro.html)
[的描述 当然，维基百科](http://en.wikipedia.org/wiki/Liang-Barsky)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-12T16:57:45.013

您还可以从该段中创建一个矩形并测试另一个矩形是否与它碰撞，因为它只是一系列比较。来自 pygame 来源：

```
def _rect_collide(a, b):
    return a.x + a.w > b.x and b.x + b.w > a.x and \
           a.y + a.h > b.y and b.y + b.h > a.y 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-19T03:42:10.523

使用[Cohen-Sutherland 算法](http://www.cc.gatech.edu/grads/h/Hao-wei.Hsieh/Haowei.Hsieh/mm.html#sec2_3)。

它用于剪辑，但可以针对此任务进行微调。它将 2D 空间划分为一个井字棋盘，以您的矩形为“中心正方形”。
然后它会检查您的线的两个点中的每一个都在九个区域中的哪个区域。

*   如果两个点都是左、右、上或下，你会轻易拒绝。
*   如果任何一点在里面，你都会接受。
*   在极少数情况下，您可以根据矩形所在的区域进行数学运算，以与矩形的任何可能相交的边相交。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-03-22T04:50:23.920

或者只是使用/复制 Java 方法中已经存在的代码

```
java.awt.geom.Rectangle2D.intersectsLine(double x1, double y1, double x2, double y2) 
```

为方便起见，这里是转换为静态后的方法：

```
/**
 * Code copied from {@link java.awt.geom.Rectangle2D#intersectsLine(double, double, double, double)}
 */
public class RectangleLineIntersectTest {
    private static final int OUT_LEFT = 1;
    private static final int OUT_TOP = 2;
    private static final int OUT_RIGHT = 4;
    private static final int OUT_BOTTOM = 8;

    private static int outcode(double pX, double pY, double rectX, double rectY, double rectWidth, double rectHeight) {
        int out = 0;
        if (rectWidth <= 0) {
            out |= OUT_LEFT | OUT_RIGHT;
        } else if (pX < rectX) {
            out |= OUT_LEFT;
        } else if (pX > rectX + rectWidth) {
            out |= OUT_RIGHT;
        }
        if (rectHeight <= 0) {
            out |= OUT_TOP | OUT_BOTTOM;
        } else if (pY < rectY) {
            out |= OUT_TOP;
        } else if (pY > rectY + rectHeight) {
            out |= OUT_BOTTOM;
        }
        return out;
    }

    public static boolean intersectsLine(double lineX1, double lineY1, double lineX2, double lineY2, double rectX, double rectY, double rectWidth, double rectHeight) {
        int out1, out2;
        if ((out2 = outcode(lineX2, lineY2, rectX, rectY, rectWidth, rectHeight)) == 0) {
            return true;
        }
        while ((out1 = outcode(lineX1, lineY1, rectX, rectY, rectWidth, rectHeight)) != 0) {
            if ((out1 & out2) != 0) {
                return false;
            }
            if ((out1 & (OUT_LEFT | OUT_RIGHT)) != 0) {
                double x = rectX;
                if ((out1 & OUT_RIGHT) != 0) {
                    x += rectWidth;
                }
                lineY1 = lineY1 + (x - lineX1) * (lineY2 - lineY1) / (lineX2 - lineX1);
                lineX1 = x;
            } else {
                double y = rectY;
                if ((out1 & OUT_BOTTOM) != 0) {
                    y += rectHeight;
                }
                lineX1 = lineX1 + (y - lineY1) * (lineX2 - lineX1) / (lineY2 - lineY1);
                lineY1 = y;
            }
        }
        return true;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T03:45:09.410

快速谷歌搜索弹出一个页面，其中包含用于测试交叉点的 C++ 代码。

基本上，它测试线条与每个边框或矩形之间的交点。

[矩形和直线相交代码](http://nuttybar.drama.uga.edu/pipermail/dir3d-l/2003-October/004323.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-04T19:20:16.663

这是@metamal答案的javascript版本

```
var isRectangleIntersectedByLine = function (
  a_rectangleMinX,
  a_rectangleMinY,
  a_rectangleMaxX,
  a_rectangleMaxY,
  a_p1x,
  a_p1y,
  a_p2x,
  a_p2y) {

  // Find min and max X for the segment
  var minX = a_p1x
  var maxX = a_p2x

  if (a_p1x > a_p2x) {
    minX = a_p2x
    maxX = a_p1x
  }

  // Find the intersection of the segment's and rectangle's x-projections
  if (maxX > a_rectangleMaxX)
    maxX = a_rectangleMaxX

  if (minX < a_rectangleMinX)
    minX = a_rectangleMinX

  // If their projections do not intersect return false
  if (minX > maxX)
    return false

  // Find corresponding min and max Y for min and max X we found before
  var minY = a_p1y
  var maxY = a_p2y

  var dx = a_p2x - a_p1x

  if (Math.abs(dx) > 0.0000001) {
    var a = (a_p2y - a_p1y) / dx
    var b = a_p1y - a * a_p1x
    minY = a * minX + b
    maxY = a * maxX + b
  }

  if (minY > maxY) {
    var tmp = maxY
    maxY = minY
    minY = tmp
  }

  // Find the intersection of the segment's and rectangle's y-projections
  if(maxY > a_rectangleMaxY)
    maxY = a_rectangleMaxY

  if (minY < a_rectangleMinY)
    minY = a_rectangleMinY

  // If Y-projections do not intersect return false
  if(minY > maxY)
    return false

  return true
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-26T19:12:33.790

PHP中的编码示例（我正在使用一个对象模型，该模型具有诸如getLeft（），getRight（），getTop（），getBottom（）之类的方法来获取多边形的外部坐标，并且还具有getWidth（）和getHeight () - 根据输入的参数，它会计算并缓存未知数 - 即我可以用 x1,y1 和 ... w,h 或 x2,y2 创建一个多边形，它可以计算其他的）

我使用“n”来指定正在检查重叠的“新”项目（$nItem 是我的多边形对象的一个​​实例）-要再次测试的项目 [这是一个 bin/sort knapsack 程序] 在一个由以下组成的数组中（相同）多边形对象的更多实例。

```
public function checkForOverlaps(BinPack_Polygon $nItem) {
  // grab some local variables for the stuff re-used over and over in loop
  $nX = $nItem->getLeft();
  $nY = $nItem->getTop();
  $nW = $nItem->getWidth();
  $nH = $nItem->getHeight();
  // loop through the stored polygons checking for overlaps
  foreach($this->packed as $_i => $pI) {
    if(((($pI->getLeft()  - $nW) < $nX) && ($nX < $pI->getRight())) &&
       ((($pI->getTop()  - $nH) < $nY) && ($nY < $pI->getBottom()))) {
      return false;
    }
  }
  return true;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T04:11:53.213

我做了一点餐巾纸解决方案..

接下来找到 m 和 c，因此方程**y = mx + c**

```
y = (Point2.Y - Point1.Y) / (Point2.X - Point1.X) 
```

替换 P1 坐标现在找到 c

现在对于一个矩形顶点，将 X 值代入直线方程，得到 Y 值并查看 Y 值是否位于如下所示的矩形边界内

（您可以找到矩形的常数值 X1、X2、Y1、Y2，这样）

```
X1 <= x <= X2 & 
Y1 <= y <= Y2 
```

如果 Y 值满足上述条件并且位于 (Point1.Y, Point2.Y) 之间 - 我们有一个交集。如果这一个未能进行切割，请尝试每个顶点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-07-27T15:49:59.190

我的解决方案的一些示例代码（在 php 中）：

```
// returns 'true' on overlap checking against an array of similar objects in $this->packed
public function checkForOverlaps(BinPack_Polygon $nItem) {
  $nX = $nItem->getLeft();
  $nY = $nItem->getTop();
  $nW = $nItem->getWidth();
  $nH = $nItem->getHeight();
  // loop through the stored polygons checking for overlaps
  foreach($this->packed as $_i => $pI) {
    if(((($pI->getLeft() - $nW) < $nX) && ($nX < $pI->getRight())) && ((($pI->getTop() - $nH) < $nY) && ($nY < $pI->getBottom()))) {
      return true;
    }
  }
  return false;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-26T18:10:40.550

我正在研究一个类似的问题，这就是我想出的。我首先比较了边缘并意识到了一些事情。如果落在第一个框的相对轴内的边的中点在同一轴上第一个框的外部点的该边长度的一半之内，则该边在某处存在交点。但这是一维思考，需要查看第二个盒子的每一侧才能弄清楚。

我突然想到，如果你找到第二个盒子的“中点”并比较中点的坐标，看看它们是否落在第一个盒子外部尺寸的边（第二个盒子）的 1/2 长度内，然后某处有一个交叉点。

```
i.e. box 1 is bounded by x1,y1 to x2,y2
box 2 is bounded by a1,b1 to a2,b2

the width and height of box 2 is:
w2 = a2 - a1   (half of that is w2/2)
h2 = b2 - b1   (half of that is h2/2)
the midpoints of box 2 are:
am = a1 + w2/2
bm = b1 + h2/2

So now you just check if
(x1 - w2/2) < am < (x2 + w2/2) and (y1 - h2/2) < bm < (y2 + h2/2) 
then the two overlap somewhere.
If you want to check also for edges intersecting to count as 'overlap' then
 change the < to <= 
```

当然，您也可以轻松地进行比较（检查框 1 的中点是否在框 2 外部尺寸的 1/2 长度内）

甚至更简化 - 将中点移动一半长度，它与该框的原点相同。这意味着您现在可以检查该点是否落在您的边界范围内，并通过将平原向上和向左移动，下角现在是第一个框的下角。更少的数学：

```
(x1 - w2) < a1 < x2
&&
(y1 - h2) < b1 < y2
[overlap exists] 
```

或非替代：

```
( (x1-(a2-a1)) < a1 < x2 ) && ( (y1-(b2-b1)) < b1 < y2 ) [overlap exists]
( (x1-(a2-a1)) <= a1 <= x2 ) && ( (y1-(b2-b1)) <= b1 <= y2 ) [overlap or intersect exists] 
```

# java - 关于java如何执行字节码有很好的参考吗？

> ID：99389
> 
> 赞同：0
> 
> 时间：2008-09-19T03:46:32.713
> 
> 标签：java, bytecode

我对 java 如何组织内存和执行代码（比如放入堆栈或堆中的内容）感兴趣，从 main 开始，到分配变量、调用函数、传递参数、返回值、实例化对象等。有有人找到了一篇好的、适合初学者的文章/参考资料吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T03:48:58.930

规范参考是[JVM 规范](http://java.sun.com/docs/books/jvms/)。但是，不同的 JVM 可以以不同的方式实现规范。您还可以查看开源 Java 平台实现[OpenJDK](http://openjdk.java.net/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T03:50:22.157

我不确切知道他们如何执行他们的字节码，但我发现这个[链接](http://www.ibm.com/developerworks/ibm/library/it-haggar_bytecode/)描述了 java 的字节码。我不确定它是否有帮助，但至少它是开始的。

引用：

> 本文让您了解 Java 字节码，这将使您成为更好的程序员。就像 C 或 C++ 编译器将源代码翻译成汇编代码一样，Java 编译器将 Java 源代码翻译成字节码。Java 程序员应该花时间了解字节码是什么，它是如何工作的，最重要的是，Java 编译器正在生成什么字节码。在某些情况下，生成的字节码不是您所期望的。

# svn - 如何修复这个 Subversion MKCOL 错误？

> ID：99391
> 
> 赞同：71
> 
> 时间：2008-09-19T03:46:59.887
> 
> 标签：svn

当我提交时，我从 Subversion 收到此错误：

```
bash-2.05b$ svn commit -m "testing subversion, still"
Adding         baz
svn: Commit failed (details follow):
svn: MKCOL of '/viper/!svn/wrk/6b9bcd38-b2fe-0310-95ff-9d1a44098866/sandboxes/ohammersmith/trunk/baz': 405 Method Not Allowed (http://svn.example.com) 
```

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-09-19T03:50:18.290

当您添加了其他人也添加并已提交的目录时，就会发生这种情况。提交时的错误消息确实令人困惑，但如果您`svn up`改为执行此操作，您会看到以下消息：

```
bash-2.05b$ svn up
svn: Failed to add directory 'baz': object of the same name already exists 
```

要解决此问题，请删除您的目录（或将其移到一边）并执行`svn update`以获取服务器上的版本并重新进行更改。

作为一般规则，请务必这样做，`svn update`因为错误消息往往更有帮助。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-06-22T10:38:44.463

当您添加了其他人也添加并已提交的目录时，就会发生这种情况。

这表明冲突，但在目录级别（只是为了理解）。

要解决此问题，只需`svn update`在提交更改之前执行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-06T06:39:33.147

有时会发生这种情况。解决方案：当您创建任何新存储库时，必须添加 read.me 文件以创建默认分支（主干），以便它找到合适的路径来推送您的东西。如果您创建了一个存储库并且不添加读取。我，如果它是空白的，那么上传一个像 test.txt 这样的文件，并将上传的文件作为本地文件夹中的最新更新，然后尝试从那个更新的文件夹中推送你的代码。这对我有用。

# objective-c - 如何检查 Cocoa 和 Objective-C 中是否存在文件夹？

> ID：99395
> 
> 赞同：45
> 
> 时间：2008-09-19T03:47:45.580
> 
> 标签：objective-c, cocoa

如何使用Objective-C检查Cocoa中是否存在文件夹（目录）？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-09-19T03:52:50.310

使用`NSFileManager`'s`fileExistsAtPath:isDirectory:`方法。[在此处](https://developer.apple.com/documentation/foundation/nsfilemanager/1410277-fileexistsatpath?language=objc)查看 Apple 的文档。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-09-23T08:58:39.170

Apple 在 NSFileManager.h 中提供了一些关于检查文件系统的好建议：

“尝试操作（例如加载文件或创建目录）并优雅地处理错误比尝试提前确定操作是否成功要好得多。尝试根据当前状态来判断行为面对文件系统竞争条件，文件系统或文件系统上的特定文件正在鼓励奇怪的行为。”

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-19T03:56:23.483

[NSFileManager 文件ExistsAtPath:isDirectory:]

```
Returns a Boolean value that indicates whether a specified file exists.

- (BOOL)fileExistsAtPath:(NSString *)path isDirectory:(BOOL *)isDirectory

Parameters
path
The path of a file or directory. If path begins with a tilde (~), it must first be expanded with stringByExpandingTildeInPath, or this method will return NO.

isDirectory
Upon return, contains YES if path is a directory or if the final path element is a symbolic link that points to a directory, otherwise contains NO. If path doesn’t exist, the return value is undefined. Pass NULL if you do not need this information.

Return Value
YES if there is a file or directory at path, otherwise NO. If path specifies a symbolic link, this method traverses the link and returns YES or NO based on the existence of the file or directory at the link destination. 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-21T12:10:21.783

NSFileManager 是查找文件相关 API 的最佳位置。您需要的特定 API 是 [`- fileExistsAtPath:isDirectory:`.](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsfilemanager_Class/Reference/Reference.html)

例子：

```
NSString *pathToFile = @"...";
BOOL isDir = NO;
BOOL isFile = [[NSFileManager defaultManager] fileExistsAtPath:pathToFile isDirectory:&isDir];

if(isFile)
{
    //it is a file, process it here how ever you like, check isDir to see if its a directory 
}
else
{
    //not a file, this is an error, handle it!
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-11T19:09:01.833

如果您有一个`NSURL`对象`path`，最好使用路径将其转换为`NSString`.

```
NSFileManager*fm = [NSFileManager defaultManager];

NSURL* path = [[[fm URLsForDirectory:NSDocumentDirectory 
                           inDomains:NSUserDomainMask] objectAtIndex:0]                           
                                 URLByAppendingPathComponent:@"photos"];

NSError *theError = nil;
if(![fm fileExistsAtPath:[path path]]){
    NSLog(@"dir doesn't exists");
}else
    NSLog(@"dir exists"); 
```

# flash - 在网站上嵌入视频最简单的 FLV 播放器是什么？

> ID：99406
> 
> 赞同：34
> 
> 时间：2008-09-19T03:49:16.700
> 
> 标签：flash, video, flv

我有已转换为 FLV 格式的视频。我宁愿在自己的网站上托管它，也不愿使用 YouTube 之类的服务。最容易使用的播放器是什么？我想将播放器的 .swf 文件放在我的服务器上的某个位置，并将视频作为参数提供给它。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-19T03:51:32.403

看看[OSflv](http://www.osflv.com/)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-03T14:55:07.007

[http://flv-player.net/](http://flv-player.net/)

*   从极简到功能丰富的选项。
*   简单但非常有效的 HTML 生成器让您可以使用他们的代码进行演示
*   .swf 小至 5KB
*   Creative Commons BY SA 和 MPL 1.1 许可证

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-19T06:22:30.530

JW FLV 播放器：http: [//www.jeroenwijering.com/? item=JW_FLV_Media_Player](http://www.jeroenwijering.com/?item=JW_FLV_Media_Player)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-06T22:41:29.513

我还没有尝试过**[Flowplayer](http://flowplayer.org)**似乎有据可查

它在**[北极初创公司](http://www.arcticstartup.com/2009/02/12/flowplayer-the-next-open-source-success/)**中出现，使用开源许可证的唯一限制是显示他们的徽标

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-20T14:09:00.607

这可能是显而易见的答案，但如果您有一个视频需要快速投放到网站上，那么 FLVPlayBack 组件真的很棒。将它拖到舞台上 - 选择一个控制面板 - 双击控件以使用 Flash 绘图工具进行编辑 - 发布到网站。您可能必须使用 FlashVar 将 url 获取到 url 中，但这相当简单......

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/video/FLVPlayback.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/fl/video/FLVPlayback.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-13T15:01:54.700

我更喜欢直接来自 Adob​​e 的新开源播放器：Strobe Media Playback。它是完全免费和开源的，BSD 许可证。具有用于商业化和 CDN 的插件。有 youtube 插件。您可以轻松创建新主题。

但是 - 此时的文档不是很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T04:19:12.307

我试过很多 FLV 播放器，我遇到了 Applian FLV 播放器。这个一定是我最好的。它重量轻，免费提供可选的录音机，没有间谍软件等。[在这里查看](http://www.applian.com/flvplayer/)

但是，有了这个，您将无法将其嵌入到您的常规网页中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T06:28:16.287

我个人是 JW 的忠实粉丝，虽然我听说 Floplayer 也不错。JW 有大量的功能并且有一个非常干净的界面。在线设置视频只需不到一分钟；我自己托管所有视频，主要是视频游戏剪辑和 x264 演示。（[例1](http://mirror05.x264.nl/Dark/Flash/mof.html) [例2](http://mirror05.x264.nl/Dark/Flash/index_lowbitrate.html) [例3](http://mirror05.x264.nl/Dark/Flash/sademo.html) [例4](http://mirror05.x264.nl/Dark/Flash/extra.html) [例5](http://mirror05.x264.nl/Dark/Flash/psytouhou.html)）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T12:14:47.583

我使用[JW FLV Player](http://www.jeroenwijering.com/?item=JW_FLV_Media_Player)，它非常好。它还支持 FLV 流媒体，因此如果您将 mod_flv 与 Lighttpd 一起使用，例如，您可以制作自己的小 youtube。还有一个[用于 apache 的 mod_flv](http://www.mosalov.com/wiki/Flash_streaming_with_mod_flvx#Install_mod_flvx)，您还可以使用[php](http://xmoov.com/xmoov-php/)（或您选择的任何语言）脚本来启用流式传输。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T12:23:04.100

[任何 FLV 播放器](http://www.any-flv-player.com)，小巧易用

# documentation - 存储软件文档的最佳方式是什么？

> ID：99419
> 
> 赞同：4
> 
> 时间：2008-09-19T03:51:03.873
> 
> 标签：documentation

一个明显的答案是“内部维基”。用于软件文档的 wiki 的优缺点是什么？还有其他建议吗？你用什么来做你的软件文档？

[Loren Segal](https://stackoverflow.com/users/6436/loren-segal) - 不幸的是，我们不支持任何 doc 工具来从源代码注释中编译信息，但我同意这将是存储技术文档的最佳方式。我的问题是关于各种文档 - 从系统管理员类型到用户文档。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T03:55:29.337

这是一个非常开放的问题，取决于许多因素。

一般来说，如果您使用具有良好文档生成工具的语言（javadoc、doxygen、MS 的 C# 的东西），您应该在您的方法之上编写文档并让您的工具生成页面。优点是您将文本的*源*代码与代码一起保留，这意味着它在逻辑上正确的位置进行组织，并且在您更改方法的行为时可以轻松编辑。

如果您没有良好的文档工具支持或无法访问源代码，那么 wiki 并不是一个坏主意，但它们是上述方法的第二选择。

注意：我在这里只谈论代码文档。其他工件显然不能与代码一起存储——wiki 是放置这些文档的好地方。或者，如果您使用一些 CMS，您可以简单地将它们`docs/`作为文本/pdf/任何文件提交到某个文件夹中，以便通过存储库进行编辑。这样做的好处是，如果它被移动，它们会留在存储库中，而 wiki 不会（必要）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T04:58:52.290

工具很重要，但不要太拘泥于寻找神奇的工具。我还没有找到任何工具具有“使用微小的隐形精灵神奇地记录所有内容”复选框。:-)

wiki 可以正常工作。或共享点。或谷歌文档。或者您可以使用 SVN 存储库。如果你真的需要的话，你可以用钢笔、信纸和文件柜来做这件事。（我真的不建议这样做！）

最重要的关键是您需要在整个组织中获得支持。在很多商店发生的情况是，他们花费大量时间和金钱在像 Sharepoint 这样的花哨的解决方案上，然后每个人都虔诚地使用它大约两周，然后人们忙于达到最新的里程碑，这是最后一个任何人都听说过。

根据您的组织、领域、您开发的产品类型等，有一些解决方案，但您需要以一种或另一种方式设置系统并**使用**它。任命某人为官方文档沙皇，给他们一个线索，并告诉他们每次他们说“哦，是的，我将在下周完成记录......”时打他们的头。如果这就是它所需要的。:-)

至于工具……我推荐Atlassian 的[Confluence](http://www.atlassian.com/software/confluence/)。这是一个很好的 wiki，它被设计为在企业环境中工作，它有很多漂亮的功能，它是可定制的，它与 Atlassian 的一些其他漂亮工具很好地集成，并且基本上是一个非常可靠的产品。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T04:26:16.893

«软件文档» 是一个非常笼统的术语。有《最终用户文档》、《开发人员文档》、《QA 文档》。第一个通常由合格的技术作家开发。其他的可能是从 wikis、源代码中的文档注释等动态形成的。所有这些东西的维护过程通常非常复杂，每个软件公司都遵循自己的方式。但是所有这些方式都有一个必要的一点：每个代码提交者、架构师、经理、质量保证工程师必须妥善存储每条可能对其他人有帮助的信息。如果需要，其他人必须留意这些件的存储和重新排列件。所有这些步骤都**极大地**改进了与开发过程相关的所有活动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T03:55:22.833

假设您谈论的是代码文档与用户文档，如果您不需要将代码文档分发给组织之外的承包商或合作伙伴，那么内部 wiki 非常有用。

如果您想要可分发的代码文档，Javadoc 或 DOxygen 更合适。

如果您指的是用户文档，您可能需要查看[DITA](http://en.wikipedia.org/wiki/Darwin_Information_Typing_Architecture)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T04:01:51.180

我们目前使用由外部应用程序 (PHP + PhpDocumenter) 以及各种内部 wiki 解析的内联文档。有时它充其量是痛苦的（主要是因为只有一个人更新维基或文档......）

但是，我一直在考虑使用[ikiwiki](http://ikiwiki.info/tips/integrated_issue_tracking_with_ikiwiki/)来做内部文档。它与您的源代码控制系统（包括 Git、Subversion、Mercurial、Bazaar、TLA 和 Monotone）集成，因此您的所有文档都可以跟踪您的项目。它是用 Perl 构建的，并具有广泛的插件系统（包括多种标记语言，默认为 Markdown）。此外，源代码控制系统是基于插件的，因此如果您使用的内容没有立即得到支持，您可以添加自己的。如果需要，使用您喜欢的语言，因为它也支持非 perl 插件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T04:17:30.767

我开始尝试一种方法来为这些目标做用户文档：

**Markdown/Html/Javascript/基于文件的相对链接文档**的可移植性（*可以在本地文件系统上运行，或者您可以将其放在网络服务器上*），内置的屏幕截图处理（*交互式调整大小*），以及开源以防其他人可能想用疯狂的东西做点什么。

您的文档源是用 Markdown 编写的，并在浏览器运行时通过 Javascript 呈现为 Html。

> [曼当](http://wittman.org/mandown/)  -  [http://wittman.org/mandown/](http://wittman.org/mandown/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T03:52:59.483

我的公司使用各种 Sharepoint 和一个 wiki。Sharepoint 用于特定文档，如需求、演示文稿、合同等，而 wiki 用作帮助指导开发人员存储库，以获取有关使用内部开发库的教程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T03:55:28.370

是的，我们使用 wiki，我们也使用 Google 文档。我发现 Google 文档比我尝试过的大多数 wiki 都好，而且，如果您不需要跟踪所有更改，那么您什么也不会丢失。Google docs 提供了一个很好的协作框架。

# communication - 加强开发和质量保证部门之间团队合作的最佳方式？

> ID：99442
> 
> 赞同：1
> 
> 时间：2008-09-19T03:53:05.380
> 
> 标签：communication, qa

我在一家软件开发公司的开发和 QA 部门担任系统管理员。我同样支持两支球队。最近有人问我一些关于如何改善团队间沟通的想法。

首先，从开发人员的角度来看，有哪些方法可以改善开发团队和 QA 团队之间的关系？

其次，就交互而言，您希望从系统管理员那里得到什么？让你一个人呆着？电子邮件？我是？个人办公时间？如何改善与开发人员的关系？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T04:05:18.597

共同定位并将他们视为一个跨职能团队。如果 QA 想要编写代码（如验收测试），就让他们来吧。如果开发人员想要对系统的其他部分进行 QA（而不是他们处理的代码）。让他们并让两个小组（如果您想将它们视为单独的实体）一起解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T03:57:38.850

适当的管理是一个好的开始。我想说让两个团队一起成功或失败是最重要的。您希望两者进行一些友好的竞争（一个试图发现错误，而另一个试图阻止这种情况的发生），但最终他们需要被视为同一个团队的一部分。团队午餐和其他活动总是一个好主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T03:55:58.180

尽早让 QA 人员参与进来。如果你在做敏捷，他们就是团队的一部分。即使您不是，他们仍然可以提供有价值的见解，了解如何通过使其更可测试来使代码变得更好，从而避免进一步出现问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T03:58:42.903

我工作地点的 QA 和开发团队相处得很好，因为我们在地理位置上彼此靠近。这消除了“打开缺陷-发送到开发-开发关闭缺陷”的循环，这种循环似乎助长了被动攻击性的烦恼。始终期望两组之间进行清晰和开放的沟通以及明确的期望。除此之外，标准的团队建设练习是一个好的开始。在温暖的月份，我们有部门午餐、野餐、草坪游戏等。

至于管理风格，请与您的员工交谈，看看什么对他们有用。有些人喜欢零星的更新，而另一些人则喜欢不断的反馈。您必须为您的开发人员和您做些让您感到舒适的事情。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T04:00:51.883

取决于您组织的规模，但*不要将它们视为两个独立的组*。如果您是唯一的系统管理员，我猜您的组织并不庞大。

在物理上整合它们。一个领域没有开发人员，另一个领域没有质量保证。让他们彼此相邻共享办公室/立方体。

带人出去吃午饭？把它们放在一起。抢啤酒？与两个群体的人一起做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T03:54:54.720

午餐时间的运动或餐厅用餐等非工作环境活动。

让人们在工作以外的其他事情上更好地了解彼此有助于在两个群体之间建立信任和联系。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T03:59:08.017

我认为让开发人员参与帮助开发（或帮助使用已经开发的工具）进行自动化测试是非常有益的——这样整个质量保证流程将得到改进，开发人员将对测试有更好的洞察力，而且团队将在这样做时进行更多沟通。我认为作为一名开发人员，从事这样的项目会很有趣。

# blogs - 软件写作和演讲会让你成为更好的程序员吗？

> ID：99460
> 
> 赞同：8
> 
> 时间：2008-09-19T03:55:26.000
> 
> 标签：blogs

你认为写关于软件（即拥有一个博客）和谈论软件（和概念）会让你成为一个更好的程序员吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-19T03:56:43.983

统计上是的。你只保留了大约 20% 的阅读和听到的内容，但保留了 80% 的所教内容。

通过写一些东西或教它，你强迫自己在更深层次上理解这些概念。

**更新：**

我想通过一些指向更具体数据的链接来更新这一点，以支持我多次学习过的关于学习保留率的统计数据。然而，围绕这些数字似乎存在一些[争议](http://www.willatworklearning.com/2006/05/people_remember.html)，尽管[NTL 应用行为科学研究所](http://www.ntl.org/)坚持认为已经进行了研究来支持这些数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T03:57:54.590

我相信是这样的。与教学一样，当您必须向其他人解释时，您会更牢固地掌握该主题。您可以更详细地了解您了解和不了解的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T03:57:38.083

是的。在工作队伍中，能够有效地沟通与了解语言 X 的每一个晦涩细节一样，有时甚至更重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T03:58:01.483

绝对没错。你有机会以你自己从未想过的方式受到挑战、质疑和质疑。它还让您有机会组织和展示您的想法。所有这些都会反馈到您在编写代码时所做的决定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T03:58:45.490

我的观点恰恰相反：一般来说，优秀的程序员喜欢写作和谈论软件。这表明他们对此充满热情，并且不会接受废话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T04:03:13.983

绝对地。没有经常使用的知识是没有用的。谈论技术、语言、方法、开发过程、书籍等，极大地提高了整体经验，并指出了职业发展的可能途径。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T03:57:10.003

当然，原因很简单：它挑战了你的先决条件。您可以写一篇关于 .NET 在特定情况下的完美程度的文章，却发现有人使用过它，结果却很糟糕。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T03:57:14.793

我认为这些活动的主要作用是迫使人们更彻底地研究事物和研究新事物。这会让你成为一个更好的程序员吗？我认同。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T03:58:59.593

我认为它通过可视化你的观点和阅读用户的反应来鼓励你成为一个更好的程序员。我不认为您拥有博客或可以展示您对开发知识的了解这一事实会使您天生变得更好，但它可能有助于激励您变得更好，以便您可以跟上您的帖子。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T03:59:00.903

如果您倾向于撰写或谈论软件，那么这意味着您正在考虑它并且您有意见。关心它足以编写使您成为更好的程序员。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T03:59:19.623

我认为能说会写会让你成为更好的开发者。不一定是因为它会提高你的编程技能，而是因为软件开发不仅仅是敲出代码。无论是对于公司还是开源项目，除了最小的软件之外，所有的软件都是团队产品。在这种环境下，最善于沟通的开发人员会做出最大的贡献，而不是最好的程序员。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T03:59:48.767

软件教学绝对会让你成为更好的程序员。在博客上写作并不遥远。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T04:07:20.433

我学到的关于 .NET 的大部分内容，都是在我审查它以便能够培训新手开发人员时学到的。所以，是的，谈论软件有很大帮助。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T04:10:40.127

是的。如果您得到反馈（例如，博客评论），那么就更是如此。其他人总是会想到一些你没有想到的事情，但如果你没有先说出来，他们可能永远没有机会告诉你。

# sql - 使用 UNION 查询从 ODBC 源中检索多行

> ID：99468
> 
> 赞同：1
> 
> 时间：2008-09-19T03:56:59.880
> 
> 标签：sql, sql-server, c, winapi, listview

我正在从 ODBC 源将多行检索到列表视图控件中。对于简单的 SELECT，它似乎可以很好地与 SQL_SCROLLABLE 的语句属性一起使用。如何使用 UNION 查询（​​有两个选择）执行此操作？

最有可能的服务器是 MS SQL Server（可能是 2005 年）。Win32 API 的代码是 C。

这段代码设置（我认为是）一个服务器端游标，它将数据提供给 ODBC 驱动程序，该驱动程序与 SQLFetchScroll 的位置提取大致对应，后者反过来为列表视图提供缓存。（有时也使用 SQL_FETCH_FIRST 或 SQL_FETCH_LAST）：

```
SQLSetStmtAttr(hstmt1Fetch,
               SQL_ATTR_CURSOR_SCROLLABLE，
               (SQLPOINTER)SQL_SCROLLABLE,
               SQL_IS_INTEGER);
SQLSetStmtAttr(hstmt1Fetch,
               SQL_ATTR_CURSOR_SENSITIVITY，
               (SQLPOINTER)SQL_INSENSITIVE,
               SQL_IS_INTEGER);
...
retcode = SQLGetStmtAttr(hstmt1Fetch,
                         SQL_ATTR_ROW_NUMBER，
                         &CurrentRowNumber,
                         SQL_IS_UINTEGER，
                         无效的）;
...
retcode = SQLFetchScroll（hstmt1Fetch，SQL_FETCH_ABSOLUTE，位置）；

```

（上面是单个 SELECT 的工作代码的片段）。

这是最好的方法吗？鉴于我需要检索最后一行以获取行数并填充结束缓冲区，有没有更好的方法呢？（我可以只使用向前滚动吗？）

假设以上是肯定的，我如何使用 UNION 查询获得相同的结果？

后期编辑：联合查询的问题在于它有效地强制仅向前滚动，这会破坏 SQLFetchScroll（hstmt1Fetch，SQL_FETCH_ABSOLUTE，位置）。答案是我怀疑：“你不能”。这实际上意味着重新设计数据库以包含视图或单个表来替换 UNION。但如果我错过了什么，我会留下这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T04:25:10.653

你不能在为你进行联合查询的数据库服务器上定义一个视图，所以从客户端代码来看，它看起来就像一个单一的选择？

如果你不能，你能不能把联合操作作为你选择的一部分，例如

```
select some_fields from table1
union
select same_fields from table2 
```

并将结果视为单个结果集？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-28T14:57:44.423

如果问题只是需要获取最后一行来获取行数并缓存最后几行（我假设如果选择中有一百万个项目，那么您没有将所有项目都填充到下拉列表中）那么您也许可以利用`ROW_NUMBER()`SQL Server 2005 的功能

你可以：

```
select count(*) 
from (select blah UNION select blah) 
```

获取行数。

然后：

```
select ROW_NUMBER() as rownum,blah 
from (select blah UNION select blah) 
where rownum between minrow and maxrow 
```

只获取您需要显示/缓存的行

但认真的人，如果您从一百万行表中选择项目，您可能需要考虑不同的机制

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-28T16:53:34.770

您是否尝试过使用`union`来制作派生表？

```
select * from 
(select field1, field from table1
union all
slect field1, filed2 from table2) a 
```

# c++ - 如何处理被认为更改危险但稳定的代码？

> ID：99474
> 
> 赞同：2
> 
> 时间：2008-09-19T03:57:34.497
> 
> 标签：c++, svn, refactoring

处理一个可以访问稳定但没有那么漂亮代码、很容易引入错误的大团队的最佳方法是什么？

我正在寻找类似于 SVN 锁定文件的东西。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-19T04:01:01.773

如果您还没有单元测试，请编写单元测试。然后开始重构，并在每次提交时继续进行回归测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T04:05:32.573

告诉他们别管它。

它有效，改变它除了美化它有什么好处（并且潜在的成本很高）所以你只需要解释成本/收益分析。

我希望您的开发人员足够聪明地理解这一点，如果没有，您可以使用源代码控制系统日志，紧紧卷起，将他们打死:-)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T04:00:41.993

Svn 确实具有锁定文件以防止并发访问的设置（类似于 Source Safe），但我建议围绕可怕的代码构建一些自动化单元测试和集成测试。希望您也有一个可靠的 QA 小组作为安全网。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T04:11:44.290

1.  编写自动化单元测试。如果您有测试您正在维护的代码的测试，您可以确信任何修改都没有破坏它。[JUnit](http://www.junit.org/)等测试框架可以提供帮助。

2.  获取 Martin Fowler 的经典著作[Refactoring](http://martinfowler.com/books.html#refactoring)并阅读它。特别注意代码气味的概念。这将为您指出有助于解决您的情况的特定重构。

3.  获得一个内置重构支持的好 IDE。IDE 不会支持本书中的所有重构，但其中许多会有很多。Java 世界中的[Eclipse](http://eclipse.org)和[NetBeans是免费的，并且很好地支持重构。](http://www.netbeans.org/)

4.  考虑使用像[Hudson](http://hudson-ci.org/)这样的持续集成服务器来跟踪您的测试是否失败。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T04:00:39.107

是的，锁定它，直到你可以为它写一个更易于维护的替代品。

Michael Feathers 关于遗留代码的书对于该团队来说是一本不错的读物。当然，说起来容易做起来难，但从长远来看，特定代码可能会成为您软件的设计债务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T04:00:43.647

在库中将其黑盒化，以免被弄乱。很好地记录界面。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T04:01:33.287

生成完整的单元测试，这样如果它必须改变，你知道它仍然有效。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T04:12:33.900

如果您有 Subversion，除非代码只是几个文件，否则锁定文件并不可怕。Subversion 不允许您锁定子目录，只锁定单个文件。加上锁可以被打破。

您可能想要的是一个预提交挂钩脚本。你几乎可以做任何事情，但我用它来限制对特定子目录的访问（分支、SQL 脚本）。此外，除非您有权访问服务器，否则您无法打破预提交挂钩。

请参阅有关[实施存储库挂钩的](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.create.html#svn.reposadmin.create.hooks)[版本控制与 Subversion](http://svnbook.red-bean.com/)书。Subversion 发行版应该包含一些很好的例子来说明如何做到这一点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T03:59:18.360

我的想法更像是重构，如果代码很难使用，那么它需要重做，这可能需要一些时间，但从长远来看它可能会更好，因为你不会引起那么多问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T04:47:06.310

设置自动构建和单元测试。任何跟踪更改的存储库都是好的，但不会防止错误。

此外，只进行可以立即运行的更改。提早发布的敏捷方法通常在这里有所帮助。这样，随着您深入了解代码，您可以更好地理解代码。

基本上，如果可以的话，从不改变功能的重构开始。然后在重构的代码之上引入新功能。慢慢地做一些小的、有意识的改变。

在进行更改时锁定源可能不会像传达正在更改的内容和位置那样有帮助。你最好的方法是建立开放的沟通渠道。使用诸如 Slashcode 之类的东西建立一个论坛，在那里他们可以公开讨论问题并提出问题，并留下记录。

# c++ - Visual C++/Studio：应用程序配置不正确？

> ID：99479
> 
> 赞同：3
> 
> 时间：2008-09-19T03:58:17.410
> 
> 标签：c++, c, visual-studio, visual-c++

我的 C(++) 程序是使用 Visual C(++)/Visual Studio 编写和编译的，在我自己的机器上运行良好，但拒绝在另一台机器上运行。我收到的错误消息是“此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T03:58:55.303

如果您编写 C++ 程序，它会动态链接到 C 运行时库，或简称为 CRT。这个库包含你的 printf、你的 malloc、你的 strtok 等等。该库包含在名为 MSVCR80.DLL 的文件中。此文件默认未安装在 Windows 系统上，因此该应用程序无法运行。

解决方案？通过 VCREDIST.EXE（Visual C++ Redistributable Package）在目标机器上安装 DLL，或者静态链接到 CRT（将使用函数的实际代码直接插入 EXE）。

与一个简单的应用程序一起分发和安装 VCREDIST 是一件很痛苦的事情，所以我选择了第二个选项：静态链接。这真的很简单：转到项目的属性，展开 C/C++，单击代码生成，然后将运行时库设置为非 DLL 选项之一。这里的所有都是它的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T04:46:59.510

这里的问题是缺少 DLL 依赖项，例如 CRT（C 运行时库）。诊断此类问题的一个好工具是 Dependency Walker (depends.exe)，您可以在此处找到它：

[http://www.dependencywalker.com/](http://www.dependencywalker.com/)

您将在生成您发布的错误消息的计算机上运行此程序，并使用它打开生成此错误的 exe。Dependency Walker 将快速并以图形方式指示机器上需要但不可用的任何 DLL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T07:43:14.593

您很可能会错过 Visual Studio 的运行时库（CRT 等），您可以摆脱这些依赖项（静态链接）或在目标计算机上安装 VC redist 包。

根据您使用的 Visual C++ 版本，您必须安装不同的软件包：

[视觉 C++ 2005](http://www.microsoft.com/downloads/details.aspx?FamilyID=32BC1BEE-A3F9-4C13-9C99-220B62A191EE&displaylang=en)

[视觉 C++ 2005 SP1](http://www.microsoft.com/downloads/details.aspx?familyid=200B2FD9-AE1A-4A14-984D-389C36F85647&displaylang=en)

[视觉 C++ 2008](http://www.microsoft.com/downloads/details.aspx?familyid=9B2DA534-3E03-4391-8A4D-074B9F2BC1BF&displaylang=en)

**警告**：这些包仅包含库的发布版本，如果您希望能够分发应用程序的调试版本，您必须自己处理所需的 DLL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T11:58:51.350

静态链接到运行时是最简单的。

c++ -> 代码生成 -> 运行时库并选择“多线程/MT”

但是，这确实使您的可执行文件大了几百 KByte。如果您要安装大量小程序，这可能会成为一个问题，因为每个小程序都会被自己的运行时副本所累。答案是创建一个安装程序。

新建项目->“设置和部署”->“设置项目”

将应用程序项目的输出（使用运行时的 DLL 版本定义）加载到安装程序项目中并构建它。对运行时 DLL 的依赖将被注意到，包含在安装程序包中，并且整齐且不显眼地安装在目标机器上的正确位置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-20T13:49:18.970

适合您的正确 VC Redist 包是 Visual Studio 安装的一部分。对于 VC 8，你可以在这里找到它：

```
\Program Files\Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages\vcredist_x86 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-11T23:58:48.633

**可能的解决方案…………**

编辑：（删除了我的大部分帖子）长话短说，我遇到了类似的问题，收到“应用程序配置不正确”消息等。Depends.exe 只是发现 ieshims.dll 和 wer.dll 作为可能的问题，但这不是问题。我最终使用了多线程 (/mt) 编译选项。但是，作为一个可行的解决方案，已经奏效的是使用 InstallShield 制作安装程序。我在 installshield builder 中选择了几个合并模块，这似乎解决了我的问题。选择的模块是：VC++ 9.0 CRT、VC++ 9.0 DEBUG CRT 和 CRT WinSXS MSM 合并模块。我很确定它已经修复了它的 WinSXS 合并模块。

DEBUG CRT：我注意到某处（无论我多么努力，到目前为止显然失败了），我的 Release 版本仍然依赖于 DEBUG CRT。如果情况仍然如此，InstallShield 合并模块现在已将 DEBUG CRT 文件夹放在我的 WinSXS 文件夹中 :) 作为 VC++ 的新手，我认为这通常用于将程序的调试版本分发给其他人。为了测试这是否解决了我的问题，我从 WinSXS 文件夹中删除了 DEBUG CRT 文件夹，并且该应用程序仍然可以工作。（除非某些东西仍在后台运行等等 - 我不喜欢它）

无论如何，这让我在 XP SP3 完全更新的机器上，以及在带有裸机（.net 3.5 和 VC++ 2008 RTM 的 VMWare XP SP3 机器上）以及之前的伙伴 XP 机器上工作没有工作。

所以试试这些东西，你可能会有一些运气。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-28T23:54:45.690

您必须使用的第一件事

```
#define _BIND_TO_CURRENT_VCLIBS_VERSION 1 
```

或添加`_BIND_TO_CURRENT_VCLIBS_VERSION=1`到预处理器指令。

问题与绑定和清单类型有关，您可以找到更多[http://www.nuonsoft.com/blog/2008/10/29/binding-to-the-most-recent-visual-studio-libraries/](http://www.nuonsoft.com/blog/2008/10/29/binding-to-the-most-recent-visual-studio-libraries/)

通过这样做，您的应用程序将运行更大范围的运行时库版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T04:09:06.793

通常，此错误是由于尝试运行使用 .NET 的应用程序的调试版本造成的。由于 .NET 可再发行包不包含随 Visual Studio 安装的 dll 的调试版本，因此在任何其他未安装 Visual Studio 的计算机上运行应用程序时，通常会出现此错误。如果您还没有，请尝试构建您的应用程序的发布版本，看看是否可行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-07T16:02:57.080

另请注意 - 如果您更改为静态运行时，如果您的应用程序使用 MFC，您将必须对 MFC 执行相同的操作。这些设置在属性->配置/常规中

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-10T23:41:19.197

我遇到了这个问题，并且能够非常简单地解决它。

Visual Studio 为您提供了为每个构建构建清单的选项（默认情况下）。

清单放在发布文件夹中，但它与 exe 是不同的发布文件夹。

即使使用设置实用程序，它也没有打包。

您应该查找类似 myprogram.exe.indermediate.manifest 的文件名

如果它与 exe 位于同一文件夹中（并且您拥有所有 dll）它应该运行

# gtk - 如何在 GTK+ 中更改任意小部件的颜色？

> ID：99488
> 
> 赞同：4
> 
> 时间：2008-09-19T03:59:01.090
> 
> 标签：gtk

如果我正在编写一个想要通过使用颜色来传达某些信息的应用程序，我该如何更改给定小部件的背景颜色和前景色？如果可能的话，我想知道如何在空地中执行此操作，以及以编程方式（计算颜色）。

我也想知道如何对复杂的小部件执行此操作，例如，`HBox`包含 a的 an`VBox`包含 some `Labels`。

理想情况下，这还包括一个解决方案，允许我为小部件的现有颜色*着色*，并识别主题使用的任何图像的平均颜色，这样我就可以以编程方式补偿任何可能使文本不可读或冲突的颜色选择- 但如果我能把一个按钮变成红色，我会很高兴的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T07:33:26.507

示例程序：

```
#include <gtk/gtk.h>

static void on_destroy(GtkWidget* widget, gpointer data)
{
        gtk_main_quit ();
}

int main (int argc, char* argv[])
{
        GtkWidget* window;
        GtkWidget* button;

        gtk_init(&argc, &argv);
        window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
        g_signal_connect(G_OBJECT (window), "destroy",
                G_CALLBACK (on_destroy), NULL);
        button = gtk_button_new_with_label("Hello world!");
        GdkColor red = {0, 0xffff, 0x0000, 0x0000};
        GdkColor green = {0, 0x0000, 0xffff, 0x0000};
        GdkColor blue = {0, 0x0000, 0x0000, 0xffff};
        gtk_widget_modify_bg(button, GTK_STATE_NORMAL, &red);
        gtk_widget_modify_bg(button, GTK_STATE_PRELIGHT, &green);
        gtk_widget_modify_bg(button, GTK_STATE_ACTIVE, &blue);
        gtk_container_add(GTK_CONTAINER(window), button);
        gtk_widget_show_all(window);
        gtk_main();
        return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T10:16:09.247

我所知道的最好的文档是这里提供的：http: [//ometer.com/gtk-colors.html](http://ometer.com/gtk-colors.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-14T19:14:48.667

您始终可以使用[gtk_widget_override_color ()](https://developer.gnome.org/gtk3/3.4/GtkWidget.html#gtk-widget-override-color)和[gtk_widget_override_background_color ()](https://developer.gnome.org/gtk3/3.4/GtkWidget.html#gtk-widget-override-background-color)。这两个功能允许您更改小部件的颜色。但最好在小部件/容器实现中通过`gtk_style_context_add_class()`和使用 CSS 类和区域`gtk_style_context_add_region()`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-26T13:48:19.837

要修改小部件的颜色，您可以初始化一种颜色并使用它来修改小部件的颜色：

```
GdkColor color;
gdk_color_parse("#00FF7F", &color);
gtk_widget_modify_bg(widget, GTK_STATE_NORMAL, &color); 
```

要使用图像而不是颜色：

```
GdkPixbuf *image = NULL;
GdkPixmap *background = NULL;
GtkStyle *style = NULL;

image = gdk_pixbuf_new_from_file ("background.jpg", NULL);
gdk_pixbuf_render_pixmap_and_mask (image, &background, NULL, 0);
style = gtk_style_new ();
style->bg_pixmap [0] = background;

gtk_widget_set_style (GTK_WIDGET(widget), GTK_STYLE (style)); 
```

# language-agnostic - 实现插件系统有哪些不同的方法？

> ID：99497
> 
> 赞同：5
> 
> 时间：2008-09-19T04:00:09.280
> 
> 标签：language-agnostic, plugins

我不是在寻找特定于语言的答案，只是用于实现插件系统的通用模型（如果你想知道，我正在使用 Python）。我有自己的想法（注册回调，仅此而已），但我知道其他人存在。什么是通常使用的，还有什么是合理的？

> 插件系统是什么意思？依赖注入和 IOC 容器听起来像是一个好的解决方案吗？

我的意思是，嗯，是一种在不改变基础程序的情况下将功能插入到基础程序中的方法。出发的时候，我并没有打算定义它。*依赖注入看起来*并不特别适合我正在做的事情，但我对它们了解不多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T04:07:58.200

一个简单的插件架构可以定义一个插件接口，其中包含插件应该实现的所有方法。该插件处理来自应用程序的事件，并且可以使用应用程序的标准代码、模型对象等来完成工作。基本上与 ASP.NET 表单相同，只是您是重写而不是实现。

没有人教我这部分，我也不是专家，但我觉得：一般来说插件会不如它的应用程序稳定，所以应用程序应该始终处于控制之中，只给插件周期性的行动机会。如果插件可以注册观察者，则应尝试/捕获对委托的调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T04:06:28.280

在 Python 中，您可以使用`setuptools`和提供的入口点系统`pkg_resources`。每个入口点应该是一个返回插件信息的函数——名称、作者、设置和拆卸函数等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T20:53:47.110

[软件工程广播](http://www.se-radio.net)有一个非常好的[一集](http://www.se-radio.net/podcast/2008-07/episode-104-plugin-architectures)，您可能会感兴趣。

为了将来参考，我在此处复制了Erich Gamma, Kent Beck在出色的[对 Eclipse 的贡献中给出的“](http://www.worldcat.org/oclc/530838)[启动器规则](http://books.google.com/books?id=0X6wZRd5OOQC&pg=PP2&lpg=PP2&source=bl&ots=nM6-APiQGz&sig=2bHPZikkIU0h7D3lH-A2_qpj0HI&hl=en)”（[替代链接）。](http://samson959.spaces.live.com/Blog/cns!EA0CC6C044B39D00!187.entry)

> *   邀请规则 - 只要有可能，让其他人为您的贡献做出贡献。
> *   延迟加载规则 - 贡献仅在需要时加载。
> *   安全平台规则 - 作为扩展点的提供者，您必须保护自己免受扩展者的不当行为。
> *   公平竞争规则 - 所有客户都遵守相同的规则，包括我在内。
> *   显式扩展规则 - 显式声明可以扩展平台的位置。
> *   分集规则 - 扩展点接受多个扩展。
> *   良好的围栏规则 - 在代码之外传递控制权时，请保护自己。
> *   显式 API 规则 - 将 API 与内部分离。
> *   稳定规则 - 一旦你邀请某人贡献，不要改变规则。
> *   防御性 API 规则 - 仅显示您有信心的 API，但准备好在客户要求时显示更多 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-09T21:17:15.627

[抽象工厂](http://www.dofactory.com/Patterns/PatternAbstract.aspx)怎么样？您的基础程序定义了抽象概念如何相互交互，但调用者必须提供实现。

# c++ - 多个级别的基类是否会减慢 C++ 中的类/结构？

> ID：99510
> 
> 赞同：19
> 
> 时间：2008-09-19T04:01:59.073
> 
> 标签：c++, oop

有几个级别的基类会减慢一个类的速度吗？A 派生 B 派生 C 派生 D 派生 F 派生 G, ...

多重继承会减慢一个类的速度吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-19T04:06:07.440

非虚拟函数调用在运行时绝对不会影响性能，这与你不应该为不使用的东西付费的 C++ 口号一致。在虚函数调用中，您通常需要为额外的指针查找付费，无论您有多少继承级别或基类的数量。当然，这是所有实现定义的。

编辑：如其他地方所述，在某些多重继承场景中，在进行调用之前需要调整“this”指针。Raymond Chen 描述[了这](http://blogs.msdn.com/oldnewthing/archive/2004/02/06/68695.aspx)对 COM 对象是如何工作的。基本上，在从多个基类继承的对象上调用虚函数可能需要在虚调用所需的额外指针查找之上进行额外的减法和 jmp 指令。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-19T04:07:18.390

[深继承层次]通过增加不必要的复杂性大大增加了维护负担，迫使用户学习许多类的接口，即使他们只想使用特定的派生类。它还可以通过将不必要的 vtables 和间接添加到实际上不需要它们的类来影响内存使用和程序性能。如果您发现自己经常创建深度继承层次结构，您应该检查您的设计风格，看看您是否已经养成了这个坏习惯。**很少需要深度层次结构，而且几乎从来没有好过。**如果您不相信这一点，但认为“没有大量继承就不是 OO”，那么需要考虑的一个很好的反例是 [C++] 标准库本身。——[赫伯萨特](https://rads.stackoverflow.com/amzn/click/com/0201615622)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-19T04:26:02.337

*   **多重继承会减慢一个类的速度吗？**

正如多次提到的，深度嵌套的单继承层次结构不应为虚拟调用带来额外的开销（高于任何虚拟调用的开销）。

但是，当涉及到多重继承时，通过基类指针调用虚函数时，有时会产生非常轻微的额外开销。在这种情况下，一些实现让虚函数通过一个小的 thunk 来调整“this”指针，因为

```
(static_cast<Base*>( this) == this) 
```

根据对象布局不一定正确。

请注意，所有这些都非常**非常****依赖**于实现。

见 Lippman 的《深入 C++ 对象模型》第 4.2 章 - MI 下的虚拟成员函数/虚拟函数

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T04:14:48.107

不同级别的虚拟调用之间没有速度差异，因为它们都被展平到 vtable 中（指向被覆盖方法的最衍生版本）。*因此，当inst*是*B*的实例时调用 ((A*)inst)->Method()与*inst*是*D*的实例时的开销相同。

现在，虚拟调用比非虚拟调用更昂贵，但这是因为指针解引用，而不是类层次结构实际深度的函数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T08:50:32.263

虚拟调用本身比普通调用更耗时，因为它必须查找实际函数的地址才能从 vtable 调用

此外，由于查找要求，内联等编译器优化可能难以执行。由于堆栈弹出和推送和跳转操作，内联本身不可能的情况会导致相当高的开销

这是一项适当的研究，表明开销可能高达 50% [http://www.cs.ucsb.edu/~urs/oocsb/papers/oopsla96.pdf](http://www.cs.ucsb.edu/~urs/oocsb/papers/oopsla96.pdf)

这是另一个资源，它着眼于拥有大型虚拟类库的副作用[http://keycorner.org/pub/text/doc/kde-slow.txt](http://keycorner.org/pub/text/doc/kde-slow.txt)

具有多重继承的虚拟调用的分派是编译器特定的，因此在这种情况下实现也会产生影响。

关于没有大量基类的具体问题，通常类对象的内存布局将具有其中所有其他组成类的 vtbl ptrs。

检查此页面以获取示例 vtable 布局 - [http://www.codesourcery.com/public/cxx-abi/cxx-vtable-ex.html](http://www.codesourcery.com/public/cxx-abi/cxx-vtable-ex.html)

因此，调用由更深入层次结构的类实现的方法仍然只是一个间接而不是您似乎认为的多个间接。该调用不必从一个类导航到另一个类以最终找到要调用的确切函数。

但是，如果您使用组合而不是继承，则每个指针调用都将是一个虚拟调用，并且会存在开销，并且如果在该虚拟调用中，如果该类使用更多组合，则将进行更多虚拟调用。根据您拨打的电话数量，这种设计会更慢。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T16:48:56.567

几乎所有答案都指向虚拟方法在 OP 的示例中是否会更慢，但我认为 OP 只是在询问是否有多个级别的继承本身是否很慢。答案当然是否定的，因为这一切都发生在 C++ 的编译时。我怀疑这个问题是由脚本语言的经验驱动的，在这种语言中，这样的继承图可以是动态的，在这种情况下，它可能会更慢。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T04:05:05.663

如果没有虚函数，那么它不应该。如果存在，则调用虚函数会对性能产生影响，因为这些虚函数是通过函数指针或其他间接方法调用的（取决于具体情况）。但是，我不认为影响与继承层次结构的深度有关。

布赖恩，要清楚并回答您的评论。如果继承树中的任何位置都没有虚函数，则不会影响性能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T18:23:13.330

在深度继承树中拥有非平凡的构造函数会减慢对象的创建速度，因为每次创建子对象都会导致对所有父构造函数的函数调用一直到基础。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T04:05:52.980

是的，如果你这样引用它：

```
// F is-a E,
// E is-a D and so on

A* aObject = new F(); 
aObject->CallAVirtual(); 
```

然后，您将使用指向 A 类型对象的指针。鉴于您正在调用一个虚拟函数，它必须查找函数表（vtable）以获取正确的指针。有一些开销，是的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T04:06:25.240

调用虚函数比调用非虚函数稍慢。但是，我认为继承树的深度并不重要。

但这不是您通常应该担心的差异。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T04:06:58.983

虽然我不完全确定，但我认为除非您使用虚拟方法，否则编译器应该能够很好地优化它，以至于继承不应该太重要。

但是，如果您调用基类中的函数，而基类中的函数又会调用其基类中的函数，等等，它可能会影响性能。

从本质上讲，它在很大程度上取决于您如何构建继承树。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T11:41:32.530

[正如Corey Ross](https://stackoverflow.com/questions/99510/does-several-levels-of-base-classes-slow-down-a-classstruct-in-c#99585)所指出的，vtable 在编译时对于任何叶派生类都是已知的，因此无论层次结构如何，虚拟调用的成本实际上应该是相同的。

然而，对于`dynamic_cast`. 如果你考虑如何实现 `dynamic_cast`，一个基本的方法是在你的层次结构中进行 O(n) 搜索！

在多重继承层次结构的情况下，您还需要支付少量成本在层次结构中的不同类之间进行转换：

```
sturct A { int i; };
struct B { int j; };

struct C : public A, public B { int k ; };

// Let's assume that the layout of C is:  { [ int i ] [ int j ] [int k ] }

void foo (C * c) {
  A * a = c;                // Probably has zero cost
  B * b = c;                // Compiler needed to add sizeof(A) to 'c'
  c = static_cast<B*> (b);  // Compiler needed to take sizeof(A)' from 'b'
} 
```

# interop - 是否可以对互操作程序集进行代码覆盖率分析？

> ID：99520
> 
> 赞同：4
> 
> 时间：2008-09-19T04:04:07.133
> 
> 标签：interop, com-interop, instrumentation

我也在 MSDN 论坛上问过这个问题，但没有找到解决方案：

[http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3686852&SiteID=1](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3686852&SiteID=1)

正如我所看到的，这里的基本问题是互操作程序集实际上不包含任何可以检测的 IL（可能除了一些委托之外）。因此，尽管我可以将一个测试项目组合在一起来练习互操作层，但我无法了解我实际调用*了多少这些方法和属性。*

计划 B 是编写一个代码生成器，该生成器创建一个 RCWW（运行时可调用包装器包装器）库，并为代码覆盖目的进行检测。

编辑：@Franci Penov，

是的，这正是我想要做的。交付给我们的 COM 组件构成了一个包含大约十几个 DLL 的库。3000种。我们在我们的应用程序中使用该库并负责测试该互操作层，因为向我们提供库的小组只进行了最少的测试。代码覆盖率将使我们能够确保所有接口和 coclass 都得到执行。这就是我正在尝试做的所有事情。我们有单独的测试项目来运行我们自己的托管代码。

是的，理想情况下，COM 服务器团队应该测试和分析他们自己的代码，但我们并不生活在一个理想的世界中，我必须根据他们的工作交付高质量的产品。如果可以生成一份测试报告，表明我已经测试了他们 80% 的代码接口并且其中 50% 的代码接口没有像宣传的那样工作，那么我可以在需要修复的地方完成修复，而不是解决问题。

您提到的模拟层会很有用，但最终不会实现测试互操作层本身的目标，而且我当然不想手动维护它——我们受 COM 人员的摆布接口的变化。

就像我上面提到的那样——下一步是为包装器生成包装器，并为测试目的检测这些包装器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T13:19:13.217

要回答您的问题 - 无法为代码覆盖率检测互操作程序集。它们仅包含元数据，不包含您自己提到的可执行代码。

此外，我认为尝试对互操作程序集进行代码覆盖没有多大意义。您应该测量您编写的代码的代码覆盖率。

从您提到的 MDN 论坛主题中，在我看来您实际上想要衡量您的代码如何使用 COM 组件。除非您的代码目标是枚举并显式调用 COM 对象的所有方法和属性，否则您不需要测量代码覆盖率。您需要单元/场景测试以确保您的代码在正确的时间调用正确的方法/属性。

恕我直言，正确的做法是为 COM 对象编写一个模拟层并测试您是否按预期调用了所有方法/属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T10:06:31.237

计划C：

使用[Mono.Cecil 之](http://www.mono-project.com/Cecil)类的东西将简单的执行计数器编织到互操作程序集中。例如，查看[常见问题解答](http://www.mono-project.com/Cecil:FAQ)中的这一部分：“我想向无法调试的程序集添加一些跟踪功能，是否可以使用 Cecil？”

# php - 什么是处理文件上传的好 PHP 库？

> ID：99528
> 
> 赞同：17
> 
> 时间：2008-09-19T04:05:27.737
> 
> 标签：php, file-upload

我希望使用 PHP 库将图片上传到 Web 服务器，这样我就可以使用已经过测试的东西，希望不必自己设计。有人知道这样的图书馆吗？

编辑：我知道文件上传是内置在 PHP 中的，我正在寻找一个可以使过程更简单、更安全的库。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T04:07:37.937

我个人使用PEAR 的[HTTP_Upload](http://pear.php.net/package/HTTP_Upload)。它非常适合我们的目的（将媒体文件上传到开发系统并为教育系统上传任意文件）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T04:19:22.027

狡猾的名字[上传类](http://www.verot.net/php_class_upload.htm)非常好，并且有一个非常敏感和支持的开发人员。除了上传之外，它还内置了对很多常用图片功能的支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T05:16:09.393

[Zend 框架](http://framework.zend.com/)具有适用于所有事物的类，包括文件上传。查看[Zend_HTTP](http://framework.zend.com/manual/en/zend.http.html)类以获得您想要的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T05:21:39.957

查看[SWFUpload的](http://code.google.com/p/swfupload/)[这个](http://demo.swfupload.org/applicationdemo/index.php)示例，源代码在 PHP 中可用。

# deployment - 您使用哪些工具进行自动构建/自动部署？为什么？

> ID：99535
> 
> 赞同：11
> 
> 时间：2008-09-19T04:06:42.540
> 
> 标签：deployment, build-automation

您使用哪些工具进行自动构建/自动部署？为什么？

你推荐什么工具？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T04:10:09.350

[Hudson](http://hudson-ci.org/)用于自动化构建。我选择它是因为它最容易设置和演示。一个过于复杂且外观不美观的系统不会给管理人员留下足够的印象，无法让他们参与自动化构建。尤其是在一个有很大惯性的项目中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T04:18:39.330

NAnt 用于构建（但 MSBuild、Rake，几乎任何东西都可以）和 CruiseControl.NET 用于部署。我目前正在使用来自 ThoughtWorks 工作室的新 Cruise，因为它提供了一种更好的方式来暂存各种管道，让我可以将我想要的任何版本部署到目标环境。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-19T06:30:00.497

我们使用来自 JetBrains 的[TeamCity](http://www.jetbrains.com/teamcity/)。他们还制作 Resharper 和 IntelliJ。

我们使用它来构建我们的 .Net 应用程序，它非常容易设置、连接到 TFS 并从中运行其他工具。它非常精美，实际上让我想起了这个网站。发现它比 CruiseControl 好得多，而且对于我们的团队规模来说，它是免费的。如果你需要很多不同的构建，更多的每个用户构建等等，那么它会花费一点（但仍然相当合理）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T04:14:53.207

有趣的是，我只花了两周时间彻底检查（阅读从头开始实施）我们的夜间构建过程。非常有趣（不，真的）。我玩弄了安装 Team Foundation Server 的想法，但我们使用 Perforce 进行源代码控制，我认为不值得这么麻烦。

我们的进程现在是一组在专用构建/测试服务器上运行的 Powershell 脚本，它们在计划任务上执行以下操作：

清除整个源代码树（首先检查您是否没有检查任何内容！）

从 Perforce 中删除整个源代码树（从最后一个标记的构建）

生成更改报告（通过同步到 HEAD 并观察发生的情况）

构建应用程序

将 PDB 文件索引到 Perforce 源

将二进制文件和符号存储在专用符号服务器中

运行测试项目

构建安装程序

标签

向群组发送包含上述所有状态报告的电子邮件

效果很好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-19T04:17:31.953

`make``bash`在Linux上

`make``cmd`在窗户上

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-19T05:30:37.907

[视觉构建专业版](http://www.kinook.com/VBP/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-19T05:36:28.750

我们结合使用构建工具和持续集成服务器：

构建工具：

1.  [马文](https://maven.apache.org/)
2.  [SBT](http://www.scala-sbt.org/)
3.  [摇篮](http://gradle.org/)
4.  [耙](http://docs.seattlerb.org/rake/)

持续集成服务器：

1.  [詹金斯](https://jenkins-ci.org/)
2.  [哈德逊](http://hudson-ci.org/)
3.  [特拉维斯 CI](https://travis-ci.org/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-19T04:27:00.417

[自动构建工作室](http://www.automatedqa.com/products/abs/index.asp)。

它不会让您使用脚本或 xml 文件，而是带有预定义的图形宏操作，可让您轻松创建任务。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-05T03:44:14.870

对于我们的 Windows 可编译的东西，我们使用[FinalBuilder](http://www.finalbuilder.com/)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-19T04:15:11.537

[CruiseControl](http://cruisecontrol.sourceforge.net/)用于自动化构建。效果很好。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-19T04:17:50.500

对于自动化构建，我认为目前最好的工具是 JetBrain 的 Team City。免费版具有大多数 5-10 人团队所需的所有功能。设置很容易，配置新项目很轻松（相对而言），最重要的是，它是可靠的。

对于自动迁移，没有什么比 PowerShell 更好的了。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-16T18:20:00.737

UppercuT 使用 NAnt 来构建，它是非常容易使用的构建框架。

自动化构建就像 (1) 解决方案名称，(2) 源代码控制路径，(3) 大多数项目的公司名称一样简单！

[http://code.google.com/p/uppercut/](http://code.google.com/p/uppercut/)

这里有一些很好的解释：[Uppercut](http://ferventcoder.com/category/UppercuT.aspx)

## 更多信息

* * *

UppercuT 是一种传统的自动构建，这意味着您设置一个配置文件，然后您可以免费获得一堆功能。可以说，最强大的功能是能够在一个地方指定环境设置并将它们应用到任何地方，包括构建源代码时的文档。

可用文档：[https ://github.com/chucknorris/uppercut/wiki](https://github.com/chucknorris/uppercut/wiki)

特征 ：

*   简单的设置
*   简单升级
*   构建过程中每个步骤的自定义扩展点（前、后和替换）[http://uppercut.pbworks.com/CustomizeUsingExtensionPoints](http://uppercut.pbworks.com/CustomizeUsingExtensionPoints)
*   具有与 Team City、CruiseControl.NET 和 Jenkins（原 Hudson）集成的文档[https://github.com/chucknorris/uppercut/tree/master/docs](https://github.com/chucknorris/uppercut/tree/master/docs)
*   适用于带有 Mono 的 Linux
*   基于内部版本号和源代码控制修订版（SVN、TFS、Git、HG）对 DLL 进行版本控制
*   编译活动 - F5 或 Ctrl + Shift + B
*   强大的命名就像真/假一样简单
*   代码测试和分析
    *   测试
        *   单元
        *   MbUnit v2
        *   加里奥
        *   xUnit
    *   无盖
    *   依赖
    *   硝酸盐
    *   Mono 迁移分析器
*   混淆
*   合并
*   环境模板和构建（ConfigBuilder、DocBuilder、SQLBuilder、DeploymentBuilder）[https://github.com/chucknorris/uppercut/blob/master/docs/ConfigBuilder.doc?raw=true](https://github.com/chucknorris/uppercut/blob/master/docs/ConfigBuilder.doc?raw=true)
*   打包输出以准备部署
*   压缩输出

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-19T04:17:22.233

在工作中，我们使用优秀的[Ant](http://ant.apache.org/)来构建我们的 Java servlet。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-19T04:23:58.473

我们曾经使用 Kinook 软件的 Visual Build，但最近在我们的新应用程序中我们切换到 MSBuild，因为它与 TFS 更好地集成并且能够创建自定义任务。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-19T04:24:48.660

绝对是 GNU Autotools。[autoconf](http://www.gnu.org/software/autoconf/)和[automake](http://www.gnu.org/software/automake/)是 unix 系统的事实上的标准。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-06T22:22:28.483

我已经成功使用[buildbot](http://buildbot.net/trac)，由 subversion 存储库上的提交后脚本触发。这已用于自动化构建和自动化测试。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-06T22:32:27.323

[ANT](http://ant.apache.org/)用于构建和部署/安装。

制作出色的跨平台安装程序。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-11-11T22:26:08.477

我们使用[Hericus Zed 构建和错误管理](http://www.hericus.com/)来进行自动化构建。

我们有 4 个代码分支，每个分支都有 java、c++、C#、跨平台编译器和适用于 5 个操作系统的安装程序。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-05T03:52:01.720

为构建做准备。用于部署的 Debian 软件包（因为我们的生产服务器运行它）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-06-13T16:18:50.380

[TeamCity](http://www.jetbrains.com/teamcity/)运行 NAnt 脚本来构建/打包和 PowerShell 进行部署。

我发现使用由 TeamCity 提供支持的 NAnt，而不是原生的 TeamCity 运行器，可以让我们拥有更丰富的构建过程（例如 css minimiser 等）。这也意味着完整的构建/打包过程可以在任何开发人员 PC 上运行，而不仅仅是 TeamCity 服务器，从而更容易在构建过程中自定义和调试问题。

# math - 3D 中的点三角形碰撞检测

> ID：99542
> 
> 赞同：4
> 
> 时间：2008-09-19T04:07:31.523
> 
> 标签：math, 3d, collision-detection

如何在以下物理模拟中纠正浮点错误：

*   原点（x，y，z），
*   施加力后所需的点 (x', y', z')。
*   共享边 BC 的两个三角形 (A, B, C) 和 (B, C, D)

我正在使用这种方法进行碰撞检测：

```
For each Triangle
    If the original point is in front of the current triangle, and the desired point is behind the desired triangle:
        Calculate the intersection point of the ray (original-desired) and the plane (triangle's normal).
        If the intersection point is inside the triangle edges (!)
            Respond to the collision.
        End If
    End If
Next Triangle 
```

我遇到的问题是，有时该点会落入浮点数学的灰色区域，因为它非常靠近 BC 线，以至于它无法与任何一个三角形发生碰撞，即使从技术上讲它应该总是与一个或另一个发生碰撞，因为他们有共同的优势。当这种情况发生时，该点正好穿过两个共享边三角形之间。**我已经用(!)**标记了代码的一行，因为我相信那是我应该做出改变的地方。

在非常有限的情况下有效的一种想法是跳过边缘测试。有效地将三角形变成平面。这仅在我的网格是凸包时有效，但我计划创建凸形。

我专门使用点积和三角形法线进行所有前后测试。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-18T22:27:19.350

当针对某些具有边缘和顶点的几何体拍摄单条射线时，这是一个不可避免的问题。令人惊讶的是，物理模拟似乎能找出最小的数值误差！

其他受访者提出的一些解释和解决方案将不起作用。尤其：

*   数值不准确确实会导致光线“穿过缝隙”。问题是在对线 BC 进行测试之前，我们将射线与平面 ABC 相交（例如得到点 P）。然后我们在对线 BC 进行测试之前，将射线与平面 BCD 相交（例如得到点 Q）。P 和 Q 都用最接近的浮点近似表示；没有理由期望它们恰好位于它们应该位于的平面上，因此您可以将 P 放在 BC 的左侧，将 Q 放在 BC 的右侧。

*   使用小于或等于测试无济于事；问题在于光线和平面的交点不准确。

*   平方根不是问题；您可以使用点积和浮点除法进行所有必要的计算。

以下是一些真正的解决方案：

*   对于凸网格，您可以只测试所有平面并忽略边缘和顶点，如您所说（从而完全避免该问题）。

*   不要将射线依次与每个三角形相交。相反，请使用[标量三元积](http://realtimecollisiondetection.net/blog/?p=69)。（在考虑每个三角形时，此方法对射线和边 BC 进行完全相同的计算序列，确保两个三角形之间的任何数值不准确至少是一致的。）

*   对于非凸网格，给边缘和顶点一些宽度。也就是说，在网格中的每个顶点放置一个小球体，并在网格的每个边缘放置一个薄圆柱体。将射线与这些球体和圆柱体以及三角形相交。这些额外的几何图形阻止光线穿过网格的边缘和顶点。

让我强烈推荐 Christer Ericson 的书[Real-Time Collision Detection](http://realtimecollisiondetection.net/)。在第 446-448 页上讨论了这个确切的问题，在第 184-188 页上解释了将射线与三角形相交的标量三重乘积方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T04:11:01.453

听起来你不包括测试它是否在边缘（你正在写“内部三角形边缘”）。尝试将代码更改为“小于或等于”（内部或重叠）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T04:14:36.827

我发现您的光线不太可能以浮点精度生效的方式恰好落在三角形之间。你绝对肯定这确实是问题吗？

无论如何，一个可能的解决方案不是只发射一条射线，而是发射三条彼此非常接近的射线。如果一个恰好落在其他两个之间，那么至少一个肯定会落在一个三角形上。

这至少可以让您测试问题是否真的是浮点错误或更可能的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T04:25:30.000

@Statement：我确实已经在我的代码中使用了“大于或等于”比较，谢谢你的建议。+1

我目前的解决方案是在边缘测试中添加少量微调。基本上，当每个三角形被测试时，它的边缘被推出了一个非常小的量，以抵消浮点误差。有点像测试浮点计算的结果是否小于 0.01，而不是测试是否与零相等。

这是一个合理的解决方案吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T19:01:04.063

如果您正在进行距离测量，请注意平方根。他们有一个讨厌的习惯，就是丢掉你*一半*的精度。如果你把这些计算中的一些叠加起来，你很快就会遇到大麻烦。这是我使用的距离函数。

```
double Distance(double x0, double y0, double x1, double y1)
{
  double a, b, dx, dy;

  dx = abs(x1 - x0);
  dy = abs(y1 - y0);

  a = max(dx, dy));
  if (a == 0)
    return 0;
  b = min(dx, dy);

  return a * sqrt( 1 + (b*b) / (a*a) );
} 
```

由于最后一个操作不是平方根，因此您不会再丢失精度。

我在我正在做的一个项目中发现了这一点。在研究了它并弄清楚它做了什么之后，我找到了我认为有责任祝贺他的程序员，但他不知道我在说什么。

# input - 如何在 D 编程语言 + Tango 中抓住单键？

> ID：99546
> 
> 赞同：3
> 
> 时间：2008-09-19T04:08:06.950
> 
> 标签：input, d, tango

我读了这篇[文章](http://smartprogrammer.blogspot.com/2006/04/15-exercises-for-learning-new.html)并尝试用 D 编程语言做练习，但在第一个练习中遇到了问题。

> (1) 在无限循环中显示一系列数字（1,2,3,4,5....等）。如果有人按下特定键（比如 ESCAPE 键），程序应该退出。

当然无限循环不是什么大问题，但其余的都是。我怎样才能在 D/Tango 中抓住一个关键点？在探戈常见问题解答中，它说使用 C 函数 kbhit() 或 get()，但据我所知，这些不在 C 标准库中，也不存在于我用来编程的 Linux 机器附带的 glibc 中。

我知道我可以使用一些 3rd 方库，例如[ncurses](http://www.gnu.org/software/ncurses/)，但它和 kbhit() 或 get() 有同样的问题，它不是 C 或 D 中的标准库，也没有预安装在 Windows 上。我希望我可以只使用 D/Tango 来完成这个练习，并且可以在 Linux 和 Windows 机器上运行它。

我怎么能做到？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T11:30:58.317

以下是使用 D 编程语言的方法：

```
 import std.c.stdio;
    import std.c.linux.termios;

    termios  ostate;                 /* saved tty state */
    termios  nstate;                 /* values for editor mode */

    // Open stdin in raw mode
    /* Adjust output channel        */
    tcgetattr(1, &ostate);                       /* save old state */
    tcgetattr(1, &nstate);                       /* get base of new state */
    cfmakeraw(&nstate);
    tcsetattr(1, TCSADRAIN, &nstate);      /* set mode */

   // Read characters in raw mode
    c = fgetc(stdin);

    // Close
    tcsetattr(1, TCSADRAIN, &ostate);       // return to original mode 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T06:34:12.873

kbhit 确实不是任何标准 C 接口的一部分，但可以在 conio.h 中找到。

但是，您应该能够使用 tango.stdc.stdio 中的 getc/getchar - 我更改了您提到的常见问题解答以反映这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T08:02:51.990

Thanks for both of your replies.

Unfortunately, my main development environment is Linux + GDC + Tango, so I don't have conio.h, since I don't use DMC as my C compiler.

And I also found both getc() and getchar() is also line buffered in my development environment, so it could not achieve what I wish I could do.

In the end, I've done this exercise by using GNU ncurses library. Since D could interface C library directly, so it does not take much effort. I just declare the function prototype that I used in my program, call these function and linking my program against ncurses library directly.

It works perfectly on my Linux machine, but I still not figure out how could I do this without any 3rd party library and could run on both Linux and Windows yet.

```
import tango.io.Stdout;
import tango.core.Thread;

// Prototype for used ncurses library function.
extern(C)
{
    void * initscr();
    int cbreak ();
    int getch();
    int endwin();
    int noecho();
}

// A keyboard handler to quit the program when user hit ESC key.
void keyboardHandler ()
{
    initscr();
    cbreak();
    noecho();
    while (getch() != 27) {
    }
    endwin();
}

// Main Program
void main ()
{
    Thread handler = new Thread (&keyboardHandler);
    handler.start();

    for (int i = 0; ; i++) {
        Stdout.format ("{}\r\n", i).flush;

        // If keyboardHandler is not ruuning, it means user hits
        // ESC key, so we break the infinite loop.
        if (handler.isRunning == false) {
            break;
        }
    }

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T04:15:56.917

D 通常具有所有可用的 C 标准库（Tango 或 Phobos），因此对于 GNU C 的这个问题的答案也应该在 D 中工作。

如果 tango 没有所需的功能，生成绑定很容易。（看看 CPP 以消除任何宏观垃圾。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T13:43:54.533

正如 Lars 指出的那样，您可以使用 conio.h 中定义的 _kbhit 和 _getch 并在（我相信）msvcrt for Windows 中实现。这是[一篇包含使用 _kbhit 和 _getch 的 C++ 代码](http://nibuthomas.com/2009/02/06/how-to-check-for-keyhit-in-a-windows-console-application/)的文章。

# wcf - 有人比较过 WCF 和 ZeroC ICE 吗？

> ID：99548
> 
> 赞同：16
> 
> 时间：2008-09-19T04:08:26.373
> 
> 标签：wcf, callback, ice

ZeroC 的 ICE (www.zeroc.com) 看起来很有趣，我有兴趣查看它并将其与我们现有的使用 WCF 的软件进行比较。特别是，我们的 WCF 应用程序使用服务器回调（通过 HTTP）。

有谁比较过吗？进展如何？我对性能方面特别感兴趣，因为现在互操作性对我们来说并不是什么大问题。谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-22T14:45:24.920

几年前我对 ICE 做了一个非常简短的回顾，虽然我之前没有直接比较过它们，但对 WCF 有合理的了解，我的想法可能有一些相关性。

首先，将 WCF 与 ICE 进行比较并不完全公平，因为 WCF 是一种特定的远程通信机制，而 WCF 是一个更高级别的远程通信框架。

虽然 WCF 通常被认为是实现 SOAP Web 服务，而这确实是它迄今为止的主要用途，但它也可以用于使用各种编码和传输通道来实现远程服务，这意味着它理论上可以用于高性能通信应用程序之间。

相比之下，ICE 是一种跨平台的远程通信机制，它使用二进制编码在应用程序之间进行高性能通信。它是 CORBA 的简化演变，更直接地与 CORBA、DCOM、.NET Remoting 和 JNI 相媲美。

但是，即使 ICE 和 WCF 之间没有直接对应关系，如果您需要 .NET 应用程序进行远程通信，那么它们都是竞争者。您可能需要考虑的一些决策点包括：

*   资源化。找到具有 WCF 经验的开发人员会比 ICE 经验更容易。

*   表现。如果您想要性能，那么 ICE 会执行得很快，但 WCF 也可以用于高性能配置。或者，.NET Remoting 可以提供非常好的性能，无论 MS 赞助的基准测试表明我已经看到它比 WCF 高 10%。

*   跨平台。如果您需要与非 Windows 应用程序通信，那么您可以使用的 WCF 选项会受到限制。此外，由于每个 SOAP 堆栈似乎都以不同的方式实现标准，因此创建真正通用的 Web 服务可能会很痛苦（尽管 WS-I 有帮助）

如果您从第一天起就不需要每一盎司的性能，那么我个人会从 WCF 开始，然后在性能变得至关重要时考虑使用 ICE。即使那样，扩展您的服务盒可能比迁移到 ICE 更便宜，如果您没有任何奇异的跨平台需求，那么您总是可以考虑重新配置 WCF 以进行二进制编码等

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-03T08:39:45.597

ZeroC 的 Michi Henning 最近[发表](http://www.zeroc.com/forums/announcements/4209-performance-scalability-white-paper-published.html) [了一篇关于这个主题的白皮书](http://zeroc.com/articles/IcePerformanceWhitePaper.pdf)——“选择中间件：为什么性能和可扩展性很重要（和不重要）”。它将 Ice、WCF（二进制和 SOAP）和 RMI 与各种性能指标、平台、语言等进行了比较。在[Michi 的博客](http://zeroc.com/blogs/michi/2009/02/26/choosing-middleware/)上有更多信息，但白皮书的可读性也很强，其中包含任何基准测试的所有标准警告。

免责声明：我广泛使用过 Ice 和 RMI，但从未使用过 WCF。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-28T21:54:36.260

[Apache Thrift](http://incubator.apache.org/thrift/)是 ICE 和 WCF 的另一个竞争者。它由 Facebook 开发和开源。[Apache Thrift](http://incubator.apache.org/thrift/)在某些方面很好，因为它不仅在编码方面非常高效，而且还支持在不破坏所有客户端的情况下向结构添加字段（我们发现这对我们的项目非常有用）。

[Google Protocol Buffers](http://code.google.com/apis/protocolbuffers/docs/overview.html)似乎不是真正的竞争者，因为它没有在主页上提到 .NET 支持。但是，一些社区插件支持 C#。此外，如果您使用现有服务， [ICE还为 Google Protocol Buffers 提供仿真。](http://www.zeroc.com/ice.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-23T16:39:32.053

数据点：我们刚刚将一个回调多平台和多语言项目从 Ice 转换为 Thrift，效果非常好。Ice 为您做了很多工作，因此我们必须自己实现断开连接侦听器、连接事件等。在一个案例中，我们遇到了一个众所周知的大对象锁，Ice 让我们侥幸逃脱——这导致了 Thrift 服务器中的死锁，但通过在 C# 端的不那么懒惰的编码很容易修复它。

我刚刚完成了基准测试，在我们的应用程序中，任何推送大量数据的东西都比 Ice 快，或者与 Ice 相当。具有更多开销的较短消息（即，通过协议更新状态的“心跳”）有点慢。

最重要的一点是，为了正确实现回调服务，我们必须扩展 Thrift 接口并定义我们自己的协议，以及 Thrift“处理器”和回调客户端服务器。但我坦率地承认我们的应用程序是/非常/特别的。现有的协议和服务器应该足够了。但是扩展它们，甚至使用 .Net 中的多路复用套接字，也不是很困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-28T21:49:17.887

我们正在使用 ICE 来集成用 C++、Java 和 C# 编写的模块。好处是我们的服务器也可以访问远程机器上的组件，所以如果我们需要更高的性能，我们可以将处理转移到不同的机器上。

我已经使用了 WCF 和 ICE，我想说 ICE 在实现方面更干净。ICE 也有非常详细和易读的文档。

ICE 支持一些 WCF 不能做的事情，包括负载平衡、自动远程客户端更新等。

# c++ - “纯虚函数调用”崩溃从何而来？

> ID：99552
> 
> 赞同：116
> 
> 时间：2008-09-19T04:09:28.883
> 
> 标签：c++, polymorphism, virtual-functions, pure-virtual

我有时会注意到程序在我的计算机上崩溃并出现错误：“纯虚函数调用”。

当无法从抽象类创建对象时，这些程序如何编译？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-09-19T04:12:49.747

如果您尝试从构造函数或析构函数进行虚函数调用，则可能会导致它们。由于您不能从构造函数或析构函数调用虚函数（派生类对象尚未构造或已被销毁），因此它调用基类版本，在纯虚函数的情况下，不会不存在。

[（在这里](http://melpon.org/wandbox/permlink/klZcScwmRCHfCKfI)查看现场演示）

```
class Base
{
public:
    Base() { doIt(); }  // DON'T DO THIS
    virtual void doIt() = 0;
};

void Base::doIt()
{
    std::cout<<"Is it fine to call pure virtual function from constructor?";
}

class Derived : public Base
{
    void doIt() {}
};

int main(void)
{
    Derived d;  // This will cause "pure virtual function call" error
} 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-09-19T08:48:40.567

除了从具有纯虚函数的对象的构造函数或析构函数调用虚函数的标准情况外，如果在对象被销毁后调用虚函数，您还可以获得纯虚函数调用（至少在 MSVC 上） . 显然，这是一件非常糟糕的事情，但如果您将抽象类作为接口使用并且您搞砸了，那么您可能会看到它。如果您使用引用的计数接口并且您有一个引用计数错误，或者如果您在多线程程序中存在对象使用/对象销毁竞争条件，则可能更有可能......关于这些类型的纯调用的事情是通常不太容易弄清楚发生了什么，因为对 ctor 和 dtor 中虚拟呼叫的“通常嫌疑人”的检查会变得干净。

为了帮助调试这些类型的问题，您可以在各种版本的 MSVC 中替换运行时库的 purecall 处理程序。您可以通过使用此签名提供您自己的函数来做到这一点：

```
int __cdecl _purecall(void) 
```

并在链接运行时库之前链接它。这使您可以控制检测到纯调用时发生的情况。一旦你有了控制权，你就可以做一些比标准处理程序更有用的事情。我有一个处理程序，可以提供纯调用发生位置的堆栈跟踪；请参阅此处： http: [//www.lenholgate.com/blog/2006/01/purecall.html](http://www.lenholgate.com/blog/2006/01/purecall.html)了解更多详情。

（请注意，您也可以调用 _set_purecall_handler() 在某些版本的 MSVC 中安装您的处理程序）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-05-09T14:24:04.530

我遇到了纯虚函数因为对象被破坏而被调用的场景，`Len Holgate`已经有一个很好的[答案](https://stackoverflow.com/a/100555/71312)，我想用一个例子添加一些颜色：

1.  创建一个派生对象，并将指针（作为基类）保存在某处
2.  Derived 对象被删除，但仍以某种方式引用指针
3.  指向已删除派生对象的指针被调用

Derived 类析构函数将 vptr 点重置为具有纯虚函数的基类 vtable，因此当我们调用虚函数时，它实际上调用的是纯虚函数。

这可能是由于明显的代码错误或多线程环境中竞争条件的复杂场景而发生的。

这是一个简单的例子（g++编译关闭优化 - 一个简单的程序可以很容易地被优化掉）：

```
 #include <iostream>
 using namespace std;

 char pool[256];

 struct Base
 {
     virtual void foo() = 0;
     virtual ~Base(){};
 };

 struct Derived: public Base
 {
     virtual void foo() override { cout <<"Derived::foo()" << endl;}
 };

 int main()
 {
     auto* pd = new (pool) Derived();
     Base* pb = pd;
     pd->~Derived();
     pb->foo();
 } 
```

堆栈跟踪如下所示：

```
#0  0x00007ffff7499428 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54
#1  0x00007ffff749b02a in __GI_abort () at abort.c:89
#2  0x00007ffff7ad78f7 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#3  0x00007ffff7adda46 in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#4  0x00007ffff7adda81 in std::terminate() () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#5  0x00007ffff7ade84f in __cxa_pure_virtual () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#6  0x0000000000400f82 in main () at purev.C:22 
```

**强调：**

如果对象被完全删除，这意味着析构函数被调用，并且 memroy 被回收，我们可能会简单地得到 a `Segmentation fault`，因为内存已经返回给操作系统，而程序就无法访问它。所以这种“纯虚函数调用”的场景通常发生在对象被分配到内存池上，而对象被删除时，底层内存实际上并没有被操作系统回收，它仍然可以被进程访问。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-19T04:15:51.770

通常当你通过一个悬空指针调用一个虚函数时——很可能该实例已经被销毁了。

也可能有更多“创造性”的原因：也许您已经设法切掉了实现虚函数的对象部分。但通常只是实例已经被销毁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T04:11:46.130

我猜出于某种内部原因（可能需要某种运行时类型信息）为抽象类创建了一个 vtbl，并且出现了问题，并且一个真实的对象得到了它。这是一个错误。仅此一点就应该说不可能发生的事情是。

纯粹的猜测

**编辑：**看起来我在有问题的情况下错了。OTOH IIRC 某些语言确实允许从构造函数析构函数中调用 vtbl。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-16T05:08:46.160

我使用 VS2010，每当我尝试直接从公共方法调用析构函数时，我都会在运行时收到“纯虚函数调用”错误。

```
template <typename T>
class Foo {
public:
  Foo<T>() {};
  ~Foo<T>() {};

public:
  void SomeMethod1() { this->~Foo(); }; /* ERROR */
}; 
```

所以我把 ~Foo() 里面的东西移到了单独的私有方法中，然后它就像一个魅力。

```
template <typename T>
class Foo {
public:
  Foo<T>() {};
  ~Foo<T>() {};

public:
  void _MethodThatDestructs() {};
  void SomeMethod1() { this->_MethodThatDestructs(); }; /* OK */
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-22T14:52:17.560

如果您使用 Borland/CodeGear/Embarcadero/Idera C++ Builder，您只需实现

```
extern "C" void _RTLENTRY _pure_error_()
{
    //_ErrorExit("Pure virtual function called");
    throw Exception("Pure virtual function called");
} 
```

在调试时在代码中放置一个断点并在 IDE 中查看调用堆栈，否则如果您有相应的工具，则将调用堆栈记录在您的异常处理程序（或该函数）中。我个人为此使用 MadExcept。

PS。原始函数调用在 [C++ Builder]\source\cpprtl\Source\misc\pureerr.cpp

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-09-19T04:22:58.023

这是它发生的一种偷偷摸摸的方式。我今天基本上发生了这种情况。

```
class A
{
  A *pThis;
  public:
  A()
   : pThis(this)
  {
  }

  void callFoo()
  {
    pThis->foo(); // call through the pThis ptr which was initialized in the constructor
  }

  virtual void foo() = 0;
};

class B : public A
{
public:
  virtual void foo()
  {
  }
};

B b();
b.callFoo(); 
```

# ruby-on-rails - 您可以在没有源代码的情况下分发 Ruby on Rails 应用程序吗？

> ID：99553
> 
> 赞同：24
> 
> 时间：2008-09-19T04:09:29.413
> 
> 标签：ruby-on-rails, ruby, encoding, obfuscation

我想知道是否可以在没有源代码的情况下分发 RoR 应用程序以供生产使用？[我在 SO 上](https://stackoverflow.com/questions/55711/options-for-distribution-of-an-offline-ruby-on-rails-application)看过这篇文章，但我的情况有点不同。这将是一个由有一些线索的人管理的应用程序，所以我很高兴仍然需要在客户端设置 Apache/Mongrel/MySQL。我真正想要的只是保护源。编码似乎是分发 PHP 应用程序的一种流行方式（例如：[Helpspot](http://www.userscape.com/)）。

我找到了这些潜在的解决方案：

*   [Zenobfuscate](http://blog.zenspider.com/zenobfuscate/) - 然而，并非所有类型的 Ruby 代码都受支持，因此不包括在内
*   [Ruby Encoder](http://www.rubyencoder.com/) - 可能是最好的选择，因为他们的 PHP 编码器看起来不错（但是我还没有尝试过），但它还不可用。我以前用过 IONcube for PHP 并且效果很好，但[似乎 IONcube 还没有兴趣](http://forum.ioncube.com/viewtopic.php?t=839)。
*   [Slingshot](http://joyent.com/developers/slingshot/) - 在其他 SO 帖子中提到过，但它解决了与我不同的问题，并且源仍然可见。
*   [RubyScript2Exe](http://www.erikveen.dds.nl/distributingrubyapplications/rails.html) - 来自 doco，它还没有准备好生产，所以算了。

我听说可能使用 JRuby 和分发字节码可能是实现这一目标的一种方式，但我从未使用过 JRuby，所以我不确定其中涉及到什么。

任何人都可以提供任何想法和/或已知的例子吗？理想情况下，我也希望有某种自动构建方案。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-25T10:42:52.490

您现在最好的选择是使用 JRuby。一点背景：我的公司（[BitRock](http://bitrock.com "比特摇滚")) 与许多专有和商业开源供应商合作。我们帮助他们将通常基于 PHP、Java 或 Ruby 的服务器软件与 Web 服务器或应用程序服务器（Apache、Tomcat）、语言运行时和数据库（通常是 Postgres、MySQL）打包成一个独立的、易于使用的安装程序。我们有大量基于 PHP 的客户（包括您提到的 HelpSpot），但也有一些基于 Rails 的客户。对于 RoR 客户，标准是将 JRuby 与 Tomcat 或 Glassfish 一起使用，尽管在某些情况下，我们还捆绑了一个原生 Ruby 解释器来运行依赖于尚未移植到 JRuby 的库的特定脚本（通常不是应用程序的核心） . JRuby 已经迅速成熟，并且在许多情况下，它实际上比常规 Ruby 更快地运行他们的代码。您还需要考虑，尽管将代码移植到 JRuby 相当简单，但您需要在这方面投入一些时间。你可能想检查[JRuby Stack](http://bitnami.org/stack/jrubystack)，它是一个免费安装程序，可安装您入门所需的一切。祝你好运！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-24T15:11:10.747

如果您发布源代码、混淆或其他方式，您的应用程序将被盗版。例如，参见[Mint](http://www.haveamint.com/)。这取决于您要构建的内容，但您可能会发现最好将应用程序作为各种混合体发布：具有明确定义的 API 的托管应用程序，以及在客户服务器上运行的组件。只要你的产品的真正价值存在于服务器端，你就不需要混淆你的代码，你可以不加修改地发布源代码。此外，这也可能使您有机会接触到运行 PHP 而不是 Ruby 的客户端。例如，参见[Google Analytics](http://www.google.com/analytics/)、[HopToad](http://hoptoadapp.com/welcome)、[Scout](http://scoutapp.com/)等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T04:12:12.153

你可以，但它不会阻止某人逆向工程或修改它。我记得有一篇关于混淆 Perl 的类似尝试以及如何通过调试器和 5 分钟的努力有效地绕过它们的文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T04:35:42.330

如果你等不及 RubyEncoder 的交付，那么我认为 ZenObfuscate 是最有前途的。尽管可能需要对您的源代码进行一些修改，但他们确实在他们的网站上这样说：

> ZenObfuscate 的站点许可费用为 2500 美元，或者可以单独协商其他许可方案。是的，那很贵。那是故意的。但不要让这阻碍你太多。**如果您的产品真的很酷，并且我们希望看到它成功，我们会让它发挥作用。**“真的很酷”不是freecell。

当然，对于 2500 美元（或更多），您希望对编译器进行一些调整，以使您的代码库得到完全支持。让他们参与对话可能是值得的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T09:46:46.570

您还可以查看来自[ThoughtWorks 工作室的](http://studios.thoughtworks.com/)[Mingle](http://studios.thoughtworks.com/mingle-agile-project-management/mingle-download)作为使用 JRuby 的示例。这是一个 Ruby on Rails 应用程序，他们使用 JRuby 运行它。他们定制了 jruby 来加载加密的 .rb 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T08:13:37.377

看看[JumpBox](http://www.jumpbox.com/)。

我已经就这个话题与他们进行了对话，他们似乎有一个很快就会适用于 Rails 应用程序的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T07:51:47.540

我想知道您是否可以使用[RubyScript2Exe 之](http://www.erikveen.dds.nl/rubyscript2exe/)类的东西将 ruby​​ 代码“编译”成可执行文件？

老实说，我没有使用过它，但它似乎是您想要的，即使它只是将带有解释器的脚本打包成一个可执行文件。

# ajax - Ajax 会破坏性能吗？

> ID：99557
> 
> 赞同：2
> 
> 时间：2008-09-19T04:10:13.420
> 
> 标签：ajax, web-applications

过度使用 AJAX 会影响性能吗？在大型 Web 应用程序的上下文中，您如何处理 AJAX 请求以控制异步请求？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T04:13:31.667

过度使用任何东西都会降低性能；在必要时使用 AJAX 将提高性能，特别是如果替代方案是到服务器的完整整页往返 [asp.net 术语中的“回发”]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T04:31:56.940

这个故事有两个方面。

从客户端的角度来看，AJAX 通常会提高性能。与其加载整个页面，不如在需要时从服务器请求少量数据。鉴于 HTML 页面经常引用许多相关文件（图像、css、javascript 等，每个都需要来自服务器（或缓存）的命中），明智地使用 AJAX 的客户端性能可能非常出色。

在服务器端，问题变成了需要管理更多连接的问题之一。轮询应用程序，尤其是浏览器内聊天，确实会开始增加服务器的负载，因为浏览器现在访问服务器的速度要快得多。在典型的动态应用程序中（响应是由代码而不是静态文件生成的），您可能会开始遇到问题 - 但这些问题通常可以通过请求的复杂性通常低得多的事实来平衡（再次，您是'不是生成整个页面，而是页面的一小部分），因此您的平台在任何情况下都可能获得更高的吞吐量。

任何性能问题的确切结果将取决于许多因素，包括您的服务器、平台、框架和当时的主要气候条件。

我的终极建议 - 专注于创造良好的用户体验，智能开发，收集尽可能多的指标，并在您*知道*需要时进行优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T04:13:25.427

AJAX 本身（作为异步请求）.. 不一般。

但是，如果您有大量的 javascript 和标记，并且通过您的 xmlhttprequests 传输大量数据，那么是的，您会看到性能下降。这实际上取决于您希望您的网站如何运行，如果正确雕刻，通常可以避免任何退化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T04:17:15.010

究竟表现什么？我将假设您指的是应用程序在用户体验方面的性能。

Ajax 似乎最擅长的是仅在需要时才引起网络流量。它不是一次性下载一个很棒的网页，而是以尽可能快的方式只下载需要的内容。

然后，如果你做了一些需要更多信息的事情，它就会从网络上获取信息。

这意味着永远不会下载未使用的内容（当然，如果您设计正确 - 可以在 Ajax 中编写糟糕的代码，就像在任何其他环境中一样）。

我更喜欢将用于数据传输的 Ajax 方法和用于漂亮界面的 jQuery 等客户端库混合在一起。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T04:17:35.477

根据具体情况，AJAX 可能会产生性能开销，或者它实际上可以比不使用 AJAX 的同等功能的网站具有更好的性能。

过度使用 AJAX 很容易使服务器因大量无聊的请求而过载，并且还可能成为客户端 CPU 的负担。相反，AJAX 也可用于为每个请求提供少量 HTML 和其他代码，而不是整个页面，这至少对服务器的负担较小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T04:13:42.663

Ajax 只是一个普通的 HTTP 请求，所以只要您的服务器能够处理这些请求，就不会出现问题。Ajax 的好处是用户可以更快地感知性能，因为页面不必为每个用户操作重新加载和重新绘制自身。

如果可伸缩性是一个问题，我相信您也在考虑通过向服务器场添加更多 Web 服务器来水平扩展系统。无论如何，即使是非 Ajax Web 应用程序也是如此。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T04:16:39.833

AJAX 与任何技术一样，根据情况及其实施方式，可能是好事也可能是坏事。如果您对异步过程有特定需求，那么它是一个很好的工具。但是，如果您不负责任地使用它，您可能会遇到麻烦。如果您确实使用它，请尝试找到一个可以完成大部分繁重工作的良好框架，并了解 AJAX 的一些缺点...... [http://learningremix.net/w2007integ/vangoori/2007/01/the_downsides_of_ajax。 shtml](http://learningremix.net/w2007integ/vangoori/2007/01/the_downsides_of_ajax.shtml)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-22T17:40:17.760

我会同意这里的很多其他帖子。如果您以一种智能的方式使用它（即，不是每 30 秒使用一次 ajax），那就没问题了。我在我的网站上使用 ajax（还有一个 js 免费版本），从客户的角度来看，ajax 版本的加载速度从几乎相等到快四倍不等。这完全取决于网站的设计（图形和其他内容）以及您要更新的内容。

不利的一面是，由于您必须加载一些框架（即使您像我一样创建自己的框架），所以第一页的加载速度或任何完全刷新都会稍慢一些，并且确实会增加处理负载. 但这只是因为 ajax 提高了生产力，因此用户可以提出更多请求/更新

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-19T04:14:05.877

如果站点很忙，那么它最终会终止服务器，除非您在农场中。至于网站本身，它**不应该**。

# ruby-on-rails - 什么时候适合在 Rails 2.1 中使用 Time#utc？

> ID：99560
> 
> 赞同：5
> 
> 时间：2008-09-19T04:10:24.527
> 
> 标签：ruby-on-rails, ruby

我正在开发一个需要处理用户时区日期和时间的 Rails 应用程序。我们最近将它迁移到 Rails 2.1 并添加了时区支持，但在很多情况下我们使用 Time#utc 然后与那个时间进行比较。这与与原始 Time 对象进行比较不一样吗？

什么时候适合在 Rails 2.1 中使用 Time#utc？什么时候不合适？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T05:47:23.233

如果您已设置：

```
config.time_zone = 'UTC' 
```

在您的 environment.rb （默认情况下）中，当 ActiveRecord 存储它们时，时间将自动转换为 UTC。

然后，如果您将 Time.zone （通常在 application.rb 上的 before_filter 中）设置为用户的时区，所有时间都将自动从 utc 存储转换为用户的时区。

请小心使用 Time.now。

另见：

[http://mad.ly/2008/04/09/rails-21-time-zone-support-an-overview/](http://mad.ly/2008/04/09/rails-21-time-zone-support-an-overview/)

[http://errtheblog.com/posts/49-a-zoned-defense](http://errtheblog.com/posts/49-a-zoned-defense) - 你可以在这里使用 JS 来检测区域

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T05:13:26.687

如果您的应用程序有多个时区的用户，您应该始终以 UTC 存储您的时间（任何时区都可以，但您应该坚持最常见的约定）。

让用户输入本地时间，但转换为 UTC 存储（并比较和操作）。然后，从 UTC 转换回来以显示在每个用户的本地时区。

# c++ - 如何在非客户区绘图？

> ID：99623
> 
> 赞同：9
> 
> 时间：2008-09-19T04:23:26.273
> 
> 标签：c++, mfc, drawing, nonclient

我希望能够在窗口的非客户区的菜单栏右侧进行一些绘图。

这可能吗，使用 C++ / MFC？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-19T05:05:33.740

查理以`WM_NCPAINT`. 如果您使用的是 MFC，代码将如下所示：

```
// in the message map
ON_WM_NCPAINT()

// ...

void CMainFrame::OnNcPaint()
{
   // still want the menu to be drawn, so trigger default handler first
   Default();

   // get menu bar bounds
   MENUBARINFO menuInfo = {sizeof(MENUBARINFO)};
   if ( GetMenuBarInfo(OBJID_MENU, 0, &menuInfo) )
   {
      CRect windowBounds;
      GetWindowRect(&windowBounds);
      CRect menuBounds(menuInfo.rcBar);
      menuBounds.OffsetRect(-windowBounds.TopLeft());

      // horrible, horrible icon-drawing code. Don't use this. Seriously.
      CWindowDC dc(this);
      HICON appIcon = (HICON)::LoadImage(AfxGetResourceHandle(), MAKEINTRESOURCE(IDR_MAINFRAME), IMAGE_ICON, 16, 16, LR_DEFAULTCOLOR);
      ::DrawIconEx(dc, menuBounds.right-18, menuBounds.top+2, appIcon, 0,0, 0, NULL, DI_NORMAL);
      ::DestroyIcon(appIcon);
   }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T04:25:17.410

为了在非客户区绘制，你需要获取“窗口”DC（而不是“客户”DC），并在“窗口”DC中绘制。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-19T04:41:12.097

您应该尝试处理 WM_NCPAINT。这类似于普通的 WM_PAINT 消息，但处理的是整个窗口，而不仅仅是客户区。WM_NCPAINT 上的 MSDN 文档提供了以下示例代码：

```
case WM_NCPAINT:
{
 HDC hdc;
 hdc = GetDCEx(hwnd, (HRGN)wParam, DCX_WINDOW|DCX_INTERSECTRGN);
 // Paint into this DC
 ReleaseDC(hwnd, hdc);
} 
```

此代码旨在用于您的应用程序的消息循环中，该循环使用大型“开关”语句进行规范组织。

正如 Shog 的 MFC 示例中所述，请确保调用默认版本，在本示例中，这意味着调用 DefWindowProc。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T04:27:02.273

如果您只想要菜单栏中的某些内容，则将其添加为右对齐菜单项可能更容易/更清洁。这样它也可以与不同的 Windows 主题等一起使用。

# java - 什么是权威的 Java Swing 入门指南和参考？

> ID：99626
> 
> 赞同：8
> 
> 时间：2008-09-19T04:24:04.073
> 
> 标签：java, swing, groovy, griffon

显然是[Java API](http://java.sun.com/j2se/1.5.0/docs/api/)参考，但还有什么你们都使用的？

我的整个职业生涯都在做网络开发。最近我一直在搞乱[Groovy](http://groovy.codehaus.org)，我决定在[Griffon](http://groovy.codehaus.org/griffon)中做一个小应用程序，只是为了更多地试验Groovy 并在桌面开发方面取得一些突破。唯一的问题是，当谈到桌面应用程序时，我完全是绿色的。

那么，世界，从哪里开始呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T21:06:08.570

[Swing 教程](http://java.sun.com/docs/books/tutorial/uiswing/)非常好。除此之外，Swing API 显然*是*参考，但它也是相当不错的源代码的宝库！将 API 源添加到您的 IDE，您可以直接跳转到所有 Swing 类的实现。这是探索功能、了解各种 Swing 组件如何工作并学习良好的 Swing“风格”的好方法。此外，如果事情似乎不起作用并且您不知道为什么，那么能够单步执行 API 类是很棒的！将 API 源添加到 IDE 有一个额外的好处，即您可以获得所有的 JavaDocs，尽管所有现代 IDE 也可以[从网上](http://java.sun.com/j2se/1.4.2/docs/)提取它们——您**不需要**想要在没有 IDE 中可用文档的情况下对桌面 Java 进行编程！

NetBeans 和其他 IDE 确实使 IDE 的创建变得非常容易，但请注意，Swing 不仅仅是容器和布局管理器。事实上，容器和布局管理器是比较容易的事情，我也建议学习手动使用它们。使用 GUI 构建器并没有什么问题，但在某些情况下它是矫枉过正的，然后从源代码快速启动 GUI 会更好。在其他情况下，您需要能够动态创建 GUI，然后 GUI 构建器就完全没用了！为了从源代码创建非常复杂的布局，我推荐[FormLayout](http://www.jgoodies.com/freeware/forms/)，它有自己的一套怪癖，但它确实可以缩放（就编程工作而言）到非常大的框架和布局。

如果您到目前为止只使用过 Groovy，您会惊讶于 Swing 和 Java API 的其余部分的文档记录以及所有内容的集成程度。可能还需要一些时间来适应不同的编程风格，更频繁地使用调试器并减少 println-debugging 等等。可能还有一些“样板”代码会非常烦人。;） 享受。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T04:29:24.950

Sun Java 教程非常好。我不能专门为 Swing 做担保，因为自从我进行任何 Swing 开发以来已经很久了，而且我自己还没有阅读过它。

[使用 JFC/Swing 创建 GUI](http://java.sun.com/docs/books/tutorial/uiswing/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T16:31:01.460

在开发 Java 桌面应用程序时，我强烈建议使用 IDE 环境[Netbeans](http://www.netbeans.org)。尤其是在开发基于 Swing 的应用程序时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:41:06.117

我建议你玩一下netbeans。它将允许您仅使用鼠标构建完整的 GUI。一旦熟悉了 Swing 组件，就可以开始使用 Java API。我就是这样开始的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-17T23:20:59.743

[O'Reilly Swing Book](http://oreilly.com/catalog/9780596004088/)是一本很好的参考书，它很好地概述了一般的 Swing 概念并涵盖了每个主要类。我最近在 Swing 上刷新记忆时使用了它。

# javascript - 如何在没有庞大 JavaScript 库的情况下创建 Netflix 风格的 iframe 覆盖？

> ID：99640
> 
> 赞同：2
> 
> 时间：2008-09-19T04:27:12.147
> 
> 标签：javascript, css, overlay

我正在尝试使用链接来打开覆盖，而不是在单独的弹出窗口中。这个覆盖应该包含一个半透明的 div 层，它可以阻止整个屏幕被点击。我还打算在这一点上禁用滚动。无论您在主页上的哪个位置，单击链接时，叠加层都应位于屏幕 X 和 Y 原点的中心。在这个覆盖 div 内部，应该是一个 iframe 配置，以便可以加载 3 种大小的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T09:07:08.480

[Shadowbox](http://mjijackson.com/shadowbox/)是一个很好的内联“弹出窗口”脚本。如果您使用任何（jQuery、Prototype 等）或单独使用，它可以与任何常用的 JS 库一起使用，它具有非常全面的皮肤系统，因此您可以调整外观而无需进入源代码本身。
它也是我尝试过的唯一一个可以在所有常用浏览器中可靠运行的脚本（有几十个）。

它不会为您禁用滚动（您仍然可以通过深色覆盖看到正常的页面背景滚动），但“弹出窗口”无论如何都会固定在屏幕上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-22T13:22:33.580

[http://onehackoranother.com/projects/jquery/boxy/](http://onehackoranother.com/projects/jquery/boxy/)

jQuery.boxy 是另一个不错的轻量级模态对话框插件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:18:06.693

你可能想看看我写的一个旧的 JS 库，叫做[SubModal](http://code.google.com/p/submodal/)。

易于理解和修改。去镇上；）

一旦你修改了它，在你的服务器上结合使用[Minify和 gzip。](http://code.google.com/p/minify/)库的大小会很小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T12:36:53.707

我通常为此使用[ThickBox](http://jquery.com/demo/thickbox/)。如果用户没有打开 JS，它工作得非常好并且会很好地降级。

它确实使用 jQuery，但您可以从 Google 加载它：http: [//ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js)并且可能会受益于缓存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T04:31:19.983

获取 javascript [ext](http://extjs.com/)库。它具有模态叠加的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-13T14:44:17.277

ThickBox（不再开发）让我找到了这个似乎运行良好的库：

[http://fancybox.net](http://fancybox.net)

# c# - 资源管理器和单元测试

> ID：99642
> 
> 赞同：5
> 
> 时间：2008-09-19T04:27:41.990
> 
> 标签：c#, asp.net, asp.net-mvc, resources

我很好奇是否有人在使用 ResourceManager 创建单元测试时遇到任何问题。我正在使用 Visual Studio 测试版，并且在测试期间似乎没有加载附属程序集。当我尝试为另一种文化获取资源时，测试总是失败并且资源管理器总是回退到默认文化。完全相同的代码在正常应用程序中运行良好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T05:29:16.740

这让我朝着正确的方向前进。将文件添加到部署配置没有帮助，但禁用部署确实有效。

如需将来参考，请访问[此博客文章](http://stephenwalther.com/blog/archive/2008/03/20/tdd-test-driven-development-with-visual-studio-2008-unit-tests.aspx)并向下滚动到“管理测试运行”部分，了解有关创建测试配置以及如何禁用部署的详细信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-17T13:02:20.887

如果您正在运行 MSTest 并且想要访问中性区域性以外的资源，则需要确保将特定区域性的附属程序集部署到解决方案文件夹中的测试目录。

只需将此属性添加到您的单元测试中：

```
[DeploymentItem( @"de-DE\AssemblyName.resources.dll", "de-DE")] 
```

这会将资源程序集部署到指定区域性相关子目录中的测试目录。

[来源](https://lionelve.wordpress.com/2009/08/13/satellite-assemblies-for-custom-cultures/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T04:30:55.837

过去我在卫星组件上遇到过类似的问题。尝试将附属程序集添加到单元项目依赖项中。在 Visual Studio 测试中 - 编辑测试运行配置。选择部署并在此处添加文件。

在执行所有应用程序时，dll 等都被复制到一个特殊的目录中。强命名的 dll 可能会被忽略，因为它们应该在 GAC 中。

# css - CSS Reset，常用元素的默认样式

> ID：99643
> 
> 赞同：54
> 
> 时间：2008-09-19T04:28:29.913
> 
> 标签：css, css-reset

应用 CSS 重置后，我想恢复 html 元素的“正常”行为，例如：p、h1..h6、strong、ul 和 li。

现在，当我说正常时，我的意思是，例如 p 元素在使用时添加间距或类似结果的回车，或者 h1 标签的字体大小和粗度，以及间距。

我意识到如何设置样式完全取决于我，但我想为一些更常见的元素恢复正常行为（至少作为我稍后可以调整的起点）。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-19T04:43:33.370

YUI 提供了一个基本的 CSS 文件，它将在所有[“A 级”](http://web.archive.org/web/20170209084319/https://developer.yahoo.com/yui/articles/gbs/)浏览器中提供一致的样式。他们还提供了一个 CSS 重置文件，所以你也可以使用它，但你说你已经重置了 CSS。有关详细信息，请访问[YUI 网站](http://yuilibrary.com/)。这是我一直在使用的，而且效果很好。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-19T04:46:27.997

应用 CSS 样式的规则之一是“最后胜出”。这意味着，如果您的 CSS 重置样式为您设置了元素，`margin:0; padding:0`那么您可以通过在之后为相同元素声明您想要的值来覆盖这些规则。

您可以在同一个文件中执行此操作（我认为 YUI 提供了单行重置，因此我有时将其作为我的 CSS 文件的第一行包含）或在重置 CSS`<link/>`标记之后出现的单独文件中执行此操作。

我认为*正常行为*是指“我最喜欢的浏览器的默认设置”。为这些元素建立 CSS 规则是重置练习的一部分。

现在您可能想要研究[Blueprint CSS](http://www.blueprintcss.org/)或其他网格框架。这些网格框架几乎总是首先将样式重置为空，然后为常见元素构建排版等。这可以为您节省一些时间和精力。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-19T04:30:55.617

你的意思是：

```
* {
    padding: 0;
    margin: 0;
}

h1, h2, h3, h4, h5, h6, p, blockquote, form, label, ul, ol, dl, fieldset, address {
    margin-bottom: 1em;
} 
```

?

实际上，对不起，我误读了您的问题，您追求的更像是 Eric Meyer 的完全重置@ [http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-11-10T16:14:24.827

与其使用完全的 CSS 重置，不如考虑使用[Normalize](https://github.com/necolas/normalize.css/)之类的东西，它“保留有用的默认值”。

要了解*您的*浏览器默认设置的内容，请打开一个带有列表的**纯HTML 文件，并使用诸如**[Firebug](http://getfirebug.com/)之类的 CSS 调试器查看列表，然后查看`Computed`选项卡下的内容。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-25T01:03:04.747

查看 YUI（雅虎的开源用户界面约定）。

他们有一个基本样式表，可以撤消他们自己的重置 css。他们实际上并不建议您在生产中使用它 - 因为它会适得其反，但绝对值得查看文件以获取您想要“撤消”的相关片段。

我建议您观看 40 分钟的[谈话](http://developer.yahoo.com/yui/base/)以加快进度。

下面是他们的 base.css 文件的一个简短片段：

```
ol li {
    /*giving OL's LIs generated numbers*/
    list-style: decimal outside;    
}
ul li {
    /*giving UL's LIs generated disc markers*/
    list-style: disc outside;
}
dl dd {
    /*giving UL's LIs generated numbers*/
    margin-left:1em;
}
th,td {
    /*borders and padding to make the table readable*/
    border:1px solid #000;
    padding:.5em;
}
th {
    /*distinguishing table headers from data cells*/
    font-weight:bold;
    text-align:center;
} 
```

下载下面的完整样式表或[阅读完整文档。](http://developer.yahoo.com/yui/base/)

[雅虎重置 CSS](http://real.us.yimg.com/lib/yui/2.6.0/build/reset/reset.css) | [雅虎基地（撤消）重置CSS](http://real.us.yimg.com/lib/yui/2.6.0/build/base/base.css)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-25T01:07:35.377

[我个人是BlueprintCSS](http://www.blueprintcss.org/)的忠实粉丝。它可以跨浏览器重置样式并提供一些非常方便的默认值（这是您 90% 的时间想要的）。它还提供了一个布局网格，但如果您不需要它，则不必使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-20T18:37:11.667

如果您想查看 firefox 的 css 默认值，请在发行版中查找名为“html.css”的文件（同一目录中应该还有一些其他有用的 css 文件）。您可以选择您想要的规则，并在重置后应用它们。

此外，CSS2 标准有一个[html 4 的示例样式表](http://www.w3.org/TR/CSS2/sample.html)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-12-23T23:13:08.327

[WebKit h1 的正常行为](http://trac.webkit.org/browser/trunk/WebCore/css/html.css#L126)：

```
h1 {
    display: block;
    font-size: 2em;
    margin: .67__qem 0 .67em 0;
    font-weight: bold
} 
```

[Gecko h1 的正常行为](http://mxr.mozilla.org/mozilla-central/source/layout/style/html.css#124)：

```
h1 {
    display: block;
    font-size: 2em;
    font-weight: bold;
    margin: .67em 0;
} 
```

如果您搜索文件，其余元素应该在那里。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-17T16:16:26.480

“应用 CSS 重置后，我想恢复 html 元素的‘正常’行为......”

如果您已应用重置，则必须添加您认为是*正常行为*的规则。由于*正常行为*因浏览器而异，所以这个问题是不合理的。我喜欢@da5id 的回答 - 使用众多可用的重置之一并对其进行调整以满足您的需求。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-07-28T08:53:24.477

一旦你给一个元素的 CSS 属性赋值，就没有办法取回它的“正常”值，假设“正常”意味着“浏览器默认”，就像这里的意思一样。因此，让一个`h1`元素拥有浏览器默认值的唯一方法`font-size`是在 CSS 代码中*根本不为其设置属性。*

因此，要使某些属性和元素免于 CSS 重置，您需要使用更有限的 CSS 重置。例如，您不能使用选择器列表，`* { font-size: 100% }`而是用选择器列表替换`*`，例如`input, textarea { font-size: 100% }`（列表可能很长，但例如浏览器默认值`font-size`与 100% 不同，仅针对少数元素）。

当然可以将属性设置为您*希望*成为浏览器默认值的值。无法保证这将对当前和未来的所有浏览器产生预期的效果。但是对于某些属性和元素，这可能是相对安全的，因为默认值往往是相似的。

特别是，您可能会使用HTML5 CR 中的[渲染部分。](http://www.w3.org/TR/html5/rendering.html#rendering)它描述了“预期渲染”——不是一个要求，尽管浏览器供应商可能会根据他们的意愿决定声明与它们的一致性，并且通常这可能会使实现在这方面保持相当相似。例如，对于`h1`预期的设置（这里收集到一个规则中——在 HTML5 CR 中它们分散在各处）：

```
h1 {
unicode-bidi: isolate;
display: block;
margin-top: 0.67em;
margin-bottom: 0.67em;
font-size: 2.00em;
font-weight: bold;
} 
```

（还有额外的上下文规则。例如，嵌套`h1`在里面`section`预计会影响设置。）

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-12-21T07:47:41.113

默认情况下，我不会重置所有元素，因为默认样式在某种程度上取决于浏览器，因此它们因浏览器而异。我没有使用类似的东西`ul, ol { list-style: none; }`，而是添加了一个类似的 CSS 类`r`or`reset`然后我指定如果这是一个`ul`有`r`类的，请重置它，否则请保持不变。

顺便说一句，您需要添加`class="reset"`（例如）所有这些元素，这是额外的工作和代码，但是作为回报，您最终会保留所有默认样式！

# c# - 可扩展的套接字事件队列处理

> ID：99651
> 
> 赞同：4
> 
> 时间：2008-09-19T04:31:40.343
> 
> 标签：c#, sockets, networking, tcp, stream

我的 C# 类必须能够处理通过 tcp 流式套接字连接接收到的大量事件。类的套接字从 tcp 服务器接收到的事件消息的数量是完全可变的。例如，有时它会在 10 秒内只收到一条事件消息，而有时它会在一秒钟内收到 60 条事件消息。

我正在使用 Socket.ReceiveAsync 接收消息。如果接收操作处于未决状态，则 ReceiveAsync 返回 true；如果线路上已有数据且接收操作同步完成，则返回 false。如果操作挂起，Socket 将在 IO 完成线程上调用我的回调，否则我在当前 (IOC) 线程中调用我自己的回调。此外，与事件消息混合，我还收到对发送到此 tcp 服务器的命令的响应。立即处理响应消息；单独地，通过解雇一个线程池工作者。

但是，我想对事件消息进行排队，直到我有“足够”（N）个事件消息，或者直到网络上没有更多消息……然后启动线程池工作程序来处理一批事件消息。此外，我希望按顺序处理所有事件，因此我只希望一个线程池工作人员一次处理此问题。

事件消息的处理器只需将消息缓冲区复制到一个对象中，引发一个事件，然后将消息缓冲区释放回环形缓冲区池。所以我的问题是......你认为实现这一目标的最佳策略是什么？

您需要更多信息吗？让我知道。谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T04:38:26.410

我不会将每秒 60 个事件称为高音量。在这种低水平的活动中，任何套接字处理方法都可以。我已经在一个线程上每秒处理了 5,000 个事件，使用的硬件能力比当前的机器低得多，仅使用 select。

我会说，如果您希望扩展，在线程之间单独传递消息将是一场灾难。您需要批处理，否则您的上下文切换会降低性能。

# c# - 将 ListView 与对象集合相关联

> ID：99653
> 
> 赞同：2
> 
> 时间：2008-09-19T04:31:57.707
> 
> 标签：c#, listview, dictionary

如何使用 ListView 向用户显示对象集合并管理这些对象？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T04:32:03.400

出于论证的目的，这是我们的设计目标：我们有一个“怪物”对象，而那个“怪物”将有几个“权力”。用户通过 ListView 项与权力进行交互。

首先，我们创建一个 Power 对象。为对象提供以下方法：

```
public ListViewItem makeKey()
{
    return new ListViewItem(name);
} 
```

其中 name 是幂的名称和一个字符串。这个 ListViewItem 将作为一个键，允许我们稍后识别和检索这个权力。

接下来，我们需要在 Monster 对象中添加某个位置来跟踪所有这些能力。

```
public Dictionary<ListViewItem,Power> powers; 
```

所以现在我们需要一种方法来为怪物增加力量。

```
public void addPower(Power newPower) {
    ListViewItem key = newPower.makeKey();
    monster.powers.add(key, newPower);
} 
```

好的，差不多完成了！现在我们有了一个与怪物的力量相关的 ListViewItems 字典。只需从该字典中获取键并将它们粘贴到 ListView 中：

```
foreach (ListViewItem key in powers.Keys)
    powerList.Items.Add(key); 
```

其中 powerList 是我们要添加 ListViewItems 的 ListView。

好的，所以我们在 ListView 中得到了 ListViewItems！现在，我们如何与这些互动？制作一个按钮，然后制作一个类似这样的功能：

```
private void powerRemoveButton_Click(object sender, EventArgs e)
{
    if (powerList.SelectedIndices.Count > 0)
    {
        int n = powerList.SelectedIndices[0];
        ListViewItem key = powerList.Items[n];
        monster.powers.Remove(key);
        powerList.Items.Remove(key);
    }
    else
    {
        MessageBox.Show("No power selected.");
    }
} 
```

就是这样。我希望你发现这很有帮助。我不确定这是否是他们设计的有意方面，但是当您使用 ListViewItem 作为键时，ListViews 和字典可以完美地融合在一起，这很有趣！

# svn - 每次提交后运行单元测试的最佳方式？- svn - 每个功能的分支

> ID：99654
> 
> 赞同：4
> 
> 时间：2008-09-19T04:32:01.807
> 
> 标签：svn, unit-testing, tortoisesvn, qa

在每次提交后运行您的单元测试套件的最佳方法是什么？

我对您在分支中执行所有功能/更改并保持主干稳定的情况特别感兴趣。

我的源代码控制是 SVN，我使用 tortoise SVN 作为我的客户端。

是否有 SVN 事件或类似的东西可以称为 .cmd/.bat 文件？

如果答案是巡航控制，如何使用巡航控制检查所有分支？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-19T04:41:07.963

我认为您可能应该在提交*之前*运行您的单元测试。如果您要在每次提交时进行测试，则应尽早进行以拒绝重大更改。

你可以用[subversion hooks](http://svnbook.red-bean.com/en/1.1/ch05s02.html#svn-ch-5-sect-2.1)做到这一点。如果添加`pre-commit`挂钩，则可以在提交发生之前进行构建/测试。挂钩脚本将在服务器上执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T04:34:35.467

您需要像 CruiseControl 这样的持续集成服务器。这将监视 svn 的更改，在提交时触发构建，通过测试套件运行跟进它并直接在系统托盘中标记任何错误（或电子邮件或任何您觉得舒服的通知）您需要通过编写来设置 CruiseControl定义项目需求的小脚本（主要是 XML）。推荐。。尝过就回不去了。 [这是我当天设置的](http://madcoderspeak.blogspot.com/2005/09/building-your-own-continuous.html)

**更新**：我认为没有全局检查所有分支类型的设置。每个分支应该是一个不同的主干 url ......这意味着 CruiseControl 的不同项目。如果您遵循推荐的 subversion 分支方式（[请参见此处](http://confluence.public.thoughtworks.org/display/CCNET/SCM+Policy)），由于 CruiseControl 本身似乎正在使用 Subversion 中的分支.. 这似乎是要走的路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T04:34:16.110

我也会设置一个自动构建/部署过程。查看 Cruise Control - 它可以在部署之前运行单元测试。

[http://cruisecontrol.sourceforge.net/](http://cruisecontrol.sourceforge.net/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T08:15:41.647

使用[Buildbot](http://buildbot.net/trac)。

这有一个名为 svn_buildbot.py 的实用程序，可以从您的 subversion post-commit 脚本中调用。

Buildbot 已被颠覆（以及许多其他 VC 系统），因此可以配置为从您已提交的分支中提取新修订。它还提供电子邮件通知和 Web 界面，用于状态检查和强制在特定修订/分支上构建。

# open-source - 多功能3D人工生命引擎？

> ID：99682
> 
> 赞同：6
> 
> 时间：2008-09-19T04:41:48.367
> 
> 标签：open-source, physics, artificial-life

研究涌现，建立一个开发框架来快速测试新想法是非常有用的。带有物理碰撞的 3d 会很好，开源将是一大优势。为此，“breve”看起来很有希望，但我想知道是否有人使用过它或知道任何其他合适的引擎？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T15:41:01.837

为了快速开发，breve 看起来确实合适。如果您想从头开始编写更多内容，[ODE](http://www.ode.org/)、[Bullet](http://code.google.com/p/bullet/)和[Tokamak](http://www.tokamakphysics.com/)都是很好的开源 3D 物理和碰撞检测库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T03:30:15.710

我会继续使用**breve**。如果您在问题中没有提到 breve，我会推荐它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T03:08:15.367

如果我正确理解了这个问题，那么您正在寻找的更多的是一个可编程的 3D 图形/物理引擎沙箱来尝试想法，而不是专门与人造生命有关的任何东西。

如果是这样，您可能想看看[fluxus](http://www.pawfal.org/fluxus/) - 基本上就是这样，“可编程”部分是Scheme。它是为*交互式*编程而设计的（绘制 3D 场景和动画，然后实时更改它们），所以我猜它对于基于代理的 AI/AL 应该足够灵活。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-27T11:21:37.880

我会亲自使用 Processing 或 ODE 自己编写代码。它会非常快，因为两者都有大量的库。

但我想您也可以使用其中之一（非详尽列表）：

*   短：http: [//spiderland.org/](http://spiderland.org/)
*   金宁：[https ://code.google.com/p/jinngine/](https://code.google.com/p/jinngine/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T10:42:48.477

也许不是 100% 您正在寻找的东西，但您可以尝试[开放式转向](http://opensteer.sourceforge.net/)作为可能的起点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T09:33:41.910

实际上，我认为像 Microsoft Robotics Studio 这样的东西会对此有好处。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-09-23T15:59:28.267

我最近问了一个关于机器人仿真的[类似问题。](https://stackoverflow.com/questions/3700567/open-source-pure-java-physics-dynamics-library)

[JBullet](http://jbullet.advel.cz/)（Bullet Physics 引擎的 Java 移植版）被列为首选。

我将它与[jMonkeyEngine](http://www.jmonkeyengine.com/)（这是一个功能齐全且流行的游戏引擎）结合使用，用于渲染、相机控制、场景图管理等。这似乎工作得非常好，因为这两者被设计为一起工作.

# language-agnostic - 哪个，为什么，你更喜欢异常或返回代码？

> ID：99683
> 
> 赞同：98
> 
> 时间：2008-09-19T04:43:14.853
> 
> 标签：language-agnostic, exception

我的问题是大多数开发人员更喜欢错误处理、异常或错误返回代码。请具体说明语言（或语系）以及为什么您更喜欢其中一种。

我是出于好奇而问这个的。就我个人而言，我更喜欢错误返回代码，因为它们的爆炸性较小，并且如果用户不想这样做，也不会强制用户代码支付异常性能损失。

更新：感谢所有答案！我必须说，尽管我不喜欢带有异常的代码流的不可预测性。关于返回码（和他们的哥哥句柄）的答案确实给代码增加了很多噪音。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2008-09-21T15:20:36.230

# 对于某些语言（即 C++），资源泄漏不应成为原因

C++ 基于 RAII。

如果您有可能失败、返回或抛出的代码（即大多数普通代码），那么您应该将指针包装在智能指针中（假设您有*充分*的理由不在堆栈上创建对象）。

# 返回码更详细

它们很冗长，并且倾向于发展成以下内容：

```
if(doSomething())
{
   if(doSomethingElse())
   {
      if(doSomethingElseAgain())
      {
          // etc.
      }
      else
      {
         // react to failure of doSomethingElseAgain
      }
   }
   else
   {
      // react to failure of doSomethingElse
   }
}
else
{
   // react to failure of doSomething
} 
```

最后，您的代码是标识指令的集合（我在生产代码中看到了这种代码）。

这段代码可以翻译成：

```
try
{
   doSomething() ;
   doSomethingElse() ;
   doSomethingElseAgain() ;
}
catch(const SomethingException & e)
{
   // react to failure of doSomething
}
catch(const SomethingElseException & e)
{
   // react to failure of doSomethingElse
}
catch(const SomethingElseAgainException & e)
{
   // react to failure of doSomethingElseAgain
} 
```

它干净地将代码和错误处理分开，这**可能**是一件**好事**。

# 返回码更脆弱

如果不是来自某个编译器的一些晦涩的警告（参见 "phjr" 的评论），它们很容易被忽略。

对于上述示例，假设有人忘记处理其可能的错误（发生这种情况......）。该错误在“返回”时会被忽略，并且可能会在以后爆炸（即 NULL 指针）。同样的问题不会发生异常。

错误不会被忽略。有时候，你希望它不爆炸，但是……所以你必须谨慎选择。

# 有时必须翻译返回码

假设我们有以下功能：

*   doSomething，它可以返回一个名为 NOT_FOUND_ERROR 的 int
*   doSomethingElse，它可以返回一个布尔“假”（失败）
*   doSomethingElseAgain，它可以返回一个错误对象（包含 __LINE__、__FILE__ 和一半的堆栈变量。
*   doTryToDoSomethingWithAllThisMess 其中，嗯......使用上述函数，并返回类型的错误代码......

如果其调用函数之一失败，则 doTryToDoSomethingWithAllThisMess 的返回类型是什么？

# 返回码不是通用解决方案

运算符不能返回错误代码。C++ 构造函数也不能。

# 返回代码意味着您不能链接表达式

以上观点的推论。如果我想写：

```
CMyType o = add(a, multiply(b, c)) ; 
```

我不能，因为返回值已被使用（有时，它无法更改）。所以返回值成为第一个参数，作为参考发送......或者不是。

# 输入异常

您可以为每种异常发送不同的类。资源异常（即内存不足）应该是轻量级的，但其他任何事情都可以根据需要变得很重（我喜欢 Java Exception 给我整个堆栈）。

然后可以对每个捕获进行专门化。

# 永远不要在不重新抛出的情况下使用 catch(...)

通常，您不应隐藏错误。如果您不重新抛出，至少将错误记录在文件中，打开消息框，无论如何......

# 例外是...... NUKE

异常的问题是过度使用它们会产生充满尝试/捕获的代码。但问题出在其他地方：谁使用 STL 容器尝试/捕获他/她的代码？尽管如此，这些容器仍然可以发送异常。

当然，在 C++ 中，永远不要让异常退出析构函数。

# 例外是......同步

确保在它们使您的线程跪下或在您的 Windows 消息循环中传播之前抓住它们。

# 解决方案可能是混合它们？

所以我想解决方案是在不应该发生的事情时**抛出**。当某些事情可能发生时，然后使用返回码或参数使用户能够对其做出反应。

所以，唯一的问题是“什么是不应该发生的事情？”

这取决于您的功能合同。如果函数接受一个指针，但指定指针必须为非NULL，那么当用户发送一个NULL指针时抛出异常是可以的（问题是，在C++中，函数作者什么时候不使用引用代替的指针，但是...）

# 另一种解决方案是显示错误

有时，您的问题是您不希望出现错误。使用异常或错误返回代码很酷，但是……您想了解它。

在我的工作中，我们使用一种“断言”。无论调试/发布编译选项如何，它都会根据配置文件的值：

*   记录错误
*   打开一个带有“嘿，你有问题”的消息框
*   打开一个带有“嘿，你有问题，你想调试”的消息框

在开发和测试中，这使用户能够在检测到问题时准确地查明问题，而不是之后（当某些代码关心返回值时，或者在 catch 内）。

很容易添加到遗留代码中。例如：

```
void doSomething(CMyObject * p, int iRandomData)
{
   // etc.
} 
```

导致一种类似于以下的代码：

```
void doSomething(CMyObject * p, int iRandomData)
{
   if(iRandomData < 32)
   {
      MY_RAISE_ERROR("Hey, iRandomData " << iRandomData << " is lesser than 32\. Aborting processing") ;
      return ;
   }

   if(p == NULL)
   {
      MY_RAISE_ERROR("Hey, p is NULL !\niRandomData is equal to " << iRandomData << ". Will throw.") ;
      throw std::some_exception() ;
   }

   if(! p.is Ok())
   {
      MY_RAISE_ERROR("Hey, p is NOT Ok!\np is equal to " << p->toString() << ". Will try to continue anyway") ;
   }

   // etc.
} 
```

（我有类似的宏，仅在调试时有效）。

请注意，在生产中，配置文件不存在，因此客户端永远不会看到此宏的结果...但是在需要时很容易激活它。

# 结论

当您使用返回码进行编码时，您正在为失败做好准备，并希望您的测试堡垒足够安全。

当您使用异常编码时，您知道您的代码可能会失败，并且通常将 counterfire catch 放在代码中选定的战略位置。但通常，您的代码更多的是关于“它必须做什么”而不是“我担心会发生什么”。

但是当你编写代码时，你必须使用你可以使用的最好的工具，有时，它是“永远不要隐藏错误，并尽快显示它”。我上面所说的宏遵循这个哲学。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-09-19T04:46:48.200

我实际上两者都用。

如果它是已知的、可能的错误，我会使用返回码。如果这是我知道可以并且将会发生的场景，那么就会有一个代码被发回。

例外仅用于我不期望的事情。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-09-19T08:06:16.130

根据**Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries**中标题为“异常”的第 7 章，给出了许多理由说明为什么在 C# 等 OO 框架中必须使用异常而不是返回值。

也许这是最令人信服的原因（第 179 页）：

“异常与面向对象的语言很好地集成。面向对象的语言倾向于对成员签名施加约束，这些约束不是由非 OO 语言中的函数施加的。**例如，在构造函数、运算符重载和属性的情况下，开发人员在返回值上没有选择。**因此，无法标准化面向对象框架的基于返回值的错误报告。**错误报告方法，例如异常，超出方法签名的范围是唯一的选择。** ”

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-19T04:50:53.057

我的偏好（在 C++ 和 Python 中）是使用异常。语言提供的工具使其成为一个明确定义的过程，可以引发、捕获和（如有必要）重新抛出异常，从而使模型易于查看和使用。从概念上讲，它比返回代码更简洁，因为可以通过名称定义特定异常，并附带附加信息。使用返回码，您仅限于错误值（除非您想定义 ReturnStatus 对象或其他东西）。

除非您正在编写的代码是时间关键的，否则与展开堆栈相关的开销并不足以担心。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-19T04:51:21.713

只有在您没有预料到的事情发生时才应返回异常。

从历史上看，另一个例外点是返回码本质上是专有的，有时可以从 C 函数返回 0 表示成功，有时返回 -1，或者其中任何一个表示失败，1 表示成功。即使枚举它们，枚举也可能是模棱两可的。

异常还可以提供更多信息，并明确说明“出了点问题，这是什么，堆栈跟踪和上下文的一些支持信息”

话虽这么说，一个很好枚举的返回码对于一组已知的结果很有用，一个简单的“函数的这里有 n 个结果，它只是以这种方式运行”

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-10-27T19:41:27.073

**默认情况下始终使用异常，但考虑提供额外的 tester-doer 选项（TryX）！** 对我来说，答案很明确。当上下文指示 Try 或 Tester-Doer 模式（即 cpu 密集型或公共 api）时，我将另外将这些方法提供给异常抛出版本。我认为避免异常的一揽子规则是错误的、不受支持的，并且可能会导致比他们声称要防止的任何性能问题更多的错误费用。

**不，[微软](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/exceptions-and-performance)没有说不使用异常（常见的误解）。**

它说，如果您正在**设计 API** ，请提供方法来帮助该 API 的用户在需要时避免抛出异常（Try 和 Tester-Doer 模式）

> ❌ 如果可能，请勿将异常用于正常的控制流程。
> 
> 除了系统故障和具有潜在竞争条件的操作外，框架设计者应该设计 API，以便用户可以编写不会引发异常的代码。例如，您可以提供一种在调用成员之前检查先决条件的方法，以便用户可以编写不会引发异常的代码。

*这里推断的是，非测试执行者/非尝试实现应该在失败时抛出异常，然后用户可以将其更改为您的测试执行者之一或尝试性能方法。成功的坑是为了安全而维护的，用户选择使用更危险但更高效的方法。*

**微软确实说过不要使用返回码 TWICE，[这里](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/exception-throwing)：**

> ❌ 不要返回错误代码。
> 
> 异常是在框架中报告错误的主要方式。
> 
> ✔️ 务必通过抛出异常来报告执行失败。

[在](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/exceptions-and-performance)这里：

> ❌ 不要使用错误代码，因为担心异常可能会对性能产生负面影响。
> 
> 为了提高性能，可以使用 Tester-Doer Pattern 或 Try-Parse Pattern，这将在接下来的两节中介绍。

*如果您不使用异常，则可能违反了从非测试/非尝试实现返回返回码或布尔值的其他规则。同样，TryParse 不会取代 Parse。它是除了 Parse 之外提供的*

**主要原因：返回代码几乎每次都未能通过“[成功坑”测试。](https://blogs.msdn.microsoft.com/ricom/2015/12/16/pit-of-success-for-organizations/)**

*   很容易忘记检查返回码，然后稍后会出现红鲱鱼错误。
    *   var 成功 = 保存（）？有多少性能值得有人在这里忘记 if 检查？
    *   var 成功 = TrySave()? 更好，但我们会滥用 TryX 模式吗？您仍然提供 Save 方法吗？
*   返回代码没有任何关于它们的重要调试信息，如调用堆栈、内部异常。
*   返回代码不会传播，这与上述几点一起，往往会导致过度和交织的诊断日志记录，而不是记录在一个集中的位置（应用程序和线程级异常处理程序）。
*   返回码倾向于以嵌套的“if”块的形式驱动混乱的代码
*   开发人员花费在调试未知问题上的时间，否则这将是一个明显的例外（成功的坑）是昂贵的。
*   如果 C# 背后的团队不打算用异常来管理控制流，则不会键入异常，catch 语句上将没有“when”过滤器，也不需要无参数的“throw”语句.

**关于性能：**

*   相对于根本不抛出异常而言，异常可能在计算上是昂贵的，但出于某种原因，它们被称为异常。速度比较总是设法假设 100% 的异常率，这绝不应该是这种情况。即使一个异常慢了 100 倍，如果它只发生 1% 的时间，这又有什么关系呢？

*   上下文就是一切。例如，避免唯一键违规的 Tester-Doer 或 Try 选项可能平均浪费更多的时间和资源（在很少发生冲突时检查是否存在），而不是仅仅假设成功进入并捕获罕见的违规。

*   除非我们在讨论图形应用程序的浮点运算或类似的东西，否则与开发人员时间相比，CPU 周期很便宜。

*   从时间的角度来看，成本也有同样的论据。相对于数据库查询或 Web 服务调用或文件加载，正常的应用程序时间将使异常时间相形见绌。2006 年的例外情况接近[亚微秒](http://stackoverflow.com/questions/891217/how-expensive-are-exceptions-in-c)

*   我敢于在 .net 中工作的任何人设置调试器以中断所有异常并仅禁用我的代码，看看已经发生了多少你甚至不知道的异常。

*   Jon Skeet 说[“[Exceptions are] 不够慢，因此值得在正常使用中避免它们”](http://not%20slow%20enough%20to%20make%20it%20worth%20avoiding%20them%20in%20normal%20use)。链接的响应还包含 Jon 关于该主题的两篇文章。他的概括性主题是异常很好，如果您将它们视为性能问题，则可能存在更大的设计问题。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-19T04:58:00.420

在 Java 中，我使用（按以下顺序）：

1.  *按合同设计（确保在尝试任何*可能失败的事情之前满足先决条件）。这可以捕获大多数东西，我为此返回一个错误代码。

2.  在处理工作时返回错误代码（并在需要时执行回滚）。

3.  例外，但这些*仅*用于意想不到的事情。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-19T05:05:20.247

我不喜欢返回码，因为它们会导致以下模式在您的代码中迅速蔓延

```
CRetType obReturn = CODE_SUCCESS;
obReturn = CallMyFunctionWhichReturnsCodes();
if (obReturn == CODE_BLOW_UP)
{
  // bail out
  goto FunctionExit;
} 
```

很快，一个由 4 个函数调用组成的方法调用膨胀到 12 行错误处理。其中一些永远不会发生。If 和 switch 案例比比皆是。

如果您使用得当，异常会更清晰......发出异常事件的信号......之后执行路径将无法继续。它们通常比错误代码更具描述性和信息性。

如果您在方法调用后有多个状态，应该以不同方式处理（并且不是例外情况），请使用错误代码或输出参数。虽然 Personaly 我发现这很罕见..

我已经对“性能损失”的反驳进行了一些研究。在 C++ / COM 世界中更多的是，但在较新的语言中，我认为差异并不大。在任何情况下，当发生故障时，性能问题都会被放到次要位置:)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-19T05:00:50.740

不久前，我写了[一篇](http://typethinker.blogspot.com/2007/04/checks-exceptions-and-assertions.html)关于此的博客文章。

抛出异常的性能开销不应在您的决定中发挥任何作用。毕竟，如果你做对了，例外就是*例外*。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-19T04:53:47.060

我从*The Pragmatic Programmer*那里得到的一个很好的建议是“你的程序应该能够在不使用异常的情况下执行其所有主要功能”。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-19T05:02:53.560

我有一套简单的规则：

1) 对您希望直接呼叫者做出反应的事情使用返回码。

2) 对范围更广的错误使用异常，并且可以合理地期望由调用者之上的许多级别来处理，这样错误的意识就不必渗透到许多层，从而使代码更加复杂。

在 Java 中，我只使用过未经检查的异常，检查过的异常最终只是另一种形式的返回代码，根据我的经验，方法调用可能“返回”的二元性通常更多的是阻碍而不是帮助。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-19T04:47:07.637

对于任何体面的编译器或运行时环境，异常不会招致重大损失。它或多或少有点像跳转到异常处理程序的 GOTO 语句。此外，让运行时环境（如 JVM）捕获异常有助于更轻松地隔离和修复错误。任何一天，我都会在 Java 中使用 NullPointerException 来处理 C 中的段错误。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-19T05:12:00.107

我在异常和非异常情况下都在 python 中使用异常。

能够使用异常来指示“无法执行请求”通常很好，而不是返回错误值。这意味着您/总是/知道返回值是正确的类型，而不是任意的 None 或 NotFoundSingleton 什么的。这是一个很好的例子，说明我更喜欢使用异常处理程序而不是返回值的条件。

```
try:
    dataobj = datastore.fetch(obj_id)
except LookupError:
    # could not find object, create it.
    dataobj = datastore.create(....) 
```

副作用是，当运行 datastore.fetch(obj_id) 时，您无需检查其返回值是否为 None，您会立即免费获得该错误。这与“你的程序应该能够在不使用异常的情况下执行其所有主要功能”的论点背道而驰。

这是另一个“异常”有用的异常示例，以便编写代码来处理不受竞争条件影响的文件系统。

```
# wrong way:
if os.path.exists(directory_to_remove):
    # race condition is here.
    os.path.rmdir(directory_to_remove)

# right way:
try: 
    os.path.rmdir(directory_to_remove)
except OSError:
    # directory didn't exist, good.
    pass 
```

一个系统调用而不是两个，没有竞争条件。这是一个糟糕的例子，因为很明显，在比目录不存在更多的情况下，这将失败并出现 OSError，但对于许多严格控制的情况来说，它是一个“足够好”的解决方案。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-19T05:29:31.937

我相信返回码会增加代码噪音。例如，由于返回码，我一直讨厌 COM/ATL 代码的外观。必须对每一行代码进行 HRESULT 检查。我认为错误返回代码是 COM 架构师做出的错误决定之一。这使得对代码进行逻辑分组变得困难，因此代码审查变得困难。

当每行都明确检查返回码时，我不确定性能比较。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-19T07:41:22.337

异常不适用于错误处理，IMO。例外就是这样；您没有预料到的异常事件。我说谨慎使用。

错误代码可以，但从方法返回 404 或 200 是不好的，IMO。改用枚举（.Net），这使得代码更易读，更容易被其他开发人员使用。此外，您不必维护一个包含数字和描述的表格。

还; try-catch-finally 模式在我的书中是一个反模式。try-finally 可以很好，try-catch 也可以很好，但是 try-catch-finally 永远不会很好。try-finally 通常可以用“使用”语句（IDispose 模式）代替，这是更好的 IMO。并且 Try-catch 在您实际捕获您能够处理的异常的地方是好的，或者如果您这样做：

```
try{
    db.UpdateAll(somevalue);
}
catch (Exception ex) {
    logger.Exception(ex, "UpdateAll method failed");
    throw;
} 
```

因此，只要您让异常继续冒泡就可以了。另一个例子是这样的：

```
try{
    dbHasBeenUpdated = db.UpdateAll(somevalue); // true/false
}
catch (ConnectionException ex) {
    logger.Exception(ex, "Connection failed");
    dbHasBeenUpdated = false;
} 
```

在这里，我实际上处理了异常；当更新方法失败时，我在 try-catch 之外所做的是另一回事，但我认为我的观点已经提出。:)

那么为什么 try-catch-finally 是一种反模式呢？原因如下：

```
try{
    db.UpdateAll(somevalue);
}
catch (Exception ex) {
    logger.Exception(ex, "UpdateAll method failed");
    throw;
}
finally {
    db.Close();
} 
```

如果 db 对象已经关闭，会发生什么？一个新的异常被抛出，它必须被处理！这个更好：

```
try{
    using(IDatabase db = DatabaseFactory.CreateDatabase()) {
        db.UpdateAll(somevalue);
    }
}
catch (Exception ex) {
    logger.Exception(ex, "UpdateAll method failed");
    throw;
} 
```

或者，如果 db 对象没有实现 IDisposable，请执行以下操作：

```
try{
    try {
        IDatabase db = DatabaseFactory.CreateDatabase();
        db.UpdateAll(somevalue);
    }
    finally{
        db.Close();
    }
}
catch (DatabaseAlreadyClosedException dbClosedEx) {
    logger.Exception(dbClosedEx, "Database connection was closed already.");
}
catch (Exception ex) {
    logger.Exception(ex, "UpdateAll method failed");
    throw;
} 
```

无论如何，那是我的 2 美分！:)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-19T04:55:30.770

我更喜欢将异常用于错误处理并将返回值（或参数）作为函数的正常结果。这提供了一个简单且一致的错误处理方案，如果正确完成，它会使代码看起来更清晰。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-19T04:56:54.260

最大的区别之一是异常迫使​​您处理错误，而错误返回代码可以不检查。

如果大量使用错误返回代码，也会导致非常丑陋的代码，其中包含大量类似于此形式的 if 测试：

```
if(function(call) != ERROR_CODE) {
    do_right_thing();
}
else {
    handle_error();
} 
```

就我个人而言，我更喜欢对调用代码应该或必须处理的错误使用异常，并且只将错误代码用于“预期的失败”，其中返回的东西实际上是有效且可能的。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-19T05:01:50.490

有很多理由更喜欢异常而不是返回码：

*   通常，为了便于阅读，人们会尽量减少方法中返回语句的数量。这样做，异常可以防止在不正确状态下做一些额外的工作，从而防止潜在地损坏更多数据。
*   异常通常比返回值更详细，更易于扩展。假设一个方法返回自然数并且当错误发生时你使用负数作为返回码，如果你的方法的范围改变并且现在返回整数，你将不得不修改所有的方法调用而不是仅仅调整一点点例外。
*   异常允许更容易地分离正常行为的错误处理。它们允许确保某些操作以某种方式作为原子操作执行。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-08-13T14:33:41.943

我通常更喜欢返回码，因为**它们让调用者决定失败是否异常**。

这种方法在 Elixir 语言中很典型。

```
# I care whether this succeeds. If it doesn't return :ok, raise an exception.
:ok = File.write(path, content)

# I don't care whether this succeeds. Don't check the return value.
File.write(path, content)

# This had better not succeed - the path should be read-only to me.
# If I get anything other than this error, raise an exception.
{:error, :erofs} = File.write(path, content)

# I want this to succeed but I can handle its failure
case File.write(path, content) do
  :ok => handle_success()
  error => handle_error(error)
end 
```

人们提到返回码会导致你有很多嵌套的`if`语句，但这可以用更好的语法来处理。在 Elixir 中，该`with`语句让我们可以轻松地将一系列快乐路径返回值与任何失败区分开来。

```
with {:ok, content} <- get_content(),
  :ok <- File.write(path, content) do
    IO.puts "everything worked, happy path code goes here"
else
  # Here we can use a single catch-all failure clause
  # or match every kind of failure individually
  # or match subsets of them however we like
  _some_error => IO.puts "one of those steps failed"
  _other_error => IO.puts "one of those steps failed"
end 
```

Elixir 仍然具有引发异常的函数。回到我的第一个示例，如果无法写入文件，我可以执行其中任何一项来引发异常。

```
# Raises a generic MatchError because the return value isn't :ok
:ok = File.write(path, content)

# Raises a File.Error with a descriptive error message - eg, saying
# that the file is read-only
File.write!(path, content) 
```

如果我作为调用者知道我想在写入失败时引发错误，我可以选择调用`File.write!`而不是`File.write`. 或者我可以选择以`File.write`不同的方式调用和处理每个可能的失败原因。

当然，`rescue`如果我们愿意，总是有可能出现异常。但与处理信息丰富的返回值相比，这对我来说似乎很尴尬。如果我知道函数调用可能会失败甚至应该失败，那么它的失败并不是例外情况。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-19T04:52:09.670

我只使用异常，没有返回码。我在这里谈论Java。

我遵循的一般规则是，如果我调用了一个方法`doFoo()`，那么如果它没有“做 foo”，那么就发生了一些异常情况，应该抛出一个异常。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-19T04:55:19.740

我担心异常的一件事是抛出异常会破坏代码流。例如，如果你这样做

```
void foo()
{
  MyPointer* p = NULL;
  try{
    p = new PointedStuff();
    //I'm a module user and  I'm doing stuff that might throw or not

  }
  catch(...)
  {
    //should I delete the pointer?
  }
} 
```

或者更糟糕的是，如果我删除了一些我不应该删除的东西，但在我完成其余的清理工作之前就被扔掉了。投掷给可怜的用户恕我直言。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-19T04:58:25.817

我在异常与返回代码参数中的一般规则：

*   当您需要本地化/国际化时使用错误代码——在 .NET 中，您可以使用这些错误代码来引用资源文件，然后该文件将以适当的语言显示错误。否则，使用异常
*   仅对*真正*异常的错误使用异常。如果这是经常发生的事情，请使用布尔值或枚举错误代码。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-09-19T05:09:09.097

我没有发现返回码比异常更难看。除了例外，你有`try{} catch() {} finally {}`where 和你有的返回码`if(){}`。由于帖子中给出的原因，我曾经担心例外；你不知道指针是否需要清除，你有什么。但我认为在返回码方面你也有同样的问题。除非您知道有关函数/方法的一些详细信息，否则您不知道参数的状态。

无论如何，如果可能，您必须处理错误。您可以很容易地让异常传播到顶层，就像忽略返回码并让程序出现段错误一样。

我确实喜欢为结果返回一个值（枚举？）并为异常情况返回一个异常的想法。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-02-20T22:33:02.540

对于像 Java 这样的语言，我会选择 Exception，因为如果不处理异常，编译器会给出编译时错误。这会强制调用函数处理/抛出异常。

对于Python，我比较矛盾。没有编译器，因此调用者可能没有处理导致运行时异常的函数抛出的异常。如果您使用返回码，如果处理不当，您可能会出现意外行为，如果您使用异常，您可能会遇到运行时异常。

# oop - 对象之间的消息传递 - 如何引用目标对象？

> ID：99684
> 
> 赞同：2
> 
> 时间：2008-09-19T04:43:25.743
> 
> 标签：oop, message-passing

面向对象环境中最基本的任务是在对象上执行方法。为此，您必须拥有对正在调用该方法的对象的引用。建立此引用以将对象作为参数传递给调用对象的构造函数（或初始化方法）的正确方法是什么？

如果 object `foo` 调用 object `bar`，是否正确地说（在伪代码中）：

```
bar = new barClass()
foo = new fooClass(bar) 
```

如果您需要来回传递消息会发生什么？您需要注册目标对象的方法吗？

```
foo = new fooClass()
bar = new barClass()

foo.register(bar)
bar.register(foo) 
```

有没有解决这个问题的模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T05:06:21.303

[像Spring](http://www.springframework.org/documentation)和[Guice](http://code.google.com/p/google-guice/)这样的依赖注入框架通过使用代理来解决 Java 中的循环依赖，该代理可以在第一次需要消息时解析消息的接收者。然而，这不是一个普遍适用的 OO 模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T05:11:55.783

通常依赖注入是要走的路。如果您只是在谈论两个对象进行通信，那么将其中一个的实例作为参数传递给另一个，就像在您的第一个示例中一样。传入构造函数确保引用始终有效。否则，您必须进行测试以确保已调用 register 。此外，您需要确保多次调用 register 不会产生不利影响。

如果你想要一个控制对象，其他对象注册事件怎么办。然后适合使用 Register 方法（可以添加到委托）。

参见[观察者模式](http://www.dofactory.com/Patterns/PatternObserver.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T04:47:13.207

好吧，根据消息传递的级别，您可以实现消息传递服务。对象侦听消息，或在某个 MessageProvider 上注册为 MessageListener。

如果两个对象相互引用，你最终会得到循环依赖，在大多数情况下我会认为这是不好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T05:38:45.347

您的一种对象类型可能是另一种的工厂。当 Foo 弹出一个新 Bar 时，连接已经建立：

```
foo = new Foo();
bar = Foo.Poop();

function Foo::Poop()
{
    bar = new Bar(this);
    myChildren.Add(bar);
    return bar;
}

bar.SayHiToParent();
foo.SayHiToChildren(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T08:03:40.770

我认为这在很大程度上取决于两个对象之间的确切关系。

# c# - 为什么 C# 和 VB 都有泛型？他们提供什么好处？泛型，FTW

> ID：99686
> 
> 赞同：6
> 
> 时间：2008-09-19T04:43:43.683
> 
> 标签：c#, .net, vb.net, generics

来自[维基百科](http://en.wikipedia.org/wiki/Generic_programming)：

> 泛型编程是一种计算机编程风格，其中算法根据待指定的类型编写，然后在需要时为作为参数提供的特定类型实例化，由 1983 年出现的 Ada 首创。这种方法允许编写常见的函数或类型仅在使用时它们所操作的类型集不同，从而减少了重复。

泛型提供了定义稍后指定的类型的能力。您不必将项目转换为类型来使用它们，因为它们已经被键入。

为什么 C# 和 VB 都有泛型？他们提供什么好处？您发现使用它们有什么好处？

还有哪些其他语言也有泛型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T04:47:55.623

C# 和 VB 有泛型来利用底层 CLR 中的泛型支持（或者相反？）。它们允许您以静态类型语言编写代码，该语言可以应用于多种类型，而无需为您使用它们的每种类型重写代码（运行时将为您执行此操作）或以其他方式使用**System.Object**并在任何地方进行强制转换（就像我们必须使用 ArrayList 一样）。

你读过[这篇文章](http://en.wikipedia.org/wiki/Generic_programming)吗？

这些语言也有泛型：

*   C++（通过*模板*）
*   艾达（通过*模板*）
*   埃菲尔
*   D（通过*模板*）
*   哈斯克尔
*   爪哇

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T04:49:04.480

就个人而言，我认为他们可以节省很多时间。我仍在使用 .NET Framework 1.1，每次需要特定集合时，都需要通过实现 CollectionBase 创建强类型集合。使用泛型，您只需要像这样声明您的集合即可`List<MyObject>`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T09:52:55.137

考虑这些方法签名：

```
//Old and busted
public abstract class Enum
{
  public static object Parse(Type enumType, string value);
}
//To call it:
MyEnum x = (MyEnum) Enum.Parse(typeof(MyEnum), someString); 
```

* * *

```
//New and groovy
public abstract class Enum
{
  public static T Parse<T>(string value);
}

//To call it:
MyEnum x = Enum.Parse<MyEnum>(someString); 
```

看 ma：没有运行时类型操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T04:48:35.450

来自[MSDN](http://msdn.microsoft.com/en-us/library/b5bx6xee(VS.80).aspx)：

> 泛型为早期版本的公共语言运行时和 C# 语言中的限制提供了解决方案，在这些语言中，泛化是通过将类型转换为通用基类型 Object 来完成的。通过创建泛型类，您可以创建在编译时类型安全的集合。

阅读该文章的其余部分，了解泛型如何提高代码的可读性和性能的一些示例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T04:49:14.573

它们最常见的用途可能是具有强类型的 ArrayList。在 .NET 1.1 中，您要么必须将所有对象从对象转换为所需的类型，要么使用 CodeSmith 之类的东西来生成强类型的 ArrayList。

此外，它们有助于减少[拳击](http://en.wikipedia.org/wiki/Boxing_(Computer_science)#Boxing)。同样，在 .NET 1.x 中，如果您尝试使用具有值类型的 ArrayList，您最终会在各处装箱和拆箱对象。泛型通过让您定义类型（无论是引用还是值）来避免这种情况。

它们还有其他方便的用途，事件处理程序、LINQ 查询等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T04:50:04.760

.NET 中的泛型非常适合对象集合。您可以根据需要定义对象类型，并且能够拥有例如 List 而无需为此编写任何代码，并且可以访问 .NET List 泛型集合的所有高效功能，同时对 T 是类型安全的。好东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T05:31:53.910

如果您熟悉泛型，则它们是基于 C++ 中的模板概念构建的。

它是一种实现算法或数据结构的方法，但会延迟使用它的实际类型。

然后可以为列表分配您选择的任何类型 int、string 甚至自定义类型，该类型是在构建列表时分配的。但是您将能够使用列表操作添加删除等。

通过习惯泛型，您可以真正节省大量的编码工作。而且您不必在类型之间进行装箱和拆箱。

Java 也有泛型。它们被称为通配符。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T20:27:12.423

.net 中的泛型，如继承和扩展方法，可以减少代码重复。让我通过重构来解释。

如果所有具有共同祖先的类都有共同的方法，则将共同方法放在类的共同祖先（继承）中。

如果某些类有一个使用公共契约来实现某些结果的公共方法，则将公共方法变成该公共契约的扩展方法。

如果一些方法或类具有相同的代码，只是所作用的类型不同（尤其是在类型的细节与方法的操作无关的情况下），请将这些方法或类收集到泛型中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T20:35:05.337

它们提高了使用值类型的集合的性能，因为不需要装箱/拆箱。它们使用起来更简洁，因为您不必将对象（例如使用 ArrayList）强制转换为所需的类型 - 同样它们有助于强制执行类型安全。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-24T09:56:02.897

在 C#（不是 Java，Java 是另一回事）中，泛型相对于非泛型类型的最大优势在于它们的速度要快得多。JIT 生成它可以为给定类型提供的最佳机器代码。 `List<int>`实际上是一个整数列表，而不是包装一个整数的整数对象。这使得泛型类型非常快并且类型安全，可以帮助您在编译时检测到大量错误:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T04:45:34.240

常见的例子是集合。例如，一组类型 T，作为 Add(T) 方法和 T get() 方法。相同的代码，不同类型的安全集合。

C++、D、Ada 和其他人都有模板，这是泛型的超集，它们有一点不同的错误得到相同的最终结果（然后是一些）。

IIRC Java 有泛型，但我不做 Java。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T04:47:50.583

解释它的最简单方法是举一个例子。假设您需要两个哈希表，一个将字符串类型的对象映射到 int 类型，另一个将字符串类型的对象映射到 double 类型。您可以定义 Hashtable，然后使用 K 和 V 类型。如果没有泛型，您将不得不使用“对象”类型，除了必须强制转换为有意义之外，它还放弃了类型安全。只需实例化 Hashtable 和 Hashtable，您就可以得到带有适当类型检查的哈希表等等。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T04:47:57.807

Java 也有泛型。C++ 有模板。

Perl 和 Javascript 等动态语言没有相同的类型限制，因此它们可以通过更少的工作获得几乎相同的好处。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T05:12:41.633

在 Objective-C 中，您可以使用协议来实现泛型的目标。然而，由于该语言是弱类型的，因此通常不像您在与类型系统作斗争以对多种类型使用一个代码路径时那样担心。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T05:38:23.410

就我个人而言，我是泛型的忠实粉丝，因为我不必编写所有代码。

[什么是控制反转？](https://stackoverflow.com/questions/3058/what-is-inversion-of-control#99760)

# language-agnostic - 实践中的私人与公共成员（封装有多重要？）

> ID：99688
> 
> 赞同：22
> 
> 时间：2008-09-19T04:44:32.293
> 
> 标签：language-agnostic, encapsulation

面向对象编程的最大优势之一是封装，我们（或者至少我已经）被教导的“真理”之一是成员应该始终保持私有并通过访问器和修改器提供方法，从而确保验证和验证更改的能力。

不过，我很好奇，这在实践中到底有多重要。特别是，如果您有一个更复杂的成员（例如集合），将其公开而不是制作一堆方法来获取集合的键，从集合中添加/删除项目可能非常诱人，等等

你一般遵守规则吗？您的答案是否会根据它是为自己编写的代码还是供他人使用的代码而改变？我是否因为这种混淆而缺少更微妙的原因？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-19T04:49:57.367

作为一个必须维护许多人过去工作多年的代码的人，我很清楚，如果一个成员属性被公开，它最终会被滥用。我什至听到有人不同意访问器和修改器的想法，因为这仍然没有真正达到封装的目的，即“隐藏类的内部工作”。这显然是一个有争议的话题，但我的意见是“将每个成员变量设为私有，主要考虑类必须*做什么*（方法），而不是*如何*让人们更改内部变量”。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-19T04:52:13.147

这取决于。这是必须务实决定的问题之一。

假设我有一个代表一个点的类。我可以为 X 和 Y 坐标设置 getter 和 setter，或者我可以将它们都公开并允许对数据进行自由读/写访问。在我看来，这没关系，因为该类就像一个美化的结构 - 一个可能附加了一些有用功能的数据集合。

但是，在很多情况下，您不想提供对内部数据的完全访问权限，而是依赖类提供的方法与对象进行交互。一个例子是 HTTP 请求和响应。在这种情况下，允许任何人通过网络发送任何东西是个坏主意——它必须由类方法处理和格式化。在这种情况下，类被设想为一个实际的对象，而不是一个简单的数据存储。

这实际上归结为动词（方法）是否驱动结构或数据是否驱动。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-19T05:10:33.493

是的，封装很重要。暴露底层实现（至少）有两件事是错误的：

1.  混淆了责任。调用者不需要或不想了解底层实现。他们应该只希望班级做好自己的工作。通过暴露底层实现，你的类没有做它的工作。相反，它只是将责任推给调用者。
2.  将您与底层实现联系起来。一旦你暴露了底层实现，你就会被它束缚住。如果你告诉调用者，例如，下面有一个集合，你不能轻易地将集合交换为一个新的实现。

无论您是直接访问底层实现还是只是复制所有底层方法，这些（和其他）问题都适用。您应该公开必要的实现，仅此而已。保持实现私有化使整个系统更易于维护。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T04:55:40.427

我更喜欢尽可能长时间地保持成员的私密性，并且只能通过 getter 访问 em，即使在同一个类中也是如此。我也尽量避免将 setter 作为初稿来推广价值风格的对象，只要有可能。经常使用依赖注入，您通常有 setter 但没有 getter，因为客户端应该能够配置对象但（其他）不知道实际配置了什么，因为这是一个实现细节。

问候，奥利

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T04:51:26.410

我倾向于非常严格地遵守规则，即使它只是我自己的代码。出于这个原因，我真的很喜欢 C# 中的属性。它使控制给定的值变得非常容易，但您仍然可以将它们用作变量。或者将集合设为私有并公开，等等。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T07:46:07.927

基本上，信息隐藏是关于代码清晰度的。它旨在让其他人更容易扩展您的代码，并防止他们在使用您的类的内部数据时意外创建错误。它基于**没有人阅读评论**的原则，尤其是那些带有说明的评论。

**示例：**我正在编写更新变量的代码，并且我需要绝对确保 Gui 更改以反映更改，最简单的方法是添加一个访问器方法（也称为“Setter”），它被调用而不是更新数据被更新。

如果我公开了该数据，并且在不通过 Setter 方法的情况下更改了变量（并且这种情况在每个脏话时间都会发生），那么有人将需要花一个小时调试来找出为什么不显示更新。在较小程度上，这同样适用于“获取”数据。我可以在头文件中添加注释，但很可能没有人会阅读它，直到出现非常非常错误的情况。使用 private 强制执行意味着*不能*犯错误，因为它会显示为易于定位的编译时错误，而不是运行时错误。

根据经验，您唯一希望公开成员变量并省略 Getter 和 Setter 方法的情况是，如果您想明确表示更改它不会产生副作用；特别是如果数据结构很简单，比如一个简单地将两个变量作为对保存的类。

这应该是一种相当罕见的情况，因为通常您会*想要*副作用，并且如果您创建的数据结构非常简单以至于您不需要（例如配对），那么已经有一个更有效的编写可用在标准库中。

话虽如此，对于大多数一次性无扩展的小程序，比如你在大学里得到的那些，它比任何东西都更“好实践”，因为你会在编写它们的过程中记住它们，然后你我会把它们交出来，再也不要碰代码。此外，如果您编写数据结构是为了了解它们如何存储数据而不是作为发布代码，那么有一个很好的论点是 Getters 和 Setters 无济于事，并且会妨碍学习体验.

只有当您到达工作场所或大型项目时，您的代码很可能会被不同人编写的对象和结构调用，使这些“提醒”变得强大变得至关重要。这是否是一个人的项目令人惊讶地无关紧要，原因很简单，“六周后的你”与同事一样不同。而“六周前的我”往往被证明是懒惰的。

最后一点是，有些人非常热衷于信息隐藏，如果您的数据不必要地公开，他们会感到恼火。最好取笑他们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T04:55:43.263

C# 属性“模拟”公共字段。看起来很酷，语法确实加快了创建这些 get/set 方法的速度

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T18:38:43.567

请记住在对象上调用方法的语义。方法调用是一种非常高级的抽象，可以在编译器或运行时系统中以各种不同的方式实现。

如果您正在调用的方法的对象存在于同一进程/内存映射中，则编译器或 VM 可以优化方法以直接访问数据成员。另一方面，如果对象位于分布式系统中的另一个节点上，那么您无法直接访问它的内部数据成员，但您仍然可以调用它的方法，向它发送消息。

通过对接口进行编码，您可以编写不关心目标对象存在于何处、如何调用它的方法或者即使它是用相同语言编写的代码。

* * *

In your example of an object that implements all the methods of a collection, then surely that object actually *is* a collection. so maybe this would be a case where inheritance would be better than encapsulation.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T04:47:54.873

这一切都是为了控制人们可以用你给他们的东西做什么。你控制得越多，你能做出的假设就越多。

此外，从理论上讲，您可以更改底层实现或其他内容，但因为在大多数情况下它是：

```
private Foo foo;
public Foo getFoo() {}
public void setFoo(Foo foo) {} 
```

这有点难以证明。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T04:48:39.083

在实践中，我总是只遵循一条规则，即“不适合所有人”的规则。

封装及其重要性是您项目的产物。什么对象将访问您的界面，他们将如何使用它，如果他们对成员拥有不需要的访问权限，这是否重要？在进行每个项目实施时，您需要问自己这些问题以及类似的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T04:49:15.620

我的决定基于代码在模块中的深度。如果我正在编写模块内部的代码，并且不与外部世界交互，那么我不会用私有的东西封装东西，因为它会影响我的程序员性能（我可以多快地编写和重写我的代码）。

但是对于作为模块与用户代码接口的对象，我坚持严格的隐私模式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T04:53:44.500

当至少满足以下一项时，封装很重要：

1.  除了您之外的任何人都将使用您的课程（否则他们会破坏您的不变量，因为他们不阅读文档）。
2.  任何不阅读文档的人都会使用您的课程（否则他们会破坏您仔细记录的不变量）。请注意，此类别包括两年后的您。
3.  在未来的某个时候，有人将从你的类继承（因为当字段的值发生变化时可能需要采取额外的操作，所以必须有一个 setter）。

如果它只适合我，并且在少数地方使用，并且我不会继承它，并且更改字段不会使类假定的任何不变量无效，*那么*我只会偶尔公开一个字段。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T04:55:25.403

如果可能的话，我的倾向是尽量将所有内容保密。这使对象边界尽可能清晰地定义，并使对象尽可能地解耦。我喜欢这个，因为当我必须重写我第一次（第二次，第五次？）时搞砸的对象时，它会将损坏包含在较少数量的对象中。

如果您将对象耦合得足够紧密，那么将它们组合成一个对象可能会更直接。如果你足够放松耦合约束，你就会回到结构化编程。

如果您发现一堆对象只是访问器函数，您可能应该重新考虑您的对象划分。如果您没有对该数据执行任何操作，它可能属于另一个对象的一部分。

当然，如果您正在编写类似库之类的东西，您希望界面尽可能清晰锐利，以便其他人可以针对它进行编程。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T04:57:49.780

使工具适合工作......最近我在我当前的代码库中看到了一些这样的代码：

```
private static class SomeSmallDataStructure {
    public int someField;
    public String someOtherField;
} 
```

然后这个类在内部用于轻松传递多个数据值。这并不总是有意义的，但如果你只有 DATA，没有方法，并且你没有将它暴露给客户，我发现它是一个非常有用的模式。

我最近使用它是一个 JSP 页面，其中显示了一个数据表，在顶部以声明方式定义。所以，最初它是在多个数组中，每个数据字段一个数组......这最终导致代码很难通过定义中不相邻的字段将一起显示......所以我创建了一个简单的像上面这样的类，它将把它放在一起......结果是真正可读的代码，比以前更多。

道德...有时您应该考虑“接受的不良”替代方案，如果它们可以使代码更简单，更易于阅读，只要您仔细考虑并考虑后果...不要盲目地接受您听到的一切。

也就是说......公共获取器和设置器几乎等同于公共领域......至少在本质上（有一点灵活性，但它仍然是适用于您拥有的每个领域的糟糕模式）。

甚至 java 标准库也有一些[公共领域](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/GridBagConstraints.html)的案例。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T05:33:04.533

当我使对象变得有意义时，它们**更**易于**使用**和**维护**。

例如：Person.Hand.Grab(howquick, howmuch);

诀窍是不要将成员视为简单的值，而是将其视为对象。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-19T06:25:59.600

我认为这个问题确实将封装的概念与“信息隐藏”混淆了
（这不是批评，因为它似乎确实符合对“封装”概念的普遍解释）

但是对我来说，“封装”是：

*   将多个项目重新组合到一个容器中的过程
*   容器本身重新组合项目

假设您正在设计一个纳税人系统。对于每个纳税人，您可以将**孩子**的概念*封装*成

 ***   代表孩子的孩子名单
*   to 的地图考虑了来自不同父母的孩子
*   一个对象 Children (not Child)，它将提供所需的信息（例如孩子的总数）

这里有三种不同的封装，两种由低级容器（列表或地图）表示，一种由对象表示。

通过做出这些决定，您不会

*   使该封装公开或受保护或私有：仍然需要选择“信息隐藏”
*   做一个完整的抽象（你需要提炼对象Child的属性，你可能决定创建一个对象Child，它只保留从纳税人系统的角度来看的相关信息）
    抽象是选择哪些属性的过程的对象与您的系统相关，必须完全忽略。

所以我的观点是：
这个问题的标题可能是：实践中的私人与公共成员（*信息隐藏*
有多重要？）

 *不过，只是我的 2 美分。我完全尊重人们可以将封装视为一个包括“信息隐藏”决策的过程。

但是，我总是试图区分“抽象”-“封装”-“信息隐藏或可见性”。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-31T11:05:54.613

@VonC

您可能会发现国际标准化组织的“开放分布式处理的参考模型”是一本有趣的读物。它定义：“封装：对象中包含的信息只能通过对象支持的接口上的交互来访问的属性。”

我试图证明信息隐藏是这个定义的关键部分： [http ://www.edmundkirwan.com/encap/s2.html](http://www.edmundkirwan.com/encap/s2.html)

问候，

埃德。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-09T23:44:03.847

我发现很多 getter 和 setter 是一种[代码味道](http://en.wikipedia.org/wiki/Code_smell)，表明程序的结构设计得不好。您应该查看使用这些 getter 和 setter 的代码，并寻找真正应该成为该类一部分的功能。在大多数情况下，类的字段应该是私有的实现细节，并且只有该类的方法可以操作它们。

同时拥有 getter 和 setter 等于公开的字段（当 getter 和 setter 很简单/自动生成时）。有时将字段声明为 public 可能会更好，这样代码会更简单，除非您需要多态性或框架需要 get/set 方法（并且您不能更改框架）。

但在某些情况下，拥有 getter 和 setter 是一种很好的模式。一个例子：

当我创建应用程序的 GUI 时，我尝试将 GUI 的行为保留在一个类 (FooModel) 中，以便可以轻松地对其进行单元测试，并在另一个可以测试的类 (FooView) 中显示 GUI只能手动。视图和模型通过简单的胶水代码连接起来；当用户更改 field 的值时`x`，视图会调用`setX(String)`模型，这反过来可能会引发模型的其他部分已更改的事件，并且视图将使用 getter 从模型中获取更新的值。

在一个项目中，有一个具有 15 个 getter 和 setter 的 GUI 模型，其中只有 3 个 get 方法是微不足道的（这样 IDE 可以生成它们）。所有其他都包含一些功能或非平凡的表达式，例如：

```
public boolean isEmployeeStatusEnabled() {
    return pinCodeValidation.equals(PinCodeValidation.VALID);
}

public EmployeeStatus getEmployeeStatus() {
    Employee employee;
    if (isEmployeeStatusEnabled()
            && (employee = getSelectedEmployee()) != null) {
        return employee.getStatus();
    }
    return null;
}

public void setEmployeeStatus(EmployeeStatus status) {
    getSelectedEmployee().changeStatusTo(status, getPinCode());
    fireComponentStateChanged();
} 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2008-09-19T04:50:40.327

当然，无论您编写内部代码还是供其他人（甚至您自己，但作为一个包含单元）使用的代码都会有所不同。任何要在外部使用的代码都应该有一个明确定义/记录在案的接口，您'会希望尽可能少地改变。

对于内部代码，根据难度，你可能会发现现在用简单的方法做事情的工作量更少，以后会付出一点点代价。当然，墨菲定律将确保短期收益将被多次抹去，因为您必须在以后需要更改您未能封装的类的内部结构时进行广泛的更改。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-09-19T04:56:38.753

特别是对于您使用将返回的集合的示例，这种集合的实现似乎可能会发生变化（与更简单的成员变量不同），从而使封装的效用更高。

话虽如此，我有点喜欢 Python 的处理方式。默认情况下，成员变量是公共的。如果您想隐藏它们或添加验证，则提供了一些技术，但这些被认为是特殊情况。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2008-09-19T05:06:50.040

我几乎一直都遵守这方面的规则。对我来说有四种情况 - 基本上，规则本身和几个例外（都受 Java 影响）：

1.  可由当前类之外的任何东西使用，通过 getter/setter 访问
2.  内部到类的用法通常以“this”开头，以明确它不是方法参数
3.  意味着要保持极小的东西，例如运输对象-基本上是属性的直接拍摄；所有公众
4.  需要是非私有的才能进行某种扩展

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2008-09-19T05:32:42.787

这里有一个实际问题，大多数现有答案都没有解决。封装和向外部代码公开干净、安全的接口总是很棒，但是当您编写的代码打算由空间和/或时间上很大的“用户”群使用时，它就更重要了。我的意思是，如果你计划让某人（甚至是你）在未来很好地维护代码，或者如果你正在编写一个模块来与来自多个其他开发人员的代码交互，那么你需要考虑更多比您编写一次性或完全由您编写的代码时要小心。

老实说，我知道这是多么糟糕的软件工程实践，但我通常会首先公开所有内容，这会使事情的记忆和输入速度稍微快一些，然后在有意义的时候添加封装。如今，大多数流行 IDE 中的重构工具使您使用的方法（添加封装与取消封装）的相关性大大降低。

# .net - 维护自动浏览器 UI 测试

> ID：99716
> 
> 赞同：2
> 
> 时间：2008-09-19T04:49:40.550
> 
> 标签：.net, performance, user-interface, browser

管理大量浏览器 UI 测试的最佳方法是什么？我正在寻找一种在过去处理大量自动化浏览器测试时可能对您有用的方法。诸如“它们应该被重构为较低级别的 UI 测试”之类的明显答案并不是我想要的。最终，这些测试的运行和维护都非常耗时。我正在寻找最小化这个问题的最佳方法。

我还必须提到，我仅限于特别关注 .NET 的自由软件（WatiN、CC.net、Fitnesse 等）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T05:09:36.587

在其他关于 Web UI 测试的主题中，[Selenium](http://selenium.openqa.org/)是一个受欢迎且强烈推荐的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T05:22:04.027

硒很好，但有点慢。由于单元测试应该很少（如果有的话）退出进程，它们应该比你的 selenium 测试快得多。

如果您确实将它用于自动化 UI 测试，我会将它们全部放在一个单独的构建中，该构建可以与您的单元测试并行运行。

我更喜欢将我的自动化 UI 测试视为回归测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T04:53:42.940

分解出常见的动作序列，然后将它们分别放在一个子测试中。仅运行任何给定功能所需的子测试。

# c# - IsAssignableFrom 和 GetInterface 有什么区别？

> ID：99732
> 
> 赞同：18
> 
> 时间：2008-09-19T04:53:39.323
> 
> 标签：c#, .net, reflection

在.Net中使用反射，有什么区别：

```
 if (foo.IsAssignableFrom(typeof(IBar))) 
```

和

```
 if (foo.GetInterface(typeof(IBar).FullName) != null) 
```

哪个更合适，为什么？

一个或另一个什么时候会失败？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-19T04:55:40.223

如果您只是想查看一个类型是否实现了给定的接口，那么两者都可以，尽管 GetInterface() 可能更快，因为 IsAssignableFrom() 比 GetInterface() 执行更多的内部检查。检查 Type.GetInterfaces() 的结果可能会更快，它返回与其他两种方法都使用的相同内部列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-23T11:09:46.193

**编辑：这个答案是错误的！请看评论。**

内部类的处理方式有所不同。参加以下课程：

```
public interface IFoo
{
}    

internal class Foo: IFoo
{
} 
```

这将为您提供一个项目的列表：

```
var types = typeof(IFoo).Assembly.GetTypes()
            .Where(x => x.GetInterface(typeof(IFoo).FullName) != null)
            .ToList(); 
```

而这会给你一个空列表：

```
var types = typeof(IFoo).Assembly.GetTypes()
            .Where(x => x.IsAssignableFrom(typeof(IFoo))
            .ToList(); 
```

# svn - 什么是一些体面的 ISP 托管 Subversion

> ID：99743
> 
> 赞同：7
> 
> 时间：2008-09-19T04:55:37.477
> 
> 标签：svn

我想推荐一个安装了 Subversion 的 ISP，这样我就可以启动一个存储库。到目前为止，我发现 discount.asp 在他们的服务器上没有它并且不会支持它。所以我正在寻找推荐

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T05:04:09.483

你的价格范围是多少？您想要一个直接的 SVN 提供商还是您也想要托管一个网站？

对于直接 SVN 托管，请查看

[http://cvsdude.com/](http://cvsdude.com/)

[http://www.assembla.com/](http://www.assembla.com/)

只有我能想到的支持 SVN 的托管服务提供商（在 VPS 提供商之外）是

[http://www.dreamhost.com](http://www.dreamhost.com)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-18T11:26:26.447

我想将[www.dreamhost.com](http://www.dreamhost.com)作为一个极好的解决方案/物有所值。我已经和他们在一起大约 2 年了，大小/带宽有限制，但它们太高了，你基本上可以认为它对于任何合理的项目都是无限的。

我从来没有遇到过服务器问题或任何停机时间（尽管我听说其他人有过）。他们看起来很开放和值得信赖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-06T01:40:37.303

我还没有使用它们，但是在阅读了他们的产品之后，我正在认真考虑在我的下一个基于 subversion 的项目中使用[http://projectlocker.com/](http://projectlocker.com/)。他们的价格相当便宜（每月最多免费 30 美元），他们最近从[Scott Mitchell](http://scottonwriting.net/sowblog/posts/13849.aspx)那里得到了一个插头。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T05:52:36.340

这些网站是否足够值得信赖？毕竟他们有**你的**知识产权存档。您不希望他们自己使用它或将其提供给您的竞争对手。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-06T01:53:38.293

我推荐[http://beanstalkapp.com/](http://beanstalkapp.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T05:02:18.117

免费帐户有一些限制（即 200MB），但我们最近在[Assembla](http://www.assembla.com)为一个小项目设置了一个帐户。它提供 SVN（可选外部托管）、Trac、wiki 和其他几个内置工具，类似于 SourceForge。您的项目不需要是开源的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T05:36:42.370

我已经使用[wush.net](http://wush.net)大约 9 个月了，非常兴奋。特别是考虑到当您升级到 pro 时您会获得集成的 Trac（如果您有一些 repo，这会为自己买单，因为您可以获得额外的折扣）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-06T01:54:23.940

**[Site5](http://site5.com)**提供 ssh 访问，这意味着您可以将 svn+ssh 用于具有几乎无限大小/带宽的非常便宜的存储库。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-04T22:09:36.147

我已经使用 csoft.net 6 年了。它们可靠且便宜。他们的文档很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T05:28:48.693

[csoft.net](http://csoft.net)很不错。它们已经存在了很长时间，它们价格便宜、质量好、对开源友好、对极客友好，并且帐户带有 SVN（以及更昂贵的计划，还有大量其他功能）。此外，您是否曾尝试在大型主机（如 ick、1&1）处处理一线技术支持，但您会偷偷怀疑您实际上是在与编程非常糟糕的 Eliza 机器人而不是人类打交道？是的，好吧，csoft不是那样的。:-)

如果您正在寻找对用户更友好的东西，您可以查看[Unfuddle](http://unfuddle.com/)。我没有亲自使用过它们，但它们在 SO 上得到了很多好评，而且它们有很好的功能集。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-11-18T22:21:40.157

我会投票给[Assembla](http://www.assembla.com/features)，它的强大功能集无法与 unfuddle、beantalkapp 或任何其他仅 svn 的托管服务提供商相提并论。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T06:12:48.663

我使用[http://devguard.com/](http://devguard.com/)。非常便宜，但也非常可靠。集成 Trac、SSL、基于 Web 的 ACL 和用户管理。SVN 脚本，例如。提交钩子。我之前尝试过 CVSDude，但没有成功。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T06:24:40.867

我有一个 www.codespaces.com 的帐户 他们内置了 svn 托管、wiki、论坛、项目管理、问题跟踪和管理。我已经使用该服务 6 个月了，我对他们提供的服务水平感到满意.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-02-17T00:00:38.007

我已经在几个项目中使用了[unfuddle](http://unfuddle.com/)，我对它们非常满意。他们的管理 UI 很棒，而且他们还有一些非常有用的项目管理工具。

如果您不需要太多，他们有一个不错的免费版本。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-02-17T00:02:45.133

我通过 Dreamhost 使用 SVN 已经有一段时间了，我发现它们非常好。因为我在澳大利亚，所以对我来说有点慢，但其他方面都很棒

# ajax - How important do you think Progressive Enhancement is?

> ID：99748
> 
> 赞同：4
> 
> 时间：2008-09-19T04:56:52.030
> 
> 标签：ajax, unobtrusive-javascript, graceful-degradation, progressive-enhancement

[Progressive Enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) is a web development methodology that not only allows greater portability and accessibility but in my opinion, makes the development process easier.

What I want is to know what the rest of the community think of this approach.

In particular: What do you believe is the minimum set of technologies that a web application should support?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T05:05:25.223

If it remains usable in a text-only browser (without CSS and Javascript, of course) and also in a screen-reader, you're on the right track. But these are about the highest standards that you'll find :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T05:01:31.143

I personally block referrers, cookies and JavaScript by default and re-enable them temporarily or permanently on a site-by-site basis.

I'll forgive a web site for not working without cookies for signed-in users, however I get quite upset when they won't work without JavaScript if it's being used for trivial purposes.

Minimum requirements: HTML with basic structural elements + links, HTML forms + maybe cookies for applications.

Site could be run in a vt100, a "normal" browser, a phone, a screen reader...

-z

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T05:52:36.437

I would feel comfortable targeting HTML4 and CSS2, with the basic content structured with screenreaders in mind as a baseline experience for most websites. The key is to keep in mind a layout that is functional for text-based browsers and screenreaders and use that as the basis for the enhanced page.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-26T09:59:32.403

> So "Progressive Enhancement" is just another term for "Graceful Degradation"? False. They are two different sides of the coin. It shows where your focus is.

Developing a site that is 100% useful without css, javascript, etc. and then adding all the pretty/fancy stuff for javascript users is an example of Progressive Enhancement.

However, when you code the site with fancy/pretty and then go back and turn off javascript and css to see how it looks, that is graceful degradation.

The group you focus on first really decides this. It is possible that you could arrive at the same conclusion but it is unlikely. Your focus determines the ending point really.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T05:53:04.920

So "Progressive Enhancement" is just another term for "Graceful Degradation"?

In which case, it's the way all websites *should* be done.

Web Apps should be built in HTML (4 or later), semantically and against the standards.

All CSS should be optional - content & forms should work without it, but look prettier with it.
All JavaScript should be optional - pages & forms should work without, but work easier with it.

All code should be written according to the standards & checked in each major rendering engine - but don't work around flaws in browsers unless absolutely necessary; it's up to the browsers to respect standards, not developers to grovel after bad rendering engines.

# solaris - 如何在 Solaris 10 中获取“命令缓冲区”？

> ID：99755
> 
> 赞同：2
> 
> 时间：2008-09-19T04:58:05.037
> 
> 标签：solaris

在使用 linx CShell 时，您可以选择按向上/向下箭头来选择最后输入的命令或命令缓冲区。这甚至适用于 Windows。

但是，在我最近切换到的 Solaris 上工作时，这不起作用。我猜shell也是一个CShell。

请告诉我在 Solaris 上具有此功能需要什么组合键？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T05:01:29.443

Solaris 中的默认 shell 具有命令历史记录，但您也可以使用 Bash 代替，它对用户更友好。只需在命令行输入“bash”（不带引号）。您还可以编辑 /etc/passwd 以使 bash 成为您的默认 shell。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T09:28:24.560

Solaris 的“官方”默认 shell 实际上`sh`是原始的 Bourne shell（有关详细信息，请参阅Solaris[高级用户指南的第 10 章](http://docsun.cites.uiuc.edu/sun_docs/C/solaris_9/SUNWabe/ADVOSUG/p34.html)）。如果您想将其更改为`csh`or `tcsh`——而你不是`root`（通常认为使用除默认值之外的任何内容都是不好的做法`sh`）`root`——只需发出`passwd -e /path/to/shell_of_your_choice <loginname>`. 我猜这可能看起来像`passwd -e /bin/csh <loginname>`，但您可能首先要确保它存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T05:00:58.523

可能是 Korn shell 在这种情况下尝试 <ESC>k。bash 至少允许您使用“set -o vi”或“set -o emacs”切换模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T05:03:10.190

也许你可以使用**!!** 命令，重复上一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T05:03:58.610

使用“echo $SHELL”查看您的登录 shell。如果是 ksh 或 bash，请尝试“set -o emacs”。如果可行，您将能够使用 ^P 返回命令。^R 让您搜索命令，^F 和 ^B 在命令内移动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-28T18:49:08.797

如果你不能改变你的默认 shell，或者你只是想尝试一个可行的，你可以从你的命令行启动任何其他 shell。我向您推荐 tcsh，它可以使用箭头键进行良好的命令行编辑和历史记录。在提示符下键入 /bin/tcsh 进行尝试。如果您喜欢 tcsh，可以使用较早的响应来更改您的默认 shell。确保您的 $HOME/.cshrc 文件中有以下内容：

set filec set history=1000 # 或其他一些较大的数字 set autologout=0 # 如果您是在您的帐户下远程登录。

我希望这有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-09T07:42:18.483

如果您通过键入使用 BASH，您会暂时启用历史记录

```
HISTSIZE=1000 
```

这将启用向上和向下键并存储 1000 个命令。终端断开后，所有历史都将消失。

这适用于 solaris 10。

对于永久解决方案，将这些行添加到 ~/.bashrc

```
HISTSIZE=1000
HISTFILESIZE=1000 
```

# svn - 如何创建颠覆存储库的目录列表

> ID：99781
> 
> 赞同：5
> 
> 时间：2008-09-19T05:04:28.610
> 
> 标签：svn

我有一个客户要求我向他们提供源代码中每个文件和文件夹的列表（然后简要说明源代码树）。有没有一种简单的方法可以从 subversion 存储库创建某种格式正确的列表？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T05:10:07.490

您将需要 list 命令。假设您使用的是命令行客户端

```
svn list -R http://example.com/path/to/repos 
```

这将为您提供存储库中所有内容的完整递归列表。将其重定向到文本文件

```
svn list -R http://example.com/path/to/repos > file.txt 
```

然后格式化为您的心脏内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T06:15:27.923

更一般地，您可以使用树实用程序（在 *Nix 系统中）为任何目录结构打印出这样的列表。它默认安装在许多发行版中。如果它不在你的，你可以检查它的标准存储库。例如，在 Ubuntu 中，使用默认存储库，“sudo apt-get install tr​​ee”应该可以解决问题。[或者，有一个使用 sed 的 shell 脚本在此处](http://www.centerkey.com/tree/ "树壳脚本")实现它。一旦你有了树，只需 cd 到你想要打印列表的目录并输入“树”（如果你愿意，可以将它重定向到一个文件）。

这确实需要您签出存储库，但在大多数情况下您可能已经拥有一个。请注意，这也将包括 .svn 目录，这有点麻烦，但您始终可以通过“grep -v .svn”管道输出，这将删除这些行，可能还有一些额外的魔法来取出任何东西“在”层次结构中这样一个包含 .svn 的行的“下方”（使用 sed 或程序 shell 脚本循环或类似的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T05:07:41.050

试试：svn list -R

与您要列出的分支的根目录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T05:08:34.200

进行结帐，然后进入命令提示符，`cd`进入正确的目录，然后键入类似

```
目录 /a:d /s /b > 清单.txt
```

（当然，假设您使用的是 Windows。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T05:08:50.330

svn list -R svn://svnlocation

这应该列出所有文件和文件夹，可以将其输出到文本文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T05:06:20.557

假设它可以通过 HTTP 访问 - 为什么不给他们一个只读登录名，然后将他们指向 Web 地址呢？

# javascript - 我应该使用什么 JavaScript 存储库？

> ID：99785
> 
> 赞同：7
> 
> 时间：2008-09-19T05:05:21.290
> 
> 标签：javascript, open-source

许多语言都有标准存储库，人们在其中捐赠他们希望其他人能够访问的有用库。例如 Perl 有 CPAN，PHP 有 PEAR，Ruby 有 RubyGems，等等。JavaScript 的最佳选择是什么？

我问是因为几个月前我将[Statistics::Distributions](http://search.cpan.org/~mikek/Statistics-Distributions-1.02/Distributions.pm)从 Perl 移植到 JavaScript。（当我说移植时，我的意思是“运行文本替换，手动修复了一些东西。”我没有*重写*它。）由于我在 Perl 中多次使用过这个模块，我认为[statistics-distributions.js](http://elem.com/~btilly/effective-ab-testing/statistics-distributions.js)可能对某人有用。所以我把它放在与原版相同的开源许可下（你选择 GPL 或艺术许可）。但我不知道把它放在哪里，以便可能想要它的人找到它。

它不适合任何类型的框架。它只是一个独立的库，让您能够以 5 位数的精度计算许多有用的统计分布。在 JavaScript 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T07:20:12.713

[JSAN（JavaScript 存档网络）](http://openjsan.org)听起来像是您正在寻找的那种东西，但除了 Test.Builder，我从未亲自使用过它的任何东西。

只要您的 JavaScript 可以放入人们的项目中而不会污染全局名称空间或做可能导致其他人代码损坏的事情（例如添加到 Object.prototype），我就会将它贴在 Google Code 之类的地方已经建议了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T05:10:07.410

JavaScript 没有集中的存储库。JS 库通常有自己的插件库，但是对于独立脚本，最好的推广方式是发送到著名的网站，例如[ajaxian](http://www.ajaxian.com)或[mashable](http://www.mashable.com)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T06:20:09.723

AFAIK，没有中央 JavaScript 存储库，但您可能在[Snipplr](http://snipplr.com/)上或作为[Google Code](http://code.google.com/)上的项目成功推广它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T05:09:44.260

您可以在 SourceForge 上启动一个项目，以包含类似这样的有用代码片段（或在 google 上查找片段）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T06:32:45.997

Perl、Ruby、PHP 等都在语言中内置了分发机制来使用这些库。

JS 中没有内置这样的东西。

那里有大量的脚本档案 - 但没有“中央”JS repo。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T07:30:45.670

考虑将其打包为主要 Javascript 库之一的插件，例如[jQuery](http://www.jquery.com) - 有关更多详细信息，请参阅[http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)。通过这种方式，它可以包含在他们的[插件页面](http://plugins.jquery.com/)中，这将得到很好的曝光，因为他们拥有庞大的开发人员基础，并且当需要此类功能时，它将成为他们的第一个呼叫端口。

[虽然 jQuery 是最流行的框架之一（如果不是最流行的），但如果您可以考虑使用其他库](http://javascriptlibraries.com/)来补充/代替它，还有一个主机。

# c# - 使用关键字 new 将委托添加到事件中是否安全？

> ID：99790
> 
> 赞同：6
> 
> 时间：2008-09-19T05:06:30.743
> 
> 标签：c#, .net, events, delegates

我关心的一件事是我发现了两种注册事件代表的方法。

1.  OnStuff += this.Handle;
2.  OnStuff += new StuffEventHandler(this.Handle);

第一个是干净的，执行“OnStuff -= this.Handle;”是有意义的 从事件中注销...但是对于后一种情况，我应该执行“OnStuff -= new StuffEventHandler(this.Handle);”吗？感觉就像我根本没有删除任何东西，因为我正在抛出另一个 StuffEventHandler 参考。事件是否通过引用比较委托？我担心我会在这里启动一个令人讨厌的内存池。找我？我没有对我之前注册的“新 StuffEventHandler”的引用。

做#1的缺点是什么？

做#2有什么好处？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-19T05:11:55.643

第一个只是简写，它将生成与第二个相同的 MSIL，在编译类型时它会查看 this.Handle 并推断要实例化的委托。但是你永远不应该使用 new 来取消订阅。

所以两者之间没有区别，只是一些语法糖让我们的代码更干净。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T09:26:25.877

您无需担心保留对最初注册的委托的引用，也不会启动“讨厌的内存池”。

当您调用“OnStuff -= new StuffEventHandler(this.Handle);”时 删除代码不会*比较*您通过引用删除的委托：它通过比较对委托将调用的目标方法的引用来检查是否相等，并从“OnStuff”中删除匹配的委托。

顺便说一句，“OnStuff”本身是一个委托对象（我假设您在声明中的 event 关键字只是限制了委托的可访问性）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T05:11:43.693

我的印象是 2 只是语法糖。它们应该是*完全相同*的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T05:13:39.103

如果我没记错的话，第一种选择只是第二种的语法糖。

# 64-bit - 您在 64 位环境中使用 VFP 应用程序时遇到什么问题？

> ID：99793
> 
> 赞同：2
> 
> 时间：2008-09-19T05:07:39.477
> 
> 标签：64-bit, foxpro, visual-foxpro

我知道 64 位机器上的 VFP OLEDB 提供程序存在问题。...但是在 64 位机器上实际运行 VFP 应用程序时，您会遇到什么问题？有没有人在这方面有任何经验？

我的第一个想法是它只作为 32 位应用程序运行，而不使用 64 位功能。但是，我在将 FoxPro 应用程序连接到 SQL Server 数据库时遇到了困难（也可能是 OLEDB 问题）。还有其他问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-21T00:54:31.680

这是一个特殊的场景，它可能与 64 位无关，但既然你问了......

我的组织最近在 Windows Server 2008 Enterprise 64 位服务器上托管了一个旧版 VFP 7 应用程序，用于通过终端服务进行访问。该应用程序运行良好，但 TS Easy Print 技术存在某种错误。当您通过 Easy Print 从应用程序打印到重定向的客户端打印机时，文档每页的顶部、左侧和底部都会被剪裁。我们使用的解决方法是让用户首先打印到服务器上的 pdfFactory，然后通过 Easy Print 从 pdfFactory 打印到重定向的客户端打印机。效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T19:21:26.060

这有点像在黑暗中刺伤......但我相信有一些带有 MDAC 的驱动程序在 x64 窗口中不可用。我认为您可能能够安装普通的 32 位 MDAC，但它会安装到 x86 文件夹中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-06T03:14:04.833

我们已经看到我们的 VFP9 应用程序在 64 位 XP、Server 2003、Vista 或 Server 2008 上出现零问题。

我们的打印引擎是一个 VB DLL，所以我们不会遇到任何 VFP 特定的打印问题。

# 3d - 何时使用二进制空间分区、四叉树、八叉树？

> ID：99796
> 
> 赞同：79
> 
> 时间：2008-09-19T05:08:25.170
> 
> 标签：3d, tree, quadtree, octree, space-partitioning

我最近了解了二进制空间分区树及其在 3d 图形和碰撞检测中的应用。我还简要阅读了有关四叉树和八叉树的材料。你什么时候会在 bsp 树上使用四叉树，反之亦然？它们可以互换吗？如果我有足够的信息来填写这样的表格，我会很满意：

```
 | BSP | Quadtree | Octree
------------+----------------+-------
Situation A |  X  |          |
Situation B |     |     X    |
Situation C |     |          |   X 
```

什么是 A、B 和 C？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-09-19T10:07:04.623

你的问题没有明确的答案。这完全取决于您的数据是如何组织的。

要记住的事情：

四叉树最适合主要是二维的数据，例如导航系统中的地图渲染。在这种情况下，它比八叉树更快，因为它更好地适应几何形状并保持节点结构较小。

如果数据是三维的，八叉树和 BVH（边界体积层次结构）会受益。如果您的几何实体聚集在 3D 空间中，它也能很好地工作。（参见[Octree vs BVH](https://web.archive.org/web/20180111010801/http://www.thomasdiewald.com/blog/?p=1488)）（存档自~~[原来的](http://thomasdiewald.com/blog/?p=1488)~~)

Oc- 和 Quadtrees 的好处是您可以随时停止生成树。如果您想使用图形加速器渲染图形，它只允许您在对象级别上生成树，并在单个绘制调用中将每个对象发送到图形 API。这比发送单个三角形**要**好得多（如果您完全使用 BSP-Trees，您必须这样做）。

BSP-Trees 确实是一个特例。它们在 2D 和 3D 中工作得非常好，但是生成好的 BSP-Trees 本身就是一种艺术形式。BSP 树的缺点是您可能必须将几何体分割成更小的部分。这可以增加数据集的整体多边形数。它们非常适合渲染，但它们更适合碰撞检测和光线追踪。

BSP 树的一个很好的特性是它们将多边形汤分解成一个结构，该结构可以从任何相机位置完美地从前到后渲染（反之亦然），而无需进行实际排序。每个视点的顺序是数据结构的一部分，并在 BSP-Tree 编译期间完成。

顺便说一句，这就是它们在 10 年前如此受欢迎的原因。Quake 使用它们是因为它允许图形引擎/软件光栅化器不使用昂贵的 z 缓冲区。

所有提到的树都只是树的家族。还有松散的八叉树、kd-trees 混合树以及许多其他相关结构。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-10-22T21:40:01.460

BSP-Trees 和其他类型的 3d-trees 之间最大的实际区别是 BSP-Trees 可以更优化，但只适用于*静态*几何。这是因为 BSP 树的构建通常非常缓慢，通常需要数小时或数天才能完成典型的静态城市游戏关卡。

BSP 树需要更长的时间来构建的两个主要原因是（a）它们使用非轴对齐的分割平面，这需要更长的时间才能找到最佳位置，以及（b）它们在轴边界上细分几何图形，确保没有对象跨越分割平面。

其他类型的 3d 树（Octrees、Quadtrees、kd-tree、Bounding-Volume-Hierarchy）使用轴对齐的包围体，并且体积（可选）允许重叠，因此不需要在体积上切割包含的对象边界。这些都使得树不如 BSP 树优化，但构建速度更快，并且更容易为动态对象更改。

将这些因素外推到情况...

户外区域通常使用基于高度场的地面表示，简单的高度图或更复杂的地理 MIP 映射技术（如 ROAM）。地面本身不参与 3d 空间划分，只有放置在地面上的物体。

具有许多简单和相似几何体（房屋、树木、小行星等）实例的世界通常会使用非 BSP 树（例如 BVH），因为将几何体放入 BSP 树中意味着复制和拆分每个实例的详细几何图形。

相反，没有实例化的大型自定义静态网格，例如城市场景或复杂的室内环境，通常会使用 BSP-Tree 来提高运行时性能。BSP-Tree 在节点边界上分割几何体这一事实有助于渲染性能，因为 BSP 节点可以用作预先组织的三角形渲染批次。BSP-Tree 也可以针对遮挡进行优化，避免需要绘制已知位于其他几何图形后面的 BSP-Tree 部分。

另请参阅：[Octree vs BVH](https://web.archive.org/web/20180111010801/http://www.thomasdiewald.com/blog/?p=1488)（存档自~~[原来的](http://thomasdiewald.com/blog/?p=1488)~~)、[包围体层次教程](http://www.3dmuve.com/3dmuve.html?file=blog/blog_post_3.html)、[BSP 教程](http://www.cs.utah.edu/~jsnider/SeniorProj/BSP/default.htm)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-19T09:31:41.353

BSP 最适合城市环境。

当您使用地形等高度图时，四叉树最适合。

八叉树最适合在 3d 空间中有几何图形块时使用，例如太阳系。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T09:49:44.320

BSP 是加速碰撞检测的好选择，具体取决于您使用的风格。它们在点、线或射线测试中速度特别快，但在体积测试中速度稍慢且复杂一些。

至于它们在图形中的使用，BSP 几乎已经过时了。八叉树适用于诸如总能见度剔除之类的事情，AABB 树也是如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T05:11:28.063

我对 BSP 没有太多经验，但我可以说当你渲染的场景很高时，你应该使用八叉树而不是四叉树。也就是说，高度超过宽度和深度的一半——经验法则很少。一般来说，八叉树不会比四叉树带来巨大的成本，而且它们有可能加快速度。YMMV。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-16T16:24:16.780

除非您知道自己在做什么，否则总是选择八叉树，这样您就可以停止过度优化并开始研究更严肃的功能。严重的是，瓶颈总是在其他地方，或者您正在围绕一个优化的系统设计代码，最终阻止某些类型的更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T05:29:40.623

通常这些事情没有一个明确的答案。我建议 A、B 和 C 是你的空间大小和你要区分的东西数量的函数的结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T05:40:27.790

BSP 更适合您只想进行遮挡的更小、更简单的空间。如果您想要给定光线的所有交点，则需要升级到四叉树/八叉树。

至于四叉树与八叉树 - 您非常关心多少维度？二维表示四叉树，四维表示八叉树。如前所述，由于四叉树可以在三个空间中工作，但是如果您希望对每个维度进行适当的处​​理，那么八叉树就是要走的路。

# php - 将 phpinfo() 转换/提取为 php.ini

> ID：99802
> 
> 赞同：4
> 
> 时间：2008-09-19T05:09:25.977
> 
> 标签：php

我正在考虑复制 Web 主机 PHP 设置环境以进行离线本地开发。这个想法是解析 phpinfo() 的输出并将它包含的任何设置值写入本地 php.ini。我会想象phpinfo中包含的所有东西，并且某些东西只会特定于它运行的环境（路径）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T05:20:36.997

您可能会从 ini_get_all() 获得更多可用的结果

[http://us.php.net/manual/en/function.ini-get-all.php](http://us.php.net/manual/en/function.ini-get-all.php)

然后，您可以遍历关联的数组来重建一个 ini 文件，而无需解释 phpinfo() 的输出

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T05:13:22.443

它很可能只是库存安装。即便如此，我仍然想让本地开发环境与实时 php.ini 略有不同，以确保它显示所有正在产生的错误（而不是隐藏，或者只是将它们记录在实时站点上）。

# macos - 有哪些有用的 TextMate 快捷键？

> ID：99807
> 
> 赞同：43
> 
> 时间：2008-09-19T05:10:00.813
> 
> 标签：macos, keyboard-shortcuts, textmate, textmatebundles

Mac 因拥有大量快捷方式而闻名（或令人遗憾）。[然而，与TextMate](http://macromates.com/)及其捆绑软件中的快捷方式列表相比，OS X 本身就相形见绌了。

您使用哪些有用的键盘快捷键？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-09-19T05:54:01.207

这些是我最喜欢的快捷方式：

*   `cmd`+`t`开始输入文件名来打开它
*   `ctrl`+`w`选择单词
*   `cmd`+`r`运行打开的 ruby​​ 或 php 脚本
*   `cmd`+ `opt`+`m`定义一个新的宏
*   `cmd`+ `shift`+`m`运行宏
*   `opt`切换到垂直选择模式
*   `cmd`+ `opt`+`a`编辑所选行的末端

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-20T13:58:27.700

*   `ctrl`+`shift`+`K` deletes current line
*   `ctrl`+`shift`+`J` merges current line with the next line

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-01-03T17:53:55.957

`Esc` auto completes common words in the document you are working in.

For example if you are using a function alot called `LongFuntionNameThatChecksStuff`, you can type `Lon` and press`Esc` and it should auto complete.

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-06-09T21:40:27.787

**Control-T**(`Control``T`): *Transpose* (works in most Cocoa-native text fields and areas, but TextMate enhances the behavior).

*   Place your caret between two characters, hit `Control``T`, and the characters switch places (this is standard Mac behavior). Awesome for typos.

*   Select a word or series of characters on a single line, hit `Control``T`, and the characters in the selection will now be reversed (not too useful, but this is a TextMate enhancement)

*   Select a series of characters that spans more than one line, hit `Control``T`, and the lines will reverse. Characters within the line will still be in order. Most useful when selecting whole lines, but still works with partial lines selected, just so long as there is at least one newline character selected (TextMate enhancement).

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-08T09:58:06.763

My favourites are:

*   `option`+`command`+`[` to clean up your indentation
*   "lorem", `TAB` to insert placeholder text

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-19T08:39:26.753

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-07-16T14:33:24.923

shift+ctrl+alt+v sends selected text to pastie.org

also, using the PHP Bundle, try to start writing a function name and do the following:

str + alt + F3 = list of available functions

str + alt + F1 = short description of the function you've just completed.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-01-03T17:07:59.903

Look word up in dictionary, in any Cocoa app (not just Textmate): ctrl + cmd + D

![alt text](https://i.stack.imgur.com/lEAjv.png)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-01-03T17:21:36.677

Wrap each selected line in markup tags: `SHIFT` + `CONTROL` + `COMMAND` + `W`

For example, if you have:

```
 This is a 
  few sample
  list items 
```

Highlight all three lines and presss `SHIFT` + `CONTROL` + `COMMAND` + `W` to create:

```
 <li>This is a </li>
  <li>few sample</li>
  <li>list items</li> 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-01-03T22:48:08.677

Generate Lorem ipsum: `lorem` + `TAB`

Will generate:

> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-01-03T17:06:25.223

Selecting text using `alt` (via click and drag)

then use `⌘</kbd> + `]` to indent (or `[` to dedent)`

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-01-03T17:17:26.333

Delete the current line: `CONTROL` + `SHIFT` + `K`

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-01-03T17:38:33.047

Format CSS: `CONTROL` + `Q`

Select some CSS and press `CONTROL` + `Q` to turn this:

```
body { background: red; font-size: 10px; color: black; } 
```

Into this:

```
body {
  background: red;
  font-size: 10px;
  color: black;
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-01-03T17:55:46.260

Look up property specifications in W3C: `CONTROL` + `H`

This works for both HTML and CSS. Place your carrot over whatever property you'd like to look up and press `CONTROL` + `h`. This will open a new window listing the W3C info.

For example, place your carrot over background:

```
body {
  background: red;
} 
```

Hit `command` + `h` and you'll see something like:

![alt text](https://i.stack.imgur.com/XzHTW.png)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-01-03T22:56:25.590

Edit the end of multiple selected lines simultaneously : `COMMAND` + `OPTION` + `A`

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-02-25T23:17:56.100

Toggle between `{}` and `do` `end` blocks. Place your cursor on the block arugument (i.e. the word after the keyword `do` between the two pipes) and press `Shift` + `Control` + `{`

For example, converts:

```
@post.each do |post|
  puts post.name
end 
```

to:

```
@post.each { |post| puts post.name } 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2011-09-06T03:54:38.257

`CMD` + `/` comments out a line and it's smart enough to format based on language. I use it all the time.

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-01-03T17:13:58.547

Close the nearest open html/xml tag: `OPTION` + `COMMAND` + `PERIOD`

For example, if you have:

```
<div>Lorem ipsum dolor sit amet, consectetur 
```

`CONTROL` + `COMMAND` + `D` will automatically add the closing `</div>` tag to create:

```
<div>Lorem ipsum dolor sit amet, consectetur</div> 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2011-01-03T17:25:40.017

Switch between tabs:

*   Left: `SHIFT` + `COMMAND` + `[`
*   Right: `SHIFT` + `COMMAND` + `]`

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-19T05:16:36.193

在[cftextmate](http://cftextmate.com/)包中，您可以键入任何不带开头“<”或关闭“>”的 cfml 标记，然后按 Tab，它会完成整个标记，然后您可以使用 Tab 标记到每个标记属性。我不确定这种快捷方式是否适用于其他语言。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-19T05:35:06.400

**我刚刚在Bundles** > **HTML** > **Entities**下找到了一个带有定义的快捷键符号列表- 这对我了解 TextMate 的整个快捷方式很有帮助。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-11-04T18:30:34.710

You can get a really great desktop background [here](http://www.wishingline.com/notebook/2007/01/textmateshortcutsdesktop/). It has a ton of really useful keyboard shortcuts. I used it for a couple of days before memorizing the most useful ones.

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2011-01-03T17:03:08.467

Wrap selected text in markup tags: `SHIFT` + `CONTROL` + `W`

For example, if you have:

```
Lorem ipsum dolor sit amet, consectetur 
```

Highlight the text and press `SHIFT` + `CONTROL` + `W` to create:

```
<p>Lorem ipsum dolor sit amet, consectetur</p> 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2011-01-03T17:16:07.003

Go to File: `⌘</kbd> + `T``

Find in Project: `⌘</kbd> + `SHIFT` + `F``

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2011-01-03T17:29:00.533

Eliminate all whitespace / carriage returns between the location of your caret and the start of the next piece of content: `SHIFT` + `CONTROL` + `J`

For example, if you have:

> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
> 
> Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip.

Place your caret at the end of the first paragraph and press `SHIFT` + `CONTROL` + `J` to remove the space in between the paragraphs:

> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip.

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-04-15T15:50:53.313

(these are mostly html-related)

*   `cmd` + `option` `+` closes current open html tag
*   `shift` + `cmd` + `w` wrap selection in tags
*   `ctrl` + `return` insert escaped line end, i.e. `\n` or `<br>` depending on the occasion.

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2011-01-03T17:57:59.740

Copy and Paste Clipboard: `⌘</kbd> + `SHIFT` + `V``

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2011-01-03T22:50:47.773

Titleize selected text: `CONTROL` + `OPTION` + `U`

Will turn:

> Lorem ipsum dolor sit amet, consectetur adipisicing elit.

Into:

> Lorem Ipsum Dolor Sit Amet, Consectetur Adipisicing Elit.

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-01-03T22:52:21.940

Downcase selected text: `CONTROL` + `SHIFT` + `U`

Will turn:

> Lorem ipsum dolor sit amet, consectetur adipisicing elit.

Into:

> lorem ipsum dolor sit amet, consectetur adipisicing elit.

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-01-03T22:53:47.727

Upcase selected text: `CONTROL` + `SHIFT` + `U`

Will turn:

> Lorem ipsum dolor sit amet, consectetur adipisicing elit.

Into:

> LOREM IPSUM DOLOR SIT AMET, CONSECTETUR ADIPISICING ELIT.

# sql-server - 将 ID/标签附加到 LINQ to SQL 生成的代码？

> ID：99827
> 
> 赞同：0
> 
> 时间：2008-09-19T05:12:54.270
> 
> 标签：sql-server, linq-to-sql

我有兴趣将 LINQ to SQL 进行的数据库调用跟踪回生成调用的 .NET 代码。例如，DBA 可能担心某个特定的缓存执行计划表现不佳。例如，如果 DBA 要告诉开发人员解决以下代码...

```
exec sp_executesql N'SELECT [t0].[CustomerID]
FROM [dbo].[Customers] AS [t0]
WHERE [t0].[ContactName] LIKE @p0
ORDER BY [t0].[CompanyName]',
'N'@p0 nvarchar(2)',@p0=N'c%' 
```

...不是很明显哪个 LINQ 语句产生了调用。当然，您可以在自动生成的数据上下文中搜索“客户”类，但这只是一个开始。对于大型应用程序，这可能很快变得难以管理。

有没有办法将 ID 或标签附加到由 LINQ to SQL 生成和执行的 SQL 代码？大声思考，这是一个名为“TagWith”的扩展函数，它从概念上说明了我感兴趣的事情。

```
var customers = from c in context.Customers
                where c.CompanyName.StartsWith("c")
                orderby c.CompanyName
                select c.CustomerID;

foreach (var CustomerID in customers.TagWith("CustomerList4"))
{
    Console.WriteLine(CustomerID);
} 
```

如果“CustomerList4”ID/标签最终出现在自动生成的 SQL 中，我将被设置。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T05:38:12.180

您是否查看过使用 DataContext.Log 属性捕获 T-SQL？如果您能够将它捕获到一个也具有您的 tag 属性的对象中，您可能能够对您的应用程序执行的 SQL 进行编目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T16:30:00.090

没有公开的方式来修改 LINQ to SQL 生成的底层 SQL 以实现这样的标记工具。您可以以这样的方式实现 Log 属性，它会写出带有一些调用堆栈信息的文本日志文件，以显示哪些方法生成了哪些 SQL 语句以供参考。

# eclipse - Eclipse 文本比较顺序

> ID：99830
> 
> 赞同：8
> 
> 时间：2008-09-19T05:13:36.950
> 
> 标签：eclipse, macos, eclipse-3.4, ganymede, text-comparison

我正在使用 Eclipse 3.4（在 Mac 上），我对文本比较感到烦恼，因为我正在按特定顺序比较文件，这不是我想要的。

当我比较两个文件时，它似乎总是把第一个文件（按字母顺序）放在左边，后一个放在右边，但我希望能够在比较的基础上改变它。
比较'file-a'和'file-b'的IE总是在左边有'file-a'，但这并不总是我想要的。我似乎记得在早期版本的 Eclipse 中，更改选择比较时右键单击的文件 -> 彼此更改了顺序，但这在 3.4 中对我不起作用。

我为什么关心的一个例子：
我刚刚执行了一个颠覆合并并发生了冲突，所以我现在有以下文件：
*file
file.merge-left
file.merge-right
file.working*

*我已经对文件*进行了更改，现在想将*文件*与*file.merge-right*和*file.working*与*file.merge-left*进行比较并拆分编辑器，以便我可以将工作/左侧更改放在文件/右侧更改之上，然后只需翻阅比较编辑器并确保此文件与合并所来自的文件之间的差异已被保留，但*文件*在左侧，而*file.working*在右侧，因此差异需要对角线比较，而不仅仅是比较顶部和底部。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T06:11:42.457

是的，这实际上很烦人。我们使用一个名为 Beyond Compare 的外部工具（我们有公司许可证），它可以轻松地交换双方。

您可能应该做的是使用 Bugzilla 向相关 Eclipse 团队提出增强请求。如果有足够的需求，它要么进入下一个版本，要么有人会编写一个新的（或修改现有的）插件以允许交换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-28T13:23:12.523

当比较屏幕出现时，有一个“从和到交换”按钮。使用 Eclipse 3.6。我实际上正在寻找一种改变默认行为的方法。例如，当我比较修订时，它总是在左侧而不是右侧显示最新的修订，除非我在比较之前单击交换按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-06T11:07:00.073

正如我在[这里](https://stackoverflow.com/a/42066221/2047679)提到的，Eclipse Neon.2 (4.6.2) 有一个按钮来交换视图：

[![在此处输入图像描述](https://i.stack.imgur.com/wPE4a.png)](https://i.stack.imgur.com/wPE4a.png)

# java - 最大的 GWT 陷阱？

> ID：99866
> 
> 赞同：189
> 
> 时间：2008-09-19T05:23:57.597
> 
> 标签：java, ajax, gwt, gwt-ext

我正处于我们选择使用 GWT 实施的项目的开始/中间。有没有人在使用 GWT（和 GWT-EXT）时遇到任何无法克服的重大陷阱？从性能的角度来看呢？

我们已经看到/听到的一些事情包括：

*   谷歌无法索引内容
*   总体而言，CSS 和样式似乎有点不稳定

也在寻找有关这些项目的任何其他反馈。谢谢！

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2008-09-19T05:59:45.217

我首先要说我是 GWT 的忠实粉丝，但是确实有很多陷阱，但我们能够克服的大部分（如果不是全部的话）：

**问题：**编译时间长，随着项目的增长，编译所需的时间也会增加。我听说过 20 分钟编译的报告，但我的平均大约 1 分钟。

**解决方案：**将您的代码拆分为单独的模块，并告诉 ant 仅在更改时才构建它。此外，在开发过程中，您可以通过只为一个浏览器构建来大大加快编译时间。您可以通过将其放入 .gwt.xml 文件来执行此操作：

```
<set-property name="user.agent" value="gecko1_8" /> 
```

其中 gecko1_8 是 Firefox 2+，ie6 是 IE，等等。

* * *

**问题：**托管模式非常慢（至少在 OS X 上），并且与您在编辑 JSP 或 Rails 页面等内容并在浏览器中点击刷新时获得的“实时”更改不匹配。

**解决方案：**您可以为托管模式提供更多内存（我通常为 512M），但它仍然很慢，我发现一旦您对 GWT 足够好就停止使用它。您进行了大量更改，然后仅针对一个浏览器进行编译（通常需要 20 秒的编译时间），然后只需在浏览器中点击刷新即可。

更新：使用 GWT 2.0+ 这不再是问题，因为您使用新的“开发模式”。这基本上意味着您可以直接在您选择的浏览器中运行代码，因此不会损失速度，而且您可以触发/检查它等。

[http://code.google.com/p/google-web-toolkit/wiki/UsingOOPHM](http://code.google.com/p/google-web-toolkit/wiki/UsingOOPHM)

* * *

**问题：** GWT 代码是 java，与布局 HTML 页面有不同的心态，这使得采用 HTML 设计并将其转换为 GWT 更加困难

**解决方案：**您再次习惯了这一点，但不幸的是，将 HTML 设计转换为 GWT 设计总是比将 HTML 设计转换为 JSP 页面之类的操作要慢。

* * *

**问题：** GWT 需要一些时间来了解，并且还不是主流。这意味着大多数加入您的团队或维护您的代码的开发人员必须从头开始学习

**解决方案：** GWT 是否会起飞还有待观察，但如果您是一家可以控制招聘人员的公司，那么您始终可以选择了解 GWT 或想学习 GWT 的人。

* * *

**问题：**与 jquery 或纯 javascript 之类的东西相比，GWT 是一把大锤。实现它需要更多的设置，而不仅仅是包含一个 JS 文件。

**解决方案：**将 jquery 之类的库用于适合这些的更小、更简单的任务。如果您想在 AJAX 中构建真正复杂的东西，或者您需要通过 RPC 机制来回传递数据，请使用 GWT。

* * *

**问题：**有时为了填充您的 GWT 页面，您需要在页面首次加载时进行服务器调用。当您获取所需数据时，用户坐在那里观看加载符号可能会很烦人。

**解决方案：**在 JSP 页面的情况下，您的页面在成为 HTML 之前已经由服务器呈现，因此您实际上可以进行所有 GWT 调用，并将它们预加载到页面上，以便即时加载。有关详细信息，请参见此处：

[通过预序列化 GWT 调用来加速页面加载](http://wiki.shiftyjelly.com/index.php/GWT#Speed_up_Page_Loading.2C_by_pre-serializing_your_GWT_calls)

* * *

我从来没有遇到任何问题 CSS 样式我的小部件，开箱即用，自定义或其他，所以我不知道你的意思是这是一个陷阱？

至于性能，我一直发现编译后的 GWT 代码很快，而且 AJAX 调用几乎总是比整个页面刷新要小，但这并不是 GWT 真正独有的，尽管如果你使用本机 RPC 数据包，你会得到一个 JAVA 后端非常紧凑。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-01-10T18:54:09.020

我们已经与 gwt 合作了将近 2 年。我们吸取了很多教训。以下是我们的想法：

1.  不要使用第三方小部件库，尤其是 gwt-ext。它会扼杀您的调试、开发和运行时性能。如果您对这是如何发生的有疑问，请直接与我联系。

2.  使用 gwt 仅填写应用程序的动态部分。因此，如果您有一些涉及大量字段的复杂用户交互。但是，请勿使用随附的面板。以您现有的库存设计师提供的页面为例。划出将包含应用程序控件的区域。在 onModuleLoad() 中将这些控件附加到页面。通过这种方式，您可以使用设计师的标准页面，也可以在 gwt 之外进行所有样式设置。

3.  不要将整个应用程序构建为一个标准页面，然后动态构建所有部分。如果您按照我在第 2 项中的建议进行操作，无论如何都不会发生这种情况。如果您动态构建所有内容，您将降低性能并为大中型应用程序消耗大量内存。另外，如果你按照我的建议去做，后退按钮会很好用，搜索引擎索引等也会很好用。

其他评论者也提出了一些很好的建议。我使用的经验法则是像创建标准网页一样创建页面。然后雕刻出需要动态的部分。将它们替换为具有 id 的元素，然后用于`RootPanel.get( id ).add( widget )`填充这些区域。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-19T19:10:43.573

我们遇到的陷阱：

*   虽然您可以从使用 GWT EXT 之类的东西中获得很多好处，但任何时候您在 JavaScript 库之上使用这种薄薄的单板，您就失去了调试的能力。不止一次我把头撞在桌子上，因为我无法检查（在我的 IntelliJ 调试器中）GWT EXT 表类中发生了什么......你所看到的只是它是一个 JavaScriptObject。这使得很难弄清楚出了什么问题......

*   团队中没有了解 CSS 的人。根据我的经验，这个人不是专家并不重要......只要他有一些良好的工作知识，并且在必要时知道谷歌的正确术语就足够了。

*   跨浏览器调试。密切关注进程外托管模式[ [1](http://code.google.com/p/google-web-toolkit/wiki/DesignOOPHM) ][ [2](http://groups.google.com/group/Google-Web-Toolkit/browse_thread/thread/4a62dd27602d822d/c37fece9c24f3715?lnk=gst&q=noserver) ][ [3](http://groups.google.com/group/Google-Web-Toolkit/browse_thread/thread/1203bb0f1eb36ad5) ]，希望在 GWT 1.6 中出现……现在，您只需使用托管模式，然后使用“编译/浏览”按钮，您可以在其中与其他浏览器一起玩。对我来说，在 Windows 上工作，这意味着我可以在 FireFox 中查看我的工作，并使用 FireBug 来帮助调整并使事情变得更好。

*   IE6。令人惊奇的是 IE 6 将呈现不同的事物。我采用了根据浏览器将样式应用于最外层“视口”的方法，这样我就可以拥有如下 CSS 规则：

    ```
    .my-style { /* stuff that works most everywhere */ }

    .msie6 .my-style { /* "override" so that styles work on IE 6 */ } 
    ```

最后，确保您使用对您有帮助的编辑器。我使用 IntelliJ——它有很多 GWT 智能。例如，如果我尝试使用 JRE 仿真未处理的类，它会让我知道；如果我为一个小部件指定了一个样式，但我还没有定义那个样式，代码就会变成红色的小波浪……或者，在查看 CSS 时，它会告诉我什么时候我在一个单一规则。（我还没有尝试过，但我知道版本 8 具有更好的 GWT 支持，例如保持“本地”和“异步”RPC 接口和实现同步。）

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-09-10T19:07:40.703

GWT 2.0 预计将在未来几个月内发布，它解决了许多讨论的问题。

*   使用类似 html/xml 的语法创建布局
*   动态脚本加载 - 最初只会下载必要的 JS。其余的将根据需要下载
*   浏览器内托管模式 - 这可能会解决所讨论的托管模式速度问题，以及其他好处
*   “编译器优化” - 更快的编译，希望

[Google I/O 上的 GWT 2.0 预览视频](http://code.google.com/events/io/sessions/GwtPreviewGoogleWebToolkit2.html)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-07-19T12:24:58.737

不是“无法克服”，而是对一些基本的东西有点痛苦。

**日期处理：**

GWT 使用 deprecated `java.util.Date`，这可能会在客户端处理日期时导致意外行为。`java.util.Calendar`GWT 不支持。[更多信息在这里](http://code.google.com/p/google-web-toolkit/issues/detail?id=603)。

相关问题示例：

*   [GWT java.util.Date 序列化错误](https://stackoverflow.com/questions/2102085/gwt-java-util-date-serialization-bug)
*   [在 GWT 中获取日期详细信息（日、月、年）](https://stackoverflow.com/questions/3201762/get-date-details-day-month-year-in-gwt)
*   [GWT 中的客户端时区支持](https://stackoverflow.com/questions/1686448/client-side-time-zone-support-in-gwt)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-19T11:23:00.047

我将在已经提到的基础上添加一些要点：

*   数据绑定/验证。GWT 没有开箱即用的数据绑定/验证支持，尽管该领域的一些项目开始出现。你会发现自己写了很多这样的东西：

```
文本字段 fname，faddress；
...
fname.setText(person.getName());
faddress.setText(person.getAddress());
...

```

*   延迟加载。由于 gwt 在客户端，因此延迟加载确实不是一种选择。您必须仔细设计您的 RPC 和域对象，以便
    *   发送所有需要的对象数据
    *   避免急于获取所有数据
    *   您还必须确保不会发送代理/不可序列化对象。[hibernate4gwt](http://hibernate4gwt.sf.net)可以帮助您解决这些问题。
*   用户界面设计。在 java（面板、按钮等）中可视化 UI 比在 html 中更难。
*   历史支持。GWT 不附带 History 子系统，也不附带任何用于漂亮 url 或有状态书签的子系统。你必须自己动手（尽管它支持历史令牌，这是一个开始）。所有 AJAX 工具包 AFAIK 都会发生这种情况。

恕我直言，GWT 缺少一个对该“线程”中提到的所有问题提供开箱即用支持的框架。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-09-19T15:19:13.803

我现在正在做一个项目，它使用 EXT GWT (GXT) 不要与 GWT EXT 混淆。有一个区别，EXT GWT 是由编写 ExtJS javascript 库的公司实际生产的。GWT EXT 是围绕 ExtJS 库的 GWT 包装器。GXT 是本机 GWT。

无论如何，GXT 仍然有些不成熟，缺乏我认为 GWT EXT 拥有的坚实社区。然而，GXT 是未来，因为它是原生的 GWT，实际上是由制造 ExtJS 的公司开发的。由于 ExtJS 库上的许可证更改，GWT EXT 有点瘫痪，从而减缓了 GWT EXT 的开发。

总的来说，我认为 GWT/GXT 是开发 Web 应用程序的一个很好的解决方案。实际上，我非常喜欢托管模式进行开发，它使事情变得快速而简单。您还可以获得能够调试代码的好处。使用 JUnit 进行单元测试也非常可靠。我还没有看到一个很棒的 JavaScript 单元测试框架，我觉得它足够成熟，可以测试企业应用程序。

有关 GWT EXT 的更多信息：http: [//gwt-ext.com/](http://gwt-ext.com/)

有关 EXT GWT (GXT) 的更多信息：http: [//extjs.com/products/gxt/](http://extjs.com/products/gxt/)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-19T05:38:29.980

没有我无法轻松克服的重大陷阱。大量使用托管模式。当您使用 GWT-ext 时，您几乎不需要自己接触 CSS，除非您想调整开箱即用的外观。

我的建议是在功能接近的库上使用 GWT“本机”小部件。

重新搜索引擎索引：是的，该站点通常不会有可导航的 URL（除非您只是将小部件添加到常规网站的元素中）。不过，您可以执行历史回退/转发功能。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-19T15:06:56.297

前段时间我在一个项目中同时使用了 GWT 和 GWT-ext。随着 Web 开发的进行，我发现体验非常顺畅，但我的建议是：

不要将 GWT 本机小部件与 EXT 小部件混合使用。这令人困惑，因为通常名称是相同的（GWT.Button 或 GWText.Button？）

发生在我身上的一件事确实使代码比我想要的更复杂，那就是我想要一个面板，它 a) 可动态更新 b) 可级联

GWT 原生面板是动态的，Ext 面板是可级联的。解决方案？一个 GWT.VerticalPanel 包装了一个 GWText 面板......混乱。:)

但是，嘿，它有效。;)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-20T01:05:13.567

我赞同 ykagano 的评论，最大的缺点是在 MVC 中丢失了 V。尽管您可以将真正的 ui 类与客户端代码的其余部分分开，但您不能轻松地使用由图形/网页设计师生成的 HTML 页面。这意味着您需要开发人员将 HTML 翻译成 java。

获得一个所见即所得的 ui 编辑器，它将为您节省大量时间。我使用 GWTDesigner。

GWT 最大的好处是能够忘记跨浏览器问题。它不是100％，但几乎消除了所有痛苦。结合托管模式调试的优势（与 Firebug 相比，Firebug 非常出色但与 java 调试器不同），它为开发人员在生成复杂的 ajax 应用程序方面提供了巨大的优势。

哦，它在运行时很快，特别是如果你使用 gzip 过滤器。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-20T15:11:17.183

有点题外话，但 irc 上的#gwt 频道非常有帮助，以防万一您遇到问题。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2010-02-02T07:45:40.283

GWT 非常简单直观。

特别是随着 UIBinder 的发布，它允许 GWT 小部件以 XML 布局，然后在 Java 中进行编码。

所以如果你用过其他的Ajax或者Flash设计工具，或者Silverlight等，GWT是非常容易学习的。

主要障碍（如果不是陷阱）是 GWT RPC。您希望使用 GWT 的真正原因是因为 GWT 异步 RPC。否则，为什么不只依靠 css 来格式化你的页面呢？

GWT RPC 是允许服务器刷新服务器上的数据而无需刷新页面的元素。这是对股票表现监控（或美国当前的国家和公共债务或世界范围内流产的未出生婴儿数量）等页面的绝对要求。

GWT RPC 需要一些努力才能理解，但只要几个小时，就应该清楚了。

除此之外，在努力学习 GWT RPC 之后，你终于发现你不能使用 JSP 作为 RPC 的服务组件，除非......我的博客上有一个 8 部分（我认为）系列关于如何使用 JSP作为 GWT RPC 服务者。但是，由于您没有要求答案，而只是提出问题，因此我将停止为我的博客做广告。

所以。我非常相信使用 GWT 的最大障碍/陷阱是找出如何正确部署 GWT 异步 RPC 以及如何使其能够使用 JSP 服务。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-19T20:14:51.813

我们很难将我们的 GWT 代码库与我们从网页设计师那里获得的 HTML Web 模板（我们希望 GWT 管理的具有特定 div id 的静态 HTML 页面）结合起来。至少在我们使用它的时候，我们无法让 GWT 与我们网站中未使用 GWT 编码的部分集成。我们最终让它工作了，但这是一个很大的黑客攻击。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-11-07T14:38:00.310

*   您必须为每个服务接口编写的异步接口看起来像是 GWT 编译器可以自动生成的。
*   大型项目的编译时间变长

但对于大型 Javascript 项目，它是最佳选择

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-03-19T16:26:23.997

GWT 2.4 已经修复了许多上述问题，并且一个很棒的小部件库刚刚从 Beta 版（Ext GWT 3.0.4 aka GXT）中出来，它完全用 GWT 编写，而不是 JS 库的包装器。

剩余疼痛：

*   缺乏 CSS3 选择器支持，您可以在某些情况下使用“literal()”来绕过它。
*   缺乏对 CSS3 和现代浏览器事件（如*transitionEnd* ）的支持。
*   缺乏对 Java Calendar 类的支持（多年后）。
*   缺乏对 JUnit4 的支持（5 年而且还在继续）。
*   **Google GWT 团队缺乏明确的路线图和发布时间表。**

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-03-28T10:49:17.813

关于 GWT 2.4，调试 GWT 时**使用 Firefox**，它比使用 chrome 快得多。如果您只使用 firefox，请考虑将此行放在您的**project.gwt.xml**文件中

```
<set-property name="user.agent" value="gecko1_8" /> 
```

此外，如果您使用的是 eclipse，请在 arguments -> VM arguments 下添加以下内容：

**-Xmx512m -XX:MaxPermSize=1024m -XX:PermSize=1024m**

您可以划分服务器和客户端，并在 arguments -> Program arguments 下使用以下内容： **-codeServerPort 9997 -startupUrl [http://yourserver/project](http://yourserver/project) -noserver**

此外，为了防止在每次更改时刷新服务器，请使用 JRebel [http://zeroturnaround.com/blog/how-to-rock-out-with-jrebel-and-google-web-toolkit-gwt/](http://zeroturnaround.com/blog/how-to-rock-out-with-jrebel-and-google-web-toolkit-gwt/) 这是一个现场演示 [http://www.youtube.com/watch?feature=player_embedded&v=4JGGFCzspaY](http://www.youtube.com/watch?feature=player_embedded&v=4JGGFCzspaY)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-19T10:53:09.630

一个主要的缺陷是，有时您需要显式地为最终成为 HTML 元素的内容分配一个 id，以便能够使用某些 CSS 样式。例如：当 tabPanel 的 tabBar 被分配了一个 id 并且您在该 elementId 上指定了一个 :hover 时，GWT TabPanel 只会在 tabBarItems 上执行 :hover。

我在其他地方写过[GWT 的其他一些缺点](http://confusion.tweakblogs.net/blog/1052/the-disadvantages-of-the-google-web-toolkit.html)，但它们已经被 rustyshelfs 回答:)。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-09-10T04:57:28.477

我最近在 GWT 上做了很多工作，这就是我不得不说的：

1.  CSS 样式只是有时很棘手，使用 IE 中的 IE 开发人员工具和 Firefox 中的 firebug 来弄清楚到底发生了什么，你就会清楚地知道需要更改哪些 css
2.  您可以使用技巧让谷歌对其进行索引。一个非常著名的网站是[http://examples.roughian.com/](http://examples.roughian.com/)在 google 上查看它的评级。一个不太出名的网站是[www.salvin.in](http://www.salvin.in)（忍不住要提一下），我将其优化为单词：salvin 主页（在 google 上搜索这三个单词）

我对 GWT-EXT 了解不多，但我也相信没有必要包含第三方库。

祝你的决定好运:)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-05-14T20:12:38.903

GWT 进行浏览器嗅探而不是特征检测，您的应用程序将无法在某些浏览器上运行（特别是新浏览器）

以下是该问题的一些参考：

*   [google-web-toolkit 问题 2938：RFE：改进 user.agent 属性提供程序以应对 userAgent 字符串“屏蔽”](http://code.google.com/p/google-web-toolkit/issues/detail?id=2938)
*   [Iceweasel 不再支持？- Google 文档帮助](http://www.google.com/support/forum/p/Google+Docs/thread?tid=72fe7b0e15737560&hl=en)
*   [每个浏览器的 GWT 实现](http://code.google.com/p/google-web-toolkit/source/browse/#svn/trunk/user/src/com/google/gwt/user/client/impl)

以下是对特征检测的一些参考：

*   [浏览器检测（以及替代方法）](http://www.jibbering.com/faq/faq_notes/not_browser_detect.html)
*   [特征检测：最先进的浏览器脚本](http://peter.michaux.ca/articles/feature-detection-state-of-the-art-browser-scripting)
*   [浏览器特征检测](https://developer.mozilla.org/En/Browser_Feature_Detection)

摘自[JavaScript 框架比较 - 维基百科](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-01-30T01:25:21.187

GWT 团队对去年发布的 GWT 2.7 做了很多重大改进。GWT 的一个主要弱点是在 GWT 2.6 及更低版本中编译需要很长时间。现在已经没有了 GWT 没有增量编译，它超级快并且只编译更改。

GWT 2.7 现在有（[来源](https://drive.google.com/file/d/0B3ktS-w9vr8IbERCZ2VXbjZYeVE/view)）：

*   增量构建现在只需几秒钟
*   更紧凑、更准确的 SourceMap
*   GSS 支持
*   JS互操作
*   出色的 JavaScript 性能
*   更小的代码大小

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-03-14T01:13:57.750

获得可靠事实的最佳方法是通过[gwt 调查](https://vaadin.com/documents/10187/4238532/GWT_report_2015.pdf/066936d9-8fcf-40bb-a58f-616a3d3f8203)。GWT 的最大问题之一一直是编译时间过长。幸运的是，它正在迅速改善，因此在不久的将来它不会成为一个重大问题。另一个陷阱是 GWT 要复杂得多，因为 Java 是一种更复杂的语言，可以在每一步都抵制糟糕的编码人员。另外，编译增加了一层。例如，js 互操作需要一些样板文件。根本问题是 GWT 的设计并不简单。它是为极其复杂的 Web 应用程序从头开始设计的，整个社区始终将性能、代码质量、架构等优先于简单编码。
请记住，您可以随时在 GWT 中使用 js，因此如果您在 GWT 中遇到困难，请考虑使用 js。归根结底，GWT 就是 js，所以你可以在 GWT 中做任何你可以在 js 中做的事情。事实上，大多数 GWT 项目都使用 js。问题是 GWT 要复杂得多。然而，有时额外的复杂性是值得的。

值得注意的是，GWT 3.0 将带来巨大的改进。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-10-27T02:23:32.047

重用 RPC 服务对象。
它会导致竞争条件看起来像应用程序挂起。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-12-11T23:03:19.933

我遇到的陷阱 1\. superdev 模式下的不同行为。例如 Someclass.class.getName() 在 Superdev 模式下工作得非常好，并返回类的完全限定名。在生产模式下，这不起作用。

2.  addWidget(widget) 将调用小部件的 removefromparent()

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-06-07T01:19:51.800

GWT 是技术杰作。它将客户端和服务器编程结合在一起，使其成为一个连贯的应用程序——软件在“分层”之前的编写方式，以及它应该被编写的方式。它消除了不同的技能组合、团队成员之间的沟通不畅，以及整个网页设计阶段：艺术和编程。它是最接近移动设备的地方，例如 Android 开发。事实上，GWT 旨在生成不同的原生 UI，而不仅仅是 HTML。虽然它需要大量的纪律来确保这种解耦——保持你的内层与表示无关。

你应该避免的第一个错误，我花了四年时间才意识到，是使用第三方扩展，如 EXT-GWT aka GXT 和 SmartGWT。开始使用他们漂亮的桌面小部件而不是投资自己的样式是非常诱人的，但是直到我终于厌倦了，我才知道我在使用 SmartGWT 时遇到了多少问题。简而言之，它将核心 GWT 功能集冻结在某个（相当过时的）级别，然后在它之上构建。还要记住，如今轮廓分明的桌面外观和感觉看起来很傻，更不用说性能低下、大量错误和兼容性功能——尤其是在移动设备上。您希望尽可能接近原生浏览器控件，即呈现为原生 <select> 元素的下拉菜单，而不是一些自定义绘制的控件。

由于移动趋势，整个用户体验变得更加简单和扁平，因此您不需要做太多的事情来设计一个外观清晰的应用程序。虽然如果你想要“3D”外观，也有渐变。CSS3 让一切变得简单，GWT 以一种优雅的面向对象的方式包装它，这与原始 CSS 不同。因此，不要因为在 GWT Showcase 中看到相当丑陋的准系统控件而气馁。GWT 团队故意不提供任何样式，因为这是开发人员的工作。

剩下的就是用漂亮简洁的 API 用强类型 Java 编写的非常传统的浏览器编程。但是当然永远不要忘记你的代码在浏览器中运行，所以所有的调用都是异步的，例如你不能在一个循环中调用 GWT-RPC 方法（填充一些列表），但是如果你遇到过这个问题，需要递归地链接它们情况。

有一些自称的“反模式”，比如不使用 GWT-RPC。到目前为止，这对我来说一直很好：10 年了。简单是关键。我不会考虑为了代码的优雅和可维护性而牺牲一些边际性能。除此之外，这不是您的瓶颈所在 - 在数据库中。当然要注意您向客户端发送了多少数据。

如果您无法找到现有的小工具或为其设置样式 - 阅读丰富的 HTML5 元素集，您可以随时包装第三方的。我用流行的 jQuery FullCalendar 做到了。根本不是火箭科学。像谷歌地图和谷歌图表这样的其他东西都有半官方的 GWT 包装器。

GWT 是完美的。它没有得到足够喜爱的唯一原因是，仍然影响该行业的早期互联网采用者并非来自计算机科学和面向对象的语言来欣赏它们。他们有艺术（Photoshop/WordPress）或网络（Perl/Python）背景。

# c# - .NET 的基于 f/oss GDI+ (System.Drawing) 的图形和图表组件有什么好的？

> ID：99869
> 
> 赞同：2
> 
> 时间：2008-09-19T05:25:49.853
> 
> 标签：c#, .net, vb.net, gdi+, graph

我想为 .NET 3.5 WinForms 创建基本的折线图、条形图、饼图和面积图，并且我有兴趣找到一个免费、成熟、开源的 .NET（最好基于 C#）项目来帮助我实现这一目标。我会考虑一个基于 WPF 的项目，但是我更喜欢 GDI+，所以我宁愿它使用 System.Drawing 和/或 GDI 互操作作为其基础技术。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T05:27:55.073

[泽德图](http://zedgraph.org/)。'纳夫说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T05:28:19.177

这个不错： [zed graph](http://zedgraph.org)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T05:32:23.583

看看 ZedGraph：http://zedgraph.org/wiki/index.php?title= [Main_Page](http://zedgraph.org/wiki/index.php?title=Main_Page)

# unit-testing - 硒批评

> ID：99876
> 
> 赞同：16
> 
> 时间：2008-09-19T05:29:11.030
> 
> 标签：unit-testing, selenium, automated-tests, ui-testing

[我只是想从运行 Selenium ( http://selenium.openqa.org](http://selenium.openqa.org) )的人那里得到一些意见。我对 WaTiN 有很多经验，甚至为它写了一个录音套件。我让它生成了一些结构良好的代码，但只由我维护，我的公司似乎几乎放弃了它。

如果你运行过 selenium，你是否取得了很大的成功？

我将使用 .NET 3.5，Selenium 可以很好地使用它吗？

生成的代码是干净的还是只是所有交互的列表？（[http://blogs.conchango.com/richardgriffin/archive/2006/11/14/Testing-Design-Pattern-for-using-WATiR_2F00_N.aspx](http://blogs.conchango.com/richardgriffin/archive/2006/11/14/Testing-Design-Pattern-for-using-WATiR_2F00_N.aspx)）

分布式测试套件的公平性如何？

对系统的任何其他抱怨或赞美将不胜感激！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-19T05:53:30.800

如果您使用[Selenium IDE](http://selenium-ide.openqa.org/)生成代码，那么您只需获取 selenium 将执行的每个操作的列表。对我来说，Selenium IDE 是开始或进行快速“试看”测试的好方法。但是，当您考虑可维护性和更具可读性的代码时，您必须编写自己的代码。

实现良好 selenium 代码的一个好方法是使用[页面对象模式](http://code.google.com/p/webdriver/wiki/PageObjects)，以使代码代表您的导航流。这是我在[Coding Dojo Floripa](http://dojofloripa.wordpress.com/2008/04/20/como-usar-tdd-e-page-objects-para-construir-interfaces-web/)（来自巴西）中看到的一个很好的例子：

```
public class GoogleTest {

    private Selenium selenium;

    @Before
    public void setUp() throws Exception {
            selenium = new DefaultSelenium("localhost", 4444, "*firefox",
                            "http://www.google.com/webhp?hl=en");
            selenium.start();
    }

    @Test
    public void codingDojoShouldBeInFirstPageOfResults() {
            GoogleHomePage home = new GoogleHomePage(selenium);
            GoogleSearchResults searchResults = home.searchFor("coding dojo");
            String firstEntry = searchResults.getResult(0);
            assertEquals("Coding Dojo Wiki: FrontPage", firstEntry);
    }

    @After
    public void tearDown() throws Exception {
            selenium.stop();
    }

}

public class GoogleHomePage {

    private final Selenium selenium;

    public GoogleHomePage(Selenium selenium) {
            this.selenium = selenium;
            this.selenium.open("http://www.google.com/webhp?hl=en");
            if (!"Google".equals(selenium.getTitle())) {
                    throw new IllegalStateException("Not the Google Home Page");
            }
    }

    public GoogleSearchResults searchFor(String string) {
            selenium.type("q", string);
            selenium.click("btnG");
            selenium.waitForPageToLoad("5000");
            return new GoogleSearchResults(string, selenium);
    }
}

public class GoogleSearchResults {

    private final Selenium selenium;

    public GoogleSearchResults(String string, Selenium selenium) {
            this.selenium = selenium;
            if (!(string + " - Google Search").equals(selenium.getTitle())) {
                    throw new IllegalStateException(
                                    "This is not the Google Results Page");
            }
    }

    public String getResult(int i) {
            String nameXPath = "xpath=id('res')/div[1]/div[" + (i + 1) + "]/h2/a";
            return selenium.getText(nameXPath);
    }
} 
```

希望有帮助

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-19T17:35:44.207

我正在使用 Selenium Remote Control 来测试 ASP.Net 应用程序（这也是我假设您也将瞄准的目标），并且效果很好。

如果您从未使用过 Selenium，请观看一些有关使用 Selenium IDE的[截屏视频。](http://wiki.openqa.org/download/attachments/400/Selenium+IDE.swf?version=1)这将使您对“Selenium”的工作原理有一个很好的了解。IDE 是一个 firefox 插件，基本上可以让您开发快速的录制和播放测试。不过，对于较大的测试套件或编写真正可维护的测试，我建议使用 Selenium Remote Control。（如果您刚刚开始，IDE 非常棒。）

[Selenium Remote Control](http://selenium-rc.openqa.org/)允许您使用自己喜欢的语言和单元测试框架来驱动 Web 浏览器以执行您的测试。如果您最熟悉 C#/NUnit，您可以用这种方式编写测试并使用您喜欢的所有 NUnit 好东西。（例如，Test-Driven.net 插件）。此外，由于您的测试是用高级语言编写的，因此您可以执行诸如从特定测试类继承之类的事情，您可以使用它来使您的实际测试方法代码更加简洁。（或者至少这就是我编写测试的方式。它让我可以测试复杂的场景，使我的测试方法的行数保持在合理的数量。）

你提到分布式测试。不幸的是，我还没有找到将[Selenium Grid](http://selenium-grid.openqa.org/)项目与 NUnit 一起使用的方法。Selenium Grid 允许您在许多不同的机器和浏览器实例上执行您的测试套件。因此，您可以将负载分散到一台机器或多台机器上的四个 Grid 实例上（即一次在四个不同的浏览器实例中运行），而不是一个接一个地运行 200 种测试方法（即串行）关于你想要得到的分布。

但是，如果您使用 Java 或 PHP 编写测试，您可能会有更好的运气。我希望随着 NUnit2.5 的发布通过 NUnit 可以使用它，其中将包括用于并行测试的 pNUnit。

如果您对 selenium 有任何其他问题，请澄清您最初的问题，我很乐意为您提供帮助。（Selenium 只是我每天使用的工具之一，所以我喜欢帮助新人开始使用它......）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-26T19:46:28.817

我从 Selenium IDE 和 Selenium Core 开始。这些绝对是让您入门的好工具。但它们不是很强大，因为您只能使用 Selenese，Selenium 的基于 HTML 的逐个命令语言。

现在我将 Selenium Remote Control 与 Ruby 驱动程序一起使用，它允许我利用 Ruby 提供的功能。我测试了许多环境：Windows 2000、XP、Vista、Mac 10.4/10.5，对于每个适用的环境，Safari 2/3、Firefox 2/3、Internet Explorer 6/7。

Selenium 声称与所有这些操作系统和浏览器兼容，尽管我目前在使用 Internet Explorer 时遇到了问题（实际上，我在 StackOverflow 上的第一个问题是关于这个的）。但我不知道有任何其他工具如此强大且适用于如此多的平台。

Selenium 遇到的最大问题是 DOM 解析。JavaScript 的 childNodes 不可靠，因为 Safari/Firefox 会忽略空格和注释节点，而 Internet Explorer 则不会。Internet Explorer 中的 XPath 比 SF/FF 慢 10-20 倍。innerHTML 在 IE 中并不总是可靠的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T08:45:58.200

Selenium 是相当不错的工具，但有几点需要注意：

*   Selenium IDE 和 Selenium 核心不共享 100% 相同的功能。例如，IDE 支持右键单击，但当前的核心版本没有。但是，使用他们存储库中的更新版本可以解决这个问题。

*   如果是 ext js、gwt 等，请确保您的显示元素具有正确的 ID，而不是自动生成（随机）的 ID。

*   维护测试用例。我见过在 Selenium 测试和良好覆盖率上投入大量精力的案例。后来测试开始失败，因为创建它们的人正忙于其他任务而没有其他人想碰它们。但这是管理问题，而不是 Selenium。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-22T22:21:22.357

我是 Selenium 的忠实粉丝。不过，提前了解的一个主要问题是 Selenium IDE 在弹出窗口方面存在很多问题。这些问题不会在 Selenium RC 中持续存在，但它会让开发变得有点头疼。

# windows - 生成唯一的机器 ID

> ID：99880
> 
> 赞同：107
> 
> 时间：2008-09-19T05:30:03.603
> 
> 标签：windows, winapi, wmi, uniqueidentifier

我需要编写一个函数来生成一个对于运行 Windows 操作系统的给定机器唯一的 id。

目前，我正在使用 WMI 查询各种硬件参数并将它们连接在一起并散列它们以派生唯一 id。我的问题是，我应该使用哪些建议参数？目前，我正在使用 bios\cpu\disk 数据的组合来生成唯一 ID。如果每个指标都有多个结果，我将使用第一个结果。

但是，我遇到了一个问题，即双启动到 2 个不同 Windows 操作系统的机器在每个操作系统上生成不同的站点代码，这在理想情况下不应该发生。

作为参考，这些是我目前使用的指标：

```
Win32_Processor:UniqueID,ProcessorID,Name,Manufacturer,MaxClockSpeed
Win32_BIOS:Manufacturer
Win32_BIOS:SMBIOSBIOSVersion,IdentificationCode,SerialNumber,ReleaseDate,Version
Win32_DiskDrive:Model, Manufacturer, Signature, TotalHeads
Win32_BaseBoard:Model, Manufacturer, Name, SerialNumber
Win32_VideoController:DriverVersion, Name 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-05-04T15:18:52.640

我遇到了同样的问题，经过一番研究后，我决定最好的办法是按照@Agnus 的建议读取`MachineGuid`注册表项。`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography`它是在操作系统安装期间生成的，除非您重新安装操作系统，否则它不会更改。根据操作系统版本，它可能包含嵌入的网络适配器 MAC 地址（加上一些其他数字，包括随机数）或伪随机数，后者适用于较新的操作系统版本（我相信在 XP SP2 之后，但不确定）。如果它是理论上的伪随机，它可以被伪造 - 如果两台机器具有相同的初始状态，包括实时时钟。在实践中，这种情况很少见，但请注意，如果您希望它成为可能被铁杆黑客攻击的安全基础。

当然，任何人也可以轻松更改注册表项以伪造机器 GUID，但我发现这会破坏 Windows 的许多组件的正常运行，在大多数情况下没有普通用户会这样做（再次，当心对于铁杆黑客）。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-03-07T21:46:52.443

使用我们的[许可工具](http://xheo.com/products/copy-protection)，我们考虑以下组件

*   MAC地址
*   CPU（不是序列号，而是实际的 CPU 配置文件，如步进和型号）
*   系统驱动器序列号（不是卷标）
*   记忆
*   CD-ROM 型号和供应商
*   显卡型号和供应商
*   IDE 控制器
*   SCSI 控制器

然而，我们不只是对组件进行哈希处理并创建通过/失败系统，而是创建一个[可比较的指纹](http://xheo.com/docs/dlxl/5/html/developers%20guide/licensing%20basics/hardware%20locking%20and%20the%20activation%20process.html)，可用于确定两个机器配置文件的差异程度。如果差异等级高于指定的容差，则要求用户再次激活。

在过去的 8 年中，我们发现在数十万最终用户安装中使用这种组合可以很好地提供可靠的唯一机器 ID，即使对于虚拟机和克隆的操作系统安装也是如此。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-09-22T13:48:52.980

自己解析[SMBIOS](http://www.dmtf.org/standards/smbios/)并将其散列到任意长度。请参阅[PDF 规范](http://www.dmtf.org/standards/published_documents/DSP0134_2.6.0.pdf)了解所有可用的 SMBIOS 结构。

要从 Windows 查询 SMBIOS 信息，您可以使用[`EnumSystemFirmwareEntries`](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/enumsystemfirmwaretables.asp),[`EnumSystemFirmwareTables`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms724259(v=vs.85).aspx)和[`GetSystemFirmwareTable`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms724379%28v=vs.85%29.aspx).

IIRC，来自 CPUID 指令的“唯一 ID”在 P3 和更新版本中已被弃用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T05:32:30.557

仅使用处理器的 UniqueID 怎么样？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T05:32:01.617

您应该考虑使用网卡上的 MAC 地址（如果存在）。这些通常是独一无二的，但可以伪造。我使用了根据您的网络适配器 MAC 地址生成许可证文件的软件，因此它被认为是区分计算机的一种相当可靠的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T05:36:45.927

我讨厌成为那种说“你做错了”的人（我一直讨厌那个人；）但是......

是否必须为独特的机器重复生成？你可以只分配标识符或做一个公钥/私钥吗？也许如果您可以生成并存储该值，您可以从同一磁盘上的两个操作系统安装中访问它？

您可能已经探索过这些选项，但它们对您不起作用，但如果不是，则需要考虑。

如果这不是用户信任的问题，您可以只使用 MAC 地址。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T11:12:57.627

在我的程序中，我首先检查终端服务器并使用 WTSClientHardwareId。否则本地 PC 的 MAC 地址应该足够了。

如果您真的想使用您提供的属性列表，请忽略`Name`and `DriverVersion`、`Clockspeed`等内容，因为它可能取决于操作系统。尝试在两个操作系统上输出相同的信息，并忽略不同的信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-31T16:04:54.660

对于我的一个应用程序，如果它是非域计算机，我要么使用计算机名称，要么使用域计算机的域计算机帐户 SID。[Mark Russinovich 在这篇博文Machine SID](http://blogs.technet.com/b/markrussinovich/archive/2009/11/03/3291024.aspx)中谈到了这一点：

> SID 重复成为问题的最后一种情况是分布式应用程序使用机器 SID 来唯一标识计算机。没有 Microsoft 软件会这样做，并且以这种方式使用机器 SID 并不能仅仅因为所有 DC 都具有相同的机器 SID 的事实。依赖于唯一计算机身份的软件要么使用计算机名称，要么使用计算机域 SID（域中计算机帐户的 SID）。

您可以通过 LDAP 或`System.DirectoryServices`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-13T08:26:52.427

有一个库可用于获取硬件特定信息：[硬件序列号提取器（CPU、RAM、HDD、BIOS）](http://www.soft.tahionic.com/download-hdd_id/hardware%20id%20programming%20source%20code/index.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T05:35:37.427

为什么不使用网卡的 MAC 地址？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T05:36:16.863

也许有点作弊，但现在机器以太网适配器的 MAC 地址很少在不改变主板的情况下改变。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T05:36:54.053

您可以提取某种制造商序列号或服务标签吗？

我们的商店是戴尔商店，因此我们使用每台机器唯一的服务标签来识别它们。我知道它可以从 BIOS 中查询，至少在 Linux 中是这样，但我不知道如何在 Windows 中临时做到这一点。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-07-03T19:50:25.723

我有一个额外的限制，我使用的是 .net express，所以我不能使用标准的硬件查询机制。所以我决定使用 power shell 来进行查询。完整的代码如下所示：

```
Private Function GetUUID() As String
    Dim GetDiskUUID As String = "get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID"
    Dim X As String = ""
    Dim oProcess As New Process()
    Dim oStartInfo As New ProcessStartInfo("powershell.exe", GetDiskUUID)
    oStartInfo.UseShellExecute = False
    oStartInfo.RedirectStandardInput = True
    oStartInfo.RedirectStandardOutput = True
    oStartInfo.CreateNoWindow = True
    oProcess.StartInfo = oStartInfo
    oProcess.Start()
    oProcess.WaitForExit()
    X = oProcess.StandardOutput.ReadToEnd
    Return X.Trim()
End Function 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-09-19T05:35:14.463

查找 CPUID 以获取一个选项。多 CPU 系统可能存在一些问题。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2013-06-27T11:03:13.670

试试这个，它提供了一个唯一的硬盘 ID：[Port of DiskId32 for Delphi 7-2010](https://code.google.com/p/dvsrc/downloads/detail?name=20120116DiskId32Port_fixed.7z&can=2&q=)。

# odbc - 读取 COBOL DAT 文件

> ID：99897
> 
> 赞同：4
> 
> 时间：2008-09-19T05:33:42.410
> 
> 标签：odbc, cobol

我得到了一组 COBOL DAT、IDX 和 KEY 文件，我需要读取其中的数据并将其导出到 Access、XLS、CSV 等。我不知道 COBOL 代码的版本和供应商，因为我只有拥有创建文件的 Windows 可执行文件。

我已经尝试过 Easysoft 和 Parkway ODBC 驱动程序，但我没有成功从文件中读取数据。

由于分发此产品的公司关闭，我无法访问源代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T06:17:10.650

我刚刚使用[http://www.cobolproducts.com/datafile成功读取了一些 dat 文件，我是通过另一个论坛了解到的。](http://www.cobolproducts.com/datafile)我很可能会与他们合作，帮助我阅读我遇到问题的其余文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T05:45:00.557

几种可能。

1/ 看看你能不能找到为公司工作的人的名字。他们可能会有所帮助。

2/ 在文本编辑器中打开 DAT 文件。数据可以从中解码。如果可以识别基本格式，可以编写快速'n'dirty 代码来提取它。

3/ 在编辑器中打开可执行文件，其中可能有字符串指示使用了哪个编译器，然后您可以搜索其文件格式的信息。如果是 DOS 应用程序，则很有可能是 Microsoft 或 Fujitsu COBOL。

4/ 考虑在 elance 或rentacoder 等工作网站上提出工作请求；如果工作不能成功完成，我认为没有成本。

5/ 雇人检查并就恢复的可能性提出建议。

6/ 获取每个活动记录的记录内容的屏幕转储，并从中重新构建它。

其中一些非常困难，因此您的里程可能会有所不同。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-10T11:31:47.547

我只用 FD 读取了 COBOL DAT 文件，当我没有 FD 时，我在文本编辑器中打开文件，并尝试猜测列，然后再试一次，直到我有这个工作，这种方法的大问题是当 DAT 文件有 COMP 列时，它可以是任何类型的 COMP 类型，但我有点耐心地完成了这项工作。

我曾尝试过百汇 ODBC，但没有成功。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-22T22:23:17.053

对于任何经历过这段旅程的人，我在 sourceforge 中找到了这个：Cobol and RPG data reader and converter

[http://sourceforge.net/projects/cobol2j/](http://sourceforge.net/projects/cobol2j/)

我要试试，听起来很有希望

# opengl - 在 GPU 上计算图像相似度 [OpenGL/OcclusionQuery]

> ID：99906
> 
> 赞同：2
> 
> 时间：2008-09-19T05:36:09.097
> 
> 标签：opengl, shader, pyopengl, occlusion

OpenGL。假设我已经绘制了一张图像，然后使用 XOR 绘制了第二张图像。现在我在某处有非黑色像素的黑色缓冲区，我读到我可以使用着色器来计算 GPU 上的黑色 [ rgb(0,0,0) ] 像素？

我还读到它必须与 OcclusionQuery 做一些事情。 [http://oss.sgi.com/projects/ogl-sample/registry/ARB/occlusion_query.txt](http://oss.sgi.com/projects/ogl-sample/registry/ARB/occlusion_query.txt)

有可能吗？怎么做？[任何编程语言]

如果您对如何通过 OpenGL/GPU 找到相似性有其他想法 - 那也很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T05:49:11.013

我不确定你是如何进行 XOR 位的（至少它应该很慢；我认为当前的任何 GPU 都不会加速），但这是我的想法：

1.  有两个输入图像
2.  打开遮挡查询。
3.  将两个图像绘制到屏幕上（即设置了两个纹理的全屏四边形），使用计算 abs(texel1-texel2) 的片段着色器，*如果*像素*相同*（差异为零或低于某个阈值）。最简单的可能只是使用 GLSL 片段着色器，然后您只需读取两个纹理，计算差异的 abs() 并丢弃像素。非常基本的 GLSL 知识在这里就足够了。
4.  获取通过查询的像素数。对于相同的像素，查询不会通过（像素将被着色器丢弃），对于不同的像素，查询将通过。

起初我想到了一种涉及深度缓冲区的更复杂的方法，但后来意识到仅仅杀死像素就足够了。这是我的原创（但上面的更简单，更有效）：

1.  有两个输入图像
2.  清除屏幕和深度缓冲区
3.  将两个图像绘制到屏幕上（即设置了两个纹理的全屏四边形），使用计算 abs(texel1-texel2) 的片段着色器，如果像素不同，则杀死像素（在 GLSL 中*丢弃）。*绘制四边形，使其深度缓冲区值接近平面。
4.  在这一步之后，深度缓冲区将包含相同像素的小深度值和不同像素的大（远平面）深度值。
5.  打开遮挡查询，并绘制另一个深度比远平面更近但比前一个四边形大的全屏四边形。
6.  获取通过查询的像素数。对于相同的像素，查询不会通过（深度缓冲区已经更近了），对于不同的像素，查询将通过。您将使用 SAMPLES_PASSED_ARB 来获取此信息。[CodeSampler.com](http://www.codesampler.com/oglsrc/oglsrc_7.htm)上有一个遮挡查询示例可以帮助您入门。

当然，所有这些都需要具有遮挡查询支持的 GPU。自 2002 年左右以来，大多数 GPU 都支持这一点，但一些低端 GPU 除外（特别是 Intel 915（又名 GMA 900）和 Intel 945（又名 GMA 950））。

# c++ - 多线程应用中的最小延迟对象池技术

> ID：99907
> 
> 赞同：1
> 
> 时间：2008-09-19T05:36:10.953
> 
> 标签：c++, multithreading

1.  在应用程序中，我们有大约 30 种重复创建的对象。
2.  其中一些寿命长（小时），一些寿命短（毫秒）。
3.  对象可以在一个线程中创建并在另一个线程中销毁。

在最小的创建/销毁延迟、低锁争用和合理的内存利用率的意义上，有没有人知道什么是好的池化技术？

附加 1。

1.1。一种类型的对象池/内存分配通常与另一种类型无关（见 1.3 例外）

1.2\. 一次只为一种类型（类）执行内存分配，通常一次为几个对象。

1.3\. 如果一种类型使用指针聚合另一种类型（出于某种原因），这些类型一起分配在一块连续的内存中。

附加 2。

2.1。众所周知，使用对每种类型进行访问序列化的集合比 new/delete 更糟糕。

2.2\. 应用程序用于不同的平台/编译器，不能使用编译器/平台特定的技巧。

附加 3。

很明显，最快（具有最低延迟）的实现应该将对象池组织为星型工厂网络。中央工厂对于其他线程特定的工厂来说是全局的。常规对象提供/回收在特定于线程的工厂中更有效，而中央工厂可用于线程之间的对象平衡。

3.1。在中央工厂和线程特定工厂之间组织通信的最有效方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T06:22:52.150

我假设您在完成所有创建并验证创建/销毁实际上导致问题后已经配置并测量了您的代码。否则这是你应该首先做的。

如果您仍然想进行对象池，作为第一步，您应该确保您的对象是无状态的，因为这是重用对象的先决条件。同样，您应该确保对象的成员和对象本身在从创建它的线程之外的不同线程中使用时没有问题。（COM STA 对象/窗口句柄等）

如果您使用 Windows 和 COM，使用系统提供的池的一种方法是编写自由线程对象并启用对象池，这将使 COM+ 运行时（以前称为 MTS）为您执行此操作。如果您使用 Java 之类的其他平台，也许您可​​以使用定义对象应实现的接口的应用程序服务器，并且 COM+ 服务器可以为您进行池化。

或者你可以推出你自己的代码。但是您应该尝试查找是否有这种模式，如果有，请使用它而不是下面的内容

如果您需要滚动自己的代码，请创建一个可动态增长的集合，以跟踪已创建的对象。最好为集合使用向量，因为您只会添加到集合中，并且很容易遍历它以搜索自由对象。（假设您不删除池中的对象）。根据您的删除策略更改集合类型（如果您使用 C++，则指向对象的指针/引用向量，以便在同一位置删除并重新创建对象）

每个对象都应该使用一个可以以易失性方式读取的标志进行跟踪，并使用互锁功能进行更改以将其标记为已使用/未使用。

如果使用了所有对象，则需要创建一个新对象并将其添加到集合中。在添加之前，您可以获取锁（临界区），将新对象标记为正在使用并退出锁。

测量并继续 - 如果您将上述集合实现为一个类，您可以轻松地为不同的对象类型创建不同的集合，以减少来自执行不同工作的线程的锁争用。

最后，您可以实现一个重载的类工厂接口，该接口可以创建各种池对象并知道哪个集合包含哪个类

然后，您可以从那里优化此设计。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T06:06:02.800

为了最大限度地减少构造/销毁延迟，您需要手头有完全构造的对象，因此您将消除 new/ctor/dtor/delete 时间。这些“免费”对象可以保存在列表中，因此您只需在最后弹出/推送元素。

您可以一个一个地锁定对象池（每种类型一个）。它比系统范围的锁更有效，但没有按对象锁定的开销。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T05:57:31.277

如果你还没有看过 tcmalloc，你可能想看看。基于其概念的实现可能是一个好的开始。关键点：

*   确定一组尺寸等级。（每个分配都将通过使用来自相同或更大分配的条目来完成。）
*   每页使用一个尺寸等级。（页面中的所有实例大小相同。）
*   使用每个线程的空闲列表来避免每个 alloc/dealloc 上的原子操作
*   当每个线程的空闲列表太大时，将一些实例移回中央空闲列表。尝试从同一页面移回分配。
*   当每个线程的空闲列表为空时，从中央空闲列表中取出一些。尝试采取连续的条目。
*   **重要提示：**您可能知道这一点，但请确保您的设计将虚假共享降至最低。

tcmalloc 不能做的其他事情：

*   尝试通过使用更细粒度的分配池来启用参考位置。例如，如果要一起访问几千个对象，那么它们最好在内存中靠得很近。（为了最大程度地减少缓存丢失和 TLB 故障。）如果您从它们自己的线程缓存中分配这些实例，那么它们应该具有相当好的局部性。

*   如果您事先知道哪些实例将是长期存在的，哪些不会，则从单独的线程缓存中分配它们。如果您不知道，则使用线程缓存定期复制旧实例进行分配，并更新对新实例的旧引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T16:21:55.447

Why do you have multiple threads destroying objects they did not create? It's a simple way to handle object lifetime, but the costs can vary widely depending on use.

Anyways, if you haven't started implementing this yet, at the very least you can put the create/destroy functionality behind an interface so that you can test/change/optimize this at a later date when you have more information about what your system actually does.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T08:36:15.700

你试过[囤积分配器](http://www.hoard.org/)吗？它提供了比许多系统上的默认分配器更好的性能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T07:16:47.980

如果您对池的首选大小有一些猜测，您可以使用数组使用堆栈结构创建固定大小的池（最快的解决方案）。然后需要实现对象生命周期硬初始化（和内存分配）、软初始化、软清理和硬清理（和内存释放）四个阶段。现在在伪代码中：

```
Object* ObjectPool::AcquireObject()
{
    Object* object = 0;
    lock( _stackLock );
    if( _stackIndex )
       object = _stack[ --_stackIndex ];
    unlock( _stackLock );
    if( !object )
       object = HardInit();
    SoftInit( object );
}

void ObjectPool::ReleaseObject(Object* object)
{
     SoftCleanup( object );
    lock( _stackLock );
    if( _stackIndex < _maxSize )
    {
       object = _stack[ _stackIndex++ ];
       unlock( _stackLock );
    }
    else
    {
       unlock( _stack );
       HardCleanup( object );
    }
} 
```

HardInit/HardCleanup 方法执行完整的对象初始化和销毁​​，并且它们仅在池为空或释放的对象因池已满而无法放入池时执行。SoftIniti 执行对象的软初始化，它仅初始化对象的那些自发布以来可以更改的方面。SoftCleanup 方法释放对象使用的资源，这些资源应该尽快释放，或者在其所有者驻留在池中期间可能变得无效的资源。如您所见，锁定是最少的，只有两行代码（或只有几条指令）。

这四种方法可以在单独的（模板）类中实现，因此您可以根据对象类型或用途实现微调操作。您也可以考虑使用智能指针在不再需要对象时将其自动返回到其池中。

# vb.net - VB.Net“存在命名冲突”错误，用于创建用户的打开 ldap

> ID：99912
> 
> 赞同：1
> 
> 时间：2008-09-19T05:36:42.340
> 
> 标签：vb.net, ldap

我正在尝试使用目录服务将目录条目添加到 openldap 服务器。我看到的示例看起来很简单，但我不断收到错误“存在命名冲突”。这条消息是什么意思？我该如何解决？

我已经包含了用于创建人员容器的代码 ldif 文件。

```
Public Function Ldap_Store_Manual_Registration(ByVal userName As String, ByVal firstMiddleName As String, ByVal lastName As String, ByVal password As String)

   Dim entry As DirectoryEntry = OpenLDAPconnection()  'OpenLDAPconnection() is DirectoryEntry(domainName, userId, password, AuthenticationTypes.SecureSocketsLayer) )

   Dim newUser As DirectoryEntry

   newUser = entry.Children.Add("ou=alumni", "organizationalUnit") 'also try with newUser = entry.Children.Add("ou=alumni,o=xxxx", "organizationalUnit") , also not working

   SetADProperty(newUser, "objectClass", "organizationalPerson") 
   SetADProperty(newUser, "objectClass", "person") 
   SetADProperty(newUser, "cn", userName)
   SetADProperty(newUser, "sn", userName)

   newUser.CommitChanges()
End Function

Public Shared Sub SetADProperty(ByVal de As DirectoryEntry, _
    ByVal pName As String, ByVal pValue As String)

    'First make sure the property value isnt "nothing"

    If Not pValue Is Nothing Then

        'Check to see if the DirectoryEntry contains this property already
        If de.Properties.Contains(pName) Then 'The DE contains this property

            'Update the properties value
            de.Properties(pName)(0) = pValue

        Else    'Property doesnt exist

            'Add the property and set it's value
            de.Properties(pName).Add(pValue)

        End If

    End If

End Sub 
```

ldif 文件：

```
version: 1

dn: cn=test3,ou=alumni,o=unimelb

objectClass: organizationalPerson

objectClass: person

objectClass: top

cn: test3

sn: test3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T19:47:32.300

也许你需要包括这个？

```
SetADProperty(newUser, "objectClass", "top") 
```

此外，请检查必填字段的内容`organizationalPerson`......`person`您可能缺少一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-28T18:31:34.737

尝试：

```
Dim entry As New DirectoryEntry("LDAP://ou=alumni", etc.)
newUser = entry.Children.Add("cn=" + userName, "user") 
```

# .net - 如何在不丢失 PostBack 功能的情况下将自己的 JavaScript 链接到客户端

> ID：99917
> 
> 赞同：0
> 
> 时间：2008-09-19T05:38:01.523
> 
> 标签：.net, asp.net, javascript, webforms, postback

所以我在 Scott Hanselman 的博客上阅读了这些 Asp.Net[面试问题](http://www.hanselman.com/blog/ASPNETInterviewQuestions.aspx)，我遇到了这个问题。任何人都可以阐明他在说什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T08:53:11.383

```
<asp:LinkButton ID="lbEdit" CssClass="button" 
    OnClientClick="javascript:alert('do something')" 
    onclick="OnEdit"  runat="server">Edit</asp:LinkButton> 
```

该`OnClientClick`属性意味着您可以在不丢失 PostBack 功能的情况下添加一些 JavaScript，这将是我在采访中的回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T18:58:03.673

> 解释 PostBacks 的工作原理

回发是 Web 协议之上的抽象，它在无状态协议上模拟有状态行为。

> , 在客户端

在客户端，回发是通过 javascript 调用和隐藏字段来实现的，这些隐藏字段存储页面上所有控件的状态。

> 和服务器端。

服务器端经历事件的生命周期，该生命周期的一部分是视图状态的水合以维持页面上所有控件的状态，以及基于传递给 __doPostBack 调用的参数引发事件在客户端

> 如何在不丢失 PostBack 功能的情况下将自己的 JavaScript 链接到客户端？

取决于需要什么。在 99% 的情况下工作的最简单方法是使用 asp:hiddenfield 在客户端和服务器端之间进行通信。对于边缘情况，您希望进入 Exenders 并通过 MS ajax API 在 javascript 中操作 viewstate/controlstate/clientstate。这对于巨大的学习曲线和很多陷阱来说非常痛苦，通常使用隐藏字段并手动调用 __doPostBack 就足够了

* * *

我就是这样回答那个要点的。有关 __doPostBack 的更多信息，快速 google 会给你很多结果（对于懒惰的人，这是第一次点击[http://aspalliance.com/895](http://aspalliance.com/895)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:12:20.017

Do you mean something like this:

in your code behind:

```
protected string GetPostBack()
{
    return ClientScript.GetPostBackEventReference(this, null);
} 
```

and in your aspx:

```
<a href="javascript:<%=GetPostBack() %>">Click here to postback</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T06:48:18.983

我认为他在这里问的是如何连接 javascript 函数以与 ASP.NET 回发功能协同工作。

ie 如何使用我自己的 JavaScript 触发控件的事件？

ASP.NET 类库包含一个`ClientScript`类 - 在`System.Web.UI.Page`类中找到 - 它使您能够以编程方式将 JavaScript 添加到您的 ASP.NET 页面。

这包含一个调用的方法`GetPostBackEventReference`，该方法将生成`__doPostBack`ASP.NET 用来触发连接到 Web 控件的事件的脚本。

希望这是有道理的

# javascript - OO Javascript：变量范围的明确解释

> ID：99927
> 
> 赞同：19
> 
> 时间：2008-09-19T05:40:28.413
> 
> 标签：javascript, oop

有人可以解释 JS 中的变量范围，因为它适用于对象、函数和闭包吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-19T10:57:50.103

### 全局变量

Javascript 中的每个变量都是对象的命名属性。例如：-

```
var x = 1; 
```

x 被添加到全局对象中。全局对象由脚本上下文提供，并且可能已经具有一组属性。例如，在浏览器中，全局对象是 window。与浏览器中的上述行等效的是：-

```
window.x = 1; 
```

### 局部变量

现在，如果我们将其更改为：-

```
function fn()
{
    var x = 1;
} 
```

何时`fn`创建一个新对象，称为*执行上下文*，也称为*范围*（我可以互换使用这些术语）。 `x`作为属性添加到此范围对象。因此，每次调用都`fn`将获得它自己的范围对象实例，因此它自己的 x 属性实例附加到该范围对象。

### 关闭

现在让我们更进一步：-

```
function fnSequence()
{
    var x = 1;
    return function() { return x++; }
}

var fn1 = fnSequence();
var fn2 = fnSequence();

WScript.Echo(fn1())
WScript.Echo(fn2())
WScript.Echo(fn1())
WScript.Echo(fn2())
WScript.Echo(fn1())
WScript.Echo(fn1())
WScript.Echo(fn2())
WScript.Echo(fn2()) 
```

**注意：**替换`WScript.Echo`为在您的上下文中写入标准输出的任何内容。

你应该得到的序列是： -

1 1 2 2 3 4 3 4

那么这里发生了什么？我们`fnSequence`将一个变量初始化`x`为 1 并返回一个匿名函数，该函数将返回值`x`然后递增它。

当这个函数第一次被执行时，一个作用域对象被创建并且一个属性`x`被添加到这个作用域对象中，值为 1。同样在同一个执行对象中创建了一个匿名函数。每个函数对象都有一个作用域属性，它指向创建它的执行上下文。这创建了我们将在稍后讨论的*范围链。*对此函数的引用由返回`fnSequence`并存储在`fn1`.

请注意，`fn1`现在指向匿名函数，并且匿名函数有一个作用域属性，该属性指向一个作用域对象，该作用域对象仍然`x`附加了一个属性。这被称为`closure`执行上下文的内容在为其创建的函数完成执行后仍然可以访问的地方。

现在，分配给 时会发生相同的序列`fn2`。 `fn2`将指向另一个匿名函数，该函数是在`fnSequence`第二次调用时创建的不同执行上下文中创建的。

### 范围链

持有的函数`fn1`第一次执行时会发生什么？为执行匿名函数创建一个新的执行上下文。从标识符中可以找到返回值`x`。检查函数的作用域对象的`x`属性，但没有找到。这就是*作用域链*出现的地方。在当前执行上下文中找不到`x`JavaScript 会获取函数的作用域属性持有的对象并在`x`那里查找。它找到它，因为函数作用域是在 的执行中创建的`fnSequence`，检索它的值并递增它。因此输出 1，并且`x`在这个范围内的 增加为 2。

现在当`fn2`被执行时，它最终会附加到一个不同的执行上下文，其`x`属性仍然是 1。因此执行`fn2`也会导致 1。

如您所见`fn1`，`fn2`每个都生成自己独立的数字序列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T05:49:17.347

未使用 var 声明的变量在范围内是全局的。函数引入范围，但请注意 if 块和其他块不引入范围。

通过谷歌搜索 Javascript 范围，我还可以看到很多关于此的信息。这真的是我推荐的。 [http://www.digital-web.com/articles/scope_in_javascript/](http://www.digital-web.com/articles/scope_in_javascript/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T11:11:31.223

函数引入范围。您可以在其他函数中声明函数，从而创建嵌套范围。内部范围可以访问外部范围，但外部不能访问内部范围。

Variables are bound to a scope, using the **var** keyword. All variables are implicitly bound to the top-level scope. So if you omit the var keyword, you are implicitly referring to a variable bound to the top level. In a browser, the top level is the **window** object. Note that **window** is it self a variable, so **window** == **window.window**

# file-format - 适用于 Windows Vista 的通用二进制数据查看器

> ID：99934
> 
> 赞同：2
> 
> 时间：2008-09-19T05:43:53.447
> 
> 标签：file-format, devtools, hex-editors

我正在寻找适用于 32 位 Windows Vista 的好程序的建议，该程序将加载任意二进制文件并显示与识别位应该代表的实际数据相关的文本信息或图形可视化。对于这种事情，还有什么比[十六进制编辑器更好的吗？](https://stackoverflow.com/questions/10426/what-is-a-good-windows-hex-editor-viewer#10431)

我想做的一件事是，查看[Spore](http://www.spore.com) PNG 文件中的不可见数据，以了解其中实际存储的内容。现在我正在使用写字板，我得到的只是这样的东西：

> ‰PNG
> 
> IHDR ¢
> 
> /Qã!$D4"Ž‚îvÚ°‰ÅØÃ ïjÃÞÉ_{!…‡ú 9¥Ý´îÁ6 ‰ms ^

我想我正在寻找的是一个增强的十六进制编辑器，它更像是一个 Excel 用于位，因此我可以对统计模式进行切片和切块，以更好地了解位可能在做什么。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-19T05:50:18.377

尝试[HxD](http://mh-nexus.de/en/hxd/)：

> HxD 是一个精心设计的快速十六进制编辑器，除了原始磁盘编辑和主存储器 (RAM) 修改之外，它还可以处理任何大小的文件。
> 
> 易于使用的界面提供搜索和替换、导出、校验和/摘要、字节模式插入、文件粉碎机、文件连接或拆分、统计等功能。

![替代文字](https://mh-nexus.de/en/graphics/MiniShotHxD.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-19T06:09:56.143

我喜欢[xvi32](http://www.chmaas.handshake.de/delphi/freeware/xvi32/xvi32.htm)，虽然它看起来与上面类似 - 我发现它即使对于大文件也相当快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T05:46:54.360

您可能想要的是一个十六进制编辑器。[PSPad](http://www.pspad.com/)文本编辑器有一个非常好的十六进制编辑模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T05:48:29.300

我使用[HHD 的免费 HexEditor](http://www.hhdsoftware.com/Family/hex-editor.html)，它是免费的！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T05:47:39.113

我使用 frhed 和 vim（将其转换为十六进制模式，但对于大文件可能会很慢）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T05:48:01.127

您是指检测一组已知文件格式并知道如何显示它们的东西吗？否则，十六进制编辑器（例如[PSPad](http://www.pspad.com/)包含一个）是您想要的最好的东西。它只是可能意味着任何东西的位。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T09:01:28.417

我使用[Total Commander 的](http://www.ghisler.com)内置 Lister（文件查看器）。它可以将数据显示为文本、十六进制，也可以显示图像。然后有许多插件，范围从代码编辑器/查看器、图像查看器等。

我使用的插件是

*   想象查看图像
*   fileinfo 用于显示可执行文件的信息
*   HTML 查看器
*   Syn2 - 带有语法高亮的代码查看器/编辑器

作者的网页上列出了很多插件，另一个很好的来源是[www.totalcmd.net](http://www.totalcmd.net)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T14:15:05.840

我以前使用过[Hex Workshop](http://www.hexworkshop.com/)，它在工具菜单中有一个“查找字符串”选项。不是免费的，但效果很好。

# soa - 您使用什么工具来实现 SOA/消息传递？

> ID：99980
> 
> 赞同：1
> 
> 时间：2008-09-19T06:01:57.990
> 
> 标签：soa, nservicebus, masstransit

[NServiceBus](http://www.nservicebus.com/)和[MassTransit](http://code.google.com/p/masstransit/)是两个可用于实现与 MSMQ 和其他消息队列的消息传递的工具。

我发现一旦您开始使用消息传递来让应用程序相互通信，您并不想回到旧的 RPC 样式。

我的问题是，还有哪些其他工具？你用什么工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-29T10:13:36.830

[Apache ActiveMQ](http://activemq.apache.org/)可能是目前最流行和最强大的开源消息代理，背后有最活跃的开源社区以及[商业支持、培训和工具（如果您需要的话](http://open.iona.com/products/enterprise-activemq/)）。

ActiveMQ 更有趣的方面之一是它对[大量不同的语言绑定和传输协议的广泛支持](http://activemq.apache.org/cross-language-clients.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T15:51:20.930

WebSphere Message Broker 是运行在 MQ 之上的 IBM 旗舰 ESB。

他们还生产 WebSphere ESB，这是一个稍微轻一些的产品，专门用于跨 Web 服务的 ESB。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-17T12:25:11.800

我们将 WCF 服务用于基于消息的同步操作，将 nServiceBus 用于任何异步操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T07:03:50.693

Rogue Wave 非常受欢迎 [ [http://roguewave.com/products/hydra/](http://roguewave.com/products/hydra/) ]

IBM 的 Websphere 产品也是如此 [ [http://en.wikipedia.org/wiki/Mqseries](http://en.wikipedia.org/wiki/Mqseries) ]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T15:58:08.763

WCF 非常强大，任何在.NET 领域启动基于消息的系统的人都应该研究一下。

我建议不要使用 BizTalk，除非您可以充分利用它的适配器（即您有很多旧系统要与之通信）。

Nuedesic 制作了一个很棒的基于 WCF 的 ESB，Neuron，如果你愿意花一点钱的话。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-06T17:52:07.037

我使用 IBM 软件堆栈，因为它具有最广泛的功能集（发布/订阅、异步、同步）和平台支持（60 多种平台、语言组合）以及 IBM 提供的一组很棒的免费工具

对于操作，我使用线性日志轮换 IBM WebSphere MQ supportpac

对于开发和测试，我喜欢使用 RFHUTIL 生成假的 cobol、java、MS 对象、其他二进制和文本对象以及调用 HTTP Web 服务的 SOAPUI。如果我需要调用基于 MQ 的 Web 服务，我会返回到 RFHUtil。当然是用于管理员的 Websphere MQ Explorer。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-16T13:44:31.043

我们使用的是旧的 WebSphere Message Broker 6.1（现在是 IBM Integration Bus），一旦您熟悉它，它就会快速且可靠。

# security - Self validating binaries?

> ID：99999
> 
> 赞同：8
> 
> 时间：2008-09-19T06:09:01.763
> 
> 标签：security, binary

My question is pretty straightforward: You are an executable file that outputs "Access granted" or "Access denied" and evil persons try to understand your algorithm or patch your innards in order to make you say "Access granted" all the time.

After this introduction, you might be heavily wondering what I am doing. Is he going to crack Diablo3 once it is out? I can pacify your worries, I am not one of those crackers. My goal are crackmes.

Crackmes can be found on - for example - www.crackmes.de. A Crackme is a little executable that (most of the time) contains a little algorithm to verify a serial and output "Access granted" or "Access denied" depending on the serial. The goal is to make this executable output "Access granted" all the time. The methods you are allowed to use might be restricted by the author - no patching, no disassembling - or involve anything you can do with a binary, objdump and a hex editor. Cracking crackmes is one part of the fun, definately, however, as a programmer, I am wondering how you can create crackmes that are difficult.

Basically, I think the crackme consists of two major parts: a certain serial verification and the surrounding code.

Making the serial verification hard to track just using assembly is very possible, for example, I have the idea to take the serial as an input for a simulated microprocessor that must end up in a certain state in order to get the serial accepted. On the other hand, one might grow cheap and learn more about cryptographically strong ways to secure this part. Thus, making this hard enough to make the attacker try to patch the executable should not be tha t hard.

However, the more difficult part is securing the binary. Let us assume a perfectly secure serial verification that cannot be reversed somehow (of course I know it can be reversed, in doubt, you rip parts out of the binary you try to crack and throw random serials at it until it accepts). How can we prevent an attacker from just overriding jumps in the binary in order to make our binary accept anything?

I have been searching on this topic a bit, but most results on binary security, self verifying binaries and such things end up in articles that try to prevent attacks on an operating system using compromised binaries. by signing certain binaries and validate those signatures with the kernel.

My thoughts currently consist of:

*   checking explicit locations in the binary to be jumps.
*   checksumming parts of the binary and compare checksums computed at runtime with those.
*   have positive and negative runtime-checks for your functions in the code. With side-effects on the serial verification. :)

Are you able to think of more ways to annoy a possible attacker longer? (of course, you cannot keep him away forever, somewhen, all checks will be broken, unless you managed to break a checksum-generator by being able to embed the correct checksum for a program in the program itself, hehe)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T06:33:15.107

You're getting into "Anti-reversing techniques". And it's an art basically. Worse is that even if you stomp newbies, there are "anti-anti reversing plugins" for olly and IDA Pro that they can download and bypass much of your countermeasures.

Counter measures include debugger detection by trap Debugger APIs, or detecting 'single stepping'. You can insert code that after detecting a debugger breakin, continues to function, but starts acting up at random times much later in the program. It's really a cat and mouse game and the crackers have a significant upper hand.

Check out... [http://www.openrce.org/reference_library/anti_reversing](http://www.openrce.org/reference_library/anti_reversing) - Some of what's out there.

[http://www.amazon.com/Reversing-Secrets-Engineering-Eldad-Eilam/dp/0764574817/](https://rads.stackoverflow.com/amzn/click/com/0764574817) - This book has a really good anti-reversing info and steps through the techniques. Great place to start if you're getting int reversing in general.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T06:21:17.223

I believe these things are generally more trouble than they're worth.

You spend a lot of effort writing code to protect your binary. The bad guys spend less effort cracking it (they're generally more experienced than you) and then release the crack so everyone can bypass your protection. The only people you'll annoy are those honest ones who are inconvenienced by your protection.

Just view piracy as a cost of business - the incremental cost of pirated software is zero if you ensure all support is done only for paying customers.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T06:26:58.817

There's TPM technology: [tpm on wikipedia](http://en.wikipedia.org/wiki/Trusted_Platform_Module)

It allows you to store the cryptographic check sums of a binary on special chip, which could act as one-way verification.

*Note*: TPM has sort of a bad rap because it could be used for DRM. But to experts in the field, that's sort of unfair, and there's even an [open-TPM](http://domino.research.ibm.com/comm/research_projects.nsf/pages/gsal.TCG.html) group allowing linux users control exactly how their TPM chip is used.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T06:36:28.280

One of the strongest solutions to this problem is [Trusted Computing](http://en.wikipedia.org/wiki/Trusted_Computing). Basically you would encrypt the application and transmit the decryption key to a special chip (the [Trusted Platform Module](http://en.wikipedia.org/wiki/Trusted_Platform_Module)), The chip would only decrypt the application once it has verified that the computer is in a "trusted" state: no memory viewers/editors, no debuggers etc. Basically, you would need special hardware to just be able to view the decrypted program code.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T02:23:44.510

So, you want to write a program that accepts a key at the beginning and stores it in memory, subsequently retrieving it from disc. If it's the correct key, the software works. If it's the wrong key, the software crashes. The goal is that it's hard for pirates to generate a working key, and it's hard to patch the program to work with an unlicensed key.

This can actually be achieved without special hardware. Consider our genetic code. It works based on the physics of this universe. We try to hack it, create drugs, etc., and we fail miserably, usually creating tons of undesirable side-effects, because we haven't yet fully reverse engineered the complex "world" in which the genetic "code" evolved to operate. Basically, if you're running everything on an common processor (a common "world"), which everyone has access to, then it's virtually impossible to write such a secure code, as demonstrated by current software being so easily cracked.

To achieve security in software, you essentially would have to write your own sufficiently complex platform, which others would have to completely and thoroughly reverse engineer in order to modify the behavior of your code without unpredictable side effects. Once your platform is reverse engineered, however, you'd be back to square one.

The catch is, your platform is probably going to run on common hardware, which makes your platform easier to reverse engineer, which in turn makes your code a bit easier to reverse engineer. Of course, that may just mean the bar is raised a bit for the level of complexity required of your platform to be sufficiently difficult to reverse engineer.

What would a sufficiently complex software platform look like? For example, perhaps after every 6 addition operations, the 7th addition returns the result multiplied by PI divided by the square root of the log of the modulus 5 of the difference of the total number of subtract and multiply operations performed since system initialization. The platform would have to keep track of those numbers independently, as would the code itself, in order to decode correct results. So, your code would be written based on knowledge of the complex underlying behavior of a platform you engineered. Yes, it would eat processor cycles, but someone would have to reverse engineer that little surprise behavior and re-engineer it into any new code to have it behave properly. Furthermore, your own code would be difficult to change once written, because it would collapse into irreducible complexity, with each line depending on everything that happened prior. Of course, there would be much more complexity in a sufficiently secure platform, but the point is that someone would have reverse engineer your platform before they could reverse engineer and modify your code, without debilitating side-effects.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T03:20:05.393

Great article on copy protection and protecting the protection [Keeping the Pirates at Bay: Implementing Crack Protection for Spyro: Year of the Dragon](http://www.gamasutra.com/features/20011017/dodd_01.htm)

The most interesting idea mentioned in there that hasn't yet been mentioned is cascading failures - you have checksums that modify a single byte that causes another checksum to fail. Eventually one of the checksums causes the system to crash or do something strange. This makes attempts to pirate your program seem unstable and makes the cause occur a long way from the crash.***