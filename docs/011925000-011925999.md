# StackOverflow 问答 11925000-11925999

# regex - 如何从 Linux 终端使用正则表达式删除文件夹

> ID：11925011
> 
> 赞同：8
> 
> 时间：2012-08-12T19:07:43.940
> 
> 标签：regex, linux, find, rm

假设我有文件夹：

```
img1/
img2/ 
```

如何使用 Linux 终端中的正则表达式删除那些与以 img 开头的所有内容相匹配的文件夹？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-12T19:31:16.203

使用 find 过滤目录

```
$ find . -type d -name "img*" -exec rm -rf {} \; 
```

正如评论中提到的，这是使用 shell glob 而不是正则表达式。如果你想要正则表达式

```
$ find . -type d -regex "\./img.*" -exec rm -rf {} \; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-12T19:11:20.167

你可以使用

```
rm -r img* 
```

这应该删除当前工作目录中以 img 开头的所有文件和目录

编辑：

仅删除当前工作目录中以 img 开头的目录

```
rm -r img*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-07T17:03:44.897

在寻找如何使用正则表达式删除目录中的特定文件的过程中，我偶然发现了这篇文章和 Mahmoud Mustafa 的另一篇文章：http: [//mah.moud.info/delete-files-or-directories-linux](http://mah.moud.info/delete-files-or-directories-linux)

此代码将删除任何内容，包括 0-9 中的四个连续数字，在我的情况下，文件夹的月份和日期范围为 Jan2002 - Jan2014：

```
rm -fr `ls | grep -E [0-9]{4}` 
```

希望能帮助那些四处寻找如何删除单个文件而不是文件夹的人。

# php - 如何使用Wordpress让段落出现在页面的某个区域？

> ID：11925012
> 
> 赞同：0
> 
> 时间：2012-08-12T19:07:54.883
> 
> 标签：php, html, css, wordpress, layout

我目前正在使用自定义的 CSS 布局创建自己的 Wordpress 页面。如何使通过“添加页面”生成的“内容”出现在我的布局或 div 的某个部分？我在 PHP 中使用哪些代码来使我在“添加页面”中键入的段落（或 html 代码）出现在该特定 div 中？

下图将有助于支持我的解释：

![在某个 div 中生成段落](../Images/867901093f798f7f47ea1d2e7d5a4b9f.png)

我希望有人能帮忙。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:17:23.427

如果您在后端用 PHP 编写页面，请使用此代码获取帖子。如果您使用的是页面编辑器，有一种方法可以在您的帖子中启用 PHP（虽然它会损害安全性）：

```
$my_postid = 12;//This is page id or post id
$content_post = get_post($my_postid);
$content = $content_post->post_content;
$content = apply_filters('the_content', $content);
$content = str_replace(']]>', ']]>', $content);
echo $content; 
```

# ruby-on-rails - 导轨，语法错误，意外的“，”

> ID：11925015
> 
> 赞同：1
> 
> 时间：2012-08-12T19:08:32.383
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我的搜索中有几个条件。

```
@events = Event.search(params[:search], 
  :conditions => {:group_size => 1, :days => 1}) 
```

上面的代码工作正常。但是，如果我想用私有方法替换散列，我会收到语法错误

```
syntax error, unexpected ',', expecting tASSOC
    :conditions => {group_size_condition, :days => 1}, 
```

代码如下

```
@events = Event.search(params[:search], 
  :conditions => {group_size_condition, :days => 1})

private

def group_size_condition
  if params[:groupsize] == 'single (1)'
    :group_size => 1
  elsif params[:groupsize] == 'couple (2)'
    :group_size => 2
  elsif params[:groupsize] == 'small group(3-5)'
    :group_size => 3..5
  else
    nil
  end
end 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T19:43:38.283

那将是工作

```
@events = Event.search(params[:search], 
  :conditions => group_size_condition.merge(:days => 1))

private

def group_size_condition
  case params[:groupsize]
  when 'single (1)' then {:group_size => 1}
  when 'couple (2)' then {:group_size => 2}
  when 'small group(3-5)' then {:group_size => 3..5}
  else
    {}
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:11:34.727

我想你错过了 :group_size 键

```
@events = Event.search(params[:search], 
  :conditions => {:group_size => group_size_condition, :days => 1}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T19:15:39.883

我想也许你想实际传递字符串，如：

```
def group_size_condition
  if params[:groupsize] == 'single (1)'
    ':group_size => 1'
  elsif params[:groupsize] == 'couple (2)'
    ':group_size => 2'
  elsif params[:groupsize] == 'small group(3-5)'
    ':group_size => 3..5'
  else
    nil
  end
end 
```

# java - 如何通过在文本字段中输入编号来创建数组，Java小程序

> ID：11925016
> 
> 赞同：0
> 
> 时间：2012-08-12T19:08:32.740
> 
> 标签：java, arrays, applet

我的任务是通过文本字段输入 20 个数字，然后使用 while 循环输出平均值、中位数和总数。我应该能够自己弄清楚while循环，但我无法让文本字段将数字输入到数组中。请帮忙，这是我到目前为止的代码：

```
 import java.applet.Applet;
import java.awt.Graphics;
import java.awt.*;
import java.awt.event.*;

public class whileloopq extends Applet implements ActionListener
{
    Label label;
    TextField input;
    int[] numArray = new int[20];
    int num;

    public void init ()
    {
        Label label = new Label("Enter numbers");
        TextField input = new TextField(5);
        add(label);
        add(input);
        input.addActionListener(this);
    }

    public void actionPerformed (ActionEvent ev)
    {
        int num = Integer.parseInt(input.getText());
        int index = 0;
        numArray[index] = num;
        index++;
        input.setText("");

    }

    public void paint (Graphics graf)
    {
        graf.drawString("Array" + numArray, 25, 85);
    }
} 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:17:48.147

（在假设这是家庭作业的情况下编写的答案。）

您知道如何从字符串中解析整数，正如您使用 所展示的那样`Integer.parseInt`，但是您调用它来将整个 20 个字符解析为一个整数。您需要单独获取每个字符以进行解析。

我建议使用 for 循环和 String#substring 将输入文本子串成几个长度为 1 的字符串。

或者，您可以将输入文本拆分为一个空字符串，然后遍历结果数组（请注意，数组中的第一个字符串将为空），但另一种方法更可能是 Java 新手所期望的，所以你必须在这里使用你的判断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:26:10.103

在`actionPerformed()`你试图从类文件中读取`input.setText("");`

但是`init()`您没有初始化该字段，而是创建并添加到小程序***局部变量***

```
TextField input = new TextField(5); 
```

所以类字段是steal `null`。将其更改为

```
input = new TextField(5); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-27T05:57:12.783

```
import java.awt.*;
public class frame4array extends Frame
{
Checkbox c1[];
TextField t1[];
int i;
frame4array(String p)
{
super(p);
c1=new Checkbox[2];
t1=new TextField[2];
for(i=0;i<2;i++)
{
t1[0]=new TextField();
t1[0].setBounds(200, 50, 150, 30);
t1[1]=new TextField();
t1[1].setBounds(200, 80, 150, 30);
c1[0]=new Checkbox("Singing");
c1[0].setBackground(Color.red);
c1[0].setBounds(430,200,120,40);
c1[1]=new Checkbox("Cricket",true);
}
for(i=0;i<2;i++)
{
add(t1[i]);
add(c1[i]);
}
setFont(new Font("Arial",Font.ITALIC,40));
}
public static void main(String s[])
{
frame4array f1=new frame4array("hello");
f1.setSize(600,500);
f1.setVisible(true);
}

} 
```

# mysql - 无法使用 mysql 命令行插入日期时间

> ID：11925017
> 
> 赞同：2
> 
> 时间：2012-08-12T19:08:35.617
> 
> 标签：mysql

> DATETIME 类型用于同时包含日期和时间部分的值。MySQL 以 'YYYY-MM-DD HH:MM:SS' 格式检索和显示 DATETIME 值。支持的范围是“1000-01-01 00:00:00”到“9999-12-31 23:59:59”。(http://dev.mysql.com/doc/refman/5.5/en/datetime.html)
> 
> ALLOW_INVALID_DATES
> 
> 不要对日期进行全面检查。只检查月份在 1 到 12 的范围内，日期在 1 到 31 的范围内。这对于您在三个不同字段中获取年、月和日并要存储的 Web 应用程序非常方便正是用户插入的内容（没有日期验证）。此模式适用于 DATE 和 DATETIME 列。它不应用始终需要有效日期的 TIMESTAMP 列。(http://dev.mysql.com/doc/refman/5.5/en/datetime.html)

如果我输入

> 显示像'datetime%format'这样的变量；

它说：%y- %m- %d %H: %i: %s

我试图插入 1999-04-26 13:00:00 并说语法错误。

我尝试在声明 DATETIME 后添加到表 *ALLOW_INVALID_DATES*，然后在表创建结束时尝试并出错。

我很困惑...

感谢您的时间

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T19:16:25.080

这对我来说很好：

```
CREATE TABLE abc ( daterow DATETIME);

INSERT INTO abc(daterow) VALUES('1999-04-26 13:00:00'); 
```

# php - PHP：动态或程序化 Catch 块

> ID：11925020
> 
> 赞同：7
> 
> 时间：2012-08-12T19:08:53.633
> 
> 标签：php, exception, dynamic, try-catch

我有一种情况，如果能够有一个在运行时确定异常类型的 catch 块会很好。它会像这样工作：

```
$someClassName = determineExceptionClass();

try {
  $attempt->something();
} catch ($someClassName $e) {
  echo 'Dynamic Exception';
} catch (Exception $e) {
  echo 'Default Exception';
} 
```

这是可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T19:21:23.827

据我所知，这不起作用。您可以使用如下控制语句来模仿该功能：

```
$someClass = 'SomeException';

try
{
    $some->thing();
}
catch (Exception $e)
{
    switch (get_class($e))
    {
        case $someClass:
            echo 'Dynamic exception.';
            break;
        default:
            echo 'Normal exception.';
    }
} 
```

# asp.net-mvc - 如何在 ActionLink 中使用动态变量来调用不同控制器的操作

> ID：11925022
> 
> 赞同：1
> 
> 时间：2012-08-12T19:09:28.137
> 
> 标签：asp.net-mvc

**控制器A的一部分：**

```
public ActionResult Index()
    {
        ViewBag.Message = "ToolScope Testing";

        var Baselines = from b in db.Baselines
                            orderby b.Name
                            select b;
        ViewBag.Baselines = Baselines;

        return View();
    } 
```

**ControllerA 的部分视图**

```
@foreach (var item in @ViewBag.Baselines) 
    { 
        <tr>
            <li> @Html.ActionLink( item.Name, "Details", "BaseLine",new { id = item.BaselineID }, null) </li>
        </tr>
    } 
```

item.Name 引起了问题，但是，如果我使用类似的东西，它就可以工作

```
 <li> @Html.ActionLink( "SomeName", "Details", "BaseLine",new { id = item.BaselineID }, null) </li> 
```

我应该怎么做才能拥有动态名称，即第一个 ActionLink？

PS：我是 MVC 新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:08:11.423

我看到你是 MVC 的新手。好消息，您已经获得了 V(iew) 和 C(ontroller)。现在是掌握 M(odel) 的时候了。在您的示例中，您使用 ViewBag 将知识从控制器传输到您的视图。这是模型的典型职责。因此，您需要在 Models 目录中创建一个新类。它可能看起来像这样：

```
public class MyFirstModel
{
    public IEnumerable<MyCustomType> Baselines { get; set; }

    public MyFirstModel() { }
} 
```

编辑你的控制器

```
public ActionResult Index()
{
    ViewBag.Message = "ToolScope Testing";

    var baselines = from b in db.Baselines
                        orderby b.Name
                        select b;

    var model = new MyFirstModel
    {
        Baselines = baselines
    };

    return View(model);
} 
```

然后，将其添加到视图的顶部：

```
@model MvcApplication.Models.MyFirstModel 
```

现在您可以在视图中使用此代码：

```
@foreach (var item in Model.BaseLines) 
{ 
    <tr>
        <li> @Html.ActionLink( item.Name, "Details", "BaseLine",new { id = item.BaselineID }, null) </li>
    </tr>
} 
```

# jquery - 无法居中淡入淡出图像（jQuery）

> ID：11925026
> 
> 赞同：1
> 
> 时间：2012-08-12T19:09:46.910
> 
> 标签：jquery, html, css, positioning, centering

我正在使用此脚本淡出图像并淡入新图像：

```
$(document).ready(function() { 
    $('#picOne').fadeIn(500).delay(2000).fadeOut(1500);
    $('#picTwo').delay(3500).fadeIn(1000);
}); 
```

我希望图像出现在页面的顶部中心，但我不能让图像出现在同一个地方，除非我使用这个 CSS：

```
#picOne, #picTwo {
    position: absolute;
    display: none;
} 
```

如果我将 position:relative 用于#picOne、picTwo，那么我可以将图像居中，但 picTwo 在 picOne 淡入时会出现一秒钟，这会降低我的其余内容，看起来很荒谬。使用 position:absolute 解决了这个问题，但是不可能让它居中。

我认为将两个图像包装在一个 div 中会有所帮助，但它似乎没有什么区别：

```
<div id="pics">
<%= image_tag 'egg.png', :id => 'picOne' %> <%= image_tag 'egg2.png', :id => 'picTwo'  %>​
</div>

#pics {
        position:relative;
        display: block;
        margin-left: auto;
        margin-right: auto;
    } 
```

有什么想法吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:12:17.017

你可以试试：

```
$(document).ready(function() { 
    $('#picOne').fadeIn(500).delay(2000).fadeOut(1500, function() {
        $('#picTwo').fadeIn(1000);
    });
}); 
```

这将`fadeIn()`在`#picTwo`之后`#picOne`淡出。因此，它们将保留在同一个空间中。但是在您的代码中似乎两个图像同时出现，因此与空间发生冲突。

要在中心对齐图像，您可以使用 CSS `text-align:center`。**[看这里。](http://jsfiddle.net/UtyJR/5/)**

# android - Android：在活动中 onStart()、onStop()、onDestroy() 的开头或结尾调用 super()？

> ID：11925028
> 
> 赞同：21
> 
> 时间：2012-08-12T19:09:53.590
> 
> 标签：android, methods, base-class

我在哪里调用活动`onStart()`，，？`onStop()``onDestroy()``super.onStart()``super.onStop()``super.onDestroy()`

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-12T19:11:51.257

这就是我调用这些超级方法的方式：

*   `OnCreate()`: 肯定是第一。
*   `OnDestroy()`： 最后一件事。
*   `OnStop()`： 最后一件事。

但是，对于最后两个，无论您在哪里称呼它们（在大多数情况下）。所以有些人更喜欢把它们放在第一位以保持一致。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-12T19:23:19.483

我会在开始时调用 super，我可能会在我完成派生的工作之前让基类完成它的工作，就像 Java 中的规则一样

# ruby-on-rails - 在 Rails link_to 中转义双引号

> ID：11925031
> 
> 赞同：1
> 
> 时间：2012-08-12T19:10:03.727
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

一般来说，我是 Rails 框架和 Ruby 语言的新手，但我确实有一些编程和 MVC 经验。我正在尝试使用 rails 的 link_to 方法输出链接。然而，在 HTML 中，此链接位于另一组双引号内。我需要转义标签中由 rails 产生的引号。

我试过谷歌，只找到了没有帮助的 javascript 转义信息。我尝试使用几次提到的 ah(%[]) 方法，但随后没有创建链接，并且输出了实际的单词 link_to。

有谁知道如何转义由 rails 创建的超链接标签中的双引号或将其切换为使用单引号？

实际代码

```
<% @properties = Property.all 
                            @properties.each do |property| %>
                            <img src="images/img<%= property.id %>.jpg" alt="" title="<strong><%= property.address %></strong><span>9 rooms, 3 baths, 6 beds, building size: 5000 sq. ft. &nbsp; &nbsp; &nbsp; Price: $ 600 000 &nbsp; &nbsp; &nbsp; <%= link_to "Read More", property) %></span>">
                            <% end %> 
```

输出

```
<img src="images/img1.jpg" alt="" title="<strong>50 Craft LAne</strong><span>9 rooms, 3 baths, 6 beds, building size: 5000 sq. ft. &nbsp; &nbsp; &nbsp; Price: $ 600 000 &nbsp; &nbsp; &nbsp; <a href="/properties/1">Read More</a></span>"> 
```

超链接中的第一个双引号与 title=" 配对，然后一切都关闭

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T20:11:51.080

你可以这样做：

```
<%= link_to("Read More", property).gsub("\"", "'") %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:16:30.850

link_to '“某事”'

不工作？举一个你想要的例子

# google-tv - Anymote 库更新：存储配对连接/配对信息

> ID：11925033
> 
> 赞同：2
> 
> 时间：2012-08-12T19:10:32.917
> 
> 标签：google-tv

@Megha Joshi，

你知道什么时候你会更新anymote库来记住配对连接吗？我整个周末都在努力，但仍然没有任何成功。

另一个对我正在研究的毕业论文至关重要的问题是：可能会发生什么，存储的连接不再起作用。是什么导致连接无效？

谢谢，

塞巴斯蒂安

# android - 壁纸服务和加速度计

> ID：11925039
> 
> 赞同：0
> 
> 时间：2012-08-12T19:11:02.560
> 
> 标签：android, service, sensors, live-wallpaper

在尝试了所有我认为我会尝试看看这里是否有人知道我的问题是什么之后，在我完全放弃之前。所以我想做的是让我的图像在这个“旋转立方体”后面滑动。例如，如果我将手机向右倾斜，它就会开始向右滑动，反之亦然。

这是代码。对于这个问题，它很长并且有很多毫无意义的代码，但我想给它完整的，忽略不重要的部分。它是 sdk 中提供的 CubeWallpaper1 示例。我刚刚对其进行了修改并尝试为其添加加速度计并使其工作。

因此，如果您可以看一下并告诉我它有什么问题。

```
public class LiveWall extends WallpaperService implements SensorEventListener {

    float xAxis,yAxis,zAxis;
    private SensorManager mSensorManager;
    private Sensor mAccelerometer;
    Bitmap drawable;

    private final Handler mHandler = new Handler();

    @Override
    public void onCreate() {
        super.onCreate();
        mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
        mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
        drawable = BitmapFactory.decodeResource(getResources(),R.drawable.bg);
        mSensorManager.registerListener(this, mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SensorManager.SENSOR_DELAY_NORMAL);

    }

    public void onAccuracyChanged(Sensor arg0, int arg1) {
        // TODO Auto-generated method stub

    }

    public void onSensorChanged(SensorEvent event) {
        xAxis = event.values[0];
        yAxis = event.values[1];
        zAxis = event.values[2];
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
    }

    @Override
    public Engine onCreateEngine() {
        return new CubeEngine();
    }

    class CubeEngine extends Engine {

        private final Paint mPaint = new Paint();
        private float mOffset;
        private float mTouchX = -1;
        private float mTouchY = -1;
        private long mStartTime;
        private float mCenterX;
        private float mCenterY;

        private final Runnable mDrawCube = new Runnable() {
            public void run() {
                drawFrame();
            }
        };
        private boolean mVisible;

        CubeEngine() {
            // Create a Paint to draw the lines for our cube
            final Paint paint = mPaint;
            paint.setColor(Color.GREEN);
            paint.setAntiAlias(true);
            paint.setStrokeWidth(15);
            paint.setStrokeCap(Paint.Cap.ROUND);
            paint.setStyle(Paint.Style.STROKE);

            mStartTime = SystemClock.elapsedRealtime();
        }

        @Override
        public void onCreate(SurfaceHolder surfaceHolder) {
            super.onCreate(surfaceHolder);

            // By default we don't get touch events, so enable them.
            setTouchEventsEnabled(true);
        }

        @Override
        public void onDestroy() {
            super.onDestroy();
            mHandler.removeCallbacks(mDrawCube);
        }

        @Override
        public void onVisibilityChanged(boolean visible) {
            mVisible = visible;
            if (visible) {
                drawFrame();
            } else {
                mHandler.removeCallbacks(mDrawCube);
            }
        }

        @Override
        public void onSurfaceChanged(SurfaceHolder holder, int format, int width, int height) {
            super.onSurfaceChanged(holder, format, width, height);
            // store the center of the surface, so we can draw the cube in the right spot
            mCenterX = width/2.0f;
            mCenterY = height/2.0f;
            drawFrame();
        }

        @Override
        public void onSurfaceCreated(SurfaceHolder holder) {
            super.onSurfaceCreated(holder);
        }

        @Override
        public void onSurfaceDestroyed(SurfaceHolder holder) {
            super.onSurfaceDestroyed(holder);
            mVisible = false;
            mHandler.removeCallbacks(mDrawCube);
        }

        @Override
        public void onOffsetsChanged(float xOffset, float yOffset,
                float xStep, float yStep, int xPixels, int yPixels) {
            mOffset = xOffset;
            drawFrame();
        }

        /*
         * Store the position of the touch event so we can use it for drawing later
         */
        @Override
        public void onTouchEvent(MotionEvent event) {
            if (event.getAction() == MotionEvent.ACTION_MOVE) {
                mTouchX = event.getX();
                mTouchY = event.getY();
            } else {
                mTouchX = -1;
                mTouchY = -1;
            }
            super.onTouchEvent(event);
        }

        /*
         * Draw one frame of the animation. This method gets called repeatedly
         * by posting a delayed Runnable. You can do any drawing you want in
         * here. This example draws a wireframe cube.
         */
        void drawFrame() {
            final SurfaceHolder holder = getSurfaceHolder();

            Canvas c = null;
            try {
                c = holder.lockCanvas();
                if (c != null) {
                    // draw something
                    drawCube(c);
                    drawTouchPoint(c);
                }
            } finally {
                if (c != null) holder.unlockCanvasAndPost(c);
            }

            // Reschedule the next redraw
            mHandler.removeCallbacks(mDrawCube);
            if (mVisible) {
                mHandler.postDelayed(mDrawCube, 1000 / 25);
            }
        }

        /*
         * Draw a wireframe cube by drawing 12 3 dimensional lines between
         * adjacent corners of the cube
         */
        void drawCube(Canvas c) {
            c.save();
            c.translate(mCenterX, mCenterY);
            c.drawColor(0xff000000);
            c.drawBitmap(drawable, 0+xAxis,0+yAxis, mPaint);
            drawLine(c, -400, -400, -400,  400, -400, -400);
            drawLine(c,  400, -400, -400,  400,  400, -400);
            drawLine(c,  400,  400, -400, -400,  400, -400);
            drawLine(c, -400,  400, -400, -400, -400, -400);

            drawLine(c, -400, -400,  400,  400, -400,  400);
            drawLine(c,  400, -400,  400,  400,  400,  400);
            drawLine(c,  400,  400,  400, -400,  400,  400);
            drawLine(c, -400,  400,  400, -400, -400,  400);

            drawLine(c, -400, -400,  400, -400, -400, -400);
            drawLine(c,  400, -400,  400,  400, -400, -400);
            drawLine(c,  400,  400,  400,  400,  400, -400);
            drawLine(c, -400,  400,  400, -400,  400, -400);
            c.restore();
        }

        /*
         * Draw a 3 dimensional line on to the screen
         */
        void drawLine(Canvas c, int x1, int y1, int z1, int x2, int y2, int z2) {
            long now = SystemClock.elapsedRealtime();
            float xrot = ((float)(now - mStartTime)) / 1000;
            float yrot = (0.5f - mOffset) * 2.0f;
            float zrot = 0;

            // 3D transformations

            // rotation around X-axis
            float newy1 = (float)(Math.sin(xrot) * z1 + Math.cos(xrot) * y1);
            float newy2 = (float)(Math.sin(xrot) * z2 + Math.cos(xrot) * y2);
            float newz1 = (float)(Math.cos(xrot) * z1 - Math.sin(xrot) * y1);
            float newz2 = (float)(Math.cos(xrot) * z2 - Math.sin(xrot) * y2);

            // rotation around Y-axis
            float newx1 = (float)(Math.sin(yrot) * newz1 + Math.cos(yrot) * x1);
            float newx2 = (float)(Math.sin(yrot) * newz2 + Math.cos(yrot) * x2);
            newz1 = (float)(Math.cos(yrot) * newz1 - Math.sin(yrot) * x1);
            newz2 = (float)(Math.cos(yrot) * newz2 - Math.sin(yrot) * x2);

            // 3D-to-2D projection
            float startX = newx1 / (4 - newz1 / 400);
            float startY = newy1 / (4 - newz1 / 400);
            float stopX =  newx2 / (4 - newz2 / 400);
            float stopY =  newy2 / (4 - newz2 / 400);

            c.drawLine(startX, startY, stopX, stopY, mPaint);
        }

        /*
         * Draw a circle around the current touch point, if any.
         */
        void drawTouchPoint(Canvas c) {
            if (mTouchX >=0 && mTouchY >= 0) {
                c.drawCircle(mTouchX, mTouchY, 80, mPaint);
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-18T20:07:23.793

您不仅必须实现`SensorEventListener`，而且还必须使用`SensorManager`.

在你的`onStart`方法中这样做：

```
SensorManager sensorMgr = (SensorManager) getSystemService(SENSOR_SERVICE);
sensorMgr.registerListener(this, sensorMgr.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SensorManager.SENSOR_DELAY_NORMAL); 
```

在`onStop`（或`onPause`）不要忘记取消注册：

```
SensorManager sensorMgr = (SensorManager) getSystemService(SENSOR_SERVICE);
sensorMgr.unregisterListener(this, sensorMgr.getDefaultSensor(Sensor.TYPE_ACCELEROMETER)); 
```

你也可以阅读 with 的[文档](http://developer.android.com/reference/android/hardware/SensorManager.html)，`SensorManager`也有一些很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-23T18:06:17.997

我在墙纸服务中获取加速度计数据。这是我的代码：

```
public class MyWallpaperService extends WallpaperService {

Context context;

public void onCreate() {
    context = this;
    super.onCreate();
}

public void onDestroy() {
    super.onDestroy();
}

public Engine onCreateEngine() {
    return new MyWallpaperEngine();
}

class MyWallpaperEngine extends Engine implements SensorEventListener {

    private final Handler handler = new Handler();
    private final Runnable drawRunner = new Runnable() {
        @Override
        public void run() {
            draw();
        }
    };
    private boolean visible = true;

    private SensorManager mSensorManager;
    private Sensor mAccelerometer;
    private Display mDisplay;

    private Bitmap mBackground;

    private float mSensorX;
    private float mSensorY;
    private float mSensorZ;

    MyWallpaperEngine() {

        mBackground = BitmapFactory.decodeResource(getResources(), R.drawable.background);

        mSensorManager = (SensorManager) context.getSystemService(Context.SENSOR_SERVICE);
        mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
        WindowManager mWindowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
        mDisplay = mWindowManager.getDefaultDisplay();

        BitmapFactory.Options opts = new BitmapFactory.Options();
        opts.inDither = true;
        opts.inPreferredConfig = Bitmap.Config.RGB_565;
        mBackground = BitmapFactory.decodeResource(getResources(), R.drawable.grass, opts);
    }

    public void registerSensors() {
        Log.d(TAG, "registerSensors()");
        mSensorManager.registerListener(this, mAccelerometer, SensorManager.SENSOR_DELAY_UI);
    }

    public void unregisterSensors() {
        Log.d(TAG, "unregisterSensors()");
        mSensorManager.unregisterListener(this);
    }

    @Override
     public void onSensorChanged(SensorEvent event) {
        if (event.sensor.getType() != Sensor.TYPE_ACCELEROMETER)
            return;

        switch (mDisplay.getRotation()) {
            case Surface.ROTATION_0:
                mSensorX = event.values[0];
                mSensorY = event.values[1];
                break;
            case Surface.ROTATION_90:
                mSensorX = -event.values[1];
                mSensorY = event.values[0];
                break;
            case Surface.ROTATION_180:
                mSensorX = -event.values[0];
                mSensorY = -event.values[1];
                break;
            case Surface.ROTATION_270:
                mSensorX = event.values[1];
                mSensorY = -event.values[0];
                break;
        }
        mSensorZ = event.values[2];
        //This is your Accelerometer X,Y,Z values
        Log.d(TAG, "X: " + mSensorX + ", Y: " + mSensorY + ", Z: " + mSensorZ);
    }

    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {

    }

    public void onCreate(SurfaceHolder surfaceHolder) {
        super.onCreate(surfaceHolder);
        registerSensors();
    }

    @Override
    public void onVisibilityChanged(boolean visible) {
        this.visible = visible;
        // if screen wallpaper is visible then draw the image otherwise do not draw
        if (visible) {
            handler.post(drawRunner);
        } else {
            handler.removeCallbacks(drawRunner);
        }
    }

    @Override
    public void onSurfaceDestroyed(SurfaceHolder holder) {
        super.onSurfaceDestroyed(holder);
        this.visible = false;
        handler.removeCallbacks(drawRunner);
    }

    public void onOffsetsChanged(float xOffset, float yOffset, float xStep, float yStep, int xPixels, int yPixels) {
        final SurfaceHolder holder = getSurfaceHolder();

            draw();
    }

    void draw() {
        final SurfaceHolder holder = getSurfaceHolder();

        Canvas c = null;
        try {
            c = holder.lockCanvas();
            // clear the canvas
            c.drawColor(Color.BLACK);

            if (c != null) {
                c.drawBitmap(mBackground, 0, 0, null);

            }
        }
        finally {
            if (c != null)
                holder.unlockCanvasAndPost(c);
        }

        handler.removeCallbacks(drawRunner);
        if (visible) {
            handler.postDelayed(drawRunner, 10); // delay 10 mileseconds
        }

    }

    @Override
    public void onDestroy() {
        unregisterSensors();
        super.onDestroy();
    }
} 
```

}

# svn - 如果未指定文件，则 ci 上的 SVN 警告

> ID：11925044
> 
> 赞同：2
> 
> 时间：2012-08-12T19:11:14.037
> 
> 标签：svn

有没有办法做到这一点，如果我打电话给`$ svn ci -m "some message"`我因为没有指定我要签入的文件而大喊大叫？

我可以只要求我确认我要签入整个目录，或者只是取消操作。

通常我会尽量详细地告诉 SVN 我要签入的文件，但有时我会忘记并最终签入比我想要的更多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T02:30:25.480

在我得到你的答案之前，我想确保你了解 Subversion 是如何工作的。

Subversion 将更改视为更改*列表*，而不是单个文件更改。这就是为什么每当有提交时整个存储库修订都会增加，而不仅仅是单个文件。

许多习惯于不处理变更列表的版本控制系统的人会这样做：

```
$ svn commit file1
$ svn commit file2
$ svn commit file3 
```

这很糟糕，因为它破坏了更改列表的概念。如果`file1`、`file2`和`file3`都与单个更改相关，则应将它们一起提交。

使用 Subversion 一次处理单个更改列表的标准方法。您致力于修复错误或添加功能，提交更改，然后处理下一个错误或功能。如果您同时处理两个单独的错误或功能，您真的应该有两个单独的检查。

这样做可以让您使用`svn commit`将更改列表作为一个单元提交。

* * *

也就是说，如果你没有列出任何文件，有一种方法可以改变 Subversion 提交的行为，那就是定义你自己的`svn`函数和命令的别名`svn`。

例如，在 Kornshell 中，当您执行 a`cd`以反映您所在的目录时，没有简单的方法来更改提示。为了解决这个问题，您创建一个`_cd`更改目录和提示的函数。`cd`然后，您将命令别名为您的`_cd`函数。

在您的情况下，您将定义一个`_svn`查看第一个参数并查看它是否为`commit`. 如果不是，您可以安全地执行实际`svn`命令。如果第一个参数是`commit`，那么您可以查看是否有第二个参数。如果没有'，您可以假设您忘记列出文件并退出。该函数看起来像这样：

```
function _svn {
  if [[ $1 == "commit" ]] && [[ -z $2 ]]
  then
      echo "You need to specify the exact files to commit"
      exit 2
  else
     \svn $*
  fi 
```

然后，您创建一个别名：

```
alias svn="_svn" 
```

现在，执行`svn`不会运行`svn`命令（至少直接）。相反，您的别名将运行该`_svn`函数。

顺便说一句，我没有在我的函数中假设任何参数处理。（如果`-m "this is a test") or`在命令中添加 --username bob --password Swordfish 会怎样？）。您必须扩展该函数以处理提交命令的参数。但是，这让您大致了解如何更改命令的功能以执行此类操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T04:33:56.020

我想出了一个 bash 脚本来调用而不是 SVN 提交，它对参数进行了一些检查

```
#!/bin/bash
# usage: ci -[file1...fileN] [-m message]]
# a wrapper for svn ci with some extra features
#  - If no message is given, will prompt user for message
#  - If no files are given, will show user list of files that
#       will be checked in and ask them to confirm or select files 
#       they want to check in

FILES=""
MESSAGE=""
MESSAGE_FLAG=0

# parse files and message from input
for var in "$@"
do
        if [ $MESSAGE_FLAG -eq 1 ]
        then
            MESSAGE="$var"
            break
        elif [ "$var" = "-m" ] 
        then
            MESSAGE_FLAG=1 # Indicates message is coming next
        else
            FILES="$FILES $var"
        fi
done

# ask for message if not present
if [ "$MESSAGE" = "" ]
then
    echo "Enter a message:"
    read MESSAGE
fi

# Check files have been specified
if [ "$FILES" = "" ]
then
    echo "No files have been specified"
    # call to svn st to print out list of modified files
    svn st
    echo "Do you want to check in all of these files (y/n/q):"
    read override
    if [ "$override" != "y" ]
    then
        if [ "$override" = "q" ]
        then
            exit
        fi
        echo "What files do you want to check in?"
        read FILES
    fi
fi

svn ci $FILES -m "$MESSAGE" 
```

我应该提一下，我是一名 JavaScript 程序员，所以**我必须从 BASH 书籍中除尘才能使其正常工作，因此请谨慎使用**。

我将此文件放在我的 PATH 中并将其命名为 ci ，因此`svn ci`我不会调用 Ill call `ci`，而是会在长途中节省一些击键。

# c# - 我如何使添加到 textBox 的文本只添加一次，而不是一直添加，因为它处于循环中？

> ID：11925047
> 
> 赞同：0
> 
> 时间：2012-08-12T19:11:16.420
> 
> 标签：c#

这是代码：

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e) 
{
    BackgroundWorker worker = sender as BackgroundWorker; 
    List<string> tempNamesAndTexts = new List<string>();
    string tempDownload = downloadContent();
    GetProfileNames(tempDownload);
    GetTextFromProfile(tempDownload);
    for (int i = 0; i < names.Count; i++)
    {
        tempNamesAndTexts.Add(names[i] + " " + texts[i]);            
    }
    if (InvokeRequired)
    {
        BeginInvoke(new Action(() => tempNamesAndTexts.ForEach(Item => textBox1.AppendText(Item + Environment.NewLine))));
    }
    while (true)
    {
        namesAndTexts = new List<string>();
        if ((worker.CancellationPending == true))
        {
            e.Cancel = true;
            break;
        }
        else
        {
            string content = downloadContent();
            GetProfileNames(content);
            GetTextFromProfile(content);
            for (int i = 0; i < names.Count; i++)
            {
                 namesAndTexts.Add(names[i] + " " + texts[i]);
            }
            if (InvokeRequired)
            {
                bool result = tempNamesAndTexts.SequenceEqual(namesAndTexts);
                if (result == true)
                {
                }
                else
                {
                    var t = namesAndTexts.Last();

                    if (textBox1.InvokeRequired)
                    {
                        BeginInvoke(new Action(() => textBox1.AppendText(t + Environment.NewLine)), null);
                        return;
                    }
                }
            }
            reader.Close();
            response.Close();
            Thread.Sleep(30000);
        }
    }
} 
```

问题出在这一行：

```
BeginInvoke(new Action(() => textBox1.AppendText(t + Environment.NewLine)), null);
                                    return; 
```

如果我会放一个reutn; 或打破；它将不断将变量 t 添加到文本框。我希望它只添加一次。并且循环将继续，但变量 t 将仅添加一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:17:39.097

希望我能很好地理解你的问题，听起来你只需要检查一下

```
if(string.IsNullOrEmpty(textBox1.Text)) //ADD NEW TEXT ONLY IF THERE IS NO ANY
  BeginInvoke(new Action(() => textBox1.AppendText(t + Environment.NewLine)), null); 
```

这自然*不用* `return`了，所以`while`循环会继续运行。

如果这不是您要的，请澄清。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:34:11.140

如果您希望每次通过循环更新文本，那么您始终可以删除当前字符串的第一行，然后将剩余的内容附加到 (t + Environment.NewLine)。不过，这需要大量的字符串切割。如果你想要一个计数器，你不妨添加一个进度条。

如果这不是你要找的，那么我误解了你的问题。请澄清。

# math - 可耻的简单：需要帮助间隔形状

> ID：11925049
> 
> 赞同：3
> 
> 时间：2012-08-12T19:11:28.140
> 
> 标签：math, button, spacing

我有一个简单的问题，由于某种原因我无法解决。我有一个高度为 600 像素（宽度无关紧要）的窗口和高度为 90 像素的按钮。我需要的是能够用可变数量的按钮均匀地间隔屏幕上的按钮。例如，如果我有一个按钮，它将位于中心，而不是它们会分开。我试过 (600 - (90 * #ofbuttons)) / (#ofbuttons + 1) 但这没有用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:05:35.757

简单地说：

```
center_of_button_i = 600*i/(n+1) 
```

# php - 是否有在数组之间进行选择的方法，特定位置具有最高值的数组

> ID：11925059
> 
> 赞同：2
> 
> 时间：2012-08-12T19:12:06.033
> 
> 标签：php, arrays

障碍：使用多个嵌套数组并希望在特定位置选择具有最大 int 的数组；在所选数组中更改另一个特定位置的值。

伪代码可能如下所示：

```
$array1 = array(2, 23, 7);
$array2 = array(2, 21, 7);

$Mutt = array($L, $P, $O, $array1)
$Jeff = array($L, $P, $O, $array2)

find array with max [3][1] {
('selected' [1]++)
} 
```

在现实生活中，这可能看起来像：Mutt ($Mutt) 本月工作的天数最多 ($Mutt [3][1])，他获得了额外的“个人日”($Mutt [1])。

我试图找到解决方案。我可能太新了，无法理解如何正确地用词来搜索，但我没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T19:32:32.440

我不确定您的最大值对整体问题有多重要。这看起来有点乱。我想了 3 种不同的方法来处理这个问题。

1.  每次数组发生突变时，创建和添加数组以保存和更新最大值。这很快很脏，不是一个很好的解决方案，但取决于项目的过高价值可能没问题。
2.  编写一个函数来搜索最大值，过度但会起作用。
3.  更先进但可能是最专业的解决方案，使用类重新设计您的程序。每个数组现在都将成为它自己的对象。每个对象都可以使用它的 mutator 在类变量中跟踪它自己的最大值，或者添加函数来随时更新它。现在您可以简单地拥有一个由这些对象组成的数组，并且可以轻松对该数组进行排序（使用该值的访问器按每个对象的最大值排序）然后只需根据数组的顶部或底部拉出对象你用哪种方式排序的。您可能希望在类级别上编写一个私人搜索功能，以找到创造的最大价值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T19:52:56.180

我希望我已经很好地理解了你想要的东西：

你的数组：

```
$array1 = array(2, 23, 7);
$array2 = array(2, 21, 7);

$Mutt = array($L, $P, $O, $array1);
$Jeff = array($L, $P, $O, $array2); 
```

创建一个`$people`包含`$Mutt`和`$Jeff`（通过引用传递）的新数组。

```
$people=array(&$Mutt,&$Jeff); 
```

创建函数`findMaxIndex`，它返回索引，该索引`$people[that index]`是我们想要的位置处具有最大值的数组。

它的论点是：

*   `$arr`，包含我们要比较的数组的数组（在这种情况下，`$people`）
*   `$pos1`和`$pos2`，这是我们要比较的索引

所以...我们将比较

*   `$arr[0][$pos1][$pos2]`
*   `$arr[1][$pos1][$pos2]`
*   ...
*   `$arr[count($arr)-1][$pos1][$pos2]`

这个函数是这样工作的：

1.  它创建了数组`$max`，其中`$max[0]`是具有最大值的 $arr 的索引（在我们检查过的数组中，直到那一刻），并且`$max[1]`是那个值。
2.  它遍历所有`$arr`
3.  如果发现当前值 ( `$arr[$i][$pos1][$pos2]`) 大于最大值，`$max`则更新并变为 `array($i,$arr[$i][$pos1][$pos2])`。
4.  最后，它返回`$max[0]`，它是 `$people[that index]`我们想要的位置处具有最大值的数组的索引。

功能是：

```
function findMaxIndex($arr,$pos1,$pos2){
    $max=array(0,$arr[0][$pos1][$pos2]);
    for($i=1;$i<count($arr);$i++){
        if($arr[$i][$pos1][$pos2]>$max[1]){
            $max=array($i,$arr[$i][$pos1][$pos2]);
        }
    }
    return $max[0];
} 
```

然后我们调用函数...

```
$maxIndex=findMaxIndex($people,3,1); 
```

...给出`0`，所以具有最大值的数组是`$people[0]`( `$Mutt`)

最后，我们增加该数组：

```
$people[$maxIndex][1]++; 
```

`$Mutt`并且`$Jeff`也被修改了，因为我们通过引用传递了它们。

简而言之，

```
$array1 = array(2, 23, 7);
$array2 = array(2, 21, 7);
$Mutt = array($L, $P, $O, $array1);
$Jeff = array($L, $P, $O, $array2);
$people=array(&$Mutt,&$Jeff);
function findMaxIndex($arr,$pos1,$pos2){
    $max=array(0,$arr[0][$pos1][$pos2]);
    for($i=1;$i<count($arr);$i++){
        if($arr[$i][$pos1][$pos2]>$max[1]){
            $max=array($i,$arr[$i][$pos1][$pos2]);
        }
    }
    return $max[0];
}
$maxIndex=findMaxIndex($people,3,1);//gives `0` -> Max is `$people[0]`
$people[$maxIndex][1]++; 
```

===============================================

如果您想要多个索引以防出现平局（更改为粗体）：

你的数组：

```
$array1 = array(2, 23, 7);
$array2 = array(2, 21, 7);

$Mutt = array($L, $P, $O, $array1);
$Jeff = array($L, $P, $O, $array2); 
```

创建一个新数组`$people`，其中包含`$Mutt`和`$Jeff`

```
$people=array(&$Mutt,&$Jeff); 
```

创建函数`findMaxIndex`，它返回包含索引的数组，该数组的索引`$people[that index]`是在我们想要的位置处具有最大值的数组。

它的论点是：

*   `$arr`，包含我们要比较的数组的数组（在这种情况下，`$people`）
*   `$pos1`和`$pos2`，这是我们要比较的索引

所以...我们将比较

*   `$arr[0][$pos1][$pos2]`
*   `$arr[1][$pos1][$pos2]`
*   ...
*   `$arr[count($arr)-1][$pos1][$pos2]`

这个函数是这样工作的：

1.  它创建了数组`$max`，其中`$max[0]`是一个数组，其中包含具有最大值的 $arr**的索引**`$max[1]`（在我们检查过的数组中，直到那一刻），并且是那个值。
2.  它遍历所有`$arr`
3.  如果发现当前值 ( `$arr[$i][$pos1][$pos2]`) 大于最大值，`$max`则更新并变为 `array(array($i),$arr[$i][$pos1][$pos2])`。
4.  **如果不是，并且如果它发现当前值**( `$arr[$i][$pos1][$pos2]`)**等于最大值**，`$max[0]`则更新并`$i`推入其中。
5.  最后，它返回`$max[0]`，它是包含索引的数组，该数组的索引 `$people[that index]`是在我们想要的位置处具有最大值的数组。

功能是：

```
function findMaxIndex($arr,$pos1,$pos2){
    $max=array(array(0),$arr[0][$pos1][$pos2]);
    for($i=1;$i<count($arr);$i++){
        $current=$arr[$i][$pos1][$pos2];
        if($current>$max[1]){
            $max=array(array($i),$current);
        }else if($current==$max[1]){
            array_push($max[0],$i);
        }
    }
    return $max[0];
} 
```

然后我们调用函数...

```
$maxIndex=findMaxIndex($people,3,0); 
```

...给出`array(0,1)`，因此具有最大值的数组是`$people[0]`( `$Mutt`) 和`$people[1]`( `$Jeff`)。

最后，我们增加数组：

```
for($i=0;$i<count($maxIndex);$i++){
    $people[$maxIndex[$i]][1]++;
} 
```

`$Mutt`并且`$Jeff`也被修改了，因为我们通过引用传递了它们。

简而言之，

```
$array1 = array(2, 23, 7);
$array2 = array(2, 21, 7);
$Mutt = array($L, $P, $O, $array1);
$Jeff = array($L, $P, $O, $array2);
$people=array(&$Mutt,&$Jeff);
function findMaxIndex($arr,$pos1,$pos2){
    $max=array(array(0),$arr[0][$pos1][$pos2]);
    for($i=1;$i<count($arr);$i++){
        $current=$arr[$i][$pos1][$pos2];
        if($current>$max[1]){
            $max=array(array($i),$current);
        }else if($current==$max[1]){
            array_push($max[0],$i);
        }
    }
    return $max[0];
}
$maxIndex=findMaxIndex($people,3,0);//gives `array(0,1)` -> Tie between `$people[0]` and `$people[1]`
for($i=0;$i<count($maxIndex);$i++){
    $people[$maxIndex[$i]][1]++;
} 
```

# python - 如何在 Django 应用程序中使用 celery 执行任务？

> ID：11925063
> 
> 赞同：2
> 
> 时间：2012-08-12T19:12:29.533
> 
> 标签：python, django, cron, celery, django-celery

我发布了一个问题：[如何在 Django 中每天一次在准确的时间执行命令？](https://stackoverflow.com/questions/11924414/how-to-execute-a-command-at-exact-time-once-a-day-in-django#11924466)

我得到的答案是芹菜是最简单的选择，但现在我有另一个关于芹菜的问题：

```
from celery.schedules import crontab

CELERYBEAT_SCHEDULE = {
    # Executes every Monday morning at 7:30 A.M
    'every-monday-morning': {
        'task': 'tasks.add',
        'schedule': crontab(hour=7, minute=30, day_of_week=1),
        'args': (16, 16),
    },
} 
```

关于上述代码，我有三个问题，即：

*   我必须执行`execute_command(User, command)`方法。我希望此方法将在给定的预定时间执行。

*   如果我想更改时间表`7:30 AM but every weekdays`怎么办？

*   怎么样`args`。在我的情况下，我应该传递`User and command`from的值`args`。或者我可以简单地从`task`密钥传递？

我刚刚阅读了 celery 的文档，但没有得到我的答案。你能帮帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T20:22:10.657

你找到[Celery 定期任务文档](http://celery.github.com/celery/userguide/periodic-tasks.html)了吗？

*   您必须使用方法的标识符来注册调度程序条目。如果您的`execute_command`任务位于名为的模块中`foobar`，则`task`该结构的值`CELERYBEAT_SCHEDULE`应为`foobar.execute_command`.

    只要可行，Celery 将为您导入任务`import foobar.execute_command`。

*   检查[`celery.schedule.crontab`API](http://celery.github.com/celery/reference/celery.schedules.html#celery.schedules.crontab)；以下应在工作日上午 07:30 执行：

    ```
    crontab(minute=30, hour=7, day_of_week=’mon-fri’) 
    ```

*   请记住，此任务将异步执行。当您计划此任务并期望在调用该任务时它仍然存在时，您无法查询数据库对象。

    因此，您应该只传入保持不变的 python 值，并让您的任务连接到数据库并根据您传入的参数进行查找。

    如果这个任务只为一个特定的用户执行任务，那么一定要传入那个用户的标识符（用户 ID、电子邮件、任何你可以用来从数据库中查找用户的东西）。

# php - 在关联数组中查找重复值并将它们添加到计数中

> ID：11925065
> 
> 赞同：2
> 
> 时间：2012-08-12T19:13:01.513
> 
> 标签：php, arrays, duplicates, associative

嗨，我正在尝试计算关联数组中重复值的数量，如下所示：

```
array(3) { [0]=> array(3) { ["Title"]=> string(25) "hello" 
                            ["Price"]=> int(50) 
                            ["Count"]=> int(1) }
           [1]=> array(3) { ["Title"]=> string(35) "world" 
                            ["Price"]=> int(50) 
                            ["Count"]=> int(1) } 
           [2]=> array(3) { ["Title"]=> string(25) "hello" 
                            ["Price"]=> int(50) 
                            ["Count"]=> int(1) } } 
```

正如您在此处看到的，“标题”标签中有一个重复值，我想对它们进行计数并将其添加到“计数”部分。我开始做这样的事情：

```
$prodArray = array();

// Add the values to the array if it's the first time it occurs.
if (!in_array($row['prodTitle'], $prodArray["Title"]))
{
array_push($prodArray, 
           array( Title => $row['prodTitle'],
                  Price => $row['prodPrice'],
                  Count => 1)
          );
}
else
{
//Add one to the count for the current item.
} 
```

问题是我无法通过 in_array 函数访问数组中的“标题”元素。欢迎任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T11:02:50.283

如果你想检测你正在创建的数组中的重复，这样的事情避免了多次遍历数组：

```
$arr=array();
while($row = mysql_fetch_array($result))  {                  
  $arr[$row['prodTitle']] = isset($arr[$row['prodTitle']]) 
                               ? $arr[$row['prodTitle']] +1 
                               : 0;                    
}
$dups = array_keys(array_filter($arr)); //any key => 0 will be filtred out 
```

如果您只想通过 SQL 直接获取 dups，请查看以下内容：

您当前的查询——

```
SELECT prodTitle 
  FROM product 
WHERE prodTitle != '{$keyword}' 
  AND creditCard IN( SELECT creditCard FROM product WHERE prodTitle ='{$keyword}'); 
```

给出这样的数据

```
prod cc
A    1
A    2
A    3
A    1
A    1
B    15
B    1
B    2
B    21
C    10
C    1 
```

返回此集合（使用 $keyword=='A'）：

```
prod 
B
B
C 
```

一个聚合查询，*它只*返回在非 X 上使用的信用卡也至少在 X 上使用过两次的记录——

```
SELECT p1.prodTitle, COUNT(p2.creditCard) AS numrecords
  FROM product p1
    JOIN product p2
    ON (p1.creditCard = p2.creditCard)
WHERE p1.prodTitle != '{$keyword}'
  AND p2.prodTitle = '{$keyword}'
GROUP BY p1.prodTitle 
  HAVING COUNT(p2.creditCard) > 1; 
```

给定相同的数据，返回这个集合：

```
prod  num
B    2 
```

进行聚合查询可以避免所有的循环问题。这是MySQL 聚合函数列表的 [链接。](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T17:06:57.873

好的，所以我找到了我的解决方案，我让它看起来像这样可能不是他最有效的方式，但它有效：

```
$prodArray = array();
$ar = array();

$query ="THE QUERY";
$result = mysql_query($query) or die(mysql_error());

while($row = mysql_fetch_array($result))
{
array_push($ar, $row['prodTitle']);
}

function findDuplicates($data,$dupval) {
$nb= 0;
foreach($data as $key => $val)
if ($val==$dupval) $nb++;
return $nb;
}

$uniarr = array_unique($ar);

//Will run the function findDuplicates for each unique title in the array
for ($i = 0; $i < sizeof($uniarr); $i++)
{
$count = findDuplicates($ar, $uniarr[$i]);
array_push($prodArray, array( Title => $uniarr[$i], Count => $count));
}

//Displays 2 of the results in the array
for ($c = 0; $c < 2; $c++)
{
echo "The title:".$prodArray[$c]["Title"]." And the amount:".$prodArray[$c]["Count"];
echo "<br />";
} 
```

因此，您可以随意发表您对此的评论，如果您有任何改进，请随时发表。

# html - CSS DIV 对齐问题

> ID：11925073
> 
> 赞同：0
> 
> 时间：2012-08-12T19:14:15.313
> 
> 标签：html, css, alignment

我正在尝试将我的 DIV“我们的来源”对齐在“我们的地区”下方，然后将文本 DIV 对齐在右侧。目前“我们的来源”在“我们的地区”的右侧，文本也错误对齐。

基本上我想要这样：

我们的地区 Blabla 文本

我们的来源

你可以在这里看到我当前的代码：http: [//jsfiddle.net/Grek/xC6wx/](http://jsfiddle.net/Grek/xC6wx/)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:18:49.627

你的意思是这样的：

[JS 小提琴更新](http://jsfiddle.net/coltanious/t4DWe/)

# php - 如何使用 php 显示 pdf 文件的详细信息

> ID：11925076
> 
> 赞同：2
> 
> 时间：2012-08-12T19:14:32.140
> 
> 标签：php, http, content-type

我正在使用 php 来显示 pdf

```
@readfile($actualfilename);
                        header('Content-type:pdf');      
                   header('Content-Disposition: inline');
                   header('Content-Transfer-Encoding: binary');
                   header('Content-Length: ' . filesize($actualfilename));
                   header('Accept-Ranges: bytes'); 
```

问题出在它显示的标题栏上

![标题图片](../Images/f3a6b2aa9da3ae97f4434ffe5d8f0c46.png)

当我使用

```
header('Content-type:application/pdf'); 
```

它提示我下载文件，当我使用时出现同样的问题

```
header('Content-Disposition: inline; filename='.$fakefilename.''); 
```

此代码仅在 Firefox 中显示 pdf 文件。IE,chrome提示我下载文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:19:51.827

您是否尝试更改浏览器的标题栏文本（或显示文件名的任何位置）？

如果是这样，那么您在这里就不走运了，因为这将不起作用，因为由浏览器决定如何/在哪里（如果有的话）显示文件名。

但是，有一些可能的解决方法：您可以使用服务器端工具，例如`mod_rewrite`在 Apache 环境中将请求（如`download/readme.pdf`在幕后）重定向到`readfile.php?file=readme.pdf`. 在这种情况下，浏览器不会知道隐藏的重写，它实际上会显示`readme.pdf`为文件名（即使实际文件名或服务器端的脚本名不同）。

# jquery - 为什么图像不是 100% 以及如何使其适应浏览器？

> ID：11925077
> 
> 赞同：0
> 
> 时间：2012-08-12T19:14:41.900
> 
> 标签：jquery, html, css

我正在尝试使图像拉伸浏览器的 100% 宽度，但我似乎在某个地方出错了。

这是一个[小提琴。](http://jsfiddle.net/MichaelT/UtyJR/1/)

我将在最后添加代码。

我发现了[类似](http://thegreatdiscontent.com/)的东西，但在检查时我无法理解他们的代码。

他们如何使图像适应浏览器？

他们在使用 Jquery 吗？

提前致谢。

代码——</p>

HTML：

```
<div id="header">
   <img src="http://davesizer.com/blogs/wp-content/uploads/2010/03/eva_jump.jpg" alt="Collin Hughes">
</div>
    <div id="outer" >
        <div id="inner"></div>
</div>
    </body> 
```

CSS：

```
body, html {
     margin: 0;
     width: 100%;
     }

#header{
     position: relative;
     width: 100%;
     height:auto;
     background-size: 100%;
     margin: 0;
     }

#outer{
     position: relative;
     width: 90%;
     height: 500px;
     background-color: red;
     margin-top:30px;
     margin-right: auto;
     margin-bottom: 30px;
     margin-left: auto;
     padding: 20px 0 0 0;

}

#inner{
     width: 200px;
     height: 250px;
     background-color: lightblue;
     margin: 0 auto;
     top: 20px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T19:21:36.600

您没有在图像上设置宽度，而只是在`#header`.
您可以添加以下内容来解决此问题：

```
#header img{
    width: 100%;
} 
```

即使更改浏览器大小，这也将确保宽度始终为 100%。
您可以通过重新调整结果框的大小在下面更新的小提琴中进行尝试。

见[**演示**](http://jsfiddle.net/UtyJR/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T19:21:33.830

您需要将此添加到您的 CSS 以定位图像。这也是其他网站的做法。

```
 #header img { width:100% } 
```

# sql - 使用与 SQL Server 相同的表减去总计

> ID：11925081
> 
> 赞同：0
> 
> 时间：2012-08-12T19:15:26.203
> 
> 标签：sql, sql-server-2008

我在 SQL Server 2008 数据库中有一个付款表，它包含付款金额和信用金额，信用由`txt_pay_type`等于“信用”的字段标识。

我正在尝试输出一些报告，其中一个是每个网站的总收入。

我正在使用这个选择语句来获取每个网站的总和和平均值，我怎样才能让它带走信用额。

所以最终的 webTotal 是少和学分。

即对所有非信用的付款进行总和（如下所示），对所有作为信用的付款进行总和，然后从另一个中取一个。或者我最好在冷聚变页面上执行此操作？

例如，网站 1 支付总额为 5000，信用额度为 1000。结果将是；

```
Website    Total Revenue  Average Sale   
Website 1  4000           200.00

SELECT 
  txt_web_name,
  SUM(mon_pay_amount) AS webTotal,
  AVG(mon_pay_amount) AS webAvg
FROM
  tbl_payment
  INNER JOIN dbo.tbl_orders ON (uid_pay_orderid = uid_orders)
  INNER JOIN dbo.tbl_websites ON (uid_order_webid = uid_websites)
WHERE
  dbo.tbl_payment.bit_pay_paid = <cfqueryparam cfsqltype="cf_sql_bit" value="yes">
  AND txt_pay_status <> <cfqueryparam cfsqltype="cf_sql_varchar" value="Credit">
GROUP BY
  txt_web_name 
```

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:20:12.630

你需要一个条件总和：

```
SELECT txt_web_name, SUM(mon_pay_amount) AS webTotal, AVG(mon_pay_amount) AS webAvg,
       sum(case when txt_pay_type <> 'Credit' then mon_pay_amount else 0 end
          ) as TotalNoCredit,
       avg(case when txt_pay_type <> 'Credit' then mon_pay_amount end
          ) as AvgNoCredit
FROM tbl_payment
     INNER JOIN dbo.tbl_orders ON (uid_pay_orderid = uid_orders)
     INNER JOIN dbo.tbl_websites ON (uid_order_webid = uid_websites)
WHERE dbo.tbl_payment.bit_pay_paid = <cfqueryparam cfsqltype="cf_sql_bit" value="yes">
      AND txt_pay_status <> <cfqueryparam cfsqltype="cf_sql_varchar" value="Credit">
GROUP BY txt_web_name 
```

注意总和，我默认为 0，所以一个月内没有值会导致 $0。对于平均值，我默认为 NULL，因此不会在平均值中计算信用值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T19:20:42.550

您可以使用`CASE`语句来决定是添加还是减去 a `mon_pay_amount`，例如

```
SELECT
    txt_web_name,
    SUM(CASE 
        WHEN txt_pay_type = 'credit' 
        THEN -1 * mon_pay_amount 
        ELSE mon_pay_amount END) AS webTotal,
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T19:21:00.197

不清楚这些列到底是什么，但这样的东西会起作用：

```
SUM(CASE txt_pay_type = 'credit' 
    THEN mon_pay_amount 
    ELSE (-1*mon_pay_amount) END) AS webTotal, 
```

# php - 使用php将字符串转换为数组

> ID：11925086
> 
> 赞同：1
> 
> 时间：2012-08-12T19:16:20.057
> 
> 标签：php, arrays, string

我正在尝试将数组结构生成为编码样式，以便可以将其用于进一步开发，为此我使用了以下内容：

```
function convertArray($string)
{
        $finalString = var_export($string, true);
        return stripslashes($finalString);
} 
```

它工作得很好，但问题是它将额外的引号添加到值的开头和结尾我如何删除这些引号。

示例生成的字符串如下：

```
array (
  'foo' => 'array('foo','bar','baz')',
  'bar' => 'array('foo','bar')',
  'baz' => 'array('foo','bar')',
); 
```

我需要的字符串是：

```
array (
      'foo' => array('foo','bar','baz'),
      'bar' => array('foo','bar'),
      'baz' => array('foo','bar'),
    ); 
```

**更新**

这是我创建数组的方式：

```
foreach( $attributes as $attrib )
    {
        if( $attrib->primary_key == '1' )
            $column[$attrib->name] = array("'$attrib->type'", "'$attrib->max_length'", '\'pk\'');
        else
            $column[$attrib->name] = array("'$attrib->type'", "'$attrib->max_length'");

        $string[$attrib->name] = 'array('.implode(',', $column[$attrib->name]).')';
    } 
```

从这个循环处理后，最终数组发送到上述函数以将其转换为我想要的形式/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:06:20.627

你可以使用反斜杠

```
$string = "Some text \" I have a double quote";
$string1 = 'Second text \' and again i have quote in text'; 
```

和丢失的变种

您可以使用 1 idiot 变体在示例中创建多行字符串：

```
$string = <<<HERE
Many many text
HERE; 
```

但我不建议使用此变体

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:22:06.447

尝试使用[修剪](http://php.net/trim)。例子：

```
$string = "'text with quotes'";
echo $string; // output: 'text with quotes'
echo trim($string, array("'")); // output: text with quotes 
```

# flash - Flash CS6 Spritesheet导出功能中如何设置注册点？

> ID：11925100
> 
> 赞同：3
> 
> 时间：2012-08-12T19:17:42.300
> 
> 标签：flash, position, export, sprite-sheet, flash-cs6

我正在尝试调整**Spritesheet**导出的 JSON 文件，以便可以导入精灵及其在**注册点**的位置。

在 Flash 中，我只是添加了该**位置的****偏移量**，但这不起作用......这就是我现在导出它的方式：`frame.offsetInSource`

 **```
function frameExport(frame)
{

var s;
if (hitFrame)
    s = "\n,{\n";
else
    s = "\n{\n";
s += AddKeyRect("frame", frame.frame);
s+= ",\n";
var spriteSourceSize = new Object();
spriteSourceSize.x = frame.offsetInSource.x;
spriteSourceSize.y = frame.offsetInSource.y;
spriteSourceSize.w = frame.sourceSize.w;
spriteSourceSize.h = frame.sourceSize.h;
s += AddKeyRect("offset", spriteSourceSize);
s += "}";

hitFrame = true;

return s;
 } 
```

我怎样才能导出这个好方法，所以它们的**相对**位置也导出为**偏移变量**？还有其他变量可以用于此吗？我知道你可以使用这些变量：

```
frame.frame.x
frame.frame.y
frame.frame.w
frame.frame.h
frame.offsetInSource.x
frame.offsetInSource.y
frame.sourceSize.w
frame.sourceSize.h 
```

**提前致谢！**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T16:23:20.523

我还尝试使用 Sprite Sheet Exporter 来导出每一帧的相对位置。但我发现，在元数据中，“frame.offsetInSource.x”的值始终为零。我想这就是我想要的，也是你想要的。

我尝试编辑 JSON.plugin.jsfl，取消注释跟踪。可悲的是它仍然为零。

直到现在，我还没有弄清楚为什么。**

# ruby-on-rails - 使用 Active Admin 创建 Rails 3 HABTM 会引发“无法批量分配受保护的属性：”错误

> ID：11925101
> 
> 赞同：5
> 
> 时间：2012-08-12T19:17:43.643
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, has-and-belongs-to-many

我是一个 Rails 菜鸟，所以下面可能是由于缺乏理解，但是我整天都在看/阅读，似乎找不到解决方案。

我有两个模型 - 项目和技术：

**项目 ：**

```
class Project < ActiveRecord::Base

  attr_accessible description, :name

  has_and_belongs_to_many :technologies, :join_table => :projects_technologies

end 
```

**技术 ：**

```
class Technology < ActiveRecord::Base

  attr_accessible :abbr, :description, :name

  has_and_belongs_to_many :projects, :join_table => :projects_technologies

end 
```

**我的 Create_Projects_Technologies 迁移如下：**

```
class CreateProjectsTechnologies < ActiveRecord::Migration
  def self.up

    create_table :projects_technologies, :id => false do |t|
        t.references :project
        t.references :technology
    end
    add_index :projects_technologies, [:project_id, :technology_id]
    add_index :projects_technologies, [:technology_id, :project_id]
  end

  def self.down
    drop_table :projects_technologies
  end
end 
```

然后，我使用 Active Admin 使用以下表单创建和编辑项目模型：

```
ActiveAdmin.register Project do

  form do |f|
    f.inputs "Project attributes" do
      f.input :name
      f.input :description
      f.input :technologies, as: :check_boxes
    end
    f.buttons
  end

end 
```

这正确地将我的所有技术显示为复选框，但是一旦我提交表单，我就会遇到以下我无法克服的错误：

**ActiveModel::MassAssignmentSecurity::Admin::ProjectsController#update 中的错误**

```
Can't mass-assign protected attributes: technology_ids 
```

非常感谢所有帮助：D

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T19:37:12.737

简单地将 technology_ids 添加到项目 attr_accessible

```
attr_accessible :client, :description, :name, :technology_ids 
```

# jquery - 在文本框中使用自动填充搜索 cs

> ID：11925110
> 
> 赞同：1
> 
> 时间：2012-08-12T19:19:10.070
> 
> 标签：jquery, asp.net, handler, populate

```
<%@ WebHandler Language="C#" Class="Search_CS" %>

using System;
using System.Web;
using System.Data.SqlClient;
using System.Configuration;
using System.Text;

public class Search_CS : IHttpHandler {
    ClassData clsDt = new ClassData();
    public void ProcessRequest (HttpContext context) {
        string prefixText = context.Request.QueryString["prefixText"];
        string kk = clsDt.getDataTable("select ContactName from Customers where " + "ContactName like @SearchText + '%'").Rows[0][0].ToString();
            using (SqlCommand cmd = new SqlCommand())
            {
                switch (prefixText)
                {
                    case "1":
                        //tb1
                        cmd.CommandText = kk;
                        break;
                    case "2":
                        //tb2
                        cmd.CommandText = kk;
                        break;
                }
                //cmd.CommandText = "select ContactName from Customers where " + "ContactName like @SearchText + '%'";
                cmd.Parameters.AddWithValue("@SearchText", prefixText);
                cmd.Connection = clsDt.sqlCnn;
                StringBuilder sb = new StringBuilder();
                clsDt.sqlCnn.Open();
                using (SqlDataReader sdr = cmd.ExecuteReader())
                {
                    while (sdr.Read())
                    {
                        sb.Append(sdr["ContactName"])
                            .Append(Environment.NewLine);
                    }
                }
                clsDt.sqlCnn.Close();
                context.Response.Write(sb.ToString()); 
            }

    }

    public bool IsReusable {
        get {
            return false;
        }
    }
} 
```

我有一个文件 ashx.. 我想通过它使用自动完成插件 jquery 在我的文本框中填充建议...

```
 <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
 <script src="js/jquery.autocomplete.js" type="text/javascript"></script>
 <script type="text/javascript">
     $(document).ready(function() {
         $("#txtSearch").autocomplete('Search_CS.ashx?prefixText=1');
         $("#TextBox1").autocomplete('Search_CS.ashx?prefixText=2');
     });       
 </script> 
```

以上是jquery客户端

ashx 文件中存在一些问题...

# cassandra - Cassandra CQL3 切片查询问题 - 如何切片

> ID：11925112
> 
> 赞同：3
> 
> 时间：2012-08-12T19:19:22.427
> 
> 标签：cassandra, cql

我有一个使用创建的表`CQL3`：

```
create table compositetest(m_id ascii,i_id int,l_id ascii,body ascii,
  PRIMARY KEY(m_id,i_id,l_id)); 
```

插入一些随机数据：

```
cqlsh:testkeyspace1> insert into compositetest(m_id,i_id,l_id,body) VALUES ('m1',1,'l1','b1');
cqlsh:testkeyspace1> insert into compositetest(m_id,i_id,l_id,body) VALUES ('m2',2,'l2','b2');
cqlsh:testkeyspace1> insert into compositetest(m_id,i_id,l_id,body) VALUES ('m1',2,'l2','b2');
cqlsh:testkeyspace1> insert into compositetest(m_id,i_id,l_id,body) VALUES ('m2',1,'l1','b1');
cqlsh:testkeyspace1> insert into compositetest(m_id,i_id,l_id,body) VALUES ('m3',3,'l1','b1');
cqlsh:testkeyspace1> insert into compositetest(m_id,i_id,l_id,body) VALUES ('m3',2,'l2','b2');
cqlsh:testkeyspace1> insert into compositetest(m_id,i_id,l_id,body) VALUES ('m3',1,'l2','b2');
cqlsh:testkeyspace1> select * from compositetest;

 m_id | i_id | l_id | body
------+------+------+------
   m1 |    1 |   l1 |   b1
   m1 |    2 |   l2 |   b2
   m2 |    1 |   l1 |   b1
   m2 |    2 |   l2 |   b2
   m3 |    1 |   l2 |   b2
   m3 |    2 |   l2 |   b2
   m3 |    3 |   l1 |   b1 
```

当我进行查询时

```
cqlsh:testkeyspace1> select * from compositetest where i_id<=3 limit 3;

 m_id | i_id | l_id | body
------+------+------+------
   m1 |    1 |   l1 |   b1
   m1 |    2 |   l2 |   b2
   m2 |    1 |   l1 |   b1 
```

现在，如果我想获得接下来的 3 行

```
cqlsh:testkeyspace1> ? 
```

正在尝试为切片范围编写 CQL（不确定是否可以完成）

我的 CQLSh 显示 Socket 已关闭，我看到了错误

```
TSocket read 0 bytes 
```

在服务器端，我看到以下错误：

```
ERROR [Thrift:3] 2012-08-12 15:15:24,414 CustomTThreadPoolServer.java (line 204) Error occurred during processing of message.
java.lang.NullPointerException
    at org.apache.cassandra.cql3.statements.SelectStatement$Restriction.setBound(SelectStatement.java:1277)
    at org.apache.cassandra.cql3.statements.SelectStatement$RawStatement.updateRestriction(SelectStatement.java:1151)
    at org.apache.cassandra.cql3.statements.SelectStatement$RawStatement.prepare(SelectStatement.java:1001)
    at org.apache.cassandra.cql3.QueryProcessor.getStatement(QueryProcessor.java:215)
    at org.apache.cassandra.cql3.QueryProcessor.process(QueryProcessor.java:121)
    at org.apache.cassandra.thrift.CassandraServer.execute_cql_query(CassandraServer.java:1237)
    at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:3542)
    at org.apache.cassandra.thrift.Cassandra$Processor$execute_cql_query.getResult(Cassandra.java:3530)
    at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:32)
    at org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:34)
    at org.apache.cassandra.thrift.CustomTThreadPoolServer$WorkerProcess.run(CustomTThreadPoolServer.java:186)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680) 
```

我如何获得接下来的 3 行，关于服务器端的异常，我将提交一个错误。CQLSh 已关闭，我现在必须退出并重新连接

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-01T15:07:39.420

自 CQL2 及更高版本以来，CQL 具有所谓的“自动分页”。简而言之，您所描述的内容已由驱动程序处理。

当您的代码请求新行时，服务器只发送查询的下一行，而不是整个结果。同样，您可以告诉它返回您想要的行数。

在 DB 术语中，您执行查询，返回光标。然后您告诉游标获取 N 行，服务器将这些行发回（而不是整个结果集）。

一旦没有更多行要返回，游标就完成了。

在 cqlsh 中，当它遍历光标到该点时，您会自动显示多达 1k 行 IIRC。

# c# - 如果文本框不为空，如何添加和显示工具提示文本框 WPF

> ID：11925113
> 
> 赞同：2
> 
> 时间：2012-08-12T19:19:26.303
> 
> 标签：c#, wpf

需要显示一个提示，其中包含来自文本字段的数据。如果文本框有数据，则提示出现。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-12T20:45:51.807

只需使用绑定到 ToolTipService 附加属性。XAML：

```
<UserControl.Resources>
    <converters:IsStringNonemptyConverter x:Key="ToolTipVisibilityConveter" />
</UserControl.Resources>

<TextBox Name="textBox" VerticalAlignment="Center" HorizontalAlignment="Center" Width="150"
         ToolTipService.ToolTip="{Binding Text, RelativeSource={RelativeSource Self}}"
         ToolTipService.IsEnabled="{Binding Text, RelativeSource={RelativeSource Self}, Converter={StaticResource ToolTipVisibilityConveter}}"/> 
```

转换器：

```
internal sealed class IsStringNonemptyConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return !String.IsNullOrEmpty(value as string);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-13T06:08:32.557

您可以使用触发器禁用工具提示。将此样式放置在您的窗口或应用程序资源中，以便可以根据您的选择在窗口或应用程序中的所有文本框之间共享它 -

```
<Style x:Key="{x:Type TextBox}" TargetType="TextBox">
  <Style.Triggers>
     <Trigger Property="ToolTip" Value="{x:Static sys:String.Empty}">
        <Setter Property="ToolTipService.IsEnabled" Value="False" />
      </Trigger>
</Style.Triggers> 
```

确保将系统命名空间添加到您的 xaml -

```
xmlns:sys="clr-namespace:System;assembly=mscorlib" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-18T19:56:12.070

我自己也遇到了这个问题，并想出了一个不同的解决方案。我知道这个问题已经得到解答，但就像我一样，仍然会有人遇到这个问题，我想分享我的解决方案：

**XAML**

```
<TextBox Name="textBox1" ToolTip="{Binding Text, RelativeSource={RelativeSource Self}}" ToolTipService.IsEnabled="False"/> 
```

**背后的代码**

```
private void textBox1_TextChanged(object sender, TextChangedEventArgs e)
{
    if (textBox1.Text.Length > 0)
    {
        ToolTipService.SetIsEnabled(textBox1, true);
    }
} 
```

我希望这可以帮助别人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T04:37:00.007

我尝试了可见性模式和 TextChange 事件。无文字时 ToolTip 不可见。可能对其他人有用。xml:

```
 <TextBox Height="23" Width="100" Name="myTextBox" TextChanged="myTextBox_TextChanged" >
        <TextBox.ToolTip>
            <ToolTip Visibility="Hidden">
                <TextBlock Name="toolTipTextBlock"></TextBlock>
            </ToolTip>            
        </TextBox.ToolTip>
    </TextBox> 
```

TextChange 事件处理程序：

```
 private void myTextBox_TextChanged(object sender, TextChangedEventArgs e)
    {
        TextBox tb = sender as TextBox;

        if (tb.Text.Trim() == "")
        {
            ((ToolTip)tb.ToolTip).Visibility = Visibility.Hidden;
        }
        else
        {
            toolTipTextBlock.Text = tb.Text;
            ((ToolTip)tb.ToolTip).Visibility = Visibility.Visible;
        }
    } 
```

# php - html5表单对提交没有反应

> ID：11925114
> 
> 赞同：1
> 
> 时间：2012-08-12T19:19:37.503
> 
> 标签：php, jquery, forms, html, form-submit

我有一个简单的一页表格，我已经写了几十次了，但这种行为对我来说是全新的。起初，它是在页面加载时提交的，因此会自动重定向到该系列的下一页。我仍然不确定我是如何让它停止的，但是现在当你点击“提交”时它根本没有做任何事情。该页面只是坐在那里。

我尝试删除错误检查脚本、显示/隐藏脚本，甚至 jquery 本身，然后将表单简化为一个输入。我尝试摆脱重定向并让它输出一个简单的行，然后是 vardump，但仍然没有。我点击提交，无论我做什么，页面都在那里。我以前从未遇到过这样的行为，firebug 等人没有给我任何错误或线索。

如果有人有任何想法，无论多么疯狂，我都愿意尝试。我不知所措。提前致谢！

```
<?php
session_start();
include('functions.php');

if ($_POST['submit']) {
    $company = $_POST['company'];
   $taxid = $_POST['taxid'];
   header("location:step2.php");
}
include('head.php'); ?>

<form method="post" name="basic" action="step1.php">

<div class="col70">
   <label for="company">Organization/Business name <img src="img/req.jpg" alt="required"></label>
   <input type="text" name="company" id="company" value="" />
</div>

<div class="col30">
   <label for="taxid">Taxpayer ID# (IEN or SS#) <img src="img/req.jpg" alt="required"></label>
   <input type="text" name="taxid" id="taxid" value="" />
</div>

<div class="newcol">
   <label for="address">Mailing Address <img src="img/req.jpg" alt="required"></label>
   <input type="text" name="address" id="address" value="" />
</div>

<div class="col30 newcol">
   <label for="city">City <img src="img/req.jpg" alt="required"></label>
   <input type="text" name="city" id="city" value="" />
</div>

<div class="col30">
   <label for="state">State <img src="img/req.jpg" alt="required"></label>
   <select name="state" id="state" tabindex="<?php echo $tabin; $tabin++; ?>">
       <option value="0"></option>
       <option value="1">Alabama</option>
   </select>
</div>

<div class="col25">
   <label for="zipcode">Zip Code <img src="img/req.jpg" alt="required"></label>
   <input type="text" name="zipcode" id="zipcode" value="" />
</div>

<fieldset><legend>1\. What kind of group/company do you have? <img src="img/req.jpg" alt="required"></legend>
   <span id="nfpfp" class="InputGroup">
       <label><input name="nfpfp" id="nfpfp_1" type="radio" value="1" />For-profit business.</label>
       <label><input name="nfpfp" id="nfpfp_2" type="radio" value="2" />Non-profit 501(c)3 organization.</label>
   </span>    
</fieldset>

<fieldset><legend>2\. How will you use the booth space? Select all that apply. <img src="img/req.jpg" alt="required"></legend>
   <span id="type" class="InputGroup">
       <label><input name="food" id="type_1" type="checkbox" value="1" />Food sales</label>
       <label><input name="retail" id="type_2" type="checkbox" value="2" />Retail sales</label>
       <label><input name="activity" id="type_3" type="checkbox" value="3" />Activity</label>
       <label><input name="display" id="type_4" type="checkbox" value="4" />Display</label>
       <label><input name="other" id="type_5" type="checkbox" value="5" />Other</label>
   </span>    
</fieldset>

<label for="otherdetails" class="newcol offsides">Enter a short description of your use. (Ex: "BBQ sandwiches", "kite kits", "face painting".) <img src="img/req.jpg" alt="required"></label> 
   <input type="text" name="otherdetails" id="otherdetails" value="" />

<fieldset><legend>3\. Select any/all that apply. Additional questions may appear, if further information is required.</legend>
   <span id="additional" class="InputGroup">
       <label><input name="raffle" id="raffle_1" type="checkbox" class="switchcheck1" value="1" />I'll be selling raffle tickets and/or holding a raffle at the festival.</label>
           <div class="newcol offstate1">
           <label for="raffledetails">You'll need written permission from the Exchange Club. Please enter details about the raffle. <img src="img/req.jpg" alt="required"></label>
               <textarea name="raffledetails" id="raffledetails" tabindex="<?php echo $tabin; $tabin++; ?>"></textarea>
           </div>

       <label><input name="trailer" type="checkbox" id="trailer_1" value="1">I'll be bringing a trailer.</label>
       <label><input name="outlets" type="checkbox" id="outlets_1" class="switchcheck2" value="1" />I'll require electrical outlets.</label>
           <div class="newcol offstate2">
           <label for="outletsdetails">How many outlets will you require? <img src="img/req.jpg" alt="required"></label>
               <input type="text" name="outletsdetails" id="outletsdetails" />
           </div>
       </span>    
</fieldset>

<input type="button" name="submit" class="a_button" value="submit" />

</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:21:48.107

`name="submit"`带有is 类型`button`和 not的元素`submit`，因此它呈现一个什么都不做的普通按钮（目的是您将一些 JavaScript 绑定到它）。

改为使用`type="submit"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:22:34.923

尝试

```
<input type="submit" name="submit" class="a_button" value="submit" /> 
```

为您的提交按钮。

# java - 如何在 Eclipse 中运行外部 .class 文件？

> ID：11925121
> 
> 赞同：0
> 
> 时间：2012-08-12T19:20:05.913
> 
> 标签：java, eclipse

我正在 Coursera 上上一门课程，作为测验的一部分，我应该下载他们的 xyz.class 并运行它。我想在eclipse中做，因为所有的jar文件都是在eclipse中添加的，我不想修改系统的类路径，因为它非常不整洁。

但我不知道如何运行外部 .class 文件？谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:23:00.037

为什么要在 Eclipse 中运行它？

> java类名

souhld 做的伎俩。如果没有在其类路径中创建包含此类的 java 项目，则无法使用 Eclipse 运行具有 main 方法的外部类文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T19:23:49.587

右键单击您的 Eclipse 项目、构建路径、配置构建路径、库、添加（外部？）类文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T19:26:00.707

赶紧跑

```
java xyz 
```

日食可能不需要。

如果您想真正通过 Eclipse 解决问题，请参阅**[如何在 Eclipse 的项目中包含 .class 文件？(Java)](https://stackoverflow.com/a/661143/500725)**答案。

还有另一种不使用eclipse的方法。

方法是`creating a executable jar file`包含所有必需的库 & `xyz.class`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T19:24:56.903

右键单击包资源管理器中的类文件 -> 运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-14T13:40:30.270

转到文件>>新项目>>导入>>添加可执行jar文件>>选择您存储.class文件的路径>>检查工作场所中的包含

> > 申请>>好的>>>>>>>>>>>>>>>>>>>>完成

# markdown - Markdown：代码示例中的额外标记？

> ID：11925129
> 
> 赞同：0
> 
> 时间：2012-08-12T19:21:00.237
> 
> 标签：markdown

如果您在代码示例中，Markdown（基本，以及：Markdown Extra 和 Github 版本）会忽略任何和所有标记（MD 本身，HTML）。如果您需要手动突出显示代码示例中的某些内容 - 忘记它。

用例：在您的代码示例中，您需要强调特定的行。理想情况下，您应该能够使用 _lines of code_ 或 <em>lines of code</em> 包装该行，然后在 CSS 中使用以下内容很好地突出显示：

```
pre em {background-color: yellow} 
```

似乎没有办法用当前的 MarkDown 处理器来做这样的事情？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T01:09:10.017

您可以在 markdown 中使用原始 HTML。因此，只需执行以下操作：

```
<pre><code>
boring line
<em>exciting line</em>
</code></pre> 
```

当然，您必须记住将任何`"`,`&`和`<`字符作为实体进行转义。如果这很乏味，您可以使用 markdown 来执行此操作，然后将它生成的 HTML（带有您添加的 em 标签）粘贴到您的 markdown 源代码中。

# html - 放大和缩小时横幅左右移动

> ID：11925132
> 
> 赞同：0
> 
> 时间：2012-08-12T19:21:12.677
> 
> 标签：html, css, ads, banner

当我缩小时它向左移动，当我放大时它向右移动这是我的代码：

```
.google {
position:absolute;
display:block;
right:200px;
width:728px;
top:90px;
border-left: 1px solid black;
} 
```

我该如何解决？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T04:41:27.407

嘿，现在像这样给**身体** `min-width`

```
body{
min-width:1000px;
} 
```

* * *

我看到你的布局我发现一些错误在你的样式表中添加到这个 css 并删除了搜索表单的一些错误

**如果你需要**

```
.onethousand_wrap {
    height: 30px;
    margin: 0 auto;
    overflow: hidden;
    position: relative;
    width: 1000px;
} 
```

# x86 - 进化算法是否有可能创建机器代码？

> ID：11925142
> 
> 赞同：8
> 
> 时间：2012-08-12T19:22:20.537
> 
> 标签：x86, genetic-algorithm, genetic-programming, evolutionary-algorithm

这是一个普遍感兴趣的问题，因为我不是试图解决一个特定的问题。我环顾四周，试图找到一些涵盖该领域的文章，但我什至很难将一些好的搜索词放在一起。

让我们从我所知道的开始：我接受过大学水平的人工智能教育，包括基因编程和更广泛的进化算法类，尽管自从我十年前毕业以来，我并没有经常接触它们。我想知道这些方法是否可以用来创建机器代码来解决问题（也许是 x86，或者一些“任意”指令集）。我们能否发展算法本身，例如可以计算平方根或在屏幕上绘制令人愉悦的图像？是否可以使用进化算法来创建创建优化代码（针对大小、速度等）的*整个编译器？*

此外，我经常认为遗传编程或进化算法本身并不是物种进化的良好证据。涉及进化算法的问题解决方法似乎总是需要将智能写入其中。一个人如何创建一个真正的进化算法，从而真正产生真正有趣和令人惊讶的结果？

TLDR：进化算法的使用在创建一种机器代码时是否有用，以前有没有进化算法*的例子通常*产生真正有趣和令人惊讶的结果？

缺口

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-12T19:47:50.027

使自然进化发挥作用的一件事是它是非常开放的。你只需要找到一种方式，任何方式，传递你的基因，而且成功率各不相同。

相比之下，程序被期望做一些非常具体的事情，通常要么工作要么不工作。对于遗传算法，小的变化需要能够贡献小的（或大的）改进，以便在适应度环境中攀升。但是程序的健身环境是可怕的。

换句话说：有无数个程序“几乎”对列表进行排序，这些程序*与*对列表进行排序的程序*完全不同*，因此不能通过一个小的突变变成一个。大多数对列表*进行*排序的程序也会因为一个突变而严重破坏，而不是产生几乎正确的结果，无论这意味着什么。这些结合起来意味着很难通过小渐进程度的进化来产生这样的算法（或任何算法）。

 **至少，当我尝试做类似的事情时，我认为这是我学到的。我很想被证明是错误的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T20:01:11.013

GP可以生成可执行代码吗？当然！只需使用 LISP。

John Koza 很久以前就确立了您可以使用基因编程来创建程序。[http://www.genetic-programming.com/johnkoza.html](http://www.genetic-programming.com/johnkoza.html)他写了两本关于这个主题的厚书。

大多数 GP 在 LISP 中完成的原因是机器代码非常结构化，因此对于您的基因组到表型映射“让 00000 是 MOV，让 00001 是 JNE 等”是不可行的。相反，您基本上*必须*使用更复杂的编码。S 表达式作为真正明显的构建块出现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T19:41:39.190

我知道至少一种称为[FINCH](http://finch.cs.bgu.ac.il/)的方法，它是一种进化 Java 字节码的方法。他们的网站上有一些演示文稿和参考出版物。我认为字节码可能比 x86 机器码更容易进化，因为它是堆栈机器而不是寄存器机器的代码。寄存器机器要复杂得多，因为您需要将写指令的寄存器与读指令对齐。在堆栈机器上，您只需将一个值压入堆栈，下一个操作就会读取它。**

# c - 如何输入一个文件并用它来计算大小写字母、数字和标点符号？

> ID：11925144
> 
> 赞同：0
> 
> 时间：2012-08-12T19:22:39.987
> 
> 标签：c

我的目标很简单。向用户询问包含大写/小写字母、数字和标点符号的简单文本文件。然后获取文件，打开它，并扫描上述每个元素，并记录每个元素。最后，为每个输出一个总数（即包含的总大写字母、总小写字母、总数字和总标点符号）。

不幸的是，我的问题并不是那么简单。我对 C 将输入文件传递给 fgetc 之类的函数然后对其进行测试以增加计数器的方式究竟是如何（即概念和语法）感到困惑。我的程序崩溃了，我的想法很少。我想我最初的问题是，为什么它会崩溃？我的代码如下；

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>

int main()
{
    char Character = 0;
    int words = 0;
    int upper_case = 0;
    int lower_case = 0;
    int punctuation = 0;
    int digits = 0;
    int entered_words = 0;
    char user_filename[100];
    char user_filecontent[100];

    printf("Enter the filename of the file containing text and/or digits:\n");
    printf("(hit the Enter key when done)\n");
    gets(user_filename);

    FILE *fp;
    fp = fopen (user_filename, "r");

    if (fp == NULL)
    {
        printf("\nError, Unable to open the file for reading\n");
    }

    while((fp = fgetc(fp)) != EOF)
    {

            while((Character=fgetc(fp)) != '\n');
            {

                if (isalnum (Character))
                {
                    if (!entered_words)
                    {
                        entered_words = 1;
                        words++;
                    }
                }

                else
                {
                    if (entered_words)
                    {
                        entered_words = 0;
                    }
                }

                if (isupper(Character))
                {
                    upper_case++;
                }

                else if (islower(Character))
                {
                    lower_case++;
                }

                else if (isdigit(Character))
                {
                    digits++;
                }

                else if (ispunct(Character))
                {
                    punctuation++;
                }

            }

    fclose(fp);
    }

    printf("Total number of words is %d.\n", words);
    printf("Total number of digits are %d.\n", digits);
    printf("Total number of uppercase letters is %d.\n", upper_case);
    printf("Total number of lowercase letters is %d.\n", lower_case);
    printf("Total number of punctuation characters is %d.\n", punctuation);

return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:39:10.180

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>

int main()
{
    char Character = 0;
    int words = 0;
    int upper_case = 0;
    int lower_case = 0;
    int punctuation = 0;
    int digits = 0;
    int entered_words = 0;
    char user_filename[100];
    char user_filecontent[100];

    printf("Enter the filename of the file containing text and/or digits:\n");
    printf("(hit the Enter key when done)\n");
    gets(user_filename);

    FILE *fp;
    fp = fopen (user_filename, "r");

    if (fp == NULL)
    {
        printf("\nError, Unable to open the file for reading\n");
    }

    while((Character = fgetc(fp)) != EOF)
    {

                if (isalnum (Character))
                {
                    if (!entered_words)
                    {
                        entered_words = 1;
                        words++;
                    }
                }

                else
                {
                    if (entered_words)
                    {
                        entered_words = 0;
                    }
                }

                if (isupper(Character))
                {
                    upper_case++;
                }

                else if (islower(Character))
                {
                    lower_case++;
                }

                else if (isdigit(Character))
                {
                    digits++;
                }

                else if (ispunct(Character))
                {
                    punctuation++;
                }
    }

    fclose(fp);

    printf("Total number of words is %d.\n", words);
    printf("Total number of digits are %d.\n", digits);
    printf("Total number of uppercase letters is %d.\n", upper_case);
    printf("Total number of lowercase letters is %d.\n", lower_case);
    printf("Total number of punctuation characters is %d.\n", punctuation);

return 0;
} 
```

我删除了内部的 while 循环，并将 fclose 函数调用移到了循环之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:24:54.213

您在 while 测试中分配给您`FILE *fp`的结果：`fgetc`

```
while((fp = fgetc(fp)) != EOF) 
```

这可能是您崩溃的原因。`fp`是您调用后文件的句柄`fopen`，之后您只需要将其传递给接受 a `FILE *`、like`fgetc`和. 的函数`fclose`。

此外，您要调用`fgetc`两次：一次在`while`测试中，然后立即在另一次`while`测试中进行。即使您解决了`fp`问题，您也会以这种方式丢失字符。为什么需要内循环？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T19:25:32.860

男人 fgetc 告诉

> fgetc() 从流中读取下一个字符，并将其作为 unsigned char 转换为 int 或文件末尾的 EOF 或错误返回。

您必须使用 int 变量来存储此结果

# objective-c - MKNetworkKit - 显示缓存的图像

> ID：11925150
> 
> 赞同：0
> 
> 时间：2012-08-12T19:23:37.243
> 
> 标签：objective-c, ios, mknetworkkit

**底部更新**

为此，我从 MKNetworkKit Flickr 演示中分离出来。我想在表格中显示的网络服务器上有几张图像。我有一个 UITableViewCell 子类 ImageCell。

这是检索远程图像的自定义方法：

```
-(void)setImageForCell:(NSString *)remoteFileName {

    self.loadingImageURLString =
    [NSString stringWithFormat:@"http://myserver.com/%@.png",remoteFileName];
    self.imageLoadingOperation = [ApplicationDelegate.imageDownloader imageAtURL:[NSURL URLWithString:self.loadingImageURLString]
                            onCompletion:^(UIImage *fetchedImage, NSURL *url, BOOL isInCache) {

                                if([self.loadingImageURLString isEqualToString:[url absoluteString]]) {

                                    if (isInCache) {
                                        self.imageView.image = fetchedImage;
                                        [self.contentView drawRect:self.contentView.frame];
                                        NSLog(@"Image is in cache");
                                    } else {
                                        self.imageView.image = fetchedImage;
                                        [self.contentView drawRect:self.contentView.frame];
                                        NSLog(@"Image is not in cache");
                                    }
                                }
                            }];   
}
    //TableView.h
    //it is called like this
   //in cellForRowAtIndexPath...
   ImageCell *cell = (ImageCell *)[tableView dequeue...etc];
 MyObject *obj = [dataSource objectAtIndex:indexPath.row];
 cell.textLabel.text = obj.name;
 [cell setImageForCell:obj.name];
 return cell; 
```

我检查了我的默认缓存目录的内容，现在里面有项目。现在不断滚动表格会打印“图像在缓存中”。问题是，单元格的 imageView 永远不会更新。Mugunth 有一个类方法 automaticallyNotifiesObserversForKey: 但我从来没有看到它在任何地方实现。我猜还有另一个步骤是告诉 tableView 实例用新内容更新该行。

感谢您的输入。

**更新**

我通过使用带有 Cell 和 UIImageView IBOutlet 的自定义 Interface Builder xib 文件来实现这一点。不知道为什么它不能与 self.imageView.image 一起使用，并且有兴趣确切地找出原因。我仍然认为这是一个悬而未决的问题，因为我只想使用标准的 UITableViewCell 类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T02:06:46.570

我调用prepareForReuse。您是否将 self.imageView.image 设置为零？如果是，请不要这样做，因为它看起来从未重新初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T02:37:15.500

你为什么从你的代码中调用“drawRect”。那是亵渎！检查您的 imageView 并检查 IB 连接是否良好。

# php - wordpress 内容过滤器导致图像链接中断

> ID：11925151
> 
> 赞同：0
> 
> 时间：2012-08-12T19:23:37.900
> 
> 标签：php, wordpress, utf-8, domdocument

我写了一个插件来删除博客非注册成员的链接，但是插件导致图片链接出错，下面是我写的内容过滤器：

```
if ( is_user_logged_in() ) {
    // Do nothing.  All is well.
} else {
    $doc = new DOMDocument();
    $doc->loadHTML($content);
    $dom_xpath = new DOMXpath($doc);

    foreach($doc->getElementsByTagName('a') as $link)
        $link->setAttribute('href', $UNREGISTERED_LINK_HREF);

    $texts = $dom_xpath->query('//a/child::text()');
    foreach ($texts as $text)
    {
        $text->data = $UNREGISTERED_LINK_TEXT;
    }

    $content = $doc->saveHTML();

} 
```

正确的图片链接： [http ://electrouniverse.net/wp-content/uploads/2012/08/Kyle-Geiger-%E2%80%93-Relentless-SOMA343D-240x240.jpg](http://electrouniverse.net/wp-content/uploads/2012/08/Kyle-Geiger-%E2%80%93-Relentless-SOMA343D-240x240.jpg)

过滤链接后： [http ://electrouniverse.net/wp-content/uploads/2012/08/Kyle-Geiger-%C3%A2%C2%80%C2%93-Relentless-SOMA343D-240x240.jpg](http://electrouniverse.net/wp-content/uploads/2012/08/Kyle-Geiger-%C3%A2%C2%80%C2%93-Relentless-SOMA343D-240x240.jpg)

我尝试使用 utf8_decode() 和 utf8_encode() 来解决这个问题，但它没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:00:20.253

在之前使用以下内容`$doc->loadHTML($content);`：

```
$content = mb_convert_encoding($content, 'HTML-ENTITIES', 'UTF-8'); 
```

# php - 使用 MySQL 连接

> ID：11925152
> 
> 赞同：1
> 
> 时间：2012-08-12T19:23:44.543
> 
> 标签：php, mysql

用户在我的网站上可以有两种类型的关系。关注或朋友。我想用与他们有关系的用户的帖子填充每个用户的新闻提要。到目前为止，我有这个加入：

```
SELECT  * 
FROM    posts a 
        LEFT JOIN relationships b
            ON a.user_id = b.user_2
WHERE   b.user_1 = $user_id AND 
    b.status IN (1,3,4) OR a.user_id = $user_id
ORDER BY a.post_id DESC 
```

b.status 是我的关系表中确定两个用户之间关系状态的列。1 正在关注，3 是朋友，4 正在关注待处理的好友请求。我的加入效果很好，除了它没有考虑到我的“关系”表中只有一行可以代表任何两个人之间的朋友船。下面有两行。第一个是用户 1(mark) 跟随用户 2(matt) 和用户 2(matt) 跟随用户 1(mark)。但是对于友谊，它要么是一种方式，要么是另一种方式，状态为 3。首先，这是明智的做法吗？或者我也应该为这种类型的 pf 关系设置两行？第二，我怎样才能让我的 JOIN QUERY 也从 user_1 和 user_2 之间存在关系且状态 = 3 的用户那里获取帖子？不考虑 user_1 和 user_2 的顺序？

表结构：

```
Posts:

| user_id | post_id | story |
-----------------------------
|  1      |  1      | text. |
-----------------------------

Relationships:

| rel_id  | user_1  | user_2| status |
--------------------------------------
|  1      |  1      |   2   |    3   |
-------------------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:57:13.307

在您的`WHERE`声明中，执行类似的操作，以便匹配关系表中的任一列。`OR`得到他们两个。

```
WHERE   b.user_1 = $user_id OR b.user_2 = $user_id 
```

祝你好运！

# javascript - 从 Bootstrap Typeahead 中的数据属性中调用函数？

> ID：11925153
> 
> 赞同：1
> 
> 时间：2012-08-12T19:23:45.387
> 
> 标签：javascript, twitter-bootstrap

Twitter bootstrap 提供了一个特殊的输入元素。但我正在尝试使用 javascript 函数填充其属性之一。

```
<input type="text" data-provide="typeahead" data-source="return fun()">

<script>
function fun()
{
  return "["apple", "bananas"]";
}
</script> 
```

但这似乎不起作用。

**编辑**：

正如 Moin Zaman 所指出的那样尝试过，

[http://jsbin.com/enacof/5](http://jsbin.com/enacof/5)

但还是不行。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:26:18.837

您的双引号用法不太正确。

尝试：

```
 return "['apple', 'bananas']"; 
```

您的代码应该在浏览器中引发脚本错误。

这也不起作用，因为[Bootstrap Typeahead](http://twitter.github.com/bootstrap/javascript.html#typeahead)参考和代码显示`data-source`直接用作字符串，而不是`eval`作为 js 函数运行。

另一种方法是：

```
$('.typeahead').typeahead({source:"['apple', 'bananas']"}) 
```

你也可以试试：

```
$('.typeahead').typeahead({source: fun()}) 
```

或者：

```
var data = fun();
$('.typeahead').typeahead({source: data}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:26:19.807

也许这更好？

```
 return '["apple", "bananas"]'; 
```

# spring - 处理请求，FilterDispatcher 与 DispatcherServlet

> ID：11925161
> 
> 赞同：0
> 
> 时间：2012-08-12T19:24:46.933
> 
> 标签：spring, struts2

对于请求处理，struts 2 使用`FilterDispatcher`，而 Spring 使用 Servlet(dispatcher servlet) 来分派请求。这有什么区别？我的意思是他们正在做同样的工作，处理传入的请求，但使用不同的策略，一个是使用 servlet，另一个是使用过滤器调度程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T04:48:07.867

`Struts2` and `spring mvc` are different web frameworks that follow `mvc` design pattern. The architecture of both differs. Since they are different frameworks, they have different ways of achieving the same thing i.e. request handling. You can read more about `FilterDispatcher` [here](http://struts.apache.org/2.1.6/struts2-core/apidocs/org/apache/struts2/dispatcher/FilterDispatcher.html).

# c - 这种操作“a = x”或“a++”等是如何调用的？

> ID：11925164
> 
> 赞同：0
> 
> 时间：2012-08-12T19:25:01.300
> 
> 标签：c, compiler-construction

编写编译器的人怎么称呼它？我知道这`int a, b, c;`叫做表达式。但是像这样的事情：`int a = 2`？或者`a++`，`a=c`等等我不知道。我在哪里可以找到这些术语？C 标准还是买一本关于编译器构造的书？我希望这很清楚。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T19:28:07.370

```
int a, b, c; 
```

这不是一个表达。这是一个[声明](http://en.wikipedia.org/wiki/Declaration_%28computer_programming%29)。

```
int a = 2; 
```

这也是一种宣言。该`2`部分是[初始化程序](http://en.wikipedia.org/wiki/Initialization_%28programming%29#Initializer)。

```
a ++ 
```

这是一个“[后增量](http://en.wikipedia.org/wiki/Increment_and_decrement_operators)”[表达式](http://en.wikipedia.org/wiki/Expression_%28computer_science%29)。请注意，在 C 世界之外，这可能只是一个[声明](http://en.wikipedia.org/wiki/Statement_%28computer_science%29)。

```
a = c 
```

这是一个[赋值](http://en.wikipedia.org/wiki/Assignment_%28computer_programming%29)表达式（同样，在 C 语言之外，这可以是一个语句）。

* * *

这些术语的确切定义和 C 的每种语法***的***分类可以在 C 标准（第 6 章：语言）中找到，您可以从[哪里找到当前的 C 或 C++ 标准文档？](https://stackoverflow.com/questions/81656/where-do-i-find-the-current-c-or-c-standard-documents).

请注意，这些仅适用***于 C***（及其大多数衍生工具，例如 C++、Javascript 等）。这些概念在其他语言中可能没有意义（例如，某些语言不区分语句和表达式）。

# javascript - JS——检查长度函数

> ID：11925165
> 
> 赞同：1
> 
> 时间：2012-08-12T19:25:04.063
> 
> 标签：javascript, php

我有代码：

```
function check($ile,$co,$gdzie)
{
  if (document.forms.form.$co.value.length >= $ile){
    document.forms.form.$gdzie.focus();
  }
} 
```

而且它不起作用。错误（在谷歌浏览器中检查）：

```
Uncaught TypeError: Cannot read property 'value' of undefined script.js:39
check script.js:39
onkeyup 
```

这是我的html代码：

```
<p><label><?php echo TEL; ?>: <input type='text' name='tel' size='9' maxlength='9' onkeypress="keyPressNumb(event);" onKeyUp="check(9,'tel','pesel');"></label></p>
<label><?php echo PESEL; ?>:<span class='red'>*</span> <input type='text' name='pesel' size='11' maxlength="11" onKeyUp="check11();" onkeypress="keyPressNumb(event);"></label></p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:47:50.117

尝试`document.forms.form[$co].value.length`，因为在通过点表示法访问对象的值时不能使用变量。

在您的代码中，js 期望在 object 中有一个属性*$co*`document.forms.form`。当您想通过变量访问属性时，您必须使用方括号来访问该属性。

```
document.bar = "hello world";

var foo = "bar";
document.foo // undefined, because document has no property "foo"
document[foo] // "hello world" 
```

# sql-server-2008-r2 - 在存储过程（SQL Server 2008 R2 SP2）中，是否可以在没有临时表变量的情况下返回 NewSequentialID()？

> ID：11925166
> 
> 赞同：1
> 
> 时间：2012-08-12T19:25:22.760
> 
> 标签：sql-server-2008-r2, temp-tables, newsequentialid

在存储过程中（使用 SQL Server 2008 R2 SP2）是否可以在`NewSequentialID()`没有临时表变量的情况下返回 a？

`NewSequentialID()`我可以通过使用临时表成功获得：

[在插入时获取 NEWSEQUENTIALID() 的值](http://brian.dobberteen.com/code/getting-value-of-newsequentialid-on-insert/)

也许我是老派，但除非绝对必要，否则我尽量避免使用临时表……尽管这可能是绝对必要的情况……</p>

如果我尝试：

```
DECLARE @NewSequentialID UNIQUEIDENTIFIER;
SET @NewSequentialID = NEWID() 
```

......它按预期工作。

如果我尝试：

```
DECLARE @NewSequentialID UNIQUEIDENTIFIER;
SET @NewSequentialID = NEWSEQUENTIALID() 
```

…我收到以下错误：

> *newsequentialid() 内置函数只能用于 CREATE TABLE 或 ALTER TABLE 语句中类型为“uniqueidentifier”的列的 DEFAULT 表达式。它不能与其他运算符组合形成复杂的标量表达式。*

*   是使用临时表方法的唯一解决方案吗？
*   有谁知道微软为什么在`NEWSEQUENTIALID()`to work like之间实现区别的原因`NEWID()`？
*   任何人都知道微软是否有机会更新`NEWSEQUENTIALID()`为像这样工作`NEWID()`？

地理

更新——我不确定微软为什么选择以这种方式实现该方法，因为他们声明“NEWSEQUENTIALID 是 Windows UuidCreateSequential 函数的包装器”......但似乎没有非临时变量表法。（至少到目前为止。）
感谢大家的评论/回答。[主持人注意：]当答案是“不可能”时，我不确定如何处理问题。所以我要感谢@marc_s 详细介绍了一种解决方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:29:46.243

**目前**-`newsequentialid()`只能用作列的默认约束。这也是错误消息非常清楚地说明的内容。

 **所以为了得到你的顺序 GUID - 你必须有一个表。没有其他方法可以做到这一点。在 SQL Server 2012 中也没有其他方法。

我不知道也没有任何信息说明为什么会有这样的差异，以及为什么微软选择以这种方式实现它......

**更新：**

好的，所以您需要获取插入到表中的值 - 使用该[`OUTPUT`子句](http://msdn.microsoft.com/en-us/library/ms177564.aspx)怎么样？

就像是：

```
DECLARE @NewIDs TABLE (NewSeqID UNIQUEIDENTIFIER)

INSERT INTO dbo.YourTable(list-of-columns)
OUTPUT INSERTED.NewSeqID INTO @NewIDs(NewSeqID)
VALUES (.........) 
```

这样，`INSERT`操作的输出 - 新创建的顺序 GUID - 被存储到该表变量中，您可以使用它，返回它，切片它 - 任何你喜欢的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T19:36:00.657

微软官方的说法是：

> NEWSEQUENTIALID() 只能与 uniqueidentifier 类型的表列上的 DEFAULT 约束一起使用。例如： CREATE TABLE myTable (ColumnA uniqueidentifier DEFAULT NEWSEQUENTIALID())

此处描述 [http://msdn.microsoft.com/en-us/library/ms189786.aspx](http://msdn.microsoft.com/en-us/library/ms189786.aspx)

NewID generates a random number and the other is the next sequential number.**

# android - 我可以在一个移动应用程序中拥有年度订阅和充值功能吗

> ID：11925171
> 
> 赞同：0
> 
> 时间：2012-08-12T19:25:33.560
> 
> 标签：android, blackberry, in-app-purchase, itunes, in-app-billing

我想制作一个移动应用程序，用户需要每年购买许可证才能继续使用它。一旦他们从应用商店/市场购买它，他们将获得一年订阅加上 10 点积分，他们需要这些积分用于应用程序的特定部分。每当他们想使用应用程序的特定部分时，他们必须有足够的积分。否则，他们可能会充值。

这在 iTunes、Google Play 和 BlackBerry App World 中是否可行？我的意思是我可以在一个应用程序中拥有年度订阅和充值功能。

并且，未使用的积分可以在下次订阅时结转吗？万一许可证已经结束，但没有学分！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T08:27:30.547

听起来您需要订阅和一次性购买收入模式。订阅模型实现起来相当简单，无需向您的应用添加太多代码即可实现。您的用户将被收取定期（每月/每年）费用才能使用您的应用程序。

积分/积分模型将要求您跟踪应用内用户的积分余额。您可以在用户可以购买的各种商店中设置虚拟商品以获得更多积分，例如

```
10 points - $0.99
30 points - $1.99 
```

您可能还需要考虑用户在更换设备后如何将余额转移到新手机上。（注：在黑莓平台上这是强制性的，不能在其他平台上建议）。

黑莓、Android 和 iOS 平台均支持这两种收入模式。此处的文档：[iOS](https://developer.apple.com/appstore/in-app-purchase/index.html)、[Android](http://developer.android.com/guide/google/play/billing/index.html)、[黑莓](https://developer.blackberry.com/appworld/payment/)。

# html - 一个href不工作

> ID：11925173
> 
> 赞同：0
> 
> 时间：2012-08-12T19:25:37.320
> 
> 标签：html, menu, href

我正在尝试使用相同的代码制作这种风格的菜单：http: [//www.jeremymartin.name/examples/kwicks.php?example= 1](http://www.jeremymartin.name/examples/kwicks.php?example=1)

我添加了链接，但它们不起作用。他们为什么不呢？

这是我的代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0  Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
    <head>
        <link rel="stylesheet" type="text/css" href="css/main.css" />

        <script src="js/jquery-1.2.6.min.js" type="text/javascript"></script>
        <script src="js/jquery.easing.1.3.js" type="text/javascript"></script>
        <script src="js/jquery.kwicks-1.5.1.pack.js" type="text/javascript"></script>

        <script type="text/javascript">
            $().ready(function() {
                $('.kwicks').kwicks({
                    max : 220,
                    spacing : 5
                });
            });
        </script>
    </head>

    <body>
        <ul class="kwicks horizontal" >
            <li id="kwick_1" a href="#"></a></li>
            <li id="kwick_2" a href="#"></a></li>
            <li id="kwick_3" a href="#"></a></li>
            <li id="kwick_4" a href="#"></a></li>
        </ul>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:27:41.897

您的 HTML 无效。未`li`关闭且`a`标签未打开。

这应该是：

```
 <li id="kwick_1"> <a href="#"></a></li>
        <li id="kwick_2"> <a href="#"></a></li>
        <li id="kwick_3"> <a href="#"></a></li>
        <li id="kwick_4"> <a href="#"></a></li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:30:56.287

你需要更换

```
<li id="kwick_1" a href="#"></a></li> 
```

和

```
<li id="kwick_1"><a href="#">name of the link</a></li> 
```

# javascript - 浏览器在函数执行期间停止响应事件，破坏“可拖动”

> ID：11925175
> 
> 赞同：1
> 
> 时间：2012-08-12T19:25:49.813
> 
> 标签：javascript, jquery-ui, draggable, event-listener, single-threaded

我有一个有点像这样的滑块：

```
 ________
------------|        |---------------------------------------
   :    <-- | slider | -->    :        :        :        :
------------|________|--------------------------------------- 
```

我正在使用 jQuery UI 使滑块可拖动。这工作正常。

问题是每次滑块越过部分边界（由 表示`:`）时，我都在执行一个函数。该函数执行大约需要 30 毫秒（它正在构建 DocumentFragment 并将其插入到文档中）。在此期间浏览器不响应事件，因此 jQuery UI 停止调整滑块的位置并且拖动提前结束（用户被迫释放鼠标按钮并开始新的拖动）。这使滑块感觉生涩和错误。

这个问题有解决方案吗？

**编辑：**我创建了一个简单的[小提琴](http://jsfiddle.net/nKgd7/)来演示这个问题。请注意，虽然在执行慢速函数期间拖动实际上是暂停的，但它会在之后恢复。这让我怀疑我的更复杂的场景中有一些东西导致拖动事件被缩短（也许 DOM 操作导致滑块的位置短暂改变）。

**编辑：**经过进一步调查，我更接近于理解这个问题。DOM 操作代码包含类似`$('.droppable').remove()`. 这会在分离绑定到它们的任何事件处理程序并删除任何关联数据后从 DOM 中删除匹配的元素。如果我`.detach()`改用，则行为与上面的简单小提琴相同。清理期间发生了一些不愉快的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:11:57.783

我建议使用 jQuery 或 Underscore 的`debounce`函数，或一些等效的方法，每 100 或 200 毫秒左右调用一次该函数。

这不会让事情变得顺利，但至少他们不会觉得有问题。

[关于它的有趣文章](http://hybernaut.github.com/blog/2012/04/22/throttle-and-debounce/)。

# android - 日期选择器不起作用

> ID：11925183
> 
> 赞同：0
> 
> 时间：2012-08-12T19:26:31.783
> 
> 标签：android, android-layout

我正在尝试`DatePicker`在我的 Android 应用程序中使用。当我将它添加到我的布局时，我收到以下消息：

```
The following classes could not be instantiated:
- android.widget.DatePicker (Open Class, Show Error Log)
See the Error Log (Window > Show View) for more details. 
```

所以我查看了错误日志，这就是我所看到的：

```
android.widget.DatePicker failed to instantiate.
java.lang.NoClassDefFoundError: java/nio/charset/Charsets
    at android.net.Uri.decode(Uri.java:1927)
    at android.net.Uri$AbstractPart.getDecoded(Uri.java:1957)
    at android.net.Uri$StringUri.getAuthority(Uri.java:579)
    at android.provider.Settings$NameValueCache.getString(Settings.java:727)
    at android.provider.Settings$System.getString(Settings.java:846)
    at android.text.format.DateFormat.getDateFormatString(DateFormat.java:393)
    at android.text.format.DateFormat.getDateFormatOrder(DateFormat.java:364)
    at android.widget.DatePicker.reorderSpinners(DatePicker.java:511)
    at android.widget.DatePicker.<init>(DatePicker.java:280)
    at android.widget.DatePicker.<init>(DatePicker.java:145)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.instantiateClass(ProjectCallback.java:402)
    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.loadView(ProjectCallback.java:166)
    at android.view.BridgeInflater.loadCustomView(BridgeInflater.java:207)
    at android.view.BridgeInflater.createViewFromTag(BridgeInflater.java:135)
    at android.view.LayoutInflater.rInflate_Original(LayoutInflater.java:746)
    at android.view.LayoutInflater_Delegate.rInflate(LayoutInflater_Delegate.java:64)
    at android.view.LayoutInflater.rInflate(LayoutInflater.java:718)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:372)
    at com.android.layoutlib.bridge.impl.RenderSessionImpl.inflate(RenderSessionImpl.java:321)
    at com.android.layoutlib.bridge.Bridge.createSession(Bridge.java:331)
    at com.android.ide.common.rendering.LayoutLibrary.createSession(LayoutLibrary.java:325)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderService.createRenderSession(RenderService.java:372)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.renderWithBridge(GraphicalEditorPart.java:1640)
    at [SNIPPED FOR LENGTH; SEE REVISION HISTORY FOR FULL TRACE -ed] 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T11:54:15.057

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/btnChangeDate"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Change Date" />

    <TextView
        android:id="@+id/lblDate"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Current Date (M-D-YYYY): "
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <TextView
        android:id="@+id/tvDate"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text=""
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <DatePicker
        android:id="@+id/dpResult"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />
 </LinearLayout>

import java.util.Calendar;
import android.app.Activity;
import android.app.DatePickerDialog;
import android.app.Dialog;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.DatePicker;
import android.widget.TextView;

public class MyAndroidAppActivity extends Activity {

    private TextView tvDisplayDate;
    private DatePicker dpResult;
    private Button btnChangeDate;

    private int year;
    private int month;
    private int day;

    static final int DATE_DIALOG_ID = 999;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        setCurrentDateOnView();
        addListenerOnButton();

    }

    // display current date
    public void setCurrentDateOnView() {

        tvDisplayDate = (TextView) findViewById(R.id.tvDate);
        dpResult = (DatePicker) findViewById(R.id.dpResult);

        final Calendar c = Calendar.getInstance();
        year = c.get(Calendar.YEAR);
        month = c.get(Calendar.MONTH);
        day = c.get(Calendar.DAY_OF_MONTH);

        // set current date into textview
        tvDisplayDate.setText(new StringBuilder()
            // Month is 0 based, just add 1
            .append(month + 1).append("-").append(day).append("-")
            .append(year).append(" "));

        // set current date into datepicker
        dpResult.init(year, month, day, null);

    }

    public void addListenerOnButton() {

        btnChangeDate = (Button) findViewById(R.id.btnChangeDate);

        btnChangeDate.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                showDialog(DATE_DIALOG_ID);

            }

        });

    }

    @Override
    protected Dialog onCreateDialog(int id) {
        switch (id) {
        case DATE_DIALOG_ID:
           // set date picker as current date
           return new DatePickerDialog(this, datePickerListener, 
                         year, month,day);
        }
        return null;
    }

    private DatePickerDialog.OnDateSetListener datePickerListener 
                = new DatePickerDialog.OnDateSetListener() {

        // when dialog box is closed, below method will be called.
        public void onDateSet(DatePicker view, int selectedYear,
                int selectedMonth, int selectedDay) {
            year = selectedYear;
            month = selectedMonth;
            day = selectedDay;

            // set selected date into textview
            tvDisplayDate.setText(new StringBuilder().append(month + 1)
               .append("-").append(day).append("-").append(year)
               .append(" "));

            // set selected date into datepicker also
            dpResult.init(year, month, day, null);

        }
    };

} 
```

阅读此代码可能对您有所帮助

# sql-server-2008-r2 - 复合主键索引维护

> ID：11925188
> 
> 赞同：0
> 
> 时间：2012-08-12T19:27:04.047
> 
> 标签：sql-server-2008-r2, indexing

在大表上有一个由 3 部分组成的复合键 Int、Int、Int 插入速度因碎片而降低

PK1 不分片（插入按顺序排列，从未修改过）但 PK2 和 PK3 分片严重而迅速

我应该使用什么策略来维护索引？

有没有办法重建索引？

```
PK1 fill factor 100 
PK2 fill factor 10
PK3 fill factor 10 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T04:46:30.480

不-它是一个索引-单个索引的列上不能有不同的填充因子......索引结构由条目组成，`(PK1, PK2, PK3)`并且这个元组组合存储在页面上。您只能为索引/页面设置填充因子 - 而不是为复合索引的各个部分设置填充因子。

我的典型方法是在我怀疑有碎片的索引上使用 70% 或 80% 之类的东西，然后观察。看看它碎片的速度和严重程度。如果当天晚些时候无法忍受 - 进一步降低填充因子。通常，使用 70-80% 的填充因子，您在白天应该没问题，如果您每晚重建这些关键索引，您的系统应该可以正常工作。

# ruby-on-rails - 无法为 Rails 制作 RSpec 的头部或尾部

> ID：11925189
> 
> 赞同：1
> 
> 时间：2012-08-12T19:27:08.117
> 
> 标签：ruby-on-rails, rspec

我进行了一组按姓名搜索导演的测试，这些测试或多或少对我有用。沿着：

```
describe MoviesController do
  before :each do
    @fake_results = [mock(Movie),mock(Movie)]
  end
  it "should call the model that looks for same director movies" do
    Movie.should_receive(:find_by_same_director).with('Woody Allen').and_return(@fake_results)
    post :find_by_same_director, {:name => 'Woody Allen'}
  end 
```

等等等等。这并没有令人震惊地破坏任何东西。不幸的是，我决定我需要更改我的控制器方法以获取 id 参数，而不是名称。我的代码的第二部分现在看起来像：

```
it "should call the model that looks for same director movies" do
  Movie.should_receive(:find_by_same_director).with(:id => 1).and_return(@fake_results)
  post :find_by_same_director, {:id => 1}
end 
```

现在运行规范会导致以下错误：

```
 1) MoviesController finding movies with same director should call the model method that looks for same director movies
     Failure/Error: post :find_by_same_director, {:id => 1}
     ActiveRecord::RecordNotFound:
       Couldn't find Movie with id=1
     # ./app/controllers/movies_controller.rb:62:in `find_by_same_director'
     # ./spec/controllers/movie_controller_spec.rb:12:in `block (3 levels) in <top (required)>' 
```

为什么没有 id = 1 的真实电影现在会导致严重错误 - 我的存根/模拟不再覆盖我了吗？以前没有伍迪艾伦导演的电影。我需要做什么才能让我的测试令人满意地假装 id 为 1 的电影存在？

编辑：

控制器动作如下：

```
 def find_by_same_director
   @movie = Movie.find params[:id]
   @movies = Movie.find_same_director(@movie.id)
   if @movies.count == 1
    flash[:notice] = "'#{@movie.title}' has no director info"
    redirect_to movies_path
   end
  end 
```

不确定这是否需要哈希......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:09:01.153

控制器是否使用哈希或整数 id调用模型`find_by_same_director`上的方法？`Movie`如果是后者，那么您设置的模拟将不起作用，因为您指定必须使用 has 调用它`{:id => 1}`，因此您需要将其更改为：

```
Movie.should_receive(:find_by_same_director).with(1).and_return(@fake_results) 
```

如果您确实使用 a 指定了模拟期望，`with`则传递的参数需要完全匹配。如果它们不匹配，`find_by_same_director`则将调用未模拟的方法。如果你想为*任何*参数模拟一个方法，那么你可以`with`完全省略：

```
Movie.should_receive(:find_by_same_director).and_return(@fake_results) 
```

编辑：

查看控制器操作，您将需要模拟该`Movie.find`方法以及`find_same_director`：

```
Movie.should_receive(:find).with('1').and_return(mock_model(:id => 1)) 
```

或者只是存根它（如果您不想断言该方法被调用）：

```
Movie.stub(:find).and_return(mock_model(:id => 1)) 
```

我还注意到规范模拟了`find_by_same_director`方法，而控制器调用了`find_same_director`. 这只是一个错字吗？

# jquery - JQuery Fancybox - 当fancybox关闭时如何重新加载页面

> ID：11925193
> 
> 赞同：2
> 
> 时间：2012-08-12T19:27:33.127
> 
> 标签：jquery, fancybox, reload

当用户关闭 Fancybox 对话框时，如何重新加载当前页面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T19:29:08.047

为此使用`fancybox` `onClosed`处理程序；

```
$('#some_element').fancybox({
  onClosed: function() {
    window.location.reload();
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-08T11:47:24.870

请使用“afterClose”处理程序。 [例子](http://jsfiddle.net/xW5gs/2802/)

```
$(".fancybox").fancybox(
{ 
    afterClose: function() 
    {
     window.location.reload();
    }
}); 
```

# php - 如何使用 AJAX 或 PHP 自动创建 .js 文件

> ID：11925195
> 
> 赞同：0
> 
> 时间：2012-08-12T19:27:49.350
> 
> 标签：php, javascript, ajax

有没有办法在表单提交上使用 PHP 或 AJAX 创建 .js 文件？

我有一个简短的表单，用户输入跟踪 ID 到，当表单提交时，ID 被保存到 mysql 数据库中。

在提交表单的同时，我想自动创建一个 .js 文件，该文件将被称为与提交的 ID 相同的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:31:08.503

在这里检查这个函数在 php [http://php.net/manual/en/function.file-put-contents.php](http://php.net/manual/en/function.file-put-contents.php)

在提交时调用的页面中调用它

# wordpress - WordPress 自定义导航输出

> ID：11925199
> 
> 赞同：0
> 
> 时间：2012-08-12T19:28:18.137
> 
> 标签：wordpress, menu, navigation, wordpress-theming

我正在寻找一个自定义的 WordPress 导航输出，但我很难理解它的去向。

目前，WordPress 的默认输出是这样的：

```
<ul>
<li>Link</li>
<li>Link
    <ul><li>Link</li></ul>
</li>
</ul> 
```

但我需要输出以下内容：

```
<ul>
<li>Link</li>
<li>Link
    <ul><div><span></span><li>Link</li><span></span></div></ul>
</li>
</ul> 
```

现在我知道 WordPress 中有 $before 和 $after 但不幸的是，如果你使用它，它会将它添加到每个链接，而不仅仅是我希望它添加到的子 li。

我知道这可以通过使用自定义 walker 方法来完成，但说我很困惑是轻描淡写的！谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T08:31:42.167

要修改 Wordpress 菜单的输出 HTML，您可以使用**[walker](http://codex.wordpress.org/Function_Reference/Walker_Class)**脚本。

我自己无法以简单的方式解释这一点，但那里有很好的**[教程](http://wp.tutsplus.com/tutorials/creative-coding/understanding-the-walker-class/)**。

据我所知，Wordpress 使用的默认脚本如下[所示](http://core.trac.wordpress.org/browser/trunk/wp-includes/nav-menu-template.php#L10)，并且您可能具有一些阅读和编码技能，可以通过使用您喜欢的标签修改这个来创建您需要的 walker。

# ruby - Ruby Time 在解析时不会保持偏移

> ID：11925200
> 
> 赞同：0
> 
> 时间：2012-08-12T19:28:24.527
> 
> 标签：ruby, time, timezone

```
puts "date --- #{date}"
@date = Time.parse(date.to_s).iso8601 unless date.nil?
puts "@date -- #{@date}" 
```

输出

```
Date --- 2012-08-12T12:15:17-07:00
@Date -- 2012-08-12T19:15:17+00:00 
```

有谁知道为什么？

此外，这发生在 strptime

```
Time.strptime("2012-08-12T12:05:08-07:00", "%Y-%m-%dT%H:%M:%S%:z")
=> 2012-08-12 19:05:08 +0000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:57:34.297

您的系统似乎设置为 UTC。 `Time.parse()`创建一个新的 Time 对象，该对象使用系统时区，并将其设置为解析的时间。它不会更改新时间的时区以匹配解析日期的时区。如果你真的想要这种行为，你可以使用类似的东西：

```
DateTime.parse(date.to_s).new_offset(date.iso8601[-6,6]).iso8601 
```

**更新：**关于`strptime()`刚刚添加的问题部分，这是完全相同的概念。正在使用默认时区创建一个新时间，其时间与您正在解析的日期相匹配。

# extjs - 向商店添加“永久”过滤器，直到我手动调用 clearFilter

> ID：11925206
> 
> 赞同：0
> 
> 时间：2012-08-12T19:28:51.920
> 
> 标签：extjs, extjs4.1, extjs-mvc

我正在使用商店来获取所有徒步旅行者的专业（所以徒步旅行者有很多专业）。但是，我有一个详细信息窗口，其中仅针对当前选定的徒步旅行者添加/删除/显示此专业（是的，这是一个详细信息窗口）。

我的问题是我的商店获取**所有**徒步旅行者的数据，但我希望它显示，当详细窗口打开时，只显示给定徒步旅行者的数据。还要注意我在数据网格中显示数据，所以用户可能可以添加过滤器，我注意到如果我添加一个过滤器`store.filter({...})`并且用户添加一个带有数据网格的过滤器，我的过滤器被删除（所以基本上它们是无用的.

我应该使用哪种方法？你有什么建议吗？我在考虑为每个徒步旅行者开一家商店，但我不喜欢这个解决方案。

**编辑 1：** 我还注意到我无法像数据网格构建过滤器一样创建过滤器：

```
Ext.create('Ext.util.Filter', {
      type: 'numeric',
      comparison: 'eq',
      field: 'hiker_id',
      property: 'hiker_id',
      value: me.hiker.get('id'),
      root: 'data'
    }) 
```

这很无聊，因为我在服务器端实现了一个已经解析网格过滤器的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T06:38:48.630

我们只是将 json 格式的过滤器提供给商店的额外参数。并解析该后端。在分页或刷新网格时，额外的参数保持不变。

```
grid.getStore().getProxy().extraParams = { filter: yourFilter }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T14:21:48.617

-How- 你的用户在做过滤器吗？

`store.filter`接受数组和函数，因此您可以用它做很多事情，而无需实际处理服务器上的数据。（例如，管理一个正在传递给过滤器的数组，在某个地方测试一个对象，或者其他什么）

永久过滤器？没那么多，但是由于您可以添加多个过滤器等，因此跟踪哪些过滤器已到位相对简单。

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Store-method-filter](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Store-method-filter)

# php - 管理页面上的用户表，需要很长时间才能加载

> ID：11925211
> 
> 赞同：1
> 
> 时间：2012-08-12T19:29:27.773
> 
> 标签：php, mysql

我使用这个查询：

```
$result_members = mysql_query("SELECT * FROM members"); 
```

结果显示在我的管理页面上的表格中，如下所示：

```
while($row = mysql_fetch_array($result_members))
{
$id = $row['id'];
$firstname = $row['firstname'];
...

<tr>
 <td><? echo "$id"; ?></td>
 <td><? echo "$firstname"; ?></td>
 ...
</tr>
} 
```

我使用 jQuery 分页，每页显示 50 行，并使用 jquery Autocomplete 在表中搜索。

加载和搜索都需要大量时间。从几秒到一分钟。我的数据库中有大约 5.000 个成员。

我认为有更好的方法来做到这一点。我对mysql没有经验，所以如果你能告诉我一个简单的方法来使这项工作顺利进行，我会很高兴的！:)

问候

维里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:33:49.900

改变

```
SELECT * FROM members 
```

至

```
SELECT * FROM members LIMIT 200 
```

缺点是，这只会让您显示/搜索用户的前 4 页。如果你想解决这个问题，你需要让 jQuery 页面动态地请求更多数据，这使得事情变得复杂了一个数量级。

## 如何添加此功能

很多代码取决于您使用的分页插件。一些插件已经[集成了对它的支持](http://archive.plugins.jquery.com/project/pagination)，而另一些你可能不得不破解。

但是，并没有真正改变的一件事是服务器端的东西。您需要第二个 PHP 脚本，它只返回给定结果的页面。这是一个。

`fetch_page.php`：

```
<?
define('RESULTS_PER_PAGE', 50);
$page = $_GET['page];
$page = (int) $page; // Cast to int to prevent sql injections and let us do math on it.

$start = $page * RESULTS_PER_PAGE;
$end = ($page + 1) * RESULTS_PER PAGE;

$result_members = mysql_query("SELECT * FROM members LIMIT $start, $end");

while($row = mysql_fetch_array($result_members))
{
$id = $row['id'];
$firstname = $row['firstname'];
...

<tr>
 <td><? echo "$id"; ?></td>
 <td><? echo "$firstname"; ?></td>
 ...
</tr>
}
?> 
```

请注意，对此进行搜索是完全不同的事情。有两种方法可以进行搜索：

1）将所有数据从服务器加载到客户端。这很慢，特别是因为 javascript/DOM 并不是存储/搜索大量数据的真正正确方法。但是，它很容易组合在一起。

2) 在数据库服务器上进行搜索并将结果返回给客户端。这也相当复杂。

您应该考虑这种增加的复杂性是否合理。为什么需要搜索用户表？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:40:28.073

这可能不仅是与数据库相关的减速。它也可能是由于您的计算机首先处理 HTML，然后是 jQuery 分页造成的。无论如何，查询 5000 行并将它们显示在同一页面上并不是一个好主意，尽管它们是分页的。

也许您会对 flexigrid.info 感兴趣 - 一个很好的 javascript 解决方案，可以显示来自您的数据库的数据。它不仅可以根据需要加载数据，还可以进行排序和一些操作（行添加和删除）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T19:31:40.927

看一下 MySQL 的`LIMIT`子句。您要做的只是选择您想要使用的 50 行。

# php - 非常简单的 php 问题，我需要帮助

> ID：11925217
> 
> 赞同：1
> 
> 时间：2012-08-12T19:29:50.407
> 
> 标签：php, html

我很抱歉这是一个非常基本的问题，但我对网页设计非常陌生，我只是想让我的表单与 php 一起使用。

表格填写得很好，我收到了一封电子邮件，但没有收到任何正文。我没有告诉我信息是什么，而是得到了这个：

您收到了来自用户 fgafdfa 的新消息。这是消息：info@sodium3.com

如您所见，名称在那里（只是输入了乱码）但是消息丢失了，而是出现了我自己的电子邮件地址...

这是表单的 HTML：

```
<div id="form">
                    <form action="php/send_form_email.php" method="post" >
                        <span>Name</span>
                        <input type="text" name="name" class="name" />
                        <span>Email</span>
                        <input type="text" name="email" class="email"/>
                        <span>Message</span>
                        <textarea class="message"></textarea>
                        <input type="submit" name='submit' value="submit" class="submit"> 
                    </form>
                </div> 
```

这是php：

```
<?php
if(!isset($_POST['submit']))
{
    //This page should not be accessed directly. Need to submit the form.
    echo "error; you need to submit the form!";
}
$name = $_POST['name'];
$visitor_email = $_POST['email'];
$message = $_POST['message'];
if(empty($name)||empty($visitor_email)) 
{
    echo "Name and email are mandatory!";
    exit;
}
if(IsInjected($visitor_email))
{
    echo "Bad email value!";
    exit;
}
$email_from = 'info@sodium3.com';//
$email_subject = "New Form submission";
$email_body = "You have received a new message from the user $name.\n".
    "Here is the message:\n $message".

$to = "info@sodium3.com";//
$headers = "From: $email_from \r\n";
$headers .= "Reply-To: $visitor_email \r\n";
mail($to,$email_subject,$email_body,$headers);
header('Location: ../index.htm');
function IsInjected($str)
{
  $injections = array('(\n+)',
              '(\r+)',
              '(\t+)',
              '(%0A+)',
              '(%0D+)',
              '(%08+)',
              '(%09+)'
              );
  $inject = join('|', $injections);
  $inject = "/$inject/i";
  if(preg_match($inject,$str))
    {
    return true;
  }
  else
    {
    return false;
  }
}

?> 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:36:06.380

两个错误：

请参阅文本区域的 HTML 中缺少的名称。更正的代码：

```
<textarea name="message" class="message"></textarea> 
```

对于代码，您不会以分号结束对 $email_body 的分配，而是在其上附加一个点。幸运的是，您最终没有遇到解析错误。更正的代码：

```
$email_body = "You have received a new message from the user $name.\n".
"Here is the message:\n $message";

$to = "info@sodium3.com"; 
```

# symfony - 如何在 twig 和 symfony2 中将“登录”设置为匿名文本，并为经过身份验证的用户设置“注销”？

> ID：11925221
> 
> 赞同：2
> 
> 时间：2012-08-12T19:30:34.793
> 
> 标签：symfony, twig

我有一个菜单，所有项目都显示给所有用户，我想在 symfony2 中向特定角色用户隐藏/显示特定项目。

例如，我有

```
<ul class="navigation">
    <li><a href="{{ path('homepage') }}">{{ 'menu.home'|trans }}</a></li>
    <li><a href="{{ path('guest') }}">{{ 'menu.articles'|trans }}</a></li>
    <li><a href="{{ path('category') }}">{{ 'menu.categories'|trans }}</a></li>
    <li><a href="{{ path('user') }}">{{ 'menu.users'|trans }}</a></li>
    <li><a href="{{ path('logout') }}">{{ 'menu.logout'|trans }}</a></li>
</ul> 
```

现在 Logout 出现给所有用户，即使他们没有登录。如何让 twig 检查用户是否经过身份验证，然后选择

`<li><a href="{{ path('login') }}">{{ 'menu.login'|trans }}</a></li>`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:31:46.287

在`Twig`做以下检查：

```
{% if app.user %}
    <li><a href="{{ path('logout') }}">{{ 'menu.logout'|trans }}</a></li>
{% else %}
    <li><a href="{{ path('login') }}">{{ 'menu.login'|trans }}</a></li> 
{% endif %} 
```

如果您有不同的角色并且您希望根据用户角色呈现页面的某些部分，您可以进行下一步检查：

```
{% if is_granted('YOUR_ROLE') %} ... {% endif %} 
```

# php - 给定 db ref 的渴望加载

> ID：11925223
> 
> 赞同：1
> 
> 时间：2012-08-12T19:30:55.353
> 
> 标签：php, mongodb, mongodb-php

```
$posts = $collection->find(); 
```

我应该如何急切加载每个帖子所引用的类别？

```
//1 Document from $posts
{
   "_id": ObjectId("502803b6d4ebdfd805000032"),
   "title": "abcd",
   "message": "abc",
   "category": {
     "$ref": "categories",
     "$id": ObjectId("5027e15dd4ebdfd80500001e") 
  }
}

//the document in categories referenced from the post above
{
   "_id": ObjectId("5027e15dd4ebdfd80500001e"),
   "name": "miscellaneous",
   "slug": "miscellaneous",
   "description": "",
   "created_at": ISODate("2012-08-12T17: 01: 17.0Z"),
   "updated_at": ISODate("2012-08-12T19: 27: 50.0Z") 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:28:48.667

Mongo 没有服务器端“急切”的加载。

因此，要加载相关记录，请遍历帖子游标并手动查询相关文档。

不要担心整个“懒惰”加载的事情，Mongo 没问题。

如果您因为各种未知情况而想减轻服务器的压力，那么您可以一直遍历您需要收集`_id`要使用的数组的帖子，然后在一个查询中全部取出这些类别并对其进行排序如所须。

老实说，DBRefs 并不是您认为的那样，实际上在 Mongo 中很少需要。通常`ObjectId`与另一行相关的就可以了。

所有 DBRefs 真正做的是提供一个对象，通过它可以更容易和更简单地获取相关记录：[http://php.net/manual/en/class.mongodbref.php](http://php.net/manual/en/class.mongodbref.php)并且只有在你还没有的时候才真正有用知道收藏。将其视为许多相关集合的自我描述 ID。

# spring - 查询时休眠不返回实体的孩子

> ID：11925227
> 
> 赞同：0
> 
> 时间：2012-08-12T19:31:04.097
> 
> 标签：spring, hibernate, transactions

我遇到了与 Hibernate + Spring Transaction Manager 相关的问题，在从会话开始事务后查询休眠对象时，所有子实体都为 NULL。

每当我需要来自 SessionFactory 的新会话时，我都会执行以下操作：

```
protected Session getSession(SessionFactory sessionFactory)
   throws DataAccessResourceFailureException {
      Session session = org.springframework.orm.hibernate3.SessionFactoryUtils.getSession(sessionFactory, true);
      session.setFlushMode(FlushMode.MANUAL);
      return session;
} 
```

我继续获取会话然后使用它，如下所示：

```
SessionFactory sessionFactory = (SessionFactory) beanFactory.getBean(getSessionFactoryBeanName()); // beanFactory is org.springframework.beans.factory.BeanFactory injected
Session session = getSession(sessionFactory);
session.beginTx
Criteria creteria = session.createCriteria(MyBean.class);
creteria.add(Restrictions.eq("id",myBean.getBeanId() ));
List<MyBean> res = creteria.list();
// Do some work on the beans
session.commit() 
```

此时，`res`列表包含我期望的所有条目....但他们所有的子实体都是`NULL`.

以下是 Spring 应用程序上下文 XML 文件中的相关条目：

```
 <bean id="sessionFactory"
      class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
          <property name="configLocation" value="hibernate.cfg.xml"></property>
  </bean>
  <tx:advice id="txAdvice" transaction-manager="transactionManager">
    <tx:attributes>
      <tx:method name="get*" read-only="true"/>
      <tx:method name="*"/>
    </tx:attributes>
  </tx:advice>
  <tx:advice id="txAdviceAll" transaction-manager="transactionManager">
    <tx:attributes>
      <tx:method name="*" />
    </tx:attributes>
  </tx:advice>
  <bean id="transactionManager" 
    class="org.springframework.orm.hibernate3.HibernateTransactionManager"
        scope="prototype" >
        <property name="sessionFactory"><ref local="sessionFactory"/></property>
</bean>
<bean id="MyBeanDAO"
    class="com.ndipiazza.MyBeanDAO">
    <property name="sessionFactory">
        <ref bean="sessionFactory" />
    </property>
</bean> 
```

我的应用程序上下文有缺陷吗？为什么我没有收到这些孩子的条目？我需要搜索一些特殊的条目吗？

这是 mybean.hbm.xml

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.ndipiazza.MyBean" table="MY_BEAN" schema="ERESUSER_OWNER">
        <id name="myBeanId" type="java.lang.Long">
            <column name="MY_BEAN_ID" precision="22" scale="0" />
            <generator class="assigned" />
        </id>
        <many-to-one name="loadVerification" class="com.ndipiazza.LoadVerification" fetch="select">
            <column name="VERIFY_ID" precision="22" scale="0" not-null="true" />
        </many-to-one>
    </class>
</hibernate-mapping> 
```

这是 MyBean.java

```
package com.ndipiazza;

/**
 * MyBean entity.
 * 
 * @author MyEclipse Persistence Tools
 */

public class MyBean implements java.io.Serializable {

    // Fields

    private Long myBeanId;
    private LoadVerification loadVerification;

    // Constructors

    /** default constructor */
    public MyBean() {
    }

    /** minimal constructor */
    public MyBean(Long myBeanId, LoadVerification loadVerification) {
        this.myBeanId = myBeanId;
        this.loadVerification = loadVerification;
    }

    public Long getMyBeanId() {
        return this.myBeanId;
    }

    public void setMyBeanId(Long myBeanId) {
        this.myBeanId = myBeanId;
    }

    public LoadVerification getLoadVerification() {
        return this.loadVerification;
    }

    public void setLoadVerification(LoadVerification loadVerification) {
        this.loadVerification = loadVerification;
    }
} 
```

# php - 如何通过 URL 传递变量的多个值

> ID：11925228
> 
> 赞同：7
> 
> 时间：2012-08-12T19:31:04.650
> 
> 标签：php, url, urlvariables

我有一个正在构建的应用程序，但我被困在某个点上。

我正在尝试传递一个具有多个值的变量。所以我的网址看起来像：

```
localhost/report.php?variable=value1, value2, value3 
```

问题是我不确定我该怎么做。这些变量将用于从数据库中检索数据。我正在使用 PHP 而没有 Javascript。

任何帮助都会很棒！

**编辑：**
这是我在页面中选择变量的 HTML：

```
<select name="types" size="19" multiple>
    <option value="all" selected>All Types</option>
    <option value="book" selected>Books</option>
    <option value="cd" selected>CD</option>
</select> 
```

所以用户可以选择 Books 和 CD，我需要在“types”变量中传递这两个值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-12T19:32:48.520

采用`&`

```
localhost/report.php?variable=value1&val2=value2&val3=value3 
```

这就是你所追求的吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-12T19:35:55.367

在 PHP 中有一种简单的方法来执行此操作，方法是调用[`http_build_query()`](http://php.net/manual/en/function.http-build-query.php)并将您的值作为索引数组传递。你会做这样的事情：

```
$value_array = array('types' => array('book', 'cd'));
$query = http_build_query($value_array); 
```

然后使用`$query`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-13T17:07:51.183

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-12T19:35:50.287

try`localhost/report.php?variable[]=value1&variable[]=value2`会给你一个 php 中的数组

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-12T19:41:12.033

我认为您的网址正确

```
localhost/report.php?variable=value1,value2,value3 
```

然后使用PHP获取report.php页面上的所有值

```
$variable = explode(",", $_GET["variable"]);

// Output
$variable[0] = "value1";
$variable[1] = "value2";
$variable[2] = "value3"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-12T19:46:48.823

您可以像这样使用[序列化](http://php.net/manual/en/function.serialize.php)：

```
echo '<a href="index.php?var='.serialize($array).'"> Link </a>'; 
```

[并使用反序列化](http://www.php.net/manual/en/function.unserialize.php)获取数据，例如：

```
$array= unserialize($_GET['var']); 
```

serialize 函数为您提供数组类型的可存储（字符串）版本，并且可以通过 unserialize 函数恢复。

# javascript - 如何更改具有相同类、名称的 iframe src？

> ID：11925236
> 
> 赞同：0
> 
> 时间：2012-08-12T19:31:25.013
> 
> 标签：javascript, jquery

```
<iframe id="chgMe" src="Source1.htm">Frames are not supported on your browser.</iframe>

<button onclick="document.getElementById('chgMe').src='Source2.htm'">Next</button> 
```

它工作得很好，但是当生成 2 个或更多具有相同 id 的 iframe 时，第二个、第三个、第四个等 iframe 没有响应。我试过了`document.getElementByTagName();`，`document.getElementByName();`但没有任何效果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:40:24.473

你可以编写一个函数来创建一个新的 iframe（如果你还没有），给他们每个人的 id chgMe0，chgMe1，chgMe2，......然后点击“下一步”按钮时调用另一个函数，这会像这样：

```
var framecount; // global variable that counts all frames

function next(nextpage)
{
    var i;
    for(i=0;i<framecount;i++)
    {
        document.getElementById("chgMe"+i).src=nextpage;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:41:44.363

ID 属性必须是唯一的，请改用类，或者在添加 IFrame 时生成新的 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T19:33:14.970

### `id`不允许有多个相同的元素。

```
<button id="change_src">Next</button> 
```

***jQuery***

```
$('#change-src').on('click', function() {
  $('#chgMe').attr('src', 'Source2.htm?' + (new Date()).getTime();
}); 
```

* * *

您可以为自己维护一个模式`id`：`chgMe_1, chgMe_2`等等并修改您的代码，如下所示：

```
$('#change-src').on('click', function() {
  $('[id*=chgMe_]').attr('src', 'Source2.htm?' + (new Date()).getTime();
}); 
```

这将选择所有`iframe`的`id`contains `chgMe_`。

* * *

或者，您也可以使用一个通用`class`的`iframe`，如下所示：

```
$('#change-src').on('click', function() {
  $('.common_cls_name').attr('src', 'Source2.htm?' + (new Date()).getTime();
}); 
```

### 笔记

`(new Date()).getTime()`只是为了防止缓存，所有上述代码都会改变`src`（`iframe`*根据你的问题）*。

# actionview - 列表视图单元格中的 RailsAdmin 多行

> ID：11925237
> 
> 赞同：3
> 
> 时间：2012-08-12T19:31:26.387
> 
> 标签：actionview, rails-admin

我想让 RailsAdmin 在一个单元格中显示两个字段。

```
config.model Model do
  list do
    field :id do
      label '#'
    end

    field :email do
      label 'Customer'
      formatted_value do
        view = bindings[:view]
        bindings[:view].content_tag(:div, [view.content_tag(:p, bindings[:object].email), view.content_tag(:p, bindings[:object].phone)])
      end
    end
  end
end 
```

这给了我以下输出（基本上是转义的 HTML）。

```
[<p>...(email)...</p> <p>...(phone)...</p>] 
```

我不确定我做错了什么 - 作为一个 Rails 初学者，也许我没有正确使用 content_tag 方法？

# javascript - jquery委托方法应用

> ID：11925238
> 
> 赞同：-1
> 
> 时间：2012-08-12T19:31:29.227
> 
> 标签：javascript, jquery, checkbox, delegates

如何将 .delegate 方法应用于这行 jquery？

```
$(function() {
    $("input[type='checkbox']").on('change', function() {
        if (this.checked) {
            $(".loadingItems").fadeIn(300);
            var color = encodeURI(this.value);
            $(".indexMain").load('indexMain.php?color=' + color, function() {
                $(".indexMain").fadeIn(slow);
            });
            $(".loadingItems").fadeOut(300);
        } else {
            $(".loadingItems").fadeIn(300);
            $(".indexMain").load('indexMain.php', function() {
                $(".loadingItems").fadeOut(300);
            });
        }
    });
}); 
```

形式：

```
echo "<input type='checkbox' class='regularCheckbox' name='color[]' value='".$colorBoxes[color_base1]."' /><font class='similarItemsText'>   ".$colorBoxes[color_base1]."</font><br />"; 
```

PHP接收颜色：

```
$color = $_GET['color'];
$items = $con -> prepare("SELECT * FROM item_descr WHERE color_base1 = :colorbase1");
        $items -> bindValue(":colorbase1", $color);
while($info = $items->fetch(PDO::FETCH_ASSOC)) 
{ .... 
```

我需要允许在复选框集中进行多项选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:40:23.580

现在您已经向我们展示了更多关于您真正想要做什么的信息，您将不得不更改代码的工作方式，并且`.delegate()`对于解决该问题没有用处。

现在，您在构建将使用的 URL 时只检查一个复选框的值`indexMain.php`。相反，您需要在构建该 URL 时检查所有选中复选框的值。

您没有说在选中多个复选框时要如何构造 URL，但在结构上，代码将如下所示：

```
$(function() {
    $("input[type='checkbox']").on('change', function() {
        var colors = [];
        $("input[type='checkbox']:checked").each(function() {
            colors.push(this.value);
        });
        if (colors.length) {
            $(".loadingItems").fadeIn(300);
            $(".indexMain").load('indexMain.php?color=' + colors.join("+"), function() {
                $(".indexMain").fadeIn(slow);
            });
            $(".loadingItems").fadeOut(300);
        } else {
            $(".loadingItems").fadeIn(300);
            $(".indexMain").load('indexMain.php', function() {
                $(".loadingItems").fadeOut(300);
            });
        }
    });
}); 
```

This code will produce a URL for the `.load()`command like this when one or more colors are selected:

```
indexMain.php?color=blue+yellow+green+orange 
```

如果没有选择颜色，它将`indexMain.php`不带其他参数调用。

由您的服务器代码来解析来自 URL 的颜色并创建所需的响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:34:03.003

```
$(document).on('change', 'input[type=checkbox]', function() {
   // code
}); 
```

使用 jQuery**[`.on()`](http://api.jquery.com/on)**你可以做到这一点。

的语法`.on()`：

```
$(static_parent).on( eventName, target, handlerFunction); 
```

其中`static_parent`表示非动态容器，`target`并且`target`是绑定事件的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T20:07:23.073

委托可以写成如下

```
$("table").delegate("td", "click", function(){$(this).toggleClass("chosen");}); 
```

并且可以使用 latest(可从 jquery 1.7 获得) on() 来实现同样的事情，如下所示

```
$("table").on("click", "td", function(){$(this).toggleClass("chosen");}); 
```

# node.js - 从mongodb（mongoose）获取数据到jade view

> ID：11925242
> 
> 赞同：7
> 
> 时间：2012-08-12T19:31:45.867
> 
> 标签：node.js, mongodb, mongoose, pug

我一直试图在我的玉视图中获取 mongodb 数据。我是 node.js 的新手，如果这看起来很愚蠢，我深表歉意！我可以在控制台中看到我的表格中的内容：

```
Material.find(function (err, materials){
  console.log(materials);
}); 
```

但我想将该数据传递给我的玉视图

```
app.get('/help', function(req, res){
  res.render('help', {materials: materials});
}); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-12T19:54:57.993

你在正确的轨道上！只需将渲染放在来自的回调中`find`：

```
app.get('/help', function(req, res){
  Material.find(function (err, materials){
    res.render('help', {materials: materials});
  });
}); 
```

# c# - 如何扩展 MVC 4 WebApi 和实体框架

> ID：11925247
> 
> 赞同：3
> 
> 时间：2012-08-12T19:32:35.173
> 
> 标签：c#, asp.net-mvc, entity-framework, scalability, asp.net-web-api

我有一个使用 MVC 4 构建的 Web 应用程序，后端带有 WebApi，它具有实体框架。

我已经使用结构映射将实体框架注入 webapi。并将 webapi 客户端注入 MVC 4 应用程序。

他的应用程序运行良好，但很快我将需要扩展。

MVC 4 应用程序位于一台服务器上，webapi 位于另一台服务器上，并且有一个数据库服务器。

如何水平扩展 webapi？如果我添加 webapi 服务器和数据库服务器，是否有实体框架的配置将采用多个连接字符串并进行循环查询？是否有可用于 EF 的分片。

httpclient怎么样？故障转移如何，例如客户端需要多个 IP，如果一个失败，请求会转到另一台服务器？

如何缩放它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:53:23.877

通常会添加额外的 Web 服务器，然后使用负载平衡器在它们之间分配传入请求。这里有一些考虑。

*   如果 Web 服务器跨请求保留数据（通过 ASP.NET 会话），您将需要创建一个所有 Web 服务器可以共享的单独状态服务器，或使用状态感知的负载平衡器。

*   如果性能问题源于数据库 IO 问题（缺少表索引、索引碎片、请求提取大量结果集、低于最佳磁盘\硬件配置等），那么添加更多 Web 服务器将无法解决问题。第一步是监控和分析您的数据库，并确保它运行良好。

# java - Java：通过迭代器和内部类进行对象转义

> ID：11925253
> 
> 赞同：1
> 
> 时间：2012-08-12T19:33:47.897
> 
> 标签：java, multithreading

我正在看书`Java Concurrency in Practice`。
在**第 4.2 章**-*实例限制*中，它说受限对象也可以通过发布可能间接发布受限对象的迭代器或内部类实例等其他对象来逃脱。
有人可以举一个例子（代码）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:41:46.457

当然，这里有两个例子。
**迭代器：**

```
public class NonSafe {
    private List x;

    public Iterator getIterator() {
        return x.iterator();
    }
} 
```

即使是私有的，您仍然可以对其`x`执行操作，例如，修改. `delete()``Iterator``x`

**内部类：**

```
public class Outer {
    private Object x;

    class Inner {
        public Object lookAtOuter() {
            return Outer.this.x;
        }
    }
} 
```

在这里，对 , 的转义引用`Inner`会导致对 的间接引用`x`泄漏，即使它是私有的。

# c++ - 没有对话框的编辑控件上的 SHAutoComplete

> ID：11925256
> 
> 赞同：3
> 
> 时间：2012-08-12T19:34:06.683
> 
> 标签：c++, c, winapi

我在使用该功能时遇到问题`SHAutoComplete`。当我在其父窗口不是对话框的编辑框上使用它时，它根本无法正常工作。

自动完成功能似乎工作正常，但下拉列表的呈现与基于在编辑框中键入的内容的可能候选者非常混乱。基本上只显示下拉菜单的边框。边界被渲染得足够宽以适应可能的建议，但建议本身从未被绘制。甚至下拉列表背景颜色也是错误的。就好像它从未被绘制并保持原始父窗口颜色一样。

如果建议的数量足够大，以至于下拉菜单需要滚动条，滚动条也不会正确呈现 - 箭头不会被绘制。

在这两种情况下，无论有无滚动条，下拉列表都不接受鼠标输入，即我无法单击项目。如果我在显示下拉菜单时按下键盘上的“向下”键，它会按预期工作。在第二次或第三次按下后，项目终于开始出现。但是滚动条仍然没有正确呈现。

如果我没有注册我自己的 Windows 类，而是简单地使用带有 的对话框`::DialogBoxParam()`，那么一切都会按预期进行。自动完成工作完全没有任何问题。

这就是我正在做的事情。这段代码将注册一个窗口类，创建主窗口，创建一个编辑框，然后调用`SHAutoComplete`它。它必须与`Shlwapi.lib`

```
// this code must be linked with Shlwapi.lib

#include <Windows.h>
#include <Shlwapi.h>

// name of the class that will be created for the main window
static const char WindowClassName[] = "SHAutoCompleteDoesNotWorkWithoutADialogWindowClassName";

// the main window procedure
static LRESULT CALLBACK WindowProc(
    HWND   hwnd,
    UINT   uMsg,
    WPARAM wParam,
    LPARAM lParam)
{
    switch(uMsg)
    {   
        case WM_CREATE:
        {
            HWND hwndEdit = ::CreateWindowEx(
                0,
                "EDIT",
                0,
                WS_CHILD | WS_VISIBLE,
                10, 
                10, 
                300,
                25,
                hwnd, 
                NULL,
                NULL,
                0);     

            ::SHAutoComplete(hwndEdit, SHACF_DEFAULT);

            return 0;
        }            

        case WM_DESTROY:
            ::PostQuitMessage(1);
            return 0;

        default:
            return ::DefWindowProc(hwnd, uMsg, wParam, lParam);
    }
}

// the app entry point
int CALLBACK WinMain(
    HINSTANCE hInstance,
    HINSTANCE hPrevInstance,
    LPSTR    lpCmdLine,
    int       nCmdShow)
{
    ::CoInitialize(NULL);

    WNDCLASSEX wcex    = {0};
    wcex.cbSize        = sizeof(wcex);
    wcex.style         = CS_OWNDC | CS_HREDRAW | CS_VREDRAW ;
    wcex.lpfnWndProc   = WindowProc;
    wcex.hInstance     = hInstance;        
    wcex.lpszClassName = WindowClassName;
    wcex.hbrBackground = (HBRUSH)(COLOR_BTNFACE+1); 

    ATOM atom = ::RegisterClassEx(&wcex);

    HWND hwnd = ::CreateWindowEx(
        0,
        MAKEINTATOM(atom),
        "SHAutoComplete Test",
        WS_OVERLAPPEDWINDOW | WS_VISIBLE |  WS_CLIPCHILDREN | WS_CLIPSIBLINGS,
        CW_USEDEFAULT,
        CW_USEDEFAULT,
        CW_USEDEFAULT,
        CW_USEDEFAULT,
        NULL,
        NULL,
        hInstance,
        NULL);

    MSG msg;
    while(::GetMessage(&msg, hwnd, 0, 0) > 0)
    {
        ::TranslateMessage(&msg);
        ::DispatchMessage(&msg);
    }

    ::UnregisterClass((LPCTSTR)atom, NULL);

    ::CoUninitialize();

    return 0;
} 
```

该代码产生以下内容：

1.  需要滚动条时的下拉菜单 [http://www.abload.de/img/shautocomplete_2i1sk4.jpg](http://www.abload.de/img/shautocomplete_2i1sk4.jpg)

2.  几次按下“向下”键后的下拉菜单。请注意滚动条仍未正确呈现。 [http://www.abload.de/img/shautocomplete_3efsgw.jpg](http://www.abload.de/img/shautocomplete_3efsgw.jpg)

现在，当我切换到对话框时，它就像一个魅力。在下面的代码中，IDD_DIALOG1 只是一个空的对话框资源，由 IDE 自动创建。

这是rc文件的相关部分

```
IDD_DIALOG1 DIALOGEX 0, 0, 316, 185
STYLE DS_SETFONT | DS_MODALFRAME | DS_FIXEDSYS | WS_POPUP | WS_CAPTION | WS_SYSMENU
CAPTION "Dialog"
FONT 8, "MS Shell Dlg", 400, 0, 0x1
BEGIN
END 
```

这是使用它的代码

```
// this code must be linked with Shlwapi.lib

#include <windows.h>
#include <Shlwapi.h>

#include "Resource.h"

BOOL CALLBACK DialogProc(
    HWND   hwnd,
    UINT   uMsg,
    WPARAM wParam,
    LPARAM lParam)
{    

    switch(uMsg)
    {        
        case WM_INITDIALOG:
        {
            HWND hwndEdit = ::CreateWindowEx(
                0,
                "EDIT",
                0,
                WS_VISIBLE | WS_CHILD,                    
                0, 
                0, 
                300,
                20,
                hwnd, 
                NULL,
                NULL,
                0);      

            ::SHAutoComplete(hwndEdit, SHACF_DEFAULT);

            return 1;
        }

        case WM_CLOSE:            
            ::EndDialog(hwnd, 0);
            return 1;   

        default:
            return 0;
    }
}

int WINAPI WinMain(
    HINSTANCE hInstance,
    HINSTANCE hPrevInstance,
    LPSTR     lpCmdLine,
    int       nShowCmd)
{       
    ::CoInitialize(NULL);

    ::DialogBoxParam(
        NULL,
        MAKEINTRESOURCE(IDD_DIALOG1),
        NULL,
        DialogProc,
        0);    

    ::CoUninitialize();

    return 0;
} 
```

Could you please point out where I am going wrong? As far as I can see, other than the creation and destruction of the main window, there seems to be no difference at all between the two of them. Am I missing something on the SHAutoComplete docs that states it can only be used on edit boxes inside dialogs?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T19:43:09.200

You are using a filtered message loop so any messages for the drop down are not being processed. Pass NULL as the second parameter to GetMessage

# perl - 使用 Parse::Lex，有没有办法只在某些状态/条件下返回令牌

> ID：11925259
> 
> 赞同：4
> 
> 时间：2012-08-12T19:34:46.780
> 
> 标签：perl, parsing, bison, parser-generator, flex-lexer

假设我只需要标记和解析多行注释，我将如何使用 Parse::Lex 来做到这一点。使用 flex-bison 时，lex 文件的规则部分中的任何模式的默认操作曾经是“跳过”。

```
%%
.*    ;
%% 
```

如何在这里做到这一点？

[编辑]好吧，我试过了，我仍然缺少一些东西 - 这是我的代码 - 和结果。我哪里出错了？？

我的简化 lex 文件：

```
use Parse::Lex;
use Regexp::Common;
use YParser;
my $lexer;
my @token = (
qw|esp:TA abcdefgh|,
qw(esp:REST .|\n),
);
Parse::Lex->trace;
Parse::Lex->exclusive('esp');
$lexer = Parse::Lex->new(@token);
$lexer->from(\*STDIN);
$lexer->skip(qr! [ \t]+ | $RE{balanced}{-begin=>'/*'}{-end=>'*/'} !xms);
$lexer->start('esp');

my $j = YParser->new();
$j->YYParse(yylex => \&lex);

sub lex {
    my $token = $lexer->next;
    return ('', undef) if $lexer->eoi;
    if ($token->name eq 'TA' || $token->name eq 'REST') {
        return ($token->name, {LINENO => $lexer->line, TEXT => $token->text});
    }
} 
```

我的简化语法文件

```
% token TA REST

%%

Program:  Element
          | Program Element
;
Element:  TA
          | REST
;

%% 
```

输入文件：

```
abcdefgh
/*sdf*/ 
```

结果：perl lexfile.pl < inputfile

```
Trace is ON in class Parse::Lex
Can't call method "name" on an undefined value at qnlex.pl line 26, <STDIN> line 1. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T19:28:04.623

好吧，我想通了 :) 非常简单——我所要做的就是让 lex 在遇到我想跳过的标记时获得下一个标记。下面是跳过将令牌“REST”传递给解析器的代码。

```
sub lex {
    my $token;
    NEXTTOKEN:
    $token = $lexer->next;
    return ('', undef) if $lexer->eoi;
    if ($token->name eq 'TA') {
        return ($token->name, {LINENO => $lexer->line, TEXT => $token->text});
    }
    elsif ($token->name eq 'REST') {
        goto NEXTTOKEN;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:58:17.140

使用`skip`此处显示的设置，使用[Regexp::Common](https://metacpan.org/module/Regexp%3a%3aCommon)来帮助构建匹配平衡的注释分隔符对的正则表达式。我假设`/* */`为注释分隔符，但它们可以是任何东西。

```
$lexer->skip(qr! [ \t]+ | $RE{balanced}{-begin=>'/*'}{-end=>'*/'} !xms); 
```

`[ \t]+`替代方案保留在原地，因为这是默认设置。

# javascript - jquery ajax成功函数未执行

> ID：11925263
> 
> 赞同：1
> 
> 时间：2012-08-12T19:35:45.873
> 
> 标签：javascript, jquery, ajax

我有一个将数据提交到表格的模态对话框表单。我想给用户一些关于提交成功/失败的反馈，但成功处理程序没有触发。

我的代码是

```
$.ajax({
  type: "POST",
  url: "includes/phpscripts.php?action=submitWiki",
  data: {"name": location, "location": locationName, "text": locationText, "user": userId},
  beforeSend: function(x){
    if (x && x.overrideMimeType){
      x.overrideMimeType("application/json;charset=UTF-8");
    }
  },
  async: false
}).done(function(data){
  if (data == "failure"){
    $("#submissionFailure").dialog("open");
  } else {
    $("#submissionSuccess").dialog("open");
    var count= 3;
    var id= setInterval(function(){
      count--;
      if (count == 0)
        $("#submissionSuccess").dialog("close");
    }, 1000);
  }
}); 
```

另一个版本将 if/else 块`done`定义为

```
success: function(data){
  if (data == "failure"){
    $("#submissionFailure").dialog("open");
  } else {
    $("#submissionSuccess").dialog("open");
    var count= 3;
    var id= setInterval(function(){
      count--;
      if (count == 0)
        $("#submissionSuccess").dialog("close");
    }, 1000);
  }
} 
```

在 Firebug 中，我可以清楚地看到请求的返回是`success`由于 echo 语句，但是成功函数被跳过了。我直接`done`在行上设置了断点，一切都被跳过了。

此外，这些帖子正在被记录到数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:41:00.547

您缺少的默认为 HTML/String 或 XML 的“dataType”可能我不记得是哪一个了，但是假设您使用 JSON，如果 dataType: 未设置为 JSON，它不会解释您的后端反馈是有效的，基本上会忽略它。所以`type: "POST"`下放`dataType:"json"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:50:40.780

就像 Chris ^ 告诉你的那样，添加数据类型，然后更改这一行

```
data: {"name": location, "location": locationName, "text": locationText, "user": userId} 
```

对此

```
data: {name: "location", location: "locationName", text: "locationText", user: "userId"} 
```

引号应该围绕第二个参数，除非它们是变量。第一个参数可以这样保留。

# c# - 如何取消关闭或重新启动 Windows 并使其进入看起来像 Windows 更新更多的内容？

> ID：11925271
> 
> 赞同：-1
> 
> 时间：2012-08-12T19:36:38.407
> 
> 标签：c#

> **可能重复：**
> [如何从 Windows 服务 C# 取消关机](https://stackoverflow.com/questions/2720125/how-cancel-shutdown-from-a-windows-service-c-sharp)

我有windows服务应该将文件传输到nas存储，现在的问题是这些文件非常重要，不能被windows关机或重启打断，

我想做一些看起来像 Windows 更新的事情，当用户在服务传输队列中的文件时点击关闭，Windows 应该等到所有文件都被传输然后执行关闭或重新启动。

像这张图片： [http ://www.7tutorials.com/files/img/ie9_uninstall/unie93.png](http://www.7tutorials.com/files/img/ie9_uninstall/unie93.png)

如何在 c#.net 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:04:39.843

如果我没记错的话，有一个命令行实用程序shutdown.exe。您可以使用它的命令行参数之一 /abort。我想你可以高频调用它。制作一个不断“窃取”焦点并且是“顶级”的全屏窗口也相对容易。但是，它不能阻止您访问锁定屏幕。

然而，这听起来像是一个糟糕的计划。程序的这种行为是不能容忍的，除非它只是你使用它。我认为更好的解决方案可能是以不同的名称传输文件，然后在完成后重命名。在确认操作完成之前不要破坏原件。如果这不可能，那么我鼓励您研究其他解决方案。祝你好运！

# android - xml 中定义的 ListView 的 addFooterView

> ID：11925272
> 
> 赞同：0
> 
> 时间：2012-08-12T19:36:48.543
> 
> 标签：android, xml, android-listview

我有一个 ListView，它在 xml 文件中完全定义。现在我想在这个列表中添加一个页脚，以便列表的最后一个元素变成一个按钮。

所以首先我这样做：`View v = getLayoutInflater().inflate(R.layout.add_new, null);`，其中 add_new 是我的页脚的布局

现在我知道我需要这样做： `listViewInstance.addFooterView(v);`

但我真的没有那个实例，因为我的 ListView 是在 xml 文件中定义的。那么我应该写什么而不是 listViewInstance 呢？有没有办法以某种方式从 xml 获取它的实例？

提前谢谢xxx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:40:01.547

如果您使用 ListActivity 或Activity.findViewById [()](http://developer.android.com/reference/android/app/Activity.html#findViewById%28int%29)来获取对列表视图的引用，请使用[ListActivity.getListView() 。](http://developer.android.com/reference/android/app/ListActivity.html#getListView%28%29)

# sql - 使用嵌套选择查询更新查询

> ID：11925275
> 
> 赞同：0
> 
> 时间：2012-08-12T19:37:08.447
> 
> 标签：sql, sql-server-2008, sql-update

在这里，我在表中有一些学生信息。其授权值默认为 0。在检查了一些条件后，我将一些学生分组并将那里的值更新为 1。

只有那些满足给定条件的学生，即

```
select * from studentA 
where schName ='IES DADAR' and lang = 'E' 

[1]: http://rk.somee.com/untitled.jpg 
```

我正在尝试使用以下代码，但它没有根据我的给定条件进行过滤，而是将每个学生的授权值更改为 1。

```
update studentA
set Authorized = '1'
where Authorized IN 
( select Authorized from studentA 
where schName ='IES DADAR' and lang = 'E') 
```

你也可以建议我另一种方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:39:32.120

尝试

```
update studentA 
set Authorized = '1' 
where schName ='IES DADAR' 
and lang = 'E' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T19:45:07.873

子查询

```
 select Authorized from studentA 
 where schName ='IES DADAR' and lang = 'E' 
```

返回 0，因此您的实际查询变为

```
update studentA
set Authorized = '1'
where Authorized IN ('0') 
```

从而更新表中的每一行。

所以，应该是

```
update studentA
set Authorized = '1'
where schName ='IES DADAR' and lang = 'E' 
```

# git - 为什么 git 为我的签入暂存文件，这些文件是在合并中提取的，但我没有触及？

> ID：11925278
> 
> 赞同：2
> 
> 时间：2012-08-12T19:37:22.730
> 
> 标签：git, branching-and-merging

我第一次体验将其他人的更改与 Git 合并（而不是仅仅以一种微不足道的方式自己克隆/推送。）我使用过`git pull`并且解决冲突的基本过程很简单，那一点似乎工作得很好。

不过，我对我所看到的有点困惑。我确信这是一个非常简单的问题。但是为什么在我从 master 拉取并合并某人的更改后，它显示这些文件在我的分支中“暂存”......即使我根本没有接触这些文件？

例如：另一个人在项目中添加了一个全新的 PNG。当我这样做时，该 PNG 显示为“已添加” `git status`。我没有这样做`git add`，合并自动将其放在那里。一切是否真的正常工作，这不会看起来像是来自*我的*承诺？当我提交和推送时，会有某种差异魔法出现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T19:49:13.250

请记住，拉动只是提取+合并。

您需要*提交*合并。这导致了一种叫做*合并提交*的东西。合并提交将以您的最新修订和您刚刚提取的修订作为父项。这些文件显示为分阶段，因为它们将包含在合并提交中。

尝试运行`git commit`，然后使用 eg 查看生成的历史记录`gitk`。

[您可以在Git Book](http://git-scm.com/book/en/Git-Branching-Basic-Branching-and-Merging)中阅读更多关于合并的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T19:53:26.933

它确实来自您的提交。您的合并提交是将文件添加到您的分支的提交，因为在合并发生之前它不存在。如果并且当您将分支合并`master`回`master`.

# matlab - 复 FFT 然后逆 FFT MATLAB

> ID：11925281
> 
> 赞同：4
> 
> 时间：2012-08-12T19:37:59.530
> 
> 标签：matlab, transform, fft, inverse

我在 Matlab 中使用 FFT 函数试图分析行波激光模型的输出。

该模型的时域形式为（实部、虚部），其思想是将 FFT 应用于复数输出，以获得频域中的相位和幅度信息：

```
%load time_domain field data
data = load('fft_data.asc');

% Calc total energy in the time domain
N = size(data,1);
dt = data(2,1) - data (1,1);
field_td = complex (data(:,4), data(:,5));

wavelength = 1550e-9;
df = 1/N/dt;
frequency = (1:N)*df;
dl = wavelength^2/3e8/N/dt;
lambda = -(1:N)*dl +wavelength + N*dl/2;

%Calc FFT
FT = fft(field_td);
FT = fftshift(FT);
counter=1;
phase=angle(FT);
amptry=abs(FT);
unwraptry=unwrap(phase); 
```

在展开之后，将最佳拟合应用于感兴趣区域中的相位，然后从相位本身中减去，以尝试消除感兴趣区域中相位的波长依赖性。

```
for i=1:N % correct phase and produce new IFFT input
    bestfit(i)=1.679*(10^10)*lambda(i)-26160;
    correctedphase(i)=unwraptry(i)-bestfit(i);
    ReverseFFTinput(i)= complex(amptry(i)*cos(correctedphase(i)),amptry(i)*sin(correctedphase(i)));
end 
```

手动执行了最佳拟合后，我现在有了如上所示的逆 FFT 输入。

```
pleasework=ifft(ReverseFFTinput); 
```

我现在可以从中提取时域中的相位和幅度信息：

```
newphasetime=angle(pleasework);
newamplitude=abs(pleasework); 
```

然而，虽然相位的输出与时域的输入相比有很大的不同

![蓝色=反向 FFT 返回后的时域相位输出](../Images/bf8df79c67f77bc301b5b2e7c62e1729.png)

校正数据的幅度似乎变化不大（如果有的话！），

![在此处输入图像描述](../Images/0a3f9c8facbccd3775d20ca090654a0e.png) ![在此处输入图像描述](../Images/c7da73bbcd87179c8903673e0cbf248e.png)

尽管相位缩放。从物理上讲，这似乎不正确，因为我的理解是消除相位的波长依赖性应该“压缩”脉冲输入，即缩短脉冲宽度但提高峰值。

我的主要问题是我是否未能正确使用逆 FFT 或正向 FFT 或两者，或者这类似于窗口或规范化问题？

对不起，冗长的问题！并提前感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T19:50:51.207

You're actually seeing two effects.

First the expected one goes. You're talking about "removing wavelength dependence of phase". If you did exactly that - zeroed out the phase completely - you would actually get a slightly compressed peak. What you actually do is that you add a linear function to the phase. This does not compress anything; it is a well-known transformation that is equivalent to shifting the peaks in time domain. Just a textbook property of the Fourier transform.

Then goes the unintended one. You convert the spectrum obtained with `fft` with `fftshift` for better display. Thus before using `ifft` to convert it back you need to apply `ifftshift` first. As you don't, the spectrum is effectively shifted in frequency domain. This results in your time domain phase being added a linear function of time, so the difference between the adjacent points which used to be near zero is now about pi.

# asp.net - 使用 User.Identity.Name 值预填充 DetailsView InsertItemTemplate TextBox

> ID：11925282
> 
> 赞同：0
> 
> 时间：2012-08-12T19:37:59.170
> 
> 标签：asp.net, detailsview

我正在尝试将经过身份验证的用户的用户名放在插入项目模板上。我需要最简单的解释，因为我很新。我真的很感谢你的帮助。这就是我所拥有的：

```
 <InsertItemTemplate>
         <asp:LoginName ID="LoginName2" runat="server" User.Identity.Name='<%# Bind("UserName") %>'/>
    </InsertItemTemplate> 
```

谢谢

何塞

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T22:14:08.683

从代码隐藏中执行此操作

```
<asp:DetailsView ID="DetailsView1" runat="server" OnDataBound="DetailsView1_DataBinding">
<InsertItemTemplate>
     <asp:LoginName ID="LoginName2" runat="server" />
</InsertItemTemplate>    
</asp:DetailsView>

Protected Sub DetailsView1_DataBinding(ByVal sender As Object, ByVal e As System.EventArgs) Handles DetailsView1.DataBinding

LoginName2.text =User.Identity.Name

End Sub 
```

# c# - C#锁和新手多线程问题

> ID：11925285
> 
> 赞同：7
> 
> 时间：2012-08-12T19:38:12.487
> 
> 标签：c#, multithreading

一些关于 .NET 中多线程的新手问题，我认为这将有助于强化我正在尝试吸收的一些概念——我已经阅读了一些多线程材料（包括 Albahari 电子书），但我觉得我只需要确认一些问题帮助将这些概念带回家

1.  锁定范围保护代码的共享区域 - 假设有一个线程执行一个方法，该方法在循环中增加一个简单的整数变量 x - 但是这不会保护其他地方的代码也可能改变变量 x 例如在另一个线程的另一个方法中...

    由于这是两个不同的代码区域，可能会影响同一个变量，我们是否可以通过在变量 x 周围的两个锁定范围内使用相同的锁定变量锁定两个代码区域来解决这个问题？如果您使用不同的锁定变量锁定两个代码区域，这不会保护变量正确吗？

2.  为了进一步说明这个例子，使用相同的锁变量，如果由于某种原因，一个方法中的代码进入某个无限循环并且从未放弃锁变量会发生什么 - 另一种方法中的第二个代码区域如何检测到这一点？

3.  锁变量的选择如何影响锁的行为？我已经阅读了很多关于这个主题的帖子，但似乎永远找不到明确的答案——在某些情况下，人们明确地为此目的使用对象变量，其他时候人们使用 lock(this)，最后我'见过人们使用类型对象。

    锁变量的不同选择如何影响锁的行为/范围，在哪些场景中使用其中一个更有意义？

4.  假设您有一个包含在一个类中的哈希表，该类公开 add、remove、get 和某种计算方法（例如，每个对象代表一个数量，并且此方法对每个值求和）并且所有这些方法都被锁定 - 但是，一旦对对象的引用在该集合可供其他代码使用并通过应用程序传递时，该对象（不是哈希表）现在将位于该类方法周围的锁定范围之外..然后您如何保护对这些实际对象的访问/更新来自哈希表，这可能会干扰计算方法？

感谢提供的任何启发式方法，这将有助于加强我的这些概念 - 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:10:32.977

1) 是的

2）这是一个僵局

3）您要阻止的代码部分是您的类的实现细节。通过使用`lock(this)`或`lock(this.GetType())`自找麻烦来暴露锁定对象，因为现在外部代码可以锁定同一个对象并无意或恶意地阻止您的代码。锁定对象应该是私有的。

4）您的意思不是很清楚，您当然不想直接公开哈希表。只需将其保留为类的私有字段，将其封装即可。

但是，您可以使用线程安全地将您的类公开给客户端代码的几率随着公开的公共方法和属性的数量而迅速下降。您将很快达到只有客户端代码才能正确锁定的地步。当客户端代码保持属性值时，细粒度锁定为线程竞争创造了很多机会。说出您返回的 Count 属性值。到它*使用*该值时，例如在 for 循环中，Count 属性可能已更改。只有最细心的设计才能避开这些陷阱，真是让人头疼。

此外，细粒度锁定非常低效，因为它不可避免地在代码的最内部部分完成。锁并不*那么*昂贵，大约 100 个 cpu 周期，但它很快就会增加。如果类对象实际上并未在多个线程中使用，则尤其是浪费精力。

然后，您别无选择，只能声明您的类线程不安全，并且客户端代码需要以线程安全的方式使用它。这也是许多 .NET 类不是线程安全的核心原因。这是线程很难正确处理的最大原因，最不可能正确执行线程的程序员负责做最困难的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T19:50:10.120

1）你是对的。您必须使用相同的锁对象来保护两个不同的代码区域，例如递增变量 x。

2) 这被称为死锁，是多线程编程的难点之一。有一些算法可用于防止死锁，例如银行家算法。

3) 某些语言使锁定变得容易，例如在.Net 中，您可以创建一个对象并将其用作共享锁。这对于在给定进程中同步代码很有用。Lock(this) 只是将锁应用于有问题的对象。但是尽量避免这种情况，而是创建一个私有对象并使用它。Lock(this) 可能导致死锁情况。下面的锁定对象可能只是关键部分的包装。如果您想跨不同进程保护资源，您将需要一个更重的命名互斥锁，这需要锁定内核对象并且成本很高，因此除非必须，否则不要使用。

4）您需要确保在那里也应用了锁定。但是当人们在这个引用上调用方法时，他们肯定会调用采用同步的方法。

# jquery - 需要了解 jQuery 对象和偏移量的解释

> ID：11925287
> 
> 赞同：0
> 
> 时间：2012-08-12T19:38:39.103
> 
> 标签：jquery

所以，`var $moving`我们正在创建 javascript 对象，对吧？但什么是`$('<li/>')`？它甚至不是一个 html 元素。

另外，偏移值描述了`$this`元素的值？那么，在这种情况下，元素`#slidingMenu li:first`?

```
var $menu = $("#slidingMenu");
var $selected = $menu.find('li:first');
var $moving   = $('<li/>',{
    className : 'move',
    top       : $selected[0].offsetTop + 'px',
    width     : $selected[0].offsetWidth + 'px'
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T19:50:34.473

> 所以，`var $moving`我们正在创建 javascript 对象，对吧？

不，您正在声明一个指向对象的 JavaScript 变量。

> 但什么是`$('<li/>')`？它甚至不是一个 html 元素。

它返回一个 jQuery 对象。在这种特殊情况下，该对象包含尚未附加到 DOM 的 HTML 元素，其类型在第一个参数 ( `<li>`) 中指定，并具有在第二个参数中指定的属性。

> 另外，偏移值描述了`$this`元素的值？那么，在这种情况下，元素`#slidingMenu li:first`?

不太确定您在这里做什么`$this`，该代码中没有。但是，由于`$selected`引用了一个包含该元素的 jQuery 对象，并且您正在使用`[0]`语法从中获取第一个（并且碰巧是唯一的）元素，是的，它确实引用了该元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T19:55:32.017

*   `$("#slidingMenu");`接受`#slidingMenu`和 $('#slidingMenu') 的引用返回一个 jQuery 对象。

*   `$menu.find('li:first');``li`在 中找到第一个`#slidingMenu`。

*   `$moving = $('<li/>', properties)`意思是，动态创建一个`jQuery-wrapped` `li`元素，但不添加到 DOM。[更多](https://stackoverflow.com/questions/10970705/what-does-div-do/10970713#10970713)。_

*   `$selected`是对 jQuery 对象的引用，并`$selected[0]`给出了一个元素引用/JavaScript 对象。但这并不意味着`$selected[0]`是对第一个对象和`$selected[1]`第二个对象的引用，依此类推。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T19:48:05.823

jQuery 函数重载。这个特殊的重载接受一个 HTML 元素`<li>`or `<li />`，后跟一组要在该元素上设置的属性，创建 jQuery 包装的 DOM 元素并在其上设置这些属性。请注意，仅当字符串包含单个元素时设置属性才有效 -`$("<a>text</a><div>otherel</div>", props)`无效。

第二点，jQuery 将 DOM 元素包装在它自己的对象中，让您可以访问它的 API。它的行为类似于数组，因此`[x]`将获取`x`集合中的第 th 个元素。 `$selected[0]`将获得集合中的第一个（并且仅在这种情况下）元素`$selected`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T19:48:34.080

`$('<li/>')`用 tag 创建一个空的 dom 元素`li`。是的，`$selected[0]`在这种情况下将是元素`#slidingMenu li:first.`

# java - 如何计算工厂全年每天夜班“待命”的员工有哪些？

> ID：11925288
> 
> 赞同：1
> 
> 时间：2012-08-12T19:38:45.237
> 
> 标签：java, io, calendar, scheduling

我正在编写我的第一个 Java 程序，该程序将用于实际目的，但我被困住了——得到一个不正确的输出。

这是我正在尝试计算的问题：我工作的制造工厂一年 363 天（圣诞节前夕和圣诞节期间）每天 24 小时 7 天运行，四天倒班。每个工作人员连续工作 4 个 12 小时的白天或夜晚，然后休息 4 天。有四个工作人员，每个工作四天，然后休息四天，然后工作四个晚上，然后休息四个晚上。A Crew 和 B Crew 彼此相反旋转，C Crew 和 D Crew 彼此相反旋转。

当 A 组和 B 组工作时，C 组和 D 组成员随时待命，以防 A 组或 B 组有人缺席。员工分为三类：高级操作员、初级操作员和复合操作员。每个工作人员有四名高级操作员、三名初级操作员和 2 名复合操作员。在四天轮换周期的前两天，三位高级接线员随叫随到，而第四位不随叫随到。在此期间不随叫随到的高级接线员轮换：每次其他人随叫随到时，一个不随叫随到。在过去的两天里，三位初级接线员随叫随到。

对于高级员工，上一个周期决定了他们是白班还是夜班待命：如果不工作的船员一直在白班工作，则高级操作员在前两天值班，反之亦然如果他们在上一个周期中一直在工作。对于初级操作员来说，他们即将开始的周期决定了他们在接下来的两天休息中是值班白班还是夜班。

复合工在第一天和第四天休息时随叫随到。他们是在白天还是晚上随叫随到，其决定方式与操作员相同。

我的目标是用 Java 编写一个程序，计算每天和每晚轮班值班的员工，并将结果输出到文本文件。我是一个业余爱好者，到目前为止只上过两门编程课，所以我确信我到目前为止所写的内容远没有它可能的效率那么高。我只是想弄清楚为什么输出不正确。我的怀疑是我要么错误地计算了一个变量，要么我完全错过了一块拼图。请注意，就该计划而言，一年的第一天是 1 月 3 日，因为第一天和第二天是上一年周期的一部分。

下面是我的代码。我删除了所有 getter 和 setter 以适应分配的长度。我感谢可以提供的任何和所有帮助。

```
 import java.io.File;
    import java.io.PrintWriter;
    import java.text.SimpleDateFormat;
    import java.util.Calendar;
    import java.util.Scanner;

    public class OnCallAug812 {
Calendar cal1 = Calendar.getInstance();
private double cycleDay = ((cal1.get(Calendar.DAY_OF_YEAR) - 3)) % 16;
private double dayOfCycle = cycleDay % 4;
// number of days into current rotation ( 0 =4, 1=1, 2=2, 3=3)
private int cycleRotation = (int) (cycleDay / 4);
// number of current rotation (4 per cycle)
private int cycleOfYear = ((cal1.get(Calendar.DAY_OF_YEAR) - 3) / 16);
private int onCallCycle = cycleOfYear % 4;

// A crew operators: 4 Senior
private int a1S = 0;
private int a2S = 1;
private int a3S = 2;
private int a4S = 3;

// variables for A crew names
private String a1;
private String a2;
private String a3;
private String a4;

// A Crew Junior Operators represented by one variable b/c
// all are on call or not on call at same time

private int aJr;

// A crew junior operator names
private String aJr1;
private String aJr2;
private String aJr3;

// B crew operators: 4 Senior
private int b1S = 0;
private int b2S = 1;
private int b3S = 2;
private int b4S = 3;

// B crew operator names
private String b1;
private String b2;
private String b3;
private String b4;

// B Crew Junior Operators represented by one variable b/c
// all are on call or not on call at same time

private int bJr;

// B crew operator junior names
private String bJr1;
private String bJr2;
private String bJr3;

// C crew operators: 4 Senior
private int c1S = 0;
private int c2S = 1;
private int c3S = 2;
private int c4S = 3;

// C operator senior names
private String c1;
private String c2;
private String c3;
private String c4;

// C Crew Junior Operators represented by one variable b/c
// all are on call or not on call at same time

private int cJr;

// C crew junior operator names
private String cJr1;
private String cJr2;
private String cJr3;

// D crew operators: 4 Senior
private int d1S = 0;
private int d2S = 1;
private int d3S = 2;
private int d4S = 3;

// d crew senior names
private String d1;
private String d2;
private String d3;
private String d4;

// D Crew Junior Operators represented by one variable b/c
// all are on call or not on call at same time

private int dJr;

// D crew junior operator names
private String dJr1;
private String dJr2;
private String dJr3;

// Call status for each A Crew employee--set to 0,1, or 2
// 0 = on call day shift
// 1 = on call night shift
// 2 = off call
private int a1SCallStat = -1;
private int a2SCallStat = -1;
private int a3SCallStat = -1;
private int a4SCallStat = -1;
private int aJrCallStat = -1;

// Call status for each B Crew employee--set to 0,1, or 2
private int b1SCallStat = -1;
private int b2SCallStat = -1;
private int b3SCallStat = -1;
private int b4SCallStat = -1;
private int bJrCallStat = -1;

// Call status for each C Crew employee--set to 0,1, or 2
private int c1SCallStat = -1;
private int c2SCallStat = -1;
private int c3SCallStat = -1;
private int c4SCallStat = -1;
private int cJrCallStat = -1;

// Call status for each D Crew employee--set to 0,1, or 2
private int d1SCallStat = -1;
private int d2SCallStat = -1;
private int d3SCallStat = -1;
private int d4SCallStat = -1;
private int dJrCallStat = -1;

// Call status for each crew's pelletizer operators (both on or both off)

private int aP;
private int bP;
private int cP;
private int dP;

private String aP1;
private String aP2;
private String bP1;
private String bP2;
private String cP1;
private String cP2;
private String dP1;
private String dP2;

private int aPCallStat = -1;
private int bPCallStat = -1;
private int cPCallStat = -1;
private int dPCallStat = -1;

public int determineCall(double onCallCycle, int crewNumber) {
    double aNumber = (crewNumber + onCallCycle) % 7;
    if (aNumber <= 2) {
        return 0;
    } else if (aNumber >= 3 && aNumber < 6) {
        return 1;
    } else if (aNumber == 6) {
        return 2;
    } else
        return -1;
}

public int determineCallJr(double onCallCycle, int crewNumber){
    double aNumber = (crewNumber + onCallCycle) % 7;
    if (aNumber <= 3) {
        return 0;
    } else if (aNumber >= 4 && aNumber <= 6) {
        return 1;
    } else
        return -1;
}

public int determineCallP(double onCallCycle, int crewNumber){
    double aNumber = (crewNumber + onCallCycle) % 7;
    if (aNumber <= 3) {
        return 0;
    } else if (aNumber >= 4 && aNumber <= 6) {
        return 1;
    } else
        return -1;
}

public void calcCall(OnCallAug812 aug1) {
    // Senior employees on call checks
    if ((aug1.cycleRotation == 0)
            && ((aug1.dayOfCycle == 1) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC1S()) == 0) {
            aug1.setC1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC1S()) == 1) {
            aug1.setC1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC1S()) == 2) {
            aug1.setC1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC2S()) == 0) {
            aug1.setC2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC2S()) == 1) {
            aug1.setC2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC2S()) == 2) {
            aug1.setC2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC3S()) == 0) {
            aug1.setC3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC3S()) == 1) {
            aug1.setC3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC3S()) == 2) {
            aug1.setC3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC4S()) == 0) {
            aug1.setC4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC4S()) == 1) {
            aug1.setC4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC4S()) == 2) {
            aug1.setC4SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD1S()) == 0) {
            aug1.setD1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD1S()) == 1) {
            aug1.setD1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD1S()) == 2) {
            aug1.setD1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD2S()) == 0) {
            aug1.setD2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD2S()) == 1) {
            aug1.setD2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD2S()) == 2) {
            aug1.setD2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD3S()) == 0) {
            aug1.setD3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD3S()) == 1) {
            aug1.setD3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD3S()) == 2) {
            aug1.setD3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD4S()) == 0) {
            aug1.setD4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD4S()) == 1) {
            aug1.setD4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD4S()) == 2) {
            aug1.setD4SCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 1)
            && ((aug1.dayOfCycle == 1) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA1S()) == 0) {
            aug1.setA1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA1S()) == 1) {
            aug1.setA1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA1S()) == 2) {
            aug1.setA1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA2S()) == 0) {
            aug1.setA2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA2S()) == 1) {
            aug1.setA2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA2S()) == 2) {
            aug1.setA2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA3S()) == 0) {
            aug1.setA3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA3S()) == 1) {
            aug1.setA3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA3S()) == 2) {
            aug1.setA3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA4S()) == 0) {
            aug1.setA4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA4S()) == 1) {
            aug1.setA4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA4S()) == 2) {
            aug1.setA4SCallStat(2);
        }

        // b crew second rotation
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB1S()) == 0) {
            aug1.setB1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB1S()) == 1) {
            aug1.setB1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB1S()) == 2) {
            aug1.setB1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB2S()) == 0) {
            aug1.setB2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB2S()) == 1) {
            aug1.setB2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB2S()) == 2) {
            aug1.setB2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB3S()) == 0) {
            aug1.setB3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB3S()) == 1) {
            aug1.setB3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB3S()) == 2) {
            aug1.setB3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB4S()) == 0) {
            aug1.setB4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB4S()) == 1) {
            aug1.setB4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB4S()) == 2) {
            aug1.setB4SCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 2)
            && ((aug1.dayOfCycle == 1) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC1S()) == 0) {
            aug1.setC1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC1S()) == 1) {
            aug1.setC1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC1S()) == 2) {
            aug1.setC1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC2S()) == 0) {
            aug1.setC2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC2S()) == 1) {
            aug1.setC2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC2S()) == 2) {
            aug1.setC2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC3S()) == 0) {
            aug1.setC3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC3S()) == 1) {
            aug1.setC3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC3S()) == 2) {
            aug1.setC3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC4S()) == 0) {
            aug1.setC4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC4S()) == 1) {
            aug1.setC4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getC4S()) == 2) {
            aug1.setC4SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD1S()) == 0) {
            aug1.setD1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD1S()) == 1) {
            aug1.setD1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD1S()) == 2) {
            aug1.setD1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD2S()) == 0) {
            aug1.setD2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD2S()) == 1) {
            aug1.setD2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD2S()) == 2) {
            aug1.setD2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD3S()) == 0) {
            aug1.setD3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD3S()) == 1) {
            aug1.setD3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD3S()) == 2) {
            aug1.setD3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD4S()) == 0) {
            aug1.setD4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD4S()) == 1) {
            aug1.setD4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getD4S()) == 2) {
            aug1.setD4SCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 3)
            && ((aug1.dayOfCycle == 1) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA1S()) == 0) {
            aug1.setA1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA1S()) == 1) {
            aug1.setA1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA1S()) == 2) {
            aug1.setA1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA2S()) == 0) {
            aug1.setA2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA2S()) == 1) {
            aug1.setA2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA2S()) == 2) {
            aug1.setA2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA3S()) == 0) {
            aug1.setA3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA3S()) == 1) {
            aug1.setA3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA3S()) == 2) {
            aug1.setA3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA4S()) == 0) {
            aug1.setA4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA4S()) == 1) {
            aug1.setA4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getA4S()) == 2) {
            aug1.setA4SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB1S()) == 0) {
            aug1.setB1SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB1S()) == 1) {
            aug1.setB1SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB1S()) == 2) {
            aug1.setB1SCallStat(2);
        }
        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB2S()) == 0) {
            aug1.setB2SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB2S()) == 1) {
            aug1.setB2SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB2S()) == 2) {
            aug1.setB2SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB3S()) == 0) {
            aug1.setB3SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB3S()) == 1) {
            aug1.setB3SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB3S()) == 2) {
            aug1.setB3SCallStat(2);
        }

        if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB4S()) == 0) {
            aug1.setB4SCallStat(0);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB4S()) == 1) {
            aug1.setB4SCallStat(1);
        } else if (aug1.determineCall(aug1.getOnCallCycle(), aug1.getB4S()) == 2) {
            aug1.setB4SCallStat(2);
        }
    }

    // Junior Extruder Operators
    if ((aug1.cycleRotation == 0)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 2))) {
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getcJr()) == 0) {
            aug1.setcJrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getcJr()) == 1) {
            aug1.setcJrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getcJr()) == 2) {
            aug1.setcJrCallStat(2);
        }
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getdJr()) == 0) {
            aug1.setDjrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getdJr()) == 1) {
            aug1.setDjrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getdJr()) == 2) {
            aug1.setDjrCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 1)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 2))) {
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getaJr()) == 0) {
            aug1.setaJrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getaJr()) == 1) {
            aug1.setaJrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getaJr()) == 2) {
            aug1.setaJrCallStat(2);
        }
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getbJr()) == 0) {
            aug1.setbJrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getbJr()) == 1) {
            aug1.setbJrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getbJr()) == 2) {
            aug1.setbJrCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 2)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 2))) {
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getcJr()) == 0) {
            aug1.setcJrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getcJr()) == 1) {
            aug1.setcJrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getcJr()) == 2) {
            aug1.setcJrCallStat(2);
        }
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getdJr()) == 0) {
            aug1.setDjrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getdJr()) == 1) {
            aug1.setDjrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getdJr()) == 2) {
            aug1.setDjrCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 3)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 2))) {
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getaJr()) == 0) {
            aug1.setaJrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getaJr()) == 1) {
            aug1.setaJrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getaJr()) == 2) {
            aug1.setaJrCallStat(2);
        }
        if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getbJr()) == 0) {
            aug1.setbJrCallStat(1);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getbJr()) == 1) {
            aug1.setbJrCallStat(0);
        } else if (aug1.determineCallJr(aug1.getOnCallCycle(), aug1.getbJr()) == 2) {
            aug1.setbJrCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 0)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getcP()) == 0) {
            aug1.setcPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getcP()) == 1) {
            aug1.setcPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getcP()) == 2) {
            aug1.setcPCallStat(2);
        }
        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getdP()) == 0) {
            aug1.setdPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getdP()) == 1) {
            aug1.setdPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getdP()) == 2) {
            aug1.setdPCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 1)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getaP()) == 0) {
            aug1.setaPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getaP()) == 1) {
            aug1.setaPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getaP()) == 2) {
            aug1.setaPCallStat(2);
        }

        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getbP()) == 0) {
            aug1.setbPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getbP()) == 1) {
            aug1.setbPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getbP()) == 2) {
            aug1.setbPCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 2)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getcP()) == 0) {
            aug1.setcPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getcP()) == 1) {
            aug1.setcPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getcP()) == 2) {
            aug1.setcPCallStat(2);
        }
        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getdP()) == 0) {
            aug1.setdPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getdP()) == 1) {
            aug1.setdPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getdP()) == 2) {
            aug1.setdPCallStat(2);
        }
    }

    if ((aug1.cycleRotation == 3)
            && ((aug1.dayOfCycle == 3) || (aug1.dayOfCycle == 0))) {
        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getaP()) == 0) {
            aug1.setaPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getaP()) == 1) {
            aug1.setaPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getaP()) == 2) {
            aug1.setaPCallStat(2);
        }
        if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getbP()) == 0) {
            aug1.setbPCallStat(0);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getbP()) == 1) {
            aug1.setbPCallStat(1);
        } else if (aug1.determineCallP(aug1.getOnCallCycle(), aug1.getbP()) == 2) {
            aug1.setbPCallStat(2);
        }
    }
}

private String readFile(String pathname) throws Exception {

    File file = new File(pathname);
    StringBuilder fileContents = new StringBuilder((int) file.length());
    Scanner scanner = new Scanner(file);
    String lineSeparator = System.getProperty("line.separator");

    try {
        while (scanner.hasNextLine()) {
            fileContents.append(scanner.nextLine() + lineSeparator);
        }
        return fileContents.toString();
    } finally {
        scanner.close();
    }
}

public void check0(PrintWriter output2, int callStat, String name) {
    if (callStat == 0) {
        output2.print(name);
        output2.println();
    }
}

public void check1(PrintWriter output2, int callStat, String name) {
    if (callStat == 1) {
        output2.print(name);
        output2.println();
    }
}

public void addDate(OnCallAug812 aug1) {
    cal1.add(Calendar.DATE, 1);
    aug1.cycleDay = ((cal1.get(Calendar.DAY_OF_YEAR) - 3)) % 16;
    aug1.dayOfCycle = cycleDay % 4;
    // number of days into current rotation ( 0 =4, 1=1, 2=2, 3=3)
    aug1.cycleRotation = (int) (cycleDay / 4);
    // number of current rotation (4 per cycle)
    aug1.cycleOfYear = ((cal1.get(Calendar.DAY_OF_YEAR) - 2) / 16);
    aug1.onCallCycle = cycleOfYear % 4;
}

public static void main(String[] args) throws Exception {
    OnCallAug812 aug1 = new OnCallAug812();
    aug1.calcCall(aug1);
    System.out.print("Day of 16 day rotation(0 to 15): ");
    System.out.println(aug1.cycleDay);
    System.out.print("Day of 4 day cycle (0 to 3): ");
    System.out.println(aug1.dayOfCycle);
    System.out.print("Cycle of 16 day rotation (0 to 3): ");
    System.out.println(aug1.cycleRotation);
    System.out.print("16 day cycle number (0 to 22): ");
    System.out.println(aug1.cycleOfYear);
    System.out.print("On Call Cycle Number(0 to 6 then repeat): ");
    System.out.println(aug1.onCallCycle);
}

public OnCallAug812() {
    super();
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:07:46.790

对于初学者来说，这是一个很好的 OOP 项目。话虽如此，您需要以 oop 样式设计它。正确执行此操作的第一步，甚至接近获得使用多态性设计此程序的正确答案的第一步。

A) 第一步是创建一个 Employee 类，然后创建子类 Senior、Junior 和 Compound。这些类将包含有关该雇员最后操作的跟踪信息（布尔值班、布尔值班（白天）等）

B) 下一步将是弄清楚你将如何创建一个船员，可能是另一个班级。然后，船员班可以跟踪诸如谁最后工作、他们工作的班次、谁最后没有随叫随到等因素。该班级将包含员工组。

这将是正确设计该程序的开始。一旦你到达这一点，如果你仍然被卡住，有人会帮助你进入下一个阶段。

如果您需要如何执行此操作的示例，您可以查看我的 ProGauge 项目，该项目使用不同类型的设备执行类似操作，例如：[http ://www.behance.net/gallery/ProGauge-Project-in-java-JSON-数据管理/4668415](http://www.behance.net/gallery/ProGauge-Project-in-java-JSON-Data-management/4668415)或者只是在网上找到一些 java 多态示例！

# c# - 控制文本框以保存键入的数据

> ID：11925292
> 
> 赞同：1
> 
> 时间：2012-08-12T19:39:11.907
> 
> 标签：c#, asp.net, textbox, hint

我正在编写 asp.net C# 项目并在 Chrome 浏览器中进行测试。

该页面包含几个文本框：一个用于用户名，一个用于电子邮件，一个用于电话，密码等。

我运行项目并填充文本框。下次当我开始在用户名文本框中输入所有之前输入的单词时，包括电子邮件、地址、电话……开始在文本框下显示为提示，例如，如下图所示（但这并不完全在我的项目中）： ![在此处输入图像描述](../Images/8f0d01b47430c96684417cc11178cb44.png)

假设堆栈溢出是之前在此文本框中输入的用户名，而 stackhash_0a9e 是之前在地址文本框中输入的用户地址。我希望 stackkash_0a9e 不会出现在这个文本框中，当用户在那里输入时，它应该出现在地址的文本框中。

有没有解决方案，如果有怎么办？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T23:14:28.473

文本框只显示输入的数据，我不知道为什么你的用户名文本框也显示用户地址，可能你在用户名文本框中输入了用户地址。由于视图状态，文本框保留了先前的值。您可以禁用视图状态，但它仍会显示以前的数据，因为它也缓存在浏览器中。禁用缓存添加`ViewStateMode`到您的文本框并将其设置为`ViewStateMode="Disabled"`ViewStateMode 仅在 .net 4 中可用

```
 <asp:TextBox ID="TextBox1" runat="server" ViewStateMode="Disabled"></asp:TextBox> 
```

# c# - 正则表达式 - 在线任何地方的负面回顾

> ID：11925305
> 
> 赞同：6
> 
> 时间：2012-08-12T19:40:49.710
> 
> 标签：c#, .net, regex, pattern-matching

只有在同一行之前没有特定字符时，如何匹配模式？

我有以下正则表达式代码：

```
pattern = @"(?<=^|[\s.(<;])(?<!//)(" + Regex.Escape(keyword) + @")(?=[\s.(>])";
replacement = "<span style='" + keywordStyle + "'>$1</span>";
code = Regex.Replace(code, pattern, replacement); 
```

我想添加一个条件以仅在同一行之前没有 2 个斜杠时才匹配（C# 注释）。

我玩弄了它，并修改了模式：

```
pattern = @"(?<!\/\/)(?<=^|[\s.(<;])(?<!//)(" + Regex.Escape(keyword) + @")(?=[\s.(>])"; 
```

但显然，这只有在 2 个斜线是关键字**之前的 2 个字符时才有效。**

所以这个模式不会匹配“//foreach”，但会匹配“// foreach”。

在这种情况下可以使用负面的后视，或者我可以通过其他方式来完成这个，除了消极的后视吗？

谢谢你。

**编辑：**

估计我说的不够清楚。重申我的问题：

我正在研究语法高亮，我需要找到 c# 关键字的匹配项，例如“foreach”。但是，我还需要考虑由 2 个斜线定义的注释。如果关键字“foreach”是注释的一部分，我不想匹配它（在同一行之前的任何位置有 2 个斜线。

在这种情况下，否定的lookbehind对我没有帮助，因为斜杠不一定在关键字之前，例如“// some text foreach” - 我不希望这个foreach匹配。

再说一次，我的问题是：如何修改我的模式以仅在同一行上没有两个斜杠的情况下才匹配？

希望我的问题现在很清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T22:27:25.117

稍微简化一下你的正则表达式模式，下面的呢？它利用“//”上的非贪婪匹配加上之后的0个或更多字符。

```
(?<!//.*?)(?<Keyword>foreach) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T19:58:26.690

在不确切知道您正在尝试什么的情况下，很难说出最佳解决方案，但很可能只是在您尝试使用正则表达式之前检查行首的 //，特别是如果每​​行可能有多个关键字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T05:36:36.623

试试这个：

```
^\s*(?<!//.*)\s*foreach 
```

对于 c# 代码分析，请尝试来自*codeplex*的可靠且开源的[Irony - .NET Language Implementation Kit](http://irony.codeplex.com/)。

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-16T21:54:41.777

如果您正在使用语法突出显示，您真的应该看看这篇 CodeProject 文章： [用于语法突出显示的快速彩色文本框](http://www.codeproject.com/Articles/161871/Fast-Colored-TextBox-for-syntax-highlighting) 这个项目是关于一个代码编辑器窗口，它也进行语法突出显示，它使用正则表达式。也许它可以满足您的需求（也许更多）。似乎这篇文章的作者对语法突出显示做了很多思考。我尝试了你在这里谈到的 foreach，如果它是评论的一部分，我尝试了“foreach”，它显示得很好。*

# android - 光标的 getLong() 和 getString() 在模拟器上工作，但不是等效设备

> ID：11925308
> 
> 赞同：0
> 
> 时间：2012-08-12T19:41:24.360
> 
> 标签：android, android-emulator

为什么可以在模拟器`Cursor.getLong()`上`Cursor.getString()`正常工作，但在运行相同版本 Android 的实际设备上却不能？

[我对 Android记事本教程](http://developer.android.com/training/notepad/index.html)的第三版进行了一些补充，其中涉及以编程方式更改笔记的标题。[（我最近在获取当前 Android 视图并强制重新绘制](https://stackoverflow.com/questions/11912390/obtaining-the-current-android-view-and-forcing-it-to-be-redrawn)该项目时询问了该项目。）我的更改在我的模拟器中运行良好，但在我的测试手机上导致应用程序结束“不幸的是，程序已停止”。

这是发生这种情况的方法：

```
public void expandNoteTitle(int i) {
    Cursor note = fetchNote(i);
    long rowId =
      note.getLong(note.getColumnIndexOrThrow(NotesDbAdapter.KEY_ROWID));
    String title =
      note.getString(note.getColumnIndexOrThrow(NotesDbAdapter.KEY_TITLE)) + "W";
    String body =
      note.getString(note.getColumnIndexOrThrow(NotesDbAdapter.KEY_BODY));
    updateNote(rowId, title, body);
} 
```

我知道获取光标至少部分有效，因为`note.getColumnName(1)`在调试器中工作正常。我还确认了这些论点`getLong()`并`getString()`正确显示。

这是 LogCat 输出：

```
08-12 15:35:29.735: D/AndroidRuntime(17937): Shutting down VM
08-12 15:35:29.735: W/dalvikvm(17937): threadid=1: thread exiting with uncaught exception (group=0x40a3d1f8)
08-12 15:35:29.751: E/AndroidRuntime(17937): FATAL EXCEPTION: main
08-12 15:35:29.751: E/AndroidRuntime(17937): android.database.CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0
08-12 15:35:29.751: E/AndroidRuntime(17937):    at android.database.AbstractCursor.checkPosition(AbstractCursor.java:400)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:136)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at android.database.AbstractWindowedCursor.getLong(AbstractWindowedCursor.java:74)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at notepad.NotesDbAdapter.expandNoteTitle(NotesDbAdapter.java:212)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at notepad.NotesDbAdapter.expandNoteTitles(NotesDbAdapter.java:201)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at notepad.NotepadMain.expandTitles(NotepadMain.java:167)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at notepad.NotepadMain.onMenuItemSelected(NotepadMain.java:115)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at com.android.internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:950)
08-12 15:35:29.751: E/AndroidRuntime(17937):    at [SNIPPED FOR LENGTH]
08-12 15:35:29.751: E/AndroidRuntime(17937):    at dalvik.system.NativeStart.main(Native Method)
08-12 15:36:49.993: I/Process(17937): Sending signal. PID: 17937 SIG: 9 
```

这是`fetchNote()`. 除了变量名外，它与教程中给出的版本相同。

```
public Cursor fetchNote(long rowId) throws SQLException {
    Cursor mCursor = database.query(true, DATABASE_TABLE, new String[] {
      KEY_ROWID, KEY_TITLE, KEY_BODY }, KEY_ROWID + "=" + rowId, null,
      null, null, null, null);
    if(mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T19:56:18.133

> 游标的 getLong() 和 getString() 在模拟器上工作，但在等效设备上不工作......我知道获取游标至少部分工作，因为 note.getColumnName(1) 在调试器中工作正常。我还确认 getLong() 和 getString() 的参数正确显示。

Cursor 的 getLong() 和 getString() 方法在模拟器和实际设备上的工作方式相同。

如果您查看 LogCat，您会发现问题的原因是没有数据：

> android.database.CursorIndexOutOfBoundsException: 请求索引 0，大小为 0

光标似乎是空的，您的表（在设备上）是否有任何行？

* * *

**从评论中添加**

正如我们发现的那样，您假设所有行 ID 都是连续的，但事实并非如此。以下是我获取正确数据并防止任何未来强制关闭光标的两个建议：

1.  获取所有现有的行 ID 并遍历它们：

    ```
    Cursor notes = database.query(DATABASE_TABLE, new String[] { KEY_ROWID }, null, null, null, null, null, null);

    while(notes.moveToNext()) 
        expandNoteTitle(notes.getLong(0)); 
    ```

    要遍历新游标，您只需检查 moveToNext() 的返回值。当光标的索引设置为`-1`（就像它是新的一样）时，moveToNext() 将移动到索引`0`并`true`仅在有有效数据时返回，否则如果没有行 moveToNext() 则返回`false`。

2.  始终假设 Cursor 可能为空，并理解空游标**不**等于`null`：

    ```
    public Cursor fetchNote(long rowId) throws SQLException {
        return database.query(true, DATABASE_TABLE, 
                new String[] { KEY_ROWID, KEY_TITLE, KEY_BODY }, 
                KEY_ROWID + "=" + rowId, null, null, null, null, null);
    }

    public void expandNoteTitle(long rowId) {
        Cursor note = fetchNote(rowId);
        if(note.getCount() > 0) {
            // You could also use if(cursor.moveToNext()) or if(cursor.moveToFirst()), both of these return true / false depending on whether there is valid data

            String title =
              note.getString(note.getColumnIndexOrThrow(NotesDbAdapter.KEY_TITLE)) + "W";
            String body =
              note.getString(note.getColumnIndexOrThrow(NotesDbAdapter.KEY_BODY));
            updateNote(rowId, title, body);
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T06:26:24.290

这里的差异是巧合造成的。在我问这个问题时，我从未在模拟器中删除过笔记。结果，我在那里的笔记的数据库 ID 为 1、2、3 和 4。当我要求数据库返回它包含的笔记数量时，我设置了一个

```
for(int i = 1; i <= numberOfNotes; i++) { ... } 
```

环形。这仅与现有 ID 匹配，因为在创建笔记时为 ID 分配了下一个最高整数。在设备上，我删除了一些笔记，所以 ID 不是一个很好的 1 对 n 序列。下面是代码的样子：

```
public void expandNoteTitles() {
    Cursor notes = database.query(DATABASE_TABLE, new String[] { KEY_ROWID },
      null, null, null, null, null, null);
    notes.moveToFirst();

    for(int i = 0; i < notes.getCount(); i++) {
        expandNoteTitle(notes.getLong(0));
        notes.moveToNext();
    }
}

public void expandNoteTitle(long rowId) {
    Cursor note = fetchNote(rowId);
    String title =
      note.getString(note.getColumnIndexOrThrow(NotesDbAdapter.KEY_TITLE)) + "W";
    String body =
      note.getString(note.getColumnIndexOrThrow(NotesDbAdapter.KEY_BODY));
    updateNote(rowId, title, body);
} 
```

# r - 将 ggplot 中的比例设置为 r 中的 1:1

> ID：11925309
> 
> 赞同：4
> 
> 时间：2012-08-12T19:41:30.417
> 
> 标签：r, ggplot2

我想将下图中的 x 和 y 轴设置为具有相同的比例距离（即 x 轴上的 0.1 与 y 轴上的 0.1 长度相同）。有什么建议吗？谢谢。

```
df <-data.frame(x = c(0,0.2,0.5), y = c(0.6,0.7,0.9))

p <-ggplot(df, aes(x, y, ymin=0, ymax=1, xmin=0, xmax=1))

p <- p + geom_point(alpha=2/10, shape=21, fill="blue", colour="black", size=5)

grid.arrange(p, p,ncol=1)

p 
```

![在此处输入图像描述](../Images/90f0515b426e302648d5a269086c3594.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-12T20:05:25.570

你需要使用`coord_equal()`

```
df <-data.frame(x = c(0,0.2,0.5), y = c(0.6,0.7,0.9))
p <-ggplot(df, aes(x, y, ymin=0, ymax=1, xmin=0, xmax=1))
p <- p + geom_point(alpha=2/10, shape=21, fill="blue", colour="black", size=5)

p + coord_equal() 
```

![在此处输入图像描述](../Images/7ca42fe6e87a7c1c4569e51c89a9362e.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:08:01.327

您需要将图形设备的宽度和高度设置为 height = 2*width

```
library('ggplot2')
library('gridExtra')
df <-data.frame(x = c(0,0.2,0.5), y = c(0.6,0.7,0.9))

p <-ggplot(df, aes(x, y, ymin=0, ymax=1, xmin=0, xmax=1))

p <- p + geom_point(alpha=2/10, shape=21, fill="blue", colour="black", size=5)

w <- 550
png("test.png", width=w, height=2*w, units="px")

grid.arrange(p, p,ncol=1)

dev.off() 
```

![测试.png](../Images/176296e17352b13d4e850d29439f57cb.png)

# c# - 带有逻辑 AND 的“HTML 敏捷包”XPath 查询

> ID：11925311
> 
> 赞同：1
> 
> 时间：2012-08-12T19:41:37.600
> 
> 标签：c#, xpath, html-agility-pack

我正在尝试在 HTML 文档中查找表，其中前 2 行包含 3 列，其中包含文本。

我尝试使用以下查询，我想返回表的前 2 行在第一列中包含文本的节点：

```
string xpath = @"//table//table[//tr[1]//td[1]//*[contains(text(), *)] and //tr[2]//td[1]//*[contains(text(), *)]]";
HtmlNode temp = doc.DocumentNode.SelectSingleNode(xpath); 
```

它不能正常工作，伙计。

这是一些示例 HTML，这是我要匹配的表：

```
 <table width="100%" cellpadding="0" border="0">
       <tbody>
       <tr>
          <td width="27%" valign="center"><b><font size="1" face="Helvetica">SOME TEXT<br></font></b></td>
          <td width="1%"></td>
          <td width="9%" valign="center"><font size="1" face="Helvetica">SOME TEXT<br></font></td>
          <td width="1%"></td>
          <td width="25%" valign="center"><font size="1" face="Helvetica">SOME TEXT<br></font></td>
          <td width="37%"></td>
       </tr>
       <tr>
          <td valign="center"><font size="1" face="Helvetica">SOME TEXT<br></font></td>
          <td></td>
          <td valign="center"><font size="1" face="Helvetica">1<br></font></td>
          <td></td>
          <td valign="center"><font size="1" face="Helvetica">SOME TEXT<br></font></td>
          <td></td>
       </tr>
       </tbody>
</table> 
```

您注意到第 1、3、5 列在前 2 行中有文本。这就是我想要匹配的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:59:59.947

```
//table//table[//tr[1]//td[1]//*[contains(text(), *)] and //tr[2]//td[1]//*[contains(text(), *)]] 
```

**这个 XPath 表达式有*很多*问题**：

1.  `//table//table`选择任何`table`a 的后代`table`。但是，在提供的 XML 文档中没有嵌套表。

2.  `table[//tr[1]//td[1]//*[contains(text(), *)]`. 谓词内部`//tr`是一个*绝对*Xpath 表达式——它选择*整个文档*`tr`中的所有元素——而不仅仅是在这个元素的根子树中。很可能你想要而不是.*`table``.//tr``//tr`*

**   `//td[1]`选择作为其父`td`元素的第一个子元素的任何元素——但很可能您只需要第一个后代元素。如果是这样，您需要使用这个 XPath 表达式：`td``td``(//td)[1]`

    *   `//*[contains(text(), *)]`这将选择其第一个文本节点子节点包含第一个元素子节点的字符串值的任何元素——但您只是想验证 a`td`是否具有后代文本子节点——这可以通过以下方式正确选择：`td[.//text()]`* 

 ***结合所有这些问题的更正，您可能想要的是**：

```
 //table
     [(.//tr)[1]/td[1][.//text()]
    and
      (.//tr)[2]/td[1][.//text()]
     ] 
```

**或者，可以编写一个等效但更易于理解且不易出错的表达式，如下所示：**

```
//table
  [descendant::tr[1]/td[1][descendant::text()]
 and
   descendant::tr[1]/td[1][descendant::text()]
  ] 
```*

# c# - 通过在 C# 中切割边缘从图像中提取对象

> ID：11925315
> 
> 赞同：0
> 
> 时间：2012-08-12T19:42:26.983
> 
> 标签：c#, crop

我正在尝试使用 AForge.net 从图像的背景中裁剪对象。我已经使用 cannyEegeDetector 检测到对象的边缘，但我不知道如何使用检测到的边缘来裁剪它。你有什么想法可以从背景中裁剪对象吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-12T19:57:44.700

我对 CannyEdgeDetector 返回的数据结构一无所知，但您可能希望使用类似于选定区域中的轮廓填充的算法来处理它（有点像 MS Paint 中的填充桶）。在图像的每一行像素上，从图像的左侧开始向右扫描，每次越过边界时，切换是否在“填充区域”中。填充区域中的像素被保留，其外部的像素被裁剪。希望有帮助！

# java - java代码的时间复杂度

> ID：11925316
> 
> 赞同：4
> 
> 时间：2012-08-12T19:42:52.883
> 
> 标签：java, algorithm, time-complexity

我正在学习 coursera 上的算法课程，但我被困在这个特殊问题上。我应该找到这段代码的时间复杂度。

```
int sum = 0

 for (int i = 1; i <= N*N; i = i*2)

  {
     for (int j = 0; j < i; j++)
           sum++; 
  } 
```

我在 Eclipse 本身中检查了它，对于任何 N 值，执行 sum 语句的次数都小于 N

```
final value of sum:
for N=8 sum=3 
for N=16 sum=7 
for N=100000 sum=511 
```

所以时间复杂度应该小于 N 但给出的答案是 N 的 2 次幂，这怎么可能？

到目前为止我做了什么：

第一个循环将运行 log(N^2) 次，因此第二个循环将执行 1,2,3.. 2 logN

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:50:41.083

第一个内部循环是 1 + 2 + 4 + 8 .. 2^M，其中 2^M <= N * N。

2 到 N * N 的幂的总和约为 2 * N * N 或 O(N ^ 2)

注意：当 N=100000 时，N*N 将溢出，因此其结果具有误导性。如果您认为溢出是问题的一部分，那么对于大数来说，总和是相当随机的，因此您可以争论它的 O(1)，即如果 N=2^15，N^2 = 2^30，总和将为整数.MAX_VALUE。没有更高的 N 值会给出更高的总和。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-12T19:52:19.400

这里有很多混淆，但重要的是[Big-O 符号](http://en.wikipedia.org/wiki/Big_O_notation)是关于*增长率*的，或者数学家会说的*限制行为。*函数将在 O(n*n) 中执行意味着执行时间将比例如*n增加得更快，但比例如**2^n*慢。

使用[大 O 表示法](http://en.wikipedia.org/wiki/Big_O_notation)进行推理时，请记住常量“不算数”。这个特定问题有一些怪癖。

*   如果循环是常规的`N*N`for 循环，则表达式 it-self 将导致 O(log n*n) 复杂度...
*   ...但是，for循环增量导致外部循环大约执行 log n 并且如果内部循环的内容在独立于*n*`i = i*2`的时间内运行，则函数将在 O(log n) 中。
**   但同样，内循环运行时间取决于*n*，但它不执行 n*n 运行，而是大致记录 (n*n)/2 个循环。记住“常数不算数”并且我们最终会得到 O(n*n)。*

 *希望这可以解决问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-12T20:13:34.277

所以 sum ++ 将被执行 1 + 2 + 4 + 8 + ... + N*N，总共 log2(N*N) 次。几何级数之和 1 * (1 - 2 ^ log2(N*N)/(1 - 2) = O(N*N)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T19:51:37.950

你的外循环是 log(N^2)->2*log(N)->log(N)，你的内循环是 N^2/2->N^2。因此，时间复杂度为 N^2*log(N)。

关于基准，N=8 或 N=16 的值是荒谬的，循环中的时间与设置 JVM、缓存失败等有关。你必须：

从最大的 N 开始，并检查它是如何评估的。

使用每个 N 值进行多次运行。

认为时间复杂度是当 N 变得非常大时算法如何工作的度量。*

# javascript - 隐藏数千个的最快方法 元素？

> ID：11925318
> 
> 赞同：13
> 
> 时间：2012-08-12T19:42:57.540
> 
> 标签：javascript, jquery, optimization, hide

我有一个自动完成表单，用户可以在其中输入一个术语，它会隐藏所有`<li>`不包含该术语的元素。

`<li>`我最初使用 jQuery遍历所有内容`each`并应用于`.hide()`不包含该术语的那些。这太慢了。

我发现一种更快的方法是遍历所有内容`<li>`并将类`.hidden`应用于所有需要隐藏的内容，然后在循环结束时执行`$('.hidden').hide()`. 不过，这感觉有点骇人听闻。

一种可能更快的方法可能是`.hidden`使用`document.styleSheets`. 谁能想到更好的方法？

编辑：让我澄清一些我不确定有多少人知道的事情。如果您在循环的每次迭代中更改 DOM，并且该更改会导致页面被重绘，那么这将比“准备”所有更改并在循环完成时立即应用它们要慢得多。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-12T20:05:21.203

每当您处理数千个项目时，DOM 操作**都会**很慢。循环遍历许多 DOM 元素并根据元素的特征来操作每个元素通常不是一个好主意，因为这涉及在每次迭代中对 DOM 方法的大量调用。如您所见，它真的很慢。

更好的方法是将*数据*与 DOM 分开。搜索 JS 字符串数组要快几个数量级。

这可能意味着将您的数据集加载为 JSON 对象。如果这不是一个选项，您可以遍历`<li>`s 一次（在页面加载时），并将数据复制到一个数组中。

现在您的数据集不依赖于存在的 DOM 元素，您可以在每次用户键入时简单地替换`<ul>`using的全部内容。`.html()`（这比 JS DOM 操作要快得多，因为浏览器可以优化 DOM 更改，只需更改`innerHTML`.）

```
var dataset = ['term 1', 'term 2', 'something else', ... ];

$('input').keyup(function() {
    var i, o = '', q = $(this).val();
    for (i = 0; i < dataset.length; i++) {
        if (dataset[i].indexOf(q) >= 0) o+='<li>' + dataset[i] + '</li>';
    }
    $('ul').html(o);
}); 
```

[如您所见](http://jsfiddle.net/josh3736/uaSMq/)，这是非常快的。

* * *

但是请注意，如果您[将其增加到 10,000 个项目](http://jsfiddle.net/josh3736/uaSMq/3/)，则在前几次击键时性能开始受到影响。这与插入到 DOM 中的结果数量有关，而不是与正在搜索的原始项目数量有关。（随着您键入的内容越多，要显示的结果越少，性能也很好——即使它仍在搜索所有 10,000 个项目。）

为避免这种情况，我会考虑将显示的结果数量限制在一个合理的范围内。（1,000 似乎和任何一个一样好。）这是自动完成；没有人真正查看所有结果——他们将继续输入，直到结果集可供人类管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-14T09:43:12.130

我知道这是个老问题，但我对任何答案都不满意。目前我正在开发一个使用 jQuery Selectable 列表的 Youtube 项目，该列表包含大约 120.000 个项目。这些列表可以按文本过滤，然后显示相应的项目。隐藏所有不匹配元素的唯一可接受的方法是先隐藏 ul 元素，而不是隐藏 li 元素并再次显示 list(ul) 元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T19:44:53.193

您可以直接选择所有 <li>，然后过滤它们：（`$("li").filter(function(){...}).hide()`请参阅[此处](http://api.jquery.com/filter/)）

（对不起，我之前发错了）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-12T19:55:33.797

您可以使用 jQuery contains() 选择器来查找列表中具有特定文本的所有项目，然后将其隐藏，如下所示：

HTML：

```
 <ul id="myList">
      <li>this</li>
      <li>that</li>
 <ul>​ 
```

jQuery

```
var term = 'this';    
$('li:contains("' + term + '")').hide();​ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-12T20:26:12.957

您可以使用更独特的技术，在技术上不使用 JavaScript 来进行实际隐藏，方法是将数据副本放入属性中，并使用 CSS 属性选择器。

例如，如果术语是`secret`，并且您将数据的副本放在`data-term`属性中，则可以使用以下 CSS：

```
li[data-term*="secret"] {
    display: none;
} 
```

要动态执行此操作，您必须在 javascript 中向头部添加样式：

```
function hideTerm(term) {
    css = 'li[data-term*="'+term+'"]{display:none;}'
    style = $('<style type="text/css">').text(css)
    $('head').append(style);
} 
```

如果您要这样做，您需要确保在停止使用样式标签时清理它们。

这可能是最快的，因为 CSS 选择在现代浏览器中非常快。很难进行基准测试，所以我不能肯定地说。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-12T19:46:30.863

怎么样：

```
<style>
    .hidden{ display: none; }
</style> 
```

这样您就不必使用 $('.hidden').hide() 进行额外的查询？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-12T19:53:51.923

无需重新定义样式表规则，您可以直接将“隐藏”类属性定义为“显示：无”；在您的页面之前，您可以在通过 javascript 验证条件后应用您定义的类，如下所示。

```
$("li").each(function(){if(condition){$(this).addClass('hide');}}); 
```

之后，如果你想再次显示那些 li，你可以像下面这样删除类

```
$("li").each(function(){if(condition){$(this).removeClass('hide');}}); 
```

# android - 回收位图的后果？

> ID：11925325
> 
> 赞同：0
> 
> 时间：2012-08-12T19:43:30.357
> 
> 标签：android, memory, bitmap, frame-rate

嗨，在我的应用程序中，我有一个非常频繁出现的爆炸动画。创建爆炸时，我从资源中加载 3 张图像，然后在爆炸动画结束后回收这 3 张图像。我经常这样做，并注意到帧率下降。他们是像静态位图之类的更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:15:04.793

我曾经做过一个应用程序，一个炸弹爆炸的简单画布。我使用了由爆炸的每个步骤组成的平铺位图，并且只绘制了其中的一部分，它经常更改以创建动画效果。它会根据 currentTimestamp 自动更新步骤

所以这是爆炸类：

```
public class ExplosionAnimated {

private static final String TAG = ExplosionAnimated.class.getSimpleName();

private Bitmap mBitmap;
private Rect mSourceRect;
private int mFrameCountX;
private int mFrameCountY;
private int mCurrentFrame;
private long mFrameTicker;
private int mFramePeriod;

private int mSpriteWidth;
private int mSpriteHeight;

private int mX;
private int mY;

private boolean mFinished = false;

public ExplosionAnimated(Bitmap pBitmap, int pX, int pY, 
        int pFrameCountX, int pFrameCountY, int pFps) {

    this.mBitmap = pBitmap;
    this.mX = pX;
    this.mY = pY;
    this.mCurrentFrame = 0;
    this.mFrameCountX = pFrameCountX;
    this.mFrameCountY = pFrameCountY;
    this.mSpriteWidth = pBitmap.getWidth() / pFrameCountX;
    this.mSpriteHeight = pBitmap.getHeight() / pFrameCountY;
    this.mSourceRect = new Rect(0, 0, this.mSpriteWidth, this.mSpriteHeight);
    this.mFramePeriod = 1000 / pFps;
    this.mFrameTicker = 0l;
}

public void update(long gameTime) {

    if (gameTime > this.mFrameTicker + this.mFramePeriod) {
        this.mFrameTicker = gameTime;

        this.mCurrentFrame++;
        if (this.mCurrentFrame >= this.mFramePeriod) {
            this.mCurrentFrame = 0;
            this.mFinished = true;
        }
    }

    if (!this.mFinished) {

        this.mSourceRect.left = this.mCurrentFrame * this.mSpriteWidth;
        this.mSourceRect.right = this.mSourceRect.left + this.mSpriteWidth;
    }
}

public void draw(Canvas canvas) {

    Rect destRect = new Rect(this.mX, this.mY, 
            this.mX + this.mSpriteWidth, 
            this.mY + this.mSpriteHeight);
    canvas.drawBitmap(this.mBitmap, this.mSourceRect, destRect, null);
}

public boolean isFinished() {
    return this.mFinished;
}
} 
```

这些是来自开始爆炸并绘制它的对象（例如 Bomb.java）的方法：

```
public void explode(Context pContext, Canvas pCanvas) {

    this.mState = State.EXPLODING;
    this.mExplosion = new ExplosionAnimated(this.mExplosionBitmap, 
            (int) this.mX, (int) this.mY, 7, 3, 7);
}

public void doDraw(Canvas pCanvas) {

    if (this.mState == State.EXPLODING) {

        if (this.mExplosion.isFinished()) {
            this.mState = State.EXPLODED;
        } else {
            this.mExplosion.update(System.currentTimeMillis());
            this.mExplosion.draw(pCanvas);
        }
    } else {
        pCanvas.drawBitmap(this.mBombBitmap, this.mX, this.mY, null);
    } 
} 
```

我使用 Thread 和 SurfaceView 不断绘制炸弹（或爆炸），只提供 currentTimestamp 来更新爆炸。

我希望它有所帮助，如果您需要，我可以展示和解释更多代码

# php - 如何查找特定文本模式的所有实例并将它们添加到 PHP 中的数组中？

> ID：11925326
> 
> 赞同：0
> 
> 时间：2012-08-12T19:43:30.660
> 
> 标签：php, string, explode

例如，我有这样的文字：

```
<content>Foo</content>This is only a <b>test</b><content>Bar</content>Again, only a test. 
```

如何创建一个包含两个条目的数组，`Foo`并且`Bar`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T19:45:57.000

```
preg_match_all("/<content>(.+?)<\/content>/is", $string, $matches); 
```

您的结果将被放入`$matches`数组中。

`$matches[0]`使用、等访问它们`$matches[1]`。

祝你好运！

编辑：`preg_match_all()`会给你所有的结果！感谢@Blake 的提示。

# c# - 在本地存储中保存对象时拒绝访问 Windows 8 Metro App

> ID：11925330
> 
> 赞同：4
> 
> 时间：2012-08-12T19:44:15.473
> 
> 标签：c#, windows-8, microsoft-metro, windows-runtime

我正在尝试将一个列表（其中 Show 是我的实现 IXmlSerializable 的类）存储到本地隔离存储中。我正在使用此页面中的代码：http: [//metrostoragehelper.codeplex.com/](http://metrostoragehelper.codeplex.com/) 我已经实现了问题部分中建议的更改。当从项目列表中单击它时，我正在使用以下代码添加一个 Show 对象。

```
private async void addShowButton_Click_1(object sender, RoutedEventArgs e)
    {
        var isoStorage = new StorageHelper<List<Show>>(StorageType.Local);

        List<Show> currentShows = await isoStorage.LoadASync("myShowsEx");
        if(currentShows == null) {
            currentShows = new List<Show>();
        }

        currentShows.Add(currentShow);

        isoStorage.SaveASync(currentShows, "myShowsEx");

        //Read it back, for debugging to check if it has been added properly. 
        List<Show> currentShowsRB = await isoStorage.LoadASync("myShowsEx"); //Exception here

    } 
```

第一个节目添加得非常好，它显示在 currentShowsRB 列表中。单击第二个项目并调用上述方法时，最后一次 LoadAsync 调用发生异常：访问被拒绝。（来自 HRESULT 的异常：0x80070005 (E_ACCESSDENIED)）如何解决此问题以访问本地数据存储以进行多次调用？

下面也是来自 StorageHelper 的相关代码：

```
public async void SaveASync(T Obj, string FileName)
    {

        FileName = FileName + ".xml";
        try
        {
            if (Obj != null)
            {
                StorageFile file = null;
                StorageFolder folder = GetFolder(storageType);
                file = await folder.CreateFileAsync(FileName, CreationCollisionOption.ReplaceExisting);

                using (var writeStream = await file.OpenAsync(FileAccessMode.ReadWrite))
                {
                    Stream outStream = Task.Run(() => writeStream.AsStreamForWrite()).Result;
                    serializer.Serialize(outStream, Obj);
                    //writeStream.Dispose(); //Added and we get UnauthorizedAccessException
                    // outStream.Dispose(); //Added ObjectDisposedException caught in catch statement below
                }
            }
        }
        catch (Exception)
        {
            throw;
        }
    }
    public async Task<T> LoadASync(string FileName)
    {
        FileName = FileName + ".xml";
        try
        {
            StorageFile file = null;
            StorageFolder folder = GetFolder(storageType);
            file = await folder.GetFileAsync(FileName);
            using (var readStream = await file.OpenAsync(FileAccessMode.Read))
            {
                Stream inStream = Task.Run(() => readStream.AsStreamForRead()).Result;
                inStream.Position = 0;
                return (T)serializer.Deserialize(inStream);
            }
        }
        catch (FileNotFoundException)
        {
            //file not existing is perfectly valid so simply return the default 
            return default(T);
            //throw;
        }
        catch (Exception)
        {
            //Unable to load contents of file
            throw;
        }
    } 
```

我添加了 writeStream.Dispose() 行，但即使包含此行，我也会收到相同的访问被拒绝的错误消息。如果我还包括 outStream.Dispose() 行，那么我会在下面的 catch 语句中捕获一个 ObjectDisposedException。还有什么我应该做的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T19:56:06.667

您不是在等待 SaveAsync 完成，而是在 Save 仍在进行时尝试加载。将其更改为：

```
//isoStorage.SaveASync(currentShows, "myShowsEx");
await isoStorage.SaveASync(currentShows, "myShowsEx");   

List<Show> currentShowsRB = await isoStorage.LoadASync("myShowsEx"); 
```

* * *

编辑，`await`ing on `void`是一个标准问题。
快速修复是：

```
 await TaskEx.Run(() => isoStorage.SaveASync(currentShows, "myShowsEx")); 
```

但你也可以在`TaskEx.Run()`里面移动`SaveASync()`。并且给定一个以 Async 结尾的名称，它不应该是`void`：

```
Task SaveASyncT Obj, string FileName)
{ 
    return TaskEx.Run() => { .... }
} 
```

我不相信 Serialize 有异步版本，所以它保持在`TaskEx.Run()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T03:54:18.493

该块可以缩短为：

```
 using (var readStream = await file.OpenAsync(FileAccessMode.Read)) 
        { 
            return (T)serializer.Deserialize(readStream); 
        } 
```

因为您可以直接从 XmlSerializer 类中的流中读取/写入。

您可能还会发现 CreationCollisionOption.ReplaceExisting 可能会导致问题，并且 OpenIfExists 将导致文件被序列化程序根据需要覆盖。

# objective-c - UITableViewCell 子类 - 在 IBAction 上添加子视图

> ID：11925331
> 
> 赞同：0
> 
> 时间：2012-08-12T19:44:20.307
> 
> 标签：objective-c, ios, uitableview

当视图中的按钮被触发`UIViewController`时，我正在尝试将子视图添加到视图中。`UITableViewCell`我面临的问题是从表格视图单元格的子类中调用父视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:18:39.173

`tableView`您可以在视图层次结构中查找父级：

```
-(UITableView*) parentTableView
{
    UIView* v = [self superview];
    while (v && ![v isKindOfClass:[UITableView class]]) {
        v = [v superview];
    }
    return v;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T19:50:04.797

创建 tableviewcell 子类时，通过创建自己的 init 方法将指针传递给 parentview 的实例。然后将该指针保存在您的子类中作为实例变量。这样，当子类中发生某些事情时，您可以对父级做任何您想做的事情。如果您需要更多帮助，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T20:35:53.060

我建议`UIViewController`为`UITableViewCells`. 您必须创建一个协议并`UIViewController`实施它。此外，您需要子类`UITableViewCell`化才能添加委托属性。

```
#import <Foundation/Foundation.h>

@protocol YourTableViewCellDelegate

  - (void)didTouchButton:(UIButton *)theButton;

@end 
```

在`UIButton`检查委托是否存在的操作方法中：

```
if (self.delegate != nil && [self.delegate respondsToSelector:@selector(didTouchButton:)]) {
    [self.delegate performSelector:@selector(didTouchButton:) withObject:_theButton];
} 
```

# haskell - Cabal：在库旁边安装 Bash 脚本

> ID：11925334
> 
> 赞同：1
> 
> 时间：2012-08-12T19:44:52.057
> 
> 标签：haskell, cabal

我有一个非 Haskell 可执行文件（bash 脚本），我希望 cabal`~/.cabal/bin`与我的 Haskell 库一起安装。我怎样才能用 cabal 简单地实现这一点？

编辑：正如我在下面的评论中提到的：专门安装到`~/.cabal/bin`并不重要，我只需要在我的库中提供该脚本即可。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T00:04:41.580

您可以使用 cabal 的`data-files`字段来安装一些额外的文件，然后使用`getDataFileName`cabal 创建的函数来检索文件。[文档](http://www.haskell.org/cabal/users-guide/developing-packages.html#accessing-data-files-from-package-code)和[此博客文章](http://neilmitchell.blogspot.com/2008/02/adding-data-files-using-cabal.html)中提供了详细信息。

# javascript - 创建类似亚马逊的横幅 - 参考图片

> ID：11925336
> 
> 赞同：1
> 
> 时间：2012-08-12T19:44:54.097
> 
> 标签：javascript, jquery, html, css

我不是 UI 开发人员，我通常停留在事物的后端，但我正试图弄清楚如何为我的网站构建一个简单的横幅，就像亚马逊所做的那样。我真的很喜欢它的外观和感觉。我假设这来自 CSS 方面。

我附上了来自亚马逊网站的图片。在亚马逊网站上，用户可以单击栏上的每个“菜单”，相应的横幅会以幻灯片效果很好地显示。我在这里选择了 kindle，您可以单击实时站点上的任何其他选项以查看我所指的确切内容。我不确定哪里是一个好的起点。![在此处输入图像描述](../Images/538d2354668c7847042dec61a3a0887e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:58:42.520

有大量的 jquery 插件可以做到这一点 - [http://vandelaydesign.com/blog/web-development/jquery-slideshow/](http://vandelaydesign.com/blog/web-development/jquery-slideshow/)。然而，这里有一个我只是为了好玩而建造的一个：

[http://jsfiddle.net/joplomacedo/GLmed/](http://jsfiddle.net/joplomacedo/GLmed/)

它只有基础知识。您单击一个链接，它会滑动。为此，css 和 jquery 只有几行。我想它应该很容易定制。

# phpword - 如何在 PHPWord 中合并单元格？或者在每个表格行中有不同数量的单元格？

> ID：11925337
> 
> 赞同：2
> 
> 时间：2012-08-12T19:44:57.407
> 
> 标签：phpword

尝试使用 PHP 库 PHPWord 创建 MS Word 文档。

你能帮我如何合并文档中的两个或多个单元格吗？或者如何在每个表格行中有不同数量的单元格？

我尝试将单元格定义为：

```
$cell11 = array('gridSpan'=>2); 
```

但它没有奏效......

先感谢您！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T02:04:26.297

添加这样的代码

**1\. PHPWord/Section/Table/Cell.php**

```
/**
 * How many columns this cell spans
 * @var int
 */
private $_gridSpan;

public function__construct($insideOf,$pCount,$width=null,$style=null,$gridSpan=1){
    $this->_insideOf = $insideOf;
    ...
    $this->_gridSpan = $gridSpan;
}

/**
 * Get the number of columns this cell spans
 *
 * @return int
 */
public function getGridSpan(){
    return $this->_gridSpan;
} 
```

**2\. PHPWord/Section/Table.php**

```
 public function addCell($width,$style=null,$gridSpan=1){
            $cell = new PHPWord_Section_Table_Cell($this->_insideOf,
                    $this->_pCount,$width,$style,$gridSpan);
      } 
```

**3\. PHPWord/Writer/Word2007/Base.php**

```
protected function _writeTable(PHPWord_Shared_XMLWriter $objWriter = null, PHPWord_Section_Table $table) {
    $_rows = $table->getRows();
    $_cRows = count($_rows);
    ...
    $_heights = $table->getRowHeights();
    for ($i = 0; $i < $_cRows; $i++) {
        $row = $_rows[$i];
        $height = $_heights[$i];
        //add
        $objWriter->startElement('w:trPr');
        //FIXME: Make this an option on a row or table
        $objWriter->startElement('w:cantSplit');
        $objWriter->endElement();
        $objWriter->endElement();
        //end add
        foreach ($rows as $cell) {
            ...
            $width = $cell->getWidth();
            //add 
            $gridSpan = $cell->getGridSpan();
            //end add
            ...
            //add
            if ($gridSpan > 1) {
                $objWriter->startElement('w:gridSpan');
                $objWriter->writeAttribute('w:val',$gridSpan);
                $objWriter->endElement();
                //end add
                ...
            }
        }
    }
} 
```

你可以像这样使用它：

```
$PHPWord  = new PHPWord();
$section  = $PHPWord->createSection();
$table    = $section->addTable();
$table->addRow();
$table->addCell(1000,null,2)->addText('info');

$table->addRow();
$table->addCell(500)->addText('Name');
$table->addCell(500)->addText('Sex'); 
```

对不起风格，你可以这样使用它：

```
$tableStyle = array('borderSize'=>6, 'borderColor'=>'006699', 'cellMargin'=>80);
$PHPWord->addTableStyle('tableStyle',$tableStyle,null);
$table    = $section->addTable('tableStyle');
$table->addRow();
$table->addCell(1000,null,2)->addText('info',null,array('align'=>'center'));

$table->addRow();
$table->addCell(500)->addText('Name',null,array('align'=>'center'));
$table->addCell(500)->addText('Sex',null,array('align'=>'center')); 
```

# dns - 绑定。注册商说它找不到名称服务器。nslookup 显示域正在由 bind 处理

> ID：11925338
> 
> 赞同：0
> 
> 时间：2012-08-12T19:45:01.573
> 
> 标签：dns, bind, nameservers

我是 BIND 的新手，并认为我掌握了 DNS，但显然我错了。

BIND 安装在 Windows Server 2008 Web 上

1.  *我用Dyn*创建了一个区域 ( `example.com`) 。
**   我使用 Dyn 名称服务器成功注册了该区域的域*   我在 Dyn 区域创建了两个子域（A 记录）：`ns1.example.com`和`ns2.example.com`*   每个子域都指向一个唯一的 IP，绑定到我的 BIND 正在侦听的服务器*

 *当我使用 查询`ns1.example.com`时`nslookup`，对于我在该网络服务器上创建的新域，它会返回`ns1`其 ip，但会出现以下错误：

```
DNS request timed out.
    timeout was 2 seconds.

DNS request timed out.
    timeout was 2 seconds.

DNS request timed out.
    timeout was 2 seconds.

DNS request timed out.
    timeout was 2 seconds.

*** Request to ns1.example.com timed-out 
```

如果我`nslookup`在网络服务器本身上运行，使用相同的查询，我会得到：

```
> example.com

Server:  ns1.example.com (which is the slected nameserver)

Address:  xx.xx.xx.xx

Name:    example.com

Address:  xx.xx.xx.xx 
```

值得一提的是，Web 服务器位于英国，而我位于南非。

当我尝试注册时，我在南非的注册商会返回以下信息`domainxyz.example`：

> 无法检索位于 xxx.xxx.xxx.xxx 的 domainxyz.example 的 SOA 记录。最常见的原因是名称服务器当前不可访问或尚未为此域配置名称服务器。

我可以从失败的电脑上 ping 和解决`ns1`。`ns2``nslookup`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:03:46.970

经过与自己的长时间讨论，并好奇地回顾了我的帖子......我决定我一定是真的筋疲力尽了......我在服务器上的 Windows 防火墙上打开了 UDP 端口 53。

Tadaaa ......工作！

有时它有助于从某人身上反弹一些东西，即使它是一个孤独的周日晚上网页/论坛。

也许这对将来的其他人有帮助。这个全新的 Web 服务器调试有很多方面需要配置，我失去了基础知识的网站。

干杯，谢谢..！*

# linux - 在 Scientific Linux 6.2 上更新 GTK+

> ID：11925344
> 
> 赞同：0
> 
> 时间：2012-08-12T19:46:02.597
> 
> 标签：linux, gtk, centos, rhel

我正在使用 gretl 构建 Scientific Linux 6.2 的安装，并且需要将 GTK+ 至少更新到 2.4.0 版本。这样做有什么问题吗？如果没有，推荐的步骤是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T19:52:41.987

您可以从 GTK+ 官网下载源码并从源码编译 rpm 包。

# scala - 如何在 Play Framework 2 中为我的所有路由添加前缀？

> ID：11925345
> 
> 赞同：7
> 
> 时间：2012-08-12T19:46:10.540
> 
> 标签：scala, playframework, routes, playframework-2.0

在 play 1.x 中，您有 http.path 参数，它允许您设置要添加到每个路由的 url

[http.param](http://www.playframework.org/documentation/1.2.5/configuration#http)

我怎样才能在 play 2.0 中实现类似的东西？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-02T11:56:12.237

在 Play 2.1 中，您可以使用以下选项执行此操作`conf/application.conf`：

```
application.context="/your/prefix" 
```

从 Play 2.4 开始调用这个属性`play.http.context`（取自 Gman 的评论）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-12T20:07:56.707

我在[play 的讨论组](https://groups.google.com/forum/#!topic/play-framework/2722JpogWsY/discussion%5B1-25%5D)中询问，他们帮助我实现了这个初始版本

我像这样创建一个 PrefixedRequest

```
import play.api.mvc.RequestHeader
import play.api.Play.configuration

import play.api.Play.current

class PrefixedRequest(request: RequestHeader) extends RequestHeader {

    def headers = request.headers
    def queryString = request.queryString

    // strip first part of path and uri if it matches http.path config
    def path = ("^" + prefix).r.replaceFirstIn(request.path, "/")
    def uri = ("^" + prefix).r.replaceFirstIn(request.uri, "/")

    def method = request.method
    def remoteAddress = request.remoteAddress

    lazy val prefix = {
      val config = configuration.getString("http.path").getOrElse("")
      if (config.endsWith("/")) config else config + "/"
  }
}

object PrefixedRequest {
  def apply(request: RequestHeader) = new PrefixedRequest(request)
} 
```

然后我在 Global.scala 中使用它

```
import play.api.GlobalSettings
import play.api.mvc.RequestHeader
import play.api.mvc.Handler

object Global extends GlobalSettings {

  override def onRouteRequest(request: RequestHeader): Option[Handler] = {
    super.onRouteRequest(PrefixedRequest(request))
  }

} 
```

最后将其添加到 application.conf

```
http.path=/prefix/ 
```

它似乎有效，但我无法找到如何将该前缀添加到反向路由......有人可以帮我解决这部分吗？

--

一些有用的链接

检查这个[线程](https://groups.google.com/forum/#!topic/play-framework/frCfaSR24p8/discussion%5B1-25%5D)和[文档](https://github.com/playframework/Play20/wiki/ScalaInterceptors)

# google-chrome - 动画 WebP 浏览器支持

> ID：11925351
> 
> 赞同：1
> 
> 时间：2012-08-12T19:47:13.657
> 
> 标签：google-chrome, webp

Chrome 是否支持动画 webP？有没有这样的图像的例子？我没有找到一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T11:40:13.010

不，动画尚未稳定，因此尚未包含在 Google Chrome 中。[来源](https://groups.google.com/a/webmproject.org/d/msg/webp-discuss/D_fUrlSO888/FsTEqLV2Gu4J)

# c - CS107 分配文件无法编译，缺少 expat.h 和 thread_107.h 文件

> ID：11925352
> 
> 赞同：0
> 
> 时间：2012-08-12T19:47:25.717
> 
> 标签：c, multithreading, expat-parser

我在斯坦福在线审核 cs107

我遇到的问题是分配 6，当我在终端中键入“make”时，会弹出错误消息。基本上，我错过了两个头文件，我猜它们可以从预编译的 .lib 文件中获得。但不知何故，它就是行不通。

这是原始make文件的一部分：

```
CFLAGS = -D_REENTRANT -g -Wall -D__ostype_is_$(OSTYPE)__ -std=gnu99 -I/usr/class/cs107/include/ -Wno-unused-function $(DFLAG)
LDFLAGS = -L/usr/class/cs107/assignments/assn-6-rss-news-search-lib/$(OSTYPE) -L/usr/class/cs107/lib -lexpat -lrssnews $(PLATFORM_LIBS) $(THREAD_LIBS)
PFLAGS= -linker=/usr/pubsw/bin/ld -best-effort -threads=yes -max-threads=1000 
```

编辑：

当我说“即使没有线程实现也应该编译”时，我的意思是它应该在没有学生进一步线程实现的情况下编译。

所以这是带有线程的错误消息：

```
gcc -D_REENTRANT -g -Wall -D__ostype_is_linux__ -std=gnu99 -I/usr/class/cs107/include/ -Wno-unused-function -c -o rss-news-search.o rss-news-search.c
rss-news-search.c: In function ‘main’:
rss-news-search.c:109:3: warning: implicit declaration of function ‘InitThreadPackage’ [-Wimplicit-function-declaration]
gcc rss-news-search.o -D_REENTRANT -g -Wall -D__ostype_is_linux__ -std=gnu99 -I/usr/class/cs107/include/ -Wno-unused-function -L/home/h/cs107/assn-6-rss-news-search-lib/linux -L/usr/class/cs107/lib -L. -lexpat -lrssnews -lnsl -lpthread -lthread_107_linux -o rss-news-search
/usr/bin/ld: cannot find -lthread_107_linux
collect2: ld returned 1 exit status
make: *** [rss-news-search] Error 1 
```

这是没有 $(THREAD_LIBS) 的错误消息：

```
gcc -D_REENTRANT -g -Wall -D__ostype_is_linux__ -std=gnu99 -I/usr/class/cs107/include/ -Wno-unused-function -c -o rss-news-search.o rss-news-search.c
rss-news-search.c: In function ‘main’:
rss-news-search.c:109:3: warning: implicit declaration of function ‘InitThreadPackage’ [-Wimplicit-function-declaration]
gcc rss-news-search.o -D_REENTRANT -g -Wall -D__ostype_is_linux__ -std=gnu99 -I/usr/class/cs107/include/ -Wno-unused-function -L/home/h/cs107/assn-6-rss-news-search-lib/linux -L/usr/class/cs107/lib -L. -lexpat -lrssnews -lnsl -lpthread  -o rss-news-search
rss-news-search.o: In function `main':
/home/h/cs107/assn-6-rss-news-search/rss-news-search.c:109: undefined reference to `InitThreadPackage'
collect2: ld returned 1 exit status
make: *** [rss-news-search] Error 1 
```

在后一种情况下，如果我注释掉“InitThreadPackage”，它编译得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:10:39.530

特定于班级的头文件，就像在教师期望学生使用的任何机器上`thread_107.h`找到的一样。`/usr/class/cs107/include/`如果您不使用该机器，则必须复制这些包含文件或自己制作。

该`expat.h`文件来自一个开源库。您需要在您正在编译的系统上安装适当的软件包。在 Ubuntu 上是`sudo apt-get install libexpat1-dev`，但包名在其他发行版上应该是相似的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:55:14.470

这是编译项目的过程：

1.  创建一个文件`assn-6-rss-news-search/thread_107.h`，并将其放入：

    `/* Empty header file */`

2.  **将**库`librssnews.a`从复制`assn-6-rss-news-search-lib/linux/`到`assn-6-rss-news-search/`

3.  `rss-news-search.c`通过**注释**对函数的调用来修改文件：`InitThreadPackage`在第**109**行：

    //InitThreadPackage(false);

4.  修改`Makefile`以包含**当前目录的路径**（以便能够链接到您之前复制的库`librssnews.a`）：

第**27**行应如下所示：

```
LDFLAGS = -L/usr/class/cs107/assignments/assn-6-rss-news-search-lib/$(OSTYPE) -L/usr/class/cs107/lib -L. -lexpat -lrssnews $(PLATFORM_LIBS) $(THREAD_LIBS) 
```

然后：

```
make clean
make 
```

编辑 ：

当您收到此错误`cannot find lthread_107_linux`时，请编辑您的 Makefile 以在第**27**`$(THREAD_LIBS)`行将其删除：

 **```
LDFLAGS = -L/usr/class/cs107/assignments/assn-6-rss-news-search-lib/$(OSTYPE) -L/usr/class/cs107/lib -L. -lexpat -lrssnews $(PLATFORM_LIBS) 
```**

# c++ - C++ - 删除 std::string*；堆损坏

> ID：11925353
> 
> 赞同：1
> 
> 时间：2012-08-12T19:47:36.797
> 
> 标签：c++, string, memory-management

我对 C++ 内存管理比较陌生，而且我遇到了这个奇怪的堆损坏错误（加上之前 Visual Studio 中的一个自动断点）。这是有问题的代码：

```
z_world::z_world(char* name)
{
    unsigned int i, skip;
    char tmp;

    //Load data from file
    std::string* data = loadString(name);

    //Base case if there is no world data
    tiles = NULL;

    w = 0;
    h = 0;

    if(data->length() > 0) {
        //Set up the 'tiles' array
        for(i = 0; i < data->length(); i++) {
            if(data->at(i) == '\n')
                h++;
            if(h == 0)
                w++;
        }
        tiles = new int[data->length()-h];

        //Load Data
        skip = 0;
        for(i = 0; i < data->length(); i++) {
            if(data->at(i) == '\n') {
                skip++;
                printf("\n");
                continue;
            }
            tmp = data->at(i);
            tiles[i+skip] = atoi(&tmp);
            printf("%i ",tiles[i+skip]);
        }
    }
    delete data;
} 
```

这是我在字符串中加载的位置：

```
std::string* loadString(char* name)
{
    ifstream in(name);
    std::string* input = new string();

    while(in) {
        std::string line;
        getline(in,line);
        input->append(line);
        input->append("\n");
    }

    in.close();

    return input;
} 
```

我在“删除数据”中得到了断点和错误；这让我认为“数据”在此之前的某个地方被删除了，但我找不到它会在哪里。作为参考，此方法是创建一个包含游戏世界数据的对象，该对象以虚拟 2D 整数数组的形式（用于图块的 ID）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T19:56:08.363

你的问题可能在这里：

```
tiles[i+skip] = atoi(&tmp); 
```

问题1：
应该是`-skip`

```
tiles[i - skip] = 
```

问题 2：
命令`atoi()`使用不正确（tmp 不包含字符串）。但我也不认为`atoi()`是合适的方法。我认为您正在寻找的是简单的任务。从 char 到 int 的转换是自动的：

```
 tiles[i - skip] = tmp; 
```

问题 3：
您没有正确使用对象。在这种情况下，没有必要生成动态对象和动态内存管理造成混乱。只创建自动对象并正常传递它们会更简单：

```
std::string* loadString(char* name)
      //   ^  Don't do this.

std::string loadString(std::string const& name)
//  ^^^^^^^  return a string by value.
//           The compiler will handle memory management very well. 
```

一般来说，您不应该传递指针。在您确实需要指针的少数情况下，它们应该保存在智能指针对象或容器（用于多个对象）中，以便正确控制它们的寿命。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T19:55:14.653

`atoi(&tmp);` atoi 需要一个指向空终止字符串的指针 - 而不是指向 char 的指针

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T20:20:03.287

可能是该函数的变量输入是本地的。因此，从这里返回后，内存被释放。因此，稍后在此字符串上调用 delete 会尝试释放已释放的内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T19:54:16.037

无需在您显示的代码中动态分配字符串。`loadString`将函数更改为

```
std::string loadString(char* name)
{
    ifstream in(name);
    std::string input;

    // ...

    return input;
} 
```

在调用者

```
std::string data = loadString( name ); 
```

现在完成后就不需要`delete`字符串了。

代替

```
int *tiles = NULL;
tiles = new int[data->length()-h]; 
```

利用

```
std::vector<int> tiles;
tiles.resize(data.length() - h); 
```

此外，如果您确实需要动态分配对象，您应该使用智能指针 ( `std::unique_ptr`and `std::shared_ptr`) 而不是原始指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-12T19:57:51.627

有一个错误

```
tiles[i+skip] = atoi(&tmp); 
```

例如，对于一个字符串

```
Hello\n
World\n 
```

并且对于点的循环迭代`i == 10`，`skip`已经是 1（因为我们之前遇到过第一个`\n`）并且您正在写入`tiles[10 + 1]`，但`tiles`仅被分配为具有 10 个元素的数组。

# php - 任何用于备份 mssql 表的好示例 php 脚本？

> ID：11925354
> 
> 赞同：0
> 
> 时间：2012-08-12T19:47:42.790
> 
> 标签：php, sql-server, database-backups

我正在寻找一个好的 php 脚本来创建几个表的备份。

但是，我想使用的方法是创建包含删除、重新种子和插入语句的 txt 文件，以重新插入备份的数据。

我已经看到如何在 SSMS 中生成脚本来做同样的事情。

但是想要一个在 php.ini 中的例子。

因此，我可以将其作为 cron/计划任务运行，以创建充满 sql 的 txt 文件，我可以安全地使用它来回滚数据......我认为这是一个更容易管理的解决方案，然后是正常的 sql server 备份过程。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-04-24T10:09:15.717

```
$disk = "E:\\TestBackup\\Test.bak";
$backupQuery = "USE [dbName]  \n  BACKUP DATABASE [dbName] TO DISK = '$disk' ";
$backupResult = sqlsrv_query($conn,$backupQuery) or die(print_r(sqlsrv_errors())); 
```

# javascript - JavaScript左右点击功能

> ID：11925358
> 
> 赞同：4
> 
> 时间：2012-08-12T19:47:59.137
> 
> 标签：javascript, html5-canvas

这是我正在制作的 HTML5 画布游戏。在游戏中，有一个角色有枪，他可以射击并重新加载。我希望玩家使用鼠标左键进行射击，使用鼠标右键进行重新加载。

我需要的是，当我单击鼠标左键时，我的播放器对象（Player1.isLeftClick）中的一个变量变为真，当我放开按钮时，相同的变量变为假。鼠标右键也应该发生同样的事情，但使用另一个变量（Player1.isRightClick）。我还希望它能够支持所有最流行的浏览器（Chrome、Firefox、Explorer 等）。 **我还必须使用纯 JavaScript，没有像 jQuery 这样的库！** 我已经通过键盘事件实现了这一点，但我需要通过鼠标事件实现这一点。

如果有帮助，我已经有了用于上下键盘和鼠标移动的事件处理程序。这些是在加载图像时初始化游戏的 init 函数中完成的。

```
document.addEventListener('mousemove', mousePos, false);
document.addEventListener('keydown', checkKeyDown, false);
document.addEventListener('keyup', checkKeyUp, false); 
```

我还有一个名为 mie 的变量，如果使用的浏览器是 Internet Explorer，则该变量为 true，而其他浏览器为 false。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-25T20:38:34.633

您想使用该[`e.button`](https://developer.mozilla.org/en-US/docs/DOM/event.button)属性来检查调用了哪个鼠标事件。单击鼠标左键的值[在 IE 中是不同的](http://www.quirksmode.org/js/events_properties.html#button)。您的代码如下所示：

```
var left, right;
left = mie ? 1 : 0;
right = 2;

document.body.addEventListener('mousedown', function (e){
    if(e.button === left){
        Player1.isLeftClick = true;
    }
    else if(e.button === right){
        Player1.isRightClick = true;
    }
}, false);

document.body.addEventListener('mouseup', function (e){
    if(e.button === left){
        Player1.isLeftClick = false;
    }
    else if(e.button === right){
        Player1.isRightClick = false;
    }
}, false); 
```

[演示](http://jsfiddle.net/HBbj4/)

# objective-c - 检查 +[UIImage imageNamed:] 是否找到图像

> ID：11925360
> 
> 赞同：2
> 
> 时间：2012-08-12T19:48:12.630
> 
> 标签：objective-c, cocoa-touch, uiimage

我有一个很长的 if 语句来决定在`UIImageView`. 它们都是.png文件，我使用代码：

```
if (whatever) {
    image = [UIImage imageNamed: @"imageName.png"];
} 
```

有谁知道检查程序是否可以找到图像的方法？这样如果程序中不存在图像，它可以显示错误图像或什么的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T19:50:52.987

```
+[UIImage imageNamed:] 
```

`nil`如果找不到相应的图像文件，将返回。所以只需检查一下：

```
UIImage *image = [UIImage imageNamed:@"foo.png"];
if (image == nil)
{
    [self displayErrorMessage];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-12T19:52:32.440

最短的片段是

```
image = [UIImage imageNamed:@"imageName"] ? : [UIImage imageNamed:@"fallback_image"] 
```

但是你真的想要这样的代码吗？

再次检查：

```
if (whatever) {
    image = [UIImage imageNamed: @"imageName.png"];
    if(image == nil) {
        image = [UIImage imageNamed: @"fallback_image"];
    }
} 
```

它仍然可以短路，例如

```
if(! (image = [UIImage imageNamed: @"imageName.png"]) ) {
    ...
} 
```

但你在这里玩弄可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T19:53:17.147

首先，我建议使用字典而不是 long `if`。您可以通过 键入每个图像名称`whatever`。如果`whatever`当前不是对象，则创建一个`enum`封装该信息并使用`NSNumber`s 将枚举值装箱的对象。

然后，您可以检查`nil`何时尝试检索图像。`imageNamed:`用于`nil`指示失败，因此：

```
if( !image ){
    // No image found
} 
```

# core-data - NSFetchedResultsController 仅按第一个排序描述符排序

> ID：11925362
> 
> 赞同：0
> 
> 时间：2012-08-12T19:48:30.900
> 
> 标签：core-data, nsfetchedresultscontroller

我看到 NSFetchedResultsController 仅在数据更改时按数组`NSSortDescriptor`中的第一个排序的问题。`sortDescriptors`真的很气人。

我正在使用 NSFetchedResultsController 来管理显示项目列表的表格视图。这些项目具有基于`number`属性的固有顺序，但用户可以收藏项目。收藏的项目显示在表格视图的顶部，按`number`属性排序。

所以，模型看起来像这样：

```
@interface Thing : NSManagedObject
    @property (nonatomic, retain) NSNumber *number;
    @property (nonatomic, retain) NSNumber *favorite;
@end

@implementation Thing
    @dynamic number;
    @dynamic favorite;
@end 
```

我正在`NSFetchedResultsController`像这样配置我的：

```
- (void)loadView {
    ...
    //
    // configure fetched results controller for the things table view
    NSFetchRequest *fetchThings = [[NSFetchRequest alloc] init];
    fetchChannels.entity = [NSEntityDescription entityForName:NSStringFromClass([Thing class]) 
                                       inManagedObjectContext:[DataManager sharedInstance].managedObjectContext];
    fetchThings.sortDescriptors = @[
    [NSSortDescriptor sortDescriptorWithKey:@"favorite" ascending:NO],
    [NSSortDescriptor sortDescriptorWithKey:@"number" ascending:YES] ];

    _fetchController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchThings
                                                           managedObjectContext:[DataManager sharedInstance].managedObjectContext
                                                             sectionNameKeyPath:nil
                                                                      cacheName:nil];

    NSError *error = nil;
    if (![_fetchController performFetch:&error]) {
        NSLog(@"error performing fetch! %@", error.localizedDescription);
    }
} 
```

最初加载表格时，`_fetchController`正确地对项目进行排序，因此您最终可能会得到如下结果：

```
- Thing: favorite = YES, number = 2
- Thing: favorite = YES, number = 3
- Thing: favorite = NO, number = 1
- Thing: favorite = NO, number = 4 
```

但是，如果您要取消最喜欢的事物编号 2，它只会按第一个排序描述符排序，列表如下所示：

```
- Thing: favorite = YES, number = 3
- Thing: favorite = NO, number = 2
- Thing: favorite = NO, number = 1
- Thing: favorite = NO, number = 4 
```

有没有人遇到过这个问题或找到了解决方法？

## 更新

看来，如果我喜欢*所有内容*，然后不喜欢*所有内容*，排序就会自行解决。这让我相信这可能是一个错误的问题？不幸的是，我也不确定如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:36:10.560

好吧，我想通了，这是我自己的错。

仅仅因为该字段代表 a`BOOL`并不意味着它实际上是 a `BOOL`。模型中的`favorite`字段`Thing`实际上是一个`NSNumber`，因此具有**3**个状态，`@(YES)`、`@(NO)`和`nil`。一旦我确定我`favorite`正确地初始化了该字段，排序就会再次按预期工作。

# php - 如何在网站的文件夹中移动数千张图片？

> ID：11925369
> 
> 赞同：0
> 
> 时间：2012-08-12T19:49:20.073
> 
> 标签：php, web

我有一个包含数千个帖子的网站。每个帖子有0-4张图片。图片在文件夹系统中。现在我需要将所有图片移动到另一个具有不同层次逻辑的文件夹系统中。

我可以很容易地为此编写一个 PHP 代码，但我想我无法成功运行一个有这么多任务的文件。那么我怎样才能将这样的 php 文件运行足够长的时间，或者其他可能性是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T19:53:12.237

您可以用 PHP 编写它，因为 PHP - 在命令行上 - 没有执行时间限制。如果脚本需要那么长时间，它将无休止地运行。

请联系您的托管商以获取 shell 访问权限。

# javascript - 从 Javascript 绑定到 MetroStyle 应用程序中的 InnerHTML

> ID：11925376
> 
> 赞同：2
> 
> 时间：2012-08-12T19:50:20.057
> 
> 标签：javascript, html, windows-8, microsoft-metro

我有一个 div 定义为：

```
<div class="article-content" data-win-bind="innerHTML: content"></div> 
```

并且我使用具有内容属性的对象绑定到它。

现在我使用外部资源创建的对象，有时内容属性将具有如下内容：

```
"some text <iframe width="560" height="315" src="youtubelink" frameborder="0" allowfullscreen></iframe>" 
```

这个抛出异常：

```
Unable to add dynamic content. A script attempted to inject dynamic content, or elements previously modified dynamically, that might be unsafe. For example, using the innerHTML property to add script or malformed HTML will generate this exception. Use the toStaticHTML method to filter dynamic content, or explicitly create elements and attributes with a method such as createElement. 
```

我了解异常及其发生的原因，但现在我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T02:20:41.103

查看[本文档](http://msdn.microsoft.com/en-us/library/windows/apps/hh465380.aspx)的“动态添加 HTML”部分 您可能必须使用[execUnsafeLocalFunction](http://msdn.microsoft.com/en-us/library/windows/apps/Hh767331.aspx)来注入您尝试注入的特定 HTML。此外，请查看这篇关于创建适用于 Metro 风格应用程序的通用附加函数的[博客文章。](http://gkosev.blogspot.com/2012/08/why-native-development-sucks-and-html5.html)

# c - 无法理解此代码堆栈存储函数调用 c 的输出

> ID：11925379
> 
> 赞同：0
> 
> 时间：2012-08-12T19:50:34.813
> 
> 标签：c, function, stack

我有以下代码，但是我不明白它输出什么以及为什么输出它的作用。

```
int main(){
   int *i;
   int *fun();
   i=fun();
   printf("%d\n",*i);
   printf("%d\n",*i);
}

int *fun(){ 
   int k=12;
   return(&k);
} 
```

输出是 12 和一个垃圾值。有人可以解释输出吗？

它不应该两次都返回垃圾值吗？

我知道这`k`是本地的`fun()`，因此它将存储在堆栈中，并且在`fun()`超出范围时将被销毁。我在这里缺少什么概念？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T19:52:23.377

> 它不会两次都返回垃圾值吗？

的返回后`fun`，`k`不再存在，因此打印存储在地址中的值`k`是**未定义的行为**。

这就是为什么你有不同的/垃圾价值。

> k 是 fun() 的本地变量，因此它将存储在堆栈中，并且在 fun 结束时激活将被销毁，还是我错过了一些概念？

除了堆栈没有立即“取消”或类似的事实之外，您没有遗漏任何东西。换句话说，在返回 之后`fun`，编译器可以自由地对这块内存做任何事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-12T19:55:25.677

函数返回时堆栈不会立即清除，因此返回`12`后仍将在堆栈上`fun()`- 直到其他东西覆盖它。

您会在不同的编译器和不同的构建选项（调试与发布）中看到不同的结果。

# jquery-ui - 通过 ajax position() 的 jQuery UI 选项卡内容仅适用于第一个选项卡

> ID：11925385
> 
> 赞同：1
> 
> 时间：2012-08-12T19:51:20.803
> 
> 标签：jquery-ui, tabs, positioning

我是 jQuery/jQuery UI 的新手。我正在尝试在通过 ajax 加载动态内容（temp.html）的页面（sample.html）中创建多个选项卡。所需的效果是 temp.html 中的内容应根据选择的选项卡而变化。我正在使用[位置](http://jqueryui.com/demos/position/)将一些小部件放置在相对于彼此的位置。

我面临的问题是当我单击第一个选项卡时，一切正常。当我点击第二个标签定位不起作用。我在下面添加了我的代码。

**示例.html**

```
$(function() {
   $("#tabs").tabs({
    ajaxOptions : {
      error : function(xhr, status, index, anchor) {
           $(anchor.hash).html("Couldn't load this tab.");
        },
        cache : false
        }
    });
});

<div id="content" class="content">
   <div id="tabs">
    <ul>
      <li><a href="temp.html">Tab 1</a></li>
      <li><a href="temp.html">Tab 2</a></li>
    </ul>
   </div>
</div> 
```

**临时文件**

```
#widget1 {
 width: 150px;
 height: 70px;
 top: 20px;
 left: 50px
}

#widget2 {
 width: 150px;
 height: 70px;
}

function resetPositions() {
   $("#widget2").position({
    my : "left top",
    at : "right bottom",
    of : "#widget1",
    offset : "0 50"
    });
   }
$(function() {
  $(".customAccordion").draggable();
  $(".customAccordion").accordion({
    collapsible : true,
    fillSpace : false,
    icons : {
     header : "ui-icon-circle-arrow-e",
     headerSelected : "ui-icon-circle-arrow-s"
    }
 });
 resetPositions();
});

<div id="widget1" class="customAccordion">
  <h3><a href="#">Widget 1</a></h3>
  <div>Widget 1</div>   
</div>
<div id="widget2" class="customAccordion">
 <h3><a href="#">Widget 2</a></h3>
 <div>Widget 2</div>
</div> 
```

如果我犯了任何错误，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:26:49.600

可能是 jQuery UI 的一个棘手部分，您需要确保在**选项卡*****之前*****初始化手风琴**

 *```
$(".customAccordion").accordion();
$("#tabs").tabs(); 
```

*   首先尝试移除您的手风琴，看看它是否有帮助。
*   然后尝试在最后初始化您的选项卡。

然后您需要验证使用 AJAX 加载您的 html 页面将运行其包含的 Javascript...如果没有，您需要**将该初始化代码粘贴到选项卡的*选择*事件**中。

```
$("#tabs").tabs(
{
    select: function(event,ui)
    {
        // initAccordions();
    }
}); 
```*

# winapi - Windows 堆栈和堆地址范围

> ID：11925397
> 
> 赞同：1
> 
> 时间：2012-08-12T19:52:57.210
> 
> 标签：winapi, memory, process, heap-memory, stack-memory

直到现在在堆栈地址非常高而堆地址非常低的 Linux 上工作（如使用 C 程序打印堆和堆栈地址所见），我在 Win32 进程内存布局方面存在问题。MWSDN 是说堆栈地址高于堆地址，但从我在实践中看到的情况来看，堆栈地址低于堆地址。所以我很困惑。有人请解释一下。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T19:55:51.297

嗯，`stack addresses are higher than heap addresses`- 这根本不是真的。堆栈和堆都可以驻留在 Windows 进程地址空间中的任何位置。

如果你启动很多线程，进行巨大的堆分配并加载数百个 dll，你会发现所有这些对象都均匀地分布在地址空间中。

![在此处输入图像描述](../Images/fc6e20cac0fafa8ceb2f3c82419b7105.png)

此图显示了 Windows 上典型 32 位进程中的虚拟分配结构。绿色表示空闲区域，蓝色表示分配了一些东西。活动主要发生在地址空间的开头，但在其他地址范围内也存在。

# c# - “私有只读”和“只读私有”之间有区别吗？

> ID：11925402
> 
> 赞同：4
> 
> 时间：2012-08-12T19:53:17.573
> 
> 标签：c#

我只是在查看一些代码，并注意到有人将成员标记为`readonly private`. 这有什么不同`private readonly`吗？

例子：

```
readonly private MyClass myInstance = new MyClass(); 
```

我以前从未见过这种情况。我总是用`private`then `readonly`。我在 MSDN 上（甚至在 C# 规范中）找不到任何提及访问修饰符可以出现的顺序的任何内容。某处是否有文章/参考？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-12T19:56:26.057

不，没有区别。发生这种情况的另一个常见情况是`public static`vs`static public`在任何一种情况下，有些人可能会认为首先拥有访问修饰符更重要，而另一些人会认为看到“特殊”修饰符更重要。

但不，它根本没有任何区别，它纯粹是一种风格选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-12T19:58:46.193

这对编译器无关紧要，但对代码审查者或下一个处理该代码的人来说确实（可能）很重要。

正如其他人所回答的那样，顺序无关紧要。您应该对这些关键字的排序保持一致。我通常首先放置作用域（`public`/ `private`），然后是行为（`readonly`/ `abstract`/ `static`）。

Pick the order that works for you and your team and stick with it.

Good luck!

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-12T19:54:41.847

不，没有区别。这些关键字只是修饰符，它们的顺序并不重要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-12T19:56:47.150

没有区别。两者都是一样的。
看到[这个问题](https://stackoverflow.com/questions/191929/is-there-a-convention-to-the-order-of-modifiers-in-c#191944)。

# entity-framework - 实体框架数据库不工作（代码优先，Web 部署）

> ID：11925417
> 
> 赞同：2
> 
> 时间：2012-08-12T19:55:13.530
> 
> 标签：entity-framework, asp.net-mvc-4, entity-framework-migrations

我首先使用带有实体框架代码的 Asp.Net MVC4。

一切都在本地工作，但是当我发布时，没有数据库访问权限的页面（在互联网上）以及任何带有它的页面都会加载一段时间，然后给我一个服务器错误。

我启用了迁移，我进行了使用当前模型的 InitialCreate 迁移。我运行“更新数据库”命令没有错误。

有任何想法吗 ？

编辑，感谢下面的评论，这里有一些关于错误的详细信息。

> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

堆栈跟踪中的错误...

> [SqlException (0x80131904)：建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）] System.Data.SqlClient.SqlInternalConnection.OnError（SqlException 异常，布尔 breakConnection）+5064458
> 
> System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +234
> 
> System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean IntegratedSecurity) +341

我也在使用 .sdf 数据库。这里的连接字符串...

```
<add name="DefaultConnection" connectionString="Data Source=|DataDirectory|Data.sdf" providerName="System.Data.SqlServerCe.4.0" />
<add name="ZDataContext" connectionString="Data Source=|DataDirectory|ZData.sdf" providerName="System.Data.SqlServerCe.4.0" /> 
```

我再说一遍，这一切都在本地工作。

刚刚手动上传所有文件，得到这个错误......

> 不允许访问数据库文件。[ 1884，文件名 = d:\virtualservers[用户名]\website.co.uk\wwwroot\App_Data\ZData.sdf,SeCreateFile ]

同样适用于本地，也适用于无数据库页面，但数据库页面给了我上述错误。

# python - 在 Python 中 a+=1 会比 a = a+1 快吗？

> ID：11925429
> 
> 赞同：1
> 
> 时间：2012-08-12T19:56:40.067
> 
> 标签：python, performance

我不确定它在 Python 中是否相同。

以前有人试过吗？

[http://docs.python.org/library/operator#operator.iadd](http://docs.python.org/library/operator#operator.iadd)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-12T20:04:59.647

python 对任一语句执行的工作几乎没有区别：

```
>>> import dis
>>> def inplace_add():
...     a = 0
...     a += 1
... 
>>> def add_and_assign():
...     a = 0
...     a = a + 1
... 
>>> dis.dis(inplace_add)
  2           0 LOAD_CONST               1 (0)
              3 STORE_FAST               0 (a)

  3           6 LOAD_FAST                0 (a)
              9 LOAD_CONST               2 (1)
             12 INPLACE_ADD         
             13 STORE_FAST               0 (a)
             16 LOAD_CONST               0 (None)
             19 RETURN_VALUE        
>>> dis.dis(add_and_assign)
  2           0 LOAD_CONST               1 (0)
              3 STORE_FAST               0 (a)

  3           6 LOAD_FAST                0 (a)
              9 LOAD_CONST               2 (1)
             12 BINARY_ADD          
             13 STORE_FAST               0 (a)
             16 LOAD_CONST               0 (None)
             19 RETURN_VALUE 
```

区别是 a`INPLACE_ADD`与 a `BINARY_ADD`。

由此产生的时间太接近了，无法调用哪个更快：

```
>>> import timeit
>>> timeit.timeit('inplace_add', 'from __main__ import inplace_add', number=10000000)
0.32667088508605957
>>> timeit.timeit('add_and_assign', 'from __main__ import add_and_assign', number=10000000)
0.34172606468200684 
```

因此，在 python 中，差异可以忽略不计。别担心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-12T20:04:44.470

没有

```
>>> bar = timeit.Timer("a += 1", "a = 0")
>>> bar.timeit(number=1000000)
0.064391136169433594
>>> bar = timeit.Timer("a = a + 1", "a = 0")
>>> bar.timeit(number=1000000)
0.064393997192382812
>>> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-12T20:08:38.563

是的，但差异是微不足道的。

```
>>> timeit.Timer('x += 1', 'x = 0').timeit(10**8)
5.7387330532073975
>>> timeit.Timer('x = x + 1', 'x = 0').timeit(10**8)
6.04801607131958
>>> timeit.Timer('x += 1', 'x = 0').timeit(10**8)
5.790481090545654
>>> timeit.Timer('x = x + 1', 'x = 0').timeit(10**8)
6.083467960357666 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-13T06:08:08.037

`cProfile`我使用该模块采取了稍微不同的方法：

```
$ python -m cProfile test.py 
     4 function calls in 0.397 seconds

Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.397    0.397 test.py:2(<module>)
        1    0.205    0.205    0.205    0.205 test.py:2(add1)
        1    0.192    0.192    0.192    0.192 test.py:6(add2)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}

aaron@zebrafish:~/pyad$ cat test.py 
def add1(a):
    for x in xrange(10 ** 6):
        a += 1

def add2(a):
    for x in xrange(10 ** 6):
        a = a + 1

add1(0)
add2(0) 
```

运行大约 20 次后，我得出结论 add2 （使用`a = a + 1`）稍微快一点，但并非在所有情况下（也许尝试使用更多的循环）。这可能不是最好的启发式方法，但我认为随着数字越来越大的重复次数越多应该表明性能差异。

编辑 - 10 ** 9 次调用的结果：

```
 1  216.119  216.119  216.119  216.119 test.py:2(add1)
    1  195.364  195.364  195.364  195.364 test.py:6(add2) 
```

# java - 相同记录器的 sl4j logback 配置到具有不同级别的两个不同 appender

> ID：11925430
> 
> 赞同：0
> 
> 时间：2012-08-12T19:56:44.327
> 
> 标签：java, logging, slf4j, logback

如何在 SL4J 中配置 logback？我的项目有很多类：class1、class2、class3 ......我想做这两件事：将所有类记录到名为 FILE1 的文件 appender 中，带有 WARN 级别（class1、class2、class3...） 将一个名为 class1 的类记录到一个名为 FILE2 的文件附加程序，具有调试级别。

问题在于，当我将 class1 的记录器配置为具有 WARN 级别的 FILE1 appender 时，我不知道如何将相同的记录器（class1）配置为具有不同级别的 FILE2 appender（在本例中为 DEBUG）。我可以将两个附加程序配置为同一个类，但不能使用不同的级别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T05:35:16.863

1/ 将 class1 记录器的日志级别设置为 DEBUG

```
 <logger name="class1" level="DEBUG"/> 
```

2/ 对于 appender FILE1，使用[ThresholdFilter](http://logback.qos.ch/manual/filters.html#thresholdFilter)过滤日志级别 WARN 以下的任何日志记录事件

```
<appender name="FILE1" class="ch.qos.logback.core.FileAppender"> 
<filter class="ch.qos.logback.classic.filter.ThresholdFilter"> 
  <level>WARN</level> 
</filter> 
 ...  
</appender> 
```

这会将 DEBUG 以上的所有日志事件发送到 appender FILE2，但只有 WARN 以上的事件发送到 appender FILE1。

# html - 浏览器过小时，网站 ul / li 从水平变为垂直

> ID：11925434
> 
> 赞同：0
> 
> 时间：2012-08-12T19:57:23.890
> 
> 标签：html, resize, html-lists

当浏览器足够大时，我创建了一个看起来正确的网站。但是当您调整浏览器大小并使其更小时，过滤器部分（带有 li 项的 ul）会从水平变为垂直。

如果您访问网站 www.andrewsimonmcallister.tv。单击音乐菜单项。

当浏览器足够宽时，带有副标题的部分，然后是过滤器部分看起来还可以，但是当您缩小浏览器时，整个内容将变为带有点的垂直列表。无论如何要使排序选项水平堆叠，但在它们的容器内，然后使过滤器选项堆叠，但保持过滤器和排序部分水平。

此外，与音乐列表上的描述部分相同。我希望文本在下面换行，但留在描述部分，而不是在标题下。

所有的帮助都会很棒。

好的，现在代码

**HTML**

**顶部过滤器部分**

音乐过滤器：管弦乐电子其他显示：原声带广告

**描述部分**

```
<ul>
                                <li class="tracknumber">                                        
                                    <div id="jp_container_1" class="jp-audio" style="display:inline-block;">
                                        <div class="jp-type-single">
                                            <div class="jp-gui jp-interface">
                                                <ul class="jp-controls">
                                                    <li><a href="javascript:;" class="jp-play" tabindex="1">&nbsp;</a></li>
                                                    <li><a href="javascript:;" class="jp-pause" tabindex="1">&nbsp;</a></li>
                                                </ul>
                                                <div name="prog1" class="jp-progress">
                                                    <div name="seek1" class="jp-seek-bar">
                                                        <div name="play1" class="jp-play-bar"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="number1" class="number">1</div>
                                </li>
                                <li class="tracktitle">Beginnings</li>
                                <li class="tracktime">2:04</li>
                                <li class="trackprogress"><div id="trackprogress1" class="trackprogressbar"></div></li>
                                <li class="trackcat">Orchestral</li>
                                <li class="trackdescription">Lush sweeping strings in this opening credits cue.</li>
                            </ul> 
```

** CSS **

```
.contentinformation {
padding-left: 10px;
color: #303234;
font-size: 16px;
letter-spacing: 0;
}

.contentfilterlist {
display: inline-block;
list-style-type: none;
left: 0;
right: 0;
}

.contentfilteritem {
display:inline-block;
list-style-type: none;
}

.contentfiltertitle {
padding-left: 10px; 
padding-right: 10px; 
vertical-align: middle;
font-size: 18px; 
letter-spacing: 0;
}

.contentfilteroption {
padding-left: 8px;  
vertical-align: bottom;
}

.contentfiltertext {
padding-right: 6px; 
vertical-align: middle;
letter-spacing: 0;
font-size: 13px;
font-variant: small-caps;
}

.contentfilterdivide {
padding-right: 80px;
}

.contentmain {
position: absolute;
left: 0;
right: 0;
top: 40px;
padding-left: 100px;
padding-right: 100px;
z-index: 11;
}

/****************************************
* Music
****************************************/
.tracktitle{
display:inline-block;
width: 250px;
}

.tracktime{
    display:inline-block;
width: 55px;
}

.trackprogress{
    display:inline-block;
width: 110px;
}

.trackprogressbar {
background: url("../images/music/progress-bg.gif") 0 0 repeat-x;
width:80px;
height:8px;
cursor: pointer;
opacity: 0.5;
    -moz-opacity: 0.5;
    filter:alpha(opacity=50);
    z-index: 12;
}

.trackcat {
    display:inline-block;
width: 135px;
}

.trackdescription{
    display:inline;
} 
```

非常感谢所有帮助！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T10:57:25.703

如评论中所述，您应该在`table`此处使用该元素：

```
<table>

<thead>
 <tr>
  <th>Tracknumber</th>
  <th>Title</th>
  <th>Time</th>
  <th>Progress</th>
  <th>Category</th>
  <th>Description</th>
 </tr>
</thead>

<tbody>

 <tr>
  <td>1</td>
  <td>Beginnings</td>
  <td>2:04</td>
  <td><div id="trackprogress1" class="trackprogressbar"></div></td>
  <td>Orchestral</td>
  <td>Lush sweeping strings in this opening credits cue.</td>
 </tr>

<tr>
 <td>…&lt;/td>
 <td>…&lt;/td>
 <td>…&lt;/td>
 <td>…&lt;/td>
 <td>…&lt;/td>
 <td>…&lt;/td>
</tr>

</tbody>

</table> 
```

# cordova - 在phonegap中加载页面时如何发送数据以显示在html中

> ID：11925435
> 
> 赞同：1
> 
> 时间：2012-08-12T19:57:28.983
> 
> 标签：cordova

假设我的站点 index.html 和 phonegap 中的 about.html 中有两个页面。现在我想在使用 jQuery 或 jQueryMobile 从 index.html 转到 about.html 时加载一些数据。我见过两种方法 $.mobile.loadPage() 和 $.mobile.changePage() 可以将数据传送到页面关注点。

现在，如果我在将页面从 index.html 更改为 about.html 时发送一些数据，如何接收这些数据并在 about.html 中显示它们？

我正在使用这个标签去 about.html

```
<a href="" data-role="button" data-icon="arrow-r" data-iconpos="right" 
onclick="loadTest();" >Test</a> 
```

loadTest() 的代码是

```
function loadTest() {
        var name = "Rafiul Sabbir";
    var email = "iamrafiul@gmail.com";
    $.mobile.changePage( "about.html", {
        type: "post",
        data: {name: name, email: email},
    });     
} 
```

我about.html的body部分的主要内容如下

```
<div data-role="content">
    <h3>Data Goes here</h3>
    <table>
        <tr>
        <td>Name</td>
        <div id="name" class="name">
        </div>
         </tr>
         <tr>
        <td>Email</td>
        <div id="email" class="email">
        /div>
        </tr>
    </table>
</div><!-- /content --> 
```

现在我如何使用 loadTest() 方法接收/获取我从 index.html 发送的名称和电子邮件并将其显示在 about.html

请帮我。我有大麻烦了。如果还有其他方法，也请告诉我！！任何有效的东西对我来说都足够好。

# php - in_array 没有找到数组中的值

> ID：11925437
> 
> 赞同：-1
> 
> 时间：2012-08-12T19:57:42.457
> 
> 标签：php, arrays

`$_GET`尝试根据白名单数组检查变量时，我得到了奇怪的结果。该变量在数组中，但`in_array`没有找到它。我会尽我所能描述正在发生的事情。

`$_GET`变量是从选项/选择选项中设置的，总共三个。只有一个选项给我带来了问题。要运行`SELECT`查询，必须至少选择两个选项。其他两个选项的任何组合都按预期工作。

为了获得选项/选择列表，我有一个`SELECT`检索记录子集的查询。

从那个记录集中，我使用一个`foreach`循环来获取各种值来填充选择标签。因此，选择值由 db 表中的值填充。白名单数组是从数据库复制的。

我根据白名单数组检查任何`$_GET`变量。有问题的选项可以是逗号分隔的字符串（例如，'Italian,Pizza' 或'American, Barbeque, Sandwiches'）。

要获取此选项的选择值列表，我使用`implode`创建每个类别的逗号分隔列表，然后使用`explode`创建数组，然后使用`array_unique`获取每个类别的单个实例的数组。回显此数组时，一切都是正确的（它正确填充了选择选项）。

`implode`输出：

`Italian,Pizza,Italian,Pizza,Italian,Pizza,Italian,Italian,Sandwiches,Italian,Pizza,Italian`

`explode`输出：

```
 Array
    (
        [0] => Italian
        [1] => Pizza
        [2] => Italian
        [3] => Pizza
        [4] => Italian
        [5] => Pizza
        [6] => Italian
        [7] => Italian
        [8] => Sandwiches
        [9] => Italian
        [10] => Pizza
        [11] => Italian
    ) 
```

`array_unique`输出：

```
 Array
    (
        [0] => Italian
        [1] => Pizza
        [8] => Sandwiches
    ) 
```

因此，URL 可以是： `../search.php?var_src=Sandwiches&city_src=Cityname`

清理`$_GET`变量：

```
 if((isset($_GET['var_src'])) && in_array($_GET['var_src'], $var_array)) {
        $var_sort = $_GET['var_src'];
    } 
```

同样，`$var_array`是从 db 表复制的数组。

这是代码停止的地方，因为`$_GET`在数组中找不到 var。

如果我将其中一个数据库记录更改为一个类别值（例如“三明治”）并在列表中选择该选项，则结果与预期一致。但是，如果记录具有多个类别值（每个都在白名单数组中），例如“Pizza,Sandwiches”，那么它们都不起作用。

更重要的是，如果我在 db 记录中包含类别值“Italian”，无论是单独还是与其他值一起，并选择该值，那么它就可以工作。我不知道为什么。

因此，如果选择了该特定值（'Italian'），则无论是否将其他值作为记录的逗号分隔字符串包含在内，该代码都可以工作，并且不适用于与记录关联的值超过一个的其他值。

我确认有问题的值在 URL 中，因此应该使用上面的代码 (in_array($_GET['var_src'], $var_array))。

另外，我不知道为什么更改数据库记录会产生影响，因为对白名单的清理发生在根据传递的值选择记录之前。据我所知，`in_array`只是没有在数组中找到合法值。

希望我没有让这令人困惑。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:32:33.623

不确定这是否对您有帮助，请尝试像以下示例中那样更改它：

```
$opt = array( 'Italian,Pizza' , 'American, Barbeque, Sandwiches');
$opts = implode(',',$opt);
$opta = explode(',',$opts);
foreach ($opta as $key=>$value) {
    $opta[$key]=trim($value);
}
$opta = array_flip($opta);
var_export($opta);
//now test it simply with isset:
$val = trim($_GET['var_src']);
echo isset($opta[$val])? 'yes':'no'; 
```

# php - 使用字符串引用数组时出现非法字符串偏移

> ID：11925442
> 
> 赞同：0
> 
> 时间：2012-08-12T19:58:18.803
> 
> 标签：php, variables

我有类，每个类都有一个与日期相关的成员变量，它总是具有相同的命名格式 -`field_{$node->type}_date`

例如，如果我的节点类型是“汽车”，则日期字段将被命名`field_car_date`

所以我正在遍历我的所有节点，我想访问每个节点的日期相关字段。但是我收到一个错误。这是代码

```
$date_field_key = 'field_' . $node->type . '_date';
if (isset($node->$date_field_key['und'][0]['value'])) { 
```

由于第二行，我得到一个错误。错误是 -`Illegal string offset 'und'` 与日期相关的变量是一个数组，它确实有一个带有键“und”的元素。如果我明确地写出该行`$node->field_car_date['und'][0]['value']`--它可以正常工作。只是当我动态创建字段名称时，我遇到了这个问题。

对此有任何解决方案，我的语法不正确吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T20:00:39.733

您需要将键值括起来，`{}`因为它是一个动态分配的变量。

在你的第二行，你有`$node->$date_field_key['und'][0]['value']`你应该有的地方：

```
$node->{$date_field_key}['und'][0]['value'] 
```

注意`{}`周围的`date_field_key`

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T20:03:04.403

没有理由保留变量：

```
$array = $this->$date_field_key;
$value = $array['und'][0]['value']; 
```

如果你让它发挥作用，我们就可以讨论更高级的话题。

# spring - DataNucleus: Class ... for query 尚未解决。检查查询和任何导入规范

> ID：11925449
> 
> 赞同：3
> 
> 时间：2012-08-12T19:59:14.850
> 
> 标签：spring, spring-roo, datanucleus

我有一个问题，希望有人能给我一些提示。

环境：

*   ****具有两个模块的****maven**项目**

*****   一个模块是“**模型**”，具有**DataNucleus 3.1**、**HSQLDB**和**Spring 3**依赖项。HSQLDB 在内存中运行**嵌入式**，从 spring applicationContext.xml 配置

    *   另一个模块是“网络”并且具有**GWT 依赖项****** 

 ****该应用程序是使用一些 Spring Roo 生成的代码作为基础构建的，随后对其进行了修改和扩展。

问题是，在启动应用程序并尝试加载数据时，我收到异常：

```
 Class Document for query has not been resolved. Check the query and any imports specification; nested exception is javax.persistence.PersistenceException: Class Document for query has not been resolved. Check the query and any imports specification 
```

最奇怪的是，示例 roo 生成的应用程序用作基础，具有完全相同的依赖关系，但不同的模块化就像一个魅力，没有这个症状，所以我现在很困惑......请注意我试图替换查询中具有显式限定“com.myvdm.server.domain.Document”的“文档”，没有肯定结果：

```
return entityManager().createQuery("SELECT COUNT(o) FROM Document o", Long.class).getSingleResult(); 
```

另一件事，尽管它可能不相关，但在每个请求上，都会引发此异常：

```
 DEBUG org.springframework.orm.jpa.EntityManagerFactoryUtils - Unexpected exception on closing JPA EntityManager [INFO] java.lang.IllegalStateException: EntityManager is managed by a container (JEE) and so cannot be closed by calling the EM.close() method. Please read JPA2 spec 3.1.1 for the close() method. 
```

最后一个异常是由 DataNucleus 引发的。这也令人困惑，因为我不是在 Java EE 容器中运行，而是在 GWT 开发模式下运行。

这是文档实体：

```
@RooJavaBean
@RooToString
@RooJpaActiveRecord
public class Document {

    @NotNull
    private String name;

    @ManyToOne
    private DocumentType type;

    @OneToMany(fetch = FetchType.EAGER,
        cascade = CascadeType.ALL)
    private Set<Field> fields;
} 
```

注释 @RooJpaActiveRecord 添加了 EntityManager 操作，但这些操作是在单独的文件中声明的 - ITD（类型间声明）

请问有什么建议吗？提前非常感谢。

- - - - - - 编辑 - - - - - - -

```
privileged aspect Document_Roo_Jpa_ActiveRecord {

    @PersistenceContext
    transient EntityManager Document.entityManager;

    public static final EntityManager Document.entityManager() {
        EntityManager em = new Document().entityManager;
        if (em == null) throw new IllegalStateException("Entity manager has not been injected (is the Spring Aspects JAR configured as an AJC/AJDT aspects library?)");
        return em;
    }

    public static long Document.countDocuments() {
        return entityManager().createQuery("SELECT COUNT(o) FROM Document o", Long.class).getSingleResult();
    }

    public static List<Document> Document.findAllDocuments() {
        return entityManager().createQuery("SELECT o FROM Document o", Document.class).getResultList();
    }

    public static Document Document.findDocument(Long id) {
        if (id == null) return null;
        return entityManager().find(Document.class, id);
    }

    public static List<Document> Document.findDocumentEntries(int firstResult, int maxResults) {
        return entityManager().createQuery("SELECT o FROM Document o", Document.class).setFirstResult(firstResult).setMaxResults(maxResults).getResultList();
    }

    @Transactional
    public void Document.persist() {
        if (this.entityManager == null) this.entityManager = entityManager();
        this.entityManager.persist(this);
    }

    @Transactional
    public void Document.remove() {
        if (this.entityManager == null) this.entityManager = entityManager();
        if (this.entityManager.contains(this)) {
            this.entityManager.remove(this);
        } else {
            Document attached = Document.findDocument(this.id);
            this.entityManager.remove(attached);
        }
    }

    @Transactional
    public void Document.flush() {
        if (this.entityManager == null) this.entityManager = entityManager();
        this.entityManager.flush();
    }

    @Transactional
    public void Document.clear() {
        if (this.entityManager == null) this.entityManager = entityManager();
        this.entityManager.clear();
    }

    @Transactional
    public Document Document.merge() {
        if (this.entityManager == null) this.entityManager = entityManager();
        Document merged = this.entityManager.merge(this);
        this.entityManager.flush();
        return merged;
    }
} 
```

@Entity 声明

```
privileged aspect Document_Roo_Jpa_Entity {

    declare @type: Document: @Entity;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Column(name = "id")
    private Long Document.id;

    @Version
    @Column(name = "version")
    private Integer Document.version;

    public Long Document.getId() {
        return this.id;
    }

    public void Document.setId(Long id) {
        this.id = id;
    }

    public Integer Document.getVersion() {
        return this.version;
    }

    public void Document.setVersion(Integer version) {
        this.version = version;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:23:39.877

好的，我找到了解决此问题的方法。正如我之前发布的，使用 Spring 的 applicationContext.xml 和 persistence.xml 文件作为基本配置，我无法使其工作。我删除了persistence.xml，而是使用了这个配置（请注意packagesToScan属性的使用和传递DataNucleus属性——基本上所有传统上在persistence.xml中的信息）：

```
 <bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" 
      id="entityManagerFactory">
    <property name="persistenceUnitName" value="persistenceUnit"/>
    <property name="packagesToScan" value="com.myvdm.server.domain"/>
    <property name="persistenceProviderClass" value="org.datanucleus.api.jpa.PersistenceProviderImpl"/>
    <property name="jpaPropertyMap">
        <map>
            <entry key="datanucleus.ConnectionDriverName" value="org.hsqldb.jdbc.JDBCDriver"/>
            <entry key="datanucleus.storeManagerType" value="rdbms"/>
            <entry key="datanucleus.ConnectionURL" value="jdbc:hsqldb:mem:myvdm"/>
            <entry key="datanucleus.ConnectionUserName" value="sa"/>
            <entry key="datanucleus.ConnectionPassword" value=""/>
            <entry key="datanucleus.autoCreateSchema" value="true"/>
            <entry key="datanucleus.autoCreateTables" value="true"/>
            <entry key="datanucleus.autoCreateColumns" value="false"/>
            <entry key="datanucleus.autoCreateConstraints" value="false"/>
            <entry key="datanucleus.validateTables" value="false"/>
            <entry key="datanucleus.validateConstraints" value="false"/>
            <entry key="datanucleus.jpa.addClassTransformer" value="false"/>
        </map>
    </property>
    <property name="dataSource" ref="dataSource"/>
</bean> 
```

所以这是我让它工作的唯一方法，这可能是一个 Spring 错误吗？

关于第二个（次要）问题，显然会抛出异常，因为我使用的是 Spring 的 LocalContainerEntityManagerFactoryBean :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T21:19:05.417

这不是 Spring 错误，它只是一个“调试”级别的消息。要禁止显示该消息，请更改日志级别`<logger name="org.springframework.orm.jpa.EntityManagerFactoryUtils" additivity="false" level="error"/>`。

在此处查看我的 ORM 演示：[https ://github.com/gordonad/core-spring-demos/tree/master/demos/orms](https://github.com/gordonad/core-spring-demos/tree/master/demos/orms)****

# azure - 服务器在检索指标时遇到错误 - Azure Ubuntu VM 中没有仪表板指标

> ID：11925453
> 
> 赞同：0
> 
> 时间：2012-08-12T19:59:55.870
> 
> 标签：azure, squid

我收到此错误：“服务器在检索指标时遇到错误。重试操作。” 在仪表板中，我在 Azure Ubuntu 12.04 服务器 VM 中安装和删除了 squid 代理服务器后没有显示使用情况概述统计信息。

有谁知道恢复它们的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T23:56:00.660

我认为这与您所做的任何事情都没有关系，我认为 MS 在指标方面存在一些问题，因为我在未更改的实例上收到了相同的消息。

如果这对您很重要，我会记录 MS 支持的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:08:16.617

我和你有完全相同的错误。在此错误出现之前，我的服务实例运行顺利。即使出现此错误，服务实例似乎仍在顺利运行。只是我无法获得有关实例的统计信息。这是可以理解的，因为 Azure 现在只是 CTP。但我真的希望 MS 很快就会解决这个问题。

# javascript - d3.js 中的 HTML 工具提示清理

> ID：11925457
> 
> 赞同：7
> 
> 时间：2012-08-12T20:00:50.550
> 
> 标签：javascript, jquery, tooltip, d3.js

[我按照这个例子](http://bl.ocks.org/2514276)在 d3.js 中实现了 HTML 工具提示，使用如下代码：

```
function onmouseover(d) {
    $("#tooltip").fadeOut(100,function () {
        // generate tooltip
        $("#tooltip").fadeIn(100);
    });
}

function onmouseout() {
    $("#tooltip").fadeOut(250);
} 
```

它可以工作，但会表现出一种行为，即如果鼠标在多个节点上快速移动，则工具提示可能会卡在页面上。上面的[示例](http://bl.ocks.org/2514276)显示了相同的行为（快乐的摆动！）。

做了一些研究后，似乎[nvd3使用](http://nvd3.com/)[dispatch](https://github.com/mbostock/d3/wiki/Internals)很好地解决了这个问题。但是我不太清楚调度是如何工作的，基于[这个问题](https://stackoverflow.com/questions/9882226/how-to-properly-add-and-use-d3-events)，我想在这种情况下可能有一种更简单的方法。

**更新**

此问题仅由fadeIn 和fadeOut 引起。如果这些设置为零，则没有问题。所以问题实际上是是否可以设置它，以便在有另一个鼠标悬停/退出事件时中断淡入/淡出。

**解析度**

问题是只有一个工具提示。这在 JQuery 淡出过程中无法响应事件。答案是有多个工具提示，这样一个可以淡入而旧的淡出。这可以通过两种方式实现：

*   jQuery 淡出
*   CSS 过渡（[NVD3](http://nvd3.com/)使用的方法）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-18T15:44:48.273

NVD3 的解决方案是每次在任何节点上发生 mouseout 事件时运行一个清理方法。在第 78 行查看他们的源代码：[https](https://github.com/novus/nvd3/blob/master/src/tooltip.js) ://github.com/novus/nvd3/blob/master/src/tooltip.js 。这不必通过`d3.dispatch`; 它也可以直接完成。

您还可以查看为可靠地捕获`mouseout`事件而建议的一些解决方法：[为什么我不能可靠地捕获 mouseout 事件？](https://stackoverflow.com/questions/7448468/why-cant-i-reliably-capture-a-mouseout-event)

# ruby-on-rails - CanCan：在 MainApp 以外的命名空间中的 load_and_authorize_resource

> ID：11925462
> 
> 赞同：6
> 
> 时间：2012-08-12T20:01:24.170
> 
> 标签：ruby-on-rails, ruby-on-rails-plugins, cancan, rails-engines

我在我的 Rails 应用程序中使用 CanCan 来获取权限，在该应用程序中，我为一些通用表单功能构建了自己的引擎。我想锁定我系统中的权限，以便用户无法自由访问我的引擎控制器的操作。在大多数情况下，这些控制器只使用 7 个 REST 动作，所以我想`load_and_authorize_resource`在每个控制器的顶部使用 CanCan。

但是，当我这样编写代码时：

```
 module MyEngine
      class FormController < ApplicationController
        load_and_authorize_resource
        ...
      end
    end 
```

我收到此错误：

```
 uninitialized constant Form 
```

我的猜测是，自动加载程序`load_and_authorize_resource`与我的 MainApp 命名空间相关联，并且无法识别我在不同的命名空间中调用它，因此调用类似`Form.find(params[:id])`而不是`MyEngine::Form.find(params[:id])`.

如果是这种情况，我该如何解决？这不是什么大问题，因为`authorize!`仍然可以正常工作，所以我可以在每个操作中单独定义授权，但是如果我能够使用该`load_and_authorize_resource`方法，感觉会更干净。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T17:14:53.357

CanCan 找不到命名空间模型。尝试指定类：

```
load_and_authorize_resource class: MyEngine::Form 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-01T20:25:51.463

这似乎是一个错误`CanCan::ControllerResource#namespace`：

```
def namespace
  @params[:controller].split("::")[0..-2]
end 
```

如您所见，它尝试拆分控制器路径，`::`但它以`my_engine/my_controller`.

所以修复很简单：

```
def namespace
  @params[:controller].split("/")[0..-2]
end 
```

想知道他们怎么会错过这么长时间的愚蠢错误。应向他们发送拉取请求。

PS 刚报名回答 8)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-22T08:32:22.607

如果模型类的命名空间与控制器不同，则需要指定该`:class`选项。

```
module MyEngine
  class FormController < ApplicationController
    load_and_authorize_resource :class => MyEngine::Form
    ...
  end
end 
```

# ibm-mq - 远程队列管理器别名未按预期工作

> ID：11925466
> 
> 赞同：2
> 
> 时间：2012-08-12T20:02:09.740
> 
> 标签：ibm-mq

我已经在三个系统上设置了 MQ7.0：A、B 和 C。A -> B 有发送方-接收方通道（AB）和 B->C，有发送方-接收方通道（BC）。传输队列名称相同。队列管理器的名称分别为 QMA、QMB 和 QMC。现在我在系统 C 上有一个队列 QC。我在系统 A 上定义了一个远程队列定义为：define qremote(RQ) rname(QC) rqmname(third) xmitq(AB)

我在系统 B 上有一个定义远程队列管理器定义为：define qremote(third) rname('') rqmname(QMC) xmitq(BC)

现在，当我将消息发送到 A 上的远程队列 RQ 时，我所期望的是，它应该通过系统 B 上的 tx 队列（AB）上的通道以“第三个 QC”的传输标头传送到系统 B，因为第三个别名为 QMC 所以这条消息应该被放到 tx BC 并且应该到达系统 C 上的队列 QC。但是在我放入消息之后，它就丢失了。我对远程队列管理器别名的理解是否错误。谁能举个更好的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:35:49.520

试试这个：

**在 QMA 上**

```
DEF QR(QMC) RQMNAME(' ')   RNAME(' ') XMITQ(QMB)
DEF QR(QC)  RQMNAME('QMC') RNAME(' ') XMITQ('QMB')
DEF QL(QMB) USAGE(XMITQ) TRIGTYPE(FIRST) TRIGGER
* Channel def goes here 
```

QRemote 是 QMgr 的别名。它指定通过 QMB XMitQ 的 QMC 路径。一旦定义好，任何发往 QMC 的东西都将解析为 QMB XMitQ。空白`RNAME`和`RQMNAME`是什么使它成为 QMgr 别名而不是经典的远程队列定义。此时，如果您使用 Q 程序之类的工具，它允许您指定要连接的 QMgr 与用于`OPEN`命令的 QMgr 分开，您甚至不需要`QRemote`. 任何发往 QMC 的消息现在都将解析为 QMB。

但是，如果您想使用不太复杂的东西，`amqsput`那么您确实需要一个 QRemote。`DEF QR(QC`做到了这一点。如果您愿意使用 QRemotes，那么您实际上并不需要 QMgr 别名。这只是说“如果有人打开一个名为的队列`QC`，则将其寻址到`QC`on`QMC`并将其放在`QMB`XMitQ 上。

**在 QMB 上**

```
DEF QL(QMC) USAGE(XMITQ) TRIGTYPE(FIRST) TRIGGER
* Channel def goes here 
```

在 QMB 上，当消息到达 QMC 时，它们将自动解析到 XMitQ，而无需任何进一步的定义或指导。

**在 QMC 上**

```
DEF QL(QC) 
```

最后，消息到达 QMC，地址为 QC，因此您需要一个 QLocal 才能让它们登陆。

名称解析有点复杂，但是一旦你理解了它，你就几乎理解了 WMQ 寻址。我建议坐下来讨论[名称解析信息中心主题](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r1/topic/com.ibm.mq.doc/fg12170_.htm)，并重新考虑您所看到的行为。

顺便说一句，您的定义中的差异似乎是您的 QRemote 使用了频道的名称而不是 XMitQ。有一次您说“传输队列名称相同。队列管理器的名称分别为 QMA、QMB 和 QMC。” 所以我希望在 B 上找到一个名为`QMC`服务 QMB.QMC 频道的 XMitQ。但稍后您将 QMgr 别名定义为`define qremote(third) rname('') rqmname(QMC) xmitq(B.C)`应该是`XMITQ(QMC)`.

# asp.net - 访问多个动态下拉列表选定的值 - ASP.Net

> ID：11925473
> 
> 赞同：0
> 
> 时间：2012-08-12T20:03:41.873
> 
> 标签：asp.net, vb.net

我正在向我的表单添加多个动态下拉列表。我想通过单击按钮访问下拉列表的选定值。

```
 Private pnlDropDownList As Panel
                Protected Sub Page_PreInit(ByVal sender As Object, ByVal e As EventArgs) Handles Me.PreInit
                    'Create a Dynamic Panel 
                    pnlDropDownList = New Panel()
                    pnlDropDownList.ID = "pnlDropDownList"
                    pnlDropDownList.BorderWidth = 1
                    pnlDropDownList.Width = 300
                    Me.form1.Controls.Add(pnlDropDownList)

                    'Create a LinkDynamic Button to Add TextBoxes 
                    Dim btnAddDdl As New Button
                    btnAddDdl.ID = "btnAddDdl"
                    btnAddDdl.Text = "Add DropDownList"
                    AddHandler btnAddDdl.Click, AddressOf btnAdd_Click
                    Me.form1.Controls.Add(btnAddDdl)

                    'Recreate Controls
                    RecreateControls("ddlDynamic", "DropDownList")
                End Sub

                Protected Sub btnAdd_Click(ByVal sender As Object, ByVal e As EventArgs)
                    Dim cnt As Integer = FindOccurence("ddlDynamic")
                    CreateDropDownList("ddlDynamic-" & Convert.ToString(cnt + 1))
                End Sub

                Private Function FindOccurence(ByVal substr As String) As Integer
                    Dim reqstr As String = Request.Form.ToString()
                    Return ((reqstr.Length - reqstr.Replace(substr, "").Length) / substr.Length)
                End Function

                Private Sub RecreateControls(ByVal ctrlPrefix As String, ByVal ctrlType As String)
                    Dim ctrls As String() = Request.Form.ToString().Split("&"c)
                    Dim cnt As Integer = FindOccurence(ctrlPrefix)
                    If cnt > 0 Then
                        For k As Integer = 1 To cnt
                            For i As Integer = 0 To ctrls.Length - 1
                                If ctrls(i).Contains((ctrlPrefix & "-") + k.ToString()) AndAlso Not ctrls(i).Contains("EVENTTARGET") Then
                                    Dim ctrlID As String = ctrls(i).Split("="c)(0)

                                    If ctrlType = "DropDownList" Then
                                        CreateDropDownList(ctrlID)
                                    End If
                                    Exit For
                                End If
                            Next
                        Next
                    End If
                End Sub

                Private Sub CreateDropDownList(ByVal ID As String)

                    Dim ddl As New DropDownList()
                    ddl.ID = ID
                    ddl.DataSource = Me.odsNames
                    ddl.DataTextField = "Name"
                    ddl.DataValueField = "ID"
                    ddl.DataBind()
                    ddl.Items.Insert(0, New ListItem("All", -1))
                    ddl.SelectedIndex = 0
                    ddl.AutoPostBack = True
                    AddHandler ddl.SelectedIndexChanged, AddressOf OnSelectedIndexChanged
                    pnlDropDownList.Controls.Add(ddl)

                    Dim lt As New Literal()
                    lt.Text = "<br />"
                    pnlDropDownList.Controls.Add(lt)
                End Sub

                Protected Sub OnSelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)
                    'Not used, want to get Values from button click
                End Sub

            Protected Sub cmdAdd_Click(ByVal sender As Object, ByVal e As EventArgs) Handles cmdAdd.Click
                                    Dim cnt As Integer = FindOccurence("ddlDynamic")
                                    pnlDropDownList.Controls.Remove(pnlDropDownList.FindControl("ddlDynamic-" & Convert.ToString(cnt)))
            End Sub 
```

这是我想检查所有动态下拉列表并提取它们选择的值的地方

```
 Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
                    '' Check All dynamic Dropdownlists and retrieve selected values
                End Sub

            End Class 
```

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T08:36:48.903

您可以使用在面板 `Linq`中获取动态的引用：`DropDowns`

```
Dim allDdls = pnlDropDownList.Controls.OfType(Of DropDownList)()
For Each ddl In allDdls
    Dim selectedValue = ddl.SelectedValue
Next 
```

# wordpress - 每种屏幕分辨率的流体 + 响应式或不同样式表？

> ID：11925482
> 
> 赞同：0
> 
> 时间：2012-08-12T20:04:44.963
> 
> 标签：wordpress, responsive-design, fluid

我正在构建一个要在市场上销售的 wordpress 主题。什么是最佳选择，Fluid 和 Responsive（使用 css 媒体查询）或为每个屏幕分辨率使用不同的样式表？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:12:21.217

不是一个允许正确答案的问题，但这是我的 2p/

如果您将其用于商业市场，您可能会找到更多我建议的客户 - 只需查看[Themeforest](http://themeforest.net/)上针对响应式主题产生的销售额即可。

# sql - 存储过程的子查询问题

> ID：11925484
> 
> 赞同：0
> 
> 时间：2012-08-12T20:04:49.270
> 
> 标签：sql, tsql, stored-procedures

我要执行的查询是

```
With getusers As
    (Select userID from userprofspecinst_v where institutionID IN
    (select institutionID, professionID from userprofspecinst_v where userID=@UserID) 
    and professionID IN 
    (select institutionID, professionID from userprofspecinst_v where userID=@UserID))

    select username from user where userID IN (select userID from getusers) 
```

这就是我想要做的。给定一个用户 ID 和一个包含用户 ID 以及他们的机构和专业 ID 的视图，我想获取也具有相同机构 ID 和专业 ID 的其他用户 ID 的列表。然后使用该用户 ID 列表，我想从另一个表（用户）获取与每个用户 ID 对应的用户名。我在尝试创建过程时遇到的错误是，“当 EXISTS 未引入子查询时，选择列表中只能指定一个表达式。”。我是否采取了正确的方法来构建此查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:17:53.997

以下查询应该执行您想要执行的操作：

```
SELECT      u.username

FROM        user AS u
INNER JOIN  userprofspecinst_v AS up ON u.userID = up.userID
INNER JOIN  (SELECT institutionID, professionID FROM userprofspecinst_v 
                 WHERE userID = @userID) AS ProInsts
                     ON (up.institutionID = ProInsts.institutionID 
                                 AND up.professionID = ProInsts.professionID) 
```

实际上，关键部分是最后一个 INNER JOIN 语句 - 这将创建一个表，其中包含用户 ID 所属的 insitutionsids 和 professsionids。然后，我们在视图中获取具有相同机构 ID 和职业 ID（ON 条件）的所有匹配项，然后将它们链接回相应用户 ID 上的用户表（第一个 JOIN）。

您可以为您感兴趣的每个用户 id 运行此命令，也可以加入查询结果（您的`getusers`）（这取决于您正在运行的数据库引擎）。

如果您不熟悉 JOIN，Jeff Atwood 的[介绍性帖子](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)是一个很好的起点。

The JOIN statement effectively allows you to explot the logical links between your tables - the userId, institutionID and professionID are all examples of candidates for [foreign keys](http://www.w3schools.com/sql/sql_foreignkey.asp) - so, rather than having to constantly subquery each table and piece the results together, you can link all the tables together and filter down to the rows you want. It's usually a cleaner, more maintainable approach (although that is opinion).

# ajax - 如何使用 Ajax 在 Django 模板中从 django 模型中分离输出数据

> ID：11925487
> 
> 赞同：1
> 
> 时间：2012-08-12T20:05:08.803
> 
> 标签：ajax, django, django-templates, django-views

您好我正在尝试使用 AJAX 从我的数据库中显示主题名称。这是我现在的输出：

```
[{"pk": 1, "model": "school.subjects", "fields": {"name": "Math 140"}},
{"pk": 2, "model": "school.subjects", "fields": {"name": "English 102"}},
{"pk": 3, "model": "school.subjects", "fields": {"name": "CS210"}}] 
```

但我只想显示：我该怎么做？

```
Math 140
English 102
CS210 
```

这就是我的看法：

```
@csrf_exempt
def subjects_list(request):
    if request.is_ajax():
        user = request.user
        subjects = Subjects.objects.filter(user__exact = user)
        result = serializers.serialize("json", subjects, fields=('name'))
    else:
        result = "blablabl"
    return HttpResponse(result) 
```

这就是我的 test.html

```
{% extends "base.html" %}
{% block main-menu %}
    <div id="result"></div>
    <script type="text/javascript">
        $(function() {
            $.get("/subjects-list", function(data){
                $("#result").append(data);
            });
        }); 
    </script>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:31:20.270

不要直接序列化你的模型，这是不安全的，因为用户会看到合理的内部字段。

您想使用真正的 API 引擎，例如[django-tastypie](https://github.com/toastdriven/django-tastypie/)或[django-piston](https://bitbucket.org/jespern/django-piston/wiki/Home)。使用这种引擎，您将能够选择要显示的字段、管理授权、输出格式等...

例如，使用`tastypie`：

```
class SubjectResource(ModelResource):
    class Meta:
        queryset = Subject.objects.all()
        resource_name = 'subjects'
        fields = ['name'] 
```

将产生：

```
{
  "objects": [
    {"name": "Math 140"},
    {"name": "English 102"},
    {"name": "CS210"},
  ]
} 
```

当然，您可以`objects`使用以下实例方法删除包装器：

```
def alter_list_data_to_serialize(self, request, data):
    data[self.Meta.resource_name] = data['objects']
    del data['objects']
    del data['meta']
    return data 
```

这是最干净的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:34:52.000

这是因为您从服务器返回的数据是 JSON。这需要在加载到您的 DOM 之前进行解析。你可以这样做：

复制，然后添加到您的**test.html** ...

```
{% extends "base.html" %}
{% block main-menu %}
    <div id="result"></div>
    <script type="text/javascript">
        $(function() {
            $.get("/subjects-list", function(data){
                var $results = $("#result");
                for (var i = 0; i < data.length; i++) {
                    $results.append(data[i]["fields"]["name"] + "<br/>");
                }
            }, "json");
        }); 
    </script>
{% endblock %} 
```

尽管如此，您可能想考虑使用 javascript 模板库。那里有很多。一般的想法是该库可以处理将 AJAX 响应转换为 HTML。

有一些 stackoverflow 问题回答了此处使用哪个问题：

[推荐用于 JQuery 的 JavaScript HTML 模板库？](https://stackoverflow.com/questions/449780/recommended-javascript-html-template-library-for-jquery)

[jQuery 的首选模板库是什么？](https://stackoverflow.com/questions/7704329/what-is-the-preferred-template-library-for-jquery?lq=1)

为了找到有关此的更多信息，您需要搜索“javascript 模板”。

# asp.net - 如何为博客创建 Google 博客类型的子域 URL

> ID：11925490
> 
> 赞同：1
> 
> 时间：2012-08-12T20:05:19.523
> 
> 标签：asp.net

我必须在我的网站上创建一个博客部分。如果我的网站是 www.abc.com，那么我必须创建不同的博客，例如谷歌博客服务。

[http://author1.abc.com](http://author1.abc.com)

[http://author2.abc.com](http://author2.abc.com)

我有能力创建无限的子域，但我无法理解上述博客 URL 将如何工作。这些将是虚拟子域，或者我必须创建实际的子域。是否可以通过 URL 重写？如果是，如何？

如果我使用 URL 重写，浏览器会将上面的 URL 重定向到我已经为其创建 URL 重写规则的页面。我不想更改浏览器中的 URL。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:08:56.337

我认为您需要为此创建实际的子域，我认为这不能通过 URL 重写来实现

# php - 在php中重新加载页面

> ID：11925495
> 
> 赞同：0
> 
> 时间：2012-08-12T20:05:36.757
> 
> 标签：php, web

在设计注册页面时，如果用户在填写框中提交了任何错误，我希望重新加载页面。用户输入错误的提交按钮后如何重新加载页面？（同时通过 php 验证预期内容）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:07:38.333

您可以使用`header()`plus 一些`_GET`变量来告诉原始页面有错误。

表单提交页面：

```
<?php
   //.... lots of code validation
   if ($failed) {
      header('Location: http://path.com/to/your/site/original_form.php?error=1');
   }
?> 
```

表格页面：

```
<?php 
   if (isset($_GET['error']) {
      echo "there was an error! Please fix it!";
   }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:09:59.237

尝试以下 -

```
if (validation_failed) {
    header("Location: http://yourserver.com/signup.php");
} else {
    header("Location: http://yourserver.com/welcome.php");
} 
```

[PHP 标头函数](http://php.net/manual/en/function.header.php)

# java - 是否可以将字符串编译为代码？

> ID：11925497
> 
> 赞同：3
> 
> 时间：2012-08-12T20:05:49.900
> 
> 标签：java, android, compilation

我有一个获取 html 文件内容的应用程序。

假设页面的文本是：

```
String[] arr = new String[] {"!","@","#"};
for (String str :  arr) {
write(str);
} 
```

我可以以某种方式编译此文本并在我的应用程序中运行代码吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T20:28:36.467

使用[贾尼诺](http://docs.codehaus.org/display/JANINO/Home)。它是一个 java 运行时内存编译器。比BCEL之类的要容易得多。

从主页：

“什么是贾尼诺？

> Janino 是一个超小、超快的 Java™ 编译器。它不仅可以像 JAVAC 工具一样将一组源文件编译成一组类文件，还可以*在内存中编译一个 Java™ 表达式、块、类体或源文件，加载字节码并直接在相同的JVM。*Janino 并非旨在成为开发工具，而是用于运行时编译目的的嵌入式编译器......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:34:32.717

由于问题已标记`android`：

到目前为止发布的答案仅适用于“标准”JVM，不适用于 Android 的 Dalvik VM。原则上，在 Android 上也可以。我不知道是否有可以嵌入的现有 Java 编译器，但您可能会使用[dexmaker](http://code.google.com/p/dexmaker/)生成最终的 Dalvik 字节码。可以将现有的 Java 编译器与 dexmaker 结合使用。

但是在尝试这样的事情之前请三思而后行，并且要非常小心。**您想要的最后一件事是攻击者在您的用户硬件上执行任意代码的方法。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T20:13:00.310

您可以使用`javac`编译器、Java Compiler API 或 BeanShell 库（或类似库）。您可以通过多种方式编译它，没有一种非常简单，这通常会导致寻找另一种方法来解决您的问题。

而不是生成源代码并编译其通用以直接使用 ASM、Javaassist、BCEL 等生成字节码

* * *

这似乎与

```
for(char ch: "!@#".toCharArray())
    write(ch); 
```

这可能与

```
write("!@#"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T20:20:56.970

您可以尝试[javassist](http://www.jboss.org/javassist/)，但它不是完整的 Java。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-12T20:22:32.717

这通常并不难做到，但我不得不问您能否详细说明您正在尝试完成的工作。我一直在做这种类型的事情。这只是从用户那里获取信息并在代码的其他地方使用它的另一个示例。由于您使用 java 可能会查看字符串 API [http://docs.oracle.com/javase/6/docs/api/java/lang/String.html](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)和字符串标记器[http://docs.oracle.com/javase /6/docs/api/index.html?java/lang/package-summary.html](http://docs.oracle.com/javase/6/docs/api/index.html?java/lang/package-summary.html)

现在，您可以一次将字符串分解为一个单词或其他值的单个值。从那里，您可以使用 float 或 double 类中的 isNAN() 等函数来确定它是数字还是字符串，还是您要测试的任何内容。现在您知道您正在处理什么，您可以以可用的形式重建数据。

如果要将值用作值，请注意值，请使用 Float(string value) 构造函数。即 Float x = new Float(myString)

# ruby-on-rails - rails项目安装后如何处理rails应用程序的本地数据库和错误

> ID：11925500
> 
> 赞同：1
> 
> 时间：2012-08-12T20:06:41.167
> 
> 标签：ruby-on-rails, postgresql

所以我开始学习rails，有php和前端背景。我创建了一个新的 rails 项目并且进展顺利，直到我从 github 下载了另一个 rails 应用程序并安装了所有依赖项和 gems ......无论如何，这些问题在过去两天里一直在解决......我真的很感激澄清。

与实时版本的外部数据库相比，您如何管理开发版本的本地数据库？

例如，从 Github 导入应用程序后，Rails 会自动构建本地数据库吗？还是必须手动创建一个，它也应该具有与下载的用于与其数据库对话的相同身份验证凭据？

此外，在我下载了 PostgreSQL 及其 gem 之后，我无法再为我的旧 rails 项目或我的新项目启动 rails 服务器，两者都会出现以下错误：

gems/actionpack-3.0.16/lib/action_dispatch/http/mime_type.rb:98：警告：已初始化常量 PDF gems/activerecord-3.0.16/lib/active_record/connection_adapters/postgresql_adapter.rb:950:in `initialize' ：致命：角色“postgres”不存在（PGError）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:36:55.757

由于您使用的是 postgresql（可能由多个应用程序共享），并且在我的理解中，两个 rails 应用程序通常不共享数据库以外的命名空间，我猜您没有修改`config/database.yml`文件。

按照约定，默认的开发数据库名称是`development`，所以，如果你没有接触配置文件，两个应用程序共享相同的数据库选项，导致冲突。

我通常在创建新应用程序后将数据库名称修改为`development_SomeApplicationName`（替换`SomeApplicationName`为一些有意义的应用程序名称以区分数据库名称）。

# codeigniter - Codeigniter：jquery 没有将其“负载”值传递给控制器

> ID：11925508
> 
> 赞同：0
> 
> 时间：2012-08-12T20:07:58.597
> 
> 标签：codeigniter

问题是我在标题中所说的。在第一个下拉框中选择的索引的参数不会发送到控制器。因此控制器不能将任何值传递给模型等。如果我硬编码说 $pais_id = 1 并将其发送到它可以工作的模型，那么这意味着问题在于控制器没有从 jquery 中获取它。看法

```
<script type="text/javascript">
//jquery code for source list
$(document).ready(function(){
$('#country').change(function() {
  if ($(this).val()!='') {
    $("#source").load("/CI-3/controllers/control_form.php",{pais_id: $(this).val()});
      }

    });

});  // end of country and city function
</script> 
```

问题一定存在，因为我没有将过程可视化：Jquery 检测到选择下拉列表中的更改并获取选定的 id。好吧，但接下来会发生什么？它将它发送给控制器，是的，并且？控制器将其转发给模型，模型执行 sql 搜索并将数组返回给控制器，然后控制器将其转发给视图，但是，上面那行中的#source 是如何受到影响的呢？所以它不会修改自己

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:18:41.810

```
$source['source'] = $this->model_form->get_source($pais_id); 
```

应该

```
$data['source'] = $this->model_form->get_source($pais_id); 
```

在控制器中。视图中的第三个参数是它是否被返回或回显。所有值都作为数组传递到第二个参数中。

# css - jquery将背景颜色更改为十六进制值

> ID：11925518
> 
> 赞同：0
> 
> 时间：2012-08-12T20:09:23.013
> 
> 标签：css, jquery, background-color

我有一个表格，其单元格 ID 为“quest_row1”、“quest_row2”等。我想将单元格的背景颜色更改为通过 AJAX 调用服务器返回的十六进制值。

```
picked_answer = $(this).val();
    x = parseInt($("input#q_num").val());
    $.post("CCRN/submit_answer.php", {num : x, answer:picked_answer}, function(data) 
        {
            alert(data+x);
            $("#quest_row" + x).css({'background-color' : '#' + data});
        }); 
```

x 得到正确的值，比如 10。从 AJAX 调用返回的数据是正确的，比如 AABBCC。颜色没有改变，但我没有收到任何错误。当警报框显示数据和 x 的正确值时，此代码会运行。请帮助确定我的问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:55:53.730

首先检查是否通过 firebug 或任何控制台将 css 样式添加到元素中。在萤火虫中，当您检查它时，它应该显示为 element.style{...}

也可能是您将其添加到 tr 可能无法正常工作，因为我知道样式表并不总是按预期工作。尝试将样式添加到 td 中，看看是否有帮助。

# javascript - jQuery UI 对话框 - X 秒后关闭

> ID：11925520
> 
> 赞同：4
> 
> 时间：2012-08-12T20:09:58.553
> 
> 标签：javascript, jquery, jquery-ui, settimeout

这段代码完美运行，除了 - 对话窗口不会像我预期的那样在 X 毫秒后关闭......

`setTimeout`函数被执行（我把 alert() 放在那里并且它工作了......），所以我认为问题出在`$("#alert div").dialog('close');`但我不知道出了什么问题......

```
if ($("#alert").length) {
    var title;
    if ($("#alert span").length) {
        title = $("#alert span").text();
    }
    $("#alert div").dialog({
        title: title,
        modal: true,
        open: function() {
            setTimeout(function() {
                $("#alert div").dialog('close');
            }, 2000);
        }
    });
} 
```

编辑：如果有帮助，这里是 HTML：

```
<div id="alert">
    <span>Password change</span>
    <div>Password was successfully changed.</div>
</div> 
```

**解决！**如果有人知道为什么我的代码不起作用，那就太好了...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-12T20:22:11.133

你有一个范围问题。试试这个**[jsFiddle 示例](http://jsfiddle.net/j08691/246LG/)**：

```
if ($("#alert").length) {
    var title;
    if ($("#alert span").length) {
        title = $("#alert span").text();
    }
    $("#alert div").dialog({
        title: title,
        modal: true,
        open: function() {
            var foo = $(this);
            setTimeout(function() {
               foo.dialog('close');
            }, 2000);
        }
    });
}​ 
```

发生这种情况并且没有像您预期的那样工作的原因是您引用成为对话框的目标 div 的方式以及 jQuery UI 构建对话框的方式。如果您查看开发人员控制台，您会看到 jQuery 将您的 div 拉出它在 DOM 中的原始位置，因此不再可以被引用，`#alert div`因为它不再是`#alert`. 如果您为该 div 提供了自己的 ID，它将按预期工作，并且您不需要临时变量来引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:26:17.463

**经过测试和工作的现场演示：**

[http://jsfiddle.net/oscarj24/q6tD9/2/](http://jsfiddle.net/oscarj24/q6tD9/2/)

我认为这种方式更好：

```
jQuery.fn.exists = function(){return this.length>0;}

$(function() {
    if($('#alert').exists()){
        var modal = $('#alert div');
        modal.dialog({ title: $('#alert span').text(), modal: true });
        var opened = modal.dialog('isOpen');
        if(opened){
            setTimeout(function(){ 
               modal.dialog('close'); 
            }, 2000);
        }
    }
});​ 
```

# jquery - 通过 ajax 附加项目时，listview 不会继承样式。- Jquery mobile

> ID：11925522
> 
> 赞同：0
> 
> 时间：2012-08-12T20:09:58.780
> 
> 标签：jquery, html, ajax, mobile

我正在尝试通过 ajax 将项目动态添加到 jquery mobile 中的列表视图中。

当我返回数据并附加生成的 html 时，新项目不会继承 listview 样式属性，任何帮助将不胜感激。

```
$(function() {
    $('.load_more').live("click",function() {
        var a_id = $(this).attr("id");
        var b_id = $(this).attr("data");
    if(a_id!='end'){
        $.ajax({
            type: "POST",
            url: "data.php",
            data: "aid="+ a_id+"&bid="+b_id,
    beforeSend:  function() {
        $('a.load_more').html('<img src="loading.gif" />');

},
    success: function(html){
        $("#more").remove();
        $("ul#updates").append(html);
        $('ul#updates').listview('refresh');
        }
    });
}
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T19:11:54.330

我在进行 AJAX 调用时遇到了类似的问题，并且对 listview() 或 trigger() 函数没有运气。当内容不是动态时，这些对我有用，就像 Derek 的回复中的 jsfiddle 一样。我发现的是，如果您使用的是 google ajax API（[http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js) - 或 1.7.1 或某些变体) 然后 listview() 函数在样式方面停止工作。当将此脚本添加到具有静态内容的 jsfiddle 时，新项目不会继承样式。如果您的页面在没有此脚本的情况下也可以工作，则将其删除将是一个临时修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:16:30.057

jQuery Mobile 不会自动增强动态内容。您必须触发`create`事件以强制 jQM 初始化新内容：

```
$(html).trigger('create'); 
```

对于列表视图，`refresh`添加新项目时应该足够了。请参阅此示例[http://jsfiddle.net/qrYF7/](http://jsfiddle.net/qrYF7/)。

[http://jquerymobile.com/demos/1.1.1/docs/pages/page-scripting.html](http://jquerymobile.com/demos/1.1.1/docs/pages/page-scripting.html)

类似的问题：

[强制 jQuery Mobile 重新评估动态插入内容的样式/主题](https://stackoverflow.com/questions/6297470/forcing-jquery-mobile-to-re-evaluate-styles-theme-on-dynamically-inserted-conten)

[jQuery Mobile 在动态添加内容后不应用样式](https://stackoverflow.com/questions/7999436/jquery-mobile-does-not-apply-styles-after-dynamically-adding-content)

# php - cakephp 数据源调用未定义的方法

> ID：11925523
> 
> 赞同：1
> 
> 时间：2012-08-12T20:10:03.063
> 
> 标签：php, cakephp

我创建了一个简单的`datasource`：

```
// app/Model/Datasource/FeedSource.php

App::uses('DataSource', 'Model/Datasource');

class FeedSource extends DataSource {
    public function abcd() {
        echo 'Hello World!';
    }
} 
```

在我的`database.php`：

```
public $feed = array(
    'datasource' => 'FeedSource'
); 
```

在`Feeda`模型中：

```
class Feeda extends AppModel {
    public $useTable = false;
    public $useDbConfig = 'feed';
} 
```

在`list`控制器中：

```
$this->loadModel('Feeda');
$this->Feeda->abcd(); 
```

但是，它返回一个致命错误：

```
Error: Call to undefined method FeedSource::query() 
```

如何解决？

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T01:28:55.393

也许你的意思是`DboSource`而不是`DataSource`.

DataSource 没有方法查询，DboSource 有。将您的代码更新为如下所示：

```
App::uses('DboSource', 'Model/Datasource');
class FeedSource extends DboSource {} 
```

编辑：看起来这不是问题。在`Model`里面有一个神奇的 __call 方法，它调用 `$this->getDataSource()->query($method, $params, $this);` [Source](http://api.cakephp.org/2.3/class-DboSource.html)你需要自己实现它。

```
class FeedSource extends DataSource {
    public function abcd() {
        echo 'Hello World!';
    }

    public function query($method, $params, $Model) {
        // you may customize this to your needs.
        if (method_exists($this, $method)) {
            return call_user_func_array(array($this, $method), $params);
        }
    }
} 
```

# python - XAMPP - 在网页上执行 Python 脚本

> ID：11925529
> 
> 赞同：3
> 
> 时间：2012-08-12T20:11:06.057
> 
> 标签：python, web-services, xampp, webpage

如何在网页上执行 Python 脚本？

我使用[XAMPP](http://en.wikipedia.org/wiki/XAMPP)创建了 Apache 服务器。是否有关于如何执行 .py 脚本的教程/示例或指南？我正在使用 Windows 7 并在我的本地计算机上安装了 Python。如果我通过 Web 链接访问 .py 脚本，它看起来好像它的 HTML 代码并且没有执行任何操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:21:09.973

通常，您不会在浏览器中执行[Python 。](http://en.wikipedia.org/wiki/Python_%28programming_language%29)相反，浏览器`http://example.com/mypage`通过从服务器请求资源来访问资源（或“网页”，如 ）。服务器（例如，Apache）在正确管理时会将请求的处理传递给某些 Python 脚本。然后，您的 Python 脚本会创建一些输出（例如 HTML），然后服务器会将这些输出返回到浏览器以供浏览器显示。

但是，一些网站发现在浏览器中运行逻辑（脚本）而不是在服务器上运行很有用。执行此操作的标准方法是使用 JavaScript（尽管过去在浏览器中内置了其他语言，例如[Internet Explorer 中的 VBScript](https://en.wikipedia.org/wiki/VBScript)）。

现在，几乎所有的浏览器都选择 JavaScript 作为浏览器中的脚本语言。为了让您在浏览器中使用任何其他语言（包括 Python），浏览器必须支持该脚本语言（或需要有一个插件来支持该脚本语言）。仅仅在浏览器旁边安装 Python 是不够的。有关详细信息，请参阅 Python 文档*[Web Browser Programming](http://wiki.python.org/moin/WebBrowserProgramming)*。

另一种选择是使用类似[Pyjs](http://pyjs.org/)的东西。这是一个库，您可以使用 Python 编写代码，并将必要的部分转换为 JavaScript。这不完全是“浏览器中的 Python”，但它可能是您正在寻找的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-01T15:08:57.307

我想这个链接会有所帮助.... [https://community.apachefriends.org/f/viewtopic.php?t=42975](https://community.apachefriends.org/f/viewtopic.php?t=42975)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-12T20:13:42.267

[通常Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)的一个很好的资源是[官方文档](http://docs.python.org/howto/webservers.html)。

他们很好地解释了 Python 的许多方面。在 Web 上使用 Python 是很重要的一部分，并且它们有很好的概述。

# php - Paypal IPN 未返回已验证

> ID：11925530
> 
> 赞同：0
> 
> 时间：2012-08-12T20:11:10.847
> 
> 标签：php, paypal, paypal-ipn, paypal-sandbox

我正在尝试从 PayPal 获取 IPN 来工作，但它不断返回`INVALID`而不是`VERIFIED`我看不出我做错了什么。

目前，我有 2 个使用来自 paypal 开发者网站的示例代码的 php 文件。代码似乎运行良好，我正在使用，`sandbox`所以我可以看到正在转移的付款，所以我不明白为什么我会得到`INVALID`.

有人可以看看代码，因为我看不到我做错了什么。

**1\. basic_payment.php（发送支付数据到paypal的文件）**

> ```
> <?php
>   require_once ("paypalplatform.php");
> 
>   $actionType = "PAY";
>   $cancelUrl = "http://[my server details go here]/cancel.php";
>   $returnUrl = "http://[my server details go here]/success.php";  
>   $currencyCode = "GBP";
>   $receiverEmailArray = array( 'seller_15456764326_biz@mail.com' );
>   $receiverAmountArray = array( '2' );
>   $receiverPrimaryArray = array();
>   $senderEmail = "";      
>   $feesPayer = "";
>   $ipnNotificationUrl = "http://[my server details go here]/ipn.php";
>   $memo = "";     
>   $pin = "";      
>   $preapprovalKey = "";       
>   $reverseAllParallelPaymentsOnError = "";        
>   $trackingId = generateTrackingID(); 
>   $receiverInvoiceIdArray = array( $trackingId );
>   $resArray = CallPay ($actionType, $cancelUrl, $returnUrl, $currencyCode, $receiverEmailArray,
>                           $receiverAmountArray, $receiverPrimaryArray, $receiverInvoiceIdArray,
>                           $feesPayer, $ipnNotificationUrl, $memo, $pin, $preapprovalKey,
>                           $reverseAllParallelPaymentsOnError, $senderEmail, $trackingId
>   );
>   $ack = strtoupper($resArray["responseEnvelope.ack"]);
>   if($ack=="SUCCESS")
>   {
>       if ("" == $preapprovalKey)
>       {
>           $cmd = "cmd=_ap-payment&paykey=" . urldecode($resArray["payKey"]);
>           RedirectToPayPal ( $cmd );
>       }
>       else
>       {
>           $payKey = urldecode($resArray["payKey"]);
>           $paymentExecStatus = urldecode($resArray["paymentExecStatus"]);
>       }
>   } 
> ?> 
> ```

**2\. ipn.php（监听paypals响应的文件）**

> ```
> <?php
> 
>     $ipn_post_data = $_POST;
> 
>     $url = 'https://www.sandbox.paypal.com/cgi-bin/webscr';
> 
>     $request = curl_init();
>     curl_setopt_array($request, array
>     (
>         CURLOPT_URL => $url,
>         CURLOPT_POST => TRUE,
>         CURLOPT_POSTFIELDS => http_build_query(array('cmd' => '_notify-validate') + $ipn_post_data),
>         CURLOPT_RETURNTRANSFER => TRUE,
>         CURLOPT_HEADER => FALSE,
>     ));
> 
>     $response = curl_exec($request);
>     $status   = curl_getinfo($request, CURLINFO_HTTP_CODE);
> 
>     curl_close($request);
> 
>     $to = "oshirowanen@mail.com";
>     $from = "me@desktop.com";
>     $subject = "response";
>     $message = "<pre>".print_r($status,true)." - ".print_r($response,true)."</pre>\n";
> 
>     $header = 'To: Oshirowanen <oshirowanen@mail.com>' . "\r\n";
>     $header .= 'From: Me <me@desktop.com>' . "\r\n";
> 
>     mail($to,$subject,$message,$header);
> 
> ?> 
> ```

**错误消息：**

Apache 错误日志 - 没有错误

这就是为什么我在 ipn.php 中添加电子邮件内容以尝试捕获某些内容，并且它正在返回：

`<pre>200 - INVALID</pre>`

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T09:48:07.250

1.  [使用基本示例代码](https://www.paypal-labs.com/integrationwizard/adaptive/paymenttypes.php)4b让它工作，

2.  从基本示例代码中清除`$ipnNotificationUrl = "";`，因为我有一个我自己添加的值，

3.  在沙盒中创建了卖家账户而不是商业专业账户，

4.  设置卖家账号启用ipn url，

5.  将以下 PHP 5.2[示例代码](https://www.x.com/developers/PayPal/documentation-tools/code-sample/216623)用于 ipn 侦听器

6.  将 2 行添加到侦听器中，如此处所述，[这](http://www.geekality.net/2011/05/28/php-tutorial-paypal-instant-payment-notification-ipn/)2 行如下所示：

7.  [从这里](http://curl.haxx.se/docs/caextract.html)`cacert.pem`将证书下载到我的服务器并将其放在与 ipn 侦听器相同的目录中：

第 6 点中提到的 2 行：

```
CURLOPT_SSL_VERIFYPEER => TRUE,
CURLOPT_CAINFO => 'cacert.pem', 
```

我不知道为什么沙盒商业专业帐户不允许我设置 ipn url，但卖家帐户可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T16:09:31.610

起初这也给我带来了困惑。您在谈论的是两种不同类型的`IPTN`消息：

1.  第一个，来自您的问题，它的 url 在 ipnNotificationUrl 中配置，转到中间交易的站点。无法通过将参数发送回 Paypal 来验证这一点；由于您可以自己将参数添加到该 url，因此您可以实现一种`HMAC`安全机制。

2.  `IPTN`第二个，来自您的解决方案，如果在设置中启用，则转到接收资金的帐户。可以通过将参数发送回 Paypal 来验证这一点。

如果您为两条消息设置相同的 URL，您将同时获得它们，但只能使用 Paypal 验证一条。如果卖家和网站是不同的实体，换句话说，如果网站只是在买家和卖家之间进行交易，那么网站会收到第一个交易，而卖家会收到第二个交易。

# java - 使用数据访问对象在java中读取文本文件

> ID：11925531
> 
> 赞同：0
> 
> 时间：2012-08-12T20:11:36.230
> 
> 标签：java, dao

昨天我的教授给我们讲了一些他没能教好的课。虽然我在php方面有很好的背景，但是在java方面有点不同，尤其是设计模式。他在喋喋不休地谈论 mvc，我认为这与 php 的 mvc 设计模式不同。

这是问题所在，他在屏幕上发布了一些代码，其中包括 3 个文件

1.  `data-access-object`使用执行以下操作的方法（根据我的理解）：

    *   返回一个具有 3 个值的对象`accountNumber`, `pinCode`,`balance`
2.  `model?`具有`setters`和`getters`在其上获取或设置 accountNumber、pinCode 和 balance

3.  最后是包含主类的测试，这是我们运行代码的地方。

我只是想了解或查看使用 DAO 访问 textFile 的自动柜员机的更好示例

或者也许有人可以发布他/她的流程图，因为我自己真的不明白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:20:59.107

> 他在喋喋不休地谈论 mvc，我认为这与 php 的 mvc 设计模式不同。

设计模式与您使用的语言无关。

> 具有执行以下操作的方法的数据访问对象（根据我的理解）：
> 
> 1.  返回一个具有 3 个值 accountNumber、pinCode、balance 的对象
>     
>     
> 2.  模型？上面有 setter 和 getter 获取或设置 accountNumber、pinCode 和 balance
>     
>     
> 3.  最后是包含主类的测试，这是我们运行代码的地方。

你应该从你的模型拳头开始；你只需要一个豆子

```
 public class Account {
        private String accountNumber;
        private int pinCode;
        private long balance;   

        //constructors, setters and getters
    } 
```

然后，您需要创建应该如下所示的 DAO 类：

```
public interface AccountDAO {
    public Account getAccount(String accountNumber);
    //and other methods
    public List<Account> getAllAccounts(); //this is not suitable for a real bank app
    public void writeAccount(Account account);
    public void deleteAccount(Account account);
    public void updateAccount(Account oldAccount, Account newAccount);
} 
```

有了这个接口，你就可以实现特定的 AccountDAO，比如 FileAccountDAO、XmlAccountDAO、DatabaseAccountDAO。

# regex - 我们应该考虑使用 range [az] 作为一个错误吗？

> ID：11925537
> 
> 赞同：23
> 
> 时间：2012-08-12T20:12:23.617
> 
> 标签：regex, perl, unicode, locale, pcre

在我的语言环境（et_EE）`[a-z]`中意味着：

```
abcdefghijklmnopqrsšz 
```

因此，不包括 6 个 ASCII 字符 ( `tuvwxy`) 和一个来自爱沙尼亚字母 ( `ž`) 的字符。我看到很多模块仍在使用正则表达式，例如

```
/\A[0-9A-Z_a-z]+\z/ 
```

对我来说，定义 ASCII 字母数字字符范围的方法似乎是错误的，我认为应该将其替换为：

```
/\A\p{PosixAlnum}+\z/ 
```

第一个仍然被认为是惯用的方式吗？或接受的解决方案？还是一个错误？

或者最后一个有一些警告？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T02:03:09.340

回到旧的 Perl 3.0 时代，一切都是 ASCII，Perl 反映了这一点。`\w`与 的意思相同`[0-9A-Z_a-z]`。而且，我们喜欢它！

但是，Perl 不再绑定到 ASCII。我`[a-z]`不久前就停止使用了，因为当我编写的程序不适用于非英语的语言时，我被大喊大叫。你一定想象过我作为一个美国人会惊讶地发现这个世界**上至少**有几千人不会说英语。

Perl 有更好的处理方式`[0-9A-Z_a-z]`。您可以使用`[[:alnum:]]`set 或简单地使用`\w`which 应该做正确的事情。如果您只能使用小写字符，则可以使用`[[:lower:]]`代替`[a-z]`（假定为英语类型的语言）。（Perl 竭尽全力让 [az] 仅表示 26 个字符 a、b、c、...z，即使在 EBCDIC 平台上也是如此。）

如果您只需要指定 ASCII，您可以添加`/a`限定符。如果您的意思是特定于语言环境，则应在“使用语言环境”的词法范围内编译正则表达式。（避免使用 /l 修饰符，因为它只适用于正则表达式模式，而不适用于其他。例如在 's/[[:lower:]]/\U$&/lg' 中，模式是使用语言环境编译的，但是 \U 不是。这可能应该被认为是 Perl 中的一个错误，但它是当前工作的方式。/l 修饰符实际上仅用于内部簿记，不应直接输入。）实际上，最好在输入到程序时翻译您的语言环境数据，然后在输出时将其翻译回，同时在内部使用 Unicode。如果您的语言环境是新式 UTF-8 语言环境之一，则 5.16 中的一个新功能 'use locale ":not_characters"'

```
$word =~ /^[[:alnum:]]+$/   # $word contains only Posix alphanumeric characters.
$word =~ /^[[:alnum:]]+$/a  # $word contains only ASCII alphanumeric characters.
{ use locale;
  $word =~ /^[[:alnum:]]+$/;# $word contains only alphanum characters for your locale
} 
```

现在，这是一个错误吗？如果程序没有按预期工作，那是一个简单明了的错误。如果你真的想要 ASCII 序列，`[a-z]`那么程序员应该使用`[[:lower:]]`限定符`/a`。如果您想要所有可能的小写字符，包括其他语言中的小写字符，您应该简单地使用`[[:lower:]]`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-05-28T15:08:39.150

由于这个问题超出了 Perl，我很想知道它是如何进行的。在支持本机正则表达式的流行编程语言 Perl、PHP、Python、Ruby、Java 和 Javascript 上对此进行测试，得出的结论是：

*   `[a-z]`将始终匹配每种语言中的[ASCII-7 az 范围，并且区域设置不会以任何方式影响它。](http://www.neurophys.wisc.edu/comp/docs/ascii/ascii-printable.html)字符喜欢`ž`并且`š`从不匹配。
*   `\w`可能匹配也可能不匹配字符`ž`and `š`，具体取决于创建正则表达式时给出的编程语言和参数。对于这个表达式，多样性是最大的，因为在某些语言中它们永远不会匹配，与选项无关，在其他语言中它们总是匹配，而在某些语言中则取决于。
*   POSIX`[[:alpha:]]`和 Unicode`\p{Alpha}`和`\p{L}`，如果相关编程语言的正则表达式系统支持它们并且使用了适当的配置，则将匹配像`ž`和之类的字符`š`。

请注意，“适当的配置”不需要更改语言环境：更改语言环境对任何测试系统的结果都没有影响。

为了安全起见，我还测试了命令行 Perl、grep 和 awk。从那里开始，命令行 Perl 的行为与上述相同。但是，我所使用的 grep 和 awk 版本似乎与其他版本的行为不同，对于他们来说，语言环境也很重要`[a-z]`。行为是特定于版本和实现的，这些工具的最新版本不会表现出相同的行为。

在那种情况下——grep、awk 或类似的命令行工具——我同意使用`a-z`没有语言环境定义的范围可能被认为是一个错误，因为你真的不知道你最终会得到什么。

* * *

如果我们查看每种语言的更多详细信息，则状态似乎是：

**爪哇**

在java中，如果没有指定unicode`\p{Alpha}`类`[a-z]`，如果是unicode字母字符，则匹配`ž`。`\w`将匹配字符，例如`ž`是否存在 unicode 标志，如果不存在则不匹配，并且`\p{L}`无论 unicode 标志如何都将匹配。没有区域感知正则表达式或对`[[alpha]]`.

**PHP**

在 PHP`\w`中，如果存在 unicode 开关`[[:alpha:]]`，`\p{L}`将匹配字符，`ž`如果不存在则不匹配。`\p{Alpha}`不支持。语言环境对正则表达式没有影响。

**Python**

`\w`如果存在 unicode 标志并且不存在语言环境标志，则将匹配提到的字符。对于 unicode 字符串，如果使用 Python 3，则默认假定 unicode 标志，但不使用 Python 2。Python不支持Unicode`\p{Alpha}`或`\p{L}`POSIX 。`[[:alpha:]]`

使用特定于语言环境的正则表达式的修饰符显然[仅适用于每个字符 1 个字节的字符集](https://lists.gt.net/python/python/850772)，因此无法用于 unicode。

**Perl**

`\w`除了匹配之外，还匹配前面提到的字符`[a-z]`。支持 Unicode`\p{Letter}`和`\p{Alpha}`POSIX`[[:alpha:]]`并按预期工作。正则表达式的 Unicode 和语言环境标志没有改变结果，也没有改变语言环境或`use locale;`/ `no locale;`。

如果我们使用命令行 Perl 运行测试，行为不会改变。

**红宝石**

`[a-z]`并`\w`仅检测字符`[a-z]`，与选项无关。支持 Unicode`\p{Letter}`和`\p{Alpha}`POSIX`[[:alpha:]]`并按预期工作。语言环境没有影响。

**Javascript**

`[a-z]`并且`\w`总是只检测字符`[a-z]`。ECMA2015 中有对`/u`unicode 切换的支持，目前主流浏览器大多支持，但`[[:alpha:]]`不`\p{Alpha}`带来`\p{L}`对`\w`. unicode 开关确实添加[了将 unicode 字符视为一个字符的处理](http://es6-features.org/#UnicodeStringRegExpLiteral)，这在之前一直是个问题。

客户端 javascript 和 Node.js 的情况相同。

**AWK**

[对于 AWK，在文章A.8 Regexp Ranges and Locales: A Long Sad Story](https://www.gnu.org/software/gawk/manual/html_node/Ranges-and-Locales.html)中发布了对状态的更长描述。它详细说明了在旧的 unix 工具世界中，`[a-z]`检测小写字母的正确方法是当时的工具的工作原理。但是，1992 年 POSIX 引入了语言环境，并更改了字符类的解释，以便按照排序顺序定义字符顺序，并将其绑定到语言环境。这也被当时的 AWK（3.x 系列）采用，这导致了几个问题。开发 4.x 系列时，POSIX 2008 已将顺序定义为未定义，维护者恢复为原始行为。

现在大多使用 AWK 的 4.x 版本。使用时，`[a-z]`匹配 az 忽略任何语言环境更改，`\w`并且`[[:alpha:]]`将匹配特定于语言环境的字符。不支持 Unicode \p{Alpha} 和 \p{L}。

**grep**

Grep（以及 sed、ed）使用 GNU 基本正则表达式，这是一种古老的风格。它不支持 unicode 字符类。

至少 gnu grep 2.16 和 2.25 似乎遵循 1992 posix，因为该语言环境对于`[a-z]`, 以及 for`\w`和也很重要`[[:alpha:]]`。这意味着例如，如果使用爱沙尼亚语言环境，[az] 仅匹配集合 xuzvöä 中的 z。此行为不会影响旧版本或新版本的 gnu grep，但我不确定哪些版本完全改变了行为。

* * *

下面列出的每种语言使用的测试代码。

**Java** (1.8.0_131)

```
import java.util.regex.*;
import java.util.Locale;

public class RegExpTest {
    public static void main(String args[]) {
        verify("v", 118);
        verify("š", 353);
        verify("ž", 382);

        tryWith("v");
        tryWith("š");
        tryWith("ž");
    }
    static void tryWith(String input) {
        matchWith("[a-z]", input);
        matchWith("\\w", input);
        matchWith("\\p{Alpha}", input);
        matchWith("\\p{L}", input);
        matchWith("[[:alpha:]]", input);
    }

    static void matchWith(String pattern, String input) {
        printResult(Pattern.compile(pattern), input);
        printResult(Pattern.compile(pattern, Pattern.UNICODE_CHARACTER_CLASS), input);
    }
    static void printResult(Pattern pattern, String input) {
        System.out.printf("%s\t%03d\t%5s\t%-10s\t%-10s\t%-5s%n",
          input, input.codePointAt(0), Locale.getDefault(),
          specialFlag(pattern.flags()),
          pattern, pattern.matcher(input).matches());
    }
    static String specialFlag(int flags) {
      if ((flags & Pattern.UNICODE_CHARACTER_CLASS) == Pattern.UNICODE_CHARACTER_CLASS) {
          return "UNICODE_FLAG";
      }
      return "";
    }
    static void verify(String str, int code) {
        if (str.codePointAt(0) != code) {
            throw new RuntimeException("your editor is not properly configured for this character: " + str);
        }
    }
} 
```

**PHP** (7.1.5)

```
<?php
/*
PHP, even with 7, only has binary strings that can be operated with unicode-aware
functions, if needed. So functions operating them need to be told which charset to use.

When there is encoding assumed and not specified, PHP defaults to ISO-8859-1.
*/

// PHP7 and extension=php_intl.dll enabled in PHP.ini is needed for IntlChar class
function codepoint($char) {
  return IntlChar::ord($char);
}

function verify($inputp, $code) {
  if (codepoint($inputp) != $code) {
    throw new Exception(sprintf('Your editor is not configured correctly for %s (result %s, should be %s)',
      $inputp, codepoint($inputp), $code));
  }
}

$rowindex = 0;
$origlocale = getlocale();

verify('v', 118);
verify('š', 353); // https://en.wikipedia.org/wiki/%C5%A0#Computing_code
verify('ž', 382); // https://en.wikipedia.org/wiki/%C5%BD#Computing_code

function tryWith($input) {
  matchWith('[a-z]', $input);
  matchWith('\\w', $input);
  matchWith('[[:alpha:]]', $input); // POSIX, http://www.regular-expressions.info/posixbrackets.html
  matchWith('\p{L}', $input);
}
function matchWith($pattern, $input) {
  global $origlocale;
  selectLocale($origlocale);
  printResult("/^$pattern\$/", $input);
  printResult("/^$pattern\$/u", $input);
  selectLocale('C'); # default (root) locale
  printResult("/^$pattern\$/", $input);
  printResult("/^$pattern\$/u", $input);
  selectLocale(['et_EE', 'et_EE.UTF-8', 'Estonian_Estonia.1257']);
  printResult("/^$pattern\$/", $input);
  printResult("/^$pattern\$/u", $input);
  selectLocale($origlocale);
}
function selectLocale($locale) {
  if (!is_array($locale)) {
    $locale = [$locale];
  }
  // On Windows, no UTF-8 locale can be set
  // https://stackoverflow.com/a/16120506/365237
  // https://msdn.microsoft.com/en-us/library/x99tb11d.aspx
  // Available Windows locales
  // https://docs.moodle.org/dev/Table_of_locales
  $retval = setlocale(LC_ALL, $locale);
  //printf("setting locale %s, retval was %s\n", join(',', $locale), $retval);
  if ($retval === false || $retval === null) {
    throw new Exception(sprintf('Setting locale %s failed', join(',', $locale)));
  }
}
function getlocale() {
  return setlocale(LC_ALL, 0);
}
function printResult($pattern, $input) {
  global $rowindex;
  printf("%2d: %s\t%03d\t%-20s\t%-25s\t%-10s\t%-5s\n",
        $rowindex, $input, codepoint($input), getlocale(),
        specialFlag($pattern), 
        $pattern, (preg_match($pattern, $input) === 1)?'true':'false');
  $rowindex = $rowindex + 1;
}
function specialFlag($pattern) {
  $arr = explode('/',$pattern);
  $lastelem = array_pop($arr);
  if (strpos($lastelem, 'u') !== false) {
    return 'UNICODE';
  }
  return '';
}

tryWith('v');
tryWith('š');
tryWith('ž'); 
```

**蟒蛇**（3.5.3）

```
# -*- coding: utf-8 -*-

# with python, there are two strings: unicode strings and regular ones.
# when you use unicode strings, regular expressions also take advantage of it,
# so no need to tell that separately. However, if you want to be using specific
# locale, that you need to tell.

# Note that python3 regexps defaults to unicode mode if unicode regexp string is used,
# python2 does not. Also strings are unicode strings in python3 by default.

# summary: [a-z] is always [a-z], \w will match if unicode flag is present and
# locale flag is not present, no unicode \p{Letter} or POSIX :alpha: exists.
# Letters outside ascii-7 never match \w if locale-specific
# regexp is used, as it only supports charsets with one byte per character
# (https://lists.gt.net/python/python/850772).

# Note that in addition to standard https://docs.python.org/3/library/re.html, more
# complete https://pypi.python.org/pypi/regex/ third-party regexp library exists.

import re, locale

def verify(inputp, code):
  if (ord(inputp[0]) != code):
    raise Exception('Your editor is not configured correctly for %s (result %s)' % (inputp, ord(inputp[0])))
  return

rowindex = 0
origlocale = locale.getlocale(locale.LC_ALL)  

verify(u'v', 118)
verify(u'š', 353)
verify(u'ž', 382)

def tryWith(input):
  matchWith(u'[a-z]', input)
  matchWith(u'\\w', input)

def matchWith(pattern, input):
  global origlocale
  locale.setlocale(locale.LC_ALL, origlocale)
  printResult(re.compile(pattern), input)
  printResult(re.compile(pattern, re.UNICODE), input)
  printResult(re.compile(pattern, re.UNICODE | re.LOCALE), input)

  matchWith2(pattern, input, 'C') # default (root) locale
  matchWith2(pattern, input, 'et_EE')
  matchWith2(pattern, input, 'et_EE.UTF-8')
  matchWith2(pattern, input, 'Estonian_Estonia.1257') # Windows locale
  locale.setlocale(locale.LC_ALL, origlocale)

def matchWith2(pattern, input, localeParam):
  try:
    locale.setlocale(locale.LC_ALL, localeParam) # default (root) locale
    printResult(re.compile(pattern), input)
    printResult(re.compile(pattern, re.UNICODE), input)
    printResult(re.compile(pattern, re.UNICODE | re.LOCALE), input)
  except locale.Error:
    print("Locale %s not supported on this platform" % localeParam)

def printResult(pattern, input):
  global rowindex
  try:
    print("%2d: %s\t%03d\t%-20s\t%-25s\t%-10s\t%-5s" % \
          (rowindex, input, ord(input[0]), locale.getlocale(), \
          specialFlag(pattern.flags), \
          pattern.pattern, pattern.match(input) != None))
  except UnicodeEncodeError:
    print("%2d: %s\t%03d\t%-20s\t%-25s\t%-10s\t%-5s" % \
          (rowindex, '?', ord(input[0]), locale.getlocale(), \
          specialFlag(pattern.flags), \
          pattern.pattern, pattern.match(input) != None))
  rowindex = rowindex + 1      

def specialFlag(flags):
  ret = []
  if ((flags & re.UNICODE) == re.UNICODE):
    ret.append("UNICODE_FLAG")
  if ((flags & re.LOCALE) == re.LOCALE):
    ret.append("LOCALE_FLAG")
  return ','.join(ret)

tryWith(u'v')
tryWith(u'š')
tryWith(u'ž') 
```

**Perl** (v5.22.3)

```
# Summary: [a-z] is always [a-z], \w always seems to recognize given test chars and
# unicode \p{Letter}, \p{Alpha} and POSIX :alpha: are supported.
# Unicode and locale flags for regular expression didn't matter in this use case.

use warnings;
use strict;
use utf8;
use v5.14;
use POSIX qw(locale_h);
use Encode;
binmode STDOUT, "utf8";

sub codepoint {
  my $inputp = $_[0];
  return unpack('U*', $inputp);
}
sub verify {
  my($inputp, $code) = @_;
  if (codepoint($inputp) != $code) {
    die sprintf('Your editor is not configured correctly for %s (result %s)', $inputp, codepoint($inputp))
  }
}

sub getlocale {
  return setlocale(LC_ALL);
}
my $rowindex = 0;
my $origlocale = getlocale();

verify('v', 118);
verify('š', 353);
verify('ž', 382);

# printf('orig locale is %s', $origlocale);

sub tryWith {
  my ($input) = @_;
  matchWith('[a-z]', $input);
  matchWith('\w', $input);
  matchWith('[[:alpha:]]', $input);
  matchWith('\p{Alpha}', $input);
  matchWith('\p{L}', $input);
}

sub matchWith {
  my ($pattern, $input) = @_;
  my @locales_to_test = ($origlocale, 'C','C.UTF-8', 'et_EE.UTF-8', 'Estonian_Estonia.UTF-8');
  for my $testlocale (@locales_to_test) {
    use locale;
    # printf("Testlocale %s\n", $testlocale);
    setlocale(LC_ALL, $testlocale);
    printResult($pattern, $input, '');
    printResult($pattern, $input, 'u');
    printResult($pattern, $input, 'l');
    printResult($pattern, $input, 'a');
   };
  no locale;
  setlocale(LC_ALL, $origlocale);
  printResult($pattern, $input, '');
  printResult($pattern, $input, 'u');
  printResult($pattern, $input, 'l');
  printResult($pattern, $input, 'a');
}

sub printResult{
  no warnings 'locale';
              # for this test, as we want to be able to test non-unicode-compliant locales as well
              # remove this for real usage

  my ($pattern, $input, $flags) = @_;
  my $regexp = qr/$pattern/;
  $regexp = qr/$pattern/u if ($flags eq 'u');
  $regexp = qr/$pattern/l if ($flags eq 'l');
  printf("%2d: %s\t%03d\t%-20s\t%-25s\t%-10s\t%-5s\n", 
        $rowindex, $input, codepoint($input), getlocale(),
        $flags, $pattern, (($input =~ $regexp) ? 'true':'false'));
  $rowindex = $rowindex + 1;
}

tryWith('v');
tryWith('š');
tryWith('ž'); 
```

**Ruby** (ruby 2.2.6p396 (2016-11-15 修订版 56800) [x64-mingw32])

```
# -*- coding: utf-8 -*-

# Summary: [a-z] and \w are always [a-z], unicode \p{Letter}, \p{Alpha} and POSIX
# :alpha: are supported. Locale does not have impact.

# Ruby doesn't seem to be able to interact very well with locale without 'locale'
# rubygem (https://github.com/mutoh/locale), so that is used.

require 'rubygems'
require 'locale'

def verify(inputp, code)
  if (inputp.unpack('U*')[0] != code)
    raise Exception, sprintf('Your editor is not configured correctly for %s (result %s)', inputp, inputp.unpack('U*')[0])
  end
end

$rowindex = 0
$origlocale = Locale.current
$origcharmap = Encoding.locale_charmap

verify('v', 118)
verify('š', 353)
verify('ž', 382)

# printf('orig locale is %s.%s', $origlocale, $origcharmap)
def tryWith(input)
  matchWith('[a-z]', input)
  matchWith('\w', input)
  matchWith('[[:alpha:]]', input)
  matchWith('\p{Alpha}', input)
  matchWith('\p{L}', input)
end  

def matchWith(pattern, input)
  locales_to_test = [$origlocale, 'C', 'et_EE', 'Estonian_Estonia']
  for testlocale in locales_to_test
    Locale.current = testlocale
    printResult(Regexp.new(pattern), input)
    printResult(Regexp.new(pattern.force_encoding('utf-8'),Regexp::FIXEDENCODING), input)
  end
  Locale.current = $origlocale
end

def printResult(pattern, input)
  printf("%2d: %s\t%03d\t%-20s\t%-25s\t%-10s\t%-5s\n", 
        $rowindex, input, input.unpack('U*')[0], Locale.current,
        specialFlag(pattern),
        pattern, !pattern.match(input).nil?)
  $rowindex = $rowindex + 1
end

def specialFlag(pattern)
  return pattern.encoding
end

tryWith('v')
tryWith('š')
tryWith('ž') 
```

**Javascript (node.js)** (v6.10.3)

```
function match(pattern, input) {
    try {
        var re = new RegExp(pattern, "u");
        return input.match(re) !== null;
    } catch(e) {
        return 'unsupported';
    }
}
function regexptest() {
    var chars = [
        String.fromCodePoint(118),
        String.fromCodePoint(353),
        String.fromCodePoint(382)
    ];
    for (var i = 0; i < chars.length; i++) {
        var char = chars[i];
        console.log(
            char
            +'\t'
            + char.codePointAt(0)
            +'\t'
            +(match("[a-z]", char))
            +'\t'
            +(match("\\w", char))
            +'\t'
            +(match("[[:alpha:]]", char))
            +'\t'
            +(match("\\p{Alpha}", char))
            +'\t'
            +(match("\\p{L}", char))
            );
    }
}

regexptest(); 
```

**Javascript（网络浏览器）**

```
function match(pattern, input) {
    try {
        var re = new RegExp(pattern, "u");
        return input.match(re) !== null;
    } catch(e) {
        return 'unsupported';
    }
}
window.onload = function() {
    var chars = [
        String.fromCodePoint(118),
        String.fromCodePoint(353),
        String.fromCodePoint(382)
    ];
    for (var i = 0; i < chars.length; i++) {
        var char = chars[i];
        var table = document.getElementById('results');
        table.innerHTML += 
            '<tr><td>' + char
            +'</td><td>'
            + char.codePointAt(0)
            +'</td><td>'
            +(match("[a-z]", char))
            +'</td><td>'
            +(match("\\w", char))
            +'</td><td>'
            +(match("[[:alpha:]]", char))
            +'</td><td>'
            +(match("\\p{Alpha}", char))
            +'</td><td>'
            +(match("\\p{L}", char))
            +'</td></tr>';
    }
}
```

```
table {
    border-collapse: collapse;
}
table td, table th {
    border: 1px solid black;
}
table tr:first-child th {
    border-top: 0;
}
table tr:last-child td {
    border-bottom: 0;
}
table tr td:first-child,
table tr th:first-child {
    border-left: 0;
}
table tr td:last-child,
table tr th:last-child {
    border-right: 0;
}
```

```
<!DOCTYPE html> 
<html>
<head>
    <meta charset="utf-8" /> 
</head>
<body>
    <table id="results">
    <tr>
        <td>char</td>
        <td>codepoint</td>
        <td>[a-z]</td>
        <td>\w</td>
        <td>[[:alpha:]]</td>
        <td>\p{Alpha}</td>
        <td>\p{L}</td>
    </tr>
    </table>
</body>
</html>
```

**AWK**（GNU awk 4.1.3）

```
$ echo "xyzvöä" | LC_ALL=C awk '{match($0,"[a-z]+",a)}END{print a[0]}'
xyzv
$ echo "xyzvöä" | LC_ALL=et_EE.utf8 awk '{match($0,"[a-z]+",a)}END{print a[0]}'
xyzv
$ echo "xyzvöä" | LC_ALL=C awk '{match($0,"\\w+",a)}END{print a[0]}'
xyzv
$ echo "xyzvöä" | LC_ALL=et_EE.utf8 awk '{match($0,"\\w+",a)}END{print a[0]}'
xyzvöä
$ echo "xyzvöä" | LC_ALL=C awk '{match($0,"[[:alpha:]]+",a)}END{print a[0]}'
xyzv
$ echo "xyzvöä" | LC_ALL=et_EE.utf8 awk '{match($0,"[[:alpha:]]+",a)}END{print a[0]}'
xyzvöä 
```

**AWK**（GNU awk 3.1.8）

```
$ echo "xyzvöä" | LC_ALL=C awk '{match($0,"[a-z]+",a)}END{print a[0]}'
xyzv
$ echo "xyzvöä" | LC_ALL=et_EE.utf8 awk '{match($0,"[a-z]+",a)}END{print a[0]}'
z
$ echo "xyzvöä" | LC_ALL=C awk '{match($0,"\\w+",a)}END{print a[0]}'
xyzv
$ echo "xyzvöä" | LC_ALL=et_EE.utf8 awk '{match($0,"\\w+",a)}END{print a[0]}'
xyzvöä
$ echo "xyzvöä" | LC_ALL=C awk '{match($0,"[[:alpha:]]+",a)}END{print a[0]}'
xyzv
$ echo "xyzvöä" | LC_ALL=et_EE.utf8 awk '{match($0,"[[:alpha:]]+",a)}END{print a[0]}'
xyzvöä 
```

**grep** (GNU grep 2.10, GNU grep 3.4)

```
$ echo xuzvöä | LC_ALL=C grep [az]
 xuzv öä
$ echo xuzvöä | LC_ALL=et_EE.utf8 grep [az]
xuzv öä
$ echo xuzvöä | LC_ALL=C grep [[:alpha:]]
xuzv öä
$ echo xuzvöä | LC_ALL=et_EE.utf8 grep [[:alpha:]]
xuzv öä
$ echo xuzvöä | LC_ALL=C grep \\w
xuzv öä
$ echo xuzvöä | LC_ALL=et_EE.utf8 grep \\w
xuzv öä

```

**grep**（GNU grep 2.16，GNU grep 2.25）

```
$ echo xuzvöä | LC_ALL=C grep [az]
 xuzv öä
$ echo xuzvöä | LC_ALL=et_EE.utf8 grep [az]
xu z vöä
$ echo xuzvöä | LC_ALL=C grep [[:alpha:]]
xuzv öä
$ echo xuzvöä | LC_ALL=et_EE.utf8 grep [[:alpha:]]
许兹沃
$ echo xuzvöä | LC_ALL=C grep \\w
xuzv öä
$ echo xuzvöä | LC_ALL=et_EE.utf8 grep \\w
许兹沃

```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-12T20:42:32.633

### 可能的语言环境错误

您面临的问题不是 POSIX 字符类*本身*，而是这些类依赖于语言环境这一事实。例如，正则表达式（7）说：

> 在括号表达式中，包含在“[:”和“:]”中的字符类的名称代表属于该类的所有字符的列表......这些代表在 wctype(3) 中定义的字符类。 **语言环境可以提供其他语言环境。**

重点是我的，但手册页明确表示字符类取决于语言环境。此外， wctype(3) 说：

> wctype() 的行为取决于当前语言环境的 LC_CTYPE 类别。

换句话说，如果您的语言环境错误地定义了一个字符类，那么它就是一个应该针对特定语言环境提交的错误。另一方面，如果字符类只是以您不期望的方式定义字符集，那么它可能不是错误；这可能只是一个需要编码的问题。

### 字符类作为快捷方式

字符类是定义集合的快捷方式。您当然不限于为您的语言环境预先定义的集合，您可以自由使用 perlre(1) 定义的 Unicode 字符集，或者如果可以提供更高的准确性，则直接显式创建集合。

你已经知道了，所以我不想学究气。我只是指出，如果您不能或不会修复语言环境（这是问题的根源），那么您应该使用显式设置，就像您所做的那样。

便利类仅在适用于您的用例时才方便。如果没有，就把它扔到海里！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-12T18:49:56.853

如果这正是您想要的，那么使用`[a-z]`并没有错。

但认为英语单词仅由 of`[a-zA-Z]`或德语 of`[a-zäöüßA-ZÄÖÜ]`或名称跟随是错误的`[A-Z][a-z]*`。

如果我们想要任何语言或书写系统中的单词（针对 2,300 种语言进行测试，每 50 K 最常见的单词），我们可以使用如下内容：

```
#!perl

use strict;
use warnings;
use utf8;

use 5.020;    # regex_sets need 5.18

no warnings "experimental::regex_sets";

use Unicode::Normalize;

my $word_frequencies = {};

while (my $line = <>) {
    chomp $line;
    $line = NFC($line);

    # NOTE: will catch "broken" words at end/begin of line
    #       and abbreviations without '.'
    my @words = $line =~ m/(
        (?[ \p{Word} - \p{Digit} + ['`´’] ])
        (?[ \p{Word} - \p{Digit} + ['`´’=⸗‒—-] ])*
    )/xg;

    for my $word (@words) {
        $word_frequencies->{$word}++;
    }
}

# now count the frequencies of graphemes the text uses

my $grapheme_frequencies = {};
for my $word (keys %{$word_frequencies}) {
    my @graphemes = m/(\X)/g;
    for my $grapheme (@grapheme) {
        $grapheme_frequencies->{$grapheme} 
            += $word_frequencies->{$word};
    }
} 
```

对于更窄的检查，我们可以查看`\p{Word}`Unicode 标准[https://unicode.org/reports/tr18/#word中的定义](https://unicode.org/reports/tr18/#word)

```
word
    \p{alpha}
    \p{gc=Mark}
    \p{digit}
    \p{gc=Connector_Punctuation}
    \p{Join_Control} 
```

基于此，`\p{Word}`我们现在可以为例如`words`拉丁文脚本定义一个正则表达式：

```
# word:
    \p{Latin}    # \p{alpha}
    \p{gc=Mark}
    # \p{digit}  # we don't want numerals in words
    \p{gc=Connector_Punctuation}
    \p{Join_Control} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-11T10:11:34.270

对于 awk，也许在字母表上强制使用八进制代码应该可以避免 awk/poxix/locales 中的不一致

就像是

```
 /[\060-\071       # 0-9
     \101-\132       # A-Z
     \141-\172]/     # a-z 
```

如果你想把它们变成字符串常量，也许加倍反斜杠以确保解析器/正则表达式引擎不会变得太聪明，并将**"\101"**预转换为**A**，并为它提供一个“尊重”语言环境的机会- 可能不是您想要的设置。

> `"\\101"`

# java - 带有枚举的单例与带有双重检查锁定的单例

> ID：11925539
> 
> 赞同：4
> 
> 时间：2012-08-12T20:12:32.260
> 
> 标签：java, multithreading, singleton

我想知道在多线程环境中哪个在实践中更好。我将 Singleton 理解为 Enum 类型在加载类时创建一个实例。除此之外，我没有看到任何其他重要的东西。有什么优点和缺点吗？

**单例作为`Enum`类型：**

```
 public enum Singleton {
      INSTANCE;
      public void doSomething(){ ... }
 } 
```

**单例`double-checked locking`：**

```
 public class Singleton{
      private volatile static Singleton instance;

      private Singleton(){}
      public static Singleton getInstance(){
           if(instance == null){
                 synchronized(Singleton.class){
                       if(instance == null){
                           instance = new Singleton();
                       }
                 }
           }
           return instance;
      }

 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T20:27:53.250

通常在多线程应用程序中，更简单、更容易理解的代码更容易工作。

在我看来，第一个例子*比*第二个简单得多，这才是最重要的。

使用 an 的主要优点`enum`是它更简单，更复杂的例子是不合理的。双锁定示例允许您以有趣的方式更改单例以进行单元测试，但我相信这给您带来的问题可以通过另一种方式解决。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T21:33:53.177

单例有更多的问题，而不仅仅是正确的实现。

人们经常使用单例，因此他们不必在应该或必须在多个方法之间传递对象的地方传递对象。

有很多使用 Singleton 实例化 jdbc 连接的示例。

在需要此连接的方法中，您可以轻松访问它，因为它是 Singleton。

```
public enum DBConnection {
  INSTANCE;
  private Connection connection;
  public Connection getConnection(){
    if(connection == null){
      instantiateConnection();
    }
    return connection;
  }
} 
```

并通过

```
DBConnection.INSTANCE.getConnection(); 
```

但通常最好使用依赖注入和一个令人愉快的框架来做到这一点。以 GUICE 为例。

在您的代码中，您不会在 DBConnection.INSTANCE 上进行调用，而不是在 getConnection() 上，您的 Class 将有一个用 @Inject 注释的字段 DBConnection。而你只是使用它。

```
@Inject
private DBConnection dBConnection; 
```

并且该类将仅使用@Singleton 注释为单例，并且框架将确保它是单例。

如果你有不同的环境，比如测试和生产，你可以让框架为每个环境注入不同的对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T20:51:10.153

`enum`用于创建的方法因其**简单快捷的方式而**`singleton`广受欢迎。

 **此外，您在这里与双重检查锁定进行了比较，**但是还有其他方法，而不使用枚举。**

**例如：**

```
public class Test{

      private static Test uniqueInstance = new Test();

      private Test(){}

      public static Test getInstance(){

             return uniqueInstance;     
         }

 } 
```

但我认为使用更清晰的自我解释代码是一种`enum`非常**直接的方法** `singleton`。**

# vb.net - vb.net DataGridView 在键入时更新标签

> ID：11925540
> 
> 赞同：0
> 
> 时间：2012-08-12T20:12:40.987
> 
> 标签：vb.net, datagridview, keypress, editing

我有一个要过滤的datagridview。

在 datagridview 上方，我有第二个具有相同列数的单行空过滤器 datagridview。

当用户输入其中一个单元格时，我想根据过滤器 datagridview 的填充单元格过滤主 datagridview。

在应用过滤器之前，我想在当前单元格文本仍在编辑时更新标签。

如何在编辑结束前获取用户更改的文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:34:34.653

已解决 - 使用 c.EditedFormattedValue.ToString

```
Private Sub dgvFilter_EditingControlShowing(ByVal sender As Object, _
    ByVal e As System.Windows.Forms.DataGridViewEditingControlShowingEventArgs) _
    Handles dgvFilter.EditingControlShowing

    Dim tb As TextBox = TryCast(e.Control, TextBox)

    If (tb IsNot Nothing) Then
        RemoveHandler tb.KeyUp, AddressOf tb_KeyUp
        AddHandler tb.KeyUp, AddressOf tb_KeyUp

        'RemoveHandler tb.KeyDown, AddressOf tb_KeyDown
        'AddHandler tb.KeyDown, AddressOf tb_KeyDown
    End If

End Sub

Private Sub tb_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs)

    Dim c As DataGridViewCell = dgvFilter.CurrentCell
    Dim s As String = c.EditedFormattedValue.ToString
    Dim totalFilter As String

    lblKeyCode.Text = e.KeyCode

    'If e.KeyCode <> Keys.Down Then

    cellName = dgvFilter.Columns(dgvFilter.CurrentCell.ColumnIndex).Name

    cellFilter = "[" & cellName & "] LIKE '" & s & "%'"

    'get the filter (other columns plus current column)
    totalFilter = FilterString(dgvFilter, cellFilter)
    Me.txtFilter.Text = totalFilter

    'apply the filter
    Me.lookupDataTable.DefaultView.RowFilter = totalFilter
    'Else
    'dgv.Focus()
    'End If

End Sub 
```

# javascript - 使用 API 注册创建 Node.js API 框架

> ID：11925543
> 
> 赞同：1
> 
> 时间：2012-08-12T20:12:49.770
> 
> 标签：javascript, api, express, api-key

如何将 API 注册/计费添加到我的 ExpressJS 和/或 node-restify 服务器？（类似于Python 世界中的[http://django-rest-framework.org/ ？）](http://django-rest-framework.org/)

我现在使用 ExpressJS 运行 API 服务器（可能很快会转换为 node-restify）。

我希望用户注册 API 密钥并为高使用率付费。

有哪些库可以简化我的任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T08:54:23.950

使用 Node-Restify 可以轻而易举地添加“中间件”以向请求-响应管道提供任何专业行为。这些可以放置在路由处理程序运行之前、之中或之后。根据您的问题，我会将这些放置在路由运行以验证/计费 URI/HTTP 方法访问之前。文档在这方面也很好。

```
server.use(function (req, res, next){ // do your thing here, call next if happy }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-20T17:23:11.057

最简单的方法是使用 3rd 方服务 - 特别是如果您打算对 API 的使用收费，因为他们将处理测量使用情况和计费。其中一些服务仅在您收费时才收费，这是一个好的开始。有一些，所以我会列出我最喜欢的[Mashape](http://mashape.com) - 非常好的 UI，免费 API 使用不收费，其他收费的 25%。这是一个很好的入门者，因为没有成本支出。还有其他不错的，例如 Mashery、3Scale、Apigee 等等。您可以在 Google 中搜索“Mashape 替代品”以获取其他产品。

至于滚动您自己的检查[ApiAxle](http://apiaxle.com)。它没有集成计费，但它是基于节点的，提供使用统计信息、速率限制、缓存并具有生成密钥的 API 等……结合诸如[Stripe](http://stripe.com)之类的东西，您可以创建自己的计费系统。

# javascript - 防止在服务器端和用户端的 TinyMCE 中创建某些标签

> ID：11925545
> 
> 赞同：2
> 
> 时间：2012-08-12T20:12:54.103
> 
> 标签：javascript, html, django, tinymce

我正在使用 TinyMCE 插件来创建文本编辑器。问题是，我希望我的用户控制他们文档的位置、权重和列表/无列表，而不是字体、字体颜色或字体大小。我正在寻找一个 TinyMCE 属性，它将阻止程序将这些标签添加到 css。另外，我需要在服务器端实现它。我正在使用 django，那么是否有任何功能也可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T19:19:13.747

可以使用“valid_elements”配置设置准确指定允许哪些 HTML 标记和相关属性： [http ://www.tinymce.com/wiki.php/Configuration:valid_elements](http://www.tinymce.com/wiki.php/Configuration:valid_elements)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-13T19:00:27.460

我相信只要你不提供字体相关的按钮（使用theme_advanced_buttons_1/2/3参数），也不给他们HTML按钮，用户将无法更改字体/颜色/等。

但是，如果他们要粘贴在其他地方创建的一些文本（恰好是 HTML），他们可能仍然会这样做。要摆脱这种情况，您可能必须过滤服务器接收的内容 - 我不了解任何现成的方法来做到这一点。

# mono - MonoDevelop：MonoMac 和 GTK# 的相同项目可能吗？

> ID：11925550
> 
> 赞同：2
> 
> 时间：2012-08-12T20:13:51.463
> 
> 标签：mono, monodevelop, gtk#

也许我的问题完全天真，这就是为什么我无法通过谷歌或其他东西找到任何信息的原因——但尽管如此，我认为值得在这里提问。

我想开发一个在 Mac 和 Windows 中自然运行的 C# 应用程序（Linux 也不错，但不是直接需要）。我的主要开发操作系统应该是 Mac OS X，因此我想使用 MonoDevelop。

我可以为 MonoMac 设置一个项目 - 工作正常。我可以为 GTK# 设置一个不同的项目 - 工作正常。

我现在的问题是，我必须做些什么才能获得一个有可能使用 MonoMac 和 GTK#-frontend 的项目。所以我将采用 MVC 模式并希望在一个项目中工作。因此，构建我的项目将产生一个 Mac 可执行文件（基于 MonoMac 的东西）和一个 Windows 可执行文件（基于 GTK#）。

我的方法完全错了吗？我必须做什么才能实现我的目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T02:18:40.350

是的，对于在每个平台上具有最佳外观的多平台应用程序，您需要每个平台一个可执行文件。使用 MVC 方法是执行此操作的最佳方法 - 您可以拥有一个包含库项目的解决方案，其中包含所有共享代码 - 模型、处理代码、业务逻辑等 - 以及包含平台的每个“前端”可执行文件的项目 -具体的意见和外壳。

如果 Windows 上真正好的原生体验比 Linux 支持优先级更高，我建议使用 WPF 或 Windows Forms 而不是 GTK#。这意味着您必须在 Windows 和 MacOS 之间拆分开发 - 您需要在 Windows 上的 Visual Studio、SharpDevelop 或 MonoDevelop 中打开相同的项目，并在那里编辑 WPF/WinForms 项目和共享库。

OTOH，GTK# 的优势在于您可以先编写一个可在所有三个平台上运行的前端，然后再编写特定于平台的前端。

# mysql - MySQL：在具有现有记录的表上添加索引

> ID：11925551
> 
> 赞同：1
> 
> 时间：2012-08-12T20:14:09.433
> 
> 标签：mysql, sql

我有一个运行非常缓慢的查询。正在查询的表有大约 100k 条记录，并且在 where 子句中使用的大多数列上没有索引。我刚刚在这些列上添加了索引，但查询并没有变得更快。

我认为这是因为当一个列被索引时，它的值是在插入时写入索引中的。在添加了所有这些记录**之后，**我现在才添加索引。那么有没有办法在表上“重新运行索引”？

## 编辑

这是查询和解释结果：

![在此处输入图像描述](../Images/3e1fb8c7358d0ba82babcc95e6386693.png)

奇怪的是，当我复制查询并直接在我的 SQL 管理器工具中运行时，它运行得非常快，所以问题可能出在我的应用程序代码中，而不是查询本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:18:36.693

这是一个非常普遍的问题。

使用 MySQL 解释[http://dev.mysql.com/doc/refman/5.0/en/using-explain.html](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)

当您在 SELECT 语句之前加上关键字 EXPLAIN 时，MySQL 会显示来自优化器的有关查询执行计划的信息。也就是说，MySQL 解释了它将如何处理该语句，包括有关表如何连接以及以何种顺序连接的信息。

使用这些结果...验证您创建的索引是否按您预期的方式运行。

如果没有，您将需要调整索引，直到它按预期工作。

您可能想创建一个新表，创建索引，然后在测试时将旧表中的所有元素插入到新表中。这比一百万次删除和重新添加索引要容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T20:25:06.907

Mysql 保持一致的索引。不管是先添加数据、先添加索引，还是随时更改数据。将产生相同的最终索引（假设最终数据和索引类型相同）。

您的慢查询不是由稍后添加索引引起的。还会有别的原因。

# android - Onclick 侦听器无法识别正确的图像

> ID：11925552
> 
> 赞同：0
> 
> 时间：2012-08-12T20:14:10.250
> 
> 标签：android, bitmap, imageview, listener, onclicklistener

我将 OnClicklistener 设置为图像：

```
 iv_album[i] = new ImageView(main.this);
                    iv_album[i].setImageBitmap(resized_a_p);
                    iv_album[i].setPadding(width-resized_a_p.getHeight()-5, t_img, 5, 0);
                    iv_album[i].setId(i);                   
                    iv_album[i].setOnClickListener(new OnClickListener() {
                           @Override
                           public void onClick(View v) {
                                System.out.println(v.getId());
                                }
                          }); 
```

当我单击图像上方、左侧或图像上时，它总是会在控制台上触发一个 id。但不是当我点击下面！

任何人都知道为什么会这样？示例：http: [//imgur.com/tC94A](http://imgur.com/tC94A)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:22:54.670

也许这可能是这条线的问题-

```
iv_album[i].setPadding(width-resized_a_p.getHeight()-5, t_img, 5, 0); 
```

`OnClickListener`s 将与填充部分一起使用。

# javascript - 根据当前连接的 HTTP 或 HTTPS

> ID：11925557
> 
> 赞同：0
> 
> 时间：2012-08-12T20:15:24.387
> 
> 标签：javascript, html, http, https

在不使用服务器端动态语言的情况下，确定用户是在特定页面上使用 HTTP 还是 HTTPS 连接的最佳方法是什么？

我有一个带有表单的页面，它发布到某个 URL，我希望该 URL 是 HTTP 或 HTTPS - 根据当前连接。

也许有一些解决方案，例如：

```
<form action="://www.mysite/form/post" method="post"> 
```

这将相应地设置 HTTP 或 HTTPS。

如果仅使用 HTML 无法设置，那么使用 javascript 的最佳方法是什么？

感谢帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T20:18:42.180

就快到了 ：）

它是

```
//www.mysite.com/form/post 
```

[有关协议相对 URL 的更多信息](http://paulirish.com/2010/the-protocol-relative-url/)

但是，正如@Petra 所提到的，这当然只有在目标位于不同域时才有意义。否则，您只需使用普通的相对 URL：`/form/post`

# python - 使用烧瓶记录错误

> ID：11925558
> 
> 赞同：7
> 
> 时间：2012-08-12T20:15:31.843
> 
> 标签：python, oop, decorator, flask, uwsgi

我正在尝试使用在装饰器函数中记录错误`app.logger.error('')`，但它不起作用。另外我不能很好地调试这个，我只能看到来自 http 客户端的响应：

*（我使用的是 nginx+uwsgi+flask）*

> HTTP/1.1 502 错误网关
> 
> 服务器：nginx
> 
> 日期：2012 年 8 月 12 日星期日 15:45:09 GMT
> 
> 内容类型：文本/html
> 
> 内容长度：14
> 
> 连接：保持活动

一切都很好，没有线：`app.logger.error('panic !!!')`

```
def mydecorator():
    def decorator(f):
        def wrapped_function(*args, **kwargs):
            try:
                ip = Mytable.query.filter_by(ip=request.remote_addr).first()
            except:
                app.logger.error('panic !!!')
            else:
                dootherthing()

            resp = make_response(f(*args, **kwargs))
            h = resp.headers
            h['add-this-header'] = ":)"
            return resp
        return update_wrapper(wrapped_function, f)
    return decorator 
```

似乎是断章取义之类的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-16T13:19:34.453

事实上，装饰器无法检测到应用程序实例脱离上下文，我使用 current_app 解决了这个问题：

第一个。导入方法：`from flask import current_app`

第二。将任何应用程序类附加到 current_app： `current_app.logger.error('panic !!!')`

> 信息[@http://flask.pocoo.org/docs/api/#flask.current_app](http://flask.pocoo.org/docs/api/#flask.current_app)
> 
> “指向处理请求的应用程序。这对于希望支持并行运行的多个应用程序的扩展很有用。这是由应用程序上下文而不是请求上下文提供支持的，因此您可以通过使用更改此代理的值app_context() 方法。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:36:18.223

是`app`在您发布的脚本中的任何地方定义的吗？

此外，为了帮助调试，在测试时您应该考虑使用`run()`带有[调试模式](http://flask.pocoo.org/docs/quickstart/#debug-mode)的方法。

```
app.run(debug=True) 
```

# python - 为什么 python 正则表达式仅适用于捕获括号？

> ID：11925561
> 
> 赞同：3
> 
> 时间：2012-08-12T20:16:12.607
> 
> 标签：python, mysql, regex

我正在编写一个 python 函数来处理多行 SQL 语句。

例如

```
multi_stmt = """
-- delete empty responses
DELETE FROM idlongDVR_responses WHERE new_response_code = '';
DELETE FROM idwideDVR_responses WHERE new_response_code = '';

-- create a current responses table for idlongDVR
DROP TABLE IF EXISTS idlongDVR_respCurr;
CREATE  TABLE idlongDVR_respCurr
    SELECT *, MAX(modifiedat) AS latest  FROM idlongDVR_responses
    GROUP BY sitecode, id, dass, tass, field, value, validation_message
    ORDER BY sitecode, id, dass, tass; """ 
```

所以我写了一个正则表达式来识别换行符，如果它后面没有双连字符（开始注释），并以分号结尾

```
sql_line = re.compile(r"""
            \n+         # starting from a new line sequence
            (?!(--|\n)) # if not followed by a comment start "--" or newline 

            (.*?)       # <<<<< WHY ARE THESE CAPTURING BRACKETS NEEDED?

            ;           # ending with a semicolon
                      """, re.DOTALL|re.VERBOSE|re.MULTILINE)

stmts = sql_line.findall(multi_statement)

for stmt in stmts:
    stmt = stmt[1]
    if len(stmt) > 0:
        cursor.execute(stmt) 
```

它可以正常工作，但只有当我将`.*?`术语括在括号中时它才会变为`(.*?)`. 如果我不这样做，那么我什么都不匹配。

为什么是这样？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:27:37.620

“需要这些捕获括号”，因为您在负前瞻内使用了捕获括号。

```
(?!(--|\n))
   ^     ^ 
```

由于这永远不应该匹配，因此第一个捕获组在成功匹配中将始终为空。由于某些方法（例如`.findall`）只会返回捕获组（如果它们存在），因此您只会看到一个空字符串列表。

在此处删除`(`...`)`应该使正则表达式的行为符合您的预期。顺便说一句，您可以使用`[^;]*` 而不是`.*?`.

```
sql_line = re.compile(r"\n+(?!--|\n)[^;]*;") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T21:03:00.483

你在用`findall`，不是吗？ `findall`很奇怪。如果您在正则表达式中有任何捕获组，它只返回*捕获*组的内容。正如@KennyTM 指出的那样，您的前瞻中有一个捕获组，并且由于它是一个*负*前瞻，因此只有当该组无法捕获任何内容时，您的整体匹配才会成功。因此，您的空字符串列表。

*不要问我*为什么当你使用`.*?`. 通过阅读文档，我希望它返回一个由两组组成的元组列表：一组是空的，一组是您期望的匹配项。但我只得到非空组。这似乎是`findall`我以前从未遇到过的另一层荒谬。

顺便说一句，你不需要`MULTILINE`旗帜。所做的只是改变锚点的行为，`^`并且`$`允许它们在行边界以及整个字符串的开头和结尾处匹配。也许你已经知道了，但是有一个非常持久的流氓模因漂浮在周围，上面写着“如果它是多行的，你必须使用`MULTILINE`”，每当我看到它时，我都会尝试在它上面加盖印记。

# c++ - 错误 C2761 不允许成员函数重新声明

> ID：11925563
> 
> 赞同：0
> 
> 时间：2012-08-12T20:16:37.320
> 
> 标签：c++, templates, specialization

我在为一个类编写专业化时遇到了一个问题（错误 C2761）。我的课程如下：

```
class Print{
public:
    typedef class fontA;
    typedef class fontB;
    typedef class fontC;
    typedef class fontD;

    template<class T>
    void startPrint(void) { return; };
    virtual bool isValidDoc(void) = 0;
}; 
```

我有一个`QuickPrint`继承类的`Print`类：

```
class QuickPrint : public Print {
       ...
}; 
```

当我尝试为该`startPrint`方法编写特化时发生错误：

```
template<>        // <= C2716 error given here
void QuickPrint::startPrint<fontA>(void)
{
      /// implementation
}

template<>        // <= C2716 error given here
void QuickPrint::startPrint<fontB>(void)
{
     /// implementation
} 
```

其余专业也会出现该错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:31:22.050

QuickPrint 没有名为 startPrint 的模板成员函数，因此专门化 QuickPrint::startPrint 是错误的。如果您在 QuickPrint 中重复模板定义，则专业化是可以的：

```
class QuickPrint : public Print {
   template<class T>
    void startPrint(void) { return; };
 };

template<>        // <= C2716 error given here
void QuickPrint::startPrint<Print::fontA>(void)
{
      /// implementation
} 
```

但是如果这里的目标是能够多态地调用 QuickPrint，那你就有麻烦了，因为 Print 中的模板函数不能被标记为虚拟的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:35:07.740

试试这个：

```
class QuickPrint : public Print {
    template<class T>
    void startPrint(void) { Print::startPrint<T>(); };
}; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-12T20:22:46.903

你的问题是这一行：

```
template<class T> 
void startPrint(void) { return; }; 
```

您已经提供了一个函数体，但随后尝试再次重新定义它（使用专门化），这将不起作用。

删除该函数体，它应该可以工作。

要定义默认行为，请为模板参数提供默认值`T`，然后为该参数添加一个特化。

# java - 设置自定义铃声以联系

> ID：11925571
> 
> 赞同：0
> 
> 时间：2012-08-12T20:18:35.887
> 
> 标签：java, android, android-contacts, ringtone

我有一个应用程序，除其他外，它试图为单个联系人设置特定的声音。一切正常，当您查看联系人信息时，它会将声音显示为联系人的铃声，但当联系人来电时，默认铃声会响起。任何人都可以阐明什么是错的吗？

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (resultCode == RESULT_OK) {
        switch (requestCode) {
        case CONTACT_PICKER_RESULT:
            Uri contactData = data.getData();
            String contactId = contactData.getLastPathSegment();

            Cursor localCursor = managedQuery(contactData, null, null, null, null);
            localCursor.moveToFirst();

            String str1 = localCursor.getString(localCursor.getColumnIndexOrThrow("_id"));
            String str2 = localCursor.getString(localCursor.getColumnIndexOrThrow("display_name"));
            Uri localUri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_URI, str1);
            ContentValues localContentValues = new ContentValues();

            localContentValues.put(ContactsContract.Data.RAW_CONTACT_ID, contactId);
            localContentValues.put(ContactsContract.Data.CUSTOM_RINGTONE, ringtonePath);
            getContentResolver().update(localUri, localContentValues, null, null);
            Toast.makeText(this, "Ringtone assigned to: " + str2, 0).show();

            break;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-01-10T18:03:04.020

万一有人偶然发现这个想知道如何实现这一点，我使用了 ringdroid 库的一部分来为联系人分配音调

[https://github.com/google/ringdroid](https://github.com/google/ringdroid)

# android - 仅在低于 4 的 Android 版本中出错

> ID：11925575
> 
> 赞同：0
> 
> 时间：2012-08-12T20:18:45.693
> 
> 标签：android

我在使用 android 版本 2.3.3 的设备和模拟器上遇到错误，但在使用 Android 版本 4 的设备和模拟器上 - 没有错误... LogCat 说：

```
 08-12 19:07:45.182: E/AndroidRuntime(352): FATAL EXCEPTION: main
08-12 19:07:45.182: E/AndroidRuntime(352): java.lang.NullPointerException
08-12 19:07:45.182: E/AndroidRuntime(352):  at android.app.WallpaperManager.setBitmap(WallpaperManager.java:484)
08-12 19:07:45.182: E/AndroidRuntime(352):  at com.zznob.lwpchanger.SWpJob$ParseSite.onPostExecute(SWpJob.java:96)
08-12 19:07:45.182: E/AndroidRuntime(352):  at com.zznob.lwpchanger.SWpJob$ParseSite.onPostExecute(SWpJob.java:1)
08-12 19:07:45.182: E/AndroidRuntime(352):  at android.os.AsyncTask.finish(AsyncTask.java:417)
08-12 19:07:45.182: E/AndroidRuntime(352):  at android.os.AsyncTask.access$300(AsyncTask.java:127)
08-12 19:07:45.182: E/AndroidRuntime(352):  at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
08-12 19:07:45.182: E/AndroidRuntime(352):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-12 19:07:45.182: E/AndroidRuntime(352):  at android.os.Looper.loop(Looper.java:123)
08-12 19:07:45.182: E/AndroidRuntime(352):  at android.app.ActivityThread.main(ActivityThread.java:3683)
08-12 19:07:45.182: E/AndroidRuntime(352):  at java.lang.reflect.Method.invokeNative(Native Method)
08-12 19:07:45.182: E/AndroidRuntime(352):  at java.lang.reflect.Method.invoke(Method.java:507)
08-12 19:07:45.182: E/AndroidRuntime(352):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
08-12 19:07:45.182: E/AndroidRuntime(352):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
08-12 19:07:45.182: E/AndroidRuntime(352):  at dalvik.system.NativeStart.main(Native Method) 
```

有错误的代码：

```
protected void onPostExecute(Bitmap bitmap)
        {
            if(!isCancelled()){
                try{
                    wallpaperManager.setBitmap(bitmap); <- Error on Android version 2.2-2.3
                }
                catch(IOException e){
                    e.printStackTrace();
                }
            }
            super.onPostExecute(bitmap);
        } 
```

使用 API 版本 8 构建...知道吗？

类完整代码 - [http://pastebin.com/iwgYbPfb](http://pastebin.com/iwgYbPfb)

# php - CakePHP 控制器别名

> ID：11925578
> 
> 赞同：5
> 
> 时间：2012-08-12T20:18:56.783
> 
> 标签：php, cakephp, cakephp-2.2

我知道关于这个主题还有其他几个主题，但似乎没有一个符合我的需要。

**是）我有的**

*   example.com/log/
*   日志控制器.php

我有`LogsController`而不是`LogController`（复数），因为 CakePHP 希望你有复数的控制器。

但正如您可能知道/注意到的那样，由于 url 中缺少“s” ，`example.com/log/`因此永远不会使用。`LogsController`

现在，我想`/log/*`被重定向到`/logs/*`. 与以下代码完美配合：

```
Router::connect ('/log/*', array('controller'=>'logs')); 
```

但是，当我尝试访问`example.com/log/actions/foo/bar`它似乎不起作用。所以经过一些谷歌搜索后，我发现了这个：

```
Router::connect ('/log/:action/*', array('controller'=>'logs')); 
```

效果很好。但是现在当我再次尝试访问 example.com/log/ 时，它说

> 错误：找不到 LogController。

**问题** 所以我的问题是，如何为我的 url 设置别名，以便`/log/`使用`LogsController`而不是尝试使用`LogController`.

我还有一些想要更改的控制器，例如`flight => FlightsController`, `profile => ProfilesController`。

* * *

看看[这个问题](https://stackoverflow.com/questions/12874722/)。主题大致相同，但略有不同。它可能会以某种方式帮助你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-13T14:30:51.450

好的，在 IRC 上其他一些人的帮助下，诸如此类。我发现了以下内容。

的组合

```
Router::connect('/flight/:action/*', array('controller'=>'flights'));
Router::connect('/flight/*', array('controller'=>'flights')); 
```

成功了。我以前试过这个，但按其他顺序，像这样：

```
Router::connect('/flight/*', array('controller'=>'flights'));
Router::connect('/flight/:action/*', array('controller'=>'flights')); 
```

这是行不通的。

所以这篇文章的前两行代码为我解决了这个问题。另一个人告诉我，Arun Jain 的解决方案不是一个合适的解决方案，因为它也改变了核心中的命名约定。这将导致 FormsHelper 和类似的类出现问题。所以我想我会更喜欢这篇文章中的代码，因为这只是一个别名，而不是一个核心更改脚本。无论如何感谢您的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T14:52:51.423

要通过路由执行此操作，正确的方法如下。

```
Router::connect('/flight', array('controller'=>'flights','action'=>'index'));
Router::connect('/flight/:action/*', array('controller'=>'flights')); 
```

这告诉路由器，当在 URL 中找到一个动作来使用它，但它没有找到参数时，默认是使用索引动作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T14:44:05.237

我对这一切的看法略有不同。复数通常是更准确的处理方式，但在复数完全错误的情况下，我会在 Inflector 类 (/lib/Cake/Utility/Inflector) 中添加一个异常。

在您的示例中，我将添加`log`到此`uninflected`单词列表中。这意味着系统范围的蛋糕不会附加“s”。您将拥有您`LogController`的视图将位于`Log`视图文件夹等...

**编辑**

我从内部遇到了一种更简洁的方法来做到这一点`app/config/bootstrap.php`

```
Inflector::rules(
    'plural',
    array(
         'uninflected' => array('log')
    )
); 
```

这将添加`log`到未变形列表中，而无需更改核心中的文件以允许更轻松的版本更新。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-13T04:36:05.817

您可以使用以下方法简单地做到这一点：

```
class LogsController extends AppController
{
public $name = 'Log';
..... YOUR REMAINING CODE ......
} 
```

您的路由器连接代码将保持不变。请询问它是否不适合您。

# mysql - MySQL - 删除损坏的数据库问题

> ID：11925581
> 
> 赞同：1
> 
> 时间：2012-08-12T20:19:19.467
> 
> 标签：mysql

数据库已损坏，我无法删除该数据库。我可以创建另一个数据库并删除 - 不用担心。当我尝试放弃时，我会失去与服务器的连接错误。

如果我删除`mysql/data/mydatabase`并重新创建 mydatabase 文件，我仍然遇到新创建的数据库的问题。

如果我创建一个具有不同名称的新数据库并使用它，则没有问题。

如何完全删除与损坏的数据库关联的所有文件？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-12T20:24:02.843

尝试通过 MySQL 命令行删除它：

```
DROP DATABASE dbname; 
```

# asp.net - 包含 div 的验证器文本 - 防止在验证器正常时显示

> ID：11925588
> 
> 赞同：0
> 
> 时间：2012-08-12T20:20:29.417
> 
> 标签：asp.net, css, validation

我有一个验证器，其关联的错误文本设置如下。

```
<asp:RequiredFieldValidator ID="RequiredFieldValidator2" ValidationGroup="1" ControlToValidate="EmailTB"
                                                    Text="<div class='error-left'></div><div class='error-inner'>required</div>"
                                                    Display="Static" Width="100%" runat="server" SetFocusOnError="true" /> 
```

我把这个验证器放在 tr 的第三个 td 上。前两个 td 是字段的名称和一个文本框。问题是即使没有显示错误文本，它也会通过宽度和高度来扭曲整个表格布局。我知道 ASP>NET 使用 javascript 使里面的文本在应该显示错误文本时可见，但我不喜欢布局被不应激活的标签高度扭曲的事实。看下面的照片： ![](../Images/08bf1b3477c34c4d29e7cbd69cbc215f.png)

观察： - 这是表单中唯一的验证器，这就是电子邮件的 tr 如此高的原因（因为 error-left 类具有此高度）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:34:38.163

将 Display 属性更改[为 Dynamic](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.display%28v=vs.71%29.aspx) - 将样式设置为[“display: none;”](http://www.w3schools.com/css/css_display_visibility.asp) 直到它被触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:30:25.623

即使没有错误也不要包含代码，而是仅在有错误时才包含代码。

# node.js - node.js setEncoding 问题

> ID：11925593
> 
> 赞同：4
> 
> 时间：2012-08-12T20:21:57.967
> 
> 标签：node.js

如果我在未注释“setEncoding”行的情况下运行以下代码，则会收到以下错误：

/usr/local/test-server/test.js:78

```
res.setEncoding('utf8');

    ^ 
```

TypeError: Object # has no method 'setEncoding'

没有这条线，一切都按预期工作——除了浏览器抱怨未声明的字符编码。

文档、SO、GitHub 问题列表或广泛的谷歌搜索中没有任何有用的东西。node.js 最新版本：0.8.6

```
var https = require('https');
var sslPrivateKey = fs.readFileSync('./pk.pem');
var sslCert = fs.readFileSync('./cert.pem');
var sslOpts = { key: sslPrivateKey, cert: sslCert };

var server = https.createServer(sslOpts, function(req, res) {

    if ('GET' === req.method) {

        res.writeHead(200, {'Content-Type': 'text/plain','charset': 'utf8'});
        //res.setEncoding('utf8');
        res.write('You are here' + "\n");
        res.end();

    } 

}

server.listen(8080); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-12T20:39:09.377

[http.ServerResponse](http://nodejs.org/api/http.html#http_class_http_serverresponse)类没有 setEncoding 方法。您试图设置标题“字符集”，但“字符集”是“内容类型”标题的一部分。尝试这个：

```
res.writeHead(200, {'Content-Type': 'text/plain; charset=utf8'}); 
```

请记住，这只是为客户提供有关如何解释内容的信息，而不是规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-12T08:53:09.867

对于在 TypeScript 中遇到相同问题的任何人，您应该使用类型 https.ClientRequest 而不是 Request。

# c++ - 具有可选成员的 POD 模板类

> ID：11925597
> 
> 赞同：1
> 
> 时间：2012-08-12T20:22:11.540
> 
> 标签：c++, templates

我正在寻找一种方法来选择性地包含 c++ 类的成员以生成 POD 结构。我发现这工作得很好，但不标准：

```
#include <iostream>

template <int v, int n, int t>
struct Point
{
    int vertex[v];
    float normal[n];
    double texcoord[t];
};

int main()
{
    std::cout << (sizeof (Point<0,0,1>)) << std::endl;
    std::cout << (sizeof (Point<1,0,1>)) << std::endl;
    std::cout << (sizeof (Point<1,1,2>)) << std::endl;
    std::cout << (sizeof (Point<0,0,0>)) << std::endl;
    return 0;
} 
```

所以 Point<1,0,0> 将只包含一个顶点（实际上 int 类型实际上是 vector3 类型），依此类推。这样做的主要原因是为了轻松支持 OpenGL 的交错数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T20:30:44.017

也许尝试这样的事情：

```
#include <type_traits>

template <unsigned int v, unsigned int n, unsigned int t>
struct Point
{
    int data[v + n + t];

    template <unsigned int i>
    typename std::enable_if<(i < v), int &>::type
    vertex() { return data[i]; }

    template <unsigned int i>
    typename std::enable_if<(i < v + n), int &>::type
    normal() { return data[v + i]; }

    template <unsigned int i>
    typename std::enable_if<(i < v + n + t), int &>::type
    texcoord() { return data[v + n + i]; }
}; 
```

用法：

```
Point<1,1,2> p;
p.vertex<0>() = 50; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-12T21:18:03.703

`std::array<T, 0>`是有效的，不像`T[0]`并且确实是一个更好的解决方案。不幸的是，由于这仅适用于 C++11，我不知道它的 Boost 同名是否`boost::array`也有这样的支持。

也可以自己编写一个`array`类似的助手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T20:33:33.160

你可以这样做，但你需要专业化。

**编辑：**与每个数组不同类型的新问题要求相匹配。使模板参数无符号。

```
template <> struct Point<0, 0, 0> {};
template <unsigned v> struct Point<v, 0, 0> { int vertex[v]; };
template <unsigned n> struct Point<0, n, 0> { float normal[n]; };
template <unsigned t> struct Point<0, 0, t> { double texcoord[t]; };
template <unsigned v, unsigned n> struct Point<v, n, 0> {
    int vertex[v];
    float normal[n];
};
template <unsigned v, unsigned t> struct Point<v, 0, t> {
    int vertex[v];
    double texcoord[t];
};
template <unsigned n, unsigned t> struct Point<0, n, t> {
    float normal[n];
    double texcoord[t];
}; 
```

当其对应的模板参数具有值时，每个特化都会忽略关联的数组`0`。对于所示的三个项目，特化的枚举并不过分，并且提供与原始帖子完全相同的语法来访问元素，但使用标准 C++ 构造。

将此技术扩展到 3 个阵列之外会很麻烦。但是，可以使用脚本对其进行管理，以便为您生成专业化。

# html - 删除多余空间的 CSS 问题

> ID：11925603
> 
> 赞同：-1
> 
> 时间：2012-08-12T20:23:07.343
> 
> 标签：html, css

我可以在图片上看到，文本在 DIV 中没有垂直对齐，文本下方有更多空间。我怎样才能解决这个问题？代码在这里：http: [//jsfiddle.net/Grek/w4HWn/](http://jsfiddle.net/Grek/w4HWn/)谢谢

![在此处输入图像描述](../Images/cd9cc9dc0af13c0ca7db8ce72e4ecfeb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:27:29.680

这些`br`元素几乎肯定不适合使用。假设这些是导航项目，您还应该[使用`ul`](http://css.maxdesign.com.au/listamatic/). 跨度可能是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:29:30.610

1.  去掉`padding`顶部和底部的
2.  删除`<br>`'s
3.  给容器一个固定`height`的让我们说`100px`
4.  现在给容器一个`line-height`与上面相同的，即`100px`

查看更新**[的 jsfiddle](http://jsfiddle.net/w4HWn/3/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T20:31:50.863

实际上注意到`<br>`'s 是无意中添加的 - 我删除了它们，现在可以了

# c - C：scanf的使用方法

> ID：11925606
> 
> 赞同：1
> 
> 时间：2012-08-12T20:24:19.293
> 
> 标签：c, input, io, scanf

我可以`scanf(...)`用作函数的参数吗？像这样：

```
printInteger(scanf(....)); 
```

我可以`scanf`用来将我读取的值归因于某个变量吗？像这样：

```
n = scanf(...); 
```

ps：我在这里解释我为什么要问这个。

我知道这个问题可能有点奇怪，但我正在一个项目中工作，该项目正在开发一个编译器，该编译器将某种语言作为输入，然后编译为 C。

例如，这是我的语言，我们称之为“stackoverflow”；）

```
proc printInteger(integer k)
    integer i;
        begin
            for i = 1 to k do
                print i;
        end

proc main()
    integer n, i;
    boolean ok;
    begin
        printInteger(getInteger);
        n = getInteger;
        ok = true;
        while i < n do
            begin
                print i;
                i = i + 1;
            end
        if ok then print 1; else print 0;
    end 
```

我不会深入了解该语言，但请注意，这`getInteger`意味着我想做一个`scanf(...)`，我的意思是，当出现`getInteger`我想编译为`scanf(...)`时，这就是为什么我想知道一些使用方法的原因`scanf(...)`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T20:25:21.867

> 我可以使用 scanf(...) 作为函数的参数吗？像这样：
> 
> printInteger(scanf(....));
> 
> 我可以使用 scanf 将我读取的值归因于某个变量吗？像这样：
> 
> n = scanf(...);

您**可以**将`scanf`其用作函数的参数，但这两个问题的真正答案是否定的：`scanf` **不**返回任何扫描的数据，它返回成功扫描的项目*数*- 或者`EOF`如果在任何成功之前达到输入结束扫描。您只能访问使用作为`scanf`参数传递以接收值的指针扫描的项目。因此，虽然您*可以*将`scanf`参数作为参数传递给函数，但它不会做您想要的。

如果您想`getInteger`用您的语言（在 C 中）实现该操作，则很难提出建议，因为只有您知道该语言/操作应该如何工作。只需使用`scanf`，实现将如下所示：

```
int nextInt;
int numScanned = scanf("%d", &nextInt);

if (numScanned < 1)
    handleError();
return nextInt; 
```

但是，如果您正在对您的语言进行一般解析，那么 using`scanf`是一个坏主意：您很快就会遇到 的限制问题`scanf`，并且您将无法预测所有输入类型，除非您的语言真的*很简单*，比您包含的示例更简单。

要正确执行此操作，请[`lex`](http://en.wikipedia.org/wiki/Lexical_analysis)为 C 找到一个好的库。这将避免很多麻烦。否则，如果您必须自己进行词法分析，请开始查看`fgets`，从您的输入中一次获取一行，然后自己进行标记化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T21:03:45.377

你问：

> 我可以使用 scanf(...) 作为这样的函数的参数吗？
> 
> ```
> printInteger(scanf(....)); 
> ```

第一个问题的答案是“是的，但是……”。

> 我可以使用 scanf 将我读取的值归因于这样的变量吗？
> 
> ```
> n = scanf(...); 
> ```

第二个答案是“不，因为……”。

“但是”主要是“但它并没有达到你的预期，所以你很少会这样做，如果有的话”。

在第一个示例中，`scanf()`返回成功转换的（整数）个数，如果达到 EOF，则返回 EOF。在任何情况下，它都不会返回它刚刚读取的值（尤其是因为它通常读取多个值并且其中大多数不是整数）。因此，如果您想打印已转换的值的数量，您可以使用该`printInteger()`函数来执行此操作，但这不是您通常想要做的。

同样，在第二种情况下，您当然可以将结果分配给所示`scanf()`的整数`n`（如果您需要报告错误，这样做通常是明智的）。但是，这不是读取的值（假设您有`%d`转换规范）；它是成功转换的次数。

# c# - 将 8 bpp 位图图片转换为 1 bpp？

> ID：11925607
> 
> 赞同：3
> 
> 时间：2012-08-12T20:24:25.513
> 
> 标签：c#, asp.net-mvc-3, image-processing, aforge

当它开始工作时，图像处理很有趣。到目前为止，我能够将 24 bpp 位图图像转换为 8 bpp 并做一些技巧。

但是我被卡住了，无法将它们更改为 1 bpp，这正是我想要的。我在 .Net4 上工作，我使用一个名为 Aforge 的外部库。

有人知道如何将 8 bpp 图像转换为 1 bpp 吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:33:44.307

好问题，向我介绍了一个很棒的图书馆 :) 解决方案：

`Bitmap binary = new Bitmap( 100, 100, PixelFormat.Format1bppIndexed );`

如发现：

[http://www.aforgenet.com/forum/viewtopic.php?f=2&t=1502](http://www.aforgenet.com/forum/viewtopic.php?f=2&t=1502)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T12:03:57.063

您可以使用 Binarize 和 IntensityDetect 等一些图像处理技术将 8 位图像转换为黑白图像。我们在网上搜索了一些支持这些功能的商业工具包，但它们不支持很多文件格式。我们终于找到了一个名为 Leadtools 的工具包，它通过大量其他图像处理功能支持这些功能。我注意到这个工具包可以原生地使用任何位深度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-08T23:40:01.823

经过长时间的搜索，我得到了这个代码示例。

[.NET 的双色调 (TIFF) 图像转换器](http://www.codeproject.com/Articles/15186/Bitonal-TIFF-Image-Converter-for-NET)

# android - gridview上的Android forceclose向下滚动

> ID：11925609
> 
> 赞同：0
> 
> 时间：2012-08-12T20:24:49.930
> 
> 标签：android, android-gridview

我有一个带有 4 列和一些行的 gridview，我从 web 服务中检索一些数据并将其正确加载到 gridview 适配器中，gridview 显示数据，但是当稍微滚动后开始向下滚动时，它强制关闭而我没有有什么问题吗？这是 logcat 记录的内容：

```
dalvik.system.nativestart.main 
```

# ios - 如何显示已在界面生成器中定义的自定义单元格？

> ID：11925613
> 
> 赞同：0
> 
> 时间：2012-08-12T20:25:22.223
> 
> 标签：ios, uitableview

我正在尝试嵌入自定义设计的 TableView 单元（在界面生成器中）。对于初学者，我试图在其自己的部分中添加一些文本字段。我能够展示定制设计的表格视图，但是我做错了，因为它看起来一团糟。关于如何添加其他部分也不是很清楚。有人可以指导我正确的方向吗？我试过以下：http: [//developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html#//apple_ref/doc/uid/TP40007451-CH7-SW20](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html#//apple_ref/doc/uid/TP40007451-CH7-SW20)

但是有点失落。

这是它的样子：

![在此处输入图像描述](../Images/c1829bab53a98c4d7e95bce9bf47ba48.png)

这是我在界面生成器中的设置：

![在此处输入图像描述](../Images/9aedd90edf0502cd1fc0b8f9f4d07555.png)

这是我的代码：

头文件：

```
#import <UIKit/UIKit.h>

@interface SearchTableViewController : UITableViewController
{

}
@property (nonatomic, retain) IBOutlet UITableViewCell *priceRanceCell;
@end 
```

执行：

```
#import "SearchTableViewController.h"

@interface SearchTableViewController ()

@end

@implementation SearchTableViewController
@synthesize priceRanceCell=_priceRanceCell;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.title = NSLocalizedString(@"Some Search", @"Some Search");
        self.tabBarItem.image = [UIImage imageNamed:@"search"];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
#warning Potentially incomplete method implementation.
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
#warning Incomplete method implementation.
    // Return the number of rows in the section.
    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"SearchViewCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...
    NSInteger section = [indexPath section];

    switch (section) {
        case 0: // First cell in section 1

            return self.priceRanceCell;

            break;
        default:
            // Do something else here if a cell other than 1,2,3 or 4 is requested

            return cell;

            break;
    }

    return cell;
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     */
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:37:30.340

您需要实施`heightForRowAtIndexPath:`. 另外，请注意，当您是 时`dequeueReusableCellWithIdentifier:`，结果可能为零，在这种情况下，您需要创建一个单元格。你应该修改你的逻辑，所以你甚至不尝试它的第 0 节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-10T14:05:58.270

在界面生成器中，单击您制作的自定义单元格，记住高度；然后单击您要使用的表格视图，从您的记忆中输入行高。

# ruby-on-rails - 如何在 Ruby on Rails 中使用相同的 .js 更新重新创建远程链接？

> ID：11925615
> 
> 赞同：3
> 
> 时间：2012-08-12T20:25:46.233
> 
> 标签：ruby-on-rails, ruby-on-rails-3

基本上我想让一个链接能够从“收藏”动态刷新到“已删除”，同时让用户可以选择通过重新单击新按钮返回。该操作确实发生了，因为当我刷新页面时，更新的按钮会显示。为什么点击“收藏此课堂”链接不起作用？“删除此教室”链接似乎有效。谢谢你的帮助

收藏夹控制器.rb：

```
 def create
    current_classroom.add_to_favorites(@classroom)
    current_classroom.save
    respond_to do |format|
      format.js {  }
      format.html {redirect_to @classroom}
    end
  end

  def destroy
    current_classroom.remove_from_favorites(@classroom)
    current_classroom.save
    respond_to do |format|
      format.js {  }
      format.html {redirect_to @classroom}
    end
  end 
```

收藏夹/create.js.erb

```
$("#favorite_classroom").html("<%= escape_javascript(link_to 'Remove the Classroom', classroom_favorite_path(@classroom), :remote => true, :method => :delete) %>"); 
```

教室/_classroom_details.html.erb

```
<div id="favorite_classroom">
<% if loggedin_user.favorite_classroom?(@classroom) %>
    <%= link_to 'Remove this Classroom', classroom_favorite_path(@classroom), :remote => true, :method => :delete %>
<% else %>
    <%= link_to 'Favorite this Classroom', classroom_favorites_path(@classroom), :remote => true, :method => :post %>
<% end %> 
```

路线：

```
classroom_favorites POST   /classrooms/:classroom_id/favorites(.:format)  {:action=>"create", :controller=>"favorites"}
classroom_favorite DELETE /classrooms/:classroom_id/favorites/:id(.:format) {:action=>"destroy", :controller=>"favorites"} 
```

单击“收藏此教室”链接时出错： `ActionView::Template::Error (No route matches {:action=>"destroy", :controller=>"favorites"`

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T20:54:56.570

您在 js 文件中使用了**两次**双引号。你不能那样做。你需要像这样重写它 -

```
$("#favorite_classroom").html("<%= escape_javascript(link_to 'Remove the Classroom', classroom_favorite_path(@classroom), :remote => true, :method => :delete) %>"); 
```

现在请注意，Remove the Classroom 用单引号而不是双引号括起来。

此外，您的路线不正确，因为您在教室中嵌套了收藏夹。编写链接时，您需要添加要删除的 @favorite 对象：

```
= link_to 'Remove Favorite', classroom_favorite_path([@classroom, @favorite]), :remote => true, :method => :delete 
```

现在您尝试访问的路线是有效的。那应该摆脱错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T21:46:46.783

我认为您不需要最喜欢的控制器，您需要的是教室控制器的最喜欢/不喜欢的动作。这是它的外观

**教室控制器.rb**

```
respond_to :html, :js

def favorite
  # ... find classroom by id
  # do your stuff
  @classroom.favorite = !@classroom.favorite
  respond_with(@classroom)
end 
```

**意见/教室/favorite.js.erb**

```
<%# the message should be oposite to favorite %>
<% msg = @classroom.favorite ? "Remove this Classroom" : "Favorite this Classroom" %>
$("#favorite_classroom").html("<%= escape_javascript(link_to msg, [:favorite, @classroom], :remote => true) %>"); 
```

这是路径助手的技巧，`[:favorite, @classroom]`应该翻译成`/classrooms/:id/favorite`. 如果它不起作用然后尝试`favorite_classrooms_path(@classroom)`

最后添加到您的**routes.rb**

```
resource :classrooms do 
  member { get :favorite }
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T01:20:20.900

看起来您需要在链接中引用“favorite_id”以匹配您的路线。

在您的情况下，可能是：

```
classroom_favorite_path([current_classroom, @classroom]) 
```

# html - 我想链接到我的主页：./ 或 /?

> ID：11925619
> 
> 赞同：1
> 
> 时间：2012-08-12T20:26:25.997
> 
> 标签：html, anchor

如果我想链接到我的主页，它应该指向根文件夹，是否有区别：

`<a href="./">`和`<a href="/">`

还是有任何“行业推荐”的做法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-12T20:28:01.410

`./`指向当前目录。`/`指向根目录。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-12T20:28:39.787

你应该使用`/`. `./`表示“从路径中的当前位置开始”，因此如果您位于*http://www.example.com/some/subdir*并且您的链接指向*./somepage.html*链接将指向*http:// www.example.com/some/subdir/somepage.html*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T20:30:04.140

是的，这两件事之间存在很大差异 - 取决于您链接的位置。

如果您在`/page.htm`，则没有真正的区别，但是如果您在 ，`/folder/page.htm`那么第一个是指`/folder/`可能不是您想要实现的目标，而第二个是要实现的目标。

# php - 使用 YouTube API 抓取超过 1000 个结果的数据，而不使用 Max Memory

> ID：11925623
> 
> 赞同：0
> 
> 时间：2012-08-12T20:27:38.773
> 
> 标签：php, youtube-api

我正在尝试获取整个频道的视频源（所有视频数据）并将其存储到我的 MySQL 数据库中，以便在我目前正在处理的应用程序中使用。我不是最有经验的 YouTube API。我正在使用的代码如下：

```
public function printVideoFeed($count)
{
    $this->startIndex($count);
    $data = $this->yt->getVideoFeed($this->query);

    foreach($data as $video)
    {
        echo $count .' - '.$video->getVideoTitle().'<br/>';
        $count++;
    }

    //check if there are more videos
    try{
        $nextFeed = $data->getNextFeed();
    } catch(Zend_Gdata_App_Exception $e)
    {
        echo $e->getMessage(). '<br/>';
    }

    if($nextFeed)
    {
        $this->printVideoFeed($count);
    }

} 
```

我得到的错误是：

```
Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 36 bytes) in C:\Program Files\ZendFrameworkCli\library\Zend\Gdata\App\Base.php on line 431 
```

这是我在尝试抓取超过 3000 个视频时遇到的几个错误之一。我的问题是如何在继续执行 printVideoFeed 方法的同时不继续扩大内存使用量。如果有办法让它跳出循环，但如果还有视频，那就重新开始，那就太棒了。我一直在寻找，但是用谷歌搜索这个问题是一件很难的事情（要得到我正在寻找的结果）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:36:38.217

您是否尝试过使用迭代而不是递归？我可以想象 PHP 可能会保留函数中声明的变量，尤其是`$data`，直到函数离开。或者，您可以`unset($data);`在开始递归之前调用。

另外：你确定你没有无限循环吗？也许你需要在打电话`startIndex()`之前再打电话`getNextFeed()`？

# python - 在 Python 正则表达式中捕获否定匹配

> ID：11925628
> 
> 赞同：1
> 
> 时间：2012-08-12T20:28:02.030
> 
> 标签：python, regex, backreference

我正在尝试进行非贪婪的否定匹配，我也需要捕获它。我在 Python 中使用这些标志，re.DOTALL | 重新本地化 | re.MULTILINE，对一些文本文件“数据库”进行多行清理，其中每个字段都以反斜杠开始新行。每条记录都以 \lx 字段开头。

```
\lx foo
\ps n
\nt note 1
\ps v
\nt note
\ge happy
\nt note 2
\ge lonely
\nt note 3
\ge lonely
\dt 19/Dec/2011

\lx bar
... 
```

我试图确保每个 \ge 字段在其记录中的某个位置上方都有一个 \ps 字段，一对一。目前，一个 \ps 后面经常跟几个 \ge ，因此需要复制下来，就像上面的两个单独的 \ge 一样。

以下是大部分需要的逻辑：在任何 \ps 字段之后，但在遇到另一个 \ps 或 \lx 之前，先找到一个 \ge，然后再找到另一个 \ge。捕获所有内容，以便可以将 \ps 字段复制到第二个 \ge 之前。

这是我的非功能性尝试。替换这个：

```
^(\\ps\b.*?\n)((?!^\\(ps|lx)*?)^(\\ge.*?\n)((?!^\\ps)*?)^(\\ge.*?\n) 
```

有了这个：

```
\1\2\3\4\1\5 
```

即使在一个小文件（34 行长）上，我也会遇到内存错误。当然，即使这可行，我也必须多次运行它，因为它只是试图处理第二个 \ge，而不是第三个或第四个。所以这方面的任何想法也会让我感兴趣。

**更新：** Alan Moore 的解决方案效果很好，尽管有些情况需要稍作调整。可悲的是，我不得不关闭 DOTALL，否则我无法阻止第一个 .* 包括随后的 \ps 字段——即使是非贪婪的 .*? 形式。但是我很高兴刚才在正则表达式点信息中了解了 (?s) 修饰符。这使我可以在一般情况下关闭 DOTALL，但仍可在其他必要的**正则**表达式中使用它。

这是建议的正则表达式，浓缩为我需要的单行格式：

```
^(?P<PS_BLOCK>(?P<PS_LINE>\\ps.*\n)(?:(?!\\(?:ps|lx|ge)).*\n)*\\ge.*\n)(?P<GE_BLOCK>(?:(?!\\(?:ps|lx|ge)).*\n)*\\ge.*\n) 
```

那行得通，但是当我修改上面的示例时，它在“注释 2”上方插入了 \ps。它还将 \lxs 和 \ge2 与 \lx 和 \ge 相同（需要一些 \b）。所以，我选择了一个稍微调整的版本：

```
^(?P<PS_BLOCK>(?P<PS_LINE>\\ps\b.*\n)(?:(?!\\(?:ps|lx|ge)\b).*\n)*\\ge\b.*\n)(?P<AFTER_GE1>(?:(?!\\(?:ps|lx|ge)\b).*\n)*)(?P<GE2_LINE>\\ge\b.*\n) 
```

这个替换字符串：

```
\g<PS_BLOCK>\g<AFTER_GE1>\g<PS_LINE>\g<GE2_LINE> 
```

再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:26:15.330

每当您遇到正则表达式问题并告诉自己“我必须多次运行它，..”时，这清楚地表明您需要编写一个解析器:-)

该语言似乎很常规，因此解析器应该很容易编写，也许从以下简单的东西开始：

```
def parse_line(line):
    kind, value = line.split(' ', 1)  # split on the first space
    kind = kind[1:]                   # remove the \
    parsed_value = globals().get('parse_' + kind, lambda x:x)(value)
    return (kind, parsed_value)

def parse_dt(value):
    val = ... # create datetime.date() from "19/Dec/2011"
    return val 
```

`globals()`用它来编写状态机可能有点太可爱了，但它节省了大量的样板代码...... :-)

将您的输入转换为元组列表：

```
records = [parse_line(line) for line in open("myfile.dta")] 
```

弄清楚一个`("ps", ..)`元组之前是否总是有一个元`("ge", ..)`组应该很容易——例如，首先注意所有`lx`元组的位置......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T23:52:03.883

您收到内存错误是因为您使用了该`DOTALL`标志。如果您的数据确实按照您显示的方式进行了格式化，那么您无论如何都不需要该标志；默认行为正是您想要的。您也不需要非贪婪修饰符 ( `?`)。

试试这个正则表达式：

```
prog = re.compile(r"""
    ^
    (?P<PS_BLOCK>
      (?P<PS_LINE>\\ps.*\n)
      (?:                   # Zero or more lines that
        (?!\\(?:ps|lx|ge))  # don't start with
        .*\n                # '\ps', '\lx', or '\ge'...
      )*
      \\ge.*\n              # ...followed by a '\ge' line.
    )
    (?P<GE_BLOCK>
      (?:                   # Again, zero or more lines
        (?!\\(?:ps|lx|ge))  # that don't start with
        .*\n                # '\ps', '\lx', or '\ge'...
      )*
      \\ge.*\n              # ...followed by a '\ge' line.
    )
    """, re.MULTILINE | re.VERBOSE) 
```

替换字符串将是：

```
r'\g<PS_BLOCK>\g<PS_LINE>\g<GE_BLOCK>' 
```

你仍然需要做多次传球。如果 Python 支持[`\G`](http://www.regular-expressions.info/continue.html)，则没有必要，但您可以使用[`subn`](http://docs.python.org/library/re.html#re.subn)并检查`number_of_subs_made`返回值。

# jquery - JQuery DataTables RowGrouping：将行从一个组移动到另一个组

> ID：11925629
> 
> 赞同：1
> 
> 时间：2012-08-12T20:28:05.920
> 
> 标签：jquery, datatables, grouping

我正在使用 jQuery + dataTables + rowGrouping 来呈现一个表格，其中行按特定列的值分组。在应用 rowGrouping 功能之前，它看起来像这样：

```
Task           | Status  | Buttons
-------------------------------------
Test something | Stopped | Start
Eat cake       | Started | Stop
Take a break   | Stopped | Start 
```

在rowGrouping之后：

```
Task           | Buttons
-------------------------------------
STARTED
Eat cake       | Stop
-------------------------------------
STOPPED
Take a break   | Start
Test something | Start 
```

（状态列现在被隐藏，值用于创建 STARTED/STOPPED 分组行 - 到目前为止一切都很好）。

下面是初始化数据表的代码：

```
var dataTable = $("#table")
  .dataTable({
    'bLengthChange': false,
    'bPaginate': false,
    'sScrollX': "100%",
    'bScrollCollapse': true,
  })
  .rowGrouping({
    'bExpandableGrouping': true,
    'sGroupingColumnSortDirection': 'asc',
    'iGroupingColumnIndex': 1, 
    'iGroupingOrderByColumnIndex': 0
  }); 
```

我现在的问题是，我想在按钮上附加一个 onclick 处理程序。单击“开始”按钮应将该任务的状态更改为“已启动”，并且该任务应移至“已启动”组。

但我就是不知道如何做到这一点:(

我的第一个想法是在表对象上再次调用 .rowGrouping() ，但这是不允许的。我还尝试使用 fnUpdate() 等 API 函数更新包含单击按钮的行的状态单元格，但我失败了。

我在本页的最后一部分找到了如何将一行移动到另一个组的提示：

[http://code.google.com/p/jquery-datatables-row-reordering/wiki/RowGrouping](http://code.google.com/p/jquery-datatables-row-reordering/wiki/RowGrouping)

但我花了一整天的时间试图让它发挥作用，但我无法弄清楚。

请帮忙 ：）

# ruby - 与 mongoid 的用户/组织关系

> ID：11925630
> 
> 赞同：1
> 
> 时间：2012-08-12T20:28:10.727
> 
> 标签：ruby, ruby-on-rails-3, mongoid

我有这样的关系：

组织：

```
class Organization
  include Mongoid::Document
  include Mongoid::Timestamps

  field :name, type: String
  field :email, type: String

  has_and_belongs_to_many :users
end 
```

用户：

```
class User
  include Mongoid::Document
  include Mongoid::Timestamps
  include ActiveModel::SecurePassword

  has_secure_password

  #Fields
  field :nick, type: String
  field :name, type: String
  field :email, type: String
  field :password_digest, type: String #for bcrypt-ruby

  #Validations
  ## Presence
  validates :nick, presence: true
  validates :email, presence: true
  validates :password, presence: true, :on => :create

  #Uniqueness
  validates :nick, uniqueness: true
  validates :email, uniqueness: true

  #Relations
  has_many :documents, dependent: :delete
  has_many :storages, dependent: :delete

  has_and_belongs_to_many :organizations
end 
```

我可以保存组织和用户。该关系工作正常，但现在我想向组织添加一个所有者，它也是一个用户。我试过`has_one :user, as: :owner`但没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T02:11:46.487

尝试将此添加到您的 organization.rb：

```
has_one :owner, class_name: "User", inverse_of :owns 
```

并将其添加到您的 user.rb 中：

```
belongs_to :owns, class_name: "Organization", inverse_of :owner 
```

或者，如果您愿意，您可以颠倒逻辑并将 放入`has_one`您的用户类和`belongs_to`您的组织中。显然，这取决于您的应用程序的逻辑。

# binary-tree - 非递归程序找到二叉树的最小高度

> ID：11925631
> 
> 赞同：1
> 
> 时间：2012-08-12T20:28:12.737
> 
> 标签：binary-tree

我知道可以编写递归代码来查找最小高度。但是对于一棵非常大的树（例如左侧的百万个节点与右侧的 1 个节点） - 这种方法并不好。所以请让我知道以下代码是否正常，它使用 BFS：-

```
 if (root == null)
    {
        return 0;
    }

    Queue<Node> queue = new Queue<Node>();
    queue.Enqueue(root);
    int min = 0;

    while (queue.Count > 0)
    {                
        Node temp = queue.Dequeue();

        if (temp.LeftChild == null)
        {
            return ++min;
        }
        if (temp.LeftChild != null)
        {
            ++min;
            queue.Enqueue(temp.LeftChild);
        }

        if (temp.RightChild == null)
        {
            return ++min;
        }
        if (temp.RightChild != null)
        {
            ++min;
            queue.Enqueue(temp.RightChild);
        }
    }

    return 0; 
```

所以对于像这样的树

```
 1
              /  \
             2    3
             /
            4
            /
            6 
```

以上返回 1，（根据 Floor(Log(n))？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:27:52.920

这个想法很完美。但是代码仍然可以改进一点。

1.  为什么每次出列项目时都会增加 min ？而且你做了两次，结果差了两倍 :) 如果你假设这个变量是节点计数器，那么它也是不正确的，因为你没有计算根元素。因此它必须以其他方式调用，而不是*min*。
2.  为什么要检查孩子是否为空两次？如果语句破坏了管道，则必须尽量减少它们的计数。

接下来是这个想法。如果其中的每个节点都有两个子节点，则我们称同级别节点的行*已满。*然后最小高度是树中*完整*行的计数。它等于最接近的幂指数 2 与所有*完整*行中的项目计数 + 1。代码：

```
if (root == null)
{
    return 0;
}

Queue<Node> queue = new Queue<Node>();
queue.Enqueue(root);
int nodesCount = 0;

while (queue.Count > 0)
{                
    Node temp = queue.Dequeue();

    if (temp.LeftChild == null || temp.RightChild == null)
    {
        return Floor(Log(nodesCount + 1)/Log(2)); // It can be made much better using, for example, bitwise operations but this is not the question`s topic
    }

    ++nodesCount;
    queue.Enqueue(temp.LeftChild);
    queue.Enqueue(temp.RightChild);
}

return Infinity; // :) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T07:13:45.707

使用 2 个堆栈进行“之字形”遍历。计算需要翻转“leftToRight”标志的次数。

# c# - 使用自定义镶边强制调整透明 WPF 窗口的大小

> ID：11925632
> 
> 赞同：1
> 
> 时间：2012-08-12T20:28:18.387
> 
> 标签：c#, wpf, resize, window, pinvoke

我一直在寻找几个小时，但没有发现任何有用的东西，因为所有其他问题都过于本地化，所以这是我对这个（常见）问题的版本：

我有一个*WindowStyle=None*和*ResizeMode=NoResize*的 WPF 窗口（否则我会得到我不想要的调整边框大小），最重要的是*AllowsTransparency=* **False**，我**必须**坚持这个设置。

*将ResizeMode*更改为*CanResize*并使用以下 MouseDown 处理程序进行自定义调整大小

```
[DllImport("User32.dll")]
public static extern bool ReleaseCapture();

[DllImport("User32.dll")]
public static extern IntPtr SendMessage(
     IntPtr hWnd, UInt32 Msg, Int32 wParam, Int32 lParam);

private void OnResizeGripMouseDown(object sender, MouseButtonEventArgs e) {
    ReleaseCapture();
    SendMessage(Window.Handle, WM_NCLBUTTONDOWN, HTBOTTOMRIGHT, 0);
} 
```

允许我完美地调整窗口大小，但是还有调整大小的边框。尽管有*ResizeMode=NoResize* ，有没有办法强制窗口的可调整性？

（也许通过`SetWindowLong`和`GWL_EXSTYLE`？如果需要消息，我已经有一个`WindowProc`设置来处理这个。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T10:37:00.097

我能够通过使用另一条消息来强制执行所需的行为

```
SendMessage(Handle, WM_SYSCOMMAND, SC_SIZE + direction, 0); 
```

其中[WM_SYSCOMMAND](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646360%28v=vs.85%29.aspx)是默认的 Windows 消息，SC_SIZE 是 0xF000 定义的 wParam，方向是此枚举定义的命中测试句柄的数值

```
public enum SysCommandSize : int {
     SC_SIZE_HTLEFT = 1,
     SC_SIZE_HTRIGHT = 2,
     SC_SIZE_HTTOP = 3,
     SC_SIZE_HTTOPLEFT = 4,
     SC_SIZE_HTTOPRIGHT = 5,
     SC_SIZE_HTBOTTOM = 6,
     SC_SIZE_HTBOTTOMLEFT = 7,
     SC_SIZE_HTBOTTOMRIGHT = 8
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-02T19:44:15.613

克里斯蒂安，您的解决方案让我走上了正确的道路，但是对于像我这样的愚蠢和懒惰的人来说，它缺少复制粘贴代码！在这里，如果您取消注释注释部分，您可以移动窗口，除了边框。

```
 private void Action_LMouseDownAndMove(object sender, MouseEventArgs e)
    {
        Point mousePosition = this.PointToClient(System.Windows.Forms.Cursor.Position);
        const int WM_NCLBUTTONDOWN = 0xA1;
        //const int HT_CAPTION = 0x2;
        if (e.Button == MouseButtons.Left)
        {
            ReleaseCapture();
            if (mousePosition.X < 20)
            {
                if (mousePosition.Y < 20)
                    SendMessage(Handle, WM_NCLBUTTONDOWN, 13, 0);
                else if (mousePosition.Y > this.Size.Height - 20)
                    SendMessage(Handle, WM_NCLBUTTONDOWN, 16, 0);
                else
                    SendMessage(Handle, WM_NCLBUTTONDOWN, 10, 0);
            }
            else if (mousePosition.X > this.Size.Width - 20)
            {
                if (mousePosition.Y < 20)
                    SendMessage(Handle, WM_NCLBUTTONDOWN, 14, 0);
                else if (mousePosition.Y > this.Size.Height - 20)
                    SendMessage(Handle, WM_NCLBUTTONDOWN, 17, 0);
                else
                    SendMessage(Handle, WM_NCLBUTTONDOWN, 11, 0);
            }
            else if (mousePosition.Y < 20)
                SendMessage(Handle, WM_NCLBUTTONDOWN, 12, 0);
            else if (mousePosition.Y > this.Size.Height - 20)
                SendMessage(Handle, WM_NCLBUTTONDOWN, 15, 0);
            //else
            //  SendMessage(Handle, WM_NCLBUTTONDOWN, HT_CAPTION, 0);
        } 
```

根据您的喜好更改 20 像素值。我不是 100% 确定左/右和上/下具有完全相同的调整大小区域，或者如果您知道我的意思，一个值是否需要为 19/21……这里的 if/else 树有一些减少的可能性， 我知道。而不是 20 我应该使用一个常数。

要更改光标以向用户显示他可以调整大小，我使用以下代码，它只是一个 MouseMove 事件处理程序：

```
 this.pictureBox.MouseMove += new MouseEventHandler((a, e) =>
        {
            Point h = this.PointToClient(System.Windows.Forms.Cursor.Position);

            if (h.X < 20)
            {
                if (h.Y < 20)
                {
                    pictureBox.Cursor = System.Windows.Forms.Cursors.SizeNWSE;
                }
                else if (h.Y > this.Size.Height - 20)
                {
                    pictureBox.Cursor = System.Windows.Forms.Cursors.SizeNESW;
                }
                else
                {
                    pictureBox.Cursor = System.Windows.Forms.Cursors.SizeWE;
                }
            }
            else if (h.X > this.Size.Width - 20)
            {
                if (h.Y < 20)
                {
                    pictureBox.Cursor = System.Windows.Forms.Cursors.SizeNESW;
                }
                else if (h.Y > this.Size.Height - 20)
                {
                    pictureBox.Cursor = System.Windows.Forms.Cursors.SizeNWSE;
                }
                else
                {
                    pictureBox.Cursor = System.Windows.Forms.Cursors.SizeWE;
                }
            }
            else if (h.Y < 20)
            {
                pictureBox.Cursor = System.Windows.Forms.Cursors.SizeNS;
            }
            else if (h.Y > this.Size.Height - 20)
            {
                pictureBox.Cursor = System.Windows.Forms.Cursors.SizeNS;
            }
            else
            {
                pictureBox.Cursor = System.Windows.Forms.Cursors.Default;
            }
        }); 
```

# javascript - Google Map API BackBoneJS 无法读取 null 的属性“offsetWidth”

> ID：11925638
> 
> 赞同：5
> 
> 时间：2012-08-12T20:29:14.170
> 
> 标签：javascript, google-maps, google-maps-api-3, backbone.js

我经历了尽可能多的 StackOverflow/google 小组，我可以想象试图找出这个人。

我正在使用 BackboneJS 呈现具有起始位置和结束位置的地图。在新的页面/页面刷新时，我没有收到此错误，并且地图和东西工作正常，因为我使用的是 jQuery 的 $(window).load(.....) 函数；然而，当我动态渲染我的视图时，我得到了这个错误——我相信——因为 DOM 还没有加载 DIV（由于 document.getElementById 失败）。除了 $(window).load() 之外，我已经尝试了各种不同的方法，但我无法获得适用于这两种用例的任何方法（新页面加载——BackboneJS 视图加载）。尝试在模板之后立即调用该函数也不起作用。

任何帮助，将不胜感激。

罗伯特

看法：

```
 App.Views.MapShow = Backbone.View.extend({
      initialize: function() {
        _.bindAll(this, 'render');
        var self = this;
        $(window).load(function() {
          self.renderMap();
        });
      },

      render: function() {
        this.renderTemplate();
      },

      renderTemplate: function() {
        this.$el.html(JST['path/to/show/file']());
      },

      renderMap: function() {
        var from     = this.model.get('location_from');
        var to       = this.model.get('location_to');
        var geocoder = new google.maps.Geocoder();
        var map      = new google.maps.Map(document.getElementById('mapCanvas'), {
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        var directionsService = new google.maps.DirectionsService();
        var directionsDisplay = new google.maps.DirectionsRenderer();

        directionsDisplay.setMap(map);

        var request = {
          origin: from,
          destination: to,
          travelMode: google.maps.DirectionsTravelMode.DRIVING
        };

        directionsService.route(request, function(response, status) {
          if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
          }
        });
      }
    }); 
```

HTML：

```
 <div class="map" id="mapCanvas"></div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T23:05:18.607

我猜你的问题是`#mapCanvas`在你尝试访问它之前它不在 DOM 中，所以这样：

```
document.getElementById('mapCanvas') 
```

会给你一个没用的`null`。您需要等到`#mapCanvas`它在 DOM 中才能使用它；你也不能这样做：

```
map_canvas = this.$el.find('#mapCanvas')[0]; 
```

这会给你一个有效的 ID，但你会混淆谷歌地图的功能，因为它没有大小，所以地图会奇怪地呈现。这让您在绑定 Google 地图内容之前重新等待所有内容都在 DOM 中。

解决此问题的一种方法是使用[`setTimeout`延迟为零](https://stackoverflow.com/a/9145790/479863)：

```
var _this = this;
setTimeout(function() { _this.renderMap() }, 0); 
```

这看起来有点奇怪，它确实有效，这个技巧基本上将你的`renderMap`调用转储到浏览器的工作队列中，一旦你将控制权返回给浏览器，它就会开始运行它。

您还可以使用[`_.defer`](http://underscorejs.org/#defer)：

> **推迟** `_.defer(function, [*arguments])`
> 
> 延迟调用**函数**，直到当前调用堆栈被清除，类似于使用延迟为 0 的**setTimeout**。对于在不阻塞 UI 线程更新的情况下以块执行昂贵的计算或 HTML 呈现很有用。

这可能是一个更好的选择，因为它使您的意图明确。

# java - 针对 xsd 验证 java.util.Map

> ID：11925639
> 
> 赞同：1
> 
> 时间：2012-08-12T20:29:25.500
> 
> 标签：java, xsd, jaxb, saxparser

我有一个生成 jaxb 类的 xsd。为此，我为通用地图创建了一个 XML 适配器。该适配器通过了单元测试，并且生成的变量的类型适当地是预期的映射。但问题是，当尝试验证从这种情况下创建的对象时，我得到“无法将 'hashMap' 类型解析为元素 'autoExecuteArguments' 的定义。我已经摆弄了很多，但总是以上述的一些变化结束错误。这两个绑定没有一起使用，但举例说明了试图达到某种解决方案。

```
 <xjc:javaType name="java.util.Map" xmlType="mp:MapTypeEntry"
        adapter="mil.dod.th.ose.core.impl.mp.UtilMapConverter" />

 <jaxb:bindings schemaLocation="resources/missionProgramSchema/MissionProgram.xsd">
    <jaxb:bindings node="//xs:element[@name='MissionProgramInstance']">
        <jaxb:bindings node="//xs:element[@name='autoExecuteArguments']">
            <jaxb:property>
                <jaxb:baseType name="java.util.HashMap">
                    <xjc:javaType name="java.util.Map"
                    adapter="//core.impl.mp.UtilMapConverter" />
                </jaxb:baseType>
            </jaxb:property>
        </jaxb:bindings>
    </jaxb:bindings>
</jaxb:bindings> 
```

我相信最后一个是对绑定的嘲弄，因此我无法通过大量的 tweeking 使其工作，我得到 '[ERROR] 编译器无法兑现此属性自定义。它附加到错误的位置，或者与其他绑定不一致。

接下来是转换器：

```
@XmlSeeAlso(UtilMapConverter.MapType.class)
public class UtilMapConverter<K, V> extends XmlAdapter<UtilMapConverter.MapType<K,V>, Map<K, V>> {

@Override
public UtilMapConverter.MapType<K, V> marshal(final Map<K, V> map) 
{
    final MapType<K, V> mapType = new MapType<K, V>();
    for (Map.Entry<K, V> entry : map.entrySet()) 
    {
        final MapTypeEntry<K, V> mapEntryType = new MapTypeEntry<K, V>(); 
        mapEntryType.setKey(entry.getKey());
        mapEntryType.setValue(entry.getValue());
        mapType.getEntry().add(mapEntryType);
    }
    return mapType;
}

@Override
public Map<K, V> unmarshal(final UtilMapConverter.MapType<K, V> genericMap) 
{
    final Map<K, V> map = new HashMap<K, V>();

    for (MapTypeEntry<K, V> mapEntryType : genericMap.getEntry()) 
    {
        map.put(mapEntryType.getKey(), mapEntryType.getValue());
    }
    return map;
}

@XmlAccessorType(XmlAccessType.PROPERTY)
public static class MapType<K, V> 
{
    private List<MapTypeEntry<K, V>> m_Entry = new ArrayList<MapTypeEntry<K, V>>();

    public MapType()
    {  
    }

    public MapType(final Map<K, V> map) 
    {
        for (Map.Entry<K, V> e : map.entrySet()) 
        {
            m_Entry.add(new MapTypeEntry<K, V>(e));
        }
    }
    @XmlElement
    @XmlSchemaType(name = "mapType")
    public List<MapTypeEntry<K, V>> getEntry() 
    {
        return m_Entry;
    }
    public void setEntry(final List<MapTypeEntry<K, V>> entry) 
    {
        this.m_Entry = entry;
    }
}

@XmlRootElement
@XmlAccessorType(XmlAccessType.PROPERTY)
public static class MapTypeEntry<K, V> 
{

    @XmlElement(required = true)
    @XmlSchemaType(name = "key")
    protected K m_Key;

    @XmlElement(required = true)
    @XmlSchemaType(name = "value")
    protected V m_Value;

    public MapTypeEntry() 
    {
    }

    public MapTypeEntry(final Map.Entry<K, V> entry) 
    {
        m_Key = entry.getKey();
        m_Value = entry.getValue();
    }

    @XmlElement
    public K getKey() 
    {
        return m_Key;
    }

    @XmlElement
    public V getValue() 
    {
        return m_Value;
    }
} 
```

我知道我有一个烂摊子。我只是想弄清楚什么是有帮助的，什么是伤害的，什么是愚蠢的。最后是xsd：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <xs:schema xmlns="http://core/mp/model" xmlns:xs="http://www.w3.org/2001/XMLSchema"
xmlns:jaxb="http://java.sun.com/xml/ns/jaxb" targetNamespace="http://core/mp/model"
xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc" elementFormDefault="qualified"
id="MissionProgramInstance" jaxb:version="2.1"
jaxb:extensionBindingPrefixes="xjc">
<xs:include schemaLocation="MissionProgram.xsd" />
<xs:element name="MissionProgramInstance">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="program" type="MissionProgram"
                minOccurs="1" />
            <xs:element name="autoExecuteArguments" minOccurs="0">
                <xs:annotation>
                    <xs:appinfo>
                        <jaxb:property>
                            <jaxb:baseType name="java.util.Map" />
                        </jaxb:property>
                    </xs:appinfo>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
        <xs:attribute name="autoExecuteEnabled" type="xs:boolean"
            use="required" />
        <xs:attribute name="assetDep" use="optional">
            <xs:simpleType>
                <xs:list itemType="xs:string" />
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="physicalLinkDep" use="optional">
            <xs:simpleType>
                <xs:list itemType="xs:string" />
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="linkLayerDep" use="optional">
            <xs:simpleType>
                <xs:list itemType="xs:string" />
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="transportLayerDep" use="optional">
            <xs:simpleType>
                <xs:list itemType="xs:string" />
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="imageStreamDep" use="optional">
            <xs:simpleType>
                <xs:list itemType="xs:string" />
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="programDep" use="optional">
            <xs:simpleType>
                <xs:list itemType="xs:string" />
            </xs:simpleType>
        </xs:attribute>
    </xs:complexType>
</xs:element>
<xs:complexType name="MissionProgram">
    <xs:sequence>
        <!--This field holds source data for a mission program -->
        <xs:element name="source" type="xs:string" minOccurs="1" />
    </xs:sequence>
    <xs:attribute name="name" type="xs:string" use="required" />
</xs:complexType>
<xs:complexType name="MapType">
    <xs:sequence>
        <xs:element name="autoExecuteArgument" type="MapTypeEntry">
            <xs:annotation>
                <xs:appinfo>
                    <jaxb:property>
                        <jaxb:baseType name="//core.mp.impl.UtilMapConverter.MapType" />
                    </jaxb:property>
                </xs:appinfo>
            </xs:annotation>
        </xs:element>
    </xs:sequence>
</xs:complexType>
<xs:simpleType name="MapTypeEntry">
    <xs:list itemType="xs:anySimpleType" />
</xs:simpleType>
    </xs:schema> 
```

当前的演示文稿中存在一些冗余。我是 xsd 和 jaxb 的新手。我试图弄明白这一切，但尽管试图研究，我认为我找错了地方，因为我似乎找到了碎片，但没有对所有这些一起工作的解释。这是我尝试将至少部分完全放在一起的主要资源之一：http: [//blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html](http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html)。还有用于 xml 适配器的 javadocs，以及到处浏览的内容。谢谢你，如果你花时间至少思考一下“你会做什么？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:52:13.543

我会做（并且已经做过）是编写一个干净的 xsd 并使用 xjc 生成 java 类。如果您需要更“编码器友好”的数据结构，请编写您自己的代码来在反序列化后转换 jaxb 对象。试图强制 xml 适应你认为你希望你的数据结构看起来的方式通常是一种沮丧的练习，并且随着你的项目随着时间的推移而改变，这会让你的生活变得困难。

# c - 在固定容器上拖放会改变其大小

> ID：11925643
> 
> 赞同：1
> 
> 时间：2012-08-12T20:29:54.700
> 
> 标签：c, gtk, gtk3

我用 C 语言开发了一个 gtk2 应用程序（Conky Companion）来帮助我的 conky 脚本的用户

链接：[http ://crunchbanglinux.org/forums/topic/19235/conky-weather-scripts-using-accuweatherwundergroundnwsweathercom/](http://crunchbanglinux.org/forums/topic/19235/conky-weather-scripts-using-accuweatherwundergroundnwsweathercom/)

相对轻松地创建自己的 conkyrcs。主屏幕截图如下：

[http://i.imgur.com/jWl88.jpg](http://i.imgur.com/jWl88.jpg)

用户可以从右侧向左侧拖放图标或标签，移动它们，调整它们的大小，改变它们的大小或颜色等。高兴的时候，他可以按下生成按钮并生成一个conkyrc文件。

屏幕是一个带有表格的顶部不可调整大小的窗口。桌子的两侧是放置固定容器的框架。
每当有人试图在左框架/固定容器的右边框或下边框放置图标或标签时，小部件就会越界，正如您从上面的屏幕截图中看到的那样。

我现在正在尝试将应用程序移植到 Gtk3，但我遇到了一个奇怪的问题。
每当用户尝试将对象放置或移动到左框架/固定容器的右侧或底部边框时，它都会调整自身大小以适应新放置的小部件。

[http://i.imgur.com/d1lc4.jpg](http://i.imgur.com/d1lc4.jpg)

如果我将对象向左（或向上）移动，则框架会回到由 gtk_widget_set_size_request 定义的大小。

有没有办法让一个固定的容器......固定？我不希望它调整大小。

将框架和固定容器放置在窗口中的代码如下：

```
/* LEFT FRAME */

frame1= gtk_frame_new(NULL);
gtk_table_attach(GTK_TABLE(table), frame1, 0,14,0,49,GTK_SHRINK,GTK_SHRINK,0,0);
gtk_widget_set_size_request(frame1, 360,570); 

gtk_widget_show(frame1);

/* LEFT FRAME - FIXED CONTAINER */

fixed1 = gtk_fixed_new();
gtk_widget_set_has_window(fixed1,TRUE);
gtk_container_add(GTK_CONTAINER(frame1),fixed1);
gtk_widget_modify_bg (fixed1, GTK_STATE_NORMAL, &color);

gtk_drag_dest_set (
    fixed1, GTK_DEST_DEFAULT_ALL,
    target_list, 1, GDK_ACTION_COPY|GDK_ACTION_MOVE);

g_signal_connect (fixed1, "drag-drop",G_CALLBACK (dr_data_rec_1d1), (gpointer)fixed1);

gtk_widget_show(fixed1); 
```

我尝试了以下事情：
1）摆弄 GTK_EXPAND 和 GTK_FILL 来放置框架。没变。
2) gtk_window_set_geometry_hints 用于窗口、表格、框架和固定容器。没变。
3) 用 gtk_grid 替换 gtk_table。没变。

我不知道该做什么或要搜索什么；我什至不知道问题出在窗口、表格、框架、固定容器还是在一些不起眼的拖放设置中。

如果解决方案简单和/或明显，期待任何提示和抱歉。

# c++ - 如何在“所有输出”窗口中查看 Xcode 中 Google Test 的彩色输出？

> ID：11925644
> 
> 赞同：3
> 
> 时间：2012-08-12T20:30:03.063
> 
> 标签：c++, xcode, unit-testing, googletest

我是 Xcode（和一般的 Mac）的新手，我正在尝试将我的一些代码库移植到 OS X 和 iOS 上运行。我有大量针对 Google C++ 测试框架（Google 测试）编写的单元测试。我成功编译了框架并且可以运行一些测试，但我不确定如何从 Xcode 中查看彩色输出。

我习惯于在 Visual Studio 中点击“运行”并立即看到一个控制台窗口（带有颜色），让我一眼就知道测试是通过还是失败。

我设法设置了一个“运行脚本”“构建阶段”，但这似乎只输出到日志导航器，它消除了颜色，甚至是固定宽度的输出，如果测试通过，很难一目了然. 运行测试后，我也找不到显示日志的方法。当我这样做时，“所有输出”窗口中不会出现任何内容。

我玩过 XcodeColors，但这似乎不适用于使用 ANSI 颜色代码的脚本。

在这一点上，如果这根本无法在 Xcode 中完成，我不会感到惊讶。那将是理想的，但如果不是，是否可以创建一个“运行脚本”来在独立的终端窗口中运行测试？颜色在那里工作得很好。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T01:29:28.050

Here are links to a tool that colorizes the text in the Log window. It's free and the source is in github so you can figure out how it works. The first link says that it just uses simple ANSI codes to do the job.

[http://deepitpro.com/en/articles/XcodeColors/info](http://deepitpro.com/en/articles/XcodeColors/info)
[https://github.com/robbiehanson/XcodeColors#readme](https://github.com/robbiehanson/XcodeColors#readme)

To kick off the execution from within Xcode, you will probably need to add a new target to your project. To add a Target, click on your project and then there is an Add Target button on the bottom of the screen. I don't know exactly what you're executing but here are my best guesses based on your question:

*   MacOSX/Application/Cocoa-AppleScript or Command Line Tool - Create a simple script or program that will execute your units tests.
*   MacOSX/Other/External Build System - Allows for execution of an external "make" program with args.

Once you have a way to execute your unit tests, you just need to figure out how to route the output from the unit tests to the Log window. If you can edit the Google Test project and make it use `NSLog()`, that would seem to be the easiest solution. You could create your own logging method, perform the ANSI colorization, and then send the final text to `NSLog()`.

**ADDED**: OK. Interesting findings... Read all before starting. Here's what to do:

Start AppleScript Editor. This is in LaunchPad. Paste the following script into it:

```
tell application "Terminal"
    activate
    do script "<your commands>" in window 1
end tell 
```

You can repeat the "do script" line as needed. Use this to execute your unit tests. In Script Editor, do Save As.../File Format=Script and save it to a safe location for now like your Documents directory. This will create a file like "UnitTests.scpt".

Now go to your iOS project. Select the project at the top-left. Select the Build Phases tab top-middle. Click the Add Build Phase button on the bottom right. Here's the interesting part.

Leave Shell as is ("/bin/sh"). Add one line:

```
osascript ~/Documents/UnitTests.scpt 
```

That will execute the script after every build.

But here's the interesting part I found. Click on Build Settings (top-middle). Make sure All is selected (not Basic). Scroll down the list to find Unit Testing. Open Test Host. Hit the + next to Debug. You can also put the above `osascript` command here. You might be able to execute your unit tests here and if you can, the output will likely show up in the Log! Let me know what happens.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T23:05:07.993

我熟悉 Java：JUnit + JCodecoverage，在移动应用程序：Android 和 iPhone 我懒得用 TDD 开发，但如果我想开始的话：

我将创建一个 Hello Word 应用程序，并打开 JUnitTesting 选项：检查包括单元测试

![在此处输入图像描述](../Images/9f61be51764898b35281a990b0f0caba.png)

这将创建一个测试应用程序/目标，您将能够运行它。在 Android 上也是如此：你必须创建一个“测试项目”一旦我做了并且忘记了它是如何工作的，但是，还有其他的东西： - 长按 Xcode 上的播放按钮（ 4.4 ），你将拥有一个下拉菜单：运行、测试、配置文件、分析。

我无法呈现这些，因为如果我按 Shift+ Cmd + 4 截屏，它会发生变化，但这里看起来像是更改后的菜单： ![在此处输入图像描述](../Images/04860d9fd892b472d3d3b30a4bccf015.png)

恕我直言：对于银行、外汇、其他金融或军事（高安全性软件），我会使用测试驱动开发，代码覆盖率超过 99%，但那些简单的 3-4 网络服务调用移动应用程序，它们显示浏览器中可用的公共数据只是浪费时间开发测试和维护它！

很多时候我需要在没有互联网连接的情况下进行测试。更糟糕的情况是 WI-FI 连接，但是路由器不给 IP 也不放开手机，但是如果我问手机状态：它已连接...

GUI 流很难通过单元测试进行测试，其中 / 对我有用：从 Web 服务获取的数据以及与内部缓存的同步。正如我所见，通过手动测试来做这件事仍然更便宜。

# c - pppd popen 挂在 C 中

> ID：11925646
> 
> 赞同：1
> 
> 时间：2012-08-12T20:30:18.430
> 
> 标签：c, linux, popen, pppd

我在我的程序中使用 popen 启动 pppd，以使获取 IP 地址和接口名称更容易一些。我的代码独立运行良好，是一个非常典型的实现。当它在整个程序中运行（太大而无法发布）时，问题就开始了……循环似乎在 fgets() 行中挂了很长一段时间。popen 在自己的线程中启动，然后根据输出进行管理。

popen/pppd 代码基本上如下。

```
int main(void){
    pthread_create(&thread, NULL, pppd, (char *)NULL);
    pthread_join(thread, NULL);

    return 0;
}

void *pppd(char *args){
    char* command = malloc(32);

    sprintf(command, "pppd %s call %s", dev, provider);
    pppd_stream = popen(command, "r");

    if(pppd_stream == NULL){
        pppd_terminated = TRUE;
        return;
    }

    free(command);

    while(fgets(buffer, 128, d->pppd_stream) != NULL){

        //handle_output
    }

} 
```

CPU 使用率不是问题，系统和程序的其他部分仍然响应并按预期运行。

关于什么可能导致这种放缓的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:14:17.660

确保您的命令是以**空字符结尾的字符串**：

```
#define COMMAND_BUFFER_SIZE    256   /* Modify this if you need */

snprintf(command, COMMAND_BUFFER_SIZE, "pppd %s call %s", dev, provider);
command[COMMAND_BUFFER_SIZE - 1] = '\0';
pppd_stream = popen(command, "r"); 
```

**编辑：**

检查您的`fgets`：

```
while(fgets(buffer, 128, d->pppd_stream) != NULL){ 
```

你可能想要这个：

```
while(fgets(buffer, 128, pppd_stream) != NULL){ 
```

# android - 谷歌的 Android OpenGL 教程教的线性代数不正确吗？

> ID：11925647
> 
> 赞同：31
> 
> 时间：2012-08-12T20:30:20.583
> 
> 标签：android, opengl-es, linear-algebra

在帮助另一位用户解决有关[响应触摸事件](http://developer.android.com/training/graphics/opengl/touch.html)Android 教程的问题后，我下载了源代码，并且对我所看到的内容感到非常困惑。该教程似乎无法决定是要使用行向量还是列向量，而且在我看来一切都混在一起了。

在 Android Matrix 页面上，他们声称他们的约定是列向量/列优先，这是 OpenGL 的典型。

我是对的，还是我遗漏了什么？以下是它的相关部分：

首先通过乘以 mProjMatrix * mVMatrix 创建一个 MVPMatrix。到目前为止，一切都很好。

```
 // Set the camera position (View matrix)
    Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f);

    // Calculate the projection and view transformation
    Matrix.multiplyMM(mMVPMatrix, 0, mProjMatrix, 0, mVMatrix, 0) 
```

* * *

接下来他们要在 MVPMatrix 的左侧附加一个旋转？这似乎有点奇怪。

```
 // Create a rotation for the triangle
    Matrix.setRotateM(mRotationMatrix, 0, mAngle, 0, 0, -1.0f);

    // Combine the rotation matrix with the projection and camera view
    Matrix.multiplyMM(mMVPMatrix, 0, mRotationMatrix, 0, mMVPMatrix, 0) 
```

* * *

以非转置顺序上传。

```
 GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mvpMatrix, 0); 
```

* * *

最后在他们的着色器中，向量*矩阵乘法？

```
 // the matrix must be included as a modifier of gl_Position
    "  gl_Position = vPosition * uMVPMatrix;" 
```

* * *

将这些加在一起，我们得到：

```
gl_Position = vPosition * mRotation * mProjection * mView; 
```

根据我的任何想象，这是不正确的。关于这里发生的事情，有什么我没有看到的解释吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-06T23:15:48.937

作为编写 OpenGL 教程的人，我可以确认示例代码不正确。具体来说，着色器代码中因子的顺序应该颠倒：

```
"  gl_Position = uMVPMatrix * vPosition;" 
```

对于旋转矩阵的应用，也应将因子的顺序颠倒，使旋转为最后一个因子。经验法则是矩阵按从右到左的顺序应用，首先应用旋转（它是“MVP”的“M”部分），所以它需要是最右边的操作数。此外，您应该按照 Ian Ni-Lewis 的建议使用临时矩阵进行此计算（请参阅下面的更完整答案）：

```
float[] scratch = new float[16];
// Combine the rotation matrix with the projection and camera view
Matrix.multiplyMM(scratch, 0, mMVPMatrix, 0, mRotationMatrix, 0); 
```

感谢您关注此问题。我会尽快修复培训课程和示例代码。

**编辑：**这个问题现在已在可下载的示例代码和 OpenGL ES 培训课程中得到纠正，包括对因素正确顺序的评论。感谢您的反馈，伙计们！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-07T02:36:15.553

该教程是不正确的，但许多错误要么相互抵消，要么在这个非常有限的上下文中不明显（固定相机以 (0,0) 为中心，仅围绕 Z 旋转）。旋转是向后的，但除此之外它看起来是正确的。（要了解错误的原因，请尝试使用不那么简单的相机：例如，将 eye 和 lookAt 设置为 y=1。）

使调试变得非常困难的一件事是 Matrix 方法不会对其输入进行任何别名检测。教程代码使您看起来可以调用 Matrix.multiplyMM 并使用相同的矩阵作为输入和结果。这不是真的。但是因为实现一次乘以一列，所以如果重用右侧（如在当前代码中，其中 mMVPMatrix 是 rhs 和结果），则与重用左侧相比，出现问题的可能性要小得多. 在写入结果中的相应列之前读取左侧的每一列，因此即使 LHS 被覆盖，输出也将是正确的。但如果右侧与结果相同，则其第一列将在读取完成之前被覆盖。

所以教程代码处于某种局部最大值：它似乎可以工作，如果你改变任何一个东西，它就会非常糟糕。这导致人们相信它看起来是错误的，它可能只是正确的。;-)

无论如何，这里有一些替换代码可以得到我认为的预期结果。

Java代码：

```
@Override
public void onDrawFrame(GL10 unused) {
    float[] scratch = new float[16];

    // Draw background color
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);

    // Set the camera position (View matrix)
    Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f);

    // Calculate the projection and view transformation
    Matrix.multiplyMM(mMVPMatrix, 0, mProjMatrix, 0, mVMatrix, 0);

    // Draw square
    mSquare.draw(mMVPMatrix);

    // Create a rotation for the triangle
    Matrix.setRotateM(mRotationMatrix, 0, mAngle, 0, 0, 1.0f);

    // Combine the rotation matrix with the projection and camera view
    Matrix.multiplyMM(scratch, 0, mMVPMatrix, 0, mRotationMatrix, 0);

    // Draw triangle
    mTriangle.draw(scratch);
} 
```

着色器代码：

```
gl_Position =  uMVPMatrix * vPosition; 
```

注意：这些修复使投影正确，但它们也反转了旋转方向。那是因为原始代码以错误的顺序应用了转换。可以这样想：不是顺时针旋转物体，而是逆时针旋转相机。当您固定操作顺序以便将旋转应用于对象而不是相机时，对象开始逆时针移动。不是矩阵错了；这是用于创建矩阵的角度。

因此，要获得“正确”的结果，您还需要翻转 mAngle 的符号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-04T08:36:35.193

我解决了这个问题如下：

```
@Override
public void onDrawFrame(GL10 unused) {      
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);

    Matrix.setLookAtM(mViewMatrix, 0, 0, 0, -1f, 0f, 0f, 0f, 0f, 1.0f, 0.0f);        

    Matrix.setRotateM(mModelMatrix, 0, mAngle, 0, 0, 1.0f);
    Matrix.translateM(mModelMatrix, 0, 0.4f, 0.0f, 0);

    mSquare.draw(mProjMatrix,mViewMatrix,mModelMatrix);
}

@Override
public void onSurfaceChanged(GL10 unused, int width, int height) {
    ...  
    Matrix.frustumM(mProjMatrix, 0, -ratio, ratio, -1, 1, 1, 99);

}

class Square {

    private final String vertexShaderCode =
        "uniform mat4 uPMatrix; \n" +
        "uniform mat4 uVMatrix; \n" +
        "uniform mat4 uMMatrix; \n" +

        "attribute vec4 vPosition; \n" +
        "void main() { \n" +
        "  gl_Position = uPMatrix * uVMatrix * uMMatrix * vPosition; \n" +
        "} \n";

    ...

    public void draw(float[] mpMatrix,float[] mvMatrix,float[]mmMatrix) {

        ...

        mPMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uPMatrix");
        mVMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uVMatrix");
        mMMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMMatrix");

        GLES20.glUniformMatrix4fv(mPMatrixHandle, 1, false, mpMatrix, 0);
        GLES20.glUniformMatrix4fv(mVMatrixHandle, 1, false, mvMatrix, 0);
        GLES20.glUniformMatrix4fv(mMMatrixHandle, 1, false, mmMatrix, 0);

        ...
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T06:19:26.927

我正在解决同样的问题，这就是我发现的：

我相信乔的样本是正确的，
包括着色器代码中因素的顺序：

```
gl_Position = vPosition * uMVPMatrix; 
```

为了验证它，只需尝试以相反的因子顺序旋转三角形，它会将三角形拉伸到 90 度的消失点。

真正的问题似乎出在**setLookAtM**函数中。
在 Joe 的示例中，参数为：

```
Matrix.setLookAtM(mVMatrix, 0,
     0f, 0f,-3f,   0f, 0f, 0f,   0f, 1f, 0f ); 
```

这也是完全合乎逻辑的。
但是，生成的视图矩阵对我来说看起来很奇怪：

```
-1  0  0  0
 0  1  0  0
 0  0 -1  0
 0  0 -3  1 
```

正如我们所见，这个矩阵将反转 X 坐标，因为第一个成员是 –1，
这将导致屏幕上的左/右翻转。
它也会反转 Z 顺序，但让我们在这里关注 X 坐标。

我认为**setLookAtM**函数也可以正常工作。
但是，由于 Matrix 类不是 OpenGL 的一部分，它可以使用其他一些坐标系统，
例如 - Y 轴指向下方的常规屏幕坐标。
这只是一个猜测，我并没有真正验证这一点。

可能的解决方案：
我们可以手动构建想要的视图矩阵，
代码是：

```
Matrix.setIdentityM(mVMatrix,0);
mVMatrix[14] = -3f; 
```

或者
我们可以尝试通过给**setLookAtM**函数提供反转的相机坐标来欺骗它：0、0、+3（而不是 –3）。

```
Matrix.setLookAtM(mVMatrix, 0,
     0f, 0f, 3f,   0f, 0f, 0f,   0f, 1f, 0f ); 
```

生成的视图矩阵将是：

```
1  0  0  0
0  1  0  0
0  0  1  0
0  0 -3  1 
```

这正是我们所需要的。
现在相机的行为与预期一样，
并且示例可以正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-20T22:32:55.657

使用当前更新的 Android 示例代码时，没有其他建议对我有用，除了以下尝试移动三角形时的建议。

以下链接包含答案。花了一天多的时间才找到它。在这里发帖是为了帮助别人，因为我多次看到这篇文章。[OpenGL ES Android 矩阵变换](https://stackoverflow.com/questions/13480043/opengl-es-android-matrix-transformations?rq=1)

# html - 如何将从谷歌自定义搜索 API 获取的数据放入复选框列表

> ID：11925649
> 
> 赞同：0
> 
> 时间：2012-08-12T20:30:26.930
> 
> 标签：html, checkbox, javascript

我有一个从谷歌自定义搜索 API 获取数据的代码，自定义搜索 API 部分没有问题，它检索数据没有任何错误

```
<html>
  <head>
    <title>JSON Custom Search API Example</title>
  </head>
  <body>
    <div id="content"></div>
    <script>
    var pageName = new Array();
    var pageLink = new Array();
    var pageDetails = new Array();

      function hndlr(response) {
      for (var i = 0; i < response.items.length; i++) {
       var item = response.items[i];

        pageName[i] = item.title;
        pageLink[i] = item.link;
        pageDetails[i] = item.htmlSnippet;

      }
    }

    // Some codes

    var search_query = 'https://www.googleapis.com/customsearch/v1?key=MY_KEY&cx=XXXXXXXXX&q='+query+'&start=1&callback=hndlr';
    s = document.createElement('script');
    s.src = search_query;
    document.getElementsByTagName('head')[0].appendChild(s); 
    </script>     
  </body>
</html> 
```

**所需数据保存在 pageName、pageLink 和 pageDetails 数组**中。
现在我想用 chechboxes 显示它们并允许用户选择它们。
我需要获取所选站点的链接（pageLink 变量）并使用 POST 方法将其传递给另一个文件，
我尝试在 body tag() 结束之前使用波纹管代码

```
<form action="b.php" method="post">
<script>
for (var j = 0; j < 5; j++) {
document.write("<input type='checkbox' name='formDoor[]' id='"+j+"' value= '' />"+pageName[j]+"<br />"); 
document.getElementById(j).value = pageLink[j]; 
}
</script>
<input type="submit" name="formSubmit" value="Submit" />
</form> 
```

但在另一个文件中，它说变量是未定义的。似乎变量没有传递给“b.php”文件

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T11:29:54.557

您当前用于添加复选框的代码可能会在搜索结果到达之前执行（即：`hndlr`执行之前），因此所有数组仍然为空。解决方案是将复选框创建代码移动到`hndlr`函数中。

这是固定页面。

```
<html>
  <head>
    <title>JSON Custom Search API Example</title>
  </head>
  <body>
    <div id="content"></div>

    <form id="bform" action="b.php" method="post">
      <input type="submit" name="formSubmit" value="Submit" />
    </form>

    <script>
    var pageName = new Array();
    var pageLink = new Array();
    var pageDetails = new Array();

    function hndlr(response) {
      var f=document.getElementById('bform'), prev=f.children[0];
      for (var i = 0; i < response.items.length; i++) {
        var ele, item = response.items[i];

        pageName[i] = item.title;
        pageLink[i] = item.link;
        pageDetails[i] = item.htmlSnippet;

        ele = document.createElement('BR');
        f.insertBefore(ele, prev);
        prev = ele;

        ele = document.createTextNode(pageName[i]);
        f.insertBefore(ele, prev);
        prev = ele;

        ele = document.createElement('INPUT');
        ele.type = 'checkbox';
        ele.name = 'formDoor[]';
        ele.id = i;
        ele.value = encodeURI(pageLink[i]);
        f.insertBefore(ele, prev);
        prev = ele;
      }
    }

    // Some codes

    var search_query = 'https://www.googleapis.com/customsearch/v1?key=MY_KEY&cx=XXXXXXXXX&q='+query+'&start=1&callback=hndlr';
    s = document.createElement('script');
    s.src = search_query;
    document.getElementsByTagName('head')[0].appendChild(s); 
    </script>

  </body>
</html> 
```

# sas - SAS比较两个文本文件（Unix / Windows）

> ID：11925658
> 
> 赞同：0
> 
> 时间：2012-08-12T20:31:26.577
> 
> 标签：sas, checksum, sas-macro

我需要比较两个文本文件（在不同的目录中），看看它们是否不同（二进制结果很好）。给定如下数据集，这可能在数据步中吗？

```
Pathname
c:\one\text1.txt
c:\two\text1.txt
c:\one\text2.txt
c:\two\text2.txt 
```

或者，宏代码会很好！校验和是一种可能性，我需要代码在 windows 和 unix 中运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T09:54:24.063

将其传递到命令行（通过管道文件引用）

在 Windows 中，使用“comp”命令。

在 Unix 中，使用 'diff' 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:24:04.393

感谢 Chris J - 这对我有用：

```
%let root=%sysfunc(pathname(work));
data;
file "&root.\x.txt";
put 'xxx';
data;
file "&root.\x2.txt";
put 'xx x';
filename x pipe "diff &root.\x.txt &root.\x2.txt ";
data;
infile x;
input x $1000.;
run; 
```

# php - SQL 查询很好，但得到错误

> ID：11925660
> 
> 赞同：-1
> 
> 时间：2012-08-12T20:31:32.483
> 
> 标签：php, mysql

我有以下代码：

```
function GetSetting($key)
{
    $Result = mysql_query("SELECT * FROM settings WHERE keys='$key'") or die(mysql_error());
    while($Row = mysql_fetch_array($Result))
    {
        return $Row['value'];
    }
    return false;
} 
```

但我收到以下错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'keys='header_title'' 附近使用正确的语法

我的 SQL 查询有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-12T20:32:48.393

`keys`是一个[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，所以你必须转义它：

```
SELECT ... WHERE `keys`='$key';
                 ^----^-- 
```

换句话说，您的查询实际上并不好，而 MySQL 正在告诉您问题出在哪里……

# python - 什么是当地时区

> ID：11925664
> 
> 赞同：1
> 
> 时间：2012-08-12T20:32:33.450
> 
> 标签：python, datetime, timezone

假设服务器 (gae) 位于美国西海岸 (PST)，约会时间是上午 10:00 在纽约市 (EST)，而芝加哥 (CST) 的人正在使用他的设备了解约会时间纽约市。

CST 中芝加哥设备中的人如何在她访问位于 EST 的网站时看到约会是在上午 10 点，并且在 MST 中的开发人员如何设置日期时间、时间和时间参数是否重要？使用python的日历？

另外，这里的“当地时间”是什么时区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:59:51.187

第三方模块[pytz](http://pytz.sourceforge.net/)提供了一种在时区之间转换的简单方法。例如，

```
import datetime as dt
import pytz

utc = pytz.utc
western = pytz.timezone('US/Pacific')
newyork = pytz.timezone('America/New_York')
chicago = pytz.timezone('America/Chicago') 
```

假设有人在纽约上午 10 点创建约会：

```
date = dt.datetime(2012, 8, 12, 10)    # naive datetime
print(date)
# 2012-08-12 10:00:00  

# localize converts naive datetimes to timezone-aware datetimes.
date_in_newyork = newyork.localize(date)  # timezone-aware datetime
print(date_in_newyork)
# 2012-08-12 10:00:00-04:00 
```

您在西海岸的服务器应将此日期时间存储为 UTC：

```
# astimezone converts timezone-aware datetimes to other timezones.
date_in_utc = date_in_newyork.astimezone(utc)
print(date_in_utc)
# 2012-08-12 14:00:00+00:00 
```

现在，当芝加哥的人想知道约会的时间时，服务器可以将 UTC 转换为芝加哥时间、纽约时间或其他时间：

```
date_in_chicago = date_in_utc.astimezone(chicago)
print(date_in_chicago)
# 2012-08-12 09:00:00-05:00

date_in_newyork2 = date_in_utc.astimezone(newyork)
print(date_in_newyork2)
# 2012-08-12 10:00:00-04:00 
```

# linq - 从列表中删除一个列表，其中 list1.a 等于 list2.a 与 linq

> ID：11925666
> 
> 赞同：-1
> 
> 时间：2012-08-12T20:32:39.303
> 
> 标签：linq

我有一份责任清单和一份具有共同领域合同的稀释清单。我需要在责任清单中删除稀释清单中存在的所有合同，我想用 Linq 来做。

到目前为止，我一直试图解决这个问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T01:02:50.257

这可以解决问题：

```
var deletions =
    from a in accountables
    join d in dilutions on a.Contract equals d.Contract into gds
    where gds.Any()
    select a;

foreach (var d in deletions.ToArray())
{
    accountables.Remove(d);
} 
```

# javascript - 无法使用javascript从数组中获取值

> ID：11925667
> 
> 赞同：-1
> 
> 时间：2012-08-12T20:32:44.510
> 
> 标签：javascript

我试图从回调数组中获取纬度和经度。数组有时内部有一个对象，有时有 2 个对象。

> 对象{地点={...}，参考={...}}或[对象{地点={...}，参考={...}}，对象{地点={...}，参考={...}}]

```
 Placemaker.getPlaces(text,function(o){
    console.log(o);
    if (typeof o.match!=='undefined' || o.length==1){
     latitude=o.match.place.centroid.latitude, longitude=o.match.place.centroid.longitude; 
     console.log(latitude,longitude);}
     /*else if(o=='null'){
         latitude='', longitude=''; 
     }*/
     else if (typeof o.match[0]!=='undefined' || o.match.length==2){
        latitude=o.match[0].place.centroid.latitude, longitude=o.match[0].place.centroid.longitude; 
     console.log(latitude,longitude);
     } 
```

基本上我可以从具有一个对象的数组中获取纬度和经度，而不是从内部有两组对象时获取。这是我得到的错误

```
TypeError: o.match is undefined
[Break On This Error]   

else if (typeof o.match[0]!=='undefined' || o.match.length==2){ 
```

感谢大家的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:28:27.477

我认为您在屏幕截图中显示的是这个 javascript 数据结构：

```
var match = [
    {
        place: {
            centroid: {latitude: xx, longitude: yy},
            name: "London, England",
            type: "Town",
            woeld: "44418"
        }
        reference: {...}
    },
    {
        place: {
            centroid: {latitude: xx, longitude: yy},
            name: "Germany",
            type: "Country",
            woeld: "23424829"
        }
        reference: {...}
    }
]; 
```

您可以像这样访问数组中每个元素的纬度和经度：

```
for (var i = 0; i < match.length; i++) {
    var centroid = match[i].place.centroid;
    // latitude is centroid.latitude
    // longitude is centroid.longitude
} 
```

# c++ - c++中类的循环，如何使用它们的构造函数

> ID：11925669
> 
> 赞同：0
> 
> 时间：2012-08-12T20:32:48.257
> 
> 标签：c++, class, constructor

我需要两个形成循环的班级，都有自己的成员，但还有其他班级的副本，让我们考虑这个例子。

```
class lower; 
class upper{
    int uA;
    lower L;
    upper(){
    uA=0;   
    //how to initialize lower here using lower's constructor 
    }
};

class lower{
    int lA;
    upper U;
    lower(){
    lA=0; 
    //how to initialize upper here using upper's constructor 
   }

}; 
```

现在我需要`upper L`main() 中的上部对象；我希望它的所有变量都初始化为零（对于默认构造函数），但我现在不知道如何处理这些构造函数的循环，所以`lower L`在上部 初始化

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:50:09.763

你可以使用这样的东西：

```
class upper;
class lower{
    friend class upper;
    int lA;
    upper* U;
    void setUpper(upper* u)
    {
        U = u;
    }
    public:

    lower(){
    lA=0; 
    U = 0; 
   }
};

class upper{
    int uA;
    lower* L;
    public:
    upper(lower* l){
    uA=0;   
    L = l;
    l->setUpper(this); 
    }
};

int main()
{
    lower* l = new lower();
    upper* u = new upper(l);
    return 0;
} 
```

虽然需要添加析构函数来清理指针，但还是酌情从上层删除下层？

此外，您应该调查您的数据结构，看看是否可以摆脱循环依赖——这可能会在未来给您带来问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:44:44.003

像这样，（正如 KennyTM 所说你需要使用指针）

```
class lower; 

class upper
{
    int uA;
    lower* L;
    upper() : uA(0), L(new L)
    {
    }
};

class lower
{
    int lA;
    upper* U;
    lower() : lA(0), U(new U)
    {
    }
}; 
```

这段代码有很多问题，但希望它能回答你的问题。

# c# - C# 最小化对话框窗体不是父窗体

> ID：11925670
> 
> 赞同：2
> 
> 时间：2012-08-12T20:32:51.483
> 
> 标签：c#, forms

我有按程序最小化的问题。它有主要形式和其他形式，我通过 ShowDialog() 打开

问题在于最小化这些对话框形式。当我在 Windows7 上的朋友最小化此对话框时，它会最小化对话框和主窗体（对话框不在任务栏中，我禁用了它），但在我的 Windows7 上，只有这样的对话框被最小化

![最小化对话框的屏幕](../Images/6217b96a4d7b8761841b74b0c910130a.png)

这里有机会最小化这两种形式吗？我发现，在最小化表单后，会触发 Resize 事件，所以我做了这个

```
 private void ShowCode_Resize(object sender, EventArgs e)
    {
        if (WindowState == FormWindowState.Minimized)
        {
            main.WindowState = FormWindowState.Minimized;
        }
    } 
```

但是当我点击任务栏中的表单时，显示主表单并关闭对话框，我不知道为什么？这里有任何机会，总是将其最小化到任务栏吗？为什么在我的电脑上它以这种方式工作，而在朋友的其他方式上？我不知道我更改了 Windows 设置中的某些内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:58:21.647

如果我理解正确 - 我在问了类似问题后找到了解决方案。

只需 `Show();` 在 Form2 的事件处理程序末尾添加：

在[这里查看](https://stackoverflow.com/a/8705846/939213)（以及其他答案。）

# r - 参考的 R 文档格式

> ID：11925671
> 
> 赞同：1
> 
> 时间：2012-08-12T20:32:54.837
> 
> 标签：r

在手册中记录参考时，编译包时正确显示参考所需的必要转义和格式是什么？例如，以下是为 R 文档格式化 APA6 样式参考的尝试。

```
\references{
Heylighen, F., \\& Dewaele, J.M. (2002). Variation in the contextuality of language: An
    empirical measure. Context in Context, Special issue of Foundations of Science, 7 (3),
    293-340.
} 
```

我需要做什么才能让它看起来像这样：

```
Heylighen, F., & Dewaele, J.M. (2002). Variation in the contextuality of language: 
    An empirical measure. Context in Context, Special issue of Foundations of Science, 
    7 (3), 293-340. 
```

也许此信息位于某处的某些 R 文档中。如果是这种情况，请指导我阅读这段话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T20:52:16.193

基于具有引用部分的[.Rd 文件](http://svn.r-project.org/R/trunk/src/library/stats/man/lm.Rd)，我认为您根本无法逃脱＆符号。

# visual-c++ - C++/CLI - 用未知数量的空格分割字符串作为分隔符？

> ID：11925672
> 
> 赞同：1
> 
> 时间：2012-08-12T20:33:04.233
> 
> 标签：visual-c++, c++-cli

我想知道如何（以及最好以哪种方式）在 C++/CLI 中拆分具有未知数量空格的字符串作为分隔符？

编辑：问题是空间号是未知的，所以当我尝试使用这样的拆分方法时：

```
String^ line;
StreamReader^ SCR = gcnew StreamReader("input.txt");
while ((line = SCR->ReadLine()) != nullptr && line != nullptr)
{
     if (line->IndexOf(' ') != -1)
        for each (String^ SCS in line->Split(nullptr, 2))
        {
            //Load the lines...

        }
} 
```

这是 Input.txt 的外观示例：

```
ThisISSomeTxt<space><space><space><tab>PartNumberTwo<space>PartNumber3 
```

然后当我尝试运行程序时，加载的第一行是“ThisISSomeTxt”，加载的第二行是“”（无），加载的第三行也是“”（无），第四行也是""什么都没有，加载的第五行是“PartNumberTwo”，第六行是PartNumber3。

我只希望加载 ThisISSomeTxt 和 PartNumberTwo :? 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:45:12.323

为什么不直接使用[System::String::Split(..)](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:48:50.037

以下代码示例取自[http://msdn.microsoft.com/en-us/library/b873y76a(v=vs.80).aspx#Y0](http://msdn.microsoft.com/en-us/library/b873y76a(v=vs.80).aspx#Y0)，演示了如何使用 Split 方法标记字符串。

```
using namespace System;
using namespace System::Collections;
int main()
{
   String^ words = "this is a list of words, with: a bit of punctuation.";
   array<Char>^chars = {' ',',','->',':'};
   array<String^>^split = words->Split( chars );
   IEnumerator^ myEnum = split->GetEnumerator();
   while ( myEnum->MoveNext() )
   {
      String^ s = safe_cast<String^>(myEnum->Current);
      if (  !s->Trim()->Equals( "" ) )
            Console::WriteLine( s );
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T17:41:41.020

我认为你可以用 String.Split 方法做你需要做的事情。

首先，我认为您期望 'count' 参数以不同的方式工作：您传入`2`，并期望返回第一个和第二个结果，并抛出第三个结果。它实际返回的是第一个结果，第二个和第三个结果连接成一个字符串。如果你想要的只是`ThisISSomeTxt`and `PartNumberTwo`，你会想要在前 2 个之后手动丢弃结果。

据我所知，您不希望在返回字符串中包含任何空格。如果是这样的话，我认为这就是你想要的：

```
String^ line = "ThisISSomeTxt   \tPartNumberTwo PartNumber3";
array<String^>^ split = line->Split((array<String^>^)nullptr, StringSplitOptions::RemoveEmptyEntries);
for(int i = 0; i < split->Length && i < 2; i++)
{
    Debug::WriteLine("{0}: '{1}'", i, split[i]);
} 
```

结果：

```
0: 'ThisISSomeTxt'
1: 'PartNumberTwo' 
```

# linq - 从孙辈中选择价值

> ID：11925676
> 
> 赞同：0
> 
> 时间：2012-08-12T20:33:40.733
> 
> 标签：linq, entity-framework

我有以下表结构：

![表结构](../Images/6a3933437b4a9a8eddc78ae011bf0813.png)

我要选择：

*   表 C 中的所有表 A 条目 + 标识符列具有：
    *   TableBType 中的特殊值（“TableBTypeValue”）
    *   TableCType 中的特殊值（“TableCTypeValue”）

我遇到的问题是，当存在没有 TableB 条目的 TableA 条目或没有 TableC 的 TableB 条目时 linq 查询似乎失败（TableBType 和 TableCType 是强制性的，因此它们没有那个问题）。

使用 SQL 这不会是一个大问题，但是由于我是 linq 新手，所以我找不到创建此查询的正确方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:46:43.003

我认为这就是你要找的：

```
from c in db.TableC
where c.TableCType == TableCTypeValue
join b in db.TableB on c.TableBId equals b.Id
where b.TableBType == TableBTypeValue
join a in db.TableA on b.TableAId equals a.Id
select new { a, c.Identifier }; 
```

希望能帮助到你。

# php - PHP 中的 ["$field"] 是如何工作的？

> ID：11925678
> 
> 赞同：1
> 
> 时间：2012-08-12T20:33:46.837
> 
> 标签：php

嗨，我在理解下面的代码时遇到问题：

```
foreach ($_POST as $field=>$value) { 
   $this->ipn_data["$field"] = $value;
   $post_string .= $field.'='.urlencode(stripslashes($value)).'&'; 
} 
```

做什么`$this->ipn_data["$field"] = $value`？我需要一些例子来理解这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:44:49.267

以下行：

```
$this->ipn_data["$field"] = $value; 
```

需要结合上下文来理解。$this 关键字是指执行代码的当前对象。

例如，考虑一下：

```
<?php

class Car {
    private $make = "Toyota";
    private $model = "Corolla";
    public function getDescription() {
        return $this->make . " " . $this->model;
    }
}

?> 
```

在您的情况下， $this->ipn_data 是该类的成员，并且是一个数组。$field 被设置为数组中的键，$value 被分配给 ipn_data 数组中的新键。

# android - 设置 NumberPicker 的增减间隔

> ID：11925681
> 
> 赞同：5
> 
> 时间：2012-08-12T20:34:04.367
> 
> 标签：android

是否可以将 NumberPicker 的增加/减少间隔设置为其他值？例如到 50（50、100、150、200、250 等）？还是需要一些定制/破解？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-12T23:07:22.810

我认为你可以这样做：

*   为您的选择器初始化[显示的数组值](http://developer.android.com/reference/android/widget/NumberPicker.html#setDisplayedValues%28java.lang.String%5B%5D%29)：

    ```
    int NUMBER_OF_VALUES = 10; //num of values in the picker
    int PICKER_RANGE = 50;
    ...
    String[] displayedValues  = new String[NUMBER_OF_VALUES];
    //Populate the array
    for(int i=0; i<NUMBER_OF_VALUES; i++)
        displayedValues[i] = String.valueOf(PICKER_RANGE * (i+1));
    /* OR: if the array is easy to be hard-coded, then just hard-code it:
       String[] displayedValues = {"50", "100", "150", .....}; */ 
    ```

*   将显示的数组设置为您的选择器：

    ```
    /* 
    NOTE: Your picker range has to be [0, displayedValues.size()-1] to be 
          consistent with the array index (displayedValues index).
    */
    //ToDo: Initialize the picker first.
    numPicker.setMinValue(0); 
    numPicker.setMaxValue(displayedValues.size()-1);
    numPicker.setDisplayedValues(displayedValues); 
    ```

*   当您想获取/设置选择器的值时：

    ```
    //To get the current value in the picker
    choosenValue = displayedValues[numPicker.getValue()]; 
    //To set a new value (let's say 150)
    for( int i=0; i<displayedValues.length ; i++ )
        if( displayedValues[i].equals("150") )
             numPicker.setValue(i); 
    ```

最后，还有一个很棒的易于定制的小部件，叫做[android-wheel](http://code.google.com/p/android-wheel/)。如果您愿意，可以查看并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T06:39:28.693

我使用**onScrollListener**以不同的步长滚动，使用**onValueChanged**处理数字键盘的直接输入。为了使用，您需要两个侦听器中都可用的变量 oldValue。

```
int oldValue = 0; 
```

在 onScrollListener 中，我使用 STATE_IDLE 只是因为它可以工作，而且我不理解这三种用途之间的 100% 差异......认为您可以将它们用于此目的。

在滚动之前，您需要全局 oldValue 变量来了解旧值。我还没有找到其他解决方案。if 子句是 min (0) 和 max (1000) 边界。

```
speedPicker.setValue(oldValue);
vitess.setProgress(oldValue);
((MainActivity) getActivity()).setSpeed(oldValue); 
```

这三个调用更新了我的元素（vitess 是一个耦合的 progressBar，speedPicker 是 numberPicker）。

在 onValueChange 中，我还更新了元素并设置了 oldValue。

顺便说一下，stepSize 是 100。

```
 speedPicker.setOnScrollListener(new OnScrollListener() {
        public void onScrollStateChange(NumberPicker speedPicker, int scrollState) {

            if (scrollState == NumberPicker.OnScrollListener.SCROLL_STATE_IDLE) {
                if (speedPicker.getValue() < oldValue){
                    if (speedPicker.getValue() >= 100)
                        oldValue-=100;
                    else
                        oldValue = 0;

                }
                else{
                    if (speedPicker.getValue() <= 900)
                        oldValue+=100;
                    else
                        oldValue = 1000;
                }

                speedPicker.setValue(oldValue);
                vitess.setProgress(oldValue);
                ((MainActivity) getActivity()).setSpeed(oldValue);

            }
            else if (scrollState == NumberPicker.OnScrollListener.SCROLL_STATE_FLING) {
            }
            else if (scrollState == NumberPicker.OnScrollListener.SCROLL_STATE_TOUCH_SCROLL) {
            }
        }
    });

    speedPicker.setOnValueChangedListener(new OnValueChangeListener() {
        public void onValueChange(NumberPicker speedPicker, int oldVal, int newVal) {

            oldValue = oldVal;
            speedPicker.setValue(newVal);
            vitess.setProgress(newVal);
            ((MainActivity) getActivity()).setSpeed(newVal);

        }
    }); 
```

在一些测试退出后，这段代码对我有好处。

这个答案的灵感来自 jpintado。[在Android NumberPicker OnValueChangeListener](https://stackoverflow.com/questions/16591266/android-numberpicker-onvaluechangelistener)中查看他的答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T10:35:56.780

@iturki 最后一点设置一个值。因为 valueInNumberPicker X PICKER_RANGE = valueInDisplayedValueArray 所以我们可以通过以下方式避免 for 循环：

```
// PICKER_RANGE= 50 so 150/50 -1 = 2, numPicker.setValue(2) == 150
numPicker.setValue(150/PICKER_RANGE -1); 
```

我的 2 美分。

顺便说一句，iturki 的回答很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-05T04:50:30.533

有点晚了，但这对我有用......

```
 numberPicker.setOnValueChangedListener(new NumberPicker.OnValueChangeListener() {
        @Override
        public void onValueChange(NumberPicker numberPicker, int oldVal, int newVal) {
            if (newVal > oldVal) {
                numberPicker.setValue(newVal+(myInterval-1));
            } else if (newVal < oldVal)
                numberPicker.setValue(newVal-(myInterval-1));
        }
    }); 
```

# php - 通过 PHP exec() 创建一个 tgz 文件

> ID：11925682
> 
> 赞同：1
> 
> 时间：2012-08-12T20:34:14.153
> 
> 标签：php

我正在尝试通过 PHP exec(); 创建一个 .tgz 文件；在 AJAX Web 界面中运行，但是，我的代码没有生成任何文件，也没有写出任何错误。

此代码在 shell 中工作：

```
tar cvfz destination/testfolder.tgz source/testfolder 
```

我在 PHP 中设置`destination/testfolder.tgz`和`source/testfolder`as 变量，因为它们会根据用户输入而变化，所以我的代码如下所示：

```
$q=$_GET["q"];
$part = explode("/", $q);
$source = $q;
$dest = "destination/" .$part[1].".tgz";
exec("tar cvfz " . $dest . " " . $source); 
```

我已经回应`"tar cvfz " . $dest . " " . $source`并将其复制/粘贴到 shell 中，这很有效，所以我对自己做错了什么感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:42:12.067

问题是，对于@David 提到的同样的安全问题，PHP exec() 函数的权限非常有限——它甚至不能创建文件。我建议您不要将文件更改为 777，即使是暂时的也很危险，我建议您在沙箱或任何无害的位置创建一个临时文件夹，然后将其**拥有**给 PHP 解释器的用户/组的用户/组有点限制性的权限（例如 chmod 700 用于目录，600 用于内部文件）。

# ajax - Node JS - 通过 AJAX 获取文件然后使用数据

> ID：11925683
> 
> 赞同：0
> 
> 时间：2012-08-12T20:34:21.173
> 
> 标签：ajax, node.js, asynchronous

我如何异步执行此操作？

```
var getData, myFunc;

getData = function() {
  var data = "";
  $.get("http://somewhere.com/data.xml", function(d) {
    data = $("#selector", d).html();
  });
  return data; // does not work, because async callback not yet fired
};

myFunc = function() {
  var data = getData();
  // do something with data here
}; 
```

我很高兴完全重构以实现我想要的。我只是不知道什么设计模式实现了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:38:05.523

好吧，你不能。你可以返回一个承诺：

```
var getData, myFunc;

getData = function () {
    var d = $.Deferred();
    $.get("http://somewhere.com/data.xml", function (data) {
        d.resolve($("#selector", data).html())
    });
    return d.promise();
};

getData().then(function (data) {
    alert(data);
}); 
```

演示[http://jsfiddle.net/W75Kt/2/](http://jsfiddle.net/W75Kt/2/)

# html - div 之间相差 2 像素

> ID：11925688
> 
> 赞同：0
> 
> 时间：2012-08-12T20:35:05.727
> 
> 标签：html, css

如果您查看[http://jsfiddle.net/Grek/w4HWn/1/](http://jsfiddle.net/Grek/w4HWn/1/)，您会看到右侧“与自然互动”的 DIV 比左侧的 DIV 低 1 或 2px。这种差异从何而来？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:39:54.490

如果我理解得很好，那么它来自你的 css`#source-region, #source-oursource p{margin-top:4px;}` [这里是 jsfiddle 上的链接](http://jsfiddle.net/w4HWn/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T20:42:25.207

```
#source-region, #source-oursource p {
margin-top: 4px;
} 
```

删除它，没有区别：http: [//jsfiddle.net/Grek/w4HWn/1/](http://jsfiddle.net/Grek/w4HWn/1/)

# mysql - 如何在使用 IN 函数时获取那些在 SELECT 查询中没有返回任何行的值

> ID：11925689
> 
> 赞同：0
> 
> 时间：2012-08-12T20:35:05.177
> 
> 标签：mysql, sql

我有一个查询：

SELECT Column1 FROM Table WHERE Column2 IN ('val1,'val2','val3',....'valn');

现在我想要那些没有返回任何行的值。表示我在 IN 函数中传递但它们不存在于我的表中的那些值。

对不起，如果我没有说清楚:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:37:14.960

```
SELECT x.f FROM
(SELECT 'val1' as f
UNION ALL
SELECT 'val2'
UNION ALL
SELECT 'val3') x
LEFT JOIN Table t ON x.f = t.Column2
WHERE t.Column2 IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T13:37:37.033

我是这样做的：

```
$have_values = array('val1','val2'..... 'valn');
$i=0;
$have_values_string=""; 
foreach($have_values as $var => $val)
{
$have_values_string.="'".$val."'";
if($i!=count($have_values)-1) {  $have_values_string.=",";}
$i++;
}

//now querying..
$sql=SELECT Column1 , Column2 FROM Table WHERE Column2 IN ('val1,'val2','val3',....'valn');
$result=mysql_query($sql);
while($row=mysql_fetch_array($result))
{
$found_values[$row[0]]=$row[1];
}

$not_found_values=array_diff($have_values, $found_values); 
```

# java - 如果 ID 在数据库中可用则更新，否则插入

> ID：11925692
> 
> 赞同：0
> 
> 时间：2012-08-12T20:35:17.187
> 
> 标签：java, sql-server-2008, jsp

> **可能重复：**
> [如果 ID 存在则更新记录，否则插入值](https://stackoverflow.com/questions/11924979/update-a-record-if-id-exist-else-insert-values)

如果记录存在，我正在尝试更新值，否则将值插入数据库中。但是，这是行不通的。我写了下面的代码：

注意：（版主，这是我几分钟前提出的重复问题。我无法编辑以前的问题。如有任何不便，请致歉。请求您删除。）

```
 <%
Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver").newInstance();
Connection conn = DriverManager.getConnection("jdbc:sqlserver://10.222.10.19:1433", "sa", "admin1");

String empId = request.getParameter("empid");
String fName = request.getParameter("fName");
String lName = request.getParameter("lName");

String sqlCheck = "Select * from [UAP].[dbo].[UAP_EMPLOYEE] where EMP_EMPLOYEE_ID = "empId" ";
PreparedStatement prpStatementCheck = conn.prepareStatement(sqlCheck);
prpStatementCheck.setInt(1, Integer.parseInt(empId));
prpStatementCheck.setString(2, fName);
prpStatementCheck.setString(3, lName);
ResultSet rsCheck=prpStatementCheck.executeQuery();
String check=null;
boolean exists = false;

 while(rsCheck.next())
{

         Statement stmt = conn.createStatement();
         String sql= "UPDATE [UAP].[dbo].[UAP_EMPLOYEE] SET EMP_EMPLOYEE_ID="+empId+", EMP_FNAME='"+fName+"', EMP_LNAME='"+lName+"' WHERE EMP_EMPLOYEE_ID= ?";
         stmt.executeUpdate(sql);
         exists = true;

     }
 if(!exists) 
     {
         String sql2 = "INSERT INTO [UAP].[dbo].[UAP_EMPLOYEE] (EMP_EMPLOYEE_ID, EMP_FNAME, EMP_LNAME ) VALUES (?,?,?)";
            PreparedStatement prpStatement1 = conn.prepareStatement(sql2);
            prpStatement1.setInt(1, Integer.parseInt(empId));

            prpStatement1.setString(2, fName);
            prpStatement1.setString(3, lName);

            prpStatement1.execute();
            prpStatement1.close();   

     } 
```

%>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:41:06.133

由于 EMP_EMPLOYEE_ID 是一个 INTEGER 字段，您需要使用：

```
prpStatementCheck.setInt(1, Integer.parseInt(empId)); 
```

此外，您可以删除 UPDATE 字符串的此字段周围的引号：

```
String sql= "UPDATE  [UAP_EMPLOYEE] SET EMP_EMPLOYEE_ID=" + empId + ", EMP_FNAME='" + fName+"', EMP_LNAME='" + lName + "' WHERE EMP_EMPLOYEE_ID= " + empId; 
```

再次为`prpStatement1`：

```
prpStatement1.setInt(1, Integer.parseInt(empId)); 
```

# html - 如何解决提供极高 FPS 的 webkitRequestAnimationFrame

> ID：11925693
> 
> 赞同：3
> 
> 时间：2012-08-12T20:35:26.967
> 
> 标签：html, google-chrome, canvas, frame-rate, requestanimationframe

今天，我一直在努力让自己熟悉 HTML5 所提供的任何新功能，尤其是画布。我来到网站 www.html5canvastutorials.com 并开始学习一些教程并在不同的浏览器中玩弄代码。当我看到下面的例子时，我注意到谷歌浏览器中有一些奇怪的东西。[http://www.html5canvastutorials.com/advanced/html5-canvas-oscillation-animation/](http://www.html5canvastutorials.com/advanced/html5-canvas-oscillation-animation/)

webkitRequestAnimationFrame 函数应该有助于在站点不活跃时帮助降低 FPS（从而降低 CPU 成本），例如当您转到不同的选项卡时。然而，当我尝试这个例子时，我注意到这并不总是能给出令人愉快的结果。

*   谷歌浏览器作为活动窗口，当前选项卡上的站点：获得大约 60 FPS，太棒了！
*   谷歌浏览器作为活动窗口，在不同的选项卡上：获得大约 1 FPS，非常好。
*   谷歌浏览器作为活动窗口，在我的电视上（用作第二台显示器），120 FPS，奇怪，但没有抱怨。
*   谷歌浏览器不是活动窗口，而是在不同的选项卡上，也大约 1 FPS 左右，完美。

然后是不好的部分：如果我的网站在当前选项卡上，但我有另一个窗口完全覆盖了 google chrome 窗口（例如最大化的窗口），则 FPS 最高可达 2500 左右（因此最大化一个 CPU 核心）。

当我在 Firefox 中尝试同一个站点时，一切正常。

这个小提琴是一个例子，它显示了自上次刷新以来的平均 FPS：http: [//jsfiddle.net/kmKZa/55/](http://jsfiddle.net/kmKZa/55/) （我几乎从教程站点复制了代码）

如果有人有任何想法，我想知道如何防止这些可怕的 CPU 峰值。提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T11:00:16.900

一种可能的解决方案是在模糊窗口时简单地取消 AnimationFrame 循环，并在重新聚焦时再次请求它。

```
var isPaused = false,
    animFrame;

loop();

$(window)
    .on('focus', function() {
        if( isPaused ) {
            isPaused = false;
            loop();
        }
    })
    .on('blur', function() {
        cancelRequestAnimationFrame( animFrame );
        isPaused = true;
    });

function loop() {
    //your crazy loop code

    animFrame = requestAnimationFrame( loop );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-17T07:44:10.710

RAF 在“空闲”时自动停止执行。你不需要停止 RAF 循环执行

# arrays - 使用 Spring MVC 从 Jquery ajax 方法返回字符串数组

> ID：11925696
> 
> 赞同：2
> 
> 时间：2012-08-12T20:35:42.840
> 
> 标签：arrays, string, jquery, spring-mvc

我正在尝试使用 JQuery 的 .ajax 方法动态生成列表/下拉列表。以下是我写的代码：

```
<script type="text/javascript">
    $(document).ready(function() {
        alert('in doc');
        $.ajax({
            url: "dyn/list",
            type: "GET",
            data: "list="+'',
            dataType: "json",
            error: function() {alert('eerrrr');},
            success: function(data) {
                alert('success');
                alert(data);
                    $('#seltag').append(
                        $('<option></option>').html(data)
                    );
            },
            complete: function() {}
        });
        });</script> 
```

我相应的控制器方法看起来像

```
 @RequestMapping(value = "/dyn/list", method = RequestMethod.GET)
public @ResponseBody String getList(@RequestParam String list)
{
    ArrayList<String> newList = new ArrayList<String>();
    newList.add(opt0);
    newList.add(opt1);
    newList.add(opt2);
    return(new JSONArray(newList).toString());
    //return opt0;
} 
```

其中 opt0,1 和 2 是静态字符串变量。每次返回一个错误。我也尝试过 .getJSON 但无济于事。帮帮我吧伙计们！！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T06:56:13.203

您不需要自己转换为 JSON。`<mvc:annotation-driven`在类路径中启用和杰克逊的Spring 3会为您完成：

```
@RequestMapping(value = "/dyn/list", method = RequestMethod.GET)
public @ResponseBody List<String> getList(@RequestParam String list) {
    List<String> newList = new ArrayList<String>();
    newList.add(opt0);
    newList.add(opt1);
    newList.add(opt2);
    return newList;
} 
```

有关更多信息，请查看[此帖子](http://www.mkyong.com/spring-mvc/spring-3-mvc-and-json-example/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-14T01:22:31.157

添加到 oris 答案，您也不需要执行 getJSON。在您的成功回调迭代中抛出列表以获取消息。

```
success: function(data) {
for(var count=0; count<data.length; count++){
 yourMessage = data[count];
}
//your code
} 
```

# sql-server - SQL Server 检查约束以检查签到位置

> ID：11925702
> 
> 赞同：0
> 
> 时间：2012-08-12T20:36:45.150
> 
> 标签：sql-server, sql-server-2008

我的表中有一个名为`duration`type的列`varchar(5)`。

如何添加检查约束以检查前两个字符和后两个字符是否为数字，第三个字符是否为“：”

前任：

```
23:25 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:04:05.397

这应该有效：

```
create table test (
id int identity(1,1),
name varchar(5) constraint tmp_chk check(name like '[0-9][0-9]:[0-9][0-9]')
) 
```

测试用例：

```
insert into test (name) values ('12:34')
insert into test (name) values ('12:a4')
insert into test (name) values ('12x34')
insert into test (name) values ('a2:34')
insert into test (name) values ('123:34') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T07:18:04.287

如果必须使用 varchar(5)，那么**[C 2](https://stackoverflow.com/a/11925873/65223)**的答案是正确的。 **但是，如果您真的想解决您的问题，您需要忘记 varchar(5) 并使用[time 数据类型](http://msdn.microsoft.com/en-us/library/bb677243.aspx)**。使用`Time`varchar(5) 可以打开更精确甚至计算的可能性，而这是使用 varchar(5) 无法实现的。

如果您`duration`可以大于 23:59:59.9999999（Time 数据类型的最大值），那么您应该使用风格`INT`来包含您需要的最大分钟数或秒数，并仅存储总分钟数或秒数。如果您的持续时间是 5 小时 7 分钟：`05:07`存储普通 int：307 分钟或 18420 秒。

# testing - 模拟 Grails Spring Security 登录用户

> ID：11925705
> 
> 赞同：5
> 
> 时间：2012-08-12T20:37:12.663
> 
> 标签：testing, grails, spring-security, mocking

寻找一种在某些单元/集成测试中模拟弹簧安全性的方法。

*   圣杯：V2.1.0
*   Spring Security 核心：V1.2.7.3

控制器具有以下功能：

```
// some action
def index(){
   def user = getLoggedInUser()
   render ....
}
...

private getLoggedInUser(){
    return User.get(springSecurityService.principal.id)
} 
```

我尝试了以下和其他各种方法，但看不到让它工作：

```
void testSomething(){
    def dc = new SomeController()
    dc.springSecurityService = [
            encodePassword: 'password',
            reauthenticate: { String u -> true},
            loggedIn: true,
            principal: [username:"Bob"]]
    dc.index() 
    ... assertion.... 
```

似乎用户没有被创建并且无法获得`principal.id`. 有什么建议或更好的选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T23:46:11.843

我认为用户只是被创建，但没有被保存，这就是它没有 ID 的原因。

解决方案可能是这样的：

```
void testSomething(){
    def dc = new SomeController()
    def loggedInUser = new User(username: "Bob").save() // This way the user will have an ID
    dc.springSecurityService = [
        encodePassword: 'password',
        reauthenticate: { String u -> true},
        loggedIn: true,
        principal: loggedInUser]
    dc.index() ... assertion.... 
```

有一个替代方案：

```
void testSomething(){
    def dc = new SomeController()
    def loggedInUser = new User(...).save()
    dc.metaClass.getLoggedInUser = { loggedInUser }
... 
```

我建议对 getLoggedInUser 进行重构：

```
private getLoggedInUser(){
    return springSecurityService.currentUser
} 
```

通过此更改，您可以编写：

```
void testSomething(){
    def dc = new SomeController()
    def loggedInUser = new User(...).save()
    dc.springSecurityService = [
        encodePassword: 'password',
        reauthenticate: { String u -> true},
        loggedIn: true,
        getCurrenUser: { loggedInUser }]
... 
```

# javascript - 在 Twisted HTTP 返回时未调用 AJAX 成功

> ID：11925710
> 
> 赞同：1
> 
> 时间：2012-08-12T20:37:48.513
> 
> 标签：javascript, jquery, python, ajax, twisted

我目前在 python 中的 Twisted HTTP 服务器上通过 AJAX 进行通信时遇到问题。虽然我可以发送请求并在服务器上累积要返回的数据，但当我尝试通过简单的 return 语句从服务器返回 JSON 时，它似乎永远不会调用 Jquery AJAX 中定义的成功函数，或者至少它从未在萤火虫中触发。

Jquery 代码片段：（假设它在 document.ready 下）：

```
function json_http_post(url, data, callback) {
            $.ajax({
                url: url,
                type: "POST",
                dataType: "jsonp",
                data: {
                    type: data.type,
                    source : data.source,
                    trade: data.trade,
                    symbols: data.symbols,
                    time1: data.time1,
                    time2: data.time2,
                    interval: data.interval
                },
                success: function(data) {
                    callback(data);
                }
            });
        } 
```

twised sever 实现与[this](https://stackoverflow.com/questions/3387581/twisted-web-and-ajax)和[that](https://stackoverflow.com/questions/5851998/ajax-post-doesnt-work-twisted)相似（或几乎相同） 。问题是我从未见过回调（数据）被调用，但我可以看到 python 没有错误地到达我的 return 语句，并且将一个 json 对象发送回回调。

# php - 文件仅在新窗口/标签打开时下载

> ID：11925711
> 
> 赞同：0
> 
> 时间：2012-08-12T20:37:59.830
> 
> 标签：php, codeigniter, http-headers, download

我有一个根据变量创建不同文件类型的函数，我让它生成一个 XML，但是当我单击指向页面的链接来执行此操作时（`<a href="/asset/1/xml">XML</a>`），什么也没有发生。如果我单击以在新选项卡中打开它或在标题栏中手动输入 url，则文件将按我想要的方式下载。

```
function asset($asset_id, $display = ''){

    $this->load->model('model_asset');

    $asset = $this->model_asset->get_by_id($asset_id, true);

    switch($display) {
    case 'xml':
        $this->load->helper('array_to_xml_helper');

        $asset_arr = get_object_vars($asset);

        $filename = $asset->title .'-'. $asset->subtitle . '.xml';
        $xml = Array2XML::createXML('asset', $asset_arr);
        header ("Content-Type:text/xml");
        header('Content-Disposition: attachment; filename="'. $filename .'"');
        echo $xml->saveXML();
        break;
    }
} 
```

如何使用动态生成的文件进行这项工作（我正在使用我在[此处](http://www.lalit.org/lab/convert-php-array-to-xml-with-attributes/)找到的 arraytoxml 实用程序函数）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T09:03:38.580

您可以尝试在附件中设置文件将此添加到您的标题中：

*   内容配置：附件
*   文件名=huge_document.pdf

# c# - 如何读取外部应用程序 DrawText 绘制的文本

> ID：11925713
> 
> 赞同：2
> 
> 时间：2012-08-12T20:38:30.493
> 
> 标签：c#, external, drawstring, drawtext

我一直在为这个问题苦苦挣扎：“如何阅读外部应用程序 DrawText 绘制的文本？”。

我现在用 C# 编码。

我不可能使用光学字符识别，我不希望使用 Hook 或任何直观的东西。

但是可以做到吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:48:54.637

恐怕我不清楚你的问题，但这就是我的看法。

有一个应用程序 (Notepad.exe) 在某处写了一些文本（记事本的文本编辑区域），您想从自己的应用程序 (YourOwn.exe) 中读取它。

你不能用 C# 做很多事情。去 Win32 API。以下链接可能感兴趣：

1.  EnumWindows： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms633497 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633497(v=vs.85).aspx)
2.  GetWindowText： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms633520 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633520(v=vs.85).aspx)
3.  用于窗口操作的完整 API：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms632595 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632595(v=vs.85).aspx)
4.  点网 - Win32 - [pinvoke.net：http://www.pinvoke.net/default.aspx/user32.enumwindows](http://www.pinvoke.net/default.aspx/user32.enumwindows)

# jsf - JSF PrimeFaces 简单示例：仅空白页

> ID：11925714
> 
> 赞同：1
> 
> 时间：2012-08-12T20:38:34.457
> 
> 标签：jsf, primefaces

我使用 Primefaces-3.3.1、JSF 2.1、Glassfish 3.1.2 和 IntelliJ IDEA 11.1.3 作为 IDE尝试[了这个示例。](http://primefaces.org/gettingStarted.html)将 PF 的 jar 添加到 WEB-INF/lib 目录并创建了“test.jsf”，我在其中放置了示例。结果我看到空白页。Chrome 是这样理解的：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui"><head></head><body><h:head>

</h:head>

<h:body>

    <p:editor>

</p:editor></h:body>
  </body></html> 
```

怎么了？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T20:42:49.813

看起来你应该修改你的 web.xml

像这样

```
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.xhtml</url-pattern>
</servlet-mapping> 
```

看看这个[JSF 2.0 Hello World 示例](http://www.mkyong.com/jsf2/jsf-2-0-hello-world-example/) `4\. JSF 2.0 Serlvet Configuration`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T09:22:40.030

有时，当您构建 JSP 或 XHTML 页面并在导航器中输入时，它不像 JSF 页面那样工作。

要修复它，您需要查看 web.xml 并像 Daniel 之前所说的那样更改 url 模式。

例如，如果您有一个名为：

> 索引.jsp

你的 web.xml 中有这个

> <url-pattern>*.jsf</url-pattern>

您需要通过网址访问

> http://localhost:8080/project/index.jsf

# javascript - cufon LTR 转 RTL

> ID：11925716
> 
> 赞同：2
> 
> 时间：2012-08-12T20:38:47.833
> 
> 标签：javascript, jquery, wordpress, right-to-left, cufon

我得到了这个[网站](http://www.fresh-air.co.il/)

我正在使用 cufon 将文本转换为我自己的字体。

问题是文本是反向显示的。

我正在使用名为`cunfonRTL.js`的 JavaScript 文件，内容是：

```
var CufonRTLClass=(function(){
        this.RTL = RTL;

   function RTL(tagName) {
        $(tagName)/*.css('font-size', '19px')*/.wrapInner('<bdo class="cufon" dir=ltr></bdo>');

        $('bdo.cufon').each(function()    {
        var word = $(this).text();
        var splittext = word.split("");
        var reversedtext = splittext.reverse();
        var newtext = reversedtext.join("");
        $(this).text(newtext);
        });

    }
});

CufonRTL = new CufonRTLClass; 
```

呈现的文本如下所示：

```
<cufon class="cufon cufon-canvas" alt="כותרת " style="width: 80px; height: 28px; "><canvas width="110" height="28" style="width: 110px; height: 28px; top: 4px; left: -8px; "></canvas><cufontext>כותרת </cufontext></cufon> 
```

它的“cufon”没问题，但它不是 RTL .. 它的 LTR .. 我有语法问题？

帮助将不胜感激。

更新：在 chrome 的控制台中，我发现了这个： ![在此处输入图像描述](../Images/0f775a45eeb704fff0837ac5fdd61176.png)

这就是我调用函数的方式：

```
 Cufon.replace('H1');
CufonRTL.RTL('H1'); 
```

更新：据我所知，$ 选择器存在 jQuery 冲突。我转换了我所有的 $ sings`jQuery` 现在也不例外，它只是不运行。

我做了一些调试，发现他没有进入这个循环： `jQuery('bdo.cufon').each(function()`

```
var CufonRTLClass=(function(){
        this.RTL = RTL;

   function RTL(tagName) {
        jQuery(tagName)/*.css('font-size', '19px')*/.wrapInner('<bdo class="cufon" dir=ltr></bdo>');

        jQuery('bdo.cufon').each(function()    {
        var word = jQuery(this).text();
        var splittext = word.split("");
        var reversedtext = splittext.reverse();
        var newtext = reversedtext.join("");
        jQuery(this).text(newtext);
        });

    }
});

CufonRTL = new CufonRTLClass; 
```

帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:41:36.443

更改此行

```
$(tagName)/*.css('font-size', '19px')*/.wrapInner('<bdo class="cufon" dir=ltr></bdo>'); 
```

对此

```
$(tagName)/*.css('font-size', '19px')*/.wrapInner('<bdo class="cufon" dir=rtl></bdo>'); 
```

# javascript - 是否可以在 Python 中将函数打印为字符串？

> ID：11925717
> 
> 赞同：1
> 
> 时间：2012-08-12T20:39:08.393
> 
> 标签：javascript, python

> **可能重复：**
> [Python 可以打印函数定义吗？](https://stackoverflow.com/questions/1562759/can-python-print-a-function-definition)

在 Javascript 中，可以将函数的代码打印为字符串吗？

Javascript 中的示例：

```
function thisFunctionPrintsItself(){
    return thisFunctionPrintsItself.toString();
} 
```

是否可以在 Python 中做同样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T20:44:23.900

您可以这样做，但结果没有用，因为所有内容都首先编译为字节码。

```
def printItself():
    print repr(printItself.func_code.co_code) 
```

您也可以使用该`dis`模块进行反汇编，但结果并不保证可移植。

```
def disassembleItself():
    print __import__('dis').dis(disassembleItself) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:49:41.447

```
def foo ():
    import inspect
    return inspect.getsource(foo)

print (foo()) 
```

在这里，inspect 模块读取源文件，因此如果它们丢失（并且仅使用`.pyc`or`.pyo`模块）或函数在交互式解释器或其他方式中即时编译，它将无法工作。

# c++ - 使用 g++ 编译并将 GraphicsMagick++ 作为静态库

> ID：11925721
> 
> 赞同：1
> 
> 时间：2012-08-12T20:39:32.497
> 
> 标签：c++, g++, imagemagick, static-libraries, static-linking

以下命令有效

```
g++ file.cpp $( GraphicsMagick++-config --cppflags --cxxflags --ldflags --libs ) 
```

但我想要一个未链接到库的静态可执行文件，所以我尝试过

```
g++ file.cpp $( GraphicsMagick++-config --cppflags --cxxflags --ldflags --libs ) -static 
```

但它只会产生以下错误

```
/usr/bin/ld.bfd.real: /usr/lib/gcc/x86_64-linux-gnu/4.6/crtbeginT.o: relocation R_X86_64_32 against `__DTOR_END__' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc/x86_64-linux-gnu/4.6/crtbeginT.o: could not read symbols: Bad value
collect2: ld returned 1 exit status 
```

添加`-fPIC`给出相同的结果。

我正在使用 Ubuntu 12.04 64 位标准存储库附带的 GraphicsMagick++ 版本。

由于 GraphicsMagick++ 是 ImageMagick 的一个分支，ImageMagick 的一些旧技巧可能会起作用，但我从未使用过 ImageMagick，只有 GraphicsMagick++。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:52:07.157

要静态链接到该特定库，请在它`-Wl,-Bstatic` *之前*使用，即：

```
g++ $( GraphicsMagick++-config --cppflags --cxxflags ) -fPIC file.cpp -o file -Wl,-Bstatic $( GraphicsMagick++-config --ldflags --libs ) 
```

如果您随后想要传递更多库并动态链接它们，您可以传递`-Wl,-Bdynamic`以切换回来并在之后添加更多库。

*编辑*：还要注意具体的参数顺序。首先是编译器标志，然后是文件，最后是链接器标志和库。使用其他顺序，您可能会遇到随机故障。真的。

# ruby-on-rails - Rails：包括来自关联的特定记录

> ID：11925725
> 
> 赞同：0
> 
> 时间：2012-08-12T20:40:14.317
> 
> 标签：ruby-on-rails, activerecord

我正在尝试从`has_many`我的模型中的关联中获取一些记录。

我有一个模型，该模型`has_many`与一组记录相关联，这些记录是一种交易历史，在另一笔交易时记录有关父母的一些数据。

```
class Character < ActiveRecord::Base
    has_many :character_histories
end

class CharacterHistory < ActiveRecord::base
    belongs_to :character
end 
```

获取所有“CharacterHistory”记录很容易，但我只想包括在 12.24 小时前创建的第一条记录，等等，这样我就可以查看在那个时间范围内发生的最后一笔交易。

作为额外的奖励，我还希望能够获得为关联返回的*所有记录的列的最大值......*

**更新/解决方案**

我在我的模型中添加了一个“范围模块”。

```
class CharacterHistory < ActiveRecord::Base
  module Scopes
    def last
      order("created_at DESC").first
    end

    def first_less_than_12_hours_ago
      where("created_at <= '#{12.hours.ago}'").order("created_at DESC").first
    end

    def first_less_than_24_hours_ago
      where("created_at <= '#{24.hours.ago}'").order("created_at DESC").first  
    end

    def all_time_high
      maximum(:value)
    end
  end
  extend Scopes

end 
```

这是从我在这里得到的解决方案和这篇文章中得到启发的：[http ://www.railway.at/2010/03/09/named-scopes-are-dead/](http://www.railway.at/2010/03/09/named-scopes-are-dead/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:25:44.410

您可以在 character_histories 中为您需要的每个凭据创建范围，如下所示：

```
scope :first_less_than_12_hours_ago, lambda {where("date >= '#{12.hours.ago}'").order("date DESC").first}

scope :unknown_column_max, maximum(:unknown_column) 
```

进而：

```
character.character_histories.first_less_than_12_hours_ago
character.character_histories.unknown_column_max 
```

# excel - VBA 编辑器中的 Unicode 语言支持

> ID：11925726
> 
> 赞同：6
> 
> 时间：2012-08-12T20:40:22.273
> 
> 标签：excel, vba, internationalization, ms-office

我在 Excel 2003 中有一个 VBA 项目。

这个 VBA 项目是用西里尔编码的俄语编写的，所以所有的评论和消息在我的英语操作系统 (WindowsXP) 上都是不可读的。

所以俄罗斯机器上的代码看起来像（OK）：

```
Sub Select_I()
'Выделяет по текущей ячейке "построчный" диапазон для ввода данных по объекту 
```

成为我的（不好）

```
Sub Select_I()
'Âûäåëÿåò ïî òåêóùåé ÿ÷åéêå "ïîñòðî÷íûé" äèàïàçîí äëÿ ââîäà äàííûõ ïî îáúåêòó 
```

有没有办法向 VBA 编辑器“指示”要使用什么编码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-31T06:05:51.090

我为我找到了一种解决方法 - 当将俄语文本从 VBA 编辑器复制粘贴到 Windows 中的其他位置时，此时键盘为俄语布局，然后正确显示粘贴的俄语符号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T02:21:35.530

尝试以下（我不能很容易地对此进行测试，但它应该可以工作）：

控制面板 --> 日期、时间、语言和区域选项 --> 区域和语言选项 --> 高级

并将非Unicode程序的语言设置为适当的语言（在您的情况下似乎是俄语）。

# php - 使用 Ajax 一键更改一些内容

> ID：11925728
> 
> 赞同：0
> 
> 时间：2012-08-12T20:40:38.687
> 
> 标签：php, ajax, laravel

我是一名新手开发人员，并开始使用 Laravel 进行编码。

我的问题是，我无法通过单击菜单来更改此内容。
我真的很困惑如何在这种情况下使用 Ajax。

我的路线.php：

```
Route::get('articles',array('as'=>'articles','uses'=>'articles@index'));
Route::get('author/(:any)', array('as'=>'article','uses'=>'articles@view'));
Route::get('abouts',array('as'=>'abouts','uses'=>'abouts@index')); 
```

我的 default.blade.php（很快包含在脚本中）

```
<!DOCTYPE html>
 <head>
    <title>{{$title}}</title>
    {{ HTML::script('js/jquery.min.js') }}
    {{ HTML::script('js/ajax.js') }}
    .......
  </head>
    <body>
    ........
    <div id="wrapper">
    <div id="page">
               {{ $content }}
    </div>
    <!-- SIDEBAR -->
    <div id="sidebar">
    <div id="sidebar-content">

     <ul id="menu">
    <li class="current"><a href="<?php echo URL::to_route('articles'); ?>">ANASAYFA</a></li>
    <li><a href="<?php echo URL::to_route('abouts'); ?>">HAKKIMIZDA</a></li>
 .......
   <script type="text/javascript">var BASE = "<?php echo URL::base(); ?>";</script>
</body>
</html> 
```

我的观点在 div/#content 中。

我的 ajax.js ：

```
$(document).ready(function() {
    $('#sidebar-content ul li a').click(function(e) {
        // prevent the links default action
        // from firing
        e.preventDefault();
        // attempt to GET the new content
        $.get(BASE +'#content', function(data) {
            $('#content').html(data);
            console.log(data);

        });
    })
}); 
```

我的文章控制器：

```
<?php

class Articles_Controller extends Base_Controller {

    public $restful = true; 
    public $layout = 'layouts.default';

    public function get_index(){
             $this->layout->title = "Anasayfa";
             $this->layout->content = View::make('articles.index')
             ->with('articles',Article::order_by('id')->get());
         }

        public function get_view($id){
            $this->layout->title = "Hizmetlerimiz";
          $this->layout->content = View::make('articles.view')
            ->with('article',Article::find($id));
        }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:24:01.570

您想替换`<div id="page">`.

我认为你应该写`$('#page').html(data);`

# iphone - 你如何初始化一个 UIGestureRecognizer？

> ID：11925729
> 
> 赞同：1
> 
> 时间：2012-08-12T20:40:49.580
> 
> 标签：iphone, ios, uigesturerecognizer

我想向我的按钮添加一个手势识别器，以便在用户滑过按钮框架时我可以运行代码。如果向上、向右、向左或向下滑动按钮，我还希望此代码有所不同。

```
-(void)viewDidLoad
{
    [super viewDidLoad];
    UIButton *button=[UIButton buttonWithType:UIButtonTypeRoundedRect];
    button.frame=CGRectMake(0, 0, 100, 100);
    [self.view addSubview:button];
    UIGestureRecognizer *swipe=[[UIGestureRecognizer alloc]initWithTarget:button action:@selector(detectSwipe)];
    [button addGestureRecognizer:swipe];
} 
```

那么，我做对了`initWithTarget:action:`吗？既然我这样做了，我该如何实现该`detectSwipe`方法？

这是我关于如何实施的想法`detectSwipe`

```
 -(IBAction)detectSwipe:(UIButton *)sender
        {
      /* I dont know how to put this in code but i would need something like, 
if (the swipe direction is forward and the swipe is > sender.frame ){ 
[self ForwardSwipeMethod];
    } else if //same thing for right
    else if //same thing for left
    else if //same thing for down

        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T20:50:03.777

不，这是不正确的。手势识别器的目标不是按钮，而是它在检测到手势时调用动作方法的对象（否则它怎么知道哪个对象调用了该方法？在 OO 中，方法调用/消息发送需要显式方法名称**和**实例或类）。

所以你很可能想要

```
recognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(didSwipe:)]; 
```

您也不会直接创建 UIGestureRecognizer 的实例，而是创建一个具体的子类，在这种情况下为 UISwipeGestureRecognizer。

分配初始化识别器后，将其附加到要识别的视图：

```
[button addGestureRecognizer:recognizer]; 
```

然后在 didSwipe: 方法中，您可以使用手势识别器的属性来决定滑动的大小/距离/其他属性是什么。

[下次你最好阅读一些文档。](http://developer.apple.com/library/ios/ipad/#DOCUMENTATION/UIKit/Reference/UISwipeGestureRecognizer_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T20:44:36.380

除了手势识别器的目标之外，您一切正常。目标是接收给定选择器消息的对象，因此您的`initWithTarget:`调用应`self`作为参数接受，除非您在`detectSwipe`按钮的子类中实现方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-12T20:51:00.050

您可能想要使用[UISwipeGestureRecognizer](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UISwipeGestureRecognizer_Class/Reference/Reference.html)。UIGestureRecognizer 通常不应使用，除非您将其子类化。您的代码应类似于以下内容。

```
UISwipeGestureRecognizer *swipe=[[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(detectSwipe)];
swipe.direction = UISwipeGestureRecognizerDirectionRight;
[button addGestureRecognizer:swipe]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-12T21:08:40.473

H2CO3 的答案是完整的。只是不要忘记您在选择器末尾缺少一个冒号“：”！它应该是这样的：`@selector(detectSwipe:)`

冒号“：”是因为您的方法有一个参数：`(UIButton *)sender`

# c# - 将类的字典绑定到数据网格

> ID：11925730
> 
> 赞同：0
> 
> 时间：2012-08-12T20:41:02.617
> 
> 标签：c#, wpf, binding, datagrid, dictionary

我有以下类，我想将它的字典值绑定到数据网格控件

```
public class DBRow : IEnumerable<DBColumn>
{
    public DBColumn this[string ColumnName]
    {
        get { return Columns[ColumnName]; }
        set { Columns[ColumnName] = value; }
    }
    public Dictionary<string, DBColumn> Columns { get; set; }

    public DBRow()
    {
        this.Columns = new Dictionary<string, DBColumn>();
    }

    public List<KeyValuePair<string,DBColumn>> GetKeysPair()
    {
        List<KeyValuePair<string, DBColumn>> ListOfKeyPair = new List<KeyValuePair<string, DBColumn>>();
        foreach (var KeyPair in Columns)
        {
            ListOfKeyPair.Add(KeyPair);
        }
        return ListOfKeyPair;
    }

    public void AddColumn(DBColumn Column)
    {
        Columns.Add(Column.Name, Column);
    }
    public IEnumerator<DBColumn> GetEnumerator()
    {
        foreach (var Column in Columns)
        {
            yield return Column.Value;
        }
    }
    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        foreach (var item in Columns)
        {
            yield return item;
        }
    }
} 
```

在上使用 foreach

```
GetKeysPair() method 
```

我尝试像这样绑定它：

```
 foreach (var item in Row.GetKeysPair())
        {
            DataGridTextColumn DataGridColumn = new DataGridTextColumn();
            DataGridColumn.Header = item.Value.Name;

            DataGridColumn.Binding = new Binding(********); <<---  Problem!!             

            dataGridDataList.Columns.Add(DataGridColumn); <<--- DataGrid
        } 
```

问题是我不知道输入什么

```
New Binding(string); 
```

我正在尝试绑定以下属性：

```
public struct DBColumn
{
    public object Data { get; set; }
} 
```

我尝试了很多选择，但我无法弄清楚:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:45:22.517

嗯，我假设您的 DataGrid 的 ItemsSource 是字典的集合（或 list<keyvaluepair> 的集合），如果是这种情况，那么我相信您应该能够只使用索引器来访问该值，例如

```
DataGridColumn.Binding = new Binding(string.Format("[{0}].Data", item.Key)); 
```

# android - Android：如何在应用程序未运行时通知用户

> ID：11925734
> 
> 赞同：1
> 
> 时间：2012-08-12T20:41:20.480
> 
> 标签：android, notifications, android-c2dm, foreground

我是 Android 新手，但通知有问题。我知道这个话题之前也有人讨论过，但我只是想知道是否还有其他方法可以解决这个问题。

问题：在我的应用程序中，我希望通知用户他/她已进入特定位置的半径。当应用程序处于活动状态并在前台时，我的功能正常工作。但是，我希望在应用程序不工作且不在前台时也通知用户。

在之前的帖子中，我发现这可以通过使用称为 C2DM 的东西来完成。虽然我不太了解，但通过使用 C2DM，我将引入额外的网络旅行。我的问题是，这是唯一的方法吗？这个功能不能以任何其他方式完成，在本地像某种守护线程之类的东西吗？

此外，如果 C2DM 只是一种方式，并且由于我的应用程序不在我的前台，那么一旦用户到达特定位置的半径，C2DM 是否也会通知？

想提前感谢大家。请让我知道你们中是否有人遇到过与此类似的情况/问题/要求，以及您是否可以强调前进的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:45:55.643

> 当应用程序处于活动状态并在前台时，我的功能正常工作。但是，我希望在应用程序不工作且不在前台时也通知用户。

[使用`addProximityAlert()`](http://developer.android.com/reference/android/location/LocationManager.html#addProximityAlert%28double,%20double,%20float,%20long,%20android.app.PendingIntent%29)on `LocationManager`，然后您的应用程序是否在前台都无关紧要。

# sql - 尝试获取在两个给定日期之间具有时间戳的所有记录

> ID：11925737
> 
> 赞同：1
> 
> 时间：2012-08-12T20:42:10.383
> 
> 标签：sql, ruby-on-rails, ruby, activerecord, time

我有过去 5 年左右创建的庞大记录数据库。我认为尝试为这些记录创建一些时间类别/段会很酷（并且很有启发性），单位可以是周或月或类似的东西，用于图表。

无论如何，我需要开发一个查询，给定表中每条记录的日期时间属性，将返回日期时间在 X 和 Y 之间的所有记录（例如，2011 年 6 月 1 日和 2011 年 6 月 7 日）。

我还不擅长使用时间助手，并且在 SO 或其他地方找不到任何足够相似的问题。

强烈赞赏*使用 Rails 可以理解的*“周”或“月”等主观增量的解决方案。我知道日历在编程中会变得多么棘手。或者我可以只使用一些最低公分母（天）并做一个非常精细的图表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:23:05.483

```
Client.where(:created_at => X..Y) 
```

资料来源：[Ruby on Rails 指南](http://guides.rubyonrails.org/active_record_querying.html#conditions)

# c++ - typedef class Smth 是什么意思？

> ID：11925744
> 
> 赞同：1
> 
> 时间：2012-08-12T20:42:59.483
> 
> 标签：c++, templates, typedef

刚才[在这里](https://stackoverflow.com/questions/11925563/error-c2761-member-function-redeclaration-not-allowed)看到了。

从来没有遇到过这样的结构，我不明白，这是什么意思！以及它在专业化中的工作方式，因为 typedef 不会生成新类型：

错误的：

```
template <typename T>
void a();
typedef int a_t;
typedef int b_t;
template<> void a<a_t>(){}
template<> void a<b_t>(){} 
```

* * *

编译时带有警告：`'typedef' was ignored in this declaration`，按预期工作：

```
template <typename T>
void a();
typedef class a_t;
typedef class b_t;
template<> void a<a_t>(){}
template<> void a<b_t>(){} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T20:45:20.217

没什么意思，你最好别写。如果你愿意，给 typedef 一个合适的名字

```
typedef class a_t a_t; 
```

不过，我没有看到任何好处。不过，最近改用 C++ 的 AC 程序员可能倾向于这样做，因为在 C 中，您不能通过简单地命名来引用类名（“标签”，用 C 术语表示），但您必须在它前面加上标签类型（“struct a_t”或“union a_t”）或者你为它创建一个typedef。然而，即使在这种情况下，程序员之后也会忘记这个名字:)

在 C++ 中，这不是必需的。在 C++ 中，typedef 名称和类名称的存在并不能通过将这些名称保存在不同的“命名空间”中来解决（可以这么说，用 C 术语来说。每个“命名空间”都有一种“语法定向消歧”。这样你就可以说“foo”、“struct foo”和“goto foo”，而每次“foo”可能是一个完全不同的实体）。在 C++ 中，typedef 名称将替换纯类名，因此名称“a_t”既是 typedef 名称，也是类名。

至于 Standardese，我们对此有一个问题，请参阅[http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#157](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#157)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:49:05.553

这不是对标题中问题的回答（约翰内斯对此的解释很清楚），而是对您所看到的失败的解释。

您的第一组代码失败的原因是因为`a_t`and`b_t`是相同的类型 ( `int`)，因此您正在创建 的两个定义`a<int>`，这就是编译器所抱怨的。

在您的第二个示例中，您声明了两种不同的类型（每种都是不同的名称`class`）。因此，您正在创建两个不同的函数，`a<a_t>`并且`a<b_t>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T21:01:12.783

我终于明白了，它是如何工作的。

```
typedef class a_t; 
```

不像

```
typedef int a_t; 
```

但喜欢

```
typedef int; 
```

所以，我转发了声明`class a_t`，然后`typedef`就一事无成。它还解释了警告``typedef' was ignored in this declaration` 和所有模板相关的东西。

# django - Django 管理站点不工作

> ID：11925745
> 
> 赞同：0
> 
> 时间：2012-08-12T20:43:13.977
> 
> 标签：django, apache, webserver, wamp, mod-wsgi

我正在使用 Python 2.7 通过 mod_wsgi 和 WAMP 托管一个 Django 站点。在我的管理站点上，用户、组和站点部分都有添加和更改按钮。虽然我自己的自定义模型 Feedpost 和 Newspost 各有一个部分，但它们根本没有按钮，也无法添加或更改它们。我相信当我从使用 Django 内部测试服务器切换到使用 WAMP 时，就会发生这种变化。有谁知道是什么原因造成的以及如何恢复我的添加和更改按钮？

编辑：

这是两个模型之一：

```
from django.db import models
from django.contrib import admin

class FeedPost(models.Model):
    title = models.CharField(max_length=50)
    text = models.CharField(max_length=5000)
    date = models.DateTimeField('Date Published')
    def __unicode__(self):
        return self.title

admin.site.register(FeedPost) 
```

另一个几乎完全相同。

事实证明，使用 Django 开发服务器 localhost:8000/admin 坚持要访问我网站的主页，我根本无法访问管理网站。

另外我认为这将成为问题，因为我的项目中的任何地方都没有 admin.py 文件......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T02:23:17.353

对于初学者，这些需要在 admin.py 文件中。

```
from django.contrib import admin 
admin.site.register(FeedPost) 
```

# asp.net - 是否可以在共享主机上的 IIS 中启动 WCF UDP 侦听器，而无需用户先访问 HTTP？

> ID：11925748
> 
> 赞同：0
> 
> 时间：2012-08-12T20:43:51.653
> 
> 标签：asp.net, wcf, iis, udp, shared-hosting

我通过 WCF 创建了一个甜蜜的 ASP.NET 4.0 UDP 侦听器，该侦听器从 Application_Start 开始。像往常一样，我的本地机器上的一切都是笨拙的。在我使用 VS 开发环境并将其设置为在调试时不打开任何页面的本地计算机上，侦听器启动时尚未浏览任何内容。但是，每当我部署到我的共享主机时，我必须通过 Web 浏览器访问该站点，然后侦听器才会启动。我无法访问 IIS 控制面板，但我可以通过“网站面板”软件对 IIS 进行一些有限的设置更改。我相信共享主机使用 IIS 7.5。

有没有更好的方法来解决这个问题，而不是从我的家用 PC 创建轮询服务以每隔一段时间向共享主机发送 HTTP 请求以启动侦听器？

要求

*   客户端通过可配置的端口发送 UDP 数据包。除了客户端用于连接的 IP 和端口之外，我无法更改任何内容
*   该解决方案必须与我的共享主机一起使用，因为此时我买不起 VPS - 否则我会创建一个 Windows 服务。我之前通过 WCF Application_Start 创建轮询服务来解决创建窗口服务的问题，但这仅有效，因为用户看到的信息必须在网页上，因此始终会调用 application_start。在这种情况下，用户/客户不一定访问网页。

想法：

*   以某种方式将其拉入.svc。这样，当客户端访问 .svc 时，它会启动其他所有人的侦听器。但是在 80 端口上运行的 .svc 怎么能接受 UDP 调用呢？我也不确定客户端是否能够连接到多个 IP:PORT（我认为它不会接受像 URL.com/awesomeListener.svc 这样的 .svc 路径）。

有什么建议么？太感谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:02:16.230

如果您正在运行 ASP.NET 4.0，您可以将其设置为自动启动，这将触发 Application_Start：

[http://weblogs.asp.net/scottgu/archive/2009/09/15/auto-start-asp-net-applications-vs-2010-and-net-4-0-series.aspx](http://weblogs.asp.net/scottgu/archive/2009/09/15/auto-start-asp-net-applications-vs-2010-and-net-4-0-series.aspx)

# android - 如何赶上那个卷被改变了？

> ID：11925758
> 
> 赞同：0
> 
> 时间：2012-08-12T20:45:11.403
> 
> 标签：android

我`SeekBar`用于设置音量。我执行以下操作：

1.  我通过 获取当前音量`getStreamVolume()`并将其传递给`SeekBar`元素`setProgress()`。
2.  我通过 收听来自`SeekBar`元素的消息`onStopTrackingTouch()`并设置音量`setStreamVolume()`。有用。

但用户可以通过硬件音量控制来改变音量。我想抓住它并`SeekBar`适当地改变指针位置。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:29:30.150

尝试以下

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)  {
  if (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN || keyCode == KeyEvent.KEYCODE_VOLUME_UP) {
    //set your SeekBar  
    return true;
  }

 return super.onKeyDown(keyCode, event);
} 
```

biegleux 指出的问题/答案仅适用于连接耳机上的“媒体键”，而不适用于手机本身的硬件音量增大/减小键。

# arrays - Perl 子例程和数组

> ID：11925759
> 
> 赞同：1
> 
> 时间：2012-08-12T20:45:15.803
> 
> 标签：arrays, perl, subroutine

我刚开始使用 Perl（大约 15 分钟前）使用在线教程。我做了一个小子程序来测试一些 Perl 功能，并想知道是否可以在运行时确定传递给 sub' 调用的参数是数组还是标量。让我们以我写的 sub 为例：

```
#!/usr/bin/perl

sub somme_prod {
    if (scalar(@_) > 1) {
        $facteur = shift(@_);
        foreach my $nb (@_) {
            $resultat += $nb
        }
        return ($resultat * $facteur);
    }
    else {
        return "ERREUR";
    }
}

print somme_prod(2, 2, 3, 7); 
```

这是一个基本的 sum-product 子例程，其功能完全符合其名称。现在，是否可以修改此子例程以允许像这样混合使用数组和标量？

```
somme_prod(2, (2,3), 7);
somme_prod(2, (2,3,7));
#... 
```

*此外，非常*欢迎对此处演示的 Perl 编码风格发表任何评论。我有业余 C++ 编码的背景，所以我可能不会考虑 Perl。

编辑：我很抱歉。我实际上是在发布后*尝试过*的，似乎 Perl 确实按照我的意愿处理了我的 sub。现在我想我的问题会更多“Perl 如何知道如何处理这个”？

编辑了更多 Perl 版本的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T20:50:22.080

是的; 在 Perl 中，您可以创建对数组（或哈希或其他任何东西）的引用，以将多个值填充到单个参数中。

例如：

```
somme_prod(2, [2, 3], 7); 
```

...将解决：

```
sub somme_prod {
  foreach my $arg (@_) {
    if (ref($arg) eq 'ARRAY') {
      my @values = @$arg; # dereference, e.g. [2, 3] -> (2, 3)
      . . .
    } else {
      # single value, e.g. "2" or "7"
    }
  }
} 
```

您可以阅读该页面`perldoc perlref`以了解有关参考的所有信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T22:10:07.257

Perl 以不同的方式处理列表和数组，您可以阅读一份有用的文档：[`What is the difference between a list and an array?`](http://perldoc.perl.org/perlfaq4.html#What-is-the-difference-between-a-list-and-an-array?)

Perl 将*始终*展平嵌套列表（以及列表中的数组），所以

```
my @data1 = (2, (2, 3), 7); 
```

或者

```
my @data2 = (2, 3);
my @data1 = (2, @data2, 7); 
```

相当于

```
my @data1 = (2, 2, 3, 7); 
```

正如凯文所说，如果你想要嵌套数组，你必须在子列表出现的地方放置一个数组*引用。*因为引用是一个标量，所以它不会被扩展。

您的子程序很好，但使用一些事实上的标准将帮助其他人遵循您的程序。首先约定是如果有错误子程序会返回`undef`，这样你就可以写

```
sous_routine($p1, $p2) or die "Erreur"; 
```

在这种情况下，零是有效结果的可能性破坏了这一点，但最好还是遵守规则。没有参数的plain`return`表示错误

稍微整理一下并使用`unless`and `if`as 语句修饰符就可以做到这一点

```
sub somme_prod {
  return unless @_ > 1;
  my $facteur = shift;
  my $somme = 0;
  $somme += $_ for @_;
  return $somme * $facteur;
}

print somme_prod(2, 2, 3, 7); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T23:46:14.950

你已经了解 Perl 15 分钟了？现在忘记*参考*。

基本上，传递给子例程的所有内容都是一个数组。实际上，它存储在一个名为`@_`.

```
# /usr/bin/env perl

use strict;   #ALWAYS USE!
use warnings; #ALWAYS USE!

my @array = qw(member1 member2 member3 member4);

foo(@array, 'scalar', 'scalar', 'scalar');

sub foo {

print "My input is " . join (":", @_) . "\n"; 
```

这将打印：

```
my input is member1:member2:member3:member4:scalar:scalar:scalar 
```

无法分辨哪些条目来自数组，哪些来自标量。就您的子例程而言，它们都是数组的成员`@_`。

* * *

顺便说一下，Perl 带有一个名为`perldoc`. 当有人说要查看`perlref`时，您可以在`perldoc perlref`命令行输入并查看文档。您还可以访问该站点，该站点也将包含在命令`http://perldoc.perl.org`中找到的相同信息。`perldoc`

* * *

现在关于参考......

Perl 数组的数据元素或哈希值只能包含一个值。它可以是字符串，可以是实数，也可以是整数，还可以是对另一个 Perl 数据结构的*引用。*这就是所有乐趣和金钱的所在。

例如，`foo`上面的相同子例程可能会获取以下信息：

```
foo(\@array, 'scalar', 'scalar', 'scalar'); #Note the backslash! 
```

在这种情况下，您不会传入`@array`into的值`foo`。相反，对数组的引用作为 的第一个数据元素传递`@_`。如果您尝试 print out `$_[0]`，您会得到类似`ARRAY:6E43832`数据元素是一个数组以及它在内存中的位置的信息。

现在，您可以使用该`ref`函数来查看一条数据是否为引用以及它是引用的类型：

```
 sub foo {
     foreach my $item (@_) {

        if (ref $item eq 'ARRAY') {
           print "This element is a reference to an array\n";
        }
        elsif (ref $item eq 'HASH') {
           print "This element is a reference to a hash\n";
        }
        elsif (ref $item) {   #Mysterious Moe Reference
            print "This element is a reference to a " . lc (ref $item) . "\n";
        }
        else {
            print "This element is a scalar and it's value is '$item'\n";
        }
    }
} 
```

当然，您对数组的引用可能是一个包含对包含对数组的引用等的哈希的引用的数组。Perl 附带一个名为`Data::Dumper`（您可以使用`perldoc`它来查看有关它的信息）的模块，它将打印出整个数据结构。

这就是面向对象 Perl 的工作方式，因此在一段 Perl 数据中嵌入对其他 Perl 数据结构的引用非常普遍。

现在，只需熟悉基本的 Perl 及其工作原理。然后，开始查看[Perldoc](http://perldoc.perl.org)中有关[Perl 引用](http://perldoc.perl.org/perldsc.html)的[各种教程](http://perldoc.perl.org/perlreftut.html)。

# iphone - iPhone cocos2d box2d 机身碰撞检测无需施力

> ID：11925760
> 
> 赞同：0
> 
> 时间：2012-08-12T20:45:17.080
> 
> 标签：iphone, cocos2d-iphone, collision-detection, box2d-iphone

我正在为 iPhone 编写 Cocos2D box2d 游戏。我有 2 个动态物体，我希望它们是从外部施加的力，但它们不会相互施加力并检测到它们的碰撞。我怎样才能做到这一点？

我也希望他们在碰撞后一起移动到同一个位置。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T14:24:10.417

> 他们不会互相施力并检测到他们的碰撞

听起来您可能想查看碰撞过滤。这个答案有一些代码可以动态改变身体的碰撞过滤指数[https://stackoverflow.com/a/11283206/735204](https://stackoverflow.com/a/11283206/735204)

> 碰撞后它们在同一位置一起移动

可能是某种接头（例如焊接接头？）

来自手册： http: [//www.box2d.org/manual.html](http://www.box2d.org/manual.html)

> 关节用于将物体约束到世界或相互约束。游戏中的典型例子包括布娃娃、跷跷板和滑轮。关节可以以许多不同的方式组合以创建有趣的动作。
> 
> 一些关节提供限制，因此您可以控制运动范围。一些关节提供可用于以规定速度驱动关节直到超过规定力/扭矩的马达。
> 
> 关节马达有多种用途。您可以通过指定与实际位置和所需位置之间的差异成比例的关节速度来使用电机来控制位置。您还可以使用电机来模拟关节摩擦：将关节速度设置为零并提供一个小但显着的最大电机力/扭矩。然后电机将试图阻止关节移动，直到负载变得太强。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-05T08:50:46.507

对不起最后一个答案，只是检查我可以写它。

那这个呢？

```
bodyDef.isSensor = true; 
```

并使用 ContactListener 检测碰撞。[Box2d 用于碰撞检测](http://www.raywenderlich.com/606/box2d-tutorial-for-ios-how-to-use-box2d-for-just-collision-detection-with-cocos2d-iphone)

您也可以使用 box2d 过滤器。例如：

记住：如果 groupIndex < 0，相同的物体永远不会相互碰撞。这就是你所需要的。

```
b2Filter bodyFilter;
 bodyFilter.groupIndex = -1; 
 bodyFilter.categoryBits = 0x0002;

 fixtureDef.filter = bodyFilter; 
```

# facebook - 带有注册的论坛脚本（或插件）抛出社交网络（facebook、google 和 vkontakte）

> ID：11925762
> 
> 赞同：1
> 
> 时间：2012-08-12T20:45:32.247
> 
> 标签：facebook, forum, google-plus, vk

我希望将论坛上传到我的网站。我在过去有一些使用 phpBB 的经验。我不喜欢注册表。我希望让人们可以选择使用他们的社交网络资料进行注册。

我搜索了 phpBB 插件，发现在开发阶段很少有非常关键的评论。

我对 facebook、google 和 vkontakte 网络感兴趣。

你能推荐这样的论坛脚本或插件吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T13:21:07.800

我还没有找到具有开箱即用所需功能的论坛，但 VanillaForums 有 OpenID、Facebook、Google 和 Vkontakte 插件

以前我使用过 phpBB，但我没有找到所有需要的插件。phpBB 的最佳解决方案是 loginza 和类似服务，但我喜欢在没有第三方服务的情况下工作。

# asp.net - 为什么 .Net WebApi 不会自动检测请求 contentType 并进行自动绑定？

> ID：11925769
> 
> 赞同：1
> 
> 时间：2012-08-12T20:46:18.000
> 
> 标签：asp.net, asp.net-mvc, http, rest, asp.net-web-api

为什么 .Net WebApi 不会自动检测请求 contentType 并进行自动绑定？

如果我在未通知 contentType 的情况下发出请求，则会发生 HTTP 500 错误：

```
No MediaTypeFormatter is available to read an object of type 'ExampleObject' from content with media type ''undefined''. 
```

为什么不尝试检测传入的数据并自动绑定？

另一个案例：

这个请求`Content-Type: application/x-www-form-urlencoded`发送一个`JSON`：

```
User-Agent: Fiddler
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Host: localhost:10329
Content-Length: 42

Request Body:
{"Name":"qq","Email":"ww","Message":"ee"}: 
```

我的操作不会在对象参数中自动检测 JSON 请求数据：

```
public void Create(ExampleObject example) //example is null
{
{ 
```

为什么他们不尝试解决它，而不是让对象为空？

然后，为了发生绑定，我需要发送`Content-Type: application/json`.

如果 .Net WebAPI 检测到请求数据的类型并进行自动绑定，那将是最好的吗？为什么不这样呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:19:56.890

听起来您想要做的是从服务器接受多种格式。

http 的工作方式是客户端向服务器请求资源并告诉服务器它理解的内容类型。这意味着客户端没有得到它无法解码的响应，并且服务器知道哪些响应更适合客户端。例如，如果您是 Web 浏览器，最合适的内容类型是 text/html，但如果您获得 XML，您可能也可以用它做一些事情。因此，您将使用以下内容提出请求：

```
 accept: text/html, application/xml 
```

这说明你更喜欢 html 但也懂 XML

在您的示例中，如果您的客户想要 application/x-www-form-urlencoded 但也可以处理 JSON，那么您应该在发出请求时执行以下操作

```
 accept: application/x-www-form-urlencoded, application/json 
```

有关更多详细信息，请参阅此处的接受标头 HTTP 规范[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

您可能还想创建一个新的媒体类型格式化程序，以便您的服务器知道如何为客户端提供 application/x-www-form-urlencoded，请查看此博客文章以获取有关如何执行此操作的更多信息[http://www。 strathweb.com/2012/04/rss-atom-mediatypeformatter-for-asp-net-webapi/](http://www.strathweb.com/2012/04/rss-atom-mediatypeformatter-for-asp-net-webapi/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:59:04.090

application/x-www-form-urlencoded 表示您将以 x-www-form-urlencoded 标准发送数据。以其他标准发送数据将不起作用。

# javascript - 将 Flash 对象嵌入 html 的 Javascript 不起作用

> ID：11925770
> 
> 赞同：0
> 
> 时间：2012-08-12T20:46:40.717
> 
> 标签：javascript, object, embed, shockwave

我正在尝试使用 javascript 显示一些嵌入 SWF 对象的 html。

该脚本在没有 SWF 对象的情况下工作正常。但是，当对象包含在插入到 div 中的 html 中时，脚本不再运行。

如果有人可以建议修复或发现错误，我将不胜感激。

这是jsfiddle。

[http://jsfiddle.net/UJpQ4/](http://jsfiddle.net/UJpQ4/)

代码（与 jsfiddle 相同）：

html:

```
<a href="javascript:void(0)" onclick="takeProfilePic('0');">Show Flash</a>
<a href="javascript:void(0)" onclick="takeProfilePic('1');">Do not show flash</a>
<tr><td colspan=2 align="center"><div id="takepic"></div> 
```

javascript:

```
function takeProfilePic(type) {
//   alert(type);
if (type==0)
  {
   var target = 'takepic';
   var photo = '<tr><td colspan=2 align="center">hello</td></tr>';
document.getElementById(target).innerHTML = photo;
return false;
  }
    else if (type==1) {
        var target = 'takepic';
   var photo = '<tr><td colspan=2 align="center"><a href="stepthree.php"><img src="images/collapse.gif" border=0></a></td></tr><tr><td colspan=2 align="center">NO FLASH OBJECT HERE</td></tr>';
  document.getElementById(target).innerHTML = photo;
return false;      
    }     
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T10:41:43.600

使用`EMBED`标签而不是`OBJECT`标签。

```
function takeProfilePic(type) {
//   alert(type);
if (type==0)
  {
   var target = 'takepic';
   var photo = '<tr><td colspan=2 align="center"><a href="stepthree.php"><img src="images/collapse.gif" border=0></a></td></tr><tr><td colspan=2 align="center"><div id="piccontent"><embed src="file.swf" type="application/x-shockwave-flash" width="520" height="400" /></div></td></tr>';
   document.getElementById(target).innerHTML = photo;
   return false;
  }
  else if (type==1) {
   var target = 'takepic';
   var photo = '<tr><td colspan=2 align="center"><a href="stepthree.php"><img src="images/collapse.gif" border=0></a></td></tr><tr><td colspan=2 align="center"><div id="piccontent">NO FLASH OBJECT HERE</div></td></tr>';
   document.getElementById(target).innerHTML = photo;
   return false;      
  }     
} 
```

# javascript - 隐藏/显示 DIV - 将当前效果更改为淡出

> ID：11925772
> 
> 赞同：0
> 
> 时间：2012-08-12T20:46:41.413
> 
> 标签：javascript, jquery

我目前正在使用以下在网络教程中找到的代码来显示/隐藏 DIV。它工作得很好，但不喜欢这种效果。希望 DIV 改为淡入/淡出（或者更平滑，目前 DIV 从右上角开始增长）。我怎样才能调整代码来做到这一点？你可以在这里看到它[http://jsfiddle.net/Grek/w4HWn/1/](http://jsfiddle.net/Grek/w4HWn/1/)非常感谢

```
function showonlyone(thechosenone) {
     $('.textzone').each(function(index) {
          if ($(this).attr("id") == thechosenone) {
               $(this).show(2000);
          }
          else {
               $(this).hide(2000);
          }
     });
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T20:48:30.750

只需更改`.hide()`为`.fadeOut()`和`.show()``.fadeIn()`

但是看看你的例子，你可以通过使用数据属性来简单得多。

看看这个[例子](http://jsfiddle.net/w4HWn/13/)。

您可能需要绝对定位或其他一些技术，因为两个 div 在淡入和淡出时会堆叠起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T20:56:45.317

可以使用`fadeIn`and`fadeOut`方法，也可以缩小代码，试试下面的：

```
function showonlyone(thechosenone) {
     $('.textzone').fadeOut();
     $('#'+thechosenone).fadeIn();
} 
```

* * *

当您使用 jQuery 时，您可以使用 jQuery`click`处理程序：

HTML：

```
<div class="source-title-box"><span class="activity-title"><a href="#source-region">Our region</a></span></div>
<div class="source-title-box"><span class="activity-title"><a href="#source-oursource">Our source</a></span></div> 
```

jQuery：

```
$('.activity-title a').click(function(e){
    e.preventDefault()
     var thechosenone = $(this).attr('href');
    $('.textzone').fadeOut(600, function(){
         $(thechosenone).fadeIn(600);
    });   
}) 
```

[演示](http://jsfiddle.net/w4HWn/12/)

# java - 如何在 Java 中获取密钥交换和身份验证协议

> ID：11925775
> 
> 赞同：3
> 
> 时间：2012-08-12T20:47:56.290
> 
> 标签：java, sockets, ssl, network-programming

我知道`.getPublicKey()`返回公钥类型的方法。但是，这个函数并没有说明使用了哪种类型的密钥交换（EDH 或 RSA）。如果我是对的，它只返回公钥的类型。我的问题是：当我启动与远程服务器的 SSL 连接时，如何获得使用的密钥交换和身份验证协议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T21:03:47.940

从 an`SSLSocket`或 an`SSLEngine`中，首先获取[`SSLSession`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSession.html)，它将为您提供有关当前 SSL/TLS 会话的一些信息。

如果使用[`getCipherSuite()`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSession.html#getCipherSuite%28%29)，您将获得密码套件名称，其中包含密钥交换类型（和加密算法）。[SunJSSE 提供者文档](http://docs.oracle.com/javase/7/docs/technotes/guides/security/SunProviders.html#SunJSSEProvider)中列出了 Oracle JRE 中实现的密码套件。[您可以在TLS 规范](https://www.rfc-editor.org/rfc/rfc4346#appendix-C)中找到命名约定：之后`TLS_`（或`SSL_`旧名称）和之前的第一部分`_WITH_`将告诉您密钥交换算法（、、、、、`DHE_DSS`或）：`DHE_RSA`一个`DH_anon`相对简单`DH_DSS`的正则表达式应该能够提取相关信息。`DH_RSA``NULL``RSA`

（你提到了`getPublicKey()`，但你没有说你在哪里调用它。它必须适用于服务器的证书，也从 获得`SSLSession`。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-12T21:03:02.330

我假设这`.getPublicKey()`是[证书](http://docs.oracle.com/javase/6/docs/api/java/security/cert/Certificate.html)
的方法 您可以使用[PublicKey#getAlgorithm()](http://docs.oracle.com/javase/6/docs/api/java/security/Key.html#getAlgorithm%28%29)来查找算法

> 字符串 getAlgorithm()
> 
> 返回此键的标准算法名称。例如，“DSA”表示此密钥是 DSA 密钥。有关标准算法名称的信息，请参阅 Java Cryptography Architecture API Specification & Reference 中的附录 A。

# mercurial - 多重身份验证与 Nginx 代理一起使用

> ID：11925776
> 
> 赞同：0
> 
> 时间：2012-08-12T20:48:08.063
> 
> 标签：mercurial, proxy, nginx, hgweb, proxypass

我正在尝试`proxy_pass`在 Nginx 中验证几个位置。Nginx 配置如下：

```
server {
    listen       443;
    server_name  example.com;

    location /hg/ {
        rewrite      ^/hg/(.*)$ /$1 break;
        proxy_pass   http://127.0.0.1:8001;

        auth_basic            "hg";
        auth_basic_user_file  hg.htpasswd;

        location /hg/repo1/ {
            auth_basic            "hg-repo1";
            auth_basic_user_file  repo1.htpasswd;
        }

        location /hg/repo2/ {
            auth_basic            "hg-repo2";
            auth_basic_user_file  repo2.htpasswd;
        }
    }
} 
```

身份验证工作正常，但代理在嵌套位置（repo1、repo2）被破坏。似乎`proxy_pass`配置没有被继承。因此，Nginx 返回 404（在 /hg/repo1 和 /hg/repo2 上）。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T22:54:09.363

您需要`proxy_pass`为每个`location`块重复。

此外，没有嵌套`location`块的功能。通常它们不是嵌套的。

# c++ - OpenCV，如何使用点数组来平滑和采样轮廓？

> ID：11925777
> 
> 赞同：14
> 
> 时间：2012-08-12T20:48:12.173
> 
> 标签：c++, opencv, contour, sampling

我在 OpenCV（C++ API）中对平滑和采样轮廓有一个问题。假设我已经从中检索到点序列`cv::findContours`（例如应用于此图像：

![在此处输入图像描述](../Images/204ec0c3e4c8ae6b88dcbe211868a5ff.png)

最后，我想要

1.  使用不同的内核平滑一系列点。
2.  使用不同类型的插值调整序列大小。

平滑后，我希望得到如下结果：

![在此处输入图像描述](../Images/31eaa2b5d5b9111c0d05201cb2dc7c27.png)

我还考虑过在 a 中绘制我的轮廓`cv::Mat`，过滤 Mat（使用模糊或形态学操作）并重新找到轮廓，但速度很慢且次优。所以，理想情况下，我可以只使用点序列来完成这项工作。

我阅读了一些关于它的帖子，并天真地认为我可以简单地将 a `std::vector`(of `cv::Point`) 转换为 a `cv::Mat`，然后像 blur/resize 这样的 OpenCV 函数将为我完成这项工作......但他们没有。

这是我尝试过的：

```
int main( int argc, char** argv ){

    cv::Mat conv,ori;
    ori=cv::imread(argv[1]);
    ori.copyTo(conv);
    cv::cvtColor(ori,ori,CV_BGR2GRAY);

    std::vector<std::vector<cv::Point> > contours;
    std::vector<cv::Vec4i > hierarchy;

    cv::findContours(ori, contours,hierarchy, CV_RETR_CCOMP, CV_CHAIN_APPROX_NONE);

    for(int k=0;k<100;k += 2){
        cv::Mat smoothCont;

        smoothCont = cv::Mat(contours[0]);
        std::cout<<smoothCont.rows<<"\t"<<smoothCont.cols<<std::endl;
        /* Try smoothing: no modification of the array*/
//        cv::GaussianBlur(smoothCont, smoothCont, cv::Size(k+1,1),k);
        /* Try sampling: "Assertion failed (func != 0) in resize"*/
//        cv::resize(smoothCont,smoothCont,cv::Size(0,0),1,1);
        std::vector<std::vector<cv::Point> > v(1);
        smoothCont.copyTo(v[0]);
        cv::drawContours(conv,v,0,cv::Scalar(255,0,0),2,CV_AA);
        std::cout<<k<<std::endl;
        cv::imshow("conv", conv);
        cv::waitKey();
    }
    return 1;
} 
```

谁能解释如何做到这一点？

此外，由于我可能使用更小的轮廓，我想知道这种方法如何处理边界效果（例如，在平滑时，由于轮廓是圆形的，因此必须使用序列的最后一个元素来计算第一个元素...）

非常感谢您的建议，

**编辑：**

我也尝试过`cv::approxPolyDP()`，但是如您所见，它倾向于保留极值点（我想删除）：

ε=0

![在此处输入图像描述](../Images/455e0bee35340344af80f7abb577d534.png)

ε=6

![在此处输入图像描述](../Images/b4478907f6c5e5e85e3bfb1f2193f8ea.png)

ε=12

![在此处输入图像描述](../Images/564cbd3ec17976471d00f01309a22913.png)

ε=24

![在此处输入图像描述](../Images/95c1bb27b42c74e158a05c48c48a916c.png)

**编辑 2：** 正如 Ben 所建议的，似乎`cv::GaussianBlur()`不支持，但支持`cv::blur()`。它看起来非常接近我的预期。这是我使用它的结果：

k=13

![在此处输入图像描述](../Images/80d022f50417ee76bebee43503ef82a0.png)

k=53

![在此处输入图像描述](../Images/b8332f636222a477e5616a615600d985.png)

k=103

![在此处输入图像描述](../Images/da1648a20860a33cc42f54fdb1a5dbf9.png)

为了绕过边界效应，我做了：

```
 cv::copyMakeBorder(smoothCont,smoothCont, (k-1)/2,(k-1)/2 ,0, 0, cv::BORDER_WRAP);
    cv::blur(smoothCont, result, cv::Size(1,k),cv::Point(-1,-1));
    result.rowRange(cv::Range((k-1)/2,1+result.rows-(k-1)/2)).copyTo(v[0]); 
```

我仍在寻找对我的轮廓进行插值/采样的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T13:00:40.090

您的高斯模糊不起作用，因为您在列方向上模糊，但只有一列。尝试将向量复制回 a 时，使用`GaussianBlur()`会导致 OpenCV 中出现“未实现功能”错误`cv::Mat`（这可能就是您`resize()`的代码中出现这种奇怪现象的原因），但使用 . 一切正常`cv::blur()`，无需`resize()`. 例如，尝试大小（0,41）。[用于边界问题](https://stackoverflow.com/questions/3065439/how-to-smooth-a-cyclic-column-vector)`cv::BORDER_WRAP`似乎也不起作用，但这是另一个找到解决方法的人的线程。

哦……还有一件事：你说你的轮廓可能要小得多。以这种方式平滑你的轮廓会缩小它。极端情况是`k = size_of_contour`，这会导致单点。所以不要选择你的k太大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-06T18:36:03.710

另一种可能性是使用 openFrameworks 使用的算法：

[https://github.com/openframeworks/openFrameworks/blob/master/libs/openFrameworks/graphics/ofPolyline.cpp#L416-459](https://github.com/openframeworks/openFrameworks/blob/master/libs/openFrameworks/graphics/ofPolyline.cpp#L416-459)

它遍历轮廓，本质上是使用它周围的点应用低通滤波器。应该以低开销和（没有理由对本质上只是轮廓的图像进行大过滤）做你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T09:30:40.253

[approxPolyDP()](http://docs.opencv.org/trunk/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=approxpoly#approxpolydp)怎么样？

它使用[此](http://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm)算法来“平滑”轮廓（基本上摆脱了轮廓的大部分点，并留下那些代表轮廓的良好近似值的点）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T09:24:13.970

从 2.1 OpenCV doc section [Basic Structures](http://opencv.willowgarage.com/documentation/cpp/core_basic_structures.html)开始：

```
template<typename T>
explicit Mat::Mat(const vector<T>& vec, bool copyData=false) 
```

您可能希望将第二个参数设置为`true`：

```
smoothCont = cv::Mat(contours[0]); 
```

然后再试一次（这样`cv::GaussianBlur`应该可以修改数据）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-11T18:26:07.193

我知道这是很久以前写的，但是您是否尝试过大腐蚀，然后大扩张（开口），然后找到计数？它看起来像一个简单而快速的解决方案，但我认为它至少在某种程度上是可行的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-26T14:23:28.607

基本上，轮廓的突然变化对应于高频内容。平滑轮廓的一种简单方法是找到傅立叶系数，假设坐标形成复平面 x + iy，然后消除高频系数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-25T06:21:32.003

我的看法......多年后......！

也许有两种简单的方法来做到这一点：

*   用扩张、模糊、腐蚀循环几次。并找到该更新形状的轮廓。我发现 6-7 次效果很好。
*   创建轮廓的边界框，并在有界矩形内绘制一个椭圆。

添加下面的视觉结果：

[![在此处输入图像描述](../Images/8b24b296b3450157b40d4d6a77bccb92.png)](https://i.stack.imgur.com/qeNiS.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-24T12:23:14.640

这适用于我。边缘比以前更平滑：

```
medianBlur(mat, mat, 7)
morphologyEx(mat, mat, MORPH_OPEN, getStructuringElement(MORPH_RECT, Size(12.0, 12.0)))
val contours = getContours(mat) 
```

这是 opencv4android 代码。

# jquery-mobile - 当另一个页面使用 JQuery 调用页面时，Google 地图未加载

> ID：11925778
> 
> 赞同：1
> 
> 时间：2012-08-12T20:48:24.337
> 
> 标签：jquery-mobile

当我直接打开页面时，地图部分将加载。但是，当我从另一个页面上的链接打开该页面时，地图将不会加载。我看到以前的帖子说脚本不能在 Head 标签中，因为它们不会加载。但是，当我将它们放在该`data-role="page"`部分中时，它仍然无法加载地图。我的代码如下。提前致谢。

```
<!DOCTYPE html>    
<html lang="en">         
  <head>             
    <title>Boilerplate              
    </title>             
    <meta charset="utf-8" />             
    <meta name="viewport" content="width=device-width,initial-scale=1" />             
    <link rel="stylesheet" href="http://code.jquery.com/mobile/latest/jquery.mobile.min.css" />        
<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>        
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>        
<script type="text/javascript" charset="utf-8" src="http://code.jquery.com/mobile/latest/jquery.mobile.min.js"></script>        
<script type="text/javascript" charset="utf-8" src="./ui/jquery.ui.map.js"></script>        
<script type="text/javascript">
           $(function() {
             $('#map_canvas').gmap();
           });
            </script>                                                                                   
  </head>         
  <body>             
    <div id="detailpage" data-role="page" data-theme="c" data-add-back-btn="true">                     
      <div data-role="header" data-id="head1" data-position="fixed">  <h1>Header</h1>                 
      </div>  
      <!-- /header -->                 
      <div data-role="content">              
        <hr>          <b>Title Section</b>                                                            
        <hr>              This is a detailed description section where we can insert some content here with                                                 
        <br>              some page breaks in it.                                                 
        <br>                                                 
        <hr>              This section contains details about the businsess and some other controls and forms.             
        <br>            
        <br>            
        <hr>                           
        <div id="map_canvas" style="width:100%;height:250px">                     
        </div>          
      </div>
      <!-- /content -->           
      <div data-role="footer" data-id="foot1" data-position="fixed">                     
        <div data-role="navbar">                                                                                                                  
          <ul>                                                                                                                                    
            <li>                                                                                                                         
            <a href="a.html">D</a>                                                                                                                         
            </li>                                                                                                                                     
            <li>                                                                                                                         
            <a href="b.html">C</a>                                                                                                                         
            </li>                                                                                                                                     
            <li>                                                                                                                         
            <a href="c.html">P</a>                                                                                                                         
            </li>                                                                                                                                    
          </ul>                                                                                           
        </div>                                                                                         
        <!-- /navbar -->           
      </div>  
      <!-- /footer -->             
    </div>         
  </body>    
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T01:43:23.597

标头仅在访问的第一个 JQuery Mobile 页面上加载。每个单独页面的脚本都应包含在该`data-role="page"`页面的 div 中。

此外，您的谷歌地图加载应该看起来像这样。

```
var latlng = new google.maps.LatLng(lat, lng);
var myOptions = {
     zoom: 12,
     center: latlng,
     mapTypeId: google.maps.MapTypeId.SATELLITE
};

map = new google.maps.Map(document.getElementById("map_canvas"),myOptions); 
```

这是 Google关于 Google Maps API的[入门部分。](https://developers.google.com/maps/documentation/javascript/tutorial#HelloWorld)

# python - 使用相机检测运动有哪些好方法？(opencv)

> ID：11925782
> 
> 赞同：0
> 
> 时间：2012-08-12T20:48:50.447
> 
> 标签：python, opencv

我正在寻找一些检测运动的方法。我试过其中两个。一种方法是在程序启动时设置背景帧，并将其他帧与该背景帧进行比较（阈值）。其他方法是将当前帧（我们称之为帧 A）与第 1 帧（A 之前的帧）进行比较。这些方法都不是很好。我想知道其他更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T22:49:20.120

看一下这个：

1.  [使用 Python 进行运动检测](http://bogdanmarian.com/motion/)
2.  [运动追踪 Python](http://derek.simkowiak.net/motion-tracking-with-python/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T21:11:39.957

[Lucas-Kande](http://en.wikipedia.org/wiki/Lucas%E2%80%93Kanade_method)方法值得一看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T21:44:25.120

请阅读《**Learning OpenCV: Computer Vision with the OpenCV Library 》一书**

它有理论和示例代码。

# javascript - 具有不同专辑的 JQuery 轮播或画廊

> ID：11925791
> 
> 赞同：0
> 
> 时间：2012-08-12T20:50:32.927
> 
> 标签：javascript, jquery, ajax, gallery

我正在寻找可以让我拥有不同专辑的 jQuery 画廊或滑块。基本上我想要多个 jQuery 画廊，不希望它加载一个新页面来查看新内容。

我不是在寻找任何花哨的东西，只是在内容之上的链接能力。我知道 html、css，我熟悉 javascript，并且我愿意对 ajax 或您可能建议的任何其他方法进行研究，因此自定义应该不是问题。

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T20:54:23.777

大多数 jQuery 画廊插件可以处理在同一页面上有多个画廊。

我会将它与一个简单的 jQuery 选项卡插件（[比如这个](https://gist.github.com/1165391)）结合起来，以获得你想要的结果。

# sparql - 查询具有人类发展指数的国家的 DBpedia

> ID：11925798
> 
> 赞同：2
> 
> 时间：2012-08-12T20:51:25.800
> 
> 标签：sparql, dbpedia

我正在尝试查询 DBpedia 中的所有国家并获取他们的人类发展指数。我正在尝试的查询是：

```
SELECT *
WHERE {
?Country a <http://dbpedia.org/ontology/Country> .
?Country <http://dbpedia.org/ontology/humanDevelopmentIndex> ?humanDevelopmentIndex .
}
LIMIT 1000 
```

谁能解释为什么这个查询没有返回任何结果？这对我来说似乎很简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:15:30.837

您没有得到任何回报，因为显然，DBpedia 中的所有国家/地区都没有`humanDevelopmentIndex`与它们相关的属性。

您可以自己验证这一点。如果您简化查询以返回国家/地区：

```
SELECT *
WHERE {
?Country a <http://dbpedia.org/ontology/Country> .
}
LIMIT 1000 
```

您将返回一个国家/地区列表，因此很明显，添加其他属性模式会导致查询不匹配任何结果。此外，如果您查看例如[DBPedia](http://dbpedia.org/page/Australia)中的 Austrialia 的数据，您将不会在那里找到您想要的属性。

它没有出现的原因是您想要的数据可能位于`ontology_infobox_properties`或`ontology_infobox_properties_specific`数据集中。这些[不会在公共端点中公开](http://wiki.dbpedia.org/DatasetsLoaded)，但您可以[下载它们](http://wiki.dbpedia.org/Downloads38)。

# php - 强制使用 PHP 下载文件，标头

> ID：11925799
> 
> 赞同：1
> 
> 时间：2012-08-12T20:51:37.863
> 
> 标签：php, mysql, download, readfile

我正在返回一个带有相应“下载”链接的表，这些链接由我的数据库中的 id 分配。用户单击“下载”并收到通知，他们将开始下载文件。现在我可以点击“下载”，我下载的文件不是所需的文件，它是 php 页面的回声。

这是当前代码：

配置文件.php

```
 <?php if (isset($_POST['query']))
   {
   require_once ('../mysqli_connect.php'); //Connect to the db

    // Make the query
   $genre = $_POST['select_genre'];
   $length = $_POST['select_length'];

    $upviews = "UPDATE upload
                SET views = views + 1
                WHERE genre = '$genre' AND length = '$length'";
    $runviewupdate = mysqli_query ($dbc, $upviews);

    $q = "SELECT upload_id, title, genre, length, created
        FROM upload
        WHERE genre = '$genre' AND length = '$length'
        ORDER BY created DESC, title DESC";

    $r = mysqli_query ($dbc, $q); // Run the query

    if($r)
    {
        // If it ran okay, display the records
        echo '<table align="center"
            cellspacing="3" cellpadding="3"
            width="75%">
           <tr><td align="left"><b>Title</b></td>
           <td align="left"><b>Genre</b></td>
           <td align="left"><b>Pages</b></td>
           <td align="left"><b>Submitted</b></td>
           <td align="left"><b>Download</b></td>';

        // Fetch and print all the records:

        while ($row = mysqli_fetch_array($r,MYSQLI_ASSOC))
        {
            echo '<tr><td align="left">' .
            $row['title'] . '</td><td align="left">'
            . $row['genre'] . '</td><td align="left">'
            . $row['length'] . '</td><td align="left">'
            . $row['created'] . '</td><td align="left">'
            //. $row['views'] . '</td><td align="left">'
            . "<a href='newpub_profile.php?id={$row['upload_id']}'>Download</a></td>" . '</td></tr>';
        }
        echo '</table>'; // Close the table

        mysqli_free_result ($r); // Free up the resources
    }
    else // If it did not run okay
    {
        // Public Message:

        echo '<p class="error">Your submissions could not be retrieved.  We
            apologize for any inconvenience.</p>';

        // Debugging message:

        echo '<p>' . mysqli_error($dbc) . '<br /><br />Query: ' . $q . '</p>';

    } // End of if ($r) IF.

}

//END DOWNLOAD HANDLER ******************************************************

    mysqli_close($dbc); // Close the database connection

                    // Make sure an ID was passed DOWNLOAD HANDLER *******
if(isset($_GET['id'])) {
// Get the ID
    $id = intval($_GET['id']); //var_dump($id);

    require_once ('../mysqli_connect.php'); //Connect to the db

// Fetch the file information
        $downloadq = "
            SELECT `file_type`, `size`, `title`, 'content', 'upload_id'
            FROM `upload`
            WHERE `upload_id` =".$id;
        $result = mysqli_query ($dbc, $downloadq); // Run the query

        if($result) {
            // Make sure the result is valid
            if (mysqli_num_rows($result) > 0) {
            // Get the row
                $row = mysqli_fetch_assoc($result);
                //var_dump($row);

                $place = './uploads/'.$_SESSION_['email'].'/';
                $thefile = $place.$row['title'];

                require('./download.php');
                filedownload();

                // Print headers
              // header("Content-Type: application/msword");
              // header("Content-Length: ". $row['size']);
              // header("Content-Disposition: attachment; filename=".$row['title']);
              // header("Content-Transfer-Encoding: binary");
              // readfile($thefile);

                // Print data
                //echo (stripslashes($row['content']));

                exit;

            }
            else {
                echo 'Error! No such ID.';
            }

            // Free the mysqli resources
            mysqli_free_result($result);
        }
        else {
            echo "Error! Query failed: <pre>{$dbc->error}</pre>";
        }
        mysqli_close($dbc);

    }

                    ?> 
```

下载.php

```
<?PHP

function filedownload()
{
               header("Content-Type: application/msword");
               header("Content-Length: ". $row['size']);
               header("Content-Disposition: attachment; filename=".$row['title']);
               header("Content-Transfer-Encoding: binary");
               readfile($thefile, 1);

}
               ?> 
```

表中的“下载”链接与数据库中文件的 ID 正确对应。单击“下载”会下载一个名为 profile.php 的文件，其中包含我的 php 和 html 标记。在此先感谢，这让我很难过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T20:58:28.503

试着放

```
global $row, $thefile; 
```

作为 filedownload() 函数中的第一行。我注意到您正在尝试使用此函数外部的变量。

# sql - 最佳 SQLite 查询删除重复项

> ID：11925804
> 
> 赞同：4
> 
> 时间：2012-08-12T20:52:16.160
> 
> 标签：sql, sqlite

我有两个具有以下设置的表：

```
category: (id, name)
item: (id, name, category_id) - category_id is foreign key to category table 
```

现在我正在编写一个查询以从仅使用的类别的类别表中检索一个子集：

```
SELECT c.id, c.name
FROM   category c
WHERE  c.id IN (SELECT DISTINCT category_id FROM item) 
```

上面的查询工作正常。我只是想知道这是否是进行查询的最佳方式，或者我是否可以通过连接或其他方式进行其他操作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T22:59:39.547

转换`IN (SELECT)`to`EXISTS (SELECT ... WHERE )`可能会有所帮助：

```
SELECT c.id, c.name
FROM   category c
WHERE EXISTS (SELECT 1 FROM item WHERE item.category_id = c.id) 
```

另一种可能性（我希望它会更慢，但它总是取决于你的数据库）：

```
SELECT c.id, c.name
FROM   category c
INNER JOIN item ON item.category_id = c.id
GROUP BY c.id 
```

或者你可以使用`DISTINCT`而不是`GROUP BY`：

```
SELECT DISTINCT c.id, c.name
FROM   category c
INNER JOIN item ON item.category_id = c.id 
```

如果速度很重要，别忘了`ANALYZE`不时打电话：

[http://www.sqlite.org/lang_analyze.html](http://www.sqlite.org/lang_analyze.html)

其他一些有趣的变体：

```
SELECT c.id, c.name
FROM   category c
INNER JOIN (SELECT DISTINCT item.category_id ) AS i_c ON i_c.category_id = c.id 
```

其他：

```
SELECT c.id, c.name
FROM   category c

EXCEPT

SELECT c.id, c.name
FROM   category c
LEFT JOIN item ON item.category_id = c.id
WHERE item.category_id IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T22:58:32.480

使用加入：

```
SELECT c.id, c.name
FROM   category c
JOIN item i on c.id=i.category_id 
GROUP BY c.id, c.name 
```

# java - 检查对象是否在列表中的规则

> ID：11925806
> 
> 赞同：0
> 
> 时间：2012-08-12T20:52:50.763
> 
> 标签：java, drools, drools-planner

如果对象也是列表的一部分，我如何通过 Drools 规则语言 (DRL) 检查？

让我们看一下考试示例。想象一下考试有一个房间和一个列表的情况。现在我想检查一下 Room 对象是否在列表中。有没有像 roomList.contains(rooms) 这样的功能？

我需要这个用于 DRL。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T19:47:18.993

对于这样的模型：

```
class Exam {
    Room room;
...
}
class Room {
    List<Room> roomsList;
...
} 
```

那么您的规则可能如下所示：

```
rule X
when
    $exam1 : Exam()
    $exam2 : Exam( room.roomsList contains $exam1.room )
then
    // do something
end 
```

您还可以使用“memberOf”运算符来检查元素是否是列表的成员，或者如果您使用 Drools 5.4+，则直接调用方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T21:02:57.527

如果您有机会了解 Java 中的集合框架列表...那么是的，我们确实有一个名为`frequency()`.

```
List<String> l = new ArrayList<String>();

Collections.frequency(l, "room1"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T23:31:39.897

我有以下情况

```
class Exam { 
   Room room;
   ...
}
class Room {
   List<Room> roomList
   ...
} 
```

我的 DRL 文件如下所示：

```
rule "containsRoomOfRoom"
when
    $topicConflict : TopicConflict($leftTopic : leftTopic, $rightTopic : rightTopic)
    $leftExam : Exam(topic == $leftTopic, $period : period, $leftRoom : room)
    $rightExam : Exam(topic == $rightTopic, period == $period, room.roomsList contains $leftRoom)
then
    insertLogical(new IntConstraintOccurrence("roomPenalty", ConstraintType.NEGATIVE_HARD,
            40,
            $leftExam, $rightExam)); 
```

结尾

我的问题是我想检查 leftExam 的房间是否在 rightExam 房间的 roomList 中。

很抱歉这个问题，但我没有找到任何语言参考。

# sql - 使用 cognos report studio 为 SQL 查询生成 Cognos 报告

> ID：11925810
> 
> 赞同：0
> 
> 时间：2012-08-12T20:53:44.987
> 
> 标签：sql, cognos

我是 Cognos 的新手。我正在尝试使用报告工作室创建报告，我有所需的包，并且我想使用在三个表之间连接的复杂 SQL 查询来创建报告。任何人都可以提出建议以开始构建报告吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T14:26:47.017

[如何为 Cognos 报告编写 SQL](http://www.youtube.com/watch?v=fJ3R09Oadf8)

FM 是为了创建复杂的模型。如果您需要一份快速而简单的报告，您可以按照教程所示指定自定义 SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T23:56:29.023

这取决于您在 Report Studio 中看到的数据是如何建模的，通常使用名为 Framework Manager 的工具连接到源表和视图并对其建模。Framework Manager 创建您在 Report Studio 中看到的包，它可以定义表等实体之间的关系（如果它们尚未在源数据库中定义）。

不知道如何从 Report Studio 判断关系是否已正确定义，而不是尝试将每个表中的字段拉入同一个 Report Studio 查询。最好与设计 Framework Manager 模型的人交谈或查看模型本身。

# python - 使用 Python 的 sys.argv 将函数结果返回到命令行？

> ID：11925813
> 
> 赞同：3
> 
> 时间：2012-08-12T20:54:35.517
> 
> 标签：python, linux, arguments, command-line-arguments

我有一个可执行文件。它有一个函数，我想将其结果返回到命令行，但是我不断收到 NameError 消息。为了分解，我正在使用 LinuxMint Lisa，到目前为止我有：

```
#! /usr/bin/env python
import mechanize
from BeautifulSoup import BeautifulSoup
import sys

def dictionary(word):
    br = mechanize.Browser()
    response = br.open('http://www.dictionary.reference.com')
    br.select_form(nr=0)
    br.form['q'] = word
    br.submit()
    definition = BeautifulSoup(br.response().read())
    trans = definition.findAll('td',{'class':'td3n2'})
    fin = [i.text for i in trans]
    query = {}
    for i in fin:
        query[fin.index(i)] = i
    return query

print dictionary(sys.argv) 
```

然后我从我的终端 chmod：

```
sudo chmod +x this_file.py 
```

当我从命令行调用此文件时，我将输入：

```
./this_file.py 'pass'(or any other string argument) 
```

哪个会返回：

```
TypeError: Must assign a string 
```

所以我知道我显然没有正确使用 sys.argv 但是，当我尝试将此函数结果返回到命令行时，我感觉我正在搞砸别的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T21:00:43.673

好的，我不妨将其发布为我的答案，而不仅仅是评论：

在

```
print dictionary(agrv) 
```

`argv`拼写错误。

它应该是

```
print dictionary(sys.argv) 
```

此外，使用`sys.argv`,`argv`本身是不够的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T21:00:09.757

argv 是`sys`模块的一个属性

使用任一

`sys.argv`

或者做

`from sys import argv`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-12T21:38:02.720

不应该是`print dictionary(sys.argv[1])`。我猜你想在 dictionary.com 中搜索命令行参数

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-12T21:40:54.593

当前发布的问题的问题是 sys.argv 是一个列表，而不是字符串，因此当您设置表单条目“q”时，您将其设置为程序的参数列表。您可以更改程序以传入第一个参数：

```
print dictionary(sys.argv[1]) 
```

或者多次调用字典函数：

```
for i in sys.argv[1:]:
    print dictionary(i) 
```

请注意，我们不想包含程序名称本身，因此省略 sys.argv[0]。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-12T21:01:16.160

您没有明确将结果“返回”到命令行是什么意思。如果您只想打印结果，您可以执行`print`.

但是您收到的错误消息与此无关。这是由两件事引起的：一，你放了`agrv`而不是`argv`. 其次，您已经导入`sys`了 ，因此您需要引用的`sys.argv`不仅仅是`argv`.

# scala - scala 如何在命令行模式下查看文件中的类？

> ID：11925819
> 
> 赞同：0
> 
> 时间：2012-08-12T20:55:23.220
> 
> 标签：scala, command-line

说，我有一个位于`D:\DanHenderson\scala\MyProject`. MyProject 有 2 个目录：`src`和`bin`. 在`src`我有 scala 代码本身，它可能是一些类或应用程序。那么如何使用这些类或从命令行运行整个应用程序呢？即，有一个带有 class 的文件`A`，我希望有可能`val a = new A`在命令行中输入。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:59:28.387

通过命令行，我假设您的意思是 Scala REPL。启动 Scala REPL 时，将类文件的目录添加到类路径：

```
scala -classpath "path to some dir where your .class files reside" 
```

请注意，如果您的项目依赖于某些库，那么这些库也需要位于类路径中。

# c# - 如何缓存 json 代理

> ID：11925825
> 
> 赞同：4
> 
> 时间：2012-08-12T20:56:09.030
> 
> 标签：c#, json, caching, proxy

我正在寻找使用 C# 在 .NET 上缓存 json 代理的最佳方法。

我们使用的网络服务限制了每个 IP 的点击次数，并且定期不可用。幸运的是，这些数据不是很易变，但它确实发生了变化。

理想情况下，我想做的是仅在请求有效时才缓存 Web 响应。我们将通过两个因素来确定无效响应，http 响应代码和 json 代码不会给我们“请求过多”错误。

我想使用代理 URL 和查询字符串将代理请求存储在缓存中，以便我们可以对多个外部资源和多个查询使用相同的代理。

我还想将请求作为文件存储在磁盘上或存储在数据库中，以防 URL 不可用且缓存为空。

这是建议的过程：

1.  使用查询字符串检查缓存中的结果
2.  如果缓存版本存在，请使用它。如果没有提出新的请求。
3.  如果请求成功，则将一组新结果存储到缓存中，并将结果写入磁盘或数据库或磁盘。
4.  如果该请求失败，请使用文件或数据库缓存版本。

我已经阅读了 MSDN 文章和其他一些博客文章，但如果能获得一个关于如何有效地做到这一点的具体示例，那就太好了。

谢谢！

# python - pandas：使用 to_excel 写入现有的 excel 文件 (xlsx)

> ID：11925827
> 
> 赞同：5
> 
> 时间：2012-08-12T20:57:10.560
> 
> 标签：python, pandas, openpyxl

我有一个`df.to_excel()`我正在努力解决的简单用例。我想写入现有 XLSX 工作簿的特定工作表选项卡（我们称之为“数据”），它可以被其他选项卡上的公式和数据透视表引用。

我尝试以两种方式修改 ExcelWriter，但都从 openpyxl 产生错误。

1.  使用 get_sheet_by_name 读取现有工作表（此错误：“NotImplementedError: use 'iter_rows()' instead”。）
2.  使用 create_sheet 创建一个新工作表。（此错误：“ReadOnlyWorkbookException：无法在只读工作簿中创建新工作表”）

    ```
    df=DataFrame()
    from openpyxl.reader.excel import load_workbook
    book = load_workbook('my_excel_file.xlsx', use_iterators=True) # Assume my_excel_file.xlsx contains a sheet called 'Data'
    class temp_excel_writer(ExcelWriter): # I need this to inherit the other methods of ExcelWriter in io/parsers.py
    def __init__(self, path, book):
        self.book=book
        test_sheet=self.book.create_sheet(title='Test') # This errors: ReadOnlyWorkbookException
        self.use_xlsx = True
        self.sheet_names=self.book.get_sheet_names()
        self.actual_sheets=self.book.worksheets
        self.sheets={}
        for i,j in enumerate(self.sheet_names):
          self.sheets[j] = (self.actual_sheets[i],1)
        self.cur_sheet = None
        self.path = save
    my_temp_writer=temp_excel_writer('my_excel_file.xlsx', book)
    df.to_excel(my_temp_writer, sheet_name='Data') 
    ```

有什么想法吗？我错过了一些明显的东西吗？我还在熊猫 7.2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T11:44:36.683

当您使用 加载工作簿时`use_iterators=True`，它会`_set_optimized_read()`在`Workbook`对象上，这会导致它以只读方式加载。

因此，使用以下代码：

```
from openpyxl.reader.excel import load_workbook

book = load_workbook('t.xlsx', use_iterators=False) # Assume t.xlsx contains ['Data', 'Feuil2', 'Feuil3']
print book.get_sheet_names()

class temp_excel_writer():
    def __init__(self, path, book):
        self.book=book
        test_sheet=self.book.create_sheet(title='Test') # No exception here now
        self.book.save(path)
        self.use_xlsx = True
        self.sheet_names=self.book.get_sheet_names()
        print self.sheet_names
        self.actual_sheets=self.book.worksheets
        self.sheets={}
        for i,j in enumerate(self.sheet_names):
            self.sheets[j] = (self.actual_sheets[i],1)
        self.cur_sheet = None
        self.path = path # I had to modify this line also

my_temp_writer = temp_excel_writer('my_excel_file.xlsx', book) 
```

它创建一个名为的文件`my_excel_file.xlsx`和以下输出：

```
 ['Data', 'Feuil2', 'Feuil3']
 ['Data', 'Feuil2', 'Feuil3', 'Test'] 
```

希望能帮助到你

# ios - 如何在 iPhone 上打印屏幕视图？

> ID：11925829
> 
> 赞同：-6
> 
> 时间：2012-08-12T20:57:28.767
> 
> 标签：ios, printing, screenshot

我在笔尖中有一个名为 printscreen 的按钮。在我的 .m 文件中，我有 -(IBAction)printscreen {}。

{} 之间应该有什么，这样当我点击我的按钮时，屏幕截图就会被打印出来。我不希望保存图像，也不希望它进入文件和所有废话。我想单击该按钮，一旦单击它，它就会打印当前屏幕上的任何内容。

我已经解决了所有问题，但没有一个非常有用。我只是在这里寻找代码。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:13:26.347

您可以使用以下方式获取屏幕截图的 UIImage 表示：

```
#import <QuartzCore/QuartzCore.h>

UIGraphicsBeginImageContext(view.window.bounds.size);
[view.window.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *screenshot = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

然后你可以用它做任何事情；也许您想将其写入照片库：

```
UIImageWriteToSavedPhotosAlbum(screenshot, nil, NULL, NULL); 
```

就我而言，没有实现即时的程序化 AirPrint 打印，你总是必须通过[`UIPrintInteractionController`](http://developer.apple.com/library/ios/iPad/#documentation/uikit/reference/UIPrintInteractionController_Class/Reference/Reference.html)课程。

# python - python：下载文件并实时发送到在线存储

> ID：11925830
> 
> 赞同：-2
> 
> 时间：2012-08-12T20:57:47.823
> 
> 标签：python, http, online-storage

我想将文件下载到我的服务器并通过减号或保管箱 API 自动将其发送到在线存储（减号或保管箱），而不将下载的文件保存在我的服务器中。所以，它就像流式传输或管道 HTTP 连接。现在我正在使用 minus.com API，但它需要文件对象或本地文件作为参数。我不知道如何将 http 响应转换为文件对象。

有可能做到这一点吗？如果可能的话，怎么做？

概念 ：

FILE_ON_ANOTHER_SERVER ----(http)---> MY_SERVER ----(http)----> ONLINE_STORAGE

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:38:01.430

您可以通过 read() 方法从响应中获取数据

```
response = urllib2.urlopen(request)

data = response.read() 
```

变量数据具有来自响应的二进制数据。

现在您可以创建一个 StringIO 对象，它将数据作为文件之类的对象来处理。

```
import StringIO
datastream = StringIO.StringIO()
datastream.write(data)
datastream.seek(0)
#create dropbox client
client.put_file('/test', datastream) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T00:12:32.907

urllib2.urlopen(url) 将返回一个类似文件的对象。您可以将其直接传递给您的减号 API 吗？[请参阅http://docs.python.org/library/urllib2](http://docs.python.org/library/urllib2)上的 urllib2 文档

# iphone - 使用按钮打开和关闭警报通知

> ID：11925834
> 
> 赞同：1
> 
> 时间：2012-08-12T20:58:25.810
> 
> 标签：iphone, objective-c, ipad, xcode4.3

我正在创建一个带有单个闹钟的时钟应用程序。

我有一个设置闹钟的按钮，一个打开闹钟的按钮，一个关闭闹钟的按钮。

设置按钮使用本地通知工作：

```
UILocalNotification *scheduledAlert;
[[UIApplication sharedApplication] cancelAllLocalNotifications];
scheduledAlert = [[UILocalNotification alloc] init];
scheduledAlert.applicationIconBadgeNumber=1;
scheduledAlert.fireDate = alarmPicker.date;
scheduledAlert.timeZone = [NSTimeZone defaultTimeZone];
scheduledAlert.repeatInterval =  NSDayCalendarUnit;
scheduledAlert.soundName=@"alarm_clock_ringing.wav";
scheduledAlert.alertBody = @"I’d like to get your attention again!";
[[UIApplication sharedApplication]
                   scheduleLocalNotification:scheduledAlert]; 
```

一切正常。

但是，我不知道如何编写 On 和 Off 按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T00:05:55.760

对于关闭按钮，您必须使用类似`CancelAllCurrentNotifications`.

# javascript - 使用 null 检查传递的参数 - JavaScript

> ID：11925836
> 
> 赞同：5
> 
> 时间：2012-08-12T20:58:42.993
> 
> 标签：javascript, function, parameters, typeof

在这里举一个示例函数：

```
function a(b){
    console.log(b != null ? 1 : 2);
} 
```

该代码工作正常，如果传递参数则打印 1，如果不传递参数则打印 2。

但是，JSLint 给了我一个警告，告诉我改用严格等式，即`!==`. 无论是否传递参数，该函数在使用时都会打印 1 `!==`。

所以我的问题是，检查参数是否已通过的最佳方法是什么？我不想使用`arguments.length`，或者实际上根本不想使用该`arguments`对象。

我尝试使用这个：

```
function a(b){
    console.log(typeof(b) !== "undefined" ? 1 : 2);
} 
```

^ 这似乎有效，但这是最好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:16:48.530

当没有参数传递时，`b`is `undefined`， not `null`。因此，测试参数是否存在的正确方法`b`是：

```
function a(b){
    console.log(b !== undefined ? 1 : 2);
} 
```

`!==``==`推荐，因为如果你使用or可以强制 null 和 undefined 相等`!=`，但是使用`!==`or`===`不会做类型强制，所以你可以严格判断它是否是`undefined`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-12T21:01:57.030

`undefined`您可以使用(a parameter, which is in fact `undefined`, not没有传递的参数)的虚假性质，`null`只需编写：

```
(!b)?1:2 
```

然而，对于`0`,`null`和`""`(假值) 也是如此。

如果你想以防弹的方式编写它，你可以去：

```
typeof(b) === "undefined"
// or thanks to the write protection for undefined in html5
b === undefined 
```

更新：感谢 EcmaScript 2015，我们现在可以使用[默认参数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)：

```
function a(b = 1){
    console.log(b);
} 
```

如果一个参数是未定义的——无论是省略还是明确移交（在这里你应该使用`null`）——将使用默认值，所有其他值保持不变（也是假值）。[示范](https://jsfiddle.net/su2u63e6/1/)

# c++ - 从指针的 QList 中删除元素

> ID：11925837
> 
> 赞同：2
> 
> 时间：2012-08-12T20:59:02.713
> 
> 标签：c++, qt4, qlist

我有一个 QList 变量。如何擦除从 X 索引开始的所有元素并删除所有后续 N 元素以同时释放内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:32:02.197

首先，您永远不应该使用`MyClass*`“拥有”（即控制其生命周期）一个`MyClass`. 因此，列表`MyClass*`也不应该“拥有” 的任何实例`MyClass`。因此，您永远不会将`delete`运算符与这些指针中的任何一个一起使用（并且`delete`在智能指针实现之外的流浪者几乎总是会引起一些人的注意）。

`QList`实际上是针对类似用例优化的类型。A`QList<MyClass>`将在内部存储一个动态数组`MyClass*`（如果`MyClass`大于指针），因此重新排序和扩展列表可能更便宜。但是，如果您需要从列表中删除元素*而不*删除它们，您应该使用 a`QList<unique_ptr<MyClass>>`或类似的。无论哪种方式，您都不必担心对象的生命周期；您只需要将它们从列表中删除。

既然我说了，有一些有用的 STL 习惯用法将有助于实现您正在寻找的东西，它们也适用于（大多数）Qt 容器（*编辑：修复了删除，添加了一些有用的评论*）：

```
QList<MyClass*> myList; //TODO FIXME XXX: clarify mentioned ownership issues
assert(X + N <= myList.size());

// this is the range of objects we want to remove and delete
// (N elements, starting from index X)
auto range_begin = myList.begin() + X,
     range_end = range_begin + N;
// delete each object in range
std::for_each(range_begin, range_end, [](MyClass* ptr) { delete ptr; });
// remove them from the list
myList.erase(range_begin, range_end); 
```

如果您打算在之后删除所有元素`myList[X - 1]`（简而言之，替换`range_end`为`myList.end()`），它甚至更简单。

# c++ - 如何有效地计算第 n 个 n 位回文数？

> ID：11925840
> 
> 赞同：4
> 
> 时间：2012-08-12T20:59:34.093
> 
> 标签：c++, c, algorithm, palindrome

我认为这个问题很简单，可以理解。为了更清楚，我举个例子：

**在 2 位回文列表中，第 7 个回文是 77（第 1 个是 11，第 2 个是 22，依此类推）。**

显然存在蛮力解决方案，但效率不高。

谁能建议我一些更好的解决方案来解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-12T21:58:11.303

首先，我们可以简化问题，因为我们只需要查看数字的前半部分（如果有奇数位，则四舍五入）。我将称第一组数字为**有效数字**，其余**为非有效数字**。

这是因为**非有效**数字必须与**有效**数字匹配（相反）。不可能有另一个具有相同前导有效数字和不同非有效数字的回文数。**有效数字**决定了整个回文数。

现在，我们只需要想出一个算法来生成第 n 个有效**数字**。如果我们允许前导零，这会更容易，所以我们将提出允许前导零的算法，然后调整算法。

前几个回文（有效数字）将是：

*   1：0000
*   2：0001
*   3：0002
*   ...
*   100：0099

所以我们可以通过求 (n-1) 的十进制表示来找到第 n 个数的有效数字。

为了在不允许前导零时调整算法以使其工作，我们将从一开始作为前导数字：

*   1：1000
*   2：1001
*   3：1002
*   ...
*   100：1099

这归结为找到 (n-1) + 1000 = **n + 999 的十进制表示并扩展为完整的回文**：

**示例**：找到长度为 9 的第 113 个回文。

*   **确定要查看的位数**：向上取整（9 / 2）= 5 --> 只查看前 5 位数字。
*   **查找要添加的数字以消除前导零**：10^(5-1) = 10000
*   **使用公式**：(113 - 1) + 10000 = 10112
*   **扩展为回文**：101121101

附带说明一下，该算法也可以推广到查找任何有序符号集（或字母表）的第 n 个回文。

**广义算法**：

给定：找到回文数*n*，回文有*m*个符号作为数字，有*p*个符号（十进制的 10 个符号）

*   令*q* = 上限（*m* / 2）
*   设*偏移量*= p ^ ( *q* - 1)
*   设*数字*= ( *n* - 1) +*偏移量*
*   让*答案*是*数字*展开为回文

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-12T21:05:58.600

前几个 7 位回文是：

*   1000001
*   1001001
*   1002001
*   1003001
*   ...
*   1009001
*   1010101
*   1011101
*   ...

我认为很容易从第*n*^个 *m*位回文的模式中看出......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-12T21:27:56.577

当位数为偶数时，只需从 100..0 开始取第 n 个位数减半的数，其中长度为位数的一半。回文就是这个数字，后面跟着它的镜子。

对于奇数位数，只需取该数字一半的上限，然后以相同的方式从 100...0 开始计数。然后回文是这个数字，后面跟着它的镜像，去掉了第一个数字。

第 65 个 10 位数字：

65 + 9999 = 10064

1006446001

第 10298 个 13 位数字：

10298 + 999999 = 1010297

1010297920101

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T09:56:56.660

对于两位数的回文数，两个连续的回文数之差是 11。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-08-12T21:14:40.607

就像是：

```
#include<iostream>
#include<cmath>
#include<cstring>
#include<cstdio>
using namespace std;

void reverseString(char *dest,char *src){
 char *iter=src;
 while (*iter) iter++;
 while (iter!=src){
  iter--;
  *dest=*iter;
   dest++;
 }
 *dest=0;
}

char *pal(int n,int len){
  char *tmp=new char[len/2+2];
  char *out=new char[len+1];
  sprintf(out,"%i",n+int(pow(10.0,(len+1)/2-1))-1);
  reverseString(tmp,out); //copy reversed out into tmp
  strcat(out,tmp+len%2);
  delete []tmp;
return out;
}

int main(){
 cout<<pal(4,7)<<endl;
} 
```

# eclipse - Eclipse PlugIn Perspective 出现错误“在为 PrintStream 检索附加的 javadoc 时超时”

> ID：11925845
> 
> 赞同：0
> 
> 时间：2012-08-12T21:00:24.480
> 
> 标签：eclipse, eclipse-rcp, eclipse-plugin

Eclipse 3.7，尝试构建我的第一个 RCP 程序。当我激活插件透视图时，出现以下错误 5 次：

```
Timed out while retrieving the attached javadoc for PrintStream [in PrintStream.class [in java.io [in C:\Program Files\Java\jre7\lib\rt.jar]]] 
```

调用堆栈：

```
Java Model Exception: Java Model Status [Timed out while retrieving the attached javadoc for PrintStream [in PrintStream.class [in java.io [in C:\Program Files\Java\jre7\lib\rt.jar]]] ]
at org.eclipse.jdt.internal.core.JavaElement.getURLContents(JavaElement.java:808)
at org.eclipse.jdt.internal.core.BinaryType.getJavadocContents(BinaryType.java:1037)
at org.eclipse.jdt.internal.core.BinaryMethod.getAttachedJavadoc(BinaryMethod.java:643)
at org.eclipse.jdt.internal.ui.text.javadoc.JavadocContentAccess2.getHTMLContent(JavadocContentAccess2.java:462)
at org.eclipse.jdt.internal.ui.text.java.ProposalInfo.extractJavadoc(ProposalInfo.java:95)
at org.eclipse.jdt.internal.ui.text.java.ProposalInfo.computeInfo(ProposalInfo.java:75)
at org.eclipse.jdt.internal.ui.text.java.ProposalInfo.getInfo(ProposalInfo.java:58)
at org.eclipse.jdt.internal.ui.text.java.AbstractJavaCompletionProposal.getAdditionalProposalInfo(AbstractJavaCompletionProposal.java:555)
at org.eclipse.jface.text.contentassist.AdditionalInfoController$3.run(AdditionalInfoController.java:106)
at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T20:42:39.153

显然，同样的问题也描述在： [Eclipse timeout when trying to show Javadoc for classes in rt.jar](https://stackoverflow.com/questions/11934538/eclipse-times-out-when-trying-to-show-javadoc-for-classes-in-rt-jar)

您的问题的解决方案可能类似；Eclipse 正在查看可能是错误的 JDK 安装。尝试在**Preferences > Java > Installed JREs**中添加对本地 JDK的引用，并删除对 JRE 的引用。

# bash - 用 'cp' 处理空格

> ID：11925848
> 
> 赞同：1
> 
> 时间：2012-08-12T21:00:46.547
> 
> 标签：bash

我有一个外部驱动器，上面有超过 1TB 的项目文件。我需要重新格式化这个驱动器，以便重新组织它，但在此之前，我需要传输所有内容。问题是我在 Mac 上，驱动器被格式化为 NTFS，所以我所能做的就是从中复制。我试图简单地在 Finder 中复制和粘贴，但在以这种方式复制大约 15 分钟后，驱动器似乎锁定了。所以我决定编写一个 bash 脚本来一次遍历所有 1000 多个文件。这似乎适用于没有空格但在遇到空格时会跳过的文件。

到目前为止，这是我一起破解的内容。我在 bash 方面不太先进，所以任何关于如何处理空间的建议都会很好。

```
quota=800
size=`du -sg /Users/work/Desktop/TEMP`
files="/Volumes/Lacie/EXR_files/*"

for file in $files
do
    if [[ ${size%%$'\t'*} -lt $quota ]];
    then
        echo still under quota;
        cp -v $file /Users/work/Desktop/TEMP_EXR;
        du -sg /Users/work/Desktop/TEMP_EXR;
    else
        echo over quota;
    fi
done 
```

（我正在检查目录大小，因为在将其全部复制回重新格式化的驱动器之前，我必须将此临时副本拆分到几个不同的位置。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:08:59.873

希望我没有误会。如果文件名中的空格字符有问题，请**引用它**。如果您希望 bash 扩展其中的参数，请使用双引号。

```
cp -v "$file" /Users/work/Desktop/TEMP_EXR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T13:28:22.117

您可以将所有文件名放在一个数组中，然后对其进行迭代。

```
quota=800
size=`du -sg /Users/work/Desktop/TEMP`
files=( /Volumes/Lacie/EXR_files/* )

for file in "${files[@]}"
do
    if [[ ${size%%$'\t'*} -lt $quota ]];
    then
        echo still under quota;
        cp -v "$file" /Users/work/Desktop/TEMP_EXR;
        du -sg /Users/work/Desktop/TEMP_EXR;
    else
        echo over quota;
    fi
done 
```

需要注意的两件事是 1）在 for 列表中引用数组扩展，以及 2）`$file`在`cp`命令中引用。

# android - Android 2.3“启动失败-2147483648”mediaRecorder错误

> ID：11925852
> 
> 赞同：0
> 
> 时间：2012-08-12T21:01:52.207
> 
> 标签：android, api, video, mediarecorder

在 Android 2.2 上，代码在 2.3 上运行良好，但它在 MediaRecorder.start() 处崩溃。日志和代码本身如下。如您所见，它没有提供太多信息，日志给出“启动失败-2147483648”消息。我已经尝试了很多年，但无法弄清楚这一点，我做错了什么？

```
 mediaRecorder = new MediaRecorder();

    try {
        camera.unlock();

        mediaRecorder.setCamera(camera);

        mediaRecorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
        mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);

        mediaRecorder.setProfile(CamcorderProfile.get(CamcorderProfile.QUALITY_HIGH));
    mediaRecorder.setOutputFile(getOutputMediaFile(MEDIA_TYPE_VIDEO).toString());

        mediaRecorder.setPreviewDisplay(cameraPreview.getHolder().getSurface());

        mediaRecorder.prepare();

        mediaRecorder.start(); // thats the line code fails

        fightTimer.start();
    } 
    catch (RuntimeException ex) {
        Toast.makeText(this,"Sorry, camera is currently not available"+ex.toString(), 2000).show();
    } 
    catch (IOException ex) {
        Toast.makeText(this,"Sorry, camera is currently not available"+ex.toString(), 2000).show();
    } 
```

并记录

```
08-13 06:34:56.914: I/MediaRecorderJNI(2256): prepare: surface=0x2bb230 (identity=13)
08-13 06:34:57.764: E/MediaRecorder(2256): start failed: -2147483648 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T00:32:47.883

这只是一个糟糕的错误代码。但是，第一行`prepare: surface`表示与构造 VideoPlayer 边界相关的内容，突然发生异常。

你需要`setVideoSize()`，也许？

**提示：**我会搜索“android mediarecorder start failed”（没有错误代码 - 似乎这些错误代码与错误消息本身一样随机！）

**编辑：** 由于它适用于 Android 2.2，您是否查看过 API 2.2 和 API 2.3 for MediaRecorder 之间的 API 更改？

# java - 如何通过 Class 对象访问静态成员

> ID：11925854
> 
> 赞同：1
> 
> 时间：2012-08-12T21:01:56.357
> 
> 标签：java

我想访问我的一个类上的静态 HashMap 对象。这个伪代码说明了我是如何尝试去做的。

```
public Class A
{
 public static HashMap<String,String> myMap;
 static
 {
  myMap.put("my key", "my value");
 }
}
...
public void myfunction(Class clazz)
{
 HashMap<String,String> myMap = clazz.getThatStaticMap();
}
...
myFunction(A.getClass()); 
```

调用`getThatStaticMap()`是我不知道该怎么做的部分。

在我的实际代码中，我`myfunction`使用类作为参数调用并返回 `ArrayList`使用类的 newInstance() 方法创建的对象，但我希望访问属于该类的静态数据来配置每个实例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T00:17:53.490

如果我对您的理解正确，您想使用[反射](http://docs.oracle.com/javase/tutorial/reflect/index.html)来访问该字段。您可以使用[Class#getField](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getField%28java.lang.String%29)或[Class#getDeclaredField](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getDeclaredField%28java.lang.String%29)来访问地图，如下所示：

```
Field hashmapField = clazz.getField("myMap");
//Note, since this is static, we pass it null.
Object fieldValue = hashmapField.get(null);
HashMap<String,String> myMap = (HashMap<String,String>)fieldValue; 
```

但是，如果您有几个类将具有“myMap”字段，则可以考虑重构代码以具有如下[接口](http://docs.oracle.com/javase/tutorial/java/concepts/interface.html)：

```
public interface StringMappable{
  HashMap<String,String> getMap();
} 
```

而不是使用反射。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T00:15:22.540

来自：[这里](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getField%28java.lang.String%29)和[这里](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Field.html#get%28java.lang.Object%29)：

```
clazz.getField("myMap").get(null) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-13T00:14:51.043

你想要这样的东西：

```
public void myfunction(Class clazz)
{
    HashMap<String,String> myMap = clazz.getField("myMap").get(null);
} 
```

[`Field.get(Object)`方法文档](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Field.html#get%28java.lang.Object%29)说：

> 如果底层字段是静态字段，则忽略 obj 参数；它可能为空。

[`Class.getField(String)`方法文档](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getField%28java.lang.String%29)说：

> 返回一个反映此 Class 对象表示的类或接口的指定公共成员字段的 Field 对象。name 参数是一个字符串，指定所需字段的简单名称。

# ruby - 获取类中声明的所有实例变量

> ID：11925855
> 
> 赞同：54
> 
> 时间：2012-08-12T21:02:09.507
> 
> 标签：ruby

请帮助我获取在类中声明的所有实例变量，就像`instance_methods`向我展示类中可用的所有方法一样。

```
class A
  attr_accessor :ab, :ac
end

puts A.instance_methods  #gives ab and ac

puts A.something         #gives me @ab @ac... 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-08-12T21:09:22.937

您可以使用[`instance_variables`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-instance_variables)：

```
A.instance_variables 
```

但这可能不是您想要的，因为这会获取*class* `A`中的实例变量，而不是该类的实例。所以你可能想要：

```
a = A.new
a.instance_variables 
```

但请注意，仅调用`attr_accessor`不会定义任何实例变量（它只是定义方法），因此在您明确设置它们之前，实例中不会有任何变量。

```
a = A.new
a.instance_variables #=> []
a.ab = 'foo'
a.instance_variables #=> [:@ab] 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-05-31T10:35:27.850

如果要获取所有实例变量值，可以尝试以下操作：

```
class A
  attr_accessor :foo, :bar

  def context
    self.instance_variables.map do |attribute|
      { attribute => self.instance_variable_get(attribute) }
    end
  end
end

a = A.new
a.foo = "foo"
a.bar = 42
a.context #=> [{ :@foo => "foo" }, { :@bar => 42 }] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-06T22:28:20.437

这不是万无一失的-可以在与模式匹配的类上定义其他方法-但我发现适合我需要的一种方法是

```
A.instance_methods.grep(/[a-z_]+=/).map{ |m| m.to_s.gsub(/^(.+)=$/, '@\1') } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-26T20:56:44.003

如果您想以属性的方式获取所有实例变量的哈希，请按照 Aschen 的回答，您可以这样做

```
class A
  attr_accessor :foo, :bar

    def attributes
    self.instance_variables.map do |attribute|
      key = attribute.to_s.gsub('@','')
      [key, self.instance_variable_get(attribute)]
    end.to_h
  end
end
a = A.new
a.foo = "foo"
a.bar = 42
a.context #=> {'foo' => 'foo', 'bar' => 42} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-09T15:36:51.113

基于@Obromios 的答案，我添加了`.to_h`和`.to_s`到一个类，以允许愉快、灵活地转储适合显示给最终用户的属性。

这个特定的类（不是 ActiveRecord 模型）将在不同情况下设置各种属性。打印时只会出现那些具有值的属性`myvar.to_s`，这是我的愿望。

```
class LocalError
  attr_accessor :product_code, :event_description, :error_code, :error_column, :error_row 

  def to_h
    instance_variables.map do |attribute|
      key = attribute.to_s.gsub('@', '')
      [key, self.instance_variable_get(attribute)]
    end.to_h
  end

  def to_s
    to_h.to_s
  end
end 
```

这使我可以将这个简单的代码放在邮件模板中：

```
Data error:   <%= @data_error %> 
```

它产生（例如）：

```
Data error:   {"event_description"=>"invalid date", "error_row"=>13} 
```

这很好，因为将来不需要更新邮件程序，因为 LocalError 属性会发生变化。

# google-analytics - Google Analytics 自定义变量，通过 URL 提供的数据

> ID：11925858
> 
> 赞同：0
> 
> 时间：2012-08-12T21:02:20.753
> 
> 标签：google-analytics

我被要求设置一些自定义变量，但由于我是新手，不知道如何开始。我已经尽可能多地进行了研究，但我感到困惑。

这是我需要做的：一个应用程序以[http://www.example.com/folder/?userID=12345&BookTitle=ABCDE&DateAndTime=201208080800](http://www.example.com/folder/?userID=12345&BookTitle=ABCDE&DateAndTime=201208080800)的形式生成一个唯一的 URL 。然后，我需要将 URL 中的自定义变量（“UserID”、“BookTitle”和“DateAndTime”）传递给 Google Analytics，以便跟踪应用程序的哪些用户正在访问该 URL 处的页面。

我已经研究过设置自定义变量，但不明白是否需要为 3 个单独的变量编写 3 行单独的代码，也不知道如何将 URL 的各种元素传递给这些变量。

任何人都可以阐明我如何去做这件事吗？

非常感谢您提前提供的任何帮助。-杰克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T15:49:57.123

没关系。事实证明，这种用法违反了 Google Analytics 的 TOS。通过预先询问用户一些信息来以不同的方式进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T20:36:11.547

谷歌的服务条款已经改变。只要用户 ID 是您内部的并且不能用于识别客户（由 Google 提供），您现在就可以执行此操作。

# facebook - NodeJS Everyauth 多重重定向

> ID：11925861
> 
> 赞同：3
> 
> 时间：2012-08-12T21:02:58.537
> 
> 标签：facebook, node.js, oauth-2.0, everyauth

我正在使用 Everyauth + Express + NodeJS 来允许用户登录 Facebook。我想将他们重定向到他们登录的页面 - 有什么方法可以让everyauth.facebook 配置支持多个重定向网址？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T15:00:56.817

啊。这已在 github 问题上得到解答：

[https://github.com/bnoguchi/everyauth/issues/12](https://github.com/bnoguchi/everyauth/issues/12)

[https://github.com/bnoguchi/everyauth/issues/41](https://github.com/bnoguchi/everyauth/issues/41)

# django - Django：如何在表单中获取美国日期格式？

> ID：11925866
> 
> 赞同：1
> 
> 时间：2012-08-12T21:03:15.247
> 
> 标签：django

出于某种原因，我的表格不接受美国日期格式。我想知道是否有任何来自美国的 Django 开发人员可以帮助我解决这个问题。我怀疑设置中的时区也会影响日期格式，但我不确定。

**设置：**

```
TIME_ZONE = 'Europe/London'
LANGUAGE_CODE = 'en-us'
USE_I18N = True
USE_L10N = True
USE_TZ = True 
```

**模型形式：**

```
class CallsForm(ModelForm):    
   class Meta:
        model = Conversation   
        widgets = {
                    'contact_date': forms.DateInput(attrs={'placeholder': 'Add the date...', 'id': 'datepicker', 'class': 'placeholder_fix_css'}, format='%m/%d/%Y'),
                   } 
```

![在此处输入图像描述](../Images/02561ad8725109c9c76a8ca758aa704b.png)

任何想法？谢谢

**更新：**

我离正在发生的事情更近了一步：

```
MIDDLEWARE_CLASSES = (
    ...
    'django.middleware.locale.LocaleMiddleware',
) 
```

似乎只要加载了 LocaleMiddleware，Django 就会从我的浏览器会话中获取设置，因此日期格式更改为欧洲反映我的位置。聪明的。

现在以美国日期格式接受日期输入。在我得到的模板`Aug. 31, 2012`中，这也是正确的。但是在表格中，一旦我尝试修改我得到的记录`2012-08-31`？

这似乎不对。当然我可以用`format='%m/%d/%Y'`它来覆盖它，但这不是硬编码和不好的做法吗？当然，表格必须依赖于当前文化的日期格式，即美国，但为什么没有发生呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T21:08:26.630

好了，现在来解决这个问题。能做到这一点是一项伟大的团队合作。:)

正如下面提到的 solartic ，表单中字段的 localize 参数必须设置为 true。如果它是一个 ModelForm 它会有点棘手，因为你需要一个回调：

```
class CompanyForm(ModelForm):
    def date_callback(self, field, **kwargs) :
        return field.date(localize=True, **kwargs)

    class Meta:
        model = Company 
```

但这还不够。如果不对任何日期输入格式进行硬编码，则需要覆盖`formats.py`. 这有点复杂，请参阅[创建自定义格式文件](https://docs.djangoproject.com/en/dev/topics/i18n/formatting/#creating-custom-format-files) 我在[这里](https://dl.dropbox.com/u/44307777/Sandbox.zip)创建了一个演示。

该演示仅在中途工作，因为切换语言仅适用于模板而不适用于表单。为了解决这个问题，您需要 danihp 的解决方案。:) 语言需要再次激活，一旦切换。有关他的完整修复，请参见[此处](https://stackoverflow.com/questions/11956576/django-despite-selected-language-forms-still-rely-on-language-code-to-format-d#comment15966386_11956576)

为了解决这个问题，团队付出了巨大的努力。:)

我希望这可以帮助那里的人...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T21:17:35.800

尝试以下操作：

```
class CallsForm(ModelForm):
   contact_date = DateField(widget=forms.DateInput(attrs={'placeholder': 'Add the date...', 'id': 'datepicker', 'class': 'placeholder_fix_css'}, format='%m/%d/%Y'))    
   class Meta:
        model = Conversation 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T20:31:57.523

固定的！！嗨，Kave，经过一段时间的调查，我终于找到了解决方案。

*   首先，您应该使用 activate(language_code) 切换到新语言。
*   您必须同时设置为本地化：字段和小部件：

示例切换语言：

```
def display_current_language(request):
    if request.LANGUAGE_CODE == 'en-gb':
        lang = "You prefer to read British English {code}.".format(
                  code=request.LANGUAGE_CODE )
        activate(request.LANGUAGE_CODE)
    elif request.LANGUAGE_CODE == 'en-us':
        lang = "You prefer to read American English {code}.".format(
                  code=request.LANGUAGE_CODE )
        activate('en-us')    
    else:
        lang = "You prefer to read Deutsch {code}.".format( 
                   code=request.LANGUAGE_CODE )
        activate(request.LANGUAGE_CODE)    
    return lang 
```

使用您的模型（公司）和您的字段（日期）进行示例：

```
class CompanyForm(ModelForm):        
    class Meta:
        model = Company 

    def __init__(self, *args, **kwargs):
        super(CompanyForm, self).__init__(*args, **kwargs)
        self.fields['date'].localize = True
        self.fields['date'].widget.is_localized = True 
```

也发表在“ [Django：尽管选择了语言，表单仍然依赖 LANGUAGE_CODE 来格式化日期时间（包括演示）](https://stackoverflow.com/questions/11956576/django-despite-selected-language-forms-still-rely-on-language-code-to-format-d) ”帖子。

# c# - 焦点返回表单

> ID：11925879
> 
> 赞同：-1
> 
> 时间：2012-08-12T21:05:46.603
> 
> 标签：c#, visual-studio

我有两种形式。我用这段代码显示我的第二个表单：

```
Form2 f = new Form2();
f.ShowDialog(); 
```

我需要了解焦点何时返回主窗体。我尝试`Activate`了事件，但事实并非如此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T21:08:06.943

对 ShowDialog() 的调用阻止了父窗体。
当您的代码从 ShowDialog() 退出时，您当前的表单再次变为活动状态，

例如：

```
using(Form2 f = new Form2())
{
    // At the moment of the call of ShowDialog, the Net Framework start its work to
    // pass the focus to the first control in the Form2 instance
    if(DialogResult.OK == f.ShowDialog())
    {
        // Form confirmed, do your stuff
    }
}

// At the end of the using block the parent form is again the active form with the focus on
// the button that has started this process (or the last control that had focus) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T07:03:43.913

当您键入

```
Form2 f = new Form2();
f.ShowDialog(); 
```

它一直等到您手动关闭 Form2 实例，然后返回到主窗体。如果您使用 ShowDialog() 方法，就会发生这种情况。

在某些情况下，您只想在几分之一秒内弹出另一个表单并返回主表单，您应该使用 formInstance.Show() 方法。Show() 方法不等待第二个窗体关闭，它立即执行并将控制权传递给 Show() 语句之后的下一条语句。

希望你能理解。

# android - Android：用线条连接按钮

> ID：11925882
> 
> 赞同：0
> 
> 时间：2012-08-12T21:06:00.283
> 
> 标签：android, android-layout, android-widget

我正在编写一个与二叉树/图非常相似的 Android 应用程序，有几个动态创建的按钮，但我不知道如何创建连接按钮的线。

这是一张显示我需要做的图片：

![](../Images/1b9e037552eb04c8b12e86c81427f7f7.png)

这是我的 XML 文件：

```
 <ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/vscroll"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#000000" >

    <HorizontalScrollView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/hscroll"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="#888888" >

        <RelativeLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            xmlns:tools="http://schemas.android.com/tools"
            android:id="@+id/relativescroll"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:background="#FFFFFF" >

            <!-- Buttons and lines connecting them -->

        </RelativeLayout>
    </HorizontalScrollView>

</ScrollView> 
```

这是一个活动类的例子：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        RelativeLayout mainLayout = (RelativeLayout) findViewById(R.id.relativescroll);
        RelativeLayout.LayoutParams newParams;

        // Botão 1
        Button btn1 = new Button(this); 
        btn1.setId(1);
        btn1.setText("Botão 1");
        newParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, 
                RelativeLayout.LayoutParams.WRAP_CONTENT
                );
        newParams.setMargins(0, 0, 20, 50);
        newParams.addRule(RelativeLayout.CENTER_HORIZONTAL);
        btn1.setLayoutParams(newParams);
        mainLayout.addView(btn1);

        // Botão 2
        Button btn2 = new Button(this);
        btn2.setId(2);
        btn2.setText("Botão 2");
        newParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, 
                RelativeLayout.LayoutParams.WRAP_CONTENT
                );
        newParams.setMargins(0, 0, 20, 50);
        newParams.addRule(RelativeLayout.BELOW, 1);
        newParams.addRule(RelativeLayout.ALIGN_PARENT_LEFT);
        btn2.setLayoutParams(newParams);
        mainLayout.addView(btn2); 

        // Botão 3
        Button btn3 = new Button(this);
        btn3.setId(3);
        btn3.setText("Botão 3");
        newParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, 
                RelativeLayout.LayoutParams.WRAP_CONTENT
                );
        newParams.setMargins(0, 0, 20, 50);
        newParams.addRule(RelativeLayout.BELOW, 1);
        newParams.addRule(RelativeLayout.RIGHT_OF, 2);
        btn3.setLayoutParams(newParams);
        mainLayout.addView(btn3);

        // Botão 4
        Button btn4 = new Button(this);
        btn4.setId(4);
        btn4.setText("Botão 4");
        newParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, 
                RelativeLayout.LayoutParams.WRAP_CONTENT
                );
        newParams.setMargins(0, 0, 20, 50);
        newParams.addRule(RelativeLayout.BELOW, 1);
        newParams.addRule(RelativeLayout.RIGHT_OF, 3);
        btn4.setLayoutParams(newParams);
        mainLayout.addView(btn4);

        // Botão 4
        Button btn5 = new Button(this);
        btn5.setId(5);
        btn5.setText("Botão 5");
        newParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, 
                RelativeLayout.LayoutParams.WRAP_CONTENT
                );
        newParams.setMargins(0, 0, 20, 50);
        newParams.addRule(RelativeLayout.BELOW, 1);
        newParams.addRule(RelativeLayout.RIGHT_OF, 4);
        btn5.setLayoutParams(newParams);
        mainLayout.addView(btn5);   

        // DRAW LINK        
        NodeLink link = new NodeLink(this);
        newParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, 
                RelativeLayout.LayoutParams.WRAP_CONTENT
                );
        newParams.addRule(RelativeLayout.BELOW, 1);
        newParams.addRule(RelativeLayout.ABOVE, 2);
        newParams.addRule(RelativeLayout.RIGHT_OF, 1);
        newParams.addRule(RelativeLayout.LEFT_OF, 2);
        mainLayout.addView(link);

    }

} 
```

请，关于我该怎么做的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T19:30:48.850

你可能想说 NodeLink 在做什么——自定义视图类？

无论如何，我建议在您的按钮上获取“锚点”的坐标（顶部中心点，来自您的图表），然后创建链接相关按钮的锚点的路径。将这些路径绘制/绘制成[Picture](http://developer.android.com/reference/android/graphics/Picture.html)，将其保存为[PictureDrawable](http://developer.android.com/reference/android/graphics/drawable/PictureDrawable.html)，然后您可以将该 Drawable 设置为[按钮父](http://developer.android.com/reference/android/view/View.html#setBackgroundDrawable%28android.graphics.drawable.Drawable%29)级（RelativeLayout/mainLayout）的背景。

# c# - 使用 :: 和输入完全限定的命名空间有什么区别？

> ID：11925883
> 
> 赞同：1
> 
> 时间：2012-08-12T21:06:22.690
> 
> 标签：c#, .net

我最近问了一个问题：[:: 是什么意思？](https://stackoverflow.com/questions/11870508/what-does-mean)

然后今天，我当然遇到了那个确切的问题。我想我正在使用 System.Timers 和 System.Threading 命名空间。据我所知，他们都有一个名为 Timer 的类。现在这无关紧要，我想知道的是以下之间的区别：

```
Using myalias = System.Timers;
myalias::Timer myTimer = new myalias::Timer(); 
```

和

```
Using System.Timers;
System.Timers.Timer myTimer = new System.Timers.Timer(); 
```

我希望这已经足够清楚了，我只是想知道为什么使用 :: 当你可以输入命名空间时只是为了节省输入以防你有很多嵌套的命名空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:16:41.210

:: 在多种情况下变得有用。保存输入只是其中之一，实际上在大多数情况下，完全限定名称就足够了。

一个关键用途是在代码生成中，引用 global::System.whatever 可以避免尴尬，特别是在有人选择调用类型/嵌套类型/属性`System`的情况下 - 在这种情况下 System.Whatever 没有更长是指您期望的，但 global::System.Whatever *does*。

一个更微妙的：考虑两个库，a.dll 和 b.dll - 由于某种原因，它们都包含 Foo.Bar.SomeType - 在这里，我们可以使用“外部别名”来分别讨论这两种类型，通过不同的顶部级别名（而不是 global::) 来命名它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T21:11:51.590

It's not about difference, it's *a way* of using the types that are in collision.

If you use some type

```
namepsace My.System.Pro
{
   public class Project{}
} 
```

begin to use some other project that has

```
namepsace His.System.Pro
{
   public class Project{}
} 
```

Two types `Project` are in collision, so istead of writing *fully qualified* name, you assign a *alias* to yuor, and/or to his namespace. This is just for comfort, for coding style.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T21:17:21.543

它们产生相同的代码，但别名是为那些知道它存在并且不想费心编写所有这些长限定符的懒惰的开发者准备的。

**编辑：**我个人更喜欢长限定符，因为别名使代码难以跟踪。[是溜溜球问题](http://en.wikipedia.org/wiki/Yo-yo_problem)的源码版本

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-12T21:17:34.063

别名只是缩短完全限定版本的一种方式。哪个更好是可读性的问题。通常，完全限定类型占用的空间比它们需要的要多，因此通常首选指定类型的紧凑方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-12T21:14:04.763

两者都会产生相同的底层代码，问题是代码的可读性

# asp.net - HttpRuntime.Cache 在客户端/服务器端进行缓存

> ID：11925884
> 
> 赞同：0
> 
> 时间：2012-08-12T21:06:23.790
> 
> 标签：asp.net, global-asax, httpruntime.cache, httpruntime

我在 asp.net Web 应用程序的 global.asax 文件中声明的 HttpRuntime.Cache 是否在客户端或服务器端进行缓存？

```
HttpRuntime.Cache["Key"] 
```

还有我们可以为这段代码设置滑动过期的任何机会吗？

提前致谢。

**编辑：** 经过深思熟虑，我认为这将是可能的解决方案。

为整个 asp.net Web 应用程序放置一个 basePage 类，其中所有 system.web.ui.page 都将从该类继承。

和下面的代码

```
protected override void OnInit(EventArgs e)
        {
            OutputCacheParameters aa = new OutputCacheParameters();
            aa.Location = OutputCacheLocation.Client;<-- I am not sure whether this will work and gets added to the pages correctly or not.Any Ideas on these two lines of code.
            base.OnInit(e);
            Cache.Add("State", "", null, DateTime.Now.AddMinutes(20), Cache.NoSlidingExpiration, CacheItemPriority.High, null);
            Cache.Add("StatesGlobal", "", null, Cache.NoAbsoluteExpiration, new TimeSpan(1,0,0,0,0), CacheItemPriority.High, null);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:10:25.997

On the server.

If you want to set the expiration policy for the item, you should use the Cache.Add API:

[http://msdn.microsoft.com/en-us/library/system.web.caching.cache.add.aspx](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.add.aspx)

# ruby-on-rails - 具有双 id 的嵌套路由

> ID：11925885
> 
> 赞同：1
> 
> 时间：2012-08-12T21:06:33.243
> 
> 标签：ruby-on-rails, url-routing

我从 rails 开始，在具有 2 个 id 的嵌套路由上遇到问题。

我提交的表格来自：

```
http://localhost:3000/admin/worlds/1/banks/new 
```

我被重定向到：

```
http://localhost:3000/admin/worlds/23/banks/23 
```

（其中 23 是新银行的 id）

问题是我不能强制这个 url`id = 1`在创建操作之后将第一个保留在第一个路由上。

我的`Admin::Bank`控制器在这里创建：

```
def create
  @world_bank = Admin::Bank.new(params[:admin_banque])
  @world_bank.world_id = params[:id]
  @world_bank.save!
  redirect_to admin_bank_path(@world_bank.world_id, @world_bank.id)
end 
```

路线：

```
namespace :admin do
   resources :mondes do
      member do
        resources :banques
    end
  end
end 
```

和耙路线：

```
admin_banks GET    /admin/worlds/:id/banks(.:format)          admin/banks#index
POST   /admin/worlds/:id/banks(.:format)          admin/banks#create
new_admin_bank GET    /admin/worlds/:id/banks/new(.:format)      admin/banks#new
edit_admin_bank GET    /admin/worlds/:id/banks/:id/edit(.:format) admin/banks#edit
admin_bank GET    /admin/worlds/:id/banks/:id(.:format)      admin/banks#show
PUT    /admin/worlds/:id/banks/:id(.:format)      admin/banks#update
DELETE /admin/worlds/:id/banks/:id(.:format)      admin/banks#destroy 
```

事实是我看到了：

`:id/thing/:id/stuff`当我知道我应该得到`:world_it/thing/:id/stuff`

我尝试了不同的方式来使用重定向，尤其是`redirect_to admin_banks(world_id, id)`例如，但它保持不变。

我很确定这可以通过 routes.rb 中的匹配来解决，但我现在不能让它工作......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T18:13:31.493

摆脱嵌套资源周围的 :member 块，它应该可以工作。尝试：

```
namespace :admin do
  resources :mondes do
    resources :banques
  end
end 
```

# git - 如何在不必重新开始的情况下对 git 存储库进行重大更改？

> ID：11925887
> 
> 赞同：3
> 
> 时间：2012-08-11T15:03:22.963
> 
> 标签：git, version-control, repository

我的一个 git 存储库有问题（仅供参考：我对 git*真的很*陌生）

基本上我忘记了我为一个项目创建的 repo，处理了错误的文件集（我的原始副本），进行了一些重大更改并重命名了大多数文件。

现在我已经意识到我的错误，我想知道如何将新文件放入我的仓库，替换旧文件，这样我就不会以 2 个不同的名称得到相同文件的 2 个不同版本。

我不想完全删除旧的 repo 并使用新文件重新创建它，因为我已经将它推送到了 github。

任何人都可以提供一些帮助和/或建议吗？

nb：不确定最好的“堆栈”站点，在这里计算或编程？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T01:46:25.253

所以你有一个存储库 R 和一个不同的工作目录 W，你在没有任何版本控制的情况下工作，对吗？

基本上，在确保 R 中没有未提交的更改之后，将 R 的签出替换为 W 的内容：删除 R 的内容，除了 .git 目录和任何 .git* 文件，并复制W 进入它，以便保持不变的文件位于它们的旧位置。

然后你创建一个新的提交并将其推送到 github。

# mysql - 删除 MySQL 中具有特定名称的所有用户

> ID：11925890
> 
> 赞同：0
> 
> 时间：2012-08-12T21:07:08.800
> 
> 标签：mysql

无论主机参数如何，我都想从我的 MySQL 数据库中删除具有指定名称的所有用户。这是我写的：

```
DELIMITER ;;

## CREATING SCHEMA
DROP SCHEMA IF EXISTS rms;;
CREATE SCHEMA rms;;

USE rms;;

## DROP USER
DROP PROCEDURE IF EXISTS PREPARE_USERS;;
CREATE PROCEDURE PREPARE_USERS()
BEGIN
    DECLARE V_RECORD_NOT_FOUND INTEGER DEFAULT 0; 
    DECLARE V_USER_HOST CHAR(60);
    DECLARE C_HOSTS_CURSOR CURSOR FOR
        SELECT host FROM mysql.user WHERE user='rms';
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET V_RECORD_NOT_FOUND = 0;

    OPEN C_HOSTS_CURSOR;

    READ_LOOP: LOOP
        FETCH C_HOSTS_CURSOR INTO V_USER_HOST;
        IF V_RECORD_NOT_FOUND != 0 THEN
            LEAVE READ_LOOP;
        END IF;

        SET @V_EXEC=CONCAT(CONCAT('DROP USER \'rms\'@\'',V_USER_HOST),'\';;');
        PREPARE V_STMT FROM @V_EXEC;
        EXECUTE V_STMT;
        DEALLOCATE PREPARE V_STMT;
    END LOOP;

    CLOSE C_HOSTS_CURSOR;

    FLUSH PRIVILEGES;

    CREATE USER 'rms'@'127.0.0.1' IDENTIFIED BY 'rms123';
    GRANT ALL ON rms.* TO 'rms'@'127.0.0.1'
    WITH MAX_USER_CONNECTIONS  250;
END;;

CALL PREPARE_USERS();;

DROP PROCEDURE IF EXISTS PREPARE_USERS;;

DELIMITER ; 
```

但它给了我错误，我不知道为什么：/当没有用户名为“rms”时，它甚至不会运行，但如果有的话，MySQL 声称它们不能被删除，即使他们是。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:25:15.343

好的，我有答案：

```
SET @users = NULL;
SELECT GROUP_CONCAT('\'',user, '\'@\'', host, '\'') INTO @users FROM mysql.user WHERE user = 'rms';

SET @users = CONCAT('DROP USER ', @users);
PREPARE stmt1 FROM @users;
EXECUTE stmt1;
DEALLOCATE PREPARE stmt1; 
```

# algorithm - 我是否需要创建一个新变量来存储合并排序列表序列的结果？

> ID：11925892
> 
> 赞同：-1
> 
> 时间：2012-08-12T21:07:15.717
> 
> 标签：algorithm, list, merge, sequence, sorted

我认为我通过不创建新主题做了正确的事情。如果我错了，请纠正我。

我收到了一个问题，我需要合并两个基于列表的排序序列：

```
S1 = (1,5,8,12) S2 = (7,9,11,18) 
```

1.

```
S1 = (5,8,12)
S2 = (7,9,11,18)
? = 1 
```

2.

```
S1 = (8,12)
S2 = (7,9,11,18)
? = 1, 5 
```

3.

```
S1 = (8,12)
S2 = (9,11,18)
? = 1, 5, 7 
```

4.

```
S1 = (12)
S2 = (9,11,18)
? = 1, 5, 7, 8 
```

5.

```
S1 = (12)
S2 = (11,18)
? = 1, 5, 7, 8, 9 
```

6.

```
S1 = (12)
S2 = (18)
? = 1, 5, 7, 8, 9, 11 
```

7.

```
S1 = ()
S2 = (18)
? = 1, 5, 7, 8, 9, 11, 12 
```

8.

```
S1 = ()
S2 = ()
? = 1, 5, 7, 8, 9, 11, 12, 18 
```

我首先查看了我的演讲幻灯片，其中给出了这个例子：

[https://dl.dropbox.com/u/8049855/Dream%20In%20Code/Screen%20Shot%202012-08-12%20at%2022.00.10.png](https://dl.dropbox.com/u/8049855/Dream%20In%20Code/Screen%20Shot%202012-08-12%20at%2022.00.10.png)

首先，如果我错了，有人可以帮助纠正我吗？第二，我觉得我需要创建一个新变量来存储结果，但我会怎么称呼它 - S3？- 在我的演讲幻灯片中，有三个变量 - A、B 和 S。

作为旁注，我还在 YouTube 上找到了一个讨论其他排序算法的热门链接：

www.youtube.com/xoaxdotnet

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T00:14:10.310

当然，结果需要一个新变量：它不同于两个输入变量。您可以随意称呼它（已使用的名称除外）。

# php - 雅虎 YQL 测试控制台和我的应用程序返回不同的结果

> ID：11925893
> 
> 赞同：0
> 
> 时间：2012-08-12T21:07:18.647
> 
> 标签：php, api, yahoo, import-contacts

yahoo YQL 测试控制台可以列出我的联系人。而在我的应用程序中，我没有看到任何结果。空的。我错过了什么？（我正在使用 php sdk）

我已启用我的雅虎应用程序设置联系人和配置文件功能。

我已经使用 yahoo api 工作了 2 天。它有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T12:26:57.863

从 facebook 导入的 yahoo 联系人似乎有一个错误，这真是太好了。感谢失去的时代雅虎！

# php - HTML - 选择下拉菜单中的数字

> ID：11925894
> 
> 赞同：1
> 
> 时间：2012-08-12T21:07:24.683
> 
> 标签：php, html, drop-down-menu

我有一个包含数字 1-20 的下拉菜单的 HTML 页面 (index.php)。有没有一种更简单的方法可以将选项添加到下拉菜单中，而不仅仅是手动添加每个选项，例如：

```
<option value=1>1</option>
...
<option value=20>20</option> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T21:10:37.613

As you already mention php in your tags, then using a for-loop when generating the web page would be possible:

```
for ($i = 1; $i<=20; $i++) {
    echo '<option value="'.$i.'">'.$i.'</option>';
} 
```

You should further think about spending some more quotes to the value attribute as in my code above.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T21:12:52.527

Easiest would be a [for loop](http://php.net/manual/en/control-structures.for.php) :

```
<?php for ($i = 1; $i <=20; $i++) : ?>
    <option value="<?php echo $i; ?>"><?php echo $i; ?></option>
<?php endfor; ?> 
```

# python - 在本地调用 open_sftp() 和通过单独的函数有什么区别？

> ID：11925895
> 
> 赞同：3
> 
> 时间：2012-08-12T21:07:57.083
> 
> 标签：python, paramiko

在下面的代码中，第一个测试通过了，而第二个测试没有通过，我觉得这很令人费解。

```
import paramiko

def test1():
    client = paramiko.SSHClient()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    client.connect('10.0.0.107', username='test', password='test')
    sftp = client.open_sftp()
    sftp.stat('/tmp')
    sftp.close()

def get_sftp():
    client = paramiko.SSHClient()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    client.connect('10.0.0.107', username='test', password='test')
    return client.open_sftp()

def test2():
    sftp = get_sftp()
    sftp.stat('/tmp')
    sftp.close()

if __name__ == '__main__':
    test1()
    print 'test1 done'
    test2()
    print 'test2 done' 
```

这是我得到的：

```
$ ./script.py
test1 done
Traceback (most recent call last):
  File "./play.py", line 25, in <module>
    test2()
  File "./play.py", line 20, in test2
    sftp.stat('/tmp')
  File "/usr/lib/pymodules/python2.6/paramiko/sftp_client.py", line 337, in stat
    t, msg = self._request(CMD_STAT, path)
  File "/usr/lib/pymodules/python2.6/paramiko/sftp_client.py", line 627, in _request
    num = self._async_request(type(None), t, *arg)
  File "/usr/lib/pymodules/python2.6/paramiko/sftp_client.py", line 649, in _async_request
    self._send_packet(t, str(msg))
  File "/usr/lib/pymodules/python2.6/paramiko/sftp.py", line 172, in _send_packet
    self._write_all(out)
  File "/usr/lib/pymodules/python2.6/paramiko/sftp.py", line 138, in _write_all
    raise EOFError()
EOFError 
```

这发生在 Ubuntu（Python **2.6**和 paramiko **1.7.6**）和 Debian（Python **2.7**和 paramiko **1.7.7**）上。

如果我`test2`先运行，我只会得到堆栈跟踪，这意味着`test2`确实失败了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T14:08:35.250

好的，我已经在 debian/python2.6/paramiko1.7.6 上验证过了。

原因是`client`对象超出了范围`get_sftp`（并关闭了“通道”）。如果您取消它，以便返回客户：

```
import paramiko

def get_sftp():
    client = paramiko.SSHClient()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    client.connect('localhost', username='root', password='B4nan-purr(en)')
    return client

def test2():
    client = get_sftp()
    sftp = client.open_sftp()
    sftp.stat('/tmp')
    sftp.close()

if __name__ == "__main__":
    test2() 
```

那么一切都会起作用（函数名可能应该改变..）。

# eclipse - 如何在 Eclipse RCP 中实现嵌套选项卡视图？

> ID：11925897
> 
> 赞同：0
> 
> 时间：2012-08-12T21:08:02.047
> 
> 标签：eclipse, view, nested, eclipse-rcp

有人有想法吗，如何在 RCP 中实现布局，其中视图看起来像选项卡并出现嵌套？

选项卡应该具有视图的所有优点 - 可以拖动到桌面以成为分离视图，彼此靠近平铺，重新排列等。

图片上的视图：View4 和 View5 嵌套在 View1 中。

![布局](../Images/d9e451c5e5b053204cc3e9df14858700.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T03:39:05.597

以我的经验，这样的事情并不容易——在你的未来可能会有很多自定义编码。我将尝试从高级架构的角度更多地介绍这一点，因为您需要根据自己的要求和优势来确定很多细节。

我认为有两种方法可以解决这个问题：

**1\. 编写一个视图扩展，其中该视图的内容是其他视图。**

这会减少前期工作，但可能更难让视图重新排列工作。根据您的模型，这意味着 View1 是该视图的一个实例，并负责呈现 View4/View5 的选项卡控件，并告诉这些视图呈现其内容。您可能会寻找`MultiPageEditorPart`一些灵感，尽管您可能希望将选项卡渲染得更好一些。

在这种情况下，您的子视图可能会专门插入其父视图。视图中的拖放支持不会太糟糕，尽管将它们拉出视图会涉及一些工作。 [本文](http://www.eclipse.org/articles/Article-SWT-DND/DND-in-SWT.html)提供了拖放的基本介绍；谷歌可以提供其余的。

**2\. 编写自定义演示文稿以这种方式呈现您的视图。**

这可能需要更多的工作来了解表示层的工作原理，但一旦完成，可能会更容易获得您正在寻找的所有功能。有关表示层的介绍， 请参阅[本文。](http://wiki.eclipse.org/RCP_Custom_Look_and_Feel)

在这种情况下，插件系统会将您的所有视图视为顶级视图 - 您的表示层决定在哪里呈现视图内容的区域。我已经将表示层用于类似的事情，但在我的情况下，视图都是静态定位的。也就是说，由于一切都是常规视图，因此您应该能够重用现有的拖放功能来重新排列视图，而比其他选项更省力。

# php - 我怎样才能阅读所有 来自 Twitter 时间线的用户标签？

> ID：11925900
> 
> 赞同：0
> 
> 时间：2012-08-12T21:08:25.223
> 
> 标签：php, curl, twitter, preg-match-all

我正在尝试使用 cURL 阅读 twitter 时间线，但由于某种原因，我无法使用 preg_match。这是我当前的代码，您发现任何问题吗？

```
$feed = "http://twitter.com/statuses/user_timeline/antonpug.xml?count=3";

function parse_feed($feed) {
    //$matches = Array();
    preg_match_all("/<status>(.*?)<\/status>/", $content[0], $matches);

    return $matches[0];

    //$stepOne = explode("<content type=\"html\">", $feed);
    //$stepTwo = explode("</content>", $stepOne[1]);
    //$tweet = $stepTwo[0];
    //$tweet = htmlspecialchars_decode($tweet,ENT_QUOTES);
    //return $tweet;
}

//Initialize the Curl session
$ch = curl_init();
//Set curl to return the data instead of printing it to the browser.
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
//Set the URL
curl_setopt($ch, CURLOPT_URL, $feed);
//Execute the fetch
$twitterFeed = curl_exec($ch);
//Close the connection
curl_close($ch);

//$twitterFeed = file_get_contents($feed);
echo(parse_feed($twitterFeed)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:24:32.120

我想更好的主意是使用 simplexml 来处理 XML 和对象一样。您的功能将类似于

```
function parse_feed($feed) {
    $xml = simplexml_load_string($feed);
    if(isset($xml->status)) {
        return $xml->xpath('status');
    } else {
        return false;
    }
} 
```

它将返回 simplexml 对象。

# php - 去除/平滑 gd 库中的粗糙边缘

> ID：11925909
> 
> 赞同：3
> 
> 时间：2012-08-12T21:09:46.113
> 
> 标签：php, gd

我正在使用 GD 库动态创建图像。
但是当我使用 imagerotate() 函数旋转图像时
，它可以正常工作，但它会产生非常恼人的
旋转图像粗糙边缘。
如图所示。
那么如何使旋转图像的这些边/边缘平滑？
![在此处输入图像描述](../Images/9daab9c28f2e449604d439df3ca85f0d.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T12:13:24.627

避免旋转图像时出现[锯齿效果](http://en.wikipedia.org/wiki/Jaggies)的一种方法是使用另一种方法对像素进行采样，而不是仅采用调整后的像素，例如使用[最近邻插值](http://en.wikipedia.org/wiki/Nearest-neighbor_interpolation)使边缘更平滑。您可以查看 matlab 代码示例：

```
im1 = imread('lena.jpg');imshow(im1);  
[m,n,p]=size(im1);
thet = rand(1);
mm = m*sqrt(2);
nn = n*sqrt(2);
for t=1:mm
   for s=1:nn
      i = uint16((t-mm/2)*cos(thet)+(s-nn/2)*sin(thet)+m/2);
      j = uint16(-(t-mm/2)*sin(thet)+(s-nn/2)*cos(thet)+n/2);
      if i>0 && j>0 && i<=m && j<=n           
         im2(t,s,:)=im1(i,j,:);
      end
   end
end
figure;
imshow(im2); 
```

取自（[这里](https://stackoverflow.com/questions/1811372/how-to-rotate-image-by-nearest-neighbor-interpolation-using-matlab#answer-1843931)）。基本上就是在对原始图片中的像素进行采样时，我们对附近的像素进行采样，并对其进行插值得到目标像素值。这样，您无需安装任何其他软件包即可实现您想要的效果。

**编辑**

我发现了一些我曾经用 Java 编写的旧代码，其中包含几个采样算法的实现。这是代码：

**最近邻采样器：**

```
/**
 * @pre (this!=null) && (this.pixels!=null)
 * @post returns the sampled pixel of (x,y) by nearest neighbor sampling
 */
private Pixel sampleNearestNeighbor(double x, double y) {
    int X = (int) Math.round(x);
    int Y = (int) Math.round(y);
    if (X >= 0 && Y >= 0 && X < this.pixels.length
            && Y < this.pixels[0].length)
        // (X,Y) is within this.pixels' borders
        return new Pixel(pixels[X][Y].getRGB());
    else
        return new Pixel(255, 255, 255);
    // sample color will be default white
} 
```

**双线性采样器：**

```
/**
 * @pre (this!=null) && (this.pixels!=null)
 * @post returns the sampled pixel of (x,y) by bilinear interpolation
 */
private Pixel sampleBilinear(double x, double y) {
    int x1, y1, x2, y2;
    x1 = (int) Math.floor(x);
    y1 = (int) Math.floor(y);
    double weightX = x - x1;
    double weightY = y - y1;
    if (x1 >= 0 && y1 >= 0 && x1 + 1 < this.pixels.length
            && y1 + 1 < this.pixels[0].length) {
        x2 = x1 + 1;
        y2 = y1 + 1;

        double redAX = (weightX * this.pixels[x2][y1].getRed())
                + (1 - weightX) * this.pixels[x1][y1].getRed();
        double greenAX = (weightX * this.pixels[x2][y1].getGreen())
                + (1 - weightX) * this.pixels[x1][y1].getGreen();
        double blueAX = (weightX * this.pixels[x2][y1].getBlue())
                + (1 - weightX) * this.pixels[x1][y1].getBlue();
        // bilinear interpolation of A point

        double redBX = (weightX * this.pixels[x2][y2].getRed())
                + (1 - weightX) * this.pixels[x1][y2].getRed();
        double greenBX = (weightX * this.pixels[x2][y2].getGreen())
                + (1 - weightX) * this.pixels[x1][y2].getGreen();
        double blueBX = (weightX * this.pixels[x2][y2].getBlue())
                + (1 - weightX) * this.pixels[x1][y2].getBlue();
        // bilinear interpolation of B point

        int red = (int) (weightY * redBX + (1 - weightY) * redAX);
        int green = (int) (weightY * greenBX + (1 - weightY) * greenAX);
        int blue = (int) (weightY * blueBX + (1 - weightY) * blueAX);
        // bilinear interpolation of A and B
        return new Pixel(red, green, blue);

    } else if (x1 >= 0
            && y1 >= 0 // last row or column
            && (x1 == this.pixels.length - 1 || y1 == this.pixels[0].length - 1)) {
        return new Pixel(this.pixels[x1][y1].getRed(), this.pixels[x1][y1]
                .getGreen(), this.pixels[x1][y1].getBlue());
    } else
        return new Pixel(255, 255, 255);
    // sample color will be default white
} 
```

**高斯采样器：**

```
/**
 * @pre (this!=null) && (this.pixels!=null)
 * @post returns the sampled pixel of (x,y) by gaussian function
 */
private Pixel sampleGaussian(double u, double v) {
    double w = 3; // sampling distance
    double sqrSigma = Math.pow(w / 3.0, 2); // sigma^2
    double normal = 0;
    double red = 0, green = 0, blue = 0;
    double minIX = Math.round(u - w);
    double maxIX = Math.round(u + w);
    double minIY = Math.round(v - w);
    double maxIY = Math.round(v + w);

    for (int ix = (int) minIX; ix <= maxIX; ix++) {
        for (int iy = (int) minIY; iy <= maxIY; iy++) {
            double sqrD = Math.pow(ix - u, 2) + Math.pow(iy - v, 2);
            // squared distance between (ix,iy) and (u,v)
            if (sqrD < Math.pow(w, 2) && ix >= 0 && iy >= 0
                    && ix < pixels.length && iy < pixels[0].length) {
                // gaussian function
                double gaussianWeight = Math.pow(2, -1 * (sqrD / sqrSigma));
                normal += gaussianWeight;
                red += gaussianWeight * pixels[ix][iy].getRed();
                green += gaussianWeight * pixels[ix][iy].getGreen();
                blue += gaussianWeight * pixels[ix][iy].getBlue();
            }
        }
    }
    red /= normal;
    green /= normal;
    blue /= normal;
    return new Pixel(red, green, blue);
} 
```

**实际旋转：**

```
 /**
 * @pre (this!=null) && (this.pixels!=null) && (1 <= samplingMethod <= 3)
 * @post creates a new rotated-by-degrees Image and returns it
 */
public myImage rotate(double degrees, int samplingMethod) {
    myImage outputImg = null;

    int t = 0;
    for (; degrees < 0 || degrees >= 180; degrees += (degrees < 0) ? 180
            : -180)
        t++;

    int w = this.pixels.length;
    int h = this.pixels[0].length;
    double cosinus = Math.cos(Math.toRadians(degrees));
    double sinus = Math.sin(Math.toRadians(degrees));

    int width = Math.round((float) (w * Math.abs(cosinus) + h * sinus));
    int height = Math.round((float) (h * Math.abs(cosinus) + w * sinus));

    w--;
    h--; // move from (1,..,k) to (0,..,1-k)

    Pixel[][] pixelsArray = new Pixel[width][height];
    double x = 0; // x coordinate in the source image
    double y = 0; // y coordinate in the source image

    if (degrees >= 90) { // // 270 or 90 degrees turn
        double temp = cosinus;
        cosinus = sinus;
        sinus = -temp;
    }

    for (int i = 0; i < width; i++) {
        for (int j = 0; j < height; j++) {

            double x0 = i;
            double y0 = j;
            if (degrees >= 90) {
                if ((t % 2 == 1)) { // 270 degrees turn
                    x0 = j;
                    y0 = width - i - 1;
                } else { // 90 degrees turn
                    x0 = height - j - 1;
                    y0 = i;
                }
            } else if (t % 2 == 1) { // 180 degrees turn
                x0 = width - x0 - 1;
                y0 = height - y0 - 1;
            }

            // calculate new x/y coordinates and
            // adjust their locations to the middle of the picture
            x = x0 * cosinus - (y0 - sinus * w) * sinus;
            y = x0 * sinus + (y0 - sinus * w) * cosinus;

            if (x < -0.5 || x > w + 0.5 || y < -0.5 || y > h + 0.5)
                // the pixels that does not have a source will be painted in
                // default white
                pixelsArray[i][j] = new Pixel(255, 255, 255);
            else {
                if (samplingMethod == 1)
                    pixelsArray[i][j] = sampleNearestNeighbor(x, y);
                else if (samplingMethod == 2)
                    pixelsArray[i][j] = sampleBilinear(x, y);
                else if (samplingMethod == 3)
                    pixelsArray[i][j] = sampleGaussian(x, y);
            }
        }
        outputImg = new myImage(pixelsArray);
    }

    return outputImg;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:46:45.490

这听起来可能有点骇人听闻，但这是最简单的方法，甚至大型企业解决方案也使用它。

诀窍是首先将图像创建为所需大小的 2 倍，然后执行所有绘图调用，然后将其调整为所需的原始大小。

它不仅真的很容易做到，而且它的速度也很快，并且产生了非常好的结果。当我需要对边缘应用模糊时，我会在所有情况下使用这个技巧。

另一个优点是它不包括图像其余部分的模糊，并且保持清晰 - 只有旋转图像的边界得到平滑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T11:24:04.190

您可以尝试的一件事是使用[`imageantialias()`](http://us.php.net/imageantialias)平滑边缘。

如果这不能满足您的需求，GD 本身可能还不够。

GD 对它的所有能力都使用了非常快速的方法，而没有任何实际的平滑或类似的东西。如果您想要一些适当的图像编辑，您可以查看[ImageMagick](http://php.net/manual/en/book.imagick.php)（这需要服务器上的额外软件）或基于 GD 编写自己的函数。

但请记住，对于大量数据，php 真的很慢，所以编写自己的函数可能会令人失望。（根据我的经验，PHP 比编译代码慢大约 40 倍。）

我建议将[ImageMagick](http://php.net/manual/en/book.imagick.php)用于任何结果质量很重要的图像工作。

# matlab - 求解质量弹簧系统的线性方程

> ID：11925910
> 
> 赞同：-1
> 
> 时间：2012-08-12T21:09:48.283
> 
> 标签：matlab, math, equation

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T12:23:47.553

只有c和k？米呢？你也不需要那个吗？

这是一个齐次 ODE。该数组告诉您在时间为零时的初始位移是多少，但是速度呢？你需要两个初始条件。您是否会假设一开始的速度也为零？还是您会选择根据您拥有的两点计算一阶差？

我建议绘制这些值，查看它们的外观，并尝试根据您观察到的内容对常数进行有根据的猜测。你知道这个 ODE 的闭式解；您可能能够根据您提供的数据来判断这些值应该是什么。

完成此操作后，我建议根据计算的多个点的差异为未知数编写矩阵解决方案。这会将问题变成常数的最小二乘解决方案。可能是一组常数不会在每个时间点都满足方程。

另一种方法是对数据进行 FFT 并将其与频域中的解决方案进行比较。

# python - jsonpickle/json 函数输入 utf-8，输出 unicode？

> ID：11925919
> 
> 赞同：2
> 
> 时间：2012-08-12T21:11:26.300
> 
> 标签：python, json, encoding, jsonpickle

使用 json 和 jsonpickle 的组合（在 2.7 中）编写了以下两个函数，用于存储和检索任何 Python（内置或用户定义）对象

```
def save(kind, obj):
    pickled = jsonpickle.encode(obj)
    filename = DATA_DESTINATION[kind] \\returns file destination to store json
    if os.path.isfile(filename):
        open(filename, 'w').close()
    with open(filename, 'w') as f:
        json.dump(pickled, f)

def retrieve(kind):
    filename = DATA_DESTINATION[kind] \\returns file destination to store json
    if os.path.isfile(filename):
        with open(filename, 'r') as f:
            pickled = json.load(f)
            unpickled = jsonpickle.decode(pickled)
            print unpickled 
```

我没有使用用户定义的对象测试这两个函数，但是当我尝试 save() 一个内置的字符串字典时，（即 {'Adam': 'Age 19', 'Bill', 'Age 32 '}），然后我检索相同的文件，我得到相同的 unicode 字典，{u'Adam': u'Age 19', u'Bill', u'Age 32'}。我以为 json/jsonpickle 默认编码为 utf-8，这是怎么回事？

[更新]：删除所有 jsonpickle 编码/解码不会影响输出，仍然是 unicode，似乎是 json 的问题？也许我做错了什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-07-21T10:41:41.620

```
import jsonpickle
import json

jsonpickle.set_preferred_backend('json')
jsonpickle.set_encoder_options('json', ensure_ascii=False)
print( jsonpickle.encode( { "value" : "значение"}) ) 
```

{“价值”：“значение”}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T22:01:32.223

您可以在调用 load() 后对 unicode 字符串进行编码。

```
json.loads('"\\u79c1"').encode('utf-8') 
```

现在你又有了一个正常的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T21:18:42.993

> 我以为 json ... 默认编码为 utf-8，这是怎么回事？

不，它编码为 ASCII。它解码为`unicode`.

```
>>> json.dumps(u'私')
'"\\u79c1"'
>>> json.loads('"\\u79c1"')
u'\u79c1' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T09:59:57.443

问题是 json 作为一种序列化格式，表达能力不够，无法承载有关字符串原始类型的信息。换句话说，如果你有一个 json 字符串`a`，你无法判断它是来自 python 字符串`"a"`还是来自 python *unicode*字符串`u"a"`。

实际上，您可以阅读[json 模块的文档中](http://docs.python.org/library/json.html#json.dump)关于 option 的信息`ensure_ascii`。基本上，根据您要编写生成的 json 的位置，您可能会容忍一个 unicode 字符串，或者需要一个所有传入 unicode 字符正确转义的 ascii 字符串。

例如：

```
>>> import json
>>> json.dumps({'a':'b'})
'{"a": "b"}'
>>> json.dumps({'a':u'b'}, ensure_ascii=False)
u'{"a": "b"}'
>>> json.dumps({'a':u'b'})
'{"a": "b"}'
>>> json.dumps({u'a':'b'})
'{"a": "b"}'
>>> json.dumps({'a':u'\xe0'})
'{"a": "\\u00e0"}'
>>> json.dumps({'a':u'\xe0'}, ensure_ascii=False)
u'{"a": "\xe0"}' 
```

如您所见，根据您的值，`ensure_ascii`您最终会得到一个 ascii json 字符串或 unicode 字符串，但原始对象的组件都被展平为相同的通用编码。特别看`{"a": "b"}`情况。

`jsonpickle`只是将`json`其用作其底层序列化引擎，不添加额外的元数据来跟踪原始字符串类型，因此您实际上在此过程中丢失了信息。

```
>>> jsonpickle.encode({'a': 'b'})
'{"a": "b"}'
>>> jsonpickle.encode({'a': u'b'})
'{"a": "b"}'
>>> jsonpickle.encode({u'a': 'b'})
'{"a": "b"}' 
```

# php - MySQL database with entries increasing by 1 million every month, how can I partition the database to keep a check on query time

> ID：11925924
> 
> 赞同：0
> 
> 时间：2012-08-12T21:11:59.240
> 
> 标签：php, mysql, query-optimization, database-partitioning, large-data

*   I am a college undergrad working on a PHP and MySQL based inventory management system operating on a country-wide level. Its database size is projected to increase by about 1 million plus entries every month with current size of about 2 million.
*   I need to prevent the exponential increase in query time which is currently ranges from 7-11 seconds for most modules.

*   The thing is that the probability of accessing data entered in the last month is much higher as compared to any older data. So I believe partitioning of data on the basis of time of data entry should be able to keep the query time in check. So how can I achieve this.

*   Specifically speaking I want to have a way to cache the last month's data so that every query searches for the product in the tables having recent data and should search rest of the data in case it is not found in the last 1 month's data.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:58:03.427

如果你想使用 MySQL 的分区功能，看看[这篇文章](http://everythingmysql.ning.com/profiles/blogs/partitioning-by-dates-the)。

话虽如此，使用分区时有一些限制：

*   你不能有不在分区键中的索引
*   您失去了一些数据库的可移植性，因为分区与其他数据库的工作方式完全不同。

您还可以通过定期将旧记录移动到存档表来手动处理分区。当然，您还必须实现不同的代码来读取这些归档记录。

另请注意，您的查询时间似乎很长。我使用的表比 200 万条记录大得多，访问时间要好得多。

# python - Py2EXE Compile Error using Pygame

> ID：11925925
> 
> 赞同：2
> 
> 时间：2012-08-12T21:12:02.213
> 
> 标签：python, compilation, compiler-errors, pygame, py2exe

I'm just using Py2exe to compile a simple pygame program into an executable file, but I get the following error:

```
*** binary dependencies ***
Your executable(s) also depend on these dlls which are not included, you may or
may not need to distribute them.

Make sure you have the license if you distribute any of them, and make sure you
don't distribute files belonging to the operating system.

    OLEAUT32.dll - C:\windows\system32\OLEAUT32.dll
    USER32.dll - C:\windows\system32\USER32.dll
    IMM32.dll - C:\windows\system32\IMM32.dll
    SHELL32.dll - C:\windows\system32\SHELL32.dll
    ole32.dll - C:\windows\system32\ole32.dll
    COMDLG32.dll - C:\windows\system32\COMDLG32.dll
    COMCTL32.dll - C:\windows\system32\COMCTL32.dll
    ADVAPI32.DLL - C:\windows\system32\ADVAPI32.DLL
    WS2_32.dll - C:\windows\system32\WS2_32.dll
    GDI32.dll - C:\windows\system32\GDI32.dll
    WINMM.DLL - C:\windows\system32\WINMM.DLL
    KERNEL32.dll - C:\windows\system32\KERNEL32.dll
    SDL_ttf.dll - C:\Python27\lib\site-packages\pygame\SDL_ttf.dll
    libogg-0.dll - C:\Python27\lib\site-packages\pygame\libogg-0.dll 
```

When I try to run the .exe that was created, it doesn't run. I'm quite familiar with Pygame, but Py2exe is entirely new to me. Any help is appreciated, as I've looked through the web all morning for a solution.

This is what appears when I try to run it:

```
test.exe:1: RuntimeWarning: import display: No module named _view
    (ImportError: No module named _view)
    test.exe:1: RuntimeWarning: import draw: No module named _view
    (ImportError: No module named _view)
    test.exe:1: RuntimeWarning: import image: No module named _view
    (ImportError: No module named _view)
    test.exe:1: RuntimeWarning: import pixelcopy: No module named _view
    (ImportError: No module named _view)
    test.exe:1: RuntimeWarning: import transform: No module named _view
    (ImportError: No module named _view)
    Traceback (most recent call last):
      File "test.py", line 7, in <module>
      File "pygame\__init__.pyc", line 70, in __getattr__
    NotImplementedError: display module not available
    (ImportError: No module named _view) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-18T22:23:54.423

尝试将其添加到您的主程序中：

```
from pygame.locals import * 
```

它在编译 pygame 时解决了我的问题

# jquery - How to add Jquery to Sublime Text 2?

> ID：11925927
> 
> 赞同：6
> 
> 时间：2012-08-12T21:12:32.373
> 
> 标签：jquery, sublimetext2

This may sound stupid.

But how do you add Jquery to sublime text 2?

Can't seem to get it working.

I've added [this](https://github.com/kswedberg/jquery-tmbundle) github.

Then created a Jquery folder in my packages.

Finally I added this into my head tags.

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> 
```

But still no luck.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-18T20:36:17.123

首先将 Package Control 添加到 Sublime Text。这是通过 ctrl+` 快捷方式访问的。打开后，将[此处](https://packagecontrol.io/installation#st2)的代码粘贴到控制台中，然后按 Enter。

转到 Preferences > Package Control > 从该列表中单击*Package Control Install Package*然后搜索 jQuery。这将安装 jQuery。

现在，如果您想要 jQuery 的自动完成功能，请按照以下步骤操作：

1.  Domnload这个：[来自github的包](https://github.com/agibsonsw/AndySublime/zipball/master)
2.  将内容提取到您可以快速访问的地方，查找文件“AndyjQuery.sublime-completions”。
3.  不确定它是否可以仅使用当前名称放置文件，所以我将其重命名为“jQuery.sublime-completions”</li>
4.  将此文件放在 jQuery 文件夹中，从您转到 Preferences - Browse Packages 时打开的位置

如果您想在按下点时使用自动完成功能：转到首选项 - 设置用户并添加此

> "auto_complete_triggers": [ {"selector": "source.js", "characters": "."} ],

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-13T02:54:31.183

Sublime Text 2 使用 JavaScript 语法来支持 jQuery。在查看您尝试过的 Github 存储库时，我假设您想要某种片段库。我会推荐这个：[https://github.com/aaronpowell/sublime-jquery-snippets](https://github.com/aaronpowell/sublime-jquery-snippets)和/或[https://github.com/SublimeText/jQuery](https://github.com/SublimeText/jQuery)。

为了为您澄清其他内容，请添加：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> 
```

将 jQuery 库添加到您的 HTML 页面，以便您可以使用它的方法和函数。它不会将它添加到 Sublime Text 2 中，但由于上述原因，它仍然是必要的。

# scala - Solution for DuplicateKey: E11000 duplicate key error index with Play! 2.0 Framework

> ID：11925928
> 
> 赞同：0
> 
> 时间：2012-08-12T21:12:44.493
> 
> 标签：scala, playframework-2.0

I am using the play-salat plugin with an app I am making with Play! 2.0 scala.

I get the Duplicate Key error, and the compiler points here to the error:

```
object Post extends ModelCompanion[Post, ObjectId] 
```

I have read that this can be fixed in PHP [here](http://architects.dzone.com/articles/mongocursorexception-e11000) doing an unset, please tell me how to do this with Play.

I am able to post in my database the once, when I try again I get the error.

```
def save = Action { implicit request =>
postForm.bindFromRequest.fold(
  formWithErrors => BadRequest(html.newpost(formWithErrors)),
  post => {
    Post.insert(post)
    Home
  }
)
}

val postForm = Form(
mapping(
  "_id" -> ignored(new ObjectId()),
  "title" -> nonEmptyText,
  "content" -> nonEmptyText,
  "posted" -> date("yyyy-MM-dd"),
  "modified" -> optional(date("yyyy-MM-dd")),
  "tags" -> nonEmptyText,
  "categories" -> nonEmptyText,
  "userId" -> nonEmptyText
)(Post.apply)(Post.unapply)
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T01:11:25.057

我自己解决了这个问题。我对 Scala 和 Play Framework 很陌生。

我像这样更改了我的 Application.scala 文件：

```
def newpost = Action {
Ok(views.html.newpost(postForm))
}

def save = Action { implicit request =>
postForm.bindFromRequest.fold(
  formWithErrors => BadRequest(html.newpost(formWithErrors)),
  post => {
    Post.create(post.title, post.content, post.posted, post.modified, post.categories, post.tags, post.author)
    Home.flashing("success" -> "Post %s has been created".format(post.title))
  }
)
}

val postForm = Form(
mapping(
  "_id" -> ignored(new ObjectId()),
  "title" -> nonEmptyText,
  "content" -> nonEmptyText,
  "posted" -> date("yyyy-MM-dd"),
  "modified" -> optional(date("yyyy-MM-dd")),
  "categories" -> nonEmptyText,
  "tags" -> nonEmptyText,
  "author" -> nonEmptyText
)(Post.apply)(Post.unapply)
) 
```

我还更改了我的 Post.scala 文件：

```
 object PostDAO extends SalatDAO[Post, ObjectId](
collection = MongoConnection()("blog")("posts"))

 object Post {

  def create(title: String, content: String, posted: Date = new Date(), modified: Option[Date] = None, categories: String, tags: String, author: String) {
    PostDAO.insert(Post(
        title = title,
        content = content,
        posted = posted,
        modified = modified,
        categories = categories,
        tags = tags,
        author = author
        ))
  }

  def delete(id: String) {
    PostDAO.remove(MongoDBObject("_id" -> new ObjectId(id)))
}
} 
```

# mysql - 计算单行中单词的出现次数

> ID：11925931
> 
> 赞同：1
> 
> 时间：2012-08-12T21:13:04.180
> 
> 标签：mysql, sql

我有一个搜索查询，它能够根据查询中实际显示的单词数量按相关性对结果进行排序。

```
SELECT id, 
       thesis 
FROM   activity p 
WHERE  p.discriminator = 'opinion' 
       AND ( thesis LIKE '%gun%' 
              OR thesis LIKE '%crucial%' ) 
ORDER  BY ( ( CASE 
                WHEN thesis LIKE '%gun%' THEN 1 
                ELSE 0 
              end ) 
          + ( CASE 
                WHEN thesis LIKE '%crucial%' THEN 1 
                ELSE 0 
              end ) ) 
           DESC 
```

但是，此查询不会根据“枪”或“关键”出现的次数进行排序。我想让它出现更多“枪”的记录出现在出现次数较少的记录之上。（即，每次枪出现时加一分，而不是因为枪至少出现一次而加分）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T22:23:43.707

我可能错了，但不使用存储过程或 UDF 您将无法计算字符串的出现次数。这是计算子字符串的示例存储函数：

```
drop function if exists str_count;

delimiter |
create function str_count(sub varchar(255), str varchar(255)) RETURNS INTEGER
DETERMINISTIC NO SQL
BEGIN
    DECLARE count INT;
    DECLARE cur INT;

    SET count = 0;
    SET cur = 0;

    REPEAT
        SET cur = LOCATE(sub, str, cur+1);
        SET count = count + (cur > 0);
    UNTIL (cur = 0)
    END REPEAT;

    RETURN(count);
END| 
```

您可能希望将 varchar(255) 更改为 varchar(65536) 或 TEXT。您现在可以通过查询按顺序使用它：

```
SELECT id, 
       thesis 
FROM   activity p 
WHERE  p.discriminator = 'opinion' 
       AND ( thesis LIKE '%gun%' 
              OR thesis LIKE '%crucial%' ) 
ORDER  BY STR_COUNT('gun',thesis) + STR_COUNT('crucial', thesis) 
```

如果您的数据集很大并且性能对您很重要，我建议您用 C 编写自定义 UDF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T21:40:51.113

根据您的数据库的设置方式，您可能会发现 MySQL 的全文索引更适合您的用例。它允许您索引字段并搜索其中的单词，并根据与出现次数相关的相关性对结果进行排序。

请参阅此处的文档：http: [//dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

这是一个有用的问题，它提供了一些示例，并且可能会有所帮助：[如何操纵 MySQL 全文搜索相关性以使一个字段比另一个字段更“有价值”？](https://stackoverflow.com/questions/547542/how-can-i-manipulate-mysql-fulltext-search-relevance-to-make-one-field-more-val)

最后，如果您不能选择全文搜索，Andrew Hanna 在字符串函数参考上发表的评论可能会起到作用：http: [//dev.mysql.com/doc/refman/5.0/en/string- functions.html](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)（在页面中搜索“Andrew Hanna”）。他们在服务器上创建了一个函数，可以计算字符串出现的次数。

希望这可以帮助。

# ios - TestFlight Live 是如何工作的？

> ID：11925932
> 
> 赞同：2
> 
> 时间：2012-08-12T21:13:13.663
> 
> 标签：ios, app-store, testflight

是否可以使用 TestFlight Live 为我的 App Store 提交的应用程序进行分析和崩溃报告？

如果是这样，它是如何工作的？我可以得到象征性的崩溃吗？TestFlight Live 的文档不是很丰富。我知道它是测试版，但我想了解更多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T13:19:34.580

是的，您可以将 Testflight Live 用于“一些”分析，例如当前用户数量、使用您的应用的唯一用户数量、会话数、会话的平均时间等。

最好自己试一试。它很容易设置，在您的项目中包含 SDK，然后一行代码即可启动。你可以做更多的事情，比如添加代码，这样你就可以在完成第 1 级后向测试人员展示问题，询问它是否太容易了（例如）。

符号化是可能的，您可以上传您的 .dSYM 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T21:18:56.030

查看[Crashlytics](http://beta.crashlytics.com)以获取您的崩溃报告。它非常轻巧且易于设置。它还给出了非常详细的（程序崩溃的那一行）结果。

# asp.net-mvc - 无法在 ASP.NET MVC 中将标头添加到响应

> ID：11925933
> 
> 赞同：2
> 
> 时间：2012-08-12T21:13:16.070
> 
> 标签：asp.net-mvc, download

我正在尝试允许用户下载文件，并且已经尝试了很长一段时间但无济于事。我一直在使用的代码是：

```
Response.ClearHeaders();
Response.Clear();
Response.BufferOutput = true;
Response.AddHeader("Content-disposition", 
                    "attachment; filename= "+ Path.GetFileName(path) + fileType);                     
Response.ContentType = "application/octet-stream";
Response.BinaryWrite(buffer);
Response.Flush();
Response.Close();
Response.End(); 
```

不幸的是，当我尝试让它运行时什么都没有发生，除了很多例外：

```
A first chance exception of type 'System.Web.HttpException' occurred in System.Web.dll
A first chance exception of type 'System.Web.HttpException' occurred in System.Web.Mvc.dll
A first chance exception of type 'System.Web.HttpException' occurred in System.Web.Mvc.dll
A first chance exception of type 'System.NullReferenceException' occurred in WebDev.WebHost40.dll 
```

（ETC）

更改我的调试设置我发现我得到的异常是

> “发送 HTTP 标头后，服务器无法设置内容类型。”

我通过谷歌搜索并尝试了许多解决方案，但到目前为止没有任何效果。据我所知，这是唯一一次使用 Response - 除非发生了一些后台进程（如果是这样，我该如何更改？）。请注意，我使用的是 Asp.NET MVC。

有任何想法吗？

编辑：这是一些上下文，可能有助于解决问题：

代码在通过 Ajax 调用的 Webmethod 中，原因是我需要通过客户端调用服务器端（不好的做法，但在提供的时间内需要它）并且我还需要传递一个参数.

这是ajax调用：

```
$("#Button").each(function() { 
                this.submitting = false; //To prevent double-clicking problems
            }).on("click", function (e) {
                if (e.preventDefault) e.preventDefault();
                $.ajaxSetup({ cache: false });
                e.preventDefault();
                 if (!this.submitting) 
                { 
                    this.submitting = true; 
                    var self = this; 
                    $.ajax({
                        url: 'Controller/retrieveFile',
                        type: 'POST',
                        data: { SystemNumber: $("#Button").val() },
                        dataType: 'json',
                        success: function (data) {
                            self.submitting = false; 
                        },
                        error:  function() { 
                            self.submitting = false; 
                        } 
                    });
                }
            }); 
```

这可能是返回值的问题吗？目前我正在返回

```
Json(true, JsonRequestBehavior.AllowGet); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T12:18:54.933

尝试使用 HttpContext.Response.AppendHeader("Content-disposition", ....) 并摆脱 Response.ClearHeaders(); 和 Response.Clear(); 线。

此外，您应该考虑使用 FileContentResult 作为方法的返回类型。

# php - 停止浏览器后脚本仍然运行

> ID：11925937
> 
> 赞同：-2
> 
> 时间：2012-08-12T21:13:44.553
> 
> 标签：php, linux

我制作了一个获取脚本来从网页中获取数据。它将一些数据保存到 mysql 数据库中。当我点击停止或关闭浏览器时，我通过 phpmyadmin 看到它仍然将记录添加到无穷大。

我多次终止了该过程，但我无法弄清楚修复它有什么问题。

是脚本的错还是服务器的错？

编辑：我关闭浏览器我关闭我的电脑，脚本仍然在服务器上运行。它不是代码或脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:19:16.267

尝试设置[ignore_user_abort](http://www.php.net/manual/en/function.ignore-user-abort.php)

```
ignore_user_abort(true); 
```

# visual-studio - 在 Visual Studio 中为 Pocket PC 开发时，如何更改 Windows 窗体窗口的外观？

> ID：11925938
> 
> 赞同：0
> 
> 时间：2012-08-12T21:13:45.580
> 
> 标签：visual-studio, pocketpc

我正在为 Visual Studio 2003 中的 Pocket PC 进行开发。当我创建 Windows 窗体时，它具有经典 XP 框架的外观，右上角带有“X”和下划线。如何使用右上角的“确定”按钮更改 Pocket PC 窗口的外观？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T13:41:01.033

没有截图很难理解你在说什么，但我认为你想要 ControlBox 属性。

Visual Studio 2008 属性如下所示，因为我无法再访问 VS2003。

![截屏](../Images/f8250b36b0595c9a0d674c8b4e0a914c.png)

# xcode - libKal.a 依赖于自身

> ID：11925939
> 
> 赞同：0
> 
> 时间：2012-08-12T21:14:03.760
> 
> 标签：xcode, static-libraries

我试图让[Kal](https://github.com/klazuka/Kal)在 Xcode 4.3.2 中工作，在遵循我在 stackoverflow 上找到的大部分内容之后，我收到以下错误：

```
File /Users/arigold/Library/Developer/Xcode/DerivedData/MLTM-dypybtiwtxqyjmbbqsvdtrbnjckz/Build/Products/Debug-iphonesimulator/libKal.a depends on itself.  This target might include its own product. 
```

我敢肯定，一旦我掌握了整个链接静态库的工作原理，这将很容易..

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T21:43:39.673

弄清楚了。我从 Kal.xcodeproj 的 Build Phases 部分的“Link Binaries with Libraries”中删除了 libKal.a。脚步：

1.  单击 Project Navigator 中的 Kal.xcodeproj（最左侧的列）
2.  单击目标下的“Kal”（右侧一列）
3.  单击“构建阶段”选项卡（宽中心列）
4.  在“Link Binaries with Libraries”部分下删除 libKal.a

有道理 - 它不能很好地链接到（依赖于）自身，现在可以了。

# google-analytics - Google Analytics 唯一身份访问者数量下降

> ID：11925944
> 
> 赞同：0
> 
> 时间：2012-08-12T21:15:49.717
> 
> 标签：google-analytics

我定期检查我的谷歌分析，以清楚地看到我的每日点击量，出于某种原因，我的 UNIQUE VISITORS 数量在一天内从 1770 下降到 1730。这怎么可能？

大约一周前，当我看到我的 UNIQUE VISITORS 计数没有超过 1800 时，我开始注意到这一点（考虑到我收到的访问量，它应该有）。我平均每天收到大约 60 次独立访问，但即使每天只有 0 次独立访问，我的整体 UNIQUE VISITORS 数量会下降听起来也不合逻辑。

现在我不能再认真对待 GA ... 以前有人遇到过这个问题和/或可以对此事有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T18:37:41.960

统计数据是基于时期的。当一天过去时，期间（开始和结束）也会提前一天。因此，您的总唯一访问次数从一天到另一天变化是完全正常的，因为时间段也发生了变化。

例如：假设您的网站每天接收 60 位唯一身份访问者。您今天（2012 年 8 月 13 日）检查了您的分析，并看到 1860 次访问。这就是从 13-07 到 12-08 期间的唯一身份访问者总数。

但是，假设您的网站今天只接待了 10 位访问者。明天（14 月 8 日）您将看到您的唯一身份访问者总数从 1860 年下降到 1810 年，因为这段时间将从 14 月 7 日到 13 月 8 日。

# android - 在 Google Play 上查询应用程序当前版本的更快方法？

> ID：11925945
> 
> 赞同：3
> 
> 时间：2012-08-12T21:15:54.507
> 
> 标签：android, google-play, in-app-billing, android-lvl

我希望能够在应用程序启动时将运行版本与当前在 Google Play 上的同一应用程序版本进行比较。

我找到了一个很好的方法，[在这里](https://stackoverflow.com/a/3835731/1124861)描述：

```
public String getLatestVersionNumber() {
    String versionNumber = "0.0.0";

    try  {
        Document doc = Jsoup.connect("http://www.appbrain.com/app/wallpaper-switch/com.mlevit.wallpaperswitch").get();
        Elements changeLog = doc.select("div.clDesc");

        for (Element div : changeLog) {
            String divText = div.text();

            if (divText.contains("Version")) {
                return divText.split(" ")[1];
            }

        }
    }
    catch (IOException e)  {
        e.printStackTrace();
    }

    return versionNumber;
} 
```

但这太慢了，并且严重影响了用户在应用程序启动时的体验。

有没有***更快***的方法在 Google Play 上查询应用程序的当前版本？

也许是一些隐藏的 LVL 或应用内计费 API？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:58:33.003

> 您确定没有任何 API 可以更快地提供 Google Play 版本吗？

好吧，根据定义，网络访问速度很慢。即使 Google Play 有文档化、受支持和许可的 API（在撰写本文时还没有），它也只会比您正在做的事情快一点。

> 您可以通过 AsyncTask 发表您的建议吗？

步骤#1：创建一个文件。

步骤#2：在该文件中，输入您的版本号，可选地连同以某种格式（例如，JSON）的其他数据（例如，更新描述）。

第 3 步：将该文件上传到某个知名的稳定 URL。

第 4 步：创建一个，将您的文件的*HTTP*`AsyncTask`请求放在`doInBackground()`一个中`AsyncTask`，并在同一个.*`onPostExecute()``AsyncTask`*

 *[这是一个示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/Internet/Weather)，演示`AsyncTask`执行 HTTP 操作（从美国国家气象局提取天气预报）并解析结果，`WebView`完成后更新 UI（填充 a ）。*

# php - 如何使用作曲家获取多个供应商目录？

> ID：11925946
> 
> 赞同：3
> 
> 时间：2012-08-12T21:16:23.000
> 
> 标签：php, javascript, composer-php

我的项目依赖于 ZF 和一个 JS 库。我希望能够将 ZF 库部署到正常位置（vendor/zendframework/zendframework1），然后将我的 JS 库部署到其他地方（public/my-vendor/my-library）。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-13T09:14:39.027

Composer 旨在管理您的 PHP 依赖项，而不是 JS。

此外，它仅支持一个供应商文件夹。

您可能会遵循 Symfony 捆绑包的使用方式：

*   在供应商中安装所有内容
*   作为部署过程的一部分，将公共资产链接（或复制）到公共目录

在我看来，它比在公共文件夹中安装一些东西更安全（只要你只复制/链接库的公共部分）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-13T15:44:28.910

我遇到了符号链接的想法，但我想自动化这个而不是手动创建符号链接。我打算创建一个作曲家脚本来创建符号链接。然后我发现 Windows 和 *nix 上的符号链接需要以不同的方式创建，这使得这个解决方案变得更加混乱。我发现在作曲家文档中，他们在自定义安装程序页面上讨论了同样类型的问题，并说要解决这个问题以创建您自己的自定义安装程序。

*   [相关文档部分： http](http://getcomposer.org/doc/articles/custom-installers.md) ://getcomposer.org/doc/articles/custom-installers.md
*   我的自定义安装程序：[https ://github.com/ddelrio1986/zf1-public-asset-installer](https://github.com/ddelrio1986/zf1-public-asset-installer)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-06T20:49:18.213

我已经实现了这个作曲家插件来将包安装到用户（自定义）定义的文件夹中，你可以将它包含在你的 composer.json 中，按照示例并告诉我你是否有更多问题 :)

[https://github.com/mnsami/composer-custom-directory-installer](https://github.com/mnsami/composer-custom-directory-installer)

# 作曲家自定义目录安装程序

一个作曲家插件，用于在文件夹中默认作曲家默认安装路径之外的自定义目录中安装不同类型的作曲家包`vendor`。

这不是另一个`composer-installer`支持非作曲家包类型的库，即`application`..等。这只是为了增加在供应商文件夹之外安装作曲家包的灵活性。这个包只支持`composer`包类型，

[https://getcomposer.org/doc/04-schema.md#type](https://getcomposer.org/doc/04-schema.md#type)

> 包的类型。它默认为库。
> 
> 包类型用于自定义安装逻辑。如果你有一个包需要一些特殊的逻辑，你可以定义一个自定义类型。这可能是一个 symfony-bundle、一个 wordpress-plugin 或一个typo3-module。这些类型都特定于某些项目，它们需要提供能够安装该类型包的安装程序。

## 如何使用

*   将作曲家插件包含到您的`composer.json` `require`部分中::

```
"require":{
    "php": ">=5.3",
    "mnsami/composer-custom-directory-installer": "1.1.*",
    "monolog/monolog": "*"
  } 
```

*   在该`extra`部分中定义要安装的包的自定义目录::

```
 "extra":{
    "installer-paths":{
      "./monolog/": ["monolog/monolog"]
    } 
```

通过添加该`installer-paths`部分，您告诉作曲家将`monolog`软件包安装`monolog`在根目录的文件夹中。

*   作为一项新增功能，我们在定义您的下载目录时增加了更多的灵活性，例如`composer/installers`，换句话说，您可以在您的部分中使用`{$vendor}`和之类的变量：`{$name}``installer-path`

```
"extra": {
    "installer-paths": {
        "./customlibs/{$vendor}/db/{$name}": ["doctrine/orm"]
    }
} 
```

以上将设法将`doctrine/orm`包安装在项目的根文件夹中，在`customlibs`.

## 笔记

`type: project`此安装程序不支持Composer ，因为具有类型的包`project`仅适用于与应用程序外壳（如`symfony/framework-standard-edition`）一起使用，其他包需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-12T09:27:26.770

默认情况下，Composer 读取`composer.json`模式。但是，它也可以使用不同的文件。例如，您可以拥有`zendframework.json`和`my-library.json`。

在 中`zendframework.json`，您可以定义：

```
 "config": {
    "vendor-dir": "zendframework/vendor"
  }, 
```

在 中`my-library.json`，您可以定义：

```
 "config": {
    "vendor-dir": "my-library/vendor"
  }, 
```

最后，您可以通过这种方式更新库：

```
COMPOSER=zendframework.json composer update
COMPOSER=my-library.json composer update 
```

这是一个简单的想法。好处是您无需第三方工具即可解决问题。

# python - 在python中制作文件，“当前正在使用”

> ID：11925947
> 
> 赞同：1
> 
> 时间：2012-08-12T21:16:26.857
> 
> 标签：python, windows, linux, macos

> **可能重复：**
> [在 Python 中打开文件以进行独占访问的最佳方法是什么？](https://stackoverflow.com/questions/186202/what-is-the-best-way-to-open-a-file-for-exclusive-access-in-python)

我正在创建一个绘画程序。当用户加载图像时，我希望该文件受到“保护”，因此用户无法删除它、重命名等......并且出现消息“文件当前正在被另一个进程使用”。

有没有办法在python中做到这一点？

编辑：

我希望它可以在 Linux、Mac 和 Windows 上运行

# c# - 私有抽象方法的一些问题

> ID：11925948
> 
> 赞同：17
> 
> 时间：2012-08-12T21:16:28.027
> 
> 标签：c#, .net, abstract-class

假设我开设了一个主要课程`Car`- 我希望这个课程是抽象的。抽象因为这是我的主要课程，没有人应该做这个课程的对象。这个类应该只作为“骨干”存在。

我希望只能从`Car`（比如说梅赛德斯、法拉利......）的子类创建类。因为每辆车都应该有像`StartEngine`我把它放到专业课上的方法。假设我有这个：

```
abstract class Car
{
  public string Name { get; set; }

  public abstract void StartEngine();
  private abstract bool CheckGasoline();
  //and so on...
}

class Mercedes : Car
{
  private override bool CheckGasoline()
  {
  //somehow check gasoline and return whatever...
  }

  public override void StartEngine()
  {
    if (CheckGasoline())
      //start engine...
  }
} 
```

好吧，这行不通。由于私人摘要：

```
virtual or abstract members cannot be private 
```

所以生病使每个私有方法都受到保护：

```
abstract class Car
{
  public string Name { get; set; }

  public abstract void StartEngine();
  protected abstract bool CheckGasoline();
  //and so on...
}

class Mercedes : Car
{
  protected override bool CheckGasoline()
  {
  //somehow check gasoline and return whatever...
  }

  public override void StartEngine()
  {
    if (CheckGasoline())
      //start engine...
  }
} 
```

这可以吗？我的意思是它正在工作，但它应该是这样吗？当我只需要同一个类中的方法时使用protected（比如这里：`CheckGasoline()`只需要`StartEngine()`）。不知何故，私人会更好看。

有什么建议么？谢谢你。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-12T21:20:31.393

是的，这很好。子类型**不能看到**私有方法，因此不能`override`：它们*必须*是`protected`（或公共等）。c# 中没有“方法 X 的私有”之类的东西，所以它必须按原样满足。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-12T21:20:29.727

除了它们所在的类之外，任何类都无法访问[私有方法——这包括派生类。](http://msdn.microsoft.com/en-us/library/st6sy9xe%28v=vs.80%29.aspx)

另一方面，[受保护的方法可以被它们所在的类和它们的派生类访问。](http://msdn.microsoft.com/en-us/library/bcd5672a%28v=vs.80%29.aspx)

您对受保护的用法是正确的。

您可能会发现这篇文章会有所帮助： http: [//msdn.microsoft.com/en-us/library/ba0a1yw2](http://msdn.microsoft.com/en-us/library/ba0a1yw2(v=vs.80).aspx) (v=vs.80).aspx 。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-12T22:10:04.937

您可以构建覆盖挂钩。Microsoft 使用`FrameworkElement.ArrangeCore(...)`(which uses `ArrangeOverride`) 和`FrameworkElement.MeasureCore(...)`(which uses `MeasureOverride`) 来做到这一点。

例如：

```
abstract class Car
{
  public string Name { get; set; }

  public void StartEngine()
  {
    if (CheckGasoline())
        StartEngineOverride();
  }

  protected abstract void StartEngineOverride();
  protected abstract bool CheckGasoline();

  // ...
}

class Mercedes : Car
{
  protected override bool CheckGasoline()
  {
     //somehow check gasoline and return whatever...
  }

  protected override void StartEngineOverride()
  {
     // CheckGasoline was already checked, so just do the override portion.
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-13T00:40:13.417

我推荐以下内容：

尝试`protected`在抽象类中使用您的成员变量声明。然后`public`也用于您的抽象方法。

接下来，在您的派生类中，您应该对派生类中的方法使用 public 和 override。但是，这是您拥有的另一种选择，即您也可以使用 virtual。因此，不要使用单个抽象类，而是将所有潜在的`Car`类型类嵌套在一个公共`CarClass`类中，或者任何你想调用的类中。

将虚拟方法用于第一个声明的类中的共享方法，该类是一个`Abstract Car`类。然后对声明的派生类的其余部分使用公共覆盖，这些派生类也嵌套在`CarClass`可以覆盖您在 asbstract`Car`类中声明的虚拟方法的类中。这是您拥有的另一个选项，尽管它可能会将您限制为仅在 中声明的任何内容，而`CarClass`不是一个不同且单独的抽象类。

# php - 使用 str_replace 删除 exec() 的空格

> ID：11925949
> 
> 赞同：1
> 
> 时间：2012-08-12T21:16:33.663
> 
> 标签：php

我`str_replace()`在尝试在 PHP 中创建 shell 命令时遇到了函数问题。在 shell 中，当我使用制表符完成包含空格的行时，它会像这样出现：

```
tar cvfz destination/filename.zip source/Name\ Of\ The\+\ Folder 
```

所以对我来说，这表示为了通过 运行这个命令`exec()`，我需要替换 PHP 中字符串中的所有空格。为了解决这个问题，我正在使用

```
$q = str_replace(' ', '\ ' , $q); 
```

在我的字符串解析开始时，为了将空格格式化为“\”而不是“”。我遇到的问题是，对于这个特定的文件夹，它也删除了加号，它的格式如下：

```
tar cvfz destination/Name\ Of\ The\ \ \ Folder.tgz source/Name\ Of\ The\ \ \ Folder 
```

我怎样才能设置它所以`str_replace()`不删除加号？从我到目前为止的有限测试中，它并没有从中删除任何内容：`-, %, @, !, (, *, ), ^, =`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T21:17:56.753

为此使用字符串函数是**非常错误**的，并且可能会留下很大的**安全漏洞**。

PHP 有一个函数[`escapeshellarg()`](http://php.net/escapeshellarg)，它可以完全满足您的需求：

> `escapeshellarg()`在字符串周围添加单引号并引用/转义任何现有的单引号，从而允许您将字符串直接传递给 shell 函数并将其视为单个安全参数。此函数应用于将来自用户输入的单个参数转义到 shell 函数。

# spring - 自定义弹簧属性源不解析 @Value 中的占位符

> ID：11925952
> 
> 赞同：6
> 
> 时间：2012-08-12T21:17:14.103
> 
> 标签：spring, properties, apache-zookeeper

我正在尝试构建一个 Spring 3.1 PropertySource，它从 Zookeeper 节点读取其值。为了连接到 Zookeeper，我使用的是 Netflix 的[Curator](https://github.com/netflix/curator)。

为此，我构建了一个自定义属性源，它从 Zookeeper 读取属性的值并返回它。当我像这样解决属性时，这很好用

```
ZookeeperPropertySource zkPropertySource = new ZookeeperPropertySource(zkClient);
ctx.getEnvironment().getPropertySources().addLast(zkPropertySource);
ctx.getEnvironment().getProperty("foo"); // returns 'from zookeeper' 
```

但是，当我尝试实例化具有带有 @Value 注释的字段的 bean 时，这将失败：

```
@Component
public class MyBean {
    @Value("${foo}") public String foo;
}

MyBean b = ctx.getBean(MyBean.class); // fails with BeanCreationException 
```

这个问题很可能与 Zookeeper 无关，但与我注册属性源和创建 bean 的方式有关。

任何见解都受到高度赞赏。

**更新1：**

我正在从这样的 XML 文件创建应用程序上下文：

```
public class Main {
    public static void main(String[] args) throws Exception {
        ConfigurableApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");
        ctx.registerShutdownHook();
    }
} 
```

连接到 Zookeeper 的类是 @Component。

```
@Component
public class Server {
    CuratorFramework zkClient;

    public void connectToZookeeper() {
        zkClient = ... (curator magic) ...
    }

    public void registerPropertySource() {
        ZookeeperPropertySource zkPropertySource = new ZookeeperPropertySource(zkClient);
        ctx.getEnvironment().getPropertySources().addLast(zkPropertySource);
        ctx.getEnvironment().getProperty("foo"); // returns 'from zookeeper'
    }

    @PostConstruct
    public void start() {
        connectToZookeeper();
        registerPropertySource();
        MyBean b = ctx.getBean(MyBean.class);
    }
} 
```

**更新 2**

这似乎在我使用无 XML 配置时起作用，即 @Configuration、@ComponentScan 和 @PropertySource 与 AnnotationConfigApplicationContext 结合使用。为什么它不能与 ClassPathXmlApplicationContext 一起使用？

```
@Configuration
@ComponentScan("com.goleft")
@PropertySource({"classpath:config.properties","classpath:version.properties"})
public class AppConfig {
    @Bean
    public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T22:10:11.377

**回答您的更新 2：**这不适用于您的原始配置（使用 注册 PropertySource `@PostConstruct`），因为 PropertySource 注册的时间很晚，此时您的目标 bean 已经构建并初始化。

通常，占位符的注入是通过[BeanFactoryPostProcessor](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/config/BeanFactoryPostProcessor.html)进行的，它在 Spring 生命周期的早期（在此阶段尚未创建 bean），如果在该阶段注册了 PropertySource，则应解析占位符。

最好的方法是使用[ApplicationContextInitializer](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/context/ApplicationContextInitializer.html)，获取 applicationContext 的句柄并在那里注册 propertySource ：

```
public class CustomInitializer implements ApplicationContextInitializer<ConfigurableWebApplicationContext> {
    public void initialize(ConfigurableWebApplicationContext ctx) {
        ZookeeperPropertySource zkPropertySource = new ZookeeperPropertySource(zkClient);
        ctx.getEnvironment().getPropertySources().addFirst(zkPropertySource);
    }
} 
```

# jquery - jQuery：在 jQuery hide() 完成后进行更改

> ID：11925955
> 
> 赞同：0
> 
> 时间：2012-08-12T21:17:33.087
> 
> 标签：jquery, html, hide, document-ready

这是问题所在：[jsFiddle](http://jsfiddle.net/DDeqU/)

我想要的是黄色高度仅在向下滑动后才从 60px 更改为 20px **（**单击时滑动）。怎么修？

```
 $(document).ready(function ()
   {
     $('#slide-link').click(function(){
       $(this).animate({ top: $(window).height()-40 },5000)
       $('#sliderWrapper').stop().hide("slide", { direction:"down" }, 5000); 
       $('#slide-link').height(20)
      //I want 20px to become after #sliderWrapper slided down, not on click
      //That's why I put $('#slide-link').height(20) as the last line
      // But it triggers asap. How to fix?
    })
})​ 
```

据我所知，`$('#slide-link').height(20)`不要等到`$('#sliderWrapper').stop().hide("slide", { direction:"down" }, 5000);` 完成。

PS`$('#slide-link').delay(5000).height(20)`也无济于事。为什么？怎么修？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T21:21:05.143

`.delay()`仅影响使用动画队列的函数。但是，`.height()`根本与动画无关，因此不使用该队列。

您想要的是`.hide()`动画完成后触发的回调：

```
$('#sliderWrapper').stop().hide("slide", {
    direction: "down"
}, 5000, function() {
    $('#slide-link').height(20)
}); 
```

演示：http: [//jsfiddle.net/ThiefMaster/DDeqU/3/](http://jsfiddle.net/ThiefMaster/DDeqU/3/)

# php - 基于数组格式下载 MySQL 数据？

> ID：11925958
> 
> 赞同：0
> 
> 时间：2012-08-12T21:17:50.403
> 
> 标签：php, mysql

我已经设置了一个 MySQL 数据库来获取课程的日期和时间，例如：

```
 class  |      class1      |      class2      |       class3       |
--------------------------------------------------------------------
physics | Tue@1@Mr. Foobar | Thu@4@Ms. Barfoo | Fri@1@Mr. Bobsmith |
math    | Mon@4@Ms. Foobar | Tue@3@Ms. Barfoo | Fri@2@Mr. Lala     |
cs      | Tue@2@Mr. Foobar | Fri@4@Ms. Barfoo |                    | 
```

基本上，它是数据库中的数组格式值，我计划在需要时使用explode()，但我没有意识到我必须进行更细粒度的搜索。

数组格式为`Day@Period@Teacher`

例如，如果今天是星期二，你会如何建议我按顺序排列星期二的所有课程，例如：

```
Today's Classes
1\. Physics
2\. CS
3\. Math 
```

还是我应该放弃并分开`class1`进入`class1day`, `class1period`, `class1teacher`?

我最好的想法是这样的：

```
$date = $date("l");
mysql_query("
SELECT * 
FROM classes 
WHERE class1 OR class2 OR class3
LIKE '$date%' ORDER BY //(I have no clue what to order by)
"); 
```

干杯，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:31:34.147

这可以使用以下查询来完成。

```
SELECT class 
FROM   table tbl1 
WHERE  Substring(class1, 1, 3) = 'Tue' 
        OR Substring(class2, 1, 3) = 'Tue' 
        OR Substring(class3, 1, 3) = 'Tue' 
```

但是你应该规范你的数据库。这将使搜索和减少数据冗余变得更容易。

# c++ - 在编译器中禁用默认数字类型

> ID：11925961
> 
> 赞同：0
> 
> 时间：2012-08-12T21:18:26.873
> 
> 标签：c++

在为整数创建自定义 typedef 时，编译器是否可以在您使用默认数字类型时发出警告？

例如，

```
typedef int_fast32_t    kint;

int_fast32_t test=0;//Would be ok
kint test=0; //Would be ok
int test=0; //Would throw a warning or error 
```

我们正在转换一个大型项目，`int`平台上的默认大小`32767`导致了一些问题。此警告将警告用户不要在代码中使用整数。

如果可能的话，如果这适用于 GCC 和 VC++2012，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:25:18.060

我有理由确定 gcc 没有这样的选择，如果 VC 有，我会感到惊讶。

我建议编写一个程序来检测源代码中对预定义类型的引用，并在构建过程中自动调用该工具。搜索某些关键字可能就足够了。

确保将其限制为您自己的源文件；预定义和第三方标头可能会广泛使用预定义类型。

但我不会绝对禁止。有许多使用预定义类型的标准库函数。例如， in`c = getchar()`声明`c`为`int`. 像这样的东西没有问题`for (int i = 0; i <= 100; i ++) ...`

Ideally, the goal should be to use predefined types *properly*. The language has never guaranteed that an `int` can exceed 32767\. (But "proper" use is difficult or impossible to verify automatically.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T21:23:14.637

我会先做一个全部替换然后彻底记录这个来解决这个问题。

您可以使用预处理器指令：

```
#define int use kint instead 
```

**请注意，从技术上讲，这是未定义的行为，如果在包含第三方标头之前进行此定义，您将遇到麻烦。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T21:27:41.980

I would recommend to make bulk replacement `int` -> `old_int_t` at the very beginning of your porting. This way you can continue modifying your code without facing major restrictions and at the same time have access to all places that are not yet updated.

Eventually, at the end of your work, all occurencies of `old_int_t` should go away.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-15T23:44:07.313

即使可以以某种方式取消定义关键字`int`，也不会阻止使用该类型，因为在许多情况下编译器最终会使用该类型。除了整数文字的明显情况之外，还有一些涉及整数提升的更微妙的情况。例如，如果`int`恰好是 64 位，则两个类型变量之间的操作`uint32_t`将使用 type`int`而不是`uint32_t`. 能够指定一些变量表示*数字*（在实际情况下应积极提升）而其他变量表示环绕*代数环*的成员（不应提升），这将是一件好事，但我不知道这样做的便利一个东西。因此，`int`不可避免。

# javascript - 修改外部 CSS 值

> ID：11925965
> 
> 赞同：1
> 
> 时间：2012-08-12T21:19:15.643
> 
> 标签：javascript, html, css

嗨，我正在尝试使用 JavaScript 动态更改分区的高度，但如果它使用 HTML 标记内的样式标签定义，我只能让 JS 读取 div 的 Height 元素。

如果它在单独的工作表中返回 NaN，我假设是因为它找不到值并且实际上返回 null（我正在使用 ParseInt 使其工作）。

这是HTML：

```
<div id="dropdown_container">
    <div id="dropdown" style="height:100px;">
    a
    </div>
</div> 
```

（希望 HTML 样式标记）

这是JS：

```
function clickDown() {
    var el = document.getElementById('dropdown');
    var maxHeight = 200;
    getHeight = parseInt(el.style.height.substring(0,(el.style.height.length)-2));
    console.log(getHeight);
    getHeight += 2;
    el.style.height = getHeight + 'px';
    timeoutHeightInc = setTimeout('clickDown()',15);
    if(getHeight >= maxHeight){
        clearTimeout(timeoutHeightInc);

    }
} 
```

有谁知道这个（错误？）功能的原因。以及解决方案？

这是一个[jsFiddle](http://jsfiddle.net/N4PCf/2/)。

尝试将高度移至 CSS 以查看我遇到的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T21:23:03.443

ParseInt 缺少它的基数。

你说：

> 如果它使用 HTML 标记内的样式标签定义，我只能让 JS 读取 div 的 Height 元素

现在您只是在阅读 div 的属性样式。你设置的内联。因此，如果您删除它，那么您将无法再阅读它。有道理？

您想获得计算出的高度。尝试：`.offsetHeight`

与 inc 一起玩的测试用例的基础。固定基数。[这个小提琴](http://jsfiddle.net/c3VYc/)

更新：tada：已修复，请参阅[此更新的小提琴](http://jsfiddle.net/c3VYc/1/)

```
function clickDown() {
    var el = document.getElementById('dropdown');
    var maxHeight = 200;
    getHeight = parseInt(el.offsetHeight,10);
    console.log(getHeight);
    getHeight += 2;
    el.style.height = getHeight + 'px';
    timeoutHeightInc = setTimeout('clickDown()',15);
    if(getHeight >= maxHeight){
        clearTimeout(timeoutHeightInc);

    }
} 
```

# ruby-on-rails - 如何在不使用资产管道的情况下在 Rails 中制作公共资产？

> ID：11925967
> 
> 赞同：0
> 
> 时间：2012-08-12T21:19:29.293
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, asset-pipeline

我想绕过资产管道，因为一个非常非常愚蠢的处理错误完全阻止了我的应用程序工作。

例如，我想替换这个：

```
<%= javascript_include_tag 'jquery' %> 
```

有类似的东西

```
<script type="text/javascript" src="public/javascripts/jquery.js"></script> 
```

我该怎么做呢？每当我尝试使用它时，即使我实际上将文件放在 public/javascripts 中，链接最终也会指向一个不存在的 .js 文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:29:36.187

删除公共，正确的路径是 /javascripts/jquery.js。

# java - 通过提供 InputStream getter 对 InputStream 进行延迟访问

> ID：11925971
> 
> 赞同：0
> 
> 时间：2012-08-12T21:19:58.650
> 
> 标签：java, io, inputstream

我正在实现的 API 处理包含分层结构化数据的 InputStreams，即嵌套块，包括叶块中的许多图像。（如果你必须知道，我正在解析的是[CBEFF](http://en.wikipedia.org/wiki/CBEFF)数据。）每个数据块都以包含有关该块的一些元数据的标题作为前缀。

```
1st level 1 header
    1st level 2 header
    1st level 2 data block
    2nd level 2 header
    2nd level 2 data block
2nd level 1 header
    3rd level 2 header
    3rd level 2 data block 
```

原始的 InputStream 是我的 API 类的构造函数的参数，并沿层次结构向下传递。目前，我正在 API 类的构造函数中将图像读入字节数组，因此每个构造函数在读取该类负责的完整数据时阻塞，稍后当客户端调用该 API 类的相关 getter 方法时，他们将获得从内存提供的图像数据。我宁愿以某种惰性 InputStreams 的形式向我的 API 的客户端提供包含的图像，这样图像字节只能从原始 InputStream 中读取，因为客户端读取了由吸气剂。例如，这使得进行渐进式渲染成为可能，这很有用，因为原始 InputStream 很慢。

有没有一种优雅的方法可以用 InputStreams 解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T09:17:44.173

`InputStream`不适合随机访问。因此，在大多数情况下，读取其中的部分内容是行不通的，即使您可以使用和的组合对*某些*输入流实现类似的效果。但并非所有流都支持，并且跳过字节通常与读取字节一样昂贵。[`reset`](http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html#reset%28%29)[`skip`](http://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html#skip%28long%29)`reset`

所以我建议你尝试一些替代方法。要么将整个流缓冲到某个随机访问缓冲区，例如临时文件，这仍然意味着首先从流中读取所有字节。或者您找到一种随机访问原始来源的方法。您没有指定要处理的源类型，但例如对于 HTTP 连接，您可以使用[range request](https://www.rfc-editor.org/rfc/rfc2616#section-14.35)[下载部件](https://stackoverflow.com/q/5978052/1468366)。类似的解决方案可能适用于其他来源。

无论您如何实现随机访问（并且看到您的评论，您可能会使用`InputStream`with `reset`and来实现`skip`），您都可以创建自己的类来表示该流的一部分。`InputStream`您可以通过子类化让该类本身成为一个实例[`FilterInputStream`](http://docs.oracle.com/javase/7/docs/api/java/io/FilterInputStream.html)。

```
cLass SubStream extends FilterInputStream {
    private long offset;
    public SubStream(long offset, InputStream parent) {
        super(parent);
        this.offset = offset;
    }
    public SubStream(InputStream parent) {
        this(0, parent);
    }
    @Override public void reset() throws IOException {
        in.reset();
        in.skip(offset);
    }
    public SubStream subStream(long offset) {
        return new FilterInputStream(this.offset + offset, in);
    }
    public Object syncObject() {
        return in;
    }
} 
```

您必须确保`reset`首先调用这些流之一的任何操作。如果您需要强制执行适当的流结束处理，则必须覆盖大多数`read`实现。如果并发访问可能是可能的，那么您将需要同步底层流上的操作。所以使用这个类的代码可能看起来像这样：

```
 synchronized(part.syncObject()) {
         part.reset();
         return read(part);
     } 
```

# java - 会话是否存在

> ID：11925973
> 
> 赞同：7
> 
> 时间：2012-08-12T21:20:09.297
> 
> 标签：java, google-app-engine, jsp, session

我正在尝试编写我的第一个应用程序`Google App Engine`，我试图维护一个会话，我在提交时创建了一个登录页面，它调用一个`servlet`servlet 验证用户并使用以下代码创建一个新会话。

```
void createSession(String Username) {
        getThreadLocalRequest().getSession(true).setAttribute("Username", Username);
    } 
```

调用 servlet 后的登录页面重定向到某个页面，即`abc.jsp`我的`abc.jsp`页面包含

```
<body><%
        try {
            if (request.getSession(false) == null) {

            } else {
    %>
    Welcome to
    <%=session.getAttribute("Username")%>
    <%
        if (session.getAttribute("Username").equals("")) {
    %>
    <a href="login.jsp"><b>Login </b></a>
    <%
        } else {
    %>
    <a href="logout.jsp"><b>Logout</b></a>
    <%
        }
            }
        } catch (Exception e) {

        }
    %></body> 
```

它工作正常，但是当我在`abc.jsp` **不**创建会话的情况下访问时，它会在这一行抛出异常`if (session.getAttribute("Username").equals(""))`，我不知道为什么要帮助我。我认为它不会检测会话是否存在。但是我已经阅读了很多这样的线程它给了我[这个](https://stackoverflow.com/questions/2818251/how-to-check-if-session-exists-or-not)解决方案，我不知道我做错了什么。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-12T21:46:11.840

就目前我所记得的

```
session.getAttribute("xyz") 
```

`null`如果属性不存在则返回...所以您的 NullPointerException 发生是因为您尝试调用`equals`on `null`。

我建议在验证其内容之前检查您的属性本身：

```
if (session.getAttribute("Username") == null || session.getAttribute("Username").equals("")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T05:32:31.483

```
 <%  
     if (session.getAttribute("Username") != null) {  
         …
     }
  %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-02T18:36:39.973

它对我有用。尝试这个

```
String userName;
    userName = (String)session.getAttribute("uname");   
if (session.getAttribute("userName").equals("")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-14T17:28:38.267

在检查会话的属性之前，您必须查看会话本身。

所以，**首先**：

```
HttpSession session = request.getSession(false);
if(session != null){...} 
```

然后，**_**

```
if(session.getAttribute("xyz") != null){...} 
```

**更好的解决方案**可能**都在一行中**：

```
if(session != null && session.getAttribute("xyz") != null) 
```

> 如果该属性不存在，则返回 null ...因此您的 NullPointerException 发生是因为您尝试在 null 上调用 equals。

显然，**强烈建议**在验证其内容之前**检查您的属性**（如上）。

# ajax - MVC 3 post 模型和使用 Ajax 表单的 HttpPost 操作方法的附加参数

> ID：11925977
> 
> 赞同：1
> 
> 时间：2012-08-12T21:20:38.470
> 
> 标签：ajax, asp.net-mvc, razor, asp.net-ajax

使用 ASP.NET MVC 3 和 Razor，我有一个针对`MyViewModel`类的强类型视图。在视图中，我有一个由一组单选按钮组成的 AJAX 表单。在它下面，我有一个普通的 HTML 表单，用于收集`MyViewModel`. 根据在 AJAX 表单中选择了哪个单选按钮，我想用一组或另一组默认值更新 HTML 表单。在 AJAX 表单中，我尝试发布两条数据：1) 表示选择的选项的值（基于单选按钮`value`参数），以及 2)`Model`来自视图的值。我希望控制器操作根据收到的选项更新模型，然后返回带有更新的模型对象作为参数的局部视图。我该怎么做呢？这是我尝试的 AJAX 表单的代码：

```
@using (Ajax.BeginForm("MyAction", "MyController",
        new AjaxOptions {
            HttpMethod = "POST",
            InsertionMode = InsertionMode.Replace,
            UpdateTargetId = "createForm"
        })) 
{
    <div id="formOptions">
        @foreach (Option op in Model.GetOptions()) {
            <div class="editor-field">
            @Html.RadioButton("option", op.OptionType, false, new { @id = op.ID, @name = op.ID, @title = @op.Description, @onfocus = "javascript:$(this).closest('form').find(':submit').first().click()" })
            <label for="@op.ID">@op.Name</label>
            </div>
        }
    </div>
    @Html.Hidden("model", Model)
    <input type="submit" value="Select" style="display:none;" />
} 
```

我的问题是`model`HttPost 操作方法中的参数为空。但是，该`option`参数似乎正确传递。我不确定我是否以`Html.Hidden`不应该使用的方式使用输入或问题是什么。如果需要，我可以发布更多代码。

这是我第一次尝试做这样的事情，所以在阅读了很多（看似）类似的问题之后，我仍然无法破译我想做的解决方案。我看到了很多不同的东西，比如 JSON 编码、使用 JQuery 等等，但我不确定我是否需要这些东西，或者我是否可以使用 MVC 功能来完成这个（我宁愿不重新编码已经存在的东西）内置在 MVC 3) 中。如果有人能指出我正确的方向或可能给出一个小代码示例，将不胜感激。而且，考虑到我的最终目标是，如果有更好的方法来基于选项控件异步更新表单，我会非常有兴趣听到它。谢谢！

编辑：

我还注意到使用 HttpPost 的请求不会到达控制器，但 HttpGet 会。外面有人吗？这让我发疯！

添加控制器方法：

```
public PartialViewResult CreateForm(OptionType opType, MyViewModel model) {
    model.ApplyOptionValues(opType);
    return PartialView("_CreateForm", model);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T08:46:17.823

我同意 Mattbo 的观点：将整个模型围成一圈发布是不必要的开销。你没有说你为什么是，但我怀疑这是为了让你可以比较“旧”和“新”值。鉴于模型源自控制器，您可以在 ViewModel 中包含模型的唯一标识符（例如 GUID），将其放在隐藏字段中以包含在您的 POST 数据中，然后在返回 POST 时，您的“新”数据将是自动映射到强类型 ViewModel。然后，您可以重新获得原始模型，并对它们进行任何您需要的操作。

处理 AJAX 表单是一个单独的问题/表单：您的单选按钮填写（视图模型）表单中的默认值（包括一个隐藏字段以记录选择了哪个单选），用户填写其他数据并且整个（非 ajax）表单被发布到 MyController.MyAction 方法，并且默认绑定器将自动将表单值映射到 MyViewModel，如果它们遵循正确的命名约定。所以 AJAX 与实际发布的表单无关。或者，您可以按照 Mattbo 的建议使用 AJAX 完成所有操作。

[旁白] 如果您已经知道，请原谅我，但您可以使用 razor Html 助手来创建您的字段，例如：

```
@Html.EditorForModel()
@Html.EditorFor(model => model.[field name]) 
```

在控制器中，您将创建如下操作： public ActionResult MyAction() { MyViewModel }

```
[HttpPost]
public ActionResult MyAction(MyViewModel myModel) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T07:23:11.260

我不会将整个模型发布回您尝试使用的控制器，`@Html.Hidden("model", Model)` 只需将您需要的特定项目放在表单中，其名称/类型与您的控制器匹配。您可以使用所选单选按钮的值以及隐藏输入的值将识别信息传递给控制器​​并在那里执行您需要的任何逻辑。

话虽如此，我认为最好的解决方案是使用一些 JavaScript 框架，如 JQuery 来处理所有 AJAX 请求。Asp.net MVC 使得使用内置部件进行简单操作变得非常容易，但是一旦您需要执行更复杂的操作，它肯定会失败。与仅使用正确的工具 (JQuery) 相比，您最终会在限制范围内付出更多努力。

确保您注释您的 POST 操作方法`[HttpPost]` 以区别于 GET 方法。

还可以使用详细的 Web 调试器来准确检查发送到您的应用程序的内容。我喜欢 Fiddler，它非常受欢迎。 [http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

# ios - UITableView - 最后一个静态单元格消失，显示在上一节的顶部

> ID：11925978
> 
> 赞同：0
> 
> 时间：2012-08-12T21:20:48.963
> 
> 标签：ios, uitableview, uitextfield

我有一个基本`UITableView`的两部分静态单元格和`UITextFields`表单输入。视图需要滚动的字段足够多。我遇到的问题是，当我在设备上测试应用程序时，最后一个单元格从最后一部分的底部消失并重新出现在第一部分的底部。

无论如何，似乎有些东西对它应该渲染的部分感到困惑。这只发生在`UITableView`.

这在模拟器中不会发生。运行 iOS 6.0。

谁能告诉我为什么会发生这种情况以及如何解决？

这是屏幕截图的链接：

![](../Images/e5c247694bf392768ed06ba0db0c3a8b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T21:31:42.600

我的猜测是，在这个数据委托方法中：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

您不是同时查看部分和行，而只是查看行，或者当您去获取单元格时，逻辑不会同时考虑部分和行。

# ms-access - 什么是 DB.Properties(??) 变量？专门设置默认功能区

> ID：11925981
> 
> 赞同：1
> 
> 时间：2012-08-12T21:21:32.287
> 
> 标签：ms-access, vba

我有一个 Access 2007 应用程序，我正在更新它以便能够在 2007 和 2010 上运行。在 2007 年，我使用表单功能区属性，但在 2010 年，我需要创建一个关闭后台的默认功能区。我已经这样做了，但是当应用程序检测到它在 2010 年而不是 2007 年运行时，它也需要将其设置为默认值。加载自定义 UI 不起作用。它会加载它，但不会将功能区设置为默认值。我知道我可以使用 database.properties 函数设置默认启动表单和其他属性。但我需要知道应用程序默认功能区的属性名称。有谁知道房产名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T14:47:08.467

我认为您要查找的数据库属性的名称是：CustomRibbonId

这是一些将数据库属性列表输出到调试窗口的代码。

```
Private Sub EnumerateDatabaseProperties()
    On Error Resume Next
    Dim p1 As DAO.Property, s1 As String
    For Each p1 In CurrentDb.Properties
        s1 = p1.Name
        s1 = s1 & "=" & p1.value
        Debug.Print s1
    Next p1
End Sub 
```

请注意，如果数据库属性不存在，它可能不会出现在输出中，而不是仅仅出现在没有值的输出中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-02T16:55:34.473

首先，我们需要一种强大的方法来设置数据库属性。

```
Public Sub SetCurrentDBProperty(ByVal propertyName As String, ByVal newValue As Variant, Optional ByVal prpType As Long = dbText)
    Dim thisDBs As Database
    Set thisDBs = CurrentDb
    Dim wasFound As Boolean

    ' Look for property in collection
    Dim thisProperty As Object ' DAO.Property
    For Each thisProperty In thisDBs.Properties
        If thisProperty.Name = propertyName Then
            ' Check for matching type
            If thisProperty.Type <> prpType Then
                ' Remove so we can add it back in with the correct type.
                thisDBs.Properties.Delete propertyName
                Exit For
            End If

            wasFound = True

            ' Skip when no change is required
            If thisProperty.Value = newValue Then
                Exit For
            Else
                ' Update value
                thisProperty.Value = newValue
            End If
        End If
    Next thisProperty

    If Not wasFound Then
        ' Add new property
        Set thisProperty = thisDBs.CreateProperty(propertyName, prpType, newValue)
        thisDBs.Properties.Append thisProperty
    End If
End Sub 
```

然后给定一个示例功能区名称，`Runtime`您可以像这样调用属性设置器：

```
Public Sub SetRuntimeRibbon()
    SetCurrentDBProperty "CustomRibbonID", "Runtime"
End Sub 
```

# c++ - 编译器不报告代码错误

> ID：11925982
> 
> 赞同：2
> 
> 时间：2012-08-12T21:21:42.427
> 
> 标签：c++, visual-studio-2010

我在调用函数 '. 我花了很多时间来理解为什么编译器会忽略我的函数。为什么在编译时没有报告？编译器构建所有内容都没有错误，但没有带有“2”的消息框。

```
#include "stdafx.h"
#include <windows.h>

void tstB()
{
MessageBox(NULL, "2", NULL, NULL);
}

int _tmain(int argc, _TCHAR* argv[])
{
MessageBox(NULL, "1", NULL, NULL);
tstB;
return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-12T21:22:42.300

这不是错误，因为它是一个有效的表达式。表达式的结果是一个函数指针。你可以使用这样的表达式：

```
void (*p)() = tstB; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-12T21:22:54.937

`tstB;`使用as 表达式并没有什么不合法的地方，它是一个有效的语句。它类似于

```
int main() {
    int a;
    a;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-12T21:22:25.473

你需要这样称呼它：

```
tstB(); 
```

否则，您只有一个指向函数的指针，这不是错误。

使用合适的编译标志，GCC 产生`warning: statement has no effect [-Wunused-value]`

# objective-c - FBSession 的 Facebook iOS SDK 3.0 登录教程问题

> ID：11925987
> 
> 赞同：4
> 
> 时间：2012-08-12T21:22:59.027
> 
> 标签：objective-c, ios, xcode, facebook

我目前正在尝试组合一个应用程序 - 它的基础（希望）建立在 Facebook iOS SDK 3.0 教程上。

我正在关注的教程位于：http: [//developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/](http://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/)

我发现 Facebook 的各种 SDK 版本在最终版本中都有一些变化。

但是，在代码编译之前，我确实有最后一个问题：

“选择器‘sessionOpenWithPermissions:completionHandler:’没有已知的类方法”

此错误是指以下代码：

```
- (void)openSession
{
    [FBSession sessionOpenWithPermissions:nil completionHandler:
     ^(FBSession *session, FBSessionState state, NSError *error) {
         [self sessionStateChanged:session state:state error:error];
     }];    
} 
```

在 Xcode 中查看 FBSession.h 文件时，没有提及`sessionOpenWithPermissions`.

有人可以帮我解决这个问题吗？我是 Objective-C/Xcode 的新手，并且正在通过试验学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T21:52:07.993

我遇到了同样的问题，让我的代码使用以下更改。

```
//REPLACE
[FBSession sessionOpenWithPermissions:nil
                    completionHandler: ^(FBSession *session, FBSessionState state, NSError *error) {
                        [self sessionStateChanged:session state:state error:error];
                    }];

//WITH
[FBSession openActiveSessionWithPermissions:nil
                               allowLoginUI:YES
                          completionHandler:^(FBSession *session, FBSessionState state, NSError *error) {
                              [self sessionStateChanged:session state:state error:error];
                          }]; 
```

如果您 alt 单击该方法，您将获得有关要传递的参数的更多信息。 [openActiveSessionWithPermissions 选项](http://postimage.org/image/z88nkt7xd/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:18:45.023

看起来文档有一个错误。根据 API 更改日志，该类方法已被替换。

> FBSession 类方法 sessionOpenWithPermissions:completionHandler: 已被移除，改为使用新的 openActiveSessionWithPermissions:allowLoginUI:completionHandler: 类方法。

[API 更改日志 URL](https://developers.facebook.com/ios/change-log-3.x/)

# storyboard - 无法通过代码在 Metro 风格应用程序中将 Storyboard.TargetProperty 设置为 CompositeTransform.Rotation

> ID：11925991
> 
> 赞同：5
> 
> 时间：2012-08-12T21:23:33.220
> 
> 标签：storyboard, microsoft-metro, winrt-xaml, attached-properties

我在 Metro XAML 应用程序中弄乱了一些情节提要。我必须创建一个`Storyboard`代码。我想设置`Storyboard.TargetProperty`为`CompositeTransform.Rotation`

似乎不可能...

我在 XAML 中的情节提要如下所示：

```
<Storyboard>
    <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.Rotation)" Storyboard.TargetName="grid">
        <EasingDoubleKeyFrame KeyTime="0" Value="0"/>
        <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="60"/
    </DoubleAnimationUsingKeyFrames>
</Storyboard> 
```

我想创造类似的东西。
**重要提示：**我并不是要*重新创建*这个确切的故事板。我在 custom 的代码中`ContentControl`，所以`this`也是`Control`，并且没有将动画定位到的“网格”。目标是控件本身，它`CompositeTransform`之前已设置。

到目前为止，我的代码是这样的：

```
var turnSB = new Storyboard();

var doubleAnim = new DoubleAnimationUsingKeyFrames();
doubleAnim.KeyFrames.Add(new EasingDoubleKeyFrame() { KeyTime = TimeSpan.FromMilliseconds(0), Value = currentAngle });
doubleAnim.KeyFrames.Add(new EasingDoubleKeyFrame() { KeyTime = TimeSpan.FromMilliseconds(500), Value = targetAngle });

turnSB.Children.Add(doubleAnim);

Storyboard.SetTarget(doubleAnim, this.RenderTransform);
Storyboard.SetTargetProperty(doubleAnim, "(CompositeTransform.Rotation)");

turnSB.Begin(); 
```

一旦它到达 Begin 方法，我就会得到一个异常，说 (CompositeTransform.Rotation) 无法解决。所以我猜我没有完全正确的财产路径。我尝试了不同的变体，但根据 PropertyPaths，这应该是正确的，不是吗？:S

如果这是一个无法解决的问题，我愿意接受有关解决方法的建议......

**编辑：**

我想我现在已经解决了这个问题。不过，我有一些有趣的发现……

如果我制作一个 UserControl，我几乎可以做任何事情。一切正常，我可以设置 Storyboard.Target 属性，并且动画可以正确播放。

但是，如果我使用自定义控件，或者从另一个控件（比如 ContentControl）继承，我无法从代码中启动 Storyboard，只有在某些情况下。

例如：如果我制作了一个故事板（在 XAML 中定义）来动画旋转（或任何与此相关的转换属性）并尝试从代码开始，我会得到上述异常。但是如果我为一个简单的属性设置动画，比如不透明度，它就可以正常工作。
（我对 UserControl 做了同样的事情，并且它起作用了。）

有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T06:01:27.703

我认为您收到此错误的原因是您没有实例化`RenderTransform`自定义控件的属性。

```
public class CustomControl2 : Control
{
    public CustomControl2()
    {
        this.DefaultStyleKey = typeof(CustomControl2);
    }

    protected override void OnApplyTemplate()
    {
        base.OnApplyTemplate(); 
    }

    public void RunAnimation()
    {
        //this.RenderTransform = new CompositeTransform();
        this.Background = new SolidColorBrush(Color.FromArgb(0xFF, 0x33, 0xC8, 0x9C));

        var turnSB = new Storyboard();

        var doubleAnim = new DoubleAnimationUsingKeyFrames();
        doubleAnim.KeyFrames.Add(new EasingDoubleKeyFrame() { KeyTime = TimeSpan.FromMilliseconds(0), Value = 10 });
        doubleAnim.KeyFrames.Add(new EasingDoubleKeyFrame() { KeyTime = TimeSpan.FromMilliseconds(500), Value = 30 });

        turnSB.Children.Add(doubleAnim);

        Storyboard.SetTarget(doubleAnim, this.RenderTransform);
        Storyboard.SetTargetProperty(doubleAnim, "(CompositeTransform.Rotation)");

        turnSB.Begin();
    }
} 
```

请注意，在上面的代码中，如果我注释掉 method 下的第一行`RunAnimation`，它会抛出你得到的同样的错误。

然后我在我的主页中创建了这个控件，还创建了一个`Button`来启动动画。

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    this.MyControl.RunAnimation();
} 
```

我测试了上面的代码，它运行良好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T16:53:55.137

从[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.animation.storyboard.settargetproperty.aspx)看来，您需要设置整个字符串路径。因此，对于您的 xaml 中描述的动画，您需要将 TargetProperty 设置为

```
Storyboard.SetTargetProperty(doubleAnim, "(UIElement.RenderTransform).(CompositeTransform.Rotation)"); 
```

**更新**：发现这篇[博客文章](http://dotnetbyexample.blogspot.nl/2012/04/porting-dragflickbehavior-from-windows.html)将时间轴添加为情节提要的子项。尝试以下操作：

```
Storyboard.SetTarget(doubleAnim, this.RenderTransform);
Storyboard.SetTargetProperty(doubleAnim, "Rotation"); // maybe "CompositeTransform.Rotation"
storyboard.Children.Add(doubleAnim); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T13:57:27.157

解决了

问题出在您正在使用的元素的路径中，它必须从父类派生并扩展到属性本身。我让它在我自己的控制下工作，所以做了一个小例子，你可以复制粘贴（未经测试的代码）：

 `````
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;
using Windows.UI.Xaml.Media;
using Windows.UI.Xaml.Media.Animation;

namespace CustomControls
{
    /// <summary>
    /// Author: Frank Wolferink
    /// Note: example is untested and comes as is. I hope it save's you the time i lost figering this out
    /// </summary>
    public class CustomControl : Control
    {

        private Storyboard _compositeTransformExampleStoryBoard;

        private const string TRANSLATE_X_TARGET = "Control.RenderTransform.CompositeTransform.TranslateX";
        private const string TRANSLATE_Y_TARGET = "Control.RenderTransform.CompositeTransform.TranslateY";
        private const string TRANSLATE_ROTATE_TARGET = "Control.RenderTransform.CompositeTransform.Rotation";

        public CustomControl()
        {
            this.RenderTransform = new CompositeTransform();

            TimeSpan duration = new TimeSpan(0,0,0,0,500);
            double translateX = 10;
            double translateY = 10;
            double rotation = 40;

            _compositeTransformExampleStoryBoard = BuildStoryboard(duration, translateX, translateY, rotation);

            this.Loaded += CustomControl_Loaded;
        }

        void CustomControl_Loaded(object sender, RoutedEventArgs e)
        {
            _compositeTransformExampleStoryBoard.Begin();
        }

        private Storyboard BuildStoryboard(TimeSpan animationDuration, double transistionValueX, double transistionValueY, double rotation)
        {
            Storyboard storyboard = new Storyboard();

            if (transistionValueX != 0)
                CreateAnimation(storyboard, transistionValueX, animationDuration, TRANSLATE_X_TARGET);

            if (transistionValueY != 0)
                CreateAnimation(storyboard, transistionValueY, animationDuration, TRANSLATE_Y_TARGET);

            if (rotation != 0)
                CreateAnimation(storyboard, rotation, animationDuration, TRANSLATE_ROTATE_TARGET);

            return storyboard;
        }

        private void CreateAnimation(Storyboard storyboard, double transistionValue, TimeSpan animationDuration, string targetProperty)
        {
            DoubleAnimation da = CreateDoubleAnimation(transistionValue, animationDuration);
            storyboard.Children.Add(da);
            Storyboard.SetTarget(da, this);
            Storyboard.SetTargetProperty(da, targetProperty);
        }

        private DoubleAnimation CreateDoubleAnimation(double transistionValue, TimeSpan duration)
        {
            return new DoubleAnimation()
            {
                Duration = duration,
                To = transistionValue
            };
        }

    }
} 
`````

# c - 我应该使用 ANSI C (C89) 吗？

> ID：11925998
> 
> 赞同：20
> 
> 时间：2012-08-12T21:25:04.877
> 
> 标签：c, c99, c89, ansi-c

现在是 2012 年。我正在用 C 编写一些代码。我还应该使用 C89 吗？是否还有不支持 C99 的编译器？

我不介意使用`/* */`而不是`//`.

我不确定`C89 forbids mixing declarations and code`。我倾向于认为将所有声明放在一个地方实际上更具可读性，如果不是，则函数太长。

VLA 看起来很有用，但我还不需要它们。

如果没有令人信服的理由，我应该坚持使用 C89 吗？还有其他我没有考虑过的事情吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-12T21:26:25.623

除非您知道您不能使用与 C99 兼容的编译器（[Visual Studio C 编译器是最突出的候选](https://stackoverflow.com/q/146381/298479)者），否则没有充分的理由不使用 C99 为您提供的好东西。

但是，即使您需要支持该编译器，您也可以使用*一些*C99 功能——但不是全部。

C99 的一个非常方便的特性是能够这样做，`for(int i = ...)`而不必在函数顶部声明循环变量 - 特别是因为 C 实际上具有块作用域。这是一种声明，将它放在最上面确实不会提高可读性。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-12T21:32:24.997

C89 被 C99 取代是有原因的（或许多原因）。如果您确定没有 C99 编译器可用于您的特定工作（除非您坚持使用从未正式支持 C 的 Visual Studio），那么您需要继续使用 C89，否则您当然应该将自己置于您可以从过去 20 多年的改进中受益的位置。C99 本身并没有什么慢的。

也许您甚至应该考虑查看最新的 C11 标准。处理 Unicode 有一些重要的修复，任何 C 程序员都可以从中受益（标准中的其他更改绝对是最小的）......

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-12T21:34:46.110

好的代码是性能、可扩展性、可读性和可维护性的混合体。

在我看来，C99 使代码更易于阅读和维护。非常非常少的编译器不支持 C99，所以我说去吧。使用您可用的工具，除非您确定需要使用需要早期标准的编译器来编译您的项目。

查看这些链接以了解有关 C99 优势的更多信息：

[http://www.kuro5hin.org/?op=displaystory;sid=2001/2/23/194544/139](http://www.kuro5hin.org/?op=displaystory;sid=2001/2/23/194544/139)

[http://en.wikipedia.org/wiki/C99#Design](http://en.wikipedia.org/wiki/C99#Design)

请注意，C99 还支持库函数，例如`snprintf`，非常有用，并且具有更好的浮点支持。此外，我发现宏*非常*有用，尤其是在处理数学密集型应用程序（如加密算法）时

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-03-07T14:32:00.777

我不同意 Paul R 的“底线”评论。在多种情况下，C89 有利于便携性。

1.  针对嵌入式系统，可能有也可能没有支持 C99 的编译器： [https ://groups.google.com/forum/#!topic/comp.arch.embedded/WNvhw3T_9pI%5B1-25%5D](https://groups.google.com/forum/#!topic/comp.arch.embedded/WNvhw3T_9pI%5B1-25%5D)

2.  以[TinyCC](http://bellard.org/tcc/)编译器为目标，这可能需要在安装巨大工具链不切实际或不允许的受限环境中。（TCC 不再被开发，Bellard 关于 ISOC99 支持的最后[声明](http://bellard.org/tcc/)是它正在“走向”完全合规。）

3.  支持通过 libtcc 进行动态编译（见上文）。

4.  正如其他人所指出的，针对 MSVC。

5.  为了与公司可能要求使用 C89 标准的项目实现源代码兼容性。如果您正在编写一个开源库，并且希望在某些行业中最大化其应用，这一点尤其重要。

正如 cegfault 所指出的，[维基百科](https://en.wikipedia.org/wiki/C99#Design)上列出的一些 C99 功能可能非常有用，但如果您的优先级是可移植性，或者上述任何原因适用，我认为这些功能都不是必不可少的。

微软似乎没有在 C99 合规性上做出让步。来自北尔电子的 SimonRev在 2016 年 11 月评论了一个相关的[MSDN 线程：](https://social.msdn.microsoft.com/Forums/en-US/fa17bcdd-7165-4645-a676-ef3797b95918/details-on-c99-support-in-msvc?forum=vcgeneral)

> 概括地说，C99 编译器中唯一实现的部分是它们需要使 C++ 编译器保持最新的部分。
> 
> 自 VC6 以来，微软基本上没有对 C 编译器做任何事情，而且他们并没有隐瞒 C++ 是他们对本机代码未来的愿景，而不是 C。

总之，如果您想要嵌入式或受限系统的可移植性、动态编译、MSVC 或与专有源代码的兼容性，我会说 C89 是有利的。