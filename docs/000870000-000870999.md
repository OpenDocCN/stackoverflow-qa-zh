# StackOverflow 问答 000870000-000870999

# c# - 启用/禁用互联网连接的代码

> ID：870006
> 
> 赞同：-2
> 
> 时间：2009-05-15T17:45:31.497
> 
> 标签：c#, internet-connection

我需要编写一些代码来触发计算机上的互联网连接。默认情况下，互联网不应该工作。

但是，安装我的程序后，互联网应该可以工作。

当然，计算机已连接到我的服务器，并且现在通常通过 DHCP 访问互联网。但是，请给我一些想法，以使只有安装我的程序才能实现互联网连接的方式来制作东西。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T18:30:19.330

我知道您不想使用一个，但正确且最容易使用的工具是代理。

您必须编写一些程序以启用某些客户端/服务器/代理通信，但代理将是要走的路。

但也许我们不了解您的要求 - 为什么不能使用代理？

我很想知道 vpn 设置是否适合您。虽然这只是代理的变体..

编辑：查看 Squid - 我不知道您在其余环境中使用什么，但它支持[mysql authentication](http://wiki.squid-cache.org/ConfigExamples/Authenticate/Mysql)。mysql 表上有一个“启用”标志，您可以使用服务器控制该标志。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T18:03:04.170

Zone Alarm 做了类似的事情，我看到它禁用“互联网访问”，即当它认为您有木马时禁用某些端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:06:21.743

我不明白在您的程序甚至存在于计算机上之前，您如何首先禁用互联网访问。

但是，如果您绑定到公司网络，则可能是强制 Internet Explorer 使用特定代理的组策略（在这种情况下是您的程序）。这样，在加载您的程序之前，网页浏览将无法正常工作。还有另一个组策略禁用更改代理设置的可能性。在 Chrome、Opera、Firefox 等中防止这些东西是另一回事....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T18:28:25.607

啊，这很容易。购买路由器，安装它，转到 192.168.1.1，输入您的密码，然后将其设置为基于 MAC 地址进行身份验证，或要求用户密码，以更接近您当前计划的方式为准：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T18:34:10.663

您正在尝试做的事情属于 802.1x 领域。阅读该技术以及在用户通过身份验证后启用出站路由的可能性。

# asp.net - ASP.NET 验证

> ID：870017
> 
> 赞同：1
> 
> 时间：2009-05-15T17:47:38.997
> 
> 标签：asp.net, validation, unicode, urlencode

当用户输入外国名称时，我收到验证错误。一个例子是：

System.Web.HttpRequestValidationException：从客户端检测到具有潜在危险的 Request.Form 值（ctl00$pageContent$txtName="Pedro ú logo"）。

其中 ú 被翻译为 & # 250 ; （当然没有空格）

这些外来字符是可接受的，不应导致验证错误。我希望 ASP.NET 验证使用 UTF-16 而不是 UTF-8 进行验证

许多网站、博客和论坛都简单地说要关闭验证。（即 ValidateRequest="false"）

有没有办法在不关闭验证的情况下解决这个问题？此应用程序不接受关闭验证。

谢谢，杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T17:50:43.810

调整请求验证机制实际上是不可能的。它有点硬编码。我看不出你不想禁用它的原因。如果您负责对从用户那里获得的所有内容进行清理和 HTML 编码，并且您希望在页面上显示（不管 ASP.NET 请求验证如何，您都应该这样做），那么您就不需要太多了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T17:59:11.950

我遇到过这个问题。

解决方法是在您发布帖子之前使用 javascript 清理输入。

有关某些 javascript ，请参阅[此 stackoverflow 对类似问题的回答](https://stackoverflow.com/questions/81991/a-potentially-dangerous-request-form-value-was-detected-from-the-client/436247#436247)

此外，这几乎是[这个 stackoverflow 问题的副本（上面链接）](https://stackoverflow.com/questions/81991/a-potentially-dangerous-request-form-value-was-detected-from-the-client)

# c - 安全编程中的 Memcpy()？

> ID：870019
> 
> 赞同：18
> 
> 时间：2009-05-15T17:47:43.553
> 
> 标签：c, security, memcpy

我最近偶然发现[了一篇文章](http://www.theregister.co.uk/2009/05/15/microsoft_banishes_memcpy/)，声称微软正在`memcpy()`其安全编程商店中禁止该功能。我了解该功能固有的漏洞，但有必要完全禁止使用它吗？

我编写的程序应该`memcpy()`完全避免，还是只是确保它被安全使用？有哪些替代品可以提供类似但更安全的功能？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-15T17:57:27.383

Microsoft 提供了 memcpy 和 wmemcpy 的[替代方法](http://msdn.microsoft.com/en-us/library/wes2t00f.aspx)来验证它们的参数。

memcpy_s 说，“嗯，在我从这个地址读取之前，让我自己验证它不是空指针；在我写入这个地址之前，我将再次执行该测试。我还将比较我的字节数已被要求复制到声称的目的地大小；当且仅当呼叫通过所有这些测试时，我才执行复制。”

memcpy 说“将目标填充到寄存器中，将源填充到寄存器中，将计数填充到寄存器中，执行 MOVSB 或 MOVSW。” （geocities 的例子，这个世界不久：[http](http://www.geocities.com/siliconvalley/park/3230/x86asm/asml1013.html) ://www.geocities.com/siliconvalley/park/3230/x86asm/asml1013.html ）

*编辑：对于 memcpy 的Your Wish Is My Command*方法中的一个示例，请考虑 OpenSolaris，其中 memcpy （对于某些配置）[是根据 bcopy 定义的](http://cvs.opensolaris.org/source/xref/onnv/onnv-gate/usr/src/lib/libast/common/comp/memcpy.c)，而[bcopy](http://cvs.opensolaris.org/source/xref/onnv/onnv-gate/usr/src/cmd/vi/port/bcopy.c)（对于某些配置）是......

```
void
     33 bcopy(from, to, count)
     34 #ifdef vax
     35     unsigned char *from, *to;
     36     int count;
     37 {
     38 
     39     asm("   movc3   12(ap),*4(ap),*8(ap)");
     40 }
     41 #else
     42 #ifdef u3b      /* movblkb only works with register args */
     43     unsigned char *from, *to;
     44     int count;
     45 {
     46     asm("   movblkb %r6, %r8, %r7");
     47 }
     48 #else
     49     unsigned char *from, *to;
     50     int count;
     51 {
     52     while ((count--) > 0)
     53         *to++ = *from++;
     54 }
     55 #endif 
```

编辑：谢谢，米莉史密斯！这是我在上面链接的 geocities 页面上的内容：

MOVS

指令 movs 用于将源字符串复制到目标中（是的，复制，而不是移动）。该指令有两种变体：movsb 和 movsw。movsb（“移动字符串字节”）一次移动一个字节，而 movsw 一次移动两个字节。

由于我们想一次移动几个字节，这些 movs 指令是使用 rep 前缀分批完成的。移动次数由 CX 寄存器指定。请参见下面的示例：

```
:
lds   si, [src]
les   di, [dest]
cld
mov   cx, 100
rep   movsb
: 
```

此示例将从 src 复制 100 个字节到 dest。如果将 movsb 替换为 movsw，则改为复制 200 个字节。如果删除 rep 前缀，CX 寄存器将不起作用。您将移动一个字节（如果是 movsb，如果是 movsw，则移动 2 个字节）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-15T12:14:48.780

不要打扰。微软的替代品并没有那么好。主要价值在于这些会导致您的代码无法移植到 Linux。微软在他们卖给你客户的操作系统上赚的钱比他们在你购买的 Visual C++ 副本上赚的钱要多得多。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-15T17:54:58.713

如果使用得当，电锯是安全的。与 memcpy() 相同。但在这两种情况下，如果你撞到钉子，它就会飞起来伤害你。

简而言之，低级计算需要 memcpy() 并且不会消失，但对于高级编程，您不需要它。Python 中没有 memcpy() 。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-15T17:55:37.497

文章本身描述了一个更安全的替代方案：memcpy_s，它要求您指定目标的最大长度。当该数字独立于要复制的字节量提供时，它可以作为防止缓冲区溢出的屏障。当然，您可以通过给两者提供相同的号码来滥用它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-14T15:47:32.360

在我的代码中禁止 memcpy() 是让我成为更好的程序员和我的应用程序更安全还是更不兼容？我不确定，如果 MS 真的想改变任何东西，或者只是让任何新的 C 代码与其他编译器不兼容。顺便提一句。MS 在许多功能上都使用了这个技巧，这很烦人。strcpy -> strcpy_s -> StringCchCopy。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-15T18:42:56.320

我认为 C 应该留给程序员一个选择自己的脚。如果操作正确，手动内存管理是安全的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-10-15T12:05:19.797

你自己说过：“微软在其**安全编程商店**中禁止使用 memcpy() 函数，我理解**该函数固有的漏洞**，”

众所周知，memcpy() 和许多其他标准函数会导致漏洞，那么当（尽管是增量的）改进微不足道时，为什么安全的编程商店会允许使用它们呢？

毫无疑问，在他们努力提高自己产品的安全性的过程中，代码审查清楚地表明，这些函数是造成很大一部分漏洞、缓冲区溢出等的原因。他们没有制作包装器供内部使用，而是将它们引入标准库并为了所有人的利益添加了编译器警告（不是禁令）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-15T17:55:53.797

另一种方法是调用[memcpy_s](http://msdn.microsoft.com/en-us/library/wes2t00f(VS.80).aspx)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-05-11T22:45:46.603

如果您使用的是旧版本，例如 C99 或 C++98，或者在 Solaris 上，则不能使用 memcpy_s，除非您安装了 Safe C 库。

memcpy_s() 是 Microsoft 特定的实现，根据他们自己的标准，在 C11 之前的非 MS 实现（包括 ANSI）上不存在。

我将把支持 MS 和反 MS 的东西放在一边，因为这无关紧要。

memmove() 无论如何都是一个更好的解决方案，因为它解决了重叠问题。memmove_s() 更健壮，但同样，仅当您使用 C11 或更高版本时。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-15T17:56:16.183

您应该改用 memcpy_s() 。对于被认为是不安全的各种其他功能，存在相同类型的 _s 版本。

# asp.net - 如何将整个 POST 数据转储到 ASP.NET 中的文件中

> ID：870022
> 
> 赞同：6
> 
> 时间：2009-05-15T17:48:00.557
> 
> 标签：asp.net, request, postdata

我目前正在尝试将应用程序从 asp.net 移植到 php，但是我只是碰壁了，需要帮助。

我需要将 .aspx 通过 POST 收到的所有数据转储到文件中，但我不知道如何执行此操作

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T17:55:30.193

您可以使用 Request 对象的 InputStream 属性。这将为您提供 http 请求的原始数据。通常，您可能希望将其作为自定义 http 处理程序来执行，但我相信您可以随时执行此操作。

```
if (Request.RequestType == "POST")
{
    using (StreamReader reader = new StreamReader(Request.InputStream))
    {
        // read the stream here using reader.ReadLine() and do your stuff.
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-09T11:08:13.937

如果您只想要 POST 数据，那么您可以使用 Request.Form.ToString() 以 url 编码的方式获取所有数据。

```
if (Request.RequestType == "POST") {
    string myData = Request.Form.ToString();
    writeData(myData); //use the string to dump it into a file,
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-15T17:54:04.503

您可以使用`BinaryRead`从请求正文中读取：

```
Request.BinaryRead 
```

或者您可以通过以下方式获得对输入`Stream`对象的引用：

```
Request.InputStream 
```

然后你可以使用[`CopyStream`](https://stackoverflow.com/questions/444309/what-would-be-the-fastest-way-to-concatenate-three-files-in-c/444316#444316)：

```
using (FileStream fs = new FileStream(...))
    CopyStream(fs, Request.InputStream); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T18:15:58.257

您可以使用代理应用程序，例如[Fiddler](http://www.fiddler2.com/fiddler2/)。这将让您查看所有传输的数据，并根据需要将其保存到文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T17:52:13.573

最好的方法是通过一些浏览器插件，如[Fiddler](http://www.fiddler2.com/fiddler2/)或[LiveHttpHeaders](http://livehttpheaders.mozdev.org/)（仅限 Firefox）。然后你可以截取原始的 POST 数据。

# hibernate - 通过关联休眠顺序

> ID：870029
> 
> 赞同：13
> 
> 时间：2009-05-15T17:49:37.900
> 
> 标签：hibernate, sql-order-by, associations

我正在使用 Hibernate 3.2，并使用条件来构建查询。我想为多对一关联添加和“排序”，但我不知道如何做到这一点。Hibernate 查询最终看起来像这样，我猜：

```
select t1.a, t1.b, t1.c, t2.dd, t2.ee
from t1
inner join t2 on t1.a = t2.aa
order by t2.dd   <-- need to add this 
```

我已经尝试过 criteria.addOrder("assnName.propertyName") 但它不起作用。我知道它可以用于普通属性。我错过了什么吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-15T20:47:48.487

好的，找到答案了。我尝试了一些我认为行不通的方法，但令我惊讶的是，我做到了。我正在尝试这个：

```
Criteria criteria = super.getSession().createCriteria(WipDiscreteJob.class);

criteria.addOrder(Order.asc("assnName.propertyName")) 
```

但实际起作用的是：

```
Criteria criteria = super.getSession().createCriteria(WipDiscreteJob.class);
Criteria assnCrit = criteria.createCriteria("assnName");

assnCrit.addOrder(Order.asc("propertyName")); 
```

我假设 addOrder() 方法仅可用于主要标准，而不能用于任何关联标准。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-04-09T21:54:09.100

我遇到了同样的问题，也可以这样解决：

```
Criteria criteria = super.getSession().createCriteria(WipDiscreteJob.class)
  .createAlias("assnName","a")
  .addOrder(Order.asc("a.propertyName")); 
```

createAlias 让您的标准植根于您的原始实体（在本例中为 WipDiscreteJob.class），以便您可以在需要时继续构建标准（例如，如果您需要原始实体的第二个属性订单） .

# javascript - 使用 DontEnum 设置自定义属性

> ID：870032
> 
> 赞同：4
> 
> 时间：2009-05-15T17:50:18.727
> 
> 标签：javascript, properties, dontenum

如果我创建：

```
Object.prototype.count = function() {};
var m = {prop: 1};

for(var i in m)
    window.status += i + ", "; 
```

在上面的代码`i`中包含也`count`继承了它的原型。现在我想知道是否有办法将自定义属性设置为标志 DontEnum（自定义属性不可设置），因此不会被枚举。

我知道我可以`if(m.hasOwnProperty(i))`只检查它的属性，但是如果我编写某种数组的 API，我应该告诉程序员记住这一点……这是不可接受的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T22:42:55.933

实际上，Object 对象有一个属性“propertyIsEnumerable”，但它不是很有用。也许[http://dhtmlkitchen.com/learn/js/enumeration/dontenum.jsp](http://dhtmlkitchen.com/learn/js/enumeration/dontenum.jsp)可以给你更多的洞察力？如果您按照这些章节进行操作，您最终会看到一个简单的问题“如何设置 DontEnum 属性”，回答更简单且非常令人失望：“你不能。” 幸好还有更多章节。你最终应该会看到一个包含有趣短语的页面：“好吧，好吧，IE 是垃圾，JavaScript 很烂，等等，等等……是时候停止抱怨并卷起袖子了。”。不过，本教程的底线是：“ *JavaScript 中的可枚举性造成了一个严重的问题*。”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-24T11:22:32.420

从 JavaScript 1.8.5 开始，您可以使用 Object 方法[defineProperty](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/defineProperty)：

```
Object.defineProperty (object, propertyName, attributes); 
```

Where`attributes`是一个地图，您可以在其中设置各种属性，例如`value`、`enumerable`和`writable`。如果属性存在，则修改它，否则创建它。

Juriy Zaytsev 构建了一个[ECMAScript 5 兼容性表](http://kangax.github.com/es5-compat-table/)，您可以在其中找到支持的浏览器`defineProperty`（以及许多其他功能），尽管他忽略了 Safari 不支持`defineProperty`DOM 对象 - 与 IE 正好相反！！！:( -

## 编辑

Juriy 更新了表格。

# c# - 使用工厂方法设计模式在 C# 中管理不同的类版本是个好主意吗？

> ID：870036
> 
> 赞同：0
> 
> 时间：2009-05-15T17:50:44.417
> 
> 标签：c#, design-patterns, refactoring

下面的代码是编写和管理代码的新方法（对我而言）的一个小起点。在我放松了几个星期并且可能在最后说是的，这是一个愚蠢的想法之前，我认为最好先在这里“压力测试”。

所以这就是这个想法。当客户端（Envoker）类使用服务器（提供一些服务的类 - 在下面的示例中称为控制器）时，每次存在类型的依赖项时，客户端将使用静态方法来处理具有足够通用名称的“存根”，以便此名称不必更改 - 例如 CreateDynamicTextBox() 或 RunProcedureGetDataSet() 并将传递一个配置对象，工厂将根据该配置对象提供所请求的 Server 类版本，因此每次有足够稳定的 Server 版本时当必须向其添加新功能（或应更改其逻辑）时，将编写新的服务器类版本。提议的好处将是通过通用方法和“设置”对象的传递来保存流程。

这是一个坏主意吗 ？！如果是，为什么？这种方法有什么积极的吗？！

```
using System;

namespace ControllerFactory
{
  class ClientEnvoker
  {
    static void Main ( string[] args )
    {

      Console.WriteLine ( " START " );
      ClientEnvoker objClientEnvoker = new ClientEnvoker ();

      ControllerFactory objControllerFactory = new ControllerFactory ();

      Console.WriteLine ( " RUN METHOD 1 WITH CONTROLLER 1 WITH CONFIG 1 " );
      objControllerFactory.GenericMethodName ( ControllerFactory.CFSetter.First );

      Console.WriteLine ( " RUN METHOD 2 WITH CONTROLLER 2 WITH CONFIG 2 " );
      objControllerFactory.GenericMethodName ( ControllerFactory.CFSetter.Second );

      Console.WriteLine ( " RUN METHOD 3 WITH CONTROLLER 3 WITH CONFIG 3 " );
      objControllerFactory.GenericMethodName ( ControllerFactory.CFSetter.Second );

      Console.WriteLine ( " END HIT A KEY TO EXIT " );
      Console.ReadLine ();

    } //eof method 

  } //eof class 

  class ControllerFactory
  {
    public enum CFSetter : int
    {
      First = 1,
      Second = 2 , 
      Third = 3
    }

    public void GenericMethodName ( CFSetter objCFSetter )
    {
      Controller c = this.FactoryMethod ( objCFSetter );
      c.ConcreteMethod ();
    } //eof method 

    public Controller FactoryMethod ( CFSetter objCFSetter )
    {
      Controller controllerReturn = null;
      switch (objCFSetter)
      {
        case CFSetter.First:
          controllerReturn = new Controller1 ();
          break;
        case CFSetter.Second:
          controllerReturn = new Controller2 ();
          break;
        case CFSetter.Third:
          controllerReturn = new Controller3 ();
          break;
        default:
          controllerReturn = new Controller1 ();
          break;
      }
      return controllerReturn;
    }

  } //eof class

  #region Controllers
  public abstract class Controller
  {
    public abstract void ConcreteMethod ();
  }

  public class Controller1 : Controller
  {

    public override void ConcreteMethod ()
    {
      Console.WriteLine ( "Controller1 screams according to version 1 logic" );
    }
  } //eof class 

  public class Controller2 : Controller
  {

    public override void ConcreteMethod ()
    {
      Console.WriteLine ( "Controller2 screams according to version 2 logic" );
    }
  } //eof class 

  public class Controller3 : Controller
  {

    public override void ConcreteMethod ()
    {
      Console.WriteLine ( "Controller3 screams according to version 3 logic" );
    }
  } //eof class 

  #endregion Controllers

} //eof namespace 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T18:37:14.477

对这样的事情使用工厂模式很好。但是，`FactoryMethod()`应该在逻辑所在的位置选择要实例化的类。此外，如果`FactoryMethod()`是返回类型`Controller`，则没有理由强制转换返回的对象。

你`RunMethod()`会变成这样的东西......

```
ControllerFactory cf = new ControllerFactory();
Controller c = cf.FactoryMethod(objCFSetter);
c.Scream(); 
```

你`FactoryMethod()`会看起来像这样......

```
Controller controllerReturn = null;
switch (objCFSetter) {
    case CFSetter.First:
      controllerReturn = new Controller1();
      break;
    case CFSetter.Second:  
      controllerReturn = new Controller2();
      break;
    default:
      controllerReturn = new Controller1();
      break;
}
return controllerReturn; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T19:30:08.627

谢谢，乔恩。我认为您的意思是我在下面发布的实现（当然不会接受它作为答案！）。是的，使用奇怪的静态方法似乎比我上面的代码更简单。不过，这是相同的“功能”吗？如果这种类型的“热交换”工作频率如何，或者可以在哪种情况下使用（我正在考虑动态控件的生成和数据库提供程序的动态选择）。

```
using System;

namespace ControllerFactory
{
  class ClientEnvoker
  {
    static void Main ( string[] args )
    {

      Console.WriteLine ( " START " );
      ClientEnvoker objClientEnvoker = new ClientEnvoker ();

      ControllerFactory cf = new ControllerFactory ();

      Console.WriteLine ( " RUN METHOD 1 WITH CONTROLLER 1 WITH CONFIG 1 " );
      cf.RunMethod ( ControllerFactory.CFSetter.First );

      Console.WriteLine ( " RUN METHOD 2 WITH CONTROLLER 1 WITH CONFIG 2 " );
      cf.RunMethod ( ControllerFactory.CFSetter.Second );

      Console.WriteLine ( " END HIT A KEY TO EXIT " );
      Console.ReadLine ();

    } //eof method 

  } //eof class 

  class ControllerFactory
  {
    public enum CFSetter : int
    {
      First = 1,
      Second = 2
    }

    public void RunMethod ( CFSetter objCFSetter )
    {
      Controller c = this.FactoryMethod ( objCFSetter );
      c.Scream ();
    } //eof method 

    public Controller FactoryMethod ( CFSetter objCFSetter )
    {
      Controller controllerReturn = null;
      switch (objCFSetter)
      {
        case CFSetter.First:
          controllerReturn = new Controller1 ();
          break;
        case CFSetter.Second:
          controllerReturn = new Controller2 ();
          break;
        default:
          controllerReturn = new Controller1 ();
          break;
      }
      return controllerReturn;
    }

  } //eof class

  #region Controllers
  public abstract class Controller
  {
    public abstract void Scream ();
  }

  public class Controller1 : Controller
  {

    public override void Scream ()
    {
      Console.WriteLine ( "Controller1 screams according to version 1 logic" );
    }
  } //eof class 

  public class Controller2 : Controller
  {

    public override void Scream ()
    {
      Console.WriteLine ( "Controller2 screams according to version 2 logic" );
    }
  } //eof class 

  #endregion Controllers

} //eof namespace 
```

# memcpy - memcpy 不安全吗？

> ID：870041
> 
> 赞同：2
> 
> 时间：2009-05-15T17:51:49.377
> 
> 标签：memcpy

### 复制：

> [安全编程中的 Memcpy()？](https://stackoverflow.com/questions/870019/memcpy-in-secure-programming)

* * *

根据“[请加入我，欢迎 memcpy() 加入 SDL Rogues Gallery](http://blogs.msdn.com/sdl/archive/2009/05/14/please-join-me-in-welcoming-memcpy-to-the-sdl-rogues-gallery.aspx) ” `memcpy`，因为不安全而被禁止。目标大小不清楚的`gets()`,和类似的 api是有道理的。`strcpy`是`memmove()`下一个吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T17:56:08.697

所有这些“安全”方法的要点是：

> 当然，您可以`memcpy_s()`通过错误的缓冲区大小轻松调用不安全。

[[来源](http://blogs.msdn.com/sdl/archive/2009/05/14/please-join-me-in-welcoming-memcpy-to-the-sdl-rogues-gallery.aspx)]

这就是为什么我发现这个 SDL 功能被过度炒作的原因。当然，如果*编译器*（或适当的运行时，在性能和/或内存方面代价高昂）不采取预防措施，这些问题在像 C 这样的语言中是固有的。

它还降低了程序的可移植性，我个人认为这是一个巨大的缺点。当然，微软不一定会同意。

在可能的情况下，通过正确使用（检查的）迭代器将代码迁移到 C++ 可能更有意义。这些操作虽然本质上*也不*安全，但更容易正确使用，并使错误代码脱颖而出。当然，自告奋勇者，所有那些 C 粉丝和 C++ 否认者现在都会追随我的皮肤......</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T17:57:00.300

memmcopy 可能会为恶意用户的堆栈溢出创建一个开口。例如：在处理恶意 WordDocument 文件过程中存在特定缺陷。在 WordDocument 流中的偏移量 0xb4c 处解析期间可以触发溢出。在此偏移处，有一个 WORD 大小用作 memmove 调用的第三个参数。

# .net - UpdatePanel 不刷新显示

> ID：870042
> 
> 赞同：0
> 
> 时间：2009-05-15T17:51:57.677
> 
> 标签：.net, asp.net, ajax, updatepanel

我在自定义控件中有一个 UpdatePanel，在该 UpdatePanel 中有两个占位符。一个初始设置 Visible = false，另一个设置为 true。在可见的内部，我有一个 ImageButton 来切换占位符的可见性。

我在我网站的两个不同页面上使用此控件。在主页上它按预期工作，在另一个页面上单击按钮会触发事件（我可以放置一个断点，它会触发），但屏幕不会更新。更新面板中的其他按钮似乎也不起作用。

两个页面共享同一个母版页，其中包含一个脚本管理器。

有任何想法吗？由于客户协议，我担心我无法发布代码，但我已尽力概述情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T18:42:39.427

每当我有一个页面可以完美运行而另一个页面具有相同的功能但没有，它通常归结为一个愚蠢的小东西。

您需要从当前不工作的页面中删除所有内容，然后开始重新构建它。最初，只需从更新面板、占位符和按钮开始。如果这不起作用，请参阅另一页并逐行查看，直到一切匹配并开始工作。

从那里，只需备份您的页面，直到它失败或完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:47:34.773

我得到了它的工作，但我不知道如何。在这两个页面上，自定义控件都嵌入到转发器的 HeaderTemplate 中。在损坏的页面上，将其从 HeaderTemplate 中删除会导致它按预期工作。

# java - java imap 获取自某个日期以来的消息

> ID：870045
> 
> 赞同：10
> 
> 时间：2009-05-15T17:52:36.537
> 
> 标签：java, email, imap

我正在编写/学习使用 javax.mail 包从 IMAP 文件夹中使用 java 获取电子邮件。我成功地检索了文件夹中的最后 n 条消息，但是我希望构建一个示例来检索自指定日期以来的消息。有什么例子吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-15T20:11:35.920

您还可以使用 java 邮件包中的 SearchTerm 类。

```
SearchTerm olderThan = new ReceivedDateTerm(ComparisonTerm.LT, someFutureDate);
SearchTerm newerThan = new ReceivedDateTerm(ComparisonTerm.GT, somePastDate);
SearchTerm andTerm = new AndTerm(olderThan, newerThan);
inbox.search(andTerm); 
```

以上的一些组合应该被证明是在一定范围内获取日期的更好方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-24T06:37:40.900

```
public class CheckDate  {
    public void myCheckDate(Date givenDate) {
        SearchTerm st = new ReceivedDateTerm(ComparisonTerm.EQ,givenDate);

        Message[] messages = inbox.search(st);
    }

    // in main method

    public static void main(String[] args) throws ParseException{
        SimpleDateFormat df1 = new SimpleDateFormat( "MM/dd/yy" );
        String dt="06/23/10";
        java.util.Date dDate = df1.parse(dt);
        cd.myCheckDate(dDate);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T19:39:19.167

您应该尝试利用服务器端搜索，而不是获取所有消息。这通过使用*javax.mail.Folder的**搜索*方法来工作。您可能必须根据 Message.getReceivedDate() 上的条件编写自己的 SearchTerm。

 *如果服务器端搜索不起作用，您可以尝试使用获取配置文件，即使用 inbox.fetch(Message[] msgs, FetchProfile fp) 代替 inbox.getMessages()。fetch 的 javadoc 说：*客户端使用此方法来指示指定的项目是需要整体用于给定消息范围的。期望实现以有效的方式检索给定消息范围的这些项目。请注意，此方法只是实现预取所需项目的提示。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T18:24:40.607

这是我想出的。这对我有用，但可能不是最好的方法。有什么建议可以改进吗？

```
 Date from; //assume initialized
      Store store; //assume initialized
      Folder inbox = store.getFolder("INBOX");
      inbox.open(Folder.READ_ONLY);
      int end = inbox.getMessageCount();
      long lFrom = from.getTime();
      Date rDate;
      long lrDate;
      int start = end;
      do {
        start = start - 10;
        Message testMsg = inbox.getMessage(start);
        rDate = testMsg.getReceivedDate();
        lrDate = rDate.getTime();
      } while (lrDate > lFrom);
      Message msg[] = inbox.getMessages(start, end);
      for (int i=0, n=msg.length; i<n; i++) {
        lrDate = msg[i].getReceivedDate().getTime();
        if (lrDate > lFrom) {
          System.out.println(i + ": "
            + msg[i].getFrom()[0]
            + "\t" + msg[i].getSubject());
        }
      } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-01T04:55:41.170

上个月的所有邮件：

```
 Calendar cal = Calendar.getInstance();
    cal.roll(Calendar.MONTH, false);
    Message[] search = folder.search(new ReceivedDateTerm(ComparisonTerm.GT, cal.getTime())); 
```

# c# - 如何关闭在 WPF 中用作子菜单的弹出窗口

> ID：870052
> 
> 赞同：3
> 
> 时间：2009-05-15T17:54:14.097
> 
> 标签：c#, wpf, popup

我有一个按钮，单击该按钮会打开一个弹出窗口。Popup 是一个包含更多按钮的子菜单。单击子菜单上的其中一个按钮时，弹出窗口将关闭。当用户单击弹出窗口之外的某个位置时，我还希望弹出窗口关闭。还需要注意的是，屏幕的大部分由显示 OpenGL Win Forms 控件的 WindowsFormsHost 占据。

单击子菜单按钮时关闭弹出窗口我已经能够做到。在这些按钮的单击处理程序中，我关闭了弹出窗口。但是，单击其他地方时关闭弹出窗口是我遇到问题的地方。

我尝试过的事情：

将 PopUp.StaysOpen 设置为 false。这是因为当点击屏幕上的其他地方时，弹出窗口关闭。但是，在 Win Forms 控件上，似乎需要单击以关闭弹出窗口，然后再单击以执行任何操作。这是非常不可取的。

我已经尝试为打开弹出窗口的按钮处理 LostFocus 事件，并将 StaysOpen 设置为 true。这适用于单击弹出窗口不需要第二次单击 Win Forms 控件。现在的问题是处理了 LostFocus 事件并且 Popup 在读取 Popup 上的任何按钮的点击之前关闭。这使子菜单无法使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-31T21:39:39.900

WPF 的焦点系统可能存在一些问题。WPF 有它自己的焦点系统，它完全独立于 WinForms 和标准 Win32 窗口。

在 WinForms 和 WPF 之间切换焦点时，我敢打赌有些事件没有正确触发。

建议的修复方法是覆盖 WinForms 窗口的 WndProc 或 Click 事件，并在弹出窗口中手动将 IsOpen 设置为 false。

我希望这是唯一可以解决它的事情。

# php - PHP Microsoft Excel 文件生成/导出类

> ID：870063
> 
> 赞同：5
> 
> 时间：2009-05-15T17:56:29.537
> 
> 标签：php, mysql, excel, class, export

我一直在寻找一个好的 Excel 文件生成类，但还没有找到——我的第一个问题是，虽然我可以让导出的文件在 Excel 中打开（运行 2007 年），但我总是收到警告说“文件的格式与文件扩展名不同”。

我注意到 phpMyAdmin 中的 Excel 导出甚至会生成上述警告消息。

其他用户使用什么代码来满足这个常见需求？

**快速更新**如果我将生成的 Excel 文件的文件扩展名设置为 xml，它将在浏览器中打开（即使我发送了正确的标题），但如果我选择保存 xml 文件然后从 Excel 打开它，它可以工作没有任何警告！不幸的是，这对用户来说比简单地单击“继续”并收到警告更麻烦。还有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T20:11:13.870

[http://www.phpexcel.net](http://www.phpexcel.net)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T18:03:16.493

使用PEAR 中的[Spreadsheet_Excel_Writer](http://pear.php.net/package/Spreadsheet_Excel_Writer)

或者

将文件写入[CSV 格式](http://en.wikipedia.org/wiki/Comma-separated_values)。
但是使用 Microsoft Excels 对 csv 的理解：分号 (;) 作为分隔符

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T20:00:59.050

您还可以使用 regedit 禁用该对话框

```
[HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security]
“ExtensionHardening”=dword:00000000 
```

*   开始 -> 运行 -> 注册表编辑器
*   转到“HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\OFFICE\12.0\EXCEL\SECURITY”
*   新双字
*   键入“ExtensionHardening”作为名称，0 作为值

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T12:10:49.483

我发现在生成的 Excel 文件中的 xml 声明下添加以下内容，可确保 Excel 以 xml 文件扩展名（而不是 Web 浏览器）打开文件：

```
 <?mso-application progid=\"Excel.Sheet\"?> 
```

我还在 php 中设置了以下标头：

```
// deliver header (as recommended in php manual)
header('Content-Type: application/vnd.ms-excel; charset=UTF-8');
header('Content-Disposition: attachment; filename="' . $filename . '.xml"'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T18:14:20.180

> 该文件的格式与文件扩展名不同

您是否尝试使用其他文件扩展名保存文件？像“foo.xlsx”而不是“foo.xls”。

# c# - 时间：2019-04-10 标签：c#makeShowItemToolTipssticky

> ID：870073
> 
> 赞同：2
> 
> 时间：2009-05-15T17:57:26.603
> 
> 标签：c#, listview

我有一个 ListView ，其中几个项目的文本超过了列宽。ShowItemToolTips 意味着我可以将鼠标悬停在一个列上并查看全文，这很棒。

但是，对于非常长的文本，它会在有时间阅读所有内容之前消失，所以我想让它保持更长时间（或者可能直到手动解除，例如通过移开鼠标或单击。我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T18:30:36.513

您当然知道，在 .NET ListView 类下面是一个 Windows 列表视图控件。此列表视图控件使用 Windows 工具提示控件来显示截断的字符串。

您可以通过 LVM_GETTOOLTIPS 消息获取此底层工具提示控件。

```
[DllImport("user32.dll", CharSet = CharSet.Auto)]
public static extern IntPtr SendMessage(IntPtr hWnd, int msg, 
                                        int wParam, int lParam);

public IntPtr GetTooltipControl(ListView lv) {
    const int LVM_GETTOOLTIPS = 0x1000 + 78;
    return SendMessage(lv.handle, LVM_GETTOOLTIPS, 0, 0);
} 
```

一旦有了工具提示控件的句柄，就可以向它发送消息。

```
public void SetTooltipDelay(ListView lv, int showTime) {
   const int TTM_SETDELAYTIME = 0x400 + 3;
   const int TTDT_AUTOPOP = 2;

   IntPtr tooltip = this.GetTooltipControl(lv);
   if (tooltip != IntPtr.Zero) {
      SendMessage(tooltip, TTM_SETDELAYTIME, TTDT_AUTOPOP, showTime);
   }
} 
```

showTime 是您希望控件保持可见的毫秒数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-06T18:36:13.533

有一个纯 .NET 代码替代 user32.dll P/Invoke 调用。创建一个[ToolTip](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.aspx)控件并设置所有延迟属性。然后使用 ListView [MouseMove](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousemove.aspx)事件根据当前选中的列表视图控件切换工具提示文本。

```
 ToolTip toolTip = new ToolTip();
    toolTip.AutoPopDelay = 7000;
    toolTip.InitialDelay = 450;
    toolTip.ReshowDelay = 450;

    listView.MouseMove += new MouseEventHandler(listView_MouseMove); 
```

我在下面给出了两个选项。选项 #1 将工具提示文本设置为子项的 Text 属性。选项 #2 将工具提示设置为父 ListViewItem 的 ToolTipText 属性。

```
 void  listView_MouseMove(object sender, MouseEventArgs e)
    {
        ListViewItem item = listView.GetItemAt(e.X, e.Y);
        ListViewHitTestInfo info = listView.HitTest(e.X, e.Y);

        if ((item != null) && (info.SubItem != null))
        {
            // Option #1 - Set it to the sub-item text
            // toolTip.SetToolTip(listView, info.SubItem.Text);

            // Option #2 - Sets it to the tool tip text of the sub-item
            toolTip.SetToolTip(listView, info.Item.ToolTipText);
        }
        else
        {
            toolTip.SetToolTip(listView, null);
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:25:16.440

查看 ToolTip 类。AutoPopupDelay 方法允许您设置工具提示保持可见的时间长度。

# mysql - 为什么 MySQL 中的 UNION 查询这么慢？

> ID：870080
> 
> 赞同：12
> 
> 时间：2009-05-15T17:59:01.887
> 
> 标签：mysql, query-optimization, union

当我优化我的 2 个单个查询以在 0.02 秒内运行，然后`UNION`它们生成的查询需要超过 1 秒才能运行。此外， a`UNION ALL`比 a 花费更长的时间`UNION DISTINCT`。

我假设允许重复会使查询运行得更快而不是更慢。我真的最好分开运行这两个查询吗？我更喜欢使用`UNION`.

作为一个简单的例子，如果我这样做

```
SELECT name FROM t1 WHERE field1 = true 
```

需要 0.001 秒

如果我这样做

```
SELECT name FROM t1 WHERE field1 = false 
```

它需要 0.1 秒。

如果我再跑

```
SELECT name FROM t1 WHERE field1 = true 
UNION ALL 
SELECT name FROM t1 WHERE field1 = false 
```

它需要超过 1 秒。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-16T00:36:09.450

> 当我优化我的 2 个单个查询以在不到 0.02 秒的时间内运行，然后将它们联合起来，生成的查询需要超过 1 秒的时间才能运行。

您的查询是否包含`ORDER BY … LIMIT`子句？

如果你`ORDER BY … LIMIT`在 a 之后放一个`UNION`，它会被应用到整个`UNION`，并且在这种情况下不能使用索引。

如果`id`是主键，则此查询将是即时的：

```
SELECT  *
FROM    table
ORDER BY id
LIMIT 1 
```

，但这个不会：

```
SELECT  *
FROM    table
UNION ALL
SELECT  *
FROM    table
ORDER BY id
LIMIT 1 
```

> 此外， a`UNION ALL`比 a 花费更长的时间`UNION DISTINCT`。我假设允许重复会使查询运行得更快而不是更慢。

这似乎也是由于`ORDER BY`。对较小的集合进行排序比对较大的集合进行排序更快。

> 我真的最好分开运行这两个查询吗？我宁愿使用`UNION`

您需要对结果集进行排序吗？

如果没有，只需摆脱 final `ORDER BY`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T18:48:18.460

一个猜测：由于您使用 2 个联合查询一个表，因此 mysql 可能难以确定该表的锁定策略，或者它尝试一些缓存，这在这里不起作用，因为您查询不相交的集合，尝试多线程访问（非常合理）但遇到一些锁定/并发/文件搜索问题..

联合通常也可能采用更高的安全设置，因为这两个选择必须是一致的。如果您将它们放入单独的事务中，它们不会。

实验：复制表格并将它们合并。如果我是对的，它应该更快。

可能的解决方案：将单个文件拆分为多个文件，以实现更好的并发策略。这不会/不应该帮助解决锁定问题，但排除了数据库中的多线程/查找问题。

知道您使用哪种存储引擎会很有用。

好吧，只是我的 2 美分。现在无法在这里测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-11-25T23:16:01.120

**关于`UNION`**

*   `UNION DISTINCT`（的默认值`UNION`）必然较慢，因为它必须收集两个结果，然后进行重复数据删除。但是，由于退回给客户的数量较少，因此可能会有一些补偿。
*   直到最近的版本，*都* `UNIONs`涉及一个临时表来收集结果，因此`UNION`必然比两个单独`SELECTs`的 . 最近，（MySQL 5.7、MariaDB 10.1）一些案例`UNION ALL`得到了改进，可以将数据从一个`SELECT`直接传递到客户端，然后再传递其他的。
*   `SELECT .. UNION SELECT .. ORDER BY ..`相当于--this --not this
    `(SELECT .. UNION SELECT ..) ORDER BY ..` 建议 总是在每个.
    `(SELECT ..) UNION (SELECT .. ORDER BY ..)`
    `SELECT`
*   排序（通过`ORDER BY`）*可能*需要额外的时间来处理它所附加的任何（选择或联合）。不太*可能*花费*更少的*时间。简单地说，优化器的目标是做任何最快的事情，这可能*恰好是*排序的。
*   所有这些陈述都适用于 InnoDB；MyISAM 不太受支持，可能缺少一些最近的优化。
*   `SELECT`有时，带有a 的单个`OR`可以通过将其转换为 a 来加速`UNION`，从而使用两个索引。

**关于测试：**

*   0.001 的时间闻起来就像您之前运行过查询，结果缓存在“查询缓存”中。通过关闭 QC 或添加`SQL_NO_CACHE`.
*   选择`WHERE flag = true (or false)`有几种情况：是否`flag`被索引？`flag`几乎总是这些值之一？在*这种*情况下，将使用索引，并且*可能*比其他情况更快。
*   如果您不同意我的任何陈述，请提供一个相反的工作示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-02T11:08:15.190

UNION ALL 比 UNION 快，因为普通的 UNION 期望在两个连接的数据集中存在需要删除的重复项。如果您可以（通过内部 WHERE 子句）确保没有重复项，则最好使用 UNION ALL 并让数据库引擎优化内部选择。

对分组结果的结果使用 WHERE 子句过于昂贵，因为您操作的内部结果超出了您的需要。此外，无法处理数据库引擎的优化——结果没有任何共同点。

检查此链接以获取详细信息[https://dzone.com/articles/performance-tip-for-tuning-sql-with-union](https://dzone.com/articles/performance-tip-for-tuning-sql-with-union)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-09-16T10:08:29.797

可能是您测量响应时间而不是检索所有数据的时间吗？

# asp.net - 以编程方式生成 WebControl

> ID：870087
> 
> 赞同：2
> 
> 时间：2009-05-15T18:00:38.123
> 
> 标签：asp.net

我有一个页面，根据前一页的输入，列出了从数据库中提取的不同数量的不同问题。我似乎在网上找不到这样的例子：对于显示的每个问题，我需要以编程方式生成一个 DropDownList，以便用户可以为每个问题选择是或否。希望这里的人能给我一些关于在哪里看的方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T18:09:06.543

最好的选择可能是将Repeater 控件与仅包含带有静态列表项的下拉列表的模板一起使用。像这样的东西：

```
<asp:Repeater runat="server" id="questionRepeater">
<HeaderTemplate>
  //some html
</HeaderTemplate>
<ItemTemplate>
<div align=center>
<asp:Label runat="server"><%# DataBinder.Eval(Container.DataItem,"questionColumn")%></asp:Label>
<asp:DropDownList runat="server">
   <asp:ListItem Text="Yes" Value="1" />
   <asp:ListItem text="No" Value="0" />
</asp:DropDownList>
</ItemTemplate> 
</asp:Repeater> 
```

然后在后面的代码中，您可以执行查询并将结果绑定到转发器。

```
private void Page_Load(object sender, System.EventArgs e)  
{  
   if (!IsPostBack)
   {
    SqlConnection db = new SqlConnection("Server=server;UID=uid;PWD=password;Database=whatever");  
   string sSQL = "Select questionColumn from Questions";
   SqlCommand cmd = new SqlCommand(sSQL, conDotNet);   
   db.Open();  
   SqlDataReader dtrCat = cmd.ExecuteReader();  
   questionRepeater.DataSource = dtrCat;  
  questionRepeater.DataBind();  
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T18:05:20.203

这是伪的，但可能会有所帮助......

```
//essentially, run through loop of questions and for each
//add the question and yes/no stuff..
///PlaceHolder is a ContentPlaceholder Control within the .aspx page.
foreach(inputtype input in this.inputs)
{
    Label lbl = new Label();
    lbl.Text = input.Question;

    DropDownList ddl = new DropDownList();
    ddl.ID = input.QuestionID;
    ddl.DataSource = YesNoDataTable;
    ddl.DataBind();

    this.PlaceHolder.Controls.Add(lbl);
    this.PlaceHolder.Controls.Add(ddl);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:08:05.390

```
Dim tDropDownList As DropDownList = Nothing
Dim tQuestion As String = String.Empty

For Each tQuestion In tQuestions
    tDropDownList = New DropDownList
    tDropDownList.Name = "someName here"
    tDropDownList.Items.Add("Yes")
    tDropDownList.Items.Add("No")
    Page.Constrols.Add(tDropDownList)
Next 
```

# asp.net - ASP.NET 图表控件（发送带有嵌入式图表控件图像的电子邮件）

> ID：870088
> 
> 赞同：3
> 
> 时间：2009-05-15T18:01:42.067
> 
> 标签：asp.net

我正在使用 asp.net 图表控件，对此我很满意。我的客户现在问我是否可以在我的网页上添加一个电子邮件按钮并发送一封包含图表的电子邮件。任何想法我怎么能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T18:38:54.210

图表组件实际上是在请求图表时生成图像。然后它要么将此图像保存到文件系统中，要么只是将其保存在内存中。那部分是可配置的。

您可以让它生成图表，然后从中获取文件引用。从那里你有两个选择。要么让您的电子邮件通过它的 url 引用来引用文件，要么将其嵌入到实际的电子邮件本身中。这也可以由邮件客户端配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-22T10:53:07.943

您可以将图像保存在某处并加载并嵌入邮件中，如下所示：

```
 private void SendMail()
        {
            //Your mail body is created with help of a StringBuilder which will contain the img tag:
            //Suppose the mailContent is the StringBuilder object and has the html body etc already appended....
            //you would need to append something like following:

            //mailContent.Append("<td><img src=\"cid:IMAGE_ID\"></td>");
            //string body = mailContent.ToString();

            string smtpServer = "mailhost.my.domain.net";
            string emailFrom = "blah.blah@blah.com";
            string emailTo = "yoyo@yoyo.com";

            MailMessage msg = new MailMessage(emailFrom, emailTo, "TestMail...", body);

            msg.IsBodyHtml = true;

            //Adding attachments by loading from file 
            Attachment item = new Attachment("Images/Logo.JPG");
            item.ContentDisposition.Inline = true;
            item.ContentDisposition.DispositionType = DispositionTypeNames.Inline;
            item.ContentId = "IMAGE_ID";
            item.ContentType.MediaType = "image/jpeg";
            item.ContentType.Name = "Logo.JPG";

            msg.Attachments.Add(item);

            SmtpClient client = new SmtpClient(smtpServer);
            client.Send(msg);

        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:27:22.723

您可以存储图表数据并创建指向将加载数据的页面的链接，或者您可以获取创建页面的 HTML 并将其加载到电子邮件中。并非每个用户查看 HTML 都是电子邮件，因此向他们发送指向可以绘制数据图表的页面的链接可能会更安全。

# maven-2 - 是否可以将系统属性传递给 Hudson 运行的单元测试？

> ID：870093
> 
> 赞同：1
> 
> 时间：2009-05-15T18:03:33.840
> 
> 标签：maven-2, hudson

我们正在使用 Maven 2 和 Hudson，一切运行良好。我的问题是可以让 Hudson 使用特定的“-D”参数在特定项目中运行所有单元测试。例如，“mvn test -DlogConfig=qa”。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T18:39:02.883

在项目配置页面中有“构建”部分和“目标和选项”文本字段，您可以在其中放置“-D 参数”和要运行的目标。

# mysql - 如何在非阻塞环境中解决这个 MySQL/Innodb 死锁问题？

> ID：870097
> 
> 赞同：1
> 
> 时间：2009-05-15T18:05:15.100
> 
> 标签：mysql, innodb

我们使用 MySQL 和 Innodb 引擎存储。我们有一个“事件”环境，可以在一个表上发送多个并发请求。基本上，它的工作原理是这样的：我们有一个 find_or_insert 函数可以做到这一点： - find() -> 在结果上，如果为空 -> 插入 -> 在结果上 find()

我们使用的是非阻塞 MySQL 驱动程序，所以基本上，当我们同时启动这个小算法不止一次时，它会在插入第一个结果之前运行所有的发现......等等。

不幸的是，我们收到这些错误：“尝试获取锁定时发现死锁；尝试重新启动事务”

任何人都可以帮忙吗？

[编辑]：另外，我实际上不明白为什么 MySQL 需要锁定表只是为了在这里插入一个新元素。最初我虽然自动增量是这里的罪魁祸首，所以我删除了它......但我仍然得到错误。有没有办法防止 MySQL 在插入时锁定表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T18:33:49.650

尝试[mysql 参考手册](http://dev.mysql.com/doc/refman/5.0/en/innodb-deadlocks.html)进行诊断和解决。听起来您正在制作缓存。一个可能的原因可能是很多客户端同时点击表试图创建“第一个版本”（即点击“如果为空插入”）。也许您可以添加一个伪随机延迟或协调创建者，这样您就不会收到大量对数据库的并发创建调用？

编辑：你看过[这个](http://mysqldatabaseadministration.blogspot.com/2007/06/innodb-table-locks.html)页面吗？似乎您需要设置一个 my.cnf 设置以使用 innodb 禁用每个表的锁。不过，我主要建议的是，您的测试可能无法表示，因为它可能包含比实际情况高得多的作者百分比。如果你用一个空表启动 100 个线程，它们都会在创建时立即阻塞（即使可能是相同的值）。这比在平均情况下要糟糕得多，在这种情况下，您可以更好地分布键、更少的未命中和更高的读取百分比。如果这是预期的行为（即您将拥有此行为），我建议在创建语句中添加退避策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T18:42:26.837

您需要这些请求一次发生一个，因此可能停止使用该非阻塞驱动程序。或者实现你自己的阻塞机制。等待一个完成，然后再进行下一个。

你没有说这是不合理的，或者你出于某种原因需要这些事情这么快地进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:58:35.487

我正在更改我的答案以反映该问题已被修改。现在听起来这只是并发插入的问题，而不是对查找行为的依赖。

据我了解，InnoDB 对插入进行行锁定，您不能将其关闭。但是，您 [edit] 无法使用 INSERT DELAYED。我刚刚读到这在 InnoDB 上不可用。

[http://dev.mysql.com/doc/refman/5.0/en/insert-delayed.html](http://dev.mysql.com/doc/refman/5.0/en/insert-delayed.html)

也许围绕所有写入的显式 LOCK TABLES 将覆盖默认锁定行为。如果在写事件发生的时间间隔内没有对表进行其他操作，这可能会起作用。

[http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html](http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html)

# c# - 通过 C# 进行 Windows 桌面搜索

> ID：870101
> 
> 赞同：5
> 
> 时间：2009-05-15T18:06:05.770
> 
> 标签：c#, sql, search, desktop, wds

我在哪里可以找到有关 WDS 的文档，特别是使用 C# 中的 SQL 查询来查询 WDS？是否有任何资源列出了可以从 SystemIndex 查询的列？此外，我希望查询返回“上下文”，即就像 WDS 客户端对找到搜索词的文档中的几行所做的那样。我使用的是 WDS 4.0，尽管我相信 3+ 的 API 是相同的。我检查了 MSDN 和其他网站，但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T18:21:58.663

这是我用过的资源... [http://msdn.microsoft.com/en-us/library/aa965362(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa965362(VS.85).aspx)

它还说：

“Windows Search 4.0 有新的 SDK 吗？

Windows Search 4.0 的平台与以前版本的 Windows Search 相同。Windows 搜索的示例包含在 Windows Vista SP1 SDK 中。可以在 MSDN 上找到开发与 Windows Search 一起使用的应用程序的文档。”

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:59:02.567

在 MSDN 论坛上发布并得到答案：可以搜索的列或属性：http: [//msdn.microsoft.com/en-us/library/dd561977](http://msdn.microsoft.com/en-us/library/dd561977(VS.85).aspx) (VS.85).aspx 和“摘要”信息 - 不是上下文 [http://msdn.microsoft.com/en-us/library/bb760163(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb760163(VS.85).aspx)

这已经回答了我最初的问题。无论如何，感谢您的回复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:31:30.937

在[Windows Search SDK](http://www.microsoft.com/downloads/details.aspx?FamilyID=645300AE-5E7A-4CE7-95F0-49793F8F76E8&displaylang=en)中，您将找到一个名为 WSSQL 的示例，它使您能够对 WDS 执行 SQL 查询。

# windows - Windows XP/2003 中有类似 Linux ptrace 系统调用的东西吗？

> ID：870103
> 
> 赞同：6
> 
> 时间：2009-05-15T18:06:52.930
> 
> 标签：windows, debugging, ptrace

阅读*[Monitoring certain system calls done by a process in Windows](https://stackoverflow.com/questions/864839/monitoring-certain-system-calls-done-by-a-process)*，我想知道 Windows 是否等同于[ptrace](https://en.wikipedia.org/wiki/Ptrace)系统调用或编程解决方法。

我*[在 Windows 中有类似 Linux ptrace 系统调用的东西吗？](https://stackoverflow.com/questions/865106/is-there-something-like-linux-ptrace-syscall-in-windows)*，但它需要最新的 Windows 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T20:38:53.260

[Process Monitor](http://en.wikipedia.org/wiki/Process_Monitor)是用于执行此操作的[Sysinternals](https://en.wikipedia.org/wiki/Sysinternals)实用程序。

# vsto - VSTO Infopath 表单安全问题

> ID：870107
> 
> 赞同：0
> 
> 时间：2009-05-15T18:09:53.263
> 
> 标签：vsto, infopath

我有一个 VS2008 项目 - 一个 Office 2007 InfoPath 表单自定义，后面有一些代码。我已经运行发布向导来创建一个 msi 安装。它只会被已经安装了所有基本组件（框架、VSTO 运行时）的开发人员（部署模板）使用。

我已经阅读了我能找到的所有安全文档，但似乎没有什么特别适用于我的情况。

当后面的代码在运行安装的机器上执行时，这是错误：

```
System.Security.SecurityException
Request failed.
at Microsoft.Office.InfoPath.MsxmlNavigator.IsValidNode(MsxmlNode test)
at Microsoft.Office.InfoPath.MsxmlNavigator.MoveToFirstChild()
-- one of my calls
at System.Xml.XPath.XPathNavigator.MoveToChild(String localName, String namespaceURI)
-- more of my code follows 
```

由于这是我正在运行的代码，这告诉我安全性与我认为加载的自定义 .dll 无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-06T18:07:43.740

我遇到了同样的错误，但我通过更改 InfoPath 表单上的安全级别来修复它。

工具>>表单选项>>安全和信任

我清除了“自动确定...”的复选框并将表单设置为完全信任，并添加了一个证书。

当然，出于开发目的，证书是自签名的，我非常怀疑当我将表单发布到 SharePoint 网站时它会飞起来（明天要处理的事情......或者今天如果我走得那么远......）

# css - 由于似乎有升级推送，我们能否少担心 IE 6 问题？

> ID：870109
> 
> 赞同：4
> 
> 时间：2009-05-15T18:10:05.527
> 
> 标签：css, internet-explorer-6, internet-explorer-8, internet-explorer-7

我注意到在我的 Vista 和 XP 机器上，自动更新要求我升级到 IE 8（从 IE 7）。新闻文章还说，使用 IE 6 的人也会得到这样的建议。

[http://news.cnet.com/8301-13860_3-10218185-56.html](http://news.cnet.com/8301-13860_3-10218185-56.html)

（除了可能与零售版不同的 XP 虚拟机版本外，我的任何机器上都没有 IE 6，这真的发生了吗？）

因此，当我们查看网站日志统计信息并看到 IE 6 下降到 2 或 3% 以下时，可能会减少对 IE 6 错误的担忧。

（顺便说一句，如果运行新的更重的 IE 8，运行 IE 6 的机器会不会太慢？）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T18:17:09.720

您不能依赖一般统计数据，您需要查看自己的特定客户群。可能仍然存在他们暂时不会升级的企业环境，因为他们有依赖于浏览器版本的旧 Web 应用程序，或者只是不会节省人力来协调升级。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-15T18:14:58.977

我们目前的方法是“让它在 IE6 中基本上可以正常工作，但如果事情有时看起来有点奇怪，请不要担心”。

2-3% 仍然是一个不错的数字，而我的行业（报纸）不能再失去更多的眼球，所以我们不能完全放弃支持——就像我们愿意的那样！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-15T18:14:46.920

是的，你可以少担心。但我不建议你完全不用担心。由于与内部系统的兼容性问题，有些公司仍在使用 IE6。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T18:13:41.883

这真的取决于你的听众是谁。检查您的访客统计数据并确定您认为合适的内容。一些站点已经开始逐步淘汰 IE6，例如[37signals](http://37signals.blogs.com/products/2008/07/basecamp-phasin.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T18:44:21.717

如果您的目标受众是“一般的互联网”，那么我会喜欢 Facebook，并礼貌地告诉您的 IE6 用户升级的时间...... IE8 可用，甚至是 Google Chrome、Firefox、Safari 等。

如果您的最终用户正在为您的服务**付费**……请注意您推动他们的程度。

说了这么多，到**2010 年**我计划逐步取消对 IE6 的所有支持。另外，我今天构建的***新应用******根本不支持 IE6***。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T18:14:37.730

我想你回答了你自己的问题。

> 因此，当我们查看网站日志统计信息并看到 IE 6 下降到 2 或 3% 以下时，可能会减少对 IE 6 错误的担忧。

关键点是，如果您的“相当大”百分比的受众仍在使用 IE6，您不希望疏远您的用户。它绝对应该根据具体情况而定，因此决定的关键依据应该是特定网站的客户使用统计数据。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T18:27:51.990

查看w3school的[浏览器使用统计信息。](http://www.w3schools.com/browsers/browsers_stats.asp)即使 ie6 的使用率正在下降，即使 w3school 仅代表一部分互联网用户，该网站上仍有 15% 的用户在使用 IE6。

显然，您自己网站的统计数据可能高于或低于该百分比。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T18:52:20.887

我认为查看您的日志并选择一些您可以惹恼的人是正确的方法。你是唯一能说你的用户中有 2-3% 的人是否是正确数字的人。只要确保你在这 2-3% 中没有高比例的有价值用户，你会没事的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T19:42:41.140

我在 XP 上使用 IE6（用于 dogfooding - 我开发需要支持它的应用程序），并且 Windows 更新没有要求我升级到 IE8。

但是，我可能在某些时候被要求升级到 IE7 并选中“不，不要再问我”框。我不知道 IE8 升级过程是否会尊重该决定。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-18T14:18:05.943

我发现对于我设计的大多数网站来说，使用 IE7-js [http://code.google.com/p/ie7-js/就足够了](http://code.google.com/p/ie7-js/)

这修复了大多数位置错误，增加了对大多数 CSS 2.1 的支持，并一并修复了 IE6 损坏的 png 实现。精彩绝伦，无以言表。

要使用该脚本，只需将其添加到您的 HEAD（或下载并在本地使用）：

```
<!--[if lt IE 8]><script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE8.js" type="text/javascript"></script><![endif]--> 
```

如果你有透明的 PNG 重命名它们 originalname-trans.png 并且脚本会给它们适当的 alpha 支持。

# c++ - 在 vs2008 中使用 CurlPP

> ID：870110
> 
> 赞同：10
> 
> 时间：2009-05-15T18:10:26.150
> 
> 标签：c++, visual-studio-2008, curl, curlpp

我正在尝试使用静态 curlpp 库在 VS2008 中构建 C++ 控制台应用程序。代码 - curlpp example 00 - 如下：

```
#include "stdafx.h"

#include <curlpp/curlpp.hpp>
#include <curlpp/Easy.hpp>
#include <curlpp/Options.hpp>

using namespace curlpp::options;

int main(int, char **)
{
  try
  {

    // Our request to be sent.
    curlpp::Easy myRequest;

    // Set the URL.
    myRequest.setOpt<Url>("http://example.com");

    // Send request and get a result.
    // By default the result goes to standard output.
    myRequest.perform();
  }

  catch(curlpp::RuntimeError & e)
  {
    std::cout << e.what() << std::endl;
  }

  catch(curlpp::LogicError & e)
  {
    std::cout << e.what() << std::endl;
  }

  return 0;
} 
```

我已经下载了源代码并让我的包含路径指向了源包含文件，但是当我尝试编译时，我在以下类型的内联文件中得到了一大堆错误：

不允许定义 dllimport 函数

肯定有很多人在 vs2008 中使用过 curlpp，但我遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T16:28:47.570

查看*\include\curlpp\internal\buildconfig.h*文件，其中定义了以下宏

```
CURLPPAPI
CURLPP_INCLUDE_TEMPLATE_DEFINITIONS
CURLPP_TEMPLATE_EXPLICIT_INSTANTIATION 
```

基于这三个宏的值

```
CURLPP_STATICLIB
BUILDING_CURLPP
CURLPP_SELF_CONTAINED 
```

*在README.win32*文件中阅读它们并相应地定义上述三个宏。
如果您仍有问题，请告诉我们。

顺便一提; 今天我把当前版本的 curlpp 用于下载 [curlpp-current.2009.05.21](http://curlpp.googlecode.com/files/curlpp-current.2009.05.21.zip)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-27T06:29:44.740

除了 Piotr 的回答：不要忘记相应地构建 libcurl 本身 - 动态或静态并在 CURLPP_STATICLIB 旁边定义 CURL_STATICLIB （当然，如果构建静态版本）。在旁注中：我绝对不喜欢 CURLPP，很难理解如何让它做我需要的。您可能希望将纯 libcurl 与您自己的包装器一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T21:23:31.147

通常人们在尝试#include 定义了库的“EXPORT”宏的库的头文件时会收到此错误。curlpp 必须有一些宏，通常可以在如下代码中找到：

```
#ifdef NATIVEDLL_EXPORTS
#define NATIVEDLL_API extern "C" __declspec(dllexport)
#else
#define NATIVEDLL_API __declspec(dllimport)
#endif 
```

并且您在预处理器中定义了 NATIVEDLL_EXPORTS。删除此定义。ppcurl 不会被称为“NATIVEDLL_EXPORTS”，它会有自己的名字。

# jquery - 需要帮助制作标签以供 jquery 标签插件使用

> ID：870114
> 
> 赞同：1
> 
> 时间：2009-05-15T18:12:27.220
> 
> 标签：jquery, css, tabs

我对 CSS 完全陌生，无法制作标签。我们目前有这样的标签[但是](http://tinypic.com/r/28rk54y/5)，这些标签是使用看起来很糟糕的`<table>`标签制作的

以下是在上述链接中生成图像的代码

```
 <table name="incomesummarytable" cellpadding="0" cellspacing="0" border="0" width="100%">
     <tr>
  <td colspan="4">
       <table border="0" cellpadding="0" cellspacing="0">
        <tr>
         <td bgcolor="#990000"><img src="/eiv/images/left_curve.gif" alt="Left Curve" width="10" height="20"></td>
         <td bgcolor="#990000"><div align="center"><font face="Verdana" size=2 color="#ffffff"><b>Summary Reports</b></font></div></td>
         <td align="right" bgcolor="#990000"><img src="/eiv/images/right_curve.gif" alt="Right Curve" width="10" height="20"></td>
         <td>&nbsp;</td>
         <td bgcolor="#dddddd"><img src="/eiv/images/left_curve.gif" alt="Left Curve" width="10" height="20"></td>
         <td bgcolor="#dddddd"><div align="center"><a href="javascript:submitData('View Detail Reports');" style='text-decoration: none;'><font face="Verdana" size=2 color="#000000"><b>Detail Reports</b></font></a></div></td>
         <td align="right" bgcolor="#dddddd"><img src="/eiv/images/right_curve.gif" alt="Right Curve" width="10" height="20"></td>
         <td>&nbsp;</td>
        </tr>
       </table>
      </td> 
```

但是，我正在尝试使用更优雅的[jquery tabs](http://stilbuero.de/jquery/tabs/)插件方法。此插件将 div 更改为选项卡。所以我试图找出如何将我拥有的选项卡转换为 div，以便我可以将它们与 jquery 选项卡插件一起使用。
我会很感激一些帮助，至少能让我开始做这件事。

理想情况下，我希望 html 尽可能简单

```
 <div id="container-1" bgcolor="#990000">
        <ul>
            <li ><a href="#fragment-1"><span>Summary</span></a></li>
            <li ><a href="#fragment-2"><span>Detailed</span></a></li>
        </ul>
        <div id="fragment-1">
            <p>Summary Info goes here:</p>
        </div>
        <div id="fragment-2">
            <p>Detailed Info goes here:</p>
        </div> 
   </div> 
```

但我不能把我的头放在能做到这一点的 CSS 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T20:59:49.363

你检查过 jquery-ui 吗？jquery-ui 站点上有很好的示例和文档：http: [//jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)。

你最终得到的 html 看起来像这样：

```
<div id="tabs">  
<ul>  
    <li><a href="#tabs-1">Text 1</a></li>  
    <li><a href="#tabs-2">Text 2</a></li>  
    <li><a href="#tabs-3">Text 3</a></li>  
</ul>  
<div id="tabs-1">Content Tab 1</div>  
<div id="tabs-2">Content Tab 2</div>  
<div id="tabs-3">Content Tab 3</div>  
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T18:27:38.213

请参阅 Doug Bowman 的[滑动门技术](http://www.alistapart.com/articles/slidingdoors/)教程，以轻松理解标记、CSS 及其背后的推理。

A List Apart 通常是一个很好的资源。你也会在那里找到其他很棒的 CSS 技术文章。

# python - 帮助将 PYTHON 翻译成 VB.NET

> ID：870116
> 
> 赞同：0
> 
> 时间：2009-05-15T18:13:27.763
> 
> 标签：python, vb.net, multithreading, translation

我正在用 VB.NET 编写一个发送短信的应用程序。

您能否发布 此代码和/或指南的**PYTHON->VB.NET翻译？**

提前致谢！！！

```
import threading
class MessageThread(threading.Thread):
    def __init__(self,msg,no):
        threading.Thread.__init__(self)
        self.msg = msg  # text message
        self.no  = no   # mobile number
    def run(self):
        # function that sends "msg" to "no"
        send_msg(msg,no) 

# records of users are retrived from database 
# and (msg,no) tuples are generated
records = [(msg1,no1),(msg2, no2),...(msgN,noN)] 

thread_list = []

for each in records:
    t = MessageThread(each)
    thread_list.append(t)

for each in thread_list:
    each.start()

for each in thread_list:
    each.join() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T19:00:01.053

此代码为每个 msg/no 元组创建一个线程并调用 sendmsg。第一个“for each ... each.start()”启动线程（仅调用 sendmsg），第二个“for each ... each.join()”等待每个线程完成。根据记录的数量，这可能会创建大量线程（如果您发送 1000 条 SMS 记录会怎样），尽管它是异步的，但不一定有效。

代码相对简单且 Pythonic，而对于 .NET，您可能希望使用[ThreadPool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool(VS.80).aspx)或[BackgroundWorker](http://msdn.microsoft.com/en-us/library/8xs8549b.aspx)来执行 sendmsg 调用。您将需要创建一个等效于元组 (msg,no) 的 .NET 类，并且可能将 sendmsg() 函数放在类本身中。然后创建 .NET 代码以加载消息（Python 代码中未显示）。通常，您也会使用通用 List<> 来保存 SMS 记录。然后 ThreadPool 会将所有项目排队并调用 sendmsg。

如果您试图保持代码与原始 Python 相同，那么您应该查看[IronPython](http://www.ironpython.com/)。

（sendmsg 中的下划线导致文本使用斜体，所以我在回复中删除了下划线。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T18:31:12.480

这是 IronPython 代码（“Python for .NET”），因此源代码使用 .NET 框架，就像 VB 一样，所有类（甚至[System.Threading.Thread](http://msdn.microsoft.com/en-us/library/system.threading.thread.aspx)）都可以以与所示相同的方式使用。

一些技巧：

`MessageThread`派生自`Thread`，`msg`并且`no`必须声明为类变量，`__init__`是构造函数，`self`成员函数中的 -parameter 不会转码为 VB（只需将其省略）。使用`List<Thread>`for`thread_list`并为 中的元组定义一个小结构`records`。

# c# - 如何在 ac# windows 应用程序中实现“第二个鼠标光标”？

> ID：870124
> 
> 赞同：1
> 
> 时间：2009-05-15T18:15:23.220
> 
> 标签：c#, .net, mouse, mouse-cursor

我实际上不希望它成为“真正的”鼠标光标，即不需要单击按钮、选择文本等。它应该看起来像一个光标（或有点像它）并且能够在应用程序的窗口（无需外出）。它将由计算机控制，在此期间用户应该能够像往常一样使用鼠标。

做这样的事情有什么好方法？如何制作一个可以以编程方式在窗口中移动的浮动实体？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T18:17:04.060

如果它是一个表单应用程序，只需创建一个 PictureBox，加载一个具有透明背景的鼠标光标图形，然后在表单周围移动它即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-06T03:29:51.660

如果这是一个 WPF 应用程序，那么您可以这样做： 在您的显示器上放置一个 Canvas 对象。添加鼠标光标的图像作为画布的子项。在图像上设置 Canvas.Left 和 Canvas.Top 属性以移动它。设置图像的 ZOrder，使其显示在所有其他控件之上。

你没有说如何确定行动。如果是根据脚本，那么 WPF 可以通过多种方式为您处理运动的时间。否则，您可以通过响应计时器的任何方式更新位置。

等一下。我才注意到这是十个月前发布的。

那么你最终做了什么？:)

# java - Checkstyle 和 Eclipse；Java 字符串延续

> ID：870126
> 
> 赞同：5
> 
> 时间：2009-05-15T18:15:46.730
> 
> 标签：java, eclipse, checkstyle

（我知道这是一个懒惰的问题，但奇怪的是很难搜索......特别是因为 checkstyle 做了这么多，而且谷歌搜索结果中充斥着 checkstyle 报告。）

在Java中将长字符串拆分为多行时，有人可以告诉我哪个checkstyle检查报告“+应该在新行上”吗？

顺便说一句，[这个 SO 问题](https://stackoverflow.com/questions/257251/eclipse-shortcut-to-split-long-strings)以一种迂回的方式询问是否有任何方法让 Eclipse 在为您拆分字符串时将“+”符号放在新行上。有没有简单的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-15T18:31:09.080

[**操作员换**](http://checkstyle.sourceforge.net/config_whitespace.html#OperatorWrap)行检查可能负责“+ 应该在新行”消息。
它位于“空白”部分。

> 如果有任何方法可以让 Eclipse 在为您拆分字符串时将“+”符号放在新行上。有没有简单的方法？

我知道的唯一方法是*格式化*刚刚生成的代码：
当您`return`在 a 中间点击 " " 时`String`，它会`+`在第一行的末尾输出 ' '。但是你格式化代码，它确实在第二个开头
放回' '。`+`

由于您只能格式化您所在的*部分*（如您正在编辑的当前方法），因此该提示并不意味着您将在任何时候将所有类都格式化，并将 ' `+`' 放在正确的位置。只有当前的代码块。
（它是命令“格式元素”，默认没有快捷键，所以你可以指定一个）

# java - 如何使用 Java 中的正则表达式提取此字符串？

> ID：870127
> 
> 赞同：2
> 
> 时间：2009-05-15T18:15:54.560
> 
> 标签：java, regex

```
errorString="AxisFault\n
 faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.generalException\n
 faultSubcode: \n
 faultString: My Error\n
 faultActor: \n
 faultNode: \n
 faultDetail: \n
    {}string: this is the fault detail"

Pattern pattern = Pattern.compile(".*faultString(.*)", Pattern.DOTALL);
Matcher matcher = pattern.matcher(errorString);
if (matcher.matches()) {
   String match = matcher.group(1);
   return match;
} 
```

我想得到“我的错误”，但它返回到整个字符串的末尾，而不是匹配到 faultString 行末尾的 \n。我尝试了很多技术让它在行尾停止，但没有成功。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T18:21:30.337

你不应该通过[`Pattern.DOTALL`](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html#DOTALL)；这会导致换行符与 匹配`.*`，这正是您*不*想要的。

更好的正则表达式是：

```
Pattern pattern = Pattern.compile("faultString: (.*)"); 
```

然后，而不是`matcher.matches()`，用于[`find()`](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#find())查看它是否出现在字符串中的任何位置。

另请注意，我已将正则表达式修改为仅对“我的错误”部分进行分组，而不是像原来的那样对“：我的错误”部分进行分组。

为了清楚起见，这是我测试的代码：

```
Pattern pattern = Pattern.compile("faultString: (.*)");
Matcher matcher = pattern.matcher(errorString);
if (matcher.find()) {
    System.out.println(matcher.group(1));
} 
```

哪里`errorString`和你一样。
输出是：

```
我的错误
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T18:37:41.700

我可能会将 Chris 的正则表达式清理为以下内容：`".*faultString:\\s*([^\\n]*).*"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T18:22:52.360

```
Pattern pattern = Pattern.compile("^faultString(.*)$", Pattern.MULTILINE); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T18:27:05.267

这看起来像属性文件格式。将此字符串加载到`java.util.Property`使用中`StringReader`然后从中读取会更容易吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T18:29:37.523

这适用于 .matches() 方法：

```
Pattern pattern = Pattern.compile(".*faultString([^\\n]*).*", Pattern.DOTALL); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T19:05:10.073

请记住，正则表达式的东西很昂贵。切坦的想法是正确的。

这是一些示例代码-

```
 String errorString = "AxisFault\n"
            + "          faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.generalException\n"
            + "          faultSubcode: \n" 
            + "          faultString: My Error\n"
            + "          faultActor: \n" 
            + "          faultNode: \n"
            + "          faultDetail: \n"
            + "                 {}string: this is the fault detail";

    Properties p = new Properties();
    ByteArrayInputStream bis = new ByteArrayInputStream(errorString
            .getBytes());

    try {
        p.load(bis);
    } catch (IOException e) {

    }

    System.out.println(p.toString());
    System.out.println(p.getProperty("faultString")); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T19:21:46.463

也许[getFaultString](http://ws.apache.org/axis/java/apiDocs/org/apache/axis/AxisFault.html#getFaultString())？:)

编辑：或 ((AxisFault) exception.getRootCause()).getFaultString()。我只是认为您可能忽略了一个事实，即您可以直接从 AxisFault 本身获得它。

# nhibernate - 生成业务密钥

> ID：870130
> 
> 赞同：2
> 
> 时间：2009-05-15T18:17:03.170
> 
> 标签：nhibernate

为业务密钥生成唯一编号的最佳方法是什么？

在下面的示例中，我们的客户想要一个他们可以用来指代订单的数字 (OrderNumber)。

```
<class name="Order">
  <id name="Id" ... />

  <property name="OrderNumber" column="order_number" />

</class> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T14:03:31.320

我发现执行这些任务的最佳方法是将它们编写在代码中，而不是将它们泄漏到数据层中。我不让 NHibernate 计算它。我将此概念视为应用程序的成熟功能。这很好，因为我可以为它编写测试并且具有灵活性。有时在计算下一个序列号时还涉及其他因素，例如与另一个实体的关系。也许您想要客户端范围内的连续订单号：客户端 02 为 02-001、02-002，客户端 01 为 01-001、01-002。

因此，我将 SequneceNumber 的概念推广到域模型对象，将其与 NHibernate 映射并在我这边执行逻辑。每当我需要一个新的时，我都会使用一个看起来像的界面

```
public interface ISequenceRepository
{
    string GetNextSequenceNumber(Customer customer);
} 
```

它管理数据库表中一条记录（每个客户）中的当前序列号。每当我调用此函数时，它都会增加数据库中的占位符并返回值。

工厂依赖于这个接口并使用它来构建需要序列号的对象。

# wpf - WPF：如何将鼠标事件附加到视图模型？

> ID：870137
> 
> 赞同：5
> 
> 时间：2009-05-15T18:19:23.680
> 
> 标签：wpf, events, mvvm, datatemplate

我第一次尝试使用 MVVM 模式。所以我有一个`ItemsControl`填充了我的视图模型对象，使用`DataTemplate`'s;显示。`DataTemplate`对象是用`Thumb`和对象表示的“节点”和“边缘” `Polyline`，我希望能够检测到点击和拖动`ItemsControl`以移动节点和边缘。

两个问题：

*   如何将鼠标事件处理程序附加到`Polyline`' 和`Thumb`' 以由小视图模型处理？（我可以将`Thumb.DragDelta`处理程序附加到`ItemsControl`并`e.OriginalSource`指向`Thumb`，但是如何获取相应的视图模型对象？）
*   如何将鼠标事件处理程序附加到`ItemsControl`以检测鼠标单击和拖动空白空间？（答案如下）

注意：我知道如果它直接处理 View 的事件，它可能不被认为是合适的 ViewModel。但重要的一点是，我需要处理鼠标事件，我不知道如何附加它们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T21:55:39.260

我找到了一种方法来处理由 DataTemplate 中的对象引发的事件。

(1) 将事件处理程序附加到 ItemsControl

```
<ItemsControl x:Name="_itemsControl" 
              Thumb.DragStarted="Node_DragStarted"
              Thumb.DragDelta="Node_DragDelta"
              Thumb.DragCompleted="Node_DragCompleted"
              MouseDoubleClick="OnMouseDoubleClick"
              .../> 
```

（2）找出事件适用于哪个item，把OriginalSource当作一个FrameworkElement，获取它的DataContext：

```
void Node_DragStarted(object sender, DragStartedEventArgs e)
{
    var os = (FrameworkElement)e.OriginalSource;
    var vm = os.DataContext as ItemViewModel;
    if (vm != null)
        // do something with the item ViewModel
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T02:04:18.943

ViewModel 应该与 GUI 断开连接，因此它对控件或鼠标点击一无所知。

两种选择：

*   按照 Thomas 的建议，在 ViewModel 中调用命令
*   将拇指的位置绑定到 ViewModel 中的一个属性，然后当控件在 WPF 中移动时会更新 ViewModel 中的位置值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T19:51:32.023

我想出了第二个问题的答案。我需要一个支持滚动的 ItemsControl，并且我需要将项目放在网格上而不是默认的 StackPanel 上。为了满足这两个要求，我使用了 ControlTemplate：

```
<!--In the resources...-->
<ControlTemplate x:Key="GraphTemplate" TargetType="ItemsControl">
    <ScrollViewer Name="ScrollViewer"
                  Padding="{TemplateBinding Padding}"
                  HorizontalScrollBarVisibility="Auto">
        ...
            <Grid Name="Panel" IsItemsHost="True"
                  Background="{TemplateBinding ItemsControl.Background}"/>
        ...
    </ScrollViewer>
</ControlTemplate>
<!--Later...-->
<ItemsControl x:Name="_itemsControl" 
              ItemsSource="{Binding Items}"
              Template="{StaticResource GraphTemplate}"
              Background="LightYellow"/> 
```

为了获得具有有意义的鼠标坐标（即可滚动空间中的坐标）的鼠标事件，有必要使用一个奇怪的咒语来获得对网格的引用：

```
Grid grid = (Grid)_itemsControl.Template.FindName("Panel", _itemsControl); 
```

然后将事件处理程序附加到网格，并在鼠标事件处理程序内，使用网格获取鼠标坐标

```
Point p = e.GetPosition((IInputElement)sender); 
```

为了在整个表面上获取鼠标事件，控件（实际上是网格）必须有背景，所以我在上面设置了 Background="LightYellow"，它通过 ControlTemplate 中的绑定传播到网格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T23:04:41.713

有一些方法可以在没有代码隐藏的情况下做到这一点......

您可以使用附加的行为模式将事件映射到命令，请[在此处查看 Marlon Grech 的实现](http://marlongrech.wordpress.com/2008/12/13/attachedcommandbehavior-v2-aka-acb/)

您还可以使用我编写的[标记扩展](http://www.thomaslevesque.com/2009/03/17/wpf-using-inputbindings-with-the-mvvm-pattern/)将 InputBindings 绑定到 ViewModel 命令，如下所示：

```
<UserControl.InputBindings>
    <MouseBinding Gesture="LeftClick" Command="{input:CommandBinding SomeCommand}"/>
</UserControl.InputBindings> 
```

但是我不确定它是否适合您的特定需求...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T16:43:58.530

Bea Stollnitz 有一个拖放示例，标题为“如何在数据绑定的 ItemsControls 之间拖放项目？”。我会发布链接，但 StackOverflow 不允许我这样做。

您可能希望在拖动过程中拆分 UI 反馈以及最终拖放时执行的操作。

然而，我同意上面的托马斯和卡梅伦。您需要限制事件处理和数据绑定的混合/匹配。如果您要走事件处理路线，您可能不想避免为您的对象使用术语“视图模型”，因为它通常表示数据绑定替代方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-02T16:11:48.190

我正在使用一种更优雅的方法。我使用 Prism 2 和数据模板。所以我所做的是：

```
<ItemsControl x:Name="SearchImagesList" ItemTemplate="{StaticResource SearchResultsAlbum}" 
```

在 ItemTemplate 中，我刚刚在里面创建了一个按钮！

```
<DataTemplate x:Key="SearchResultsAlbum">                        
    <Button CommandParameter="{Binding}"                 
            Command="{Binding Source={x:Static PhotoBookPRMainModule:ServiceProvider.DesignEditorViewManager}, Path=NavigationCommands.NavigateSearchResultAction}"> 
```

# c++ - 静态链接的非托管库和 C++ CLR

> ID：870138
> 
> 赞同：1
> 
> 时间：2009-05-15T18:19:29.340
> 
> 标签：c++, clr

是否可以在 C++ CLR 中使用使用 /MT 编译的库？它会抛出大量 LNK2022“元数据操作失败 (8013118D)”错误（如果我在 CLR 项目中使用 /MD）或“'/MT' 和 '/clr:pure' 命令行选项不兼容”如果我使用 /MT。

我需要在图书馆改变什么？该库是我的，但它包括几个第三方静态库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-10T20:56:17.943

LNK2022 很难确定。这通常意味着影响结构布局的模块配置之一与其他模块配置不同。

检查以下常见原因：

*   确保您的所有项目都为您当前的解决方案配置使用相同的运行时库（/MDd 或 /MD）。如果一个项目正在使用 Debug 而其他项目正在使用 Release，反之亦然，您将收到 LNK2022 错误。
*   确保您的所有项目都使用相同的结构成员对齐方式。如果一个项目正在使用 /Zp 开关，请特别注意。另外，请确保您不要有条件地使用#pragma pack(n)。

您可以使用 /d1reportSingleClassLayout_your-class-name_（不带空格）来获取有关有问题的类的布局的信息。

有关详细信息，请参阅：[诊断 Visual C++ 中的隐藏 ODR 违规](http://blogs.msdn.com/vcblog/archive/2007/05/17/diagnosing-hidden-odr-violations-in-visual-c-and-fixing-lnk2022.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-15T17:05:16.247

我发现混合使用不同 crt 运行时版本编译的本机代码静态库的唯一方法是编写一个充当库之间桥梁的 DLL。例如：

your.exe - 使用 /MD 和 clr 编译 yourbridge.dll - 本机，使用 /MT 编译并包括使用 /MT 构建的所有第 3 方库。

# function - PowerShell 中的函数参数

> ID：870141
> 
> 赞同：15
> 
> 时间：2009-05-15T18:21:37.823
> 
> 标签：function, powershell, parameters

是否有任何理由在函数定义中使用“Param(...)”构造？

我的理解是您应该使用它来指定脚本（和脚本块）的参数。我在网上看到很多示例都以这种方式列出参数，而不仅仅是在函数名之后列出参数。

例子：

```
function Foo([string]$Bar){
   #Body of function
} 
```

或者，

```
function Foo{
     Param([string]$Bar)

} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-15T21:36:57.603

在 V1 中，这实际上只是一种偏好。使用该`param`语句传统上更正式，但在功能上它是相同的。

您可能会在 PowerShell V2 中看到更多地使用 PARAM，因为它能够向参数添加属性，类似于 C# 中的属性。

```
param
(
[Parameter( Mandatory=$true,
            Position=0,
            ValueFromPipeline = $true,
            ValueFromPipelineByPropertyName = $true)]
[Alias("name")]
[String]
$path
) 
```

在这里，您可以指定参数属性和该属性的一堆参数。您还可以指定别名和许多其他验证要求。

基思也提出了一些重要的观点。您可以使用 param 语句将参数传递给匿名脚本块（[lambda 表达式](https://en.wikipedia.org/wiki/Anonymous_function)）或 PS1 脚本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T03:33:22.223

param() 需要为脚本文件和脚本块指定参数：

```
PS> $sb = {param($x,$y) $x + $y}
PS> &$sb 1 3
4 
```

让它也可用于传统功能只是 IMO 的一致性问题。对于每个参数往往有很多包袱，呃元数据的高级功能来说，它更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T19:12:24.533

可能作为一致性度量？始终以相同的方式指定参数可以提高可读性。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-11-23T07:40:39.990

Param 是一个函数，用于提取传递给程序的表单变量的值（可以是[Perl](http://en.wikipedia.org/wiki/Perl)或任何可能使用[CGI](http://en.wikipedia.org/wiki/Common_Gateway_Interface)的脚本语言）。

例如，在[XHTML](http://en.wikipedia.org/wiki/XHTML)表单中，当您使用输入元素（标签）并将类型指定为“文本”时，您还将使用名为“名称”的参数。name 被赋予一个值，比如 num，这个值应该是`param`函数的参数，以便它可以提取用户在表单的文本框中输入的值。

# mysql - MySQL Trigger based Audit logging with comparisons

> ID：870142
> 
> 赞同：0
> 
> 时间：2009-05-15T18:21:41.567
> 
> 标签：mysql, logging, comparison, triggers, audit

在查看类似的问题时：

[获取触发器以仅在审计表中插入更改的列值](https://stackoverflow.com/questions/740182/getting-trigger-to-insert-changed-column-values-only-in-audit-table)

[审计日志策略](https://stackoverflow.com/questions/617225/audit-logging-strategies)

我想更进一步，比较更新的数据，看看它是否真的更新了……我不确定这是否理想（性能方面）。

背景：

我们有一些由用户定期更新的数据。

当这些数据更新时，我想将他们提交的内容与已经存在的内容以及他们提交的内容进行比较，以确保发生了变化。

如果发生更改，请继续将审计条目写入中央审计​​历史表，概述更改的字段。

想法/想法？我尽力搜索，但运气不佳。如果它是重复的，我很乐意删除这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T18:57:12.013

您可以编写一个`BEFORE UPDATE`触发器，在其中使用触发器中的`OLD`和`NEW`别名来比较更新前记录中可用的值与您正在更新的值。根据比较结果，您可以将条目写入审计表。

# apache-flex - 将为 Flash 10 编译的 SWF 加载到 Flash 9 SWF

> ID：870146
> 
> 赞同：1
> 
> 时间：2009-05-15T18:22:04.047
> 
> 标签：apache-flex, flash, actionscript-3, flash-10

这可能吗？我想要一个主 swf 可供安装了 flash 9 或 flash 10 的用户查看。在这个 swf 内部，将只为安装了 flash 10 的用户加载一个单独的模块。此模块将使用一些高级 flash 10 功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T02:10:51.103

当然，正如您所描述的那样，这应该可以正常工作。在 Flash 9 中创建您的基础 SWF，进行版本检查，并可选择加载另一个发布为 10 的 SWF。Flash 将呈现 v10 SWF 中的高级功能，无论加载到哪个 SWF 版本。

请记住，版本是作为字符串返回的，所以一定要`parseInt`对它做 a 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-29T02:14:37.377

除非您尝试在 Flash 10 SWF 中使用 Flash 10 特定库，否则这应该可以正常工作，这可能就是您正在做的事情。我刚刚尝试过，但 Adob​​e 再次对他们的 Flash/Flex 库设计和质量感到失望。

例如，我试图做以下事情

我有一个 Flash 9 基础 SWF，如果用户的 Flash Player 为 10 或更高版本，它将加载一个 Flash 10 模块。此 Flash 10 模块最终使用 Flash 10 特定库，例如：1) flash.net.NetStreamPlayOptions 2) flash.net.NetStreamPlayTransitions 3) NetStream.play2 不幸的是，当我这样做时，Flash 运行时抱怨没有这样的库NetStreamPlayOptions、NetStreamPlayTransitions 和 NetStream.play2。我试图通过复制 NetStreamPlayOptions 和 NetStreamPlayTransitions 来解决这个问题，这让我走得更远，但不幸的是，即使我将 NetStream 实例转换为对象，我也无法调用 NetStream.play2。

I believe it works like this because the base SWf, which is Flash 9, uses the playerglobal.swc, intended for Flash 9\. When it loads up the Flash 10 SWF, it still ends up using the Flash 9 playerglobal.swc because the environment was initialized for Flash 9, which causes problem with the Flash 10 SWF. I have yet to find a way around this.

When Flash was switching from AS1 -> AS2 -> AS3, it made sense why it wasn't backwards compatible, but now AS3 cannot always load AS3, which in my opinion is very disappointing.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T19:50:41.213

自从我不开发 Flash 应用程序以来已经有很长时间了，但是……这些是我的 2 美分：

您可能必须将主 Flash 编译为 10，由于升级警告，这可能是一个问题。

这是一个可能的解决方法： [http ://codeofdoom.com/wordpress/2009/02/09/compiling-to-flash-10-requiring-flash-9/](http://codeofdoom.com/wordpress/2009/02/09/compiling-to-flash-10-requiring-flash-9/)

完成之后，我认为就像你说的那样，检测闪存版本和加载不同的 swf 模块很容易。

# java - 在 /* 上映射全局前端控制器 servlet 时如何访问静态资源

> ID：870150
> 
> 赞同：60
> 
> 时间：2009-05-15T18:23:39.643
> 
> 标签：java, servlets, resources

我已将 Spring MVC 调度程序映射为`/*`.

```
<servlet>       
  <servlet-name>home</servlet-name>         
  <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>     
</servlet>  
<servlet-mapping>       
  <servlet-name>home</servlet-name>         
  <url-pattern>/*</url-pattern>     
</servlet-mapping> 
```

但是，此映射会阻止对文件`/res/`夹中所有静态文件（如 CSS、JS、图像等）的访问。

无论如何，我怎样才能访问它们？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2010-08-29T04:27:00.403

将控制器 servlet 映射到更具体的`url-pattern`like `/pages/*`，将静态内容放在特定文件夹中，`/static`并创建一个`Filter`监听`/*`，透明地继续任何静态内容的链，并将请求分派到控制器 servlet 以获取其他内容。

简而言之：

```
<filter>
    <filter-name>filter</filter-name>
    <filter-class>com.example.Filter</filter-class>
</filter>
<filter-mapping>
    <filter-name>filter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<servlet>
    <servlet-name>controller</servlet-name>
    <servlet-class>com.example.Controller</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>controller</servlet-name>
    <url-pattern>/pages/*</url-pattern>
</servlet-mapping> 
```

在过滤器中使用以下内容`doFilter()`：

```
HttpServletRequest req = (HttpServletRequest) request;
String path = req.getRequestURI().substring(req.getContextPath().length());

if (path.startsWith("/static")) {
    chain.doFilter(request, response); // Goes to default servlet.
} else {
    request.getRequestDispatcher("/pages" + path).forward(request, response);
} 
```

不，这不会出现`/pages`在浏览器地址栏中。它是完全透明的。如有必要，您可以制作`"/static"`和/或过滤器`"/pages"`。`init-param`

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-01-24T19:10:15.140

使用**Spring 3.0.4.RELEASE**及更高版本，您可以使用

```
<mvc:resources mapping="/resources/**" location="/public-resources/"/> 
```

[如Spring Reference](http://static.springsource.org/spring/docs/3.0.5.RELEASE/spring-framework-reference/html/mvc.html#mvc-static-resources)中所见。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-08-17T17:33:14.000

您所做的是在您的 web.xml 中添加一个欢迎文件

```
<welcome-file-list>
    <welcome-file>index.html</welcome-file>
</welcome-file-list> 
```

然后将其添加到您的 servlet 映射中，以便当有人访问您的应用程序的根目录时，他们会在内部被发送到 index.html，然后映射将在内部将它们发送到您映射到的 servlet

```
<servlet-mapping>
    <servlet-name>MainActions</servlet-name>
    <url-pattern>/main</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>MainActions</servlet-name>
    <url-pattern>/index.html</url-pattern>
</servlet-mapping> 
```

最终结果：您访问 /Application，但您会看到 /Application/MainActions servlet，而不会中断任何其他根请求。

得到它？因此，您的应用程序仍然位于子 url，但当用户转到您网站的根目录时会自动呈现。这使您可以让 /images/bob.img 仍然进入常规位置，但 '/' 是您的应用程序。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-26T10:03:36.730

如果使用 Tomcat，则可以将资源映射到默认 servlet：

```
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>/static/*</url-pattern>
</servlet-mapping> 
```

并使用 url http://{context path}/static/res/... 访问您的资源

也适用于 Jetty，不确定其他 servlet 容器。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-01-03T19:11:03.073

在多个 servlet 映射定义中提供具有适当后缀的静态内容解决了已发布答案之一的评论之一中提到的安全问题。引用如下：

> 这是 Tomcat 中的一个安全漏洞（可以通过这种方式访问​​ WEB-INF 和 META-INF 内容），它已在 7.0.4 中得到修复（也将移植到 5.x 和 6.x）。– BalusC 2010 年 11 月 2 日 22:44

这对我帮助很大。这是我解决它的方法：

```
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.js</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.css</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.jpg</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.htm</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.html</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-05-15T19:33:29.430

我也遇到过这个问题，从来没有找到一个很好的解决方案。我最终将我的 servlet 映射到 URL 层次结构的上一级：

```
<servlet-mapping>       
  <servlet-name>home</servlet-name>             
  <url-pattern>/app/*</url-pattern>     
</servlet-mapping> 
```

现在，基本上下文（以及 /res 目录中）的所有内容都可以由您的容器提供。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-11-02T19:03:20.223

从 3.0.4 开始，您应该能够与spring 文档中描述的`mvc:resources`结合使用来实现这一点。`mvc:default-servlet-handler`

[http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-static-resources](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-static-resources)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-12-15T08:24:10.310

冲突的原因似乎是因为默认情况下，上下文根“/”将由 org.apache.catalina.servlets.DefaultServlet 处理。此 servlet 旨在处理对静态资源的请求。

如果您决定使用自己的 servlet 将其排除在外，以处理动态请求，则该顶级 servlet 还必须执行由 catalina 的原始“DefaultServlet”处理程序完成的任何任务。

如果您通读 tomcat 文档，他们会提到 True Apache (httpd) 在处理静态内容方面比 Apache Tomcat 更好，因为它是专门为此而构建的。我的猜测是因为 Tomcat 默认使用 org.apache.catalina.servlets.DefaultServlet 来处理静态请求。由于它全部包含在 JVM 中，并且 Tomcat 旨在作为 Servlet/JSP 容器，因此他们可能没有将该类编写为超级优化的静态内容处理程序。在那里。它完成了工作。够好了。

但这就是处理静态内容的东西，它位于“/”处。因此，如果您将其他任何东西放在那里，并且该东西不处理静态请求，哎呀，您的静态资源就在那里。

我一直在寻找相同的答案，而我到处都得到的答案是“如果你不希望它这样做，就不要那样做”。

长话短说，您的配置正在用根本不是静态资源处理程序的东西替换默认的静态资源处理程序。您需要尝试不同的配置才能获得所需的结果（我也会这样做）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-09-30T13:21:55.583

您的应用无法直接访问 App Engine 中的“静态”文件。您要么需要上传它们两次，要么自己提供静态文件，而不是使用静态处理程序。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-09-18T07:35:55.727

处理此问题的最佳方法是使用某种 URL 重写。通过这种方式，您可以拥有干净的 RESTful URL，而不是使用任何扩展名，即 abc.com/welcom/register 而不是 abc.com/welcome/resister.html

我使用非常酷的[Tuckey URL 。](http://www.tuckey.org/urlrewrite/)

它有关于如何设置你的 web 应用程序的说明。我已经用我的 Spring MVC web 应用程序设置了它。当然，在我想为 Spring 3 验证（如域对象`@Email`或`@Null`域对象）使用注释之前，一切都很好。

当我添加 Spring mvc 指令时：

```
< mvc:annotation-driven  /> 
< mvc:default-servlet-handler /> 
```

.. 它打破了良好的 ol Tuckey 代码。显然，`< mvc:default-servlet-handler />`取代了我仍在努力解决的 Tuckey。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-15T18:27:07.187

我建议尽可能尝试使用过滤器而不是默认 servlet。

其他两种可能：

自己编写一个 FileServlet。你会发现很多例子，它应该只是通过 URL 打开文件并将其内容写入输出流。然后，用它来服务静态文件请求。

实例化 Google App Engine 使用的 FileServlet 类，并在您需要在给定 URL 处提供静态文件时调用该 FileServlet 上的 service(request, response)。

您可以将 /res/* 映射到 YourFileServlet 或其他任何内容以将其从 DispatcherServlets 的处理中排除，或者直接从 DispatcherServlet 调用它。

而且，我不得不问，Spring 文档对这次碰撞有什么看法？我从来没有使用过它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-08-28T23:52:43.917

将您不想触发 servlet 处理的文件夹添加到`<static-files>`appengine-web.xml 文件的部分。

我只是这样做了，看起来事情开始正常了。这是我的结构：

/

/pages/<.jsp 文件>

/css

我在该部分中添加了“/pages/**”和“/css/**”，`<static-files>`现在我可以从 servlet doGet 内部转发到 .jsp 文件，而不会导致无限循环。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-12-19T20:42:27.123

在尝试过滤方法但没有成功后（由于某种原因没有进入 doFilter() 函数），我稍微更改了设置，并为根服务问题找到了一个非常简单的解决方案：

我现在不再在我的主 Servlet 中提供“/*”，而是只听专用的语言前缀“EN”、“EN/ *”、“DE”、“DE/ *”

静态内容由默认 Servlet 提供，空的根请求转到 index.jsp，它使用默认语言调用我的主 Servlet：

> < jsp:include page="/EN/" />（索引页没有其他内容。）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-02-10T09:59:25.970

我发现使用

```
<mvc:default-servlet-handler /> 
```

在 spring MVC servlet bean 定义文件中为我工作。它将任何未由注册的 MVC 控制器处理的请求传递给容器的原始默认处理程序，该处理程序应将其作为静态内容提供。只要确保您没有注册可以处理所有事情的控制器，它应该可以正常工作。不知道为什么@logixplayer 建议 URL 重写；你可以单独使用 Spring MVC 来达到他想要的效果。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-08-09T19:24:27.247

我找到了一个使用虚拟索引文件的更简单的解决方案。

创建一个映射到“/index.html”的Servlet（或使用你想要响应“/”的那个）（这里提到的解决方案使用通过XML的映射，我使用带有注释@WebServlet的3.0版本）然后创建一个静态（空）文件位于名为“index.html”的静态内容的根目录

我正在使用 Jetty，发生的事情是服务器识别了文件而不是列出目录，但是当被要求提供资源时，我的 Servlet 代替了控制权。所有其他静态内容均不受影响。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-12-15T05:54:52.157

在 Embedded Jetty 中，我设法通过在 web.xml 中添加“css”目录的映射来实现类似的效果。明确告诉它使用 DefaultServlet：

```
<servlet>
  <servlet-name>DefaultServlet</servlet-name>
  <servlet-class>org.eclipse.jetty.servlet.DefaultServlet</servlet-class>
</servlet>

<servlet-mapping>
  <servlet-name>DefaultServlet</servlet-name>
  <url-pattern>/css/*</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-12-31T11:13:06.217

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">
<mvc:default-servlet-handler/>
</beans> 
```

如果您想使用基于注释的配置，请使用以下代码

```
@Override
    public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {
        configurer.enable();
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-04-11T03:23:14.287

关于 Tomcat，很大程度上取决于特定的版本。有一个错误修复 [https://bz.apache.org/bugzilla/show_bug.cgi?id=50026](https://bz.apache.org/bugzilla/show_bug.cgi?id=50026) 这意味着默认 servlet 的 servlet-mapping（'/' 除外）在 Tomcat 6.0.29 中的行为不同（和更早）与更高版本相比。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2020-08-13T14:56:39.983

在 Servlet 规范的“12.2 映射规范”部分中，它说：

> 仅包含“/”字符的字符串表示应用程序的“默认”servlet。

所以理论上，你可以让你的 Servlet 映射到`/*`：

```
getServletContext().getNamedDispatcher("/").forward(req,res); 
```

...如果您不想自己处理。

但是，在实践中，它不起作用。

在 Tomcat 和 Jetty 中，如果有一个 servlet 映射到，则调用`getServletContext().getNamedDispatcher('/')`返回`null``'/*'`

# php - 转发：使用 PHP 创建 RSS 提要

> ID：870160
> 
> 赞同：0
> 
> 时间：2009-05-15T18:27:36.403
> 
> 标签：php, mysql, html, xml, rss

我之前问过如何做到这一点，但似乎我需要输入更多代码才能真正得到答案。

我有一个 reddit 类型的网站，我正在尝试创建一个 rss 提要，这是代码，但我收到一个致命错误：未捕获的异常 'Exception' 和消息 'Query failed'

这是它的代码：

```
<?php
require_once($_SERVER['DOCUMENT_ROOT'].'/config.php'); 
require_once(SITE_ROOT.'includes/exceptions.php'); 
require_once(SITE_ROOT.'data/model.php');
require_once(SITE_ROOT.'data/comment.php');

class Article extends Model 
{
    private $id;
    private $user_id;
    private $url;
    private $title;
    private $description;
    private $ranking;
    private $points;

    function __construct($title = ' ', $description = ' ', $url = ' ', $username = ' ', $created = ' ', $modified = '') {

        $this->setId(0);
        $this->setCreated($created);
        $this->setModified($modified);
        $this->setUsername($username);
        $this->setUrl($url);
        $this->setTitle($title);
        $this->setDescription($description);
        $this->setRanking(0.0);
        $this->setPoints(0);
    }

    function getId(){
        return $this->id;
    }

    private function setId($value){
        $this->id = $value;
    }

    function getUsername(){
        return $this->username;
    }

    function setUsername($value){
        $this->username = $value;
    }

    function getUrl(){
        return $this->url;
    }

    function setUrl($value){
        $this->url = $value;
    }

    function getTitle()
    {
        return $this->title;
    }

    function setTitle($value) {

        $this->title = $value;
    }

    function getDescription() {
        return $this->description;
    }

    function setDescription($value)
    {
        $this->description = $value;
    }

    function getPoints()
    {
        return $this->points;
    }

    function setPoints($value) {
        $this->points = $value;
    }

    function getRanking()
    {
        return $this->ranking;
    }

    function setRanking($value)
    {
        $this->ranking = $value;
    }

    function calculateRanking()
    {
        $created = $this->getCreated();
        $diff = $this->getTimeDifference($created, date('F d, Y h:i:s A'));
        $time = $diff['days'] * 24;
        $time += $diff['hours'];
        $time += ($diff['minutes'] / 60);
        $time += (($diff['seconds'] / 60)/60);

        $base = ($time + 2);

        if($base > 0)
        {
            $this->ranking = ($this->points - 1) / pow($base, 1.5);
        }
        else
        {
            $this->ranking = 0;
        }
        $this->save();
    }

    function vote($user,$amount=1)
    {
        if($this->has_voted($user) == false) 
        {            
            $this->points += $amount;
            $this->save();
            $this->log_vote($user); 
        }
    }

    function log_vote($user) 
    {
        try
        {
            $db = parent::getConnection();
            $query = "insert into votes (article_id, username) values ($this->id, '$user')";           
            $results = parent::execSql($query);
        }
        catch(Exception $e){
            throw $e;
        }        
    } 

    function  has_voted($user) 
    {
       try
        {
            $db = parent::getConnection();
            $query = "select id from votes where username = '$user' and article_id  = $this->id";
            $results = parent::execSQL($query);
            if($results->num_rows == 1) {
                return true;                 
            }
            else 
            {
                return false;
            }            
            parent::closeConnection($db);

        }
        catch(Exception $e){
            throw $e;
        }       
    }
    function getUrlDomain()
    {
        /* We extract the domain from the URL
         * using the following regex pattern
         */

        $url = $this->getUrl();
        $matches = array(); 
        if(preg_match('/http:\/\/(.+?)\//', $url, $matches))
        {
            return $matches[1];
        }
        else
        {
            return $url;
        }
    }

    function getTimeDifference( $start, $end )
    {
        //echo "start is $start, end is $end";
        $uts['start']      =    strtotime( $start );
        $uts['end']        =    strtotime( $end );
        if( $uts['start']!==-1 && $uts['end']!==-1 )
        {
            if( $uts['end'] >= $uts['start'] )
            {
                $diff    =    $uts['end'] - $uts['start'];
                if( $days=intval((floor($diff/86400))) )
                    $diff = $diff % 86400;
                if( $hours=intval((floor($diff/3600))) )
                    $diff = $diff % 3600;
                if( $minutes=intval((floor($diff/60))) )
                    $diff = $diff % 60;
                $diff    =    intval( $diff );
                return( array('days'=>$days, 'hours'=>$hours, 'minutes'=>$minutes, 'seconds'=>$diff) );
            }
            else
            {
                echo( "Ending date/time is earlier than the start date/time");
            }
        }
        else
        {
            echo( "Invalid date/time data detected");
        }
        return( false );
    }

    function getElapsedDateTime()
    {
        $db = null;
        $record = null;

        $record = Article::getById($this->id);
        $created = $record->getCreated();         

        $diff = $this->getTimeDifference($created, date('F d, Y h:i:s A'));
        //$diff = $this->getTimeDifference($created, date_add(date('F d, Y h:i:s A'),new DateInterval("5H")));
        //echo 'new date is '.date('F d, Y h:i:s A');
        //print_r($diff);

        if($diff['days'] > 0 )
        {
            if($diff['days'] < 2 ) { return sprintf("%d dia", $diff['days']); }

            else return sprintf("%d dias", $diff['days']);
        }
        else if($diff['hours'] > 0 )
        {
            if($diff['hours'] < 2 ) { return sprintf("%d hora", $diff['hours']); }

            else return sprintf("%d horas", $diff['hours']);
        }
        else if($diff['minutes'] > 0 )
        {
            if($diff['minutes'] < 2 ) { return sprintf("%d minuto", $diff['minutes']); }

            else return sprintf("%d minutos", $diff['minutes']);
        }
        else
        {
            if($diff['seconds'] < 2 ) { return sprintf("%d segundo", $diff['seconds']); }

            else return sprintf("%d segundos", $diff['seconds']);
        }
    }

    function save() {

    /*
            Here we do either a create or
            update operation depending
            on the value of the id field.
            Zero means create, non-zero
            update
    */

        if(!get_magic_quotes_gpc())
        {
            $this->title = addslashes($this->title);
            $this->description = addslashes($this->description);
        }

        try
        {
            $db = parent::getConnection();
            if($this->id == 0 )
            {
                $query = 'insert into articles (modified, username, url, title, description, points )';
                $query .= " values ('$this->getModified()', '$this->username', '$this->url', '$this->title', '$this->description', $this->points)";
                createRSS(); //  ++++++ rss  +++++++
            }
            else if($this->id != 0)
            {
                $query = "update articles set modified = NOW()".", username = '$this->username', url = '$this->url', title = '".$this->title."', description = '".$this->description."', points = $this->points, ranking = $this->ranking where id = $this->id";
            }

            $lastid = parent::execSql2($query);

            if($this->id == 0 )
                $this->id = $lastid;

        }
        catch(Exception $e){
            throw $e;
        }
    }

    function delete()
    {
        try
        {
            $db = parent::getConnection();
            if($this->id != 0)
            {                ;
                /*$comments = $this->getAllComments();
                foreach($comments as $comment)
                {
                    $comment->delete();
                }*/
                $this->deleteAllComments();
                $query = "delete from articles where id = $this->id";
            }
            parent::execSql($query);

        }
        catch(Exception $e){
            throw $e;
        }
    }

    static function getAll($conditions = ' ')
    {
        /* Retrieve all the records from the
         * database according subject to
         * conditions
         */

        $db = null;
        $results = null;
        $records = array();
        $query = "select id, created, modified, username, url, title, description, points, ranking from articles $conditions";
        try
        {
            $db = parent::getConnection(); 
            $results = parent::execSql($query);

            while($row = $results->fetch_assoc())
            {
                $r_id = $row['id'];
                $r_created = $row['created'];
                $r_modified = $row['modified'];

                $r_title = $row['title'];
                $r_description = $row['description'];

                if(!get_magic_quotes_gpc())
                {
                    $r_title = stripslashes($r_title);
                    $r_description = stripslashes($r_description);
                }

                $r_url = $row['url'];
                $r_username = $row['username'];
                $r_points = $row['points'];
                $r_ranking = $row['ranking'];

                $article = new Article($r_title, $r_description , $r_url, $r_username, $r_created, $r_modified);
                $article->id = $r_id;
                $article->points = $r_points;
                $article->ranking = $r_ranking;
                $records[] = $article;
            }
            parent::closeConnection($db);
        }
        catch(Exception $e)
        {
            throw $e;
        }

        return $records;
    }

    static function getById($id)
    {/*
     *  Return one record from the database by its id */

        $db = null;
        $record = null;

        try
        {
            $db = parent::getConnection();
            $query = "select id, username, created, modified, title, url, description, points, ranking from articles where id = $id";
            $results = parent::execSQL($query);
            if(!$results) {
                throw new Exception ('Record not found', EX_RECORD_NOT_FOUND);
            }

            $row = $results->fetch_assoc();
            parent::closeConnection($db);

            if(!get_magic_quotes_gpc())
            {
                $row['title'] = stripslashes($row['title']);
                $row['description'] = stripslashes($row['description']);
            }

            $article = new Article($row['title'], $row['description'], $row['url'], $row['username'], $row['created'], $row['modified']);
            $article->id = $row['id'];
            $article->points = $row['points'];
            $article->ranking = $row['ranking']; 
            return $article;

        }
        catch (Exception $e){
            throw $e;
        }
    }

    static function getNumberOfComments($id)
    {/*
     *  Return one record from the database by its id */

        $db = null;
        $record = null;

        try
        {
            $db = parent::getConnection();
            $query = "select count(*) as 'total' from comments where article_id = $id";
            $results = parent::execSQL($query);
            if(!$results) {
                throw new Exception ('Comments Count Query Query Failed', EX_QUERY_FAILED);
            }

            $row = $results->fetch_assoc();
            $total = $row['total'];
            parent::closeConnection($db);    

            return $total;

        }
        catch (Exception $e){
            throw $e;
        }
    }

    function deleteAllComments()
    {/*
     *  Return one record from the database by its id */

        $db = null;
        try
        {
            $db = parent::getConnection();
            $query = "delete from comments where article_id = $this->id";
            $results = parent::execSQL($query);
            if(!$results) {
                throw new Exception ('Deletion Query Failed', EX_QUERY_FAILED);
            }
            parent::closeConnection($db);
        }
        catch (Exception $e){
            throw $e;
        }
    }

    function getAllComments($conditions = ' ')
    {
        /* Retrieve all the records from the
         * database according subject to
         * conditions
         */
        $conditions = "where article_id = $this->id";
        $comments = Comment::getAll($conditions);
        return $comments; 
    }

    static function getTestData($url)
    {
        $page = file_get_contents($url);

    }

}

    function createRSS() 
    {
        $articles = Article::getAll("order by created desc limit $offset, $num_items");
        $num_articles = count($articles);       

        // open a file pointer to an RSS file
        $fp = fopen ("rss.xml", "w");
        if (!$fp) {
            // Can't write to a file
            return;
            }

        fwrite ($fp, "<?xml version='1.0' encoding='iso-8859-1' ?>\n");
        fwrite ($fp, "<rss version='2.0' xmlns:atom=\"http://www.kiubbo.com/rss.xml\"><channel>\n");
        fwrite ($fp, "<title>Kiubbo.com</title>\n");
        fwrite ($fp, "<atom:link href='http://www.kiubbo.com/rss.xml' rel='self' type='application/rss+xml' />\n");
        fwrite ($fp, "<link>http://www.kiubbo.com/</link>\n");
        fwrite ($fp, "<description>Todas las Noticias Fotos y Videos.</description>\n");
        fwrite ($fp, "<language>es-mx</language>\n");
        fwrite ($fp, "<docs>http://www.kiubbo.com/rss.xml</docs>\n");
        fwrite ($fp, "<image>\n");
        fwrite ($fp, " <title>Kiubbo.com</title>\n");
        fwrite ($fp, " <url>http://www.kiubbo.com/Logot.png</url>\n");
        fwrite ($fp, " <link>http://www.kiubbo.com</link>\n");
        fwrite ($fp, "</image>\n");

        for($index = 0; $index < $num_articles; $index++){

        $url = $articles[$index]->getUrl();
        $title = $articles[$index]->getTitle(); // ok?

        $search = array(
        '@<script[^>]*?>.*?</script>@si', // Strip out javascript
        '@<[\/\!]*?[^<>]*?>@si', // Strip out HTML tags
        '@([\r\n])[\s]+@', // Strip out white space
        '@&(quot|#34);@i', // Replace HTML entities
        '@&(amp|#38);@i',
        '@&(lt|#60);@i',
        '@&(gt|#62);@i',
        '@&(nbsp|#160);@i',
        '@&(iexcl|#161);@i',
        '@&(cent|#162);@i',
        '@&(pound|#163);@i',
        '@&(copy|#169);@i',
        '@&(acento|#0027);@i',
        '@&#(\d+);@e'); // evaluate as php
        $replace = array(
        '',
        '',
        '\1',
        '"',
        '&',
        '<',
        '>',
        ' ',
        'chr(161)',
        'chr(162)',
        'chr(163)',
        'chr(169)',
        'chr(\1)');

        $content = preg_replace($search, $replace, $content);
        $title = preg_replace("/&/", 'y', $title);
        $content = preg_replace("/&/", 'y', $content);

        fwrite ($fp, "<item>\n");
        fwrite ($fp, " <title>$title</title>\n");
        fwrite ($fp, " <link>$url</link>\n");
        fwrite ($fp, "<guid>http://www.kiubbo.com</guid>\n");
        fwrite ($fp, "</item>\n");
        }
        fwrite ($fp, "</channel></rss>\n");
        fclose ($fp);
    }

?> 
```

谢谢

问候卡洛斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T18:56:59.737

我不在一台带有 php 的机器上来测试这个，但是你有如下变量的查询......

```
"select id from votes where username = '$user' and article_id  = $this->id" 
```

我相当肯定你在使用对象时需要括号或连接......

```
"select id from votes where username = '$user' and article_id  = ${this->id}" 
```

或者

```
"select id from votes where username = '$user' and article_id  = " . $this->id 
```

# c# - WPF 复选框绑定

> ID：870163
> 
> 赞同：87
> 
> 时间：2009-05-15T18:28:08.103
> 
> 标签：c#, wpf, xaml, data-binding, checkbox

虽然使用复选框的 Click 事件将复选框的选中状态存储在变量中很简单，但我将如何通过数据绑定来做到这一点？我发现的所有示例都从某个数据源更新了 UI，或者将一个控件绑定到另一个；单击复选框时，我想更新成员变量。

任何指针的 TIA...

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-05-15T19:19:38.463

您必须使绑定双向：

```
<checkbox IsChecked="{Binding Path=MyProperty, Mode=TwoWay}"/> 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-05-15T20:33:55.853

为此，您需要一个依赖属性：

```
public BindingList<User> Users
{
    get { return (BindingList<User>)GetValue(UsersProperty); }
    set { SetValue(UsersProperty, value); }
}

public static readonly DependencyProperty UsersProperty =
    DependencyProperty.Register("Users", typeof(BindingList<User>), 
      typeof(OptionsDialog)); 
```

完成后，将复选框绑定到依赖属性：

```
<CheckBox x:Name="myCheckBox"
          IsChecked="{Binding ElementName=window1, Path=CheckBoxIsChecked}" /> 
```

为此，您必须在其打开标记中命名您的 Window 或 UserControl，并在 ElementName 参数中使用该名称。

使用此代码，无论何时更改代码端的属性，都会更改文本框。此外，每当您选中/取消选中文本框时，依赖属性也会发生变化。

编辑：

创建依赖属性的一种简单方法是键入片段 propdp，它将为您提供依赖属性的通用代码。

所有代码：

XAML：

```
<Window x:Class="StackOverflowTests.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" x:Name="window1" Height="300" Width="300">
    <Grid>
        <StackPanel Orientation="Vertical">
            <CheckBox Margin="10"
                      x:Name="myCheckBox"
                      IsChecked="{Binding ElementName=window1, Path=IsCheckBoxChecked}">
                Bound CheckBox
            </CheckBox>
            <Label Content="{Binding ElementName=window1, Path=IsCheckBoxChecked}"
                   ContentStringFormat="Is checkbox checked? {0}" />
        </StackPanel>
    </Grid>
</Window> 
```

C＃：

```
using System.Windows;

namespace StackOverflowTests
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public bool IsCheckBoxChecked
        {
           get { return (bool)GetValue(IsCheckBoxCheckedProperty); }
           set { SetValue(IsCheckBoxCheckedProperty, value); }
        }

        // Using a DependencyProperty as the backing store for 
         //IsCheckBoxChecked.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty IsCheckBoxCheckedProperty =
            DependencyProperty.Register("IsCheckBoxChecked", typeof(bool), 
            typeof(Window1), new UIPropertyMetadata(false));

        public Window1()
        {             
            InitializeComponent();
        }
    }
} 
```

注意背后唯一的代码是依赖属性。标签和复选框都绑定到它。如果复选框改变，标签也会改变。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-06-02T18:49:06.373

您好，这是我第一次发帖，请耐心等待：我的回答是创建一个简单的属性：

```
public bool Checked { get; set; } 
```

然后设置 Checkbox 的数据上下文（称为 cb1）：

```
cb1.DataContext = this; 
```

然后在 xaml 中绑定它的 IsChecked 属性

```
IsChecked="{Binding Checked}" 
```

代码是这样的：

**XAML**

```
<CheckBox x:Name="cb1"
          HorizontalAlignment="Left"
          Margin="439,81,0,0"
          VerticalAlignment="Top"
          Height="35" Width="96"
          IsChecked="{Binding Checked}"/> 
```

**背后的代码**

```
public partial class MainWindow : Window
{
    public bool Checked { get; set; }

    public MainWindow()
    {
        InitializeComponent();

        cb1.DataContext = this;
    }

    private void myyButton_Click(object sender, RoutedEventArgs e)
    {
        MessageBox.Show(Checked.ToString());
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-15T18:46:32.273

如果您的数据类上有属性“MyProperty”，那么您可以像这样绑定 IsChecked....（转换器是可选的，但有时您需要它）

```
<Window.Resources>
<local:MyBoolConverter x:Key="MyBoolConverterKey"/>
</Window.Resources>
<checkbox IsChecked="{Binding Path=MyProperty, Converter={StaticResource MyBoolConverterKey}}"/> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-11T20:27:43.800

应该比那更容易。只需使用：

```
<Checkbox IsChecked="{Binding Path=myVar, UpdateSourceTrigger=PropertyChanged}" /> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-24T14:32:51.253

这对我有用（仅包括基本代码，根据您的需要填写更多）：

在 XAML 中定义了一个用户控件：

```
<UserControl x:Class="Mockup.TestTab" ......>
    <!-- a checkbox somewhere within the control -->
    <!-- IsChecked is bound to Property C1 of the DataContext -->
    <CheckBox Content="CheckBox 1" IsChecked="{Binding C1, Mode=TwoWay}" />
</UserControl> 
```

在 UserControl 后面的代码中

```
public partial class TestTab : UserControl
{
    public TestTab()
    {
        InitializeComponent();  // the standard bit

    // then we set the DataContex of TestTab Control to a MyViewModel object
    // this MyViewModel object becomes the DataContext for all controls
         // within TestTab ... including our CheckBox
         DataContext = new MyViewModel(....);
    }

} 
```

在解决方案类 MyViewModel 的某处定义

```
public class MyViewModel : INotifyPropertyChanged 
{
    public event PropertyChangedEventHandler PropertyChanged;
    private bool m_c1 = true;

    public bool C1 {
        get { return m_c1; }
        set {
            if (m_c1 != value) {
                m_c1 = value;
                if (PropertyChanged != null)
                    PropertyChanged(this, new PropertyChangedEventArgs("C1"));
            }
        }
    }
} 
```

# java - ORA-01031: 创建与 Oracle 主题的 JMS 连接的权限不足

> ID：870165
> 
> 赞同：1
> 
> 时间：2009-05-15T18:28:34.233
> 
> 标签：java, oracle, queue, jms, privileges

我的一位同事在从 Java 创建 Oracle 队列的（非持久）订阅者时遇到问题。

队列由一个模式拥有（比如 OWNER）；他正试图以另一个用户（比如订阅者）的身份连接。SUBSCRIBER 已被 OWNER 授予 DEQUEUE 特权（以及 ENQUEUE，就其价值而言）。

当他创建队列并将“multiple_consumers”选项设置为 FALSE 时，一切正常。当“multiple_consumers”设置为 TRUE（我们需要的设置）时，它会失败并显示以下内容：

```
oracle.jms.AQjmsException: ORA-01031: insufficient privileges
ORA-06512: at "SYS.DBMS_AQADM_SYS", line 5757
ORA-06512: at line 1
ORA-06512: at "SYS.DBMS_AQJMS", line 129
ORA-06512: at line 1
    at oracle.jms.AQjmsSession.addDurableSubscriber(AQjmsSession.java:3708)
    at oracle.jms.AQjmsSession.createSubInOldMode(AQjmsSession.java:2742)
    at oracle.jms.AQjmsSession.createDurableSubscriber(AQjmsSession.java:2400)
    at oracle.jms.AQjmsSession.forceCreateOldSubscriber(AQjmsSession.java:2884)
    at oracle.jms.AQjmsSession.createConsumer(AQjmsSession.java:6820) 
```

如果他以 OWNER 身份连接，则成功。

如何确定需要授予 SUBSCRIBER 哪些权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T19:27:41.690

您要么必须创建一个持久订阅者，要么将 AQ_ADMINISTRATOR_ROLE 授予连接用户 - 这不是一个很好的安全模型，但这是 Oracle 暂时的实现。

[https://forums.oracle.com/forums/thread.jspa?messageID=9793091](https://forums.oracle.com/forums/thread.jspa?messageID=9793091)

# c++ - 在 Windows 中，如何拥有作为重定向管道的非阻塞标准输入？

> ID：870167
> 
> 赞同：8
> 
> 时间：2009-05-15T18:29:05.857
> 
> 标签：c++, c, windows, stdin, pipe

我有一个 Windows C 程序，它通过重定向`stdin`管道获取数据，有点像这样：

```
./some-data-generator | ./myprogram 
```

问题是我需要能够以`stdin`非阻塞方式读取。这样做的原因是（1）输入是一个数据流并且没有`EOF`，（2）程序需要能够随时中止它的`stdin`读取线程。 `fread`没有数据时会阻塞，所以这很困难。

`fcntl`在 Unix 中这没有问题，因为您可以使用和设置文件描述符的阻塞模式`O_NONBLOCK`。但是，`fcntl`在 Windows 上不存在。

我尝试使用`SetNamedPipeHandleState`：

```
 DWORD mode= PIPE_READMODE_BYTE|PIPE_NOWAIT;
    BOOL ok= SetNamedPipeHandleState(GetStdHandle(STD_INPUT_HANDLE), &mode, NULL, NULL);
    DWORD err= GetLastError(); 
```

但这会因`ERROR_ACCESS_DENIED`( `0x5`) 而失败。

我不确定还能做什么。这实际上是不可能的（！）还是只是高度模糊？对于这个特定问题，网络上的资源相当稀少。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T19:50:03.077

订单方法，检查是否有可供阅读的输入：

*   对于控制台模式，您可以使用 GetNumberOfConsoleInputEvents()。
*   对于管道重定向，您可以使用 PeekNamedPipe()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:55:04.990

您可以使用异步 I/O 从句柄中读取，例如 ReadFileEx() WIN32 调用。使用 CancelIo() 在没有输入的情况下终止读取。

[请参阅位于http://msdn.microsoft.com/en-us/library/aa365468(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365468(VS.85).aspx)的 MSDN

# java - 你能在 Java Swing 面板上保持对象的位置吗？

> ID：870171
> 
> 赞同：1
> 
> 时间：2009-05-15T18:30:16.103
> 
> 标签：java, swing

我目前正在使用 Java Swing 设计一个计算器面板。但是，将所有按钮排成一行是一件极其痛苦的事情，因为每当我添加新按钮或更改按钮大小时，它们总是在调整大小和重新定位它们自己。

是否有一种布局或可以将按钮“锁定”到位的东西，以便在我移动/调整大小/添加其他按钮时它们不会受到影响？

谢谢，鲍勃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T19:05:43.083

扩展汤姆所说的话......

要让组件变得不可见但保持其位置，您可以将它与空标签一起放置在 CardLayout 中，然后交换可见的。

您可以按如下方式为您创建一个类来执行此操作。主要仅显示一个示例，如果您单击一个按钮，它会在保留其位置的同时被删除。我输入了 showComponent/hideComponent 和 setVisible(t/f) - 取决于你喜欢的风格。

这可能不能完全回答您正在寻找的内容，但可能对您的应用程序的一部分有用。

```
public class Placeholder extends JPanel {
    private static final long serialVersionUID = 1L;
    private CardLayout cardLayout_;
    public Placeholder(JComponent component) {
        cardLayout_ = new CardLayout();
        setLayout(cardLayout_);
        add(component, "visible"); // the component
        add(new JLabel(), "hidden"); // empty label
    }
    public void showComponent() {
        cardLayout_.show(this, "visible"); 
    }
    public void hideComponent() {
        cardLayout_.show(this, "hidden"); 
    }
    public void setComponentVisible(boolean visible) {
        if (visible)
            showComponent();
        else
            hideComponent();
    }
    public static void main(String[] args) {
        JFrame f = new JFrame();
        f.setLayout(new GridLayout(2,0));
        for (int n = 1; n < 10; n++) {
            JButton b = new JButton(n + "");
            final Placeholder placeholder = new Placeholder(b);
            f.add(placeholder);
            b.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    placeholder.hideComponent();
                }
            });
        }
        f.pack();
        f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        f.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T18:35:43.047

我建议不要添加和删除按钮，而是更改它们的可见性属性 ( [`setVisible`](http://java.sun.com/javase/6/docs/api/java/awt/Component.html#setVisible(boolean)))。一些布局管理器会忽略不可见的组件，因此您可能需要在与原始组件的首选/最小/最大尺寸相同的位置添加一个非 opqaue（或匹配的背景）组件。更简单的你可能想用 [`OverlayLayout`](http://java.sun.com/javase/6/docs/api/javax/swing/OverlayLayout.html).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:32:31.337

您可以使用 GridBagLayout 将它们保留在网格中，但允许它们调整大小

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T19:44:01.963

扩展其他人所说的...

除了使组件不可见之外，您还可以禁用它们……
当然，这取决于您的应用程序和您的偏好。

除了上面提到的布局，还有一些免费的布局，比如 TableLayout 和通用的 MigLayout。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T11:33:42.763

这可能取决于您使用的开发环境。

在 Netbeans 中，您可以右键单击控件容器（窗体/面板）并从多个布局选项中进行选择。“绝对布局”将允许您定位控件而不自动调整它们的大小，尽管它不会让您将控件放置在彼此之上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T11:42:47.347

我建议您查看[A Visual Guide to Layout Managers](http://java.sun.com/docs/books/tutorial/uiswing/layout/visual.html)。根据您想要的外观和功能，有不同的布局可能适合您。如果主要问题是调整大小操作（我假设是父 JFrame o JPanel），那么[Spring 布局](http://java.sun.com/docs/books/tutorial/uiswing/layout/spring.html)允许您建立关于组件相对位置的约束。

# c++ - Windows中打开文件的数量是否有限制

> ID：870173
> 
> 赞同：44
> 
> 时间：2009-05-15T18:31:08.300
> 
> 标签：c++, windows

我在 VC++ 中使用 fopen() 打开了很多文件，但过了一会儿它失败了。

您可以同时打开的文件数量是否有限制？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-15T18:42:59.037

C 运行时库对可以在任何时候打开的文件数有 512 个限制。尝试打开超过最大数量的文件描述符或文件流会导致程序失败。用于`_setmaxstdio`更改此号码。可以在[此处阅读有关此的更多信息](http://msdn.microsoft.com/en-us/library/kdfaxaay(vs.71).aspx)

此外，您可能需要检查您的 Windows 版本是否支持您尝试设置的上限`_setmaxstdio`。有关`_setmaxstdio`检查的更多信息，请[点击此处](http://msdn.microsoft.com/en-us/library/6e3b887c(vs.71).aspx)

可以在[此处找到与 VS 2015 对应的主题的信息](https://msdn.microsoft.com/en-us/library/kdfaxaay(v=vs.140).aspx)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-18T10:04:52.413

如果其他人不清楚限制适用于什么，我相信这是每个​​进程的限制，而不是系统范围的限制。

我只是写了一个小测试程序来打开文件，直到它失败。它在失败之前获得了 2045 个文件（2045 + STDIN + STDOUT + STDERROR = 2048），然后我将其打开并运行另一个副本。

第二个副本显示了相同的行为，这意味着我一次打开了至少 4096 个文件。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-11-25T11:08:52.717

如果您在 Windows 中使用标准 C/C++ POSIX 库，答案是“是”，这是有限制的。

然而，有趣的是，限制是由您使用的 C/C++ 库的种类强加的。

我遇到了来自 MySQL的以下 JIRA 线程（ [http://bugs.mysql.com/bug.php?id=24509 ）。](http://bugs.mysql.com/bug.php?id=24509)他们正在处理关于打开文件数量的相同问题。

但是，Paul DuBois 解释说，在 Windows 中可以通过使用 ...

> Win32 API 调用（CreateFile()、WriteFile() 等），默认打开文件的最大数量已增加到 16384。可以通过使用 --max-open-files=N 选项进一步增加最大值服务器启动。

当然，理论上你可以通过使用类似于数据库连接池的技术来打开大量文件，但这会对性能产生严重影响。

事实上，打开大量文件可能是糟糕的设计。但是，某些情况调用需要它。例如，如果您正在构建一个将由数千个用户或应用程序使用的数据库服务器，则该服务器必然必须打开大量文件（或使用文件描述符池技术导致性能下降）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-15T18:36:36.273

是的，根据您在打开文件时使用的访问级别，存在限制。您可以使用`_getmaxstdio`来查找限制和`_setmaxstdio`更改限制。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-16T18:40:54.507

我不知道 Paulo 从哪里得到这个数字。在基于 Windows NT 的操作系统中，每个进程打开的文件句柄数量基本上受到物理内存的限制 - 它肯定有数十万。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-25T09:14:32.393

遇到了同样的问题，但使用的是 RAD Studio 10.2 的 Embarcadero C++-Builder。那个东西的 C 运行时似乎没有提供`_getmaxstdio`or `_setmaxstdio`，但是一些[宏](http://docwiki.embarcadero.com/RADStudio/Tokyo/de/OPEN_MAX_define)和它们的默认限制比这里所说的其他运行时要低得多：

标准输入法.h：

```
/* Number of files that can be open simultaneously
*/
#if defined(__STDC__)
#define FOPEN_MAX (_NFILE_)
#else
#define FOPEN_MAX (_NFILE_)
#define SYS_OPEN  (_NFILE_)
#endif 
```

_nfile.h：

```
#if defined(_WIN64)
#define _NFILE_ 512
#else
#define _NFILE_ 50
#endif 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T18:36:48.177

是的，有一个限制。

该限制取决于操作系统和可用内存。

在旧的 DOS 中，限制是 255 个同时打开的文件。

在 Windows XP 中，限制更高（我相信它是[MSDN](http://msdn.microsoft.com/en-us/library/6e3b887c.aspx)所述的 2,048 ）。

# asp.net - 带有 ActiveDirectoryMembershipProvider 的 ASP.NET ChangePassword 控件

> ID：870177
> 
> 赞同：3
> 
> 时间：2009-05-15T18:32:29.140
> 
> 标签：asp.net, active-directory, asp.net-membership

我有一个使用 ActiveDirectoryMembershipProvider 使用表单身份验证的 web 应用程序。效果很好......用户可以成功登录。

一旦用户登录，他可以更改密码。我们使用一个 ChangePassword 控件来检索会员信息，并使用旧密码和新密码来更改用户的密码。 **那行不通**。

抛出的异常消息是密码不符合密码策略（不是提供程序的消息，而是底层 COM 对象。但情况并非如此，因为转到 ActiveDirectory 控制台并在那里更改密码确实有效。在使用 ActiveDirectory 控制台时，我们使用了一个非常简单的密码：“Password01”。

ActiveDirectory 中的用户设置为允许更改密码。我们所有的用户都存储在某个 OU 中，并且到 AD 的连接字符串也指向该 OU。同样，连接成功，我们可以登录。

**还有什么可以阻止我们更改密码的吗？**

*异常信息*

```
 System.Web.Security.MembershipPasswordException: The password supplied is invalid.
Passwords must conform to the password strength requirements configured for the default provider.
---> System.Runtime.InteropServices.COMException (0x800708C5): The password does not meet the password policy requirements. Check the minimum password length, password complexity and password history requirements. (Exception from HRESULT: 0x800708C5)
       --- End of inner exception stack trace ---
       at System.Web.Security.ActiveDirectoryMembershipProvider.ChangePassword(String username, String oldPassword, String newPassword)
       at System.Web.Security.MembershipUser.ChangePassword(String oldPassword, String newPassword) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T21:43:29.663

嗯，很抱歉给您带来不便...

问题是 Active Directory 管理员设置了您可以**等待一天**才能更改密码。

所以，如果我们创建一个用户...... USER 必须等待 1 天才能更改他的密码。管理员可以在没有此限制的情况下重置密码。

感谢您的意见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:48:05.520

在 web.config 中配置成员资格提供程序时，可以设置几个与密码相关的值，即：

```
MinRequiredNonAlphanumericCharacters
MinRequiredPasswordLength
PasswordStrengthRegularExpression 
```

我首先要确保所有这些都设置为与 ActiveDirectory 匹配的值。

接下来，确保将 connectionProtection 属性设置为 SignAndSeal，否则无法更改密码：

```
connectionProtection="SignAndSeal" 
```

除了这些建议之外，我还查看了 Reflector，所有的 COM 错误（0x7FF8FAD2 除外）都被直接抛出给客户端。错误 0x800708C5 出现在 MSDN 中的多个位置，但始终带有密码复杂性不足的文本。

# c - 比较字符串

> ID：870185
> 
> 赞同：2
> 
> 时间：2009-05-15T18:35:27.993
> 
> 标签：c

考虑到这段代码

```
char *pass="test";
int keyPressed;
char *password=(char *)malloc(PASS_LENGTH*sizeof(char));
int index=0;
printf("Enter the password please\n");
do
{
    keyPressed=getch();
    password[index++]=keyPressed;
}
while(keyPressed!=13);
int result=strcmp(pass,password); 
```

我想你明白我想要做什么:)
我读到 *password "test" 但结果不是 0，一些解释会很好:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T18:39:37.313

因为我认为这是家庭作业......在他们按下 Enter 后尝试写出字符串，看看你是否能看到不同之处。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-15T18:38:01.013

您必须删除最后一个字符并“关闭”字符串：

```
password[index - 1] = '\0' 
```

在做一会儿之后。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T19:09:44.557

akappa 的建议将解决您看到的 strcmp 问题。

另请注意，您分配了有限数量的内存，但是在写入此内存时，您不会检查分配块的大小。编写的代码将允许写入通过“密码”的结尾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T18:38:58.077

看起来它会是“test\n”，因为您已经添加了 keyPressed。从而也溢出密码变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T18:39:29.903

您应该 malloc PASS_LENGTH+1 并在最后一行代码之前设置 password[index] = 0 。因为 strcmp 和其他 C str 例程使用 ASCIIZ 字符串

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T18:39:33.973

回车符包含在`password`.

# .net - 删除 Sandcastle 中的命名空间前缀

> ID：870186
> 
> 赞同：5
> 
> 时间：2009-05-15T18:35:32.313
> 
> 标签：.net, namespaces, sandcastle

我有一个带有长名称空间的大型项目，例如

```
CompanyName.Product.Component.Class 
```

使用 Sandcastle 构建命名空间的文档，但是那些长的命名空间确实搞砸了最终 chm 文件中内容窗格的显示。我怎样才能让它`Component.Class`至少显示在 Treeview 面板中？

和/或可能`CompanyName`作为根节点展开`Product`，然后展开到`Component`，展开到 Component 下的所有命名空间？

# python - 使用 Python 通过 SOAP 调度 JasperServer 报告

> ID：870188
> 
> 赞同：6
> 
> 时间：2009-05-15T18:36:02.687
> 
> 标签：python, soap, jasper-reports, jasperserver

我能够弄清楚如何使用带有 SOAPpy 和 xml.dom minidom 的 Python 在 JasperServer 上运行报告、下载文件、列出文件夹等。

这是一个执行报告请求的示例，它有效：

```
repositoryURL = 'http://user@pass:myjasperserver:8080/jasperserver/services/repository'
repositoryWSDL = repositoryURL + '?wsdl'
server = SOAPProxy(repositoryURL, repositoryWSDL)
print server._ns(repositoryWSDL).runReport('''
  <request operationName="runReport" locale="en">
    <argument name="RUN_OUTPUT_FORMAT">PDF</argument>
    <resourceDescriptor name="" wsType="" uriString="/reports/baz">
      <label>null</label>
      <parameter name="foo">bar</parameter>
    </resourceDescriptor>
  </request>
''') 
```

但是，我无法正确格式化服务器“ReportScheduler”部分的请求。我已经查阅了位于此处的文档（[http://jasperforge.org/espdocs/docsbrowse.php?id=74&type=docs&group_id=112&fid=305](http://jasperforge.org/espdocs/docsbrowse.php?id=74&type=docs&group_id=112&fid=305)），并尝试在他们的样本之后对我的请求进行建模，但没有成功（参见第 27 页）。

这是我尝试过的两个示例，它们都返回相同的错误：

```
schedulingURL = 'http://user@pass:myjasperserver:8080/jasperserver/services/ReportScheduler'
schedulingWSDL = schedulingURL + '?wsdl'
server = SOAPProxy(schedulingURL, schedulingWSDL)

# first request
print server._ns(schedulingWSDL).scheduleJob('''
  <request operationName="scheduleJob" locale="en">
    <job>
      <reportUnitURI>/reports/baz</reportUnitURI>
      <label>baz</label>
      <description>baz</description>
      <simpleTrigger>
        <startDate>2009-05-15T15:45:00.000Z</startDate>
        <occurenceCount>1</occurenceCount>
      </simpleTrigger>
      <baseOutputFilename>baz</baseOutputFilename>
      <outputFormats>
        <outputFormats>PDF</outputFormats>
      </outputFormats>
      <repositoryDestination>
        <folderURI>/reports_generated</folderURI>
        <sequentialFilenames>true</sequentialFilenames>
        <overwriteFiles>false</overwriteFiles>
      </repositoryDestination>
      <mailNotification>
        <toAddresses>my@email.com</toAddresses>
        <subject>test</subject>
        <messageText>test</messageText>
        <resultSendType>SEND_ATTACHMENT</resultSendType>
      </mailNotification>
    </job>
  </request>''')

# second request (trying different format here)
print server._ns(schedulingWSDL).scheduleJob('''
  <ns1:scheduleJob soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:ns1="http://www.jasperforge.org/jasperserver/ws">
  <job xsi:type="ns1:Job">
    <reportUnitURI xsi:type="xsd:string">/reports/baz</reportUnitURI>
    <username xsi:type="xsd:string" xsi:nil="true"/>
    <label xsi:type="xsd:string">baz</label>
    <description xsi:type="xsd:string">baz</description>
    <simpleTrigger xsi:type="ns1:JobSimpleTrigger">
      <timezone xsi:type="xsd:string" xsi:nil="true"/>
      <startDate xsi:type="xsd:dateTime">2008-10-09T09:25:00.000Z</startDate>
      <endDate xsi:type="xsd:dateTime" xsi:nil="true"/>
      <occurrenceCount xsi:type="xsd:int">1</occurrenceCount>
      <recurrenceInterval xsi:type="xsd:int" xsi:nil="true"/>
      <recurrenceIntervalUnit xsi:type="ns1:IntervalUnit" xsi:nil="true"/>
    </simpleTrigger>
    <calendarTrigger xsi:type="ns1:JobCalendarTrigger" xsi:nil="true"/>
    <parameters soapenc:arrayType="ns1:JobParameter[4]" xsi:type="soapenc:Array" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/">
    </parameters>
    <baseOutputFilename xsi:type="xsd:string">test</baseOutputFilename>
    <outputFormats soapenc:arrayType="xsd:string[1]" xsi:type="soapenc:Array" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/">
      <outputFormats xsi:type="xsd:string">PDF</outputFormats>
    </outputFormats>
    <outputLocale xsi:type="xsd:string" xsi:nil="true"/>
    <repositoryDestination xsi:type="ns1:JobRepositoryDestination">
      <folderURI xsi:type="xsd:string">/reports_generated</folderURI>
      <sequentialFilenames xsi:type="xsd:boolean">false</sequentialFilenames>
      <overwriteFiles xsi:type="xsd:boolean">false</overwriteFiles>
    </repositoryDestination>
    <mailNotification xsi:type="ns1:JobMailNotification" xsi:nil="true"/>
  </job>
  </ns1:scheduleJob>''') 
```

这些请求中的每一个都会导致错误：

```
SOAPpy.Types.faultType: <Fault soapenv:Server.userException: org.xml.sax.SAXException:
Bad types (class java.lang.String -> class com.jaspersoft.jasperserver.ws.scheduling.Job):
<SOAPpy.Types.structType detail at 14743952>: {'hostname': 'myhost'}> 
```

任何帮助/指导将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-15T20:58:53.043

在完全不了解 Jasper 的情况下，我可以向您保证，您最好用一个基于[出色 suds 库](https://fedorahosted.org/suds/)的简单客户端来替换硬编码的 SOAP 请求。它抽象出 SOAP 并为您提供干净利落的 API 访问。

`easy_install suds`并且[文档](https://fedorahosted.org/suds/wiki/Documentation)应该足以让您继续前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-13T23:22:34.973

我在 minidom 方面有过很多不好的经历。我建议您使用[lxml](http://codespeak.net/lxml/)。我对肥皂本身没有任何经验，所以我不能谈论这个问题的其余部分。

# tomcat - 为您的 Web 应用程序提供服务的 JVM 是否会在重新部署到应用程序服务器时重新启动？

> ID：870190
> 
> 赞同：2
> 
> 时间：2009-05-15T18:36:13.107
> 
> 标签：tomcat, jakarta-ee, weblogic

这是您可以配置和/或依赖于您的应用程序服务器的东西吗？我想知道当您重新部署应用程序时是否会重建单例对象。

我宁愿在这里问并尝试得到一个简洁的答案，而不是随机搜索或诉诸阅读 J2EE Servlet Specs -

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T18:54:09.960

不，它不会（至少我知道没有应用服务器）。servlet 规范为您提供了管理应用程序生命周期的[ServletContextListener](http://java.sun.com/products/servlet/2.3/javadoc/javax/servlet/ServletContextListener.html)挂钩。一些应用程序服务器（如 JBoss）为单例 bean (@Service) 提供了特殊注释，而 EJB 3.1 为您提供了 @Singleton 注释。使用单例时要考虑的另一件事是，当您对应用程序进行集群时会发生什么，您将需要高可用性 (HA) 或使用某种类型的复制，除非您使用无共享方法。出于这个原因，分布式缓存很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T19:05:18.450

这个问题的简短回答是否定的。我不知道任何以这种方式运行的应用程序服务器。但是，有几点需要指出。下面是一个简单的解释：

当您的应用程序服务器（即带有 Tomcat 的 JBoss）启动时，它会在类加载器中加载一些类，这些类将由所有应用程序共享。当它部署你的应用程序时，它会将这些类加载到它自己的类加载器中。当您取消部署应用程序时，该类加载器及其所有类都将被垃圾回收。因此，当重新部署应用程序时，您的所有类都将重新加载，并且您的单例将被重新实例化。

您的应用程序将（理论上，至少）在重新部署后表现相同，就像在 JVM/Application Server 重新启动后一样。

最后的提示：如果您想在您的企业 Java 应用程序中使用单例模式，请确保您了解单例对象在应用程序服务器环境中的局限性。例如，如果您想对应用程序进行集群化，您可能会遇到问题。

# c# - 以编程方式隐形连接 Windows VPN

> ID：870191
> 
> 赞同：0
> 
> 时间：2009-05-15T18:36:17.460
> 
> 标签：c#, windows, vpn

如何编写代码以通过 Windows VPN 客户端进行连接？

我希望这个过程在登录期间不可见地发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-26T17:12:21.157

远程访问服务 API 是您所追求的，特别是 RasDial 函数：

[https://msdn.microsoft.com/en-us/library/windows/desktop/aa377004(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/aa377004(v=vs.85).aspx)

请记住，您必须在应用程序退出之前调用 RasHangUp，以便干净地关闭连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T18:39:42.087

不要为代码烦恼。您可以将 Windows 配置为在登录时自动连接到 vpn。

# python - AuthSub 与谷歌应用引擎中的 Text_db

> ID：870192
> 
> 赞同：1
> 
> 时间：2009-05-15T18:36:34.543
> 
> 标签：python, google-app-engine, authentication, gdata-api

我正在尝试使用 text_db 和 authsub 从应用引擎读取电子表格。

我阅读了[http://code.google.com/appengine/articles/gdata.html](http://code.google.com/appengine/articles/gdata.html)并让它工作。然后我阅读了[http://code.google.com/p/gdata-python-client/wiki/AuthSubWithTextDB](http://code.google.com/p/gdata-python-client/wiki/AuthSubWithTextDB)并尝试将两者合并到下面的文件中（step4.py），但是当我在本地运行它时，我得到：

```
Traceback (most recent call last):
  File "/home/jmvidal/share/progs/googleapps/google_appengine/google/appengine/ext/webapp/__init__.py", line 498, in __call__
    handler.get(*groups)
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/step4.py", line 56, in get
    session_token = client._GetDocsClient().UpgradeToSessionToken(auth_token) #If I don't pass this argument I get a NonAuthSubToken
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/service.py", line 866, in UpgradeToSessionToken
    self.SetAuthSubToken(self.upgrade_to_session_token(token))
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/service.py", line 885, in upgrade_to_session_token
    headers={'Content-Type':'application/x-www-form-urlencoded'})
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/gdata/auth.py", line 678, in perform_request
    return http_client.request(operation, url, data=data, headers=headers)
  File "/home/jmvidal/share/progs/googleapps/google_appengine/glassboard/atom/http.py", line 163, in request
    return connection.getresponse()
  File "/home/jmvidal/share/progs/googleapps/google_appengine/google/appengine/dist/httplib.py", line 200, in getresponse
    self._allow_truncated, self._follow_redirects)
  File "/home/jmvidal/share/progs/googleapps/google_appengine/google/appengine/api/urlfetch.py", line 267, in fetch
    raise DownloadError(str(e))
DownloadError: ApplicationError: 2 nonnumeric port: '' 
```

任何人都可以对此有所了解吗？具体来说，为什么原来的（第一个链接中的 step3.py）有效，但我在这里对 UpgradeToSessionToken 的调用失败了？

```
# step4.py
#
# Trying to read spreadsheets from app engine using text_db and authsub.
#
# Merge of this code
# http://code.google.com/p/gdata-python-client/wiki/AuthSubWithTextDB
# with this one
# http://code.google.com/appengine/articles/gdata.html (step 3)

import wsgiref.handlers
import cgi
from google.appengine.ext import webapp
from google.appengine.api import users
import atom.url
import gdata.service
import gdata.alt.appengine
import gdata.spreadsheet.text_db
import settings

class Fetcher(webapp.RequestHandler):

  def get(self):
    # Write our pages title
    self.response.out.write("""<html><head><title>
        Google Data Feed Fetcher: read Google Data API Atom feeds</title>""")
    self.response.out.write('</head><body>')
    next_url = atom.url.Url('http', settings.HOST_NAME, path='/step4')
    # Allow the user to sign in or sign out
    if users.get_current_user():
      self.response.out.write('<a href="%s">Sign Out</a><br>' % (
          users.create_logout_url(str(next_url))))
    else:
      self.response.out.write('<a href="%s">Sign In</a><br>' % (
          users.create_login_url(str(next_url))))

    # Initialize a client to talk to Google Data API services.
#    client = gdata.service.GDataService()
#    auth_url =  client.GenerateAuthSubURL(
#      next_url,
#      ('http://docs.google.com/feeds/',), secure=False, session=True)

    client = gdata.spreadsheet.text_db.DatabaseClient()
    auth_url = client._GetDocsClient().GenerateAuthSubURL(
      next_url,
      ('http://spreadsheets.google.com/feeds/','http://docs.google.com/feeds/documents/'), secure=False, session=True)

    gdata.alt.appengine.run_on_appengine(client)

    feed_url = self.request.get('feed_url')

    session_token = None
    # Find the AuthSub token and upgrade it to a session token.
    auth_token = gdata.auth.extract_auth_sub_token_from_url(self.request.uri)
    if auth_token:
      # Upgrade the single-use AuthSub token to a multi-use session token.
      client._GetDocsClient().SetAuthSubToken(auth_token)
      session_token = client._GetDocsClient().UpgradeToSessionToken(auth_token) #If I don't pass this argument I get a NonAuthSubToken
      client._GetSpreadsheetsClient().SetAuthSubToken(client._GetDocsClient().GetAuthSubToken())
#      session_token = client.upgrade_to_session_token(auth_token)
    if session_token and users.get_current_user():
      # If there is a current user, store the token in the datastore and
      # associate it with the current user. Since we told the client to
      # run_on_appengine, the add_token call will automatically store the
      # session token if there is a current_user.
      client.token_store.add_token(session_token)
    elif session_token:
      # Since there is no current user, we will put the session token
      # in a property of the client. We will not store the token in the
      # datastore, since we wouldn't know which user it belongs to.
      # Since a new client object is created with each get call, we don't
      # need to worry about the anonymous token being used by other users.
      client.current_token = session_token

    self.response.out.write('<div id="main">')
    self.fetch_feed(client, feed_url)
    self.response.out.write('</div>')
    self.response.out.write(
        '<div id="sidebar"><div id="scopes"><h4>Request a token</h4><ul>')
    self.response.out.write('<li><a href="%s">Google Documents</a></li>' % (auth_url))
    self.response.out.write('</ul></div><br/><div id="tokens">')

  def fetch_feed(self, client, feed_url):
    # Attempt to fetch the feed.
    if not feed_url:
      self.response.out.write(
          'No feed_url was specified for the app to fetch.<br/>')
      example_url = atom.url.Url('http', settings.HOST_NAME, path='/step4',
          params={'feed_url':
              'http://docs.google.com/feeds/documents/private/full'}
          ).to_string()
      self.response.out.write('Here\'s an example query which will show the'
          ' XML for the feed listing your Google Documents <a '
          'href="%s">%s</a>' % (example_url, example_url))
      return
    try:
      response = client.Get(feed_url, converter=str)
      self.response.out.write(cgi.escape(response))
    except gdata.service.RequestError, request_error:
      # If fetching fails, then tell the user that they need to login to
      # authorize this app by logging in at the following URL.
      if request_error[0]['status'] == 401:
        # Get the URL of the current page so that our AuthSub request will
        # send the user back to here.
        next = atom.url.Url('http', settings.HOST_NAME, path='/step4',
          params={'feed_url': feed_url})
        # If there is a current user, we can request a session token, otherwise
        # we should ask for a single use token.
        auth_sub_url = client.GenerateAuthSubURL(next, feed_url,
            secure=False, session=True)
        self.response.out.write('<a href="%s">' % (auth_sub_url))
        self.response.out.write(
            'Click here to authorize this application to view the feed</a>')
      else:
        self.response.out.write(
            'Something went wrong, here is the error object: %s ' % (
                str(request_error[0])))

def main():
  application = webapp.WSGIApplication([('/.*', Fetcher),], debug=True)
  wsgiref.handlers.CGIHandler().run(application)

if __name__ == '__main__':
  main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T19:10:42.587

与往常一样，我只有在放弃并寻求帮助后才能找到答案。

我们需要再添加两个对 run_on_appengine 的调用（以注册 text_db 客户端拥有的两个客户端）：

```
gdata.alt.appengine.run_on_appengine(client)
gdata.alt.appengine.run_on_appengine(client._GetDocsClient())
gdata.alt.appengine.run_on_appengine(client._GetSpreadsheetsClient()) here 
```

我本来希望第一次调用 run_on_appengine 会导致另外两个调用，但我想不会。

哦，将 auth_url 行更改为：

```
auth_url = client._GetDocsClient().GenerateAuthSubURL(
      next_url,scope='http://spreadsheets.google.com/feeds/ http://docs.google.com/feeds/documents/', secure=False, session=True) 
```

在列表中传递范围 url 会导致“令牌没有正确的范围”错误。

# javascript - 当它的父容器调整大小时自动调整 dojo dijit.Grid 小部件的大小

> ID：870199
> 
> 赞同：7
> 
> 时间：2009-05-15T18:37:41.950
> 
> 标签：javascript, dojo

我在 TitlePane 中有一个 dojo Grid 小部件，它的宽度设置为 100%。

TitlePane 处于流动布局中，因此它的宽度随浏览器窗口大小而变化。我遇到的问题是，当父窗口扩展（或收缩）时，网格本身不会改变它的宽度。我可以通过在网格上调用 render() 来调整其自身大小，但是如何检测到父窗口已调整大小以便我知道重绘网格小部件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T13:47:02.793

我有时不得不这样做；这不是太难：

```
function resizeGrid() {
   // do whatever you need here, e.g.:
   myGrid.resize();
   myGrid.update();
}

dojo.addOnLoad(function() {
   dojo.connect(window, "onresize", resizeGrid);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-28T13:38:09.203

我有同样的问题。我尝试了类似于 Ryan Corradini 的解决方案。

只有第一次显示是可以的。如果我更改窗口大小，则正确调用 resize 函数，但网格的大小保持不变。

请注意我的特殊情况：在调整大小功能中，我必须设置网格的高度属性（仅调整大小+更新似乎不够）。

HTML 看起来像：

```
<div id="msgItems" dojoType="dijit.layout.ContentPane" region="center"
 style="padding:2px;">
<form id="msgDefForm" name="msgDefForm" dojoType="dijit.form.Form">
<div style="display:none;"><input type="text" name="msgName" id="msgName" dojoType="dijit.form.TextBox"></input>
</div>

<table dojoType="dojox.grid.DataGrid" jsId="msgGrid" id="msgGrid"
rowsPerPage="10" rowSelector="5px" singleClickEdit="false" loadingMessage="Loading message content"  
errorMessage="Error while loading the message content" selectable="true"  >
  <thead>
    <tr>
      <th field="zone" width="8em" cellType="dojox.grid.cells.Select" options="properties, values" editable="true">Zone</th>
      <th field="property" width="auto" editable="true">Property</th>
      <th field="value" width="auto" editable="true">Value</th>
    </tr>
  </thead>
</table>

</form>
</div> 
```

JS看起来像：

```
... in startOnLoad :
dojo.connect( window, "onresize", msgGridResized);
msgGridResized ();
...

function msgGridResized () {
    var cont = dojo.byId("msgItems")
    var h = cont.clientHeight - 4;
    if (h >= 0){
        var grd = dijit.byId("msgGrid");
        grd.attr("height", h+"px" );
        grd.resize();
        grd.update();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-15T16:04:48.653

没有时间为您尝试，但您不能直接 dojo.connect 到 TitlePane 的调整大小事件并在处理程序中调整网格大小或使用声明/标记中的百分比设置网格大小吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-04T07:51:16.580

您可以尝试使用以下代码：

```
grid.resize({ w: 400, h: 400 }); 
```

如果你想更通用一点：

```
var parentDiv = dom.byId('parentDiv');
grid.resize({ w: parentDiv.clientWidth, h: parentDiv.clientHeight }); 
```

参考：[Dojo DataGrid height resize not working](https://stackoverflow.com/questions/31819910/dojo-datagrid-height-resize-not-working)

希望它对你有用

# tsql - 在 T-SQL 中使用 DATEDIFF

> ID：870204
> 
> 赞同：6
> 
> 时间：2009-05-15T18:38:54.707
> 
> 标签：tsql, datediff

我在 SQL 语句中使用 DATEDIFF。我正在选择它，我也需要在 WHERE 子句中使用它。这个说法不成立...

```
SELECT DATEDIFF(ss, BegTime, EndTime) AS InitialSave
FROM MyTable
WHERE InitialSave <= 10 
```

它给出了消息：*无效的列名“InitialSave”*

但是这个说法很好用......

```
SELECT DATEDIFF(ss, BegTime, EndTime) AS InitialSave
FROM MyTable
WHERE DATEDIFF(ss, BegTime, EndTime) <= 10 
```

我的程序员说这是低效的（好像我调用了两次函数）。

所以两个问题。为什么第一个语句不起作用？使用第二条语句来做这件事效率低吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T18:52:54.503

**注意：**当我最初写这个答案时，我说其中一个列上的索引可以创建一个比其他答案执行得更好的查询（并提到了 Dan Fuller 的）。但是，我并没有 100% 正确地思考。*事实是，如果没有计算列或索引（物化）视图，则需要*进行全表扫描，因为要比较的两个日期列来自*同一个*表！

我相信下面的信息仍然有价值，即 1) 在正确的情况下提高性能的可能性，例如在不同表中的列之间进行比较时，以及 2) 促进 SQL 开发人员遵循最佳实践和重塑的习惯他们的思路是正确的。

**使条件变得可行**

我所指的最佳实践是将一列单独移动到比较运算符的一侧，如下所示：

```
SELECT InitialSave = DateDiff(second, T.BegTime, T.EndTime)
FROM dbo.MyTable T
WHERE T.EndTime <= T.BegTime + '00:00:10' 
```

正如我所说，这不会避免对单个表进行扫描，但是，在这种情况下，它可能会产生巨大的影响：

```
SELECT InitialSave = DateDiff(second, T.BegTime, T.EndTime)
FROM
   dbo.BeginTime B
   INNER JOIN dbo.EndTime E
      ON B.BeginTime <= E.EndTime
      AND B.BeginTime + '00:00:10' > E.EndTime 
```

`EndTime`在这两种情况下，现在单独在比较的一侧。假设该`BeginTime`表的行数要少得多，并且该`EndTime`表在 column 上有一个索引`EndTime`，这将比使用`DateDiff(second, B.BeginTime, E.EndTime)`. 它现在是*sargable*，这意味着有一个有效的“搜索参数”——所以当引擎*扫描*表时`BeginTime`，它可以*搜索*表`EndTime`。需要仔细选择哪一列单独位于运算符的一侧 -`BeginTime`通过做一些代数切换到`AND B.BeginTime > E.EndTime - '00:00:10'`

**DateDiff 的精度**

我还应该指出，`DateDiff`它不会返回*经过*的时间，而是计算跨越的*边界*数。如果调用`DateDiff`using seconds 返回`1`，这可能意味着`3 ms`经过的时间，或者可能意味着`1997 ms`！这本质上是 +- 1 个时间单位的精度。为了获得更好的 +- 1/2 时间单位精度，您需要以下查询`0`来比较`EndTime - BegTime`：

```
SELECT DateDiff(second, 0, EndTime - BegTime) AS InitialSave
FROM MyTable
WHERE EndTime <= BegTime + '00:00:10' 
```

现在，最大舍入误差总共只有一秒，而不是两秒（实际上是 floor() 操作）。请注意，您只能减去`datetime`数据类型 - 减去一个`date`或一个`time`值，您必须转换为`datetime`或使用其他方法来获得更好的精度（一大堆`DateAdd`，`DateDiff`可能还有其他垃圾，或者可能使用更高的精度时间单位和划分）。

在计算小时、天或月等较大单位时，这一原则尤其重要。A `DateDiff`of`1 month`可能相隔 62 天（想想 2013 年 7 月 1 日 - 2013 年 8 月 31 日）！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-15T18:43:58.517

您无法在 where 语句中访问 select 语句中定义的列，因为它们直到 where 执行后才会生成。

但是你可以这样做

```
select InitialSave from 
(SELECT DATEDIFF(ss, BegTime, EndTime) AS InitialSave
FROM MyTable) aTable
WHERE InitialSave <= 10 
```

作为旁注 - 这基本上将 DATEDIFF 移动到 where 语句中，就其首次定义的位置而言。在 where 语句中的列上使用函数会导致索引不能被有效地使用，如果可能的话应该避免，但是如果你必须使用 datediff 那么你必须这样做！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T19:09:36.617

**除了使它“工作”之外，您还需要使用索引**

使用带有索引的计算列或带有索引的视图，否则您将进行表扫描。当你得到足够多的行时，你会感觉到扫描慢的**痛苦！**

计算列和索引：

```
ALTER TABLE MyTable ADD
    ComputedDate  AS DATEDIFF(ss,BegTime, EndTime)
GO
CREATE NONCLUSTERED INDEX IX_MyTable_ComputedDate  ON MyTable 
    (
    ComputedDate
    ) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO 
```

创建视图和索引：

```
CREATE VIEW YourNewView
AS
SELECT
    KeyValues
        ,DATEDIFF(ss, BegTime, EndTime) AS InitialSave
    FROM MyTable
GO
CREATE CLUSTERED INDEX IX_YourNewView
    ON YourNewView(InitialSave)
GO 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T18:40:42.630

您必须使用该函数而不是列别名 - 它与 count(*) 等 PITA 相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T18:42:19.067

作为替代方案，您可以使用[计算列](http://msdn.microsoft.com/en-us/library/ms191250.aspx)。

# svn - 如何在没有文件系统访问权限的情况下复制 subversion repo？

> ID：870213
> 
> 赞同：5
> 
> 时间：2009-05-15T18:40:23.253
> 
> 标签：svn

我想知道是否有一种简单的方法可以复制 subversion 存储库而无需访问文件系统。这意味着我对 HTTP 接口具有只读访问权限。

基本上，我想拥有一个本地托管的开源项目存储库副本。他们像往常一样提供对颠覆回购的匿名访问。

我浏览了文档，我想我的 Google-fu 已经足够好了，因为我找不到任何关于做这样的事情的参考。

所以基本上我想下载所有的修订版，并能够使用 svnadmin 将它们导入到我自己的 repo 中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T18:57:07.910

我想你想要**`svnsync`**：

```
svnadmin create /localsvn
svnsync init file:///localsvn http://domain/svn
svnsync sync file:///localsvn 
```

您必须`pre-revprop-change`在本地存储库中启用挂钩，否则`svnsync`会抱怨。

但是，只需根据需要重复最后一个命令。

请注意，`svnsync`命令需要 URL 参数。

# php - 在 Amazon S3 上使用 php 强制下载

> ID：870215
> 
> 赞同：14
> 
> 时间：2009-05-15T18:40:44.937
> 
> 标签：php, download, amazon-s3

我正在尝试使用[http://code.google.com/p/amazon-s3-php-class/](http://code.google.com/p/amazon-s3-php-class/)从 AWS S3 强制下载文件。我有一个我希望人们“播放”或“下载”的 mp3。默认情况下，当您直接在 s3 上访问文件时，它开始在浏览器中播放。我需要添加一个选项来实际下载。我用谷歌搜索并发现什么都没有。我从概念上知道需要发生什么，但不知道如何生成它 php。我知道我需要将标题修改为 Content-Disposition: 附件。任何帮助将不胜感激。

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-05-05T20:31:42.080

亚马逊现在已经解决了这个问题，并允许在每个请求的基础上使用签名请求覆盖标头：

[http://docs.amazonwebservices.com/AmazonS3/latest/API/index.html?RESTObjectGET.html](http://docs.amazonwebservices.com/AmazonS3/latest/API/index.html?RESTObjectGET.html)

w00t！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-12-21T21:01:59.137

到目前为止已经提到的 php 脚本可以正常工作，但主要的缺点是每次您网站上的访问者请求文件时，您自己的服务器将从 S3 加载它，然后将该数据中继到浏览器。对于低流量站点，这可能没什么大不了的，但对于高流量站点，您绝对希望避免通过您自己的服务器运行所有内容。

幸运的是，有一种相当直接的方法可以将您的文件设置为强制从 S3 下载。你说得对——你只想设置 content-type 和 content-disposition （只是设置 content-disposition 将在某些浏览器中工作，但设置两者都应该在所有浏览器中工作）。

此代码假设您使用 Undesign 中的 Amazon S3 PHP 类：

```
<?php

// set S3 auth and get your bucket listing

// then loop through the bucket and copy each file over itself, replacing the "request headers":
S3::copyObject($bucketName, $filename, $bucketName, $filename, "public-read", array(), array("Content-Type" => "application/octet-stream", "Content-Disposition" => "attachment"));

?> 
```

现在您的所有文件都将被强制下载。您可能需要清除缓存才能看到更改。显然，不要对您确实希望在浏览器中“内联”加载的任何文件执行此操作。

这个解决方案的好处是直接加载媒体文件的应用程序（比如 Flash 中的 mp3 播放器）不关心内容类型或内容配置，因此您仍然可以在浏览器中播放文件，然后链接下载相同的文件。如果用户已经在闪存中完成了文件的加载，他们很可能仍将其保存在缓存中，这意味着他们的下载速度非常快，甚至不会从 S3 中花费任何额外的带宽费用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-09T05:34:03.773

只需将其添加到 s3 上的文件元数据中：

```
Content-Disposition: attachment; filename=FILENAME.EXT
Content-Type: application/octet-stream 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-07T09:50:25.473

只是想对此发表贡献，Alex Neth 在此参考上是正确的，但我认为使用亚马逊自己的 AWS PHP SDK2 的链接信息不足。下面我概述了一种以这种方式调用数据的基本（未经测试）方法，您可以使用 S3 工厂方法或 AWS Service Builder 来制作 S3 客户端。

```
<?php
// S3 Factory Method
/*use Aws\S3\S3Client;

$s3= S3Client::factory(array(
    'key'    => '<aws access key>',
    'secret' => '<aws secret key>'
));*/

// OR AWS Service Builder
use Aws\Common\Aws;

// Create a service builder using a configuration file
$aws = Aws::factory('/path/to/my_config.json');

// Get the client from the builder by namespace
$s3 = $aws->get('S3');

// Now lets create our request object.
$command = $s3->getCommand('GetObject',array(
    'Bucket'                        => 'your-bucket-name',
    'Key'                           => 'keyname',
    'ResponseContentType'           => 'application/octet-stream',
    'ResponseContentDisposition'    => 'attachment; filename="filename.mp3',
));
$url = $command->createPresignedUrl('+1 days');
?> 
```

然后你可以使用 PHP 的 header("Location: $url"); 为了通过强制下载将访问者重定向到 MP3 文件，这应该会阻止它在浏览器中播放，请注意，我经常使用 ResponseContentType，但我从未在 AWS 中使用过 ResponseContentDisposition（它应该根据文档工作）。

将此示例转换为函数应该很容易，您甚至可以像这样传递 $bucket、$key、$force_download

```
<?php
use Aws\Common\Aws;

function gen_url($bucket,$key,$force_download=false){
    // OR AWS Service Builder (personal method to do this)

    // Create a service builder using a configuration file
    $aws = Aws::factory('/path/to/my_config.json');

    // Get the client from the builder by namespace
    $s3 = $aws->get('S3');
    $params = array(
        'Bucket'                        => $bucket,
        'Key'                           => 'keyname',
        'ResponseContentType'           => 'application/octet-stream',
        'ResponseContentDisposition'    => 'attachment; filename="filename.mp3',
    );

    if($force_download){
        $params['ResponseContentType'] = 'application/octet-stream';
        $params['ResponseContentDisposition'] = 'attachment; filename="'.basename($key).'"';
    }

    $command = $s3->getCommand('GetObject',$params);
    return $command->createPresignedUrl('+1 days');
}

// Location redirection to an MP3 force downlaod
header("Location: ".gen_url("recordings","my-file.mp3",true));
// Location redirection to a MP3 that lets the browser decide what to do.
header("Location: ".gen_url("recordings","my-file.mp3"));

?> 
```

警告，如果您还没有弄清楚，这需要当前（2014 年 4 月 7 日）在此处找到的 AWS PHP SDK 2 [http://aws.amazon.com/sdkforphp/](http://aws.amazon.com/sdkforphp/)此代码主要是伪代码，可能需要一些额外的调整当我从内存中引用它时，实际工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T10:36:48.297

所以把我上面的例子修改成这样

```
 <?php

header('Content-Type: audio/mpeg');
header("Content-Disposition: attachment; filename={$_GET['file']};");

readfile("url to the file/{$_GET['file']}");

exit();

?> 
```

现在您需要在其中进行一些验证，这样您就不会让世界访问您放在 S3 上的每个文件，但这应该可以工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T21:18:16.380

如果您使用的是[Tarzan AWS](http://tarzan-aws.com/)之类的库，您可以添加元标头，亚马逊将在检索文件时包含该标头。在此处查看 update_object 函数中的元参数，例如： [http ://tarzan-aws.com/docs/2.0/files/s3-class-php.html#AmazonS3.update_object](http://tarzan-aws.com/docs/2.0/files/s3-class-php.html#AmazonS3.update_object)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-09-08T19:47:12.137

另外值得一提的是，您可以在 S3 中硬设置文件的标题。例如，如果您需要强制下载某个文件，您可以为该文件设置适当的标题。例如默认流式传输，或者将辅助文件设置为强制下载，或者花费带宽使用 php/fputs 并通过 PHP 强制下载。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-06T14:47:37.060

```
<?php
    require_once __DIR__.'/vendor/autoload.php';
    use Aws\Common\Aws;

    function gen_url($bucket,$key,$force_download=false){
        // OR AWS Service Builder (personal method to do this)

        $config = array(
                'key'    => '',
                'secret' => '',
        );

        // Create a service builder using a configuration file
        $aws = Aws::factory($config);

        // Get the client from the builder by namespace
        $s3 = $aws->get('S3');
        $params = array(
            'Bucket'                        => $bucket,
            'Key'                           => $key,
            'ResponseContentType'           => 'application/octet-stream',
            'ResponseContentDisposition'    => 'attachment; filename="'.$key,
        );

        if($force_download){
            $params['ResponseContentType'] = 'application/octet-stream';
            $params['ResponseContentDisposition'] = 'attachment; filename="'.basename($key).'"';
        }

        $command = $s3->getCommand('GetObject',$params);
        return $command->createPresignedUrl('+1 days');
    }

    $bucket = '';
    $filename = '';

    $url = gen_url($bucket,$filename,true);

    echo "\n".$url."\n\n"; 
```

上面的代码有效，你只需要在自动加载文件中安装 S3 composer 依赖项和链接，将你的密钥/秘密放入配置，然后提供存储桶/文件名。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T19:37:17.143

php 只会将文件下载到服务器，而不是客户端。请记住，php 在客户端上不做任何事情，它只是返回内容（html、javascript、css、xml 等等……）

[编辑：为清楚起见添加]：php 可以提供音频内容，但您希望同时提供网页和音频。要获得该客户端行为，您必须让客户端根据网页的 html 或 javascript 请求文件。

所以你必须让客户端下载文件。例如，在页面上有一个 iframe，文件的 url 在 s3 上。使用 css 使 iframe 不可见。它应该呈现页面并下载和播放 mp3。

否则，请考虑在页面加载时使用 javascript 来启动下载。我不确定这是否可能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-15T16:18:39.293

现在可以通过使用签名请求覆盖 ​​S3 标头来实现这一点。

> **请求参数**
> 
> 有时您希望覆盖 GET 响应中的某些响应标头值。例如，您可能会覆盖 GET 请求中的 Content-Disposition 响应标头值。
> 
> 您可以使用下表中列出的查询参数覆盖一组响应标头的值。
> 
> **response-content-type** - 设置响应的 Content-Type 标头 **response-content-disposition** - 设置响应的 Content-Disposition 标头。
> 
> **笔记**
> 
> 使用这些参数时，您必须使用授权标头或预签名 URL 对请求进行签名。它们不能与未签名（匿名）请求一起使用。

因此，您可以将这些标头设置为：

```
response-content-disposition: attachment; filename=FILENAME.EXT
response-content-type: application/octet-stream 
```

在这里找到答案：[https ://stackoverflow.com/a/5903710/922522](https://stackoverflow.com/a/5903710/922522)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-07-31T19:37:24.367

```
<?php
// PHP solution (for OP and others), works with public and private files
// Download url expires after 30 minutes (no experation after the download initiates, for large files)
// ***Forces client download***
$signed_url = $s3_client->getObjectUrl($s3_bucket_name, $s3_filename_key, '+30 minutes', array(
    'ResponseContentType' => 'application/octet-stream',
    'ResponseContentDisposition' => 'attachment; filename="your-file-name-here.mp4"'
));
redirect($signed_url); 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-05-20T23:12:30.397

我从未尝试过 Amazon 的 S3 托管，但您不能在那里使用 .htaccess 文件吗？然后，您可以使用以下条目为整个目录设置 Content-Type 和 Content-Disposition：

```
<IfModule mod_headers.c>
    <FilesMatch "\.(mp3)$">
            ForceType audio/mpeg
            Header set Content-Disposition attachment
    </FilesMatch>
</IfModule> 
```

# linq - 在 LINQ 查询中删除多条记录的最佳方法？

> ID：870216
> 
> 赞同：26
> 
> 时间：2009-05-15T18:41:08.383
> 
> 标签：linq, linq-to-sql

使用 LINQ 一次性删除多条记录的最佳方法是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-15T18:47:46.747

使用 Linq2Sql 删除记录

```
CustomerDataContext ctx = new CustomerDataContext("连接字符串");
var customers = ctx.Customers.Where(c => c.Name == "david");

ctx.Customers.DeleteAllOnSubmit(客户);
ctx.SubmitChanges();

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-08-23T18:07:10.857

这是我解决问题的方法：

```
 try
        {
            List<MaterialPartSerialNumber> list = db.MaterialPartSerialNumbers.Where(s => s.PartId == PartId && s.InventoryLocationId == NewInventoryLocationId && s.LocationId == LocationId).ToList();
            db.MaterialPartSerialNumbers.RemoveRange(list);
            db.SaveChanges();
        }
        catch(Exception ex)
        {
            string error = ex.Message;
        } 
```

首先，您可以找到要删除的项目列表。

然后，您可以使用该函数`RemoveRange(**list_of_item_to_delete**)`来删除数据库中存在的列表中的每个实例。

根据 MSDN，该方法从列表中删除了一系列元素。

有关更多信息，请在此处查看[https://msdn.microsoft.com/en-us/library/y33yd2b5(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/y33yd2b5(v=vs.110).aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-28T17:32:42.283

基于单个 where 子句删除许多记录

```
context.EntityModel
            .RemoveAll(r => r.property == "propertyEntered"); 
```

但是您也可以从数据库中删除不存在的记录`List<ListOfBadRecords>`

```
context.EntityModel
            .Where(w => w.propertyID == ID).ToList()
            .RemoveAll(r => !ListOfBadRecords.Any(a => a.anyID == r.propertyID )); 
```

编辑：

不确定哪个更快，但你也可以用这个做第二个查询

`.RemoveAll(r => !ListOfBadRecords.Select(s=>s.propertyID ).Contains(w.propertyID ))`

Edit2：不要忘记`context.SaveChanges();`我在初稿中所做的

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T18:47:12.737

好的旧 SPROC ......

您可以将 SPROC 拖到您的 DBML 文件中，它将在您的 databasecontext 类中生成一个丰富的方法。

*   [如何：使用 LINQ (Visual Basic) 调用存储过程](http://msdn.microsoft.com/en-us/library/bb918119.aspx)
*   [LINQ 和存储过程](http://blogs.msdn.com/zainnab/archive/2007/10/25/linq-and-stored-procedures.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-02-17T13:22:04.563

使用实体框架 6

```
// Database context
EntitiesContext db = new EntitiesContext(connString);
// Select all the records to be deleted
IEnumerable<entity> list = db.entity.where(x=>x.id == id).toList();
// Use Remove Range function to delete all records at once
db.entity.RemoveRange(list);
// Save changes
db.SaveChanges(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-15T18:51:43.587

以下内容更适用于 LINQ to Entities，但它可能会有所帮助：

[在 LINQ to Entities 中批量删除](https://stackoverflow.com/questions/869209/bulk-deleting-via-linq)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-22T17:43:43.063

这就是我使用的，首先创建要删除的记录所在的表的 IENumerable 对象，然后使用 RemoveRange，最后将更改保存到数据库。假设您想从 Products 表上的一个特定供应商 ID 中删除所有产品，您可以这样做。

IEnumerable ProductsToRemove= db.Products.Where(x => x.SupplierId== Supplierid); db.Products.RemoveRange(ProductsToRemove); db.SaveChanges();

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-28T16:39:38.810

也许这个答案有点晚了，但今天我自己遇到了这个要求，我和我想出了这个解决方案

```
CustomerDataContext ctx = new CustomerDataContext("connection string");

ctx.Customers.DeleteAllOnSubmit(ctx.Customers.Where(c => c.Name == "david"));

ctx.SubmitChanges(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-13T17:10:56.093

我同意 Khurram 的观点，使用带有 LINQ 的简单存储过程执行此操作效率更高（前提是您在 SQL 中有足够的权限来执行此操作）。我将用一个例子来补充这一点。

存储过程：

```
CREATE PROCEDURE [dbo].[RemovePermissionsFromRole] 
(
    @ROLE_ID int
)
AS
BEGIN
    SET NOCOUNT ON;

    DELETE FROM [RolePermissions] WHERE [RoleID] = @ROLE_ID;
END 
```

将存储过程从数据库资源管理器拖到 DBML 文件的方法窗格中。保存文件。在代码中：

```
if (Request.QueryString["RoleID"] != null) {
    int roleID = Convert.ToInt32(Request.QueryString["RoleID"]);

    SETSDataContext context = new SETSDataContext();
    context.RemovePermissionsFromRole(roleID);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-30T23:54:13.807

仅使用实体框架，我发现这是最严格的代码。

```
db.PreperProperties.RemoveRange(db.PreperProperties.Where(c => c.preperFk == prpr.id));
db.SaveChanges(); 
```

# database - B树和B+树有什么区别？

> ID：870218
> 
> 赞同：325
> 
> 时间：2009-05-15T18:42:14.047
> 
> 标签：database, data-structures

在**b 树**中，您可以将*键和数据存储在内部节点和叶节点中*，但在**b+ 树**中，您只能将数据存储在*叶节点中*。

在 b+ 树中执行上述操作有什么好处吗？

为什么不到处使用 b-tree 而不是 b+ 树，因为直观上它们看起来要快得多？

我的意思是，为什么需要在 b+ 树中复制密钥（数据）？

* * *

## 回答 #1

> 赞同：461
> 
> 时间：2012-08-17T23:42:46.803

下图有助于显示 B+ 树和 B 树之间的差异。

B+树的优点：

*   因为 B+ 树没有与内部节点关联的数据，所以一页内存可以容纳更多的键。因此，访问叶节点上的数据将需要更少的缓存未命中。
*   B+ 树的叶节点是链接的，因此对树中的所有对象进行全面扫描只需要一次线性遍历所有叶节点。另一方面，AB 树需要遍历树中的每一层。这种全树遍历可能会比 B+ 叶的线性遍历涉及更多的缓存未命中。

B树的优点：

*   因为 B 树包含每个键的数据，所以经常访问的节点可以更靠近根，因此可以更快地访问。

* * *

![B 和 B+ 树](https://i.stack.imgur.com/l6UyF.png)

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2009-05-15T19:05:43.427

B+ 树相对于 B 树的主要优点是它们允许您通过删除指向数据的指针来打包更多指向其他节点的指针，从而增加扇出并可能降低树的深度。

缺点是当您可能在内部节点中找到匹配项时没有提前出局。但是由于这两种数据结构都有巨大的扇出，所以绝大多数匹配都将在叶节点上，平均而言，B+ 树的效率更高。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-05-15T20:33:12.640

B+Trees 进行全扫描更容易且性能更高，例如查看树索引的每条数据，因为终端节点形成一个链表。要使用 B-Tree 进行全扫描，您需要进行全树遍历以查找所有数据。

另一方面，当您进行搜索（通过键查找特定数据）时，B 树可以更快，尤其是当树驻留在 RAM 或其他非块存储中时。由于您可以提升树中常用的节点，因此获取数据所需的比较更少。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2013-07-29T17:55:49.237

1.  在 B 树中，搜索键和数据存储在内部或叶节点中。但是在 B+-tree 中，数据只存储在叶子节点中。
2.  B+ 树的全扫描非常容易，因为所有数据都在叶节点中找到。B树的全扫描需要全遍历。
3.  在 B 树中，数据可能在叶节点或内部节点中找到。内部节点的删除非常复杂。在 B+ 树中，数据仅在叶节点中找到。叶节点的删除很容易。
4.  B树中的插入比B+树更复杂。
5.  B+ 树存储冗余搜索键，但 B 树没有冗余值。
6.  在 B+ 树中，叶节点数据按顺序链表排序，但在 B 树中，叶节点不能使用链表存储。许多数据库系统的实现更喜欢 B+ 树的结构简单性。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2014-06-17T13:19:21.910

来自数据库系统概念的示例 5th

B+-树 ![B+树](https://i.stack.imgur.com/rwrgt.png)

对应的B树 ![B树](https://i.stack.imgur.com/gikEE.png)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-07-12T15:50:36.663

Adegoke A，阿米特

我想你们缺少的一个关键点是本节中解释的数据和指针之间的区别。

指针：指向其他节点的指针。

数据：- 在数据库索引的上下文中，数据只是另一个指向驻留在其他地方的真实数据（行）的指针。

因此，在 B 树的情况下，每个节点都有三个信息键，指向与键关联的数据的指针和指向子节点的指针。

在 B+ 树内部节点保留指向子节点的键和指针，而叶节点保留指向关联数据的键和指针。对于给定大小的节点，这允许更多数量的密钥。节点的大小主要由块大小决定。

上面已经很好地解释了每个节点拥有更多密钥的优势，因此我将节省我的打字工作。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-05-15T19:52:02.707

B+ 树特别适合基于块的存储（例如：硬盘）。考虑到这一点，您将获得几个优势，例如（从我的脑海中）：

*   高扇出/低深度：这意味着您必须获得更少的块才能获取数据。数据与指针混合在一起，每次读取都会获得更少的指针，因此您需要更多的搜索来获取数据

*   简单一致的块存储：一个内部节点有 N 个指针，没有别的，一个叶节点有数据，没有别的。这使得解析、调试甚至重构变得容易。

*   高密钥密度意味着顶部节点几乎肯定在缓存中，在许多情况下，所有内部节点都会快速缓存，因此只有数据访问必须进入磁盘。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-05-15T18:45:07.703

定义“更快”。渐近地它们大致相同。不同之处在于它们如何使用辅助存储。维基百科上关于[B-trees](http://en.wikipedia.org/wiki/B-tree)和[B+trees](http://en.wikipedia.org/wiki/B%2B_tree)的文章看起来非常值得信赖。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-12-28T04:29:18.800

在 B+ 树中，由于内部节点只存储指针，因此它们的大小明显小于 B 树的内部节点（存储数据+键）。因此，可以在单个磁盘读取中从外部存储中获取 B+ 树的索引，并对其进行处理以查找目标的位置。如果它是 B 树，则每个决策过程都需要进行磁盘读取。希望我说清楚了！:)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-03-13T08:59:51.650

**

> B-Tree 的主要缺点是顺序遍历键的困难。B+ 树保留了 B-Tree 的快速随机访问特性，同时还允许快速顺序访问

** 参考：使用 C 的数据结构// 作者：Aaro M Tenenbaum

[http://books.google.co.in/books?id=X0Cd1Pr2W0gC&pg=PA456&lpg=PA456&dq=drawback+of+B-Tree+is+the+difficulty+of+Traversing+the+keys+sequentially&source=bl&ots=pGcPQSEJMS&sig= F9MY7zEXYAMVKl_Sg4W-0LTRor8&hl=en&sa=X&ei=nD5AUbeeH4zwrQe12oCYAQ&ved=0CDsQ6AEwAg#v=onepage&q=drawback%20of%20B-Tree%20is%20the%20difficulty%20of%20Traversing%20the%20keys%20sequentially&f=false](http://books.google.co.in/books?id=X0Cd1Pr2W0gC&pg=PA456&lpg=PA456&dq=drawback+of+B-Tree+is+the+difficulty+of+Traversing+the+keys+sequentially&source=bl&ots=pGcPQSEJMS&sig=F9MY7zEXYAMVKl_Sg4W-0LTRor8&hl=en&sa=X&ei=nD5AUbeeH4zwrQe12oCYAQ&ved=0CDsQ6AEwAg#v=onepage&q=drawback%20of%20B-Tree%20is%20the%20difficulty%20of%20Traversing%20the%20keys%20sequentially&f=false)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-11-12T15:39:21.710

B-tree 和 B+tree 的主要区别在于 B-tree 消除了搜索键值的冗余存储。由于 B-tree 中搜索键不重复，我们可能无法使用较少的树节点存储索引比在相应的 B+树索引中。但是，由于出现在非叶节点中的搜索键在 B 树中没有出现在其他任何地方，我们被迫为非叶节点中的每个搜索键包含一个额外的指针字段。它们是 B-tree 的空间优势，因为不会发生重复并且可用于大型索引。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-07-23T23:58:13.763

举个例子——你有一张表，每行都有大量数据。这意味着对象的每个实例都是 Big。

如果你在这里使用 B 树，那么大部分时间都花在扫描带有数据的页面上——这是没有用的。在数据库中，这是使用 B+ 树来避免扫描对象数据的原因。

B+ 树将键与数据分开。

但是，如果您的数据大小较小，那么您可以使用 B 树所做的密钥来存储它们。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-15T18:51:16.770

B+ 树的一种可能用途是它适用于树长得如此之大以至于无法放入可用内存的情况。因此，您通常希望执行多个 I/O。
经常会使用 B+ 树，即使它实际上适合内存，然后您的缓存管理器可能会将其永久保留在那里。但这是一种特殊情况，而不是一般情况，缓存策略与 B+ 树维护本身是分开的。

此外，在 B+ 树中，叶子页面在链表（或双向链表）中链接在一起，这优化了遍历（用于范围搜索、排序等）。所以指针的数量是所使用的特定算法的函数。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-05-03T12:24:25.290

B+树是一棵平衡树，其中从树根到叶子的每条路径都具有相同的长度，并且树的每个非叶子节点都有 [n/2] 到 [n] 个子节点，其中 n 是固定为特定的树。它包含索引页和数据页。二叉树每个父节点只有两个孩子，B+树每个父节点可以有可变数量的孩子

# c++ - 概述 rpg 平铺空间

> ID：870225
> 
> 赞同：1
> 
> 时间：2009-05-15T18:43:36.087
> 
> 标签：c++, tiles, collision

我试图让它在角色在瓷砖中的位置，当他们向上或向下移动时，它会移动到下一个瓷砖，但我不知道该怎么做。现在，我将它设置为角色移动像素的位置，但我希望它移动 1 个正方形。

现在的代码是这样的，它可以工作，但是在像素模式下会出现故障。我相信如果它是块它可能会更好，但无论如何我可能会改变它。

```
float spritewidth  = sprite->stretchX;
float spriteheight = sprite->stretchY;
float bushwidth  = bush->stretchX;
float bushheight = bush->stretchY;
//Basic border collision
if (sprite->x <= 0)
 sprite->x = 0;

if (sprite->y <= 0)
 sprite->y = 0;

if (sprite->x >= 455)
 sprite->x = 455;

if (sprite->y >= 237)
 sprite->y = 237;

if ( (sprite->x + spritewidth > bush->x) && (sprite->x < bush->x + bushwidth) && (sprite->y + spriteheight > bush->y) && (sprite->y < bush->y + bushheight) ) 
{
         bushcol = 1;               
}
else
{
        bushcol = 0;      
}

if (osl_keys->held.down)
{
if (bushcol == 1) 
{
sprite->y = bush->y - spriteheight - 3;
        bushcol = 0; 
}
else
{
        bushcol = 0; 
        sprite->y += 3;
}
}
if (osl_keys->held.up)
{
 if (bushcol == 1) 
{
    sprite->y = bush->y + bushheight + 3;
    bushcol = 0;
}
    else
{ 
        bushcol = 0; 
        sprite->y -= 3;
}
}
if (osl_keys->held.right)
{
 if (bushcol == 1) 
{
    sprite->x = bush->x - spritewidth - 3;
    bushcol = 0;
}
    else
{ 
         bushcol = 0; 
    sprite->x += 3;}
}
if (osl_keys->held.left)
{
        if (bushcol == 1) 
{
    sprite->x = bush->x + bushwidth + 3;
    bushcol = 0; 
}
    else
{ 
        bushcol = 0; 
        sprite->x -= 3;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:37:08.847

如果您希望角色一次移动一个图块/正方形/块，只需将精灵移动图块宽（或高）的像素数。

```
const int tile_width = 32; // or something

// and then
sprite->x += tile_width; 
```

# java - 使用 J2ME 发送 SMS 的代码

> ID：870226
> 
> 赞同：4
> 
> 时间：2009-05-15T18:43:46.303
> 
> 标签：java, java-me, sms, wma

我正在寻找使用 J2ME 发送 SMS 的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T05:50:59.607

您可以尝试下面的代码来实现这一点：

```
private boolean SendSMS(String sPhoneNo, String sMessage) {
    boolean result = true;

    try {
        String addr = "sms://" + sPhoneNo;
        MessageConnection conn = (MessageConnection) Connector.open(addr);
        TextMessage msg = (TextMessage) 
            conn.newMessage(MessageConnection.TEXT_MESSAGE);
        msg.setPayloadText(sMessage);
        conn.send(msg);
        conn.close();
    } 

    catch (SecurityException se) {
        result = false;
    } 

    catch (Exception e) {
        result = false;
    }

    return result;
} 
```

您可以通过添加以下内容来指定任何特殊端口`":port_no"`：

```
"String addr = "sms://" + sPhoneNo" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-08T05:07:55.333

启动此线程发送短信

```
public class SendSMS extends Thread {

private String receiver;
private String receivedMsg;
private HomeScreen home;
private boolean bool = false;
private boolean notsent;

public SendSMS(HomeScreen gen, String msg, String number) {
    this.home = gen;
    this.receiver = number;
    this.receivedMsg = msg;
}

public void run() {
    while (!bool) {
        SendMessage();
    }
}

/**
 * Send the mesage using WMA api.
 */
private void SendMessage() { 
    String s = "sms://" + receiver;
    send(s);
}

private void send(String url) {
    MessageConnection messageconnection = null;
    try {
        messageconnection = (MessageConnection) Connector.open(url);
        TextMessage textmessage = (TextMessage) messageconnection.newMessage(MessageConnection.TEXT_MESSAGE);
        textmessage.setAddress(url);
        textmessage.setPayloadText(receivedMsg);
        messageconnection.send(textmessage);
    } catch (Exception throwable) {
        notsent = true;
        home.genericObject.setSmsStatus(false);
        if (!home.isNokia()) {
            new PopUp("Message not sent"); // not sent
        }
        bool = true;
        try {
            messageconnection.close();
        } catch (Exception e) {
        }
    }

    if (messageconnection != null) {
        try {
            messageconnection.close();
            if (!notsent) {
                home.genericObject.setSmsStatus(false);
                if (!home.isNokia()) {
                    new PopUp("Message Sent"); // sent
                }
            }
            bool = true;
        } catch (Exception ie) {
            ie.printStackTrace();
        }
    }
  }
} 
```

如果消息是从 j2me 发送的，诺基亚设备不会显示系统警报。因此，如果您想显示警报，则必须创建自己的 PopUp 并显示。

# windows - gnuwin32 inetutils 包去哪儿了？

> ID：870233
> 
> 赞同：2
> 
> 时间：2009-05-15T18:44:28.393
> 
> 标签：windows, gnu, telnet, gnuwin32

网上有gnuwin32 inetutils包的痕迹。但它不再在网站上。它在哪里？具体来说，win32 的 gnu telnet 应用程序在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T14:16:24.813

Inetutils 有很多依赖项，因此很难在没有任何 POSIX 层的情况下直接在 Win32 上编译和运行。但是您可以在其他包中找到一些 inetutils 工具或使用类似的 Microsoft Windows 命令行工具。以下是开源或免费[inetutils 工具](http://www.gnu.org/software/inetutils/manual/html_node/index.html)的列表，您可以在哪里找到它们：

*   **hostname**：显示或设置系统主机名。您可以在[CoreUtils](http://gnuwin32.sourceforge.net/packages/coreutils.htm)中找到它。
*   **logger**：将消息发送到系统日志。无法使用。
*   **ping**：发送到网络主机的数据包。不可用，但您可以使用类似的[Microsoft Windows ping命令。](http://technet.microsoft.com/en-us/library/cc737478%28v=ws.10%29.aspx)
*   **traceroute**：跟踪到主机的路由。不可用，但您可以使用类似的[Microsoft Windows tracert命令。](http://technet.microsoft.com/en-us/library/cc757819%28v=ws.10%29.aspx#BKMK_tcpip_tro_using_tracert)
*   **whois** : Whois 用户界面。您可以使用[gnuwin32 Jwhois](http://gnuwin32.sourceforge.net/packages/jwhois.htm)作为替代品。
*   **ftp** : FTP 客户端。在 gnuwin32 中不可用，但您可以[从旧的 Emacs contrib 下载它](ftp://ftp.gnu.org/old-gnu/emacs/windows/contrib/ftp-for-win32.zip)
*   **tftp**：TFTP 客户端。在 gnuwin32 中不可用，但您可以使用类似的[Microsoft Windows tftp命令。](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/tftp.mspx)
*   **rsh**：远程外壳。在 gnuwin32 中不可用，但您可以使用[Microsoft Windows rsh](http://www.ccs.neu.edu/home/bchafy/rsh_vista.html)命令或为没有它[的 Windows Vista 或 7 使用 netkit rsh 端口。](http://www.ccs.neu.edu/home/bchafy/rsh_vista.html)
*   **rlogin**：远程登录。不能作为本机 Win32 命令行工具使用（您可以使用[putty](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)，但它不会在您的窗口下工作，它会创建一个新窗口）
*   **rcp**：在机器之间复制文件。在 gnuwin32 中不可用，但您可以使用类似的[Microsoft Windows rcp命令。](http://technet.microsoft.com/en-us/library/bb490980.aspx)
*   **rexec**：远程执行程序。在 gnuwin32 中不可用，但您可以使用类似但[Microsoft 不再支持的](http://technet.microsoft.com/en-us/library/ff945216%28WS.10%29.aspx)[Microsoft Windows rexec](http://technet.microsoft.com/en-us/library/cc755410%28WS.10%29.aspx)命令。
*   **talk** : 一个通讯程序。无法使用。
*   **telnet**：TELNET 的用户界面。在 gnuwin32 中不可用，但您可以使用[Microsoft Windows telnet](http://technet.microsoft.com/en-us/library/cc782300%28WS.10%29.aspx)，但它不会使用可能有问题的标准输入和输出。您也可以尝试[dtelnet](http://dtelnet.sourceforge.net/)，但它使用自己的窗口。您还可以查看[Wikipedia 列出的 telnet 客户端](http://en.wikipedia.org/wiki/Telnet#Telnet_clients)，但它们有时使用 cygwin 后端。

其他工具是您无法作为 Windows 本机可执行文件找到的守护程序，但您可以找到与这些工具等效的工具：

*   **inetd** : 内部超级服务器
*   **syslogd** : 系统服务日志功能
*   **ftpd** : FTP 守护进程
*   **tftpd** : TFTP 服务器
*   **rshd**：远程外壳服务器
*   **rlogind** : 远程登录服务器
*   **rexecd** : rexec 的服务器
*   **talkd**：用于用户之间通信的服务器
*   **telnetd** : 远程登录服务器
*   **uucpd** : Unix 到 Unix 复制

如果在这里找不到你需要的东西，那么你应该尝试通过 cygwin 使用 GNU inetutils。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:25:32.717

这可能不是很有帮助，但是：如果您只需要找到可以在 Windows 上以某种或其他形式运行的 inetutils，那么您可以在[Cygwin](http://www.cygwin.com/)中找到它。如果您专门寻找 gnuwin32 端口，那么我猜您很不走运。

# ipc - 使用 POSIX 共享内存时，您在哪里放置 POSIX 信号量？

> ID：870234
> 
> 赞同：3
> 
> 时间：2009-05-15T18:44:29.360
> 
> 标签：ipc, posix, shared-memory, semaphore

我正在尝试使用 POSIX 共享内存和 POSIX 信号量构建客户端服务器应用程序。我是否必须将信号量放在共享内存段中，或者信号量可以只是全局变量吗？我希望遵守 POSIX 约定。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T18:48:27.243

不，信号量是系统资源；您不必担心找到它们。

更新：让我“扩展和修改我的言论”。 *命名*信号量是系统资源。未命名的信号量必须在共享内存段中。请参阅[semaphores 的介绍手册页](http://linux.die.net/man/7/sem_overview)。

# css - 如果没有 javascript，我可以设置一个 div 样式来覆盖当前文档，包括它的边距吗？

> ID：870237
> 
> 赞同：1
> 
> 时间：2009-05-15T18:45:27.937
> 
> 标签：css, html, document, viewport

它可以使用 javascript 来完成，但仅使用 CSS，是否可以设置 div 的样式以与任何页面的文档内容或视口完全重叠（在页面上应用不透明的灰色层）？由于页面可以为其正文元素设置边距，因此将 div 样式设置为其正文元素的宽度是行不通的。（也需要在 IE 6 中工作）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T18:48:57.197

如果你有`<div>`这样的：

```
<div id="cover"></div> 
```

这些样式应该这样做：

```
#cover {
    background-color: #ccc;
    opacity: 0.6;
    filter:alpha(opacity=60);
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
} 
```

在正文有边距的页面上进行了测试，它覆盖了我在 IE 和 FF 上的整个视口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T18:55:33.403

高度：如果文档长度小于视口高度，则 100% 不会覆盖视口。在这种情况下，您将不得不使用 Javascript。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-15T18:50:54.367

使用 IE 在 CSS 中执行 javascript 的能力是作弊吗？

```
width:expression(document.body.clientWidth) 
```

# objective-c - 释放核心基础对象引用

> ID：870243
> 
> 赞同：20
> 
> 时间：2009-05-15T18:47:39.273
> 
> 标签：objective-c, cocoa, cocoa-touch, core-foundation

我是否需要释放核心基础对象来清理内存？如果是这样，怎么办？

例如，在代码中：

```
ABAddressBookRef addressBook = ABAddressBookCreate();
CFArrayRef peopleArray = ABAddressBookCopyArrayOfAllPeople(addressBook); 
```

我需要释放`peopleArray`吗？怎么样`addressBook`？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-15T18:50:28.673

是的，在 CoreFoundation 中，您必须发布名称中带有 Create 或 Copy 的任何内容。您可以使用 CFRelease() 执行此操作。在您的情况下，您应该同时发布数组和地址簿引用。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-05-15T18:51:53.477

[Core Foundation 中的内存管理规则](http://developer.apple.com/documentation/CoreFoundation/Conceptual/CFMemoryMgmt/Concepts/Ownership.html#//apple_ref/doc/uid/20001148)类似于 Cocoa 中的规则：如果返回引用的方法包含“创建”或“复制”字样，则您拥有该引用，并且必须调用该`CFRelease()`引用以放弃所有权。否则，您*不*拥有该引用并且必须调用`CFRetain`以获取所有权（必然要求后续`CFRelease`放弃该新所有权）。这些规则取自 Core Foundation 的内存管理编程指南：

*   如果您创建一个对象（直接或通过复制另一个对象——请参阅“创建规则”），您就拥有它。
*   如果你从其他地方得到一个对象，你就不拥有它。如果您想防止它被丢弃，您必须将自己添加为所有者（使用 CFRetain）。
*   如果您是对象的所有者，则必须在使用完毕后放弃所有权（使用 CFRelease）。

在您的示例中，必须释放the`addressBook`和 the 。`peopleArray`由于 Core Foundation 中没有`autorelease`等效项，因此如果您从方法返回引用，请返回数组*而不*释放它。您应该（除非您是邪恶的）然后在方法名称中包含“create”，以向调用者表明他们现在拥有对返回对象的引用。在这种情况下，CFArray 被免费桥接到`NSCFArray`，一个继承自 的 Objective-C 对象`NSObject`。因此，如果您需要从函数/方法返回它，您可以`peopleArray`转换为`NSArray*`and that：`autorelease`

```
return [(NSArray*)peopleArray autorelease]; 
```

请注意，这仅适用于免费桥接课程。我的理解是，制作自己的免费桥接类相当困难，并且只有原始（字符串、数组等）CF 类是免费桥接的，因此这种方法并不总是有效。最后，如果您可以避免使用`autorelease`（即您可以使您的内存管理更加明确），那可能总是一件好事。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T19:08:46.103

另一个没有人提到的小点是，一些 CF 类与他们的 NS 类有一个“免费桥”。`CFString`和`NSString`和`CFArray`都是`NSArray`示例。这是相关的，因为您可以只使用`release`这些类。

有关更多信息，请参阅[其他 StackOverflow 问题](https://stackoverflow.com/questions/806115/toll-free-bridges/806444)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T18:51:33.647

我建议阅读 Apple 关于 Core Foundation 内存管理的[指南](http://developer.apple.com/documentation/CoreFoundation/Conceptual/CFMemoryMgmt/CFMemoryMgmt.html)，以深入讨论这一点。他们也有一个类似的通用 Cocoa 内存管理指南。

要释放 CF 对象，您将调用该`CFRelease`函数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-05T20:14:50.490

对于 ARC，您可以使用。

```
return (__bridge_transfer NSArray*)peopleArray; 
```

"__bridge_transfer" 会将所有权转移给 ARC，因此您不需要任何进一步的发布调用。

# php - Zend_Db 问题...更新增量器

> ID：870245
> 
> 赞同：3
> 
> 时间：2009-05-15T18:47:45.903
> 
> 标签：php, zend-framework, zend-db

这应该工作吗？（增加登录次数？）

```
// update the login count
$data = array(
   'logins' => 'logins + 1'
);

$n = $db->update('users', $data, 'user_id = '.$_userId); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T18:57:49.233

```
$data = array(
   'logins' => new Zend_Db_Expr('logins + 1')
); 
```

还可以使用引用，这样您就不会那么容易受到 SQL 注入的影响：

```
$n = $db->update('users', $data, $db->quoteInto('user_id = ?', $_userId)); 
```

* * *

重新评论：是的，在 update() 方法的情况下，它假定您发送的是文字值，除非您使用 Zend_Db_Expr 类型的对象。你可以自己测试一下：

```
$db->getProfiler()->setEnabled(true);
$n = $db->update('users', $data, $db->quoteInto('user_id = ?', $_userId));
$qp = $db->getProfiler()->getLastQueryProfile();
echo $qp->getQuery() . "\n"; 
```

您在`$data`数组中提供的任何文字值都是参数化的，因此查询最终看起来像这样：

```
UPDATE `users` SET `login` = ? WHERE user_id = 123 
```

如果您使用 Zend_Db_Expr 类的对象，它知道将字符串按字面意思插入到查询中，而不是参数化：

```
UPDATE `users` SET `login` = NOW() WHERE user_id = 123 
```

请注意，当您像这样插入表达式时，您负责验证，因此您不会遇到安全漏洞。

# winapi - 如何查看桌面堆上的内容

> ID：870247
> 
> 赞同：4
> 
> 时间：2009-05-15T18:47:48.227
> 
> 标签：winapi, mfc

我有一个应用程序在这个版本中使用了大约 100k 的桌面堆，然后它在上一个版本中使用了。有没有办法可以查看桌面堆上的内容以及各个对象的大小？使用[Dheapmon](http://www.microsoft.com/downloads/details.aspx?familyid=5CFC9B74-97AA-4510-B4B9-B2DC98C8ED8B&displaylang=en)我能够看到我正在使用的堆的百分比，但我想要更多详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:11:48.180

[从这里](http://blogs.msdn.com/ntdebugging/archive/2007/01/04/desktop-heap-overview.aspx)的博客文章的评论中被盗

> 让我介绍一下如何进行桌面堆分配的背景知识。桌面堆位于内核模式虚拟地址空间中，因此单独的桌面堆分配必须由在内核模式下运行的组件进行。特别是，win32k.sys 是唯一进行桌面堆分配的内核模式组件。win32k.sys 在 Win32 的内核模式端，它包括窗口管理器 (USER) 和 GDI。它是使用桌面堆的 win32k.sys 的窗口管理器部分。窗口管理器的功能通过 user32.dll 暴露给在用户模式下运行的进程。user32.dll 导出在 win32k.sys 中实现的用户模式可调用函数。所以如果一个进程不加载user32.dll，它就不会使用桌面堆。
> 
> 关于您关于**设置将捕获桌面堆分配的断点**的问题......是的，有这样一个功能 - **win32k!DesktopAlloc**。但是，这是一个内核模式函数，要在其上设置断点需要您使用**内核调试器。**

对于从未在 Windows 中脱离用户模式的我来说，这听起来很复杂。

当我遇到类似的问题时，我只是在应用程序的启动部分放置断点。每次休息时，我都会查看分配的句柄级别以及 dhelpmon 告诉我的内容。进行一种二进制搜索，我开始缩小分配发生的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T03:58:13.487

Dheapmon 是我所知道的唯一一个直接查看桌面堆的工具，但是您是否尝试过使用[Winspector](http://www.windows-spy.com/)之类的工具查看您的应用程序以查找两个版本之间的明显差异（例如，您的应用程序中的某些类型的控件现在包含更多的窗户）？应用程序是否有机会切换到更新版本的 IE？我似乎记得 IE7 比 IE6 更占用桌面堆...

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-16T00:25:04.347

您可以使用 Win32 API 调用[HeapWalk 遍历](http://msdn.microsoft.com/en-us/library/aa366710(VS.85).aspx)堆。如果您需要遍历的不仅仅是默认堆，您可以调用[GetProcessHeap来获取进程可用的所有堆。](http://msdn.microsoft.com/en-us/library/aa366571(VS.85).aspx)

# asp.net - 设计器文件没有正确嵌套，在 Visual Studio 中搞乱了智能感知

> ID：870248
> 
> 赞同：2
> 
> 时间：2009-05-15T18:47:48.743
> 
> 标签：asp.net, visual-studio, visual-studio-2008

问候。

我已经将一个网站项目加载到 Visual Studio 2008 中。我所有 ascx 控件的 .designer 文件都没有嵌套在解决方案资源管理器中的控件下，当我在后面的代码中引用该控件中的某些内容时，我不会没有智能感知。

我已经检查了 csproj xml 文件，并且“编译”元素似乎与我其他项目中正常工作的元素相同。一个示例如下所示：

```
<Compile Include="Default.aspx.cs">
  <DependentUpon>Default.aspx</DependentUpon>
  <SubType>ASPXCodeBehind</SubType>
</Compile>
<Compile Include="Default.aspx.designer.cs">
  <DependentUpon>Default.aspx</DependentUpon>
</Compile> 
```

我尝试过使用网站\Nest 相关文件菜单命令以及我能想到的所有其他内容来处理项目文件。有任何想法吗？

**更新**

请注意，我正在尝试嵌套应该已经嵌套的文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-16T18:51:19.320

这是对我自己之前帖子的回应。得到 MS 技术支持来解决这个问题。在我的 .aspx 页面上，在 2 处更改第一行为我解决了这个问题。

在项目中每个 .aspx 文件中开始`"<%Page Language"`更改`"Codebehind="`为的行中`"Codefile="`，以及在您的`"Inherits="`属性中，如果它设置为 ProjectName.FileName 然后删除`"ProjectName."`.

例如，如果您有一个名为“TestApp”的项目和一个名为“NewFunctionalityTest.aspx”的文件，则更改

```
Inherits="TestApp.NewFunctionalityTest" 
```

到

```
Inherits="NewFunctionalityTest" 
```

在第一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T18:51:47.830

确保两个部分文件是相同的命名空间和类名？也可以尝试删除它们并同时添加两个文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:52:21.587

不久前我遇到了[这个宏](http://www.delarou.net/weblog/PermaLink,guid,a81a2d9d-02de-4fe1-ad8d-ee2fee97cf20.aspx)来做你正在寻找的东西。作者甚至发布了如何使用它的视频。不过我从来没有尝试过，所以我不能保证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T18:49:17.057

我不认为嵌套对你来说是个问题，看到嵌套文件只是一个眼睛糖果，虽然取决于事情......没有得到智能感知并不是嵌套的真正因素，而是与引用的连接方式有关您的项目...您能否分享每次创建新项目时都会发生这种情况还是针对特定项目...？您是否尝试编译该项目？编译后智能感知是否回来...通常对于 WAP 项目，如果由于某种原因智能感知不可用，它应该在您编译项目后出现...如果仍然面临这个问题，请告诉我...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-08T13:21:55.157

我不知道 OP 是否解决了他的问题，但我身上发生了非常相似的事情。Designer.vb 文件不嵌套，Intellisense 不工作，等等。主要区别在于我没有使用 ascx，我使用的是带有 .vb 代码隐藏的直接 .aspx 页面。当我在代码隐藏中操作所述控件时，似乎放置在 aspx 页面上的所有控件都不像声明的那样显示在 VS 中。我从几个月前编写的代码中得到了数百个深度的错误列表（当时没有问题），其中大多数说“未声明名称'objectname'”，其中“objectname”是一个文本框，或关联的下拉菜单.aspx 页面。要回答 Vishal 的问题...

> > 您能否分享每次创建新项目时都会发生这种情况，还是针对特定项目......？

它发生在一个项目上。我在 VS2008 中有多个其他应用程序显示没有问题。

> > 您是否尝试编译该项目？

是的，当我编译它时，它会列出所有出现在 ErrorList 中的构建错误中止，并跳转到 ErrorList。

> > 编译后智能感知是否返回

不。

关于这个项目的更多信息：这是一个转换后的 VS 2003 项目。从 2003 年转换后，这些问题并没有立即开始。转换发生在几个月前，从那时起我对 Web 应用程序进行了多次修改。目前在测试服务器上有一个带有这些修订的版本，用于向客户端展示新功能。这个问题仅在 3 个工作日前出现，当时我对 aspx 页面进行了一些格式更改。但是，我从来没有机会进行这些更改，因为我一打开项目就得到了错误列表。这个问题影响了我在项目中拥有的每个 aspx 页面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-21T10:25:36.010

要嵌套 resx 文件，您

1.  添加现有项目。将资源和设计器文件添加到项目中。
2.  选择所有未嵌套的资源文件（非 Designer 文件）。
3.  选择属性并将自定义工具更改为 PublicResXFileCodeGenerator

应该管用

# winapi - 如何知道windows上的子进程状态和资源使用情况？

> ID：870253
> 
> 赞同：4
> 
> 时间：2009-05-15T18:48:52.203
> 
> 标签：winapi, process, resources, monitor

我想编写一个程序，它将启动一个子进程。子进程可能是 windows 模式或控制台模式程序。

我想监控子进程状态和资源使用情况。例如，我想知道子进程仍在运行或终止。如果它终止了，我想知道原因（是正常终止还是因为崩溃？）。

在子进程运行和/或终止期间，我想知道它的资源使用情况，尤其是 CPU 时间（用户时间、系统）和内存使用情况（虚拟大小和/或 rss）。如果数字不是很准确也没关系。

在 Unix 术语中，我想 fork、exec、waitpid 和 getrusage。而fork+setrusage+exec可以限制child的资源使用。但我不知道如何在 Windows 平台上执行这些操作。

请指出 Windows API 名称。我可以自己研究其余的。

最好不要使用 Windows API 以外的库。最好它不是作为调试器工作并附加到子进程的父进程。只是不喜欢，但仍然可以接受。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T18:53:51.317

当您调用 CreateProcess 时，它会返回该进程的句柄。

进程句柄上的 WaitForSingleObject 将阻塞，直到进程退出或超时到期。零超时将立即返回并指示进程是否仍在运行。

```
BOOL IsProcessRunning(HANDLE process)
{
    return WaitForSingleObject(process, 0) != WAIT_OBJECT_0;
}

void WaitForProcessToExit(HANDLE process)
{
    WaitForSingleObject(process, INFINITE);
} 
```

要获取正在运行的进程的退出代码，可以使用 GetExitCodeProcess。但是，您需要解释错误代码的含义。0xC0000005 是典型的访问冲突，但并非所有崩溃都会导致此错误代码。

对于资源使用情况，可以调用 GetProcessTimes 获取总 CPU 时间，调用 GetGuiResources 获取 GDI 句柄信息，调用 GetProcessMemoryInfo 获取内存统计信息，调用 GetProcessIoCounters 获取 IO 信息。

# php - 如何将视频上传到 Facebook

> ID：870257
> 
> 赞同：1
> 
> 时间：2009-05-15T18:50:03.247
> 
> 标签：php, facebook, video

我正在开发一个将视频上传到各个网站的 PHP/CURL 项目。有没有办法在不创建应用程序的情况下将视频发布到 Facebook？我找到了一种通过发布到 Facebook 移动版 URL 来更新状态信息的方法，但移动版不支持视频上传。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T19:33:59.257

Facebook 将强制你创建一个应用程序，你今天可能找到的任何其他上传视频的方式（以及你对状态更新所做的）都可能在未来再次中断。

您可能违反了 ToS，状态更新可能被视为安全漏洞。

# command-line - Qt4 的命令行解析器

> ID：870258
> 
> 赞同：24
> 
> 时间：2009-05-15T18:50:15.010
> 
> 标签：command-line, qt4, parsing

我正在寻找 Qt4 的命令行解析器。

我做了一个小的谷歌搜索，发现了这个：[http](http://www.froglogic.com/pg?id=PublicationsFreeware&category=getopt) ://www.froglogic.com/pg?id= PublicationsFreeware&category=getopt 但是它缺乏对“--enable-foo”和“--disable-foo”开关的支持。除此之外，它看起来像一个真正的赢家。

编辑：

Frologic 似乎删除了这个。所以我看到的最好的选择是使用 Boost（它不是 API 也不是 ABI 稳定的）或分叉对 kdelibs 的支持。耶...

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-15T20:02:24.680

[`QCoreApplication`的构造函数](https://doc.qt.io/qt-5/qcoreapplication.html#QCoreApplication)需要`(int &argc, char **argv)`（并`QApplication`继承自`QCoreApplication`）。如[文档所述](https://doc.qt.io/qt-5/qapplication.html#details)，强烈建议

> 由于 QApplication 还处理常见的命令行参数，因此在应用程序本身进行任何解释或修改*之前*创建它通常是一个好主意。`argv`

而且，如果您让 Qt 在处理参数方面获得第一次通过，那么使用[`QStringList QCoreApplication::arguments()`](https://doc.qt.io/qt-5/qcoreapplication.html#arguments)而不是遍历也是一个好主意`argv`；`QApplication`可能会删除它为自己使用的一些论点。

这并不适合与其他参数解析库非常兼容......

然而，[kdelibs](http://api.kde.org/)确实带有一个很好的参数解析器，[`KCmdLineArgs`](http://api.kde.org/4.x-api/kdelibs-apidocs/kdecore/html/classKCmdLineArgs.html). `KApplication`它是 LGPL，如果您真的需要，可以不使用（调用`KCmdLineArgs::init`）。

```
KCmdLineOptions options;
options.add("enable-foo", ki18n("enables foo"));
options.add("nodisable-foo", ki18n("disables foo"));
// double negatives are confusing, but this makes disable-foo enabled by default

KCmdLineArgs::addCmdLineOptions(options);
KApplication app;
KCmdLineArgs *args = KCmdLineArgs::parsedArgs();

if (args->isSet("enable-foo") && !args->isSet("disable-foo"))
    cout << "foo enabled" << endl;
else
    cout << "foo disabled" << endl; 
```

未经测试（谁曾经测试过他们在 SO 上发布的内容？）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-10-04T16:36:12.177

从 Qt 5.2 开始，您终于可以在 QtCore 本身中找到解决方案：我在那里贡献了[QCommandLineParser](http://qt-project.org/doc/qt-5/qcommandlineparser.html)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-09-21T08:58:13.920

这或多或少与 ehemient 相同的答案，但使用简单的正则表达式来帮助解析 args。（如果您只需要少量 args，这种方式可能很有用）

运行这个：

```
./QArgTest --pid=45 --enable-foo 
```

和代码：

```
int main(int argc, char *argv[]) {
    QApplication app(argc, argv, false);
    qDebug() << "QApp arg test app"; 

    QStringList args = app.arguments();

    int pid = 0;

    QRegExp rxArgPid("--pid=([0-9]{1,})");
    QRegExp rxArgFooEna("--enable-foo");
    QRegExp rxArgFooDis("--disable-foo");

    for (int i = 1; i < args.size(); ++i) {
        if (rxArgPid.indexIn(args.at(i)) != -1 ) {   
            pid =  rxArgPid.cap(1).toInt();
            qDebug() << i << ":" << args.at(i) << rxArgPid.cap(1) << pid;
        }
        else if (rxArgFooEna.indexIn(args.at(i)) != -1 ) {   
            qDebug() << i << ":" << args.at(i) << "Enable Foo";
        } 
        else if (rxArgFooDis.indexIn(args.at(i)) != -1 ) {   
            qDebug() << i << ":" << args.at(i) << "Disable Foo";
        } 
        else {
            qDebug() << "Uknown arg:" << args.at(i);
        }
    }
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-09-06T19:51:10.313

还有来自[http://www.libqxt.org/的 QxtCommandOptions](http://www.libqxt.org/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-15T18:59:44.347

**该软件包通过opts.addSwitch("disable-foo", &foo_disabled);**支持 --disable-foo 和 --enable-foo 和**opts.addSwitch("enable-foo", &foo_enabled);** . 您需要同时检查两者，并与指定两者的人打交道（哎呀）。

我不明白的是这与QT4有什么关系......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-09T13:07:49.557

一个非常简单的方法是扫描“key=value”参数，
将它们放在一个表中，比如 zz.map: QString -> QVariant，
然后使用 zz.map.value(key, default) 获取它们的值。一个例子：

```
#include "ztest.h"
Ztest zz;  
int main( int argc, char* argv[] )
{
    zz.eqargs( ++ argv );  // scan  test=2 x=str ... to zz.map

    QString xx = zz.map.value( "xx", "" );
    if( Zint( Size, 10 ))  // a #def -> zz.map.value( "Size", 10 )
        ... 
```

`ztest.h`< 1 页，以下；Python 相同 ~ 10 行。

（每个人都有他/她最喜欢的选项解析器；这是最简单的。
值得重复：无论您指定选项，*将它们回显到输出文件*——
“我认识的每个科学家都难以跟踪他们上次运行时使用的参数脚本”。）

为了使 QPoints 等工作，当然需要一个 QString -> QPoint 解析器。任何人都知道为什么这不起作用（在 Qt 4.4.3 中）？

```
QPoint pt(0,0);
QDataStream s( "QPoint(1,2)" );
s >> pt;
qDebug() << "pt:" << pt;  // QPoint(1364225897,1853106225) ?? 
```

新增 25nov --

```
// ztest.h: scan args x=2 s=str ... to a key -> string table
// usage:
// Ztest ztest;
// int main( int argc, char* argv[] )
// {
//     QApplication app( argc, argv );
//     ztest.eqargs( ++ argv );  // scan leading args name=value ...
//     int x = Zint( x, 10 );  // arg x= or default 10
//     qreal ff = Zreal( ff, 3.14 );
//     QString s = Zstr( s, "default" );
// care: int misspelled = Zint( misspellled ) -- you lose
//version: 2009-06-09 jun denis

#ifndef ztest_h
#define ztest_h

#include <QHash>
#include <QString>
#include <QVariant>
#include <QRegExp>

//------------------------------------------------------------------------------
class Ztest {
public:
  QHash< QString, QVariant > map;
  int test;  // arg test=num,  if( ztest.test )

  Ztest() : test( 0 ) {}

  QVariant val( const QString& key, const QVariant& default_ = 0 )
  {
    return map.value( key, default_ );
  }

  void setval( const QString& key, const QVariant& val )
  {
    map[key] = val;
    if( key == "test"  ||  key == "Test" )
        test = val.toInt();
  }

//------------------------------------------------------------------------------
    // ztest.eqargs( ++ argv )  scans test=2 x=3 ... -> ztest table
  void eqargs( char** argv )
  {
    char** argv0 = argv;
    char *arg;
    QRegExp re( "(\\w+)=(.*)" );  // name= anything, but not ./file=name
    for( ; (arg = *argv) && re.exactMatch( arg );  argv ++ ){
        setval( re.cap(1), re.cap(2) );
    }
        // change argv[0..] -> args after all name=values
    while(( *argv0++ = *argv++) != 0 ) {}
  }
};

extern Ztest ztest;

    // macros: int x = Zint( x, 10 ): x= arg or default 10
#define Zstr( key, default )    ztest.val( #key, default ).toString()
#define Zint( key, default )    ztest.val( #key, default ).toInt()
#define Zreal( key, default )   ztest.val( #key, default ).toDouble()

#endif 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-21T10:13:25.593

看看这个：[http ://code.google.com/p/qtargparser/](http://code.google.com/p/qtargparser/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-01T14:05:28.517

现在是 2013 年，仍然没有“第一方”arg 解析器。无论如何..如果有人发现自己面临同样的问题并想避免 cmd 解析器库附带的学习曲线，这里有一个“快速而肮脏”的解决方案：-

```
QString QArgByKey(QString key, QChar sep = QChar('\0') ) //prototype usually in separate header

QString QArgByKey(QString key, QChar sep )
{
    bool sepd=sep!=QChar('\0');
    int pos=sepd?qApp->arguments().indexOf(QRegExp('^'+key+sep+"\\S*")):qApp->arguments().indexOf(QRegExp(key));
    return pos==-1?QString::null:
    (sepd?qApp->arguments().at(pos).split(sep).at(1):(++pos<qApp->arguments().size()?qApp->arguments().at(pos):QString::null));
} 
```

例子：-

```
user@box:~$ ./myApp  firstKey=Value1 --secondKey Value2 thirdKey=val3.1,val3.2,val3.3 --enable-foo 
```

用法：

```
QString param1   = QArgByKey("firstkey",'='); // Returns `Value1` from first pair
QString param2   = QArgByKey("--secondkey"); // Returns `Value2` from second pair
QString param3-1 = QArgByKey("thirdkey",'=').split(',').at(0); // Returns `val3.1`
bool fooEnabled  = qApp->arguments().contains("--enable-foo"); //To check for `--enable-foo` 
```

参数可以按任何顺序传递

编辑：此代码段的更新将在[此处找到](https://github.com/mrmoje/QArgParser)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T18:55:14.310

它必须是Qt4特定的吗？如果不是，[GNU Getopt](http://www.gnu.org/software/hello/manual/libc/Getopt.html)真的很不错，尽管如果您不使用开源软件，许可可能会成为问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-10T13:48:17.430

此外，对于一些花哨的选项解析，您可以尝试[gperf](http://www.gnu.org/software/gperf/manual/gperf.html)。

IBM 有一个很好的[教程](http://www.ibm.com/developerworks/linux/library/l-gperf.html)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-16T18:48:42.353

我也在寻找这样做时遇到的另一个选择：

[http://code.google.com/p/qgetopts/](http://code.google.com/p/qgetopts/)

不过我没用过。

# sql-server - SQL 选择连接帮助

> ID：870268
> 
> 赞同：2
> 
> 时间：2009-05-15T18:52:07.937
> 
> 标签：sql-server, tsql

我在为这种情况找出查询时遇到问题。我有两个要在此查询中使用的表，它们是这样的：

```
Units
  ID
  Other Data
People
  ID
  UnitID  <-- fk to Units
  Other Data 
```

这就是我想要做的：
我想选择所有在 People 表中没有与其链接的行的单位。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T18:54:10.287

```
SELECT Units.* FROM Units LEFT JOIN People ON People.UnitID = Units.ID WHERE People.ID IS NULL 
```

或者

```
SELECT Units.* FROM Units WHERE NOT EXISTS (SELECT 1 FROM People WHERE People.UnitID = Units.ID) 
```

甚至

```
SELECT Units.* FROM Units WHERE Units.ID NOT IN (SELECT UnitID FROM People) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T18:53:29.027

```
SELECT * FROM Units  
WHERE NOT EXISTS  
(SELECT * FROM People WHERE UnitID = Units.ID) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T18:55:10.910

```
SELECT * FROM Units
WHERE ID NOT IN (SELECT UnitID FROM People) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T19:01:13.610

您可以使用 not in (select...)

```
SELECT ID
FROM Units
WHERE ID NOT IN (SELECT UnitID FROM People); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T20:11:32.693

```
SELECT U.*
FROM Units U
WHERE NOT EXISTS (
   SELECT 1
   FROM People P
   WHERE U.ID = P.UnitID
) 
```

请注意，这称为（反）半连接。它是一个实际的连接，而不是一个相关的子查询。

另一种常用的方法是：

```
SELECT U.*
FROM
   Units U
   LEFT JOIN People P ON U.ID = P.UnitID
WHERE
   P.UnitID IS NULL 
```

请注意，加入的附加条件（假设您只想加入活跃的人）需要在加入子句中。说不出来`WHERE P.UnitID IS NULL AND P.Active = 1`。

根据我的经验，根据选择的实际执行计划，每个不同的查询都可以证明是性能赢家。引擎使用统计信息来预测行数的方式可以使它为某些查询选择次优的执行计划，即使在正确更新统计信息时也是如此。

注意：在半连接中使用“SELECT 1”而不是“SELECT *”将在查询编译期间节省一些周期，因为 * 实际上已扩展到列列表，然后被删除。

# wpf - WPF 数据绑定项目符号列表

> ID：870277
> 
> 赞同：17
> 
> 时间：2009-05-15T18:54:19.290
> 
> 标签：wpf, itemscontrol

如何在 WPF 中创建数据绑定、项目符号的超链接列表？

我有这个：

```
<ItemsControl Name="lstScripts">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <TextBlock>
                <Hyperlink>
                    <TextBlock Text="{Binding Path=Name}" />
                </Hyperlink>
            </TextBlock>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

但我不知道如何将这些物品变成子弹。我看到 BulletDecorator，但我不想指定自己的项目符号图像，我只想要标准项目符号。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-15T19:12:40.027

不幸的是，没有“标准项目符号”......这是一个简单的椭圆项目符号的示例：

```
 <ItemsControl Name="lstScripts">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <BulletDecorator Width="Auto">
                        <BulletDecorator.Bullet>
                            <Ellipse Fill="White" Stroke="Black" StrokeThickness="1" Width="8" Height="8"/>
                        </BulletDecorator.Bullet>
                        <TextBlock>
                            <Hyperlink>
                                <TextBlock Text="{Binding Path=Name}" />
                            </Hyperlink>
                        </TextBlock>
                    </BulletDecorator>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-02T13:54:36.260

只是为了扩展@Thomas Levesque 的答案，将其变成 UserControl 以便您可以重用它，例如：

```
<Reporting:BulletedItem BulletText="Bullet Item 1" />
<Reporting:BulletedItem BulletText="Bullet Item 2" /> 
```

创建一个用户控件：

```
<UserControl x:Class="MyNameSpace.Reporting.BulletedItem"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" >
    <Grid>
        <ItemsControl >
            <BulletDecorator Width="Auto" Margin="10, 0, 0, 0">
                <BulletDecorator.Bullet>
                    <Ellipse Fill="Black" Stroke="Black" StrokeThickness="1" Width="5" Height="5"/>
                </BulletDecorator.Bullet>
                <TextBlock Margin="5, 0, 0, 0">
                    <TextBlock Text="{Binding BulletText}" />
                </TextBlock>
            </BulletDecorator>
        </ItemsControl>
    </Grid>
</UserControl> 
```

在代码中：

```
public partial class BulletedItem : UserControl
{
    public static readonly DependencyProperty TextProperty = DependencyProperty.Register("BulletText", typeof(string), typeof(BulletedItem));

    public string BulletText
    {
        get { return (string)GetValue(TextProperty); }
        set { SetValue(TextProperty, value); }
    }

    public BulletedItem()
    {
        InitializeComponent();
        this.DataContext = this;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-15T15:02:28.170

对于各种列表，您可以使用 FlowDocument 和 List。这具有“Disc”的 MarkerStyle 和“Circle”之一。

```
<FlowDocument>
  <List MarkerStyle="Disc">
    <ListItem>
      <Paragraph>Boron</Paragraph>
    </ListItem>
    <ListItem>
      <Paragraph>Carbon</Paragraph>
    </ListItem>
</<FlowDocument> 
```

这里有更多详细信息：[https ://msdn.microsoft.com/library/aa970909(v=vs.100).aspx](https://msdn.microsoft.com/library/aa970909(v=vs.100).aspx)

# wcf - 从 WCF 服务返回多个值的最佳方法是什么

> ID：870278
> 
> 赞同：2
> 
> 时间：2009-05-15T18:54:42.113
> 
> 标签：wcf, web-services

从 WCF 服务返回多个值的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T18:57:12.230

首先，这*必须*是重复的。

只需创建一个具有值属性的类。使类成为 [DataContract] 和属性 [DataMember]。返回该类的实例。适用于所有客户端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T18:57:19.390

在一个单独的对象中，例如：

```
public class DTO
{
   public string Data1 { get; set;}
   public string Data2 { get; set;}
} 
```

然后从该方法返回一个 DTO 实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T22:48:57.133

将它们包装在一个单独的类中，该类将用 [DataContract] 装饰并从您的方法中返回，或者在您的方法调用中使用[out 参数。](http://msdn.microsoft.com/en-us/library/t3c3bfhx(VS.80).aspx)

# struts2 - struts.xml 放在哪里

> ID：870279
> 
> 赞同：19
> 
> 时间：2009-05-15T18:55:04.373
> 
> 标签：struts2, configure

使用 Struts2，我们必须`struts.xml`在类路径中拥有，因此在 WEB-INF 下拥有它不再有效。所以我让我的项目部署的方式是将它放在下面`WEB-INF/classes`并包含它`../struts2.xml`

2 问题：

1.  当我进行重建时，Eclipse 会清除 classes 文件夹，因此它会删除`struts.xml`
2.  Eclipse 没有在我的项目浏览器中显示类文件夹，因此它是一个糟糕的地方，首先粘贴配置文件。

Struts2 Eclipse 开发人员是如何做到这一点的？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-16T12:56:14.087

您可以将 struts.xml 放在源目录的根目录下，也可以设置一个额外的资源源目录并将其放在那里。Eclipse 在编译时非常乐意为您将其复制到 WEB-INF/classes 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-15T15:01:42.987

我迟到了，我们可以在 web 应用程序的类路径中的任何目录中配置 struts.xml，但是使用 web.xml 中的过滤器配置的“config” init 参数提供位置，如下所示，如果我的 struts .xml 文件位于“/com/resources/”目录中。

```
 <filter>
        <filter-name>action</filter-name>
        <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
         <init-param>
            <param-name>config</param-name>
            <param-value>struts-default.xml,struts-plugin.xml,/com/resources/struts.xml</param-value>
         </init-param>
    </filter> 
```

如果我们不提供配置 init 参数 struts2 默认取 3 个值“struts-default.xml,struts-plugin.xml,struts.xml”，你可以看到下面的 struts2 Dispatcher 类代码，它将配置这 3 个文件配置管理器。

```
String configPaths = (String)this.initParams.get("config");
if (configPaths == null) {
  configPaths = "struts-default.xml,struts-plugin.xml,struts.xml";
}
String[] files = configPaths.split("\\s*[,]\\s*");
for (String file : files)
  if (file.endsWith(".xml")) {
    if ("xwork.xml".equals(file))
      this.configurationManager.addContainerProvider(createXmlConfigurationProvider(file, false));
    else
      this.configurationManager.addContainerProvider(createStrutsXmlConfigurationProvider(file, false, this.servletContext));
  } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-23T20:45:22.593

使用 Struts 1.2，需要将 struts-config.xml 放在类路径中（在 WEB-INF 文件夹下），但使用 Struts 2.0，它需要放在 src/main/resources 文件夹中。

在此处查看文档[Struts 2 文档](https://svn.apache.org/repos/infra/websites/production/struts/content/getting-started/how-to-create-a-struts2-web-application.html)

我将 struts.xml 粘贴到此目录中，项目执行良好。

[![我的项目结构是这样的](https://i.stack.imgur.com/bdrRC.png)](https://i.stack.imgur.com/bdrRC.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T19:11:40.387

我没有使用 Eclipse，所以这个答案不是特定于您的要求，但是，我使用 Maven，所以我们在一个名为“resources”的单独文件夹中拥有应用程序所需的所有“资源”，并且在构建应用程序时这些文件是自动复制到合适的地方。在 Netbeans 中，文件夹中的文件是可用的，我知道有些人使用 eclipse 具有类似的设置。

我应该指出，我们的项目是从[appfuse](http://www.appfuse.org/display/APF/Home)开始的，所以大多数这些配置都是预先制作的。你可以看看它是如何在那里完成的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-10T09:42:20.997

You can place struts.xml file in src(Java Resources) packages. When the compilation process struts.xml file will generate inside the ROOT/WEB-INF/classes directory.

if you get the same error again and again better check the struts actions. check the deployed path of the application and you can find out what you want. (struts.xml file)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-27T09:08:54.287

在 struts 2 项目中，struts.xml 文件与包和库一起添加到 src(Java Resources) 文件夹中。

请参考下面给出的图像。

![Eclipse中的Struts 2项目目录视图](https://i.stack.imgur.com/4wBi4.gif)

如果您想了解更多关于 struts 2 项目结构的信息，请访问[此链接](http://www.dzone.com/tutorials/java/struts-2/struts-2-example/struts-2-tiles-example-1.html)

**注意**：在 Eclipse 中，不允许将文件直接粘贴到 src 文件夹中。因此，您需要先将其粘贴到项目中的任何其他位置（例如，在“WebContent”文件夹中），然后使用移动功能将其放置在正确的位置（即“src”文件夹）。

# c# - GetChangeSet ChangeSet、Linq 将应用什么顺序更改？

> ID：870282
> 
> 赞同：0
> 
> 时间：2009-05-15T18:55:13.843
> 
> 标签：c#, .net, linq, changeset, submitchanges

我正在运行代码以在 linq 提交更改调用之前获取更改集。

```
private void OnSubmitHandleReplication()
{
    System.Data.Linq.ChangeSet changes = GetChangeSet();
    //Do something with change set
} 
```

在“做某事”部分，我需要知道提交内容的顺序，以及它们将发布到数据库的顺序。我看到更改集有一个 .Inserted、.Updated 和 .Deleted。我假设这些是它们将被应用的顺序。但是我想知道总体顺序。我认为它可能是插入、更新，然后是另外 3 个插入，或者涉及在这些集合之间来回反弹的东西。

**更新 1**

对不起，以为标题很清楚，Linq to SQL

**更新 2**

我这样做的原因是稍后将这些重播到另一个数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T19:09:22.297

这是相当棘手的。

您需要通过反射深入挖掘更改跟踪器才能获得实际订单。

关于插入、更新、删除的顺序，插入发生在删除之前，因此您需要注意唯一约束（这可能意味着您需要更新而不是重新创建）。

**编辑**

如果您只需要“重播”，那么您当然可以使用日志记录功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T19:19:45.763

`YourDataContext.Log = Console.Out`您可以通过设置或任何其他兼容的输出流来启用 Linq2SQL 中的日志记录。LINQ 发送到数据库的每个 SQL 查询都将在那里打印。你应该只用它来调试你的问题，因为 LINQ 发送了很多查询:)

编辑：关于动作的顺序，我不能再帮你了，我从来没有比我必须的更多地查看这些查询。

# c# - 我可以让 XmlSerializer 在反序列化时忽略命名空间吗？

> ID：870293
> 
> 赞同：51
> 
> 时间：2009-05-15T18:57:25.710
> 
> 标签：c#, .net, serialization, xml-serialization

我可以让 XmlSerializer 在反序列化时忽略名称空间（xmlns 属性），这样无论是否添加属性或即使该属性是伪造的都无关紧要？我知道源将始终受到信任，所以我不关心 xmlns 属性。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-16T20:47:53.487

是的，您可以告诉 XmlSerializer 在反序列化期间忽略名称空间。

定义一个忽略命名空间的 XmlTextReader。像这样：

```
// helper class to ignore namespaces when de-serializing
public class NamespaceIgnorantXmlTextReader : XmlTextReader
{
    public NamespaceIgnorantXmlTextReader(System.IO.TextReader reader): base(reader) { }

    public override string NamespaceURI
    {
        get { return ""; }
    }
}

// helper class to omit XML decl at start of document when serializing
public class XTWFND  : XmlTextWriter {
    public XTWFND (System.IO.TextWriter w) : base(w) { Formatting= System.Xml.Formatting.Indented;}
    public override void WriteStartDocument () { }
} 
```

这是一个如何使用该 TextReader 反序列化的示例：

```
public class MyType1 
{
    public string Label
    {
        set {  _Label= value; } 
        get { return _Label; } 
    }

    private int _Epoch;
    public int Epoch
    {
        set {  _Epoch= value; } 
        get { return _Epoch; } 
    }        
}

    String RawXml_WithNamespaces = @"
      <MyType1 xmlns='urn:booboo-dee-doo'>
        <Label>This document has namespaces on its elements</Label>
        <Epoch xmlns='urn:aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'>0</Epoch>
      </MyType1>";

    System.IO.StringReader sr;
    sr= new System.IO.StringReader(RawXml_WithNamespaces);
    var s1 = new XmlSerializer(typeof(MyType1));
    var o1= (MyType1) s1.Deserialize(new NamespaceIgnorantXmlTextReader(sr));
    System.Console.WriteLine("\n\nDe-serialized, then serialized again:\n");
    XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
    ns.Add("urn", "booboo-dee-doo");
    s1.Serialize(new XTWFND(System.Console.Out), o1, ns);
    Console.WriteLine("\n\n"); 
```

结果是这样的：

```
 <MyType1>
      <Label>This document has namespaces on its elements</Label>
      <Epoch>0</Epoch>
    </MyType1> 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2015-07-29T08:38:04.733

如果您希望没有命名空间，但输入有命名空间，那么您可以设置

> 命名空间 = 假

在您的 XmlTextReader 上。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2017-03-22T11:58:45.197

扩展 Wolfgang Grinfeld 答案（无异常处理）：

```
public static Message Convert(XmlDocument doc)
{
    Message obj;
    using (TextReader textReader = new StringReader(doc.OuterXml))
    {
        using (XmlTextReader reader = new XmlTextReader(textReader))
        {
            reader.Namespaces = false;
            XmlSerializer serializer = new XmlSerializer(typeof(Message));
            obj = (Message)serializer.Deserialize(reader);
        }
    }

    return obj;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-22T12:30:23.480

通过使用 XmlSerializer Deserialize 从 xml 而不是从流中读取来解决此问题。这种方式在 xml 被反序列化之前，使用 Regex 从 xml 中删除 xsi:type。这样做是跨平台的可移植类库，所以没有很多其他选择:(。在此之后反序列化似乎工作正常。

以下代码可以提供帮助，

```
public static TClass Deserialize<TClass>(string xml) where TClass : class, new()
{
    var tClass = new TClass();

    xml = RemoveTypeTagFromXml(xml);

    var xmlSerializer = new XmlSerializer(typeof(TClass));
    using (TextReader textReader = new StringReader(xml))
    {
        tClass = (TClass)xmlSerializer.Deserialize(textReader);
    }
    return tClass;
}

public static string RemoveTypeTagFromXml(string xml)
{
    if (!string.IsNullOrEmpty(xml) && xml.Contains("xsi:type"))
    {
        xml = Regex.Replace(xml, @"\s+xsi:type=""\w+""", "");
    }
    return xml;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-22T20:13:00.203

这不会忽略名称空间，而是期望它。我试图做和你一样的事情，但我已经使用 XSD 添加了验证，现在需要命名空间。所以这就是我以前期望的命名空间。[https://stackoverflow.com/a/7730989/1856992](https://stackoverflow.com/a/7730989/1856992)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-15T18:59:21.197

为什么要试图让 XmlSerializer 忘记 XML 的工作原理？XML 的一个事实是，具有相同名称但名称空间不同的两个元素是不同的元素。

如果要处理没有命名空间的 XML，则应对其进行预处理以删除命名空间，*然后*将其传递给序列化程序。

# c# - 多次实例化一个类的性能问题

> ID：870296
> 
> 赞同：4
> 
> 时间：2009-05-15T18:58:08.080
> 
> 标签：c#, .net, performance

我想知道在表单中实例化一个类或在需要时实例化一个类之间的性能差异。例如，假设我有一个客户表单来编辑客户。在表单加载时，我实例化一个客户类并调用一个函数来返回客户数据以填充表单控件。

```
CustomerInfo customer = new CustomerInfo();
CustomerDetail  cust = customer.GetCustomer(customerId);
txtName. cust.Name;
... 
```

表格上还有一个保存按钮。单击该按钮时，我会创建 Customer 类的另一个实例来更新数据。

```
CustomerDetail cust = new CustomerData();
cust.Id = customerId;
cust.Name = txtName.Text;

CustomerInfo customer = new CustomerInfo();
customer.Update(cust); 
```

我知道这很好用。但是，在性能方面是否更好，只是为整个表单创建一个 Customer 类的实例来调用 GetCustomer 和 Update？我知道 GC 会处理这些实例，但我不确定它会在继续下一个实例之前破坏第一个实例。

另外，这个例子我只使用了两个对客户类的函数调用，但实际上，可能还有更多。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T19:04:01.717

这个想法应该是您为您正在操作的每个不同客户创建一个客户实例。因此，如果您的表单只处理一个客户，那么您应该只有一个实例，但如果您的表单处理多个客户，那么您将有多个实例。

就性能而言，只有在处理许多实例时才会成为问题，我会说数千个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T19:34:24.357

过早的优化是万恶之源。

永远不要考虑优化，除非你有一个为最佳可读性而编码的解决方案，并且发现它不足以通过测试客户规范的测试。

如果您的优化未通过未优化版本失败的相同测试，请还原它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T19:08:41.737

就我个人而言，我会在表格中保留实例。一遍又一遍地实例化它似乎是不必要的开销。我同意 Vincent Ramdhanie 的观点，即每个客户拥有一个实例，因此如果您更改客户，您应该获得一个新实例。

此外，通过将实例保留在您身边，您可以轻松地检查它是否真的发生了变化，如果在持续更改方面存在相当大的开销，我倾向于这样做。但这是另一个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T19:00:50.257

我会将该功能移至 CustomerRepository 类，并在我的应用程序中有一个实例，在创建/加载表单时创建

IE。获取/保存客户数据代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T19:07:57.960

当您需要使用相同的表单更新或创建“客户”时，单个实例的方法很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T19:08:56.057

当然，不重新创建对象的开销更少。此外，当您持有对象时，可能存在某种程度的数据隐式锁定（否则，如果其他人可以访问数据库，或者除非您不关心更新冲突，您需要对数据进行某种外部锁定）。

此外，按照上面的方式进行操作假设您的表单知道属于 CustomerData 的**所有**字段 - 您没有保留原始对象并对其进行更新，因此您最好确保从中获取所有数据并且手动将其转移到“新”对象。然后你的代码变得与 CustomerData 的定义（和实现）紧密相关——如果有人添加了可见字段，你的代码需要修改。如果他们添加了“隐藏”字段或状态，那么您的代码**确实**需要修改。

所以我建议保留对象并更新它，并单独（根据需要）处理任何锁定要求。

# eclipse - 如何自动编译大型 Java 项目？

> ID：870298
> 
> 赞同：2
> 
> 时间：2009-05-15T18:58:40.713
> 
> 标签：eclipse, compiler-construction, ant, jar, javac

我正在为我的雇主做一个自动化项目。我们的源代码的每个修订版都有一个池。当你下载一个修订版时，你需要创建一个包含一堆第三方包含的目录结构来最终构建项目。我已经自动化了整个过程，直到让我的脚本 (.bat) 编译每个特定的可运行 Java 应用程序。这个项目有很多应用程序，目录列表如下所示：

```
Proj Name
   -variousincludesfolder1
   -variousincludesfolder2
   -variousincludesfolder3
   -variousincludesfolder4
   -runnableapplicationsandmoreincludes
       -con.java 
```

现在，我想做一个 con.java 的自动编译，但我不知道从哪里开始。人们建议我尝试使用 Ant，但我使用 Eclipse 生成的任何自动 Ant 文件似乎只足以在存在活动项目文件的情况下构建 con.java。无论如何在不使用eclipse的情况下自动执行此操作，以使批处理文件自己生成一个.jar？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T19:03:43.917

这绝对是[Ant](http://ant.apache.org/)的工作。不要依赖 Eclipse 生成的 Ant 文件；通读[手册](http://ant.apache.org/manual/index.html)并自己写一个。（您可能会发现 Ant 也做了您在构建脚本中没有想到的事情。）

更具体地说，[这里是 jar task 的文档](http://ant.apache.org/manual/Tasks/jar.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T01:24:53.423

您可以定义通配符和模式匹配以在构建中包含/排除各种文件和文件夹。查看[Ant 手册](http://ant.apache.org/manual/)，了解[文件集](http://ant.apache.org/manual/Types/fileset.html)之类的内容如何与包含和排除过滤器一起使用。

另外，阅读[教程](http://ant.apache.org/manual/using.html#buildfile)。

这是一个简单的构建文件，它可以编译所有 java 文件并引用所有 jar。将其放在顶级目录中：

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" 
    href="http://www.ibm.com/developerworks/xml/library/x-antxsl/examples/example2/ant2html.xsl"?>
<project name="Proj Name" default="build" basedir=".">
    <property name="src.dir" value="${basedir}" description="base folder where the source files will be found.  Typically under /src, but could be anywhere.  Defaulting to root directory of the project" />
    <property name="build.dir" value="build" description="Where to put build files, separate from src and resource files." />

    <path id="master-classpath">
        <fileset dir="${basedir}" description="looks for any jar file under the root directory">
            <include name="**/*.jar" />
        </fileset>
    </path>

    <target name="build" description="Compile all JAVA files in the project">
        <javac srcdir="${src.dir}" 
            destdir="${build.dir}/classes" 
            debug="true" 
            deprecation="true" 
            verbose="false" 
            optimize="false"  
            failonerror="true">
            <!--master-classpath is defined above to include any jar files in the project subdirectories(can  be customized to include/exclude)-->
            <classpath refid="master-classpath"/>
            <!--If you want to define a pattern of files/folders to exclude from compilation...-->
            <exclude name="**/realm/**"/>
        </javac>  
    </target>

</project> 
```

# svn - 有没有人成功地将 VSS 2005 迁移到 SVN？

> ID：870301
> 
> 赞同：10
> 
> 时间：2009-05-15T18:59:23.613
> 
> 标签：svn, version-control, visual-sourcesafe, visualsvn-server

最近一段时间我一直在玩 SVN，并且开始喜欢它的强大功能和用户体验，并且我们可以将它与我们的错误跟踪系统联系起来以简化每个人的生活。所以到了我们决定将我们的 VSS 2005 设置迁移到 SVN 的时候了，我现在要解决问题了。

似乎有许多工具声称能够完成从 VSS 2005 到 SVN 的迁移，但我不知道哪个是最好的，或者哪个可以为我提供最完整的转换。我需要一个能够迁移完整历史记录的工具，而不仅仅是从 VSS 中检出并检入 SVN。

我发现 Polarion SVN Importer 看起来既强大又高度可配置，但是，我无法让该死的东西工作，它抱怨它无法从 VSS 中的 $/ 中提取文件列表。如果我运行它手动触发的相同命令，一切似乎都运行正常，所以我无法弄清楚。

有没有人成功地将他们的源代码从 VSS 2005 迁移到 SVN，如果是，您使用了哪些工具，您的发现是什么？任何警告或陷阱都是最有用的，因此要知道任何有用/令人惊讶的或令人失望的或只是被歪曲的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T12:59:07.457

尝试 Codeplex 上 VssMigrate 的最新主干（控制台应用程序）修订版，以重新排序您的历史记录并从您的 VSS 存储库重新生成变更集。它还将根据签入的时间正确排序您的修订。

http vssmigrate.codeplex.com/SourceControl/changeset/view/16890

我希望这有帮助。可能需要对 $/ 导入进行一些调整。

PS历史可以帮助您一步一步知道该怪谁，而不必根据导入来发现注释是否正确，所以我觉得它非常有用。在旧代码中发现错误时，拥有它比没有它要好得多。

PPS 您甚至可以使用新版本的 VssMigrate 将修订重新导入到 subversion 存储库，然后在从先前修订的最后一个导入修订*之后合并所有修订。*唯一的缺点是每个人都必须从存储库中重新签出，因为修订的数量将大大减少。基本上，执行新的迁移；svnadmin 将活动的先前从 rev migrated+1 迁移的存储库作为增量转储，然后将 svnadmin 加载到新迁移的存储库中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T19:31:44.190

大约一年前，我尝试了 Polarion 和 vss2svn。

我们在VSS里有*很多*年的代码，经过所有的配置和测试，我发现对结果并不完全满意，过程又长又脆弱，最后决定从干净的导入开始的最新代码。

去年有几次我去寻找古老的历史，但不是那么多。重新开始的另一个好处是您的新 SVN 存储库将非常快！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T19:19:27.980

我最后一次尝试这个是几年前。由于没有记录 VSS 文件格式，为了获得完整的历史记录，第 3 方转换程序必须使用 VSS 的 API 来获取每个文件的每个版本。我让这个转换在周末运行，看看它已经完成了多少（百分之几），并计算出它需要几周的日历时间才能完成（我们有多年的历史）。

因此，我们决定仅将最新代码的快照移动到新版本控制系统中，并为历史记录保留 VSS 数据库的存档。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T19:22:49.330

类似于这个问题 - 不同的迁移，但我也认为尝试捕捉历史是浪费精力/时间。

[从 SourceSafe 迁移到 ClearCase 的最佳方式是什么？](https://stackoverflow.com/questions/868789/whats-the-best-way-to-migrate-from-sourcesafe-to-clearcase/868834#868834)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T19:23:43.727

几个月前，我成功地将 VSS 2005 迁移到 SVN。我使用了“VssMigrate.Tim2”工具，该工具现在显然在 CodePlex 上作为[vssmigrate](http://www.codeplex.com/vssmigrate)。它运行良好，没有重大问题。看起来修订和时间戳的顺序并不像我预期的那样，但这没什么大不了的。

编辑：使用 vssmigrate，您可以选择迁移特定的 VSS 路径（例如 $/GroupA/ProjectB），从而减少单独迁移的时间并使整个过程不那么脆弱。尽管我们在 VSS 中只有大约六个月的数据，但我并没有发现这个过程太长。我设法在一个周末完成了迁移和 Apache+SVN 设置。根据您的 VSS 存储库的大小，您可能希望创建多个 SVN 存储库而不是一个庞大的单个存储库。

我非常高兴我们离开了 VSS，尽管配置 Apache+SVN 并不是很有趣（反复试验）。我正在考虑使用[Git](http://git-scm.com/)或[Mercurial](http://www.selenic.com/mercurial/wiki/)，但当时都没有可靠的 TortoiseXxx 工具或 VS SCC 插件。虽然现在[Google 代码](http://code.google.com/p/support/wiki/DVCSAnalysis)已经支持 Mercurial 并且[TortoiseHg](http://bitbucket.org/tortoisehg/stable/wiki/Home)看起来不错，但我很想尽快尝试 Mercurial。

# erlang - 为什么 erlang:foo() 编译？

> ID：870312
> 
> 赞同：11
> 
> 时间：2009-05-15T19:02:41.127
> 
> 标签：erlang

为什么 Erlang 编译器在编译时检测不到未定义的函数。

如果我写 test.erl：

```
-module(test). 
-export([start/0]).

start() ->
       erlang:foo(). 
```

它编译得很好。

```
Eshell V5.6.5  (abort with ^G)
1> c(test).
{ok,test}
2> 
```

但是运行时崩溃。

```
2> test:start().
** exception error: undefined function erlang:foo/0 
```

为什么编译器在编译期间不发出错误或警告？它应该知道导出的函数，不是吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-15T20:44:53.593

Erlang 是一种动态语言。*然而，在编译后*进行类型检查和静态分析是一种很好的做法。

工具[Dialyzer](http://erlang.org/doc/apps/dialyzer/index.html)用于检查这种错误情况。

编译器在编译时不知道它的原因是因为可以在运行时从代码路径（也从远程节点）搜索和动态加载函数。Dialyzer 将在运行时根据代码路径检查代码。

从远程节点加载代码的能力意味着可以在设备上安装基本的“系统”，然后设备可以从网络引导自身。

您还应该记住 Erlang 的另一个特性，您可以使用以下结构[即时生成函数调用：](http://erlang.org/doc/man/erlang.html)

```
erlang:apply(ModuleName, FunctionName, ArgList) 
```

所以在这种情况下，根本不可能知道函数在编译时是否存在。

尽管模块和函数现在可能在编译时存在，但您可以热交换模块并卸载代码，因此它可能在运行时不存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:07:02.873

我认为这是一个实现问题，因为 Erlang 开发人员决定使用运行时链接而不是构建时链接。部分原因可能与版本控制和/或动态代码加载有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-20T11:32:03.187

您可以使用该`xref`应用程序检查已弃用、未定义和未使用的函数（以及更多！）的使用情况。

编译模块`debug_info`：

```
Eshell V6.2  (abort with ^G)
1> c(test, debug_info).
{ok,test} 
```

检查模块`xref:m/1`：

```
2> xref:m(test).
[{deprecated,[]},
 {undefined,[{{test,start,0},{erlang,foo,0}}]},
 {unused,[]}] 
```

您可能想在`xref`这里查看更多信息：

[Erlang -- Xref - 交叉参考工具（工具用户指南）](http://www.erlang.org/doc/apps/tools/xref_chapter.html)

[Erlang——外部参照（工具参考手册）](http://www.erlang.org/doc/man/xref.html)

# validation - 书呆子晚餐验证规则问题

> ID：870313
> 
> 赞同：0
> 
> 时间：2009-05-15T19:03:35.180
> 
> 标签：validation, controllers, nerddinner

[在 NerdDinner 教程的 Step 5中，在](http://nerddinnerbook.s3.amazonaws.com/Part5.htm)*Complete Edit Action Method Implementations*下的中间有一段：

我们的 Edit 实现的好处是，我们的 Controller 类和 View 模板都不需要知道关于晚餐模型强制执行的特定验证或业务规则的任何信息。我们可以在未来向我们的模型添加额外的规则，并且不必为了支持它们而对我们的控制器或视图进行任何代码更改。这使我们能够灵活地在未来通过最少的代码更改轻松地发展我们的应用程序需求。

我的问题是可以添加什么样的规则，并且以这样一种方式，我不会失去我的干净分离。我可以看到这段代码：

```
 public static class ControllerHelpers {

   public static void AddRuleViolations(this ModelStateDictionary modelState, IEnumerable<RuleViolation> errors) {

       foreach (RuleViolation issue in errors) {
           modelState.AddModelError(issue.PropertyName, issue.ErrorMessage);
       }
   }
} 
```

比这段代码更好：

```
catch {
    foreach (var issue in dinner.GetRuleViolations()) {
        ModelState.AddModelError(issue.PropertyName, issue.ErrorMessage);
    }

    return View(dinner);
} 
```

因为我没有特定的类/模型信息并且可以在整个应用程序中使用它。而且，如果我的错误处理像上面这样简单，我可以看到这有多好，但是我看不到如何为新的业务规则添加更复杂的东西，并希望有一个例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-23T15:40:41.733

首先要了解您发布的代码实际上只是从模型中“提取”错误并将它们放置在视图上（通过模型状态）。灵活性来自于任何新规则/编辑只需要触及模型的事实。即你只需要点击Dinner.cs 代码。

我在 NerdDinner 课程中必须了解的一件事是，验证将在 Dinner.cs OnValidate() 部分方法和对 UpdateModel() 的调用中的 DinnersController.cs 中发生。此调用将文本从屏幕复制到模型中。例如，如果它试图将文本复制到浮点数，它将更新 ModelState 并抛出错误。正常验证不会运行。

# sharepoint - SharePoint - Site.RootWeb.AllUsers 不返回所有用户

> ID：870325
> 
> 赞同：4
> 
> 时间：2009-05-15T19:06:04.050
> 
> 标签：sharepoint, user-management

我有一个 SharePoint 网站，我为其创建了一些自定义 Web 部件。其中之一需要获取 SharePoint 网站用户列表，以便我可以分配不同的属性。

编码：

```
Dim Site As New SPSite(SPContext.Current.Site.Url)
Dim AllUsers As SPUserCollection = Site.RootWeb.AllUsers
Dim u As SPUser
For Each u In AllUsers
    'SOME CODE FOR DISPLAY
Next 
```

工作得很好，但昨天我添加了一个新用户，他们没有出现在列表中。我肯定会通过显示用户的默认页面在用户列表中看到它们，所以我想知道为什么这段代码也无法获得用户。

有谁知道为什么这不会返回 SharePoint 网站中的每个用户？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T19:11:51.087

并非 sharepoint 中的所有用户集合都是平等创建的。细微差别：

[http://www.sharepointblogs.com/tingfong/archive/2007/08/21/sharepoint-spweb-allusers-vs-spweb-users-vs-spweb-groups.aspx](http://www.sharepointblogs.com/tingfong/archive/2007/08/21/sharepoint-spweb-allusers-vs-spweb-users-vs-spweb-groups.aspx)

（懒惰的快速回答 - AllUsers 显示*活跃*用户，即至少与站点集合交互过一次的用户）

-Oisin

# c# - 在 C# 中接收广播消息

> ID：870328
> 
> 赞同：3
> 
> 时间：2009-05-15T19:07:22.113
> 
> 标签：c#, broadcast

我已经尝试了很多，但不知何故，接收远程主机广播的数据报的代码似乎存在一些问题。

那么有人可以向我提供使用 UDP 连接在 C# 中接收广播消息的代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T19:39:39.477

来自[http://www.java2s.com/Code/CSharp/Network/ReceiveBroadcast.htm](http://www.java2s.com/Code/CSharp/Network/ReceiveBroadcast.htm)

```
/*
C# Network Programming 
by Richard Blum

Publisher: Sybex 
ISBN: 0782141765
*/
using System;
using System.Net;
using System.Net.Sockets;
using System.Text;

public class RecvBroadcst
{
   public static void Main()
   {
      Socket sock = new Socket(AddressFamily.InterNetwork,
                      SocketType.Dgram, ProtocolType.Udp);
      IPEndPoint iep = new IPEndPoint(IPAddress.Any, 9050);
      sock.Bind(iep);
      EndPoint ep = (EndPoint)iep;
      Console.WriteLine("Ready to receive...");

      byte[] data = new byte[1024];
      int recv = sock.ReceiveFrom(data, ref ep);
      string stringData = Encoding.ASCII.GetString(data, 0, recv);
      Console.WriteLine("received: {0}  from: {1}",
                            stringData, ep.ToString());

      data = new byte[1024];
      recv = sock.ReceiveFrom(data, ref ep);
      stringData = Encoding.ASCII.GetString(data, 0, recv);
      Console.WriteLine("received: {0}  from: {1}",
                            stringData, ep.ToString());
      sock.Close();
   }
} 
```

# c# - C# 程序员如何为 iPhone 构建软件？

> ID：870330
> 
> 赞同：0
> 
> 时间：2009-05-15T19:07:59.473
> 
> 标签：c#, iphone

为 iPhone 开发软件我应该学习什么？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-15T19:10:12.793

[为 C# 人开始 Objective C](http://scottcreynolds.com/archive/2009/02/05/beginning-objective-c-for-the-c-guy.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T19:10:09.330

学习目标 C。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T19:10:46.300

如果您正在考虑开发游戏，请查看[Unity3D](http://unity3d.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T19:11:25.987

也许看看[Mono](http://www.mono-project.com/Main_Page)？[这里](http://arstechnica.com/open-source/news/2009/01/open-source-mono-framework-brings-c-to-iphone-and-wii.ars)有一篇文章处理这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T19:13:17.917

除了 iPhone SDK，您还可以使用 Mono（开源 .Net 实现）。检查[http://www.mono-project.com/Mono:Iphone](http://www.mono-project.com/Mono:Iphone)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T19:13:37.713

iPhone 应用程序正在使用 Apple 的工具，如 Xcode、Objective c 等。AC# 开发人员将学习一门新语言、新库，并使用模拟器来运行应用程序。详情在：http: [//developer.apple.com/iphone/program/](http://developer.apple.com/iphone/program/)

# asp.net - 排序的gridview选择了错误的行

> ID：870344
> 
> 赞同：2
> 
> 时间：2009-05-15T19:10:42.963
> 
> 标签：asp.net, sharepoint, gridview, sorting, spgridview

我有一个gridview（实际上是一个SPgridview）

我使列名可点击，以便用户可以使用数据对行进行排序。这很好用。

当用户在对数据进行排序后尝试选择一行时，就会出现此问题。我可以看到gridview有点“忘记”行是如何排序的，并在排序之前选择了单击索引处的行。

我该如何解决？在用户选择一行后，我尝试再次对该行进行排序，但这似乎不起作用。网格视图是否应该记住它刚刚排序的事实？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-01-16T13:06:42.820

当您处理排序事件时，设置一个会话变量，将其设置为排序方向，并在您重新绑定数据源时使用它。

```
protected void gridview_Sorting()
{
    // BIND DATA Function
    BindData();

    DataTable dt = gridview.DataSource as DataTable;

    if (dt != null)
    {
        //Sort the data.
        dt.DefaultView.Sort = e.SortExpression + " " + GetSortDirection(e.SortExpression);

        Session["sort"] = dt.DefaultView.Sort;
        gridview.DataSource = dt;
        gridview.DataBind();
    }
}

// bind data function//

private void BindData()
{

    DataTable dt = GetDataTable();

    if (Session["sort"] != null)
    {
        //Sort the data.
        dt.DefaultView.Sort = Session["sort"].ToString();
    }

    gridview.DataSource = dt;
    gridview.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T19:15:38.833

确保您没有在回发后重新绑定网格。

```
if(!IsPostBack)
{
  gridView.DataSource = yourDataSource;
  gridView.DataBind();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-20T16:37:10.970

当我偶然发现这个问题时，我已经制作了许多可排序的 GridView，但在今天之前没有使用行命令交互。我的是一个“普通”的 GridView，而不是 SPgridview。我发现这有效：

1.  在 bindData() 中，如果我们还没有创建 DataTable 并将其放入 Session 对象中，那么就这样做。否则，我们将使用现有的、已排序的 DataTable：

> ```
> if (Session["dtbl"] == null) {
>   Session["dtbl"] = method_to_fetch_datatable();
> }
> gv.DataSource = Session["dtbl"] as DataTable;
> gv.DataBind(); 
> ```

1.  在GridView对INSERT、UPDATE或DELETE底层数据的行命令的处理中，刷新Session对象，保持排序，如果有的话：

> ```
> Session["dtbl"] = method_to_fetch_datatable();
> if (ViewState["SortExpression"] != null) {
>   DataTable dt = Session["dtbl"] as DataTable;
>   dt.DefaultView.Sort = ViewState["SortExpression"] as string;
> }
> bindData(); 
> ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T19:37:43.663

您是通过行索引还是通过要编辑的数据的唯一标识符来获取选定的行？如果您按行索引获取，则可能会“忘记”，因为您正在 OnPostBack 上重新创建 Grid。尝试遍历数据并通过它的唯一 ID 选择它，而不是它的行索引。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T11:44:28.303

查看 Johans 关于[SPGridView 和 LinqDataSource的博客](http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1!328.entry)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T20:16:59.357

我让它工作了。（有点）

在排序事件中，我保存了排序表达式（用于排序的列的名称）和升序或降序的排序方向。

然后我为gridview和databind创建数据源，在数据绑定之后，我使用gridview.sort命令按我保存在viewstate中的值进行排序。

效果很好，只有一个问题。排序时，我在多次按下同一列后切换方向。现在它认为我一直按列标题，所以它一直在反转排序。

但我只是暂时使它只在一个方向上排序。现在我在排序事件中使用发送者对象，我想如果我能获得一些关于导致事件的原因的信息，我可以告诉它只根据发送者切换方向。

谢谢 ：）

# asp.net-mvc - MVC 视图中修改相同模型值的多个控件

> ID：870346
> 
> 赞同：0
> 
> 时间：2009-05-15T19:10:54.600
> 
> 标签：asp.net-mvc, controls

我的模型中有一个字段——称之为“距离”——我想编写一个包含复选框和文本框的视图。

如果选中该复选框，则文本框将被禁用，并且在提交表单时“距离”的值为 0。

如果未选中该复选框，则“距离”会在提交表单时获取文本框中的任何值。

任何人有任何指导如何做到这一点？这是根据两个控件的状态分配模型值的逻辑让我感到困惑......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T20:58:37.010

模型行为取决于复选框所代表的内容。如果它是模型上的实际属性，那么您将需要检查值服务器端以及（可选）使用 aleemb 的 javascript 方法。

如果该字段中的检查仅表示距离为零，那么 aleemb 的方法就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:40:17.193

UI 行为可以通过复选框上的 onclick 事件处理程序使用 Javascript 来完成。您需要提交的唯一值是输入字段，其值将设置为 0 或手动设置的任何值。

使用 jQuery，您将拥有：

```
$('#checkbox_id').click(function() { $('inputfield_id').val('0'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T18:40:34.587

Aleemb 的回答就像一个魅力，有几个小的修改：

```
$("#Distance_checkbox").click(function() {
    if ($(this).is(':checked')) {
        $("#Distance_textbox").val(0);
        $("#Distance_textbox").attr("disabled", true);
    }
    else {
        $("#Distance_textbox").val("");
        $("#Distance_textbox").attr("disabled", false);
    }
}); 
```

# regex - 如何从 actionscript 中的字符串中删除“http://”？

> ID：870356
> 
> 赞同：0
> 
> 时间：2009-05-15T19:12:29.323
> 
> 标签：regex, apache-flex, actionscript-3

这个可能看起来很基本，但我不知道该怎么做 - 还有其他人吗？

我有一个看起来像这样的字符串：

```
private var url:String = "http://subdomain"; 
```

我需要什么正则表达式才能做到这一点：

```
url.replace(regex,""); 
```

并以此结束？

```
trace(url); // subdomain 
```

还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T19:16:34.073

尝试这个：

`url.replace("http:\/\/","");`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T19:21:59.380

就像贝德维尔说的。:)

这将仅在字符串的开头匹配，并且也将捕获 https：

```
url.replace("^https?:\/\/",""); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T02:24:03.943

ActionScript 确实支持比 bewdwyr 总结的更丰富的正则表达式重复。您只需要使用实际的正则表达式，而不是字符串，作为替换参数。:-)

```
var url:String;
url = "https://foo.bar.bz/asd/asdasd?asdasd.fd";
url = url.replace(/^https?:\/\//, ""); 
```

为了使这一点更清楚

```
var url:String;
var pattern:RegExp = /^https?:\/\//;
url = "https://foo.bar.bz/asd/asdasd?asdasd.fd";
url = url.replace(pattern, ""); 
```

RegExp 是一流的 ActionScript 类型。

请注意，您还可以使用 $ 字符作为行尾并使用 ( ) 来捕获子字符串以供以后重用。那里的力量很大！

# .net - 如何向某人解释不同的 .NET 版本？

> ID：870360
> 
> 赞同：2
> 
> 时间：2009-05-15T19:13:36.013
> 
> 标签：.net

我的老板一直问我“我们要升级到哪个版本的 .NET”，我回答说“3.5，最新版本”。

但后来他看到 .NET 3.5 只是 .NET 2.0 之上的一组库，我发现自己不得不向他解释。

当然，.NET 3.5 附带的 C# 版本实际上是 C# 3.0。

有什么好的方法可以向非技术人员解释不同版本的 .NET，并且不会让他们感到困惑或吓坏他们？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-15T19:16:54.103

您应该将 .NET 分解为三个不同的包：

1.  CLR，运行时
2.  图书馆
3.  语言、编译器和工具

这样一来，解释起来就容易多了。

例如，在 .NET 3.5 中，我们有：

1.  .NET CLR v2.0
2.  v3.5 程序集
3.  C# 3.0 编译器

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T19:19:16.607

并且只是添加到 Mehrdad 的列表中：

4) 承认命名法是有缺陷的，这是微软的DEVDIV应该把市场部带到外面去拍他们的一个很好的理由。

-Oisin

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T17:52:56.300

[Jon Skeet在他的](https://stackoverflow.com/users/22656/jon-skeet)[C# in Depth - Chapter 1](http://csharpindepth.com/Articles/Chapter1/Versions.aspx)一书中给出了很好的概述

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T19:25:30.493

如果我要加载[.NET 主页](http://msdn.microsoft.com/en-us/netframework/default.aspx)并查看所有对 3.5 的引用，我会假设这是最新版本。

也许[这张图](http://en.wikipedia.org/wiki/File:DotNet.svg)也会有帮助

# asp.net - 更新到预编译站点

> ID：870361
> 
> 赞同：3
> 
> 时间：2009-05-15T19:13:37.293
> 
> 标签：asp.net

我有一个预编译和部署的 .NET 2.0 网站。我已经反编译了该站点并向该站点的“开发分支”添加了新功能。我现在需要将站点升级到 .NET 3.5，以便新功能可以运行，并将新功能添加到“生产”站点。

我如何才能将这种功能合并到“生产”站点中？我有几个 C# 类、新页面和现有页面的未编译源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T19:31:37.903

如果您重新编译新功能并因此拥有一个运行新版本 .Net 的新预编译站点，除非您不进行完整部署，否则将不会合并任何内容，但如果您不进行完整部署，您怎么能已升级到新版本的 .Net？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T17:35:21.147

为什么不在 .NET 3.5 中重新编译整个站点，将 3.5 运行时安装到目标站点，然后重新安装新编译的 3.5 版本的网站？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-20T15:23:26.530

反编译的站点最好部署在3.5以下，但保留大部分2.0反编译的页面，最重要的是，将web.config替换为3.5版本。web.config 很少影响常规（aspx）页面的服务，因此将其替换为 3.5 几乎没有影响。

# c - 我应该使用什么预处理器指令或其他方法来辨别 32 位和 64 位环境？

> ID：870363
> 
> 赞同：0
> 
> 时间：2009-05-15T19:13:44.750
> 
> 标签：c, makefile, c-preprocessor, compiler-flags

我想为 32 位和 64 位系统编译以下**C程序。**

```
#include <stdio.h>                                                                                                                                                                  
#include <stdlib.h>                                                                                                                                                                 
#include <stddef.h>                                                                                                                                                                 

int main(int argc, char** argv) {
  size_t size = atoi(argv[1]);                                                                                                                                                      
  int *array;                                                                                                                                                                       

  array = malloc(size * sizeof(int));                                                                                                                                               
  if (array == NULL) {                                                                                                                                                              
    fprintf(stderr, "could not allocate memory\n");                                                                                                                                 
    exit(1);                                                                                                                                                                        
  }                                                                                                                                                                                  
  fprintf(stdout, "memory allocated on heap: %u bytes\n", sizeof(int)*size);                                                                                                        

  fprintf(stdout, "press Return to quit\n");                                                                                                                                        
  getchar();                                                                                                                                                                        

  fprintf(stdout, "freeing memory\n");                                                                                                                                              
  free(array);                                                                                                                                                                      

  exit(0);                                                                                                                                                                          
} 
```

我一直在做的`Makefile`是传递`-m32`并`-64`制作特定于位的二进制文件：

```
CFLAGS=-ansi -pedantic -Wall -O3
32BIT_ARCH=-m32
64BIT_ARCH=-m64
32_CFLAGS=${32BIT_ARCH} ${CFLAGS}
64_CFLAGS=${64BIT_ARCH} ${CFLAGS}
CC=gcc
ARRAY_32BIT_BINARY_NAME=arrayTest32
ARRAY_64BIT_BINARY_NAME=arrayTest64

all: ${ARRAY_32BIT_BINARY_NAME} ${ARRAY_64BIT_BINARY_NAME}
arrayTest32: main32_array.o 
             ${CC} ${32_CFLAGS} main32_array.o -o ${ARRAY_32BIT_BINARY_NAME}
arrayTest64: main64_array.o
             ${CC} ${64_CFLAGS} main64_array.o -o ${ARRAY_64BIT_BINARY_NAME}
main32_array.o: main.c
             ${CC} ${32_CFLAGS} -c main.c -o main32_array.o 
main64_array.o: main.c
             ${CC} ${64_CFLAGS} -c main.c -o main64_array.o 
clean:
             -rm *.o *~ ${ARRAY_32BIT_BINARY_NAME} ${ARRAY_64BIT_BINARY_NAME}
install:
             cp ${ARRAY_32BIT_BINARY_NAME} ${ARRAY_64BIT_BINARY_NAME} ../bin 
```

这很好用，但是我在编译时遇到了警告：

```
$ make                                                                                                                                   
gcc -m32 -ansi -pedantic -Wall -O3 -c main.c -o main32_array.o                                                                                                                      
gcc -m32 -ansi -pedantic -Wall -O3 main32_array.o -o arrayTest32                                                                                                                    
gcc -m64 -ansi -pedantic -Wall -O3 -c main.c -o main64_array.o                                                                                                                      
main.c: In function ‘main’:                                                                                                                                                         
main.c:14: warning: format ‘%u’ expects type ‘unsigned int’, but argument 3 has type ‘long unsigned int’                                                                            
gcc -m64 -ansi -pedantic -Wall -O3 main64_array.o -o arrayTest64 
```

我想做的是在没有两个 main.c 文件用于两个“位”目标的情况下修复此警告。

是否有一个`#ifndef`或其他预处理器条件可以添加到第 14 行`main.c`来处理这种差异？

或者有没有更好的方法来处理这个问题？

**编辑**：我使用了以下解决方案：

```
#if defined(__LP64__)                                                                                                                                                               
  fprintf(stdout, "memory allocated on heap: %lu bytes\n", sizeof(int)*size);                                                                                                       
#else                                                                                                                                                                               
  fprintf(stdout, "memory allocated on heap: %u bytes\n", sizeof(int)*size);                                                                                                        
#endif 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T19:26:37.980

C99 为打印`size_t`值提供了 'z' 修饰符；在格式字符串中使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T19:16:46.740

[如何检测我是否正在为 C++ 中的 64 位架构进行编译](https://stackoverflow.com/questions/163058/how-can-i-detect-if-im-compiling-for-a-64bits-architecture-in-c)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T19:21:22.907

有关类似问题，请参见[此处。](https://stackoverflow.com/questions/682934/is-there-a-gcc-preprocessor-directive-to-check-if-the-code-is-being-compiled-on-a/682955)

> **LP64** _LP64 定义这些宏，值为 1，如果（且仅当）编译是针对 long int 和 pointer 都使用 64 位且 int 使用 32 位的目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T19:24:31.870

您不想为每一行可能不同的代码都有一个#ifdef - 它不会扩展。

问题是 sizeof() 在 64 位上返回 64 位数量。一种可能的解决方法：

> fprintf(stdout, "堆上分配的内存: %u bytes\n", (unsigned int)(sizeof(int)*size));

前提是您知道数量将始终为 32 位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T06:27:50.777

如果您需要移植到非 C99 编译器（例如 Visual Studio），接受的答案是可以的，但由于您似乎只使用 gcc，我强烈建议 #define __STDC_FORMAT_MACROS 并使用 PRI* 宏，如我已经描述[了here](https://stackoverflow.com/questions/682934/is-there-a-gcc-preprocessor-directive-to-check-if-the-code-is-being-compiled-on-a/683692#683692)。这样您就不必每次需要打印 64 位整数时都在代码中添加不必要的 #ifdef。

# sql - 如何将此 sql 语句更改为 Crystal Reports

> ID：870368
> 
> 赞同：0
> 
> 时间：2009-05-15T19:16:11.437
> 
> 标签：sql, sql-server, crystal-reports

我的 Crystal Reports 中有三个表格，如下所示：

```
Property
  ID
  Other Data
Unit
  ID
  PropertyID <-- fk to Property
  Other Data
Tenant
  ID
  UnitID <-- fk to Unit
  Other Data 
```

该报告将仅显示没有任何租户链接的单元（按它们所属的属性分组）。一些好心人帮助我找出了查询的 SQL，它是这样的：

```
SELECT       Unit.ID
FROM         Unit
WHERE NOT EXISTS (SELECT 1 FROM Tenant WHERE Unit.ID = UnitID) 
```

现在，我知道我必须分组，`Property --> Units`但据我所知就差不多了。事实证明，SQL 表达式字段只允许返回单个结果而不是结果集，因此无法通过上述查询的结果集进行搜索，而且我不能只输入普通的 sql。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T19:22:20.767

如果您有查询（基于您对@Joe Koberg 的评论），只需将其放入存储过程中并让水晶运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T19:18:15.283

```
select unit.id 
from unit
       left outer join 
     tenant 
       on unit.id = tenant.unitid
where tenant.unitid is null 
```

如果我记得水晶查询生成器，您可以使用左连接或“不等于”连接来连接表。如果您选择左连接，还请选择仅包含连接表为空的行的条件（因此这些键之间没有关系）

# toolbar - 如何在 DeskBand 任务栏工具栏上强制 C# 中的 ComboBox 的 GDI+ 渲染？（透明度问题）

> ID：870369
> 
> 赞同：3
> 
> 时间：2009-05-15T19:16:24.853
> 
> 标签：toolbar, taskbar, deskband

[我已经使用 Codeproject 中的 BandObjectLib（ Extending Explorer with Band Objects using .NET and Windows Forms](http://www.codeproject.com/KB/shell/dotnetbandobjects.aspx) ）实现了一个 DeskBand 任务栏工具栏，修改为支持 IDeskBand2 界面，该界面允许 Windows Vista 中的开始菜单在我的 DeskBand 任务栏工具栏时保持透明度已启用。但是，组合框或文本框中显示的文本会显示与文本原始颜色混合的基础桌面背景颜色。

标签没有这个问题，因为它通常是使用 GDI(+) 绘制的，它忽略了渲染文本（而不是标签的背景）上的 DWMComposition。

我认为这个问题是因为 DWM 在 Vista 上的工作方式涉及某些文本元素，这在以下页面中进行了解释：

[在 Aero Glass 上使用 Vista 控件](http://www.codeproject.com/KB/vista/vistacontrolsonglass.aspx)
[Windows Vista Aero Pt。1 - 将 Glass 添加到 Windows 窗体应用程序](http://blogs.msdn.com/tims/archive/2006/04/18/578637.aspx)
[将 Aero Glass 添加或改装到旧版 Windows 应用程序中](http://www.codeproject.com/KB/vista/AeroGlassLegacyWindowsApp.aspx)

我只在我的 DeskBand 工具栏上使用一个组合框，所以我只需要知道如何强制组合框不使用 DWM 显示，即使 DWM 在系统上启用并且通过 IDeskBand2 接口的实现在 DeskBand 上启用。

**更新**：我已经对其进行了进一步的研究，在[将 Aero Glass 添加或改装到旧版 Windows 应用程序](http://www.codeproject.com/KB/vista/AeroGlassLegacyWindowsApp.aspx)中的 C++ 代码似乎最有可能让这个工作正常工作，因此组合框显示文本不透明。如果有人可以查看仅与组合框有关的代码并帮助我使其适用于 C# 组合框，那将是我的一个月！我已经开始赏金，希望能得到答案。

下面是来自上述项目的 EditProc.cpp 类，它应该可以快速了解我正在寻找的解决方案。要获得完整的图片，您需要查看完整的项目：

```
/*
*
* $RCSfile: aeroedit.cpp,v $
* $Source: /cvs/common/aeroedit.cpp,v $
* $Author: cvs $
* $Revision: 1.12 $
* $Date: 2007/05/20 10:38:25 $
* $State: Exp $
* Copyright (c) Stefan Kuhr
*/

#include <windows.h>
#include <tchar.h>
#include "safassrt.h"
#include "aaeroint.h"
#include "aerosubc.h"
#include "aeroglss.h"
#include <windowsx.h>
#include <gdiplus.h>
using namespace Gdiplus;

static void UpdateIfSelChanged(HWND hWnd, PAERO_SUBCLASS_WND_DATA pWndData)
{
    DWORD dwFirst, dwLast;
    SendMessage(hWnd, EM_GETSEL, (WPARAM)&dwFirst, (LPARAM)&dwLast);
    if(dwFirst!=pWndData->m_dwSelFirst || dwLast!=pWndData->m_dwSelLast)
    {
        pWndData->m_dwSelFirst = dwFirst;
        pWndData->m_dwSelLast = dwLast;
        VERIFY(InvalidateRect(hWnd, NULL, TRUE));
        VERIFY(UpdateWindow(hWnd));
    }
}

static LRESULT CALLBACK EditProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    PAERO_SUBCLASS_WND_DATA pWndData = (PAERO_SUBCLASS_WND_DATA)GetProp(hWnd,         WINDOW_DATA_STRING);
    ASSERT(pWndData);
    ASSERT(pWndData->m_pDwmApiImpl);
    WNDPROC pOldProc = pWndData->m_oldWndProc;
    ASSERT(pOldProc);
    PAERO_SUBCLASS_WND_DATA pWndDataParent =     (PAERO_SUBCLASS_WND_DATA)GetProp(GetParent(hWnd), WINDOW_DATA_STRING);

    /// 
    /// if aero glass is turned off and if we are not in destruction code, 
    /// just call the original wnd proc we had prior to subclassing:
    /// 
    if(WM_DESTROY!=uMsg && WM_NCDESTROY!=uMsg && WM_DWMCOMPOSITIONCHANGED!=uMsg &&     pWndDataParent && !pWndData->m_pDwmApiImpl->IsDwmCompositionEnabled())
        return CallWindowProc(pOldProc, hWnd, uMsg, wParam, lParam);

    if(pWndData->m_uiRedrawMsg==uMsg && pWndData->m_dwFlags & WD_IN_PAINT_CONTROL)
    {
        HDC hdc = GetDC(hWnd);
        hdc = GetDC(hWnd);
        if(hdc)
        {
            RECT rcClient;
            GetClientRect(hWnd, &rcClient);

            BP_PAINTPARAMS params = { sizeof(BP_PAINTPARAMS) };
            params.dwFlags        = 0L;//BPPF_ERASE;
            HDC hdcPaint = NULL;
            HPAINTBUFFER hBufferedPaint = pWndData->m_pUxTheme->BeginBufferedPaint(hdc,     &rcClient, BPBF_TOPDOWNDIB, &params,     &hdcPaint);
            if (hdcPaint)
            {
                LONG_PTR dwStyle = GetWindowLongPtr(hWnd, GWL_STYLE);
                DWORD_PTR dwSyscolorIdx = (dwStyle&WS_DISABLED ||         dwStyle&ES_READONLY)?COLOR_3DFACE:COLOR_WINDOW;
                VERIFY(FillRect(hdcPaint, &rcClient, (HBRUSH)(dwSyscolorIdx+1)));

                SendMessage(hWnd, WM_PRINTCLIENT, (WPARAM) hdcPaint,     PRF_CLIENT|PRF_CHECKVISIBLE);

                /// Make every pixel opaque
                    VERIFY(S_OK==pWndData->m_pUxTheme->BufferedPaintMakeOpaque_(hBufferedPaint, &rcClient));
                VERIFY(S_OK==pWndData->m_pUxTheme->EndBufferedPaint(hBufferedPaint, TRUE));    
        }

        VERIFY(1==ReleaseDC(hWnd, hdc));
        pWndData->m_dwFlags &= ~WD_IN_PAINT_CONTROL;
    }

    return 1;
}

switch(uMsg)
{
    case WM_KEYDOWN:
    {    
        LONG_PTR dwStyle = GetWindowLongPtr(hWnd, GWL_STYLE);
        if(dwStyle&WS_VSCROLL || dwStyle&ES_MULTILINE)
        {
            if(!(pWndData->m_dwFlags&WD_CARET_HIDDEN))
            {
                HideCaret(hWnd);
                pWndData->m_dwFlags|=WD_CARET_HIDDEN;
            }
        }
    }
        break;
    case WM_KEYUP:
    case WM_LBUTTONDOWN:
    case WM_LBUTTONUP:
    case WM_MOUSELEAVE:
    {
        LONG_PTR dwStyle = GetWindowLongPtr(hWnd, GWL_STYLE);
        if(dwStyle&WS_VSCROLL || dwStyle&ES_MULTILINE)
        {
            if(pWndData->m_dwFlags&WD_CARET_HIDDEN)
            {
                ShowCaret(hWnd);
                pWndData->m_dwFlags&=~WD_CARET_HIDDEN;
            }

            UpdateIfSelChanged(hWnd, pWndData);
        }
    }
        break;
    case WM_NCPAINT:
        {
            LRESULT lRes = 0;
            lRes = CallWindowProc(pOldProc, hWnd, uMsg, wParam, lParam);
            DrawEditBorder(hWnd, pWndData);
            return lRes;
        }
    case WM_NCDESTROY:
    case WM_DESTROY:
        VERIFY(UnsubclassControl(hWnd, EditProc, pWndData));
        break;
}

return CallWindowProc(pOldProc, hWnd, uMsg, wParam, lParam);
}

BOOL AeroSubClassEdit(HWND hwnd)
{
    return AeroSubClassControl(hwnd, EditProc, WD_IN_PAINT_CONTROL);
} 
```

谢谢，

John Rennemeyer
[MuvEnum, LLC](http://www.muvenum.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T17:38:46.317

这真是一个痛苦，我不知道为什么微软没有让 WinForms 控件与 DWMManager 一起工作。TextBox 很容易做，你可以在它上面重新绘制一个位图。DropDown 比较棘手，因为它内部有一个本机控件“编辑”框。由于它不是 .Net 控件（编辑部分），因此您不能使用 .Net 类轻松重绘它（我仍在尝试弄清楚如何做到这一点）。

但是，我已经想出了如何让 DropDown 在玻璃上呈现，但前提是文本框部分被禁用（通过更改样式来完成）。不完全理想。我的在 VB.Net 中，我仍在努力。然而，我受到了这个项目的启发，这个人用 C# 完成了它，并且可能对你有很大帮助：

[http://dwmwinform.codeplex.com/](http://dwmwinform.codeplex.com/)

附带说明一下，WPF 的所有控件都支持 Aero Glass 效果。它更强大，但使用起来也更耗时（IMO ......而且，如果你正在复古安装 WinForms 应用程序，WPF 对你没有任何好处）。我只是倾向于喜欢 WinForms，因为我编写业务应用程序并且并不真正关心或有时间编写动画（WPF 很酷，不要误会，我更喜欢 WinForms）。

这是我继承 ComboBox（在 Vb.Net 中）的开始。这个网站没有正确发布整个班级，所以我只包括班级的内部内容：

```
 ''' <summary>
''' Enum of Windows messages that will trigger the redraw of the control
''' </summary>
''' <remarks></remarks>
Public Enum WindowsMessage
    WM_CHAR = &H100
    WM_KEYDOWN = &H102
    WM_MOUSEMOVE = &H200
    WM_PAINT = 15
    WM_PRINT = &H314
End Enum

''' <summary>
''' Constructor
''' </summary>
''' <remarks></remarks>
Sub New()
    Me.DropDownStyle = ComboBoxStyle.DropDownList
End Sub

''' <summary>
''' Processing of incoming messages.  We're going to get a bitmap of the control and then
''' redraw it onto the form when a few specified windows messages come through.
''' </summary>
''' <param name="m"></param>    
Protected Overrides Sub WndProc(ByRef m As System.Windows.Forms.Message)
    MyBase.WndProc(m)

    Select Case m.Msg
        Case WindowsMessage.WM_PAINT, WindowsMessage.WM_CHAR, WindowsMessage.WM_KEYDOWN, _
             WindowsMessage.WM_MOUSEMOVE, WindowsMessage.WM_PRINT
            RedrawControlAsBitmap(Me.Handle)
    End Select

End Sub

''' <summary>
''' Redraws a given control as a bitmap ontop of itself.
''' </summary>
''' <param name="hwnd"></param>
''' <remarks></remarks>
Public Sub RedrawControlAsBitmap(ByVal hwnd As IntPtr)

    Dim c As Control = Control.FromHandle(hwnd)

    If c IsNot Nothing Then
        Using bm As New Bitmap(c.Width, c.Height)
            c.DrawToBitmap(bm, c.ClientRectangle)

            Using g As Graphics = c.CreateGraphics
                g.DrawImage(bm, New Point(0, 0))
            End Using

        End Using
    End If

    c = Nothing

End Sub 
```

# sql-server - 我是否必须在源表上有一个 PK 才能创建 ADO.NET 实体数据模型？

> ID：870373
> 
> 赞同：1
> 
> 时间：2009-05-15T19:16:52.510
> 
> 标签：sql-server, asp.net-mvc, visual-studio-2008, entity-framework, primary-key

我正在尝试“实体化”一些外部表（我不管理）以便在 MVC 应用程序中使用它，原则上我的尝试并没有非常成功（VS2008 输出）：

**错误列表**[0 错误] [0 警告] [1 消息]

描述

```
The table/view 'DATABASE.dbo.table' does not have a primary key defined and no valid primary key could be inferred.

This table/view has been excluded. To use the entity you will need to review your schema, add the correct keys and uncomment it. 
```

文件

```
C:\Documents and Settings\%USERNAME%\My Documents\Visual Studio 2008\Projects\MVC_Entity_Test\MVC_Entity_Test\Models\EmployeesDataModel.edmx 
```

线

```
0 
```

柱子

```
1 
```

项目

```
MVC_Entity_Test 
```

**输出**

显示来自：实体数据模型的输出

```
Added the connection string to Web.Config.
Successfully registered the assembly 'System.Data.Entity, Version=3.5.0.0,
Culture=neutral, PublicKeyToken=b77a5c561934e089' in Web.Config.
The model was generated with warnings or errors.
Please see the Error List for more details. These issues must be fixed before
running your application.
Loading metadata from database took 00:00:06.2809306.
Generating model took 00:00:03.0359078.
Writing out the EDMX file took 00:00:00.0230083.
Added the connection string to Web.Config.
Successfully registered the assembly 'System.Data.Entity, Version=3.5.0.0,
Culture=neutral, PublicKeyToken=b77a5c561934e089' in Web.Config.
The model was generated with warnings or errors.
Please see the Error List for more details. These issues must be fixed before running
your application.
Loading metadata from database took 00:00:12.3208290.
Generating model took 00:00:03.6914563.
Writing out the EDMX file took 00:00:02.1670689. 
```

*所以我的问题是，在源*表上声明一个 PK 以将其正确映射为 ASP.NET 实体是绝对强制性的吗？

**注意：**我不希望这个线程成为一篇关于伟大的、标准驱动的、学术支持的数据库建模的论文，事情是，我必须处理这个来自某个视图的外部表，它来自某个表的某个表，依此类推，所以我真的无法控制它。关键是我只想把事情做好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T21:06:56.863

实体框架是一个映射框架，因此它需要一种方法来将每一行唯一地映射到一个对象。这需要某种形式的唯一标识符，用于生成 SQL DML 语句，以便可以修改行。

在您的情况下，如果存在不包含唯一标识行的 NULL 的列组合，您可以手动将必要的信息添加到 edmx 文件中。这个 MSDN 页面将描述手动将对象添加到 edmx 的基础知识， http: [//msdn.microsoft.com/en-us/library/bb399785.aspx](http://msdn.microsoft.com/en-us/library/bb399785.aspx)。请记住，它只是一个您可以编辑的 XML 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:23:43.177

好吧，我通常建议将主键放在任何表上作为最佳实践 - 除了在非常罕见的情况下，例如用于批量加载数据的表等。

毕竟，只有使用主键，您才能唯一标识和分隔表中的行（以及域模型中的实体或对象实例）。

一位 SQL 大师甚至说： *如果它没有主键，那它就不是表！*:-)

马克

# ruby-on-rails - Ruby on Rails、ActiveScaffold 和数据库中的亲戚

> ID：870375
> 
> 赞同：3
> 
> 时间：2009-05-15T19:17:08.687
> 
> 标签：ruby-on-rails, ruby, activescaffold

我有两张桌子：表格，问题。想法很容易，每个表格都有很多问题。制作了桌子

表格 = | 编号 | 标题 |

问题= | 编号 | 标题 | 输入 | form_id |

以及如何猜测 form_id 是表单 ID 的关键。

```
class FormsController < ApplicationController
 active_scaffold :form
end

class QuestionsController < ApplicationController
 active_scaffold :question
end

class Question < ActiveRecord::Base
 has_one :form
end

class Form < ActiveRecord::Base
 has_many :question
end 
```

我想用可用形式选择一个活动支架（问题）。现在我只能输入表单的id，而不能通过下拉菜单选择它。我应该如何配置 rails 或 activescaffold？

谢谢。对不起我的英语不好 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T21:06:07.287

您需要向控制器添加一些配置。

```
class QuestionsController < ApplicationController
  active_scaffold :question do |config|
    config.columns = [:id, :title, :input, :form_id]
    config.columns[:form_id].ui_type = :select
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T16:18:37.400

如果你希望让一个下拉菜单与 activescaffold 一起工作而不会感到头疼，你必须遵循这个简单的规则：只有当你引用在 belongs_to 中声明的关联时，下拉菜单才会起作用。混合以前的答案，您可以：

在您的模型中遵循rails 方式。尊重复数和变形。然后将它们写成建议 allesklar：

```
class Form < ActiveRecord::Base
 has_many :questions
end

class Question < ActiveRecord::Base
 belongs_to :form
end 
```

在与“belongs_to”相关联中使用单数名称非常重要，在这种情况下：form

在您的控制器中使用 Sarah Mei 的答案，但稍作更改，使用您在 belongs_to 中声明的关联名称，然后您将拥有类似这样的内容

```
class QuestionsController < ApplicationController
  active_scaffold :question do |config|
    config.columns = [:id, :title, :input, :form]
    config.columns[:form].ui_type = :select
  end
end 
```

如果您使用具有多个字段的模型，请记住使用“def to_label”，因为 ActiveScaffold 无法猜测您要显示的字段。

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T09:33:22.750

我不确定 active_scaffold 但您在表单和问题模型中的关系陈述中有一些错误。我认为这就是你想要的：

```
class Form < ActiveRecord::Base
 has_many :questions
end

class Question < ActiveRecord::Base
 belongs_to :form
end 
```

希望这可以帮助。

# url-rewriting - url 重写的最佳实践和模式是什么？

> ID：870376
> 
> 赞同：2
> 
> 时间：2009-05-15T19:17:24.647
> 
> 标签：url-rewriting, friendly-url

您如何设计一个 url 重写“策略”？

我正在帮助一个尚未启动的网站（基于 url 参数），所以我有一个干净的石板，所以我不需要重定向现有的搜索引擎结果。

首先想到的是重写常见的错别字。还有什么要考虑的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T19:26:15.127

URL 重写的目的是使 URL 更友好的人类可读 URL，同时从 SEO 的角度使 URL 更好。

那么如何划分友好的词，以便人类，更重要的是搜索引擎蜘蛛识别每个词？作为 URL 中的单个文件夹还是用连字符分隔一个文件夹中的单词？

URL 通常与网页的标题有一些关系。页面将如何添加到您的网站？是否有您的最终用户将包含他们自己的标题的 CMS？您将从标题中删除哪些字符以使它们不会出现在 URL 中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T19:21:04.700

您可以将复杂的参数 url 重写为简单的，以帮助搜索引擎更好地索引您的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T19:21:24.327

可以使用 mod_speling 修复常见的拼写错误（假设您使用的是 Apache）。您可能还想考虑围绕 REST 设计网站。如果您基于该概念进行设计，那么您需要做什么才能很好地重写您的 URL 变得非常明显。您可能想在 Google 上搜索有关 REST 架构的介绍。

# java - J2ME - 一次编码，到处运行？

> ID：870387
> 
> 赞同：3
> 
> 时间：2009-05-15T19:20:43.483
> 
> 标签：java, java-me

我可以在 J2ME 中编写一次代码并在任何手机上运行它，就像我可以使用 .Net 紧凑框架一样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T19:27:27.760

您将遇到每个提供者如何实现其 JVM 的差异。由于每部手机的硬件不同，它们的工作方式也略有不同。大多数东西都会起作用，但可能会有一些差异。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T10:54:16.400

遭受碎片化的几个领域：

*   如果您只使用基本的 GUI 控件，您的应用程序可能看起来与一部手机略有不同。如果不需要，则必须编写处理不同屏幕尺寸和输入法（键盘与触摸屏）的代码。

*   制造商倾向于以不同的方式解释多媒体和网络的规范，或者只是运送包含错误的手机。一些移动网络运营商将只允许 HTTP 网络流量。

*   管理文件系统访问的安全策略因一部手机而异。在某些手机上，RMS 记录的大小可能会受到限制。

*   性能因一部手机而异。

...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T18:39:23.813

您编写的 J2ME 代码在运行时和可访问的类方面需要手机上的特定环境。根据您在应用程序中使用的内容，您可以在某些手机上运行它，而在其他手机上则无法运行。例如，假设您是一个使用 MIDP 2.0 和 CDLC 1.1 的 J2ME 应用程序。现在，您的应用只能在支持这些配置文件的手机上运行。

在编写手机应用程序时，您通常会针对特定的手机细分市场。您不希望加速度计应用程序可以在没有加速度计的手机上工作！（我不认为 J2ME 对加速度计有任何支持；））

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T22:59:21.983

是的，您可以在任何支持 java 的手机上运行您的 midlet。

但是当谈到 j2me 编码时，“一次编写，随处运行”的口号变成了

“一次编写，到处重写”

或者

“一次编写，到处调试”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-24T21:11:14.930

首先，我想说这里的大多数评论都是正确的，不同的 JVM 可能确实略有不同，您应该记住您正在使用的 API。

但是，还有一个需要考虑的因素：**标准化**。我的意思是诸如**移动服务架构**（MSA - JSR 248）之类的东西，它们通过创建一些标准的 API 集极大地简化了事情。此外，它们对包含的 API 和如何实现它们的规则进行了一些说明。

MIDP 2.1 之类的东西也在收紧标准。2.1 版本基本上是 2.0，但带有“螺栓拧紧”：更严格的规则，使某些方面清晰并消除潜在的碎片。例如，在任何情况下都需要包含双缓冲，或者如果设备有触摸屏，则需要在 Java 中支持触摸屏。

话虽如此，我应该得出结论，碎片化确实在减少，制造商确实采用了 JSR 248 之类的标准。但是无论如何都要尽可能多地测试您的应用程序，我们都是普通人，JVM 开发人员也会犯错误并在他们的代码中留下错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T19:50:19.887

J2ME 和 .NET Compact Framework 都不是无处不在，（尽管有大量手机支持 J2ME）您只能在支持它们的手机上运行其中任何一个。因此，无论哪种情况，您都可以编写一次并在支持平台/框架的任何地方运行。

# mfc - 静态控制不透明+MFC

> ID：870394
> 
> 赞同：0
> 
> 时间：2009-05-15T19:21:58.973
> 
> 标签：mfc

我们创建了一个工具栏。工具栏上有一个静态控件，我们在该静态控件上放置了 ab 图标图像。问题是静态控件有自己的颜色，我们无法使其相对于浏览器主题颜色透明。

所以当浏览器主题改变时，我们的图标似乎有一些背景颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T10:55:02.203

Have you considered looking at overriding WM_CTLCOLOR in your toolbar to return a NULL_BRUSH when painting static control(s)?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-06T21:03:20.027

那么派生您自己的所有者绘制的静态控件并使用加载到 CImage 中的 PNG 来为您提供每像素 alpha。

如果无法使用 maskblt 执行您所要求的操作......但使用 ATL 和 GDI+ 的 CImage 类更容易全面:)

# asp.net - 管理多语言数据的良好 UI 设计是什么？

> ID：870398
> 
> 赞同：2
> 
> 时间：2009-05-15T19:22:46.710
> 
> 标签：asp.net, localization, user-interface, globalization

我将创建一个多语言网站 (asp.net)，并且想知道如何最好地处理大部分管理屏幕 UI 工作，最终用户将维护需要以多种语言显示的数据列表。任何人都知道我可以查看的任何好的示例应用程序吗？

示例场景。我有一个管理员将使用的屏幕添加新产品。需要为系统中的每种语言存储标题和描述，并且需要进行保存。理想情况下，语言的数量是动态的/可配置的，每次添加新语言时 UI 都不需要更改。

想法/建议/例子？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T19:30:17.720

我们之前的内部 CMS 使用了一个编辑人员似乎喜欢的相当简单的模型：在每个输入字段上，有一排薄薄的切换按钮（由 JS 驱动）选择当前正在编辑的语言：

```
[EN-US] [FR-FR] [SW-SE] [RU-RU] [ZH-CN]
 _____________________________________
| textbox                             |
|_____________________________________| 
```

它们的行为有点像单选按钮，例如选择一个取消选择所有其他按钮，并且文本框立即翻转以反映该值。这些按钮足够小，可以在输入字段上方大约 16 处放置，然后才开始变得笨拙。

我还建议在页面顶部使用“主切换”，它可以同时切换所有控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T14:12:41.100

为了跟进@mikehall 上面的回答，我会做这样的草图：

[本地化数据输入 http://redbitbluebit.com/images/language.png](http://redbitbluebit.com/images/language.png)

当然，我的翻译是编造的；-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T21:34:38.843

我们有一个旧的 MFC 应用程序可以执行此操作。它有一个名称文本框，该名称将是您以对话框的当前语言（当前用户设置并正在查看应用程序的语言）管理的对象的名称。然后下面有一个列表视图，您可以在其中为您支持的每种语言添加其余名称。

可能会改变您的方法的一件事是，您支持的每种语言是否都需要一个名称。如果是这样，您可以让列表视图为每种语言预先填充一行。如果没有，那么他们可以根据需要添加带有名称的行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T22:42:32.533

我在每个内容条目中存储一个“区域设置”ID（例如，产品 1、区域设置 1；产品 1、区域设置 2 等...）

区域设置与语言（英语、法语、日语...）和地区（美国、加拿大、日本...）相关联

这样，您可以将“US-English”和“US-Spanish”与墨西哥的西班牙语分开存储。

本地化通常不仅基于语言，而且基于内容。例如，某些产品可能在某些国家/地区不可用。

在内容管理方面，我通常通过 cookie 设置区域设置（即用户可以选择“更改区域设置”，更改区域设置，然后继续编辑/创建内容）。我这样做的原因是，除了内容加载之外，您通常没有相同的内容输入人员输入多种语言（而那些必须手动切换的人，否则他们会感到困惑：“现在，什么语言是我又一起工作了？”）

这些只是一些快速指示——评论，我将根据我过去所做的添加建议（对于个人网站，以及像 Blockbuster 和 Avery Dennison 这样的公司）......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T21:36:49.710

另一个建议是有一个串行用户界面。在添加产品 UI 的情况下，您将有一个标题/描述字段列表，为每种支持的语言设置一组。

这可能看起来过于简单和浪费屏幕空间，但我认为这是必要的，原因如下：

1.  如果每种语言都需要有效值才能保存，那么只有一个动态 UI（Rex M 建议的语言“单选按钮”）将很难向用户指示验证错误。
2.  与最后一点相关的是，串行 UI 允许快速扫描语言 UI。这不仅仅是为了确保所有内容都已填写，而且还允许用户快速比较输入。Add Product 示例本质上是一个用于输入简短翻译的 UI，因此能够在相关语言之间进行比较非常有用。通过将相似的语言组合在一起，您可以使其更加有用。

串行接口可以简单地通过一个循环来呈现，该循环遍历您当前支持的任何语言。

# php - 设置 PHP 以使整数为 64 位的具体细节是什么？

> ID：870401
> 
> 赞同：2
> 
> 时间：2009-05-15T19:23:28.500
> 
> 标签：php, 64-bit

我认为 PHP 能够拥有通用的 64 位整数（而不是使用数学包）的一般想法是使用 64 位硬件和 64 位 PHP。有人知道具体情况吗？比如Core2Duo机器就不能支持吗？像 Vista 或 OS X 这样的 32 位版本的操作系统呢，它们也能支持吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T19:25:52.647

*   32 位操作系统不支持 64 位软件。
*   Core2Duo 是 64 位的（也可以在 32 位模式下运行）
*   windows x64有一个[PHPx64 项目](http://www.fusionxlan.com/PHPx64.php)，但我不确定它是否会给你 64 位整数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T19:42:31.403

只要您使用 64 位操作系统并安装 64 位二进制文​​件，就可以开始使用。

例如，我的开发盒是 centos，我安装了 php-*.x86_64 包。

当我运行时：

```
$ php -r 'echo PHP_INT_MAX;' 
```

我得到：

```
9223372036854775807 
```

如果 64 位二进制文​​件不适用于您的平台，显然您在编译时只需要记住一个配置选项：[–with-libdir=/lib64](http://www.blackbeagle.com/web-hosting/compiling-php-on-a-64-bit-system/)

如果您使用的是 Windows，那么这里有[很多资源](http://www.google.com/#q=php+64+bit+compile+windows)：Windows 上的 64 位 PHP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T05:49:46.373

您必须拥有 64 位硬件和 64 位操作系统才能以 64 位运行 PHP。从源代码编译 PHP 应该会自动检测到这一点。如果您要安装二进制文件，它们必须编译为 64 位，这显然不能从 php.net 获得，但可以在 Internet 上的其他地方获得。

请参阅此[相关问题](https://stackoverflow.com/questions/864058/how-to-have-64-bit-integer-on-php/864402)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T06:21:47.623

PHP 在 64 位版本中不可用（来自官方来源）。

# java - 将线程类作为守护进程运行

> ID：870410
> 
> 赞同：0
> 
> 时间：2009-05-15T19:26:10.243
> 
> 标签：java, multithreading, daemon

我正在用 Java 编写一个多线程解决方案来连接两个系统 A 和 B。系统 A 是完全串行的，不是线程的，并且将提供数据以发送到系统 B。系统 B 同时异步接受来自多个源的数据时间。

我正在使用 ThreadPoolExecutor 来管理线程。我正在使用一个类 TP 的静态单例实例，它围绕着 ThreadPoolExecutor（也是静态的），因为系统 A 无法创建新对象，但它可以调用静态对象。

这是我卡住的地方。在全力以赴之前，我正在对设置进行一些非常基本的测试。我创建了两个测试类，T1 和 T2。这些类中的每一个都导入类 TP（创建静态单例的地方）。T1 将一些对象添加到 TP 队列，然后 T2 添加更多。

尽管 TP 对象被声明为静态，但看起来有两个版本并行运行。T2 提交到队列的对象在 T1 提交的对象全部执行完之前正在执行。此外，由于 T1 或 T2 都没有在 ThreadPoolExector 上调用 shutdown()，因此它们都挂起并且永远不会终止。

我如何创建一个线程的守护进程静态实例，只要我发送要处理的内容，即使是来自不同的 Java 可执行文件，它基本上都会唤醒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T19:30:54.927

如果您正在运行两个单独的进程，那么您将拥有两个单独的类型和两个单独的实例，无论它是否是单例。

如果您希望两个不同的进程相互通信，则需要完全分别解决该问题。有许多不同的 IPC 机制可用 - 网络、命名管道（Java IIRC 中的棘手）、内存映射文件、一个简单的共享目录，其中一个进程将任务放置给另一个进程处理等。

也不清楚到底挂的是什么，或者你的线程池是如何配置的。如果问题确实是线程方面（而不是 IPC 方面），那么请发布一个简短但*完整*的程序来演示该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T19:30:44.990

如果线程池的大小大于 1，则不能保证所有 T1 对象都会被首先处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T19:51:53.723

在我看来，您正在运行两个不同的“主”类，每个类都使用相同的静态单例类。在这种情况下，将创建两个单例实例——每个 JVM 中都有一个。

我认为您想要做的是将线程池封装在另一个进程中，该进程作为服务运行并公开 IPC 的某些机制，正如 Skeet 所评论的那样。一种常见的方法是公开一个 JMS 队列以接收来自不同生产者的请求，并让消费者（您的守护程序）将其接收到的请求分派到线程池进行处理。

要将此服务作为守护程序运行，您可以将其托管在容器中，或者如果您在 Windows 上运行，则可以使用[Java Service Wrapper之类的东西。](http://wrapper.tanukisoftware.org/doc/english/download.jsp)

# java - 通过 JNI 将双字节 (WCHAR) 字符串从 C++ 传递到 Java

> ID：870414
> 
> 赞同：8
> 
> 时间：2009-05-15T19:27:26.603
> 
> 标签：java, visual-c++, unicode, java-native-interface

我有一个通过 JNI 使用 C++ DLL 的 Java 应用程序。一些 DLL 的方法采用字符串参数，其中一些方法也返回包含字符串的对象。

目前 DLL 不支持 Unicode，因此字符串处理相当简单：

*   Java 调用 String.getBytes() 并将结果数组传递给 DLL，DLL 只是将数据视为 char*。
*   DLL 使用 NewStringUTF() 从 const char* 创建 jstring。

我现在正在修改 DLL 以支持 Unicode，切换到使用 TCHAR 类型（定义 UNICODE 时使用 windows 的 WCHAR 数据类型）。修改 DLL 进展顺利，但我不确定如何修改代码的 JNI 部分。

我现在唯一能想到的是：

*   Java 调用 String.getBytes(String charsetName) 并将结果数组传递给 DLL，DLL 将数据视为 wchar_t*。
*   DLL 不再创建字符串，而是将 jbyteArrays 与原始字符串数据一起传递。Java 使用 String(byte[] bytes, String charsetName) 构造函数来实际创建字符串。

这种方法的唯一问题是我不确定要使用什么字符集名称。WCHAR 的长度为 2 字节，所以我很确定它是 UTF-16，但在 java 端有 3 个可能性。UTF-16、UTF-16BE 和 UTF-16LE。我还没有找到任何文档告诉我字节顺序是什么，但我可能可以通过一些快速测试来弄清楚。

有没有更好的办法？如果可能的话，我想继续在 DLL 中构造 jstring 对象，因为这样我就不必修改这些方法的任何用法。但是，NewString JNI 方法不采用字符集标识符。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T19:35:54.617

[这个答案](https://stackoverflow.com/questions/421530/is-endian-conversion-required-for-wchart-data/421603#421603)表明 WCHARS 的字节顺序不能保证......

由于您在 Windows 上，您可以尝试`[WideCharToMultiByte](http://msdn.microsoft.com/en-us/library/aa450989.aspx)`将 WCHAR 转换为 UTF-8，然后使用您现有的 JNI 代码。

由于参数中缓冲区溢出的可能性，您需要小心使用[WideCharToMultiByte](http://msdn.microsoft.com/en-us/library/aa450989.aspx)`lpMultiByteStr`。为了解决这个问题，您应该调用该函数两次，首先`lpMultiByteStr`设置为`NULL`并`cbMultiByte`设置为零 - 这将返回所需`lpMultiByteStr`缓冲区的长度而不尝试写入它。获得长度后，您可以分配所需大小的缓冲区并再次调用该函数。

示例代码：

```
int utf8_length;

wchar_t* utf16 = ...;

utf8_length = WideCharToMultiByte(
  CP_UTF8,           // Convert to UTF-8
  0,                 // No special character conversions required 
                     // (UTF-16 and UTF-8 support the same characters)
  utf16,             // UTF-16 string to convert
  -1,                // utf16 is NULL terminated (if not, use length)
  NULL,              // Determining correct output buffer size
  0,                 // Determining correct output buffer size
  NULL,              // Must be NULL for CP_UTF8
  NULL);             // Must be NULL for CP_UTF8

if (utf8_length == 0) {
  // Error - call GetLastError for details
}

char* utf8 = ...; // Allocate space for UTF-8 string

utf8_length = WideCharToMultiByte(
  CP_UTF8,           // Convert to UTF-8
  0,                 // No special character conversions required 
                     // (UTF-16 and UTF-8 support the same characters)
  utf16,             // UTF-16 string to convert
  -1,                // utf16 is NULL terminated (if not, use length)
  utf8,              // UTF-8 output buffer
  utf8_length,       // UTF-8 output buffer size
  NULL,              // Must be NULL for CP_UTF8
  NULL);             // Must be NULL for CP_UTF8

if (utf8_length == 0) {
  // Error - call GetLastError for details
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T19:37:08.623

我发现了一个关于字节顺序标记[的小问题。](http://unicode.org/faq/utf_bom.html#BOM)同样来自该常见问题解答：

> UTF-16 和 UTF-32 分别使用两个和四个字节长的代码单元。对于这些 UTF，有三种子风味：BE、LE 和未标记。BE 形式使用 big-endian 字节序列化（最高有效字节优先），LE 形式使用 little-endian 字节序列化（最低有效字节优先），未标记形式默认使用 big-endian 字节序列化，但可能包含字节顺序在开头标记以指示使用的实际字节序列化。

我假设在 java 端，UTF-16 会尝试找到这个 BOM 并正确处理编码。我们都知道假设是多么危险……

由于评论而编辑：

微软使用 UTF16 little endian。Java UTF-16 尝试解释 BOM。缺少 BOM 时，默认为 UTF-16BE。BE 和 LE 变体忽略 BOM。

# c# - 用于 C# 的 RDF/OWL/SPARQL/Triple Stores/Reasoners 和其他语义 Web API？

> ID：870417
> 
> 赞同：5
> 
> 时间：2009-05-15T19:28:29.113
> 
> 标签：c#, semantic-web

对于那些从事语义 Web 开发的人，您使用哪些 C# 工具进行推理、解析等？这个想法是为当前可用的所有 C# API 构建一个中央存储库。有点像我在[这里](https://stackoverflow.com/questions/654771/algorithms-and-data-structures-that-are-not-mainstream-closed)做的。如果可以，请发布链接，以便我能够正确总结。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T09:57:54.430

可以在[W3C SemanticWebTools 页面](http://esw.w3.org/topic/SemanticWebTools#head-d8245ac3b165f69548a586e7eaed613b18706ace)或[AI3 swtools 列表中找到几乎完整的 .net（c# 或其他）语义 Web 工具列表](http://www.mkbergman.com/?page_id=325)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-07T09:17:15.540

你可以试试我的库[dotNetRDF——](http://www.dotnetrdf.org)它是免费和开源的，并提供了规范 SPARQL 实现的状态，包括几乎所有当前的 SPARQL 1.1 草案特性

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-21T16:04:18.667

我在 Codeplex 找到[了 RDFSharp](http://rdfsharp.codeplex.com "RDFSharp - 开始玩 RDF！")，对我来说，它看起来很有前途，有很好的想法和用户友好的 API。它还很年轻，所以它只能随着时间的推移而成熟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-06T23:52:14.390

我强烈推荐这个领域的 Intelldimensions 产品。

*   [语义服务器](http://www.intellidimension.com/products/semantics-server/)
*   [语义 SDK](http://www.intellidimension.com/products/semantics-sdk/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-12T03:10:34.763

对于提供 VS.NET 扩展的 FOSS 产品和完整的 LINQ 查询提供程序，请考虑[linqtordf](http://code.google.com/p/linqtordf)

# php - 通过首页中的代码制作 Drupal 6 反向节点顺序

> ID：870419
> 
> 赞同：0
> 
> 时间：2009-05-15T19:29:11.063
> 
> 标签：php, drupal, drupal-6

我试图让 Drupal 6 反转节点出现在首页的顺序。我几乎使用“Story”作为博客引擎，到目前为止，它的工作做得很好。尽管节点按时间倒序排列，但我有点恼火。我的意思是，当然，如果您想在单个页面中显示多个节点预览，这就是要走的路。就我而言，我想在主页上显示一个完整的帖子，并将其作为列表中的“最后一个”项目（并让寻呼机相应地采取行动）。我认为这更直观，因为“第一个”链接实际上应该指向第一篇博客文章。

到目前为止，我已经设法编辑“node.module”以按时间顺序显示项目，寻呼机的行为也是如此。我似乎无法弄清楚如何使默认页面成为“最后一个”页面。

非常欢迎任何指示或想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T19:43:24.803

在 Drupal 中，有很多方法可以解决任何给定的问题，但通常有一种或两种“最佳”方法。对于 Drupal，“最佳”通常指优雅或约定俗成。

在这种情况下，两者兼而有之。您想要的，而不是修改 node.module，是设置视图。Views 是一个模块，它不仅允许您过滤、排序和排列出现在 Drupal 站点首页上的内容，而且基本上还包括其他任何地方。

通过阅读以下讨论开始进入兔子洞：

[http://drupal.org/node/300919](http://drupal.org/node/300919)

然后记住以下几点。使用 Drupal，如果您寻找不涉及更改任何“核心模块”（/modules 文件夹中的文件）的解决方案，您将获得最佳结果。最好不要管这些文件，因为它们经常被 Drupal 安全和功能更新更新，并且您不希望在每个版本的生命周期中手动复制 12 次更改。

相反，您经常会发现贡献的或自定义的模块可以解决问题。并且有很多方法可以通过预处理器函数来操作内容，你可以谷歌一下。

我祝你在冒险中好运。一开始可能会令人沮丧，但是如果您继续使用该系统一段时间，它会带来很大的回报。

# java - 在 Eclipse IDE 中，如何显示 jar 中存在的类型列表？

> ID：870424
> 
> 赞同：2
> 
> 时间：2009-05-15T19:30:51.713
> 
> 标签：java, eclipse, jar

我正在重新发现 Java，但我对如何在 Eclipse 中做到这一点有点迷茫。我正在寻找 Visual Studio“对象浏览器”功能，但我会选择在我引用的外部 jar 文件中定义的类型的快速列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T19:34:20.970

将 jar 添加到项目的构建路径（右键菜单） 它会显示为一个 Jar（玻璃的），用箭头打开它，就好像它是一个目录一样。现在，打开它，你会看到它的内容——包含类的包。

但是，我建议您先查找 javadocs。当您拥有 javadoc 时，谁需要该类列表！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T19:40:36.993

包资源管理器允许您将项目文件的内容作为对象浏览，一旦展开包，您将看到类，您可以展开类以查看其方法。

同样，项目有一个“参考库”部分，该部分将扩展以显示项目所依赖的 jar，因此允许浏览它们的包/类/方法。

查看类/接口时，您可以按 F4（或使用右键菜单）在其类型层次结构中查看它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T20:18:02.863

`Cntrl+Shift+T`将在所有引用的 .jars 中列出所有类型

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T19:34:07.307

一种方法是扩展 jar 文件（就好像它是一个目录一样），它将显示其内容。

我不知道在单个 jar 文件中仅显示类型列表的任何方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T20:45:47.803

执行此操作的正确方法：

首先，使用 Project Properties 将 Jar 导入到项目的构建路径中...

然后，打开 Java Browsing 透视图。

单击要在项目视图中浏览的 Jar。

单击包视图中的每个包 - 类型将显示在类型视图中。

快速提示：CTRL + SHIFT + T（打开类型...）将允许您打开任何 Eclipse 识别为 Java 类型的类型，无论位置如何（它可能在 jar 中）。但是，CTRL + SHIFT + R（打开资源...）不会 - 仅打开当前项目中的资源，因此尽管您可以访问本地类，但您将无法打开 jar 中的任何内容。

# wav - 在另一个 WAV 中找到一个 WAV 样本的出现？

> ID：870426
> 
> 赞同：7
> 
> 时间：2009-05-15T19:31:05.473
> 
> 标签：wav, fft

如果已知确切的样本存在于 wav 中的某处（但可能与其他声音混合），则 FFT 是否有可能在较长的 wav 中找到一个小 wav 样本的出现？

*编辑*

（在收到两个回复后）：如果我有一个包含所有已知声音的库，可以在较大的 WAV 中，并希望在该 WAV 中找到它们中的每一个的出现，该怎么办？换句话说，我知道可以混入大 wav 的*所有可能的声音，并希望找到它们的出现？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-13T14:24:48.683

这完全取决于您要查找的内容以及要查找的内容。

*   如果您正在寻找一个与较大的 WAV 文件块完全相同的样本，逐位，那么您可以直接搜索这些值。
*   如果它是完全相同的声音，但样本不准确（例如，将 MP3 的剪辑与同一首歌的 WAV 匹配），您可以使用[cross-correlation](http://en.wikipedia.org/wiki/Cross-correlation)轻松找到它。通过使用 FFT 方法而不是显式地将样本相乘和求和的“朴素”方法，可以显着加快互相关。
*   如果您正在寻找与其他声音混合的短样本，仍然可以使用互相关，但这取决于其他声音是否会影响匹配。对于具有简单样本且没有效果的数码钢琴，直接进入数码录音机，这可能会奏效。
*   但是，如果声音经过了任何类型的滤波、极性反转或相移，则效果不会很好，因为波形会发生变化。因此，如果钢琴是通过扬声器演奏然后用麦克风录制的，这不是一个可行的解决方案。

在这种情况下，更好的方法是使用[短时傅里叶变换](http://en.wikipedia.org/wiki/Short-time_Fourier_transform)(STFT) 创建记录的频谱图，以及您正在寻找的东西的频谱图，然后[对](http://en.wikipedia.org/wiki/Spectrogram)两张图片。频谱图是声音频谱随时间变化的幅度的 2D 图像，然后您可以进行匹配。（这可能是一种迂回的方式来做一些有更专业算法的事情，但我不知道它会被称为什么。）;）

你能在某处上传一些声音片段吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T14:38:00.363

我假设您的精确值并不意味着样本值精确。如果它是精确的样本值，那么搜索样本值将是一件简单的事情，既快速又高效。

如果您正在寻找有贡献的声音，最好的方法是使用称为“卷积”的数学过程。基本上，取您试图在大样本中找到的样本，有效地将其放在大样本旁边，然后进行关联。对每个样本位置执行此操作。您将由此得到一条曲线，该曲线将在样本所在的位置具有明显的尖峰。它的计算量很大，但是计算机的速度很快，所以它是可行的。

但是 - 这是假设样本来自两种情况的相同记录。从两个不同的位置拾取鼓声，即使是相同的鼓声，也不会产生很好的相关性。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T19:37:08.717

不完全像你定义的那样，如果它与其他声音混合，这就是原因；考虑波与其逆波精确混合的影响；结果是平淡的反应。波的混合可以具有单调功能，即以一种无法恢复的方式有效地用另一种波掩盖一个波。

也就是说，可能有一种方法可以表征波的“签名”，使其可能出现在合成的波文件中，但该签名将取决于波文件的长度以及在某种程度上是什么类型预计将在其上进行组合。

您的问题可能与确定一件作品的样本是否存在于另一件复合作品中有关。一般来说，是的，FFT 可用于确定给定波的“特征”，并能够从另一个波中提取该“特征”；它们对某些事情有好处（例如频移；它只是在 FFT 上显示为位移），但对其他事情不是很好（例如，改变频率调制；原始的高（或不均匀）带宽压缩信号）。换句话说：FFT 是检测样本“幼稚”使用的好方法，但如果他知道这是使用的检测技术，则确定的重采样器可以修改原始样本，使其难以通过 FFT 检测。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T19:40:10.943

如果您知道样本的确切性质（以位为单位的长度等），那么很有可能。如果它以任何方式发生变化，那么您将首先要做很多工作。

由于 WAV 文件的编码方式（按轨道顺序 - 所以你得到第一个轨道的第一批位，然后是第二个轨道的第一批位，然后是第一个轨道的第二批位）

这显然可以重复尽可能多的轨道。如果您知道您要查找的 WAV 文件是在其中一个轨道中专门编码的，那么您可以隔离每个轨道并对其执行操作。

显然，如果您的样本在速度、速度、音高等方面有所不同，那么它将具有不同的位签名，因此您必须对音轨进行归一化。

# ruby-on-rails - 您如何做到这一点，以便 www.site.com/123 或 www.site.com/123/some-headline 都将用户引导到同一个地方，即 www.site.com/123？

> ID：870437
> 
> 赞同：0
> 
> 时间：2009-05-15T19:34:28.770
> 
> 标签：ruby-on-rails, ruby, url, routing

您如何做到这一点，以便 www.site.com/123 或 www.site.com/123/some-headline www.site.com/123/anything-at-all 将用户引导到同一个地方，即 www。网站.com/123 ? 我认为 Ruby on Rails 中的路由可以做到这一点。但除此之外，还有什么其他方法可以做到这一点。可以单独由Apache完成吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T19:39:06.640

您可以使用 Rails 路由或 Apache 中的 mod_rewrite 来完成。

[http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T19:48:21.563

使用 Mod 重写：

```
RewriteEngine ON 
RewriteRule ^([0-9]+)/*$ /$1 [R=301,L] 
```

使用 routes.rb

```
map.connect ':my_id/:headline', :controller => 'controller_name', 
            :action => 'action_name', :my_id => /[0-9]+/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T19:43:37.737

Apache 的 mod_rewrite 和一些正则表达式的组合应该是你所需要的。

[mod_rewrite](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T22:34:12.443

虽然它不能完全回答您的问题，但大多数 Rails 网站在破折号后使用 slug 而不是斜线，就像这样：www.site.com/123-my-headline。

为此，您可以在模型中创建自己的 to_params 方法。

不需要做更多的工作，因为 find 方法将自动返回页面 #123，因为 ruby​​ to_i 方法将返回开始字符串的整数并忽略以第一个非数字字符开头的所有字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T12:44:47.760

从 rails 1.2.6 开始，您可以添加两条路线：

```
map.connect ':id', :controller=>:post,:action=>:show
map.connect ':id/:title', :controller=>:post,:action=>:show 
```

RESTful 的东西可能会有所不同

希望对你有帮助

# continuous-integration - 如何确保同一项目的团队城市构建配置以特定顺序运行？

> ID：870439
> 
> 赞同：1
> 
> 时间：2009-05-15T19:34:52.560
> 
> 标签：continuous-integration, teamcity

我的设置：一个项目有两个构建配置（“ci”和“reset dbs”）

*   “ci”只是项目的常规 ci 构建

*   “reset dbs”使用相同的 VCS，但仅触发“common\database”文件夹中的构建（运行测试所需的数据库的重置）（触发模式：+：Common/Database/**）

现在-我希望当我将内容检入“数据库”文件夹时-“重置数据库”构建总是在常规“ci”构建之前运行。

我现在所做的是将“ci”构建的安静期设置为与 VCS 的轮询间隔相同 - 这应该让我“重置 dbs”总是首先运行，对吗？

到目前为止似乎正在工作（几个测试提交） - 但我希望它完全正确。

有一个更好的方法吗？

我看到另一种方法是复制“ci”配置并在重置构建后触发一个名为“ci after reset”的配置。然后让常规的“ci”排除“database”文件夹。感觉就像一个黑客。

谢谢！

更新：整个想法是不必在每次提交时都运行“reset dbs”，而只是在需要时运行——在这种情况下，它必须在“ci”构建之前运行。感谢您迄今为止的回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T09:15:14.687

在最新版本的 teamcity 中，您可以配置构建优先级。这可以通过以下方式解决您的问题：

1.  设置“ci”和“reset dbs”以在它们应该使用构建触发模式时触发（您似乎已经这样做了）。触发器应指定对“数据库”文件夹的更改会触发这两种配置。

2.  转到构建队列 -> 配置构建优先级。现在给予“reset dbs”更高的优先级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:50:35.430

您可以将“reset dbs”配置配置为由签入（默认）触发，并通过“reset dbs”配置的完成触发“ci”配置（称为“依赖”触发器）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T17:58:20.440

我不知道它是否解决了它，但是在构建触发下有一个名为依赖项的选项卡。您可以在此处选择必须在当前构建之前运行的构建。

# javascript - struts 2 如何从 struts.jar 在 jsp 中包含 javascript 文件？

> ID：870440
> 
> 赞同：3
> 
> 时间：2009-05-15T19:35:06.150
> 
> 标签：javascript, jsp, struts2

我注意到struts 2 框架的javascript 客户端验证功能使用struts2 JAR 文件中的javascript 文件。javascript 文件显然只是通过使用框架中的标记以某种方式包含在 JSP 页面中。

如果我设法做到这一点，它将对我总是在每个新 Web 项目中复制的许多 javascript 库文件非常有帮助，因为我会将它们全部放在一个 JAR 文件中，然后每个项目都不会有不同的文件的副本（您可能知道，这会带来很多麻烦）。

有人知道他们是怎么做到的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T15:52:57.403

好吧，我从工作中抽出一些时间来研究框架是如何做到这一点的。事实证明，Struts 2 有一个提供静态内容的实现。这是通过属性在配置文件 struts.properties 中配置的：**struts.serve.static**。

如果该属性设置为**true** ，则JSP 页面中以路径**/struts/**或**/static/**开头的任何静态内容（javascript、css、图像等）都将由 struts FilterDispatcher 和称为 DefaultStaticContentLoader 的其他类提供服务。

例如：

```
<script language="JavaScript" type="text/javascript" src="struts/someScript.js"></script>
<script language="JavaScript" type="text/javascript" src="static/otherScript.js"></script> 
```

这两个 javascript 文件都将由 Filter 和 ContentLoader 提供。

默认情况下，ContentLoader 类只会在 Struts 2 核心 JAR 中的两个文件夹中查找请求的文件：**org.apache.struts2.static**和**template**。

现在有一种方法可以让 ContentLoader 在其他地方查找，它在过滤器参数的 web.xml 文件中配置，如下所示：

```
<filter>
<filter-name>struts2</filter-name>
<filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
<init-param>
    <param-name>packages</param-name>
    <param-value>insert.your.package.with.static.content.here</param-value>
</init-param>
</filter> 
```

我花了很长时间才找到这个，关于这个功能的信息并不多。如果您想阅读这方面的文档，它位于 FilterDispacher 类中的 Struts2 API 中，[此处](http://struts.apache.org/2.0.6/struts2-core/apidocs/index.html?org/apache/struts2/dispatcher/FilterDispatcher.html)显示“提供静态内容”。

希望你会发现它很有用，对我来说这是一个很棒的功能，而且实现得很好。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-15T19:37:26.953

您可以将任何您想要的内容放入 .jar 文件中，它是一个 zip 存档。jar(1) 可以将任何文件放入 jar 中。Ant 的 jar 任务也需要一个文件集。

稍后，您可以使用标准 java api 将这些“资源”作为流访问。

[http://java.sun.com/javase/6/docs/api/java/util/ResourceBundle.html](http://java.sun.com/javase/6/docs/api/java/util/ResourceBundle.html)

# java - 我将如何制作一个高效的键值存储（例如 memcache）/简单的数据库？

> ID：870441
> 
> 赞同：0
> 
> 时间：2009-05-15T19:35:15.477
> 
> 标签：java, c++, database, performance, data-structures

对于我正在处理的一些项目，我需要一个持久的键值存储（类似于 memcache）。理想情况下，它将作为服务器运行；它需要非常有效。我知道 memcachedb 存在，但我想自己编写它，因为稍后我需要包含很多自定义功能。我可能会用 C++（或者如果有充分理由这样做的话，可能会用 C 或 Java）来编写它。

我应该查看数据库实现（B 树、索引等）还是这种工作没有必要？什么是在磁盘上存储大部分内容的好方法，但能够快速访问它，利用内存进行缓存？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T19:46:54.547

我真的很鼓励您重新考虑并使用第三方实现。

如果您想解决很多不属于您的领域的问题，那么下一步是研究数据库实现技术（例如 B+Trees）是正确的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T19:50:26.317

不要重新发明自行车。

您将成为存储的用户。也就是说，您主要关心的是业务逻辑，可能是 UI，而不是数据库功能的细节。把它留给数据库实现者。专注于您的主要任务。

例如，尝试使用 HBase（Google Bigtable 的类似物）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T20:02:53.197

[http://tokyocabinet.sourceforge.net/index.html](http://tokyocabinet.sourceforge.net/index.html)
[http://hadoop.apache.org/hbase/](http://hadoop.apache.org/hbase/)
[http://hypertable.org/](http://hypertable.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T20:08:48.097

有很多键值存储，从久经考验的真正[BDB](http://en.wikipedia.org/wiki/Berkeley_DB)到时尚的[东京内阁](http://sourceforge.net/projects/tokyocabinet/)。如果您必须自己实现，我建议您查看[Varnish](http://varnish.projects.linpro.no/)资源，尤其是[架构](http://varnish.projects.linpro.no/wiki/ArchitectNotes)页面。

# iphone - 告诉我这个 iphone 应用程序是否可以工作

> ID：870452
> 
> 赞同：-1
> 
> 时间：2009-05-15T19:37:34.600
> 
> 标签：iphone, safari

我正在考虑以最简单的方式将 iphone 支持添加到应用程序中。我没有任何为 iphone 编写代码的经验，所以我试图保持它非常简单。这是我目前对应用程序将做什么的概念：

1) 将一些数据从 PC 复制到 iphone - 这可能由 PC 上运行的应用程序通过无线或 USB 发送（以更容易的方式）

2）将数据本地存储在iphone上

3) 在 Safari（或应用程序中的 Web 浏览器控件）中查看数据

最初我希望我们可以让用户手动将 HTML 文件复制到 iphone 以查看，但显然 iphone 上的 Safari 不允许您查看本地文件。:( 是否还有其他我应该注意的上述想法的“陷阱”（例如“您不能在应用程序中嵌入 Web 浏览器控件并让它查看本地文件”），或者这个概念是否有效？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T19:55:00.267

这是一个选择：创建一个使用 UIWebView 的应用程序。您可以从磁盘上的文件中读取数据，还可以使用 javascript 在网络上动态加载其他数据。

优点是您可以通过网络获得最新信息，并在本机应用程序模式（更高效）或使用 UIWebView 中进行一些导航。

# python - SOAPpy - 命名参数列表中的保留字

> ID：870455
> 
> 赞同：3
> 
> 时间：2009-05-15T19:37:54.957
> 
> 标签：python, soap, soappy, reserved-words

我正在使用 SOAPpy 访问 SOAP Web 服务。这个对函数 findPathwaysByText 的调用工作得很好：

```
server.findPathwaysByText (query= 'WP619', species = 'Mus musculus') 
```

但是，对函数 login 的调用不会：

```
server.login (user='amarillion', pass='*****') 
```

因为 pass 是保留字，python 不会运行它。有解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T19:43:14.007

你可以试试：

```
d = {'user':'amarillion', 'pass':'*****' }
server.login(**d) 
```

这在给定的字典中传递，就好像它们是关键字参数（**）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T19:42:09.940

你可以说

```
server.login(user='amarillion', **{'pass': '*****'}) 
```

此处的双星号语法应用关键字参数。这是一个简单的示例，显示了正在发生的事情：

```
def f(a, b):
    return a + b

kwargs = {"a": 5, "b": 6}
return f(**kwargs)        # same as saying f(a=5, b=6) 
```

# c# - string + db table 在gridview中填充值

> ID：870456
> 
> 赞同：0
> 
> 时间：2009-05-15T19:38:27.937
> 
> 标签：c#, string, select

我有一个带有 prodID 的字符串，例如“3、16、12”，是否可以将这些 ID 与数据库中的产品表匹配，并在 gridview 中显示名称、价格等详细信息？

PS：我是 c# 和 asp.net 的新手！

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T19:42:27.817

我可以给你一个简单的 SQL 查询，它会像这样返回你想要的：

```
SELECT name, price FROM [product] WHERE ProdID IN (3,16,12) 
```

但要安全有效地执行此操作，最好知道您拥有什么样的数据库以及该字符串的 id 来自哪里（它是如何构建的）。

* * *

根据您的评论，听起来您正在使用会话（和 ArrayList-ugh。除非您仍在使用 .Net 1.1，否则它们是邪恶的）作为购物车。您想要做的是将其移至数据库。不是将每个购物车项目放入会话中，而是有一个 db 表，并且每次用户选择一个项目时，都会将该项目添加到购物车表中。然后你的 sql 查询将如下所示：

```
SELECT name, price 
FROM [product] 
WHERE ProdID IN 
    SELECT ProdID 
    FROM [ShoppingCart] 
    WHERE CartSession= @CurrentSessionID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T19:56:14.070

使用一些函数将分隔字符串拆分为表格：

[这是一个例子。](http://codebetter.com/blogs/raymond.lewallen/archive/2005/10/26/133774.aspx)

然后使用这样的存储过程：

```
CREATE PROCEDURE GetProductsByDelimitedString 
@myString nvarchar(max)
AS
BEGIN
select * from Products where ID in (select * from SplitFunction(@myString))
END 
```

然后将你的gridview绑定到存储过程的结果：

```
 string myString = "3,6,12";

    SqlConnection conn = GetSqlConnection();
    GridView gvw = GetGridView();
    SqlCommand cmd = new SqlCommand("GetProductsByDelimitedString", conn);

    cmd.CommandType = System.Data.CommandType.StoredProcedure;        
    cmd.Parameters.AddWithValue("@myString", myString);
    try
    {
        conn.Open();
        gvw.DataSource = cmd.ExecuteReader();
        gvw.DataBind();
        conn.Close();
    }
    catch
    {
        // something bad happened
    } 
```

# java - 有没有好的自然语言处理库

> ID：870460
> 
> 赞同：91
> 
> 时间：2009-05-15T19:39:21.927
> 
> 标签：java, nlp

我需要在我当前的模块中实现一些 NLP。我正在寻找一些可以在这里帮助我的好图书馆。我遇到了“LingPipe”，但无法完全了解如何使用它。
基本上，我们需要实现一个功能，应用程序可以破译以简单英语输入的客户指令（交付指令）。例如：

*   明天中午12:00接机
*   要求在 6 月 10 日之后交货
*   请不要在星期三之前发送
*   向订单中再添加 10 个单位的 XYZ

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-16T13:49:30.247

[LingPipe](http://alias-i.com/lingpipe/)非常好并且有据可查。你也可以看看：

*   [开放式自然语言处理](https://opennlp.apache.org/)
*   [斯坦福自然语言处理](http://nlp.stanford.edu/)
*   [阿帕奇 UIMA](http://incubator.apache.org/uima/)
*   [门](http://gate.ac.uk/)
*   [CogComp-NLP](https://github.com/CogComp/cogcomp-nlp)
*   [框架网](http://framenet.icsi.berkeley.edu/)

您可能特别感兴趣最后一个，尽管我不知道是否有任何现成的 Java 实现（而且对于您的问题来说，这可能对您来说太大了:-)

Paul 使用 DSL 的想法可能更容易和更快地实现，并且对您的客户使用起来更可靠。我也建议先调查一下。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-15T21:45:29.877

我认为您是否选择使用 NLP 可能取决于您系统的具体要求。是要求接受自由格式的英语，还是只接受特定的指令集？构建支持用户需要传达的内容的[领域特定语言](http://en.wikipedia.org/wiki/Domain_specific_language)可能比对自由格式文本进行全面的语义分析更容易。

在 Java 领域，Groovy 对[构建 DSL](http://docs.groovy-lang.org/docs/latest/html/documentation/core-domain-specific-languages.html)有一些支持。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-08-09T07:50:49.567

对于其他 JVM 语言，请参阅

*   [Scala](http://www.scala-lang.org/)：[Scala NLP](http://www.scalanlp.org/) - Breeze 和 Epic（相关[spark-project.org](http://spark-project.org)）
*   Clojure：[clojure-opennlp](http://github.com/dakrone/clojure-opennlp)

# sql - 为什么不同的 SQL 结果？

> ID：870468
> 
> 赞同：1
> 
> 时间：2009-05-15T19:41:30.767
> 
> 标签：sql, sql-server-2008, join

为什么以下查询会返回不同的结果集？

```
select count(ml.link_type),mc.conv_string
from MSP_CONVERSIONS mc,MSP_LINKS ml
where ml.PROJ_ID = 4
and mc.STRING_TYPE_ID = 3
and mc.CONV_VALUE *= ml.link_type
group by mc.conv_string

select count(ml.link_type),mc.conv_string
from MSP_CONVERSIONS mc left outer join MSP_LINKS ml on mc.CONV_VALUE = ml.LINK_TYPE
where ml.PROJ_ID = 4
and mc.STRING_TYPE_ID = 3
group by mc.conv_string 
```

第一个查询返回：

> 3 法郎
> 
> 10790 FS
> 
> 0 平方英尺
> 
> 117不锈钢

第二个查询返回：

> 3 法郎
> 
> 10790 FS
> 
> 117不锈钢

这两个查询都是针对 SQL Server 2008 Standard 数据库运行的。我不明白为什么会返回两个不同的结果集？我认为 *= 是 LEFT OUTER JOIN 的简写语法。我已经看了这么久，也许我错过了一些小东西？

谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T19:44:35.690

因为您的第一个查询实际上等同于：

```
select count(ml.link_type),mc.conv_string
from MSP_CONVERSIONS mc
LEFT JOIN MSP_LINKS ml
    ON ml.PROJ_ID = 4
    and mc.STRING_TYPE_ID = 3
    and mc.CONV_VALUE = ml.link_type
group by mc.conv_string 
```

您已将所有条件提取到联接中，因此不可能完全过滤掉`MSP_CONVERSIONS`表中的任何行。最好始终坚持使用完整的 'LEFT/INNER JOIN' 语法并避免混淆。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T19:51:33.987

"*=" 与其说是“速记”语法，不如说是老式的 pre-ANSI OUTER JOIN 语法。不要使用它。此外，一般来说，如果您的选择中有“左外连接 b ...”，那么在 WHERE 子句中的“b”上添加附加条件是一个坏主意——如果它被读作要应用于结果的过滤的连接，然后它将丢弃 b 中没有匹配的所有行——有效地将您的外连接转换为内连接。

这与 Joel 所写的内容有关——在“ON”子句中包含所有条件意味着过滤是在加入时应用的，这是一个不同的结果。ANSI 语法更加明确。

# c++ - 有没有跨平台持续集成的工具（c++ Win32和linux）

> ID：870469
> 
> 赞同：15
> 
> 时间：2009-05-15T19:41:39.143
> 
> 标签：c++, continuous-integration, cross-platform

我查看了关于 SO 的其他几个问题 - 并不确定他们是否回答了这个问题。

我们正在为 Win32 和 Linux 构建 C++ 应用程序。现在我们有一些脚本（win32 的 bat 文件）按计划运行以进行构建。

我们希望为我们的项目提供 CI，但我希望只有一个 CI 服务器来处理在两个平台上的构建。与 SVN 的集成很重要。

是否可以让一个配置/一个 CI 产品/服务器执行此操作？

有没有人成功做到这一点？Bamboo 看起来可以解决我们的需求，但如果我们可以避免成本，我讨厌作为一家自力更生的初创公司投入这样的支出。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-15T19:59:50.567

您可能想去 [Hudson](http://hudson-ci.org/)或[Jenkins 试一试](https://jenkins-ci.org/)。虽然主要用于基于 Java 的项目，但您可以调整它们以满足您的需求。它们与 SVN 顺利集成，而且您可以使用多步构建功能来调用您的（现有）批处理文件，并进一步处理。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-17T23:35:46.487

Buildbot 绝对是一个值得一看的工具 - [http://buildbot.net/trac](http://buildbot.net/trac)。中央服务器监控所有项目并通知代理新任务，因此您可以在您真正需要的任何环境上构建，而无需设置交叉编译环境。

您还可以查看 Cruise Control @ [http://cruisecontrol.sourceforge.net](http://cruisecontrol.sourceforge.net)。虽然它看起来更适合 Java 构建，但您可以用它做很多事情。我有一个设置，可以构建 linux arm 和 i386 二进制文件并将它们打包到 debs 中，并根据构建结果维护一个 debian 存储库 - 在代码上运行 unittests 和各种东西..

但我真正想说的是，基本上，我使用的几乎所有 ci 服务器软件主要只是“任务调度程序”，您仍然需要自己构建/配置构建环境，这至少在多平台场景中是更大的任务配置一个执行构建并从中生成漂亮报告的软件..

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T20:02:54.523

[TeamCity](http://www.jetbrains.com/teamcity/)可以在不同平台上运行构建代理，例如，一个构建代理在 Windows 上，一个在 Linux 上。可以使用配置来指定每个构建转到哪些构建代理。

TeamCity 不是免费的，就像在语音中一样，但是有一个免费的，就像在啤酒中一样，版本（专业版）有一些限制（3 个构建代理，20 个用户，20 个构建配置）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-22T14:57:16.997

我们为此使用[Zed Builds and Bugs](http://www.hericus.com/)，它对我们非常有效。有一个中央服务器，您可以在其中设置构建定义。然后对于完整构建中的每个“步骤”，您可以定义该“步骤”将在哪个服务器上执行。我们有跨平台执行的步骤：Win32、Linux64、Linux32、HP、AIX、Solaris，甚至可以在全球范围内执行远程执行的步骤。

每个步骤都可以设置为并行或串行运行，所以当HP、AIX、Solaris、Linux都在做同样的事情时，它们都可以并行运行，Win32后续会等到一切都完成后继续。

您还可以设置子构建进程，然后从“主”构建启动这些进程，以便您可以创建更复杂的构建线程，这些线程将彼此独立运行，但通过主构建定义捆绑在一起。

它不是免费的，但它为我们（尤其是我）节省的时间已经支付了很多倍的软件成本。

# c# - 如何在 Unity 中使用不同的构造函数注册相同类型两次？

> ID：870470
> 
> 赞同：3
> 
> 时间：2009-05-15T19:41:47.287
> 
> 标签：c#, unity-container, ioc-container

我正在尝试使用两个不同的构造函数注册相同的类型。当我试图解决时，我在第二个 Resolve 上得到“Resolve *of the dependency failed ”。*

```
 var container = new UnityContainer();

    container.RegisterType<IBar, Bar>()
        .RegisterInstance(new Bar())
        .RegisterType<IBar, Bar>()
        .RegisterInstance(new Bar("foo"));

    Bar bar1 = (Bar)container.Resolve<IBar>();
    Bar bar2 = (Bar)container.Resolve<IBar>("foo");  // ERROR 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T19:44:55.783

你需要在注册时给他们名字。参数 to`Resolve`是您想要的实例的名称。

```
var container = new UnityContainer();

container
    .RegisterInstance<IBar>("BAR", new Bar())
    .RegisterInstance<IBar>("FOOBAR", new Bar("foo"));

Bar bar1 = (Bar)container.Resolve<IBar>("BAR");
Bar bar2 = (Bar)container.Resolve<IBar>("FOOBAR"); 
```

# java - 损坏的 Java Swing 窗口

> ID：870472
> 
> 赞同：5
> 
> 时间：2009-05-15T19:42:05.320
> 
> 标签：java, windows, swing

我编写的 Java swing GUI 程序的一位用户遇到了一个问题，即主 Swing 窗口无法正确呈现到屏幕上并且 GUI 冻结。这是他屏幕上的屏幕截图（顶部）和应该显示的内容（底部）的比较：

[替代文字 http://www.shapecollage.com/temp/SwingCorruption.jpg](http://www.shapecollage.com/temp/SwingCorruption.jpg)

他正在运行带有 Java 1.6.0_13 的 Windows XP SP3，他的显卡是带有双显示器设置的 ATI X1600。

该程序（如果您想自己测试）位于：
[www.shapecollage.com/download.html](http://www.shapecollage.com/download.html)

我有几千个用户，没有其他人报告过这个错误，我已经在 Windows XP 上对其进行了彻底的测试。任何计算都是在与常规 GUI 线程不同的线程中完成的，并且该程序可以在许多其他计算机上运行，​​所以我认为这不是程序本身的问题，而是他的特定设置有问题。

有没有人在系统上看到过这种类型的错误，或者对这个用户的系统上可能会导致这种问题的错误有任何建议？

谢谢，
文森特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T09:04:26.827

也许 Java 与图形驱动程序和/或图形硬件之间的交互存在问题。

有[几个标志可以影响 Java 如何绘制到屏幕上](http://java.sun.com/j2se/1.5.0/docs/guide/2d/flags.html)。

您可能想尝试使用以下任何标志启动应用程序：

*   `-Dsun.java2d.opengl=true`
*   `-Dsun.java2d.d3d=false`
*   `-Dsun.java2d.noddraw=true`

这些标志分别切换 OpenGL 管道、使用 Direct3D 和禁用 DirectDraw。

如果其中任何一个解决了您的问题，那么您可能会考虑向 sun 提交错误，因为这可能不是应用程序的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T09:12:15.403

我们有一个非常相似的问题，通过更新图形驱动程序解决了这个问题。问题可能来自导致 VRAM 损坏的双显示器设置，因此您的客户可能会尝试仅使用单个显示器是否能更好地工作。虽然您可能期望 Java 不会非常依赖硬件，但我们的图形密集型应用程序在通过特定类型的投影仪运行时总是会出现蓝屏死机......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:05:02.067

我还没有看到特定类型的损坏图形，但我已经看到 Windows 上的 Java 图形问题在扩展显示控制面板中的硬件加速降低时消失了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T04:51:51.367

I have seen corrupted graphics like that, but never in java. The places i've seen it were in windows draw/etc code, and the tiling and snow look generally indicated something like telling the image draw code that you were going to draw an image of a certain size and bit depth, but then filling the image buffer with a different bit depth. like filling the byte array with data from an integer RGBA source and putting it into an integer RGB destination?

but from the screen shot, the user looks like they're also running some other kind of app too, as there's an extra button by the minimize/maximize/close buttons, so some other third party application is modifying the window. Maybe that's messing with it?

Otherwise i'd say driver issue. There's always some solutions like disabling d3d drawing or some other draw optimizations that the VM does automatically now, maybe that solves it?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T19:45:33.317

Swing 不是线程安全的，因此如果您在 GUI 线程以外的任何地方进行渲染，您可能会遇到这种情况。

# c++ - 从 C++ 程序刻录 CD/DVD

> ID：870474
> 
> 赞同：5
> 
> 时间：2009-05-15T19:42:18.707
> 
> 标签：c++

我需要从我的 C++ 程序中刻录 CD/DVD 磁盘。你能给我推荐一个方法吗？

编辑：平台是 Windows。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T19:47:19.427

在 Windows 上，我之前使用过 IMAPI2 接口非常成功。 [该](http://www.codeproject.com/KB/winsdk/IMAPI2.aspx)站点为此提供了一组非常好的示例代码。您可能需要为您的实现大量修改代码，但它可以工作，并且运行良好。

关于 IMAPI2 接口的一件事；如果您要写入 DVD，那么您几乎需要使用它，因为 IMAPI 接口的先前迭代对写入 DVD 的处理不一致。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T19:43:34.163

为什么不调用 cdrecord 或 growisofs 或任何控制台实用程序？

这很简单，不需要任何东西，只需将那个小的可执行文件拖到你身边。他们也知道工作得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T19:45:12.460

在 Windows 上，您可以使用“Image Mastering API”。

[在这里](http://msdn.microsoft.com/en-us/library/aa366450(VS.85).aspx)查看

# ajax - 渲染的PNG的AJAX加载不起作用

> ID：870479
> 
> 赞同：0
> 
> 时间：2009-05-15T19:42:45.537
> 
> 标签：ajax, image-processing, png, gd

我正在使用自定义 php 脚本和 GD 库基于 POST 中的一些默认值和参数呈现自定义图像。

我正在尝试构建一个自定义表单以允许用户选择这些参数，然后发送 AJAX 请求以呈现图像并将其发送回并在页面中加载预览。

问题是第一个预览有效，但之后我无法加载更多预览。我只是在预览窗口中看到相同的图像。但是，我正在将图像写入磁盘并且更新得很好，所以我认为这是一些 apache 或浏览器缓存。这是一些代码：

AJAX 请求就像

```
preview = new Image;
preview.src = url;
$(preview).load(preview.src, imagedata, function() {                                               
   $('#gaga-preview-space').html(this);                                                             
}); 
```

其中 imagedata 是一个带有 bgcolor 等的数组。我还为每个请求生成一个时间戳，希望它能够阻止 apache 缓存响应。这在其他情况下也有效，但不是这个。

php 生成脚本如下所示：

```
// Save file
$file = "/var/www/tribegaga/sites/all/files/gaga_customization/test.png";
$result = imagepng($image, $file);

// Spit out file
header("Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0");
header("Pragma: no-cache");
header("Content-Type: image/png");
imagepng($image);

imagedestroy($image); 
```

你会看到我发送了一些标题，但这些也不是问题。

也许我认为它正在缓存，所以我走错了路。但正如我所提到的，生成的 .png 效果很好。

**更新：**好的，问题是浏览器没有发布获取图像，而是获取，所以现在我的脚本发送了一个 GET 字符串，这一切都很好。但我宁愿没有图像 src= [http://site/script.php?string=params&test=foo](http://site/script.php?string=params&test=foo)等。

如果大家有任何建议，我将不胜感激。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T19:45:45.890

您也可以尝试设置 Expires（到过去的日期）和 Last-Modified（到当前的日期/时间）标题。

# windows - Mercurial Web 界面断开的链接

> ID：870486
> 
> 赞同：0
> 
> 时间：2009-05-15T19:43:31.293
> 
> 标签：windows, iis, mercurial

我正在 W2K IIS 6 服务器上安装 mercurial。

[我已经到了可以在http://localhost/hgrepo/hgwebdir.py](http://localhost/hgrepo/hgwebdir.py)浏览我的存储库列表的地步。我的 hgweb.config 包含 [path]hgrepo = c:\hgrepositories**

但是当我单击其中一个存储库名称时。在这种情况下，它的 Babbet，我得到了相同的页面，但是当我检查地址时，我看到了这个：

[http://localhost/hgrepo/hgwebdir.py/hgrepo/hgwebdir.py/Babbet/](http://localhost/hgrepo/hgwebdir.py/hgrepo/hgwebdir.py/Babbet/)

如果我再次单击存储库列表页面，我会得到

[http://localhost/hgrepo/hgwebdir.py/hgrepo/hgwebdir.py/hgrepo/hgwebdir.py/Babbet/Babbet/](http://localhost/hgrepo/hgwebdir.py/hgrepo/hgwebdir.py/hgrepo/hgwebdir.py/Babbet/Babbet/)

有我必须设置的配置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T01:21:18.500

谷歌“Mercurial IIS 补丁”

我重新编译了 mercurial 源代码，并已成功将其安装在带有 IIS7 的 Windows 2008 上。

# sql - 带条件的 SQL 案例

> ID：870489
> 
> 赞同：1
> 
> 时间：2009-05-15T19:43:40.497
> 
> 标签：sql, sql-server

我有一个查询设置，其中包含一个 CASE 语句，该语句在 95% 的时间都有效……另外 5% 是由于数据不存在。还有其他数据表明指针会有所帮助......我只知道这是否可能......

所以： CASE PRDE.STATUSCODE 当 'A' THEN 'Appealed' WHEN 'D' THEN 'Dismissed' WHEN 'P' THEN 'Pending' WHEN 'S' THEN 'Satisfied' WHEN 'T' THEN 'Settled' 作为状态结束

有时该字段是 '' 但可能填充了一个名为 SATISFIEDDATE 的文本字段...我可以在这里写一些类似的内容：CASE '' THEN [if SATISFIEDDATE <> '' then 'Satisfied']

对不起，如果这太简单了...... :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T19:56:29.407

```
CASE
    WHEN PRDE.STATUSCODE='A' THEN 'Appealed'
    WHEN PRDE.STATUSCODE='D' THEN 'Dismissed'
    WHEN PRDE.STATUSCODE='P' THEN 'Pending'
    WHEN PRDE.STATUSCODE='S' OR (PRDE.STATUSCODE='' AND LEN(SatisfiedDate)>0) THEN 'Satisfied'
    WHEN PRDE.STATUSCODE='T' THEN 'Settled'
    ELSE '?null/unknown?'
END AS STATUS 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T19:46:27.667

您可以有另一个 CASE 语句：

```
CASE '' THEN CASE WHEN SatisfiedDate != '' THEN 'Satisfied' END 
```

另一种选择是这样的：

```
CASE
    WHEN PRDE.STATUSCODE = 'A' THEN 'Appealed'
    WHEN PRDE.STATUSCODE = 'D' THEN 'Dismissed'
    WHEN PRDE.STATUSCODE = 'P' THEN 'Pending'
    WHEN PRDE.STATUSCODE = 'S'
       OR (PRDE.STATUSCODE = '' AND SatisfiedDate != '') THEN 'Satisfied'
    WHEN PRDE.STATUSCODE = 'T' THEN 'Settled'
END AS STATUS 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T22:22:30.413

也许这就是你要找的：

```
CASE PRDE.STATUSCODE 
WHEN 'A' THEN 'Appealed' 
WHEN 'D' THEN 'Dismissed' 
WHEN 'P' THEN 'Pending' 
WHEN 'S' THEN 'Satisfied' 
WHEN 'T' THEN 'Settled' 
WHEN '' AND NULLIF(PRDE.SATISFIEDDATE, '') IS NOT NULL THEN 'Satisfied' END AS STATUS 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T19:49:54.960

您可以使用 ELSE

```
ELSE else_result_expression 
```

在 else_result_expression 你可以放任何你想要的合法表达，包括你写的。

[http://www.databasejournal.com/features/mssql/article.php/3288921/T-SQL-Programming-Part-5---Using-the-CASE-Function.htm](http://www.databasejournal.com/features/mssql/article.php/3288921/T-SQL-Programming-Part-5---Using-the-CASE-Function.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T19:59:42.940

您可以在 else 子句或 when 子句中执行 nexted case 语句

```
CASE PRDE.STATUSCODE 
    WHEN 'A' THEN 'Appealed' 
    WHEN 'D' THEN 'Dismissed' 
    WHEN 'P' THEN 'Pending' 
    WHEN 'S' THEN 'Satisfied' 
    WHEN 'T' THEN 'Settled' 
    else
        case 
            when SATISFIEDDATE is not null then 'Satisfied'
        end
END AS STATUS 
```

# javascript - 您是否希望 Javascript 在浏览器之外得到广泛使用？

> ID：870500
> 
> 赞同：5
> 
> 时间：2009-05-15T19:45:25.860
> 
> 标签：javascript, programming-languages

凭借您在今天的浏览器中可以做到的所有魔力，我想知道 Javascript 是否会在服务器端变得更加突出，或者作为应用程序编程的可行替代方案。我问这个是因为我已经研究了许多编程语言，除了 Javascript。也许是时候深入研究它了，在每个人都想要之前，我仍然一无所知。

因此，您认为 Javascript 会变得更大吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T19:48:28.957

它已经被广泛用作脚本语言。我听说photoshop是用它编写的。此外，flash 的动作脚本是 javascript。

这是一种很酷的小语言，正是您在这些情况下想要的那种。人们到处都在使用它——例如，我听说它在呼叫中心软件中使用过。

它在服务器编程中也很有用。我们正在等待 Steve Yegge 的 Rhino on Rails。

如果您使用 couchdb、rhino 中的 webapp、浏览器中的 javascript 和基于 e4x 的模板引擎，您将获得纯 javascript 中的 webapp 堆栈，这很有趣！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T19:47:10.877

它已经比您想象的要大，因为 ActionScript 非常基于 JavaScript 并且被大量开发人员使用。

就个人而言，我敢打赌 JavaScript 会在未来的框架中得到越来越广泛的采用，这样 Web 开发人员就可以轻松地适应新环境；尤其是希望通过云交付应用程序的框架......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T03:43:16.710

I am willing to guarantee that it will. I know of 2 projects in the works now that aim to create a compiled server side javascript that would replace PhP, JSP, etc.

The whole "is it good or bad" argument is entirely subjective and I think it's foolish to engage in it. I can tell you however, that if you examine the actual functionality of the language you will see that it is much more powerful than things like C++ and Java. Your program can morph at run time, creating its own additional classes, methods, etc. ON THE FLY!!! No one uses it this way because most javascript programmers are people that came to it from web development and really need it to make things roll-over or to verify form data. But that fact notwithstanding, it is running in more places now than any other language (just think about how many people pull open their web browsers each day and how 99% of the pages they visit utilize it!). No tool that is THAT diverse can be unexamined for long. It definitely needs some retooling, but it's unavoidable and it will absolutely not be going away anytime soon.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-15T20:26:43.170

我觉得很高兴想象另一种历史，服务器端 javascript（[在 1996 年在 NAS 中实现](http://en.wikipedia.org/wiki/Server-side_JavaScript)）成为主要的服务器端语言而不是 PHP。Javascript 是一种非常[强大且富有表现力](http://www.hunlock.com/blogs/Functional_Javascript)的语言，能够在客户端和服务器端都使用它将为 web 开发人员打开很多选择，让他们更快乐、更高效。

Javascript 是否*会*得到更广泛的应用，我不知道。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T19:50:27.390

是的，我认为会的。

越来越多的人在客户端用 JavaScript 开发应用程序，它在服务器端的使用也在增长，像[Aptana Jaxer](http://www.aptana.com/jaxer)这样的技术让人们在服务器端使用相同的技能和技术。

[像jQuery](http://jquery.com/)这样的JavaScript 库正在帮助 JavaScript 摆脱它的“玩具”形象，人们越来越重视它作为一流的开发语言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T19:51:24.300

当前大众市场 Javascript 的趋势似乎是向库（jquery、prototype 等）发展。将可靠的代码打包成一个更有用和更友好的框架可能会增加该语言的使用范围。虽然所有当前的库都是为了在浏览器中使用，但可以想象它们可以扩展到浏览器之外。然而，在 Web 开发之外，Javascript 通常被认为是一种有点丑陋和 hackish 的语言，所以我认为它不会被允许超越其浏览器沙箱并与 C++、Java、Python 等竞争。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T19:52:28.900

简短的回答：不是。

长答案：Javascript 缺少很多功能，即使是脚本语言也是如此。它的主要流行来自于它与服务器异步交互的能力，允许像 Stackoverflow 或 Facebook 这样的网站神奇地更新内容而无需刷新。

然而，它速度很慢，并且缺乏一些特性，使得它可以在浏览器之外进行应用程序编程。虽然基于浏览器的应用程序肯定会激增（很大的优势，因为它们本质上很容易部署，并且如果操作正确，则完全独立于操作系统）。

要考虑的另一件事是，使 javascript 流行的大多数因素都源于其对基于浏览器的脚本的垄断。它的大部分用途已经以 JQuery 和 Prototype 和 Dojo 的形式出现。

如果您打算进入基于浏览器的软件领域，您仍然需要学习使它们成为可能的后端语言，并且以后添加 Javascript 应该很容易（如果您一直遵循您的标准）。Google Web Toolkit甚至为您将前端 Java 编译成 Javascript，因此您甚至不必担心。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T21:39:35.680

值得一提的是：自 1998 年以来，我几乎所有的服务器端编程都是用 javascript 编写的。它做了并且做了我一直想要的一切。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-15T21:46:43.477

作为一种免费且流行的脚本语言，它可以在多个应用程序中使用。

例如，游戏开发工具 Unity3D 将 JavaScript 作为其脚本语言之一。大多数示例、教程和代码解决方案都是用 JavaScript 编写的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-09T07:20:04.717

我认为 javascript 将再次在服务器上大放异彩。人们为后端和前端学习单一语言有太多优势。所有 javascript 都缺少一些 IO 和网络原语（目前可以使用扩展来获得），以及对并行性的一些支持（但这可能需要很长时间才能实现，唉）。我预测，最多在几年内，我们将拥有与我们今天（2009 年 12 月 8 日）对于 python 应用程序服务器一样多的 javascript 应用程序服务器选项。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-15T22:06:45.160

我认为 Python 和 Ruby 正在成为浏览器之外的大型动态语言。浏览器之外的 JS 已经有一段时间了（经典的 ASP 可以用 JScript 编写）并且它仍在增长一点（参见其他帖子中的 Jaxer、Rhino 等）......但我认为它现在已经流行起来了如果它会。

JSON 已经很受欢迎——即使是数据持久性（如在[CouchDB](http://couchdb.apache.org/)中），但我猜像 YAML 之类的东西将取代 JSON，因为 JSON 正在取代取代 CSV 的 XML ......

变化越多...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-16T03:10:01.983

安捷伦有一些非常好的（制药级）实验室测试设备，可以通过 JavaScript 编写脚本。管理/调度软件是基于 Windows 的，但运行带有一些附加文件访问功能的 JavaScript VM。值得一提的是，最初开发这些东西的公司 Velocity 11 充满了年轻的工程师和程序员，并且似乎在过去几年中完成了大部分开发工作。

带我参加设备配置培训的现场工程师在六个月前刚刚学习了 JavaScript，能够毫不费力地设置我们的测试方法。哦，对于像我这样的 UNIX 人来说，能够使用 TextPad 编辑脚本而不必使用 Visual Studio 或交互式调试器或其他任何东西，这真是太好了。只是一个 *.js 文件的目录，我们走吧！

因此，要回答这个问题，我不确定 JavaScript 是否会在浏览器之外流行起来，但它肯定会在至少一个领域得到有效使用，在这些领域，通常需要一种更成熟的脚本语言，如 VB。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-15T19:47:23.950

我认为这种方式可能具有学术兴趣，但我不认为 Javascript 会成为应用程序编程的可行替代方案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-15T19:48:12.263

好吧，WebOS 将大量使用 Js 进行开发。至于在其他地方扩展……我不知道，Javascript 有很多我喜欢的特性，但没有什么是你在众多其他语言中找不到的。尽管性能有所提高，但它在很多领域仍然无法击败 C/C++/甚至 Java。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-15T19:48:34.510

两份工作前，我的任务是用 javascript 编写一个 HTTP 蜘蛛。说来话长。

你可以在 javascript 中做很多事情。同样，通过 php 解释器在 Web 服务器外部使用 php，您可能在服务器外部的 php 中可以做很多事情。

但是这两种情况都会发生吗？我的猜测是“不”，但我没有比其他人更清晰的水晶球。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-15T19:51:04.487

在浏览器中——是的，因为它是实际的标准，而且 Web 应用程序越受欢迎，JavaScript 就越会成为一种“真正的”语言。

外部浏览器——我不这么认为。就是不行 ：）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-15T20:11:48.293

之前使用过 Javascript，现在工作中需要处理 JavaScript、jQuery 和 ExtJS，我只能说：

除非我别无选择，否则我永远不会使用 Javascript/EcmaScript 作为嵌入式脚本语言**。**

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-15T21:50:49.600

如果您现在想在 ASP.NET 中使用 JScript.NET，您可以使用它，它可以访问所有 .NET 库。回到过去的经典 asp 时代，您还可以用 javascript 编写您的 asp 脚本。

您甚至可以使用它编写应用程序并使用 jsc 编译器将其编译为普通的 .net 应用程序。

所以我想答案是，它已经是了。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-15T21:58:06.400

是的，因为它是一个[可怕的黑客](http://www.jslint.com/lint.html)，如果[计算的历史](http://en.wikipedia.org/wiki/Orphaned_Technology)告诉我们什么，那就是可怕的黑客[无限](http://msdn.microsoft.com/en-us/vbasic/default.aspx)增长。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2009-05-15T19:55:14.557

没想到...但是当我拿到很多ActionScript书籍时，我发现语言是ECMAScript，基本上是Javascript。

# php - PHP 中类似 Ruby 的数组参数实现

> ID：870501
> 
> 赞同：1
> 
> 时间：2009-05-15T19:45:30.243
> 
> 标签：php, json, ruby, language-comparisons

我主要用 PHP 和 Ruby 编程，有时我碰巧需要一种方法来将这些“散列参数”实现到我的 PHP 函数中（比如，一个 HTML 选择助手）

```
draw_select :name => :id, :onclick => 'alert(this.value)' 
```

PHP 中的问题是我必须定义一个参数顺序来实现许多可能的属性。

我一直在考虑只定义 1 个字符串参数并使用 json_decode() 所以我可以传递这样的参数：

```
draw_select("'name': 'id', 'onclick': 'alert(this.value)' ") 
```

定义如下：

```
function draw_select($string) {
// use json_decode here and pass them as variables
} 
```

你知道一个更聪明的方法来做到这一点..或者你认为在 PHP 中尝试这样做实际上有任何意义吗？

**编辑添加：我正在寻找一种“替代”替代方案，以仅将信号数组作为参数传递，例如 function(array(...))**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T19:47:42.857

为什么不传递一个数组呢？

```
draw_select(array(
  'name'=> 'id', 
  'onclick'=> 'alert(this.value)'
)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T19:47:40.223

PHP 在这方面肯定缺乏一些糖。我也做了很多 Python，在使用 PHP 时我非常想念命名参数。然而，对于 PHP，每当我有一个需要接受多个选项的函数时，我只需接受一个或两个必需/重要的参数，其余的接受一个数组：

```
function draw_select($name, $options = array(), $html_options = array()) {

} 
```

这就是 CodeIgniter 和 CakePHP 等库处理相同`<select>`场景的方式。

就个人而言，当 PHP 的关联数组如此强大时，在这种情况下使用 JSON 并没有带来真正的好处。只要坚持语言给你的东西，这就是使用 PHP 的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T01:02:47.110

在PHP 5.3 之前（包括 PHP 5.3）的任何版本中，没有一种方法可以做到这 ^(一点)。

PHP 不支持命名参数和/或 smalltalk/objective-c/ruby 样式选择器。PHP 也没有提供重新定义这部分语言的方法。如果你想在 PHP 中使用它，那你就不走运了。PHP 从来都不是所谓的“元编程”的最佳语言选择。

正如其他人所提到的，使用 PHP 的最佳选择是结合使用带有键/值对的数组和提取。

```
myFunction(array(
    'theThing'=>0,
    'param2'=>'another value',
));

function myFunction($params){
    extract($params);
    echo $param2;
} 
```

1.  您可能可以在 C/C++ 上编写一个扩展来使用这种能力扩展 PHP，但您将成为一个受虐狂。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T19:58:13.193

由于这里的所有选项都涉及调用`array`，而且它似乎是“PHPish”的做事方式，如果你一直这样做，我会说，也许拥有一个函数是有意义的`z()`（我是只是按照`$()`jQuery 中的思路思考）别名为`array()`. 除了名称数组的长度之外，我看不出 Ruby 版本有多优雅。字符较少，但我有点**不喜欢**在该示例代码中您无法立即区分函数参数和键/值对之间的区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T20:13:26.383

一种解决方案是使用可变参数。

我有时将它与本机不支持关联数组的语言一起使用。

```
function AssociativeArrayFromFlatArray($args)
{
    $nbArgs = count($args);
    if( $nbArgs % 2 != 0 )
    {
        die('This function must have an even number of arguments');
    }

    $ret = array();
    for( $i = 0; $i < $nbArgs; $i += 2 )
    {
        $key = $args[$i];
        $value = $args[$i + 1];
        $ret[$key] = $value;
    }
    return $ret;
}

function DoSomething(/*...*/)
{
    $args = AssociativeArrayFromFlatArray(func_get_args());

    if( $args['action'] == 'greet' )
    {
        $count = $args['count'] or 1;
        for( $i = 0; $i < $count; $i += 1 )
        {
            echo $args['text'];
        }
    }
}

DoSomething('action', 'greet', 'count', 10, 'text', 'Hello World! '); 
```

尽管将其用于 PHP 是一种耻辱，因为它本机支持关联数组...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-18T03:26:03.237

您可以使用 ' `func_get_args()`' 函数，只需将每个第一个参数用作 var 名称，将每秒用作值。它可能与您接近 ruby​​ 方式一样接近（我一直在寻找一种方法来实现它，我完全理解您对 ruby​​ 对数组的优雅解决方案的意思）。希望将来 PHP 可以像 ruby​​ 一样在执行时打开它的自我重新编程（不知道实际叫什么，但正是它使 ruby​​ 和 ruby​​ on rails 如此出色）。

# javascript - 将 csv 文件加载到 javascript 文件中

> ID：870505
> 
> 赞同：0
> 
> 时间：2009-05-15T19:46:00.960
> 
> 标签：javascript

这可能吗 ？我想从 csv 文件中提取产品的价格，并将该价格与其特定的零件号联系起来。

我正在为一个网站做这个，同时我正在学习脚本编程，我不确定如何做到这一点。

JS 文件将调用 csv 文件并从中提取价格和部件号。

从那里，JS 文件将创建一个用于 Paypal 购物车的表单。

这是添加到购物车按钮的贝宝购物车代码：

```
<form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_cart">
<input type="hidden" name="business" value="XXXXX">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="PartNumber1">
<input type="hidden" name="amount" >
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="button_subtype" value="products">
<input type="hidden" name="cn" value="Add special instructions to the seller">
<input type="hidden" name="no_shipping" value="2">
<input type="hidden" name="weight" value=".5">
<input type="hidden" name="weight_unit" value="lbs">
<input type="hidden" name="add" value="1">
<input type="hidden" name="bn" value="PP-ShopCartBF:btn_cart_LG.gif:NonHosted">
<input type="image" src="https://www.paypal.com/en_US/i/btn/btn_cart_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> 
```

使用我添加到此按钮的变量，JS 文件将如下所示：

```
function CalculateOrder(form)
{

if (form.item_name.value == "PartNumber1"
{
form.amount.value = (The price variable would go here);
}

if (form.item_name.value == "PartNumber2"
{
form.amount.value = (The price variable would go here);
}
} 
```

在 JS 文件中的这段代码之前，我需要的是加载 csv 文件并输出价格和零件号的代码。JS 文件将搜索标记为“PartNumber1”的零件编号，并从 csv 文件中输出适当的价格。

请帮忙 ！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T07:43:57.037

这是可能的，但很可能更多的麻烦是值得的。

首先，您必须获取 CSV 数据。这很容易，只要它与站点位于同一服务器上 - XMLHttpRequest 是您的朋友。您可以从 responseText 中获取原始 CSV。

然后你需要解析它。

如果您有一个非常简单的 CSV 文件，那么您可以先拆分新行（获取每一行），然后拆分逗号（获取每一列）。

如果没有测试，这样的事情可能会奏效：

```
var csv = myXHR.responseText;
var rows = csv.split("\n");
for (var i = 0; i < rows.length; i++) {
  rows[i] = rows[i].split(",");
} 
```

然后，您可以通过以下方式查找您想要的部件号：

```
var getPart = function getPart(partNumber) {
  for (var i = 0, j < rows.length; i < j; i++) {
    if (row[i][partNumberColumnIndex] === partNumber) {
      return row[i];
    } 
  }
}; 
```

但是，**CSV 并不像最初看起来那样简单**。

如果任何数据中包含逗号或换行符，那么您不能简单地拆分这些字符，因为您必须注意引号字符。

如果我有我真正想在客户端处理的 CSV 数据，那么我会使用[Text::CSV](http://search.cpan.org/~makamaka/Text-CSV-1.12/lib/Text/CSV.pm)和[JSON::Any](http://search.cpan.org/~perigrin/JSON-Any-1.19/lib/JSON/Any.pm)将其转换为 JavaScript 可以本地解析的格式，然后再将其发送到客户端。

对于这个特定的任务，我可能会完全忘记在客户端做这件事，而只是在服务器上做所有事情。我看不出将这项工作推给客户有多大好处。（虽然，诚然，我不知道所有的细节）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T21:29:11.600

前段时间我写了一个[脚本，它下载一个 CSV 并绘制点](http://maps.natalian.org/mymap.js)。也许这对您来说是一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-22T08:16:59.630

如果您需要一个支持 CSV RFC 更复杂部分的 JavaScript CSV 解析器，您可能想看看[我的解析器实现](https://github.com/thorbenziemek/csv.js)——但请注意，它只是第一个版本，还需要稍微清理一下。

# ruby - 确定变量是否在范围内？

> ID：870507
> 
> 赞同：142
> 
> 时间：2009-05-15T19:46:18.867
> 
> 标签：ruby, integer, conditional, range

我需要编写一个循环来执行以下操作：

```
if i (1..10)
  do thing 1
elsif i (11..20)
  do thing 2
elsif i (21..30)
  do thing 3
etc... 
```

但到目前为止，在语法方面已经走错了路。

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2010-08-17T19:01:21.377

```
如果 i.between?(1, 10)
  做一件事
elsif i.between?(11,20)
  做事2
...

```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2009-05-15T19:52:18.977

使用`===`运算符（或其同义词`include?`）

```
if (1..10) === i 
```

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2009-05-15T19:55:16.287

正如@Baldu 所说，使用 === 运算符或内部使用 === 的用例/何时：

```
case i
when 1..10
  # do thing 1
when 11..20
  # do thing 2
when 21..30
  # do thing 3
etc... 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2009-05-15T19:54:45.477

如果您仍想使用范围...

```
def foo(x)
 if (1..10).include?(x)
   puts "1 to 10"
 elsif (11..20).include?(x)
   puts "11 to 20"
 end
end 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-05-28T21:15:03.803

您通常可以通过以下方式获得更好的性能：

```
if i >= 21
  # do thing 3
elsif i >= 11
  # do thing 2
elsif i >= 1
  # do thing 1 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-08-28T15:54:25.387

你可以使用
`if (1..10).cover? i then thing_1 elsif (11..20).cover? i then thing_2`

并且根据[Fast Ruby](https://github.com/JuanitoFatas/fast-ruby#cover-vs-include-code)中的这个基准测试，它比`include?`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-11-09T14:05:55.313

不是问题的直接答案，但如果您想要与“内部”相反：

```
(2..5).exclude?(7) 
```

> 真的

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-05-19T00:43:02.830

如果您需要最快的方法来做到这一点，请使用旧的比较。

```
require 'benchmark'

i = 5
puts Benchmark.measure { 10000000.times {(1..10).include?(i)} }
puts Benchmark.measure { 10000000.times {i.between?(1, 10)}   }
puts Benchmark.measure { 10000000.times {1 <= i && i <= 10}   } 
```

在我的系统上打印：

```
0.959171   0.000728   0.959899 (  0.960447)
0.919812   0.001003   0.920815 (  0.921089)
0.340307   0.000000   0.340307 (  0.340358) 
```

如您所见，双重比较几乎比or方法**快 3 倍**！`#include?``#between?`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-16T04:58:29.960

A more dynamic answer, which can be built in Ruby:

```
def select_f_from(collection, point) 
  collection.each do |cutoff, f|
    if point <= cutoff
      return f
    end
  end
  return nil
end

def foo(x)
  collection = [ [ 0, nil ],
                 [ 10, lambda { puts "doing thing 1"} ],
                 [ 20, lambda { puts "doing thing 2"} ],
                 [ 30, lambda { puts "doing thing 3"} ],
                 [ 40, nil ] ]

  f = select_f_from(collection, x)
  f.call if f
end 
```

So, in this case, the "ranges" are really just fenced in with nils in order to catch the boundary conditions.

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2012-12-14T11:39:28.317

对于字符串：

```
(["GRACE", "WEEKLY", "DAILY5"]).include?("GRACE") 
```

#=>真

# python - 您为 python 推荐哪种构建工具？

> ID：870516
> 
> 赞同：35
> 
> 时间：2009-05-15T19:47:29.303
> 
> 标签：python, unit-testing, tdd, build-automation, pyinstaller

我正在开始一个中小型 python 项目，可能在测试驱动开发中。我的 C 和 java 的背景比 python 更多（我使用了 ant 和 makefile）

我知道在 python 中你可能不需要构建工具，但我会，因为我将使用 cython 和 PyInstaller（这个东西应该可以在几个不同的 UNIX 上工作，而不直接依赖于 python），我想要方便从 CLI 中选择测试、构建文档、检查依赖项等。

[有人](http://blog.ianbicking.org/pythons-makefile.html)抱怨 python 缺少类似 make 的工具。我知道很少有工具存在，比如[scon](http://www.scons.org/)和[paver](http://www.blueskyonmars.com/projects/paver/)，但我想听听真实用户的意见，而不仅仅是他们的网站。有人用[摊铺机](http://www.blueskyonmars.com/projects/paver/)吗？

许多软件包附带的通常 setup.py 是怎么回事？我查了一些，看看有没有共同的用法，但我没有发现任何有趣的东西（可能我用错了例子）

您是否建议至少在开始时坚持使用我已经知道的东西（ant 和 Makefile）？如果是这样，您是否为 python (+cython+pyinstaller+pyUnit) 推荐了任何 ant 扩展？

* * *

编辑：为了避免像 jwp 这样的进一步答案，请注意，对于这个项目，我绝对需要我的程序是一个独立的可执行文件，因为在可执行文件将运行的目标平台上绝对*不可能有一个 python VM。*我有完全相同的硬件可用于编译，所以幸运的是我不需要交叉编译（但我会在更友好的 Linux 上进行开发）。

我还想测试我的代码是否从一开始就在 Cython 中编译，不是为了过早优化，而是为了确保我不会在使用不兼容的功能方面走得太远，如果 Cython 需要进行痛苦的重构将是非常需要的。

所以请专注于我的实际问题

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-15T20:26:28.617

如果可能的话，我建议**在开始时**避免扩展模块（C/cython） 。使用 Python 编写所有代码，使用基于简单[`distutils`](http://www.python.org/doc/current/distutils/index.html)的配置，使用`-m`(`python -m mypkg.test.testall`或其他； import [`unittest`](http://www.python.org/doc/current/library/unittest.html)) 运行测试。

一旦你让你的项目进入一个舒适的状态，然后开始使用 cython 和随之而来的额外项目管理来解决一些优化问题。distutils 可以构建扩展模块，所以我不确定你是否需要 make/scons ..

```
 project-dir/
  setup.py
  mypkg/
   __init__.py
   mymod.py
   test/
    __init__.py
    testall.py
    testsomething_specific.py 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-16T11:49:28.490

根据他们的网站，您的要求表明[Scons比](http://www.scons.org/)[Paver](http://www.blueskyonmars.com/projects/paver/)更能控制各种建筑任务。在后者中，您最终会使用很多`sh()`运行常规命令行程序的程序。

最近，我开始使用[Paver](http://www.blueskyonmars.com/projects/paver/)，它非常适合运行测试、使用[Sphinx](http://sphinx.pocoo.org/)构建文档，但我只使用纯 Python。如果您想了解 Paver 的功能，我强烈推荐这两篇文章： Doug Hellmann[的从制造到摊铺机的转换](http://doughellmann.com/2009/01/18/converting-from-make-to-paver.html)和[编写技术文档](http://doughellmann.com/2009/02/02/writing-technical-documentation-with-sphinx-paver-and-cog.html)，您肯定想查看他的 pavement.py[配置文件](http://www.doughellmann.com/downloads/PyMOTW-1.89.tar.gz)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T19:58:16.890

为此，我一直在使用[setuptools](http://pypi.python.org/pypi/setuptools)，有时与 Ant 结合使用以获得更复杂的东西，或者与其他构建集成。总的来说，它对我来说效果很好，但我听说#python (freenode) 的一些人抱怨这个包的源质量普遍较低，并推荐标准的[distutils](http://docs.python.org/distutils/)。

如果你习惯了 Java（像我一样），真正要注意的一件事是 python 不支持拆分包。也就是说，您不能将 site.db 放在 src/site/db 中，将 site.view 放在 src2/site/view 中，将 src 和 src2 放在 PYTHONPATH 上，并且期望一切正常。这让我对构建工具感到头疼，它的工作有点零星:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-16T00:10:22.103

我喜欢的一个工具是 virtualenv：[http://pypi.python.org/pypi/virtualenv](http://pypi.python.org/pypi/virtualenv)

来自站点： *它的作用 virtualenv 是一个创建隔离 Python 环境的工具。正在解决的基本问题是依赖关系和版本之一，以及间接权限。想象一下，您有一个应用程序需要 LibFoo 版本 1，但另一个应用程序需要版本 2。您如何同时使用这两个应用程序？如果您将所有内容都安装到 /usr/lib/python2.4/site-packages（或任何您平台的标准位置），很容易导致您无意中升级不应升级的应用程序。*

你也可以试试： http: [//pypi.python.org/pypi/zc.buildout](http://pypi.python.org/pypi/zc.buildout)

来自站点： *Buildout 项目为创建应用程序提供支持，尤其是 Python 应用程序。它提供了从多个部分（Python 或其他方式）组装应用程序的工具。一个应用程序实际上可能包含多个程序、进程和配置设置。*

尝试了几次，非常适合部署开发环境，也许它对您的需求来说太多了。

我还在几个地方被告知和阅读，鼻子是一个非常酷的测试工具 [http://somethingaboutorange.com/mrl/projects/nose/0.11.1/](http://somethingaboutorange.com/mrl/projects/nose/0.11.1/)，我正在寻找一些空闲时间来尝试它。

希望它可以帮助干杯，啤酒

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-16T13:20:50.563

> 为了避免像 jwp 这样的进一步答案，请注意，对于这个项目，我绝对需要我的程序是一个独立的可执行文件，因为在可执行文件将运行的目标平台上绝对不可能有一个 python VM。我有完全相同的硬件可用于编译，所以幸运的是我不需要交叉编译（但我会在更友好的 Linux 上进行开发）。
> 
> 我还想测试我的代码是否从一开始就在 Cython 中编译，不是为了过早优化，而是为了确保我不会在使用不兼容的功能方面走得太远，如果 Cython 需要进行痛苦的重构将是非常需要的。

如果您只需要一个独立的可执行文件，则不需要运行 Cython。有一些很好的库可以做到这一点：

*   [py2exe](http://www.py2exe.org/)
*   [py2app](http://svn.pythonmac.org/py2app/py2app/trunk/doc/index.html)

但是，要运行 Python 代码，您只需要以*某种*形式或方式在目标机器上安装解释器或虚拟机。我提出的解决方案仅涉及嵌入解释器以使其更易于安装。事实上，我很确定（但可能是错误的）Cython 不允许您构建独立的可执行文件。它主要用于创建 Python 解释器的扩展。

但是，还有其他几种选择。如果目标机器上有 Java 解释器，则可以运行[Jython](http://www.jython.org/Project/)。还有一个用于 .net的[IronPython 。](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)但是，您仍然必须在项目中分发这些语言的运行时。

简而言之，如果你想要一个没有依赖关系的独立可执行文件，你唯一的选择就是直接使用 C 或 C++。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-02T03:51:45.883

如果您正在寻找一个简单的基于 python 的构建工具。查看[pnt](https://github.com/rags/pynt)。[pynt](http://pypi.python.org/pypi/pynt)中的任务只是（装饰的）python 函数。它还支持将 Rake 样式参数传递给任务。

# python - 你如何过滤一个字符串，以便只返回列表中的字符？

> ID：870520
> 
> 赞同：22
> 
> 时间：2009-05-15T19:48:02.467
> 
> 标签：python, filter, whitelist

想象一个字符串，比如 'Agh#$%#%2341- -!zdrkfd'，我只想对其执行一些操作，以便只返回小写字母（例如），在这种情况下会带来 'ghzdrkfd '。

你如何在 Python 中做到这一点？显而易见的方法是创建一个字符列表，从“a”到“z”，然后遍历我的字符串中的字符，并仅在我的列表中逐个字符地构建一个新字符串。这看起来很原始。

我想知道正则表达式是否合适。替换不需要的字符似乎有问题，我倾向于将白名单列入黑名单。该`.match`功能似乎不合适。我查看了 Python 站点上的相应页面，但没有找到合适的方法。

如果正则表达式不合适并且正确的方法是循环，是否有一个简单的函数可以将字符串“分解”成列表？或者我只是在那里打另一个 for 循环？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-15T20:35:58.343

如果您正在寻找效率。使用[翻译](http://docs.python.org/library/stdtypes.html#str.translate)功能是最快的。

它可用于快速替换字符和/或删除它们。

```
import string
delete_table  = string.maketrans(
    string.ascii_lowercase, ' ' * len(string.ascii_lowercase)
)
table = string.maketrans('', '')

"Agh#$%#%2341- -!zdrkfd".translate(table, delete_table) 
```

**在 python 2.6 中：**你不再需要第二张表了

```
import string
delete_table  = string.maketrans(
    string.ascii_lowercase, ' ' * len(string.ascii_lowercase)
)
"Agh#$%#%2341- -!zdrkfd".translate(None, delete_table) 
```

这种方法比任何其他方法都快。当然，您需要将 delete_table 存储在某处并使用它。但即使你不存储它并每次都构建它，它仍然会比迄今为止其他建议的方法更快。

为了确认我的说法，这里是结果：

```
for i in xrange(10000):
    ''.join(c for c in s if c.islower())

real    0m0.189s
user    0m0.176s
sys 0m0.012s 
```

在运行正则表达式解决方案时：

```
for i in xrange(10000):
    re.sub(r'[^a-z]', '', s)

real    0m0.172s
user    0m0.164s
sys 0m0.004s 
```

**[根据要求]**如果您预编译正则表达式：

```
r = re.compile(r'[^a-z]')
for i in xrange(10000):
    r.sub('', s)

real    0m0.166s
user    0m0.144s
sys 0m0.008s 
```

运行 translate 方法的次数相同：

```
real    0m0.075s
user    0m0.064s
sys 0m0.012s 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-15T19:53:36.963

```
s = 'Agh#$%#%2341- -!zdrkfd'  
print ''.join(c for c in s if c.islower()) 
```

字符串对象是可迭代的；无需将字符串“分解”成列表。您可以在列表推导中放置您想要的任何条件，它会相应地过滤字符。

您也可以使用正则表达式来实现这一点，但这只会隐藏循环。正则表达式库仍然需要遍历字符串的字符才能过滤它们。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-15T19:58:27.373

使用正则表达式很容易，尤其是对于这种情况：

```
>>> import re
>>> s = 'ASDjifjASFJ7364'
>>> re.sub(r'[^a-z]+', '', s)
'jifj' 
```

如果您打算多次这样做，最好事先编译正则表达式：

```
>>> import re
>>> s = 'ASDjifjASFJ7364'
>>> r = re.compile(r'[^a-z]+')
>>> r.sub('', s)
'jifj' 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-15T19:53:32.500

```
s = 'ASDjifjASFJ7364'
s_lowercase = ''.join(filter(lambda c: c.islower(), s))
print s_lowercase #print 'jifj' 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-15T19:57:34.987

```
>>> s = 'Agh#$%#%2341- -!zdrkfd'
>>> ''.join(i for i in s if  i in 'qwertyuiopasdfghjklzxcvbnm')
'ghzdrkfd' 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-19T19:26:51.527

一种更通用且更易于理解的解决方案，可以根据 a字符`inputstring`对其进行过滤：`whitelist`

```
inputstring = "Agh#$%#%2341- -!zdrkfd"
whitelist = "abcdefghijklmnopqrstuvwxyz"
remove = inputstring.translate(None, whitelist)
result = inputstring.translate(None, remove)
print result 
```

这打印

```
ghzdrkfd 
```

第一个`string.translate`从输入字符串中删除白名单中的所有字符。这给了我们想要删除的字符。第二个`string.translate`调用从输入字符串中删除那些并产生所需的结果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T20:59:53.403

如果您对处理字符串特别感兴趣，这是一种解决方案：

```
 s = 'Agh#$%#%2341- -!zdrkfd'
 lowercase_chars = [chr(i) for i in xrange(ord('a'), ord('z') + 1)]
 whitelist = set(lowercase_chars)
 filtered_list = [c for c in s if c in whitelist] 
```

白名单实际上是为了提高效率而设置的（不是列表）。

如果需要字符串，请使用 join()：

```
filtered_str = ''.join(filtered_list) 
```

* * *

filter() 是一个更通用的解决方案。从文档（[http://docs.python.org/library/functions.html](http://docs.python.org/library/functions.html)）：

> 过滤器（函数，可迭代）
> 
> 从函数返回 true 的那些可迭代元素构造一个列表。iterable 可以是序列、支持迭代的容器或迭代器。如果 iterable 是字符串或元组，则结果也具有该类型；否则它总是一个列表。如果 function 为 None，则假定恒等函数，即移除 iterable 中所有为 false 的元素。

这将是使用 filter() 的一种方式：

```
filtered_list = filter(lambda c: c.islower(), s) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T19:54:27.443

我会使用正则表达式。对于小写匹配 [az]。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T20:04:29.993

```
import string
print "".join([c for c in "Agh#$%#%2341- -!zdrkfd" if c in string.lowercase]) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-28T16:54:47.237

```
import string

print filter(string.lowercase.__contains__, "lowerUPPER")
print filter("123".__contains__, "a1b2c3") 
```

# javascript - 制作图书馆案例的有说服力的论据是什么？

> ID：870526
> 
> 赞同：2
> 
> 时间：2009-05-15T19:48:34.493
> 
> 标签：javascript, open-source

在应用程序中使用库时，哪些论点会导致最大的成功？您如何成功地帮助同事看到使用图书馆的好处？

特别是在以下情况下：
1\. 该库是开源的。
2\. 该库适用于 JavaScript、HTML、CSS。
3\. 开发人员团队有一种文化，他们相信他们已经看到了一切，认为他们可以编程，并且通常对超出他们舒适区的事物（他们理解和掌握的技能）持怀疑态度。
4\. 开发团队已经将这种基础架构类型的代码拼凑了 10 多年。
5\. 这个自制代码嵌入在服务器端代码中。
6\. 团队不使用 Web 开发 IDE。
7、目标用户群目前99.9%是IE 6.0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T19:52:26.577

你知道，我为此提出的最好的论点是，无论你的团队多么优秀，bug 都是不可避免的；使用开源库，有人已经发现了错误并修复了它们。这是迄今为止我在那种精确的情况下使用过的最有说服力的论点。无论您的开发人员多么自信，他们都必须承认，即使他们的代码偶尔也会出现错误，并且使用已经过广泛测试和调试的代码可以消除大部分不确定性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-15T19:53:47.603

如果您打算使用 javascript 做任何有趣的事情，而您的团队认为他们不需要 javascript 库，那么他们在该领域肯定缺乏经验。

他们显然没有意识到浏览器不兼容的问题，尤其是在 IE6 方面。

当您在浏览器中工作时，您不是在使用一个平台，而是在使用 4 个古怪的、不兼容的平台。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T19:54:26.680

您的大学正遭受[NIH 综合症](http://en.wikipedia.org/wiki/Not_Invented_Here)（此处未发明）。

它在各种任务中都很常见，例如创建数据访问代码时。他们认为他们可以做得比像 (N)Hibernate 这样的大规模社区努力已经超过 10 年。

***图书馆应该阻止你重新发明轮子（糟糕地）并专注于更有趣的东西。***

举个例子，今天我不得不查看第三方的一些代码。它重新实现了 System.DateTime，而且非常糟糕。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T19:52:33.470

最好的两个是相关的（对我来说）-

*   已经开发和测试
*   这使您可以将时间/精力集中在核心能力/问题领域

有时这是一场艰苦的战斗，你必须接受你可能不会赢的事实。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T19:52:40.227

它节省时间和金钱是很好的论据。不过，您必须向他们证明这一点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T22:15:23.173

我想我患有某种形式的 NIH。我对大多数图书馆的问题：它们太胖了。它们包含很多我从未使用过的功能。我的策略是从库中复制我需要的功能，有时根据自己的需要调整它们，其余的保留。通过这种方式，我收集了一个相当不拘一格的函数库供我自己使用，我尝试将其划分为按功能排序的小模块（例如 domwrapper、工具提示模块等）。

此外，我真的很想知道我在做什么，而使用库并不总是很清楚，也不是很费时间才能找到。

# database - 编写 Oracle 对象的脚本

> ID：870528
> 
> 赞同：1
> 
> 时间：2009-05-15T19:49:53.960
> 
> 标签：database, oracle, scripting

我最近获得了一个现有的 oracle 数据库，我想编写各种对象及其静态数据的脚本，以便我可以将对象置于源代码控制之下，并在必要时从头开始重建数据库。

有没有人有任何脚本或工具可以帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T22:07:58.950

我会看类似的东西：从 dba_objects 中选择 dbms_metadata.get_ddl(object_type, object_name, owner)。将其粘贴在 PL/SQL 过程中，以使用 UTL_FILE 将每个对象的 DDL 写入其自己的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T01:27:12.293

对于工具，我推荐 Oracle 的[SQL Developer](http://www.oracle.com/technology/software/products/sql/index.html)，它既有对象的自动脚本，也支持一些源代码控制实用程序（特别是 CVS 和 Subversion）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T05:36:05.280

我倾向于使用 EXPORT/IMPORT（如果任何版本达到并包括 11g）或 DATA PUMP（如果 11g 并且可能是 10G）

在服务器上的命令行输入“exp help=Y”，您应该获得足够的参数详细信息。决定你是想要整个数据库还是一个模式、数据与否等。

# c# - 序数日期格式 C#

> ID：870531
> 
> 赞同：6
> 
> 时间：2009-05-15T19:50:04.287
> 
> 标签：c#, datetime, ordinal

问题：

您将获得格式为 YYYYddd 的日期，即年份，然后是一年中的某一天，从 1 到 365(366)。例如今天是 2009135 (5/15/2009)。

从中创建新日期时间的最佳方法是什么？在 Ruby 中，我知道有一个构造函数需要两个数字，就像这样

```
Date.ordinal(2009, 135) 
```

C# 有类似的构造函数吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T19:53:43.063

嗯，我不确定是否有更直接的方法，但这应该可以

```
new DateTime(year, 1, 1).AddDays(day - 1); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T19:53:49.083

怎么样：

```
new DateTime(ordinal / 1000, 1, 1).AddDays((ordinal % 1000) - 1); 
```

这依赖于 2009 年的第 1 天被表示为 2009001 而不是 20091。如果是后者，那就有点棘手了（当然，虽然仍然不那么难）。

不过，我会尝试很快地摆脱这种格式——它并不完全是一种常见的格式，而且完全不可读。假设“2009001”格式至少排序合理，但我想不出其他有利于它的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T19:55:37.707

```
int year = 2009;
int month = 1;
int day = 1;
int dayOfYear= 135;

DateTime myDate  = new DateTime(year, month, day);
myDate.AddDays(dayOfYear - 1); 
```

# c# - TestDriven.NET 和本机 C 库

> ID：870536
> 
> 赞同：0
> 
> 时间：2009-05-15T19:50:24.897
> 
> 标签：c#, c, xunit.net, testdriven.net, native-methods

我正在开发一个调用本机 Windows C dll 的 C# 应用程序。我们使用带有 xUnit 的 TestDriven.NET 进行测试。问题是，每当我们运行使用 C 库（我们没有编写）的单元测试，然后尝试构建时，就会出现关于另一个进程如何使用库的构建错误。要修复它，您必须杀死遗留下来的 TestDriven 系统托盘应用程序。我们正在调用库提供的一种方法来释放其内存，但它似乎没有帮助。有谁知道阻止这种情况的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T21:39:05.367

我们有同样的问题，因为我们正在构建一个本地 clr 分析器。奇怪的是，
windows 允许您重命名 dll 但不能删除它。
一种解决方法是创建一个预构建步骤，在构建之前重命名现有的 dll。
另外我建议联系TD.NET 的作者[Jamie Cansdale](http://weblogs.asp.net/nunitaddin/default.aspx)并报告这个问题。他得到了很大的支持。

# visual-studio-2008 - 如何删除 Visual Basic 项目类型？

> ID：870542
> 
> 赞同：6
> 
> 时间：2009-05-15T19:51:25.877
> 
> 标签：visual-studio-2008

我永远不会创建 Visual Basic 项目。我可以从我的 IDE 中删除这些吗？太多次我创建了一个新项目，却没有意识到我已经默认使用 Visual Basic 项目并错误地创建了一个 Visual Basic 项目而不是我打算创建的 C# 项目。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T20:00:10.097

转到“程序和功能”（Vista）或“添加或删除程序”（XP）并选择 Visual Studio。单击“卸载或更改”（或等效项）。

然后选择“添加或删除功能”并在“语言工具”下删除“Visual Basic”。

可能还有其他直接与模板混淆的方法，但这感觉像是说您对 VB 不感兴趣的最恰当的方式。

编辑：（基于评论）

您还可以通过重置所有设置或[编辑 vssettings 文件](http://strivinglife.com/words/post/How-to-change-your-default-language-in-Visual-Studio-2008-the-right-way.aspx)来更改默认语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T20:01:17.380

转到开始 -> 控制面板 -> 添加或删除程序 -> 查找您正在使用的 Visual Studio 版本，然后选择“更改/删除” -> 从功能中删除 Visual Basic

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T20:00:17.850

模板安装到 C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ProjectTemplates\VB。

您可以尝试删除该文件夹。IDE 目录中还有一个缓存文件夹。

如果这不起作用或出现问题，您始终可以通过运行 Visual Studio 命令提示符并键入“devenv /installvstemplates”来重新安装它们。

# business-objects - Business Objects XI - *非*管理员可以将报表从一个环境复制到另一个环境吗？

> ID：870553
> 
> 赞同：0
> 
> 时间：2009-05-15T19:52:56.777
> 
> 标签：business-objects

如果主题问题没有意义，请原谅我，让我尝试解释一下。

我们有一个指向生产数据库的 BO 生产环境。我们有一个指向开发数据库的开发环境。

当用户抱怨报告不起作用时，我们希望将报告复制到开发环境，并在修复后确保报告现在可以正常工作。问题是我们的 BO 管理员告诉我们，必须具有管理员权限才能执行此操作，而要让管理员执行此操作需要国会法案加上一周的时间。

显然，鉴于开发人员对生产环境的管理员访问权限是不可能的。但我很难相信一个人必须拥有管理员权限才能做到这一点。这看起来对吗？

- 一个菜鸟BO用户

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-11T18:44:02.280

我很确定您需要管理员权限才能在业务对象的跨服务器中传输任何内容。我不相信有任何单一的权利会允许这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-11T18:51:21.983

我只是在确认 Sivvy 的回答。

我刚刚尝试在没有管理员身份的情况下使用导入向导迁移报告，我什至不允许登录。除了需要成为管理员组的成员之外，登录还需要有一个企业登录帐户业务对象。

# php - 将预定义常量定义为什么

> ID：870554
> 
> 赞同：2
> 
> 时间：2009-05-15T19:52:57.150
> 
> 标签：php, class, constants

我有一个数据库类，它自动建立与数据库的连接并执行一些基本的输入过滤等等。我正在考虑设置一些预定义的常量来调整类方法的行为。我应该将常量的值设置为什么？由于这些值永远不会被直接引用或比较，而是仅在常量名称的上下文中，值甚至重要吗？

我遇到的一种策略是将常量设置为位值，以便可以使用按位运算符来组合常量。在这种情况下，看起来不需要该功能，但您永远不知道。

我经常收到这样的消息

```
Notice: Use of undefined constant CONSTANT_VALUE - assumed 'CONSTANT_VALUE' 
```

这是将常量视为字符串“CONSTANT_VALUE”还是常量 CONSTANT_VALUE？我是否应该将常量的值定义为同名的字符串来弥补这一点？当我使用我知道在某些时候定义的常量时会发生这种情况，例如 DOCUMENT_ROOT。

我是否错过了其中任何一个更好的做法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T19:59:37.837

如果您收到该消息，则相关常量*未*在该代码运行时定义，而是被视为 string `'CONSTANT_VALUE'`。

如果您定义的一组常量的值是完全任意的并且不需要位掩码，请使用正整数序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:45:42.247

如果常量不会在数据库类之外使用，则不需要定义全局常量，可以使用类常量：

[http://uk.php.net/manual/en/language.oop5.constants.php](http://uk.php.net/manual/en/language.oop5.constants.php)

# c++ - 使用 spawnl 并等待子进程退出

> ID：870555
> 
> 赞同：0
> 
> 时间：2009-05-15T19:53:06.387
> 
> 标签：c++, c

我在 borland 开发工作室中使用 c++ 来启动一个进程。进程启动后，父应用程序应该等待它，但仍继续处理 Windows 消息。

我尝试在启动计时器后将 spawnl 与 P_WAIT 一起使用，但是当线程被阻塞时计时器不会触发，我也尝试将 spawnl 与 P_NOWAIT 与 cwait 一起使用，但这也不起作用。

有什么建议么 ？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T23:42:50.437

您是否正在等待以处理 Windows 消息的方法完成该过程？如果您在按钮单击处理程序中等待新进程，Windows 将不会再处​​理任何消息，直到按钮单击方法完成。

如果您需要基于计时器的后台处理，您有几个选择：

1.  创建一个线程来等待进程完成。
2.  创建一个新的计时器，定期检查 WaitForExit() 以确定其他进程何时完成。
3.  在您当前的处理程序中，使用您的计时器周期作为参数调用 Windows WaitForExit()。如果 WaitForExit() 返回时该过程未完成，请执行基于计时器的处理。请注意，此选项仍会导致不处理任何 Windows 消息。

# c# - ASP.NET 请求之间 LINQ to SQL 实体持久性的最佳实践

> ID：870574
> 
> 赞同：0
> 
> 时间：2009-05-15T19:55:58.050
> 
> 标签：c#, asp.net, linq-to-sql

对于我当前的项目，我使用 LINQ to SQL 作为 ORM。现在我将修改后的实体存储在会话中以保存在 ASP.NET 请求之间所做的更改。这样做的最佳实践是什么，因为最近我开始发现这种方法对于 Web 场来说不是很可扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T20:07:16.057

我个人根本不会这样做。我知道可以重新附加实体，但这并不是微不足道的，我真的很难想出这样做比其他维护状态的方法有什么好处。

[这里](http://greggalipeau.wordpress.com/2009/03/03/re-attaching-objects-my-foray-into-linq-to-sql-and-the-entity-framework-part-2-of-2/)有一篇不错的文章，它说各种方法各有利弊，但我很想知道优点是什么！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:09:56.033

你的意思是因为你有 InProc Session 或者更一般的过程没有扩展，所以它不是为你的网络场扩展？我的观点是，如果您有 InProc Session，因此它无法在网络场上运行，那么您将不得不在某个地方退出进程以保存该数据，因此您不妨提交到数据库。但是，如果您有特殊情况，您可能需要解释它以获得更好的答案。

# windows - 在多宿主系统上接收 UDP 广播

> ID：870577
> 
> 赞同：0
> 
> 时间：2009-05-15T19:56:46.737
> 
> 标签：windows, udp, broadcast

我有一台带有多个网络适配器的 Windows XP 机器。当我从另一台没有有效 IP 地址的机器收到 UDP 广播包时，我如何确定是哪个网络适配器收到了这个包？

我需要在自定义 DHCP 服务器上实现一种...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T20:10:33.897

如果对方机器没有IP地址，那我认为它不能广播UDP！

您是指“RARP”广播而不是“UDP”广播吗？

# coding-style - 代码格式化的重要性，特别是间距

> ID：870578
> 
> 赞同：1
> 
> 时间：2009-05-15T19:56:57.173
> 
> 标签：coding-style, code-formatting

代码采用这种形式对于可读性有多重要：

```
public void DoStuff()
{
    var v = new Object();
    v.PropertyID = "abc";
    v.Type = "abc";
    v.Style = "abc";
    v.SetMode(Mode.Abc);
    v.Draw();
} 
```

对比

```
public void DoStuff()
  {
    var v = new Object();
        v.PropertyID = "abc";
        v.Type = "abc";
      v.Style = "abc";
       v.SetMode(Mode.Abc);
   v.Draw();
    } 
```

我最喜欢第一种风格，它让事情变得容易阅读，你会如何温柔地引导人们走向前者并远离后者？或者你不会？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T20:01:53.213

人们真的编写看起来像后者的代码吗？这是可维护性的噩梦。

我会争辩说，您的代码格式约定是什么并不重要 - 更重要的是您始终遵循它们。前一个示例不一致，因此不可读且不可维护。

如果你在引导人们实现一致性方面遇到困难，让他们想象在一年内回去维护高度不一致的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T19:59:19.243

格式非常重要，但不是必需的。如果我看到像后者这样的代码，我往往会有点生气。如果您花时间编写代码，请确保您花时间正确格式化它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:11:44.767

如果是我的代码，我会这样做：

```
public void DoStuff()
{
    var v = new Object();

    v.PropertyID = "abc";
    v.Type       = "abc";
    v.Style      = "abc";

    v.SetMode(Mode.Abc);
    v.Draw();
} 
```

这样就很清楚哪些行是属性分配，哪些是方法调用。

我也同意 Jamie 的回答，他说“格式非常重要，但不是必需的”。重要的是格式还不错，不会影响其他人的阅读能力。*大多数时候，*我不相信少量额外的制表符或换行符会对称职的程序员产生巨大的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T20:01:24.323

在第二个示例中，大括号的缩进不同。

间距对我阅读代码很重要。如果您在我的公司编写代码 - 我可能不得不在某个时候阅读它。如果您不格式化代码 - 我将使用自动格式化程序来获取我需要的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T20:02:27.940

在团队中工作时，风格至关重要。所以不管你选择什么风格，只要确保每个人都同意它……然后执行该协议。将您的 IDE 设置为自动格式化您的代码.. 并确保每个人的 IDE 设置相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T20:03:24.270

如果你想善良，请给他们 Code Complete 阅读。如果您想变得刻薄，请在他们的代码中引入像这样的微妙错误：

```
if (x==y);
   DoSomething(); else
DoSomethingElse();
while(Whatever)
SomeFunction(); 
```

（如果他们在不到一天的时间内发现了这个错误，那么你就不够巧妙了。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T20:05:51.643

我更喜欢你的间距，尽管我会做一些不同的事情。我相信您最重要的问题是如何说服某人您的方法是最好的：代码格式可能非常主观。有些人反对，因为它需要太多时间才能做到正确。其他人反对，因为团队没有任何编码标准。一些反对，因为感觉它被塞进了他们的脖子。

最好的方法是与您的团队合作，就您的特定方法是最佳实践达成共识。如果您是牵头人，或者您是个人贡献者，情况就是如此。

一旦团队共识被普遍接受（它可能不是普遍的），那么我发现代码审查是确保遵循团队实践的最佳场所。我建议你会发现同伴压力是鼓励其他人遵循公认的最佳实践的最有效方式。圈养往往是真实的。在没有共识的情况下，一个人很难在团队中推动这种事情。

这是我的一些相关 StackOverflow 答案

*   [是否有任何其他开发人员因公开所有内容而受到责骂？](https://stackoverflow.com/questions/393001/do-any-other-developers-get-yelled-at-for-making-every-thing-public-closed)
*   [您将如何格式化/缩进这段代码？](https://stackoverflow.com/questions/311454/how-would-you-format-indent-this-piece-of-code)
*   [你如何进行代码审查？](https://stackoverflow.com/questions/310813/how-do-you-perform-code-reviews/310849#310849)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T20:21:24.523

正如其他人所说，第一个例子是规范；第二个与它不同。

此外，请确保处理同一组文件的每个人都对“选项卡”具有相同的约定。最好将其定义为多个空格，并确保每个人的文本编辑器和 IDE 都同意。

当三四个人在同一个 SVN 存储库中工作并使用不同的间距约定编辑每个文件时，这会很烦人。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-15T19:59:55.747

第二种方式并不能很好地标记。躲开它。

我也认为人们倾向于对这样的格式感到厌烦。一个月后会有另一个人出现并想要这种格式

```
public void DoStuff()
  {
    var v                = new Object();
        v.PropertyID     = "abc";
        v.Type           = "abc";
        v.Style          = "abc";
        v.SetMode        (Mode.Abc);
        v.Draw           ();
  } 
```

这变得非常愚蠢，而且很难处理。

如果人们这样编码，请质疑他们的推理和编程能力。

# c++ - 解读将 Visual C++ 6 项目升级到 Visual Studio 2008 时出现的错误

> ID：870580
> 
> 赞同：0
> 
> 时间：2009-05-15T19:57:06.893
> 
> 标签：c++, windows, visual-studio-2008, visual-c++, open-source

[我想看看是否可以将这个名为MouseTool](http://www.tomseddon.plus.com/mousetool/)的已失效开源项目与 Windows Vista 一起更新。它是一个驻留点击器，可以帮助那些在点击鼠标时感到疼痛的人（比如我自己）。当鼠标停在屏幕上的某个位置时，该软件模拟点击。

几年来似乎没有人接触过这个项目，所以当我在 Visual Studio 2008 中打开它时，我遇到了很多错误。我对 Visual Studio 知之甚少，并希望这些错误能为这里的某个人敲响警钟。有人可以提供有关我如何着手解决其中一些错误的任何提示，我们将不胜感激。

**举个例子，这个错误。. .**

```
Error   18  error C2440: 'static_cast' : 
cannot convert from 'void (__thiscall COptionsSheet::* )(UINT,POINTS)' 
to 'LRESULT (__thiscall CWnd::* )(WPARAM,LPARAM)' 
```

**. . . 对应于这一行：**

```
ON_MESSAGE( WM_NCLBUTTONDOWN,   OnNCLDown ) 
```

**从这个块：**

```
BEGIN_MESSAGE_MAP(COptionsSheet, CPropertySheet)
    //{{AFX_MSG_MAP(COptionsSheet)
    ON_WM_HELPINFO()
    ON_WM_MOUSEMOVE()
    ON_WM_SETCURSOR()
    //}}AFX_MSG_MAP
    ON_MESSAGE( WM_NCLBUTTONDOWN,   OnNCLDown )
    ON_MESSAGE( WM_NCLBUTTONUP,     OnNCLUp )
    ON_BN_CLICKED(ID_HELP, OnHelpButton)
END_MESSAGE_MAP() 
```

**为任何人敲钟？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T20:09:22.917

某些 MFC 事件处理程序的成员签名未在 vc6 中正确检查 - 在 VC6 中编译错误的代码需要修复才能在您正在使用的更新编译器中编译。

ON_MESSAGE 目标的处理程序需要符合此签名：

```
afx_msg LRESULT (CWnd::*)(WPARAM, LPARAM). 
```

你的签名是这样的：

```
void (COptionsSheet::* )(UINT,POINTS) 
```

CWnd 已经有了这个成员：

```
afx_msg void OnNcLButtonDown(UINT nHitTest, CPoint point); 
```

使用该签名而不是您自己的手卷 OnNclDown。

编辑：对 OnNclButtonDown 使用 ON_WM_NCLBUTTONDOWN 而不是 ON_MESSAGE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:21:55.787

问题在于，在较新版本的 Visual Studio 中，对函数签名的检查更加严格。旧的 MFC 宏代码会让事情滑倒，但它们有效。

要修复错误，您需要检查消息映射中的每条消息并更改方法以匹配签名。

**编辑：** [`WM_NCLBUTTONDOWN`通知](http://msdn.microsoft.com/en-us/library/ms645620(VS.85).aspx)声明它需要一个`WPARAM`and `LPARAM`，它被视为一个 int 和一个指向 POINTS 结构的指针。因此，如果您将签名更改为使用`WPARAM w, LPARAM l`而不是`UINT, POINTS`然后*将*`w`and参数转换为`l`类型，应该没问题。

这更多的是使签名和功能真正匹配，而不是改变它们的工作方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-26T20:36:47.750

我遇到了同样的问题，但是接收消息的类不是从 CWnd 派生的（从 CWinThread 派生的）。

关于什么宏可以让我收到消息的任何想法？

编辑：我花了很长时间去挖掘 MSDN 来找到这个，但是对从 CWinThread 派生的类使用 ON_THREAD_MESSAGE() （应该想到这个......）。

# apache-flex - 在 Flex 列表上手动实现拖动

> ID：870581
> 
> 赞同：0
> 
> 时间：2009-05-15T19:57:22.773
> 
> 标签：apache-flex, drag-and-drop

`List`我有一个 Flex 应用程序，它根据项目的分类方式在几个 s 中的一个中显示项目集合。通过在列表之间拖动项目，用户启动了一个服务器端进程，该进程试图重新分类项目。然后，服务器端进程返回一些 XML，其中包含错误消息或“OK”。

要求是，如果服务器返回 OK，则 UI 执行“拖动移动”，如果服务器返回错误，则不执行任何操作。使用默认的拖动处理程序（设置和`dragEnabled=true`s ）似乎总是执行拖动复制。`dropEnabled=true``List`

据我所知，让我获得足够控制以处理异步服务器验证的唯一方法是手动实现从列表中拖入和拖出。因此，我阅读了[Adob​​e 的文档](http://livedocs.adobe.com/flex/3/html/dragdrop_5.html)并尝试修改他们的示例。

我遇到的问题是，据我所知，我需要通过连接到`mouseMove`列表上的事件来检测拖动。然后，我将 List 作为启动器传递给 DragManager.doDrag 例程。

以这种方式工作有许多问题：默认代理图像是整个列表的大小，尝试使用滚动条设置拖动检测等。显然我做错了什么。

`List`有没有人尝试过手动实现对 s 的拖动？是否有正确检测拖动事件的快速技巧？我应该寻找用户拖动的实际 itemRenderer 并将其作为发起者传递吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:52:58.123

我认为您的拖动启动器应该是您正在拖动的项目渲染器，而不是整个 List 控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:03:01.683

嗯...如果我理解您在这里尝试做什么，您想拖放，但如果服务器返回错误则撤消？

我要做的是处理 dragEnd 事件并检查服务器状态。如果服务器返回错误，则只需将数据移回原始列表，不要将其添加到新列表中，否则只需执行默认行为。随时对澄清发表评论。

# c# - C# File.Open 和 Stream 等效项

> ID：870594
> 
> 赞同：3
> 
> 时间：2009-05-15T19:59:40.020
> 
> 标签：c#, file-io, stream

这个网络服务需要这个 xml 文件：

```
request.FeedContent = File.Open("test.xml", FileMode.Open, FileAccess.Read); 
```

我已经在流中拥有该文件，但是此语句挂起：

```
stream.Position = 0;
request.FeedContent = stream; 
```

该流是标准的.net MemoryStream

我在流上做了什么操作以使其与 File.Open 相同？

谢谢！！

看看这个（api定义）：

```
 /// <summary>
    /// Gets and sets the FeedContent property.
    /// </summary>
    //[XmlElementAttribute(ElementName = "FeedContent")]
    public Stream FeedContent
    {
        get { return this.feedContentField ; }
        set { this.feedContentField= value; }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T20:03:25.677

我怀疑网络服务*真的*需要一个流。这到底是怎么代表的呢？您确定它不只是期望内容为字节数组吗？

`File.Open`只返回 a `FileStream`- 如果`stream`已经是 a`FileStream`那么两者之间没有区别。它*可能*想要 a`FileStream`而你刚刚得到 a `Stream`。如果是这种情况并且它确实*不是*来自文件，那么您可能必须将其写入文件并打开一个文件`FileStream`。然后向 web 服务开发人员抱怨他们的 API 很奇怪。

编辑：如果它只是期待 a `Stream`，你应该没问题。您说它挂起 - 您是否尝试过调试并查看它到底挂在哪里？它是否出于某种原因试图读取更多数据？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:11:03.520

您确定您的信息流中的当前位置是正确的吗？

从文件流移动到内存流时，我最常见的错误是在写入内存流后错过了它，我在它的末尾：

```
stream.Seek(0, SeekOrigin.Begin); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:27:26.787

您是否尝试过在分配之前将文件内容放入内存流中？也许该服务正在使用您的文件流不支持的某些流功能。

像这样的东西：

```
var stream = new MemoryStream(File.ReadAllBytes(fileName));
request.FeedContent = stream; 
```

**编辑：**

等等...我完全误解了你的问题。因此，您直接传递 FileStream 的版本有效，如果您提供具有相同内容的 MemoryStream ，它不会？

现在我建议您将内存流的内容与文件流的内容进行精确比较。也许不同的编码？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T20:02:44.727

File.Open 返回一个流。还有别的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T20:10:30.993

File.Open 返回一个打开并位于流开头的 FileStream。

您发布的代码：

```
request.FeedContent = stream; 
```

不指示您分配给 FeedContent 的流的状态。例如，也许您没有位于文件的开头？（如果流支持查找，则使用 Stream.Seek，如果它是 FileStream 或 MemoryStream 则使用）。

如果这没有帮助，请发布更多代码。

# asp.net - ChannelFactory 重用策略

> ID：870600
> 
> 赞同：3
> 
> 时间：2009-05-15T20:00:23.217
> 
> 标签：asp.net, wcf, channelfactory

我一直在读到 ChannelFactory 创建很昂贵，除非有技术原因不这样做，否则应该尽可能地重用 ChannelFactories，方法是以某种方式缓存它们，或者使用工厂的静态实例。

根据您的经验，您发现哪些 ChannelFactory 重用策略在 ASP.NET 应用程序的上下文中最有用和最健壮？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T22:49:36.667

如果您使用的是 .NET 3.0 SP1 及更高版本并且不需要需要直接处理通道的特殊内容，那么最好的选择是只使用从 ClientBase<T> 派生的客户端代理类（就像在进口服务）。那些已经在下面缓存了工厂。有关详细信息，请参见[此处](http://blogs.msdn.com/wenlong/archive/2007/10/27/performance-improvement-of-wcf-client-proxy-creation-and-best-practices.aspx)。

如果不是，那么是的，您需要将 IChannelFactory<T> 对象粘贴在某处，但您仍需要确保正确处理共享（我认为堆栈没有任何保证可以访问工厂线程安全），但除此之外，它应该相当简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T15:36:31.567

Darin Damitrov 在此处发布了关于重用 channelfactories 的有用答案：-

[创建 WCF ChannelFactory<T>](https://stackoverflow.com/questions/3200197/creating-wcf-channelfactoryt)

我一直在研究我最近正在开发的应用程序中的内存使用情况和性能。我应用了他提倡的技术（使用字典来存储一组通道工厂），并获得了良好的性能提升。

我所看到的是实例化一个通道工厂可能需要长达 70 毫秒。如果这种情况经常发生，它会迅速增加。

目前，我很谨慎，并没有设置我的 DI 容器来为应用程序的生命周期提供相同的通道工厂实例。相反，我让它们在单个 HTTP 请求期间有效（其中可能有许多后端服务调用）。

# php - 这个 PHP 类是否针对 mysql 数据库访问进行了优化？

> ID：870621
> 
> 赞同：2
> 
> 时间：2009-05-15T20:03:57.267
> 
> 标签：php, mysql, database, performance, class

我写了一个快速的 PHP 类来简化对 mysql 数据库的访问。该类工作正常，并且有一个 query() 方法可以打开连接，执行查询然后关闭连接（我知道脚本完成后连接应该由 PHP 本身关闭，但我不喜欢非常依赖这一点）。

从性能的角度来看，我知道每次执行查询时总是打开与数据库的连接可能不是一个很好的做法（而且当我尝试使用 mysql_real_escape_string() 过滤输入时，它不起作用，因为没有活动的数据库连接）。但我想更清楚地说明这一点。这样做是不是很不对？为什么？我也想知道这个的好选择。

这是课程：

```
class DB {

private $conn;

//database data
private $dbhost;
private $dbname;
private $dbuser;
private $dbpass;

/**
 * Constructor
 * @dbhost string the database host
 * @dbname string the database name
 * @dbuser string the database username
 * @dbpass string the database password
 */
public function __construct ($dbhost, $dbname, $dbuser, $dbpass)
{
    $this->dbhost = $dbhost;
    $this->dbname = $dbname;
    $this->dbuser = $dbuser;
    $this->dbpass = $dbpass;
}

/**
 * Connects to mysql database
 */
private function open ()
{
    $this->conn = mysql_connect ($this->dbhost, $this->dbuser, $this->dbpass)
    or die ("Error connecting to database");

    mysql_select_db ($this->dbname) or die ("Error selecting database");
}

/**
 * Closes the connection to a database
 */
private function close ()
{
    mysql_close($this->conn);
}

/**
 * Executes a given query string
 * @param string $query the query to execute
 * @return mixed the result object on success, False otherwise
 */
public function query ($query)
{   
    $this->open();
    $result = mysql_query($query, $this->conn)
    or die ("Error executing query ".$query." ".mysql_error());

    $this->close();
    return $result;

} 
```

}

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-15T20:07:45.447

> （我知道连接应该在脚本完成后由 PHP 本身关闭，但我不太喜欢依赖它）。

为什么？这是语言的一个特点。没有理由不相信它。许多网站运行良好，依靠 PHP 来关闭他们的东西。作为程序员，当然，我们想自己关闭它。没关系。但是为每个查询打开和关闭数据库连接是一个*可怕*的想法。更好的方法是`open()`从您的构造函数中调用，并将您的重命名`close()`为[`__destruct()`](http://us2.php.net/language.oop5.decon). 根据文档，`__destruct`“一旦对特定对象的所有引用被删除或对象被显式销毁或以关闭顺序中的任何顺序”，就会被调用。听起来像是为您的数据库连接隐藏关闭代码的理想场所。

# actionscript-3 - 我怎样才能很好地在视图堆栈之间制作动画

> ID：870622
> 
> 赞同：4
> 
> 时间：2009-05-15T20:04:17.653
> 
> 标签：actionscript-3, animation, air, flex3, viewstack

我有一个小的 Adob​​e Air 应用程序，我想在其中有几个“视图”。我可以使用 ViewStack 实现这些视图，但很难找到一种在它们之间制作动画的好方法。

这是我尝试过的，虽然它有效，但当我想要的更像是 DestroyTwitter 应用程序时，一个视图会在滑入视图之前消失，其中视图和所有控件都可以很好地滑出视图：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="400" height="700" top="100" left="100" creationComplete="onComplete()">
    <mx:Script>
    <![CDATA[
        import mx.core.Application;
        private function onComplete():void
        {
            stack.selectedChild = stack1;
        }

        private function switchTab():void
        {
            if( stack.selectedChild == stack1 )
            {
                stack.selectedChild = stack2;
            }
            else
            {
                stack.selectedChild = stack1;
            }
        }
    ]]>
    </mx:Script>

    <mx:Move id="slideLeft" xFrom="{Application.application.width}" xTo="0" yTo="0" duration="500" />
    <mx:Move id="slideRight" xFrom="0" xTo="{Application.application.width}" duration="500" />

    <mx:ViewStack id="stack" width="200%" height="100%">
        <mx:VBox id="stack1" width="100%" height="100%" backgroundColor="white" hideEffect="{slideRight}" >
            <mx:Label text="Stack 1" />
            <mx:Button label="Switch" click="switchTab()" />
        </mx:VBox>

        <mx:VBox id="stack2" width="100%" height="100%" backgroundColor="#cdcdcd" hideEffect="{slideLeft}" >
            <mx:Label text="Stack 2" />
            <mx:Button label="Switch" click="switchTab()" />
        </mx:VBox>

    </mx:ViewStack>
</mx:WindowedApplication> 
```

有没有人有更好的想法可以尝试，感谢任何回应？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T21:30:39.430

我将使用控制哪个视图处于活动状态的状态，然后定义在这些状态之间移动的转换：

[http://livedocs.adobe.com/flex/3/html/help.html?content=transitions_3.html](http://livedocs.adobe.com/flex/3/html/help.html?content=transitions_3.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T23:27:03.783

这正是我想要实现的目标：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" 
    layout="absolute" width="400" height="700" top="100" left="100" 
    horizontalScrollPolicy="off" verticalScrollPolicy="off"
    >

    <mx:Script>
        <![CDATA[
            import mx.core.Application;
        ]]>
    </mx:Script>

    <mx:states>
    <mx:State name="One">
            <mx:SetProperty target="{stack1}" name="x" value="0"/>
            <mx:SetProperty target="{stack1}" name="y" value="50"/>
            <mx:SetProperty target="{stack1}" name="width" value="{Application.application.width}"/>

            <mx:SetProperty target="{stack2}" name="x" value="{Application.application.width}"/>
            <mx:SetProperty target="{stack2}" name="y" value="50"/>
            <mx:SetProperty target="{stack2}" name="width" value="{Application.application.width}"/>
    </mx:State>

    <mx:State name="Two">
            <mx:SetProperty target="{stack1}" name="x" value="-{Application.application.width}"/>
            <mx:SetProperty target="{stack1}" name="y" value="50"/>
            <mx:SetProperty target="{stack1}" name="width" value="{Application.application.width}"/>

            <mx:SetProperty target="{stack2}" name="x" value="0"/>
            <mx:SetProperty target="{stack2}" name="y" value="50"/>
            <mx:SetProperty target="{stack2}" name="width" value="{Application.application.width}"/>
    </mx:State>
    </mx:states>

    <!-- Define Transition array with one Transition object.-->
    <mx:transitions>
        <!-- A transition for changing from any state to any state. -->
        <mx:Transition id="myTransition" fromState="*" toState="*">
            <mx:Parallel id="t1" targets="{[stack1,stack2]}">
                <mx:Move    duration="400"/>
            </mx:Parallel>
        </mx:Transition>
    </mx:transitions>

    <mx:HBox>
        <mx:Button label="Switch To Two" click="currentState='Two'" />
        <mx:Button label="Switch To One" click="currentState='One'" />
    </mx:HBox>

    <mx:Canvas id="stack1" x="0" y="50" width="100%" height="100%" borderThickness="1" borderStyle="solid">
        <mx:VBox width="100%" height="100%" backgroundColor="white">
            <mx:Label text="Stack 1" />
            <mx:Box backgroundColor="red" width="20" height="20" />
        </mx:VBox>
    </mx:Canvas>

    <mx:Canvas id="stack2" x="{Application.application.width}" y="50" width="100%" height="100%" borderThickness="1" borderStyle="solid">
        <mx:VBox width="100%" height="100%" backgroundColor="#cdcdcd">
            <mx:Label text="Stack 2" />
            <mx:Box backgroundColor="green" width="20" height="20" />
        </mx:VBox>
    </mx:Canvas>

</mx:WindowedApplication> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T21:04:42.940

您可以尝试的一件事是更高级的换入和换出视图。单击“切换”按钮时，执行移动并且在移动完成之前不要进行交换。

也许是这样的：

```
private function switchTab():void {

    var move:Move = new Move(stack.selectedChild as DisplayObject); //not sure about the casting right now...might need to check on that
    // implement move details here...

    //closure to make sure the next child is swapped in after the animation completes
    var done:Function = function(event:Event):void {
        // do the change here in this closure
        if (stack.selectedChild == stack1) {
            stack.selectedChild = stack2;
        }
        else {
            stack.selectedChild = stack1;
        }
        // remove the EventListener..don't want memory leaks :)
        move.removeEventListener(EffectEvent.END, done);
    }
    // make sure 'move' performs the 'done' function when the animation finishes
    move.addEventListener(EffectEvent.END, done);

    move.play();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-13T08:40:13.317

在上面接受的答案中添加模糊。使过渡看起来更平滑/更酷。

我试图从[Mike Chambers](http://www.mikechambers.com/blog/2010/08/11/accelerate-flash-arduino-based-speedometer/)的这个很酷的 Arduino 速度计中复制状态转换，而 Dan 的答案加上一些 Blur 就成功了。

```
<!-- Define Transition array with one Transition object.-->
    <mx:transitions>
        <!-- A transition for changing from any state to any state. -->
        <mx:Transition id="myTransition" fromState="*" toState="*">
            <mx:Sequence id="s1" targets="{[stack1,stack2]}">

                <mx:Blur duration="50" blurXFrom="0.0" blurXTo="5.0"
                         blurYFrom="0.0" blurYTo="5.0"/>

                <mx:Parallel id="t1" targets="{[stack1,stack2]}">
                        <mx:Move duration="400"/>
                </mx:Parallel>

                <mx:Blur duration="50" blurXFrom="5.0" blurXTo="0.0"
                          blurYFrom="5.0" blurYTo="0.0"/>
            </mx:Sequence>

        </mx:Transition>
    </mx:transitions> 
```

# javascript - 使用 Safari/Chrome 卸载 Ajax（或 JSONP）

> ID：870623
> 
> 赞同：4
> 
> 时间：2009-05-15T20:04:26.780
> 
> 标签：javascript, safari, xmlhttprequest

如果您尝试在卸载时发送 Ajax 请求、JSONP 请求甚至是 window.name 请求，Safari 和 Chrome 会运行代码，但服务器永远不会看到该请求。我的理论是执行线程永远不允许脚本标记在更改页面之前运行。这是一个带有 JSONP 测试的测试页面。此代码（以及 Ajax 和 window.name）在 Firefox 和 IE7 中创建对 test.html 的请求，但不是 Safari：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
    </head>
    <body>

        <script language="javascript" type="text/javascript">
            window.onunload = function(){
                var encode = "UTF-8";
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.src= "/test.html";
                script.charset= encode;
                document.body.appendChild(script)
            }
        </script>

    </body>
</html> 
```

有人知道解决这个问题的好方法吗？更具体地说，有人知道强制 Safari 在卸载时发送请求的方法吗？我发现的唯一解决方案（在我的情况下并没有真正帮助）是同步 XHR。

# .net - 在 .NET 中，当我针对 XSD 进行验证时，整个 XML blob 是否会进入内存？

> ID：870626
> 
> 赞同：0
> 
> 时间：2009-05-15T20:04:38.090
> 
> 标签：.net, validation, xsd, xmlreader

如果我有一个大的 (>500MB) XML 文件要验证，XmlReader 是否会将整个文件带入内存以执行验证？

我查看了[Validating an XML against referenced XSD in C#](https://stackoverflow.com/questions/751511/validating-an-xml-against-referenced-xsd-in-c) for validation procedure。

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T20:06:42.860

不，如果您使用`XmlValidatingReader`（或`XmlReader`使用适当的设置）它不会加载整个 XML 文件。**问题**中描述的方法**使用**加载整个文件的`XmlDocument`类。接受的**答案**不会加载整个文件，因此您可以使用它。

 ****# ios - Cocoa：为什么我的表格视图是空白的？

> ID：870627
> 
> 赞同：3
> 
> 时间：2009-05-15T20:04:39.090
> 
> 标签：ios, objective-c, iphone, uitableview, cocoa-touch

为什么我的表格视图是空白的？在我添加“initWithStyle”之前一直很好

这是它的样子：

![替代文字](https://i.stack.imgur.com/6ox52.png)

这是我的代码的样子：

这是我的.h：

```
#import <UIKit/UIKit.h>

@interface TableViewController : UITableViewController {

NSMutableArray *jokes;
IBOutlet UITableView *jokeTableView; 

 }

@property (nonatomic, retain) NSMutableArray *jokes;
@property (retain) UITableView *jokeTableView;

@end 
```

这是我的实现文件：

```
#import "TableViewController.h"
#import "Joke.h"

@implementation TableViewController
@synthesize jokes;
@synthesize jokeTableView;

- (void)awakeFromNib {
[jokeTableView init];
}

- (id)initWithStyle:(UITableViewStyle)style {
if (self = [super initWithStyle:style]) {
    self.jokes = [NSMutableArray arrayWithObjects:
                  [Joke jokeWithValue:@"If you have five dollars     and Chuck Norris has five dollars, Chuck Norris has more money than you"],
                  [Joke jokeWithValue:@"There is no 'ctrl' button on Chuck Norris's computer. Chuck Norris is always in control."],
                  [Joke jokeWithValue:@"Apple pays Chuck Norris 99 cents every time he listens to a song."],
                  [Joke jokeWithValue:@"Chuck Norris can sneeze with his eyes open."],
                  nil];

    self.jokeTableView.rowHeight = 30.0;
    // self.jokeTableView.separatorStyle = UITableViewCellSeparatorStyleSingleLine;
    self.jokeTableView.sectionHeaderHeight = 0;
}
return self;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView { // Saying how many sections wanted (Just     like in address, where sorts by first name)
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView 
numberOfRowsInSection:(NSInteger)section {
return [jokes count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView 
     cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"Team";  
UITableViewCell *cell = 
[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] 
             initWithFrame:CGRectZero 
             reuseIdentifier:CellIdentifier] autorelease];
}
Joke *j = (Joke *)[jokes objectAtIndex:indexPath.row];
if( j )
    cell.text = j.joke;
return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
}

- (void)viewWillAppear:(BOOL)animated {
[super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated {
[super viewDidAppear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:
(UIInterfaceOrientation)interfaceOrientation {
return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (void)didReceiveMemoryWarning {
[super didReceiveMemoryWarning]; 
}

- (void)dealloc {
[jokes release];
[jokeTableView release];
[super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T07:25:21.247

如果您的视图控制器是从 nib 加载的，则需要覆盖该`initWithCoder:`方法，而不是`initWithStyle:`.

但是，通常的解决方案是在 awakeFromNib: 方法中添加所有自定义初始化代码，该方法在加载 nib 并连接所有插座后调用，因此它是进行所需初始化的好地方。

有关从 nib 进行对象实例化的详细信息，请参阅[Apple 文档。`awakeFromNib:`](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSNibAwaking_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/awakeFromNib)此外，如果您可以访问 3.0 beta 文档，请搜索`awakeFromNib:`，更新后的措辞可以更好地解释调用哪些方法以及何时调用。

PS 你不应该`[jokeTableView init]`在你的代码中调用，这将在 nib 解包时自动完成。

**编辑：**由于您正在从初始化代码中为表格视图设置属性，因此这绝对应该是 in `awakeFromNib:`，不是`initWithCoder:`or `initWithStyle:`。

查看屏幕截图，您可能还需要使用 Interface Builder 确保 UITableView 正确放置在视图控制器的 nib 文件中，并且创建视图控制器的代码（或 nib）引用了正确的 nib 文件- 如果只是表格视图的数据尚未加载，您会在空单元格之间看到灰线，而不仅仅是像该图像中那样的空白区域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T20:15:50.420

`initWithStyle`不一样`initWithCoder`。您的构造函数可能甚至没有被调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T20:24:11.180

我不知道这是否是您问题的原因，但随机`[jokeTableView init]`输入`awakeFromNib`肯定是错误的，可能会导致这样的问题。`init`不应该在没有附加`alloc`* 的情况下调用，在这种情况下，我怀疑是否需要任何一个，因为表视图可能已经在其他地方创建。

（* 很明显，这条规则的一个例外是当你重写一个 init 方法并调用 super 时。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T20:16:20.963

好吧，如果您正在使用初始化此控制器`initWithStyle`并且您之前正在调用`initWithCoder`，那是您的问题。

您正在加载您`self.jokes`的`initWithCoder`. 您应该将该代码移至`viewDidLoad`或移至新`initWithStyle`方法

```
// move this
self.jokes = [NSMutableArray arrayWithObjects:
                                  [Joke jokeWithValue:@"If you have five dollars and Chuck Norris has five dollars, Chuck Norris has more money than you"],
                                  [Joke jokeWithValue:@"There is no 'ctrl' button on Chuck Norris's computer. Chuck Norris is always in control."],
                                  [Joke jokeWithValue:@"Apple pays Chuck Norris 99 cents every time he listens to a song."],
                                  [Joke jokeWithValue:@"Chuck Norris can sneeze with his eyes open."],
                                  nil]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T17:00:18.497

摆脱这个：

```
- (void)awakeFromNib {
[jokeTableView init];
} 
```

你已经在做初始化`initWithStyle:`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T17:22:58.890

我认为主要问题是您需要更换：

```
- (id)initWithStyle:(UITableViewStyle)style {
    if (self = [super initWithStyle:style]) { 
```

（和右括号）

和

```
- (void)viewDidLoad { 
```

此外，您不必以 nil 结束 NSMutableArray。

# iphone - iPhone、地图、可点击的非矩形区域

> ID：870631
> 
> 赞同：6
> 
> 时间：2009-05-15T20:06:37.960
> 
> 标签：iphone, imagemap

有人对我如何在 iPhone 上实现以下功能有任何想法吗？我们有一张美国地图，它有不同颜色的不同区域（我相信气候区域）。它们不是矩形的，并且不遵循州、邮编、县或任何其他定义的线。所以，我们的区域非常圆，甚至不一定是连续的。

我很乐意让我们的用户能够点击他们的区域，我将能够告诉他们从哪里触摸到它是哪个区域，但是对于我的生活来说，没有制作很多很多矩形来做最适合的曲线，我不知道该怎么做。

有任何想法吗？

编辑：这些地区可能和这一样难…… [链接文本](http://www.usna.usda.gov/Hardzone/ushzmap.html)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T22:59:27.873

这些区域是如何定义的？如果您可以获取点数据，则使用以下命令创建 CGPath：

```
CGPathRef path = CGPathCreateMutable();
CGPathMoveToPoint(path,null,xpoints[0],ypoints[0])
for (int i = 1; i < numpoints; ++i) {
  CGPathAddLineToPoint(path,null,xpoints[i],ypoints[i]);
}
CGPathCloseSubpath(path); 
```

然后每当用户触摸时，对于每个区域，检查它是否包含触摸点：

```
if (CGPathContainsPoint(path,null,touchPoint,false)) ... 
```

完成区域后不要忘记发布：

```
CGPathRelease(path); 
```

请注意，您可以在一个 CGPathRef 中创建多个单独的子路径，当您检查是否包含时，它将检查所有子路径。

如果你愿意，你可以尝试使用弧线或曲线来使线条正确，但这是我不太熟悉的东西。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T17:24:22.697

也许您需要一个颜色编码的位图来进行命中测试。

您将要显示一个位图，但另一个位图具有单色编码区域。当用户单击显示图时，您会检查该像素在您的命中测试图中是什么颜色，然后执行适当的操作。

# vb.net - 覆盖 System.Diagnostics.Trace.WriteLine 以记录到文件

> ID：870634
> 
> 赞同：12
> 
> 时间：2009-05-15T20:07:15.183
> 
> 标签：vb.net, oop, logging, trace, diagnostics

这可能更像是一个 OOP 概念问题，但这就是我想做的。

我有一个使用 System.Diagnostics.Trace.WriteLine 输出调试信息的应用程序，因此可以使用 DebugView 查看它。

我想覆盖/扩展（不确定正确的术语）此方法以将文本记录到文件中，或者可能除了跟踪输出之外。这将允许我为我的应用程序编写一个新的 WriteLine 方法，并且我可以在整个应用程序的其余部分中保持所有其他 System.Diagnostics.Trace.WriteLine 语句不变。

那么我将如何在我的 VB.Net 应用程序中更改此方法的行为呢？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-15T20:14:35.930

您是否绝对致力于仍然使用 Trace？如果没有，我会使用功能更全面的日志系统，例如[Log4Net](http://logging.apache.org/log4net/index.html)。

但是，如果您真的想使用，`Trace`那么您可以重新配置文件中`TraceListener`使用的 s `app.config`。[`TraceListener`MSDN 文档](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener.aspx)给出了一个有点像这样的例子：

```
<configuration>
  <system.diagnostics>
    <trace autoflush="false" indentsize="4">
      <listeners>
        <add name="fileLogger" 
             type="System.Diagnostics.TextWriterTraceListener" 
             initializeData="LogFile.log" />
        <remove name="Default" />
      </listeners>
    </trace>
  </system.diagnostics>
</configuration> 
```

[`TextWriterTraceListener`](http://msdn.microsoft.com/en-us/library/system.diagnostics.textwritertracelistener.aspx)将日志转储到给定文件。（还有其他可用选项。）

或者，您可以以编程方式执行此操作：

```
Trace.Listeners.Add(new TextWriterTraceListener("foo.log")); 
```

请注意，您可能需要在应用退出之前显式刷新跟踪，方法是：

```
Trace.Flush(); 
```

或更复杂的：

```
foreach (TraceListener listener in Trace.Listeners)
{
    listener.Flush();
} 
```

（我只提到它是因为我在测试时必须这样做！）

*编辑：如评论中所述，如果您对每次*写入后刷新侦听器感到高兴（这样可以避免在最后刷新，但可能会损害性能），您可以设置[`Trace.AutoFlush`](http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.autoflush.aspx)为 true （包括在 XML 中 - 请参阅`autoflush`属性）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T20:15:31.730

您可以配置一个 TextWriterTraceListener 以将跟踪日志输出到文件。可以在 MSDN 上找到配置信息：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.textwritertracelistener(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.textwritertracelistener(VS.80).aspx)

您还可以转储到事件日志或各种其他地方以获取内置跟踪侦听器的列表，您可以在此处查看：

[http://msdn.microsoft.com/en-us/library/4y5y10s7(VS.80).aspx](http://msdn.microsoft.com/en-us/library/4y5y10s7(VS.80).aspx)

# security - 使用 PowerShell 和 WMI 读取安全日志

> ID：870648
> 
> 赞同：1
> 
> 时间：2009-05-15T20:10:04.847
> 
> 标签：security, powershell, wmi

我正在构建一个脚本来从多台计算机读取安全日志。使用 Get-EventLog 命令时，我可以毫无问题地从本地计算机读取安全日志，但问题是我无法在远程计算机上运行它（该脚本适用于 powershell v1）。下面的命令从不返回任何结果，尽管对于任何其他 LogFile，它都可以完美运行：

> gwmi -Class Win32_NTLogEvent | {$_.LogFile -eq“安全”}

我做了一些研究，我似乎是一个模拟问题，但是 Get-WmiObject 的 -Impersonation 选项似乎没有实现。反正有这个问题吗？解决方案可能是以某种方式在远程计算机上运行 Get-EventLog，或者处理模拟问题以便可以访问安全日志。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T21:54:08.297

您可以直接使用 .NET 而不是通过 WMI。下面的脚本块将为您提供安全日志中的第一个条目

```
$logs = [System.Diagnostics.EventLog]::GetEventLogs('computername')
$security = $logs | ? {$_.log -like 'Security'} 
$security.entries[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T16:55:31.780

您是否尝试过使用 -Credential 参数？此外，使用过滤器参数而不是 where-object，它只获取安全事件（where-object 从所有日志中获取所有事件，然后才执行过滤）

gwmi Win32_NTLogEvent -filter "LogFile='Security'" -computer comp1,comp2 -credential domain\user

# python - 将逗号分隔的数字分成对的 Pythonic 方法

> ID：870652
> 
> 赞同：17
> 
> 时间：2009-05-15T20:10:32.053
> 
> 标签：python, tuples

我想将逗号分隔值分成对：

```
>>> s = '0,1,2,3,4,5,6,7,8,9'
>>> pairs = # something pythonic
>>> pairs
[(0, 1), (2, 3), (4, 5), (6, 7), (8, 9)] 
```

#pythonic*会是什么样子*？

您将如何检测和处理具有奇数组的字符串？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-15T20:15:55.817

就像是：

```
zip(t[::2], t[1::2]) 
```

完整示例：

```
>>> s = ','.join(str(i) for i in range(10))
>>> s
'0,1,2,3,4,5,6,7,8,9'
>>> t = [int(i) for i in s.split(',')]
>>> t
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> p = zip(t[::2], t[1::2])
>>> p
[(0, 1), (2, 3), (4, 5), (6, 7), (8, 9)]
>>> 
```

如果项目数是奇数，则最后一个元素将被忽略。仅包含完整的配对。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-15T20:16:32.070

这个怎么样：

```
>>> x = '0,1,2,3,4,5,6,7,8,9'.split(',')
>>> def chunker(seq, size):
...     return (tuple(seq[pos:pos + size]) for pos in xrange(0, len(seq), size))
...
>>> list(chunker(x, 2))
[('0', '1'), ('2', '3'), ('4', '5'), ('6', '7'), ('8', '9')] 
```

这也将很好地处理不均匀的数量：

```
>>> x = '0,1,2,3,4,5,6,7,8,9,10'.split(',')
>>> list(chunker(x, 2))
[('0', '1'), ('2', '3'), ('4', '5'), ('6', '7'), ('8', '9'), ('10',)] 
```

PS我把这段代码藏起来了，我才意识到我从哪里得到的。stackoverflow 中有两个非常相似的问题：

*   [以块为单位迭代列表的最“pythonic”方式是什么？](https://stackoverflow.com/questions/434287/what-is-the-most-pythonic-way-to-iterate-over-a-list-in-chunks)
*   [如何在 Python 中将列表拆分为大小均匀的块？](https://stackoverflow.com/questions/312443/how-do-you-split-a-list-into-evenly-sized-chunks-in-python)

还有来自[食谱](http://docs.python.org/library/itertools.html#recipes)部分的这个宝石`itertools`：

```
def grouper(n, iterable, fillvalue=None):
    "grouper(3, 'ABCDEFG', 'x') --> ABC DEF Gxx"
    args = [iter(iterable)] * n
    return izip_longest(fillvalue=fillvalue, *args) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-15T20:29:28.873

一个更通用的选项，它也适用于迭代器并允许组合任意数量的项目：

```
 def n_wise(seq, n):
     return zip(*([iter(seq)]*n)) 
```

如果您想获得惰性迭代器而不是列表，请将 zip 替换为 itertools.izip。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-15T21:53:29.300

一个类似于 FogleBirds 的解决方案，但使用迭代器（生成器表达式）而不是列表推导。

```
s = '0,1,2,3,4,5,6,7,8,9'
# generator expression creating an iterator yielding numbers
iterator = (int(i) for i in s.split(','))

# use zip to create pairs
# (will ignore last item if odd number of items)
# Note that zip() returns a list in Python 2.x, 
# in Python 3 it returns an iterator
pairs = zip(iterator, iterator) 
```

列表推导和生成器表达式都可能被认为是“pythonic”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T20:20:54.447

这将忽略奇数列表中的最后一个数字：

```
n = [int(x) for x in s.split(',')]
print zip(n[::2], n[1::2]) 
```

这将在奇数列表中将较短的列表填充 0：

```
import itertools
n = [int(x) for x in s.split(',')]
print list(itertools.izip_longest(n[::2], n[1::2], fillvalue=0)) 
```

[izip_longest](http://docs.python.org/library/itertools.html#itertools.izip_longest)在 Python 2.6 中可用。

# c# - 对象到对象映射实用程序

> ID：870656
> 
> 赞同：5
> 
> 时间：2009-05-15T20:11:19.103
> 
> 标签：c#, .net, visual-studio, oop

我喜欢将公共对象和域*对象*（因此，nHibernate 不会在这里提供帮助）清晰地分开，这最终迫使我编写大量代码来将一个对象映射到另一个对象。有哪些工具/插件可以消除在 .NET 中手动执行此映射的繁琐工作？m 每当我用 Google 搜索时，它都会认为我想做 ORM，这*不是*我想要的。谢谢！

编辑 19:33CST：好的，我编写了一个非常基本的应用程序（非常快速编写的代码），它演示了我正在寻找的内容。我只是想知道是否有一个 VS 插件可以为我做到这一点。

[VS2008解决方案](http://waynehartman.com/downloads/OTOM.zip)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-15T20:12:50.240

您可能想尝试一下[AutoMapper](https://github.com/AutoMapper/AutoMapper)。这听起来像你在找什么。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-18T23:22:04.737

因此，似乎对运行时解决方案不满意，我编写了一个小实用程序，它将在代码中创建映射。您可以下载下面的源代码并编写更好的错误处理等。我很感激您所做的任何很酷的修改，这是匆忙做出的，但有效。请尊重代码是在[LGPL](http://www.gnu.org/licenses/lgpl.txt)下发布的。

[对象到对象映射实用程序源代码](http://waynehartman.com/download?file=d2333998-c0cc-4bd4-8f02-82bef57d463c)

**2009 年 6 月 23 日**更新：我对清理它的代码进行了一些更新（一点点），还添加了将映射保存到文件的功能，以便您以后可以修改它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T21:44:15.997

还有一个有趣的项目叫做[Otis](http://code.google.com/p/otis-lib/)。下面是从文档页面获取的示例 *.otis.xml 映射：

```
<?xml version="1.0" encoding="utf-8" ?> 
<otis-mapping xmlns="urn:otis-mapping-1.0">
<class name="Otis.Tests.UserDTO, Otis.Tests" source="Otis.Tests.Entity.User, Otis.Tests" >
    <member name="Id" />
    <member name="Age" />
    <member name="UserName" expression="$UserName.ToUpper()" nullValue="[unknown]" />
    <member name="FullName" expression="[$FirstName + ' ' + $LastName]" />
    <member name="ProjectCount" expression="$Projects.Count" />
    <member name="Title" expression="$Gender" >
        <map from="Gender.Male" to="Mr." />     <!-- projections -->
        <map from="Gender.Female" to="Mrs." />
    </member> 
    <member name="Birthday"  expression="$BirthDate" format="Born on {0:D}"/>
    <member name="ProjectCount" expression="$Projects.Count" />
    <member name="AvgTaskDuration" expression="avg:$Projects/Tasks/Duration" />
    <member name="MaxTaskDuration" expression="max:$Projects/Tasks/Duration" />             
</class> 
```

要从程序集中读取映射文件：

```
// configure the new Configuration object using metadata of types in the current assembly
Configuration cfg = new Configuration();            // instantiate a new Configuration, one per application is needed
cfg.AddAssembly(Assembly.GetExecutingAssembly());   // initialize it 
```

嗯，我以前在哪里见过？;)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-15T08:46:25.447

使用[ValueInjecter](http://valueinjecter.codeplex.com/)，你可以将任何东西映射到任何东西，例如

*   对象 <-> 对象
*   对象 <-> 表单/WebForm
*   数据读取器 -> 对象

它具有很酷的功能，例如：扁平化和非扁平化

# button - 用于创建 WPF“凝胶”按钮的 Microsoft 指南

> ID：870661
> 
> 赞同：2
> 
> 时间：2009-05-15T20:12:16.340
> 
> 标签：button, wpf-controls

任何人都知道我在哪里可以找到创建 WPF 凝胶型按钮的 Microsoft 指南？我不确定“凝胶”是否是这种效果的正确名称，但我听说很多人使用这个词。如果 MS 没有指南，您是否有其他一些标准或指南来创建这些按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T20:34:17.770

看看[玻璃按钮](http://blogs.conchango.com/johnrayner/archive/2006/12/22/WPF_2F00_E_3A00_-A-glass-button.aspx)。

> 有许多 XAML 元素构成了按钮。它们在 XAML 中有明确的注释，但列表如下：
> 
> *   阴影：一个椭圆，黑色渐变为透明的径向渐变
> *   按钮环绕：一个比绿色略大的白色椭圆
> *   黑色按钮背景：按下按钮时仅在绿色边缘可见
> *   主按钮颜色：按钮的绿色（或您想要的任何颜色）。这个椭圆被剪裁到它的初始轮廓，因此我们可以稍微移动椭圆以按下按钮而不与按钮周围重叠
> *   顶部发光：具有白色（顶部）渐变为透明的线性渐变背景的椭圆。小于主按钮颜色并定位为使顶部相同
> *   底部发光：一个与主按钮颜色大小相同的椭圆，但具有白色（在底部）的线性渐变背景，逐渐变为透明。这也根据主按钮颜色进行裁剪。
> *   悬停发光：与主按钮颜色大小相同的椭圆，具有白色的径向渐变背景（在椭圆的中心）逐渐变透明。这最初是透明的。
> *   用于捕捉鼠标事件的透明元素：在所有这些之上是一个透明椭圆，其大小与白色按钮周围的大小相同，用于捕捉 MouseEnter、MouseLeave、MouseLeftButtonDown 和 MouseLeftButtonUp 事件。此元素还包含用于脉动悬停效果的情节提要（尽管这可以在任何 XAML 元素中）。

# assemblies - 如何从我的 sln 获取 Assembly 版本到持续集成贴标机中？

> ID：870663
> 
> 赞同：2
> 
> 时间：2009-05-15T20:12:52.407
> 
> 标签：assemblies, continuous-integration, cruisecontrol.net

我想从我的解决方案中获取程序集版本并将其应用于 cc.net 标签。我想我是在倒退，因为那里的所有信息都有 CI 服务器设置版本。但我不确定如何将不同的发布版本和开发分支集成到 CI 中。每次发布时，我们都会增加修订号。我会/应该在 cc.net 中为每个分支添加一个新项目吗？有没有办法自动获取最新的分支？很抱歉在一个......问题中有这么多不同的问题。我是这个 CI 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T10:10:57.693

FinalBuilder 和 AssemblyInfo 更新程序

[更新：酷，不能添加超链接。将 FinalBuilder 和 3xw en dotcom 放在以下 url 前面：) /Products/FinalBuilder/FeatureMatrix/FeaturesCompilerActions/tabid/98/Default.aspx

1.  使用基于 .NET 程序集编号的“PropertySet 定义”
2.  使用“属性集加载”
3.  使用“PropertySet 增量”
4.  使用“AssemblyInfo Updater”再次保存

你完成了。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:21:10.517

如果您切换到[TeamCity](http://www.jetbrains.com/teamcity/) ，您会发现这一切变得容易得多。过去，我与这么多的 nant 脚本/巡航控制配置文件搏斗，我几乎从尖括号中失明。

当我开始弄乱 TeamCity 时，我哭得像看到第一个电子表格程序的会计师一样。它会让你的生活轻松 1000%。

# file - BizTalk：使用文件适配器删除接收位置上的“垃圾邮件”消息

> ID：870681
> 
> 赞同：0
> 
> 时间：2009-05-15T20:16:27.437
> 
> 标签：file, biztalk, spam, adaptor

我的客户有时会在他们的 BizTalk 文件放置位置收到“垃圾邮件”消息，即不是接收位置过滤器预期类型的​​文件，例如 .doc 而不是 .xls。文件适配器没有删除此类“垃圾”的选项 - 可能是有充分理由的 - 我们无法阻止这些文件的发送者偶尔发送它们。

我的解决方案是使用计划任务定期运行 powershell 脚本，该脚本将所有与接收位置过滤器不匹配的文件移动到一个文件夹，用户可以在其中检查文件，并删除任何“垃圾邮件”，从而防止文件夹从最终填满。

有没有更好的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T17:29:16.740

老实说，您几乎已经想出了最简单的解决方案 :) BizTalk 上没有任何东西可以真正帮助您避免此问题，因此任何其他选项都涉及为其添加自定义代码。

例如，您可以设置接收位置以选择文件 ( *.* )，然后使用自定义管道组件丢弃不需要的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T20:34:15.063

谢谢 tomasr。

如果“files”是 biztalk 放置文件夹，“spam”是垃圾邮件文件的文件夹，那么 PowerShell 的这一行会将所有非 csv 文件从“files”文件夹移动到“spam”文件夹。

目录 - 路径文件 - 排除 *.csv | move-item -dest 垃圾邮件

然后通过保存到 powershell 脚本并通过 Windows 系统任务调度程序运行来运行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T19:22:54.923

或者，您可以让接收位置查找所有文件并删除 BizTalk 无法处理的挂起消息。大概有人正在监视管理控制台。

# iphone - 理论上：alpha 分量是如何在 iPhone OS 中预乘到 PNG 的其他分量中的，如何正确地取消预乘？

> ID：870690
> 
> 赞同：3
> 
> 时间：2009-05-15T20:20:31.640
> 
> 标签：iphone, cocoa, png, core-graphics, png-24

实际上，我认为有一种简单的方法可以实现这一目标。我需要的是纯 alpha 值信息。为了进行测试，我有一个 50 x 55 像素的 PNG，其中每条边上都有一个 5x5 像素的矩形是完全透明的。在这些区域中，alpha 必须为 0。其他任何地方都必须为 255。我非常确定我的 PNG 是正确创建的，而且它看起来也正确。

请告诉我这在理论上是否正确：我创建了一个只有 alpha 通道而没有其他内容的 CGImageRef。这是使用 CGBitmapContextCreate 和 kCGImageAlphaOnly 作为参数完成的。CGBitmapContextGetBitsPerPixel(context) 返回 1，因此它表明我确实每个像素只有一个组件：所需的 alpha 值。我一直在阅读 CGBitmapContextCreate 将处理从给定图像到新创建的上下文的所有转换。我的图像以前是具有透明度的 PNG-24，但来自 Xcode 的 pngcrunch 似乎以某种方式转换它们。

所以，就理论上而言：此时我是否有机会获得正确的、未预乘的 alpha？我得到的值似乎几乎匹配，但在一个 5x5 的大透明正方形中，我得到的值是 19、197、210、0、0、0、98 等。如果它们是真的，我将不得不从图像中看到一些东西。图像本身是纯蓝色的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T01:19:48.020

预乘不影响 Alpha 通道，它会影响颜色通道。

光栅合成的公式（将一个光栅图像放在另一个上）是：

```
dst.r = src.r * src.a + dst.r * (1.0 - src.a);
dst.g = src.g * src.a + dst.g * (1.0 - src.a);
dst.b = src.b * src.a + dst.b * (1.0 - src.a); 
```

预乘去掉第一个乘法表达式：

```
dst.r = src.r′ + dst.r * (1.0 - src.a);
dst.g = src.g′ + dst.g * (1.0 - src.a);
dst.b = src.b′ + dst.b * (1.0 - src.a); 
```

这是因为源颜色分量已经乘以 alpha 分量——因此得名“预乘”。现在不需要将它们相乘，因为它已经有了结果。

> 未预乘的阿尔法

alpha 分量本身永远不会被预乘：你会将它乘以什么？*颜色*分量由*alpha*预乘。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T01:26:55.007

由于预乘颜色值很简单：

```
r = (r * a) / 255;
g = (g * a) / 255;
b = (b * a) / 255; 
```

得到逆将是：

```
if (a > 0) {
    r = (r * 255) / a;
    g = (g * 255) / a;
    b = (b * 255) / a;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T16:43:50.017

这个公式是不正确的。目标是找到未多路复用的 (r, g, b)，后者将导致相同的多路复用值（但是，不可能找到原始的 r、g、b 值。

但是，使用上面的公式，我们可以找到以下示例

```
alpha = 100
r_premulti = 1 
```

重构的 r = 2;

后面如果这个 r 再次被多路复用，我们会发现 2 * 100 / 255 = 0 但我们想要 r_premulti == 1 ！

正确的公式需要*四舍五入*。r 分量的示例：

```
reconstruced r = ceiling(r_premulti * 255 / alpha) 
```

# java - JAXB：如何注释类以使它们属于不同的名称空间？

> ID：870691
> 
> 赞同：10
> 
> 时间：2009-05-15T20:20:54.090
> 
> 标签：java, xml, namespaces, jaxb, urn

我想要有**JAXB 注释的**类，这些类将被编组/解组到**不同的 XML 命名空间**。

我需要的是这样的：

```
<someRootElement xmlns="urn:my:ns1"
    xmlns:a="urn:my:ns2" xmlns:b="urn:my:ns3">

  <someElement/>
  <a:someElement/>
  <b:someElement/>

</someRootElement> 
```

如何做呢？

可以以编程方式完成吗？（**不需要**JAXB 的**.xjb 绑定文件**？）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-15T21:09:23.410

```
@XmlRootElement(name="someRootElement", namespace = "urn:my:ns1")
class Test {
    @XmlElement(name="someElement", namespace="urn:my:ns1")
    String elem1 = "One";

    @XmlElement(name="someElement", namespace="urn:my:ns2")
    String elem2 = "Two";

    @XmlElement(name="someElement", namespace="urn:my:ns3")
    String elem3 = "Three";
} 
```

这编组为以下 XML：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<someRootElement xmlns="urn:my:ns1" xmlns:ns2="urn:my:ns2" xmlns:ns3="urn:my:ns3">
    <someElement>One</someElement>
    <ns2:someElement>Two</ns2:someElement>
    <ns3:someElement>Three</ns3:someElement>
</someRootElement> 
```

如果您使用 JAXB RI 并且不喜欢默认前缀`ns2`和`ns3`命名空间前缀，则需要提供自己的[`NamespacePrefixMapper`](https://jaxb.dev.java.net/jaxb20-ea3/docs/vendorProperties.html).

# c++ - C++ 指针名称

> ID：870695
> 
> 赞同：6
> 
> 时间：2009-05-15T20:21:29.190
> 
> 标签：c++, pointers

我了解指针用于指向对象，因此您必须在程序中使用相同的指针。但是指针名称是如何存储的。声明一个比它指向的对象占用更多资源的指针名称是否有点矫枉过正，例如：

```
int intOne = 0;
int *this_pointer_is_pointing_towards_intOne = &intOne; 
```

我知道这是一个荒谬的例子，但我只是想表达这个想法。

编辑：指针的名称必须存储在比指向对象的地址占用更多字节的地方。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-15T20:23:36.720

变量名的长度对程序的大小没有任何影响，只是编写程序所需的时间长度。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-15T20:30:51.477

只有编译器需要局部变量的名称才能找到要引用的变量。编译后，这些名称通常会被删除并完全替换为数字符号或等价物。对于实际上没有链接的所有名称都会发生这种情况（当然，如果您进行调试构建，情况可能会有所不同）。因此，函数参数也是如此。

例如，全局变量的名称不能被删除，因为您可能会在程序的另一个单元中使用它，并且链接器必须能够查找它。但是在你的程序被链接之后，甚至那些名字都可以被删除。

毕竟，这些并不占用运行时内存。这些名称存储在重新分配表中以进行链接（请参阅`strip`程序如何删除这些名称）。

但无论如何，我们谈论的是已经被对齐和诸如此类浪费的几个字节。将其与模板实例化的地狱般的名称进行比较。试试这个：

```
readelf -sW /usr/lib/libboost_*-mt.so  | awk '{ print length($0), $0 }' | sort -n 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-15T20:24:56.717

不存储指针名称。指针名称（或任何变量名称）不会编译到最终的二进制文件中（前提是您没有在符号设置为 on 的情况下进行编译）。

指针只是存储在内存中的整数（或长整数），反过来又指向它们在内存中某个位置指向的项目。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-15T20:23:15.003

Microsoft 使用“p”前缀来表示指针：

```
int intOne = 0;
int* pIntOne = &intOne; 
```

他们实际上在所有东西上都使用[匈牙利语](http://en.wikipedia.org/wiki/Hungarian_notation)。

一旦你习惯了它，它就会很好地工作。很多人一开始觉得很丑。

无论您决定什么，我认为在其名称中表示某事物是指针类型是很有价值的，尽管我不会像您的示例那样走得太远。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T22:04:11.673

我同意以前的帖子，但我想指出一些围绕它的东西。有时人们过度使用指针，认为它们的使用会自动提供较小的内存占用。这并非总是如此。考虑这段代码：

```
void myfunc(const char *var) {
    // Function body
} 
```

`char`在 32 位架构中，指向的指针将占用 4 个字节，而其`char`本身通常占用 1 个字节。（这里`var`假定指向单个字节，而不是字符串。）你明白这一点吗？另一方面，您应该始终对复杂对象使用指针（或引用）：

```
void myfunc(const string &str) {
    // Function body
} 
```

当然，如果您想修改函数内部的变量，您应该删除`const`关键字。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T10:43:17.307

我看不出为什么它应该放在任何东西之前。您的编译器/编辑器将为您完成这项工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-12-24T10:18:21.330

好吧，我明白你在这里问什么。记住变量名只影响文本文件的大小和你编写它所花费的时间。但请记住，变量名、指针名和函数名等都会在 GNU GCC 编译器翻译成机器代码时丢失。最后将存储在 .o 或 .exe 中的内容将是 0 和 1，因此您不必担心名称太大 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T20:23:57.467

井指针最常用于动态分配的事物和/或函数。

在动态分配的情况下，如果你坚持使用这个符号，你可以在它前面加上 ptr。在函数的情况下，乐趣也同样有效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T13:58:46.803

这里有两个关键点我想尝试提炼出来：

1.  变量名称的长度对最终编译的 C/C++ 程序中为数据分配的空间没有影响，因为编译器会为变量提供自己的名称。
    *   注意 一些编译器，尤其是较旧的编译器，可能只识别变量名的前几个字母，因此在源代码中包含非常长且过于复杂的变量名可能会导致冲突
    *   此外，如果您创建用于调试的符号文件，它们将包含所有变量名，因此会变得不必要地大，但这可能不会显着减慢调试速度，我从未检查过！
2.  存储指针所需的空间确实可能比所指向的数据所需的空间大，但在某些情况下您可能希望在任何情况下都使用它们。例如，在 COM 之类的架构中，函数只返回结果代码（成功或失败），所有更改的数据都是通过堆栈上传递的指针完成的：

    ```
    /*
        pszString 可能只指向一个字符
        空间小于指针
    */
    HRESULT OneLetterSplat(char * pszString)
    {
        *pszString = 'a';
        返回成功
    }

    ```

# c# - 无法将“System.DBNull”类型的对象转换为“System.String”类型

> ID：870697
> 
> 赞同：121
> 
> 时间：2009-05-15T20:22:08.687
> 
> 标签：c#, asp.net, database, null

我的应用程序出现上述错误。这是原始代码

```
public string GetCustomerNumber(Guid id)
{
     string accountNumber = 
          (string)DBSqlHelperFactory.ExecuteScalar(connectionStringSplendidmyApp, 
                          CommandType.StoredProcedure, 
                          "GetCustomerNumber", 
                          new SqlParameter("@id", id));
     return accountNumber.ToString();
 } 
```

我替换为

```
public string GetCustomerNumber(Guid id)
{
   object accountNumber =  
          (object)DBSqlHelperFactory.ExecuteScalar(connectionStringSplendidCRM, 
                                CommandType.StoredProcedure, 
                                "spx_GetCustomerNumber", 
                                new SqlParameter("@id", id));
    if (accountNumber is System.DBNull)
    {
       return string.Empty;
    }
    else
    {
       return accountNumber.ToString();
    }
} 
```

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2009-05-15T20:41:04.900

使用一个简单的通用函数，您可以轻松完成此操作。只需这样做：

```
return ConvertFromDBVal<string>(accountNumber); 
```

使用功能：

```
public static T ConvertFromDBVal<T>(object obj)
{
    if (obj == null || obj == DBNull.Value)
    {
        return default(T); // returns the default value for the type
    }
    else
    {
        return (T)obj;
    }
} 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2009-05-15T20:25:54.640

可以使用更短的形式：

```
return (accountNumber == DBNull.Value) ? string.Empty : accountNumber.ToString() 
```

编辑：没有关注 ExecuteScalar。如果返回结果中不存在该字段，它确实返回 null。所以改用：

```
return (accountNumber == null) ? string.Empty : accountNumber.ToString() 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-15T20:51:46.090

ExecuteScalar 将返回

*   如果没有结果集，则为 null
*   否则结果集第一行的第一列，可能是DBNull。

如果您知道结果集的第一列是一个字符串，那么要覆盖所有基，您需要同时检查 null 和 DBNull。就像是：

```
object accountNumber = ...ExecuteScalar(...);
return (accountNumber == null) ? String.Empty : accountNumber.ToString(); 
```

上面的代码依赖于 DBNull.ToString 返回一个空字符串这一事实。

如果 accountNumber 是另一种类型（比如整数），那么您需要更加明确：

```
object accountNumber = ...ExecuteScalar(...);
return (accountNumber == null || Convert.IsDBNull(accountNumber) ?     
         (int) accountNumber : 0; 
```

如果您确定您的结果集将始终至少有一行（例如 SELECT COUNT(*)...），那么您可以跳过对 null 的检查。

在您的情况下，错误消息“无法将 'System.DBNull' 类型的对象转换为 'System.String` 类型”表明结果集的第一列是 DBNUll 值。这是从第一行的强制转换到字符串：

```
string accountNumber = (string) ... ExecuteScalar(...); 
```

Marc_s 关于您不需要检查 DBNull.Value 的评论是错误的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-15T20:34:49.017

您可以使用 C# 的 null 合并运算符

```
return accountNumber ?? string.Empty; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-01T11:56:59.233

这是我用来转换任何可能是 DBNull.Value 的对象的通用方法：

```
public static T ConvertDBNull<T>(object value, Func<object, T> conversionFunction)
{
    return conversionFunction(value == DBNull.Value ? null : value);
} 
```

用法：

```
var result = command.ExecuteScalar();

return result.ConvertDBNull(Convert.ToInt32); 
```

更短：

```
return command
    .ExecuteScalar()
    .ConvertDBNull(Convert.ToInt32); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-08-31T17:43:07.043

还有另一种解决此问题的方法。如何修改您的存储程序？通过使用 ISNULL(your field, "") sql 函数，如果返回值为 null，则可以返回空字符串。

然后你有你的干净代码作为原始版本。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-15T20:27:40.640

我想你可以这样做：

```
string accountNumber = DBSqlHelperFactory.ExecuteScalar(...) as string; 
```

如果 accountNumber 为 null，则表示它是 DBNull 而不是字符串 :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-30T17:53:16.087

String.Concat 将 DBNull 和 null 值转换为空字符串。

```
public string GetCustomerNumber(Guid id)
{
   object accountNumber =  
          (object)DBSqlHelperFactory.ExecuteScalar(connectionStringSplendidCRM, 
                                CommandType.StoredProcedure, 
                                "spx_GetCustomerNumber", 
                                new SqlParameter("@id", id));

    return String.Concat(accountNumber);

 } 
```

但是，我认为您在代码可理解性方面失去了一些东西

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-28T14:21:17.360

由于我得到了一个不为空的实例，并且如果我与 DBNULL 进行比较，我得到了`Operator '==' cannot be applied to operands of type 'string' and 'system.dbnull'`例外，并且如果我尝试更改为与 NULL 进行比较，它根本不起作用（因为 DBNull 是一个对象），即使这是公认的答案。

我决定简单地使用'is'关键字。所以结果非常可读：

`data = (item is DBNull) ? String.Empty : item`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-21T16:05:42.887

基于@rein 的回答

```
public static class DbDataReaderExtensions
{
    public static TObjProp Get<TObj, TObjProp>(
        this DbDataReader reader,
        Expression<Func<TObj, TObjProp>> expression)
    {
        MemberExpression member = expression.Body as MemberExpression;
        string propertyName = member.Member.Name;

        //PropertyInfo propInfo = member.Member as PropertyInfo;

        var recordOrdinal = reader.GetOrdinal(propertyName);
        var obj = reader.GetValue(recordOrdinal);

        if (obj == null || obj == DBNull.Value)
        {
            return default(TObjProp);
        }
        else
        {
            return (TObjProp)obj;
        }
    }
} 
```

鉴于：

```
public class MyClass
{
    public bool? IsCheckPassed { get; set; }
} 
```

用于：

```
var test = reader.Get<MyClass, bool?>(o => o.IsCheckPassed); 
```

或者，如果您在异常方法中对类类型进行硬编码：

```
var test = reader.Get(o => o.IsCheckPassed); 
```

*ps我还没有想出如何在`generics`不牺牲代码长度的情况下进行隐式..免费评论和建议改进*

完整示例：

```
public async Task<MyClass> Test(string connectionString) {
    var result = new MyClass();

    await using var con = new SQLiteConnection(connectionString);
    con.Open();

    await using var cmd = con.CreateCommand();
    cmd.CommandText = @$"SELECT Id, IsCheckPassed FROM mytable";

    var reader = await cmd.ExecuteReaderAsync();
    while (reader.Read()) {
        // old, not working! Throws exception!
        //bool? isCheckPassed1 = reader.GetBoolean(reader.GetOrdinal("IsCheckPassed"));

        // old, working, but too long (also if you have like 20 properties then all the more reasons to refactor..)
        bool? isCheckPassed2 = null;
        bool? isCheckPassed2Temp = reader.GetValue(reader.GetOrdinal("IsCheckPassed"));
        if (isCheckPassed2Temp != null && isCheckPassed2Temp != DBNull.Value)
            isCheckPassed2 = (bool?)isCheckPassed2Temp;

        // new
        var isCheckPassed3 = reader.Get<MyClass, bool?>(o => o.IsCheckPassed);
        // repeat for 20 more properties :)

        result.IsCheckPassed = isCheckPassed3;
    }

    return result;
} 
```

只要表列名称与类的属性名称匹配，解决方案就可以工作。并且可能不是生产级性能，因此使用或修改需要您自担风险:)

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-07-21T14:35:50.483

我使用扩展来为我消除这个问题，这可能是也可能不是你所追求的。

它是这样的：

```
public static class Extensions
{

    public String TrimString(this object item)
    {
        return String.Format("{0}", item).Trim();
    }

} 
```

## 笔记：

此扩展**不**返回`null`值！如果项目是`null`或*DBNull.Value*，它将返回一个空字符串。

## 用法：

```
public string GetCustomerNumber(Guid id)
{
    var obj = 
        DBSqlHelperFactory.ExecuteScalar(
            connectionStringSplendidmyApp, 
            CommandType.StoredProcedure, 
            "GetCustomerNumber", 
            new SqlParameter("@id", id)
        );
    return obj.TrimString();
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2017-02-21T00:45:52.540

像这样转换

```
string s = System.DBNull.value.ToString(); 
```

# linq - linq 多列；得到奇怪的结果

> ID：870698
> 
> 赞同：0
> 
> 时间：2009-05-15T20:22:23.087
> 
> 标签：linq

所以 m.SourceCollection 有 1000 条记录进入这里，这是具有 Lat 和 Lon 属性的项目集合；没有其他的。我运行这个：

```
var results = from locs in m.PlacesBeen
                      group locs by new {locs.Lat, locs.Lon }
                          into myGroup
                           select new { Lat = myGroup.Key.Lat, Lon = myGroup.Key.Lon }; 
```

下一个断点“结果”包含三个项目。我只是想进行分组并获得唯一的金额，就像我在 SQL 中所做的那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T07:02:54.310

That query looks OK - what results were you expecting?

Btw, here's a simpler way to write the same query:

```
var results = 
  m.PlacesBeen.Select (loc => new {locs.Lat, locs.Lon }).Distinct(); 
```

# java - 何时使用 View Preparer for Tiles

> ID：870699
> 
> 赞同：4
> 
> 时间：2009-05-15T20:22:49.590
> 
> 标签：java, jsp, tiles

我是 JSP 和 Tiles 以及 Java 的新手。我们目前正在使用这些重新构建我们的网站，但我很困惑什么时候应该将某些东西放入视图准备器而不是来自控制器。

例如，我正在处理的当前页面将有一个用于分页的图块，包括内容类型（X of Y 内容类型）。我最初的计划是使用 View Preparer 来获取控制器（HashMap）发送的数据并为分页图块输出几个属性，但一位同事告诉我这应该在控制器中完成。

如果是这种情况，View Preparer 的意义何在？我只是有点困惑。我检查了 Tiles 文档，它们非常基本/无法使用。

有人可以给我一个 View Preparer 的正确用例吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T22:18:30.360

控制器用于执行业务或事务逻辑。也就是说，为了响应用户操作，应用程序需要执行一个或多个操作，然后决定呈现哪个视图。这就是为什么它被称为控制器，因为它“控制”应用程序的流程。随着控制器执行其工作，对数据的更改必须对用户可见。然而，准备显示的数据不是控制器的工作。只需确保已完成必要的操作并且数据可用。

视图，在这种情况下是您的 jsp 页面，然后将获取数据并显示它。据我了解，视图准备器可帮助您将视图的某些方面考虑在内，以便准备器可以完成可能必须在多个不同视图中完成的准备工作。

因此，准备菜单的文档中的示例是一个很好的用例。菜单有时是动态的，从某种意义上说，它取决于系统的状态，究竟向用户显示什么。假设您想在用户未登录时在菜单中显示登录链接，并在用户登录时从菜单中删除该链接。而不是将逻辑编码到必须显示菜单的每个页面中可以使用 ViewPreparer 生成实现任何必要逻辑的菜单。然后，该 View Preparer 可以与多个页面相关联。

更多地将其视为操纵数据以供查看而不是业务逻辑。

# ping - 有什么办法可以“ping”一个电话号码？

> ID：870701
> 
> 赞同：5
> 
> 时间：2009-05-15T20:23:06.767
> 
> 标签：ping, phone-number

我们有一个客户想要通过他们的 CRM 数据库并以某种方式确定有效的电话号码，而实际上没有人坐在那里尝试给他们打电话。

有没有办法在电话号码（包括固定电话）上做类似于“ping”的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T20:26:59.910

您将需要通过第三方。我已经使用 Melissa 数据进行地址验证并取得了很好的效果，他们还提供电话验证，但我没有使用它

[http://www.melissadata.com/listservices/resphoneverify.htm](http://www.melissadata.com/listservices/resphoneverify.htm)

如果获得 100% 正确的电话号码至关重要，我会研究一项服务，该服务实际上会拨打该号码，提供验证码并让用户与网站确认该代码。从用户的角度来看，这是一个 PIA，但这是您可以采取的最完整的路线。快速搜索了一下这个网站，[http:](http://www.phoneconfirm.com) //www.phoneconfirm.com 似乎与我提到的一样。我相信还有其他人。

如果你不能/不想通过第三方，我无法想象自己写这样的东西是不可能的。扩大规模将是最大的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:48:09.100

我相信使用基于 ISDN 呼叫的服务的 CTI 系统可以在目的地开始响铃之前快速返回该号码有效/无效的状态代码。

一个供应商是 Katalina 系统，他们的产品称为 VoiceGuide，他们有一个拨出模块，可以为您提供您想要的。请参阅 www.voiceguide.com。

只需将呼叫列表导出到拨号器（csv 文件），并在处理后查看呼叫状态。

如果列表非常大，则可能有理由购买一个系统来执行此操作。呼叫速率取决于安装/可用的线路数量。在获取状态后，您可能需要进行一些自定义修改才能中止调用。Katalina 应该能够提供帮助。我不确定 VoIP 中继是否可以让您完全访问线路状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:33:01.003

总是可以搭配好的老[战争拨号器](http://en.wikipedia.org/wiki/War_dialing)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T00:09:02.790

我曾经做过类似的事情。是的，对于电话推销员。是的，它至今仍困扰着我的良心。

它基于一个名为 app_amd.c（应答机检测）的模块，该模块是 Asterisk 的第三方插件，AFAIK 现在可以在其主树中找到。使用 E1/T1，您还可以区分坏号码、忙碌和许多其他状态代码。看看这个，可能有帮助。

# multithreading - 如何使用 pthreads 在平台上进行异步线程间通信

> ID：870709
> 
> 赞同：1
> 
> 时间：2009-05-15T20:24:38.590
> 
> 标签：multithreading, unix, asynchronous

例如，在 Windows 上，有 MsgWaitForMultipleObjects 可以让您异步等待 Windows 消息、套接字事件、异步 io (IOCompletionRoutine) 和互斥体句柄。

在 Unix 上，你有选择/轮询，除了当一些 pthread_mutex 被解锁时，它给你提供了一切的可能性。

故事：

我有一个应用程序，它的主线程可以处理多个套接字、管道或文件。现在有时会有一个可能需要更长时间的副业（数据库事务），如果在主线程中同步完成会破坏套接字的正常服务。所以我想在单独的线程中进行 db 操作。该线程将在空闲时等待某个互斥锁，直到主线程决定给它一些工作并解锁互斥锁，以便 db 线程可以抓住它。问题是 db 线程如何通知主线程它已经完成了工作。主线程必须处理套接字，因此它不能在 pthread_mutex_lock 中休眠。定期做 pthread_mutex_trylock 是我想做的最后一个。目前我考虑使用管道，但这是更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T20:33:52.373

在这里使用管道是个好主意。确保没有其他进程打开管道的写端，然后在主线程中选择（）或轮询（）读端进行读取。一旦您的工作线程完成工作，请关闭（）写入结束。主线程中的 select() 立即唤醒。

我不认为等待互斥体和其他东西是可能的，因为在 Linux 上，互斥体是通过不支持文件描述符的 futex(2) 系统调用实现的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:30:12.100

我不知道它如何适用于您的具体问题，但 posix 有[message queues](http://linux.die.net/man/7/mq_overview)。

# c# - 产量/迭代器极端情况

> ID：870715
> 
> 赞同：1
> 
> 时间：2009-05-15T20:26:37.693
> 
> 标签：c#

在这篇文章（[http://blogs.msdn.com/oldnewthing/archive/2008/08/13/8854601.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/08/13/8854601.aspx)）上，有一个关于迭代器的流行问题和一个关于极端情况的问题：

> 练习：考虑以下片段： foreach (int i in CountTo100Twice()) { ... }
> 
> 解释在上述循环中第 150 次调用 MoveNext() 时会发生什么。讨论它对递归枚举器的影响（例如树遍历）。

我没有运行此代码，但我假设这是一个问题，应该是文章的答案（下面提供的所有链接），但我无法在文章或评论中共享的知识中找到答案对于这篇特定的文章。

有谁知道答案是什么？还有哪些其他角落案例？

1) [http://blogs.msdn.com/oldnewthing/archive/2008/08/12/8849519.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/08/12/8849519.aspx)

2) [http://blogs.msdn.com/oldnewthing/archive/2008/08/13/8854601.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/08/13/8854601.aspx)

3) [http://blogs.msdn.com/oldnewthing/archive/2008/08/14/8862242.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/08/14/8862242.aspx)

4) [http://blogs.msdn.com/oldnewthing/archive/2008/08/15/8868267.aspx](http://blogs.msdn.com/oldnewthing/archive/2008/08/15/8868267.aspx)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:32:06.973

一些东西。

(1) 乔恩当然是正确的；问题是像这样的嵌套迭代器为您提供了迭代器逻辑的调用堆栈。如果您正在迭代一个深度递归定义的数据结构，这可能会破坏堆栈，并且有一些简单的方法可以将应该是线性算法的东西变成二次算法。有关详细信息，请参阅 Wes 的文章。

(2) 我们可以在没有性能问题的语言中构建一种新的迭代器逻辑。我很想实现这一点，但现在它不是一个足够高的优先级。如果您对如何执行此操作的技术细节感兴趣，请阅读[本文](http://citeseer.ist.psu.edu/cache/papers/cs2/355/http:zSzzSzwww.cs.kuleuven.ac.bezSz~frankzSzPAPERSzSzFTfJP2005.pdf/iterators-revisited-proof-rules.pdf)。

(3) 角落案例多；已经提到的（延迟执行边界检查和延迟执行 finally 块）是最常见的两个。不幸的是，在许多版本的 C# 中，代码生成器中存在会加剧后一个问题的错误。假设你有 try { try { ... yield ... } finally { X() } } finally { Y() } - 有一些奇怪的情况你可能会遇到我们生成的代码在 X 之前意外调用 Y() () 在清理路径上，这显然是错误的。我们已经为服务包修复了这些问题，但如果您发现其他问题，请告诉我。

(4) There are also some extant extremely obscure bugs involving the exact behaviour of the iterator when doing crazy things like a yield break out of a finally which then branches to an outer finally which does a second, redundant yield break. Again, if you happen to find bizarre-behaving iterators, feel free to bring them to my attention.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T20:37:28.573

我怀疑他*可能*指的是这样一个事实，即每次调用都会`MoveNext()`调用一个状态机，而该状态机又会调用`MoveNext()`另一个状态机，这使得它的效率有点低。

[这是Wes Dyer](http://blogs.msdn.com/wesdyer/archive/2007/03/23/all-about-iterators.aspx)和[Eric Lippert](http://blogs.msdn.com/ericlippert/archive/2007/12/19/immutability-in-c-part-seven-more-on-binary-trees.aspx)的博客。

我要说的迭代器块的主要极端情况*是*在第一次调用`MoveNext()`. 所以这个方法：

```
public IEnumerable<string> ReadLines(string file)
{
    if (file == null)
    {
        throw new ArgumentNullException("file");
    }
    using (TextReader reader = File.OpenText(file))
    {
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            yield return line;
        }
    }        
} 
```

在您开始迭代之前实际上不会抛出异常。相反，您需要编写如下内容：

```
public static IEnumerable<string> ReadLines(string file)
{
    if (file == null)
    {
        throw new ArgumentNullException("file");
    }
    return ReadLinesImpl(file);
}

public static IEnumerable<string> ReadLinesImpl(string file)
{
    using (TextReader reader = File.OpenText(file))
    {
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            yield return line;
        }
    }        
} 
```

再一次，埃里克在博客上写了这个：[第 1](http://blogs.msdn.com/ericlippert/archive/2007/09/05/psychic-debugging-part-one.aspx)部分，[第 2 部分](http://blogs.msdn.com/ericlippert/archive/2007/09/06/psychic-debugging-part-two.aspx)。我也在博客上写了一个[让生活更轻松的建议](http://msmvps.com/blogs/jon_skeet/archive/2008/03/02/c-4-idea-iterator-blocks-and-parameter-checking.aspx)，尽管我怀疑它会不会有任何结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:48:14.490

`try..finally`当您考虑导数`using`和`lock`语句时，会发生一个有趣的带有 yield/iterators的极端情况。考虑上面发布的迭代器块 Jon Skeet：

```
public IEnumerable<string> ReadLines(string file)
{
    if (file == null)
    {
        throw new ArgumentNullException("file");
    }
    using (TextReader reader = File.OpenText(file))
    {
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            yield return line;
        }
    }        
} 
```

`foreach`如果您通过手动调用`MoveNext()`几次在a 的上下文之外使用此迭代器块并且您**从未**完成迭代，那会发生什么`using`？答：永远不会调用的部分`finally`，`using`因此永远不会调用并且永远不会关闭打开的文件。同样，假设被替换为。永远不会调用的部分永远不会释放对象上的锁。`Dispose``TextReader``using``lock(something)``finally``lock`

**教训**：始终避免`try..finally`在迭代器块中使用和它的派生词。

# .net - 我的堆是碎片化的吗

> ID：870723
> 
> 赞同：9
> 
> 时间：2009-05-15T20:28:35.177
> 
> 标签：.net, memory, windbg, heap-fragmentation

```
0:000> !dumpheap -stat
total 1755874 objects
Statistics:
MT    Count    TotalSize Class Name
7b9b0c64        1           12 System.Windows.Forms.Layout.TableLayout+ColumnSpanComparer
....
7933303c    14006      4926456 System.Collections.Hashtable+bucket[]
65246e00      804      4982192 System.Data.RBTree`1+Node[[System.Int32, mscorlib]][]
054c55f0    44240      5662720 DevExpress.Utils.AppearanceObject
793040bc    98823      7613156 System.Object[]
793308ec   293700     55820016 System.String
002435f0    50315    138631888      Free
Total 1755874 objects

Fragmented blocks larger than 0.5 MB:
    Addr     Size      Followed by
15a195c8    0.8MB         15ae3950 System.Collections.ArrayList
15d81468    1.6MB         15f23708 System.String
15f23984    1.0MB         16029ae4 System.String
... about 7 more objects here
1ee51764    0.5MB         1eedbaa4 System.WeakReference
1f0df96c    2.4MB         1f34d4b0 System.String
1f3e1ca8    3.7MB         1f79afc4 System.WeakReference 
```

我一直在阅读有关固定和碎片的信息。考虑到大量的可用空间，它在我看来是支离破碎的。我想我现在必须追查它。

想法？回馈？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T19:37:33.147

所以......我们知道我们有一个碎片堆。下一个问题是：是什么导致了碎片化？是什么阻止了这些自由对象被释放？我读过的建议是在可用空间之后检查对象：

1.  !dumpheap -stat

2.  转储Free对象的方法表：!dumpheap -mt 000db8e8

3.  从列表中选择一个自由对象进行更仔细的检查：!dumpobj 0x2003b0b0

4.  记录对象的大小

5.  转储它之后的下一个对象：!dumpobj 0x2003b0b0+1000

6.  找到持有引用的对象！gcroot 0x2003b0b0+1000

7.  转储找到的对象的 gchandle。

我通常会钻进这个兔子洞，而我对 .NET API 的有限知识在这里失败了。这是调试问题的正确方法吗？

杰夫

# vba - 需要VB让Excel在后台实时计算表格或范围

> ID：870727
> 
> 赞同：1
> 
> 时间：2009-05-15T20:31:22.987
> 
> 标签：vba, excel

如何让 excel 实时连续计算工作表/范围（不是 1 计算/秒）并在后台执行？

我希望这个公制时钟像秒表一样运行......

> `=IF(LEN(ROUND((HOUR(NOW())*(100/24)),0))=1,"0"&ROUND((HOUR(NOW())*(100/24)),0),ROUND((HOUR(NOW())*(100/24)),0))&":"&IF(LEN(ROUND((MINUTE(NOW())*(100/60)),0))=1,"0"&ROUND((MINUTE(NOW())*(100/60)),0),ROUND((MINUTE(NOW())*(100/60)),0))&":"&IF(LEN(ROUND((SECOND(NOW())*(100/60)),0))=1,"0"&ROUND((SECOND(NOW())*(100/60)),0),ROUND((SECOND(NOW())*(100/60)),0))`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T21:51:09.300

我认为这可能不符合您的“（不是 1 计算/秒）”标准，但我实现了如下类似的结果。假设您的公式位于名为 Sheet1 的工作表的单元格 A1 中。

在 ThisWorkbook 代码模块中：

```
Private Sub Workbook_Open()
    Application.OnTime Now + TimeValue("00:00:01"), "RecalculateRange"
End Sub 
```

...并在常规代码模块中：

```
Public Sub RecalculateRange()
    Sheet1.Range("A1").Calculate
    Application.OnTime Now + TimeValue("00:00:01"), "RecalculateRange"
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T22:02:56.077

我使用以下内容来产生您正在寻找的效果：

```
Option Explicit

Public TimerRunning As Boolean
Dim CalculationDelay As Integer

Public Sub StartStop_Click()
    If (TimerRunning) Then
        TimerRunning = False
    Else
        TimerRunning = True
        TimerLoop
    End If
End Sub

Private Sub TimerLoop()
    Do While TimerRunning
        '// tweak this value to change how often the calculation is performed '
        If (CalculationDelay > 500) Then
            CalculationDelay = 0
            Application.Calculate
        Else
            CalculationDelay = CalculationDelay + 1
        End If
        DoEvents
    Loop
End Sub 
```

`StartStop_Click`是我绑定到秒表的开始/停止按钮的宏。您可以根据 的值将其名称更改为“开始”或“停止” `TimerRunning`，但我保持简单以说明概念。

这里的两个关键是：

```
Application.Calculate 
```

这会强制 Excel 计算工作表，并且：

```
DoEvents 
```

这允许 VBA 在后台运行（即 Excel 不会停止响应用户输入）。这就是即使计时器正在运行，您仍然可以按下“停止”按钮的原因。

# xml - XML 元素唯一 ID 架构表示

> ID：870730
> 
> 赞同：1
> 
> 时间：2009-05-15T20:32:15.153
> 
> 标签：xml, schema-design

我的 XML 看起来像这样：

```
<company>
  <employee id="1">Larsen</employee>
  <employee id="2">Smith</employee>
  <employee id="3">Sam</employee>
</company> 
```

如何编写 xml 模式，以便定义员工元素，使每个员工都有一个唯一的 id 属性（没有两个员工元素可以具有相同的 id 属性值）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T20:38:21.347

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="XMLSchema1"
    elementFormDefault="unqualified" attributeFormDefault="qualified"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <xs:element name="root">
    <xs:complexType>
      <xs:sequence>
      <xs:element name="employee" minOccurs="0" maxOccurs="unbounded">
        <xs:complexType>
          <xs:attribute name="ID" type="xs:string" />
        </xs:complexType>

      </xs:element>
      </xs:sequence>
    </xs:complexType>
    <xs:unique name="EmployeeIDKey">
      <xs:selector xpath="./employee" />
      <xs:field xpath="@ID" />
    </xs:unique>
  </xs:element>
</xs:schema> 
```

编辑：为你加强了一点。

# shared-hosting - 共享托管网站可以扩展到多少用户？

> ID：870741
> 
> 赞同：0
> 
> 时间：2009-05-15T20:33:24.807
> 
> 标签：shared-hosting, shared

我计划托管 3 或 4 个 WCF/.NET 3.5 REST Web 服务，供新的 iPhone 应用程序使用。

[我听说过关于 DiscountASP.NET ( http://www.discountasp.net/index.aspx](http://www.discountasp.net/index.aspx) )的好评，但我对共享主机性能一无所知。同时，我认为每月支付 90 美元购买可扩展的 Amazon EC2 服务器实例还为时过早。

那么，知道共享托管网站每月可以处理多少点击吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T21:07:49.063

这取决于您的共享主机有多好。要确定同时使用的用户，您可以尝试通过多次请求来对服务器的性能进行基准测试。

如果他们看到您使用大量 cpu，您的主机可能会对您大喊大叫。对于 Web 服务，带宽不是问题，而是您的 CPU/内存可用性。

您应该更关注同时用户数，而不是每月点击数。您希望能够处理任何流量高峰。共享主机的可预测性较差，因为您无法控制机器上其他用户的使用情况。

我想说，如果您刚开始，共享主机可能会很好，只需监控它并在您看到响应时间减少时进行升级。当您影响服务器上其他所有人的性能时，您的主机可能会通知您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:37:55.857

他们都是不同的。这取决于他们给你多少带宽。（GB/月是一个典型的指标）。

我会说每月的点击量可能在几十万的范围内，而不会在许多托管主机上造成重大问题。这完全取决于您的 WCF 服务的强度。优点是许多托管托管设施将允许您为您的站点动态添加更多托管功能。（显然是为了更多的美元）。

# javascript - 是否可以断开 Dojo 中的所有事件处理程序？

> ID：870750
> 
> 赞同：0
> 
> 时间：2009-05-15T20:36:50.993
> 
> 标签：javascript, memory-leaks, dojo

我正在使用的一些代码将一些具有 Dojo 事件侦听器的 HTML 元素替换为来自 AJAX 调用的新 HTML（使用 .innerHTML=）。我已经读过事件侦听器应该在被替换之前使用 dojo.disconnect(handle) 方法断开连接以防止内存泄漏。

是否可以派生连接到特定元素的所有句柄，以便我可以将每个句柄传递给 .disconnect(handle)，还是由我在代码中维护此列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T21:03:34.347

实际上，如果您使用小部件，他们通常应该在 tehir destroy() 方法中断开连接。如果您自己处理节点，我看到您可以采用两种方法。

1）手动管理所有连接，意味着将它们存储在某个地方。2）可能更安全：将所有连接处理程序存储在它们连接的节点中，如下所示：

```
node._connectHandlers = [];
node._connectHandlers.push(dojo.connect(node, "onclick", ...)); 
```

稍后您可以使用简单地将它们全部断开

```
dojo.query("*", nodeContainingConnects).forEach(function(node){
    if (typeof node._connectHandlers!="undefined"){
        dojo.forEach(node._connectHandlers, "dojo.disconnect(item)");
    }
}); 
```

实际上，这可能效果很好，但可能有一种更有效的方法来通过节点获取所有连接。我只是没找到。hth

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-08T21:41:41.957

按照 Wolfram Kriesing 的回答，这可以“改进”：

```
dojo._connect_tmp = dojo.connect;
dojo.connect = function (obj, event, context, method, dontFix) {
    if(obj._connectHandlers == undefined){ obj._connectHandlers = [];}
    var handler = dojo._connect_tmp (obj, event, context, method, dontFix);
    obj._connectHandlers.push(handler);
    return handler;
};

dojo.iwanttobefree = function (obj) {
   if(obj._connectHandlers == undefined) {
   } else {
      dojo.forEach(obj._connectHandlers, "dojo.disconnect(item)");  
   }
}; 
```

然后你可以这样做：

```
dojo.connect(myObj, 'onfocus', function(){alert('weee')});
dojo.iwanttobefree(myObj); 
```

由于多种原因，替换 dojo 代码可能非常非常难看，所以也许您想创建自己的命名空间。

# iphone - 如何在屏幕上绘制 CGImageRef 上下文？

> ID：870751
> 
> 赞同：1
> 
> 时间：2009-05-15T20:36:53.457
> 
> 标签：iphone, uikit, core-graphics

我有一个漂亮的 CGImageRef 上下文，我创建了一整天来获取 alpha 值；）

它是这样定义的：

```
CGContextRef context = CGBitmapContextCreate (bitmapData, pixWidth, pixHeiht 8, pixWidth, NULL, kCGImageAlphaOnly); 
```

因此，就我的理解而言，这种背景以某种方式代表了我的形象。但是“实际上”，在内存中的某个地方不可见。

我可以将其填充到 UIImageView 中或直接将其绘制到屏幕上吗？我猜阿尔法会被转换成灰度或类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T23:51:10.137

去看看`CGBitmapContextCreateImage()`，它可以从你的位图上下文中给你一个 CGImageRef。然后，您可以使用 CGContext... 函数绘制它或使用`+[UIImage imageWithCGImage:]`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T21:25:36.850

`UIImage`您可以通过调用创建一个：

`+ (UIImage *)imageWithCGImage:(CGImageRef)cgImage`

然后绘制`UIImage`使用：

`- (void)drawAtPoint:(CGPoint)point`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T22:46:14.207

```
CGSize size = ...;
UIGraphicsBeginImageContext(size);
...
UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
...
CGPoint pt = ...;
[img drawAtPoint:pt]; 
```

# .net - DataGridView 在 DateTime 列中使用空值进行排序

> ID：870752
> 
> 赞同：4
> 
> 时间：2009-05-15T20:37:06.030
> 
> 标签：.net, winforms, datagridview

我在 Windows 窗体应用程序中有一个 DataGridView 控件。有四列是字符串数据，三列是日期时间数据。我正在使用 Rows.Add() 方法以编程方式添加行。所有列的 SortMode 都设置为 Automatic。单击列标题进行排序只是工作，除了一个包含一些空值的 DateTime 列。当用户单击该列的标题时，它会引发 ArgumentException：对象必须是 DateTime 类型。

我知道解决这个问题的艰难方法：将所有 SortModes 设置为 NotSortable，处理 ColumnHeaderMouseClick 事件并手动对整个事情进行排序。我正在寻找简单的方法。

是否有一个属性或我可以设置的东西，或者其他一些相对简单的方法来允许该列在其中使用空值进行排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-02T12:04:19.037

一个简单的解决方案是添加一个“tonull”函数，每次进行比较时运行 e.cellvalue1 和 2。如果值为“”，则单元格的值将更改为 01/01/1001，如果您希望空值首先出现在排序中，或者 01/01/3001 或者如果您希望它们出现在最后，则单元格的值将更改为高得离谱排序。

```
Private Sub dgvTable_SortCompare(ByVal sender As Object, ByVal e As DataGridViewSortCompareEventArgs) Handles dgvTable.SortCompare

    If e.Column.Index = 4 Then

        e.SortResult = System.DateTime.Compare(todatenull(e.CellValue1), todatenull(e.CellValue2))

    End If

    e.Handled = True
End Sub

Function todatenull(ByVal cellvalue)
    If cellvalue = "" Then
        Return "01/01/1001"
    Else
        Return cellvalue
    End If
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T16:18:06.653

这是我想出的解决方案。DataGridView 引发一个 SortCompare 事件，您可以使用该事件来输入自定义排序。我正在处理该事件并使空值排序高于非空值（您可以轻松地使空值低于非空值）。这是VB代码。我假设每个单元格值都是 IComparable （如果不是，它将由正常的错误处理逻辑处理。）

```
Try
    If e.CellValue1 Is Nothing OrElse e.CellValue1.Equals(DBNull.Value) Then
        If e.CellValue2 Is Nothing OrElse e.CellValue2.Equals(DBNull.Value) Then
            e.SortResult = 0
        Else
            e.SortResult = 1
        End If
    Else
        If e.CellValue2 Is Nothing OrElse e.CellValue2.Equals(DBNull.Value) Then
            e.SortResult = -1
        Else
            e.SortResult = DirectCast(e.CellValue1, IComparable).CompareTo(DirectCast(e.CellValue2, IComparable))
        End If
    End If
    e.Handled = True
Catch ex As Exception
    HandleError("Error sorting result grid values", ex)
    Close()
End Try 
```

如果有人对此有任何改进，请随时发布。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:44:02.363

如果您要动态添加行，我必须假设 DataGridView 不是数据绑定的。在这种情况下，为什么在填充相应的行单元格时不检查空值并实例化某种虚拟日期（过去的一些有趣的日期，所以很明显它是空值 - 也可以指定它是默认值）因此，当涉及到排序时，它会很好。

如果这不好 - 创建您自己的 DataGridView 与内置的（使用继承）完全相同**但**覆盖排序方法以忽略空值怎么样？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T01:17:08.917

**更新的答案**：查看您发布的答案后，我发现您正在检查单元格中的 DBNull.Value。这可能是您的问题的根源，因为 DBNull.Value 无法转换为 DateTime。如果您以编程方式添加行，请尝试将 DBNull.Value 替换为 null（无）。

* * *

**原始答案**：尝试对包含 DateTime 数据的每一列执行此操作，最好在加载任何数据之前：

```
myDateTimeColumn.ValueType = GetType(DateTime) 
```

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.valuetype.aspx)的说法，ValueType 属性“在根据单元格内容过滤或排序列时使用”。所以我肯定会为任何允许排序的列设置它。

使用此属性集，可以在具有空值的列上对网格进行排序，并将强制插入/更新的单元格转换为 DateTime。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-21T13:42:03.473

只是为这个问题添加一些代码......我做了以下操作，以便在存在空值的情况下对 DateTime （和其他非字符串类型）进行正确的排序：

```
public MyFormCTor() {
    ...
    m_dataGridView.SortCompare += MySortCompare;
    ...
}

...

static void MySortCompare(object sender, DataGridViewSortCompareEventArgs e)
{
    if (e.CellValue1 == e.CellValue2)
    {
        e.SortResult = 0;
        return;
    }

    if (e.CellValue1 == null)
    {
        e.SortResult = -1;
        return;
    }

    if (e.CellValue2 == null)
    {
        e.SortResult = 1;
        return;
    }

    e.SortResult = ((IComparable)e.CellValue1).CompareTo(e.CellValue2);
} 
```

# c# - 通过 ac# 工具在基于 IE 的应用程序中自动执行某些重复操作？

> ID：870770
> 
> 赞同：0
> 
> 时间：2009-05-15T20:40:59.237
> 
> 标签：c#, vba, automation

[http://www.xtremevbtalk.com/showthread.php?p=1221565#post1221565](http://www.xtremevbtalk.com/showthread.php?p=1221565#post1221565)

这个线程显示了一些关于我正在尝试做的事情的讨论。我不能为此目的使用 Powershell，而且我不是高级学生，所以我的水平开始处于中级水平。了解概念，但需要大量帮助和基本想法 :-)

我可以在 c# 中使用一个简单的控件来获取我当前为我们的 IP 电话系统打开的 Internet 窗口，从另一个 IE 获取一个字符串，或者保持简单，只是我拥有的一个文本字符串，然后让它提交表格，并在IE IP电话中填写所需的选择（即单击单选按钮，单击提交，粘贴号码，然后单击拨号）。我们每天所有*极其*重复的操作都是基于 IP 电话上相同的例行提交（这很乏味）。这将极大地帮助我们的公司，除了我之外，我们没有开发人员（在这方面工作的学生）。我真的很想简化我们的一些重复动作。

我想知道可能实现自动化的最简单方法。VBA会更好吗，c#本身是否可以用于控制IE、设置光标位置、提交请求等？我将它与我们在工作中使用的大部分 IE 应用程序一起使用，*我没有源代码*，所以我试图弄清楚如何尽可能简单地做到这一点。

**请初学者友好回答。**对于仍在学习基础的人来说，它有点愚蠢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T20:51:48.977

看看这个[帖子](http://gruntbuggly.blogspot.com/2008/03/c-test-automation-with-internet.html)。[甚至Google 的 WebDriver 也在](http://google-opensource.blogspot.com/2009/05/introducing-webdriver.html)路上

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T22:07:42.727

我前段时间一直在研究这个问题，并找到了一个很好的工具：[WatiN](http://watin.sourceforge.net/)。它通常用于测试 Web 应用程序，但我认为您也会发现它很有帮助。它有一个易于学习的 API：

```
public void SearchForWatiNOnGoogle()
{
    using (IE ie = new IE("http://www.google.com"))
    {
        ie.TextField(Find.ByName("q")).TypeText("WatiN");
        ie.Button(Find.ByName("btnG")).Click();
    }
} 
```

# java - 哪个更适合 Java 开发托管：Aptana？谷歌应用引擎？切片主机？

> ID：870773
> 
> 赞同：6
> 
> 时间：2009-05-15T20:41:42.837
> 
> 标签：java, hosting, aptana, slicehost

我在开发 Java（非商业）Web 应用程序和部署到 Aptana 或 Google 云之类的东西或仅使用 Slice Host 帐户的好处之间分道扬镳。Tomcat 或 Jetty 和 MySQL 确实是我唯一的大需求。Aptana 和 Google App Engine 提供了一些很酷的 Eclipse 部署选项，但是如果应用程序没有庞大的用户群，可扩展性真的很重要吗？

另外，Aptana 和 Google App Engine 似乎都处于婴儿阶段，所以我想知道是否会有太多的限制，即使对于小时间的开发也是如此。有人有这些经验吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T21:38:59.533

我无法与 Aptana 交谈，但 Google App Engine 与您使用 Slicehost 之类的东西所获得的开发体验完全不同。它的扩展方式不同（即您有可能处理更大的负载），但它也与运行您自己的 Web 应用程序服务器（例如 Glassfish、Tomcat、JBoss 等）和使用“标准”Java 工具进行编码完全不同。

使用 Slicehost 或任何托管解决方案，您可以轻松地在本地设置您自己的开发环境，该环境完全模仿您将在服务器上运行的内容。相同的软件，相同的虚拟机，甚至可能是相同版本的 Linux。您甚至可以移动到不同的主机并仍然能够设置相同的环境。

使用 Google App Engine，您会发现自己在模拟器上构建（您实际上并没有在本地运行 BigTable），因此您的环境和服务器上的环境之间没有一一对应的关系。也没有其他地方可以移动并且仍然在相同的环境中运行。此外，您可能用于 Web 应用程序开发的一些流行的 Java 框架可能根本无法工作（例如）或无法开箱即用（[有关更多详细信息，请参见此处](http://groups.google.com/group/google-appengine-java/web/will-it-play-in-app-engine)）。

我对 App Engine 并不失望，事实上，我认为它真的很酷。如果对您的应用程序的需求相对较低，因此您不需要巨大的扩展要求，但您的流量并没有低到您可以轻松地适应 Google 的免费限额，那么我可能会倾向于使用托管解决方案，例如代替切片主机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T21:12:50.033

我使用 slicehost，到目前为止我对结果感到满意。升级切片很容易（我必须这样做一次），并且很容易回滚到切片的备份（我也必须这样做一次）。我正在托管 Tomcat 和 MySQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T05:42:56.297

请记住，Google App Engine 不会为您提供完整的 JRE。例如，您不能直接生成线程。此外，我发现 GAE 数据存储性能太慢——我经常遇到超时异常。总之，它不是一个真正的应用程序托管解决方案。您必须大量定制您的应用程序以使其在 GAE 上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-03T20:08:26.987

我建议使用亚马逊网络服务。与 App Engine 不同，您可以不受限制地获得云的强大功能。

# windows - 适用于 Windows 的优秀开源错误跟踪/问题跟踪软件

> ID：870776
> 
> 赞同：12
> 
> 时间：2009-05-15T20:42:13.057
> 
> 标签：windows, open-source, bug-tracking, issue-tracking

除了安装痛苦的非 Windows [Bugzilla](http://www.bugzilla.org/)之外，还有哪些开源问题跟踪程序可以推荐，它们与常规 Windows 样式安装一样好但可用？（`.exe`或`.msi`）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T20:54:59.030

您可以尝试[Redmine -](http://www.redmine.org/ "红米") [BitNami Redmine 堆栈](http://bitnami.org/stack/redmine)提供了无痛安装。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T20:55:29.793

在过去的三周里，我一直在与[Redmine合作，这就是爱！](http://www.redmine.org/)您可以在几分钟内使用[Bitnami Stack进行设置和运行。](http://bitnami.org/stack/redmine)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T20:51:10.677

从未使用过它，但[Trac](http://trac.edgewall.org/)可能在这里有用。是的，它确实有一个[该死的 .exe](http://trac.edgewall.org/wiki/TracDownload)。:)

# c++ - 在模板类中设置函数指针的问题

> ID：870794
> 
> 赞同：0
> 
> 时间：2009-05-15T20:46:06.260
> 
> 标签：c++, function, pointers

我正在尝试创建一个模板化为类的通用菜单按钮类，因此我可以在任何类中制作此按钮。我想创建一个指向该类中不同函数的 void 函数指针，因此当您单击 New Game 按钮时，它将调用 NewGame() 函数等。

我对创建函数指针的想法还有些陌生，希望得到一些建议。

每当我现在尝试使用此菜单按钮编译我的代码时，我都会收到一个疯狂的链接错误。

这是错误：

> 错误 1 ​​错误 LNK2019：函数“public: virtual void __thiscall TitleScreen::Draw( void)" (?Draw@TitleScreen@@UAEXXZ) TitleScreen.obj

菜单按钮.h

```
template <class t>
struct MENUBUTTON
{
    SPRITE Normal;              // Sprite to display when not hovered over or pressed down
    SPRITE Hover;               // Sprite to display when hovered over
    RECTANGLE HoverBounds;      // The Rectangle that activates the hover flag

    t* pClass;                  // Pointer to the templated class
    void (t::*ClickFunction)(); // Pointer to void function

    void SetButton(int xPos, int yPos, int width, int height, int hPadLeft, int hPadTop, int hWidth, int hHeight, LPCTSTR normalFilePath, LPCTSTR hoverFilePath, t* objectClass, void (t::*ClickFunction)());

    bool IsMouseHover();

    void CheckPressed();

    void Draw();
}; 
```

菜单按钮.cpp

```
#include "Global.h"

template <class t>
void MENUBUTTON<t>::SetButton(int xPos, int yPos, int width, int height, int hPadLeft, int hPadTop, int hWidth, int hHeight, LPCTSTR normalFilePath, LPCTSTR hoverFilePath, t* objectClass, void (t::*ClickFunction)())
    {
        // Position
        Hover.position.x = Normal.position.x = xPos;
        Hover.position.y = Normal.position.y = yPos;
        Hover.position.z = Normal.position.z = 0;

        // Width / Height
        Hover.width = Normal.width = width;
        Hover.height = Normal.height = height;

        // Hover RECTANGLE
        HoverBounds.x = xPos + hPadLeft;
        HoverBounds.y = yPos + hPadTop;
        HoverBounds.width = hWidth;
        HoverBounds.height = hHeight;

        // Load the Sprites
        LoadSprite(&Normal, normalFilePath, width, height, 1, 1);
        LoadSprite(&Hover, hoverFilePath, width, height, 1, 1);

        // Set the Click function pointer
        this->pClass = objectClass;
        this->ClickFunction = ClickFunction;
    }

template <class t>
void MENUBUTTON<t>::Draw()
{
    if(IsMouseHover())
    {
        DrawSprite(&Hover, 0, Hover.position.x, Hover.position.y, Hover.position.z);
    }
    else
    {
        DrawSprite(&Normal, 0, Normal.position.x, Normal.position.y, Normal.position.z);
    }
}

template <class t>
bool MENUBUTTON<t>::IsMouseHover()
{
    return (((InputData.MousePosition.x >= HoverBounds.x) && (InputData.MousePosition.x <= (HoverBounds.x + HoverBounds.width))) &&
        ((InputData.MousePosition.y >= HoverBounds.y) && (InputData.MousePosition.y <= (HoverBounds.y + HoverBounds.height)))) ? true : false;

} 
```

这是我使用菜单按钮的标题屏幕。

标题屏幕.h

```
class TitleScreen : public BaseState
{
    // SPRITES
    SPRITE titleScreenBG;

    // MENU BUTTONS
    MENUBUTTON<TitleScreen> playButton;
    MENUBUTTON<TitleScreen> quitButton;

    public:
        TitleScreen();

        virtual void Initialize();
        virtual void End();

        virtual void Update(float dt, INPUTDATA* input);
        virtual void Draw();

        void QuitGame();

        void NewGame();
}; 
```

标题画面.cpp

```
#include "Global.h"

// Constructors
TitleScreen::TitleScreen()
{

}

// Virtual Voids
void TitleScreen::End()
{

}

void TitleScreen::Initialize()
{
    this->Enabled = true;
    this->Visible = true;

    // Initialize sprites
    ZeroMemory(&titleScreenBG, sizeof(SPRITE));
    LoadSprite(&titleScreenBG, TEXT("../../PNG/TitleScreenBG.png"), 1440, 900, 1, 1);
    titleScreenBG.position.x = titleScreenBG.position.y = titleScreenBG.position.z = 0;

    // Initialize buttons
    ZeroMemory(&playButton, sizeof(MENUBUTTON<TitleScreen>));   
    playButton.SetButton(55, 170,   // x , y
                        512, 128,   // width, height
                        10, 10,     // Left, Top Padding
                        400, 70,    // Hover width, Hover height
                        TEXT("../../PNG/NewGame.png"), TEXT("../../PNG/NewGameH.png"),
                        this, &TitleScreen::NewGame);

    ZeroMemory(&quitButton, sizeof(MENUBUTTON<TitleScreen>));   
    quitButton.SetButton(55, 240,   // x , y
                        512, 128,   // width, height 
                        10, 10,     // Left, Top Padding
                        190, 70,    // Hover width, Hover height 
                        TEXT("../../PNG/QuitButton.png"), TEXT("../../PNG/QuitButtonH.png"),
                        this, &TitleScreen::QuitGame);
}

void TitleScreen::Update(float dt, INPUTDATA* input)
{

}

void TitleScreen::Draw()
{
    StartRender();
    DrawSprite(&titleScreenBG, 0, titleScreenBG.position.x, titleScreenBG.position.y, titleScreenBG.position.z);
    playButton.Draw();
    quitButton.Draw();
    EndRender();
}

// Public Methods
void TitleScreen::QuitGame()
{
    CloseDirect3D();
}

void TitleScreen::NewGame()
{
    CloseDirect3D();
} 
```

如果有人对我如何以不同的方式使按钮在任何情况下动态化有任何建议，或者知道这个问题是什么，请帮忙！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T20:49:50.573

要消除链接错误，请将所有以文件开头的方法定义移动`template`到`.cpp`文件中`.h`。在您的代码中，移动这些：

```
template <class t> void MENUBUTTON<t>::SetButton ... { ... }
template <class t> void MENUBUTTON<t>::Draw ... { ... } 
```

它不能与`.cpp`文件一起工作的原因是编译器将`MENUBUTTON<Foo>`等`MENUBUTTON<Bar>`视为不同的类，并且每当使用它时都会生成并编译这样的类。所以如果你`MENUBUTTON<TitleScreen>`在编译的时候使用`titlescreen.cpp`，那么`MENUBUTTON<TitleScreen>`代码就会被编译成目标文件`titlescreen.o`。但是方法`SetButton`和`Draw`将在链接时丢失，因为它们没有在它包含`titlescreen.cpp`的任何文件中定义。也不会包含它，因为不需要.`.h``MenuButton.o``MenuButton.cpp``MENUBUTTON<TitleScreen>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:00:52.357

只是为了澄清第一个答案，您不能拥有在标头中声明然后在单独的编译翻译单元（即 .cpp 文件）中实现的模板类。您必须将所有代码放在标题中。您可以将其全部放在初始类声明中，也可以使用“内联”首先使用函数声明类，然后在标题中进一步实现特定函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T21:23:54.187

说到更好的方法……为什么这里需要一个模板？普通的旧虚函数或指向成员的指针就可以了。这将是[命令设计模式](http://en.wikipedia.org/wiki/Command_pattern)的完美应用。模板为您提供**编译时多态性**，而您可能在这里寻找**运行时多态性**。

# javascript - politico.com 如何在复制的文本中插入超链接？

> ID：870797
> 
> 赞同：6
> 
> 时间：2009-05-15T20:47:05.680
> 
> 标签：javascript

如果您访问politico.com 上的这篇[文章](http://www.politico.com/news/stories/0509/22574.html)，突出显示一些文章文本，然后将该文本粘贴到其他地方，它将包含一个链接，上面写着“阅读更多：...”。这是怎么做到的？

更新：这是使用的 JS，但很难理解：[http ://tcr.tynt.com/javascripts/Tracer.js](http://tcr.tynt.com/javascripts/Tracer.js)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T20:56:40.587

我假设它就像任何复制到剪贴板脚本一样，但是您在前面插入“阅读更多：..”文本，然后监听 oncopy 事件。

所以不要只做： window.clipboardData.setData("Text", textToCopy);

你会的

window.clipboardData.setData("Text", "阅读更多：mysite.com, " + textToCopy);

更多在这里：

[http://www.daniweb.com/forums/thread53662.html](http://www.daniweb.com/forums/thread53662.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T21:03:34.097

在politico.com 上，你所说的代码在tracer.js 中。

# ruby-on-rails - 您更喜欢在 Ruby On Rails 中如何组织测试数据？

> ID：870806
> 
> 赞同：0
> 
> 时间：2009-05-15T20:48:21.463
> 
> 标签：ruby-on-rails, unit-testing, testing, fixtures, code-organization

您更喜欢如何在 Ruby On Rails 中组织您的测试数据：夹具、对象工厂或其他任何东西？为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T22:26:08.907

对象工厂远没有固定装置那么脆弱，当它们因为你一直在使用数据库模式而崩溃时，修复它们的工作要少得多。一些 gem 还知道如何智能地自动构建工厂对象之间的关联。

工厂女孩和机械师现在很流行。我也使用 Faker 来生成随机字符串；不是绝对必要的，但很有趣。

# sql - 实体属性值数据库与严格的关系模型电子商务

> ID：870808
> 
> 赞同：140
> 
> 时间：2009-05-15T20:48:35.927
> 
> 标签：sql, database, design-patterns, entity-attribute-value, key-value

可以肯定地说[EAV/CR](http://en.wikipedia.org/wiki/Entity-attribute-value_model)数据库模型很糟糕。也就是说，

问题：**应该使用什么数据库模型、技术或模式来处理描述电子商务产品的属性“类”，这些属性可以在运行时更改？**

在一个好的电子商务数据库中，您将存储选项类别（例如电视分辨率，然后为每台电视提供一个分辨率，但下一个产品可能不是电视，也没有“电视分辨率”）。您如何存储它们、有效搜索并允许您的用户使用描述其产品的可变字段设置产品类型？如果搜索引擎发现客户通常根据控制台深度搜索电视，您可以将控制台深度添加到您的字段中，然后在运行时为每个电视产品类型添加单个深度。

优秀的电子商务应用程序有一个很好的共同特征，它们显示一组产品，然后有“向下钻取”侧菜单，您可以在其中看到“电视分辨率”作为标题，以及最常见的前五个电视分辨率发现集。您单击一个，它只显示该分辨率的电视，允许您通过选择侧面菜单上的其他类别进一步深入研究。这些选项将是在运行时添加的动态产品属性。

**进一步讨论：**

长话短说，**互联网上是否有任何链接或模型描述可以“从学术上”解决以下设置？** 我感谢 Noel Kennedy 提出了一个类别表，但需求可能不止于此。我在下面用不同的方式描述它，试图突出它的重要性。我可能需要进行视点校正来解决问题，或者我可能需要更深入地了解 EAV/CR。

喜欢对 EAV/CR 模型的积极响应。我的开发人员同事都说 Jeffrey Kemp 在下面谈到的内容：“新实体必须由专业人士建模和设计”（断章取意，请阅读下面的回复）。问题是：

*   实体每周添加和删除属性
    *（搜索关键字决定未来的属性）*
*   每周都有新实体到货
    *（产品由零件组装而成）*
*   旧实体每周消失
    *（存档、不太受欢迎、季节性）*

客户想要为产品添加属性有两个原因：

*   部门/关键词搜索/同类产品对比图
*   结账前的消费产品配置

属性必须有意义，而不仅仅是关键字搜索。如果他们想比较所有有“奶油糖霜”的蛋糕，他们可以点击蛋糕，点击生日主题，点击奶油糖霜，然后检查所有有趣的蛋糕，知道它们都有奶油糖霜。这不是特定于蛋糕的，只是一个例子。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-05-18T06:29:11.650

我能想到一些一般的优点和缺点，在某些情况下，一种比另一种更好：

**选项 1，EAV 型号：**

*   优点：设计和开发简单应用程序的时间更少
*   优点：易于添加的新实体（甚至可能由用户添加？）
*   Pro：“通用”接口组件
*   缺点：验证简单数据类型所需的复杂代码
*   缺点：用于简单报告的更复杂的 SQL
*   缺点：复杂的报告可能变得几乎不可能
*   缺点：大型数据集的性能不佳

**选项 2，分别为每个实体建模：**

*   缺点：收集需求和设计需要更多时间
*   缺点：新实体必须由专业人士建模和设计
*   缺点：每个实体的自定义界面组件
*   优点：数据类型约束和验证易于实现
*   优点：SQL 易于编写，易于理解和调试
*   优点：即使是最复杂的报告也相对简单
*   Pro：大型数据集的最佳性能

**选项 3，组合（“正确”模型实体，但为某些/所有实体的自定义属性添加“扩展”）**

*   优缺点：收集需求和设计所需的时间比选项 1 多，但可能不如选项 2 *
*   缺点：新实体必须由专业人士建模和设计
*   优点：以后可能很容易添加新属性
*   缺点：验证简单数据类型所需的复杂代码（用于自定义属性）
*   缺点：仍然需要自定义界面组件，但自定义属性可能会使用通用界面组件
*   缺点：只要报告中包含任何自定义属性，SQL 就会变得复杂
*   缺点：一般性能良好，除非您开始需要按自定义属性搜索或报告

**我不确定选项 3 是否一定会在设计阶段节省任何时间。*

就我个人而言，我倾向于选项 2，并尽可能避免 EAV。但是，对于某些场景，用户需要 EAV 带来的灵活性；但这需要付出很大的代价。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-05-15T21:44:54.417

> 可以肯定地说 EAV/CR 数据库模型很糟糕。

不，这不对。只是它们对关系数据库的使用效率低下。纯键/值存储非常适合此模型。

现在，对于您真正的问题：如何存储各种属性并使其可搜索？

只需使用 EAV。在您的情况下，这将是一张额外的桌子。在属性名称和值上都对其进行索引，大多数 RDBM 会在属性名称重复上使用前缀压缩，使其非常快速和紧凑。

当您使用 EAV/CR 替换“真实”字段时，它会变得丑陋。与每个工具一样，过度使用它是“坏的”，并给它一个坏形象。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-09-27T21:15:01.263

```
// 在这一点上，我想花点时间和你谈谈 Magento/ Adobe PSD 格式。
// Magento/ PSD不是一个好的电子商务平台/格式。Magento/ PSD甚至不是一个糟糕的电子商务平台/格式。这么称呼它
// 侮辱其他不良电子商务平台/格式，例如 Zencart 或 OsCommerce。不，Magento/ PSD是一个糟糕的电子商务平台/格式。有
// 这段代码已经工作了几个星期了，我对 Magento/ PSD的仇恨已经变得熊熊燃烧
// 燃烧着一百万个太阳的强烈激情。

```

[http://code.google.com/p/xee/source/browse/trunk/XeePhotoshopLoader.m?spec=svn28&r=11#107](http://code.google.com/p/xee/source/browse/trunk/XeePhotoshopLoader.m?spec=svn28&r=11#107)

内部模型充其量是古怪的，就像有人将架构放入拼图游戏中，将其密封并放入油漆盒中……

现实世界：我正在开发一个中间件履行应用程序，这是获取地址信息的查询之一。

```
CREATE OR REPLACE VIEW sales_flat_addresses AS
SELECT sales_order_entity.parent_id AS order_id, 
       sales_order_entity.entity_id, 
       CONCAT(CONCAT(UCASE(MID(sales_order_entity_varchar.value,1,1)),MID(sales_order_entity_varchar.value,2)), "Address") as type, 
       GROUP_CONCAT( 
         CONCAT( eav_attribute.attribute_code," ::::: ", sales_order_entity_varchar.value )
         ORDER BY sales_order_entity_varchar.value DESC
         SEPARATOR '!!!!!' 
       ) as data
  FROM sales_order_entity
       INNER JOIN sales_order_entity_varchar ON sales_order_entity_varchar.entity_id = sales_order_entity.entity_id
       INNER JOIN eav_attribute ON eav_attribute.attribute_id = sales_order_entity_varchar.attribute_id
   AND sales_order_entity.entity_type_id =12
 GROUP BY sales_order_entity.entity_id
 ORDER BY eav_attribute.attribute_code = 'address_type' 
```

懒惰地为订单提供准确的地址信息

--

**摘要：**仅在以下情况下使用 Magento：

1.  你得到了一大袋钱
2.  你必须
3.  享受痛苦

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2011-04-05T23:10:29.747

我很惊讶没有人提到 NoSQL 数据库。

我从未在生产环境中练习过 NoSQL（刚刚测试了 MongoDB 并印象深刻），但 NoSQL 的重点在于能够将具有不同属性的项目保存在同一个“文档”中。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-07-20T13:04:54.893

在性能不是主要要求的情况下，例如在 ETL 类型的应用程序中，EAV 具有另一个明显的优势：差异保存。

我已经实现了许多应用程序，其中最重要的要求是能够查看域对象从其第一个“版本”到当前状态的历史记录。如果该域对象具有大量属性，则意味着每次更改都需要将新行插入到其对应的表中（不是更新，因为历史记录会丢失，而是插入）。假设这个域对象是一个 Person，我有 500k Persons 要跟踪，在 Persons 生命周期中平均有 100 多个更改为各种属性。再加上只有 1 个主要域对象的应用程序很少见，您很快就会推测数据库的大小将迅速失控。

一个简单的解决方案是只保存对主要域对象的差异更改，而不是重复保存冗余信息。

所有模型都会随着时间的推移而变化，以反映新的业务需求。时期。使用 EAV 只是我们使用的工具之一；但它永远不应该被自动归类为“坏”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-12-28T10:04:45.803

我正在努力解决同样的问题。您可能会感兴趣查看以下关于两个现有电子商务解决方案的讨论：Magento (EAV) 和 Joomla（常规关系结构）： [https ://forum.virtuemart.net/index.php?topic=58686.0](https://forum.virtuemart.net/index.php?topic=58686.0)

看来，Magento 的 EAV 性能是真正的亮点。

这就是为什么我倾向于标准化结构。为了克服缺乏灵活性，我正在考虑在将来添加一些可以编辑的单独数据字典（XML 或单独的 DB 表），并基于此，用于显示和比较具有新属性集的产品类别的应用程序代码将是与 SQL 脚本一起生成。

这种架构似乎是这种情况下的最佳选择——同时灵活且高性能。

问题可能是在实时环境中频繁使用 ALTER TABLE。我正在使用 Postgres，因此它的 MVCC 和事务性 DDL 有望减轻痛苦。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-05-07T16:58:43.287

我仍然投票支持在 EAV 的最低意义原子级别建模。让面向特定用户社区的标准、技术和应用程序来决定内容模型、属性的重复需求、粒度等。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-09-27T18:08:04.883

如果它只是关于产品目录属性，因此对这些属性的验证要求相当有限，那么 EAV 唯一真正的缺点是查询性能，甚至当您的查询处理具有属性的多个“事物”（产品）时，这也是一个问题，查询“给我 ID 为 234 的产品的所有属性”的性能虽然不是最佳的，但仍然很快。

一种解决方案是仅将 SQL 数据库/EAV 模型用于产品目录的管理/编辑端，并通过一些过程将产品非规范化为使其可搜索的东西。由于您已经拥有属性，因此您很可能想要分面，这可能是 Solr 或 ElasticSearch。这种方法基本上避免了 EAV 模型的所有缺点，并且增加的复杂性仅限于在更新时将完整的产品序列化为 JSON。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-05-06T12:24:21.573

EAV有很多缺点：

1.  随着时间的推移性能下降 一旦应用程序中的数据量增长到超过一定大小，该数据的检索和操作可能会变得越来越低效。
2.  SQL 查询非常复杂且难以编写。
3.  数据完整性问题。您不能为所有需要的字段定义外键。
4.  您必须定义和维护自己的元数据。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-03-07T05:12:58.260

我有一个稍微不同的问题：我想要存储更像电子表格的东西，而不是许多具有稀疏值的属性（这可能是使用 EAV 的一个很好的理由）。工作表中的列可以更改，但在工作表中，所有单元格都将包含数据（不是稀疏的）。

我做了一[组测试](https://github.com/vpac-innovations/spreadsheet)来对两种设计进行基准测试：一种使用 EAV，另一种使用 Postgres ARRAY 存储单元数据。

**EAV** [![在此处输入图像描述](https://i.stack.imgur.com/AzK6j.png)](https://i.stack.imgur.com/AzK6j.png)

**大批** [![在此处输入图像描述](https://i.stack.imgur.com/9KSvd.png)](https://i.stack.imgur.com/9KSvd.png)

两种模式在适当的列上都有索引，并且索引由规划器使用。

事实证明，基于数组的模式对于插入和查询来说[都快了一个数量级。](https://github.com/vpac-innovations/spreadsheet/blob/master/doc/discussion.md)从快速测试来看，两者似乎都是线性缩放的。不过，测试不是很彻底。欢迎提出建议和分叉 - 它们受 MIT 许可。

# sql - SQL Server 查询性能，大型 where 语句与查询

> ID：870809
> 
> 赞同：1
> 
> 时间：2009-05-15T20:49:27.623
> 
> 标签：sql, sql-server

我想知道哪种方法更有效地从数据库中检索数据。

前任。我的应用程序的一个特定部分可以有超过 100 个对象。现在我已经设置为每个对象两次查询数据库。应用程序的这一部分会定期自我刷新，比如每 2 分钟一次，并且此应用程序可能会在 25-30 台电脑上安装完毕。我认为这是从数据库中进行的大量选择语句，并且我正在考虑尝试优化该过程。我必须从几个表中提取信息，并且两个查询都使用连接语句。

重写查询会更好吗，这样我每次更新只执行查询两次而不是 200 次？比如使用一个大的where语句来包含每个对象，然后在对象之外而不是每个对象内部做数据的处理？

使用 SQL Server，.net 表上没有索引，数据库大小小于 10-5th

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T20:55:34.630

在所有条件相同的情况下，多行少的语句通常比多行的少语句差。

显示实际代码并获得更好的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T20:59:09.007

优化的默认答案必须始终是：在您证明需要它之前不要优化。后续行动是：一旦您证明需要它，以及另一种方法：尝试两种方法以确定哪种方法更快。你无法预测哪个会更快，我们当然也不能。KM 的回答很好——查询越少越好——但*知道*的方法是测试。

# oracle - 更改 oracle 中具有外键约束的列

> ID：870819
> 
> 赞同：0
> 
> 时间：2009-05-15T20:53:21.827
> 
> 标签：oracle, foreign-keys

我在一个表中有一个只有 6 个字符长的列，它使用外键约束引用了一个 20 个字符的列。我该如何解决？

注意：问题是由于 Oracle SQL Developer 编辑表的限制。当我执行特定的更改列时，它工作正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T21:00:54.010

```
SQL> create table parent_tbl(col1 char(20) primary key);
Table created.
SQL> create table child_tbl(col1 char(6) primary key, constraint col1_fk foreign key (col1) references parent_tbl(col1));
Table created.
SQL> alter table child_tbl modify col1 char(20);
Table altered.
SQL> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T21:00:42.840

解决问题的一种可能方法是将 6 个字符的列的大小增加到 20 个字符。

另一种解决方案可能是您可以在表中创建一个列大小为 20 个字符的虚拟列。将该列的值设置为由函数计算，并定义一个函数，以便为每行中的虚拟列分配 20 个字符列的前六个字符的值。然后使用外键约束。

# django - 您将如何对 django mptt 树进行排序？

> ID：870821
> 
> 赞同：2
> 
> 时间：2009-05-15T20:54:06.193
> 
> 标签：django, django-mptt

想象一下，我有一个对象及其人口的 mptt 树，例如：

动物，60

*   土豚，30
*   山猫，20
*   花栗鼠，10

蔬菜，6

*   苹果，1
*   甜菜，2
*   花椰菜，3

矿物 0

您将如何按每个子级别的人口对上述内容进行排序？我想去：

动物，60

*   土豚，30
*   山猫，20
*   花栗鼠，10

蔬菜，6

*   花椰菜，3
*   甜菜，2
*   苹果，1

矿物 0

我正在 django 中构建 mptt。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T06:43:15.303

尝试将其添加到[models.py](http://docs.djangoproject.com/en/dev/topics/db/models/#id3)元类中。

或者在一个附属的[QuerySet上](http://docs.djangoproject.com/en/dev/ref/models/querysets/#order-by-fields)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T10:56:13.230

应该`order_by`简单的工作吗？

```
YourModel.tree.filter(your=stuff).order_by('order') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T12:59:29.620

我刚刚解决了一个类似的问题。您可以使用`order_by`，但不能简单地使用要排序的字段：

```
MyModel.tree.all().order_by('tree_id', 'level', 'your_sort_field') 
```

# .net - ADO.NET 疯狂和可空类型

> ID：870830
> 
> 赞同：2
> 
> 时间：2009-05-15T20:56:18.997
> 
> 标签：.net, generics, nullable

我好像掉进了兔子洞。我想将 ADO .NET 数据集中的数据转换为 Nullable 类型。起初我认为直接演员（int？）会做到这一点。我是多么天真。错了，大错特错。现在我正在尝试编写一个通用转换器，但我对语法感到困惑。这就是 2005 年 - 一定有人已经解决了这个问题。你？

问题是，当我尝试在转换器上使用 Nullable 类型作为约束时，出现语法错误：

```
public class NullableDBConversion
{
  public static T Convert<T>(object testValue) where T : Nullable<T>
  {
    if (testValue is DBNull)
    {
      return new Nullable<T>();
    }

    return new Nullable<T>((T)testValue);
  }
} 
```

目标有一个使用泛型进行所有转换的方法。这是可能的还是我必须写几个。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T21:03:04.877

`T : Nullable<T>`作为约束并没有真正意义 - 想想`T`必须是什么；它本身不能为空。你可以有：

```
where T : Nullable<U> where U : struct 
```

但这有点晦涩难懂。我认为制作`T`不可为空的类型并仅引用`Nullable<T>`. 我想你想要这个：

```
public static Nullable<T> Convert<T>(object testValue) where T : struct
{
    return testValue is DBNull ? null : new Nullable<T>((T)testValue);
} 
```

# java - 是否可以在运行时从数据库模式生成 JPA 实体类？

> ID：870831
> 
> 赞同：4
> 
> 时间：2009-05-15T20:56:28.823
> 
> 标签：java, hibernate, jpa, code-generation, persistence

像 Netbeans 这样的 IDE 允许通过持久性上下文生成实体类。如果您可以访问底层生成方法（不确定它是外部工具还是 IDE 的一部分），您能否**在运行时动态生成数据库实体类？**这个想法是您可以使用反射连接到实体类。

我知道您可以采用另一种方式并从实体类生成数据库，但是由于我的工作环境中的权限问题，这是行不通的。但是，如果您反转该过程并从数据库中提取类，则在我的环境中可能是可行的。这个想法是数据库将用作配置/控制的单点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T21:11:02.410

这在理论上是可能的，但有什么意义呢？Java 是静态类型的，因此您*只能*通过反射使用生成的类，并且无法赋予它们行为，因此删除了对象关系映射的全部要点。将数据加载到 Maps 或仅使用 SQL 记录集会更方便。

如果您有一个现有的模式，您可以编写以应用程序需要的方式运行的类，并以声明方式将它们映射到模式上。这样，代码是应用程序逻辑的最简单表达，并且与持久性无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T21:11:09.787

您可以在 JBoss 网站上找到从数据库到 Java 对象的逆向工程工具。

源代码可用，您应该深入研究！

[https://www.jboss.org/tools/download/stable.html](https://www.jboss.org/tools/download/stable.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T21:20:10.903

假设您使用的是 Hibernate，您也许可以使用[Hibernate 工具](https://www.hibernate.org/255.html)来生成数据库模式。虽然主要是为 Eclipse 和 Ant 设计的，但理论上可以像任何其他 JAR 一样将其链接并调用它。

# c# - RoleManagerModule 和 RolePrincipal 对象

> ID：870839
> 
> 赞同：3
> 
> 时间：2009-05-15T20:58:53.110
> 
> 标签：c#, asp.net, authentication, forms-authentication, roles

根据我的书，如果启用`RoleManagerModule`了角色管理，则通过将`RolePrincipal`对象分配给`HttpRequest.User`. 但是安全上下文不是已经创建（因此主体对象被分配给`HttpContext.User`）`FormsAuthenticationModule`，它在被调用之前`RoleManagerModule`被调用吗？

我问这个，因为在以下代码中分配给的主体对象`HttpRequest.User`已经存在，即使`RoleManagerModule`尚未被调用：

```
protected void Application_AuthenticateRequest(Object sender, EventArgs e)
{
    if (User.Identity.IsAuthenticated && Roles.Enabled)
    {
        //here we subscribe user to a role via Roles.AddUserToRole()
    }       
} 
```

`FormsAuthenticationModule`那么，由 创造并分配给的主体对象，`HttpRequest.User`后来被`RolePrincipal`对象（由 创造`RoleManagerModule`）取代了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T23:02:41.097

根据[这篇文章](http://www.asp.net/Learn/Security/tutorial-11-cs.aspx)：

> 如果启用了 Roles 框架，RoleManagerModule HTTP 模块会在 FormsAuthenticationModule 之后介入，并在 PostAuthenticateRequest 事件期间识别经过身份验证的用户的角色，该事件在 AuthenticateRequest 事件之后触发。如果请求来自经过身份验证的用户，则 RoleManagerModule 将覆盖由 FormsAuthenticationModule 创建的 GenericPrincipal 对象并将其替换为 RolePrincipal 对象。RolePrincipal 类使用 Roles API 来确定用户所属的角色。

所以你是对的。

# javascript - 将参数传递给 jQuery 删除按钮单击 EventHandler

> ID：870841
> 
> 赞同：1
> 
> 时间：2009-05-15T20:59:05.213
> 
> 标签：javascript, jquery, html, asp.net-mvc, xhtml

我有以下 jQuery

```
$('#btnDelete').click( function() {//Do the delete here via jquery post}); 
```

在我的表中，我有很多行，其中包含以下内容

```
<a id="btnDelete">Delete</a> 
```

我如何将参数传递给单击事件以发布 ID 以删除某些内容

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T23:51:07.483

如果你有很多这些，将处理程序绑定到它们的最简单方法是让它们都共享一个公共类而不是一个公共 ID（id 应该是唯一的......）。

```
<a class="btnDelete" id="del_123">Delete</a>
<a class="btnDelete" id="del_124">Delete</a>
<a class="btnDelete" id="del_125">Delete</a> 
```

然后要激活它们，你可以绑定一个点击事件：

```
$(function() {
    $(".btnDelete").click(function() {
        // get your id here
        var $id = parseInt(this.id.substring(4));
        // POST with your info or whatever... and then...

        return false;
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:05:00.940

你可以使用这个包装在 jQuery 函数中。在您的回调中：

```
$(this) 
```

将是一个包含触发事件的标签的包装集。例如，如果您有以下结构：

```
<tr><td><a id="btnDelete">Delete</a></td></tr>

$(this).parent() 
```

将包含父 td 元素。然后，您可以使用其 id 或属性。这比尝试将参数传递给回调要好得多。

# javascript - 错误地嵌入 Flash 电影 - 猜我有罪

> ID：870842
> 
> 赞同：1
> 
> 时间：2009-05-15T20:59:05.497
> 
> 标签：javascript, flash, embedding, wimpy

我已经尝试通过另一个用户的建议，使用嵌入 Flash 的 swfobject 方法。然而，我一定没有那么聪明。

下面是我想出的怪物，但是没有电影播放，当我控制+单击时我什至无法区分它是Flash电影（Mac）......好像它甚至不存在一样。

任何有关我如何解决此问题的指导将不胜感激！

```
<div id="audioPlayer">
<script type="text/javascript">

var flashvars = {
wimpyApp: "mp3s/wimpy.php",
wimpySkin: "mp3s/skins/skin_transparent.xml",
defaultVisualExt: "jpg"
theVolume: "75"
bufferAudio: "0"
infoDisplayTime: "3"
scrollInfoDisplay: "yes"
startPlayingOnload: "yes"
autoAdvance: "yes"
popUpHelp: "yes"
};
var params = {
embed src="mp3s/wimpy_button.swf"
quality="high"
menu: "false"
loop: "false"
quality: "high"
scale: "noscale"
salign: "lt"
bgcolor: "000000"
wmode: "transparent"
allowScriptAccess: "sameDomain"
};
var attributes = {
id: "myDynamicContent",
name: "myDynamicContent"
};

swfobject.embedSWF("mp3s/wimpy_button.swf", "movie", "250", "140",
"9.0.0","Scripts/expressInstall.swf", flashvars, params, attributes);

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T21:04:00.990

您的对象中缺少很多逗号：

```
var flashvars = {
wimpyApp: "mp3s/wimpy.php",
wimpySkin: "mp3s/skins/skin_transparent.xml",
defaultVisualExt: "jpg"
theVolume: "75"
bufferAudio: "0"
infoDisplayTime: "3"
scrollInfoDisplay: "yes"
startPlayingOnload: "yes"
autoAdvance: "yes"
popUpHelp: "yes"
}; 
```

应该

```
var flashvars = {
wimpyApp: "mp3s/wimpy.php",
wimpySkin: "mp3s/skins/skin_transparent.xml",
defaultVisualExt: "jpg",
theVolume: "75",
bufferAudio: "0",
infoDisplayTime: "3",
scrollInfoDisplay: "yes",
startPlayingOnload: "yes",
autoAdvance: "yes",
popUpHelp: "yes",
}; 
```

另外，您有一个名为“电影”的 div 对吗？你还记得包含 swfobject.js 吗？

```
<script type="text/javascript" src="_js/swfaddress.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:18:37.477

谢谢你，

实际上，我是通过从他们的网站下载更新的 wimpy.swf 并使用它来实现它的。在此处的相关帖子中找到它[。](https://stackoverflow.com/questions/447329/embedding-flash-wimpy-player-so-that-it-works-in-firefox)

我仍在使用“两次烘焙”方法，因为嘿，它已经在那里了，现在它可以工作了……但是，我仍在制作副本并尝试这种 swfobject 方法。

正如你所说，我将逗号放在了 flash vars 中，实际上我的 div 被命名为“audioPlayer”，所以我将所有出现的“movie”都更改为那个。

我在标头中有 js 文件：

它位于“脚本”文件夹中。

虽然仍然无法正常工作:(

# wpf - Silverlight 中的 TranslateTransform.BeginAnimation？

> ID：870844
> 
> 赞同：0
> 
> 时间：2009-05-15T20:59:26.167
> 
> 标签：wpf, silverlight

我有一个想要移植到 SilverLight 的工作 WPF 应用程序。我有一段 WPF 代码，但我没有找到在 SilverLight 中模仿的方法。

**WPF 代码片段：**

TranslateTransform 转换 = null;

> trans = child.RenderTransform as TranslateTransform;
> 
> trans.BeginAnimation(TranslateTransform.XProperty, new DoubleAnimation(curX, animationLength), HandoffBehavior.Compose);

问题是 BeginAnimation 调用。它似乎不存在于 TranslateTransform 对象上。有什么想法可以完成同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:57:12.967

Silverlight 中不存在 BeginAnimation。您可以改用故事板

# asp.net - 从服务器检索值时，ASP.NET AJAX 是如何工作的？

> ID：870856
> 
> 赞同：1
> 
> 时间：2009-05-15T21:01:12.417
> 
> 标签：asp.net, javascript, ajax

如果我想从 JavaScript 调用服务器函数以从数据库中检索一个人的姓名（仅作为示例）......我去了......

```
name = myServices.getName(userId); 
```

如果我有一个脚本管理器，其中包含`.asmx`对具有 web 方法的文件的服务引用，`getName( int userId ) {}`那么应该正确调用这个函数，并最终返回那个`userId`.

不幸的是，我想做...

```
name = myServices.getName(userId);
alert(name); 
```

但是，在执行 ASP.NET AJAX 时，它会调用 web 方法并在等待服务器响应之前继续执行（我理解这是 AJAX 的重点，以阻止浏览器在等待数据时冻结）

我需要先从服务器取回名称，然后才能继续执行……我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T21:11:28.007

有一个方法可以作为参数添加到服务方法中，该方法将在成功时调用该方法，您可以在其中执行其他操作。

例如：

```
function test() {
    PageMethods.MyMethod("name", OnMyMethodComplete);
}

function OnMyMethodComplete(result, userContext, methodName) {
    alert(result);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:13:16.490

如果要同步调用 Web 方法，则需要手动设置请求并使用`Sys.Net.XMLHttpSyncExecutor`.

[这是一个示例](http://weblogs.asp.net/ricardoperes/archive/2009/03/06/calling-web-service-methods-synchronously-in-asp-net-ajax.aspx)（请参阅 ExecuteSynchronously 函数）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T21:16:30.523

对于 JavaScript 解决方案，您可以循环直到`name`有值。根据延迟调整时间以保持应用响应

```
var time = 100;
window.setTimeout(name == '' ? wait : continue, time);

function wait() {
    window.setTimeout(name == '' ? wait : continue, time);
}
function continue() {
    //code having to do with name
    alert(name);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T21:28:32.350

恭喜！您已经迈出了进入更大异步世界的第一步。我肯定会使用`CSharpAtl`建议的回调。

# ksh - 给定 korn shell 中的名称，如何获取变量的值？

> ID：870860
> 
> 赞同：2
> 
> 时间：2009-05-15T21:02:41.290
> 
> 标签：ksh

当您获得变量的名称时，ksh 中是否有办法获取变量的值？

例如：

```
#!/usr/bin/ksh
var_name=$1  #pretend here that the user passed the string "PATH"
echo ${$var_name}  #echo value of $PATH -- what do I do here? 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-15T21:12:14.200

```
eval `echo '$'$var_name`

```

echo 将“$”连接到 $var_name 中的变量名，eval 对其进行评估以显示该值。

编辑：以上内容不太正确。正确答案是没有反引号。

```
eval echo '$'$var_name

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-20T01:09:26.150

`printenv`不是 ksh 内置的，可能并不总是存在。对于较旧的 ksh 版本，在*ksh93*之前，eval 'expression' 方法效果最好。

ksh93 中一个强大的方法是使用带有“nameref”或“typeset -n”的间接变量。

定义并验证引用的*nameref*变量`$PATH`：

```
$ nameref indirect=PATH
$ print $indirect
/usr/bin:/usr/sbin 
```

看看我们改变时*nameref*`PATH`变量是如何改变的：

```
$ PATH=/usr/bin:/usr/sbin:/usr/local/bin
$ print $indirect
/usr/bin:/usr/sbin:/usr/local/bin 
```

显示 ksh 版本和别名`nameref`：

```
$ type nameref
nameref is an alias for 'typeset -n'
$ echo ${.sh.version}
Version JM 93t+ 2010-02-02 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T06:31:30.907

```
var_name=$1  #pretend here that the user passed the string "PATH"
printenv    $var_name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-11T23:39:22.080

比你的答案高出一步（我花了很多时间试图找到这两个答案）。下面将允许您导出动态变量，然后动态调用它：

```
echo -n "Please provide short name for path:"
read PATH_SHORTCUT
echo -n "Please provide path:"
read PATH
eval export \${PATH_SHORTCUT}_PATH="${PATH}"
eval echo Path shortcut: ${PATH_SHORTCUT} set to \$"${PATH_SHORTCUT}_PATH". 
```

# delphi - Delphi 编译器警告指向 Delphi 自己的单元

> ID：870862
> 
> 赞同：8
> 
> 时间：2009-05-15T21:03:16.373
> 
> 标签：delphi, ide, compiler-construction, custom-component

在 Delphi 2007 中，在一个包含自定义组件的项目上工作，当我进行完整构建时（但不是在我进行直接编译时），我收到这组警告作为消息中的前四个：

```
[DCC Warning] Dialogs.pas(1426): W1002 Symbol 'TFileOpenDialog' is specific to a platform
[DCC Warning] Dialogs.pas(1446): W1002 Symbol 'TFileSaveDialog' is specific to a platform
[DCC Warning] ComCtrls.pas(6757): W1036 Variable 'Section' might not have been initialized
[DCC Warning] ComCtrls.pas(19268): W1023 Comparing signed and unsigned types - widened both operands 
```

我通常会尽量消除编译器警告，但这些是“库存”Delphi 单元。这些警告是我代码中某些内容的间接结果吗？如果是这样，我如何弄清楚什么/在哪里？如果没有，我应该怎么处理它们？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-15T21:08:07.470

我相信这是因为您的构建路径中有库存的 Delphi 源代码。如果您删除 Delphi 源目录，那么它应该在没有这些警告的情况下构建。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T02:25:37.347

它们仅在执行构建时出现的原因是编译命令仅编译自上次编译以来已更改的源。而 Build 命令会重新编译项目中的所有内容，而不管更改如何。

警告很可能是由项目搜索路径中包含的 Delphi 源文件夹引起的。删除它并删除项目文件夹中的 dcus 将告诉您在重新编译时项目中的任何内容是否需要 Delphi 源代码。根据我的经验，如果您在 Delphi 的实现中发现了一个错误并制作了一个 Delphi 类的自定义副本来纠正错误，那么您应该需要 Delphi 源代码。如果是这种情况，当您尝试在没有 Delphi 源的情况下进行构建时，您通常会得到：

> 单元 '%s' 使用 '%s' 中的单元 '%s' 编译，但发现不同的版本 '%s' (F2446)

其中 %s 将是一些低级别的 Delphi 类。

如果你没有得到任何错误，它并不真的需要 Delphi 源代码。

*如果 Delphi 源位于环境*搜索路径中，也会发生这种情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-06T15:54:34.160

您提到的前两个警告（以及其他几个警告）是为了让您意识到您当前使用的代码不会在 Delphi 支持的不同平台上编译。对于 Delphi 2007，没有多少，但它带有 Kylix（已消失的 Linux 版本）和 Delphi for .NET（也已消失）的残余。

最新版本的 Delphi 支持跨平台（Win32/Win64、OS X、iOS 和 Android），这些消息在开发 Firemonkey 应用程序（或 VCL 应用程序，如果 Win32 和 Win64 之间存在差异）时再次相关。它们指示代码中的点，您必须针对不同的操作系统对代码进行调整。（例如，您引用的两个是针对特定于 Windows 的对话框；您需要使用基于目标平台的不同对话框，并`{$IFDEF}`在特定于平台的区域周围使用语句，以防止它们被编译用于其他平台。

由于您当前的代码不能直接移植（即使在现代 Delphi 版本中），因为它是基于 VCL 的，所以不能直接移植到 Windows 以外的任何地方，您可以安全地关闭这些警告。使用`Project->Options->Compiler Messages`，并取消选中以下消息（或使用我在您的代码中包含的编译器定义）：

```
Library Symbol                       {$WARN SYMBOL_LIBRARY OFF}
Platform Symbol                      {$WARN SYMBOL_PLATFORM OFF}
Library Unit                         {$WARN UNIT_LIBRARY OFF}
Platform Unit                        {$WARN UNIT_PLATFORM OFF}
Unsafe type  (.NET remnant)          {$WARN UNSAFETYPE OFF}
Unsafe code  (.NET remnant)          {$WARN UNSAFECODE OFF}
Unsafe typecast (.NET remnant)       {$WARN UNSAFECAST OFF} 
```

你提到的最后两个我无法用 D2007（IDE 版本 11.0.2804.9245）重现，所以我怀疑 skamradt 的答案是正确的 - 这是因为你的搜索路径中有 VCL 源目录，你应该'吨。它应该设置为`$(BDS)\Lib`。如果您需要能够逐步浏览源代码，请使用该`Project->Options->Compiler`页面，然后选中`Use debug DCUs`下面的选项`Debugging`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T21:29:09.893

如果您想继续将 VCL 源显式编译到您的项目中，您可以复制引发编译器提示/警告的单元并“修复”该副本中的提示/警告。将这些 VCL 单元的更新/“固定”副本放在另一个文件夹中，并确保在 Delphi VCL 源路径之前将该文件夹的路径添加到项目的搜索路径中。

例如，我的项目搜索路径如下所示：“C:\Dev\Source\MyFixedVCLUnits;C:\Program Files\CodeGear\RAD Studio\6.0\source”

举一个删除这些警告所需的简单修复示例，下面是 Dialogs.pas 中的一个函数，它现在位于我的“C:\Dev\Source\MyFixedVCLUnits”文件夹中：

`{$WARNINGS OFF}
function TFileOpenDialogWrapper.CreateFileDialog: TCustomFileDialog;
begin
Result := TFileOpenDialog.Create(nil);
Result.OnExecute := OnExecuteEvent;
end;
{$WARNINGS ON}`

在这种情况下，只需根据需要添加 {$WARNINGS OFF} 等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-15T21:22:34.970

我花了很长时间解决这些问题（好吧，无论如何，你的前两个）并且在我的无知中实际上卸载了Delphi并重新安装它无济于事。最后发现是项目设置不足造成的。至少一开始，如果您从早期的 Delphi 迁移项目，您现有的项目设置会被转换，但没有明显的原因，Delphi 会开始忘记这一点，并为您提供一组“空白”项目设置。您可以通过打开 Project-Options 来查看这一点，您可以在其中找到 Base、Release 和 Debug。查看活动的（在项目管理器中为粗体），您应该会看到它没有目录路径以及默认情况下的所有提示和警告。这些默认值中的大多数都很好，但应该禁用“平台符号”和“平台单元”（至少对于 Win32 的东西）。问候，布赖恩

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-06T15:16:28.923

**TFileOpenDialog**仅适用于 Windows Vista 及更高版本。您应该使用**TOpenDialog**而不是 TFileOpenDialog，在较新的 Delphi 版本中，它将检测它正在运行的操作系统并显示正确的对话框。
[https://forums.embarcadero.com/thread.jspa?threadID=70498](https://forums.embarcadero.com/thread.jspa?threadID=70498)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-11T11:57:13.337

如果只为特定平台开发开源项目源码并添加

```
{$WARN SYMBOL_PLATFORM OFF} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-11T15:18:37.943

编译器警告可以在“Delphi Compiler | 提示和警告'

# java - 解释反编译的 java 类的结果代码时出现问题：MyType.access$102

> ID：870864
> 
> 赞同：2
> 
> 时间：2009-05-15T21:03:33.767
> 
> 标签：java, decompiling

我正在尝试在我们正在使用的第三方框架中稍微扩展一个未记录的类。我用 jd-gui 反编译了 .class 文件，看到一个内部类定义如下：

```
private class DeactivateAction extends AbstractAction {
    public DeactivateAction() {
        super("Deactivate");
    }

    public void actionPerformed(ActionEvent paramActionEvent) {
        if (MyContainingType.this.someBoolean) {
            MyContainingType.access$102(MyContainingType.this, false);
            MyContainingType.this.add(MyContainingType.this.interceptor);
        }
    }
} 
```

我不确定如何解释此处的“access$102”行。MyContainingType 扩展 javax.swing.JLayeredPane。这不会为我编译，所以我如何解释它并在我的扩展类中正确转换它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T21:16:44.830

那是一个合成访问器。

即使是内部类也不能真正访问其封闭类的私有成员。编译器“合成”默认（包）访问方法以允许内部类使用封闭类的私有字段。

您应该能够查看封闭类以弄清楚在`access$102`做什么。

该`javap`工具带有 -c 选项也非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:45:57.253

AFAIK jd-gui 仍在改进内部类。在 0.2.9 版之前，我根本无法反编译内部类。现在它工作得更好了，我真的很期待下一个版本！

'access$102' 在我看来就像一个静态方法的占位符。您应该能够在 MyContainingType 中找到具有类似签名的内容。

# objective-c - 多线程和自动释放池在 Cocoa 中可以一起工作吗？

> ID：870873
> 
> 赞同：6
> 
> 时间：2009-05-15T21:05:37.523
> 
> 标签：objective-c, cocoa, multithreading

我想将一个对象从工作线程发送回主线程。但是自动释放池在线程之间工作吗？下面的代码有什么问题吗：

```
-(void)mainThreadReceiveResult:(id)response
{
  [response retain];
    /* Do some stuff with response */
  [response release];
}

-(void)workerThreadDoWork
{

 NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

 response * response = [[[response alloc] init] autorelease];
 response->someData = [self getSomeData];

 [delegate performSelectorOnMainThread:@selector(receiveResult:) withObject:response waitUntilDone:NO];

 [pool release];    

} 
```

似乎工作正常。但是，工作线程是否有可能`[pool release]`在主线程能够保留它之前到达？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T21:38:02.483

您的代码不应崩溃：`performSelectorOnMainThread:`在选择器完成之前保留其参数，因此您的保留/释放对是多余的。

请参阅[文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/performSelectorOnMainThread:withObject:waitUntilDone:)：

> 此方法保留接收器和 arg 参数，直到执行选择器之后。

另外：您可能应该`[pool drain]`代替`[pool release]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:16:04.517

[这](http://www.cocoabuilder.com/archive/message/cocoa/2009/4/28/235516)可能会回答你的问题。

这是他为解决问题所做的。该链接中给出了解释。

```
- (void)runSomethingThatWillFail:(NSError **)error {
   NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
   NSArray *directoryContents = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:@"/BOGUS" error:error];
   [*error retain];
   [pool release];
   [*error autorelease];
} 
```

# asp.net - VS2008 中 img 元素上的 src 属性的奇怪行为插入 [A] 字符

> ID：870874
> 
> 赞同：0
> 
> 时间：2009-05-15T21:05:54.713
> 
> 标签：asp.net

使用 VS2008 SP1，我在 aspx 文件中有这样一行代码：

```
<img src='http://spiurl.appspot.com/<%#DataBinder.Eval(Container.DataItem, "UserName") %>' style='border:0; cursor:pointer;'/> 
```

这完美地工作。但是，如果我在 IDE 中切换到“设计”模式，然后回到“源”模式，则字符**[A]**会神奇地/令人发指地插入 src 属性的开头，我最终会得到：

```
<img src='[A]http://spiurl.appspot.com/<%#DataBinder.Eval(Container.DataItem, "UserName") %>' style='border:0; cursor:pointer;'/> 
```

...当然是坏了。有没有其他人见过这种烦恼？你有解决方案吗？

更新：实际上，每次尝试保存文件时都会发生这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T16:07:07.827

我应用了 Microsoft 的修补程序，问题就消失了：

[IDE 序列化修补程序](http://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=17185)

# c++ - 为什么 iplRotate() 没有给我正确的结果？

> ID：870878
> 
> 赞同：4
> 
> 时间：2009-05-15T21:07:06.380
> 
> 标签：c++, windows, image-processing, intel-ipp

*叹息*我很抱歉地说我在我正在处理的一些图像处理代码中使用英特尔 IPL（图像处理库）。这是我努力让图像正确旋转的故事。

1.  我有一个源图像。它的大小**(w, h)**不一定是正方形。
2.  它将旋转角度**theta**。
3.  我已经计算了适合大小为**(w, h)**的图像旋转角度**theta**所需的输出大小。这个大小是**(dw, dh)**。我已经分配了一个具有该大小的目标缓冲区。
4.  我想通过围绕源图像中心**（w/2，h/2）****的角度****theta**旋转源图像，并使旋转后的图像在我的目标缓冲区中居中。

 ******iplRotate** () 采用 2 个移位参数**xShift**和**yShift**，它们表示执行旋转后图像应沿 x 和 y 轴移动的距离。

问题是我无法让 iplRotate 在目标图像中居中旋转图像。它总是偏离中心。

**我对 xShift 和 yShift应该是**什么的最佳猜测如下：

*   **xShift** = **dw** - **w**
*   **yShift** = **dh** - **h**

但这不起作用，我不确定还有什么可以计算**xShift**和**yShift**。有人对如何使用 iplRotate 做我想做的事有任何建议吗？

*最后一点信息：* 我尝试使用 iplGetRotateShift() 再次计算 xShift 和 yShift，但无济于事。我想这会起作用：

```
iplGetRotateShift(dw / 2.0, dh / 2.0, theta, &xShift, &yShift); 
```

但事实并非如此。

* * *

**编辑：** 我使用 Intel IPP 6.0 而不是 IPL 重写了代码，我看到了相同的错误结果。我无法想象英特尔在 2 个不同的库中轮换错误，所以我一定做错*了什么*。

* * *

**编辑：** 我尝试了 Dani van der Meer 建议的以下（IPP）代码：

```
xShift = (dw - w) / 2.0;
yShift = (dh - h) / 2.0;
ippiAddRotateShift(w / 2.0, h / 2.0, angle, &xShift, &yShift); 
```

不幸的是，仍然没有运气。那也不行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T16:04:11.230

使用 iplGetRotateShift 时，您需要在源图像中指定旋转中心。如果源图像和目标图像的大小相同，这将很有效。

在您的情况下，您需要额外的转变以使图像在目标图像中居中：

```
xShift = (dw - w) / 2.0;
yShift = (dh - h) / 2.0; 
```

要结合这两个班次，您需要使用 ippiAddRotateShift 而不是 ippiGetRotateShift。

**注意**：这些函数参考IPP库5.3版（我有的版本）。我不确定 AddRotateShift 在 IPL 中是否可用。但是您在问题中提到您尝试使用 IPP 进行相同的操作，因此希望您可以使用 IPP 而不是 IPL。

你得到这样的东西

```
xShift = (dw - w) / 2.0;
yShift = (dh - h) / 2.0;
ippiAddRotateShift(w / 2.0, h / 2.0, angle, &xShift, &yShift); 
```

如果您在调用 ippiRotate 时使用这些转换，则图像应位于目标图像的中心。

我希望这有帮助。

**编辑：** 这是我用来测试的代码（从 w 到 dw 和 h 到 dh 的变化和旋转角度只是随机的）：

```
//Ipp8u* dst_p; Initialized somewhere else in the code
//Ipp8u* src_p; Initialized somewhere else in the code
int w = 1032;
int h = 778;
int dw = w - 40; // -40 is just a random change
int dh = h + 200; // 200 is just a random change
int src_step = w * 3;
int dst_step = dw * 3;
IppiSize src_size = { w, h };
IppiRect src_roi  = { 0, 0, w, h };
IppiRect dst_rect = { 0, 0, dw, dh };
double xShift = ((double)dw - (double)w) / 2.0;
double yShift = ((double)dh - (double)h) / 2.0;
ippiAddRotateShift((double)w / 2, (double)h / 2, 37.0, &xShift, &yShift);
ippiRotate_8u_C3R(src_p, src_size, src_step, src_roi, 
          dst_p, dst_step, dst_rect, 37.0, xShift, yShift, IPPI_INTER_NN); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T20:44:58.980

如果它仍然不适合您，那么我们可以确认这些假设是有效的吗？特别是第 3 点，您计算 dw 和 dh。

数学上

dw = w * |cos(theta)| + h * |sin(θ)|
dh = h * |cos(theta)| + w * |sin(θ)|

所以如果 theta = pi/6 说，那么如果 w = 100 和 h = 150 那么大概 dw = 162？

您得到的不正确位置是否随 theta 变化？大概它适用于theta = 0？theta=pi/2 和 theta=pi/4 呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T05:32:51.873

根据我对文档的阅读，我认为您使用 iplGetRotateShift 错误。特别是，我认为您需要在源图像中指定旋转中心，而不是目标图像，因此：

```
iplGetRotateShift( w / 2.0,  h / 2.0, angle, &xShift, &yShift ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T21:52:40.347

我以前从未使用过（或听说过）IPL，所以我只是在猜测 API 的作用。但是，如果 iplRotate 围绕 (0, 0) 旋转并且如果 iplGetRotateShift 类似，为什么不尝试旋转原始“盒子”的其他 3 个角（忽略 (0, 0)，因为它保持不变）： (w, 0), ( 0, h) 和 (w, h)。

您的结果将是一个带有一些负值的新框。你想“向后移动”，所以如果你明白我的意思，你所拥有的任何负值都会变为零。

# ruby-on-rails - 在 Win32 上部署 Rails 最佳实践：Lighty + Sgci

> ID：870882
> 
> 赞同：0
> 
> 时间：2009-05-15T21:08:36.893
> 
> 标签：ruby-on-rails, ruby, winapi, deployment, lighty

我从该站点的用户那里得到了一些非常好的指导，我认为一些高级 Rails 人员可以帮助我解决以下问题。

我正在尝试在 win32 服务器上部署一个简单的 Rails 应用程序。

我一直在仔细阅读这些说明（请参阅[http://functionalelegant.blogspot.com/2008/05/deploying-rails-on-windows.html](http://functionalelegant.blogspot.com/2008/05/deploying-rails-on-windows.html)）以进行 win32 Rails 应用程序部署。

我从或多或少的干净 Windows 安装开始，然后下载并安装

1.  红宝石
2.  轻型TPD
3.  导轨
4.  Zed 的 SCGI Rails Runner
5.  Windows Server 2003 资源工具包工具
6.  Ruby/DBI ADO 包

之后，我做了以下事情：

我已经注释掉了 SCGI gem 中的那一行（这实际上是造成了麻烦。）

我按照建议创建了目录结构，其中包含日志文件夹。

我修改了 scgi.yaml 文件和 Lighty 配置文件以反映我的环境设置。

之后，我编写了批处理脚本来启动 Lighty 和 SGCI 进程。它们似乎运行正确。但是，在 app-errors.log 中会出现以下几行：

```
2009-05-15 16:48:06: (mod_scgi.c.2645) fcgi: got a FDEVENT_ERR. Don't know why. 
2009-05-15 16:48:06: (mod_scgi.c.2469) emergency exit: scgi: connection-fd: 7 fcgi-fd: 8 
```

* * *

最后，当我导航到[http://localhost:xxxx/](http://localhost:xxxx/)时，我只看到一个空白页面。**更新**：我刚刚意识到空白页似乎只是。查看源代码发现以下问题：

```
2C:/Ruby/lib/ruby/1.8/drb/drb.rb:573:in `load'":C:/Ruby/lib/ruby/1.8/drb/drb.rb:612:in `recv_request'":C:/Ruby/lib/ruby/1.8/drb/drb.rb:911:in `recv_request'"?C:/Ruby/lib/ruby/1.8/drb/drb.rb:1530:in `init_with_client'"<C:/Ruby/lib/ruby/1.8/drb/drb.rb:1542:in `setup_message'"6C:/Ruby/lib/ruby/1.8/drb/drb.rb:1494:in `perform'"8C:/Ruby/lib/ruby/1.8/drb/drb.rb:1589:in `main_loop'"3C:/Ruby/lib/ruby/1.8/drb/drb.rb:1585:in `loop'"8C:/Ruby/lib/ruby/1.8/drb/drb.rb:1585:in `main_loop'"4C:/Ruby/lib/ruby/1.8/drb/drb.rb:1581:in `start'"8C:/Ruby/lib/ruby/1.8/drb/drb.rb:1581:in `main_loop'"2C:/Ruby/lib/ruby/1.8/drb/drb.rb:1430:in `run'"4C:/Ruby/lib/ruby/1.8/drb/drb.rb:1427:in `start'"2C:/Ruby/lib/ruby/1.8/drb/drb.rb:1427:in `run'"9C:/Ruby/lib/ruby/1.8/drb/drb.rb:1347:in `initialize'"2C:/Ruby/lib/ruby/1.8/drb/drb.rb:1627:in `new'"<C:/Ruby/lib/ruby/1.8/drb/drb.rb:1627:in `start_service'"MC:/Ruby/lib/ruby/gems/1.8/gems/scgi_rails-0.4.3/lib/scgi.rb:402:in `run'"HC:/Ruby/lib/ruby/gems/1.8/gems/scgi_rails-0.4.3/bin/scgi_service:61"*C:/Ruby/bin/scgi_service:19:in `load'" C:/Ruby/bin/scgi_service:19:   mesg" too large packet 
```

请注意，“ruby 脚本/服务器”运行得很好，但该页面无法在外部看到。

有任何想法吗？请让我知道是否有任何事情发生在你身上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T01:36:58.900

我在“部署 Rails 应用程序”中为此编写了这一章。[http://www.pragprog.com/titles/fr_deploy/deploying-rails-applications](http://www.pragprog.com/titles/fr_deploy/deploying-rails-applications)

基本上，您需要 mongrel、mongrel_service 和 apache 2.2 以及适用于 windows 的 mod_proxy_balancer。

您安装了 2 个或更多应用程序实例，并在不同的端口上运行 Mongrel。您将服务设置为自动启动。

然后你设置 apache 来平衡它们。

这在书中都有概述，我的网站上也有一些较早的文章——如果你搜索“在 windows 上脱轨”，你会发现一些非常过时的东西。apache+mongrel 方式是目前适用于 Windows 的最佳方式，如果您需要其他帮助，请随时告诉我。我很乐意提供帮助。

# mysql - 如何强制事件在 MySQL 中执行

> ID：870883
> 
> 赞同：12
> 
> 时间：2009-05-15T21:08:45.347
> 
> 标签：mysql

我正在尝试编写一个自动化测试脚本来测试我创建的 MySQL 事件，我想知道是否有办法执行某种命令来强制事件立即执行。事件设置为每天午夜运行，但我不希望自动化测试脚本必须等待事件触发。

我能想到的一种方法是改变事件让它在未来 5 秒内执行一次，但我想知道是否有更优雅的方法让它执行。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-21T04:40:58.283

1.  将事件中的所有代码移动到存储过程中
2.  使事件只调用存储过程
3.  使用 CALL 语法测试存储过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:23:28.603

如果它基于系统时间，请更改它，并查看您的事件是否触发，然后将系统时间更改回来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-14T09:59:25.327

另一个“代理”解决方案是尽快安排它，例如：每隔 10 秒（或 1 秒，取决于事件的运行时间）安排一次。您可以稍后删除该事件。

# wpf - WPF 应用程序在 Visual Studio 之外崩溃

> ID：870893
> 
> 赞同：1
> 
> 时间：2009-05-15T21:11:25.823
> 
> 标签：wpf, visual-studio

我有一个 WPF 应用程序在 VS.NET 中运行得非常好，但是如果我尝试在 VS.NET 之外运行它，我会得到一个“......遇到问题并需要关闭......”对话框。这发生在调试和发布模式下。为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T21:16:43.673

这很可能是一个未捕获的异常。您可能想尝试使用[Application.DispatcherUnhandledException 事件](http://msdn.microsoft.com/en-us/library/system.windows.application.dispatcherunhandledexception.aspx)来显示带有异常的消息框以缩小问题范围：

将此添加到您的 App.xaml 作为`<Application>`标记的属性：

```
DispatcherUnhandledException="Application_DispatcherUnhandledException" 
```

而该处理程序的实现可能如下所示：

```
private void Application_DispatcherUnhandledException(object sender, System.Windows.Threading.DispatcherUnhandledExceptionEventArgs e)
{
    System.Windows.MessageBox.Show(e.Exception.ToString());
} 
```

但如果没有太多上下文，这可能是导致它的任何原因，并且您在查看异常时可能会更好地理解它的来源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T21:26:55.490

确保您的可执行文件需要在与可执行文件相同的文件夹中运行所需的所有库，以及任何必要的配置文件或清单文件。

您是否已经尝试直接从调试/发布文件夹运行应用程序？您的所有参考文献都标记为“复制到输出目录”吗？

要检查的另一件事是您的项目文件未配置为向您的应用程序添加参数。

# asp.net - 如何使用存储过程从 linq 2 sql 将数据插入两个表

> ID：870902
> 
> 赞同：-1
> 
> 时间：2009-05-15T21:13:45.803
> 
> 标签：asp.net

我将 linq 2 sql 与 asp.net mvc 一起使用。我有两个表 schedular 和 schdulerhistory 并且我有一个存储过程，它将通过一个事务在这两个表中插入数据。

我想将该存储过程与 linq 一起使用。我如何用 linq 2 sql 完成这些事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T15:58:25.443

一个带有两个插入的存储过程：

```
CREATE PROCEDURE YouProcedureName
(
     @Params1         char(2)
    ,@Params2         int
    ,@Params3         varchar(10)
)
AS 

INSERT INTO YourTable1
        (Col1    , Col2)
    VALUES
        (@Parms1 , @Params2)

INSERT INTO YourTable2
        (Col1    , Col3)
    VALUES
        (@Parms1 , @Params3)

GO 
```

如何从 LINQ 调用存储过程：

[http://www.mssqltips.com/tip.asp?tip=1542](http://www.mssqltips.com/tip.asp?tip=1542)

[http://www.google.com/search?hl=en&as_q=linq+to+sql%2C+how+to+call+a+stored+procedure&as_epq=&as_oq=&as_eq=&num=100&lr=&as_filetype=&ft=i&as_sitesearch= &as_qdr=所有&as_rights=&as_occt=any&cr=&as_nlo=&as_nhi=&safe=图像](http://www.google.com/search?hl=en&as_q=linq+to+sql%2C+how+to+call+a+stored+procedure&as_epq=&as_oq=&as_eq=&num=100&lr=&as_filetype=&ft=i&as_sitesearch=&as_qdr=all&as_rights=&as_occt=any&cr=&as_nlo=&as_nhi=&safe=images)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:15:17.717

Scott Gu 有[一篇](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)关于在 LINQ to SQL 中使用存储过程的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T21:17:28.523

在您的服务器资源管理器中，将您的存储过程拖到您的 DBML 文件中。

完成此操作后，您可以创建 DataContext 对象的实例并直接调用该存储过程，就好像它是类级别的方法一样。

例如：

MyDataContext db = new MyDataContext();

var storedProcedureResultSet = db.NameOfMyStoredProcedure(参数);

# sysadmin - 每个系统管理员都应该知道哪些编程知识？

> ID：870907
> 
> 赞同：3
> 
> 时间：2009-05-15T21:14:08.017
> 
> 标签：sysadmin

这是此问题的镜像： [https ://serverfault.com/questions/4176/what-sysadmin-things-should-every-programmer-know](https://serverfault.com/questions/4176/what-sysadmin-things-should-every-programmer-know)

原件由[Nathan DeWitt](https://stackoverflow.com/users/1753/nathan-dewitt)发布。应该归功于他。如果您有服务器故障帐户，[请访问他的原始问题并敲击它](https://serverfault.com/questions/4176/what-sysadmin-things-should-every-programmer-know)以表示感谢此询问。

套用内森：

作为系统管理员，我们倾向于将程序员视为理所当然。有几次我没有一个好的程序员真的让我很欣赏你们所做的事情。当我们冒险进入一个没有程序员的环境时，你能给我们什么智慧之言？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T21:16:53.190

程序员需要访问互联网资源（例如 StackOverflow）。不要阻止我们访问 kthnx。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T12:08:28.290

系统管理员应该知道可以提高效率的东西。

这包括他们正在使用的 shell 的所有功能（`bash`这些天非常流行）。手册中有许多非常有用的东西值得研究（从键盘快捷键到数组到正则表达式）。

看到一个初级系统管理员试图手动登录 200 台服务器并在 /etc 中的某个文件中切换一行，这令人非常难过

如果我要招聘一名管理员，我会要求具有编程语言的高级（但不是专家）知识。它是什么语言并不重要，因为他可以很容易地切换到其他东西，但是如果他从未编写过任何代码，**他将不知道他在手动完成的事情上浪费了多少（宝贵的）时间几行代码。**

管理员往往喜欢 bash、php、python、awk 和 perl。他们中的任何一个都至少会使他们在重复性任务上的工作效率提高三倍。

另一方面，编码人员应该知道 httpd 和负载均衡器的配置，否则他们**将**重新发明轮子。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T21:16:48.043

我认为系统管理员*是*一种程序员。所以他们应该能够考虑编程；有效地使用脚本语言，并在其中编写清晰、有据可查的程序；对编程项目的工作原理有一定的了解。

理想情况下，他们应该阅读敏捷方法，因为快速开发小型、多变的程序是他们生活的常态。他们应该了解测试，如果他们使用现代脚本语言，他们应该了解单元测试工具，一些变体xUnit。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T22:34:00.463

珀尔。

确实。

# oop - 为什么 Haskell 代数数据类型是“封闭的”？

> ID：870919
> 
> 赞同：59
> 
> 时间：2009-05-15T21:17:04.267
> 
> 标签：oop, haskell, types, functional-programming, type-systems

如果我错了，请纠正我，但 Haskell 中的代数数据类型似乎在您将在 OO 语言中使用类和继承的许多情况下很有用。但是有一个很大的区别：一旦声明了代数数据类型，就不能在其他地方进行扩展。它是“关闭的”。在 OO 中，您可以扩展已定义的类。例如：

```
data Maybe a = Nothing | Just a 
```

以后我不可能在不修改此声明的情况下以某种方式向此类型添加另一个选项。那么这个系统有什么好处呢？看起来面向对象的方式会更具可扩展性。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-05-16T00:37:32.537

答案与代码易于扩展的方式、类和代数数据类型之间的紧张关系有关，Phil Wadler 称之为“表达式问题”：

*   对于代数数据类型，

    *   在事物上添加新*操作*非常*便宜*：您只需定义一个新函数。这些东西上的所有旧功能继续保持不变。

    **   添加一种新*的东西*是非常*昂贵*的：你必须为现有的数据类型添加一个新的构造函数，并且你必须*编辑和重新编译每个使用该类型的函数*。* 
****   随着课堂，

    *   添加一种新*的东西*非常*便宜*：只需添加一个新的子类，并根据需要在该类中为所有现有操作定义专门的方法。超类和所有其他子类继续保持不变。

    **   在事物上添加新*操作*非常*昂贵*：您必须向*超类添加新方法声明，*并可能*向每个现有子类添加方法定义*。在实践中，负担因方法而异。**** 

 ***因此，代数数据类型是封闭的，因为封闭类型很好地支持某些类型的程序演化。例如，如果您的数据类型定义了一种语言，则很容易添加新的编译器通道，而不会使旧的编译器无效或更改数据。

可以有“开放”数据类型，但除非在仔细控制的情况下，类型检查变得困难。**Todd Millstein 在支持开放代数类型和可扩展函数的语言设计上做了一些[非常出色的工作](http://www.cs.ucla.edu/~todd/research/pub.php?id=icfp02)**，所有这些都带有模块化类型检查器。我发现他的论文读起来非常愉快。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-05-15T21:48:31.133

ADT 是封闭的这一事实使得编写总函数变得容易得多。对于其类型的所有可能值，这些函数总是产生结果，例如。

```
maybeToList :: Maybe a -> [a]
maybeToList Nothing  = []
maybeToList (Just x) = [x] 
```

如果`Maybe`是打开的，有人可以添加一个额外的构造函数，`maybeToList`函数会突然中断。

在 OO 中，这不是问题，当您使用继承来扩展类型时，因为当您调用没有特定重载的函数时，它可以只使用超类的实现。即，如果`printPerson(Person p)`对象是.`Student``Student``Person`

在 Haskell 中，当您需要扩展类型时，通常会使用封装和类型类。例如：

```
class Eq a where
   (==) :: a -> a -> Bool

instance Eq Bool where
  False == False = True
  False == True  = False
  True  == False = False
  True  == True  = True

instance Eq a => Eq [a] where
  []     == []     = True
  (x:xs) == (y:ys) = x == y && xs == ys
  _      == _      = False 
```

现在，该`==`函数已完全开放，您可以通过使其成为类的实例来添加自己的类型`Eq`。

* * *

请注意，已经有关于[可扩展数据类型](http://www.haskell.org/haskellwiki/Extensible_datatypes)的想法的工作，但这绝对不是 Haskell 的一部分。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-15T21:37:37.040

如果你写一个像

```
maybeToList Nothing = []
maybeToList (Just x) = [x] 
```

那么您就知道它永远不会产生运行时错误，因为您已经涵盖了所有情况。一旦 Maybe 类型是可扩展的，这就不再成立了。在您需要可扩展类型的情况下（而且它们比您想象的要少），规范的 Haskell 解决方案是使用类型类。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-15T23:17:16.287

检查“开放数据类型和开放功能” [http://lambda-the-ultimate.org/node/1453](http://lambda-the-ultimate.org/node/1453)

> 在面向对象的语言中，很容易通过定义新的类来扩展数据，但很难添加新的函数。在函数式语言中，情况正好相反：添加新函数没有问题，但**扩展数据（添加新的数据构造函数）需要修改现有代码**。支持两个方向的可扩展性问题称为**表达式问题**. 我们将开放数据类型和开放函数作为 Haskell 语言中表达问题的轻量级解决方案。这个想法是开放数据类型的构造函数和开放函数的方程可以分散在整个程序中。特别是，它们可能驻留在不同的模块中。预期的语义如下：程序应该表现得好像数据类型和函数是封闭的，定义在一个地方。函数方程的顺序由最佳匹配模式匹配确定，其中特定模式优先于非特定模式。我们展示了我们的解决方案适用于表达式问题、泛型编程和异常。我们勾勒出两个实现。一个简单的，源自语义，

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-03-20T23:41:10.240

关于这个（诚然是老的）问题的一些很好的答案，但我觉得我必须投入我的几分钱。

> 以后我不可能在不修改此声明的情况下以某种方式向此类型添加另一个选项。那么这个系统有什么好处呢？看起来面向对象的方式会更具可扩展性。

我相信，这个问题的答案是，开和给你的那种可扩展性*并不*总是一个优点，相应地，OO 强加给你的事实*是*一个弱点。

封闭联合的优势在于其**详尽无遗**：如果您在编译时修复了所有备选方案，那么您可以确定不会出现您的代码无法处理的不可预见的情况。这在许多问题领域中都是有价值的属性，例如，在语言的抽象语法树中。如果您正在编写编译器，该语言的表达式属于预定义的、封闭的子案例集——您*不*希望人们能够在运行时添加您的编译器不理解的新子案例！

事实上，编译器 AST 是访问者模式的经典四人组激励示例之一，它是封闭求和和穷举模式匹配的 OOP 对应物。反思一下 OO 程序员最终发明了一种模式来恢复封闭总和这一事实是有启发性的。

同样，过程和函数程序员已经发明了模式来获得求和的效果。最简单的是“函数记录”编码，对应OO接口。函数记录实际上是一个*调度表*。（请注意，C 程序员多年来一直在使用这种技术！）诀窍在于，给定类型的函数通常有大量可能——通常是无限多的。因此，如果您有一个字段是函数的记录类型，那么它可以轻松支持天文数字般的大或无限的替代方案集。更重要的是，由于记录是在运行时创建的，并且可以根据运行时条件灵活地完成，因此替代方案是*后期绑定的*。

我要说的最后一点是，在我看来，OO 让太多人相信可扩展性是*后期绑定*的同义词（例如，在运行时向类型添加新子案例的能力），而事实并非如此一般正确。后期绑定是**一种**可扩展性技术。另一种技术是**组合**——从固定的构建块词汇和将它们组合在一起的规则构建复杂的对象。理想情况下，词汇和规则很小，但经过精心设计，它们具有丰富的交互作用，使您可以构建非常复杂的事物。

函数式编程——尤其是 ML/Haskell 静态类型的风格——长期以来一直强调组合而不是后期绑定。但实际上，这两种技术都存在于两种范式中，并且应该包含在优秀程序员的工具包中。

还值得注意的是，编程语言本身就是组合的基本示例。编程语言有一个有限的、希望是简单的语法，它允许你组合它的元素来编写任何可能的程序。（这实际上可以追溯到上面的编译器/访问者模式示例并激发它。）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-15T21:56:33.313

首先，与查理的回答相反，这不是函数式编程所固有的。OCaml 具有[开放联合或多态变体](https://stackoverflow.com/q/5131954/60462)的概念，它们基本上可以满足您的需求。

至于*为什么*，我相信选择 Haskell 是因为

*   这让类型是可预测的 - 它们只是每个构造函数的有限数量
*   定义自己的类型很容易。
*   许多 Haskell 函数是多态的，类允许您扩展自定义类型以适应函数参数（想想 Java 的接口）。

所以如果你想要一个`data Color r b g = Red r | Blue b | Green g`类型，它很容易制作，你可以很容易地让它像一个 monad 或一个 functor 或者其他函数需要的那样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-18T14:41:54.380

另一种（或多或少）直观的查看数据类型和类型类与面向对象类的方法如下：

OO 语言中的类*Foo*既代表具体类型*Foo*，也代表所有*Foo*类型的类：直接或间接从*Foo*派生的类。

在 OO 语言中，您只是碰巧对*Foo*类型的类进行了隐式编程，这允许您“扩展” *Foo*。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-15T21:24:17.620

好的，这里的“开放”是指“可以派生”，而不是 Ruby 和 Smalltalk 意义上的开放，您可以在运行时使用新方法扩展类，对吗？

在任何情况下，请注意两件事：首先，在大多数主要基于继承的 OO 语言中，有一种方法可以声明一个类来限制它被继承的能力。Java 有“final”，在 C++ 中有针对此的 hack。因此，它只是将其他 OO 语言作为默认选项。

其次，您仍然*可以*创建一个使用封闭 ADT 并添加其他方法或不同实现的新类型。所以你并没有真正受到这种方式的限制。同样，它们似乎在形式上具有相同的强度；你可以用一种表达的东西可以用另一种表达。

真正的事情是函数式编程确实是一种不同的范式（“模式”）。如果您期望它应该像一门 OO 语言，您会经常感到惊讶。

# xcode - 如何搜索 Xcode 文档集

> ID：870924
> 
> 赞同：1
> 
> 时间：2009-05-15T21:19:04.370
> 
> 标签：xcode, search, full-text-search, document

这是另一个非常愚蠢的问题。Xcode 有一个开发者文档窗口。有些部分专门用于对语言参考搜索的结果进行排序。

没有搜索栏。没有显示“搜索：”的按钮。没有放大镜。

我在找什么？Google 不明白我的问题，我想我会在 Wolfram Alpha 今晚出来之前问你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T21:22:24.037

我确实看到了一个搜索栏。

来自 Xcode：

*   点击帮助->文档
*   在工具栏上的开发人员文档窗口的右上角有一个搜索栏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T21:25:04.933

啊，谢谢你。更具体地说，它在右上角隐藏了这个搜索栏的匿名灰色长方形按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T21:23:49.243

这并不能真正回答您的问题，但我一直发现 Google 能够比 Xcode 的内置文档更快地找到相关文档。我只是打开一个浏览器窗口，并将默认搜索框设置为使用 google，站点仅限于 developer.apple.com：

> [http://www.google.com/search?q=SOMETHING+site%3Adeveloper.apple.com](http://www.google.com/search?q=SOMETHING+site%3Adeveloper.apple.com)

# python - 如何在 SQLAlchemy 中使用引擎的 SQL 方言生成带有 DDL 的文件？

> ID：870925
> 
> 赞同：10
> 
> 时间：2009-05-15T21:19:13.543
> 
> 标签：python, sqlalchemy

假设我`engine`指向 MySQL 数据库：

```
engine = create_engine('mysql://arthurdent:answer42@localhost/dtdb', echo=True) 
```

我可以通过以下方式填充`dtdb`表格、FK 等：

```
metadata.create_all(engine) 
```

有没有一种简单的方法来生成包含所有 DDL 语句的 SQL 文件，而不是将这些 DDL 语句实际应用于`dtdb`？

到目前为止，我已经求助于捕获由 生成的 SQLAlchemy 日志输出`echo=True`，并手动对其进行编辑。但这太痛苦了。

看起来 SA 有非常精细的模式管理 API，但我还没有看到简单地将模式定义流式传输为文本的示例。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-15T21:33:37.847

快速答案在[SQLAlchemy 0.8 FAQ](http://docs.sqlalchemy.org/en/rel_0_8/faq.html#how-can-i-get-the-create-table-drop-table-output-as-a-string)中。

在 SQLAlchemy 0.8 你需要做

```
engine = create_engine(
'mssql+pyodbc://./MyDb',
strategy='mock',
executor= lambda sql, *multiparams, **params: print (sql.compile(dialect=engine.dialect))) 
```

在 SQLAlchemy 0.9 中，语法被简化了。

```
engine = create_engine(
'mssql+pyodbc://./MyDb',
strategy='mock',
executor= lambda sql, *multiparams, **params: print (sql) 
```

更长的答案是捕获输出仍然存在一些小问题。就像类型文字的编码一样。但这对于任何人来说都不是一个足够大的问题，以至于不能站出来挠痒痒。您总是可以让 SQLAlchemy 以编程方式创建一个空数据库并从那里转储 SQL。

更困难的问题是模式迁移的处理。这是[SQLAlchemy-migrate](https://github.com/openstack/sqlalchemy-migrate)可以帮助你的地方。

# sql-server-2005 - SQL 2005 XML 模式 - 定义唯一属性

> ID：870926
> 
> 赞同：1
> 
> 时间：2009-05-15T21:20:06.910
> 
> 标签：sql-server-2005, attributes, xsd, unique

这是我正在尝试为其创建架构的示例 xml 文档：

```
'<Fields>
  <Field ID="-1">somevalue</Field>
  <Field ID="-2" />
  <Field ID="-3" />
  <Field ID="-4">Some other value</Field>
  <Field ID="-5" />
</Fields>' 
```

我正在尝试创建一个 SQL Server 2005 架构集合以：
1\. 防止重复 ID。
2\. 只允许负ID。

我可以使用 id 属性的 type="xs:negativeInteger" 来实现负约束。但是我不能在 SQL 2005 中创建唯一约束或 key\keyref。如果我设置我的 type="xs:ID"，那么我根本不能使用数字作为我的 ID 值，更不用说负 ID。

要么我错过了什么，要么不可能。如果不可能，为什么 SQL 2005 不支持拥有唯一属性的能力？是否可以在表上使用约束\触发器或 xml 索引，或者我现在无法想象的其他一些技术？

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T03:33:50.833

这是使用[“唯一”](http://www.w3.org/TR/2004/REC-xmlschema-1-20041028/structures.html#cIdentity-constraint_Definitions)的解决方案（“密钥”也可以）：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Fields">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" ref="Field"/>
      </xs:sequence>
    </xs:complexType>

    <xs:unique name="nearlyID">
      <xs:selector xpath=".//*"/>  
      <xs:field xpath="@ID"/>
    </xs:unique>
  </xs:element>

  <xs:element name="Field">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:string">
          <xs:attribute name="ID" type="xs:negativeInteger"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

它验证您的示例，并给出以下错误：

1.  重复的身份证
2.  id 不是负整数。

这是您的 eg plus 测试：

```
<Fields>
  <Field ID="-1">somevalue</Field>
  <Field ID="-2" />
  <Field ID="-3" />
  <Field ID="-4">Some other value</Field>
  <Field ID="-5" />

  <Field ID="-2"   >  not unique   </Field>
  <Field ID="2"    >  not negative </Field>
  <Field ID="hello">  not integer  </Field>
</Fields> 
```

*编辑*我不知道这是否是最好的方法，或者即使它是一个好方法。它有效，但我认为可能有一种更简单、更直接的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-25T21:08:21.667

这是一篇旧文章，但今天仍然相关，因为不支持独特的语法（并且不需要下面的答案）。

您需要做的是创建一个模式绑定标量函数，该函数将提取您希望唯一的值。

然后在包含 xml 列的表上创建一个持久计算列。这个计算列将执行上面定义的模式绑定函数。

最后，您在持久计算列上定义唯一约束。现在它不仅保证了唯一性，而且还为快速搜索建立了索引。

编辑 -

这适用于需要在多行中唯一的顶级属性。

如果您需要在单个 xml 文档中的元素集合中具有唯一性，则方法类似。

您创建了一个函数，该函数将 xml 数据类型作为参数，并具有返回值 BIT。

然后，您在 xml 数据类型上使用 xpath 来自己检查唯一性。如果值是唯一的，则返回 1，否则返回 0。

最后，向调用标量函数的表添加检查约束并验证结果为 1。

# wpf - 在 WPF 中，有没有办法绑定到兄弟属性？

> ID：870931
> 
> 赞同：24
> 
> 时间：2009-05-15T21:23:21.863
> 
> 标签：wpf, data-binding, xaml

我有一系列`TextBlock`和`TextBox`控件。有没有办法将 a`Style`应用于`TextBlock`s 以便它们可以在它们之后立即数据绑定到控件？

我希望能够做这样的事情：

```
<Resources..>
    <Style x:Key="BindToFollowingTextBoxSibling">
        <Setter Property="TextBlock.Text" Value="{Binding RelativeSource={RelativeSource FollowingSibling}, Path=Text, Converter={StaticResource MyConverter}}" />
        <Setter Property="TextBlock.Background" Value="{Binding RelativeSource={RelativeSource FollowingSibling}, Path=Text, Converter={StaticResource TextToBrushConverter}}" />
        ... More properties and converters.
    </Style>
</Resources>

...

<TextBlock Style="{StaticResource BindToFollowingTextBoxSibling}"/>
<TextBox/>

<TextBlock Style="{StaticResource BindToFollowingTextBoxSibling}"/>
<TextBox/>
<TextBlock Style="{StaticResource BindToPreviousTextBoxSibling}"/> 
```

这样的事情甚至可能吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-05-24T18:07:06.667

我知道这是一个旧线程，但我**找到了解决这个问题的方法**。我能够使用 Aland Li 的建议，在[此处](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/2e2ff0d0-7138-4741-a121-d92ea2b4e698/)找到。它不像在 CSS 中那样通用，但如果您知道父元素类型，**即使在 Style 中也能**很好地工作。

这是我如何使用它的示例。我有一个 TextBox 控件，当它具有焦点时会以“突出显示颜色”点亮。此外，我希望其关联的 Label 控件在 TextBox 获得焦点时也会亮起。因此，我为 Label 控件编写了一个 Trigger，使其以与 TextBox 控件类似的方式点亮。此触发器由名为 IsFocusedByProxy 的自定义附加属性触发。然后我需要将标签的 IsFocusedByProxy 绑定到 TextBox 的 IsFocused。所以我使用了这种技术：

```
<Grid x:Name="MaxGrid">
    <Label  x:Name="MaxLabel"
            Content="Max:"  
            c5:TagHelper.IsFocusedByProxy="{Binding 
                                  Path=Children[1].IsFocused,
                                  RelativeSource={RelativeSource AncestorType=Grid}}" 
       />
     <c5:TextBoxC5Mediator x:Name="MaxTextBox"                          
                           DataContext="{Binding ConfigVm.Max_mediator}" />
</Grid> 
```

在这一点上，您可能会认为这并不比仅在 Binding 中使用 ElementName 更好。 **但不同的是，现在我可以将此绑定移动到 Style 中以实现可重用性：**

```
<Setter Property="C5_Behaviors:TagHelper.IsFocusedByProxy"
        Value="{Binding Path=Children[1].IsFocused,
                     RelativeSource={RelativeSource AncestorType=Grid}}" /> 
```

现在，当我有一个充满这些事件的视图时，我可以像这样（我已经设置了要隐式应用的必要样式，所以这就是为什么没有显示设置样式的标记的原因）：

```
<Grid x:Name="MaxGrid">
    <Label  x:Name="MaxLabel"
            Content="Max:"  />
    <c5:TextBoxC5Mediator x:Name="MaxTextBox"                          
                          DataContext="{Binding ConfigVm.Max_mediator}" />
 </Grid> 
 <Grid x:Name="MinGrid">
     <Label  x:Name="MinLabel"
             Content="Min:" />
     <c5:TextBoxC5Mediator x:Name="MinTextBox"                          
                           DataContext="{Binding ConfigVm.Min_mediator}" />
</Grid>
<Grid x:Name="StepFactorGrid">
    <Label  x:Name="StepFactorLabel"
            Content="Step Factor:" />
    <c5:TextBoxC5Mediator x:Name="StepFactorTextBox"                          
                          DataContext="{Binding ConfigVm.StepFactor_mediator}" />
</Grid>
<!-- ... and lots more ... --> 
```

**这给了我这些结果**：

在任何文本框获得焦点之前：

![在任何文本框获得焦点之前](https://i.stack.imgur.com/RB6aI.png)

使用不同的文本框接收焦点：

![焦点1后](https://i.stack.imgur.com/6r3wt.png)

![焦点2后](https://i.stack.imgur.com/7G3w4.png)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-15T21:35:37.217

我认为在这种情况下最好的办法是通过 ElementName 绑定：

```
<TextBlock Text="{Binding ElementName=textBox1, Path=Text}" />
<TextBox x:Name="textBox1">this is the textBox's 1 text</TextBox>
<TextBlock Text="{Binding ElementName=textBox2, Path=Text}" />
<TextBox x:Name="textBox2">this is the textBox's 2 text</TextBox> 
```

它会达到类似的效果。这对你有用吗？

# javascript - JavaScript 在 Mac 和 PC 上的行为不同？我知道不应该

> ID：870938
> 
> 赞同：1
> 
> 时间：2009-05-15T21:25:20.097
> 
> 标签：javascript, css, windows, macos, browser

我创建了一个分页脚本，它需要很长的文本块并将其分成页面。首先，文本被加载到 id 的 div 中`#page`。然后脚本测量高度`#page`并计算它应该分成多少页以适合`div`with 类`.detailsholder`。

将 div .detailsholder 清空，并在里面添加适当数量的页面 div。（每一个其实里面都有#page的整个文本，但是上边距设置为负数，高度固定，溢出设置为隐藏，所以只出现适量。）

它运行良好，除了这一点：Mac 上的 Safari 和 Firefox 运行良好，而 Windows 上的 IE 和 Firefox 添加了一个额外的页面。由于页面的创建方式，如上面括号中所述，最后一页显示为空白 - 文本被移动得太远而无法出现在页面中`window`。

这是代码。如您所见，我正在使用 jQuery。

```
var descHeight = $('#page').outerHeight();
if (descHeight > 250 ) {
   var numberOfPages = Math.round(descHeight/210)+1; //Figure out how many pages
   var artistText = $('#page').html();               //Grab the text into a variable
   $('.detailsholder').empty();                      //Empty the container so we can fill
                                                     //it with pages
   for (i=0;i<=numberOfPages-1;i++) {                //Each page has the entire text
                                                     //content, but is shifted up and
      var shiftUp = 0-(210 * i);                     //cut off at the bottom.
      $('.detailsholder').append('<div id="page' + (i+1) + '" class="page" style="height:225px;"><div style="border:dotted 1px red;margin-top:' + shiftUp + 'px"' + artistText + '</div>');
   }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T21:35:59.400

您是否在具有不同分辨率/字体设置的类似平台计算机上尝试过？

我认为这个问题可能更多地与显示设置和 Javascript 的 CSS 部分有关，然后是平台差异。我的 CSS 不是很好，但您可能希望避免使用 px 并尝试使用 % 代替。

**以下内容可能有助于您的诊断：**

*   [http://browsersize.com/](http://browsersize.com/)
*   [萤火虫](http://getfirebug.com/)（火狐）
*   [开发者工具栏](http://www.microsoft.com/en-us/download/details.aspx?id=18359)（针对 IE）
*   [Web Inspector](http://macdevelopertips.com/safari/firebug-like-tools-in-safari.html)（对于 Safari，没有亲自尝试过这个）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T21:47:55.627

添加一些警报以查看计算结果。如果您在不同的浏览器中得到不同的结果，那么您将不得不进行调整以处理差异

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T21:58:47.257

在脚本的最后一行，第二个开始的 div 标签：它似乎没有关闭。也许这会导致问题？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T20:34:02.880

我在算法中看到了一个问题。`Math.round`应该是`Math.floor`为了给出正确的页数。为了看看为什么假设`descHeight`是`400`。那么您将只需要 2 页的高度`210`，但是`Math.round(400/210) + 1 == 3`. 这个问题与平台之间不同的标准字体大小（这可能会影响`descHeight`和触发问题）的组合是您观察到的行为的原因吗？

# javascript - 如何将十六进制数字分配给另一个数字？

> ID：870944
> 
> 赞同：2
> 
> 时间：2009-05-15T21:27:13.493
> 
> 标签：javascript

如何将以下代码分配给数字？

```
Integer.toHexString( myHexValue ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T21:30:27.120

parseInt 的第二个可选参数是基数。

```
parseInt("0xff", 16);
// yields 255 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T21:14:46.540

您可以将十六进制值转换为“数字”。例如：

```
foo = Number(0xDEADBEEF) 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T21:31:27.117

将其转换回整数...

```
var s = "FFFFFF";
var n = parseInt("0x"+ s); 
```

# parallel-processing - 糟糕的性能 - 一个简单的开销问题，还是存在程序缺陷？

> ID：870952
> 
> 赞同：5
> 
> 时间：2009-05-15T21:30:31.723
> 
> 标签：parallel-processing, openmp, race-condition, overhead

我在这里有一个我理解的相对简单的 OpenMP 构造。问题在于，与 2 个线程相比，1 个线程的程序运行速度要快 100-300 倍。该计划的 87% 用于`gomp_send_wait()`，另外 9.5% 用于`gomp_send_post`.

该程序给出了正确的结果，但我想知道代码中是否存在导致某些资源冲突的缺陷，或者仅仅是线程创建的开销对于块大小为 4 的循环来说完全不值得。 `p`范围从 17 到 1000，取决于我们模拟的分子的大小。

我的数字是针对最坏情况的，当 p 为 17 且块大小为 4 时。无论我使用静态、动态还是引导式调度，性能都是相同的。使用`p=150`和块大小`75`，程序仍然比串行慢 75x-100x。

```
...
    double e_t_sum=0.0;
    double e_in_sum=0.0;

    int nthreads,tid;

    #pragma omp parallel for schedule(static, 4) reduction(+ : e_t_sum, e_in_sum) shared(ee_t) private(tid, i, d_x, d_y, d_z, rr,) firstprivate( V_in, t_x, t_y, t_z) lastprivate(nthreads)
    for (i = 0; i < p; i++){
        if (i != c){
            nthreads = omp_get_num_threads();               
            tid = omp_get_thread_num();

            d_x = V_in[i].x - t_x; 
            d_y = V_in[i].y - t_y;
            d_z = V_in[i].z - t_z;

            rr = d_x * d_x + d_y * d_y + d_z * d_z;

            if (i < c){

                ee_t[i][c] = energy(rr, V_in[i].q, V_in[c].q, V_in[i].s, V_in[c].s);
                e_t_sum += ee_t[i][c]; 
                e_in_sum += ee_in[i][c];    
            }
            else{

                ee_t[c][i] = energy(rr, V_in[i].q, V_in[c].q, V_in[i].s, V_in[c].s);
                e_t_sum += ee_t[c][i]; 
                e_in_sum += ee_in[c][i];    
            }

            // if(pid==0){printf("e_t_sum[%d]: %f\n", tid, e_t_sum[tid]);}

        }
    }//end parallel for 

        e_t += e_t_sum;
        e_t -= e_in_sum;            

... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-05-10T00:47:38.077

首先，我不认为在这种情况下优化您的串行代码将有助于解决您的 OpenMP 困境。别担心。

IMO 对减速有三种可能的解释：

1.  这可以很容易地解释放缓。数组 ee_t 的元素导致缓存行内的错误共享。错误共享是指内核最终写入同一缓存行，不是因为它们实际上共享数据，而是内核正在写入的内容恰好位于同一缓存行中（这就是为什么称为*错误*共享）。如果你在谷歌上没有发现虚假分享，我可以解释更多。使 ee_t 元素缓存行对齐可能会有很大帮助。

2.  生成工作的开销高于并行性收益。您是否尝试过少于 8 个内核？2核性能如何？

3.  总的迭代次数很少，比如说我们以 17 次为例。如果你把它分成 8 个核心，它会遇到负载不平衡的问题（特别是因为你的一些迭代实际上没有做任何工作（当 i == c 时）。至少一个核心必须进行 3 次迭代，而所有其他的将做2.这并不能解释减速，但肯定是加速没有你预期的那么高的一个原因。由于你的迭代长度不同，我会使用块大小为1的动态调度或使用openmp引导。尝试使用块大小，块太小也会导致速度变慢。

让我知道事情的后续。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T06:19:27.343

您似乎认为，如果您在多头模式下运行串行代码，它必须执行得更好。这不是给定的。而且，这通常不是真的。将循环并行化以在多个线程或多个处理器中运行并不总能带来更好的性能。在大多数情况下，需要进行一些重组。在您的情况下，代码甚至不是很好的串行代码。

任何关于串行代码优化的书都有规则号 1 for 循环：删除所有条件操作。测试费用。一些编译器（顺便说一句，你从不说你正在使用什么操作系统/编译器/处理器......这很重要）可以尝试优化条件代码。一些编译器（如 Sun 的 C 编译器）甚至允许您在“收集”模式下运行程序，它会生成运行时配置文件信息，说明获取条件分支的频率，然后让您在使用收集到的数据的模式下重新编译优化生成的代码。（参见 -xprofile 选项）

优化并行代码的第一条规则是首先做最好的串行优化。然后并行化循环。

通过将条件移到循环之外，并且正如 Metiu 建议的那样，将代码重写为两个单独的循环，您可以为优化器提供更好的资源来使用。串行代码运行得更好，并行化的代码并行的尴尬。

尽管如此，结果可能会因操作系统/编译器/平台而异。

请参见***[使用 OpenMP](http://mitpress.mit.edu/catalog/item/default.asp?ttype=2&tid=11387)*** 和 ***[Solaris 应用程序编程](http://www.sun.com/books/catalog/solaris_app_programming.xml)***

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T18:31:38.290

梅提乌是对的。您不能期望包含条件语句的循环具有良好的性能。这只是糟糕的编码。即使是标量性能。

您的老板需要了解 OpenMP 和并行化通常不是魔法。要从并行化代码中获得良好的性能，需要首先针对标量性能优化基本代码。

不必删除测试。循环需要重组。标量性能也将受益。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T21:42:55.267

我相信您应该尝试移出循环内的所有这些分支（即 ifs），并在两个单独的循环中执行此操作，一个用于 i < c，另一个用于 i > c。即使是单线程代码，这也会极大地受益，但它应该给你更多的并行性，即使正如你所说的线程创建开销可能大于小 n 的好处。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T02:17:13.990

首先，尝试将块大小抽得更大。线程创建会带来开销，为每个线程拾取新工作也是如此，并且粒度需要足够大以压倒它。

一个更大的可能性：GOMP 的减少实现可能非常差（由您的配置文件数据建议），它在每个块之后生成消息，而不是在每个线程中累积然后在最后收集它们。尝试将`e_t_sum`和分配为每个元素`e_in_sum`的数组，并在循环内添加 to，然后在并行循环完成后循环它们以计算全局总和。`nthreads``e_t_sum[tid]`

请注意，这会引入潜在的错误共享问题，因为这些数组的多个元素将位于公共缓存线中，并且多个处理器将写入同一缓存线。如果你在一组共享缓存的内核上运行它，这会很好，但会在其他地方发臭。

另一种可能性：您可能在对 ee_t 元素的更新中遇到错误共享。确保此数组对齐，并尝试是缓存行大小的倍数的块大小。对这种病理的一个微妙暗示是循环的一部分，其中`i > c`花费的时间不成比例地长于其中的部分`i < c`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T13:06:15.440

这看起来像是 GNU 编译器的 openmp 实现的问题。尝试不同的编译器。英特尔有一个 Linux 编译器，您应该可以下载并在此处试用。

我注意到的另一件事是，您的第一个私有变量似乎完全没有必要。制作数组 V_in 的私有副本可能会有很大的开销，这可能是您的问题。

我会说这是您的问题的这两个问题之一。

# sql - 帮助解决 SQL Server 2005 中缓慢的 UDF

> ID：870956
> 
> 赞同：1
> 
> 时间：2009-05-15T21:33:11.123
> 
> 标签：sql, recursion, performance, user-defined-functions

我有一个日期表调用 [BadDates]，它只有一列，其中每条记录都是要排除的日期。我有一个UDF如下：

```
CREATE FUNCTION [dbo].[udf_GetDateInBusinessDays]
(
  @StartDate datetime,  --Start Date
  @NumberDays int           --Good days ahead
)
RETURNS datetime
AS
BEGIN
-- Declare the return variable here
DECLARE @ReturnDate datetime
SET @ReturnDate = @StartDate
DECLARE @Counter int
SET @Counter = 0
WHILE   @Counter < @NumberDays
BEGIN
    SET @ReturnDate = DateAdd(d,1,@ReturnDate)
    IF ((SELECT COUNT(ID)
        FROM dbo.[BadDates]
        WHERE StartDate = @ReturnDate) = 0)
    BEGIN
        SET @Counter = @Counter + 1
    END
END
RETURN @ReturnDate
END 
```

此 UDF 效果很好，但处理速度很慢。使用它的存储过程在每条记录中运行 UDF。是否有其他方法可以以更快的方法提供相同的功能。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:07:01.290

我假设您要做的是计算给定日期后 x 个工作日的日期。例如，从今天起 10 个工作日后的日期。我还假设您的 baddates 表包含非工作日，例如周末和银行假期。

过去我遇到过类似的要求，通常最终得到包含所有可能日期的天表以及一个指示特定日期是否为工作日的标志。

然后，我使用该表通过选择开始日期后 x 天的记录来计算从提供的日期开始的 x 个工作日的日期。

所以像这样

```
 CREATE TABLE all_days (  
  dated DATETIME,  
  day_state CHAR(1)  
  ) 
```

其中 day_state 是
D - 工作日
W - 周末
B - 银行假日的值

然后在 x 个工作日后查找日期的 SQL 变为

```
SELECT MAX(dated)
FROM (
  SELECT TOP(@number_days) dated
  FROM all_days
  WHERE day_state = 'D'
  AND dated >= @start_date
  ORDER by dated ASC
) 
```

这段代码未经测试，但应该给你一个大致的想法。您可能不想区分周末和公共假期，在这种情况下，您可以将 day_state 重命名为 working_day 并使其成为 BIT 字段。

您应该在 dated 和 day_state 上创建一个复合唯一索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T22:28:08.153

我没有对此进行测试，但理论上它应该可以工作。我把天数加起来。然后我检查该范围内是否有任何错误。如果有，我会添加糟糕的天数，并检查我刚刚添加的范围内是否还有糟糕的日期。重复直到没有糟糕的日期。

```
CREATE FUNCTION [dbo].[udf_GetDateInBusinessDays]
(
  @StartDate datetime,  --Start Date
  @NumberDays int           --Good days ahead
)
RETURNS datetime
AS
BEGIN
-- Declare the return variable here
DECLARE @ReturnDate datetime
SET @ReturnDate = dateadd(d, @NumberDays, @StartDate);

DECLARE @d int;
SET @d = (select count(1) from baddates where startdate >= @StartDate and startdate <= @ReturnDate);

declare @t datetime;

WHILE   @d > 0
BEGIN
    set @t = @ReturnDate;
    set @ReturnDate = dateadd(d, @d, @ReturnDate);
    SET @d = (select count(1) from baddates where startdate > @t and startdate <= @ReturnDate);
END

RETURN @ReturnDate
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T21:36:35.373

您可能希望在 BadDates.StartDate 上放置一个索引，但可能还有其他更好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T21:48:23.740

好的，您为什么要计算何时可以使用 EXISTS 关键字？如果是因为您可以在 Badates 中有多个相同类型的日期，这似乎是错误的。当您只需要排除 1 时，COUNT 可能会查看整个表以计算 startdate 的实例。

您是否查看过查询计划以了解发生了什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T21:49:04.220

看起来您正在使用此 UDF 来计算两个日期之间的差异。如果我正确解释了这一点，那么我建议您使用内置的 datediff 函数。

# data-binding - 从绑定到 winforms datagridview 的亚音速集合中删除

> ID：870959
> 
> 赞同：0
> 
> 时间：2009-05-15T21:34:08.093
> 
> 标签：data-binding, collections, datagridview, subsonic

我有一个 winforms 应用程序，我通过 BindingSource 添加了一个绑定到亚音速集合的 DataGridView。

网格可以*很好*地添加/编辑（除了[ComboBox 列的显示](https://stackoverflow.com/questions/865141/populating-a-datagridview-combobox-column-with-subsonic-vb-net)），但我无法让它从数据库中正确删除行。

如果我从 DataGridView 中删除一行，我无法确定集合是否脏以及何时调用。亚音速集合的 BatchSave 方法它删除所有行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T05:49:20.947

Just do this:

```
private void productBindingSource_ListChanged(object sender, ListChangedEventArgs e)
{
    ((ProductCollection)productBindingSource.List).SaveAll();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T11:33:22.510

在 2.2 版本中，SaveAll 还应该删除您从 datagridview 中删除的项目。

在 2.1 中，您必须调用

```
ItemCollection.ProcessDeletedItems() 
```

也

# vb6 - 为什么我的 VB6 变体会根据分配时间而变化？

> ID：870962
> 
> 赞同：3
> 
> 时间：2009-05-15T21:34:31.573
> 
> 标签：vb6, types

我是 VB6（以及任何形式的 Visual Basic）开发的新手，我遇到了一个问题。下面可能存在词汇错误，因为我在这里的帖子中将代码格式化为更具可读性，但问题的本质仍然存在。这是代码

我的问题是调用显示的值`MsgBox`（第二组，引用变量`scrWord`和的那些`resWord`）根据我分配给变量`scrWord`和的时间而有所不同`resWord`。如果我分配给变量`scrWord`并`resWord`在上面显示的代码中未注释的第一个位置，则代码底部的消息框将打印我不感兴趣的字符串（例如，第一个 messageBox 将产生一个输出看起来像`srcws:resColNum:#`）或似乎是垃圾数据。请注意，这意味着它将我在上一个消息框中使用的静态字符串分配给变量`scrWord`。这绝不是预期的行为，我不知道它是如何发生的。

另一方面，如果赋值是在消息框之前完成的，变量赋值在上面的代码中被注释，那么变量会打印一个不同的值，它有点像预期的，但不完全是（通常，这两个变量是完全相同的，或者一个是数字的，当两者都应该是不同的字母字符串时）。

我对这个问题感到困惑，我相信它与返回数据类型的`GetData`调用有关。`Variant`

谢谢你，埃文

新代码发布在下面。还是不行。

```
Dim srcWord As Variant
Dim resWord As Variant

Do While (BinsCol.GetData(grouprownum, 1) = binfromnum And nogroupfound = True)
    Dim groupmismatch As Boolean

    groupmismatch = False

    For j = 1 To FormHyst.GroupList.ListCount

        srcWord = sourceWS.Columns(j).GetData(i, 1)
        resWord = "hello, world"

        MsgBox ("srcws:" & srcWord & vbNewLine &_
                "resws:" & resWord & vbNewLine &_
                "test:" & (resWord <> srcWord))
    Next
Loop 
```

在这个新代码中，两者都`srcWord`显示`resWord`“hello, world”。

我仍然无法理解这种行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T09:01:21.640

正如您所说，您是 VB6 的新手，这里有一些一般性的想法和建议。

作为第一个建议：只要您并不*真正*需要它们，就不要使用它们。使用您期望的具体数据类型。在[MSDN](http://msdn.microsoft.com/en-us/library/aa261347(VS.60).aspx)中有一个解释 Variants 如何在内部工作。比较变体时会发生隐式转换，因此如果您并不真正了解您的数据，这就是一种赌博。

即使您的 GetData 函数返回 Variant，您也可以将返回值强制转换为该工作表列中的特定数据类型。因此，如果您的列仅包含字符串，请使用 CStr() 将其转换为字符串并将其放入字符串变量中。与数字相同，分为双变量或长变量。

您可能还想使用 VarType 函数来确定存储在 Variants 中的值的真实类型。

以下更多的是调试工作流程，但也许它可以帮助您跟踪问题：

1.  启用 Option Explicit 以避免未声明/拼写错误的变量问题。（正如 DJ 已经提到的）

2.  在每一行之后生成调试输出，以确保您拥有您期望的值而不是其他值。如果无法逐步调试或“Debug.Print”，那么也许您可以登录到外部日志文件或使用 MsgBox 。

3.  将您的源代码与外部组件依赖项解耦以进行测试。在您的情况下，尝试在不从外部网格读取数据的情况下重现问题（例如将变量设置为一些具体的字符串）。然后您将知道问题出在您的编程逻辑还是您必须处理的数据中。

4.  始终仔细检查您的外部数据源是否真的是您期望的数据源，而不是其他数据源。（经常发生在我身上......）所以检查您的网格在（i，j）处保存的数据以及它是否与您获得的数据匹配。

还有一点：字符串比较在 VB6 中区分大小写，只要您不将“选项比较文本”放在模块/类/表单的顶部。所以“你好世界”<>“你好世界”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T22:12:57.330

你`Option Explicit`的模块顶部有吗？？？

你有一个错字：`srcWord`应该是`scrWord`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T21:55:46.437

尝试

```
 Dim srcWord As Variant
    Dim resWord As Variant

Do While (BinsCol.GetData(grouprownum, 1) = binfromnum And nogroupfound = True)

    For columnnum = 1 To FormHyst.GroupList.ListCount

        scrWord = (sourceWS.Columns(columnnum ).GetData(rownum, 1))
        resWord = (resultWS.Columns(columnnum  + 3).GetData(grouprownum, 1))

        MsgBox ("srcColNum:" & columnnum  & vbNewLine & "srcRowNum:" & _
                  rownum)        MsgBox ("resColNum:" & (columnnum  + 3) & vbNewLine & "resRowNum:" & _
                  grouprownum)

        MsgBox ("srcws:" & srcWord)
    Next                                               
Loop 

```

以下没有任何意义

```
MsgBox ("resws:" & resWord & vbNewLine & "test:" & (resWord <> srcWord)) 
```

您最终会在 (resWord <> srcWord) 处得到“True”或“False”

# django - 将 Django 提要重定向到 FeedBurner

> ID：870979
> 
> 赞同：1
> 
> 时间：2009-05-15T21:39:25.867
> 
> 标签：django, feedburner

我根据[http://docs.djangoproject.com/en/dev/ref/contrib/syndication/](http://docs.djangoproject.com/en/dev/ref/contrib/syndication/)设置了一个 Atom 提要，这意味着我有类似的东西

```
(r'^feeds/(?P<url>.*)/$', 'django.contrib.syndication.views.feed', {'feed_dict': feeds}) 
```

在我的`urls.py`和类似的

```
class MyFeed(Feed):
    ... 
```

在我的`feeds.py`.

我想将此提要的[流量重定向](http://www.google.com/support/feedburner/bin/answer.py?hl=en&answer=78464)到 FeedBurner。我必须在 Django 中执行此操作，因为我的服务器上没有 mod_rewrite。

* * *

我想我应该将`urls.py`条目更改为

```
(r'^feeds/(?P<url>.*)/$', 'feeds.redirect', {'feed_dict': feeds}) 
```

`feeds.py`并补充

```
from django.http import HttpResponseRedirect
from django.core.urlresolvers import reverse

def redirect(request, **kwargs):
    if request.META['HTTP_USER_AGENT'] == 'FeedBurner':
        view = 'django.contrib.syndication.views.feed'
        return HttpResponseRedirect(reverse(view, kwargs=kwargs))
    else:
        return HttpResponseRedirect('http://feeds2.feedburner.com/MyFeed') 
```

但它似乎不起作用，因为我收到以下错误（您必须更改`==`才能`!=`看到此错误）：

> /feeds/myfeed/ 处的 NoReverseMatch
> 
> 使用参数 '()' 和关键字参数 '{'url': u'myfeed `<function feed at 0x16a2430>`', 'feed_dict': {'myfeed': `<class 'feeds.MyFeed'>`}}' 反向查找。

如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:02:37.340

这里的问题是您`django.contrib.syndication.views.feed`从 urls.py 中删除了引用。

不要使用反向重定向到不同的 URL，而是尝试从现有视图返回提要：

```
from django.http import HttpResponseRedirect
from django.core.urlresolvers import reverse
from django.contrib.syndication.views import feed

def redirect(request, **kwargs):
    if request.META['HTTP_USER_AGENT'].startswith('FeedBurner'):
        return feed(request, **kwargs)
    else:
        return HttpResponseRedirect('http://feeds2.feedburner.com/MyFeed') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-06T13:47:13.693

好吧，我想它可以帮助某人，他们想知道在 django 1.3+ 中正确的做法是什么

```
from django.http import HttpResponseRedirect
from feeds import MyFeed #your feed class, check https://docs.djangoproject.com/en/1.3/ref/contrib/syndication/

def burnedFeed(request, **kwargs):
    if request.META['HTTP_USER_AGENT'].startswith('FeedBurner'):
        feed = MyFeed()
        return feed(request)
    else:
        return HttpResponseRedirect('http://feeds2.feedburner.com/MyFeedName') 
```

# c# - IQueryable Where 扩展方法与 Or's

> ID：870983
> 
> 赞同：5
> 
> 时间：2009-05-15T21:41:26.347
> 
> 标签：c#, linq, iqueryable

### 复制：

> [如何在 LINQ 中将 OR 运算符动态添加到 WHERE 子句](https://stackoverflow.com/questions/782339/how-to-dynamically-add-or-operator-to-where-clause-in-linq)

我想遍历一个字符串值数组并构建一个 linq 表达式

列表中的每个项目都是 OR'ed 在一起的。

```
string[] search = new string[]{"A", "B", "C"};
foreach (string item in filterValues)
{
    searchQuery = searchQuery.Where(s => s.Name.Contains(item));
} 
```

上面的代码搜索“A” **AND** “B” **AND** “C”

我想搜索“A”**或**“B”**或**“C”。

我知道如何使用 Linq 做到这一点，但我想使用扩展方法来完成同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T10:02:32.127

我参加聚会迟到了，但是...

我最近创建了一个关于创建启用以下语法的 IQueryable 搜索扩展方法的博客：

```
string[] search = new string[]{"A", "B", "C"};
var searchQuery = context.Users.Search(u => u.Name, search); 
```

**更新：开始**

此后，我更新了搜索扩展，这影响了使用新的流畅 API 执行搜索的方式。这意味着上面现在应该写成

```
var searchQuery = context.Users.Search(u => u.Name)
                               .Containing("A", "B", "C"); 
```

有关新 api 的更多信息，请参见此处：http: [//jnye.co/Posts/2030/searchextensions-search-strings-with-the-new-fluent-api](http://jnye.co/Posts/2030/searchextensions-search-strings-with-the-new-fluent-api)

**更新：完**

[http://jnye.co/Posts/8/generic-iqueryable-or-search-for-multiple-search-terms-using-expression-trees](http://jnye.co/Posts/8/generic-iqueryable-or-search-for-multiple-search-terms-using-expression-trees)

[https://github.com/ninjanye/SearchExtensions](https://github.com/ninjanye/SearchExtensions)

我还有一个可以从这里安装的 nuget 包：

[http://www.nuget.org/packages/NinjaNye.SearchExtensions/](http://www.nuget.org/packages/NinjaNye.SearchExtensions/)

但是，如果您想自己执行此操作，则需要执行以下操作：首先，您需要创建扩展方法

```
public static class QueryableExtensions  
{  
    public static IQueryable<T> Search<T>(this IQueryable<T> source, Expression<Func<T, string>> stringProperty, params string[] searchTerms)  
    {  
        if (!searchTerms.Any())  
        {  
            return source;  
        }  

        Expression orExpression = null;  
        foreach (var searchTerm in searchTerms)  
        {  
            //Create expression to represent x.[property].Contains(searchTerm)  
            var searchTermExpression = Expression.Constant(searchTerm);  
            var containsExpression = BuildContainsExpression(stringProperty, searchTermExpression);  

            orExpression = BuildOrExpression(orExpression, containsExpression);  
        }  

        var completeExpression = Expression.Lambda<Func<T, bool>>(orExpression, stringProperty.Parameters);  
        return source.Where(completeExpression);  
    }  

    private static Expression BuildOrExpression(Expression existingExpression, Expression expressionToAdd)  
    {  
        if (existingExpression == null)  
        {  
            return expressionToAdd;  
        }  

        //Build 'OR' expression for each property  
        return Expression.OrElse(existingExpression, expressionToAdd);  
    }  
} 
```

然后可以按如下方式使用：

```
string[] search = new string[]{"A", "B", "C"};
var searchQuery = context.Users.Search(u => u.Name, search); 
```

这将创建您所追求的 or 查询。

希望这个答案仍然与您相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-16T21:44:52.550

我今天为此苦苦挣扎。然后我终于意识到，如果我将数组变成一个字符串列表，我可以进行连接。一个 queryextender 控件 (.NET 4) 正在调用下面的函数。不要忘记订单...这很重要。如果你不使用它，你会得到一个错误。

```
 Protected Sub FilterTestType(ByVal sender As Object, ByVal e As CustomExpressionEventArgs)
    Dim _codes As List(Of String) = GetTestCodes()
    e.Query = From _tests In e.Query.Cast(Of LabTest)()
              Join _code In _codes On _tests.TestCode Equals _code
              Order By _tests.LoadDate Descending
              Select _tests
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-03T03:23:48.977

```
var filterValues = new[] { "A", "B", "C" };

var values =
    (from item in filterValues
     from value in searchQuery
     where value.Name.Contains(item)
     select value)
     .Distinct(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-21T18:27:33.940

对于已知数量的 where 选择的情况，一种方法是简单地收集要排除的列表，然后应用 where 方法。

```
dim BASEQUERY = FROM blah in blahblahblah _
WHERE ....
select blah

For Each item In EXCLUDELIST
Dim sitem As String = item
BASEQUERY = BASEQUERY.Where(Function(py) py.YOURCOLUMN <> sitem)
Next 
```

这将只留下您想要的那些相当于复合“或位置”条件的内容。注意：大量排除的项目可能会异常缓慢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-02T15:45:11.327

我喜欢这个解决方案：

```
string[] search = new string[]{"A", "B", "C"};
foreach (string item in filterValues)
{
    searchQuery = searchQuery.Where(s => s.Name.Contains(item)).Concat(searchQuery);
} 
```

在我的 MVC3 WebApp 上运行良好

# c# - 如何将“byte gdicharset”转换为脚本/语言的名称？

> ID：870987
> 
> 赞同：0
> 
> 时间：2009-05-15T21:42:57.090
> 
> 标签：c#, .net, internationalization, character-encoding

C# 中的 FontDialog 类有一个属性“AllowScriptChange”，允许用户选择脚本（西方、希伯来语、阿拉伯语、土耳其语等）。启用后，下拉框会提供所有这些选项以及任何其他可用的选项，具体取决于所选字体。

如果对话框成功，选择的字体让 GdiCharSet 设置一个 0-255 的值。177 是希伯来语，161 是希腊语，等等。是否有一个函数可以将值转换为字符串？我可以自己写一个 switch 语句，但我想以正确的方式来做。

这是部分列表：http: [//msdn.microsoft.com/en-us/library/cc194829.aspx](http://msdn.microsoft.com/en-us/library/cc194829.aspx)

**编辑**：从 CharSet 转换为代码页的函数也可以工作，因为我认为获取代码页的名称应该很容易。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T00:13:20.240

如果您不想使用开关，如何使用枚举？就像是：

```
public enum CharSet : byte
{
        ANSI_CHARSET = 0,
        DEFAULT_CHARSET = 1,
        SYMBOL_CHARSET = 2,
        SHIFTJIS_CHARSET = 128,
        HANGEUL_CHARSET = 129,
        HANGUL_CHARSET = 129,
        GB2312_CHARSET = 134,
        CHINESEBIG5_CHARSET = 136,
        OEM_CHARSET = 255,
        JOHAB_CHARSET = 130,
        HEBREW_CHARSET = 177,
        ARABIC_CHARSET = 178,
        GREEK_CHARSET = 161,
        TURKISH_CHARSET = 162,
        VIETNAMESE_CHARSET = 163,
        THAI_CHARSET = 222,
        EASTEUROPE_CHARSET = 238,
        RUSSIAN_CHARSET = 204
    } 
```

如果您使用 .NET 3.5，您可以设置扩展方法

```
public static class GdiCharHelper
{
    public static string ToGdiName(this byte GdiCharSet)
    {
            return Enum.GetName(typeof(CharSet), GdiCharSet);
    }
} 
```

因此，您可以像这样在代码中使用它：

```
string name = Font.GdiCharSet.ToGdiName(); 
```

编辑：现在我考虑一下，您可能应该将 Extension 方法的返回值更改为枚举，所以：

```
return (CharSet)GdiCharSet; 
```

这样你也可以比较：

```
If (Font.GdiCharSet.ToCharSet() == CharSet.ANSI_CHARSET) {...} 
```

# objective-c - 如何创建一个很好的描述方法，它像 NSArray 一样反复嵌套

> ID：870989
> 
> 赞同：1
> 
> 时间：2009-05-15T21:43:34.063
> 
> 标签：objective-c, cocoa, logging, pretty-print

NSArray 的 -description 方法将嵌套递归调用，如下所示：

```
2009-05-15 14:28:09.998 TestGUIProject[29695:813] (
    a, // Array1 item 1
        ( // Array2, a second array, nicely indented another 4 spaces
        a // Item in Array2
    ) // End of Array2
) // End of Array1 
```

我想为我自己的自定义类做类似的事情（使用我正在编写的脚本）。

我不知道当递归调用的对象添加自己的新行时如何添加额外的缩进级别。

我所拥有的是以下内容：

```
- (NSString *)description {
    return [NSString stringWithFormat:@"{{{\n"
            @"    prop1: %@\n"
            @"    prop2: %@\n"
            @"    prop3: %@\n"
            @"    prop4: %@\n"
            @"}}}",
            self.prop1,
            self.prop2,
            self.prop3,
            self.prop4];
} 
```

但是，一旦其中一个属性是 NSArray 或使用相同描述格式的另一个对象，这就会崩溃，因为它不能很好地嵌套。

相反，您会得到：

```
2009-05-15 14:25:50.899 TestApp[29636:813] {{{
    prop1: SomeValue1
    prop2: ( // Prop 2 is an Array of strings
    "String1", // Note no additional level of indentation as in the NSArray example
    "String2",
    "String3",
    "String4"
)
    prop3: SomeValue3
    prop4: SomeValue4
}}} 
```

如何获得额外的嵌套级别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T22:59:32.413

你想要的是这个函数，在 NSArray 和 NSDictionary 上可用：

```
- (NSString *) descriptionWithLocale: (id) locale indent: (NSUInteger) level; 
```

指定缩进 1 以使嵌套数组或字典将其打印的所有内容缩进指定数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T22:24:18.333

这实际上适用于我的目的：

```
[[self.prop2 description] stringByReplacingOccurrencesOfString:@"\n" withString:@"\n    "] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T21:49:01.663

您可能不得不放弃依赖`description`in `NSArray`。也许您应该编写一个方法来遍历数组并在添加到`NSString`. 您可能必须使用 an`NSMutableString`并传递它，以便可以将字符串附加到它。

**编辑**

根据您的评论，我会说使用这些`objc_*`方法来反映已传递给您的调试方法的任何对象。从那里您可以提取所有属性或实例变量并遍历它们。您还可以使用条件来检查 ivar 的类型，如果它是标准集合类，例如`NSArray`or `NSDictionary`，则自己对其进行迭代以以您想要的格式输出数据（然后当然处理其他类型的对象和所有原语以自己的方式）。

# jquery - 单击或悬停时更改下拉列表 CSS？

> ID：870990
> 
> 赞同：1
> 
> 时间：2009-05-15T21:43:56.307
> 
> 标签：jquery, html, events, drop-down-menu, radio-button

受[https://stackoverflow.com/questions/624102/enable-a-currently-disabled-dropdown-list-when-clicking-the-dropdown-list](https://stackoverflow.com/questions/624102/enable-a-currently-disabled-dropdown-list-when-clicking-the-dropdown-list "这个答案")的启发，我尝试了一些方法，并在禁用选择中添加了一些灰色背景。

问题是当我点击一些选择（哪个单选按钮被禁用）时，下拉列表的背景仍然是灰色的。

即使未选中单选按钮，单击时如何将其恢复为正常（白色）？

你可以在这里看到它[http://jsbin.com/okuca/](http://jsbin.com/okuca/)

这是我的实际代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Test </title>
<style type="text/css">
  label.disabled select { opacity: 0.5; filter: alpha(opacity=50); background-color:#CCC; }

</style>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

<script type="text/javascript">
  $(function() {
    $('div.formdiv').bind('click',function() {
      $('label.disabled',this).removeClass('disabled');
      $('input:radio',this).attr('checked',true);
      $('div.formdiv').not(this).find('label').addClass('disabled').find('select').attr('selectedIndex',0);
    }).find('label').addClass('disabled');
  });
</script>
</head>

<body>

<div class="formdiv">
  <label for="Name">
    <input id="Name" name="radio1" type="radio" />Name:
    <select name="select1">
      <option value="Rose">Rose</option>
      <option value="Lily">Lily</option>
    </select>
    </br>
  </label> 
</div>

<div class="formdiv">
  <label  for="Colours">
  <input id="Colours" name="radio1" type="radio" />Colour: 
  <select name="select2">
    <option value="Red">Red</option>
    <option value="Green">Green</option>
  </select>
    </label> 
  </br>
 </div> 

<div class="formdiv">  
 <label  for="Sport">
  <input id="Sport" name="radio1" type="radio" />Sport: 
  <select name="select3">
    <option value="Tennis">Tennis</option>
    <option value="Cricket">Cricket</option>
  </select>
  </label> 
  </br>
</div>
  </body>
</html> 
```

你可以在这里编辑它：http: [//jsbin.com/okuca/edit](http://jsbin.com/okuca/edit)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T22:09:59.520

问题是在您松开鼠标按钮（并且下拉菜单消失）之前，单击处理程序不会被触发，因此`label.disabled select`仍会应用该样式。

有两种方法可以解决此问题。首先，您可以添加另一个 CSS 规则`:focus`，它会覆盖禁用的样式：

```
label.disabled select:focus { opacity: 1.0; filter: alpha(opacity=100); background-color:white; } 
```

但是，如果您的样式变得更加复杂，这可能会给您带来麻烦。相反，我建议您将点击处理程序更改为 mousedown 处理程序：

```
$('div.formdiv').bind('mousedown',function() { 
```

这会导致处理程序在下拉菜单出现*之前触发（并删除类）。*

# wcf - 你见过哪些学习 WCF 的最佳资源？（书籍、网站等）

> ID：870997
> 
> 赞同：19
> 
> 时间：2009-05-15T21:45:49.783
> 
> 标签：wcf, web-services

只是想知道您所见过的对学习 WCF 最有用的资源是什么？

我已经创建了一些原型并了解了基础知识，但是我正在开始一个相当高调的项目，并希望尽可能多地填补我的知识空白。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-15T22:24:24.853

**图书：**

[Learning WCF: A Hands-on Guide by Michele Bustamante](https://rads.stackoverflow.com/amzn/click/com/0596101627) - 非常不错的入门书籍，附有分步教程。Michelle 还在[MSDN 上发布了一系列网络广播](http://www.dasblonde.net/2007/06/24/WCFWebcastSeries.aspx)。

[由 Juval Lowy 编写的 WCF 服务编程](https://rads.stackoverflow.com/amzn/click/com/0596521308)- 更系统的方法，适用于经验丰富的 Web 开发人员。

[IDesign WCF 编码标准](http://www.idesign.net/idesign/download/IDesign%20WCF%20Coding%20Standard.zip)

[Microsoft P&P 的 WCF 安全指南](http://www.codeplex.com/WCFSecurity)

**网站：**

MSDN[入门教程](http://msdn.microsoft.com/en-us/library/ms734712.aspx)

和offcourse [TheBestProgrammersQandASiteEver](https://stackoverflow.com/questions/tagged/wcf) :-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-20T21:57:04.677

在我喜欢其他开发人员的建议后，我开始阅读的三本书：

[Windows® 通信基础 4 一步一步](http://shop.oreilly.com/product/0790145302403.do)

这本书最好的地方在于它以一种非常简单有效的方式帮助你理解，它有很多例子和所有需要的说明来帮助你快速入门。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T22:01:43.957

我一直告诉人们野生动物园书架是一个很棒的网站。节省您最初购买书籍的钱，您可以扫描您要查找的内容。

没有什么比买一本 50 美元的书更糟糕的了

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T22:54:18.947

[WCF 开发人员](http://msdn.microsoft.com/wcf/)中心。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T16:35:48.900

我*真的*很喜欢[Inside Windows Communication Foundation](https://rads.stackoverflow.com/amzn/click/com/0735623066 "Windows Communication Foundation 内部")。它告诉你一些大多数其他书籍没有的事情：

1.  WCF的设计目标是什么
2.  不同的消息传递和协调模式以及 WCF 对它们的支持
3.  WCF 的组织（绑定、通道等之间的关系）。其他几本书也有这个，但我发现这本书对它们有最实际的解释——我喜欢。

强烈推荐。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T22:07:29.247

我建议[Nicholas Allen 的 Indigo 博客](http://blogs.msdn.com/drnick/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-15T22:10:04.310

从我发现：

[https://stackoverflow.com/questions/805902/where-can-i-find-good-resources-on-wcf](https://stackoverflow.com/questions/805902/where-can-i-find-good-resources-on-wcf)

[https://stackoverflow.com/questions/386801/wcf-book-recommendation](https://stackoverflow.com/questions/386801/wcf-book-recommendation)************