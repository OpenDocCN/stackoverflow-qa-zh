# StackOverflow 问答 000053000-000053999

# .net - 如何在 .NET 中使用 TreeView 控件创建三态复选框？

> ID：53002
> 
> 赞同：6
> 
> 时间：2008-09-09T21:56:27.170
> 
> 标签：.net, asp.net, winforms

我在已打开复选框的 Windows 窗体项目中有一个树视图控件。因为树视图控件具有嵌套节点，所以我需要复选框才能进行某种三模式选择。我找不到这样做的方法（我只能完全选中或取消选中复选框）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-09T22:07:21.277

如果您正在谈论 Windows 窗体，这篇文章应该可以帮助您构建三态 TreeView：

[http://www.codeproject.com/KB/tree/treeviewex2003.aspx?display=Print](http://www.codeproject.com/KB/tree/treeviewex2003.aspx?display=Print)

如果您需要在 asp.net 上的树视图上使用三态复选框，我认为您需要使用第三方组件。看看这个，然后点击左侧的“三态复选框”：

[http://www.aspnetexpert.com/demos/tree/default.aspx](http://www.aspnetexpert.com/demos/tree/default.aspx)

# algorithm - 确定数字音频数据是否剪辑的算法？

> ID：53012
> 
> 赞同：3
> 
> 时间：2008-09-09T22:04:02.690
> 
> 标签：algorithm, audio, heuristics

是否有一种算法或一些启发式方法来确定数字音频数据是否正在[剪辑](http://en.wikipedia.org/wiki/Clipping_(audio)#Digital_clipping)？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-09T22:15:43.397

如果您曾经收到最大值或最小值的值，那么根据定义，您就是裁剪。这些值代表它们的特定值以及超出的所有值，因此它们最好用作外部边界检测器。

-亚当

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-06T20:41:41.050

简单的答案是，如果任何样本具有最大值或最小值（对于 16 位样本，分别为 -32768 和 +32767），您可以将其视为裁剪。这并不完全正确，因为该值实际上可能是正确的值，但无法判断 +32767 是否真的应该是 +33000。

对于一个更复杂的答案：有这样一种东西，例如样本计数剪辑检测器，它需要 x 个连续样本处于最大值/最小值才能将它们视为剪辑（其中 x 可能高达 7）。这里的理论是，仅剪辑几个样本是听不见的。

也就是说，即使在低于最大值（和高于最小值）的值下，音频设备的剪辑也非常可听。出于这个原因，典型的建议是将音乐的峰值控制在 -0.3 dB 而不是 0.0 dB。您可能希望将高于该级别的任何样本视为裁剪。这完全取决于您需要它来做什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T22:33:21.293

亚当所说的。您还可以添加一些逻辑来检测一段时间内的最大幅度值并仅标记这些值，但本质是确定信号是否/何时达到最大幅度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-09T23:14:19.870

对于数字音频数据，“削波”一词除了“最大幅度”之外并没有真正的意义。在模拟世界中，音频数据来自一些硬件，这些硬件通常包含一个“削波寄存器”，它允许您获得未削波的最大幅度。

可能更适合数字音频的是根据输出 D/A 的限制设置一些阈值。如果您正在使用 VOIP，则选择一些典型的手机或手机阈值，如果您的数字音频超过该阈值，则将其称为“剪辑”。如果您要输出到高端家庭影院系统，那么您可能不会有任何“剪辑”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-12T20:08:33.847

# c# - 有哪些技术可用于发送短信？

> ID：53019
> 
> 赞同：7
> 
> 时间：2008-09-09T22:10:43.250
> 
> 标签：c#, mobile, messaging

我正在研究向订阅用户列表发送常规自动文本消息。玩过 Windows Mobile 设备后，我可以使用紧凑的 .Net 框架 + 连接到 USB 的设备轻松实现这一点，并通过它发送消息。我想探索其他解决方案，例如拥有服务器或类似的东西来做到这一点。我只是不知道这样的系统涉及什么。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-09T22:40:29.793

这实际上完全取决于您打算发送多少条短信以及消息按时到达（并且实际上到达）的重要性。

## 短信聚合器

为了获得更大的容量和良好的可靠性，您将需要使用 SMS 聚合器。这些聚合器具有 Web 服务 API（或 SMPP），您可以使用它们来发送消息并确定您的消息是否随时间传递。Air2Web、mBlox 等是我接触过的一些聚合器示例。

与聚合器合作的好处是，它们可以指导您完成发送有效消息所需的工作。例如，如果您想要自己的、独特的短代码，他们可以与运营商一起导航流程以保护该短代码。

他们还可以确保您遵守有关使用 SMS 的任何规则。如果您不尊重 SMS 的使用，并且仅在您开始使用聚合器时同意的范围内使用 SMS，运营商将完全关闭您。如果您越界，他们将拥有聚合器关系以防止任何服务中断。

您需要为每条消息付费，并且可能需要支付基线服务费。如果这取决于您的音量。

## SMTP 到短信

如果您想要针对少量已知地址的不可靠、低租金的解决方案，您可以使用 SMTP 到 SMS 的解决方案。在这种情况下，您只需找到收件人的移动提供商并使用他们的移动提供商的电子邮件方案来发送消息。这方面的一个例子是 7705551212@cellcompany.com。

在这种情况下，您发送了消息，但它已经消失了，您希望它到达那里。你真的不知道它是否成功。此外，一些提供商限制消息如何通过其 SMTP 进入 SMS 网关，以限制 SMS 垃圾邮件。

但是，这种场景是几乎任何编程语言中最容易使用的场景。有一百万个关于如何发送电子邮件的 C# 示例，这种方式也不例外。

在您收到大量消息之前，这是最具成本效益的解决方案（即免费）。当您开始这样做太多时，运营商可能会在他们发现您通过他们的 SMTP 到 SMS 网关发送大量消息时介入。

## 有效的短信

在许多情况下，您必须确保收件人正确选择了您的服务。如果您的文本要发送给非常多的人，这只是一个大问题。

您需要记住短信很短（保持在 140 到 160 个字符以内）。当您对事物进行编程时，您会想要将其烘焙，否则您可能会不小心发送多部分消息。

不要忘记，您需要确保收件人意识到他们可能需要为收到的短信付费。在无限文本计划的世界中，这越来越不值得关注。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T22:13:22.293

您通常可以通过 sms 服务提供商获得一个帐户并使用 API（SOAP、resful http、smpp ....）发送消息

谷歌搜索短信服务提供商会产生许多不同成本的结果。这是一篇内容丰富的文章[如何选择 SMS 服务提供商](http://www.developershome.com/sms/howToChooseSMSGateway.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-09T22:44:28.583

我使用[AQL](http://www.aql.com/)提供网关来发送 SMS 消息、语音推送消息、入站 SMS -> HTTP POST 网关和其他东西。

对于 Perl，有我的[SMS::AQL](http://search.cpan.org/dist/SMS-AQL)模块来与它们交互；在 C# 中创建一些东西应该很容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-09T22:13:40.077

您可以随时为此尝试第三方网关服务。像[clickatell](http://www.clickatell.com)这样的人提供了许多服务和 API 来使这项工作在不同的国家/地区发挥作用。这不是广告！我只将他们的服务用于技术试点。周围有很多这样的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-01T07:05:43.130

另一种发送短信的技术是 text2land.com 文本到语音技术，用于向固定电话发送短信。

# apache-flex - 在 ActionScript 3 / Flex / AIR 中实现 1:1 异步回调/事件的最佳方式？

> ID：53025
> 
> 赞同：1
> 
> 时间：2008-09-09T22:13:54.100
> 
> 标签：apache-flex, actionscript-3, asynchronous, air

我一直在我的 Flex 项目中使用[命令模式](http://en.wikipedia.org/wiki/Command_pattern)，需要异步回调路由：

*   实例化给定命令对象和命令对象的人，
*   命令对象和命令对象调用的“数据访问”对象（即通过网络处理对服务器的远程过程调用的人）。

这两个回调路由中的每一个都必须能够是一对一的关系。这是因为我可能有几个给定命令类的实例同时运行完全相同的作业，但参数略有不同，我不希望它们的回调混淆。因此，使用事件（AS3 中处理异步的默认方式）几乎已被淘汰，因为它们本质上是基于一对多关系的。

目前我已经使用具有特定类型签名的**回调函数引用来完成此操作，但我想知道***是否有人知道更好（或替代）的方法？*

这是一个示例来说明我当前的方法：

*   我可能有一个视图对象，该对象由于某些用户操作而产生一个`DeleteObjectCommand`实例，将引用传递给它自己的两个私有成员函数（一个代表成功，一个代表失败：假设在这个例子`"deleteObjectSuccessHandler()"`中`"deleteObjectFailureHandler()"`）作为对命令类的回调函数引用构造函数。
*   然后命令对象将重复此模式，并连接到“数据访问”对象。
*   当网络上的 RPC 成功完成（或失败）时，会调用相应的回调函数，首先是“数据访问”对象，然后是命令对象，以便最终实例化操作的视图对象在第一个地点通过其`deleteObjectSuccessHandler()`或被`deleteObjectFailureHandler()`调用而得到通知。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T12:06:00.653

我再尝试一个想法：

让您的数据访问对象返回它们自己的 AsyncToken（或封装挂起调用的其他一些对象），而不是来自 RPC 调用的 AsyncToken。因此，在 DAO 中，它看起来像这样（这是非常粗略的代码）：

```
public function deleteThing( id : String ) : DeferredResponse {
    var deferredResponse : DeferredResponse = new DeferredResponse();

    var asyncToken : AsyncToken = theRemoteObject.deleteThing(id);

    var result : Function = function( o : Object ) : void {
        deferredResponse.notifyResultListeners(o);
    }

    var fault : Function = function( o : Object ) : void {
        deferredResponse.notifyFaultListeners(o);
    }

    asyncToken.addResponder(new ClosureResponder(result, fault));

    return localAsyncToken;
} 
```

和`DeferredResponse`类`ClosureResponder`当然不存在。而不是发明你自己的，你可以使用`AsyncToken`而不是`DeferredResponse`，但公共版本`AsyncToken`似乎没有任何方式来触发响应者，所以你可能无论如何都必须继承它。`ClosureResponder`只是一个`IResponder`可以在成功或失败时调用函数的实现。

无论如何，上面的代码做它的业务的方式是它调用一个 RPC 服务，创建一个封装挂起调用的对象，返回该对象，然后当 RPC 返回时，一个闭包`result`或被`fault`调用，因为它们仍然有引用进行 RPC 调用时的范围，它们可以触发挂起的调用/延迟响应上的方法。

在命令中，它看起来像这样：

```
public function execute( ) : void {
    var deferredResponse : DeferredResponse = dao.deleteThing("3");

    deferredResponse.addEventListener(ResultEvent.RESULT, onResult);
    deferredResponse.addEventListener(FaultEvent.FAULT,   onFault);
} 
```

或者，您可以重复该模式，让该`execute`方法返回其自己的延迟响应，当触发命令从 DAO 获得的延迟响应时，该响应将被触发。

但。我觉得这不是特别漂亮。通过使用现有的许多应用程序框架之一来或多或少准确地解决此类问题，您可能会做一些更好、不那么复杂和不那么纠结的事情。我的建议是[Mate](http://mate.asfusion.com)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T10:18:13.923

许多 Flex RPC 类，如`RemoteObject`、等，在您调用它们时会`HTTPService`返回s。[`AsyncToken`](http://livedocs.adobe.com/flex/2/langref/mx/rpc/AsyncToken.html)听起来这就是你所追求的。基本上`AsyncToken`封装了挂起的调用，从而可以将回调（以[`IResponder`](http://livedocs.adobe.com/flex/2/langref/mx/rpc/IResponder.html)实例的形式）注册到特定的调用。

在 的情况下`HTTPService`，当您调用`send()`an时`AsyncToken`，您可以使用此对象来跟踪特定调用，`ResultEvent.RESULT`这与发送）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-13T05:25:35.550

AbstractCollection 是在 Flex / AIR 中处理持久对象的最佳方式。GenericDAO 提供了答案。

DAO 是一个对象，它管理执行 CRUD 操作和其他要在 ValueObject 上完成的常见操作（在 Java 中称为 Pojo）。GenericDAO 是一个可重用的 DAO 类，可以通用。目标：

在 JAVA IBM GenericDAO 中，要添加一个新的 DAO，要做的步骤很简单，添加一个 valueobject (pojo)。为 valueobject 添加一个 hbm.xml 映射文件。为 DAO 添加 10 行 Spring 配置文件。

同样，在 AS3 Project Swiz DAO 中。我们希望获得类似的成就。

客户端 GenericDAO 模型：当我们正在研究客户端语言时，我们也应该管理一个持久对象集合（对于每个 valueObject）。用法：来源：http: [//github.com/nsdevaraj/SwizDAO](http://github.com/nsdevaraj/SwizDAO)

# sql - 如何在 SQL Management Studio 中轻松编辑 SQL XML 列

> ID：53026
> 
> 赞同：56
> 
> 时间：2008-09-09T22:14:25.630
> 
> 标签：sql, sql-server, xml

我有一个带有 XML 列的表。此列存储了一些我为配置我的应用程序而保留的值。我创建它是为了拥有更灵活的架构。我找不到直接从 SQL Management Studio 中的表视图更新此列的方法。其他（例如 INT 或 Varchar）列是可编辑的。我知道我可以编写一个 UPDATE 语句或创建一些代码来更新它。但我正在寻找更灵活的东西，让高级用户可以直接编辑 XML。

有任何想法吗？

> 再次重申：请不要回答我可以写应用程序。我知道，这正是我想要避免的。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-01-11T21:56:08.530

这是一个老问题，但我今天需要这样做。我能想到的最好的方法是编写一个查询，生成可以在查询编辑器中编辑的 SQL 代码——它有点蹩脚，但它可以节省你复制/粘贴的东西。

注意：您可能需要进入工具 > 选项 > 查询结果 > 文本结果并将显示的最大字符数设置为足够大的数字以适合您的 XML 字段。

例如

```
select 'update [table name] set [xml field name] = ''' + 
convert(varchar(max), [xml field name]) +
''' where [primary key name] = ' + 
convert(varchar(max), [primary key name]) from [table name] 
```

这会产生很多看起来像这样的查询（带有一些示例表/字段名称）：

```
update thetable set thedata = '<root><name>Bob</name></root>' where thekey = 1 
```

然后将这些查询从结果窗口复制回查询窗口，编辑 xml 字符串，然后运行查询。

（编辑：将 10 更改为最大以避免错误）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-08-13T06:04:23.620

sql server management studio 缺少此功能。

我可以看到 Homer Simpson 作为微软项目经理用手掌敲着头：“Duh！”

当然，我们要编辑 xml 列。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-09T22:29:43.237

我最终编写了一个 .net c# UI 来处理 xml 数据。使用 xsl 进行显示和 xml 模式有助于很好地显示 xml 并保持其完整性。

编辑：c# 还包含简化读取/写入数据的 xmldocument 类。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-29T20:01:20.617

@Jacob 的答案非常有效，但如果您的 XML 包含任何 ' 字符，您应该添加一个 REPLACE：

```
select 'update [table name] set [xml field name] = ''' + 
REPLACE(convert(varchar(max), [xml field name]), '''', '''''') +
''' where [primary key name] = ' + 
convert(varchar(max), [primary key name]) from [table name] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-09T20:02:25.830

我有一个便宜又讨厌的解决方法，但没关系。所以，做一个记录的查询，即

```
SELECT XMLData FROM [YourTable]
WHERE ID = @SomeID 
```

单击应该是“超链接”的 xml 数据字段。这将在新窗口中打开 XML。编辑它，然后将 XML 复制并粘贴回新的查询窗口：

```
UPDATE [YourTable] SET XMLData = '<row><somefield1>Somedata</somefield1> 
                                  </row>'
WHERE ID = @SomeID 
```

但是，是的，WE Desperately 需要能够编辑。如果您正在听 Soft 先生，请查看 Oracle，您可以在其 Mgt Studio 等效项中编辑 XML。让我们把它归结为一个疏忽，我仍然是 SQL Server 的忠实粉丝。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-23T16:44:51.743

忽略问题标题中的“容易”部分，这里有一个相当不错的巨型 hack，只要您处理小的 XML 列。

这是一个概念证明，没有过多考虑优化。针对 2008 R2 编写。

```
--Drop any previously existing objects, so we can run this multiple times.
IF EXISTS (SELECT * FROM sysobjects WHERE Name = 'TableToUpdate')
    DROP TABLE TableToUpdate
IF EXISTS (SELECT * FROM sysobjects WHERE Name = 'vw_TableToUpdate')
    DROP VIEW vw_TableToUpdate

--Create our table with the XML column.
CREATE TABLE TableToUpdate(
    Id INT NOT NULL CONSTRAINT Pk_TableToUpdate PRIMARY KEY CLUSTERED IDENTITY(1,1),
    XmlData XML NULL
)

GO

--Create our view updatable view.
CREATE VIEW dbo.vw_TableToUpdate
AS
SELECT
    Id,
    CONVERT(VARCHAR(MAX), XmlData) AS XmlText,
    XmlData
FROM dbo.TableToUpdate

GO

--Create our trigger which takes the data keyed into a VARCHAR column and shims it into an XML format.
CREATE TRIGGER TR_TableToView_Update
ON dbo.vw_TableToUpdate
INSTEAD OF UPDATE

AS

SET NOCOUNT ON

DECLARE
@Id INT,
@XmlText VARCHAR(MAX)

DECLARE c CURSOR LOCAL STATIC FOR
SELECT Id, XmlText FROM inserted
OPEN c

FETCH NEXT FROM c INTO @Id, @XmlText
WHILE @@FETCH_STATUS = 0
BEGIN
    /*
    Slight limitation here.  We can't really do any error handling here because errors aren't really "allowed" in triggers.
    Ideally I would have liked to do a TRY/CATCH but meh.
    */
    UPDATE TableToUpdate
    SET
        XmlData = CONVERT(XML, @XmlText)
    WHERE
        Id = @Id

    FETCH NEXT FROM c INTO @Id, @XmlText
END

CLOSE c
DEALLOCATE c

GO

--Quick test before we go to SSMS
INSERT INTO TableToUpdate(XmlData) SELECT '<Node1/>'
UPDATE vw_TableToUpdate SET XmlText = '<Node1a/>'
SELECT * FROM TableToUpdate 
```

如果您在 SSMS 中打开 vw_TableToUpdate，您可以更改“XML”，这将更新“真实”XML 值。

同样，丑陋的黑客，但它适用于我需要它做的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-09T22:16:54.093

我不认为您可以使用 Management Studio GUI 来更新 XML 列，而无需自己编写 UPDATE 命令。

让用户更新 xml 数据的一种方法是编写一个简单的基于 .net 的程序（winforms 或 asp.net），然后从那里选择/更新数据。通过这种方式，您还可以在插入/更新信息之前对数据进行清理，并根据任何给定的模式轻松对其进行验证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-09T22:51:56.210

我在这方面有点模糊，但是您能否不使用 OPENXML 方法将 XML 分解为关系格式，然后在用户完成后将其保存回 XML 中？

就像其他人所说的那样，我认为编写一个小应用程序可能会更容易！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-12T22:37:51.897

另一个不回答的答案。您可以使用 LinqPad。（[https://www.linqpad.net/](https://www.linqpad.net/)）。它能够编辑 SQL 行，包括 XML 字段。如果您不使用 LINQ，还可以通过 SQL 查询要编辑的行。

我的特殊问题是尝试将空 XML 值编辑为 NULL 值。在 SSMS 中，该值显示为空白。但是在 LinqPad 中它显示为空。因此，在 LinqPad 中，我必须将其更改为 ，然后返回 null 以保存更改。现在 SSMS 也将其显示为空。

# python - 大型 Python 包括

> ID：53027
> 
> 赞同：3
> 
> 时间：2008-09-09T22:15:09.450
> 
> 标签：python

我有一个要包含在 Python 中的文件，但是包含的文件相当长，能够将它们拆分为多个文件会更加整洁，但是我必须使用多个包含语句。

有没有办法将几个文件组合在一起并一次包含它们？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-09T22:21:04.490

1.  将文件放在一个文件夹中。
2.  将 __init__.py 文件添加到文件夹中。在 __init__.py 中进行必要的导入
3.  将多个导入替换为一个：

    导入文件夹名称

请参阅[Python 包管理](http://docs.python.org/tut/node8.html#SECTION008400000000000000000)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-09T22:19:25.430

是的，看看[http://docs.python.org/tut/node8.html](http://docs.python.org/tut/node8.html)中的“6.4 Packages”部分：

基本上，您可以将一堆文件放入一个目录中，然后在该目录中添加一个 __init__.py 文件。如果目录在您的 PYTHONPATH 或 sys.path 中，您可以执行“import directoryname”来导入目录中的所有内容，或者执行“import directoryname.some_file_in_directory”来导入目录中的特定文件。

> 需要 __init__.py 文件才能使 Python 将目录视为包含包；这样做是为了防止具有通用名称（例如“字符串”）的目录无意中隐藏了稍后在模块搜索路径中出现的有效模块。在最简单的情况下，__init__.py 可以只是一个空文件，但它也可以执行包的初始化代码或设置 __all__ 变量，稍后将介绍。

# .net - SLN 文件中的 GUID

> ID：53041
> 
> 赞同：16
> 
> 时间：2008-09-09T22:23:36.573
> 
> 标签：.net, visual-studio, solution

Visual Studio 解决方案文件包含每个项目条目的两个 GUID。我认为其中之一来自 AssemblyInfo.cs

有谁确切地知道这些来自哪里，以及它们的用途？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-09T22:29:22.287

这两个 GUID 都与 AssemblyInfo.cs 中的 GUID 不同（即程序集本身的 GUID，不绑定到 Visual Studio，而是构建的最终产品）。

因此，对于 sln 文件中的典型行（如果您希望看到，请在记事本或选择编辑器中打开 .sln）：

```
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ConsoleSandbox", "ConsoleSandbox\ConsoleSandbox.csproj", "{55A1FD06-FB00-4F8A-9153-C432357F5CAC}" 
```

第二个 GUID 是项目本身的唯一 GUID。解决方案文件使用它来将其他设置映射到该项目：

```
GlobalSection(ProjectConfigurationPlatforms) = postSolution
    {55A1FD06-FB00-4F8A-9153-C432357F5CAC}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
    {55A1FD06-FB00-4F8A-9153-C432357F5CAC}.Debug|Any CPU.Build.0 = Debug|Any CPU
    {55A1FD06-FB00-4F8A-9153-C432357F5CAC}.Release|Any CPU.ActiveCfg = Release|Any CPU
    {55A1FD06-FB00-4F8A-9153-C432357F5CAC}.Release|Any CPU.Build.0 = Release|Any CPU
EndGlobalSection 
```

第一个 GUID 实际上是一个 GUID，它是解决方案本身的唯一 GUID（我相信）。如果您有一个包含多个项目的解决方案，您实际上会看到如下内容：

```
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ConsoleSandbox", "ConsoleSandbox\ConsoleSandbox.csproj", "{55A1FD06-FB00-4F8A-9153-C432357F5CAC}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Composite", "..\CompositeWPF\Source\CAL\Composite\Composite.csproj", "{77138947-1D13-4E22-AEE0-5D0DD046CA34}"
EndProject 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-09T22:28:44.080

[根据 MSDN](http://msdn.microsoft.com/en-us/library/bb165951(VS.80).aspx)：

> [ `Project`] 语句包含唯一的项目 GUID 和项目类型 GUID。环境使用此信息来查找项目文件或属于解决方案的文件，以及每个项目所需的 VSPackage。项目 GUID 传递给 IVsProjectFactory 以加载与项目相关的特定 VSPackage，然后由 VSPackage 加载项目。

# linq-to-sql - 带有自引用实体的 linq to sql 堆栈溢出

> ID：53045
> 
> 赞同：1
> 
> 时间：2008-09-09T22:26:28.830
> 
> 标签：linq-to-sql, lazy-loading

我有一个包含许多自身的实体，我如何在 LINQ 中将其映射到 SQl，以便它不会执行无限循环获取 e1，然后是其所有子级，然后是其父级（e1），然后是其子级并重复？现在我知道如果我将子属性设置为 false，我可以做到这一点，但这是最重要的属性（并不真正关心父属性）。有没有办法让它做延迟加载？那甚至可以解决它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T22:38:23.247

在设计器中，选择图表中实体的属性，然后在属性窗口的*Code Generation部分中，将***Delay Loaded**设置为*True*。

请参阅[此博客文章](http://www.davidhayden.com/blog/dave/archive/2007/08/05/LINQToSQLLazyLoadingPropertiesSpecifyingPreFetchWhenNeededPerformance.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-09T22:36:37.167

据我所知，LINQ to SQL 默认会延迟加载。即使没有，我也很确定 MS 人员使用了某种[身份映射](http://en.wikipedia.org/wiki/Identity_map)来确保每个数据上下文中的每条记录只加载一次。

您是否在实践中遇到过陷入循环的情况？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-09T23:39:45.800

这个网站不适合我预先存在的偏见，原来*这*是一条配置错误的路线，不是懒惰/急切的加载

# markdown - 如何在 Markdown 中显示双下划线？

> ID：53046
> 
> 赞同：25
> 
> 时间：2008-09-09T22:27:11.683
> 
> 标签：markdown

在 python 中，有一些特殊的变量和文件名被双下划线包围。例如，有

```
__file__ 
```

多变的。我只能让它们正确显示在代码块内。我需要输入什么才能在常规文本中获得双下划线而不将它们解释为强调？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-09T22:31:19.347

__文件__

在第一个下划线之前放置一个反斜杠。

像这样：

```
\__file__ 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-09T22:33:49.857

你也可以在最后的下划线前加一个反斜杠

```
__file_\_ 
```

给你

__文件__

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-04-02T20:11:55.237

只是你需要在markdown中这样写

```
\_\_file\_\_ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T16:35:08.337

您可以使用`&#95;`代替左下划线。示例：__file__

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-25T11:20:19.967

``*`` 这同样适用于星号或任何降价语法。Bbackticking 效果很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-12-17T02:18:31.890

在第一个和第二个下划线之前放置一个反斜杠，例如：

```
\_\_main.py__ 
```

它将显示如下：

```
__main.py__ 
```

只有一个反斜杠是不够的，因为它会使您的文本以斜体显示。

顺便说一句，考虑到它们是变量和文件名，我建议将其包含在反引号（`）中：

```
`__main.py__` 
```

它会显示为`__main.py__`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-18T03:32:07.250

`_\_file__` 输入这将对您有所帮助。

# dll - vista中如何将dll添加到gac

> ID：53057
> 
> 赞同：6
> 
> 时间：2008-09-09T22:36:35.030
> 
> 标签：dll, windows-vista, gac

当我将 dll 拖放到 vista 上的程序集文件夹时，我收到错误“访问被拒绝：mydll.dll”。如何绕过错误消息并将我的 dll 添加到 gac？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-09T22:38:48.363

我的猜测是您必须以管理员身份执行此操作...尝试禁用 UAC 或使用 gacutil.exe 添加您的程序集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T22:39:46.537

使用[runas](http://www.microsoft.com/technet/scriptcenter/resources/qanda/apr06/hey0428.mspx)命令以具有本地管理员权限的用户身份运行[gacutil](http://msdn.microsoft.com/en-us/library/ex0ss12c(VS.80).aspx)，以将 dll 注册到 GAC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T07:26:01.013

使用 vista 时，您可能无法在 windows 文件夹中找到 gacutil.exe。由于 vista 的“标志程序等等”的事情，它不包括在内。尝试使用 Windows 安装程序将您的程序集添加到 gac 中。这是推荐的方式。

永远不要忘记这个传统的食人魔谚语：“Bi siktir git cay koy”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T16:06:58.590

你可以用 gacutil.exe 做到这一点。它位于：

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727 
```

但是，如果您安装了 .NET SDK（而不仅仅是 .Net Redistributible），它就在那里。但是你可以从你的开发者机器上复制它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T00:00:47.420

如果要驻留在 GAC 中，还需要对程序集 (dll) 进行强命名。

[http://msdn.microsoft.com/en-us/library/wd40t7ad(VS.80).aspx](http://msdn.microsoft.com/en-us/library/wd40t7ad%28VS.80%29.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-20T07:20:09.407

使用命令行，使用以下步骤：

打开 Visual Studio 命令提示符

首先打开 Visual Studio 命令提示符（对于 Visual Studio 2008，路径是 Programs --> Visual Studio 2008 --> Visual Studio Tools --> Visual Studio 2008 Command Prompt ）以下步骤中提到的所有文件都将在 Visual Studio 中创建Studio 2008 命令提示符路径。就我而言，它是 C:\Program Files\Microsoft Visual Studio 9.0\VC

1.  生成一个 KeyFile sn -k keyPair.snk
2.  获取程序集 ildasm SomeAssembly.dll /out:SomeAssembly.il 的 MSIL
3.  重命名原来的程序集，以防万一 ren SomeAssembly.dll SomeAssembly.dll.orig
4.  从 MSIL 输出和您的 KeyFile ilasm SomeAssembly.il /dll /key=keyPair.snk 构建一个新程序集
5.  将 DLL 安装到 GAC gacutil -i SomeAssembly.dll

# asp.net - 嵌入没有 iframe 的 asp 页面

> ID：53064
> 
> 赞同：2
> 
> 时间：2008-09-09T22:39:58.890
> 
> 标签：asp.net, iframe

我想在 html 页面上嵌入一个 .asp 页面。我不能使用 iframe。我试过：

```
<object width="100%" height="1500" type="text/html" data="url.asp">
alt : <a href="url.asp">url</a>
</object>" 
```

在 ff 中效果很好，但在 ie7 中效果不佳。有任何想法吗？是否可以使用对象标签为 IE 嵌入 .asp 页面，还是只能在 ff 中使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T22:51:40.047

您可能可以使用 javascript 伪造它。您可以使用 AJAX 加载页面，然后插入 HTML，或者在隐藏的 iframe 中加载“url.asp”并从那里复制 HTML。

一个缺点（或者这可能是您想要的）是页面不是完全独立的，因此外部页面的 CSS 规则会影响嵌入页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T23:24:32.247

我过去使用 Javascript 和 XMLHttp 解决了这个问题。根据具体情况，它可能会有点hacky。特别是，您必须注意内部页面失败以及它如何影响/降级外部页面（希望您可以保持优雅地降级）。

搜索 XMLHttp（或查看[这个很棒的教程](http://www.jibbering.com/2002/4/httprequest.html)）并从外部请求“子”页面，呈现您需要的 HTML。最好您可以只获取您需要的特定数据并在 Javascript 中处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T16:46:09.247

好吧，在四处搜索和测试之后，我认为这是不可能的。在我看来，IE 不允许对象标记访问与父级不在同一域中的资源。如果我试图提取的内容在同一个域上，它会对我有用，但事实并非如此。如果有人能证实我对此的解释，将不胜感激。

# .net - 企业库应用程序块还是自研框架？

> ID：53065
> 
> 赞同：2
> 
> 时间：2008-09-09T22:40:00.170
> 
> 标签：.net, frameworks, enterprise-library

我们目前正在寻求采用某种类型的“标准”开发人员框架，并研究了使用企业库。你会推荐使用这些块作为软件开发的基础，还是我们应该做一些*本土化*的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T22:54:22.087

就像所有对架构和编程问题的好答案一样，答案是“视情况而定”。

这取决于您的数据访问和对象设计需求的独特性。这也可能取决于您计划如何长期支持您的申请。最后，这在很大程度上取决于开发人员的技能水平。

这个问题没有一个万能的答案，但一般来说，如果您的主要关注点是开发能够提供一些商业价值的软件，那么选择一个现有的框架并使用它运行。不要将您的周期花费在构建不会立即推动业务利润的东西上（即增加收入和/或降低成本）。

例如，我组织的一个项目是公司运营的核心，需要尽快开发和部署，并且会有很长的生命周期。出于这些原因，我们在 Enterprise Library 的帮助下选择了 CSLA。我们本可以选择其他框架，但重要的是我们选择了一个看起来很适合我们的应用程序和开发人员技能集的框架，并且我们使用它来运行。

它给了我们一个良好的开端和一个我们可以从中获得支持的社区。我们立即从提供商业价值的功能开始，而不是试图构建一个框架。

我们也处于这样的位置，我们可以在未来雇佣最有可能接触过我们框架的人，给他们一个很好的开端。这应该会降低长期支持成本。

是否有我们不使用的东西和我们可能不需要的开销？也许。但是，我会整天用它来换取尽早并经常在代码中交付业务价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T00:00:10.587

这真的取决于你需要做什么。一般来说，您的公司所处的利基市场越大，您就越有可能找到合适的框架来支持您。对于较小的利基市场，您很可能需要自己动手。

我工作的公司有几个应用程序都适用于估算给定建筑物的建筑材料。由于这是一个非常具体的事情，而且我们有大约 8 个类似的应用程序，我们决定推出自己的应用程序并在必要时引入 3rd 方库（没有意义为某些东西重新发明轮子）

当然，您的米数可能会有所不同。

# sql-server - 在 SQL Server 中，如何使用系统表/视图识别特定表的 *所有 * 依赖项？

> ID：53069
> 
> 赞同：2
> 
> 时间：2008-09-09T22:43:57.337
> 
> 标签：sql-server, database, scripting

我正在编写一个 DDL 脚本来删除一些表，但需要首先确定这些表的所有依赖项。这些依赖项包括外键约束、存储过程、视图等。最好，我想在删除依赖表之前以编程方式使用系统表/视图删除这些依赖项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-09T23:06:06.830

从头开始编写非常混乱。您是否考虑过像 [Red-Gate SQL Dependency Tracker](http://www.red-gate.com/products/SQL_Dependency_Tracker/index.htm "Red-Gate SQL 依赖跟踪器")这样的第 3 方工具？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T23:02:01.880

sp_depends 不可靠 请参阅：[Do you depend on sp_depends (no 双关语)](http://sqlblog.com/blogs/denis_gobo/archive/2008/05/06/6653.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-09T23:09:04.810

您可以随时搜索 syscomments 表……不过这可能需要一段时间……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T03:23:01.300

你能参考一下`sysreferences`吗？

```
select 'if exists (select name from sysobjects where name = '''+c.name+''') '
+' alter table ' + t.name +' drop constraint '+ c.name 
 from sysreferences sbr, sysobjects c, sysobjects t, sysobjects r
 where c.id = constrid 
  and t.id = tableid 
  and reftabid = r.id
  and r.name = 'my_table' 
```

这将产生大量的条件`drop constraint`调用。应该管用。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-09T22:58:14.183

您可以使用 sp_depends 存储过程来执行此操作：

`USE AdventureWorks GO EXEC sp_depends @objname = N'Sales.Customer' ;`

[http://msdn.microsoft.com/en-us/library/ms189487(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms189487(SQL.90).aspx)

# .net - 在 .NET 2.0+ 中针对 PayPal API 进行编码的示例？

> ID：53070
> 
> 赞同：8
> 
> 时间：2008-09-09T22:44:05.573
> 
> 标签：.net, asp.net, paypal

谁能指出我对贝宝 API 编码的良好介绍？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-09T23:53:58.387

最近发现了 Rick Strahl 的这篇文章[http://www.west-wind.com/presentations/PayPalIntegration/PayPalIntegration.asp](http://www.west-wind.com/presentations/PayPalIntegration/PayPalIntegration.asp)。

还没有实现任何东西，Rick 在网上有很多关于 aspnet 电子商务的文章，他似乎每次我搜索它时都会出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-09T22:49:15.280

我建议您从下载 SDK 开始：

[https://www.paypal.com/IntegrationCenter/ic_sdk-resource.html](https://www.paypal.com/IntegrationCenter/ic_sdk-resource.html)

SDK 包括以下内容：

*   调用 PayPal API 的客户端库
*   SDK 组件的 API 文档
*   Website Payments Pro 和各种管理 API 的示例代码
*   可以验证与 PayPal 的连接并提交 API 调用的测试控制台

您可能还想查看[Encore Systems .NET* Class Library for PayPal SOAP API](http://paypal.encoresystems.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T04:50:27.080

我不知道您的需求是什么，但您可能需要考虑[Google Checkout](http://code.google.com/apis/checkout/samples/Google_Checkout_Sample_Code_NET.html)。 [Joe Audette](http://www.joeaudette.com/paypal-sandbox-doesnt-work.aspx)在集成 PayPal 时遇到了相当大的困难。

我[使用过](http://www.obtusesoft.com)Google Checkout 并取得了巨大的成功。请注意，您可以比上面链接的示例更深入地使用 Google Checkout。

* * *

编辑：我没有看到乔的更新。看起来他最终确实让它工作了。

# html - HTML 元关键字/描述元素，有用与否？

> ID：53081
> 
> 赞同：21
> 
> 时间：2008-09-09T22:51:25.947
> 
> 标签：html, seo

填写 HTML 元描述/关键字标签对 SEO 有影响吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-09T23:05:13.010

[这篇文章](http://searchengineland.com/070905-194221.php)有一些关于它的信息。

关键字的快速摘要是：

谷歌和微软：没有

雅虎和问：是的

编辑：如下所述，谷歌使用元描述向潜在访问者描述您的网站（尽管可能不用于排名）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-09T22:59:08.877

谷歌将使用元标记，但描述，以更好地总结您的网站。它们无助于提高您的网页排名。

请参阅： [http ://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=79812](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=79812)

**编辑**：@Petr，你确定元标签会影响页面排名吗？我很确定他们没有，但如果你有一些参考资料，我很想了解更多。我从 Google 官方网站管理员中心博客中看到了[这一点](http://googlewebmastercentral.blogspot.com/2009/09/google-does-not-use-keywords-meta-tag.html)，这让我相信他们没有：

> 尽管我们有时会为我们展示的片段使用描述元标记，但我们仍然不会在排名中使用描述元标记。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-19T22:19:52.497

关键词：没用

所有主要的搜索引擎根本不使用它们。

说明：有用！

如果没有更好的内容，则替换搜索引擎中的默认文本。使用它来正确描述页面。可能对 SEO 没有用，但它使您的结果看起来更有用，并有望提高用户的点击率。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-28T14:39:44.047

如果您希望您的用户在 Facebook 上分享您的内容，元标签实际上会派上用场，因为 Facebook 将在设置帖子样式时使用此信息。

有关更多信息，请参阅[Facebook 共享合作伙伴](http://wiki.developers.facebook.com/index.php/Facebook_Share/Specifying_Meta_Tags)。

编辑; 哎呀，错误的网址。固定的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T22:25:31.703

如果您的页面是 Intranet 的一部分，那么关键字和描述元标记都非常有用。如果您可以访问搜索引擎来抓取您的页面（因此您可以专门寻找特定的标签/标记），它们可以增加巨大的价值，而不会花费您太多时间并且很容易更改。

对于 Intranet 之外的页面，由于上述原因，您使用关键字可能不太成功。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-24T07:32:53.353

描述元很重要，因为它会逐字显示在您网站标题下方的 Google 搜索结果中。如果没有，谷歌会在 SERP 上提取并显示前几行内容。描述标签允许您控制 SE 用户在点击之前看到的页面摘要。这有助于提高您的搜索点击率。

关键字元有用性仍然没有定论，但 SEOers 继续使用它们。避免在每页标签中使用超过 5-6 个关键字，以免 Google 因任何可疑的关键字转储而检测和处罚。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-22T10:00:00.893

关键字元标签的问题在于它们对于搜索引擎来说是完全不可靠的信息来源。人们使用误导性关键字来改变搜索结果的诱惑太大了。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-09T23:00:04.257

这些是搜索引擎使用的两个东西。每个人的确切权重经常变化，他们一般都认为；但是，作为相当重要的。

需要注意的一件事是，输入值时应小心。关键字和描述与网站的文本内容越相关，它们的权重就越大。当然，没有任何保证，因为除了搜索引擎公司之外，没有人真正**知道**正在使用什么算法。

[这篇文章](https://stackoverflow.com/questions/5373/do-comment-permalinks-with-anchors-hurt-you-for-seo#5381)更多地讨论了一些方面。

# c# - 我可以依赖 GetHashCode() 的值来保持一致吗？

> ID：53086
> 
> 赞同：16
> 
> 时间：2008-09-09T22:52:32.853
> 
> 标签：c#, hash

假设使用相同的字符串值，是否保证 GetHashCode() 的返回值一致？(C#/ASP.NET)

我今天将代码上传到服务器，令我惊讶的是，我不得不重新索引一些数据，因为与我的台式计算机相比，我的服务器（win2008 64 位）返回了不同的值。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-09T22:54:51.303

如果我没记错的话，GetHashCode 在给定相同值的情况下是一致的，但不能保证在不同版本的框架之间保持一致。

来自 String.GetHashCode() 上的 MSDN 文档：

> GetHashCode 的行为取决于它的实现，它可能会从公共语言运行时的一个版本更改为另一个版本。发生这种情况的一个原因是为了提高 GetHashCode 的性能。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-07T16:04:37.013

我有一个类似的问题，我用依赖于 String.GetHashCode 的信息填充了一个数据库表（不是最好的主意），当我将正在使用的服务器升级到 x64 时，我注意到我从 String.GetHashCode 获得的值是与表中已有的内容不一致。我的解决方案是使用我自己的 GetHashCode 版本，它在 x86 框架上返回与 String.GetHashCode 相同的值。

这是代码，不要忘记使用“允许不安全代码”进行编译：

```
 /// <summary>
    /// Similar to String.GetHashCode but returns the same as the x86 version of String.GetHashCode for x64 and x86 frameworks.
    /// </summary>
    /// <param name="s"></param>
    /// <returns></returns>
    public static unsafe int GetHashCode32(string s)
    {
        fixed (char* str = s.ToCharArray())
        {
            char* chPtr = str;
            int num = 0x15051505;
            int num2 = num;
            int* numPtr = (int*)chPtr;
            for (int i = s.Length; i > 0; i -= 4)
            {
                num = (((num << 5) + num) + (num >> 0x1b)) ^ numPtr[0];
                if (i <= 2)
                {
                    break;
                }
                num2 = (((num2 << 5) + num2) + (num2 >> 0x1b)) ^ numPtr[1];
                numPtr += 2;
            }
            return (num + (num2 * 0x5d588b65));
        }
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-19T13:46:45.317

实现取决于框架的版本，但也取决于[架构](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=344006)。string.GetHashCode() 的实现在 x86 和 x64 版本的框架中是不同的，即使它们具有相同的版本号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T00:51:04.660

我想知道 32 位和 64 位操作系统之间是否存在差异，因为我确定我的服务器和家用计算机都运行相同版本的 .NET

我总是厌倦使用 GetHashCode()，对我来说，简单地扮演我自己的哈希算法可能是个好主意。好吧，至少我最终写了一个快速重新索引 .aspx 页面，因为它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T02:19:57.020

您是否正在运行 Win2008 x86 作为您的桌面？因为 Win2008 包含[2.0.50727.1434](http://www.ditii.com/2008/02/16/windows-server-2008-windows-vista-sp1-net-framework-source-symbols/)版本，它是 Vista RTM 中包含的 2.0 的更新版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T07:06:29.470

不是对您的问题的直接回答，乔纳斯已经很好地回答了这个问题，但是如果您担心哈希中的相等性测试，这可能会有所帮助

根据我们的测试，根据您对哈希码的要求，在 C# 中，对于 Equality 操作，哈希码不需要是唯一的。例如，考虑以下情况：

我们需要重载等号运算符，因此我们的对象的 GetHashCode 函数已经变得易变和无状态，并且直接从数据中获取自身，因此我们需要在应用程序的一个地方确保可以查看对象*如果它来自相同的数据*，则与另一个对象相等，而不仅仅是它是相同的引用。我们的唯一数据标识符是 Guid。

equals 运算符很容易满足，因为我们刚刚检查了记录的 Guid（在检查 null 之后）。

不幸的是，HashCode 数据大小（作为 int）取决于操作系统，而在我们的 32 位系统上，哈希码将是 32 位。从数学上讲，当我们重写 GetHashCode 函数时，不可能从大于 32 位的 guid 生成唯一的哈希码（从反面来看，如何将 32 位整数转换为 guid？）。

然后我们做了一些测试，我们将 Guid 作为字符串并返回 Guid 的 HashCode，它在我们的测试中几乎总是返回一个唯一标识符，但并非总是如此。

然而，我们确实注意到，当一个对象在散列集合对象（散列表、字典等）中时，当 2 个对象不是唯一的但它们的散列码是唯一的时，散列码仅用作第一个选项查找，如果没有- 使用唯一的哈希码，*相等运算符始终用作确定相等的后备*。

正如我所说，这可能与您的情况相关，也可能不相关，但如果它是一个方便的提示。

**更新**

为了演示，我们有一个 Hashtable：

键：对象A（哈希码1），值对象A1

键：对象B（哈希码1），值对象B1

键：对象C（哈希码1），值对象C1

键：对象 D（哈希码 2），值对象 D1

键：对象 E（哈希码 3），值对象 E1

当我使用对象 A 的键调用对象的哈希表时，对象 A1 将在 2 个步骤后返回，调用哈希码 1，然后对键对象进行相等性检查，因为没有具有哈希码 1 的唯一键

当我使用对象 D 的键调用对象的哈希表时，将在 1 步后返回对象 D1，进行哈希查找

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T08:27:32.287

> 然而，我们确实注意到，当一个对象在散列集合对象（散列表、字典等）中时，当 2 个对象不是唯一的但它们的散列码是唯一的时，散列码仅用作第一个选项查找，如果没有- 使用唯一的哈希码，相等运算符始终用作确定相等性的后备。

这就是哈希查找的工作方式，对吧？每个桶包含一个具有相同哈希码的项目列表。

因此，为了在这些条件下找到正确的项目，使用值相等比较进行线性搜索。

如果您的散列实现实现了良好的分布，则不需要此搜索，即每个存储桶一个项目。

我的理解正确吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-21T08:13:39.990

```
 /// <summary>
    /// Default implementation of string.GetHashCode is not consistent on different platforms (x32/x64 which is our case) and frameworks. 
    /// FNV-1a - (Fowler/Noll/Vo) is a fast, consistent, non-cryptographic hash algorithm with good dispersion. (see http://isthe.com/chongo/tech/comp/fnv/#FNV-1a)
    /// </summary>
    private static int GetFNV1aHashCode(string str)
    {
        if (str == null)
            return 0;
        var length = str.Length;
        // original FNV-1a has 32 bit offset_basis = 2166136261 but length gives a bit better dispersion (2%) for our case where all the strings are equal length, for example: "3EC0FFFF01ECD9C4001B01E2A707"
        int hash = length;
        for (int i = 0; i != length; ++i)
            hash = (hash ^ str[i]) * 16777619;
        return hash;
    } 
```

此实现可能比之前发布的不安全实现要慢。但更简单和安全。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-11-15T19:55:34.697

我不得不说......你不能依赖它。例如，如果我通过 c# 的 md5 哈希码运行 file1 并将相同的文件复制并粘贴到一个新目录中……哈希码会出现不同的结果，即使它是同一个文件。显然它是相同的 .net 版本，相同的一切。唯一改变的是路径。

# c# - 为什么 Path.Combine 不能正确连接以 Path.DirectorySeparatorChar 开头的文件名？

> ID：53102
> 
> 赞同：212
> 
> 时间：2008-09-09T23:05:06.553
> 
> 标签：c#, .net, file

在 Visual Studio的*即时窗口中：*

```
> Path.Combine(@"C:\x", "y")
"C:\\x\\y"
> Path.Combine(@"C:\x", @"\y")
"\\y" 
```

看来他们应该是一样的。

旧的 FileSystemObject.BuildPath() 不能这样工作......

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2008-09-09T23:16:02.253

这是一个哲学问题（也许只有微软才能真正回答），因为它完全按照文档所说的那样做。

[System.IO.Path.Combine](http://msdn.microsoft.com/en-us/library/system.io.path.combine.aspx)

“如果 path2 包含绝对路径，则此方法返回 path2。”

这是来自 .NET 源代码[的实际组合方法。](http://referencesource.microsoft.com/#mscorlib/system/io/path.cs,2d7263f86a526264)您可以看到它调用了[CombineNoChecks](http://referencesource.microsoft.com/mscorlib/system/io/path.cs.html#16ed6da326ce4745)，然后它在 path2 上调用[IsPathRooted](http://referencesource.microsoft.com/mscorlib/system/io/path.cs.html#807960f08fca497d)并返回该路径（如果是）：

```
public static String Combine(String path1, String path2) {
    if (path1==null || path2==null)
        throw new ArgumentNullException((path1==null) ? "path1" : "path2");
    Contract.EndContractBlock();
    CheckInvalidPathChars(path1);
    CheckInvalidPathChars(path2);

    return CombineNoChecks(path1, path2);
}

internal static string CombineNoChecks(string path1, string path2)
{
    if (path2.Length == 0)
        return path1;

    if (path1.Length == 0)
        return path2;

    if (IsPathRooted(path2))
        return path2;

    char ch = path1[path1.Length - 1];
    if (ch != DirectorySeparatorChar && ch != AltDirectorySeparatorChar &&
            ch != VolumeSeparatorChar) 
        return path1 + DirectorySeparatorCharAsString + path2;
    return path1 + path2;
} 
```

我不知道理由是什么。我想解决方案是从第二条路径的开头剥离（或修剪）DirectorySeparatorChar；也许编写您自己的组合方法，然后调用 Path.Combine()。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-06-30T06:52:21.650

我想解决这个问题：

```
string sample1 = "configuration/config.xml";
string sample2 = "/configuration/config.xml";
string sample3 = "\\configuration/config.xml";

string dir1 = "c:\\temp";
string dir2 = "c:\\temp\\";
string dir3 = "c:\\temp/";

string path1 = PathCombine(dir1, sample1);
string path2 = PathCombine(dir1, sample2);
string path3 = PathCombine(dir1, sample3);

string path4 = PathCombine(dir2, sample1);
string path5 = PathCombine(dir2, sample2);
string path6 = PathCombine(dir2, sample3);

string path7 = PathCombine(dir3, sample1);
string path8 = PathCombine(dir3, sample2);
string path9 = PathCombine(dir3, sample3); 
```

当然，所有路径 1-9 最后都应该包含一个等效的字符串。这是我想出的 PathCombine 方法：

```
private string PathCombine(string path1, string path2)
{
    if (Path.IsPathRooted(path2))
    {
        path2 = path2.TrimStart(Path.DirectorySeparatorChar);
        path2 = path2.TrimStart(Path.AltDirectorySeparatorChar);
    }

    return Path.Combine(path1, path2);
} 
```

我还认为必须手动完成此字符串处理非常烦人，我会对这背后的原因感兴趣。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-09T23:17:11.000

这是来自[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)的 Path.Combine 方法的反汇编代码。检查 IsPathRooted 函数。如果第二个路径是根路径（以 DirectorySeparatorChar 开头），则按原样返回第二个路径。

```
public static string Combine(string path1, string path2)
{
    if ((path1 == null) || (path2 == null))
    {
        throw new ArgumentNullException((path1 == null) ? "path1" : "path2");
    }
    CheckInvalidPathChars(path1);
    CheckInvalidPathChars(path2);
    if (path2.Length == 0)
    {
        return path1;
    }
    if (path1.Length == 0)
    {
        return path2;
    }
    if (IsPathRooted(path2))
    {
        return path2;
    }
    char ch = path1[path1.Length - 1];
    if (((ch != DirectorySeparatorChar) &&
         (ch != AltDirectorySeparatorChar)) &&
         (ch != VolumeSeparatorChar))
    {
        return (path1 + DirectorySeparatorChar + path2);
    }
    return (path1 + path2);
}

public static bool IsPathRooted(string path)
{
    if (path != null)
    {
        CheckInvalidPathChars(path);
        int length = path.Length;
        if (
              (
                  (length >= 1) &&
                  (
                      (path[0] == DirectorySeparatorChar) ||
                      (path[0] == AltDirectorySeparatorChar)
                  )
              )

              ||

              ((length >= 2) &&
              (path[1] == VolumeSeparatorChar))
           )
        {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-09-10T07:12:00.813

在我看来，这是一个错误。问题是有两种不同类型的“绝对”路径。路径“d:\mydir\myfile.txt”是绝对路径，路径“\mydir\myfile.txt”也被认为是“绝对”路径，即使它缺少驱动器号。在我看来，正确的行为是当第二个路径以目录分隔符（并且不是 UNC 路径）开头时，将驱动器号从第一个路径添加到前面。我建议编写自己的辅助包装函数，如果需要，它具有你想要的行为。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-09T23:13:51.400

来自[MSDN](https://msdn.microsoft.com/en-us/library/fyy7a5kt.aspx)：

> 如果指定路径之一是零长度字符串，则此方法返回另一个路径。如果 path2 包含绝对路径，则此方法返回 path2。

在您的示例中， path2 是绝对的。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-04-19T23:59:33.847

遵循[Christian Graus](https://www.blogger.com/profile/13444285493681626756 "克里斯蒂安·格劳斯")在他的“我讨厌微软的事情”博客中的建议，标题为“ [Path.Combine 本质上是无用的。](http://thingsihateaboutmicrosoft.blogspot.com/2009/08/pathcombine-is-essentially-useless.html "Path.Combine 本质上是无用的。") ”，这是我的解决方案：

```
public static class Pathy
{
    public static string Combine(string path1, string path2)
    {
        if (path1 == null) return path2
        else if (path2 == null) return path1
        else return path1.Trim().TrimEnd(System.IO.Path.DirectorySeparatorChar)
           + System.IO.Path.DirectorySeparatorChar
           + path2.Trim().TrimStart(System.IO.Path.DirectorySeparatorChar);
    }

    public static string Combine(string path1, string path2, string path3)
    {
        return Combine(Combine(path1, path2), path3);
    }
} 
```

一些人建议命名空间应该发生冲突，...我`Pathy`只是轻微地选择了 ，以避免命名空间与`System.IO.Path`.

**编辑**：添加空参数检查

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-12-03T11:59:56.397

这段代码应该可以解决问题：

```
 string strFinalPath = string.Empty;
        string normalizedFirstPath = Path1.TrimEnd(new char[] { '\\' });
        string normalizedSecondPath = Path2.TrimStart(new char[] { '\\' });
        strFinalPath =  Path.Combine(normalizedFirstPath, normalizedSecondPath);
        return strFinalPath; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-09T23:08:53.207

不知道实际细节，我的猜测是它会尝试加入，就像你可能加入相对 URI 一样。例如：

```
urljoin('/some/abs/path', '../other') = '/some/abs/other' 
```

这意味着当您使用前面的斜杠连接路径时，实际上是将一个碱基连接到另一个碱基，在这种情况下，第二个碱基优先。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-05-14T21:23:04.963

**原因：**

您的第二个 URL 被视为绝对路径，`Combine`如果最后一个路径是绝对路径，该方法只会返回最后一个路径。

**解决方案：**

`/`只需从第二个路径（`/SecondPath`to ）中删除前导斜杠`SecondPath`，它就会像例外一样工作。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-07-18T11:10:00.933

如果你想在不丢失任何路径的情况下合并两条路径，你可以使用这个：

```
?Path.Combine(@"C:\test", @"\test".Substring(0, 1) == @"\" ? @"\test".Substring(1, @"\test".Length - 1) : @"\test"); 
```

或使用变量：

```
string Path1 = @"C:\Test";
string Path2 = @"\test";
string FullPath = Path.Combine(Path1, Path2.IsRooted() ? Path2.Substring(1, Path2.Length - 1) : Path2); 
```

两种情况都返回“C:\test\test”。

首先，我评估 Path2 是否以 / 开头，如果是，则返回没有第一个字符的 Path2。否则，返回完整的 Path2。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-01-12T14:30:47.697

在某种程度上，考虑到通常如何处理（相对）路径，这实际上是有道理的：

```
string GetFullPath(string path)
{
     string baseDir = @"C:\Users\Foo.Bar";
     return Path.Combine(baseDir, path);
}

// Get full path for RELATIVE file path
GetFullPath("file.txt"); // = C:\Users\Foo.Bar\file.txt

// Get full path for ROOTED file path
GetFullPath(@"C:\Temp\file.txt"); // = C:\Temp\file.txt 
```

真正的问题是：为什么以 开头的路径`"\"`被认为是“有根的”？这对我来说也是新的，但[它在 Windows 上以这种方式工作](https://blogs.msdn.microsoft.com/jeremykuhne/2016/04/21/path-normalization/)：

```
new FileInfo("\windows"); // FullName = C:\Windows, Exists = True
new FileInfo("windows"); // FullName = C:\Users\Foo.Bar\Windows, Exists = False 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-09-20T07:17:58.337

我使用聚合函数来强制路径组合如下：

```
public class MyPath    
{
    public static string ForceCombine(params string[] paths)
    {
        return paths.Aggregate((x, y) => Path.Combine(x, y.TrimStart('\\')));
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-09-12T21:46:08.437

删除 Path.Combine 的第二个参数 (path2) 中的起始斜杠 ('\')。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-23T21:51:41.443

这个\表示“当前驱动器的根目录”。在您的示例中，它表示当前驱动器根目录中的“测试”文件夹。因此，这可以等于“c:\test”。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-08-01T17:12:44.357

这两种方法应该可以避免您意外连接两个都有分隔符的字符串。

```
 public static string Combine(string x, string y, char delimiter) {
        return $"{ x.TrimEnd(delimiter) }{ delimiter }{ y.TrimStart(delimiter) }";
    }

    public static string Combine(string[] xs, char delimiter) {
        if (xs.Length < 1) return string.Empty;
        if (xs.Length == 1) return xs[0];
        var x = Combine(xs[0], xs[1], delimiter);
        if (xs.Length == 2) return x;
        var ys = new List<string>();
        ys.Add(x);
        ys.AddRange(xs.Skip(2).ToList());
        return Combine(ys.ToArray(), delimiter);
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-12-17T17:40:57.327

正如 Ryan 所提到的，它完全按照文档所说的那样做。

从 DOS 时代来看，当前磁盘和当前路径是有区别的。 `\`是根路径，但对于当前磁盘。

对于每个“*磁盘*”，都有一个单独的“*当前路径*”。如果您更改磁盘，`cd D:`请不要将当前路径更改为`D:\`，而是更改为： "D:\whatever\was\the\last\path\accessed\on\this\disk"...

因此，在 Windows 中，字面`@"\x"`意思是：“CURRENTDISK:\x”。因此`Path.Combine(@"C:\x", @"\y")`，第二个参数是根路径，而不是相对路径，虽然不在已知磁盘中......而且由于不知道哪个可能是«当前磁盘»，python返回`"\\y"`。

```
>cd C:
>cd \mydironC\apath
>cd D:
>cd \mydironD\bpath
>cd C:
>cd
>C:\mydironC\apath 
```

# sql - 是否可以进行递归 SQL 查询？

> ID：53108
> 
> 赞同：63
> 
> 时间：2008-09-09T23:08:24.983
> 
> 标签：sql, postgresql, recursive-query

我有一个类似的表：

```
CREATE TABLE example (
  id integer primary key,
  name char(200),
  parentid integer,
  value integer); 
```

我可以使用 parentid 字段将数据排列成树结构。

现在这是我无法解决的问题。给定一个 parentid，是否可以编写一条 SQL 语句来将该 parentid 下的所有值字段相加并递归到树的分支？

**更新：**我正在使用 posgreSQL，所以我无法使用花哨的 MS-SQL 功能。无论如何，我希望这被视为一个通用的 SQL 问题。

顺便说一句，在提出问题的 15 分钟内有 6 个答案给我留下了深刻的印象！去堆栈溢出！

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2011-04-18T09:50:16.330

下面是一个使用公用表表达式的示例脚本：

```
with recursive sumthis(id, val) as (
    select id, value
    from example
    where id = :selectedid
    union all
    select C.id, C.value
    from sumthis P
    inner join example C on P.id = C.parentid
)
select sum(val) from sumthis 
```

上面的脚本创建了一个名为“虚拟”的表`sumthis`，其中包含列`id`和`val`. 它被定义为两个选择合并的结果`union all`。

首先`select`获取根 ( `where id = :selectedid`)。

第二个`select`迭代地跟随先前结果的孩子，直到没有任何东西可以返回。

然后可以像处理普通表格一样处理最终结果。在这种情况下，val 列被求和。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-14T06:39:39.873

从版本 8.4 开始，PostgreSQL使用 SQL 标准语法对公用表表达式提供[递归查询支持。](http://www.postgresql.org/docs/current/static/queries-with.html)`WITH`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-09-09T23:40:43.020

[如果您想要一个适用于任何 ANSI SQL-92](http://en.wikipedia.org/wiki/SQL-92) RDBMS的可移植解决方案，您需要向表中添加一个新列。

Joe Celko 是在 SQL 中存储层次结构的**[Nested Sets](http://www.intelligententerprise.com/001020/celko.jhtml)**方法的原始作者。您可以谷歌[“嵌套集”层次结构](http://www.google.com/search?q=%22nested+sets%22+hierarchy)以了解有关背景的更多信息。

或者您可以将 parentid 重命名为**leftid**并添加一个**rightid**。

这是我对嵌套集的尝试总结，因为我不是 Joe Celko，所以它会很短：SQL 是一种基于集合的语言，而邻接模型（存储父 ID）不是基于集合的层次结构表示。因此，没有纯粹的基于集合的方法来查询邻接模式。

**但是**，近年来，大多数主要平台都引入了扩展来处理这个精确的问题。因此，如果有人回复特定于 Postgres 的解决方案，请务必使用它。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-10T15:16:56.747

在 PostgreSQL 中有几种方法可以满足您的需求。

*   如果可以安装模块，请查看 tablefunc 贡献。它有一个 connectby() 函数来处理遍历树。[http://www.postgresql.org/docs/8.3/interactive/tablefunc.html](http://www.postgresql.org/docs/8.3/interactive/tablefunc.html)

*   还可以查看 ltree contrib，您可以调整您的表格以供使用：[http ://www.postgresql.org/docs/8.3/interactive/ltree.html](http://www.postgresql.org/docs/8.3/interactive/ltree.html)

*   或者您可以使用 PL/PGSQL 函数自己遍历树。

像这样的东西：

```
create or replace function example_subtree (integer)
returns setof example as
'declare results record;
         child record;
 begin
  select into results * from example where parent_id = $1;
  if found then
    return next results;
    for child in select id from example
                  where parent_id = $1
      loop
        for temp in select * from example_subtree(child.id)
        loop
          return next temp;
        end loop;
      end loop;
  end if;
  return null;
end;' language 'plpgsql';

select sum(value) as value_sum
  from example_subtree(1234); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-01-11T16:11:19.793

进行递归查询的标准方法`SQL`是 recursive `CTE`。`PostgreSQL`支持他们，因为`8.4`。

在早期版本中，您可以编写递归集合返回函数：

```
CREATE FUNCTION fn_hierarchy (parent INT)
RETURNS SETOF example
AS
$$
        SELECT  example
        FROM    example
        WHERE   id = $1
        UNION ALL
        SELECT  fn_hierarchy(id)
        FROM    example
        WHERE   parentid = $1
$$
LANGUAGE 'sql';

SELECT  *
FROM    fn_hierarchy(1) 
```

见这篇文章：

*   [**PostgreSQL 中的分层查询**](http://explainextended.com/2009/05/29/hierarchical-queries-in-postgresql/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-09T23:17:06.320

使用[公用表表达式](http://msdn.microsoft.com/en-us/library/ms186243.aspx)。

> 可能想表明这只是 SQL Server 2005 或更高版本。[戴尔·拉根](https://stackoverflow.com/users/1117/dale-ragan)

[这是一篇](http://www.sqlteam.com/article/more-trees-hierarchies-in-sql)关于没有公用表表达式的 SqlTeam 递归的文章。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-09T23:23:59.597

如果您使用 SQL Server 2005，那么使用公用表表达式有一种非常酷的方法。

它消除了创建临时表的所有繁琐工作，并且基本上允许您只使用 WITH 和 UNION 来完成所有工作。

这是一个很好的教程：

[http://searchwindevelopment.techtarget.com/tip/0,289483,sid8_gci1278207,00.html](http://searchwindevelopment.techtarget.com/tip/0,289483,sid8_gci1278207,00.html)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-03T21:14:11.583

以下代码编译并测试正常。

```
创建或替换函数子树 (bigint)
返回 setof 示例为 $$
宣布
    结果记录；
    入境记录；
    记录记录；
开始
    select into results * from example where parent = $1;
    如果找到然后
        用于从父 = $1 和子父循环的示例中选择子项
            for recs in select * from subtree(entry.child) 循环
                返回下一个记录；
            结束循环；
        结束循环；
    万一;
    返回下一个结果；
结尾;
$$ 语言 'plpgsql';

```

在我的情况下需要条件“child <> parent”，因为节点指向自己。

玩得开心 ：）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-09T23:30:11.330

Oracle 有“START WITH”和“CONNECT BY”

```
select 
    lpad(' ',2*(level-1)) || to_char(child) s

from 
    test_connect_by 

start with parent is null
connect by prior child = parent; 
```

[http://www.adp-gmbh.ch/ora/sql/connect_by.html](http://www.adp-gmbh.ch/ora/sql/connect_by.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-17T22:38:46.390

顺便说一句，尽管这个问题已经得到很好的回答，但应该注意的是，如果我们将其视为：

> 通用 SQL 问题

那么 SQL 实现是相当直接的，因为 SQL'99 允许通过`WITH RECURSIVE`语句在规范中进行线性递归（尽管我相信没有 RDBMS 完全实现标准）。所以从理论的角度来看，我们现在可以做到这一点。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-01-11T16:03:10.220

没有一个例子对我有用，所以我已经像这样修复它：

```
宣布
    结果记录；
    入境记录；
    记录记录；
开始
    对于 select * from project where pid = $1 循环中的结果
        返回下一个结果；
        for recs in select * from project_subtree(results.id) 循环
            返回下一个记录；
        结束循环；
    结束循环；
    返回;
结尾;

```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-09T23:16:19.193

这是 SQL Server 吗？您不能编写一个循环遍历并将结果合并在一起的 TSQL 存储过程吗？

不过，我也很感兴趣是否有一种仅限 SQL 的方式来执行此操作。从我在地理数据库课上记得的部分来看，应该有。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-09T23:23:47.757

我认为在 SQL 2008 中使用[HierarchyID更容易](http://msdn.microsoft.com/en-us/magazine/cc794278.aspx)

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-09-10T00:30:37.143

如果您需要存储任意图形，而不仅仅是层次结构，您可以将 Postgres 推到一边并尝试使用图形数据库，例如[AllegroGraph](http://agraph.franz.com/support/learning/)：

图数据库中的所有内容都存储为三元组（源节点、边、目标节点），它为您提供一流的支持来操作图结构并使用类似 SQL 的语言对其进行查询。

它不能与 Hibernate 或 Django ORM 之类的东西很好地集成，但如果您对图形结构很认真（不仅仅是嵌套集模型给您的层次结构），请检查一下。

我也相信甲骨文终于在他们的最新产品中增加了对真实图的支持，但我很惊讶它花了这么长时间，很多问题都可以从这个模型中受益。

# plugins - 为插件代码使用源代码控制和 IDE 的好方法？

> ID：53112
> 
> 赞同：0
> 
> 时间：2008-09-09T23:09:10.367
> 
> 标签：plugins, ide

处理与外部系统交互的插件代码问题的好方法是什么？

举一个具体且有代表性的例子，假设我想使用 Subversion 和 Eclipse 来开发 WordPress 插件。WordPress 的主要代码体安装在网络服务器上，插件代码需要在该服务器的子目录中可用。

我可以看到您如何直接在开发机器上的 web 目录下简单地签出您的代码副本，但是您如何将其与 IDE 集成呢？

我在这里假设插件的所有代码都位于一个目录下。

大多数人是否只是将插件作为项目添加到 IDE 中，然后将项目的工作文件夹放置在“主要”软件系统想要的任何位置？或者人们是否使用某种符号链接到他们的主目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-09T23:19:51.557

对我来说，添加一个指向您的开发文件夹的符号链接似乎是解决问题的好方法。

如果主项目在不同的机器/网络服务器上，你可以使用 sshfs 之类的东西将你的开发目录挂载到网络服务器上的正确位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-09T23:20:47.827

简短的回答 - 我确实让我的开发和生产服务器直接从 SVN 签出相应的目录。

对于您的示例：

像往常一样在 IDE 上进行开发，然后，当您准备好测试时，签入您的本地存储库。然后，您的开发网络服务器可以签出该目录，您可以轻松地进行测试。

准备好生产后，将更改合并到生产分支，并在生产网络服务器上执行 svn 更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-09T23:26:38.327

在我工作的地方，有些人喜欢为此目的使用适用于 Eclipse 的[FileSync 插件](http://andrei.gmxhome.de/filesync/index.html)，尽管我已经看到该插件的一些奇怪之处，即目标目录中的文件偶尔会丢失。整个结构是：

*   在所需位置创建目标目录的 Ant 任务（主要通过复制命令）
*   [FileSync 插件](http://andrei.gmxhome.de/filesync/index.html)配置为在您编写代码时使文件在开发位置和目标位置之间保持同步（将 Eclipse 输出文件夹同步到 Web 服务器类路径中的某个位置等）

当然，符号链接可能在对符号链接有良好支持的系统上工作得更好:-)

# java - Java ConnectionPool 连接未关闭，卡在“睡眠”中

> ID：53128
> 
> 赞同：4
> 
> 时间：2008-09-09T23:22:23.483
> 
> 标签：java, database, tomcat

我有一个使用 JNDI 查找来连接数据库的 web 应用程序。

连接工作正常，返回查询没有问题。我们的问题是连接没有正确关闭并且卡在“睡眠”模式（根据mysql管理员）。这意味着它们变得无法使用，然后我的连接就用完了。

有人可以给我一些关于我可以做些什么来使连接成功返回池的指示。

```
public class DatabaseBean {

private static final Logger logger = Logger.getLogger(DatabaseBean.class);

private Connection conn;
private PreparedStatement prepStmt;

/**
 * Zero argument constructor
 * Setup generic databse connection in here to avoid redundancy
 * The connection details are in /META-INF/context.xml
 */
public DatabaseBean() {
    try {
        InitialContext initContext = new InitialContext();
        DataSource ds = (DataSource) initContext.lookup("java:/comp/env/jdbc/mysite");
        conn = ds.getConnection();
    }
    catch (SQLException SQLEx) {
        logger.fatal("There was a problem with the database connection.");
        logger.fatal(SQLEx);
        logger.fatal(SQLEx.getCause());
    }
    catch (NamingException nameEx) {
        logger.fatal("There was a naming exception");
        logger.fatal(nameEx);
        logger.fatal(nameEx.getCause());
    }
}

/**
 * Execute a query. Do not use for statements (update delete insert etc).
 *
 * @return A ResultSet of the execute query. A set of size zero if no results were returned. It is never null.
 * @see #executeUpdate() for running update, insert delete etc.
 */

public ResultSet executeQuery() {
    ResultSet result = null;
    try {
        result = prepStmt.executeQuery();
        logger.debug(prepStmt.toString());
    }
    catch (SQLException SQLEx) {
        logger.fatal("There was an error running a query");
        logger.fatal(SQLEx);
    }
    return result;
} 
```

*剪辑*

```
public void close() {
    try {
        prepStmt.close();
        prepStmt = null;

        conn.close();
        conn = null;
    } catch (SQLException SQLEx) {
        logger.warn("There was an error closing the database connection.");
    }
}
} 
```

这是在使用数据库连接的 javabean 中。

```
public LinkedList<ImportantNoticeBean> getImportantNotices() {

    DatabaseBean noticesDBBean = new DatabaseBean();
    LinkedList<ImportantNoticeBean> listOfNotices = new LinkedList<ImportantNoticeBean>();

    try {
        PreparedStatement preStmt = noticesDBBean.getConn().prepareStatement("SELECT pseudonym, message, date_to, date_from " +
                "FROM importantnotices, users " +
                "WHERE importantnotices.username = users.username " +
                "AND NOW() >= date_from AND NOW() <= date_to;");

        noticesDBBean.setPrepStmt(preStmt);
        ResultSet result = noticesDBBean.executeQuery();

        while (result.next()) {
            ImportantNoticeBean noticeBean = new ImportantNoticeBean();

            noticeBean.setAuthor(result.getString("pseudonym"));
            noticeBean.setMessage(result.getString("message"));
            noticeBean.setDateTo(result.getDate("date_to"));
            noticeBean.setDateFrom(result.getDate("date_from"));

            listOfNotices.add(noticeBean);
        }

        result.close();

    } catch (SQLException SQLEx) {
        logger.error("There was an error in ImportantNoticesBean.getImportantNotices()");
        logger.error(SQLEx);
    } finally {
        noticesDBBean.close();
    }
    return listOfNotices;
}

<Context reloadable="true">

    <Resource name="jdbc/mysite"
              auth="Container"
              type="javax.sql.DataSource"
              username="user"
              password="password"
              driverClassName="com.mysql.jdbc.Driver"
              url="jdbc:mysql://localhost:3306/mysite"
              maxActive="10"
              maxIdle="5"
              maxWait="6000"
              removeAbandoned="true"
              logAbandoned="false"
              removeAbandonedTimeout="20"
            />
</Context> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T01:29:31.043

您似乎正确地关闭了连接 - 除了 prepStmt.close() 抛出 SQLException 的情况，我找不到连接泄漏。

您使用的是什么池实现？当你关闭一个连接时，池不需要立即关闭底层的 MySQL 连接——毕竟​​那是连接池的重点！因此，从 MySQL 方面来看，尽管您的应用程序没有使用任何连接，但连接看起来是活跃的；它们可能只是由 TC 连接池持有。

您可能想尝试连接池的设置。要求它在系统空闲时收缩池。或者，要求它定期刷新所有连接。或者，对它从 MySQL 等获得的并发连接数有一个严格的上限。

检查您的代码是否存在连接泄漏的一种方法是强制 ds.getConnection() 始终打开新的物理连接并 conn.close() 释放连接（如果您的连接池具有这些设置）。然后，如果您观察 MySQL 端的连接，您可能能够确定代码是否真的存在连接泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T13:52:25.657

这是一个类似的问题 - [Tomcat 的连接池设置](https://stackoverflow.com/questions/15949/javatomcat-dying-databse-connection#16168)

这是我对那个问题的回答，它为另一个人解决了这个问题。它也可以帮助你。

[Tomcat 文档](http://tomcat.apache.org/tomcat-5.5-doc/jndi-datasource-examples-howto.html)

DBCP 使用 Jakarta-Commons 数据库连接池。它依赖于 Jakarta-Commons 组件的数量：

```
* Jakarta-Commons DBCP
* Jakarta-Commons Collections
* Jakarta-Commons Pool 
```

我正在使用相同的连接池的东西，我正在设置这些属性以防止它只是没有通过 tomcat 配置的相同的东西。但是，如果第一件事不起作用，请尝试这些。

```
testWhileIdle=true
timeBetweenEvictionRunsMillis=300000 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-12T12:00:24.003

好的，我可能已经排序了。我已将数据库配置资源更改为以下内容：

```
*SNIP*
maxActive="10"
maxIdle="5"
maxWait="7000"
removeAbandoned="true"
logAbandoned="false"
removeAbandonedTimeout="3"
*SNIP* 
```

这目前工作得很好。发生了什么，afaik，一旦我达到十个连接，那么 Tomcat 就会检查放弃的连接（空闲时间 > 3）。每次达到最大连接数时，它都会在批处理作业中执行此操作。这样做的潜在问题是，如果我需要同时运行 10 个以上的查询（不是我独有的）。重要的是 removeAbandonedTimeout 小于 maxWait。

这是应该发生的事情吗？即这是池应该运行的方式吗？如果是这样的话，至少在我看来，你会等到某些东西（连接）断开后再修复，而不是一开始就不让它“断开”。也许我仍然没有得到它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-08T07:31:07.880

> 我们的问题是连接没有正确关闭并且卡在“睡眠”模式

这实际上只对了一半。

我遇到的问题实际上是每个应用程序都在定义与数据库服务器的新连接。所以每次我关闭所有连接时，App A 都会根据它的 WEB.xml 配置文件建立一堆新的连接并愉快地运行。应用程序 B 也会这样做。问题是它们是*独立的池*，它们试图达到服务器定义的限制。我猜这是一种竞争条件。因此，当应用程序 A 完成连接后，它会等待再次使用它们，直到超时过去，而现在需要连接的应用程序 B 被拒绝资源，即使应用程序 A 已完成连接并且应该回到池中。一旦超时过去，连接就会被释放，B（或 C 等）可以再次访问它。

例如，如果限制为 10（mySQL 配置文件限制）并且每个应用程序已配置为最多使用 10 个，则将有 20 次连接尝试。显然，这是一个糟糕的情况。

解决方案是 RTFM 并将[连接详细信息放在正确的位置](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)。这确实使共享发布很痛苦，但有一些方法可以解决它（例如从上下文链接到其他 xml 文件）。

明确一点：我将每个应用程序的连接详细信息放在 WEB.xml 中，并为此争论不休。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T12:42:52.173

@binil 错过的一件事是，在发生异常的情况下，您不会关闭结果集。根据驱动程序的实现，这可能会导致连接保持打开状态。将 result.close() 调用移至 finally 块。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-06T04:50:04.193

我正在使用与您相同的配置。如果 mysql 管理员（windows）中的连接显示它处于睡眠模式，则仅表示已入池但未使用。我检查了这个运行测试程序的程序，该程序有多个线程对 Mysql 进行随机查询。如果有帮助，这是我的配置：

```
 defaultAutoCommit="false"
        defaultTransactionIsolation="REPEATABLE_READ"
        auth="Container"
        type="javax.sql.DataSource"
        logAbandoned="true" 
          removeAbandoned="true"
        removeAbandonedTimeout="300" 
        maxActive="-1"
        initialSize="15"
        maxIdle="10"
        maxWait="10000" 
        username="youruser"
        password="youruserpassword"
        driverClassName="com.mysql.jdbc.Driver"
        url="jdbc:mysql://yourhost/yourdatabase"/> 
```

# registry - 如果没有管理员权限，您可以获得哪些注册表访问权限？

> ID：53135
> 
> 赞同：61
> 
> 时间：2008-09-09T23:29:25.167
> 
> 标签：registry, privileges, administrator

我知道我们不应该再使用注册表来存储应用程序数据，但是在更新旧应用程序（并希望做最少的更改）时，非管理员允许使用哪些注册表配置单元？

我可以在没有管理员权限 的情况下访问所有`HKEY_CURRENT_USER`（当前访问的应用程序）吗？`HKEY_LOCAL_MACHINE`

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-09-09T23:53:12.023

通常，非管理员用户对注册表具有以下访问权限：

读/写到：

*   `HKEY_CURRENT_USER`

只读：

*   `HKEY_LOCAL_MACHINE`
*   `HKEY_CLASSES_ROOT`（这只是一个*链接*）`HKEY_LOCAL_MACHINE\Software\Classes`

可以逐个键更改其中一些权限，但这种情况极为罕见。您不必担心这一点。

出于您的目的，您的应用程序应该将设置和配置写入`HKEY_CURRENT_USER`. 规范的地方在任何地方`HKEY_CURRENT_USER\Software\YourCompany\YourProduct\`

您可能会在`HKEY_LOCAL_MACHINE`. 很少需要这样做，你应该避免它。问题是任何用户都可以“读取”它们，但只有管理员（或扩展，您的设置/安装程序）可以“设置”它们。

其他常见的问题来源：您的应用程序不应写入目录中的任何`Program files`内容`Windows`。如果您需要写入文件，手头有几个选项；描述所有这些将是一个更长的讨论。所有选项最终都会写入相关用户的子文件夹或另一个子文件夹`%USERPROFILE%`。

最后，您的应用程序应该远离`HKEY_CURRENT_CONFIG`. 该配置单元包含硬件配置、服务配置和其他 99.9999% 的应用程序不需要查看的项目（例如，它包含当前的即插即用设备列表）。如果您从那里需要任何东西，大部分信息都可以通过其他地方支持的 API 获得。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-09T23:44:09.250

是的，您应该能够在没有管理员权限的情况下写入 HKEY_CURRENT_USER 下的任何位置。但这实际上是一个私有存储，这台机器上的其他用户都无法访问，因此您不能在其中放置任何共享配置。

# database - 如何查找所有数据库引用

> ID：53136
> 
> 赞同：1
> 
> 时间：2008-09-09T23:30:09.923
> 
> 标签：database, db2

在试图找出[这个问题](https://stackoverflow.com/questions/52981/cannot-delete-from-the-database)（仍然没有解决，我仍然不知道发生了什么）时，我想知道是否可能是对相关表的外部引用导致了问题。例如，触发器或视图或其他类似的东西。

有没有一种简单的方法可以找到对给定数据库表的所有引用？包括所有视图、触发器、约束或任何东西，最好来自命令行，也最好不使用 3rd 方工具（我们使用的是 db2）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T01:34:34.010

哇，我没想到，但似乎有.. 好 ole DB2。

顺便说一下，我发现 publib db2 文档视图非常方便：

[http://publib.boulder.ibm.com/infocenter/db2luw/v8//index.jsp](http://publib.boulder.ibm.com/infocenter/db2luw/v8//index.jsp)

我刚刚在其中找到了“SYSCAT.TABDEP”目录视图，它似乎或多或少地包含了您所要求的内容。我怀疑对于那里未涵盖的任何内容，您都必须浏览其余的庞大的 syscat 表。（不幸的是，我似乎无法将您链接到 SYSCAT.TABDEP 本身的确切页面，但搜索工具应该很容易引导您找到它）。

如今，大多数数据库都有一组表，其中包含有关您的实际模式表布局的数据，这对于这类事情非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T01:38:17.543

您可以编写查询搜索信息架构视图（定义列）以在所有视图、触发器、过程等中查找表。但不确定 FK 和索引。

# code-snippets - 您使用什么来捕获网页、图表/图片和代码片段以供以后参考？

> ID：53139
> 
> 赞同：0
> 
> 时间：2008-09-09T23:30:52.357
> 
> 标签：code-snippets

您使用什么来捕获网页、图表/图片和代码片段以供以后参考？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-09T23:34:23.613

印象笔记[http://www.evernote.com](http://www.evernote.com)和好吃的[http://www.delicious.com](http://www.delicious.com)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-09T23:49:25.853

*   [印象笔记](http://evernote.com/)
*   [Notepad2](http://www.flos-freeware.ch/notepad2.html)的剪贴板功能（*Notepad2.exe /c*作为[Launchy](http://launchy.net/)中的链接）
*   [Windows 剪辑](http://www.windowclippings.com/)或[PrintKey](http://www.webtree.ca/newlife/printkey_info.htm)
*   Firefox 扩展[页面保护程序](http://pearlcrescent.com/products/pagesaver/)
*   [可口的](http://delicious.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T00:45:48.463

微软 OneNote。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T08:18:29.520

这是我对[类似问题](https://stackoverflow.com/questions/78756/what-do-you-use-to-keep-notes-as-a-developer#80842)的回答：

OneNote 与平板电脑的结合真是太棒了！起初我有点怀疑。我使用了试用版，然后就忘记了。一年后，我收集了一堆乱七八糟的文件、与项目相关的电子邮件、笔记本和纸屑，这些都散落在我的生活中。我回到 OneNote，我的所有问题都消失了。一些亮点：

*   一切都是可搜索的。字符识别足够好，可以搜索到我的鸡抓痕会议记录。图像中的文本是可搜索的。
*   OneNote 与 Outlook 同步，因此查找会议笔记轻而易举。
*   我现在将所有文件嵌入到 OneNote 中——pdf、电子表格、word 文档、图像、网络剪报。
*   OneNote 不断保存所有更改，因此结合预定的自动备份，一切都在一个地方并且是安全的。
*   我还没有尝试过一些内置的协作工具，但它们看起来很有用。

这是非常**值得**的价格。它使您可以开始一个项目，并避免花费所有时间来决定如何组织事物。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T00:39:11.070

我发现[谷歌笔记本](http://www.google.com/notebook)非常适合通过代码片段和[谷歌书签](http://www.google.com/bookmarks)驱动，尤其是在与谷歌工具栏一起使用时，用于网页。

这些工具的好处是它们可以从网络上的任何电脑上获得，尽管建议使用标签来很好地使用语义组织。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T00:50:36.470

我只有一个 emacs 实例在我的家用机器上运行，在屏幕下。无论我在哪里（并且有网络），我都可以远程连接到它。我把所有有用的网址、生日礼物的想法、未来的日期、代码片段、文档的想法等都贴在那里。

我很少有需要捕捉的涂鸦/图表，如果需要，我倾向于在我的文件中以 ascii 格式绘制它们。

我必须承认，如果我在某个地方没有网络/wifi，我会有点卡住，但这种情况很少见。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-09T23:48:14.967

[Zotero](http://www.zotero.org)是一个不错的 Firefox 插件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T03:13:36.643

[SnagIt](http://www.techsmith.com/screen-capture.asp) 捕获您可能想要的所有内容，并让您对其进行注释。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T08:13:01.683

[Google Notebook](http://www.google.com/notebook/)是非常方便的工具。您可以在不离开浏览器选项卡的情况下剪辑和保存网页的任何部分。Notebook 插件会自动将它们作为单独的笔记保存在您的笔记本中，并将链接保留回原始网页。您可以稍后通过在笔记本之间移动和/或标记它们来组织您的剪报。非常适合代码片段和参考。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-16T16:35:42.967

这有点原始，但我一直在使用 tiddlywiki（自包含的单文件 wiki）[http://www.tiddlywiki.com/](http://www.tiddlywiki.com/)，它适用于基本文本和标记。我将它与一个插件结合使用，以将其与 Outlook 的笔记 ( [http://syncoutlooknotes.tiddlyspot.com/#SyncOutlookNotes](http://syncoutlooknotes.tiddlyspot.com/#SyncOutlookNotes) ) 同步，这样我就可以使用标准的 Outlook-blackberry 同步机制将它同步到我的黑莓手机。这有一个显着的优势，我可以查看我的笔记，甚至可以在我外出时写新笔记需要它。

我更喜欢使用像 Onenote 这样更高级的东西，但是能够用我的小黑莓记笔记已经证明是一个显着的优势。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-09T23:47:02.053

我更喜欢用[好的旧网址](http://del.icio.us)来获得美味

除此之外，当我想在磁盘上保存一些东西时，我会在 firefox 中使用[Scrapbook 扩展。](http://amb.vis.ne.jp/mozilla/scrapbook/)可以在保存之前标记页面，对其进行编辑并删除那些愚蠢的广告。

我还有一个[Wiki](http://stickwiki.sourceforge.net/)，我随身携带在一个 usbkey 上，用于在我四处旅行时应该发送给其他客户的代码片段

大多数情况下，我的代码片段嵌入到我使用相同 USB 密钥的项目中，这使我可以立即向客户演示一些技术，并根据演示而不是代码列表获得他的建议......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-09T23:51:49.250

对于屏幕截图，我混合使用 ScrapBook 和 ScreenGrab。它们都是 Firefox 插件，当您需要获取页面截图进行编辑时，它们非常棒。非常适合咨询。

[https://addons.mozilla.org/en-US/firefox/addon/427](https://addons.mozilla.org/en-US/firefox/addon/427)
[https://addons.mozilla.org/en-US/firefox/addon/1146](https://addons.mozilla.org/en-US/firefox/addon/1146)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-10T01:47:31.203

[Firefox 的美味书签](https://addons.mozilla.org/en-US/firefox/addon/3615)扩展

# c - 查找 C 中的最高位

> ID：53161
> 
> 赞同：44
> 
> 时间：2008-09-09T23:44:33.917
> 
> 标签：c

我所追求的是我可以输入一个数字的东西，它会返回最高位。我相信有一个简单的方法。下面是一个示例输出（左边是输入）

```
1 -> 1
2 -> 2
3 -> 2
4 -> 4
5 -> 4
6 -> 4
7 -> 4
8 -> 8
9 -> 8
...
63 -> 32
```

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2008-09-09T23:54:12.580

来自黑客的喜悦：

```
int hibit(unsigned int n) {
    n |= (n >>  1);
    n |= (n >>  2);
    n |= (n >>  4);
    n |= (n >>  8);
    n |= (n >> 16);
    return n - (n >> 1);
} 
```

此版本适用于 32 位整数，但逻辑可以扩展到 64 位或更高位。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-12-29T21:02:33.460

`fls`在许多体系结构上都达到了硬件指令的最低点。我怀疑这可能是最简单、最快的方法。

```
1<<(fls(input)-1) 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-09-09T23:49:02.267

这应该可以解决问题。

```
int hob (int num)
{
    if (!num)
        return 0;

    int ret = 1;

    while (num >>= 1)
        ret <<= 1;

    return ret;
} 
```

滚刀（1234）返回 1024
滚刀（1024）返回 1024
滚刀（1023）返回 512

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-09-10T06:17:48.837

像混淆代码？试试这个：

1 << (int) log2(x)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-02-03T18:35:33.603

这个聚会有点晚了，但我找到的最简单的解决方案，考虑到现代的 GCC 作为编译器，很简单：

```
static inline int_t get_msb32 (register unsigned int val)
{
  return 32 - __builtin_clz(val);
}

static inline int get_msb64 (register unsigned long long val)
{
  return 64 - __builtin_clzll(val);
} 
```

它甚至是相对可移植的（至少它可以在任何 GCC 平台上工作）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-09T23:48:42.580

不断删除低位出现在脑海中......

```
int highest_order_bit( int x )
{
    int y = x;
    do { 
        x = y;
        y = x & (x-1); //remove low order bit
    }
    while( y != 0 );
    return x;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-10T00:35:57.397

linux 内核有许多像这样的方便的 bitop，以最有效的方式编码，适用于许多体系结构。您可以在[include/asm-generic/bitops/fls.h](http://lxr.linux.no/linux+v2.6.26.5/include/asm-generic/bitops/fls.h) （和朋友）中找到通用版本，但如果速度至关重要，并且可移植性很重要，请参见[include/asm-x86/bitops.h](http://lxr.linux.no/linux+v2.6.26.5/include/asm-x86/bitops.h)以了解使用内联汇编的定义不是。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-10T01:43:08.187

一种快速的方法是通过查找表。对于 32 位输入和 8 位查找表，in 只需要 4 次迭代：

```
int highest_order_bit(int x)
{
    static const int msb_lut[256] =
        {
            0, 0, 1, 1, 2, 2, 2, 2, // 0000_0000 - 0000_0111
            3, 3, 3, 3, 3, 3, 3, 3, // 0000_1000 - 0000_1111
            4, 4, 4, 4, 4, 4, 4, 4, // 0001_0000 - 0001_0111
            4, 4, 4, 4, 4, 4, 4, 4, // 0001_1000 - 0001_1111
            5, 5, 5, 5, 5, 5, 5, 5, // 0010_0000 - 0010_0111
            5, 5, 5, 5, 5, 5, 5, 5, // 0010_1000 - 0010_1111
            5, 5, 5, 5, 5, 5, 5, 5, // 0011_0000 - 0011_0111
            5, 5, 5, 5, 5, 5, 5, 5, // 0011_1000 - 0011_1111

            6, 6, 6, 6, 6, 6, 6, 6, // 0100_0000 - 0100_0111
            6, 6, 6, 6, 6, 6, 6, 6, // 0100_1000 - 0100_1111
            6, 6, 6, 6, 6, 6, 6, 6, // 0101_0000 - 0101_0111
            6, 6, 6, 6, 6, 6, 6, 6, // 0101_1000 - 0101_1111
            6, 6, 6, 6, 6, 6, 6, 6, // 0110_0000 - 0110_0111
            6, 6, 6, 6, 6, 6, 6, 6, // 0110_1000 - 0110_1111
            6, 6, 6, 6, 6, 6, 6, 6, // 0111_0000 - 0111_0111
            6, 6, 6, 6, 6, 6, 6, 6, // 0111_1000 - 0111_1111

            7, 7, 7, 7, 7, 7, 7, 7, // 1000_0000 - 1000_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1000_1000 - 1000_1111
            7, 7, 7, 7, 7, 7, 7, 7, // 1001_0000 - 1001_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1001_1000 - 1001_1111
            7, 7, 7, 7, 7, 7, 7, 7, // 1010_0000 - 1010_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1010_1000 - 1010_1111
            7, 7, 7, 7, 7, 7, 7, 7, // 1011_0000 - 1011_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1011_1000 - 1011_1111

            7, 7, 7, 7, 7, 7, 7, 7, // 1100_0000 - 1100_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1100_1000 - 1100_1111
            7, 7, 7, 7, 7, 7, 7, 7, // 1101_0000 - 1101_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1101_1000 - 1101_1111
            7, 7, 7, 7, 7, 7, 7, 7, // 1110_0000 - 1110_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1110_1000 - 1110_1111
            7, 7, 7, 7, 7, 7, 7, 7, // 1111_0000 - 1111_0111
            7, 7, 7, 7, 7, 7, 7, 7, // 1111_1000 - 1111_1111
        };

    int byte;
    int byte_cnt;

    for (byte_cnt = 3; byte_cnt >= 0; byte_cnt--)
    {
        byte = (x >> (byte_cnt * 8)) & 0xff;
        if (byte != 0)
        {
            return msb_lut[byte] + (byte_cnt * 8);
        }
    }

    return -1;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-09-21T15:04:57.267

这可以通过现有的库调用轻松解决。

```
int highestBit(int v){
  return fls(v) << 1;
} 
```

Linux 手册页提供了有关此函数及其对应输入类型的更多详细信息。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-06-03T11:57:12.573

如果您不需要可移植的解决方案并且您的代码在 x86 兼容的 CPU 上执行，您可以使用 Microsoft Visual C/C++ 编译器提供的 _BitScanReverse() 内部函数。它映射到返回最高位集的 BSR CPU 指令。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-09-11T19:10:14.533

```
// Note doesn't cover the case of 0 (0 returns 1)
inline unsigned int hibit( unsigned int x )
{
  unsigned int log2Val = 0 ;
  while( x>>=1 ) log2Val++;  // eg x=63 (111111), log2Val=5
  return 1 << log2Val ; // finds 2^5=32
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-06-22T07:06:49.860

我非常喜欢的最佳算法是：

```
unsigned hibit(unsigned n) {
    n |= (n >>  1u);
    n |= (n >>  2u);
    n |= (n >>  4u);
    n |= (n >>  8u);
    n |= (n >> 16u);
    return n - (n >> 1);
} 
```

它很容易像这样扩展为 uint64_t ：

```
uint64_t hibit(uint64_t n) {
    n |= (n >>  1u);
    n |= (n >>  2u);
    n |= (n >>  4u);
    n |= (n >>  8u);
    n |= (n >> 16u);
    n |= (n >> 32u);
    return n - (n >> 1);
} 
```

甚至到 __int128

```
__int128 hibit(__int128 n) {
    n |= (n >>  1u);
    n |= (n >>  2u);
    n |= (n >>  4u);
    n |= (n >>  8u);
    n |= (n >> 16u);
    n |= (n >> 32u);
    n |= (n >> 64u);
    return n - (n >> 1);
} 
```

此外，跨平台解决方案独立于使用编译器

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-05-09T18:54:11.340

我想出的一个绝妙的解决方案是对位进行二进制搜索。

```
uint64_t highestBit(uint64_t a, uint64_t bit_min, uint64_t bit_max, uint16_t bit_shift){
    if(a == 0) return 0;
    if(bit_min >= bit_max){
        if((a & bit_min) != 0)
            return bit_min;
        return 0;
    }
    uint64_t bit_mid = bit_max >> bit_shift;
    bit_shift >>= 1;
    if((a >= bit_mid) && (a < (bit_mid << 1)))
        return bit_mid;
    else if(a > bit_mid)
        return highestBit(a, bit_mid, bit_max, bit_shift);
    else
        return highestBit(a, bit_min, bit_mid, bit_shift);

} 
```

位最大值是 2 的最高幂，因此对于 64 位数字，它将是 2^63。位移应初始化为位数的一半，因此对于 64 位，它将是 32。

# python - 如何在 Python 中进行换行（续行）？

> ID：53162
> 
> 赞同：1266
> 
> 时间：2008-09-09T23:45:30.293
> 
> 标签：python, syntax, line-breaks, long-lines

我有一长行代码，我想在多行中分解。我用什么，语法是什么？

例如，添加一堆字符串，

```
e = 'a' + 'b' + 'c' + 'd' 
```

并将其分为两行，如下所示：

```
e = 'a' + 'b' +
    'c' + 'd' 
```

* * *

## 回答 #1

> 赞同：1425
> 
> 时间：2008-09-09T23:52:05.643

线是什么？你可以在下一行有参数没有任何问题：

```
a = dostuff(blahblah1, blahblah2, blahblah3, blahblah4, blahblah5, 
            blahblah6, blahblah7) 
```

否则，您可以执行以下操作：

```
if (a == True and
    b == False): 
```

或显式换行：

```
if a == True and \
   b == False: 
```

查看[样式指南](http://www.python.org/dev/peps/pep-0008/)以获取更多信息。

使用括号，您的示例可以写成多行：

```
a = ('1' + '2' + '3' +
    '4' + '5') 
```

使用显式换行符可以获得相同的效果：

```
a = '1' + '2' + '3' + \
    '4' + '5' 
```

请注意，样式指南说最好使用带括号的隐式延续，但在这种特殊情况下，仅在表达式周围添加括号可能是错误的方法。

* * *

## 回答 #2

> 赞同：272
> 
> 时间：2008-09-10T00:06:39.900

来自*[PEP 8——Python 代码风格指南](http://www.python.org/dev/peps/pep-0008/)*：

> **包装长行的首选方法是在括号、方括号和大括号内使用 Python 的隐含行继续。**通过将表达式括在括号中，可以将长行分成多行。这些应该优先使用反斜杠来继续行。

> 反斜杠有时可能仍然合适。例如，长的、多个 with 语句不能使用隐式延续，所以反斜杠是可以接受的：

> ```
> with open('/path/to/some/file/you/want/to/read') as file_1, \
>      open('/path/to/some/file/being/written', 'w') as file_2:
>      file_2.write(file_1.read()) 
> ```
> 
> 另一种情况是断言语句。

> 确保适当缩进续行。打破二元运算符的首选位置是**在**运算符之后，而不是在它之前。一些例子：

> ```
> class Rectangle(Blob): 
> ```

```
 def __init__(self, width, height,
                 color='black', emphasis=None, highlight=0):
        if (width == 0 and height == 0 and
            color == 'red' and emphasis == 'strong' or
            highlight > 100):
            raise ValueError("sorry, you lose")
        if width == 0 and height == 0 and (color == 'red' or
                                           emphasis is None):
            raise ValueError("I don't think so -- values are %s, %s" %
                             (width, height))
        Blob.__init__(self, width, height,
                      color, emphasis, highlight)file_2.write(file_1.read()) 
```

PEP8 现在推荐数学家及其出版商使用的*相反约定（用于打破二元运算）以提高可读性。*

**Donald Knuth 在二元运算符之前**打破的风格使运算符垂直对齐，从而在确定添加和减去哪些项目时减少了眼睛的工作量。

来自[PEP8：*应该在二元运算符之前还是之后换行？*](http://legacy.python.org/dev/peps/pep-0008/#should-a-line-break-before-or-after-a-binary-operator)：

> Donald Knuth 在他的计算机和排版系列中解释了传统规则：“虽然段落中的公式总是在二元运算和关系之后中断，但显示的公式总是在二元运算之前中断”[3]。

> 遵循数学的传统通常会产生更具可读性的代码：

> ```
> # Yes: easy to match operators with operands 
> ```

```
income = (gross_wages
          + taxable_interest
          + (dividends - qualified_dividends)
          - ira_deduction
          - student_loan_interest) 
```

> 在 Python 代码中，允许在二元运算符之前或之后中断，只要约定在本地是一致的。对于新代码，建议使用 Knuth 的样式。

[3]：Donald Knuth 的 The TeXBook，第 195 和 196 页

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2008-09-15T06:28:30.237

使用反斜杠结束一行的危险在于，如果在反斜杠之后添加空格（当然，这很难看到），则反斜杠不再像您想象的那样做。

有关更多信息，请参阅 Python Idioms 和 Anti-Idioms（适用于[Python 2](https://docs.python.org/2/howto/doanddont.html#using-backslash-to-continue-statements)或[Python 3](https://docs.python.org/3.1/howto/doanddont.html#using-backslash-to-continue-statements)）。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2008-09-09T23:48:30.740

`\`在行尾放置 a或将语句括在 parens 中`( .. )`。来自[IBM](http://www.ibm.com/developerworks/opensource/library/os-python5/)：

```
b = ((i1 < 20) and
     (i2 < 30) and
     (i3 < 40)) 
```

或者

```
b = (i1 < 20) and \
    (i2 < 30) and \
    (i3 < 40) 
```

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-09-21T12:20:08.193

您可以在括号和大括号之间换行。此外，您可以将反斜杠字符附加`\`到一行以显式中断它：

```
x = (tuples_first_value,
     second_value)
y = 1 + \
    2 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2008-09-09T23:53:17.153

> 从马的嘴里：[显式线加入](https://docs.python.org/2.5/ref/explicit-joining.html)
> 
> 两个或多个物理行可以使用反斜杠字符 ( `\`) 连接成逻辑行，如下所示：当物理行以不属于字符串文字或注释一部分的反斜杠结尾时，它与以下内容连接形成单个逻辑行，删除反斜杠和以下行尾字符。例如：
> 
> ```
> if 1900 < year < 2100 and 1 <= month <= 12 \
>    and 1 <= day <= 31 and 0 <= hour < 24 \
>    and 0 <= minute < 60 and 0 <= second < 60:   # Looks like a valid date
>         return 1 
> ```
> 
> 以反斜杠结尾的行不能带有注释。反斜杠不会继续评论。除字符串文字外，反斜杠不会继续标记（即，字符串文字以外的标记不能使用反斜杠跨物理行拆分）。反斜杠在字符串文字之外的其他地方是非法的。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2020-03-25T07:57:38.280

如果你想因为一个长的文字字符串而中断你的行，你可以将该字符串分成几部分：

```
long_string = "a very long string"
print("a very long string") 
```

将被替换为

```
long_string = (
  "a "
  "very "
  "long "
  "string"
)
print(
  "a "
  "very "
  "long "
  "string"
) 
```

两个打印语句的输出：

`a very long string`

注意做作中的括号。

另请注意，将文字字符串分成几部分允许仅在部分字符串上使用文字前缀并混合分隔符：

```
s = (
  '''2+2='''
  f"{2+2}"
) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2020-11-12T22:31:45.720

`obj.method()`也可以在多行中中断对方法 ( ) 的调用。

将命令括在括号“ `()`”中并跨越多行：

```
> res = (some_object
         .apply(args)
         .filter()
         .values) 
```

例如，我发现它在链式调用 Pandas/Holoviews 对象方法时很有用。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-11-02T11:22:00.137

它可能不是 Pythonic 的方式，但我通常使用带有 join 函数的列表来编写长字符串，例如 SQL 查询：

```
query = " ".join([
    'SELECT * FROM "TableName"',
    'WHERE "SomeColumn1"=VALUE',
    'ORDER BY "SomeColumn2"',
    'LIMIT 5;'
]) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-12-06T18:45:17.623

摘自 The Hitchhiker's Guide to Python ( [Line Continuation](https://docs.python-guide.org/writing/style/#line-continuations) ):

> 当逻辑代码行长于可接受的限制时，您需要将其拆分为多个物理行。如果行的最后一个字符是反斜杠，Python 解释器将连接连续的行。这在某些情况下很有用，但通常应该避免，因为它很脆弱：在反斜杠之后添加到行尾的空格会破坏代码并可能产生意想不到的结果。
> 
> **更好的解决方案是在元素周围使用括号。**在行尾留下一个未闭合的括号，Python 解释器将加入下一行，直到括号闭合。同样的行为也适用于花括号和方括号。
> 
> **但是**，通常情况下，必须拆分长逻辑行表明您正在尝试同时做太多事情，这可能会妨碍可读性。

话虽如此，这里有一个考虑多个导入的示例（当超出[行限制时，在 PEP-8 上定义](https://www.python.org/dev/peps/pep-0008/#maximum-line-length)），通常也适用于字符串：

```
from app import (
    app, abort, make_response, redirect, render_template, request, session
) 
```

# frame-rate - 游戏中的固定帧速率与可变帧速率：什么是最好的，什么时候最好？

> ID：53164
> 
> 赞同：8
> 
> 时间：2008-09-09T23:45:56.330
> 
> 标签：frame-rate

在开发游戏一段时间后，我接触到了可变帧率（您可以计算自上次滴答以来经过了多少时间并相应地更新演员移动）和固定帧率（您可以计算出多少时间）已经过去并选择勾选固定的时间或睡眠直到下一个窗口到来）。

哪种方法最适合特定情况？请考虑：

*   迎合不同的系统规格；
*   易于开发/维护；
*   易于移植；
*   最后的表现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-12T16:57:11.000

我倾向于可变帧率模型，但在内部，一些系统是在固定的时间步长上打勾的。使用时间累加器很容易做到这一点。物理系统是一个最好在固定时间步长上运行的系统，必要时每帧勾选多次以避免稳定性损失并保持模拟流畅。

一段代码来演示累加器的使用：

```
const float STEP = 60.f / 1000.f;
float accumulator = 0.f;

void Update(float delta)
{
    accumulator += delta;

    while(accumulator > STEP)
    {
        Simulate(STEP);
        accumulator -= STEP;
    }
} 
```

这无论如何都不是完美的，但提出了基本思想 - 有很多方法可以改进这个模型。显然，当输入帧速率非常慢时，需要解决一些问题。然而，最大的优势是，无论增量有多快或多慢，模拟在“玩家时间”中都以平稳的速度移动 - 这是用户会感知到任何问题的地方。

一般来说，我不会进入图形和音频方面，但我认为它们不会像物理、输入和网络代码那样受到影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T00:17:01.577

似乎大多数 3D 开发人员更喜欢可变 FPS：Quake、Doom 和 Unreal 引擎都根据系统性能进行放大和缩小。

*   至少你必须补偿太快的帧速率（不像 90 年代运行的 80 年代游戏，太快了）
*   无论如何，您的主循环应该由时间步长参数化，只要它不是太长，像 RK4 这样的体面的积分器应该可以顺利处理物理某些类型的动画（关键帧精灵）可能很难参数化。网络代码也需要很智能，例如避免拥有更快机器的玩家发射太多子弹，但无论如何都需要进行这种节流以补偿延迟（动画参数化也有助于隐藏网络延迟）
*   需要针对每个平台修改计时代码，但这是一个小的本地化更改（尽管有些系统很难精确计时，Windows、Mac、Linux 似乎还可以）
*   可变帧速率可实现最高性能。固定帧速率允许一致的性能，但永远不会在所有系统上达到最大值（这似乎是任何严肃游戏的阻碍）

如果您正在编写性能很重要的网络 3D 游戏，我不得不说，咬紧牙关并实现可变帧速率。

如果它是一款 2D 益智游戏，您可能可以使用固定的帧速率，可能会为超慢速计算机和未来几年的模型稍微参数化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T00:26:54.093

作为用户，我希望更频繁地看到的一个选项是当帧速率在一定范围之外变化时动态改变细节水平（在广义上，不仅仅是技术意义上）。如果您以 5FPS 进行渲染，请关闭凹凸贴图。如果您以 90FPS 进行渲染，请稍微增加一些花里胡哨的功能，并为用户提供一些更漂亮的图像来浪费他们的 CPU 和 GPU。

如果操作正确，用户应该在游戏中获得最佳体验，而无需进入设置屏幕并自行调整，作为关卡设计师，您应该不必担心在不同场景中保持多边形数量相同.

当然，我是作为一个游戏用户说的，而不是一个严肃的人——我从来没有尝试过写一个不平凡的游戏。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-16T18:10:05.253

我遇到的可变长度帧时间的主要问题是浮点精度，可变帧时间会让你惊讶于它们如何咬你。

例如，如果您将帧时间 * 速度添加到某个位置，并且帧时间变得非常小，并且位置较大，则您的对象可能会减慢或停止移动，因为您的所有增量都因精度而丢失。您可以使用单独的错误累加器来弥补这一点，但这很痛苦。

固定（或至少帧长度的下限）帧时间允许您控制需要考虑多少 FP 错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T00:09:38.160

我的经验仅限于一些简单的游戏（使用 SDL 和 C++ 开发），但我发现实现静态帧速率非常容易。您在玩 2d 或 3d 游戏吗？我会假设更复杂的 3d 环境将从可变帧速率中受益更多，并且难度会更大。

# indexing - 磁盘子串索引

> ID：53172
> 
> 赞同：0
> 
> 时间：2008-09-09T23:48:26.277
> 
> 标签：indexing, substring, on-disk

我有一个要索引的文件（具体来说是 fasta 文件），以便我可以快速找到文件中的任何子字符串，然后在原始 fasta 文件中找到该位置。

在许多情况下，使用 Trie 或子字符串数组很容易做到这一点，不幸的是，我需要索引的字符串是 800+ MB，这意味着在内存中执行它们是不可接受的，所以我正在寻找一种合理的方法来创建它磁盘上的索引，内存使用量最少。

（编辑澄清）

我只对蛋白质的标题感兴趣，所以对于我感兴趣的最大数据库，这是大约 800 MB 的文本。

我希望能够根据输入字符串在 O(N) 时间内找到确切的子字符串。这必须在 32 位机器上可用，因为它将被运送给随机的人，他们预计不会拥有 64 位机器。

我希望能够针对一行中的任何断字进行索引，直到行尾（尽管行可能有几 MB 长）。

希望这可以阐明需要什么以及为什么给出的当前解决方案没有启发性。

我还应该补充一点，这需要在 java 中完成，并且必须在各种操作系统的客户端计算机上完成，所以我不能使用任何特定于操作系统的解决方案，它必须是一个编程解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T07:03:43.627

在某些语言中，程序员可以访问操作系统提供的***“直接字节数组”***或***“[内存映射](http://en.wikipedia.org/wiki/Memory-mapped_file)”***。在 java 中，我们有**[java.nio.MappedByteBuffer](http://java.sun.com/j2se/1.4.2/docs/api/java/nio/MappedByteBuffer.html)**。这允许人们像处理内存中的字节数组一样处理数据，而实际上它在磁盘上。可以使用的文件大小仅受操作系统的虚拟内存能力限制，对于 32 位计算机，通常约为 <4GB。64位？理论上 16 艾字节（172 亿 GB），但我认为现代 CPU 仅限于 40 位（1TB）或 48 位（128TB）地址空间。

这将使您轻松处理一个大文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-13T13:25:57.317

[FASTA 文件格式](http://en.wikipedia.org/wiki/Fasta_format)非常稀疏。我要做的第一件事是生成一个紧凑的二进制格式，并为其编制索引——*它*应该是当前文件大小的 20-30%，并且编码/解码数据的过程应该足够快（即使是 4GB）这不会是一个问题。

此时，您的文件应该适合内存，即使在 32 位机器上也是如此。让操作系统对其进行分页，或者如果您想确定它全部在内存中，请制作一个 ramdisk。

请记住，内存仅为每 GB 30 美元左右（而且越来越便宜），因此如果您有 64 位操作系统，那么您甚至可以处理内存中的完整文件，而无需将其编码为更紧凑的格式。

祝你好运！

-亚当

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T00:02:25.823

我和几个同事谈过，他们只是在需要时使用 VIM/Grep 进行搜索。大多数时候，我不希望有人搜索这样的子字符串。

但我不明白为什么 MS 桌面搜索或聚光灯或谷歌的同等产品在这里不能帮助你。

我的建议是按基因或物种拆分文件，希望输入序列不会交错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-07T17:16:44.740

我不认为原始海报仍然存在这个问题，但是任何需要 FASTA 文件索引和子序列提取的人都应该查看 fastahack：http: [//github.com/ekg/fastahack](http://github.com/ekg/fastahack)

它使用索引文件来计算换行符和序列起始偏移量。生成索引后，您可以快速提取子序列；提取由 fseek64 驱动。

如果您的序列与海报的序列一样长，它将非常非常好地工作。但是，如果您的 FASTA 文件中有数千或数百万个序列（如短读测序或一些*从头*组装的输出的情况），您将需要使用另一种解决方案，例如磁盘支持的密钥-价值存储。

# .net - 提示输入数据库连接字符串

> ID：53178
> 
> 赞同：8
> 
> 时间：2008-09-09T23:51:03.027
> 
> 标签：.net, sql-server, database, connection-string

我想向用户提供数据库连接提示。我可以自己构建，但如果我可以使用其他人已经构建的东西（可能是 Windows 内置的东西或 Internet 上的免费库），那就太好了。有人知道如何在.Net 中做到这一点吗？

**编辑：**我发现了这个并认为它很有趣：[在 WinForm 应用程序中显示连接字符串提示](http://weblogs.asp.net/jgalloway/archive/2006/10/29/Showing-a-Connection-String-prompt-in-a-WinForm-application.aspx)。但这仅适用于 SQL Server 连接。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-09T23:56:59.797

您可能想尝试使用[SQL Server 管理对象](http://msdn.microsoft.com/en-us/magazine/cc163409.aspx)。这篇 MSDN 文章有一个很好的示例，用于提示和连接到 SQL 服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T00:01:19.180

ADO.NET 有方便的 ConnectionStringBuilder，它将构造和验证连接字符串。这至少可以消除一部分繁重的工作，允许您为输入创建一个简单的对话框。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-15T12:05:48.490

Microsoft 已在 Code Gallery 上发布了数据连接对话框的源代码。

这是[Yaohai 的博客文章，](http://blogs.msdn.com/b/vsdata/archive/2010/02/02/data-connection-dialog-source-code-is-released-on-code-gallery.aspx)其中包含更多信息，这里是[Code Gallery 上的 Data Connection Dialog 的主页](http://code.msdn.microsoft.com/Connection)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-14T12:39:02.570

我将[PropertyGrid 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.propertygrid.aspx)与[SqlConnectionStringBuilder 类](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder.aspx)组合在一个单独的对话框中，这对我来说非常有效[。](https://stackoverflow.com/questions/1103637/usercontrol-to-connect-to-a-sqlserver-database)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T00:02:30.720

我能想到的唯一“内置”连接字符串功能是在运行运行 SQL 脚本的 CMD 脚本（本质上是批处理文件）时出现的功能。但是我不确定它是否内置在 Visual Studio 中。

无论如何，制作一个真的很简单。如果您不希望用户能够输入直接的连接字符串，您可以将一个由四个文本框和一个复选框组成的组合在一起：

*   服务器
*   目录名称
*   用于集成安全或 SQL 身份验证的复选框
*   用户名
*   密码

相当微不足道，恕我直言。

# delphi - Delphi 2007 中的 HelpInsight 文档

> ID：53198
> 
> 赞同：9
> 
> 时间：2008-09-10T00:04:15.943
> 
> 标签：delphi, documentation, ndoc

我正在使用 D2007 并尝试使用 HelpInsight 功能（自 D2005 起提供）记录我的源代码。我主要对让 HelpInsight 工具提示正常工作感兴趣。从各种网上冲浪和实验中，我发现了以下内容：

1.  使用三斜杠 (///) 注释样式比其他记录的注释样式更有效。即： `{*! comment *}`和`{! comment }`
2.  注释必须在它们所针对的声明之前。在大多数情况下，这意味着将它们放在代码的接口部分。（明显的例外是不能从当前单元外部访问并因此在实现块中声明的类型和函数。）
3.  第一条评论不能针对函数。（即它必须是一个类型 - 或者至少看起来解析器必须在 HelpInsight 功能工作之前看到“type”关键字）

尽管遵循这些“规则”，但有时 Help-insight 只是找不到我写的评论。一个文件不会产生正确的 HelpInsight 工具提示，但如果我将此文件包含在不同的虚拟项目中，它就可以正常工作。

有没有人有其他让 HelpInsight 工作的指示/技巧？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T23:38:48.943

我发现了另一个警告（在我的情况下是“错误的”）

似乎**必须**将带有 HelpInsight 注释的单元显式添加到项目中。仅将单元放在编译项目时搜索的路径中是不够的。

换句话说，该单元必须包含在项目的 .dpr / .dproj 文件中。（使用项目|“添加到项目”菜单选项）

# windows - 如何在 Windows 中自动销毁子进程？

> ID：53208
> 
> 赞同：71
> 
> 时间：2008-09-10T00:13:35.560
> 
> 标签：windows, process

在 C++ Windows 应用程序中，我启动了几个长时间运行的子进程（目前我使用 CreateProcess(...) 来执行此操作。

**如果我的主进程崩溃**或关闭，我希望子进程自动关闭。

由于要求这需要对“父级”崩溃起作用，我相信这需要使用操作系统的某些 API/功能来完成。以便清理所有“子”进程。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-09-10T00:22:49.550

Windows API 支持称为“作业对象”的对象。以下代码将创建一个“作业”，该“作业”被配置为在主应用程序结束时（当其句柄被清理时）关闭所有进程。此代码应该只运行一次。：

```
HANDLE ghJob = CreateJobObject( NULL, NULL); // GLOBAL
if( ghJob == NULL)
{
    ::MessageBox( 0, "Could not create job object", "TEST", MB_OK);
}
else
{
    JOBOBJECT_EXTENDED_LIMIT_INFORMATION jeli = { 0 };

    // Configure all child processes associated with the job to terminate when the
    jeli.BasicLimitInformation.LimitFlags = JOB_OBJECT_LIMIT_KILL_ON_JOB_CLOSE;
    if( 0 == SetInformationJobObject( ghJob, JobObjectExtendedLimitInformation, &jeli, sizeof(jeli)))
    {
        ::MessageBox( 0, "Could not SetInformationJobObject", "TEST", MB_OK);
    }
} 
```

然后在创建每个子进程时，执行以下代码来启动每个子进程并将其添加到作业对象中：

```
STARTUPINFO info={sizeof(info)};
PROCESS_INFORMATION processInfo;

// Launch child process - example is notepad.exe
if (::CreateProcess( NULL, "notepad.exe", NULL, NULL, TRUE, 0, NULL, NULL, &info, &processInfo))
{
    ::MessageBox( 0, "CreateProcess succeeded.", "TEST", MB_OK);
    if(ghJob)
    {
        if(0 == AssignProcessToJobObject( ghJob, processInfo.hProcess))
        {
            ::MessageBox( 0, "Could not AssignProcessToObject", "TEST", MB_OK);
        }
    }

    // Can we free handles now? Not sure about this.
    //CloseHandle(processInfo.hProcess); 
    CloseHandle(processInfo.hThread);
} 
```

VISTA 注意：如果您在 vista 上使用 AssignProcessToObject() 遇到访问被拒绝问题，请参阅[AssignProcessToJobObject 在 Vista 上总是返回“访问被拒绝” 。](http://social.msdn.microsoft.com/Forums/en-US/windowssecurity/thread/71c9599e-a3d5-4b79-bfc1-1800565c5b8a)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-10T00:28:13.920

一个有点骇人听闻的解决方案是让父进程作为调试器附加到每个子进程（使用[DebugActiveProcess](http://msdn.microsoft.com/en-us/library/ms679295(VS.85).aspx)）。当调试器终止时，它的所有被调试进程也会终止。

更好的解决方案（假设您也编写了子进程）是让子进程监视父进程并在它消失时退出。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T06:24:54.967

Windows Job Objects 听起来是个不错的起点。作业对象的名称必须是众所周知的，或者传递给子对象（或继承句柄）。当父母死亡时，孩子需要得到通知，无论是通过失败的 IPC“心跳”还是只是父母进程句柄上的 WFMO/WFSO。那时任何子进程都可以使用 TermianteJobObject 来关闭整个组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T00:25:40.853

您可以保持单独的看门狗进程运行。它的唯一任务是观察当前进程空间以发现您描述的情况。它甚至可以在崩溃后重新启动原始应用程序或为用户提供不同的选项、收集调试信息等。只要尽量保持简单，这样您就不需要第二个看门狗来观看第一个看门狗。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-19T12:54:29.870

您可以在创建进程之前将作业分配给父进程：

```
static HANDLE hjob_kill_on_job_close=INVALID_HANDLE_VALUE;
void init(){
    hjob_kill_on_job_close = CreateJobObject(NULL, NULL);
    if (hjob_kill_on_job_close){
        JOBOBJECT_EXTENDED_LIMIT_INFORMATION jobli = { 0 };
        jobli.BasicLimitInformation.LimitFlags = JOB_OBJECT_LIMIT_KILL_ON_JOB_CLOSE;
        SetInformationJobObject(hjob_kill_on_job_close,
            JobObjectExtendedLimitInformation,
            &jobli, sizeof(jobli));
        AssignProcessToJobObject(hjob_kill_on_job_close, GetCurrentProcess());
    }
}
void deinit(){
    if (hjob_kill_on_job_close) {
        CloseHandle(hjob_kill_on_job_close);
    }
} 
```

`JOB_OBJECT_LIMIT_KILL_ON_JOB_CLOSE`当作业的最后一个句柄关闭时，导致与作业关联的所有进程终止。默认情况下，所有子进程都会自动分配给作业，除非您`CREATE_BREAKAWAY_FROM_JOB`在调用`CreateProcess`. 有关. [_](https://docs.microsoft.com/en-us/windows/win32/procthread/process-creation-flags) _`CREATE_BREAKAWAY_FROM_JOB`

您可以使用 Sysinternals 的流程资源管理器来确保将所有流程分配给作业。像这样： [![在此处输入图像描述](https://i.stack.imgur.com/DLERd.png)](https://i.stack.imgur.com/DLERd.png)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-10T00:19:50.493

您可能必须保留您启动的进程的列表，并在退出程序时将它们一一终止。我不确定在 C++ 中执行此操作的具体细节，但应该不难。困难的部分可能是确保在应用程序崩溃的情况下关闭子进程。.Net 能够添加一个函数，当发生未处理的异常时调用该函数。我不确定 C++ 是否提供相同的功能。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-10T00:34:11.003

您可以将每个进程封装在一个 C++ 对象中，并将它们的列表保存在全局范围内。析构函数可以关闭每个进程。如果程序正常退出但它崩溃了，这将正常工作，所有赌注都关闭了。

这是一个粗略的例子：

```
class myprocess
{
public:
    myprocess(HANDLE hProcess)
        : _hProcess(hProcess)
    { }

    ~myprocess()
    {
        TerminateProcess(_hProcess, 0);
    }

private:
    HANDLE _hProcess;
};

std::list<myprocess> allprocesses; 
```

然后每当你启动一个，调用 allprocessess.push_back(hProcess);

# asp.net - 是否有 ASP.NET 分页控件（不是 MVC）？

> ID：53220
> 
> 赞同：5
> 
> 时间：2008-09-10T00:29:07.990
> 
> 标签：asp.net, pagination

我有一个搜索结果页面，它基本上由一个包含内容的转发器组成。我需要的是一种对结果进行分页的方法。获得分页结果不是问题，我所追求的是一个 Web 控件，它将显示可用分页数据的列表，最好是通过提供结果数量和页面大小

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-10T00:42:34.773

中继器默认不这样做。

但是，GridView 可以。

就个人而言，我讨厌 GridViews，所以我写了一个 Paging/Sorting Repeater 控件。

基本步骤：

*   子类化中继器控件
*   向其添加私有 PagedDataSource
*   添加公共 PageSize 属性
*   覆盖 Control.DataBind
    *   将 Control.DataSource 存储在 PagedDataSource 中。
    *   将 Control.DataSource 绑定到 PagedDataSource
*   覆盖 Control.Render
    *   调用 Base.Render()
    *   呈现您的分页链接。

对于演练，您可以尝试以下链接：

[http://aspnet.4guysfromrolla.com/articles/081804-1.aspx](http://aspnet.4guysfromrolla.com/articles/081804-1.aspx)

# python - 从网页获取国际字符？

> ID：53224
> 
> 赞同：7
> 
> 时间：2008-09-10T00:30:42.697
> 
> 标签：python, html, parsing, unicode

我想使用简单的 python 正则表达式从足球（足球）网页上刮下一些信息。问题是，像第一小伙 ÄÄRITALO 这样的球员，以 ÄÄRITALO 的形式出现！
即 html 对特殊字符使用转义标记，例如 Ä

有没有一种简单的方法可以将 html 读入正确的 python 字符串？如果它是 XML/XHTML，它会很容易，解析器会这样做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-10T00:50:19.747

我会推荐[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)用于 HTML 抓取。您还需要告诉它将 HTML 实体转换为相应的 Unicode 字符，如下所示：

```
>>> from BeautifulSoup import BeautifulSoup    
>>> html = "<html>&#196;&#196;RITALO!</html>"
>>> soup = BeautifulSoup(html, convertEntities=BeautifulSoup.HTML_ENTITIES)
>>> print soup.contents[0].string
ÄÄRITALO! 
```

（如果标准[编解码器](http://docs.python.org/lib/module-codecs.html)模块为此包含一个编解码器会很好，这样您就可以做到， `"some_string".decode('html_entities')`但不幸的是它没有！）

**编辑：** 另一个解决方案：Python 开发人员 Fredrik Lundh（elementtree 的作者，除其他外）具有 在他的网站上[取消隐藏 HTML 实体的功能](http://docs.python.org/lib/module-codecs.html)，该功能适用​​于十进制、十六进制和命名实体（BeautifulSoup 不适用于十六进制的实体）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T00:48:19.893

尝试使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)。它应该可以解决问题，并为您提供格式良好的 DOM 以供使用。

[这个博客](http://channel3b.wordpress.com/2007/07/04/how-to-convert-html-entities-to-real-unicode-in-python/)条目似乎已经取得了一些成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T00:32:23.987

我自己没试过，你试过了吗

[http://zesty.ca/python/scrape.html](http://zesty.ca/python/scrape.html)？

它似乎有一个方法 htmldecode(text) 可以做你想做的事。

# python - 你如何检查一个python方法是否被绑定？

> ID：53225
> 
> 赞同：44
> 
> 时间：2008-09-10T00:31:11.463
> 
> 标签：python, python-datamodel

给定一个方法的引用，有没有办法检查该方法是否绑定到一个对象？您还可以访问它绑定到的实例吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-10T02:19:09.050

```
def isbound(method):
    return method.im_self is not None

def instance(bounded_method):
    return bounded_method.im_self 
```

[用户定义的方法：](http://docs.python.org/ref/types.html)

> 当通过从类中检索用户定义的函数对象来创建用户定义的方法对象时，它的 `im_self`属性是`None`并且方法对象被称为未绑定的。当通过其实例之一从类中检索用户定义的函数对象来创建一个时，它的 `im_self`属性是实例，并且方法对象被称为绑定。在任何一种情况下，新方法的 `im_class`属性都是从中进行检索的类，其`im_func`属性是原始函数对象。

在 Python [2.6 和 3.0](http://docs.python.org/dev/whatsnew/2.6.html)中：

> 实例方法对象具有包含该方法的对象和函数的新属性；的新同义词`im_self`is`__self__`和`im_func` 也可用作`__func__`. Python 2.6 仍支持旧名称，但在 3.0 中已不复存在。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-09-23T09:03:57.013

在 python 3 中，该`__self__`属性*仅*在绑定方法上设置。它没有设置为`None`普通函数（或未绑定的方法，它们只是 python 3 中的普通函数）。

使用这样的东西：

```
def is_bound(m):
    return hasattr(m, '__self__') 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-04-28T08:39:51.880

选择的答案几乎在所有情况下都有效。但是，当使用选择的答案检查方法是否绑定在装饰器中时，检查将失败。考虑这个示例装饰器和方法：

```
def my_decorator(*decorator_args, **decorator_kwargs):
    def decorate(f):
        print(hasattr(f, '__self__'))
        @wraps(f)
        def wrap(*args, **kwargs):
            return f(*args, **kwargs)
        return wrap
    return decorate

class test_class(object):
    @my_decorator()
    def test_method(self, *some_params):
        pass 
```

装饰器中的`print`语句将打印`False`。在这种情况下，我找不到任何其他方法，只能使用参数名称检查函数参数并查找名为`self`. 这也**不能**保证完美地工作，因为方法的第一个参数不是强制命名的`self`，可以有任何其他名称。

```
import inspect

def is_bounded(function):
    params = inspect.signature(function).parameters
    return params.get('self', None) is not None 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-10T00:42:13.167

[**im_self**属性](https://docs.python.org/2/reference/datamodel.html?highlight=im_self)（仅限 Python 2）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-13T14:26:54.573

适用于 Python 2 和 3 的解决方案很棘手。

使用 package [`six`](https://six.readthedocs.io/)，一种解决方案可能是：

```
def is_bound_method(f):
    """Whether f is a bound method"""
    try:
        return six.get_method_self(f) is not None
    except AttributeError:
        return False 
```

在 Python 2 中：

*   常规函数没有该`im_self`属性，因此`six.get_method_self()`会引发 an`AttributeError`并且这将返回`False`
*   未绑定的方法将`im_self`属性设置为，`None`因此这将返回`False`
*   绑定方法将`im_self`属性设置为 non-`None`所以这将返回`True`

在 Python 3 中：

*   常规函数没有该`__self__`属性，因此`six.get_method_self()`会引发 an`AttributeError`并且这将返回`False`
*   未绑定的方法与常规函数相同，因此这将返回`False`
*   绑定方法将`__self__`设置属性（设置为 non- `None`），因此这将返回`True`

# windows - 如何将 Windows GUI 应用程序作为服务运行？

> ID：53232
> 
> 赞同：36
> 
> 时间：2008-09-10T00:37:52.820
> 
> 标签：windows, user-interface, windows-services, legacy

我有一个应该作为服务实现的现有 GUI 应用程序。基本上，我需要能够远程登录和注销 Windows 2003 服务器，并且仍然保持该程序运行。

这甚至可能吗？

编辑：这里进一步细化......我没有来源，这不是我的应用程序。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-10T02:42:24.330

Windows 服务不能有 GUI，因此您需要摆脱 GUI 或将您的应用程序分成两部分 - 一个没有 UI 的服务和一个“控制器”应用程序。如果您有源代码，将非 GUI 代码转换为服务很容易 - Visual Studio 有一个“Windows 服务”项目类型可以为您处理包装，并且有一个简单的演练向您展示如何创建一个负责安装的部署项目。

如果您选择第二条路线并且需要将一些原始 GUI 代码放入控制器中，则控制器和服务可以通过 WCF、.NET Remoting 或使用您自己定义的协议的普通套接字连接进行通信。如果您使用 Remoting，请务必使用“块状”接口，以尽可能少的方法调用来传输数据 - 每个调用都有相当多的开销。

如果 UI 相当简单，您也许可以不使用配置文件作为输入和日志文件，或者使用 Windows 事件日志作为输出。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-10T11:31:58.957

有没有人使用过第三方产品，例如：[Always Up](http://www.coretechnologies.com/products/AlwaysUp/)？

似乎做我需要的。这是在我需要的登录/注销周期中继续运行的能力。并且能够忽略它是一个 GUI 应用程序并运行它。

他们必须手动链接到 exe 并调用 WinMain 或其他东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-10T00:40:58.647

您可以将其包装成[srvany](http://support.microsoft.com/kb/137890)，尽管您可能需要为其分配一个实际的用户帐户（而不是 LocalService 或类似的）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-28T21:04:22.467

您真的需要它作为服务运行还是只需要它在未连接时保持运行？如果是后者，您可以断开连接而不是注销，应用程序将继续运行。该选项应该在选择关闭后的下拉列表中，或者您可以调用 tsdiscon.exe。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-04T13:41:55.763

我对[winsw](https://github.com/kohsuke/winsw)有很好的经验。我能够很容易地将我的批处理文件转换为使用它的服务。

[根据这个答案](https://stackoverflow.com/questions/10061191/how-to-add-nginx-exe-as-windows-system-service-like-apache)，我也将它用于 nginx 。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-11T20:23:03.727

如果您创建服务会发生什么。该服务被配置为与桌面交互。将其配置为运行某个用户并自动启动。来自此其他应用程序上的服务 CreateProcess。我想这很快就可以尝试使用 C#（如果我记得的话，C/C++ 有很多代码甚至可以成为一项服务）。那行得通吗？？

但！

我的第一个想法是在服务器级虚拟主机（如 Virtual Server、HyperV、VMWare）中创建虚拟计算机。这些虚拟机将作为服务运行（或 Hyper V 所做的任何事情）。虚拟机将始终运行 - 无论登录和注销。

让这台虚拟计算机自动登录到 Windows（TweakUI 可以设置），然后使用 Startup 文件夹的快捷方式启动 GUI 应用程序。你甚至可以使用程序的 GUI 远程桌面进入它（我敢打赌 Always Up 做不到）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T01:34:39.440

你有来源吗？在许多情况下，独立应用程序和服务之间的差异很小。

大多数更改与将代码正确连接到服务管理器有关。完成后，您将知道发生的任何问题都是您的编程而不是任何其他程序的结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-01T14:22:12.213

您可以使用[ServiceMill](http://www.activeplus.com/en/Products/ServiceMill)来实现此操作。基本上，您在服务器上安装 ServiceMill Server。然后单击可执行文件上的右键并单击“作为 ServiceMill 服务安装”。接下来你配置一些东西（用户/密码，如果你想与桌面交互或者如果你喜欢隐藏用户界面......并将启动模式设置为自动）。

Active+ Software 的另一个工具可以是一个解决方案，[ServiceMill Exe Builder](http://www.activeplus.com/en/Products/ServiceMillExeBuilder)，它允许您从命令行创建服务，如果您使用持续集成服务器或者如果您计划将组件作为服务分发而无需考虑，这非常棒服务集成（而且它是免费的）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-27T02:16:22.467

[FireDaemonPro](http://www.firedaemon.com/product/firedaemon-pro)将大多数 GUI 应用程序变成服务；它不是免费的，但可能值得购买。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-10T02:54:46.250

首先我要问为什么你的服务需要一个用户界面。很可能它没有，但您可能需要一个从该服务获取数据的客户端。服务通常没有 GUI 的原因是它们可能没有可以运行的窗口环境。服务可以在没有用户登录到机器的情况下启动和运行。在这种情况下，将没有运行服务 GUI 的桌面。

话虽如此，您可以按照 Mark 的建议将服务的属性设置为以用户身份运行。您还可以在服务的属性中指定“允许服务与桌面交互”。仅当您知道用户将登录时才执行此操作。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-10T04:28:02.923

服务不应该有 GUI，因为它应该在不需要任何用户干预的情况下运行，并且存在与找到正确的用户桌面并与之通信相关的各种问题。

因为，大概是为了能够远程监控应用程序而提出这个问题，所以这样做的方法是拥有两个应用程序。服务端（基本上作为控制台应用程序编写）和客户端/监控 GUI 端。该服务将使用一些远程连接（当我这样做时，我使用命名管道）与客户端/监控应用程序进行通信。任何一个都应该能够在没有另一个的情况下运行，当然服务应该能够在没有客户端的情况下运行。

# php - 我们应该停止使用 Zend WinEnabler 吗？

> ID：53253
> 
> 赞同：1
> 
> 时间：2008-09-10T00:56:49.840
> 
> 标签：php, zend-server

（这个问题已经超过 6 年了，可能不再具有任何相关性。）

我们的系统使用 Zend WinEnabler。

*   你用它吗？
*   它已经过时了吗？
*   我们应该停止使用它吗？
*   是否已知会导致句柄/内存泄漏？

这是对它的（旧）介绍：[PHP Creators Unveil New Product that Makes PHP Truly Viable for Windows Environments](http://personalweb.about.com/b/2004/03/29/zend-announces-winenabler-enabling-php-for-windows-environments.htm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-10T03:00:01.183

由于 Zend 似乎不再出售它，而且它的所有功能都是免费提供的（通过 FastCGI），我会这么说。如果您真的想在 Windows 上运行 PHP，请查看[Zend Core](http://www.zend.com/en/products/core/)（[安装 Zend Core ）。](http://learn.iis.net/page.aspx/272/installing-php-on-windows-vista-with-fastcgi/)但实际上，您应该问自己为什么要在 Windows 上运行 PHP（我们曾经这样做过，而且非常头疼，尤其是因为没有其他人这样做）。

# javascript - 通过 id 获取最近的元素

> ID：53256
> 
> 赞同：1
> 
> 时间：2008-09-10T00:59:46.417
> 
> 标签：javascript, html, dom

我有两个要素：

```
<input a>
<input b onclick="..."> 
```

单击 b 时，我想访问 a 并操作它的一些数据。A 没有全局唯一名称，因此`document.getElementsByName`已出局。查看事件对象，我认为`event.target.parentNode`会有一些类似的功能`getElementsByName`，但 <td>s 似乎不是这种情况。有什么简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T01:08:44.353

如果`a`和`b`彼此相邻并且具有相同的父级，则可以使用 的`prevSibling`属性`b`来查找`a`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T01:09:23.523

1.  您应该能够找到从[事件对象](http://www.w3schools.com/htmldom/dom_obj_event.asp)中单击的元素。根据您的浏览器，您可能需要`e.target`或`e.srcElement`. 下面的代码来自这个[w3schools 示例](http://www.w3schools.com/js/tryit.asp?filename=try_dom_event_srcelement)：

    ```
    function whichElement(e) {
      var targ;
      if (!e) var e = window.event;
      if (e.target) {
        targ=e.target;
      } else if (e.srcElement) {
        targ = e.srcElement;
      }

      if (targ.nodeType==3) { // defeat Safari bug 
        targ = targ.parentNode;
      }

      var tname;
      tname = targ.tagName;
      alert("You clicked on a " + tname + " element.");
    } 
    ```

2.  然后，您可以使用`nextSibling`和`prevSibling`DOM 遍历函数。 [更多信息在这里](http://www.newearthonline.co.uk/index.php?page=article&article=284)。又是 w3schools 对[XML DOM Nodes](http://www.w3schools.com/DOM/dom_node.asp)的参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T06:51:26.103

[Prototype](http://www.prototypejs.org/)还具有在 DOM 中移动的不错的功能。在您的示例中，类似以下内容可以解决问题：

```
b.up().down('a') 
```

如果在该级别有多个 a 元素，您可以使用 CSS 选择器来准确指定您想要的元素

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T01:18:47.980

将您的普通 JavaScript 抛在脑后。获取 JQuery——它将为您节省大量时间。

[http://docs.jquery.com/Selectors](http://docs.jquery.com/Selectors)

# case-tools - 案例工具

> ID：53257
> 
> 赞同：-3
> 
> 时间：2008-09-10T01:02:42.200
> 
> 标签：case-tools

有人在这里使用案例工具在公司环境中进行编程吗？我正在使用 Computer Associates 的 AllFusion Gen aka IEF\Composer\Cool:Gen。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-16T21:06:59.367

我们使用 Sparx Systems 的企业架构师。

它的价格非常合理，并且拥有所有案例工具中最全面的功能集之一。

它还允许您在 RDBMS 中使用集中式模型存储，这意味着它非常适合协作。

此外，一些用于项目估算的用例指标是非常宝贵的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-10T01:07:18.663

此页面包含 CASE 工具的索引：[http ://www.unl.csi.cuny.edu/faqs/software-enginering/tools.html](http://www.unl.csi.cuny.edu/faqs/software-enginering/tools.html)

这可能是一个很好的起点。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-16T21:03:57.347

帮自己一个忙，摆脱那个工具。去获取 Embarcadero 的 ER/Studio 的副本。我已经尝试了几个，现在我被困在 ER/Studio 和 coolgen 之间移动一些东西。Gen输了，放下手。

# language-agnostic - 当请求被登录页面中断时保留 HTTP POST 数据

> ID：53260
> 
> 赞同：4
> 
> 时间：2008-09-10T01:08:20.297
> 
> 标签：language-agnostic

假设用户正在浏览一个网站，然后执行一些更改数据库的操作（假设他们添加了评论）。然而，当实际添加评论的请求进来时，我们发现我们需要强制他们登录才能继续。

假设登录页面要求输入用户名和密码，并将用户重定向回他们在需要登录时访问的 URL。该重定向适用于仅具有 GET 参数的 URL，但如果请求最初包含一些 HTTP POST 数据，则该数据现在会丢失。

当涉及 HTTP POST 数据时，谁能推荐一种处理这种情况的方法？

显然，如果有必要，登录页面可以动态生成一个包含所有 POST 参数的表单来传递它们（虽然这看起来很乱），但即便如此，我也不知道登录页面有什么方法可以重定向用户到他们的预期页面，同时将 POST 数据保留在请求中。

* * *

**编辑**：我应该明确的一个额外限制 - 想象一下，在用户提交评论之前，我们不知道是否需要登录。例如，他们的 cookie 可能在他们加载表单和实际提交评论之间过期。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-10T01:14:21.640

这是 Ajax 技术可能有用的一个好地方。当用户单击提交按钮时，在客户端显示登录对话框并在实际提交页面之前与服务器进行验证。

我能想到的另一种方法是在主页本身的 DIV 标记中动态显示或隐藏登录控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T02:47:53.273

您可能想 在自己实现之前调查 Django[删除此功能的原因。](http://www.djangoproject.com/weblog/2008/sep/02/security/)这似乎不是 Django 特有的问题，而是另一个跨站点伪造攻击。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T01:35:26.270

只需将 POST 中的所有必要数据存储在会话中，直到登录过程完成。或者在数据库中有某种临时表来存储然后检索它。显然这是伪代码，但是：

```
if ( !loggedIn ) {
    StorePostInSession();
    ShowLoginForm();
}

if ( postIsStored ) {
    RetrievePostFromSession();
} 
```

或类似的规定。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T02:08:17.610

2个选择：

1.  从登录页面写出凌乱的表单，然后 JavaScript form.submit() 将其写入页面。
2.  让登录页面本身 POST 到请求页面（使用以前的值），并让该页面的控制器执行登录验证。将此纳入您已经拥有的用于检测未登录用户的任何逻辑（框架因他们如何执行此操作而异）。在伪 MVC 中：

```
 CommentController {
           void AddComment() {
             if (!Request.User.IsAuthenticated && !AuthenticateUser()) {
                return;
             }
             // add comment to database
           }

           bool AuthenticateUser() {
             if (Request.Form["username"] == "") {
                // show login page
                foreach (Key key in Request.Form) {
                   // copy form values
                   ViewData.Form.Add("hidden", key, Request.Form[key]);
                }
                ViewData.Form.Action = Request.Url;

                ShowLoginView();
                return false;
              } else {
                 // validate login
                 return TryLogin(Request.Form["username"], Request.Form["password"]);
              } 
           }
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T01:15:41.513

在他们提交的页面上收集数据，并将其存储在您的后端（数据库？），同时他们完成登录序列，在登录表单的页面上隐藏事务 ID 或类似内容。完成后，通过使用后端的事务 ID 查找将他们返回到他们要求的页面，并将他们发布的所有数据转储到表单中以再次预览，或者只运行该页面将运行的任何代码。

请注意，如果用户需要登录以发表评论但尚未登录，许多系统（例如博客）会通过使用与发表评论相同的登录字段来解决此问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-10T02:23:51.847

我知道它说与语言无关，但为什么不利用您正在使用的服务器端语言提供的约定呢？如果是 Java，数据可以通过设置 Request 属性来持久化。您将使用控制器来处理表单，检测登录，然后转发。如果设置了属性，那么只需使用该数据预填充表单？

**编辑：**您也可以使用所指出的会话，但我很确定如果您在 Java 中使用前向返回登录页面，请求属性将持续存在。

# svn - 如何让我的仅 SVN 主机从 git 存储库中提取？

> ID：53290
> 
> 赞同：6
> 
> 时间：2008-09-10T01:36:21.883
> 
> 标签：svn, git, build-automation, capistrano

我真的很想让我们的主机从我们的 Git 存储库中提取，而不是手动上传文件，但它没有安装 Git。

那么有没有办法欺骗 Subversion（他们确实有）检查 Git 存储库？

我想我已经知道答案了，即让我的主机添加 Git 并一直使用它，直到他们这样做，但我想我还是会问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T01:47:47.927

此页面应为您的问题提供解决方法。

[http://code.google.com/p/support/wiki/ImportingFromGit](http://code.google.com/p/support/wiki/ImportingFromGit)

基本上，您以 SVN 存储库格式创建 Git 存储库的只读克隆，并随时导出更新。可以编写一个 SVN 挂钩，在每次更新后触发以将新文件复制到您需要的位置。

# ruby - Ruby 包包含问题

> ID：53292
> 
> 赞同：1
> 
> 时间：2008-09-10T01:36:47.280
> 
> 标签：ruby, macos

我正在尝试在我的 Ruby 代码中使用[Optiflag](http://optiflag.rubyforge.org/discussion.html)包，每当我尝试执行必要的操作时`require optiflag.rb`，我的程序都会失败并显示标准`no such file to load -- optiflag`消息。我将该库的目录添加到我的 $PATH 变量中，但它仍然无法正常工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T02:02:45.953

是宝石吗？你在做什么

```
require 'rubygems'
require 'optiflag' 
```

或同等学历？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T03:53:38.730

它看起来像是一个 gem，所以你需要在需要它之前启用 ruby​​ gems。

[这个网站](http://www.rubygems.org/read/chapter/3#page70)解释了如何做到这一点的许多方法。但是这里有备忘单，这些是：

1) 在使用 gem 之前需要 ruby​​gems 包。

```
require "rubygems"
require "optiflag" # etc 
```

2) 将 -rubygems 标志添加到执行 ruby​​ 的任何位置。IE：

```
ruby -rubygems Something.rb 
```

3) 添加一个名为 RUBYOPT 的环境变量，给它一个 ruby​​gems 选项。IE：

```
RUBYOPT=rubygems 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-04T13:30:48.730

我也一直遇到RubyXL这个问题，尝试使用单引号和双引号。还有什么需要做的吗？也许把文件放在某个地方？我已经使用 sudo gem install ruby​​XL 成功安装了 gem（RubyXL 实际上不起作用）。

# java - Java Web Services API，但是我无法在我的服务器上运行 JVM

> ID：53295
> 
> 赞同：1
> 
> 时间：2008-09-10T01:39:55.683
> 
> 标签：java, json, web-services

我正在尝试使用 PlanPlusOnline 帐户中的一些数据。他们只提供一个 java web 服务 API。将使用数据的站点的服务器不允许我安装 Tomcat（编辑：或 JVM）。我不会撒谎，我是一名 Java 软件工程师，同时我还做一些网络工作。我不熟悉 Web 服务或 servlet，但我愿意试一试。我更希望他们拥有对数据的 JSON 访问权限，但据我所知，他们没有。有任何想法吗？

编辑：澄清。planplusonline 提供的Web 服务是基于Java 的。我正在尝试在不使用 Java 的情况下从此 Web 服务访问数据。我相信现在这是可能的，但我需要做更多的研究。任何可以帮助我指出正确方向的人都会受到赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T02:07:11.857

为了跟进 jodonnell 的评论，几乎可以用任何服务器端语言建立 Web 服务连接。只是他们提供的 API 示例是用 Java 编写的，可能是因为 PlanPlusOnline 是用 Java 编写的。如果您有服务的 URL 和访问密钥，那么您真正需要做的就是弄清楚如何遍历返回的 XML。如果您不会使用 Java，那么我建议您使用 PHP，因为它可能已经安装，并且已经加载了适当的模块。此链接可能会有所帮助：

[http://www.onlamp.com/pub/a/php/2007/07/26/php-web-services.html](http://www.onlamp.com/pub/a/php/2007/07/26/php-web-services.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T01:51:44.017

您是否正在尝试为托管在其他地方的 Web 服务实现客户端？如果是这样，Java 就没有必要了。您可以使用[.NET](http://www.dotnetjunkies.ddj.com/Tutorial/4D13CEFA-D0FD-44BE-8749-8D17B5757564.dcik)、[PHP](http://sourceforge.net/projects/nusoap/)、[Ruby](http://raa.ruby-lang.org/project/soap4r)或几乎任何现代 Web 技术创建 Web 服务客户端。您只需要一个 WSDL 文档来提供有关如何调用服务的元数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T03:13:07.970

如果我正确理解您的问题，您只需要连接到现有的 Web 服务，而不需要创建自己的 Web 服务。如果是这样的话，也许我遗漏了一些东西，我认为你根本不需要 Tomcat。如果您使用的是 Netbeans，您可以创建一个新的桌面或 Web 应用程序，然后右键单击项目名称。选择新建，然后选择其他，然后选择 Web 客户端。输入查找 WSDL 的位置信息（通常是 URL）和其他必需信息。

添加 WebClient 后，创建一个实际调用 Web 服务的新类。如果 Web 服务名称是 PlanPlusOnline，那么您可以使用以下内容：

```
public final class PlanPlusOnlineClient
{
    //instance to this class so that we do not have to reinstantiate it every time
    private static PlanPlusOnlineClient _instance = new PlanPlusOnlineClient();

    //generated class by netbeans with information about the web service
    private PlanPlusOnlineService service         = null;

    //another generated class by netbeans but this is a property of the service
    //that contains information about the individual methods available.
    private PlanPlusOnline port                   = null;

    private PlanPlusOnlineClient()
    {
        try
        {
            service = new PlanPlusOnlineService();
            port = service.getPlanPlusOnlinePort();
        }
        catch (MalformedURLException ex)
        {
            MessageLog.error(this, ex.getClass().getName(), ex);
        }
    }

    public static  PlanPlusOnlineClient getInstance()
    {
        return _instance;
    }

    public static String getSomethingInteresting(String param)
    {
         //this will call one of the actual methods the web 
         //service provides.
         return port.getSomethingIntersting(param);
    }    

} 
```

我希望这对您有所帮助。您还应该查看[http://www.netbeans.org/kb/60/websvc/](http://www.netbeans.org/kb/60/websvc/) 以获取有关 Netbeans 和 Web 服务的更多信息。我确信它在其他 IDE 中是相似的。

# wpf - 您可以将 DataTrigger 绑定到附加属性吗？

> ID：53301
> 
> 赞同：20
> 
> 时间：2008-09-10T01:47:08.583
> 
> 标签：wpf, binding, datatrigger

在 WPF 中，DataTrigger 是否可以绑定到附加属性？

我本质上想在附加属性上使用转换器来在特定验证规则被破坏时提供样式。我正在使用如下标记：

```
<DataTrigger Binding="{Binding Path=Validation.Errors, 
                       RelativeSource={RelativeSource Self}, 
                       Converter={StaticResource RequiredToBoolConverter}}" 
                       Value="True">
  <Setter Property="Background" Value="LightGreen" />
</DataTrigger> 
```

但是，当它运行时，我得到以下信息：

> System.Windows.Data 错误：39：BindingExpression 路径错误：在“对象”“文本框”（名称=“”）上找不到“验证”属性。BindingExpression:Path=Validation.Errors; 数据项='文本框'（名称=''）；目标元素是'TextBox'（名称=''）；目标属性是“NoTarget”（类型“对象”）

如果我将 DataTrigger 绑定路径更改为“文本”，我不会收到数据绑定错误（但它当然不会提供我正在寻找的行为）。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-10T06:51:40.457

您需要将属性包装在括号中：

```
<DataTrigger Binding="{Binding Path=(Validation.Errors).YourAttachedProperty,... 
```

# cocoa - 使用 OpenGL 和 Cocoa 绘制文本的最佳方法？

> ID：53309
> 
> 赞同：9
> 
> 时间：2008-09-10T01:52:52.110
> 
> 标签：cocoa, opengl

有谁知道在 Cocoa NSOpenGLView 中绘制任意文本的简单方法？我有几个限制。

*   屏幕上的文本可能会逐帧变化（例如，角落的帧率显示）
*   我希望能够选择系统上安装的任何字体大小

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-10T13:02:20.300

您看过[Cocoa OpenGL 示例代码](http://developer.apple.com/samplecode/CocoaGL/index.html "可可 OpenGL")吗？它包括“字符串的纹理类，展示了如何使用 NSImage 将字符串写入其中，然后从中进行纹理以实现高质量的字体渲染。”

# java - 休眠作物的clob值奇怪

> ID：53316
> 
> 赞同：1
> 
> 时间：2008-09-10T02:09:02.197
> 
> 标签：java, oracle, hibernate

我在两个表之间有一对多的关系。many 表包含一个 clob 列。在 hibernate 中，clob 列如下所示：

```
@CollectionOfElements(fetch = EAGER)
@JoinTable(name = NOTE_JOIN_TABLE, joinColumns = @JoinColumn(name = "note"))
@Column(name = "substitution")
@IndexColumn(name = "listIndex", base = 0)
@Lob
private List<String> substitutions; 
```

所以基本上我可能有一个带有一些替代品的注释，比如`"foo"`and `"fizzbuzz"`。因此，在我的主表中，我可以有一个 id 为 4 的便笺，而在我的主表中，我`NOTE_JOIN_TABLE`会有两行，`"foo"`并且`"fizzbuzz"`都与便笺有关系。

但是，当其中一个插入数据库**时​​，较大的替换值将被裁剪为与最短的一样长。**所以在这种情况下，我会在数据库中使用`"foo"`and`"fiz"`而不是`"foo"`and `"fizzbuzz"`。

你知道为什么会这样吗？我已经检查并确认它们没有在我们的代码中的任何地方被裁剪，它肯定是休眠的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-10T03:39:41.057

`LOB/CLOB`列可能不够大。Hibernate 有一些`LOB/CLOB`相对较小的默认列大小（可能取决于 db）。无论如何，尝试这样的事情：

```
@Lob 
@Column(length=2147483648) 
```

根据您的需要调整长度（以字节为单位）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T17:36:46.130

许多 JDBC 驱动程序，尤其是早期版本的 Oracle，在插入 LOB 时都会出现问题。您是否确保查询 Hibernate 触发，绑定相同的参数在您的 JDBC 驱动程序中成功运行？

# .net - 类型化数据集的缺点是什么

> ID：53338
> 
> 赞同：17
> 
> 时间：2008-09-10T02:41:32.680
> 
> 标签：.net, ado.net, data-access-layer, dataset

我来自一个喜欢构建自己的世界而不是依赖他人构建的库和框架的世界。逃离这个世界后，我发现在 Visual Studio 中使用 Typed DataSets 等工具的乐趣和轻松。那么除了失去灵活性之外，你还失去了什么？是否有性能因素（忽略 procs 与动态 sql 的争论）？限制？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-10T03:09:58.617

到目前为止，类型化数据集是经典 ADO 断开连接记录集的升级版。我发现在需要执行一些面向行的排序任务的简单情况下，它们仍然很好用——即，您仍然希望在行、列、约束等的数据库范例的上下文中工作。如果在这种情况下明智地使用，那么你就可以了。

有几个方面他们的好处会减少：

*   我认为这里提出的同步问题肯定是一个问题，特别是如果你已经定制了它们或将它们用作基类。
*   根据数据集中数据表的数量，它们可能会变得非常*胖*。我的意思是多表数据集通常呈现数据的关系视图。除了内存占用之外，随之而来的是键的定义和潜在的其他约束。同样，如果这正是您所需要的，但如果您需要一次快速遍历数据，那么带有数据读取器的高效循环可能是更好的选择。
*   由于它们的复杂定义和潜在大小，在远程情况下使用它们也是不明智的。
*   最后，当您开始意识到您需要处理与您的问题域相关的对象中的数据时，它们的使用将成为障碍而不是好处。您经常发现自己将字段移入和移出集合中的行表，并关注表和行的状态。您开始意识到他们使用 OO 语言来更容易地表示现实世界的问题域对象，并且使用表、行和列并不真正适合这种思维方式。

一般来说，根据我的经验，我发现复杂系统（例如许多大型企业系统）最好不要使用数据集，而更多地转向可靠的领域特定对象模型——如何让数据进出这些对象（例如使用 ORM）完全是另一个话题。然而，在需要基本维护和一些其他简单操作的数据前面有一个表单的小型项目中，数据集范式可以实现很高的生产力——尤其是与 Visual Studio/.Net 强大的数据绑定功能相结合时。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-10T02:58:17.443

我要扩展的主要批评是它们不能很好地扩展 - 与轻量级业务实体或 DTO 或 LINQ to SQL 相比，当您获得更多事务时，性能会因为开销而受到影响。架构更改也令人头疼。对于“工业实力”架构，它们可能不是要走的路，从长远来看它们会引起问题。

我仍然肯定会将它们用于快速而肮脏的 PoC 或简单的实用程序——考虑到 Visual Studio 中的工具，它们使用起来真的很方便，并且可以完成工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-10T02:47:32.837

与无类型数据集相比，类型化数据集的性能得到了提高（尽管我从未发现像这样的琐碎事情值得担心的性能问题）。

我想说最大的痛苦就是让它们与您的数据库保持同步——我不能代表 VS 2008，但以前的版本并没有为此提供良好的支持。每次结果集的架构发生变化时，我都会将 procs 拖到设计器上。不好玩。

但是，你确实得到了编译时类型检查，这非常棒，比如 Customer.Name 而不是 Dataset.Tables(0).Rows(0)("Name")。

因此，如果您的架构是相对静态的，那么它们可能是值得的，但否则，我不会打扰。

您还可以查看真正的 ORM。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-10T02:56:55.280

我只给了 Typed Datasets 一个很短的尝试。当我发现我的代码在 1000 多行的生成代码文件中中断了大约 2/3 时，我停下了脚步。

我不喜欢的另一件事是我认为我可以编写像 Customer.Name 这样的代码，但默认情况下我似乎得到像 CustomerDataSet.Customers[0].Name 这样的代码，其中 Customers[0] 的类型是 CustomersRow . 仍然比无类型数据集更好阅读，但不是我正在寻找的语义。

就我个人而言，我走上了 ActiveRecord/NHibernate 的路线，从那以后就再也没有回头。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T02:51:14.810

类型化的数据集没有任何问题。它们并不完美，但它是解决对象关系阻抗失配问题的下一步。我面临的唯一问题是对架构更改的支持较弱。部分课程可以提供帮助，但并非在所有情况下都可以。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-13T14:21:41.927

我不是类型化数据集的忠实粉丝。我无法使用类型化数据集来提高性能。它纯粹是对现有数据库对象的包装。我不能考虑像**employee.empName**这样的访问。铸造仍然在包装中完成。另一个开销是大量代码。LOC 增加。内存中有这么多活动对象。没有自动更新架构。无论如何，类型化的数据集对开发人员来说都是没有用的，除了它提供的舒适性。作为开发人员，我们没有任何权利要求舒适 :) 忍受痛苦...摆脱用户的痛苦 :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T23:10:43.550

如果忽略前面提到的所有问题，数据集非常适合与 Visual Studio 一起快速处理某些内容。我没有看到提到的一个问题是 Visual Studio 设计界面中数据集的视觉可伸缩性。随着系统的增长，数据集的大小不可避免地变得笨重。设计师的视觉方面根本无法缩放。当数据集有超过 20 个左右的表时，滚动试图找到特定的表或关系真的很痛苦。

# visual-studio-2008 - Crystal Report 图标/工具栏在 Web 服务器上部署时不起作用

> ID：53347
> 
> 赞同：6
> 
> 时间：2008-09-10T02:55:05.080
> 
> 标签：visual-studio-2008, deployment, crystal-reports

我已经构建了一个网页，其中包含使用 Visual Studio 2008 中包含的 Crystal 库构建的 Crystal Report。

它“[在我的机器上工作](http://jcooney.net/archive/2007/02/01/42999.aspx)”，但是当部署到 Web 服务器时，Crystal Report 工具栏上的图标（导出、打印等）不显示或不工作。只是看到按钮图像应该在的“红色 X”，然后单击什么也不做。

我检查了工具栏图像实际上位于 Web 服务器上正在查看的位置：（C:/Inetpub/wwwroot/aspnet_client/system_web/2_0_50727/CrystalReportWebFormViewer4/images/toolbar/）
它们都在那里。

我已经检查了 Web 服务器上上述文件夹的权限。给每个用户“完全控制”只是为了测试它。

我还在网络服务器上安装/运行了“CRRedist2008_x86.msi”。

有人提到要确保将“crystalreportviewers115”文件夹添加到我在 Web 服务器上的“\wwwroot\aspnet_client\system_web\2_0_50727”文件夹中，但我一直无法找到“crystalreportviewers115”来复制它。

感谢您提供的任何帮助或想法。

更新 - 好的，很明显我没有很好地检查图像是否位于正确的位置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T04:07:17.950

嗬！工作中的其他人发现了这一点。这真的很简单，我应该能够对其进行排序，但是嘿，有时就是这样。

修复方法：
在 Web 服务器上，将“aspnet_client”文件夹从“C:\Inetpub\wwwroot”复制到“C:\Inetpub\wwwroot\your-website-name”。

这就是我们所做的一切，它现在正在工作。

希望这可以使某人免于我刚刚经历的所有大惊小怪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-15T17:28:17.690

另一种解决方案是在您的网站中简单地创建一个新的虚拟目录并将其指向“C:/Inetpub/wwwroot/aspnet_client”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-11T12:38:06.910

试试这个
在网络服务器上，从“C:\Inetpub\wwwroot”复制“aspnet_client”文件夹并粘贴到您的网站文件夹中。（表单文件夹、app_data 文件夹等将在那里）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-29T08:25:29.977

我接管了维护另一位开发人员生成的一些代码，该开发人员也离开并遇到了这个问题。在我的情况下，编译的报告正在寻找我的本地开发路径中存在的 Crystalreportview115 文件夹中的图像，因此可以在本地工作。目标服务器上的唯一文件夹是 CrystalReportWebFormViewer4（我假设来自以前的服务器安装或站点部署）。只需添加 ...115 文件夹即可为我解决问题。

我们的根本原因似乎是开发者机器上安装的 Crystal 版本。不确定这对任何人都有帮助，但我想我会提到它！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-06T15:05:41.957

将 aspnet_client 文件夹从本地计算机的 c:\inetpub\wwwroot 文件夹上传到 Web 托管服务器的 httpdocs 文件夹。祝你好运！！！

# php - 对于只需要一个连接的应用程序，在 PHP5 中隐藏数据库连接代码的最佳方法是什么？

> ID：53353
> 
> 赞同：2
> 
> 时间：2008-09-10T03:03:32.500
> 
> 标签：php, database, oop

下面我介绍了三个选项，用于在仅涉及单个连接时简化我的数据库访问（这通常是我工作的 Web 应用程序的情况）。

一般的想法是使数据库连接透明，以便它在我的脚本第一次执行查询时连接，然后保持连接直到脚本终止。

我想知道你认为哪一个是最好的，为什么。我不知道这些可能适合的任何设计模式的名称，很抱歉没有使用它们。如果使用 PHP5有*更好的方法，请分享。*

简单介绍一下：有一个包含查询方法的DB_Connection 类。这是一个不受我控制的第三方类，为了本示例的目的，我已经简化了它的接口。在每个选项中，我还为虚构的数据库“项目”表提供了一个示例模型，以提供一些上下文。

选项 3 是为我提供了我最喜欢的界面的选项，但不幸的是我认为它不实用。

我已经在下面的评论块中描述了每种方法的优缺点（我可以看到）。

目前我倾向于选项 1，因为负担放在了我的数据库包装类而不是模型上。

所有评论表示赞赏！

注意：出于某种原因，堆栈溢出预览显示的是编码的 HTML 实体，而不是下划线。如果帖子是这样通过的，请考虑到这一点。

```
<?php

/**
 * This is the 3rd-party DB interface I'm trying to wrap.
 * I've simplified the interface to one method for this example.
 *
 * This class is used in each option below.
 */
class DB_Connection {
    public function &query($sql) { }
}

/**
 * OPTION 1
 *
 * Cons: Have to wrap every public DB_Connection method.
 * Pros: The model code is simple.
 */
class DB {
    private static $connection;
    private static function &getConnection() {
        if (!self::$connection) {
            self::$connection = new DB_Connection();
        }
        return self::$connection;
    }
    public static function &query($sql) {
        $dbh = self::getConnection();
        return $dbh->query($sql);
    }
}

class Item {
    public static function &getList() {
        return DB::query("SELECT * FROM items");
    }
}

/**
 * OPTION 2
 *
 * Pros: Don't have to wrap every DB_Connection function like in Option 1
 * Cons: Every function in the model is responsible for checking the connection
 */

class DB {
    protected static $connection = null;
    public function connect() {
        self::$connection = new DB_Connection();
    }
}

class Item extends DB {
    public static function &getList() {
        if (!self::$connection) $this->connect();
        return self::$connection->query("SELECT * FROM items");
    }
}

/**
 * OPTION 3
 *
 * Use magic methods
 *
 * Pros: Simple model code AND don't have to reimplement the DB_Connection interface
 * Cons: __callStatic requires PHP 5.3.0 and its args can't be passed-by-reference.
 */
class DB {
    private static $connection = null;

    public static function &getConnection() {
        if (!self::$connection) {
            self::$connection = new DB_Connection();
        }
        return self::$connection;
    }

    public static function __callStatic($name, $args) {
        if (in_array($name, get_class_methods('DB_Connection'))) {
            return call_user_func_array(
                array(self::getConnection(), $name), $args);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T03:15:24.127

根据您上面的示例，我会说选项 1 是最好的 - 简单总是获胜，并且您可以根据方法以不同方式处理失败的连接（对于存储过程调用，您可能希望以不同于简单 SELECT 的方式失败，例如实例）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T11:48:50.477

从语义上讲，我认为选项 1 最有意义，如果您将 DB 视为资源，则 DB_Connectioin 是它使用的对象，但不一定是对象本身。

但是，我提醒您注意几件事。首先，不要让您的 DB 类具有所有静态方法，因为它会严重影响您测试代码的能力。考虑一个非常简单的控制容器反转，如下所示：

```
class DB {
    private $connection;
    public function &query($sql) {
        return $connection->query($sql);
    }
    public __construct(&$db_connection) {
        $this->connection = $db_connection;
    }
}

class Item {
    public function &getList() {
        return  ResourceManager::getDB()->query("SELECT * FROM items");
    }
}

class ResourceManager {
    private $db_connection;
    private function &getDbConnection() {
        if (!$this->connection) {
            $this->connection = new DB_Connection();
        }
        return $this->connection;
    }
    private $db;
    public static function getDB() {
        if(!$this->db) $this->db = new DB(getDbConnection());
    return $this->db;
} 
```

有显着的好处。如果您不想将 DB 用作单例，您只需对 ResourceManager 进行一次修改。如果您决定它不应该是单例 - 您可以在一个地方进行修改。如果您想根据某些上下文返回不同的 DB 实例 - 同样，更改只在一个地方。

现在，如果您想独立于 DB 测试 Item，只需在 ResourceManager 中创建一个 setDb($db) 方法并使用它来设置假/模拟数据库（在这方面[simplemock](http://www.lastcraft.com/simple_test.php)将为您提供很好的服务）。

其次 - 这是此设计简化的另一个修改 - 您可能不想让您的数据库连接一直保持打开状态，它最终可能会使用比需要更多的资源。

最后，正如您提到的 DB_Connection 有其他未显示的方法，似乎它可能被用于不仅仅是维护连接。既然您说您无法控制它，我是否建议您从中提取您关心的方法的接口，并使 MyDBConnection 扩展实现您的接口的 DB_Connection 类。根据我的经验，这样的事情最终也会减轻一些痛苦。

# windows - 如何创建目录的快捷方式以便在资源管理器中打开

> ID：53355
> 
> 赞同：6
> 
> 时间：2008-09-10T03:07:41.790
> 
> 标签：windows, explorer

更好的是，我怎样才能让我的电脑也总是在资源管理器中打开？

我通常在我的快速启动栏上创建我的编程目录的快捷方式，但我希望它们在资源管理器中打开。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T03:10:44.980

资源管理器 -dc:\path

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-10T03:21:13.067

我用`explorer /e,c:\path`.

@harpo

`explorer -d c:\path`对我不起作用（WinXP sp3）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T03:09:27.557

你考虑过win+e快捷键吗？这不是您想要的，但可能足够接近。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-10T03:20:25.847

这是一个很好的参考：http: [//support.microsoft.com/kb/130510](http://support.microsoft.com/kb/130510)

```
i.e.:
explorer /e,%HOMEDRIVE%%HOMEPATH% 
```

# apache-flex - 在 Adob e AIR 中打印 - 独立 PDF 生成

> ID：53364
> 
> 赞同：6
> 
> 时间：2008-09-10T03:18:13.947
> 
> 标签：apache-flex, printing, air, ria

是否可以在 Adob​​e AIR 应用程序中生成 PDF 文档，而无需借助往返 Web 服务来生成 PDF？我查看了 GoogleCode 上的初始 Flex 报告，但它需要往返才能生成实际的 PDF。

鉴于 AIR 应该是 RIA 的桌面端，有没有办法做到这一点？我怀疑我忽略了一些东西，但我对文档的搜索并没有透露太多信息，并且考虑到 AIR 的目标，我无法相信这只是他们没有包括的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-10T10:09:40.823

有[AlivePDF](http://code.google.com/p/alivepdf/)，这是一个适用于 ActionScript 的 PDF 生成库，它应该可以工作，它只是针对您描述的情况而制作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-26T22:32:07.983

刚刚添加了一个 Adob​​e Air + Javascript + AlivePDF 演示：

这个演示*不需要*flex 并且非常简单。

[http://www.drybydesign.com/2010/02/26/adobe-air-alivepdf-without-flex/](http://www.drybydesign.com/2010/02/26/adobe-air-alivepdf-without-flex/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T03:50:42.933

我工作的其他团队之一正在开发基于 Flex 的绘图应用程序，他们对 AIR / Flex 没有内置 PDF 创作感到非常惊讶。他们最终基于 PDF 规范推出了自己的简单 PDF 创建器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-07T02:10:31.063

是的，使用 AlivePDF 创建 PDF 非常容易，这里是示例代码，第一种方法创建一个 pdf，第二种方法将 pdf 保存在磁盘上并返回路径，请随时提出任何问题。

```
public function createFlexPdf() : String
{
    pdf = new PDF();
    pdf.setDisplayMode (Display.FULL_WIDTH,Layout.ONE_COLUMN,Mode.FIT_TO_PAGE,0.96);
    pdf.setViewerPreferences(ToolBar.SHOW,MenuBar.HIDE,WindowUI.SHOW,FitWindow.RESIZED,CenterWindow.CENTERED);
    pdf.addPage();
    var myFontStyle:IFont = new CoreFont ( FontFamily.COURIER );
    pdf.setFont(myFontStyle,10);
        pdf.addText('Kamran Aslam',10,20);//String, X-Coord, Y-Coord 
    return savePDF();
}
private function savePDF():String
{
    var fileStream:FileStream = new FileStream();
    var file:File = File.createTempDirectory();
    file = file.resolvePath("temp.pdf");
    fileStream.open(file, FileMode.WRITE);
    var bytes:ByteArray = pdf.save(Method.LOCAL);
    fileStream.writeBytes(bytes);
    fileStream.close();
    return file.url;
} 
```

# java - 休眠以记录 clob 参数

> ID：53365
> 
> 赞同：3
> 
> 时间：2008-09-10T03:19:38.313
> 
> 标签：java, oracle, hibernate

*（请参阅[此处](https://stackoverflow.com/questions/53316/hibernate-crops-clob-values-oddly)了解我要解决的问题）*

你如何让休眠记录它要插入的 clob 值。它正在记录其他值类型，例如 Integer 等。

我的 log4j 配置中有以下内容：

```
log4j.logger.net.sf.hibernate.SQL=DEBUG
log4j.logger.org.hibernate.SQL=DEBUG
log4j.logger.net.sf.hibernate.type=DEBUG
log4j.logger.org.hibernate.type=DEBUG 
```

产生如下输出：

```
(org.hibernate.SQL) insert into NoteSubstitutions (note, listIndex, substitution) values (?, ?, ?)
(org.hibernate.type.LongType) binding '170650' to parameter: 1
(org.hibernate.type.IntegerType) binding '0' to parameter: 2
(org.hibernate.SQL) insert into NoteSubstitutions (note, listIndex, substitution) values (?, ?, ?)
(org.hibernate.type.LongType) binding '170650' to parameter: 1
(org.hibernate.type.IntegerType) binding '1' to parameter: 2 
```

但是你会注意到它从不显示`parameter: 3`哪个是我们的 clob。

我真正想要的是：

```
(org.hibernate.SQL) insert into NoteSubstitutions (note, listIndex, substitution) values (?, ?, ?)
(org.hibernate.type.LongType) binding '170650' to parameter: 1
(org.hibernate.type.IntegerType) binding '0' to parameter: 2
(org.hibernate.type.ClobType) binding 'something' to parameter: 3
(org.hibernate.SQL) insert into NoteSubstitutions (note, listIndex, substitution) values (?, ?, ?)
(org.hibernate.type.LongType) binding '170650' to parameter: 1
(org.hibernate.type.IntegerType) binding '1' to parameter: 2
(org.hibernate.type.ClobType) binding 'something else' to parameter: 3 
```

如何让它在日志中显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T04:39:36.500

尝试使用：

```
log4j.logger.net.sf.hibernate=DEBUG
log4j.logger.org.hibernate=DEBUG 
```

这是您将获得的最高级别。如果它没有显示您想要的信息，那么这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-11T04:34:26.737

好吧，看起来你不能。*（感谢[Marcio](https://stackoverflow.com/questions/53365/getting-hibernate-to-log-clob-parameters#53419)的建议，但遗憾的是这并没有增加任何有用的东西）*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-14T23:42:05.160

尝试设置 log4j.logger.org.hibernate.type=TRACE 看看是否有帮助。

# ajax - 人们从哪里获得旋转加载图像？

> ID：53370
> 
> 赞同：2
> 
> 时间：2008-09-10T03:28:04.953
> 
> 标签：ajax, image, animation

我一直在这个加载图像上运行

[http://georgia.ubuntuforums.com/images/misc/lightbox_progress.gif](http://georgia.ubuntuforums.com/images/misc/lightbox_progress.gif)

这似乎是在过去 18 个月内开始存在的。突然之间，它出现在每个应用程序中，出现在每个网站上。不想被排除在外，我可以在某个地方获得这个标志，也许是透明背景？还有它是从哪里来的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-10T03:31:06.117

您可以在这里以任何您想要的颜色获得许多不同的 AJAX 加载动画：[ajaxload.info](http://www.ajaxload.info/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-10T03:34:33.020

我相信动画来自 Mac OS X 加载屏幕。这是一个类似的透明背景：

[替代文字 http://homepage.mac.com/xraydoc/.Pictures/spinner.gif](http://homepage.mac.com/xraydoc/.Pictures/spinner.gif)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T04:06:34.503

我认为这只是普通钟面样式加载图标的一般扩展。Firefox [throbber](http://en.wikipedia.org/wiki/Throbber)是我记得遇到的第一个这种风格的例子。这与当前直线趋势之间的唯一真正区别在于，组成符号已被拉伸以呈现更清晰的外观，回到更多的多针时钟标志。

# java - 将 DBMS_APPLICATION_INFO 与 Jboss 一起使用

> ID：53379
> 
> 赞同：1
> 
> 时间：2008-09-10T03:37:33.183
> 
> 标签：java, oracle, jboss

有没有人有如何将[DBMS_APPLICATION_INFO](http://www.oracle-base.com/articles/8i/DBMS_APPLICATION_INFO.php)包与 JBOSS 一起使用的示例？

我们有各种在 JBOSS 中运行并共享数据库池的应用程序。我希望，在每个会话开始时，这些应用程序使用 DBMS_APPLICATION_INFO 向数据库标识自己，以便我可以更轻松地跟踪应用程序的哪些部分导致数据库问题。

我对 JBOSS 中的会话生命周期不太熟悉，但归根结底，需要发生的是在事务的开始和结束时，需要调用这个包。

有没有人这样做过？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T14:43:59.450

如果你使用 JBoss，你可以使用“valid-connection-checker”。此类通常用于检查连接的有效性。但是，由于每次连接池为用户提供连接时都会调用它，因此您可以使用它来设置 DBMS_APPLICATION_INFO。

您在 oracle-ds.xml 中声明这样一个类，如下所示：

```
<local-tx-datasource>
    <jndi-name>jdbc/myDS</jndi-name>
    <connection-url>jdbc:oracle:thin:@10.10.1.15:1521:SID</connection-url>
    <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>
    <security-domain>MyEncryptDBPassword</security-domain>
    <valid-connection-checker-class-name>test.MyValidConn</valid-connection-checker-class-name>
    <metadata>
        <type-mapping>Oracle9i</type-mapping>
    </metadata>
</local-tx-datasource> 
```

你的类必须实现 org.jboss.resource.adapter.jdbc.ValidConnectionChecker 接口。如果您使用 Maven，您可以包含此接口和以下依赖项：

```
<dependency>
    <groupId>jboss</groupId>
    <artifactId>jboss-common-jdbc-wrapper</artifactId>
    <version>3.2.3</version>
    <scope>provided</scope>
</dependency> 
```

这个接口只有一个方法：isValidConnection。我复制我的实现：

```
public SQLException isValidConnection(Connection arg0) {
    CallableStatement statement;
    try {
        statement = arg0.prepareCall("call dbms_application_info.set_client_info('"+getInfos()+"')");
        statement.execute();
    } catch (SQLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return null;
} 
```

希望能帮助到你 ！

贝努瓦

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T05:06:59.677

是的，您可以在连接池周围编写一个包装器类，并在连接周围编写一个包装器，所以假设您有：

```
OracleConnection conn=connectionPool.getConnection("java:scott@mydb");

```

将其更改为：

```
公共类 LoggingConnectionPool 扩展 ConnectionPool{
    public OracleConnection getConnection(String datasourceName, String module, String action){
        OracleConnection conn=getConnection(datasourceName);
        CallableStatement call=conn.preparedCall("开始 dbms_application_info.setModule(module_name => ?, action_name => ?); end;");
        尝试{
            call.setString(1,module);
            call.setString(2,action);
            调用.execute();
        最后{
            调用.close();
        }
        返回新的 WrappedOracleConnection(conn);
    }

```

注意上面 WrappedOracleConnection 的使用。你需要这个，因为你需要捕获关闭电话

```
公共类 WrappedOracleConnection 扩展 OracleConnection{
    公共无效关闭（）{
        CallableStatement call=this.preparedCall("开始 dbms_application_info.setModule(module_name => ?, action_name => ?); end;");
        尝试{
            call.setNull(1,Types.VARCHAR);
            call.setNull(2,Types.VARCHAR);
            调用.execute();
        最后{
            调用.close();
        }
    }

    // 你需要实现所有其他方法
    //例如
    公共 CallableStatement prepareCall（字符串命令）{
        返回 super.prepareCall(command);
    }
    ...
}

```

希望这会有所帮助，我在开发服务器上做了类似的事情来捕获未关闭的连接（未返回到池中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-12T22:02:18.460

在您的*-ds.xml*中，您可以设置一个名为**v$session.program**的连接属性，该属性的值将填充为源自连接池的连接创建的**V$SESSION视图中每个会话的****PROGRAM**列。我通常将它设置为*jboss.server.name*属性。

 ***有关示例，请参见[此处。](http://www.magpiebrain.com/2006/05/09/specifying-a-program-name-in-oracle-jdbc-connections/)

# java - 一些 Tomcat webapps 没有打开

> ID：53387
> 
> 赞同：3
> 
> 时间：2008-09-10T03:51:08.067
> 
> 标签：java, spring, tomcat, web-applications

我下载了几个 webapp 并将它们放在我的 /webapps 文件夹中。其中一些我可以通过去打开`http://localhost:8080/app1`，它会打开。但是，其他一些我会做完全相同的事情并转到`http://localhost:8080/app2`它会显示“HTTP Status 404 - /app2/”，即使我确定它在那里。我已经检查过它是否包含一个 WEB-INF 文件夹，就像 app1 一样，我什至重新启动了 Tomcat 以确保它。

我的问题是：是否有任何东西（可能在 web.xml 文件中）指定启动 webapp 的 URL 必须是什么？还是只是简单的`http://localhost:8080/<folder name>`？

PS如果您想确切知道我指的是什么app1和app2：app1（有效）= [http://assets.devx.com/sourcecode/11237.zip](http://assets.devx.com/sourcecode/11237.zip) app2（无效）= [http://www。 laliluna.de/download/eclipse-spring-jdbc-tutorial.zip](http://www.laliluna.de/download/eclipse-spring-jdbc-tutorial.zip)

我也尝试了其他一些，有些工作，有些没有。我只是想知道我是否遗漏了什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-10T04:58:53.723

我通常通过进入管理器页面并确保所有上下文都已部署（[http://localhost:8080/manager/html](http://localhost:8080/manager/html)）来调试它。

听起来 app2 没有正确部署或由于其他一些错误而没有启动。

我会看日志。那里可能有一堆信息，但通常它解释了什么是坏的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-11T11:31:56.967

您提到的第一个 zip 文件有一个`.war`文件作为 zip 的一部分。第二个只是源代码，它需要构建到一个`.war`文件中。

看起来它已设置为在 Eclipse 中完成。尝试该`File>>Export`选项并选择 War 文件作为导出类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-26T07:48:21.847

The second app (the directory named WebRoot) can also be deployed correctly but you get a 404 by going to it because there is not an "index.jsp" or "index.html" file in the root directory.

Try putting a file there with any of those names, and the 404 is gone.

A servlet mapping in the web.xml is not strictly necessary for this to work.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T04:41:54.543

第二个需要spring框架。我能找到的唯一可运行的东西是一个客户端`eclipse-spring-jdbc-tutorial.zip\SpringJdbc\src\test\de\laliluna\library\TestClient.java`和一个`eclipse-spring-jdbc-tutorial.zip\SpringJdbc\src\de\laliluna\library\sample\MyApplication.java`. 如果你在 eclipse 中打开它（它是一个 eclipse 项目）并编译，只要安装了 Spring 框架，你应该能够运行两者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-16T15:57:16.273

Are you familiar with log4j? Spring puts a lot of often-useful information into the logs created via log4j. When I have a SpringMVC application that won't startup correctly or otherwise isn't running I check my log4j and potentially turn up the Spring log level to INFO or even DEBUG.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-17T16:45:38.707

如果“/”不可访问，则意味着没有“index.html”、“index.jsp”或 web.xml 的欢迎文件列表中定义的任何内容。上下文 ROOT 目录也没有 Servlet-Mapping当下。检查 web.xml 中的 Servlet-Mappings 或尝试找出上下文根中的 jsp/html /... 文件的名称

# .net - 集中/控制 .NET 项目和解决方案的任意构建

> ID：53391
> 
> 赞同：4
> 
> 时间：2008-09-10T03:54:15.640
> 
> 标签：.net, visual-studio, build-automation, projects-and-solutions

多年来，我创建并调整了一组 NAnt 脚本来执行完整的项目构建。主脚本采用单个应用程序端点（例如 Web 应用程序项目）并从源代码控制中对其进行完整的构建。这些脚本预先配置了有关构建输出位置、源代码控制地址等的必要信息。要点是您可以提供很少的信息并从头开始构建给定的项目。这满足了我问题的“任意”部分。

过去，我曾为生产一些软件产品（主要是 Web 应用程序）的公司工作。这种环境非常适合典型的持续集成设置，其中每个产品都有一个集成商。我已经设置了集成器来充当 CI 构建以及集成器来处理完整的发布候选构建和 QA 部署。这些集成器使用主构建脚本，因此集成器本身只不过是源代码控制监控和对主 NAnt 脚本的调用。

我现在为一个创建许多应用程序的开发组工作。通常，开发人员被要求支持最初由其他人构建的应用程序。当我开始时，没有构建管理。作为一个 4 人团队的首席开发人员，我在团队中处于一个特别独特的位置，负责一个业务部门的产品套件（大约六个完整的系统）。我已经使用主构建脚本实现了 CruiseControl.Net，用于执行 CI 构建和 RC 构建。这适用于企业产品套件中的固定项目集。

我已经使用 CCNet 很多年了，所以我完全知道它可以做什么。我非常尊重它对持续集成领域的贡献，因为我将它用于我的产品套件中的所有项目。我已经向我的团队强调，使用官方 RC 构建集成商作为主构建器，用于开发以外的任何位置。这为 CCNet 控制的固定项目集提供了很好的控制。

但是，还有其他开发人员构建其他应用程序。其中一些是 1 个开发人员项目，这些项目在进入项目生命周期之前通常甚至不在源代码控制中（我正在尝试更改其他内容）。其中许多项目都是一次性的，在部署后不会有太多的开发生命。尽管如此，他们仍然需要得到支持。支持这些的一个重要事实是，如果没有对这些项目进行集中构建管理，那么进入 QA 和最终生产的候选发布版本将在单独的开发人员机器上完成。当然，这提供了零保证，即在开发人员机器构建的其他因素中，一切都在源代码控制中。

我一直试图解决的问题是：我可以使用什么样的系统来提供对这些任意构建的集中控制？这绝对不是一个独特的问题。然而，在我所做的关于集中构建、构建自动化和持续集成的大部分阅读中，重点是固定的项目/产品以及支持对它们进行持续开发的任务。不断开发新项目的企业使用哪些类型的流程？他们不使用这些类型的流程吗？

虽然主构建脚本确实存在于构建服务器上，但它们使用起来很笨拙。此外，我更愿意限制对构建服务器的控制台访问。因此，需要一些管理系统来提供更轻松的访问权限，以便在中央系统上启动任意构建。

我意识到我正在寻找的东西可能隐藏在 MS Team Build 的掩护下。不幸的是，每当我开始阅读它时，当我开始进入 MS 营销材料并很快迷失方向时，我就会有一种流沙的感觉，从来没有真正发现我想做的事情是否可以用它来完成。此外，在过去有关 Team Foundation Server 和 Team System 主题的一些一般性讨论中，许可成本已被视为可能的阻碍因素。

我很想听听任何解决了这个问题的人的意见，他们可能会提供建议。我已经围绕我的主“构建任何项目”构建脚本在集中构建系统上做了一些工作。然而，我所拥有的还处于起步阶段，主要是为了支持我所从事的项目类型。目前缺乏处理许多应用程序类型或使用 Visual Studio 可能的大量项目/解决方案配置所需的支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T09:26:42.707

The biggest problem I see with a central build system is that even with the best will in the world tools will diverge between teams or over time.

I favour designing any build system for a particular project such that it requires checking out a single module eg. MyProjectBuildEnvironment and then running a single script in a very tool neutral manner e.g. on a windows system build.bat

Where possible all tools used by the build environment should be runnable simply by checking out the module MyProjectBuildEnvironmen rather than requiring machine level installers.

These two constraints will not impede the freedoms of teams to use the tools that they prefer at a given time.

The central build system can then be a simple system that checks out one module per project and simply executes the build.bat file. You could call it a meta build system.

To be honest it would probably be overkill as a simple wiki describing the build module name for each project would be enough to allow anyone to checkout that one module and kick it off by the common build.bat command.

As a final note the script for starting the build should always examine the environment and tell the user if any tools are missing or any machine configuration needs to be tweaked to successfully complete the build.

# c# - 从泛型类继承时需要 T 的列表或枚举数的建议

> ID：53395
> 
> 赞同：2
> 
> 时间：2008-09-10T04:03:08.257
> 
> 标签：c#, generics

我知道答案不会很简单，而且我已经使用了几个（我认为丑陋的）结块。我只是在寻找一些优雅的答案。

抽象类：

```
public interface IOtherObjects;

public abstract class MyObjects<T> where T : IOtherObjects
{
   ...

   public List<T> ToList()
   {
       ...
   }
} 
```

孩子们：

```
public class MyObjectsA : MyObjects<OtherObjectA> //(where OtherObjectA implements IOtherObjects)
{

}

public class MyObjectsB : MyObjects<OtherObjectB> //(where OtherObjectB implements IOtherObjects)
{

} 
```

是否有可能循环遍历 MyObjects 的集合（或其他类似的分组，通用或其他），然后使用*MyObjects基类的**ToList*方法，因为此时我们不具体知道 T 的类型。

 ***编辑** 至于具体的例子，每当这个问题出现时，我已经考虑了一段时间，而是做了一些不同的事情，所以目前没有要求。但由于它经常出现，我想我会浮动它。

**编辑** @Sara，这不是我关心的集合的具体类型，它可能是一个List，但每个实例的ToList方法仍然相对不可用，没有匿名类型）

@aku，是的，这个问题可能是相对假设的，但是能够检索并使用 T 对象列表，只知道它们的基本类型将非常有用。让 ToList 返回 BaseType 列表是我的解决方法之一

**编辑**@全部：到目前为止，这是我所希望的那种讨论，尽管它在很大程度上证实了我所怀疑的一切。到目前为止，谢谢大家，但其他任何人，请随时输入。

**编辑**@Rob，是的，它适用于已定义的类型，但不适用于该类型仅称为 IOtherObjects 列表。

@Rob**再次**感谢。这通常是我笨拙的解决方法（没有不尊重:)）。或者使用 ConvertAll 函数通过委托进行向下转换。感谢您花时间了解问题。

**合格的编辑**，以防我有点困惑

更准确地说，（我可能让我最新的实现变得太复杂了）：

假设我有 2 个对象类型，B 和 C 从对象 A 继承。

许多场景已经出现在哪里，从 B 列表或 C 列表，或者在其他情况下是其中之一的列表 - 但我不知道如果我在基类中，我需要一个不太具体的列表一种。

*上面的例子是List Of Less Specific*问题最新版本的一个淡化例子。

通常它已经呈现出来，因为我认为可能的场景会限制需要编写的代码量，并且看起来比其他选项更优雅一些。我真的很想讨论可能性和其他观点，我或多或少地得到了这些。我很惊讶到目前为止没有人提到 ConvertAll()，因为这是我使用的另一种解决方法，但对于手头的场景来说有点过于冗长

@Rob **Yet Again**和 Sara

谢谢，但是我确实觉得我理解泛型的所有静态上下文荣耀，并且确实理解了这里的问题。

我们系统的实际设计和泛型的使用（我可以这样说没有一点偏见，因为我只是设计中的参与者之一），已经做得很好。当我一直在使用核心 API 时，我发现我在错误的范围内简单地做某事，相反我不得不以比我喜欢的更不优雅的方式处理它们（尝试要么聪明或者可能是懒惰的——我会接受这些标签中的任何一个）。

我对我所说的 cludge 的厌恶主要是因为我们需要对记录集进行循环，只是为了将对象转换为它们的基本值，这可能会影响性能。

我想我想知道以前是否有人在他们的编码中遇到过这种情况，是否有人在处理它时比我更聪明，或者至少更优雅。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T04:10:58.407

在您的情况下， MyObjectsA 和 MyObjectsB 没有共同的前任。泛型类是*不同*类的模板，而不是通用基类。如果您想在不同的类中拥有共同的属性，请使用接口。您不能在循环中调用*ToList*，因为它在不同的类中具有不同的签名。您可以创建返回*对象*而不是特定类型的 ToList。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T04:12:21.573

为什么你有 MyObjects 的集合？您没有列表是否有特定原因？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T04:17:53.867

您可能仍然可以访问 ToList() 方法，但由于您不确定类型，这不可行吗？

```
foreach(var myObject in myObjectsList)
    foreach(var obj in myObject.ToList())
        //do something 
```

当然，这只适用于 C# 3.0。

请注意，使用 var 只是为了消除知道列表包含什么类型的要求；与弗兰克的评论相反，我认为 var 会使打字变得动态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T05:02:47.473

好的，我很困惑，下面的代码对我来说很好（好奇心让我变得更好！）：

```
// Original Code Snipped for Brevity - See Edit History if Req'd 
```

还是我错过了什么？

## 更新以下来自 OP 的响应

好的，现在我真的很困惑..您的意思是您想从通用/抽象列表中获取*类型值列表？*（因此子类变得无关紧要）。

如果类型是子/接口实现者，则不能返回类型列表 - 它们不匹配！您当然可以从抽象列表中获取特定类型的项目列表，如下所示：

```
 public List<OfType> TypedList<OfType>() where OfType : IOtherObjects
    {
        List<OfType> rtn = new List<OfType>();

        foreach (IOtherObjects o in _objects)
        {
            Type objType = o.GetType();
            Type reqType = typeof(OfType);

            if (objType == reqType)
                rtn.Add((OfType)o);
        }

        return rtn;
    } 
```

如果我仍然不在基地，你能改写你的问题吗？！（看来我不是唯一一个不确定你在开什么车的人）。我正在尝试确定您是否对泛型有误解。

## 另一个更新：D

对，所以看起来你想要/需要获取类型列表的选项，或者基本列表是的？

这将使您的抽象类看起来像这样 - 您可以使用 ToList 获取具体类型，或使用 ToBaseList() 获取接口类型的 List。这应该适用于您拥有的任何场景。这有帮助吗？

```
public abstract class MyObjects<T> where T : IOtherObjects
{
    List<T> _objects = new List<T>();

    public List<T> ToList()
    {
        return _objects;
    }

    public List<IOtherObjects> ToBaseList()
    {
        List<IOtherObjects> rtn = new List<IOtherObjects>();
        foreach (IOtherObjects o in _objects)
        {
            rtn.Add(o);
        }
        return rtn;
    }
} 
```

## 更新#3

这不是一个真正的“笨拙”的解决方法（没有不尊重） - 这是唯一的方法。我认为这里更大的问题是设计/grok问题。你说你有问题，这段代码解决了它。但是，如果您希望执行以下操作：

```
public abstract class MyObjects<T> where T : IOtherObjects
{
    List<T> _objects = new List<T>();

    public List<IOtherObjects> Objects
    { get { return _objects; } }
}
#warning This won't compile, its for demo's sake. 
```

并且能够挑选出来的类型，你还能*怎么*做？！我觉得您并不真正了解泛型的意义，并且您正试图让他们做一些他们不是为之设计的事情！？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T15:27:57.177

如果你有

```
class B : A
class C : A 
```

你有

```
List<B> listB;
List<C> listC; 
```

您希望将其视为父类型的列表

那么你应该使用

```
List<A> listA = listB.Cast<A>().Concat(listC.Cast<A>()).ToList() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T23:31:05.323

我最近发现

```
List<A>.Cast<B>().ToList<B>() 
```

图案。

它完全符合我的要求，

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-10T04:39:02.367

泛型用于静态时间类型检查**而不是**运行时调度。使用继承/接口进行运行时调度，使用泛型进行编译时类型保证。

```
interface IMyObjects : IEnumerable<IOtherObjects> {}
abstract class MyObjects<T> : IMyObjects where T : IOtherObjects {}

IEnumerable<IMyObjects> objs = ...;
foreach (IMyObjects mo in objs) {
    foreach (IOtherObjects oo in mo) {
        Console.WriteLine(oo);
    }
} 
```

（显然，我更喜欢枚举而不是列表。）

**或者**只需使用适当的动态语言，如 VB。:-)

# c# - 用 C# 编写的托管 OleDB 提供程序

> ID：53404
> 
> 赞同：5
> 
> 时间：2008-09-10T04:13:38.870
> 
> 标签：c#, com, oledb

OleDB 提供程序是由 Microsoft 提供的实现 COM 接口的二进制文件。由此看来，似乎可以使用 C# 创建提供程序。那是对的吗？有样品证明吗？如果没有，你会阻止我这样做吗？我看到有多个非托管样本，但我找不到任何托管样本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-06-14T17:30:49.347

这篇文章很好，但实际上并没有回答这个问题。OLEDB 是一组 COM 接口，实际上可以通过 COM Interop 在 .Net 中实现，尽管我从未听说过这样的实现并且可能不建议使用。

[Microsoft在此处](http://msdn.microsoft.com/en-us/library/ms709709%28v=VS.85%29.aspx)记录了 OLEDB 接口集。OLEDB 是一个复杂的话题，并非所有接口都需要实现功能提供程序。更糟糕的是，不同的 OLEDB 客户端具有使用提供程序所需的一组接口。例如，这里列出了使用 .Net OLEDB 客户端 (System.Data.OleDb.*) 中的提供程序必须实现的必需[接口列表。](http://msdn.microsoft.com/en-us/library/cwctxe7a%28v=vs.71%29.aspx)注意：我没有找到 2.0 Framework 或更高版本的此类链接。最后值得注意的是，实现提供者非常困难，微软后来提供了一组 ATL 模板 (C++) 来帮助实现者正确地做到这一点。

要了解有关 OLEDB 的更多信息，我绝对建议您查看 MSDN 上的[Windows 数据访问 SDK](http://msdn.microsoft.com/en-us/library/aa968814%28v=VS.85%29.aspx)。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2008-09-10T04:48:12.173

我不确定我是否真的理解你的问题？！已经*有*一个托管的 OleDBProvider 了？！

```
using System.Data.OleDb; 
```

我当然不鼓励编写一个存在并且工作得很好的提供者！:)

但在回答您的第一个问题时，您当然可以创建自己的问题。[数据提供者路线图](http://support.microsoft.com/kb/313480)可能是开始概述和链接到示例等的好地方。

# actionscript-3 - wav <> mp3 for flash(as3)

> ID：53411
> 
> 赞同：5
> 
> 时间：2008-09-10T04:21:42.360
> 
> 标签：actionscript-3, mp3, decode, shockwave

我想知道 MP3 解码/编码，我希望使用 AS3 在 Flash 中实现这一点

我敢肯定，这将是一个正确的痛苦...

我不知道从哪里开始，任何人都可以提供任何指示吗？参考资料？

----很久以后--- 非常感谢大家的意见...看来我还有很长的路要走！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T22:19:43.087

理论上，您也可以将其用作 PixelBender 过滤器，并且应该比使用纯 ActionScript 3 实现获得更好的性能。

此处有关 PixelBender 的更多信息：

[http://labs.adobe.com/wiki/index.php/Pixel_Bender_Toolkit](http://labs.adobe.com/wiki/index.php/Pixel_Bender_Toolkit)

迈克室

网格@adobe.com

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-01T10:39:05.677

这将有助于 [http://labs.adobe.com/technologies/alchemy/](http://labs.adobe.com/technologies/alchemy/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T04:40:46.980

请参阅[LAME MP3 编码器](http://lame.sourceforge.net/)。您可以查看他们的源代码和他们的[链接页面](http://lame.sourceforge.net/links.php)。[Mpeg.org](http://www.mpeg.org/)也应该有文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T22:56:16.040

我有一个项目将 WAV 文件（实际上是 Asterisk 语音邮件）转换为 MP3。如果我没记错的话，关于 Lame 的许可证有一些奇怪的地方，所以我先下载并编译了[LAME](http://sourceforge.net/projects/lame/)，然后手动编译了[SOX](http://sourceforge.net/projects/sox/)。

我有一个用 PHP 编写的 Web 进程，用于在 Web 服务器的本地文件系统上将文件从 WAV 实际转换为 MP3（实际上 PHP 只是通过 监督命令行 sox 工具`exec()`）。[然后我使用PEAR Mp3_Id](http://pear.php.net/package/MP3_ID)包附加 MP3 所需的所有元数据。

然后我将新建的 MP3 文件移动到 Apache 共享的文件夹中，并将出色的[SoundManager2](http://www.schillmania.com/projects/soundmanager2)基于 Flash 的 MP3 播放器指向它。

对于小型交易，这非常有效——转换一两分钟的语音邮件不会给实际呈现和返回页面的其余部分增加任何明显的延迟。随着我在单个服务器上获得更多用户，最终可能需要编写一个 cron 作业或其他东西来进行转换，然后用户第一次真正请求文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T08:31:24.880

在 AS3 中这样做会**非常慢。**如果您完全关心需要多长时间，您真的需要一个 C/C++ 实现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T13:02:39.067

Andre Michelle 和 Hobnox 的人用他们的 Hobnox AudioTool 实现了类似的功能，他们将[Java Vorbis 编码器移植到了 AS3](http://blog.andre-michelle.com/2008/first-audiotool-live-recorded-vorbis-encoded-session/)。据推测，他们最终的编码时间是音频持续时间的两倍。

不知道您的用例是什么，但在 Hobnox 工具中，显然音频是在客户端创建的，编码为 Vorbis，发送到服务器，转换为 mp3 并存储在用户库中。

# c# - NHibernate 或 LINQ to SQL

> ID：53417
> 
> 赞同：12
> 
> 时间：2008-09-10T04:38:19.637
> 
> 标签：c#, .net, linq, nhibernate, linq-to-sql

如果开始一个新项目，你会为你的 ORM NHibernate 或 LINQ 使用什么以及为什么。各有什么优缺点。

编辑：LINQ to SQL 不仅仅是 LINQ（感谢@Jon Limjap）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-10T04:45:41.680

我问过自己一个非常相似的问题，除了我考虑的不是 NHibernate，而是我认为非常好的 WilsonORM。

在我看来，有许多重要的区别。

林克：

*   不是一个完整的 ORM 工具（你可以使用一些额外的库，比如最新的 Entity 框架——我个人认为，与其他 ORM 框架相比，MS 的这项最新技术的架构大约有 10 年的历史）
*   主要查询支持智能感知的“语言”（编译器将检查查询的语法）
*   主要用于 Microsoft SQL Server
*   是闭源的

休眠：

*   是ORM工具
*   没有智能感知的查询语言非常有限
*   几乎可以与您拥有 DB 提供程序的任何 DBMS 一起使用
*   是开源的

这真的取决于。如果您开发一个 Rich (Windows) 桌面应用程序，您需要在其中构造对象、使用它们并最终保留它们的更改，那么我会推荐像 NHibernate 这样的 ORM 框架。

如果您开发的 Web 应用程序通常只查询数据，并且只是偶尔将一些数据写回数据库，那么我会推荐像 Linq 这样好的查询语言。

所以一如既往，这取决于。:-)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-10T04:41:36.290

错误... [NHibernate 有 LINQ](http://www.ayende.com/Blog/archive/2007/03/17/Implementing-Linq-for-NHibernate-A-How-To-Guide--Part.aspx)。

也许您的意思是使用哪个：

*   LINQ 到 SQL
*   休眠

我更喜欢NHibernate。

LINQ to SQL 相当轻量级，但它与您的数据结构的耦合更紧密一些，而 NHibernate 在可以映射到表结构的对象定义类型方面非常灵活。

当然，这并不是说 LINQ to SQL 没有用处：这个网站使用它。我相信在数据库模式不是那么庞大的小型应用程序中启动和运行非常有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-02T16:21:50.643

从 NHibernate 开始是一个坏主意。它只有通过巧妙的设置才能显示出良好的性能。尝试将 EFv4 用于大型项目，将 L2S（可能是第 3 部分产品）用于中小型项目。这些产品比 NHibernate 更方便灵活，让您快速上手。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-25T09:43:17.410

不是完整的清单

LinqToSQL Pro：

*   更好的工具支持
*   好的 linq 提供商
*   当 db-schema == classes 时很容易开始 -

缺点：

*   不灵活（即 db-schema ！= 类）
*   仅支持 MS SQL Server
*   没有级联（保存，更新......不级联到引用的对象）

NHibernate Pro：

*   很多 rdbms 支持 ootb
*   功能丰富
*   对于几乎所有角落情况都非常灵活
*   开源

缺点：

*   不太容易开始
*   不是来自 MS
*   有很多工具，但你必须搜索

在 2 个 ORM 之间

如果出现以下情况，我会选择 LinqToSql：

*   db-schema == 类
*   只使用 MS SQL Server
*   商店只允许 MS-Products

如果出现以下情况，我会选择 Nhibernate：

*   更丰富的对象模型
*   遗留数据库模式
*   MS SQL Server 以外的数据库或支持多个
*   性能至关重要（我认为 NH 比 LinqToSql 具有更多优化性能的功能）

注意：这是我个人的看法。我主要处理（疯狂的）遗留数据库和复杂的 ETL 作业，其中对象模型对 SQL 有很大帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-06T22:24:58.423

我不使用（甚至不知道）NHibernate，我只想作证：我使用 LINQ to SQL 大约 2 年以来使用 MySQL 和 PostgreSQL 数据库（在 Windows 上使用[DbLinq](http://code.google.com/p/dblinq2007/) ，在 Linux 和 Mac OS X 上使用 Mono）[。](http://www.mono-project.com/)

因此 LINQ to SQL 不仅限于 Microsoft 产品。

我可以确认 LINQ to SQL 非常适合中小型项目，或者您可以完全控制数据库结构的大型项目。正如评论所表明的那样，LINQ to SQL 有一些限制，当数据库表和实体类之间没有直接映射时，使其成为不合适的工具。

注意：LINQ to SQL 不支持多对多关系（但这可以通过几行代码轻松实现）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-27T14:58:12.223

The main drawback of NHibernate is the inability to make use of **method calls**. They cannot be translated to SQL. To circumvent that, you have to recreate expression trees which is difficult to do.

# c - C的内存泄漏检测器？

> ID：53426
> 
> 赞同：33
> 
> 时间：2008-09-10T04:47:57.697
> 
> 标签：c, debugging, memory, memory-leaks

人们对哪些内存泄漏检测器有很好的体验？

以下是迄今为止的答案摘要：

[Valgrind](http://valgrind.org/) - 用于构建动态分析工具的仪器框架。

[Electric Fence](http://directory.fsf.org/project/ElectricFence/) - 与 GDB 一起使用的工具

[Splint](http://splint.org/) - 注释辅助的轻量级静态检查

[Glow Code](http://www.glowcode.com/) - 这是一个完整的实时性能和内存分析器，适用于使用 C++、C# 或任何 .NET Framework 开发应用程序的 Windows 和 .NET 程序员

另请参阅此[stackoverflow 帖子](https://stackoverflow.com/questions/45627/how-do-you-detectavoid-memory-leaks-in-your-unmanaged-code)。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-10T05:01:09.223

第二个[valgrind](http://valgrind.org/) ...我会添加[电围栏](http://directory.fsf.org/project/ElectricFence/)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-10T04:50:10.967

[linux](http://valgrind.org/)下的valgrind还算不错；我在 Windows 下没有这方面的经验。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-25T21:37:19.147

如果您有钱：[IBM Rational Purify](http://www-01.ibm.com/software/awdtools/purify/)是一个非常强大的 C/C++ 行业内存泄漏和内存损坏检测器。适用于 Windows、Solaris 和 Linux。如果您只使用 linux 并且想要一个便宜的解决方案，请选择 Valgrind。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-10T01:15:04.547

[gcc](http://gcc.gnu.org/wiki/Mudflap_Pointer_Debugging)的挡泥板！它实际上将检查编译到可执行文件中。只需添加

```
-fmudflap -lmudflap 
```

到你的 gcc 标志。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T04:59:06.327

lint（非常相似的开源工具，称为[splint](http://splint.org/)）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-10T05:19:06.653

很痛苦，但如果你必须使用一个。
我推荐[DevPartner BoundsChecker](http://www.borland.com/products/devpartner/read/)套件。这就是我工作场所的人们为此目的使用的。付费n专有..不是免费软件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-11T19:22:37.723

如果您在使用 glibc 的 Linux 上也值得使用内置调试堆代码。要使用它，请与**-lmcheck**链接或定义（并导出）值为 1、2 或 3 的**MALLOC_CHECK_环境变量。glibc**[手册提供了更多信息。](http://www.gnu.org/software/libtool/manual/libc/Heap-Consistency-Checking.html)

这种模式对于检测双重释放最有用，它经常在释放时发现分配的内存区域之外的写入。我认为它不会报告内存泄漏。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-18T15:28:01.020

[我对cppcheck](http://sourceforge.net/apps/mediawiki/cppcheck/index.php?title=Main_Page#Cppcheck_-_A_tool_for_static_C.2FC.2B.2B_code_analysis)有很多成功，它只进行静态分析。它是开源的并且有一个命令行界面（我没有以任何其他方式使用它）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-10T04:52:19.637

我对任何内存泄漏检测器的喜爱都很少。通常有太多的误报，它们没有任何用处。我会推荐这两个作为干扰最小的：

[发光代码](http://www.glowcode.com/)

[调试堆](http://msdn.microsoft.com/en-us/library/974tc9t1(VS.80).aspx)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-11T04:25:26.477

对于内存泄漏的 Win32 调试，我对普通的旧 CRT 调试堆有很好的体验，它作为 Visual C 的库提供。

在 Debug 构建中 malloc (et al) 被重新定义为 _malloc_dbg (et al) 并且还有其他调用来检索结果，如果未设置 _DEBUG，这些调用都是未定义的。它在堆上设置了各种边界守卫，并允许您随时显示结果。

在我发现 _CRT_BLOCK 之前，当我发现一些时间例程与库运行时分配混淆时，我遇到了一些误报。

我必须生产第一个 DOS，然后是 Win32 控制台和可以永远运行的服务。据我所知，没有内存泄漏，并且在 PC 上的监视器出现故障之前，至少有一个地方的代码在无人看管的情况下运行了两年（尽管 PC 很好！）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-11T14:45:06.987

在 Windows 上，我使用了[Visual Leak Detector](http://vld.codeplex.com)。与 VC++ 集成，易于使用（只需包含一个头文件并设置 LIB 即可找到该库），开源，免费使用 FTW。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-10T05:46:47.197

在大学里，当我在 Unix Solaris 下做大部分事情时，我使用[gdb](http://www.gnu.org/software/gdb/)。

但是我会在 Linux 下使用[valgrind 。](http://valgrind.org/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T21:13:12.277

这些工具的鼻祖是商业的、封闭源代码的[Purify](http://unicomsi.com/products/purifyplus/)工具，它卖给了 IBM，然后卖给了 UNICOM

Parasoft 的[Insure++](http://en.wikipedia.org/wiki/Insure%2B%2B)（源代码检测）和 valgrind（开源）是另外两个真正的竞争对手。

琐事：Purify 的原作者 Reed Hastings 继续创立了 NetFlix。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-10-07T05:47:13.297

没有人提到[clang 的 MSan](http://clang.llvm.org/docs/MemorySanitizer.html)，它非常强大。不过，它仅在 Linux 上得到官方支持。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-11-03T17:43:39.713

这个问题可能很老，但无论如何我都会回答 - 也许我的回答会帮助某人找到他们的内存泄漏。

这是我自己的项目 - 我把它作为开源代码：

[https://sourceforge.net/projects/diagnostic/](https://sourceforge.net/projects/diagnostic/)

支持 Windows 32 和 64 位平台，支持本机和混合模式调用堆栈。

不支持 .NET 垃圾回收。（C++ cli 的 gcnew 或 C# 的 new）

它是高性能工具，并且不需要任何集成（除非你真的想集成它）。

完整的手册可以在这里找到：

[http://diagnostic.sourceforge.net/index.html](http://diagnostic.sourceforge.net/index.html)

不要害怕它实际检测到多少泄漏它你的过程。它从整个过程中捕获内存泄漏。只分析最大的泄漏，而不是全部。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-09-10T18:38:42.237

我将把 valgrind 作为内存泄漏的外部工具。
但是，对于我必须解决的大多数问题，我总是使用内部构建的工具。有时，外部工具的开销太大或设置起来太复杂。

当您可以编写自己的代码时，为什么要使用已经编写的代码:)

我开玩笑，但有时你需要一些简单的东西，自己写会更快。通常我只是用可以更好地跟踪谁分配什么的函数替换对 malloc() 和 free() 的调用。我的大部分问题似乎是有人忘记释放，这有助于解决这个问题。

这实际上取决于泄漏的位置，如果您知道这一点，那么您将不需要任何工具。但是，如果您对自己认为泄漏的位置有所了解，那么请使用您自己的仪器，看看它是否对您有帮助。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2012-06-26T07:36:52.497

我们的[CheckPointer](http://www.semanticdesigns.com/Products/MemorySafety)工具可以为 GNU C 3/4 和 MS 方言 C 和 GreenHills C 做到这一点。它可以找到 Valgrind 无法找到的内存管理问题。

如果您的代码只是泄漏，退出 CheckPointer 将告诉您所有未释放的内存分配在哪里。

# python - 有哪些好的 Python ORM 解决方案？

> ID：53428
> 
> 赞同：232
> 
> 时间：2008-09-10T04:49:32.667
> 
> 标签：python, orm

我正在评估并考虑将 CherryPy 用于一个项目，该项目基本上是来自客户端（浏览器）的 JavaScript 前端，它与后端的 Python Web 服务通信。所以，我真的需要一些快速和轻量级的后端，我可以使用 Python 实现，然后通过 ORM（JSON 到浏览器）与 PostgreSQL DB 对话。

我也在看我喜欢的 Django，因为它的 ORM 是内置的。但是，我认为 Django 可能比我真正需要的要多一点（即比我真正需要的功能更多 == 更慢？）。

任何人都对不同的 Python ORM 解决方案有任何经验，可以比较和对比它们的特性和功能、速度、效率等吗？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2011-09-16T02:58:48.330

如果您正在寻找轻量级并且已经熟悉 django 风格的声明式模型，请查看 peewee： [https ://github.com/coleifer/peewee](https://github.com/coleifer/peewee)

例子：

```
import datetime
from peewee import *

class Blog(Model):
    name = CharField()

class Entry(Model):
    blog = ForeignKeyField(Blog)
    title = CharField()
    body = TextField()
    pub_date = DateTimeField(default=datetime.datetime.now)

# query it like django
Entry.filter(blog__name='Some great blog')

# or programmatically for finer-grained control
Entry.select().join(Blog).where(Blog.name == 'Some awesome blog') 
```

查看[文档](http://peewee.readthedocs.org/en/latest/)以获取更多示例。

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2008-09-10T13:37:05.410

SQLAlchemy 功能更全面，功能更强大（使用 DataMapper 模式）。Django ORM 具有更简洁的语法并且更易于编写（ActiveRecord 模式）。我不知道性能差异。

SQLAlchemy 还有一个[声明层](http://docs.sqlalchemy.org/en/rel_0_9/orm/extensions/declarative/index.html)，它隐藏了一些复杂性，并为其提供了一种更类似于 Django ORM 的 ActiveRecord 样式的语法。

我不会担心 Django “太重”。它已经足够解耦，您可以根据需要使用 ORM，[而无需导入其余部分](https://stackoverflow.com/a/2180431/623735)。

也就是说，如果我已经将 CherryPy 用于 Web 层并且只需要一个 ORM，我可能会选择 SQLAlchemy。

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2008-12-21T18:36:20.770

[Storm](https://storm.canonical.com/)可以说是最简单的 API：

```
from storm.locals import *

class Foo:
    __storm_table__ = 'foos'
    id = Int(primary=True)

class Thing:
    __storm_table__ = 'things'
    id = Int(primary=True)
    name = Unicode()
    description = Unicode()
    foo_id = Int()
    foo = Reference(foo_id, Foo.id)

db = create_database('sqlite:')
store = Store(db)

foo = Foo()
store.add(foo)
thing = Thing()
thing.foo = foo
store.add(thing)
store.commit() 
```

当您需要时，它可以轻松地进入原始 SQL：

```
store.execute('UPDATE bars SET bar_name=? WHERE bar_id like ?', []) 
store.commit() 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-09-10T15:02:58.310

我通常使用[SQLAlchemy](http://www.sqlalchemy.org/)。它非常强大，可能是最成熟的python ORM。

如果您打算使用 CherryPy，您还可以研究由 Robert Brewer（目前 CherryPy 项目负责人）编写的 dejavu [。](http://www.aminus.net/dejavu)我个人没有使用过它，但我确实知道一些喜欢它的人。

[SQLObject](http://www.sqlobject.org)比 SQLAlchemy 更易于使用 ORM，但它的功能并不那么强大。

就个人而言，除非我打算用 Django 编写整个项目，否则我不会使用 Django ORM，但这只是我。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-01-02T17:56:37.930

SQLAlchemy 的[声明](http://docs.sqlalchemy.org/en/rel_0_9/orm/extensions/declarative.html)式扩展在 0.5 中成为标准，提供了一个与 Django 或 Storm 非常相似的多合一接口。它还与使用 datamapper 样式配置的类/表无缝集成：

```
Base = declarative_base()

class Foo(Base):
    __tablename__ = 'foos'
    id = Column(Integer, primary_key=True)

class Thing(Base):
    __tablename__ = 'things'

    id = Column(Integer, primary_key=True)
    name = Column(Unicode)
    description = Column(Unicode)
    foo_id = Column(Integer, ForeignKey('foos.id'))
    foo = relation(Foo)

engine = create_engine('sqlite://')

Base.metadata.create_all(engine)  # issues DDL to create tables

session = sessionmaker(bind=engine)()

foo = Foo()
session.add(foo)
thing = Thing(name='thing1', description='some thing')
thing.foo = foo  # also adds Thing to session
session.commit() 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-09-11T03:44:54.017

我们将[Elixir](http://elixir.ematia.de/trac/wiki)与 SQLAlchemy 一起使用，并且到目前为止一直很喜欢它。Elixir 在 SQLAlchemy 之上放置了一层，使其看起来更像“ActiveRecord 模式”计数器部件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-03-21T23:29:54.587

这似乎是 Python 中高级数据库交互的规范参考点： [http ://wiki.python.org/moin/HigherLevelDatabaseProgramming](http://wiki.python.org/moin/HigherLevelDatabaseProgramming)

从那里看，[Dejavu](http://www.aminus.net/dejavu)似乎在 Python 中相当抽象地实现了 Martin Fowler 的 DataMapper 模式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T04:56:53.757

我想你可能会看：

[秋天](http://autumn-orm.org/)

[风暴](https://storm.canonical.com/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T06:41:09.030

无法想象 Django 中未使用的功能会降低性能。如果您决定升级项目，可能会派上用场。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-02-05T18:28:40.360

我在一个小项目中使用了 Storm + SQLite，并且对它非常满意，直到我添加了多处理。尝试从多个进程中使用数据库会导致“数据库已锁定”异常。我切换到 SQLAlchemy，同样的代码没有问题。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-03-24T19:37:47.357

SQLAlchemy 非常非常强大。但是，它不是线程安全的，请确保在线程池模式下使用cherrypy 时牢记这一点。

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2008-09-10T05:19:34.780

我会检查[SQLAlchemy](http://www.sqlalchemy.org/)

它非常易于使用，并且您使用的模型一点也不差。~~Django 将 SQLAlchemy 用于它的 ORM~~，但单独使用它可以让您充分利用它。

这是一个关于创建和选择 orm 对象的小例子

```
>>> ed_user = User('ed', 'Ed Jones', 'edspassword')
>>> session.add(ed_user)
>>> our_user = session.query(User).filter_by(name='ed').first() 
>>> our_user
    <User('ed','Ed Jones', 'edspassword')> 
```

# c# - 获取 IIS 工作进程崩溃转储

> ID：53435
> 
> 赞同：9
> 
> 时间：2008-09-10T04:52:58.557
> 
> 标签：c#, asp.net, multithreading, debugging, iis

我在我的 ASP.NET 应用程序中做错了事。它可能是我正在使用的任意数量的 CTP 库，或者我只是没有正确处理某些东西。但是当我将我的 ASP.NET 重新部署到我的 Vista IIS7 安装或我的服务器的 IIS6 安装时，我会崩溃一个 IIS 工作进程。

我已将问题缩小到我的 HTTP 爬虫，它是一个多线程的野兽，它会在被要求时爬取网站以获取有用的信息。在我启动爬虫并重新部署应用程序后，而不是优雅地卸载 appDomain 并重新加载，IIS 工作进程将崩溃（弹出崩溃消息）并继续重新加载应用程序域。

发生此崩溃时，我在哪里可以找到崩溃转储进行分析？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-15T20:29:59.543

下载适用于 Windows 的调试工具：http: [//www.microsoft.com/whdc/DevTools/Debugging/default.mspx](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx)

Windows 调试工具有一个脚本 (ADPLUS)，允许您在进程崩溃时创建转储：http: [//support.microsoft.com/kb/286350](http://support.microsoft.com/kb/286350)

该命令应该类似于（如果您使用的是 IIS6）：

```
cscript adplus.vbs -crash -pn w3wp.exe 
```

此命令会将调试器附加到工作进程。当崩溃发生时，它将生成一个转储（一个 *.DMP 文件）。

您可以在 WinDBG 中打开它（也包含在 Windows 调试工具中）。文件 > 打开故障转储...

默认情况下，WinDBG 将显示（在命令行旁边）进程崩溃的线程。

在 WinDBG 中需要做的第一件事是加载 .NET Framework 扩展：

```
.loadby sos mscorwks 
```

然后，您将显示托管调用堆栈：

```
!clrstack 
```

如果线程没有运行托管代码，那么您需要检查本机堆栈：

```
kpn 200 
```

这应该会给你一些想法。要继续进行故障排除，我建议您阅读以下文章：

[http://msdn.microsoft.com/en-us/library/ee817663.aspx](http://msdn.microsoft.com/en-us/library/ee817663.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T05:14:30.363

快速搜索发现[IISState](http://www.iisfaq.com/default.aspx?view=P197) - 它依赖于[Windows 调试工具](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)，需要在发生崩溃时运行，但鉴于您描述的情况，这应该不是问题，

# c# - 是否可以对进行 P/Invoke 调用的类进行单元测试？

> ID：53439
> 
> 赞同：8
> 
> 时间：2008-09-10T04:55:21.780
> 
> 标签：c#, unit-testing, unmanaged, impersonation

我想将一段使用 Windows Impersonation API 的代码包装到一个简洁的小助手类中，并且像往常一样，我正在寻找一种先测试的方法。但是，虽然 WindowsIdentity 是一个托管类，但作为另一个用户实际执行登录所需的 LogonUser 调用是 advapi32.dll 中的非托管函数。

我想我可以通过为我的助手类引入一个接口来使用并在实现中隐藏 P/Invoke 调用来解决这个问题，但是测试该实现仍然是一个问题。并且您可以想象在测试中实际执行模拟可能会有点问题，因为用户实际上需要存在于系统中。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-10T05:12:00.897

*准则：不要测试你没有写过的代码。*
您不应该担心 WinAPI 实现不起作用（很可能它按预期工作）。您关心的应该是测试“接线”，即您的代码是否进行了正确的 WinAPI 调用。在这种情况下，您只需要模拟接口并让模拟框架告诉您调用是否使用正确的参数进行。如果是，你就完成了。

*   创建 IWinAPIFacade（使用相关的 WinAPI 方法）并实现 CWinAPIFacade。
*   编写一个插入模拟 IWinAPIFacade 的测试并验证是否进行了适当的调用
*   编写测试以确保创建 CWinAPIFacade 并将其作为默认值插入（正常运行）
*   实现 CWinAPIFacade，它只是对 Platform Invoke 调用进行盲委托——无需自动测试这一层。只需进行手动验证。希望这不会经常改变，并且没有任何问题。如果您发现它*在*将来会发生，请通过一些测试来阻止它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T05:14:38.240

我不确定我是否关注您..您不想自己测试 PInvoke（您没有编写它）所以您想测试包装类是否按预期执行，对吗？

那么，只需在包装类中创建您的接口并对其进行测试？

在需要设置用户等方面，我认为这将是你需要咬的一颗子弹。模拟包装器 PInvoke 调用似乎很奇怪，因为您只需确认并且接口存在:)

# asp.net - 构建 Handler 时，应该是 .ashx 还是 .axd？

> ID：53450
> 
> 赞同：3
> 
> 时间：2008-09-10T05:07:25.777
> 
> 标签：asp.net

假设我正在构建一个继承自 的 ASP.Net 类，`IHttpHandler`我应该将其连接到以 结尾的 URL `.ashx`，还是应该使用`.axd`扩展名？

只要没有命名冲突，这有关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T05:10:00.560

啊.. ScottGu 说没关系，但是 .ashx 稍微好一些，因为与 trace.axd 和其他内容发生冲突的可能性较小。这就是为什么.ashx 可能会更好的原因在我脑海中升起。

[http://forums.asp.net/t/964074.aspx](http://forums.asp.net/t/964074.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T05:10:48.030

在“野外”中，.ashx 绝对是最受欢迎的扩展名。

# internet-explorer - 如何停止 IIS 要求对本地主机上的默认网站进行身份验证

> ID：53464
> 
> 赞同：13
> 
> 时间：2008-09-10T05:20:54.607
> 
> 标签：internet-explorer, iis, authentication

我在 Windows XP Pro SP2 上安装了 IIS 5.1。此外，我还安装了 .NET 3.5 的 VS 2008 Express。所以很明显 IIS 为 .NET 3.5 自动配置为 ASP.NET

问题是每当我访问[http://localhost](http://localhost) IE 和 Firefox 时都会出现身份验证框。即使我输入管理员用户及其密码，身份验证也会失败。我已经在默认网站的目录安全选项中检查了匿名用户访问（IUSR_ 用户和密码由 IIS 控制）。

然而，其他部署的网络应用程序工作正常（不要求任何身份验证）。

在 IE 中，如果我在 Intranet 站点选项中添加[http://localhost ，此身份验证过程将停止。](http://localhost)

请注意，安装 IIS 时文件系统为 FAT32。

问候， 贾坦

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-10T05:50:28.170

这很可能是 NT 文件权限问题。IUSR_ 需要具有文件系统权限才能读取您请求的任何文件（例如 /inetpub/wwwroot/index.htm）。

如果仍有问题，请检查 IIS 日志，通常位于 \windows\system32\logfiles\W3SVC*。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-11T15:32:21.210

IIS 使用集成身份验证，默认情况下 IE 能够使用您的 Windows 用户帐户……但别担心，Firefox 也是如此，但您必须快速更改配置。

1) 打开 Firefox 并输入 about:config 作为 url

2）在ntlm中的过滤器类型中

3）双击“network.automatic-ntlm-auth.trusted-uris”并输入localhost并回车

4) 写感谢博主

一如既往，希望这对您有所帮助。

[这是从链接文本](http://forums.codecharge.com/posts.php?post_id=81959)中复制的

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-10T05:26:03.143

这可能是因为几个浏览器设置。尝试检查这些选项..

工具 > Internet 选项 > 高级 > 启用集成 Windows 身份验证（适用于在 IIS 上设置的集成 Windows 身份验证）

工具 > Internet 选项 > 安全 > 本地 Intranet > 自定义级别 > 自动登录

最坏的情况，尝试将 localhost 添加到受信任的站点。

如果您在网络中，您也可以通过获取网络跟踪来尝试调试。可能是因为某些代理尝试进行身份验证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-15T11:02:13.627

如果您没有任何限制，删除“默认网站”并创建一个新网站会更容易。

我做到了，我的问题解决了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-12T12:13:39.487

如果您想要身份验证，请尝试使用 domainname\administrator 作为用户名。

如果您不想进行身份验证，请删除目录安全 > 编辑窗口的身份验证访问部分中的所有复选框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T08:32:07.907

1.  添加带密码的管理员用户
2.  转到 wwwroot 道具
3.  授予此用户对此文件夹及其子文件夹的完全访问权限
4.  使用这篇文章将 AppPool 的用户更改为添加的用户 [http://technet.microsoft.com/en-us/library/cc771170(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc771170(v=ws.10).aspx)
5.  使用这篇文章更改网站的用户 [http://techblog.sunsetsurf.co.uk/2010/07/chang-the-user-iis-runs-as-windows-2008-iis-7-5/](http://techblog.sunsetsurf.co.uk/2010/07/changing-the-user-iis-runs-as-windows-2008-iis-7-5/) 把相同您在步骤 (1) 中创建的用户名和密码。

它现在正在工作，恭喜

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-11-12T21:49:40.700

对我有用的是,,,

单击开始>控制面板>管理工具>Internet 信息服务

展开左侧树，右键单击您的网站>属性

单击目录安全，然后在“匿名访问和身份验证控制”中单击编辑

启用匿名访问>浏览>输入管理员的凭据（如管理员）（检查名称），>单击确定

应用设置，它应该可以正常工作。

# ruby - 将 Ruby 字符串范围转换为 Range 对象的最佳方法是什么

> ID：53472
> 
> 赞同：23
> 
> 时间：2008-09-10T05:28:46.100
> 
> 标签：ruby

我有一些 Ruby 代码，它在命令行上采用以下格式的日期：

```
-d 20080101,20080201..20080229,20080301 
```

我想在列表中包含的所有日期`20080201`和`20080229`其他日期之间运行。

我可以获得字符串`20080201..20080229`，那么将其转换为 Range 实例的最佳方法是什么？目前，我正在使用`eval`，但感觉应该有更好的方法。

* * *

@Purfideas我想寻找一个更通用的答案来将任何类型的字符串转换为`int..int`我猜的范围。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2010-07-14T06:04:05.710

```
Range.new(*self.split("..").map(&:to_i)) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-10T08:04:33.387

但是然后就做

```
ends = '20080201..20080229'.split('..').map{|d| Integer(d)}
ends[0]..ends[1] 
```

无论如何，出于安全原因，我不推荐 eval

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-10T16:47:45.080

Inject with no args 适用于两个元素数组：

```
rng='20080201..20080229'.split('..').inject { |s,e| s.to_i..e.to_i } 
```

当然，这可以通用

```
class Range
  def self.from_ary(a)
    a.inject{|s,e| s..e }
  end
end

rng = Range.from_ary('20080201..20080229'.split('..').map{|s| s.to_i})
rng.class  # => Range 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T06:07:50.657

假设您希望范围在几个月内正确迭代，请尝试

```
require 'date'

ends = '20080201..20080229'.split('..').map{|d| Date.parse(d)}
(ends[0]..ends[1]).each do |d|
  p d.day
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-29T12:19:01.597

[Ranger](https://github.com/Epigene/ranger)使用正则表达式来验证字符串，而不用担心 SQL 注入，然后`eval`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-28T07:58:18.863

将@Purfideas 答案与 StackOverflow 上某处的另一个答案结合起来，我还通过输入检查围绕代码解决了这个问题，因此唯一使用的是有效的可枚举

```
if !value[/^[0-9]+\.\.[0-9]+$/].nil?
    ends = value.split('..').map{|d| Integer(d)}
    value = ends[0]..ends[1]
end 
```

它本质上将您的字符串值重写为可枚举值。如果您在 yaml 配置文件中添加可枚举字段，这会派上用场。

如果您的应用程序需要它，您可以使用可选的第三个文字点来扩展正则表达式，这可能是可选的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-18T14:41:28.497

如果我们这样做

```
v= "20140101..20150101"
raise "Error: invalid format: #{v}" if /\d{8}\.\.\d{8}/ !~ v
r= eval(v) 
```

并且攻击者有一种绕过 raise 检查的方法（简单地通过操纵运行时来禁用异常），那么我们可以获得一个危险的 eval，这可能会破坏整个宇宙。

所以为了减少攻击向量，我们检查格式，然后手动解析，然后检查结果

```
v= "20140101..20150101"
raise "Error: invalid format: #{v}" if /\d{8}\.\.\d{8}/ !~ v
r= Range.new(*v.split(/\.\./).map(&:to_i))
raise "Error: invalid range: #{v}" if r.first> r.last 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-09T13:17:43.640

这里假设您要将哈希存储为系统常量值并在任何模型中获取它。哈希键将是一个范围值。

```
hash_1 = {1..5 => 'a', 6..12 => 'b', 13..67 => 'c', 68..9999999 => 'd'} 
```

然后创建值为 hash_1.to_json 的系统常量。.to_json 会将您的哈希对象转换为 JSON 对象。现在在代码内部创建一个新的哈希 hash_2，

```
JSON.parse(SystemConstant.get('Constant_name')).each{|key,val| temp_k=key.split('..').map{|d| Integer(d)}; hash_2[temp_k[0]..temp_k[1]] = val} 
```

新的 hash_2 将是所需的 hash_1

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-26T03:35:09.933

我有类似的要求，尽管在我的情况下，字符串有两种可能的格式，有时它们是单个数字字符串，例如“7”，有时它们是范围，例如“10-14”。无论哪种方式，我都想将字符串转换为可枚举的数字集合。

我的方法（灵感来自[最高投票的答案](https://stackoverflow.com/a/3243732/145725)）是：

```
def numbers(from_string:)
  if from_string.include?('-')
    return Range.new(*from_string.split('-').map(&:to_i))
  else
    return [from_string.to_i] # put number in an array so we can enumerate over it
  end
end 
```

如果您认为这更具可读性，它也可以作为（长）单行来完成：

```
from_string.include?('-') ? Range.new(*from_string.split('-').map(&:to_i)) : [from_string.to_i] 
```

我正在处理一长串已知字符串，而不是处理任意用户输入，因此这不能防止恶意输入。

# javascript - Javascript - 将类应用于给定属性/值的 HTML 标记

> ID：53473
> 
> 赞同：2
> 
> 时间：2008-09-10T05:29:40.373
> 
> 标签：javascript, html

我试图通过读取某些 HTML 属性的值并根据它们的值应用类名来动态地将样式应用于 HTML 标记。例如，如果我有：

```
<p height="30"> 
```

我想将 a`class="h30"`应用于该段落，以便我可以在我的样式表中设置它的样式。我找不到有关获取不是`id`or的属性值的任何信息`class`。帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T08:06:15.737

我强烈建议使用 jquery 之类的东西来添加类是微不足道的：

```
$("#someId").addClass("newClass"); 
```

所以在你的情况下：

```
$("p[height='30']").addClass("h30"); 
```

所以这会选择高度属性为 30 的所有段落标签，并将类 h30 添加到其中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T05:43:19.683

请参阅：[getAttribute()](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-666EE0F9)。参数是属性的名称（不区分大小写）。返回值是属性的值（一个字符串）。

和IE打交道前一定要看MSDN里的[Remarks ...](http://msdn.microsoft.com/en-us/library/ms536429(VS.85).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T20:03:19.373

最好将布局和演示分开。

尽管使用了 CSS，但您还是将这两者捆绑在一起。[使用更好的类名](http://www.w3.org/QA/Tips/goodclassnames)（为什么它必须有 30px 的高度？是菜单栏吗？页脚？横幅？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T05:33:12.377

属性只是属性（通常）。所以试试：

```
for (e in ...) {
    if (e.height == 30) {
        e.className = "h30";
    }
} 
```

或者使用 jquery 之类的东西来简化这种东西。

# asp.net - ASP.NET MVC 与 Web 客户端软件工厂 (WCSF)

> ID：53479
> 
> 赞同：15
> 
> 时间：2008-09-10T05:37:26.000
> 
> 标签：asp.net, asp.net-mvc, wcsf

我最近一直在对不同类型的模型视图架构进行一些调查，并且需要决定在未来的内部开发中追求哪一种。由于我目前在一家拥有 ASP.NET 技能的 Microsoft 商店工作，因此我的选择似乎介于 ASP.NET MVC 和 WCSF 之间（Monorail 可能不适用，因为 Microsoft 不支持它）。

在阅读[了 ASP.NET MVC 框架之后，以 WCSF 作为衡量标准](http://blogs.msdn.com/simonince/archive/2007/11/22/the-asp-net-mvc-framework-using-the-wcsf-as-a-yardstick.aspx)，我总结了以下几点：

*   ASP.NET MVC 不能使用依赖回发的 Web 控件，而 WCSF 可以。
*   与 WCSF 站点相比，您可以更好地控制 ASP.NET MVC 站点中的 url。
*   一个 ASP.NET MVC 站点可能比等效的 WCSF 版本更容易测试。
*   似乎 WCSF 在某些情况下仍然使用背后的代码来控制 UI 事件，但是 ASP.NET MVC 不允许这样做。

还有哪些其他考虑？
我误解了什么？
有没有人使用过这两种框架并有任何建议？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-10T06:14:47.707

> ASP.NET MVC 不能使用依赖回发的 Web 控件，而 WCSF 可以。

您应该将 WCSF 视为有关如何使用现有 WebForms 基础架构的指南，尤其是引入 Model-View-Presenter 以帮助实施关注点分离。它还增加了生成代码的可测试性。

> 与 WCSF 站点相比，您可以更好地控制 ASP.NET MVC 站点中的 url。

如果您可以针对 3.5 SP1，您可以将新的路由系统与传统的 WebForms 站点一起使用。路由不限于 MVC。例如，看一下动态数据（也在 3.5 SP1 中提供）。

> 一个 ASP.NET MVC 站点可能比等效的 WCSF 版本更容易测试。

这是真的，因为它为 HttpContext、HttpRequest、HttpResponse 等使用了新的抽象类。MVC 模式本质上没有什么比 MVP 模式更可测试的了。它们都是“分离演示”的实例，并且都增加了可测试性。

> WCSF 似乎在某些情况下仍然使用背后的代码来控制 UI 事件，但 ASP.NET 不允许这样做。

在 Model-View-Presenter 中，由于外部世界与视图交互（即 URL 指向视图），视图自然会响应这些事件。它们应该尽可能简单，通过调用演示者或提供演示者可以订阅的事件。

Model-View-Controller 通过让外部世界与控制器交互来克服这个限制。这意味着你的观点对于非展示的东西可能会很“愚蠢”。

至于您应该使用哪个，我认为答案归结为最适合您的项目目标的一个。有时 WebForms 和丰富的第三方控件供应商的可用性会更可取，在某些情况下，原始的简单性和细粒度的 HTML 控件将有利于 MVC。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-17T18:02:47.170

不是要引发一场激烈的战争，但我发现 WCSF 相当复杂。MVC 的优雅和简单让 MVP 印象深刻，它感觉就像是一种刚刚嫁接到 Web 表单上的模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T10:01:39.350

在进行完全相同的评估后，我们选择了 WCSF。我们觉得 MVP 模式给了我们更多的选择，即使用服务器控件的能力。我们的开发团队主要由来自各种学科的程序员组成，例如 C++、Biztalk 和 web 等，但都主要专注于 MS 类型的开发，因此采用这些模式的学习曲线对我们的团队来说并没有那么大。

我们对我们的选择感到非常满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T02:56:08.670

您还可以考虑开发人员的背景（如果已经确定）。

如果他们来自严格的 asp.net 背景，他们会更适应 WCSF（尽管根据我的经验，他们仍然需要几个星期才能真正适应 MVP）。

如果他们来自 java/rails 背景，或者以前使用过其他 MVC 架构，那么显然他们会在那里更快乐（根据我的经验，他们对 MVC 以外的任何东西都非常自负）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-17T18:13:02.580

MVC 是一个更简单的范例，并且更类似于所有其他框架进行 Web 开发的方式。WebForms 只是太多的跳跃和太多的抽象层来尝试实现简单性。恕我直言，MVC 将在几年内成为默认的 ASP.NET 架构，因为越来越多的人意识到它为我们带来的开发和测试的简单性和易用性。我已经从事 MVC 开发一年半了，甚至从未想过要在新项目上回到 WebForms。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-25T17:45:50.897

> **一个 ASP.NET MVC 站点可能比等效的 WCSF 版本更容易测试。**
> 
> 这是真的，因为它为 HttpContext、HttpRequest、HttpResponse 等使用了新的抽象类。MVC 模式本质上没有什么比 MVP 模式更可测试的了。它们都是“分离演示”的实例，并且都增加了可测试性。

这可能值得商榷，但有文献表明，如果您有包含逻辑的视图，则使用 MVP 设计模型比 MVC 设计模型更容易进行单元测试。总而言之，在 MVP 设计模型中，Presenter 正在处理可能由 MVC 设计模型中的 View 处理的工作。MVC 视图中可能包含的逻辑不利于单元测试。以下是我读过的一些参考文献，它们涵盖了这个概念，以及为什么保持 View light 更好的原因有很多，包括促进单元测试。

[http://martinfowler.com/eaaDev/uiArchs.html](http://martinfowler.com/eaaDev/uiArchs.html)

[http://martinfowler.com/eaaDev/SupervisingPresenter.html](http://martinfowler.com/eaaDev/SupervisingPresenter.html)

[http://martinfowler.com/eaaDev/PassiveScreen.html](http://martinfowler.com/eaaDev/PassiveScreen.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T06:34:53.197

为什么不将两者都附加到 Northwind，看看哪个最适合您和您的情况？

# c# - C# 中的模糊文本（句子/标题）匹配

> ID：53480
> 
> 赞同：22
> 
> 时间：2008-09-10T05:37:30.120
> 
> 标签：c#, algorithm, string, fuzzy-search

嘿，我正在使用[Levenshteins](http://en.wikipedia.org/wiki/Levenshtein_distance)算法来获取源字符串和目标字符串之间的距离。

我也有返回值从 0 到 1 的方法：

```
/// <summary>
/// Gets the similarity between two strings.
/// All relation scores are in the [0, 1] range, 
/// which means that if the score gets a maximum value (equal to 1) 
/// then the two string are absolutely similar
/// </summary>
/// <param name="string1">The string1.</param>
/// <param name="string2">The string2.</param>
/// <returns></returns>
public static float CalculateSimilarity(String s1, String s2)
{
    if ((s1 == null) || (s2 == null)) return 0.0f;

    float dis = LevenshteinDistance.Compute(s1, s2);
    float maxLen = s1.Length;
    if (maxLen < s2.Length)
        maxLen = s2.Length;
    if (maxLen == 0.0F)
        return 1.0F;
    else return 1.0F - dis / maxLen;
} 
```

但这对我来说还不够。因为我需要更复杂的方式来匹配两个句子。

例如，我想自动标记一些音乐，我有原始歌曲名称，并且我有垃圾歌曲，如*超级、质量、**2007 年、2008*年等年份等。还有一些文件只有[http://trash。 .thash..song_name_mp3.mp3](http://trash..thash..song_name_mp3.mp3)，其他正常。我想创建一个比我现在更完美的算法。也许有人可以帮助我吗？

这是我目前的算法：

```
/// <summary>
/// if we need to ignore this target.
/// </summary>
/// <param name="targetString">The target string.</param>
/// <returns></returns>
private bool doIgnore(String targetString)
{
    if ((targetString != null) && (targetString != String.Empty))
    {
        for (int i = 0; i < ignoreWordsList.Length; ++i)
        {
            //* if we found ignore word or target string matching some some special cases like years (Regex).
            if (targetString == ignoreWordsList[i] || (isMatchInSpecialCases(targetString))) return true;
        }
    }

   return false;
}

/// <summary>
/// Removes the duplicates.
/// </summary>
/// <param name="list">The list.</param>
private void removeDuplicates(List<String> list)
{
    if ((list != null) && (list.Count > 0))
    {
        for (int i = 0; i < list.Count - 1; ++i)
        {
            if (list[i] == list[i + 1])
            {
                list.RemoveAt(i);
                --i;
            }
        }
    }
}

/// <summary>
/// Does the fuzzy match.
/// </summary>
/// <param name="targetTitle">The target title.</param>
/// <returns></returns>
private TitleMatchResult doFuzzyMatch(String targetTitle)
{
    TitleMatchResult matchResult = null;

   if (targetTitle != null && targetTitle != String.Empty)
   {
       try
       {
           //* change target title (string) to lower case.
           targetTitle = targetTitle.ToLower();

           //* scores, we will select higher score at the end.
           Dictionary<Title, float> scores = new Dictionary<Title, float>();

           //* do split special chars: '-', ' ', '.', ',', '?', '/', ':', ';', '%', '(', ')', '#', '\"', '\'', '!', '|', '^', '*', '[', ']', '{', '}', '=', '!', '+', '_'
           List<String> targetKeywords = new List<string>(targetTitle.Split(ignoreCharsList, StringSplitOptions.RemoveEmptyEntries));

          //* remove all trash from keywords, like super, quality, etc..
           targetKeywords.RemoveAll(delegate(String x) { return doIgnore(x); });
          //* sort keywords.
          targetKeywords.Sort();
        //* remove some duplicates.
        removeDuplicates(targetKeywords);

        //* go through all original titles.
        foreach (Title sourceTitle in titles)
        {
            float tempScore = 0f;
            //* split orig. title to keywords list.
            List<String> sourceKeywords = new List<string>(sourceTitle.Name.Split(ignoreCharsList, StringSplitOptions.RemoveEmptyEntries));
            sourceKeywords.Sort();
            removeDuplicates(sourceKeywords);

            //* go through all source ttl keywords.
            foreach (String keyw1 in sourceKeywords)
            {
                float max = float.MinValue;
                foreach (String keyw2 in targetKeywords)
                {
                    float currentScore = StringMatching.StringMatching.CalculateSimilarity(keyw1.ToLower(), keyw2);
                    if (currentScore > max)
                    {
                        max = currentScore;
                    }
                }
                tempScore += max;
            }

            //* calculate average score.
            float averageScore = (tempScore / Math.Max(targetKeywords.Count, sourceKeywords.Count)); 

            //* if average score is bigger than minimal score and target title is not in this source title ignore list.
            if (averageScore >= minimalScore && !sourceTitle.doIgnore(targetTitle))
            {
                //* add score.
                scores.Add(sourceTitle, averageScore);
            }
        }

        //* choose biggest score.
        float maxi = float.MinValue;
        foreach (KeyValuePair<Title, float> kvp in scores)
        {
            if (kvp.Value > maxi)
            {
                maxi = kvp.Value;
                matchResult = new TitleMatchResult(maxi, kvp.Key, MatchTechnique.FuzzyLogic);
            }
        }
    }
    catch { }
}
//* return result.
return matchResult;
} 
```

这正常工作，但只是在某些情况下，很多标题应该匹配，不匹配......我想我需要某种公式来玩权重等，但我想不出一个......

想法？建议？算法？

顺便说一句，我已经知道这个话题（我的同事已经发布了，但我们无法为这个问题提供适当的解决方案。）： [近似字符串匹配算法](https://stackoverflow.com/questions/49263/approximate-string-matching-algorithms)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-09T20:17:26.430

有点旧，但它可能对未来的访客有用。如果您已经在使用 Levenshtein 算法并且需要做得更好，我将在此解决方案中描述一些非常有效的启发式方法：

[获取最接近的字符串匹配](https://stackoverflow.com/questions/5859561/getting-the-closest-string-match/5859823#5859823)

关键是你想出 3 或 4 种（或[更多](http://en.wikipedia.org/wiki/String_metric)）方法来衡量你的短语之间的相似性（Levenshtein 距离只是一种方法） - 然后使用你想要匹配为相似的字符串的真实示例，你调整权重以及这些启发式的组合，直到你得到最大化正匹配数量的东西。然后，您将该公式用于所有未来的比赛，您应该会看到很好的结果。

如果用户参与了该过程，那么最好提供一个界面，该界面允许用户查看相似度高的其他匹配项，以防他们不同意第一选择。

这是链接答案的摘录。如果您最终想按原样使用任何此代码，我提前为必须将 VBA 转换为 C# 表示歉意。

* * *

简单、快速且非常有用的指标。使用它，我创建了两个单独的指标来评估两个字符串的相似性。一种我称之为“valuePhrase”，一种我称之为“valueWords”。valuePhrase 只是两个短语之间的 Levenshtein 距离，valueWords 根据分隔符（例如空格、破折号和您想要的任何其他内容）将字符串拆分为单个单词，并将每个单词与其他单词进行比较，总结出最短的连接任意两个单词的 Levenshtein 距离。本质上，它衡量一个“短语”中的信息是否真的包含在另一个“短语”中，就像逐字排列一样。我花了几天时间作为一个附带项目，提出了基于分隔符拆分字符串的最有效方法。

valueWords、valuePhrase 和 Split 函数：

```
Public Function valuePhrase#(ByRef S1$, ByRef S2$)
    valuePhrase = LevenshteinDistance(S1, S2)
End Function

Public Function valueWords#(ByRef S1$, ByRef S2$)
    Dim wordsS1$(), wordsS2$()
    wordsS1 = SplitMultiDelims(S1, " _-")
    wordsS2 = SplitMultiDelims(S2, " _-")
    Dim word1%, word2%, thisD#, wordbest#
    Dim wordsTotal#
    For word1 = LBound(wordsS1) To UBound(wordsS1)
        wordbest = Len(S2)
        For word2 = LBound(wordsS2) To UBound(wordsS2)
            thisD = LevenshteinDistance(wordsS1(word1), wordsS2(word2))
            If thisD < wordbest Then wordbest = thisD
            If thisD = 0 Then GoTo foundbest
        Next word2
foundbest:
        wordsTotal = wordsTotal + wordbest
    Next word1
    valueWords = wordsTotal
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' SplitMultiDelims
' This function splits Text into an array of substrings, each substring
' delimited by any character in DelimChars. Only a single character
' may be a delimiter between two substrings, but DelimChars may
' contain any number of delimiter characters. It returns a single element
' array containing all of text if DelimChars is empty, or a 1 or greater
' element array if the Text is successfully split into substrings.
' If IgnoreConsecutiveDelimiters is true, empty array elements will not occur.
' If Limit greater than 0, the function will only split Text into 'Limit'
' array elements or less. The last element will contain the rest of Text.
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Function SplitMultiDelims(ByRef Text As String, ByRef DelimChars As String, _
        Optional ByVal IgnoreConsecutiveDelimiters As Boolean = False, _
        Optional ByVal Limit As Long = -1) As String()
    Dim ElemStart As Long, N As Long, M As Long, Elements As Long
    Dim lDelims As Long, lText As Long
    Dim Arr() As String

    lText = Len(Text)
    lDelims = Len(DelimChars)
    If lDelims = 0 Or lText = 0 Or Limit = 1 Then
        ReDim Arr(0 To 0)
        Arr(0) = Text
        SplitMultiDelims = Arr
        Exit Function
    End If
    ReDim Arr(0 To IIf(Limit = -1, lText - 1, Limit))

    Elements = 0: ElemStart = 1
    For N = 1 To lText
        If InStr(DelimChars, Mid(Text, N, 1)) Then
            Arr(Elements) = Mid(Text, ElemStart, N - ElemStart)
            If IgnoreConsecutiveDelimiters Then
                If Len(Arr(Elements)) > 0 Then Elements = Elements + 1
            Else
                Elements = Elements + 1
            End If
            ElemStart = N + 1
            If Elements + 1 = Limit Then Exit For
        End If
    Next N
    'Get the last token terminated by the end of the string into the array
    If ElemStart <= lText Then Arr(Elements) = Mid(Text, ElemStart)
    'Since the end of string counts as the terminating delimiter, if the last character
    'was also a delimiter, we treat the two as consecutive, and so ignore the last elemnent
    If IgnoreConsecutiveDelimiters Then If Len(Arr(Elements)) = 0 Then Elements = Elements - 1

    ReDim Preserve Arr(0 To Elements) 'Chop off unused array elements
    SplitMultiDelims = Arr
End Function 
```

**相似度测量**

使用这两个指标，以及简单计算两个字符串之间距离的第三个指标，我有一系列变量，我可以运行优化算法来实现最大数量的匹配。模糊字符串匹配本身就是一门模糊科学，因此通过创建用于测量字符串相似性的线性独立指标，并拥有一组我们希望彼此匹配的已知字符串，我们可以找到适合我们特定风格的参数字符串，给出最好的模糊匹配结果。

最初，该度量的目标是为精确匹配提供较低的搜索值，并为越来越多的排列度量增加搜索值。在一个不切实际的情况下，这很容易使用一组定义明确的排列来定义，并设计最终公式，以便它们根据需要增加搜索值结果。

![在此处输入图像描述](https://i.stack.imgur.com/eGCtC.png)

正如您所看到的，最后两个指标，即模糊字符串匹配指标，已经自然倾向于将低分给要匹配的字符串（对角线下方）。这是非常好的。

**应用** 为了优化模糊匹配，我对每个度量进行加权。因此，模糊字符串匹配的每个应用程序都可以对参数进行不同的加权。定义最终分数的公式是指标及其权重的简单组合：

```
value = Min(phraseWeight*phraseValue, wordsWeight*wordsValue)*minWeight + 
        Max(phraseWeight*phraseValue, wordsWeight*wordsValue)*maxWeight + lengthWeight*lengthValue 
```

使用优化算法（神经网络在这里最好，因为它是一个离散的多维问题），现在的目标是最大化匹配的数量。我创建了一个函数来检测每组正确匹配的数量，如最终屏幕截图所示。如果将最低分数分配给要匹配的字符串，则列或行得到一个分数，如果最低分数相同，则给出部分分数，并且正确匹配在并列匹配的字符串中。然后我对其进行了优化。您可以看到绿色单元格是与当前行最匹配的列，而单元格周围的蓝色方块是与当前列最匹配的行。底角的分数大致是成功匹配的数量，这就是我们告诉优化问题最大化的值。

![在此处输入图像描述](https://i.stack.imgur.com/hsMtp.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-10T06:37:49.960

听起来您想要的可能是最长的子字符串匹配。也就是说，在您的示例中，有两个文件，例如

垃圾..thash..song_name_mp3.mp3 和垃圾..spotch..song_name_mp3.mp3

最终会看起来一样。

当然，你需要一些启发式方法。您可能会尝试的一件事是将字符串通过 soundex 转换器。Soundex 是用于查看事物“听起来”是否相同的“编解码器”（您可能会告诉电话接线员）。它或多或少是一个粗略的语音和错误发音的半证明音译。它绝对比编辑距离差，但便宜得多。（官方使用的是名称，只使用三个字符。不过，没有理由停在那里，只需对字符串中的每个字符使用映射即可。有关详细信息，请参阅[wikipedia](http://en.wikipedia.org/wiki/Soundex)）

所以我的建议是对你的琴弦进行soundex，将每根琴弦切成几段（比如5、10、20），然后只看簇。在集群中，您可以使用更昂贵的东西，例如编辑距离或最大子字符串。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-10T06:59:10.390

您的问题可能是区分干扰词和有用数据：

*   Rolling_Stones.Best_of_2003.Wild_Horses.mp3
*   Super.Quality.Wild_Horses.mp3
*   Tori_Amos.Wild_Horses.mp3

您可能需要生成要忽略的噪声词词典。这看起来很笨拙，但我不确定是否有一种算法可以区分乐队/专辑名称和噪音。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-11T06:44:57.703

在 DNA 序列比对（搜索“局部序列比对”）的一些相关问题上做了很多工作——经典算法是“Needleman-Wunsch”，更复杂的现代算法也很容易找到。这个想法是 - 类似于 Greg 的答案 - 而不是识别和比较关键字，而是尝试在长字符串中找到最长的松散匹配子字符串。

可悲的是，如果唯一的目标是对音乐进行排序，那么一些覆盖可能命名方案的正则表达式可能会比任何通用算法更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-17T16:42:55.103

有一个[GitHub repo](https://github.com/kdjones/fuzzystring)实现了几种方法。

# mysql - 如何更改 MySQL 中的 root 用户的密码？

> ID：53482
> 
> 赞同：3
> 
> 时间：2008-09-10T05:41:34.790
> 
> 标签：mysql

我早就忘记了我的一个盒子上的 root 用户的密码。有没有一种方法可以更改它而无需登录到实例，或者我必须重新安装？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T05:42:53.197

一个快速的谷歌导致了这个答案。在根 shell 类型中：

```
mysqladmin -u root password <password> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-10T07:43:12.640

**第1步**

停止数据库：

```
shell> /etc/init.d/mysql stop 
```

**第2步**

重启数据库

*   没有密码验证
*   没有连接到网络

只能通过它的 sock 文件“/var/lib/mysql/mysql.sock”访问数据库。

```
shell> mysqld --user=mysql --pid-file=/var/lib/mysql/mysqld.pid \
       --socket=/var/lib/mysql/mysql.sock --datadir=/var/lib/mysql \
       --skip-grant-tables --skip-networking  & 
```

**第 3 步**

连接数据库并修改密码：

```
shell> mysql --database mysql --socket=/var/lib/mysql/mysql.sock 
```

如果您愿意，请显示所有用户：

```
mysql> select User, password from user; 
```

设置新密码：

```
mysql> update user set password=password('NEW PASS') WHERE User='USERNAME'; 
```

离开数据库连接：

```
mysql> exit 
```

**第4步**

“正常”重启数据库服务器。

```
shell> kill `cat /var/lib/mysql/mysqld.pid`
shell> /etc/init.d/mysql start 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-27T04:03:10.493

如果您正在运行 Ubuntu 服务器（可能还有 Debian？），您可以轻松重置。

如果您在 12.04：

```
sudo dpkg-reconfigure mysql-server-5.5 
```

如果您在 10.04：

```
sudo dpkg-reconfigure mysql-server-5.1 
```

如果您不确定安装了哪个 mysql-server 版本，您可以尝试：

```
dpkg --get-selections | grep mysql-server 
```

查看更多信息：

[https://help.ubuntu.com/12.04/serverguide/mysql.html](https://help.ubuntu.com/12.04/serverguide/mysql.html) [https://help.ubuntu.com/10.04/serverguide/mysql.html](https://help.ubuntu.com/10.04/serverguide/mysql.html)

# mysql - 如何启用对 MySQL 服务器的外部访问？

> ID：53491
> 
> 赞同：9
> 
> 时间：2008-09-10T05:52:21.627
> 
> 标签：mysql

如何启用对 MySQL 服务器的外部访问？我可以在本地连接，但无法从网络上的另一个盒子连接。

我刚试过

```
grant all privileges on *.* to root@'%' identified by '*****' with grant option; 
```

并没有成功重新启动 MySQL 服务器。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-10T06:19:52.030

您可能必须编辑配置文件（通常是 my.cnf）才能在外部接口中侦听，而不是仅在 localhost 上进行侦听。

将参数更改`bind-address`为您机器的 IP 地址。

如果这是旧的 MySQL 安装，您应该注释掉 skip-networking 参数。

之后，重新启动 MySQL，您将被设置

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T06:21:31.013

命令和语法看起来不错。您是否检查过服务器正在侦听 127.0.0.1 以外的接口？默认情况下，我很确定它只监听本地主机地址（127.0.0.1）

# regex - 匹配有效 IPv6 地址的正则表达式

> ID：53497
> 
> 赞同：111
> 
> 时间：2008-09-10T05:57:24.783
> 
> 标签：regex, networking, ipv6

我在编写匹配有效 IPv6 地址的正则表达式时遇到问题，包括压缩形式的地址（`::`每个字节对中省略或前导零）。

有人可以建议一个可以满足要求的正则表达式吗？

我正在考虑扩展每个字节对并将结果与​​更简单的正则表达式匹配。

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2013-07-26T02:06:23.153

我无法获得@Factor Mystic 使用 POSIX 正则表达式的答案，所以我写了一个使用 POSIX 正则表达式和 PERL 正则表达式的答案。

它应该匹配：

*   IPv6 地址
*   零压缩 IPv6 地址（[rfc5952 的第 2.2 节](https://www.rfc-editor.org/rfc/rfc5952#section-2.2)）
*   具有区域索引的链接本地 IPv6 地址（[rfc4007 的第 11 节](https://www.rfc-editor.org/rfc/rfc4007#section-11)）
*   IPv4 嵌入式 IPv6 地址（[rfc6052 的第 2 节](https://www.rfc-editor.org/rfc/rfc6052#section-2)）
*   IPv4 映射的 IPv6 地址（[rfc2765 的第 2.1 节](https://www.rfc-editor.org/rfc/rfc2765#section-2.1)）
*   IPv4 转换地址（[rfc2765 的第 2.1 节](https://www.rfc-editor.org/rfc/rfc2765#section-2.1)）

IPv6 正则表达式：

```
(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])) 
```

为便于阅读，以下是上述正则表达式在主要 OR 点处拆分为单独的行：

```
# IPv6 RegEx
(
([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|          # 1:2:3:4:5:6:7:8
([0-9a-fA-F]{1,4}:){1,7}:|                         # 1::                              1:2:3:4:5:6:7::
([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|         # 1::8             1:2:3:4:5:6::8  1:2:3:4:5:6::8
([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|  # 1::7:8           1:2:3:4:5::7:8  1:2:3:4:5::8
([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|  # 1::6:7:8         1:2:3:4::6:7:8  1:2:3:4::8
([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|  # 1::5:6:7:8       1:2:3::5:6:7:8  1:2:3::8
([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|  # 1::4:5:6:7:8     1:2::4:5:6:7:8  1:2::8
[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|       # 1::3:4:5:6:7:8   1::3:4:5:6:7:8  1::8  
:((:[0-9a-fA-F]{1,4}){1,7}|:)|                     # ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8 ::8       ::     
fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|     # fe80::7:8%eth0   fe80::7:8%1     (link-local IPv6 addresses with zone index)
::(ffff(:0{1,4}){0,1}:){0,1}
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|          # ::255.255.255.255   ::ffff:255.255.255.255  ::ffff:0:255.255.255.255  (IPv4-mapped IPv6 addresses and IPv4-translated addresses)
([0-9a-fA-F]{1,4}:){1,4}:
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}
(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])           # 2001:db8:3:4::192.0.2.33  64:ff9b::192.0.2.33 (IPv4-Embedded IPv6 Address)
)

# IPv4 RegEx
((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]) 
```

为了使上述内容更容易理解，以下“伪”代码复制了上述内容：

```
IPV4SEG  = (25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])
IPV4ADDR = (IPV4SEG\.){3,3}IPV4SEG
IPV6SEG  = [0-9a-fA-F]{1,4}
IPV6ADDR = (
           (IPV6SEG:){7,7}IPV6SEG|                # 1:2:3:4:5:6:7:8
           (IPV6SEG:){1,7}:|                      # 1::                                 1:2:3:4:5:6:7::
           (IPV6SEG:){1,6}:IPV6SEG|               # 1::8               1:2:3:4:5:6::8   1:2:3:4:5:6::8
           (IPV6SEG:){1,5}(:IPV6SEG){1,2}|        # 1::7:8             1:2:3:4:5::7:8   1:2:3:4:5::8
           (IPV6SEG:){1,4}(:IPV6SEG){1,3}|        # 1::6:7:8           1:2:3:4::6:7:8   1:2:3:4::8
           (IPV6SEG:){1,3}(:IPV6SEG){1,4}|        # 1::5:6:7:8         1:2:3::5:6:7:8   1:2:3::8
           (IPV6SEG:){1,2}(:IPV6SEG){1,5}|        # 1::4:5:6:7:8       1:2::4:5:6:7:8   1:2::8
           IPV6SEG:((:IPV6SEG){1,6})|             # 1::3:4:5:6:7:8     1::3:4:5:6:7:8   1::8
           :((:IPV6SEG){1,7}|:)|                  # ::2:3:4:5:6:7:8    ::2:3:4:5:6:7:8  ::8       ::       
           fe80:(:IPV6SEG){0,4}%[0-9a-zA-Z]{1,}|  # fe80::7:8%eth0     fe80::7:8%1  (link-local IPv6 addresses with zone index)
           ::(ffff(:0{1,4}){0,1}:){0,1}IPV4ADDR|  # ::255.255.255.255  ::ffff:255.255.255.255  ::ffff:0:255.255.255.255 (IPv4-mapped IPv6 addresses and IPv4-translated addresses)
           (IPV6SEG:){1,4}:IPV4ADDR               # 2001:db8:3:4::192.0.2.33  64:ff9b::192.0.2.33 (IPv4-Embedded IPv6 Address)
           ) 
```

我在 GitHub 上发布了一个测试正则表达式的脚本：[https ://gist.github.com/syzdek/6086792](https://gist.github.com/syzdek/6086792)

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-12-20T00:15:29.300

以下将验证 IPv4、IPv6（完整和压缩）和 IPv6v4（完整和压缩）地址：

```
'/^(?>(?>([a-f0-9]{1,4})(?>:(?1)){7}|(?!(?:.*[a-f0-9](?>:|$)){8,})((?1)(?>:(?1)){0,6})?::(?2)?)|(?>(?>(?1)(?>:(?1)){5}:|(?!(?:.*[a-f0-9]:){6,})(?3)?::(?>((?1)(?>:(?1)){0,4}):)?)?(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])(?>\.(?4)){3}))$/iD' 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-09-17T10:39:49.647

听起来您可能正在使用 Python。如果是这样，你可以使用这样的东西：

```
import socket

def check_ipv6(n):
    try:
        socket.inet_pton(socket.AF_INET6, n)
        return True
    except socket.error:
        return False

print check_ipv6('::1') # True
print check_ipv6('foo') # False
print check_ipv6(5)     # TypeError exception
print check_ipv6(None)  # TypeError exception 
```

我认为您不必将 IPv6 编译到 Python 中即可 get [`inet_pton`](http://docs.python.org/2/library/socket.html#socket.inet_pton)，如果您`socket.AF_INET`作为第一个参数传入，它也可以解析 IPv4 地址。注意：这可能不适用于非 Unix 系统。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-09-10T06:01:10.763

从“ [IPv6 正则表达式](http://vernon.mauery.com/content/projects/linux/ipv6_regex)”：

```
(\A([0-9a-f]{1,4}:){1,1}(:[0-9a-f]{1,4}){1,6}\Z)|
(\A([0-9a-f]{1,4}:){1,2}(:[0-9a-f]{1,4}){1,5}\Z)|
(\A([0-9a-f]{1,4}:){1,3}(:[0-9a-f]{1,4}){1,4}\Z)|
(\A([0-9a-f]{1,4}:){1,4}(:[0-9a-f]{1,4}){1,3}\Z)|
(\A([0-9a-f]{1,4}:){1,5}(:[0-9a-f]{1,4}){1,2}\Z)|
(\A([0-9a-f]{1,4}:){1,6}(:[0-9a-f]{1,4}){1,1}\Z)|
(\A(([0-9a-f]{1,4}:){1,7}|:):\Z)|
(\A:(:[0-9a-f]{1,4}){1,7}\Z)|
(\A((([0-9a-f]{1,4}:){6})(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3})\Z)|
(\A(([0-9a-f]{1,4}:){5}[0-9a-f]{1,4}:(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3})\Z)|
(\A([0-9a-f]{1,4}:){5}:[0-9a-f]{1,4}:(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\Z)|
(\A([0-9a-f]{1,4}:){1,1}(:[0-9a-f]{1,4}){1,4}:(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\Z)|
(\A([0-9a-f]{1,4}:){1,2}(:[0-9a-f]{1,4}){1,3}:(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\Z)|
(\A([0-9a-f]{1,4}:){1,3}(:[0-9a-f]{1,4}){1,2}:(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\Z)|
(\A([0-9a-f]{1,4}:){1,4}(:[0-9a-f]{1,4}){1,1}:(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\Z)|
(\A(([0-9a-f]{1,4}:){1,5}|:):(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\Z)|
(\A:(:[0-9a-f]{1,4}){1,5}:(25[0-5]|2[0-4]\d|[0-1]?\d?\d)(\.(25[0-5]|2[0-4]\d|[0-1]?\d?\d)){3}\Z) 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-05-20T20:31:41.570

这也捕获了 loopback(::1) 和 ipv6 地址。将 {} 更改为 + 并将 : 放在第一个方括号内。

```
([a-f0-9:]+:+)+[a-f0-9]+ 
```

使用 ifconfig -a output [http://regexr.com/进行测试](http://regexr.com/)

Unix 或 Mac OSx 终端 o 选项仅返回匹配的输出 (ipv6)，包括 ::1

```
ifconfig -a | egrep -o '([a-f0-9:]+:+)+[a-f0-9]+' 
```

获取所有 IP 地址（IPv4 或 IPv6）并在 unix OSx 术语上打印匹配项

```
ifconfig -a | egrep -o '([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}) | (([a-f0-9:]+:+)+[a-f0-9]+)' 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-09-10T07:55:04.767

I'd have to strongly second the answer from [Frank Krueger](/users/338/frank-krueger).

Whilst you say you need a regular expression to match an IPv6 address, I'm assuming what you really need is to be able to check if a given string is a valid IPv6 address. There is a subtle but important distinction here.

There is more than one way to check if a given string is a valid IPv6 address and regular expression matching is only one solution.

Use an existing library if you can. The library will have fewer bugs and its use will result in less code for you to maintain.

The regular expression suggested by [Factor Mystic](/users/1569/factor-mystic) is long and complex. It most likely works, but you should also consider how you'd cope if it unexpectedly fails. The point I'm trying to make here is that if you can't form a required regular expression yourself you won't be able to easily debug it.

If you have no suitable library it may be better to write your own IPv6 validation routine that doesn't depend on regular expressions. If you write it you understand it and if you understand it you can add comments to explain it so that others can also understand and subsequently maintain it.

Act with caution when using a regular expression whose functionality you can't explain to someone else.

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-04-06T14:23:38.570

此正则表达式将根据使用 REGULAR EXTENDED 模式的正则表达式的 GNU C++ 实现匹配有效的 IPv6 和 IPv4 地址：

```
"^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])(\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])){3}))|:)))(%.+)?\s*$" 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2013-02-19T15:18:27.693

我不是 Ipv6 专家，但我认为使用这个可以更轻松地获得相当不错的结果：

```
^([0-9A-Fa-f]{0,4}:){2,7}([0-9A-Fa-f]{1,4}$|((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4})$ 
```

回答“是有效的 ipv6”对我来说似乎没问题。把它分成几部分……算了。我省略了未指定的（::)，因为在我的数据库中没有“未指定的地址”。

开头： `^([0-9A-Fa-f]{0,4}:){2,7}`<--匹配可压缩部分，我们可以将其翻译为：2到7个冒号之间可能有十六进制数。

后跟： `[0-9A-Fa-f]{1,4}$`<-- 十六进制数（省略前导 0）或 `((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}`<-- Ipv4 地址

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-13T22:30:21.890

如果你使用 Perl 试试[Net::IPv6Addr](https://metacpan.org/module/Net::IPv6Addr)

```
use Net::IPv6Addr;

if( defined Net::IPv6Addr::is_ipv6($ip_address) ){
  print "Looks like an ipv6 address\n";
} 
```

[网络地址::IP](https://metacpan.org/module/NetAddr::IP)

```
use NetAddr::IP;

my $obj = NetAddr::IP->new6($ip_address); 
```

[验证::IP](https://metacpan.org/module/Data::Validate::IP)

```
use Validate::IP qw'is_ipv6';

if( is_ipv6($ip_address) ){
  print "Looks like an ipv6 address\n";
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-04-13T13:23:20.990

一个简单的正则表达式将匹配，但我不建议进行任何类型的验证是这样的：

```
([A-Fa-f0-9]{1,4}::?){1,7}[A-Fa-f0-9]{1,4} 
```

请注意，这匹配地址中任何位置的压缩，尽管它不会匹配环回地址 ::1。为了保持正则表达式的简单，我发现这是一个合理的折衷方案。

我在 iTerm2*智能选择规则*中成功使用它来四击 IPv6 地址。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-07-27T07:57:01.423

谨防！**在Java中，使用InetAddress和相关类（Inet4Address、Inet6Address、URL）可能会涉及到网络流量！**例如 DNS 解析（URL.equals，来自字符串的 InetAddress！）。此调用可能需要很长时间并且正在阻塞！

对于 IPv6，我有类似的东西。这当然不能处理 IPv6 的非常微妙的细节，例如区域索引只允许在某些类型的 IPv6 地址上。而且这个正则表达式不是为组捕获而编写的，它只是一种“匹配”的正则表达式。

`S`- IPv6 段 =`[0-9a-f]{1,4}`

`I`- IPv4 =`(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]{1,2})\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]{1,2})`

示意图（第一部分匹配带有 IPv4 后缀的 IPv6 地址，第二部分匹配 IPv6 地址，最后部分是区域索引）：

```
(
(
::(S:){0,5}|
S::(S:){0,4}|
(S:){2}:(S:){0,3}|
(S:){3}:(S:){0,2}|
(S:){4}:(S:)?|
(S:){5}:|
(S:){6}
)
I

|

:(:|(:S){1,7})|
S:(:|(:S){1,6})|
(S:){2}(:|(:S){1,5})|
(S:){3}(:|(:S){1,4})|
(S:){4}(:|(:S){1,3})|
(S:){5}(:|(:S){1,2})|
(S:){6}(:|(:S))|
(S:){7}:|
(S:){7}S
)

(?:%[0-9a-z]+)? 
```

这里是可能的正则表达式（不区分大小写，围绕需要的内容，如行首/行尾等）：

```
(?:
(?:
::(?:[0-9a-f]{1,4}:){0,5}|
[0-9a-f]{1,4}::(?:[0-9a-f]{1,4}:){0,4}|
(?:[0-9a-f]{1,4}:){2}:(?:[0-9a-f]{1,4}:){0,3}|
(?:[0-9a-f]{1,4}:){3}:(?:[0-9a-f]{1,4}:){0,2}|
(?:[0-9a-f]{1,4}:){4}:(?:[0-9a-f]{1,4}:)?|
(?:[0-9a-f]{1,4}:){5}:|
(?:[0-9a-f]{1,4}:){6}
)
(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]{1,2})\.){3}
(?:25[0-5]|2[0-4][0-9]|[01]?[0-9]{1,2})|

:(?::|(?::[0-9a-f]{1,4}){1,7})|
[0-9a-f]{1,4}:(?::|(?::[0-9a-f]{1,4}){1,6})|
(?:[0-9a-f]{1,4}:){2}(?::|(?::[0-9a-f]{1,4}){1,5})|
(?:[0-9a-f]{1,4}:){3}(?::|(?::[0-9a-f]{1,4}){1,4})|
(?:[0-9a-f]{1,4}:){4}(?::|(?::[0-9a-f]{1,4}){1,3})|
(?:[0-9a-f]{1,4}:){5}(?::|(?::[0-9a-f]{1,4}){1,2})|
(?:[0-9a-f]{1,4}:){6}(?::|(?::[0-9a-f]{1,4}))|
(?:[0-9a-f]{1,4}:){7}:|
(?:[0-9a-f]{1,4}:){7}[0-9a-f]{1,4}
)

(?:%[0-9a-z]+)? 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2018-05-17T07:12:18.257

以下正则表达式仅适用于 IPv6。组 1 与 IP 匹配。

```
(([0-9a-fA-F]{0,4}:){1,7}[0-9a-fA-F]{0,4}) 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-12-18T02:06:01.823

当您考虑具有嵌入式 ipv4 的地址和压缩的地址时，ipv6 的正则表达式可能会变得非常棘手，正如您从其中一些答案中看到的那样。

[开源 IPAddress Java 库](https://seancfoley.github.io/IPAddress/)将验证 IPv6 和 IPv4 的所有标准表示，并且还支持前缀长度（以及此类验证）。免责声明：我是那个图书馆的项目经理。

代码示例：

```
 try {
            IPAddressString str = new IPAddressString("::1");
            IPAddress addr = str.toAddress();
            if(addr.isIPv6() || addr.isIPv6Convertible()) {
                IPv6Address ipv6Addr = addr.toIPv6();
            }
            //use address
        } catch(AddressStringException e) {
            //e.getMessage has validation error
        } 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-03-11T15:10:36.910

查看其他答案中包含的模式，可以通过引用组和利用前瞻来改进许多好的模式。这是一个自引用模式的示例，如果我必须在 PHP 中使用它：

```
^(?<hgroup>(?<hex>[[:xdigit:]]{0,4}) # grab a sequence of up to 4 hex digits
                                     # and name this pattern for usage later
     (?<!:::):{1,2})                 # match 1 or 2 ':' characters
                                     # as long as we can't match 3
 (?&hgroup){1,6} # match our hex group 1 to 6 more times
 (?:(?:
    # match an ipv4 address or
    (?<dgroup>2[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3}(?&dgroup)
    # match our hex group one last time
    |(?&hex))$ 
```

**注意：** PHP 有一个内置过滤器，这将是比这种模式更好的解决方案。

[正则表达式101分析](http://regex101.com/r/qZ5wF3)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-10-03T22:20:52.727

我使用 python 生成了以下内容并使用 re 模块。前瞻断言确保地址中出现正确数量的点或冒号。它不支持 IPv6 表示法中的 IPv4。

```
pattern = '^(?=\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$)(?:(?:25[0-5]|[12][0-4][0-9]|1[5-9][0-9]|[1-9]?[0-9])\.?){4}$|(?=^(?:[0-9a-f]{0,4}:){2,7}[0-9a-f]{0,4}$)(?![^:]*::.+::[^:]*$)(?:(?=.*::.*)|(?=\w+:\w+:\w+:\w+:\w+:\w+:\w+:\w+))(?:(?:^|:)(?:[0-9a-f]{4}|[1-9a-f][0-9a-f]{0,3})){0,8}(?:::(?:[0-9a-f]{1,4}(?:$|:)){0,6})?$'
result = re.match(pattern, ip)
if result: result.group(0) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-08-30T21:42:54.147

根据您的需要，近似值如下：

```
[0-9a-f:]+ 
```

可能就足够了（例如，与简单的日志文件 grepping 一样。）

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-10-06T12:51:57.233

在**Scala**中使用众所周知的 Apache Commons 验证器。

[http://mvnrepository.com/artifact/commons-validator/commons-validator/1.4.1](http://mvnrepository.com/artifact/commons-validator/commons-validator/1.4.1)

```
libraryDependencies += "commons-validator" % "commons-validator" % "1.4.1"

import org.apache.commons.validator.routines._

/**
 * Validates if the passed ip is a valid IPv4 or IPv6 address.
 *
 * @param ip The IP address to validate.
 * @return True if the passed IP address is valid, false otherwise.
 */  
 def ip(ip: String) = InetAddressValidator.getInstance().isValid(ip) 
```

按照方法的测试`ip(ip: String)`：

```
"The `ip` validator" should {
  "return false if the IPv4 is invalid" in {
    ip("123") must beFalse
    ip("255.255.255.256") must beFalse
    ip("127.1") must beFalse
    ip("30.168.1.255.1") must beFalse
    ip("-1.2.3.4") must beFalse
  }

  "return true if the IPv4 is valid" in {
    ip("255.255.255.255") must beTrue
    ip("127.0.0.1") must beTrue
    ip("0.0.0.0") must beTrue
  }

  //IPv6
  //@see: http://www.ronnutter.com/ipv6-cheatsheet-on-identifying-valid-ipv6-addresses/
  "return false if the IPv6 is invalid" in {
    ip("1200::AB00:1234::2552:7777:1313") must beFalse
  }

  "return true if the IPv6 is valid" in {
    ip("1200:0000:AB00:1234:0000:2552:7777:1313") must beTrue
    ip("21DA:D3:0:2F3B:2AA:FF:FE28:9C5A") must beTrue
  }
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-10-01T08:06:15.053

在 Java 中，您可以使用库类`sun.net.util.IPAddressUtil`：

```
IPAddressUtil.isIPv6LiteralAddress(iPaddress); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-02-03T00:38:13.930

It is difficult to find a regular expression which works for all IPv6 cases. They are usually hard to maintain, not easily readable and may cause performance problems. Hence, I want to share an alternative solution which I have developed: [Regular Expression (RegEx) for IPv6 Separate from IPv4](https://stackoverflow.com/questions/21631669/regular-expression-regex-for-ipv6-separate-from-ipv4/28289229#28289229)

Now you may ask that "This method only finds IPv6, how can I find IPv6 in a text or file?" Here are methods for this issue too.

**Note**: If you do not want to use IPAddress class in .NET, you can also replace it with [my method](https://stackoverflow.com/questions/21631669/regular-expression-regex-for-ipv6-separate-from-ipv4/28289229#28289229). It also covers mapped IPv4 and special cases too, while IPAddress does not cover.

```
class IPv6
{
    public List<string> FindIPv6InFile(string filePath)
    {
        Char ch;
        StringBuilder sbIPv6 = new StringBuilder();
        List<string> listIPv6 = new List<string>();
        StreamReader reader = new StreamReader(filePath);
        do
        {
            bool hasColon = false;
            int length = 0;

            do
            {
                ch = (char)reader.Read();

                if (IsEscapeChar(ch))
                    break;

                //Check the first 5 chars, if it has colon, then continue appending to stringbuilder
                if (!hasColon && length < 5)
                {
                    if (ch == ':')
                    {
                        hasColon = true;
                    }
                    sbIPv6.Append(ch.ToString());
                }
                else if (hasColon) //if no colon in first 5 chars, then dont append to stringbuilder
                {
                    sbIPv6.Append(ch.ToString());
                }

                length++;

            } while (!reader.EndOfStream);

            if (hasColon && !listIPv6.Contains(sbIPv6.ToString()) && IsIPv6(sbIPv6.ToString()))
            {
                listIPv6.Add(sbIPv6.ToString());
            }

            sbIPv6.Clear();

        } while (!reader.EndOfStream);
        reader.Close();
        reader.Dispose();

        return listIPv6;
    }

    public List<string> FindIPv6InText(string text)
    {
        StringBuilder sbIPv6 = new StringBuilder();
        List<string> listIPv6 = new List<string>();

        for (int i = 0; i < text.Length; i++)
        {
            bool hasColon = false;
            int length = 0;

            do
            {
                if (IsEscapeChar(text[length + i]))
                    break;

                //Check the first 5 chars, if it has colon, then continue appending to stringbuilder
                if (!hasColon && length < 5)
                {
                    if (text[length + i] == ':')
                    {
                        hasColon = true;
                    }
                    sbIPv6.Append(text[length + i].ToString());
                }
                else if (hasColon) //if no colon in first 5 chars, then dont append to stringbuilder
                {
                    sbIPv6.Append(text[length + i].ToString());
                }

                length++;

            } while (i + length != text.Length);

            if (hasColon && !listIPv6.Contains(sbIPv6.ToString()) && IsIPv6(sbIPv6.ToString()))
            {
                listIPv6.Add(sbIPv6.ToString());
            }

            i += length;
            sbIPv6.Clear();
        }

        return listIPv6;
    }

    bool IsEscapeChar(char ch)
    {
        if (ch != ' ' && ch != '\r' && ch != '\n' && ch!='\t')
        {
            return false;
        }

        return true;
    }

    bool IsIPv6(string maybeIPv6)
    {
        IPAddress ip;
        if (IPAddress.TryParse(maybeIPv6, out ip))
        {
            return ip.AddressFamily == AddressFamily.InterNetworkV6;
        }
        else
        {
            return false;
        }
    }

} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-01-16T18:15:59.767

使用红宝石？尝试这个：

```
/^(((?=.*(::))(?!.*\3.+\3))\3?|[\dA-F]{1,4}:)([\dA-F]{1,4}(\3|:\b)|\2){5}(([\dA-F]{1,4}(\3|:\b|$)|\2){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})\z/i 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-02-25T05:37:08.417

`InetAddressUtils`定义了所有模式。我最终直接使用了他们的模式，并将其粘贴在这里以供参考：

```
private static final String IPV4_BASIC_PATTERN_STRING =
        "(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}" + // initial 3 fields, 0-255 followed by .
         "([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])"; // final field, 0-255

private static final Pattern IPV4_PATTERN =
    Pattern.compile("^" + IPV4_BASIC_PATTERN_STRING + "$");

private static final Pattern IPV4_MAPPED_IPV6_PATTERN = // TODO does not allow for redundant leading zeros
        Pattern.compile("^::[fF]{4}:" + IPV4_BASIC_PATTERN_STRING + "$");

private static final Pattern IPV6_STD_PATTERN =
    Pattern.compile(
            "^[0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4}){7}$");

private static final Pattern IPV6_HEX_COMPRESSED_PATTERN =
    Pattern.compile(
            "^(([0-9A-Fa-f]{1,4}(:[0-9A-Fa-f]{1,4}){0,5})?)" + // 0-6 hex fields
             "::" +
             "(([0-9A-Fa-f]{1,4}(:[0-9A-Fa-f]{1,4}){0,5})?)$"); // 0-6 hex fields 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-11-18T22:50:47.850

对于 PHP 5.2+ 用户来说`filter_var`效果很好。

我知道这不能回答最初的问题（特别是正则表达式解决方案），但我发布这个是希望它可以在未来帮助其他人。

```
$is_ip4address = (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) !== FALSE);
$is_ip6address = (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6) !== FALSE); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-02-22T23:33:46.133

您可以使用我为此目的制作[的 ipextract shell 工具。](https://github.com/philpraxis/ipextract)它们基于正则表达式和 grep。

用法：

```
$ ifconfig | ipextract6
fe80::1%lo0
::1
fe80::7ed1:c3ff:feec:dee1%en0 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-09-29T17:14:12.420

这是我想出的，使用了一些前瞻和命名组。这当然只是 IPv6，但如果您想添加 IPv4，它不应该干扰其他模式：

```
(?=([0-9a-f]+(:[0-9a-f])*)?(?P<wild>::)(?!([0-9a-f]+:)*:))(::)?([0-9a-f]{1,4}:{1,2}){0,6}(?(wild)[0-9a-f]{0,4}|[0-9a-f]{1,4}:[0-9a-f]{1,4}) 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-04-09T13:33:38.677

只需匹配来自包含方括号的来源的本地内容。我知道它没有那么全面，但是在 javascript 中，其他的很难追踪主要是不工作的问题，所以这似乎让我得到了我现在需要的东西。也不需要额外的大写字母AF。

```
^\[([0-9a-fA-F]{1,4})(\:{1,2})([0-9a-fA-F]{1,4})(\:{1,2})([0-9a-fA-F]{1,4})(\:{1,2})([0-9a-fA-F]{1,4})(\:{1,2})([0-9a-fA-F]{1,4})\] 
```

Jinnko 的版本是简化的，我看到的更好。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-07-24T00:34:33.480

如上所述，获得 IPv6 文本表示**验证**解析器的另一种方法是使用编程。这是完全符合 RFC-4291 和 RFC-5952 的。我已经用 ANSI C 编写了这段代码（与 GCC 一起使用，在 Linux 上通过了测试 - 与 clang 一起使用，在 FreeBSD 上通过了测试）。因此，它只依赖于 ANSI C 标准库，所以它可以在任何地方编译（我在 FreeBSD 的内核模块中使用它来解析 IPv6）。

```
// IPv6 textual representation validating parser fully compliant with RFC-4291 and RFC-5952
// BSD-licensed / Copyright 2015-2017 Alexandre Fenyo

#include <string.h>
#include <netinet/in.h>
#include <stdlib.h>
#include <stdio.h>
#include <ctype.h>

typedef enum { false, true } bool;

static const char hexdigits[] = "0123456789abcdef";
static int digit2int(const char digit) {
  return strchr(hexdigits, digit) - hexdigits;
}

// This IPv6 address parser handles any valid textual representation according to RFC-4291 and RFC-5952.
// Other representations will return -1.
//
// note that str input parameter has been modified when the function call returns
//
// parse_ipv6(char *str, struct in6_addr *retaddr)
// parse textual representation of IPv6 addresses
// str:     input arg
// retaddr: output arg
int parse_ipv6(char *str, struct in6_addr *retaddr) {
  bool compressed_field_found = false;
  unsigned char *_retaddr = (unsigned char *) retaddr;
  char *_str = str;
  char *delim;

  bzero((void *) retaddr, sizeof(struct in6_addr));
  if (!strlen(str) || strchr(str, ':') == NULL || (str[0] == ':' && str[1] != ':') ||
      (strlen(str) >= 2 && str[strlen(str) - 1] == ':' && str[strlen(str) - 2] != ':')) return -1;

  // convert transitional to standard textual representation
  if (strchr(str, '.')) {
    int ipv4bytes[4];
    char *curp = strrchr(str, ':');
    if (curp == NULL) return -1;
    char *_curp = ++curp;
    int i;
    for (i = 0; i < 4; i++) {
      char *nextsep = strchr(_curp, '.');
      if (_curp[0] == '0' || (i < 3 && nextsep == NULL) || (i == 3 && nextsep != NULL)) return -1;
      if (nextsep != NULL) *nextsep = 0;
      int j;
      for (j = 0; j < strlen(_curp); j++) if (_curp[j] < '0' || _curp[j] > '9') return -1;
      if (strlen(_curp) > 3) return -1;
      const long val = strtol(_curp, NULL, 10);
      if (val < 0 || val > 255) return -1;
      ipv4bytes[i] = val;
      _curp = nextsep + 1;
    }
    sprintf(curp, "%x%02x:%x%02x", ipv4bytes[0], ipv4bytes[1], ipv4bytes[2], ipv4bytes[3]);
  }

  // parse standard textual representation
  do {
    if ((delim = strchr(_str, ':')) == _str || (delim == NULL && !strlen(_str))) {
      if (delim == str) _str++;
      else if (delim == NULL) return 0;
      else {
        if (compressed_field_found == true) return -1;
        if (delim == str + strlen(str) - 1 && _retaddr != (unsigned char *) (retaddr + 1)) return 0;
        compressed_field_found = true;
        _str++;
        int cnt = 0;
        char *__str;
        for (__str = _str; *__str; ) if (*(__str++) == ':') cnt++;
        unsigned char *__retaddr = - 2 * ++cnt + (unsigned char *) (retaddr + 1);
        if (__retaddr <= _retaddr) return -1;
        _retaddr = __retaddr;
      }
    } else {
      char hexnum[4] = "0000";
      if (delim == NULL) delim = str + strlen(str);
      if (delim - _str > 4) return -1;
      int i;
      for (i = 0; i < delim - _str; i++)
        if (!isxdigit(_str[i])) return -1;
        else hexnum[4 - (delim - _str) + i] = tolower(_str[i]);
      _str = delim + 1;
      *(_retaddr++) = (digit2int(hexnum[0]) << 4) + digit2int(hexnum[1]);
      *(_retaddr++) = (digit2int(hexnum[2]) << 4) + digit2int(hexnum[3]);
    }
  } while (_str < str + strlen(str));
  return 0;
} 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2013-12-06T11:41:55.090

This will work for IPv4 and IPv6:

```
^(([0-9a-f]{0,4}:){1,7}[0-9a-f]{1,4}|([0-9]{1,3}\.){3}[0-9]{1,3})$ 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2016-06-19T02:10:50.500

试试这个小的单线。它应该只匹配有效的未压缩/压缩 IPv6 地址（无 IPv4 混合）

```
/(?!.*::.*::)(?!.*:::.*)(?!:[a-f0-9])((([a-f0-9]{1,4})?[:](?!:)){7}|(?=(.*:[:a-f0-9]{1,4}::|^([:a-f0-9]{1,4})?::))(([a-f0-9]{1,4})?[:]{1,2}){1,6})[a-f0-9]{1,4}/ 
```

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2009-10-15T15:01:11.440

正则表达式允许在 IPv4 部分中使用前导零。

一些 Unix 和 Mac 发行版将这些段转换为八进制。

我建议`25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d`用作 IPv4 段。

* * *

## 回答 #30

> 赞同：-2
> 
> 时间：2013-07-24T14:24:17.577

如果你只想要普通的 IP-s（没有斜杠），这里：

```
^(?:[0-9a-f]{1,4}(?:::)?){0,7}::[0-9a-f]+$ 
```

我将它用于主机文件编辑器应用程序中的语法荧光笔。作为魅力发挥作用。

# .net - 是否可以确定哪个进程启动我的 .Net 应用程序？

> ID：53501
> 
> 赞同：8
> 
> 时间：2008-09-10T06:04:13.237
> 
> 标签：.net, windows, process-management

我正在.Net 中开发控制台应用程序，我想根据应用程序是从 cmd.exe 或 explorer.exe 启动的信息稍微改变一个行为。是否可以？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-10T06:32:40.160

```
Process this_process = Process.GetCurrentProcess();
int parent_pid = 0;
using (ManagementObject MgmtObj = new ManagementObject("win32_process.handle='" + this_process.Id.ToString() + "'"))
{
    MgmtObj.Get();
    parent_pid = Convert.ToInt32(MgmtObj["ParentProcessId"]);
}
string parent_process_name = Process.GetProcessById(parent_pid).ProcessName; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T06:16:00.980

CreateToolhelp32Snapshot[函数](http://msdn.microsoft.com/en-us/library/ms682489(VS.85).aspx)有一个 Process32First 方法，可让您读取[PROCESSENTRY32 结构](http://msdn.microsoft.com/en-us/library/ms684839(VS.85).aspx)。该结构具有一个属性，可以为您提供所需的信息：

> **th32ParentProcessID** - 创建此进程（其父进程）的进程的标识符。

本文将帮助您开始使用 ToolHelpSnapshot 功能：

[http://www.codeproject.com/KB/cs/IsApplicationRunning.aspx](http://www.codeproject.com/KB/cs/IsApplicationRunning.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T07:40:43.630

ToolHelp/ManagementObject 方法的一个问题是父进程可能已经退出。

GetStartupInfo Win32 函数（如果没有 .NET 等效函数，则使用 PInvoke）填充包含窗口标题的结构。对于 Win32 控制台应用程序“app.exe”，此标题字符串在从 cmd 启动时为“app”，从资源管理器（或 VS 调试器）启动时为“c:\full\path\to\app.exe”。

当然，这是一个 hack（可能会在其他版本中发生变化等）。

```
#define WIN32_LEAN_AND_MEAN
#include <windows.h>
int main()
{
  STARTUPINFO si;
  GetStartupInfo(&si);
  MessageBox(NULL, si.lpTitle, NULL, MB_OK);
  return 0;
} 
```

# ruby-on-rails - Ruby on Rails 中使用 Restful_Authentication 的纯文本密码

> ID：53511
> 
> 赞同：0
> 
> 时间：2008-09-10T06:19:42.250
> 
> 标签：ruby-on-rails, ruby, authentication, rest

如果我在我的 ruby​​ on rails 应用程序中使用 restful_authentication，密码会在浏览器和服务器之间以 paintext 传输吗？如果是这样，我应该对此有多担心？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T06:26:31.920

好吧，如果你不是通过 HTTPS 托管它，你需要担心......因为如果它是直接的 HTTP，那么是的，它是以明文形式传递的。

我不具体了解 Rails，但我很确定它与您是通过 HTTP 还是 HTTPS 托管它无关。

编辑：我发现[这个链接](http://blog.caboo.se/articles/2007/4/21/sample-rails-app-branch-with-ssl)显然提供了一个通过 HTTPS 的示例 Rails 应用程序。

进一步编辑：这是[另一个](http://weeatbricks.com/2007/10/31/how-to-use-a-rails-app-with-https/)讨论 HTTPS 与 Rails 的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T02:27:54.370

如果您担心密码的隐私（而且[您应该](http://www.betterthansimple.com/blog/2008/06/26/always-encrypt-passwords/)如此），您还需要将此行添加到您的 ApplicationController：

```
filter_parameter_logging :password 
```

否则，密码将以纯文本形式出现在您的日志文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T06:27:46.737

可以使用 CHAP 样式协议完成纯文本身份验证。这可能通过HTTP吗？

我在问，因为我认为它需要服务器上的一些状态来阻止重放攻击——服务器上的状态是 RESTful 架构可以消除的，对吧？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-08T07:04:28.983

你绝对应该看看 bcrypt gem。它将为您散列所有密码。

# python - 如何检查列表是否为空？

> ID：53513
> 
> 赞同：3231
> 
> 时间：2008-09-10T06:20:11.000
> 
> 标签：python, list

例如，如果通过以下内容：

```
a = [] 
```

如何检查是否`a`为空？

* * *

## 回答 #1

> 赞同：6657
> 
> 时间：2008-09-10T06:28:05.147

```
if not a:
  print("List is empty") 
```

使用空的[隐式布尔](https://docs.python.org/library/stdtypes.html#truth-value-testing)`list`值是非常 Pythonic 的。

* * *

## 回答 #2

> 赞同：1372
> 
> 时间：2008-09-10T10:33:38.113

pythonic 的方法来自[PEP 8 style guide](https://www.python.org/dev/peps/pep-0008)。

> 对于序列（字符串、列表、元组），使用空序列为假的事实：
> 
> ```
> # Correct:
> if not seq:
> if seq:
> 
> # Wrong:
> if len(seq):
> if not len(seq): 
> ```

* * *

## 回答 #3

> 赞同：969
> 
> 时间：2011-09-05T00:30:30.423

我更喜欢它：

```
if len(li) == 0:
    print('the list is empty') 
```

这样就 100% 清楚这`li`是一个序列（列表），我们想要测试它的大小。我的问题`if not li: ...`是它给人的错误印象`li`是布尔变量。

* * *

## 回答 #4

> 赞同：389
> 
> 时间：2012-02-21T16:48:02.057

[这是“python 测试空数组”和类似查询的第一个 google 命中，而且其他人似乎将这个问题概括为不仅仅是列表，所以我想我会为很多人的不同类型的序列添加一个警告可能会使用。]

# 其他方法不适用于 NumPy 数组

您需要小心使用 NumPy 数组，因为其他适用于`list`s 或其他标准容器的方法对 NumPy 数组无效。我在下面解释原因，但简而言之，[首选方法](http://www.scipy.org/scipylib/faq.html#what-is-the-preferred-way-to-check-for-an-empty-zero-element-array)是使用`size`.

### “pythonic”方式不起作用：第 1 部分

NumPy 数组的“pythonic”方式失败了，因为 NumPy 尝试将数组转换为`bool`s 数组，并`if x`尝试`bool`一次评估所有这些 s 以获得某种聚合真值。但这没有任何意义，所以你得到一个`ValueError`：

```
>>> x = numpy.array([0,1])
>>> if x: print("x")
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

### “pythonic”方式不起作用：第 2 部分

但至少上面的案例告诉你它失败了。如果你碰巧有一个只有一个元素的 NumPy 数组，那么该`if`语句将“有效”，因为你不会收到错误。但是，如果该元素恰好是`0`（或`0.0`，或`False`，...），则该`if`语句将错误地导致`False`：

```
>>> x = numpy.array([0,])
>>> if x: print("x")
... else: print("No x")
No x 
```

但明明`x`存在且不空！这个结果不是你想要的。

### 使用`len`会产生意想不到的结果

例如，

```
len( numpy.zeros((1,0)) ) 
```

返回 1，即使数组有零个元素。

### numpythonic 的方式

正如[SciPy FAQ](http://www.scipy.org/scipylib/faq.html#what-is-the-preferred-way-to-check-for-an-empty-zero-element-array)中所解释的，在您知道自己拥有 NumPy 数组的所有情况下，正确的方法是使用`if x.size`：

```
>>> x = numpy.array([0,1])
>>> if x.size: print("x")
x

>>> x = numpy.array([0,])
>>> if x.size: print("x")
... else: print("No x")
x

>>> x = numpy.zeros((1,0))
>>> if x.size: print("x")
... else: print("No x")
No x 
```

如果您不确定它可能是一个`list`、一个 NumPy 数组还是其他东西，您可以将此方法与[@dubiousjim 给出的答案](https://stackoverflow.com/a/10835703/1194883)结合起来，以确保对每种类型都使用正确的测试。不是很“pythonic”，但事实证明 NumPy 至少在这个意义上故意破坏了 pythonicity。

如果您需要做的不仅仅是检查输入是否为空，并且您正在使用其他 NumPy 功能（如索引或数学运算），则强制输入*为*NumPy 数组可能更有效（当然也更常见）。有一些很好的函数可以快速完成这项工作——最重要的是[`numpy.asarray`](https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.asarray.html). 这需要您的输入，如果它已经是一个数组，则不执行任何操作，或者如果它是一个列表、元组等，则将您的输入包装到一个数组中，并且可以选择将其转换为您选择的`dtype`. 因此，只要可以，它就非常快，并且它确保您只需假设输入是一个 NumPy 数组。我们通常甚至只使用相同的名称，因为转换为数组不会使其回到当前[范围](http://python-textbok.readthedocs.io/en/1.0/Variables_and_Scope.html)之外：

```
x = numpy.asarray(x, dtype=numpy.double) 
```

这将使`x.size`检查在我在此页面上看到的所有情况下都有效。

* * *

## 回答 #5

> 赞同：314
> 
> 时间：2017-08-20T03:50:58.437

> ## 检查列表是否为空的最佳方法
> 
> 例如，如果通过以下内容：
> 
> ```
> a = [] 
> ```
> 
> 如何检查 a 是否为空？

## 简短的回答：

将列表放在布尔上下文中（例如，使用`if`or`while`语句）。它将测试`False`它是否为空，`True`否则。例如：

```
if not a:                           # do this!
    print('a is an empty list') 
```

## 政治人物 8

[PEP 8](https://www.python.org/dev/peps/pep-0008/#programming-recommendations)是 Python 标准库中 Python 代码的官方 Python 风格指南，它断言：

> 对于序列（字符串、列表、元组），使用空序列为假的事实。
> 
> ```
> Yes: if not seq:
>      if seq:
> 
> No: if len(seq):
>     if not len(seq): 
> ```

我们应该期望标准库代码应该尽可能高效和正确。但是为什么会这样，为什么我们需要这个指导呢？

## 解释

我经常从 Python 新手有经验的程序员那里看到这样的代码：

```
if len(a) == 0:                     # Don't do this!
    print('a is an empty list') 
```

懒惰语言的用户可能会尝试这样做：

```
if a == []:                         # Don't do this!
    print('a is an empty list') 
```

这些在各自的其他语言中都是正确的。这在 Python 中甚至在语义上是正确的。

但我们认为它不是 Pythonic，因为 Python 通过布尔强制在列表对象的接口中直接支持这些语义。

从[文档](https://docs.python.org/3/library/stdtypes.html#truth-value-testing)（并特别注意包含空列表，`[]`）：

> 默认情况下，一个对象被认为是真，除非它的类定义了一个`__bool__()`返回的方法`False`或一个`__len__()`返回零的方法，当与该对象一起调用时。以下是大多数被认为是错误的内置对象：
> 
> *   常量定义为假：`None`和`False`。
> *   任何数字类型的零：`0`, `0.0`, `0j`, `Decimal(0)`,`Fraction(0, 1)`
> *   空序列和集合：`''`, `()`, `[]`, `{}`, `set()`,`range(0)`

和数据模型文档：

> [`object.__bool__(self)`](https://docs.python.org/3/reference/datamodel.html#object.__bool__)
> 
> 调用实现真值检测和内置运算`bool()`；应该返回`False`或`True`。当此方法未定义时 `__len__()`，如果已定义，则调用该方法，如果其结果为非零，则认为该对象为真。如果一个类既不定义`__len__()` 也不定义`__bool__()`，它的所有实例都被认为是真的。

和

> [`object.__len__(self)`](https://docs.python.org/3/reference/datamodel.html#object.__len__)
> 
> 调用以实现内置函数`len()`。应返回对象的长度，整数 >= 0。此外，未定义`__bool__()`方法且其`__len__()`方法返回零的对象在布尔上下文中被认为是假的。

所以代替这个：

```
if len(a) == 0:                     # Don't do this!
    print('a is an empty list') 
```

或这个：

```
if a == []:                     # Don't do this!
    print('a is an empty list') 
```

做这个：

```
if not a:
    print('a is an empty list') 
```

## 做 Pythonic 的事情通常会在性能上得到回报：

它有回报吗？（请注意，执行等效操作的时间越短越好：）

```
>>> import timeit
>>> min(timeit.repeat(lambda: len([]) == 0, repeat=100))
0.13775854044661884
>>> min(timeit.repeat(lambda: [] == [], repeat=100))
0.0984637276455409
>>> min(timeit.repeat(lambda: not [], repeat=100))
0.07878462291455435 
```

对于规模，这里是调用函​​数以及构造和返回一个空列表的成本，您可以从上面使用的空性检查的成本中减去它：

```
>>> min(timeit.repeat(lambda: [], repeat=100))
0.07074015751817342 
```

我们看到，与使用文档中的语言的内置语法相比，*使用*内置函数检查长度*或*检查空列表的性能要低**得多。**`len``0`

 ***为什么？

对于`len(a) == 0`检查：

首先 Python 必须检查全局变量以查看是否`len`被遮蔽。

然后它必须调用函数 load`0`并在 Python 中（而不是使用 C）进行相等比较：

```
>>> import dis
>>> dis.dis(lambda: len([]) == 0)
  1           0 LOAD_GLOBAL              0 (len)
              2 BUILD_LIST               0
              4 CALL_FUNCTION            1
              6 LOAD_CONST               1 (0)
              8 COMPARE_OP               2 (==)
             10 RETURN_VALUE 
```

并且`[] == []`它必须构建一个不必要的列表，然后再次在 Python 的虚拟机中进行比较操作（而不是 C）

```
>>> dis.dis(lambda: [] == [])
  1           0 BUILD_LIST               0
              2 BUILD_LIST               0
              4 COMPARE_OP               2 (==)
              6 RETURN_VALUE 
```

“Pythonic”方式是一种更简单、更快速的检查，因为列表的长度缓存在对象实例标头中：

```
>>> dis.dis(lambda: not [])
  1           0 BUILD_LIST               0
              2 UNARY_NOT
              4 RETURN_VALUE 
```

## 来自 C 源代码和文档的证据

> [`PyVarObject`](https://docs.python.org/2/c-api/structures.html#c.PyVarObject)
> 
> `PyObject`这是添加`ob_size`字段的扩展。这仅用于具有某种长度概念的对象。这种类型通常不会出现在 Python/C API 中。`PyObject_VAR_HEAD`它对应于宏扩展定义的字段。

从[Include/listobject.h](https://github.com/python/cpython/blob/master/Include/listobject.h)中的 c 源代码：

```
typedef struct {
    PyObject_VAR_HEAD
    /* Vector of pointers to list elements.  list[0] is ob_item[0], etc. */
    PyObject **ob_item;

    /* ob_item contains space for 'allocated' elements.  The number
     * currently in use is ob_size.
     * Invariants:
     *     0 <= ob_size <= allocated
     *     len(list) == ob_size 
```

## 回复评论：

> 我要指出的是，对于非空情况也是如此，尽管它非常丑陋，与`l=[]`当时的`%timeit len(l) != 0`90.6 ns ± 8.3 ns、`%timeit l != []`55.6 ns ± 3.09、38.5 `%timeit not not l`ns ± 0.372 一样。`not not l`但是，尽管速度提高了三倍，但没有人会享受。看起来很荒谬。但是速度胜出
> 我认为问题在于使用 timeit 进行测试，因为这`if l:`已经足够但令人惊讶地`%timeit bool(l)`产生 101 ns ± 2.64 ns。有趣的是，没有这种惩罚就没有办法强制 bool。`%timeit l`是无用的，因为不会发生转换。

IPython 魔法，`%timeit`在这里并非完全没用：

```
In [1]: l = []                                                                  

In [2]: %timeit l                                                               
20 ns ± 0.155 ns per loop (mean ± std. dev. of 7 runs, 100000000 loops each)

In [3]: %timeit not l                                                           
24.4 ns ± 1.58 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)

In [4]: %timeit not not l                                                       
30.1 ns ± 2.16 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each) 
```

我们可以看到这里每增加一个成本都有一点线性成本`not`。我们希望看到成本，在*其他条件不变*的情况下，即所有其他条件都相同——所有其他条件都尽可能地最小化：

```
In [5]: %timeit if l: pass                                                      
22.6 ns ± 0.963 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)

In [6]: %timeit if not l: pass                                                  
24.4 ns ± 0.796 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)

In [7]: %timeit if not not l: pass                                              
23.4 ns ± 0.793 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each) 
```

现在让我们看一下非空列表的情况：

```
In [8]: l = [1]                                                                 

In [9]: %timeit if l: pass                                                      
23.7 ns ± 1.06 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)

In [10]: %timeit if not l: pass                                                 
23.6 ns ± 1.64 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)

In [11]: %timeit if not not l: pass                                             
26.3 ns ± 1 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each) 
```

我们在这里可以看到，将实际值传递`bool`给条件检查还是列表本身几乎没有什么区别，如果有的话，按原样提供列表会更快。

Python 是用 C 编写的；它在 C 级别使用其逻辑。你用 Python 写的任何东西都会变慢。除非您直接使用 Python 内置的机制，否则它可能会慢几个数量级。

* * *

## 回答 #6

> 赞同：161
> 
> 时间：2008-09-10T06:31:22.597

在真值测试中，空列表本身被认为是错误的（请参阅[python 文档](https://docs.python.org/2/library/stdtypes.html#truth-value-testing)）：

```
a = []
if a:
     print "not empty" 
```

@达伦托马斯

> 编辑：反对将空列表测试为 False 的另一点：多态性呢？您不应该依赖列表作为列表。它应该像鸭子一样嘎嘎叫——当它没有元素时，你如何让你的鸭子集合嘎嘎叫“假”？

您的 duckCollection 应该实现if a:`__nonzero__`左右`__len__`将毫无问题地工作。

* * *

## 回答 #7

> 赞同：115
> 
> 时间：2014-12-03T02:21:29.383

[帕特里克（已接受）的答案](https://stackoverflow.com/a/53522/908494)是正确的：`if not a:`是正确的方法。[Harley Holcombe 的回答](https://stackoverflow.com/a/53752/908494)是正确的，这在 PEP 8 风格指南中。但是没有一个答案能解释为什么遵循这个成语是一个好主意——即使你个人发现它不够明确或让 Ruby 用户感到困惑或其他什么。

Python 代码和 Python 社区都有非常强大的习语。遵循这些习惯用法可以让任何有 Python 经验的人更容易阅读您的代码。当你违反这些成语时，这是一个强烈的信号。

确实`if not a:`不区分空列表与`None`，或数字 0，或空元组，或空的用户创建的集合类型，或空的用户创建的 not-quite-collection 类型，或作为标量的单元素 NumPy 数组价值观等。有时，明确这一点很重要。在这种情况下，您知道*要*明确说明的内容，因此您可以对其进行测试。例如，`if not a and a is not None:`表示“除了 None 之外的任何错误的东西”，而`if len(a) != 0:`表示“只有空序列——除了序列之外的任何东西都是错误的”，等等。除了准确地测试您想要测试的内容之外，这还向读者表明该测试很重要。

但是当你没有什么要明确说明的时候，除了`if not a:`误导读者之外的任何东西。当它不重要时，你会发出同样重要的信号。（你也可能使代码变得不那么灵活，或者更慢，或者其他什么，但这都不那么重要。）如果你*习惯性地*这样误导读者，那么当你*确实*需要做出区分时，它会被忽视，因为你在你的代码中一直在“哭狼”。

* * *

## 回答 #8

> 赞同：98
> 
> 时间：2015-10-06T19:25:34.767

# 为什么要检查？

似乎没有人一开始就质疑您*是否需要*测试该列表。因为您没有提供额外的上下文，我可以想象您可能不需要首先进行此检查，但不熟悉 Python 中的列表处理。

我认为*最pythonic*的方法是根本不检查，而只是处理列表。这样，无论是空的还是满的，它都会做正确的事情。

```
a = []

for item in a:
    <do something with item>

<rest of code> 
```

这样做的好处是可以处理 a 的任何内容**，**同时不需要特定检查是否为空。如果**a**为空，则依赖块将不会执行，解释器将进入下一行。

如果您确实需要检查数组是否为空：

```
a = []

if !a:
    <react to empty list>

<rest of code> 
```

足够了。

* * *

## 回答 #9

> 赞同：75
> 
> 时间：2008-09-15T05:50:48.547

[`len()`](http://books.google.com/books?id=vpTAq4dnmuAC&pg=RA1-PA479&lpg=RA1-PA479&dq=Python+len+big+O&source=web&ots=AOM6A1K9Fy&sig=iQo8mV6Xf9KdzuNSa-Jkr8wDEuw&hl=en&sa=X&oi=book_result&resnum=4&ct=result)是Python 列表、字符串、字典和集合[的 O(1) 操作。](http://books.google.com/books?id=vpTAq4dnmuAC&pg=RA1-PA479&lpg=RA1-PA479&dq=Python+len+big+O&source=web&ots=AOM6A1K9Fy&sig=iQo8mV6Xf9KdzuNSa-Jkr8wDEuw&hl=en&sa=X&oi=book_result&resnum=4&ct=result)Python 在内部跟踪这些容器中的元素数量。

JavaScript[也有类似的truthy/falsy 概念](http://www.isolani.co.uk/blog/javascript/TruthyFalsyAndTypeCasting)。

* * *

## 回答 #10

> 赞同：53
> 
> 时间：2012-05-31T14:35:05.343

我曾写过：

```
if isinstance(a, (list, some, other, types, i, accept)) and not a:
    do_stuff 
```

被投票-1。我不确定这是否是因为读者反对该策略或认为答案没有帮助。我会假装是后者，因为——无论什么算作“pythonic”——这是正确的策略。除非您已经排除或准备处理`a`例如 的情况，否则`False`您需要一个比 . 更具限制性的测试`if not a:`。你可以使用这样的东西：

```
if isinstance(a, numpy.ndarray) and not a.size:
    do_stuff
elif isinstance(a, collections.Sized) and not a:
    do_stuff 
```

第一个测试是对上面@Mike 的回答。第三行也可以替换为：

```
elif isinstance(a, (list, tuple)) and not a: 
```

如果您只想接受特定类型（及其子类型）的实例，或者：

```
elif isinstance(a, (list, tuple)) and not len(a): 
```

您可以在没有显式类型检查的情况下逃脱，但前提是周围的上下文已经向您保证这`a`是您准备处理的类型的值，或者您确定您不准备处理的类型正在发生引发您准备处理的错误（例如，`TypeError`如果您调用未定义的值）。`len`一般来说，“pythonic”约定似乎是最后一种方式。像鸭子一样挤压它，如果它不知道如何嘎嘎叫，让它引发 DuckError。但是，您仍然需要*考虑*您所做的类型假设，以及您未准备好正确处理的案例是否真的会在正确的地方出错。Numpy 数组是一个很好的例子，它只是盲目地依赖`len`或者布尔类型转换可能不会完全符合您的预期。

* * *

## 回答 #11

> 赞同：37
> 
> 时间：2008-09-10T06:43:14.393

我更喜欢以下内容：

```
if a == []:
   print "The list is empty." 
```

* * *

## 回答 #12

> 赞同：37
> 
> 时间：2016-01-01T18:18:58.703

来自关于真值测试的[文档：](https://docs.python.org/3.5/library/stdtypes.html#truth-value-testing)

此处列出的值以外的所有值都被考虑`True`

*   `None`
*   `False`
*   任何数字类型的零，例如`0`, `0.0`, `0j`。
*   任何空序列，例如`''`, `()`, `[]`.
*   任何空映射，例如`{}`.
*   用户定义类的实例，如果该类定义了一个`__bool__()`or`__len__()`方法，当该方法返回整数零或 bool 值时`False`。

可以看出，空列表`[]`是*falsy*，所以对布尔值执行的操作听起来最有效：

```
if not a:
    print('"a" is empty!') 
```

* * *

## 回答 #13

> 赞同：34
> 
> 时间：2016-11-28T14:18:03.180

您可以通过以下几种方法检查列表是否为空：

```
a = [] #the list 
```

**1）**非常简单的pythonic方式：

```
if not a:
    print("a is empty") 
```

在 Python 中，**空容器**（如列表、元组、集合、字典、变量等）被视为`False`. 可以简单地将列表视为谓词（*返回布尔值*）。一个`True`值将表明它是非空的。

**2）**一种更明确的方式：使用`len()`来查找长度并检查它是否等于`0`：

```
if len(a) == 0:
    print("a is empty") 
```

**3）**或将其与匿名空列表进行比较：

```
if a == []:
    print("a is empty") 
```

**4）**另一种*愚蠢*的做法是使用`exception`and `iter()`：

```
try:
    next(iter(a))
    # list has elements
except StopIteration:
    print("Error: a is empty") 
```

* * *

## 回答 #14

> 赞同：29
> 
> 时间：2019-02-09T23:59:54.157

方法1（首选）：

```
if not a : 
   print ("Empty") 
```

方法二：

```
if len(a) == 0 :
   print( "Empty" ) 
```

方法三：

```
if a == [] :
  print ("Empty") 
```

* * *

## 回答 #15

> 赞同：24
> 
> 时间：2016-09-13T11:53:56.763

你甚至可以尝试`bool()`像这样使用。尽管它的可读性肯定较低，但它是执行此操作的一种简洁方式。

```
 a = [1,2,3];
    print bool(a); # it will return True
    a = [];
    print bool(a); # it will return False 
```

我喜欢这种方式，因为检查列表是否为空。

非常方便和有用。

* * *

## 回答 #16

> 赞同：18
> 
> 时间：2016-04-13T21:55:32.423

```
def list_test (L):
    if   L is None  : print('list is None')
    elif not L      : print('list is empty')
    else: print('list has %d elements' % len(L))

list_test(None)
list_test([])
list_test([1,2,3]) 
```

有时最好分别测试`None`空虚和空虚，因为它们是两种不同的状态。上面的代码产生以下输出：

```
list is None 
list is empty 
list has 3 elements 
```

尽管它是虚假的，但它`None`一文不值。因此，如果您不想单独测试`None`-ness，则不必这样做。

```
def list_test2 (L):
    if not L      : print('list is empty')
    else: print('list has %d elements' % len(L))

list_test2(None)
list_test2([])
list_test2([1,2,3]) 
```

产生预期

```
list is empty
list is empty
list has 3 elements 
```

* * *

## 回答 #17

> 赞同：15
> 
> 时间：2018-03-05T11:30:01.000

如果要检查列表是否为空：

```
l = []
if l:
    # do your stuff. 
```

如果要检查列表中的所有值是否为空。但是它将是`True`一个空列表：

```
l = ["", False, 0, '', [], {}, ()]
if all(bool(x) for x in l):
    # do your stuff. 
```

如果您想同时使用这两种情况：

```
def empty_list(lst):
    if len(lst) == 0:
        return False
    else:
        return all(bool(x) for x in l) 
```

现在您可以使用：

```
if empty_list(lst):
    # do your stuff. 
```

* * *

## 回答 #18

> 赞同：15
> 
> 时间：2018-10-12T04:01:59.470

已经给出了很多答案，其中很多都很好。我只是想补充一下支票

```
not a 
```

还将传递 for`None`和其他类型的空结构。如果你真的想检查一个空列表，你可以这样做：

```
if isinstance(a, list) and len(a)==0:
    print("Received an empty list") 
```

* * *

## 回答 #19

> 赞同：15
> 
> 时间：2018-12-26T00:05:06.807

> 要检查列表是否为空，您可以使用以下两种方法。但请记住，我们应该避免显式检查序列类型的方式（这是一种**不那么 Python**的方式）：

```
def enquiry(list1):
    return len(list1) == 0

# ––––––––––––––––––––––––––––––––

list1 = [] 

if enquiry(list1): 
    print("The list isn't empty") 
else: 
    print("The list is Empty") 

# Result: "The list is Empty". 
```

> 第二种方式是一种**更 Pythonic**的方式。这种方法是一种隐式检查方法，比前一种方法更可取。

```
def enquiry(list1): 
    return not list1

# ––––––––––––––––––––––––––––––––

list1 = [] 

if enquiry(list1): 
    print("The list is Empty") 
else: 
    print("The list isn't empty") 

# Result: "The list is Empty" 
```

希望这可以帮助。

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2017-03-29T02:58:02.140

受到@dubiousjim 解决方案的启发，我建议使用额外的一般检查来检查它是否是可迭代的

```
import collections
def is_empty(a):
    return not a and isinstance(a, collections.Iterable) 
```

注意：字符串被认为是可迭代的。- 添加`and not isinstance(a,(str,unicode))`是否要排除空字符串

测试：

```
>>> is_empty('sss')
False
>>> is_empty(555)
False
>>> is_empty(0)
False
>>> is_empty('')
True
>>> is_empty([3])
False
>>> is_empty([])
True
>>> is_empty({})
True
>>> is_empty(())
True 
```

* * *

## 回答 #21

> 赞同：11
> 
> 时间：2018-11-03T02:23:02.233

```
print('not empty' if a else 'empty') 
```

更实用一点：

```
a.pop() if a else None 
```

和最短的版本：

```
if a: a.pop() 
```

* * *

## 回答 #22

> 赞同：11
> 
> 时间：2019-01-06T19:15:13.933

我们可以使用一个简单的 if else：

```
item_list=[]
if len(item_list) == 0:
    print("list is empty")
else:
    print("list is not empty") 
```

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2017-08-26T19:04:05.863

只需使用 is_empty() 或制作如下函数：-

```
def is_empty(any_structure):
    if any_structure:
        print('Structure is not empty.')
        return True
    else:
        print('Structure is empty.')
        return False 
```

它可以用于任何数据结构，如列表、元组、字典等等。通过这些，您可以使用 just 多次调用它`is_empty(any_structure)`。

* * *

## 回答 #24

> 赞同：8
> 
> 时间：2018-10-12T02:59:58.930

简单的方法是检查长度是否为零。

```
if len(a) == 0:
    print("a is empty") 
```

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2018-11-06T09:55:45.857

从 python3 开始，您可以使用

```
a == [] 
```

检查列表是否为空

编辑：这也适用于 python2.7..

我不知道为什么会有这么多复杂的答案。它非常清晰明了

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2018-05-16T04:13:04.293

空列表的真值是，`False`而对于非空列表，它是`True`。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2019-04-24T15:07:03.550

把我带到这里的是一个特殊的用例：我实际上想要一个*函数*来告诉我列表是否为空。我想避免在这里编写自己的函数或使用 lambda 表达式（因为它看起来应该足够简单）：

```
foo = itertools.takewhile(is_not_empty, (f(x) for x in itertools.count(1))) 
```

当然，有一种非常自然的方法可以做到这一点：

```
foo = itertools.takewhile(bool, (f(x) for x in itertools.count(1))) 
```

当然，不要**使用**in `bool`( `if`ie, `if bool(L):`)，因为它是隐含的。但是，对于明确需要“不为空”作为函数的情况，`bool`这是最好的选择。

# sql-server - 如何在 SQL Server 中对数据库进行单元测试？

> ID：53527
> 
> 赞同：2
> 
> 时间：2008-09-10T06:33:55.443
> 
> 标签：sql-server, unit-testing

有哪些方法？你可以使用哪些框架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T06:36:48.433

好吧，我假设您的意思是对命中数据库的代码进行单元测试，在这种情况下，有[NDbUnit](http://www.ndbunit.org/)，它似乎是 .NET 的 DbUnit 克隆。我从未使用过它，但我使用过 DbUnit，它非常有用。

编辑：我假设您使用的是 .NET，因为您提到了 MSSQL。但是，如果您实际使用的是 Java，则有[DbUnit](http://www.dbunit.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T09:44:24.410

这是一个这样做的项目：http: [//tsqlunit.sourceforge.net/](http://tsqlunit.sourceforge.net/)

此外，Visual Studio Team System for DBA 内置了对数据库单元测试的支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T18:00:44.430

[TST T-SQL 测试工具](http://tst.codeplex.com/)

> TST 是一种工具，可简化为用 T-SQL 编写的代码编写和运行测试自动化的任务。TST 工具的核心是 TST 数据库。该数据库包含一系列作为测试 API 公开的存储过程。此 API 的一部分与 C# 或 Java 程序员熟悉的单元测试库中的 API 相似。

# eclipse - 单元测试 servlet

> ID：53532
> 
> 赞同：14
> 
> 时间：2008-09-10T06:42:34.223
> 
> 标签：eclipse, unit-testing, tomcat, servlets, junit

我有一堆在 Tomcat servlet 容器下运行的 servlet。我想将测试代码与生产代码分开，所以我考虑使用测试框架。JUnit 很好地集成到 Eclipse 中，但我未能使用正在运行的 Tomcat 服务器使其运行 servlet。您能否推荐一个支持测试 Tomcat servlet 的单元测试框架？Eclipse 集成很好，但不是必需的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T18:06:02.057

查看[ServletUnit](http://httpunit.sourceforge.net/doc/servletunit-intro.html)，它是 HttpUnit 的一部分。简而言之，ServletUnit 提供了一个模拟库和实用程序库，您可以在普通 JUnit 测试中使用这些模拟和实用程序来模拟 servlet 容器和其他与 servlet 相关的对象，例如请求和响应对象。上面的链接包含示例。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-01T15:31:29.963

Spring 框架为 Servlet API 之外的几个类提供了很好的现成模拟对象：

[http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/mock/web/package-summary.html](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/mock/web/package-summary.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-10T06:50:43.017

好的。忽略 'tomcat' 位和对 servlet 的编码，最好的办法是为响应和请求对象创建模拟，然后告诉它你对它的期望。

因此，对于标准的空 doPost 并使用[EasyMock](http://www.easymock.org)，您将拥有

```
public void testPost() {
   mockRequest = createMock(HttpServletRequest.class);
   mockResponse = createMock(HttpServletResponse.class);
   replay(mockRequest, mockResponse);
   myServlet.doPost(mockRequest, mockResponse);
   verify(mockRequest, mockResponse);
} 
```

然后开始向 doPost 添加代码。模拟会失败，因为它们没有期望，然后你可以从那里设置期望。

请注意，如果您想将 EasyMock 与类一起使用，则必须使用 EasyMock 类扩展库。但从那时起它会以同样的方式工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-10T12:19:08.633

将处理 HTTP 请求和响应的代码部分与执行业务逻辑或数据库操作的部分分开。在大多数情况下，这将产生一个三层架构，具有数据层（用于数据库/持久性）、服务层（用于业务逻辑）和表示层（用于 HTTP 请求和响应）。

1.  您可以对前两层进行单元测试，而无需任何 servlet 东西；这样测试会更容易。
2.  [正如其他人建议](https://stackoverflow.com/a/158237/545127)的那样，您可以使用模拟 HTTP 请求和响应对象来测试表示层。
3.  最后，如果您觉得确实有必要，您可以使用[HtmlUnit](http://htmlunit.sourceforge.net/)或[JWebUnit](http://jwebunit.sourceforge.net/)等工具进行集成测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T07:11:25.743

对于“容器内”测试，请查看[Cactus](http://jakarta.apache.org/cactus/)

如果您希望能够在没有运行容器的情况下进行测试，您可以使用您自己的模拟对象（例如使用[EasyMock](http://www.easymock.org)）模拟其组件，或者您可以尝试[MockRunner](http://mockrunner.sourceforge.net/examplesservlets.html)，它具有用于测试 servlet、jdbc-connections 等的“预定义”存根。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-27T19:02:33.743

2018 年 2 月更新：[OpenBrace Limited 已关闭](https://closingbraces.net/openbrace/)，不再支持其 ObMimic 产品。

如果您想要一个更新的 ServletUnit 替代品来对 Servlet 进行 JUnit 测试，您可能会发现我公司的[ObMimic](http://www.openbrace.com)库很有用。它可以从网站的[下载](http://www.openbrace.com/main/pages/download/download-current.html)页面免费获得。

与 ServletUnit 一样，它提供了一个类库，您可以在任何 servlet 容器之外的普通 JUnit 或 TestNG 测试中使用这些类库来模拟 Servlet API。

Its Servlet API objects have no-argument constructors, are fully configurable and inspectable for all relevant Servlet API data and settings, and provide a complete simulation of all of the behaviour specified by the Servlet API's javadoc. To help with testing there's support for selective recording of Servlet API calls, control over any container-dependent behaviour, checks for any ambiguous calls (i.e. where the Servlet API behavour isn't fully defined), and an in-memory JNDI simulation for any servlet code that relies on JNDI lookups.

For full details, example code, "how to" guides, Javadoc etc, see the website.

# sql - SQL Server 自由文本匹配 - 我如何按相关性排序

> ID：53538
> 
> 赞同：8
> 
> 时间：2008-09-10T06:56:15.860
> 
> 标签：sql, sql-server, full-text-search, freetext

是否可以通过自由文本匹配的相关性对 SQL Server 2005 中的结果进行排序？在 MySQL 中，您可以在 ORDER BY 部分中使用（大致等效的）MATCH 函数，但我在 SQL Server 中没有发现任何等效函数。

来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/fulltext-natural-language.html)：

> 对于表中的每一行，MATCH() 返回一个相关值；也就是说，搜索字符串与 MATCH() 列表中命名的列中该行中的文本之间的相似性度量。

因此，例如，您可以按票数排序，然后按相关性排序，最后按创建日期排序。这是可以做到的，还是我坚持只返回匹配值而没有这种排序能力？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T07:01:57.857

如果您正在使用，`FREETEXTTABLE`那么它会返回一个列名`Rank`，所以`order by Rank`应该可以工作。我不知道其他自由文本搜索方法是否也返回此值。你可以试一试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-12T02:19:20.080

两者`FREETEXTTABLE`和`CONTAINSTABLE`都将返回该`[RANK]`列，但请确保您使用正确的变体或合并它们以获得所有适当的结果。

# python - 编写适用于 CPython、Jython 和 IronPython 的 Python 代码的一些策略是什么

> ID：53543
> 
> 赞同：16
> 
> 时间：2008-09-10T07:04:43.920
> 
> 标签：python, ironpython, jython, cpython

尝试同时针对其中两个环境，我可以肯定地说，如果您必须使用数据库等，您最终必须为该环境编写独特的代码。你有一个很好的方法来处理这种情况吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-10T07:07:59.310

如果您*确实*发现需要为环境编写独特的代码，请使用 pythons

```
import mymodule_jython as mymodule

import mymodule_cpython as mymodule 
```

将这些东西放在一个简单的模块中（''module_importer''？）并编写如下代码：

```
from module_importer import mymodule 
```

这样，您需要做的就是`module_importer.py`根据平台进行更改。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-10T21:00:04.177

@Daren Thomas：我同意，但是您应该使用[平台模块](http://docs.python.org/dev/library/platform.html#platform.python_implementation)来确定您正在运行的解释器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T22:33:17.953

我为 CPython 和 IronPython 编写代码，但tip 也适用于 Jython。

基本上，我将所有特定于平台的代码编写在单独的模块/包中，然后根据我正在运行的平台导入适当的代码。（见上面cdleary的评论）

当涉及到 SQLite 实现之间的差异以及您正在实现任何 GUI 代码时，这一点尤其重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-05T03:35:43.907

IMO 的第一件事： **关注线程安全**。CPython 的 GIL 使编写线程安全代码变得容易，因为一次只有一个线程可以访问解释器。IronPython 和 Jython 的手感稍差一些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T03:41:37.450

I'm pretty sure you already know this but unfortunately Jython [can't load c extension modules.](http://www.jython.org/Project/userfaq.html#is-jython-the-same-language-as-python)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T06:11:27.827

There are two *major* issues at play here...

Firstly, to my knowledge, only CPython has RAII - you have to close your own resources in Jython, Ironpython, etc.

And Secondly, as has been mentioned, is thread safety.

# c# - 获取另一个exe的App.Config

> ID：53545
> 
> 赞同：22
> 
> 时间：2008-09-10T07:05:13.450
> 
> 标签：c#, .net, configuration-files, appsettings, system.configuration

我有一个带有`App.Config`文件的 exe。现在我想围绕 exe 创建一个包装 dll 以使用一些功能。

问题是如何从包装器 dll 访问 exe 中的 app.config 属性？

也许我的问题应该多一点，我在 exe 中有以下 app.config 内容：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
    <add key="myKey" value="myValue"/>
  </appSettings>
</configuration> 
```

问题是如何从包装器 dll 中获取“myValue”？

* * *

感谢您的解决方案。

实际上，我最初的想法是避免使用 XML 文件读取方法或 LINQ 或其他方法。我首选的解决方案是使用[配置管理器库等](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)。

对于使用通常与访问 app.config 属性相关联的类的任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-10T07:14:52.413

[ConfigurationManager.OpenMappedExeConfiguration 方法](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.openmappedexeconfiguration(VS.80).aspx)将允许您执行此操作。

来自 MSDN 页面的示例：

```
static void GetMappedExeConfigurationSections()
{
    // Get the machine.config file.
    ExeConfigurationFileMap fileMap =
        new ExeConfigurationFileMap();
    // You may want to map to your own exe.comfig file here.
    fileMap.ExeConfigFilename = 
        @"C:\test\ConfigurationManager.exe.config";
    System.Configuration.Configuration config =
        ConfigurationManager.OpenMappedExeConfiguration(fileMap, 
        ConfigurationUserLevel.None);

    // Loop to get the sections. Display basic information.
    Console.WriteLine("Name, Allow Definition");
    int i = 0;
    foreach (ConfigurationSection section in config.Sections)
    {
        Console.WriteLine(
            section.SectionInformation.Name + "\t" +
        section.SectionInformation.AllowExeDefinition);
        i += 1;

    }
    Console.WriteLine("[Total number of sections: {0}]", i);

    // Display machine.config path.
    Console.WriteLine("[File path: {0}]", config.FilePath);
} 
```

* * *

编辑：这应该输出“myKey”值：

```
ExeConfigurationFileMap fileMap =
    new ExeConfigurationFileMap();
fileMap.ExeConfigFilename = 
    @"C:\test\ConfigurationManager.exe.config";
System.Configuration.Configuration config =
    ConfigurationManager.OpenMappedExeConfiguration(fileMap, 
    ConfigurationUserLevel.None);
Console.WriteLine(config.AppSettings.Settings["MyKey"].Value); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-10T11:00:09.720

After some testing, I found a way to do this.

1.  Add the App.Config file to the test project. Use "Add as a link" option.
2.  Use `System.Configuration.ConfigurationManager.AppSettings["myKey"]` to access the value.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-10T08:38:48.390

I think what you're looking for is:

```
System.Configuration.ConfigurationManager.OpenExeConfiguration(string path) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T07:21:31.710

我同意 Gishu 的观点，即还有另一种方法。将EXE的公共/“公共”部分抽象到DLL中创建一个包装EXE来运行它不是更好吗？这当然是更常见的发展模式。只有您希望使用的东西会进入 DLL，而 EXE 会做它当前所做的所有事情，减去进入 DLL 的东西。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-10T07:13:34.320

它是一个 xml 文件，您可以使用基于 Linq-XML 或 DOM 的方法来解析出相关信息。
（也就是说，我会质疑是否没有更好的设计来解决它。你想要实现的目标。）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-10T11:13:10.420

Adding a link in the IDE would only help during development. I think lomaxx has the right idea: `System.Configuration.ConfigurationManager.OpenExeConfiguration.`

# javascript - 您将如何将网站从 Prototype 切换到 jQuery

> ID：53555
> 
> 赞同：8
> 
> 时间：2008-09-10T07:16:30.770
> 
> 标签：javascript, jquery, prototypejs

我在 Prototype 中编写了一个站点，但想切换到 jQuery。关于如何最好地进行切换的任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-10T07:25:44.663

就个人而言，我喜欢循序渐进，所以我会先使用两者，如下所示：

```
jQuery.noConflict();

// Put all your code in your document ready area
jQuery(document).ready(function($){
  // Do jQuery stuff using $
  $("div").hide();
});

// Use Prototype with $(...), etc.
$('someid').hide(); 
```

这样，您不必一次转换所有旧代码，而是可以开始在新东西上使用 jquery，并在方便时迁移旧 Prototype 代码。我不知道你的项目的规模，所以我不能说这是否适用于你，但 Spolsky 有一篇很棒的文章关于“大重写”以及为什么在[你不应该做的事情中这是一个坏主意，第 1 部分](http://www.joelonsoftware.com/articles/fog0000000069.html)。非常值得一读！

有关将 jquery 与 Prototype 一起使用的更多信息，请参阅jquery 文档中的[将 jQuery 与其他库一起使用。](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

# java - 在 JBoss 4.2 上使用 JPA 启用 Hibernate 二级缓存

> ID：53562
> 
> 赞同：8
> 
> 时间：2008-09-10T07:32:38.657
> 
> 标签：java, hibernate, jpa, caching

在使用 Java Persistence API（注解实体）时，启用 Hibernate 的二级缓存需要哪些步骤？我如何检查它是否正常工作？我正在使用 JBoss 4.2.2.GA。

从 Hibernate 文档看来，我需要启用缓存并在*persistence.xml*中指定缓存提供程序，例如：

```
<property name="hibernate.cache.use_second_level_cache"
          value="true" /> 
<property name="hibernate.cache.provider_class" 
          value="org.hibernate.cache.HashtableCacheProvider" /> 
```

还需要什么？我需要向我的 JPA 实体添加*@Cache注释吗？*

如何判断缓存是否正常工作？我在运行查询后尝试访问缓存统计信息，但*Statistics.getSecondLevelCacheStatistics*返回 null，可能是因为我不知道要使用什么“区域”名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T15:32:20.440

跟进：最后，添加注释后，我将它与EhCache一起使用，即

```
<property name="hibernate.cache.provider_class" 
          value="net.sf.ehcache.hibernate.EhCacheProvider" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T13:10:03.947

我相信您需要添加缓存注释来告诉hibernate如何使用二级缓存（只读，读写等）。我的应用程序就是这种情况（使用 spring/传统休眠和 ehcache，因此您的里程可能会有所不同）。一旦指定了缓存，我就开始从休眠中看到它们正在使用的消息。

# git - 如何在 Git 中获取分支上的更改

> ID：53569
> 
> 赞同：278
> 
> 时间：2008-09-10T07:44:53.870
> 
> 标签：git, branch

自分支从当前分支分支以来，获取分支提交日志的最佳方法是什么？到目前为止，我的解决方案是：

```
git log $(git merge-base HEAD branch)..branch 
```

[git-diff](http://git-scm.com/docs/git-diff)的文档表明它`git diff A...B`等同于`git diff $(git-merge-base A B) B`. 另一方面，[git-rev-parse](http://www.kernel.org/pub/software/scm/git/docs/git-rev-parse.html)的文档表明它`r1...r2`被定义为`r1 r2 --not $(git merge-base --all r1 r2)`.

为什么这些不同？请注意，这`git diff HEAD...branch`给了我想要的差异，但相应的 git log 命令给了我比我想要的更多的东西。

在图片中，假设：

```
         x---y---z---分支
        /
---a---b---c---d---e---头

```

我想获得一个包含提交 x、y、z 的日志。

*   `git diff HEAD...branch`给出这些提交
*   但是，`git log HEAD...branch`给出 x、y、z、c、d、e。

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2008-09-10T07:50:41.173

在修订列表的上下文中，`A...B`是如何`git-rev-parse`定义它的。git-log 需要一个修订列表。`git-diff`不需要修订列表 - 它需要一个或两个修订，并且已经定义了`A...B`语法来表示它在`git-diff`手册页中的定义方式。如果`git-diff`没有明确定义`A...B`，那么该语法将是无效的。请注意，`git-rev-parse`联机帮助页`A...B`在“指定范围”部分中进行了描述，并且该部分中的所有内容仅在修订范围有效的情况下（即需要修订列表时）有效。

要获取仅包含 x、y 和 z 的日志，请尝试`git log HEAD..branch`（两个点，而不是三个点）。这与 相同`git log branch --not HEAD`，表示分支上的所有提交不在 HEAD 上。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2008-11-07T21:24:08.743

```
git cherry branch [newbranch] 
```

`master`当您在分支机构时，完全按照您的要求进行操作。

我也很喜欢：

```
git diff --name-status branch [newbranch] 
```

这不是您要问的，但在相同的上下文中仍然非常有用。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-11-20T02:37:38.860

你想看到的是传出提交的列表。您可以使用

```
git log master..branchName 
```

或者

```
git log master..branchName --oneline 
```

我假设“branchName”是作为“master”的跟踪分支创建的。

同样，要查看传入的更改，您可以使用：

```
git log branchName..master 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2010-05-14T00:41:36.710

这类似于我发布的答案：[Preview a Git push](https://stackoverflow.com/questions/2176278/preview-a-git-push/2831135#2831135)

将这些函数放入您的 Bash 配置文件中：

*   gbout - git 分支传出
*   gbin - git 分支传入

您可以像这样使用它：

*   如果在 master 上：gbin branch1 <-- 这将显示 branch1 中的内容而不是 master 中的内容
*   如果在 master 上：gbout branch1 <-- 这将向您显示 master 中不在分支 1 中的内容

这适用于任何分支。

```
function parse_git_branch {
  git branch --no-color 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'
}

function gbin {
    echo branch \($1\) has these commits and \($(parse_git_branch)\) does not
    git log ..$1 --no-merges --format='%h | Author:%an | Date:%ad | %s' --date=local
}

function gbout {
    echo branch \($(parse_git_branch)\) has these commits and \($1\) does not
    git log $1.. --no-merges --format='%h | Author:%an | Date:%ad | %s' --date=local
} 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2016-05-09T12:03:54.447

类似于 Alex V 和 NDavis 等几个答案，但它们都不完全相同。

当已经在相关分支中时

使用：

```
git diff master... 
```

它结合了几个特点：

*   超级短
*   显示实际变化

更新：

这可能应该是`git diff master`，但这也显示了差异，而不是指定问题的提交。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-08-14T20:21:13.690

在那里输入 -p 以查看一些文件更改

```
git log -p master..branch 
```

做一些别名：

```
alias gbc="git branch --no-color | sed -e '/^[^\*]/d' -e 's/* \\(.*\\)/\1/'"

alias gbl='git log -p master..\`gbc\`' 
```

查看分支的独特提交：

```
gbl 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-10-12T22:48:17.950

查看从 master 分支后当前分支的日志：

`git log master...`

如果您当前在 master 上，要查看从 master 分支出来的不同分支的日志：

`git log ...other-branch`

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-07-27T14:33:39.783

```
git log --cherry-mark --oneline from_branch...to_branch 
```

(3dots) 但有时它显示 '+' 而不是 '='

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-11T09:53:12.310

我发现

```
git diff <branch_with_changes> <branch_to_compare_to> 
```

更有用，因为您不仅可以获得提交消息，还可以获得整个差异。如果您已经在想要查看更改的分支上并且（例如）想要查看 master 的更改，您可以使用：

```
git diff HEAD master 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-02T23:43:56.593

在 Git 2.30（2021 年第一季度）中，“git diff A...B(man)”学习了“git diff --merge-base AB(man)，这是一个更长的简写方式来表达同样的事情。

因此，您可以使用`git diff --merge-base <branch> HEAD`. 这应该等同于`git diff <branch>...HEAD`但不会混淆在 diff 中必须使用范围表示法。

# macos - NMBLookup OS X 返回不一致的结果

> ID：53583
> 
> 赞同：2
> 
> 时间：2008-09-10T07:58:07.223
> 
> 标签：macos, finder, smb

我们正在尝试在我们的 OS X 应用程序中获取 SMB 卷列表，并且按照 Apple 的建议一直在使用 NMBLookup 来获取列表。但是，通常情况下，我们无法使用该工具获得可用 SMB 卷的完整列表。我们有一个很好的基准，因为我们可以看到 Apple Finder 获得的完整列表，而且大多数时候，我们的列表不匹配，通常缺少服务器。

我们尝试了多种执行命令的方法，但还没有找到任何可以让我们返回完整列表的方法。

nmblookup -M -- -

nmblookup '*'

ETC

有谁知道我们可能做错了什么，或者知道查询本地子网上可用的 SMB 卷的更好方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T08:17:49.173

这在我们的网络中运行良好。关键是对 nmblookup 返回的每个条目使用 smbclient -L：

```
nmblookup -M -- - | grep -v 查询 | 读 sw
做
回声 $sw | awk -F' ' '{打印 $1}' | xargs smbclient -L
完毕

```

编辑：@paul - 现在我明白你的意思了 - vista 刚刚加入我们的网络，Finder 显示它，但没有显示 nmblookup，但 smbclient 在“服务器”部分显示它。

smbclient 有一个“服务器”部分，它列出了在网络上找到的机器。我使用的命令行是：

```
smbclient -L 192.168.0.4 //主浏览器的nmblookup返回的IP

克里斯蒂：~ diciu$ smbclient -L 192.168.0.4
域=[DOMAIN] OS=[Unix] 服务器=[Samba 3.0.24-7.fc5]
    共享名 类型 注释
    --------- ---- --------
    内部磁盘一些共享
[..]
匿名登录成功
域=[DOMAIN] OS=[Unix] 服务器=[Samba 3.0.24-7.fc5]

    服务器评论
    --------- -----
    Nmblookup 中未显示 MMM Vista 框

```

# c# - 如何编写现有的 Linq 表达式

> ID：53597
> 
> 赞同：14
> 
> 时间：2008-09-10T08:08:55.340
> 
> 标签：c#, linq

我想组合两个 Linq 表达式的结果。它们以形式存在

```
Expression<Func<T, bool>> 
```

所以我想要组合的两个本质上是一个参数（类型 T）的委托，它们都返回一个布尔值。我想要组成的结果将是布尔值的逻辑评估。我可能会将其实现为扩展方法，因此我的语法类似于：

```
Expression<Func<User, bool>> expression1 = t => t.Name == "steve";
Expression<Func<User, bool>> expression2 = t => t.Age == 28;
Expression<Func<User, bool>> composedExpression = expression1.And(expression2); 
```

稍后在我的代码中，我想评估组合表达式

```
var user = new User();
bool evaluated = composedExpression.Compile().Invoke(user); 
```

我已经提出了一些不同的想法，但我担心它比我希望的要复杂。这是怎么做到的？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-10T08:38:22.883

这是一个例子：

```
var user1 = new User {Name = "steve", Age = 28};
var user2 = new User {Name = "foobar", Age = 28};

Expression<Func<User, bool>> expression1 = t => t.Name == "steve";
Expression<Func<User, bool>> expression2 = t => t.Age == 28;

var invokedExpression = Expression.Invoke(expression2, expression1.Parameters.Cast<Expression>());

var result = Expression.Lambda<Func<User, bool>>(Expression.And(expression1.Body, invokedExpression), expression1.Parameters);

Console.WriteLine(result.Compile().Invoke(user1)); // true
Console.WriteLine(result.Compile().Invoke(user2)); // false 
```

您可以通过扩展方法重用此代码：

```
class User
{
  public string Name { get; set; }
  public int Age { get; set; }
}

public static class PredicateExtensions
{
  public static Expression<Func<T, bool>> And<T>(this Expression<Func<T, bool>> expression1,Expression<Func<T, bool>> expression2)
  {
    InvocationExpression invokedExpression = Expression.Invoke(expression2, expression1.Parameters.Cast<Expression>());

    return Expression.Lambda<Func<T, bool>>(Expression.And(expression1.Body, invokedExpression), expression1.Parameters);
  }
}

class Program
{
  static void Main(string[] args)
  {
    var user1 = new User {Name = "steve", Age = 28};
    var user2 = new User {Name = "foobar", Age = 28};

    Expression<Func<User, bool>> expression1 = t => t.Name == "steve";
    Expression<Func<User, bool>> expression2 = t => t.Age == 28;

    var result = expression1.And(expression2);

    Console.WriteLine(result.Compile().Invoke(user1));
    Console.WriteLine(result.Compile().Invoke(user2));
  }
} 
```

# c++ - regex for parsing resource (.rc) files

> ID：53599
> 
> 赞同：2
> 
> 时间：2008-09-10T08:10:11.110
> 
> 标签：c++, regex, mfc, internationalization

Ulimately I just wanted to extract strings from the .rc file so I could translate them, but anything that goes with .rc files works for me.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T13:35:35.427

如果您的程序符合 GNU 许可证，我会考虑使用[gettext](http://en.wikipedia.org/wiki/Gettext)和[.PO 文件](http://gnu.cs.pu.edu.tw/software/gettext/manual/html_node/PO-Files.html)

1）我建议使用状态机算法从 .rc 文件中提取。

```
void ProcessLine(const char * str)
{
   if (strstr(str, " DIALOG"))
      state = Scan;
   else if (strstr(str, " MENU"))
      state = Scan;
   else if (strstr(str, " STRINGTABLE"))
      state = Scan;
   else if (strstr(str, "END"))
      state = DontScan;

   if (state == Scan)
   {
      const char * cur = sLine;
      string hdr = ...// for example "# file.rc:453"
      string msgid;
      string msgid = "";
      while (ExtractString(sLine, cur, msgid))
      {
         if (msgid.empty())
            continue;
         if (IsPredefined(msgid))
            continue;
         if (msgid.find("IDB_") == 0 || msgid.find("IDC_") == 0)
            continue;
         WritePoString(hdr, msgid, msgstr);
      }
   }
} 
```

2) 在ExtractString() 中提取字符串时，应考虑char " 表示为""，还有像\t \n \r 这样的字符。所以状态机在这里也是一个不错的选择。

以下字符串：

```
LTEXT           "Mother has washed ""Sony"", then \taquarium\\shelves\r\nand probably floors",IDC_TEXT1,24,14,224,19 
```

表示对话框上的此类标签：

```
Mother has washed "Sony", then aquarium\shelves
and probably floors 
```

3）然后在程序启动时，您应该通过 gettext 加载 .po 文件，并为每个对话框在启动时使用如下函数翻译其字符串：

```
int TranslateDialog(CWnd& wnd)
{
    int i = 0;
    CWnd *pChild;
    CString text;

    //Translate Title
wnd.GetWindowText(text);
LPCTSTR translation = Translate(text);
    window.SetWindowText(translation);

    //Translate child windows
    pChild=wnd.GetWindow(GW_CHILD);
    while(pChild)
    {
        i++;
    Child->GetWindowText(Text);//including NULL
        translation = Translate(Text);
        pChild->SetWindowText(translation);
        pChild = pChild->GetWindow(GW_HWNDNEXT);
    }
    return i;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T09:31:45.783

Maybe this helps? ([http://social.msdn.microsoft.com/forums/en-US/regexp/thread/5e87fce9-ec73-42eb-b2eb-c821e95e0d31/](http://social.msdn.microsoft.com/forums/en-US/regexp/thread/5e87fce9-ec73-42eb-b2eb-c821e95e0d31/))

They are using the following regex to find the stringtable in the rc source:

(?<=\bSTRINGTABLE\s+BEGIN\s+).*?(?=\s+END\b)

Edit - And you can read the key values pairs with the following statement with the MultiLine option:

@"\s+(.*?)\s+""(.*)""";

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-20T21:01:20.540

尽管 rc 文件似乎是翻译的明显起点，但事实并非如此。开发人员的工作是确保应用程序是可翻译的。这不是管理翻译。从 exe 开始翻译，虽然有点违反直觉，但这是一个更好的主意。在此处阅读更多信息：http: [//www.apptranslator.com/misconceptions.html](http://www.apptranslator.com/misconceptions.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T00:49:09.830

这听起来像是[SED](http://www.zeusedit.com/forum/viewtopic.php?t=1229)脚本的工作。

通过运行此命令行：**sed.exe -n -f sed.txt test.rc**

以下[SED](http://www.zeusedit.com/forum/viewtopic.php?t=1229)脚本将从输入**test.rc**文件中提取所有带*引号的字符串：*

 **```
# Run Script Using This Command Line
#
#   sed.exe -n -f sed.txt test.rc
#

# Check for lines that contain strings
/\".*\"/ {
    # print the string part of the line only
    s/\(.*\)\(\".*\"\)\(.*\)/\2/ p
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-16T06:27:47.947

如果是 rc，最好使用高级解析器，例如[http://www.soft-gems.net/index.php/java/windows-resource-file-parser-and-converter](http://www.soft-gems.net/index.php/java/windows-resource-file-parser-and-converter)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-20T14:45:44.373

[RexCrunch](http://resxcrunch.com)有时很快就会发布。它将在一个表中以多种语言编辑多个资源文件。

# c# - How can I export Shared Outlook Calendars?

> ID：53602
> 
> 赞同：1
> 
> 时间：2008-09-10T08:13:31.897
> 
> 标签：c#, outlook, calendar, export, exchange-server

I am looking for a solution to export Shared Outlook Calendars (yes, I'm using exchange server and yes I can copy calendar to my local folders, which would allow me to export. However, what if there are more than 50 calendars, which I need to export? Is there a way of automating the process?).

I am interested in using C# for accomplish this task. Has anyone ever tried to do that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T17:54:53.570

[Exchange Web Services (EWS)](http://msdn.microsoft.com/en-us/library/bb204119(EXCHG.80).aspx) allows you to do this

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T09:50:45.753

## [outlook2ical](http://sourceforge.net/projects/outlook2ical/)

has a VBMacro to export outlook calendar to iCal format.

You might check if its worth the time to port to C#.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-11T08:33:24.323

嗯.. 只是想知道[Google Calendar Sync](http://dl.google.com/googlecalendarsync/GoogleCalendarSync_Installer.exe)是否允许您这样做。我没有任何共享日历可以试用。

或者你已经试过了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T12:27:15.417

你试过看 VSTO 吗？（Office 的 Visual Studio 工具）。这将为常见的 Outlook 项目（日历等）提供 API。它是各种 VBA 管理 API 的 C#/.Net 版本。

# language-agnostic - 'foo' 的真正含义是什么？

> ID：53609
> 
> 赞同：236
> 
> 时间：2008-09-10T08:21:02.223
> 
> 标签：language-agnostic, coding-style

我希望这是一个编程问题，就像在任何编程教程中一样，您最终会在代码示例中遇到“foo”。（是的，对吧？）

'foo' 的真正含义是什么？

如果它意味着**什么都没有**，那么它是什么时候开始使用的？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-02-19T18:09:28.287

参见：[RFC 3092：“Foo”的词源，D. Eastlake 3rd 等。](https://www.rfc-editor.org/rfc/rfc3092)

为简洁起见，仅引用该 RFC 中的相关定义：

> 2.  非常普遍地用作绝对任何东西的样本名称，尤其是。程序和文件（尤其是暂存文件）。

> 3.  首先是语法示例中使用的元语法变量的标准列表（bar、baz、qux、quux、corge、grault、garply、waldo、fred、plugh、xyzzy、thud）。[行话]

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-09-12T10:22:50.870

`foo`用作占位符名称，通常在示例代码中表示被命名的对象或名称的选择不是示例的关键部分。如果需要多个这样的名称，`foo`则通常后跟`bar`, `baz`，甚至。`bundy`维基百科称这些名称为[元句法变量](http://en.wikipedia.org/wiki/Metasyntactic_variable)。Python 程序员应该使用`spam`, `eggs`, `ham`, 而不是`foo`, 等等。

[foo](https://stackoverflow.com/questions/683/using-in-to-match-an-attribute-of-python-objects-in-an-array#750)在 SA 中有很好的用途。

`foo`当程序员想不出一个有意义的名称时，我也看到过使用（例如，作为 . 的替代品`tmp`），但我认为这是对`foo`.

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-09-10T08:27:11.163

由于“Foo”的定义有很多含义：

*   bar 和 baz 经常组合在一起构成 foobar、barbaz 和 foobaz 等词。 [www.nationmaster.com/encyclopedia/Metasyntactic-variable](http://www.nationmaster.com/encyclopedia/Metasyntactic-variable)

*   CML 中的主要概念，通常直接映射到 XMLElements（稍后讨论）。 [wwmm.ch.cam.ac.uk/blogs/cml/](http://wwmm.ch.cam.ac.uk/blogs/cml/)

*   围场中牧草总量的测量，以每公顷牧草干物质公斤数表示（kg DM/ha） [www.lifetimewool.com.au/glossary.aspx](http://www.lifetimewool.com.au/glossary.aspx)

*   前方观察官。一名炮兵军官留在步兵营和坦克营中，在前线设立观察哨，从那里观察敌方阵地，并将目标的坐标通过无线电发送到后方的炮台。 [members.fortunecity.com/lniven/definition.htm](http://members.fortunecity.com/lniven/definition.htm)

*   是第一个常用的元句法变量。它有时与 bar 结合来制作 foobar。这表明 foo 可能起源于二战俚语 fubar，作为**fucked** / **fouled** **u** p **beeyond** **a** ll rcognition**的**首字母缩写词，尽管术语文件提供了一个很好的案例…… [解释指南。信息/意义/元句法变量.html](http://explanation-guide.info/meaning/Metasyntactic-variable.html)

*******   Foo 是计算机科学中大量使用的元句法变量，用于抽象地表示概念，可用于表示 ... [en.wikipedia.org/wiki/FOo](http://en.wikipedia.org/wiki/FOo)

    *   Foo 是 Obert Skye 的 Leven Thumps 系列中的梦想世界（不是）。虽然它有许多原始居民，但它现在的大多数居民都来自现实，并被称为尼特。... [en.wikipedia.org/wiki/Foo（地点）](http://en.wikipedia.org/wiki/Foo "地方")

    *   也富'。用 T 先生口音表示傻瓜（愚蠢的人） [en.wiktionary.org/wiki/foo](http://en.wiktionary.org/wiki/foo)****** 

 ******资源：[谷歌](http://google.com)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-10T08:23:42.887

这是一个[元句法变量](http://en.wikipedia.org/wiki/Metasyntactic_variable)。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-04-06T20:55:26.080

foo = 文件或对象。它用于代替对象变量或文件名。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-10T08:23:00.550

我认为这意味着没有任何意义。维基说：

“Foo 通常与元语法变量 bar 和 foobar 一起使用。”

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-05-10T04:39:24.107

法语 fou 的声音，（如：amour fou）[crazy] 用英语写成，会是 f​​oo，不是吗。否则 furchtbar -> foobar -> foo, bar -> barfoo -> barfuß（赤脚）。只是你。没有牙齿的脚。

我同意所有提到它的人的意思：没有什么有趣的，只是一些东西，通常需要完成一个语句/表达式。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-03-14T13:23:41.587

在我的同事中，“foo”一词的含义（或者更准确地说是*使用*）一直是作为一个占位符来表示*name*的示例。示例包括但不限于*yourVariableName*、*yourObjectName*或*yourColumnName*。

今天，出于几个原因，我避免使用“foo”并更喜欢使用这种类型的*命名替换。*

*   在我早期的日子里，我最初发现在任何示例中使用“foo”作为放置来表示某些东西是令人困惑的。我想要一个工作示例，而不是 foobar。
*   您的结果可能会有所不同，但我总是 100%，每次，从未失败，得到更多关于使用“foo”的实际变量的含义的后续问题。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-10T11:47:04.177

在我看来，每个程序员都有他或她自己的“词”，每次你在编程时需要一个任意词时都会使用这些“词”。对一些人来说，这是一首儿歌的第一句话，对另一些人来说是名字，而对另一些人来说则是完全不同的东西。现在对于程序员社区来说，也有这些“词”，这些词是“foo”和“bar”。这样做的用途是，如果您必须公开交流有关编程的信息，您不必说您会使用任意词，您只需写“foo”或“bar”，每个程序员都知道这只是任意词。

# css - 如何在sharepoint中正确链接您的自定义css文件

> ID：53610
> 
> 赞同：2
> 
> 时间：2008-09-10T08:21:16.980
> 
> 标签：css, sharepoint

我创建了一个自定义列表，并通过修改 ItemStyle.xsl 对 CQWP 在页面上呈现它的方式进行了一些更改。但是，我想使用一些自定义 css 类，因此我想从包含此 CQWP 的页面的 head 标记链接到我自己的自定义 .css 文件。

所以我的问题是，将我的 .css 文件放在哪里以及如何将其正确链接到包含 CQWP 的页面。请记住，我正在制作一个应该部署在多共享点安装上的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T09:44:59.977

微软官方的方法就是将它们复制到相关文件夹中（如下载其模板包所见）。但是，您也可以创建自己的站点定义并将项目添加到正确的库和列表中，方法与添加母版页的方式相同。

如果您打算通过功能部署 CSS 和母版页，请记住您必须激活网站集上的发布基础结构和网站上的发布功能。

要将母版页/页面布局部署为一项功能，您应该按照以下站点中的步骤操作，您可以使用“fileurl”元素指定您的 CSS 并将其放入正确的文件夹（例如样式库）： [http： //www.sharepointnutsandbolts.com/2007/04/deploying-master-pages-and-page-layouts.html](http://www.sharepointnutsandbolts.com/2007/04/deploying-master-pages-and-page-layouts.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T08:29:00.037

考虑将它们上传到网站集根目录中的“样式库”。

如果您在根目录下没有“样式库”，请考虑制作一个——它只是一个文档库。

确保权限设置正确，以便需要阅读的每个人都可以阅读。

您可以使用“/Style%20Library/my.css”引用它们，但这不适用于不在域根目录下的网站集。

# iis - 如何从命令行控制 IIS 5.1？

> ID：53618
> 
> 赞同：0
> 
> 时间：2008-09-10T08:26:32.070
> 
> 标签：iis, windows-xp

我找到了一些关于通过 adsutil.vbs 从命令行控制 IIS 5.1 的信息（[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d3df4bc9-0954-459a-b5e6-7a8bc462960c.mspx?mfr=真的](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d3df4bc9-0954-459a-b5e6-7a8bc462960c.mspx?mfr=true)）。该实用程序位于 c:\InetPub\AdminScripts。

该实用程序仅抛出如下错误： ErrNumber: -2147463164 (0x80005004) Error Trying To GET the Schema of the property: IIS://localhost/Schema/ROOT

你能告诉我，如何检查是否存在虚拟目录并创建它，如果它不存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-10T11:31:32.890

希望这对您有所帮助。

[http://www.codeproject.com/KB/system/commandlineweb.aspx](http://www.codeproject.com/KB/system/commandlineweb.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T12:29:55.510

我无法评论您的帖子，所以我必须写一条新消息。我能够使用您的链接中的脚本 CreateWebDir.vbs 并使用它来创建/更新我的虚拟目录，只需一次调用：

CreateWebDir.vbs 目录名路径 80

如果虚拟目录已经存在，它会改变路径，这正是我所需要的。谢谢！

# .net - 为什么当前平台不支持“资源池”？

> ID：53621
> 
> 赞同：1
> 
> 时间：2008-09-10T08:27:14.843
> 
> 标签：.net, sql-server, connection-pooling

以下异常的可能原因是什么？

```
System.PlatformNotSupportedException: 'ResourcePool' is not supported on the current platform.
   at System.EnterpriseServices.Platform.Assert(Boolean fSuccess, String function)
   at System.EnterpriseServices.Platform.Assert(Version platform, String function)
   at System.EnterpriseServices.ResourcePool..ctor(TransactionEndDelegate cb)
   at System.Data.SqlClient.ConnectionPool..ctor(DefaultPoolControl ctrl)
   at System.Data.SqlClient.PoolManager.FindOrCreatePool(DefaultPoolControl ctrl)
   at System.Data.SqlClient.SqlConnectionPoolManager.GetPooledConnection(SqlConnectionString options, Boolean& isInTransaction)
   at System.Data.SqlClient.SqlConnection.Open() 
```

该平台是 Windows 2003 Server SP2。相同的代码已在 Windows XP SP2 上进行了测试，没有任何问题。但是，无论平台如何，了解导致此异常的原因会很有趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T22:27:17.093

我已经使用 Reflector 查看了源代码，但似乎在 ResourcePool 的静态构造函数中找不到任何对 Platform.Assert 的调用。

Windows 2003 服务器是 64 位的吗？这可能是问题所在。

# c# - 如何在我的程序中获取域名的whois信息？

> ID：53623
> 
> 赞同：3
> 
> 时间：2008-09-10T08:27:45.920
> 
> 标签：c#, java, whois, domain-name

我想从我的 c#/java 程序中获取域名的 whois 信息。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-01T06:37:04.757

我在 dotnet-snippets.com 上找到了一个完美的 C# 示例（*不再存在*）。

只需 11 行代码即可直接复制并粘贴到您自己的应用程序中。

```
/// <summary>
/// Gets the whois information.
/// </summary>
/// <param name="whoisServer">The whois server.</param>
/// <param name="url">The URL.</param>
/// <returns></returns>
private string GetWhoisInformation(string whoisServer, string url)
{
    StringBuilder stringBuilderResult = new StringBuilder();
    TcpClient tcpClinetWhois = new TcpClient(whoisServer, 43);
    NetworkStream networkStreamWhois = tcpClinetWhois.GetStream();
    BufferedStream bufferedStreamWhois = new BufferedStream(networkStreamWhois);
    StreamWriter streamWriter = new StreamWriter(bufferedStreamWhois);

    streamWriter.WriteLine(url);
    streamWriter.Flush();

    StreamReader streamReaderReceive = new StreamReader(bufferedStreamWhois);

    while (!streamReaderReceive.EndOfStream)
        stringBuilderResult.AppendLine(streamReaderReceive.ReadLine());

    return stringBuilderResult.ToString();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-10T08:33:32.990

我认为，最简单的方法是通过套接字连接到端口 43 上的 whois 服务器。发送域名后跟换行符并读取响应。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-07T09:34:45.467

只有当您知道要连接到*哪个“whois”服务器时，Thomas 的回答才有效。*

有许多不同的方法可以找到它，但没有一个 (AFAIK) 对每个域注册机构都适用。

一些域名支持DNS`SRV`中的服务记录`_nicname._tcp`，但存在问题，因为目前还没有公认的标准来防止子域提供`SRV`覆盖官方注册表的记录（请参阅[https://datatracker. ietf.org/doc/html/draft-sanz-whois-srv-00](https://datatracker.ietf.org/doc/html/draft-sanz-whois-srv-00)）。

对于许多 TLD，可以将您的查询发送到`<tld>.whois-servers.net`. 这实际上工作得很好，但要注意它不会在所有有官方授权的二级域的情况下都有效。

例如，`.uk`有几个官方子域，但其中只有一些由`.uk`注册管理机构运行，其他的有自己的 WHOIS 服务，而这些不在`whois-servers.net`数据库中。

*令人困惑的是*`.uk.com`，数据库中还有“非官方”注册表，例如。*`whois-servers.net`*

 *ps WHOIS 中的官方行尾分隔符，与大多数 IETF 协议一样`CRLF`，不仅仅是`LF`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T00:24:12.080

我发现了一些提供此信息的网络服务。这个是免费的，对我来说效果很好。 [http://www.webservicex.net/whois.asmx?op=GetWhoIS](http://www.webservicex.net/whois.asmx?op=GetWhoIS)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-23T21:21:18.660

我在这里找到了一个完美的 C# 示例。只需 11 行代码即可直接复制并粘贴到您自己的应用程序中。但首先您应该添加一些 using 语句以确保正确调用 dispose 方法以防止内存泄漏：

```
StringBuilder stringBuilderResult = new StringBuilder();
using(TcpClient tcpClinetWhois = new TcpClient(whoIsServer, 43))
{
   using(NetworkStream networkStreamWhois = tcpClinetWhois.GetStream())
   {
      using(BufferedStream bufferedStreamWhois = new BufferedStream(networkStreamWhois))
      {
         using(StreamWriter streamWriter = new StreamWriter(bufferedStreamWhois))
         {
            streamWriter.WriteLine(url);
            streamWriter.Flush();
            using (StreamReader streamReaderReceive = new StreamReader(bufferedStreamWhois))
            {
               while (!streamReaderReceive.EndOfStream) stringBuilderResult.AppendLine(streamReaderReceive.ReadLine());
            }
         }
      }
   }
} 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-09-10T08:36:03.047

这是 Java 解决方案，它只是打开一个 shell 并运行`whois`：

```
import java.io.*;
import java.util.*;

public class ExecTest2 {
    public static void main(String[] args) throws IOException {
        Process result = Runtime.getRuntime().exec("whois stackoverflow.com");

        BufferedReader output = new BufferedReader(new InputStreamReader(result.getInputStream()));
        StringBuffer outputSB = new StringBuffer(40000);
        String s = null;

        while ((s = output.readLine()) != null) {
            outputSB.append(s + "\n");
            System.out.println(s);
        }

        String whoisStr = output.toString();
    }
} 
```

# methodology - How to deal with poorly informed customer choices

> ID：53627
> 
> 赞同：6
> 
> 时间：2008-09-10T08:30:32.327
> 
> 标签：methodology

Here's a scenario I'm sure you're all familiar with.

1.  You have a fairly "hands off" customer, who really doesn't want to get too involved in the decision making despite your best efforts.

2.  An experienced development team spend hours discussing the pros and cons of a particular approach to a problem and come up with an elegant solution which avoids the pitfalls of the more obvious approaches.

3.  The customer casually mentions after a quick glance that they want it changed. They have no understanding of all the usability / consistency issues you were trying to avoid in your very carefully thought out approach.

4.  Despite explanations, customer isn't interested, they just want it changed.

5.  You sigh and do what they ask, knowing full well what will happen next...

6.  3 weeks later, customer says it isn't working well this way, could you change it? You suggest again your original solution, and they seize on it with enthusiasm. They invariably seem to have had a form of selective amnesia and blocked out their role in messing this up in the first place.

I'm sure many of you have gone through this. The thing which gets me is always when we know the time and effort that reasonably bright and able people have put in to really understanding the problem and trying to come up with a good solution. The frustration comes in contrasting this with the knowledge that the customer's choice is made in 3 minutes in a casual glance (or worse, by their managers who often don't even know what the project is really about). The icing on the cake is that it's usually made very late in the day.

I know that the agile methodologies are designed to solve exactly this kind of problem, but it requires a level of customer buy in that certain types of customers (people spending other peoples money usually) are just not willing to give.

Anyone any clever insight into how you deal with this?

EDIT: Oops - by the way, I'm not talking about any current or recent customer in this. It's purely hypothetical...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-10T08:33:06.500

Make your customer pay by the effort you are putting into designing and developing the solution to their problem.

The more you work, the more you get. The customer will have to pay for his mistakes.

Customer will eventually learn to appreciate your experience and insight in the programming field.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T09:23:15.863

Niyaz is correct, unfortunately getting a customer buy-in is difficult until they have been burned like this once before.

Additionally describe to the customer the scenario above and state how much extra it would cost if you went three or four weeks down the line and had to rewrite it due to a change and then let them use the prototype. It may take a few days to put one together so they can see both options (theirs [the wrong way], and yours [the right way]). Remember they are paying you not only for your ability to program but also your experience and knowledge of the issues which crop up.

Whatever the decision the customer makes, ensure that you get it documented, update your risks register for the project with the risks that the chosen implementation will incurr and speak to the project manager (if its not you) about the mitigation plans for them.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T09:35:50.763

I agree with Niyaz. However at the time the customer suggests the change you should work out what the impact of the change will be, and how likely that impact is to happen. Then ask whomever is responsible (it's not always that customer) for the deliverable if they approve the change.

Making the impact clear (more cost, lower reliability, longer delivery time etc) is very important to helping the customer to make a decision. It's very important to describe the impacts on the project or their business in a factual way, and assess how likely that impact is to occur. "Maybes" and "i feel" are very ignorable.

After that as long as the right people approve the change and as long as they pay for it.. well you did give them what they wanted :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-11T12:57:07.947

One thing we have done with some success in the past in these kinds of situations is to hand the issues over to the client.

> "OK, you want to change it - this is what will happen if you do that. These are the issues involved. You have a think about how you'd like it to work and then get back to us".

This approach doesn't tend to yield good solutions (unsurprisingly) but does tend to let the client see that it's not a "gut feeling", wild stab in the dark kind of question.

And failing that, it usually makes them stop asking you to change it!

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T08:15:08.193

通常这样的情况是由两件事引起的。那些应该给你需求规范的人要么不把心投入到项目中，因为他们对它没有兴趣，或者因为他们真的不知道他们想要什么。

敏捷编程是最好的方法之一，但还有其他方法可以做到这一点。我个人通常使用经典的瀑布方法，所以螺旋和敏捷方法是不可能的。但这并不意味着你**不能**使用原型。

事实上，使用原型可能是最有用的工具。[想想冰山效应。](http://www.joelonsoftware.com/articles/fog0000000356.html) [秘诀是非程序员的人不明白这一点。http://img134.imageshack.us/my.php?image=icebergbelowwater.jpg](http://img134.imageshack.us/my.php?image=icebergbelowwater.jpg)

> “你知道冰山 90% 是如何在水下的吗？嗯，大多数软件也是这样的——有一个漂亮的用户界面需要大约 10% 的工作，然后 90% 的编程工作都在幕后…… 。”——乔尔·斯波尔斯基

生成原型需要时间和精力，但它是收集需求的最有效方式。我的项目团队所做的是，UI 设计师是制作原型的人。如果您给用户一个原型（至少是应用程序外观和感觉的工作界面），那么您将受到很多批评，这可能会导致期望和要求。它可能看起来像 YouTube 上的评论，但这是一个开始。

第二题：

> 客户在快速浏览后随便提到他们想要改变它。他们不了解您在经过深思熟虑的方法中试图避免的所有可用性/一致性问题。

生成另一个原型。这里的关键是用户希望*看到*的结果，而不是他们必须*听取*的建议。

但是，如果所有其他方法都失败了，您总是可以列出为什么实施该解决方案的利弊，无论他们喜欢的特定解决方案是否不是您坚持的解决方案。使文档的该部分尽可能易读。例如：

问题：

公园是所有漂亮女性慢跑保持体形的地方。Johnny Bravo 喜欢享受“大自然的美丽”，所以他希望融入其中……你知道……看起来很强壮，在追尾的同时慢跑。

替代解决方案：

1) 穿上黑色麂皮鞋，让自己看起来尽可能时尚。

2) 穿上一双耐克的。跑步必备鞋。尝试最新款式。

实施的解决方案：

黑色麂皮鞋是首选，因为...好吧，因为辣妈喜欢黑色麂皮鞋。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T09:27:00.847

Or else, *if they won't pay for the effort*, just avoid putting that much resources into the solution of the problem, and just give them exactly what they've asked for and then think about it after the three weeks have passed.

Somewhat frustrating, yes, but that's the way it'll always be with that kind of customers. At least you won't be losing money.

# svn - Subversion 中特定代码行的更改历史

> ID：53629
> 
> 赞同：79
> 
> 时间：2008-09-10T08:32:20.870
> 
> 标签：svn

是否可以查看 Subversion 存储库中特定代码行的更改历史记录？

例如，我希望能够查看添加特定语句或更改该语句的时间，即使它的行号不再相同。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-09-10T08:40:18.683

我不知道在 Subversion 中通过时间跟踪语句的方法。

然而，查看文件中任何特定行的最后一次更改时间很简单，使用`svn blame`. 检查 SVNBook：[`svn blame`参考](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.blame.html)：

**概要**

```
svn blame TARGET[@REV]... 
```

**描述**

在线显示指定文件或 URL 的作者和修订信息。每行文本的开头都带有作者（用户名）和对该行最后更改的修订号。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-10-13T15:02:08.410

在[TortoiseSVN](http://tortoisesvn.tigris.org/)客户端中，有一个非常好的功能可以让您：

*   责备一个文件，显示每行的最后更改（这是标准的）
*   “责备以前的修订”，在上面的视图中单击特定行后（这是好的）

第二个功能正如它所说的那样 - 它显示了在对行的最后修改之前的带注释的修订。通过反复使用此功能，您可以追溯特定行的历史记录。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-02-04T00:33:03.160

我通常会：

1.  先跑`svn blame FILE`。
2.  请注意特定行的最新版本。
3.  使用参数执行另一个查询`-r`：

    ```
    svn blame FILE -r 1:REV 
    ```

4.  从那里手动跟踪。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-11-28T11:21:01.783

这可以分两个阶段完成：

1.  `svn blame /path/to/your/file > blame.tmp`
2.  `grep "your_line_of_text" blame.tmp`

如果不需要，您可以在之后删除 blame.tmp 文件。

原则上，一个简单的脚本可以用任何大致相同的脚本语言编写。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-09T14:05:21.830

在[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)中，您可以使用 SVN 注释视图了解您的代码的每一行何时提交，或者右键单击文件 →*团队*→*显示注释*...。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-17T16:39:02.677

这里的关键是需要多少历史记录。正如其他人指出的那样，简短的回答是：（`svn blame`详见`svn help blame`）。如果您要追溯历史或处理重大变化，您可能需要的不仅仅是这一个命令。

我只需要自己做这件事，并在 SO 上找到了这个（ye ole）线程。这是我为解决它所做的`CLI`，特别是针对我的 API 已更改的情况（例如，在将某人的过时工作（不是在分支上，*arrgh！*）移植回基于最新版本的功能分支中时）日期树干）。例如，函数名称已经发生了足够大的变化，以至于不明显需要调用哪个函数。

# 第一步

以下命令允许我翻阅文件“fileName.h”中发生更改的提交并查看相应的修订号（注意：您可能必须根据 svn 日志文本更改“10”以获得或多或少的上下文）。

`svn log | grep -C 10 "fileName.h" | less`

*这会产生一个修订列表，其中修改了该文件。*

# 第二步

然后使用`blame`（或正如其他人指出的那样`annotate`）缩小到感兴趣的修订是一件简单的事情。

```
cd trunk
svn blame fileName.h@r35948 | less 
```

*例如，发现感兴趣的修订是 35948。*

# 第三步

通过责备找到感兴趣的修订后，可以生成差异以利用 SVN 工具。

```
svn diff -r35948:PREV fileName.h 
```

# 结论

具有视觉差异可以更轻松地识别旧 API 名称和更新/更新的 API 名称。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-10T08:38:13.197

```
svn annotate 
```

来自[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)的 AKA *SVN Blame*。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-10T08:36:15.620

svn blame 显示上次哪个签入修改了文件中的任何行。

这也适用于旧版本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-10T08:36:32.887

开始是命令 svn blame（或 annotate,praise）。它将显示最后一次修改代码行的时间以及修改者。例如：

```
 4564    wiemann # $Id$
  4564    wiemann # Author: David Goodger <goodger@python.org>
   778    goodger # Copyright: This module has been placed in the public domain.
   217    goodger 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-23T16:55:07.657

如果你使用 Emacs，内置包`vc`可以做到这一点。

1.  导航到有问题的文件。
2.  `vc-annotate`使用`M-x` `vc-annotate`或运行命令`C-x``v``g`。
3.  每行都将显示其修订版，就像正常的`svn blame`.
4.  按`a`( `vc-annotate-revision-previous-to-line`) 将导航到您所在行的修订之前的修订。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-10T08:36:18.067

您要查找的命令是[`svn blame`](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.blame.html).

# asp.net - How would you go about using the ASP.NET AJAX Control Toolkit in a project that doesn't use ASP.NET on the back end

> ID：53639
> 
> 赞同：0
> 
> 时间：2008-09-10T08:37:39.547
> 
> 标签：asp.net, javascript, ajax

Your backend could be PHP or Python but you want to use the controls from the ASP.NET toolkit is there a successful way to do this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T14:17:31.257

为什么要在 PHP/Python 中使用 ASP.NET AJAX 工具包？

您是否考虑过其他非 ASP.NET 特定的 AJAX 库，例如 jQuery、Dojo、MooTools、YUI？

ASP.NET AJAX 和 ASP.NET AJAX 工具包以 ASP.NET 为中心，您将通过 PHP/Python 使用其他 AJAX 库获得更大的灵活性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T08:54:15.200

I don't think that it is possible.

The ASP.NET AJAX Toolkit is based on ASP.NET technique (what a surprise) and needs ASP.NET.

It contains server-side controls, which are translated to HTML and Javascript by the ASP.NET engine. It is not working without the engine.

However you can check the code itself to see how it is working, what it generates on the browser side and get ideas and Javascript codes to build into your application or framework.

**Edit:** I've just found an interesting project, which is in alpha stage, check [this](http://www.codeplex.com/phpmsajax) out.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T08:50:12.590

are you talking about the ASP.NET **AJAX** Control Toolkit?

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-16T13:08:34.543

看看 Stephen Walther 博客上的这篇博文：

[ASP.NET MVC 技巧 #36 – 创建弹出日历助手](http://stephenwalther.com/blog/archive/2008/08/22/asp-net-mvc-tip-36-create-a-popup-calendar-helper.aspx)

在这篇文章中，他展示了如何使用“仅脚本”版本的 AJAX 控件工具包。此版本的 AJAX 控件工具包不包含服务器端控件或控件扩展器。它仅包含使用客户端 AJAX 行为所需的客户端文件——JavaScript、CSS、图像。

Stephen Walther 是 Microsoft 的高级项目经理，负责 ASP.NET MVC 内容和社区（他的职位是 ASP.NET MVC Ninja）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T16:08:55.387

我发现 AJAX Control Toolkit 中的大部分功能都可以通过 jQuery 等 javascript 框架来完成。

# c# - 在设计时不知道类名的情况下创建对象

> ID：53649
> 
> 赞同：6
> 
> 时间：2008-09-10T08:53:32.333
> 
> 标签：c#, reflection

使用反射，我需要调查一个用户 DLL 并在其中创建一个类的对象。

做它的简单方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-10T08:56:22.903

尝试[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T08:59:19.667

`System.Reflection.Assembly`是您要使用的类。它包含许多用于迭代用户 DLL 包含的类型的方法。您可以遍历每个类，也许看看它是否继承自特定接口等。

[http://msdn.microsoft.com/en-us/library/system.reflection.assembly_members.aspx](http://msdn.microsoft.com/en-us/library/system.reflection.assembly_members.aspx)

调查`Assembly.GetTypes()`获取类型列表的方法，或`Assembly.GetExportedTypes()`仅用于公共类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T08:57:10.467

您可以使用 Activator.CreateInstance 从 Type 对象创建类的实例，以获取 dll 中的所有类型，您可以使用 Assembly.GetTypes

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T08:57:33.087

看看这些链接：

[http://www.java2s.com/Code/CSharp/Development-Class/Createanobjectusingreflection.htm](http://www.java2s.com/Code/CSharp/Development-Class/Createanobjectusingreflection.htm)

[http://msdn.microsoft.com/en-us/library/k3a58006.aspx](http://msdn.microsoft.com/en-us/library/k3a58006.aspx)

您基本上使用反射来加载程序集，然后找到您感兴趣的类型。一旦您有了类型，您就可以要求找到它的构造函数或其他方法/属性。一旦有了构造函数，就可以调用它。简单的！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T09:19:54.813

正如已经说过的，您需要戳 System.Reflection 命名空间。

如果您事先知道要加载的 DLL 的位置/名称，则需要遍历 Assembly.GetTypes()。

在伪代码中，它看起来像这样：

创建和组装对象。

遍历程序集中包含的所有类型。

一旦你找到你要找的，调用它（CreateInstance）…

明智地使用它。

;)

如果你想四处看看，我有很多反射代码，但任务真的很简单，至少有十几篇关于示例的文章。（又名谷歌）。尽管如此，MSDN 是反射参考的好朋友。

# c# - DataTable 到可读的文本字符串

> ID：53652
> 
> 赞同：2
> 
> 时间：2008-09-10T08:56:27.130
> 
> 标签：c#, formatting, datatable

这可能有点愚蠢，但我需要通过文本电子邮件发送 DataTable 的内容（未知列、未知内容）。基本思想是遍历行和列，并使用 .ToString() 将所有单元格内容输出到 StringBuilder 中。

格式化是一个大问题。关于如何以文本格式使其看起来“可读”的任何提示/想法？

我正在考虑用空格“填充”每个单元格，但我还需要将一些单元格拆分为多行，这使得 StringBuilder 方法有点混乱（因为第一列的第二行文本在第一行之后最后一列中的文本行等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T08:58:10.637

将数据表转换为 HTML 表并发送 HTML 邮件是另一种选择吗？如果他们的客户支持它，那将在接收端变得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T08:59:32.053

这听起来像是一个非常糟糕的解决方案，但它可能会起作用：

将 DataTable 内容呈现到 DataGrid/GridView（假设为 ASP.NET）中，然后进行屏幕抓取。

我告诉过你这会很乱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T09:03:26.957

首先获取每列的最大大小。这样，包含邮政编码的 varchar(255) 列不会占用太多空间。

也许您可以拆分整个表格而不是拆分单行。将表格的完整右侧部分放入第二个字符串生成器中，并将其放在第一个表格的下方。

您还可以为用户提供创建逗号分隔文本的选项，以便接收者可以将表格导入电子表格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T09:02:09.427

循环遍历数据表并将其作为 HTML 电子邮件发送 -[从数据表生成 html 表并将其作为电子邮件正文发送](http://forums.asp.net/t/1046932.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T09:59:30.007

我通过专门为此任务编写自定义格式化程序来完成这项工作。代码大约有 120 -130 行长，所以我不知道是否应该将其作为答案发布在这里（也许将 .cs 文件附加到主题的功能会是一个好主意！）。

无论如何，如果有人对此感兴趣，请告诉我，我会提供代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T13:57:44.783

它是否需要很好地格式化，或者自动化系统会在另一端接收邮件消息吗？如果是后者，只需使用数据表的 .WriteXml() 方法。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-10T09:04:09.967

你可以这样做（如果是 VB）：

```
Dim Str As String = ""
    'Create File if doesn't exist
        Dim FILE_NAME As String = "C:\temp\Custom.txt"
        If System.IO.File.Exists(FILE_NAME) = False Then
            System.IO.File.Create(FILE_NAME)
        End If

        Dim objWriter As System.IO.StreamWriter
        Try
            objWriter = New System.IO.StreamWriter(FILE_NAME)
        Catch ex As System.IO.IOException
            MsgBox("Please close the file: (C:\temp\Custom.txt) before proceeding" & vbCrLf & ex.Message.ToString, MsgBoxStyle.Exclamation)
            objWriter = Nothing
            Err = True
        End Try

'I assume you know how to write to text file.
'Say my datagridview is named "dgrid"

Dim x,y as integer

For x = 0 to dgrid.rows.count -1
    For y = 0 to dgrid.columns.count - 1
       Str = dgrid.Rows(x).Cells(y).Values & " "
   Next y
Next x

objWriter.Close() 
```

[资源](http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_23041873.html)。

或者，您甚至可以从 DataTable生成[CSV文件。](http://en.wikipedia.org/wiki/Comma-separated_values)

# vim - 如何在 Vim 中有效地处理多个文件

> ID：53664
> 
> 赞同：1169
> 
> 时间：2008-09-10T09:03:49.733
> 
> 标签：vim, vi

我已经开始使用 Vim 来开发 Perl 脚本并且开始发现它非常强大。

我喜欢的一件事是能够一次打开多个文件：

```
vi main.pl maintenance.pl 
```

然后在它们之间跳跃：

```
:n
:prev 
```

并查看打开哪个文件：

```
:args 
```

要添加一个文件，我可以说：

```
:n test.pl 
```

我希望它会被添加到我的文件列表中，但它会清除我当前的文件列表，当我输入时`:args`我只有`test.pl`打开。

那么如何在我的 args 列表中添加和删除文件呢？

* * *

## 回答 #1

> 赞同：1229
> 
> 时间：2008-09-10T09:09:32.840

为什么不使用制表符（在 Vim 7 中引入）？`:tabn`您可以使用和在选项卡之间切换`:tabp`，`:tabe <filepath>`您可以添加一个新选项卡；并使用常规`:q`或`:wq`关闭选项卡。如果您映射`:tabn`和`:tabp`到您的`F7`/`F8`键，您可以轻松地在文件之间切换。

如果文件不多或者您没有 Vim 7，您也可以将屏幕拆分为多个文件：`:sp <filepath>`. `Ctrl`然后，您可以使用+在分屏之间切换`W`，然后在您想要移动的方向上使用箭头键（或者代替箭头键，`w`用于下一个和`W`上一个分屏）

* * *

## 回答 #2

> 赞同：579
> 
> 时间：2008-09-10T09:47:47.897

### 清单

要查看当前缓冲区的列表，我使用：

```
:ls 
```

* * *

### 开幕式

要打开一个新文件，我使用

```
:e ../myFile.pl 
```

具有增强的选项卡完成（放入`set wildmenu`您的`.vimrc`）。

注意：您也可以使用`:find`which 为您搜索一组路径，但您需要先自定义这些路径。

* * *

### 交换

要在所有打开的文件之间切换，我使用

```
:b myfile 
```

具有增强的选项卡完成（仍然`set wildmenu`）。

注意：`:b#`选择上次访问的文件，因此您可以使用它在两个文件之间快速切换。

* * *

### 使用窗口

`Ctrl-W s`并`Ctrl-W v`水平和垂直分割当前窗口。您还可以使用`:split`and `:vertical split`( `:sp`and `:vs`)

`Ctrl-W w`在打开的窗口之间切换，和`Ctrl-W h`（或`j`或`k`或`l`）在打开的窗口中导航。

`Ctrl-W c`关闭当前窗口，并`Ctrl-W o`关闭除当前窗口之外的所有窗口。

`-o`使用or标志启动 vim会以`-O`自己的拆分方式打开每个文件。

* * *

有了所有这些，我就不需要 Vim 中的选项卡了，我的手指找到了我的缓冲区，而不是我的眼睛。

注意：如果您希望所有文件都转到同一个 Vim 实例，请使用该`--remote-silent`选项启动 Vim。

* * *

## 回答 #3

> 赞同：243
> 
> 时间：2008-09-15T19:03:17.490

```
:ls 
```

用于打开缓冲区的列表

*   `:bp`前一个缓冲区
*   `:bn`下一个缓冲区
*   `:bn`（`n`一个数字）移动到第 n 个缓冲区
*   `:b <filename-part>`带有提供自动完成功能的制表键（太棒了！！）

在某些版本的 vim 中，实际上和分别`bn`是。在这种情况下，选项卡自动完成很有帮助。`bp``bnext``bprevious`

或者当您处于正常模式时，使用`^`切换到您正在处理的最后一个文件。

另外，您可以保存 vim 的会话

```
:mksession! ~/today.ses 
```

上述命令将当前打开的文件缓冲区和设置保存到`~/today.ses`. 您可以使用加载该会话

```
vim -S ~/today.ses 
```

轻松记住你昨天离开的地方。;)

* * *

## 回答 #4

> 赞同：121
> 
> 时间：2008-09-10T09:34:10.643

要添加到`args`列表中：

```
:argadd 
```

从`args`列表中删除：

```
:argdelete 
```

在您的示例中，您可以使用`:argedit`test.pl 将 test.pl 添加到`args`列表中并一步编辑文件。

`:help args`提供更多细节和高级用法

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2008-09-10T09:43:53.477

我使用缓冲区命令- `:bn`（下一个缓冲区）、`:bp`（上一个缓冲区）`:buffers`（列出打开的缓冲区）`:b<n>`（打开缓冲区 n）`:bd`（删除缓冲区）。`:e <filename>`只会打开一个新的缓冲区。

* * *

## 回答 #6

> 赞同：46
> 
> 时间：2008-09-10T09:34:14.573

我认为您可能使用了错误的命令来查看已打开的文件列表。

尝试`:ls`查看已打开的文件列表，您将看到：

```
 1 %a   "./checkin.pl"            line 1
  2 #    "./grabakamailogs.pl"     line 1
  3      "./grabwmlogs.pl"         line 0
  etc. 
```

然后，您可以通过列出的数字引用文件来浏览文件，例如：3b

或者您可以通过输入数字但使用 sb 而不是仅使用 b 来拆分屏幕。

另外，% 指的是当前可见的文件，# 指的是备用文件。

您可以通过按轻松在这两个文件之间切换`Ctrl` `Shift` `6`

编辑：就像`:ls`您可以`:reg`用来查看寄存器的当前内容，包括包含您已删除内容的 0-9 寄存器。如果您想重复使用之前删除的某些文本，这将特别有用。

* * *

## 回答 #7

> 赞同：40
> 
> 时间：2008-09-10T09:07:48.303

Vim（但不是原来的 Vi！）具有我发现（在许多情况下）优于缓冲区的选项卡。您可以说`:tabe [filename]`在新选项卡中打开文件。通过单击选项卡或通过组合键 [ *n* ]`gt`和来完成选项卡之间的循环`gT`。图形 Vim 甚至有图形标签。

* * *

## 回答 #8

> 赞同：27
> 
> 时间：2011-12-08T19:43:13.467

类似`:e`and`:badd`只会接受 ONE 参数，因此以下将失败

```
:e foo.txt bar.txt
:e /foo/bar/*.txt
:badd /foo/bar/* 
```

如果要从 vim 中添加多个文件，请使用`arga[dd]`

```
:arga foo.txt bar.txt
:arga /foo/bar/*.txt
:argadd /foo/bar/* 
```

* * *

## 回答 #9

> 赞同：27
> 
> 时间：2016-03-31T11:47:02.843

这里有很多答案！我在不重新发明轮子的情况下使用的东西——最著名的插件（不会很快消亡并且被很多人使用）是超快速和令人讨厌的。

*   **ctrlpvim/ctrlp.vim** - 按名称查找文件，按位置或仅按名称进行模糊搜索
*   **jlanzarotta/bufexplorer** - 浏览打开的缓冲区（当您不记得最近打开和修改了多少文件并且不记得它们在哪里时，可能是因为您使用 Ag 搜索它们）
*   **rking/ag.vim**搜索关于 gitignore 的文件
*   **scrooloose/nerdtree**查看目录结构、环视、添加/删除/修改文件

**编辑：**最近我一直在使用**dyng/ctrlsf.vim** 来搜索上下文视图（如 Sublime 搜索），并将引擎从**ag**切换到**ripgrep**。表现非常出色。

**EDIT2：**与**CtrlSF**一起，您可以使用**mg979/vim-visual-multi**，一次更改多个文件，然后最后一次保存它们。

* * *

## 回答 #10

> 赞同：26
> 
> 时间：2015-06-18T12:47:20.960

该线程中的一些答案建议使用选项卡，而其他答案建议使用缓冲区来完成同样的事情。选项卡和缓冲区是不同的。我强烈建议你阅读这篇文章“ [Vim Tab madness - Buffers vs Tabs](https://joshldavis.com/2014/04/05/vim-tab-madness-buffers-vs-tabs/) ”。

这是我从文章中提取的一个很好的摘要：

概括：

*   缓冲区是文件的内存文本。
*   窗口是缓冲区上的视口。
*   标签页是窗口的集合。

* * *

## 回答 #11

> 赞同：19
> 
> 时间：2008-09-15T17:15:35.797

在 vim 中使用多个文件时，我主要使用这些命令（打开约 350 个文件）：

*   `:b <partial filename><tab>`（跳转到缓冲区）
*   `:bw`（缓冲区擦除，删除缓冲区）
*   `:e <file path>`（编辑，打开一个新缓冲区>
*   `pltags`- 允许跳转到子程序/方法定义

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2017-07-05T20:02:51.293

添加另一个答案，因为任何答案均未涵盖此答案

更改所有要`tab`查看的缓冲区。

```
 :tab sball 
```

将所有缓冲区打开到选项卡视图。然后我们可以使用任何选项卡相关的命令

```
gt or :tabn           "    go to next tab
gT or :tabp or :tabN  "    go to previous tab 
```

详情在`:help tab-page-commands`。

我们可以指示 vim 以选项卡视图的形式打开多个文件`vim -p file1 file2`。 `alias vim='vim -p'`会有用的。
同样的事情也可以通过以下自动命令来实现`~/.vimrc`

```
 au VimEnter * if !&diff | tab all | tabfirst | endif 
```

* * *

无论如何要回答这个问题：添加到 arg 列表：`arga file`，

从 arg 列表中删除：`argd pattern`

更多在`:help arglist`

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2013-07-08T21:37:20.027

你可能想使用[Vim 全局标记](http://vim.wikia.com/wiki/Using_marks)。

这样，您可以在文件之间快速跳转，甚至可以跳转到文件中的标记位置。此外，关键命令很短： `'C` 带我到我正在使用的代码， `'T` 带我到我正在使用的单元测试。

当你改变位置时，重置标记也很快： `mC` 标记新的代码点， `mT` 标记新的测试点。

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2008-09-17T14:43:18.783

我对 gVim 和命令行 Vim 使用相同的 .vimrc 文件。我倾向于在 gVim 中使用制表符并在命令行 Vim 中使用缓冲区，因此我设置了 .vimrc 以使它们更容易使用：

```
" Movement between tabs OR buffers
nnoremap L :call MyNext()<CR>
nnoremap H :call MyPrev()<CR>

" MyNext() and MyPrev(): Movement between tabs OR buffers
function! MyNext()
    if exists( '*tabpagenr' ) && tabpagenr('$') != 1
        " Tab support && tabs open
        normal gt
    else
        " No tab support, or no tabs open
        execute ":bnext"
    endif
endfunction
function! MyPrev()
    if exists( '*tabpagenr' ) && tabpagenr('$') != '1'
        " Tab support && tabs open
        normal gT
    else
        " No tab support, or no tabs open
        execute ":bprev"
    endif
endfunction 
```

`H`这破坏了和的现有映射`L`，但它使文件之间的切换变得非常快速和容易。只需点击`H`下一个和`L`上一个；无论您使用的是制表符还是缓冲区，您都会得到预期的结果。

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2017-06-20T08:37:44.523

如果**仅使用 vim 内置命令**，我见过的在多个缓冲区之间切换的最佳命令是：

```
nnoremap <Leader>f :set nomore<Bar>:ls<Bar>:set more<CR>:b<Space> 
```

**它完美地结合了`:ls`和`:b`命令——列出所有打开的缓冲区并等待你输入命令来切换缓冲区。**

在 vimrc 中给出上述映射，一旦你输入`<Leader>f`,

*   显示所有打开的缓冲区
*   你可以：
    *   键入`23`以转到缓冲区 23，
    *   键入`#`以转到替代/MRU 缓冲区，
    *   输入文件的部分名称，然后输入`<Tab>`或`<C-i>`自动完成，
    *   或者只是`<CR>`或`<Esc>`留在当前缓冲区

上述键映射的输出快照是：

```
:set nomore|:ls|:set more
  1  h    "script.py"    line 1
  2 #h  + "file1.txt"    line 6  -- '#' for alternative buffer
  3 %a    "README.md"    line 17 -- '%' for current buffer
  4       "file3.txt"    line 0  -- line 0 for hasn't switched to
  5     + "/etc/passwd"  line 42 -- '+' for modified
:b '<Cursor> here' 
```

在上面的快照中：

*   第二列：`%a`为当前，`h`为隐藏，`#`为以前，为空，为尚未切换到。
*   第三栏：`+`用于修改。

另外，我强烈建议`set hidden`. 见`:help 'hidden'`。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2008-09-15T14:39:04.427

如果您要使用多个缓冲区，我认为最重要的是设置隐藏，这样即使您要离开的缓冲区有未保存的更改，它也可以让您切换缓冲区。

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2017-08-19T10:31:51.147

我使用以下内容，这为您提供了许多您希望在其他编辑器中拥有的功能，例如 Sublime Text / Textmate

1.  使用缓冲区而不是“标签页”。缓冲区与几乎所有其他编辑器中的选项卡的概念相同。
2.  如果您想要与选项卡相同的外观，您可以使用[vim-airline](https://github.com/vim-airline/vim-airline)`.vimrc`插件，并在您的:中进行以下设置`let g:airline#extensions#tabline#enabled = 1`。当您没有打开标签页时，这会自动将所有缓冲区显示为标签页眉
3.  使用 Tim Pope 的[vim-unimpaired](https://github.com/tpope/vim-unimpaired)分别给出`[``b`和`]``b`移动到上一个/下一个缓冲区（加上一大堆其他好东西）
4.  当您为缓冲区键入+时，`set wildmenu`您将获得一个可能的缓冲区列表，您可以使用左/右箭头滚动浏览`.vimrc``:b <file part>``Tab`
5.  使用 Tim Pope 的[vim-obsession](https://github.com/tpope/vim-obsession)插件来存储与航空公司很好玩的会话（我对[会话和插件有很多痛苦](https://github.com/vim-airline/vim-airline/issues/1505#issuecomment-316848122)）
6.  使用 Tim Pope 的[vim-vinegar](https://github.com/tpope/vim-vinegar)插件。这适用于本机`:Explore`，但更容易使用。您只需键入`-`以打开资源管理器，这与在资源管理器中进入目录的键相同。使导航更快（但是我很少使用 fzf）
7.  [fzf](https://github.com/junegunn/fzf#as-vim-plugin)（可以作为 vim 插件安装）也是一个非常强大的模糊查找器，您可以使用它来搜索文件（以及缓冲区）。fzf 也[可以很好地](https://github.com/junegunn/fzf#tips)与 fd 配合使用（find 的更快版本）
8.  使用[Ripgrep](https://github.com/BurntSushi/ripgrep)和[vim-ripgrep](https://github.com/jremmen/vim-ripgrep)搜索您的代码库，然后您可以使用`:cdo`结果进行搜索和替换

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2014-01-19T18:24:13.607

我有效处理多个文件的方法是使用 tmux。

它允许您垂直和水平拆分窗口，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/XDnTX.png)

我在我的 mac 和 linux 机器上都以这种方式工作，我发现它比提供的本机窗口窗格切换机制（在 Mac 上）更好。我发现切换更容易，只有使用 tmux，我才能在我的 mac 上获得“在同一当前目录中的新页面”（尽管似乎有在同一目录中打开新窗格的选项），这是一个令人惊讶的关键部分。当前位置的即时新窗格非常有用。一种为两个操作系统使用相同键组合的新窗格的方法对我来说至关重要，并且对所有人来说都是未来个人兼容性的奖励。除了多个 tmux 窗格之外，我还尝试过使用多个选项卡，例如![在此处输入图像描述](https://i.stack.imgur.com/O0N8A.png)和多个新窗口，例如![在此处输入图像描述](https://i.stack.imgur.com/TpErK.png)最终我发现多个 tmux 窗格对我最有用。我非常“视觉化”，喜欢把我的各种背景放在我面前，像窗格一样连接在一起。

tmux 还支持旧版`screen`不支持的水平和垂直窗格（尽管 mac 的 iterm2 似乎支持它，但同样，当前目录设置对我不起作用）。多路复用器 1.8

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2020-01-19T13:38:17.003

在我和其他许多 vim 用户中，最好的选择是，

*   使用打开文件，

> :e 文件名.extension

然后只需`Ctrl`+`6`即可更改为最后一个缓冲区。或者，您可以随时按

> :ls 列出缓冲区，然后使用 b 后跟缓冲区编号更改缓冲区。

*   我们使用垂直或水平分割

> :vsp 垂直分割
> 
> :sp 水平分割

然后`<C-W><C-H/K/L/j>`更改工作拆分。

**您当然可以编辑任意数量的拆分中的任何文件。**

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-09-16T19:05:17.257

`~/.vimrc`我使用在我的文件中设置为隐藏的多个缓冲区。

mini-buffer explorer 脚本也很适合获得一个漂亮的紧凑的缓冲区列表。然后`:b1`或`:b2`... 转到适当的缓冲区或使用迷你缓冲区资源管理器和选项卡浏览缓冲区。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2014-07-03T14:08:53.610

我经常使用命令行和 git，所以我的 bashrc 中有这个别名：

```
alias gvim="gvim --servername \$(git rev-parse --show-toplevel || echo 'default') --remote-tab" 
```

这将在现有窗口的新选项卡中打开每个新文件，并为每个 git 存储库创建一个窗口。因此，如果您从 repo A 打开两个文件，从 repo B 打开 3 个文件，您最终会看到两个窗口，一个用于带有两个选项卡的 repo A，一个用于带有三个选项卡的 repo B。

如果您打开的文件不包含在 git repo 中，它将转到默认窗口。

要在选项卡之间跳转，我使用这些映射：

```
nmap <C-p> :tabprevious<CR>
nmap <C-n> :tabnext<CR> 
```

要一次打开多个文件，您应该将其与其他解决方案之一结合使用。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-01-07T05:55:08.610

尝试以下地图以方便编辑多个文件

" 拆分窗口

`nmap <leader>sh :leftabove vnew<CR>`

`nmap <leader>sl :rightbelow vnew<CR>`

`nmap <leader>sk :leftabove new<CR>`

`nmap <leader>sj :rightbelow new<CR>`

“ 到处走

`nmap <C-j> <C-w>j`

`nmap <C-k> <C-w>k`

`nmap <C-l> <C-w>l`

`nmap <C-h> <C-w>h`

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2015-12-05T18:59:28.847

我制作了一个[非常简单的视频](https://www.youtube.com/watch?v=baNUGVAoX8M)，展示了我使用的工作流程。基本上我使用[Ctrl-P](https://github.com/kien/ctrlp.vim) Vim 插件，并将缓冲区导航映射到 Enter 键。

通过这种方式，我可以在正常模式下按 Enter，查看打开文件列表（显示在屏幕底部的一个小新窗口中），选择我要编辑的文件并再次按 Enter。要快速搜索多个打开的文件，只需键入部分文件名，选择文件并按 Enter。

我没有在视频中打开很多文件，但是当您开始拥有很多文件时，它会变得非常有用。

由于插件使用 MRU 排序对缓冲区进行排序，因此您只需按两次 Enter 并跳转到您正在编辑的最新文件。

安装插件后，您需要的唯一配置是：

```
nmap <CR> :CtrlPBuffer<CR> 
```

当然，您可以将其映射到不同的键，但我发现要输入的映射非常方便。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-06-03T23:52:32.273

我建议使用插件

> NERD树

这是带有说明的 github 链接。

[书呆子树](https://github.com/scrooloose/nerdtree)

我使用 vim-plug 作为插件管理器，但你也可以使用 Vundle。

[vim 插件](https://github.com/junegunn/vim-plug)

[文德尔](https://github.com/VundleVim/Vundle.vim)

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-04-13T02:46:39.907

当我开始使用 VIM 时，我没有意识到选项卡应该用作不同的窗口布局，而缓冲区用于多个文件编辑/相互切换。实际上，在 v7.0 之前，一开始的选项卡甚至不存在，我只是在终端选项卡中打开了一个 VIM（我当时正在使用 gnome-terminal），并使用 alt+数字在选项卡之间切换，因为我认为使用类似的命令:buffers, :bn 和 :bp 对我来说太多了。当 VIM 7.0 发布时，我发现管理大量文件并切换到它更容易，但最近我才意识到缓冲区应该始终是要走的路，除非有一件事：你需要对其进行配置以使其正常工作。

所以我尝试了 vim-airline 并启用了可视化的顶部选项卡式缓冲栏，但我的 iTerm2 出现了图形问题，所以我尝试了其他几个，似乎 MBE 最适合我。我还将 shift+h/l 设置为快捷方式，因为原始的（移动到当前页面的头部/尾部）对我来说不是很有用。

`map <S-h> :bprev<Return>`
`map <S-l> :bnext<Return>`

它似乎比 gt 和 gT 更容易，并且 :e 也比 :tabnew 更容易。我发现 :bd 虽然不如 :q 方便（MBE 有一些问题），但我认为我可以处理缓冲区中的所有文件。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2016-02-27T12:04:38.650

该线程中的大多数答案都是使用普通的 vim 命令，这当然很好，但我认为我会使用我认为特别有用的插件和功能的组合来提供广泛的答案（至少其中一些提示来自[Gary Bernhardt 的文件导航提示](https://www.destroyallsoftware.com/file-navigation-in-vim.html)）：

1.  要在最后两个文件之间切换，只需按`<leader>`两次。我建议分配`<leader>`给空格键：

    ```
    nnoremap <leader><leader> <c-^> 
    ```

2.  为了快速移动项目，答案是模糊匹配解决方案，例如[CtrlP](https://github.com/ctrlpvim/ctrlp.vim)。我将其绑定以`<leader>a`快速访问。

3.  如果我想查看当前打开的缓冲区的可视化表示，我使用[BufExplorer 插件](https://github.com/jlanzarotta/bufexplorer)。简单但有效。

4.  如果我想浏览文件系统，我会使用命令行或外部实用程序（Quicklsilver、Afred 等），但查看当前项目结构[NERD Tree](https://github.com/scrooloose/nerdtree)是经典之作。不要使用它来代替`2`您的主要文件查找方法。它真的会让你慢下来。我使用绑定`<leader>ff`。

这些应该足以查找和打开文件。当然，从那里使用水平和垂直拆分。关于拆分，我发现这些功能特别有用：

1.  当没有足够的空间时，在较小的区域打开新的拆分并在导航时扩展它们。请参阅[此处](https://www.destroyallsoftware.com/file-navigation-in-vim.html)以获取有关这些确切作用的评论：

    ```
    set winwidth=84
    set winheight=5
    set winminheight=5
    set winheight=999

    nnoremap <C-w>v :111vs<CR>
    nnoremap <C-w>s :rightbelow split<CR>
    set splitright 
    ```

2.  轻松地从拆分移动到拆分：

    ```
    nnoremap <C-J> <C-W><C-J>
    nnoremap <C-K> <C-W><C-K>
    nnoremap <C-L> <C-W><C-L>
    nnoremap <C-H> <C-W><C-H> 
    ```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-05-31T09:33:25.790

如果您在 osx 上并且希望能够单击您的选项卡，请使用 MouseTerm 和 SIMBL（取自[此处](http://ayaz.wordpress.com/2010/10/19/using-mouse-inside-vim-on-terminal-app/)）。另外，请查看此[相关讨论](https://stackoverflow.com/questions/1727261/scrolling-inside-vim-in-macs-terminal?rq=1)。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-10-20T22:37:24.743

通过添加以下内容，您可以成为*绝对的疯子*和别名：`vim``vim -p``.bashrc`

```
alias vim="vim -p" 
```

这将导致在选项卡中从 shell 打开多个文件，而无需`:tab ball`事后从 vim 中调用。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-03-30T12:19:22.143

1.  要使用 vim 类型打开 2 个或更多文件：`vim -p file1 file2`

2.  在那个命令去扔那个文件之后，你可以使用`CTRL`++`Shift``↑</kbd> or `↓</kbd> , it will change your files in vim.``

3.  如果你想再添加一个文件 vim 并使用它：`:tabnew file3`

4.  您也可以使用不会创建新选项卡并在屏幕上打开文件来切片您的屏幕：`:new file3`

5.  如果您想使用可以帮助您处理目录和文件的插件，我建议[您使用 NERDTree](https://github.com/scrooloose/nerdtree)。

6.  要下载它，你需要有 vim-plug 以便下载其他插件，还需要 NERDTree 在你的`~/.vimrc`.

```
 let data_dir = has('nvim') ? stdpath('data') . '/site' : '~/.vim'
    if empty(glob(data_dir . '/autoload/plug.vim'))
      silent execute '!curl -fLo '.data_dir.'/autoload/plug.vim --create-dirs 
      https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim'
      autocmd VimEnter * PlugInstall --sync | source $MYVIMRC
    endif

    call plug#begin('~/.vim/plugged')
    Plug 'scrooloose/nerdtree'
    call plug#end() 
```

7.  然后通过 command 保存 .vimrc `:wq`，返回并输入：`:PlugInstall`

之后，插件将被安装，您可以将您的 NERDTree 与其他插件一起使用。

# unit-testing - Rhino Mocks - How can I test that at least one of a group of methods is called?

> ID：53666
> 
> 赞同：1
> 
> 时间：2008-09-10T09:06:35.000
> 
> 标签：unit-testing, rhino-mocks, mocking, bdd

Say I have an interface IFoo which I am mocking. There are 3 methods on this interface. I need to test that the system under test calls at least one of the three methods. I don't care how many times, or with what arguments it does call, but the case where it ignores all the methods and does not touch the IFoo mock is the failure case.

I've been looking through the Expect.Call documentation but can't see an easy way to do it.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T09:12:53.533

You can give rhino mocks a lambda to run when a function get's called. This lambda can then increment a counter. Assert the counter > 1 and you're done.

Commented by Don Kirkby: I believe Mendelt is referring to the Do method.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-12T09:53:17.477

不确定这是否能回答你的问题，但我发现如果我需要用 Rhino（或任何类似的框架/库）做任何类似的事情，任何我不知道如何预先做的事情，那么我最好只是创建手动模拟。

如果调用任何方法，创建一个实现接口并将公共布尔字段设置为 true 的类将非常容易，您可以为该类指定一个描述性名称，这意味着（最重要的是）下一个查看代码的人将立即明白它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-12T10:27:07.317

如果我理解正确，您想检查接口是否在三个指定方法中的任何一个上至少调用一次。通过[快速参考](http://www.ayende.com/wiki/GetFile.aspx?File=Rhino+Mocks+3.3+Quick+Reference.pdf)，我认为你不能在 Rhino Mocks 中做到这一点。

直觉上，我认为您正在尝试编写易碎的测试，这是**一件坏事**。这意味着被测类的规范不完整。我敦促您仔细考虑设计，以便被测类和测试可以具有已知的行为。

但是，为了对示例有用，您始终可以这样做（**但不要这样做**）。

```
[TestFixture]
public class MyTest {

    // The mocked interface
    public class MockedInterface implements MyInterface {
       int counter = 0;
       public method1() { counter++; }
       public method2() { counter++; }
       public method3() { counter++; }
    }

    // The actual test, I assume you have the ClassUnderTest
    // inject the interface through the constructor and
    // the methodToTest calls either of the three methods on 
    // the interface.
    [TestMethod]
    public void testCallingAnyOfTheThreeMethods() {
        MockedInterface mockery = new MockedInterface();
        ClassUnderTest classToTest = new ClassUnderTest(mockery);

        classToTest.methodToTest();

        Assert.That(mockery.counter, Is.GreaterThan(1));
    }
} 
```

*（有人检查我的代码，我现在已经从脑海中编写了这个，并且已经有大约一年没有写过 C# 的东西了）*

我很想知道你为什么这样做。

# sql - How to efficiently SQL select newest entries from a MySQL database?

> ID：53670
> 
> 赞同：4
> 
> 时间：2008-09-10T09:10:59.560
> 
> 标签：sql, mysql

> **Possible Duplicate:**
> [SQL Query to get latest price](https://stackoverflow.com/questions/49404/sql-query-to-get-latest-price)

I have a database containing stock price history. I want to select most recent prices for every stock that is listed. I know PostreSQL has a [DISTINCT ON](https://stackoverflow.com/questions/25224/joining-latest-of-various-usermetadata-tags-to-user-rows#27159) statement that would suit ideally here.

Table columns are `name`, `closingPrice` and `date`; `name` and `date` together form a unique index.

The *easiest* (and very uneffective) way is

```
SELECT * FROM stockPrices s
WHERE s.date =
(SELECT MAX(date) FROM stockPrices si WHERE si.name = s.name); 
```

Much better approach I found is

```
SELECT *
FROM stockPrices s JOIN (
  SELECT name, MAX(date) AS date
  FROM stockPrices si
  GROUP BY name
) lastEntry ON s.name = lastEntry.name AND s.date = lastEntry.date; 
```

What would be an efficient way to do this? What indexes should I create?

> duplicate of:
> [SQL Query to get latest price](https://stackoverflow.com/questions/49404/sql-query-to-get-latest-price)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-10T09:21:13.107

I think that your second approach is very efficient. What's its problem?

You have to add indexes to name and date.

# database - 如何解决 ORA-011033：ORACLE 初始化或关机正在进行中

> ID：53676
> 
> 赞同：51
> 
> 时间：2008-09-10T09:14:47.617
> 
> 标签：database, oracle

当尝试`ORACLE`通过 TOAD（Quest Software）或任何其他方式（`Oracle Enterprise Manager`）连接到用户时，我收到此错误：

> `ORA-011033: ORACLE initialization or shutdown in progress`

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-09-10T09:22:14.043

经过一番谷歌搜索，我找到了执行以下操作的建议，并且它有效：

```
SQL> startup mount

ORACLE Instance started

SQL> recover database 

Media recovery complete

SQL> alter database open;

Database altered 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-01-23T03:14:12.153

这是我对这个问题的解决方案：

```
SQL> Startup mount
ORA-01081: cannot start already-running ORACLE - shut it down first
SQL> shutdown abort
ORACLE instance shut down.
SQL>
SQL> startup mount
ORACLE instance started.

Total System Global Area 1904054272 bytes
Fixed Size                  2404024 bytes
Variable Size             570425672 bytes
Database Buffers         1325400064 bytes
Redo Buffers                5824512 bytes
Database mounted.
SQL> Show parameter control_files

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
control_files                        string      C:\APP\USER\ORADATA\ORACLEDB\C
                                                 ONTROL01.CTL, C:\APP\USER\FAST
                                                 _RECOVERY_AREA\ORACLEDB\CONTRO
                                                 L02.CTL
SQL> select a.member,a.group#,b.status from v$logfile a ,v$log b where a.group#=
b.group# and b.status='CURRENT'
  2
SQL> select a.member,a.group#,b.status from v$logfile a ,v$log b where a.group#=
b.group# and b.status='CURRENT';

MEMBER
--------------------------------------------------------------------------------

    GROUP# STATUS
---------- ----------------
C:\APP\USER\ORADATA\ORACLEDB\REDO03.LOG
         3 CURRENT

SQL> shutdown abort
ORACLE instance shut down.
SQL> startup mount
ORACLE instance started.

Total System Global Area 1904054272 bytes
Fixed Size                  2404024 bytes
Variable Size             570425672 bytes
Database Buffers         1325400064 bytes
Redo Buffers                5824512 bytes
Database mounted.
SQL> recover database using backup controlfile until cancel;
ORA-00279: change 4234808 generated at 01/21/2014 18:31:05 needed for thread 1
ORA-00289: suggestion :
C:\APP\USER\FAST_RECOVERY_AREA\ORACLEDB\ARCHIVELOG\2014_01_22\O1_MF_1_108_%U_.AR

C
ORA-00280: change 4234808 for thread 1 is in sequence #108

Specify log: {<RET>=suggested | filename | AUTO | CANCEL}
C:\APP\USER\ORADATA\ORACLEDB\REDO03.LOG
Log applied.
Media recovery complete.
SQL> alter database open resetlogs;

Database altered. 
```

它奏效了：

![在此处输入图像描述](https://i.stack.imgur.com/TXcoQ.png)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2017-05-09T13:28:20.390

[当我按照Oracle 的教程](http://www.oracle.com/webfolder/technetwork/tutorials/obe/db/12c/r1/Windows_DB_Install_OBE/Installing_Oracle_Db12c_Windows.html)安装 12c 数据库时，我遇到了类似的问题。该指令指示读者创建一个 PLUGGABLE DATABASE (pdb)。

## 问题

`sqlplus hr/hr@pdborcl`会导致**`ORACLE initialization or shutdown in progress`**.

## 解决方案

*   1.  **登录`SYSDBA`到数据库**：

        ```
        sqlplus SYS/Oracle_1@pdborcl AS SYSDBA 
        ```

*   2.  **更改数据库**：

        ```
        alter pluggable database pdborcl open read write; 
        ```

*   3.  **再次登录**：

        ```
        sqlplus hr/hr@pdborcl 
        ```

*这对我有用*

[这里](https://docs.oracle.com/database/121/SQLRF/statements_2008.htm#SQLRF55667)有一些文档

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-27T02:33:52.333

当数据库正在启动或停止时，此错误也可能发生在正常情况下。通常在启动时，您可以等到启动完成，然后照常连接。如果错误仍然存​​在，*服务*（在 Windows 机器上）可能会在没有启动*数据库*的情况下启动。这可能是由于启动问题，也可能是因为服务未配置为自动启动数据库。在这种情况下，您必须以 sysdba 身份连接并使用“启动”命令物理启动数据库。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-01-27T01:02:06.540

我结合了上面的 rohancragg、Mukul Goel 和 NullSoulException 的答案。但是我有一个额外的错误：

ORA-01157: 无法识别/锁定数据文件字符串 - 请参阅 DBWR 跟踪文件

我在这里找到了答案：http: [//nimishgarg.blogspot.com/2014/01/ora-01157-cannot-identifylock-data-file.html](http://nimishgarg.blogspot.com/2014/01/ora-01157-cannot-identifylock-data-file.html)

万一上面的帖子被删除，我也在这里包含命令。

```
C:\>sqlplus sys/sys as sysdba
SQL*Plus: Release 11.2.0.3.0 Production on Tue Apr 30 19:07:16 2013
Copyright (c) 1982, 2011, Oracle.  All rights reserved.
Connected to an idle instance.

SQL> startup
ORACLE instance started.
Total System Global Area  778387456 bytes
Fixed Size                  1384856 bytes
Variable Size             520097384 bytes
Database Buffers          251658240 bytes
Redo Buffers                5246976 bytes
Database mounted.
ORA-01157: cannot identify/lock data file 11 – see DBWR trace file
ORA-01110: data file 16: 'E:\oracle\app\nimish.garg\oradata\orcl\test_ts.dbf'

SQL> select NAME from v$datafile where file#=16;
NAME
--------------------------------------------------------------------------------
E:\ORACLE\APP\NIMISH.GARG\ORADATA\ORCL\TEST_TS.DBF

SQL> alter database datafile 16 OFFLINE DROP;
Database altered.

SQL> alter database open;
Database altered. 
```

谢谢大家拯救了我的一天！

鱼

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-07-27T10:30:02.600

该问题也可能是由于硬盘空间不足。安装将成功，但在启动时，oracle 将无法创建所需的文件，并且将失败并显示与上述相同的错误消息。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-23T11:29:28.113

我希望这会对某人有所帮助，我解决了这样的问题

由于数据库未打开，出现问题。命令启动打开数据库。

`alter database open` 在某些情况下， 您可以使用命令解决此问题`alter database open resetlogs`

```
$ sqlplus / sysdba

SQL> startup
ORACLE instance started.

Total System Global Area 1073741824 bytes
Fixed Size          8628936 bytes
Variable Size         624952632 bytes
Database Buffers      436207616 bytes
Redo Buffers            3952640 bytes
Database mounted.
Database opened.

SQL> conn user/pass123
Connected. 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-24T06:09:52.987

我遇到了同样的问题。我为该数据库实例重新启动了 oracle 服务，并且错误消失了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-17T20:27:05.293

对我有用的是我没有设置local_listener，查看本地侦听器是否设置为登录`sqlplus / as sysdba`，确保数据库已打开并运行以下命令 `show parameter local_listener`，如果值为空，则必须设置使用以下 SQL 命令的 local_listener`ALTER SYSTEM SET LOCAL_LISTENER='<LISTENER_NAME_GOES_HERE>'`

# amazon-s3 - 亚马逊简单数据库

> ID：53693
> 
> 赞同：13
> 
> 时间：2008-09-10T09:26:58.680
> 
> 标签：amazon-s3, amazon-web-services, amazon-simpledb

有没有人考虑过使用类似于 Amazon SimpleDB 数据存储的东西作为他们的后端数据库？

SQL Server 托管（至少在英国）很昂贵，因此可以将这样的东西与云文件存储 (S3) 一起用于构建可以随应用程序增长的应用程序。

理论上很好，但有人会考虑使用它。事实上，现在有没有人真正将它用于真正的生产软件，因为我很想阅读您的评论。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-10T13:15:03.310

这是[Dare](http://www.25hoursaday.com/weblog/2008/08/21/SomeThoughtsOnAmazonsElasticBlockStore.aspx)对亚马逊服务的一个很好的分析。

*S3 处理了我通常听到的被称为“blob 存储”的内容。一个典型的 Web 应用程序通常具有媒体文件和其他资源（图像、CSS 样式表、脚本、视频文件等），它们可以通过名称/路径简单地访问。然而，很多这些资源也有需要存储的元数据（例如，YouTube 上的视频文件有关于其评级、上传者、观看次数等的元数据）。这种对可查询、模式化存储的需求正是 SimpleDB 的用武之地。EC2 提供了一个虚拟服务器，可用于完成计算，并带有一个本地文件系统实例，如果虚拟服务器因任何原因出现故障，该实例不是持久的。使用 SimpleDB 和 S3，您可以构建大型“Web 2.0”类 当您投入 EC2 提供的计算能力时，您可以创建风格的应用程序。然而，S3 和 SimpleDB 都没有为只需要典型 LAMP 或 WISC 开发人员构建数据库驱动的 Web 应用程序的开发人员提供解决方案，或者为可能具有不适合 blob 存储桶的自定义存储需求的应用程序提供解决方案或模式化存储。在无法访问持久文件系统的情况下，亚马逊云计算平台上的开发人员不得不提出复杂的解决方案，包括手动将数据从 EC2 备份到 S3 以获得所需的体验。然而，S3 和 SimpleDB 都没有为只需要典型 LAMP 或 WISC 开发人员构建数据库驱动的 Web 应用程序的开发人员提供解决方案，或者为可能具有不适合 blob 存储桶的自定义存储需求的应用程序提供解决方案或模式化存储。在无法访问持久文件系统的情况下，亚马逊云计算平台上的开发人员不得不提出复杂的解决方案，包括手动将数据从 EC2 备份到 S3 以获得所需的体验。然而，S3 和 SimpleDB 都没有为只需要典型 LAMP 或 WISC 开发人员构建数据库驱动的 Web 应用程序的开发人员提供解决方案，或者为可能具有不适合 blob 存储桶的自定义存储需求的应用程序提供解决方案或模式化存储。在无法访问持久文件系统的情况下，亚马逊云计算平台上的开发人员不得不提出复杂的解决方案，包括手动将数据从 EC2 备份到 S3 以获得所需的体验。*

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-31T23:16:33.490

我刚刚写完一个库，以便在 Perl 中轻松地将应用程序移植到 simpledb，Net::Amazon::SimpleDB::Simple，因为我发现 Amazon 客户端库很痛苦。该库尚未在 CPAN 上，但位于[http://rjurneyopen.s3.amazonaws.com/SimpleDB/Simple.pm](http://rjurneyopen.s3.amazonaws.com/SimpleDB/Simple.pm) 其想法是让在 SimpleDB 中输入和输出哈希变得简单。

我刚刚移植了一个应用程序来使用它。总的来说，SimpleDB 给我留下了深刻的印象……即使是低效的查询也只需 2-3 秒即可返回。由于其 Erlang/并行性质，SimpleDB 似乎并不关心表的大小。表扫描很容易。

痛苦来自于你无法计算、求和或分组的事实。如果您打算做任何这些事情……那么 SimpleDB 可能不适合您。目前就功能而言，它介于 memcached 和 MySQL 之间。您可以按限制选择订单，这很好。您不必自己扩展它也很好，而且它不在乎您往里面塞了多少东西也很好。但更高级的操作（如分析）充其量是痛苦的。您必须在服务器端进行自己的计算。在任何计算机上我都可以使用 simpledb CLI [http://code.google.com/p/amazon-simpledb-cli/](http://code.google.com/p/amazon-simpledb-cli/)来查询我的数据，这也是一大优势。

有一些令人困惑的“陷阱”。例如，属性可以有多个值，并且您必须在存储项目时显式设置“替换”。此外，存储 undef 或 null 字符串会导致库错误，而不是删除该属性名称/值对或将其设置为 null/空字符串。

学习以很大程度上未标准化的方式思考也有点奇怪，这就是为什么我会支持上面的建议，即它最适合新应用程序。从 SQL 应用程序移植到 SimpleDB 会很痛苦，因为您的应用程序逻辑必须改变。你做事的方式有点不同。亚马逊文档非常擅长解释这一点。

所有这些都可以在位于 SimpleDB 之上的库中提取，因此对于您使用 SimpleDB，您将需要选择一个好的库……您可能不想直接处理它。PHP 方面有一些工作可以让事情变得简单，还有我的库。有一个 RAILS activesource，但它似乎对你没有多大作用。

总而言之，它仍处于游戏初期，但与其他 API（想到 Twitter）相比，我不得不说 SimpleDB REST API 非常简单（特别是考虑到它是 XML）并且使用起来很有礼貌。我会推荐它...取决于您的应用程序的要求和您使用它的经济性。如果您希望快速扩展一项不会给数据库带来很大负载的服务，并且不想为可扩展的 MySQL/memcache 组合而烦恼……那么 SimpleDB 可以为您提供“简单”的解决方案。

我预计它的功能将继续增长，它将成为越来越多执行更复杂和有趣事情的应用程序的不错选择。但现在它针对并适合您的典型 Web 2.0 服务。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-06T01:21:09.397

我们几乎只将 SimpleDB 用于我们的新项目。零维护、高可用性、无安装方面太好了。对于您的 Ruby 开发人员，请查看[SimpleRecord](http://gemcutter.org/gems/simple_record)，这是一个类似于 ActiveRecord 的 SimpleDB 接口，它非常易于使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T09:29:02.840

但是你真的需要 SQL Server 吗？你不能使用 PostgreSQL 或 MySQL 吗？事实证明，两者都适用于大多数任务。

现在，如果您需要 SQL Server 功能，那么您就不走运了。

另一种选择是租用服务器。贵到什么程度？

（我已经使用 Amazon S3 来存储应用程序的图像，这没关系，并且工作正常，至少在这方面）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T09:32:02.083

我没有使用过 SimpleDB，但我们的应用程序一直在使用 S3、EC2 和 MySQL 的组合。

只要你愿意使用 SimpleDB，那么你不妨考虑使用 MySQL（它的扩展性很强，而且价格也不贵）。

在 S3 和 EC2 方面，它在实践中也很棒。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-16T09:15:08.057

SimpleDB 适用于许多应用程序......如果您的项目需要大量分析报告、加入等，您可以考虑使用 MySQL 或混合模型。

如果您使用 SimpleDB，我们开发了 Radquery.com 供我们内部使用，并向公众开放。

# objective-c - 创建带有章节标记的 MP4/M4A 文件

> ID：53705
> 
> 赞同：6
> 
> 时间：2008-09-10T09:39:22.160
> 
> 标签：objective-c, cocoa, macos, audio, quicktime

我正在尝试将多个音频文件合并到一个包含章节元数据的 mp4/m4a 文件中。

我目前正在使用 QTKit 来执行此操作，但不幸的是，当 QTKit 导出为 m4a 格式时，元数据全部被删除（Apple 已确认这是一个错误），请参阅[示例代码](http://files.shinydevelopment.com/audiojoiner.zip)。我认为这将 QTKit 排除在这项工作之外，但很高兴被证明是错误的，因为如果它有效，它是一个非常简洁的 API。

因此，我正在寻找一种将音频文件（输入格式并不重要，因为我可以进行转换）连接到带有章节元数据的 m4a 文件的方法。

作为代码的替代方案，我对使用现有命令行工具来完成此操作的想法持开放态度，只要它可以作为另一个应用程序的一部分再分发即可。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-10T18:58:58.913

[Audiobook Maker](http://audiobookmaker.sourceforge.net/)做了这样的事情，我相信它在引擎盖下使用了 ffmpeg。它是开源的，所以也许值得一看？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T03:15:32.800

我发现了这些人：[sensoryresearch](http://www.sensoryresearch.net/thoughtconduit/dev?id=8)，他们授权了一个 API，用于将章节/文本/链接轨道写入 MP4（这就是 M4A）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-12T15:55:04.533

命令行工具 mp4chaps 可以完成这项工作。如果您使用 Ubuntu，它来自 mp4v2-utils 包。记得为 quicktime 指定 qt 格式，因为现在 Nero 格式的章节标记似乎用得少了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T05:32:09.147

根据错误所在的位置，您可以尝试直接使用 QuickTime C API 来编写电影文件。您也可以尝试使用 C API 添加章节轨道。

关于苹果何时修复该错误的任何消息？我计划用 QTKit 创建增强的播客，并且需要它来工作。

# delphi - 如果没有显式调用，Delphi 调用是否继承于被覆盖的过程

> ID：53715
> 
> 赞同：8
> 
> 时间：2008-09-10T09:48:34.650
> 
> 标签：delphi, oop, inheritance

如果代码中没有显式调用（继承；），Delphi 调用是否继承于被覆盖的过程，我有以下结构（从超类到子类）

TForm >> TBaseForm >> TAnyOtherForm

项目中的所有表单都将派生自 TBaseForm，因为这将具有用于每个表单（安全性、验证等）的所有标准设置和破坏性部分。

TBaseForm 有 onCreate 和 onDestroy 程序以及执行此操作的代码，但是如果有人（即我）忘记将继承添加到 TAnyOtherForm 上的 onCreate 中，Delphi 会为我调用它吗？我在网上找到了说它不是必需的参考资料，但没有地方说如果代码中省略它是否会被调用。

另外，如果它确实为我调用了继承，它什么时候会调用它？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-10T09:53:15.123

不，如果您将调用保留为继承，则不会调用它。否则就不可能覆盖一个方法并完全忽略它的父版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T11:13:33.650

继承的调用必须显式进行。一般来说，没有一种语言会在等效情况下自动调用继承的函数（不包括类构造函数）。

很容易忘记在类构造函数中进行继承调用。在这种情况下，如果基类需要初始化任何数据，则您将等待发生访问冲突。

也许您可以在 TBaseForm 类中覆盖 DoCreate 和 DoDestory ，这样您就可以确保执行某些代码，而不管子类的实现如何。

```
// interface

TBaseForm = Class(TForm)
...
Protected
    Procedure DoCreate(Sender : TObject); Override;
End

// implementation

Procedure TBaseForm.DoCreate(Sender : TObject);
Begin
    // do work here

    // let parent call the OnCreate property  
    Inherited DoCreate(Sender);
End; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T11:46:46.580

值得一提的是，在 Destroy 中不调用任何对象的继承都会导致内存泄漏。有一些工具可以在您的源代码中检查这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-12T02:13:02.730

Inherited 必须在后代对象以及可视形式继承中显式调用。如果您使用类完成，那么如果您将定义标记为覆盖（但不是重新引入），它会自动添加继承。如果您使用可视表单继承，那么当您通过表单编辑器添加新的事件处理程序时，它也会添加继承。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-11T20:18:09.137

正如其他人所指出的那样，不会隐式调用继承的代码。您必须明确调用它。这为您提供了一些有用的灵活性。例如，您可能希望在继承代码之前执行一些预处理代码，然后再执行一些后处理代码。这可能看起来像：

```
procedure TMyCalcObject.SolveForX;
begin
  ResetCalcState;
  inherited SolveForX;
  PostProcessSolveForX;
end; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-25T15:30:28.587

您必须明确调用它。这提供了很大的灵活性，因为您可以选择在代码中的哪个点调用继承的方法。但这也是错误的一大来源。很容易忘记调用继承的函数，编译器无法判断您是故意这样做还是忘记了。

应该有某种指令“skip_inherited”告诉编译器你不想调用继承的方法。

如果没有找到“inherited”或“skip_inherited”，编译器就会很容易地报告错误。那意味着你忘记了。但不幸的是，CodeGear 中没有人想到这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-11T20:21:32.950

不，这就是覆盖的全部意义。

# excel - 在 Excel 折线图中隐藏数据点

> ID：53719
> 
> 赞同：6
> 
> 时间：2008-09-10T09:50:49.620
> 
> 标签：excel, charts, vba

显然可以在 Excel 折线图中隐藏单个数据点。

*   选择一个数据点。
*   右键单击-> 格式化数据点...
*   选择模式
*   选项卡将行设置为无

你如何在 VBA 中完成同样的事情？[直觉告诉我Point 对象](http://msdn.microsoft.com/en-us/library/aa174283(office.11).aspx) 上应该有一个属性`Chart.SeriesCollection(<index>).Points(<index>`来处理这个......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T02:30:26.023

实际上，如果您要使用 SpyJournal 的答案，它必须是`=IF(b2=0,NA(),b2)`，否则 Excel 只会将其识别为文本，而不是“官方”`#N/A`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-10T09:56:59.217

“给泰迪熊描述一下”几乎每次都能奏效……

您必须转到 Point 对象的 Border 子对象并将其 LineStyle 设置为 xlNone。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T10:03:29.467

作为一般提示：如果您知道如何在 excel 中执行某项操作，但不知道如何在 VBA 中执行此操作，您可以录制一个宏并查看录制的 VBA 代码（至少在大多数情况下有效）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T22:33:21.167

还有一个非 VBA 解决方案也可以通过 VBA 代码进行控制。在 Excel 中，不会显示由 #N/A 表示的数据点。因此，您可以使用公式（最简单的是`IF`函数）`#N/A`在图形数据中以文本形式返回。该数据点将不会显示，这意味着您无需尝试操作它的格式。

一个例子是简单地在表格中生成你的图形数据，然后用一个简单的公式在下面复制它

`=If(B2=0,"#N/A",B2)`

例如，当您想阻止折线图显示 0 值时，此方法有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-02T17:12:36.723

这可能为时已晚，无法提供帮助，但 SpyJournal 的答案虽然简单而优雅，但有点不正确，因为有必要省略 #N/A 周围的引号

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-06T11:15:10.553

是的。它不必让引号成为真正的不可用单元格内容，但对我来说 N/A 在我的图表中仍然绘制为 0。

我可以让它不绘图的唯一方法是让单元格空白。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-01T02:09:14.330

我在 Excel 207 中尝试了带引号的“#N/A”，结果数据点在图中显示为零。它可以在没有引号的情况下使用。

# security - HTML Encoding 会阻止各种 XSS 攻击吗？

> ID：53728
> 
> 赞同：67
> 
> 时间：2008-09-10T10:03:08.547
> 
> 标签：security, xss, html-encode

我不关心其他类型的攻击。只想知道 HTML Encode 是否可以防止各种 XSS 攻击。

即使使用 HTML 编码，是否有某种方法可以进行 XSS 攻击？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-09-16T07:57:39.170

不。

撇开允许一些标签的主题（不是问题的重点），HtmlEncode 根本不涵盖所有 XSS 攻击。

例如，考虑服务器生成的客户端 javascript - 服务器将 htmlencoded 值直接动态输出到客户端 javascript 中，htmlencode**不会阻止**注入的脚本执行。

接下来，考虑以下伪代码：

```
<input value=<%= HtmlEncode(somevar) %> id=textbox> 
```

现在，如果不是很明显，如果 somevar （当然是由用户发送的）设置为例如

```
a onclick=alert(document.cookie) 
```

结果输出是

```
<input value=a onclick=alert(document.cookie) id=textbox> 
```

这显然会起作用。显然，这可以是（几乎）任何其他脚本......而 HtmlEncode 也无济于事。

还有一些额外的向量需要考虑……包括第三种类型的 XSS，称为基于 DOM 的 XSS（其中恶意脚本是在客户端动态生成的，例如基于 # 值）。

也不要忘记 UTF-7 类型的攻击——攻击看起来像

```
+ADw-script+AD4-alert(document.cookie)+ADw-/script+AD4- 
```

没有什么可以编码的......

当然，解决方案（除了适当和限制性的白名单输入验证之外）是执行**上下文相关**编码：如果您输出的上下文是 HTML，或者您可能需要 JavaScriptEncoding、VBScriptEncoding 或 AttributeValueEncoding，则 HtmlEncoding 非常有用，或者……等等。

如果您使用的是 MS ASP.NET，则可以使用他们的 Anti-XSS 库，它提供了所有必要的上下文编码方法。

请注意，所有编码不应仅限于用户输入，还应包括来自数据库、文本文件等的存储值。

哦，不要忘记在 HTTP 标头和 META 标记中显式设置字符集，否则您仍然会有 UTF-7 漏洞......

更多信息和非常明确的列表（不断更新），请查看 RSnake 的备忘单：[http ://ha.ckers.org/xss.html](http://ha.ckers.org/xss.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-10T10:35:46.127

如果您在显示之前系统地编码所有用户输入，~~那么是的，您是安全~~的，您仍然不是 100% 安全。
（更多详情请参阅@Avid 的帖子）

此外，当您需要让**某些**标签未编码时会出现问题，以便您允许用户发布图像或粗体文本或任何需要将用户输入处理为（或转换为）未编码标记的功能。

您必须建立一个决策系统来决定哪些标签是允许的，哪些是不允许的，并且总是有可能有人会想办法让一个不允许的标签通过。

如果您遵循 Joel 关于[使错误代码看起来错误](http://www.joelonsoftware.com/articles/Wrong.html)的建议，或者[您的语言](http://blog.moertel.com/articles/2006/10/18/a-type-based-solution-to-the-strings-problem)在输出未处理的用户数据（静态类型）时通过警告/不编译来帮助您，这将有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T10:16:14.380

如果您对所有内容都进行编码。（取决于您的平台和 htmlencode 的实现）但是任何有用的 Web 应用程序都非常复杂，很容易忘记检查它的每个部分。或者，第 3 方组件可能不安全。或者，也许您进行编码的某些代码路径没有这样做，所以您在其他地方忘记了它。

所以你可能也想检查输入端的东西。您可能想检查从数据库中读取的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T11:45:18.190

正如其他人所提到的，只要在显示之前对*所有用户输入进行编码，您就安全了。*这包括从数据库中检索到的所有请求参数和数据，这些参数可以通过用户输入进行更改。

正如[Pat 所提到的，](https://stackoverflow.com/questions/53728/will-html-encoding-prevent-all-kinds-of-xss-attacks#53755)您有时会想要显示一些标签，而不是所有标签。一种常见的方法是使用诸如[Textile](http://en.wikipedia.org/wiki/Textile_(markup_language))、[Markdown](http://en.wikipedia.org/wiki/Markdown)或[BBCode](http://en.wikipedia.org/wiki/BBCode)之类的标记语言。但是，即使是标记语言也可能容易受到 XSS 的攻击，请注意。

```
# Markup example
[foo](javascript:alert\('bar'\);) 
```

如果您确实决定让“安全”标签通过，我建议您在输出之前找到一些现有的库来解析和清理您的代码。在您的消毒剂相当安全之前，您必须检测到[很多 XSS 向量。](http://ha.ckers.org/xss.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-11T19:40:38.900

我第二个 metavida 的建议是找到一个第三方库来处理输出过滤。中和 HTML 字符是阻止 XSS 攻击的好方法。但是，用于转换元字符的代码可能容易受到规避攻击；例如，如果它不能正确处理 Unicode 和国际化。

自制输出过滤器犯的一个典型的简单错误是仅捕获 < 和 >，但错过了诸如“”之类的内容，这可能会将用户控制的输出分解到 HTML 标记的属性空间中，其中 Javascript 可以附加到 DOM。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T16:19:14.830

不，仅编码常见的 HTML 令牌并不能完全保护您的网站免受 XSS 攻击。例如，请参阅在 google.com 中发现的这个 XSS 漏洞：

[http://www.securiteam.com/securitynews/6Z00L0AEUE.html](http://www.securiteam.com/securitynews/6Z00L0AEUE.html)

此类漏洞的重要之处在于，攻击者能够使用 UTF-7 对其 XSS 有效负载进行编码，如果您没有在页面上指定不同的字符编码，用户的浏览器可以解释 UTF-7 有效负载并且执行攻击脚本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T10:35:23.423

我想建议 HTML Purifier ( [http://htmlpurifier.org/](http://htmlpurifier.org/) ) 它不只是过滤 html，它基本上是标记化并重新编译它。它是真正的工业实力。

它还有一个额外的好处是允许您确保有效的 html/xhtml 输出。

还有 n'thing Textile，它是一个很棒的工具，我一直在使用它，但我也会通过 html purifier 运行它。

我认为你不明白我的意思是重新标记。HTML Purifier 不只是“过滤”，它实际上重构了 html。[http://htmlpurifier.org/comparison.html](http://htmlpurifier.org/comparison.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T10:15:27.490

您需要检查的另一件事是您的输入来自哪里。您可以使用引荐来源字符串（大部分时间）来检查它是否来自您自己的页面，但是在您的表单中输入一个隐藏的随机数或其他内容，然后检查它（可能使用会话集变量）也有助于了解输入来自您自己的网站，而不是某些网络钓鱼网站。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-10T10:14:47.877

我不相信。Html Encode 将所有功能字符（可以被浏览器解释为代码的字符）转换为浏览器无法解析并因此无法执行的实体引用。

```
&lt;script/&gt; 
```

浏览器无法执行上述操作。

**除非它们是浏览器中的错误。*

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-07-27T07:18:21.777

myString.replace(/<[^>]*>?/gm, '');

我用它，然后成功。 [从文本 JavaScript 中剥离 HTML](https://stackoverflow.com/questions/822452/strip-html-from-text-javascript)

# tsql - T-SQL 中临时表索引的最佳使用

> ID：53734
> 
> 赞同：13
> 
> 时间：2008-09-10T10:08:05.493
> 
> 标签：tsql, indexing, sap-ase, temp-tables

如果您在存储过程中创建一个临时表并希望在其上添加一个或两个索引，以提高针对它所做的任何其他语句的性能，最好的方法是什么？Sybase 是这样说[的](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.dc20020_1251/html/databases/databases644.htm)：

*"创建索引时表必须包含数据。如果创建临时表并在空表上创建索引，则 Adaptive Server 不会创建柱状图和密度等列统计信息。如果在创建索引后插入数据行，优化器的统计数据不完整。”*

但最近一位同事提到，如果我在与实际使用临时表的存储过程不同的存储过程中创建临时表和索引，则 Adaptive Server 优化器*将*能够使用它们。

总的来说，我不太喜欢增加一点价值的包装程序，所以我实际上并没有测试这个，但我想我会把问题放在那里，看看是否有人有任何其他的方法或建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-30T15:53:12.073

一些想法：

*   如果您的临时表太大以至于您必须对其进行索引，那么有没有更好的方法来解决问题？
*   您可以通过提供以下形式的优化器提示来强制它使用索引（如果您确定索引是访问表的正确方法）：

    ```
    SELECT * 
    FROM   #table (index idIndex) 
    WHERE  id = @id 
    ```

如果您对一般的性能技巧感兴趣，我已经在这里详细回答了一些其他问题：

*   [最喜欢的性能调优技巧](https://stackoverflow.com/questions/18783/sql-what-are-your-favorite-performance-tricks#103176)
*   [您如何针对特定查询优化表？](https://stackoverflow.com/questions/137226/how-do-you-optimize-tables-for-specific-queries#138949)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T11:45:09.317

将数据放入临时表后添加索引有什么问题？

您需要注意的一件事是索引对可能同时运行的过程的其他实例的可见性。

我喜欢为这些临时表（和索引）添加一个 guid，以确保永远不会发生冲突。这种方法的另一个好处是您可以简单地使临时表成为真正的表。

另外，请确保在存储过程运行期间，您需要*多次查询这些临时表中的数据，否则创建索引的成本将超过选择的好处。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T20:29:42.413

在 Sybase 中，如果您创建一个临时表，然后在一个 proc 中使用它，则使用表中估计的 100 行来构建选择计划。（该计划是在填充表之前程序开始时构建的。）这可能导致临时表被表扫描，因为它只有“100 行”。调用另一个 proc 会导致 Sybase 使用实际行数为 select 构建计划，这允许优化器选择更好的索引来使用。我已经看到使用这种方法的显着改进，但在您的数据库上进行测试，因为有时没有区别。

# velocity - How to escape a # in velocity

> ID：53744
> 
> 赞同：55
> 
> 时间：2008-09-10T10:18:40.850
> 
> 标签：velocity

I would like to know how can i escape a # in velocity. Backslash seems to escape it but it prints itself as well

This:

```
\#\# 
```

prints:

```
\#\# 
```

I would like:

```
## 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2011-08-17T13:47:26.820

这个：

```
#[[
##
]]# 
```

将产生：

```
## 
```

#[[ ... ]]# 中的任何内容都未解析。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-09-15T16:04:28.323

如果你不想打扰 EscapeTool，你可以这样做：

```
#set( $H = '#' )
$H$H 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-10T10:21:40.607

也许，以下网站有帮助？[http://velocity.apache.org/tools/1.4/generic/EscapeTool.html](http://velocity.apache.org/tools/1.4/generic/EscapeTool.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-12T07:07:53.707

将 esc 工具添加到您的工具箱中，然后您就可以使用 ${esc.hash}

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-27T09:58:32.500

${esc.h} 将输出 # 按照

[这个链接](http://velocity.apache.org/tools/1.4/generic/EscapeTool.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-15T15:37:00.370

设置技术是绕过您需要转义的任何字符的好方法，例如，如果您想让 $name 后跟“_lastname”，那么您可以这样做：

```
set ($n = '_lastname) 
```

并在你的模板中有这个：

```
$name$n 
```

一切都很好。

# c++ - 哪个编译成更快的代码：“n * 3”或“n+(n*2)”？

> ID：53757
> 
> 赞同：6
> 
> 时间：2008-09-10T10:44:33.453
> 
> 标签：c++, c, optimization, compiler-construction, performance

哪个编译成更快的代码：“ans = n * 3”或“ans = n+(n*2)”？

假设 n 是 int 或 long，并且它在现代 Win32 Intel 机器上运行。

如果涉及一些取消引用，这会有所不同，也就是说，其中哪一个会更快？

```
长一个；
长 *pn;
长答案；

...
*pn = some_number;
答案 = *pn * 3;

```

或者

```
答案 = *pn+(*pn*2);

```

或者，由于优化编译器在任何情况下都可能考虑到这一点，因此无需担心这一点吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-09-10T10:48:08.657

除非您使用一些异国情调的编译器，否则 IMO 没有必要进行此类微优化。我会把可读性放在首位。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-10T11:30:46.883

没关系。现代处理器可以在一个时钟周期或更短的时间内执行整数 MUL 指令，这与需要执行一系列移位和内部加法以执行 MUL 从而使用多个周期的旧处理器不同。我敢打赌

```
MUL EAX,3 
```

执行速度比

```
MOV EBX,EAX
SHL EAX,1
ADD EAX,EBX 
```

这种优化可能有用的最后一个处理器可能是 486。（是的，这偏向于英特尔处理器，但也可能代表其他架构）。

无论如何，任何合理的编译器都应该能够生成最小/最快的代码。所以总是首先考虑可读性。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-10T11:06:09.783

自己测量很容易，为什么不这样做呢？（使用`gcc`和`time`来自cygwin）

```
/* test1.c */
int main()
{
    int result = 0;
    int times = 1000000000;
    while (--times)
        result = result * 3;
    return result;
}

machine:~$ gcc -O2 test1.c -o test1
machine:~$ time ./test1.exe

real    0m0.673s
user    0m0.608s
sys     0m0.000s 
```

进行几次测试，然后重复其他情况。

如果你想偷看汇编代码，`gcc -S -O2 test1.c`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-10T10:51:54.997

这将取决于编译器、其配置和周围的代码。

您不应该在不进行测量的情况下尝试猜测事情是否“更快”。

*一般来说*，你现在不应该担心这种纳米级优化的东西——它几乎总是完全无关紧要的，如果你真的在一个重要的领域工作，你已经在使用分析器并查看汇编语言输出编译器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-10T11:45:10.390

不难发现编译器对您的代码做了什么（我在这里使用的是 DevStudio 2005）。使用以下代码编写一个简单的程序：

```
int i = 45, j, k;
j = i * 3;
k = i + (i * 2); 
```

在中间行放置一个断点并使用调试器运行代码。触发断点后，右键单击源文件并选择“Go To Disassembly”。您现在将看到一个显示 CPU 正在执行的代码的窗口。在这种情况下，您会注意到最后两行产生完全相同的指令，即“lea eax,[ebx+ebx*2]”（在这种特殊情况下不是位移和加法）。在现代 IA32 CPU 上，由于 CPU 的流水线性质，过早使用修改值会导致惩罚，直接执行 MUL 可能比位移更有效。

这说明了 aku 所说的内容，即编译器足够聪明，可以为您的代码选择最佳指令。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-10T10:48:40.463

它确实取决于您实际使用的编译器，但很可能它们会转换为相同的代码。

您可以通过创建一个小型测试程序并检查其反汇编来自行检查。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-10T10:49:33.473

大多数编译器都足够聪明，可以将整数乘法分解为一系列位移和加法。我不了解 Windows 编译器，但至少使用 gcc 你可以让它吐出汇编器，如果你看一下，你可能会看到两种编写它的方式相同的汇编器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-20T01:00:08.093

它不在乎。我认为还有更重要的事情需要优化。你花了多少时间思考和写这个问题，而不是自己编码和测试？

:-)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-20T01:15:05.770

只要你使用了一个不错的优化编译器，只需*编写易于编译器理解的代码*。这使编译器更容易执行巧妙的优化。

你问这个问题表明优化编译器比你更了解优化。所以相信编译器。使用`n * 3`.

也看看[这个答案](https://stackoverflow.com/questions/288942/how-to-convert-last-3-digits-of-number-into-0#289034)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-10T10:50:38.057

编译器擅长优化您的代码。任何现代编译器都会为这两种情况生成相同的代码，并另外替换`* 2`为左移。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T14:09:43.887

相信你的编译器会优化这样的小段代码。可读性在代码级别更为重要。真正的优化应该在更高的层次上。

# continuous-integration - 自动化日常构建的最佳方式

> ID：53766
> 
> 赞同：7
> 
> 时间：2008-09-10T10:51:57.197
> 
> 标签：continuous-integration, build

好的，所以我们都知道日常构建是项目的核心，但是自动化它的最佳方式是什么？

我们有 perl 脚本包装我们的管道，其中包括 ClearCase、VS2005 (C++)、Intel FORTRAN、Inno setup。我们在 UNIX 上使用 cron 作业来安排构建，并托管一个简单的 Apache Web 服务器来查看和监控构建。总而言之，它相当复杂，我想知道人们使用的最好的现成解决方案是什么？

是的，我确实说过 FORTRAN 有时不逃避它，它可以工作，没有必要为一些经过验证的 FEA 代码做一个巨大的重新实现项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T10:58:19.223

对我来说，我听说的一个新的非常漂亮的是[hudson](http://hudson.gotdns.com/wiki/display/HUDSON/Plugins) - 也支持 MSBuild。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T10:56:09.683

我们正在实施 CC.Net。到目前为止，它似乎非常适合您的模型。

开箱即用，它提供自动化构建、结果跟踪和通知。不过，我不确定内置进行中的监控有多详细。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T11:17:03.547

有许多专门处理此问题的工具：

*   [巡航控制](http://cruisecontrol.sourceforge.net/)
*   [哈德逊](http://hudson-ci.org/)
*   [连续体](http://continuum.apache.org/)

这些工具对最常见的构建类型提供了开箱即用的支持。它们还都支持某种“运行此脚本”类型的构建过程。

最后，您应该尽可能使用更好的构建工具（MSBuild、Ant、Maven、Make...），并使用自定义脚本填补更奇怪工具的空白。自动构建可以按正确的顺序调用这些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-10T10:55:27.593

我们使用[TeamCity](http://www.jetbrains.com/teamcity/index.html) - 但它是一个简单的 C#/Java 开发 - 也许您的管道可以通过它可以驱动的脚本来完成？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T03:39:34.010

这是我们找到的帮助我们选择持续集成工具的最佳资源。我们一直在此页面上评估 5 或 6 个工具。

[http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-10T11:09:58.230

我使用[Visual Build Pro](http://www.kinook.com/VisBuildPro/)取得了成功。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-10T11:28:49.573

CC.NET 非常强大。使用它并对此感到非常高兴。甚至系统托盘中的状态图标。这是一个小细节，但它可以让您很好地了解项目的“健康状况”。当您看到它是红色时，您会立即感到有动力修复测试。

现在我们使用自烘焙的一系列脚本。由于我们编写 Python，编译是不存在的，所以唯一的问题是运行测试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T13:06:06.937

如果您使用的是 Visual Studio，请务必查看[Team Foundation Build](http://msdn.microsoft.com/en-us/library/ms181710(VS.80).aspx)以查看它是否适合您的情况。

看起来 Buck Hodges[关于 VS 2008 版本的博文](http://blogs.msdn.com/buckh/archive/2007/08/14/tfs-2008-a-basic-guide-to-team-build-2008.aspx)也是一个很好的资源。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-07T05:05:18.277

我知道这是一个非常古老的问题，但它仍在搜索中，所以有人应该提到[Jenkins](http://jenkins-ci.org/) ——Hudson 的开源延续。

从[詹金斯维基](https://wiki.jenkins-ci.org/display/JENKINS/Meet+Jenkins)：

> 其中，当前的 Jenkins 专注于以下两个工作：
> 
> *   **持续构建/测试软件项目**，就像 CruiseControl 或 DamageControl。简而言之，Jenkins 提供了一个易于使用的所谓持续集成系统，使开发人员更容易将更改集成到项目中，并使用户更容易获得全新的构建。自动化、持续的构建提高了生产力。
> *   **监视外部运行的作业的执行**，例如 cron 作业和 procmail 作业，甚至那些在远程机器上运行的作业。例如，使用 cron，您收到的只是捕获输出的常规电子邮件，您需要仔细查看它们并注意它何时损坏。Jenkins 会保留这些输出，并让您在出现问题时很容易注意到。

It was originally built with Java in mind, so it integrates well with lots of other Java tools, but you can use it with any language, including all those mentioned by the OP.

# python - 如何为给定的概率分布生成直方图（用于功能测试服务器）？

> ID：53786
> 
> 赞同：4
> 
> 时间：2008-09-10T11:16:30.040
> 
> 标签：python, statistics, simulation, stress-testing

我正在尝试使用真实的请求频率分布来自动化服务器的功能测试。（某种负载测试，某种模拟）

我选择了[Weibull](http://en.wikipedia.org/wiki/Weibull_distribution)分布，因为它“有点”与我观察到的分布相匹配（快速上升，快速下降但不是立即）

我使用此分布来生成在给定开始日期和结束日期之间每天应发送的请求数

我已经在 Python 中编写了一个可行的算法，但感觉很笨拙：

```
how_many_days = (end_date - start_date).days
freqs = defaultdict(int)
for x in xrange(how_many_responses):
    freqs[int(how_many_days * weibullvariate(0.5, 2))] += 1
timeline = []
day = start_date
for i,freq in sorted(freqs.iteritems()):
    timeline.append((day, freq))
    day += timedelta(days=1)
return timeline 
```

有什么更好的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T11:20:27.830

你为什么不试试[The Grinder 3](http://grinder.sourceforge.net)来对你的服务器进行负载测试，它带有所有这些和更多的预构建，它支持 python 作为脚本语言

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-11T10:47:06.233

最后四行的修改时间稍长但可能更具可读性：

```
samples = [0 for i in xrange(how_many_days + 1)]
for s in xrange(how_many_responses):
    samples[min(int(how_many_days * weibullvariate(0.5, 2)), how_many_days)] += 1
histogram = zip(timeline, samples)
print '\n'.join((d.strftime('%Y-%m-%d ') + "*" * c) for d,c in histogram) 
```

这总是将样本丢弃在日期范围内，但您会在时间线末尾从 [0, 1] 范围以上的所有样本中获得相应的凸起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-11T13:40:31.730

这很快而且可能不那么准确，但是如果您自己计算 PDF，那么至少您可以更轻松地在单个时间线上放置几个较小/较大的 PDF。`dev`是高斯噪声中的标准偏差，它控制粗糙度。请注意，这*不是*生成所需内容的“正确”方式，但它很容易。

```
import math
from datetime import datetime, timedelta, date
from random import gauss

how_many_responses = 1000
start_date = date(2008, 5, 1)
end_date = date(2008, 6, 1)
num_days = (end_date - start_date).days + 1
timeline = [start_date + timedelta(i) for i in xrange(num_days)]

def weibull(x, k, l):
    return (k / l) * (x / l)**(k-1) * math.e**(-(x/l)**k)

dev = 0.1
samples = [i * 1.25/(num_days-1) for i in range(num_days)]
probs = [weibull(i, 2, 0.5) for i in samples]
noise = [gauss(0, dev) for i in samples]
simdata = [max(0., e + n) for (e, n) in zip(probs, noise)]
events = [int(p * (how_many_responses / sum(probs))) for p in simdata]

histogram = zip(timeline, events)

print '\n'.join((d.strftime('%Y-%m-%d ') + "*" * c) for d,c in histogram) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-11T08:30:23.410

与其将请求数作为固定值，不如使用比例因子来代替？目前，您将请求视为有限数量，并随机分配这些请求的日期。将您的每日请求视为独立的似乎更合理。

```
from datetime import *
from random import *

timeline = []
scaling = 10
start_date = date(2008, 5, 1)
end_date = date(2008, 6, 1)

num_days = (end_date - start_date).days + 1
days = [start_date + timedelta(i) for i in range(num_days)]
requests = [int(scaling * weibullvariate(0.5, 2)) for i in range(num_days)]
timeline = zip(days, requests)
timeline 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-11T09:11:50.907

我将上面的代码重写为更短（但现在可能太模糊了？）

```
timeline = (start_date + timedelta(days=days) for days in count(0))
how_many_days = (end_date - start_date).days
pick_a_day = lambda _:int(how_many_days * weibullvariate(0.5, 2))
days = sorted(imap(pick_a_day, xrange(how_many_responses)))
histogram = zip(timeline, (len(list(responses)) for day, responses in groupby(days)))
print '\n'.join((d.strftime('%Y-%m-%d ') + "*" * c) for d,c in histogram) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T01:16:20.977

另一种解决方案是使用[Rpy](http://rpy.sourceforge.net/)，它将 R 的所有功能（包括许多用于分发的工具）轻松放入 Python。

# .net - WindowsFormsHost 是否适合目的（.net WPF 托管 WinForms）？

> ID：53796
> 
> 赞同：10
> 
> 时间：2008-09-10T11:29:13.020
> 
> 标签：.net, wpf, winforms

GUI 驱动的应用程序需要托管一些基于 WinForms 的预构建组件。这些组件使用 GDI+ 和 DirectX 的混合提供高性能交互式视图。视图处理控制输入并显示自定义图形渲染。这些组件由供应商在 WinForms 工具中进行测试。

商业应用程序是否可以将 WPF 用于其 GUI 并依赖[WindowsFormsHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.aspx "WindowsFormsHost")来托管 WinForms 组件，或者您是否遇到过技术故障，例如输入延迟、更新问题而让您谨慎？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-10T12:25:02.293

我们目前在我们的软件中使用 WindowsFormsHost 来托管 WinForms DataGridView 控件，并且我们没有遇到任何实际问题。不过有几点需要注意：

首先是[空域限制](http://msdn.microsoft.com/en-us/library/aa970688.aspx)。实际上，这意味着 WinForms 内容总是出现在 WPF 内容之上。因此，如果您使用 WPF 装饰器，如果它们碰到您应用程序中的 WinForms 区域，它们将看起来被“修剪”。

第二个是，因为它们使用 Windows 资源，您必须更仔细地管理 WinForms 组件的生命周期。与 WPF 组件不同，WinForms 控件在完成后会被 Disposed。这使得将它们包含在纯 XAML 视图中变得很棘手。

最后一件事是，WinForms 控件似乎不像 WPF 显示的其余部分那样平滑地调整大小：一旦您完成调整，它们往往会捕捉到新的大小。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-16T07:26:29.340

我遇到的一个问题是嵌入式 Win Forms 控件不参与应用于其 WPF 容器的任何转换操作。这会导致视觉闪烁效果和嵌入式控件出现在不适当的位置。我通过将 Windows 窗体主机的可见性绑定到其 WPF 容器的动画状态来解决此问题，以便在动画完成之前隐藏嵌入式控件，如下所示。

```
<WindowsFormsHost Grid.Row="1" Grid.Column="1" Margin="8,0,0,0"
     Visibility="{Binding ActualHeight, RelativeSource={RelativeSource
     Mode=FindAncestor, AncestorType=UserControl},
     Converter={StaticResource WinFormsControlVisibilityConverter}}" >

     <winforms:DateTimePicker x:Name="datepickerOrderExpected" Width="140"
        Format="Custom" CustomFormat="M/dd/yy  h:mm tt"
        ValueChanged="OnEditDateTimeOrderExpected" />

</WindowsFormsHost> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T11:32:52.230

我在 WinForms 中托管 WPF 控件，反之亦然，没有问题。不过，我会广泛测试这些场景，因为很难预测复杂控制的行为方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T12:12:29.047

`Application`请注意在 Winforms 中托管时缺少 WPF对象。如果您使用现有的 WPF 组件并将其托管在 Winforms 中，这可能会导致问题，因为资源查找等永远不会在应用程序范围内查找。`Application`如果有问题，您可以创建自己的对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T12:28:30.443

正如[@Kent Boogaart 提到](https://stackoverflow.com/questions/53796/is-windowsformshost-fit-for-purpose-net-wpf-hosting-winforms#53855)的那样，我遇到了WinForms 中托管的WPF 应用程序没有WPF Application 对象（即Application.Current）的情况。这可能会导致许多问题，例如调度程序没有将线程调用回 UI 线程。这仅适用于您在 WinForms 中托管，而不是相反。

我也有奇怪的模态对话框行为奇怪的问题（即 ShowModal 调用）。我假设这是因为在 WinForms 中，每个控件都有自己的 Win32 句柄，而在 WPF 中，整个窗口只有一个句柄。

不管你做什么，测试:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T15:15:37.390

您可以使用 .net 3.5 SP1 解决空域问题：

> 这些类型的空域限制代表了框架中的巨大限制，例如 WPF，其中元素组合用于创建非常丰富的用户体验。使用 D3DImage 解决方案，这些限制不再存在！

请参阅[D3DImage 简介](http://www.codeproject.com/KB/WPF/D3DImage.aspx)。

# javascript - 对我的 JavaScript 进行基准测试的最佳工具是什么？

> ID：53802
> 
> 赞同：3
> 
> 时间：2008-09-10T11:33:53.727
> 
> 标签：javascript, dom

我目前正在开发一个 JavaScript 工具，在其执行过程中，它最终将遍历 DOM 中的每个节点。因为这可能是一项非常昂贵的任务，所以我想对这个脚本的性能进行基准测试。

在主要浏览器中对此类脚本进行基准测试的最佳免费工具是什么？理想情况下，我想要这个工具（甚至是一组工具）：

*   **根据测试结果生成某种形式的报告。** 它可以像显示执行时间的表格一样简单，也可以像生成某种形式的图表一样复杂。无论哪种方式都很好。
*   **免费。**这并不是说我不相信为软件付费，只是我在典型的日常任务中没有对这样的工具的主要需求。

如果可能的话，我还希望该工具能够生成不同级别的复杂页面，以便我可以对一组 DOM 进行压力测试。这不是必需品——如果需要，我可以自己写一个；但是，我想我会先对社区进行民意调查，看看是否已经存在某些东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T14:07:08.477

**[Firebug](http://getfirebug.com)**确实包含 JS 分析，它可能是最好的。虽然我在使用 Firebug 的调试器时遇到了问题，但它的分析器目前是顶级的。 **[Venkman](http://www.mozilla.org/projects/venkman/)**也是 Firefox 的较旧的 JS 调试器/分析器，以防万一您遇到 Firebug 问题。

使用这些工具应该可以让您在所有浏览器中获得几乎所有需要的配置文件，即使您只会监控 Firefox。如果你真的需要深入了解 IE 分析等的肮脏细节，有许多在线工具可以将分析调用注入到你的 javascript 中，以帮助监控所有缺少分析器的浏览器……但即使是 JS 性能纳粹像我一样，这似乎没有必要。

***Note:*** A new, very promising IE8 JS profiler has recently been announced: [http://blogs.msdn.com/ie/archive/2008/09/11/introducing-the-ie8-developer-tools-jscript-profiler.aspx](http://blogs.msdn.com/ie/archive/2008/09/11/introducing-the-ie8-developer-tools-jscript-profiler.aspx).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T16:43:54.993

In FireBug and FireBug Lite you can call the console.time() and console.timeEnd() methods in your code to start and end a timer around a particular piece of code. The Profiler tool in FireBug will measure how long each function takes. I've used it a lot to narrow down which lines of a particularly slow function are causing the slowdown

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T12:24:28.753

我相信[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)包括对 JS 代码的分析。当然，它并非在所有主要浏览器中都可用——只有 Firefox。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T12:16:37.820

杰夫发布[了伟大的浏览器 javascript 关闭](http://www.codinghorror.com/blog/archives/001023.html)

## [SunSpider JavaScript 基准测试](http://www2.webkit.org/perf/sunspider-0.9/sunspider.html)

但我想知道下载链接在哪里；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-30T22:13:34.233

For JavaScript, XmlHttpRequest, DOM Access, Rendering Times and Network traffic for IE6, 7 & 8 you can use the free [dynaTrace AJAX Edition](http://ajax.dynatrace.com)

# svn - 我可以在 Subversion 中关闭自动合并吗？

> ID：53803
> 
> 赞同：19
> 
> 时间：2008-09-10T11:34:45.800
> 
> 标签：svn, tortoisesvn

我们正在考虑从版本控制系统的签出/编辑/签入风格转移到 Subversion，在评估期间我们发现当您在 TortoiseSVN 中执行更新操作时（并且可能在任何 Subversion 客户端中？），如果需要将存储库中的更改应用于您一直在编辑的文件不会导致任何冲突，那么它们将被自动/静默合并。

这让我们有点害怕，因为这种合并可能不会产生任何编译错误，但至少会引入一些可能不容易检测到的逻辑错误。

非常简单的示例：我正在使用 C# 方法更改方法后半部分中的一些逻辑，而其他人更改了在方法开始时初始化变量的值。其他人的更改不在我正在处理的代码行中，因此不会发生冲突；但是可以显着改变方法的输出。

我们希望的情况是，如果需要进行合并，那么将显示这两个文件并至少提供一个简单的接受/拒绝更改选项，这样至少我们知道某些事情已经发生了变化并且可以选择查看它是否会影响我们的代码。

有没有办法用 Subversion/TortoiseSVN 做到这一点？或者我们是否过于拘泥于我们目前的工作方式，应该让它做它的事情......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-10-06T10:25:13.320

它在常见问题解答中： [如何防止 Subversion 进行自动合并？](http://tortoisesvn.tigris.org/faq.html#noautomerge)

> 1.  在 TortoiseSVN->Settings->General->Subversion 配置文件中，点击编辑按钮。
> 2.  `[helpers]`通过添加更改部分
>     
>     
>     
>     ```
>      diff-cmd = "C:\\false.bat" 
>     ```
>     
>     
>     
>     （注意双反斜杠）
>     
>     
> 3.  创建包含两行的文件 C:\false.bat
>     
>     
>     
>     ```
>      @type %9
>       @exit 1 
>     ```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-10T11:42:48.837

这是 TortoiseSVN 的一个技巧：

[如何在 Subversion 中关闭“自动合并”](http://www.blendedtechnologies.com/how-to-turn-off-auto-merge-in-subversion/33)

svn.exe 的窍门是将 svn 外部差异工具设置为将不断失败的程序。

```
svn --diff-cmd=/bin/false 
```

如果外部 diff 程序失败，svn 会得出结论，冲突是无法解决的，不会合并它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-10T12:09:28.883

解决这个问题的最好方法是教育开发人员。在 TortoiseSVN 中进行更新后，它会显示受影响文件的列表。只需双击每个文件即可获得它们之间的差异。然后，您将能够看到您的版本和最新的存储库版本之间发生了什么变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T12:15:31.240

如果可能的话，我建议你应该学习使用自然的 Subversion 模型。在实践中，我们发现冲突很少见，您所说的逻辑冲突类型几乎不存在（我不记得我们存储库中过去 4 年的实例）。

团队成员应尽可能小规模地签入更改（同时保持正确性），而不是将一整天的工作分批签入一次。这将减少踩到别人工作的可能性。

如果您担心您正在做的特定更改，Subversion 确实提供了一种**锁定**机制，让您可以防止对文件进行其他更改。请参阅[红皮书上有关](http://svnbook.red-bean.com/en/1.2/)[锁定](http://svnbook.red-bean.com/en/1.2/svn.advanced.locking.html)的章节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-16T16:12:03.720

这就是为什么自动化（单元）测试是分布式软件开发的基础部分。在您给出的示例中，至少一个单元测试应该在 svn update 上失败并提醒您该错误。

记住 Subversion 是什么：一个版本控制系统，而不是一个完美工作的代码合并工具。

# delphi - 在 Delphi 中重新引入函数

> ID：53806
> 
> 赞同：33
> 
> 时间：2008-09-10T11:39:50.467
> 
> 标签：delphi, oop, polymorphism

`reintroduce`在 Delphi中使用关键字的动机是什么？

如果您有一个子类包含一个与父类中的虚函数同名的函数，并且没有使用 override 修饰符声明它，那么这是一个编译错误。在这种情况下添加 reintroduce 修饰符可以修复错误，但我从未掌握编译错误的原因。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-09-12T02:09:51.583

如果您在后代类中声明一个与祖先类中的方法同名的方法，那么您将隐藏该祖先方法——这意味着如果您有该后代类的实例（被引用为该类），那么您将没有得到祖先的行为。当祖先的方法是虚拟或动态时，编译器会给你一个警告。

现在您有两种选择之一来抑制该警告消息：

1.  添加关键字**reintroduce**只是告诉编译器您知道您正在隐藏该方法并且它会抑制警告。您仍然可以在该下降方法的实现中使用**inherited**关键字来调用祖先方法。
2.  如果祖先的方法是**虚拟**的或**动态**的，那么您可以使用**override**。它具有附加的行为，如果通过祖先类型的表达式访问此后代对象，则对该方法的调用仍将是后代方法（然后可以选择通过**继承**调用祖先）。

**因此覆盖**和**重新引入**之间的区别在于多态性。使用**reintroduce**，如果您将后代对象转换为父类型，然后调用该方法，您将获得祖先方法，但如果您访问后代类型，那么您将获得后代的行为。使用**覆盖**你总是得到后代。如果祖先方法既不是**virtual**也不是**dynamic**，则**reintroduce**不适用，因为该行为是隐式的。（实际上你可以使用类助手，但我们现在不会去那里。）

尽管 Malach 说了什么，您*仍然可以在重新引入的方法中调用**继承***，即使父级既不是**virtual**也不是**dynamic**。

本质上 reintroduce 就像**override**，但它适用于非**动态**和非**虚拟**方法，并且如果通过祖先类型的表达式访问对象实例，它*不会替换行为。*

***进一步说明：***

**Reintroduce**是一种向编译器传达您没有出错的意图的方式。我们使用**override**关键字覆盖祖先中的方法，但它要求祖先方法是**virtual**或**dynamic**，并且您希望在对象作为祖先类访问时改变行为。现在输入**reintroduce**。它可以让您告诉编译器您没有意外创建与虚拟或动态祖先方法同名的方法（如果编译器没有警告您，这将很烦人）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T18:07:43.610

这里有很多关于为什么让你隐藏成员函数的编译器是一个坏主意的*答案*。但是没有现代编译器会*默默地*隐藏成员函数。即使在允许这样做的 C++ 中，也总会有一个警告，这应该就足够了。

那么为什么需要“重新引入”呢？主要原因是，当您不再查看编译器警告时，这种错误实际上可能会意外出现。例如，假设您从 TComponent 继承，Delphi 设计者向 TComponent 添加了一个新的虚函数。坏消息是您五年前编写并分发给其他人的派生组件已经具有该名称的功能。

如果编译器刚刚接受了这种情况，一些最终用户可能会重新编译您的组件，忽略警告。奇怪的事情会发生，*你*会受到指责。这要求他们明确接受该功能不是同一个功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T14:24:25.850

RTL 使用 reintroduce 来隐藏继承的构造函数。例如， TComponent 有一个构造函数，它接受一个参数。但是，TObject 有一个无参数的构造函数。RTL 希望您在实例化新的 TComponent 时仅使用 TComponent 的单参数构造函数，而不是从 TObject 继承的无参数构造函数。所以它使用 reintroduce 来隐藏继承的构造函数。这样，reintroduce 有点像在 C# 中将无参数构造函数声明为私有。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-30T20:23:27.083

首先，“reintroduce”打破了继承链，**不**应该使用，我的意思是**never ever**。在我与 Delphi 合作的整个过程中（大约 10 年），我偶然发现了许多使用这个关键字的地方，而且它一直是设计中的一个错误。

考虑到这一点，这是它最简单的工作方式：

1.  您在基类中有一个虚拟方法
2.  现在您想要一个名称完全相同但签名可能不同的方法。因此，您在派生类中使用相同的名称编写方法，并且由于未履行合同，因此无法编译。
3.  您将*reintroduce*关键字放在那里，您的基类不知道您的全新实现，您**只能**在从直接指定的实例类型访问您的对象时使用它。这意味着玩具不能只是将对象分配给基类型的变量并调用该方法，因为它不存在与损坏的合同。

就像我说的那样，这是纯粹的邪恶，必须不惜一切代价避免（嗯，至少这是我的观点）。这就像使用**goto** - 只是一种糟糕的风格：D

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-20T16:09:32.000

**tl; dr：**试图覆盖非虚拟方法是没有意义的。添加关键字`reintroduce`以确认您犯了一个错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-26T23:14:31.470

reintroduce 修饰符的目的是防止常见的逻辑错误。

我将假设 reintroduce 关键字如何修复警告是众所周知的，并将解释为什么会生成警告以及为什么该关键字包含在语言中。考虑下面的德尔福代码；

```
TParent = Class
Public
    Procedure Procedure1(I : Integer); Virtual;
    Procedure Procedure2(I : Integer);
    Procedure Procedure3(I : Integer); Virtual;
End;

TChild = Class(TParent)
Public
    Procedure Procedure1(I : Integer);
    Procedure Procedure2(I : Integer);
    Procedure Procedure3(I : Integer); Override;
    Procedure Setup(I : Integer);
End;

procedure TParent.Procedure1(I: Integer);
begin
    WriteLn('TParent.Procedure1');
end;

procedure TParent.Procedure2(I: Integer);
begin
    WriteLn('TParent.Procedure2');
end;

procedure TChild.Procedure1(I: Integer);
begin
    WriteLn('TChild.Procedure1');
end;

procedure TChild.Procedure2(I: Integer);
begin
    WriteLn('TChild.Procedure2');
end;

procedure TChild.Setup(I : Integer);
begin
    WriteLn('TChild.Setup');
end;

Procedure Test;
Var
    Child : TChild;
    Parent : TParent;
Begin
    Child := TChild.Create;
    Child.Procedure1(1); // outputs TChild.Procedure1
    Child.Procedure2(1); // outputs TChild.Procedure2

    Parent := Child;
    Parent.Procedure1(1); // outputs TParent.Procedure1
    Parent.Procedure2(1); // outputs TParent.Procedure2
End; 
```

鉴于上面的代码，TParent 中的两个过程都是隐藏的。说它们是隐藏的意味着程序不能通过 TChild 指针调用。编译代码示例会产生一个警告；

[DCC 警告] Project9.dpr(19)：W1010 方法“Procedure1”隐藏了基本类型“TParent”的虚拟方法

为什么只警告虚拟功能而不是其他？两者都是隐藏的。

Delphi 的一个优点是库设计者能够发布新版本，而不必担心破坏现有客户端代码的逻辑。这与 Java 形成鲜明对比，在 Java 中向库中的父类添加新函数充满危险，因为类是隐式虚拟的。假设上面的 TParent 存在于第 3 方库中，并且库制造商发布了下面的新版本。

```
// version 2.0
TParent = Class
Public
    Procedure Procedure1(I : Integer); Virtual;
    Procedure Procedure2(I : Integer);
    Procedure Procedure3(I : Integer); Virtual;
    Procedure Setup(I : Integer); Virtual;
End;

procedure TParent.Setup(I: Integer);
begin
    // important code
end; 
```

想象一下，我们的客户端代码中有以下代码

```
Procedure TestClient;
Var
    Child : TChild;
Begin
    Child := TChild.Create;
    Child.Setup;
End; 
```

对于客户端而言，代码是针对库的版本 2 还是版本 1 编译无关紧要，在这两种情况下，都会按照用户的意图调用 TChild.Setup。在图书馆里；

```
// library version 2.0
Procedure TestLibrary(Parent : TParent);
Begin
    Parent.Setup;
End; 
```

如果使用 TChild 参数调用 TestLibrary，则一切都按预期工作。库设计者不了解 TChild.Setup，在 Delphi 中这不会对他们造成任何伤害。上面的调用正确解析为 TParent.Setup。

在 Java 中的同等情况下会发生什么？TestClient 将按预期正常工作。TestLibrary 不会。在 Java 中，所有函数都被假定为虚拟的。Parent.Setup 将解析为 TChild.Setup，但请记住，当 TChild.Setup 被编写时，他们不知道未来的 TParent.Setup，所以他们肯定不会调用继承。因此，如果库设计者打算调用 TParent.Setup，无论他们做什么，它都不会被调用。当然，这可能是灾难性的。

因此，Delphi 中的对象模型需要在子类链中显式声明虚函数。这样做的副作用是很容易忘记在子方法上添加覆盖修饰符。Reintroduce 关键字的存在为程序员提供了便利。Delphi 的设计目的是通过生成警告来温和地说服程序员明确说明他们在这种情况下的意图。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-10T12:04:54.977

当祖先类也有一个同名的方法，并且它不一定被声明为虚拟时，你会看到一个编译器警告（因为你会隐藏这个方法）。

换句话说：你告诉编译器你知道你隐藏了祖先函数并用这个新函数替换它，并且故意这样做。

你为什么要这样做？如果该方法在父类中是虚的，唯一的原因是为了防止多态。除此之外，只是覆盖而不调用继承。但是如果父方法没有声明为虚拟的（并且你不能改变它，因为你不拥有例如代码），你可以从那个类继承并让人们从你的类继承而不会看到编译器警告。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-16T00:13:43.607

Reintroduce 告诉编译器您要调用此方法中定义的代码作为此类及其后代的入口点，而不管祖先链中具有相同名称的其他方法。

创建 a`TDescendant.MyMethod`会给 TDescendants 添加另一个具有相同名称的方法带来潜在的混淆，编译器会警告您。
Reintroduce 消除了歧义，并告诉编译器您知道使用哪一个。
`ADescendant.MyMethod`称 TDescendant 为一，`(ADescendant as TAncestor).MyMethod`称 Tancestor 为一。总是！没有混乱…… 编译开心！

无论您是否希望后代方法是虚拟的，这都是正确的：在这两种情况下，您都希望打破虚拟链的自然链接。它不会阻止您从新方法中调用继承的代码。

1.  TDescendant.MyMethod 是虚拟的： ...但您不能或不想使用链接。
    *   你不能因为方法签名不同。您别无选择，因为在这种情况下，由于返回类型或参数不完全相同，因此无法覆盖。
    *   您想从此类重新启动继承树。
2.  TDescendant.MyMethod 不是虚拟的：您将 MyMethod 转换为 TDescendant 级别的静态方法并防止进一步覆盖。从 TDescendant 继承的所有类都将使用 TDescendant 实现。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-20T16:59:39.630

由于框架版本（包括 VCL），这已被引入该语言。

如果您有一个现有的代码库，并且对框架的​​更新（例如，因为您购买了较新的 Delphi 版本）引入了一个与您的代码库的祖先中的方法同名的虚拟方法，那么`reintroduce`将允许您获得摆脱[W1010 警告](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/devcommon/cm_hidden_virtual_xml.html)。

这是您应该使用的唯一地方`reintroduce`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-11-13T16:20:12.260

首先，正如上面所说，你永远不应该故意重新引入虚拟方法。唯一合理的使用 reintroduce 是祖先的作者（不是您）添加了一个与您的后代冲突的方法并且重命名您的后代方法不是一种选择。其次，即使在使用不同参数重新引入虚拟方法的类中，您也可以轻松调用原始版本的虚拟方法：

```
type 
  tMyFooClass = class of tMyFoo;

  tMyFoo = class
    constructor Create; virtual;
  end;

  tMyFooDescendant = class(tMyFoo)
    constructor Create(a: Integer); reintroduce;
  end;

procedure .......
var
  tmp: tMyFooClass;
begin
  // Create tMyFooDescendant instance one way
  tmp := tMyFooDescendant;
  with tmp.Create do  // please note no a: integer argument needed here
  try
    { do something }
  finally
    free;
  end;

  // Create tMyFooDescendant instance the other way
  with tMyFooDescendant.Create(20) do  // a: integer argument IS needed here
  try
    { do something }
  finally
    free;
  end; 
```

那么除了让事情更难阅读之外，重新引入虚拟方法的目的应该是什么？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-27T13:51:19.343

**reintroduce**允许你声明一个与祖先同名但参数不同的方法。它与错误或错误无关！

例如，我经常将它用于构造函数......

```
constructor Create (AOwner : TComponent; AParent : TComponent); reintroduce; 
```

这使我能够以更简洁的方式为工具栏或日历等复杂控件创建内部类。我通常有比这更多的参数。有时在不传递一些参数的情况下创建一个类**几乎是不可能**或**非常混乱的。**

对于可视化控件，Application.Processmessages 可以在 Create 之后调用，这可能为时已晚，无法使用这些参数。

```
constructor TClassname.Create (AOwner : TComponent; AParent : TComponent);
begin
  inherited Create (AOwner);
  Parent      := AParent;
  ..
end; 
```

# build-process - 你能用 PHP 脚本或解释语言“构建”吗？

> ID：53807
> 
> 赞同：1
> 
> 时间：2008-09-10T11:41:01.087
> 
> 标签：build-process, continuous-integration, interpreted-language

如果我错了，请纠正我，但“构建”是“编译”，并不是每种语言都能编译。持续集成涉及构建组件以查看它们是否在单元测试之外继续工作，我可能过于简单化了。但是如果您的项目涉及一种无法编译的语言，您如何执行夜间构建或使用持续集成技术？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T12:01:40.960

嗯...我将“构建”定义为“准备、打包和部署软件系统的所有工件”。编译成机器代码只是构建过程中的众多步骤之一。其他人可能正在从 scm-system 检查最新版本的代码，获取外部依赖项，根据软件部署到的目标设置配置值并运行某种测试套件以确保您有一个“工作/运行”在实际部署之前构建”。

“构建”软件可以/必须为任何软件完成，与您的编程语言无关。解释型语言的“缺点”是语法或结构（例如调用带有错误参数的方法等）错误通常只会在运行时检测到（如果您的构建中没有单独的步骤来检查此类错误，例如与[PHPLint](http://www.icosaedro.it/phplint/)）。

因此（自动化的）测试用例（如单元测试 - 参见[PHPUnit](http://www.phpunit.de/)或[SimpleTest](http://simpletest.org/) - 和前端测试 - 参见[Selenium](http://selenium.openqa.org/)）对于大型 PHP 项目来说更为重要，以确保代码的良好运行状况。

PHP 也有一个很棒的构建工具（如用于 Java 的 Ant 或用于 Ruby 的 Rake）：[Phing](http://phing.info/trac/)

像[Xinc](http://code.google.com/p/xinc/)或[Hudson](http://hudson-ci.org/)这样的 CI 系统只是用于自动（就像任何时候将更改签入 scm）打包你的代码，检查它是否有明显的错误，运行你的测试（简而言之：运行你的构建）并将结果报告给你的开发小组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T11:43:36.837

为您当前的源代码管理主干创建一个每日标签？

# java - 向应届大学毕业生提问的 15 分钟 Java 问题

> ID：53808
> 
> 赞同：6
> 
> 时间：2008-09-10T11:41:06.237
> 
> 标签：java

在采访大学合作社/实习生或应届毕业生时，有一个他们可以在 15 分钟内在白板上完成的 Java 编程问题会有所帮助。有没有人有这样的好问题的例子？我曾经在一次采访中被问到的一个 C++ 问题是写一个字符串到整数函数，这与我正在寻找示例的问题级别一致。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-10T11:53:44.520

有什么理由必须在白板上吗？就个人而言，我宁愿让他们坐在键盘前，让他们编写一些代码。我们的测试曾经是一个简单的 100 (IIRC) 行 Swing 文本编辑器。然后我们用一些简单的方法打破了它，一些使代码无法编译，一些更微妙，并给了候选人半小时和一个要修复的问题列表。

即使你不能让他们动手做任何事情，也要确保你确实给了他们一些明确的技术问题。在另一轮面试中，有数量惊人的刚毕业的毕业生只是在说流行语的 IDE 骑师，所以他们看起来还不错，在白板前挥动双手谈论 Enterprise-this 和 SOA-that，但是当他们给出一个简单的 Java 基础多项选择题考试，询问关于什么`final`和`protected`含义的事情做得非常糟糕。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-10T12:09:43.437

我一直认为算法问题应该与语言无关。如果您想测试学生的 java 水平，请关注语言：它的关键字（从常见的静态到更奇特的，如 volatile）、泛型、重载、变量的装箱/拆箱、标准库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-10T11:48:00.400

1.  编写一个函数来使用指针交换变量值（真的很差的会为此而堕落）
2.  编写程序求XY平面上两点之间的距离。使用类来存储积分。
3.  使用简单的程序演示如何在 java 中使用多态性。
4.  编写程序打印前 n 个素数。
5.  编写一个程序，将文件中的字符串替换为另一个字符串。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-10T11:55:54.407

SO上出现的一些东西：

*   IsPalindrome(字符串 s)
*   ReverseWordsInString(string s): "我知道 java" --> "java 知道我"

其他想到的东西：

*   将向量与矩阵相乘（可以用 OO 风格完成吗？）
*   `echo`（是的，一个简单的 unix 工具克隆）
*   `cat`（15分钟应该足够了，应该清除无能的人）
*   s的简单容器`int`。喜欢`ArrayList`。**奖励问题**：通用？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-20T23:29:19.823

如果您不知道要问他们什么问题，那么您可能不适合用 Java 采访他们。恕我直言，我讨厌人们在面试中问我自己不知道答案的问题。大多数问题的答案可以在几秒钟内通过谷歌搜索在线找到。如果有人有 Java 经验，他们肯定会知道抽象类、接口等，因为它们是核心构建块。如果他/她不知道 'volatile' 关键字 - 大不了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T12:36:44.277

我同意[Nicolas](https://stackoverflow.com/questions/53808/good-15-minute-java-question-to-ask-recent-college-graduate#53847)关于将算法问题与实际语言问题分开的观点。

您可能要考虑的一件事是给他们几个简单的算法问题，他们可以在白板上写出伪代码（例如，“向我解释[冒泡排序](http://en.wikipedia.org/wiki/Bubble_sort)并向我展示它的伪代码。”

然后，一旦他们展示了他们的算法知识，您就可以继续讨论 Java 问题。由于有些人在电脑前工作比在白板前工作得更好，我会给他们一些简单的东西，但利用他们的 Java 知识，他们可以在 30 分钟左右使用与您使用的相同 IDE 实现公司。这样，如果他们声称知道 IDE，您也可以了解他们对 IDE 的了解程度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-24T02:22:07.393

1.  编写一个合并两个排序列表的函数——在限制处停止。寻找简单的优化和正确的边界检查/子列表调用。告诉他们 T 实现了 compareTo。

    public List<T> merge(List<T> 一，List<T> 二，int 限制)

2.  编写一个函数，如果数组中的任意两个整数与给定的和相加，则返回 true。让他们尝试使用某种集合或数据结构做得比 n 平方更好。

    public boolean containsSum(int[] nums, int sum)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-24T02:45:36.630

我会避免问他们本科课程会涉及的问题。我会更好奇他们运用所学知识解决复杂技术问题的能力。如果您的企业对 IT 解决方案有特定需求，您可以将其作为起点。您可以询问候选人他们将使用哪些技术，以及使用这些技术与替代技术的优缺点。随着讨论的进行，您可以了解他们的技术能力、解决问题的能力、人际交往能力等。我认为避免指导他们很重要，即使是在尴尬的时刻。这对于清除`BSers`.

# c++ - 您通常如何设置编译器的优化设置？

> ID：53811
> 
> 赞同：6
> 
> 时间：2008-09-10T11:41:42.630
> 
> 标签：c++, c, optimization, compiler-optimization

您通常将编译器设置为优化最大速度还是最小代码大小？还是您手动配置个别优化设置？为什么？

我注意到大多数时候人们倾向于将编译器优化设置保留为默认状态，这对于 Visual c++ 意味着最大速度。我一直觉得默认设置更多地与在基准测试中看起来不错有关，这往往是完全适合 L2 缓存的小程序，而不是最适合整体性能的设置，所以我通常将其设置为优化最小尺寸。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T11:52:50.093

作为一个 Gentoo 用户，我已经在整个操作系统上尝试了很多优化，并且在[Gentoo 论坛上](http://forums.gentoo.org/)对此进行了无休止的讨论。可以在[wiki](http://gentoo-wiki.com/Safe_Cflags)中找到 GCC 的一些好的标志。

简而言之，在内存有限的旧 Pentium3 笔记本电脑上优化尺寸效果最好，但在我的带有 Core2Duo 的主台式机上，-O2 总体上给出了更好的结果。

如果您对最优化的 x86（32 位）特定标志感兴趣，还有一个[小脚本。](http://www.pixelbeat.org/scripts/gcccpuopt)

如果您使用 gcc 并且真的想优化特定应用程序，请尝试[ACOVEA](http://www.coyotegulch.com/products/acovea/)。它运行一组基准，然后使用所有可能的编译标志组合重新编译它们。网站上有一个使用霍夫曼编码的例子（越低越好）：

```
A relative graph of fitnesses:

   Acovea Best-of-the-Best: **************************************                (2.55366)
     Acovea Common Options: *******************************************           (2.86788)
                       -O1: **********************************************        (3.0752)
                       -O2: ***********************************************       (3.12343)
                       -O3: ***********************************************       (3.1277)
           -O3 -ffast-math: **************************************************    (3.31539)
                       -Os: *************************************************     (3.30573) 
```

（请注意，它发现 -Os 在这个 Opteron 系统上是最慢的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T11:58:31.093

我更喜欢使用最小的尺寸。内存可能很便宜，**缓存不是**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-10T14:23:58.077

除了缓存位置很重要（正如 On Freund 所说），微软做的另一件事是分析他们的应用程序并找出在启动的最初几秒钟内执行了哪些代码路径。之后，他们将这些数据反馈给编译器，并要求它将启动期间执行的部分放在一起。这导致更快的启动时间。

我确实相信这种技术在 VS 中是公开可用的，但我不能 100% 确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T11:49:52.347

对我来说，这取决于我使用的平台。对于某些嵌入式平台或当我在 Cell 处理器上工作时，您会受到限制，例如非常小的缓存或为代码提供的最小空间。

我使用 GCC 并倾向于将其保留在“-O2”上，这是“最安全”的优化级别，并且有利于速度而不是最小尺寸。

我想说它可能不会有太大的不同，除非您正在开发一个非常高性能的应用程序，在这种情况下，您可能应该针对您的特定用例对各种选项进行基准测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T12:25:30.793

Microsoft 发布了所有针对大小进行了优化的 C/C++ 软件。在进行基准测试后，他们发现它实际上提供了更好的速度（由于缓存位置）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-11T16:09:16.880

有许多类型的优化，最大速度与小代码只是其中一种。在这种情况下，我会选择最大速度，因为可执行文件会稍大一些。另一方面，您可以针对特定类型的处理器优化您的应用程序。在某些情况下这是一个好主意（如果您打算只在您的工作站上运行该程序），但在这种情况下，该程序可能无法在其他架构上运行（例如：您编译您的程序以在 Pentium 上运行） 4 机器-> 它可能不适用于 Pentium 3)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T06:49:23.960

构建两者，配置文件，选择哪个在特定项目和硬件上效果更好。

对于性能关键代码，那就是 - 否则选择任何并且不要打扰。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-10T11:47:40.027

我们总是使用最大化来获得最佳速度，但是，我用 C++ 编写的所有代码都与生物信息学算法有关，速度是至关重要的，而代码量相对较小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-10T11:49:07.713

现在内存很便宜 :) 因此，除非您使用嵌入式系统，否则将编译器设置设置为最大速度可能很有意义。当然答案取决于具体情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T14:06:43.270

这取决于您的程序的应用。在对应用程序进行编程以控制快速的工业过程时，针对速度进行优化是有意义的。在对只需要对用户输入做出反应的应用程序进行编程时，优化大小可能是有意义的。也就是说，如果您担心可执行文件的大小。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-26T14:49:13.167

像这样调整编译器设置是一种优化。根据“过早的优化是万恶之源”的原则，直到程序接近其最终交付状态并且我发现它不够快——即几乎从不。

# java - 为什么 Windows XP 在我的第二个屏幕上最小化我的摆动全屏窗口？

> ID：53820
> 
> 赞同：3
> 
> 时间：2008-09-10T11:47:55.860
> 
> 标签：java, windows, swing

*在我正在开发的应用程序中（在 Java/swing 中），我必须在用户的第二个*屏幕上显示一个全屏窗口。我使用类似于您将在下面找到的代码来执行此操作...是，只要我单击由 Windows 资源管理器打开的窗口，或者只要我打开 Windows 资源管理器（我使用的是 Windows XP），全屏窗口最小化...

您是否知道解决此问题的任何方法或解决方法，或者全屏窗口有什么我不理解的重要内容？

谢谢您的帮助，

```
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JWindow;

import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.Window;

import javax.swing.JButton;
import javax.swing.JToggleButton;
import java.awt.Rectangle;
import java.awt.GridBagLayout;
import javax.swing.JLabel;

public class FullScreenTest {

    private JFrame jFrame = null;  //  @jve:decl-index=0:visual-constraint="94,35"
    private JPanel jContentPane = null;
    private JToggleButton jToggleButton = null;
    private JPanel jFSPanel = null;  //  @jve:decl-index=0:visual-constraint="392,37"
    private JLabel jLabel = null;
    private Window window;
    /**
     * This method initializes jFrame   
     *  
     * @return javax.swing.JFrame   
     */
    private JFrame getJFrame() {
        if (jFrame == null) {
            jFrame = new JFrame();
            jFrame.setSize(new Dimension(474, 105));
            jFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            jFrame.setContentPane(getJContentPane());
        }
        return jFrame;
    }

    /**
     * This method initializes jContentPane 
     *  
     * @return javax.swing.JPanel   
     */
    private JPanel getJContentPane() {
        if (jContentPane == null) {
            jContentPane = new JPanel();
            jContentPane.setLayout(null);
            jContentPane.add(getJToggleButton(), null);
        }
        return jContentPane;
    }

    /**
     * This method initializes jToggleButton    
     *  
     * @return javax.swing.JToggleButton    
     */
    private JToggleButton getJToggleButton() {
        if (jToggleButton == null) {
            jToggleButton = new JToggleButton();
            jToggleButton.setBounds(new Rectangle(50, 23, 360, 28));
            jToggleButton.setText("Show Full Screen Window on 2nd screen");
            jToggleButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent e) {
                    showFullScreenWindow(jToggleButton.isSelected());
                }
            });
        }
        return jToggleButton;
    }

    protected void showFullScreenWindow(boolean b) {
        if(window==null){
            window = initFullScreenWindow();
        }
        window.setVisible(b);

    }

    private Window initFullScreenWindow() {
        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice[] gds = ge.getScreenDevices();
        GraphicsDevice gd = gds[1];
        JWindow window = new JWindow(gd.getDefaultConfiguration());
        window.setContentPane(getJFSPanel());
        gd.setFullScreenWindow(window);
        return window;
    }

    /**
     * This method initializes jFSPanel 
     *  
     * @return javax.swing.JPanel   
     */
    private JPanel getJFSPanel() {
        if (jFSPanel == null) {
            jLabel = new JLabel();
            jLabel.setBounds(new Rectangle(18, 19, 500, 66));
            jLabel.setText("Hello ! Now, juste open windows explorer and see what happens...");
            jFSPanel = new JPanel();
            jFSPanel.setLayout(null);
            jFSPanel.setSize(new Dimension(500, 107));
            jFSPanel.add(jLabel, null);
        }
        return jFSPanel;
    }

    /**
     * @param args
     */
    public static void main(String[] args) {
        FullScreenTest me = new FullScreenTest();
        me.getJFrame().setVisible(true);

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T11:57:02.483

通常，当应用程序处于“全屏”模式时，它将占据整个桌面。为了让用户进入另一个窗口，他们必须使用 alt-tab 键。此时，windows 将最小化全屏应用程序，以便其他应用程序可以出现在最前面。

这听起来可能是 Windows 中的错误（未记录的功能......）。对于双屏设置，它可能不应该这样做。

解决此问题的一种选择是将其设置为“全屏”，而不是将其设置为与位置 (0,0) 的屏幕相同的大小。您可以从[GraphicsDevice 上的 GraphicsConfigurations](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/GraphicsDevice.html#getConfigurations%28%29)获取屏幕信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-11T09:53:13.320

以下代码有效（谢谢约翰）。没有全屏和一个大的“始终在顶部”窗口。但我仍然不知道为什么 windows 会导致这种奇怪的行为......

```
private Window initFullScreenWindow() {
    GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
    GraphicsDevice[] gds = ge.getScreenDevices();
    GraphicsDevice gd = gds[1];
    JWindow window = new JWindow(gd.getDefaultConfiguration());
    window.setContentPane(getJFSPanel());
    window.setLocation(1280, 0);
    window.setSize(gd.getDisplayMode().getWidth(), gd.getDisplayMode().getHeight());
    window.setAlwaysOnTop(true);
    //gd.setFullScreenWindow(window);
    return window;
} 
```

# c# - 如何在 .NET SslStream 中为客户端身份验证指定接受的证书

> ID：53824
> 
> 赞同：3
> 
> 时间：2008-09-10T11:49:44.593
> 
> 标签：c#, .net, ssl, sspi

我正在尝试使用 .Net System.Security.SslStream 类来处理带有客户端身份验证的 SSL/TLS 流的服务器端。

要执行握手，我使用以下代码：

```
SslStream sslStream = new SslStream(innerStream, false, RemoteCertificateValidation, LocalCertificateSelectionCallback);
sslStream.AuthenticateAsServer(serverCertificate, true, SslProtocols.Default, false); 
```

不幸的是，这会导致 SslStream 传输一个 CertificateRequest，其中包含我的 CryptoAPI Trusted Root Store 中所有证书的主题名。

我希望能够覆盖它。我不能要求用户从受信任的根存储中安装或删除证书。

看起来 SslStream 在下面使用 SSPI/SecureChannel，所以如果有人知道如何使用该 API 进行等效操作，那也会很有帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T12:10:32.083

目前使用 .NET 库似乎无法做到这一点。

我通过使用 System.Security.SslStream 的 Mono 类库实现解决了这个问题，它可以更好地访问在握手期间覆盖服务器行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T15:07:38.097

证书验证所做的是验证链中的所有证书。为了真正做到这一点，它只需联系每个证书的根存储。

如果这不是您想要发生的事情，您可以在本地部署您自己的根存储。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T17:15:58.740

这不是我想要更改的验证部分。问题在于初始握手时，服务器发送消息，通知客户端需要客户端身份验证（即 CertificateRequest 消息）。作为该消息的一部分，服务器发送它接受作为客户端证书颁发者的 CA 的名称。该列表默认包含存储中的所有受信任的根。

但是，如果可以覆盖单个应用程序的证书根存储，那可能会解决问题。你是这个意思吗？如果是这样，我该怎么做？

# c - 检查 C 中可用的堆栈大小

> ID：53827
> 
> 赞同：44
> 
> 时间：2008-09-10T11:53:16.160
> 
> 标签：c, stack, mingw

我将 MinGW 与 GCC 3.4.5（mingw-special vista r3）一起使用。

我的 C 应用程序使用了很多堆栈，所以我想知道有什么方法可以通过编程方式告诉我还剩下多少堆栈，这样如果我发现我即将用完，我就可以干净地处理这种情况。

如果不是，您还有什么其他方法可以解决可能耗尽堆栈空间的问题？

我不知道我将从多大的堆栈开始，所以也需要以编程方式识别它。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-05-03T03:37:29.410

getrusage 函数为您提供当前使用情况。（见[`man getrusage`](http://www.kernel.org/doc/man-pages/online/pages/man2/getrusage.2.html)）。

Linux 中的`getrlimit`将有助于使用`RLIMIT_STACK`参数获取堆栈大小。

```
#include <sys/resource.h>
int main (void)
{
  struct rlimit limit;

  getrlimit (RLIMIT_STACK, &limit);
  printf ("\nStack Limit = %ld and %ld max\n", limit.rlim_cur, limit.rlim_max);
} 
```

请看一下[`man getrlimit`](http://man7.org/linux/man-pages/man2/setrlimit.2.html)。`ulimit -s`可以通过`ulimit -a`堆栈大小的行获取相同的信息。还可以查看`setrlimit`允许设置限制的功能。但是正如其他答案中提到的那样，如果您需要调整堆栈，那么您可能应该重新考虑您的设计。如果你想要一个大数组，为什么不从堆中取出内存呢？

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-10T12:02:00.633

将局部变量的地址从堆栈中取出是可行的。然后在更嵌套的调用中，您可以减去另一个本地的地址以找到它们之间的差异

```
size_t top_of_stack;

void Main()
{
  int x=0;
  top_of_stack = (size_t) &x;

  do_something_very_recursive(....)
}

size_t SizeOfStack()
{
  int x=0;
  return top_of_stack - (size_t) &x;
} 
```

如果您的代码是多线程的，那么您需要处理在每个线程的基础上存储 top_of_stack 变量。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-10T13:40:50.003

检查你的编译器是否支持 stackavail()

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-10T12:01:09.433

假设您知道完整堆栈的大小，您可能会添加一些汇编代码来读取 ESP。
如果您阅读 ESP 并将其保存在 main 函数中，您可以将当前 ESP 与您在 main 中的 ESP 进行比较，并查看 ESP 发生了多少变化。这将告诉您使用了多少堆栈。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-10T12:47:35.267

这是一个我已经放弃的问题。通过大量的黑客攻击和（大部分）祈祷，您可以获得在给定机器上在给定时间工作的解决方案。但总的来说，似乎没有像样的方法来做到这一点。

您必须从程序外部获取堆栈位置和大小（在 Linux 上，您可以从 获取它`/proc/<pid>/maps`）。在您的程序中，您必须以某种方式测试您在堆栈中的位置。使用局部变量是可能的，但不能真正保证它们实际上在堆栈上。您还可以尝试使用一些程序集从堆栈指针寄存器中获取值。

因此，现在您有了堆栈的位置、大小和当前位置，并且假设您知道堆栈的增长方向。你什么时候进入堆栈溢出模式？你最好不要接近尾声，因为你的估计（即局部变量的地址或堆栈指针的值）可能有点过于乐观了；在堆栈指针之外寻址内存并不少见。此外，您不知道任何给定函数（及其调用的函数）需要多少堆栈空间。所以最后你必须留出相当多的空间。

我只能建议你不要陷入这种混乱，并尽量避免非常深的递归。您可能还想增加筹码量；我相信在 Windows 上你必须将它编译成可执行文件。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-11T13:55:22.880

也许这仅对 Windows 平台有帮助：

在您的 exe 的 PE 标头 (IMAGE_NT_HEADERS) 中有一些记录，例如：

```
typedef 结构 _IMAGE_NT_HEADERS {
    双字签名；
    IMAGE_FILE_HEADER 文件头；
    IMAGE_OPTIONAL_HEADER32 可选标题；
} IMAGE_NT_HEADERS32，*PIMAGE_NT_HEADERS32；

typedef 结构 _IMAGE_OPTIONAL_HEADER {
    ...
    DWORD SizeOfStackReserve;
    DWORD SizeOfStackCommit;
    ...
}

```

有一种获取这些值的简单方法：使用 GetModuleHandle(NULL) 将为您提供模块的镜像库（句柄），您将在其中找到 IMAGE_DOS_HEADER 结构的地址，该结构将帮助您找到 IMAGE_NT_HEADERS 结构（imagebase+IMAGE_DOS_HEADER. e_lfanew) -> IMAGE_NT_HEADERS，在那里你会找到这些字段：**SizeOfStackReserve**和**SizeOfStackCommit**。

操作系统将为您的堆栈分配的最大空间量是 SizeOfStackReserve。

如果您考虑尝试这样做，请告诉我，我会为您提供帮助。有一种方法可以获取在某个点使用的堆栈大小。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-10T12:38:18.407

Raymond Chen ( [The Old New Thing](http://blogs.msdn.com/oldnewthing/default.aspx) ) 对这类问题有一个很好的回答：

> 如果你不得不问，你可能做错了什么。

以下是有关堆栈分配的一些 Win32 详细信息：[MSDN](http://msdn.microsoft.com/en-us/library/ms686774.aspx)。

如果您认为您可能会受到堆栈空间的限制，那么您几乎肯定会受到可用虚拟内存的限制，在这种情况下，您将需要找到不同的解决方案。

你到底想做什么？

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-01-03T17:44:37.270

对于 Windows：我在使用 Kernel32.dll 中的 VirtualQuery 函数之前已经完成了这项工作。我在 C# 中只有一个示例，但它演示了该技术：

```
public static class StackManagement
    {
        [StructLayout(LayoutKind.Sequential)]
        struct MEMORY_BASIC_INFORMATION
        {
            public UIntPtr BaseAddress;
            public UIntPtr AllocationBase;
            public uint AllocationProtect;
            public UIntPtr RegionSize;
            public uint State;
            public uint Protect;
            public uint Type;
        };

        private const long STACK_RESERVED_SPACE = 4096 * 16;

        public unsafe static bool CheckForSufficientStack(UInt64 bytes)
        {
            MEMORY_BASIC_INFORMATION stackInfo = new MEMORY_BASIC_INFORMATION();
            UIntPtr currentAddr = new UIntPtr(&stackInfo);
            VirtualQuery(currentAddr, ref stackInfo, sizeof(MEMORY_BASIC_INFORMATION));

            UInt64 stackBytesLeft = currentAddr.ToUInt64() - stackInfo.AllocationBase.ToUInt64();

            return stackBytesLeft > (bytes + STACK_RESERVED_SPACE);
        }

        [DllImport("kernel32.dll")]
        private static extern int VirtualQuery(UIntPtr lpAddress, ref MEMORY_BASIC_INFORMATION lpBuffer, int dwLength);
    } 
```

顺便说一句：这段代码也可以在 StackOverflow 上找到我在尝试修复代码中的错误时提出的另一个问题：[算术运算导致不安全 C# 中的溢出在](https://stackoverflow.com/questions/5303227/arithmetic-operation-resulted-in-an-overflow-in-unsafe-c-sharp)[此处输入链接描述](https://stackoverflow.com/questions/5303227/arithmetic-operation-resulted-in-an-overflow-in-unsafe-c-sharp)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-12T17:34:02.097

在 Linux 上，您将调用 getrusage 并检查返回的 struct rusage 的 ru_isrss 成员（整体非共享堆栈大小）。

从 MINGW 站点及其 sourceforge 站点对补丁的跟踪中，我看到在 2008 年 5 月，围绕 getrusage 进行了一些补丁，看起来它已经被普遍支持了很长一段时间。您应该仔细检查有关 MinGW 支持多少典型 Linux 功能的任何警告。

# localization - 如何在微控制器上支持多种语言？

> ID：53829
> 
> 赞同：3
> 
> 时间：2008-09-10T11:55:38.387
> 
> 标签：localization, translation, microcontroller, embedded

我目前正在为中国市场升级产品。目标是带有 QVGA 显示器的 ARMTDMI7。我在网上找到的大多数资源都是针对桌面或 Web 编程而不是嵌入式设备的。

*   谁能推荐一些可能有用的工具和资源？
*   提取文字字符串和与翻译人员交流的最佳技术是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T17:59:41.020

我建议查看 EasyGUI，但这取决于您使用的图形控制器。

EasyGUI 是一种简化用户界面设计的工具，并带有完整的源代码和驱动程序，适用于各种显示控制器。

对于本地化，您可以使用 EasyTranslate，它为翻译者提供界面的图形表示。这让翻译人员可以看到翻译后的文本如何适合屏幕。

EasyGUI 提供 unicode 支持以及从右到左的脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T12:42:20.487

听起来您需要升级现有代码库以使其支持多种语言。

如果是这样，那么它在微控制器上的事实不应该成为问题 - 我会从标题中删除它并专注于您正在使用的语言（c？）并询问如何将您的程序转换为国际化。

这是许多人已经在各种平台上解决的问题，您使用微控制器这一事实并不意味着相同的工具等不适用 - 相关因素是您使用的语言

-亚当

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-10T12:38:00.733

有许多[ARM 微控制器论坛](http://www.google.com/search?q=arm+microcontroller+forum)可以帮助您找到所需的内容。

Atmel 有一系列 ARM7 处理器，它们对那些以此为爱好的人非常友好，所以有很多关于这个处理器的信息。它不会是一样的，但通常这些工具和库可以跨 ARM 线使用，因此您可能会[在这里](http://www.at91.com/)找到一些帮助- 您将希望专注于 AT91SAM7 系列。

如果您有更具体的问题，您可能会在这里得到一些合理的答复。

-亚当

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-10T11:58:26.087

Freetype 可能适合渲染字体。

[www.freetype.org](http://www.freetype.org/)

# sql-server - XpsDocuments 可以序列化为 XML 以存储在数据库中吗？

> ID：53841
> 
> 赞同：0
> 
> 时间：2008-09-10T12:04:29.767
> 
> 标签：sql-server, xpsdocument

而且，如果不是，那么唯一的其他选择是 blob 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-10T12:27:04.050

XPS 文档是包含 XML 的 zip 文件。您可以提取 zip 文件的内容并将其存储在数据库中，但是每次数据进出数据库时都需要解压缩并重新压缩。

**编辑**：换句话说，不是以任何实际的方式。

# c# - 如何动态评估 C# 表达式？

> ID：53844
> 
> 赞同：60
> 
> 时间：2008-09-10T12:06:59.183
> 
> 标签：c#, reflection, eval

我想做相当于：

```
object result = Eval("1 + 3");
string now    = Eval("System.DateTime.Now().ToString()") as string 
```

在 Biri 的[链接](http://www.codeproject.com/KB/cs/evalcscode.aspx)之后，我得到了这个片段（修改为删除过时的方法`ICodeCompiler.CreateCompiler()`：

```
private object Eval(string sExpression)
{
    CSharpCodeProvider c = new CSharpCodeProvider();
    CompilerParameters cp = new CompilerParameters();

    cp.ReferencedAssemblies.Add("system.dll");

    cp.CompilerOptions = "/t:library";
    cp.GenerateInMemory = true;

    StringBuilder sb = new StringBuilder("");
    sb.Append("using System;\n");

    sb.Append("namespace CSCodeEvaler{ \n");
    sb.Append("public class CSCodeEvaler{ \n");
    sb.Append("public object EvalCode(){\n");
    sb.Append("return " + sExpression + "; \n");
    sb.Append("} \n");
    sb.Append("} \n");
    sb.Append("}\n");

    CompilerResults cr = c.CompileAssemblyFromSource(cp, sb.ToString());
    if (cr.Errors.Count > 0)
    {
        throw new InvalidExpressionException(
            string.Format("Error ({0}) evaluating: {1}", 
            cr.Errors[0].ErrorText, sExpression));
    }

    System.Reflection.Assembly a = cr.CompiledAssembly;
    object o = a.CreateInstance("CSCodeEvaler.CSCodeEvaler");

    Type t = o.GetType();
    MethodInfo mi = t.GetMethod("EvalCode");

    object s = mi.Invoke(o, null);
    return s;

} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2017-04-26T09:34:20.663

老话题，但考虑到这是谷歌搜索时出现的第一个线程，这里有一个更新的解决方案。

您可以使用[Roslyn 的新脚本 API 来评估表达式](https://github.com/dotnet/roslyn/wiki/Scripting-API-Samples)。

如果您使用的是 NuGet，只需将依赖项添加到[Microsoft.CodeAnalysis.CSharp.Scripting](https://www.nuget.org/packages/Microsoft.CodeAnalysis.CSharp.Scripting/)即可。要评估您提供的示例，它很简单：

```
var result = CSharpScript.EvaluateAsync("1 + 3").Result; 
```

这显然没有利用脚本引擎的异步功能。

您还可以按预期指定评估结果类型：

```
var now = CSharpScript.EvaluateAsync<string>("System.DateTime.Now.ToString()").Result; 
```

要评估更高级的代码片段、传递参数、提供引用、命名空间等等，请查看上面链接的 wiki。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-02-07T21:46:30.660

I have written an open source project, [Dynamic Expresso](https://github.com/davideicardi/DynamicExpresso/), that can convert text expression written using a C# syntax into delegates (or expression tree). Text expressions are parsed and transformed into [Expression Trees](http://msdn.microsoft.com/en-us/library/bb397951.aspx) without using compilation or reflection.

You can write something like:

```
var interpreter = new Interpreter();
var result = interpreter.Eval("8 / 2 + 2"); 
```

or

```
var interpreter = new Interpreter()
                .SetVariable("service", new ServiceExample());

string expression = "x > 4 ? service.aMethod() : service.AnotherMethod()";

Lambda parsedExpression = interpreter.Parse(expression, 
                        new Parameter("x", typeof(int)));

parsedExpression.Invoke(5); 
```

My work is based on Scott Gu article [http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx) .

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2018-10-07T05:47:40.400

如果您特别想在自己的项目中调用代码和程序集，我建议您使用[C# CodeDom CodeProvider](https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.codedomprovider?view=netframework-4.7.2)。

以下是我所知道的用于在 C# 中动态评估字符串表达式的最流行方法的列表。

## 微软解决方案

*   [C# CodeDom 代码提供者](https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.codedomprovider?view=netframework-4.7.2)：
    *   请参阅[如何使用 LINQ](https://stackoverflow.com/questions/5766373/how-does-linqpad-compile-code)和此[CodeProject 文章](https://www.codeproject.com/Articles/11939/Evaluate-C-Code-Eval-Function)
*   [罗斯林](https://github.com/dotnet/roslyn)：
    *   请参阅[这篇关于 Rosly Emit API 的文章](https://joshvarty.com/2016/01/16/learn-roslyn-now-part-16-the-emit-api)和这个[StackOverflow 答案](https://stackoverflow.com/a/43630318/184528)
*   [数据表](http://msdn.microsoft.com/en-us/library/system.data.datatable.compute.aspx).计算：
    *   在 StackOverflow 上查看这个[答案](https://stackoverflow.com/a/12431343/184528)
*   [Webbrowser.Document.InvokeScript](https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.htmldocument.invokescript?view=netframework-4.7.2)
    *   看到这个[StackOverflow 问题](https://stackoverflow.com/questions/7322420/calling-javascript-object-method-using-webbrowser-document-invokescript)
*   [数据绑定器.Eval](https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.databinder.eval?redirectedfrom=MSDN&view=netframework-4.7.2#overloads)
*   [脚本控件](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-6.0/aa227400(v=vs.60))
    *   在 StackOverflow 上查看[这个答案](https://stackoverflow.com/questions/12431286/calculate-result-from-a-string-expression-dynamically/12431435#12431435)和[这个问题](https://stackoverflow.com/questions/16075775/calling-the-javascript-functions-inside-c-sharp-for-a-64-bit-project?noredirect=1&lq=1)
*   执行 PowerShell：
    *   请参阅[此 CodeProject 文章](https://www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C)

## 非微软解决方案（并不是说有什么问题）

*   表达式评估库：
    *   [逃跑](https://github.com/mparlak/Flee)
    *   [动态快车](https://github.com/davideicardi/DynamicExpresso/)
    *   [计算](https://archive.codeplex.com/?p=ncalc)
    *   [CodingSeb.ExpressionEvaluator](https://github.com/codingseb/ExpressionEvaluator)
    *   [评估表达式.NET](https://github.com/zzzprojects/Eval-Expression.NET)
*   Javascript 解释器
    *   [金特](https://github.com/sebastienros/jint)
*   执行真正的 C#
    *   [CS脚本](https://github.com/oleg-shilo/cs-script)
*   推出自己的语言构建工具包，例如：
    *   [讽刺](https://archive.codeplex.com/?p=irony)
    *   [拼图](https://www.codeproject.com/Articles/272494/Implementing-Programming-Languages-using-Csharp)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-29T08:27:45.400

```
using System;
using Microsoft.JScript;
using Microsoft.JScript.Vsa;
using Convert = Microsoft.JScript.Convert;

namespace System
{
    public class MathEvaluator : INeedEngine
    {
        private VsaEngine vsaEngine;

        public virtual String Evaluate(string expr)
        {
            var engine = (INeedEngine)this;
            var result = Eval.JScriptEvaluate(expr, engine.GetEngine());

            return Convert.ToString(result, true);
        }

        VsaEngine INeedEngine.GetEngine()
        {
            vsaEngine = vsaEngine ?? VsaEngine.CreateEngineWithType(this.GetType().TypeHandle);
            return vsaEngine;
        }

        void INeedEngine.SetEngine(VsaEngine engine)
        {
            vsaEngine = engine;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-10T15:12:42.170

> 这样做对性能有何影响？

我们使用基于上述内容的系统，其中每个 C# 脚本都编译为内存中的程序集并在单独的 AppDomain 中执行。目前还没有缓存系统，所以脚本每次运行时都会重新编译。我做了一些简单的测试，一个非常简单的“Hello World”脚本在我的机器上编译大约需要 0.7 秒，包括从磁盘加载脚本。0.7 秒对于脚本系统来说很好，但对于响应用户输入来说可能太慢了，在这种情况下，像 Flee 这样的专用解析器/编译器可能会更好。

```
using System;
public class Test
{
    static public void DoStuff( Scripting.IJob Job)
    {
        Console.WriteLine( "Heps" );
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-13T03:34:49.180

看起来还有一种方法可以使用 RegEx 和 XPathNavigator 来评估表达式。我还没有机会测试它，但我有点喜欢它，因为它不需要在运行时编译代码或使用无法使用的库。

[http://www.webtips.co.in/c/evaluate-function-in-c-net-as-eval-function-in-javascript.aspx](http://www.webtips.co.in/c/evaluate-function-in-c-net-as-eval-function-in-javascript.aspx)

我会尝试一下，稍后告诉它是否有效。我也打算在 Silverlight 中尝试它，但为时已晚，我现在几乎睡着了，无法进行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-10T02:43:50.537

虽然 C# 本身不支持 Eval 方法，但我有一个 C# eval 程序，它允许评估 C# 代码。它提供了在运行时评估 C# 代码并支持许多 C# 语句。事实上，此代码可用于任何 .NET 项目，但仅限于使用 C# 语法。查看我的网站[http://csharp-eval.com](http://csharp-eval.com)了解更多详细信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-27T03:15:31.227

这里有一段很好的代码 [https://www.c-sharpcorner.com/article/codedom-calculator-evaluation-c-sharp-math-expressions-dynamica/](https://www.c-sharpcorner.com/article/codedom-calculator-evaluating-c-sharp-math-expressions-dynamica/)

下载它并使其成为一个可以在您的项目中引用的类库。这似乎非常快速和简单

也许这会有所帮助！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-13T06:39:50.783

我刚刚用纯 C# 编写了一个类似的库（[Matheval](https://github.com/matheval/expression-evaluator-c-sharp)）。它允许评估字符串和数字表达式，如 excel 公式。

```
using System;
using org.matheval;

public class Program
{
    public static void Main()
    {
        Expression expression = new Expression("IF(time>8, (HOUR_SALARY*8) + (HOUR_SALARY*1.25*(time-8)), HOUR_SALARY*time)");
        //bind variable
        expression.Bind("HOUR_SALARY", 10);
        expression.Bind("time", 9);
        //eval
        Decimal salary = expression.Eval<Decimal>();    
        Console.WriteLine(salary);
    }
} 
```

# java - 生成 .exe 文件的 Java 编译器选项

> ID：53845
> 
> 赞同：7
> 
> 时间：2008-09-10T12:09:26.650
> 
> 标签：java, windows, compiler-construction, gnu

我应该使用什么编译器（我正在使用 gcj 4.x）选项来为我的 java 应用程序生成一个“exe”文件以在 Windows 中运行？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-10T12:13:06.767

要编译 Java 程序 MyJavaProg.java，请输入：

```
gcj -c -g -O MyJavaProg.java 
```

要链接它，请使用以下命令：

```
gcj --main=MyJavaProg -o MyJavaProg MyJavaProg.o 
```

然后链接以创建可执行的 mycxxprog.exe

```
g++ -o mycxxprog.exe mycxxprog.o 
```

# c++ - 如何在 C++ 中标记字符串？

> ID：53849
> 
> 赞同：457
> 
> 时间：2008-09-10T12:10:25.527
> 
> 标签：c++, string, split, tokenize

Java有一个方便的拆分方法：

```
String str = "The quick brown fox";
String[] results = str.split(" "); 
```

有没有一种简单的方法可以在 C++ 中做到这一点？

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2008-09-11T02:10:33.463

[Boost tokenizer](http://www.boost.org/doc/libs/1_36_0/libs/tokenizer/index.html)类可以使这种事情变得非常简单：

```
#include <iostream>
#include <string>
#include <boost/foreach.hpp>
#include <boost/tokenizer.hpp>

using namespace std;
using namespace boost;

int main(int, char**)
{
    string text = "token, test   string";

    char_separator<char> sep(", ");
    tokenizer< char_separator<char> > tokens(text, sep);
    BOOST_FOREACH (const string& t, tokens) {
        cout << t << "." << endl;
    }
} 
```

针对 C++11 更新：

```
#include <iostream>
#include <string>
#include <boost/tokenizer.hpp>

using namespace std;
using namespace boost;

int main(int, char**)
{
    string text = "token, test   string";

    char_separator<char> sep(", ");
    tokenizer<char_separator<char>> tokens(text, sep);
    for (const auto& t : tokens) {
        cout << t << "." << endl;
    }
} 
```

* * *

## 回答 #2

> 赞同：178
> 
> 时间：2008-09-10T12:30:06.680

这是一个非常简单的：

```
#include <vector>
#include <string>
using namespace std;

vector<string> split(const char *str, char c = ' ')
{
    vector<string> result;

    do
    {
        const char *begin = str;

        while(*str != c && *str)
            str++;

        result.push_back(string(begin, str));
    } while (0 != *str++);

    return result;
} 
```

* * *

## 回答 #3

> 赞同：166
> 
> 时间：2008-09-10T12:18:25.383

C++ 标准库算法非常普遍地基于迭代器而不是具体容器。不幸的是，这使得在 C++ 标准库中提供类似 Java 的`split`函数变得很困难，尽管没有人认为这会很方便。但它的返回类型是什么？`std::vector<std::basic_string<…&gt;>`? 也许吧，但随后我们被迫执行（可能是冗余且成本高昂的）分配。

相反，C++ 提供了多种基于任意复杂分隔符来拆分字符串的方法，但它们都没有像其他语言那样被封装得那么好。无数种方式[填满了整个博客文章](https://www.fluentcpp.com/2017/04/21/how-to-split-a-string-in-c/)。

在最简单的情况下，您可以迭代 using[`std::string::find`](http://en.cppreference.com/w/cpp/string/basic_string/find)直到您点击`std::string::npos`，然后使用 提取内容[`std::string::substr`](https://en.cppreference.com/w/cpp/string/basic_string/substr)。

在空格上拆分的更流畅（和惯用但基本）的版本将使用[`std::istringstream`](https://en.cppreference.com/w/cpp/io/basic_istringstream)：

```
auto iss = std::istringstream{"The quick brown fox"};
auto str = std::string{};

while (iss >> str) {
    process(str);
} 
```

使用[`std::istream_iterator`s](https://en.cppreference.com/w/cpp/iterator/istream_iterator)，字符串流的内容也可以使用其迭代器范围构造函数复制到向量中。

多个库（例如[Boost.Tokenizer](https://www.boost.org/doc/libs/1_70_0/libs/tokenizer/doc/tokenizer.htm)）提供特定的标记器。

更高级的拆分需要正则表达式。C++[`std::regex_token_iterator`](https://en.cppreference.com/w/cpp/regex/regex_token_iterator)特别为此目的提供了：

```
auto const str = "The quick brown fox"s;
auto const re = std::regex{R"(\s+)"};
auto const vec = std::vector<std::string>(
    std::sregex_token_iterator{begin(str), end(str), re, -1},
    std::sregex_token_iterator{}
); 
```

* * *

## 回答 #4

> 赞同：136
> 
> 时间：2008-11-28T04:17:39.937

另一种快速的方法是使用`getline`. 就像是：

```
stringstream ss("bla bla");
string s;

while (getline(ss, s, ' ')) {
 cout << s << endl;
} 
```

如果需要，您可以创建一个`split()`返回 a 的简单方法`vector<string>`，这非常有用。

* * *

## 回答 #5

> 赞同：117
> 
> 时间：2008-09-10T13:37:33.507

使用 strtok。在我看来，除非 strtok 没有为您提供所需的东西，否则没有必要围绕标记化构建一个类。可能不会，但在用 C 和 C++ 编写各种解析代码的 15 年多的时间里，我一直使用 strtok。这是一个例子

```
char myString[] = "The quick brown fox";
char *p = strtok(myString, " ");
while (p) {
    printf ("Token: %s\n", p);
    p = strtok(NULL, " ");
} 
```

一些警告（可能不适合您的需求）。该字符串在此过程中被“销毁”，这意味着 EOS 字符被内嵌在分隔符点中。正确使用可能需要您制作字符串的非常量版本。您还可以在解析中更改分隔符列表。

在我自己看来，上面的代码比为它编写一个单独的类要简单得多，也更容易使用。对我来说，这是该语言提供的功能之一，它做得很好而且干净。它只是一个“基于 C”的解决方案。很合适，很简单，而且你不用写很多额外的代码:-)

* * *

## 回答 #6

> 赞同：85
> 
> 时间：2008-09-10T12:46:14.193

您可以使用流、迭代器和复制算法相当直接地执行此操作。

```
#include <string>
#include <vector>
#include <iostream>
#include <istream>
#include <ostream>
#include <iterator>
#include <sstream>
#include <algorithm>

int main()
{
  std::string str = "The quick brown fox";

  // construct a stream from the string
  std::stringstream strstr(str);

  // use stream iterators to copy the stream to the vector as whitespace separated strings
  std::istream_iterator<std::string> it(strstr);
  std::istream_iterator<std::string> end;
  std::vector<std::string> results(it, end);

  // send the vector to stdout.
  std::ostream_iterator<std::string> oit(std::cout);
  std::copy(results.begin(), results.end(), oit);
} 
```

* * *

## 回答 #7

> 赞同：69
> 
> 时间：2014-12-14T10:46:47.460

使用`regex_token_iterator`s 的解决方案：

```
#include <iostream>
#include <regex>
#include <string>

using namespace std;

int main()
{
    string str("The quick brown fox");

    regex reg("\\s+");

    sregex_token_iterator iter(str.begin(), str.end(), reg, -1);
    sregex_token_iterator end;

    vector<string> vec(iter, end);

    for (auto a : vec)
    {
        cout << a << endl;
    }
} 
```

* * *

## 回答 #8

> 赞同：49
> 
> 时间：2008-11-28T02:55:51.117

没有冒犯，但是对于这样一个简单的问题，你把事情***弄得***太复杂了。[使用Boost](http://en.wikipedia.org/wiki/Boost_C%2B%2B_Libraries)的原因有很多。但是对于这么简单的事情，就像用20#的雪橇打苍蝇一样。

```
void
split( vector<string> & theStringVector,  /* Altered/returned value */
       const  string  & theString,
       const  string  & theDelimiter)
{
    UASSERT( theDelimiter.size(), >, 0); // My own ASSERT macro.

    size_t  start = 0, end = 0;

    while ( end != string::npos)
    {
        end = theString.find( theDelimiter, start);

        // If at end, use length=maxLength.  Else use length=end-start.
        theStringVector.push_back( theString.substr( start,
                       (end == string::npos) ? string::npos : end - start));

        // If at end, use start=maxSize.  Else use start=end+delimiter.
        start = (   ( end > (string::npos - theDelimiter.size()) )
                  ?  string::npos  :  end + theDelimiter.size());
    }
} 
```

例如（对于 Doug 的情况），

```
#define SHOW(I,X)   cout << "[" << (I) << "]\t " # X " = \"" << (X) << "\"" << endl

int
main()
{
    vector<string> v;

    split( v, "A:PEP:909:Inventory Item", ":" );

    for (unsigned int i = 0;  i < v.size();   i++)
        SHOW( i, v[i] );
} 
```

是的，我们可以让 split() 返回一个新向量而不是传入一个向量。包装和重载很简单。但取决于我在做什么，我经常发现重用预先存在的对象比总是创建新对象更好。（只要我不忘记清空中间的向量！）

参考：[http](http://en.cppreference.com/w/cpp/string/basic_string) ://www.cplusplus.com/reference/string/string/ 。

（我最初是在写对 Doug 的问题的回复：[C++ Strings Modifying and Extracting based on Separators (closed)](https://stackoverflow.com/questions/324867/c-strings-modifying-and-extracting-based-on-separators)。但由于 Martin York 在这里用指针结束了这个问题......我将概括我的代码。）

* * *

## 回答 #9

> 赞同：38
> 
> 时间：2008-09-12T17:20:23.253

[Boost](http://en.wikipedia.org/wiki/Boost_C%2B%2B_Libraries)具有强大的拆分功能：[boost::algorithm::split](http://www.boost.org/doc/libs/1_36_0/doc/html/boost/algorithm/split_id2965593.html)。

示例程序：

```
#include <vector>
#include <boost/algorithm/string.hpp>

int main() {
    auto s = "a,b, c ,,e,f,";
    std::vector<std::string> fields;
    boost::split(fields, s, boost::is_any_of(","));
    for (const auto& field : fields)
        std::cout << "\"" << field << "\"\n";
    return 0;
} 
```

输出：

```
"a"
"b"
" c "
""
"e"
"f"
"" 
```

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2010-08-04T17:34:03.780

我知道您要求提供 C++ 解决方案，但您可能会认为这很有帮助：

**Qt**

```
#include <QString>

...

QString str = "The quick brown fox"; 
QStringList results = str.split(" "); 
```

在此示例中，与 Boost 相比的优势在于它直接一对一映射到您的帖子代码。

[在Qt 文档](https://doc.qt.io/qt-5/qstring.html#split)中查看更多信息

* * *

## 回答 #11

> 赞同：25
> 
> 时间：2015-02-28T23:18:05.150

这是一个简单的仅限 STL 的解决方案（约 5 行！），它使用`std::find`和`std::find_first_not_of`处理分隔符的重复（例如空格或句点），以及前导和尾随分隔符：

```
#include <string>
#include <vector>

void tokenize(std::string str, std::vector<string> &token_v){
    size_t start = str.find_first_not_of(DELIMITER), end=start;

    while (start != std::string::npos){
        // Find next occurence of delimiter
        end = str.find(DELIMITER, start);
        // Push back the token found into vector
        token_v.push_back(str.substr(start, end-start));
        // Skip all occurences of the delimiter to find new start
        start = str.find_first_not_of(DELIMITER, end);
    }
} 
```

[*现场*](http://coliru.stacked-crooked.com/a/652f29c0500cf195)试用！

* * *

## 回答 #12

> 赞同：23
> 
> 时间：2008-09-10T12:18:14.493

这是一个示例标记器类，它可能会执行您想要的操作

```
//Header file
class Tokenizer 
{
    public:
        static const std::string DELIMITERS;
        Tokenizer(const std::string& str);
        Tokenizer(const std::string& str, const std::string& delimiters);
        bool NextToken();
        bool NextToken(const std::string& delimiters);
        const std::string GetToken() const;
        void Reset();
    protected:
        size_t m_offset;
        const std::string m_string;
        std::string m_token;
        std::string m_delimiters;
};

//CPP file
const std::string Tokenizer::DELIMITERS(" \t\n\r");

Tokenizer::Tokenizer(const std::string& s) :
    m_string(s), 
    m_offset(0), 
    m_delimiters(DELIMITERS) {}

Tokenizer::Tokenizer(const std::string& s, const std::string& delimiters) :
    m_string(s), 
    m_offset(0), 
    m_delimiters(delimiters) {}

bool Tokenizer::NextToken() 
{
    return NextToken(m_delimiters);
}

bool Tokenizer::NextToken(const std::string& delimiters) 
{
    size_t i = m_string.find_first_not_of(delimiters, m_offset);
    if (std::string::npos == i) 
    {
        m_offset = m_string.length();
        return false;
    }

    size_t j = m_string.find_first_of(delimiters, i);
    if (std::string::npos == j) 
    {
        m_token = m_string.substr(i);
        m_offset = m_string.length();
        return true;
    }

    m_token = m_string.substr(i, j - i);
    m_offset = j;
    return true;
} 
```

例子：

```
std::vector <std::string> v;
Tokenizer s("split this string", " ");
while (s.NextToken())
{
    v.push_back(s.GetToken());
} 
```

* * *

## 回答 #13

> 赞同：16
> 
> 时间：2011-12-29T15:17:58.177

[pystring](https://github.com/imageworks/pystring)是一个小型库，它实现了一堆 Python 的字符串函数，包括 split 方法：

```
#include <string>
#include <vector>
#include "pystring.h"

std::vector<std::string> chunks;
pystring::split("this string", chunks);

// also can specify a separator
pystring::split("this-string", chunks, "-"); 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2014-01-07T20:33:06.897

我为类似的问题发布了这个答案。
不要重新发明轮子。我使用了许多库，我遇到的最快和最灵活的是： [C++ String Toolkit Library](http://www.partow.net/programming/strtk/)。

这是我在stackoverflow上发布的其他地方的如何使用它的示例。

```
#include <iostream>
#include <vector>
#include <string>
#include <strtk.hpp>

const char *whitespace  = " \t\r\n\f";
const char *whitespace_and_punctuation  = " \t\r\n\f;,=";

int main()
{
    {   // normal parsing of a string into a vector of strings
       std::string s("Somewhere down the road");
       std::vector<std::string> result;
       if( strtk::parse( s, whitespace, result ) )
       {
           for(size_t i = 0; i < result.size(); ++i )
            std::cout << result[i] << std::endl;
       }
    }

    {  // parsing a string into a vector of floats with other separators
       // besides spaces

       std::string s("3.0, 3.14; 4.0");
       std::vector<float> values;
       if( strtk::parse( s, whitespace_and_punctuation, values ) )
       {
           for(size_t i = 0; i < values.size(); ++i )
            std::cout << values[i] << std::endl;
       }
    }

    {  // parsing a string into specific variables

       std::string s("angle = 45; radius = 9.9");
       std::string w1, w2;
       float v1, v2;
       if( strtk::parse( s, whitespace_and_punctuation, w1, v1, w2, v2) )
       {
           std::cout << "word " << w1 << ", value " << v1 << std::endl;
           std::cout << "word " << w2 << ", value " << v2 << std::endl;
       }
    }

    return 0;
} 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2016-07-26T16:51:20.057

[Adam Pierce 的回答](https://stackoverflow.com/a/53878/2642059)提供了一个手工旋转的分词器，采用`const char*`. 使用迭代器会有更多问题，因为[递增 a`string`的结束迭代器是 undefined](https://stackoverflow.com/q/37209725/2642059)。也就是说，鉴于`string str{ "The quick brown fox" }`我们当然可以做到这一点：

```
auto start = find(cbegin(str), cend(str), ' ');
vector<string> tokens{ string(cbegin(str), start) };

while (start != cend(str)) {
    const auto finish = find(++start, cend(str), ' ');

    tokens.push_back(string(start, finish));
    start = finish;
} 
```

[`Live Example`](http://ideone.com/8bGCbg)

* * *

如果您希望通过使用标准功能来抽象复杂性，正如[On Freund 建议](https://stackoverflow.com/a/53867/2642059) [`strtok`](http://en.cppreference.com/w/cpp/string/byte/strtok)的那样，这是一个简单的选择：

```
vector<string> tokens;

for (auto i = strtok(data(str), " "); i != nullptr; i = strtok(nullptr, " ")) tokens.push_back(i); 
```

如果您无权访问 C++17，则需要`data(str)`按照此示例进行替换：http: [//ideone.com/8kAGoa](http://ideone.com/8kAGoa)

尽管示例中没有演示，但`strtok`不必为每个标记使用相同的分隔符。除了这个优点，还有几个缺点：

1.  `strtok`不能同时用于多个`strings`：要么`nullptr`必须传递 a 以继续标记当前，要么必须传递`string`new`char*`来标记化（但是有一些非标准实现确实支持这一点，例如[`strtok_s`](https://msdn.microsoft.com/en-us/library/ftsafwz3.aspx)：）
2.  出于同样的原因`strtok`，不能同时在多个线程上使用（但这可能是实现定义的，例如：[Visual Studio 的实现是线程安全的](https://msdn.microsoft.com/en-us/library/2c8d19sb.aspx#Anchor_3)）
3.  调用`strtok`会修改`string`它正在操作的对象，因此它不能用于`const string`s、`const char*`s 或文字字符串，以对其中的任何一个进行标记`strtok`或对`string`需要保留的内容进行操作，`str`必须复制，然后复制可以被操作

* * *

[c++20](/questions/tagged/c%2b%2b20 "显示标记为“c++20”的问题")为我们提供了`split_view`以非破坏性方式标记字符串：[https ://topanswers.xyz/cplusplus?q=749#a874](https://topanswers.xyz/cplusplus?q=749#a874)

* * *

以前的方法不能`vector`就地生成标记化，这意味着没有将它们抽象为它们无法初始化的辅助函数`const vector<string> tokens`。可以*使用*. *_* _ _ 例如给出：我们可以这样做：*[`istream_iterator`](http://en.cppreference.com/w/cpp/iterator/istream_iterator)`const string str{ "The quick \tbrown \nfox" }`*

 *```
istringstream is{ str };
const vector<string> tokens{ istream_iterator<string>(is), istream_iterator<string>() }; 
```

[`Live Example`](http://ideone.com/gWmfV9)

此选项所需的构造`istringstream`成本远高于前两个选项，但是此成本通常隐藏在`string`分配费用中。

* * *

如果上述选项都不能灵活地满足您的代币化需求，那么最灵活的选项是使用 a[`regex_token_iterator`](http://en.cppreference.com/w/cpp/regex/regex_token_iterator)当然，这种灵活性会带来更大的费用，但这很可能隐藏在`string`分配成本中。例如，假设我们想要基于非转义逗号进行标记，同时也吃空格，给定以下输入：`const string str{ "The ,qu\\,ick ,\tbrown, fox" }`我们可以这样做：

```
const regex re{ "\\s*((?:[^\\\\,]|\\\\.)*?)\\s*(?:,|$)" };
const vector<string> tokens{ sregex_token_iterator(cbegin(str), cend(str), re, 1), sregex_token_iterator() }; 
```

[`Live Example`](http://ideone.com/q58zoX)

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2010-12-20T12:25:35.623

检查这个例子。它可能会帮助你..

```
#include <iostream>
#include <sstream>

using namespace std;

int main ()
{
    string tmps;
    istringstream is ("the dellimiter is the space");
    while (is.good ()) {
        is >> tmps;
        cout << tmps << "\n";
    }
    return 0;
} 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2009-03-22T02:28:16.377

MFC/ATL 有一个非常好的分词器。来自 MSDN：

```
CAtlString str( "%First Second#Third" );
CAtlString resToken;
int curPos= 0;

resToken= str.Tokenize("% #",curPos);
while (resToken != "")
{
   printf("Resulting token: %s\n", resToken);
   resToken= str.Tokenize("% #",curPos);
};

Output

Resulting Token: First
Resulting Token: Second
Resulting Token: Third 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-09-10T12:23:33.903

如果你愿意使用 C，你可以使用[strtok](http://www.cplusplus.com/reference/clibrary/cstring/strtok.html)函数。使用时要注意多线程问题。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2008-09-15T15:28:39.003

对于简单的东西，我只使用以下内容：

```
unsigned TokenizeString(const std::string& i_source,
                        const std::string& i_seperators,
                        bool i_discard_empty_tokens,
                        std::vector<std::string>& o_tokens)
{
    unsigned prev_pos = 0;
    unsigned pos = 0;
    unsigned number_of_tokens = 0;
    o_tokens.clear();
    pos = i_source.find_first_of(i_seperators, pos);
    while (pos != std::string::npos)
    {
        std::string token = i_source.substr(prev_pos, pos - prev_pos);
        if (!i_discard_empty_tokens || token != "")
        {
            o_tokens.push_back(i_source.substr(prev_pos, pos - prev_pos));
            number_of_tokens++;
        }

        pos++;
        prev_pos = pos;
        pos = i_source.find_first_of(i_seperators, pos);
    }

    if (prev_pos < i_source.length())
    {
        o_tokens.push_back(i_source.substr(prev_pos));
        number_of_tokens++;
    }

    return number_of_tokens;
} 
```

懦弱的免责声明：我编写实时数据处理软件，其中数据通过二进制文件、套接字或一些 API 调用（I/O 卡、相机）进入。我从不将此功能用于比在启动时读取外部配置文件更复杂或时间紧迫的事情。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2011-04-22T00:14:36.273

您可以简单地使用[正则表达式库](http://www.tropicsoft.com/Components/RegularExpression/)并使用正则表达式解决该问题。

使用表达式 (\w+) 和 \1 中的变量（或 $1，具体取决于正则表达式的库实现）。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2012-08-01T05:50:39.210

这里有许多过于复杂的建议。试试这个简单的 std::string 解决方案：

```
using namespace std;

string someText = ...

string::size_type tokenOff = 0, sepOff = tokenOff;
while (sepOff != string::npos)
{
    sepOff = someText.find(' ', sepOff);
    string::size_type tokenLen = (sepOff == string::npos) ? sepOff : sepOff++ - tokenOff;
    string token = someText.substr(tokenOff, tokenLen);
    if (!token.empty())
        /* do something with token */;
    tokenOff = sepOff;
} 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2020-08-15T22:49:29.740

如果您使用的是 C++ 范围 - 完整的[范围-v3](https://github.com/ericniebler/range-v3/)库，而不是 C++20 接受的有限功能 - 您可以这样做：

```
auto results = str | ranges::views::tokenize(" ",1); 
```

...这是懒惰的评估。您也可以将向量设置为此范围：

```
auto results = str | ranges::views::tokenize(" ",1) | ranges::to<std::vector>(); 
```

如果`str`有 n 个字符组成 m 个单词，这将花费 O(m) 空间和 O(n) 时间。

[另请参阅此处](https://github.com/ericniebler/range-v3/blob/5b492996048d1baad98b50ec074e783eb6086627/test/view/tokenize.cpp)的库自己的标记化示例。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-09-10T12:43:56.740

我认为这就是`>>`字符串流上的运算符的用途：

```
string word; sin >> word; 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2012-10-26T15:14:10.370

这是一种允许您控制是否包含空标记（如 strsep）或排除（如 strtok）的方法。

```
#include <string.h> // for strchr and strlen

/*
 * want_empty_tokens==true  : include empty tokens, like strsep()
 * want_empty_tokens==false : exclude empty tokens, like strtok()
 */
std::vector<std::string> tokenize(const char* src,
                                  char delim,
                                  bool want_empty_tokens)
{
  std::vector<std::string> tokens;

  if (src and *src != '\0') // defensive
    while( true )  {
      const char* d = strchr(src, delim);
      size_t len = (d)? d-src : strlen(src);

      if (len or want_empty_tokens)
        tokens.push_back( std::string(src, len) ); // capture token

      if (d) src += len+1; else break;
    }

  return tokens;
} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2014-07-26T13:15:20.273

对我来说似乎很奇怪，对于我们所有有速度意识的书呆子来说，没有人提出使用编译时生成的查找表作为分隔符的版本（示例实现进一步向下）。使用查找表和迭代器应该在效率上击败 std::regex，如果您不需要击败正则表达式，只需使用它，它是 C++11 的标准并且超级灵活。

有些人已经建议使用正则表达式，但对于新手来说，这里是一个打包的示例，应该完全符合 OP 的期望：

```
std::vector<std::string> split(std::string::const_iterator it, std::string::const_iterator end, std::regex e = std::regex{"\\w+"}){
    std::smatch m{};
    std::vector<std::string> ret{};
    while (std::regex_search (it,end,m,e)) {
        ret.emplace_back(m.str());              
        std::advance(it, m.position() + m.length()); //next start position = match position + match length
    }
    return ret;
}
std::vector<std::string> split(const std::string &s, std::regex e = std::regex{"\\w+"}){  //comfort version calls flexible version
    return split(s.cbegin(), s.cend(), std::move(e));
}
int main ()
{
    std::string str {"Some people, excluding those present, have been compile time constants - since puberty."};
    auto v = split(str);
    for(const auto&s:v){
        std::cout << s << std::endl;
    }
    std::cout << "crazy version:" << std::endl;
    v = split(str, std::regex{"[^e]+"});  //using e as delim shows flexibility
    for(const auto&s:v){
        std::cout << s << std::endl;
    }
    return 0;
} 
```

如果我们需要更快并接受所有字符必须为 8 位的约束，我们可以在编译时使用元编程创建一个查找表：

```
template<bool...> struct BoolSequence{};        //just here to hold bools
template<char...> struct CharSequence{};        //just here to hold chars
template<typename T, char C> struct Contains;   //generic
template<char First, char... Cs, char Match>    //not first specialization
struct Contains<CharSequence<First, Cs...>,Match> :
    Contains<CharSequence<Cs...>, Match>{};     //strip first and increase index
template<char First, char... Cs>                //is first specialization
struct Contains<CharSequence<First, Cs...>,First>: std::true_type {}; 
template<char Match>                            //not found specialization
struct Contains<CharSequence<>,Match>: std::false_type{};

template<int I, typename T, typename U> 
struct MakeSequence;                            //generic
template<int I, bool... Bs, typename U> 
struct MakeSequence<I,BoolSequence<Bs...>, U>:  //not last
    MakeSequence<I-1, BoolSequence<Contains<U,I-1>::value,Bs...>, U>{};
template<bool... Bs, typename U> 
struct MakeSequence<0,BoolSequence<Bs...>,U>{   //last  
    using Type = BoolSequence<Bs...>;
};
template<typename T> struct BoolASCIITable;
template<bool... Bs> struct BoolASCIITable<BoolSequence<Bs...>>{
    /* could be made constexpr but not yet supported by MSVC */
    static bool isDelim(const char c){
        static const bool table[256] = {Bs...};
        return table[static_cast<int>(c)];
    }   
};
using Delims = CharSequence<'.',',',' ',':','\n'>;  //list your custom delimiters here
using Table = BoolASCIITable<typename MakeSequence<256,BoolSequence<>,Delims>::Type>; 
```

有了它，就很容易制作一个`getNextToken`函数：

```
template<typename T_It>
std::pair<T_It,T_It> getNextToken(T_It begin,T_It end){
    begin = std::find_if(begin,end,std::not1(Table{})); //find first non delim or end
    auto second = std::find_if(begin,end,Table{});      //find first delim or end
    return std::make_pair(begin,second);
} 
```

使用它也很容易：

```
int main() {
    std::string s{"Some people, excluding those present, have been compile time constants - since puberty."};
    auto it = std::begin(s);
    auto end = std::end(s);
    while(it != std::end(s)){
        auto token = getNextToken(it,end);
        std::cout << std::string(token.first,token.second) << std::endl;
        it = token.second;
    }
    return 0;
} 
```

这是一个活生生的例子：http: [//ideone.com/GKtkLQ](http://ideone.com/GKtkLQ)

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2018-05-09T07:12:21.163

我知道这个问题已经得到解答，但我想做出贡献。也许我的解决方案有点简单，但这就是我想出的：

```
vector<string> get_words(string const& text, string const& separator)
{
    vector<string> result;
    string tmp = text;

    size_t first_pos = 0;
    size_t second_pos = tmp.find(separator);

    while (second_pos != string::npos)
    {
        if (first_pos != second_pos)
        {
            string word = tmp.substr(first_pos, second_pos - first_pos);
            result.push_back(word);
        }
        tmp = tmp.substr(second_pos + separator.length());
        second_pos = tmp.find(separator);
    }

    result.push_back(tmp);

    return result;
} 
```

请评论我的代码中是否有更好的方法或有问题。

**更新：**添加了通用分隔符

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2011-08-03T06:58:13.573

您可以利用 boost::make_find_iterator。与此类似的东西：

```
template<typename CH>
inline vector< basic_string<CH> > tokenize(
    const basic_string<CH> &Input,
    const basic_string<CH> &Delimiter,
    bool remove_empty_token
    ) {

    typedef typename basic_string<CH>::const_iterator string_iterator_t;
    typedef boost::find_iterator< string_iterator_t > string_find_iterator_t;

    vector< basic_string<CH> > Result;
    string_iterator_t it = Input.begin();
    string_iterator_t it_end = Input.end();
    for(string_find_iterator_t i = boost::make_find_iterator(Input, boost::first_finder(Delimiter, boost::is_equal()));
        i != string_find_iterator_t();
        ++i) {
        if(remove_empty_token){
            if(it != i->begin())
                Result.push_back(basic_string<CH>(it,i->begin()));
        }
        else
            Result.push_back(basic_string<CH>(it,i->begin()));
        it = i->end();
    }
    if(it != it_end)
        Result.push_back(basic_string<CH>(it,it_end));

    return Result;
} 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2018-09-21T03:28:01.263

这是我的字符串标记器的 Swiss® 军刀，用于按空格分割字符串，考虑单引号和双引号包裹的字符串以及从结果中删除这些字符。我使用 RegexBuddy 4.x 生成*大部分*代码片段，但我添加了自定义处理以去除引号和其他一些东西。

```
#include <string>
#include <locale>
#include <regex>

std::vector<std::wstring> tokenize_string(std::wstring string_to_tokenize) {
    std::vector<std::wstring> tokens;

    std::wregex re(LR"(("[^"]*"|'[^']*'|[^"' ]+))", std::regex_constants::collate);

    std::wsregex_iterator next( string_to_tokenize.begin(),
                                string_to_tokenize.end(),
                                re,
                                std::regex_constants::match_not_null );

    std::wsregex_iterator end;
    const wchar_t single_quote = L'\'';
    const wchar_t double_quote = L'\"';
    while ( next != end ) {
        std::wsmatch match = *next;
        const std::wstring token = match.str( 0 );
        next++;

        if (token.length() > 2 && (token.front() == double_quote || token.front() == single_quote))
            tokens.emplace_back( std::wstring(token.begin()+1, token.begin()+token.length()-1) );
        else
            tokens.emplace_back(token);
    }
    return tokens;
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-05-15T20:47:07.477

如果要标记的输入字符串的最大长度已知，则可以利用这一点并实现一个非常快速的版本。我正在勾画下面的基本思想，它的灵感来自于 strtok() 和“后缀数组”——Jon Bentley 的“Programming Perls”第 2 版第 15 章中描述的数据结构。在这种情况下，C++ 类只提供了一些组织和便利使用。所示的实现可以很容易地扩展以删除标记中的前导和尾随空白字符。

基本上，可以将分隔符替换为以字符串结尾的“\0”字符，并使用修改后的字符串设置指向标记的指针。在字符串仅由分隔符组成的极端情况下，一个字符串长度加 1 产生的空标记。复制要修改的字符串是可行的。

头文件：

```
class TextLineSplitter
{
public:

    TextLineSplitter( const size_t max_line_len );

    ~TextLineSplitter();

    void            SplitLine( const char *line,
                               const char sep_char = ',',
                             );

    inline size_t   NumTokens( void ) const
    {
        return mNumTokens;
    }

    const char *    GetToken( const size_t token_idx ) const
    {
        assert( token_idx < mNumTokens );
        return mTokens[ token_idx ];
    }

private:
    const size_t    mStorageSize;

    char           *mBuff;
    char          **mTokens;
    size_t          mNumTokens;

    inline void     ResetContent( void )
    {
        memset( mBuff, 0, mStorageSize );
        // mark all items as empty:
        memset( mTokens, 0, mStorageSize * sizeof( char* ) );
        // reset counter for found items:
        mNumTokens = 0L;
    }
}; 
```

实现文件：

```
TextLineSplitter::TextLineSplitter( const size_t max_line_len ):
    mStorageSize ( max_line_len + 1L )
{
    // allocate memory
    mBuff   = new char  [ mStorageSize ];
    mTokens = new char* [ mStorageSize ];

    ResetContent();
}

TextLineSplitter::~TextLineSplitter()
{
    delete [] mBuff;
    delete [] mTokens;
}

void TextLineSplitter::SplitLine( const char *line,
                                  const char sep_char   /* = ',' */,
                                )
{
    assert( sep_char != '\0' );

    ResetContent();
    strncpy( mBuff, line, mMaxLineLen );

    size_t idx       = 0L; // running index for characters

    do
    {
        assert( idx < mStorageSize );

        const char chr = line[ idx ]; // retrieve current character

        if( mTokens[ mNumTokens ] == NULL )
        {
            mTokens[ mNumTokens ] = &mBuff[ idx ];
        } // if

        if( chr == sep_char || chr == '\0' )
        { // item or line finished
            // overwrite separator with a 0-terminating character:
            mBuff[ idx ] = '\0';
            // count-up items:
            mNumTokens ++;
        } // if

    } while( line[ idx++ ] );
} 
```

使用场景是：

```
// create an instance capable of splitting strings up to 1000 chars long:
TextLineSplitter spl( 1000 );
spl.SplitLine( "Item1,,Item2,Item3" );
for( size_t i = 0; i < spl.NumTokens(); i++ )
{
    printf( "%s\n", spl.GetToken( i ) );
} 
```

输出：

```
Item1

Item2
Item3 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2012-07-16T01:14:11.680

[`boost::tokenizer`](http://www.boost.org/doc/libs/1_50_0/libs/tokenizer/index.html)`wstring`是您的朋友，但请考虑通过使用/`wchar_t`而不是遗留`string`/`char`类型来参考国际化 (i18n) 问题使您的代码可移植。

```
#include <iostream>
#include <boost/tokenizer.hpp>
#include <string>

using namespace std;
using namespace boost;

typedef tokenizer<char_separator<wchar_t>,
                  wstring::const_iterator, wstring> Tok;

int main()
{
  wstring s;
  while (getline(wcin, s)) {
    char_separator<wchar_t> sep(L" "); // list of separator characters
    Tok tok(s, sep);
    for (Tok::iterator beg = tok.begin(); beg != tok.end(); ++beg) {
      wcout << *beg << L"\t"; // output (or store in vector)
    }
    wcout << L"\n";
  }
  return 0;
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-12-15T01:09:58.677

简单的 C++ 代码（标准 C++98），接受多个分隔符（在 std::string 中指定），仅使用向量、字符串和迭代器。

```
#include <iostream>
#include <vector>
#include <string>
#include <stdexcept> 

std::vector<std::string> 
split(const std::string& str, const std::string& delim){
    std::vector<std::string> result;
    if (str.empty())
        throw std::runtime_error("Can not tokenize an empty string!");
    std::string::const_iterator begin, str_it;
    begin = str_it = str.begin(); 
    do {
        while (delim.find(*str_it) == std::string::npos && str_it != str.end())
            str_it++; // find the position of the first delimiter in str
        std::string token = std::string(begin, str_it); // grab the token
        if (!token.empty()) // empty token only when str starts with a delimiter
            result.push_back(token); // push the token into a vector<string>
        while (delim.find(*str_it) != std::string::npos && str_it != str.end())
            str_it++; // ignore the additional consecutive delimiters
        begin = str_it; // process the remaining tokens
        } while (str_it != str.end());
    return result;
}

int main() {
    std::string test_string = ".this is.a.../.simple;;test;;;END";
    std::string delim = "; ./"; // string containing the delimiters
    std::vector<std::string> tokens = split(test_string, delim);           
    for (std::vector<std::string>::const_iterator it = tokens.begin(); 
        it != tokens.end(); it++)
            std::cout << *it << std::endl;
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-02-25T06:40:51.927

```
/// split a string into multiple sub strings, based on a separator string
/// for example, if separator="::",
///
/// s = "abc" -> "abc"
///
/// s = "abc::def xy::st:" -> "abc", "def xy" and "st:",
///
/// s = "::abc::" -> "abc"
///
/// s = "::" -> NO sub strings found
///
/// s = "" -> NO sub strings found
///
/// then append the sub-strings to the end of the vector v.
/// 
/// the idea comes from the findUrls() function of "Accelerated C++", chapt7,
/// findurls.cpp
///
void split(const string& s, const string& sep, vector<string>& v)
{
    typedef string::const_iterator iter;
    iter b = s.begin(), e = s.end(), i;
    iter sep_b = sep.begin(), sep_e = sep.end();

    // search through s
    while (b != e){
        i = search(b, e, sep_b, sep_e);

        // no more separator found
        if (i == e){
            // it's not an empty string
            if (b != e)
                v.push_back(string(b, e));
            break;
        }
        else if (i == b){
            // the separator is found and right at the beginning
            // in this case, we need to move on and search for the
            // next separator
            b = i + sep.length();
        }
        else{
            // found the separator
            v.push_back(string(b, i));
            b = i;
        }
    }
} 
```

boost 库很好，但它们并不总是可用。用手做这类事情也是一种很好的大脑锻炼。这里我们只使用 STL 中的 std::search() 算法，参见上面的代码。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2014-03-17T16:54:00.827

我一直在寻找一种用任意长度的分隔符分割字符串的方法，所以我从头开始编写它，因为现有的解决方案不适合我。

这是我的小算法，仅使用 STL：

```
//use like this
//std::vector<std::wstring> vec = Split<std::wstring> (L"Hello##world##!", L"##");

template <typename valueType>
static std::vector <valueType> Split (valueType text, const valueType& delimiter)
{
    std::vector <valueType> tokens;
    size_t pos = 0;
    valueType token;

    while ((pos = text.find(delimiter)) != valueType::npos) 
    {
        token = text.substr(0, pos);
        tokens.push_back (token);
        text.erase(0, pos + delimiter.length());
    }
    tokens.push_back (text);

    return tokens;
} 
```

据我测试，它可以与任何长度和形式的分隔符一起使用。使用 string 或 wstring 类型实例化。

该算法所做的只是搜索定界符，获取到定界符的字符串部分，删除定界符并再次搜索，直到找不到为止。

希望能帮助到你。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2015-01-15T17:13:05.720

我之前只使用标准库制作了词法分析器/标记器。这是代码：

```
#include <iostream>
#include <string>
#include <vector>
#include <sstream>

using namespace std;

string seps(string& s) {
    if (!s.size()) return "";
    stringstream ss;
    ss << s[0];
    for (int i = 1; i < s.size(); i++) {
        ss << '|' << s[i];
    }
    return ss.str();
}

void Tokenize(string& str, vector<string>& tokens, const string& delimiters = " ")
{
    seps(str);

    // Skip delimiters at beginning.
    string::size_type lastPos = str.find_first_not_of(delimiters, 0);
    // Find first "non-delimiter".
    string::size_type pos = str.find_first_of(delimiters, lastPos);

    while (string::npos != pos || string::npos != lastPos)
    {
        // Found a token, add it to the vector.
        tokens.push_back(str.substr(lastPos, pos - lastPos));
        // Skip delimiters.  Note the "not_of"
        lastPos = str.find_first_not_of(delimiters, pos);
        // Find next "non-delimiter"
        pos = str.find_first_of(delimiters, lastPos);
    }
}

int main(int argc, char *argv[])
{
    vector<string> t;
    string s = "Tokens for everyone!";

    Tokenize(s, t, "|");

    for (auto c : t)
        cout << c << endl;

    system("pause");

    return 0;
} 
```

* * *

## 回答 #35

> 赞同：-4
> 
> 时间：2013-05-19T13:42:11.370

这是一个仅使用标准库文件进行标记的简单循环

```
#include <iostream.h>
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <conio.h>
class word
    {
     public:
     char w[20];
     word()
      {
        for(int j=0;j<=20;j++)
        {w[j]='\0';
      }
   }

};

void main()
  {
    int i=1,n=0,j=0,k=0,m=1;
    char input[100];
    word ww[100];
    gets(input);

    n=strlen(input);

    for(i=0;i<=m;i++)
      {
        if(context[i]!=' ')
         {
            ww[k].w[j]=context[i];
            j++;

         }
         else
        {
         k++;
         j=0;
         m++;
        }

   }
 } 
```

# serial-port - 如何创建虚拟 COM 端口

> ID：53857
> 
> 赞同：4
> 
> 时间：2008-09-10T12:14:05.750
> 
> 标签：serial-port, virtual-serial-port

我正在尝试实现一个软件[Null Modem](http://en.wikipedia.org/wiki/Null_modem)。

有什么建议如何创建虚拟 COM 端口？

寻找技巧、策略、已知技术等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T12:18:50.467

我之前在 Windows 上使用过开源[com0com](http://com0com.sourceforge.net/)，它运行良好。相关的 com2tcp 项目更难以可靠地工作。

# sql-server - Linq 查询可以从 Sql 数据库中检索 BLOB 吗？

> ID：53873
> 
> 赞同：5
> 
> 时间：2008-09-10T12:26:12.197
> 
> 标签：sql-server, linq-to-sql, blob

Linq 查询可以从 Sql 数据库中检索 BLOB 吗？
他们是怎么出来的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-10T12:51:58.483

LINQ-To-SQL 类为 SQL-Server 中的所有二进制和 varbinary 字段创建 System.Data.Linq.Binary 类型的属性。Binary 类型有一个返回 byte[] 的 .ToArray() 方法，它的构造函数可以采用 byte[]。

旧版本的 SQLMetal 生成了 byte[] 类型的属性，但问题在于它们在任何连接中都失败了。我认为这是他们用 IEquatable Binary 类型替换它的主要原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T12:34:03.177

如果我没有误认为 LINQ to SQL 将 BLOB 视为 System.Byte[]
，我记得 SqlMetal 存在一些问题，它为 BLOB 生成了错误的类型，但 MSVS dmbl 设计器应该可以工作。

# vim - 在 vim 中，我如何回到搜索前的位置？

> ID：53911
> 
> 赞同：276
> 
> 时间：2008-09-10T12:42:43.670
> 
> 标签：vim, vi

在 vim 中编程 我经常去搜索一些东西，拉它，然后回到我原来的位置，插入它，修改它。

问题是，在我搜索并找到之后，我需要手动找到回到我所在位置的路。

是否有一种自动方式可以返回到我上次搜索时的位置？

* * *

## 回答 #1

> 赞同：425
> 
> 时间：2008-09-10T12:47:51.957

`Ctrl`+`O`带我到上一个位置。在搜索之前不知道位置。

编辑：另外，````.`将带您到您所做的最后一次更改。

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2008-09-17T14:55:51.047

用于````跳回您搜索/跳跃之前所在的确切位置，或`''`跳回您搜索/跳跃之前所在行的开头。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2008-09-10T12:46:50.493

我总是通过设置标记来完成。

1.  在命令模式下，按**`m`*[字母]***。例如，使用**a**作为标记标识符`m``a`在当前行设置标记。

***   要返回标记，请按**`'`[字母]**。例如，`'``a`带您回到步骤 1 中设置的行标记。要返回标记行的行的列位置，请使用````a`( **back-tick *[letter]*** )。** 

 **要查看当前设置的所有标记，请键入**`:marks`**。

* * *

在一个稍微不相关的注释上，我刚刚发现了另一个关于标记的好东西。

假设您通过执行跳转到标记**b**`m``b`。Vim 自动将标记`'`（即单引号）设置为您在跳转到标记**b**之前所在的那一行。

这意味着您可以`'``b`跳到该标记，然后执行`''`（2 个单引号）跳回您之前所在的位置。

我无意中发现了这一点`:marks`，该命令显示了所有标记的列表。

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2008-09-26T11:46:57.580

你真的应该阅读`:help jumplist`它很好地解释了所有这些。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2012-10-03T09:56:47.270

`CTRL+O`和`CTRL+I`，用于前后跳跃。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-05-01T00:45:16.217

我用这个：

```
nnoremap / ms/
nnoremap ? ms? 
```

然后，如果我使用`/`or搜索某些内容`?`，我可以通过 快速返回``s`。您可以将字母替换为`s`您喜欢的任何字母。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-10T12:47:43.783

最简单的方法是用 设置一个标记，`m[letter]`然后用 回到它`'[letter]`

# xml - 如何在网格中布置图像？

> ID：53913
> 
> 赞同：2
> 
> 时间：2008-09-10T12:42:53.450
> 
> 标签：xml, xslt, xsl-fo

我正在尝试使用 XSLT 和 XSL-FO 制作带有按网格排列的标题的照片。照片 URL 和标题是使用针对 SQL Server 数据库的 FOR XML 查询生成的，返回的照片数量因工作表而异。我想把照片分成四列，从左到右和从上到下填充网格。在 HTML 中，我会通过将每张照片和标题放入 div 并使用“float:left”使它们流入网格来做到这一点。是否有使用 XSL-FO 的类似优雅方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T13:27:10.520

为了让生活简单，我通常会为此设置一张桌子，它非常简单，并且可以确保事情得到正确布置。如果你想像在 HTML 中那样做，那么你应该布局块容器元素。

不管你决定这样做，我总是建议使用[ZVON 参考](http://www.zvon.org/xxl/xslfoReference/Output/index.html)网站。很好地查找元素和可用属性，虽然它们的 XSL-FO 没有包含太多解释方式，但每个页面都指向标准文档的深层链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-10T13:39:25.907

最后，我为此使用了一个包含一行和四个单元格的表格。在每一个中，我根据需要选择了 position() mod 4 等于 0、1、2 或 3 的源元素，然后确保照片和标题始终具有相同的高度，以便行正确排列。

# sharepoint - SharePoint：在自定义内容类型中使用 RichHTML 字段类型

> ID：53935
> 
> 赞同：3
> 
> 时间：2008-09-10T12:51:00.297
> 
> 标签：sharepoint, content-type

我想在我正在制作的自定义内容类型中使用字段类型 RichHTML。但是，我认为 RichHTML 类型是 MOSS Publishing 附带的，所以我不确定如何将它添加到我的内容类型中。现在我已经尝试过：

```
<Field ID="{7F55A8F0-4555-46BC-B24C-222240B862AF}" Type="RichHTML" Name="NewsBodyField" DisplayName="News Body" StaticName="NewsBodyField" Hidden="False" Required="True" Sealed="False" />

<Field ID="{7F55A8F0-4555-46BC-B24C-222240B862AF}" Type="RichHtmlField" Name="NewsBodyField" DisplayName="News Body" StaticName="NewsBodyField" Hidden="False" Required="True" Sealed="False" /> 
```

我知道，当我想使用 CQWP 访问此自定义字段时，我可以将其导出并使用“RichHTML”将其添加到我的 CommonViews 中，但这在这里不起作用。

任何有关如何将 Rich Html 字段添加到自定义内容类型的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T14:53:29.503

我自己想通了。您要查找的类型是“HTML”而不是 RichHTML。

# visual-studio - 为什么 Visual Studio 不能在多个内核上运行？CPU 25%

> ID：53939
> 
> 赞同：6
> 
> 时间：2008-09-10T12:52:04.100
> 
> 标签：visual-studio, visual-studio-2008

我正在运行 Visual Studio 2008 和噩梦般的可怕 MS 测试框架。问题是它让我的 CPU 达到 100%（在四核上是 25%）。

我的问题是为什么 Visual Studio 不能在多个内核上运行？当然，M$ 必须对线程有足够的处理才能使其工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-10T12:57:09.110

我在所有 4 个 CPU 上运行 VS2008。只需设置此环境变量/项目标志。

/MP

（可以在C/C++设置，高级中设置。在项目设置中）

编辑： MP 标志也可以接受一个数字，例如 /MP2 这意味着它只能在 2 个内核上运行。将其保留为 /MP 意味着它将在最大数量的内核上运行。

Edit2： MP 标志可能仅适用于编译器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-23T19:22:31.883

您可以要求 VS 并行编译多个项目，也可以在一个项目中并行编译（！？）。

工具 > 选项 > 项目和解决方案 > 并行项目构建的最大数量。

这也将并行构建 C++ 和 C#！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-23T18:45:04.183

万一有人遇到这个老问题，VS2012 引入了并行构建作为[标准功能](http://visualstudiomagazine.com/articles/2012/03/01/more-power.aspx)。引用文章：

> Visual Studio 2010 包含“最大并行项目构建数”选项。尽管没有任何限制的迹象，但此 IDE 选项仅适用于 C++ 项目。幸运的是，此限制不再适用于 Visual Studio 11。相反，现在也完全支持其他语言的并行构建。要查看此内容，请在构建具有大量项目的解决方案的同时运行 Process Explorer 的副本。您将看到创建了多个 MSBuild 实例——与“最大并行项目构建数”中指定的一样多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-28T20:09:02.193

Now that **Visual Studio 2010** has been released for a bit, consider upgrading to make use of the `parallelTestCount` attribute in MSTest's `.testsettings` file, as described at [How to: Run Unit Tests Faster Using a Computer with Multiple CPUs or Cores](http://msdn.microsoft.com/en-us/library/ee921484.aspx).

There are a few limitations, such as:

1.  Only simple unit tests are supported (i.e. excludes coded UI tests and ASP.NET-hosted tests)
2.  Tests must be thread-safe (all tests are run in the same process)
3.  You can't collect code coverage (among other data & diagnostics) at the same time

Example, using **0** to mean **auto-detect** (the default is **1**):

```
<?xml version="1.0" encoding="UTF-8"?>
<TestSettings
  name="Release"
  id="{GUID}"
  xmlns="http://microsoft.com/schemas/VisualStudio/TeamTest/2010">
  <Description>
    These are default test settings for a local test run.
  </Description>
  <Execution parallelTestCount="0">
    (...)
  </Execution>
</TestSettings> 
```

A few blogs have noted that **you might have to close and re-open your project** for Visual Studio to notice you added/changed that attribute. Also, if you edit the test settings file using the GUI, you'll probably have to re-add the `parallelTestCount` attribute.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-10T12:58:15.160

我们还添加了多核支持，用于在命令行上为那些拥有大量项目和较长构建时间的人进行多线程构建。启用多核支持只需要几个新属性，MSBuild 管理所有工作以高效地安排项目。MSBuild 团队通过在 64-CPU 机器上构建一些项目来测试这种扩展能力。

来自[somasegar 博客](http://blogs.msdn.com/somasegar/archive/2007/08/15/visual-studio-2008-msbuild.aspx)

所以他们开始这样做了，至少对于构建来说是这样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T13:10:54.443

/MP 标志仅用于构建，我们至少是根据这个[msdn](http://msdn.microsoft.com/en-us/library/bb385193.aspx)

现在我很想错了，但我很确定它只是为了构建。当然，这仍然非常有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T13:18:30.637

我敢肯定这很难。大量现有的 GUI 繁重的非线程代码库到多线程。对我来说听起来像10。

***但***对我来说，它似乎使用了多核。Intellesense 似乎是线程化的。构建系统具有多项目构建和 C++ 多文件构建。

这些工具的问题听起来比他们使用 CPU 的程度要深一些。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-12T10:02:06.797

对于 Visual Studio 2010，转到工具 > 选项 > 项目和解决方案 > 构建并运行。

然后，您将看到一个条目，用于输入“最大并行项目构建数”的数字；我的电脑有一个 i7-3770 CPU，一个带超线程的四核，所以它设置为 8。

有关 Visual Studio 不同版本的信息，请转到此处并选择您的版本：[https ://msdn.microsoft.com/en-us/library/cyhcc7zc(v=vs.100).aspx](https://msdn.microsoft.com/en-us/library/cyhcc7zc(v=vs.100).aspx)

例如对于 Visual Studio 2010，此属性仅影响 C++ 构建：

> 指定可以同时生成的 Visual C++ 项目的最大数量。为了优化构建过程，并行项目构建的最大数量自动设置为您计算机的 CPU 数量。最大值为 32。

但对于 Visual Studio，它适用于 C++ 和 C#：

> 最大并行项目构建数 指定可以同时构建的 Visual C++ 和 Visual C# 项目的最大数量。为了优化构建过程，并行项目构建的最大数量自动设置为您计算机的 CPU 数量。最大值为 32。

# image - 是否有可以将常见图像格式（.bmp、jpg、..）转换为 .emf 文件的工具？

> ID：53941
> 
> 赞同：2
> 
> 时间：2008-09-10T12:53:35.530
> 
> 标签：image

我正在使用 GoDiagrams 套件，该套件似乎推荐用于节点图像的 .emf 文件，因为它们在调整大小时可以更好地扩展。位图变得模糊。
谷歌没有显示任何似乎可以做到这一点的好工具......所以重申一下，我正在寻找一种图像转换器（最好是免费的）来转换图像（以位图或 JPEG 或 GIF 等常见格式之一）到 .EMF 文件。

*更新：我不需要通过代码来做。简单的图像批量转换就可以了。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T13:01:54.340

[Inkscape](http://www.inkscape.org/)效果很好，在[这里](https://stackoverflow.com/questions/28872/free-windows-based-emf-editor)推荐给我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-08T15:33:47.270

Irfanview ( [http://www.irfanview.com](http://www.irfanview.com/) ) 支持多种图像格式（包括 .emf）。它体积小、速度快且功能非常齐全。它可免费用于非商业和教育用途。我将它用于我所有的图像转换需求，因为它可以处理批量文件，并且可以在保存时重命名它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T12:58:12.323

[Image Magick](http://www.imagemagick.org)包含一个名为 convert 的工具，它可以将[任何东西](http://www.imagemagick.org/script/formats.php)转换为 EMF 文件。您可以将其用作单独的应用程序，也可以使用以多种不同语言提供[的 API与其交互。](http://www.imagemagick.org/script/api.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-08T15:24:24.107

XnView ( [http://www.xnview.com](http://www.xnview.com) )。非常好的查看器和转换器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T12:57:09.890

试试[ImageConverter Plus](http://www.imageconverterplus.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T11:26:31.847

试试[http://autotrace.sourceforge.net/](http://autotrace.sourceforge.net/)。它是开源的，并且效果很好。从这里下载：http: [//sourceforge.net/project/showfiles.php ?group_id=11789](http://sourceforge.net/project/showfiles.php?group_id=11789)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-23T11:05:23.473

微软真的很有趣。现在这可能看起来很奇怪，但它有效......（我有 Visio2007）。刚从同事那里发现

您可以将 JPEG 放入**Microsoft Visio**（不少于），对 .emf 执行“另存为”，瞧！画质也不错。

# javascript - 将 javascript 动态插入到使用 document.write 的 HTML 中

> ID：53945
> 
> 赞同：18
> 
> 时间：2008-09-10T12:55:43.950
> 
> 标签：javascript, html, ajax

我目前正在加载一个灯箱样式的弹出窗口，它从 XHR 调用中加载它的 HTML。`element.innerHTML = content`然后使用This works like a charm将这些内容显示在“模态”弹出窗口中。

在本网站的另一部分，我使用 Flickr 的“徽章”（[http://www.elliotswan.com/2006/08/06/custom-flickr-badge-api-documentation/](http://www.elliotswan.com/2006/08/06/custom-flickr-badge-api-documentation/)）动态加载 flickr 图像。这包括一个加载 flickr javascript 的脚本标记，该标记又会执行一些`document.write`语句。

当包含在 HTML 中时，它们都可以完美地工作。*仅当在灯箱内*加载 flickr 徽章代码时，根本不会呈现任何内容。似乎使用`innerHTML`to write `document.write`statements 走得太远了，但我在这种行为的 javascript 实现（FF2&3，IE6&7）中找不到任何线索。

谁能澄清这是否应该或不应该工作？谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-12-07T22:16:56.530

通常，使用 innerHTML 时不会执行脚本标签。在您的情况下，这很好，因为`document.write`调用会清除页面中已经存在的所有内容。但是，这会让您没有任何 HTML document.write 应该添加的内容。

jQuery 的 HTML 操作方法将为您执行 HTML 中的脚本，诀窍是捕获对 HTML 的调用`document.write`并将 HTML 放在适当的位置。如果它足够简单，那么这样的事情会做：

```
var content = '';
document.write = function(s) {
    content += s;
};
// execute the script
$('#foo').html(markupWithScriptInIt);
$('#foo .whereverTheDocumentWriteContentGoes').html(content); 
```

虽然它变得复杂。如果脚本在另一个域上，它将异步加载，因此您必须等到它完成才能获取内容。此外，如果它只是将 HTML 写入片段的中间而没有您可以轻松选择的包装元素怎么办？[writeCapture.js](http://github.com/iamnoah/writeCapture) （完全披露：我写的）处理所有这些问题。我建议只使用它，但至少您可以查看代码以了解它如何处理所有内容。

编辑：这是一个[页面](http://iamnoah.github.com/writeCapture/lbFlickrDemo.html)，展示了您想要的效果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-10T13:25:31.743

我创建了一个简单的测试页面来说明问题：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
        <title>Document Write Testcase</title>
    </head>
    <body>
        <div id="container">
        </div>
        <div id="container2">
        </div>

        <script>
            // This doesn't work!
            var container = document.getElementById('container');
            container.innerHTML = "<script type='text/javascript'>alert('foo');document.write('bar');<\/script>";

            // This does!
            var container2 = document.getElementById('container2');
            var script = document.createElement("script");
            script.type = 'text/javascript';
            script.innerHTML = "alert('bar');document.write('foo');";
            container.appendChild(script);
        </script>
    </body>
</html> 
```

此页面警告“bar”并打印“foo”，而我希望它也会警告“foo”并打印“bar”。但是，不幸的是，由于该`script`标记是较大 HTML 页面的一部分，因此我不能像上面的示例那样单独选择该标记并附加它。好吧，我可以，但这需要扫描标签`innerHTML`内容`script`，并在字符串中用占位符替换它们，然后使用 DOM 插入它们。听起来不是*那么*微不足道。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-08-24T12:12:58.623

使用`document.writeln(content);`而不是`document.write(content)`.

但是，更好的方法是使用 的串联`innerHTML`，如下所示：

```
element.innerHTML += content; 
```

该`element.innerHTML = content;`方法将用新内容替换旧内容，这将覆盖元素的 innerHTML！

而使用`+=`运算符 in`element.innerHTML += content`会将您的文本附加到旧内容之后。（类似于做什么`document.write`。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T14:03:25.193

`document.write`就像它们来时一样被弃用。不过，由于 JavaScript 的奇妙之处，您可以将自己的函数分配给对象的`write`方法，该方法在您选择的元素上使用，以附加提供的内容。`document``innerHTML`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T13:13:20.727

我可以先得到一些澄清以确保我得到了问题吗？

`document.write`调用将在它们发生的标记点处将内容添加到标记中。例如，如果您`document.write`在函数中包含调用但在其他地方调用该函数，则`document.write`输出将发生在标记中*定义*该函数的位置而不是*调用*它的位置。

因此，要使其在所有 Flickr`document.write`语句中起作用，需要成为`content`in 的一部分`element.innerHTML = content`。肯定是这样吗？

`document.write`您可以通过在设置为 the 的内容中添加一个简单的调用来快速测试这是否应该工作，`innerHTML`并查看它的作用：

```
<script>
  var content = "<p>1st para</p><script>document.write('<p>2nd para</p>');</script>"
  element.innerHTML = content;
</script> 
```

如果可行`document.write`，那么将内容集作为`innerHTML`元素的工作的概念可能会起作用。

我的直觉是它不起作用，但测试这个概念应该很简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-10T13:48:57.363

因此，您正在使用 DOM 方法创建一个`script`元素并将其附加到现有元素，然后这会导致附加`script`元素的内容执行？听起来不错。

您说脚本标记是较大 HTML 页面的一部分，因此不能单独列出。你不能给脚本标签一个ID并定位它吗？我可能在这里遗漏了一些明显的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-10T13:59:58.447

理论上，是的，我可以用这种方式挑出一个脚本标签。问题是我们可能有几十种发生这种情况的情况，所以我试图找到这种行为的一些原因或文档。

此外，`script`标签在加载后似乎不再是 DOM 的一部分。在我们的环境中，我的`container`div 仍然是空的，所以我无法获取`script`标签。不过，它应该可以工作，因为在我上面的示例中，脚本没有被执行，但仍然是 DOM 的一部分。

# c# - HTML 到图像 .tiff 文件

> ID：53956
> 
> 赞同：3
> 
> 时间：2008-09-10T13:00:21.897
> 
> 标签：c#, .net, html, image, tiff

有没有办法将 HTML 字符串转换为 Image .tiff 文件？

我正在使用 C# .NET 3.5。要求是给用户一个选项来进行确认。确认是使用 XML 和 XSLT 创建的。通常是通过电子邮件发送的。

有没有办法可以获取转换 HTML 字符串生成的 HTML 字符串并将其转换为`.tiff`可以传真的图像或任何图像？

允许第三方软件，但越便宜越好。

我们正在使用 3rd 方传真库，它只接受`.tiff`图像，但如果我可以将 HTML 转换为任何图像，我可以将其转换为`.tiff`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-10T14:59:40.190

以下是一些免费啤酒的可能性：

您可以使用 ghostscript 附带的 PDFCreator 打印机驱动程序，直接打印到 TIFF 文件或许多其他格式。

如果您安装了 MSOffice，Microsoft Office Document Image Writer 将生成一个您可以转换为其他格式的文件。

但总的来说，您最好的选择是打印到将生成某种图像文件或 Windows 元文件格式 (.wmf) 文件的驱动程序。

是否有某些原因您不能只打印到传真？第三方软件是否不支持打印机驱动程序？这几天很不寻常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-10T13:04:52.477

一个起点可能是[WebSuperGoo](http://www.websupergoo.com)的软件，它提供了丰富的图像编辑产品，便宜或免费。

我确信他们的 PDF Writer 可以编写基本的 HTML（[http://www.websupergoo.com/helppdf6net/source/3-concepts/b-htmlstyles.htm](http://www.websupergoo.com/helppdf6net/source/3-concepts/b-htmlstyles.htm)）。这应该不会太难转换为 TIFF。

这不包括完整的 HTML 子集或 CSS。这可能需要使用 Microsoft 的 IE ActiveX 组件。

# c# - 为包含给定类型的 .Net 程序集找到并添加项目引用？

> ID：53961
> 
> 赞同：1
> 
> 时间：2008-09-10T13:04:01.480
> 
> 标签：c#, .net, visual-studio

我正在使用一个大型（270 多个项目）VS.Net 解决方案。是的，我知道这是在推动与 VS 的友谊，但它是继承的，等等。无论如何，为了加快解决方案的加载和编译时间，我已经删除了所有我目前没有处理的项目......这反过来又从我想要保留的项目中删除了这些项目引用。所以现在我正在经历一个令人麻木的过程，将二进制引用添加到保留的项目中，以便可以找到引用的类型。

这是我目前的工作方式；

*   尝试编译，出现数千个错误，“缺少类型或命名空间”
*   将错误列表的第一行复制到剪贴板
*   使用连接到热键 (AHK) 的 perl 脚本，我从错误消息中提取类型名称并将其存储在 Windows 剪贴板中
*   我将类型名称粘贴到源洞察符号浏览器中，并注意包含类型的程序集
*   我回到 VS 并将该程序集添加为相关项目的二进制引用

所以现在，大约 30 分钟后，我想必须有一个更快的方法......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-10T13:08:07.570

我想到了这些解决方案：

*   您可以尝试使用[Dependency Walker](http://www.dependencywalker.com)或类似程序来分析依赖关系。
*   解析 MSBuild 文件 (*.csproject) 以获取依赖项列表

**编辑：**刚刚在 codeplex 上
找到了 2 个很酷的工具[Dependency Visualizer](http://www.codeplex.com/dependencyvisualizer)和[Dependency Finder ，我认为它们可以为您提供很大帮助。](http://www.codeplex.com/DependencyFinder)

**编辑：**
@edg，我完全误读了您的问题，因为您丢失了 csproj 文件的引用，您必须使用 NDepend 之类的静态分析工具或尝试在运行时分析依赖关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-10T13:44:02.493

您可以尝试的一件事是在记事本中打开旧的 .csproj 文件并将 ProjectReference 标记替换为 Reference 标记。如果您可以编写解析器，请随时分享。:)

.csproj 文件中的条目（如果它是项目引用）

```
 <ItemGroup>
    <ProjectReference Include="..\WindowsApplication2\WindowsApplication2.csproj">
      <Project>{7CE93073-D1E3-49B0-949E-89C73F3EC282}</Project>
      <Name>WindowsApplication2</Name>
    </ProjectReference>
  </ItemGroup> 
```

.csproj 文件中的条目（如果它是程序集引用）

```
 <ItemGroup>
    <Reference Include="WindowsApplication2, Version=1.0.0.0, Culture=neutral, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <ExecutableExtension>.dll</ExecutableExtension>
      <HintPath>..\WindowsApplication2\bin\Release\WindowsApplication2.dll</HintPath>
    </Reference>   </ItemGroup> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T16:11:53.450

不，目前没有内置的更快方法。

我建议不要修改现有的解决方案，并使用复制（例如重命名和编辑）您想要处理的项目的新项目创建一个新的解决方案。如果您发现包含数百个项目的解决方案对您来说是个问题，那么您可能只需要处理一个子集。从几个新项目开始，添加二进制（不是项目）引用并从那里开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T21:30:15.557

无需从解决方案中删除项目文件，您可以卸载您不处理的项目（右键单击该项目并选择*Unload Project*）。只要卸载的项目已经构建一次，任何其他引用它的项目都可以在项目的输出目录中找到该程序集并使用它进行构建。

# php - 这个 PHP 正则表达式有什么问题？

> ID：53965
> 
> 赞同：2
> 
> 时间：2008-09-10T13:04:57.033
> 
> 标签：php, regex

```
$output = preg_replace("|(/D)(/s+)(/d+)(;)|", "//1,//3;", $output); 
```

我正在尝试替换所有字母字符，后跟一个或多个空白字符（制表符和/或空格），后跟一个或多个数字字符，后跟分号，字母字符后跟逗号，后跟数字，然后分号。

我将提供一个示例：

开始：

```
hello world      1007; 
```

结尾：

```
hello world,1007; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-10T13:10:19.797

`|`开头和结尾的两个可能是不正确的 - 并且都应该是正斜杠。

所有其他正斜杠都应该是反斜杠（并且需要转义）。

由于 PHP 4.04`$n`是引用捕获组的首选方式。

```
$output = preg_replace("/(\\D)\\s+(\\d+;)/", "$1,$2", $output); 
```

如果您使用单引号，则不需要转义反斜杠：

```
$output = preg_replace('/(\D)\s+(\d+;)/', '$1,$2', $output); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T13:09:26.647

这些正斜杠应该是反斜杠吗？除非您将双引号更改为单引号，否则您也需要为 PHP 转义它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-10T13:22:12.843

您需要正则表达式中的反斜杠，而不是正斜杠。需要开始和结束管道（或**正**则表达式的另一个分隔符）

```
$x = "hello world      1007;";    
echo preg_replace('|(\D)(\s+)(\d+)(;)|','$1,$3',$x);
echo preg_replace('/(\D)(\s+)(\d+)(;)/','$1,$3',$x);
echo preg_replace('{(\D)(\s+)(\d+)(;)}','$1,$3',$x); 
```

# c# - 您将如何实现 IEnumerator 接口？

> ID：53967
> 
> 赞同：12
> 
> 时间：2008-09-10T13:05:56.530
> 
> 标签：c#, .net, collections, ienumerable, ienumerator

我有一个将对象映射到对象的类，但与字典不同，它以两种方式映射它们。我现在正在尝试实现一个`IEnumerator`遍历值的自定义接口。

```
public class Mapper<K,T> : IEnumerable<T>, IEnumerator<T>

{
    C5.TreeDictionary<K,T> KToTMap = new TreeDictionary<K,T>();
    C5.HashDictionary<T,K> TToKMap = new HashDictionary<T,K>();

    public void Add(K key, T value)
    {
        KToTMap.Add(key, value);
        TToKMap.Add(value, key);

    }

    public int Count
    {
        get { return KToTMap.Count; }
    }

    public K this[T obj]
    {
        get
        {
            return TToKMap[obj];
        }
    }

    public T this[K obj]
    {
        get
        {
            return KToTMap[obj];
        }
    }

    public IEnumerator<T> GetEnumerator()
    {
        return KToTMap.Values.GetEnumerator();
    }

    public T Current
    {
        get { throw new NotImplementedException(); }
    }

    public void Dispose()
    {
        throw new NotImplementedException();
    }

    object System.Collections.IEnumerator.Current
    {
        get { throw new NotImplementedException(); }
    }

    public bool MoveNext()
    {
        ;
    }

    public void Reset()
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-10T13:23:34.820

首先，不要让你的集合对象实现 IEnumerator<>。这会导致错误。（考虑两个线程在同一个集合上迭代的情况）。

正确实现枚举器并非易事，因此 C# 2.0 基于 'yield return' 语句添加了特殊语言支持。

Raymond Chen 最近的一系列博客文章（“C# 中迭代​​器的实现及其后果”）是一个了解速度的好地方。

*   第 1 部分：[https ://web.archive.org/web/20081216071723/http://blogs.msdn.com/oldnewthing/archive/2008/08/12/8849519.aspx](https://web.archive.org/web/20081216071723/http://blogs.msdn.com/oldnewthing/archive/2008/08/12/8849519.aspx)
*   第 2 部分：[https ://web.archive.org/web/20080907004812/http://blogs.msdn.com/oldnewthing/archive/2008/08/13/8854601.aspx](https://web.archive.org/web/20080907004812/http://blogs.msdn.com/oldnewthing/archive/2008/08/13/8854601.aspx)
*   第 3 部分：[https ://web.archive.org/web/20080824210655/http://blogs.msdn.com/oldnewthing/archive/2008/08/14/8862242.aspx](https://web.archive.org/web/20080824210655/http://blogs.msdn.com/oldnewthing/archive/2008/08/14/8862242.aspx)
*   第 4 部分：[https ://web.archive.org/web/20090207130506/http://blogs.msdn.com/oldnewthing/archive/2008/08/15/8868267.aspx](https://web.archive.org/web/20090207130506/http://blogs.msdn.com/oldnewthing/archive/2008/08/15/8868267.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-10T13:12:34.440

只需实现`IEnumerable<T>`接口。除非您想在枚举器中做一些特殊的事情，否则无需实现`IEnumerator<T>`，这对于您的情况似乎不需要。

```
public class Mapper<K,T> : IEnumerable<T> {
    public IEnumerator<T> GetEnumerator()
    {
        return KToTMap.Values.GetEnumerator();
    }
} 
```

就是这样。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-21T10:22:03.577

`CreateEnumerable()`返回一个`IEnumerable`实现`GetEnumerator()`

```
public class EasyEnumerable : IEnumerable<int> {

    IEnumerable<int> CreateEnumerable() {
        yield return 123;
        yield return 456;
        for (int i = 0; i < 6; i++) {
            yield return i;
        }//for
    }//method

    public IEnumerator<int> GetEnumerator() {
        return CreateEnumerable().GetEnumerator();
    }//method

    IEnumerator IEnumerable.GetEnumerator() {
        return CreateEnumerable().GetEnumerator();
    }//method

}//class 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-10T13:08:30.707

使用收益回报。

[C# 中使用的 yield 关键字是什么？](https://stackoverflow.com/questions/39476/what-is-the-yield-keyword-used-for-in-c#39496)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-03T08:31:10.590

这是 Robert Sedgewick 的“算法（第 4 版）”一书中的一个示例。

它是用java编写的，我基本上用C#重写了它。

```
public class Stack<T> : IEnumerable<T>
{
    private T[] array;

    public Stack(int n)
    {
        array = new T[n];
    }

    public Stack()
    {
        array = new T[16];
    }

    public void Push(T item)
    {
        if (Count == array.Length)
        {
            Grow(array.Length * 2);
        }

        array[Count++] = item;
    }

    public T Pop()
    {
        if (Count == array.Length/4)
        {
            Shrink(array.Length/2);
        }

        return array[--Count];
    }

    private void Grow(int size)
    {
        var temp = array;
        array = new T[size];
        Array.Copy(temp, array, temp.Length);
    }

    private void Shrink(int size)
    {
        Array temp = array;
        array = new T[size];
        Array.Copy(temp,0,array,0,size);
    }

    public int Count { get; private set; }
    public IEnumerator<T> GetEnumerator()
    {
        return new ReverseArrayIterator(Count,array);
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    // IEnumerator implementation
    private class ReverseArrayIterator : IEnumerator<T>
    {
        private int i;

        private readonly T[] array;

        public ReverseArrayIterator(int count,T[] array)
        {
            i = count;
            this.array = array;
        }

        public void Dispose()
        {

        }

        public bool MoveNext()
        {
            return i > 0;
        }

        public void Reset()
        {

        }

        public T Current { get { return array[--i]; } }

        object IEnumerator.Current
        {
            get { return Current; }
        }
    }
} 
```

# apache-flex - 直接链接到 SWF，有什么缺点？

> ID：53989
> 
> 赞同：8
> 
> 时间：2008-09-10T13:09:32.153
> 
> 标签：apache-flex, flash, embed

`object`通常，Flash 和 Flex 应用程序使用和标记的组合嵌入到 HTML 中`embed`，或者更常见的是使用 JavaScript。但是，如果您直接链接到 SWF 文件，它将在浏览器窗口中打开，并且不查看地址栏，您无法判断它没有嵌入到 HTML 中，其大小设置为 100% 宽度和高度。

考虑到嵌入 Flash 或 Flex 应用程序 100% 填充浏览器窗口所需的 HTML、CSS 和 JavaScript 开销，直接链接到 SWF 文件的缺点是什么？有什么好处？

我能想到一个好处和三个坏处：你不需要 100 多行 HTML、JavaScript 和 CSS，但你没有插件检测，没有版本检查，你失去了最好的 SEO 选项（渐进增强）。

*更新*不要挂在 100 多行上，我的意思是嵌入 SWF 所需的代码量相当多（我的意思是包括 SWFObject 之类的库），它只是用于显示 SWF，它可以通过直接链接到它而无需单行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-20T19:02:21.760

直接链接到 SWF 文件的好处：

*   更快的访问
*   甚至在您点击链接之前，您就知道这是一部 Flash 电影
*   跳过 html 和 js 文件（无论如何你都不会使用 CSS 来显示 100% flash 电影）

缺点：

*   您几乎无法控制电影默认设置。
*   您不能使用自定义背景颜色、透明度等。
*   您不能使用 flashVars 从 HTML 向电影发送数据
*   不能使用 fscommand 从电影到页面
*   电影比例永远不会与用户窗口的纵横比相同
*   你无法弥补浏览器的不竞争力（下一个新的浏览器出来了，你有麻烦了）
*   没有搜索引擎优化
*   没有页面标题，如果您希望人们正确添加书签，那就太糟糕了。
*   没有插件信息，下载链接等。
*   如果您的 SWF 连接到外部数据源，您可能会遇到跨域问题。
*   重命名 SWF 文件也会重命名链接。不利于版本控制。

简而言之，对于复杂的应用程序 - 始终使用 HTML。对于一个简单的动画电影，你可以去任何一种方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-10T13:14:39.117

您也会失去对 SWF 的外部控制。当它嵌入 HTML 时，您可以使用 javascript 与 SWF 进行通信。如果直接加载 SWF，这可能是不可能的。

您的 100 多行报价对我来说似乎很高。FlashDevelop 为嵌入 SWF 生成的 HTML 只有大约 35 行，包含一个 swfobject.js 文件。您不需要触摸 js 文件，最多只需要以非常小的方式调整 HTML 即可使其执行您想要的操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-10T14:08:17.443

根据我的经验，并非所有浏览器都能正确处理此问题。我不太确定为什么（或哪些浏览器），但我有时会错误地将这样的链接发送给客户，他们经常会感到困惑。我怀疑他们的浏览器会提示他们下载文件而不是正确显示它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-10T14:17:08.810

我能想到的一个好处是能够在指向 SWF 的直接 URL 中指定 GET 参数，然后这些参数将在 Flash 应用程序中可用（通过`Application.application.parameters`在 Flex 中，不确定如何在 Flash CS3 中访问它们）。如果你有一个 HTML 包装器，当然也可以通过其他方式来实现，但这样工作量就更少了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-10T13:14:25.560

为什么需要 100 多行代码？使用类似[swfobject 的](http://code.google.com/p/swfobject/)东西可以减少很多（而且通常你不想手动进行插件检测等）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-11T17:19:20.613

更多优势：

1.  轻巧的外观，因为您可以使用似乎堆积在那里的所有工具栏摆脱标题，甚至不需要滚动条。当您试图在短时间内展示大量动作时，这会增强效果。
2.  最重要的是：您可以将它放在一个窗口中，您可以将其拖得更大或更小，并使电影变得越来越小。播放器将调整电影的大小以填满您拥有的窗口。这对于每个人都想放大以找到自己和他们的朋友的集体照片之类的东西非常有用。我已经为单帧 Flash 制作完成了此操作！

Downsides: As with popups in general, if you are asking for multiple ones from the same site, and you want different size popups, the browsers tend to simply override the size you ask for in window.open and reuse whatever is up. You need to close any open popup so the window.open will do a fresh create. It gets complicated, and I have not been able to get it to work across pages in a website. Anyone who has done this successfully, pls post how!

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-01T08:56:27.780

Adobe 应该为自己的标准嵌入感到羞耻，这违背了约定优于配置的原则。检查 ^swfobject（如上所述）或[swfin](http://code.google.com/p/swfin/)

# python - Google App Engine 应用程序有什么好的 AJAX 框架吗？

> ID：53997
> 
> 赞同：14
> 
> 时间：2008-09-10T13:12:07.267
> 
> 标签：python, ajax, google-app-engine

我正在尝试在我的 Google App Engine 应用程序中实现 AJAX，因此我正在寻找一个可以帮助我的优秀 AJAX 框架。有人有什么想法吗？

我正在考虑 Google Web Toolkit，它在为 Google App Engine 创建 AJAX 方面有多好？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-10T13:14:54.653

由于 Google Web Toolkit 是 Java 的一个[子集，](http://code.google.com/support/bin/answer.py?answer=54830&topic=10208)因此在后端使用 Java 时效果最好。由于 Google App Engine 目前[只有 Python](http://code.google.com/appengine/kb/general.html#language)，我认为您必须做很多事情才能让您的服务器和客户端能够很好地相互通信。

jQuery 似乎是[DjangoSnippets.com 的 AJAX 标记中](http://www.djangosnippets.org/tags/ajax/?page=1)最流行的 JavaScript 库选项。

**编辑：**以上仅适用于用 Python 编写的 Google App Engine 应用程序。由于 Google App Engine 现在支持 Java，GWT 现在可能是编写 AJAX 前端的不错选择。 [谷歌甚至有一个教程向你展示如何做到这一点。](http://code.google.com/webtoolkit/doc/latest/tutorial/appengine.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-28T22:08:08.883

使用 AJAX 库的一个好方法是利用[Google 的 AJAX 库 API 服务](http://code.google.com/apis/ajaxlibs/)。这比下载 JS 并将其放在您的`/static/`文件夹中并且不会占用您的磁盘配额更快和更清洁。

在您的 javascript 中，您只需输入，例如：

```
google.load("jquery", "1.3.2"); 
```

和/或

```
google.load(google.load("dojo", "1.3.0"); 
```

在你的标题中的某个地方，你会放一些类似的东西：

```
<script src="http://www.google.com/jsapi?key=your-key-here"></script> 
```

这就是使用 Google 的 API 库所需的全部内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-10T19:00:38.550

没有理由不将 GAE 和 Google Web Toolkit (GWT) 一起使用。你用 Python 编写后端代码，用 Java（可能还有一些 JavaScript）编写前端代码，然后将其编译为 JavaScript。当使用另一个 AJAX 框架时，服务器端和客户端语言之间也会存在这种差异。

GWT 具有使远程调用服务器上的 java 代码更容易的特性，但这些特性完全是可选的。您可以只使用 JSON 或 XML 接口，就像使用其他 AJAX 框架一样。

GWT 1.5 还带有 JavaScript 覆盖类型，基本上允许您在开发客户端代码时将一段 JSON 数据视为 Java 对象。[您可以在此处](http://googlewebtoolkit.blogspot.com/2008/08/getting-to-really-know-gwt-part-2.html)阅读有关此内容的更多信息。

**更新：**

现在 Google 已经为 Google App Engine 添加了 Java 支持，如果您愿意，您可以在完整的 Google 堆栈上使用 Java 开发后端和前端代码。Google 提供了一个不错的[Eclipse 插件](http://code.google.com/eclipse/)，可以非常轻松地开发和部署使用 GAE、GWT 或两者兼有的应用程序。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T04:56:35.883

以下是我们在 Google App Engine 上实现 Ajax 的方式，但这个想法可以推广到其他平台。

我们有一个用于 Ajax 请求的处理程序脚本，该脚本主要使用 JSON 响应进行响应。结构看起来像这样（这是标准 GAE 处理程序脚本的摘录）：

```
def Get(self, user):
    self.handleRequest()

def Post(self, user):
    self.handleRequest()

def handleRequest(self):        
    '''
    A dictionary that maps an operation name to a command.
    aka: a dispatcher map.
    '''
    operationMap = {'getfriends':               [GetFriendsCommand],
                    'requestfriend':            [RequestFriendCommand, [self.request.get('id')]],
                    'confirmfriend':            [ConfirmFriendCommand, [self.request.get('id')]],
                    'ignorefriendrequest':      [IgnoreFriendRequestCommand, [self.request.get('id')]],
                    'deletefriend':             [DeleteFriendCommand, [self.request.get('id')]]}

    # Delegate the request to the matching command class here. 
```

这些命令是命令模式的简单实现：

```
class Command():
    """ A simple command pattern.
    """
    _valid = False
    def validate(self):
        """ Validates input. Sanitize user input here.
        """
        self._valid = True

    def _do_execute(self):
        """ Executes the command. 
            Override this in subclasses.
        """
        pass

    @property
    def valid(self):
        return self._valid

    def execute(self):
        """ Override _do_execute rather than this.
        """ 
        try:
            self.validate()
        except:
            raise
        return self._do_execute()

    # Make it easy to invoke commands:
    # So command() is equivalent to command.execute()
    __call__ = execute 
```

在客户端，我们创建了一个 Ajax 委托。Prototype.js 使这很容易编写和理解。这是一段摘录：

```
/** 
 * Ajax API
 *
 * You should create a new instance for every call.
 */
var AjaxAPI = Class.create({
    /* Service URL */
    url: HOME_PATH+"ajax/",

    /* Function to call on results */
    resultCallback: null,

    /* Function to call on faults. Implementation not shown */
    faultCallback: null,

    /* Constructor/Initializer */
    initialize: function(resultCallback, faultCallback){
        this.resultCallback = resultCallback;
        this.faultCallback = faultCallback;
    },

    requestFriend: function(friendId){
        return new Ajax.Request(this.url + '?op=requestFriend', 
        {method: 'post',
         parameters: {'id': friendId},
         onComplete: this.resultCallback
        });     
    },

    getFriends: function(){
        return new Ajax.Request(this.url + '?op=getfriends', 
        {method: 'get',
         onComplete: this.resultCallback
        });    
    }

}); 
```

要调用代表，您可以执行以下操作：

```
new AjaxApi(resultHandlerFunction, faultHandlerFunction).getFriends() 
```

我希望这有帮助！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-10T13:19:51.037

我建议为您的客户端代码研究一个纯 javascript 框架（可能是 Jquery），并在 python 中编写 JSON 服务——这似乎是最简单/最好的方法。

Google Web Toolkit 允许您用 Java 编写 UI 并将其编译为 javascript。正如 Dave 所说，后端使用 Java 可能是一个更好的选择，因为它有很好的 RPC 挂钩。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-09T08:33:51.493

您可能想看看睡衣 ( [http://pyjs.org/](http://pyjs.org/) )，它是“GWT for Python”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-15T08:12:29.473

也尝试[GQuery 的 GWT](http://ajaxian.com/archives/gquery-java-gwt-and-jquery-together)。这是Java代码：

```
public void onModuleLoad() { 
    $("div").css("color", "red").click(new Function() { 
        public void f(Element e) { 
            Window.alert("Hello"); 
            $(e).as(Effects).fadeOut(); 
        } 
    }); 
} 
```

作为 Java 代码导致编译时（Java->JavaScript）优化和重构更容易。

不错，不是吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-10T13:29:54.383

jQuery 是一个很好的库，还可以查看[Prototype JavaScript 框架](http://www.prototypejs.org/)。它确实将 JavaScript 从一种偶尔尴尬的语言变成了一种美丽而优雅的语言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-15T13:43:08.913

如果您希望能够调用从 JavaScript 到 Python 的方法调用，[JSON-RPC](http://json-rpc.org/wiki/python-json-rpc)可以很好地与 Google App Engine 配合使用。有关详细信息，请参阅 Google 的文章“[使用 AJAX 启用客户端 RPC 请求](http://code.google.com/appengine/articles/rpc.html)”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-23T16:41:43.040

我目前正在为我的 GAE 应用程序使用 JQuery，它对我来说效果很好。我有一个动态图表（谷歌图表），它使用 Ajax 调用来获取 JSON 字符串。它对我来说似乎真的很好用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-28T22:17:55.163

Google 最近发布了 Google App Engine 的 Java 版本。此版本还提供了一个 Eclipse 插件，可以更轻松地使用 GWT 开发 GAE 应用程序。

在此处查看详细信息：[http ://code.google.com/appengine/docs/java/overview.html](http://code.google.com/appengine/docs/java/overview.html)

当然，这需要你用 Java 而不是 python 重写你的应用程序，但是作为一个使用过 GWT 的人，让我告诉你，在你的 AJAX 代码库上使用现代 IDE 的优势是完全值得的。*******************