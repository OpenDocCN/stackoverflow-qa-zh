# StackOverflow 问答 000732000-000732999

# arrays - 匹配数组和函数语法

> ID：732002
> 
> 赞同：1
> 
> 时间：2009-04-08T21:46:02.813
> 
> 标签：arrays, programming-languages, syntax, function

因此，从黑盒的角度来看，数组和函数背后的想法非常相似。您传入输入值并检索输出值。那么保持数组语法和函数语法相同更好还是有差异更好？

例如

> 打印数组[0]
> 
> 打印函数（0）

相对

> 打印数组（0）
> 
> 打印函数（0）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T21:48:53.913

从技术上讲你是对的，它们都是映射，但在大多数程序员的头脑中存在区别：数组存储它们的值，而函数计算它们的值。换句话说，（简单地说）数组针对速度进行了优化，函数针对内存进行了优化。我认为这是一个很好的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T21:57:28.183

Ruby 做了一些合并 - 方法`()`使用`[]`. 与ducktyping一起，这意味着您可以传递一个对象，并传递它的值，`[]`而不关心它是预先计算的（一个数组），每次计算（一个lambda表达式），还是根据需要计算和缓存（可以用哈希）。

将两者混为一谈的另一个例子是 Haskell。我记得它没有内置到语言中的数组语法 - 访问数组索引是一个函数调用，可以像任何其他函数一样使用。

实际上我更喜欢合并 - 它允许更容易的灵活性（我喜欢）。知道你是在优化速度还是内存（就像大卫说的那样）很高兴知道，但我愿意自己承担这个责任，而不是把它留给语言内置的提示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T22:00:06.007

好吧，我认为传统上，这来自 C/Algol 语法，其中 [] 直接转换为内存偏移量，而 () 是一个更复杂的过程。

在一些较新的语言中，[] 是原始数据结构的通用索引，例如，Js 中的哈希通过以下方式访问：

```
hash["Hello"];
array[0]; 
```

我认为保持“索引”语法与“参数”语法不同是很有用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T22:42:41.880

你是绝对正确的。数组，还有地图和字典，甚至可以说是对象，本质上都是数学意义上的函数。实际上，有些语言将数组视为整数的函数，将映射和字典视为键的函数，将对象视为槽的函数。其中两种语言是[Scala](http://Scala-Lang.Org/)和[Clojure](http://Clojure.Org/data_structures#toc15)。

# visual-studio-2008 - VS2008 - 除了 PocketPC 2003 平台之外没有可用的控件

> ID：732006
> 
> 赞同：2
> 
> 时间：2009-04-08T21:46:41.453
> 
> 标签：visual-studio-2008, windows-mobile

我正在尝试创建我的第一个 Windows Mobile 应用程序。

我正在使用 Visual Studio 2008。如果我选​​择平台“Pocket PC 2003”并转到表单视图，我会得到一长串设备控件（例如按钮、复选框、组合框等）。

但是，如果我将目标平台（项目 | 更改目标平台）更改为“Windows Mobile 6 Professional SDK”，我将无法获得这些控件。

它是 Mobile Professional 6 SDK（更新版）的全新安装。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-06T09:08:25.900

我刚刚在我的 Visual Stuidio 2008 副本上尝试了相同的过程并获得了正确的结果（工具箱显示）。:-\

听起来 SDK 的安装没有正确完成。

以下是一些可能有用的链接：http: [//mobiledeveloper.wordpress.com/2007/05/24/windows-mobile-6-sdk-gives-empty-toolbox-in-visual-studio/](http://mobiledeveloper.wordpress.com/2007/05/24/windows-mobile-6-sdk-gives-empty-toolbox-in-visual-studio/)

[http://weimenglee.blogspot.com/2007/12/tip-missing-controls-in-toolbox-visual.html](http://weimenglee.blogspot.com/2007/12/tip-missing-controls-in-toolbox-visual.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T14:02:30.230

会不会是你遇到了这个问题？
[http://weimenglee.blogspot.com/2007/12/tip-missing-controls-in-toolbox-visual.html](http://weimenglee.blogspot.com/2007/12/tip-missing-controls-in-toolbox-visual.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T19:49:40.187

还记得在测试您的网站后停止调试吗？

我认为`SHIFT`+`F5`是快捷方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-08T22:22:33.513

尝试几件事可能会对面临类似问题的任何人有所帮助：

1.  右键单击 Visual Studio 中的工具箱，然后单击“全部显示”。这应该显示所有可用的控件。
2.  如果这不起作用，请右键单击工具箱，然后单击“选择项目”。这应该向您显示所有可用的平台和控件，您可以从中进行选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T22:24:17.120

是不是切换平台时“工具箱”打不开这么简单？

尝试查看->工具箱，看看是否得到列表，Ctrl+Alt+X 是快捷方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-16T14:27:08.897

我遇到了同样的问题，并且能够使用以下运行命令来缓解它。

devenv.exe /setup /resetuserdata

您失去了一些偏好，但您可以实际使用工具箱！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-03T15:30:03.567

我有与“techboy”完全相同的问题尝试删除 toolbox.tbl 等，同样的问题，然后我尝试了

cmd /c 启动 /wait devenv /setup /resetuserdata /selfreg /resetskippkgs

如此处建议：http: //connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID= [322223](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=322223)

我似乎有一些 sql08 紧凑问题

# javascript - 在客户端填写表单 [Javascript]

> ID：732008
> 
> 赞同：0
> 
> 时间：2009-04-08T21:47:17.210
> 
> 标签：javascript, windows-desktop-gadgets

我正在为我们基于 Web 的员工日程安排系统编写一个小的 Vista/7 侧边栏小工具，我遇到了我的 Google-FU 无法解决的 Javascript 问题。我不知道如何从客户端填写登录表单。

我正在创建一个新的 ActiveXObject，导航到该站点，但不知道从这里去哪里。

```
var conn = new ActiveXObject("Microsoft.XMLHTTP");
conn.open("POST", "url", false);
conn.send(null); 
```

是否可以根据表单 id 从 ActiveXObject 访问表单？我还假设我需要为 POST 和 GET 更改一些标题？

感谢您提供任何提示或参考链接！我似乎找不到太多东西，JavaScript 也不是我的强项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T22:02:08.280

“导航到站点”是浏览器所做的事情，如果这确实是您想要的，那么您不需要 XMLHTTP 对象，而是需要浏览器引擎。（IE 暴露为 COM。）

如果您想要将某些内容发布到 URL，那么您就在正确的轨道上。您需要做的是实际发送数据（例如表单）而不是 null。我建议获取 Fiddler（谷歌它）并从常规浏览器监视呼叫。我也听说 Firebug 也能正常工作。使用这些工具中的任何一个，您都可以查看浏览器发送到服务器的内容，复制并发送它而不是 null。

# regex - 如何用'，'分割字符串，除非'，'使用正则表达式在括号内？

> ID：732029
> 
> 赞同：11
> 
> 时间：2009-04-08T21:53:49.330
> 
> 标签：regex, string

编辑：任何人都可以用正则表达式来帮助我解决这样的字符串吗？：

`[Header 1], [Head,er 2], Header 3`

这样我就可以将其拆分为以下块：

`[Header 1]`
`[Head,er 2]`
`Header 3`

我已经做到了：

```
(?<=,|^).*?(?=,|$) 
```

这会给我：

`[Header 1]`
`[Head`
`,er 2]`
`Header 3`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-09T05:19:51.240

在这种情况下，分隔符（逗号）比匹配标记（或块）更容易。识别作为分隔符的逗号需要一个相对简单的前瞻：

```
,(?=[^\]]*(?:\[|$)) 
```

每次找到逗号时，都会对三件事中的一件进行前瞻。如果您首先找到右方括号，则逗号位于一对括号内，因此它不是分隔符。如果您找到一个左括号或行/字符串的结尾，它是一个分隔符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T22:01:45.303

```
\[.*?\] 
```

忘记逗号，你不关心它们。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T21:58:48.040

之前已经讨论过这个问题的变体。

例如：

*   [正则表达式替换字符串中的所有 \n，但没有 [code] [/code] 标记内的那些](https://stackoverflow.com/questions/328387/regex-to-replace-all-n-in-a-string-but-no-those-inside-code-code-tag)

简短的回答：正则表达式可能不是正确的工具。编写一个适当的解析器。FSM 实现很*容易*。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T22:01:42.493

```
 (?<=,|^)\s*\[[^]]*\]\s*(?=,|$) 
```

使用`[`和`]`定界符对您有利

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T22:01:27.237

不是这么简单吗？

```
(?<=,|^)(?:[^,]|\[[^[]*\])* 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T22:08:42.320

您可以使用正则表达式来匹配括号内的值：

```
\[[^\]*]\] 
```

或者您使用这个正则表达式来拆分括号列表（使用环视断言）：

```
(?<=]|^)\s*,\s*(?=\[|$) 
```

# amazon-s3 - 亚马逊的“云”服务是否可以作为网络托管选项？

> ID：732033
> 
> 赞同：1
> 
> 时间：2009-04-08T21:55:06.533
> 
> 标签：amazon-s3, web-hosting, cloud

我是与 Amazon S3 相关的新闻的忠实追随者。它似乎是可靠的、可扩展的和廉价的服务。

然而，网络主机似乎并不过分害怕。自从亚马逊和谷歌发布基于“云”的平台以来，我没有注意到价格有任何大幅下降。

是否有一个原因？还是网络开发人员根本没有意识到亚马逊产品背后的可能性？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T22:01:51.497

Amazon S3 是一种文件存储服务，您不能在其上运行动态站点。

Amazon EC2 是一种 VPS 服务，需要系统管理知识，而且价格更高。

Google App Engine 不提供关系数据库。

典型的经典（共享）网络主机客户不能在其中任何一个上运行 phpBB。我想这就是他们不会过度害怕的原因。然而。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-08T22:42:35.297

S3 和 EC2 提供的服务与典型的 Web 托管包略有不同。

*   S3 - 简单存储服务，用于可扩展的文件存储
*   EC2 - 弹性计算云，用于可扩展的计算资源

您可能会看到广告中的典型*无限*网络托管是针对具有相当基本需求的用户销售的。电子邮件、博客托管、论坛等。

EC2 通常面向需要按需扩展的更高级用户。典型的案例可能是假日购物季期间的电子商务网站，甚至是锦标赛期间的大师赛（高尔夫）网站。使用 EC2，在高峰时段扩展计算资源以满足这些需求，然后在非高峰时段回退可能非常划算。

我通常将 EC2 等同于专用服务器托管包的竞争对手。您可能看不到价格下降，因为许多成本是固定的。（机架空间、设备成本、电力、冷却等）亚马逊在您预留资源时分配虚拟机，这意味着他们通过虚拟化硬件绕过了许多这些物理限制。

就个人而言，我相信由于虚拟化带来的优势，我们将开始看到许多主机向云的重大转变。

看：

*   [乔伊恩特](http://www.joyent.us)
*   [切片主机](http://slicehost.com)
*   [天蓝色](http://www.microsoft.com/azure/)
*   [莫索](http://www.mosso.com)
*   等等等等

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T22:35:10.493

我已经使用 S3 和 EC2 有一段时间了，而且可能性非常大。想象一下，您有一个可能会吸引数百万访问者的应用程序的想法。使用传统托管，您必须进行相当多的前期投资才能获得可以处理所有这些潜在访问者的硬件。但是，如果这些访客永远不会来怎么办？EC2、[Slicehost](http://www.slicehost.com)、[Rackspace](http://www.rackspace.com)等服务可让您轻松扩展或缩减。这是非常强大的，你可以想象。

我认为传统的托管公司仍然有点否认。他们在硬件和基础设施方面进行了大量投资，但他们的投资并没有像亚马逊和谷歌这样的大公司那样接近。我认为这个云计算真的会在未来几年内流行起来，因为从技术的角度来看，它只是下一层抽象。

# java - 在 Java 中获取“unixtime”

> ID：732034
> 
> 赞同：287
> 
> 时间：2009-04-08T21:55:25.957
> 
> 标签：java, unix-timestamp

Date.getTime() 返回自 1970 年 1 月 1 日以来的毫秒数。Unixtime 是自 1970 年 1 月 1 日以来的秒数。我通常不使用 java 编码，但我正在修复一些错误。我有：

```
Date now = new Date();      
Long longTime = new Long(now.getTime()/1000);
return longTime.intValue(); 
```

有没有更好的方法在java中获取unixtime？

* * *

## 回答 #1

> 赞同：514
> 
> 时间：2009-04-08T21:58:38.820

[避免使用System.currentTimeMillis()](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/System.html#currentTimeMillis())创建 Date 对象。除以 1000 即可进入 Unix 纪元。

正如评论中提到的，对于 unixTime 变量的类型，您通常需要一个原始 long（小写-l long）而不是装箱对象 long（大写-L Long）。

```
long unixTime = System.currentTimeMillis() / 1000L; 
```

* * *

## 回答 #2

> 赞同：298
> 
> 时间：2014-07-11T17:44:30.743

Java 8 添加了一个用于处理日期和时间的新 API。使用 Java 8，您可以使用

```
import java.time.Instant
...
long unixTimestamp = Instant.now().getEpochSecond(); 
```

`Instant.now()`返回一个表示当前系统时间的[Instant 。](http://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)随着`getEpochSecond()`您从`Instant`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-14T09:39:53.763

已经有两个很好的答案。在新副本的情况下，我在两个方向上更深入地潜水：

1.  在 Java 7 上做什么？
2.  如何编写可测试的版本？

## 对于 Java 7

如果您仍在使用 Java 7，您仍然可以选择要使用的其他答案中的哪一个。Micha 提到 java.time 是在 Java 8 中引入的。但 java.time 也已在 ThreeTen Backport 中向后移植到 Java 6 和*7*。获取 Unix 时间戳可能看起来有点过分，但是如果你在你的程序中做更多的日期和时间工作，我仍然认为你应该考虑它。底部有链接。

在您自己的代码中除以 1000 似乎是一件非常小的事情。我仍然养成*了将尽可能多的日期和时间工作留给*标准库的习惯，最好是 java.time。还有很多其他情况，转换似乎很容易，但很容易出错。所以我不想在我的代码中做它们。所以我的纯 Java 7 解决方案（没有外部库/backport）可能看起来像这样：

```
 long unixTime = TimeUnit.MILLISECONDS.toSeconds(System.currentTimeMillis());
    System.out.println(unixTime); 
```

> 1636883947

现在我还要告诉读者我*为什么*要除以 1000。虽然代码有点长，但它也更加不言自明。

## 更可测试

java.time 还为 Java 7 和 8 及更高版本提供了可测试的解决方案。我们可以注入一个`Clock`当前时间的来源。

```
 Clock clock = Clock.systemUTC();
    long unixTime = Instant.now(clock).getEpochSecond();
    System.out.println(unixTime); 
```

刚才的输出：

> 1636882578

（我使用 ThreeTen Backport 1.3.6 在 Java 1.7.0_67 上运行它。）

在您需要控制用于可重现结果的时间的测试中，例如获取具有固定时间的时钟：

```
 Clock clock = Clock.fixed(Instant.ofEpochSecond(1_635_936_963), ZoneOffset.UTC); 
```

现在代码的输出是我们指定的时间：

> 1635936963

如果你想要的`Clock`只是`Instant`s，因为 Java 17 不再使用`Clock`. 使用`InstantSource`.

```
 InstantSource instantSource 
            = InstantSource.fixed(Instant.ofEpochSecond(1_654_321_098));
    long unixTime = instantSource.instant().getEpochSecond(); 
```

> 1654321098

## 链接

*   重复问题[如何在 java 中获取当前的长时间戳值，例如 1635936963 [重复]](https://stackoverflow.com/questions/69961434/how-to-get-the-current-long-timestamp-value-in-java-like-1635936963)询问 Java 7。
*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。
*   [Java 规范请求 (JSR) 310](https://jcp.org/en/jsr/detail?id=310)，`java.time`第一次描述的地方。
*   [ThreeTen Backport 项目](http://www.threeten.org/threetenbp/)，`java.time`Java 6 和 7 的反向移植（ThreeTen for JSR-310）。
*   [可通过脱糖获得 Java 8+ API](https://developer.android.com/studio/write/java8-support-table)
*   问题[如何测试使用 LocalDateTime.now() 创建的日期](https://stackoverflow.com/questions/39527752/how-to-test-date-created-with-localdatetime-now)

# excel - 验证下拉条件

> ID：732038
> 
> 赞同：1
> 
> 时间：2009-04-08T21:57:00.743
> 
> 标签：excel, excel-2003, excel-formula

写我的想法有点令人困惑，但我会试一试。这是我能做的。我的垂直单元格上有一个下拉列表，因此我有一个名称列表可供选择，这些名称由 [name]-> [define] 和 [data] -> [validation] 链接。我想要的是另一个垂直单元格来填充另一个下拉列表，具体取决于第一个的条件。

例如，我有一份水果和蔬菜的清单。我的第一个下拉菜单询问类型，所以我选择水果。由于这样的选择，我的第二个下拉菜单只会给我一个水果列表（没有蔬菜），反之亦然。+

非常感谢您的帮助。

谢谢帮！

* * *

如果我想命名单元格而不是蔬菜，但 2009 和水果 2010 会出现错误。有办法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T23:39:40.497

让我们使用一些命名范围。

名称 E7“选项”

将“蔬菜”放入E4，将“水果”放入E5；

在 E7 中，数据 > 验证 > 列表，源 $E$4:$E$5；

将一些蔬菜放入H4：H7；将该范围命名为“蔬菜”；

将一些水果放入J4:J7；将该范围命名为“水果”；

现在，在 E8 中：数据 > 验证 > 列表，来源“=INDIRECT(option)”。

当您在 E7 中做出选择时，E8 的选项会相应设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T23:16:35.933

这是我的代码，可以完全按照您的要求进行操作。

我已将独立列定义为命名范围`Major_Category`，并将下拉验证设置为数据列表。然后，我有几个其他名为 的数据列表`cat_subItems`。因此，对于您的示例，主要类别将包含项目

*   水果
*   蔬菜

然后我定义了更多的列表，称为

*   猫果
*   cat_vegetable

其中将包含水果或蔬菜的名称。然后根据*主要类别*选择，Worksheet_change 事件会将下一列中的下拉验证更改为`cat_fruit`或`cat_vegetable`。

**注意：**如果您使用的是 excel 的保护工作表，则此代码效果不佳。请参阅[此问题](https://stackoverflow.com/questions/445519/how-do-i-avoid-run-time-error-when-a-worksheet-is-protected-in-ms-excel)以处理 Excel 的工作表/书籍保护。

```
Public Sub Worksheet_Change(ByVal target As Range)
On Error GoTo ErrHandler:

Dim VRange As Range, cell As Range
Dim msg As String
Dim validateCode As Variant
Dim modCell As Range
Set VRange = Range("Major_Category")

If Intersect(VRange, target) Is Nothing Then Exit Sub

For Each cell In Intersect(VRange, target)
    b = cell.Value
    curRow = target.Row

    Set modCell = cell.Offset(0, 1) 'cell to modify the validation'

    If Not (b = "") Then
        modCell.Validation.Delete
        modCell.Validation.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _

        'sets the validation formula to the list/range name'
        xlBetween, Formula1:="=cat_" & b 

        modCell.Validation.IgnoreBlank = True
        modCell.Validation.InCellDropdown = True
        modCell.Validation.InputTitle = ""
        modCell.Validation.ErrorTitle = ""
        modCell.Validation.ErrorMessage = ""
        modCell.Validation.ShowInput = True
        modCell.Validation.ShowError = True

    End If
Next cell

Cleanup:

Exit Sub

ErrHandler:
MsgBox Err, vbOKOnly, "Error Occurred"
Resume Cleanup:

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T19:52:02.257

您不能将范围命名为“2009” - 因为 Excel 无法将其与整数值 2009 区分开来。还有一些其他限制 - 您不能将范围命名为“A1”，因为 Excel 会与单元格混淆A1。您可以做的是将 2009 和 2010 放在一个表中，并在它们旁边放置范围的名称，然后执行 VLOOKUP 以获取范围名称。或者，您可以使用“_2009”并将您的公式设置为

=INDIRECT("_" & 选项)

# rsync - rsync'ing 两个远程服务器之间的文件，得到错误说明远程服务器上找不到 rsync 命令

> ID：732039
> 
> 赞同：10
> 
> 时间：2009-04-08T21:57:15.670
> 
> 标签：rsync

我正在尝试在两台服务器之间同步文件

```
rsync -avlzp /source user@server:/destination 
```

但相反，我收到错误说明

```
bash: rsync: command not found
rsync: connection unexpectedly closed (0 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at io.c(635) [sender=3.0.2] 
```

但 rsync***安装***在两台服务器上。我究竟做错了什么？我也试过

```
rsync -av -e "ssh -l ssh-user" /source server:/destination 
```

结果相同。

我主要是尝试使用 rsync 以便它只复制存在差异的差异......

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-08T22:00:51.777

当运行交互式 shell 时，rsync 可能在远程机器上的路径中，但在通过 ssh（使用非交互式 shell）运行 rsync 时不会。例如，.bashrc 通常只为交互式 shell 运行，因此如果在此处定义了路径，则`rsync --server`在远程端运行时将不会对其进行解析。试试 /etc/profile。有关详细信息，请参阅[bash(1) 。](http://linux.die.net/man/1/bash)

您可以使用[`--rsync-path`](http://www.samba.org/ftp/rsync/rsync.html)指定远程计算机上 rsync 二进制文件的路径。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-12-30T22:13:25.827

关于这个问题有很多很好的信息，包括上面的答案。但就我而言，我是源机器和目标机器的管理员，我希望了解发生了什么以及哪些“正确”的配置选项可以解决这个问题。我还没有完全成功，但其他人似乎可能会发现这些信息很有用。

正如上面的答案所述，当运行交互式 shell 时，rsync 可能位于远程机器上的路径中，但在通过 ssh 运行 rsync 时则不会。正如 Siddesh 在[http://siddesh-bg.blogspot.com/2009/02/rsync-command-not-found-error-even.html](http://siddesh-bg.blogspot.com/2009/02/rsync-command-not-found-error-even.html)中指出的那样，这可以通过从本地 shell 显式指定远程 rsync 的路径来解决：

```
rsync -av --rsync-path=/usr/local/bin/rsync -e "ssh -l ssh-user" /source server:/destination 
```

但作为管理员，我想解决问题，而不仅仅是解决问题。OldSchool 在[https://groups.google.com/group/comp.unix.solaris/browse_thread/thread/0a06a4d382d752d8?pli=1上发布了有用的故障排除方法](https://groups.google.com/group/comp.unix.solaris/browse_thread/thread/0a06a4d382d752d8?pli=1)

他建议你找出远程机器上正在为你运行的 shell，然后在那里建立了什么 PATH：

```
ssh user@host 'echo $SHELL' 
ssh user@host 'echo $PATH' 
```

Tom Feiner 在[为什么 SSH 远程命令获得的环境变量比手动运行时少？](https://stackoverflow.com/questions/216202/why-does-an-ssh-remote-command-get-fewer-environment-variables-then-when-run-man)讨论SSH命令执行shell的环境搭建。

OldSchool 还指出，“man sshd_config”提供了一些关于 ssh 会话如何获取环境的信息。sshd_config 设置“PermitUserEnvironment”可以设置为允许用户在服务器端的 ~/.ssh/environment 和 AuthorizedKeysFile 文件中的环境选项由 sshd 处理。默认为否。

因此，使用默认 sshd_config 设置，路径将由您的默认 shell 构建。如果您的 ssh 命令请求交互式会话 (ssh user@host)，那么在远程服务器上，默认 shell 将执行交互式登录，这可能会导致您期望的 PATH。但是，如果您正在为 rsync (rsync -av --rsync-path=/usr/local/bin/rsync -e "ssh -l ssh-user" /source server:/destination) 启动 ssh 会话，那么远程服务器会给出你是一个 SSH 命令执行 shell，它是一个非交互式 shell。在我的例子中，远程非交互式 shell (bash) 没有执行 /etc/profile，因为它只对交互式 shell 或带有 --login 选项的非交互式 shell 执行此操作。我可以这样强迫它：

```
ssh user@host 'echo $PATH;source /etc/profile;echo $PATH' 
```

我还研究了 Daniel Barrett 和 Richard Silverman 的“SSH The Secure Shell”（O'Reilly 2001）并在 /etc/ssh/sshrc 中设置了一个路径，我希望它可以使 rsync 可用于 SSH 命令执行 shell，但是 /etc/ssh /sshrc 在调用用户 shell 或命令之前执行，显然它的环境没有传递给该 shell 或命令。

在这一点上，我将对 rsync 命令行选项感到满意，即：

```
rsync -av --rsync-path=/usr/local/bin/rsync -e "ssh -l ssh-user" /source server:/destination 
```

因为我担心如果我更改 sshd_config 设置“PermitUserEnvironment”，那么我的服务器上的安全审核可能会失败。在我对我们组织的安全审计有了更多经验之后，我可能会重新审视这个问题。

# asp.net - ASP.NET 线程 + 设计问题

> ID：732041
> 
> 赞同：0
> 
> 时间：2009-04-08T21:57:54.000
> 
> 标签：asp.net, multithreading

我有一个应用程序，每次请求页面时都会对数据库执行写入操作。此数据库写入不是时间关键的，因此出于性能原因，我有页面使用 MSMQ 对对象进行排队。当然，我必须有一些东西来读取队列和处理请求，所以我编写了一个看起来类似于这样的类：

```
public class QueueProcessor {
    public void Start() 
    {
        // Create background thread to run ProcessInternal()
    }

    public void Stop() 
    {
        // Stop the previously created thread
    }

    public void ProcessInternal() 
    {
        while (runnable) 
        {
            // check queue for messages, process them one at a time, 
            // then wait indefinitely for more messages
        }
    } 
} 
```

现在，由于这个网站本质上是相当小的，我真的不想在部署例程中添加一个 Windows 服务，所以我此时正在做的是在 Application_Start 事件中创建一个新的 QueueProcessor 并启动它在那里。我的想法是线程将在应用程序的生命周期内运行，如果应用程序被 IIS 杀死，它只会在下次有人访问页面时重新启动。

为了防止由于应用程序已被 IIS 杀死而导致队列消息未处理的长时间空闲，我设置了一个 wget 请求，每隔几分钟在站点的一个页面上执行一次，从而使应用程序保持活动状态并确保后台运行线程将继续运行。

我的问题是，我不经常看到这种设计，我想知道它是否有任何潜在的问题？

编辑：

在对该主题进行了一些阅读之后，我发现这种方法（以及类似的方法，例如缓存删除回调函数）的主要问题是他们被要求在可伸缩性方面执行的函数类型。例如，如果您正在进行大规模更新或其他操作，您显然不希望该任务在您的所有 Web 服务器上运行 - 这样您将遇到更新冲突和潜在的数据丢失。

但是，在我非常特殊的情况下，该线程仅处理该服务器接收到的位于该服务器的消息队列中的请求。因此，如果我将此应用程序扩展为 5 个服务器，每个线程将毫无问题地处理每个服务器的排队消息。同样，数据库中记录的顺序并不是那么重要，以至于在很小的时间间隔内来自不同服务器的一些类似请求会是一个问题，所以我仍然认为这个解决方案对于我的问题是合理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T22:01:56.067

我相信设置 wget 请求并不比部署 Windows 服务容易得多。除此之外，我没有看到任何具体的问题。如果可靠性和准确的时间不重要，这将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T22:02:18.140

我在一些我毫无困难地维护的网站上使用了类似的方案。要注意的主要事情是确保正确捕获线程中的所有异常。您不希望线程在您不知情的情况下死去，然后在您的应用程序回收时再次静默重新启动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T22:55:00.400

虽然我不认为这是一个好主意，但 Jeff 和 Co.[似乎使用类似的黑客](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)技术来避免这个网站上的 Windows 服务（Joel 也为 FogBugz 做了）。由于规模和性能在这里得到了很好的证明 - 它确实看起来合理且可行。

# .net - 从托管应用程序调用的本机 DLL 的堆栈溢出

> ID：732054
> 
> 赞同：4
> 
> 时间：2009-04-08T22:01:01.543
> 
> 标签：.net, c, dll, windows-ce

当我调用本机 DLL 时，我的应用程序出现了臭名昭著的`0xC00000FD`（堆栈溢出）异常。这是通过 Windows CE 5（SH4 处理器）上的托管 C# 应用程序完成的。使用相同的托管应用程序为 Windows XP 编译相同的 DLL，一切正常（没有溢出）。DLL 中的例程正在执行一些非常复杂的递归，这最终是导致溢出的原因，但同样，它在 PC 上运行良好。

看起来我可能只需要在构建 DLL 时调整堆栈大小？我相信在使用 Visual C 编译器时，CE 和 XP 的默认堆栈大小都是 1MB（如果重要的话，我使用的是 Visual Studio 2005）。如果它们都默认为相同的大小，我不确定为什么一个会溢出而另一个不会溢出。我尝试使用 /F 编译器标志和 /STACK 链接器标志调整堆栈大小，但这似乎没有任何作用。我也不完全清楚我可以在 DLL 中指定堆栈大小，而是可执行文件必须设置它。但如果是这种情况，我将如何调整我的托管进程在调用本机 DLL 时使用的堆栈大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T22:19:35.027

这[是讨论](http://msdn.microsoft.com/en-us/library/aa450572.aspx)Windows CE 内存体系结构的链接。

最终，您几乎无法以编程方式或在编译时调整堆栈大小；操作系统将根据许多因素（包括内存可用性）对其进行更改。使用 /F 设置堆栈大小只会设置操作系统可以（并且通常会）忽略的默认值。无论如何，/F 对 .DLL 不起作用；它仅在编译可执行文件时有效。.DLL 没有堆栈；属于线程和（最终）属于进程。

可能是时候回到绘图板上删除递归了。

# php - 如何使用 PHP 为文本文件显示“另存为”对话框

> ID：732063
> 
> 赞同：8
> 
> 时间：2009-04-08T22:01:56.567
> 
> 标签：php, http, mime-types

如何使用 PHP 显示“另存为”对话框，该对话框会要求用户将字符串下载为文本文件？基本上我将从数据库中检索一些值，然后希望能够下载包含这些数据的 .txt 文件。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-08T22:05:50.237

这应该有效：

```
header('Content-type: text/plain');
header('Content-disposition: attachment; filename="test.txt"'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T22:22:52.723

只是为了扩展@Emil H的答案：

使用这些标头调用仅适用于新请求的上下文。您需要实现一些东西，让您的脚本知道它何时实际发送文件，而不是何时显示告诉用户下载文件的表单。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-08T22:21:36.280

```
<?
header ("Content-Type: application/download");
header ("Content-Disposition: attachment; filename=$yourfile");
header("Content-Length: " . filesize("$yourfile"));
$fp = fopen("$yourfile", "r");
fpassthru($fp);
?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T22:23:26.590

澄清**header()**的用法：

[官方 PHP 手册](http://us2.php.net/header)：

> **header()**用于发送原始 HTTP 标头。有关 HTTP 标头的更多信息，请参阅 » HTTP/1.1 规范。
> 
> 请记住，必须在发送任何实际输出之前调用**header() ，无论是通过普通 HTML 标记、文件中的空白行还是从 PHP 发送。****使用include()**或**require()**、函数或其他文件访问函数读取代码并在调用**header()**之前输出空格或空行是一个非常常见的错误。使用单个 PHP/HTML 文件时也存在同样的问题。

所以基本上，当您使用 header() 时，您正在更改整个页面。确保您回显的唯一内容是字符串。

# c# - 如何在 OPENXML 电子表格单元格中插入换行符？

> ID：732068
> 
> 赞同：10
> 
> 时间：2009-04-08T22:03:14.270
> 
> 标签：c#, cell, openxml, spreadsheet, line-breaks

我目前正在使用这样的东西在单元格中插入内联字符串：

```
new Cell() 
{ 
    CellReference = "E2", 
    StyleIndex = (UInt32Value)4U, 
    DataType = CellValues.InlineString, 
    InlineString = new InlineString(new Text( "some text")) 
} 
```

但是`\n`插入换行符不起作用，我该怎么做？

* * *

响应

```
new Cell(
         new CellValue("string \n string")
        ) 
    { 
        CellReference = "E2", 
        StyleIndex = (UInt32Value)4U, 
        DataType = CellValues.String         
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-11-15T19:53:18.150

你需要做两件事：

**1.)**将单元格标记为“Wrapped Text”。如果您使用现有电子表格作为模板，您可以在电子表格中手动执行此操作。只需右键单击单元格并选择“设置*单元格格式..* ”，单击“*对齐*”选项卡并选中“*换*行”复选框。
**或者...**您可以通过编程方式设置 CellFormat。如果您有一个名为“ ***cf*** ”的 CellFormat 对象，您将执行以下操作：

```
cf.ApplyAlignment = true;//Set this so that Excel knows to use it.
if (cf.Alignment == null)//If no pre-existing Alignment, then add it.
  cf.Alignment = new Alignment() { WrapText = true };
Alignment a = cf.Alignment;
if (a.WrapText == null || a.WrapText.Value == false)
  a.WrapText = new BooleanValue(true);//Update pre-existing Alignment. 
```

**2.)**你不应该使用“\n”，而应该使用标准的回车+换行组合：“\r\n”
如果你将两者混合（即“\n”没有前面"\r" 和 "\r\n")，这应该在填充单元格值之前修复它：

```
sHeaderText = sHeaderText.Replace("\r\n", "\n").Replace("\n", "\r\n"); 
```

我自己不使用*CellValues.String*甚至*CellValues.InlineString*。*相反，我使用CellValues.SharedString*
构建我的文本单元格（就像 Excel 一样）。对于 Bool，我使用“ *CellValues.Boolean* ”，对于所有其他（数字和日期），我没有将单元格的*DataType*设置为任何值 - 因为这是 Excel 在查看它创建的标记时所做的。

 **** * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-09T01:45:23.377

尝试使用 CellValues.String 而不是 CellValues.InlineString。

# c++ - C++ 中的链表、多项式、重载运算符 << 和 >>

> ID：732069
> 
> 赞同：1
> 
> 时间：2009-04-08T22:03:24.470
> 
> 标签：c++, linked-list

我必须构建一个从类 lista (list) 继承的类多项式 (polinom)。我必须从多项式类中加、减、乘、除 2 个对象。我有这段代码。我不明白为什么我的析构函数不起作用。我还必须重载运算符：+,-,<<,>> 但我不知道该怎么做。

```
#include <iostream>
#include <conio.h>

using namespace std;

struct nod
{float coef;
 int grad;
 nod* adr_urm;
};

class lista
{ 
public:
   nod *vf,*sf;
   lista();
   nod* adaug(nod *&vf,nod*& sf , int gr,float cf);
   void afis(nod* vz); 
   ~lista();
};

class polinom : public lista
{public:
polinom();
~polinom();

};

void lista::afis(nod* vz)
{nod *c=vz;
cout<<"Elementele polinomului"<<endl;
int i=0;
while (c)

 {if (i) cout<<"+";
 cout<<c->coef<<"X^"<<c->grad;
 c=c->adr_urm;
 i++;
 }
 cout<<endl<<endl;
}

nod* lista::adaug(nod *&vf,nod*& sf ,int gr,float cf)
{ nod *c=new nod;
c->coef=cf;
c->grad=gr;
c->adr_urm=0;
if (vf==0) vf=sf=c;
else {sf->adr_urm=c;
      sf=c;}
return vf;
}

lista::lista()
{vf=0;
}

polinom::polinom()
{vf=0;
}

lista::~lista()
{nod *m=vf, *m1=vf->adr_urm;
 while (m1)
       {delete m;
       m=m1;
       m1=m->adr_urm;
       }
 vf=0;
}

polinom::~polinom()
{nod *man=vf, *man1=vf->adr_urm;
 while (man1)
       {delete man;
       man=man1;
       man1=man->adr_urm;
       }
 vf=NULL;
}

int main()
{
int m,nr,nr1;
float n;
nod* vf=0 ;nod *sf;
nod* varFl=0 ;nod *varFv=0;

polinom l,v;

cout<<"Nr de elemente primul pol nr= ";
cin>>nr;
for (int i=1;i<=nr;i++)
{   cout<<"Elementul "<<i<<endl;
    cout<<"Coeficientul = ";
    cin>>n;
    cout<<"Gradul = ";
    cin>>m;
    l.adaug(vf,sf,m,n);
    varFl=vf;
}
l.afis(varFl);

vf=0;

cout<<"Nr de elemente al doilea pol nr= ";
cin>>nr1;
for (int j=1;j<=nr1;j++)
{cout<<"Elementul "<<j<<endl;
cout<<"Coeficientul = ";
cin>>n;
cout<<"Gradul = ";
cin>>m;
v.adaug(vf,sf,m,n);
varFv=vf;
}
v.afis(varFv);

l.~polinom();
v.~polinom();
_getch();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T22:10:40.117

您的析构函数可能运行良好，但您调用它们两次，第二次调用可能会导致段错误。只需像这样挂断电话

```
l.~polinom() 
```

从您的代码中；析构函数被自动调用。

第二件事是，您不需要将`lista`析构函数复制到`polinom`; 基类的析构函数也会被自动调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T22:16:25.470

假设“polinom”的意思是“多项式”，那么你有一个基本的设计缺陷——多项式不是链表。您应该使用包含而不是继承来表示可以根据链表实现多项式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T23:10:24.793

You ought to have two classes: a monomial class that abstracts a single term with a coefficient and exponent and a polynomial that has a list of monomials as private data member.

The monomial will only allow you to add or subtract terms whose exponents are equal; the result will be a monomial that has that same exponent and the sum or difference of the coefficients. The result from the mul and div methods will also be a monomial that has the product or quotient of coefficients as its coefficient and the sum or different of exponents as its exponent.

The polynomial methods will iterate over its list of monomials to perform the arithmetic operations.

I agree with the comment that discourages you from extending a container like linked list. This is best expressed as a polynomial HAS-A list of monomials rather than IS-A list of monomials. It's a subtle, important difference.

One advantage of HAS-A is that it will allow you to change the data structure you use to store the monomials without affecting clients. Array, list, map - your user doesn't care, as long as you uphold the contract.

I don't know if there's an advantage in treating monomials and polynomials the same, but if there is you'll want an interface defining common methods and a GoF Composite pattern.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T22:06:25.337

这是一个家庭作业问题吗？

一方面，lista 中的析构函数不是虚拟的，但更大的问题是 polynom 中的析构函数只是 lista 中析构函数的复制粘贴。

我认为你真的需要在这里修改你的设计和代码......

# networking - 解耦和低延迟的通信机制

> ID：732071
> 
> 赞同：0
> 
> 时间：2009-04-08T22:03:41.507
> 
> 标签：networking, remoting, communication, publish-subscribe

有没有人有消息传输既解耦（发送者和接收者不知道/关心对方）和分布式和可能的远程交互事件的低延迟的经验？它们存在吗？

我正在研究/开发可控制软件的有形交互设备（即物理按钮、旋钮、滑块、RFID 传感器/执行器）的交互技术，这些软件可能驻留在或不驻留在与设备连接的同一系统上。

通常，某种类型的 pub/sub 方法是我想要的方式，因为我希望每个实体只关注它生成的事件和它自己的功能。更不用说，设备可能会不确定地连接和断开连接。

该领域的一项流行技术是[EventHeap](http://graphics.stanford.edu/papers/eheap/)，它建立在 IBM 的元组空间实现[TSpaces](http://www.almaden.ibm.com/cs/TSpaces/)之上。您将事件推入一个袋子，然后可以将其取出。但是元组空间实现的典型性能限制是高延迟；有时是紧张或不确定的延迟。这对于细粒度的交互是不可接受的。

[事件堆源](http://sourceforge.net/project/showfiles.php?group_id=38620)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T22:12:33.747

有 MQ（例如 Apache 的[ActiveMQ](http://activemq.apache.org/)）可以解决一些问题：

*   发送者和接收者不需要相互了解
*   发布/订阅和点对点

不太确定您在谈论的设备功能是什么，可能过于重量级，但可能值得一看。

* * *

更新：实际上，这里有一个指向[IBM MQ 的“无线和移动应用程序”](http://www-01.ibm.com/software/integration/wmqe/)的链接，这也可能有助于查看。

# iphone - 涉及 NSString 的内存泄漏

> ID：732072
> 
> 赞同：1
> 
> 时间：2009-04-08T22:04:53.593
> 
> 标签：iphone, objective-c, cocoa-touch, sqlite

我在我的应用程序中找不到内存泄漏的原因。我发现通过仪器存在内存泄漏，并且我调用该函数的次数比发生更多内存泄漏的次数多。所以很明显发生了内存泄漏。

这是我的代码。目的：

```
@interface WordObject : NSObject
{
    int word_id;
    NSString *word;
}

@property int word_id;
@property (copy) NSString *word;

@end 
```

用于填充 UITableView 的方法：

```
-(void) reloadTableData {
        [tableDataArray removeAllObjects];

        for (int i = 0; i <= 25; i++)
        {
            NSMutableArray *words_in_section = [ [NSMutableArray alloc] init];
            [tableDataArray addObject:words_in_section];
            [words_in_section release];
        }

        WordObject *tempWordObj;

        int cur_section;

        while ( tempWordObj = [ [WordsDatabase sharedWordsDatabase] getNext] )
        {   
            cur_section = toupper([ [tempWordObj word] characterAtIndex:0 ] ) - 'A';

            NSMutableArray *temp_array = [tableDataArray objectAtIndex:cur_section];
            [temp_array addObject:tempWordObj];
            [tableDataArray replaceObjectAtIndex:cur_section withObject:temp_array];
        }

        [mainTableView reloadData];

        [mainTableView scrollRectToVisible:CGRectMake(0, 0, 1, 1) animated:NO];
    } 
```

获取单元格的内容：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithFrame:CellFrame reuseIdentifier:cellIdentifier] autorelease];
    }

    WordObject *tempWordObj = [ [tableDataArray objectAtIndex:[indexPath section] ] objectAtIndex:[indexPath row] ];

    if (!tempWordObj)
    {
        return cell;
    }

    cell.text = [tempWordObj word];

    return cell;
} 
```

这是我清理内存的方法：

```
-(void) freeMemory
{   
    if (tableDataArray)
    {
        [tableDataArray release];
        tableDataArray = nil;
    }
} 
```

从 reloadTableData 调用的函数：

```
 -(WordObject*) getNext {
    if(sqlite3_step(getStmt) == SQLITE_DONE)
    {
        sqlite3_reset(getStmt);
        return nil;
    }

    WordObject *tempWord = [ [WordObject alloc] init];
    tempWord.word_id = sqlite3_column_int(getWordsStmt, 0);

    tempWord.word = [NSString stringWithUTF8String:(char *)sqlite3_column_text(getWordsStmt, 1)]; //Here a leak occurs

    return [tempWord autorelease];
} 
```

而泄露的对象是[WordObject word]。

我将非常感谢任何能帮助我解决这个问题的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T22:23:09.307

将此方法添加到 WordObject：

```
- (void)dealloc {
    [word release];
    [super dealloc];
} 
```

此代码确保`word`在删除 WordObject 实例时释放该属性。

* * *

我很确定这段代码`dealloc`也属于一个方法。顺便说一句，你不需要`tableDataArray = nil`.

```
- (void)freeMemory
{   
    if (tableDataArray)
    {
        [tableDataArray release];
        tableDataArray = nil;
    }
} 
```

# ruby-on-rails - Rails：单表继承和父级中的find（：all）

> ID：732077
> 
> 赞同：3
> 
> 时间：2009-04-08T22:07:43.837
> 
> 标签：ruby-on-rails, ruby

我了解 STI 的工作原理，因为我说过一个帖子模型，其中包含论坛上的帖子和几个子帖子，如“普通用户帖子”和“管理员用户帖子”等。

现在，我想在每个子帖子中定义相同的方法，但该方法在每种情况下都会做不同的事情，例如

```
class Post < ActiveRecord::Base
end

class AdminUserPost < Post
  def background_color
    'rockstar red'
  end
end

class OrdinaryUserPost < Post
  def background_color
    'pale blue'
  end
end 
```

（是的，这是一个愚蠢的例子）。现在在我的线程控制器中，我执行 Post.find (:all)，它给了我需要渲染的帖子列表，但它们是“帖子”对象，而不是 AdminUserPost 或 OrdinaryUserPost - 所以我不能只获得我的 background_color 方法！我必须分别对每种类型的用户帖子进行查找...

有没有我可以做的：

```
Post.find(:all) 
```

并在结果数组中获取 AdminUserPost 和 OrdinaryUserPost 对象而不是 Post 对象的列表？

或者有没有一种合适的方式将我的 Post 对象“投射”到 AdminUserPost 和 OrdinaryUserPost 中？

编辑：

这可以按预期工作 - 前提是您在 Post 类中有一个名为“type”的列。如果您的列被称为其他名称，例如“post_type”，那么您需要添加：

```
self.inheritance_column = 'post_type' 
```

在所有子模型（本例中的 AdminUserPost 和 OrdinaryUserPost）和父模型（Post）中。

谢谢，

斯蒂芬。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T22:37:18.320

仔细检查帖子表是否有列“类型”（字符串）。如果 AdminUserPosts 和 OrdinaryUserPosts 被写入表 'posts' 并且类型列是正确的，你应该得到你期望的子类行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T21:59:55.287

这可以按预期工作 - 前提是您在 Post 类中有一个名为“type”的列。如果您的列被称为其他名称，例如“post_type”，那么您需要添加：

```
self.inheritance_column = 'post_type' 
```

在所有子模型（本例中的 AdminUserPost 和 OrdinaryUserPost）和父模型（Post）中。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-08T22:28:09.310

Post.find(:all) 会给你 Post，因为你是在 Post 中搜索，而不是在 AdminUserPost 中搜索。如果您希望 AdminUserPost 使用：

```
AdminUserPost.find(:all) 
```

但我想它会找到与 Post.find(:all) 相同的帖子。

我认为 named_scope 会帮助你：

```
# in model
Class Post << ActiveRecord::Base
  named_scope :admin_posts, :conditions => {:owner == 'admin'}
  named_scope :ordinary_user_posts, :condition => {:owner != 'admin'}
end

# in controller
@posts = Post.admin_posts # returns admin posts

# or
@posts = AdminUserPost.admin_posts # returns admin posts in AdminUserPost class 
```

我没有尝试使用这个继承的类，但我认为它会起作用。

您可以在此处了解有关命名范围的更多信息：[http ://railscasts.com/episodes/108-named-scope](http://railscasts.com/episodes/108-named-scope)

编辑：

对不起，我是 Rails 社区的新人，以前没有听说过 STI。dbarker 是对的，我试过了，它可以按你的意愿工作。

# nlp - 匹配包含带有排列的单词的行

> ID：732091
> 
> 赞同：4
> 
> 时间：2009-04-08T22:12:17.803
> 
> 标签：nlp, information-retrieval

假设您有一个包含 varchar 列的大表。

您将如何匹配在 varchar col 中包含“首选”一词但数据有些嘈杂并且偶尔包含拼写错误的行，例如：

```
['$2.10 Cumulative Convertible Preffered Stock, $25 par value',
'5.95% Preferres Stock',
'Class A Preffered',
'Series A Peferred Shares',
'Series A Perferred Shares',
'Series A Prefered Stock',
'Series A Preffered Stock',
'Perfered',
'Preffered  C'] 
```

上述拼写错误中“首选”一词的排列似乎表现出[家族相似性](http://en.wikipedia.org/wiki/Family_resemblance)，但它们几乎没有共同点。请注意，拆分每个单词并在每一行中的每个单词上运行[levenshtein](http://en.wikipedia.org/wiki/Levenshtein_distance)将非常昂贵。

更新：

还有其他几个这样的例子，例如“restricted”：

```
['Resticted Stock Plan',
'resticted securities',
'Ristricted Common Stock',
'Common stock (restrticted, subject to vesting)',
'Common Stock (Retricted)',
'Restircted Stock Award',
'Restriced Common Stock',] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T07:59:34.817

我可能会做这样的事情——如果你能摆脱 Levenshtein 一次——这是[Peter Norvig 的一个惊人的拼写检查器实现](http://norvig.com/spell-correct.html)：

```
import re, collections

def words(text): return re.findall('[a-z]+', text.lower()) 

def train(features):
    model = collections.defaultdict(lambda: 1)
    for f in features:
        model[f] += 1
    return model

NWORDS = train(words(file('big.txt').read()))

alphabet = 'abcdefghijklmnopqrstuvwxyz'

def edits1(word):
   s = [(word[:i], word[i:]) for i in range(len(word) + 1)]
   deletes    = [a + b[1:] for a, b in s if b]
   transposes = [a + b[1] + b[0] + b[2:] for a, b in s if len(b)>1]
   replaces   = [a + c + b[1:] for a, b in s for c in alphabet if b]
   inserts    = [a + c + b     for a, b in s for c in alphabet]
   return set(deletes + transposes + replaces + inserts)

def known_edits2(word):
    return set(e2 for e1 in edits1(word) for e2 in edits1(e1) if e2 in NWORDS)

def known(words): return set(w for w in words if w in NWORDS)

def correct(word):
    candidates = known([word]) or known(edits1(word)) or known_edits2(word) or [word]
    return max(candidates, key=NWORDS.get) 
```

他在这里提供了一个训练集[：http://norvig.com/big.txt](http://norvig.com/big.txt)这是示例输出：

```
>>> correct('prefferred')
'preferred'
>>> correct('ristricted')
'restricted'
>>> correct('ristrickted')
'restricted' 
```

在您的情况下，您可以将原始列复制到新列，但在执行时将其通过拼写检查器。然后`fulltext`在拼写正确的列上放置一个索引，并将您的查询与它匹配，但从原始列返回结果。您只需执行一次，而不是每次都计算距离。您也可以对输入进行拼写检查，或者仅将更正后的版本检查为备用。无论哪种方式，都值得研究 Norvig 示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T22:18:23.467

您能否尝试在表格的一小部分样本上对其进行训练以查找可能的拼写错误（使用 split + Levenshtein），然后在整个表格中使用生成的单词列表？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T22:22:54.253

正在尝试用 TSQL 或什么语言来做到这一点？

您可能可以使用正则表达式来匹配其中的大多数。

以下的一些变化

```
"p(er|re|e)f{1,2}er{1,2}ed"

"r(e|i)s?t(ri|ir|rti|i)ct?ed" 
```

你想确保它不是大写敏感的......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T22:31:53.827

再创建两个表，拼写和可能的拼写：

-- 你可以找出类型

```
create table spelling ( id, word ) ; 
create table possible_spelling 
( id, spelling_id references spelling(id), spelling ) 
-- possible spelling also includes the correct spelling
-- all values are lowercase

insert into spelling( word ) values ('preferred');
insert into possible_spelling( spelling_id, spelling ) 
 select 1, '%preferred%' union select 1, '%prefered%' union ....;

select * 
from bigtable a 
join possible_spelling b
on (lower(a.data) like b.spelling )
join spelling c on (b.spelling_id = c.id) 
where c.word = 'preferred'; 
```

反对意见：这会很慢，并且需要设置。回答：没那么慢，这应该是一次性对数据进行分类和修复的事情。设置一次，每个传入行一次进行分类。

# java - 简单的portlet jsp页面流问题

> ID：732099
> 
> 赞同：3
> 
> 时间：2009-04-08T22:16:40.477
> 
> 标签：java, jsp, portlet, jsr168

我是 Java portlet 的新手，我试图在一个相当基本的级别上了解这些东西是如何工作的。

我现在对如何在我的 portlet 中拥有多个“视图”感到困惑。假设我的 portlet 将用于 CRUD 操作。为简单起见，我设想当用户第一次查看 portlet 时，他们将看到一个包含数据库中所有记录的表。然后，用户可能能够单击一条记录，该记录将在 portlet 中显示一个新页面，其中包含用于更新记录的表单。添加记录的工作方式大致相同。这里没有什么令人震惊的...

**我在哪里控制用户在不同视图之间导航的方式，以及在哪里切换用户可能执行的不同操作（更新、添加、删除等）？**

我在网上查找了很多“hello world”portlet 教程，但没有多大帮助。我发现许多其他教程更高级，更适合我正在做的事情，但它们似乎都使用了一些底层框架，如 Struts、JSF 等。

我想知道如何仅使用一个基本的 portlet 来完成这项工作，该 portlet 使用 JSP 来呈现视图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T22:39:37.520

[Portlet API (JSR-168)](http://www.javaworld.com/javaworld/jw-08-2003/jw-0801-portlet.html)是您需要寻找的。这将向您解释 Portlet 容器如何管理视图、如何呈现 Portlet 以及如何映射操作。

公司

*   portlet 交互始终是两阶段的——动作和呈现——而 Web 服务器交互始终是单阶段的；
*   在标准 Web 应用程序中，表单被提交到 html 表单标记的 action 字段中指定的 servlet。在 JSR-168 portlet 中，HTML 表单的操作 URL 是使用 actionURL portlet 标记生成的，例如**`<form action="<portlet:actionURL/>" method="post">`**
*   提交 HTML 表单会导致调用 portlet 的*processAction(ActionRequest aRequest, ActionResponse aResponse)*方法
*   允许 servlet 进行包含、转发和重定向；portlet 只允许包含。
*   Servlet 可以呈现完整的页面，Portlet 仅呈现页面片段。
*   等等

# c# - 在 ASP.NET 中实现数据绑定的正确方法

> ID：732103
> 
> 赞同：3
> 
> 时间：2009-04-08T22:18:02.860
> 
> 标签：c#, asp.net

实现 DataBind() 控制内部有中继器的方法的正确方法是什么？

这些是此控件的要求（但如果您认为这些缺少某些内容或者是开销，您可以提供您的要求）

*   控件应接受集合或可枚举（对象列表、匿名对象、字典或数据表）
*   DataSource 应该完全应该与控件完全解耦（使用 Data*Field 属性来指定映射的属性或键；如 DropDownList 中的 DataValueField 和 DataTextField）
*   ViewState 上的控件应该很容易。如果可能的话，根本不应该使用 ViewState，或者它的使用率应该尽可能低（存储一些 ID 或类似的东西）
*   控件应处理任何类型（使用 ToString() 进行转换）
*   ItemDataBound 内部可以使用 e.DataItem 如果可能的话应该可以访问

我希望我的控件像这样初始化：

```
var control = new Control();
control.DataDateField = "Date";
control.DataNameField = "FullName";
control.DataTextField = "Comment";
control.DataSource = data;
control.DataBind(); 
```

数据项可以是以下之一

字典列表（或表格行）

```
var data = new List<Dictionary<string, string>>
{
    new Dictionary<string, string>
        {{"Date", "2009-03-15"}, {"FullName", "John Walker"}, {"Comment", "comment1"}},
    new Dictionary<string, string>
        {{"Date", "2009-03-12"}, {"FullName", "Chuck Norris"}, {"Comment", "comment2"}},
    new Dictionary<string, string>
        {{"Date", "2009-03-13"}, {"FullName", "Sergej Andrejev"}, {"Comment", "comment3"}}
}; 
```

匿名对象列表

```
var data = new List<object>
{
    new {Date = "2009-03-15", FullName = "John Walker", Comment = "comment1"},
    new {Date = "2009-03-12", FullName = "Chuck Norris", Comment = "comment2"},
    new {Date = "2009-03-13", FullName = "Sergej Andrejev", Comment = "comment3"},
}; 
```

项目清单

```
public class SampleClass
{
    public object Date { get; set; }
    public object FullName { get; set; }
    public object Comment { get; set; }

    public SampleClass(string date, string fullName, string comment)
    {
        Date = date;
        FullName = fullName;
        Comment = comment;
    }
};

var data = new List<SampleClass>
{
    new SampleClass("2009-03-15", "John Walker", "comment1"),
    new SampleClass("2009-03-12", "Chuck Norris", "comment2"),
    new SampleClass("2009-03-13", "Sergej Andrejev", "comment3"),
}; 
```

数据表

```
var data = new DataTable();
data.Columns.Add(new DataColumn { DataType = typeof(DateTime), ColumnName = "Date" });
data.Columns.Add(new DataColumn { DataType = typeof(string), ColumnName = "FullName" });
data.Columns.Add(new DataColumn { DataType = typeof(string), ColumnName = "Comment" });

data.Rows.Add(new object[] { DateTime.Parse("2009-03-15"), "John Walker", "comment1" });
data.Rows.Add(new object[] { DateTime.Parse("2009-03-12"), "Chuck Norris", "comment2" });
data.Rows.Add(new object[] { DateTime.Parse("2009-03-13"), "Sergej Andrejev", "comment3" }); 
```

基本上我想要的是用于数据绑定的通用代码，所以每次创建新控件时我都不会浪费时间从头开始创建它。我将不胜感激任何对良好做法、官方指南，当然还有您的个人经验的参考。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-08T23:06:56.440

本文使用模板构建了一个示例数据绑定控件：

[构建 DataBound 模板化自定义 ASP.NET 服务器控件](http://msdn.microsoft.com/en-us/library/aa479322.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T22:40:42.963

这就是我认为你正在寻找的东西......

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.databoundcontrol.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.databoundcontrol.aspx)

它是您的控件可以继承的基类...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T19:45:25.730

每种方式可能都有其优点和缺点。这是我看到的：

1.  字典很好，因为它们是非常常见的对象，每个人都应该知道如何使用和操作它们。语法可能会变得丑陋。

2.  匿名对象具有漂亮的外观、简洁的语法，并且它们还擅长快速实现一次性解决方案。我尝试将它们用于类似的东西，但很快就遇到了一些限制，所以如果你需要对它们进行真正的“工作”，你最终可能不得不废弃它们。

3.  对象列表类似于字典，但有助于更轻松地理解您要完成的任务。你有更高的可读性和更容易理解，但它是你库中的另一个对象，只会被使用一次。对于一个简单的问题，可能打字太多了。

4.  我想我曾经像您一样使用过 DataTables，因为我不知道自己在做什么。如果它介于字典和字典之间，请使用字典，因为它们是更常见和通用的对象。

只是我的 0.02 美元，但它真的归结为对您正在解决的问题最重要的东西（可读性/一致性/可理解性/...），以及您当前的代码库中是否已经存在和约定。

标记

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-19T16:51:09.983

我知道这并不能完全回答您的问题，而是作为补充信息：

您可能还想查看[ASP.NET 动态数据](http://www.asp.net/dynamicdata/)。它使用绑定属性的数据类型来确定要显示的控件/用户控件的类型。它还根据数据在整个域/业务对象模型的上下文中所代表的内容添加附加功能。（如果是ID字段、外键等）

# .net - 光速与 NHibernate

> ID：732105
> 
> 赞同：13
> 
> 时间：2009-04-08T22:18:43.577
> 
> 标签：.net, nhibernate, orm, comparison, lightspeed

[使用LightSpeed](http://www.mindscape.co.nz/products/LightSpeed/comparison.aspx)是什么体验？Mindscape 提供的比较并没有过多地说明 NHibernate。Lightspeed 看起来很灵活，但我对性能的看法并不多。Lightspeed 的表现如何？使用 Lightspeed 还有什么缺点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-09T08:48:56.120

在过去的六个月里，我一直在工作中使用 NHibernate 和 Active Record，并在业余时间在家中使用 LightSpeed。

**优点/缺点** 到目前为止，我发现 LightSpeed 和带有 Active Record 的 NHibernate 都易于学习。

我还没有发现 LightSpeed 的缺点（还）。我最喜欢的功能是：

*   约定优于配置。这样可以节省大量时间并提供一致的代码。
*   模型类和配置生成器。
*   支持 Linq 和 MySQL 5。

我最喜欢 Active Record 的特性是：

*   无需 XML 配置，自动提供最常用的配置选项。
*   NHibernate 的灵活性在需要时仍然可用（例如条件查询）。

Active Record 对我来说的缺点是：

*   Ruby on Rails 代码示例似乎比 C# 示例多

**性能** 我还没有（还）并排比较这两种产品并同样对两者进行性能测试。

我猜想 NHibernate 的类层次结构更深。在使用 ANTS Profiler 优化我的代码时，我发现对于一个简单的查询，在生成实际 SQL 查询之前，会通过 NHibernate 类调用后调用。

当然，产生的查询将对 ORM 的最终性能产生重大影响。

LightSpeed 和 NHibernate 都提供延迟加载，而 Active Record 使 NHibernate 轻松加载。

我认为使用带有 Linq 的 Lightspeed 优化您的查询更容易，并且对维护您的代码的人来说更清楚。而通常不建议编写 NHibernate HQL。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-09T09:08:25.060

关于性能，[来自此页面](http://www.mindscape.co.nz/products/LightSpeed/features.aspx)

> 急切和延迟加载没有 N+1 问题。包括“命名聚合”。也就是说，为特定的急切负载图命名。观看截屏视频。

不要小看这一点。这意味着如果您加载一个包含 200 个项目的列表，大多数情况下，大多数 ORM 将运行 201 个查询。光速没有。这是（非常）少数不这样做的人之一。

如果您正在寻找在一些边缘情况下快 100 毫秒的东西，那么祝您好运。理论上我喜欢 NH，而且我认为我永远不会使用 ORM，但对于我所做的大部分工作来说，NH 完全是矫枉过正——我最终花了很多时间来维护元数据、类文件、映射等人，它是......有趣的......测试。好吧，无论如何，这是给我们的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T04:53:37.653

我最近快速浏览了两者。Lightspeed给我留下深刻印象的是：

*   他们的工具效果很好（我认为我用过的最好的 VS 设计师）。
*   非常快速的反应。他们回答了问题并添加了功能。

对我来说最引人注目的是它们严重依赖约定，并且在大多数情况下似乎没有覆盖。因此，在决定如何准确映射事物时，我的选择并没有我想要的那么好。据说 Lightspeed 3 将解决这个问题，让您可以进行更多自定义。

由于所有的 XML，我远离 NHibernate，但后来发现 Fluent NHibernate，看起来它会很好地工作。没有设计师支持，尽管有些人可能会说这是设计使然（专注于您的对象）。NHibernate 似乎也是 .NET 最常用的 ORM，所以从这个意义上说，它是一个“安全”的赌注。到目前为止，它已经能够映射出我能想到的大部分内容。

无论如何，由于自定义限制，我在 Lightspeed 上并没有走得太远。如果我开始一个可以符合他们惯例的新项目，那可能是另一回事了。该公司反应迅速，我真的很想使用他们的一种产品:)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-09T09:14:09.990

我最近比较了一大组 ORM，包括 NH 和 Lightspeed。我专业使用NH，所以我有点偏见，文章在[这里](http://www.anotherchris.net/orm/a-look-at-net-object-relational-mappers-orms/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-09T02:55:34.440

我已经使用 Lightspeed 几个月了，但我是 .NET 的新手，所以从未使用过 NHibernate。到目前为止，我发现它很容易使用，学习曲线很小，并且会不断更新。对我来说最大的优势是支持。查询通常会在很短的时间内得到答复，并且发现的任何错误通常会在第二天修复并在夜间构建中可用。不确定“Lightspeed 的性能如何”是什么意思？这家伙看起来很开心{:o) [http://omarbesiso.spaces.live.com/blog/cns!70A5B53D721071B7!473.entry](http://omarbesiso.spaces.live.com/blog/cns!70A5B53D721071B7!473.entry)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T04:54:02.720

去年，我在新西兰奥克兰的 TechEd 上与该产品的一位主要开发人员（Jeremy Boyd）进行了交谈，并提出了这个问题。他似乎认为它比 NHibernate 快了几个数量级。这当然是他的产品，所以他会这么说，但我认为值得一提。

# c# - GridView 中的 ASP.Net 显示图像跨列和行？使用 C#

> ID：732106
> 
> 赞同：0
> 
> 时间：2009-04-08T22:19:07.850
> 
> 标签：c#, asp.net, sql, gridview, image

我有一些要在 Gridview 中显示的缩略图。我不熟悉提供的所有定制。基本上我想将图像存储在 Gridview 中，可能跨越 5 列宽......然后完成其余的需要多少行。我不想要任何列或行标题，并且真的不想看到实际网格的证据。我还想让图像可点击。

我将从 Asp.net 中的 Sql 数据库中提取图像。我不想将网格绑定到 sqldatasource，而是将图像粘贴在网格中，并在页面后面的代码中使用某种循环。这就是让我感到困惑的地方。我知道您可以创建数据表并添加列和行。但是，似乎行/列不跨越。您将如何存储图像以使其像网格一样工作。我在下面提供了一些（非常）sudo 代码，让您了解我想要做什么。

须藤代码：

```
colcount = 0;  
rowcount = 0;  
imagecount = 0;  
while(images.length > imagecount){  
    if(colcount < 5){  
        grid[rowcount][colcount] = images[imagecount];  
        colcount++;  
        imagecount++;  
    }  
    else{  
        rowcount++;
        colcount = 0; 
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T22:47:36.580

如果您想要特定的 HTML，那么您最终会一直与 GridView 作斗争。请改用 ListView 或 Repeater。

```
<asp:ListView runat="server">
   <LayoutTemplate>
      <table>
         <asp:PlaceHolder id="itemPlaceHolder" runat="server" />
       </table>
   </LayoutTemplate>
   <ItemTemplate>
          <tr>
             <td colspan="5"><asp:Image runat="server" src='<%# Eval("ImageUrl")' %></td>
             <td><%# Eval("Column1") %></td>
          </tr>
   </ItemTemplate>
 </asp:ListView> 
```

> 我知道您可以创建数据表并添加列和行。但是，似乎行/列不跨越。

听起来您正在创建一个[`System.Data.DataTable`](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)- 这是一个数据结构 - 而不是一个布局控件。如果您想以编程方式创建，`<table>`您可以使用. 您可以在关联的 TableRow 或 HtmlTableRow 上设置 colspan 和 rowspan。[`System.Web.UI.WebControls.Table`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.table.aspx)[`System.Web.UI.HtmlControls.HtmlTable`](http://msdn.microsoft.com/en-us/library/system.web.ui.htmlcontrols.htmltable.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T22:25:38.317

对于您在此处描述的所有内容，最好的选择是使用 DataList 控件。您可以使用RepeatColumns 属性指定您希望的列宽，甚至可以通过将RepeatLayout 属性设置为“Flow”来消除任何“表格”感。

这也将使您不必担心列数，您甚至可以绑定一组图像进行绑定。

编辑：既然你要求一个例子，那就这么简单。首先创建您的网格并确保有一个图像占位符：

```
<asp:DataList ID="dlImages" runat="server" 
              RepeatColumns="5" 
              RepeatDirection="Horizontal" 
              RepeatLayout="Flow">

   <ItemTemplate>
      <asp:Image ID="imgPrettyPic" runat="server" />
   </ItemTemplate>

</asp:DataList> 
```

然后在你后面的代码中，你所要做的就是一个简单的数据绑定。我不确定您的图像是如何存储的，但为了争论，假设您有一个数据库查询，它为您提供了您想要显示的每个图像的 URL。您的页面加载看起来像这样：

```
if (!Page.IsPostBack())
{

    dtImageURLs = GetImageUrlsFromDB();
    dlImages.DataSource = dtImageURLs;

    dlImages.DataBind();
} 
```

现在这就是人们会在事情上有所不同的地方。我更喜欢在后面的代码中执行我的所有 RowBinding 类型方法，而不是内联，因此我使用 DataList 的 RowDataBound 事件并相应地绑定 URL 属性。

```
 protected void dlImages_ItemDataBound(object sender, System.Web.UI.WebControls.DataListItemEventArgs e)
   {

       Image TargetImage = default(Image);
       DataRow DataSourceRow = default(DataRow);

       DataSourceRow = ((System.Data.DataRowView)e.Item.DataItem).Row;
       TargetImage = (Image)e.Item.FindControl("imgPrettyPicture");

       TargetImage.ImageUrl = DataSourceRow.Item("ImageURL").ToString;
   } 
```

......这应该让你启动并运行。请注意，您需要将 DataSourceRow 对象更改为您从中进行数据绑定的任何类型的项目。我使用的是 DataRow，因为这是我经常遇到的最常见的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T22:27:17.627

您可以使用中继器...这将允许您真正定义每个“行”或“列”的外观以及它们是水平重复还是垂直重复

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T22:24:24.170

为什么不手动生成网格？

在您的代码隐藏中创建一个方法，使用`Response.Write`语句输出必要的 HTML。在`.aspx`页面中，使用`<% RenderGrid(); %>`调用您的方法并显示相应的网格。

# security - 在 WinINet 中手动验证服务器证书

> ID：732107
> 
> 赞同：2
> 
> 时间：2009-04-08T22:19:34.743
> 
> 标签：security, ssl, wininet

我正在尝试对 WinINet 客户端实施手动自签名 SSL 证书验证。我尝试通过`InternetQueryOption`使用 `INTERNET_OPTION_SECURITY_CERTIFICATE`或`INTERNET_OPTION_SECURITY_CERTIFICATE_STRUCT`参数调用来解决它，但两者都返回服务器证书的一些内部解释，没有一个允许访问原始证书公钥或至少是 thumbprimnt。

我应该如何验证证书？...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-08-24T14:39:23.670

除了先前的答案。如果您想手动检查具有不受信任的根的证书（例如自签名），您需要

1.  设置标志以忽略不受信任的证书

```
// Open request before
HINTERNET hRequest = HttpOpenRequest(hConnect, _T("POST"), action, NULL, NULL, NULL, dwFlags, 0);
if (!hRequest) return GetLastError();

// set ignore options to request
DWORD dwFlags;
DWORD dwBuffLen = sizeof(dwFlags);
InternetQueryOption(hRequest, INTERNET_OPTION_SECURITY_FLAGS, (LPVOID)&dwFlags, &dwBuffLen);
dwFlags |= SECURITY_FLAG_IGNORE_UNKNOWN_CA;
InternetSetOption (hRequest, INTERNET_OPTION_SECURITY_FLAGS, &dwFlags, sizeof (dwFlags)); 
```

2.  发送数据请求

```
if (HttpSendRequest(hRequest, strHeaders, strHeaders.GetLength(), data, len)) { 
```

3.  只有在数据请求返回后，我们才能查看证书信息并检查指纹。要获取指纹，我们必须使用 cryptapi 中的方法，因此需要 #include "WinCrypt.h" 并将 crypt32.lib 添加到链接器

```
PCCERT_CHAIN_CONTEXT CertCtx=NULL;
DWORD cbCertSize = sizeof(&CertCtx);

// Get certificate chain information
if (InternetQueryOption(hRequest, INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT, (LPVOID)&CertCtx, &cbCertSize))
{
    PCCERT_CHAIN_CONTEXT pChainContext=CertCtx;

    CERT_SIMPLE_CHAIN *simpleCertificateChainWithinContext = NULL;
    for (int i=0; i<pChainContext->cChain; i++)
    {
        simpleCertificateChainWithinContext=pChainContext->rgpChain[i];

        // We can check any certificates from chain, but if selfsigned it will be single
        for (int simpleCertChainIndex = 0; simpleCertChainIndex < simpleCertificateChainWithinContext->cElement; impleCertChainIndex++)
        {
            // get the CertContext from the array
            PCCERT_CONTEXT pCertContext = simpleCertificateChainWithinContext->rgpElement[simpleCertChainIndex]->pCertContext;

            // Public key can be getted from
            //  (((*((*pCertContext).pCertInfo)).SubjectPublicKeyInfo).PublicKey).pbData
            // but better to use thumbprint to check

            // CERT_HASH_PROP_ID - is a thumbprint
            BYTE thumbprint[1024];
            DWORD len = 1024;
            if (CertGetCertificateContextProperty(pCertContext, CERT_HASH_PROP_ID, thumbprint, &len)) {
                //
                // !!! HERE WE CAN CHECK THUMPRINT WITH TRUSTED(PREVIOUSLY SAVED)
                // and return error, or accept request output.
                //
            }
        }
    }

    // important! Free the CertCtx
    CertFreeCertificateChain(CertCtx);
} 
```

4.  为什么要使用指纹来比较证书？证书中有三个有趣的字段可供比较：序列号、公钥、指纹。序列号只是颁发证书的 CA 选择的唯一编号，公钥是很好的解决方案，但指纹是在完整证书上计算的哈希值（[https://security.stackexchange.com/questions/35691/what-is-the-序列号和指纹之间的差异](https://security.stackexchange.com/questions/35691/what-is-the-difference-between-serial-number-and-thumbprint)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-31T23:30:25.340

如果您在调用 HttpOpenRequest 时设置了 INTERNET_FLAG_SECURE，WinInet 将已经验证返回的证书的域名是否与证书匹配并且证书链是受信任的。

之后你可以做的几件事：

1.  使用 INTERNET_OPTION_SECURITY_CERTIFICATE_STRUCT 的 lpszIssuerInfo 将返回的域名和证书名称与预期的父证书进行比较。

2.  从 lpszIssuerInfo 中解析出颁发者名称并调用 CertFindCertificateInStore 以获取证书上下文指针。

3.  使用 CertGetCertificateChain 和证书上下文指针获取和验证证书链，例如比较颁发证书的指纹，但不是我所知道的实际证书本身。

供将来参考，来自 MSDN：“ [http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa385328(VS.85).aspx) ”。如果安装了 IE8.0，则有一个公开服务器证书链的新选项。

INTERNET_OPTION_SERVER_CERT_CHAIN_CONTEXT 105

检索服务器的证书链上下文作为重复的 PCCERT_CHAIN_CONTEXT。您可以将此重复的上下文传递给任何采用 PCCERT_CHAIN_CONTEXT 的 Crypto API 函数。完成证书链上下文后，您必须在返回的 PCCERT_CHAIN_CONTEXT 上调用 CertFreeCertificateChain。

版本：需要 Internet Explorer 8.0。

# .net - 中文语言代码

> ID：732109
> 
> 赞同：16
> 
> 时间：2009-04-08T22:19:52.293
> 
> 标签：.net, localization, .net-2.0, cjk

我们正在将旧的 .net 1.1 网站更新到 2.0。本站目前支持中文（繁体）和中文（简体）

尝试使用以下代码检测语言和文化时出现运行时错误：zh-CHS（simified）和 zh-CHT（traditional）：

请选择特定的文化，例如zh-CN、zh-HK、zh-TW、zh-MO、zh-SG。

来自：System.Globalization.CultureInfo.CreateSpecificCulture（字符串名称）

看来这些是过时的语言/文化代码。是否有人对我如何将这些语言映射到受支持的特定国家/文化有任何见解？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-08T22:26:41.607

我会在这里看看：

[http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.parent(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.parent(VS.80).aspx)

具体来说，

```
/*
This code produces the following output.

SPECIFIC CULTURE                                  PARENT CULTURE
0x0404 zh-TW Chinese (Taiwan)                     0x7C04 zh-CHT Chinese (Traditional)
0x0804 zh-CN Chinese (People's Republic of China) 0x0004 zh-CHS Chinese (Simplified)
0x0C04 zh-HK Chinese (Hong Kong S.A.R.)           0x7C04 zh-CHT Chinese (Traditional)
0x1004 zh-SG Chinese (Singapore)                  0x0004 zh-CHS Chinese (Simplified)
0x1404 zh-MO Chinese (Macau S.A.R.)               0x7C04 zh-CHT Chinese (Traditional)

*/ 
```

和：

> Windows API 中的区域性列表与 .NET Framework 中的区域性列表略有不同。例如，文化标识符为 0x7C04 的中性文化 zh-CHT“中文（繁体）”在 Windows API 中不可用。如果需要与 Windows 的互操作性（例如，通过 p/invoke 机制），请使用操作系统中定义的特定区域性。这将确保与使用相同 LCID 标识的等效 Windows 区域设置保持一致。

对于简体，我会坚持使用 zh-CN，并且可能只为繁体选择其他一种 - 也许您的大多数繁体用户都来自台湾？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-08T22:22:07.173

简体：CN（中国大陆）、SG（新加坡）。繁体：TW（台湾）、MO（澳门）、HK（香港）。

# f# - 调整可区分联合对象的值

> ID：732125
> 
> 赞同：1
> 
> 时间：2009-04-08T22:23:38.493
> 
> 标签：f#

所以，还有另一个受歧视的工会问题:-)

假设我有一个像这样的歧视性工会：-

```
type Foo =
  | A of string
  | B of int
  | C of char
  | D of string 
```

我希望能够使用一个函数 appendStringToFoo，如下所示：-

```
let someVal = A("hi")
let anotherVal = D("yo")

let hiya = someVal |> appendStringToFoo "ya"
let yoyo = anotherVal |> appendStringToFoo "yo" 
```

其中 hiya = A("hiya") 和 yoyo = D("yoyo")。

显然，我还会继续编写单独的函数 appendIntToFoo、appendCharToFoo 等。

因此，有效地，类似于以下功能：-

```
let appendStringToFoo str fooValue =
  fooValue(fooValue.Value + str) 
```

这似乎不可能。

如果可以避免，我不想做以下事情：*-*

```
let appendStringToFoo str fooValue =
    match fooValue with
    | A(originalStr) -> A(originalStr + str)
    | D(originalStr) -> D(originalStr + str) 
```

因为这意味着每次我添加一个新的联合案例时，我都必须重新编写这段代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T00:16:01.767

你必须做你不想做的事。

另一种方法是

*   抽象类 Foo
*   抽象类 StringyFoo : Foo { void AppendString(string); 字符串 S; }
*   A类：StringyFoo
*   D类：StringyFoo
*   抽象类 IntyFoo : Foo
*   B类：IntyFoo

这可能会避免“每次添加新的令牌类型时修复 appendString()”，但我认为对于词法分析器（其中 Foo=Token），你会对 DU 更满意。

一般来说，对于词法分析/解析，无论您使用类层次结构和访问者模式，还是使用代数数据类型，您总是必须为 N 个特征和 M 个子类型编写 N*M 代码；没有避免它，所以不要费心寻找可爱的技巧来避免它，它只会导致痛苦。

# winforms - 使用 WinForms 生成非抗锯齿字体

> ID：732127
> 
> 赞同：0
> 
> 时间：2009-04-08T22:24:02.847
> 
> 标签：winforms, fonts

我需要生成一个位图，其中包含一些在没有抗锯齿或 ClearType 的情况下呈现的字符。

在 Win32-land 中，我会创建一个将 lfQuality 设置为 NONANTIALIASED_QUALITY 的字体并用它进行绘制。

我尝试通过以下方式使用 WinForms 执行此操作：

```
 using(Font smoothFont = new Font("Arial", 30, GraphicsUnit.Pixel))
  {
    LOGFONT lf = new LOGFONT();
    smoothFontToLogFont(lf);
    lf.lfQuality = NONANTIALIASED_QUALITY;
    using (Font roughFont = Font.FromLogFont(lf))
    { 
```

但 roughFont 似乎仍然呈现 ClearTyped 文本。

我应该放弃 WinForms 并在 C 中执行此操作，还是我在这里遗漏了什么？（我的 LOGFONT 类和相关的 lfQuality defs 直接来自框架源，所以我很高兴它们是正确的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T23:36:14.233

原来我找错地方了，你不能以这种方式更改 GDI+ 字体渲染，而是需要在图形对象上设置 TextRenderingHint 属性，如下所示：

```
gr.TextRenderingHint = TextRenderingHint.SingleBitPerPixelGridFit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T12:09:46.960

我知道这与位图无关，但我一直在为我的问题寻找解决方案，并提出了这个 LabelEx 修改

```
using System.Drawing;
using System.Drawing.Text;

class LabelEx : System.Windows.Forms.Label
{
    protected override void OnPaint(System.Windows.Forms.PaintEventArgs e)
    {
        e.Graphics.TextRenderingHint = TextRenderingHint.SingleBitPerPixelGridFit;
        base.OnPaint(e);
    }
} 
```

也许有人会发现它很有用

# javascript - 仅针对直接子代而不是其他相同后代的 CSS 选择器

> ID：732130
> 
> 赞同：78
> 
> 时间：2009-04-08T22:24:45.513
> 
> 标签：javascript, css, mootools, css-selectors

我有一个嵌套的可排序列表，可以动态添加或删除项目，并且可以嵌套 n 级深。在嵌套时，一个新的 ul 元素被注入到任何被选为父元素的 li 元素中。列表的初始状态如下所示：

```
<ul id="parent">
    <li id="One"><a href="" class="listLink"><span class="position">1</span>One</a></li>
    <li id="Two"><a href="" class="listLink"><span class="position">2</span>Two</a></li>
    <li id="Three"><a href="" class="listLink"><span class="position">3</span>Three</a>
        <ul>
            <li id="A"><a href="" class="listLink"><span class="position">1</span>A</a></li>
            <li id="B"><a href="" class="listLink"><span class="position">2</span>B</a></li>
            <li id="C"><a href="" class="listLink"><span class="position">3</span>C</a></li>
            <li id="D"><a href="" class="listLink"><span class="position">4</span>D</a></li>
            <li id="E"><a href="" class="listLink"><span class="position">5</span>E</a></li>
            <li id="F"><a href="" class="listLink"><span class="position">6</span>F</a></li>                    
        </ul>
    </li>   
    <li id="Four"><a href="" class="listLink"><span class="position">4</span>Four</a></li>
    <li id="Five"><a href="" class="listLink"><span class="position">5</span>Five</a></li>
    <li id="Six"><a href="" class="listLink"><span class="position">6</span>Six</a></li>                    
</ul> 
```

我正在使用 MooTools 进行排序等，它工作正常，但我在排序时无法正确重置位置文本。我尝试使用的每个 CSS 选择器还包括*所有*子元素，而不仅仅是属于列表中的 li 元素，而不是任何属于子列表的元素。假设除了 id、position 和 text，所有列表中的每个 li 元素都与其他所有元素相同。是否有只获取直系子女的选择器？还有另一种方法可以做到这一点吗？

我尝试了一些像上面提到的子选择器：

*   `ul > li`将选择作为 ul 子级的*所有*li 元素，而不仅仅是直接子级
*   `#parent > li`做和上面一样。

这是我当前在删除项目时正在运行的函数，它不处理排序，它工作正常，只是更新位置。请注意，它也是 MooTools 语法：

```
var drop = function(el){
    el.getParents('ul').reverse().each(function(item){
        var posCount = 1;
        item.getElements('li a span[class=position]').each(function(pos){
            pos.set('text', posCount);
            posCount++;
        });
    });
} 
```

目前，更改主级别的任何项目顺序都会重新编号 1-12，甚至是子列表。更改子列表上的任何项目都会为该列表提供正确的编号，但会导致父列表错误地计算编号中的所有子 li 元素。

我觉得这是一个丑陋的黑客，但它有效：

```
var drop = function(){
    var ulCount = 1;
    $$('ul').each(function(item){
        if(item.get('id') != 'parent') { 
            item.set('id', 'id-'+ulCount);
        }
        var elId = item.get('id');
        var posCount = 1;
        $(document).getElements('#'+elId+'>li>a>span[class=position]').each(function(pos){
            pos.set('text', posCount);
            posCount++;
        });
        ulCount++;
    });
} 
```

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2009-04-08T22:28:04.083

```
ul > li 
```

只有直系子女。因此，例如，仅执行您可以使用的顶级列表元素：

```
#parent > li 
```

**注意：** IE6 不支持此功能。

向后兼容的常见解决方法是执行以下操作：

```
#parent li { /* style appropriately */ }
#parent li li { /* back to normal */ } 
```

它更乏味，因为您必须应用样式然后将其关闭（您可能不一定知道旧值是什么），但它是唯一对 IE6 友好的纯 CSS 解决方法。

**编辑：**好的，您有一个特定于 MooTools 的问题。getElements() 返回所有后代，而不仅仅是直接子代。尝试使用[getChildren()](http://mootools.net/docs/Element/Element)。

```
var drop = function(el){
    el.getParents('ul').reverse().each(function(item){
        var posCount = 1;
        item.getChildren("li").getElements("a span[class=position]").each(function(pos){
                pos.set('text', posCount);
                posCount++;
        });
    });
} 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-05T22:50:05.043

原来的问题没有回答。:only-child 仅在独生子女没有后代时才有效。原始帖子建议包含后代子代是由于 ul>li 而实际上是由于 :only-child 中的错误。矛盾的是 :first-child 选择列表中具有后代的第一个孩子，就像 last-child 一样，但 :only-child 没有。我在 Firefox、Opera 和 Chrome 中检查了这一点。这是一个例子：

```
<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8">
<style>
.list>ul>li:only-child {color:red}
.list>ul>li:first-child {color:green}
.list>ul>li:last-child {color:blue}
</style>
</head>
<body>
<div class="list">
<ul><li>Item one</li><ul>
<l>Subitem one</li>
<li>Subitem two</li></ul></li><!--<li>Item two</li>
<li>Item three</li>-->
</ul></div>
</body></html> 
```

要激活 :first-child 和 :last-child 规则，请取消注释最后两项。[因此， Selectors Level 3 标准](https://drafts.csswg.org/selectors-3/#only-child-pseudo)的实现在主流浏览器中是不一致的。当存在 :only-child 规则并且唯一的孩子有后代时，不应激活 :first-child 规则。在示例中，唯一的孩子应该是红色的，但它是绿色的。

# perl - 如何导出 Perl 包中的所有子程序？

> ID：732133
> 
> 赞同：22
> 
> 时间：2009-04-08T22:25:59.143
> 
> 标签：perl, function, export, subroutine

我想将所有 subs 公开到我的命名空间中，而不必一次列出一个：

```
@EXPORT = qw( firstsub secondsub third sub etc ); 
```

使用完全限定名称需要对现有代码进行大量更改，所以我宁愿不这样做。

有@EXPORT_ALL 吗？

我认为文档说这是一个坏主意，但我还是想这样做，或者至少知道如何去做。

要回答 Jon 的原因：现在为了快速重构，我想将一堆 subs 移动到他们自己的包中，并且对现有脚本（这些 subs 当前使用并经常重复）进行最少的麻烦和代码更改。

此外，大多数情况下，我只是好奇。（因为看起来 Exporter 也可能将其作为标准功能，但基于到目前为止的答案，有点令人惊讶的是它没有）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-08T23:58:35.647

根本不要进行任何导出，也不要在你的库中声明包名。只需加载文件，`require`所有内容都将在当前包中。十分简单。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-09T00:15:10.927

不。但是，如果您真的想...编写一个`import`遍历符号表并导出所有命名子例程的自定义程序。

```
# Export all subs in package. Not for use in production code!
sub import {
    no strict 'refs';

    my $caller = caller;

    while (my ($name, $symbol) = each %{__PACKAGE__ . '::'}) {
        next if      $name eq 'BEGIN';   # don't export BEGIN blocks
        next if      $name eq 'import';  # don't export this sub
        next unless *{$symbol}{CODE};    # export subs only

        my $imported = $caller . '::' . $name;
        *{ $imported } = \*{ $symbol };
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T23:09:30.710

警告，下面的代码与导出所有内容一样糟糕：

```
package Expo;

use base "Exporter";

seek DATA, 0, 0; #move DATA back to package

#read this file looking for sub names
our @EXPORT = map { /^sub\s+([^({\s]+)/ ? $1 : () } <DATA>;

my $sub = sub {}; #make sure anon funcs aren't grabbed

sub foo($) {
    print shift, "\n";
}

sub bar ($) {
    print shift, "\n";
}

sub baz{
    print shift,"\n";
}

sub quux {
    print shift,"\n";
}

1;

__DATA__ 
```

这是使用该模块的一些代码：

```
#!/usr/bin/perl

use strict;
use warnings;

use Expo;

print map { "[$_]\n" } @Expo::EXPORT;

foo("foo");
bar("bar");
baz("baz");
quux("quux"); 
```

这是它的输出：

```
[foo]
[bar]
[baz]
[quux]
foo
bar
baz
quux 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T22:33:36.130

您始终可以以完全指定的形式调用子例程：

```
MyModule::firstsub(); 
```

对于我在内部编写的模块，我发现这种约定非常有效。它需要更多的打字，但往往是更好的文档。

查看`perldoc perlmod`有关您要完成的工作的更多信息。

更一般地说，您可以查看`Exporter`'s 代码并了解它如何使用全局别名。或者，您可以检查模块的命名空间并导出每个子例程。（我现在不想搜索如何做到这一点，但是 Perl 使这相当容易。）或者你可以将你的子例程放在`main`包中：

```
 package main;
 sub firstsub() { ... } 
```

（我认为这不是一个好主意，但你比我更清楚你想要完成的事情。）

**如果**您知道自己在做什么，并且不只是试图避免考虑与外界的接口，那么这样做并没有错。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-09T01:29:04.413

也许您会对 CPAN 上的 Export* 模块之一感兴趣，它让您只需通过向子定义添加属性就可以将子标记为可导出？（不过不记得是哪一个了。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-11T18:23:01.537

[https://metacpan.org/pod/Exporter::Auto](https://metacpan.org/pod/Exporter::Auto)

出口商::汽车。这就是你所需要的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-02T00:32:25.440

虽然将模块中的所有 s 转储到调用者命名空间通常不是明智之举，但自动生成和变量`sub`有时很有用（而且更干燥！） 。`@EXPORT_OK``%EXPORT_TAGS`

最简单的方法是扩展 Exporter。一个简单的例子是这样的：

```
package Exporter::AutoOkay;
#
#   Automatically add all subroutines from caller package into the
#   @EXPORT_OK array. In the package use like Exporter, f.ex.:
#
#       use parent 'Exporter::AutoOkay';
#
use warnings;
use strict;
no strict 'refs';

require Exporter;

sub import {
    my $package = $_[0].'::';

    # Get the list of exportable items
    my @export_ok = (@{$package.'EXPORT_OK'});

    # Automatically add all subroutines from package into the list
    foreach (keys %{$package}) {
        next unless defined &{$package.$_};
        push @export_ok, $_;
    }

    # Set variable ready for Exporter
    @{$package.'EXPORT_OK'} = @export_ok;

    # Let Exporter do the rest
    goto &Exporter::import;
}

1; 
```

请注意，使用`goto`它会将我们从调用者堆栈中删除。

一个更完整的例子可以在这里找到：http: [//pastebin.com/Z1QWzcpZ](http://pastebin.com/Z1QWzcpZ)它自动从子程序前缀生成标签组。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-14T21:38:06.830

# 情况1

图书馆是：

```
package mycommon;

use strict;
use warnings;

sub onefunctionthatyoumadeonlibary() {
}
1; 
```

你可以使用它，调用 common:: ：

```
#!/usr/bin/perl
use strict;
use warnings;
use mycommon;

common::onefunctionthatyoumadeonlibary() 
```

# 案例2

库是，您只需导出它们：

```
package mycommon;

use strict;
use warnings;

use base 'Exporter';

our @EXPORT = qw(onefunctionthatyoumadeonlibary);
sub onefunctionthatyoumadeonlibary() {
}
1; 
```

在相同的“命名空间”中使用它：

```
#!/usr/bin/perl
use strict;
use warnings;
use mycommon qw(onefunctionthatyoumadeonlibary);

onefunctionthatyoumadeonlibary() 
```

我们也可以混合使用这两种情况，我们可以导出更常用的函数来使用它，而不需要调用包名和其他我们只用包名调用它并且不需要导出的函数。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-08T22:47:28.670

你将不得不做一些 typeglob munging。我在这里描述了类似的东西：

[有没有办法“使用”单个文件，然后在 Perl 中使用多个其他文件？](https://stackoverflow.com/questions/437785/is-there-a-way-to-use-a-single-file-that-in-turn-uses-multiple-others-in-perl/437835#437835)

那里的导入例程应该完全符合您的要求——只是不要将任何符号导入您自己的命名空间。

# wpf - WPF - 交换 xaml 文件以创建不同的屏幕设计

> ID：732137
> 
> 赞同：1
> 
> 时间：2009-04-08T22:27:12.137
> 
> 标签：wpf, xaml, navigation

我正在创建一个使用 MS 功能区控件的应用程序。功能区有几个选项卡。第一个选项卡标记为“查看”，下一个选项卡标记为“配置”。

在视图下，我显示了我们系统的视图，该视图位于 Window1.xaml 文件中。当我按下配置选项卡时，我希望视图消失并被不同的 xaml 替换，最好使用与 Window1.xaml 中的不同的 xaml。功能区控件不会消失，而是用作不同屏幕的导航器。目前，当我按下“配置”选项卡时，我会折叠包含“查看”屏幕的所有控件（功能区除外）的网格，并使包含“配置”屏幕的控件的网格可见。

当我将配置屏幕的 xaml 添加到 Window1.xaml 文件中时，这是我目前所做的，它当然会与视图屏幕一起显示在设计器中。为其他选项卡显示的屏幕添加 xaml 使这不切实际。

我想知道一个很好的方法来做到这一点。我想为每个“选项卡”屏幕创建 xaml 文件，并在按下选项卡时激活它们，就好像每个选项卡都是它自己的应用程序，可以来来去去。

我还不太了解页面导航（我在 WPF 中只有几个月大），但我认为这可能是一种方法。不确定功能区在这种情况下是否表现得很好。

我会很感激任何方向。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T22:54:12.180

这可以通过使用[CompositeWPF 的](http://compositewpf.codeplex.com/)RegionManager 通过将视图添加到区域并在应该显示另一个视图时停用它们来完美地实现。至少那是我在一个非常相似的场景中所做的并且效果很好。正如您所说，您希望它们表现得“就好像每个都是自己的应用程序一样”，compositewpf 可以免费提供模块化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T22:48:51.787

您应该将 View 和 Configure 选项卡的内容创建到它们自己的 UserControls 中。这仍然允许您以编程方式将它们交换进出，但会给您带来能够在您的设计器中单独编辑每一个的优势。

如果您使用的是 Expression Blend，您可以右键单击交互窗格中的任何子容器控件，然后给出“制作控件”选项。如果您在“配置”和“查看”选项卡上执行此操作，大部分工作将为您完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T22:52:02.763

这通常被称为“剥皮”您的应用程序，[这里](http://sandyvalley.spaces.live.com/blog/cns!AB1484B25F28E501!528.entry)有一篇关于剥皮只是应用程序的一部分的文章。如果你在谷歌上搜索皮肤和 WPF，你会得到很多关于如何做到这一点的好方法的示例代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T23:16:35.730

我会使用 Frame 元素。它允许您使用源属性从其他页面加载 XAML，如下所示：

```
<Frame Source="Configure.xaml"/> 
```

这样，当您按下配置按钮时，您可以设置一个事件，该事件创建一个带有框架元素的新 TabItem 作为内容，它将加载您想要查看的 XAML。

# css - “vertical-align: middle”在 Firefox 中不与中间对齐

> ID：732139
> 
> 赞同：28
> 
> 时间：2009-04-08T22:27:39.420
> 
> 标签：css, vertical-alignment

我正在尝试垂直对齐一些不同大小的文本，但是，Firefox 在中间上方显示较小的文本。

CSS：

```
div.categoryLinks {
    margin: 1em 16px;
    padding: 0 4px;
    border-width: 1px 0;
    border-style: solid;
    border-color: #ece754;
    background: #f7f5b7;
    color: #a49f1c;
    text-align: center;
    font-size: 1.4em;
}
div.categoryLinks em {
    font-size: 0.6em;
    font-style: normal;
    vertical-align: middle;
} 
```

HTML：

```
<div class="categoryLinks">
    <em>SECTION:</em>
    Page One &#183;
    Page Two &#183;
    <a href="link">Page Three</a>
</div> 
```

截图：（ [来源：][[doheth.co.uk](http://www.doheth.co.uk/files/valign.jpg)][）][![截屏](https://i.stack.imgur.com/gFlJW.jpg)](https://i.stack.imgur.com/gFlJW.jpg)

**更新**：为了清楚起见，我或多或少地知道如何`vertical-align`工作，即我已经知道常见的误解。

从更多调查来看，解决此问题的最简单方法似乎是将较大的文本包装在 a 中`span`并设置`vertical-align`它。then的两个孩子`.categoryLinks`彼此对齐。除非有人可以在没有额外标记的情况下展示更好的方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-08T22:33:57.317

**`display: inline-block`垂直对齐仅在表格单元格或元素上按预期工作。**如果您想了解更多信息，我建议您阅读[了解垂直对齐或“如何（不）垂直居中内容”](http://phrogz.net/CSS/vertical-align/index.html)。

**编辑：**您还有其他事情要做，因为这对我有用，就像在 Firefox 上一样。我什至降低了 SECTION: 的字体大小，它仍然居中。您是否使用过 Firebug 来查看其他 CSS 对其有何影响？

这按原样工作：

```
<html>
<head>
<style type="text/css">
div.categoryLinks {
        margin: 1em 16px;
        padding: 0 4px;
        border-width: 1px 0;
        border-style: solid;
        border-color: #ece754;
        background: #f7f5b7;
        color: #a49f1c;
        text-align: center;
        font-size: 1.4em;
}
div.categoryLinks em {
        font-size: 0.4em;
        font-style: normal;
        vertical-align: middle;
}
</style>
</head>
<body>
<div class="categoryLinks">
        <em>SECTION:</em>
        Page One &#183;
        Page Two &#183;
        <a href="link">Page Three</a>
</div>
</body> 
```

**注意：**部分字体大小从原来的 0.6em 更改为 0.4em 以强调这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T22:32:22.937

Firefox 正在正确呈现。vertical-align 属性是内联的，这意味着它不适用于像 <div>（和 <p> 等）这样的块元素。尝试添加*display: inline*看看是否有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T22:33:37.910

垂直对齐只应该适用于内联块元素（我认为图像是默认情况下唯一具有此布局属性的东西），因此要使用它来定位内联元素，首先将其变成内联块，然后你可以使用 margin 和 padding 来定位它，类似于你对普通块元素的定位：

```
div.categoryLinks {
        margin: 1em 16px;
        padding: 0 4px;
        border-width: 1px 0;
        border-style: solid;
        border-color: #ece754;
        background: #f7f5b7;
        color: #a49f1c;
        text-align: center;
        font-size: 1.4em;

}
div.categoryLinks em {
            font-size: 0.6em;

           display:inline-block;
        vertical-align:top;
        font-style: normal;
        padding: 2px 0 0 0;

} 
```

不过，您必须[为 firefox 2 稍微调整一下](http://www.nczonline.net/blog/2006/10/12/pain-with-inline-block/)，但这是因为 firefox 不支持 web 标准的一个更罕见的例子。另一方面，由于很少有人仍在使用 ffx2，因此您不必费心进行调整，这只是一个非常小的设计缺陷。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-10T15:40:48.643

我解决了这个问题，只是删除了：

```
 white-space: nowrap; 
```

从父 div。我不知道为什么，但添加了这条规则后，Firefox 不适用：

```
vertical-align: middle; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-26T19:45:34.490

我有同样的问题。这对我有用：

```
 <style type="text/css">
    div.parent {
         position: relative;
    }

    /*vertical middle and horizontal center align*/
    img.child {
        bottom: 0;
        left: 0;
        margin: auto;
        position: absolute;
        right: 0;
        top: 0;
    }
    </style>

    <div class="parent">
        <img class="child"> 
    </div> 
```

# java - SWFUpload 示例/信息和 Java

> ID：732145
> 
> 赞同：1
> 
> 时间：2009-04-08T22:31:27.260
> 
> 标签：java, flash, file-upload

我构建了几个工作示例，将图像上传到服务器并将其显示在页面上而无需刷新。一种方法是 iframe 方法，另一种是[DWR](http://directwebremoting.org/)（版本 3）。

我想知道是否有人有使用 SWFUpload 的示例。我不太确定它是如何连接到服务器端代码的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T00:35:12.593

就个人而言，SWFUpload 总是成功的。我一直在专门使用它来上传一堆文件而不必“浏览”几次。集成服务器端很容易，因为您所要做的就是接受传入的文件，就好像它们是通过表单上传的一样。到目前为止，我遇到的唯一问题是当您必须在服务器会话的上下文中上传时，虽然有一些解决方法（通过 get 发送 SESSID 等）。

[就示例而言，我认为您在他们的存储库](http://code.google.com/p/swfupload/downloads/list)中拥有所有您需要的东西。

# c# - 我的字符串反转功能有什么问题？（C＃）

> ID：732147
> 
> 赞同：1
> 
> 时间：2009-04-08T22:32:05.870
> 
> 标签：c#

```
char[] a = { 'o', 'r', 'a', 'n', 'g', 'e' };

for (int i = 0; i < a.Length/2; i++)
{        
  a[i] = (char)(((uint)a[i])|((uint)a[a.Length-(i+1)]));
  a[a.Length-(i+1)] = (char)(((uint)a[i])^((uint)a[a.Length-(i+1)]));
  a[i] = (char)(((uint)a[i])^((uint)a[a.Length-(i+1)]));
} 
```

我知道如何使用标准 .NET 功能和临时变量来实现这一点。我只是好奇我在上面的例子中具体做错了什么，导致它在以下工作正常时不起作用：

```
int a = 5;
int b = 10;

a = a | b;
b = a ^ b;
a = a ^ b; 
```

上面的字符串版本不只是其中的一系列吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-08T22:46:53.493

呵呵，没有 OR/XOR/XOR 交换之类的东西——它应该是“三异或”交换。

```
int a = 8, b = 10;
a ^= b;
b ^= a;
a ^= b; 
```

我不明白你为什么要使用它（除了新奇价值）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T22:54:09.357

它不起作用的原因是你使用了一个坏例子。您不能使用 OR 然后 XOR 然后 XOR 交换两个值。它仅在您的示例中有效，因为 5 和 10 没有共同的位，因此第一个 OR 不会破坏任何信息：

```
a = 0101 #5
b = 1010 #10
# step 1 (OR into a)
a = 1111
b = 1010
# step 2 (XOR into b)
a = 1111
b = 0101
# step 3 (XOR into a)
a = 1010 #10
b = 0101 #5 
```

但如果它们有任何共同点，它就行不通了——让我们试试 13 和 10：

```
a = 1101 #13
b = 1010 #10
# step 1 (OR into a)
a = 1111
b = 1010
# step 2 (XOR into b)
a = 1111
b = 0101
# step 3 (XOR into a)
a = 1010 #10
b = 0101 #5 
```

请注意，即使我们从 13 和 10 开始，我们现在仍然有值 5 和 10。您正在寻找的是三次异或交换：

```
a = 1101 #13
b = 1010 #10
# step 1 (XOR into a)
a = 0111
b = 1010
# step 2 (XOR into b)
a = 0111
b = 1101
# step 3 (XOR into a)
a = 1010 # 10
b = 1101 #13 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T22:39:54.180

这是破坏性的（因为按位或）。为什么不在循环中使用临时变量而不是异或：

```
int tmp = a[i];
a[i] = a[a.Length-(i+1)];
a[a.Length-(i+1)] = tmp; 
```

在回答您的第二部分时，您在二进制文件中所做的是：

```
a = 0101;
b = 1010;
a = 0101 | 1010 === 1111;
... 
```

当您将这两个值组合在一起时，您会破坏原始数字。它适用于 5 和 10，因为这两个数字之间没有共同的位。当您执行以下操作时：

```
a = 0110;  // 6 (base ten)
b = 1010;  // 10 (base ten)
a = a | b; // this is now 1110, or 14 (base ten) 
```

您无法再次恢复 6 和 10，因为 OR 是不可逆的操作。异或是可逆的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T22:41:52.100

抱歉，如果这不是您的问题的重点，但如何：

```
 char[] a = { 'o', 'r', 'a', 'n', 'g', 'e' };
 a = Array.Reverse(a) 
```

我错过了什么吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T22:54:05.380

其他人已经指出了使用 XOR 运算的正确解决方案......这并不完全是一个答案，但我想我会指出该[`Interlocked.Exchange`](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.exchange.aspx)方法非常适合这类任务。（它将交换作为原子操作执行，因此可以跨线程工作，尽管这在这里似乎无关紧要。）尽管如此，我几乎总是认为它是交换两个变量的最简单/最优雅的解决方案。

这是一个如何将它与您发布的代码一起使用的示例。

```
char[] a = { 'o', 'r', 'a', 'n', 'g', 'e' };

for (int i = 0; i < a.Length/2; i++)
{        
    a[a.Length-(i+1)] = Interlocked.Exchange(ref a[a.Length-(i+1)], a[i]);
} 
```

希望对您有所帮助，即使它不是您问题的具体答案...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T22:36:58.667

```
List<char> characters = new List<char>();

characters.AddRange("string".ToCharArray());

characters.Reverse();

string reversed = new string(characters.ToArray()); 
```

# java - Java Main 方法，良好的编码风格

> ID：732151
> 
> 赞同：36
> 
> 时间：2009-04-08T22:33:02.513
> 
> 标签：java, coding-style

我和我的一位朋友就 Java 中 main 方法的正确和良好使用进行了相当长的讨论。基本上我们有一个这样的类：

```
public class AnImporter implements Runnable {
  // some methods, attributes, etc.
} 
```

但是把主要方法放在哪里呢？我认为“将代码保留在它所属的位置”是一种很好的做法，从而将上面的代码变成

```
public class AnImporter implements Runnable {
  public static void main(String [] args){
    // Startup code for Importer App here
  }
  // some methods, attributes, etc.
} 
```

虽然我的朋友认为“启动代码与应用程序本身无关”，但它应该放在另一个类中，如下所示：

```
public class AnImporter implements Runnable {
  // some methods, attributes, etc.
}

public class AnApplication {
  // Nothing here
  public static void main(String [] args){
    AnImporter a = new AnImporter();
    // Startup code here
  }
  // Nothing here
} 
```

尽管我们讨论了一段时间，但最终我们都没有得出结论，在 Java 中哪种方法更好。你对这个话题有什么看法？在哪里，最重要的是，为什么，你把你的主要方法放在你放置它的地方？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-08T22:38:00.143

我同意你朋友的看法。您正在 AnImporter 中构建一个潜在的可重用服务，该服务可能用于具有多个 main 的多个程序中。因此，将一个 main 特殊并嵌入到 AnImporter 中没有多大意义。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-08T22:39:40.343

我可能会和你的朋友一起去，因为我希望尽快用 main 方法离开课堂。当您想以原子方式进行测试（只是可运行类）或想模拟事物时，它有助于促进测试。您越早退出主要方法，您拥有的选择就越多。如果你有一个包含 main 方法和其他东西的类，它可能会很快变得混乱。（即使用一个简单的例子，比如你描述的那个，看起来可能不是这样）

但我想说可读性和可测试性是尽快退出主要方法（及其包含类）的两个很好的理由。但是，嘿..那只是我;）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-08T22:39:32.667

我不会用 main 方法污染 Runnable 类。几乎所有在您的应用程序中执行任何操作的类也是如此。通常我会有这样的课程：

```
public class App {
  public static void main(String args[]) {
    Thread t = new Thread(new Blah());
    t.start();
      synchronized (t) {
        t.wait();
      }
  }
}

public class Blah implements Runnable {
  public void run() {
    // do normal stuff
  }
} 
```

代替：

```
public class Blah implements Runnable {
  public void run() {
    // do normal stuff
  }

  public static void main(String args[]) {
    Thread t = new Thread(new Blah());
    t.start();
    synchronized (t) {
      t.wait();
    }
  }
} 
```

只是感觉更干净。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-08T22:43:24.500

由于以下几个原因，我总是将主要代码与其余代码分开：

1) 在某种程度上，main 是一种让您的程序从命令行启动的 hack。任何包含它的类都应该有一个单一的职责：让程序从命令行启动。通过将它与您的主要可运行文件放在一起，您正在污染可运行文件。

2) 您最终可能会拥有多个电源（例如，使用某些默认参数、使用特殊模式等）

3) 您最终可能会从不同的环境（例如，Eclipse 插件或 OGSI 模块、小程序、基于 Web 的工具等）运行程序。在这些情况下，您可能希望限制对 main.js 的访问。将它与功能一起使用可以防止这种情况。

4) 有时将 main 保留在默认包中以加快运行时执行速度会更容易（例如，java myblabla par1 par2 par3），但您绝对不希望将其余代码放在默认包中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-08T22:43:51.113

除了 OS shell 之外，main（字符串列表）的接口几乎没有用。

您的 main 中应该包含尽可能少的代码。

确实，您`public class ThisIsMyApp {...}`应该只是操作系统接口到真正的工作，这在别处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-23T13:15:52.083

我会将主要方法与代码分开。

虽然我也有不同类型的项目。它不包括解决方案的真正工作程序。在这里，我需要使用（和开发）同一个库针对不同的问题运行不同的解决方案。不同的问题不是并行的。我需要从我的 IDE 单独运行一个问题。我发现通过 PSVM 方法使用具有大量类的同一个项目很方便。

该项目包含超过 400 个不同问题的编程竞赛解决方案。你有更好的组织吗？

# c# - ClientScriptManager.RegisterForEventValidation 与 HiddenField

> ID：732158
> 
> 赞同：1
> 
> 时间：2009-04-08T22:34:58.560
> 
> 标签：c#, asp.net, eventvalidation, clientscriptmanager

我正在尝试使用 ClientScriptManager.RegisterForEventValidation 来注册一个隐藏字段和值，我正在使用 ClientScriptManager.RegisterHiddenField 添加。我在渲染事件期间这样做。我没有收到任何错误，但 ASP.NET 2.0 似乎没有验证该字段。我可以使用 Firefox 和 Firebug 更改值或删除整个字段客户端，并且 ASP.NET 不会像应有的那样抛出错误。

来自自定义 Page 类的示例代码：

```
protected override void Render(HtmlTextWriter writer)
{
    ClientScript.RegisterHiddenField("stuff", "things");
    ClientScript.RegisterForEventValidation("stuff", "things");
    base.Render(writer);
} 
```

隐藏字段已添加到页面，但 ASP.NET 不会在回发时验证该字段或值。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T03:58:41.683

我了解您要执行的操作，但使用事件验证 API 并不合适，因为它旨在验证客户端引发的回发或回调事件对于目标服务器控件是否正确，例如，确保单击由正确的按钮处理，或者检查下拉列表上的更改事件是否不是服务器最初“已知”的值。

在您的代码中，您正在直接向客户端生成一个隐藏字段，因此服务器无法控制在回发时引用。即使您在服务器页面上使用了隐藏字段控件，您仍然无法验证字段值，因为该控件不会生成回发事件（用户无法与之交互，因此没有服务器验证的事件）。

最简单的解决方案是使用 ViewState 来存储字段的值，然后在回发时验证该字段的发布值是否等于存储在 ViewState 中的值。ViewState 默认情况下是加密的，因此它是存储不应在客户端更改的数据的安全位置。

# c++ - 如何在 C++ 中反向迭代地图？

> ID：732160
> 
> 赞同：41
> 
> 时间：2009-04-08T22:36:27.450
> 
> 标签：c++, loops, dictionary, for-loop, containers

我在 GCC C++ 中的地图上反向迭代时遇到了麻烦。当我使用反向迭代器时，似乎我无法为它分配任何东西 - 编译器抱怨。我正在使用前向迭代器处理一些尴尬的代码，但它不是很优雅。有什么想法吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-04-08T22:40:51.433

这是一个通过 a 向后迭代的示例`std::map`：

```
#include <iostream>
#include <map>
#include <string>

int main() {
    std::map<std::string, std::string> m;
    m["a"] = "1";
    m["b"] = "2";
    m["c"] = "3";

    for (auto iter = m.rbegin(); iter != m.rend(); ++iter) {
        std::cout << iter->first << ": " << iter->second << std::endl;
    }
} 
```

如果您是 C++11 之前的版本，则只需拼出`auto`，即：

```
std::map<std::string, std::string>::reverse_iterator 
```

请注意，如果您使用的是 boost，则可以将基于范围的 for 循环与反向适配器一起使用：

```
#include <boost/range/adaptor/reversed.hpp>

for (auto& iter : boost::adaptors::reverse(m)) {
    std::cout << iter.first << ": " << iter.second << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-07-31T15:38:07.863

从[C++20](https://en.wikipedia.org/wiki/C%2B%2B20)开始，您可以使用[Ranges 库](https://en.cppreference.com/w/cpp/ranges)[`std::views::reverse`](https://en.cppreference.com/w/cpp/ranges/reverse_view)中的范围适配器。如果将其添加到具有[结构化绑定](https://en.cppreference.com/w/cpp/language/structured_binding)[的基于范围的 for 循环](https://en.cppreference.com/w/cpp/language/range-for)中，则可以按如下方式向后迭代 an ：`std::map`

```
#include <map>
#include <ranges>
#include <iostream>

int main() {
    std::map<std::string, int> m = { {"a", 1}, {"b", 2}, {"c", 3} };

    for (auto const& [k, v] : m | std::views::reverse)
        std::cout << k << " => " << v << std::endl;

    return 0;
} 
```

输出：

> c => 3
> b => 2
> a => 1

[魔杖盒上的代码](https://wandbox.org/permlink/uD41hqXcttIfAucN)

# html - 在我的 Perl CGI 脚本中打印 HTML 后我该怎么办？

> ID：732173
> 
> 赞同：4
> 
> 时间：2009-04-08T22:39:55.773
> 
> 标签：html, perl, cgi

从 Perl CGI 脚本打印 HTML 后应该调用什么？我见过空洞的`return`陈述、`exit`陈述，在某些情况下什么也没有。有关系吗？

```
#!perl

print "Content-type: text/html\n\n";
print <<'END_HTML';
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Hello world!</title>
</head>
<body>
    <h1>Hello world!</h1>
</body>
</html>
END_HTML

# do anything else here?
# return;
# exit; 
```

# 更新

假设您有一些测试，您正在打印不在文件末尾的 HTML。在这种情况下，调用 exit 或 return 以直观地显示脚本应该在那个时候结束是不是更清楚？ *我知道这不是写这篇文章的最佳方式——为了这个问题，请从表面上看。*

```
#!perl

use CGI;
my $q          = CGI->new();
my $action     = $q->param('action');

my $html_start = "Content-type: text/html\n\n";
$html_start   .= <<'END_HTML';
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Hello world!</title>
</head>
<body>
END_HTML

my $html_end = <<'END_HTML';
</body>
</html>
END_HTML

if ($action eq 'foo') {
    print $html_start;
    print '<p>foo</p>';
    print $html_end;
    # do anything else here?
}
else {
    print $html_start;
    print '<p>bar</p>';
    print $html_end;
    # do anything else here?
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T23:02:59.883

你应该总是在你的输出结束时打印出“\n\n”来告诉网络服务器输出已经完成。Apache 可能会在脚本成功终止时为您执行此操作。

如果您的脚本已完成，您应该在技术上调用具有适当退出状态的“exit”——成功为零，错误为非零。网络服务器检查退出状态并呈现适当的页面（如果退出状态显示除成功以外的任何内容，则错误代码 500 是典型的）。如果您没有指定“返回”值或直接调用 exit，Perl（在这种情况下）将假定成功终止，并且网络服务器将处理您的 CGI 脚本，就像您调用“exit(0)”一样。

这在 CGI 规范中都有描述（RFC 3875 是当前的，IIRC）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T22:48:56.017

我想这更多的是关于编码风格而不是功能的问题。如果您有一个简单、直接且没有分支的程序，则几乎没有理由用任何特殊的东西来标记程序的终止：

*   **return**不会返回任何人都可以使用的任何东西，因为你的程序在这里结束
*   **exit**只会以状态 0 退出，无论如何这都会自然发生

但是，如果结构更复杂，我建议用特定的东西*标记*终止点，以向阅读您的代码的人发出信号，对于定义的一组条件，那里不再需要考虑任何事情。

我会使用*exit*而不是*return*，原因很简单，return 可能会被误认为是 sub 的结束，而 exit 非常明确地指出程序在此时*终止。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T22:47:17.703

不，没关系。我总是让剧本自己死掉，而不是“回归”；或“退出；” 因为不需要这些语句中的任何一个（在 perl 文档的末尾），它与“exit;”是一样的。或“退出 0；”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T23:06:18.080

我会推荐 return 而不是 exit，这样如果你切换到 CGI::Fast 你就可以把它变成一个 sub。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T22:58:09.580

如果它是一个独立的东西，你不必返回或退出是有道理的。但是如果这个片段来自一个函数呢？它仍然适用吗？出于某种原因，是否会首选返回或退出？它仍然只是造型吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T05:52:05.733

要回答您的“更新”问题：在我当前的应用程序中，我使用常用​​方法来执行以下操作：

```
# UI.pm
package UI;

sub top    { print "<html><head><title>$_[0]</title><body>"; }
sub bottom { print "</body></html"; }

# All the individual .cgi files
package main;

UI::top('Welcome to my page');
print "<p>Welcome to my page!</p>";
UI::bottom(); 
```

如果您喜欢冒险，您可以自动[上钩`BEGIN`并`END`](http://perldoc.perl.org/perlmod.html)自动执行此操作，但我不会 - 我认为为了一个相当小的好处而摆弄太多了。

这不是我现在要做的，如果我必须重新做的话：我会更多地依赖某种中间层，比如 Catalyst，它可以让我快速升级到 mod_perl 或回到 CGI . 或者更好的是，从头开始编写我的应用程序以使用更多的 AJAX - 这样，我的大部分“操作”都是由非常小的 Perl 脚本执行的，这些脚本只处理输入并在`text/plain`or中响应 Javascript 应用程序`text/json`。

# sql - 将数据库 SQL Server 迁移到 Sybase

> ID：732184
> 
> 赞同：1
> 
> 时间：2009-04-08T22:43:32.283
> 
> 标签：sql, sql-server, sybase

我正在将数据库从 MS-SQL 迁移到 SyBase 15.2，请提出任何可以帮助我完成此任务的工具。

还请发表您使用 SyBase 的经验，尤其是 Replicator。

非常感谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T04:33:22.863

取决于您的数据库的复杂性。

我使用 DTS 从 Sybase 11/12 迁移到 MS-SQL 2000。我必须对架构和数据进行一些清理。

我不得不从内存中使用 bcp 重新复制一些数据。我认为罪魁祸首是“金钱”数据类型，其中的值没有正确出现。

您还可以使用 SQL Server 导入和导出实用程序。我不知道复制索引、约束和其他内容的效果如何（如果有的话）。可能只是复制表定义和数据。

因此，作为 SQL Server 一部分的 DTS 和 bcp（无论如何对于 SQL 2000 来说都是如此），*可能会*完成这项工作。

有 3rd 方工具，例如 Erwin 和 DbArtisan，我已经有 6 到 8 年没有使用它们了，但我认为它们会完成这项工作。不是免费的。

可能您可以使用复制来发布快照并让 Sybase 订阅它。

# ms-access - MS Access 中的一对一关系

> ID：732187
> 
> 赞同：2
> 
> 时间：2009-04-08T22:45:58.673
> 
> 标签：ms-access, database-design, foreign-key-relationship

我在 MS Access 中的两个表之间创建一对一关系时遇到问题 - 当我创建关系时，它默认为“多对一”，我看不到更改它的选项。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T22:49:08.900

访问没有这样的概念。您可以将两个表合并为一个，也可以在两个表上为公共字段放置唯一索引。您还有其他期望的好处吗？

我想你可以在两个方向上创建 FK 关系，但我不确定它会给你带来什么，除了查询提示。

* * *

编辑：来自评论的重要更新说明 -

> > 我没有看到问题。我在计算机上打开了一个随机数据库，复制了一个表，然后打开了关系编辑器。将一个 ID 字段拖到另一个以创建关系。[http://i43.tinypic.com/2v30x7c.png](http://i43.tinypic.com/2v30x7c.png)一对一是一种选择。——布伦丹·基德威尔

# python - 使用 mod_wsgi 和 Django 提供静态文件

> ID：732190
> 
> 赞同：10
> 
> 时间：2009-04-08T22:47:16.270
> 
> 标签：python, django, mod-wsgi, mod-python

我有一个使用 mod_python 的 django 应用程序，这是相当典型的配置，除了媒体文件由文档根目录中的（我知道，不推荐）“媒体”目录提供服务。我想测试并可能使用 mod_wsgi 进行部署，但我不知道如何创建简单的东西来提供静态文件。mod_python 允许使用 Apache 指令，例如：

```
<Location '/'>
    SetHandler MyApplication.xyz.....
</Location>

<Location '/media'>
    SetHandler None
</Location> 
```

django 文档似乎指向上面的第二个块作为对 mod_wsgi 进行类似异常的正确方法，但在我的测试中，根目录下的所有内容仍被发送到 wsgi 应用程序。有没有一种使用 mod_wsgi 设置静态媒体目录的好方法，或者由于令人信服的技术原因，我试图做的事情是故意不受支持的？欢迎提出完全不同方法的答案。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-09T03:42:00.727

我在同一台服务器上运行了十几个 Django 站点，这就是我配置媒体 URL 的方式。

每个 VirtualHost 都有以下配置：

```
Alias /media /path/to/media/
<Directory /path/to/media>
    Include /etc/apache2/vhosts.d/media.include
</Directory> 
```

这样我就可以在一个文件中对媒体处理进行任何更改。

然后，我的 media.include 文件如下所示：

```
Order allow,deny
Allow from all
SetHandler None
FileETag none
Options FollowSymLinks

<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/gif "access plus 30 days"
    ExpiresByType image/jpg "access plus 30 days"
    ExpiresByType image/png "access plus 30 days"
    ExpiresByType image/jpeg "access plus 30 days"
    ExpiresByType text/css "access plus 30 days"
    ExpiresByType application/x-javascript "modification plus 2 years"
</IfModule>

<IfModule mod_headers.c>
    Header append Vary Accept-Encoding
</IfModule>

AddOutputFilterByType DEFLATE text/html text/css text/plain 
```

这对我来说效果很好，并且从[YSlow获得了](https://addons.mozilla.org/en-US/firefox/addon/5369)**A**级（另请参阅[YSlow 上的 Jeff Atwood](http://www.codinghorror.com/blog/archives/000932.html)）。

另请注意，对于根目录，我使用以下配置：

```
WSGIScriptAlias / /path/to/app.wsgi
<Directory /path/to>
    Options +ExecCGI
    Allow from all
</Directory> 
```

...应该**在**配置文件中的别名 /media 之后（因为 Apache 按顺序查看别名）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-24T11:50:44.470

mod_wsgi 文档解释了如何设置静态文件，这些静态文件出现在挂载 WSGI 应用程序的 URL 下方。看：

[http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines#Hosting_Of_Static_Files](http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines#Hosting_Of_Static_Files)

请注意，当使用 WSGIScriptAlias 指令挂载 WSGI 应用程序时，不需要“Options +ExecCGI”。只有在使用 AddHandler 将应用程序作为资源挂载时才需要“ExecCGI”选项。

# python - 在没有实例化窗口的情况下获取 Tk winfo_rgb()

> ID：732192
> 
> 赞同：2
> 
> 时间：2009-04-08T22:47:25.880
> 
> 标签：python, colors, tkinter

我知道我可以调用`Tkinter.Tk().winfo_rgb(color)`来获取代表命名颜色的值元组。

例如`Tkinter.Tk().winfo_rgb("red")`返回`(65535, 0, 0)`

问题是它也打开了一个窗口。我希望将一些颜色计算抽象到一个通用颜色类中，并处理该类是否被实例化，`"red"`或者`"#ff0000"`甚至可能是其他一些格式。

抽象类后，如果不实例化新窗口或传入父级，我就没有`tk`父级可以从中提取此信息。

`Tk`有没有办法在没有实例化窗口的情况下获得这种颜色名称→十六进制值转换？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T04:50:27.250

Tkinter 和 Python Imaging Library 都说他们使用 X Window 颜色名称，所以如果你能得到 Shane 对 ImageDraw 模块的建议，那听起来最好。我不确定是否可以依赖可用的 ImageDraw，因此我从[Tk 文档](http://www.tcl.tk/man/tcl8.5/TkCmd/colors.htm)中解析了列表，以声明用于查找颜色的哈希表。我不确定为什么文档中的名称是大小写混合的，但我使用了不区分大小写的查找。

```
color_map = {
    'alice blue': '#F0F8FF',
    'AliceBlue': '#F0F8FF',
    'antique white': '#FAEBD7',
    'AntiqueWhite': '#FAEBD7',
    'AntiqueWhite1': '#FFEFDB',
    'AntiqueWhite2': '#EEDFCC',
    'AntiqueWhite3': '#CDC0B0',
    'AntiqueWhite4': '#8B8378',
    'aquamarine': '#7FFFD4',
    'aquamarine1': '#7FFFD4',
    'aquamarine2': '#76EEC6',
    'aquamarine3': '#66CDAA',
    'aquamarine4': '#458B74',
    'azure': '#F0FFFF',
    'azure1': '#F0FFFF',
    'azure2': '#E0EEEE',
    'azure3': '#C1CDCD',
    'azure4': '#838B8B',
    'beige': '#F5F5DC',
    'bisque': '#FFE4C4',
    'bisque1': '#FFE4C4',
    'bisque2': '#EED5B7',
    'bisque3': '#CDB79E',
    'bisque4': '#8B7D6B',
    'black': '#000000',
    'blanched almond': '#FFEBCD',
    'BlanchedAlmond': '#FFEBCD',
    'blue': '#0000FF',
    'blue violet': '#8A2BE2',
    'blue1': '#0000FF',
    'blue2': '#0000EE',
    'blue3': '#0000CD',
    'blue4': '#00008B',
    'BlueViolet': '#8A2BE2',
    'brown': '#A52A2A',
    'brown1': '#FF4040',
    'brown2': '#EE3B3B',
    'brown3': '#CD3333',
    'brown4': '#8B2323',
    'burlywood': '#DEB887',
    'burlywood1': '#FFD39B',
    'burlywood2': '#EEC591',
    'burlywood3': '#CDAA7D',
    'burlywood4': '#8B7355',
    'cadet blue': '#5F9EA0',
    'CadetBlue': '#5F9EA0',
    'CadetBlue1': '#98F5FF',
    'CadetBlue2': '#8EE5EE',
    'CadetBlue3': '#7AC5CD',
    'CadetBlue4': '#53868B',
    'chartreuse': '#7FFF00',
    'chartreuse1': '#7FFF00',
    'chartreuse2': '#76EE00',
    'chartreuse3': '#66CD00',
    'chartreuse4': '#458B00',
    'chocolate': '#D2691E',
    'chocolate1': '#FF7F24',
    'chocolate2': '#EE7621',
    'chocolate3': '#CD661D',
    'chocolate4': '#8B4513',
    'coral': '#FF7F50',
    'coral1': '#FF7256',
    'coral2': '#EE6A50',
    'coral3': '#CD5B45',
    'coral4': '#8B3E2F',
    'cornflower blue': '#6495ED',
    'CornflowerBlue': '#6495ED',
    'cornsilk': '#FFF8DC',
    'cornsilk1': '#FFF8DC',
    'cornsilk2': '#EEE8CD',
    'cornsilk3': '#CDC8B1',
    'cornsilk4': '#8B8878',
    'cyan': '#00FFFF',
    'cyan1': '#00FFFF',
    'cyan2': '#00EEEE',
    'cyan3': '#00CDCD',
    'cyan4': '#008B8B',
    'dark blue': '#00008B',
    'dark cyan': '#008B8B',
    'dark goldenrod': '#B8860B',
    'dark gray': '#A9A9A9',
    'dark green': '#006400',
    'dark grey': '#A9A9A9',
    'dark khaki': '#BDB76B',
    'dark magenta': '#8B008B',
    'dark olive green': '#556B2F',
    'dark orange': '#FF8C00',
    'dark orchid': '#9932CC',
    'dark red': '#8B0000',
    'dark salmon': '#E9967A',
    'dark sea green': '#8FBC8F',
    'dark slate blue': '#483D8B',
    'dark slate gray': '#2F4F4F',
    'dark slate grey': '#2F4F4F',
    'dark turquoise': '#00CED1',
    'dark violet': '#9400D3',
    'DarkBlue': '#00008B',
    'DarkCyan': '#008B8B',
    'DarkGoldenrod': '#B8860B',
    'DarkGoldenrod1': '#FFB90F',
    'DarkGoldenrod2': '#EEAD0E',
    'DarkGoldenrod3': '#CD950C',
    'DarkGoldenrod4': '#8B6508',
    'DarkGray': '#A9A9A9',
    'DarkGreen': '#006400',
    'DarkGrey': '#A9A9A9',
    'DarkKhaki': '#BDB76B',
    'DarkMagenta': '#8B008B',
    'DarkOliveGreen': '#556B2F',
    'DarkOliveGreen1': '#CAFF70',
    'DarkOliveGreen2': '#BCEE68',
    'DarkOliveGreen3': '#A2CD5A',
    'DarkOliveGreen4': '#6E8B3D',
    'DarkOrange': '#FF8C00',
    'DarkOrange1': '#FF7F00',
    'DarkOrange2': '#EE7600',
    'DarkOrange3': '#CD6600',
    'DarkOrange4': '#8B4500',
    'DarkOrchid': '#9932CC',
    'DarkOrchid1': '#BF3EFF',
    'DarkOrchid2': '#B23AEE',
    'DarkOrchid3': '#9A32CD',
    'DarkOrchid4': '#68228B',
    'DarkRed': '#8B0000',
    'DarkSalmon': '#E9967A',
    'DarkSeaGreen': '#8FBC8F',
    'DarkSeaGreen1': '#C1FFC1',
    'DarkSeaGreen2': '#B4EEB4',
    'DarkSeaGreen3': '#9BCD9B',
    'DarkSeaGreen4': '#698B69',
    'DarkSlateBlue': '#483D8B',
    'DarkSlateGray': '#2F4F4F',
    'DarkSlateGray1': '#97FFFF',
    'DarkSlateGray2': '#8DEEEE',
    'DarkSlateGray3': '#79CDCD',
    'DarkSlateGray4': '#528B8B',
    'DarkSlateGrey': '#2F4F4F',
    'DarkTurquoise': '#00CED1',
    'DarkViolet': '#9400D3',
    'deep pink': '#FF1493',
    'deep sky blue': '#00BFFF',
    'DeepPink': '#FF1493',
    'DeepPink1': '#FF1493',
    'DeepPink2': '#EE1289',
    'DeepPink3': '#CD1076',
    'DeepPink4': '#8B0A50',
    'DeepSkyBlue': '#00BFFF',
    'DeepSkyBlue1': '#00BFFF',
    'DeepSkyBlue2': '#00B2EE',
    'DeepSkyBlue3': '#009ACD',
    'DeepSkyBlue4': '#00688B',
    'dim gray': '#696969',
    'dim grey': '#696969',
    'DimGray': '#696969',
    'DimGrey': '#696969',
    'dodger blue': '#1E90FF',
    'DodgerBlue': '#1E90FF',
    'DodgerBlue1': '#1E90FF',
    'DodgerBlue2': '#1C86EE',
    'DodgerBlue3': '#1874CD',
    'DodgerBlue4': '#104E8B',
    'firebrick': '#B22222',
    'firebrick1': '#FF3030',
    'firebrick2': '#EE2C2C',
    'firebrick3': '#CD2626',
    'firebrick4': '#8B1A1A',
    'floral white': '#FFFAF0',
    'FloralWhite': '#FFFAF0',
    'forest green': '#228B22',
    'ForestGreen': '#228B22',
    'gainsboro': '#DCDCDC',
    'ghost white': '#F8F8FF',
    'GhostWhite': '#F8F8FF',
    'gold': '#FFD700',
    'gold1': '#FFD700',
    'gold2': '#EEC900',
    'gold3': '#CDAD00',
    'gold4': '#8B7500',
    'goldenrod': '#DAA520',
    'goldenrod1': '#FFC125',
    'goldenrod2': '#EEB422',
    'goldenrod3': '#CD9B1D',
    'goldenrod4': '#8B6914',
    'gray': '#BEBEBE',
    'gray0': '#000000',
    'gray1': '#030303',
    'gray2': '#050505',
    'gray3': '#080808',
    'gray4': '#0A0A0A',
    'gray5': '#0D0D0D',
    'gray6': '#0F0F0F',
    'gray7': '#121212',
    'gray8': '#141414',
    'gray9': '#171717',
    'gray10': '#1A1A1A',
    'gray11': '#1C1C1C',
    'gray12': '#1F1F1F',
    'gray13': '#212121',
    'gray14': '#242424',
    'gray15': '#262626',
    'gray16': '#292929',
    'gray17': '#2B2B2B',
    'gray18': '#2E2E2E',
    'gray19': '#303030',
    'gray20': '#333333',
    'gray21': '#363636',
    'gray22': '#383838',
    'gray23': '#3B3B3B',
    'gray24': '#3D3D3D',
    'gray25': '#404040',
    'gray26': '#424242',
    'gray27': '#454545',
    'gray28': '#474747',
    'gray29': '#4A4A4A',
    'gray30': '#4D4D4D',
    'gray31': '#4F4F4F',
    'gray32': '#525252',
    'gray33': '#545454',
    'gray34': '#575757',
    'gray35': '#595959',
    'gray36': '#5C5C5C',
    'gray37': '#5E5E5E',
    'gray38': '#616161',
    'gray39': '#636363',
    'gray40': '#666666',
    'gray41': '#696969',
    'gray42': '#6B6B6B',
    'gray43': '#6E6E6E',
    'gray44': '#707070',
    'gray45': '#737373',
    'gray46': '#757575',
    'gray47': '#787878',
    'gray48': '#7A7A7A',
    'gray49': '#7D7D7D',
    'gray50': '#7F7F7F',
    'gray51': '#828282',
    'gray52': '#858585',
    'gray53': '#878787',
    'gray54': '#8A8A8A',
    'gray55': '#8C8C8C',
    'gray56': '#8F8F8F',
    'gray57': '#919191',
    'gray58': '#949494',
    'gray59': '#969696',
    'gray60': '#999999',
    'gray61': '#9C9C9C',
    'gray62': '#9E9E9E',
    'gray63': '#A1A1A1',
    'gray64': '#A3A3A3',
    'gray65': '#A6A6A6',
    'gray66': '#A8A8A8',
    'gray67': '#ABABAB',
    'gray68': '#ADADAD',
    'gray69': '#B0B0B0',
    'gray70': '#B3B3B3',
    'gray71': '#B5B5B5',
    'gray72': '#B8B8B8',
    'gray73': '#BABABA',
    'gray74': '#BDBDBD',
    'gray75': '#BFBFBF',
    'gray76': '#C2C2C2',
    'gray77': '#C4C4C4',
    'gray78': '#C7C7C7',
    'gray79': '#C9C9C9',
    'gray80': '#CCCCCC',
    'gray81': '#CFCFCF',
    'gray82': '#D1D1D1',
    'gray83': '#D4D4D4',
    'gray84': '#D6D6D6',
    'gray85': '#D9D9D9',
    'gray86': '#DBDBDB',
    'gray87': '#DEDEDE',
    'gray88': '#E0E0E0',
    'gray89': '#E3E3E3',
    'gray90': '#E5E5E5',
    'gray91': '#E8E8E8',
    'gray92': '#EBEBEB',
    'gray93': '#EDEDED',
    'gray94': '#F0F0F0',
    'gray95': '#F2F2F2',
    'gray96': '#F5F5F5',
    'gray97': '#F7F7F7',
    'gray98': '#FAFAFA',
    'gray99': '#FCFCFC',
    'gray100': '#FFFFFF',
    'green': '#00FF00',
    'green yellow': '#ADFF2F',
    'green1': '#00FF00',
    'green2': '#00EE00',
    'green3': '#00CD00',
    'green4': '#008B00',
    'GreenYellow': '#ADFF2F',
    'grey': '#BEBEBE',
    'grey0': '#000000',
    'grey1': '#030303',
    'grey2': '#050505',
    'grey3': '#080808',
    'grey4': '#0A0A0A',
    'grey5': '#0D0D0D',
    'grey6': '#0F0F0F',
    'grey7': '#121212',
    'grey8': '#141414',
    'grey9': '#171717',
    'grey10': '#1A1A1A',
    'grey11': '#1C1C1C',
    'grey12': '#1F1F1F',
    'grey13': '#212121',
    'grey14': '#242424',
    'grey15': '#262626',
    'grey16': '#292929',
    'grey17': '#2B2B2B',
    'grey18': '#2E2E2E',
    'grey19': '#303030',
    'grey20': '#333333',
    'grey21': '#363636',
    'grey22': '#383838',
    'grey23': '#3B3B3B',
    'grey24': '#3D3D3D',
    'grey25': '#404040',
    'grey26': '#424242',
    'grey27': '#454545',
    'grey28': '#474747',
    'grey29': '#4A4A4A',
    'grey30': '#4D4D4D',
    'grey31': '#4F4F4F',
    'grey32': '#525252',
    'grey33': '#545454',
    'grey34': '#575757',
    'grey35': '#595959',
    'grey36': '#5C5C5C',
    'grey37': '#5E5E5E',
    'grey38': '#616161',
    'grey39': '#636363',
    'grey40': '#666666',
    'grey41': '#696969',
    'grey42': '#6B6B6B',
    'grey43': '#6E6E6E',
    'grey44': '#707070',
    'grey45': '#737373',
    'grey46': '#757575',
    'grey47': '#787878',
    'grey48': '#7A7A7A',
    'grey49': '#7D7D7D',
    'grey50': '#7F7F7F',
    'grey51': '#828282',
    'grey52': '#858585',
    'grey53': '#878787',
    'grey54': '#8A8A8A',
    'grey55': '#8C8C8C',
    'grey56': '#8F8F8F',
    'grey57': '#919191',
    'grey58': '#949494',
    'grey59': '#969696',
    'grey60': '#999999',
    'grey61': '#9C9C9C',
    'grey62': '#9E9E9E',
    'grey63': '#A1A1A1',
    'grey64': '#A3A3A3',
    'grey65': '#A6A6A6',
    'grey66': '#A8A8A8',
    'grey67': '#ABABAB',
    'grey68': '#ADADAD',
    'grey69': '#B0B0B0',
    'grey70': '#B3B3B3',
    'grey71': '#B5B5B5',
    'grey72': '#B8B8B8',
    'grey73': '#BABABA',
    'grey74': '#BDBDBD',
    'grey75': '#BFBFBF',
    'grey76': '#C2C2C2',
    'grey77': '#C4C4C4',
    'grey78': '#C7C7C7',
    'grey79': '#C9C9C9',
    'grey80': '#CCCCCC',
    'grey81': '#CFCFCF',
    'grey82': '#D1D1D1',
    'grey83': '#D4D4D4',
    'grey84': '#D6D6D6',
    'grey85': '#D9D9D9',
    'grey86': '#DBDBDB',
    'grey87': '#DEDEDE',
    'grey88': '#E0E0E0',
    'grey89': '#E3E3E3',
    'grey90': '#E5E5E5',
    'grey91': '#E8E8E8',
    'grey92': '#EBEBEB',
    'grey93': '#EDEDED',
    'grey94': '#F0F0F0',
    'grey95': '#F2F2F2',
    'grey96': '#F5F5F5',
    'grey97': '#F7F7F7',
    'grey98': '#FAFAFA',
    'grey99': '#FCFCFC',
    'grey100': '#FFFFFF',
    'honeydew': '#F0FFF0',
    'honeydew1': '#F0FFF0',
    'honeydew2': '#E0EEE0',
    'honeydew3': '#C1CDC1',
    'honeydew4': '#838B83',
    'hot pink': '#FF69B4',
    'HotPink': '#FF69B4',
    'HotPink1': '#FF6EB4',
    'HotPink2': '#EE6AA7',
    'HotPink3': '#CD6090',
    'HotPink4': '#8B3A62',
    'indian red': '#CD5C5C',
    'IndianRed': '#CD5C5C',
    'IndianRed1': '#FF6A6A',
    'IndianRed2': '#EE6363',
    'IndianRed3': '#CD5555',
    'IndianRed4': '#8B3A3A',
    'ivory': '#FFFFF0',
    'ivory1': '#FFFFF0',
    'ivory2': '#EEEEE0',
    'ivory3': '#CDCDC1',
    'ivory4': '#8B8B83',
    'khaki': '#F0E68C',
    'khaki1': '#FFF68F',
    'khaki2': '#EEE685',
    'khaki3': '#CDC673',
    'khaki4': '#8B864E',
    'lavender': '#E6E6FA',
    'lavender blush': '#FFF0F5',
    'LavenderBlush': '#FFF0F5',
    'LavenderBlush1': '#FFF0F5',
    'LavenderBlush2': '#EEE0E5',
    'LavenderBlush3': '#CDC1C5',
    'LavenderBlush4': '#8B8386',
    'lawn green': '#7CFC00',
    'LawnGreen': '#7CFC00',
    'lemon chiffon': '#FFFACD',
    'LemonChiffon': '#FFFACD',
    'LemonChiffon1': '#FFFACD',
    'LemonChiffon2': '#EEE9BF',
    'LemonChiffon3': '#CDC9A5',
    'LemonChiffon4': '#8B8970',
    'light blue': '#ADD8E6',
    'light coral': '#F08080',
    'light cyan': '#E0FFFF',
    'light goldenrod': '#EEDD82',
    'light goldenrod yellow': '#FAFAD2',
    'light gray': '#D3D3D3',
    'light green': '#90EE90',
    'light grey': '#D3D3D3',
    'light pink': '#FFB6C1',
    'light salmon': '#FFA07A',
    'light sea green': '#20B2AA',
    'light sky blue': '#87CEFA',
    'light slate blue': '#8470FF',
    'light slate gray': '#778899',
    'light slate grey': '#778899',
    'light steel blue': '#B0C4DE',
    'light yellow': '#FFFFE0',
    'LightBlue': '#ADD8E6',
    'LightBlue1': '#BFEFFF',
    'LightBlue2': '#B2DFEE',
    'LightBlue3': '#9AC0CD',
    'LightBlue4': '#68838B',
    'LightCoral': '#F08080',
    'LightCyan': '#E0FFFF',
    'LightCyan1': '#E0FFFF',
    'LightCyan2': '#D1EEEE',
    'LightCyan3': '#B4CDCD',
    'LightCyan4': '#7A8B8B',
    'LightGoldenrod': '#EEDD82',
    'LightGoldenrod1': '#FFEC8B',
    'LightGoldenrod2': '#EEDC82',
    'LightGoldenrod3': '#CDBE70',
    'LightGoldenrod4': '#8B814C',
    'LightGoldenrodYellow': '#FAFAD2',
    'LightGray': '#D3D3D3',
    'LightGreen': '#90EE90',
    'LightGrey': '#D3D3D3',
    'LightPink': '#FFB6C1',
    'LightPink1': '#FFAEB9',
    'LightPink2': '#EEA2AD',
    'LightPink3': '#CD8C95',
    'LightPink4': '#8B5F65',
    'LightSalmon': '#FFA07A',
    'LightSalmon1': '#FFA07A',
    'LightSalmon2': '#EE9572',
    'LightSalmon3': '#CD8162',
    'LightSalmon4': '#8B5742',
    'LightSeaGreen': '#20B2AA',
    'LightSkyBlue': '#87CEFA',
    'LightSkyBlue1': '#B0E2FF',
    'LightSkyBlue2': '#A4D3EE',
    'LightSkyBlue3': '#8DB6CD',
    'LightSkyBlue4': '#607B8B',
    'LightSlateBlue': '#8470FF',
    'LightSlateGray': '#778899',
    'LightSlateGrey': '#778899',
    'LightSteelBlue': '#B0C4DE',
    'LightSteelBlue1': '#CAE1FF',
    'LightSteelBlue2': '#BCD2EE',
    'LightSteelBlue3': '#A2B5CD',
    'LightSteelBlue4': '#6E7B8B',
    'LightYellow': '#FFFFE0',
    'LightYellow1': '#FFFFE0',
    'LightYellow2': '#EEEED1',
    'LightYellow3': '#CDCDB4',
    'LightYellow4': '#8B8B7A',
    'lime green': '#32CD32',
    'LimeGreen': '#32CD32',
    'linen': '#FAF0E6',
    'magenta': '#FF00FF',
    'magenta1': '#FF00FF',
    'magenta2': '#EE00EE',
    'magenta3': '#CD00CD',
    'magenta4': '#8B008B',
    'maroon': '#B03060',
    'maroon1': '#FF34B3',
    'maroon2': '#EE30A7',
    'maroon3': '#CD2990',
    'maroon4': '#8B1C62',
    'medium aquamarine': '#66CDAA',
    'medium blue': '#0000CD',
    'medium orchid': '#BA55D3',
    'medium purple': '#9370DB',
    'medium sea green': '#3CB371',
    'medium slate blue': '#7B68EE',
    'medium spring green': '#00FA9A',
    'medium turquoise': '#48D1CC',
    'medium violet red': '#C71585',
    'MediumAquamarine': '#66CDAA',
    'MediumBlue': '#0000CD',
    'MediumOrchid': '#BA55D3',
    'MediumOrchid1': '#E066FF',
    'MediumOrchid2': '#D15FEE',
    'MediumOrchid3': '#B452CD',
    'MediumOrchid4': '#7A378B',
    'MediumPurple': '#9370DB',
    'MediumPurple1': '#AB82FF',
    'MediumPurple2': '#9F79EE',
    'MediumPurple3': '#8968CD',
    'MediumPurple4': '#5D478B',
    'MediumSeaGreen': '#3CB371',
    'MediumSlateBlue': '#7B68EE',
    'MediumSpringGreen': '#00FA9A',
    'MediumTurquoise': '#48D1CC',
    'MediumVioletRed': '#C71585',
    'midnight blue': '#191970',
    'MidnightBlue': '#191970',
    'mint cream': '#F5FFFA',
    'MintCream': '#F5FFFA',
    'misty rose': '#FFE4E1',
    'MistyRose': '#FFE4E1',
    'MistyRose1': '#FFE4E1',
    'MistyRose2': '#EED5D2',
    'MistyRose3': '#CDB7B5',
    'MistyRose4': '#8B7D7B',
    'moccasin': '#FFE4B5',
    'navajo white': '#FFDEAD',
    'NavajoWhite': '#FFDEAD',
    'NavajoWhite1': '#FFDEAD',
    'NavajoWhite2': '#EECFA1',
    'NavajoWhite3': '#CDB38B',
    'NavajoWhite4': '#8B795E',
    'navy': '#000080',
    'navy blue': '#000080',
    'NavyBlue': '#000080',
    'old lace': '#FDF5E6',
    'OldLace': '#FDF5E6',
    'olive drab': '#6B8E23',
    'OliveDrab': '#6B8E23',
    'OliveDrab1': '#C0FF3E',
    'OliveDrab2': '#B3EE3A',
    'OliveDrab3': '#9ACD32',
    'OliveDrab4': '#698B22',
    'orange': '#FFA500',
    'orange red': '#FF4500',
    'orange1': '#FFA500',
    'orange2': '#EE9A00',
    'orange3': '#CD8500',
    'orange4': '#8B5A00',
    'OrangeRed': '#FF4500',
    'OrangeRed1': '#FF4500',
    'OrangeRed2': '#EE4000',
    'OrangeRed3': '#CD3700',
    'OrangeRed4': '#8B2500',
    'orchid': '#DA70D6',
    'orchid1': '#FF83FA',
    'orchid2': '#EE7AE9',
    'orchid3': '#CD69C9',
    'orchid4': '#8B4789',
    'pale goldenrod': '#EEE8AA',
    'pale green': '#98FB98',
    'pale turquoise': '#AFEEEE',
    'pale violet red': '#DB7093',
    'PaleGoldenrod': '#EEE8AA',
    'PaleGreen': '#98FB98',
    'PaleGreen1': '#9AFF9A',
    'PaleGreen2': '#90EE90',
    'PaleGreen3': '#7CCD7C',
    'PaleGreen4': '#548B54',
    'PaleTurquoise': '#AFEEEE',
    'PaleTurquoise1': '#BBFFFF',
    'PaleTurquoise2': '#AEEEEE',
    'PaleTurquoise3': '#96CDCD',
    'PaleTurquoise4': '#668B8B',
    'PaleVioletRed': '#DB7093',
    'PaleVioletRed1': '#FF82AB',
    'PaleVioletRed2': '#EE799F',
    'PaleVioletRed3': '#CD687F',
    'PaleVioletRed4': '#8B475D',
    'papaya whip': '#FFEFD5',
    'PapayaWhip': '#FFEFD5',
    'peach puff': '#FFDAB9',
    'PeachPuff': '#FFDAB9',
    'PeachPuff1': '#FFDAB9',
    'PeachPuff2': '#EECBAD',
    'PeachPuff3': '#CDAF95',
    'PeachPuff4': '#8B7765',
    'peru': '#CD853F',
    'pink': '#FFC0CB',
    'pink1': '#FFB5C5',
    'pink2': '#EEA9B8',
    'pink3': '#CD919E',
    'pink4': '#8B636C',
    'plum': '#DDA0DD',
    'plum1': '#FFBBFF',
    'plum2': '#EEAEEE',
    'plum3': '#CD96CD',
    'plum4': '#8B668B',
    'powder blue': '#B0E0E6',
    'PowderBlue': '#B0E0E6',
    'purple': '#A020F0',
    'purple1': '#9B30FF',
    'purple2': '#912CEE',
    'purple3': '#7D26CD',
    'purple4': '#551A8B',
    'red': '#FF0000',
    'red1': '#FF0000',
    'red2': '#EE0000',
    'red3': '#CD0000',
    'red4': '#8B0000',
    'rosy brown': '#BC8F8F',
    'RosyBrown': '#BC8F8F',
    'RosyBrown1': '#FFC1C1',
    'RosyBrown2': '#EEB4B4',
    'RosyBrown3': '#CD9B9B',
    'RosyBrown4': '#8B6969',
    'royal blue': '#4169E1',
    'RoyalBlue': '#4169E1',
    'RoyalBlue1': '#4876FF',
    'RoyalBlue2': '#436EEE',
    'RoyalBlue3': '#3A5FCD',
    'RoyalBlue4': '#27408B',
    'saddle brown': '#8B4513',
    'SaddleBrown': '#8B4513',
    'salmon': '#FA8072',
    'salmon1': '#FF8C69',
    'salmon2': '#EE8262',
    'salmon3': '#CD7054',
    'salmon4': '#8B4C39',
    'sandy brown': '#F4A460',
    'SandyBrown': '#F4A460',
    'sea green': '#2E8B57',
    'SeaGreen': '#2E8B57',
    'SeaGreen1': '#54FF9F',
    'SeaGreen2': '#4EEE94',
    'SeaGreen3': '#43CD80',
    'SeaGreen4': '#2E8B57',
    'seashell': '#FFF5EE',
    'seashell1': '#FFF5EE',
    'seashell2': '#EEE5DE',
    'seashell3': '#CDC5BF',
    'seashell4': '#8B8682',
    'sienna': '#A0522D',
    'sienna1': '#FF8247',
    'sienna2': '#EE7942',
    'sienna3': '#CD6839',
    'sienna4': '#8B4726',
    'sky blue': '#87CEEB',
    'SkyBlue': '#87CEEB',
    'SkyBlue1': '#87CEFF',
    'SkyBlue2': '#7EC0EE',
    'SkyBlue3': '#6CA6CD',
    'SkyBlue4': '#4A708B',
    'slate blue': '#6A5ACD',
    'slate gray': '#708090',
    'slate grey': '#708090',
    'SlateBlue': '#6A5ACD',
    'SlateBlue1': '#836FFF',
    'SlateBlue2': '#7A67EE',
    'SlateBlue3': '#6959CD',
    'SlateBlue4': '#473C8B',
    'SlateGray': '#708090',
    'SlateGray1': '#C6E2FF',
    'SlateGray2': '#B9D3EE',
    'SlateGray3': '#9FB6CD',
    'SlateGray4': '#6C7B8B',
    'SlateGrey': '#708090',
    'snow': '#FFFAFA',
    'snow1': '#FFFAFA',
    'snow2': '#EEE9E9',
    'snow3': '#CDC9C9',
    'snow4': '#8B8989',
    'spring green': '#00FF7F',
    'SpringGreen': '#00FF7F',
    'SpringGreen1': '#00FF7F',
    'SpringGreen2': '#00EE76',
    'SpringGreen3': '#00CD66',
    'SpringGreen4': '#008B45',
    'steel blue': '#4682B4',
    'SteelBlue': '#4682B4',
    'SteelBlue1': '#63B8FF',
    'SteelBlue2': '#5CACEE',
    'SteelBlue3': '#4F94CD',
    'SteelBlue4': '#36648B',
    'tan': '#D2B48C',
    'tan1': '#FFA54F',
    'tan2': '#EE9A49',
    'tan3': '#CD853F',
    'tan4': '#8B5A2B',
    'thistle': '#D8BFD8',
    'thistle1': '#FFE1FF',
    'thistle2': '#EED2EE',
    'thistle3': '#CDB5CD',
    'thistle4': '#8B7B8B',
    'tomato': '#FF6347',
    'tomato1': '#FF6347',
    'tomato2': '#EE5C42',
    'tomato3': '#CD4F39',
    'tomato4': '#8B3626',
    'turquoise': '#40E0D0',
    'turquoise1': '#00F5FF',
    'turquoise2': '#00E5EE',
    'turquoise3': '#00C5CD',
    'turquoise4': '#00868B',
    'violet': '#EE82EE',
    'violet red': '#D02090',
    'VioletRed': '#D02090',
    'VioletRed1': '#FF3E96',
    'VioletRed2': '#EE3A8C',
    'VioletRed3': '#CD3278',
    'VioletRed4': '#8B2252',
    'wheat': '#F5DEB3',
    'wheat1': '#FFE7BA',
    'wheat2': '#EED8AE',
    'wheat3': '#CDBA96',
    'wheat4': '#8B7E66',
    'white': '#FFFFFF',
    'white smoke': '#F5F5F5',
    'WhiteSmoke': '#F5F5F5',
    'yellow': '#FFFF00',
    'yellow green': '#9ACD32',
    'yellow1': '#FFFF00',
    'yellow2': '#EEEE00',
    'yellow3': '#CDCD00',
    'yellow4': '#8B8B00',
    'YellowGreen': '#9ACD32',
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T23:04:30.610

You should look at the PIL (Python Imaging Library), and in particular, the [ImageDraw module](https://pillow.readthedocs.io/en/stable/reference/ImageDraw.html), which supports Hex, RGB, HSL, and common color names. You should be able to get the information you need there.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T01:05:56.933

实例化 Tk()，运行一次代码，然后将信息作为 dict 文字粘贴到您的源代码中？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-12-13T13:44:11.010

你不喜欢打开新窗口？尝试测试一个特定的小部件（按钮左右）：

```
r, g, b = Button().winfo_rgb('red') 
```

# asp.net - ASP.NET 或 DotNetNuke 成员资格的用户创建事件

> ID：732202
> 
> 赞同：1
> 
> 时间：2009-04-08T22:48:56.607
> 
> 标签：asp.net, asp.net-membership, dotnetnuke

我想添加一些在 DotNetNuke 站点上注册新用户时运行的代码。有一个自定义注册模块，我可以向其中添加代码。我担心这个注册模块仍在进行中，这并不是我真正能控制的。有人可能会破坏我添加的代码或做一些意想不到的事情。

是否有另一个不错的选择我可以使用添加代码到用户会员活动？

我正在考虑创建一个派生自我们现有提供程序的成员资格提供程序（DNN 或 ASP.NET 提供程序）。我将扩展 CreateUser() 的实现以调用原始实现，然后调用我的自定义代码。

好处是它们与注册组件没有耦合。不利的一面是——与添加配置独立于站点其他方面的 HttpModule 不同——我将隐藏现有的成员资格提供程序。假设有人出于其他原因想要更新提供程序——他们将不得不重新编译我的类，而不是能够简单地更改 web.config 文件。

我打算创建一个派生自 MembershipProvider 的泛型类，然后使用原始提供者作为泛型类型参数。我希望这会希望将原始提供程序类型包含在 web.config 定义中。不幸的是，C# 泛型不允许您从泛型类型参数派生。:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-18T03:21:45.553

如果您从现有的成员资格提供程序派生，为什么当另一个提供程序更改时必须重新编译您的类（假设您没有使用强名称引用）？提供者模型的整个想法是合同不会改变。对基本会员提供者的任何更改都将是内部的，因为合同必须保持不变。您的提供者也必须这样做，因此它也可以被覆盖。如果您的提供商只是这样做：

```
class NewMembershipProvider : ExistingMembershipProvider

override CreateUser()
{
    //do custom stuff
    base.CreateUser();
} 
```

您已经清晰地抽象了实现细节。一个人可以改变而不影响另一个人。并且任何未来的更改都可以通过覆盖您的提供程序来做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-18T03:22:55.190

我强烈认为您可能会在这里增加一些复杂性。事物总是可以以任何形式打破，很难做到“不耦合”。尝试编写一些好的单元测试用例，以便您知道它们何时被破坏，而不是创建一个完全不同的处理程序来创建新用户。

# wordpress - WordPress 音频插件：如果浏览器不支持 Flash，则显示 mp3 链接

> ID：732204
> 
> 赞同：-1
> 
> 时间：2009-04-08T22:49:24.203
> 
> 标签：wordpress, plugins, audio

我在 WordPress（2.7.1 版）中使用 1pixelout 音频播放器插件（1.2.3 版）来发布简短的音频剪辑。当我在没有 Flash 插件的浏览器中加载站点时，没有回退方法来播放音频。

当浏览器上没有 Flash 时，有什么方法可以让插件正常降级以提供 MP3 文件的普通链接？或者是否有提供此功能的替代播放器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T03:08:40.523

查看 PodPress 或 PowerPress。它们是 WordPress 的主要 Podcast 插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T04:30:01.633

查看适用于 Wordpress 的 Uber 音频。它同时具有 Flash 和 HTML5 后备功能，因此它可以在大多数（如果不是所有）浏览器中播放。这是一个很棒的插件。

您可以在[http://WordpressAudio.com找到它](http://WordpressAudio.com)

# c# - 如何避免两个控制器操作之间的 AmbiguousMatchException？

> ID：732205
> 
> 赞同：13
> 
> 时间：2009-04-08T22:50:40.490
> 
> 标签：c#, .net, asp.net-mvc, controller

我有两个名称相同但方法签名不同的控制器操作。它们看起来像这样：

```
 //
    // GET: /Stationery/5?asHtml=true
    [AcceptVerbs(HttpVerbs.Get)]
    public ContentResult Show(int id, bool asHtml)
    {
        if (!asHtml)
            RedirectToAction("Show", id);

        var result = Stationery.Load(id);
        return Content(result.GetHtml());
    }

    //
    // GET: /Stationery/5
    [AcceptVerbs(HttpVerbs.Get)]
    public XmlResult Show(int id)
    {
        var result = Stationery.Load(id);
        return new XmlResult(result);
    } 
```

我的单元测试调用一个或另一个控制器操作没有问题，但我的测试 html 页面抛出 System.Reflection.AmbiguousMatchException。

```
<a href="/Stationery/1?asHtml=true">Show the stationery Html</a>
<a href="/Stationery/1">Show the stationery</a> 
```

需要改变什么才能使这项工作有效？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-09T04:28:48.383

只要有这样一种方法。

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Show(int id, bool? asHtml)
{
    var result = Stationery.Load(id);

    if (asHtml.HasValue && asHtml.Value)
        return Content(result.GetHtml());
    else
        return new XmlResult(result);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T22:53:43.413

[这是您可能会发现有用的链接。](https://stackoverflow.com/questions/436866/can-you-overload-controller-methods-in-asp-net-mvc)它谈到了重载 MVC 控制器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T23:06:43.633

有两种方法可以解决这个问题：

1> 更改方法名称。2> 为这两种方法提供不同的 ActionName 属性。您可以定义自己的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T23:09:45.513

有`ActionName`属性。看一看。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-17T01:12:53.970

为了克服这个问题，您可以编写一个`ActionMethodSelectorAttribute`检查`MethodInfo`每个操作的方法并将其与发布的表单值进行比较，然后拒绝任何表单值不匹配的方法（当然不包括按钮名称）。

这是一个示例：- [http://blog.abodit.com/2010/02/asp-net-mvc-ambiguous-match/](http://blog.abodit.com/2010/02/asp-net-mvc-ambiguous-match/)

您还可以制作一个更简单的`ActionMethodSelectorAttribute`方法，它只查看提交按钮名称，但这会绑定您的控制器并更紧密地查看。

# php - 迁移到较新版本的 PHP

> ID：732207
> 
> 赞同：4
> 
> 时间：2009-04-08T22:51:17.523
> 
> 标签：php, migration

我注意到几周前 PHP 5.3 达到了候选发布阶段（哇！），但随后看到已经弃用的函数列表最终被删除，这让我开始思考它是否会破坏我的任何旧代码。

如果没有进行简单的测试（在测试服务器上安装并试用），是否有任何类型的迁移工具可以分析您的代码以突出显示问题？例如，如果某些脚本使用这些`ereg_*`函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T23:10:57.163

One technique you could use is to take the list of deprecated functions that is being removed and grep for them. A little shell scripting fu goes a long way for things like this.

Let's suppose you have a file deprecated.txt with deprecated function names one per line:

```
for func in `cat deprecated.txt`
do
  grep -R $func /path/to/src
done 
```

That will tell you all the instances of the deprecated functions you're using.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T23:05:55.833

Nothing beats installing on a test server and running your unit tests. You do have unit tests, right? ;)

# java - 文档在 Javadoc 中不可见

> ID：732220
> 
> 赞同：1
> 
> 时间：2009-04-08T22:58:06.477
> 
> 标签：java, javadoc

我有以下功能：

```
/**
 * @param parent    ...
 * @param key   ...
 * @param isRed ...
 * ...
 */
public redBlackNode(redBlackNode parent, int key, boolean isRed) {
    ...

} 
```

我在我的 Javadoc 中看不到它（或我记录的任何其他内容）。这可能是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T00:04:21.047

尝试使用 -verbose 标志运行 javadoc。也许发生了您没有看到的错误或警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T19:59:00.283

你只是在徘徊吗？如果要查看符号的 JavaDocs，请按 Ctrl+Q。

# python - 支持分块编码的 Python HTTP 服务器？

> ID：732222
> 
> 赞同：7
> 
> 时间：2009-04-08T22:58:19.613
> 
> 标签：python, http, chunked-encoding

我正在寻找一个支持分块编码回复的支持良好的多线程 Python HTTP 服务器。（即响应中的“传输编码：分块”）。为此目的，最好的 HTTP 服务器基础是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T23:22:39.710

Twisted 支持[分块传输编码（API 链接）](http://twistedmatrix.com/documents/current/api/twisted.web.http._ChunkedTransferEncoding.html)（另请参阅[HTTPChannel](http://twistedmatrix.com/documents/current/api/twisted.web.http.HTTPChannel.html)的 API 文档）。有许多使用 Twisted 的生产级项目（例如，Apple 将它用于 Mac OS X Server 中的 iCalendar 服务器），因此它得到了很好的支持并且非常健壮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-02-17T10:00:40.540

Twisted 支持分块传输，并且这样做是透明的。即，如果您的请求处理程序没有指定响应长度，twisted 将自动切换到分块传输，并且每次调用 Request.write 都会生成一个块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T23:18:10.143

我很确定符合 WSGI 的服务器应该支持这一点。本质上，WSGI 应用程序返回可迭代的块，网络服务器返回这些块。我没有这方面的第一手经验，但这里有一个[兼容服务器列表](http://www.wsgi.org/wsgi/Servers)。

我应该认为，如果 WSGI 服务器不满足您的要求，使用 Python 的内置[CGIHTTPServer](http://docs.python.org/library/cgihttpserver.html)来滚动您自己的服务器会相当容易。它已经是多线程的，因此您可以将响应分块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-18T09:19:30.360

我设法使用[Tornado](https://github.com/tornadoweb/tornado)做到了：

```
#!/usr/bin/env python

import logging

import tornado.httpserver
import tornado.ioloop
import tornado.options
import tornado.web

from tornado.options import define, options

define("port", default=8080, help="run on the given port", type=int)

@tornado.web.stream_request_body
class MainHandler(tornado.web.RequestHandler):
    def post(self):
        print()
    def data_received(self, chunk):
        self.write(chunk)

        logging.info(chunk)

def main():
    tornado.options.parse_command_line()

    application = tornado.web.Application([
        (r"/", MainHandler),
    ])

    http_server = tornado.httpserver.HTTPServer(application)
    http_server.listen(options.port)

    tornado.ioloop.IOLoop.current().start()

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-17T07:59:01.243

您可以使用 Python 的 HTTPServer 实现一个简单的分块服务器，方法是将其添加到您的服务函数中：

```
 def _serve(self, res):
        response = next(res)

        content_type = 'application/json'

        self.send_response(200)
        self.send_header('Content-Type', content_type)
        self.send_header('Transfer-Encoding', 'chunked')
        self.end_headers()

        try:
            while True:
                r = response.encode('utf-8')
                l = len(r)
                self.wfile.write('{:X}\r\n{}\r\n'.format(l, r).encode('utf-8'))

                response = next(it)
        except StopIteration:
            pass

        self.wfile.write('0\r\n\r\n'.encode('utf-8')) 
```

我不建议将其用于生产用途。

# ruby-on-rails - 访问用户密码：Rails 中的变量范围

> ID：732223
> 
> 赞同：2
> 
> 时间：2009-04-08T22:59:27.333
> 
> 标签：ruby-on-rails, ruby, variables, scope, restful-authentication

我正在为 Rails 应用程序编写一个非常简单的邮件系统。我正在使用 RESTful 身份验证。这是一个相当传统的设置，当用户注册和忘记密码时，我会发送相同的电子邮件。我只是遇到了一个我似乎无法解决的问题。

我想对这两个实例使用相同的电子邮件模板，即使“新用户”电子邮件将来自用户控制器，而“忘记密码”电子邮件将来自密码控制器。

电子邮件看起来像这样：

```
<%=h @user.name %>, 
Your membership details:
Username: <%=h @user.login %>
Password: <%=h @user.password %> 
```

当用户注册时，这工作得很好，导致一封看起来像这样的电子邮件：

```
 Bryan,
  Your membership details:
  Username: bryan
  Password: password 
```

不幸的是，当尝试使用此模板从密码控制器发送“忘记密码”电子邮件时，一切都会中断。然而，令我困惑的是，它只是有点中断：

```
 Bryan,
  Your membership details:
  Username: bryan
  Password: 
```

换句话说，@user.name 仍然有效，@user.login 也是如此。但是由于某种原因，在这种状态下@user.password 没有通过。

**感谢您的回复。需要明确的是，在这种情况下，安全性确实不是问题，因此，能够以纯文本形式发送忘记的密码而不是通过重置密码过程会更好，但我很感激这一点通常情况并非如此。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T23:15:29.040

如果没有看到您的一些代码，特别是控制器方法，很难说。

尽管注册电子邮件可能在加密之前使用了密码。未加密的密码通常不可用于以后的操作，因为它已加密存储在 db 中。

但是，如果您的密码控制器正在设置新密码，而不是尝试检索旧密码，那么问题很可能出在其他地方。

无论如何，这就是人们在不看代码的情况下所能做的尽可能多的猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T23:22:59.443

如果您查看数据库，您将看到密码哈希和盐哈希。

在将明文密码存储到数据库之前，您必须将明文密码存储在另一个变量中，使用带有明文密码的单独变量，您可以将其传递给 ActiveMailer 并在没有加密的情况下在电子邮件中发送。

```
@user = User.find(params[:id])
password = params[:user][:password]
options = {
    :password => password,
    :user => @user
}

if @user.update_attributes(params[:user]) and Mailer.deliver_reset(options)
    flash[:notice] = "Check your email (#{@user.email}) for your new password."
    redirect_to_back_or_default('/')
else
    flash[:error] = "Look at the errors below"
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T23:29:12.440

我同意莎拉·梅的观点。这是由于restful auth存储密码的方式。通常`attr_accessor :password`在用户模型中为密码设置一个虚拟属性，然后在您注册时使用该属性。在注册阶段，用户对象将密码属性设置为某个值，但是当您稍后去检索用户记录时，密码字段将为空白。

无论如何，我认为这不是“最好”的做事方式，向他们发送一个链接，他们可以在其中重置密码，而不仅仅是他们的原始密码，因为如果他们忘记了一次，是什么阻止他们再次忘记它？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T00:05:40.183

**不要这样做**

许多用户在多个地方使用相同的密码（是的，不应该，但他们确实这样做了）。以纯文本形式存储他们的密码不仅会危及您网站的安全，还会危及您在其他网站上的用户的安全。甚至不要让我开始通过电子邮件以明文形式发送密码。

按照这里其他人的建议，有一个密码重置系统，而不是“这是你的密码”系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T23:14:26.237

我猜密码是以散列形式存储的，故意让你*不*知道用户的密码。当用户忘记密码时，您需要做的是向用户发送一个链接，该链接仅在几天内有效，这将使用户在不知道旧密码的情况下重置密码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T18:12:43.407

[restful-authentication 仅临时存储密码](http://github.com/technoweenie/restful-authentication/blob/2ae4c22f5a42100458f8be89c9f366b4099a4451/lib/authentication/by_password.rb)- 足够长的时间来加密它并保存加密版本。正如其他人提到的那样，这是为了安全。

由于您不太担心这个应用程序的安全性，我建议为每个用户生成一个唯一的令牌，并为他们提供一个用于登录的 URL。因为“密码”（甚至是生成的）而推荐一个 URL 可能会让用户期望他们可以更改它。您可以向您的用户发送电子邮件，例如：

```
 Bryan,
  Your membership details:
  Username: bryan
  Your url: http://domain.com/x7sjs0qn 
```

您的用户可以点击该 URL 并自动登录。这样一来，您就永远不会让用户有机会给您他们可能在其他地方使用的密码，并且 - 如果他们忘记了密码，您可以以纯文本的形式通过电子邮件发送，而不会使他们的其他帐户面临任何风险。

# c# - 使用 C# 修改然后显示页面

> ID：732243
> 
> 赞同：1
> 
> 时间：2009-04-08T23:12:56.643
> 
> 标签：c#, http, proxy

有人可以指出我使用 C# 实现类似代理的行为的正确方向吗？我正在寻找`HTTP`来自站点的请求，解析，然后修改`DOM`并显示结果。理想情况下，该程序将作为代理在本地计算机上运行，​​但如果需要，我可以实现自定义“浏览器”。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T23:26:42.757

为[Fiddler](http://www.fiddler2.com/fiddler2/)写一个[扩展](http://www.fiddler2.com/Fiddler/dev/)怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T00:50:28.593

我怀疑您是否想要在本地计算机上进行进程，那么浏览器帮助对象 (BHO) 怎么样？您应该能够在内容呈现之前拦截内容并以您想要的任何方式对其进行修改。我只在 ATL 中做过，但一些研究表明 C# 版本是可能的。

# operating-system - How much trust can I put behind a computer system? How can I measure trust?

> ID：732244
> 
> 赞同：1
> 
> 时间：2009-04-08T23:13:43.537
> 
> 标签：operating-system, reliability

How much trust can I put in a standard computer running windows? To what certainty can I be sure it will run my code the way I wrote it? How can I be sure that if I declare something like "int j = 5;", j will alway be 5? Is there a way to measure trust in a standard x86 computer system? What kind of protections are there to make sure that j = 5?

I'm thinking about critical systems where nothing can be off even by one bit and everything must run exactly the way it was written to run.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T23:20:07.080

If "nothing can be off by even a single bit", the only way in general to do this is to have three computers:

*   all must use different hardware
*   all must use different OS;s
*   the application software must have been written by different people
*   the application must be compiled using different compilers

All three computers are given the same inputs and calculate the output. If two or more outputs are the same, this is accepted, otherwise an error condition is flagged.

You can probably see that this full system is never used in practice, althogh variants are used in avionics and similar critical systems.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T23:28:49.773

Is this about the possibility of someone malicious altering your code to do something you didn't program it to do? Or is it about the possibility of random errors messing up your computation? In the latter case, you probably don't have to worry because the error rates on modern computers are something like 1 in 10^17 - that's less than one per processor per year, and if even that is intolerable you can use error-correcting algorithms to reduce the effective error rate as close to zero as you want (at the cost of needing more time to do a given computation).

If it's hackers you're worried about, though... there's really no expectation of security at all. Someone in physical control of a computer can, in principle, modify it to do absolutely anything that can conceivably be done by a computer. They could disassemble your code and alter assembly instructions at will, if they want, to make your program behave however they want it to. We don't usually worry about this in practice, though, because most of us aren't writing anything worth the effort to hack. Those who are, e.g. programmers designing military encryption hardware or nuclear missile control chips, can fall back on tamper-resistant hardware which makes it extremely difficult to alter the code. (That stuff can be expensive, though)

You might want to take a look at a book called "Security Engineering" by Ross Anderson, which describes some of this tamper-resistant hardware, and in general how people who *really* need to secure their code can do so.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T23:17:47.553

Essentially, none. You should read [this](http://cm.bell-labs.com/who/ken/trust.html) article, and consider reevaluating your concept of trust. :-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T23:36:48.567

Something as simple as "j=5" cannot be absolutely trusted.

There are so many ways you could have a single bit error:

*   CPU's do have errata.
*   Hard drives could return errors as they age
*   Memory can be corrupted by cosmic rays
*   Loose/dirty/etc. connections anywhere in the system.
*   Drivers do corrupt memory (including code pages).

# testing - 从用户的角度自动测试网站？

> ID：732253
> 
> 赞同：2
> 
> 时间：2009-04-08T23:16:36.713
> 
> 标签：testing, automation, web

是否有可用的工具可以模拟访问网站、单击链接、填写表格、提交这些表格，同时将输出与预期输出进行比较，直到发现问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T23:20:21.510

我为此使用了[Selenium](http://seleniumhq.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T23:55:46.057

我们一直在使用[visual studio web testing](http://msdn.microsoft.com/en-us/teamsystem/dd408381.aspx)，它对我们来说效果很好。

# .net - 使用“Microsoft Chart Controls for .NET Framework”，如何在动态生成的气泡图中设置气泡的直径？

> ID：732260
> 
> 赞同：0
> 
> 时间：2009-04-08T23:19:22.870
> 
> 标签：.net, charts

m_chart.Series("TestSeries").ChartType = SeriesChartType.Bubble m_chart.Series("TestSeries").MarkerStyle = MarkerStyle.Circle

m_chart.Series("默认").Points。...

此时，如何设置 x、y 和直径值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T18:40:39.087

这是气泡图上的第二个 Y 值：

```
m_chart.Series("TestSeries").Points.Add(x, y, diameter) 
```

[http://msdn.microsoft.com/en-us/library/dd456658.aspx](http://msdn.microsoft.com/en-us/library/dd456658.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-23T17:34:02.570

对于直径，请尝试：

```
m_chart.Series("TestSeries").MarkerSize 
```

然后：

```
m_chart.Series("TestSeries").Points.Add(new DataPoint...) 
```

如果您希望一个点具有不同的气泡直径，您可能必须将其设为具有自己属性的单独系列。

# api - 有没有使用 sun.jdbc.odbc.JdbcOdbcDriver 的替代方法？

> ID：732264
> 
> 赞同：4
> 
> 时间：2009-04-08T23:20:46.390
> 
> 标签：api, jdbc, odbc-bridge

我最近将我们正在使用的旧应用程序从 Java 1.5 迁移到 1.6。我注意到在构建过程中，我现在收到一个（新的）编译器警告：

`... DatabaseSession.java:[9,20] sun.jdbc.odbc.JdbcOdbcDriver is Sun proprietary API and may be removed in a future release`

所以我理解这意味着什么，但是否有一个众所周知的替代方案更开放标准友好，而不是专有？您使用和/或推荐什么驱动程序，它有什么优点？

到目前为止，我已经采用了它在 1.6 中编译的方法，所以我们将继续使用它，如果下一版本的 Java 不支持它，我们可以稍后找到替代品，我可能会尝试禁止显示警告在构建中。我这样想有错吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T23:31:50.343

是的，为您正在使用的数据库使用[Type 4 JDBC驱动程序。](http://en.wikipedia.org/wiki/JDBC_driver#Type_4_Driver_-_Native-Protocol_Driver)

JDBC-ODBC 桥是我不得不乐于使用的最糟糕的 JDBC 驱动程序之一。

或者，您可能想研究第三方 JDBC-ODBC 桥，例如[这个 Easysoft 产品](http://www.easysoft.com/products/data_access/jdbc_odbc_bridge/)，但我对这些没有任何经验。

# language-agnostic - 构建游戏地图的最佳方式

> ID：732272
> 
> 赞同：10
> 
> 时间：2009-04-08T23:26:38.297
> 
> 标签：language-agnostic

我正在编写一个与经典 Ultima 系列非常相似的小型俯视图 RPG。我需要一种快速而肮脏（比肮脏更快）的方式来设计大型地图——比如 1000 块 x 1000 块，我需要一些帮助来思考如何去做。

我想说有 50-60 种不同类型的瓷砖——树林、河流、平原等。

到目前为止，我能想到的最好的方法是

*   定义一个数组（或一些类似的结构）来保存两个关键信息——一个位置/坐标标识符，以及一个 1-60 的整数，定义它是什么类型的图块。

*   在光栅编辑应用程序中，绘制一个 1000 像素 x 1000 像素的图像。使用 50 种不同颜色的调色板，我绘制了我的地图 - 1 个像素对应于 1 个图块。假设对于给定的水砖，我将在一定的蓝色阴影中绘制一组像素。另存为 .gif 或 .png。

*   编写一些处理器，然后分析上述 gif/jpg 并逐像素分析。根据像素的 RGB 值，它决定了瓦片类型。然后处理器代码生成一些填充映射数组的例程。

到目前为止，我认为必须有一个更简单的方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-08T23:40:25.847

它需要基于瓷砖吗？看看 Daniel Cook 的网站[Lost Garden](http://lostgarden.com/2009/03/dancs-miraculously-flexible-game.html)，他不仅为您提供了一些美味的免费艺术品，而且他还讨论了游戏中任意放置图像的出现，而不是瓷砖：

> “曾几何时，你需要为所有东西使用小方形瓷砖。如今，没有真正需要制作基于瓷砖的 2D 引擎。使用具有完整 alpha 和大量填充率的任意图像，你可以将游戏放在一起一本贴纸书。在任意位置放下你的图形，然后像疯子一样分层。像 Aquaria 这样的游戏看起来很棒，而瓷砖却无处可见。”

那里还有一个链接，提供有关制作基于[IndieLib的游戏内编辑器的](http://www.indielib.com/)[分步说明](http://gametuto.com/in-game-c-map-editor-tutorial-with-indielib-engine-that-dosent-use-tiles-but-pieced-images-like-in-braid-or-aquaria-games/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T23:32:19.687

试试 sourceforge：[http ://sourceforge.net/search/?type_of_search=soft&words=tile+editor](http://sourceforge.net/search/?type_of_search=soft&words=tile+editor)

其中一些编辑器将保存为某种标准格式，然后您可以根据需要将其拉入您的游戏。

[TileStudio](http://tilestudio.sourceforge.net/)甚至会输出可以直接编译到您的引擎中的头文件/源文件（不确定您的需求是什么）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T23:40:23.490

对我来说听起来是个不错的方法。但是，您可能会发现创建自定义地图构建器同样简单。

另一种选择可能是编写一个程序，允许您只定义主要功能的位置，然后生成器程序将填充其余部分。（例如：河流从 x1,y1 流向 x2,y2。以 x,y 为中心的“大”福雷斯特等）。这可能让您仅从较小的地理特征文件中定义大地图。把它想象成有点像做矢量绘图，而不是指定光栅中的每个最后一个像素。:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T20:59:29.473

我建议将您的位置信息*作为*存储数据结构的索引信息，而不是您在其中查找的内容。IE

```
int get_terrain_type(int x, int y) {
    return terrain[x][y];
} 
```

（不完全确定这不是你的意思，但我想我会把它放在那里。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T11:48:40.227

另一种选择是生成（像素）地图或直接生成游戏地图。这当然取决于你的世界的大小，如果你有很多特定的资源（此时的城市，此时的矿山......）

网站上有很多关于这个主题的关于游戏“流氓”的文章，这可能是非常有用的。（[以 RogueBassin](http://roguebasin.roguelikedevelopment.org)为例）

他们还谈到允许更多变化的数据结构（例如具有基本图像，并在您在地图数组中定义表示时随机添加一些（小）“边缘”图像。例如添加一些小石头到草地上）。其他效果就像在 ultima V 中一样，当你通过它们时，一些屋顶元素变得透明，它们也基于这些结构。

我们发现拥有一个图像（在我们的例子中是一组图像）很容易，因为您可以在有时间的时候升级外观（不再是矩形森林！），并专注于特定的任务位置。

问候

纪尧姆

# ms-access - MS Access 中的唯一性约束

> ID：732274
> 
> 赞同：2
> 
> 时间：2009-04-08T23:27:19.963
> 
> 标签：ms-access, foreign-key-relationship, unique-constraint

在我必须为 MS Access 设计的数据库中，我有一个名为“Measurements”的表，它存储某些测量参数（测量值、标准偏差等） - 每行都有一个整数 ID 作为其主键。

然后其他表使用外键关系链接到该测量表。一些表包含两个不同的“measurementID”字段，它们都链接到这个测量表。但是，每次测量都应该只与这些字段*之一相关联。*

如何对多个表中的多个字段强制执行唯一性约束？有办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T00:22:33.450

Microsoft ACE/Jet 引擎不支持触发器，这是您通常实现此类功能的方式。

编辑：正如@onedaywhen 所指出的，JET 4.0 及以后的版本确实支持检查约束，但在两列之间实现异或类型约束并不简单。

如果您使用的是访问表单，您可以实现表单的更新前事件并检查您的约束条件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T08:28:07.683

这样的约束确实可以在 ACE/JET 中使用`CHECK`约束来实现。

说他们通常会为这种事情使用触发器的人并没有意识到`CHECK`ACE/Jet 和 SQL Server 中的约束之间的区别：在 SQL Server 中它们不能包含子查询，这意味着它们不能引用其他行中的值在同一个表或其他表中，而在 ACE/Jet 中可以。

在一个理想的（但尚未 AFAIK 不存在的）SQL-92 产品中，所描述的唯一性将使用`ASSETION`, 在模式级别实现。因为 CHECK 约束是表级的，并且仅在定义它们的表是`UPDATE`d 或`INSERT`ed 时才检查，因此您需要`CHECK`对所有引用表施加适当的约束（同样适用于 SQL Server 触发器）。这是一个简单的例子：

```
CREATE TABLE Parent 
(
   parent_ID INTEGER NOT NULL IDENTITY UNIQUE, 
   data_col INTEGER NOT NULL
)
;
CREATE TABLE Child1
(
   parent_ID INTEGER NOT NULL
      REFERENCES parent (parent_ID), 
   data_col INTEGER NOT NULL
)
;
CREATE TABLE Child2
(
   parent_ID INTEGER NOT NULL
      REFERENCES parent (parent_ID), 
   data_col INTEGER NOT NULL
)
;
ALTER TABLE Child1 ADD
   CONSTRAINT child1__no_dups_in_child2
   CHECK (NOT EXISTS (
                      SELECT * 
                        FROM Child1 AS C1
                             INNER JOIN Child2 AS C2
                                ON C1.parent_ID = C2.parent_ID
                     ))
;
ALTER TABLE Child2 ADD
   CONSTRAINT child2__no_dups_in_child1
   CHECK (NOT EXISTS (
                      SELECT * 
                        FROM Child1 AS C1
                             INNER JOIN Child2 AS C2
                                ON C1.parent_ID = C2.parent_ID
                     ))
; 
```

但是，我想知道您是否有子类（即可以键入由 ID 表示的每个实体），在这种情况下，您应该能够使用`FOREIGN KEY`s 和行级`CHECK`约束（如果您对 MS 更满意，则可以使用验证规则访问接口而不是`CHECK`约束所需的 SQL DLL）。该逻辑将比表级约束更容易实现，只需注意引用操作`CHECK`中的循环即可。`CASCADE`这是另一个简单的例子：

```
CREATE TABLE Parent 
(
   parent_ID INTEGER NOT NULL IDENTITY, 
   child_type VARCHAR(4) NOT NULL, 
   CONSTRAINT child_type__values 
      CHECK (child_type IN ('Boy', 'Girl')), 
   UNIQUE (child_type, parent_ID)
)
;
CREATE TABLE Girls
(
   parent_ID INTEGER NOT NULL, 
   child_type VARCHAR(4) DEFAULT 'girl' NOT NULL, 
   CONSTRAINT girl_child_type__must_be_girl
      CHECK (child_type = 'girl'),
   FOREIGN KEY (child_type, parent_ID)
      REFERENCES Parent (child_type, parent_ID), 
   data_col INTEGER NOT NULL
)
;
CREATE TABLE Boys
(
   parent_ID INTEGER NOT NULL, 
   child_type VARCHAR(4) DEFAULT 'boy' NOT NULL, 
   CONSTRAINT boy_child_type__must_be_boy
      CHECK (child_type = 'boy'),
   FOREIGN KEY (child_type, parent_ID)
      REFERENCES Parent (child_type, parent_ID), 
   data_col INTEGER NOT NULL
)
; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T00:37:21.340

Mitch 对于 Access 中的可能性是正确的。但是，假设您在某处拥有 BL，这将逐渐成为合法的业务规则。那是我最有可能做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T01:33:44.870

鉴于您正在设计此数据库。您确定您的表结构遵循标准规范化规则。

根据您正在查看的 A.row 字段，表 A 中的一行能够引用表 Measurements 中的两行，这听起来是一种不寻常的结构。我觉得表 Measurments 中的数据确实需要拆分为两个或多个表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T22:07:19.467

我自己对触发器和检查约束保持警惕，主要是因为我开发的大多数应用程序都没有它们（Access/Jet 和 MySQL/MyISAM）。我同意 BobClegg 的观点，这听起来像是一种超类型/子类型的情况。在这种情况下，您将使用一个连接表，该表在外键上有一个唯一索引，并且有一列指示它是哪种类型的度量。FK 上的唯一索引将阻止添加第二种类型。这也意味着您的主记录中不会有空字段。当然，一个空的数字字段不是存储问题，但是两个独占的字段在我看来总是设计错误。

# tomcat - Maven 部署到多个 Tomcat 服务器

> ID：732275
> 
> 赞同：20
> 
> 时间：2009-04-08T23:28:05.063
> 
> 标签：tomcat, maven-2, build-process

使用可以编写的 maven 将战争部署到多个 tomcat 服务器的最小示例是什么？

我已经尝试了以下 URL 并询问了邮件列表，但没有提出任何简短且简单有效的内容。

*   [http://www.nabble.com/Deploying-to-Multiple-Servers-at-Once-td21592419.html](http://www.nabble.com/Deploying-to-Multiple-Servers-at-Once-td21592419.html)

该示例应在示例中的某处定义服务器（带有示例用户名/密码）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-21T11:23:36.040

Markus Lux 的想法也可以应用于 Maven2 解决方案，具有配置文件管理：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.codehaus.cargo</groupId>
            <artifactId>cargo-maven2-plugin</artifactId>
        </plugin>
    </plugins>
    ...
</build>
<profiles>
    <profile>
        <id>env-foo1</id>
        <!-- Activated when -Denv=foo1 is given as parameter. -->
        <activation>
            <property>
                <name>env</name>
                <value>foo1</value>
            </property>
        </activation>
        <properties>
            <deploy.env>xxx</deploy.env>
            <tomcat.manager>http://foo1/manager</tomcat.manager>
            <tomcat.manager.username>foo</tomcat.manager.username>
            <tomcat.manager.password>bar</tomcat.manager.password>
        </properties>
    </profile> 
    <profile>
        <id>env-foo2</id>
        <!-- Activated when -Denv=foo2 is given as parameter. -->
        <activation>
            <property>
                <name>env</name>
                <value>foo2</value>
            </property>
        </activation>
        <properties>
            <deploy.env>dev</deploy.env>
            <tomcat.manager>http://foo2/manager</tomcat.manager>
            <tomcat.manager.username>foo</tomcat.manager.username>
            <tomcat.manager.password>bar</tomcat.manager.password>
        </properties>
    </profile>
    ... 
</profiles> 
```

然后，您只需要运行 X 次**mvn**命令，并使用足够的参数（*-Denv=foo1*，*-Denv=foo2*，...）

* * *

除此之外，您还可以使用[Hudson](http://hudson-ci.org/)持续集成服务器的 Matrix 功能来增强此解决方案。[我在这里](https://stackoverflow.com/questions/424295/experience-with-hudson-building-matrix-project/424343#424343)对这个特性做了一个简短的解释。

基本上，您只需在 Hudson 中定义一个“正常”的 Maven2 作业，并且使用 Matrix 功能，您可以要求 Hudson 多次运行该作业，每个环境运行一次。换句话说，您创建了 Hudson 作业，然后使用*env*参数的所有可能值定义“环境轴”：

*   foo1
*   foo2
*   foo3
*   ...

然后，Hudson 将使用**mvn**命令和参数*-Denv=foo1*构建应用程序。一旦此构建完成，它将构建相同的应用程序，但使用参数*-Denv=foo2*，依此类推...

这样，Hudson 将在每个环境中部署您的应用程序......

我希望我的解决方案能帮助您实现目标...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-01-06T15:19:36.127

关于使用多个配置文件，生命周期似乎重复了某些步骤——例如，当使用由变量激活的配置文件时，测试的数量翻了一番。我们发现使用 catalina-ant 库更有效；）而且它更“最小”。使用“executions”元素将“run”目标附加到生命周期阶段以简化它，或者在包之后运行：mvn package antrun:run

您可以使用 ant-contrib 库更花哨，并创建一个带有服务器列表的 for 循环，但这里是 2 个硬编码服务器 url 的静态配置。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-antrun-plugin</artifactId>
    <version>1.6</version>
    <configuration>
        <target>
            <taskdef name="deploy" classname="org.apache.catalina.ant.DeployTask"/>
            <deploy url="http://tc-app-01:8080/manager" username="manager" password="pass"
                    path="/app-path" war="file:${project.build.directory}/${project.build.finalName}.${project.packaging}" update="true"/>

            <deploy url="http://tc-app-02:8080/manager" username="manager" password="pass"
                    path="/app-path" war="file:${project.build.directory}/${project.build.finalName}.${project.packaging}" update="true"/>
        </target>
    </configuration>
    <dependencies>
        <dependency>
            <groupId>tomcat</groupId>
            <artifactId>catalina-ant</artifactId>
            <version>6.0.29</version>
        </dependency>
    </dependencies>
</plugin> 
```

上面使用的具体版本的catalina-ant是手动部署到我们的分布式maven仓库的，可以在tomcat发行版的lib目录下找到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-14T11:52:34.367

这是对一个老问题的一个较晚的答案，但我很确定人们会对它感兴趣。我刚刚实现了使用 maven 和 ant 任务运行多个部署。秘诀是使用宏定义（或 2，因为我在码头热部署我的应用程序并需要传输战争和 xml 文件）并使用 ant 属性文件：

```
<plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <version>1.7</version>
    <executions>
        <execution>
            <phase>install</phase>
            <configuration>
                <tasks>
                    <taskdef name="scp"
                        classname="org.apache.tools.ant.taskdefs.optional.ssh.Scp"
                        classpath="/usr/local/java/ant/lib/ant-jsch.jar:/usr/local/java/ant/lib/jsch-0.1.45.jar" />
                    <macrodef name="deploy">
                        <attribute name="server" default="NOT SET" />
                        <attribute name="file" default="NOT SET" />
                        <attribute name="todir" default="NOT SET" />
                        <attribute name="port" default="NOT SET" />
                        <attribute name="passphrase" default="NOT SET" />
                        <attribute name="keyfile" default="NOT SET" />
                        <sequential>
                            <echo message="Deploying to @{server}" />
                            <echo message="Deploying @{file} to @{todir}" />
                            <scp
                                file="@{file}" todir="@{todir}"
                                port="@{port}" passphrase="@{passphrase}"
                                keyfile="@{keyfile}" />
                        </sequential>
                    </macrodef>
                    <macrodef name="deploy-app">
                        <attribute name="config" default="NOT SET" />
                        <sequential>
                            <property file="deploy.properties"/>
                            <echo message="Deploying to @{config}" />
                            <deploy server="${@{config}.jetty.server.host}"
                                    file="${project.build.directory}/${project.build.finalName}.${project.packaging}"
                                    todir="${@{config}.jetty.server.user}@${@{config}.jetty.server.host}:${@{config}.jetty.server.baseDir}/${@{config}.jetty.server.webappsDir}"
                                    port="${@{config}.jetty.server.port}"
                                    passphrase="${@{config}.jetty.server.passphrase}"
                                    keyfile="/home/steff/.ssh/id_rsa"/>
                            <deploy server="${@{config}.jetty.server.host}"
                                    file="${project.build.finalName}.xml"
                                    todir="${@{config}.jetty.server.user}@${@{config}.jetty.server.host}:${@{config}.jetty.server.baseDir}/${@{config}.jetty.server.contextDir}"
                                    port="${@{config}.jetty.server.port}"
                                    passphrase="${@{config}.jetty.server.passphrase}"
                                    keyfile="/home/steff/.ssh/id_rsa"/>                                     
                        </sequential>
                    </macrodef>                             
                    <deploy-app config="home"/>     
                    <deploy-app config="wap"/>
                </tasks>
            </configuration>
            <goals>
                <goal>run</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

然后你的属性文件需要是这样的：

```
home.jetty.server.user=
home.jetty.server.port=
home.jetty.server.host=
home.jetty.server.baseDir=
home.jetty.server.webappsDir=
home.jetty.server.contextDir=
home.jetty.server.passphrase=
wap.jetty.server.user=
wap.jetty.server.port=
wap.jetty.server.host=
wap.jetty.server.baseDir=
wap.jetty.server.webappsDir=
wap.jetty.server.contextDir=
wap.jetty.server.passphrase= 
```

等等...在每个服务器配置使用的一个选项块上

```
<deploy-app config="<config>"/> 
```

诀窍是在 ant 中使用 @{} 作为属性评估 ${} 的优先级的宏定义属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-18T21:04:01.287

也许“最小”的解决方案根本不是最小的。如果您在 Maven 本身中执行此操作时遇到问题，请尝试使用 ant：创建两个不同的部署任务（每个服务器一个）和另一个将它们作为依赖项的任务。有几个示例如何使用 ant 部署到 tomcat 服务器。[只是谷歌他们](http://www.google.com/search?q=ant+deploy+to+tomcat)。完成此操作后，您需要将新的 ant 任务集成到 maven 中，使用[antrun](http://maven.apache.org/plugins/maven-antrun-plugin/)插件一点也不难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T15:54:13.037

此答案适用于 Jetty，适用于稍微不同的情况，但无论如何您可能会发现它很有用。

在之前的项目中，我们使用了 Jetty，因此我编写了一个简单的 Jetty 部署程序模块，它会定期扫描 maven 存储库并在新工件可用时立即下载和部署它们。这在一小群登台和开发机器上运行良好。

[您可以在Polar Rose Jetty Maven Deployer](http://code.google.com/p/polarrose-jetty-maven-deployer/)项目的 Google 代码中找到代码。

请注意，我们仅对开发和登台服务器执行此操作。在我看来，生产应用程序永远不应该自动升级。

# spring - Spring 集成：RendezvousChannel 是如何工作的？

> ID：732277
> 
> 赞同：3
> 
> 时间：2009-04-08T23:29:08.977
> 
> 标签：spring

我还没有找到任何关于 RendezvousChannel 如何在 Spring Integration 中工作的示例。有谁知道任何资源？

我已经读过 RendezvousChannel 对于使请求/响应客户端适应 Spring Integration 中的异步消息传递很有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T09:30:15.257

`RendezvousChannel`扩展`QueueChannel`并表现出相同的行为：

*   从通道块中读取，直到有消息可用或发生超时。
*   写入通道会阻塞，直到队列的容量允许另一条消息或发生超时。

但是，在内部，`RendezvousChannel`将容量**0**与 a 结合使用[`SynchronousQueue`](https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/SynchronousQueue.html)。因此，发送方将阻塞，直到接收方完成，好吧，接收，反之亦然，基本上建立了同步通信。

至于例子，我认为还没有。

如果您想了解如何`RendezvousChannel`将其用作实现请求/回复场景的临时回复通道（如[参考文档 spring channel-implementations](http://docs.spring.io/spring-integration/reference/html/messaging-channels-section.html#channel-implementations)的第 4.1.2 节中所暗示的那样），请查看源代码`sendAndReceive`的方法[`MessageChannelTemplate`](http://docs.spring.io/spring-integration/reference/html/messaging-channels-section.html#channel-template)。那一个`PollableChannel`在内部使用实现，但模式可以很容易地转移`RendezvousChannel`。

# php - Image in a PHP File

> ID：732278
> 
> 赞同：0
> 
> 时间：2009-04-08T23:29:12.113
> 
> 标签：php, html

I have a text link in a php file, but I want to make it an image link. The current code is.

```
$link="<a target='_blank' href='/stuff/morestuff/?url=".rawurlencode($url)."'>".t("Add")."</a>"; 
```

Now instead word "Add" I want to have an image in there. My current syntax to do that isn't working though, my error is Parse error: syntax error, unexpected T_STRING. Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T23:33:40.387

This should work

```
$link="<a target='_blank' href='/stuff/morestuff/?url=".rawurlencode($url)."'><img src='". $url_to_image ."' alt='' /></a>"; 
```

I am not sure what variable you have assigned to `$url_to_image` since `t()` looks like a custom function.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T23:39:56.283

您可能在字符串中写了双引号而没有转义它们，如下所示：

```
t("<img src="http://asdf.com/jkl.png" />") 
```

这将导致您提到的 T_STRING 错误。正确的写法是：

```
t("<img src=\"http://asdf.com/jkl.png\" />") 
```

或者您可以使用单引号来分隔字符串或 HTML 标记属性：

```
t("<img src='http://asdf.com/jkl.png' />")
t('<img src="http://asdf.com/jkl.png" />') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T23:35:41.130

First of all...the error must have been in your function "t". I am assuming that you have a function "t" :)

Here is the simplest way to put the link in instead of the word:

```
$link = "<a target='_blank' href='/stuff/morestuff/?url=" . rawurlencode($url) . "'><img src='http://www.myimage.com' /></a>"; 
```

Does that answer the question?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T23:44:52.340

PHP 代码只是生成 HTML，你希望它看起来像..

```
<a target='_blank' href='/stuff/morestuff/?url=abcdef'><img src='image.jpg'></a> 
```

要PHP'ify，你会做..

```
$link = "<a target='_blank' href='/stuff/morestuff/?url=".rawurlencode($url)."'><img src='".$url."'></a>"; 
```

..或者，更整洁地使用 sprintf：

```
$link = sprintf("<a target='_blank' href='/stuff/morestuff/?url=%s'><img src='$s'></a>",
    rawurlencode($url),
    $url
); 
```

# javascript - 高级 JavaScript 数据存储和网格小部件

> ID：732280
> 
> 赞同：2
> 
> 时间：2009-04-08T23:30:32.373
> 
> 标签：javascript, gridview, extjs, grid, datastore

我们用 JavaScript 编写了一个数据存储/网格小部件系统，当某些数据发生变化时，它会自动更新与数据存储关联的所有小部件。

它的优点是：

1.  它支持**按多个属性排序**（例如，按状态，然后优先级降序，然后日期升序，或其他）
2.  每当记录更改时，**排序顺序就会恢复。**（我们为此使用了一种有效的基于树的算法。许多更改是通过数据流接收的）。

在我们写完概念证明之后（还有很多工作要做），我看到一些博客文章讨论了 JavaScript 中类似的“MVC”模式，以及 ExtJS 的网格和数据存储特性。这让我担心我们可能会重新发明轮子。

似乎 ExtJS 的网格无法复制我们的功能——它不会在数据更改后恢复排序顺序，如果我们能以某种方式复制多属性排序等等，我觉得它会非常低效。

**我的问题**：是否有满足我们要求的数据存储/网格小部件的库/框架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T23:43:20.517

Ext 设计精良且完整，它是为数不多的旨在满足您大部分需求的库之一。我建议简单地增强 Ext 中的内容。

多列已经完成：

[http://www.extjs.com/forum/showthread.php?t=48324](http://www.extjs.com/forum/showthread.php?t=48324)

ExtJs 很有可能也能够重用您的排序代码。

# c# - 在 LINQ 中表达递归

> ID：732281
> 
> 赞同：26
> 
> 时间：2009-04-08T23:30:59.160
> 
> 标签：c#, .net, linq, recursion, hierarchical-data

我正在为分层数据源编写 LINQ 提供程序。我发现通过编写示例来展示我想要如何使用它，然后编写代码来支持这些用例，来设计我的 API 是最容易的。

我遇到的一件事是在 LINQ 语句中表达“深度查询”或递归的简单/可重用/优雅的方式。换句话说，区分以下内容的最佳方法是什么：

```
from item in immediate-descendants-of-current-node where ... select item 
```

相对：

```
from item in all-descendants-of-current-node where ... select item 
```

（*编辑：请注意，以上这些示例都不一定反映我想要的查询结构。我对**任何**表达递归/深度的好方法*感兴趣）

**请注意**，我不是在问如何实现这样的提供程序，或者如何以允许递归的方式编写我的 IQueryable 或 IEnumerable。我是从编写 LINQ 查询并使用我的提供程序的人的角度来问的——他们表达是否要递归的直观方式是什么？

数据结构类似于典型的文件系统：文件夹可以包含子文件夹的集合，文件夹也可以包含项目的集合。所以 myFolder.Folders 代表了 myFolder 的所有直接子文件夹，而 myFolder.Items 包含了 myFolder 中的所有项目。这是站点层次结构的基本示例，很像带有文件夹和页面的文件系统：

```
(F)Products
    (F)Light Trucks
        (F)Z150
            (I)Pictures
            (I)Specs
            (I)Reviews
        (F)Z250
            (I)Pictures
            (I)Specs
            (I)Reviews
        (F)Z350
            (I)Pictures
            (I)Specs
            (I)Reviews
        (I)Splash Page
    (F)Heavy Trucks
    (F)Consumer Vehicles
    (I)Overview 
```

如果我写：

```
from item in lightTrucks.Items where item.Title == "Pictures" select item 
```

表达查询获取轻型卡车下的所有项目或仅直接项目的意图的最直观方式是什么？区分这两种意图的侵入性最小、摩擦最小的方法是什么？

我的 #1 目标是能够将此 LINQ 提供程序转交给对 LINQ 有平均理解的其他开发人员，并允许他们编写递归和列表查询，而无需向他们提供编写递归 lambda 的教程。给定一个看起来不错的用法，我可以对提供程序进行编码。

**附加说明：（**我真的很讨厌交流这个！） - 这个 LINQ 提供程序是针对外部系统的，它不仅仅是遍历对象图，在这种特定情况下，递归*表达式*实际上也不会转化为任何类型的真正递归活动在引擎盖下。只需要一种方法来区分“深”查询和“浅”查询。

那么，你认为最好的表达方式是什么？还是有一种我错过的标准表达方式？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-08T23:37:18.397

Linq-toXml 可以很好地处理这个问题，有一个 XElement.Elements()/.Nodes() 操作来获取直接子代，还有一个 XElement.Descendents()/DescendentNodes() 操作来获取所有后代。你会认为这是一个例子吗？

总结 Linq-to-Xml 的行为......每个导航函数都对应于 XPath ( [http://www.w3schools.com/xpath/xpath_axes.asp](http://www.w3schools.com/xpath/xpath_axes.asp) ) 中的一个轴类型。如果导航功能选择元素，则使用轴名称。如果导航功能选择节点，则使用轴名称并附加节点。

例如，有函数 Descendants() 和 DescendantsNode() 对应于 XPath 的后代轴，返回 XElement 或 XNode。

异常情况是最常用的情况，即儿童轴，这并不奇怪。在 XPath 中，如果没有指定轴，这是使用的轴。为此，linq-to-xml 导航函数不是 Children() 和 ChildrenNodes()，而是 Elements() 和 Nodes()。

XElement 是 XNode 的子类型。XNode 包括 HTML 标记之类的内容，还包括 HTML 注释、cdata 或文本。XElements 是 XNode 的一种，但特指 HTML 标签。XElements 因此有一个标签名称，并支持导航功能。

现在，在 Linq-to-XML 中链接导航不像在 XPath 中那样容易。问题是导航函数返回集合对象，而导航函数应用于非集合。考虑 XPath 表达式，它选择表标签作为直接子标签，然后选择任何后代表数据标签。我认为这看起来像“./children::table/descendants::td”或“./table/descendants::td”

使用 IEnumerable<>::SelectMany() 可以调用集合上的导航函数。上面的等价物看起来像 .Elements("table").SelectMany(T => T.Descendants("td"))

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-27T13:39:56.400

嗯，首先要注意的是，实际上，lambda 表达式可以是递归的。不，老实说！这不容易做到，**当然**也不容易阅读 - 哎呀，大多数 LINQ 提供程序（LINQ-to-Objects 除外，它更简单）只是看着它就会咳嗽......但它***是可能的***。[请参阅此处](http://blogs.msdn.com/madst/archive/2007/05/11/recursive-lambda-expressions.aspx)了解完整的血腥细节（警告 - 可能会导致脑痛）。

然而！！这可能不会有太大帮助......对于一种实用的方法，我会看看它的方式等等......注意你可以使用 a or`XElement`删除一些递归：`Queue<T>``Stack<T>`

```
using System;
using System.Collections.Generic;

static class Program {
    static void Main() {
        Node a = new Node("a"), b = new Node("b") { Children = {a}},
            c = new Node("c") { Children = {b}};
        foreach (Node node in c.Descendents()) {
            Console.WriteLine(node.Name);
        }
    }
}

class Node { // very simplified; no sanity checking etc
    public string Name { get; private set; }
    public List<Node> Children { get; private set; }
    public Node(string name) {
        Name = name;
        Children = new List<Node>();
    }
}
static class NodeExtensions {
    public static IEnumerable<Node> Descendents(this Node node) {
        if (node == null) throw new ArgumentNullException("node");
        if(node.Children.Count > 0) {
            foreach (Node child in node.Children) {
                yield return child;
                foreach (Node desc in Descendents(child)) {
                    yield return desc;
                }
            }
        }
    }
} 
```

* * *

另一种方法是编写类似的东西`SelectDeep`（模仿`SelectMany`单个级别）：

```
public static class EnumerableExtensions
{
    public static IEnumerable<T> SelectDeep<T>(
        this IEnumerable<T> source, Func<T, IEnumerable<T>> selector)
    {
        foreach (T item in source)
        {
            yield return item;
            foreach (T subItem in SelectDeep(selector(item),selector))
            {
                yield return subItem;
            }
        }
    }
}
public static class NodeExtensions
{
    public static IEnumerable<Node> Descendents(this Node node)
    {
        if (node == null) throw new ArgumentNullException("node");
        return node.Children.SelectDeep(n => n.Children);
    }
} 
```

同样，我没有对此进行优化以避免递归，但它可以很容易地完成。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-08T23:49:53.060

我会以这样一种方式来实现它，以便控制我想要查询的深度。

像 Descendants() 这样的东西会通过所有级别检索 Descendants，而 Descendants(0) 会检索直系子女， Descendants(1) 会获得子女和孙子女等等......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-08T23:40:16.860

我将只实现两个函数来清楚地区分这两个选项（Children 与 FullDecendants），或者重载 GetChildren(bool returnDecendants)。每个都可以实现 IEnumerable，因此只需将哪个函数传递给其 LINQ 语句即可。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T16:00:07.420

您可能希望为您的类型实现一个（扩展）方法，如 FlattenRecusively。

```
from item in list.FlattenRecusively() where ... select item 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-30T03:27:07.393

Rex，您当然开启了一个有趣的讨论，但您似乎已经消除了所有可能性 - 也就是说，您似乎拒绝（1）让消费者编写递归逻辑，以及（2）让您的节点类公开更大的关系超过一度。

或者，也许您还没有完全排除 (2)。我可以想到另一种方法，它几乎与 GetDescendents 方法（或属性）一样具有表现力，但可能不会那么“笨重”（取决于树的形状）......

```
from item in AllItems where item.Parent == currentNode select item 
```

和

```
from item in AllItems where item.Ancestors.Contains(currentNode) select item 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-09T00:13:23.987

我不得不同意弗兰克的观点。看看 LINQ-to-XML 如何处理这些场景。

事实上，我会完全模拟 LINQ-to-XML 实现，但要针对任何数据类型进行更改。为什么要重新发明轮子？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-30T01:19:20.943

你可以在你的物体上做繁重的工作吗？（它甚至没有那么重）

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;

namespace LinqRecursion
{
    class Program
    {
        static void Main(string[] args)
        {
            Person mom = new Person() { Name = "Karen" };
            Person me = new Person(mom) { Name = "Matt" };
            Person youngerBrother = new Person(mom) { Name = "Robbie" };
            Person olderBrother = new Person(mom) { Name = "Kevin" };
            Person nephew1 = new Person(olderBrother) { Name = "Seth" };
            Person nephew2 = new Person(olderBrother) { Name = "Bradon" };
            Person olderSister = new Person(mom) { Name = "Michelle" };

            Console.WriteLine("\tAll");
            //        All
            //Karen 0
            //Matt 1
            //Robbie 2
            //Kevin 3
            //Seth 4
            //Bradon 5
            //Michelle 6
            foreach (var item in mom)
                Console.WriteLine(item);

            Console.WriteLine("\r\n\tOdds");
            //        Odds
            //Matt 1
            //Kevin 3
            //Bradon 5
            var odds = mom.Where(p => p.ID % 2 == 1);
            foreach (var item in odds)
                Console.WriteLine(item);

            Console.WriteLine("\r\n\tEvens");
            //        Evens
            //Karen 0
            //Robbie 2
            //Seth 4
            //Michelle 6
            var evens = mom.Where(p => p.ID % 2 == 0);
            foreach (var item in evens)
                Console.WriteLine(item);

            Console.ReadLine();

        }
    }

    public class Person : IEnumerable<Person>
    {
        private static int _idRoot;

        public Person() {
            _id = _idRoot++;
        }

        public Person(Person parent) : this()
        {
            Parent = parent;
            parent.Children.Add(this);
        }

        private int _id;
        public int ID { get { return _id; } }
        public string Name { get; set; }

        public Person Parent { get; private set; }

        private List<Person> _children;
        public List<Person> Children
        {
            get
            {
                if (_children == null)
                    _children = new List<Person>();
                return _children;
            }
        }

        public override string ToString()
        {
            return Name + " " + _id.ToString();
        }

        #region IEnumerable<Person> Members

        public IEnumerator<Person> GetEnumerator()
        {
            yield return this;
            foreach (var child in this.Children)
                foreach (var item in child)
                    yield return item;
        }

        #endregion

        #region IEnumerable Members

        IEnumerator IEnumerable.GetEnumerator()
        {
            return this.GetEnumerator();
        }

        #endregion
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-30T04:30:12.157

我只是使用扩展方法来遍历树。

哦，等等，我已经在这样做[了](http://xacc.wordpress.com/2009/03/05/tree-traversal-extension-methods/)！:)

# php - Updating PHP.ini on a GoDaddy Hosted site

> ID：732289
> 
> 赞同：3
> 
> 时间：2009-04-08T23:36:29.677
> 
> 标签：php, mysql

I am pretty new to PHP programming so I apologize if I am missing the obvious.

I have a site hosted at GoDaddy (Windows, PHP5, MySQL 5). I read this article: [GoDaddy FAQ](http://help.godaddy.com/article/1085) and created a php5.ini file in the root folder but when I try to connect to the database, I get the following error:

> Fatal error: Call to undefined function mysql_connect() in D:\Hosting\4132900\html\beta\data\dbConnection.php on line 13

All I have in my ini file is:

```
[Date]
date.timezone = "US/Eastern" 
```

When I upload my entire php.ini file (and rename it to php5.ini), I get Page Not Found errors (404).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T23:52:12.447

我不认为 Windows 托管允许自定义 PHP5.ini :(

我查看了他们的帮助站点，您链接到的那篇文章是针对 Linux 服务器的。

此外，比较此页面上的计划：[http](http://www.godaddy.com/gdshop/hosting/shared.asp?ci=9009) ://www.godaddy.com/gdshop/hosting/shared.asp? ci=9009 表明 Linux 允许自定义 PHP5.ini 但不允许 Windows

我想知道是否尝试使用一个搞砸了 PHP 并使您尝试使用的“mysql_connect”函数不可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-21T22:53:28.220

我只是在键盘上敲了敲头，以找到在 Godaddy 中编辑 php.ini 的解决方案。phpinfo() 返回我无法访问的路径（啊！）。解决方案：将自己的上传到**public_html**文件夹的根目录。

显然取决于您拥有的godaddy版本，文件名不同。

[http://support.godaddy.com/help/article/8913/what-filename-does-my-php-initialization-file-phpini-need-to-use](http://support.godaddy.com/help/article/8913/what-filename-does-my-php-initialization-file-phpini-need-to-use)

我受够了，我创建了名为**php.ini**、**php5.ini**和**.user.ini**的相同文件，并将它们复制到我的 www、public_html 和域根目录的根目录中。之后一切都开始工作了。

根据我的阅读，可能存在一种情况，您必须转到“系统进程”并重新启动 php 进程（我找不到那个并且没有任何活动的 php 进程）。

这里也有一些很好的信息。向下滚动到 Godaddy 部分。

[http://www.ostraining.com/blog/coding/phpini-file/](http://www.ostraining.com/blog/coding/phpini-file/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-12T15:12:13.753

根据这个页面，他们特别说要在 Windows 帐户中使用 php5.ini： [GoDaddy 文章](http://help.godaddy.com/article/5647?isc=&locale=en#windows)

“注意：您必须在 Windows 主机帐户中使用 php5.ini 文件，而不是 php.ini。”

# javascript - 引发 javascript 事件或从 XY 坐标获取对象

> ID：732294
> 
> 赞同：2
> 
> 时间：2009-04-08T23:38:52.837
> 
> 标签：javascript, dhtml

如果鼠标悬停，我可以得到一个对象。我可以在任何给定时间获取鼠标的坐标。给定它的坐标，我如何获得一个对象 - 如果它们与鼠标不同？

本质上，用户将 div 放在屏幕上的某个位置。由于 div 比鼠标光标宽，我需要知道 div 的角在什么对象上（而不是鼠标在什么对象上）。有没有办法在 JS 中引发 mousemove 事件 - 将坐标传递给它？
谢谢

* * *

对于阅读这篇文章的其他人来说，这只是一个快速的帖子脚本。虽然我没有选择 jquery 作为我的答案，但它可能是你的答案。对于我们想要提供的许多客户端工具，这似乎是一个非常灵活且功能丰富的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T00:34:10.490

没有直接回答您的问题，但您是否尝试过使用 jQuery UI 等 javascript 库？它提供了良好的拖放支持，您可以做您所说的各种事情......例如。您可以使页面的某些元素可拖动而其他元素可放置，然后在用户拖动元素时处理事件。它为包含“触摸”（以及“适合”、“相交”、“指针”）的可放置对象提供了容差，因此您可以处理可放置目标的“过度”事件并且您会得到一个事件当 div 的角在给定元素上方时触发的处理程序。此事件处理程序为您提供对被拖动元素以及被拖动元素的引用。（有点倒退到你问这个问题的方式，

希望这会有所帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T00:38:46.890

没有办法引发 mousemove 并让它填充生成的目标元素属性，不。

有一种方法可以从任意坐标中获取元素，但您不会很喜欢它。它涉及遍历每个页面元素并计算其尺寸（来自 offsetLeft/Top/Parent）以及哪些元素覆盖哪些其他元素（来自计算的样式“位置”和“z-index”）......本质上，重新实现部分浏览器自己的脚本布局引擎。如果您有带有“溢出”滚动/自动的元素，则需要进行更多计算。

如果您的情况有限（例如，您只能将 div 放在一组其他静态定位的 div 中的某处）它是可以管理的，但一般情况下非常困难并且一点也不好玩。（也许某处有人将这样的功能打包到库或框架插件中，但我还没有遇到过。）

如果你能找到另一种方法来让你的拖放表现得很好，而不需要你这样做，那就这样做吧！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T22:07:34.720

要从它的坐标中获取一个对象，有`document.elementFromPoint(x,y)`. Quirksmode 的[兼容性表](http://www.quirksmode.org/dom/w3c_cssom.html#documentview)显示它适用于最新的浏览器。

# c# - P/Invoke 帮助期间的 AccessViolationException

> ID：732304
> 
> 赞同：0
> 
> 时间：2009-04-08T23:43:39.473
> 
> 标签：c#, marshalling, sizeof, access-violation

从外部 DLL 调用以下内容时，我不断收到 AccessViolationException：

```
FILES_GetMemoryMapping(MapFile, out size, MapName, out PacketSize, pMapping, out PagePerSector); 
```

其中有一个我这样设置的原型：

```
 [DllImport("Files.DLL", SetLastError = true)]
    public static extern uint FILES_GetMemoryMapping(
        [MarshalAs(UnmanagedType.LPStr)]
        string pPathFile,
        out ushort Size,
        [MarshalAs(UnmanagedType.LPStr)]
        string MapName,
        out ushort PacketSize,
        IntPtr pMapping,
        out byte PagesPerSector); 
```

现在，导致这种情况的参数很可能是第 5 个参数（IntPtr pMapping）。我已将此代码从 C++ 应用程序移植到 C#。上面的第 5 个参数是一个指向一个结构的指针，它还包含一个指向另一个结构的指针。以下是我如何设置这些结构：

```
 [StructLayout(LayoutKind.Sequential)]
    public struct MappingSector
    {
        [MarshalAs(UnmanagedType.LPStr)]
        public string Name;
        public uint dwStartAddress;
        public uint dwAliasedAddress;
        public uint dwSectorIndex;
        public uint dwSectorSize;
        public byte bSectorType;
        public bool UseForOperation;
        public bool UseForErase;
        public bool UseForUpload;
        public bool UseForWriteProtect;
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct Mapping
    {
        public byte nAlternate;
        [MarshalAs(UnmanagedType.LPStr, SizeConst=260)]
        public string Name;
        public uint NbSectors;
        public IntPtr pSectors;
    } 
```

这些的 C++ 等价物如下：

```
typedef struct {
    char*       Name;
    DWORD       dwStartAddress;
    DWORD       dwAliasedAddress;
    DWORD       dwSectorIndex;
    DWORD       dwSectorSize;
    BYTE        bSectorType;
    BOOL        UseForOperation;
    BOOL        UseForErase;
    BOOL        UseForUpload;
    BOOL        UseForWriteProtect;
} MAPPINGSECTOR, *PMAPPINGSECTOR;

typedef struct {
    BYTE            nAlternate;
    char            Name[MAX_PATH]; // MAX_PATH = 260
    DWORD           NbSectors;
    PMAPPINGSECTOR  pSectors;   
} MAPPING, *PMAPPING; 
```

我觉得我在移植这些结构或移植函数原型时做错了。某种编组问题。

这篇文章顶部的函数在我的代码中被调用了两次。一旦 pMapping 设置为 null（这会将一个值放入“大小”中）。然后使用此大小参数为新结构分配内存，并且现在使用指向此分配内存空间的指针再次调用该函数以进行 pMapping。（pMapping 还有一个指向另一个结构的指针，该结构在此期间也分配了一些空间）。

这是完成此操作的旧 c++ 代码：

```
FILES_GetMemoryMapping((LPSTR)(LPCTSTR)MapFile, &Size, (LPSTR)MapName, &PacketSize, pMapping, &PagePerSector);
// Allocate the mapping structure memory
pMapping = (PMAPPING)malloc(sizeof(MAPPING));
pMapping->NbSectors = 0;
pMapping->pSectors = (PMAPPINGSECTOR) malloc((Size) * sizeof(MAPPINGSECTOR));
printf("mapsectorsize: <%d>\n", football);
printf("pMappingsize: <%d>\n", f2);  
// Get the mapping info
FILES_GetMemoryMapping((LPSTR)(LPCTSTR)MapFile, &Size, (LPSTR)(LPCTSTR)MapName, &PacketSize, pMapping, &PagePerSector); 
```

我最初认为我没有分配正确的空间量，所以我尝试了上面的旧 C++ 代码并发现：

```
sizeof(MAPPING) = 272
and
sizeof(PMAPPINGSECTOR) = 40 
```

我在我的 C# 代码中进行了相同的检查，发现以下内容：

```
Marshal.SizeOf(new Mapping()) = 16
and
Marshal.SizeOF(new MappingSector()) = 40 
```

我们这里有问题。Mapping 结构的大小应该是 272，但它只有 16。我想我可以做一个快速修复，我在这里手动分配了 272 而不是 16，但它仍然出错，并出现 AccessViolationException。

关于如何解决这个问题的任何想法？或者还有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T23:57:01.267

“原型”不是正确的词，我更喜欢“DLLImport 声明”。

而且我刚刚开始工作。

所以在 C++ 中：

```
typedef struct {
    BYTE                        nAlternate;
    char                        Name[MAX_PATH]; // MAX_PATH = 260
    DWORD                       NbSectors;
    PMAPPINGSECTOR      pSectors;       
} 
```

到 C#：

```
[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi)]
public struct Mapping
{
    public byte nAlternate;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst=260)]
    public char[] Name;
    public uint NbSectors;
    public IntPtr pSectors;
} 
```

字符数组不是字符串，应该被视为字符数组......谁会猜到：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T00:11:08.547

[根据 MSDN](http://msdn.microsoft.com/en-us/library/s9ts558h.aspx)，您应该将 StringBuilder 传递给固定长度的缓冲区。尝试以下或一些变体（未经测试）：

```
[StructLayout(LayoutKind.Sequential)]
public struct Mapping
{
    public byte nAlternate;
    [MarshalAs(UnmanagedType.LPStr, SizeConst=260)]
    public StringBuilder Name;
    public uint NbSectors;
    public IntPtr pSectors;

    public Mapping()
    {
        Name = new StringBuilder(259); 
        //This will be a buffer of size 260 (259 chars + '\0')
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T23:48:54.390

恐怕我还没有完成这一切，但是如果你有带有'char *'的结构并且你将它们编组为'string'，那么你应该小心用适当的 CharSet = CharSet.Ansi 属性。

添加到您的帖子中有用的一件事是该函数的 C++ 原型（我不会将您的 DLLImport 声明称为“原型”，但这可能只是我。）

# amazon-ec2 - FTP 和 EC2

> ID：732308
> 
> 赞同：19
> 
> 时间：2009-04-08T23:45:20.763
> 
> 标签：amazon-ec2

我已经启动并运行了我的 EC2 实例，并使用 yum install vsftpd 安装了 vsftpd。现在我已经启动了服务。

但不幸的是，指南似乎在这一点上结束了。

我如何实际使用我的 ftp 客户端登录到 ftp 服务器？

我应该输入什么服务器 url、用户名、密码等等？

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-09T00:55:53.060

您只需要在 EC2 实例上登录命令行所使用的相同凭证 - 主机名或 IP 地址，加上您在创建实例时使用的用户名（通常是 root）和 SSH 密钥对。

然后您就可以连接任何支持 SFTP 的客户端（例如 Mac 上的 Cyber​​Duck，Windows 上的 WinSCP）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-08-02T21:18:35.483

您需要在安全组中启用正确的端口才能启用 FTP，不仅是 21 端口，还有 FTP 被动模式所需的端口。示例配置如下所述。

所需的 AWS 安全组更改：

*   打开 21 端口
*   开放端口范围 12000-12100

将以下行添加到 /etc/vsftpd.conf 文件中：

```
pasv_min_port=12000
pasv_max_port=12100 
```

重启 vsftpd 服务器：

```
$ sudo /etc/init.d/vsftpd restart 
```

您也可以考虑在您的安全组中为一个非常特定的源 IP 地址/范围打开上述端口，然后您将能够仅从您的机器连接到您的 EC2 实例，这会更安全一些。然而，正如 Gareth 所回答的，更安全的设置是使用 SFTP，它通过 SSH。我还建议您查看描述如何连接到[Linux](http://wiki.bitnami.org/cloud/how_to_connect_to_your_amazon_instance)或 [Windows](http://wiki.bitnami.org/cloud/How_to_connect_to_your_Windows_AMI%3f)实例的 BitNami wiki 文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-23T17:12:10.537

如果您想使用 FTP（而不是 SFTP）连接，只需从您的 Amazon 实例打开端口 21。

从 FTP 客户端，输入您的用户名/密码，然后从连接类型中选择使用端口（Cute Ftp）。对于其他 FTP 客户端，应该有类似的东西。

通过这种方式，您不需要打开任何其他端口，也不需要任何额外的凭据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T06:49:33.867

如果您想使用 ftp 而不是 sftp 连接，则需要先安装 webmin。

安装 webmin：

```
apt-get update
apt-get install webmin 
```

如果没有存储库，请先执行以下步骤：

```
wget http://prdownloads.sourceforge.net/webadmin/webmin_1.600_all.deb 
```

运行此命令：

```
dpkg --install webmin_1.600_all.deb

apt-get install perl libnet-ssleay-perl openssl libauthen-pam-perl libpam-runtime libio-pty-perl apt-show-versions python 
```

然后配置ftp。

配置完成后，您可以使用 filezilla、aceftp 或其他一些 ftp 程序。但这将在被动模式下工作。

# asp.net - 如果可以并行化，只能异步实现 ASP.NET WebMethod？

> ID：732311
> 
> 赞同：0
> 
> 时间：2009-04-08T23:46:30.323
> 
> 标签：asp.net, asynchronous

在[这篇](http://msdn.microsoft.com/en-us/library/ms998549.aspx)MSDN 文章（第 6 章 — 提高 ASP.NET 性能）中，它说如下：

> ***“避免异步调用，除非你有额外的并行工作***
> 
> *仅当您的应用程序在等待异步调用完成时有额外的并行工作要执行并且异步调用执行的工作不受 CPU 限制时，才从您的 Web 应用程序进行异步调用。**在内部，异步调用使用线程池中的工作线程；实际上，您正在使用额外的线程。***
> 
> *在进行异步 I/O 调用的同时，例如调用 Web 方法或执行文件操作，发出调用的线程被释放，以便它可以执行额外的工作，例如进行其他异步调用或执行其他并行任务。然后，您可以等待所有这些任务完成。进行几个不受 CPU 限制的异步调用，然后让它们同时运行可以提高吞吐量。*

这让我很困惑。我的理解是，当您进行异步 I/O 调用时，在等待时不使用线程，而是使用对回调方法的引用设置 IOCP。当您有并行工作时，您是否应该只使用异步调用？我的理解是，对于 ASP.NET Web 服务，当您将调用 I/O 绑定操作并异步实现整个事情时，将WebMethod **Foo**更改为**BeginFoo/EndFoo通常是一个好主意。**

有人可以帮我理解“异步调用使用线程池中的工作线程”是什么意思吗？实际上，您正在使用额外的线程”，以及 WorkerThreads 和 IO-threads 之间的区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-03T12:42:55.430

明确区分进程密集型操作（如计算十亿分之一素数）和 IO 绑定操作（如发出 Web 服务请求）非常重要。

进程密集型操作*确实*需要一个线程来运行，所以你是对的，使用 ASP.NET 异步实现没有任何好处，因为你仍然占用一个 IIS 线程。

IO 绑定操作不同，它们使用操作系统 IO 完成端口并且不需要线程。在这种情况下，使用 ASP.NET 异步模型真的很有帮助，因为请求处理只需要一个线程短时间执行 IO 请求，然后另一个线程短时间处理 IO 回调并返回回复。这确实有助于可扩展性。

Jeff Prosise 在这里有一篇关于这个主题的好帖子：http: [//www.wintellect.com/CS/blogs/jprosise/archive/2010/03/29/asynchronous-controllers-in-asp-net-mvc-2.aspx](http://www.wintellect.com/CS/blogs/jprosise/archive/2010/03/29/asynchronous-controllers-in-asp-net-mvc-2.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T04:08:28.910

对 ASP.NET 应用程序的每个请求都在其自己的线程中运行，该线程来自 w3wp 工作进程可用的线程池。当您运行异步调用时，您实际上是在向 ASP.NET 应用程序发出单独的请求并使用池中可用的另一个线程。池的大小是固定的，具体取决于您的服务器配置和硬件限制，它代表您的服务器在任何时候可以满足的最大请求数。

异步调用主要用于需要多个“繁重”操作以减少将页面返回给客户端所需的时间，并在某些情况下**提高整体线程可用性。**

这样想，您请求的网页有四个股票图表（1 个线程正在使用）。页面向第一个库存服务发出请求（1 个新线程 + 1 个旧线程 = 2 个线程正在使用。）页面接收结果（1 个线程关闭，1 个线程正在使用）。该页面向第二个股票服务发出请求（1 个新线程 + 1 个旧线程 = 2 个正在使用的线程。）等等。假设每个股票服务需要 4 秒来响应，那么您将在 16 秒时占用 2 个线程，总处理时间为 32 秒（更不用说加载客户端页面需要 16 秒的事实。）这些数字是当然都是假的，但旨在说明这一点。

现在，在异步实现中，您请求的网页有四个股票图表（正在使用 1 个线程）。该页面向股票服务发出四个请求（1 个旧线程 + 4 个新线程 = 5 个正在使用的线程）假设每个股票服务需要四个秒响应，您在 4 秒内占用 5 个线程，总处理时间为 20 秒，**客户端在 4 秒内收到页面。** 您降低了操作的总体成本，因为您的主线程在提供客户端页面之前无法释放，它的使用时间较短。

最后，这些都与 I/O 线程无关。因为它包含 I/O 操作而调用异步 Web 方法不一定会给您带来任何好处**，除非您在等待结果时需要完成大量处理。** 或者，用文章的话来说，“避免异步调用，除非你有额外的并行工作”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T00:24:39.873

看看这个[http://msdn.microsoft.com/en-us/library/ms979194.aspx](http://msdn.microsoft.com/en-us/library/ms979194.aspx)因为它应该向您展示如何监视线程​​池。希望这会有所帮助...问候，安迪

# xml-serialization - Xmlserializer - 控制元素属性配对（修订）

> ID：732314
> 
> 赞同：2
> 
> 时间：2009-04-08T23:48:02.207
> 
> 标签：xml-serialization

除了一个例外，它可以满足我的`XmlSerializer`一切需求。我需要将一个元素与另一个元素配对作为该元素的属性。我不想编写完全自定义的序列化方法。这是我的课：

```
public class Transaction
{
   [XmlElement("ID")]
   public int m_id;

   [XmlElement("TransactionType")]
   public string m_transactiontype;

   [XmlAttribute("TransactionTypeCode")]
   public string m_transactiontypecode;
} 
```

我实例化和序列化如下；

```
 Transaction tx = new Transaction();

   tx.m_id = 1;   
   tx.m_transactiontype = "Withdrawal";  
   tx.m_transactiontypecode = "520";

   StringWriter o = new
   StringWriter(CultureInfo.InvariantCulture);
   XmlSerializer s = new
   XmlSerializer(typeof(Transaction));   
   s.Serialize(o, tx);   
   Console.Write(o.ToString()); 
```

给我：

```
 <Transaction TransactionTypeCode="520">
     <ID>1</ID>
     <TransactionType>Withdrawal</TransactionType> 
   </Transaction> 
```

我想：

```
 <Transaction>
     <ID>1</ID>
     <TransactionType TransactionTypeCode="520">Withdrawal</TransactionType>
   </Transaction> 
```

有人（Chris Dogget）建议：

```
 public class Transaction
   {

       [XmlElement("ID")]
       public int m_id;

       public TransactionType m_transactiontype;
   }

   public class TransactionType
   {
       public TransactionType(){}
       public TransactionType(string type) { this.m_transactiontype = type; }

       [XmlTextAttribute]
       public string m_transactiontype;

       [XmlAttribute("TransactionTypeCode")]
       public string m_transactiontypecode; 
   } 
```

TransactionType 类的使用看起来很有希望——你能告诉我在序列化之前如何实例化这些类吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T16:15:02.327

```
public class Transaction
{

    [XmlElement("ID")]
    public int m_id;

    public TransactionType type;
}

public class TransactionType
{
    public TransactionType(){}
    public TransactionType(string type) { this.@Type = type; }

    [XmlTextAttribute]
    public string @Type;

    [XmlAttribute("TypeCode")]
    public string typecode; 
} 
```

给了我这个：

```
<?xml version="1.0" encoding="utf-16"?>
<Transaction xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <ID>1</ID>
    <type TypeCode="520">Withdrawal</type>
</Transaction> 
```

不幸的是，“类型”是 .NET 中的实际类型，因此您不能真正使用它（至少大写）作为字段名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T16:23:30.530

I believe the only way to do this is to create a class of Type (bad name though, given that it's a keyword in the framework as well ...) with member property TypeCode. Then you have a Type instance or reference as part of class Transaction.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T19:53:20.347

假设此代码适用于您的类型：

```
public class Transaction
{
    public Transaction() { ttype = new TransactionType(); }

    [XmlElement("ID")]
    public int id;

    [XmlElement("TransactionType")]
    public TransactionType ttype;
}

public class TransactionType
{
    public TransactionType(){}
    public TransactionType(string txType) { this.type = txType; }

    [XmlText]
    public string type;

    [XmlAttribute("TransactionTypeCode")]
    public string typecode;
} 
```

此代码将以您想要的方式初始化和序列化：

```
public void Run()
{
    XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
    ns.Add( "", "" );

    Transaction tx = new Transaction();
    tx.id = 1;
    tx.ttype.type = "Withdrawal";
    tx.ttype.typecode = "520"; 
    using (StringWriter o = 
          new StringWriter(CultureInfo.InvariantCulture))
    {
        XmlSerializer s = new XmlSerializer(typeof(Transaction));
        s.Serialize(o, tx, ns);
        Console.Write(o.ToString());
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T16:12:13.787

我猜你应该用 Type 和 TypeCode 字段创建一个单独的类。用 [XmlAttribute] 装饰 TypeCode，用 [XmlText] 装饰 Type。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T17:05:29.600

实现[IXmlSerializable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)并使用[Linq to XML 构造您的序列化对象](http://www.orbifold.net/default/?p=558)。

通过这种方式，您可以准确控制 xml 的外观。

就个人而言，我会放弃 XmlSerialization，使用 XAML，而忘记尝试获取我的 XML*外观*。它可以看起来像垃圾，只要它*有效！*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T17:06:38.553

您所需的 XML 与您在代码中布置对象的方式不一致。

**如果您阅读 XML，您会说以下内容......**

事务包含两个元素：ID 和 Type。Type 有一个名为 TypeCode 的属性

**如果您查看您要创建的对象，您会说...**

事务包含三个属性：ID、Type 和 TypeCode

...您可以看到两者之间的脱节。您必须对齐每个目标以获得正确的序列化（修改类或 xml，以便两者对齐您要传达的内容）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-08T23:26:34.957

OK, let's remove the "'type' is a type in .NET" issue (my bad):

```
 public class Transaction
   {
       [XmlElement("ID")]
       public int m_id;

       [XmlElement("TransactionType")]
       public string m_transactiontype;

       [XmlAttribute("TransactionTypeCode")]
       public string m_transactiontypecode;
   } 
```

I instantiate and serialize as follows;

```
 Transaction tx = new Transaction();

   tx.m_id = 1;
   tx.m_transactiontype = "Withdrawal";
   tx.m_transactiontypecode = "520";

   StringWriter o = new StringWriter(CultureInfo.InvariantCulture);
   XmlSerializer s = new XmlSerializer(typeof(Transaction));
   s.Serialize(o, tx);
   Console.Write(o.ToString()); 
```

Gives me:

```
<Transaction TransactionTypeCode="520">
  <ID>1</ID>
  <TransactionType>Withdrawal</TransactionType>
</Transaction> 
```

I want:

```
<Transaction>
  <ID>1</ID>
  <TransactionType TransactionTypeCode="520">Withdrawal</TransactionType>
</Transaction> 
```

The use of the TransactionType class looks promising - can you show me how you would instantiate the classes before serializing?

Thanks!

# asp.net - ASP.NET 性能：工作线程和 I/O 线程

> ID：732315
> 
> 赞同：1
> 
> 时间：2009-04-08T23:48:16.327
> 
> 标签：asp.net, multithreading

**重复：** [工作线程和 I/O 线程有什么区别？](https://stackoverflow.com/questions/137400/whats-the-difference-between-a-worker-thread-and-an-i-o-thread)

IIS/ASP.NET 中的 I/O 线程和 Worker 线程有什么区别？这些概念如何影响 ASP.NET 应用程序的设计？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T00:10:53.603

请参阅[工作线程和 I/O 线程有什么区别？](https://stackoverflow.com/questions/137400/whats-the-difference-between-a-worker-thread-and-an-i-o-thread)

# search - 我在哪里可以找到大量用于压力测试源扫描系统的源文件？

> ID：732319
> 
> 赞同：0
> 
> 时间：2009-04-08T23:49:34.187
> 
> 标签：search, test-data

我认为 Linux 内核会有大量的 SLOC，但它甚至没有让 OpenGrok 眨眼。我知道已经问过最大项目的问题，但是可以说最大的代码集合是什么。我更喜欢 tar、gz 或集线器风格的地方，我可以在其中编写脚本并指向我的 subversion 或 git 客户端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T23:57:39.593

您为什么不获取整个发行版的源代码包，而不仅仅是内核呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T10:09:39.920

我认为有一些 Linux 和一些 BSD 发行版将所有包的所有源代码保存在单个源树中，特别是在嵌入式或特殊用途空间中。[OpenSolaris](http://Src.OpenSolaris.Org/source/xref/)以类似的方式进行管理。

# c - Visual Studio 中 const 与 #define 的问题

> ID：732321
> 
> 赞同：0
> 
> 时间：2009-04-08T23:51:19.593
> 
> 标签：c, visual-studio

据我了解，在 Visual Studio 编译器下应该可以正常工作，但`#define x y`它是首选方法。`const int x = y;``const int x = y;`

我拥有的 C 代码如下所示：

```
static const int x = 100000;

void SomeFunction(...)
{
    volatile static int y = x;
    ...
} 
```

这里的问题在于 y 的声明。如果我使用 a `#define`for x，那么没有问题，但是使用上面的代码会导致编译器返回“错误 c2099：初始化程序不是常量”。

我正在尝试从命令行编译，并且我没有使用任何编译器标志，所以我不确定是否需要设置一个标志以便编译器优化 const - 或者我是否偶然发现某种特殊情况。

将程序编译为 C++ 程序也可以，但如果可能的话，我宁愿避免这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T00:07:29.960

我对 C 标准一无所知，但我以前读过这个。这是我的理解。

严格的 ANSI C 编译器只允许您使用常量表达式作为初始化程序。请注意，常量表达式只能涉及文字值，不能涉及 const 限定的变量。

我相信这是因为在编译期间，编译器必须计算要初始化的值，以便它可以将该值静态推送到堆栈上，而无需在运行时进行任何计算。即使是 const 限定的变量也可以改变（通过删除 const 限定符并改变值）。

```
const int x = 5;
*(int *)&x = 3; 
```

我认为 C99 允许您仅在函数范围内使用 const 限定变量进行初始化，文件范围变量仍受相同限制的约束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T23:57:33.027

这可以用另一个保护变量来解决：

```
void SomeFunction(...)
{
    static int initialized_y=0;
    volatile static int y;
    if(initialized_y==0)
       y = x;
    initialized_y=1;
    ...
} 
```

你也可以把这个成语变成一个宏。

# html - 如何垂直对齐 span 标签内的内容？

> ID：732337
> 
> 赞同：164
> 
> 时间：2009-04-08T23:57:59.313
> 
> 标签：html, css

如何让“x”在跨度中间垂直对齐？

```
.foo {
    height: 50px;
    border: solid black 1px;
    display: inline-block;
    vertical-align: middle;
}

<span class="foo">
   x
</span> 
```

* * *

## 回答 #1

> 赞同：239
> 
> 时间：2009-04-09T02:10:53.923

使用`line-height:50px;`而不是高度。这应该够了吧 ;）

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2013-03-05T12:30:37.240

请注意，`line-height`如果您在其中有一个很长的句子`span`会因为没有足够的空间而中断行，则该方法会失败。在这种情况下，您将有两条线与属性中指定的 N 个像素的高度有间隙。

当我想在右侧显示具有垂直居中文本的图像时，我坚持使用它，这适用于响应式 Web 应用程序。作为基础，我使用 Eric Nickus 和 Felipe Tadeo 建议的方法。

如果你想达到：

[![桌面](https://i.stack.imgur.com/UUVhK.png)](https://i.stack.imgur.com/UUVhK.png)

和这个：

[![移动的](https://i.stack.imgur.com/ttNcE.png)](https://i.stack.imgur.com/ttNcE.png)

```
.container {
    background: url( "https://i.imgur.com/tAlPtC4.jpg" ) no-repeat;
    display: inline-block;
    background-size: 40px 40px; /* image's size */
    height: 40px; /* image's height */
    padding-left: 50px; /* image's width plus 10 px (margin between text and image) */
}

.container span {
    height: 40px; /* image's height */
    display: table-cell;
    vertical-align: middle;
}
```

```
<span class="container">
    <span>This is a centered sentence next to an image</span>
</span>
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2013-10-01T02:13:39.183

如果您需要多行，这是最简单的方法。`span`将您的文本包装在另一个中`span`，并使用`line-height`. 多行的诀窍是重置内部`span`的`line-height`.

```
<span class="textvalignmiddle"><span>YOUR TEXT HERE</span></span> 
```

```
.textvalignmiddle {
    line-height: /*set height*/;
}

.textvalignmiddle > span {
    display: inline-block;
    vertical-align: middle;
    line-height: 1em; /*set line height back to normal*/
} 
```

[演示](http://jsfiddle.net/QAwpm/1/)

当然，外部`span`可以是 a`div`或 whathaveyou

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2018-07-11T15:58:37.157

弹性盒方式：

```
.foo {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 50px;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-10-16T04:39:24.327

我需要这个链接，所以我用一个标签和一个 div 包裹了跨度，然后将跨度标签本身居中

HTML

```
<div>
    <a class="tester" href="#">
        <span>Home</span>
    </a>
</div> 
```

CSS

```
.tester{
    display: inline-block;
    width: 9em;
    height: 3em;
    text-align: center;
}
.tester>span{
    position: relative;
    top: 25%;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-12-04T11:19:13.060

**CSS垂直居中图片和文字**

我为垂直图像中心和文本创建了一个演示，我也在 firefox、chrome、safari、internet explorer 9 和 8 上进行了测试。

它非常简短易懂的 css 和 html，请检查下面的代码，您可以在 screenshort 上找到输出。

**HTML**

```
<div class="frame">
    <img src="capabilities_icon1.png" alt="" />
</div> 
```

**CSS**

```
 .frame {
        height: 160px;      
        width: 160px;
        border: 1px solid red;
        white-space: nowrap;
        text-align: center; margin: 1em 0;
    }

    .frame::before {
        display: inline-block;
        height: 100%;
        vertical-align: middle;
        content:"";
    }

    img {
        background: #3A6F9A;
        vertical-align: middle;
    } 
```

**输出** [在此处输入图像描述](http://i.stack.imgur.com/KFquE.jpg)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-30T22:50:32.807

这对我有用（Keltex 也这么说）

```
.foo {
height: 50px;
...
}
.foo span{
vertical-align: middle; 
}

<span class="foo"> <span>middle!</span></span> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-09T00:09:05.637

不幸的是，垂直对齐 css 属性没有达到您的预期。[本文](http://phrogz.net/CSS/vertical-align/index.html)介绍了两种使用 css 垂直对齐元素的方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-09T09:16:43.743

将 padding-top 设置为适当的值以将 x 向下推，然后从高度中减去 padding-top 的值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-09T16:07:33.783

如果您将元素封装在灵活的容器中（例如：display：flex），请提供替代方案：

```
align-self: center; 
```

[更多信息](https://www.w3schools.com/cssref/css3_pr_align-self.asp)

# javascript - “在页面中查找”操作的 JavaScript 事件？

> ID：732340
> 
> 赞同：0
> 
> 时间：2009-04-09T00:00:01.867
> 
> 标签：javascript

我知道如何监听击键 CTRL+F，提醒我用户可能要求在他们的浏览器中调出“在页面中查找”搜索选项。

当用户使用浏览器菜单项提出“在页面中查找”搜索选项时，有没有办法监听？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T00:03:07.007

这不是正常 JavaScript 实现的一部分。JS 存在于沙箱中，这意味着它完全不知道 DOM 范围之外的任何内容，除非浏览器选择为其提供一些信息。打开查找对话框/栏不是其中之一。

朝这个方向发展将开始跨越隐私与侵入性的界限。如果网页可以知道您在浏览器中所做的事情，那么就会引发大量问题。

但是，您可以知道网页是否失去焦点，这*包括*（当然还有许多其他事情）启动“查找”。对于一个愚蠢的简单示例，将其放在页面底部，在`</body>`. （您可以通过在 onload 后附加事件来更聪明地了解它）：

```
<script type="text/javascript">
document.onblur = handleBlur;

function handleBlur()
{
    //do something
}
</script> 
```

# c# - jQuery GridView 控件

> ID：732355
> 
> 赞同：13
> 
> 时间：2009-04-09T00:08:58.583
> 
> 标签：c#, asp.net, jquery, gridview

这样的事情存在吗？

我正在寻找的是一个将成为客户端的控件，具有 GridView 的编辑、取消行功能。

我希望用它从用户那里收集数据，然后在用户输入数据后保存在服务器上。

编辑：

感谢所有的建议。在我深入研究并花时间学习这些框架之前，我想问你们所有人一件事。

你们所有人似乎都在使用 ASP.net MVC，并提到这些工具包很好用。然而，我正在使用 ASP.net 网络表单。这些框架能很好地适应旧的 ASP.net 风格吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-09T01:09:52.043

**客户端框架**

除了 jqGrid，我最近还在玩其他几个 javascript 框架 Grids：

1.  [Flexigrid](http://www.flexigrid.info/)：基于 jQuery，尚无编辑功能，但已计划。

2.  [Ext 的 GridPanel](http://www.extjs.com/deploy/dev/docs/)：Ext js 是另一个与 jQuery 交互的 javascript 框架。

3.  [YUI 的 DataTable](http://developer.yahoo.com/yui/datatable/)：Yahoo 用户界面 (YUI) 是另一个具有可编辑网格控件的框架。

这些都是客户端组件：它们在用户的浏览器中运行，与您的服务器代码断开连接。就像 Tracker1 和其他几个人所写的那样，您必须自己编写 Ajax 方法来将客户端网格连接到服务器，或者您可以尝试利用现有的包装器，例如：

**服务器端选项**

1.  [Coolite 用于 .NET 的 Ext 包装器](http://www.coolite.com/)

2.  正在进行中的 YUI .NET 包装库之一（YuiDotNet 或 Yui.NET）。我认为其中任何一个都没有实现 DataTable 的包装器，但它们可能会向您展示这样做的方法。

**连接客户端和服务器**

如果您没有使用过很多 Ajax 或对这些 javascript 框架做过很多工作，请为学习曲线做好准备：当您开始使用它们时，您需要时刻牢记服务器上发生的事情以及客户端发生了什么（以及何时！）。

如果您使用我上面列出的直接 javascript 库之一，而不是 .NET 包装器，您必须编写一个服务器端方法来处理数据提交并使用您选择的技术将其公开给客户端（MVC 的 JsonResult控制器动作，建立 WebMethods / ScriptMethods 等）。

**相关堆栈溢出问题**

[在 ASP.NET 中使用 ExtJS](https://stackoverflow.com/questions/205720/using-extjs-in-asp-net)以及[从 ASP.net 将数据返回到 ExtJS Grid](https://stackoverflow.com/questions/221273/returning-data-from-asp-net-to-an-extjs-grid) - 这些都集中在 Ext 的控件上，但答案包含很多关于将新一代 javascript 框架控件连接到服务器应用程序的一般信息。

[良好的 Asp.Net 类似 excel 的网格控件](https://stackoverflow.com/questions/587120/good-asp-net-excel-like-grid-control)- 您可能也对这个问题的答案感兴趣，特别是因为听起来您需要可靠的编辑功能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-09T00:21:42.330

是的。[jqGrid](http://www.trirand.com/blog/)运行良好。尝试[演示](http://trirand.com/jqgrid/jqgrid.html)。我们将它与 ASP.NET MVC 一起使用。

**更新：**在您更新的问题中，您询问了如何将 jQuery 等框架与 WebForms 结合使用。你能做这个吗？当然。你愿意吗？这是一个更难的问题。在 WebForms 中，您*通常*让 WebForms 为您生成 JavaScript。这就是为什么你有 UpdatePanel 之类的。一方面，这很容易，因为您可以将编码注意力集中在 C# 上，并且您可以使用不需要编写任何 JavaScript 的网格组件来使它们工作。另一方面，您受限于生成的代码可以做什么。是的，您可以手动编写 JavaScript，甚至在 WebForms 中，但您必须解决框架所做的一些事情，例如更改控件上的 ID。是的，您可以在 C# 中编写事件处理程序，但这需要使用回发，这不适合 HTTP，其后果对最终用户是可见的。

在很大程度上将 jQuery 与 ASP.NET MVC 一起使用是很常见的，因为它随框架一起提供。但即使在此之前，将两者结合使用仍然很常见，因为 jQuery 可以很容易地完成 ASP.NET MVC 中不直接支持的事情，例如使页面上的控件相互交互。是的，这意味着您必须编写 JavaScript，但只要您对此感到满意，您就会获得巨大的优势，即您可以编写任何类型的交互，而无需回发到服务器。

如果您只是在为 WebForms 寻找一个好的网格控件，那么我建议使用为 WebForms 设计的控件，而不是为 jQuery 设计的网格。原因是您将编写的代码将更自然地适合 WebForms 的习惯用法。

如果您只是想学习 jQuery，那么，这是一个非常好的主意，因为该框架很有趣、有用且设计良好，但我不确定一个好的控件是否是最好的起点。一个更好的起点可能是为您现有的一些页面添加视觉风格。从已知的 HTML 开始并使用 jQuery 操作它比同时生成新的 HTML 和学习 jQuery 更容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-28T10:58:48.050

我目前使用[DataTables](http://www.datatables.net)。这允许您创建一个 html 表并为多列、多列排序、分页等应用过滤器。您可以选择在客户端处理 html 表或从 AJAX 源接收数据。

它还有一个用于动态添加行、动态显示列和分组的 API。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T00:20:29.103

[jQuery 网格视图插件](http://plugins.jquery.com/project/jqGridView)怎么样？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T00:56:34.133

根据您的评论（关于 Craig 提到 jqGrid），您要么想要使用 jqGrid、FlexiGrid 或其他客户端替代方案，然后自己将其连接到服务器端，要么使用非基于 jquery 的商业 ajax 网格组件。

如果您使用 MVC（如 Craig Mentions），jqGrid 非常适合。将 jqGrid 事件连接到 MVC 中的 JsonResult 控制器操作相当容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T02:11:43.417

这是一个使用 WebForms 完成的示例：

[http://praveen1305.blogspot.com/2009/05/jqgrid-with-asp-net-web-forms.html](http://praveen1305.blogspot.com/2009/05/jqgrid-with-asp-net-web-forms.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-30T02:43:21.897

我在[http://arahuman.blogspot.com/2009/06/jqgrid-using-mvc-json-and-datatable.html找到了一个使用 DataTable 和 JQgrid 的示例](http://arahuman.blogspot.com/2009/06/jqgrid-using-mvc-json-and-datatable.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-28T21:21:22.560

您可以试用我的免费[WebGrid DataGrid](http://www.webgrid.com)，它使用 JQuery 并且是 JQuery ThemeRoller-Ready

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-14T21:21:15.417

jsGrid 是一个轻量级的 GridView jQuery 插件[js-grid.com](http://js-grid.com)

它非常可定制，可以与任何数据源一起使用。

# html - 如果操作字段在 有参数吗？

> ID：732371
> 
> 赞同：41
> 
> 时间：2009-04-09T00:17:24.167
> 
> 标签：html, forms, query-string

如果我在 HTML 中做这样的事情，我是否可以期待得到良好支持的常见行为：

```
<form method="get" action="/somePage.html?param1=foo&param2=foo">
  <input name="param2"></input>
  <input name="param3"></input>
</form> 
```

似乎这种事情本质上是荒谬的，但我已经看到它在这里和那里使用，我想知道地球上的预期行为应该是什么。浏览器是否足够聪明，可以将“¶m2=whatever¶m3=whatever”添加到操作中，还是它们只是输入第二个问号？要不然是啥？在某些情况下，这实际上是正确的做事方式吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-04-09T00:26:43.830

如果方法属性设置为 GET，则浏览器会在构造表单参数值之前从操作属性中删除查询字符串参数。

因此，在您的示例中，提交时对服务器的请求将如下所示：`/somePage.html?param2=value&param3=value`

所以不，当方法是“GET”时，就像你的例子一样，没有理由这样做。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-09T00:46:59.133

不确定，但我认为将这些变量放在隐藏的输入字段中是更好的做法。这样，您的发布方法是 POST 还是 GET 都没有关系。

```
<form method="get" action="/somePage.html">
  <input name="param2"></input>
  <input name="param3"></input>
  <input type="hidden" name="param1" value="foo" />
  <input type="hidden" name="param2" value="foo" />
</form> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T01:46:11.253

您可以在发布表单之前使用脚本将表单中的方法属性更改为“POST”，因此在操作中可能会用到查询字符串。不过，这似乎不是任何事情的最佳解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T01:48:01.670

好吧，除了最后一个问题，所有问题都已回答，答案是肯定的。对于`POST`，这是允许的，但您很可能会发现它不起作用的情况。我见过只允许 postdata*或*querystring 的 web 服务器，所以它不可靠。

# java - 关于 Java 中的 HotSpot 优化

> ID：732372
> 
> 赞同：0
> 
> 时间：2009-04-09T00:18:01.247
> 
> 标签：java, optimization, loading, space, jvm-hotspot

我在 Java 中做了一些 HotSpot 优化。但是，我现在担心与加载类有关的空间（即，类中只需要一个方法，不想加载其他方法）。我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T00:36:41.000

你做了哪些HotSpot优化？定义类时是否重写字节码？

Java 允许两个级别的加载：未解析和已解析。后者的意思是“在此类引用的任何类中加载/链接”，其中包括由任何字段或方法签名引用的所有类以及静态初始化程序所需的任何类。无法加载类的一部分。如果您只需要某个类中的一个方法，为什么不将该方法扔到另一个类中呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T00:29:27.957

据我所知，加载一个类是一个全有或全无的命题。你不能通过方法来挑选。

您真正想在这里解决什么问题？如果你有记忆问题，这不应该是你的第一个想法。

# .net - 如何在 ContextMenu 和 ToolStripMenuItem 之间共享 MenuItem？

> ID：732390
> 
> 赞同：1
> 
> 时间：2009-04-09T00:29:55.353
> 
> 标签：.net, vb.net, winforms, contextmenu

我有一个附加到面板的上下文菜单，它应该反映工具栏菜单中可用的命令。

目前在我的`MouseUp`事件中，我设置`enabled`了 s 的状态`MenuItem`，并将它们添加到上下文菜单中：

```
 ctxMnuLinks.Items.Clear()
    ctxMnuLinks.Items.Add(mnuLinksOpen)
    ctxMnuLinks.Items.Add(New ToolStripSeparator)
    ctxMnuLinks.Items.Add(mnuLinksAdd)
    ctxMnuLinks.Items.Add(mnuLinksEdit)
    ctxMnuLinks.Items.Add(New ToolStripSeparator)
    ... 
```

..但这会从工具栏菜单中删除项目！所以很明显我不能使用同一个对象。我想避免重复菜单，这会让我有两套菜单项需要维护。

实现这一目标的正确方法是什么？我正在寻找“*最佳实践*”的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T00:56:19.780

我认为您不能在工具条和上下文菜单中拥有相同的对象，但它们都可以在其 OnClick 事件中调用相同的函数。

# vb.net - 存储和调用事件 (VB.NET .NET 2.0)

> ID：732393
> 
> 赞同：1
> 
> 时间：2009-04-09T00:31:51.057
> 
> 标签：vb.net, events, delegates

我认为知道如何在 C# 中执行此操作，但我在 VB.NET 中遇到语法问题，因为我需要利用“句柄”事件的东西。

我有不同的事件，我以某种方式（可能委托）需要存储在属性的属性中（我只是将属性添加到链接到相应事件的属性）。

例如

```
<BindEvent(EventThing)>_
Public ReadOnly Property IsTrue() As Boolean
  Get
    Return True
  End Get
End Property 
```

它们需要是事件，以便其他程序员可以在方法上使用 VB.NET 句柄关键字。

```
Public Delegate Sub TestEvent(ByVal sender As Object, ByVal e As Object)
Public Event E As TestEvent

Public Sub Test() Handles E
End Sub 
```

这些属性已经引发了我正在捕捉的一般事件，确定相关属性并因此获取相关属性（和委托/事件）。然后我想提出相关的事件。

如果我只使用与特定事件相关联的委托，它不会引发其他处理程序吗？

如果可能的话，我还想避免为每个仅在事件类型上使用 Raise Event 的属性编写一个 sub，因为这似乎是多余的。

例如避免：

```
Public Event E As TestEvent
Public Sub CallE(ByVal sender As Object, ByVal e As Object)
  RaiseEvent E(sender, e)
End Sub
<BindDelegate(DelegateToCallE)>_
Public ReadOnly Property IsTrue() As Boolean
  Get
    Return True
  End Get
End Property 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T14:55:34.737

```
Public Class foo

    Public Event TestEvent()

End Class

Public Class bar
    Dim WithEvents x As New foo
    Public Sub HandleEvent() Handles x.TestEvent
    End Sub
End Class 
```

这是你想要的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:09:32.413

我不太明白你想做什么。您是否有机会寻找这样的语法：

```
Class BindEventAttribute
    Inherits System.Attribute

    Public Delegate Sub TestEvent()
    Public Custom Event EventToRaise As TestEvent
       AddHandler(ByVal value As TestEvent)
          REM TODO: code what happens when anyone calls AddHandler on this event
       End AddHandler

       RemoveHandler(ByVal value As TestEvent)
          REM TODO: code what happens when enyone calls RemoveHandler on this event
       End RemoveHandler

       RaiseEvent()
          REM TODO: code what happens when anyone calls RaiseEvent on this event
       End RaiseEvent
    End Event
End Class 
```

# sql - 餐桌设计

> ID：732400
> 
> 赞同：1
> 
> 时间：2009-04-09T00:37:22.137
> 
> 标签：sql, sql-server, tsql, normalization, denormalization

我想知道这是一个好的设计，假设表格如下

```
ADDRESS(id, address, city_fk, stateFK, countryFK),
CITY(id, name, stateFK, countryFK),
STATE(id, name, countryFK),
COUNTRY(id, name) 
```

请注意国家 fk 如何在 3 个表格中重复？并在 2 个表中重复状态 fk？谁能告诉我这是不是一个好的设计？如果是这样，为什么？因为我不认为有必要经常重复它。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T00:51:13.523

你想要更像这样的东西：

*   地址（id，地址，city_fk）
*   城市（id，名称，state_fk）
*   状态（id，名称，country_fk）
*   国家（身份证，姓名）

如果是我，我会稍微重命名这些字段：

*   地址（id，地址，city_id）
*   城市（id，城市，state_id）
*   STATE(id, state, country_id)
*   国家（身份证，国家）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T00:43:07.240

我不确定我会沿着这条路走下去。我可以理解有一个国家表，当然还有一个州表，但是一个城市表可以确保该城市属于所讨论的特定国家/州。我只是想像您的 City FK 表中所需的数据量将是巨大的，我不确定我是否看到了好处。也许如果你能详细说明你希望从拥有一张城市表中获得什么好处，我可能会更好地回答这个问题。我见过的大多数系统都有 Country 和 State 的 FK 表，但这些表不一定相互关联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T01:02:28.580

我想我的问题是“好的设计是为了什么？” 如果地址的精确完整性对您的设计绝对至关重要，那么这可能是富有成果的讨论的开始。另一方面，如果目的是收集地址并能够以您可能希望从真实用户那里获得的所有种类存储它们，您可能会考虑一些更灵活的东西：即更少的表和更多的可选字段和UI 中有一套很好的友好验证规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T00:51:57.310

我会这样做：

*   国家（国家 ID，国家名称）
*   州（stateID，stateName，countryID（FK））
*   City(cityID, cityName, stateID(FK)) <- 你把这个国家和那个 FK
*   地址(addressID, adressDescription, cityID) <- 这里的概念相同。

现在告诉我，在不同的城市、州和国家拥有相同地址的几率是多少？最小。所以这应该有效。请记住，将数据库标准化到极端并不总是有效或有帮助。

希望这可以帮助

此致！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T00:53:12.567

取决于您如何在所有表上定义 PrimaryKey。如果您将`id`列作为所有表的键，则可以减少所有表中的列，以便它们将 FK 保留到下一个区域。

*   `address`（给定）
*   `city` 通过地址.city_fk
*   `state`通过 city.state_fk
*   `country`通过 state.country_fk 国家

设计就像克里斯的。如果您需要一个查询中的所有数据，则可以进行联接。

但是，如果`id`不是键而是所有表中的部分键（不能单独定义数据集），那么我会认为这是一个很好的设计。然后将像这样识别地址：

*   国家 8（法国）
*   状态 3（巴黎地区）
*   城市 23（巴黎）
*   地址 1（为该城市存储的第一个地址）

仅仅知道“City 23”是不够的，因为接下来会出现问题：第 23 个城市在哪个州，哪个州在哪个国家 - 这将导致您将数据存储在所有表中。

但这实际上取决于您如何定义密钥。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T00:59:31.270

考虑一下：如果我知道国家，而国家 FK 是国家，我就可以传递地知道国家，再次包含它是一种多余的非规范化。

如果我知道城市，而城市 FK 是状态，那么我就可以传递地知道状态，并且再次包含它是一种多余的非规范化。

所以，如果我了解这座城市，我就了解这个州，我就了解这个国家。

ADDRESS(id, address, city_fk), CITY(id, name, stateFK), STATE(id, name, countryFK), COUNTRY(id, name)

在实践中，将城市作为实体或属性存在合理的论据。对于诸如邮寄地址之类的东西，将其作为属性可能更简单。

对于像“选民档案”（用于竞选和政治活动的数据库）之类的东西，将城市变成一个实体可能是有意义的。这在美国弗吉尼亚州尤为重要，这在美国是独一无二的，因为注册城市是独立的政治管辖区，与美国其他地区不同，在管辖权上，大多数城市都是县的一部分。

即使在弗吉尼亚州以外的州，由于属于县的城市有单独的选举（市长和议会），在政治数据库中，使城市（变得更小，选区和辖区以及乡镇和村庄，并变得更大）是有用的、县和 HD 以及 SD 和 CD）合并为实体。

现在以美国俄亥俄州的莱克伍德为例。在管辖范围内，莱克伍德是凯霍加县。在政治电视广告方面，它是克利夫兰-阿克伦-坎顿电视指定市场区的一部分。它位于克利夫兰市外，该市也是凯霍加县管辖的一部分。莱克伍德分为四个议会选区，每个选区又分为十五个或更多选区。它是州议会第 13 区的一部分，其中包括莱克伍德和克利夫兰市西侧的一部分。它是州参议院第 23 区的一部分，其中包括布鲁克林、布鲁克帕克、克利夫兰（7-21 区和 14 区的一部分）、莱克伍德、林代尔、米德尔堡高地、帕尔马和帕尔马高地。莱克伍德位于俄亥俄州第 10 届美国国会选区（由 Dennis Kucinich 代表）。

现在，对于任何给定的俄亥俄州选民，我们如何在数据库中表示当他投票时谁将在他的选票上？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T01:16:07.083

我一直对表格设计做的是查看它并找出我会遇到什么样的麻烦（即会产生什么不一致）。

在您的特定情况下，显而易见的是您可以创建一个位于怀俄明州和达拉斯市的地址，该市处于衰败状态，哎呀，我的意思是德克萨斯州:-)

同样，您的地址可能位于澳大利亚国家*和*德克萨斯州（美国）*以及*南美洲秘鲁的 Xolotllotl ^(a市。)当邮递员追踪您时，我不想向他解释您的架构。

你如何解决这个问题？您可能应该只从地址引用城市，然后从城市引用州，然后从州引用国家。

但是地址是一种棘手的野兽，它们采取的形式在很大程度上取决于它们所在的位置。有些有县，有些城市跨越州界等等。

除非您迫切需要在特定城市寻找人，否则我会将其合并到一个自由格式的地址中（大多数地方都有某种邮政编码，这是一个更好的选择）。您可能希望按州或国家/地区进行选择，在这种情况下，将它们保留为单独的字段。

我的第一次尝试是：

```
ADDRESS(id, address_including_city, stateFK),
STATE(id, name, countryFK),
COUNTRY(id, name) 
```

您必须区分不同国家/地区的“相同”州（例如，华盛顿和西澳大利亚都是西澳），但您可以轻松地在数据输入屏幕中显示该国家/地区，以便操作员知道他们正在进入哪个州（或更可能，他们将首先选择国家，而国家的选择将被削减）。

* * *

据我所知，Xolotllotl 并不是一座真正的城市，它只是我编造的一个听起来像那些古老的印加人美丽名字的城市**^。**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T01:31:55.327

您是否规范化得太远了？

当您降低重复数据的成本时，您可能会通过需要 3 或 4 个连接来获得整个地址来否定它......

我个人会坚持：

地址：

*   ID
*   街道地址（例如 123 Joe Street）
*   城市
*   状态
*   邮政编码 (ZIP)
*   国家（例如美国或澳大利亚）

当然，您必须对诸如城市/州/邮政编码/国家之类的事物进行索引，但这可能比加入多个表要快得多。

（注意：我不是 DBA，所以我不能支持我的声明，但这是我使用的，它工作正常）

# python - Django 模型：从当前登录的用户返回用户名

> ID：732405
> 
> 赞同：0
> 
> 时间：2009-04-09T00:39:06.250
> 
> 标签：python, django, django-models, django-admin

我正在开发一个用于托管媒体（特别是音频和图像）的 Django 应用程序。我的模型中有单独的图像画廊和照片，并将它们与 a 链接`ForeignKey`（不确定这是否正确，但仍在学习）。我需要的是专辑类`__unicode__`返回专辑所有者的用户名。

```
class Album(models.Model):
    artist = models.ForeignKey(User, unique=True, related_name='artpunk')

    def __unicode__(self):
        return self.artist.username 
```

我知道 username 属性存在，并通过插入 a`dir()`并检查控制台输出来确认它。问题是当我进入管理面板的图像部分时，它只是显示“无法识别的命令”。模型不能`User`访问属性吗？还是我做错了什么？

编辑：忘了提，使用 Python 2.6 和 Django 1.0.2。如上所述，错误的确切文本只是粗体的“无法识别的命令”，我已经运行`syncdb`没有问题。但是，我`syncdb`今天早上重新运行（没有输出）只是为了再试一次，现在它似乎工作正常。

通过更改以下内容可以重现：

```
 def __unicode__(self):
        return self.artist.username 
```

对于这样的事情：

```
 def __unicode__(self):
        return self.artist.username+'\'s Gallery' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T03:36:27.430

从模型访问用户（即使作为外键）应该没有问题。我刚刚自己测试完，似乎没有任何显着差异。

```
def __unicode__(self):
    return self.user.username 
```

附带说明一下，您还应该能够返回 self.artist，因为我相信`User.__unicode__()`无论如何都会返回用户名。

错误的具体细节是什么？您使用的是什么版本的 Django/Python？您是否对尚未反映在数据库中的模型进行了更改？有时我注意到你只需要重新启动测试服务器就可以正常工作。特别是在管理员中。

作为对您的编辑的回应，请尝试将用户名转换为字符串：

```
str(self.user.username) 
```

# c# - Asp.Net DataList 绑定 ImageUrls 数组

> ID：732406
> 
> 赞同：2
> 
> 时间：2009-04-09T00:39:15.393
> 
> 标签：c#, asp.net, arrays, bind, datalist

我正在尝试使用数据列表制作缩略图网格。我有一个 imageurl 数组，我想将它们绑定到后面的代码中。我该怎么做呢？我希望数据列表的最大列大小为 5，并添加缩略图行直到完成。

```
<asp:DataList ID="dlImages" runat="server" 
          RepeatColumns="5" 
          RepeatDirection="Horizontal" 
          RepeatLayout="Flow">

   <ItemTemplate>
      <asp:Image ID="imgStore" runat="server" />
   </ItemTemplate>

</asp:DataList> 
```

代码隐藏：

```
protected void BindImages(string[] imageurls)
{
    for (int i = 0; i < imageurls.Length; i++)
    {
        .
        .
        .
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T00:45:34.830

我想这会为你做的

```
<asp:DataList ID="dlImages" runat="server" 
      RepeatColumns="5" 
      RepeatDirection="Horizontal" 
      RepeatLayout="Flow">

<ItemTemplate>
   <img src="<%# (string)Container.DataItem %>" />
</ItemTemplate>

</asp:DataList> 
```

背后的代码

```
protected void BindImages(string[] imageurls)
{
    dlImages.DataSource = imageurls; 
    dlImages.DataBind();
} 
```

你也可以做

```
<asp:Image runat="server" id="imgStore" 
     ImageUrl="<%# (string)Container.DataItem %>" /> 
```

但有时服务器控件不喜欢其中的渲染块。

# cocos2d-iphone - 将文本字段中的文本从一个场景更新到另一个场景

> ID：732410
> 
> 赞同：0
> 
> 时间：2009-04-09T00:43:10.343
> 
> 标签：cocos2d-iphone, textfield

我在将数据（文本字段文本）从一个场景放置到另一个场景时遇到问题。我在这封邮件中附上了我的源代码。如果我的代码有任何问题，请帮助我。

```
//
//  PlayerSettingsAppDelegate.m
//  PlayerSettings
//
// 
//

#import "PlayerSettingsAppDelegate.h"
#import "TestScene.h"

NSString *result;

@implementation MYSCENE
-(id) init
{
      [super init];

        id layer = [ColorLayer layerWithColor: 0x2266FFff];
        [self add:layer z:0];
        [MenuItemFont setFontSize:15];
        [MenuItemFont setFontName:@"Helvetica"];
        MenuItem *backMenu = [MenuItemFont itemFromString:@"Back" target:self selector:@selector(menuBack:)]
;
        Menu *menu = [Menu menuWithItems:backMenu,nil];

        [menu alignItemsVertically];
        [self add:menu];

    /*Text field creation*/
    myTextField = [[UITextField alloc]initWithFrame:CGRectMake(60, 165, 100, 10)];
    myTextField.placeholder=@"<Enter text>";
    [myTextField setDelegate:self];
    [window addSubview:myTextField];

    return self;
}

-(void)menuBack:(id)sender{
    NSLog(@"Back");
    TestScene *ts = [TestScene node];
    [[Director sharedDirector]replaceScene:ts];
}

-(BOOL)textFieldShouldReturn:(UITextField *)textField {
    [textField resignFirstResponder];
    return YES;
}

-(void)textFieldDidEndEditing:(UITextField *)textField{
    if(textField==myTextField){
        [myTextField endEditing:YES];

        result = myTextField.text;
        [label setString:result];
        [myTextField removeFromSuperview];
    }
}

-(void) dealloc
{
    [super dealloc];
}
@end

@implementation MenuLayer

-(id)init {
    self = [super init];

    return self;
}

@end

@implementation PlayerSettingsAppDelegate

- (void)applicationDidFinishLaunching:(UIApplication *)application
{
    // NEW: Init the window
    window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    [window setUserInteractionEnabled:YES];
    //[window setMultipleTouchEnabled:YES];

    //[[Director sharedDirector] setLandscape: YES];
    [[Director sharedDirector] setDisplayFPS:YES];

    [[Director sharedDirector] attachInWindow:window];

    Scene *scene = [Scene node];
    [scene add: [MYSCENE node]];

    [window makeKeyAndVisible];

    [[Director sharedDirector] runWithScene: scene];

}

-(void)dealloc
{
    [super dealloc];
}
-(void) applicationWillResignActive:(UIApplication *)application
{
    [[Director sharedDirector] pause];
}
-(void) applicationDidBecomeActive:(UIApplication *)application
{
    [[Director sharedDirector] resume];
}
- (void)applicationDidReceiveMemoryWarning:(UIApplication *)application
{
    [[TextureMgr sharedTextureMgr] removeAllTextures];
}

@end

-------------------------------------------------------------------------
//
//  TestScene.m
//  PlayerSettings
//
// 
//

#import "TestScene.h"
#import "cocos2d.h"
#import "PlayerSettingsAppDelegate.h"

UITextField *levelEntryTextField;

@implementation TestScene
-(id)init{
    [super init];
    Sprite *bg = [Sprite spriteWithFile:@"image1.jpg"];
    [bg setPosition:cpv(160,240)];
    [self add:bg z:0];

    label = [Label labelWithString:@"result" fontName:@"Helvetica" fontSize:20.0];
    label.position = cpv(100,100);
    [self add:label z:1];

    return self;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T23:59:39.907

不完全确定，但我相信

```
label = [Label labelWithString:@"result" fontName:@"Helvetica" fontSize:20.0]; 
```

应该读

```
label = [Label labelWithString:result fontName:@"Helvetica" fontSize:20.0]; 
```

# .net - Webservice 或 WCF 或什么

> ID：732417
> 
> 赞同：0
> 
> 时间：2009-04-09T00:47:42.127
> 
> 标签：.net, wcf, web-services

我有一个用户通过电话（按键）或短信访问的应用程序。现在想给他们网络访问权限。认为通过 TCP 与应用程序通信的 Web 服务会做到这一点。

在应用程序中正常工作的 TCPClient 连接代码在 Web 服务中失败，并显示“主机主动拒绝连接”

让我觉得 IIS 不允许 Web 服务直接进入本地网络。但我只是猜测。

所以...... DotNet 对此的回答是什么。

1) 需要调整的 IIS 设置、配置文件等。

2）忘记Webservice并使用我一无所知的WCF。

3) 别的东西。

谢谢鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T01:02:50.203

在不太了解您的设置的情况下，我会说这是网络权限问题。

.Net 网络服务只是作为应用程序在机器上的帐户下运行。如果该帐户由于某种原因没有建立 TCP 连接的权限，它将以这种方式失败。

检查您的 Web 服务正在运行的帐户，并确保它具有建立连接的权限。

# c# - WorkflowMarkupSerializer 不在状态机工作流中保留位置

> ID：732425
> 
> 赞同：0
> 
> 时间：2009-04-09T00:50:49.687
> 
> 标签：c#, .net, workflow

我正在使用 WorkflowMarkupSerializer 来保存状态机工作流程 - 它可以保存状态，但不保留它们的位置。编写工作流的代码在这里：

```
 using (XmlWriter xmlWriter = XmlWriter.Create(fileName))
        {
            WorkflowMarkupSerializer markupSerializer
                = new WorkflowMarkupSerializer();
            markupSerializer.Serialize(xmlWriter, workflow);
        } 
```

读取工作流的代码是：

```
 DesignerSerializationManager dsm
            = new DesignerSerializationManager();
        using (dsm.CreateSession())
        {
            using (XmlReader xmlReader
                = XmlReader.Create(fileName))
            {
                //deserialize the workflow from the XmlReader
                WorkflowMarkupSerializer markupSerializer
                    = new WorkflowMarkupSerializer();
                workflow = markupSerializer.Deserialize(
                    dsm, xmlReader) as Activity;

                if (dsm.Errors.Count > 0)
                {
                    WorkflowMarkupSerializationException error
                        = dsm.Errors[0]
                          as WorkflowMarkupSerializationException;
                    throw error;
                }
            }
         } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-06T18:29:43.600

打开控制面板->“区域和语言选项”并将列表分隔符设置为“，”（逗号），工作流序列化程序将使用“，”（逗号）作为结构 SizeF 的 X、Y 坐标的分隔符

然后选择';' 并且工作流序列化程序将使用 ';' （分号）作为分隔符。

序列化程序使用区域设置来序列化标记，这真的很愚蠢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T01:55:15.647

哈，即使是 Visual Studio 2008 中托管的工作流设计器，也会随机丢失状态的位置。这告诉我这可能不是一件容易的事，并且是组成它的活动之外的信息。我会在主机周围挖掘更多信息；如果我发现了什么，我会回帖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T02:37:21.113

所有状态的位置都保存在一个单独的文件中。您需要使用工作流本身的标记来拖动它。幸运的是，它也只是 XML，因此您可以重用那里的大部分代码。如果没记错的话，我相信它只是 NameOfYourWorkflow.layout。

我同意 x0n - 设计师在 Visual Studio 中真的很糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T11:32:12.120

好的，[本教程](http://msdn.microsoft.com/en-us/library/aa480213.aspx)提供了有关如何执行此操作的很好信息 - 虽然到目前为止我只能*保存*布局，但我无法正确*使用*布局。有问题的信息大约下降了 2/3（或者只是搜索 .layout）

（如何结束自己的问题？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T13:55:36.667

请注意，在创建的 XML 的序列化或反序列化中存在一个错误（在示例中以 .layout 的扩展名命名。）

它生成以下 xml 作为文件的第一行：

```
<?xml version="1.0" encoding="utf-8"?><StateMachineWorkflowDesigner xmlns:ns0="clr-namespace:System.Drawing;Assembly=System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" Name="New" Location="30, 30" Size="519, 587" AutoSizeMargin="16, 24" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/workflow"> 
```

回读时，*size*属性会导致异常。我从文件中删除了 Size="519, 587" 并正确加载了工作流。现在，我编写文件，打开它并删除大小，然后关闭它。我需要考虑一个更优雅的解决方案，但至少我现在正在保存和恢复状态机工作流程。

# javascript - HTML 富文本框

> ID：732429
> 
> 赞同：4
> 
> 时间：2009-04-09T00:52:57.310
> 
> 标签：javascript, python, http, pylons, widget

我正在使用 Python 和 Pylons 编写一个网络应用程序。我需要一个丰富的文本框（即，提供加粗/下划线/添加项目符号..等的能力）。有人知道我可以使用的库或小部件吗？

它不必是特定于 Python/Pylons 的，因为它也可以是 Javascript 实现。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T00:59:43.737

有几个非常成熟的 JavaScript 实现与服务器框架无关：

*   [http://www.fckeditor.net/](http://www.fckeditor.net/)
*   [TinyMCE](http://tinymce.moxiecode.com/)
*   [大规模杀伤性武器](http://wmd-editor.com/)（由 SO 使用）

[关于免费 HTML 编辑器](http://en.wikipedia.org/wiki/Category:Free_HTML_editors)的维基百科文章有一个很好的概述，但请注意，并非所有内容都适用于应用程序嵌入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T01:02:24.243

ExtJS 的 HtmlEditor 是我发现的最好的（许可问题除外）：

[http://extjs.com/deploy/dev/docs/?class=Ext.form.HtmlEditor](http://extjs.com/deploy/dev/docs/?class=Ext.form.HtmlEditor)

ExtJS 有点重，但 HtmlEditor 是我发现的开箱即用的响应速度最快、外观最好的。值得通过 HTMLTidy 运行输出，其中有 Python 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T01:06:35.123

webkit-gtk 变得非常稳定，我相信现在有 python 绑定，所以从技术上讲你可以使用它（然后你的文本编辑器只需`<body contenteditable></body>`要这样做，你就完成了。不幸的是，我不确定它的绑定目前有多完整

# c# - 从 SQL 数据库加载双向链表

> ID：732436
> 
> 赞同：0
> 
> 时间：2009-04-09T00:58:53.597
> 
> 标签：c#, sql, linked-list

我有一个 QueueList 表：

```
{Id, Queue_Instance_ID, Parent_Queue_Instance_ID, Child_Queue_Instance_ID} 
```

什么是最有效的方法把它塞进一个`LinkedList<QueueList>`？你觉得我能低于`o(n^2)`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T03:24:31.907

O(n) 比 O(n^2) 好，对吧？;)

我假设父 ID 和子 ID 实际上是列表中的上一个和下一个 ID。

首先将这些项目放入字典中，以便您可以轻松地在`QueueInstanceId`. 在此循环中，您还可以找到第一项。然后，您只需将项目添加到链表并使用字典获取下一个项目。C# 中的示例：

```
Dictionary<int, QueueList> lookup = new Dictionary<int, QueueList>();
QueueList first = null;
foreach (QueueList item in source) {
    lookup.Add(item.QueueInstanceId, item);
    if (item.ParentQueueInstanceId == -1) {
        first = item;
    }
}
LinkedList<QueueList> list = new LinkedList<QueueList>();
do {
    list.AddLast(first);
} while (lookup.TryGetValue(first.ChildQueueInstanceId, out first)); 
```

向字典中添加项并通过key获取它们是O(1)的操作，每个循环都是源列表的长度，所以都是O(n)的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T03:19:44.647

稍微考虑一下，您可以在 O(n) 时间内完成，尽管这需要一些额外的东西，会增加一些开销。（仍然是 O(n)）。

您可以使用某种通用哈希方案，以便您可以构建一个好的哈希表。本质上，通过实例 id 散列。

- 取出每个队列，并将其放入某种双向链接的节点中。- 将每个节点插入哈希表。- 插入时，检查父项和/或子项是否在哈希表中并进行相应链接。_ 完成后，从头开始（您应该能够在第一遍中弄清楚），遍历列表并将其添加到您的 LinkedList 或仅使用生成的双向链表。

这需要 O(n) 一次，哈希表需要 O(n) 来初始化，插入是 O(1)。

留给您的问题是选择一个可以为您提供这些结果的良好哈希表实现。

此外，您必须考虑内存开销，因为我不知道您期望多少结果。希望足以留在记忆中。

我不知道也不认为有基于 SQL 查询的解决方案，但我的 SQL 知识非常有限。

希望这可以帮助！

# coldfusion - 任何好的 cfml 购物车应用程序？

> ID：732440
> 
> 赞同：2
> 
> 时间：2009-04-09T01:01:26.040
> 
> 标签：coldfusion, shopping-cart

任何好的 cfml 购物车应用程序？试过用一个吗？你有什么经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T07:25:57.053

[Arehart 的列表](http://www.carehart.org/cf411/#ecm)中列出的推车很少。没试过，所以不能给点建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T11:44:29.160

我以前使用过 QuillDesign 的[SiteSiector](http://www.quilldesign.com)，并尝试过其他一些。SiteDirector 是我见过的最好的。它很容易扩展，并且有很多开箱即用的功能。我建议你看看它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T00:18:21.810

到目前为止，我一直在使用 Cartweaver。这已经相当不错了。如果您将它与现有站点集成，则必须合并应用程序 cfm/cfc，这可能会有点麻烦。

Cartweaver 在其他方面写得很好。我希望在未来的版本中，他们会将整个购物车变成 cfc，但这对美元来说很有价值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T18:14:21.613

我的需求总是需要完全定制的应用程序；然而，这个包一直让我感兴趣：[http ://www.cfwebstore.com/](http://www.cfwebstore.com/)

1.  优惠的价格
2.  开源代码

祝你好运。

# asp.net - AutoMapper 问题

> ID：732446
> 
> 赞同：5
> 
> 时间：2009-04-09T01:04:50.213
> 
> 标签：asp.net, dto-mapping

试图自动映射一些对象。
源对象具有名称前带有 _ 的属性，而目标对象则没有。是否可以实现一个映射创建，该自动映射器会将所有 _properties 映射到
所有源类型的属性。

```
class MyMapper<TFrom, TTo>{
    TTo PerformMap(TFrom fromObject){
        Mapper.CreateMap<From, To>(); // ???
        TTo result = Mapper.Map<From, To>(fromObject);
        //result.Id.ShouldBe(value from TFrom._Id);
        return result;
    }
}

class From
{
    public int _Id { get; set; }
    public string _Name { get; set; }
}

class To
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-08-01T22:25:08.133

我最近添加到 AutoMapper 的内容可能会对您有所帮助 - 自定义命名约定。如果您检查后备箱 (R107)，请四处寻找 INamingConvention。现在，我有两个命名约定（PascalCase 和 lower_case_underscore），但实际上只是找出正确的 RegEx 来帮助您：

[INamingConvention.cs](https://github.com/AutoMapper/AutoMapper/blob/master/src/AutoMapper/INamingConvention.cs)

现在，命名约定是全局的和配置文件范围的。由于此功能是新功能，因此除了测试之外没有任何文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-17T17:42:36.950

我就是这样做的

```
Mapper.Initialize(cfg =>
        {
            cfg.RecognizeDestinationPrefixes(new []{"_"});
            cfg.RecognizePrefixes(new[] { "_" });

            cfg.CreateMap<To, From>().ReverseMap();
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T01:33:39.907

为此，您可以添加自定义映射来解决这种特殊情况：

```
Mapper.CreateMap<From, To>()
   .ForMember( dest => dest.Id, opt => opt.MapFrom( src => src._Id ) )
   .ForMember( dest => dest.Name, opt => opt.MapFrom( src => src._Name ) ); 
```

# asp.net - WebResource.axd 和 HTTP 标头

> ID：732448
> 
> 赞同：2
> 
> 时间：2009-04-09T01:05:39.867
> 
> 标签：asp.net, http-headers, webresource.axd

我们的站点刚刚从 .NET 1.1 迁移到 .NET 3.5，并在此过程中更新了我们的 3rd 方服务器控件。其中一个包使用通过 WebResource.axd 提供的 javascript。这些作为普通`<script src="" /`> 标签包含在内。

然而，观察流量，我发现这些 javascript 文件带有阻止客户端缓存的标头。我们正在谈论很多javascript。有问题的标题：

```
缓存控制：无缓存，无存储
杂注：无缓存
过期：-1

```

这些标头是否可以在 .NET 中的某个地方进行配置？我可以在不构建 HttpModule 的情况下拦截这些请求吗？这是我可以责怪控制供应商的事情吗？`<brandish weapon="blameGun" /`>

谢谢，

男爵

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T01:11:22.647

你可以试试：

```
HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.Public); 
```

此处记录了其他类型`HttpCacheability`：

[http://msdn.microsoft.com/en-us/library/system.web.httpcacheability.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpcacheability.aspx)

**编辑：**

您可以将其放入`Global.asax`文件而不是模块中：

```
void Application_AuthorizeRequest(object sender, EventArgs e)
{
    if (Request.Path.IndexOf("WebResource.axd") > -1)
    {
        Response.Cache.SetCacheability(HttpCacheability.Public);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T09:00:55.830

如果您的网站`<compilation debug="true">`在其 web.config 中使用 set 进行部署，则可能会发生这种情况。在这种情况下，缓存被禁用，以便更轻松地调试作为嵌入式资源的 JavaScript 文件。解决方案是简单地将编译标签的调试属性设置为 false。更多信息可以在[这篇](https://weblogs.asp.net/scottgu/442448)优秀的博客文章中找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T08:41:42.497

感谢您的回复。原来我们已经有了我不想写的HttpModule，这就是问题的根源。

# c - 比 fgets 更快地读取一行输入？

> ID：732463
> 
> 赞同：13
> 
> 时间：2009-04-09T01:24:33.927
> 
> 标签：c, optimization, file-io, stdin, fgets

我正在编写一个程序，其中性能非常重要，但并不重要。目前我正在`FILE*`逐行阅读文本，并`fgets`用于获取每一行。在使用了一些性能工具之后，我发现我的应用程序有 20% 到 30% 的时间在运行，它在`fgets`.

有没有更快的方法来获取一行文本？我的应用程序是单线程的，无意使用多个线程。输入可以来自标准输入或文件。提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-09T14:31:09.527

你没有说你在哪个平台上，但如果它是类 UNIX，那么你可能想尝试 read() 系统调用，它不会执行 fgets() 等人所做的额外缓冲层。这可能会稍微加快速度，另一方面它可能会减慢速度 - 找出答案的唯一方法是尝试并查看。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T14:26:48.040

1.  使用 fgets_unlocked()，但先仔细阅读它的作用

2.  使用 fgetc() 或 fgetc_unlocked() 而不是 fgets() 获取数据。使用 fgets()，您的数据被复制到内存中两次，首先由 C 运行时库从文件复制到内部缓冲区（流 I/O 被缓冲），然后从该内部缓冲区复制到程序中的数组

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T14:30:48.747

一口气将整个文件读入缓冲区。

处理该缓冲区中的行。

这是最快的解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T01:43:26.923

您可以尝试通过将大量数据读入 RAM 然后进行处理，从而最大限度地减少从磁盘读取的时间。从磁盘读取速度很慢，因此通过读取（理想情况下）整个文件一次，然后处理它来最大限度地减少您花费的时间。

类似于 CPU 缓存最小化 CPU 实际返回 RAM 的时间的方式，您可以使用 RAM 来最小化实际进入磁盘的次数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-09T01:28:20.767

如果数据来自磁盘，您可能会受到 IO 限制。

如果是这种情况，请获得更快的磁盘（但首先检查您是否充分利用了现有磁盘......某些 Linux 发行版没有优化开箱即用的磁盘访问（`hdparm`）），将数据暂存到提前内存（比如将其复制到 RAM 磁盘），或者准备等待。

* * *

如果您不受 IO 限制，则可能会浪费大量时间进行复制。您可以从所谓的零拷贝方法中受益。像内存这样的东西映射文件并且只能通过指针访问它。

这有点超出我的专业知识，所以你应该做一些阅读或等待更多知识渊博的帮助。

顺便说一句——你可能会投入比问题价值更多的工作；也许更快的机器会解决你所有的问题......

NB-- 尚不清楚您是否可以对标准输入进行内存映射...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-09T07:13:04.820

根据您的环境，使用 setvbuf() 来增加文件流使用的内部缓冲区的大小可能会也可能不会提高性能。

这是语法 -

```
setvbuf (InputFile, NULL, _IOFBF, BUFFER_SIZE); 
```

其中 InputFile 是刚刚使用 fopen() 打开的文件的 FILE*，而 BUFFER_SIZE 是缓冲区的大小（由此调用为您分配）。

您可以尝试各种缓冲区大小，看看是否有积极影响。请注意，这完全是可选的，您的运行时可能对这个调用完全没有任何作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-29T14:41:58.170

如果操作系统支持，你可以尝试异步文件读取，即在 CPU 忙于做其他事情的同时将文件读入内存。所以，代码是这样的：​​​​​

```
start asynchronous read
loop:
  wait for asynchronous read to complete
  if end of file goto exit
  start asynchronous read
  do stuff with data read from file
  goto loop
exit: 
```

如果您有多个 CPU，则一个 CPU 读取文件并将数据解析为行，另一个 CPU 获取每一行并处理它。

# java - 从 Groovy 控制台运行 JUnit 测试

> ID：732464
> 
> 赞同：1
> 
> 时间：2009-04-09T01:25:38.697
> 
> 标签：java, groovy, junit, groovy-console

如何使用[Groovy 控制台](http://groovy.codehaus.org/Groovy+Console)启动 junit 测试？

（目前使用 Groovy 1.6.0）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T10:37:45.340

我目前使用：

```
junit.textui.TestRunner.run(MyTest) 
```

（我的junit测试类在哪里`MyTest`）

我试过运行：

```
MyTest 
```

在 Groovy 控制台中，但这只是返回类实例。有没有更简单的方法？

# python - 跳过正则表达式模式中的 HTML 标记

> ID：732465
> 
> 赞同：0
> 
> 时间：2009-04-09T01:26:22.987
> 
> 标签：python, regex

我正在尝试编写一个正则表达式模式（在 python 中）来重新格式化这些模板引擎文件。

基本上该方案如下所示：

```
[$$price$$]
{
    <h3 class="price">
    $12.99
    </h3>
} 
```

我试图让它删除任何额外的 tabs\spaces\new 行，所以它应该看起来像这样：

```
[$$price$$]{<h3 class="price">$12.99</h3>} 
```

我写了这个： (\t|\s)+? 除了它在 html 标签中匹配之外，它可以工作，所以 h3 变成了 h3class，我无法弄清楚如何让它忽略标签内的任何内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T01:33:31.190

使用正则表达式处理 HTML 非常容易出错；它们根本不是正确的工具。

相反，使用 HTML/XML 感知库（例如[lxml](http://codespeak.net/lxml/)）来构建 DOM 样式的对象树；就地修改树中的文本段，并使用所述库再次生成输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T21:04:54.340

艾伦，

我必须同意 Charles 的观点，最安全的方法是解析 HTML，然后仅在 Text 节点上工作。听起来有点矫枉过正，但这是最安全的。

另一方面，只要您相信 HTML 代码是正确的（即不包括无效的 < 和 > 在标签中，如：<a title="<this is a test >" href="看这里">...)

然后，您知道任何文本都必须在 > 和 < 之间，除了开头和结尾（如果您只是获得页面的快照，否则 HTML 标记最少。）

所以......你仍然需要两个正则表达式：找到文本'> [^<] + <'，然后应用你提到的另一个正则表达式。

另一种方法是有一个或类似这样的东西（未经测试！）：

'(<[^>]*>)|([\r\n\f ]+)'

这将找到一个标签或空格。找到标签时，不要替换，如果找不到标签，则替换为空字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T01:36:59.870

尝试这个：

```
\r?\n[ \t]* 
```

编辑：想法是删除所有换行符（Unix：“\n”或Windows：“\r\n”）以及紧随其后的任何水平空格（TAB 或空格）。

# windows - 编辑现有平面文件中间的最佳方法是什么？

> ID：732469
> 
> 赞同：1
> 
> 时间：2009-04-09T01:30:04.507
> 
> 标签：windows, file, edit, flat

我有为模拟创建变量的工具。当前的工作流程涉及将这些变量手动复制到模拟输入文件中。输入文件是标准平面文件，即不是二进制文件或 XML。我想自动将变量添加到平面输入文件中。

变量复制文件中的现有变量，例如

新变量：长度 10 高度 20 深度 30

旧变量： ... 体重 100 年龄 20 长度 10 身高 20 深度 30 ...

想让旧变量复制到新变量上。它们是平面输入文件的 200 行。

感谢您的任何见解。

PS这是在Windows上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T01:40:42.187

如果您无法使用平面，那么您将无法使用老式的更新方式：从原始文件读取，写入临时文件，写入原始行或更改数据然后写入。要添加数据，请将其写入临时文件的适当位置；要删除数据，只需不要从原始文件中复制它。

最后，关闭这两个文件并将临时文件重命名为原始文件名。

或者，可能是时候考虑一​​个小型数据库了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T01:50:07.563

对于这样的事情，我会看一个简单的[模板引擎](http://en.wikipedia.org/wiki/Template_processor)。您将拥有一个带有预定义标记标记而不是变量值的基本模板，然后只需将所需的值与模板一起传递给您的引擎，它就会吐出结果文件，所有文件都存在且正确。Java 中有许多[可用的开源模板引擎](http://java-source.net/open-source/template-engines)可以满足您的需求，我想这些东西也可以在您选择的语言中使用。你甚至可以毫不费力地自己动手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-10T22:42:44.827

请注意，在 Unix 下，可能会考虑使用`mmap()`，因为您可以使用诸如`memmove()`移动数据并添加新数据或`truncate()`如果文件更小的结果（您可能还想使用`truncate()`来增大文件）等功能。

在 MS-Windows 下，你可以[`MapViewOfFileEx()`](https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex)做同样的事情。不过，API 是不同的，而且我不确定会发生什么或如何增大/缩小文件（MSDN 还包括一个类似`truncate()`- 的函数，并且可能有效）。

当然，重要的是使用`memcpy()`或`memmove()`正确地不要覆盖错误的数据或超出缓冲区。

# ruby - 在 ruby 中，我如何尝试一段代码但在 n 秒后继续？

> ID：732470
> 
> 赞同：2
> 
> 时间：2009-04-09T01:31:01.103
> 
> 标签：ruby

我有一个库方法偶尔会挂在网络连接上，并且没有超时机制。

添加我自己的最简单的方法是什么？基本上，我试图让我的代码不会被无限期地卡住。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T01:34:43.527

回答了我自己的问题：

[http://www.ruby-doc.org/stdlib/libdoc/timeout/rdoc/index.html](http://www.ruby-doc.org/stdlib/libdoc/timeout/rdoc/index.html)

require 'timeout' status = Timeout::timeout(5) { # 如果花费太多时间应该中断的东西... }

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T13:02:09.663

timeout.rb 有一些问题，基本上它并不总是很好地工作，我不建议使用它。改为检查[系统计时器](http://ph7spot.com/articles/system_timer)或[终结器](http://lindsaar.net/2008/9/11/terminator-timeout-without-mercy)

系统计时器页面特别描述了为什么 timeout.rb 会失败，并附有漂亮的图片和所有内容。底线是：

> *   要使 timeout.rb 工作，Ruby 解释器必须调度一个新创建的“杀人”Ruby 线程。
> *   大多数 Ruby 应用程序在生产中使用的解释器 MRI 1.8 将 Ruby 线程实现为绿色线程。
> *   绿色线程（运行在单个本地线程之上）的一个众所周知的限制是，当绿色线程对底层操作系统执行阻塞系统调用时，虚拟机中的任何绿色线程都不会运行，直到系统调用返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-30T13:14:22.037

为了防止在超时时出现丑陋的错误，我建议将其封闭并使用如下救援：

```
begin
   status = Timeout::timeout(5) do 
      #Some stuff that should be interrupted if it takes too long
   end       
rescue Timeout::Error
   puts "Error message: It took too long!\n"
end 
```

# asp.net - 从 Windows 应用程序调用 ASP.NET 应用程序中的方法

> ID：732472
> 
> 赞同：1
> 
> 时间：2009-04-09T01:31:58.230
> 
> 标签：asp.net

除了使用 Web 服务之外，还有没有办法从 Windows 应用程序调用 Web 应用程序中的方法？两者都在同一台机器上运行。

我基本上想安排一个作业来运行一个更新某些文件的 Windows 应用程序（对于贝叶斯垃圾邮件过滤器），然后我想通知 Web 应用程序重新加载该文件。

我知道这可以通过其他方式完成，但我很想知道这是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T01:34:12.500

您可以让您的 Windows 应用程序连接到 Web 应用程序并在页面中执行 GET，该页面通过重新加载您的文件来响应，我认为使用 Web 服务并不是绝对必要的。这样，您也可以通过网络浏览器实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T01:35:24.290

如果您希望它们直接通信，Web 服务是“正确”的方式。但是，我发现在某些情况下通过数据库记录进行协调更容易。例如，我的网络应用程序具有批量电子邮件功能。为了使其工作，Web 应用程序只留下一个数据库记录，指定要发送的电子邮件。WinApp 会定期扫描这些记录，当它发现一个处于“未处理”状态的记录时，它会采取适当的措施。在一个非常高容量的环境中，这对我来说就像一个魅力。

您不能完全在另一个方向上这样做，因为网络应用程序通常不会处于时间循环中（有一些方法可以解决这个问题，但它们不值得努力）。因此，您需要某种类型的启动操作来让 Web 应用知道何时重新加载文件。为此，您可以使用以下代码在页面上执行 GET：

```
WebRequest wrContent = WebRequest.Create("http://www.yourUrl.com/yourpage.aspx");
Stream objStream = wrContent.GetResponse().GetResponseStream();
// I don't think you'll need the stream Reader but I include it for completeness
StreamReader objStreamReader = new StreamReader(objStream); 
```

然后，无论何时打开此页面，您都将在 PageLoad 方法中重新加载文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T01:37:44.847

Web 应用程序如何加载文件？如果您使用的是对 Cache 对象的依赖项，那么只需更新文件就会使 Cache 条目无效，从而导致您的代码在发现该条目为空（或基于“无效”事件）时重新加载该条目。

否则，我不知道您将如何通知应用程序更新文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T01:38:54.500

ASP.NET 应用程序仅作为服务请求的实例存在。这就是为什么 Web 服务是处理此问题的一种简单方法 - 应用程序已被实例化以服务于服务请求。如果您可以确定该实例存在并获得了它的句柄，则可以使用[远程处理](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.71).aspx)。但是如果没有应用程序实例的具体句柄，就不能直接调用该方法。

还有很多其他的交流方式。您可以使用数据库或其他类型的列表，应用程序都会定期轮询和更新。有很多异步[MQ](http://en.wikipedia.org/wiki/Message_queue)解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T02:28:51.603

因此，您将专门为此目的在您的 web 应用程序中创建一个页面。使用 Get 请求并传入 url 参数。然后在 page_load 事件中检查这个参数。如果存在，则进行处理。通过传入参数，您将防止意外的页面加载，这将导致文件在您不希望的情况下被上传和处理。

从 Windows 应用程序使用 .Net HttpWebRequest 发出 url Get 请求。此处示例：http: [//www.codeproject.com/KB/webservices/HttpWebRequest_Response.aspx](http://www.codeproject.com/KB/webservices/HttpWebRequest_Response.aspx)

# asp.net - Asp.Net DataList 绑定数组 *.aspx ImageUrls

> ID：732474
> 
> 赞同：1
> 
> 时间：2009-04-09T01:33:12.143
> 
> 标签：asp.net, arrays, bind, datalist

下面的代码非常适合绑定从网上抓取的实际网址。我的问题是它不适用于生成图像的 *.aspx url。如果我转到 *.aspx 页面“~/UserPages/Photo/GetThumbnail.aspx?id=7”，图像会显示得很好。但是它不适用于数据列表。任何想法为什么以及如何解决这个问题。谢谢！字符串数组 'imageurls' 由许多 *.aspx 图像 url 组成。

```
<asp:DataList ID="dlImages" runat="server" 
    RepeatColumns="5" 
    RepeatDirection="Horizontal" 
    RepeatLayout="Flow">

    <ItemTemplate>
        <img src="<%# (string)Container.DataItem %>" />
    </ItemTemplate>

</asp:DataList> 
```

背后的代码

```
protected void BindImages(string[] imageurls)
{
    dlImages.DataSource = imageurls; 
    dlImages.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T01:38:22.753

尝试

`<%# ResolveUrl((string)Container.DataItem) %>`

# c# - Django 或 Ruby on Rails

> ID：732476
> 
> 赞同：11
> 
> 时间：2009-04-09T01:33:27.960
> 
> 标签：c#, python, ruby-on-rails, ruby, django

我是一名 C#/.NET 开发人员，希望弄乱一些完全不同的东西——一些 LAM(*) 堆砌的东西，用于快速构建 Web 应用程序。

我在想Django或Rails。我更喜欢 Python 语言，而且在统计、科学和网络方面，它似乎比 Ruby 功能更全面（如果您认为这是错误的，请告诉我）。然而，RoR 社区似乎要大得多——这可能使它成为一个更安全的选择。你觉得这重要吗？有人对 RoR 和 Django 都有经验吗？

* * *

更新：具体来说，我希望能够快速建立一个面向社区金融的网站。肯定有很多 Ruby Gems 可以加快这个过程，但我注意到 Django 端的 Pinax 看起来很有希望。我知道 Python 在金融/数学编程方面已经相当流行。还有人有意见吗？

* * *

更新 2：注意到一些关于 ASP.NET MVC 的评论。事实上，我已经使用 ASP.NET MVC（一个用于医疗设备服务的 LOB 应用程序）完成了非常重要的工作，我很喜欢它。恕我直言，与 ASP.NET Web 表单相比，这是一种更好、更直观的 Web 应用程序编写方式。但是，我真的在寻找一个非 .NET 开发环境来开发一些内容。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-09T02:22:10.793

> 我更喜欢 Python 语言，而且在统计、科学和网络方面，它似乎比 Ruby 功能更全面（如果您认为这是错误的，请告诉我）。

如果你认为你需要像 NumPy 或 SciPy 这样的库，最好还是坚持使用 python/django。我一直在努力寻找红宝石等价物。

> 但是，RoR 社区似乎要大得多

更大当然不会更好。在支持方面，我在 django 社区拥有丰富的经验，可插拔应用程序生态系统正在迅速成熟。

我还要补充一点，我发现 django 文档很容易理解。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-09T01:38:35.110

如果您想要快速堆叠，请查看 Sinatra。

Django 会更快更有意义。它有很棒的路由、简单的文件结构、漂亮干净的语法、没有很多 WTF 时刻和可理解的 ORM 功能。

您将不得不深入研究的 Rails。您将与 activerecord 战斗。您将尝试深入了解 Rails 应用程序的许多方面。

我喜欢他们两个。试试他们两个。他们不需要那么长时间来感受。您最终应该根据每个应用程序做出决定，并考虑哪种语言具有更好的模块/扩展/宝石来满足您的需求。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-09T02:27:01.297

由于您声明的偏好是 Python，我会毫不犹豫地推荐 Django。可用于 Django的[文档](http://docs.djangoproject.com/en/dev/)是一流的，社区非常有帮助。浏览 django-users 档案或在 IRC 中闲逛一段时间，您会很好地了解可用的支持。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-09T08:48:07.777

我更喜欢 Django，因为它不那么神奇，在 Rails 中我觉得他们将约定推到了配置原则之上，所以我更喜欢 Django 更明确的性质。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-09T02:29:07.907

有趣...我在同一条船上，尽管也许我已经四处寻找更长的时间了。

我来自 MS-land（也是 C#），我选择了 Django，但只是在我修改了 Google 的 AppEngine 之后，它重新向我介绍了 Python。Django 组织良好，内部一致（据我所知），并且得到了一个充满活力的社区的良好支持。Python 组织良好，内部一致（据我所知），并且得到了一个*了不起*的社区的极好支持。

无论如何，快速 Python Web 开发比 Django 更重要。您可能想要搜索：python wsgi 框架。Pylons 和 TurboGears 提供了极大的灵活性并专注于“同类最佳”组件，web2py 似乎有一个非常酷的 DAL/ORM，我很想深入研究，而 web.py 和 werkzeug（以及其他）是极简主义的，不要不要试图规定你应该如何构建你的应用程序。如果您坚持使用 Django，请务必查看 Pinax 项目 - 它可能有助于启动您的开发工作。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-09T03:52:20.217

我刚刚用 Django 为客户构建了一个小型社交网站。我是 Python 新手，也是 Django 新手，但这是我一段时间以来最愉快的开发体验之一（即使是对语言和框架的新手感到头疼）。而且只用了两周时间。

如果您是为自己构建它，那么我会同时尝试 Rails 和 Django（或 c.batt 提到的其他框架之一），看看哪种感觉最舒服。我最终选择了 Django/Python，因为我喜欢这种语言。它感觉干净高效，而且您无法与建立和运行准系统站点的速度争论。

如前所述，Pinax 很棒。如果有的话，您将获得坚实的基础。我发现我必须扩展它的一部分以获得我想要的东西，并且我决定从头开始编写几个部分，因为这些更改会变得“hacky”以匹配我需要的内容。然而，其他部分是完美的。私人消息是开箱即用的，只是使用了一些新的模板来匹配网站。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-09T02:49:00.477

我是另一个 C#/.net 家伙，同样渴望修补。Django 很有吸引力。尽管开发既简单又有趣，但我听说过一些关于 Rails 和 Django（主要是 rails）的部署和配置问题的故事。这不像只是在 IIS 上扔一个 asp.net 应用程序或在 Apache 上扔 PHP。对于那些事情，你可以设置它并忘记它。我很想知道 c.batt 对他/她部署 django 的经验的评论。

最近我一直在看Grails。它使用像红宝石一样的 Groovy。它非常易于开发，您可以像 Rails 一样快速构建应用程序，但您可以通过 JVM 访问 Java 平台，这可能会派上用场。您可以将大量的开源 Java 组件放入您的 Grails 应用程序中，其中有很多您正在寻找的组件类型。这真的不像构建一个 java 应用程序。到目前为止，它确实感觉像 Rails。祝你好运。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-09T09:09:08.397

您正处于无法做出错误选择的地步！

我个人的偏好是 django，但事实上我知道 rails 也很好。

我认为最好的答案是 django 的 BFDL 自己说的：

> 两者都试，用你喜欢的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-09T07:29:07.030

由于您是一位经验丰富的 .NET 程序员，因此在转向 Rails 和 Django 之前，您确实应该先了解 ASP.NET 和 MVC，至少如果您的目标是快速启动并运行。利用您已经深入了解的东西总是更容易。

我最近遇到了类似的情况——我有一个项目想在 Windows 和 Unix 上推出，所以我没有利用我熟悉的东西（Ruby/Rails），而是跳槽并尝试了 Grails 上的 Groovy。这是一次非常有益的经历，我真的很高兴我在 Grails 中做了一些小项目，但最终我的生产力只有我在有几年经验的环境中所做的一小部分，即使在之后在 Grails 上进行了几个月的黑客攻击。

所以，选择 Django、Rails、Lift 或任何你喜欢做的东西——它会帮助你扩展你的思维，并给你不同的方式来看待解决问题。但是，如果您想快速上手，请在为您设计的平台 (MVC) 上使用您所知道的 (.NET)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-09T10:43:36.860

你表达了对 Python 的偏好，所以我会选择 Django——它是一个很好的框架。我个人的偏好是另一种选择，但我不是你，两种选择都很好。

这主要是[https://stackoverflow.com/questions/91846/rails-or-django-or-something-else](https://stackoverflow.com/questions/91846/rails-or-django-or-something-else)的副本，顺便说一句

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-10T18:27:22.437

就像其他人建议的那样，尝试两者都是一种好方法，但实际上，对我来说，我会更多地基于您更喜欢使用哪种语言。当然，如果它是一个 Web 应用程序，您将使用该框架做很多事情，但是您编写的“每一行”代码都将使用该语言。由于这两个框架都很强大，所以真正更重要的是你每天用哪种语言编写代码最开心。

我个人使用 Rails 并喜欢它，但有很多朋友使用 Django。当我们一次又一次地讨论事物时，它更多地归结为语言而不是框架。语言是完全不同的，至少在我看来，你通常会发现你更喜欢一种。我最初认为 Python 听起来很棒，学会了它，用它写了一些东西等等，但它对我来说从来没有“点击”过。多年前我第一次看到 Ruby 时，感觉有点奇怪，但当我通过 Rails 重新审视它时，感觉很自然。当我用 Ruby 编写代码时，我感觉自己几乎是在写英语——如果我能想到我认为应该如何编写代码，我几乎可以输入它并且它可以工作。它更适合我的大脑。

社区明智的，你会得到很多不同的意见。我不认为“太大”意味着不好，我也不认为 Ruby 社区无论如何“太大”，尤其是与 Java 社区相比。Ruby 和 Rails 在某种程度上肯定已经成为主流，对于我们这些已经使用它多年的人来说，它似乎是主流，但从整体上看，它实际上仍然相当小。

无论如何，祝你好运，并*享受*研究它们并找到让你高兴的工作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-11-21T21:04:31.110

Rails 就像圣经。除非你是圣人，否则你不需要了解它，你可能永远也不会了解；你需要做的就是相信它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-09T02:59:37.207

我很好奇。如果你是 C# 程序员，为什么要排除微软的 MVC？

您的问题表达了两种不同的需求：

1) 想尝试新事物 2) 想快速建立社区金融网站。

我理解为需要 1 查看 RoR 或 Django 的愿望，但对于需要 2，我希望您使用 MVC 会更快地提高生产力。

请注意，我并不是说每个人都会更快地提高生产力，也不是说微软的 MVP 天生就更有生产力，只是说目前是 C# 程序员的人能够更快地掌握使用 C# 的东西...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-09T09:36:41.730

尽管我从未亲自尝试过，但您可能还想查看带有 IronPython 的 ASP.NET。[这是一篇详细介绍它的博客文章](http://weblogs.asp.net/scottgu/archive/2006/11/16/ironpython-for-asp-net-ctp.aspx)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-09T10:22:43.150

我同意那些说：尝试两者并使用你最喜欢的东西的人。

我认为 Rails 将是一次有趣的体验，因为约定优于配置和强制 MVC 架构。此外，我不确定 StackOverflow 上人们对 Django 的体验如何，但我的所有 Rails 问题都很快得到了解答。

另外请记住，如果需要，您可以调用 python 服务进行一些统计计算。

这是一个从 .NET/C# 到 Rails 到 Django/Python，然后又回到 Rails 的人写的文章。可能值得快速阅读。

[http://blog.carlmercier.com/2007/01/30/why-i-moved-from-ruby-on-rails-to-pythondjango-and-back/](http://blog.carlmercier.com/2007/01/30/why-i-moved-from-ruby-on-rails-to-pythondjango-and-back/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-09T18:23:49.270

您的问题必须是：Python 或 Ruby ;)

# math - 面试题：f(f(x)) == 1/x

> ID：732485
> 
> 赞同：9
> 
> 时间：2009-04-09T01:38:12.583
> 
> 标签：math

> 设计一个函数 f 使得：
> 
> f(f(x)) == 1/x
> 
> 其中 x 是 32 位浮点数

或者怎么样

> 给定一个函数 f，找到一个函数 g 使得
> 
> f(x) == g(g(x))

* * *

### 也可以看看

> [面试题：f(f(n)) == -n](https://stackoverflow.com/questions/731832/interview-question-ffn-n)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-09T03:18:23.357

对于第一部分：这个比 f(f(x)) = -x, IMO 更简单：

```
float f(float x)
{
    return x >= 0 ? -1.0/x : -x;
} 
```

第二部分是一个有趣的问题，也是这个问题所基于[的原始问题的明显概括。](https://stackoverflow.com/questions/731832/interview-question-ffn-n)有两种基本方法：

*   一种数值方法，例如 x ≠ f(x) ≠ f(f(x))，我认为这更符合原始问题的精神，但我认为在一般情况下是不可能的
*   一种涉及 g(g(x)) 只调用一次 f 的方法

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-09T01:48:52.697

好吧，这是 C 的快速破解：

```
extern double f(double x);
double g(double x)
{
  static int parity = 0;
  parity ^= 1;
  return (parity ? x : f(x));
} 
```

但是，如果您这样做，则会出现以下问题：

```
a = g(4.0); // => a = 4.0, parity = 1
b = g(2.0); // => b = f(2.0), parity = 0
c = g(a);   // => c = 4.0, parity = 1
d = g(b);   // => d = f(f(2.0)), parity = 0 
```

一般来说，如果 f 是双射 f : D → D，您需要一个函数 σ，它将域 D 划分为 A 和 B，使得：

1.  D = A ∪ B，（分区是总的）
2.  ∅ = A ∩ B（分区不相交）
3.  σ(a) ∈ B, f(a) ∈ A ∀ a ∈ A,
4.  σ(b) ∈ A, f(b) ∈ B ∀ b ∈ B,
5.  σ 有一个逆 σ ^(-1) st σ(σ ^(-1) (d)) = σ ^(-1) (σ(d)) = d ∀ d ∈ D。
6.  σ(f(d)) = f(σ(d)) ∀ d ∈ D

然后，您可以这样定义 g ：

*   g(a) = σ(f(a)) ∀ a ∈ A
*   g(b) = σ ^(-1) (b) ∀ b ∈ B

这工作 b/c

*   ∀ a ∈ A, g(g(a)) = g(σ(f(a)). 由 (3), f(a) ∈ A 所以 σ(f(a)) ∈ B 所以 g(σ(f (a)) = σ ^(-1) (σ(f(a))) = f(a)。
*   ∀ b ∈ B，g(g(b)) = g(σ ^(-1) (b))。由(4)，σ ^(-1) (b) ∈ A 所以 g(σ ^(-1) (b)) = σ(f(σ ^(-1) (b))) = f(σ(σ ^(-1) (b))) = f(b)。

从 Miles 的回答中可以看出，如果我们忽略 0，那么操作 σ(x) = -x 适用于 f(x) = 1/x。您可以检查 1-6（对于 D = 非零实数），其中 A 是正数，B 是您自己的负数。对于双精度标准，有 a `+0`、 a `-0`、 a`+inf`和 a `-inf`，这些可用于使域总计（适用于所有双精度数字，而不仅仅是非零）。

相同的方法可以应用于 f(x) = -1 问题 - 那里接受的解决方案使用余数 mod 2 划分空间，使用 σ(x) = (x - 1)，特别处理零情况。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-09T02:36:37.263

我喜欢早期线程中的 javascript/lambda 建议：

```
function f(x)
{
   if (typeof x == "function")
       return x();
   else
       return function () {return 1/x;}
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T03:29:11.927

其他解决方案暗示需要额外的状态。这是一个更数学的理由：

`let f(x) = 1/(x^i)= x^-i`

（其中 ^ 表示指数，i 是虚数常数 sqrt(-1) ）

`f(f(x)) = (x^-i)^-i) = x^(-i*-i) = x^(-1) = 1/x`

因此，存在复数的解决方案。我不知道是否有一个严格遵守实数的通用解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-25T18:09:23.687

如果`f(x) == g(g(x))`，则`g`称为 的泛[函平方根](http://en.wikipedia.org/wiki/Functional_square_root)。`f`即使您允许*x*复杂，我也不认为通常有封闭形式（您可能想去 mathoverflow 讨论:)）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T02:47:44.477

同样，它被指定为 32 位数字。使返回有更多位，使用它们在调用之间携带您的状态信息。

```
Const
    Flag = $100000000;

Function F(X : 32bit) : 64bit;

Begin
    If (64BitInt(X) And Flag) > 0 then
        Result := g(32bit(X))
    Else
        Result := 32BitInt(X) Or Flag;
End; 
```

对于任何函数 g 和任何 32 位数据类型 32 位。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T14:25:02.187

还有另一种方法可以解决这个问题，它使用分数线性变换的概念。这些是发送 x->(ax+b)/(cx+d) 的函数，其中 a,b,c,d 是实数。

例如，您可以使用一些代数证明如果 f 由 f(x)=(ax+1)(-x+d) 定义，其中 a^2=d^2=1 和 a+d<>0 则 f(对于所有实数 x，f(x))=1/x。选择 a=1,d=1，这给出了 C++ 中问题的解决方案：

```
float f(float x)
{
    return (x+1)/(-x+1);
} 
```

证明是 f(f(x))=f((x+1)/(-x+1))=((x+1)/(-x+1)+1)/(-(x+1 )/(-x+1)+1) = (2/(1-x))/(2x/(1-x))=1/x 取消 (1-x)。

这不适用于 x=1 或 x=0，除非我们允许定义满足 1/inf = 0、1/0 = inf 的“无限”值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-18T21:13:17.690

一个 C++ 解决方案`g(g(x)) == f(x)`：

```
struct X{
    double val;
};

X g(double x){
    X ret = {x};
    return ret;
}

double g(X x){
    return f(x.val);
} 
```

这是一个短一点的版本（我更喜欢这个 :-)）

```
struct X{
    X(double){}
    bool operator==(double) const{
        return true
    }
};

X g(X x){
    return X();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T04:38:20.217

基于[这个答案](https://stackoverflow.com/questions/732485/interview-question-ffx-1-x/732658#732658)，通用版本的解决方案（作为 Perl 单线）：

```
sub g { $_[0] > 0 ? -f($_[0]) : -$_[0] } 
```

应该总是翻转变量的符号（又名状态）两次，并且应该总是`f()`只调用一次。对于那些对 Perl 的隐式返回不够幸运的语言，只需`return`在 the 之前插入a 就可以了`{`。

只要`f()`不更改变量的符号，此解决方案就可以工作。在这种情况下，它返回原始结果（对于负数）或结果`f(f())`（对于正数）。另一种方法可以将变量的状态存储为偶数/奇数，就像上一个问题的答案一样，但是如果`f()`更改（或可以更改）变量的值，它就会中断。如前所述，更好的答案是 lambda 解决方案。这是 Perl 中类似但不同的解决方案（使用引用，但概念相同）：

```
sub g {
  if(ref $_[0]) {
    return ${$_[0]};
  } else {
    local $var = f($_[0]);
    return \$var;
  }
} 
```

注意：这是经过测试的，并且*不起作用*。它始终返回对标量的引用（并且始终是相同的引用）。我已经尝试了一些东西，但是这段代码显示了*大致的想法*，虽然我的实现是错误的，而且这种方法甚至可能存在缺陷，但这是朝着正确方向迈出的一步。通过一些技巧，您甚至可以使用字符串：

```
use String::Util qw(looks_like_number);

sub g {
  return "s" . f($_[0]) if looks_like_number $_[0];
  return substr $_[0], 1;
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-11-02T12:05:10.667

试试这个

```
MessageBox.Show( "x = " + x );
MessageBox.Show( "value of x + x is " + ( x + x ) );
MessageBox.Show( "x =" );
MessageBox.Show( ( x + y ) + " = " + ( y + x ) ); 
```

# asp.net - ASP.NET 自定义验证器

> ID：732486
> 
> 赞同：3
> 
> 时间：2009-04-09T01:38:17.620
> 
> 标签：asp.net

你能告诉我什么时候使用 CustomValidator。例如，我有接受用户评论的文本框。CustomValidator 适合场景的任何原因以及其他验证器不能做或难以做的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T01:43:22.850

您的问题描述了使用 CustomValidator 的确切原因：当现有验证器无法执行您需要完成的操作时，您可以使用它。例如，没有验证器可以确保文本框 B 中的值介于 A 和 C 中的值之间。您必须在代码中的 CustomValidator 中执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T01:43:03.007

这取决于您要验证的内容 - 您需要提供更多信息。

CustomValidator 允许您编写任何代码，以对输入到文本框中的数据执行一项或多项验证。其他验证器执行不同的功能，例如比较值、检查值是否已输入或检查值是否符合正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T01:46:01.520

CustomValidator 旨在让您自由地实现自己的验证逻辑，而其他验证器只是不做您需要做的事情。

EG：当您需要进行任何类型的验证时，实际上并不需要用户输入控件（例如检查 cookie 是否存在），或者如果您要验证的控件必须遵循对其他控件来说过于复杂的输入规则验证器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T02:53:53.977

我过去使用过 CustomValidators 的一件事是生成错误消息列表以放入 ValidationSummary 控件中。通常，只要您想要进行一些标准的 ASP.NET 验证器未涵盖的自定义验证，就可以使用它们。

# .net - MEF 类型“AttributedAssemblyPartCatalog”发生了什么？

> ID：732495
> 
> 赞同：6
> 
> 时间：2009-04-09T01:45:01.990
> 
> 标签：.net, types, mef

许多*简单的*MEF 示例（如下所列）使用`AttributedAssemblyPartCatalog`.

*   在 CodePlex MEF 页面上[的应用程序中托管 MEF](http://mef.codeplex.com/Wiki/View.aspx?title=Hosting%20MEF%20and%20the%20Container&referringTitle=Guide)

*   Brad Adams[使用托管扩展框架简单介绍可扩展应用程序](http://blogs.msdn.com/brada/archive/2008/09/29/simple-introduction-to-composite-applications-with-the-managed-extensions-framework.aspx)

*   [托管可扩展性框架教程 -](http://www.pnpguidance.net/post/ManagedExtensibilityFrameworkTutorialMEF.aspx) David Hayden 的MEF

我已经从[CodePlex下载了](http://www.codeplex.com)[MEF](http://mef.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25797)源代码，但仍然无法在任何地方找到该类型。

发生了`AttributedAssemblyPartCatalog`什么以及创建解析器的替代方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-09T02:08:29.640

他们将它（连同其他目录）重命名为 drop 4 中的较短标识符（我们现在最多 drop 5）。它现在称为 AssemblyCatalog。同样，DirectoryPartCatalog 被重命名为 DirectoryCatalog。

# ruby-on-rails - restful_authentication 仅应用于控制器中的操作？

> ID：732500
> 
> 赞同：1
> 
> 时间：2009-04-09T01:47:17.287
> 
> 标签：ruby-on-rails, restful-authentication

我已经安装并实现了来自 technoweenie 的插件 restful_authentication。

我的申请在很大程度上是为了公开，除了写评论的情况。

所以我有一个reviews_controller.rb，但我唯一想关心用户是否登录的时间是他们提交特定操作add_review 的时候。

add_review 是对 vendor_controller.rb 的操作，因为表单显示在 vendor/show 上。然后它重定向回 vendor/show 以显示更新（考虑将其更改为 ajax）。

如果此人未登录，我希望它重定向到登录/注册页面。

restful_authentication 的说明显示在控制器级别应用 include AuthenticatedSystem，但我不想使用该控制器中的其他操作进行身份验证。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T02:54:42.633

将 AuthenticatedSystem 模块包含在您需要它的控制器中（或 ApplicationController，如果您需要它不止一个），然后使用 before_filter 仅应用于您想要的操作，例如：

```
class VendorsController < ApplicationController
  include AuthenticatedSystem
  before_filter :login_required, :only => [:add_review]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T05:41:40.157

我恳请您使用 restful create 操作而不是您自己的 add_review 操作。阅读更多关于 RESTful 路由的信息：http: [//guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

# web-services - 我应该使用服务器端脚本还是 Web 服务？

> ID：732505
> 
> 赞同：1
> 
> 时间：2009-04-09T01:49:23.960
> 
> 标签：web-services

我需要能够从我的 iPhone 访问 mySQL 数据库，用于读写操作。我不想使用 MCPKit（出于安全和速度考虑），而是想通过单独的服务访问数据库。该应用程序是 iPhone SDK，所以我需要以 XML 形式获取数据，而不是作为网页。

我正在尝试决定是编写一个 Java Web 服务 (SOAP) 来提供此链接，还是只是在服务器端组合一个 PHP 脚本。我可以创建任一解决方案，但我知道的不够多，无法弄清楚选择的优点/缺点。请帮忙; 谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T01:53:56.930

如果您同时编写客户端和服务器，并且性能不是一个重要问题，那么剩下的主要考虑因素是开发时间。

那么，你有什么工具可以使用？哪个平台可以让您以最少的工作量做到这一点？如果是两者之间的折腾，那么选择你最熟悉的那个。

# c# - 轮询操纵杆 C#

> ID：732509
> 
> 赞同：0
> 
> 时间：2009-04-09T01:51:22.550
> 
> 标签：c#, .net, multithreading, polling, input-devices

我有一个应用程序记录了按下空格键时的日期/时间，但由于各种原因，窗口并不总是有焦点。例如病毒检查弹出窗口、iTunes 更新、Windows 更新等

所以我认为一个很酷的想法是使用操纵杆按钮，然后无论哪个窗口有焦点，我总是可以检测到按钮按下事件并记录按下它的日期/时间。

现在我看了一些游戏教程，但他们似乎将操纵杆轮询绑定到屏幕刷新事件中，因为在游戏中我猜如果计算机速度很慢并且屏幕不经常刷新，有操纵杆按钮无论如何，按下不会有任何区别。

这并不真正适合我的需要，所以我正在考虑运行一个线程，该线程将每隔一段时间轮询操纵杆

我的问题是

1.  是后台线程最好的解决方案
2.  我应该多久轮询一次操纵杆
3.  我应该使用什么样的计时器来确定轮询频率。

我希望响应至少相当于键盘。如果按住触发器，还需要确保它不会自动重复。

任何示例代码（C#）赞赏

谢谢

亚历克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T02:10:31.367

如果您只是因为无法捕获键盘事件而想要轮询操纵杆，我认为您需要重新制定策略。

即使您的表单没有焦点，也有一些方法可以确保您知道键盘状态。

1.  您可以使用 SetWindowsHookEx API 调用在 C# 中设置系统范围的键盘挂钩。

这是对非托管代码和 Windows API 的一些研究，但我认为这比轮询操纵杆更好，因为您不需要仅仅因为您需要在按下空格键时捕获日期时间而向计算机添加操纵杆。

在谷歌上搜索一下 C# 中的键盘钩子。这比许多人认为的要容易。

我不认为使用计时器对象来做到这一点是一个好主意。因为我相信你说过你需要按一个键来做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T01:55:23.430

最好的办法是在表单上创建一个 Timer 对象，并将操纵杆检查与 Tick 事件联系起来。

我还发现每 100 毫秒（每秒 10 次）运行类似这样的简单操作对 CPU 使用率的影响可以忽略不计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T02:22:41.557

使用[AHK (Auto HotKey)](http://www.autohotkey.com/)之类的东西，它是一种可以编译为 EXE 的简单语言，专为自动化键盘和鼠标而设计，我不能 100% 确定它与操纵杆配合得如何，但我敢肯定他们可能设法为wii遥控器写了一些东西。

如果需要，IRC 频道和论坛也总是有人愿意提供帮助。

# sql-server - SQL Server 与 Access 插入性能对比，尤其是在使用 GUID 时

> ID：732512
> 
> 赞同：3
> 
> 时间：2009-04-09T01:54:15.117
> 
> 标签：sql-server, performance, ms-access, guid

我很想知道在使用 Access 2007 作为 SQL Server 2008 的前端时使用顺序 GUID 时如何提高 SQL Server 的性能（请注意，这是我感兴趣的唯一上下文）。

我进行了一些测试（并得到了一些相当令人惊讶的结果，特别是在使用**顺序**GUID 时从 SQL Server 获得的结果：插入性能下降得非常快，而且对我来说这么快下降似乎并不合适。

基本上测试如下：

> *从 Access 前端，仅使用 VBA，按顺序插入 100,000 条记录，每批 1000 条。*

*   我尝试使用身份和顺序 GUID 作为 PK。
*   我在*SQL Server 2008 Standard*（没有特殊调整，只是默认安装）和 Access 2007 数据库作为后端进行了尝试。所有表都链接回前端。

一些结果（更多，在[我关于测试的博客条目中](http://blog.nkadesign.com/2009/access-vs-sql-server-some-stats-part-1/)提供了原始数据）：

很明显，随着数据库的增长，插入性能会降低，但 SQL Server 在这里的性能根本就不是很好。

[http://blog.nkadesign.com/wp-content/uploads/2009/04/chart02.png](http://blog.nkadesign.com/wp-content/uploads/2009/04/chart02.png)

SQL Server 结果的扩展视图：http: [//blog.nkadesign.com/wp-content/uploads/2009/04/chart03.png](http://blog.nkadesign.com/wp-content/uploads/2009/04/chart03.png)

### 编辑 13APR2009

我发现[我的服务器配置有问题，](http://blog.nkadesign.com/2009/sysadmin-dell-server-performance-madness/)我更新了[我博客上的测试](http://blog.nkadesign.com/2009/access-vs-sql-server-some-stats-part-1/)。
感谢大家的回复，他们对我帮助很大。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T02:10:45.000

这里有两件事在起作用。首先，重要的是要指出，对于特定的用例，开箱即用的 SQL 不一定能很好地工作。它是一种专业产品，旨在由知道自己在做什么的人进行调整。

相比之下，Access 被设计为在大多数用例中运行良好，无需任何配置。第二点涵盖了这种权衡的缺点：

SQL Server 专为可伸缩性而设计。请注意只有 100,000 条记录，Access 是如何严重降级的。在一百万之前，它可能会急剧下降到 SQL 的线以下。相比之下，SQL Server 几乎保持完全稳定，在大约 45,000 条记录之后变化趋于稳定，并将继续保持数百万。

**编辑**我认为这里可能还有其他我们没有看到的东西在起作用。我认为您的 SQL 编号看起来很糟糕，所以我自己进行了测试。在我的运行 Windows Vista 3.6 ghz 和 2gb RAM 的桌面上，在 SQL Server 上执行具有顺序 GUID 的插入：

*   在 0 条记录处平均每秒插入 1382 次

*   在 500k 条记录下，平均每秒插入 1426 次

*   从 0 到 500k 平均每秒 1609.6 次插入，平均下限为 992 次插入/秒，平均上限为 1989 次插入/秒。

因此，考虑到在使用中的桌面上运行它所产生的正常差异，我会说 SQL Server 插入基本上从 0 条记录线性扩展到半百万。在专用的、经过调优的服务器上，我希望获得更高的一致性（更不用说*更好*的性能了）：

[Excel 图表，每秒插入次数 http://img24.imageshack.us/img24/9485/insertspersecond.jpg](http://img24.imageshack.us/img24/9485/insertspersecond.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T02:09:48.513

您意识到性能下降的至少部分原因是日志被填满，而 GUID id 比 int 长 40 个字节？

但我不是在狡辩；很高兴看到有人采用实际指标，而不仅仅是挥手。修改了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T03:05:11.313

你从哪里得到数据？

如果您使用 Access Export 菜单选项而不是每次循环记录，它会更改数字吗？

VBA 对连接参数也非常敏感，并且有很多不一定直观的选项。

如果标识列是可接受的，为什么还要考虑顺序 GUID（这是我上次检查的 MSSQL 中的一种附加功能）。

* * *

编辑：查看您的代码并简要查看 MSDN 上的 Recordset 文档，我发现您可以使用更有效的参数。例如，您的 dbSeeChanges 和 dbOpenDynaset，如果您试图允许其他用户弄乱相同的行（或需要取回插入的 IDENTITY 值或可能的 GUID），它们是合适的，但我认为您不需要这些。本质上，在每次 INSERT 或 UPDATE 之后，您正在将记录从数据库读回 VBA。我会仔细阅读这些连接配置设置，我敢打赌你会想出一些更令人满意的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T22:21:54.737

我的问题是您的测试设置是否代表您的应用程序的实际情况。简而言之，您是否在测试正确的东西？

您的应用程序会一次添加大量记录吗？

还是会根据 SQL SELECT 追加成批的记录？

如果是后者，您可能会考虑尝试在服务器端执行所有操作，特别是当 SELECT 中的源表位于服务器上时。重要的是要意识到，使用 ODBC，批量追加将作为对每一行的单个插入发送到 SQL Server（每一个都类似于测试代码中基于记录集的方法）。如果您将同一进程完全移动到服务器端，则可以将其作为批处理操作来完成。

此外，您应该使用 ADO 而不是 DAO 再次进行测试。它可以完全不同地优化操作。

最后，就在上周，有人让我注意到了 Andy Baron 的这篇引人入胜的文章：

[优化链接到 SQL Server 的 Microsoft Office Access 应用程序](http://msdn.microsoft.com/en-us/library/bb188204.aspx)

我仍在吸收那篇非常有用的文章的内容，它讨论了与非 GUID 特定主题有关的几个问题，这些问题可以帮助您优化流程以获得最大效率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T03:26:54.507

我最后一次看到类似的东西（使用 GUID PK 插入真的很慢）是因为日志文件已满。插入性能像石头一样下降，非常快（没有硬测量，只是查看实时轨迹，但它看起来确实有点像对数）。这是历史数据的预加载。转到身份 PK，负责实际清理日志文件，之后一切都变得更好（几个小时，第一个版本花了几个小时，但还没有完成）。

另外，只是想一想，是否涉及任何交易？也许 SQL Server 事务会产生访问所没有的巨大性能影响（鉴于访问并非真正面向并发访问）。

# php - 截取你一生中见过的最丑陋的 HTML

> ID：732513
> 
> 赞同：5
> 
> 时间：2009-04-09T01:54:21.250
> 
> 标签：php, screen-scraping, tidy, htmltidy

我正在使用 PHP 和 libtidy 尝试筛选可能是历史上最可怕和格式错误的 HTML 表格使用。该站点关闭了几个表、tr、td、字体或粗体标签，并始终在表中嵌套许多不同的表层。

示例片段：

```
<center>
<table border="1" bordercolor="#000000" cellspacing="0" cellpadding="0">
<tr>
<td width="50%">
<center>
Home Team - <b>Wildcats<td>
<center>
Away Team - <b>Polar Bears<tr>
<td colspan="2">
<center>
<b><font size="+1">Rosters<tr>
<td valign="top">
<center>
<table border="0" cellspacing="0">
<tr>
<td>
<font size="2">1&nbsp;<td>
<font size="2">Baird, T<tr>
<td>
<font size="2">2&nbsp;<td>
<font size="2">Knight, P<tr>
<td>
<font size="2">8&nbsp;<td>
<font size="2">Miller, B<tr>
<td>
<font size="2">9&nbsp;<td>
<font size="2">Huebsch, B<tr>
<td>
<font size="2">11&nbsp;<td>
<font size="2">Buschmann, C<tr>
<td>
<font size="2">12&nbsp;<td>
<font size="2">Reding, J<tr>
<td>
<font size="2">14&nbsp;<td>
<font size="2">Simpson, S<tr>
<td>
<font size="2">27&nbsp;<td>
<font size="2">Kupferschmidt, M<tr>
<td>
<font size="2">28&nbsp;<td>
<font size="2">Anderson, D<tr>
<td>
<font size="2">31&nbsp;<td>
<font size="2">Gehrts, J<tr>
<td>
<font size="2">39&nbsp;<td>
<font size="2">McGinnis, G<tr>
<td>
<font size="2">42&nbsp;<td>
<font size="2">Temple, B<tr>
<td>
<font size="2">44&nbsp;<td>
<font size="2">Kemplin, A<tr>
<td>
<font size="2">77&nbsp;<td>
<font size="2">Weiner, B<tr>
<td>
<font size="2">95&nbsp;<td>
<font size="2">
Zytkoskie, D</table>
<td valign="top">
<center>
<table border="0" cellspacing="0">
<tr>
<td>
<font size="2">5&nbsp;<td>
<font size="2">Mack, A<tr>
<td>
<font size="2">8&nbsp;<td>
<font size="2">Foucault, R<tr>
<td>
<font size="2">11&nbsp;<td>
<font size="2">Oberpriller, D *<tr>
<td>
<font size="2">12&nbsp;<td>
<font size="2">Underwood, J<tr>
<td>
<font size="2">15&nbsp;<td>
<font size="2">Oberpriller, M<tr>
<td>
<font size="2">19&nbsp;<td>
<font size="2">Langfus, B<tr>
<td>
<font size="2">25&nbsp;<td>
<font size="2">Carroll, R<tr>
<td>
<font size="2">30&nbsp;<td>
<font size="2">Hirdler, T<tr>
<td>
<font size="2">33&nbsp;<td>
<font size="2">Gibson, S<tr>
<td>
<font size="2">35&nbsp;<td>
<font size="2">Marthaler, C<tr>
<td>
<font size="2">44&nbsp;<td>
<font size="2">Yurik, J<tr>
<td>
<font size="2">58&nbsp;<td>
<font size="2">
Gronemeyer, S</table>
<tr>
<td colspan="2">
<center>
<b><font size="+1">Goals<tr>
<td valign="top">
<center>
<table border="1" cellspacing="0" width="100%">
<td>
<b><font size="2">Player<td>
<b><font size="2">Period<td>
<b><font size="2">Time<td>
<b><font size="2">Assist 1<td>
<b><font size="2">Assist 2<td>
<b><font size="2">SH<td>
<b><font size="2">PP<tr>
<td nowrap>
<font size="2">Kupferschmidt,&nbsp;M<td>
<font size="2">1<td>
<font size="2">12:51<td nowrap>
<font size="2">Kemplin,&nbsp;A<td nowrap>
<font size="2">None<td>
<font size="2">
<center>
<td>
<font size="2">
<center>
<tr>
<td nowrap>
<font size="2">McGinnis,&nbsp;G<td>
<font size="2">1<td>
<font size="2">12:33<td nowrap>
<font size="2">Huebsch,&nbsp;B<td nowrap>
<font size="2">None<td>
<font size="2">
<center>
<td>
<font size="2">
<center>
<tr>
<td nowrap>
<font size="2">Kupferschmidt,&nbsp;M<td>
<font size="2">2<td>
<font size="2">16:01<td nowrap>
<font size="2">None<td nowrap>
<font size="2">None<td>
<font size="2">
<center>
<td>
<font size="2">
<center>
<tr>
<td nowrap>
<font size="2">Buschmann,&nbsp;C<td>
<font size="2">3<td>
<font size="2">00:38<td nowrap>
<font size="2">None<td nowrap>
<font size="2">None<td>
<font size="2">
<center>
<td>
<font size="2">
<center>
</table>
<td valign="top">
<center>
<table border="1" cellspacing="0" width="100%">
<td>
<b><font size="2">Player<td>
<b><font size="2">Period<td>
<b><font size="2">Time<td>
<b><font size="2">Assist 1<td>
<b><font size="2">Assist 2<td>
<b><font size="2">SH<td>
<b><font size="2">PP<tr>
<td nowrap>
<font size="2">Oberpriller,&nbsp;D *<td>
<font size="2">3<td>
<font size="2">12:31<td nowrap>
<font size="2">Gronemeyer,&nbsp;S<td nowrap>
<font size="2">None<td>
<font size="2">
<center>
<td>
<font size="2">
<center>
</table>
<tr>
<td colspan="2">
<center>
<b><font size="+1">Penalties<tr>
<td valign="top">
<center>
<table border="1" cellspacing="0" width="100%">
<td>
<b><font size="2">Player<td>
<font size="2"><b>Period<td>
<font size="2"><b>Minutes<td>
<font size="2"><b>Offense<td>
<font size="2"><b>Start<td>
<font size="2"><b>Expired<tr>
<td nowrap>
<font size="2">Buschmann,&nbsp;C<td>
<font size="2">
<center>
3<td>
<font size="2">
<center>
2<td>
<font size="2">Interference<td>
<font size="2">11:11<td>
<font size="2">09:11<tr>
<td nowrap>
<font size="2">Buschmann,&nbsp;C<td>
<font size="2">
<center>
3<td>
<font size="2">
<center>
2<td>
<font size="2">Unsportmanlike Conduct<td>
<font size="2">03:26<td>
<font size="2">01:26<tr>
<td nowrap>
<font size="2">Bench<td>
<font size="2">
<center>
3<td>
<font size="2">
<center>
2<td>
<font size="2">Too Many Men<td>
<font size="2">01:46<td>
<font size="2">
00:00</table>
<td valign="top">
<center>
<table border="1" cellspacing="0" width="100%">
<td>
<b><font size="2">Player<td>
<font size="2"><b>Period<td>
<font size="2"><b>Minutes<td>
<font size="2"><b>Offense<td>
<font size="2"><b>Start<td>
<font size="2"><b>Expired<tr>
<td nowrap>
<font size="2">Marthaler,&nbsp;C<td>
<font size="2">
<center>
1<td>
<font size="2">
<center>
2<td>
<font size="2">Interference<td>
<font size="2">01:19<td>
<font size="2">16:19<tr>
<td nowrap>
<font size="2">Underwood,&nbsp;J<td>
<font size="2">
<center>
2<td>
<font size="2">
<center>
2<td>
<font size="2">Interference<td>
<font size="2">12:32<td>
<font size="2">10:32<tr>
<td nowrap>
<font size="2">Marthaler,&nbsp;C<td>
<font size="2">
<center>
3<td>
<font size="2">
<center>
2<td>
<font size="2">Interference<td>
<font size="2">11:39<td>
<font size="2">
09:39</table>
<tr>
<td colspan="2">
<center>
<font size="+1"><b>Goalies<tr>
<td>
<center>
<table border="1" cellspacing="0" width="100%">
<td>
<b><font size="2">Name<td>
<font size="2"><b>Shots<td>
<font size="2"><b>Goals<tr>
<td>
<font size="2">Baird,&nbsp;T<td>
<font size="2">20<td>
<font size="2">1<tr>
<td>
<font size="2"><b>Open Net<td>
<td>
<font size="2">
0</table>
<td>
<center>
<table border="1" cellspacing="0" width="100%">
<td>
<b><font size="2">Name<td>
<font size="2"><b>Shots<td>
<font size="2"><b>Goals<tr>
<td>
<font size="2">Hirdler,&nbsp;T<td>
<font size="2">42<td>
<font size="2"> 
```

神奇的是，所有浏览器似乎都可以很好地呈现这个。PHPTidy 设法很好地理解了这一切，但是表嵌套得太深而且几乎是随机的，以至于使用 DOM XPath 很难遍历它。

有人对其他方法有什么建议吗？

**事后分析**：在喝了太多比利时小麦啤酒并弄脏了我的代码之后，我通过 strip_tags() 删除了除 table、tr 和 td 之外的所有标签，然后通过 libtidy 运行它，得到了很好的结果。现在它的格式很漂亮，很容易遍历。似乎在将其发送到解析器之前只需要稍微按摩一下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T01:59:20.893

您可以使用一些技巧来清理高度可预测的结构，例如表格。在运行 HTML tidy 之前，您可以使用 Regex 或其他东西来搜索`<tr>`'s 和`<td>`'s 后面跟着另一个`<tr>`or `<td>`，并在它之前插入相应的关闭器。在 a 中容纳桌子有一些额外的技巧，`<td>`但没有什么是不可能处理的。只需从找到最里面的结构并从那里向外移动开始。

真正的难题是诸如未闭合`<div>`的 's 和`<p>`'s 之类的东西，它们可能更难与它们相应的（或缺少的）闭合器匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T02:02:22.027

如果您对 Python 等其他语言持开放态度，[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)非常擅长重构编写不佳的 HTML。我刚刚尝试通过以下代码段运行您的 HTML，它现在非常易读。

```
#!/usr/bin/env python

from BeautifulSoup import BeautifulSoup

html = "long string of html"
soup = BeautifulSoup(html)
print soup.prettify() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T04:19:54.177

如果您正在查找数据，我将**删除所有 html**并将其作为逐行原始输入处理。您可以使用[strip_tags](http://www.php.net/strip_tags)功能。

```
$clean = strip_tags($input);

// example: <p>Test paragraph.</p> <a href="#fragment">Other text</a>
// returns: Test paragraph. Other text 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T01:58:14.890

也许您会更幸运地使用正则表达式而不是将其解析为 XML 来抓取所需的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T04:37:34.773

我使用 xpath 和 Python 的[lxml](http://codespeak.net/lxml/)库来解析 IMDB Top 250 页面。[自己查看源代码](http://www.imdb.com/chart/top)，看看它有多糟糕。

以下代码解析保存的 IMDB Top 250 页面 ( `top250.html`) 并将提取的信息存储在 sqlite 数据库中 ( `top250.db`)

```
import sqlite3
from lxml import html

tree = html.parse('top250.html')

class TopMovie(object):
    base_xpath = "/html/body/div/div[2]/layer/div[3]/table/tr/td[3]/div/table/tr/td/table/tr[%d]"

    def __init__(self, num):
        self.rank = num
        self.xpath = self.base_xpath % (self.rank + 1)

    def rating(self):
        return tree.xpath(self.xpath + '/td[2]/font')[0].text

    def link(self):
        return tree.xpath(self.xpath + '/td[3]/font/a')[0].values()[0]

    def title(self):
        return tree.xpath(self.xpath + '/td[3]/font')[0].text_content()

    def votes(self):
        return tree.xpath(self.xpath + '/td[4]/font')[0].text

def main():
    conn = sqlite3.connect('top250.db')
    conn.execute("""DROP TABLE IF EXISTS movies""")
    conn.execute("""
        CREATE TABLE movies (
            id INTEGER PRIMARY KEY,
            title TEXT,
            link TEXT,
            rating TEXT,
            votes INTEGER
        )""")

    for n in xrange(1, 251):
        m = TopMovie(n)
        query = r'INSERT INTO movies VALUES (%d, "%s", "%s", "%s", "%s")' \
            % (n, m.title(), m.link(), m.rating(), m.votes().replace(',', ''))
        conn.execute(query)

    conn.commit()
    conn.close()

if __name__ == "__main__":
    main() 
```

# c# - 使用 LINQ（函数式编程）将列表减少为两个更小的列表

> ID：732514
> 
> 赞同：2
> 
> 时间：2009-04-09T01:54:21.967
> 
> 标签：c#, linq, functional-programming

嘿，伙计们，我正试图了解 LINQ 和 FP，如果这很幼稚，请原谅我。我正在尝试使用 LINQ 进行一些字符串解析并映射到一个函数，所以我需要将我的字符串拆分成更小的字符串。

我想将数组分成两个较小的列表。我可以使用 reduce (.Aggregate()) 来执行此操作吗？我试图弄清楚如何应用 reduce 来返回一个列表，但我没有任何运气。

我想要的是：

```
myString.ToCharArray().Take(2) 
```

映射到每个第二个元素。我无法在不将镜头应用于每个元素而不是每个第二个元素的情况下如何减少列表。

具体例子。

> 给定 (1, 2, 3, 4, 5, 6)
> 
> 我想要 ((1, 2), (3,4), (5, 6))

澄清：

> 给定“abcdef”
> 
> 我想要“ab”、“cd”、“ef”

为你们的帮助干杯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T02:09:25.987

```
Enumerable.Range(0, myString.Length)
      .GroupBy(index => index / 2, index => myString[index])
      .Select(eachGroup => new string(eachGroup.ToArray())); 
```

请注意，上面的示例依赖于您对集合具有基于索引的访问权限这一事实。要使其在`IEnumerable<T>`没有此限制的情况下适用于每个：

```
collection.Select((e,i) => new { Index = i, Element = e })
      .GroupBy(x => x.Index / 2, x => x.Element); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T02:11:57.760

这似乎不是您要寻找的方法，但这就是我所看到的：

```
Enumerable.Range(0, myString.Length - 1)
    .Where(i => i % 2 == 0)
    .Select(i => myString.Substring(i, 2).ToCharArray()); 
```

注意：我认为如果您有奇数个字符，子字符串可能会崩溃；可能必须添加一个检查并使用类似 (myString.Length % 2 == 0 ? 2 : 1) 的东西，但我还没有测试过。

第二个注意事项：对我来说，这里的困难在于您的 Reduce 实际上取决于数组索引而不是值；因此，我的解决方案是枚举数组索引并从那里开始工作。另一种解决方案是提供一种方法（我想不出内置的），该方法使用包含索引和字符的元组枚举字符串中的字符。

# c# - 将击键发送到另一个应用程序 C#

> ID：732521
> 
> 赞同：1
> 
> 时间：2009-04-09T02:00:41.780
> 
> 标签：c#, input

我需要自动化[FileMon.exe](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)以使用过滤器启动，保存它生成的日志，然后退出。

我的解决方案是编写一个辅助应用程序来完成所有这些工作。它已经开始使用指定的过滤器并终止进程，但我仍然需要它来保存日志。您认为发送应用程序击键来保存日志会很愚蠢吗？例如，我会发送 Alt+F、Alt+S，输入文件路径，回车。

如何将上述击键发送到在 C# 中运行的另一个进程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T02:04:56.467

据我所知，您必须调用一些本机 API：

-FindWindow 查找要使用的父窗口

-FindWindowEx 查找您将发送消息的真实窗口

-SendMessage 将击键发送到这些窗口

这些 API 的详细信息，请参阅 MSDN :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T02:10:05.190

您可以使用[`Windows.Forms.SendKeys`](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)将击键发送到活动应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T02:46:50.373

感谢所有的答案和帮助...我实际上将使用 Win32::GuiTest 编写和调用 perl 脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T02:09:24.053

这大概是个死胡同。您应该查看应用程序（或其依赖的 DLL 之一）是否公开了正确的 API 调用来执行您正在尝试执行的操作。如果您必须通过按键来完成，您可以查看某种宏程序，例如 MacorMaker。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T02:10:33.253

您可以使用 www.codeplex.com/wasp 上的 powershell 和 windows 自动化 cmdlet 来执行此操作。

-Oisin

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T02:20:39.767

使用[AHK（自动热键）](http://www.autohotkey.com/)之类的东西，它是一种可以编译为 EXE 的简单语言，旨在实现键盘和鼠标的自动化。

如果需要，IRC 频道和论坛也总是有人愿意提供帮助。

# java - 比较通用列表中的元素

> ID：732522
> 
> 赞同：1
> 
> 时间：2009-04-09T02:01:50.280
> 
> 标签：java, generics

今年早些时候，我为我的 java 类编写了一个链表实现。这是一个名为 LList 的通用类。我们现在必须写出一个实验室的归并排序算法。我没有创建一个采用 Ints 的新 List 实现，而是决定重用我之前创建的通用列表。

问题是如何比较两个通用对象？java不会让我做类似的事情

```
if(first.headNode.data > second.headNode.data) 
```

所以，我的问题是，他们是一种实现某种适用于任何类型数据的比较功能的方法吗？我尝试了以下方法：

```
 String one, two;
        one = first.headNode.data.toString();
        two = second.headNode.data.toString();
        if(first.headNode.data.compareTo(second.headNode.data) < 0) {
            result.add(first.headNode.data);
            // remove head node. remove() takes care of list size.
            first.remove(1);
        } else {
            // If compareTo returns 0 or higher, second.headNode is lower or
            // equal to first.headNode. So it's safe to update the result
            // list
            result.add(second.headNode.data);
            second.remove(1);
        } 
```

这甚至无法正常工作。我用数字 6 和 12 进行了测试，上面将 12 添加到结果列表中。

相关资料：

```
 private LList<T> mergeSort(LList<T> list) {
    LList<T> first = new LList();
    LList<T> second = new LList();
    if (list.length() == 1) {
        return list;
    }

    int middle = list.length() / 2;
    second.headNode = list.getNodeAt(middle + 1);
    second.length = list.length() - (middle);
    // Set first half to full list, then remove the "second" half.
    first.headNode = list.headNode;
    first.length = middle;
    first.getNodeAt(middle).next = null;

    // Get the splitted halves.
    first = mergeSort(first);
    second = mergeSort(second);
    return merge(first, second);
}

private LList<T> merge(LList<T> first, LList<T> second) {
    LList<T> result = new LList();

    while((first.length > 0) && (second.length > 0)) {
        // Ok, lets force toString to compare stuff since generics are a pain.
        String one, two;
        one = first.headNode.data.toString();
        two = second.headNode.data.toString();
        if(one.compareTo(two)) < 0) {
            result.add(first.headNode.data);
            // remove head node. remove() takes care of list size.
            first.remove(1);
        } else {
            // If compareTo returns 0 or higher, second.headNode is lower or
            // equal to first.headNode. So it's safe to update the result
            // list
            result.add(second.headNode.data);
            second.remove(1);
        }
    }
    return result;
} 
```

注意：可以找到整个 LList 类 [这里]( [http://rapidshare.com/files/219112739/LList.java.html](http://rapidshare.com/files/219112739/LList.java.html) MD5: BDA8217D0756CC171032FDBDE1539478)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T05:03:49.657

请注意，Comparable 也是一个泛型类型，由它可比较的类型参数化。在上面声明 mergeSort 函数的最通用、类型安全的方法是：

```
private <T extends Comparable<? super T>> LList<T> mergeSort(LList<T> list) { } 
```

这强制类型 T 的 compareTo 方法可以接受类型 T 的参数。（理论上，类型可以实现 Comparable，但不能与自身进行比较，例如`SomeClass implements Comparable<CompletelyDifferentClass>`，因此对 Comparable 的类型参数有要求很重要。然而，在实践中，任何设计良好的 Comparable 类至少应该与它自身具有可比性。）

我们要求这样做，`<T extends Comparable<? super T>>`而不是仅仅`<T extends Comparable<T>>`因为如果类型 T 的`compareTo`方法接受比 T 更通用的类型是可以的，因为它仍然能够接受类型 T 的参数。这很重要，因为如果你有一个类 A，它实现`Comparable<A>`；然后你有一个扩展A的子类B，B不能实现`Comparable<B>`，因为B已经实现`Comparable<A>`，继承自A，一个类不能两次实现一个接口。因此，如果我们`<T extends Comparable<T>>`在上面要求，B 将无法满足它，我们将无法对`LList<B>`对象进行排序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T02:10:44.843

查看[Comparator](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Comparator.html)和[Comparable](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Comparable.html)接口。

您的排序方法应该采用[Comparator](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Comparator.html)或者您应该指定 <T extends Comparable> 以便可以使用 Comparable 接口。

```
public void sort(Comparable<T> comparator) {
    sort(SortType.MERGE, comparator);
}
....
private LList<T> merge(LList<T> first, LList<T> second) {
    ...
        if(comparator.compare(first.headNode.data, second.headNode.data) < 0) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T02:11:41.957

好吧，正如您所发现的，您遇到了问题。关于列表中的对象，您所知道的只是它们是 Object 或其子类之一的实例。您不能真正对对象进行排序。您现在有几个选择：

你有一个选择是对完全没有意义的东西进行排序，比如对象的 hashCode。实际上，您可以使用 hashCode 实现一个完全有效的合并排序，但这在很大程度上是没有意义的，因为哈希码实际上并没有任何意义，而且除了学习排序之外，没有特殊的理由要按它进行排序。

这是一个更好的方法：更改通用列表的规则。现在，您列表中的所有内容都必须是某种东西。为什么不改变它，让它成为某种实现`Comparable`接口的东西呢？这样，除了如何比较它们之外，您不需要了解有关对象的任何信息。这在很大程度上是 Java 本身解决这个问题的方式。（我建议阅读它的收藏品）。

只需将您的对象从`LList<T>`to更改为`LList<T extends Comparable<T>>`您就可以开始了！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T02:09:56.407

您应该使用[Comparable](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Comparable.html)接口。

```
Comparable one = (Comparable)first.headNode.data;
Comparable two = (Comparable)second.headNode.data;

if(one.compareTo(two) < 0)
{
  ...
}
else
{
  ...
} 
```

请注意：这很草率。我没有检查 headNode.data 实际上是 Comparable 对象的任何地方。如果是这样的话，我们真的应该抛出一个异常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T03:21:33.787

在我制作的 C# 框架中对我有用的东西。为类型化对象创建一个比较器对象，并使用反射来确定列表正在排序的属性的值。根据需要调整：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;

namespace BOCL
{
  /// <summary>
  /// Provides a comparer for collections of BOCL objects so they can be compared on any property
  /// </summary>
  /// <typeparam name="T">The type of BOCL object to compare</typeparam>
  public class BusinessBaseComparer<T> : IComparer<T> where T : BusinessBase<T>, new()
  {
    #region Constructors

    /// <summary>
    /// Provides a default constructor for the comparer
    /// </summary>
    protected BusinessBaseComparer()
    {
      //An instance of the business base comparer must be declared with at least one argument to be of any use
    }

    /// <summary>
    /// Build this comparer sorting on a particular property ascending
    /// </summary>
    /// <param name="property">The property on which the sort should be applied</param>
    public BusinessBaseComparer(PropertyDescriptor property)
    {
      m_SortProperty = property;
    }

    /// <summary>
    /// Build this comparer sorting on a particular property
    /// </summary>
    /// <param name="property">The property on which the sort should be applied</param>
    /// <param name="direction">The direction to which the sort should be applied</param>
    public BusinessBaseComparer(PropertyDescriptor property, ListSortDirection direction)
    {
      m_SortProperty = property;
      m_SortDirection = direction;
    }

    #endregion

    #region SortProperty

    private PropertyDescriptor m_SortProperty = null;

    /// <summary>
    /// The property on which the type is to be sorted. If the property is not found, the objects are deemed equal
    /// </summary>
    protected PropertyDescriptor SortProperty
    {
      get { return m_SortProperty; }
    }

    #endregion

    #region SortDirection

    private ListSortDirection m_SortDirection = ListSortDirection.Ascending;

    /// <summary>
    /// The direction in which the type is to be sorted
    /// </summary>
    protected ListSortDirection SortDirection
    {
      get { return m_SortDirection; }
    }

    #endregion

    #region IComparer<T> Members

    /// <summary>
    /// Performs comparison between to BOCL objects
    /// </summary>
    /// <param name="x">The first object to compare</param>
    /// <param name="y">The second object to compare</param>
    /// <returns>The result of the comparison</returns>
    public int Compare(T x, T y)
    {
      if (SortProperty == null)
        return 0; //we didn't find the property we were supposed to sort on

      //set up to get the value of the objects we are comparing against
      IComparable xValue = null;
      IComparable yValue = null;

      try
      {
        //now get the value for the x object and value for the y object
        //as something we can compare against
        xValue = (IComparable)SortProperty.GetValue(x);
        yValue = (IComparable)SortProperty.GetValue(y);

        //if either property came back null
        if (xValue == null || yValue == null)
          return 0; //treat them as the same
      }
      catch (InvalidCastException)
      {
        return 0; //ran into a proplem trying to convert the object into something we could compare against
      }

      if (SortDirection == ListSortDirection.Ascending)
        return xValue.CompareTo(yValue);
      else
        return yValue.CompareTo(xValue);
    }

    #endregion
  }
} 
```

# vba - Access 2007 中的 OnKeyUp 事件

> ID：732531
> 
> 赞同：0
> 
> 时间：2009-04-09T02:08:34.100
> 
> 标签：vba

我在 Access 表单中有一个文本框和一个标签。在文本框中键入的任何内容都需要在标签中反映/镜像，并且我必须对文本框使用 OnKeyUp 事件。我怎样才能做到这一点？这是一个家庭作业。我没有编程经验，这是我的第一堂编程课。到目前为止，我有这个：

```
Private Sub Text0_KeyUp(keycode As Integer, Shift As Integer)
    Label2 = Text0.Text.KeyUp
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T03:14:13.367

使用文本框的更改事件并在该事件中设置 Label2.Caption = Text0.Text。
当文本框的内容发生变化时，会发生 change 事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T16:25:48.583

与您的 KeyUp 函数内联。

```
Private Sub tbTextBox(KeyCode As Integer, Shift As Integer)
   Dim textBoxtext As String 

   textBoxtext = Me.tbTextBox.text 'put the textbox text in the string
   lbLabel = textBoxText 'put the text in the string to the label
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-22T20:24:46.583

试试这个，我在 Microsoft Access 2007 上为你测试过：

```
Private Sub Text0_KeyUp(keycode As Integer, Shift As Integer)
  Me.Label2.Caption = Me.Text0.Text
End Sub 
```

其中 Me 代表当前的 Form 对象。

# actionscript-3 - 在 AIR 的 HTML 组件中使用 Javascript 和图像

> ID：732546
> 
> 赞同：1
> 
> 时间：2009-04-09T02:11:25.827
> 
> 标签：actionscript-3, flex3, webkit, air

我在 AIR 的标准 HTML 组件中使用 Javascript 和 img 标记时遇到以下问题：

1- xml 文字中的 Javascript 会导致问题（即使它在这里显示使用它们：http: [//livedocs.adobe.com/flex/3/html/ProgrammingHTMLAndJavaScript_07.html#1032824](http://livedocs.adobe.com/flex/3/html/ProgrammingHTMLAndJavaScript_07.html#1032824)

2-使用`html.loadString(...<img src="/tmp/me.jpg" />...)`不显示图像。

3- 在 CDATA 标记中包装 Javascript 后，它仍然无法访问，并在尝试访问它时返回“无效函数”错误。

`html.load(file)`如果我将 html 保存到文件并加载它而不是尝试将其作为字符串读取，则第二个问题似乎消失了。有什么建议可以解决这些问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-23T21:30:45.697

我最终将文件保存到一个临时文件并使用`html.load(tempfile)`.

# c# - SharePoint Sites.ExportWeb 返回值

> ID：732551
> 
> 赞同：1
> 
> 时间：2009-04-09T02:14:26.647
> 
> 标签：c#, web-services, sharepoint

我正在使用 SharePoint 中的[Sites.ExportWeb](http://msdn.microsoft.com/en-us/library/sites.sites.exportweb.aspx)服务，并且已经达到了返回整数值的地步。

我的问题是我在任何地方都找不到任何关于这些返回值含义的文档！

我的 C# 代码如下，我得到的返回值为 5，但显然我需要知道所有可能的返回值是什么意思 :)

```
SitesWebReference.Sites siteservice = new SitesWebReference.Sites();
siteservice.Credentials = System.Net.CredentialCache.DefaultCredentials;

int ret = siteservice.ExportWeb("exportJob", source, "http://sharepoint/sites/MySite/Export", true, true, false, 1000); 
```

有谁知道或知道 ExportWeb 及其朋友 ImportWeb 的返回值究竟是什么意思？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T03:49:00.957

好的，我偶然发现了这个：http: [//msdn.microsoft.com/en-us/library/cc313065.aspx](http://msdn.microsoft.com/en-us/library/cc313065.aspx)

总结一下：

**导出WebResult**

```
1 - Pending // The operation is in progress
4 - InvalidExportUrl // The site specified in the webUrl is not accessible
5 - ExportFileNoAccess // The location specified in the dataPath is not accessible
6 - ExportWebNoAccess // The user does not have the open web permission and manage web permission in order to execute this operation successfully
7 - ExportError // An error other than the errors  listed in this table occurred during exporting the site
8 - UploadDataError // The content migration package file is not uploaded to the server successfully 
```

**导入网络结果**：

```
1 - Pending // The operation is in progress.  
2 - GenericError // An error other than the errors listed in this table occurred importing the site.  
4 - InvalidImportUrl // The site specified in the webUrl is not accessible.  
5 - ImportFileNoAccess // At least one location specified in dataFiles i s not accessible.  
6 - ImportWebNoAccess // The user has insufficient permission to import to  the location specified in webUrl. 
8 - ImportWebNotEmpty // The location specified by webUrl corresponds to an existing site  that is not a blank site.  
11 - LogFileNoAccess // The location specified by  logPath is not accessible. 
```

对不起，引号的代码视图，我在预览屏幕上有一个争论。

# asp.net - 数据列表 onclick 事件中的 Asp.Net 图像？是否可以？

> ID：732553
> 
> 赞同：0
> 
> 时间：2009-04-09T02:18:42.487
> 
> 标签：asp.net, image, onclick, extract, datalist

好的，我已经在这个画廊工作了一段时间，而且我不断收到一些小花絮。现在是完成它的时候了。我有一个数据列表，它绑定到一组 *.aspx 图像 url，其中包含通过 url 发送的缩略图 id。我现在需要实现一个 onclick 事件，当用户点击一张照片时，它会将他们带到实际的图片中。

示例 url:
(thumbnail) = ~/UserPages/Photo/GetThumbnail.aspx?id=7
(actualpic) = ~/UserPages/Photo/GetPhoto.aspx?id=7

我需要什么：我如何获得它以便每张照片都有一个 onclick 事件？我尝试将 onclick 添加到 imag src 但它没有用。这很困难，因为它不是实际的图像控件，它们存在于数据列表中。我还需要知道如何在被点击时提取缩略图 url，以便我可以获取 id 并重定向到实际图片。请帮忙！

```
<asp:DataList ID="dlImages" runat="server" 
    RepeatColumns="5" 
    RepeatDirection="Horizontal" 
    RepeatLayout="Flow">

    <ItemTemplate>
        <img src="<%# ResolveUrl((string)Container.DataItem) %>" />
    </ItemTemplate>

</asp:DataList> 
```

代码背后：

```
dlImages.DataSource = ImageUrls;
dlImages.DataBind(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T02:24:33.407

你能把它包装在`a`标签里吗？

```
<ItemTemplate>
    <a href="<%# ResolveUrl(String.Format("~/UserPages/Photo/GetPhoto.aspx?id={0}", Container.DataItem)) %>"><img src="<%# ResolveUrl(String.Format("~/UserPages/Photo/GetThumbnail.aspx?id={0}", Container.DataItem)) %>" /></a>
</ItemTemplate> 
```

这假设您`DataItem`只包含 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T02:27:40.187

尝试：

```
<ItemTemplate>
    <img src="<%# ResolveUrl((string)Container.DataItem) %>" onclick="doSomething(this)" />
</ItemTemplate> 
```

之后，您可以简单地实现一个 doSomething 函数，该函数从“this.src”中解析出 id 并用它做任何你想做的事情。

# ruby - 在哪些情况下会使用 Sinatra 或 Merb？

> ID：732560
> 
> 赞同：5
> 
> 时间：2009-04-09T02:23:11.257
> 
> 标签：ruby, sinatra, merb

我正在学习 Rails，对 Sinatra 和 Merb 知之甚少。我想知道您会在哪些情况下使用 Merb/Sinatra。

感谢您的反馈意见！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T02:43:24.767

Sinatra 是一个比 Rails 更小、更轻的框架。如果您想快速运行一些只发送几个 URL 并返回一些简单内容的东西，则使用它。看看[Sinatra 主页](http://www.sinatrarb.com/)；这就是启动和运行“Hello, World”所需的一切，而在 Rails 中，您需要生成整个项目结构、设置控制器和视图、设置路由等等（我没有花了一段时间写了一个 Rails 应用程序，所以我不知道“Hello, World”到底有多少步，但肯定比 Sinatra 多）。Sinatra 的依赖项也比 Rails 少得多，因此它更容易安装和运行。

我们正在使用 Sinatra 作为我们现在正在编写的一些 Web 客户端库的快速测试 Web 服务器。事实上，我们可以编写一个文件并将所有逻辑包含在该文件中，并且依赖项很少，这意味着与使用 Rails 应用程序相比，使用和运行我们的测试要容易得多。

Merb[正在被合并到 Rails](http://yehudakatz.com/2008/12/23/rails-and-merb-merge/)中，所以很快就不应该有任何理由使用其中一个。它最初被设计为比 Rails 更轻、更解耦；Rails 有更多内置假设，即您将使用 ActiveRecord。但是当他们合并两者时，他们以类似的方式将 Rails 解耦，所以如果你已经在学习 Rails，那么坚持下去并跟随它们的发展可能是值得的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T03:09:39.697

对于 Merb，我不能说太多，但 Sinatra 对于小型或轻量级解决方案非常有效。如果您不使用大量代码，或者不需要庞大的网站，您可以使用 Sinatra 编写一个非常有效的网站，速度可以达到 Rails 的两倍，也可以是 Rails 的两倍（我个人认为）。

Sinatra 也非常适合应用程序的零碎部分，例如统计数据包的前端。或类似[ErrCount](http://errcount.com/)的东西，它只是一个非常简单的计数器。

因此，在使用 Sinatra 时，请考虑轻量、快速和高度简单的 Web 应用程序（尽管复杂性是您的选择）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T10:40:44.307

事情的发展方式，很快就会成为一个没有实际意义的问题。

如前所述，Merb 2.0 和 Rails 3.0 将是同一回事。新合并的 Merb 和 Rails 核心团队已经在努力实现这一目标。我不知道他们是否还计划在 5 月由 RailsConf 发布（可能是测试版），但今年肯定会发生。

例如，如果您不喜欢使用 ActiveRecord 以外的 ORM，那么您现在可以从 Merb 开始，并在 2.0 (Rails 3.0) 发布时进行更新。目前，Merb 被普遍接受为比 Rails 提供更好的框架来改变组件。

Sinatra 看起来像是一个出色的 Web 应用程序解决方案，它具有较低的界面复杂性和比正常的 Merb/Rails 更低的模型级代码。实现简单的 RESTful API 将是一个很好的用途。当涉及到任何数量的 HTML 时，我不太相信它的价值，在涉及到模板时更是如此。

同样，Rails（以及即将推出的 Merb）现在位于 Rack 之上，没有理由不将婴儿 Sinatra 应用程序包含到解决方案中：它们可以一起生活。有[一篇博客文章讨论了这个概念](http://atmos.org/index.php/2009/03/23/hancock-client-rails-using-sinatrarack-middleware-in-rails/)

# php - 为什么使用 mysql 准备好的语句比使用常见的转义函数更安全？

> ID：732561
> 
> 赞同：29
> 
> 时间：2009-04-09T02:24:05.203
> 
> 标签：php, mysql, security, sql-injection, prepared-statement

另一个问题中有一条评论如下：

> “当涉及到数据库查询时，请始终尝试使用准备好的参数化查询。mysqli 和 PDO 库支持这一点。这比使用 mysql_real_escape_string 等转义函数要安全得多。”

[来源](https://stackoverflow.com/revisions/110576/list "来源")

所以，我想问的是：为什么准备好的参数化查询更安全？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-09T03:07:11.417

我认为这里的人们缺少的重要一点是，使用支持参数化查询的数据库，无需担心“转义”。数据库引擎不会将绑定的变量组合到 SQL 语句中，然后解析整个事情；绑定的变量是分开的，永远不会被解析为通用 SQL 语句。

这就是安全性和速度的来源。数据库引擎知道占位符仅包含数据，因此它永远不会被解析为完整的 SQL 语句。当您准备一条语句然后多次执行它时，速度就会提高；将多条记录插入同一个表的规范示例。在这种情况下，数据库引擎只需要解析、优化等一次。

现在，一个问题是数据库抽象库。他们有时会通过将绑定变量插入到带有适当转义的 SQL 语句中来伪造它。不过，这比自己做要好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-09T02:28:42.320

一方面，您将危险字符的转义留给数据库，这比您人类安全得多。

...它不会忘记逃跑，或错过任何可用于注入恶意 SQL 的特殊字符。更不用说，您可能会在启动时获得性能提升！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-09T02:39:54.867

我对安全性不是很精通，但这里有一个解释，希望对您有所帮助：

假设您有如下声明：

从 mydb 中选择 [整数]

假装当你准备它时，语句在我们想象的 sql 实现中被编译成字节。

```
 01                  00 00                  23
Opcode for select          Prepared bytes      number of "mydb"
                          for your integer 
```

现在，当您执行时，您会将数字插入为准备好的语句保留的空间中。

比较一下，如果你只是使用转义，你可能会在其中插入尽可能多的乱码，并可能导致内存溢出，或者他们忘记转义的一些奇怪的 sql 命令。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T02:40:44.990

因为使用准备好的语句，您不能忘记转义内容。所以没有办法引入不安全感。

如果您记得每次调用 mysql_query 时都使用 mysql_real_escape_string，则 mysql_real_escape_string 与准备好的语句一样安全，但很容易忘记。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-09T07:35:38.997

准备好的语句解决了单纯的数据清理[无法解决的应用程序安全性问题](https://paragonie.com/blog/2015/08/gentle-introduction-application-security)：它们导致*数据和指令的完全分离*。当两者混淆时，结果就是不安全。这适用于 SQL 注入和缓冲区溢出。

（还有其他不安全的方法。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T02:39:51.607

最好的情况可能不是，但至少同样安全；为什么要冒险？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T02:45:01.330

[由于此漏洞http://shiflett.org/blog/2006/jan/addslashes-versus-mysql-real-escape-string](http://shiflett.org/blog/2006/jan/addslashes-versus-mysql-real-escape-string)，该函数不安全。这就是为什么首选准备好的语句并且它也可以提高性能的原因。

# c# - 您如何以编程方式找到 Vista 的“已保存游戏”文件夹？

> ID：732562
> 
> 赞同：2
> 
> 时间：2009-04-09T02:24:16.527
> 
> 标签：c#, .net, xna

我正在使用 XNA，我想将文件保存到 Vista 的“已保存游戏”文件夹中。

我可以获得类似的特殊文件夹，例如 My Documents ，`Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)`但我找不到 Saved Games 文件夹的等效文件夹。我如何进入这个文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T02:49:48.823

[http://msdn.microsoft.com/en-us/library/bb200105.aspx#ID2EWD](http://msdn.microsoft.com/en-us/library/bb200105.aspx#ID2EWD)

看起来你需要使用 Microsoft.Xna.Framework.Storage 和 StorageLocation 类来做你需要做的事情。

> 目前，PC 上的标题位置是可执行文件在运行时所在的文件夹。使用 TitleLocation 属性访问路径。
> 
> 用户存储在当前登录用户的 My Documents 文件夹中，在 SavedGames 文件夹中。根据传递给 OpenContainer 方法的 titleName 为每个游戏创建一个子文件夹。未指定 PlayerIndex 时，内容将保存在 AllPlayers 文件夹中。指定 PlayerIndex 时，内容将保存在 Player1、Player2、Player3 或 Player4 文件夹中，具体取决于传递给 BeginShowStorageDeviceSelector 的 PlayerIndex。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T02:49:29.697

没有特殊的文件夹 const ，所以只需使用系统变量。根据这篇维基百科文章[Special Folders](http://en.wikipedia.org/wiki/Special_Folders)，保存的游戏文件夹只是：

已保存的游戏 %USERPROFILE%\已保存的游戏 Vista

所以代码是：

```
 string sgPath = System.IO.Path.Combine(Environment.GetEnvironmentVariable("USERPROFILE"), "saved games")); 
```

...

编辑：如果根据评论，本地化是一个问题，并且根据您的问题，您仍然希望直接访问 Saved Games 文件夹而不是使用 API，那么以下内容可能会有所帮助。

使用 RedGate 反射器我们可以看到 GetFolderPath 的实现如下：

```
public static string GetFolderPath(SpecialFolder folder)
{
    if (!Enum.IsDefined(typeof(SpecialFolder), folder))
    {
        throw new ArgumentException(string.Format(CultureInfo.CurrentCulture, GetResourceString("Arg_EnumIllegalVal"), new object[] { (int) folder }));
    }
    StringBuilder lpszPath = new StringBuilder(260);
    Win32Native.SHGetFolderPath(IntPtr.Zero, (int) folder, IntPtr.Zero, 0, lpszPath);
    string path = lpszPath.ToString();
    new FileIOPermission(FileIOPermissionAccess.PathDiscovery, path).Demand();
    return path;
} 
```

所以也许你认为我需要的只是创建我自己的这个方法版本，并将保存游戏的文件夹 id 传递给它。那是行不通的。Vista之前的那些文件夹ID实际上是CSIDL。可以在[此处](http://msdn.microsoft.com/en-us/library/bb762494.aspx)找到它们的列表。注意*注意：*然而。

在发布 Vista 时，Microsoft 将 CLSIDL 替换为 KNOWNFOLDERID。可以在[此处](http://msdn.microsoft.com/en-us/library/bb762584(VS.85).aspx)找到 KNOWNFOLDERID 列表。保存的游戏 KNOWNFOLDERID 是 FOLDERID_SavedGames。

但是您不只是将新的 const 传递给旧的、基于 CLSIDL 的 SHGetFolderPath Win32 函数。根据这篇文章[Known Folders](http://msdn.microsoft.com/en-us/library/bb776911(VS.85).aspx)，正如您所料，有一个名为[SHGetKnownFolderPath](http://msdn.microsoft.com/en-us/library/bb762188(VS.85).aspx)的新函数，您可以将新的 FOLDERID_SavedGames 常量传递给该函数，该函数将以本地化形式返回 Saved Games 文件夹的路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-15T00:37:59.423

我发现获取已保存游戏路径的最简单方法是读取注册表值，如下所示：

```
var defaultPath = Path.Combine(Environment.GetEnvironmentVariable("USERPROFILE"), "Saved Games");
var regKey = "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders";
var regKeyValue = "{4C5C32FF-BB9D-43b0-B5B4-2D72E54EAAA4}";
var regValue = (string) Registry.GetValue(regKey, regKeyValue, defaultPath); 
```

我通过 Shell 多次更改了已保存游戏的位置，并且每次都更改了此键的值。我使用 USERPROFILE/Saved Games 作为默认设置，因为我认为这适用于有人从未更改过位置的默认情况。

# django - 为什么我在本地上传产品图片时会在 Satchmo 中获得绝对 URL？

> ID：732563
> 
> 赞同：0
> 
> 时间：2009-04-09T02:24:18.697
> 
> 标签：django, settings, relative-path, absolute-path, satchmo

我正在使用 Django 和 Satchmo 进行一些本地开发。当我通过管理员在本地上传产品图像时，图像的路径显示为绝对路径，包含驱动器号，而不是正确的相对路径。

更奇怪的是，Satchmo 将原始图像和它生成的缩略图都保存在我的`/media/`目录和`/media/images/`目录中，后者是我*希望*它们去的地方。

相关设置如下：

```
# path relative to the settings.py file
DIRNAME = os.path.abspath(os.path.dirname(__file__).decode('utf-8'))

MEDIA_ROOT = os.path.join(DIRNAME, 'media')
MEDIA_URL = 'http://localhost:8000/'
ADMIN_MEDIA_PREFIX = '/media/' 
```

我已经三次检查了 local_settings.py 文件，其中任何地方都没有提到“媒体”这个词，所以我确定没有设置覆盖。

如果有帮助，我在 Windows 上，但我正在为我的路径使用所有正确的 unix 表示法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T16:10:00.293

这是一个仅限 Windows 的错误。我正在 Windows 上开发一个 Satchmo 应用程序，它可以做到这一点，但是当我在 Linux 机器上部署时它工作得很好。当我在我的 Windows 机器上进行测试时，我只是进入数据库并在那里编辑路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T00:00:29.437

原来问题是settings.py文件中的斜线方向问题。

通常，我在我的 settings.py 文件中创建一个`relative_path()`函数，以便我可以轻松设置：

```
MEDIA_ROOT = absolute_path('media') 
```

我使用的 Satchmo 版本鼓励使用 DIRNAME 设置：

```
DIRNAME = os.path.abspath(os.path.dirname(__file__).decode('utf-8') 
```

问题是，使用这种技术，我的 MEDIA_ROOT 被设置为：

```
MEDIA_ROOT = os.path.join(DIRNAME, 'media') 
```

但这是使用 Windows 反斜杠而不是 Unix 正斜杠。我已经解决了：

```
MEDIA_ROOT = os.path.join(DIRNAME, 'media').replace('\\', '/') 
```

# java - 我可以在 Google App Engine 应用程序中使用 facelets 吗？

> ID：732565
> 
> 赞同：3
> 
> 时间：2009-04-09T02:24:44.593
> 
> 标签：java, google-app-engine, facelets

我想做更多关于facelets的学习。既然 Java 是受支持的 Google 应用引擎语言，那么 facelets 实现中是否有任何内容会阻止在 App Engine 上使用？

编辑：[谷歌的这个页面](http://groups.google.com/group/google-appengine-java/web/will-it-play-in-app-engine?hl=en)现在列出了各种框架及其与 App Engine 相关的状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-16T14:39:21.463

JSF 的 1.2 版本不工作 - 因为默认情况下它会尝试生成线程。这在 GAE 中是不允许的。

这已在最新版本的 JSF 1.2（内部版本 13）以及 2.0 Beta 2 版本中得到修复 - 您可以从此处下载最新版本：http: [//javaserverfaces.java.net/](http://javaserverfaces.java.net/)

您需要将上下文参数添加到 web.xml：

com.sun.faces.enableMultiThreadedStartup 默认为 true。部署到 GAE 时必须将此选项设置为 false。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T10:00:55.213

我还没有尝试过，但我认为它与使用 Struts 或 Spring 没有什么不同。只要您可以使用 WAR 中需要的所有 JAR 进行部署，它就应该可以工作。

唯一的问题是 JPA 或 JDO 是否足够。如果 facelets 需要任何其他持久性机制，您可能会遇到问题。

JMS 也不可用，因此依赖它的功能无法工作。

第一次访问是不是有限制？前 10,000 人进入？

# c# - 如何在 C# 中创建关键字/类型？

> ID：732566
> 
> 赞同：4
> 
> 时间：2009-04-09T02:25:33.203
> 
> 标签：c#, types, typedef

### 复制

> [C# 中的类型定义？](https://stackoverflow.com/questions/161477/typedef-in-c)

* * *

有没有办法在 C# 中创建实际的关键字。例如将对象 x 转换为 int 之类的数据类型？我想我在问是否有类似 C# 的 typedef 之类的东西，如果没有，我如何才能真正创建自己的类型，如下所示：

```
public static crap Main(string[] args)
{
    // Note 'crap' and not 'void'!
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-09T02:33:49.017

您可以为 Int32 或 String 等类创建同义词，但不能为 int 或 void 创建同义词，因为它们是关键字。语法如下所示：

```
 using foo = System.Int32; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T02:29:13.240

C# 有意不提供 C/C++ 风格的宏（使用`#define`）。你不能发明这些语言特性并将语言扩展到类型之外。他们有充分的理由忽略此功能。如果你真的需要这些特性，你总是可以通过 C 预处理器运行 C# 源文件，并使用 C# 编译器编译生成的文件。您还可以依赖您的环境提供的其他模板功能（很可能是[Visual Studio T4 引擎](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)）。

# c# - 使用 LINQ to SQL 的 .NET 架构的最佳设计实践（需要 DAL？我们真的可以使用 POCO吗？要采用的设计模式？）

> ID：732573
> 
> 赞同：9
> 
> 时间：2009-04-09T02:28:52.680
> 
> 标签：c#, .net, linq-to-sql, design-patterns, architecture

我避免在 .net 架构/n 层架构上编写看起来像是另一个线程的内容，但请耐心等待。

鉴于当今的趋势和新兴技术，在选择用于企业应用程序的架构时，我希望像其他人一样仍然不是 100% 满意或明确采取的最佳方法。

我想我正在就您在利用当今 .NET 技术的大多数方面构建企业应用程序时选择的方向和架构实现以及*您*将采取的方向寻求大众社区的意见。我最好对我和我的问题提出这个问题，否则会过于模糊；我想改进我的架构以改进，并且真的很想听听你们对我即将编写的技术列表的看法。

欢迎您建议的任何和所有最佳实践和架构模式，如果您之前已经为类似类型的设置创建了解决方案，那么您可能遇到或克服的任何陷阱或警告。

这是我最新项目中采用的技术列表，是的，几乎所有技术，除了 WPF :)

*   智能客户端（WinForms）
*   WCF
    *   *由智能客户端使用*
*   ASP.NET MVC
    *   *管理工具*
    *   *客户端工具*
*   LINQ 到 SQL
    *   *由 WCF 使用*
    *   *使用 ASP.NET MVC*
*   微软 SQL 服务器 2008

要考虑的实用程序和其他组件：

*   依赖注入 - StructureMap
*   异常管理 - 自定义
*   单元测试 - MBUnit

我目前在 n-Tier 拱门中运行。采用基于*服务的*设计模式，利用请求/响应（不确定它的正式名称）和存储库模式，我的大部分结构都是从[Rob Conery 的 Storefront](http://blog.wekeroad.com/mvc-storefront/)中采用的。

我想我对我的大多数等级或多或少都感到满意（这实际上只是我有点不安的 DAL）。

在我结束之前，这些是我在当前架构中面临的真正问题：

*   考虑到使用 LINQ to SQL，我是否应该有一个自定义数据访问层，我有一个很大的问号。我应该直接在我的服务/业务层还是在存储库方法中的 DAL 中执行 LINQ to SQL？您是否应该在每个存储库方法调用（使用 using()）中创建数据库上下文的新实例？还是类构造函数中的一个/通过DI？

*   您相信我们在使用 LINQ to SQL 时可以真正使用 POCO（普通旧 CLR 对象）吗？当我遇到问题时，我很想看到一些示例，并且它对于 WCF 工作会特别方便，因为我显然不能通过网络传输 L2S 对象。

*   自己创建一个 ASP.NET MVC 项目非常清楚地显示了您应该采用的设计模式，方法是将视图逻辑保留在视图中，控制器调用服务/业务方法，当然还有模型中的数据访问，但是您会放弃“模型”吗？ ' 对于较大的项目，特别是在共享数据访问的情况下，您会采取什么方法来获取数据？

感谢您听取我的意见，并希望看到有关架构的示例代码库及其拆分方式。如前所述，我已经看过 Storefront，我还没有真正经历过 Oxite，但我只是认为这对我自己和每个人都有好处。

***在 DAL 要点中添加了其他问题。/ 15:42 GMT+10***

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T02:38:46.353

要回答您的问题：

*   **我应该直接在我的服务/业务层还是在存储库方法中的 DAL 中执行 LINQ to SQL？**LINQ to SQL 仅在您的数据库与您的业务对象一对一映射时才有意义。在大多数企业情况下，情况并非如此，[实体](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)更合适。

    话虽如此，LINQ 通常非常适合直接在您的业务层中使用，因为 LINQ 提供程序（无论是 LINQ to SQL 还是其他）*是*您的 DAL。LINQ 的好处是它允许您在业务层中比`DAL.GetBusinessEntityById(id)`.同样的积极作用。

*   **您相信我们在使用 LINQ to SQL 时可以真正使用 POCO（普通旧 CLR 对象）吗？**如果没有关于 LINQ to SQL 的 POCO 问题的更具体信息，很难说。

*   **你会为大型项目放弃“模型”方面吗？**一般来说，MVC 模式远比从表面上看 ASP.NET MVC 可能暗示的要广泛得多。根据定义，无论您选择使用什么连接到应用程序中的数据支持，都将成为您的模型。如果使用 WCF 或 MQ 连接到企业数据云，那就这样吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T04:32:24.490

无论您是否使用 LINQ-to-SQL，通常都会为 WCF 之类的东西使用单独的 DTO 对象。我在这里引用了一些关于这个主题的想法：[Pragmatic LINQ](http://marcgravell.blogspot.com/2009/02/pragmatic-linq.html) - 但对我来说，最大的是：不要在存储库接口上暴露`IQueryable<T>`/ `Expression<...>`。如果你这样做了，你的存储库就不再是一个黑盒子，并且不能被孤立地测试，因为它是由调用者一时兴起的。同样，您不能单独分析/优化 DAL。

`IQueryable<T>`一个更大的问题是泄漏（[LOLA](http://www.joelonsoftware.com/articles/LeakyAbstractions.html) ）的事实。例如，实体框架不喜欢`Single()`，或者`Take()`没有明确的`OrderBy()`- 但 L2S 对此很好。L2S 应该是 DAL 的实现细节——它不应该*定义*存储库。

出于类似的原因，我将 L2S 关联属性标记为`internal`- 我可以在 DAL 中使用它们来创建有趣的查询，但是......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T02:36:33.440

当我查看 Rob Connery 的 Storefront 时，看起来他正在使用 POCO 和 Linq to SQL；但是，他是通过将 Linq 到 SQL 创建的实体转换为 POCO（并返回）来做到这一点的，这对我来说似乎有点愚蠢——本质上，我们有一个 DAL 用于 DAL。

但是，这似乎是将 POCO 与 Linq to SQL 一起使用的唯一方法。

我会说你应该使用存储库模式，让它隐藏你的 Linq to SQL 层（或者你最终用于数据访问的任何东西）。这并不意味着您不能在其他层中使用 Linq，只需确保您的存储库返回 IQueryable<T>。

# iphone - Objective C -std=c99 用法

> ID：732576
> 
> 赞同：1
> 
> 时间：2009-04-09T02:31:05.357
> 
> 标签：iphone, objective-c, cocoa

有什么理由不应该使用“-std=c99”标志在 Mac 上编译 Objective-C 程序？我真正喜欢的 C99 中的一个特性是能够在代码中的任何位置声明变量，而不仅仅是在方法的顶部，但是这个标志是否会导致任何问题或为 iPhone 或 Cocoa 应用程序创建不兼容性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T04:00:15.347

编译的 C99 二进制代码与旧的 C 变体二进制兼容。唯一的缺点是如果您必须与非 C99（或 GNU99）的其他项目共享代码。

这同样适用于 Objective-C

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T03:40:59.760

我自己在一个小的 iPhone 应用程序上尝试过，它可以工作。我没有看到它有任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-27T01:51:17.787

如果您的项目设置不允许您这样做，一个很好的方法是添加用户定义的设置。为此：

*   打开“项目 - > 编辑项目设置”菜单项。

*   在左下角，从下拉菜单中选择“添加用户定义的设置”

*   将左侧文本“新设置”替换为 GCC_C_LANGUAGE_STANDARD

*   将文本“c99”添加到该行的右侧

*   清理你的目标并重建！

# compression - 小 4 KB 文件的最佳压缩算法是什么？

> ID：732578
> 
> 赞同：17
> 
> 时间：2009-04-09T02:33:06.100
> 
> 标签：compression

我正在尝试压缩每个大小约为 4 KB 的 TCP 数据包。数据包可以包含任何字节（从 0 到 255）。我发现的所有压缩算法基准都是基于较大的文件。我没有找到任何可以比较不同算法对小文件的压缩比的东西，这正是我所需要的。我需要它是开源的，以便它可以在 C++ 上实现，例如没有 RAR。对于大小约为 4 KB 的小文件，可以推荐什么算法？[LZMA](http://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Markov_chain_algorithm) ? [HACC](http://www.chipstips.com/?p=124) ? [邮编](http://en.wikipedia.org/wiki/ZIP_%28file_format%29)？[压缩包](http://en.wikipedia.org/wiki/Gzip)？[压缩包2](http://en.wikipedia.org/wiki/Bzip2)？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-09T05:16:59.500

选择最快的算法，因为您可能关心实时执行此操作。通常对于较小的数据块，算法压缩大致相同（给或取几个字节），主要是因为除了有效负载之外，算法还需要传输字典或霍夫曼树。

出于多种原因，我强烈推荐 Deflate（zlib 和 Zip 使用）。该算法非常快，经过良好测试，获得 BSD 许可，并且是 Zip 需要支持的唯一压缩（根据 infozip Appnote）。除了基础之外，当它确定压缩比解压缩大小大时，有一个 STORE 模式，它只为每个数据块添加 5 个字节（最大块为 64k 字节）。除了 STORE 模式，Deflate 支持两种不同类型的 Huffman 表（或字典）：动态和固定。动态表意味着霍夫曼树作为压缩数据的一部分进行传输，并且是最灵活的（对于不同类型的非随机数据）。固定表的优点是所有解码器都知道该表，因此不需要包含在压缩流中。解压（或膨胀）代码相对容易。我已经直接基于 zlib 编写了 Java 和 Javascript 版本，它们的性能相当不错。

提到的其他压缩算法都有其优点。我更喜欢 Deflate，因为它在压缩步骤，特别是在解压缩步骤中的运行时性能。

澄清一点： Zip 不是压缩类型，它是一个容器。为了进行数据包压缩，我会绕过 Zip，只使用 zlib 提供的 deflate/inflate API。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-07-26T01:39:57.177

如果您想“压缩 TCP 数据包”，您可以考虑使用 RFC 标准技术。

*   [RFC1978](https://www.rfc-editor.org/rfc/rfc1978) PPP 预测压缩协议
*   [RFC2394](https://www.rfc-editor.org/rfc/rfc2394) IP 有效负载压缩使用 DEFLATE
*   [RFC2395](https://www.rfc-editor.org/rfc/rfc2395)使用 LZS 的 IP 有效负载压缩
*   [RFC3173](https://www.rfc-editor.org/rfc/rfc3173) IP 有效负载压缩协议 (IPComp)
*   [RFC3051](https://www.rfc-editor.org/rfc/rfc3051) IP Payload Compression Using ITU-T V.44 Packet Method
*   RFC5172 协商使用 IPv6 控制协议的 IPv6 数据报压缩
*   RFC5112 用于信令压缩的存在特定静态字典 (Sigcomp)
*   RFC3284 VCDIFF 通用差分和压缩数据格式
*   RFC2118 Microsoft 点对点压缩 (MPPC) 协议

我可能忽略了其他相关的 RFC。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-09-02T05:36:16.293

[![压缩 ASCII 消息散点图](https://i.stack.imgur.com/YNj3P.png)](https://i.stack.imgur.com/YNj3P.png)

这是 Rick 出色回答的后续行动，我对此表示赞同。不幸的是，我无法在评论中包含图片。

我遇到了这个问题，并决定尝试对 500 条大小从 6 到 340 字节不等的 ASCII 消息样本进行压缩。每条消息都是由环境监测系统生成的一小段数据，通过昂贵的（按字节付费）卫星链路传输。

最有趣的观察是，压缩后消息较小的交叉点*与生命、宇宙和一切的终极问题*相同：[42](https://en.wikipedia.org/wiki/42_(number))字节。

要在您自己的数据上尝试此操作，这里有一些 node.js 可以提供帮助：

```
const zlib = require('zlib')
const sprintf = require('sprintf-js').sprintf
const inflate_len = data_packet.length
const deflate_len = zlib.deflateRawSync(data_packet).length
const delta = +((inflate_len - deflate_len)/-inflate_len * 100).toFixed(0)
console.log(`inflated,deflated,delta(%)`)
console.log(sprintf(`%03i,%03i,%3i`, inflate_len, deflate_len, delta)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T02:37:16.263

所有这些算法都可以尝试。正如您所说，它们并未针对小文件进行优化，但您的下一步就是简单地尝试它们。测试压缩一些典型数据包并查看结果大小可能只需要 10 分钟。（也尝试不同的压缩标志）。从生成的文件中，您可能会挑选出最有效的工具。

您列出的候选人都是不错的第一次尝试。你也可以试试 bzip2。

当测试很容易进行时，有时简单的“全部尝试”是一个很好的解决方案。想太多有时会减慢你的速度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T03:01:00.263

我认为文件大小并不重要——如果我没记错的话，GIF 中的 LZW 每 4K 都会重置一次它的字典。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T03:03:15.483

ZLIB应该没问题。它用于 MCCP。

但是，如果您真的需要良好的压缩，我会分析常见模式并在客户端中包含它们的字典，这可以产生更高级别的压缩。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-09T03:51:05.133

我很幸运直接使用 zlib 压缩库而不使用任何文件容器。ZIP、RAR 有开销来存储文件名之类的东西。我已经看到以这种方式压缩产生了积极的结果（压缩小于原始大小），数据包低至 200 字节。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-23T15:41:29.373

您可以测试[bicom](http://www3.sympatico.ca/mt0000/bicom/bicom.html)。该算法禁止用于商业用途。如果您希望它用于专业或商业用途，请查看“范围编码算法”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-18T13:50:22.423

您可以尝试[增量压缩](http://en.wikipedia.org/wiki/Delta_encoding)。压缩将取决于您的数据。如果您对有效负载进行了任何封装，则可以压缩标头。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2009-04-09T03:38:37.020

我做了 Arno Setagaya 在他的回答中提出的建议：做了一些样本测试并比较了结果。

压缩测试使用 5 个文件完成，每个文件大小为 4096 字节。这 5 个文件中的每个字节都是随机生成的。

重要提示：在现实生活中，数据不可能都是随机的，但往往会有一些安静的重复字节。因此，在实际应用中，压缩往往会比以下结果好一点。

注意： 5 个文件中的每一个都是单独压缩的（即不与其他 4 个文件一起压缩，这样压缩效果会更好）。在下面的结果中，为了简单起见，我只使用了 5 个文件大小的总和。

我包含 RAR 只是为了比较，即使它不是开源的。

结果：（从最好到最差）

LZOP：20775 / 20480 * 100 = 原始大小的 101.44%

RAR：20825 / 20480 * 100 = 原始大小的 101.68%

LZMA：20827 / 20480 * 100 = 原始尺寸的 101.69%

邮编：21020 / 20480 * 100 = 原始大小的 102.64%

BZIP：22899 / 20480 * 100 = 原始大小的 111.81%

结论：令我惊讶的是，所有经过测试的算法都产生了比原始算法更大的尺寸！！！我猜它们只适用于压缩较大的文件，或者有很多重复字节的文件（不是像上面那样的随机数据）。因此，我不会对我的 TCP 数据包使用任何类型的压缩。也许这些信息对考虑压缩小块数据的其他人有用。

编辑：我忘了提到我为每个算法使用了默认选项（标志）。

# php - 使用 PHP 将多个 XML 提要解析为一个排序数组

> ID：732582
> 
> 赞同：3
> 
> 时间：2009-04-09T02:34:47.750
> 
> 标签：php, xml, arrays

我想创建一个看起来像的可排序列表

*   $VAR1[0]、$VAR2[0]...
*   $VAR1[1]、$VAR2[1]...

数据来自多个相同的结构化 xml 文件：

```
$xmlfile="
<Level1>
 <Level2>
  <Level2Item VAR1="1" VAR2="2" ... />
  <Level2Item VAR1="4" VAR2="5" ... />
  <Level2Item VAR1="7" VAR2="8" ... />
 </Level2>
</Level1>";

//Extract each item
$xml = new SimpleXMLElement($xmlfile);
foreach ($xml->Level2[0] as $result) {
 array_push($VAR1Array, $result['VAR1']);
 array_push($VAR2Array, $result['VAR2']);
 //... etc etc
}
//sort
//$sortedArray = sort($VAR1Array); 
```

输出

```
Array(
  [0] => SimpleXMLElement Object([0] => 1)
  [1] => SimpleXMLElement Object([0] => 4)
  [2] => SimpleXMLElement Object([0] => 7)
) 
```

根据这种 XML 结构，将数据存储在一个数组中的最佳方式是什么？我希望能够将所有数据收集到一个数组中，这样我就可以按一个或 2 个 VAR 对其进行排序并显示结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T17:14:27.433

我不太确定您要进行哪种排序（您应该指定一些示例）。但最佳情况下，您不会将 XML 片段加载到您的数组中。

```
$xmlfile="
<Level1>
 <Level2>
  <Level2Item VAR1="1" VAR2="2" ... />
  <Level2Item VAR1="4" VAR2="5" ... />
  <Level2Item VAR1="7" VAR2="8" ... />
 </Level2>
</Level1>";

//Extract each item
$xml = new SimpleXMLElement($xmlfile);
foreach ($xml->Level2[0] as $result) {
 $VAR1Array[] = (int) $result['VAR1'];
 $VAR2Array[] = (int) $result['VAR2'];
 //... etc etc
} 
```

最后，`sort()`通过引用工作，所以不要把它等同于一个变量（即只是说`sort($array);`整行，然后`$array`将被排序。如果你`int`像我在上面的例子中那样转换为 s 你可以使用 php 的默认排序函数而不像其他人建议的那样使用用户定义的比较函数。并且`array_push`比使用php的`$var[]`语法向数组添加新元素要慢一些且难以阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-08T23:41:04.363

另外，我完全确定您不能以这种方式分配 $xmlfile （在双引号内创建未转义的双引号。

在此代码中，定义 $xmlfile 的最佳方法是：

```
$xmlfile = <<<XML
<Level1>
 <Level2>
  <Level2Item VAR1="1" VAR2="2" ... />
  <Level2Item VAR1="4" VAR2="5" ... />
  <Level2Item VAR1="7" VAR2="8" ... />
 </Level2>
</Level1>
XML; 
```

或者

```
$xmlfile = '
<Level1>
 <Level2>
  <Level2Item VAR1="1" VAR2="2" ... />
  <Level2Item VAR1="4" VAR2="5" ... />
  <Level2Item VAR1="7" VAR2="8" ... />
 </Level2>
</Level1>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T02:55:04.410

如果我是你，我只需将所有 SimpleXMLElements 推送到一个数组中，然后使用带有自定义回调函数的 uasort() 来根据需要进行排序。那样有用吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T12:52:55.580

```
$xml = simplexml_load_file(...);

$table = array();
foreach ($xml->Level2[0] as $result)
    $table[] = $result->attributes();

function cmp_row($a, $b, $sortColumn)
{
    if ($a == $b)
        return 0;

    return ($a < $b) ? -1 : 1;
}

$sortColumn = 'VAR1'; // make sure it's a clean string

uasort($table, create_function('$a,$b', 'return cmp_row($a, $b, "'.$sortColumn.'")')); 
```

如果需要，您还可以保留 SimpleXMLElements 并直接对它们进行排序，就像 apinstein 说的那样。

# asp.net-mvc - 使用 jQuery.post 将多个参数发布到 MVC 控制器

> ID：732585
> 
> 赞同：6
> 
> 时间：2009-04-09T02:37:10.007
> 
> 标签：asp.net-mvc, jquery

我有一个控制器定义为：

```
        [AcceptVerbs(HttpVerbs.Post)]
        public JsonResult PostMoreData（DataContracts.Address 地址，DataContracts.GeoLocation geoLocation）
        {
            返回 Json("测试");
        }

其中 DataContracts.Address 和 DataContracts.GeoLocation 是复杂类型。

```

从我的观点来看，我正在尝试使用 jQuery 进行发布：

```
        函数 PostMoreData() {

            var JsonAddress = {

                "建筑": $('建筑').val(),
                "UnitNumber": $('UnitNumber').val(),
                "街道编号": $('街道编号').val(),
                "街名": $('街名').val(),
                "StreetType": $('StreetType').val(),
                “郊区”：$（'郊区'）.val（），
                "状态": $('State').val(),
                "邮编": $('邮编').val(),
                "MonthsAtAddress": $('MonthsAtAddress').val()

            };

            var JsonGeoLocation = {
                "纬度": $('纬度').val(),
                "经度": $('经度').val()
            };

            jQuery.post("/AddressValidation/PostMoreData", {address: JsonAddress, geoLocation: JsonGeoLocation}, function(data, textStatus) {
                if (textStatus == "成功") {
                    var 结果 = 评估（数据）；
                    if (result.length > 0) {
                        警报（结果）；
                    }
                }
            }, "json");
        }

```

但是，在控制器上，我得到空值。

* * *

如果我的控制器只接受 1 个参数并且我只发布一个对象，它就可以工作。

```
        [AcceptVerbs(HttpVerbs.Post)]
        public JsonResult PostMoreData(DataContracts.Address 地址)
        {
            返回 Json("测试");
        }

```

```
        函数 PostMoreData() {

            var JsonAddress = {

                "建筑": $('建筑').val(),
                "UnitNumber": $('UnitNumber').val(),
                "街道编号": $('街道编号').val(),
                "街名": $('街名').val(),
                "StreetType": $('StreetType').val(),
                “郊区”：$（'郊区'）.val（），
                "状态": $('State').val(),
                "邮编": $('邮编').val(),
                "MonthsAtAddress": $('MonthsAtAddress').val()

            };

            jQuery.post("/AddressValidation/PostMoreData", JsonAddress, function(data, textStatus) {
                if (textStatus == "成功") {
                    var 结果 = 评估（数据）；
                    if (result.length > 0) {
                        警报（结果）；
                    }
                }
            }, "json");
        }

```

有什么想法可以发布多个对象吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-11T09:59:34.753

请注意，无论您的控制器做什么，jQuery 在这里执行的“默认序列化”都不会起作用。jQuery 不会“遍历”第一级以下的参数映射，因此问题中的示例可能会生成此帖子数据：

```
address=[object]&geoLocation=[object] 
```

另一个工作示例不包含任何子对象，因此它被直接翻译，如下所示：

```
Building=value&UnitNumber=value&...&MonthsAtAddress=value 
```

最简单的解决方法是使参数映射平面化，每个键都以“地址”为前缀。或“地理位置”，具体取决于。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-02T00:25:39.097

感谢大家对此问题的意见。

在这个阶段，我们已经不再使用 jquery 将复杂类型发布到控制器。相反，我们使用 ms ajax 框架来做到这一点。ms ajax post 很好地自动绑定了复杂类型。

所以我们的解决方案现在混合使用 jquery 和 ms ajax 框架。

灰

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T05:51:30.460

您的代码要求 jquery 序列化对象的方式与 MVC 默认模型绑定器兼容，我认为这不太可能。

如果您可以构建您的 javascript 对象，使其序列化为具有点符号 (JsonAddress.Building) 的平面对象，那么您可以让 jquery 进行默认序列化，然后创建自定义模型绑定器以反序列化为操作参数类型.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-30T21:37:16.017

我有同样的问题，无法得到任何工作。也有人将它作为 jquery 的 bug 提出来，他们将其关闭为不是 bug。

我找到了一些解决方案，可以回答整个问题的一部分。答案包括以下内容。

1）客户端：我们需要对您需要发送的所有对象进行字符串化。这可以是普通对象或数组。它适用于两者。

2）客户端：您像在第一篇文章中一样发送数据。正如你会逐个反对。

提示：当您发送参数化对象时，jquery 会对发送到服务器的数据进行编码。

以下都是服务器端实现 1) Deserializer 类：它将获取输入字符串并将其放回 object/list<>/IList<> 您定义为控制器函数参数的数据类型的任何内容。您需要为上述实现 ActionFilterAttribute 。

2）最后为控制器函数添加一个属性，以便它使用反序列化器类来获取参数。

由于这是相当多的代码，如果您需要详细信息或解决了问题，请告诉我。

迪帕克·乔拉

# eclipse - 验证插件内的模式

> ID：732588
> 
> 赞同：1
> 
> 时间：2009-04-09T02:37:40.317
> 
> 标签：eclipse, validation, plugins, schema

背景：

我对 Eclipse 有一个小问题。我正在开发一个工作台插件，它有一些类可以根据模式验证传入的 XML 数据。架构位于插件项目中的“./schemas”文件夹中。

问题：

1.  当我运行应用程序时，如何在不使用硬编码路径的情况下读取架构？
2.  部署应用程序时，模式将需要存在于插件 .jar 中。在这种情况下，（1）的解决方案会有所不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T14:50:45.440

您可以使用 org.eclipse.core.runtime 中的 FileLocator 类来获取包中资源的 URL。

例如，像

```
URL schema = FileLocator.find(myBundle, new Path("/schemas/data.xsd"), null); 
```

您可以从传递给您的 Activator 的 BundleContext 获取您的 Bundle 对象（如果您有的话）。或者你可以使用 Platform.getBundle。

您不应该假设 url 是磁盘上的文件，尤其是插件是 jar 的情况。您可以使用 URL.openStream 获取内容，或使用 FileLocator.toFileURL() 获取磁盘上的文件。

# mysql - 大量写入，但很少读取 - 使用什么 Mysql 存储引擎？

> ID：732596
> 
> 赞同：2
> 
> 时间：2009-04-09T02:44:14.483
> 
> 标签：mysql, database, storage

我想知道是否有人对使用哪种存储引擎有建议。程序需要对数据库执行大量写入，但读取很少。

[编辑] 不需要外键。数据很简单，但它需要非常快速地执行写入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T02:54:22.930

从[jpipes](http://jpipes.com/index.php?/archives/180-Correction-on-Concurrent-Insert-for-MyISAM.html)：

> MyISAM 和表级锁
> 
> 与采用行级锁定的 InnoDB 不同，MyISAM 使用更粗粒度的锁定系统来确保数据以受保护的方式写入数据文件。表级锁定是 MyISAM 的唯一锁定级别，这有几个后果：
> 
> *   任何对 MyISAM 表发出 UPDATE 或 DELETE 的连接都将请求对 MyISAM 表的排他写锁。如果当前没有在表上放置其他锁（读或写），则授予独占写锁，并且所有其他发出任何类型（DDL、SELECT、UPDATE、INSERT、DELETE）请求的连接必须等到具有独占写锁的线程写锁更新它需要的记录，然后释放写锁。
> *   由于只有表级锁，因此无法（像 InnoDB 那样）只锁定一个或一小组记录，从而允许其他线程从表数据的其他部分进行 SELECT。

关键是，对于编写而言，InnoDB 更好，因为它会锁定更少的资源并允许发生更多的并行操作/请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T05:54:25.520

“它需要非常快地执行写入”是一个模糊的要求。无论您做什么，写入都可能因数据库中的争用而延迟。如果您的应用程序在将审计记录写入数据库时​​不需要阻塞，您应该使审计写入异步并将您自己的审计数据队列保留在磁盘或内存中（这样您就不会阻塞主工作线程/进程）

InnoDB 可能允许并发插入，但这并不意味着它们不会被资源争用或索引页等内部锁阻塞。

MyISAM 在以下情况下允许一个插入器和多个读取器（“并发插入”）：

*   桌子上没有“洞”
*   没有线程尝试执行 UPDATE 或 DELETE

如果您有一个仅附加表，并且您每天都重新创建它（或者如果您使用 5.1 分区，则每天都创建一个新分区），您可能会侥幸成功。

MyISAM 并发插入大多非常好，如果您可以使用它们。

编写审计记录时，如果可能，一次执行多个 - 这适用于您使用的任何存储引擎。审计过程“批量”记录并一次插入多个记录是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T02:54:37.220

您还没有真正向我们提供足够的信息来提出深思熟虑的建议 - 您想使用外键吗？行级锁定？页面级锁定？交易？

作为一般规则，如果你想使用事务，InnoDB/BerkeleyDB。如果你不这样做，MyISAM。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T02:58:38.833

根据我的经验，MyISAM 非常适合快速写入，只要插入后它是只读的。它会比我熟悉的任何其他选项（包括支持索引）更快地追加。

但是，一旦您开始删除记录或更新索引键，并且需要重新填充空洞（在表或索引中），讨论就会变得更加复杂。

但是，对于经典的日志类型或日志类型的表，它非常高兴。

# c++ - 为什么以下程序在使用 g++ 编译时会慢 15%？

> ID：732602
> 
> 赞同：3
> 
> 时间：2009-04-09T02:48:37.937
> 
> 标签：c++, c, performance

**更新：**为我的编译请求提供服务的编译框的实际分辨率不同。在较慢的情况下，我运行的是在 SuSE 9 上编译的代码，但在 SuSE 10 机器上运行。这足以让我放弃它并将苹果与苹果进行比较。当使用相同的编译框时，结果如下：

g++ 慢了大约 2%

delta real 4 分钟 delta user 4 mintues delta system 5 seconds

谢谢！

gcc v4.3 vs g++ v4.3 简化为最简单的情况，只使用简单的标志

```
#include <stdio.h>
#include <stdlib.h>
int main (int argc, char **argv)
{
    int i=0;
    int j=0;
    int k=0;
    int m=0;
    int n=0;
    for (i=0;i<1000;i++)
        for (j=0;j<6000;j++)
            for (k=0;k<12000;k++)
            {
                 m = i+j+k;
                 n=(m+1+1);
            }
    return 0;
} 
```

这是一个已知的问题？15% 是非常可复制的。并且全面涵盖真实时间、系统时间和用户时间。我必须等到明天才能发布程序集。

**更新：**我只尝试过我的一个编译框。我正在使用 SuSE 10。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T03:03:30.427

当使用 gcc 和 g++ 编译时，我看到的唯一区别在于前 4 行。

海湾合作委员会：

```
 .file   "loops.c"
    .def    ___main;    .scl    2;  .type   32; .endef
    .text
.globl _main 
```

克++：

```
 .file   "loops.c"
    .def    ___main;    .scl    2;  .type   32; .endef
    .text
    .align 2
.globl _main 
```

正如您所看到的，唯一的区别是使用 g++，对齐 (2) 发生在单词边界上。这种微小的差异似乎正在产生显着的性能差异。

这是一个解释结构对齐的页面，尽管它适用于 ARM/NetWinder，但它仍然适用，因为它讨论了对齐如何在现代 CPU 上工作。您将需要专门阅读第 7 节“单词对齐的缺点是什么？” ：

[http://netwinder.osuosl.org/users/b/brianbr/public_html/alignment.html](http://netwinder.osuosl.org/users/b/brianbr/public_html/alignment.html)

这是 .align 操作的参考：

[http://www.nersc.gov/vendor_docs/ibm/asm/align.htm](http://www.nersc.gov/vendor_docs/ibm/asm/align.htm)

根据要求进行基准测试：

海湾合作委员会：

```
john@awesome:~$ time ./loopsC

real    0m21.212s
user    0m20.957s
sys 0m0.004s 
```

克++：

```
john@awesome:~$ time ./loopsGPP

real    0m22.111s
user    0m21.817s
sys 0m0.000s 
```

我将最内层的迭代减少到 1200。结果并不像我希望的那样普遍，但随后再次在 Windows 上生成了程序集输出，并在 Linux 中完成了计时。也许在 MinGW 的幕后做了一些与 gcc for Linux 对齐方式不同的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T02:52:40.047

为了弄清楚为什么它变慢，您可能需要查看编译器生成的程序集。g++ 编译器必须做一些不同于 gcc 编译器的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T03:03:54.687

原因之一是 gcc 可能优化了 m 和 n 的分配，以便它们可以并行运行。

可以这样做

```
m = i+j+k;
n = i+j+k+2; 
```

我不确定这是否能将性能提高 15%。这可能会提高多核 CPU 的性能。最好的方法是比较 2 个编译器的汇编代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T02:59:06.117

哦，那*是*一个有趣的。但是您给我们的代码无法编译。你需要

```
(int argc, char** argv) 
```

# lua - PCALL 有什么问题，或者 Wowwiki 有什么问题吗？

> ID：732607
> 
> 赞同：2
> 
> 时间：2009-04-09T02:50:00.927
> 
> 标签：lua, world-of-warcraft

这是一个 WoW（魔兽世界）lua 脚本问题。没有多少人在这里被问到，但我无处可去，而 Stackoverflow 是程序员的绿洲。

问题：

Wowwiki 声明第 2、3、4 个参数是您调用函数的第 1、2、3 个参数。我不认为这是真的。我发现第 3、第 4、第 5 个参数最终成为第 1、第 2、第 3 个参数。

链接：[http ://www.wowwiki.com/API_pcall](http://www.wowwiki.com/API_pcall)

功能：

```
function myTest(arg1) 
  return arg1 .. 10; 
end 
```

问题：

```
local retOK, ret1 = pcall(myTest,"string value"); 
```

当我尝试示例时，我收到“尝试在本地 'arg1'（一个 nil 值）上执行连接”的错误。如果我将代码更改为：

```
local retOK, ret1 = pcall(myTest,"string value", "bob"); 
```

然后我得到“bob10”的输出。第二个论点在哪里，它是为了什么？

**更多测试：**

```
function BobsToolbox:RunTest() 
  local test1, value1 = pcall(BobsToolbox.Test1, "string value"); 
  SharpDeck:Print("Test1: " .. tostring(test1) .. " Value: " .. tostring(value1)); 
end 

function BobsToolbox:Test1(arg1) 
  return arg1 .. "10"; 
end 
```

结果：尝试连接本地 'arg1'（一个 nil 值）

```
function BobsToolbox:RunTest() 
  local test1, value1 = pcall(Test1, "string value"); 
  SharpDeck:Print("Test1: " .. tostring(test1) .. " Value: " .. tostring(value1)); 
end 

function Test1(arg1) 
  return arg1 .. "10"; 
end 
```

结果：字符串 value10

我是 lua 新手，我不明白为什么这些不同。

**新问题：**

以下代码有效，但为什么呢？

```
function BobsToolbox:RunTest()
  local test1, value1 = pcall(BobsToolbox.Test1, "string value");
  SharpDeck:Print("Test1: " .. tostring(test1) .. " Value: " .. tostring(value1));
end

function BobsToolbox.Test1(arg1)
  return arg1 .. "10";
end 
```

以下之间有什么区别：（“。”与“：”）

*   函数 BobsToolbox.Test1(arg1)
*   功能 BobsToolbox:Test1(arg1)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T14:06:50.473

**Lua 文档：**

[http://www.lua.org/pil/16.html](http://www.lua.org/pil/16.html)

self 参数的这种使用是任何面向对象语言的中心点。大多数 OO 语言都对程序员部分隐藏了这种机制，因此她不必声明这个参数（尽管她仍然可以使用这个词`self`或`this`在方法中）。Lua 也可以隐藏这个参数，使用冒号操作符。我们可以将之前的方法定义改写为

```
function Account:withdraw (v) 
    self.balance = self.balance - v 
end 
```

和方法调用为

```
a:withdraw(100.00) 
```

冒号的作用是在方法定义中添加一个额外的隐藏参数，并在方法调用中添加一个额外的参数。冒号只是一种句法工具，虽然很方便；这里没有什么新东西。我们可以用点语法定义一个函数并用冒号语法调用它，反之亦然，只要我们正确处理额外的参数：

```
Account = { balance=0,
    withdraw = function (self, v) 
        self.balance = self.balance - v 
    end 
} 

function Account:deposit (v) 
    self.balance = self.balance + v 
end 

Account.deposit(Account, 200.00) 
Account:withdraw(100.00) 
```

**可能的结论：**

考虑到这一点，我假设在使用“pcall”调用“：”函数时，您必须提供“self”参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T06:29:33.007

相关：WoW 有很好的实时代码编辑器。我曾经使用过 LuaSlinger，但后来发现它不再开发，开发人员推荐使用[Hack](http://www.wowinterface.com/downloads/info11101-1.0.4.html)。

但是，您可能会在这里遇到冒号方法调用语法只是语法糖，方法定义同上，IIRC。基本上，如果你这样做`foo:bar("quux!")`，其中 foo 是一个对象，你实际上只是在做`foo.bar(foo, "quux!")`.

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T05:53:38.757

好吧，我不认为 WoWWiki 是错误的。这是我正在使用的代码：

```
function myTest(arg1) return arg1 .. 10; end 

local retOK, ret1 = pcall(myTest,"string value"); 
DEFAULT_CHAT_FRAME:AddMessage(ret1);

local retOK, ret1 = pcall(myTest,"string value", "bob"); 
DEFAULT_CHAT_FRAME:AddMessage(ret1); 
```

这是我在常规聊天框中得到的输出：

```
string value10
string value10 
```

您如何尝试示例代码？我只是将我的代码粘贴到现有的 mod lua 文件中，并确保在选择我的角色并登录之前在插件窗口中启用了 mod。我对源 lua 文件进行了一些更改并键入：

> /控制台重新加载ui

尝试新的更改并将结果输出到我的屏幕。我没有太多的建议可以给你，因为我没有做太多的魔兽插件工作。您是否在空白插件中尝试过此代码以确保没有其他干扰？你真的尝试过游戏中的代码吗？如果您可以提供更多信息或希望我尝试其他任何方法，请告诉我！

**更新**：决定尝试更多测试。以下是测试（具有相同的功能）：

```
local retOK, ret1 = pcall(myTest,""); 
DEFAULT_CHAT_FRAME:AddMessage(ret1);

local retOK, ret1 = pcall(myTest, nil, "bob"); 
DEFAULT_CHAT_FRAME:AddMessage(ret1); 
```

结果：

```
10
attempt to concatenate local 'arg1' (a nil value) 
```

有趣的是，我在 arg1 为 nil 时看到的错误与您看到的错误略有不同。我很想知道你是如何测试你的代码的。或者，也许您没有逐字复制错误？我想您也可以尝试清除您的 WTF 文件夹并禁用其余的插件来测试此功能。如果它有所作为，那么您可以一次启用它们，直到找到问题为止。

# c++ - 在 Windows 上测量内存分配有哪些好工具？

> ID：732609
> 
> 赞同：1
> 
> 时间：2009-04-09T02:53:18.533
> 
> 标签：c++, windows, allocation

我有一个应用程序随着时间的流逝（在积极运行时）不断消耗越来越多的内存，但没有泄漏。所以我知道该程序并没有做完全错误的事情，这很容易找到。

相反，我想跟踪分配，以便我可以开始跟踪问题，在 Mac 上我会使用 Instruments，它提供了分配哪些对象以及由谁分配的详细配置文件，但在 Windows 上我会使用什么？

目前我正在使用 VS2005 在 Windows XP 上使用 C/C++。因此，任何用于此设置的工具都会很棒，希望免费或至少提供几周试用的工具，因为如果需要，完成任何购买（公司产品）需要一段时间，而且我有最后期限。

谢谢！

**编辑：**我正在使用 VLD，所以我知道程序没有泄漏，但它似乎占用了比需要更多的内存，并且没有返回它，所以我需要跟踪分配，而不是泄漏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T03:07:32.120

内存验证器将是您的理想选择。 [http://www.softwareverify.com/cpp/memory/index.html](http://www.softwareverify.com/cpp/memory/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T03:01:08.750

[发光代码在这里。](http://www.glowcode.com/)它拥有世界上最糟糕的用户界面。不过，如果你有耐心克服试图让它正常工作的恐怖，内部就有这些东西。有 21 天的免费试用期。我发现它是一个救命稻草，但你真的必须要找到那个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T03:05:46.443

> Visual Studio 启用内存泄漏检测
> 
> 检测内存泄漏的主要工具是调试器和 CRT 调试堆函数。要启用调试堆函数，请在程序中包含以下语句：

```
#define CRTDBG_MAP_ALLOC
#include <stdlib.h>
#include <crtdbg.h> 
```

[http://msdn.microsoft.com/en-us/library/e5ewb1h3(VS.71).aspx](http://msdn.microsoft.com/en-us/library/e5ewb1h3(VS.71).aspx)

# c - 与对应的 long by delta 不同的第一个双精度数是多少？

> ID：732612
> 
> 赞同：5
> 
> 时间：2009-04-09T02:54:13.743
> 
> 标签：c, math, gcc, double

我想知道从 0d 向上的第一个双精度数，它偏离“相同值”的 long 某个增量，例如 1e-8。我在这里失败了。尽管我通常使用托管语言以防万一，但我正在尝试在 C 中执行此操作。请帮忙。

```
 #include <stdio.h>
#include <limits.h>
#define DELTA 1e-8

int main() {
    double d = 0; // checked, the literal is fine
    long i;
    for (i = 0L; i < LONG_MAX; i++) {
         d=i; // gcc does the cast right, i checked
         if (d-i > DELTA || d-i < -DELTA) {
              printf("%f", d);
              break;
         }
    }
}
```

我猜问题是 di 将 i 转换为 double ，因此 d==i 然后差异始终为 0。我还能如何正确检测到这一点 - 我更喜欢有趣的 C 转换而不是比较字符串，这将永远拿走。

*回答*：完全符合我们的预期。2^53+1 = 9007199254740993 是根据标准 C/UNIX/POSIX 工具的第一个不同点。非常感谢 pax 的节目。我猜数学又赢了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-09T03:26:41.667

IEE754 中的双精度为 52 位，这意味着它们可以准确地存储（至少）高达 2 ^(51)的数字。

如果您的 long 是 32 位的，它们将只有（正）范围 0 到 2 ^(31)，因此没有 32 位 long 不能完全表示为 double。对于 64 位长度，它将（大约）2 ^(52)所以我会从那里开始，而不是从零开始。

您可以使用以下程序来检测故障开始发生的位置。在早期的版本中，我依赖于这样一个事实，即连续翻倍的数字中的最后一位数字遵循序列 {2,4,8,6}。但是，我最终选择使用已知的可信工具`(bc)`来检查整个数字，而不仅仅是最后一个数字。

请记住，这*可能*会受到动作的影响，`sprintf()`而不是双打的真实准确性（我个人不这么认为，因为它在某些数字高达 2 ^(143)时没有问题）。

这是程序：

```
#include <stdio.h>
#include <string.h>

int main() {
    FILE *fin;
    double d = 1.0; // 2^n-1 to avoid exact powers of 2.
    int i = 1;
    char ds[1000];
    char tst[1000];

    // Loop forever, rely on break to finish.
    while (1) {
        // Get C version of the double.
        sprintf (ds, "%.0f", d);

        // Get bc version of the double.
        sprintf (tst, "echo '2^%d - 1' | bc >tmpfile", i);
        system(tst);
        fin = fopen ("tmpfile", "r");
        fgets (tst, sizeof (tst), fin);
        fclose (fin);
        tst[strlen (tst) - 1] = '\0';

        // Check them.
        if (strcmp (ds, tst) != 0) {
            printf( "2^%d - 1 <-- bc failure\n", i);
            printf( "   got       [%s]\n", ds);
            printf( "   expected  [%s]\n", tst);
            break;
        }

        // Output for status then move to next.
        printf( "2^%d - 1 = %s\n", i, ds);
        d = (d + 1) * 2 - 1;  // Again, 2^n - 1.
        i++;
    }
} 
```

这一直持续到：

```
2^51 - 1 = 2251799813685247
2^52 - 1 = 4503599627370495
2^53 - 1 = 9007199254740991
2^54 - 1 <-- bc failure
   got       [18014398509481984]
   expected  [18014398509481983] 
```

这就是我预计它会失败的地方。

顺便说一句，我最初使用了 2 ^n形式的数字，但这让我达到了：

```
2^136 = 87112285931760246646623899502532662132736
2^137 = 174224571863520493293247799005065324265472
2^138 = 348449143727040986586495598010130648530944
2^139 = 696898287454081973172991196020261297061888
2^140 = 1393796574908163946345982392040522594123776
2^141 = 2787593149816327892691964784081045188247552
2^142 = 5575186299632655785383929568162090376495104
2^143 <-- bc failure
   got       [11150372599265311570767859136324180752990210]
   expected  [11150372599265311570767859136324180752990208] 
```

double 的大小为 8 个字节（用 选中`sizeof`）。事实证明，这些数字是二进制形式`"1000..."`，可以用双精度数表示更长的时间。那时我改用 2 ^n -1 来获得更好的位模式：全一位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T02:59:49.000

当转换为 double 时，第一个“错误”的 long 不会偏离 1e-8，而是偏离 1。只要 double 可以在其有效数字中容纳 long，它就会准确地表示它。

我完全忘记了双精度与偏移量有多少位，但这会告诉你它可以代表的最大大小。第一个 long 错误应该是二进制形式 10000...，所以你可以从 1 开始并左移更快地找到它。

维基百科说有效数字中有 52 位，不包括隐含的起始 1。这应该意味着要转换为不同值的第一个 long 是 2^53。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T02:10:18.513

尽管在本次讨论中我不愿提及 Fortran 95 和后续版本，但我会提到自 1990 年标准以来的 Fortran 提供了一个 SPACING 内在函数，它告诉您可表示的 REAL 与给定的 REAL 之间的区别是什么。您可以对此进行二进制搜索，当 SPACING(X) > DELTA 时停止。对于使用与您感兴趣的相同浮点模型的编译器（可能是 IEEE754 标准），您应该得到相同的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T02:58:28.613

顺便说一句，我认为双精度数可以准确地表示所有整数（在它们的范围内）。

如果不是这种情况，那么您将希望将 i 和 d 都转换为比它们中的任何一个都更精确的东西。也许一个长的双倍会起作用。

# c++ - 我想做我自己的 Malloc

> ID：732617
> 
> 赞同：10
> 
> 时间：2009-04-09T02:55:03.957
> 
> 标签：c++, c, garbage-collection, malloc

我想制作自己的 malloc/free，这样我就可以制作一个精确的复制分配器。

任何大师有任何提示和建议吗？

我现在有几个问题：

1.  我应该只 malloc 大块内存，然后从中分发，这样我就不必调用系统调用了吗？
2.  抄袭收藏家通常是怎么做的？我想这部分要有效地完成有点复杂。我幼稚的实现只会 malloc 一个块，剩余对象的大小需要 2 倍的空间。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-09T03:11:15.400

关于实现 malloc 和类似的东西有很多很好的文献。但我注意到你在这里包含了 C++——你知道你可以编写自己的 C++ 实现`new`吗`delete`？作为一种轻松完成它的方法，这可能很有用。

在任何情况下，您想要的特征将在很大程度上取决于您的工作量，即随着时间的推移使用模式。如果你只有 mallocs 和 new frees，显然很容易。如果您只有一种或几种不同块大小的 malloc，那也很简单。

在其他语言中，您可以通过将内存链接在一起来获得一些优势，但 C 并不那么聪明。

malloc 的基本实现只是分配一个包含数据长度、“使用中标志”和 malloc 内存的标头。Malloc 然后在其空间的末尾构造一个新的标头，分配内存，并返回一个指针。当您释放时，它只会重置正在使用的标志。

诀窍是，当您执行大量 mallooc 和 free 操作时，您可以快速获得大量未使用但难以分配的小 blob。所以你需要某种凹凸 gc 来合并内存块。

您可以进行更复杂的 gc，但请记住这需要时间；你不想一个空闲占用很多时间。

有一篇关于 Solaris malloc 实现的[好论文，您可能会觉得有趣。](http://developers.sun.com/solaris/articles/multiproc/multiproc.html)这是另一个[关于在 Solaris 中构建替代 malloc](http://www.steubentech.com/%7Etalon/dlmalloc.html)的内容，但基本内容是相同的。你应该阅读关于垃圾收集的[维基百科文章](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))，并按照它来阅读一些更正式的论文。

### 更新

你知道，你真的应该看看分代垃圾收集器。基本思想是，分配的时间越长，分配的可能性就*越大*。这是您提到的“复制”GC的扩展。基本上，你在内存池的一部分中分配新的东西，称之为 g0。当你达到高水位线时，你查看分配的块并将仍在使用的块复制到内存的另一部分，称为 g1，然后你可以清除 g0 空间并开始在那里分配。最终 g1 达到了它的高水位线，你通过清除 g0 来修复它，并清理 g1 将东西移动到 g0，当你完成后，你将旧的 g1 重命名为 g0，反之亦然并继续。

诀窍在于，尤其是在 C 语言中，您分配给 malloc 内存的句柄是直接的原始指针；如果没有一些大药，你就无法真正移动东西。

### 第二次更新

在评论中，@unknown 询问“移动的东西不会只是一个 memcpy()”。确实会。但考虑一下这个时间表：

**警告：这是不完整的，未经测试，仅用于说明，仅供娱乐，不提供任何明示或暗示的保证**

```
/* basic environment for illustration*/
void * myMemoryHdl ;
unsigned char lotsOfMemory[LOTS]; /* this will be your memory pool*/ 
```

你分配了一些内存

```
/* if we get past this, it succeded */
if((myMemoryHdl = newMalloc(SIZE)) == NULL)
    exit(-1); 
```

在 malloc 的实现中，您创建内存并返回指向缓冲区的指针。

```
unsigned char * nextUnusued = &lotsOfMemory[0];
int partitionSize = (int)(LOTS/2);
int hwm = (int) (partition/2);
/* So g0 will be the bottom half and g1 the top half to start */
unsigned char * g0 = &lotsOfMemory[0];
unsigned char * g1 = &lotsOfMemory[partitionSize];

void * newMalloc(size_t size){
   void * rtn ;
   if( /* memory COMPLETELY exhausted */)
      return NULL;
   /* otherwise */
   /* add header at nextUnused */
   newHeader(nextUnused);     /* includes some pointers for chaining
                               * and a field with values USED or FREE, 
                               * set to USED */
   nextUnused += HEADERLEN ;  /* this could be niftier */
   rtn = nextUnused ;
   nextUnused += size ;
} 
```

有些东西被释放了

```
 newFree(void * aHandle){
     *(aHandle-offset) = FREE ; /* set the flag in the header, 
                                 * using an offset. */
  } 
```

所以现在你做了所有的事情，你达到了你的高水位线。

```
 for( /* each block in your memory pool */ )
    if( /* block header is still marked USED */ ) {
        memcpy(/* block into other partition */);
    }
 /* clear the partition */
 bzero(g0, partitionSize); 
```

现在，回到您保存在 myMemHdl 中的原始句柄。它指向什么？（答案，您只需使用 bzero(3) 将其设置为 0x00。）

这就是神奇之处。至少在 C 中，您从 malloc 返回的指针不再受您的控制——事后您无法移动它。在 C++ 中，使用用户定义的类指针类型，您可以解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T03:54:13.317

了解更多关于您正在尝试做的事情会很有帮助。这是针对单一类型的吗？还是一组相对统一的类型？

*   如果您需要加速给定类型的分配，内存池是一种久经考验的技术（一个可能的缺点是您可能会在内存中跳跃，影响缓存性能）
*   应用程序范围的分配技术通常包括将所有分配四舍五入到配置文件驱动的存储桶大小，以便减少碎片。
*   多线程应用程序通常具有可以分配的每个线程池，而不会冒与其他线程争用的风险

tcmalloc 的文档非常擅长描述这些技术的当前状态。

这里没有太多复杂的东西，但你可能正在重新发明轮子。有一些开源库可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T03:13:48.873

不要使用想法 #1，您将浪费大量资源，这些资源可能在应用程序的整个执行过程中可能仍未使用，同时阻止其他进程使用它（取决于您计划占用多少）。

# c# - 为什么使用事件？

> ID：732626
> 
> 赞同：15
> 
> 时间：2009-04-09T03:00:24.507
> 
> 标签：c#, winforms, architecture

我正在了解事件在 C# 中的工作方式（我是该领域的新手）。我试图理解的是我们为什么使用事件。

您知道使用事件的编码/架构良好的应用程序吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-09T05:23:43.913

提供一个具体的正常世界示例....

你有一个表单，表单有一个列表框。列表框有一个很好的快乐课程。当用户从列表框中选择某些内容时，您想知道并修改表单上的其他内容。

没有事件：

您从列表框派生，覆盖事物以确保您的父级是您期望的表单。您覆盖了 ListSelected 方法或其他东西，它可以操纵父表单上的其他东西。

使用事件：您的表单侦听事件以指示用户选择了某些内容，并操作表单上的其他内容。

不同之处在于，在没有事件的情况下，您创建了一个单一用途的类，并且还与它期望的环境紧密绑定。在有事件的情况下，操作表单的代码被本地化为您的表单，列表框只是一个列表框。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-09T05:12:52.113

非常有用的是一个使用事件的应用程序的重要示例（猜猜它真的也有助于测试吗？）

到目前为止的想法是：

**为什么使用事件或发布/订阅？**

引发事件时可以通知任意数量的类。

订阅类不需要知道节拍器（见下面的代码）是如何工作的，节拍器也不需要知道他们将要做什么来响应事件

发布者和订阅者通过委托解耦。这是非常可取的，因为它使代码更加灵活和健壮。节拍器可以在不破坏任何订阅类的情况下改变它检测时间的方式。订阅类可以在不破坏节拍器的情况下更改它们对时间变化的响应方式。这两个类彼此独立旋转，这使得代码更易于维护。

```
class Program
{
    static void Main()
    {
        // setup the metronome and make sure the EventHandler delegate is ready
        Metronome metronome = new Metronome();

        // wires up the metronome_Tick method to the EventHandler delegate
        Listener listener = new Listener(metronome);
        ListenerB listenerB = new ListenerB(metronome);
        metronome.Go();
    }
}

public class Metronome
{
    // a delegate
    // so every time Tick is called, the runtime calls another method
    // in this case Listener.metronome_Tick and ListenerB.metronome_Tick
    public event EventHandler Tick;

    // virtual so can override default behaviour in inherited classes easily
    protected virtual void OnTick(EventArgs e)
    {
        // null guard so if there are no listeners attached it wont throw an exception
        if (Tick != null)
            Tick(this, e);
    }

    public void Go()
    {
        while (true)
        {
            Thread.Sleep(2000);
            // because using EventHandler delegate, need to include the sending object and eventargs 
            // although we are not using them
            OnTick(EventArgs.Empty);
        }
    }
}

public class Listener
{
    public Listener(Metronome metronome)
    {
        metronome.Tick += new EventHandler(metronome_Tick);
    }

    private void metronome_Tick(object sender, EventArgs e)
    {
        Console.WriteLine("Heard it");
    }
}

public class ListenerB
{
    public ListenerB(Metronome metronome)
    {
        metronome.Tick += new EventHandler(metronome_Tick);
    }

    private void metronome_Tick(object sender, EventArgs e)
    {
        Console.WriteLine("ListenerB: Heard it");
    }
} 
```

我在我的网站上写的全文：http: [//www.programgood.net/](http://www.programgood.net)

注意其中一些文本来自[http://www.akadia.com/services/dotnet_delegates_and_events.html](http://www.akadia.com/services/dotnet_delegates_and_events.html)

干杯。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-09T03:36:26.900

您可以使用事件和委托在 C#中实现[观察者模式。](http://en.wikipedia.org/wiki/Observer_pattern)

以下是描述此类文章的链接：http: [//blogs.msdn.com/bashmohandes/archive/2007/03/10/observer-pattern-in-c-events-delegates.aspx](https://web.archive.org/web/20080920085403/http://blogs.msdn.com/bashmohandes/archive/2007/03/10/observer-pattern-in-c-events-delegates.aspx)

[![在此处输入图像描述](https://i.stack.imgur.com/RudBj.png)](https://i.stack.imgur.com/RudBj.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T03:19:46.380

您始终可以构建自己的发送/接收事件、订阅/取消订阅事件源的方式。但是该语言为您提供了一种简单/标准的方法，因此这是使用语言“事件”而不是您自己的事件技术的一个很好的理由。

此外，使用“事件”语言允许您使用反射做各种很酷的事情，因为它是标准化的。

至于为什么要使用事件技术。有各种现实生活中的例子，其中这非常有用且使用事件更简单。事件的有用性几乎与 Windows 消息相似。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T03:27:42.210

在最基本的概念层面上，事件是让计算机对您所做的事情做出反应的东西，而不是要求您对计算机所做的事情做出反应。当您坐在 PC 前运行多个应用程序（包括操作系统），并且每个上下文中有几个可单击的对象供您选择时，事件就是您选择一个时发生的事情，所有涉及的部分都可以是适当通知。

即使移动鼠标也会启动一系列事件（例如移动光标）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-25T05:16:47.133

如果您对为什么在我们可以使用委托实现相同功能时使用事件感到困惑，那么答案是：

1.  客户端（发生订阅的类）在使用事件时不能直接调用委托的invoke方法

    instanceOfClassWithDelegate.sampleDelegate.Invoke(); // 不可能有事件

2.  客户端在使用事件时无法列出或清除分配给委托的功能

    instanceOfClassWithDelegate.sampleDelegate = null; // 使用事件时不可能

3.  正如隐含的理解，事件是封装逻辑的更好方法

这个答案的全部功劳归于这个博客：[https ://dev.to/willydavidjr/why-use-events-instead-of-delegates-in-c-40k8](https://dev.to/willydavidjr/why-use-events-instead-of-delegates-in-c-40k8)

# jquery - Firefox 插件和 document.ready

> ID：732629
> 
> 赞同：1
> 
> 时间：2009-04-09T03:01:37.500
> 
> 标签：jquery, firefox, plugins

我正在尝试开发一个 firefox 插件，每当加载页面时都应该执行该插件。有人可以告诉我要使用哪个事件。在Firefox中，当我打开一个新窗口时会执行document.ready，而当我打开一个新选项卡时它不会执行:(。感谢您的帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T03:23:24.687

最初我是挂钩的`DOMContentLoaded`，但这花了太长时间，因为在 Firefox 加载页面及其任何 iframe 的 DOM 树之前它不会触发。

`Load`同样慢，因为它需要页面完全加载以及所有图像。

最终，在经历了这些，以及为`nsIWebProgressListener.onLocationChange`其他一些人设置 XPCOM 之后，我最终决定`DOMTitleChanged`如下：

`appcontent.addEventListener("DOMTitleChanged", events.onPageLoad, true);`

（请注意，`DOMTitleChanged`即使 HTML 页面没有`<title>`属性或具有`<title>`与前一页等效的属性，它似乎也会触发。）

我不记得我 100% 选择的原因，`DOMTitleChanged`但我相信这是因为它最适合我的需求 - 基本上，这是获取用户导航 URL 的最快方式，无需等待任何内容加载同时触发以各种可能的方式加载新页面……新标签页、页面更改等等。

唯一需要注意的是，您需要添加代码以手动查找加载项覆盖启动代码中的 URL，因为除非您`addEventListener()`在 FF 开始在新窗口上加载第一页之前，否则您将添加事件侦听器为时已晚可靠地捕获初始页面加载。（这是因为每次 Firefox 打开一个新窗口时都会加载一个新的、独立的加载项实例。）

# extjs - Ext JS - 如何使用增量更新数据源每分钟更新一次？

> ID：732638
> 
> 赞同：1
> 
> 时间：2009-04-09T03:06:03.980
> 
> 标签：extjs, grid, updates, real-time

寻找参考实现。没有尝试过 LiveGrid - 虽然倾向于那个实现。在我迁移之前，我想知道是否有人可以为我指明更好的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T04:13:59.260

[http://extjs.com/forum/showthread.php?t=4392](http://extjs.com/forum/showthread.php?t=4392)适用于此。

# windows - 从 32 位应用程序使用 64 位驱动程序

> ID：732642
> 
> 赞同：3
> 
> 时间：2009-04-09T03:08:08.950
> 
> 标签：windows, winapi, 64-bit, driver

我有一个必须以 32 位运行的 Windows 应用程序（因为我无法控制其他限制）。但是，我的应用程序必须调用和访问可能是 32 位或 64 位的驱动程序，具体取决于安装它的系统。

我通过 DeviceIoControl() 调用访问驱动程序，交换包含文件中声明的数据结构。数据结构包含声明为“DWORD_PTR”的字段（我也不控制的包含文件）。

我的问题是在 64 位系统上，驱动程序期望结构包含 64 位整数（因为 DWORD_PTR 声明）。但是，我的 32 位程序将那些 DWORD_PTR 视为 32 位整数。然后，我的数据结构的程序版本与驱动程序对这些结构的理解之间存在数据不匹配。

DeviceIoControl() 最终以 ERROR_INSUFFICIENT_BUFFER 失败（传递给系统调用的数据区域太小）。我确认如果我将 64 位版本的结构传递给驱动程序，我不会收到此错误。

从这个烂摊子中我有一些丑陋的选择。但我想知道是否有人有更好的建议？

* * *

解决方案：

*   使用 REAL 64 位数据字段 (__int64) 声明共享结构的新副本
*   动态检查操作系统架构 (32/64)
*   对 DeviceIoControl() 调用使用 32 位或 64 位版本的结构。

缺点：

*   我必须手动维护结构声明的显式 64 位副本。随着时间的推移，这可能会很痛苦。

* * *

我的其他解决方案是这个解决方案的变体，但它们**总是**涉及维护结构定义的一些副本（例如在用于 COM 服务器的 IDL 选项中）。

编辑：这是一个 Microsoft 驱动程序，它似乎不使用 IoIs32bitsProcess(irp)！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T03:22:14.843

您维护 32 位和 64 位版本的结构，并通过`IoIs32BitProcess(irp)`设备驱动`DEVICE_CONTROL`程序处理程序中的函数实现特殊处理，并在需要时将其转换为 64 位结构。这是常见的做法。

这是[MSDN 上关于它的大量文档。](http://msdn.microsoft.com/en-us/library/aa489581.aspx)

由于您后来提到您无法控制驱动程序源代码，因此我建议您在 64 位上维护自己的 32 位变体，并发送正确的变体来检查操作系统架构。看起来结构声明没有为驱动程序正确完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-11T22:58:21.650

当包含带有结构 defs 的标头时，有没有办法操纵 #define 以便您始终使用 64 位定义？这对我来说似乎是最好的选择（如果可能的话）。

如果没有，我会在我自己的代码中隐藏 64 位结构——这样只有一个结构 def 需要注意，而不是一堆 if32bit/if64bit 的东西散布在各处——这似乎更容易出错。也许您可以执行以下操作：

```
_ASSERT(sizeof(myStruct) == sizeof(64bitStruct)) 
```

在您的应用程序开始时，因此如果您获得更新的标题，您的应用程序的第一次运行会提醒您需要同步。

# mysql - MySQL 集群（主/从）和休眠

> ID：732648
> 
> 赞同：5
> 
> 时间：2009-04-09T03:12:51.060
> 
> 标签：mysql, hibernate, spring

开发时的应用是单库，spring配置如下。

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="com.mysql.jdbc.Driver" />
    <property name="url" value="jdbc:mysql://localhost:3306/test" />
    <property name="username" value="root" />
    <property name="password" value="" />
</bean>

<bean id="hibernateProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
    <property name="properties">
    <props>
        <prop key="hibernate.hbm2ddl.auto">update</prop>
        <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
        ...
        </props>
    </property>
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource">
        <ref local="dataSource" />
    </property>
    <property name="hibernateProperties">
    <ref bean="hibernateProperties" />
    </property>
    <property name="mappingResources">
    <list>
        <value>...</value>
    </list>
    </property>
</bean>

<bean id="txManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="dataSource" ref="dataSource" />
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

然而，对于生产来说，有可能会使用 MySQL 集群或主/从复制。关于代码/配置更改的任何想法？

对所有人来说也是一个快速的问题 - 在专用服务器上运行的单个 mysql 服务器实例可以处理多少事务/秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-06T02:43:47.013

尽管没有涉及 Spring，但我也研究过类似的问题。我们针对 MySQL 的本地实例开发了指向（每个开发人员在他们的盒子上都有一个），生产系统是一个主/从复制环。我们实际上更进一步，将应用程序服务器与数据库服务器放在一起，因此在应用程序和数据库级别都有一个四节点集群。

我们的应用程序在 JBoss 中运行。它相当轻巧，但在应用程序服务器级别确实有一些严重的集群。有了这一切，我们能够获得超过 300 个请求/秒，有时接近 1000 个请求/秒（取决于应用程序处理）。数据库从来都不是瓶颈——即使以这样的速度，我们也很少看到连接池超过 5 个连接。

在这两种情况下（我的和你的），由于 JDBC URL 指向本地服务器，因此从应用程序的角度来看，实际上没有任何功能差异。我不得不用自动增量设置玩一些有趣的配置游戏，以防止数据被踩到；如果您只有一个部署点（因此只有一个访问 MySQL 实例的点），您不需要担心任何这些。

因此，没有代码更改，也没有配置更改。它会起作用的。在标准条件下，您由主/从实例对或集群支持这一事实不会产生影响，因为您很可能指向集群前面的主实例或 MySQL 实例（在 MySQL ，集群位于一台或多台数据库服务器后面，复制数据）。

您希望处理什么样的负载？MySQL 过去以 >1000 TPS 进行[基准测试](http://blogs.oracle.com/realneel/entry/mysql_scalability_on_nehalem_systems)，但结果往往会根据底层系统特性（内存、CPU 内核、处理器速度）、应用程序的响应能力和并发线程而有所不同。

# .net - 如何在 Visual Studio 上“观察”字符串的字符值？

> ID：732651
> 
> 赞同：0
> 
> 时间：2009-04-09T03:14:04.240
> 
> 标签：.net, visual-studio, debugging

我记得我可以在调试期间向监视变量添加修饰符，以使其在 Delphi 中以不同的格式显示。例如“str,m”将以二进制表示形式显示字符串。

同样，我想查看字符串的二进制表示，以查看 Visual Studio 2008 上 .NET 应用程序的字符值。最简单的方法是什么？

注意：“十六进制显示”选项不适用于字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T03:17:19.130

你总是可以创建一个[DebuggerVisualizer](http://msdn.microsoft.com/en-us/library/ms379596(VS.80).aspx)。（或见[http://karlshifflett.wordpress.com/2008/01/20/sample-series-authoring-debugger-visualizers/](http://karlshifflett.wordpress.com/2008/01/20/sample-series-authoring-debugger-visualizers/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T03:32:03.650

如果您只想要一个简单的字符串表示，请查看此。

[MSDN：使用调试器显示属性增强调试](http://msdn.microsoft.com/en-us/library/ms228992.aspx)

他们使用以下示例：

```
[DebuggerDisplay("Count = {count}")]
class MyHashtable
{
    public int count = 4;
} 
```

# linq - Linq 和 i4o 之类的项目是否使面向对象的数据库成为关系数据库的可行替代品？

> ID：732665
> 
> 赞同：0
> 
> 时间：2009-04-09T03:23:56.277
> 
> 标签：linq, object, rdbms, object-oriented-database

鉴于 Linq 和[i4o](http://www.codeplex.com/i4o "索引 LINQ")等技术，面向对象的数据库管理系统在未来 3 到 5 年内不会成为关系数据库管理系统的可行替代方案，有什么真正的理由吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T19:22:18.083

我会说“在过去 3 到 5 年内一直是可行的替代方案”，而不是“将在 3 到 5 年内成为可行的替代方案”。

# delphi - 在 Delphi 2009 中将 TMemoryStream 转换为“字符串”

> ID：732666
> 
> 赞同：33
> 
> 时间：2009-04-09T03:24:23.233
> 
> 标签：delphi, string, unicode, delphi-2009, memorystream

在 Delphi 2009 之前，我们有以下代码：

```
function MemoryStreamToString(M : TMemoryStream): String;
var
    NewCapacity: Longint;
begin
    if (M.Size = > 0) or (M.Memory = nil) then
       Result:= '' 
    else
    begin
       if TMemoryStreamProtected(M).Capacity = M.Size then
       begin
           NewCapacity:= M.Size+1;
           TMemoryStreamProtected(M).Realloc(NewCapacity);
       end;
       NullString(M.Memory^)[M.Size]:= #0;
       Result:= StrPas(M.Memory);
    end;
end; 
```

现在我们如何使用 Delphi 2009 转换此代码以支持 Unicode？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-04-09T08:30:31.750

您拥有的代码过于复杂，即使对于较旧的 Delphi 版本也是如此。毕竟，为什么要获取流的字符串版本会强制重新分配流的内存？

```
function MemoryStreamToString(M: TMemoryStream): string;
begin
  SetString(Result, PChar(M.Memory), M.Size div SizeOf(Char));
end; 
```

这适用于所有 Delphi 版本，而不仅仅是 Delphi 2009。它适用于流为空且没有任何特殊情况的情况。[`SetString`](http://www.delphibasics.co.uk/RTL.asp?Name=SetString)是一个被低估的功能。

如果切换到 Delphi 2009 后流的内容没有更改为 Unicode，那么您应该改用此函数：

```
function MemoryStreamToString(M: TMemoryStream): AnsiString;
begin
  SetString(Result, PAnsiChar(M.Memory), M.Size);
end; 
```

这相当于您的原始代码，但跳过了特殊情况。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-09T05:51:17.717

或者也许您可以重构您的代码以直接使用 TStringStream ？您可以使用它代替 TMemoryStream （它们具有相同的接口），您可以通过简单地调用 myString := myStringStream.DataString; 将其“转换”为字符串；

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-09T14:30:56.173

“更清洁”的方式可能是：

```
function StreamToString(aStream: TStream): string;
var
  SS: TStringStream;
begin
  if aStream <> nil then
  begin
    SS := TStringStream.Create('');
    try
      SS.CopyFrom(aStream, 0);  // No need to position at 0 nor provide size
      Result := SS.DataString;
    finally
      SS.Free;
    end;
  end else
  begin
    Result := '';
  end;
end; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-12-31T01:33:43.097

我用：

```
function StreamToString(const Stream: TStream; const Encoding: TEncoding): string;
var
  StringBytes: TBytes;
begin
  Stream.Position := 0;
  SetLength(StringBytes, Stream.Size);
  Stream.ReadBuffer(StringBytes, Stream.Size);
  Result := Encoding.GetString(StringBytes);
end; 
```

它仅在 Delphi XE7 上进行了测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-09T03:31:02.607

我还没有升级，但我的理解是：

```
NewCapacity := (M.Size + 1) * SizeOf(Char); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-10-10T10:44:26.177

有一个因素`TStringStream`可以帮助你。. .您可以像这样加载另一个流的内容：

```
var StringStream: TStringStream; 
begin StringStream := TStringStream.Create(''); 
StringStream.CopyFrom(OtherStream, OtherStream.Size); 
end; 
```

您现在可以进入这样的字符串类型的系列：数据字符串属性包含系列......但不要尝试使用大型对象，例如在您将大文件加载到某个文件流然后复制的情况下这到你自己的字符串流并努力产生它，因为它安排了大量的内存！

希望有帮助

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-19T10:42:15.393

您可以将其转换为正确大小的字符指针，然后简单地分配它：

```
procedure getMemoryStreamAsString( aMS_ : TMemoryStream );
var
  ws : widestring; // in newer Delphi it can be string
  ans : ansistring;
begin
  ws := pwidechar( aMS_.memory );
  // OR
  ans := pansichar( aMS_.memory );
end; 
```

# visual-studio - 调试 ASP.NET MVC 应用程序时，未命中断点

> ID：732674
> 
> 赞同：29
> 
> 时间：2009-04-09T03:29:45.387
> 
> 标签：visual-studio, debugging, breakpoints

尝试调试 ASP.NET MVC 应用程序时，我的控制器中的断点没有被命中。进入调试模式时，它们只显示一个带有警告三角形的空红色圆圈，而不是正常的完整圆圈。这很奇怪，因为到目前为止调试工作正常，并且有一段时间没有在我的环境中进行任何配置更改。

我已经看到[了这个问题](https://stackoverflow.com/questions/60093/why-would-breakpoints-in-vs2008-stop-working)并查看了我的模块视图，但没有加载正确的模块视图，但是我不确定如何解决这个问题。此外，所有相关的 pdb 文件都在站点的 bin 文件夹中。

对于如何解决这个问题，有任何的建议吗？

干杯!

**编辑：**该应用程序在 IIS7 上作为本地站点运行，我正在使用 VS 2008 进行调试

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-09T04:44:57.953

好的，在浪费了 4 个小时之后，我发现将我的 web 项目设置为启动项目解决了这个问题！这肯定是个bug……

我希望我在那里救人半天:)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-09-09T03:44:51.077

更多可能性：

*   如果您的解决方案中有客户端和服务器（比如说 WPF 和 WCF 应用程序），您应该确保选择“[多个启动项目](http://msdn.microsoft.com/en-us/library/a1awth7y.aspx)”。*[这与您接受的答案相似，但如果您也需要运行客户端，这很有用]*

*   为项目选择了发布模式。在新机器上进行新获取（正如我今天发现的）时，VS 似乎喜欢切换到“发布”配置文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-23T17:51:04.887

一些团队成员删除了一个项目（MVC 项目）的调试配置。虽然解决方案配置设置为“调试/AnyCPU”，但如果您查看配置，MVC 项目的项目配置设置为发布，没有调试选项，所有其他项目都设置为调试适当.

所以我将调试添加回项目配置（只需下拉“添加”......取消选中该框以添加到解决方案）。还有中提琴...

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-02-19T22:09:19.947

我有同样的问题。检查这里：工具->选项->调试

通过选择启用 .Net Framework 源步进进行修复

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-09T03:33:53.570

要尝试的事情：

1.  清理解决方案，然后重建它。

2.  如果这不起作用，请关闭解决方案，删除`bin`和`obj`文件夹，然后重新构建。

3.  如果这不起作用，请在执行步骤 #2 后重新启动 IDE。
4.  如果您正在调试由 IIS 托管的 ASP.NET 项目，请确保您已附加到正确的进程 ( `w3wp.exe`)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-08-23T17:07:24.273

这些答案都没有帮助我。我的一些断点被击中，有些没有。但我发现了我的问题。

如果在完全相同的虚拟位置存在与您尝试调试的 URL 同名的文件，则该文件将由 IIS 自动提供给浏览器，并且不会命中断点，因为实际上没有 MVC 代码运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-09T03:40:37.827

当我遇到这个问题时，以下内容大部分时间都对我有用：

查找项目 dll 缓存的保存位置（通常在 ASP.NET 临时文件中）。然后关闭 VS，执行 IISRESET /stop（如果您使用的是 IIS），删除 dll 缓存中的所有文件。做一个IISRESET，启动VS，打开你的项目并重建它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-13T09:45:34.423

将 Visual Studio Header Release 选项更改为 Debug

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-07-02T10:49:04.570

大多数时候，您的解决方案已更改为调试到发布模式。

[https://www.youtube.com/watch?v=Tc-EamOXAcQ](https://www.youtube.com/watch?v=Tc-EamOXAcQ)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-13T03:26:10.650

我有同样的问题。检查这里：工具->选项->调试

选中脚本复选框。运行应用程序。

我得到了安装损坏的消息框，vs 2008 的修复也是如此，它现在可以工作了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-05-20T11:03:20.990

我今天遇到了这个问题 - 然后发现它发生的原因是：

1.  Visual Studio 2008 崩溃了，Cassini（内部开发 Web 服务器）在原始端口上运行。

2.  当我重新打开我的项目并“启动”它时，它无法在原始端口上运行，因为旧的开发 Web 服务器仍在运行（我没有注意到）

3.  页面浏览良好，但没有遇到断点，因为我使用的 URL 仍然指向旧的开发 Web 服务器端口。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-07-31T13:52:47.673

清洁/重建对我不起作用。重新启动VS。

VS 2012，ASP.NET MVC 3，IIS Express。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-07T20:52:17.647

确保您的编译框架版本与您项目的编译框架版本相同。我遇到了这个问题，这是因为该项目正在编译为 4.5，并且 Web 配置中的编译属性试图将其调试为 4.5.1。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-10-02T06:54:28.943

它可能有助于：

1.  关闭 Visual Studio
2.  在 IIS 管理器中停止应用程序池
3.  删除 bin 和 obj 文件夹
4.  启动应用程序池
5.  打开 Visual Studio 并重建解决方案

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-10-24T15:11:43.980

我在 Visual Studio 2015 中的一个简单的 Web API 项目中遇到了类似的问题。在阅读了简单的解决方法是将启动项目设置为正确的项目之后，我解决了这个问题。由于我在同一个解决方案中有另一个 Web API 项目，我猜测我正在调试的项目混淆了要调试的 index.html，因此我将当前的项目重命名为 index2.html。然后将项目属性 Web 选项卡设置为特定页面和页面文本：“index2.html”解决了这个问题。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-05-24T15:19:39.137

我的解决方案基本上是我的错误，因为我移动了项目文件夹。我的决议是，在我移动文件夹后，不要使用“打开...打开网站”，然后浏览到您的网站文件夹。不要浏览到您的解决方案`.sln`文件并用它打开。相反，请使用“打开...项目/解决方案”，然后浏览到您的 csproj 文件并打开它。首先关闭 IIS(Express)。重建。它应该运行最新的副本。每次都会把`.sln`你搞砸。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-10-23T14:24:26.027

我搁置了我在 TFS 中的更改，并在搁置的 cs 文件上设置了一个断点，该文件不再是解决方案的一部分。一旦我取回了我的 Shelveset，一切正常。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-01-11T12:43:15.207

快速解决...

在调试中运行我的项目。清理和重建解决方案 (MVC)。

重新运行 UI 项目，断点再次开始工作。

希望这会对某人有所帮助。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-04-29T23:59:25.710

我已阅读并实施了上述所有建议，但无济于事。

对我有用的是，我只是将我试图闯入的控制器操作更改为 [HttpPost]。

我的问题是我试图调试一个装饰有 [HttpGet] 属性的方法路由到不同的视图，而不是达到我的断点，它继续路由并显示返回视图。

希望这对某人有帮助！

快乐编码。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-12-16T12:51:36.303

我发现项目属性窗口“构建”选项卡上的“优化代码”复选框也会导致这种情况发生。

也取消选中此复选框。

[![优化项目属性的构建选项卡上的代码复选框](https://i.stack.imgur.com/NJHh5.png)](https://i.stack.imgur.com/NJHh5.png)

# c# - 从字符串转换为

> ID：732677
> 
> 赞同：73
> 
> 时间：2009-04-09T03:33:15.100
> 
> 标签：c#, xml, generics

我真的应该能够得到这个，但我只是到了我认为更容易问的地步。

在 C# 函数中：

```
public static T GetValue<T>(String value) where T:new()
{
   //Magic happens here
} 
```

什么是魔术的好实现？这背后的想法是我有 xml 来解析，并且所需的值通常是原语（bool、int、string 等），这是使用泛型的理想场所......但一个简单的解决方案目前正在躲避我.

顺便说一句，这是我需要解析的 xml 示例

```
<Items>
    <item>
        <ItemType>PIANO</ItemType>
        <Name>A Yamaha piano</Name>
        <properties>
            <allowUpdates>false</allowUpdates>
            <allowCopy>true</allowCopy>
        </properties>   
    </item>
    <item>
        <ItemType>PIANO_BENCH</ItemType>
        <Name>A black piano bench</Name>
        <properties>
            <allowUpdates>true</allowUpdates>
            <allowCopy>false</allowCopy>
            <url>www.yamaha.com</url>
        </properties>
    </item>
    <item>
        <ItemType>DESK_LAMP</ItemType>
        <Name>A Verilux desk lamp</Name>
        <properties>
            <allowUpdates>true</allowUpdates>
            <allowCopy>true</allowCopy>
            <quantity>2</quantity>
        </properties>
    </item>
</Items> 
```

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2009-04-09T03:44:27.850

我建议您尝试创建将从 XML 反序列化到类中的类，而不是尝试自己解析 XML。我**强烈**建议您遵循本德威的回答。

但如果你不能做到这一点，那就有希望了。您可以使用[`Convert.ChangeType`](http://msdn.microsoft.com/en-us/library/dtb69x08.aspx).

```
public static T GetValue<T>(String value)
{
  return (T)Convert.ChangeType(value, typeof(T));
} 
```

像这样使用

```
GetValue<int>("12"); // = 12
GetValue<DateTime>("12/12/98"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-09T03:45:05.103

你可以从大致这样的东西开始：

```
TypeConverter converter = TypeDescriptor.GetConverter(typeof(T));
if (converter != null)
{
   return (T)converter.ConvertFrom(value);
} 
```

如果您必须解析特殊类型的属性，例如颜色或文化字符串等，您当然必须在上面构建特殊情况。但这将处理您的大多数原始类型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T03:57:18.427

如果您决定采用 POCO（普通旧 CLR 对象）的序列化路线，那么很少有工具可以帮助您生成对象。

*   您可以使用[xsd.exe](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)根据您的 XML 定义生成 .cs 文件
*   [WCF REST Starter Kit Preview 2](http://msdn.microsoft.com/en-us/netframework/dd547388.aspx)中有一个新功能，称为 Paste as Html。这个功能真的很酷，它可以让你在剪贴板中获取一个 HTML 块，然后当你将它粘贴到一个 cs 文件中时，它会自动将 xml 转换为 CLR 对象以进行序列化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T03:45:12.590

为了使其正常工作，您的泛型方法将不得不将其实际工作委托给专用类。

就像是

```
private Dictionary<System.Type, IDeserializer> _Deserializers;
    public static T GetValue<T>(String value) where T:new()
    {
       return _Deserializers[typeof(T)].GetValue(value) as T;
    } 
```

其中 _Deserializers 是您在其中注册类的某种字典。（显然，需要进行一些检查以确保反序列化程序已在字典中注册）。

（在这种情况下， where T:new() 是无用的，因为您的方法不需要创建任何对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T04:23:16.990

再次警告说这样做可能是一个坏主意：

```
class Item 
{
    public string ItemType { get; set; }
    public string Name { get; set; }
}

public static T GetValue<T>(string xml) where T : new()
{
    var omgwtf = Activator.CreateInstance<T>();
    var xmlElement = XElement.Parse(xml);
    foreach (var child in xmlElement.Descendants())
    {
        var property = omgwtf.GetType().GetProperty(child.Name.LocalName);
        if (property != null) 
            property.SetValue(omgwtf, child.Value, null);
    }
    return omgwtf;
} 
```

测试运行：

```
static void Main(string[] args)
{
    Item piano = GetValue<Item>(@"
        <Item>
            <ItemType />
            <Name>A Yamaha Piano</Name>
            <Moose>asdf</Moose>
        </Item>");
} 
```

# java - 请确认此 XMPP 代码不是线程安全的

> ID：732680
> 
> 赞同：1
> 
> 时间：2009-04-09T03:34:07.780
> 
> 标签：java, multithreading, concurrency, xmpp

我正在阅读 Smack api 的源代码，方法 XMPPConnection# *disconnect*如下所示：

```
public void disconnect(Presence unavailablePresence) {
    // If not connected, ignore this request.
    if (packetReader == null || packetWriter == null) {
        return;
    }

    shutdown(unavailablePresence);

    if (roster != null) {
        roster.cleanup();
        roster = null;
    }

    wasAuthenticated = false;

    packetWriter.cleanup();
    packetWriter = null;
    packetReader.cleanup();
    packetReader = null;
} 
```

在我的场景中，我将一个实时 XMPPConnection 存储在一个名为 Session 的类中。一个单独的执行线程将尝试通过调用 Session# *shutdown()*来关闭我的 XMPPConnection 实例。正如我所看到的，我将不得不合作地告诉 Session 通过获取互斥锁或其他东西来关闭 XMPPConnection。正确的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T04:02:31.753

看起来这是一个[已知的错误](http://www.igniterealtime.org/issues/browse/SMACK-230)。

# tortoisesvn - TortoiseSVN：无法读取 VM 中的状态行

> ID：732681
> 
> 赞同：1
> 
> 时间：2009-04-09T03:34:09.077
> 
> 标签：tortoisesvn

我在虚拟机中的 TorToiseSVN 1.6 中遇到了一个奇怪的问题：我无法从任何在线源代码控制系统中签出文件。我测试过的一个例子是：

```
http://codesmith.googlecode.com/svn/trunk/ 
```

我得到的错误是

```
options of *: could not read status line: connection was closed by http://codesmith.googlecode.com 
```

我尝试在虚拟机上禁用防火墙和防病毒软件，将虚拟机的连接设置为 NAT，但仍然无法正常工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-09T01:55:55.923

这很可能是代理问题。将 URL 切换为 HTTPS 时会发生什么？

```
https://codesmith.googlecode.com/svn/trunk/ 
```

注意 - 您必须具有写入权限才能通过 https 进行连接。如果它通过 https 工作，那么这是一个代理问题。见[http://subversion.apache.org/faq.html#proxy](http://subversion.apache.org/faq.html#proxy)

要进一步排除故障，您可以尝试从以下 URL 进行结帐：

```
http://svn.collab.net:81/repos/svn/trunk/
http://svn.apache.org/repos/asf/subversion/trunk/
https://svn.apache.org/repos/asf/subversion/trunk/ 
```

Collab.net 监听端口 81 和端口 80 以帮助人们绕过代理。此外，他们的 https 服务器不需要身份验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T14:53:04.013

我在我的服务器上遇到了这个问题，结果证明是服务器端的 HTTP/HTTPS 问题。您的 ISP 或网络是否可能正在使用不可见的 HTTP 代理？

更重要的是，它可以在 VM 之外工作吗？然后，至少您可以将其缩小到 VM 设置或您的连接。也许您也可以从 VM 内的命令行尝试 SVN CHECKOUT，以防万一这是 Tortise 问题。

您可以运行以下内容来查看隐藏代理是否干扰了您的连接： http: [//netalyzr.icsi.berkeley.edu/](http://netalyzr.icsi.berkeley.edu/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-06T10:08:45.280

如果您将该 url 添加到浏览器中，您是否在 VM 和外部获得相同的数据？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-13T03:47:49.307

您正在运行哪种 VM 软件？在 VMWare 中，我可以根据经验说我尝试过的某些类型的网络操作在 NAT 下失败了。NAT抽象层可以破坏事物；但是，当我切换到“桥接”时，一切正常。我建议您尝试将您的 NIC 设置为“桥接”，无论您运行的是哪种 VM 软件。以下是 VMWare 产品的描述：

> 使用桥接网络，虚拟机显示为与主机位于同一物理以太网网络上的附加计算机。然后，虚拟机可以透明地使用它所桥接的网络上的任何可用服务，包括文件服务器、打印机和网关。同样，任何配置了桥接网络的物理主机或其他虚拟机都可以使用该虚拟机的资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-07T20:20:43.460

可能是一个愚蠢的问题，但是您是否配置了代理（如果需要）？它不使用 IE 设置，而是在 TortoiseSVN -> 设置 -> 网络页面上。

（对不起，如果您想到了这一点，但问题没有说明）

# java - 实现一个更有效的矩阵 - 使用数组数组 (2D) 还是 1D 数组？

> ID：732684
> 
> 赞同：12
> 
> 时间：2009-04-09T03:36:29.630
> 
> 标签：java, arrays, performance, multidimensional-array

使用数组实现 Matrix 构造时，哪个更有效？使用一维数组还是数组数组（二维）？

我认为 2D 更有效，因为您已经拥有元素的 X 和 Y 坐标，而在 1D 实现中，您必须计算索引。

编辑：它正在使用 Java 实现

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-09T03:39:01.997

“高效”并不是一个包罗万象的术语。

数组的数组解决方案在存储方面更有效，其中数组可能是稀疏的（即，您可以使用空指针来表示全为零的矩阵行）。这将是（在 C 中）：

```
int *x[9]; 
```

每个`"int *"`都将单独分配。

二维数组（不一定是数组数组）通常会更快（在速度方面效率更高），因为它可以通过数学计算内存位置，而无需取消引用内存位置。我说的是构造：

```
int x[9][9]; 
```

一维数组的形式：

```
int x[81]; 
```

不太可能比等效的 2D 版本更快，因为您仍然需要在某些时候进行计算才能找到正确的单元格（在您的代码中手动而不是让编译器来做）。

*编辑后添加 Java 作为要求：*

我相信 Java 2D 数组属于数组类型的数组（这将需要两次内存访问，而不是 1D 数组所需的一次），因此具有手动索引计算的 1D 数组可能会更快。所以，而不是声明和使用：

```
int x[width][height];
x[a][b] = 2; 
```

您可以通过以下方式获得更快的速度：

```
int x[width*height];
x[a*height+b] = 2; 
```

您只需要注意不要在任何地方混淆公式（即不要无意中交换 4 和 7）。

这种速度差异基于我认为 Java 在幕后编码的方式，所以我可能是错的（但我对此表示怀疑 :-)。我的建议是，一如既往地优化问题，*衡量，不要猜测！*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T04:02:02.767

我将用迄今为止的答案打破排名，并提出以下原因，即一维数组很可能更快。

二维数组涉及 2 次内存访问。例如，A[x][y] 首先必须查找 A[x]，然后再查找该数组 [y]。

一维实现传统上是 A[x + (width *y)]。当宽度在寄存器（或文字）中时，这意味着 2 个数学运算和 1 个查找而不是 2 个查找。查找比数学运算慢几个数量级，所以如果宽度在寄存器中的比例很小，或者是文字，它会更快。

当然，标准警告适用。始终分析并避免过早的优化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T04:19:50.027

**如果不实际编写示例代码并测试结果，**我认为无法回答这个问题。例如[这个问题](https://stackoverflow.com/questions/468832/why-are-multi-dimensional-arrays-in-net-slower-than-normal-arrays)发现了以下结果。

```
sum(double[], int): 2738 ms (100%)
sum(double[,]):     5019 ms (183%)
sum(double[][]):    2540 ms ( 93%) 
```

锯齿状数组最快，其次是一维数组，其次是多维数组。锯齿状阵列最快可能不是人们所预料的。这些结果可能对 Java 毫无用处，因为 Java 有不同的优化（Java 中没有多维数组）。

**我会非常小心地做出假设。** 例如，如果您在 2D 数组的一行上循环，Java 可能会优化索引查找或越界检查，如果您使用具有内联索引计算的 1D 数组，Java 可能无法做到这一点。

我建议编写一个简单的程序来测试所需平台上的速度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T03:40:39.497

根据语言的不同，不会有任何区别。真正的问题是如何分配二维矩阵。它是 X*Y 字节的单个连续空间，还是分配为 X 大小的 Y 独立数组。后者通常在创建稀疏矩阵时完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T09:57:35.673

我在作为机械工程师的职业生涯中使用的商业有限元包，它使用一维数组作为其线性代数计算的基础。有限元方法导致矩阵大、稀疏和带状。将所有这些零元素存储在带外是没有意义的。

唯一一次您会看到二维数组用于小型学术问题或不稀疏的问题（例如，边界元素方法）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T10:57:59.257

在一般情况下，任何算法的最有效实现是具有最少代码量的算法。这有很多原因：

*   更少的代码 -> 更少的编写时间
*   更少的代码行意味着更少的错误（因为每个 KLOC 的错误对于给定的程序员来说是相当稳定的），更容易找到（因为它们不能很好地隐藏在几行代码中）
*   如果您的算法不适合该任务，那么当它是 10 行而不是 100 行时更容易替换
*   一个紧凑的实现通常会导致干净的接口，这使得*使用*库的代码干净（因此效果成倍增加）。这也可能导致更复杂的库实现，如果这使客户端代码更高效（即您将精力集中在一个地方以使其他一切更简单）。

它还很大程度上取决于访问模式。你总是走整个矩阵吗？稀疏吗？您喜欢处理行还是列？

在极端情况下（具有 10 亿行和列的矩阵，仅使用 10 个单元格），a`HashMap`可以比任何数组实现更有效。对于其他问题，根据问题混合方法可能更有效（例如，`HashMap`当单元格“聚集”在巨大的空白空间中时，一组迷你矩阵）。

如果您的问题要求定位行/列然后处理这些值，则使用 2D 方法可能更有效，因此第一次访问会返回一个数组，然后您可以处理该数组而无需担心边界、一次性错误、等等

# c++ - 快速射线相交的线段容器？(2D)

> ID：732687
> 
> 赞同：4
> 
> 时间：2009-04-09T03:38:38.533
> 
> 标签：c++, geometry, intersection, line-segment

我有一条射线，我需要找到它击中的最近的线段。如果我首先对线段进行排序，我认为可以在 O(log n) 时间内完成此操作，但我不记得如何对它们进行排序......我认为某种树会工作得最好，但我该如何排序他们的起点和终点？如果可能的话，我还想快速插入这个数据结构。

一条射线与一条线段有很多代​​码，但我需要一条射线与许多线段的代码……我不知道谷歌的术语是什么。

适当文章的链接很好，C++ 代码更好。谢谢！:)

PS：线段实际上是非自相交多边形的边缘，按逆时针顺序排序......但我认为以不同的方式对它们进行排序可能会有一些优势？

这都是二维的。

* * *

再三考虑，我不完全确定这*是*可能的。某种空间分区可能会有所帮助，但除此之外，我想不出任何方法来对线条进行排序，以便将它们与任意光线进行比较。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-14T12:59:25.023

您可以获取多边形的边界框（最小-最大 x,y 坐标）并在框内构建一个网格。然后，对于每个单元格，记住所有穿过单元格的线。

找到这样的交叉点：

*   找出光线首先击中的单元格 (O(1))
*   使用[网格遍历算法](http://www.devmaster.net/articles/raytracing_series/part4.php)通过网格“绘制”一条射线。当您点击非空单元格时，检查其所有行，检查交叉点是否在单元格内并选择最近的交叉点。如果所有交叉点都在单元格之外，则继续（这是 O（网格长度））。

您还可以使网格分层（即[四叉树](http://www.codeproject.com/KB/recipes/QuadTree.aspx)-您要求的树），并使用相同的算法对其进行遍历。[这是在 3D 光线追踪中完成的，](http://www.devmaster.net/articles/raytracing_series/part4.php)时间复杂度为 O(sqrt(N))。

* * *

或者，使用我在光线追踪器中使用的方法：

*   构建包含线条的[四叉](http://www.codeproject.com/KB/recipes/QuadTree.aspx)树（文章中描述了构建四叉树） - 如果节点（=区域）包含太多对象，则将它们拆分为 4 个子节点（子区域）
*   收集被射线击中的四叉树的所有*叶节点：*

    计算根的射线-矩形交点（不难）。如果根被射线击中，则递归地处理其子项。

很酷的一点是，当一个树节点*没有*被命中时，你就跳过了处理整个子树（可能是一个大的矩形区域）。

最后，这相当于遍历网格——收集光线路径上最小的单元，然后测试其中的所有对象是否相交。您只需要测试所有这些并选择最近的交叉点（这样您就可以探索光线路径上的所有线）。

这是 O(sqrt(N))。

在网格遍历中，当你找到一个交叉点时，你可以停止搜索。要通过四叉树遍历来实现这一点，您必须以正确的顺序搜索孩子 - 要么按距离对 4 个矩形交叉点进行排序，要么巧妙地遍历 4 单元格网格（我们回到遍历）。

这只是一种不同的方法，我认为实施起来相对困难，并且效果很好（我在真实数据上对其进行了测试 - O(sqrt(N))）。同样，如果您至少有几条线，您只会从这种方法中受益，当多边形有 10 条边时，与仅测试所有边相比，我认为优势很小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T03:55:16.730

你怎么确定你会击中他们中的任何一个？如果它们是线条，则不太可能。

如果它确实是您要测试的多边形（即平面），则执行此类操作的通常方法是首先与平面相交，然后测试该点（在 2d 坐标中）的内部/外部多边形。

也许我误解了你实际上在做什么。

一般来说，加速与复杂图形的交叉点是通过空间分区来完成的（如果你的测试很昂贵，那么可以使用邮箱等技术）。

[更新：我误读了原意]您仍然可以使用（2d）空间分区，但开销可能不值得。个人测试很便宜，如果您的多边形不复杂，那么步行可能会更便宜。从描述很难说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T03:56:16.540

您是否正在寻找基于扫描线/活动边缘表的方法？您可以查看[扫描线渲染](http://en.wikipedia.org/wiki/Scanline_rendering)的 Wikipedia 条目或在[Graphics Gems](http://www.geom.uiuc.edu/software/cglist/libs.html#gems)目录中搜索算法（主要是 C，但也有一些 C++ 代码）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T03:58:50.060

请记住，排序最多是一个 O(n log n) 操作。您最好单独检查每个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T00:11:08.840

要求澄清，这是正确的吗？

*   您有一组动态的线段*L*。
*   查询：给定**任意**点 (x,y) 以及从该点开始的射线的**任意**方向，您想确定*L*中最近的线（如果有的话）？

所以点 (x,y) 不固定？（它可以是任何一点，任何方向？）

# telnet - 远程登录服务器

> ID：732693
> 
> 赞同：0
> 
> 时间：2009-04-09T03:44:08.333
> 
> 标签：telnet

系统正在尝试连续多次远程登录到服务器。尝试 telnet 的进程是否有可能由于缓冲区溢出而崩溃？我的情况是一个循环中的 perl 程序在 10 秒内尝试 500 次打开 telnet 连接并关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T04:41:17.197

在 10 秒内 Telnet 500 次不应使您的客户端程序崩溃，但我怀疑您在服务器上的 telnet 和登录进程能否跟上这种连接速率。您需要想办法让 telnet 连接保持打开状态或切换到为轮询设计的协议，例如 SNMP。

话虽如此，您并没有指出您正在使用什么 Telnet 库或程序，因此肯定存在错误的可能性。

简而言之，我认为您的用例并不真正符合 Telnet 规范。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T03:56:57.383

我们需要查看 Perl 程序（我假设你有它，否则你怎么知道它是 Perl）。

一种可能性是 Perl 脚本无法识别 telnet 守护程序提供的登录字符串，因此正在关闭连接并重试。

我不确定您为什么认为这是缓冲区溢出（除非您有我们没有的信息）。在我看来，如果 Perl（解释器，而不是脚本）发生缓冲区溢出，它只会崩溃并且不会重试（假设没有其他东西重试脚本）。

如果您认为您的脚本存在缓冲区溢出问题，我们需要再次查看它以帮助您解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-29T08:16:42.857

为什么你不能让 telnet 连接保持打开状态？

我会只打开一个 telnet 连接并保持打开状态并使用它来发送和接收数据。如果在指定的超时时间内没有响应，则关闭它并再次打开它。

# vb.net - vb.net 中的富文本框

> ID：732695
> 
> 赞同：0
> 
> 时间：2009-04-09T03:44:34.150
> 
> 标签：vb.net, richtextbox

我在我的 vb.net 应用程序中使用了一个富文本框，我需要在其中显示数据库中的前 10 条记录。但它只显示 1 条记录。该怎么办？请帮助......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T03:48:00.523

我认为您可能选择了错误的控件。您可能想研究使用[GridView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.aspx)或其他一些存在的控件来显示多条记录。

如果您真的想在 TextBox 中显示 10 条记录的值，则必须以不同的方式解决问题。您可以将这些值连接成一个字符串并将其分配给 TextBox 的 Text 属性，尽管我认为这并不是一个很好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T09:37:49.290

我使用了以下代码行，它工作得非常好：

```
 If rcount < 10 Then
     rcount = rcount + 1
     RtxtMessage.ScrollBars = RichTextBoxScrollBars.None
     RtxtMessage.Text = RtxtMessage.Text + " " + 
     CType(dv.Item(i)("audit_message"), String) & vbCrLf
 End If 
```

# windows - 是否可以查询特定域用户当前登录的 IP 地址（或机器名称）列表？

> ID：732696
> 
> 赞同：2
> 
> 时间：2009-04-09T03:44:56.617
> 
> 标签：windows, active-directory, ldap, dns, ip-address

是否可以查询域用户当前登录的域计算机的 IP 地址（或机器名称）列表？

[“在 Windows 中使用或不使用域的情况下登录用户名”](https://stackoverflow.com/questions/124967/getting-logged-on-users-name-with-or-without-domain-in-windows)这个问题很接近，只有我想找到相反的答案。

由于我对 Active Directory 的内部知识缺乏了解，我询问了这种可能性。我的直觉是 Active Directory 只知道域用户最后一次身份验证的时间（以及可能的位置），并且不跟踪当前会话或注销。

提供此解决方案的任何语言都是可接受的答案，但首选 .NET 解决方案。更重要的是，我想知道这是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T17:13:25.647

我不相信有一个地方可以获得这些信息。您可以找出用户上次登录的时间以及从 AD 验证的 DC，但问题是当您登录时第一个响应的 DC 是验证的服务器。然后，该 DC 将此信息记录到其事件日志中，该事件日志驻留在每个主机上，而不是在中央系统中。您可以从这些链接中了解更多信息：http: [//support.microsoft.com/kb/175062](http://support.microsoft.com/kb/175062) 和 [http://www.tartoos.com/HomePage/Rtable/ComputerSchool/Networking/Net41.htm](http://www.tartoos.com/HomePage/Rtable/ComputerSchool/Networking/Net41.htm) 话虽如此，我想您可以从用户帐户的 lastLogonTimestamp AD 属性中获取最后一次登录，然后从域中的所有 DC 中查询事件日志，以找出对它们进行身份验证的 DC 以及来自哪个系统。但是所有这一切只会告诉最后一个登录系统......不是他们可以登录的所有系统。再次，您可以将这些结果与可以从 DC 事件日志中提取的注销时间进行比较……但实际上这似乎是一个主要的矫枉过正的努力，并且您最好编写一个记录这些事件的登录/注销脚本到您可以用于将来使用的中央报告系统。

这是另一种选择，您可以查询您的 WINS 服务器以轮询它为用户提供的登录信息，这应该返回它认为他们登录的系统，请参阅这篇文章了解如何执行此操作：

[http://www.visualbasicscript.com/m_56230/tm.htm](http://www.visualbasicscript.com/m_56230/tm.htm)

基本上命令是：`"NETSH WINS SERVER \\WinsServerName SHOW NAME UserName 03"`

如果您使用某种资产/系统管理软件，例如 Desktop Authority、Altiris 等，那么您可能会更幸运地探索桌面代理记录此信息的位置，因为它们通常也会将此信息记录到某些 SQL 表中。

# audio - 音频在计算机中是如何用数字表示的？

> ID：732699
> 
> 赞同：51
> 
> 时间：2009-04-09T03:46:30.090
> 
> 标签：audio

我喜欢思考一切事物如何能够以数字表示。例如，明文由 ASCII 等代码表示，图像由 RGB 值表示。这些是表示文本和图像的最简单方法。

用数字表示音频的最简单方法是什么？我想学习如何编写与音频一起工作的程序，并认为这是一个很好的开始方式。不过，我似乎在互联网上找不到任何好的解释。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-04-09T04:43:13.183

从物理上讲，您可能知道，音频是一种振动。通常，我们谈论的是大约 20Hz 到 20,000Hz 之间的空气振动。这意味着空气每秒来回移动 20 到 20,000 次。

如果您测量该振动并将其转换为电信号（例如，使用麦克风），您将获得一个电信号，其电压以与声音相同的波形变化。在我们的纯音假设中，该波形将与正弦函数的波形相匹配。

现在，我们有一个模拟信号，电压。仍然不是数字。但是，我们知道这个电压在（例如）-1V 和 +1V 之间变化。当然，我们可以在电线上连接一个电压表并读取电压。

我们将随意更改电压表上的刻度。我们将伏特乘以 32767。它现在调用 -1V *-32767*和 +1V *32767*。哦，它会四舍五入到最接近的整数。

现在，我们将电压表连接到计算机，并指示计算机每秒读取电压表 44,100 次。添加第二个电压表（用于另一个立体声通道），我们现在有了音频 CD 上的数据。

这种格式称为*立体声 44,100 Hz、16 位线性 PCM*。它实际上只是一堆电压测量值。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-04-08T23:27:55.083

**最小 C 音频生成示例**

下面的示例以原始格式生成纯 1000k Hz 正弦波。在常见的 44.1kHz 采样率下，它将持续大约 4 秒。

主.c：

```
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

int main(void) {
    FILE *f;
    const double PI2 = 2 * acos(-1.0);
    const double SAMPLE_FREQ = 44100;
    const unsigned int NSAMPLES = 4 * SAMPLE_FREQ;
    uint16_t ampl;
    uint8_t bytes[2];
    unsigned int t;

    f = fopen("out.raw", "wb");
    for (t = 0; t < NSAMPLES; ++t) {
        ampl = UINT16_MAX * 0.5 * (1.0 + sin(PI2 * t * 1000.0 / SAMPLE_FREQ));
        bytes[0] = ampl >> 8;
        bytes[1] = ampl & 0xFF;
        fwrite(bytes, 2, sizeof(uint8_t), f);
    }
    fclose(f);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/blob/d046111efbd6353bd5d8df16733472baab2ffc52/c/interactive/audio_gen.c).

生成`out.raw`：

```
gcc -std=c99 -o main main.c -lm
./main 
```

直接播放`out.raw`：

```
sudo apt-get install ffmpeg
ffplay -autoexit -f u16be -ar 44100 -ac 1 out.raw 
```

或转换为更常见的音频格式，然后用更常见的音频播放器播放：

```
ffmpeg -f u16be -ar 44100 -ac 1 -i out.raw out.flac
vlc out.flac 
```

生成的 FLAC 文件：[https ://github.com/cirosantilli/media/blob/master/canon.flac](https://github.com/cirosantilli/media/blob/master/canon.flac)

参数解释在：[https ://superuser.com/questions/76665/how-to-play-a-pcm-file-on-an-unix-system/1063230#1063230](https://superuser.com/questions/76665/how-to-play-a-pcm-file-on-an-unix-system/1063230#1063230)

相关：[使用什么 ffmpeg 命令将无符号整数列表转换为音频文件？](https://stackoverflow.com/questions/55286149/what-ffmpeg-command-to-use-to-convert-a-list-of-unsigned-integers-into-an-audio)

在 Ubuntu 18.04 上测试。

**C大调D大调卡农**

这是一个更有趣的合成示例。

结果：[https ://www.youtube.com/watch?v=JISozfHATms](https://www.youtube.com/watch?v=JISozfHATms)

主程序

```
#include <math.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>

typedef uint16_t point_type_t;

double PI2;

void write_ampl(FILE *f, point_type_t ampl) {
    uint8_t bytes[2];
    bytes[0] = ampl >> 8;
    bytes[1] = ampl & 0xFF;
    fwrite(bytes, 2, sizeof(uint8_t), f);
}

/* https://en.wikipedia.org/wiki/Piano_key_frequencies */
double piano_freq(unsigned int i) {
    return 440.0 * pow(2, (i - 49.0) / 12.0);
}

/* Chord formed by the nth note of the piano. */
point_type_t piano_sum(unsigned int max_ampl, unsigned int time,
        double sample_freq, unsigned int nargs, unsigned int *notes) {
    unsigned int i;
    double sum = 0;
    for (i = 0 ; i < nargs; ++i)
        sum += sin(PI2 * time * piano_freq(notes[i]) / sample_freq);
    return max_ampl * 0.5 * (nargs + sum) / nargs;
}

enum notes {
    A0 = 1, AS0, B0,
    C1, C1S, D1, D1S, E1, F1, F1S, G1, G1S, A1, A1S, B1,
    C2, C2S, D2, D2S, E2, F2, F2S, G2, G2S, A2, A2S, B2,
    C3, C3S, D3, D3S, E3, F3, F3S, G3, G3S, A3, A3S, B3,
    C4, C4S, D4, D4S, E4, F4, F4S, G4, G4S, A4, A4S, B4,
    C5, C5S, D5, D5S, E5, F5, F5S, G5, G5S, A5, A5S, B5,
    C6, C6S, D6, D6S, E6, F6, F6S, G6, G6S, A6, A6S, B6,
    C7, C7S, D7, D7S, E7, F7, F7S, G7, G7S, A7, A7S, B7,
    C8,
};

int main(void) {
    FILE *f;
    PI2 = 2 * acos(-1.0);
    const double SAMPLE_FREQ = 44100;
    point_type_t ampl;
    point_type_t max_ampl = UINT16_MAX;
    unsigned int t, i;
    unsigned int samples_per_unit = SAMPLE_FREQ * 0.375;
    unsigned int *ip[] = {
        (unsigned int[]){4, 2, C3, E4},
        (unsigned int[]){4, 2, G3, D4},
        (unsigned int[]){4, 2, A3, C4},
        (unsigned int[]){4, 2, E3, B3},

        (unsigned int[]){4, 2, F3, A3},
        (unsigned int[]){4, 2, C3, G3},
        (unsigned int[]){4, 2, F3, A3},
        (unsigned int[]){4, 2, G3, B3},

        (unsigned int[]){4, 3, C3, G4, E5},
        (unsigned int[]){4, 3, G3, B4, D5},
        (unsigned int[]){4, 2, A3,     C5},
        (unsigned int[]){4, 3, E3, G4, B4},

        (unsigned int[]){4, 3, F3, C4, A4},
        (unsigned int[]){4, 3, C3, G4, G4},
        (unsigned int[]){4, 3, F3, F4, A4},
        (unsigned int[]){4, 3, G3, D4, B4},

        (unsigned int[]){2, 3, C4, E4, C5},
        (unsigned int[]){2, 3, C4, E4, C5},
        (unsigned int[]){2, 3, G3, D4, D5},
        (unsigned int[]){2, 3, G3, D4, B4},

        (unsigned int[]){2, 3, A3, C4, C5},
        (unsigned int[]){2, 3, A3, C4, E5},
        (unsigned int[]){2, 2, E3,     G5},
        (unsigned int[]){2, 2, E3,     G4},

        (unsigned int[]){2, 3, F3, A3, A4},
        (unsigned int[]){2, 3, F3, A3, F4},
        (unsigned int[]){2, 3, C3,     E4},
        (unsigned int[]){2, 3, C3,     G4},

        (unsigned int[]){2, 3, F3, A3, F4},
        (unsigned int[]){2, 3, F3, A3, C5},
        (unsigned int[]){2, 3, G3, B3, B4},
        (unsigned int[]){2, 3, G3, B3, G4},

        (unsigned int[]){2, 3, C4, E4, C5},
        (unsigned int[]){1, 3, C4, E4, E5},
        (unsigned int[]){1, 3, C4, E4, G5},
        (unsigned int[]){1, 2, G3,     G5},
        (unsigned int[]){1, 2, G3,     A5},
        (unsigned int[]){1, 2, G3,     G5},
        (unsigned int[]){1, 2, G3,     F5},

        (unsigned int[]){3, 3, A3, C4, E5},
        (unsigned int[]){1, 3, A3, C4, E5},
        (unsigned int[]){1, 3, E3, G3, E5},
        (unsigned int[]){1, 3, E3, G3, F5},
        (unsigned int[]){1, 3, E3, G3, E5},
        (unsigned int[]){1, 3, E3, G3, D5},
    };
    f = fopen("canon.raw", "wb");
    for (i = 0; i < sizeof(ip) / sizeof(int*); ++i) {
        unsigned int *cur = ip[i];
        unsigned int total = samples_per_unit * cur[0];
        for (t = 0; t < total; ++t) {
            ampl = piano_sum(max_ampl, t, SAMPLE_FREQ, cur[1], &cur[2]);
            write_ampl(f, ampl);
        }
    }
    fclose(f);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/blob/d046111efbd6353bd5d8df16733472baab2ffc52/c/interactive/audio_gen.c#L214).

对于 YouTube，我将其准备为：

```
wget -O canon.png https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/The_C_Programming_Language_logo.svg/564px-The_C_Programming_Language_logo.svg.png
ffmpeg -loop 1 -y -i canon.png -i canon.flac -shortest -acodec copy -vcodec vp9 canon.mkv 
```

如解释：[https ://superuser.com/questions/700419/how-to-convert-mp3-to-youtube-allowed-video-format/1472572#1472572](https://superuser.com/questions/700419/how-to-convert-mp3-to-youtube-allowed-video-format/1472572#1472572)

在 Ubuntu 18.04 上测试。

**物理**

音频在每一刻都被编码为一个数字。将其与每分钟需要 WIDTH * HEIGHT 数字的视频进行比较。

然后将该数字转换为扬声器[振膜的线性位移：](https://en.wikipedia.org/wiki/Diaphragm_%28acoustics%29)

```
|   /
|  /
|-/
| | A   I   R
|-\
|  \
|   \
<-> displacement

|     /
|    /
|---/
|   | A I   R
|---\
|    \
|     \
<---> displacement

|       /
|      /
|-----/
|     | A I R
|-----\
|      \
|       \
<-----> displacement 
```

位移推动空气前后移动，产生压力差，压力差以[P 波的](https://en.wikipedia.org/wiki/P-wave)形式穿过空气。

只有位移很重要：一个恒定的信号，即使是最大的，也不会产生声音：隔膜只是停留在一个固定的位置。

[采样频率](https://en.wikipedia.org/wiki/Sampling_%28signal_processing%29)决定了位移应该以多快的速度完成。

[44,1kHz](https://en.wikipedia.org/wiki/44,100_Hz)是一种常见的采样频率，因为人类可以听到高达 20kHz 的声音，并且由于[Nyquist-Shannon 采样定理](https://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem)。

采样频率类似于视频的 FPS，尽管与我们通常在视频中看到的 25（电影）- 144（硬核游戏监视器）范围相比，它的值要高得多。

**格式**

未压缩：

*   `.raw`是一种未指定格式，仅包含幅度字节，没有元数据。

    我们必须在命令行上传递一些元数据参数，例如采样频率，因为格式不包含该数据。

*   `.wav`是另一种流行的未压缩格式，其中包含所有需要的元数据：[WAV File Synthesis From Scratch - C](https://stackoverflow.com/questions/10844122/wav-file-synthesis-from-scratch-c)

*   MIDI ( `.mid`): [https://en.wikipedia.org/wiki/MIDI](https://en.wikipedia.org/wiki/MIDI)

    这种格式代表乐器的击键。结果文件大小可能非常小，但它不一定代表“任意声音”，更像是音符。这是基本数字键盘将输出到计算机的内容。然后，您需要一个合成器软件将这些音符转换为实际的声音幅度。此外，它更难便携，接收器需要完全相同的合成软件/数据库。

    转换为 MP3：[https ://softwarerecs.stackexchange.com/questions/10915/automatically-turn-midi-files-into-wav-or-mp3/76955#76955](https://softwarerecs.stackexchange.com/questions/10915/automatically-turn-midi-files-into-wav-or-mp3/76955#76955)

在实践中，大多数人只处理压缩​​格式，这使得文件流更小。其中一些格式考虑到人耳的特性，以人们不会注意到的有损方式进一步压缩音频。截至 2019 年，最受欢迎的免版税格式似乎是：

*   无损：[FLAC](https://en.wikipedia.org/wiki/FLAC)
*   有损：[Vorbis](https://en.wikipedia.org/wiki/Vorbis)

常见的

**生物学**

人类主要通过频率分解（又名[傅里叶变换](https://en.wikipedia.org/wiki/Fourier_transform)）来感知声音。

我认为这是因为内耳具有与不同频率产生共鸣的部分（TODO 确认）。

因此，在合成音乐时，我们更多地考虑将频率相加而不是时间点。本示例[对此](https://github.com/cirosantilli/cpp-cheat/blob/f734a2e76fbcfc67f707ae06be7a2a2ef5db47d1/c/interactive/audio_gen.c#L123)进行了说明。

这导致考虑每个时间点在 20Hz 和 20kHz 之间的一维向量。

数学傅里叶变换失去了时间的概念，所以我们在合成时所做的就是取一组点，然后对该组的频率求和，然后在那里进行傅里叶变换。

幸运的是，傅里叶变换是线性的，所以我们可以直接将位移相加和归一化。

每组点的大小导致时间-频率精度权衡，由与[海森堡不确定性原理](https://en.wikipedia.org/wiki/Uncertainty_principle)相同的数学调节。

[小波](https://math.stackexchange.com/questions/279980/difference-between-fourier-transform-and-wavelets)可能是对这种中间时间-频率描述的更精确的数学描述。

**开箱即用生成常见音调的快速方法**

令人惊叹的 FFmpeg 库涵盖了其中的几个：[Linux 正弦波音频发生器](https://stackoverflow.com/questions/5109038/linux-sinus-audio-generator/57610684#57610684)

```
sudo apt-get install ffmpeg
ffmpeg -f lavfi -i "sine=frequency=1000:duration=5" out.wav 
```

**管理系统**

这非常容易使用，如果您只是想生成一些开箱即用的带有大量合成选项的 MIDI 轨道，那么它应该是您的第一次尝试。

示例：[https ://askubuntu.com/questions/709673/save-as-midi-when-playing-from-vmpk-qsynth/1298231#1298231](https://askubuntu.com/questions/709673/save-as-midi-when-playing-from-vmpk-qsynth/1298231#1298231)

**MuseScore**

[https://github.com/musescore/MuseScore](https://github.com/musescore/MuseScore)

迄今为止我见过的最好的 FOSS[记分器GUI。](https://en.wikipedia.org/wiki/Scorewriter)你真的可以用它为管弦乐队作曲。

**声音**

[https://en.wikipedia.org/wiki/Csound](https://en.wikipedia.org/wiki/Csound)

[https://github.com/csound/csound](https://github.com/csound/csound)

读取自定义 XML 格式的程序，允许您创建一些非常时髦的任意合成声音和曲调。

```
sudo apt install csound 
```

这是一个非常酷且高级的演示：[https](https://github.com/csound/csound/blob/b319c336d31d942af2d279b636339df83dc9f9f9/examples/xanadu.csd) ://github.com/csound/csound/blob/b319c336d31d942af2d279b636339df83dc9f9f9/examples/xanadu.csd呈现在：[https ://www.youtube.com/watch?v=7fXhVMDCfaA](https://www.youtube.com/watch?v=7fXhVMDCfaA)

**阿克米迪**

将 MIDI 转换为[ABC 符号](https://en.wikipedia.org/wiki/ABC_notation)的好项目，反之亦然，允许您在文本编辑器中编辑 MIDI 文件：[https ://sound.stackexchange.com/questions/39457/how-to-open-midi-file-in -文本编辑器/50058#50058](https://sound.stackexchange.com/questions/39457/how-to-open-midi-file-in-text-editor/50058#50058)

**蟒蛇皮**

[https://github.com/belangeo/pyo](https://github.com/belangeo/pyo)

Python 声音库。

经过一番挫折后让它工作：[Pyo server.boot() 在 Ubuntu 14.04 上出现 pyolib._core.PyoServerStateException 失败](https://stackoverflow.com/questions/32445375/pyo-server-boot-fails-with-pyolib-core-pyoserverstateexception-on-ubuntu-14-0/64960589#64960589)

**音乐XML**

[https://en.wikipedia.org/wiki/MusicXML](https://en.wikipedia.org/wiki/MusicXML)

尝试标准化乐谱表示。

但是，我无法轻松找到如何从命令行将其转换为音频格式...[将 musicxml 转换为 wav？](https://stackoverflow.com/questions/33775336/convert-musicxml-to-wav/64974602#64974602)

**其他适用于 Linux 的高级开箱即用开源合成器**

如果你走这条路，不妨看看大佬们了解一下常用的合成技术：

*   [https://www.youtube.com/watch?v=cXCwH9n3M-c](https://www.youtube.com/watch?v=cXCwH9n3M-c) Zyn-Fusion + Ardor 合成音乐作曲教程“从零开始”由 unfa 提供，给他很大的荣誉
*   如何让 ZynAddSubFX 在 Ubuntu 上运行：[https ://askubuntu.com/questions/340204/zynaddsubfx-fails-to-initialize-with-error-message-default-io-did-not-initiali/1238546#1238546](https://askubuntu.com/questions/340204/zynaddsubfx-fails-to-initialize-with-error-message-default-i-o-did-not-initiali/1238546#1238546)
*   [http://linuxsynths.com/](http://linuxsynths.com/)使用生成的音频样本快速回顾所有这些

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-09T03:57:27.710

音频可以由数字样本表示。本质上，采样器（也称为模数转换器）每 1/fs 抓取一次音频信号的值，其中 fs 是采样频率。然后 ADC 对信号进行量化，这是一个舍入操作。因此，如果您的信号范围为 0 到 3 伏（满量程范围），则样本将四舍五入，例如 16 位数字。在此示例中，每 1/fs/ 记录一次 16 位数字

例如，大多数 WAV/MP3 以 44 kHz 的频率对音频信号进行采样。我不知道你想要多少细节，但是有一个叫做“奈奎斯特采样率”的东西说采样频率必须至少是所需频率的两倍。因此，在您的 WAV/MP3 文件中，您最多只能听到 22 kHz 的频率。

您可以在这方面了解很多细节。最简单的形式当然是 WAV 格式。它是未压缩的音频。mp3 和 ogg 等格式必须先解压缩，然后才能使用它们。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-09T04:32:32.693

将声音表示为数字的最简单方法是 PCM（脉冲编码调制）。这意味着以设定的频率记录声音的幅度（每个幅度值称为一个样本）。例如，CD 质量的声音是频率为 44100 Hz 的 16 位样本（立体声）。

样本可以表示为整数（通常为 8、12、16、24 或 32 位）或浮点数（16 位浮点数或 32 位双精度数）。该号码可以有符号或无符号。

对于 16 位有符号样本，值 0 将位于中间，-32768 和 32767 将是最大振幅。对于 16 位无符号样本，值 32768 将位于中间，0 和 65535 将是最大幅度。

对于浮点样本，通常的格式是 0 在中间，-1.0 和 1.0 是最大幅度。

然后可以压缩 PCM 数据，例如使用 MP3。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-09T03:49:50.550

我认为特定采样频率下的波形样本将是最基本的表示。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-09T03:50:16.103

你有没有近距离观察过波形？Y 轴简单地表示为一个整数，通常为 16 位。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-09T04:23:52.217

我认为开始播放音频的一个好方法是使用[Processing](http://processing.org/)和[Minim](http://code.compartmental.net/tools/minim/)。该程序将从您的麦克风中提取声音的频谱！

```
import ddf.minim.*;
import ddf.minim.analysis.*;

AudioInput in;
FFT fft;

void setup()
{
  size(1024, 600);
  noSmooth();
  Minim.start(this);
  in = Minim.getLineIn();
  fft = new FFT(in.bufferSize(), in.sampleRate());
}

void draw()
{
  background(0);
  fft.forward(in.mix);
  stroke(255);
  for(int i = 0; i < fft.specSize(); i++)
    line(i*2+1, height, i*2+1, height - fft.getBand(i)*10);
}

void stop()
{
  in.close();
  Minim.stop();
  super.stop();
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-09T04:04:18.380

查找诸如模数转换之类的内容。那应该让你开始。这些设备可以将音频信号（正弦波）转换为数字表示。因此，16 位 ADC 将能够表示 -32768 到 32768 之间的正弦值。这是定点的。也可以在浮点中执行（尽管出于性能原因不推荐，但出于范围原因可能需要）。当我们将数字转换为正弦波时，会发生相反的情况（数模转换）。这由称为 DAC 的东西处理。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-16T04:45:12.810

将实际的模拟音频转换为数字形式涉及两个步骤。

1.  采样
2.  量化

**采样**

对连续波形（在本例中为音频）进行采样的速率称为采样率。人类感知的频率范围是 20 - 20,000 Hz。但是，CD 使用 Nyquist 采样定理，这意味着 44,100 Hz 的采样率涵盖 0 - 22,050Hz 范围内的频率。

**量化**

从“采样”阶段接收到的离散值集现在需要转换为有限数量的值。8 位量化提供 256 个可能的值，而 16 位量化提供多达 65,536 个值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-25T17:12:24.160

答案都与采样频率有关，但没有解决这个问题。我想，一个声音的特定快照会包括许多不同频率的单个振幅（比如你在键盘上同时敲击 A 和 C，A 更大声）。它是如何记录在 16 位数字中的？如果您所做的只是测量幅度（声音的响度），您如何获得不同的音符？

啊! 我想我从这条评论中得到了它：“这个数字然后被转换为你的扬声器振膜的线性位移。” 音符以隔膜振动的速度出现。这就是为什么您需要每秒 44,000 个不同的值。一个音符的频率大约为 1000 赫兹，因此一个纯音符将使振膜每秒进出约 1000 次。整个管弦乐的录音在整个地方都有许多不同的音符，并且可以奇迹般地转换成隔膜运动的单一时间历史。每秒 44,000 次指示膜片稍微进出一点，而那个简单（长）的数字列表可以代表碧昂丝到贝多芬！

# algorithm - 寻找一种算法以（伪）随机顺序吐出一系列数字

> ID：732700
> 
> 赞同：5
> 
> 时间：2009-04-09T03:46:39.093
> 
> 标签：algorithm, language-agnostic, math, sequence

假设我有一个数字序列：{n, n+1, n+2, ... n + m}

在不提前存储数字的情况下，我想创建一个函数 f()，它给定序列 {1,2,3,...m} 将以随机（或至少伪随机）顺序吐出原始集合.

例如假设我的序列是 {10, 11, 12, 13, 14, 15, 16, 17}

```
   f(1) 可以产生 14
   f(2) 可以产生 17
   f(3) 可以产生 13
   f(4) 可以产生 10
   f(5) 可以产生 16
   f(6) 可以产生 15
   f(7) 可以产生 11
   f(8) 可以产生 12

```

在过去的某个时刻，一位同事向我展示了一种能够做到这一点的数学算法，但我几乎忘记了除了它存在之外的所有东西。我记得你必须事先有序列，并从函数中使用的序列中生成一些常量。对于那些想知道的人，我很遗憾与那位同事失去了联系。

这个[问题的](https://stackoverflow.com/questions/693880/create-random-number-sequence-with-no-repeats)答案看起来接近我想要的，但我不确定答案是否允许我提前将输出限制为特定序列。

* * *

**编辑：**

为了澄清一点，我不想存储原始序列或打乱的序列。我想从原始序列生成一个函数 f() 。

令人沮丧的是我已经看到了这个，我只是记不住它，无法用谷歌再次找到它。

Fisher-Yates 算法非常适合置换或洗牌，但这不是我想要的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T10:07:06.790

有一个简单的函数可以`[0..m-1]`为给定的 生成 的排列`m`。只需选择一个`k`相对质数的数字`m`并让`f(i)=(k*i) mod m`。这总是会产生一个排列（在 上没有重复`0<=i<m`）。如果`k`大于则效果更好`m`。

例如，m=20，设 k=137（Python 代码，`%`表示取模）：

```
 >>> [(137*i) % 20 for i in range(20)]
 [0, 17, 14, 11, 8, 5, 2, 19, 16, 13, 10, 7, 4, 1, 18, 15, 12, 9, 6, 3] 
```

这是一个非常简单的 PRNG，不能保证它的统计特性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T04:00:25.470

您的问题有点令人困惑，因为听起来您想取回所有原始序列，但是您将 4 和 8 都映射到 10，而没有映射到 12。

如果您实际上的意思是 1:1 映射，那么您正在寻找的是原始集合的随机排列。有一些方法可以先收集或不收集集合（但您需要生成它的东西，或跟踪您所在的位置）。

另外，请注意 n 并不重要。您始终可以使用 0,1,2,...m，然后在需要时将 n 添加到所有内容中。

假设我已经正确解释了这一点，并且您实际上正在寻找一种洗牌算法（即随机排列，类似于洗牌一副牌称为洗牌），请查看[Fisher-Yates](http://en.wikipedia.org/wiki/Knuth_shuffle)

[编辑]好的，根据您的更新，您面临的问题是：您不想明确编码排列，但您必须以某种方式对其进行编码才能构造 f。最简单的方法就是将排列后的索引实际存储在一个数组中，但如果您出于某种原因（例如太大）不想这样做，您可以以各种方式对其进行编码。但是，没有免费的午餐，因为信息理论限制了这有多简单。无论如何，您可以通过查找有关“编码排列”的工作获得一些想法，例如[本文](http://caltechcstr.library.caltech.edu/139/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T04:06:58.997

这个问题类似于洗一副 (m + 1) 张牌，编号为 [n, ..., n + m]。请注意，编号（因此`n`）并不重要；重要的是我们可以将卡片区分开来。（如果需要，您可以稍后简单地添加`n`背面。）

要执行您想要的操作，您可以执行[**Fisher-Yates 洗牌**](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)，并[**跟踪**](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle#Pencil-and-paper_method)到目前为止已选择哪些索引进行洗牌。这将允许您避免根据要求存储值本身的另一个副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T03:54:49.323

这是我自己编造的一些伪代码：

```
function f(array a)
    array newArray
    while a.size() == 0
        int position = randomNumber(1 to a.size())
        int removedNumber = a[position]
        a.remove(position)
        newArray.insertAtEnd(removedNumber)
    end while
    return newArray 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T04:17:26.570

将初始值添加到列表中。
然后，使用一个随机数在列表当前大小的范围内选择一个新的索引值。
使用该索引选择然后从列表中删除该数字。

正如有人已经指出的那样，这类似于拥有一副牌，然后一次随机取出一张牌。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T04:26:17.857

如果您想要 1:1 映射，请使用其他答案中提到的 Fisher-Yates。

如果您不关心 1:1 映射，并且您只需要所有结果值都来自给定序列（可能重复），那么您可以使用具有指定范围的随机函数。

例如，在 C++ 中，您可以通过以下方式使用 rand() -

```
result = rand() % (m+1) + n 
```

所以对于你的例子，

```
result = rand() % 8 + 10 
```

将产生一个介于 10 和 17 之间的整数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T05:44:08.467

您可以[将多项式拟合](http://en.wikipedia.org/wiki/Lagrange_polynomial)到所选序列；我猜这就是你的同事给你看的。不过，与仅记住排列相比，它不会节省空间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T08:12:58.703

根据[我之前的回答](https://stackoverflow.com/questions/158716/how-do-you-efficiently-generate-a-list-of-k-non-repeating-integers-between-0-an#161552)，您可以使用分组密码和 xor 折叠来生成前 n 个整数的排列。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-09T09:43:47.657

您的输入由 描述`f(x) => x + 9`，或更一般`f(x) => n - 1 + x`地`x`从 1 开始。

您链接到[另一个问题](https://stackoverflow.com/questions/693880/create-random-number-sequence-with-no-repeats)，该问题描述了`r(x)`将 x 映射到混洗值的函数`0 <= r(x) <= m`。

所以`f(r(x) + 1)`或者`(r(x) + n)`应该给你你想要的价值。

对于 small `m`，您还应该能够通过跟踪和错误找到标准随机数生成器的种子，然后如果您不想编写自己的生成器，则`m+1`在使用 mod 时会生成不同的值。`m+1`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-09T10:33:21.783

如果不将原始函数的结果存储在某处，就不可能返回这些值。推理：

您的随机数生成器告诉您从原始序列中返回这些值：第 5、第 11、第 3。

因此，您跳过前四个值，返回第 5 个，跳过另一个 5，返回第 11 个……现在如何返回第 3 个而不将其保存在某处？

您可以摆脱的最接近的事情是创建一个列表并附加您跳过的所有值，但这听起来很尴尬并且可能不值得努力。此外，在改组算法返回一个非常大然后非常小的值的情况下，它会非常慢（在这种情况下，您首先会有效地将大多数值复制到列表中，这是您想要避免的）。

我休息一下。

# iphone - 如何在 Objective-C 中扩展协议/委托？

> ID：732701
> 
> 赞同：74
> 
> 时间：2009-04-09T03:46:46.877
> 
> 标签：iphone, objective-c

如果我想扩展像 AVAudioPlayer 这样的类，那么向 AVAudioPlayerDelegate 添加另一个方法的最佳方法是什么？

我应该为它创建一个类别，我应该扩展它吗？

如果我扩展它，我是否还必须确保覆盖实际的委托 getter/setter？我将如何扩展协议？

以下给了我错误

```
@protocol AudioTrackDelegate : AVAudioPlayerDelegate {
    - (void)foo;
}
@end

@interface AudioTrack : AVAudioPlayer {
}
@end 
```

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-04-09T04:06:38.437

创建实现另一个协议的协议的语法如下：

```
@protocol NewProtocol <OldProtocol>
- (void)foo;
@end 
```

如果您想在`NewProtocol`键入的指针上调用方法，`OldProtocol`您可以调用`respondsToSelector`：

```
if ([object respondsToSelector:@selector(foo)])
    [(id)object foo]; 
```

或将存根方法定义为以下类别`NSObject`：

```
@interface NSObject (NewProtocol)
- (void)foo;
@end
@implementation NSObject (NewProtocol)
- (void)foo
{
}
@end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-09T16:58:20.410

请记住，协议不会向已编译的应用程序添加任何代码——它只会强制您的类必须实现被视为“符合”协议的方法这一事实。一个很好的用途是生成一组具有相同操作方式的类：`<printable>`or`<serialized>`等​​。因此您可以创建一个`<plays>`协议，例如：

```
@protocol plays
    - (void) play;
    - (NSString *) type;
@end 
```

然后一个符合的类`<plays>`必须实现`play`and`type`方法。如果没有，编译器会发出警告，但无论如何都会编译该类。在您的代码中，您使用以下代码检查对象是否符合协议：

```
if ([obj conformsTo: @protocol(plays)]) {
    [obj play];
} 
```

类别实际上会动态地向您的类添加新方法。这些方法可以作为选择器被运行时全局访问，并且可以按名称调用，如`@selector(foo)`和`[object foo:bar];`

类别的目的是为类添加特殊的新代码，即使您没有该类的源代码。可能存在安全问题，您可能会在类中创建内存泄漏等。

在您的情况下，可能在单独的文件中`AVAudioPlayerDelegate_TrackOps.m`

```
#import "AVAudioPlayerDelegate.h"
@implementation AVAudioPlayerDelegate (TrackOps)

- (NSObject *) foo {
    // do foo stuff;
    return bar;
}

@end 
```

把它作为一个类别`NSObject`使所有类都响应`foo`. `Foo`也可以是一个独立的方法 `Objc_perform_selector(@selector(foo))`。

底线：使用类别向类添加快速方法，使用协议强制方法实现，使用子类专门化现有类（例如添加成员变量或主要新功能）。当不需要和不需要子类时，类别也可用于覆盖一两个方法，但通常如果您想向类添加功能，则创建一个子类。有关此主题的更多示例、想法和其他一般信息，总是有[Apple 对 Objective-C 的介绍](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Introduction/introObjectiveC.html "Objective-C 简介")

# ajax - GMail Chat 如何能够在没有客户端交互的情况下发出 AJAX 请求？

> ID：732705
> 
> 赞同：59
> 
> 时间：2009-04-09T03:49:02.253
> 
> 标签：ajax, gmail, comet, chat

所有 HTTP 响应都需要客户端启动它们，即使是使用 AJAX 做出的响应。但是 GMail 的聊天功能能够接收来自其他用户的消息，即使我只是坐在舒适的电脑椅上观看但不与浏览器交互。他们是如何做到的呢？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-09T03:58:20.780

该技术被称为“彗星”，但也被称为“服务器推送”、“反向 ajax”等。

它是关于将数据从服务器推送到浏览器，保持 http 连接处于活动状态。[在维基百科文章](http://es.wikipedia.org/wiki/Comet)（[英文版](http://en.wikipedia.org/wiki/Comet_(programming))）上找到更多信息。

这里还有来自 DWR 的 Joe Walker 的一个[很好的演示](http://www.infoq.com/presentations/Comet-DWR-Joe-Walker) ，他谈到了彗星。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-09T03:56:31.377

正如您正确指出的那样，HTTP 要求客户端“拉取”数据。Gmail 仍然可以通过使用计时器触发 HTTP 操作而不是要求用户单击某些内容来从服务器“提取”数据。所以，它可能看起来是自动的，但它仍然是客户端启动的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-09T04:06:22.507

是的，彗星是正确的。[Ryan Dewsbury 的 Google Web Toolkit Applications](https://rads.stackoverflow.com/amzn/click/com/0321501969)在第 9 章中解释了如何创建基于 Comets 的 Instant Messenger 应用程序。

# automation - 服务器上的 Word 自动化

> ID：732709
> 
> 赞同：2
> 
> 时间：2009-04-09T03:51:10.330
> 
> 标签：automation, ms-word

我们要求我们的 Web 应用程序将进行邮件合并并生成一些 Word 文档。当然，使用 Word 自动化很容易做到这一点，但 Microsoft [http://support.microsoft.com/kb/257757](http://support.microsoft.com/kb/257757)不建议这样做。

> “微软目前不推荐也不支持任何无人值守、非交互式客户端应用程序或组件（包括 ASP、ASP.NET、DCOM 和 NT 服务）的 Microsoft Office 应用程序自动化，因为 Office 可能表现出不稳定的行为和/或在此环境中运行 Office 时出现死锁。”

在这种情况下，人们通常会做什么？只需接受 Word 偶尔会挂起或寻求某些第三方解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T04:09:35.480

基本上你有三个选择：

1.  在服务器上运行它并接受这些后果。我从经验中知道事情确实会出错，但取决于您正在执行的任务的实时性和高优先级，这可能是您可以忍受的事情。基本上如果你必须这样做，尽量少做 Word 集成；如果它只是一个邮件合并，那么你可能会在 99.9% 的时间里没有任何问题。
2.  使用第三方解决方案。但从经验来看，除了*非常*简单的文件外，这些文件都不能很好地完成工作。例如，如果您正在谈论将从服务器上的 Word 文档生成 PDF 的东西，它看起来永远不会像在 Word 中那样。
3.  无需直接调用 Word，而是使用 .NET [Open XML](http://openxmldeveloper.org/) [库](http://msdn.microsoft.com/en-us/library/bb448854.aspx)自己操作文档。我什至用 VB6 编写了一些用于处理 Word/Excel 2007 文档的东西，因为它们都采用了记录良好的 XML 格式。您*必须*使用 2007 格式，但它又快又好。但是我认为你必须手动进行邮件合并之类的事情，所以它可能不合适。此解决方案通常更适合处理文档，而不是替换 Word API 函数。

从个人经验来看，我已经完成了第一个并且效果很好，足以让我们的客户接受，我搞砸了第二个并且从不满意，并且我已经完成了第三个并取得了巨大的成功（但也做了相当多的工作）。

简而言之，人们会根据成本（时间等）与可靠性来做各种事情：我建议选择 1 或 2 来获得快速（但不太可靠）的解决方案，或者选择 3 来获得更可靠（但成本更高）的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T04:10:50.610

我使用自动化构建了一个 Powerpoint 应用程序。基本上它是一个幻灯片库网站，可以打开多个文件并将幻灯片移动到模板中。

我遇到的第一个问题是安全性，我最终将应用程序设置为以管理员身份运行，这是不推荐的，大多数地方可能会对此操作皱眉。您需要灵活地自定义安全设置。

我确实经历了一些我们从未追查过的应用程序池崩溃，而且我相信我还必须让用户始终登录到远程桌面，但始终断开连接。

底线是你可以让自动化工作，但它很老套。如果你有灵活性，自动化是你最好的选择，那就去吧。否则我有两个想法。

1.  探索 Open XML 和[Open XML SDK的使用](http://msdn.microsoft.com/en-us/library/bb448854.aspx)
2.  查看在受信任的用户帐户上运行 WCF 服务。然后让您的网页调用或排队处理请求的工作。

# programming-languages - 管理用不同编程语言编写的并发项目

> ID：732710
> 
> 赞同：2
> 
> 时间：2009-04-09T03:51:43.650
> 
> 标签：programming-languages, project-management

我目前有三个独立的项目——每个项目都需要用不同的语言进行开发。

C# .Net 3.5 中有一个 WCF Web 服务/Windows 窗体项目，一个带有大量 javascript 的 PHP 网站，以及用 VB 6 编写的遗留 Windows 应用程序的维护。

因为我经常切换，我经常不假思索地开始用错误的语言编写代码行。随着时间的推移，情况越来越好，但总是会出现失误，我显然没有尽我所能。

许多其他开发人员是否遇到过这种语言切换问题？

如果是这样，您如何管理或最大限度地减少因不得不在语言之间切换大脑而导致的生产力问题？

**编辑：**

作为一个完美的例子，看看我的三个项目的 foreach 循环：

C＃：

```
foreach (Person p in myPeople)
{
    ...
} 
```

PHP：

```
foreach ($myPeople as $p)
{
    ...
} 
```

VB：

```
For Each p As Person in myPeople
    ...
Next 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T03:59:14.663

肯定去过那里。

虽然有时陷入不正确的语法令人沮丧，但我的猜测是，从长远来看，您将成为一个更好的开发人员，因为您可以接触到多平台。

我发现的最好的事情是尽量抽出大量时间专注于手头的项目。理想情况下至少几天。如果我没有一个小时或更多的时间来集中精力，我通常什至不会费心尝试开始编程，因为在我考虑进入该区域之前，有太多的惯性需要克服。在多个不同的项目上工作只会让情况变得更糟。

我建议尝试阻止你的一周。可能周一进行维护，周二和周三进行表单项目，周四到周五进行 Web 项目。我发现拥有这样的例行程序更容易陷入，而不是总是想知道我应该做什么。

# wpf - 在运行时定义 WPF ControlTemplate

> ID：732736
> 
> 赞同：6
> 
> 时间：2009-04-09T04:00:36.390
> 
> 标签：wpf, controltemplate

我想在运行时定义一个 ControlTemplate。这可能吗？我注意到 ControlTemplate 类上的 VisualTree 属性。我还注意到它使用了 FrameworkElementFactory 类。但是，我似乎无法让它工作。

是否可以在运行时创建 ControlTemplate？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T04:24:17.707

是的，您可以使用 FrameworkElementFactory 执行此操作。Charles Petzold 在“应用程序 = 代码 + 标记”的第 11 章中对此进行了演练，但基本思想是为模板根元素（以及任何子元素的进一步工厂）创建一个 FrameworkElementFactory，创建一个 ControlTemplate，并设置将 ControlTemplate 的 VisualTree 属性添加到 FrameworkElementFactory：

```
FrameworkElementFactory borderFactory = new FrameworkElementFactory(typeof(Border));
// set properties and create children of borderFactory
ControlTemplate template = new ControlTemplate();
template.VisualTree = borderFactory;

myButtonInstance.Template = template; 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-09T04:23:07.053

WPF 控件类有一个“模板”属性，您可以在运行时对其进行设置。

# database-design - 数据库建模问题 - 根据用户类型需要不同的数据

> ID：732742
> 
> 赞同：0
> 
> 时间：2009-04-09T04:06:18.827
> 
> 标签：database-design

用于用户注册过程的最佳数据库模型是什么，取决于所选用户的类型，某些字段是否必填。

示例：用户类型 A 需要：姓名、电子邮件、出生日期和性别 用户类型 B 需要：公司名称、联系人、电子邮件、N.员工

我认为最常见的是创建一个包含所有这些字段的表并让它们允许 NULL。

你们有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T04:10:51.950

您可以创建一个包含任何公共字段的基本“用户”表，以及将用户与基本 User.ID 的 FK 挂起的其他表。如果没有公共字段，那么只使用不同的表而不是一个包含一堆可为空字段的表可能是有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T04:11:06.757

为了保持一致性，最好为用户提供一个“主表”，其中唯一的字段将是两种类型的用户共有的一些唯一用户标识符（例如，ID、SSN 或其他）。

然后由您决定如何表示专业化。

一种选择是在该表中使用第二个字段来表示类型，然后再添加两个包含详细信息的表，每种类型一个。查询时，您将确保仅在 TYPE_A 表中查找用户的详细信息（如果该用户的类型为 A）。

第二种选择是没有该字段，并依靠特定表中有记录来表示类型的事实，但这是相当冒险的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T04:10:42.700

我以前做过同样的事情。只要您存储客户类型，那么获取正确的详细信息并不难。

您可以考虑 2 个表并使用视图来合并它们，如果将有一个表比另一个表大得多，尽管客户类型的索引会做同样的事情。“几乎相同”是指使一种类型的数据可以快速访问。

将所有数据放在一个表中的好处是您不必执行任何连接来获取数据，这有助于提高查询速度和简化编写。

# javascript - 防止现有的 CSS 样式化注入的 HTML/CSS

> ID：732748
> 
> 赞同：17
> 
> 时间：2009-04-09T04:07:35.250
> 
> 标签：javascript, html, css, internet-explorer, code-injection

我正在开发一个在我无法控制的网页上注入 JS+CSS+HTML 的项目。

我担心我的注入代码的主机页面样式——我希望我注入的代码只服从**我的**样式，而不是他们的样式。

目前，我能想到的唯一方法是为 container`<div>`的类明确指定每个可能的标签（使用预定义的、已知的浏览器默认值），并依靠继承将这些规则传播到我的其余部分注入的 HTML。这个 CSS 需要出现在页面`<head>`标签的底部。

不过，我不认为这是最好的解决方案，我也不期待实施它。当然还有更好的方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-09T04:17:55.240

其他人提出了很好的方法来防止你的 CSS 影响页面，以及确保你的 CSS 优先，但你似乎最关心页面的 CSS 影响你——也就是说，添加一个时髦的、意想不到的样式（比如所有 div 都有粉红色背景）。

我能想到的防止他们的样式影响您注入的代码的唯一方法是让您将注入的内容沙箱化，例如在`iframe`. `padding`否则，您必须定义的东西太多了 - 您必须在 " " 选择器（或者更好的是， " `border`" ，所以你只需覆盖你自己的内容），这样你就可以保证对你的 CSS 的绝对控制。`margin``background``*``#yourid *`

编辑：我意识到后一种解决方案不一定会太痛苦，如果您使用全向选择器将所有内容重置为基线：

```
#myid * {
    somestyle1: default;
    somestyle2: default;
    ... 
} 
```

我发现[有人写了这样的解决方案](http://www.webmasterworld.com/css/3605017.htm)。如果您在页面上向下滚动足够远，您会看到它（来自 SuzyUK）。它看起来并不完整，但肯定是一个好的开始。

（我也很想知道是否有防止这种情况的好方法。在将代码注入页面之前，我已经编写了 Greasemonkey 脚本，并且不得不编写 CSS 来覆盖页面的 CSS，但在这些情况下，我知道我的目标是谁，并且可以直接针对页面定制我的 CSS。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T04:12:37.283

用专门分类的 包裹注入的 HTML `<div>`，例如

```
<div class="my-super-specialized-unique-wrapper"><!--contents--></div> 
```

然后在您的 CSS 中，为所有规则添加前缀并在每条规则上`.my-super-specialized-unique-wrapper`使用**[!important 。](http://www.w3.org/TR/CSS2/cascade.html#important-rules)**这将指示客户端浏览器将您的规则视为任何匹配元素的至高无上的规则，而不管可能针对它们的任何其他样式 - 即使您无法控制的其他规则更具体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T04:12:17.080

你只需要非常[具体地](http://htmldog.com/guides/cssadvanced/specificity/)使用你的 CSS 选择器。也就是说，比主机页面的 CSS 规则更具体。您可能还想添加一种全局 CSS 重置，修改为仅重置您的 HTML。我的意思是指将所有颜色、背景、字体、填充等重置为单一标准的东西。从那里你可以建立自己的风格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T04:14:06.670

为什么不注入像这样的内联格式的 html 元素：

```
<p style="color:red">This to be injected</p> 
```

内联样式优先于任何其他规则，并且您已经在创建标记以插入它。

其他解决方案是在您的元素上使用**非常具体**的 DOM id，然后在您添加的 CSS 上设置它们的样式

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T06:57:26.383

如果您使用的是 Mozilla 浏览器，您实际上可以（如果非法）将可见的 DOM 内容添加到 <body> 元素之外的 <html> 元素。这将避免任何与正文匹配并由您的内容继承的样式。某些样式可能会在 html 上匹配，这会破坏这种技术，但我发现它很有用。

例如。使用 jquery： $('html').append('<div id="mycontent"> blah blah blah </div>');

当您不希望您的库实例干扰由您正在修改的页面定义的库的使用时，使用流行的库本身就是一个挑战。Greasemonkey 的“@require”对我不起作用。我发现有必要（但可能！）保存由 jquery 脚本分配的两个或三个全局名称的任何现有值，将我的库实例插入 DOM，等待它被加载（必须使用计时器，这很烦人，但我看不到解决方法），缓存分配给我自己命名空间中的全局变量的值以供我自己使用，并恢复保存的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-03T21:38:57.997

我不确定应该如何使用它，浏览器对此的支持，但它是使用[http://www.w3.org/TR/shadow-dom/的主要原因之一](http://www.w3.org/TR/shadow-dom/)

这个想法是您可以插入一个 Web 组件，该组件可以完全设置样式并具有仅影响 shadow-DOM 的特定事件（因此您的模块不会影响页面的其余部分）。

# cygwin - 有人在 Vista 64 位上通过 Cygwin 安装 OpenSSH 有任何问题吗？

> ID：732752
> 
> 赞同：0
> 
> 时间：2009-04-09T04:09:09.537
> 
> 标签：cygwin, vista64, openssh

我能够安装 sshd 服务（在遇到很多问题之后），并且能够通过说 ssh hao@192.168.1.3 和 ssh localhost 在我安装它的机器上 ssh。但是，我局域网上的所有其他机器都无法通过 ssh 连接到它。我检查了端口 22 确实是打开的，并且 SSH 正在侦听该端口。

有人经历过这样的安装吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T04:20:51.507

Vista 防火墙可能处于活动状态。打开控制面板，搜索防火墙，然后完全关闭它，看看外部连接是否有效。如果他们这样做了，那么您必须弄清楚如何打开入站端口 22，这应该很容易，但如果没有方便的 Vista 机器，我无法准确告诉您。

# java - Sql Server 数据库中的 uniqueidentifier - 如何在 Java 环境中生成？

> ID：732754
> 
> 赞同：2
> 
> 时间：2009-04-09T04:10:02.967
> 
> 标签：java, sql-server, guid, uniqueidentifier

我有一个使用 Sql Server 2005 的 uniqueidentifier 列的数据库表。

我知道如何在 C# 中创建 GUID...

```
string newid = System.Guid.NewGuid().ToString(); 
```

但是，插入此数据库的应用程序正在运行 Java。

有没有办法使用 Java 代码生成与 Sql-Server 兼容的 GUID？

（注意：在这种情况下，不能在 Sql Server 端生成 GUID）

这是 - [http://johannburkard.de/software/uuid/](http://johannburkard.de/software/uuid/) - 相当于 C# 版本吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T13:11:47.440

假设您至少使用 Java 1.5，为什么不简单地使用内置类[java.util.UUID](http://java.sun.com/j2se/1.5.0/docs/api/java/util/UUID.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T04:29:33.310

您链接的代码应该可以正常工作。对于踢球，这是另一个实现，其中包含一些很好的启动文档。[http://jug.safehaus.org/Home](http://jug.safehaus.org/Home)

GUID 是一种定义明确的现象，通常涉及唯一的机器标识符和当前时间，然后是一堆随机性。任何花时间编写 GUID 库的人都应该花足够的时间在它上面比你或我做得更好，所以使用库是正确的选择。我链接的代码有一堆指向 IETF 规范等的链接，所以我认为这是一个很好的迹象，表明他们做了尽职调查。

见[http://www.opengroup.org/dce/info/draft-leach-uuids-guids-01.txt](http://www.opengroup.org/dce/info/draft-leach-uuids-guids-01.txt)

# objective-c - 如何在 iPhone 上后台运行 sqlite？

> ID：732755
> 
> 赞同：0
> 
> 时间：2009-04-09T04:10:40.720
> 
> 标签：objective-c, multithreading, sqlite

[我想知道如何在编写 Objective-C 和 Cocoa 时使用哪些最佳实践中](https://stackoverflow.com/questions/155964/what-are-best-practices-that-you-use-when-writing-objective-c-and-cocoa)所建议的那样在后台运行 sqlite 查询？

这是我的尝试：

```
- (void) run:(NSString *)sql {
NSArray *data = [NSArray arrayWithObjects:
                 sql,
                 [self returnItemClass],
                 nil];

NSInvocationOperation *operation = 
[[NSInvocationOperation alloc] initWithTarget:self 
                                     selector:@selector(loadRecords:) 
                                       object:data]; 
[self.queue addOperation:operation];
[operation release];
}

- (void) loadRecords:(NSArray *)data {
    NSLog(@"Runing sql");
    NSString * sql = [data objectAtIndex:0];
    Class cls = [data objectAtIndex:1];

    Db *db= [Db currentDb];

    NSArray *list = [db loadAndFill:sql theClass:cls];
    [UIAppDelegate performSelectorOnMainThread:@selector(recordsLoaded:)
                                           withObject:list
                                        waitUntilDone:YES];
}

- (void) recordsLoaded:(NSArray *)data {
NSLog(@"Loading sql");
for (DbObject *o in data) {
    [self.objectCache setObject:o forKey:[NSNumber numberWithInt:o.Id]];
}
} 
```

但是，尝试运行时出现错误

```
 [UIAppDelegate performSelectorOnMainThread:@selector(recordsLoaded:)
                                       withObject:list
                                    waitUntilDone:YES]; 
```

并抱怨不能发送消息到recordsLoaded。

这是正确的做法吗？

以及如何在 UITableView 中填充数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T05:57:37.903

由于 Apple 的意愿和设计，多线程 iPhone 应用程序的方式并没有太多。

然而，通用的消息传递哲学有利于编写面向事件的程序。您的程序应该旨在通过将委托设置为事件调度程序来响应用户输入和环境变量。

SQLite3 作为数据库，并不是传统意义上的服务器。它用于与特定文件格式交互的协议，其库可以直接包含在源代码中。换句话说，当你需要从数据库中获取数据时，你应该能够立即读取它。您不应该也不能生成 SQLite3 进程以在后台工作。

关于您陈述的语法，您为什么要使用`performSelectorOnMainThread...`而不是仅仅调用

```
[UIAppDelegate recordsLoaded:list] 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-22T08:26:08.467

我已经尝试了这两种解决方案，并且效果很好。您可以使用临界区或 NSOperationQueue，我更喜欢第一个，这是它们的代码：

定义一些类“DatabaseController”并将此代码添加到其实现中：

```
static NSString * DatabaseLock = nil;
+ (void)initialize {
    [super initialize];
    DatabaseLock = [[NSString alloc] initWithString:@"Database-Lock"];
}
+ (NSString *)databaseLock {
    return DatabaseLock;
}

- (void)writeToDatabase1 {
    @synchronized ([DatabaseController databaseLock]) {
        // Code that writes to an sqlite3 database goes here...
    }
}
- (void)writeToDatabase2 {
    @synchronized ([DatabaseController databaseLock]) {
        // Code that writes to an sqlite3 database goes here...
    }
} 
```

或者使用 NSOperationQueue 你可以使用：

```
static NSOperationQueue * DatabaseQueue = nil;
+ (void)initialize {
    [super initialize];

    DatabaseQueue = [[NSOperationQueue alloc] init];
    [DatabaseQueue setMaxConcurrentOperationCount:1];
}
+ (NSOperationQueue *)databaseQueue {
    return DatabaseQueue;
}

- (void)writeToDatabase {
    NSInvocationOperation * operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(FUNCTION_THAT_WRITES_TO_DATABASE) object:nil];
    [operation setQueuePriority:NSOperationQueuePriorityHigh];
    [[DatabaseController databaseQueue] addOperations:[NSArray arrayWithObject:operation] waitUntilFinished:YES];
    [operation release];
} 
```

这两个解决方案会阻塞当前线程，直到完成对数据库的写入，在大多数情况下您可能会考虑这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T20:05:09.043

```
[UIAppDelegate performSelectorOnMainThread:@selector(recordsLoaded:)
                                withObject:list
                             waitUntilDone:YES]; 
```

应该

```
[self performSelectorOnMainThread:@selector(recordsLoaded:)
                       withObject:list
                    waitUntilDone:YES]; 
```

除非您已将 UIAppDelegate 定义为类似

```
#define UIAppDelegate ([UIApplication sharedApplication].delegate) 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-04-09T04:18:27.923

问题在于 iPhone[真的没有办法](http://www.macworld.com/article/133867/2008/06/backgroundprocesses.html)[在后台](http://www.macworld.com/article/132429/2008/03/sdk_background.html)轻松运行程序。

# sql-server-2005 - 这个 SQL 错误是什么意思

> ID：732762
> 
> 赞同：0
> 
> 时间：2009-04-09T04:13:26.627
> 
> 标签：sql-server-2005, sql-server-2008

例外：“分布式事务已完成。将此会话加入新事务或 NULL 事务”

这是在一台同时托管 SQL 2005 和 Sql 2008 的机器上运行的 SProc 中发生的。

C# 代码看起来像这样

```
(using TransactionScope t = new TransactionScope ())
{
   using(SqlConnection c= new SqlConnection(...))
   {
      c.Open();
      DataContext1 ctx = new DataContext1(c);//Linq2SQL
      c.StoreData(2,3);//Call Sproc
   }
} 
```

Sproc 看起来像这样

```
Select * Table where x=2 and y=3
if(@@rowcount =0)
   Insert into table values(2,3)
end if 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T04:25:59.933

该错误是由于数据库前端的约束失败造成的。您的事务正在回滚（意味着数据库没有发生任何事情）。

基本上，这是在没有更多信息的情况下我们无法轻易识别的交易中发生的错误。发布您的查询。

# sql - 将不同的关键字限制为一列

> ID：732765
> 
> 赞同：7
> 
> 时间：2009-04-09T04:14:02.380
> 
> 标签：sql, mysql

我如何在 mysql 中应用 distinct 关键字，以便它只检查一个列字段是否唯一，同时仍从我的表中返回其他列？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T04:19:26.423

为了能够做到这一点，mysql 必须知道如何处理其他列。您 GROUP BY 应该是唯一的列，并使用一个函数来告诉它如何处理其他列（所谓的[*聚合函数*](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)）。`MAX()`并且`COUNT()`是常见的例子：

```
SELECT studentId, COUNT(courseId) AS AmountEnrolledCourses
FROM student_enrollment
GROUP BY studentId

SELECT athlete, MAX(distance) AS PersonalRecord
FROM longjump
GROUP BY athlete 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T04:18:09.250

您需要改为使用 group by。

从表中选择 SUM(A)、MIN(B)、C，其中 A > 1 GROUP BY C；

请注意，如果您对一列进行分组并返回其他列，则必须提供某种方法将其他字段中的所有这些值塞进一个。这种方式称为聚合函数，您必须查看数据库版本的手册才能准确了解您的选项。有关 mysql，请参阅[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-04-09T04:17:21.670

从表中选择 DISTINCT Column_1、Column_2、Column_3

但是，您可能想详细说明您的问题，因为我的答案似乎有点太直接了，无法成为答案。

当您使用 DISTINCT 引导列名时，它仅检查该列。我误解了这个问题吗？

# c# - 为什么我们应该在 C# 中使用文字？

> ID：732770
> 
> 赞同：9
> 
> 时间：2009-04-09T04:16:46.087
> 
> 标签：c#

在一些 C# 代码中，我看到过这样的语句：

```
float someFloat = 57f; 
```

我想知道为什么我们应该使用`f`上述情况下的文字？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-09T04:21:18.727

主要是因为编译器确切地知道我们的意思 - 特别是对于重载决议：

```
Foo(57f); 
```

应该调用`Foo(int)`//吗`Foo(float)`？`Foo(decimal)`

实际上，我不喜欢记住事情——另一种选择是：

```
float someFloat = (float)57; 
```

这**不是**运行时强制转换 - 它（在 IL 级别）与`57f`. 唯一有细微差别的是`decimal`s 具有更高的精度：

```
decimal someDecimal = (decimal)57.0; // same as 57M, not 57.0M (scale is different) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-09T04:21:45.093

上面的“f”是类型后缀。这告诉编译器提供的文字的确切类型。使用它以便编译器可以为文字分配适当的存储量（精度）。默认情况下，浮点文字被存储为“双精度”。如果您添加“f”作为后缀，则文字只会获取浮点数的存储，这会降低准确性。

```
double d = 50.1234; // given double storage
double d = 50.1234f; // given float storage, which might lose precision compared to double 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T04:22:52.763

默认情况下，赋值运算符右侧的实数文字被视为双精度值。因此，要初始化浮点变量，请使用后缀 f 或 F，例如：

```
float x = 3.5F; 
```

如果你在前面的声明中不使用后缀，你会得到一个编译错误，因为你试图将一个双精度值存储到一个浮点变量中。

来自[MSDN：浮动](http://msdn.microsoft.com/en-us/library/b1e65aza(VS.71).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T04:23:16.977

查看这篇文章，它解释了很多关于 C# 中的数字文字：http: [//www.blackwasp.co.uk/CSharpNumericLiterals.aspx](http://www.blackwasp.co.uk/CSharpNumericLiterals.aspx)

以下是文章的一小段摘录：

> 浮动单位价格 = 123.45; // 这不会编译
> 
> 这里的问题是您不能总是将双精度 (123.45) 隐式转换为浮点数。C# 编译器理解这一点并停止编译代码

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T08:03:26.213

> 我想知道为什么在上述情况下我们应该使用像 f 这样的文字？

你不应该。*好吧，你*不必。

上述情况显示了对 57f 的浮点初始化。整数被隐式转换为浮点编译时间，因此如果您感到困扰，您可以轻松删除 f 后缀。但是，为了编写代码的一致性，我总是尝试添加后缀。请注意，这仅适用于四舍五入的数字（整数）。

请参阅有关[隐式](http://msdn.microsoft.com/en-us/library/y5b434w4(VS.80).aspx)和[显式](http://msdn.microsoft.com/en-us/library/yht2cx7b(VS.80).aspx)数字对话的 Msdn。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-22T12:24:53.147

> **为什么我们应该使用文字？**

`int / int = int` **但是** `int / float = float`：

```
int timespanInMS = 500;

Console.WriteLine("Execution time: {0} sec.", timespanInMS / 1000);
Console.WriteLine("Execution time: {0} sec.", timespanInMS / 1000F);

// Result:
// Execution time: 0 sec.
// Execution time: 0.5 sec. 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-09T04:23:03.763

因为 57 是整数，而 57.0 是双精度数。您正在尝试获得一个浮点数，它是一个单精度数。这就引出了一个问题，为什么要使用单精度浮点数？

有关 C# 文字的更多信息，请参阅[http://www.blackwasp.co.uk/CSharpNumericLiterals.aspx](http://www.blackwasp.co.uk/CSharpNumericLiterals.aspx)。

# objective-c - 如何在 iPhone 上使用自省 + 重分配优化代码

> ID：732771
> 
> 赞同：0
> 
> 时间：2009-04-09T04:16:46.493
> 
> 标签：objective-c, performance

我有个问题。我尝试显示`UITable`可能有 2000-20000 条记录（典型数字。）

我有一个类似于 Apple 联系人应用程序的[SQLite数据库。](http://en.wikipedia.org/wiki/SQLite)

我做了所有我知道的技巧来获得一个平滑的卷轴，但我有一个问题。

我将数据加载到 50 个记录块中。然后，当用户滚动时，请求下一个 50 直到完成列表。

但是，加载 50 条记录会导致加载和滚动时出现明显的“暂停”。其他一切正常。

我缓存数据，有不透明的单元格，通过代码绘制它等等......

我交换了在 dicts 中加载相同数据的代码并提高了性能，但想知道我是否可以保持面向对象的方法并改进实际代码。

这是我认为有性能问题的代码：

```
 -(NSArray *) loadAndFill: (NSString *)sql theClass: (Class)cls {
        [self openDb];

        NSMutableArray *list = [NSMutableArray array];

        NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

        DbObject *ds;
        Class myClass = NSClassFromString([DbObject getTableName:cls]);

        FMResultSet *rs = [self load:sql];

        while ([rs next]) {
            ds = [[myClass alloc] init];
            NSDictionary *props = [ds properties];
            NSString *fieldType = nil;
            id fieldValue;

            for (NSString *fieldName in [props allKeys]) {
                fieldType = [props objectForKey: fieldName];

                fieldValue = [self ValueForField:rs Name:fieldName Type:fieldType];

                [ds setValue:fieldValue forKey:fieldName];
            }

            [list addObject :ds];

            [ds release];
        }
        [rs close];

        [pool drain];
        return list;
    } 
```

我认为罪魁祸首是：

```
 -(id) ValueForField: (FMResultSet *)rs Name:(NSString *)fieldName Type:(NSString *)fieldType {
        id fieldValue = nil;

        if ([fieldType isEqualToString:@"i"] || // int
                 [fieldType isEqualToString:@"I"] || // unsigned int
                 [fieldType isEqualToString:@"s"] || // short
                 [fieldType isEqualToString:@"S"] || // unsigned short
                 [fieldType isEqualToString:@"f"] || // float
                 [fieldType isEqualToString:@"d"] )  // double
        {
            fieldValue = [NSNumber numberWithInt: [rs longForColumn:fieldName]];
        }
        else if ([fieldType isEqualToString:@"B"]) // bool or _Bool
        {
            fieldValue = [NSNumber numberWithBool: [rs boolForColumn:fieldName]];
        }
        else if ([fieldType isEqualToString:@"l"] || // long
                 [fieldType isEqualToString:@"L"] || // usigned long
                 [fieldType isEqualToString:@"q"] || // long long
                 [fieldType isEqualToString:@"Q"] ) // unsigned long long
        {
            fieldValue = [NSNumber numberWithLong: [rs longForColumn:fieldName]];
        }
        else if ([fieldType isEqualToString:@"c"] || // char
                 [fieldType isEqualToString:@"C"] ) // unsigned char

        {
            fieldValue = [rs stringForColumn:fieldName];
            //Is really a boolean?
            if ([fieldValue isEqualToString:@"0"] || [fieldValue isEqualToString:@"1"]) {
                fieldValue = [NSNumber numberWithInt: [fieldValue intValue]];
            }
        }
        else if ([fieldType hasPrefix:@"@"] ) // Object
        {
            NSString *className = [fieldType substringWithRange:NSMakeRange(2, [fieldType length]-3)];

            if ([className isEqualToString:@"NSString"]) {
                fieldValue = [rs stringForColumn:fieldName];
            }
            else if ([className isEqualToString:@"NSDate"]) {
                NSDateFormatter* dateFormatter = [[NSDateFormatter alloc] init];
                [dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss"];
                NSString *theDate = [rs stringForColumn:fieldName];

                if (theDate) {
                    fieldValue = [dateFormatter dateFromString: theDate];
                }
                else
                {
                    fieldValue = nil;
                }

                [dateFormatter release];
            }
            else if ([className isEqualToString:@"NSInteger"]) {
                fieldValue = [NSNumber numberWithInt: [rs intForColumn :fieldName]];
            }
            else if ([className isEqualToString:@"NSDecimalNumber"]) {
                fieldValue = [rs stringForColumn :fieldName];
                if (fieldValue) {
                    fieldValue = [NSDecimalNumber decimalNumberWithString:[rs stringForColumn :fieldName]];
                }
            }
            else if ([className isEqualToString:@"NSNumber"]) {
                fieldValue = [NSNumber numberWithDouble: [rs doubleForColumn:fieldName]];
            }
            else
            {
                //Is a relationship one-to-one?
                if (![fieldType hasPrefix:@"NS"]) {
                    id rel =  class_createInstance(NSClassFromString(className), sizeof(unsigned));
                    Class theClass = [rel class];
                    if ([rel isKindOfClass:[DbObject class]]) {
                        fieldValue = [rel init];
                        //Load the record...
                        NSInteger Id = [rs intForColumn:[theClass relationName]];
                        if (Id>0) {
                            [fieldValue release];

                            Db *db = [Db currentDb];

                            fieldValue = [db loadById: theClass theId:Id];
                        }
                    }
                } else {

                    NSString *error = [NSString stringWithFormat:@"Err Can't get value for field %@ of type %@", fieldName, fieldType];

                    NSLog(error);
                    NSException *e = [NSException
                                      exceptionWithName:@"DBError"
                                      reason:error
                                      userInfo:nil];
                    @throw e;
                }
            }
        }
        return fieldValue;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T20:53:07.977

看起来性能问题与decimalNumberWithString有关。

如果我从代码中删除它，延迟会比它小得多。

我需要 NSDecimalNumber 来进行货币管理是不好的 :(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T12:02:31.317

您应该能够使用采样器工具通过“Instruments”运行该程序以找出问题所在。您可以将 ValueForField 重写为更小的调用，以查看它的哪一部分是瓶颈（如果需要）。

其他可能性：如果数据是静态的，您可以一次将很多（全部？）加载到 C 数组中（尤其是对于 ints 和 bools）。如果有很多相同的值，您可以为相似的值共享对象 - 例如：如果表有 20,000 行，而 18,000 的某些列具有相同的字符串，您可以只创建一个字符串并共享它。

# visual-studio - 当我按下 END 时，如何让 Visual Studio 2008 忽略尾随空格？

> ID：732795
> 
> 赞同：4
> 
> 时间：2009-04-09T04:27:20.057
> 
> 标签：visual-studio, visual-studio-2008, ide, whitespace

当我按下`END`键时，在 VS2008 中这很烦人，我的光标跳到代码行末尾之外，因为我有来自复制+粘贴或重新格式化的尾随空格。

我`END`想要忽略空格的键。我怎样才能最好地做到这一点？

我想使用[AutoHotkey](http://www.autohotkey.com/)来捕捉`END`按键，并将它们替换为 " `CTRL+E`, `\`, `END`" （即“删除水平空白”，在编辑 - > 高级下）。

不过，如果可能的话，我想要一个不那么老套的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T10:58:57.227

不是你想要的'忽略'前面的答案，但你可以做一个*ctrl + delete*应该删除所有的空白。如果不是*contol + shift + 向左箭头*突出显示，则*del*将修复它。

格式选择*ctrl + e, ctrl + f*应该删除尾随空格。根据保罗的评论

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T05:01:37.680

好吧，这是我的 AutoHotkey 脚本：

```
SetTitleMatchMode RegEx
#IfWinActive, .* - Microsoft Visual Studio
End::Send {End}^e\ 
```

猜猜我会使用它，直到有人发布更好的答案:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T05:18:34.020

不是你想要的，但选择标记并执行“格式选择”将删除空格......

# iphone - NSURLConnection 失败问题

> ID：732798
> 
> 赞同：0
> 
> 时间：2009-04-09T04:29:37.053
> 
> 标签：iphone, cocoa, memory-management, nsurlconnection

我正在使用下面列出的 NSURLConnection。关于这门课，我有三个问题。当我连接 url 值时，调试器会点击此行两次，但不会点击它上面的行：

```
if (theConnection){ 
```

我第二次得到 EXC_BAD_ACCESS。使用第一个 url 分配（注释掉）工作正常。

1.) 有什么区别？

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {

//NSString *url = @"http://www.abc.com/afile.mp4";

NSString *temp = @"afile.mp4";
NSString *url = [@"http://www.abc.com/" stringByAppendingString:temp];

theRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:url] 
                                     cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:30.0];
[url release]; 

NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
if (theConnection) {
    receivedData=[[NSMutableData data] retain];
} 
```

2.) 如果我将文件名更改为 afile.mp，则请求通过并且 [receivedData length] 的值约为 1600 时

```
 - (void)connectionDidFinishLoading:(NSURLConnection   *)connection 
```

被击中。有没有办法准确检查 receivedData 是否具有您请求的实际数据。目标文件约为 7MB，但可以从 1.5MB 到 9MB 不等。我请求的资源不存在，但有什么表明吗？

3.）我在我的应用程序委托中这样做。唯一的协议是 UIApplicationDelegate。如果没有委托，所有 NSURLConnection 方法如何工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T06:57:35.107

> 1.) 有什么区别？
> 
> ```
> - (void)applicationDidFinishLaunching:(UIApplication *)application {
>     //NSString *url = @"http://www.abc.com/afile.mp4";
>     NSString *temp = @"afile.mp4";
>     NSString *url = [@"http://www.abc.com/" stringByAppendingString:temp];
> 
>     theRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:url] 
>                                                                              cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:30.0];
>     [url release]; 
> ```

不同之处在于，其中一个可以让您摆脱发布您不拥有的东西而另一个没有。

你没有分配、复制或保留它，所以你不拥有它，所以不要释放它。

作为实现细节，字符串文字不实现引用计数。当您尝试保留或释放字符串文字对象时，它们会忽略您。这就是为什么您发布字符串文字的版本不会崩溃，而您创建新字符串并发布的版本会崩溃。但这是一个实现细节——不要依赖它做任何事情。总是假设释放你不拥有的东西会导致崩溃。

> 有没有办法准确检查 receivedData 是否具有您请求的实际数据。

与错误文件相反？检查响应代码。

与其他一些数据相反？您可以使用散列，但如何确定预期的正确散列取决于您。但是，相信服务器不会给你错误的文件可能更容易。

> 我请求的资源不存在，但有什么表明吗？

是的。实施`connection:didReceiveResponse:`并检查响应代码。

请注意，如果服务器使用 mod_speling 或类似的东西，它可能会更正您的 URL 而不是返回错误——例如，通过将您请求的“afile.mp”更改为实际存在的“afile.mp4”。

> 3.）我在我的应用程序委托中这样做。唯一的协议是 UIApplicationDelegate。如果没有委托，所有 NSURLConnection 方法如何工作？

你说`delegate:self`，所以你是连接的代表。

至少在 Mac 上，NSURLConnection 将方法归类到 NSObject 上，因此它们总是可用的，至少在无操作形式下是可用的。您覆盖这些实现，因此当 NSURLConnection 向您的连接委托（您）发送这些消息时，它们会通过您提供的实现。

# javascript - 如何使用javascript验证网页是否已完全加载

> ID：732801
> 
> 赞同：4
> 
> 时间：2009-04-09T04:32:20.887
> 
> 标签：javascript, javascript-events

我需要禁用我正在使用的图像，`<a "href">`直到页面完全加载。

我不能使用`document.ready()`，因为我需要在文档准备好之前禁用。

有人可以帮我吗？

问候， 格纳内什

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T04:34:18.820

在您的 HTML 中将其定义为禁用：

```
<button disabled="disabled">My Button</button> 
```

然后在页面加载时重新启用它。

这对于没有 Javascript 的用户来说具有破坏功能的缺点。另一种方法是在按钮后直接添加一小行代码：

```
<button id="myButton">My Button</button>

<script type="text/javascript">
    document.getElementById('myButton').disabled = true;
</script> 
```

...然后在 document.load() 上重新启用

**使用新信息编辑**：
它是`input`“图像”类型吗？如果是这样，上述仍然有效。如果不是，并且它是一个`<a>`带有图像的标签，我不建议按照公认的答案进行操作，抱歉。考虑到页面加载时间过长以至于您需要禁用链接，因此最后突然出现图像可能会令人沮丧或分散注意力。我建议的是：

```
<a href="whatever" onclick="return myLinkHandler();"><img src="..." /></a>
<script type="text/javascript">
    var myLinkHandler = function() {
        alert('Page not loaded.');  // or something nicer
        return false;
    };
</script> 
```

然后在您的 document.ready 函数中，更改函数的定义：

```
myLinkHandler = function() {
    alert("Yay, page loaded.");
    return true;
}; 
```

或者，您可以在函数内部进行检查，以查看页面是否已加载。

```
var documentReady = false;
function myLinkHandler() {
    alert (documentReady ? "Ready!" : "Not ready!");
    return documentReady;
}

document.onload = function () { // or use jQuery or whatever
    documentReady = true;
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-09T05:00:33.283

在图像的情况下，只需在`<img>`标签中设置样式为 display:none ，然后使用其他建议删除 CSS 属性或更改它：

`$(document).ready(function(){ $("#myImage").css("display","block"); });`

这样，在文档准备好之前，图像甚至不会出现，然后用户可以单击它。如果您需要加倍努力，请按照其他建议执行并隐藏/禁用标签中的链接并使用 jQuery 显示/启用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T04:37:08.050

使用 jQuery 的完整代码示例：

```
<input type="button" value="My Button" id="mybutton" disabled="disabled" />
<script type="text/javascript">
  $(document).ready(function() { $('#mybutton').removeAttr('disabled'); });
</script> 
```

# ruby-on-rails - 如何在 ruby on rails 表单中处理日期对象？

> ID：732806
> 
> 赞同：3
> 
> 时间：2009-04-09T04:33:57.793
> 
> 标签：ruby-on-rails, ruby, forms, select, date

我正在使用创建 3 个选择列表的 Rails 助手，以便让用户选择日期。如果我为助手指定一个名称，它会将所有 3 个选择列表设置为具有该名称，然后只有最后一个通过（它会覆盖前一个）。我需要知道的是：获取一组 3 个选择列表（日、月、年）并将它们组合以创建日期对象并将其保存到我的数据库中的最佳方法是什么？

这是我的日期字段：

```
<%= select_date Date.today, { :order => [:month, :day, :year], :start_year => Date.today.year, :end_year => Date.today.year + 3 } %> 
```

这是传递给我的控制器的参数（从我的开发日志中吐出）

```
Parameters: {"date"=>{"month"=>"4", "day"=>"9", "year"=>"2009"}, 
"action"=>"create", "controller"=>"shows", 
"show"=>{"headline"=>"for example, \"Parking lot is next to the bookstore on Main Street\"", "venue_id"=>{"venue_id"=>""}, "cents"=>"00", "dollars"=>"00"}, 
"user_id"=>"3", "load_in"=>"-2", "show_time"=>"-2", "query"=>"Type venue name & location here...", "doors"=>"-2"} 
```

如您所见，日期已过。理想情况下，我希望将日期作为可接受的日期对象传递给我的控制器。此外，我希望它在“显示”哈希中传递，因为它是显示数据。这可以通过一些简单的导轨修改来实现吗？或者我是否必须编写一些 JS（......在我看来这个解决方案有点脏）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-09T06:00:37.973

我认为您想要[`date_select`](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#M001666)而不是[`select_date`](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#M001670)，因为您希望它与显示对象中的特定字段相关联。

```
 date_select("show", "date", :default => Date.today, 
    :order => [:month, :day, :year], :start_year => Date.today.year, 
    :end_year => Date.today.year + 3) 
```

# c# - 在 C# 中保存元文件

> ID：732810
> 
> 赞同：6
> 
> 时间：2009-04-09T04:35:26.917
> 
> 标签：c#, wmf, .emf

如果我在 System.Drawing.Image 中有 wmf 或 emf 图像，有没有办法用 c# 保存元文件数据而不将其呈现为位图？调用 Image.Save 会将其呈现为位图，我想保留原始数据，以便它仍然是有效的 .wmf 或 .emf 格式文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T21:19:14.940

尽管有这个 MSDN 页面，但还是可以保存一个真正的 EMF 文件。看到这个问题：[gdi-c-how-to-save-an-image-as-emf](https://stackoverflow.com/questions/152729/gdi-c-how-to-save-an-image-as-emf/895204#895204)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T07:58:35.663

看来你不能。

在[此 MSDN 页面上](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.metafile.aspx)，声明：

**评论**

当您使用 Save 方法将图形图像保存为 Windows 图元文件格式 (WMF) 或增强的图元文件格式 (EMF) 文件时，生成的文件将保存为可移植网络图形 (PNG) 文件。出现此问题的原因是 .NET Framework 的 GDI+ 组件没有可用于将文件另存为 .wmf 或 .emf 文件的编码器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-06T09:43:09.410

如果您使用 gdi32.dll，则可以以原始格式保存元文件。

我正在使用[此处](http://social.msdn.microsoft.com/forums/en/csharpgeneral/thread/12a1c749-b320-4ce9-aff7-9de0d7fd30ea/)描述的方法，并且效果很好。

# sql-server - 通过 SMO 获取 SQL Server 执行计划？

> ID：732811
> 
> 赞同：1
> 
> 时间：2009-04-09T04:35:52.390
> 
> 标签：sql-server

我知道我可以使用“SET showplan_xml ON”在 Management Studio 中以 XML 格式获取执行计划。

有没有办法通过 .NET 代码获取相同的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T04:50:25.757

SET 只是一个普通的 sql 命令，所以如果您可以向服务器发送任意字符串，请发送“set showplan on”。

# html - 互联网浏览器

> ID：732812
> 
> 赞同：0
> 
> 时间：2009-04-09T04:36:34.340
> 
> 标签：html, browser

我有 Internet Explorer 和 Firefox，我将 Firefox 设置为我的默认浏览器。如果我打开一个 .html 或 .mht 文件，该文件将在哪个浏览器中打开

将在注册表中对默认浏览器进行更改的位置

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T04:40:57.510

我无法告诉您在注册表中的哪个位置进行了更改，但如果浏览器没有询问您下次打开它是否应该是您的默认浏览器，只需检查首选项中的相应选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T04:41:06.950

在 Windows XP 中，您可以像这样更改文件类型关联：

1.  打开一个 Windows 资源管理器窗口。
2.  单击工具-> 文件夹选项-> 文件类型。
3.  在列表中找到 HTML，然后单击更改。
4.  选择您要用来打开 HTML 文件的程序，然后单击确定。
5.  在文件夹选项窗口上再次单击确定，您就设置好了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T16:29:25.203

如上所述，有多种方法可以明智地做到这一点，而无需靠近注册表。但是，如果由于某种我目前无法理解的原因，您绝对*必须*通过注册表执行此操作，看看这是否有帮助。这是专门针对 html 文件的，您必须从这个过程中推断出其余部分。

1.  打开 regedit 并导航到`HKEY_CLASSES_ROOT\htmlfile\shell\open\command`
2.  将字符串编辑`(Default)`到您希望用来打开文件的程序的位置。
3.  如果您还想更改图标转到`HKEY_CLASSES_ROOT\htmlfile\DefaultIcon`并更改那里的位置。

这应该可行，尽管我也建议您更改相同的键，`HKEY_LOCAL_MACHINE\SOFTWARE\Classes\htmlfile`因为已知 Windows 在选择时会随机忽略其注册表的位。

不过，正如我所说，这是一种非常冗长的方法。

# asp.net-mvc - 如何将 url 作为查询字符串中的变量传递给我的控制器？

> ID：732813
> 
> 赞同：0
> 
> 时间：2009-04-09T04:37:07.223
> 
> 标签：asp.net-mvc

我正在尝试将 url 作为参数传递给我的控制器，如下所示：

```
//Passed in via url like this: 
//http://www.mydomain.com/Puzzle/ContinuePuzzle/{insert url here}
public ActionResult ContinuePuzzle(string url)
{
    return View("PuzzleWrapper", 
                 (object)_PuzzleService.ContinuePuzzle(url);
} 
```

每当我尝试这个时，我都会收到一个 http 400 Bad Request 错误。我已经尝试过 UrlEncoding 它，但它仍然不喜欢它。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T05:39:24.937

我怀疑 URL 中有两个方案声明会导致默认路由处理程序抛出 400 响应。

作为一种解决方法，我只发送不带方案的 URL（即 http://）。我测试了这个场景没有任何问题：

> [http://www.mydomain.com/Puzzle/ContinuePuzzle/www.domain.com/nextpuzzle](http://www.mydomain.com/Puzzle/ContinuePuzzle/www.domain.com/nextpuzzle)

使用这条路线：

```
routes.MapRoute("Puzzle", "Puzzle/ContinuePuzzle/{*url}", new {controller = "Puzzle", action = "ContinuePuzzle", url = ""}); 
```

如果您必须拥有该方案，请使用 Charlino 建议的查询字符串参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T04:59:12.333

如果你把它放在括号里呢？

让 http:// 在 url 上重新开始是无效的地址。

```
http://www.mydomain.com/Puzzle/ContinuePuzzle/(http://mypuzzlingdomain.com/?a4) 
```

或者也许大括号也可以工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-09T05:09:06.117

对其进行 UrlEncode 但将其作为 get 变量传递...？

例如[http://www.mydomain.com/Puzzle/ContinuePuzzle?url=http%3a%2f%2fmypuzzlingdomain.com%2f%3fa4](http://www.mydomain.com/Puzzle/ContinuePuzzle?url=http%3a%2f%2fmypuzzlingdomain.com%2f%3fa4)

# sql-server - SQL Server 2008 Query 生产速度慢，但开发速度快

> ID：732815
> 
> 赞同：3
> 
> 时间：2009-04-09T04:37:15.897
> 
> 标签：sql-server, sql-server-2008

我有一个查询在生产中运行大约 2-4 分钟，但在开发中运行几秒钟。这两个数据库都在同一台服务器上。（没有关于开发和生产的讲座，生产实际上仍在开发中）。

我的意思是，我可以只打开两个查询窗口并一致地获得两个不同的结果。我已经运行 RedGate SQLCompare 并且没有架构差异（索引等）差异。我已禁用连接到数据库的站点，因此除了我的 Management Studio 会话之外应该没有其他连接。

这可能是什么原因造成的？我通过复制生产数据库来创建开发数据库（在 Management Studio 中，右键单击数据库并单击“复制数据库”）

这真的很奇怪。我不想进行任何索引更改，因为奇怪的是副本速度非常快，但生产非常非常慢，但本质上应该是精确的副本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T04:51:01.450

我不知道 SQLServer 的细节，但通常这种事情是由于两个数据库中的表统计信息不同。查看查询计划以查看它们是否不同。运行 SQLServer 版本的“分析表”或“分析架构”命令。

如果这些事情没有帮助，请检查数据库的设置方式。数据是否可能相同，但服务器配置不同，例如，生产版本的可用内存阈值要低得多？

还有其他要检查的东西——这只是我表现出我的无知——但是“复制数据库”实际上是复制数据，还是仅仅复制对象定义？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T04:50:14.913

您没有提供有关数据库结构或 SQL 查询的任何详细信息，但如果您确信两种环境的设置相同，那么它可能只是您的生产数据库中的大量数据突出显示了一个 in-高效查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T18:07:43.957

好的，谢谢大家。我认为问题与索引碎片有关。我认为复制数据库基本上只是复制了文件。我在每张桌子上都做了一个 DBCC DBREINDEX，现在效果很好。谢谢大家！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-17T23:10:16.370

在我的情况下，原来是因为生产数据库不在现场（不同的城市），而开发数据库在建筑物内。呃。该查询返回了大量数据，当然这些数据量在外部网络上花费的时间更长。我只是没有连接这些点，因为生产数据库比旧的开发盒快得多，而且我们的大多数查询都没有返回足够的数据让网络成为速度因素。相反，但生产盒速度要快得多，即使网络连接速度较慢，大多数查询的返回速度仍然比开发盒快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T04:45:28.513

尝试运行 SQL 探查器以查看生产中运行的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T04:59:02.927

默认情况下，红色门会忽略统计信息和填充因子等内容。

# mercurial - 我可以更改 mercurial 变更集上的用户名吗？

> ID：732819
> 
> 赞同：74
> 
> 时间：2009-04-09T04:37:58.470
> 
> 标签：mercurial

我没有在我的开发计算机上设置用户名并进行了一些提交。我可以追溯更改用户名，以便清楚谁提交了这些变更集吗？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-04-16T19:09:56.757

如果您尚未发布存储库，那么这应该不会太难。您需要使用[Convert 扩展](http://www.selenic.com/mercurial/wiki/index.cgi/ConvertExtension)至 Mercurial，它可以让您“过滤”现有存储库以创建新存储库。--authors 开关允许您在每个提交被过滤时编辑作者。

如果您*已经*发布了您的存储库，请考虑对您的用户的影响，mercurial wiki 有一些[理由不编辑历史](http://www.selenic.com/mercurial/wiki/index.cgi/EditingHistory)。

通过将这些行添加到您的 .hgrc 来启用扩展：

```
[extensions]
hgext.convert= 
```

编写一个文件以将旧名称映射到新名称（authors.convert.list）：

```
user@ubuntu=real.name@my.example.com 
```

运行转换：

```
hg convert --authors authors.convert.list SOURCE DEST 
```

我刚刚检查过，它对我有用:)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-07-31T07:33:27.867

If you have a *single* outgoing changeset, there is a very simple way to do this:

```
$ hg ci --amend --user "My Name <mymail@example.org>" -X "**" 
```

The `-X "**"` option can be omitted if you don't have any local changes.

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-10-15T03:43:58.337

我尝试了几种不同的方法（包括[Convert Extension](https://www.mercurial-scm.org/wiki/ConvertExtension)，我发现它创建了一个不相关的存储库）。[使用 MQ 编辑历史](https://www.mercurial-scm.org/wiki/EditingHistory#Editing_recent_history_with_MQ)的 Mercurial wiki 说明是我发现最有帮助的。（当然，对于编辑任何**公开的**历史记录是一个坏主意，通常有一些警告，但只有您拥有的本地变更集可以编辑）。

我将在这里总结关键步骤，并阐明更改作者的机制。假设第一个错误的作者提交是在修订版`BAD`（当然你还没有在任何地方发布你的更改），你应该能够执行以下操作（我假设你在存储库根目录）：

通过将其添加到 $HOME/.hg/hgrc 来启用 MQ

```
[extensions]
hgext.mq= 
```

将最近的变更集转换为补丁：

```
$ hg qimport -r BAD:tip 
```

（现在可以在 找到它们`.hg/patches`）

“取消应用”所有补丁（假设它们已被应用，并反转它们），以使您的存储库进入修订之前的状态`BAD`：

```
$ hg qpop -a 
```

如果你查看你的补丁，你会发现作者在所有补丁中都被编码在一种注释行中：

```
$ grep User .hg/patches/*
.hg/patches/102.diff:# User Firstname Lastname <f.lastname@oops.wrongurl.example.com> 
```

Now use your favourite search/replace tool to fix the patches (I'm using Perl here). Let's assume you want the commit name to be `f.lastname@righturl.example.com`:

```
$ perl -pi -e 's/f\.lastname\@oops\.wrongurl\.example\.com/f.lastname\@righturl.example.com/' .hg/patches/*.diff 
```

Now check that you have successfully changed the author name, and re-apply the patches:

```
$ hg qpush -a 
```

Then convert the applied patches into proper changesets:

```
$ hg qfinish -a 
```

And you're done. Your repository is still listed as related, so you won't get any complaints about pushing.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-01-31T04:28:04.613

I've used the `histedit` extension which allowed me to change the author without making new repos like "convert" would or resorting to "mq".

First, in your Mercurial config file, make sure your username is set correctly and enable the histedit extension:

```
[ui]
username = Your Name <your.name@domain.org>

[extensions]
histedit = 
```

Then, if you want to change revision 40, use:

```
hg histedit -r 40 
```

In the file that appears, on the line corresponding to revision 40, change the word `pick` to `edit`. Save and close the file.

Now, `hg commit`. You'll need to re-enter your commit message and save.

Finally, `hg histedit --continue`.

The commit will appear with your new `username`. A side-effect is the timestamp of the commit is also updated.

# perl - perl 脚本在文本文件中搜索特定字符串并将整行复制到新文件中？

> ID：732824
> 
> 赞同：1
> 
> 时间：2009-04-09T04:40:57.807
> 
> 标签：perl

我遇到的主要问题是我的脚本运行、打开文本文件、找到字符串并将其复制到新文件中，但有时它不会复制**整**行。它在线路的不同点被切断。我相信我的正则表达式有问题。

一行txt可能如下所示：

> E03020039：无法将 C:\Documents and Settings\rja07\Desktop\DSMProduct\project\Database\Schema\Source\MDB_data_type.dsm 加载到 \DSM R17\projects\Databases\Schema\Source\MDB_data_type.dsm 中。文本文件包含无效字符。

但是，当 Perl 脚本运行时，它有时只会向上复制，直到出现“文本文件”或“文本文件包含”字样，并且该行的最后一部分被切断。我需要完整的线路。这是我到目前为止所拥有的：

```
if ($error =~ /E03020039/)
{
    print $error;
    open (MF, '>>G:/perl/error.txt');
    print MF $error;
    $count ++;
    } 
```

这都在一个 for each 循环中，它扫描文件的每一行：

我试过了：

```
if ($error =~ /E03020039/&&/characters\s\.\n/) 
```

但这对我一点帮助都没有。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-09T06:41:32.260

在我们等待[brian d foy](https://stackoverflow.com/questions/732824/perl-script-to-searches-text-file-for-a-specific-string-and-copies-the-whole-line/732993#732993)建议您提供的信息时，您可能应该检查以下几件事。

为什么？

好吧，看看你发布的代码片段，至少在风格方面，你似乎使用了一些更传统的 Perlisms，而不是现代改进的 Perlisms，并且以现代方式做事通常会让你的生活更轻松。

## 你在使用限制吗？

```
use strict; 
use warnings; 
```

代码顶部的这两行代码可以帮助指出许多愚蠢的错误。

如果您因为错误太多而无法在任何地方打开它们，您可以在一个范围内执行它们，即：

```
 blah;  #no strict or warnings

 {   # scope 

     use strict; 
     use warnings; 
     code(); # with strict and warnings

 }

 blah; # no strict or warnings 
```

## 使用词法文件句柄

裸文件句柄是不整洁的，因为它们是全局唯一的，这可能会有点混乱。

```
{  #scope

  open my $fh , '>' , 'bar.txt'; 
  print $fh "Hello\n";

}  # file cleaned up and closed by perl! 
```

## 尽可能使用 3-Arg open

好的：

```
open my $fh, '>', 'bar.txt'; 
open my $otherfh, '<', 'foo.txt'; 
open my $iofh , '-|' , 'ls', '-la' ; 
```

不建议：

```
open my $fh, '>bar.txt'; 
open my $otherfh , '<foo.txt'; 
open my $iofh , 'ls -la |'; 
```

详情见[`perldoc -f open`](http://perldoc.perl.org/functions/open.html)_

## 检查 Opens 是否真的有效

通常，如果 open 因任何原因而死，默认行为是继续卡车运输，这可能有点奇怪。

有几种方法可以处理这个问题：

选项1：

```
 use Carp(); 
 open my $fh , '>', $filename  or Carp::croak("Oh no! cant open $filename , $! $@"); 
```

选项 2：

```
 use autodie;
 open my $fh , '>', $filename; 
```

*   [自动模](http://p3rl.org/autodie)

## 至于第二个正则表达式

那可能没有做你认为它在做的事情。

```
 if ($error =~ /E03020039/&&/characters\s\.\n/) 
```

基本相同

```
 if (  
         ( $error =~ /E03020039/ ) 
     &&  ( $_     =~ /characters\s\.\n/ ) 
 ) 
```

这可能不是你想要的。

我想你的意思是：

```
 if (  
          ( $error =~ /E03020039/ ) 
      &&  ( $error =~ /characters\s\.\n/) 
 ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T06:02:45.363

我认为您的正则表达式与此无关。您是否至少在新文件中获得了所有正确的行，即使它们被截断？

我认为您需要完成正常的调试步骤：

*   你能给我们展示一个完整但最小的程序来演示错误吗？问题可能出在其他地方。

*   $error 中有什么？当您将其打印到标准输出时，它是否包含所有行？如果没有，请向后工作，直到找到文本丢失的点。在可疑操作之前和之后打印其值并向后工作，直到找到问题为止。

*   您确定所有这些文本都在一行上，还是文件中没有任何额外的奇怪字符？$error 在下一行读到的内容是什么？

*   如果将所有内容都打印到新文件（即匹配所有行）会发生什么？所有文本是否都在新文件中？

*   线条是否总是在同一点被截断？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T04:50:47.860

如果您使用匹配模式（// 与 m// 相同），则 ~= 运算符不应修改错误字符串。

您是否 100% 有信心在正则表达式检查之前没有对其进行修改？我会在比赛前贴上一条打印线，并确保您准确地复制了输入。

您是否 100% 确信您没有遇到 IO 缓冲问题？通常 perl 文件 IO 是缓冲的，因此如果您希望通过 tail -f 或其他方式查看日志文件的完整、最后一行，您可能会在程序退出之前感到失望。

有关如何为文件句柄启用自动刷新的一些选项，请参阅[http://www.rocketaware.com/perl/perlfaq5/How_do_I_flush_unbuffer_a_fileha.htm 。](http://www.rocketaware.com/perl/perlfaq5/How_do_I_flush_unbuffer_a_fileha.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T20:19:01.787

如果目的只是为了完成工作——而不是学习如何用 Perl 编程——那么使用 ' `grep`' 来查找行。这也假设您没有在脚本中做任何其他事情。如果打算学习 Perl，那么您将忽略此建议并注意其他答案。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-09T06:54:21.293

我看到一些立即脱颖而出的事情：

1.  您正在使用全局文件句柄，完成后不关闭它。
2.  您正在使用两个参数 open （这不会导致您的问题，但最好避免）。
3.  您更改的正则表达式不会像您认为的那样做任何事情。

对于 1 和 2：

```
# For loop around this:
if ($error =~ /E03020039/) {
    print $error;

    open(my $mf, '>>', 'G:/perl/error.txt') 
        or die "Unable to open error file - $!\n";

    print $mf $error;
    $count ++;

    close $mf
        or die "Unable to close error file - $!\n";
} 
```

通过使用词法句柄，您可以防止任何其他代码在没有显式传递的情况下接触您的句柄。通过关闭句柄，您可以刷新句柄的缓冲区。通过检查打开和关闭句柄的错误，您可以防止未捕获的错误导致数据丢失。

您可能希望将 open 和 close 移到 for 循环之外：

```
my $count = 0;
open( my $mh, '>>', 'errorlog.log' ) or die "oops $!\n";
for my $error ( <$log_h> ) {

    if ( $error =~ /E23323232323/ ) {
         print $mh $error;
         print $error;
         $count++;
    } 

}
close $mh or die "oops $!\n"; 
```

您的代码将同一文件重新打开到全局文件句柄中。这很容易成为您看到的问题的原因。可能不是。错误的正确信息是否打印到 STDOUT？

关于问题3， `$error =~ /E03020039/&&/characters\s\.\n/`相当于：

```
($error =~ /E03020039/) && ($_ =~ /characters\s\.\n/) 
```

如果您启用了警告，您将（可能）收到`Use of uninitialized value in pattern match (m//)`错误消息。这可能是令人惊讶的，但它会是一个错误的线索。

我相信你想要这样的东西：

$error =~ /E03020039.*?characters\s.$/

但是没有理由延长匹配，因为您没有捕获匹配的任何部分。它不会影响文件中的值`$error`或写入文件的内容。

除非您有特定的理由不这样做，否则请始终使用以下两个 pragma 启动您的 perl 程序：

```
use strict;
use warnings; 
```

即使您有充分的理由不使用它们，最好只在有限的范围内禁用这些 pragma：

```
use strict;
use warnings;

{    no warnings 'uninitialized';
     no strict 'vars';
     print "$foo\n";
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-09T06:54:32.650

你的正则表达式很好。

可能还有另外两个问题：

1.  您的外部 foreach 循环有一些错误。
2.  您使用附加到 error.txt `open (MF, '>>G:/perl/error.txt');`。因此，如果您有此脚本的多个实例并行运行，如果所有实例都尝试同时写入文件，则可能会导致输出出现问题。

或者，您可以使用这个简单的 Perl one-liner 来实现您想要做的事情：

```
perl -nle 'print if /E03020039/' inputFile.txt >> G:/perl/error.txt 
```

# ruby - 在不使用任何框架的情况下使用 Ruby 完成 Web 应用程序 - 有多难？陷阱？

> ID：732828
> 
> 赞同：0
> 
> 时间：2009-04-09T04:41:20.473
> 
> 标签：ruby, frameworks

我是一个红宝石菜鸟。这个社区有没有人写过没有任何框架的 Ruby 应用程序？（编辑：我的目标是自己写一篇。）告诉我们你的经历。有多难？您使用的最低抽象是什么？有哪些陷阱？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T07:22:28.043

这是一个非常非常广泛的问题。您是想编写自己的框架，还是只是一个简单的类似 CGI 的应用程序（您可以使用 ERB 很容易地做到这一点）。

我可以看到不使用框架（包括您编写的框架）的最大陷阱是，其他人很难弄清楚您的代码在做什么以及为什么要这样做。此外，您失去了框架捆绑在一起的所有自动化测试、数据绑定、打包、文档生成和其他好处。

当然，如果您自己完成所有的工作，那么您就只是编写了一个框架。:)

如果不是，那么您已经编写了一堆可怕的意大利面条代码。

由于您是 Ruby 初学者，我要做的是阅读 Rails（或 Sinatra）源代码，并尝试弄清楚它的作用。不是因为它一定是一个很好的例子，而是因为你对 Web 框架的理解将通过深入研究几个来更加完整。这是非常非常有价值的。

编辑：

我看了你的一些其他帖子，看起来你是个学生，所以我要提醒你不要编写自己的框架，不是因为它本身是一个坏主意，而是因为什么是软件框架表示 - 即使用语言 X 工作的年经验的总和。

程序员就像海狸——我们想要构建。我们希望自己构建*一切*，始终以修复现有工具的缺点为理念。虽然这是一件非常崇高的事情，但它往往会导致人们走上很少完成的道路，因为他们不愿意使用其他人编写的工具，通常归结为一些次要的、美观的原因。年轻的程序员对此尤其感到内疚，我也不例外——我浪费了数年的时间来写网络服务器和数据库抽象层，而不是写我本可以赚钱的软件。

如果我可以回去做不同的事情，我会开始为已经存在的框架做出贡献，而不仅仅是试图从头开始“做正确的事”。

现在，“首先使用其他人的工作”的规则有一个例外，那就是当您拥有使用工具的经验时，知道什么时候该构建新东西了。DHH（Rails 的创始人）在决定编写 Rails 之前是一名长期的 Ruby 编码员。

作为一名 Ruby 新手，您可能更擅长阅读其他人编写的内容并对其进行修补/改进，而不是仅仅从您自己开始。您将更多地了解该语言，为社区做出宝贵的贡献，并为自己提供一些不错的简历素材。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T12:53:22.163

你应该问问自己为什么要这样做。像 Sinatra 这样的简单框架确实不会妨碍您。这只是为了学习目的吗？

至少，您应该考虑使用[Rack](http://rack.rubyforge.org/)中间件让您的生活更轻松——将您的应用程序连接到 Rack，并使用 Rack 通过Passenger、Thin、Mongrel 等来托管站点。

# python - 完成后如何关闭此进度条

> ID：732829
> 
> 赞同：1
> 
> 时间：2009-04-09T04:42:59.470
> 
> 标签：python, pyqt, progress-bar

我通常编写 Python scipts 来为我完成转换任务，每当我写一个需要一段时间的时候，我都会使用这个小进度条来检查它

```
import sys
import time
from PyQt4 import QtGui
app = QtGui.QApplication(sys.argv)
barra = QtGui.QProgressBar()
barra.show()
barra.setMinimum(0)
barra.setMaximum(10)
for a in range(10):
    time.sleep(1)
    barra.setValue(a)
app.exec_() 
```

我有两个问题：

当它达到 100% 时，我如何让它自行关闭（它保持打开状态，如果在单击 X 按钮之前关闭 python 外壳，它会崩溃。）

此外，当它失去并重新获得焦点时，它会停止正确绘画。该过程将继续完成，但进度条空间全为白色。我该如何处理？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T13:06:58.043

好吧，因为您将最大值设置为 10，所以您的进度条不应该达到 100%，因为

```
for a in range(10):
  time.sleep(1)
  barra.setValue(a) 
```

最多只能迭代 9 次。

进度条不会自动关闭。你将不得不打电话

```
barra.hide() 
```

在你的循环之后。

至于绘画问题，很可能是因为您运行此脚本的任何脚本都与进度条位于同一线程中。因此，当您切换并返回时，绘制事件会被父脚本的实际处理延迟。您可以设置一个计时器以定期在“barra”上调用 .update() 或 .repaint()（建议使用 update() 而不是 repaint()），**或者**您希望主处理代码在 QThread 中运行，这也是在 PyQt 代码中可用，但这需要您阅读 :)

该文档适用于 Qt，但也适用于 PyQt：

[https://doc.qt.io/qt-4.8/threads.html](https://doc.qt.io/qt-4.8/threads.html)

# php - PHP exec() vs system() vs passthru()

> ID：732832
> 
> 赞同：328
> 
> 时间：2009-04-09T04:44:15.600
> 
> 标签：php, command, exec

有什么区别？

每个功能是否有特定的情况或原因？如果是，你能举一些这些情况的例子吗？

PHP.net 说它们用于执行外部程序。[查看参考](http://php.net/manual/en/function.exec.php) 从我看到的示例中，我没有看到任何明显的区别。

如果我只是运行一个脚本（bash 或 python），你推荐我使用哪个函数？

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2009-04-09T04:50:58.110

它们的目的略有不同。

*   [`exec()`](http://php.net/manual/en/function.exec.php)用于调用系统命令，也许自己处理输出。
*   [`system()`](http://php.net/manual/en/function.system.php)用于执行系统命令并立即显示输出 - 可能是文本。
*   [`passthru()`](http://php.net/manual/en/function.passthru.php)用于执行您希望原始返回的系统命令 - 大概是二进制文件。

无论如何，我建议你不要使用它们中的任何一个。它们都产生高度不可移植的代码。

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2014-01-09T09:23:48.543

来自 [http://php.net/](http://php.net/) && [Chipmunkninja](http://web.archive.org/web/20130809032648/http://chipmunkninja.com/Program-Execution-in-PHP%3A-exec-m@)：

> **[system(](http://php.net/manual/en/function.system.php) )函数**
> 
> PHP 中的系统函数采用字符串参数和要执行的命令以及您希望传递给该命令的任何参数。此函数执行指定的命令，并将任何结果文本转储到输出流（Web 服务器情况下的 HTTP 输出，或者如果您将 PHP 作为命令行工具运行，则为控制台）。如果它发出文本输出，则此函数的返回是程序的最后一行输出。
> 
> **[exec(](http://php.net/manual/en/function.exec.php) )函数**
> 
> system 函数非常有用且强大，但它最大的问题之一是程序生成的所有文本都直接进入输出流。在某些情况下，您可能希望格式化生成的文本并以某种不同的方式显示它，或者根本不显示它。
> 
> 为此，PHP 中的 exec 函数完美适配。它不会自动将正在执行的程序生成的所有文本转储到输出流中，而是让您有机会将这些文本放入函数的第二个参数中返回的数组中：
> 
> **[shell_exec(](http://php.net/manual/en/function.shell-exec.php) )函数**
> 
> 到目前为止，我们执行的大多数程序或多或少都是真正的程序1。但是，Windows 和 Unix 用户操作的环境实际上比这丰富得多。Windows 用户可以选择使用 Windows 命令提示符程序 cmd.exe 该程序称为命令 shell。
> 
> **[passthru(](http://php.net/manual/en/function.passthru.php) )函数**
> 
> PHP 提供的与我们目前看到的类似的一个有趣的函数是 passthru 函数。这个函数和其他函数一样，执行你告诉它的程序。但是，它会立即将来自该程序的原始输出发送到 PHP 当前正在使用的输出流（即 Web 服务器场景中的 HTTP 或 PHP 命令行版本中的 shell）。
> 
> **proc_open ( [)](http://php.net/manual/en/function.proc-open.php)函数和[popen()](http://php.net/manual/en/function.popen.php) 函数**
> 
> proc_open() 与 popen() 类似，但对程序执行提供了更大程度的控制。cmd 是shell要执行的命令。descriptorspec 是一个索引数组，其中键表示描述符编号，值表示 PHP 将如何将该描述符传递给子进程。管道将被设置为文件指针的索引数组，这些指针对应于 PHP 所创建的任何管道的结尾。返回值是代表进程的资源；完成后，您应该使用 proc_close() 释放它。

* * *

## 回答 #3

> 赞同：129
> 
> 时间：2016-09-24T21:58:45.490

以前的答案似乎都有点令人困惑或不完整，所以这里有一张差异表......

```
+----------------+-----------------+----------------+----------------+
|    Command     | Displays Output | Can Get Output | Gets Exit Code |
+----------------+-----------------+----------------+----------------+
| system()       | Yes (as text)   | Last line only | Yes            |
| passthru()     | Yes (raw)       | No             | Yes            |
| exec()         | No              | Yes (array)    | Yes            |
| shell_exec()   | No              | Yes (string)   | No             |
| backticks (``) | No              | Yes (string)   | No             |
+----------------+-----------------+----------------+----------------+ 
```

*   “显示输出”意味着它将输出流式传输到浏览器（或命令行输出，如果从命令行运行）。
*   “Can Get Output”意味着您可以获取命令的输出并将其分配给 PHP 变量。
*   “退出码”是命令返回的特殊值（也称为“返回状态”）。零通常表示成功，其他值通常是错误代码。

其他需要注意的其他事项：

*   shell_exec() 和反引号操作符做同样的事情。
*   还有 proc_open() 和 popen() 允许您使用执行命令交互式地读/写流。
*   如果您还想捕获/显示错误消息，请将“2>&1”添加到命令字符串。
*   使用 escapeshellcmd() 转义可能包含问题字符的命令参数。
*   如果将 $output 变量传递给 exec() 以存储输出，如果 $output 不为空，它将追加新的输出。所以你可能需要先 unset($output) 。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-04-09T04:51:57.873

实际上，这完全取决于您希望如何处理命令可能返回的输出，以及您是否希望 PHP 脚本等待被调用程序完成。

*   `exec`执行命令并将输出传递给调用者（或在可选变量中返回）。

*   `passthru``exec()`与执行命令的功能相似。当 Unix 命令的输出是需要直接传回浏览器的二进制数据时，`exec()`应使用此函数。`system()`

*   `system`执行外部程序并显示输出，但只显示最后一行。

如果您需要执行命令并将命令中的所有数据直接传回而不受任何干扰，请使用该`passthru()`功能。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-04-09T17:13:17.737

如果您从命令行运行 PHP 脚本，`passthru()`则有一大好处。它将让您执行脚本/程序，例如`vim`，`dialog`等，让这些程序处理控制并仅在完成后返回您的脚本。

如果您使用`system()`或`exec()`执行这些脚本/程序，它根本就无法工作。

Gotcha：由于某种原因，您无法在 PHP 中执行`less`with 。`passthru()`

# .net - 我应该为此使用 Umbraco 吗？

> ID：732836
> 
> 赞同：4
> 
> 时间：2009-04-09T04:46:54.283
> 
> 标签：.net, content-management-system, umbraco

我需要设置一个允许用户、用户博客、论坛的网站，并且足够灵活，可以通过 .net 添加其他功能。我正要评估 Umbraco，但对于另一个显然在 CMS 小巷中的网站，但上述项目需要更快的周转时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T17:51:05.503

Umbraco 支持用户，例如具有各种编辑和发布权限的后端用户。有几个博客和评论包供后端用户使用。Umbraco v4 也有 Canvas（在网站内就地编辑）。

它还支持会员资格，即前端网站“会员”。您可以使用像 Doc2Form 这样的扩展为这些“成员”提供博客。

Umbraco v4 现在使用标准的 .NET 登录控件，因此设置会员资格和注册相当容易。

对于论坛，Umbraco 通常与 YAF 配对。[在http://www.createsoft.co.uk/blog/](http://www.createsoft.co.uk/blog/)上有一篇关于如何做到这一点的文章

那篇文章描述了如何将 YAF 集成为 Umbraco 中的 .NET 控件。如果您将会员资格用于其他用途，论坛将使用单独的用户名和密码作为会员 ID。你需要在 Umbraco 论坛上询问如何解决这个问题（已经完成）

在 Umbraco 中使用或开发 .Net 控件很容易。YAF 和 Doc2Form 是这里提到的 2 个例子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T04:53:42.457

Umbraco 非常适合程序员，尽管 (IMO) 对技术不那么好的人来说并不是那么好。它确实满足了您所描述的所有内容，但根据我的经验，相对缺乏文档使得使用用户/组和权限变得更加困难（这是网站的用户和组，而不是实际的 Umbraco 应用程序） .

否则，我发现 Umbraco 非常适合任何类型的网站，它是我选择的 CMS。

注意：我最后一次使用 Umbraco 大约是一年前，所以现在可能会有更多的文档。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-12T18:34:23.313

Umbraco 是一款出色的 CMS - 我个人的最爱。一开始它可能有点让人不知所措（特别是如果你不喜欢 XSLT），但它非常灵活，可以做任何事情！

*   Umbraco 内置了非常易于使用的会员系统，您还可以使用自定义的 .net 会员提供商。
*   [Blog4Umbraco 是一个很棒的 Umbraco 博客包](http://www.nibble.be/?p=57)（不要使用 Doc2Form！）。
*   虽然 YAF 很好，但 Umnbraco 有一个名为 [uForum](http://our.umbraco.org/projects/uforum-basics)的新论坛包- 这实际上为[OurUmbraco 论坛](http://our.umbraco.org/forum)提供了支持。
*   Umbraco 可以通过 .NET 控件或 XSLT（它具有完整的 API）轻松扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T18:21:02.420

对于学习，umbraco.tv 非常棒。它值得订阅一两个月，至少只是为了快速上手。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-31T09:18:06.973

使用简单的表单包或 nforum 包来满足此类需求。这是简单表格的链接，您可以在其中下载此包

```
http://our.umbraco.org/projects/developer-tools/simple-forms 
```

# asp.net - ASP.NET MVP 和 AJAX 发布/网络服务

> ID：732837
> 
> 赞同：2
> 
> 时间：2009-04-09T04:47:02.877
> 
> 标签：asp.net, ajax, web-services, mvp

将 MVP 模式应用于 ASP.NET 应用程序时，使用 AJAX 发布数据适合哪些地方？在我所知道的 MVP 模式中，UI 很简单（外观），所有繁重的工作都在 Presenter 中完成。我看不出您如何遵循该模式并仍然使用 AJAX 与客户端上的 Web 服务进行交互。是否有人对如何使用 AJAX 和 Web 服务并仍然遵循 MVP 模式有任何参考？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T22:26:20.420

我对 AJAX 使用与常规 ASP.Net 回发相同的方法。视图接收帖子，但将其传递给处理处理的演示者。在视图中，我只是解析来自 AJAX 的请求，然后在 Presenter 类上调用适当的方法。

可以将 Web 服务视为“呈现”消息而不是呈现 HTML 的视图。我将 Web 服务视为视图，并以与 ASPX 页面相同的方式使用演示器，另外还有一个优点是我不需要解析请求。

我将演示者与消息分离，让 Web 服务负责从演示者分配的视图数据中创建返回消息。输入消息也仅在 Web 服务级别是已知的。

# javascript - 麻烦的javascript

> ID：732840
> 
> 赞同：0
> 
> 时间：2009-04-09T04:48:40.580
> 
> 标签：javascript, jquery, html

我正在尝试制作一个小标签列表 doohickey 来添加和删除标签。我有一个文本框，用户可以在其中输入标签，用逗号分隔。和一个添加按钮。当用户单击添加按钮以在框下方的 div 内部添加一个小 div 时，我希望它。小 div 应该包含标签和稍后要删除标签的小 x。这是我所拥有的：

```
<script type='text/javascript'>
  function tagsremove(tag) {
    document.getElementByName('tags').value.replace('/'+tag+'\,\s/', '');
  }

  $('#tagbutton').click(function(){
    var tags = $('#tagsbox').text().split(", ");
    for (var tag in tags) {
      document.getElementByName('tags').value += tag +", ";
      $('#curtags').append("<div class='tag'>" 
        + tag 
        + " <a href='#' onlclick='tagsremove(\'" 
        + tag 
        + "\');$(this).hide();'>x</a></div>")
    }
  });
</script>

<div class='statbox'>
  <form method='post' action='post.php' id='writeform'>
    <p class='subtitle'>Title</p>
    <input type='text' name='title' id='titlebox' /><br />
    <p class='subtitle'>Body</p>
    <textarea id='postbox' name='body' rows='10'></textarea><br />
    <p class='subtitle'>Tags</p>
    <input type='text' id='tagsbox' /><input type='button' id='tagbutton' 
      value='Add' />
    <p class='subsubtitle'>Seperate by commas 
      (eg. "programming, work, job")</p>
    <div class='subsubtitle' id='curtags'>Current Tags:</div>
    <input type='hidden' value='' name='tags' />
  </form>
</div> 
```

我遇到的问题是，当我单击添加按钮时，什么也没有发生。我想解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T05:07:06.823

你的第一个问题是

```
$('#tagsbox').text() 
```

应该

```
$('#tagsbox').val() 
```

因为#tagsbox 是一个输入字段。

还有其他问题，例如在“，”上拆分，然后修剪而不是在“，”上拆分，但我认为您的主要问题是 .text() 与 .val()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T05:03:33.370

我的猜测是在加载dom之前正在执行注册click事件的脚本块，因此click事件实际上并未注册到真实元素。将您的点击事件放在 document.ready 事件中，如下所示：

```
$(function() {
    $('#tagbutton').click(function(){
        //etc...
    });
}); 
```

另外，（顺便说一句）为什么要将 jQuery 与常规 javascript 混合？将您的隐藏标签字段更改为具有标签的 id 并执行 $('#tags').val(...) 而不是 document.getElementByName('tags').value = ... 可能会更整洁

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T05:16:55.520

您的代码中有一些问题：

1 ) document.getElementByName('tags')

该函数不存在，您尝试使用的函数是 getElementsByName （注意“s”），但由于您使用的是 jQuery，您可以使用如下选择器：

```
 var hiddenTags = $('input[name=tags]'); 
```

2）您正在使用 text()，而不是 val() 作为[@Blair](https://stackoverflow.com/questions/732840/troublesome-javascript/732880#732880)点

3）在 foreach 中，您只访问元素索引，要访问实际元素值，您必须执行以下操作：

```
for (var i in tags) {
    var tag = tags[i];
} 
```

还有更多工作要做，但首先，请[在此处](http://jsbin.com/urinu)查看我的更正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T04:59:12.240

我不熟悉单击按钮时使用此方法调用函数

```
$('#tagbutton').click(function(){ 
```

我通常只是把

```
onClick='function()' 
```

在输入标签内。并在脚本中将函数声明为正常。

另外，我认为您应该用一个空格分隔标签。这是人们习惯的。但如果您确实决定希望能够使用多个单词标签，则用“，”而不是“，”分隔

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T05:33:01.723

首先，正如上面提到的，您的 onclick 事件的 Javascript 代码是在页面上创建元素之前注册的。因此，它不受约束。要解决此问题，请使用 jQuery 提供的这个 dom 就绪函数将您的代码包装起来。

```
$(document).ready(function () {
    //put code here
}); 
```

将此行 var tags = $('#tagsbox').text().split(", ") 更改为

```
var tags = $('#tagsbox').attr('value').split(',') 
```

由于 document.getElementByName 不是 JS 函数，因此您的代码中也存在语法错误。也许为它分配一个 id 或 name 属性来定位它。

接下来，一旦您将隐藏标签拆分为一个数组，也许可以通过这种方式遍历它们来构建它们。

```
$.each(tags, function(i, val) {
    $('#curtags').append("<div class='tag'>" 
    + val 
    + " <a href='#' onlclick='tagsremove(\'" 
    + tag 
    + "\');$(this).hide();'>x</a></div>")
}); 
```

# javascript - JavaScript图像裁剪问题

> ID：732853
> 
> 赞同：0
> 
> 时间：2009-04-09T04:55:58.707
> 
> 标签：javascript

我正在使用此代码来选择需要裁剪的图像区域。

```
function preview(img, selection) {
var scaleX = 100 / selection.width;
var scaleY = 100 / selection.height;

$('#thumbnail + > img').css({
width: Math.round(scaleX * 354) + 'px',
height: Math.round(scaleY * 448) + 'px',
marginLeft: '-' + Math.round(scaleX * selection.x1) + 'px',
marginTop: '-' + Math.round(scaleY * selection.y1) + 'px'
});
$('#x1').val(selection.x1);
$('#y1').val(selection.y1);
$('#x2').val(selection.x2);
$('#y2').val(selection.y2);
$('#w').val(selection.width);
$('#h').val(selection.height);
}

$(window).load(function () {
$('#thumbnail').imgAreaSelect({ x1: 120, y1: 90, x2: 280, y2: 210, aspectRatio: '1:1', onSelectChange: preview });

}); 
```

这很好用，但我使用标签来显示不同的部分。当我单击下一个选项卡时，我可以看到我不想要的图像裁剪器。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T05:01:54.823

嗨，我认为您正在使用 div 作为图像裁剪器。如果是这种情况，您可以在单击另一个选项卡时设置 div 属性 style.display='none'。

# asp.net - 如何最好地控制 ASP.NET 中多个 javascript 文件的加载？

> ID：732854
> 
> 赞同：1
> 
> 时间：2009-04-09T04:56:02.403
> 
> 标签：asp.net, javascript

我正在研究如何改进一个相当复杂的 ASP.NET 站点的页面加载性能和渲染时间。

由于使用了很多本身包含 javascript 文件的 ASP.NET 控件（通过简单地使用脚本标签），某些页面加载相同的 javascript 最多 10 次。此外，一些 javascript 必须在页面的早期加载，而其他的最好在最后包含。有些我想在 onload 事件之后动态加载，而不是显式包含在页面中。

我正在考虑的方式是让所有不同的控件在一个中心位置注册它们对特定 javascript 文件的需求，从而控制脚本标签的生成（从而避免重复）以及它们被插入到生成的输出中的位置. 这也使得在缩小和完整 javascript 文件之间动态切换变得容易（例如，将 debug=true 附加到查询字符串将使文件通过*filename.debug.js*而不是*filename.compressed.js*加载）。

使用此解决方案，它还可以基本上生成一个 javascript 文件名数组，自定义 onload javascript 函数使用这些文件名来动态加载脚本。

实现这一目标的最佳方法是什么？使用或扩展诸如 ScriptManager 之类的东西，制作自定义控件，覆盖 Page 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T09:00:21.757

在控件的 Page_Load 方法中，您可以注册您的 javascript 以进行输出（在确认它尚未注册之后）。

例如，

```
ClientScriptManager script = Page.ClientScript;
if (!script.IsClientScriptIncludeRegistered("AlertHello"))
{
    script.RegisterClientScriptInclude("AlertHello", "Public/AlertHello.js");
} 
```

`.RegisterClientScriptBlock()`注意：如果你想要一个 JS 块而不是一个单独的文件，你可以使用。

但是，这会在打开页面的表单标签后不久输出脚本标签。要在页面末尾附近输出您的脚本（即，就在表单标记*关闭*`.RegisterStartupScript()`之前），请使用这些方法。

```
ClientScriptManager script = Page.ClientScript;
if (!script.IsStartupScriptRegistered("StartupAlert"))
{
    script.RegisterStartupScript(this.GetType(), "StartupAlert",
           "<script type='text/javascript' src='Public/Alert.js'></script>");
} 
```

但是，假设您在特定位置绝对需要它，您可以添加一个返回脚本标记的静态（或 VB.NET 中的“共享”）只读属性，以及一个告诉控件是否输出脚本标签。在这种情况下，在您的 ASPX 中，您可以执行类似...

```
<body>
  <!-- any place -->
  <uc1:myControl ID="myControl1" runat="server" jsOutput="False" />
  <!-- elsewhere -->
  <asp:Literal ID="litJS" runat="server" OnLoad="litJS_Load" />
</body> 
```

然后程序`litJS_Load`将发送者的 Text 属性设置为 myControl 类的静态属性返回的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T19:03:13.980

如前所述，通过控件的 Load 事件使用脚本注册是一个好主意，如果它们是已编译的控件，您也可以将它们作为嵌入式资源引用...如果您使用的是 ASP.Net Ajax，则可以使用[ScriptManager](http://www.asp.net/Ajax/Documentation/Live/overview/ScriptManagerOverview.aspx)可以将页面中的脚本合并到一个连续的块中以供下载。

[雅虎也有很多](http://developer.yahoo.com/performance/rules.html)关于脚本性能的信息，这方面的建议也包含在 Firefox 的[YSlow](http://developer.yahoo.com/performance/rules.html)扩展中，它扩展了[firebug](https://addons.mozilla.org/en-US/firefox/addon/7451)。

除了将脚本作为外部资源外，您还应该在服务器上启用压缩，这样可以减少各种脚本的下载。更不用说缩小包含的脚本了。

# javascript - AJAX Web 应用程序可用性的技术限制是什么？

> ID：732862
> 
> 赞同：2
> 
> 时间：2009-04-09T05:00:22.613
> 
> 标签：javascript, html, ajax, web-applications

我试图了解基于 Web 的生产力应用程序的可用性的技术限制，这些应用程序仅在客户端上使用开放的跨平台技术，例如 Javascript、HTML 和 CSS。[1]

让我们暂时假设一下，在接下来的几年中，Web 浏览器的功能会继续改进（例如，使用 HTML 5 和更快的 JS 引擎），并且在增加带宽和减少延迟方面取得了重大进展。**与传统的客户端应用程序相比，哪些技术障碍（例如性能、图形、用户交互模式）将限制 Web 生产力应用程序的可用性？**（除了离线访问和具有重要非技术方面的问题，例如隐私问题。）

[1] 我所说的“生产力应用程序”是指诸如办公套件、电子邮件、日历和图表程序之类的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T05:04:47.797

> 在增加带宽和减少延迟方面取得了重大进展。

这**是**限制，延迟不会在未来显着改善（这里有真正的物理限制）。往返是瓶颈。

至于改进，我认为 javascript 越来越快，AJAX 越来越少，客户端工作越来越多。现在，很多 AJAX 用于从服务器获取显示 HTML 以在浏览器中呈现。未来，AJAX 将严格用于数据，javascript 处理所有显示。

所以我看到的障碍是javascript性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T05:13:18.137

真正的问题是 html+css 不提供 2d 或 3d 渲染原语或任何类型的实时声音接口。没有这些，我们对桌面应用程序的许多期望都是不可能的。我在考虑游戏、2d/3d 图像和视频编辑、实时通信等。显然，您现在可以做这些事情，只是不用开放标准。运气好的话，Flash、Silverlight 和 JavaFX 中越来越多的丰富功能将被推向“标准”，障碍将完全消失。

我看不出有任何理由在几年内 99% 的“生产力”应用程序无法在浏览器中运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T05:25:26.327

基本上随着 Flash 虚拟机和浏览器中 javascript 实现的改进，您所看到的是传统 Web 功能与典型客户端应用程序设计的融合。主要区别在于，每个页面或片段的代码都是按需下载并在跨各种平台的标准化环境中执行的。本质上，传统的 Web 应用程序越来越像客户端应用程序。然而，仍然需要不以这种方式运行的 Web 应用程序。今天，您可以选择其中之一，或两者兼而有之。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T05:02:13.327

较旧的浏览器。周围还有很多 IE 6 用户。随着网络变得更加 AJAX-y，当前几乎没有削减它的浏览器将成为一个更大的问题。

# c# - 完成与处置

> ID：732864
> 
> 赞同：246
> 
> 时间：2009-04-09T05:00:43.203
> 
> 标签：c#, dispose

为什么有些人使用`Finalize`方法而不是`Dispose`方法？

在什么情况下你会使用`Finalize`方法而不是`Dispose`方法，反之亦然？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-04-09T05:05:33.847

当您的对象被垃圾收集并且您无法保证何时会发生这种情况时会调用终结器方法（您可以强制它，但它会损害性能）。

`Dispose`另一方面，该方法旨在由创建您的类的代码调用，以便您可以在代码完成时清理和释放您获得的任何资源（非托管数据、数据库连接、文件句柄等）你的对象。

标准做法是实现`IDisposable`，`Dispose`以便您可以在`using`声明中使用您的对象。比如`using(var foo = new MyObject()) { }`。在你的终结器中，你调用`Dispose`，以防调用代码忘记处理你。

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2009-04-09T05:14:33.797

`Dispose`其他人已经涵盖了和之间的区别`Finalize`（顺便说一句，该方法在语言规范中仍称为析构函数），因此我将仅添加一些有关该方法派上用场`Finalize`的场景。`Finalize`

某些类型以一种易于使用和在单个操作中处理它们的方式封装了一次性资源。一般的用法往往是这样的：打开、读取或写入、关闭（Dispose）。它非常适合`using`构造。

其他的有点困难。`WaitEventHandles`因为实例不是这样使用的，因为它们用于从一个线程向另一个线程发送信号。那么问题就变成了谁应该调用`Dispose`这些？作为一种安全措施，这些类型实现了一种`Finalize`方法，该方法确保在应用程序不再引用实例时释放资源。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2009-04-09T05:09:20.593

Finalize 是 backstop 方法，由垃圾收集器在回收对象时调用。Dispose 是“确定性清理”方法，由应用程序调用以在不再需要时释放有价值的本机资源（窗口句柄、数据库连接等），而不是让它们无限期地保持直到 GC 轮到对象。

作为对象的用户，您总是使用 Dispose。Finalize 用于 GC。

作为一个类的实现者，如果你持有应该被释放的托管资源，你就实现了 Dispose。如果持有原生资源，则同时实现 Dispose 和 Finalize，并且都调用释放原生资源的通用方法。这些惯用语通常通过私有 Dispose(bool disposing) 方法组合在一起，Dispose 调用为 true，Finalize 调用为 false。此方法始终释放本机资源，然后检查 disposing 参数，如果为 true，则释放托管资源并调用 GC.SuppressFinalize。

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2009-04-09T05:04:16.283

当该对象不再使用时，GC 会调用 Finalize。

Dispose 只是一个普通的方法，这个类的用户可以调用它来释放任何资源。

如果用户忘记调用 Dispose 并且该类已实现 Finalize，则 GC 将确保它被调用。

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2009-11-10T14:55:22.037

**敲定**

*   终结器应该总是`protected`, not`public`或者`private`不能直接从应用程序代码中调用该方法，同时它可以调用该`base.Finalize`方法
*   终结器应该只释放非托管资源。
*   该框架不保证终结器将在任何给定实例上执行。
*   永远不要在终结器中分配内存或从终结器调用虚拟方法。
*   避免在终结器中同步和引发未处理的异常。
*   终结器的执行顺序是不确定的——换句话说，您不能依赖在终结器中仍然可用的另一个对象。
*   不要在值类型上定义终结器。
*   不要创建空的析构函数。换句话说，除非您的类需要清理非托管资源，并且如果您确实定义了一个，它应该做一些工作，否则您永远不应该显式定义析构函数。如果以后不再需要清理析构函数中的非托管资源，请将其完全删除。

**处置**

*   `IDisposable`在每个具有终结器的类型上实现
*   `Dispose`确保在调用该方法后使对象不可用。换句话说，避免在`Dispose`方法被调用后使用对象。
*   完成后调用`Dispose`所有`IDisposable`类型
*   允许`Dispose`多次调用而不会引发错误。
*   `Dispose`使用该`GC.SuppressFinalize`方法从该方法中抑制以后对终结器的调用
*   避免创建一次性值类型
*   避免从`Dispose`方法中抛出异常

处置/最终模式

*   Microsoft 建议您在使用非托管资源时`Dispose`同时实现两者。当对象被垃圾回收时，即使开发人员忽略了显式调用该方法`Finalize`，实现也会运行并且资源仍然会被释放。`Finalize``Dispose`
*   清理`Finalize`方法和`Dispose`方法中的非托管资源。此外，从该`Dispose`方法调用您作为该类内部组件（具有非托管资源作为其成员）的任何 .NET 对象的`Dispose`方法。

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2014-09-07T14:41:17.797

MCSD Certification Toolkit (exam 70-483) page 193 一书中有一些关键点：

**析构函数≈（几乎等于）`base.Finalize()`**，析构函数被转换为Finalize方法的重写版本，执行析构函数的代码，然后调用基类的Finalize方法。然后它完全是不确定的，你无法知道什么时候会被调用，因为取决于 GC。

**如果一个类不包含托管资源和非托管资源**，则它不应实现`IDisposable`或具有析构函数。

**如果该类只有 managed resources**，它应该实现`IDisposable`但它不应该有析构函数。（当析构函数执行时，你不能确定托管对象仍然存在，所以`Dispose()`无论如何你不能调用它们的方法。）

**如果该类只有非托管资源**，则它需要实现`IDisposable`并需要一个析构函数以防程序不调用`Dispose()`。

`Dispose()`方法必须安全地运行多次。您可以通过使用变量来跟踪它之前是否运行过来实现这一点。

**`Dispose()`应该释放托管和非托管资源**。

**析构函数应该只释放非托管资源**。当析构函数执行时，你不能确定托管对象是否仍然存在，所以无论如何你都不能调用它们的 Dispose 方法。这是通过使用规范`protected void Dispose(bool disposing)`模式获得的，其中只有托管资源在`disposing == true`.

**释放资源后，`Dispose()`应该调用`GC.SuppressFinalize`**，这样对象就可以跳过终结队列。

具有非托管和托管资源的类的实现示例：

```
using System;

class DisposableClass : IDisposable
{
    // A name to keep track of the object.
    public string Name = "";

    // Free managed and unmanaged resources.
    public void Dispose()
    {
        FreeResources(true);

        // We don't need the destructor because
        // our resources are already freed.
        GC.SuppressFinalize(this);
    }

    // Destructor to clean up unmanaged resources
    // but not managed resources.
    ~DisposableClass()
    {
        FreeResources(false);
    }

    // Keep track if whether resources are already freed.
    private bool ResourcesAreFreed = false;

    // Free resources.
    private void FreeResources(bool freeManagedResources)
    {
        Console.WriteLine(Name + ": FreeResources");
        if (!ResourcesAreFreed)
        {
            // Dispose of managed resources if appropriate.
            if (freeManagedResources)
            {
                // Dispose of managed resources here.
                Console.WriteLine(Name + ": Dispose of managed resources");
            }

            // Dispose of unmanaged resources here.
            Console.WriteLine(Name + ": Dispose of unmanaged resources");

            // Remember that we have disposed of resources.
            ResourcesAreFreed = true;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-04-09T05:10:21.043

99% 的时间，你也不应该担心。:) 但是，如果您的对象持有对非托管资源（例如，窗口句柄、文件句柄）的引用，您需要为托管对象提供一种释放这些资源的方法。Finalize 提供对释放资源的隐式控制。它由垃圾收集器调用。Dispose 是一种对资源释放进行显式控制的方法，可以直接调用。

[关于垃圾收集](http://msdn.microsoft.com/en-us/library/0xy59wtx(VS.71).aspx)的主题还有很多需要了解，但这只是一个开始。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-11-28T15:28:03.337

终结器用于隐式清理 - 每当一个类管理绝对**必须**清理的资源时，您都应该使用它，否则您会泄漏句柄/内存等...

众所周知，正确实现终结器非常困难，应尽可能避免使用`SafeHandle`该类（在 .Net v2.0 及更高版本中可用）现在意味着您很少（如果有的话）需要再实现终结器。

该`IDisposable`接口用于显式清理并且更常用 - 您应该使用它来允许用户在完成使用对象时显式释放或清理资源。

请注意，如果您有终结器，那么您还应该实现`IDisposable`接口以允许用户显式释放这些资源，而不是对象被垃圾回收时。

有关我认为关于终结器[和](http://joeduffyblog.com/2005/04/08/dg-update-dispose-finalization-and-resource-management/)`IDisposable`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-03-28T12:08:08.880

C# 中的 Finalize 和 Dispose 方法之间的区别。

GC调用finalize方法回收非托管资源（如文件操作、windows api、网络连接、数据库连接），但GC调用的时间不固定。它被 GC 隐式调用，这意味着我们对它没有低级控制。

Dispose 方法：当我们从代码中调用它时，我们对其进行了低级控制。我们可以在感觉不可用时回收非托管资源。我们可以通过实现 IDisposal 模式来实现这一点。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-08-17T09:00:02.897

总结是——

*   如果您的类引用了非托管资源，并且您希望确保在该类的实例被 **自动**垃圾收集时释放这些非托管资源，则为您的类编写终结器。请注意，您不能显式调用对象的终结器 - 垃圾收集器会在认为必要时自动调用它。
*   另一方面，当您的类引用非托管资源时，您实现 IDisposable 接口（并因此为您的类定义 Dispose() 方法），但您不想等待垃圾收集器启动（可以随时 - 不受程序员的控制）并希望在完成后立即释放这些资源。因此，您可以通过调用对象的 Dispose() 方法**显式释放非托管资源。**

此外，另一个区别是 - 在 Dispose() 实现中，**您也应该释放托管资源**，而在 Finalizer 中不应该这样做。这是因为对象引用的托管资源很可能在准备完成之前已经被清理了。

对于使用非托管资源的类，最佳实践是同时定义 Dispose() 方法和 Finalizer 以用作后备，以防开发人员忘记显式释放对象。两者都可以使用共享方法来清理托管和非托管资源：-

```
class ClassWithDisposeAndFinalize : IDisposable
{
    // Used to determine if Dispose() has already been called, so that the finalizer
    // knows if it needs to clean up unmanaged resources.
     private bool disposed = false;

     public void Dispose()
     {
       // Call our shared helper method.
       // Specifying "true" signifies that the object user triggered the cleanup.
          CleanUp(true);

       // Now suppress finalization to make sure that the Finalize method 
       // doesn't attempt to clean up unmanaged resources.
          GC.SuppressFinalize(this);
     }
     private void CleanUp(bool disposing)
     {
        // Be sure we have not already been disposed!
        if (!this.disposed)
        {
             // If disposing equals true i.e. if disposed explicitly, dispose all 
             // managed resources.
            if (disposing)
            {
             // Dispose managed resources.
            }
             // Clean up unmanaged resources here.
        }
        disposed = true;
      }

      // the below is called the destructor or Finalizer
     ~ClassWithDisposeAndFinalize()
     {
        // Call our shared helper method.
        // Specifying "false" signifies that the GC triggered the cleanup.
        CleanUp(false);
     } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-10-10T05:31:23.030

我知道的最好的例子。

```
 public abstract class DisposableType: IDisposable
  {
    bool disposed = false;

    ~DisposableType()
    {
      if (!disposed) 
      {
        disposed = true;
        Dispose(false);
      }
    }

    public void Dispose()
    {
      if (!disposed) 
      {
        disposed = true;
        Dispose(true);
        GC.SuppressFinalize(this);
      }
    }

    public void Close()
    {
      Dispose();
    }

    protected virtual void Dispose(bool disposing)
    {
      if (disposing) 
      {
        // managed objects
      }
      // unmanaged objects and resources
    }
  } 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-01-02T22:10:46.670

Dispose 和 Finalize 的主要区别在于：

`Dispose`通常由您的代码调用。当您调用它时，资源会立即释放。人们忘记调用方法，所以`using() {}`发明了语句。当你的程序执行完里面的代码后`{}`，它会自动调用`Dispose`方法。

`Finalize`不是由您的代码调用的。它意味着被垃圾收集器（GC）调用。这意味着将来只要 GC 决定释放资源，就可以随时释放资源。当 GC 完成它的工作时，它会经过许多 Finalize 方法。如果你在这方面有很重的逻辑，它会使这个过程变慢。它可能会导致您的程序出现性能问题。所以要小心你放在那里的东西。

我个人会在 Dispose 中编写大部分销毁逻辑。希望这可以消除混乱。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-06-01T15:17:49.877

类实例通常封装对不受运行时管理的资源的控制，例如窗口句柄 (HWND)、数据库连接等。因此，您应该提供显式和隐式两种方式来释放这些资源。通过在对象上实现受保护的 Finalize 方法来提供隐式控制（C# 中的析构函数语法和 C++ 的托管扩展）。垃圾收集器在不再有对该对象的任何有效引用后的某个时间点调用此方法。在某些情况下，您可能希望为使用对象的程序员提供在垃圾收集器释放对象之前显式释放这些外部资源的能力。如果外部资源稀缺或昂贵，如果程序员在不再使用资源时显式释放资源，则可以获得更好的性能。要提供显式控制，请实现 IDisposable 接口提供的 Dispose 方法。对象的使用者在使用完对象后应该调用此方法。即使对该对象的其他引用仍然存在，也可以调用 Dispose。

请注意，即使您通过 Dispose 提供显式控制，您也应该使用 Finalize 方法提供隐式清理。Finalize 提供了一个备份，以防止在程序员未能调用 Dispose 时资源永久泄漏。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-11-08T14:52:17.083

我今天搜索了很多这个问题的答案。我将在这里分享我的学习。我的回答是基于[这个链接](https://docs.microsoft.com/en-us/dotnet/standard/garbage-collection/unmanaged)，因为它有我见过的最清晰的解释。

当您的对象可以访问非托管资源时，您必须手动释放这些资源。这可以通过 IDisposable 或终结器来完成，这意味着它们都释放非托管资源。

**经验法则：** 实现 IDisposable 以释放非托管资源，调用者代码必须调用 Dispose 方法。如果调用者忘记调用 Dispose() 方法，您仍然可以提供释放这些非托管资源的方法。第一个选项是使用安全句柄来包装非托管资源。第二个选项是定义终结器。在这种情况下，建议使用安全手柄。

我认为[这个链接](https://docs.microsoft.com/en-us/dotnet/standard/garbage-collection/unmanaged)是这个问题的最清楚的答案。我不知道为什么人们在互联网上对这个问题提供复杂的解释。在我找到那个链接之前，这让我感到困惑。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2015-12-07T17:48:18.323

正如我们所知， dispose 和 finalize 都用于释放非托管资源.. 但不同之处在于 finalize 使用两个周期来释放资源，而 dispose 使用一个周期..

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2019-05-23T21:52:57.123

要回答第一部分，您应该提供人们对完全相同的类对象使用不同方法的示例。否则很难（甚至奇怪）回答。

至于第二个问题，最好先阅读这个 [Proper use of the IDisposable interface](https://stackoverflow.com/questions/538060/proper-use-of-the-idisposable-interface/538238#538238) 它声称

> 这是你的选择！但选择处置。

换句话说：GC 只知道终结器（如果有的话。也称为 Microsoft 的析构函数）。一个好的代码会尝试从两者（终结器和 Dispose）中进行清理。

# java - Struts2 Tiles - 如何实现？

> ID：732885
> 
> 赞同：1
> 
> 时间：2009-04-09T05:09:43.650
> 
> 标签：java, struts2

我只是在试验 struts2 瓷砖。我不知道如何实现它。任何人都可以为使用 strus2 tile 的简单示例提供任何链接吗？这样做的基本要求是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T05:34:12.687

Tiles 项目本身有一个[针对 Tiles 新手用户的教程，](http://tiles.apache.org/tutorial/index.html)[这里](http://struts.apache.org/2.0.9/docs/tiles-plugin.html)解释了 Tiles 的 Struts 插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T18:57:57.417

**我知道我在很长一段时间后才回答，这可能对将来的某些人有所帮助，**

1.  让我给你 Maven 依赖

    ```
     <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts2-tiles-plugin</artifactId>
        <version>2.1.6</version>
    </dependency> 
    ```

    这是它将下载或您需要的 jar：commons.logging-api-1.1.jar,b)struts2-tiles-plugin-2.1.6.jarc)tiles-api-2.0.6.jard)tiles-core-2.0 .6.jare)tiles-jsp-2.0.6.jar

注意：如果您收到以下错误：java.lang.NoClassDefFoundError: org/slf4j/LoggerFactory at org.apache.tiles.web.startup.AbstractTilesListener。

添加此依赖项

```
<dependency>
            <groupId>org.apache.tiles</groupId>
            <artifactId>tiles-core</artifactId>
            <version>2.2.2</version>
        </dependency> 
```

或添加这个罐子：slf4j-api-1.5.8.jar jcl-over-slf4j-1.5.8.jar

在 Java 构建路径中完成所有操作之后，请点击此链接到[快乐学习](http://www.tutorialspoint.com/struts_2/struts_tiles.htm)

# java - 可以在沙盒中运行的 Mini-OSGi（如 AppEngine 或 WebStart）？

> ID：732886
> 
> 赞同：14
> 
> 时间：2009-04-09T05:09:51.683
> 
> 标签：java, google-app-engine, osgi, sandbox, java-web-start

我真的很喜欢 OSGi 实现的模块化包的概念。

我还喜欢“托管部署”服务，例如 Google AppEngine（用于 Web 应用程序）或 Java WebStart（用于客户端软件）。

这两个想法似乎在概念上很好地相互补充。

然而，OSGi 标准包含一些特性，使得 Felix 或 Equinox 等实现无法在 AppEngine 或 Webstart 等沙盒虚拟机之上运行。在这些环境中，无法直接访问文件系统，例如，这排除了用于存储持久包状态和本机库的 OSGi 包缓存。

现在，我对使用本机库或拥有持久包状态没有太大兴趣。是否有一些框架实现了 OSGi 的核心包和服务概念（理想情况下以兼容的方式，以便 OSGi 包可以按原样部署到其中），但可以在没有包缓存的情况下工作（以及沙箱中不可用的其他工具） ?

我正在寻找适用于 AppEngine 或 WebStart 的有限版本的 Felix。

当然，如果 WebStart 引擎和 Google AppEngine 只是提供开箱即用的 OSGi 框架服务，那也很棒……

**更新：** AppEngine 的另一个非常有限的方面是您无法启动新线程。这可以防止（除其他外）异步捆绑生命周期管理。WebStart 显然不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T07:00:05.433

EclipseSource 有一个修补版本的 osgi 引擎，它（有点）在 AppEngine 中工作，从博客下载项目 zip 文件：http: [//eclipsesource.com/blogs/2009/04/10/osgi-on-appengine/](http://eclipsesource.com/blogs/2009/04/10/osgi-on-appengine/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-18T10:44:12.090

你应该和 Chris Aniszczyk 谈谈。他使它与 Equinox 和 Knopflerfish 一起工作。看这里的截图：http: [//twitpic.com/300lk](http://twitpic.com/300lk)他正计划写博客，但我猜他现在很忙。这是他博客的链接：http: [//mea-bloga.blogspot.com/](http://mea-bloga.blogspot.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T07:51:52.050

我很确定它可以完成，[这个 Eclipse 帮助页面](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/java_web_start.htm)可能会让你开始。如果我理解正确，您的捆绑包必须经过签名，并且您的 jnlp 文件需要请求所有权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-12T00:03:21.480

[http://code.google.com/p/lemmon/](http://code.google.com/p/lemmon/)

但是，请检查 URLStreamHandler 问题的问题。

没有个人经验，只是一个可能对你有帮助的线索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T10:47:13.450

如果您唯一的问题来自捆绑缓存并且您不需要它，您可以通过在 Equinox 或 Felix 中将此属性设置为 null 来摆脱它？我很确定这个缓存不是必须让 Equinox 运行（不知道 Felix）

# java - Java (Swing) - 一次拖动两个窗口

> ID：732888
> 
> 赞同：0
> 
> 时间：2009-04-09T05:10:03.900
> 
> 标签：java, swing, drag

如何让一个窗口与另一个窗口一起移动？即，当拖动 JFrame 时，我希望 JDialog 跟随 JFrame。如果 JFrame 移动 (+5, +20)，则 JDialog 也需要移动。

我试过使用 ComponentListeners，但我只接收到块中的拖动事件，这会导致 JDialog 窗口在拖动主 JFrame 时跳动。我试过使用 MouseListeners，但我不知道如何在 JFrame 的实际帧上检测事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T06:51:15.310

尝试使用 ComponentListener.componentMoved 事件而不是监视 JFrame 上的拖动事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T09:16:51.763

AFAIK 在 AWT 中不能移动多个窗口。为了让动作同时被调用，我猜你希望`JFrame`装饰是 PL&F 渲染的。使用特定于 PL&F 的 hack 自己进行移动，几乎同时移动两个窗口。您可能仍然会遇到暴露一些窗口只是为了掩盖它们而导致性能下降的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-27T08:15:53.033

组件侦听器方法完美运行。我做了这样的事情：

```
Point p = this.getLocation();
p.x += this.getWidth() + 10;
this.getOwner().setLocation(p); 
```

其中“10”是当前窗口（一个 JDialog）与其右侧的所有者之间的空间。

# java - Apache Cocoon JAR 配置 - 我想使用 .class 文件！

> ID：732890
> 
> 赞同：0
> 
> 时间：2009-04-09T05:11:13.460
> 
> 标签：java, frameworks, jakarta-ee, jar, apache-cocoon

我正在使用 Apache Cocoon 框架，该框架是在数年前为我正在开发的 Web 应用程序设置的。

我不知道它是如何为每个人设置茧的，或者我的公司是否执行了一些“特殊”配置，但这就是发生的事情。

为了让 cocoon 使用任何类文件，必须将它们捆绑到一个 JAR 中并放在 tomcat(5)/common/lib 目录中。如果我们将它们放在其他地方，cocoon 根本不会看到类文件。

即使其他地方在 WEB-INF/classes 或 java 或其他地方。

有谁知道这个配置是如何在 cocoon 中设置的（我是 cocoon 新手）？我希望能够在 WEB-INF 中删除我的 .class 文件，然后我们就走了。

我知道我应该使用 IDE，但如果您看到应用程序结构，您就会明白我不是。我们正在朝着这个方向努力...

提前谢谢了...

米泽

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T09:27:49.630

我对 Cocoon 一无所知，但如果你可以将 jars 放在 tomcat/common/lib 中，那么类应该在 tomcat/common/classes 中工作（不是 WEB-INF/classes）。

将东西放入 tomcat/common（而不是 webapp 本身）有点奇怪，但您可能需要更改一些 Cocoon 设置（或安装 Cocoon 的位置）以避免这种情况。Cocoon 是 webapp 的一部分还是“tomcat common”？

# css - CSS 标准是否被破坏？

> ID：732891
> 
> 赞同：3
> 
> 时间：2009-04-09T05:11:36.360
> 
> 标签：css, web-standards, cross-browser

随着不同的浏览器选择以自己喜欢的方式呈现 CSS，拥有标准的意义何在？

像创建适用于所有浏览器的流畅 3 列布局这样简单的事情可能会让人感到沮丧。你如何处理这个问题或让跨浏览器兼容的开发不那么痛苦？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T05:28:51.733

与往常一样，这一切都是有原因的。

标准没有被打破（一个标准不能被打破），只是像IE这样的一些浏览器没有完全遵守它。

这主要是因为 IE 是在创建任何标准之前开发的，并且在那个时候它是最好的浏览器，几乎为零的竞争对手（我读到 netscape 是另一种选择，它比 IE 差得多）。

然后人们意识到需要一个标准，他们创建的标准显然不包括任何 IE 专有代码和功能。IE 被迫选择向后兼容它以前的版本，或者坚持这个新的“标准”，他们绝对统治了浏览器市场，所以选择是显而易见的。

随着新版本的推出，IE 试图越来越多地符合标准，他们说 IE8 成功通过了 ACID2 测试，因此标准的乌托邦正在（慢慢地）变为现实。

同时，检查这个站点 ->包含有用的跨浏览器信息[的 quirksmode 。](http://www.quirksmode.org/)也尝试在网上查看有关“IE框模型”的任何文章，并远离IE中的填充。如果您还使用 3rd 方 javascript 库（JQuery、Prototype、Dojo），您应该没问题（或者像我们任何人一样好）。

问候。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T05:45:25.843

拥有标准的一个主要目的是让我们远离另一场浏览器战争。您知道 Netscape 和 Microsoft 一直在为浏览器添加尽可能多的专有功能。与那时相比，今天的跨浏览器开发轻而易举……

制定标准的另一个很好的理由是您知道未来版本的浏览器将走向何方。遵循标准是对未来浏览器如何工作的最佳预测。

你可以在这个问题中找到很多跨浏览器提示：[如何在所有浏览器中实现一致的布局？](https://stackoverflow.com/questions/611704/how-can-i-achieve-a-consistent-layout-in-all-browsers/611713)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T06:12:15.123

**标准是新兴的，而不是预先定义的。**好吧，至少他们*应该*是。与我交谈过的许多开发人员似乎都觉得我对 Web 标准的看法有点异端，但请与我同在。

当您尝试在实施之前创建标准时，您会遇到几个问题：

*   在有用的实现出现之前有很长的延迟。没有人可以参考有效的实现，而且由于没有人使用该标准的任何特性（因为它还不存在），因此几乎没有动力去实际实现它。鸡和蛋类型的问题。
*   无法实际实施的标准的潜力。在有人真正尝试之前谁知道呢？HLA 标准就是一个很好的例子，以至于 DoD 不得不编写一份“解释”备忘录，试图通过掩盖实际标准中的一些错误来设定事实上的标准。
*   不满足任何实际需求的标准的潜力。人们真的想要这个吗？请参阅 XForms 上的示例，该示例已落入一个奇怪的服务器端领域。或者，我想不出我遇到的任何人发现 CSS“宽度不包括填充”框模型是直观的。
*   标准的实施者无法将他们的产品与竞争对手区分开来，导致顽固地希望以实际或鼓励的方式打破标准。请参阅 CORBA 中的示例。

我认为 W3C 近几年来很难学到这一点。一些对最终用户最明显的创新来自一场新的浏览器大战：例如 HTML5（多家供应商）、canvas（Apple）、XMLHttpRequest（Microsoft 的 Outlook Web Access 团队）、输入范围（Safari 的内置 RSS 阅读器） ，以及视频元素（Firefox）——它们来自专有级别，而不是来自标准塔。而这些新的“标准”是通过查看这些过去的单个实现（Firefox 在很大程度上复制了 Microsoft 的 XMLHttpRequest 等），而不是通过思考未来的一些睁大眼睛的智囊团而形成的。（ISAPI、Netscape 插件 API 和 SQL 都是自下而上标准的示例，在这些标准中，破坏性更改以锁步方式逐渐完成。）

标准应该是消除实现中基本差异的最小公分母，是一种适用于所有这些差异的 pidgin 语言，而不是关于语言或系统的 Robert Lowth 风格的规定性规则的枚举，因为那样你最终会得到规则并不总是有意义或应用不切实际的理想（例如尝试将基于拉丁文的语法规则应用于基于日耳曼语的语言，例如尝试将基于 XML 的语法规则应用于基于 SGML 的语言）。哦，这就是我们所拥有的。

在这一点上，CSS 标准中最大的缺陷可能是确实没有一种好的方法来指定页面是针对特定版本的标准编写的。我们可以为我们的 HTML 文档指定 DOCTYPE，为什么我不能指出一个文档是为 CSS 2.1 编写的？随着我们开始向 CSS 中添加越来越多影响页面实际内容的奇异功能，例如 CSS 的 :before 伪元素，这只会变得更加重要。该标准的未来版本有一天会出现可能破坏兼容性的错误，让文档作者要求某些行为而不是让浏览器试图找出意图会很好。

不过，在较轻的方面，既然 IE8 和 IE7 都出来了，事情确实不像 2005 年那样糟糕。带有条件注释的特定 IE6 样式表对于制作 CSS/ 真的有很长的路要走。基于标准的实施可行。另一个建议是[使用谷歌，以 3 列流畅布局为例，](http://www.alistapart.com/articles/holygrail)希望其他人为您完成大部分故障排除。

创建一个跨浏览器兼容的网站很困难，标准或没有标准。如果您接受不同浏览器呈现您的网站的方式会有一些差异，您可以让自己更轻松。无论如何不要害怕专有扩展（对于非 IE 用户来说，CSS3 圆角是可以的），但是当它们不存在时有一个后备（嗯，圆角不是使用该网站至关重要），并让您的用户选择他们希望如何使用您的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T09:02:40.737

这个问题的其他答案几乎涵盖了为什么 CSS 不是问题的来龙去脉，但至于我如何*处理*跨浏览器的困难，通常分为大约 4 个步骤：

1.  使用 firefox 设计网站，因为它有很多有用的扩展（最著名的是 Firebug，它告诉您正在应用哪些 CSS 规则，哪些被其他规则覆盖，等等）
2.  在 Safari 和 Opera 中快速检查网站，确保设计没有缺陷。通常它会正常工作 -*由于 CSS 网络标准*- 这些浏览器以几乎相同的方式呈现网页
3.  在ie7中查看设计并使用*+html css过滤器纠正错误
4.  在ie6中查看设计并使用*html css过滤器纠正错误

要做第 3 点和第 4 点，你会有这样的事情

```
.box {css rules}
*+html .box {css rules to override in ie7}
* html .box {css rules to override in ie6} 
```

在所有这一切结束时，您仍然会得到适用于主要浏览器的有效 css。

希望这可以帮助

*编辑 - 忘了添加 ietester 是一个很棒的软件，它允许您在 windows xp 或 vista 上安装多个版本的 ie：[http ://www.my-debugbar.com/wiki/IETester/HomePage](http://www.my-debugbar.com/wiki/IETester/HomePage)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T05:15:36.070

该标准有一些不足之处。实施起来也是一件相当困难的事情。问题在于实施而不是标准。

使用像 YUI 这样的东西，很多聪明的人已经做了很多努力，以使这些东西在各种浏览器上工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T05:53:18.633

标准是公开的，不符合标准的浏览器可以查看和学习。该标准很重要，因为它是您希望制作能够在所有页面上正确显示的网页的唯一方法。

还要记住，制定的标准绝不是为了过去，而只是为了未来。如果过去有些浏览器没有确认标准，并不意味着我们不应该有标准。

事实上，标准的诞生是因为浏览器都在做自己的事情，然后就需要标准。

如果您按照标准编码，浏览器将对其进行确认。

有希望的朋友！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-09T06:14:43.963

在我看来，您只是从 CSS 开始。因为即使浏览器不完全遵守 CSS 规范，也有很多安全的基础可以让您放心使用。现在这个安全的地方比大约十年前要大得多，当时为网络编码确实是一种皇家痛苦。新的浏览器版本越来越遵守规范，这正是标准很重要的原因。这是一种浏览器可能永远无法完全实现的理论理想，但即使是其中的 90-95% 在现实世界中也非常有用。

我也希望 IE 有更好的 CSS 实现，但是一旦你学会了一些奇怪的东西，你就可以编写大多数常见的布局而不会出现重大问题。大多数常见的布局也已经在网络上的各种 CSS 论坛上被讨论到死，而且总是有一些很好的解决方案可供您使用，这样您就不必自己编造了。

恕我直言，CSS 标准不是问题[至少在你的问题的意义上不是]，问题是浏览器市场和软件市场的现实。至于挫败感，在你获得一些经验后应该会消失。限制永远存在，但有足够的安全空间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-09T06:35:15.177

这似乎是不合逻辑的。仅仅因为一些浏览器蔑视网络标准并不意味着标准本身有问题。这有点像说安全带坏了是因为有些人选择不系，或者说酒驾法律没有意义是因为有些人不遵守。

如果绝对没有要遵循的标准，那么就不会有万维网时期。就像一个平等的社会是一个无法实现的理想，但为这个无法实现的理想而奋斗在过去的几十年里已经产生了巨大的社会进步，W3C 的建议和开放的网络标准也在网络的整个生命周期内产生了可衡量的进步。如果没有 CSS 等标准，Web 赖以发展的互操作性将不复存在。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-22T14:07:00.740

是的，CSS 已损坏 - 尽管从语义上讲您不能将其称为“损坏的标准”。但问题并不是真正的语义问题。

在 80 年代末和 90 年代初帮助定义 UNICODE 标准的经验是学习如何编写标准的良好培训。W3C 编写的标准文档让我翻白眼很多次，这些文档在定义中留下了巨大的漏洞，导致浏览器以不同的方式解释事物。CSS 标准有许多相互排斥的部分，即使是在 v3 中，这些部分已经出现，因为我们仍然必须保持与 pre-CSS1 的兼容性。

在关键方面，CSS 有三个令人费解的明显问题，任何计算机科学家都会告诉你，这些问题既设计不当又前后矛盾。

1.  盒子模型——即使在 CSS 3 接近的时候，仍然存在巨大的漏洞。
2.  “特异性”计算。实现“特异性”是为了修补 CSS 标准中的一个漏洞，然后再尝试支持不断冲突的规则。如果样式表是真正级联的，那么需要废弃“特异性”。直到它是 CSS 应该被称为 SWISMCCS (sometimes-when-it-suits-me-CSS)。当然，为了取消这个特性，标准中所有剩余的松散语言问题都需要修复——这实际上意味着它永远不会发生。
3.  类、选择器等的命名约定允许使用对动态处理有问题的字符。最明显的是允许在名称中使用“-”符号。如果你不明白为什么我会鼓励你阅读和字节码编译器和编译器语言解析。

所以答案是 CSS 标准没有被破坏，前提是合理的，但是标准文档（不是浏览器，文档）的实现表明，委员会的征服很少会让你得到完全符合目的的东西。我想这是因为 CSS 不是为受过训练的程序员创建的，它是为网页设计师创建的——一个奇怪的品种，他们不是真正的程序员，也不是真正的设计师。有些真正的 Web 开发人员与众不同，但在漂亮的图形上花费的时间更少。

恕我直言：CSS 坏了。另一方面，替代方案要糟糕得多。最好是我们所知道的魔鬼。在替换 HTML 上的作用。

# c++ - 在 VC++ 中使用 Borland C++ 代码

> ID：732893
> 
> 赞同：1
> 
> 时间：2009-04-09T05:12:13.753
> 
> 标签：c++, visual-c++, borland-c++

有没有办法在 VC++ 中访问 Borland 输出，用于方法调用和其他东西？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T05:36:30.997

我的信息可能（方式）过时了，但我之前必须确保 Borland 输出 COFF 格式的 OBJ 或 LIB 文件以与 VC 链接。

另一种选择是让 Borland 输出一个 DLL，然后从 VC++ 中使用它。名称修改和调用约定可能会导致痛苦。老实说，我已经有 5 年没有使用过 Borland 编译器了（尽管我在 15 年前曾在那里工作过），所以我不确定用于 Borland 编译的 DLL 的 LIB 是否能很好地与 VC++ 链接。

如果一切都失败了，使用 Borland 编译器编译 DLL，使用 Dumpbin 查找导出，然后使用 LoadLibrary 和 GetProcAddress 获取函数指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T05:26:57.353

创建一个静态库，然后将其链接到 VC++ 项目。小心调用约定。

# c++ - malloc() 和 glDrawPixels() 的访问冲突？

> ID：732894
> 
> 赞同：1
> 
> 时间：2009-04-09T05:12:16.220
> 
> 标签：c++, opengl, malloc, filestream

谁能看到这段代码有什么问题？

SIZE_BG 是 6MB，因为我正在尝试绘制一个大的位图图像 (3366x600)。我使用 malloc 来防止我的图像溢出堆栈。我在调用 glDrawPixels() 时遇到访问冲突错误。bgPtr 似乎指向正确的数据，因为我在调用 glDrawPixels 之前检查了前几个字节并且它们是正确的。

```
 bgPtr = (char*)malloc(SIZE_BG);
    fstream inFile(texFileName, ios::in | ios::binary);
    inFile.read(bgPtr, SIZE_BG);
    inFile.close();

//... other code

    glDrawPixels(3366, 600, GL_BGRA_EXT, GL_UNSIGNED_BYTE, bgPtr+54); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T05:19:15.407

> SIZE_BG 为 6MB

3366 × 600 大约是 192 万像素
BRGA 表示每像素 4 字节，
所以 3366 × 600 × 4 刚好超过 7.7MB

因此，您的缓冲区太小......`glDrawPixels()`将读到末尾到未分配的内存中。

# java - Java中的CRC计算

> ID：732896
> 
> 赞同：2
> 
> 时间：2009-04-09T05:13:05.267
> 
> 标签：java, serial-port, core, crc, xmodem

我正在使用 x-modem 协议和 133 字节数据包从串行端口读取文件。我在那读

```
 1 byte is SOH
      2 byte packet number
      3 byte nagative of packet number
next  128 bytes data
      2 bytes CRC sent from other side. 
```

我必须计算从另一端发送的 128 字节数据和 2 字节 crc 的 CRC，我必须将其设为单字节并且必须与我计算的 crc 比较。我怎样才能在java中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T05:34:57.147

尝试使用[Jacksum](https://jacksum.dev.java.net/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T05:28:55.290

Sun JDK 1.6 包含 sun.misc.CRC16，但有可能这不是您正在寻找的 CRC16，因为使用了几个不同的多项式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T05:56:22.853

这是我的 C 代码，移植到 Java 很简单——你可以以任何你喜欢的方式自由使用它。对 word 的引用是针对 16 位无符号值 - 您应该能够在 Java 中使用 char 代替。

自从我使用 16 位 CRC 以来已经太久了，所以我不记得是否存在基于播种的变化。我很确定我在 X-Modem 的 C 实现中使用了这段代码。

来源发布在[tech.dolhub.com](http://tech.dolhub.com/Code/CRC16)上。

# vb.net - 如何在 VB.NET 中为可选参数创建一个空字典

> ID：732899
> 
> 赞同：8
> 
> 时间：2009-04-09T05:14:46.477
> 
> 标签：vb.net, dictionary

基本上，我有一个具有可选字典参数的函数。由于它是可选的，它需要一个默认值，我想将它设置为一个空字典而不是 Nothing。我该怎么做？

在 Java 中，我会简单地这样做：

```
Collections.<K,V>emptyMap() 
```

如何在 VB.NET 中进行等效操作？

（我使用的是 .NET 3.5）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T05:27:49.240

.NET 中没有预装的空字典。要创建一个空字典，只需执行 New Dictionary()。

但是，我相信你不会被允许使用这个可选参数的默认值，因为它不能在编译时计算并放入 DefaultValueAttribute。相反，您将需要重载该函数：一个重载接受字典参数，一个不接受。后者只会像上面那样新建一个空字典，并调用第一个重载。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-09T12:36:15.137

无法将空字典指定为 VB.Net 中参数的默认值。VB.Net 仅支持可以在 MetaData 中编码的值，并且创建 Dictionary 的新实例不是其中之一。

您确实有一个选项是有一个默认为 Nothing 的可选值。在 Nothing 创建一个空字典的情况下。例如。

```
Public Sub SomeMethod(Optional ByVal map as Dictionary(Of Key,Value) = Nothing)
  if map Is Nothing Then
    map = new Dictionary(Of Key,Value)
  ENd If 
  ...
End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-10T09:44:46.837

根据目的，如果使用容量为 0 创建原本为空的 Dictionary 可能会更节省资源（即在内存方面）：

```
var empty = new Dictionary<string, string>(0); 
```

# latex - 忽略备份幻灯片中的页码

> ID：732902
> 
> 赞同：72
> 
> 时间：2009-04-09T05:16:25.147
> 
> 标签：latex, beamer

我正在使用乳胶中的投影仪文档类进行演示。我将有许多备用幻灯片供离线查看、参考等。Beamer 有一个功能，可以在每张幻灯片上以 {page#}/{total pages} 的形式显示演示的进度。如果 {total pages} 等于我的总页数（不包括备份幻灯片），我真的很高兴（我不想在第一页阻止我的观众！）。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-02-26T19:54:13.977

现在可以在所有“备份”幻灯片上使用以下选项来实现这一点：

```
\begin{frame}[noframenumbering]{My Title}
\end{frame} 
```

[资源](https://bitbucket.org/rivanvx/beamer/issue/6/stop-frame-numbering-after-a-slide)

这将导致最终数字（例如 25/25）显示在此类页面上。

一如既往，口味问题。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-11-15T16:36:37.623

这可以通过[appendixnumberbeamer](https://github.com/jlelong/appendixnumberbeamer)包来完成。只需添加`\usepackage{appendixnumberbeamer}`到序言并`\appendix`在第一张备用幻灯片之前使用。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2010-03-03T10:30:49.793

我已经定义了两个命令来做到这一点：

```
\newcommand{\beginbackup}{
   \newcounter{framenumbervorappendix}
   \setcounter{framenumbervorappendix}{\value{framenumber}}
}
\newcommand{\backupend}{
   \addtocounter{framenumbervorappendix}{-\value{framenumber}}
   \addtocounter{framenumber}{\value{framenumbervorappendix}} 
} 
```

然后，您可以使用备份幻灯片之前和之后调整幻灯片的数量`\beginbackup`。`\backupend`

对于我的投影仪模板，我还想添加

```
\setbeamertemplate{footline}{
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
    \usebeamerfont{author in head/foot}\insertshortauthor~~(\insertshortinstitute)
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
    \usebeamerfont{title in head/foot}\insertshorttitle
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,right]{date in head/foot}%
    \usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
    \insertframenumber{} \hspace*{2ex} % hier hat's sich geändert
  \end{beamercolorbox}}%
  \vskip0pt%
} 
```

在`\beginbackup`命令的定义中隐藏到备份幻灯片中的总页码，否则你会得到类似“24/18”的东西。

使用所有这些，您的幻灯片将在备份之前为所有幻灯片编号为“x/Y”，其中 Y 是第一张备份幻灯片之前的幻灯片总数，备份幻灯片将继续之前幻灯片的编号。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-09T09:41:52.060

要手动将总帧数固定为某个数字，例如 25，您可以添加以下命令

```
\renewcommand{\inserttotalframenumber}{25} 
```

在 \begin{document} 命令之后。

您还可以在备份幻灯片的开头添加 \appendix 命令，以便相应的部分/小节不会出现在目录/导航结构中。

应该可以调整上面的 renewcommand 以便它自动使用附录之前的最后一个帧号，但我不知道该怎么做。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-08-31T13:47:11.830

只需插入

```
\renewcommand{\inserttotalframenumber}{\pageref{lastslide}} 
```

在**\begin{document}**之后，并放置标记

```
\label{lastslide} 
```

在你的最后一张幻灯片上。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-04-12T03:29:18.800

您可以将所有备份幻灯片放在附录中并使用该`appendixnumberbeamer`包。

```
\documentclass[12pt]{beamer}
\usepackage{appendixnumberbeamer}
\begin{document}
\begin{frame}{Frames that counts}
\end{frame}
\appendix
\begin{frame}{Backup slides}
\end{frame}
\end{document} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-09T17:50:13.563

Fanfan，谢谢你的回答，你的回答引导我找到这个 sty 文件，它可以包含在一个 beamer 文档类中，它会自动计算附录之前的帧数，然后重新开始对附录幻灯片的单独计数，漂亮整洁的。

[http://www.ensta.fr/~lelong/Latex/appendixnumberbeamer.sty](http://www.ensta.fr/~lelong/Latex/appendixnumberbeamer.sty)

还要感谢 Jérôme LELONG 在线提供此功能。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-09-13T15:36:55.960

伟大的命令 \insertpresentationendpage 将解决您的问题。只需将 \appendix 放在备份幻灯片的开头即可。

```
\documentclass[t]{beamer}

\usepackage[absolute,overlay]{textpos}
\setbeamertemplate{navigation symbols}{}

\def\insertpresentationendframe{\inserttotalframenumber}
\makeatletter
\g@addto@macro{\appendix}{\immediate\write\@auxout{\string\@writefile{nav}{\noexpand\headcommand{\noexpand\def\noexpand\insertpresentationendframe{\the\c@framenumber}}}}}
\makeatother

\setbeamertemplate{footline}{%
    \begin{picture}(54,12.5)(0,0)
    \put(0.9,0.52){%
        \begin{minipage}[b][12.5mm][c]{112.5mm}
        \raggedleft
        \insertframenumber/\insertpresentationendframe
        \end{minipage}
    }
    \end{picture}
}

\begin{document}

    \begin{frame}
        slide in the main part
        \only<2>{blub}
    \end{frame}

    \appendix
    \section*{Backup}

    \begin{frame}
        \frametitle{backup}
        not counting in the total frame number
    \end{frame}

\end{document} 
```

![在此处输入图像描述](https://i.stack.imgur.com/pdJ0O.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-02-27T13:16:18.210

另一种可能性 - 最近添加到 beamer - 是使用`appendixframenumber`模板：

```
\documentclass[t]{beamer}

\setbeamertemplate{footline}{
  \hfill%
  \usebeamercolor[fg]{page number in head/foot}%
  \usebeamerfont{page number in head/foot}%
  \setbeamertemplate{page number in head/foot}[appendixframenumber]%
  \usebeamertemplate*{page number in head/foot}\kern1em\vskip2pt%
}

\begin{document}

    \begin{frame}
        slide in the main part
        \only<2>{blub}
    \end{frame}

    \appendix
    \section*{Backup}

    \begin{frame}
        \frametitle{backup}
        not counting in the total frame number
    \end{frame}

\end{document} 
```

# php - MySQL 存储过程：无法从 PHP 代码运行

> ID：732906
> 
> 赞同：3
> 
> 时间：2009-04-09T05:18:29.120
> 
> 标签：php, mysql, stored-procedures

我有以下存储过程来检查用户名的可用性

```
DELIMITER $$;

DROP PROCEDURE IF EXISTS tv_check_email$$

CREATE PROCEDURE tv_check_email (IN username varchar(50))
BEGIN
  select USER_ID from tv_user_master where EMAIL=username;
END$$

DELIMITER ;$$ 
```

当我从我的 MySQL 前端工具运行它时，它工作得很好：

```
call tv_check_email('shyju@techies.com') 
```

但是当尝试从 PHP 页面执行时，我收到一个错误，例如

```
"PROCEDURE mydatabase.tv_check_email can't return a result set in the given context" 
```

我确定我的 PHP 版本是 5.2.6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T05:23:57.627

您需要将结果绑定到 OUT 参数中。

请参阅有关[存储过程的 mysql 文档](http://dev.mysql.com/doc/refman/5.1/en/create-procedure.html)

```
mysql> delimiter //

mysql> CREATE PROCEDURE simpleproc (OUT param1 INT)
    -> BEGIN
    ->   SELECT COUNT(*) INTO param1 FROM t;
    -> END;
    -> //
Query OK, 0 rows affected (0.00 sec)

mysql> delimiter ;

mysql> CALL simpleproc(@a);
Query OK, 0 rows affected (0.00 sec)

mysql> SELECT @a;
+------+
| @a   |
+------+
| 3    | 
```

+------+

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T05:33:10.367

看起来如果您使用 mysqli PHP 库，您实际上可以检索您的结果集，而无需使用 OUT 变量和另一个查询来检索您的值。本文介绍了详细信息：

[http://amountaintop.com/php-5-and-mysql-5-stored-procedures-error-and-solution-qcodo](http://amountaintop.com/php-5-and-mysql-5-stored-procedures-error-and-solution-qcodo)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T15:36:12.870

科迪不是 100% 正确的。您可以绑定生成的返回列并从存储过程中返回选择数据。

```
$mysqli = new mysqli("localhost", "my_user", "my_password", "world");

$stmt = $mysqli->prepare("call tv_check_email(?)");
$stmt->bind_param('s', "shyju@techies.com");
$stmt->execute();

$stmt->bind_result($userid);

while ($stmt->fetch()) {
  printf("User ID: %d\n", $userid);
}

$stmt->close();
$mysqli->close(); 
```

# sql - 一个简单的 Sql 选择查询

> ID：732909
> 
> 赞同：1
> 
> 时间：2009-04-09T05:18:45.033
> 
> 标签：sql, sql-server, tsql

我知道我听起来很愚蠢，但我真的需要帮助。

我有一个包含列参与者的表格（假设是会议）。Participants dataType 是 varchar(Max)，它以逗号分隔的形式存储 Participant 的 ID，例如 1,2。

现在我的问题是我在我的存储过程中传递了一个名为 @ParticipantsID 的参数，并想做这样的事情：

```
Select Participants from Meeting where Participants in (@ParticipantsID) 
```

不幸的是，我在这里遗漏了一些重要的东西。

有人可以指出这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T05:27:19.317

我以前去过那里...我更改了数据库设计，使一条记录包含对另一张表的单个引用。如果你不能改变你的数据库结构并且你必须忍受这个，我在[CodeProject](http://www.codeproject.com/KB/database/splitparameterstring.aspx)上找到了这个解决方案。

**新功能**

```
IF EXISTS(SELECT * FROM sysobjects WHERE ID = OBJECT_ID(’UF_CSVToTable’))
 DROP FUNCTION UF_CSVToTable
GO

CREATE FUNCTION UF_CSVToTable
(
 @psCSString VARCHAR(8000)
)
RETURNS @otTemp TABLE(sID VARCHAR(20))
AS
BEGIN
 DECLARE @sTemp VARCHAR(10)

 WHILE LEN(@psCSString) > 0
 BEGIN
  SET @sTemp = LEFT(@psCSString, ISNULL(NULLIF(CHARINDEX(',', @psCSString) - 1, -1),
                    LEN(@psCSString)))
  SET @psCSString = SUBSTRING(@psCSString,ISNULL(NULLIF(CHARINDEX(',', @psCSString), 0),
                               LEN(@psCSString)) + 1, LEN(@psCSString))
  INSERT INTO @otTemp VALUES (@sTemp)
 END

RETURN
END
Go 
```

**新的 Sproc**

```
 SELECT *
 FROM
  TblJobs
 WHERE
  iCategoryID IN (SELECT * FROM UF_CSVToTable(@sCategoryID)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T05:49:12.463

您的表格未标准化。如果要查询单个参与者，应将它们拆分为自己的表，如下所示：

```
Meeting
    MeetingId primary key
    Other stuff
Persons
    PersonId primary key
    Other stuff
Participants
    MeetingId foreign key Meeting(MeetingId)
    PersonId  foreign key Persons(PersonId)
    primary key MeetingId,PersonId 
```

否则，你必须诉诸各种诡计（我称之为 SQL 体操）来找出你想要的东西。这种诡计永远不会很好地扩展 - 随着表的增长，您的查询变得非常缓慢。

使用适当规范化的数据库，查询可以保持快速进入数百万条记录（我使用 DB2/z，我们习惯于处理真正巨大的表）。

有时为了性能而恢复到第二范式（甚至是第一范式）是有正当理由的，但这应该是一个经过深思熟虑的决定（并且基于实际的性能数据）。所有数据库最初都应该从 3NF 开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T06:10:57.013

您通常不会以这种方式组织您的 SQL 数据库。您所描述的是具有一对多关系的两个实体（会议和参与者）。即一个会议可以有零个或多个参与者。要在 SQL 中对此进行建模，您将使用三个表：一个会议表、一个参与者表和一个 MeetingParticipant 表。MeetingParticipant 表保存会议和参与者之间的链接。所以，你可能会有这样的事情（请原谅任何 sql 语法错误）

```
create table Meeting
(
  MeetingID int,
  Name varchar(50),
  Location varchar(100)
)

create table Participant
(
  ParticipantID int,
  FirstName varchar(50),
  LastName varchar(50)
)

create table MeetingParticipant
(
  MeetingID int,
  ParticipantID int
) 
```

要填充这些表，您首先需要创建一些参与者：

```
insert into Participant(ParticipantID, FirstName, LastName) values(1, 'Tom', 'Jones')
insert into Participant(ParticipantID, FirstName, LastName) values(2, 'Dick', 'Smith')
insert into Participant(ParticipantID, FirstName, LastName) values(3, 'Harry', 'Windsor') 
```

并创建一个或两个会议插入会议（会议 ID，名称，位置）值（10，'SQL 培训'，'房间 1'）插入会议（会议 ID，名称，位置）值（11，'SQL 培训'，'房间 2')

现在将一些参与者添加到会议中

```
insert into MeetingParticipant(MeetingID, ParticipantID) values(10, 1)
insert into MeetingParticipant(MeetingID, ParticipantID) values(10, 2)
insert into MeetingParticipant(MeetingID, ParticipantID) values(11, 2)
insert into MeetingParticipant(MeetingID, ParticipantID) values(11, 3) 
```

现在您可以选择所有会议和每个会议的参与者

```
select m.MeetingID, p.ParticipantID, m.Location, p.FirstName, p.LastName
from Meeting m 
  join MeetingParticipant mp on m.MeetingID=mp.MeetingID
  join Participant p on mp.ParticipantID=p.ParticipantID 
```

以上应该产生

```
MeetingID ParticipantID Location FirstName LastName
10        1             Room 1   Tom       Jones
10        2             Room 1   Dick      Smith
11        2             Room 2   Dick      Smith
11        3             Room 2   Harry     Windsor 
```

如果你想找出“Dick Smith”参加的所有会议，你会写这样的东西

```
select m.MeetingID, m.Location
from Meeting m join MeetingParticipant mp on m.MeetingID=mp.ParticipantID
where
  mp.ParticipantID=2 
```

并得到

```
MeetingID Location
10        Room 1
11        Room 2 
```

我省略了诸如索引、主键和缺少的属性（例如会议日期）之类的重要内容，但没有所有的粘稠物会更清楚。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T05:22:58.113

如果我正确理解了您的问题，您将尝试传入以逗号分隔的参与者 ID 列表，并查看它是否在您的列表中。这个链接列出了几种方法来做这样的事情”

[ [http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm][1]](http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm][1])

codezy.blogspot.com

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T05:33:21.957

```
SELECT * FROM Meeting WHERE Participants LIKE '%,12,%' OR Participants LIKE '12,%' OR Participants LIKE '%,12' 
```

其中 12 是您要查找的 ID....

丑陋，多么令人讨厌的模型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-09T05:24:13.553

如果您将参与者 ID 存储在数据库中的逗号分隔列表（作为文本）中，则无法使用 SQL 轻松查询它（作为列表）。您将不得不求助于字符串操作。

您应该考虑更改架构以使用另一个表将会议映射到参与者：

```
create table meeting_participants (
   meeting_id integer not null , -- foreign key
   participant_id integer not null
); 
```

该表将在每个会议中包含多行（每个参与者一个）。然后，您可以在该表中查询单个参与者或参与者数量等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-09T05:26:31.317

如果参与者是单独的数据类型，则应将其存储为会议表的子表。例如

*   会议
    *   参与者 1
    *   参与者 2
    *   参与者 3

每个参与者都将持有会议 ID，因此您可以进行查询

SELECT * FROM 参与者 WHERE meeting_id = 1

但是，如果您必须存储一个逗号分隔的列表（出于某种外部原因），那么您可以进行字符串搜索以找到适当的记录。不过，这将是一种非常低效的查询方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-09T05:27:16.090

这不是存储您拥有的信息的最佳方式。

如果这是你所拥有的，那么你需要做一个包含（而不是一个 IN）。最好的答案是有另一个表将参与者链接到会议。

尝试 SELECT Meeting，Participants FROM Meeting CONTAINS(Participants, @ParticipantId)

# open-source - 是否有开源的“评价我的 X”网站工具？

> ID：732914
> 
> 赞同：2
> 
> 时间：2009-04-09T05:21:10.800
> 
> 标签：open-source, web, rating

不像“热与否”类型的网站，而是像“给我的大学教授打分”或“给我的水管工打分”等消费者/社区网站，人们可以在这些网站上评论和排名。

我只是想知道是否有某种 PHP/MySQL 包已经完成了一些基础知识。

很难知道要搜索什么。

哦，顺便说一句，是的，我知道要获得有关建立这样一个网站的法律建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T05:31:58.997

看看 Drupal - www.drupal.org - 特别是投票模块。

# c# - 何时覆盖 GetHashCode()？

> ID：732930
> 
> 赞同：18
> 
> 时间：2009-04-09T05:28:53.557
> 
> 标签：c#, .net

我们什么时候应该覆盖' **System '命名空间中'** **Object** '类提供的**GetHashCode** ()方法？

 ***** * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-09T05:30:58.983

当你覆盖`Equals`时，基本上。当您想提供与简单引用相等不同的相等概念时。

String 就是一个很好的例子——如果两个字符串表示相同的字符序列，则它们是相等的（在简单的 Equals 调用下）。哈希码反映了这一点，如果两个字符串相等，它们将具有相同的哈希码。（反过来不一定正确——两个不相等的字符串*可以*有相同的哈希码，但不太可能。）

（请注意，字符串在其他方面很棘手 - 基于文化和大小写的平等有很多不同的想法，但`String.Equals`只需查看构成字符串的 UTF-16 代码点，并以最简单的方式比较它们。 )

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T05:50:04.990

如果您的类型应该遵循值语义（比较内容）而不是引用语义（比较对象身份），您应该编写自己的实例 object.Equals() 覆盖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T05:31:26.173

如果您覆盖`Equals`，您也必须覆盖`GetHashCode`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T05:33:50.240

“GetHashCode 方法可以被派生类型覆盖。值类型必须覆盖此方法以提供适合该类型的哈希函数并在哈希表中提供有用的分布。为了获得最佳结果，哈希码必须基于基于实例字段或属性的值，而不是静态字段或属性。

用作 Hashtable 对象中的键的对象也必须覆盖 GetHashCode 方法，因为这些对象必须生成自己的哈希码。如果用作键的对象未提供有用的 GetHashCode 实现，则可以在构造 Hashtable 对象时指定哈希码提供程序。在 .NET Framework 2.0 版之前，哈希码提供程序基于 System.Collections..::.IHashCodeProvider 接口。从 2.0 版开始，哈希码提供程序基于 System.Collections..::.IEqualityComparer 接口。”

[http://msdn.microsoft.com/en-us/library/system.object.getashcode.aspx](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)

# similarity - 新闻条目（主题）相似度算法

> ID：732934
> 
> 赞同：3
> 
> 时间：2009-04-09T05:31:13.117
> 
> 标签：similarity, nearest-neighbor, collective-intelligence

我想确定两个新闻项目内容的相似性，类似于谷歌新闻，但在某种意义上不同，我希望能够确定基本主题是什么，然后确定哪些主题是相关的。

因此，如果一篇文章是关于萨达姆侯赛因的，那么该算法可能会推荐一些关于唐纳德拉姆斯菲尔德在伊拉克的商业交易的内容。

如果你能抛出 k-最近邻之类的关键词，并稍微解释一下它们为什么起作用（如果可以的话），我会做剩下的研究并调整算法。只是寻找一个开始的地方，因为我知道那里有人以前一定尝试过类似的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T06:04:00.353

第一个想法：

*   扔掉噪音词（和，你，是，那个，一些，......）。
*   计算所有其他单词并按数量排序。
*   对于两篇文章中的每个单词，根据数量的总和（或乘积或其他公式）添加分数。
*   分数代表相似度。

似乎一篇主要关于唐纳德·拉姆斯菲尔德的文章会相当多地使用这两个词，这就是我在文章中对它们进行加权的原因。

然而，可能有一篇文章曾多次提到沃伦巴菲特和比尔盖茨，还有一篇文章多次提到比尔盖茨和微软。那里的相关性将是最小的。

根据您的评论：

> 因此，如果一篇文章是关于萨达姆侯赛因的，那么该算法可能会推荐一些关于唐纳德拉姆斯菲尔德在伊拉克的商业交易的内容。

除非萨达姆的文章也提到伊拉克（或唐纳德），否则情况并非如此。

这就是我要开始的地方，我已经看到了理论中的潜在漏洞（如果经常提到比尔·盖茨的名字，一篇关于比尔·盖茨的文章将与一篇关于比尔·克林顿的文章密切匹配）。这很可能被所有其他词（微软代表比尔，希拉里代表另一个）照顾到。

在尝试引入单词邻近功能之前，我可能会对其进行测试运行，因为这会使它变得非常复杂（可能是不必要的）。

另一项可能的改进是保持“硬”关联（就像总是在包含奥萨马·本·拉登的文章中添加阿富汗一词）。但同样，这需要额外的维护，因为关于奥萨马的文章几乎肯定也会提到阿富汗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T05:40:31.377

目前我正在考虑这样的事情。

每个非噪声词都是一个维度。每篇文章都由一个向量表示，其中未出现的单词用零表示，而出现的单词的值等于它们出现的次数除以页面上的总单词数。然后我可以取这个空间中每个点之间的欧几里得距离来得到任意两篇文章的相似度。

下一步是确定文章的集群，然后确定每个集群的中心点。然后计算任何两个集群之间的欧几里得距离，它给出了主题的相似性。

呸，我想通过打字我解决了我自己的问题。当然，只是以非常高的水平，我相信当我真正开始时，我会发现问题......魔鬼总是在细节中。

但评论和改进仍然受到高度赞赏。

# sql - 如何将一组数据插入数据库表中？

> ID：732936
> 
> 赞同：1
> 
> 时间：2009-04-09T05:31:37.030
> 
> 标签：sql, database, database-design

我正在开发一个考勤管理程序，用于维护学生的缺勤记录。该软件的用户需要输入不同的日期，每月更新一次：例如，将输入学生在该特定月份缺勤的日期列表，然后我的程序必须将它们存储到数据库中，每个在相应表中作为新行添加的日期。

我在内部使用数组存储了日期，如何将它们传输到数据库中？我应该如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T05:44:12.490

你没有提到正在使用的数据库系统，所以我的回答是笼统的。执行此操作的常用方法是一个接一个地运行多个插入语句：

```
INSERT INTO Table1 (FirstColumn, SecondColumn)
VALUES ('a', 'b');
INSERT INTO Table1 (FirstColumn, SecondColumn)
VALUES ('c', 'd');
INSERT INTO Table1 (FirstColumn, SecondColumn)
VALUES ('e', 'f');
GO 
```

做到这一点的诀窍是使用 UNION ALL 语句：

```
INSERT INTO Table1 (FirstColumn, SecondColumn)
SELECT 'a', 'b'
UNION ALL
SELECT 'c', 'd'
UNION ALL
SELECT 'e', 'f'
GO 
```

2008 之前的 SQL Server 版本仅支持这些方法。但 SQL 2008 和 MySQL 3.22 及以上版本也支持 Row 构造方法：

```
INSERT INTO Table1 (FirstColumn, SecondColumn)
VALUES ('a', 'b'),
VALUES ('c', 'd'),
VALUES ('e', 'f')
GO 
```

现在，您可以使用上述任何一种方法来遍历您的数组并将各个出勤行添加到数据库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T05:47:18.567

```
foreach($arrayName 作为 $arrayValue) {

// 在这里运行你的查询！

}

```

例如：

```
$myArray = array('苹果','橙子','葡萄');

foreach($myArray as $arrayFruit) {
$query = "INSERT INTO `Fruits` (`FruitName`) VALUES ('" . $arrayFruit . "')";
mysql_query($query, $connection);
}

```

这有意义/符合您的想法吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T06:11:38.010

您想单独存储日期，以便您可以处理它们、查询它们等吗？还是您只想按原样存储数组？

如果您想单独存储日期，您可能需要创建一个表，其中包含学生的 FK、日期列和日期性质列，例如缺勤、迟到、...

然后，您确实会将单个日期存储到该表中。如果你必须，通过迭代，但如果你可以使用 Cerbrus 的解决方案之一！不建议在循环中使用 db-queries。

如果您只需要将该数组存储在某处，则可以对其进行序列化并将序列化的字符串存储在 text 或 varchar 列中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T05:35:00.157

遍历数组并为每个日期执行插入 SQL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T06:19:02.703

您使用什么语言和什么类型的数据库？这是一个网络应用程序吗？桌面应用程序？如果没有更多信息，我们无法为您提供帮助。

根据您的情况，上述任何解决方案都可以工作。或者，您甚至可以一次将所有考勤记录加载为 CSV 或 XML 文档。也许对您进行更多研究会帮助您提出更有用的问题？

# javascript - Ajax 和 JSF 1.1 使用带有“代理形式”的隐藏 iframe，您如何看待这种开发策略？

> ID：732943
> 
> 赞同：0
> 
> 时间：2009-04-09T05:33:56.667
> 
> 标签：javascript, forms, jsf, iframe

目前我正在使用 1.1 规范，所以我试图简化对我来说太复杂的事情：p，管理具有冲突导航规则的支持 bean，外部参数破坏规则等等......例如当我需要一个支持 bean由其他“视图”使用，我只是在其他支持 bean 中使用 FacesContext 来调用它，但通常它过于依赖 JSF 导航/初始化规则而无法真正使用，当然更简单的成为 FacesContext 更有用。

因此，只需要一点跨浏览器 Javascript（只是表单副本和“代理”表单上的读写），我在主用户​​页面内创建了一种代理表单（完全与 JSF 导航规则无关，但使用 JSF标签库）。Ajax 为我提供了用户交互的灵活性，但数据始终由 JSF 管理。

实际上，我要求所有“虚构”用户操作到一个隐藏的“iframe”，它根据 JSF 规则构建所有需要的表单，然后 javascript 简单地克隆其表单输出并将其放入用户视图级别（用于显示/隐藏真实命令按钮的 CSS并且变得漂亮），用户玩耍，当他单击提交时，脚本将所有“代理”表单值复制到调用表单的真实提交的“iframe”内的真实JSF表单中，它返回的内容显然取决于你的选择。

现在 JSF 真的很开心 :-p

**我真正的兴趣是知道在不采用 ajax4jsf 等中间层的情况下使用纯 Ajax 和 JSF 1.1 的替代策略是什么，这些都是不错的选择，但“插件”比规范太多。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T09:18:18.017

我的建议是你看看那里的 Javascript 框架，例如 Prototype 或 JQuery。它们具有允许您序列化表单数据并使用 Ajax 将其发送到服务器的功能。然后您可以得到答案，并将其显示在网页上。看看 Prototype 的 Form.serialize 和 Ajax.Updater。我认为这是一种比使用“代理”iframe 和表单更清洁的做事方式。

假设您有一个表单，并且您想将其发送到服务器并用来自服务器的 HTML 片段替换该表单。这是使用 Prototype 的一种方法：

```
new Ajax.Updater('divThatWrapsTheFormTag', 'someUrl', {
  parameters: Form.serialize('formId')
}); 
```

# css - CSS 行为怪异

> ID：732949
> 
> 赞同：0
> 
> 时间：2009-04-09T05:37:01.573
> 
> 标签：css

我有以下CSS代码：

```
.tag {
    display: inline;
    font-size: 10px;
    padding: 5px;
    color: #FFF;
    background-color: #444;
}

.tag:hover {
    font-size: 10px;
    padding: 5px;
    color: #FFF;
    background-color: #666;
} 
```

除了背景颜色，还有一个显示：内联，没有区别，对吗？那么当 .tag div 出现时，它有白色文本但没有背景颜色。它还具有 12pt 字体大小且没有填充。但是，当我将鼠标悬停在它上面时，它看起来就像它应该的样子。谁能告诉我为什么这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T05:45:11.100

如果您的 css 文件/scriptlet 中只有这两个类，则没有什么不同。但如果你有超过 2 个并且与其他类混合使用，情况会有所不同。

您的 .tag 可能会被其他类覆盖，我将使用 firefox + firebug 对其进行调试。这个工具会告诉你哪个 CSS 类/属性是 voeridden

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T06:10:58.747

使用 !important

# python - 在 Django 中保存 ModelForm 后获取主键

> ID：732952
> 
> 赞同：46
> 
> 时间：2009-04-09T05:38:47.810
> 
> 标签：python, django, django-models, django-forms

保存ModelForm后如何获取主键？验证并保存表单后，我想将用户重定向到需要联系人主键的contact_details 视图。

```
def contact_create(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            form.save()
            return HttpResponseRedirect(reverse(contact_details, args=(form.pk,)))
    else:
        form = ContactForm() 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-04-09T05:50:11.463

[ModelForm](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#modelform)的[保存](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-save-method)方法返回保存的对象。

试试这个：

```
def contact_create(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            new_contact = form.save()
            return HttpResponseRedirect(reverse(contact_details, args=(new_contact.pk,)))
    else:
        form = ContactForm() 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-06-06T04:58:11.470

如果你设置了 form.save(commit=False) 因为你想修改数据并且你有一个多对多的关系，那么答案会有点不同：

```
def contact_create(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            new_contact = form.save(commit=False)
            new_contact.data1 = "gets modified"
            new_contact.save()
            form.save_m2m()
            return HttpResponseRedirect(reverse(contact_details, args=(new_contact.pk,)))
    else:
        form = ContactFrom() 
```

[https://docs.djangoproject.com/en/1.3/topics/forms/modelforms/#the-save-method](https://docs.djangoproject.com/en/1.3/topics/forms/modelforms/#the-save-method)

# sql-server - 在 SQL Server 2005 中存储 SSIS 包需要哪些权限？

> ID：732955
> 
> 赞同：4
> 
> 时间：2009-04-09T05:39:45.560
> 
> 标签：sql-server, sql-server-2005, ssis

我想以数据库用户的身份创建一个 SSIS 包。

我也想将它存储到 SQL Server，而不是文件系统中。DB 用户仅对特定数据库具有**db_owner权限。**

将 SSIS 保存到 SQL Server 需要哪些最低权限？

我已经分配了以下内容：

```
grant execute on dbo.sp_ssis_checkexists to test
grant execute on dbo.sp_ssis_putpackage to test 
```

请提供反馈，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T09:53:04.007

请将用户添加到`msdb`数据库中的以下角色：

*   db_dtsadmin
*   db_dtsltduser
*   db_dtsoperator

希望它有效。

有关 SQL Server 2005 中集成服务角色的更多信息，请访问：http: [//msdn.microsoft.com/en-us/library/ms141053%28v=sql.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms141053%28v=sql.90%29.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T10:38:59.987

如果有人被标题误导了这个问题（它说 Sql Server 2008 而标签提到 sql-server-2005），`msdb`SQL Server 2008 中数据库的权限是：

```
db_ssisadmin
db_ssisltduser
db_ssisoperator 
```

# actionscript-3 - AS3 从班级访问舞台上的动态文本字段

> ID：732960
> 
> 赞同：2
> 
> 时间：2009-04-09T05:43:39.483
> 
> 标签：actionscript-3, textfield

我在舞台上有这个动态文本字段，我想从我的 xmlloader 类中访问它，这样它就可以显示我的 xml 文件中的文本。我只是想不出办法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T07:06:22.450

我找到了答案：

```
MovieClip(root).thetextfieldonstage.text = "yep"; 
```

可以从类中调用文本字段。

# shoes - Ruby Shoes GUI ToolKit 中的 While 循环

> ID：732967
> 
> 赞同：0
> 
> 时间：2009-04-09T05:46:17.463
> 
> 标签：shoes

我现在只使用鞋子几天，所以也许我错过了一些东西。我给儿子写了一个小程序来帮助他学习乘法表。当他答对十个时，他就完成了。我似乎无法使用 SHOES 正确获取 while 循环。有人请给我看一个while语句。当我尝试时；它要么消除我的流程和堆栈语句，要么消除 Shoe 崩溃。

提前致谢。山姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T14:20:42.887

我不知道你是如何使用`while`循环的。很可能您正在尝试通过`while`循环每次迭代重新创建堆栈，这是一个坏主意。立即想到的两个解决方案是处理按钮单击的逻辑并连续跟踪正确的数字，如下所示：

```
Shoes.app do
  num_correct = 0
  first_num = 1 + rand(10)
  second_num = 1 + rand(10)
  answer = first_num * second_num

  stack do
    @info = para 'Hi, Timmy!  This program will test your ',
           'multiplication tables.  When you get 10 ',
           'correct, you get to stop, and you get your ',
           'pet hamster back!'
    @question = para "What is #{first_num} x #{second_num}?"
    @response = edit_line :width => 100
    btn = button 'OK' do
      if @response.text == ''
        alert('You need to put an answer in the box, Timmy.')
      elsif @response.text.to_i == answer
        num_correct += 1
        if num_correct == 10
          @info.text = "Good job!  That's #{num_correct} in a row!"
          alert('You did it, Timmy!  You can have your ' \
                  'hamster back... for now.')
          exit
        else
          @info.text = "Good job!  That's #{num_correct} in a row!"
          first_num = 1 + rand(10)
          second_num = 1 + rand(10)
          answer = first_num * second_num
          @question.text = "What is #{first_num} x #{second_num}?"
          @response.text = ''
        end
      else
        num_correct = 0
        @info.text = "Wrong, Timmy.  The answer is #{answer}."
        first_num = 1 + rand(10)
        second_num = 1 + rand(10)
        answer = first_num * second_num
        @question.text = "What is #{first_num} x #{second_num}?"
        @response.text = ''
      end
    end
  end
end 
```

或者，我认为更有趣的解决方案是使用`url`and `visit`：

```
class MyTest < Shoes

  url '/', :index
  url '/correct/(\d+)', :correct
  url '/wrong/(\d+)', :wrong
  url '/question', :question
  url '/question/(\d+)', :question
  url '/done', :done

  def index
    stack do
      para 'Hi, Timmy!  This program will test your ' \
             'multiplication tables.  When you get 10 ' \
             'correct, you get to stop, and you get your ' \
             'pet hamster back!'
      button 'OK' do 
        visit '/question'
      end
    end
  end

  def question(num_correct = 0)
    num_correct = num_correct.to_i
    first_num = 1 + rand(10)
    second_num = 1 + rand(10)
    answer = first_num * second_num
    stack do
      para "What is #{first_num} x #{second_num}?"
      flow do
        response = edit_line :width => 100
        button 'Answer' do
          if response.text.to_i == answer
            num_correct += 1
            if num_correct == 10
              visit '/done'
            else
              visit "/correct/#{num_correct}"
            end
          else
            visit "/wrong/#{answer}"
          end
        end
      end
    end
  end

  def correct(num_correct)
    stack do
      para "Good job!  That's #{num_correct} in a row!"
      button "Next Question" do
        visit "/question/#{num_correct}"
      end
    end
  end

  def wrong(answer)
    @num_correct = 0
    stack do
      para "Wrong!  The correct answer is #{answer}."
      button "Next Question" do
        visit '/question'
      end
    end
  end

  def done
    stack do
      para 'You did it, Timmy!  You can have your ' \
      'hamster back... for now.'
      button 'OK' do
        exit
      end
    end
  end
end

Shoes.app 
```

# php - PHP：empty() 的替代方法是什么，其中字符串“0”不被视为空？

> ID：732979
> 
> 赞同：38
> 
> 时间：2009-04-09T05:53:11.877
> 
> 标签：php

> **可能重复：**
> [修复 PHP 空函数](https://stackoverflow.com/questions/410002/fixing-the-php-empty-function)

在 PHP 中，empty() 是一个很好的快捷方式，因为它允许您同时检查变量是否已定义且不为空。

当您不希望将“0”（作为字符串）视为空，但仍希望将 false、null、0 和“”视为空时，您会使用什么？

也就是说，我只是想知道您是否有自己的快捷方式：

```
if (isset($myvariable) && $myvariable != "") ;// do something
if (isset($othervar  ) && $othervar   != "") ;// do something
if (isset($anothervar) && $anothervar != "") ;// do something
// and so on, and so on 
```

我认为我不能为此定义一个辅助函数，因为该变量可能是未定义的（因此不能作为参数传递）。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-09T07:26:47.487

这应该做你想要的：

```
function notempty($var) {
    return ($var==="0"||$var);
} 
```

编辑：我猜表格只能在预览中使用，而不是在实际的答案提交中。因此，请参阅[PHP 类型比较表](http://us2.php.net/manual/en/types.comparisons.php)以获取更多信息。

```
notempty("") : 假
notempty（空）：假
notempty（未定义）：假
notempty（数组（））：假
notempty（假）：假
notempty（真）：真
notempty(1) : 真
notempty(0) : 假
notempty(-1) : 真
notempty("1") : 真
notempty("0") : 真
notempty("php") : 真

```

基本上，除了 "0" 之外的所有值， notempty() 与 !empty() 相同，它返回**true**。

* * *

编辑：如果您使用**error_reporting(E_ALL)**，您将无法按值将未定义的变量传递给自定义函数。正如 mercator 指出的那样，您应该*始终*使用**E_ALL**以符合最佳实践。[他提供的此链接](http://www.smashingmagazine.com/2009/03/24/10-useful-php-tips-revisited/)（评论 #11）讨论了为什么出于性能和可维护性/调试原因不应该使用任何形式的错误抑制。

**请参阅 orlandu63 的答案，了解如何[通过引用](http://us.php.net/manual/en/functions.arguments.php)将参数传递给自定义函数。**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-11T14:18:00.763

```
function isempty(&$var) {
    return empty($var) || $var === '0';
} 
```

关键是`&`操作符，它通过[引用](http://us.php.net/references)传递变量，如果它不存在则创建它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-09T11:20:54.833

```
if(isset($var) && ($var === '0' || !empty($var)))
{
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-09T06:27:54.493

```
if ((isset($var) && $var === "0") || !empty($var))
{

}

```

这样，如果变量设置为“0”，或者变量设置为 AND not = null ("0",null,false)，您将输入 if 结构

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-12T07:04:52.647

答案是不可能缩短我已经拥有的。

禁止通知或警告不是我想做的事情，所以我总是需要在检查值之前检查是否为 empty() 或 isset()，并且您无法检查某些内容是否为 empty() 或 isset()一个函数内。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T03:17:06.803

```
function Void($var)
{
    if (empty($var) === true)
    {
        if (($var === 0) || ($var === '0'))
        {
            return false;
        }

        return true;
    }

    return false;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-23T19:37:40.880

如果 ($var != null)

# jquery - Django中的JQuery自动完成功能不起作用

> ID：732982
> 
> 赞同：0
> 
> 时间：2009-04-09T05:54:26.243
> 
> 标签：jquery, django

我从[这里](http://lethain.com/entry/2007/dec/01/using-jquery-django-autocomplete-fields/)得到的一些示例中有以下代码，但它不适用于我的 django 应用程序。

在我的模板上，我有这个功能：

$(function(){ setAutoComplete("tags", "tagResults", "/taglookup/?query="); });

在我的网址上，我有以下行

```
(r'^taglookup/$', 'twine.twineapp.views.tag_lookup'), 
```

我的观点是这样的：

```
def tag_lookup(request):
    # Default return list
    results = []
    if request.method == "GET":
        if request.GET.has_key(u'query'):
            value = request.GET[u'query']
            # Ignore queries shorter than length 3
            if len(value) > 2:
                #model_results = Book.objects.filter(name__icontains=value)
                TaggedItem = Tag.objects.get_by_model(Question, Tag.objects.filter(name__in=[value]))
                results = [ x.name for x in TaggedItem]
    json = simplejson.dumps(results)
    return HttpResponse(json, mimetype='application/json') 
```

当我尝试在模板的“标签”字段中输入任何内容时，萤火虫给了我以下错误；

**获取[http://127.0.0.1:8000/taglookup/?query=test](http://127.0.0.1:8000/taglookup/?query=test) 404 NOT FOUND JQuery-1.3.2.js（第 3633 行）**

有什么想法在哪里玩吗？

加思

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T12:34:07.013

从您在 firebug 中看到的 404 错误看来，请求正在按照您告诉自动完成调用的 url 发生。我会仔细检查您的 urls.py 文件，以确保正则表达式行前面没有隐式前缀。意思是，该 urls 行是在基本项目目录中还是在主 urls.py 文件中包含的应用程序目录中？

如果包含它，您的基本 urls.py 文件中可能会有这样的一行：

`(r'^appname/', include('projectname.appname.urls')),`

那么你的jQuery函数应该是：

`$(function(){ setAutoComplete("tags", "tagResults", "/appname/taglookup/?query="); });`

您还可以通过在浏览器中键入该地址来验证 url 模式是否有效，这样您就可以确定问题出在 url 还是 jQuery 上。

# java - 在 Java 中混合声音？

> ID：732987
> 
> 赞同：4
> 
> 时间：2009-04-09T05:59:13.330
> 
> 标签：java, audio, clip

如何在任何给定时间多次播放相同的声音而同时播放许多其他声音？现在我有一个“剪辑”播放，但它不会与自身重叠。（我听到一颗子弹开火，声音结束然后再次播放）。我正在编写一个带有快速子弹发射系统的游戏，但我无法让声音正常工作。当您每秒在屏幕上生成 20 多个子弹时，每半秒只听到一发子弹听起来并不“正确”。

有什么帮助吗？指针？:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T07:16:11.710

这似乎回答了你的问题：

[http://my.safaribooksonline.com/9781598634761/ch09lev1sec3](http://my.safaribooksonline.com/9781598634761/ch09lev1sec3)

引用：

“换句话说，单个 Clip 对象不能与自身混合，只能与其他声音混合。如果您使用较短的声音效果，此过程效果很好，但如果您的声音片段长度为一秒或更长，则听起来很奇怪。[.. .] 如果要重复混合单个剪辑，有两个重要的选项（还有一个不太可能的选项）： 1）将声音文件加载到多个剪辑对象（例如数组）中，然后按顺序播放每个剪辑。每当您需要播放此特定声音时，只需遍历数组并找到已播放完毕的剪辑，然后再次开始播放。”

因此，原则上 Java 确实会进行混合，而不是在单个剪辑中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-20T05:34:10.817

一次播放 20 个 Bullit 剪辑可能会占用大量 CPU。可能没问题。我曾经制作了一个风铃，它可以播放 7 个重叠的铃声（每个大约 3 或 4 秒长），然后将其设置为每 5 秒播放大约 100 个铃声。但该程序没有做任何其他事情。

使用 Clips，要做到这一点，您需要制作多个副本，并且所有音频数据都将坐在那里，占用 RAM。如果他们真的很矮，那不是这样的牺牲。但是对于快速射击，大多数游戏使用的解决方案是切断声音并重新启动。您不必将声音播放到最后。

```
myClip.stop();
myClip.setFramePosition(0);
myClip.start(); 
```

随着每一个子弹开始。这是最常做的事情。与重叠剪辑解决方案相比，它使用的 CPU 和 RAM 少得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T09:00:04.580

[AudioClip](http://java.sun.com/javase/6/docs/api/java/applet/AudioClip.html)可能是您正在寻找的 - 我在播放短 .wav 音效的游戏中使用它，它并不完美，但在大多数情况下都能正常工作。

# javascript - 修改 iBox javascript 文件中的不透明度

> ID：732988
> 
> 赞同：0
> 
> 时间：2009-04-09T05:59:33.140
> 
> 标签：javascript, css, opacity

我希望使用[iBox](http://www.ibegin.com/labs/ibox/)插件，但我不知道如何：
1) 禁用图像调整大小。
2）修改背景的不透明度。

我试图修改 ibox.js 文件，我认为不透明度从第 330 行开始。
很多谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T12:44:35.210

> 1）禁用图像调整大小。

我没有测试它，但尝试将 can_resize:false 选项添加到 ibox.js 的第 755 行

_pub.html(img, {width: this.width, height: this.height, 约束: true, **can_resize: false** })

> 2）修改背景的不透明度。

你的意思是黑色覆盖？IMO，您必须修改 bg.png 文件（请参阅图像文件夹）

# javascript - 使用 jQuery 创建和删除信息

> ID：732989
> 
> 赞同：0
> 
> 时间：2009-04-09T06:00:13.827
> 
> 标签：javascript, jquery

我正在开发一个标签系统，我希望用户能够在页面上添加和删除标签。对于添加的每一个，我都显示一个带有标签的小 div 和一个 x 来删除标签。我有添加功能，但我不知道如何去做，所以我可以删除它们。我还有一个隐藏的输入，它应该保存所有值，以便在提交信息时我可以使用它。

这是我的尝试不起作用：

```
function tagsremove(tag) {
    $('#hiddentags').val().replace('/'+tag+'\,\s/', '');
    $("#tagdiv-"+tag.replace(" ","_")).fadeOut('normal', function(){
        $(this).remove();
    });

}
$(document).ready(function(){
    $('#tagbutton').click(function(){
        var tags = $('#tagsbox').val().split(", ");
        for (var i in tags) {
                    $('#hiddentags').val($('#hiddentags').val() + tags[i] +", ");
            $('#curtags').append("<div class='tag'>" + tags[i] + " <a href='#' id='#tagdiv-"+tags[i].replace(" ", "_")+"' onclick='tagsremove(\""+tags[i]+"\");' >x</a></div>");
        }
        $('#tagsbox').val('');
    });
}); 
```

继承人与它一起使用的html：

```
<div class='statbox'>
    <form method='post' action='post.php' id='writeform'>
        <p class='subtitle'>Title</p>
        <input type='text' name='title' id='titlebox' /><br />
        <p class='subtitle'>Body</p>
        <textarea id='postbox' name='body' rows='10'></textarea><br />
        <p class='subtitle'>Tags</p>
        <input type='text' id='tagsbox' /><input type='button' id='tagbutton' value='Add' />
        <p class='subsubtitle'>Seperate by commas (eg. "programming, work, job")</p>
        <div class='subsubtitle' id='curtags'>Current Tags:</div>
        <input type='hidden' value='' name='tags' id='hiddentags' />
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T06:22:47.297

让你的每个标签 div 都有一个相关的 ID。例如，“play pen balls”标签，您的 ID 可能是“tagdiv-play_pen_balls”。现在你可以做

```
function removeTag(tag) {
    $("#tagdiv-"+tag.replace(" ","_")).remove();
} 
```

删除可见的 div。

（我不确定这是否是你所要求的，不过......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T06:08:48.313

而不是使用 .val('') 你应该使用 .html('');

[http://docs.jquery.com/Manipulation](http://docs.jquery.com/Manipulation)

# security - 如何在 ASP 页面中显示会话 ID（无漏洞）

> ID：732991
> 
> 赞同：1
> 
> 时间：2009-04-09T06:01:27.910
> 
> 标签：security, session, asp-classic

我在asp页面中显示会话ID。但它很脆弱。如何通过编码或其他方式显示会话 ID。

我无法避免在网页屏幕上显示会话 ID

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T06:37:19.087

首先，为什么你认为它除了“肩部冲浪”之外还很脆弱？

其次，如果您想使用另一个cookie并自己创建一个随机会话ID，请将其用作第二次检查（显然不显示它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T06:08:53.820

您可以为每个用户生成一个新的 guid，并将该 guid 粘贴在会话中，然后向他们显示，而不是原始 ID。或者，您可以显示会话 ID 的 SHA 哈希。

# asp.net - 将 jQuery 引入 ASP.NET（或任何其他外部 JavaScript）的正确方法

> ID：732992
> 
> 赞同：6
> 
> 时间：2009-04-09T06:01:56.380
> 
> 标签：asp.net, javascript, jquery

下面这三个代码示例有什么区别？一个比其他的更好，为什么？

```
1.Page.ClientScript.RegisterClientScriptInclude(typeof(demo), "jQuery", 
                                                ResolveUrl("~/js/jquery.js"));

2\. 
<asp:ScriptManager runat="server">
    <Scripts>
      <asp:ScriptReference Path="~/jquery-1.2.6.min.js" />
      <asp:ScriptReference Path="~/jquery.blockUI.js" />
     </Scripts>
  </asp:ScriptManager>

3\. <script type="text/javascript" src="/js/jquery.latest.js"></script> 
```

我已经看到人们在他们的示例中使用 jQuery，并且每个人都以不同的方式将 jQuery 引入 ASP.NET。什么是最好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T06:09:47.000

**第一个是**

> 在服务器端用于添加客户端脚本

**第二个是**

> 用于管理 asp.net [AJAX 脚本](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx)。如果 jQuery 检测到 ASP.Net AJAX ScriptManager，它将使用它来注册脚本而不是 Page.ClientScript

**第三个是**

> 注册 jquery 插件的简单方法

我通常更喜欢最后一个而不是第二个，但无论如何我从不使用 Ajax，第一个只有在完成回发到服务器后想要添加脚本时才需要

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T06:13:02.500

这取决于您要达到的目标。第一个在渲染期间从服务器端将脚本标记添加到您的页面。这对于添加动态生成的 JavaScript 和类似的东西很有用。

只有在使用 ASP.NET AJAX 来管理 JavaScript 时，第二个选项才有意义，因为它在页面上注册了大量其他 JavaScript。

因此，如果您想保持一切干净并且只打算使用 jQuery，请选择选项 3。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T23:33:56.697

除非您正在构建用户控件，否则我真的不喜欢选项 1。

如果我要在该页面上使用 Microsoft AJAX 库，我只使用 ScriptManager。只是把它放在那里添加了很多额外的东西你的页面必须下载（有时用 Firebug 检查一下）。如果资源文件中有 JavaScript，ScriptManager 也可以为您缩小它。但是，如果您更改了 JavaScript，则需要重新编译。

我通常使用选项 3。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T06:32:14.343

如果我希望为某个用户控件包含 js，但不是在每个页面上都包含 js，方法 #2 效果很好。脚本管理器还确保我没有重复的脚本引用。如果您希望在每个页面上都包含 js（因为 jquery 几乎总是如此），那么方法＃3 是最干净的。

# maven-2 - 使用 maven 运行 junits 和 cobertura

> ID：732995
> 
> 赞同：23
> 
> 时间：2009-04-09T06:04:29.743
> 
> 标签：maven-2, ant, junit, cobertura

在我们的项目中，我们使用 maven 运行 junits 和 cobertura。我面临的问题是，

1.  junit 测试用例运行两次，一次在 jar 创建过程之前，然后再一次用于生成 cobertura 覆盖率报告。当与 ant 一起运行 cobertura 和 junits 时，我们只运行一次 junit，因为 cobertura 与 junits 一起运行。有没有办法用 maven 配置上述情况。我知道我们可以使用“maven.test.skip”属性来跳过junits。但是当我这样做时，我看不到 junit xml & html 文件报告。
2.  另外，在 Maven 中，如何配置 junit 以批量或并行运行？

谢谢你！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-15T12:16:27.530

虽然我再也找不到确切的页面，但我最近阅读了一篇关于为什么两次运行测试被认为是一个好主意的讨论。引用的关键问题围绕着 Cobertura 字节码更改对测试准确性的影响。在某些情况下，代码执行的时间可能很重要，字节码更改可能会导致在 JUnit 中失败的测试在仅在 Cobertura 中运行时通过，反之亦然。因此，建议允许测试执行两次。引用的大多数示例都围绕多线程行为，但我想可能还有其他情况是字节码更改可能会导致您的测试出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T18:56:59.610

尝试添加 cobertura 作为编译范围参考。并发布你的 pom.xml 的相关部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-30T22:06:20.427

发生这种情况是因为报告执行需要测试执行才能创建报告。如果站点插件上有一个没有`@requiresDependencyResolution test` 注释的“仅站点”目标，它可能会绑定到项目的`prepare-package`阶段，并且您的报告将在没有运行两次测试的情况下生成。

不幸的是，目前似乎没有这样的目标（请参阅我[关于](https://stackoverflow.com/questions/1184862/combined-site-deploy-goal-for-maven)该主题的问题）。有关解决方法的详细信息，请参阅我对问题的回答。

# php - mysql 不能从控制面板启动

> ID：732996
> 
> 赞同：1
> 
> 时间：2009-04-09T06:05:09.320
> 
> 标签：php, xampp

嗨，我最近安装了 xampp 1.7.0，但是当我尝试从控制面板启动 mysql 时出现错误：

忙....错误：Mysql 服务未启动 [-1]

和

当我从 mysql_start.bat 开始时，它开始了！

为什么会发生这种情况，为什么 mysql 没有从 xampp 控制面板启动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T07:07:31.887

不确定您的安装，但通常有控制面板未首先初始化的运行所需的相关服务。

安装 FoxServ（类似于 Xamp） 我遇到了同样的问题。我的解决方法是查看 Windows -> Adminsitrative Tools 中的应用程序历史记录以查看具体错误是什么，我发现它需要启动一个不需要的子服务

希望有帮助。

# c++ - C++ 中的 jstack 等价物

> ID：732998
> 
> 赞同：1
> 
> 时间：2009-04-09T06:07:11.140
> 
> 标签：c++, gcc, solaris, jstack

jstack 在检查实时运行进程的堆栈跟踪方面对我很有帮助。

C++ 中是否有任何工具可以执行此任务。我正在使用 Solaris/GCC 编译器。

实际上 GDB/DBX 可以做到这一点。但我的过程有时会挂起，很少见。所以当它挂起时，我想知道它哪里出错了。只需实时跟踪即可。

谢谢 DL 库马尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T19:27:40.160

承租人......在solaris上，不能使用gdb......我认为你正在寻找的是'pstack'在我的solaris 8系统上它位于

```
/usr/bin/pstack
usage:  pstack [-F] { pid | core } ... 
```

和

```
man pstack 
```

显示了一个很好的相关工具列表，您可能会发现在诊断中非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T07:20:47.330

我相信 GDB 也有这种能力，请参考 gdb 文档

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T08:48:12.970

考虑到您在 Solaris 上运行，并且您不想使用 GDB，DTrace 似乎是显而易见的剩余解决方案。

但是您是否出于错误的原因而解雇了 GDB？您可以将 GDB 附加到现有的挂起进程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T09:37:56.003

几年前，我在 DDJ 上写了一篇关于在 C/C++ 中使用 Windows 和 Unix/Linux 转储堆栈的文章。也许它可以帮助你：

见[http://www.ddj.com/architect/185300443](http://www.ddj.com/architect/185300443)*******