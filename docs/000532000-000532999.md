# StackOverflow 问答 000532000-000532999

# visual-studio - 如何将 MSBuild 配置为仅在发布版本上执行某些任务？

> ID：532003
> 
> 赞同：43
> 
> 时间：2009-02-10T11:51:26.417
> 
> 标签：visual-studio, msbuild

我[刚刚了解](https://stackoverflow.com/questions/527948/fxcop-on-build-visual-studio-2008-professional)了如何在构建中包含 FxCop。但它很慢，我希望它只在发布版本上完成。有什么办法可以配置吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-10T12:03:44.327

检查配置条件。

```
<Target Name="AfterBuild" Condition="'$(Configuration)' == 'Release' ">

  <FxCop TargetAssemblies="@(OutputAssemblies)"
       RuleLibraries="@(FxCopRuleAssemblies)" 
       DependencyDirectories="$(MSBuildCommunityTasksPath)"
       FailOnError="False"
       ApplyOutXsl="True"
       OutputXslFileName="C:\Program Files\Microsoft FxCop 1.32\Xml\FxCopReport.xsl"
       DirectOutputToConsole="true"/>
</Target> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T11:55:11.947

尚未对此进行测试，但我认为它应该类似于以下内容：

```
<Target Name="MyTarget" Condition="'$(FlavorToBuild)'=='Release'">
   ...do release specific stuff...
</Target> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:55:32.430

在 .msbuild 脚本中添加条件。仅当 Configuration 为“Release”而不是 f.ex 时才执行 FxCop 任务，当它为“Debug”时

# c# - 如何对通用列表 Asc 或 Desc 进行排序？

> ID：532015
> 
> 赞同：21
> 
> 时间：2009-02-10T11:55:56.280
> 
> 标签：c#, .net, asp.net, generics, sorting

我有一个 MyImageClass 类型的通用集合，MyImageClass 有一个布尔属性“IsProfile”。我想对这个 IsProfile == true 位于列表开头的通用列表进行排序。

我试过这个。

```
rptBigImages.DataSource = estate.Images.OrderBy(est=>est.IsProfile).ToList(); 
```

使用上面的代码，图像位于最后一个 IsProfile 属性为真。但我希望它位于第一个索引处。我需要一些*Asc 或 Desc*。然后我做了这个。

```
rptBigImages.DataSource = estate.Images.OrderBy(est=>est.IsProfile).Reverse.ToList(); 
```

有没有更简单的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-10T11:57:57.460

怎么样：

```
estate.Images.OrderByDescending(est => est.IsProfile).ToList() 
```

这将按 IsProfile 属性降序排列图像，然后从结果中创建一个新列表。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-02-10T11:58:52.203

您可以使用 .OrderByDescending(...) - 但请注意，使用 LINQ 方法您正在创建一个新的有序列表，而不是对现有列表进行排序。

如果您有一个`List<T>`并且想要重新排序**现有**列表，那么您可以使用`Sort()`- 并且您可以通过添加一些扩展方法使其更容易：

```
static void Sort<TSource, TValue>(this List<TSource> source,
        Func<TSource, TValue> selector) {
    var comparer = Comparer<TValue>.Default;
    source.Sort((x,y)=>comparer.Compare(selector(x),selector(y)));
}
static void SortDescending<TSource, TValue>(this List<TSource> source,
        Func<TSource, TValue> selector) {
    var comparer = Comparer<TValue>.Default;
    source.Sort((x,y)=>comparer.Compare(selector(y),selector(x)));
} 
```

然后你可以使用`list.Sort(x=>x.SomeProperty)`and `list.SortDescending(x=>x.SomeProperty)`。

# math - 如何检查 m n 大小的向量是否线性无关？

> ID：532029
> 
> 赞同：21
> 
> 时间：2009-02-10T12:00:36.473
> 
> 标签：math, vector, matrix, linear-algebra

**免责声明**
这不是一个严格的编程问题，但大多数程序员迟早都要处理数学（尤其是代数），所以我认为这个答案将来可能对其他人有用。

**现在**
我要检查的问题是 m 维 n 的向量是否是线性独立的。如果 m == n，您可以使用向量构建一个矩阵并检查行列式是否为 != 0。但是如果 m < n 怎么办？

有什么提示吗？

* * *

另请参阅[此视频讲座](http://academicearth.org/lectures/independence-basis-and-dimension)。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-10T12:07:37.000

构造一个向量矩阵（每个向量一行），并对该矩阵执行[高斯消元法。](http://en.wikipedia.org/wiki/Gaussian_elimination)如果任何矩阵行抵消，它们就不是线性独立的。

平凡的情况是当 m > n 时，在这种情况下，它们不能是线性独立的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T12:08:36.720

构造一个矩阵`M`，其行是向量并确定 的秩`M`。如果 的秩`M`小于`m`（向量的数量），则存在线性相关性。在确定您的排名的算法中，`M`您可以在获得一行零后立即停止该过程，但是运行该算法以完成具有提供向量生成集的维度的额外财富。哦，确定等级的算法`M`仅仅是高斯消除。

注意数值不稳定性。请参阅数字食谱中第二章开头的警告。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T12:10:52.627

如果`m<n`，您将不得不对它们进行一些操作（有多种可能性：高斯消除、正交化等，几乎任何可用于求解方程的变换都可以）并检查结果（例如，高斯消除 => 零行或列，正交化 => 零向量，SVD => 零奇异数）

但是，请注意，这个问题对于程序员来说是一个不好的问题，而这个问题对于程序来说是一个不好的问题。这是因为每个线性相关的`n<m`向量集在附近都有一组不同的线性独立向量（例如，问题在数值上不稳定）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-02T12:42:06.067

这些天我一直在研究这个问题。

以前，我发现了一些关于高斯或高斯-乔丹消除的算法，但大多数这些算法只适用于方阵，而不适用于一般矩阵。

要申请通用矩阵，最好的答案之一可能是： [http ://rosettacode.org/wiki/Reduced_row_echelon_form#MATLAB](http://rosettacode.org/wiki/Reduced_row_echelon_form#MATLAB)

您可以找到各种语言的伪代码和源代码。至于我，我将 Python 源代码转换为 C++，导致上面链接中提供的 C++ 代码有点复杂，不适合在我的模拟中实现。

希望对你有帮助，祝你好运^^

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T18:11:36.457

如果计算能力不是问题，可能最好的方法是找到矩阵的奇异值。基本上，您需要找到特征值`M'*M`并查看最大与最小的比率。如果比率不是很大，则向量是独立的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-06T17:52:35.370

当放入大小为 mxn 的矩阵 M 中时，检查 m 行向量是否线性无关的另一种方法是计算

```
det(M * M^T) 
```

即mxm方阵的行列式。当且仅当 M 具有一些相关行时，它将为零。然而，高斯消除通常应该更快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-11T08:04:14.210

对不起，伙计，我的错...

* * *

上面链接中提供的源代码结果是不正确的，至少我测试过的python代码和我转换过的C++代码并没有一直生成正确的答案。（而对于上面链接中的示例，结果是正确的:)--）

要测试 python 代码，只需`mtx` 将

```
[30,10,20,0],[60,20,40,0] 
```

返回的结果如下：

```
[1,0,0,0],[0,1,2,0] 
```

不过，我有办法摆脱这种情况。正好这次我把函数的matalb源代码改成`rref` 了C++。您可以运行matlab并使用`type rref`命令获取`rref`.

请注意，如果您正在处理一些非常大或非常小的值，请确保使用`long double`c++ 中的数据类型。否则，结果会被截断，与matlab结果不一致。

我一直在 ns2 中进行大型模拟，所有观察到的结果都是合理的。希望这会帮助你和任何其他遇到问题的人......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-11T13:31:08.740

一种非常简单的方法（不是计算效率最高）是简单地删除随机行，直到`m=n`然后应用行列式技巧。

*   `m < n`：删除行（使向量更短）直到矩阵为正方形，然后
*   `m = n`：检查行列式是否为0（如你所说）
*   `m < n`（向量的数量大于它们的长度）：它们是线性相关的（总是）。

简而言之，原因是方程组的任何解`m x n`也是方程`n x n`组的解（您正在尝试求解`Av=0`）。要获得更好的解释，请参阅[Wikipedia](http://en.wikipedia.org/w/index.php?title=Linear_independence&oldid=547551364#Alternative_method_using_determinants)，它比我能更好地解释它。

# oracle - 在多个列中创建主键是否会为所有列生成索引？

> ID：532037
> 
> 赞同：9
> 
> 时间：2009-02-10T12:04:21.953
> 
> 标签：oracle, indexing, primary-key, multiple-columns

如果我在 Oracle 的多个列中设置主键，是否还需要在需要时创建索引？

我相信，当您在**一**列上设置主键时，您会为其编制索引；多列 PK 是否相同？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T12:12:34.133

不，不会为各个字段创建索引。

如果你有一个复合键 FieldA、FieldB、FieldC 和你

```
select * from MyTable where FieldA = :a 
```

或者

```
select * from MyTable where FieldA = :a and FieldB = :b 
```

然后它将使用这个索引（因为它们是键中的前两个字段）

如果你有

```
select * from MyTable where FieldB = :b and FieldC = :c 
```

在您使用部分索引而不是完整索引的情况下，通过索引跳过扫描、完整索引扫描或快速完整索引扫描，索引的使用效率会降低。

（感谢大卫奥尔德里奇的更正）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T12:17:59.613

如果您在 (A, B, C) 列上创建主键，那么 Oracle 默认会在 (A, B. C) 上创建唯一索引。您可以告诉 Oracle 使用不同的（不一定是唯一的）现有索引，如下所示：

```
alter table mytable add constraint mytable_pk 
primary key (a, b, c)
using index mytable_index; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T12:09:47.323

您将在多个列上获得一个索引，这与在每一列上都有一个索引不同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T13:17:01.000

`composite unique index`主键意味着在主键列上创建一个。

您可以使用一个特殊的访问路径来调用`INDEX SKIP SCAN`这个索引来使用不包括第一个索引列的谓词：

```
SQL> CREATE TABLE t_multiple (mul_first INTEGER NOT NULL, mul_second INTEGER NOT NULL, mul_data VARCHAR2(200))
  2  /
Table created

SQL> ALTER TABLE t_multiple ADD CONSTRAINT pk_mul_first_second PRIMARY KEY (mul_first, mul_second)
  2  /
Table altered

SELECT  /*+ INDEX_SS (m pk_mul_first_second) */
    *
FROM    t_multiple m
WHERE   mul_second = :test 

SELECT STATEMENT, GOAL = ALL_ROWS                            
 TABLE ACCESS BY INDEX ROWID       SCOTT    T_MULTIPLE
  INDEX SKIP SCAN                  SCOTT    PK_MUL_FIRST_SECOND 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T12:10:23.453

主键只是一个（唯一）索引，可能包含多个列

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T12:44:05.713

对于 B，如果列 a 仅具有低基数（例如 a 只有 2 个值），则将使用选择索引。一般来说，如果您想象列没有单独索引，而是列的索引连接（这并不完全正确，但它适用于第一个近似值），您通常可以猜到这个答案。所以它不是 a, b 索引它更像是 a||b 索引。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T23:02:36.350

您可能需要根据您的主键结构在列上设置单独的索引。

复合主键和索引将按以下方式创建索引。假设我有 A、B、C 列，并且 ia 在（A、B、C）上创建主键。这将导致索引

*   （甲、乙、丙）
*   （甲，乙）
*   （一种）

Oracle 实际上在任何最左边的列分组上创建一个索引。所以...如果您只想在 B 列上建立索引，则必须为其创建一个索引以及主键。

PS我知道MySQL表现出这种最左边的行为，我认为SQL Server也是最左边的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-11T19:02:45.353

在 Oracle 中，这不是一个准确的说法。它仅在 (A,B,C) 上创建 1 个索引。不创建 (A,B) 和 (A) 索引。

# excel - 如何在excel中找到用户的时区偏移量

> ID：532038
> 
> 赞同：0
> 
> 时间：2009-02-10T12:04:34.590
> 
> 标签：excel, vba

我正在使用 excel 宏来生成 RSS 提要。用户的时区偏移量需要放在 RSS 提要的字段中。如何在 excel 宏函数中以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T14:05:49.790

将以下代码粘贴到 Excel 中的模块中：

```
Private Declare Function GetTimeZoneInformationAny Lib "kernel32" Alias _
  "GetTimeZoneInformation" (buffer As Any) As Long

Function GetTimeZone() As Single
  Dim retval As Long
  Dim buffer(0 To 42) As Long

  Const TIME_ZONE_ID_INVALID = &HFFFFFFFF
  Const TIME_ZONE_ID_UNKNOWN = 0
  Const TIME_ZONE_ID_STANDARD = 1
  Const TIME_ZONE_ID_DAYLIGHT = 2

  retval = GetTimeZoneInformationAny(buffer(0))

  Select Case retval
    Case TIME_ZONE_ID_INVALID
      GetTimeZone = 0
    Case TIME_ZONE_ID_STANDARD, TIME_ZONE_ID_UNKNOWN
      GetTimeZone = (buffer(0) + buffer(21)) / -60
    Case TIME_ZONE_ID_DAYLIGHT
      GetTimeZone = (buffer(0) + buffer(42)) / -60
    Case Else
      GetTimeZone = 0
  End Select

End Function 
```

（来自[http://binaryworld.net/Main/CodeDetail.aspx?CodeId=152](http://binaryworld.net/Main/CodeDetail.aspx?CodeId=152)）

# c# - C# + Excel 2003 - 透明自定义图标

> ID：532043
> 
> 赞同：1
> 
> 时间：2009-02-10T12:06:57.377
> 
> 标签：c#, icons, excel-2003, transparent

我使用以下类从我的 C# 代码生成 Excel 2003 中自定义工具栏的图标：

```
public class ImageConverter : System.Windows.Forms.AxHost
{
    public ImageConverter() : base("59EE46BA-677D-4d20-BF10-8D8067CB8B33")
    {
    }

    public static stdole.IPictureDisp ImageToIpicture(System.Drawing.Image image)
    {            
        return (stdole.IPictureDisp)ImageConverter.GetIPictureDispFromPicture(image);
    }
} 
```

我的问题是如何制作透明图标？我所有的图标都是透明的 gif，但在 Excel 2003 中，它们具有纯蓝色背景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T13:14:37.117

您需要创建一个遮罩图像并将其分配给 commandbarbutton.mask。有关详细信息，请参阅[http://support.microsoft.com/kb/286460/](http://support.microsoft.com/kb/286460/)

# php - NetBeans PHP 和 XDebug - 跳转到调用堆栈上的方法？

> ID：532048
> 
> 赞同：1
> 
> 时间：2009-02-10T12:08:49.870
> 
> 标签：php, debugging, netbeans, xdebug

我在使用 XDebug 通过 NetBeans 调试 PHP 项目时遇到了麻烦，并且希望那里的人以前可能遇到过这个问题。

对于请求的 php 文件，调试工作正常 - 因此，如果我转到远程服务器上的 index.php，我可以在 NetBeans 的 index.php 中的任何位置放置一个断点，并且代码停在那里，我可以单步执行。

问题是，所有其他文件都像这样出现在调用堆栈上：`"file:///home/user/site_html/library/class.requestprocessor.php"`因为这是远程服务器上文件的路径，NetBeans 无法解析名称，因此我无法单步执行它的代码。它使调试实际上毫无用处！请求的 php 文件（例如 index.php）显示为“index.php”，它只是 NetBeans 无法正确解析的所有其他文件。

我可以使用 NetBeans 或 XDebug 中的某些设置来解决此问题吗？我已经尽力查看了 NetBeans 中的所有项目设置和选项，还查看了 XDebug 扩展的所有配置选项，但无济于事。肯定有人以前遇到过这个问题吗？你是怎么解决的？如果您能告诉我，我将不胜感激。

* * *

如果没有其他办法，Eclipse PDT和XDebug的用户在远程服务器上调试时会不会出现这个问题？如果没有，我会进行切换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-13T21:03:58.273

此问题似乎已在 NetBeans 6.7 中得到修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T01:59:12.593

好的，似乎没有人会回答这个问题，所以我将发布我的研究结果。

由于我无法找到让 NetBeans 按我的意愿成功调试的方法，我尝试使用带有 VS.php 扩展的 Eclipse PDT 和 Visual Studio 2008 来解决我的问题。Eclipse PDT 设置起来很麻烦，而且我对您无法在其远程服务器资源管理器中指定用于 FTP 服务器的端口的方式不满意。我发现 VS.php 做了我想做的一切，它会自动上传代码，并且有完美的调试，而且很容易设置。唯一的问题是，它看起来很丑，我找不到自定义颜色的方法。但是，我将选择功能而不是时尚，因此我决定使用 VS.php 作为我的最终解决方案。老实说，这是一种耻辱，NetBeans 真的很棒，我不能没有一个工作调试器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-01T15:18:28.120

我有同样的问题。我正在运行 Netbeans 6.8。您必须右键单击您的项目，转到项目属性/运行配置/高级并设置路径映射。将服务器上的文件夹映射到本地文件夹，以便 Netbeans 在遇到这些方法时知道要在本地打开哪些文件。

# algorithm - 在源代码中查找模式

> ID：532050
> 
> 赞同：2
> 
> 时间：2009-02-10T12:09:38.680
> 
> 标签：algorithm, pattern-recognition

如果我想学习一般的模式识别，从什么地方开始（推荐一本书）是一个好地方？

另外，是否有人对如何应用这些算法来查找程序中的抽象模式有任何经验/知识？（重复的代码，做同样事情但方式略有不同的代码块等）

谢谢

编辑：我不介意数学密集型书籍。事实上，那将是一件好事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T12:23:04.407

如果您在数学上相当自信，那么 Chris Bishop 的“模式识别和机器学习”或“用于模式识别的神经网络”的任何一本书都非常适合学习模式识别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T12:17:48.350

如果您可以访问编译期间生成的解析树，它会有所帮助。通过这种方式，您可以查找相似的树片段，忽略比您正在查看的更深的节点，这样您可以选择例如将两个子表达式相乘的节点，忽略子表达式的内容表达式。您可以将相同的逻辑应用于节点集合，例如，您想找到两个子表达式的乘法，其中这两个子表达式是更多子表达式的加法。您首先查找乘法，然后检查乘法下方的两个节点是否是加法，忽略任何更深层次的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T12:13:31.170

我建议查看一些开源项目的代码（例如[FindBugs](http://findbugs.sourceforge.net/)或[SIM](http://www.cs.vu.nl/~dick/sim.html)），它们可以完成您所说的那种事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T12:17:07.883

如果您使用一种受支持的语言，IntelliJ idea 有一个非常智能的[结构搜索和替换](http://www.jetbrains.com/idea/documentation/ssr.html)，可以满足您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T12:17:36.383

其他有趣的项目是[PMD](http://pmd.sourceforge.net/)和[Eclipse](http://www.eclipse.org/)。

Eclipse 对任何项目中的所有源代码都使用 AST（抽象语法树）。然后，工具可以注册某些类型的 AST（如 Java 源代码）并获得预处理视图，在其中可以添加其他信息（如文档链接、错误标记等）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T12:31:48.987

您可以查看的另一个项目是[Duplo](http://duplo.giants.ch/) - 它是一个开源/GPL 项目，因此您可以通过从[SourceForge](http://sourceforge.net/project/showfiles.php?group_id=139115&package_id=152602)获取代码来研究他们的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T13:01:08.060

这是特定于 .Net 和 Visual Studio 的，但它会在您的项目中找到重复的代码。它确实报告了我发现的一些误报，但它可能是一个很好的起点。

[克隆侦探](http://www.codeplex.com/CloneDetectiveVS)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-23T22:47:36.530

一种模式是通过复制和粘贴方法克隆的代码。请参阅[CloneDR](http://www.semanticdesigns.com/Products/CloneDR)了解一种工具，该工具通过比较相关语言的抽象语法树，自动找到此类代码，尽管布局发生变化，甚至克隆体发生变化。

CloneDR 适用于多种语言：C、C++、C#、Java、JavaScript、PHP、COBOL、Python，... 该网站显示了多种编程语言的克隆检测报告。

# sql-server-2008 - 创建上传文件的“版本”的最佳方法是什么？

> ID：532064
> 
> 赞同：1
> 
> 时间：2009-02-10T12:13:17.457
> 
> 标签：sql-server-2008, versioning

在我的应用程序中，人们将上传简历，他们可以更新我存储的简历。简历使用数据库中的文件流。那工作正常。但现在我想跟踪上传简历的版本以查找最新和以前的简历。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T12:17:28.383

如果我是你，我会做的就是在表中添加一个 versionNumber 列，当“更新”他们的简历时，我只会在数据库中写入一个新条目。然后，您应该有一个名为 ResumeActive 的列或类似于 Bit 字段的内容。只需将最近的简历标记为活动的，并将所有其他的标记为非活动的。

如果他们希望将他们的简历回滚到以前的版本，只需将其标记为活动并将所有其他标记为非活动。我希望这会有所帮助，并且我正确理解了您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T12:37:43.200

您还可以使用了解文档版本的存储引擎，这不仅可以跟踪版本，还可以在它们之间快速切换并查看差异。如果您使用 Windows 作为您的解决方案，您可以调查[Sharepoint](http://www.microsoft.com/sharepoint/prodinfo/what.mspx) ($) 或[Sharepoint Portal Services](http://office.microsoft.com/en-us/sharepointtechnology/default.aspx)（免费）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T13:02:39.833

使用普通或二进制差异，并在每次更改时，将差异结果与版本号一起存储在数据库中。因此，如果用户想要恢复，请将所有差异应用到该版本。与存储整个文件的每个版本相比，这将占用更少的空间。

# javascript - 如何比较依赖于语言环境的浮点数？

> ID：532068
> 
> 赞同：4
> 
> 时间：2009-02-10T12:14:46.377
> 
> 标签：javascript, vbscript

我需要将在 Web 表单中输入的浮点值与范围进行比较。问题是客户端计算机可能有各种区域设置，这意味着用户可以使用“.”中的任何一个。或“，”将整数部分与小数部分分开。

有没有简单的方法来做到这一点？因为它是用于 Intranet 并且他们只允许使用 IE，所以 VBScript 很好，即使我更喜欢使用 JavaScript。

编辑：让我澄清一下：

我不能依赖系统区域设置，因为例如，我们的许多法国客户使用具有英语区域设置的计算机，即使他们仍然使用逗号来填写 Web 表单中的数据。
所以我需要一种方法来执行跨多个区域设置“字符串到双精度”转换的检查。
我知道 raise 条件是“带有 3 个十进制数字的数字怎么样”，但在我们的环境中，这种答案永远不会发生，如果发生这种情况，由于乘以 a ，它将被威胁为超出范围的错误千，所以这对我们来说不是一个真正的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T12:19:59.437

在 Javascript 中使用`parseFloat`文本值来获取数字。同样在 VBScript`CDbl`上使用文本值。两者都应符合为用户强制执行的当前区域设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T12:59:45.800

此代码应该可以工作：

```
 function toFloat(localFloatStr)
    var x = localFloatStr.split(/,|\./),
        x2 = x[x.length-1],
        x3 = x.join('').replace(new RegExp(x2+'$'),'.'+x2);
    return parseFloat(x3);
    //  x2 is for clarity, could be omitted:
    //=>x.join('').replace(new RegExp(x[x.length-1]+'$'),'.'+x[x.length-1])
  } 

  alert(toFloat('1,223,455.223')); //=> 1223455.223
  alert(toFloat('1.223.455,223')); //=> 1223455.223
  // your numbers ;~)
  alert(toFloat('3.123,56')); //=> 3123.56
  alert(toFloat('3,123.56')); //=> 3123.56 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T14:22:40.610

我们所做的是尝试使用用户的文化进行解析，如果这不起作用，则使用不变的文化对其进行解析。

我不知道如何在 javascript 或 vbscript 中做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T18:40:15.330

我使用了 KooiInc 的答案，但做了一些改动，因为它没有考虑到某些情况。

```
function toFloat(strNum) {
    var full = strNum.split(/[.,]/);

    if (full.length == 1) return parseFloat(strNum);

    var back = full[full.length - 1];
    var result = full.join('').replace(new RegExp(back + '$'), '.' + back);

    return parseFloat(result);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-10T14:32:59.820

禁止使用任何千位分隔符。

给用户一个例子：“Reals 应该是这样的：`3123.56`或`3123,56`”。然后只需更改`,`并`.`解析它。

你总是可以告诉用户他做错了这样的消息：

```
"I don't understand what you mean by "**,**,**".  
Please format numbers like "3123.56." 
```

# c# - 调试代码安全 .net 框架以使用 caspol.exe

> ID：532070
> 
> 赞同：2
> 
> 时间：2009-02-10T12:15:28.217
> 
> 标签：c#, .net, security

我们有一个分发给各种客户的应用程序。有时它安装在网络共享上。通常我们可以使用 caspol.exe 授予该应用程序访问权限并授予 LocalIntranet 区域 FullTrust。有时，由于某些网络设置，客户管理员无法授予该应用程序访问权限。当我们启动 exe 时，它​​会打开一小段时间，然后出现在客户端任务管理器中，然后默默地消失……现在的问题是有一个工具可以为我提供一些调试或跟踪详细信息。是否有调试此类安全问题的工具...我假设这发生在我的任何代码执行之前...而且我在客户端和服务器上都看不到事件跟踪中的任何内容...

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T12:24:44.667

我可以推荐一下——也许看看 ClickOnce——一个 clickOnce 应用程序可以托管在网络共享上，但具有更好的安全部署因素。您只需运行`.application`而不是`.exe`（VS2005 和 VS2008 拥有发布 ClickOnce 应用程序所需的所有工具）。

另外 - 在最近的一个服务包中（可能是 3.5 SP1），我相信*映射*的共享会获得更多的特权 - 所以`\\foo\bar\my.exe`仍然会出错，但是`f:\my.exe`（到同一个位置）应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-21T16:34:41.607

我们的应用程序也有类似的问题，这些应用程序通常放置在网络共享上。我们通过以下方式解决此问题：

*   使用 Thawte 颁发的 Microsoft Authenticode 证书对所有应用程序组件进行签名和时间戳记。
*   部署包含安全策略的 msi 包，授予由我们的证书签名的应用程序完全信任。

如果您的公司不会/不能购买代码签名证书，您可以在某处安装 CA 并仅为此目的颁发证书（我认为它会起作用，尽管该证书不会解析为受信任的根。）

另一种更麻烦的选择是对所有程序集进行强签名，并对使用该密钥签名的所有程序集授予完全信任。

这两种方法都会导致每个工作站执行一次程序（更新的应用程序仍然可以工作）。我认为它甚至可以以某种方式在整个企业中传播，但从未这样做过，也不知道细节。

# javascript - 如何读取应用的 CSS-counter 值？

> ID：532073
> 
> 赞同：12
> 
> 时间：2009-02-10T12:16:19.587
> 
> 标签：javascript, css

假设您有一个 CSS 2.1 计数器，例如

```
ol {
  counter-reset: section;
  list-style-type: none;
}
li:before {
  counter-increment: section;
  content: counters(section, ".") " ";
}

<ol>
  <li>itemA</li>          <!-- 1     -->
  <li>itemB               <!-- 2     -->
    <ol>
      <li>itemC</li>      <!-- 2.1   -->
      <li id="foo">itemD</li>      <!-- 2.2   --> 
```

（参见[https://developer.mozilla.org/en/CSS_Counters](https://developer.mozilla.org/en/CSS_Counters) “嵌套计数器”）

有没有办法在 JavaScript中读取/获取`:before.content`（在这种情况下为“2.2”） ？`<li id="foo">`

编辑：在我的情况下，仅 Mozilla 的解决方案就足够了。但似乎真的没有办法访问这些信息。至少我在[https://developer.mozilla.org/en/CSS_Counters](https://developer.mozilla.org/en/CSS_Counters) ff 上没有找到任何东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T13:04:38.113

没有我能想到的，没有。:before 伪元素不是 DOM 的一部分，因此无法处理它们的内容。

您可以创建一个函数来扫描样式表的 DOM 中的 :before 规则，并计算出浏览器在哪里应用了哪些规则，但这会非常混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T13:28:22.003

我想过一种解决方法，试图获取 .content 值，但即使这样也行不通，因为它没有被设置。这真的很令人震惊。我认为实际上没有任何简单的方法可以获得这个值！

您可以使用一些令人作呕的 Javascript 来计算它，但这会破坏这种自动 css 样式的全部意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T18:10:28.220

我同意其他人的观点：目前没有办法做到这一点。因此，我建议您将基于 CSS 的计数器替换为基于 javascript 的计数器。用 jQuery 编写脚本来执行相同类型的列表项标记应该不会太难，然后您就知道您插入了哪些值。也许您可以保留基于 CSS 的编号作为备用，以防浏览器中禁用 javascript。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-08-02T19:48:40.657

```
var x = document.getElementById("foo");
var y = document.defaultView.getComputedStyle(x, "::before").getPropertyValue(
          "counter-increment"); 
```

":before" 用于向后兼容，如果不这样做，我不知道当前对 "::before" 的支持。

澄清：**:**是 CSS2.1 中的伪类 & 元素，**::**是 CSS3 中的伪元素。

您可能必须使用 parseInt 解析出数字。

不幸的是 getComputedStyle 是一个标准函数，这意味着 MSIE 不支持这个，但 FF、Chrome & Safari 和 Opera 支持。

# visual-studio-2008 - 查找和替换的通配符用法

> ID：532085
> 
> 赞同：2
> 
> 时间：2009-02-10T12:18:25.197
> 
> 标签：visual-studio-2008, wildcard

我的代码中有一个 get 方法，该方法当前正在使用参数。我想从此方法中删除此参数。为此，我必须更新所有使用此方法的代码。我尝试在 VS2008 中使用通配符选项作为 get(?*) 来查找和替换 get()。**但不幸的是，这也与 if( get() > 1** ) 类型的字符串匹配。我可以使用什么其他字符串来执行此操作。我希望我的要求很明确。基本上我想用get（）替换所有get（blah）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T12:31:56.990

要扩展@Gerrie Schenck 的答案，请转到`get(blah)`方法定义。单击定义并选择删除参数。删除不需要的参数。它应该遍历代码并更新任何使用该方法的引用并删除相应的参数。

如果您已经更新了方法并且不能再使用此功能，您可以尝试使用`get\([^)]+\)`. 我手边没有我的正则表达式备忘单，但应该匹配`get(`，然后是一个或多个不是结束括号的东西，最后是结束括号。您可能还需要转义括号内的右括号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T12:46:32.510

正在寻找

> 得到（[！）]*）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T12:20:12.307

使用 Visual Studio 的重构功能。

# pdf - 需要有关 PDF 颜色分离的帮助/答案

> ID：532089
> 
> 赞同：0
> 
> 时间：2009-02-10T12:20:03.070
> 
> 标签：pdf, colors, ghostscript

使用以下过程：

1.  当用户将某些内容打印到虚拟打印机时，PDFCreator 会创建 PDF
2.  PDF 通过集成的 VBScript 处理程序进一步处理，并传递给 JAVA，后者对 PDF 内容进行一些处理
3.  在该过程的中间，使用 PDF 调用外部应用程序，将黑色文本和图形添加到 PDF
4.  PDF 被收集起来，每周交给印刷厂一次，该印刷厂为每个 CMYK 使用一个印版

问题是：印刷厂需要一个分色的CMYK PDF，但是从外部应用程序添加的黑色文本和图形应该是K平面上唯一的内容（因为我们要制作特殊的打印效果）。通过 PDFCreator 打印的所有其他内容只能在 CMY 印版上，因此必须用这些颜色模拟黑色。

目前，我们在调用外部应用程序之前手动停止该过程并通过 Adob​​e Creator Pro 分离颜色，但这不是未来的选择，因为整个过程应该是自动化的。

所以基本上我需要一种将 CMYK PDFCreator PDF 转换为 CMY 版本的方法，这样外部应用程序就可以根据需要输入尽可能多的黑色 K 内容。

PDF转换是我前进的正确方向吗？有什么办法可以用ghostscript做到这一点吗？我阅读了 gs 文档，但一无所获，因为我只看到了 RGB 到 CMYK 的转换，但没有看到 CMYK 到 CMY 的空 B...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T12:02:20.967

我相信 PDFCreator 只是 ghostscript 的一个包装器，所以您可能会对[ghostscript 邮件列表](http://www.ghostscript.com/mailman/listinfo/)感到高兴。似乎 gs 确实支持某些仅输出 CMY 的[打印机](http://pages.cs.wisc.edu/~ghost/doc/printer.htm)，因此该功能可能在那里可用。

使用一种叫做黑色的新分离器不是更好吗？印刷厂不能处理吗？

# c++ - C++ 析构函数的奇怪行为

> ID：532092
> 
> 赞同：5
> 
> 时间：2009-02-10T12:21:10.293
> 
> 标签：c++, visual-studio-2008, debugging, destructor

```
#include <iostream>
#include <vector>
using namespace std;

int main()
{
    vector< vector<int> > dp(50000, vector<int>(4, -1));
    cout << dp.size();
} 
```

仅从命令行运行时，这个小程序需要一秒钟的时间来执行。但在调试器中运行时，需要 8 秒以上。暂停调试器表明它正在销毁所有这些向量。怎么回事？

注意 - Visual Studio 2008 SP1，Core 2 Duo 6700 CPU，2GB RAM。

**补充：**为了澄清，不，我不会混淆调试和发布版本。这些结果在同一个 .exe 上，中间甚至没有任何重新编译。事实上，在 Debug 和 Release 构建之间切换并没有改变。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T12:25:35.273

在调试器中运行会将用于进行更多检查的内存分配库更改为一个。除了内存分配和解除分配之外什么都不做的程序将比“正常”程序遭受更多的痛苦。

**编辑** 刚刚尝试在VS下运行您的程序，我得到一个看起来像的调用堆栈

```
ntdll.dll!_RtlpValidateHeapEntry@12()  + 0x117 bytes    
ntdll.dll!_RtlDebugFreeHeap@12()  + 0x97 bytes  
ntdll.dll!_RtlFreeHeapSlowly@12()  + 0x228bf bytes  
ntdll.dll!_RtlFreeHeap@12()  + 0x17646 bytes    
msvcr90d.dll!_free_base(void * pBlock=0x0061f6e8)  Line 109 + 0x13 bytes
msvcr90d.dll!_free_dbg_nolock(void * pUserData=0x0061f708, int nBlockUse=1)
msvcr90d.dll!_free_dbg(void * pUserData=0x0061f708, int nBlockUse=1) 
msvcr90d.dll!operator delete(void * pUserData=0x0061f708)
desc.exe!std::allocator<int>::deallocate(int * _Ptr=0x0061f708, unsigned int __formal=4)
desc.exe!std::vector<int,std::allocator<int> >::_Tidy()  Line 1134  C++ 
```

其中显示了 ntdll.dll 中的调试函数和正在使用的 C 运行时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T12:23:02.003

运行带有调试器的程序总是比没有运行程序要慢。

这一定是由于 VS 挂钩新/删除调用并在附加时进行更多检查 - 或者运行时库使用 IsDebuggerPresent API 并在这种情况下做不同的事情。

您可以在 Visual Studio 中轻松尝试此操作，使用 Debug->Start Debugging 或 Debug->Start without Debugging 启动程序。没有调试就像从命令行一样，具有完全相同的构建配置和可执行文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T03:05:12.040

当您在调试器中启动程序时，调试堆会自动启用，而不是使用调试器附加到已经运行的程序。

Mario Hewardt 和 Daniel Pravat所著的*[Advanced Windows Debugging](http://www.advancedwindowsdebugging.com/)*一书提供了一些关于 Windows 堆的不错信息，事实证明，关于堆的章节[作为示例章节已在网站上发布](http://www.advancedwindowsdebugging.com/ch06.pdf)。

第 281 页有一个关于“附加与在调试器下启动进程”的侧边栏：

> 在调试器下启动进程时，堆管理器会修改所有请求以创建新堆并更改堆创建标志以启用调试友好的堆（除非 _NO_DEBUG_HEAP 环境变量设置为 1）。相比之下，附加到已经运行的进程，进程中的堆已经使用默认堆创建标志创建，并且不会设置调试友好标志（除非应用程序明确设置）。

（另外：[一个半相关的问题](https://stackoverflow.com/questions/267540/really-strange-problem-about-access-violation/267584)，我之前发布了这个答案的一部分。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T13:28:30.567

绝对是 HeapFree 减慢了速度，您可以使用下面的程序获得相同的效果。

将 HEAP_NO_SERIALIZE 等参数传递给 HeapFree 也无济于事。

```
#include "stdafx.h"
#include <iostream>
#include <windows.h>

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
HANDLE heap = HeapCreate(0, 0, 0);

void** pointers = new void*[50000];

int i = 0;
for (i = 0; i < 50000; ++i)
{
    pointers[i] = HeapAlloc(heap, 0, 4 * sizeof(int));
}

cout << i;
for (i = 49999; i >= 0; --i)
{
    HeapFree(heap, 0, pointers[i]);
}

cout << "!";

delete [] pointers;

HeapDestroy(heap);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-27T03:08:18.970

[http://www.symantec.com/connect/articles/windows-anti-debug-reference](http://www.symantec.com/connect/articles/windows-anti-debug-reference)

阅读第 2 节“PEB!NtGlobalFlags”和第 2 节“堆标志”

认为这可以解释它...

* * *

编辑：添加解决方案

在 CREATE_PROCESS_DEBUG_EVENT 的处理程序中，添加以下内容

```
// hack 'Load Configuration Directory' in exe header to point to a new block that specfies GlobalFlags 
IMAGE_DOS_HEADER dos_header;
ReadProcessMemory(cpdi.hProcess,cpdi.lpBaseOfImage,&dos_header,sizeof(IMAGE_DOS_HEADER),NULL);
IMAGE_OPTIONAL_HEADER32 pe_header;
ReadProcessMemory(cpdi.hProcess,(BYTE*)cpdi.lpBaseOfImage+dos_header.e_lfanew+4+sizeof(IMAGE_FILE_HEADER),&pe_header,offsetof(IMAGE_OPTIONAL_HEADER32,DataDirectory),NULL);
IMAGE_LOAD_CONFIG_DIRECTORY32 ilcd;
ZeroMemory(&ilcd,sizeof(ilcd));
ilcd.Size = 64; // not sizeof(ilcd), as 2000/XP didn't have SEHandler
ilcd.GlobalFlagsClear = 0xffffffff; // clear all flags.  this is as we don't want dbg heap
BYTE *p = (BYTE *)VirtualAllocEx(cpdi.hProcess,NULL,ilcd.Size,MEM_COMMIT|MEM_RESERVE,PAGE_READWRITE);
WriteProcessMemory(cpdi.hProcess,p,&ilcd,ilcd.Size,NULL);
BYTE *dde = (BYTE*)cpdi.lpBaseOfImage+dos_header.e_lfanew+4+sizeof(IMAGE_FILE_HEADER)+offsetof(IMAGE_OPTIONAL_HEADER32,DataDirectory)+sizeof(IMAGE_DATA_DIRECTORY)*IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG;
IMAGE_DATA_DIRECTORY temp;
temp.VirtualAddress = p-cpdi.lpBaseOfImage;
temp.Size = ilcd.Size;
DWORD oldprotect;
VirtualProtectEx(cpdi.hProcess,dde,sizeof(temp),PAGE_READWRITE,&oldprotect);
WriteProcessMemory(cpdi.hProcess,dde,&temp,sizeof(temp),NULL);
VirtualProtectEx(cpdi.hProcess,dde,sizeof(temp),oldprotect,&oldprotect); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T12:23:33.733

是的，确实是WTF。

您知道您的编译器将通过内联它们来优化许多这些函数调用，然后进一步优化那里的代码以排除任何实际上没有做任何事情的东西，这对于 int 的向量意味着：几乎不是很多.

在调试模式下，内联没有打开，因为那会使调试变得很糟糕。

这是一个很好的例子，说明了 C++ 代码的速度有多快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T14:34:42.593

8秒？？我在调试模式下尝试了同样的方法。我猜不超过半秒。你确定是破坏者？

供参考。Visual Studio 2008 SP1，Core 2 Duo 6700 CPU，2GB RAM。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-10T13:26:00.980

对我来说毫无意义 - 在正常配置中将调试器附加到随机二进制文件应该主要只是捕获断点中断（asm int 3 等）。

# asp.net - 我们是否应该在 DotNetNuke 平台上构建我们的下一代 Web 应用程序？

> ID：532099
> 
> 赞同：12
> 
> 时间：2009-02-10T12:23:16.933
> 
> 标签：asp.net, architecture, dotnetnuke

我们目前正在考虑使用 DotNetNuke 作为我们未来将集中托管的基于门户和客户端可定制的 Web 应用程序的基础。这个想法是将动态部分作为 DNN 模块，然后与负责业务处理和数据存储的后端 WCF 服务通信。

你对这样的模型有什么好的/坏的经历？

有什么你会警告或推荐的吗？

任何建议将不胜感激，谢谢...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-11T01:20:09.873

DotNetNuke 可以是一个强大的平台。大多数抨击它的人实际上并没有将它用于任何事情，但只知道它是很久以前创建的。

我可以给你几个优点和缺点来看看。与其他 CMS 平台相比，使用它的主要优势在于它是一个非常成熟的平台，周围有相当大的社区（例如 Snowcovered）。对于大多数任务，它要么已经内置，要么已经有人构建了一个模块来完成它。它的架构已经构建为支持高可用性应用程序的缓存和场配置，如果您正在查看大量请求，这将消除一个主要问题。

但是，DotNetNuke 可能令人失望的地方是当您需要在模块中执行多步骤流程时。这可能适用于任何 CMS，但您会觉得自己在跳槽以尝试获得多个单独的模块以提供“紧密”的用户体验。我真的没有具体的例子——这只是你从体验中得到的感觉，一切都在它自己的“容器”中。另一件事是开箱即用，它只是没有 Web 2.0 的外观。你可以自定义皮肤和样式表来做任何你想做的事情，但出于某种原因，这对于整个 DNN 阵营来说并不是一个重要的优先事项，就像 Drupal 和其他人一样。

所以我想如果我必须做一个总结，我会说如果你正在寻找一种快速的方法来获得一个可定制的 CMS，并且你对 CMS 平台的一般限制感到满意，那么就去做吧。但是，如果您的 UI 对您来说是最重要的，并且您愿意花费大量的精力使其完全符合您的要求，那么请使用 ASP.NET 母版页等创建您自己的应用程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T12:42:37.853

呃，DNN？真的吗？

我在这里为火焰敞开心扉，但它是为一个不同的、不那么文明的时代而设计的产品（VB.NET，I18N 支持不佳，没有 msterpages）。现在甚至在 ASP.NET 中也有更好的框架，在 Drupal 之类的东西中也有更好的 CMS。我认为它很好地让我们度过了 ASP.NET 1.1 的痛苦，但我认为这些天你的标题问题的答案是“不”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T20:58:45.403

我从事过几个 DNN 项目。有几件事我似乎总是卡在上面。

首先，也许最重要的是菜单。内置菜单和购买的菜单模块都非常有限且难以使用。我们使用 xml 转换来呈现为菜单创建 html。但是，我们返回给我们的 xml 是一个平面 xml 文件。意味着不使用层次结构，这限制了您可以做的一些子菜单的事情。所以 0 级到 4 级菜单项都是彼此的兄弟。

其次，有许多模块可供选择。如果标准 DNN 没有做某事，则很可能有一个模块用于它。但是，这些模块的质量因模块而异。

最后，如果您需要一个模块来做一些特定的事情并且需要自己构建一个。如何做到这一点并不那么直观，并且在我们用于两个不同项目的 DNN 版本之间，该过程发生了变化。

我想说，如果你愿意真正学习 DNN，它会是一个非常有用的工具。但如果这是一个一次性项目，我认为最好不要管它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T21:11:47.167

我现在已经在我现在的职位上工作了 6 个月，并且几乎完全在 DNN 中进行开发。在这次演出之前，我没有 DNN 经验。所以这会让你知道我来自哪里。

## 好处

DNN 真的很容易学习。管理界面相当直观，代码库非常一致。我很少需要参考我桌上的 DNN 书（通常只是为了了解深奥的细节。）

DNN 用于从 DB 中创建对象的 hydrator 模式非常巧妙且运行良好。它还迫使您使对象属性与存储过程/查询保持简洁，因此将混淆保持在最低限度。

有大量的 3rd 方模块开发人员。而且这些模块通常很便宜。所以你可以利用这些来省钱。（[雪覆盖](http://www.snowcovered.com/)和[DNN 市场](http://marketplace.dotnetnuke.com/)）

## 缺点

我注意到一件事，但我们无法弄清楚原因，但 DNN 会不时丢弃它的皮肤。没有错误，也没有明显的原因。它只是不应用它们，并且在服务器重新启动之前不会这样做。

文档是残酷的。如果您要使用 DNN，请购买一本书。没有这本书很容易，但是当您需要参考资料时，**找不到**任何有用的资料。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T12:26:30.933

我参与过各种 dotnetnuke 项目，从简单的博客扩展到成熟的网站创建者（创建自定义子门户）。

一旦您了解了 Dotnetnuke 的工作原理，它就很棒。文档缺乏但越来越好。

我对 dotnetnuke 的抱怨是它很难进行单元测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T17:46:19.387

我没有使用[Dot Net Nuke](http://www.dotnetnuke.com/)的经验，但我查看了源代码并考虑使用许多“内容管理系统”作为 Web 应用程序的基础。

这种方法的问题在于，这样的系统几乎总是有一个架构，使得做*你*想做的事情非常痛苦。商业类库主要被*设计*为可重用（由公司的专业人员），它们可能会遇到问题。内容管理系统甚至没有*设计*让他们的代码重用，即使人们有时会尝试这样做。很容易找到一个看似简单的元素（作为一个虚构的例子，比如说，一个显示文件数量的字符串）被定义并以一种非常令人惊讶的方式放在页面上。这使得修改或删除简单元素变得困难 - 如果您能找出元素是如何放置在页面上的！还要记住，使用这些应用程序，您在某种程度上还依赖于将事物组合在一起的集体的更新和错误修复。嗯，而且因为这些东西很常见，它们更有可能受到常见的利用（比如[phpBB 经常是](http://www.trap17.com/index.php/phpbb-exploit_t7860.html)）。

我还没有看过[Drupal](http://drupal.org)。它更现代，更经常用作通用 Web 门户的基础。但我仍然对将它用作我大量定制的东西的基础持怀疑态度。

除非您不希望对初始 DNN 架构进行大量修改，否则我会回避按照您建议的方式做事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-26T01:46:47.630

自从近 20 年前它的 beta 测试版以来，我一直在断断续续地使用它，并且可能有 10k 小时的时间投入到在 DNN 之上构建网站和 Web 应用程序上。这是我的看法...

我知道我迟到了，但对于其他考虑使用 DNN 的人，请意识到从长远来看，你很有可能会后悔。

要回答 OP 的直接问题，如果且仅当您的构建不需要与 DNN 核心交互且不以内容管理为中心的模块时，它并不是一个糟糕的构建解决方案。对于您希望用户能够登录、访问某些信息或资产等的基本客户门户而言，它可能是可以的。

但是，您应该注意 DNN 的一些主要缺点。我曾经很喜欢它。现在，我什至不会考虑将它用于新建项目。

以下是 DNN 的一些问题：

1.  DotNetNuke 不是真正的 CMS！如果不添加昂贵的第三方模块，您将无法使用它来管理内容类型。
2.  几乎不可能调整管理 UI 以满足客户的要求或改进低于标准的创作 UX。
3.  零创新 - DNN 在所有方面都落后于 Drupal 和 Wordpress 等其他 CMS。自从 2000 年代初期产品问世以来，他们没有对那里的产品进行任何创新
4.  DNN 团队仍然未经修饰和错误，似乎不断地重新发明轮子，为了改变它们而改变事物。
5.  它建立在非常陈旧的技术网络表单之上，并且没有计划重振其核心。
6.  它变得越来越商业化，而开源越来越少。您会发现在许多其他开源项目中普遍存在的社区意识并不多。

我的博客上有一篇[关于 DNN 缺点的](https://siteden.com/dotnetnuke-drawbacks-4-reasons-to-run-away/)完整、更详细的文章。高温高压

# php - PEAR Mail_Queue 发送重复的电子邮件

> ID：532112
> 
> 赞同：0
> 
> 时间：2009-02-10T12:28:43.347
> 
> 标签：php, pear, mail-queue

这里有几个问题：

`mail_queue->put`应该在数据库中插入两次消息吗？唯一的区别是`time_to_send`value 和`user_id`.

这是我为一个用户收到的一条消息：

```
1\. user_id = 1, time_to_send = 2009-02-10 14:02:02
2\. user_id = -1, time_to_send = 2009-02-10 14:00:02 
```

第一个是我所期望的，但第二个有什么目的？

如果我发送队列，消息将到达两次。如果我删除带有否定`user_id`的邮件，则只会发送一封邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T13:45:53.410

> 函数 put($from, $to, $hdrs, $body, $sec_to_send=0, $delete_after_send=true, $id_user=MAILQUEUE_SYSTEM)

你传递参数 $id_user 还是默认值？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T10:49:18.617

我逐行浏览了程序，果然，该`put`函数有一个未注释的示例。

# javascript - iPhone xcode 应用程序可以读取 Safari Mobile 之前存储的 cookie 吗？

> ID：532117
> 
> 赞同：23
> 
> 时间：2009-02-10T12:29:46.013
> 
> 标签：javascript, cocoa-touch, safari

iPhone 应用程序可以读取 Safari Mobile 之前存储的 cookie 吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T14:27:34.293

要实际*回答*您的问题：

不。

SDK 应用程序无法访问 Mobile Safari 的 cookie。每个 SDK 应用程序都有自己的 WebKit 缓存和 cookie 存储，因此虽然 cookie 将在同一个应用程序中持久存在，但它们无法在应用程序之间访问。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-01-17T11:44:37.630

从 iOS 9 开始，这是可能的！

使用[sfSafariViewController](https://developer.apple.com/library/ios/documentation/SafariServices/Reference/SFSafariViewController_Ref/)。

您将需要设置：

*   应用中用于接收 cookie 数据的[自定义 URL 方案。](http://help.contrast.co/hc/en-us/articles/200865293-URL-Scheme-Intro-for-App-Developers)
*   您从中获取 cookie 的网站需要实现特定于您应用的自定义 URL 方案的 API，以重定向回您的应用。

你可以克隆这个[repo](https://github.com/mackuba/SafariAutoLoginTest)，它有一个完整的工作演示。

希望这可以帮助，

利亚姆

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-04-21T04:10:22.223

如果您可以访问服务器 url，实际上有一种有趣的方式。

1.  在您的应用程序中启动带有移动 safari 的服务器 url。
2.  目标服务器 url 读取 cookie 并重定向回应用程序特定的 url (myapp://cookie=123)
3.  然后应用程序切换回来，您可以从 url 处理程序中读取该值

这有点 hacky，因为应用程序会切换移动 safari，然后立即切换回应用程序。但是，这是可能的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-11T11:49:48.310

请注意，在 iOS 8 上，您最好使用[Safari 密码共享](http://www.macrumors.com/2014/06/13/ios-8-safari-password-sharing/)来解决一些导致此问题的用例。

这不是直接可能的，但在网站的合作下是可能的。

澄清一下，用户案例是一个 Objective C 应用程序想要读取一个 cookie 的值，该值是由一个网站在移动 safari 中设置的。（即，特别是 UIWebView 不参与设置 cookie）

你的应用应该这样做：

1.  使用 [[UIApplication sharedApplication] openURL:url] 启动移动 Safari；
2.  URL 应该是一个特殊的，例如。[http://yourwebsite.com/give-ios-app-the-cookie](http://yourwebsite.com/give-ios-app-the-cookie)
3.  在您的网站上，当该 url 启动时，发出重定向到 your-app-url-scheme:cookievalue= （例如，angeringbirds:cookievalue=hh4523523sapdfa ）
4.  当您的应用程序委托接收 - (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation 处理 url 以获取 cookie 值

请注意，您不应在应用程序启动时自动执行此操作 - 用户将看到传输到 Mobile Safari 并返回，这不是一个好的用户体验，Apple 将拒绝您的应用程序（Apple 还认为这是“上传用户的个人数据未经他们事先同意而送达服务器”）。最好是响应用户，注意用户体验 - 例如。等待用户点击“登录”按钮，然后执行此操作，如果用户未登录您的网站，http: [//yourwebsite.com/give-ios-app-the-cookie](http://yourwebsite.com/give-ios-app-the-cookie)应该向用户显示登录信息Safari 中的屏幕。如果用户已登录，您可以在 Safari 中短暂显示“自动登录...”屏幕一两秒，然后再将用户重定向回来。

当然，没有办法让它与 hotmail/gmail/etc 一起使用——它需要是你自己的网站。

归功于[移动 safari 和 iOS 应用程序中的唯一标识符，](https://stackoverflow.com/questions/9197241/unique-identifier-for-both-mobile-safari-and-in-app-in-ios)以建议这种方法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-10T10:26:05.130

由于 iPhone 上的沙盒功能，您无法访问 Safari 的 cookie。您只能访问在您的应用程序中创建的 cookie - 例如通过 UIWebView。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-10T12:44:35.603

[尽管您之前](https://stackoverflow.com/questions/531712/reading-cookies-using-xcode-on-the-iphone)[曾两次](https://stackoverflow.com/questions/527470/read-cookies-using-xcode-in-iphone-app) 问过相同的问题，但这里有一种方法尚未提及...

这可能有点令人费解，但您可以使用[UIWebView](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIWebView_Class/Reference/Reference.html)做 Greasemonkey 式的事情。像这样的东西：

*   加载您的目标页面
*   制作一些 javascript 来读取 document.cookie 并返回你需要的数据
*   在[webViewDidFinishLoad委托中，使用](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIWebViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UIWebViewDelegate/webViewDidFinishLoad:)[stringByEvaluatingJavaScriptFromString](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instm/UIWebView/stringByEvaluatingJavaScriptFromString:)消息将此 javascript 注入 UIWebView

我已经使用这种技术来增强 iPhone 应用程序中的第 3 方页面，但我不确定它是否会从与 Safari 移动设备相同的位置读取 cookie。

值得一试吗？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-10-13T08:12:11.370

这是我的 utils 获取/设置 cookie 方法。

```
 +(void)setCookie:(NSString *)key withValue:(NSString *)value {
    NSArray *keys = [NSArray arrayWithObjects:
                     NSHTTPCookieDomain,
                     NSHTTPCookieExpires,
                     NSHTTPCookieName,
                     NSHTTPCookiePath,
                     NSHTTPCookieValue, nil];
    NSArray *objects = [NSArray arrayWithObjects:
                        @"YOURDOMAIN",
                        [NSDate distantFuture],
                        key,
                        @"/",
                        value, nil];    
    NSDictionary *dict = [NSDictionary dictionaryWithObjects:objects forKeys:keys];
    NSHTTPCookie *cookie = [NSHTTPCookie cookieWithProperties:dict];
    NSHTTPCookieStorage *sharedHTTPCookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage];
    [sharedHTTPCookieStorage setCookie:cookie];
}

+(NSString *)getCookie:(NSString *)key {
    NSHTTPCookieStorage *sharedHTTPCookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage];
    NSArray *cookies = [sharedHTTPCookieStorage cookiesForURL:[NSURL URLWithString:@"YOURDOMAIN"]];
    NSEnumerator *enumerator = [cookies objectEnumerator];
    NSHTTPCookie *cookie;
    while (cookie = [enumerator nextObject])
    {
        if ([[cookie name] isEqualToString:key]) 
        {
            return [cookie value];
        }
    }
    return nil;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-14T18:16:38.157

你可能想检查

```
if ([[NSHTTPCookieStorage sharedHTTPCookieStorage] cookieAcceptPolicy] != NSHTTPCookieAcceptPolicyAlways) {
    [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookieAcceptPolicy:NSHTTPCookieAcceptPolicyAlways];       
} 
```

但显然 NSHTTPCookieStorage 甚至不保存来自 iOS 上当前应用程序中最后一个请求的 cookie (rdar://8190706)

# ssas - 联合 MDX 中的最后一行

> ID：532133
> 
> 赞同：0
> 
> 时间：2009-02-10T12:40:04.613
> 
> 标签：ssas, mdx

我对 MDX 很陌生，并且在将以下 t-sql 查询发送到 MDX 时遇到了一些麻烦。

```
select distinct
  System
from Systen
  where System <> 'MIS'
UNION
  SELECT  'ALL' 
```

到目前为止，我得到了这样的东西。但我不知道如何添加最后一行'ALL'。

```
SELECT 
  {} ON COLUMNS,
  {[Concesionario].[Sistema].[Sistema].ALLMEMBERS} ON ROWS
FROM 
(
  SELECT 
    -
      {
        [Concesionario].[Sistema].&[]
       ,[Concesionario].[Sistema].&[MIS]
      } ON COLUMNS
  FROM [DW]
); 
```

知道怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T00:32:42.467

如果您的 Sistema 属性是可聚合的，它应该已经有一个“All”成员。问题是您从 Sistema 级别 [Concesionario].[Sistema].[Sistema].ALLMEMBERS 中进行选择，因为您使用的是 .

因此，您可以将查询更改为以下内容：

```
SELECT   
  {} ON COLUMNS,
  {[Concesionario].[Sistema].ALLMEMBERS} ON ROWS
FROM
 (
  SELECT
    {
        [Concesionario].[Sistema].&[]
       ,[Concesionario].[Sistema].&[MIS]
      } ON COLUMNS
  FROM [DW]
); 
```

但是将您想要的成员直接放在轴中而不是使用子选择会更容易。

```
SELECT   
 {} ON COLUMNS,  
 {[Concesionario].[Sistema].[All] ,[Concesionario].[Sistema].&[MIS]  } ON COLUMNS  
FROM [DW]); 
```

# jquery - 在 jQuery 中，选择一组元素的最快方法是什么？

> ID：532134
> 
> 赞同：1
> 
> 时间：2009-02-10T12:40:14.147
> 
> 标签：jquery, performance

我需要将 onClick 事件添加到页面上大约 10-20 个元素。

引用这些元素的最快方法是什么？

是否会使用：1）类参考 2）ID 参考

或者更深入的参考，例如： p -> div -> li ？

我意识到我们可能正在谈论一个非常小的性能提升，但我认为无论哪种方式都很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T12:50:04.543

这真的没有足够的元素来担心。除非您的页面中有很多事情要做，否则我会说使用 jQuery 和类选择器，以实现可维护性和可重复性，并继续编写更严格的代码。:)

如果您担心，请通过在脚本中松散地设置它来自己测试它。

补充：[直接回答](http://www.componenthouse.com/article-19)你的选择器速度问题：#id >> tag.class > .class。请注意，超过 20000 个元素，基于 id 的搜索和纯基于类的搜索之间的基准时间最多相差约 700 毫秒。这就是为什么我建议你不要太担心...... :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T18:36:00.017

由于您添加了 onClick 事件，请查看事件委托。它改变了我的生活。:-)

基本上，您会为容器分配一个侦听器，并捕获这 20 个项目的点击事件。不确定这是否与您尝试做的事情有关，但我认为每个人都知道这很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T12:44:37.850

您打算如何使用 ID 选择 10-20 个不同的元素？

类引用将是我要说的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T12:47:10.650

如果您用 div 包围内容并执行 (div -> li)。然后你就不必在每个元素上写很多标签，但肯定是 class over id

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T12:51:49.610

视情况而定。10-20 个元素，它们按类型或层次结构很好地隔离，因此您可以仅引用这些元素而不能引用任何其他元素。我会使用分层或基于属性的选择器。10-20 个元素散布在选择器不应该应用的相同类型的其他元素中，然后我会分配并使用一个类。如果您认为布局可能会更改并破坏其他选择器，后者可能是最灵活的。

```
$('div#interface > a').click( ... )

$('input[type=button]').click( ... )

$('span.clickable').click( ... ) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T12:53:44.613

您必须在您的元素以及页面上的其他元素中找到一种模式。

他们有相同的班级吗？页面上是否还有您不想选择但具有相同类的其他元素？基于 html-tags 选择的相同故事。

你必须根据你对元素的“分析”的输出做出决定。

# asp.net - div 隐藏和显示 javascript 在 Mozilla 中出现闪烁问题

> ID：532135
> 
> 赞同：0
> 
> 时间：2009-02-10T12:40:26.207
> 
> 标签：asp.net, javascript

我的 javascript 是

```
 function Show1()
    {
        //document.getElementById("Popup_tooltip").style.overflow="auto";
        document.getElementById("Popup_tooltip").style.display="block";
    }
    function Hide1()
    {
        /* hide the pop-up */
        document.getElementById("Popup_tooltip").style.display="none";

    } 
```

我的 div 的 CSS 是

```
.tooltip
{   
    display:block;
    position:absolute;
    top:145px;
    left:700;
    width:100%;
    height:100%;

} 
```

我的 div 是

```
<div id="Popup_tooltip" class="tooltip" >               
        <table width="180" height="70" border="1" bordercolor="#3a93ed" style="border-collapse:collapse;" cellspacing="0" cellpadding="0">
            <tr>
                <td bgcolor="#ebf5ff">
                    Help contents related to this topic will display here.
                    As a tooltip, if u need for help?
                </td>
            </tr>
        </table>                
</div> 
```

和 onmouseover 和 mousehide 我调用函数显示和隐藏.. 它在 IE 中正常运行但在 Mozilla 中出现问题 请尽快回复thanx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T12:51:59.173

您将鼠标事件绑定到哪个确切元素？

这种影响有两个常见的原因。一个是绊倒你自己的状态，因为鼠标悬停有效地隐藏了当光标再次移动时触发鼠标移出的对象，无穷无尽。另一个是两个事件在不同的对象上，绊倒一个会隐藏自己并触发下一个事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T14:18:56.373

我的同事面临同样的问题。以下是我们的问题，请检查它是否与您匹配：

在我们的例子中，工具提示是一个隐藏的*div*元素，当鼠标移到链接上时它会变得可见。此外，当鼠标移出链接时，*div*元素被隐藏。

我们的代码的问题是，当工具提示可见时，它会出现在链接上。因此，鼠标光标实际上停留在工具提示上。也就是说，鼠标不在链接的顶部，而是在工具提示的顶部。在这种情况下，Mozilla Firefox 会触发一个*“onMouseOut”*事件，从而导致工具提示消失。

现在鼠标光标位于链接上，因此触发了*“onMouseOver”*事件并且工具提示变得可见。这种情况一直在继续……

解决方案是为工具提示使用比链接更高的 z-index 属性。尝试确保给定的 z-index 值是正数，因为 Firefox 无法识别负数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-13T09:02:39.647

我遇到了一个类似的问题。用户将指针移动到图像顶部，一个 div 会在指针所在位置的页面上方浮动，同时显示另一张图像。IE似乎没有问题，但是整个div在Firefox中闪烁。

Shree 所说的关于工具提示上方的指针帮助我解决了这个问题。我所做的是，我没有将 div 的 x 和 y 设置为指针的确切位置，而是将其放置了 2 或 3 个像素。这样可以防止鼠标越过 div 从而触发 mouseout 事件。这不是一个非常优雅的修复方法，但如果你可以忍受你的工具提示太高 2-3 像素，它就可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T12:52:36.333

> 它在 IE 中正常运行，但在 Mozilla 中出现问题

对我来说很好。您必须告诉我们您遇到的具体问题。

> 左：700；

应该是 700 像素。

> onmouseover 和 mousehide 我调用函数

大概你的意思是onmouseout。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T13:18:05.803

当您移动到建立事件处理程序的元素的其中一个子元素的区域时，将触发 MouseOut 事件。

我已经从精彩的[jQuery in Action](http://www.manning.com/bibeault/)中获取代码来[演示这里](http://jsbin.com/aride)

第一个 div（外部 1）具有用于 mouseover 和 mouseout 事件的事件处理程序。每次引发事件时，事件处理程序都会在 div 下方写入事件的名称。当您越过外部 1 和内部 1 之间的边界时，mouseout 和 mouseover 事件处理程序会触发，在您的情况下这会导致闪烁。

第二个 div (Outer 2) 具有 mouseover 和 mouseout 事件的事件处理程序，但这些是通过 jQuery .hover() 命令创建的。当越过 Outer 2 和 Inner 2 之间的边界时，事件处理程序不会触发，但当鼠标越过 Outer 2 边界时会触发。

我相信这是你的问题。

**注意：** 这**不是**说“使用 jQuery”的答案——我只使用 jQuery 代码来突出问题。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-10T12:48:02.850

你有没有想过使用已经为跨浏览器创建和测试的 JavaScript 库？

像[jQuery](http://www.jquery.com)（给你这个，因为它是微软采用的那个）

使用这个库你可以写：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>

    <script src="_assets/js/jquery-1.3.1.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            $("#Popup_tooltip").hide();

            $("#showTooltip").hover(function() {
                $("#Popup_tooltip").show("slow").stop;
            }, function() {
                $("#Popup_tooltip").hide("slow").stop;
            });
        });        
    </script>

    <style type="text/css">
        .tooltip
        {
            width: 180px;
            height: 70px;
            border: solid 1px #ea93ed;
            background-color: #ebf5ff;
            padding: 5px;
        }
    </style>
</head>
<body>
    <a id="showTooltip" href="#">click here to show the tooltip</a>
    <div id="Popup_tooltip" class="tooltip">
        Help contents related to this topic will display here. As a tooltip, if u need for
        help?
    </div>
</body>
</html> 
```

或者只使用[jQuery Tooltip](http://plugins.jquery.com/project/Tooltip)插件，例如

# c - 如何实现为 C 添加非 c 功能的库？

> ID：532136
> 
> 赞同：4
> 
> 时间：2009-02-10T12:40:54.987
> 
> 标签：c

有人可以解释一下如何将额外的功能添加到 C 中吗？

例如，C 没有输出功能，所以你可以通过包含 stdio.h 来使用 printf()，C 不知道如何打开 MessageBox，所以你包含并使用 MessageBox() 等。

但是这个功能是如何实现的呢？

您是否必须以某种方式使用汇编程序并访问视频 RAM 以获得输出或类似的东西？

例如，我知道 MessageBox() 是 WinAPI 的一部分，但它是如何实现的（尽管 WinAPI 是用 C 实现的）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T12:46:48.187

任何与系统交互的功能都是通过系统调用机制来执行的。本质上，这提供了您的代码和操作系统之间的接口。您提到的库函数围绕各种系统调用包装了一些方便的功能，以使您的代码更容易与更高级别的系统交互。但是，您可以编写代码直接执行此操作。有关更多信息，请查看[syscall](http://en.wikipedia.org/wiki/Syscall)和[ioctl](http://en.wikipedia.org/wiki/Ioctl)函数。在 Windows 上，有更多的系统调用，它们分散在[Windows API](http://en.wikipedia.org/wiki/Win32)中的各种库中。这篇[Dobb 博士](http://www.ddj.com/184410109)关于 Windows 系统调用的文章更详细

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T12:59:01.823

意识到你所做的几乎所有事情都会导致 CPU 从某个内存地址读取数字，对它们执行一些计算，或者将它们写入某个内存地址。

因此，与外界的大多数通信——像你的视频卡、网卡等设备——基本上归结为读取或写入神奇的内存位置。

（这有点过于简单化了，CPU 还可以做一些其他的事情——它可以读取/写入数字的 I/O 端口等；这些不能从标准 C 直接访问，通常公开此类功能的 C 库将有用汇编程序编写的相关代码；但现在让我们开始吧）。

用 C 语言编写的硬件驱动程序通常`struct`使用熟悉的 C 类型声明描述内存映射区域布局的 s，获取相关区域的地址，执行适当的强制转换，然后像其他任何方法一样使用生成的指针。

操作系统通常将这种特定于硬件的代码包装在某种提供虚拟化的机制中（因此您的代码可以假装它正在与一些标准的理想化设备对话，并且操作系统在它与您机器中的实际内容之间进行转换）和特权分离（因此您的代码被阻止做不应该做的事情和/或使其他人的代码崩溃）。因此，您链接到的库不会直接与硬件对话；他们将调用操作系统（通常使用某种形式的系统调用/中断/异常机制），这将为他们做到这一点。但是操作系统本身将大致按照我上面描述的那样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T12:52:59.140

对于 printf 部分 - 它是 C 标准库的一部分，它是 C 的一部分。因此，您的 C 编译器或 C 标准库的实现可以使用各种技巧来使其工作。

让我们举一个简单的例子来说明如何在 Unix 中实现这样的功能。采取`putchar`（此处简化 - 不返回任何内容）。它将一个字符输出到标准输出，其文件描述符编号为 1。操作系统提供了一个名为“write”的函数。程序可以写入文件描述符。因此， putchar 可以使用该功能：

```
void putchar(int c) {
    unsigned char cc = c;
    write(1, &cc, 1);
} 
```

将向文件描述符 1 写入 1 个字节。写入函数将告诉操作系统该愿望：

```
void write(int fd, void * ptr, size_t size) {
    asm("....."
        "int 0x80"); 
} 
```

它通常只包含一小块产生软件中断的装配线（在上面的示例中，它是中断号 0x80）。CPU 将切换到内核模式并跳转到某个固定地址，操作系统可以从该地址处理该中断。`write`将写入系统调用号写入某个寄存器，并将参数放入某个内存位置或寄存器中，以便操作系统知道此时该做什么。操作系统然后将应该写入的字节发送到指定的文件/设备（在标准输出的情况下，它可能是连接到文件描述符的终端驱动程序），并从中断返回，使 CPU 切换到再次用户模式。

这就是粗略的计划。当然还有更多内容（putchar 可以在执行系统调用之前缓冲输出......）。但原则上，它是这样工作的。

MessageBox 函数最后也会调用一些系统调用，以类似于上述解释的某种或其他方式将控制权转移到 Windows 内核中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T12:48:53.750

首先，您拥有符合 ANSI C 标准的 C 编译器。这是语言本身，不包括库。

然后你就有了标准库，你提到的 printf 函数可以在其中找到。这是使用 C 和 ASM 构建的，并且是特定于平台的。例如，在嵌入式平台中，printf 会将字符打印到串行端口或液晶显示器。所以需要使用平台特定的代码。但是，该界面对于所有平台都是通用的。

3rd 方库（如 WinAPI）也会发生类似的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T12:53:45.707

通常库是用“C”编写的。大多数 Win32 api 是用 C 编写的。有一些东西不能直接用 C 表示，例如 'syscall'、'int' 和读/写 io 端口。

看看[K&R](http://en.wikipedia.org/wiki/The_C_Programming_Language_(book))，他们实际上在书中实现了一些系统库。

# prompt - 使用 JScript 在 WSH 中提示对话框？

> ID：532138
> 
> 赞同：14
> 
> 时间：2009-02-10T12:41:42.740
> 
> 标签：prompt, jscript, wsh, windows-scripting

如何在 WSH 中使用 JScript 打开提示对话框？

我在文档中找到的唯一弹出对话框是 WshShell.Popup() 方法。但我需要一种方法来请求用户输入字符串，例如 DOM 中的 window.prompt() 方法。

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T15:30:59.790

我认为 WScript 对象不提供这样的方法，但是您可以从在 WSH 上运行的 vbscript 显示一个输入框。因此，这是一种可能的解决方案，可让您从 JS 中调用该 VB 函数！请注意以下代码片段“.wsf”的文件扩展名。

```
<!-- Test.wsf -->
<job id="InputBoxInJS">
   <script language="VBScript">
      Function VBInputBox(promptText)
        VBInputBox = InputBox(promptText)
      End Function
   </script>

   <script language="JScript">
      WScript.Echo("Hello from JScript")
      var x = VBInputBox("Enter text")
      WScript.Echo(x)
   </script>
</job> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-01-07T20:38:24.147

我知道这个问题已经得到解答，但我不想使用 .wsf 的东西，我也不想要加载 Internet Explorer 的开销（正如我所看到的其他解决方案所做的那样）。我使用谷歌找到了这个我认为最优雅的解决方案：

[http://with-love-from-siberia.blogspot.com/2009/12/msgbox-inputbox-in-jscript.html](http://with-love-from-siberia.blogspot.com/2009/12/msgbox-inputbox-in-jscript.html)

关键是使用 ActiveXObject“ScriptControl”，将语言设置为 VBScript，然后使用 ScriptObject.eval() 函数。网站上的示例独立存在。

编辑：对于那些遇到 64 位或换行等错误的人，这里有这个改进的版本，其中包含有关如何运行它的说明（在 Win7 x64 等系统上[）](http://cwestblog.com/2012/03/10/jscript-using-inputbox-and-msgbox/ "这里")。

# reporting-services - 在 SSRS 2005 中，必须声明标量变量

> ID：532141
> 
> 赞同：0
> 
> 时间：2009-02-10T12:43:13.780
> 
> 标签：reporting-services, scalar, multi-select

我有一个运行存储过程的报告：

```
EXEC ra_spProjectCalendar @Month, @Year, @ProjectID 
```

ProjectID 是一个多选下拉菜单。选择单个项目时，它工作正常。如果我选择多个项目，我会收到错误：

```
"Must declare scalar variable "@ProjectID" 
```

当我从“数据”选项卡运行它时，它工作正常，但是，当我将它置于预览模式时，我遇到了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T13:50:53.463

通过将查询构造为表达式，我得到了类似的工作 - 在您的示例中

```
="EXEC ra_spProjectCalendar @Month = '" & Parameters!Month.Value & "',@Year='" & Parameters!Year.Value & "',@ProjectID = '" &  Join(Parameters!ProjectID.Value, ",") & "'" 
```

目标 SP 中的一些代码将多选字符串拆分为一个临时表，该表用于连接以创建输出。

我不记得为什么我们最终这样做了——那是在我们开始迁移到 SSRS 时，事情已经发生了一些变化——但这可能是你描述的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-18T00:01:57.313

我发生了同样的错误：必须声明标量变量。

我现在意识到要检查的第一件事是，当您将查询输入为 text 或将存储的 proc 输入为存储的 proc 类型时，ssrs 会自动在数据集属性的参数选项卡中创建参数条目。如果它没有创建它们，它就无法正确读取您的查询。

在我的例子中，我使用 OPENQUERY 来调用分析服务立方体并引用包含大量方括号的字段名。不幸的是，SSRS 喜欢重新格式化您的代码，以便格式良好的“[Measures].[SomeMeasure]”变成这个丑陋的转义字符混乱 [[Measures]].[Somemeasure]]]

If you edit that query in another tool then re-copy it back to ssrs, then ssrs can't read that syntax! Even though it generates it! So remove all the extra square brackets and replace the double quotes and boom it works again and generates your parameters.

# xml - 使用 XSLT 截断 XML

> ID：532147
> 
> 赞同：7
> 
> 时间：2009-02-10T12:45:39.983
> 
> 标签：xml, xslt, xslt-1.0, symphony-cms

我有一个问题要问 SO 社区的聪明人。

下面是[Symphony CMS](http://symphony21.com/)生成的 XML 片段。

```
 <news>
        <entry>
            <title>Lorem Ipsum</title>
            <body>
                <p><strong>Lorem Ipsum</strong></p>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed malesuada auctor magna. Vivamus urna justo, pulvinar nec, sagittis malesuada, accumsan in, massa. Quisque mi purus, gravida eget, ultricies a, porta in, sem. Maecenas justo elit, elementum vel, feugiat vulputate, pulvinar nec, velit. Fusce vel ante et diam bibendum euismod. Nunc vel nulla non lorem dignissim placerat. Nulla magna massa, auctor et, tempor nec, auctor sit amet, turpis. Quisque odio lacus, auctor at, posuere id, suscipit eget, dui. Phasellus aliquam. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Proin varius. Phasellus cursus. Cras mattis adipiscing turpis. Sed.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed malesuada auctor magna.</p>
            </body>
        </entry>
    </news> 
```

我需要做的是`<body>`根据指定的长度取一部分元素，以博客样式显示：

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。sed malesuada auctor magna。Vivamus urna justo、pulvinar nec、sagittis malesuada、accumsan in、massa。Quisque mi purus, gravida eget, ultricies a, porta in, sem...**更多**

...**更多**是指向完整新闻项目的链接。我知道我可以选择特定的段落，我也知道我可以使用 substring 函数带来指定数量的字符。但是，我需要保留文本的格式，即`<body>`元素中的 HTML 标记。

我意识到这会引发标签关闭的问题，但肯定有办法。希望对 XSLT 更有经验的人可以对这个问题有所了解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T19:58:39.927

**这是完全解决问题的完整 XSLT 1.0 转换。**

这个 XSLT 转换：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
 xmlns:f="http://fxsl.sf.net/"
 xmlns:myAdd="f:myAdd"
 xmlns:myParam="f:myParam"
 exclude-result-prefixes="ext f myAdd myParam"
>
 <xsl:import href="scanl.xsl"/>
 <!--                                         -->
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>
 <!--                                         -->
 <myAdd:myAdd/>
 <myParam:myParam>0</myParam:myParam>
 <!--                                         -->
 <xsl:param name="pTruncateLength" select="772"/>
 <!--                                         -->
   <xsl:variable name="vFun" select="document('')/*/myAdd:*[1]"/>
   <xsl:variable name="vZero" select="document('')/*/myParam:*[1]"/>
 <!--                                         -->
   <xsl:variable name="vrtfScanResults">
           <xsl:call-template name="scanl">
             <xsl:with-param name="pFun" select="$vFun"/>
             <xsl:with-param name="pQ0" select="$vZero" />
             <xsl:with-param name="pList" select="/*/*/body//text()"/>
           </xsl:call-template>
   </xsl:variable>
 <!--                                         -->
   <xsl:variable name="vScanResults"
        select="ext:node-set($vrtfScanResults)"/>
   <xsl:variable name="vindNode" select=
    "count($vScanResults/*[. > $pTruncateLength][1]
                                   /preceding-sibling::*)"/>
 <!--                                         -->
   <xsl:variable name="vrtfTruncInfo">
       <xsl:for-each select="/*/*/body//text()">
 <!--                                         -->
         <xsl:variable name="vPos" select="position()"/>
         <tNode id="{generate-id()}">
           <xsl:attribute name="preserve">
             <xsl:if test="$vPos &lt; $vindNode">
               <xsl:value-of select="string-length(.)"/>
             </xsl:if>
             <xsl:if test="$vPos > $vindNode">
               <xsl:value-of select="0"/>
             </xsl:if>
             <xsl:if test="$vPos = $vindNode">
               <xsl:value-of select=
               "$vScanResults/*[$vindNode+1]
               -
                $pTruncateLength"/>
             </xsl:if>
           </xsl:attribute>
         </tNode>
       </xsl:for-each>
   </xsl:variable>
 <!--                                         -->
   <xsl:variable name="vTruncInfo" select="ext:node-set($vrtfTruncInfo)"/>
 <!--                                         -->
 <xsl:template match="node()|@*">
   <xsl:copy>
     <xsl:apply-templates select="node()|@*"/>
   </xsl:copy>
 </xsl:template>
 <!--                                         -->
 <xsl:template match="text()[ancestor::body]">
   <xsl:variable name="vAllowedLength"
        select="$vTruncInfo/*[@id = generate-id(current())]/@preserve"
   />
 <!--                                         -->
   <xsl:value-of select="substring(.,1,$vAllowedLength)"/>

   <xsl:if test="string-length(.) > $vAllowedLength
               and
                 $vAllowedLength > 0
                ">
     <strong> ...more</strong>
   </xsl:if>
 </xsl:template>
 <!--                                         -->
 <xsl:template match="myAdd:*" mode="f:FXSL">
   <xsl:param name="pArg1"/>
   <xsl:param name="pArg2"/>
   <xsl:value-of select="$pArg1 + string-length($pArg2)"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于原始源 XML 文档时**：

```
<news>
    <entry>
        <title>Lorem Ipsum</title>
        <body>
            <p>
                <strong>Lorem Ipsum</strong>
            </p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed malesuada auctor magna. Vivamus urna justo, pulvinar nec, sagittis malesuada, accumsan in, massa. Quisque mi purus, gravida eget, ultricies a, porta in, sem. Maecenas justo elit, elementum vel, feugiat vulputate, pulvinar nec, velit. Fusce vel ante et diam bibendum euismod. Nunc vel nulla non lorem dignissim placerat. Nulla magna massa, auctor et, tempor nec, auctor sit amet, turpis. Quisque odio lacus, auctor at, posuere id, suscipit eget, dui. Phasellus aliquam. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Proin varius. Phasellus cursus. Cras mattis adipiscing turpis. Sed.</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed malesuada auctor magna.</p>
            <p>This text should not be displayed</p>
        </body>
    </entry>
</news> 
```

**产生想要的结果**：

```
<news>
   <entry>
      <title>Lorem Ipsum</title>
      <body>
         <p>
            <strong>Lorem Ipsum</strong>
         </p>
         <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed malesuada auctor magna. Vivamus urna justo, pulvinar nec, sagittis malesuada, accumsan in, massa. Quisque mi purus, gravida eget, ultricies a, porta in, sem. Maecenas justo elit, elementum vel, feugiat vulputate, pulvinar nec, velit. Fusce vel ante et diam bibendum euismod. Nunc vel nulla non lorem dignissim placerat. Nulla magna massa, auctor et, tempor nec, auctor sit amet, turpis. Quisque odio lacus, auctor at, posuere id, suscipit eget, dui. Phasellus aliquam. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Proin varius. Phasellus cursus. Cras mattis adipiscing turpis. Sed.</p>
         <p>Lorem <strong> ...more</strong>
         </p>
         <p/>
      </body>
   </entry>
</news> 
```

**请注意**以下事项：

1.  [**FXSL 库**](http://fxsl.sf.net)中的**`scanl`**样式表被导入。此模板通常用于通过处理项目列表来累积数据。执行实际处理的函数（模板匹配）作为参数传递给模板。必须传递给它的另一个参数是处理中的“初始”值，如果传递的项目列表为空，则返回该值。[](http://fxsl.sf.net)**`myAdd:*``scanl`**

***   全局参数**`$pTruncateLength`**保存文本必须被截断的最大字符串长度** 

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T17:27:23.683

这是我的版本。我已经在您的 XML 示例上对其进行了测试，并且可以正常工作。

要调用它，请使用`<xsl:apply-templates select="path/to/body/*" mode="truncate"/>`.

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:strip-space elements="*"/>

<!-- limit: the truncation limit -->
<xsl:variable name="limit" select="250"/>

<!-- t: Total number of characters in the set -->
<xsl:variable name="t" select="string-length(normalize-space(//body))"/>

<xsl:template match="*" mode="truncate">
    <xsl:variable name="preceding-strings">
        <xsl:copy-of select="preceding::text()[ancestor::body]"/>
    </xsl:variable>

    <!-- p: number of characters up to the current node -->
    <xsl:variable name="p" select="string-length(normalize-space($preceding-strings))"/>

    <xsl:if test="$p &lt; $limit">
        <xsl:element name="{name()}">
            <xsl:apply-templates select="@*" mode="truncate"/>
            <xsl:apply-templates mode="truncate"/>
        </xsl:element>
    </xsl:if>
</xsl:template>

<xsl:template match="text()" mode="truncate">
    <xsl:variable name="preceding-strings">
        <xsl:copy-of select="preceding::text()[ancestor::body]"/>
    </xsl:variable>

    <!-- p: number of characters up to the current node -->
    <xsl:variable name="p" select="string-length(normalize-space($preceding-strings))"/>

    <!-- c: number of characters including current node -->
    <xsl:variable name="c" select="$p + string-length(.)"/>

    <xsl:choose>
        <xsl:when test="$limit &lt;= $c">
            <xsl:value-of select="substring(., 1, ($limit - $p))"/>
            <xsl:text>&#8230;</xsl:text>
        </xsl:when>
        <xsl:otherwise>
            <xsl:value-of select="."/>
        </xsl:otherwise>
    </xsl:choose>
</xsl:template>

<xsl:template match="@*" mode="truncate">
    <xsl:attribute name="{name(.)}"><xsl:value-of select="."/></xsl:attribute>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T13:38:48.187

您要问的是 XSLT[**省略号**](http://en.wikipedia.org/wiki/Ellipsis)生成器。

这个[xslt 1.0 模板](http://www.dpawson.co.uk/xsl/sect4/N10301.html#d16170e189)可能会给你一些想法：

这是它的主要要点：

```
<xsl:template match="text()" mode="label">
    <xsl:param name="self-x"/>
    <xsl:param name="self-y"/>
    <xsl:variable name="text" select="normalize-space(.)"/>
    <!-- a quick and dirty way to avoid problems with line breaks -->
    <!-- replace the select attribute with this call
         if you want to use a fancier way to escape whitespace
         characters:
          <xsl:call-template name="escape-ws"
            <xsl:with-param name="text" select="." /
          </xsl:call-template
    -->
    <use xlink:href="#text-box" transform="translate({$self-x} 
 {$self-y})"/>
    <!-- text nodes are marked with a little box -->
    <text x="{$self-x + $writing-bump-over}"
          y="{$self-y - $writing-bump-up}"
          style="{$text-font-style}; stroke:none; fill:{$text-color}">
      <xsl:text>"</xsl:text>
      <xsl:value-of select="substring($text,1,$max-text-length)"/>
      <!-- truncate the text node to $max-text-length -->
      <xsl:if test="string-length($text) &gt; $max-text-length">
        <!-- add an ellipsis if necessary -->
        <xsl:text>...</xsl:text>
      </xsl:if>
      <xsl:text>"</xsl:text>
    </text>
  </xsl:template> 
```

笔记：

*   您将需要用链接替换省略号，但主要思想就在那里。
*   这仅代表[所有脚本的一小部分](http://www.dpawson.co.uk/xsl/sect4/N10301.html#d16170e189)
*   您可能不需要其中的所有内容：如果您需要“ `<use xlink:href="...`”，则需要[声明 xlink 命名空间](http://osdir.com/ml/web.svg/2004-01/msg00032.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T16:23:33.407

经过多次黑客攻击，我得出了这个解决方案：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<!--
    Author: Neil Albrock
    Version: 1.0
    Description: Truncate by a character limit and retain HTML content.
    Usage: 
        <xsl:call-template name="truncate">
            <xsl:with-param name="data" select="path/to/your/body" />
            <xsl:with-param name="length" select="250" />
            <xsl:with-param name="link" select="'href'" />
        </xsl:call-template>
-->

<xsl:template name="truncate">

    <!-- The node set to be worked on. -->
    <xsl:param name="data"/>
    <!-- The desired truncate length. Default to length of data. -->
    <xsl:param name="length" select="string-length($data)"/>
    <!-- More link -->
    <xsl:param name="link"/>

    <xsl:choose>
        <!-- Return whole data if it's within length. -->
        <xsl:when test="string-length($data) &lt;= $length">
            <xsl:copy-of select="$data" />
        </xsl:when>
        <!-- Truncate to desired length. -->
        <xsl:otherwise>
            <xsl:for-each select="$data/*">
                <xsl:variable name="this-node" select="string-length(.)"/>
                <xsl:variable name="preceding-nodes">
                    <xsl:copy-of select="preceding-sibling::*"/>
                </xsl:variable>
                <xsl:variable name="node-sum" select="string-length(normalize-space($preceding-nodes))"/>
                <xsl:variable name="limit" select="$node-sum + $this-node"/>

                <xsl:choose>
                    <xsl:when test="$limit &gt; $length and $node-sum &lt;= $length">
                        <p>
                        <xsl:value-of select="substring(.,1,$length - $node-sum)"/>
                        <xsl:text>&#8230;</xsl:text>
                        <a>
                            <xsl:attribute name="href">
                                <xsl:value-of select="$link"/>
                            </xsl:attribute>
                            <xsl:text>more</xsl:text>
                        </a>
                        </p>
                    </xsl:when>
                    <xsl:when test="$limit &lt; $length">
                        <xsl:copy-of select="."/>
                    </xsl:when>
                    <xsl:otherwise/>
                </xsl:choose>

            </xsl:for-each>
        </xsl:otherwise>
    </xsl:choose>

</xsl:template>

</xsl:stylesheet> 
```

我会使用混沌模式的解决方案，它更优雅;-)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-10T13:36:19.830

这将是使用 XSLT 的痛苦插曲。我强烈建议使用像 Perl/Python 这样的脚本语言来尝试这个。

# c# - 实现 2 个具有“同名”属性的接口

> ID：532148
> 
> 赞同：9
> 
> 时间：2009-02-10T12:45:56.410
> 
> 标签：c#, vb.net, multiple-inheritance

这似乎是一个合理的（也许很简单？）场景，但您将如何执行以下操作：

假设我有 2 个接口：

```
Interface ISimpleInterface
    string ErrorMsg { get; } 
End Interface

Interface IExtendedInterface
    string ErrorMsg { get; set; }    
    string SomeOtherProperty { get; set; }
End Interface 
```

我想要一个类来实现这两个接口：

```
Public Class Foo Implements ISimpleInterface, IExtendedInterface 
```

鉴于每个接口都有不同的访问级别，如何在类中定义 ErrorMsg 属性？

如果您想知道，这是我的场景：我正在使用伪 MVC 架构编写 UserControl，其中 UserControl 将扩展接口暴露给它的 Controller，并将 Simple 接口暴露给控件的使用者。

顺便说一句，在 VB.NET 中实现这一点（任何建议的在 vb 中的 synatx 将不胜感激）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T12:51:56.240

抱歉，我不掌握 VB.Net 语法。

在 C# 中，您可以隐式或显式实现接口。如果您的类 Foo 将 ErrorMsg 实现为公共方法，则此实现将用于两个接口。

如果你想要不同的实现，你可以显式地实现它：

```
string ISimpleInterface.ErrorMsg {get { ... } } 
string IExtendedInterface.ErrorMsg {get { ... } set { ... }} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T12:50:19.927

您可以使用“显式接口”实现来实现其中一个或两个接口，因此编译器知道哪个 ErrorMsg 属性属于哪个接口。

要做到这一点，只需在你的类名后面写下 :ISimpleInterface（对于 C#），然后单击 ISimpleInterface 并选择实现显式接口。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/aa288461 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa288461(VS.71).aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T12:52:14.210

在 C# 中，隐式实现（带有`set`）可以同时满足这两个：

```
class Foo : ISimpleInterface, IExtendedInterface
{
    public string ErrorMsg { get; set; } 
    public string SomeOtherProperty {get; set;}
} 
```

如果要更改它，可以使用显式实现（VB 中的“Implements”？） - 在 C# 中：

```
string ISimpleInterface.ErrorMsg
{
    get { return ErrorMsg; } // or something more interesting
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T12:54:52.690

在 C# 中，您可以使用显式接口实现：

```
class Foo
{
    string ISimpleInterface.ErrorMsg
    { get... }

    string IExtendedInterface.ErrorMsg
    { get... set... }

    string IExtendedInterface.SomeOtherProperty
    { get... set... }
} 
```

或接口映射

```
class Foo
{
    public string ErrorMsg
    { get... set... }       

    public string SomeOtherProperty
    { get... set... }
} 
```

至于VB.NET，它有`Implements`关键字：

```
Property ErrorMsg As String Implements ISimpleInterface.ErrorMsg

Property OtherErrorMsg As String Implements IExtendedInterface.ErrorMsg 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T13:06:28.747

VB.NET 中的 Implements 关键字使这很容易：

```
Public Interface ISimpleInterface
  ReadOnly Property ErrorMsg() As String
End Interface

Friend Interface IExtendedInterface
  Property ErrorMsg() As String
  Property SomeOtherProperty() As String
End Interface

Public Class Foo
  Implements ISimpleInterface, IExtendedInterface
  Private other As String
  Private msg As String

  Public Property ErrorMsgEx() As String Implements IExtendedInterface.ErrorMsg
    Get
      Return msg
    End Get
    Set(ByVal value As String)
      msg = value
    End Set
  End Property

  Public Property SomeOtherPropertyEx() As String Implements IExtendedInterface.SomeOtherProperty
    Get
      Return other
    End Get
    Set(ByVal value As String)
      other = value
    End Set
  End Property

  Public ReadOnly Property ErrorMsg() As String Implements ISimpleInterface.ErrorMsg
    Get
      Return msg
    End Get
  End Property
End Class 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T12:51:23.900

您将需要使用显式接口实现。更多关于这里的主题：http: [//msdn.microsoft.com/en-us/library/aa288461 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa288461(VS.71).aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T13:42:47.710

您可以让私有子例程实现接口。它仅在将对象分配给该接口类型的变量时才公开。

```
Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    End Sub

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim S As ISimpleInterface
        Dim Ext As IExtendedInterface
        Dim F As New Foo
        F.ErrorMsg = "Test Error"
        S = F
        Ext = F
        MsgBox(S.ErrorMsg)
        MsgBox(Ext.ErrorMsg)
        MsgBox(F.ErrorMsg)
    End Sub
End Class

Public Interface ISimpleInterface
    ReadOnly Property ErrorMsg() As String
End Interface

Public Interface IExtendedInterface
    Property ErrorMsg() As String
    Property SomeOtherProperty() As String
End Interface

Public Class Foo
    Implements ISimpleInterface, IExtendedInterface
    Private other As String
    Private msg As String

    Public Property ErrorMsg() As String Implements IExtendedInterface.ErrorMsg
        Get
            Return msg
        End Get
        Set(ByVal value As String)
            msg = value
        End Set
    End Property

    Public Property SomeOtherProperty() As String Implements IExtendedInterface.SomeOtherProperty
        Get
            Return other
        End Get
        Set(ByVal value As String)
            other = value
        End Set
    End Property

    Private ReadOnly Property ErrorMsgSimple() As String Implements ISimpleInterface.ErrorMsg
        Get
            Return ErrorMsg
        End Get
    End Property
End Class 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T13:54:08.617

虽然显式实现将解决这个问题，正如其他人所展示的那样，在这种情况下，我可能会让 IExtendedInterface 实现 ISimpleInterface （ErrorMsg 属性在语义上是相同的属性，我猜这两个接口的含义相同）。

```
interface ISimpleInterface
{
    string ErrorMessage { get; set; }
}
interface IExtendedInterface : ISimpleInterface
{
    string SomeOtherProperty { get; set; }
} 
```

# .net - 反转 ListBox 项目（按“无”降序排序）

> ID：532152
> 
> 赞同：4
> 
> 时间：2009-02-10T12:46:50.137
> 
> 标签：.net, wpf, sorting, listbox

`ListBox`是否可以从原始顺序对 WPF 中的项目进行反向排序？我的意思是你可以用`SortDescriptions`一些属性来排序，但是如果我只需要以相反的顺序显示项目而没有真正的字段来排序呢？

注意：我不希望对原始集合进行排序或克隆它等。我知道如何做到这一点，但我正在寻找一种`ListBox`仅用于演示的方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T19:13:53.583

这有点难看，但它会颠倒 listbox1 中 ListBoxItems 的顺序。您不能做显而易见的事情：使用单个临时变量并在每次循环迭代中交换两个元素。您会收到运行时错误，“**元素已经有一个逻辑父级。它必须先与旧父级分离，然后才能附加到新父级。** ”。

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace ReverseListbox
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            ItemCollection items = this.listbox1.Items;
            for (int i = 0, j = items.Count - 1; i < j; i++, j--)
            {
                object tmpi = items[i];
                object tmpj = items[j];
                items.RemoveAt(j);
                items.RemoveAt(i);
                items.Insert(i, tmpj);
                items.Insert(j, tmpi);
            }
        }
    }
} 
```

这是完整示例的 XAML：

```
<Window x:Class="ReverseListbox.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition />
        </Grid.RowDefinitions>
        <ListBox Name="listbox1" Grid.Row="0">
            <ListBoxItem Content="1" />
            <ListBoxItem Content="2" />
            <ListBoxItem Content="3" />
            <ListBoxItem Content="4" />
        </ListBox>
        <Button Name="button1" Grid.Row="1" Click="Button_Click" />
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T16:03:40.593

一个便宜的答案是向数据对象添加一个新的整数字段，并为每个项目增加它。然后你可以在这个字段上反向排序。我知道这可能不是一个可行的解决方案。

如果您使用集合视图进行排序，我相信您总是必须根据某些属性或条件进行排序。排序将基于实现 IComparer 的比较对象。此接口比较两个对象并确定哪个更大。除非您有某种方法可以通过比较它们来确定如何订购两个项目，否则您无法反转排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T07:03:56.127

不久前我遇到了类似的问题。我最终以类似于 Josh G 的帖子的方式解决了它，但使用了一些封装以避免污染域对象。

请参阅[此讨论主题](http://social.microsoft.com/Forums/en-US/wpf/thread/00e2013b-d7f6-4b08-9451-374a31a16c1b)。

我用于仅由 UI 使用的集合（例如日志消息）的另一种方法是首先以相反的顺序简单地插入它们，通过`collection.Insert(0, item);`.

# linux - Linux：环境变量存储在哪里？

> ID：532155
> 
> 赞同：84
> 
> 时间：2009-02-10T12:47:36.640
> 
> 标签：linux, environment-variables

如果我输入终端，

```
export DISPLAY=:0.0 
```

...存储该环境变量的外壳在哪里？

我正在使用 Ubuntu 8.10。我查看了文件 ~/.profile 和 /etc/profile 并且找不到 DISPLAY 的踪迹。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-02-10T13:17:12.780

进程的环境变量存在于运行时，而不是存储在某个文件左右。它们存储在进程自己的内存中（在那里它们被发现传递给子进程）。但是里面有一个虚拟文件

```
/proc/ *pid* /环境
```

这个文件显示了调用进程时传递的所有环境变量（除非进程覆盖了它的那部分内存——大多数程序不会）。内核通过该虚拟文件使它们可见。可以一一列举。例如查看进程 3940 的变量，可以这样做

```
cat /proc/3940/environ | tr '\0' '\n' 
```

每个变量由下一个变量的二进制零分隔。tr 将零替换为换行符。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-02-10T12:49:55.620

键入“set”，您将获得所有当前变量的列表。如果你想让一些东西持久化，把它放在 ~/.bashrc 或 ~/.bash_profile 中（如果你使用的是 bash）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-12-08T15:05:07.667

If you want to put the environment for system-wide use you can do so with `/etc/environment` file.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-10T12:50:38.520

它存储在进程（shell）中，并且由于您已将其导出，因此会产生任何进程。

执行上述操作不会将其存储在文件系统中的任何位置，例如 /etc/profile。你必须明确地把它放在那里才能发生。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-13T05:31:47.373

There is 1 file that can be used to store env variables.

> .bashrc

You can add your variables and use them. For example I have added Django virtual env as environment variable and now I can access it anywhere. Add this to your bashrc file

```
django_env='source/media/anish/Softwares/virtual_env/django2/bin/activate' 
```

now you need to restart your system to reflect changes and after restarting enter $django_env to start your virtual environment. as simple as that.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-07T22:55:58.363

As to the location of environment variables in RAM, they are stored in the top of the stack of main() function. any dynamic modification by setenv() et al. are then allocated elsewhere

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2009-02-10T12:50:12.377

该变量未存储在某些脚本中。它只是由 X 服务器脚本设置的。*您可以使用set*检查当前设置的环境变量。

# c# - 如何在 xml 文档中引用泛型类和方法

> ID：532166
> 
> 赞同：223
> 
> 时间：2009-02-10T12:50:38.833
> 
> 标签：c#, generics, reference, xml-documentation

在编写 xml 文档时，您可以使用`<see cref="something">something</see>`，当然可以。但是如何引用具有泛型类型的类或方法呢？

```
public class FancyClass<T>
{
  public string FancyMethod<K>(T value) { return "something fancy"; }
} 
```

如果我要在某处编写 xml 文档，我将如何引用花哨的类？我怎样才能引用一个`FancyClass<string>`？方法呢？

例如，在另一个类中，我想让用户知道我将返回一个`FancyClass<int>`. 我怎么能为此做一个see cref的事情？

* * *

## 回答 #1

> 赞同：288
> 
> 时间：2009-02-10T13:01:18.713

要引用该方法：

```
/// <see cref="FancyClass{T}.FancyMethod{K}(T)"/> for more information. 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2016-12-18T12:07:17.063

# TL;博士：

> *“我将如何参考`FancyClass<T>`？”*

```
 /// <see cref="FancyClass{T}"/> 
```

> *“怎么样`FancyClass<T>.FancyMethod<K>(T value)`？”*

```
 /// <see cref="FancyClass{T}.FancyMethod{K}(T)"/> 
```

> *“我怎样才能引用一个`FancyClass<string>`？”*

```
 /// <see cref="SomeType.SomeMethod(FancyClass{string})"/>
   /// <see cref="FancyClass{T}"/> whose generic type argument is <see cref="string"/> 
```

虽然您*可以引用*其签名包含的方法`FancyClass<string>`（例如作为参数类型），但您*不能*直接引用这种封闭的泛型类型。第二个示例解决了该限制。（这可以在静态[方法的](https://msdn.microsoft.com/en-us/library/dd784338(v=vs.110).aspx)[MSDN 参考页面`System.String.Concat(IEnumerable<string>)`](https://msdn.microsoft.com/en-us/library/dd784338(v=vs.110).aspx)上看到）。：

# XML 文档注释`cref`规则：

*   **用大括号`{}`**而不是`<>`尖括号包围泛型类型参数列表。这使您免于逃避后者，`&lt;`并且`&gt;`— 请记住，文档注释是 XML！

*   **如果包含前缀（例如`T:`**类型、`M:`方法、`P:`属性、`F:`字段），编译器不会对引用执行任何验证，而只是将`cref`属性值直接复制到文档 XML 输出。出于这个原因，您必须使用适用于此类文件的特殊[“ID 字符串”语法](https://msdn.microsoft.com/en-us/library/fsbx0t7x.aspx "关于 XML 文档注释 ID 字符串的 MSDN 参考页")：始终使用完全限定的标识符，并使用反引号来引用泛型类型参数（``n`在类型上，```n`在方法上）。

*   **如果省略前缀**，则适用常规语言命名规则：您可以删除存在`using`语句的命名空间，并且可以使用语言的类型关键字，例如`int`代替`System.Int32`. 此外，编译器将检查引用的正确性。

# XML 文档注释`cref`备忘单：

```
namespace X
{
    using System;

    /// <see cref="I1"/>  (or <see cref="X.I1"/> from outside X)
    /// <see cref="T:X.I1"/>
    interface I1
    {
        /// <see cref="I1.M1(int)"/>  (or <see cref="M1(int)"/> from inside I1)
        /// <see cref="M:X.I1.M1(System.Int32)"/>
        void M1(int p);

        /// <see cref="I1.M2{U}(U)"/>
        /// <see cref="M:X.I1.M2``1(``0)"/>
        void M2<U>(U p);

        /// <see cref="I1.M3(Action{string})"/>
        /// <see cref="M:X.I1.M3(System.Action{System.String})"/>
        void M3(Action<string> p);
    }

    /// <see cref="I2{T}"/>
    /// <see cref="T:X.I2`1"/>
    interface I2<T>
    {
        /// <see cref="I2{T}.M1(int)"/>
        /// <see cref="M:X.I2`1.M1(System.Int32)"/>
        void M1(int p);

        /// <see cref="I2{T}.M2(T)"/>
        /// <see cref="M:X.I2`1.M2(`0)"/>
        void M2(T p);

        /// <see cref="I2{T}.M3{U}(U)"/>
        /// <see cref="M:X.I2`1.M3``1(``0)"/>
        void M3<U>(U p);
    }
} 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2009-02-10T12:53:39.980

```
/// <summary>Uses a <see cref="FancyClass{T}" /> instance.</summary> 
```

顺便说一句，它出现在[.Net Framework 2.0](http://msdn.microsoft.com/en-us/library/acd0tfbe(VS.80).aspx)和[3.0](http://msdn.microsoft.com/en-us/library/acd0tfbe(VS.85).aspx)的 MSDN 文档中，但在[3.5 版本中消失了](http://msdn.microsoft.com/en-us/library/acd0tfbe.aspx)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2015-12-10T17:37:04.513

到目前为止，没有一个答案完全适合我。除非完全解析，否则ReSharper 不会将 see 标记转换为`Ctrl`+click-able 链接（例如）。[![图片在这里](https://i.stack.imgur.com/pq7BI.png)](https://i.stack.imgur.com/pq7BI.png)

如果 OP 中的方法位于名为 的命名空间中`Test`，则显示的方法的完全解析链接将是：

`<see cref="M:Test.FancyClass`1.FancyMethod``1(`0)"/>`

正如您可能能够解决的那样，在类类型参数的数量之前应该只有一个反引号，然后在方法类型参数的数量之前有两个反引号，然后参数是具有适当数量的反引号的零索引参数。

所以我们可以看到`FancyClass`有一个类类型参数，`FancyMethod`有一个类型参数，一个`FancyClass`参数类型的对象会被传递给方法。

正如您在此示例中更清楚地看到的那样：

```
namespace Test
{
    public class FancyClass<A, B>
    {
        public void FancyMethod<C, D, E>(A a, B b, C c, D d, E e) { }
    }
} 
```

链接变为：

`M:Test.FancyClass`2.FancyMethod``3(`0,`1,``0,``1,``2)`

或“具有两个类型参数的类，该类具有具有三个类型参数的方法，其中方法参数为`ClassType1`, `ClassType2`, `MethodType1`, `MethodType2`, `MethodType3`”

* * *

作为补充说明，我没有在任何地方找到这个文档，而且我不是天才，编译器告诉了我这一切。您所要做的就是创建一个测试项目，[启用 XML 文档](https://msdn.microsoft.com/library/x4sa0ak0%28v=vs.100%29.aspx)，然后插入您想要为其计算链接的代码，并在其上放置一个 XML 文档注释的开头（`///`）：

```
namespace Test
{
    public class FancyClass<T>
    {
        ///
        public string FancyMethod<K>(T value) { return "something fancy"; }
    }

    public class Test
    {
        public static void Main(string[] args) { }
    }
} 
```

然后构建您的项目，输出的 XML 文档在属性下的`doc`-> `members`->`member`元素中包含链接`name`：

```
<?xml version="1.0"?>
<doc>
    <assembly>
        <name>Test</name>
    </assembly>
    <members>
        <member name="M:Test.FancyClass`1.FancyMethod``1(`0)">

        </member>
    </members>
</doc> 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-10-26T11:48:07.887

进一步来自 Lasse 和 TBC 的回答：

```
/// <see cref="T:FancyClass`1{T}"/> for more information.

/// <see cref="M:FancyClass`1{T}.FancyMethod`1{K}(T)"/> for more information. 
```

还将正确提供工具提示，而他们的版本使用花括号来呈现它。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-11-10T15:54:16.620

```
/// Here we discuss the use of <typeparamref name="TYourExcellentType"/>.
/// <typeparam name="TYourExcellentType">Your exellent documentation</typeparam> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-28T15:25:26.110

```
/// <see cref="FancyClass&lt;T>.FancyMethod&lt;K>(T)"/> for more information. 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-12T22:18:31.593

这是我在其他地方给出的答案。它也适用于类和方法。

我尝试了堆栈溢出的所有内容，以获得适用于多种情况的结果。这是一个适合我的解决方案。（这对其他人来说是主观的。）

1.  产生可点击的链接。
2.  将鼠标悬停在标识符上有效。
3.  正确生成 .xml 文件。
4.  在智能感知中不会产生错误。
5.  适用于可为空的泛型类型参数。
6.  在 Resharper 中工作，它是内置的 XML Doc 窗口（Resharper -> 编辑 -> 显示快速文档）
7.  适用于 Atomineer Pro Documentaion Visual Studio Extension 的 XAM Doc Preview。
8.  适用于泛型类型的泛型类型。

示例 #1

```
 /// <summary>
  ///  This instance field holds a reference to the
  ///  <see cref="ConcurrentDictionary{Decimal, Boolean}"/> as
  ///  <see cref="T:ConcurrentDictionary&lt;decimal, bool?&gt;"/> that contains
  ///  the list of all PDF's that are currently opened and being displayed.
  /// </summary>
  private ConcurrentDictionary<decimal, bool?> openedPdfs = default!;

  Note: 
    The ConcurrentDictionary{Decimal, Boolean} will correctly produce a
    clickable link of ConcurrentDictionary{TKey, TValue} on hovering while
    T:ConcurrentDictionary&lt;decimal, bool?&gt; makes sure the reader gets
    information on what type TKey and TValue are. 
```

示例#2（使用“T”）

```
 /// <summary>
  ///  This instance field holds a reference to the
  ///  <see cref="ConcurrentDictionary{TKey, TValue}"/> as
  ///  <see cref="T:ConcurrentDictionary&lt;decimal, bool?&gt;"/> that contains
  ///  the list of all PDF's that are currently opened and being displayed.
  /// </summary>
  private ConcurrentDictionary<decimal, bool?> openedPdfs = default!; 
```

# web-services - 从 Web 服务请求中检索客户信息

> ID：532170
> 
> 赞同：0
> 
> 时间：2009-02-10T12:51:39.953
> 
> 标签：web-services, http-headers

如果我有一个请求服务的应用程序，Web 服务是否可以确定应用程序的名称，还是必须在请求中发送？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T12:56:18.303

如果应用程序设置了它，您可以使用 HTTP 请求的 UserAgent 标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T19:10:06.497

正如上面的帖子所暗示的，这必须在请求中或在标头中发送。

对于“应用程序”是什么，没有互联网标准，因此“应用程序名称”当然没有标准。

# compiler-construction - Erlang 类型系统

> ID：532176
> 
> 赞同：10
> 
> 时间：2009-02-10T12:52:20.390
> 
> 标签：compiler-construction, erlang, type-systems

我一直在网上四处寻找 Erlang 程序的各种打字实践，似乎有一些……尽管找到可靠的信息来源有点困难，即我正在寻找有关以下方面的实用信息：

1\. `-specs`- 这个看起来很有吸引力。一些地方提到在编译时检查具有关联的 -specs 指令的函数（以确保正确的类型使用）......我似乎无法找到有关如何使用它的更多信息（使用哪个工具 - Dialyzer，打字机？）。我真的很想创建一个小的解析器/代码生成器，它可以从表单的函数声明中生成这些“规范”

```
functionName(param1 :List, param2 :Tuple) -> ... 
```

我还没有看到是否`-spec`支持抽象类型（用户声明的类型 - “汽车”类型 -

```
{car,{weight,_},{height,_},{maxSpeed,_}} 
```

2.[这里提到的](http://www.sics.se/~joe/bluetail/vol1/v1_oo.html)`-deftype`指令

如果我可以开始输入内容并在编译时检查它们，Erlang 对我来说将变得更加强大。我上面提到的解析器/代码生成的运行时将在输出源代码中生成保护类型检查。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T14:15:52.497

有关 type 和 spec 属性的更多信息在这里：

[http://www.erlang.org/eeps/eep-0008.html](http://www.erlang.org/eeps/eep-0008.html)

透析器可用于检查它们（参见`dialyzer --help`）。

Typer 可用于生成它们（请参阅 参考资料`typer --help`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-06-07T11:28:38.573

看看 [http://learnyousomeerlang.com/types-or-lack-thereof](http://learnyousomeerlang.com/types-or-lack-thereof) （非常清晰的解释）和这​​里的参考：http: [//erlang.org/doc/reference_manual/typespec.html](http://erlang.org/doc/reference_manual/typespec.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T07:33:53.237

编译时类型检查不是 Erlang 完成的事情。而是使用执行编译后类型检查的 Dialyzer。

您创建“用户定义类型”的方式是按照您的建议使用标记的元组。Dialyzer 将检查代码路径以识别可能最终创建失败的函数返回的代码路径。

为了使透析器发挥最佳效果，您必须接受“如果失败就让”，并且只编写与预期结果匹配的子句 - 避免始终匹配的“其他”结构和其他一些最佳实践。

你应该用 edoc 记录你的函数。透析器使用文档系统的类型规范为您推断类型。可以在[此处](http://erlang.org/doc/apps/edoc/index.html)找到 edoc 手册。

# oracle - 如何使用 Oracle SSO 强制每个用户进行一次且唯一的并发登录？

> ID：532177
> 
> 赞同：0
> 
> 时间：2009-02-10T12:52:33.010
> 
> 标签：oracle, single-sign-on

好的，审核员来敲门了，我知道他们的标准“暴露”之一是您的应用程序是否允许同一用户同时登录。

让我们暂时搁置对风险的量化...

我正在使用的应用程序使用 Oracle SSO 来管理身份验证，据我所知，它没有为此提供开箱即用的解决方案。

我正在寻找建议——要么是一种可以制作标准产品来支持这个要求的方式，要么是最可维护、最无干扰的定制来做同样的事情。

感谢您对此事的任何想法...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:20:44.237

忽略 SSO 部分，您会将用户添加到限制活动会话数的配置文件中。

```
ALTER PROFILE app_user LIMIT SESSIONS_PER_USER 1; 
```

我不知道 SSO 增加了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T19:30:42.660

您可以通过登录触发器限制用户。让触发器在数据库中查询属于用户的会话。如果用户已经登录错误并注销当前会话。

# javascript - GPL、javascript 和在线游戏

> ID：532187
> 
> 赞同：1
> 
> 时间：2009-02-10T12:54:45.033
> 
> 标签：javascript, licensing, gpl, interpreter

我正在为 80 年代的山脉冒险游戏开发 javascript 中的游戏解释器。我移植了名为 Sarien 的现有逆向工程 C 解释器的一部分，它是 GPL 许可的。使我的工作也成为 GPL。到现在为止还挺好。

但是，我的目标是创建一个网站，让人们可以在线玩这些游戏，并增加多人游戏支持。多人游戏需要客户端+服务器代码，多人游戏部分是专有的封闭（商业）代码。那也必须是GPL吗？

我知道其他人在这里问过 GPL 问题，但它通常涉及嵌入、链接等，让我更容易理解。我的设置是基于 javascript 的。我可以将核心解释器代码分发为 GPL 并添加一个单独的 javascript 层，该层挂钩到 IO 部分（以使多人游戏成为可能）而不是 GPL 那部分？

我非常愿意以 GPL 的形式贡献我的所有工作，但多人游戏引擎的某些部分根本不是我可以决定的。如果 GPL 强迫我做一切 GPL 那么它禁止我添加多人游戏，因此阻碍了制作一些很酷的东西:-(

更新：

原始解释器代码 - GPL 许可 - 已合并到 ScummVM 中。解释器文件现在在标题中显示 GPL 版本 2 或更高版本适用于最终用户认为合适的情况。这有什么改变吗？作为旁注；是否允许以这种方式修改许可证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T13:47:42.003

*未修改的*代码很好。比如：静态链接，因为它需要修改源代码，创建衍生作品，需要一些思考。另一方面，动态链接只是按预期使用 GPL 代码（在您的代码和 GPL 代码之间创建临时关系）——因为 GPL 代码不需要为此进行修改。

[这](http://www.sitepoint.com/article/public-license-explained/)比我能解释得更好。问题是：您是修改原始 GPL 代码，还是仅按照设计使用的方式使用它？如果是后者，你可能没问题。但如果可以的话，请与原作者联系，这只是礼貌！

**编辑：**如果你所有的代码都是 Javascript，你基本上不是给*每个人都*提供源代码吗？:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T10:29:24.020

GPL 网络浏览器是否允许您浏览由 IIS 提供服务的站点？当然。SAMBA 客户端可以连接 Windows 文件服务器吗？再次是的。开源客户端可以与闭源服务器通信。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T14:43:30.340

你可能需要和律师谈谈。我不是一个。

然而，GPL 归结为分发许可证。GPL v2 没有说明在您的服务器上运行的代码，所以如果您不“分发”代码，那么它不需要是 GPL。例如，最终用户可以将专有视频驱动程序和 Linux 内核组合在一起，但通常禁止人们分发组合的工作。

但是，传输到客户端的代码可以说是正在分发，因此所有这些代码都必须获得兼容许可，无论是全部专有的还是全部 GPL 或其他。

GPL 根据版权法为您提供额外的好处。如果你不制作副本，你可以做你想做的事。

注意：还有其他 GPL-ish 变体（除了 v2）认为托管公共应用程序是“分发”的。仔细阅读您的许可证。准确定义哪些部分属于哪些许可证，哪些部分将组合在一起，哪些部分将分发。如果您不确定，请咨询律师（哎呀，即使您确定）。

另外，作为一个挑剔的人，我会说说“GPL ......阻碍了使某些东西变得很酷”是错误的或具有误导性的。您可以很容易地说“专有许可证阻碍了制作很酷的东西”。多人代码具有不兼容的许可证不是 GPL 的错。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-10T13:33:12.490

恐怕 GPL 代码不能在没有 GPL 许可的应用程序/系统中使用。您对此无能为力。即使这两个部分之间有明显的分隔也是不允许的。

我建议您联系 GPL 代码的作者，说明情况并申请不同的许可证。问题是可能很难找到所有这些，这是重新许可所必需的。这是 GPL 许可的一个众所周知的问题。

# sql - 在集合中的项目数非常大的 WHERE 子句中使用“IN”

> ID：532192
> 
> 赞同：15
> 
> 时间：2009-02-10T12:55:50.537
> 
> 标签：sql, sql-server, ms-access

我有一种情况，我需要对一组非常大的行进行更新，我只能通过他们的 ID 来识别（因为目标记录是由用户选择的，除了它是用户的记录集之外没有任何共同点想修改）。所有这些记录都在更新相同的属性，所以我想进行一次 UPDATE 调用。

这是不好的做法，还是有比在 UPDATE 语句中使用“WHERE IN (1,2,3,4,.....10000)”更好的方法来执行此更新？

对每条记录使用单独的更新语句并将它们粘贴到单个事务中是否更有意义？现在我正在使用 SQL Server 和 Access，但如果可能的话，我想听到更广泛的跨任何关系数据库的最佳实践解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T12:57:34.200

另一种选择是将这些数字存储在临时表中并在连接中使用它来进行更新。如果您能够执行一条更新语句肯定比每条记录执行一条语句要好。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-10T12:59:58.950

我会一直使用

```
WHERE id IN (1,2,3,4,.....10000) 
```

除非您的 in 子句非常**大**，这不应该从用户输入中真正发生。

编辑：例如，Rails 在幕后做了很多

在单个事务中执行单独的更新语句肯定不会更好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T13:10:45.743

如何生成 IN 子句？

如果有另一个 SELECT 语句生成这些值，您可以简单地将其插入到 UPDATE 中，如下所示：

```
UPDATE TARGET_TABLE T
SET
  SOME_VALUE = 'Whatever'
WHERE T.ID_NUMBER IN(
                    SELECT ID_NUMBER  --this SELECT generates your ID #s.
                    FROM SOURCE_TABLE
                    WHERE SOME_CONDITIONS
                    ) 
```

在某些 RDBMses 中，您将通过使用 EXISTS 语法获得更好的性能，如下所示：

```
UPDATE TARGET_TABLE T
SET
  SOME_VALUE = 'Whatever'
WHERE EXISTS (
             SELECT ID_NUMBER  --this SELECT generates your ID #s.
             FROM SOURCE_TABLE S
             WHERE SOME_CONDITIONS
               AND S.ID_NUMBER =  T.ID_NUMBER
             ) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T12:59:54.037

在 Oracle 中，可以放入 IN 子句的值是有限的。因此，您最好使用 OR ， x=1 或 x=2 ...据我所知，这些不受限制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T13:02:36.527

我会使用表变量/临时表；将值插入其中，并加入其中。然后您可以多次使用同一组。如果您（例如）将 ID 的 CSV 作为 varchar 传递，这将特别有效。作为 SQL Server 示例：

```
DECLARE @ids TABLE (id int NOT NULL)

INSERT @ids
SELECT value
FROM dbo.SplitCsv(@arg) // need to define separately

UPDATE t
SET    t. // etc
FROM   [TABLE] t
INNER JOIN @ids #i ON #i.id = t.id 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T13:40:39.133

在不知道“非常大”数量的 ID 可能是多少的情况下，我冒险猜测一下。;-)

由于您将 Access 用作数据库，因此 ID 的数量不会*那么*高。假设我们谈论的数字少于 10,000 个，并且我们应该知道容纳 ID 的容器的限制（前端使用什么语言？），我会坚持一种`UPDATE`说法；如果那是最易读且最容易在以后执行维护的。否则，我会使用一些巧妙的逻辑将它们分成多个语句。类似于将语句拆分为多个语句，每个语句的 ID 为一个、十个、一百个、千个。

然后，我会把它留给数据库优化器来尽可能高效地执行语句。我可能会对查询/查询进行“解释”，以确保没有任何愚蠢的事情发生。

但根据我的经验，将这种优化留给数据库管理器本身通常是可以的。花费最多时间的一件事通常是与数据库的实际连接，因此如果您可以在同一个连接中执行所有查询，则通常没有问题。`UPDATE`确保在开始调查之前发送所有语句并等待任何结果集返回。:-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T14:26:59.867

一般来说，有几件事情需要考虑。

1.  语句解析缓存在数据库中。每个语句，在 IN 子句中具有不同数量的项目，必须单独解析。您正在使用绑定变量而不是文字，对吗？
2.  某些数据库对 IN 子句中的项目数有限制。对于 Oracle，它是 1000。
3.  更新时锁定记录。如果您有多个单独的更新语句，则可能会出现死锁。这意味着您必须注意发布更新的顺序。
4.  到数据库的往返延迟可能很高，即使对于非常快的语句也是如此。这意味着一次处理大量记录以节省行程时间通常会更好。

我们最近更改了系统以限制 in-clause 的大小并始终使用绑定变量，因为这减少了不同 SQL 语句的数量，从而提高了性能。基本上，如果 in-clause 超过一定大小，我们会生成 SQL 语句并执行多个语句。我们不会为更新执行此操作，因此我们不必担心锁定问题。你会。

使用临时表可能不会提高性能，因为您必须使用 ID 填充临时表。实验和性能测试可以在这里告诉你答案。

单个 IN 子句非常容易理解和维护。这可能是您首先应该担心的问题。如果您发现查询的性能很差，您可能想尝试不同的策略，看看是否有帮助，但不要过早优化。IN 子句在语义上是正确的，所以如果它没有被破坏，请不要理会它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T15:10:42.537

如果您使用的是 Oracle，我建议您使用类似于 Marc Gravell 的帖子的表函数。

```
-- first create a user-defined collection type, a table of numbers
create or replace type tbl_foo as table of number;

declare
  temp_foo tbl_foo;
begin
  -- this could be passed in as a parameter, for simplicity I am hardcoding it
  temp_foo := tbl_foo(7369, 7788);

  -- here I use a table function to treat my temp_foo variable as a table, 
  -- and I join it to the emp table as an alternative to a massive "IN" clause
  select e.*
    from emp e,
         table(temp_foo) foo
   where e.empno = foo.column_value;
end; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-09-24T15:24:19.697

有多种方法可以在 where 条件下容纳大量值

1.  **使用临时表**

将值插入到具有单列的临时表中。

在该特定列上创建一个 UNIQUE INDEX。

将所需表与新创建的临时表进行 INNER JOIN

2.  **在 SQL Server 中使用类似数组的功能**

    SQL 确实支持类似数组的功能

检查[此](https://www.sqlshack.com/implement-array-like-functionality-sql-server/)链接以获取完整文档。

示例语法：

```
Create TABLE #IDs (id int NOT NULL)
DECLARE @x varchar(max) = '' 
DECLARE @xParam XML;
SELECT @xParam = CAST('<i>' + REPLACE(@x, ',', '</i><i>') + '</i>' AS XML)
INSERT into #IDs
SELECT x.i.value('.','NVARCHAR(100)') as key FROM @xParam .nodes('//i') x(i)
CREATE UNIQUE INDEX IX_#IDs ON #IDs (ID ASC) 
```

查询使用

```
SELECT A.Name, A.Age from Table A INNER JOIN #IDs id on id.id = A.Key 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-11T21:57:48.773

我不知道您的 IN 列表中的值类型。如果它们是 1 到 10,000 之间的大部分值，您可能能够处理它们以获得类似的结果：

```
WHERE MyID BETWEEN 1 AND 10000 AND MyID NOT IN (3,7,4656,987) 
```

或者，如果 NOT IN 列表仍然很长，则处理该列表并生成一堆 BETWEEN 语句：

```
WHERE MyID BETWEEN 1 AND 343 AND MyID BETWEEN 344 AND 400 ... 
```

等等。

最后，如果您使用直通查询，您不必担心 Jet 将如何处理 IN 子句。您不能在代码中执行此操作，但您可以保存一个定义为直通的 QueryDef，并在运行时更改代码中的 WHERE 子句以使用您的 IN 列表。然后它全部传递给 SQL Server，SQL Server 将决定如何处理它。

# version-control - 对于一个单独的开发人员来说，一个错误跟踪工具有多重要，我应该看看哪个与 VCS 一起看？

> ID：532194
> 
> 赞同：10
> 
> 时间：2009-02-10T12:56:45.247
> 
> 标签：version-control, bug-tracking

这可能是一个愚蠢的问题，但如果我是一个孤独的开发人员并且只打算在我的开发笔记本电脑上工作，那么使用错误跟踪软件有多重要？我目前正在争论使用 Subversion 还是 SourceGear Vault 作为我选择的 VCS，SourceGear 有一个集成的错误跟踪器（Fortress），而 Subversion 世界倾向于使用像 Trac 这样的东西。

现在，我打算将我的笔记本电脑用于家庭和工作项目（我自己订阅了 MSDN，并且看到工作太便宜而无法给我买任何东西，我将在我的笔记本电脑上编写他们的软件以使用它；我们在我的合同中明确规定，我拥有我编写的所有代码，就好像我是一名顾问一样，尽管我是一名 FTE），并且在工作中我将设置 Subversion，因为它是免费的并且没有预算（所以我想这意味着我也应该在家里使用 SVN）。软件完成后，错误跟踪器可能有助于在工作中跟踪事物，但是对于个人用途呢？

请记住，我的笔记本电脑仅用于开发，所以我担心如果我把 SVN 放在上面（毕竟要把那个 repo 与工作分开）然后是 Trac 或其他东西，我会转向它变成一个迷你服务器，还是这是一件好事？而且我什至还没有研究过 CI 解决方案，但老实说，如果您只使用一台机器，我看不出 CI 的意义。这可能会在未来发生变化，但目前我所有的工作都将在这台笔记本电脑上完成。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T13:02:18.337

无论您是否单独工作，VCS 都很重要。

真的，当您意识到自己犯了一个错误并想要回滚到昨天或今天早上的内容时，它应该在那里，或者您可能只是在实施中做出了不同的决定并想要分支所以您可以在不影响您目前所写内容的核心的情况下进行测试。

总而言之，拥有它是一件好事。你最好是安全而不是抱歉。

至于错误跟踪器，这更多是您的个人喜好。我喜欢Redmine，它集成了SVN、git等。其他人更喜欢Trac。但无论哪种方式，它们都可以在您的笔记本电脑上运行，同时占用最少的资源。尤其是当您认为您是唯一使用它们的人时。

我会查看[http://bitnami.org/](http://bitnami.org/)他们提供打包的 Bug Tracker，您只需执行它，它就会在您选择的端口上启动自己的小型服务器，并且您可以在不使用它时停止它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T21:23:03.843

除了本地存储库和/或跟踪器/规划器之外，您可能还需要考虑使用在线存储库和/或跟踪器/规划器。这是风险管理的另一个阶段，如果将来有其他人加入您的团队，您只需授予他们访问权限即可扩大规模。

一些选项：

源代码管理（在线）：

*   [Assembla](http://www.assembla.com/) - 公共资源是免费的，私人存储库是付费的
*   [Source Forge](http://sourceforge.net/) - 仅开源
*   [Google 代码](http://code.google.com/hosting/)- 仅开源
*   [Git Hub](http://github.com/) - 公共源是免费的，私人存储库是付费的
*   [Bit Bucket](http://www.bitbucket.org/) - 最多 5 个贡献者的无限私人仓库，如果您邀请朋友，则为 8 个

错误跟踪/项目管理

*   [LightHouse](http://lighthouseapp.com/) - 无限开源，付费私人项目
*   [FogBugz](http://www.fogcreek.com/FogBUGZ/) - 完整版最多可供两个开发人员免费使用
*   [BaseCamp](http://www.basecamphq.com/) - 仅付费
*   [Trac](http://trac.edgewall.org/) - 未托管（尽管 Assembla 托管它），开源 - Python
*   [Bugzilla](http://www.bugzilla.org/) - 未托管，开源 - Perl
*   [Mantis](http://www.mantisbt.org/) - 非托管，开源 - PHP

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T13:07:09.230

我认为您应该选择[FogBugz](http://www.fogbugz.com)。它是在线的，对 2 个开发人员免费，它与您的源代码控制集成。我认为错误跟踪在项目管理方面仅次于源代码控制，尤其是对于单个开发人员而言。您需要能够知道何时修复了所有报告的错误，以便您可以预测功能等的发货日期等。

自动化构建过程将减轻您的巨大负担，以便能够按需创建软件（以防删除等）。CI 过程可能有点矫枉过正，但自动构建规则。

如果你担心把它放在你的笔记本电脑上但仍然想自己动手，你可以去[slicehost](http://www.slicehost.com)并以每月 20 美元的价格在线获得一个用于 subversion/trac 解决方案的 ubuntu 盒子。我这样做是为了我的一些个人项目......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T13:02:04.420

Subversion 和 Trac 不会占用您太多的系统资源，尤其是当它们只是坐在那里等待您使用它们时。

我正在做一个小项目，只有 2 个全职开发人员，但我发现我使用我们的错误跟踪软件（在我们的例子中是 Jira，类似于 Bugzilla），甚至只是为了跟踪我自己的错误和问题。比稍后有时间处理错误时尝试记住错误的细节更容易，并且在解决问题后检查问题是一种非常令人满意的感觉。

在你的情况下，我会坚持一些简单的事情，如果你不想花费太多的开发时间来设置一个专用的系统，即使只是 Outlook 中的一个专用的待办事项列表也可能就足够了。重要的是有一种方法可以确定您已经解决了所有报告的错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T20:58:38.753

错误跟踪器的真正价值在于您不会忘记任何需要修复的东西。如果你们只有一个人，这可能更重要，就好像还有更多人一样，因为没有其他人可以提醒你忘记了什么。我记得过去的一个项目，我们有一个简单的打字错误，只有一个应用程序开发人员（我是 db 开发人员），而在 CEO 提出的那天和几个月里，他没有时间去做后来，当 CEO 注意到它还在那里时，他开始弹道了。当你在处理一大堆任务和可能的错误时，很容易忽略一些东西（尤其是你认为微不足道的东西）。那次事件导致我们获得了一个错误跟踪器，并将所有任务都放入其中，而不仅仅是错误，这是我们做过的最好的事情之一。当客户想要新的东西时，可以对他说：“这是我目前的任务清单。与这些东西相比，它有多重要？” 使它物有所值，尤其是当您是唯一的人时。它将帮助您制定时间估算，并为您提供一个记录有关该任务的讨论和决定的地方，因此没有人可以稍后再回来说他们不知道您会这样做。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-08-24T20:44:25.573

虽然不是一个明确的错误跟踪器，但您可以使用[tiddlywiki](http://www.tiddlywiki.com)，它是一个独立的 HTML 文件中的很棒的 wiki，这使得它很容易受到版本控制。

我之所以提到这一点，是因为迟早，除了错误列表之外，您还需要做笔记。

希望这可以帮助

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T20:46:16.537

我同意 JPunyon 的观点，即您应该使用[Fogbugz](http://www.fogbugz.com)进行错误跟踪。我将 if 用于我的个人资料，它很棒。如果您自己一个人，则错误跟踪器不是必需的（尽管很有用），但源代码控制是必不可少的。我现在选择的产品是[Perforce](http://www.perforce.com)，它提供了一个功能齐全的 2 用户副本，您可以下载和使用。它占用的资源非常少，并且在您升级机器时很容易转移。有一点学习曲线，但值得。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-03T12:14:49.817

如果您在笔记本电脑上开发，您可能经常离线工作（我愿意）。考虑使用不需要互联网连接即可运行的错误跟踪器。您可以查看[Artifacts](http://www.versioned.com/artifacts/) - 简单、离线工作并具有 Visual Studio 集成。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T21:35:56.060

提到他有一个msdn订阅。虽然它不是我最喜欢使用的版本控制系统，但 Sourcesafe 非常易于设置和使用，如果他是唯一使用它的人（听起来很像），这也是一个不错的解决方案。

是的，您想使用一些东西来跟踪错误，即使它只是 Excel（或）中的一个简单列表，这样您就可以跟踪哪些问题仍然存在以及哪些问题已修复。我以前在我从事的小项目上做过。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-10-04T16:01:07.673

你应该看看[Fossil](http://fossil-scm.org)。它是一个现代分布式（开源）版本控制系统，可在 Windows、Linux 和 Mac 上运行。它还具有集成的 Bug Tracker 和 Wiki。[它是由创建SQLite](http://sqlite.org)的同一个人 D. Richard Hipp 博士创建的。而且，事实上，它利用 SQLite 作为版本控制系统、错误跟踪器和 Wiki 的底层存储系统。

Fossil 专为满足小型开发团队或个人开发人员的需求而设计，并且做得非常出色。但是，根据具体情况，它也可以很好地用于更大的开发团队（例如，它被用于 SQLite 的开发）。

（我知道这是一个老问题，但大约六个月前我遇到了 Fossil，并且已经成为它的忠实粉丝（来自 CVS -> SVN -> Hg -> Bzr -> Git 在过去 15 年）我自己的工作，以及工作中的团队。）

# c# - 使用 C# 合并 Excel 中的单元格

> ID：532199
> 
> 赞同：42
> 
> 时间：2009-02-10T12:58:55.927
> 
> 标签：c#, excel

我有一个包含 5 个表的数据库。每个表包含 24 行，每行包含 4 列。

我想在 Excel 工作表中显示这些记录。每个表的标题是表的名称，但我无法合并标题列。

请帮我。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-02-10T13:10:54.773

使用 Interop，您可以获得一系列单元格并`.Merge()`在该范围内调用方法。

```
eWSheet.Range[eWSheet.Cells[1, 1], eWSheet.Cells[4, 1]].Merge(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-06T04:30:52.177

```
oSheet.get_Range("A1", "AS1").Merge(); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-07-13T09:05:50.020

```
Excel.Application xl = new Excel.ApplicationClass();

Excel.Workbook wb = xl.Workbooks.Add(Excel.XlWBATemplate.xlWBATWorkshe et);

Excel.Worksheet ws = (Excel.Worksheet)wb.ActiveSheet;

ws.Cells[1,1] = "Testing";

Excel.Range range = ws.get_Range(ws.Cells[1,1],ws.Cells[1,2]);

range.Merge(true);

range.Interior.ColorIndex =36;

xl.Visible =true; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-25T10:55:38.520

代码片段

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private Excel.Application excelApp = null;
    private void button1_Click(object sender, EventArgs e)
    {
        excelApp.get_Range("A1:A360,B1:E1", Type.Missing).Merge(Type.Missing);
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        excelApp = Marshal.GetActiveObject("Excel.Application") as Excel.Application ;
    }
} 
```

谢谢

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-08T17:55:15.047

这以适当的方式解决了问题

```
// Merge a row
            ws.Cell("B2").Value = "Merged Row(1) of Range (B2:D3)";
            ws.Range("B2:D3").Row(1).Merge(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-02T17:11:31.207

你可以使用 NPOI 来做到这一点。

```
Workbook wb = new HSSFWorkbook();
Sheet sheet = wb.createSheet("new sheet");

Row row = sheet.createRow((short) 1);
Cell cell = row.createCell((short) 1);
cell.setCellValue("This is a test of merging");

sheet.addMergedRegion(new CellRangeAddress(
        1, //first row (0-based)
        1, //last row  (0-based)
        1, //first column (0-based)
        2  //last column  (0-based)
));

// Write the output to a file
FileOutputStream fileOut = new FileOutputStream("workbook.xls");
wb.write(fileOut);
fileOut.close(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-07-28T11:26:04.177

You can use Microsoft.Office.Interop.Excel:

`worksheet.Range[worksheet.Cells[rowNum, columnNum], worksheet.Cells[rowNum, columnNum]].Merge();`

You can also use NPOI:

```
var cellsTomerge = new NPOI.SS.Util.CellRangeAddress(firstrow, lastrow, firstcol, lastcol);
_sheet.AddMergedRegion(cellsTomerge); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-17T14:01:04.567

取一个字符串列表

```
List<string> colValListForValidation = new List<string>(); 
```

并在任务之前匹配字符串。它将帮助您 bcz 所有合并单元格将具有相同的值

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-18T01:35:40.290

试试看。

```
ws.Range("A1:F2").Merge(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-12T14:57:20.597

```
Worksheet["YourRange"].Merge(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-27T23:47:57.230

```
using Excel = Microsoft.Office.Interop.Excel;
// Your code...
yourWorksheet.Range[yourWorksheet.Cells[rowBegin,colBegin], yourWorksheet.Cells[yourWorksheet.rowEnd, colEnd]].Merge(); 
```

Row 和 Col 从 1 开始。

# java - 如何实际使用 Swing 应用程序框架？

> ID：532201
> 
> 赞同：10
> 
> 时间：2009-02-10T12:59:11.293
> 
> 标签：java, swing, swing-app-framework

我想学习如何有效地使用[Swing Application Framework](https://appframework.dev.java.net/)。我发现的大多数示例都是博客条目，它们只是解释了扩展 SingleFrameApplication 并覆盖其启动方法的好处，但仅此而已。[Sun 的文章](http://java.sun.com/developer/technicalArticles/javase/swingappfr/)已有将近两年的历史，[项目本身的介绍](https://appframework.dev.java.net/intro/index.html)也是如此，从那时起显然有一些演变。

是否有任何最新的和详尽的教程/HOWTOs 可用？当然有 JavaDoc，但很难从那里获得全局。任何指针表示赞赏。

**更新：**我意识到项目站点上有一个[邮件列表存档](https://appframework.dev.java.net/servlets/SummarizeList?listName=users)。虽然有些笨拙（与 StackOverflow 相比；），但它似乎非常活跃。仍然很遗憾，任何地方都没有真正的教程。信息散布在各处。

**更新 2：**让我澄清一下 - 我在使用 Swing（小部件工具包）本身时没有遇到问题，我说的是它的*Application Framework*，它应该可以简化应用程序生命周期（启动、退出以及它们之间发生的任何事情）之类的事情、动作管理等 - 即大多数 Swing 应用程序都需要的东西。让这样的框架成为[Java 的标准部分](http://tech.puredanger.com/java7#jsr296)很酷。唯一的问题是了解它的用途。

**更新 3：**对于感兴趣的人，在项目论坛上刚刚讨论了 JSR 296 的当前状态和未来。不久：当前版本 1.03 被认为是相当可用的，**但**API 不稳定，**它将**更改为Java 7 中的最终版本。包名称也将更改，因此 Java 7 不会破坏在 SAF 上创建的当前应用程序。

**更新 4：** Karsten Lentzsch 在上述论坛上表示：“我怀疑它是否可以包含在 Java 7 中；我会投反对票。”。我宁愿不质疑这位伟大大师的诚意，不让任何有缺陷的东西溜进核心 JDK 肯定是明智之举，但坦率地说，这是一个奇怪的情况——他是 JGoodies Swing Suite 的作者，该套件在一定程度上是 JDK 的商业竞争对手JSR 296，*他*是委员会的成员，该委员会将决定是否将这个 JSR 包含到标准 Java 中。我之前写过的 JSR 295 [Beans Binding也是如此。](https://stackoverflow.com/questions/510655/jgoodies-binding-vs-jsr-295)

鉴于 SAF 的当前状态，我认为最好的解决方案是将当前实现包装到一个“自制”框架中，然后该框架可以适应对现有 API 的可能更改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T23:17:36.393

首先，我个人的建议是不要使用最新版本的 SAF，这更像是“正在进行重构”（现在已经 6 个月没有发展了......）

我更喜欢“1.03”版本，虽然不完美，但更加稳定和可用（我的意思是在现实生活中的应用程序中）。

的确，关于 SAF 的资源是稀缺的。我记得我沿着这条路走：

*   阅读有关它的[JavaOne 2007 研讨会](http://developers.sun.com/learning/javaoneonline/2007/pdf/TS-3942.pdf) ；这给出了一个很好的关于它的图片

*   使用它并在需要时阅读 javadoc

*   有时会查看源代码以缓解 javadoc 的不足

邮件列表目前不是很活跃（但真正的流量自年初以来刚刚重新开始一点点，但是，自 2008 年 8 月或 9 月以来我没有看到任何 Sun 代表！）

去年，在与 SAF 进行了大约一年的练习后，我在 Jazoon'08 上做了一个演讲，你可以[在我的博客上](http://jfpoilpret.blogspot.com/search/label/Jazoon)找到幻灯片。该演示文稿更多地是关于我在使用该框架时收集的提示和技巧。

有时我也不得不自己修补一些问题，因为许多问题是长期存在的（有些对我来说不重要，还有一些其他问题）。

我记得在瑞典的一次会议上看到（未参加）关于 SAF 实践的另一个演讲，抱歉无法记住更多细节。也很有趣。

这几乎就是它的存在（据我所知）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T13:27:49.523

[Netbeans 6.5](http://www.netbeans.org/)具有可以为您提供良好启动的框架应用程序。只需在 IDE 中创建一个新项目，然后选择 Java > Java Desktop Application。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T13:03:44.200

从来没听说过。我决定在它成熟（或死亡）之前避免使用摇摆应用程序框架。我决定改用**jgoodies**库来等待 Sun 为摇摆开发者做点什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T13:11:02.637

您可以查看[SwingWiki](http://www.swingwiki.org/)，其中包含一系列最佳实践和教程，尽管它已经有大约两年没有更新了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T22:40:45.683

虽然过去两年 Swing 确实发生了一些演变，但基本面并没有太大变化。我将从 Sun 自己的教程开始。

如果您想要书籍，那么通常的嫌疑人（McGraw Hill，O'Reilly）和其他知识渊博的人可以提供大量书籍。有些书用它的旧名称“Java 基础类”或 JFC 来引用 Swing。

# asp.net - 在 IIS7 中配置 ASP.NET

> ID：532203
> 
> 赞同：3
> 
> 时间：2009-02-10T12:59:20.810
> 
> 标签：asp.net, iis-7, configuration

有没有办法在 IIS7 中配置 ASP.NET？

我知道这一定是个愚蠢的问题，但在 IIS7 中我看到了一个 ASP 图标。这是经典 ASP 的配置吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T13:11:07.100

IIS 7 与以前的版本有很大不同，尤其是在 ASP.NET 方面。

在以前的版本中，ASP.NET 运行时是一个单独的 DLL 和单独的进程，而在 IIS7 中，ASP.NET 运行时已集成到核心 IIS 服务器中。

IIS7 还包括对“经典”ASP 的支持，因此您看到的简称为“ASP”的图标将用于“经典”ASP 配置。应该有一个单独的部分用于 ASP.NET 配置。

请注意，所有 IIS7 和 ASP.NET 配置现在都通过 .config 文件完成（例如 ASP.NET 中的 machine.config 和 web.config）。

以下链接应提供更多信息：

[IIS 配置参考](http://www.iis.net/configreference)

[ASP.NET 与 IIS7 的集成](http://learn.iis.net/page.aspx/243/aspnet-integration-with-iis7/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T13:12:00.560

检查是否启用了 ASP.Net 功能。以下是[如何验证它的说明](http://dotnetwithme.blogspot.com/2009/01/iis-7-enabling-aspnet-on-vista.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T13:06:36.737

您是否在 IIS7 中安装了 ASP.NET？默认情况下可能未安装它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T13:04:43.043

你到底想配置什么？

在 IIS 管理器中有一个 ASP.NET 的完整部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-15T11:13:33.107

使用 .net 功能部署 IIS7 的快速方法

1.  安装 IIS 7.0
2.  在 IIS 中设置网站/添加新网站，例如默认可以做
3.  选择默认页面，例如 c:\mywebfolder，调整默认站点的路径。
4.  分配 IP 或在 localhost 中运行
5.  打开命令提示符 c:\windows\microsoft.net\framework\v4.0.30319\aspnet_iisreg.exe -i 这将开始安装 .aspx（v2 或 v4）的首选编译器
6.  在 IIS 中重新启动 Web 服务
7.  恭喜！！！打开您的浏览器并观看 Aspx Web 服务器已准备好运行！！

# asp.net - .Net 中是否有内置的 URL 类？

> ID：532210
> 
> 赞同：0
> 
> 时间：2009-02-10T13:00:14.940
> 
> 标签：asp.net

我花时间将 URL 分解成`protocol://domain:port/path/filename`，但必须有一个内置类，我能找到的只有`System.Security.Policy.Url`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T13:01:41.613

我敢打赌[System.Uri](http://msdn.microsoft.com/en-us/library/system.uri.aspx)就是你要找的东西

# .net - 如何清除HttpWebRequest的缓存

> ID：532211
> 
> 赞同：29
> 
> 时间：2009-02-10T13:00:24.723
> 
> 标签：.net, caching, httpwebrequest

我正在针对专有库进行开发，并且遇到了`HttpWebRequest`. 该库使用与以下代码等效的代码来发出请求：

```
var request = WebRequest.Create("http://example.com/") as HttpWebRequest;

request.CachePolicy = new HttpRequestCachePolicy(HttpRequestCacheLevel.CacheIfAvailable); 
```

尽管每个响应不同，但外部资源不允许缓存。因此，我每次都会得到相同的响应。

有什么办法可以清除`HttpWebRequest`缓存的内容吗？正确的解决方案是修复外部源或更改缓存策略，但两者都不可能 - 因此是问题所在。

清除缓存可能会产生各种影响，因此最好的解决方案是基于每个资源使缓存无效。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-12T03:22:13.383

```
public static WebResponse GetResponseNoCache(Uri uri)
{
        // Set a default policy level for the "http:" and "https" schemes.
        HttpRequestCachePolicy policy = new HttpRequestCachePolicy(HttpRequestCacheLevel.Default);
        HttpWebRequest.DefaultCachePolicy = policy;
        // Create the request.
        WebRequest request = WebRequest.Create(uri);
        // Define a cache policy for this request only. 
        HttpRequestCachePolicy noCachePolicy = new HttpRequestCachePolicy(HttpRequestCacheLevel.NoCacheNoStore);
        request.CachePolicy = noCachePolicy;
        WebResponse response = request.GetResponse();
        Console.WriteLine("IsFromCache? {0}", response.IsFromCache);            
        return response;
} 
```

您可以将缓存策略设置为对 NoCacheNoStore 的请求到 HttpWebRequest。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-16T05:41:24.690

`HttpWebRequest`用于`System.Net.Cache.RequestCache`缓存。这是一个抽象类；`Microsoft.Win32.WinInetCache`顾名思义，Microsoft CLR 中的实际实现是使用[WinInet](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385331%28v=vs.85%29.aspx)函数进行缓存。

这与 Internet Explorer 使用的缓存相同，因此您可以使用 IE 的“删除浏览历史记录”对话框手动清除缓存。（首先执行此操作作为测试，以确保清除 WinInet 缓存可以解决您的问题。）

假设清除 WinInet 缓存可以解决问题，您可以通过 P/Invoking 到[DeleteUrlCacheEntry](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383983.aspx) WinInet API 以编程方式删除文件：

```
public static class NativeMethods
{
    [DllImport("WinInet.dll", PreserveSig = true, SetLastError = true)]
    public static extern void DeleteUrlCacheEntry(string url);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-01T20:55:02.687

我没有尝试过，但一种解决方案可能是将任意查询字符串添加到被请求的 url。

这个查询字符串每次都会改变，可能使用 DateTime.Now 意味着每次的 url 都会不同。然后每个请求都会被重新请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T19:22:07.857

您可以更改缓存策略：使用 http 反向代理，并删除/更改相关的 http 标头。这是一个黑客，但它会工作，而且很容易。我建议您使用 Apache httpd 服务器来完成此任务（使用 mod_proxy）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-12-07T08:03:01.500

添加以下行以在 Webclient 获取数据时清除缓存：

```
Webclient.Headers.Add(HttpRequestHeader.CacheControl, "no-cache") 
```

# c# - 从文本文件中删除一行的有效方法

> ID：532217
> 
> 赞同：10
> 
> 时间：2009-02-10T13:01:55.420
> 
> 标签：c#, performance, file-io

我需要从文本文件中删除某一行。这样做最有效的方法是什么？文件可能很大（超过百万条记录）。

更新：下面是我目前正在使用的代码，但我不确定它是否好用。

```
internal void DeleteMarkedEntries() {
    string tempPath=Path.GetTempFileName();
    using (var reader = new StreamReader(logPath)) {
        using (var writer = new StreamWriter(File.OpenWrite(tempPath))) {
            int counter = 0;
            while (!reader.EndOfStream) {
                if (!_deletedLines.Contains(counter)) {
                    writer.WriteLine(reader.ReadLine());
                }
                ++counter;
            }
        }
    }
    if (File.Exists(tempPath)) {
        File.Delete(logPath);
        File.Move(tempPath, logPath);
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T13:09:14.483

最直接的方法可能是最好的，将整个文件写入一个新文件，写入除您不想要的行之外的所有行。

或者，打开文件进行随机访问。

阅读到要“删除”该行的位置。跳过要删除的行，并读取该字节数（包括 CR + LF - 如有必要），在已删除的行上写入该字节数，将两个位置推进该字节数并重复直到文件末尾。

希望这可以帮助。

**编辑**- 现在我可以看到你的代码

```
if (!_deletedLines.Contains(counter)) 
{                            
    writer.WriteLine(reader.ReadLine());                        
} 
```

行不通，如果它是你不想要的那行，**你仍然想读它**，*只是不写它*。上面的代码既不会读也不会写。新文件将与旧文件完全相同。

你想要类似的东西

```
string line = reader.ReadLine();
if (!_deletedLines.Contains(counter)) 
{                            
    writer.WriteLine(line);                        
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T13:06:24.410

文本文件是连续的，因此在删除一行时，您必须将以下所有行向上移动。您可以使用文件映射（您可以通过 PInvoke 调用的 win32 api）来减少此操作的痛苦，但您当然应该考虑为您的文件使用非顺序结构，以便您可以将一行标记为已删除而无需真正删除它来自文件......特别是如果它应该经常发生。

如果我记得应该将文件映射 Api 添加到 .Net 4。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T10:36:40.903

```
 try{
     Scanner reader = new Scanner(new File("D:/seenu.txt")); 
     System.out.println("Enter serial number:");
     String sl1=bufRead.readLine();
     System.out.print("Please Enter The ServerName:");
     String name=bufRead.readLine();
     System.out.println("Please Enter The IPAddress");
     String ipa=bufRead.readLine();

    System.out.println("Line Deleted.");
     PrintWriter writer = new PrintWriter(new FileWriter(new File("D:/user.txt")),true); 
     //for(int w=0; w<n; w++)
       writer.write(reader.nextLine()); 
     reader.nextLine(); 
     while(reader.hasNextLine())
       writer.write(reader.nextLine());
     } catch(Exception e){
       System.err.println("Enjoy the stack trace!");
       e.printStackTrace();
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T13:23:57.503

如果您绝对*必须*使用文本文件并且无法切换到数据库，那么您可能想在行首指定一个奇怪的符号来表示“行已删除”。只需让您的解析器忽略这些行，例如配置文件中的注释行等。

然后有一个像 Outlook 一样的定期“紧凑”例程，大多数数据库系统都会这样做，它会重写整个文件，不包括已删除的行。

我强烈建议使用 Think Before Coding 的推荐数据库或其他结构化文件的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T13:47:52.020

使用文件映射将文件移动到内存，就像[在编码之前思考](https://stackoverflow.com/questions/532217/efficient-way-to-delete-a-line-from-a-text-file-c/532238#532238)所做的那样，并在内存上和写入磁盘后进行删除。
阅读此[文件 阅读基准 - C#](http://dotnetperls.com/Content/File-Read-Benchmarks.aspx)
[C# 访问内存映射文件](https://stackoverflow.com/questions/216083/c-accessing-memory-map-file)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T13:53:09.620

根据确切算作“删除”的内容，您最好的解决方案可能是用空格覆盖有问题的行。对于许多目的（包括人类消费），这相当于彻底删除该行。如果生成的空行有问题，并且您确定永远不会删除第一行，则可以通过用两个空格覆盖 CRLF 来将空格附加到前一行。

（基于对 Bork Blatt 的回答的评论）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-04T00:04:08.537

在我的博客中，我对 C# 中的各种 I/O 方法进行了基准测试，以确定执行文件 I/O 的最有效方式。通常，最好使用 Windows ReadFile 和 WriteFile 函数。读取文件的下一个最快方法是通过 FileStream。为了获得良好的性能，一次以块的形式读取文件，而不是一次读取一行，然后进行自己的解析。您可以从我的博客下载的代码为您提供了如何执行此操作的示例。还有一个 C# 类封装了 Windows ReadFile / WriteFile 功能并且非常易于使用。有关详细信息，请参阅我的博客：

[http://designingefficientsoftware.wordpress.com/2011/03/03/efficient-file-io-from-csharp](http://designingefficientsoftware.wordpress.com/2011/03/03/efficient-file-io-from-csharp)

鲍勃·布莱恩 MCSD

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-05-05T18:52:02.173

将您的文件读入非删除行上的字典将 int 设置为 0 在您需要标记为已删除的行上设置 int 为 1。使用 KeyValuePair 提取不需要删除的行并将它们写入新文件.

```
Dictionary<string, int> output = new Dictionary<string, int>();

// read line from file

...

// if need to delete line then set int value to 1

// otherwise set int value to 0
if (deleteLine)
{
    output[line] = 1;
}
else
{
    output[line] = 0;
}

// define the no delete List
List<string> nonDeleteList = new List<string>();

// use foreach to loop through each item in nonDeleteList and add each key
// who's value is equal to zero (0) to the nonDeleteList.
foreach (KeyValuePair<string, int> kvp in output)
{

    if (kvp.Value == 0)

    {

        nonDeleteList.Add(kvp.Key);

    }
}

// write the nondeletelist to the output file
File.WriteAllLines("OUTPUT_FILE_NAME", nonDeleteList.ToArray()); 
```

就是这样。

# design-patterns - 网络上的海量数据录入是否可行？

> ID：532225
> 
> 赞同：4
> 
> 时间：2009-02-10T13:02:44.827
> 
> 标签：design-patterns, data-entry

有没有什么好的方法来设计一个用于海量数据输入的网页？Datagrids 似乎是处理此类数据输入的最佳方式，我认为像 Access 或 SQLite+Frontend 这样的客户端应用程序比 Web 更适合这种情况。

链接到带有数据输入页面的网站将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T13:07:57.810

如果您搜索它们，则有很多可用的网页网格条目控件。问题是确保您不会花费 2 个小时输入数据然后让网络出现故障，我不知道是否有任何状态的自动异步持久性，或者您是否必须自己滚动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T13:08:44.500

我看不出网站上的数据网格与胖客户端应用程序上的数据网格之间的巨大差异。使用 AJAX，您甚至可以在 web 应用程序中进行即时验证和自动保存。

将其作为 web 应用程序执行的主要原因是允许许多人访问该应用程序而不必担心部署。不将其作为 web 应用程序的主要原因是避免更复杂的基础设施（至少一个额外的服务器）和编程工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T04:37:31.453

[ajax 自动保存](https://stackoverflow.com/questions/931252/ajax-autosave)可能最终会包含实现问题的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T13:07:08.670

重要的部分是使所有内容都可以通过键盘访问，并尽可能减少记录之间的等待时间。因此，无需单击提交按钮，也无需等待页面重新加载。

所有这些都可以通过 JavaScript 完成。在让用户开始为下一条记录输入项目之前，不必等待一条记录被提交和处理，这将特别有用。

# asp.net-mvc - 如何将现有的 asp.net 应用程序迁移到 asp.net MVC 模式格式

> ID：532227
> 
> 赞同：41
> 
> 时间：2009-02-10T13:02:49.380
> 
> 标签：asp.net-mvc, webforms, migrate

我想将现有的 ASP.NET 应用程序迁移到 ASP.NET MVC 模式格式。我应该遵循什么程序？任何分步说明都会非常有帮助。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-24T14:11:13.223

这些是我的分步指南，基于我们在从经典 ASP.Net Webforms 迁移到 ASP.Net MVC 期间在我的公司所采取的步骤。它并不完美，并且仍在进行中，因为由于站点的大小，我们必须分阶段进行，但也许其他人会根据我们的结果找到并提交改进的答案。

阶段： 1\. 计划 - 从 ASP.Net 中的 Web 表单迁移到 MVC 需要一些仔细的计划。我们在行动中犯的错误是没有意识到这个阶段的规划实际上有两个方面，路线规划和模型/控制器/动作规划。当您尝试扩展站点的功能或进行更复杂的迁移时，不这样做会导致以后出现严重问题。

提示： - 查看您当前的站点地图，并设计改进的站点地图/目录结构以在 ASP.Net MVC 应用程序中使用。为您的网站找出一种“语言”，例如 ASP.Net MVC 的默认行为是具有[http://sitename/](http://sitename/) {controller}/{action}/{id} 行为，但您可以在获得时覆盖它更多破解路由规则的经验。

*   请记住，默认情况下，每个 Controller 将通过应用程序的虚拟子目录路由到，例如[http://sitename/X](http://sitename/X)将路由到 XController（默认情况下它的 Index 方法），[http://sitename/Y/Get](http://sitename/Y/Get)将路由到YController 的 Get() 方法。你可以随意改变它（路由真的很强大），但这超出了这个答案的范围。

*   使用现有的站点地图，指定每个当前 .aspx 页面应该落在 MVC 结构中的哪个文件夹（当然，首先要询问它是否应该存在）。

*   如果脚本、图像等没有存储在一起，或者没有存储在每个子目录中的某些“保留名称”文件夹中，请在重新设计时考虑这样做。这是因为它允许您在 Global.aspx.cs 文件中使用 Map.IgnoreRoute() 路由规则命令绕过将这些文件夹作为路由处理，从而大大简化您的设计。

在我们的例子中，我们反映了当前站点的真实子目录布局，其中每个子目录都成为一个控制器，例如 /Account 将有一个 AccountController，/X 将有一个 XController。落入其中的所有页面都被每个控制器中的操作替换。例如[http://sitename/profile/about.aspx](http://sitename/profile/about.aspx)现在变成了[http://sitename/profile/about](http://sitename/profile/about)并映射到 profileController 中的“about”ActionResult 方法。这使我们能够通过在一系列冲刺中对一个或两个目录（或一个目录中的多个文件）进行部分迁移来保持敏捷，而不必在更长的时间内一次性迁移整个站点。

2.  在 Visual Studio 中创建一个新的 ASP.Net MVC 应用程序，并立即在 Global.asax 文件中创建规则，忽略当前站点中存在的文件夹的路由规则。

3.  将文件夹从 ASP.Net Web 应用程序复制到 ASP.Net MVC 应用程序文件夹。运行网站并确保其正常运行（应该是因为尚未使用任何路由规则）。

4.  选择要迁移的子目录中的子目录或文件子集。

5.  对于此子目录中的每个 .aspx 页：

    一个。首先创建它的视图。我倾向于使用网页浏览器呈现的版本作为我的基本 HTML，然后将占位符放在我知道的充满动态数据的位置。

    湾。使用动态数据的占位符，使用简单数据类型创建模型的初稿。这个模型一开始很简单，但随着您从原始站点迁移更多页面，它会不断重构，所以如果它开始看起来有点沉重，请不要担心。如果您发现自己在一个模型中的属性太多，或者看到超出某些项目子集模型的逻辑分组，这可能表明模型需要重构以拥有一个对象，而不是使用这些简单的数据类型作为属性，但由业务逻辑层组成。

    C。如果尚未创建控制器，请创建控制器，并为您的计划已确定应路由到此视图的 Action 放置适当的 ActionResult 方法。如果您意识到有一个新操作未映射到旧站点的页面，则为控制器创建视图，并包含适当的 //TODO: 标记，以便您可以跟踪此操作以在您执行后执行已迁移现有页面。

    d。如果您的 global.asax.cs 文件中还没有 {*catchall} 路由规则，请考虑为未知操作添加一些处理代码。

    e. 为模型创建构造函数类，以便给定控制器将具有的某些参数（作为您的 {id} 或可能来自 URL 的 Request.QueryString 参数或 HTTP 标头或 cookie 传递），模型将知道如何访问您现有的业务逻辑类并构建自身以供视图呈现。

    F。转到列表中的下一页并从步骤 a 重新开始。

6.  最后创建将调用您的新控制器并允许执行您编写的操作的路由规则。调试、调试、调试...一旦您感到满意，一切都很好，请删除您从主站点迁移的现有文件夹和文件，以及 global.asax.cs 中的 IgnoreRoute 规则。

7.  如果您希望保留旧目录和文件名以保持连续性（例如，用户可能已经为旧站点中的某些页面添加了书签），请以您喜欢的任何方式创建重定向。

注意：如果您在移植阶段保留 MVC 站点中旧子目录的确切名称，最好一次迁移整个子目录，因为只需执行几个文件，您需要的路由规则写入变得更加复杂，因为如果存在与路由规则路径同名的现有文件夹，并且该文件夹具有 Default.aspx 文件，则 (/foldername/) 将默认为 Default.aspx 页面，因为它需要优先于路由规则。

提示：认真考虑使用像[RouteDebug](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)这样的工具进行路由调试，这样你就可以找出像上面这样的奇怪事情，或者当你有多个路由规则触发并导致意外行为时。

这是我的初稿，如果我遗漏了任何步骤或者您在指南中发现任何漏洞，请给我反馈，我会适当地修改答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-27T13:01:19.547

愿这些额外的提示会有所帮助

*   将 <%-- 注释标签替换为 @*
*   使用**@RenderSection** ("Footer",false) 为@section footer { } 等等，如果你有任何额外的**ContentPlaceHolder除了 View which** **RenderBody** ()中的主体。

*   所有旧的正常**runat="server"**标签都是无害的，不会阻止编译，并且可以在之后清理

*   在代码隐藏和标记 (Visible="True") 中很容易控制并通过使用 Control Id 在**code_behind**中控制的所有控件可见性必须重构为Razor 视图中的**ViewBag**集合和**@if**块。

*   您还可以观看围绕该主题的 Pluralsight 精彩课程（3h 49m）

    *   [在 MVC 中重建 Web 表单应用程序](https://app.pluralsight.com/library/courses/rebuilding-web-forms-applications-mvc)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T13:13:25.830

我认为没有从 ASP.NET WebForms 到 ASP.NET MVC 的“逐步迁移”这样的事情。它们是建立在同一个框架上的两种完全不同的设计模式，但是（在大多数情况下）有很多东西不仅需要移动，而且需要完全重新设计，如果你不只是想构建一个 web app 在 MVC 模板项目而不是 WebForms 模板上。

造成这种情况的主要原因是关注点的分离，这在 MVC 中比在 WebForms 中严格得多。我目前正在（嗯，我应该……）将一个旧的、有缺陷的爱好项目从 WebForms 迁移到 MVC，我的方法基本上是“查看功能，从头开始重新构建它”。当然，我有一些用于格式化输出等的辅助方法，我刚刚包含在我的新项目中，但我选择的大部分基本内容只是为了完全重做。你会惊讶于我现在用 MVC 达到同样的目标需要多少时间，我在一年半前为 WebForms 应用程序设置 - 使用 Entity Framework、jQuery 和其他甜蜜的东西，您将能够在几个小时内产生结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T16:49:02.817

我的回答是“你没有”:)。如果你真的想这样做，你可以使用当前的 asp.net 站点作为你的最终目标，或者作为一个需求“文档”。也许您可以在模型中使用数据层，但您必须重新设计整个站点。

正如 Tomas 已经指出的那样，它与经典的 asp.net 非常不同。

# asp.net-mvc - ASP.NET MVC + fluent nNibernate，什么IoC工具？

> ID：532233
> 
> 赞同：8
> 
> 时间：2009-02-10T13:05:02.183
> 
> 标签：asp.net-mvc, fluent-nhibernate, dependency-injection, inversion-of-control

我正在开发一个 ASP.NET MVC 项目，我们决定使用 Fluent nHibernate 进行数据访问。为了实现松散耦合，我们采用 IoC/DI 模式。我的问题是要使用什么 IoC 工具。我试图找出 windsor、ninject、spring、structuremap 和 unity 之间的区别，但很难看出每个人都提供的好处。你的经验是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T17:17:33.433

我使用 StructureMap，它非常易于使用。就个人而言，我不喜欢使用 xml 进行配置，而 StructureMap 使使用代码进行配置变得轻而易举。如果您需要切换实现，切换不同的配置文件也很容易。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T19:12:54.717

我使用温莎，我没有什么可抱怨的。易于使用，在您需要时可扩展，如果您遇到困难，可以提供大量信息。但我认为您选择哪个容器并不重要。您提到的所有这些都具有共同的功能，并且在 mvccontrib 项目中也有适用于 mvc 的适配器。如果您将容器包装在自己的类中，切换到另一个容器应该不难，无论如何这是一个好习惯。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T09:14:52.993

我一直在使用温莎并且喜欢它。有一个用于使用 NHibernate 的内置工具，它允许简单配置日志记录和连接等。

如果您计划使用 FluentNhibernate，您必须告诉 Windsor 工具哪个程序集具有 ConfigurationBuilder。Mike Hadlow 对此以及 Windsor 和 NHibernate 的其他许多文章都有很好的文章：http: [//mikehadlow.blogspot.com/2009/01/integrating-fluent-nhibernate-and.html](http://mikehadlow.blogspot.com/2009/01/integrating-fluent-nhibernate-and.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-09T02:43:37.097

我使用轻量且快速的[Munq](http://munq.codeplex.com/)，它是一种通过 Nuget 将 DI 容器添加到 MVC3 项目的简单方法。到目前为止，我还没有发现任何需要迁移到不同的框架 - Munq 已经非常足够了。

```
PM> install-package Munq.MVC3 
```

这会添加`App_Start\MunqMvc3Startup.cs`到项目中，这也是应该注册依赖项的地方。

# c++ - 内存分配

> ID：532235
> 
> 赞同：-1
> 
> 时间：2009-02-10T13:05:29.220
> 
> 标签：c++, windows, managed-c++

我的 STRUCT1 结构声明如下

```
typedef struct struct1 {
    short int nbr_fe;
    [size_is(nbr_fe)] STRUCT2  ptr_fe[*];
} STRUCT1; 
```

STRUCT2 也是 STRUCT1 内部的另一个结构

然后我有一个指向它的指针，如下所示

```
typedef [ptr] STRUCT1 * ptr; 
```

我必须根据 nbrRequested 为 STRUCT1 数组分配内存到目前为止我有

```
STRUCT1 obj1;
memset((void*)&obj1, '\0' , sizeof(STRUCT1));

for(int i1=0;i1<(int)nbrRequested;i1++) {
   STRUCT2 obj2;
   memset((void*)&obj2, '\0' , sizeof(STRUCT2));
   obj1.ptr_fe[i1] = obj2;
}

ptr ptr2;
ptr2 = &obj1; 
```

但如果 nbrRequested 大于 500，则循环进入无限状态并且应用程序挂起。

有没有更好的方法来分配内存而不使用 for 循环

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T13:16:14.607

这个片段应该清楚你需要 malloc 内存，清除它，然后你可以将*指针*分配给结构成员。

```
STRUCT1 listWU;
memset(&listWU, 0 , sizeof(STRUCT1));
for(int i1=0; i1<(int)nbrRequested; i1++) {
    STRUCT2 *temp;
    temp = malloc(sizeoF(STRUCT2));
    memset(temp, 0 , sizeof(STRUCT2));
    listWU.lst_Workunit_fe[i1] = temp;
} 
```

哦，别忘了当你完成这个结构时，你需要释放所有`malloc`在这个结构中的指针，否则你会发生内存泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T13:22:22.797

你没有分配任何东西，你正在覆盖堆栈上的相同数据（然后在循环退出时超出范围。

在 C++ 中，您使用 new 运算符分配内存。在 C 语言中，您将使用 malloc。因此，您的代码的最小重写将是这样的（在 C 中，因为这似乎是您正在编写的内容）

```
// Allocate enough space for the array of `WF_LIST_WORKUNIT_P_FE`s
WF_LIST_WORKUNIT_P_FE listWU = malloc(sizeof(WF_STRUCT_WORKUNIT_FE) * nbrRequested);
memset(listWU, 0, sizeof(WF_STRUCT_WORKUNIT_FE) * nbrRequested)); 
```

当然，这只是将数组中的每个结构都设置为 0，而不是更有意义的初始化，如果这是你想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T14:41:12.217

因为这是一个 C++ 代码

我会使用 new 运算符，如下所示

**WF_LIST_WORKUNIT_P_FE *listWU = 新的 WF_STRUCT_WORKUNIT_FE [nbrRequested + 1]；**

关键是结构 WF_STRUCT_WORKUNIT_FE 本身是结构 WF_LIST_WORKUNIT_FE 的嵌套结构，即 typedef struct wf_list_workunit_fe
{ short int nbr_Workunits_fe; [size_is(nbr_Workunits_fe)] WF_STRUCT_WORKUNIT_FE lst_Workunit_fe[*]; } WF_LIST_WORKUNIT_FE;

不会将内存分配给 WF_LIST_WORKUNIT_FE 工作吗？

# c# - C#：对于小型操作，ObjectTrackingEnabled = false 是否值得？

> ID：532237
> 
> 赞同：5
> 
> 时间：2009-02-10T13:05:53.570
> 
> 标签：c#, performance, linq-to-sql

给定以下代码：

```
using(var data = new SomeDataContext(ConnectionString))
{
  data.ObjectTrackingEnabled = false;

  foreach(Something in data.Somethings)
     someList.Add(something.SomeProperty);
} 
```

将对象跟踪设置为 false 是否值得？我知道这只是一行代码，但它让我不得不一直编写它。但是我听说可以通过在不需要时关闭它来获得一些性能提升。而且由于我只需要快速读出一些数据，我不需要跟踪。但是这么小的一段代码值得吗？你有什么意见？我应该使用它吗？我不应该吗？为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T13:08:01.990

如果要立即处理上下文，则可能不值得 - 但这里有一些想法：

*   也许为数据上下文编写一个“流利的”扩展方法（下）
*   通过添加一个部分`OnCreated`方法来使其成为默认值

Fluent 扩展示例：

```
public static class DataContextExt {
    public static T NoTracking<T>(this T ctx)
        where T : DataContext
    {
        ctx.ObjectTrackingEnabled = false;
        return ctx;
    }   

} 
```

然后你可以使用：

```
using(var data = new SomeDataContext(ConnectionString).NoTracking())
{...} 
```

部分方法示例：

```
namespace MyData {
    partial class MyDataContext {
        partial void OnCreated() {
            this.ObjectTrackingEnabled = false;
        }
    }
} 
```

# java - 如何在maven中运行jetty：run-exploded但防止再次组装战争？

> ID：532241
> 
> 赞同：3
> 
> 时间：2009-02-10T13:07:05.797
> 
> 标签：java, maven-2, jetty

我们正在使用 maven jetty 插件来运行爆炸式的战争。

我们有一个脚本，将某些配置文件复制到 maven 用于组装战争的目录（基本上是 spring 配置 +`web.xml`用于独立测试环境）。

问题是，似乎在调用 jetty:run-exploded 之前再次构建了 webapp，它替换了我们复制的自定义配置文件。奇怪的是，这只会影响 Windows 用户，而不影响 Ubuntu 用户。

任何人都知道一种运行`jetty:run-exploded`任务的方法，但在执行之前阻止 Maven 构建任何东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T01:21:36.693

您是否尝试过使用处决？ [http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)

我不确定它们是否会起作用，但如果可能的话，我认为这就是它的配置方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-04T16:43:04.640

run:exploded 目标文档说它将运行您所看到的包。

“我们有一个复制某些配置文件的脚本……”

您可能想找出什么是 Maven“配置文件”。这是这里真正的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-11T22:27:39.927

根据[http://eclipse.org/jetty/documentation/current/jetty-maven-plugin.html#deploy-war-running-pre-assembled-war](http://eclipse.org/jetty/documentation/current/jetty-maven-plugin.html#deploy-war-running-pre-assembled-war) ，我使用的是`deploy-war`目标而不是：`exploded`

> 这与 jetty:run-war 基本相同，但无需组装当前模块的 WAR - 您可以指定要运行的任何战争的位置。与 run-war 不同，此插件执行的阶段不绑定到“包”阶段 - 您可以将其绑定到任何阶段以使用它。

# c++ - 继承类之间的通信

> ID：532248
> 
> 赞同：0
> 
> 时间：2009-02-10T13:08:07.933
> 
> 标签：c++, inheritance, class, object, communication

我在不同的文件中有 3 个类：

```
 X
   |
-------
|     |
Y     Z 
```

我将创建几个继承类 Y 和 Z 的对象。

**只有在 Y 类设置了某个标志**变量时，才应执行 Z 类中的特定函数。

我应该在哪里创建这个标志变量（哪个类）以及声明应该是什么样的（静态/外部）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T13:12:56.533

考虑[模板方法](http://en.wikipedia.org/wiki/Template_method)作为臭名昭著的标志的替代品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T13:17:48.143

如果只有 Z 受其影响，则标志应该在 Z 中。但是整个事情都闻起来了——标志是由类而不是实例设置的。在可行的情况下使用多态性而不是标志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T13:18:03.120

我认为这是一个奇怪的设计；您将在继承的类之间创建依赖关系。

方法（和标志变量）应该在父类 X 中。

（编辑）完善/替换我上面写的，变量可以在基类中，Y类将设置变量（Setter），Z类将具有从基类“获取”值的方法.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T13:20:34.393

最佳答案：Anton Gogolev 所说，使用模板。

（否则使用私有枚举变量。例如使用：返回 type.x/type.y 等的 GetType()）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T13:26:23.020

如果你有两个 Y 对象，而只有一个设置了标志怎么办？您的三个 Z 对象中的哪一个受到影响？这个问题表明你的设计有缺陷。

# .net - SQLite 可以在 ClickOnce 部署中工作吗？

> ID：532251
> 
> 赞同：3
> 
> 时间：2009-02-10T13:08:57.697
> 
> 标签：.net, wpf, sqlite, clickonce

如果可以的话，就连接字符串而言，最佳实践是什么？只是相对路径？|数据目录| ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T14:43:51.807

SQ Lite 在 ClickOnce 场景中应该可以正常工作。它是一个零配置组件。需要配置的组件通常会出现单击一次的问题。

[http://www.sqlite.org/](http://www.sqlite.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T13:36:20.143

我不了解 SQLite，但是是的：我相信您希望`|DataDirectory|`与 ClickOnce 一起使用，因为它指向用户配置文件中可以存储应用程序数据/设置的区域。

# algorithm - 算法速度顺序

> ID：532274
> 
> 赞同：6
> 
> 时间：2009-02-10T13:14:10.960
> 
> 标签：algorithm, performance, big-o, performance-estimation

有时我在试图用 O(x) 表示法估计算法的速度时完全被愚弄了，我的意思是，我真的可以指出顺序是 O(n) 还是 O(mxn)，但对于那些是 O(lg( n)) 或 O(C(power n)) 我认为我在那里遗漏了一些东西......那么，对于快速忽略算法的简单估计，你有什么技巧和窍门？

作为我正在寻找的一个例子，这里有一些简单的（可能是错误的，但尽我所能）：

*   O(n)：如果有一个从 1 到 n 的简单循环（或其中几个，但没有嵌套。
*   O(mxn)：另一个嵌套循环，其中限制为 m 和 n。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T13:20:38.963

递归、分而治之的算法通常是 O(logN)。在分治法上循环的算法将是 O(NlogN)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T13:28:43.810

这是一篇可能会有所帮助的博客文章：

[分解事物并将它们重新组合在一起的成本](http://www.johndcook.com/blog/2008/10/29/the-cost-of-analysis-and-synthesis/)

那篇文章解释了处理大 O 订单的“主定理”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T13:21:34.483

**O(lg(n))**：如果您的问题在算法的每一步都缩小了 n 的某个比例（通常为 n/2），并且每一步都做了大量的工作。二分搜索是一个很好的例子，因为每一步都通过做恒定的工作量（计算中点并进行一次比较）将问题大小减半。

请注意，n 位于该比例的*顶部*。这与您的问题大小在每一步减少 1/n 不同。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T13:29:02.000

如果您正在寻找一种**快速**估计算法运行时间的方法，那么其他答案都很好。如果您想要更详细的答案，我建议您查看“[大师定理](http://en.wikipedia.org/wiki/Master_theorem)”。在[德语文章中](http://de.wikipedia.org/wiki/Master-Theorem)，有一张很好的表格。

**编辑：** John D. Cook 对主定理做了一个很好的回顾，请参阅链接他的答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T13:33:14.503

关于 Big O Notation的[Wikipedia 文章有一个很好](http://en.wikipedia.org/wiki/Big_O_notation)[的常用函数顺序](http://en.wikipedia.org/wiki/Big_O_notation#Orders_of_common_functions)图表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T06:32:39.080

算法的渐近复杂性在实践中很重要，这里有一些我在审查我的或其他人的代码时使用的经验法则。通常实际的计算机算法是许多变量和非平凡数据结构的函数，但让我们假设（仅用于说明）我们的算法 f 基本上以单个整数 X 作为其参数，并且我们希望找到 f 的渐近复杂度X. 假设 f(0) 是微不足道的。然后一般来说：

*   从 0 到 X 的每个嵌套循环都会为 X 添加一个指数，因此两个循环（一个嵌套在另一个循环中）给出 X**2（二次）。
*   如果 f(X) 以尾递归方式调用 f(X-1)，它通常对应于迭代，即单个外循环 (O(X))。
*   我见过作者打算迭代的例程，但是从 0..X 迭代和到 X-1 的尾递归；这些导致二次行为（O（X**2））
*   如果 f(X) 调用 f(X-1) 两次或更多次，它会产生一个指数算法，你会得到 O(2**X) 。
*   如果 f(X) 调用 f(X/2) 两次，它在复杂性方面对应于单次迭代（它是一种分而治之的算法）。（根据细节，它会导致 O(X log X) 或 O(X)，但我意识到无论如何我*认为*它是一次迭代。）
*   如果 f 使用任何已正确实现的有序数据结构（有序集、优先级堆等），并且该算法在数据结构中添加了大约 X 个对象，则操作为 O(log X)。因此，如果在循环中发生恒定数量的数据结构操作，例如，您将得到 O(X * log X)。
*   如果有序数据结构未正确实现，则单个操作可能会得到 O(X) 而不是 O(log X)。

一些特殊情况：

*   通过附加到字符串或内存区域来增长字符串或内存区域的算法在许多语言中会产生 O(X**2) 开销，例如

    ```
    for (i = 0; i < X; i++) { s += "foo"; } // quadratic 
    ```

*   这个典型的嵌套循环也有 X**2 开销：

    ```
    for (i = 0; i < X; i++) { for (j = 0; j < i; j++) { ... } } // quadratic 
    ```

*   像 std::set 和 std::map 这样的 C++ STL 容器对几乎所有操作都有 O(log X) 开销

*   strlen(s) 和其他类似的计数算法在返回 X 时有 O(X) 开销
*   memcpy 等导致 O(X)
*   存在复杂性方面的危险操作，例如通过相等比较从链表中擦除元素，这会产生 O(X) 或更糟
*   使用基于模板的容器时，请确保比较、排序等操作符快速且没有隐藏的复杂因素
*   如果您使用引用计数，如果您将最后一个引用删除到长度为 X 的引用的链接列表，则删除引用可能是最坏情况的 O(X) 操作
*   如果复制对象的例程不平凡并且例如更新全局对象集，那么在面向对象语言中复制复杂的数据结构会产生奇怪的渐近复杂性

只是我的2美分！希望这可以帮助！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-27T07:37:00.360

通常会出现像 O(logN) 这样的数据，因为数据大小为 N，但它被组织在例如树的深度为 logN 的树中。如果典型的搜索涉及从根到叶（在更坏的情况下），那么很容易看出算法将是 O(logN)。

没有硬性规定——你只需要查看每个案例，找出最坏的情况，然后计算成本是多少。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-07T17:01:25.887

我不喜欢回答自己的问题，但我今天发现了这个并提醒我这个 SO 问题。

[http://bigocheatsheet.com/](http://bigocheatsheet.com/)

# asp.net - asp.net 中的图像本地化

> ID：532276
> 
> 赞同：2
> 
> 时间：2009-02-10T13:14:36.857
> 
> 标签：asp.net, localization, internationalization, markup

我有一个需要支持多种语言的 Web 应用程序。我们目前在网站上有很多带有文字的图片。我试图找到一种方法来以最少的麻烦本地化这些图像。到目前为止，我想出的是将子文件夹添加到与所需语言相关的当前 /Images 文件夹中。因此，例如 /Images 包含默认图像集， /Images/es-MX 包含西班牙-墨西哥本地化图像。

到目前为止，我认为所有的标准都很标准。现在我遇到的问题是，为了让这个新结构正常工作，我需要在所有 img 标签中添加以下内容：

```
<img ... src="/images/<%= GetGlobalResourceObject("MyResource","IMAGEPATH").ToString() %>image1.gif" ../> 
```

或者在 asp:ImageButton 的情况下，我需要以编程方式在代码隐藏中设置它们的 ImageURL，并使用一种实用方法将 /Images/ 替换为 /Images/es-MX 或任何文化。

所有这些都给我留下了混乱的标记和大量的代码隐藏调用，只是为了更正图像路径。我问你亲爱的读者，有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T13:36:30.767

这是来自 MSDN 的一篇关于 ASP.NET 全球化的好文章。它使用资源文件方法，所以我不确定这是否适合你，但这里是文章：

[http://msdn.microsoft.com/en-us/magazine/cc163566.aspx](http://msdn.microsoft.com/en-us/magazine/cc163566.aspx)

# c# - 从后台线程捕获异常

> ID：532282
> 
> 赞同：6
> 
> 时间：2009-02-10T13:16:38.677
> 
> 标签：c#, multithreading

并发的同事。

我需要能够捕获可能从后台线程抛出的异常。

让代码自己说话（这是一个糟糕的代码）

```
 public delegate bool CheckForUpdatesHandler(Uri uri);
    public class UpdatesChecker {
        public event AsyncCompletedEventHandler CheckForUpdatesAsyncCompleted;
        protected virtual void OnCheckForUpdatesAsyncCompleted(AsyncCompletedEventArgs args) {
            if (CheckForUpdatesAsyncCompleted != null)
                CheckForUpdatesAsyncCompleted(this, args);
        }

        public bool CheckForUpdates(Uri ftp) {            
            Thread.Sleep(1000);
            throw new Exception("bla");
            return true;
        }     

        public void CheckForUpdatesAsync(Uri ftp){            
            var action = new CheckForUpdatesHandler(CheckForUpdates);
            var c=action.BeginInvoke(ftp, delegate(IAsyncResult state) {
                OnCheckForUpdatesAsyncCompleted(new AsyncCompletedEventArgs(null, false, null));
            }, null);
        }    
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T13:19:32.930

使用 Delegate.BeginInvoke，将通过调用 .EndInvoke 检索异常——无论如何您都必须这样做以防止泄漏。

使用BackgroundWorker，它会出现在完成事件上

在 vanilla`Thread`上，未处理的异常将破坏该过程。

但是，最简单的方法是：不要让它抛出......

```
 public bool CheckForUpdates(Uri ftp) {
        try {
            Thread.Sleep(1000);
            throw new Exception("bla");
            return true;
        } catch (Exception ex) {
            // raise an event, call a method/callback, do something
        }
    } 
```

如果您当前没有使用`EndInvoke`，那么也许切换到上述模式并直接使用`ThreadPool`（而不是`Delegate.BeginInvoke`）。

# c# - 从分隔的数据库字符串字段中选择多选列表框中的项目

> ID：532285
> 
> 赞同：2
> 
> 时间：2009-02-10T13:17:22.950
> 
> 标签：c#, asp.net, database, listbox, multi-select

我正在尝试为可以编辑并保存回数据库的数据库记录构建一个“编辑”页面。其中一个字段是多选列表框，加载时需要在硬编码列表中突出显示适当的列表项。

使用 C#，我如何根据数据库字段中的逗号分隔字符串填充多选列表框 - 并选择适当的项目？我研究了一些涉及循环的解决方案，但我无法让它们与我有限的 C# 技能组一起工作。

这就是我现在所拥有的，在我陷入困境之前。您会看到它没有考虑字符串中的多个值。是否有像“包含”这样的功能，我可以检查值是否匹配？我在这里仍然缺少一些（可能是基本的）C# 逻辑和编码。

```
int i;
for (i = 0; i <= CATEGORYListBox.Items.Count - 1; i++)
{
    if (reader["CATEGORY"].ToString() == CATEGORYListBox.Items(i).Value)
    {
        CATEGORYListBox.Items(i).Selected = True;                   
    }
} 
```

...

```
<asp:ListBox ID="CATEGORYListBox" runat="server">
    <asp:ListItem Value="Circulation">Circulation</asp:ListItem>
    <asp:ListItem Value="Interactive Media">Interactive Media</asp:ListItem>
    <asp:ListItem Value="Classified">Classified</asp:ListItem>
    <asp:ListItem Value="Publishing">Publishing</asp:ListItem>
    <asp:ListItem Value="Editorial">Editorial</asp:ListItem>
    <asp:ListItem Value="Retail">Retail</asp:ListItem>
 </asp:ListBox> 
```

谢谢大家。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T15:04:41.647

我会建议一些类似的东西。它似乎比嵌套循环更具可读性。

```
 List<string> categories = new List<string>(reader["CATEGORY"].ToString().Split(','));
    foreach (ListItem item in CATEGORYListBox.Items)
    {
        if (categories.Contains(item.Value))
            item.Selected = true;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T13:31:21.683

这是蛮力和丑陋的，但它应该工作。看起来您上面的代码是 VB 和 C# 之间的某种混合。下面的代码仅适用于 C#。*此外，请考虑不要在*代码隐藏中执行 ADO.Net 。

```
for (int i = 0; i < CATEGORYListBox.Items.Count; i++)
{
    foreach (string category in reader["CATEGORY"].ToString().Split(','))
    {
        if (category != CATEGORYListBox.Items[i].Value) continue;
        CATEGORYListBox.Items[i].Selected = true;
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-06T05:36:17.607

该问题的另一个解决方案是：

```
 string[] arrSplitItems;
    arrSplitItems = TestsOrdrd.Split(',');
    if (arrSplitItems.Length > 0)
    {
        for (int iCount = 0; iCount < arrSplitItems.Length; iCount++)
        {
            lstTestcode.Items.FindByValue(arrSplitItems[iCount].ToString()).Selected = true;
        }
    } 
```

TestsOrdrd 包含列表框的选定值。

谢谢， Rathika Krishnavelu

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-22T10:43:01.883

**最简单的实现？**

```
string sequenceFromDBorPostBack= "1,3,4,6,48";

foreach (ListItem item in lstLocations.Items)
{
     item.Selected = sequenceFromDBorPostBack.Split(',').Contains(item.Value);
} 
```

我不确定这是否有效..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-12T23:23:08.173

```
ListBox1.SelectionMode = ListSelectionMode.Multiple;
string[] pageRoles = myReader["UserProfile"].ToString().Split(',').ToArray();
pageRoles.ToList().ForEach(r => ListBox1.Items.FindByValue(r).Selected = true); 
```

# windows - 如何在内存/CPU时间有限的Windows下运行程序？

> ID：532301
> 
> 赞同：5
> 
> 时间：2009-02-10T13:22:01.177
> 
> 标签：windows

它从[这个问题](https://stackoverflow.com/questions/531893/problems-with-running-an-application-under-controlled-environment-win32)开始，接着是[这个问题](https://stackoverflow.com/questions/532092/weird-behaviour-of-c-destructors)，现在引出了现在的问题。:)

任务如下：制作一个 Windows 程序，该程序将在有限的环境中运行另一个程序。另一个程序是不可信的，所以它必须为黑客代码做好准备。进一步来说：

*   将可用内存限制为 X MB（作为参数给出）；
*   将可用执行时间限制为大约 X 毫秒（作为参数给出）。请注意，这是内核时间 + 用户时间，而不是空闲时间。另一方面，空闲时间也必须受到限制，以使程序不能`Sleep()`无限。
*   在程序终止时，尽可能准确地报告它实际花费的 CPU 时间。毫秒会很好，厘秒可以接受，小于那个就不好了。CPU 周期将是理想的。
*   如果程序崩溃，报告一些关于崩溃的信息（越多越好，但不要过度使用堆栈跟踪等）。
*   最好捕获程序的所有输出并报告；
*   该程序应该只使用当前目录，加上可能来自 SYSTEM32 的一些强制性 .DLL（如 kernel.dll、user32.dll 等）。尽可能限制对任何其他内容的访问。不需要访问注册表和网络之类的东西（除非强制性 .DLL 需要它）。访问越少越好。

这将是计算奥林匹克支持软件所需要的。该程序将在中央服务器上运行参与者提交的内容，因此您几乎可以期待任何东西。崩溃将是家常便饭，一些黑客攻击也是可以预料的。

那么 - 你将如何制作这样一个程序？你会用什么？在前面的主题（见上文）中，很明显作为调试器附加是一个坏主意，尽管也许我太笨拙了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T13:35:15.433

您几乎正在构建与 IIS 相同的流程模型 - 很有趣！我会使用 IIS 使用的相同工具，它对黑客攻击相对稳健，并且旨在将您的系统划分为许多并发作业。

您可以使用[Win32 Jobs](http://msdn.microsoft.com/en-us/library/ms684147(VS.85).aspx)设置内存、cpu、线程的配额，并且可以为不同的进程设置安全上下文以在其中运行，从而限制对文件系统的访问。

对于监控，我会查看[WMI](http://msdn.microsoft.com/en-us/library/aa394582.aspx)。

对于挂起或崩溃时的堆栈跟踪，我再次使用了 Microsoft 的[ADPlus 。](http://support.microsoft.com/kb/286350)

[要捕获控制台输出，请查看使用重定向输入输出](http://msdn.microsoft.com/en-us/library/ms682499(VS.85).aspx)创建子进程。

关于安全限制，创建一个低权限用户帐户并以该用户身份运行作业/进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T13:28:50.380

虚拟化解决方案解决了这个问题。也许您可以将您的解决方案基于 VMWare（或同等产品）并启动单独的虚拟机（每个进程一个）。您将获得良好的隔离、对内存/cpu 使用情况和报告的控制。每个进程都有包装操作系统的开销，但这取决于您的项目要求，它可能是可以接受的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T13:35:28.693

*   将可用内存限制为 X MB（作为参数给出）； **使用 VMWare 或类似的虚拟环境**
*   将可用执行时间限制为大约 X 毫秒（作为参数给出）。请注意，这是内核时间 + 用户时间，而不是空闲时间。另一方面，空闲时间也必须受到限制，以使程序不能无限地 Sleep()。
*   在程序终止时报告它实际花费的 CPU 时间； **内置程序代码。（挂钩 CPU 电源**
*   如果程序崩溃，报告一些关于崩溃的信息（越多越好，但不要过度使用堆栈跟踪等）。 **内置程序代码。（异常处理）**
*   最好捕获程序的所有输出并报告； **内置程序代码（日志文件）。**
*   该程序应该只使用当前目录，加上可能来自 SYSTEM32 的一些强制性 .DLL（如 kernel.dll、user32.dll 等）。尽可能限制对任何其他内容的访问。不需要访问注册表和网络之类的东西（除非强制性 .DLL 需要它）。访问越少越好。 **内置程序代码。（如果你的程序不使用 register ，它就不会使用它。**

# sql-server - 是否可以对 SQL (MS SQL Server 2005) 进行单元测试？

> ID：532305
> 
> 赞同：1
> 
> 时间：2009-02-10T13:23:10.300
> 
> 标签：sql-server, unit-testing

我们有很多表格、视图和东西。有几个人在同一个数据库上处理不同的东西，有时，我们改变了一些会破坏其他人工作的东西（比如改变视图中的列，或者改变存储过程的参数）。

有什么办法可以自动执行这些检查吗？我什至不知道是否可以对 MS SQL 进行单元测试，所以任何类型的自动化测试工具都会很好。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T13:24:47.190

[SQLUnit](http://sqlunit.sourceforge.net/)用于单元测试存储过程。

它基于 JUnit，因此可以像任何 JUnit 测试一样自动化 - 插入 ANT，使用持续集成工具运行等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T13:30:37.300

“Data Dude”作为 Visual Studio 2008 数据库版本的一部分存在。我没有使用过它，但我知道它非常适合 SQL Server 单元测试。 [http://blogs.msdn.com/gertd/archive/tags/DBUnitTesting/default.aspx](http://blogs.msdn.com/gertd/archive/tags/DBUnitTesting/default.aspx)

还可以查看 DotNetRocks show 312 - Andy Leonard on Unit Testing your Database [http://www.dotnetrocks.com/default.aspx?showNum=312](http://www.dotnetrocks.com/default.aspx?showNum=312)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-27T08:51:36.563

试试 TST：[http ://tst.codeplex.com/](http://tst.codeplex.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-27T01:05:37.823

在 Red Gate，我们在 SSMS 中构建了一个单元测试运行程序，称为 SQL 测试，它建立在 tSQLt 框架上。我们对任何想要自动化 SQL 测试的人的反馈感兴趣！欲了解更多信息，请访问 www.sql-test.com

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-13T03:01:28.123

为了完整起见，这里是@DavidAtkinson 提到的[tSQLt框架的链接。](http://tsqlt.org/)乍一看，它似乎很有希望，包括提供基于真实表创建假表的简单方法，将约束移动到假表等。

我以前使用过[TST](http://tst.codeplex.com/)，对此非常满意。不过，它似乎并没有被积极开发。

已经有一段时间了，但我认为我在 tSQLt 上使用 TST 的原因是因为 TST 有它自己的数据库，而 tSQLt 安装在正在测试的数据库中。我喜欢将测试和开发数据库分开的想法。就我而言，我有一个带有 TST 框架的数据库，一个带有我自己的单元测试的数据库，以及正在测试的（空）开发数据库。

# python - Python文件索引和搜索

> ID：532312
> 
> 赞同：13
> 
> 时间：2009-02-10T13:27:29.307
> 
> 标签：python, search, indexing, lucene

我有一个需要启用搜索的大型设置文件 (hdf)。对于 Java，我会使用 Lucene，因为它是一个文件和文档索引引擎。我不知道python等价物是什么。

谁能推荐我应该使用哪个库来索引大量文件以进行快速搜索？或者是自己滚动的首选方式？

我看过[pylucene](http://lucene.apache.org/pylucene/)和[lupy](http://pypi.python.org/pypi/Lupy/0.2.1)，但是这两个项目似乎相当不活跃且不受支持，所以我不确定是否应该依赖它们。

最后说明： Woosh 和 pylucene 看起来很有希望，但是 woosh 仍然是 alpha，所以我不确定我是否要依赖它，而且我在编译 pylucene 时遇到了问题，并且没有实际的发布。在我查看了更多数据之后，它主要是数字和默认文本字符串，所以现在关闭索引引擎对我没有帮助。希望这些库能够稳定下来，以后的访问者会发现它们有一些用处。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T18:51:31.697

Lupy[已经退役](http://divmod.org/trac/wiki/WhitherLupy)，开发人员推荐使用 PyLucene。至于 PyLucene，它的邮件列表活跃度可能很低，但绝对支持。事实上，它最近才成为[官方的 apache 子项目](http://lucene.apache.org/pylucene/#news20090108)。

您可能还想看看一个新的竞争者： [嗖嗖声](http://pypi.python.org/pypi/Whoosh/)。它类似于 lucene，但在纯 python 中实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T13:42:54.683

我以前没有做过索引，但是以下可能会有所帮助：-

1.  pyIndex - [http://rgaucher.info/beta/pyIndex/](http://rgaucher.info/beta/pyIndex/) -- Python 的文件索引库
2.  [http://www.xml.com/pub/a/ws/2003/05/13/email.html](http://www.xml.com/pub/a/ws/2003/05/13/email.html) -- 这是一个使用 Python 和 Lucene 搜索 Outlook 电子邮件的脚本
3.  [http://gadfly.sourceforge.net/](http://gadfly.sourceforge.net/) - Aaron water 的 gadfly 数据库（我想你可以用这个来做索引。我自己没用过。）

就使用 HDF 文件而言，我听说过一个名为 h5py 的模块。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T13:57:01.623

我建议[Sphinx](http://www.sphinxsearch.com/)。它非常活跃，具有更多功能，而且看起来比 Lucene 更快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T21:08:59.653

[Xapian http://xapian.org/](http://xapian.org/)是一个经常与 Python 一起使用的流行的基于 C++ 的信息检索库

它非常快并且可以愉快地管理大量数据，但是它不像 Lucene 那样容易扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-06T06:52:51.807

Elasticsearch 可用于索引文档和按关键字搜索
Elasticsearch 也可以与 graph db 和 hadoop 集成一些网址如下：
1）[https://www.elastic.co/products/elasticsearch](https://www.elastic.co/products/elasticsearch)
2）[https://towardsdatascience。 com/getting-started-with-elasticsearch-in-python-c3598e718380](https://towardsdatascience.com/getting-started-with-elasticsearch-in-python-c3598e718380)

# replication - 复制数据库

> ID：532319
> 
> 赞同：1
> 
> 时间：2009-02-10T13:29:22.220
> 
> 标签：replication

我想从数据库“B”执行数据库“A”的过程。我的情况是我有一个数据库'A'和一个数据库'B'。我希望当在数据库“A”上执行 proc 时，它也会在数据库“B”上执行。这是因为两个数据库的整体结构相同，但数据库“B”中的某些过程不同。我想匹配由 DB 'A' 和 DB 'B' 中的 proc 影响的结果。这个问题有什么解决办法吗？请帮我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T13:33:52.973

如果您使用 SQL Server 事务复制，则可以：[在事务复制中发布存储过程执行](http://msdn.microsoft.com/en-us/library/ms152754(SQL.90).aspx)和[复制存储过程执行](http://www.sqlservercentral.com/articles/Replication/61332/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T13:32:47.250

首先，您使用的是什么 DBMS？

MySQL 在使用 DB 复制时会复制存储过程，因此基本的 MySQL 复制应该可以正常工作。

# google-maps - 如何使 Google Maps 自定义 Overlay 对象的行为类似于 InfoWindow？

> ID：532320
> 
> 赞同：2
> 
> 时间：2009-02-10T13:30:00.440
> 
> 标签：google-maps, overlay

InfoWindow 的唯一问题是我无法自定义它的外观（即气泡，而不是它的内容）。似乎这样做的唯一方法是制作我自己的叠加层并设置样式。但这给我带来了一些问题，例如无法选择文本（将鼠标拖到此叠加层上只会平移地图）或滚动（如果叠加层有一个带有溢出文本的 div，则滚动会导致地图放大或缩小，单击滚动条会滚动，但会同时平移地图）。

我目前正在捕获 mouseover 和 mouseout 事件以禁用/启用拖动和缩放，但我仍然无法突出显示文本，现在在没有任何可滚动内容的覆盖区域上滚动鼠标滚轮会导致页面元素超出地图向上移动窗口。

有没有其他人遇到过这样的情况？我还没有看到任何其他内容实际上涵盖了这一点，我试图不扯掉我的头发试图找到一个解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-10-21T22:31:39.847

答案在 niiko 到 ExtInfoWindow 代码的链接中。我已将其拉出并将其插入到骨架自定义叠加层中：

```
var custom_overlay = {
  init : function(){
    window.CustomOverlay = function(position, map, opt_options){
      this.position_ = position;
      this.map_ = map;
      var options = opt_options || {};
      if (options['pixelOffset'] != undefined) {
        this.pixelOffset_ = options['pixelOffset'];
      }

      this.div_ = document.createElement("div");
      this.setMap(map);
    }

    CustomOverlay.prototype = new google.maps.OverlayView();

    CustomOverlay.prototype.onAdd = function() {
      if(!this.div_){
        this.div_ = document.createElement("div");
      }

      this.div_.style.cssText = "display:none; position:absolute;"

      var panes = this.getPanes();
      panes.floatPane.appendChild(this.div_);
      $(this.div_).appear();

      // catch mouse events and stop them propogating to the map
      google.maps.event.addDomListener(this.div_, 'mousedown', this.stopPropagation_);
      google.maps.event.addDomListener(this.div_, 'dblclick', this.stopPropagation_);
      google.maps.event.addDomListener(this.div_, 'DOMMouseScroll', this.stopPropagation_);

      google.maps.event.trigger(this, 'ready');
    }

    CustomOverlay.prototype.draw = function() {
      var overlayProjection = this.getProjection();
      var coords = overlayProjection.fromLatLngToDivPixel(this.position_);

      if (this.pixelOffset_) {
        coords.x += this.pixelOffset_.width;
        coords.y += this.pixelOffset_.height;
      };
      this.div_.style.left = (coords.x + 16) + "px";
      this.div_.style.top = (coords.y - 6) + "px";
    }

    CustomOverlay.prototype.stopPropagation_ = function(e) {
      if(navigator.userAgent.toLowerCase().indexOf('msie') != -1 && document.all) {
        window.event.cancelBubble = true;
        window.event.returnValue = false;
      } else {
        // e.preventDefault(); // optionally prevent default actions
        e.stopPropagation();
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:09:12.147

好消息。看起来我在 Firefox 中遇到的问题是由于我的叠加层的高度大于地图容器，并假设谷歌地图正在设置

```
溢出：隐藏
```

某处（我猜不是）。设置它自己解决了这个问题。下一步是让您的覆盖容器捕获点击事件并确保它们不会传播，如 ExtInfoWindow 代码所示：http: [//gmaps-utility-library.googlecode.com/svn/trunk/extinfowindow/1.0 /src/extinfowindow.js](http://gmaps-utility-library.googlecode.com/svn/trunk/extinfowindow/1.0/src/extinfowindow.js)（接近初始化结束）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T13:37:33.963

也许您可以通过创建使用相对 CSS 定位来隐藏/覆盖气泡的内容来解决无法自定义气泡的问题？

另外，（在黑暗中拍摄），我不确定，但您能否自定义一个标记并将其颠覆为一种信息窗口？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-21T13:14:31.473

我需要滚动覆盖，但出于某种原因，丹尼尔停止事件传播的解决方案对我不起作用。过了一会儿，我想出了另一个解决方案。

这假设您使用的是 Google Maps V3 和 jQuery。

首先，禁用地图中的滚动：

```
var mapOptions = {
  // Other options here
  scrollwheel: false
};
map = new Map(document.getElementById('map-canvas'), mapOptions); 
```

然后，使用[鼠标滚轮处理程序插件](https://github.com/brandonaaron/jquery-mousewheel)将滚动恢复，但仅在您需要时：

```
$mapDiv.mousewheel(function(e, delta, deltaX, deltaY){
  // If the event target is our overlay or its child, we won't zoom.
  if (!$(e.target).closest('.overlayWithScrolling').length) {
    map.setZoom(map.getZoom() + deltaY);
  }
}); 
```

# vbscript - 远程计算机上的 OpenTextFile

> ID：532332
> 
> 赞同：0
> 
> 时间：2009-02-10T13:33:36.797
> 
> 标签：vbscript, path, unc

我正在尝试使用以下代码读取远程文本文件：

```
function defdate(ipaddress)
  deffilePath = chr(34) & "\\" & ipaddress & "\c$\" & deffileName & chr(34)
  wscript.echo deffilePath
  set deffile = objFSO.OpenTextFile(deffilePath)
  do while not deffile.endofstream
    s=deffile.readline    
    wscript.echo s
  loop
deffile.close
end function 
```

我下面的 deffilePath 扩展成这样的字符串：

`"\\10.211.19.207\c$\Program Files\Common Files\Symantec Shared\VirusDefs\definfo.dat"`

但是，我收到“Microsoft VBScript 运行时错误：错误的文件名或编号”。
可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T13:39:36.017

您不需要（阅读：“不得”）将您的路径括在引号中。

```
deffilePath = "\\" & ipaddress & "\c$\" & deffileName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T13:40:32.503

您只需在使用命令行或类似 API 时包含引号 - CHR(34)。如果一个方法只需要一个文件名，就把它们排除在外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T13:41:45.917

问题是开头和结尾的“chr(34)”。在 Windows 运行菜单中键入路径时，您需要这些引号，但是当将路径传递给这样的函数调用时，您不需要它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T13:37:58.000

您是否尝试过最后删除 chr(34) ？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-10T13:35:31.503

我认为您需要在 UNC 路径名的开头使用两个反斜杠。尝试添加另一个！

我的猜测是它适用于“\\10.211.19.207\c$\Program Files\Common Files\Symantec Shared\VirusDefs\definfo.dat”。

# winforms - 具有折叠/展开功能的 .NET (WinForms) 网格控件

> ID：532335
> 
> 赞同：4
> 
> 时间：2009-02-10T13:35:14.123
> 
> 标签：winforms, .net-2.0

有人购买/使用了允许折叠/扩展父子关系的 DataGrid/GridView 控件吗？

我在 .NET 2.0 中使用的标准 DataGrid 控件在此功能方面似乎具有有限的功能。据我所知，较新的 GridView 控件根本不支持这一点。

我正在考虑开发一个自定义控件，但这对我的客户来说可能会变得昂贵..

我需要 WinForms（不是 ASP.NET）的这个控件

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T13:55:36.557

我们在这里使用[Janus Grids](http://www.janusys.com/janus/library/CustomPages/gridexnet.htm)多年，非常强大，但最近开始在新产品上使用[Developer Express](http://www.devexpress.com/)控件。. . 它们似乎更好（但*我*还没有太多使用它们）。

两者都应该给你你需要的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T14:45:35.513

Xceed 为这些做了一个功能非常齐全的库。有[WPF](http://xceed.com/Grid_WPF_New.html)和[WinForms](http://xceed.com/Grid_WinForms_Intro.html)实现。

我在旧版本上取得了很大的成功，不过我有一段时间没有升级了。

父子方面是完全可定制的，可以达到任意[1] 深度。

[1] 很好 int.MaxValue 但你永远不会到达那里

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-06T14:59:26.283

.NET的[NOV Grid](https://www.nevron.com/products-open-vision-nov-grid-control-overview.aspx)（可用于 WinForms 和 WPF）包括一个 TableGrid 和一个 TreeGrid。树形网格自引用从表格数据源生成树状结构。

Grid 组件可用于面向 .NET 2.0、3.0、3.5、4.0、4.5 或更高版本的项目。它也可用作可移植类库 (PCL)。

全面披露——我在 Nevron 工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T15:10:20.493

[VIBlend](http://www.viblend.com)有一个分层网格控件，可能会满足您的需求。这是一个 WinForms 实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-04T08:06:46.523

查看 10Tec 的 WinForms Grid iGrid。这是 10Tec 网站上与您的问题相关的文章：http: [//10tec.com/articles/treeview-in-datagridview.aspx](http://10tec.com/articles/treeview-in-datagridview.aspx)

# collaboration - 不记录工作的明星开发人员怎么办？

> ID：532338
> 
> 赞同：43
> 
> 时间：2009-02-10T13:35:29.443
> 
> 标签：collaboration

有一位同事非常了解自己的东西，他是我共事过的最聪明的人之一，但他：

*   在他自己的主目录的小区域中工作，而不是在公共[CVS](http://en.wikipedia.org/wiki/Concurrent_Versions_System)存储库中工作
*   没有**记录**他的代码
*   不**注释**他的代码，例如 3,500条 C 的[SLOC](http://en.wikipedia.org/wiki/Source_lines_of_code)，没有注释，也没有空行来分解
*   经常使事情变得过于复杂，例如使用三个相互调用的 shell 脚本来完成一个简单的 shell 脚本可以完成的工作。

也许这可能是那些认为“如果我是唯一知道这一点的人，他们就无法摆脱我”的人之一？

关于做什么的任何建议？

顺便说一句，管理层了解情况并正在尝试改变事情。

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-02-10T13:59:58.493

在我看来，像你上面描述的那样做愚蠢事情的人不能成为明星开发者！在我看来，他似乎故意让事情变得更复杂，这样除了他自己之外没有其他人可以维护代码。这让他自己比实际上更重要！跟他说话。他必须改变它！如果他不这样做，请用真正的明星开发者代替他！

我向你保证，即使是半年，他也不会知道自己的代码是如何工作的！解雇他，您可以节省大量时间和金钱。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-02-10T13:39:40.073

CVS 部分很简单——一个“意外”的硬盘故障会给他上一堂终生的教训（确保你有一个备份，这样你就不会真正丢失代码）

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-02-10T13:39:56.687

这听起来像一个艰难的情况。

就个人而言，我会让他走。他可能是一个明星开发者，但他不是一个团队合作者。如果你想制作一个好的产品，你需要有一个有凝聚力的团队可以一起工作。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-02-10T13:45:21.527

不记录是确保工作安全的一种（非常糟糕的）方法。

你可以做几件事来解决这个问题：

*   添加文档作为个人绩效评估的要求。
*   不要接受没有记录的软件。
*   与开发人员交谈并找出他不记录的原因。
*   购买一个很酷的文档工具。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-02-10T14:09:12.357

播放您从电影中看到的**坏警察/好警察素描。**让管理层成为坏警察，而你成为好警察。让管理人员要求提供他工作的过度杀戮文档和每分钟 ZIP 备份。但是您向他提供了适度的文档（例如通过 doxygen）和通常的源代码管理签入...

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-02-10T13:43:13.073

跟他说话？

如果他真的是“明星开发者”，他会注意到你说的话。

这可能不会在一夜之间改变他，但可能是他完全没有意识到其他人不像他那样明白这一点。

* * *

编辑：

现在改变可能有点晚了，但在制定解决方案时需要更多信息。这里的任何人都不可能仅根据这些观点来建议让这个人离开。如果去年你每天都在告诉那个人他需要改变或者他离开了这里，那么你可以让他离开。但是，我没有看到任何证据。

可以教一个出色的开发人员使用源代码控制、评论和文档。如果你在这里付出努力，那么你真的会拥有一个明星开发者。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-02-10T17:49:55.960

您可能在这里专注于错误的领域，您有机会看到您的流程中的一些弱点。

> *   *在他自己的主目录的小区域中工作，而不是在公共 CVS 存储库中工作*

在这里简单的聊天可能就足够了，版本控制的好处不言而喻，任何“聪明”的人都可能对这些好处充满热情。然而，这也可能是一个很好的机会来研究允许更大易用性和灵活性的替代版本控制系统（看看 bzr 和 git）。更好的是，让他参与选拔过程，如果他真的是一个“明星”，他可能会有很好的投入，并且更加投入使用。

> *   *没有记录他的代码*

听起来文档不是您流程的一部分。人们会抵制必须做额外的工作，如果没有明确的流程，那么你就是在谈论很多额外的工作。真的需要文档吗？如果是这样，是否定义了创建它的过程？你应该有一个完全致力于它的人吗？您是否应该至少有一个工具来促进它（也许像 mediawiki 这样简单）？

> *   *不评论他的代码，例如 3,500 SLOC 的 C 没有评论，也没有空行来说明问题*

三个词：同行代码审查。除了明显的错误捕获好处之外，这也可以提供一些同伴压力，这是一种强大的力量，可能是一件好事。想要被你的同龄人很好地感知会自我产生所有权和质量。

> *   *经常使事情变得过于复杂，例如使用三个相互调用的 shell 脚本来完成一个简单的 shell 脚本可以完成的工作。*

再次，同行代码审查。你提到管理层知道这个程序员的缺陷。他有吗？如果人们不认识到他们做事方式的问题，就很难改变和改进。

而且，也许最重要的是，通过制定改进您的开发过程的计划（这可能不仅会改善您的“明星”，还可能会改善团队中的其他人），您可能会从管理层那里为自己赢得一些金星。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-02-10T14:12:16.750

对我来说，这听起来不像是明星程序员。所有优秀的程序员都知道代码格式和源代码控制的使用很重要。听起来虽然他自己取得了很好的进展，但他正在阻碍其他团队成员的进展，这可能会对完成的工作产生净负面影响。和他谈谈，如果他拒绝改变他的做法，让他走。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-02-10T13:54:41.580

如果他真的那么聪明，你不能改变他的方式，也不想失去他，但你仍然希望你的代码被记录和评论，那么我的建议是让经验不足的开发人员为他做文档和评论。就个人而言，如果我是一名明星开发人员，如果让其他人评论我的代码并且我最终会开始自己做，我会觉得非常愚蠢。与此同时，虽然这种情况不会发生，但经验不足的开发人员可能会学到一两件事。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-02-10T13:49:32.343

成为明星开发人员不仅仅是成为一名优秀的程序员。如果他没有团队技能并且故意无视团队标准，则需要向他提出。如果他在与管理层交谈后拒绝遵守这些规定，那么他可能不适合您的公司。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-02-10T14:48:47.503

这个问题让我很紧张，因为虽然你描述的这个人听起来很糟糕，但我可以在他身上看到一点我自己。

我认为我是一个非常好的团队球员，我很幸运能加入一个非常好的团队。然而，我确实使用了我的同事不理解的方法，尽管我已经非常努力地解释它们。只是经验差距很大，这对我们任何人都没有影响。

文档是一个广泛而棘手的主题。我尝试遵循 DRY（不要重复自己）的格言。与代码分开的文档可能相当于重复自己，因此除非您放慢自己的速度以使其保持最新，否则它可能会过时。我通常的做法是事后补上。

通常我正在处理的问题非常棘手，以至于我可以提前计划并记录我想要的所有内容，但是当涉及到代码时，我经常发现我错了并且不得不重新考虑它。因此，在我看来，您可以提前记录内容并遵循它的想法仅适用于非常简单的问题。

无论如何，我认为这是一个很好的问题，答案一点也不简单。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-02-10T13:56:06.773

这家伙真的是摇滚明星吗？严重地？想一想。他是聪明，但没有把事情做好，还是他既聪明又能把事情做好？

想想真的很难。

如果他真的是摇滚明星，那么也许你不应该惹他。他正在使用自己的流程制作出令人难以置信的很棒的东西。仅仅因为有一种不同的做事方式最适合你，并不意味着这将使他能够创作出最好的作品。不要试图让他屈服于你的过程，这很可能会扼杀他所有的敬畏，你应该尝试找到一种方法来适应他的工作方式。

如果他真的像你说的那么好，你不应该介意那样做。如果不值得那么努力，那么他真的没有那么好。在这种情况下，你没有摇滚明星，你只有一个不喜欢按规则行事的平庸程序员。那些家伙，你应该摆脱它。不过，一个喜怒无常的摇滚明星通常值得痛苦，因为他或她可以制作出高质量的作品。那些人，你应该不遗余力地留住。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-02-11T03:24:22.040

听起来像一个明星程序员，他对自己的工作感到厌烦，并且过度复杂化以使其更具挑战性。他很快就会找到更好的东西。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-10T13:40:01.180

试图改变事情？你更喜欢什么，一个记录不充分的工作软件或一个记录良好的垃圾？有些人能够编写几乎不需要评论的软件，这不是质量的可靠指标。

恐怕你会失去一个优秀的开发者。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-10T13:56:46.240

“嗨星开发者，

只是一个非正式的提醒告诉你，从下周开始，我们将需要代码文档，并在代码中提供有用的注释 - 这将是公司政策，不会有任何例外”

从那时起，你只需像处理未能按时上班、未能停止在工作中打发时间等一样处理失败。底线是老板说文件，你文件还是你你没有做好你的工作。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-02-10T14:51:28.653

如果他这样工作，他就不是明星开发者——伟大的软件开发者明白可维护性是极其重要的。从长远来看，你可能会为此付出高昂的代价，我会非常直接地告诉他这有多严重，如果他不能开始适应，就让他走。我以前见过很多次，这是一个定时炸弹。

老实说，我见过很多这样的开发人员，除非他们刚刚离开学校，否则他们不会改变。我说现在削减你的无损，随着他继续喷出更多不可维护的代码，解雇他只会变得更加困难:)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-10T13:41:59.800

如果他真的很聪明，管理层不太可能摆脱他。

当然，整个项目可能会被关闭，但无论如何，CVS 和文档将毫无用处。

没有管理层会解雇一个优秀的程序员只是为了雇佣一个糟糕的程序员。

告诉他，这将有助于**他**随时摆脱管理。

他想换什么工作？他可以告诉管理层：“好吧，人们，一切都像你问我的那样：登记、记录并在你的控制之下。我完成了我的工作，我收拾行李离开了”。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-02-10T13:43:19.033

代码文档被高估了。CVS 培训很容易。

一个好的类应该通过它的方法和属性来揭示它的目的。

在应用程序之外记录模型也更容易流动和理解。

我会提请他注意，如果你不能解决它，看起来你将失去一位明星开发者。

编辑：哎呀 - 使用 CSV 而不是 CVS，对于许多导入，我使用 svn heh。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-02-10T13:44:27.190

没有他，球队能成功吗？如果是这样，请推动问题并拒绝接受任何未正确记录或不符合其他标准的代码。希望这会让人明白这一点，但这可能只会让他生气并导致他退出。如果球队在没有他的情况下无法取得成功，那么你就很不走运了，直到你可以训练一个达到他技能水平的替补球员，这可能不值得花时间和精力。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-02-10T13:44:40.433

+1 to ocdecio - 如果他是明星开发人员，那么他的代码应该基于如此高质量的设计，以至于它可以记录自己。

话虽如此，但令人沮丧的可能是，尽管他在他感兴趣的技术要求高的领域表现出色，但他并没有在交付功能时混入 - 只有你会知道这是否对你的组织来说是个问题。

有一个可用的“大师”可以是一个绝对的救星——或者至少它曾经是，或者 StackOverflow 让这个角色变得多余了？

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-02-10T13:49:54.307

在通过代码审查之前不要让代码发布，并且只有在他为当前功能/项目编写的代码有足够的注释和/或文档时才允许它通过。

**编辑**在他的评价中提出来。可以为他的“改进领域”提供文档/评论代码。

:-)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-02-10T13:50:53.180

您还可以添加自动质量检查，以防止他签入他的代码，直到它被充分记录。

那就是如果你能说服他在第一时间登记入住！（这是必不可少的，imo）

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-02-10T14:25:30.993

这里有很多人在“没有评论，那又怎样？” 这里的潮流。没有注释的识字代码是完全可能的，但是仅仅因为某人很聪明并且不注释并不一定意味着他们正在编写识字代码。

所以让我们澄清一下。您已经说过他根本不记录他的代码，无论是在注释中还是在单独的文档中，并且他不使用任何源代码控制。怎么样：

*   尽管没有注释，他的代码是否可以理解？
*   您的团队是否使用他参与的任何类型的问题跟踪（例如 FogBugz、Bugzilla 等）？
*   他的代码在测试中吗？
*   团队中是否还有其他人实际上至少对他的代码是如何工作的有点熟悉？
*   他是否愿意至少承认他可以在与团队其他成员合作的方式上做出一些改变？

如果所有这些问题的答案都是“否”，那么你就有大问题了。仅仅聪明并不一定会使某人成为资产。你能保证他明天不会离开你的公司，或者被公共汽车撞到吗？如果发生这种情况，你会有多糟糕？值得冒险吗？

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2009-02-10T14:29:49.233

我认为这在任何环境中都很典型。你如何让别人做你想做的事？这正是“如何赢得朋友和影响他人”的全部内容。戴尔·卡耐基（Dale Carnegie）不是操纵，而是管理人。

在我看来，他只是缺乏经验，需要一些经验和指导。

你觉得你可以坐下来和他谈谈这些问题吗？告诉某人他们做错事通常看起来是错误的做法（尤其是在当今我们不想伤害他人感情的西方社会中），但我认为通过冷静和诚实地解释问题和谈论他们。如果这个人尊重你和你的意见，这会有所帮助，这是一个完全不同的问题，在上面提到的书中有所讨论。确保他明白这些是严重的问题。此外，在任何未来的开发工作中，他也将被期望做这些​​事情，所以现在练习它们是一个好主意。

我不认为等到下一次绩效评估是一个好主意。堆积一堆负面反馈并一次提供所有反馈只是一个坏主意，当我这样做时我真的不喜欢它。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-02-10T14:17:44.363

你不能因为没有做你在那里建议的事情而杀人。他只是不一样。

```
if(developer.IsHuman())
{
    developer.IsUnique = true;
} 
```

我和那些写垃圾（并称之为代码）的人一起工作。我也这样做。有时。但是，正如您已经感觉到的，当您知道自己的工作会影响他人时，不改掉坏习惯很烦人。试着说服他更多。

**而且，除非您是“经理**” ，否则我认为您在这种情况下无能为力。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-02-10T14:32:06.997

1.  让他使用自动执行验证工具。（请参阅我的回答“[如何向阻碍论者提问？](https://stackoverflow.com/questions/532509/how-to-ask-questions-to-an-obsructionist/532530#532530) ”）

2.  如果他过于复杂并且不使用 SCC，那么他就*不是*一个优秀的开发人员——这些都是软件工程的重要组成部分。

3.  万一他在算法等领域具有不可替代的才华，分配他在该领域工作，例如定义算法，并让真正的程序员进行编码。

4.  使用静态分析代码来理解和清理他的代码。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-02-10T14:52:42.860

结对编程。找到他对你刚刚列出的要求将“完成”他。您将通过源代码控制、文档记录、质疑他的每一个行为等来解决问题。您还可以利用第一人的力量训练其他人

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-02-10T15:03:29.137

从你的描述来看，这家伙显然**不是**明星开发者。编程是一项团队运动，与他人相处不好的人不会为项目增加太多价值。

就个人而言，我可能不记得我在 6 个月或更长时间前编写的代码，并且非常重视某种源代码控制中的更改历史。

如果你和这个人定期进行代码审查，我想你会发现他并不像你想象的那样出色。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-02-10T15:17:17.187

我同意这个线程上的大多数人。将他置于热点的一种方法是进行团队代码审查。

对于第一次代码审查会议，从开放并接受建议的团队成员中选择代码。“明星”开发人员将有机会了解代码审查是如何工作的，然后您可以安排他的代码进行下一步审查。给他一些时间为下一次会议做准备，到那时他至少应该评论他的代码。

代码审查的目的不是要让人们感到羞耻，而是要协作识别问题和需要改进的地方，但这将是让明星开发人员坐上热搜的好方法。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2009-02-10T16:25:34.090

在我看来，你需要放弃这个人。听起来他的代码是不可读的，他绝对不是一个团队，也不是一个安全的球员。

让某人认为自己是不可或缺的也是一种非常糟糕的做法。如果你让他继续这样做，他的做法会变得更糟，而不是更好。当他离开时，对于每个人来说，你都会对纠结的代码感到头疼。如果他不恢复，你现在需要减少损失。

最后，留住这位开发人员而不控制他，这给初级开发人员树立了一个糟糕的榜样。如果你强迫他们正常工作，你可能会受到“为什么是他而不是我”人群的不满。如果你不这样做，你会得到一堆像你的“明星”一样工作的黑客。

简而言之，除非他非常非常快地成型，否则是时候放弃他了，为了整个开发人员的健康和理智。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-02-10T16:48:16.360

当我在 3 年前开始现在的工作时，我们遇到了类似的问题，我们的首席开发人员是一名牛仔。他真的很聪明，但非常不稳定，他的一些东西有很好的文档记录，但过于复杂以至于无法维护，或者先编写代码然后弄清楚他在构建什么，他会扔掉代码，看看能坚持什么。

他大约在 2 1/2 年前离开了，当我们找到他的一些旧代码时，它仍然困扰着我们，并且在他的辩护中，这就是这里的开发商店当时的运作方式，在过去的 3 年里，我一直在讨伐改变这种心态。

当您成为明星开发人员时，您就不再关心您对系统、代码、框架、架构等的了解程度，而是更多关于

1.  编写优雅、可维护、灵活、可读的代码
2.  与团队的其他成员一起工作：使用源代码控制、以身作则等。
3.  记录每个方法、类、对象等在做什么
4.  研究新的更好的方法来为自己和你的团队做事

如果您没有在某种程度上遵循所有这四个，您就不是明星开发者，更何况如果您拒绝尝试/学习使用它们，那么是时候以某种方式寻找其他就业机会了，我听说饥饿的艺术家很受欢迎与这个时代的人（整个误解天才的事情）

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2009-02-10T17:06:01.667

虽然在某些情况下个人成就可能很重要且有用，但最终使大多数项目成功的是团队合作以及所有参与者和利益相关者之间的良好合作。

文档是协作过程的一部分。如果您的“明星开发者”不重视这个话题，请通知他并将其放在他的评论中。

记录您的“明星开发者”由于缺乏文档而导致的问题。用这些问题的例子向高层管理人员说明这个问题，并确保他理解后果。如果他在这方面继续失败，那么将其视为任何其他失败......终止是最后的课程。

最重要**的是，让他意识到问题并给他一个改进的机会。**如果您在约定的时间内没有看到任何改善，那么他就不愿意改善自己和团队。你知道必须做什么！

祝你好运！安德烈斯

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2010-02-07T03:12:19.883

可能是他“知道他的东西”的原因是因为它正是——“他的东西”。最好的代码是其他程序员可以自信地理解和修改的代码。

不指导他人并且只编写他们理解的代码的令人印象深刻的编码人员在恕我直言是一种责任 - 特别是在他们回答了足够多的问题之后，因此您知道如何重写他们的代码并可以将它们发送给其他人。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2011-11-17T13:19:15.203

我*就是那*个人。

让我大开眼界的是升职。一位非常聪明的老板让我成为“团队负责人”，说他认可我的编码能力，并希望我帮助团队的其他成员达到我的标准（他是一个说话圆滑的酒吧管家）。然后他给了我一组没有明确包括“文档”、“评论”等的目标——但这不可避免地把我推向了那个方向。一旦我的工作是告诉团队的其他成员如何做他们的工作，我自己就不太可能不去做。

目标是“当新开发人员加入时，他需要在 5 天内充分发挥生产力”；“部署必须少于 3 天”，“代码必须通过我们的外部审计团队的审计”，以及“实施持续集成和单元测试”。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-02-10T14:29:37.130

惯于？如果您已经尝试过其他所有方法，那么可能是时候提醒他在他的工资支票上签名的人了。

严重地！

一个明星开发者在他被公共汽车撞到并且其他人必须在他的代码上工作之后的 5 年对你没有好处。

不使用 CVS？在我工作的一家公司，我们因不签到而被罚款，罚款三笔，然后你就被解雇了。你的源代码就是你的生意，你失去了你的源代码你就失去了生意。再次，我会提醒这个人，他的薪水取决于以下公司标准。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-02-10T20:04:25.000

> 经常使事情变得过于复杂，例如使用三个相互调用的 shell 脚本来完成一个简单的 shell 脚本可以完成的工作。

这听起来不像是他在给我写有文化的自我记录代码，而是相反。似乎他对过于复杂的解决方案的选择产生了对文档的异常大的**需求**，并且也使缺乏文档成为一个更严重的问题。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-02-11T01:12:23.870

我认为团队成员应该了解彼此的职责，即使用 DB 是 DBA 的职责，您不要要求 QA 应用 DB 补丁。DBA 不能拒绝，因为这是他/她的责任。每个人都应该清楚，团队成员的职责之一是编写其他团队成员易于理解的代码。我认为从这个角度来看，它应该由他的报告人来解决。

如果您的 DBA 不使用 DB，而是做其他事情，比如构建 UI，那么他/她就不会做他的工作。你的同事也一样——如果他编写的代码无法被其他团队成员理解——他就没有做好他的工作。

编写同事无法理解的代码不应视为完成任务。编写不在 CVS 中的代码，因此无法被其他团队成员审查，直到为时已晚 - 也不应被视为完成任务。写 3 个脚本而不是 1 个应该被认为是浪费时间。

如果管理层无法理解这一点并仍然认为他是摇滚明星程序员 - 考虑更换管理层。

我还要强调，目标不是写评论本身。它应该是可理解的代码，易于维护。我个人认为注释是使我的代码易于理解的最后手段——我更喜欢简洁的设计和命名。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-02-11T01:31:05.620

将他的代码还给他并告诉他修复它，否则他会被解雇。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2009-02-11T01:33:52.070

代码审查失败。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-02-11T03:42:28.643

除了许多其他建议之外，您还可以尝试以下另一种技巧：

无论出于何种原因，您似乎都倾向于认为您的开发人员的行为和方法很糟糕。假设你已经和他讨论过，而他没有提供让你满意（或愿意改变）的理由，我会说你有两个明显的选择：摆脱他，或者接受它。我建议，在这种情况下，你对他如何编写代码的要求非常坦率，让他选择接受或离开。

例如，我的前任雇主（在管理层改组后）决定不再允许开发人员在代码中使用“断言”，因为他们认为这不必要的混乱，并且与现在“负责”的现有风格不一致" 组（他们编写了非常直接的低级 C 风格代码，没有断言或防御性编程技术）。管理层和我进行了直接讨论，他们告诉我我需要适应他们的风格或者离开，我决定离开。总的来说，我认为这对双方来说都是最好的。

并不是每个人都会对编码、代码指南或开发过程有相同的看法，最终，付钱的人制定规则（与实际生产事物的需要相平衡）。你对自己的需求越是坦诚，开发者的怨恨就越少。

# python - 如何在我的 Python 程序中找到内存泄漏？

> ID：532346
> 
> 赞同：34
> 
> 时间：2009-02-10T13:37:14.557
> 
> 标签：python, debugging, memory-leaks, twisted

> **可能重复：**
> [Python 内存分析器](https://stackoverflow.com/questions/110259/python-memory-profiler)

我有一个相当复杂（大约 20,000 行）的 Python 程序，经过一些开发后，它在运行时开始消耗越来越多的内存。找出所有内存的用途的最佳工具和技术是什么？

通常这归结为意外保留对对象的引用，或扩展模块错误（这不太可能，因为我们已经使用 Python 2.4 安装一段时间了）。

我们正在使用各种第三方库，例如 Twisted、Twisted Conch 和 MySQLdb。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T13:58:31.727

通常，未能关闭游标是最常见的内存泄漏类型之一。垃圾收集器看不到游标所涉及的 MySQL 资源。`close()`除非显式调用该方法，否则 MySQL 不知道 Python 端已发布。

经验法则。在您可以管理的尽可能短的代码范围内 打开、使用**和关闭游标。**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-10T13:53:38.027

Python 的内存由垃圾收集器管理。一般来说，内存泄漏应该没有问题（绝对不是 Python2.5 及更高版本），除非你碰巧用 C/C++ 编写扩展模块。在这种情况下，Valgrind（博客文章 - [http://bruynooghe.blogspot.com/2008/12/finding-memory-leaks-in-python.html](http://bruynooghe.blogspot.com/2008/12/finding-memory-leaks-in-python.html)）可能会有所帮助。我发现这个人 - [http://mg.pov.lt/blog/hunting-python-memleaks](http://mg.pov.lt/blog/hunting-python-memleaks)使用 PDB 和 matplotlib 来跟踪内存泄漏。我希望这会有所帮助，我没有修复 Python 内存泄漏的经验。

# sql-server - 如何从 SQL Server 中的货币数据类型转换？

> ID：532351
> 
> 赞同：23
> 
> 时间：2009-02-10T13:38:38.407
> 
> 标签：sql-server, currency

我在 SQL Server 中有一个金钱数据类型。如何在查询中将 0.00 重新格式化为 0？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-10T14:27:18.913

正常的货币兑换将保留个人便士：

```
SELECT convert(varchar(30), moneyfield, 1) 
```

最后一个参数决定输出格式的样子：

0（默认值）小数点左边每三位不加逗号，小数点右边每两位不加逗号；例如，4235.98。

1 逗号在小数点左边每三位，在小数点右边两位；例如，3,510.92。

2 小数点左边每三位不加逗号，小数点右边每四位不加逗号；例如，4235.9819。

如果要截断便士并以磅为单位计算，可以使用四舍五入到最接近的磅、下限到最低的整磅或上限来四舍五入：

```
SELECT convert(int, round(moneyfield, 0))
SELECT convert(int, floor(moneyfield))
SELECT convert(int, ceiling(moneyfield)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T13:44:15.460

将其转换为 int 对您有帮助吗？钱是有小数位的...

```
DECLARE @test AS money
SET @test = 3
SELECT CAST(@test AS int), @test 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T13:45:08.220

首先，你永远不应该使用 money 数据类型。如果您进行任何计算，您将得到截断的结果。运行以下命令以了解我的意思

```
DECLARE
    @mon1 MONEY,
    @mon2 MONEY,
    @mon3 MONEY,
    @mon4 MONEY,
    @num1 DECIMAL(19,4),
    @num2 DECIMAL(19,4),
    @num3 DECIMAL(19,4),
    @num4 DECIMAL(19,4)

    SELECT
    @mon1 = 100, @mon2 = 339, @mon3 = 10000,
    @num1 = 100, @num2 = 339, @num3 = 10000

    SET @mon4 = @mon1/@mon2*@mon3
    SET @num4 = @num1/@num2*@num3

    SELECT @mon4 AS moneyresult,
    @num4 AS numericresult 
```

输出：2949.0000 2949.8525

现在回答你的问题（有点模糊），money 数据类型在小数点后总是有两位。如果您不想要小数部分或转换为 int，请使用整数数据类型。

也许您想使用小数或数字数据类型？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-12T10:37:24.757

我发现这种[方法](http://www.onceinaweb.com/23/web-and-database-development/convertvarchar10-convertmoney-cprice-as-price-was-all-it-took)直接且有用。

CONVERT(VARCHAR(10), CONVERT(MONEY, fieldname)) AS PRICE

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-24T05:14:48.363

你可以这样尝试：

```
SELECT PARSENAME('$'+ Convert(varchar,Convert(money,@MoneyValue),1),2) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-29T00:31:12.777

尽管货币数据类型存在内在限制，但如果您已经在使用它（或者像我一样继承了它），您的问题的答案似乎是，使用 DECIMAL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T13:46:00.947

这对我来说似乎是一个格式化问题。
就 SQL Server 的货币类型而言 0 == 0.00

如果您想在 c# 中显示 0 而不是 0.00，则应将其转换为字符串，并根据需要对其进行格式化。（或截断它。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-20T18:47:28.263

你可以使用

```
SELECT PARSENAME('$'+ Convert(varchar,Convert(money,@MoneyValue),1),2) 
```

或者

```
SELECT CurrencyNoDecimals = '$'+ LEFT( CONVERT(varchar, @MoneyValue,1),    
       LEN (CONVERT(varchar, @MoneyValue,1)) - 2) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-20T14:39:31.050

我也有这个问题，并且被绊倒了一段时间。我想将 0.00 显示为 0，否则保留小数点。以下没有奏效：

```
CASE WHEN Amount= 0 THEN CONVERT(VARCHAR(30), Amount, 1) ELSE Amount END 
```

因为结果列被强制为 MONEY 列。为了解决它，以下工作

```
CASE WHEN Amount= 0 THEN CONVERT(VARCHAR(30), '0', 1) ELSE CONVERT (VARCHAR(30), Amount, 1) END 
```

这很重要，因为我的最终目标列是 VARCHAR(30)，如果金额是“0.00”而不是“0”，该列的消费者会出错。

# .net - 如何选择一个开源项目加入？

> ID：532352
> 
> 赞同：17
> 
> 时间：2009-02-10T13:38:45.207
> 
> 标签：.net, open-source

我有兴趣加入一个使用 .net 的开源项目；我希望能够在成熟的项目和开始的项目以及其他标准之间进行选择。你有什么建议？（欢迎具体项目）。

后期编辑：

我对迄今为止收到的傲慢评论/答案感到失望。选择一个 OS 项目来贡献不是一件简单的任务。我今天花了很多时间来做这件事。我的经验表明：

*   很少有项目宣传如何为他们做出贡献
*   很少有项目甚至让你贡献
*   许多项目希望您通过编写文档和回答用户问题来做出贡献
*   有很多项目“死”了
*   不是每个人都使用用 .net 编写的操作系统软件——它是一个初级社区——所以“为你使用的项目做出贡献”的标准没有用

我相信这个问题还远远没有得到回答。我仔细阅读了相关问题，那里有一些好点，但没有真正揭示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T13:39:54.563

显而易见的标准是在您感兴趣的领域选择一个项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T14:17:20.107

这是我要做的：

*   找到您感兴趣的项目。也许您想了解一些特定的技术/应用程序，或者您只是想体验开源项目与企业项目的不同之处。
*   查看代码、文档、论坛等，并考虑他们的风格/约定是否适合您。
*   向项目成员展示自己，让他们知道你能为聚会带来什么。
*   编写代码并享受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T14:04:12.090

不管 Bogdan 的评论如何，@Rob 的建议都是一个很好的建议，原因有几个。

如果你选择了一个你感兴趣的开源项目，例如，如果你喜欢音乐然后从事[Audacity](http://audacity.sourceforge.net/)项目，那么：

1.  您将更有动力，因为该项目正在尝试解决您感兴趣的问题空间的各个方面
2.  您将您的特定知识带到项目中，这将对项目有用
3.  您将（可能）从参与该项目的其他人那里更多地了解您感兴趣的领域
4.  您完成了要使用的项目的改进版本

高温高压

干杯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T14:35:36.990

我认为对我来说最重要的标准是

1.  以我熟悉或渴望学习的语言编写的项目
2.  一个有活跃成员的项目。谁想加入一个开源项目并自己做这一切
3.  我会在家里使用的项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T15:36:15.513

我发现你的问题反映了我自己的兴趣，所以这里有一些***我*** 正在考虑的操作系统项目：

*   [SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/) - 他们已经走了很长一段路，还有很长的路要走:-)。我认为对代码导航和代码重构的一些改进，如 ReSharper（甚至 Eclipse）会非常酷。
*   [NHibernate](http://www.hibernate.org/428.html) - 对泛型的支持（尽管我认为 Ayende 已经涵盖了这一点）；支持工具 - 用于 xml 配置的可视化编辑器，也许是一个可视化工具（VS 插件？），它采用 {model, mappings, database_schema} 之一并生成另外两个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T15:42:28.213

看看Aaron Bockover 的[Banshee](http://banshee-project.org/)。它是用 C# 为 Mono 编写的，也是[GnomeLove](http://live.gnome.org/GnomeLove)计划的一部分，因此有专门为新贡献者标记的错误。

当我有空闲时间自己破解一些东西时，这将是我的第一选择。这是一个非常好的音乐播放器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T15:45:30.873

加入 IronScheme！:)

更新：

最好的办法是参加一个拥有活跃社区的项目（您在家感觉更快，帮助也更快）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T14:26:37.370

加入您实际使用或需要的软件团队。作为用户，您将有更多的动力去完成它并了解软件应该如何工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T16:29:05.190

我发现了一个非常有趣的 .net 项目——它叫做 Terranium。

[http://www.codeplex.com/terrarium2/](http://www.codeplex.com/terrarium2/)

这是一款您以*编程*方式创建动物并与其他动物互动的游戏。也为这个项目做贡献会很有趣，但我还没有看到他们（它由 MS MVP 运行）是否接受这个。

# java - 应用服务器中的线程

> ID：532360
> 
> 赞同：12
> 
> 时间：2009-02-10T13:40:16.560
> 
> 标签：java, multithreading, glassfish, ejb, application-server

我有一个想要部署到应用程序服务器（GlassFish）中的 Java 程序/线程。线程应该作为“服务”运行，在应用服务器启动时启动，在应用服务器关闭时停止。

我该怎么做呢？它不是真正的会话 Bean 或 MDB。这只是一个线程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T14:16:01.310

我只用 Tomcat 做过这个，但它应该在 Glassfish 中工作。

创建一个实现的Listener类[`javax.servlet.ServletContextListener`](http://docs.oracle.com/javaee/7/api/javax/servlet/ServletContextListener.html)，然后放到web.xml中。当您的网络应用程序启动和销毁时，它将收到通知。

一个简单的监听器类：

```
public class Listener implements javax.servlet.ServletContextListener {

    MyThread myThread;

    public void contextInitialized(ServletContextEvent sce) {
        myThread = new MyThread();
        myThread.start();
    }

    public void contextDestroyed(ServletContextEvent sce) {
        if (myThread != null) {
            myThread.setStop(true);
            myThread.interrupt();
        }
    }

} 
```

这在你最后一个'context-param'之后和你的第一个'servlet'之前的web.xml中：

```
<listener>
    <listener-class>atis.Listener</listener-class>
</listener> 
```

不知道这种东西是否推荐，但过去对我来说效果很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T14:00:52.487

这不是您应该在任何应用服务器中执行的操作，除非您有权访问应用服务器提供的托管线程。我不熟悉 Glassfish，但您可以使用 commonj WorkManager 在 Websphere 或 Weblogic 中执行此操作。

显然，同样可以通过 JCA WorkManager（我不熟悉）在 Glassfish 和 JBOSS 中完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T22:19:00.407

查看*LifecycleListener*接口：

[http://glassfish.java.net/nonav/docs/v3/api/index.html?com/sun/appserv/server/LifecycleListener.html](http://glassfish.java.net/nonav/docs/v3/api/index.html?com/sun/appserv/server/LifecycleListener.html)

[http://docs.oracle.com/cd/E18930_01/html/821-2418/beamc.html](http://docs.oracle.com/cd/E18930_01/html/821-2418/beamc.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T13:52:19.700

创建一个 servlet，其 init 方法启动一个作为主程序的线程。

```
public void init() throws ServletException {
    mailThread = new MailSendThread();
    mailThread.start();
} 
```

在我们应用程序的 web.xml 文件中添加一个 servlet，该 servlet 包含一个 load-on-startup 元素，其中数字是它的启动顺序。

```
<servlet>
    <servlet-name>Mail Sending Servlet</servlet-name>
    <servlet-class>MailServlet</servlet-class>
    <load-on-startup>2</load-on-startup>
</servlet> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T14:11:43.240

我还需要创建几个线程，每个线程都会打开一个套接字，连接到在我的 Glassfish 应用程序中运行的另一个远程进程。服务器。我查看了您需要实现的 Glassfish 提供的 LifecycleListener bean。

我创建了一个原型来执行 LifecycleListener 实现中的线程和套接字工作，但它确实对管理这些资源没有帮助。要访问 LifecycleListener，我必须放置一个**公共静态**方法来执行所需的操作。

我在 LifecycleListener 中看不到任何价值，因为我可以在我的 EJB 中执行完全相同的工作，即调用 LifecycleListener 的客户端。因为 bean 中的 Thread 和 Socket 确实没有适当的管理。

有人告诉我，JCA 可能是最好的选择。我没有试过这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-01T13:34:06.143

我使用计时器服务启动一个定时对象，并且只有一个过期时间。然后，在超时期间，我对线程做我想做的事情。

[http://onjava.com/pub/a/onjava/2004/10/13/j2ee-timers.html](http://onjava.com/pub/a/onjava/2004/10/13/j2ee-timers.html)

对我来说，它之所以有效，是因为它使用 J2EE 组件并且是一个不同的线程。

# c# - Linq2SQL：总是让 .Sum() 返回 0 而不是 null

> ID：532362
> 
> 赞同：4
> 
> 时间：2009-02-10T13:40:32.707
> 
> 标签：c#, linq-to-sql, null

有什么方法（通过扩展机制？）让`Sum()`函数始终返回 0。

我现在的解决方法是这样写，但我希望有更好的解决方案？

```
((int?)e.CampaignCodes.Sum(f => f.Enquiries.Count()) ?? 0), 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T14:27:46.057

您的解决方法是一个很好的解决方法。为什么不为 IEnumerable 编写一个类似于 Sum 的扩展方法，称为 SumOrDefault。然后，您可以重用您的扩展方法，而不必查看解决方法。

您的扩展方法将非常简单，只需使用解决方法中的确切代码即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T13:53:24.250

这其实是一个很好的方法。我认为更好的问题是为什么它一开始是空的？除非您调用总和的实体为空，否则查询应始终返回 0。与强制总和始终返回 0 相比，查看您的实体在开始时是否有效可能是一个更好的解决方案——空意味着有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T14:12:19.323

它应该是 0 还是 null 的问题是一个棘手的问题。这取决于您将“总和”解释为什么。如果它是“所有（选定）记录的总和”，那么当任何记录包含 NULL 时，null 将是合适的，因为您在技术上不确定。如果它的意思是“所有已知（选定）记录的总和”，它应该返回 0。

哪个适合您的情况只有您可以决定，所以我认为您在这里所做的并不是一个糟糕的解决方案。

有关 NULL 棘手的更多信息，请阅读 Chris Date 和 Hugh Darwen 关于该主题的一些著作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-01T20:06:32.947

写一个扩展方法：

```
public static Decimal? CorrectSum<TSource>(this IEnumerable<TSource> source, Func<TSource, decimal?> selector)
{
    Decimal? sum = null;
    foreach (TSource s in source)
    {
        Decimal? val = selector(s);

        if (val.HasValue == true)
        {
            sum = (sum ?? 0) + val;
        }
    }

    return sum;
} 
```

# database - 本机主键还是自动生成的主键？

> ID：532363
> 
> 赞同：5
> 
> 时间：2009-02-10T13:40:36.187
> 
> 标签：database, database-design, primary-key

通常是使用本机主键（即现有列或列组合）还是将主键设置为自动生成的整数行更好？

**编辑：**
有人向我指出这与[这个问题](https://stackoverflow.com/questions/63090/surrogate-vs-natural-business-keys)非常相似。

这里的共识是使用代理键，这是我的自然倾向，但我的老板告诉我，我也应该尽可能使用自然键。他的建议可能最适合这个特定的应用程序，因为行中的名称唯一标识它，我们需要保持查看旧数据的能力，因此对名称/规则的任何更改都将意味着新的唯一行。

虽然这里的答案都很有帮助，但它们中的大多数都是基于主观的“这是你应该做的”，并且没有引用支持来源。我是否遗漏了一些必要的阅读材料，或者最佳实践数据库设计是否高度主观和/或依赖于应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T13:48:57.693

一个主键

1.  必须唯一标识一行。
2.  不能包含数据，否则当你的数据改变时它会改变（这是不好的）
3.  比较操作应该很快（WHERE 子句/连接）

理想情况下，您对行使用人工（代理）键，数字整数数据类型 (INT) 是最好的，因为空间效率高且速度快。

主键应由仍然满足条件 1.-3 的最少字段数组成。对于绝大多数表格，此最小值为：1 个字段。

对于关系表（或*非常*特殊的边缘情况），它可能会更高。使用复合主键引用表很麻烦，因此对于必须自己引用的表，不建议使用复合键。

在关系表（m:n 关系）中，您可以从相关表的主键中创建一个复合键，因此您的复合键会自动满足上述所有三个条件。

如果您*绝对确定*它是唯一的*并且*永远不会改变，您*可以从数据中创建主键。*由于这很难保证，我建议不要这样做。

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T14:00:08.807

这是一个很常见的话题。

*   [How do you like your primary keys?](https://stackoverflow.com/questions/404040/how-do-you-like-your-primary-keys)
*   [What’s the best practice for Primary Keys in tables?](https://stackoverflow.com/questions/337503/whats-the-best-practice-for-primary-keys-in-tables)
*   [Which format of primary key would you use in this situation.](https://stackoverflow.com/questions/506164/which-format-of-primary-key-would-you-use-in-this-situation)
*   [Surrogate Vs. Natural/Business Keys](https://stackoverflow.com/questions/63090/surrogate-vs-natural-business-keys)
*   [Should I have a dedicated primary key field?](https://stackoverflow.com/questions/166750/should-i-have-a-dedicated-primary-key-field)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T13:50:08.597

总是整数。

当需要交叉引用其他表中的这些元素（使用外键）时，您会很感激您这样做

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T13:42:37.133

不管它是什么，让它没有意义（代理键）。有意义的主键是致命的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T13:44:36.487

这是纯粹主义者和实用主义者之间的一场古老的战争。纯粹主义者不接受代理主键并坚持只使用自然主键。如果你问我，我会在大多数情况下投票支持增量（代理键）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T13:42:47.087

我会说自动生成，我没有真正的理由不这样做。除非您开发某种哈希表，但即便如此，我仍会坚持使用由数据库自动创建的唯一主键。它快速、简单、可靠。如果它已经存在，请不要重新发明轮子。

# lucene.net - 如何充分利用 Lucene.net

> ID：532365
> 
> 赞同：6
> 
> 时间：2009-02-10T13:40:50.617
> 
> 标签：lucene.net

我正在尝试将 Lucene.net 合并到我的网络搜索中。

目前我有一个 lucene.net 索引，其中包含 +100 万个文档，每个文档有 7 个字段。最后一个字段是“全部”字段，它连接了前面字段的内容。搜索所有字段非常快:)

但我觉得在这里可以找到更多。如何在不使用“all”字段的情况下进行搜索，在所有字段中搜索一个或多个空格分隔的字符串？
我希望能够给某些领域赋予权重。此外，如果搜索包含有关命中发生地点的信息，那就太好了，这样我就可以在结果中显示它。

我认为这一切都是可能的，但我不知道如何。
有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T13:51:37.750

我们做类似的事情，诀窍是在查询字符串中指定字段：

```
(+Tier1:ribbon^1)^4 OR (+Tier2:ribbon^1)^4 OR (+Tier3:ribbon^1) OR (+Tier4:q*ribbon*^1)^12 
```

在上面的示例中，用户在我们的应用程序中搜索了“ribbon”。我们在不同的字段中有不同的数据段，最终字段“Tier4”包含连接在一起的所有前面的术语。我们在字段前面加上“q”，所以我们可以做前导通配符，还有：

```
(+Tier4:q*ribbon*^1)^12 
```

最后，我们使用插入符号 (^) 的提升。这最终会以不同的方式衡量事物。需要一段时间才能获得正确的提升，我仍然对它们不是 100% 满意，但它们确实产生了很大的影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-01T23:54:36.460

我认为您不需要维护“全部”字段。

1.  看看使用“MultiFieldQueryParser”。它不接受查询解析器使用的单个默认字段，而是接受字段名称数组（除了索引分析器）。
2.  术语提升应该按照“QueryParser”工作（即不需要特殊操作）。我应该补充一点，我发现标准评分对我来说似乎没问题（字段长度、匹配数等），而无需使用增强术语。
3.  Lucene.Net（当然，目前肯定是 SVN 2.3 构建）包括来自 Java 源代码的 Highlight 包的一个端口。它确实有一些怪癖（其中最重要的一点是，一开始可能会很棘手），但它基本上是有效的。

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T13:50:36.007

你必须得到[Lucene in Action](http://www.manning.com/hatcher2/)。虽然关于原始（即 Java）Lucene 实现，但它包含您需要的所有信息：关于 boosts、highlighters、qwery 解析器等。

# javascript - 有没有更好的方法来编写这个 javascript 正则表达式/替换？

> ID：532366
> 
> 赞同：1
> 
> 时间：2009-02-10T13:41:10.677
> 
> 标签：javascript, jquery, regex, replace

以下代码有效，但我确信有一种更紧凑的方法可以实现相同的结果，尤其是字符串替换：

```
$('#nav-main .nav-sub').each(function() {

    var name = $(this).attr('id');

    $(this).children('li').children('a').each(function() {

        var text = $(this).text().toLowerCase();
        var spaces = / /g;
        var sub = /sub-/;
        var id = name + '-' + text.replace(spaces, '-');    
        var id = id.replace(sub, '');       
        $(this).attr('id', id);

    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T13:46:03.973

```
$('#nav-main .nav-sub').each(function() {
    var name = $(this).attr('id');
    $('li a', this).each(function() {       
        this.id = (name + '-' + $(this).text().toLowerCase().replace(/\s/g, '-')).replace(/sub-/, '');
    });
}); 
```

# asp.net - 列出可供下载的文件 - 文件存储在仅应用程序可访问的位置

> ID：532379
> 
> 赞同：2
> 
> 时间：2009-02-10T13:44:07.347
> 
> 标签：asp.net, .net-2.0

我有一组 pdf 文件存储在只能由应用程序访问的位置 - 所以这些文件不能直接通过 http 访问。

文件路径由数据库存储，当用户可以选择下载文件时，将执行以下代码：

```
 Response.ContentType = "Application/pdf"
 Response.AppendHeader("Content-Disposition", "attachment; filename=<some file name>")
 Response.TransmitFile(Server.MapPath("<the file path>"))
 Response.End() 
```

如果我正在处理单个文件，一切正常

**问题：**

我有一个存储过程，它返回所有可供用户下载的文件的列表，它可以返回从 1 到 20 的任意数量的文件。

我想创建一个页面，列出所有这些文件以及每个文件旁边的下载选项。

就像是

```
File name 1, some description 1, download (button, link?)
File name 2, some description 2, download (button, link?) 
```

它不能只是一个 url 链接，因为正如我提到的，这些文件不能直接访问，并且每次下载都需要执行一些代码

使用 .net2.0 完成此任务的优雅解决方案是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T13:46:20.290

对于常规的 ASP.NET (2.0)，您可能希望创建一个“处理程序”。最简单的选择是添加“通用处理程序”（ashx）模板 - 然后在页面上放置一个常规链接（例如）“download.ashx?id=2”。

在处理程序中，解析查询字符串，并将文件流式传输给用户：

```
 public void ProcessRequest(HttpContext context)
    {
        // set headers...
        string filePath = FindPath(context.Request.QueryString("id"));
        context.Response.WriteFile(filePath);
    } 
```

where`FindPath`从查询字符串链接中解析物理文件。

如果这是 ASP.NET MVC，您可以只使用`File(path)`操作结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T13:48:26.777

您返回给用户的文件列表中的 URL 可以指向可以下载它们的 ASPX 页面，就像您提供的示例代码中一样。

# php - 如何在 PHP 中实现屏幕刮板？

> ID：532399
> 
> 赞同：0
> 
> 时间：2009-02-10T13:49:57.380
> 
> 标签：php, javascript, screen-scraping

我有一个用户 ID 和密码，可以通过我的程序登录网站。登录后，URL 将从[http://localhost/Test/loginpage.html](http://localhost/Test/loginpage.html)更改为[http://www.4wtech.com/csp/web/Employee/Login.csp](http://www.4wtech.com/csp/web/Employee/Login.csp)。

如何使用 PHP 从第二个 URL 中“筛选”数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T13:59:23.613

你会使用卷曲。Curl 可以登录该页面，然后访问新引用的页面并下载整个页面。

查看[curl](http://www.php.net/curl)的 php 手册以及本教程：[如何使用 PHP 和 Curl 进行屏幕抓取](http://www.devtrench.com/screen-scrape-with-php-curl/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T14:01:12.877

我不太确定我是否理解你的问题。但如果你真的打算在 PHP 中进行屏幕抓取，我推荐使用[`simple_html_dom`](http://simplehtmldom.sourceforge.net/)解析器。这是一个小型库，可让您在 PHP 中使用 CSS 选择器。对我来说，屏幕抓取在 PHP 中从未如此简单。这是一个例子：

```
// Create DOM from URL or file
$html = file_get_html('http://stackoverflow.com/');

// Find all links
foreach($html->find('a') as $element) {
       echo $element->href . '<br>';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T14:17:06.130

为插件道歉，但我已经为屏幕抓取编写[了 JS_Extractor](http://jacksleight.com/code)。它实际上只是 DOM 扩展的一个非常简单的扩展，带有一些帮助方法使事情变得更容易一些，但它的效果非常好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T21:57:15.087

SimpleTest 单元测试框架有一个[Scriptable Browser 组件](http://www.lastcraft.com/browser_documentation.php)，可以单独使用。我通常将其用于屏幕抓取/机器人，因为它具有模拟浏览器的能力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-10T13:12:18.097

**重要的！**

*请注意，并不总是允许抓取。如果您决定抓取页面，请确保该页面的所有者允许您这样做，否则您最终可能会做一些非法的事情。*

* * *

假设您被允许抓取页面，请应用以下步骤。

# HTTP 请求

首先，您发出 HTTP 请求以获取页面内容。有几种方法可以做到这一点。

### 开放

发送 HTTP 请求的最基本方法是使用`fopen`. 一个主要优点是您可以设置一次读取多少个字符，这在读取非常大的文件时很有用。但是，正确地做这件事并不是最容易的事情，除非您正在阅读非常大的文件并且担心遇到内存问题，否则不建议这样做。

```
$fp = fopen("http://www.4wtech.com/csp/web/Employee/Login.csp", "rb");
if (FALSE === $fp) {
    exit("Failed to open stream to URL");
}

$result = '';

while (!feof($fp)) {
    $result .= fread($fp, 8192);
}
fclose($fp);
echo $result; 
```

### 文件获取内容

最简单的方法，就是使用`file_get_contents`. if 和 fopen 差不多，但你可以选择的选项更少。这里的一个主要优点是它只需要一行代码。

```
$result = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp');
echo $result; 
```

### 插座

如果您需要对发送到服务器的标头进行更多控制，您可以结合使用套接字和`fopen`.

```
$fp = fsockopen("www.4wtech.com/csp/web/Employee/Login.csp", 80, $errno, $errstr, 30);
if (!$fp) {
    $result = "$errstr ($errno)<br />\n";
} else {
    $result = '';
    $out = "GET / HTTP/1.1\r\n";
    $out .= "Host: www.4wtech.com/csp/web/Employee/Login.csp\r\n";
    $out .= "Connection: Close\r\n\r\n";
    fwrite($fp, $out);
    while (!feof($fp)) {
        $result .= fgets($fp, 128);
    }
    fclose($fp);
}
echo $result; 
```

### 流

或者，您也可以使用流。流类似于套接字，可以与`fopen`和结合使用`file_get_contents`。

```
$opts = array(
  'http'=>array(
    'method'=>"GET",
    'header'=>"Accept-language: en\r\n" .
              "Cookie: foo=bar\r\n"
  )
);

$context = stream_context_create($opts);

$result = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp', false, $context);
echo result; 
```

### 卷曲

如果您的服务器支持 cURL（通常支持），建议使用 cURL。使用 cURL 的一个关键优势是它依赖于其他编程语言中常用的流行 C 库。它还提供了一种创建请求标头和自动解析响应标头的便捷方式，并提供了一个简单的界面以防出错。

```
$defaults = array( 
    CURLOPT_URL, "http://www.4wtech.com/csp/web/Employee/Login.csp"
    CURLOPT_HEADER=> 0
);

$ch = curl_init(); 
curl_setopt_array($ch, ($options + $defaults)); 
if( ! $result = curl_exec($ch)) { 
    trigger_error(curl_error($ch)); 
} 
curl_close($ch); 
echo $result; 
```

### 图书馆

或者，您可以使用[**许多 PHP 库**](https://www.google.be/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=php%20http%20request%20libraries)之一。不过，我不建议使用库，因为它可能会矫枉过正。在大多数情况下，最好在底层使用 cURL 编写自己的 HTTP 类。

* * *

# HTML解析

PHP 有一种方便的方法可以将任何 HTML 加载到`DOMDocument`.

```
$pagecontent = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp');
$doc = new DOMDocument();
$doc->loadHTML($pagecontent);
echo $doc->saveHTML(); 
```

不幸的是，PHP 对 HTML5 的支持是有限的。如果您在尝试解析页面内容时遇到错误，请考虑使用第三方库。为此，我可以推荐[**Masterminds/html5-php**](https://github.com/Masterminds/html5-php)。使用此库解析 HTML 文件与使用`DOMDocument`.

```
use Masterminds\HTML5;

$pagecontent = file_get_contents('http://www.4wtech.com/csp/web/Employee/Login.csp');
$html5 = new HTML5();
$dom = $html5->loadHTML($html);
echo $html5->saveHTML($dom); 
```

或者，您可以使用例如。我的图书馆[**PHPPowertools/DOM-Query**](https://github.com/PHPPowertools/DOM-Query)。它在底层使用[**Masterminds/html5-php**](https://github.com/Masterminds/html5-php)解析 HTML 文件，将 HTML5 字符串解析为 DomDocument，并使用[**symfony/DomCrawler**](https://github.com/symfony/DomCrawler)将 CSS 选择器转换为 XPath 选择器。即使将一个对象传递给另一个对象，它也始终使用相同的 DomDocument，以确保良好的性能。

```
namespace PowerTools;

// Get file content
$pagecontent = file_get_contents( 'http://www.4wtech.com/csp/web/Employee/Login.csp' );

// Define your DOMCrawler based on file string
$H = new DOM_Query( $pagecontent );

// Define your DOMCrawler based on an existing DOM_Query instance
$H = new DOM_Query( $H->select('body') );

// Passing a string (CSS selector)
$s = $H->select( 'div.foo' );

// Passing an element object (DOM Element)
$s = $H->select( $documentBody );

// Passing a DOM Query object
$s = $H->select( $H->select('p + p') );

// Select the body tag
$body = $H->select('body');

// Combine different classes as one selector to get all site blocks
$siteblocks = $body->select('.site-header, .masthead, .site-body, .site-footer');

// Nest your methods just like you would with jQuery
$siteblocks->select('button')->add('span')->addClass('icon icon-printer');

// Use a lambda function to set the text of all site blocks
$siteblocks->text(function( $i, $val) {
    return $i . " - " . $val->attr('class');
});

// Append the following HTML to all site blocks
$siteblocks->append('<div class="site-center"></div>');

// Use a descendant selector to select the site's footer
$sitefooter = $body->select('.site-footer > .site-center');

// Set some attributes for the site's footer
$sitefooter->attr(array('id' => 'aweeesome', 'data-val' => 'see'));

// Use a lambda function to set the attributes of all site blocks
$siteblocks->attr('data-val', function( $i, $val) {
    return $i . " - " . $val->attr('class') . " - photo by Kelly Clark";
});

// Select the parent of the site's footer
$sitefooterparent = $sitefooter->parent();

// Remove the class of all i-tags within the site's footer's parent
$sitefooterparent->select('i')->removeAttr('class');

// Wrap the site's footer within two nex selectors
$sitefooter->wrap('<section><div class="footer-wrapper"></div></section>'); 
```

# xml - 在 Oracle 数据库中存储 XML 的最佳列是什么？

> ID：532401
> 
> 赞同：3
> 
> 时间：2009-02-10T13:50:36.007
> 
> 标签：xml, oracle, xmltype

我正在寻找在 Oracle 数据库中存储 XML 的最佳方式。目前我们使用 BLOB 类型列，但我正在推动将此列移动到 XMLType 或基于 XMLType 模式的列。我刚刚发现这篇文章[XML: To CLOB or Object?](http://www.oracle.com/technology/oramag/oracle/03-jul/o43xml.html#t1) 来自 Oracle 并阅读了它，但我还没有下定决心。

那么以前有人遇到过同样的问题吗？还有一个想法是 XML 将通过 Red5 服务器完全获取到 Flash 客户端，所以我在这里寻找的是最佳吞吐量。从我在数据中看到的它们提供的 CLOB 加载到数据库中的速度更快，但基于 XMLSchema 的检索速度更快。

谢谢，华金。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T13:57:03.073

在 Oracle 中使用对象意味着`SQL/PLSQL`可能会影响性能的多个上下文切换。

如果您在 Oracle 方面不做任何事情`XML`，则保留为`LOBs`.

那里列出的“优秀的 DML 性能”是夸大其词（当谈到放置/检索未处理的`XML`，即字节流时）

事实上，如果你的服务器每秒处理的查询数少于`10`每秒，你几乎不会注意到任何差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T15:45:21.550

如果您只想选择或更新 XML 的一部分，那么对象关系存储是您的最佳选择。唯一的缺点是，由于 xml 在内部被粉碎，空格和格式被删除，但正如文档所说，它仍然符合 DOM。

如果您打算仅将数据库用作存储并且所有 XML 操作都将在客户端发生，请使用 LOB 存储选项。

如果您使用的是 11g，它现在有一个 XMLIndex，它在更新/选择使用 LOB 选项存储的 XMLType 字段时极大地提高了性能。

# apache-flex - 如何在 Flex 3 中创建垂直按钮

> ID：532407
> 
> 赞同：2
> 
> 时间：2009-02-10T13:52:14.753
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3

我想创建一个基本上是 90 度旋转的按钮，因此它实际上是一个垂直对齐的按钮。使文本像书脊一样。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T13:55:24.217

您需要设置按钮的旋转属性...所以 mxml 将类似于：

```
<mx:Button id="myButton" label="CLICK ME"  rotation="90" /> 
```

编辑

作为旁注，如果您希望文本在组件旋转后可见，您可能需要嵌入您正在使用的字体

# php - 如何重构太长的 Codeigniter 控制器函数？

> ID：532413
> 
> 赞同：2
> 
> 时间：2009-02-10T13:53:37.137
> 
> 标签：php, codeigniter

我的控制器中有一个函数比我希望的要长，我想重构它以调用一些离散函数以使其更易于管理。如何在 Codeigniter 控制器中更好地组织长函数？

**我试过的：**

我知道您可以通过使用前导下划线 (_myfunc) 命名它们来在控制器中创建私有函数，但是函数中的变量超出了调用控制器函数的范围。所以你必须从函数中返回所有需要的数据，这很麻烦。

这是管理复杂控制器功能的最佳选择吗？有没有更简单的方法，变量可以像标准类成员变量一样对控制器类都是全局的？

建议？提前致谢！

编辑：有人请求了代码，所以我在下面添加了巨型控制器的代码。改进的一个机会是将 switch 语句中的逻辑移动到单独的函数（删除、预览、排序等）。但我正试图在那之后决定下一步。将大型验证设置代码移到它自己的函数中确实会减轻一些负担，但是我应该将它移到哪里呢？

```
 function categories() {
    $this->load->library('upload');
    $this->load->model('categories_m');
    $this->load->model('products_m');
    $this->load->model('pages_m');
    $this->load->model('backoffice/backofficecategories_m');
    $data['body'] = $this->load->view('backoffice/categories/navigation_v', '', TRUE);
    $data['cat_tree'] = $this->categories_m->getCategoryTree();
    $data['page_list'] = $this->pages_m->getPageList();
    $data['category_dropdown'] = $this->load->view('backoffice/categories/category_dropdown_v',$data,TRUE);

    switch ($this->uri->segment(3)) { //display views based on parameter in URL.
    case 'delete':          
        $categoryTreeID = $this->sitewide_m->checkURLParam($this->uri->segment(4),'CategoryTree'); //if parameter is in URL, show 404 if invalid parameter is passed. Otherwise, set variable known to be safe.
        if (isset($_POST['delete'])) {
            $this->backofficecategories_m->deleteCategory($categoryTreeID);
            $data['body'] .= '<span class="error">Category Deleted.</span>';
        } else {
            $data['cat_details'] = $this->categories_m->getCategoryDetails('',$categoryTreeID);
            $data['parent_category'] = $this->categories_m->getParentCategory($categoryTreeID);
            $data['products_to_reassign'] = $this->products_m->getProductsInCategory('',$categoryTreeID);   
            $data['body'] .= $this->load->view('backoffice/categories/delete_v',$data,TRUE);  //pull fresh category tree data since tree was just updated.
        }
        break;
    case 'preview':
        if ($this->uri->segment(4)) $data['categoryTreeID'] = $this->sitewide_m->checkURLParam($this->uri->segment(4),'CategoryTree'); //if parameter is in URL, show 404 if invalid parameter is passed. Otherwise, set variable known to be safe.
        $data['cat_details'] = $this->categories_m->getCategoryDetails(NULL,$data['categoryTreeID']); //get category ID being edited from the URL and store it. Returns false if category ID isn't found.
        foreach ($data['cat_details']->result() as $detail) {
            $data['categoryName'] = $detail->Name;
            $data['categoryID'] = $detail->ID;
        }
        $data['body'] .= $this->load->view('backoffice/categories/preview_v', $data, TRUE);
        break;

    ...cases continue...
    default:
        $this->load->library('table');
        $data['body'] .= $this->load->view('backoffice/categories/categories_v', $data, TRUE);
        break;
    }
    $this->load->view('backoffice/template_v',$data);       
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T14:22:51.000

你在使用模型吗？Code igniter 不会强制执行此操作，但除了控制器和视图之外，使用模型是获得更短控制器功能的好方法。或者，您可以将一些函数放在您自己的助手中，然后导入它。

而如果你想为整个构造函数设置一些默认值，你可以使用类构造函数。这在这里概述：

[http://codeigniter.com/user_guide/general/controllers.html#constructors](http://codeigniter.com/user_guide/general/controllers.html#constructors)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T08:11:35.267

查看您的代码，您正在使用一种方法执行多个操作。我会让每个动作都有自己的方法。公共资源可以是类成员并加载到构造函数中。

因此，您可以将您的 url 更改为“category_controller/add”，而不是像“your_controller/categories/add”这样的 url，并为每个操作设置一个方法。如果您不想更改网址，请使用路线：

```
$route['your_controller/categories/(.*)'] = 'your_controller/$1'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T15:01:33.980

服务层会有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T07:43:50.653

如果你想将你的逻辑保持在同一个控制器中，你可以通过在函数名前加下划线来模拟私有方法，例如：_myMethod()。就像[链接](http://codeigniter.com/user_guide/general/controllers.html#private)说的那样，函数名称前的下划线会阻止 CI 从 URL 调用它。例如，您可以在 Categories 控制器中创建 _delete()、_preview()、_order() 等方法。但是，如果您使用相同的逻辑来删除、预览、订购等其他内容，也许您应该将这些方法移动到模型或助手中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T13:57:24.903

就个人而言，我认为您使用单个控制器方法做的太多了。我要做的第一件事就是将您的 CRUD（创建读取更新删除）函数分离为单独的方法。例如，您的示例是使用“类别”，为什么不使用单独的“类别”控制器？

```
class Categories extends Controller
{
  function __construct()
  {
    parent::Controller();
  }

  function index() 
  {
    //display logic/code here
  }

  function edit()
  {
    //get the category to update from the post or url for editing
    //do the editing, etc
  }

  function delete()
  {
    //delete the category
  }

  function add()
  {
    //create the new category
  }
} 
```

您的 URL 将引用类别控制器：

[http://www.example.com/categories/edit](http://www.example.com/categories/edit) [http://www.example.com/categories/delete](http://www.example.com/categories/delete) 等。

我建议的第二件事是升级到 CodeIgniter 1.7.1 - 更新的 form_validation 库可以轻松地将所有验证规则移动到单独的配置文件中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-14T10:14:34.793

尝试在 codeigniter 中查看控制器的 _remap() 函数。

使用它，您可以将通用代码保留在 _remap 函数中，然后从 _remap 中调用任何其他函数以进行删除、更新等（基于 uri_segment(3)）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T14:12:28.480

您使用的是什么版本的 PHP？ [PHP 5](http://www.php.net/manual/en/language.oop5.php "PHP5 中的类和对象")支持真正的 OO，因此您可以声明私有函数，该函数将被解释器视为：

```
private function foo(){
...
} 
```

如果您希望扩展您的类（子类）的类能够访问该函数，请替换`private`为`protected.`

我从未使用过 CodeIgnniter，所以恐怕我无法帮助您解决特定的问题域。但是，重构一个增长为 long 的函数是一个非常常见的问题，有通用的解决方案。马丁·福勒 (Martin Fowler) 是个聪明人，他写了一些关于该主题的书，广受好评，因此您可以看看是否能找到[他的书](http://martinfowler.com/books.html#refactoring "马丁·福勒的书")。还有在线教程可以帮助您开始重构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-11T06:37:14.450

您可以将常用函数放入库中并调用它。

# asp.net - 在一个asp.net webforms UserControl中，为什么需要保护控件

> ID：532415
> 
> 赞同：1
> 
> 时间：2009-02-10T13:53:47.590
> 
> 标签：asp.net, user-controls, webforms

在 asp.net webforms 中的 UserControl 上，为什么用户控件中的控件（TextBox、DropDownList 等）必须在代码隐藏中声明为受保护。网络表单是否存在运行时继承？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T14:06:24.283

对于 Web 应用程序，它是编译时而不是运行时（然而，在网站中，编译纯粹是运行时）。

发生的情况如下。ASP.NET 将您的 ascx 文件和您的代码隐藏类合并到一个全新的类中，该类包含从您的 ascx 文件添加到`Render()`新创建控件的方法的所有标记。

# windows - 如何强制 Perl 脚本使用 ActiveState 的 wperl？

> ID：532417
> 
> 赞同：4
> 
> 时间：2009-02-10T13:54:24.217
> 
> 标签：windows, perl, activeperl

我有一个 Perl 脚本，它需要两个命令行参数，需要一段时间才能运行。我正在使用 ActiveState Perl 来运行它。我可以用

```
wperl script.pl arg1 arg2
```

从命令提示符开始，它在后台运行良好。如果我将 .pl 关联从 perl.exe 更改为 wperl.exe 并调用它

```
脚本.pl arg1 arg2
```

论点没有通过。有没有类似于`#!/usr/bin/perl`我可以用来强迫`wperl`习惯的东西？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T17:47:20.960

Perlmonks 节点[wperl.exe 与 perl.exe](http://www.perlmonks.org/?node_id=383211)建议将*.wpl*扩展名与 wperl 相关联。将要在 wperl 下运行的所有脚本命名为*.wpl*扩展名，其他*.pl*命名文件使用普通的*perl.exe*。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T14:12:49.603

您可以做的是在任何资源管理器窗口中的*工具 > 文件夹选项 > 文件类型中更改与**wperl.exe相关的文件关联，并通过**高级 > 打开 > 编辑命令行将**.pl*扩展名更新为

 ***```
{Path to wperl}\wperl.exe "%1" %* 
```

这可确保在您调用脚本时将所有命令行参数 (%*) 传递给*wperl.exe*

```
script.pl arg1 arg2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-05T16:09:54.543

```
unless ($^X =~ m/wperl\.exe$/i) {
    exec "wperl",$0,@ARGV;
    exit 0;
} 
```

# uml - UML 序列图调用属性

> ID：532423
> 
> 赞同：3
> 
> 时间：2009-02-10T13:56:25.447
> 
> 标签：uml, properties, diagram, sequence

在我的应用程序中，我有一个 Document 类和一个 DocumentFact 类。DocumentFact 类包含将从数据库中获取多个文档的方法。这些文档存储在数据表或数据集中。两者（数据表，数据集）都是 documentfact 类的私有成员。它们可以通过属性访问。

现在我的问题是：在序列图中，是否允许调用这样的属性：

```
Actor      Web interface    DocumentFact          Database
  |          |                 |                      |
  |input     |                 |                      |
  |------->  |  GetDocuments   |                      |
  |          |---------------->|                      |
  |          |                 | ExecuteSelectQuery() |
  |          |                 | -------------------->|
  |          |                 |                      |
  |          |                 |      Bool            |
  |          |                 | <--------------------|
  |          |                 |                      |
  |          |                 |   GetDataSet()       |
  |          |                 | -------------------->|
  |          |                 |                      |
  |          |                 |    DataSet           |
  |          |                 |<---------------------|
  |          |                 |                      | 
```

其中 GetDataSet 是一个属性。它是否正确？如果不是，那么正确的方法是什么？

**注意：**这只是我的序列图的一部分，其余的不相关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T14:12:08.527

要记住的重要一点是，UML 不是一种正式的表示法，因此您可以做任何您认为可以理解的事情。如果有不清楚的地方（或者你必须考虑太多关于如何表示它），你可能应该添加一个注释。

我发现在序列图中非常有用的一件事是对消息（或消息组）进行编号并有一个正在运行的对话框（格式化为编号列表）解释正在发生的事情（......以及你为什么这样做那样）。您必须记住，图表不是独立存在的，而是应该集成到更大的文档中，因此，如何具体表示属性并不是什么大问题。只需选择一个表示并解释 GetDataSet 是 Database 的一个属性（或其他：）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T14:04:34.943

在记录我的设计时，我遇到了类似的问题。我刚刚在方法调用下添加了文本“属性”（在箭头下）。（我没有找到“正确”的 UML 方法。）虽然这不是标准的 UML，但据我所知，这确实说明了重点。当然，这可能不适合您，在这种情况下，您最好使用标准 UML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T15:14:28.647

您可以显示具有原型的属性。例如，如果`DataSet`是属性，并且您正在调用 getter，则使用`<<get>>`构造型。所以它看起来像

```
 DataSet <<get>>
---------------------> 
```

我不确定它是否在 UML 规范中。但这是根据 Scott Ambler 在他出色[的 The Elements of UML 2.0 Style](https://rads.stackoverflow.com/amzn/click/com/0521616786)中的建议。

他还建议保留名称后的刻板印象。

# matlab - 如何将“帮助”文本添加到 mex 函数？

> ID：532430
> 
> 赞同：8
> 
> 时间：2009-02-10T13:57:28.593
> 
> 标签：matlab, documentation, mex

我正在写一个 Matlab mex 文件。但是，mex 文件似乎有一个严重的限制：`help mexfilename`不会导致出现帮助文本。

我可以通过编写一个 m 文件来规避这个问题，该文件最终调用 mex 文件，但包含帮助，但必须有更好的方法。

另一方面，这样我可以在 m 文件中进行所有错误检查，这样做更方便......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T15:28:52.087

我相信 PierreBdR 是对的；您将创建函数的 m 文件版本，仅使用标头调用和注释块，但没有正文。

将输入的错误检查放在 m 文件中可能不是一个坏主意，然后让 m 文件调用 mex 文件（但您可能必须给它们不同的名称）。在 MATLAB 中检查变量（例如，使用诸如[nargchk](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/nargchk.html)之类的内置函数）并将它们放入您可能总是希望 mex 函数的输入具有的标准格式可能更直接。我看过的许多图像处理工具箱函数似乎都是这样做的（格式化和检查 m 文件中的数据，然后在 mex 文件中进行昂贵的计算）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T14:50:47.687

您必须创建一个与您的 mex 文件 (name.c) 同名的 m 文件 (name.m)。然后，你放了函数声明和帮助文本，但没有函数体。例子：

```
function [o1,o2] = MyFct(i1,i2,i3)
% MyFct takes 3 arguments and returns 2 ... 
```

# java - 我在哪里可以找到 J2ME 的源代码？

> ID：532432
> 
> 赞同：3
> 
> 时间：2009-02-10T13:59:01.117
> 
> 标签：java, java-me

我目前在 J2ME 工作。我想将 J2ME 的源代码与我的 Eclipse 安装链接，这样我就可以浏览它的内容，它也将帮助我进行调试。

当 J2SE 的源代码以 jar 格式提供并且您只需将其链接到 Eclipse 时，我已经习惯了这一点。

能否请您提供下载jar的链接。它是免费的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T14:30:16.440

CLDC VM 有多种实现方式。所以你可能很难找到来源。此外，大多数 VM 不支持调试系统类。如果您想查看 CLDC 源代码，SUNs 的实现是在 dev.java.net [PhoneME Project](https://phoneme.dev.java.net/)上开源的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T16:30:55.887

我认为核心问题是 Java SE 和 JDK 现在是开源的，而 J2ME 不是。因此，此时即使获得 Sun 的 J2ME 实现也可能有点困难。

肯定是有原因的，但不确定他们为什么不开源 J2ME 实现。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-10T14:18:17.390

您是否考虑过使用[JADclipse](http://jadclipse.sourceforge.net/)之类的反编译器？

# vba - <> 是什么意思？

> ID：532435
> 
> 赞同：36
> 
> 时间：2009-02-10T13:59:44.300
> 
> 标签：vba, excel

我以前在 SQL 和 VB 中看到过这种情况，现在我正在对 Excel 电子表格进行逆向工程，并遇到了以下公式：

```
=IF(D23<>0,"不足",0)

```

我将其转换为 ActionScript：

```
 var result:String = [condition] ? 0 : "Insufficient"; 

```

但我不确定 D23 <> 0 是什么意思，它只是“不等于”吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-02-10T14:01:10.113

是的，它的意思是“不等于”，小于或大于。例如

```
If x <> y Then 
```

可以读作

如果*x 小于 y* **或**x*大于 y*则

逻辑结果是“如果 x 不**等于**y”

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-10T14:12:04.597

Yes in SQl <> 与 != 相同，这是不相等的.....当然除了 NULLS，在这种情况下，您需要使用 IS NULL 或 IS NOT NULL

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T14:01:09.193

不等于的意思。与在 C 风格语言以及 actionscript 中看到的 != 相同。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-10T14:00:44.390

是的，它是“不相等”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-10T14:33:06.857

“不相等”

# olap - MDX - 在最低时间求和，然后最大化

> ID：532441
> 
> 赞同：0
> 
> 时间：2009-02-10T14:00:59.023
> 
> 标签：olap, mdx, rolap

我有;

*   时间维度（*年、月、日、小时*），
*   产品维度（*产品、功能*）
*   和一个用户维度（*用户*）

我可用的衡量标准是：已*使用*（正在使用的功能数量）

我想要做的是显示**最大**并发使用量。（这将是同一*User*使用的每个*Feature*的**Sum** of *Used的***最大值**，发生在同一*Hour*中）。

 *****这在 MDX 中可行吗，还是我需要在我的数据库中处理这个问题？（感觉不对）

我让自己变得可以理解了吗？欢迎任何建议..

**编辑（中部时间 2 月 11 日 10:44）：**

视觉解释..（这就是我想要的）：

```
 [2008 Feb 11] [2008 Feb 11, 07:00] [2008 Feb 11, 07:30]  [2008 Feb 11, 08:00]
[Feature A] [Glenn] [Used]              5               2                    1                     2
[Feature A] [Glenn] [Max Used]          3               2                    1                     2 
```

**Max Used**就像您看到的**Max Used Hourly**一样。要做到这一点，我需要按小时计算 Sum..

我目前正在使用蒙德里安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T00:46:17.850

从您的新编辑来看，Hour 似乎不是您的时间维度的叶子，因此您的问题标题不太准确。由于您在查询中交叉连接功能和用户，因此可能会使用以下内容。

MAX（现有[时间].[小时].[小时].成员，[测量].[使用]）

不幸的是，我使用 Microsoft SSAS 而不是 Mondrian，所以我不知道它是否支持相同的语法。

# wix - 如何使用 WiX 部署 VSTO 3.0 插件？

> ID：532447
> 
> 赞同：20
> 
> 时间：2009-02-10T14:01:31.847
> 
> 标签：wix, vsto, ms-office, add-in, wix3

我想部署我用 Visual Studio 2008 编写的 VSTO 3 Application Level Word 2007 插件。我看到 WiX 有一个名为 WixOfficeExtension 的扩展，看起来它可能具有此功能，但我找不到任何文档，我无法从源代码中辨别出它的目的。

以前有没有人尝试过这个，你能成功地完成它吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-24T16:56:24.430

这是我最终使用的代码。我基本上将示例从[MSDN](http://msdn.microsoft.com/en-us/library/cc563937.aspx)移植到使用 WiX。

**注意：**此特定解决方案仅适用于 Word 2007 插件，但 Excel 的情况非常相似。只需根据上述[MSDN 文章](http://msdn.microsoft.com/en-us/library/cc563937.aspx)修改注册表/组件检查和键/值。

## 包含列表自定义操作

为了以完全信任的方式运行插件，必须将其添加到当前用户的包含列表中。可靠地做到这一点的唯一方法是使用自定义操作。这是[文章](http://msdn.microsoft.com/en-us/library/cc563937.aspx)中的自定义操作移植到WiX 中包含的新[部署工具基础。](http://blog.deploymentengineering.com/2008/05/deployment-tools-foundation-dtf-custom.html)

要使用它，请创建一个名为 VSTOCustomAction 的新 DTF 项目并添加 CustomAction.cs。

自定义动作.cs

```
using System;
using System.Security;
using System.Security.Permissions;
using Microsoft.Deployment.WindowsInstaller;
using Microsoft.VisualStudio.Tools.Office.Runtime.Security;

namespace VSTOCustomActions
{
    public class CustomActions
    {
        private static string GetPublicKey(Session session)
        {
            return session["VSTOCustomAction_PublicKey"];
        }
        private static string GetManifestLocation(Session session)
        {
            return session["VSTOCustomAction_ManifestLocation"];
        }
        private static void ErrorMessage(string message, Session session)
        {
            using (Record r = new Record(message))
            {
                session.Message(InstallMessage.Error, r);
            }
        }

        [CustomAction]
        public static ActionResult AddToInclusionList(Session session)
        {
            try
            {
                SecurityPermission permission =
                    new SecurityPermission(PermissionState.Unrestricted);
                permission.Demand();
            }
            catch (SecurityException)
            {
                ErrorMessage("You have insufficient privileges to " +
                    "register a trust relationship. Start Excel " +
                    "and confirm the trust dialog to run the addin.", session);
                return ActionResult.Failure;
            }

            Uri deploymentManifestLocation = null;
            if (Uri.TryCreate(GetManifestLocation(session),
                UriKind.RelativeOrAbsolute, out deploymentManifestLocation) == false)
            {
                ErrorMessage("The location of the deployment manifest is missing or invalid.", session);
                return ActionResult.Failure;
            }

            AddInSecurityEntry entry = new AddInSecurityEntry(deploymentManifestLocation, GetPublicKey(session));
            UserInclusionList.Add(entry);

            session.CustomActionData.Add("VSTOCustomAction_ManifestLocation", deploymentManifestLocation.ToString());

            return ActionResult.Success;

        }

        [CustomAction]
        public static ActionResult RemoveFromInclusionList(Session session)
        {
            string uriString = session.CustomActionData["VSTOCustomAction_ManifestLocation"];
            if (!string.IsNullOrEmpty(uriString))
            {
                Uri deploymentManifestLocation = new Uri(uriString);
                UserInclusionList.Remove(deploymentManifestLocation);
            }
            return ActionResult.Success;
        }

    }
} 
```

## 蜡片

我们显然需要实际的 WiX 文件来安装插件。从您的主 .wcs 文件中引用它

```
<FeatureRef Id="MyAddinComponent"/> 
```

插件.wcs

```
<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Fragment Id="Word2007Fragment">

      <!-- Include the VSTO Custom action  -->
      <Binary Id="VSTOCustomAction" SourceFile="path\to\VSTOCustomAction.dll"/>
      <CustomAction Id="AddToInclusionList" BinaryKey="VSTOCustomAction" DllEntry="AddToInclusionList" Execute="immediate"/>
      <CustomAction Id="RemoveFromInclusionList" BinaryKey="VSTOCustomAction" DllEntry="RemoveFromInclusionList" Execute="immediate"/>

      <!-- Set the parameters read by the Custom action -->
      <!-- 
        The public key that you used to sign your dll, looks something like <RSAKeyValue><Modulus>...</Modulus><Exponent>...</Exponent></RSAKeyValue>
        Take note: There should be no whitespace in the key!
      -->
      <Property Id="VSTOCustomAction_PublicKey"><![CDATA[Paste you public key here]]></Property>
      <CustomAction Id="PropertyAssign_ManifestLocation" Property="VSTOCustomAction_ManifestLocation" Value="[INSTALLDIR]MyAddin.MyAddin.vsto" />

      <!-- Properties to check prerequisites -->
      <Property Id="VSTORUNTIME">
        <RegistrySearch Id="RegistrySearchVsto"
                        Root="HKLM"
                        Key="SOFTWARE\Microsoft\vsto runtime Setup\v9.0.30729"
                        Name="SP"
                        Type="raw"/>
      </Property>
      <Property Id="HASWORDPIA">
        <ComponentSearch Id="ComponentSearchWordPIA"
                         Guid="{816D4DFD-FF7B-4C16-8943-EEB07DF989CB}"/>
      </Property>
      <Property Id="HASSHAREDPIA">
        <ComponentSearch Id="ComponentSearchSharedPIA"
                         Guid="{FAB10E66-B22C-4274-8647-7CA1BA5EF30F}"/>
      </Property>

      <!-- Feature and component to include the necessary files -->
      <Feature Id="MyAddinComponent" Title ="Word 2007 Addin" Level="1" AllowAdvertise="no">
        <ComponentRef Id="MyAddinComponent"/>
        <Condition Level="0"><![CDATA[NOT ((VSTORUNTIME="#1") AND HASSHAREDPIA AND HASWORDPIA)]]></Condition>
      </Feature>

      <DirectoryRef Id="INSTALLDIR">
          <Component Id="MyAddinComponent" Guid="your component guid here">
              <File Name="MyAddin.dll" Source="path\to\MyAddin.dll" />
              <File Name="MyAddin.dll.manifest" Source="path\to\MyAddin.dll.manifest" />
              <File Name="MyAddin.vsto" Source="path\to\MyAddin.vsto" />
              <RegistryKey Root="HKCU"
                  Key="Software\Microsoft\Office\Word\Addins\MyAddin"
                  Action="createAndRemoveOnUninstall">
                <RegistryValue Type="string" Name="FriendlyName" Value="MyAddin Word 2007 Addin" />
                <RegistryValue Type="string" Name="Description" Value="MyAddin Word 2007 Addin" />
                <RegistryValue Type="string" Name="Manifest" Value="[INSTALLDIR]MyAddin.vsto|vstolocal" KeyPath="yes"/>
                <RegistryValue Type="integer" Name="LoadBehavior" Value="3"/>
              </RegistryKey>
          </Component>
      </DirectoryRef>

      <!-- Modify the install sequence to call our custom action -->
      <InstallExecuteSequence>
        <Custom Action="AddToInclusionList" After="InstallFinalize"><![CDATA[(&MyAddinComponent = 3) AND NOT (!MyAddinComponent = 3)]]></Custom>
        <Custom Action="PropertyAssign_ManifestLocation" Before="AddToInclusionList"><![CDATA[(&MyAddinComponent = 3) AND NOT (!MyAddinComponent = 3)]]></Custom>
        <Custom Action="RemoveFromInclusionList" After="InstallFinalize"><![CDATA[(&MyAddinComponent = 2) AND NOT (!MyAddinComponent = 2)]]></Custom>
      </InstallExecuteSequence>
    </Fragment>
</Wix> 
```

希望这可以为外面的人节省一些时间。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T21:39:46.487

我很惊讶没有人回答这个问题......我一直在研究插件，所以我将在这里转储一些链接。我不确定你是否已经找到了你正在寻找的解决方案，但这可以帮助像我一样搜索的其他人：

答案是为办公室安装 vsto 3.0 插件确实适用于 wix，但我对这个 WixOfficeExtension 一无所知？对我来说，让它工作并不是一项简单的任务，你需要做很多事情才能正确完成它：

**第 1 步：我真的要使用 VSTO 吗？**

见这里： http: [//social.msdn.microsoft.com/Forums/en-US/vsto/thread/3f97705a-6052-4296-a10a-bfa3a39ab4e7/#)http://social.msdn.microsoft.com/Forums /en-US/vsto/thread/3f97705a-6052-4296-a10a-bfa3a39ab4e7/#](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/3f97705a-6052-4296-a10a-bfa3a39ab4e7/#)http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/3f97705a-6052-4296-a10a-bfa3a39ab4e7/#)

**步骤 2\. 好的 VSTO 在这里是正确的：**

*来自 MS Misha Shneerson——为 2007 年部署 VSTO：http:* [//blogs.msdn.com/mshneer/archive/2006/01/05/deployment-articles.aspx此处的](http://blogs.msdn.com/mshneer/archive/2006/01/05/deployment-articles.aspx) *Microsoft 部署信息：http:* [//msdn.microsoft.com /en-us/library/bb386179.aspx#](http://msdn.microsoft.com/en-us/library/bb386179.aspx#)

**第 3 步。我是否需要一次安装多个插件或想要使用 WIX，因为我想要它？**转到第 4 步。

如果不使用 Visual Studio 中的安装程序，让您的生活变得轻松......这是微软的安装程序，最简单的方法：http: [//msdn.microsoft.com/en-us/library/cc563937.aspx](http://msdn.microsoft.com/en-us/library/cc563937.aspx)

去这里找到一个很好的提示/想法总结。我也在这里浏览论坛寻求帮助，非常好的网站。（总结得很好，适合 Outlook 但适用于办公室）：[http ://www.outlookcode.com/article.aspx?ID=42](http://www.outlookcode.com/article.aspx?ID=42)

**步骤 4\. 打蜡**

A）熟悉这个你需要它：*应用程序级加载项的注册表项* [http://msdn.microsoft.com/en-us/library/bb386106.aspx#](http://msdn.microsoft.com/en-us/library/bb386106.aspx#)

B) 使用 Visual Studio 中基于 Windows 安装程序的设置对象生成 MSI 文件。

C）测试该 msi 并确保您的插件使用 microsoft MSI 工作。相信我，很多问题都会让你花最多的时间在这里。

D) 运行 dark.exe（在 wix bin 中）并查看为输出文件创建的注册表设置。

E）将这些注册表设置添加到您的 wix 文件中。
--我确实发现这个博客有点帮助，但它是针对 Excel 的 com 插件：http://matthewrowan.spaces.live.com/blog/cns!CCB05A30BCA0FF01! [143.entry](http://matthewrowan.spaces.live.com/blog/cns!CCB05A30BCA0FF01!143.entry)

F) 运行和部署。

注意：我会在这里添加更多，因为我在这里找到更多。我仍在学习 Wix 以及在插件等方面我可以用它做什么。Wix 很棒，Office 插件部署是一种皇家痛苦。

# java - Swing GTK L&F 标题栏上的额外按钮

> ID：532449
> 
> 赞同：1
> 
> 时间：2009-02-10T14:02:17.960
> 
> 标签：java, swing, gtk

任何人都知道在 Swing GTK L&F 的标题栏上的一般最大化、最小化、恢复和关闭按钮旁边添加一个额外的按钮吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T15:57:00.413

我认为您将需要大量查看源代码。可能会迫使你走克隆和自己的路线。

GTK 特别困难，因为模拟引擎从 XML 文件中读取外观描述。因此，根据其他人的位置，您将需要一些启发式方法来猜测按钮的放置位置。当然，您可以假设一个特别的外观并在固定位置按下按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:31:20.500

您还可以尝试使窗口“无边界”并制作自己的“标题栏”（将其添加到 JFrame 顶部）。当然，您必须自己构建所有按钮并模拟所有其他标题栏功能。

结果将是跨平台的，无论是否 GTK+，它都适用于所有 L&F。

# java - 如何创建依赖于另一个 JAR 的 JAR？

> ID：532459
> 
> 赞同：2
> 
> 时间：2009-02-10T14:04:48.717
> 
> 标签：java, jar, module

我正在尝试做一个模块化应用程序，但我遇到了问题，因为我有两个模块，其中一个依赖于另一个。

例如：模块 1 有一个从模块 2 导入类的类。

我在模块 1 的 Manifest.txt 中添加了以下行：

```
Class-Path: modulo_2.jar 
```

...但是我在创建 jar 时遇到错误，因为我无法解决从模块 2 导入模块 1 中需要的类。尽管有错误，但正在创建 jar。部署项目后，我仍然有同样的错误，说我的类无法解析导入，任何人都知道如何使这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T14:17:56.207

当您构建 jar（编译时）时，module_2.jar 应该在类路径中。您需要先构建 module_2.jar 并将其添加到类路径中。如果您使用命令行构建：

```
javac -cp module_2.jar my_java_files 
```

在运行时，module_2.jar 必须位于您在清单文件中指定的位置。如果您使用了 Class-Path: module_2.jar，则将 module_2 与 module_1 放在同一文件夹中并像这样运行它：

```
java -jar module_1.jar MyMainClass 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-10T19:59:18.570

或者，您可以尝试使用具有非常好的依赖管理功能的 Maven2 构建，而不是自己弄乱清单，并使用程序集插件构建一个可分发的 tar.gz，在其中发布您的应用程序及其依赖项。

# apache-flex - 增强的 Flex textarea/文本查看器组件？

> ID：532460
> 
> 赞同：1
> 
> 时间：2009-02-10T14:04:52.943
> 
> 标签：apache-flex, actionscript-3

是否有任何适用于 Flex 的高级 textarea() 组件 (AS3) 可以很好地用于查看/退出文本？

最好有一个文本选择功能，也是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T15:53:32.123

Grant Skinner 的[TextFlowPro](http://www.gskinner.com/blog/archives/2009/01/editable_multif.html)看起来很酷。不过，不确定这个问题到底是什么意思。

# c# - 我可以从调用代码中调用类的基本构造函数吗？

> ID：532464
> 
> 赞同：2
> 
> 时间：2009-02-10T14:06:51.740
> 
> 标签：c#, constructor

我有两个类，一个派生自另一个，并且都有参数化的构造函数。当我实例化派生类时，我想在这两个类中调用构造函数。

所以我的问题是：从调用代码向基类和派生类传递参数的语法是什么？

我试过这样的东西，但它没有编译：

```
DerivedClass derivedclass = new DerivedClass(arguments):base( arguments); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T14:11:18.187

不幸的是，您不能将值从调用代码传递给不同的构造函数。换句话说，这不起作用：

```
Foo foo = new Foo(arg1):base(arg2) 
```

但是，您可以做的是设置构造函数`Foo`来为您执行此操作。尝试这样的事情：

```
class FooBase
{
    public FooBase(Arg2 arg2)
    {
        // constructor stuff
    }
}

class Foo : FooBase
{
    public Foo(Arg1 arg1, Arg2 arg2)
        : base(arg2)
    {
        // constructor stuff
    }
} 
```

然后你会像这样调用构造函数：

```
Foo foo = new Foo(arg1, arg2) 
```

Foo 构造函数将为`arg2`您路由到基本构造函数。

# performance - 忽略 T-SQL 中的 NULL 参数

> ID：532468
> 
> 赞同：24
> 
> 时间：2009-02-10T14:08:27.740
> 
> 标签：performance, tsql, parameters

我希望能够传入参数列表，并忽略那些为 NULL 的参数。这样查询实际上就假装过滤器不存在并忽略它。

我是这样做的：

```
(@thing IS NULL or Thing=@thing) 
```

这是对的，如果是这样，它的表现会很差吗？它似乎比单独构建 SQL 要慢得多。

执行此操作的最佳方法是什么？

固定的！请参阅 Marc Gravell 的回答。总之，多次使用 IS NULL 会对性能造成*很大*影响。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-10T14:21:35.870

一旦您获得了其中的几个以上，那么是的：它开始变得非常缓慢。在这种情况下，我倾向于使用生成的 TSQL - 即

```
DECLARE @sql nvarchar(4000)
SET @sql = /* core query */

IF @name IS NOT NULL
    SET @sql = @sql + ' AND foo.Name = @name'

IF @dob IS NOT NULL
    SET @sql = @sql + ' AND foo.DOB = @dob'

// etc

EXEC sp_ExecuteSQL @sql, N'@name varchar(100), @dob datetime',
        @name, @dob 
```

ETC

请注意，sp_ExecuteSQL 缓存查询计划，因此任何具有相同参数的查询都可能重新使用该计划。

缺点是除非您签署 SPROC，否则调用者需要对表具有 SELECT 权限（而不仅仅是 SPROC 上的 EXEC 权限）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-10T14:12:23.067

我会这样处理。

```
WHERE Thing = ISNULL(@Thing, Thing) 
```

如果您只是将参数用作 where 子句的过滤器，这将非常有效。如果该参数为空，它将忽略该参数。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T14:57:27.420

我一般用

```
WHERE (id = @id OR @id IS NULL)
AND (num = @num OR @num IS NULL) 
```

等等

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T14:53:59.520

我过去在这个场景中使用的一种技术是使用 COALESCE 函数作为我的 WHERE 子句的一部分。Books Online 将提供有关该功能的更深入信息，但这里有一个片段，说明如何在您描述的场景中使用它：

```
create procedure usp_TEST_COALESCE
(
    @parm1 varchar(32) = null,
    @parm2 varchar(32) = null,
    @parm3 int = null
)
AS

SELECT * 
FROM [TableName]
WHERE Field1 = COALESCE(@parm1, Field1)
AND Field2 = COALESCE(@parm2, Field2)
AND Field3 = COALESCE(@parm3, Field3) 
```

COALESCE 函数将从其参数返回第一个非空表达式。在上面的示例中，如果任何参数为空，COALESCE 函数将使用基础字段中的值。

使用此技术的一个重要警告是表中的基础字段（构成您的 where 子句）需要不可为空。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T14:11:45.377

我不确定这是否是“最佳”方式，但这正是我在存储过程中出于相同目的所做的。我的直觉是，从执行计划的角度来看，这比动态创建的查询要快。另一种选择是为您传入的这些“标志”的每个组合创建一个查询，但这确实不是可扩展的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-30T14:56:01.293

查看标题为“案例研究：搜索订单”的部分中的以下[链接。](http://www.sommarskog.se/dyn-search-2008.html)这将深入探讨所有选项，并应为您提供与每个选项相关的成本的出色概述。警告，使用 COALESCE 时要非常小心，它可能不会返回您认为的内容。

问候，

蒂姆

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T14:13:05.047

这是我通常使用的方法。我认为它没有效率低下的原因，因为如果@thing 为空，该语句应该短路为真，因此不需要表扫描。您是否有任何证据表明这种比较会减慢您的查询速度？如果没有，我不会担心。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T14:13:27.807

当您声明参数时，如果您为它们设置了一个值，例如 null 在您的情况下，您不需要将值传递给它们，除非您当然需要。我使用此功能来标记是否需要运行另一个查询是参数不为空的特殊情况

我通常只是这样检查

如果字段为空

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-10T21:19:48.303

谢谢，这很有帮助。由于提到的潜在性能优势，我决定使用 sp_ExecuteSQL 方法。我对此略有不同的看法，您可能会觉得有帮助。

```
DECLARE @sql nvarchar(4000) 
DECLARE @where nvarchar(1000) =''

SET @sql = 'SELECT * FROM MyTable'

IF @Param1 IS NOT NULL 
    SET @where = @where + ' AND Field1 = @Param1'

IF @Param2 IS NOT NULL 
    SET @where = @where + ' AND Field2 = @Param2' 

IF @Param3 IS NOT NULL 
    SET @where = @where + ' AND Field3 = @Param3' 

-- Add WHERE if where clause exists, 1=1 is included because @where begins with AND
IF @where <> ''
    SET @sql = @sql + ' WHERE 1=1' + @where

--Note that we could also create order parameters and append here
SET @sql = @sql + ' ORDER BY Field1' 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-16T06:36:05.353

如果 Thing（列值）也是 Nullable，则使用 foll。方法：

```
WHERE COALESCE(Thing,'')=COALESCE(@thing,Thing,'') 
```

# asp.net - VB/ASP.NET 跨 WebPart 触发事件

> ID：532472
> 
> 赞同：2
> 
> 时间：2009-02-10T14:10:40.577
> 
> 标签：asp.net, vb.net, web-parts

首先，我的环境：VB.NET .NET 2.0 AJAX 更新面板也用于 webpart 区域。我有一个母版页和默认页。默认页面有 WPM 和两个区域。每个 webpart 只是一个外壳，一个用户控件用于 A & B

我有两个 webpart，A 和 B。（用户控件）- A 有许多按钮。B 有一个列表框和 Subs，它们填充列表框并刷新也位于（在 Web 部分 B 内）包装列表框的 UpdatePanel。我想单击 webpart A 中的一个按钮，它会在 webpart B 中触发一个名为“Public Sub FillList()”的子，我似乎无法锻炼如何做到这一点。我查看了 webpart 连接，我知道我可以传递属性，这很好，但我想调用 subs/fire 事件。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T14:49:21.917

这听起来像是“[事件冒泡](http://msdn.microsoft.com/en-us/library/aa719644(VS.71).aspx)”的案例。

事件冒泡允许某个容器的组成控件使其事件“冒泡”或提升以由父（容器）控件处理。

Webpart A 中的按钮控件可以在其单击事件中包含以下代码：

```
RaiseBubbleEvent(Me, args) 
```

其中 args 是派生自 System.EventArgs 的一些自定义类型。然后，这将在父容器（在您的情况下为 UserControl 本身）上引发（或“冒泡”）事件（使用您的自定义参数）。这是在父容器上的以下事件中处理的：

```
Protected Overrides Function OnBubbleEvent(ByVal source As Object, ByVal args As System.EventArgs) As Boolean 
```

这可以在您的网页内的包含层次结构中重复（页面是最终容器）。一旦此事件到达作为两个用户控件（A 和 B）的父容器的容器，您就可以从父容器的代码中调用 UserControl B 上的公共方法，如果您愿意，可以传入自定义事件参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T13:47:57.477

我知道它有点脏，但我找到了一个可行的解决方案：

```
MyControlThatNeedsUpdated grid = (MyControlThatNeedsUpdated)FindControlRecursive(Page, "MyControlThatNeedsUpdated");
grid.updateList();

private Control FindControlRecursive(Control root, string ControlType)
{
    if (root.GetType().Name == ControlType)
    {
        return root;
    }

    foreach (Control c in root.Controls)
    {
        Control t = FindControlRecursive(c, ControlType);
        if (t != null)
        {
            return t;
        }
    }

    return null;
} 
```

我调用的方法是'updateList()'

# javascript - var flashElements = document.getElementsByTagName("EMBED"); 的最佳替代品

> ID：532474
> 
> 赞同：1
> 
> 时间：2009-02-10T14:11:32.447
> 
> 标签：javascript, internet-explorer, object, embedding

我想在随机页面上找到所有 Flash 对象（使它们 wmode=transparent，这样它们就不会隐藏菜单）。

IE 不支持嵌入在：document.getElementsByTagName("EMBED");

知道找到所有嵌入最有效的方法是什么（没有 jQuery ......）

还有更高级的：我遇到了嵌入标签写为 eMBED 的网站。我也需要找到这些标签。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T14:36:58.703

我认为问题不在于 IE 不支持对 <embed> 标签的搜索，而是在 IE 中使用 <object> 标签来包含 flash 元素。事实上，Firefox 也支持后一种格式，如果你使用以下格式：

```
<object type="application/x-shockwave-flash" data="MyFlashProgram.swf"> 
```

事实上，这是首选语法，[swfobject 也](http://code.google.com/p/swfobject/)使用它。因此，对于跨浏览器解决方案，您需要寻找：

*   <embed> 和 <object> 元素的`type`属性设置为“application/x-shockwave-flash”
*   <object> 元素的`classid`属性设置为“clsid:D27CDB6E-AE6D-11cf-96B8-444553540000”

我不确定 Opera 或 Safari 等其他浏览器，您可能需要使用更多变体扩展此列表。

使用 jQuery 或原型之类的 javascript 库查找这些元素应该是微不足道的，但您可以在没有这些的情况下进行管理。

# php - php函数在保存图像时捕获错误的问题

> ID：532480
> 
> 赞同：0
> 
> 时间：2009-02-10T14:12:12.380
> 
> 标签：php

我有一种保存图像的方法，该方法旨在优雅地处理错误，在发生故障时将 $imageSrc 设置为特定图像。如果图像存在，我的方法可以正常工作，但似乎没有正确处理错误情况。

```
$imageSrc = save_pic($PIC_URL, $pk);

function save_pic($pic_url, $pk) {
    $imageDir = './';
    if (!strlen($pic_url))
            return "removed.jpg";
    if (!is_dir($imageDir) || !is_writable($imageDir)) {
        return "removed.jpg";
    }
    $image = file_get_contents($pic_url);
    if (empty($image)) {
        return "removed.jpg";
    }
    $r = file_put_contents($imageDir.$pk.".jpg", $image);
    if ($r) {
            return "./$pk.jpg"; 
    } else {
            return "removed.jpg";
    }
} 
```

如果图像不存在，我得到：

```
Warning: getimagesize(http://127.0.0.1/555.jpg) [function.getimagesize]: failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found
in C:\Program Files\EasyPHP 2.0b1\www\get_auction.php on line 144

Array (
 [type] => 2 [message] => getimagesize(http://127.0.0.1/555.jpg)
 function.getimagesize]: failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found
 [file] => C:\Program Files\EasyPHP 2.0b1\www\get_auction.php
 [line] => 144
) 1 
```

在任何情况下都不会返回returned.jpg。

编辑：添加 imageResize 代码：

```
function imageResize($imageURL, $maxWidth, $maxHeight)

{

global $outputWidth, $outputHeight, $maxWidth, $maxHeight;

$size = getimagesize($imageURL);

if ($size) {

    $imageWidth  = $size[0];

    $imageHeight = $size[1];

    $wRatio = $imageWidth / $maxWidth;

    $hRatio = $imageHeight / $maxHeight;

    $maxRatio = max($wRatio, $hRatio);

    if ($maxRatio > 1) {

        $outputWidth = $imageWidth / $maxRatio;

        $outputHeight = $imageHeight / $maxRatio;

    } else {

        $outputWidth = $imageWidth;

        $outputHeight = $imageHeight;

    }

} else {

    die(print_r(error_get_last()));

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T14:21:03.483

您确定要写入根文件夹吗？因为我看不出您的代码有任何问题。`file_get_contents`并且`file_put_contents`似乎没有失败，所以你的形象被写在某个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T14:31:06.703

```
 $image = file_get_contents("http://example.com/test.png");
 list($ver, $retcode, $message) = explode(' ', $http_response_header[0], 3);
 if ($retcode != 200) {
   return "removed.jpg";
 } 
```

`$retcode`将包含`HTTP`响应代码。

请`$retcode`在此处发布此内容以及您的`strlen($image)`回报，这可能有助于解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T13:33:07.923

试试这个：

```
<?php
$imageSrc = save_pic($PIC_URL, $pk);

function save_pic($pic_url, $pk) 
{
    $imageDir = './';

    if (!strlen($pic_url))
    {
        return 'removed.jpg';
    }

    if(!is_dir($imageDir) || !is_writable($imageDir)) 
    {
        return 'removed.jpg';
    }

    if(!file_exists($pic_url))
    {
        return 'removed.jpg';
    }

    if (file_put_contents($imageDir . $pk . '.jpg', file_get_contents($pic_url))) 
    {
            return $imageDir . $pk . '.jpg'; 
    } 
    else 
    {
            return 'removed.jpg';
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T13:35:03.333

调试？

获取一个包含调试器（如 Eclipse 或 Netbeans）的 IDE，用于函数的 rtm 以查看响应方式，或者进行旧的内联调试以在运行时回显代码的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T20:03:00.397

在我看来，您没有发布完整的代码？

警告消息说，但在您的示例中`getimagesize()`没有使用任何地方。`getimagsize()`为了获得更好的帮助，我将包括整个方法或您当前工作的更新错误消息。还请包括您正在使用的 PHP 版本。

`file_get_contents()`如果出现错误，将返回 false 并在 404 HTTP 错误时返回，如下所示：

```
mfischer@testing01:~$ php -r 'var_dump(file_get_contents("http://stackoverflow.com/i_do_not_exist.jpg"));'

Warning: file_get_contents(http://stackoverflow.com/i_do_not_exist.jpg): failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found
 in Command line code on line 1

Call Stack:
    0.0002      51884   1\. {main}() Command line code:0
    0.0002      51952   2\. file_get_contents() Command line code:1

bool(false)
mfischer@testing01:~$ php -v
PHP 5.2.6-5 with Suhosin-Patch 0.9.6.2 (cli) (built: Oct  5 2008 13:07:13) 
```

在这里试用您的代码对我来说非常好：

```
$ cat test.php
<?php
$PIC_URL="http://stackoverflow.com/i_dont_exist.jpg";
$pk = "test";
$imageSrc = save_pic($PIC_URL, $pk);
var_dump($imageSrc);

function save_pic($pic_url, $pk) {
    $imageDir = './';
    if (!strlen($pic_url))
            return "removed.jpg";
    if (!is_dir($imageDir) || !is_writable($imageDir)) {
        return "removed.jpg";
    }
    $image = file_get_contents($pic_url);
    if (empty($image)) {
        return "removed.jpg";
    }
    $r = file_put_contents($imageDir.$pk.".jpg", $image);
    if ($r) {
            return "./$pk.jpg";
    } else {
            return "removed.jpg";
    }
}
$ php test.php

Warning: file_get_contents(http://stackoverflow.com/i_dont_exist.jpg): failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found
 in /home/mfischer/tmp/532480/test.php on line 14

Call Stack:
    0.0005      59824   1\. {main}() /home/mfischer/tmp/532480/test.php:0
    0.0005      60176   2\. save_pic() /home/mfischer/tmp/532480/test.php:4
    0.0006      60444   3\. file_get_contents() /home/mfischer/tmp/532480/test.php:14

string(11) "removed.jpg" 
```

PHP 函数有在代码中直接溢出警告消息的坏习惯，如果您不喜欢这样，您可以使用前面建议的“@”操作使它们静音，或者您也可以使用 PEAR_HTTP 提供的 HTTP 客户端库或 Zend_HTTP_Client 以更好地控制错误处理。使用套接字、fsockopen 等滚动您自己的东西也是可能的。

但回到正题：如果它仍然不起作用，我认为缺少一些信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T20:37:43.853

您不应该测试 file_get_contents 错误吗？我的意思是像

```
if( false == ($image = file_get_contents($pic_url))){
        return "removed.jpg";
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T19:11:50.197

*   将 HTTP HEAD 发送到给定的 URL
*   检查 returncode == 200 （文件在那里），否则它被删除
*   检查 Content-Type 标头是否为 image/*（例如 image/png），否则将其删除
*   如果服务器发送 Content-Length 标头，则将其读取到变量
*   文件获取内容（网址）
*   如果服务器发送了 Content-Length，请查看大小是否匹配，否则将其删除
*   保存图片
*   尝试 getimagesize()，如果出错则通过 unlink() 将其删除，否则将其删除
*   成功！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T19:32:39.557

您遇到路径问题。您应该将图片的完整路径存储在定义中。

确保此文件来自 save_pic 函数。

```
DEFINE("RemovedPicUrl", "http://" . $_SERVER['SERVER_NAME'] . "/path/to/removed/image/removed.jpg") 
```

然后改变所有出现的

```
"Removed.jpg" 
```

到

```
RemovedPicUrl 
```

我赌一美元可以解决你的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-28T17:00:50.583

该问题不是代码问题，而是由文件损坏引起的。这是在其他机器上测试时确定的。

# c# - NHibernate 和收集计数

> ID：532483
> 
> 赞同：4
> 
> 时间：2009-02-10T14:12:19.353
> 
> 标签：c#, nhibernate

我有以下使用 NHibernate 进行持久性的类设置

```
public class Person
{
    public string Name { get; set; }
    public IList<Person> Subordinates { get; set; }
} 
```

现在说我有一个包含两列“名称”和“下属数量”的网格，这是在 NHibernate 中执行此操作的最佳方式，同时尽可能保留域对象的使用。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T16:01:34.130

例如，您可以创建一个用于报告/概述的 DTO 类...此类可能如下所示：

```
public class PersonView
{
     public string Name{ get;set; }
     public int NumberOfSubordinates{get;set;}     
} 
```

然后，您创建一个 Criteria 查询，在该 Criteria 中您定义要检索所有 Persons。但是，您可以指定 NHibernate 不应该返回 Person 对象，而是返回 PersonView 对象。为了能够做到这一点，您需要使用投影和 AliasToBeanTransformer：

```
ICriteria crit = new Criteria(typeof(Person));

crit.SetProjection (Projections.ProjectionList()
                       .Add (Projections.Property("Name"), "Name")
                       .Add (Projections.Count ("Subordinates"), "NumberOfSubordinates");

crit.SetResultTransformer(Transformers.AliasToBean (typeof(PersonView)); 
```

类似上面的东西。（我没有测试你的具体情况）。然后，您只需要让 NHibernate 知道 PersonView 类的存在，只需“导入”这个类即可。我有一个 hbm.xml 文件，我在其中导入了所有 DTO 类。这看起来像

```
<hibernate-mapping .. >
  <import class="PersonView" />
</hibernate-mapping> 
```

然后，NHibernate 将为您的 Criteria 生成一个查询，看起来很像：

```
SELECT p.Name, COUNT(p.Subordinates) FROM Person
INNER JOIN Subordinates ON Person.PersonId = Subordinates.PersonID
GROUP BY p.Name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T15:46:56.787

假设你有 HBM 正确的 Person HasMany Subordinates 你可以得到 person 然后调用 Subordinates.Count

如果您只需要计数，这是一个适度浪费的过程，因为它将完全填充所有下属集合以获取计数。我认为你最好创建一个方法来接收一个 Person 并返回他们的下属的计数，然后你使用 HQL 来执行一个实际的计数函数。如果您不能执行直接计数功能，您可以让它为每个下属只返回一个与 Person FK 匹配的值，然后在它返回的集合上调用 .Length 或 .Count 。不过，我认为 HQL 应该能够直接为您计算它。

# methods - 您如何构建一个不会弄乱博客作者的阅读器统计数据的基于 Web 的 RSS 阅读器？

> ID：532506
> 
> 赞同：3
> 
> 时间：2009-02-10T14:20:32.300
> 
> 标签：methods, rss

我的公司正在着手构建一个基于 Web 的 RSS 阅读器，用户可以注册并跟踪订阅源；很像谷歌阅读器。

我的第一个想法是，一旦我有了某个博客或网站的提要 URL，我只需要轮询一次就可以获取内容，然后将条目插入数据库中，供任何订阅它的人使用。

然而; 如果有人使用 FeedBurner 之类的服务来跟踪读者统计数据，则 100 名读者可能会订阅特定的博客或网站，而对于实际作者来说，它只会显示为 1 名读者。

为每个订阅者轮询一次将是一个巨大的不必要的开销，特别是如果有一千个用户订阅了同一个订阅源。您有什么建议，或者是唯一的解决方案是快速连续数百次重复轮询相同的提要？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T14:29:36.693

据我所知，谷歌阅读器以这种方式解决了这个问题：他们客户端的用户代理字符串包括通过他们的阅读器阅读这个提要的订阅者的数量。

我不知道 FeedBurner 或其他工具是否会解释这一点，但至少理论上可以通过这种方式从 http 日志文件中获取准确的统计信息。

**编辑：**

根据[Google Reader 官方文档](http://www.google.com/help/reader/publishers.html)，他们的提要获取器的 User-Agent 标头如下所示：

```
User-Agent: Feedfetcher-Google; (+http://www.google.com/feedfetcher.html; 4 subscribers; feed-id=1794595805790851116) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-23T12:34:03.123

实际上，FeedBurner 试图做出一个聪明的猜测。这是一篇很好[的文章](http://blog.moertel.com/articles/2007/08/22/fun-with-statistics-estiating-blog-readership)，介绍了良好的读者群估算可能涉及的程度。

# jquery - 带有 jquery 1.3+ 的 Firefox 扩展

> ID：532507
> 
> 赞同：6
> 
> 时间：2009-02-10T14:20:56.853
> 
> 标签：jquery, firefox-addon

我在我的 Firefox 扩展中使用 jquery-1.2.6 并且效果很好。几天前，我想更新到当前版本的 jquery (1.31)，但这似乎不再起作用。这是我在扩展中包含 jquery 的技术：

```
$mb = jQuery.noConflict();
var doc = window.content.document
$mb("body", doc).slideToggle("slow"); 
```

我知道[此](https://stackoverflow.com/questions/491490/how-to-use-jquery-in-firefox-extension)页面上描述的技术，但这也不起作用。那么这里有没有人在 Firefox 扩展中使用比 jquery-1.2.6 更新的版本并且可以告诉我如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T21:33:47.713

我找到了解决我的问题的方法！

我将在这里介绍它，以便其他人可以将其用作参考。经过大量搜索和撕裂我的头发后，我在 jquery 错误跟踪器上找到[了这个](http://dev.jquery.com/ticket/3870)错误报告。您可以在那里下载[jquery 1.3.1 Revision: 6161](http://code.jquery.com/nightlies/jquery-2009-01-23.js)来修复问题（官方 1.3.1 版本是 Revision: 6158）。

发现的另一个很棒的技巧是在 Firefox 扩展中“即时”包含库之类的 jquery。只需在扩展程序中的一些 javascript 文件中包含以下内容：

```
var jsLoader = Components.classes["@mozilla.org/moz/jssubscript-loader;1"].getService(Components.interfaces.mozIJSSubScriptLoader);
jsLoader.loadSubScript("chrome://{appname}/content/jquery-1.3.1_6161.js");
jQuery.noConflict();

//use jquery
var doc = window.content.document;
alert(jQuery("body", doc).html()); 
```

更新：今天发布了 1.3.2 版本，问题似乎解决了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:49:07.537

没看到分号后`window.content.document`，觉得有必要。

# software-quality - 您如何为真正的生产类代码“高音”辩护？

> ID：532511
> 
> 赞同：3
> 
> 时间：2009-02-10T14:22:14.883
> 
> 标签：software-quality

这个问题已经在一个[类似的帖子](https://stackoverflow.com/questions/362096/arguing-about-usability-and-prettyness)中解决了关于 UI 的更具体的级别。

我想在更一般的设计层面上解决这个问题。

我每天都在设计设计以确保高质量。但是我时不时地与中层管理人员和没有经验的开发人员讨论“以正确的方式”做事的好处。

有时我只是说“相信我，我已经看到了这会导致什么，我们正在以另一种方式做”，有时我会尝试制定一个场景，其中一组特定的选择会引入问题等。大多数时候我觉得我没有接触到我正在与之交谈的人。我还不如说“相信我”。

我觉得我作为一名高级软件人员的能力之一应该是解释和激励我们作为一家公司做出的技术选择。我可以在经济和用户体验层面做到这一点。

但我似乎无法在技术和伪技术层面解释为什么某些设计选择“感觉错误”以及为什么其他设计选择感觉更正确和有益，即使起初它可能更难实现或看起来不必要的复杂。

幸运的是，我偶尔会展示出好的结果，否则我可能会开始怀疑好与坏设计的整个概念。

我真的会觉得阅读这里的其他人对此的看法很有趣。

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T14:42:09.563

您是否尝试过[技术债务](http://martinfowler.com/bliki/TechnicalDebt.html)论点？引用链接（来自 Martin Fowler 网站）：

> ......以快速而肮脏的方式做事给我们带来了技术债务，这类似于金融债务。就像金融债务一样，技术债务会产生利息支付，这是由于快速而肮脏的设计选择，我们必须在未来的开发中付出额外努力的形式......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T14:42:12.637

这是我愤世嫉俗的回答：

有两种人——关心以正确方式做事的人和不关心做事的人。你不需要说服那些同意你的人，所以你需要担心的人是那些不关心事情如何完成的人。您很可能会发现那些不关心“以正确方式”做事的人非常关心其他事情，例如前期时间惩罚、与不同实施的混淆等。您能做的最好的事情就是确定其他人真正关心和解决的问题是什么。

例如，如果人们担心你会以正确的方式做事预先引入过多的开发时间，那么向他们展示如何以正确的方式做事从长远来看可以节省他们的时间。

不过要提醒一句 - 总是问自己一个非常重要的问题，所有纯粹主义者（包括我自己）在遇到反对“正确方式”时必须始终问：

> **我这样做是为了自己的“正确方式”吗？**

如果答案是“是”，那么您可能需要退缩。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T14:39:31.660

两点：

1.  如果你没有向别人表达你的理由，很可能是*你自己*理解的不够。因此，试图让它与他人交流的尝试可能会经常揭示你自己可能是错误的假设。因此，无论多么困难（我知道这有多困难），我都建议您积极努力为他人具体化您的想法。把事情写下来，做图表——随便什么。即使您仍然无法成功沟通，您也确实可能成功地看到您的判断错误。
2.  与您交谈的人可能不太熟悉软件工程。在这种情况下，您可能不想推动高级想法，而只是一次让他们了解首要原则。创建各种类型的演示文稿（再次使用图表和所有内容）解释您的思考所依赖的关键想法并举行会议。您可能需要为这个初始会话努力工作。但是，如果他们得到了它，那么在您的余生中，您可能会过得更轻松。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T14:56:33.383

也许您不应该与中层管理人员争论**技术**决策：那将是在错误的抽象级别进行讨论。例如，不要回答“重构需要 X 天，然后是 Y 天来实现新功能”，而是说“需要 (X+Y) 天”。

至于和初级开发人员争论，你似乎在问花言巧语或“如何争论”；这是一个很大的话题，例如，许多技术之一是“诉诸权威”，例如说“我在`<`*这本受人尊敬的作者的好书*`>`中读到了这种技术”......或者，即使你无法证明某事，也可以争论降低风险的基础...

**最**重要的是，**倾听**：找出他们为什么要争论其他事情，并解决**他们的**论点。例如，也许他们想以“错误”的方式做这件事，因为他们想要快速完成，因为他们承受着来自其他人的一些时间压力：如果是这样，请解决**这个**问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T15:23:55.110

我试着从成本的角度来考虑它。在某种程度上，它又回到了[“快、好、便宜：随便选两个”](https://stackoverflow.com/questions/284753/nuggets-of-wisdom/285158#285158)。如果你一直选择又快又便宜，那你就吃亏了。

我更喜欢为任何给定的功能块设计和构建三到四年。如果我有这种自由度，并且能够彻底解释额外努力的必要性和好处，那么一切都会变得更好。

让我举一个具体的例子。我被分配了一项功能，可以添加到一段代码中，该代码获取一组图像并从图像生成 PDF。现有的代码简洁明了，是为了满足客户的需求而编写的——但它并不是为了增长而构建的。我可以并且确实使用现有代码添加该功能并将其签入，但它很丑陋，并且每个后续功能都会变得更丑陋。然后我又花了两周时间编写了一个全功能的生成 PDF 模型，该模型也被设计为消费者。完成后，我花了几个小时在新模型中重新实现整个 PDF 生成器。我可以非常简洁地解释说，尽管并非绝对必要，但构建模型创建了一种支持技术，并且可以降低向现有代码添加更多功能的成本。我们现在有四种主要产品或功能集，它们完全基于这项技术，并且正在寻找更多。灌篮高手。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T15:36:17.640

我的老板不是一个技术含量很高的人，但他也很难接受“相信我”的答案。我花了一段时间才弄清楚，为了将问题与他联系起来，重要的是要根据时间成本、工时、花费的金钱等来量化问题。

与这个人的理解有关通常会让他们更容易接受你的答案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T14:41:28.677

通常，像这样的讨论会演变成宗教或政治争论——每个人都有自己的观点，但没有人知道答案。您可以做的任何事情都可以为您**的想法添加实质内容，这**将帮助您推动您的想法。

**阅读一些现有的材料**——[关于面孔](https://rads.stackoverflow.com/amzn/click/com/0470084111)、[日常事物的设计](https://rads.stackoverflow.com/amzn/click/com/0465067107)等——看看你是否不能确定一些事实来支持你的感觉，即有些事情只是感觉不对。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T14:46:18.337

一般来说，我发现如果我必须使用“相信我。我知道我在说什么”的论点，我需要回过头来重新考虑我试图解释和实施的内容。有时我会感觉到某事是好是坏，但这是我需要对其进行审查的指标，因为我没有具体的理由说明我应该或不应该做某事。

您应该注意的另一件事是因为他们的头衔而解雇“初级”人员。你可能有更多的经验，但这并不意味着他们不聪明并且他们所说的可能是正确的。实际上，多年的经验几乎没有意义，因为它只是某人从事相同类型工作的年数。这是一个很好的指标，表明某人在他们的职业生涯中处于什么位置，但这并不是一个自动的法令，他们实际上能够一直做出正确的决定。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T15:02:38.140

我也不是一个好的推销员，这似乎是你的问题。当我想说服人们采取另一条路线时，我发现这对我非常有效，那就是提出*引导*性问题。尝试以这样一种方式提出问题，即唯一合乎逻辑的答案就是您正在寻找的答案。这有一个额外的好处，即人们相信他们自己想出了解决方案，这意味着他们更有可能相信解决方案。这需要练习，但是当它不是你的个性类型时，它比成为推销员更容易学习。这也意味着您确实需要了解自己的知识，才能知道如何提出问题以得出*正确*的解决方案。

这种方法还有一个附带好处，即如果他们即使在面对您的主要问题时也能得出不同的解决方案，那么这应该会让您重新审视自己的解决方案。

# lucene - 如何创建更复杂的 Lucene 查询字符串？

> ID：532512
> 
> 赞同：5
> 
> 时间：2009-02-10T14:22:23.527
> 
> 标签：lucene, full-text-search, lucene.net, information-retrieval

这个问题是从[这个](https://stackoverflow.com/questions/532365/how-to-get-more-out-of-lucene-net)问题衍生出来的。我的调查是双重的，但因为两者都是相关的，所以我认为将它们放在一起是个好主意。

*   如何以编程方式创建查询。我知道我可以开始创建字符串并使用查询解析器解析该字符串。但是当我从其他资源中收集零碎信息时，有一种编程方式可以做到这一点。
*   Lucene 查询的语法规则是什么？

- 编辑 -

我将为我想要进行的查询提供一个需求示例：
假设我有 5 个字段：

1.  名
2.  姓
3.  年龄
4.  地址
5.  一切

所有字段都是可选的，最后一个字段应搜索所有其他字段。我检查了每个字段，看看它是否是 IsNullOrEmpty()。如果不是，我想附加我的查询的一部分，以便添加相关的搜索部分。
名字和姓氏应该完全匹配，并且比其他字段具有更大的权重。年龄是一个字符串，应该完全匹配。地址可以按顺序变化。一切也可以按顺序变化。

我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-04-22T09:09:09.863

使用[BooleanQuery](http://lucene.apache.org/java/3_0_1/api/all/org/apache/lucene/search/BooleanQuery.html)类来组合查询对象。创建其中一个并向其添加（）其他 Query 对象以创建更大的分离查询：

*   BooleanQuery q = new BooleanQuery();
*   q.add(qFirstName, Occur.SHOULD);
*   q.add(qLastName, Occur.SHOULD);
*   ...

可以使用 Term 和 TermQuery 类构建原子查询。

（链接和示例适用于 Lucene Java，但 .NET 应该类似。）

# wpf - 如何将 Themes/Generic.xaml 连接到 window1.xaml？

> ID：532513
> 
> 赞同：5
> 
> 时间：2009-02-10T14:22:31.997
> 
> 标签：wpf, styles

我在 Themes/Generic.xaml 中有以下按钮样式，我希望它适用于我的 WPF 应用程序中任何地方的按钮。

例如，如何将它连接到我的 window1.xaml？

```
<Style TargetType="{x:Type Button}">
  <Setter Property="SnapsToDevicePixels" Value="true"/>
  <Setter Property="OverridesDefaultStyle" Value="true"/>
  <Setter Property="MinHeight" Value="23"/>
  <Setter Property="MinWidth" Value="75"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type Button}">
        <Border 
          x:Name="Border"  
          CornerRadius="2" 
          BorderThickness="1"
          Background="#C0C0C0"
          BorderBrush="#404040">
          <ContentPresenter 
            Margin="2"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            RecognizesAccessKey="True"/>
        </Border>
        <ControlTemplate.Triggers>
          <Trigger Property="IsKeyboardFocused" Value="true">
            <Setter TargetName="Border" Property="BorderBrush" Value="#202020" />
          </Trigger>
          <Trigger Property="IsDefaulted" Value="true">
            <Setter TargetName="Border" Property="BorderBrush" Value="#202020" />
          </Trigger>
          <Trigger Property="IsMouseOver" Value="true">
            <Setter TargetName="Border" Property="Background" Value="#808080" />
          </Trigger>
          <Trigger Property="IsPressed" Value="true">
            <Setter TargetName="Border" Property="Background" Value="#E0E0E0" />
            <Setter TargetName="Border" Property="BorderBrush" Value="#606060" />
          </Trigger>
          <Trigger Property="IsEnabled" Value="false">
            <Setter TargetName="Border" Property="Background" Value="#EEEEEE" />
            <Setter TargetName="Border" Property="BorderBrush" Value="#AAAAAA" />
            <Setter Property="Foreground" Value="#888888"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T15:46:09.143

在您的 Widow1.xaml（或您的 App.xaml，更改为）......

```
<Window1.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="DefaultStyles.xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Window1.Resources> 
```

# jquery - 使用 jquery ui themeroller 主题的最佳方法是什么

> ID：532515
> 
> 赞同：4
> 
> 时间：2009-02-10T14:22:42.420
> 
> 标签：jquery, css, jquery-ui, themeroller, jquery-ui-theme

我昨晚才第一次下载`jquery`并`jquery-ui`使用/学习。

我想出了如何让它工作，现在我正在玩 themeroller 上的可下载/可自定义主题......（好工具）。

关于最大化使用这些工具的最佳方法的问题：

我正在使用我自己的自定义 css 使用我喜欢的颜色/字体集成`jquery/jqueryUI`到现有`asp.net`的“主题”中，我使用“themeroller”应用程序让 jquery UI 元素或多或少与我现有的 css 颜色匹配/字体方案。

**真正的问题是，我是在倒退吗？我会更好地在 themeroller 中设计我的主题，然后将生成的 CSS 用于我的所有应用程序吗？而不是使用themeroller来模仿我已经拥有的非jquery UI元素的css？**

我可以看到能够使用themeroller，下载CSS，然后将非jqueryUI CSS基于生成的CSS会很好，但如果这不是一种普遍接受的方法，我不想尝试最终会给我带来麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T14:28:35.523

我通常做的是使用 ThemeRoller 为 jQuery 生成一个主题，该主题使用我网站 CSS 中的颜色。不过，我的网站没有使用 ThemeRoller 主题，我通常将这两个分开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T23:15:36.863

我个人为我的整个网站使用完整的 jquery 主题。**ui-widget**、**ui-widget-content**、**ui-widget-header**、**ui-state-default**和**ui-state-active**等。我用这些标签创建我的菜单。我认为适合该模型很好，因为如果我想即时交换主题或稍后更改主题，我不会有太大的抵抗力。

当然，他们总是例外。所以，我总是把我的 global.css 文件放在我的头文件中我的 ui.all.css 文件之后。

# .net - 如何手动从 app.config 文件中读取强类型对象

> ID：532517
> 
> 赞同：2
> 
> 时间：2009-02-10T14:23:13.197
> 
> 标签：.net, app-config, strong-typing

我有一个要从手动指定的 app.config 文件中读取的 dll（该 dll 是本机 com dll 的 .net 扩展名，它是 Microsoft 管理控制台管理单元，因此没有 mmc.exe.config）。我已经能够打开配置文件，阅读相关组和部分以获得我想要的设置。像这样：

```
ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();
            fileMap.ExeConfigFilename = Assembly.GetExecutingAssembly().Location + ".config"; 
            Configuration config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);
            ShowSectionGroupCollectionInfo(config.SectionGroups);
            ConfigurationSectionGroup group = config.SectionGroups["applicationSettings"];
            ClientSettingsSection section = group.Sections["Namespace.Properties.Settings"] as ClientSettingsSection;
            SettingElement sectionElement = section.Settings.Get("AllowedPlugins");

            SettingValueElement elementValue = sectionElement.Value; 
```

设置是一个字符串集合和一个字符串。像这样：

```
<applicationSettings>
    <Namespace.Properties.Settings>
        <setting name="AllowedPlugins" serializeAs="Xml">
            <value>
                <ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
                    <string>Plugin1.Name</string>
                    <string>Plugin2.Name</string>
                    <string>Plugin3.Name</string>
                </ArrayOfString>
            </value>
        </setting>
        <setting name="blah" serializeAs="String">
            <value>sajksjaksj</value>
        </setting>
    </Namespace.Properties.Settings>
</applicationSettings> 
```

我可以通过这种方式创建一个字符串数组：

```
List<String> values = new List<string>(elementValue.ValueXml.InnerText.Split(new string[]{" ",Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries )); 
```

但我想知道是否有一种我错过的好方法可以让我的设置被读取并转换为正确类型的对象，就像读取标准 app.config 文件时一样。

请告诉我有...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T14:58:33.190

我过去这样做的方式是使用自定义配置部分并`IConfigurationSectionHandler` 为该部分实现一个。您仍然必须在配置部分处理程序中进行所有解析，但是它可以轻松地以您希望在应用程序中的形式获取配置部分中的信息。MSDN 上有一篇[How To 文章介绍了创建此类处理程序的过程。](http://msdn.microsoft.com/en-us/library/ms228056.aspx)

下面是我用过的一个例子：

用法：

```
Dictionary<string,AdministrativeRole> roles
        = ConfigurationManager.GetSection("roles")
             as Dictionary<string,AdministrativeRole>; 
```

网络配置：

```
<configuration>
   <configSections>
      <section name="roles"
               type="com.example.RolesDefinitionHandler, com.example" />
   </configSections>
   <roles>
       <role name="Administrator" group="domain\group-name" />
       ...
   </roles>
</configuration> 
```

代码：

```
public class RolesDefinitionHandler : IConfigurationSectionHandler
{
    private static readonly string ROLE_SECTION_NAME = "role";
    private static readonly string ROLE_SECTION_NAME_ATTRIBUTE = "name";
    private static readonly string ROLE_SECTION_GROUP_ATTRIBUTE = "group";

    private Dictionary<string, AdministrativeRole> ReadConfiguration( XmlNode section )
    {
        Dictionary<string, AdministrativeRole> roles = new Dictionary<string, AdministrativeRole>();
        foreach (XmlNode node in section.ChildNodes)
        {
            if (node.Name.Equals( ROLE_SECTION_NAME, StringComparison.InvariantCultureIgnoreCase ))
            {
                string name = (node.Attributes[ROLE_SECTION_NAME_ATTRIBUTE] != null) ? node.Attributes[ROLE_SECTION_NAME_ATTRIBUTE].Value.ToLower() : null;
                if (string.IsNullOrEmpty( name ))
                {
                    throw new ConfigurationErrorsException( "missing required attribute " + ROLE_SECTION_NAME_ATTRIBUTE );
                }

                string group = (node.Attributes[ROLE_SECTION_GROUP_ATTRIBUTE] != null) ? node.Attributes[ROLE_SECTION_GROUP_ATTRIBUTE].Value.ToLower() : null;
                if (string.IsNullOrEmpty( group ))
                {
                    throw new ConfigurationErrorsException( "missing required attribute " + ROLE_SECTION_GROUP_ATTRIBUTE );
                }

                if (roles.ContainsKey( name ))
                {
                    throw new ConfigurationErrorsException( "duplicate " + ROLE_SECTION_NAME + " for " + name );
                }

                roles.Add( name, new AdministrativeRole( name, group ) );
            }
            else
            {
                throw new ConfigurationErrorsException( "illegal node " + node.Name );
            }
        }

        return roles;
    }

    #region IConfigurationSectionHandler Members

    public object Create( object parent, object configContext, System.Xml.XmlNode section )
    {
        return ReadConfiguration( section );
    }

    #endregion
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:15:27.073

更好的解决方案可能是，类似于如何将 sql 连接字符串添加到 app.config：

[http://msdn.microsoft.com/en-us/library/system.configuration.configurationcollectionattribute.aspx](http://msdn.microsoft.com/en-us/library/system.configuration.configurationcollectionattribute.aspx)

# ant - 如何使用 Ant 将 portlet 部署到远程 WebSphere Portal？

> ID：532518
> 
> 赞同：4
> 
> 时间：2009-02-10T14:23:39.110
> 
> 标签：ant, websphere, deployment, portal

如何使用 Ant 将 portlet 部署到远程 WebSphere Portal 6.0 (Linux)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T11:01:29.213

您应该能够使用 XmlAccess Ant 任务来执行此操作。请参阅 Redbook [WebSphere Portal Version 6 Enterprise Scale Deployment Best Practices](http://www.redbooks.ibm.com/abstracts/sg247387.html?Open)的附录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T19:58:26.440

我们通过执行以下操作的 ant 任务在本地而不是远程执行此操作：

1) 将portlet 的war 文件复制到Portal 的installApps 目录（因为您是在远程进行的，所以您需要通过FTP 或者其他方式，而不是像我们那样简单地在本地复制它）。

2) 针对当前目录“xmlaccess”的子目录中名为“update.xmlaccess”的 xml 访问文件执行 xmlaccess 脚本（在我们的示例中为 xmlaccess.bat，在您的示例中为 xmlaccess.sh）。

这是来自我们的 ant 任务的代码片段。其中的一些值是特定于我们脚本的变量，但名称应该足够简单，以便弄清楚它们的作用：

```
<target name="deploy" depends="war" description="deploy the application">
        <copy file="${project.base}/target/${package.name}.war" todir="${portal.base}/installableApps" />
        <echo message="Deploying ${project.name} to WebSphere Portal." />
        <exec executable="${portal.base}/bin/xmlaccess.bat">
            <arg line='-in "xmlaccess/update.xmlaccess" -user ${wps.admin.user} -pwd ${wps.admin.password} -url ${wps.admin.url} 
                -out "xmlaccess/deploymentresults.xmlaccess"' />
        </exec>
</target> 
```

# apache-flex - 导入 mx.controls.TextArea；不适用于 Flex 3.2？

> ID：532519
> 
> 赞同：0
> 
> 时间：2009-02-10T14:23:58.657
> 
> 标签：apache-flex, actionscript-3, flex3, flexbuilder

为什么 TextArea 类不适用于我的 Flex Builder 3？

项目在构建路径中有 flex32 SDK。其他进口都OK。

```
 import flash.display.*;
    import flash.events.*;
    import flash.geom.*;
    import flash.net.*;
    import flash.text.*;
    import flash.utils.*;

    import mx.core.*;
    import mx.controls.TextArea; 
```

> 严重性和说明 1172：
> 
> 定义 mx.controls:TextArea 找不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T09:25:09.463

我的猜测是您创建了一个“ActionScript 项目”而不是一个“Flex 项目”，因此除非您明确添加它们，否则某些包和组件将不可用。

最简单的解决方法是创建一个 Flex 项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T06:40:13.407

我使用 sdk 和 FlashDevelop，并且必须将类路径配置为指向 \flex_sdk_3.2\frameworks\projects\framework\src 否则，编译器或编辑器将找不到这些类。而且，编译器会抛出同样的错误。也许 Flex Builder 遇到了在 framework.swc 中定义和引用的类之间的冲突，或者项目的类路径可能设置为类似于 FlashDevelop。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-16T11:24:50.480

导入 flash.text.TextField；:)

# emacs - Emacs 中 HTML 模式的选项卡

> ID：532520
> 
> 赞同：12
> 
> 时间：2009-02-10T14:24:57.407
> 
> 标签：emacs

我是一个标签人。除非我正在处理一个已经使用空格的项目，否则我会使用制表符。我主要做 php 和 html 的工作。我在 php 中的标签运行良好。但我不知道如何让 html 模式使用制表符而不是两个空格。

这是我到目前为止所拥有的：

```
(setq c-default-style "python")
(setq-default c-basic-offset 4
              tab-width 4
              indent-tabs-mode t) 
```

我可以设置什么以便 html 模式使用标签？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-10T14:29:03.213

```
(add-hook 'html-mode-hook
          (lambda()
            (setq sgml-basic-offset 4)
            (setq indent-tabs-mode t))) 
```

这是有效的，因为当`indent-tabs-mode`is时`t`，Emacs 的默认缩进逻辑会尽可能用制表符替换空格，同时仍然保留适当的列偏移以进行缩进。因此，例如，如果您的代码应该在每个缩进级别偏移四个字符（即`sgml-basic-offset`，`4`如上所述），您的代码应该缩进两个级别，并且每个缩进级别有四列，那么 Emacs 会计算如果它缩进有两个制表符和零空格，这将导致正确的列偏移。

但是，这也意味着，如果您弄乱了`tab-width`. 例如，如果您将其设置为`8`并缩进一级，Emacs 会计算出即使它只插入一个制表符，视觉列偏移量 (8) 也会大于所需的偏移量 (4)。所以它会插入四个空格。尝试设置`sgml-basic-offset`为与您的`tab-width`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T14:53:50.253

实际上，默认情况下 indent-tabs-mode 应该可能是 t 。

试试 Mi，只是为了好玩。那应该插入一个制表符。这不是一个很好的解决方案，但它可能会在紧要关头起作用。

另外，您是如何测试空格与制表符的？穿过它？或删除它？你可能有“向后删除字符取消标签”抬起它的头。

# java - 哪种数据结构使用更多内存？

> ID：532521
> 
> 赞同：0
> 
> 时间：2009-02-10T14:25:10.667
> 
> 标签：java, data-structures, memory-management

哪种类型的数据结构使用更多的内存？

*   哈希表
*   哈希图
*   数组列表

能否请您简要解释一下哪个更不容易发生内存泄漏？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-10T14:35:00.673

> *...使用哪一个来避免内存泄漏*

答案是**全部**，**没有**一个。

内存泄漏与数据结构无关，而与您使用它们的方式有关。

当您旨在避免“内存泄漏”时，每个人使用的内存量无关紧要。

您可以做的最好的事情是：当您检测到一个对象**将不再**在应用程序中使用时，您**必须**将其从集合中删除（不仅是您列出的对象，还包括您可能使用的任何其他对象；列表、地图，设置甚至数组）。

这样垃圾收集器将能够释放该对象使用的内存。

您可以查看这篇文章[“垃圾收集器的工作原理”](http://chaoticjava.com/posts/how-does-garbage-collection-work/)，以进一步解释 Java 如何从它使用的对象中释放内存。

**编辑：**

Java 中还有其他有助于引用管理的数据结构，例如[WeakHashMap](http://java.sun.com/j2se/1.4.2/docs/api/java/util/WeakHashMap.html)，但这可能被视为“高级主题”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T14:35:49.000

很可能您应该只使用适合您当前需求的集合。在最常见的情况下，如果您需要 a `List`，请使用`ArrayList`，如果您需要`Map`，请使用`HashMap`。有关教程，请参见[http://java.sun.com/docs/books/tutorial/collections/](http://java.sun.com/docs/books/tutorial/collections/)

*当*您的分析器显示存在与使用 Java 集合相关的实际内存泄漏时，请对其进行处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T14:37:22.163

您的问题被严重低估了，因为您指定的具体数据结构不是具有可比性的结构。

HashMap/HashTable 具有可比性，因为它们都用作映射（键 -> 值查找）。ArrayLists（和一般的列表）没有。

HashMap/HashTable 部分很容易回答，因为它们在很大程度上是相同的（主要区别是空键），但前者不同步，后者是，因此 HashMap 通常会更快（假设不需要同步）现代 JVM 是虽然在非竞争锁上相当快，但在微基准测试中差异会很小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T19:13:31.033

好吧，实际上我最近一直处于必须持有大量自定义对象的情况下，其中集合的大小是应用程序的限制因素之一。如果这是你的情况，一些建议 -

*   有一些使用原语的集合实现（ [在此处](http://www.java2s.com/Product/Java/Programming/Collections.htm)列出）。用 trove4j 玩了一下，发现内存占用要小一些（当然，只要你在处理原语）。
*   如果您正在处理大型集合，则通过优化您持有的对象，您可能会在减少内存占用方面获得更多收益。毕竟，你有更多的东西，否则你就不需要收藏了，对吧？
*   一些集合自然更小（例如 LinkedList 会比 ArrayList 小一点），但差异可能会被它们使用方式的差异所淹没）
*   大多数 Java 集合都可以手动调整大小 - 您可以将包含 100 个元素的数组列表设置为初始化为 100 个元素，并且可以将地图设置为以降低性能为代价保持较少的开放空间。全部在 javadocs 中。

归根结底，最简单的事情就是自己测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T15:57:44.513

java.util.Collection 存储对对象的引用。

java.util.Map 存储对 Map.Entry 实例的引用，这些实例包含对键和对象的引用。

因此，持有 N 个对象引用的 java.util.Collection 将比持有相同 N 个引用的 java.util.Map 需要更少的内存，因为 Map 也必须指向键。

读取和写入的性能因每个接口的实现而异。

我没有看到任何类似于 WeakHashMap 的 java.util.Collection。如果您担心垃圾收集和内存泄漏，我会阅读该课程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T14:32:48.917

你不是在比较 like 和 like:`HashMap`并`Hashtable`实现`Map`接口，并`ArrayList`实现`List`接口。

`Hashtable`在和之间的直接比较中，由于是同步的`HashMap`，`HashMap`因此可能会提供更好的性能。`Hashtable`

如果你给出一些关于你将集合用于什么的指示，你可能会得到一个更有洞察力的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T14:48:48.020

Hashtables（无论是 HashMap 还是 HashTable）会比它们用于实际存储信息的内存多一点。

哈希性能是有代价的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-29T08:04:02.540

正如其他人指出的那样，您的问题未详细说明。

尽管如此，有时基于 ArrayList 的实现可以替换基于 HashMap 的实现（我根本不会考虑 Hashtable，它已经过时了）。您可能需要线性搜索 ArrayList，但对于可能仍然足够快的小型列表，并且 ArrayList 将需要更少的内存（对于相同的数据），因为它的开销更少。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-10T14:32:11.600

在大多数语言中，这取决于你用完玩具后拿起玩具的能力。

在 Java 中，这无关紧要，因为垃圾收集是自动完成的，您不必担心内存泄漏。

# c++ - 如何解析简单的 C++ typedef 指令？

> ID：532524
> 
> 赞同：1
> 
> 时间：2009-02-10T14:25:34.347
> 
> 标签：c++, parsing

我想解析简单的 C++ typedef 指令，例如

```
typedef Class NewNameForClass;
typedef Class::InsideTypedef NewNameForTypedef;
typedef TemplateClass<Arg1,Arg2> AliasForObject; 
```

我已经编写了我希望在解析中使用的相应语法。

```
Name <- ('_'|letter)('_'|letter|digit)*
Type <- Name
Type <- Type::Name
Type <- Name Templates
Templates <- '<' Type (',' Type)* '>'
Instruction <- "typedef" Type Name ';' 
```

解析后，我要做的就是生成具有相同信息的 xml（但布局不同）

编写这样的程序最有效的语言是什么？你怎么能做到这一点？

**编辑：我使用 Boost Spirit 想出什么**（它并不完美，但对我来说已经足够好了，至少现在是这样）

```
 rule<> sep_p = space_p;
   rule<> name_p =  (ch_p('_')|alpha_p) >> *(ch_p('_')|alpha_p|digit_p);
   rule<> type_p = name_p
           >> !(*sep_p >>str_p("::") >> *sep_p>> name_p)
           >>  *(*sep_p >> ch_p('*') )
           >> !(*sep_p >> str_p("const"))
           >> !(*sep_p >> ch_p('&'));
   rule<> templated_type_p = name_p >> *sep_p
           >> ch_p('<') >> *sep_p
           >> (*sep_p>>type_p>>*sep_p)%ch_p(',')
           >> ch_p('>') >> *sep_p;

   rule<> typedef_p = *sep_p
                   >> str_p ("typedef")
                   >> +sep_p >> (type_p|templated_type_p)
                   >> +sep_p >> name_p
                   >> *sep_p >> ch_p(';')  >> *sep_p;
   rule<> typedef_list_p = *typedef_p; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T14:26:56.590

好吧，既然您显然已经在使用/在 C++ 上工作，那么您是否考虑过使用[Boost.Spirit](http://spirit.sourceforge.net/)？这允许您将 C++ 中的内联语法硬编码为特定于域的语言，并在普通 C++ 代码中对其进行编程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T14:29:52.353

我会稍微改变语法

```
ShortName <- ('_'|letter)('_'|letter|digit)*
Name <- ShortName
Name <- Name::ShortName
Type <- Name
Type <- Name Templates
Templates <- '<' Type (',' Type)* '>'
Instruction <- "typedef" Type Name ';' 
```

您的语法也忽略了以下情况

1.  多个 typedef 目标。
2.  指针目标
3.  函数指针（这是迄今为止最困难的）

解析语法（我喜欢讽刺）是一个相当直接的操作。如果您想以功能方式实际使用语法，我会说最好的选择是 lex/yacc 组合。

但是从您的问题来看，您似乎想将其吐出为另一种格式。确实没有为此设计的语言，所以我会说使用您最熟悉的任何语言。

**编辑**

OP 询问了多个 typedef 目标。typedef 声明具有多个目标是完全合法的。例如：

```
typedef _SomeStruct SomeStruct, *PSomeStruct 
```

这将创建 2 个 typedef 名称。

1.  SomeStruct 相当于“struct _SomeStruct”
2.  PSomeStruct 相当于“struct _SomeStruct*”

# visual-studio-2005 - 登录 Visual Studio 2005 - 使用现有 .pfx 时出错

> ID：532540
> 
> 赞同：5
> 
> 时间：2009-02-10T14:29:03.963
> 
> 标签：visual-studio-2005, signing, pfx

1.  建立了我的项目。

2.  使用 sn.exe -k 创建了我的 .pfx（创建 ShellTradingCCMPROD.pfx）。

3.  将文件复制到应用程序文件夹。

4.  在 VS 2005 中，我转到“签名”选项卡，“从文件中选择”并浏览到 .pfx 文件。

5.  我点击“打开”，我收到以下错误：

无法导入文件“C:\2009.02.1.1\ShellTrading.CCM.WinUI\ShellTradingCCMPROD.pfx”：找不到请求的对象。

其他 .pfx 文件有效 - 任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-04T07:28:04.823

你可以参考下面的链接，因为它非常仔细地解释了如何解决这个特定的问题。

```
http://odondo.wordpress.com/2010/05/23/signing-assemblies-with-a-pfx-file/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-14T09:16:34.943

`sn.exe -k`不会创建 .pfx 格式的文件。我没有 VS2005 了，但是当我将文件命名为 VS2010 时，它可以在 VS2010 中使用`ShellTradingCCMPROD.snk`。此文件中的密钥不受密码保护。

据我所知，您不能使用 sn.exe 创建受密码保护的密钥。

# c# - Web服务对结构对象的序列化

> ID：532547
> 
> 赞同：2
> 
> 时间：2009-02-10T14:29:52.730
> 
> 标签：c#, web-services, serialization, .net-2.0

我通过向其中添加一些基本字段来“扩展” System.DateTime 结构。理想情况下，我希望能够通过 web 服务将此对象传递给 winforms 客户端。

我已将 stuct 类型标记为`[Serializable]`并且它也implments `ISerializable`，但是如果我检查由 web 服务传递的 XML，它只包含对象的空标记。

到处放置断点让我相信，当对象脱水时，ISerializable 方法`void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)`似乎永远不会被调用。

我更喜欢将其保留为结构的原因有多种，但如有必要，会将其转换为类。

有谁知道为什么 GetObjectData 在为 web 服务响应准备数据时被 .net 框架忽略？我正在使用的结构包含一个 DateTime 成员和一些布尔值。

**请注意，这是.net 2.0！**

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T14:33:26.260

首先，使用网络服务`XmlSerializer`——所以你需要`IXmlSerializable`自定义序列化。标准`XmlSerializer`序列化仅作用于同时具有 getter 和 setter 的公共属性。

其次，结构通常不能很好地用作 Web 服务 DTO 对象；特别是，`XmlSerializer`要求事物是可变的......哪些结构不应该。

我个人会使用一个类。如果您能提供更多信息，我可能会说更多...

例如：

```
[Serializable]
public class FunkyTime
{
    [XmlAttribute]
    public DateTime When { get; set; }
    [XmlAttribute]
    public bool IsStart { get; set; }
    [XmlAttribute]
    public bool IsEnd { get; set; }
} 
```

（请注意，您可以通过各种方式调整 xml 布局/名称）

# javascript - Javascript倒计时

> ID：532553
> 
> 赞同：10
> 
> 时间：2009-02-10T14:31:31.353
> 
> 标签：javascript

我在网上搜索过，但所有现成的都是你指定日期的地方，它会倒计时到那个日期。我需要的是从“27 分 43 秒”（以那种格式）一直倒计时到 0 的东西，从他们登陆页面时开始，有人有任何可用的片段吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-10T14:46:15.763

像这样的东西应该可以解决问题。我很无聊，决定自己做而不是谷歌搜索。只需在顶部设置分钟和秒，然后将 onload 中对倒计时的调用更改为您希望它更新的元素的 id。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <script>
    var interval;
    var minutes = 1;
    var seconds = 5;
    window.onload = function() {
        countdown('countdown');
    }

    function countdown(element) {
        interval = setInterval(function() {
            var el = document.getElementById(element);
            if(seconds == 0) {
                if(minutes == 0) {
                    el.innerHTML = "countdown's over!";                    
                    clearInterval(interval);
                    return;
                } else {
                    minutes--;
                    seconds = 60;
                }
            }
            if(minutes > 0) {
                var minute_text = minutes + (minutes > 1 ? ' minutes' : ' minute');
            } else {
                var minute_text = '';
            }
            var second_text = seconds > 1 ? 'seconds' : 'second';
            el.innerHTML = minute_text + ' ' + seconds + ' ' + second_text + ' remaining';
            seconds--;
        }, 1000);
    }
    </script>
</head>
<body>
<div id='countdown'></div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-08T08:58:16.650

我做了一个简单的倒计时，你可以使用。

它正在生成格式：

> 第 X 天、第 X 小时、第 X 分钟、第 X 秒

JS：

```
countIt();

function countIt(){
    year = 2013;
    month = 05;
    day = 28;
    hours = 12;
    minutes = 00;
    seconds = 00;

    setTimeout(function(){
    endDate = new Date(year, (month - 1), day, hours, minutes, seconds, 00);
    thisDate  = new Date();
    thisDate  = new Date(thisDate.getFullYear(), thisDate.getMonth(), thisDate.getDate(), thisDate.getHours(), thisDate.getMinutes(), thisDate.getSeconds(), 00, 00);

    var daysLeft = parseInt((endDate-thisDate)/86400000);
    var hoursLeft = parseInt((endDate-thisDate)/3600000); 
    var minutsLeft = parseInt((endDate-thisDate)/60000);
    var secondsLeft = parseInt((endDate-thisDate)/1000);

    seconds = minutsLeft*60;
    seconds = secondsLeft-seconds;

    minutes = hoursLeft*60;
    minutes = minutsLeft-minutes;

    hours = daysLeft*24;
    hours = (hoursLeft-hours) < 0 ? 0 : hoursLeft-hours;

    days = daysLeft;

    startCount(days, hours, minutes,seconds);
    }, 1000);
}

function startCount(days, hours, minutes, seconds){
    document.getElementById("counter").innerHTML="DAYS "+days+", HOURS "+hours+", MINUTES "+minutes+", SECONDS: "+seconds;
    countIt();
} 
```

的HTML：

```
<div id="counter"></div> 
```

[点击这里观看直播](http://jsfiddle.net/RUTVj/2/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T14:40:08.943

我想你正在寻找这样的[东西](http://javascript.internet.com/time-date/countdown-timer-2.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-28T14:18:26.390

嗯，为什么不直接使用这个：

```
 <div id="countdown">countdown displayed here</div>
    <script type="text/javascript">                               
        $(document).ready(function() {
            //time to count down
            hoursToGo = 0;
            minutesToGo = 27;
            secondsToGo = 43;

            var startTime = new Date();              
            var endTime = new Date();
            endTime.setHours(
                startTime.getHours() + hoursToGo,
                startTime.getMinutes() + minutesToGo, 
                startTime.getSeconds() + secondsToGo, 
                startTime.getMilliseconds()
            );

            //function to update counter
            function update(){
                var currentTime = new Date();

                var remainingTime = new Date();
                remainingTime.setTime(endTime.getTime()-currentTime.getTime());

                $("#countdown").text(remainingTime.getHours()+":"+remainingTime.getMinutes()+":"+remainingTime.getSeconds());

                //call itself every second
                setTimeout(update,1000);
            }

            //start the countdown
            update();                
        });
    </script> 
```

**编辑** 作为一个附加的想法，您可以通过将结束时间作为隐藏表单元素的值传递到下一页来在多个页面上实现这一点。或者至少这就是我要用它做的;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-29T17:42:28.913

[jCounter](http://devingredients.com/jcounter/)是一个插件，它也接受自定义值来显示你想要的任何倒计时

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-03T23:14:38.253

我还制作了一个倒计时时钟，但使用的是 html5 画布。如果您喜欢，请随意使用它。（运行下面的代码片段）

```
(function() {
  /**
  * WlCounter pure JS class
  *
  * @class WlCounter
  * @Author: Wiktor Lis
  */
  var WlCounter = function(){
    // date settings - REMEMBER months in Date object are counted as an Array from 0! So months range is between 0 to 11\. Other than that everything is just as you would expect it to be.
    this.setEventDate(new Date(2017, 03, 22, 22, 5, 0), 'Curently Unused'); // NOTE! months are represented from 0 to 11 in Date objects
    this.setEventEndDate(new Date(2019, 04, 03, 22, 9, 0), 'Curently Unused', 'Curently Unused'); // NOTE! months are represented from 0 to 11 in Date objects

    // CLOCK SETTINGS
    // clock size
    this.container = {
      x: 0,
      y: 0,
      w: 150,
      h: 150
    };
    // ring stroke
    this.stroke = this.container.w / 10;
    // number font size
    this.numFontSize = this.container.w / 6 +'px';
    // label font size
    this.labelFontSize = this.container.w / 10 +'px';
    // colors
    this.colorRing = "hsla(355, 0%, 90%, 1)";
    this.colorActive = "hsla(355, 100%, 50%, 1)";
    this.colorTimedOut = "hsla(355, 0%, 50%, 0.3)";

    // OTHER
    // init objets
    this.curent = {};
    this.counter = {};
  }

  /**
  * This method creates canvas based on css id 
  *
  * @method createCanvas
  * @param {String} cssId of canvas DOM object
  */
  WlCounter.prototype.createCanvas = function(cssId){
    this.canvas = document.getElementById(cssId);
    this.canvas.setAttribute("width", this.container.w);
    this.canvas.setAttribute("height", this.container.h);
    this.c = this.canvas.getContext('2d');
    return this.c
  }

  /**
  * Init all canvas objects and start counting down
  *
  * @method init
  */  
  WlCounter.prototype.init = function(){
    this.daysBox = this.createCanvas('canvas-d');
    this.hoursBox = this.createCanvas('canvas-h');
    this.minutesBox = this.createCanvas('canvas-m');
    this.secoundsBox = this.createCanvas('canvas-s');
    this.msBox = this.createCanvas('canvas-ms');
    this.startCounting();
    this.intervalClock();
  }

  /**
  * Assign curent time to class properities
  *
  * @method getTime
  */
  WlCounter.prototype.getTime = function() {
    this.curent.time = new Date();
    this.curent.days = this.curent.time.getDay();
    this.curent.hours = this.curent.time.getHours();
    this.curent.minutes = this.curent.time.getMinutes();
    this.curent.seconds = this.curent.time.getSeconds();
    this.curent.milliseconds = this.curent.time.getMilliseconds();
  }

  /**
  * Creates event start date  // and its message
  *
  * @method setEventDate
  * @param {Object Date} date - defines event start date
  * @param {String} messageBefore - curently unused
  */
  WlCounter.prototype.setEventDate = function(date, messageBefore) {
    this.eventStarts = date;
    this.messageBefore = messageBefore;
  }

  /**
  * Define event end date
  *
  * @method setEventEndDate
  * @param {Object Date} date 
  * @param {String} messageDuring 
  * @param {String} messageAfter
  */
  WlCounter.prototype.setEventEndDate = function(date, messageDuring, messageAfter) {
    this.eventEnds = date;
    this.messageDuring = messageDuring;
    this.messageAfter = messageAfter;
  }

  /**
  * Substract curent time from event date and define how many of days, hours, min, s, ms are left
  * If event starts counter finished -> change counter color to greenish (hsla(160, 100%, 38%, 1)) and count to events End time.
  *
  * @method startCounting
  */
  WlCounter.prototype.startCounting = function() {
    this.intervalToEvent = setInterval(function() {
      this.getTime();
      if (this.curent.time < this.eventStarts) {
        this.subject = this.eventStarts;
      } else if(this.curent.time < this.eventEnds) {
        // change colors
        this.colorActive = "hsla(160, 100%, 38%, 1)";
        this.subject = this.eventEnds;
      } else {
        this.stagnate();
        return;
      }

      var until = this.subject - this.curent.time;
      this.counter.ms = Math.floor(until % 1000);
      this.counter.sec = Math.floor(until / (1000) % 60);
      this.counter.min = Math.floor(until / (1000 * 60) % 60);
      this.counter.hours = Math.floor(until / (1000 * 60 * 60 ) % 24);
      this.counter.days = Math.floor(until / (1000 * 60 * 60 * 24));
      // console.log(this.counter);

    }.bind(this), 16.666);
  }

  /**
  * If counter will go pass the event start and end date, simply stagneta the clock assigning 0 to each clock
  *
  * @method stagnate
  */
  WlCounter.prototype.stagnate = function() {
      clearInterval(this.intervalToEvent);
      this.counter.ms = 0;
      this.counter.sec = 0;
      this.counter.min = 0;
      this.counter.hours = 0;
      this.counter.days = 0;
  }

  /**
  * Convert deg to radians
  *
  * @method degToRad
  * @param {Integer} deg
  */
  WlCounter.prototype.degToRad = function(deg) {
    radians = Math.PI / 180;
    return radians * deg;
  }

  /**
  * Draw the clock and sign it with the text from the @param2
  *
  * @method drawClock
  * @param {Object} ctx - canvas selection
  * @param {Array} timeUnit - example [this.counter.days, 365, 'D'] -> [0] counter number of days -> [1] max days for the clock to count down -> [2] Title that will be assign to the clock under the number
  */
  WlCounter.prototype.drawClock = function(ctx, timeUnit) {
      // background - gradient
      gradient = ctx.createRadialGradient(this.container.w/2, this.container.h/2, 55, this.container.w/2, this.container.h/2,  this.container.w/2);
      gradient.addColorStop(1, 'rgba(245,245,245, 0.1)');
      gradient.addColorStop(0, 'white');    

      // canvas rect
      // ctx.fillStyle = "white";
      ctx.fillStyle = gradient;
      ctx.fillRect(0,0,this.container.w, this.container.h);

      // clock rim
      ctx.beginPath();
      ctx.strokeStyle = this.colorRing;
      ctx.lineWidth = this.container.w / 18;
      ctx.arc(this.container.w/2, this.container.h/2,this.container.h/2-this.stroke, this.degToRad(270), this.degToRad(0 - 90));
      ctx.stroke();

      // clock time
      ctx.beginPath();
      // ctx.shadowBlur = this.stroke-10;
      // ctx.shadowColor = "hsla(355, 100%, 0%, 0.2)";
      // ring countdown
      // ctx.lineCap = "round";
      ctx.strokeStyle = this.colorActive;
      if(timeUnit[0] == 0) ctx.shadowColor = ctx.strokeStyle = this.colorTimedOut;  // if time is 0 set color to gray
      ctx.lineWidth = this.stroke;
      // draw ring countdown
      ctx.arc(this.container.w/2, this.container.h/2,this.container.h/2-this.stroke, this.degToRad(270), this.degToRad(360 * timeUnit[0] / timeUnit[1] - 90));

      // text - number
      ctx.font = this.numFontSize+" Arial";
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillStyle = this.colorActive;
      if(timeUnit[0] == 0) ctx.fillStyle = this.colorTimedOut;
      if(timeUnit[1] == 60000) timeUnit[0] = Math.round(timeUnit[0]/1000);
      ctx.fillText(timeUnit[0],this.container.w/2,this.container.h/2);

      // text - label
      ctx.font = this.labelFontSize+" Arial";
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(timeUnit[2],this.container.w/2,this.container.h/2 + (this.container.w / 5));

      // draw!
      ctx.stroke();
  }

  /**
  * Set interval to draw clock around 60 frames per seckound (1s / 60  = 16.666)
  *
  * @method intervalClock
  */
  WlCounter.prototype.intervalClock = function() {
    var interval = setInterval(function(){
      // cl(this.counter.ms);
      this.drawClock(this.daysBox, [this.counter.days, 365, 'D']);
      this.drawClock(this.hoursBox, [this.counter.hours, 24, 'H']);
      this.drawClock(this.minutesBox, [this.counter.min, 60, 'M']);
      this.drawClock(this.secoundsBox, [this.counter.sec, 60, 'S']);
      this.drawClock(this.msBox, [this.counter.ms, 1000, 'ms']);
    }.bind(this), 16.666);
  }

  /* RUN WlCounter */
  var counter = new WlCounter();

  // FUTURE -> To Do
  // set event start and end
  // counter.setEventStart(foo);
  // counter.setEventEnd(foo);
  // counter.onEventStart(function(){
    // ...
  // });
  // counter.onEventEnd(function({
    // ...
  // });
  counter.init();
})();
```

```
* {
  padding: 0px;
  margin: 0px;
  text-decoration: none;
  border: none;
}

html, body {
  position: relative;
  padding-top: 20px;
  margin: 0 auto;
}

#wrap, .text {
  width: 770px;
  margin: auto;
}

canvas {
  box-sizing: border-box;
  border-bottom: 5px solid gray;
  height: 100%;
}

h1, p {
  font-weight: 400;
  color: #666;
  font-size: 2.5em;
  width: 100%;
  text-align: center;
}

p {
  font-size: 1em;
  text-align: left;
}

ul ol {
  padding-left: 20px;
  list-style-type: decimal;
  line-height: 2em;
}
```

```
<div class="text">
  <h1>"WlCounter" pure JS class</h1>
</div>
<div id="wrap">
  <canvas id="canvas-d"></canvas>
  <canvas id="canvas-h"></canvas>
  <canvas id="canvas-m"></canvas>
  <canvas id="canvas-s"></canvas>
  <canvas id="canvas-ms"></canvas>
</div>
<div class="text">
  <p>JS WlCounter class counts-down to the event starting and ending date with color change on reaching the first one. After event start date is reached it changes the color to green and start count-down to events end date (if end date was specyfied and is more then curent time). So when event is ended, counter gets graied out and set 0</p>
</div>
```

# soap - 您需要在 Team Foudation Server 中拥有哪些权限才能添加 SOAP 事件处理程序

> ID：532554
> 
> 赞同：0
> 
> 时间：2009-02-10T14:31:46.810
> 
> 标签：soap, tfs

我希望用户自己做，但我不希望每个人都成为管理员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T14:53:47.757

用户确实需要是 TFS 管理员才能添加 SOAP 事件处理程序。要解决此问题，您可以编写自己的 Web 服务来模拟 TFS 管理员并让调用者注册他们的处理程序。

[这是一个具有与此类似的代码的 URL。](http://blog.hinshelwood.com/archive/2007/09/07/TFS-Event-Handler-in-NET-3-5-Part-2-Handling-Team-Foundation-Server-Events.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T02:12:50.170

```
''' <summary>
''' This is the service contract for integrating with the Team Foundation Server notification events.
''' </summary>
''' <remarks></remarks>
<ServiceContract(Namespace:="http://schemas.microsoft.com/TeamFoundation/2005/06/Services/Notification/03")> _
Public Interface INotification

    ''' <summary>
    ''' The Notify method if fired whenever a subscribed event arrives.
    ''' </summary>
    ''' <param name="eventXml">This XML defines the data that was changed on the event.</param>
    ''' <param name="tfsIdentityXml">This XML identifies the Team Foundation Server the event came from.</param>
    ''' <param name="SubscriptionInfo">Information about the subscriber</param>
    ''' <remarks></remarks>
    <OperationContract( _
                    Action:="http://schemas.microsoft.com/TeamFoundation/2005/06/Services/Notification/03/Notify", _
                    ReplyAction:="*" _
                    )> _
    <XmlSerializerFormat( _
                    Style:=OperationFormatStyle.Document _
                    )> _
    Sub Notify(ByVal eventXml As String, ByVal tfsIdentityXml As String, ByVal SubscriptionInfo As SubscriptionInfo)

End Interface 
```

# database - 文件与数据库

> ID：532559
> 
> 赞同：3
> 
> 时间：2009-02-10T14:32:53.843
> 
> 标签：database, file, text, acl

我将为每个单独的用户实现一个访问控制列表，以便他们可以分配对自己资源的访问权限，以便他们可以隐藏东西，例如，对他们的母亲，但向他们的朋友展示。

现在，当每个用户也是一个组时，将 ACL 存储在数据库中似乎会变得非常疯狂，该组可以有许多子组。所以我正在考虑将 ACL 内容存储在文本文件中。

好主意？馊主意？

编辑：我应该注意，我正在为每个用户谈论一个单独的文本文件。我正在考虑创建一个可以序列化并写入文本文件的 ACL 类。我担心将 ACL 存储在数据库中会创建异常巨大的连接表，并对数据库服务器造成巨大压力。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T15:31:13.550

给定我将 ACL 存储在数据库中的选项：

*   访问和查询数据的语言更简单、更标准（SQL）
*   数据库将为您提供事务、快速查询索引、完整性约束和安全性。
*   根据您将数据存储在本地文件中的方式，您可能需要将数据文件与应用程序一起移动。例如：将应用程序从 server1 移动到 server2。
*   对于不可变（或不经常更改）的数据，应使用某种形式的缓存。因此，如果您使用的是文件或数据库，那么您应该将其中的一些数据缓存一段时间。
*   我很确定您可以找到可以用作参考的关系数据库的良好 ACL 模式模板，例如此处的文档：http: [//edhs1.gsfc.nasa.gov/waisdata/v2r20/ps/cd31110001.ps](http://edhs1.gsfc.nasa.gov/waisdata/v2r20/ps/cd31110001.ps)

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T14:37:02.557

我不确定将它存储在文本文件中是否更容易。数据的关系是一样的。当然，SQL 并不总是友好的分层数据，但也不是纯文本文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T14:37:23.757

您的文本文件是否受到并发访问保护？否则数据库将是一个更好的主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T14:43:33.633

XML 是分层数据的理想选择。虽然可以在数据库中使用分层数据，但这解释了多么美妙（这些概念不仅适用于 MySQL）：

[http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

就个人而言，我不会将这样的数据存储在文本文件中。操纵变得更加困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T15:07:36.820

并发会咬你。随着文件变大，复杂性和性能也会降低。在写入文件期间会增加损坏某些东西的风险，例如系统崩溃的断电。

数据库通常会保护您免受这些问题的影响，让您专注于逻辑

您可以使用自连接在数据库中实现分层存储，例如

```
ItemID    Data   ParentID
-------------------------- 
```

其中 ParentID 是指向不同行的 ItemID 的指针

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T12:47:31.287

> 我担心将 ACL 存储在数据库中会创建异常巨大的连接表，并对数据库服务器造成巨大压力。

每个用户有一个文本文件，而您的组/子组可能在其他一些文件中，您将不得不推出自己的联接，不是吗？

您描述的问题/要求正是 SQL 的优点。毫无疑问，SQL 是适合这项工作的工具。

# tsql - 如何使用用户定义的函数？

> ID：532566
> 
> 赞同：0
> 
> 时间：2009-02-10T14:33:33.093
> 
> 标签：tsql, function

我有一个表用户，所以一些特别在字段全名中的行是不同的大写/小写，所以我找到了这个函数：

```
CREATE function properCase(@texto varchar(8000)) returns varchar(8000) as   
begin   
    --declare @texto = 'hola'  
    set @texto = lower(@texto)   

    declare @i int   
    set @i = ascii('a')   

    while @i <= ascii('z')   
    begin   

        set @texto = replace(@texto, ' ' + char(@i), ' ' + char(@i-32))   
        set @i = @i + 1   
    end   

    set @texto = char(ascii(left(@texto, 1))-32) + right(@texto, len(@texto)-1)   

    return @texto   
end 
```

如何使用此功能从我的用户表中更新或选择“全名”字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T14:35:08.177

```
SELECT dbo.properCase(FullName) FROM [User] 
```

和：

```
UPDATE [User] SET FullName = dbo.properCase(FullName) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T14:35:56.350

```
SELECT dbo.properCase(fullname) FROM [user] 
```

和

```
UPDATE [user] SET fullname = dbo.properCase(fullname) 
```

# java - 更改 ImageIcon 中的特定颜色

> ID：532586
> 
> 赞同：2
> 
> 时间：2009-02-10T14:37:57.030
> 
> 标签：java

我正在使用 24x24 像素图标。我希望能够将此图标中的特定颜色更改为不同的颜色。例如，将白色区域变为红色。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T15:00:38.240

我不知道这样做的 API 方法。并且默认情况下`Images`是不可写的。但是，如果你有一个[`BufferedImage`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html)，你可以这样做：

```
public void changeColor(BufferedImage img, Color old, Color new) {
    final int oldRGB = old.getRGB();
    final int newRGB = new.getRGB();
    for (int x = 0; x < img.getWidth(); x++) {
        for (int y = 0; y < img.getHeight(); y++) {
            if (img.getRGB(x, y) == oldRGB)
                img.setRGB(x, y, newRGB);
        }
    }
} 
```

这不是最有效的方法（可以一次将 RGB 数据而不是一个像素提取到一个数组中），但对于 24x24 图像，这应该不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T14:56:38.890

您可以使用[BufferedImage](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html)来做到这一点。查看 Java [Image I/O 文档](http://java.sun.com/javase/6/docs/technotes/guides/imageio/index.html)。

# c# - 是否可以显示所有方法及其访问修饰符？

> ID：532588
> 
> 赞同：3
> 
> 时间：2009-02-10T14:38:10.773
> 
> 标签：c#, methods

我正在对一些大型类库进行代码审查，我想知道是否有人知道一种简单的方法来生成所有方法（可能还有属性/变量）及其访问修饰符的列表。例如，我想要这样的东西：

```
private MyClass.Method1()
internal MyClass.Method2()
public MyOtherClass.Method1() 
```

有点像 C++ 头文件，但用于 C#。这会将所有内容放在一个地方以便快速查看，然后我们可以调查某些方法是否真的需要标记为内部/公共。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T14:42:25.087

是的，使用反射：

```
foreach (Type type in assembly.GetTypes())
{
    foreach (MethodInfo method in type.GetMethods(BindingFlags.Public |
        BindingFlags.NonPublic | BindingFlags.Static | BindingFlags.Instance))
    {
        Console.WriteLine("{0} {1}{2}.{3}", GetFriendlyAccess(method),
            method.IsStatic ? "static " : "", type.Name, method.Name);
    }
} 
```

我将把 GetFriendlyAccessName 作为练习留给读者 - 使用 IsFamily、IsPrivate、IsPublic、IsProtected 等 - 或 Attributes 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T14:40:11.970

好吧，您当然可以为此使用反射来枚举方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T14:40:48.163

[Exuberant ctags](http://ctags.sourceforge.net/)具有 C# 模式，易于使用。也就是说，我只想反映大会。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T14:40:59.520

您可以使用一些工具，例如[Reflector](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T14:40:26.680

.Net Reflector 或 ildasm。

如果您要求它导出，ildasm 将为您生成一个不错的文件，但只要求您需要的特定成员。

NDepends 也会这样做（并且具有更大的灵活性），但对于商业用途，需要花钱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T14:44:17.983

如果您使用的是 Visual Studio，那么您始终可以获得该视图。

只需使用“转到定义”选项，Visual Studio 就会在新选项卡中打开类型元数据（如果您使用的是 DLL，而不是直接使用源代码）。

# powershell - powershell 2.0 将是“防火墙友好”是什么意思？

> ID：532613
> 
> 赞同：12
> 
> 时间：2009-02-10T14:43:33.757
> 
> 标签：powershell, powershell-remoting

我有兴趣在防火墙后面的计算机上执行 powershell 脚本。我需要打开哪些端口？是否需要任何特殊配置，或者我只能连接到全新安装的 Windows Server 2008 r2 并开始执行我的脚本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T15:06:00.520

PowerShell 2 将通过 WinRM 进行远程处理（WinRM 已经可用，因为 Windows 2003 R2、IIRC）。WinRM 只是 HTTP[S] 上的 SOAP。因此端口默认为 80，SSL 默认为 443。

[这是一个关于PS2 远程处理](http://www.microsoft.com/technet/scriptcenter/topics/winpsh/remote.mspx)的快速概述，以及一个关于[WinRM](http://msdn.microsoft.com/en-us/library/aa384372(VS.85).aspx) for 2003 的概述。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-22T00:54:21.097

MichaelGG 做对了——您需要做的就是使用 PowerShell V2 中提供的本机远程处理。它使您可以疯狂地控制所有使用 WS-MAN 协议（这是由我们的 WINRM 服务实现的标准管理协议）的网络。

V2 远程处理的工作方式是您可以在远程计算机上调用命令（单个命令、管道、命令集或整个脚本）并指定您希望该命令如何运行。

例如 `Invoke-Command {get-process} -Computername (cat servers.txt)`

```
Invoke-Command
    (1)-ScriptBlock | -Command <ScriptBlock>
    (0)[-ComputerName | -Cn <String[]>]
       [-ApplicationName <String>]
       [-ArgumentList | -Args <Object[]>]
       [-AsJob ]
       [-Authentication <Basic | Credssp | Default | Digest | Kerberos | Negotiate | NegotiateWithImplicitCredential>]
       [-CertificateThumbprint <String>]
       [-ConfigurationName <String>]
       [-Credential <PSCredential>]
       [-HideComputerName | -HCN ]
       [-InputObject <PSObject> (ByValue)]
       [-JobName <String>]
       [-Port <1->]
       [-SessionOption <System.Management.Automation.Remoting.PSSessionOption>]
       [-ThrottleLimit <Int>]
       [-UseSSL ] 
```

您还可以提供 SessionOptions

```
New-WSManSessionOption
       [-NoEncryption ]
       [-OperationTimeout <0->]
       [-ProxyAccessType <ProxyAutoDetect | ProxyIEConfig | ProxyNoProxyServer | ProxyWinHttpConfig>]
       [-ProxyAuthentication <Basic | Digest | Negotiate>]
       [-ProxyCredential <PSCredential>]
       [-SkipCACheck ]
       [-SkipCNCheck ]
       [-SkipRevocationCheck ]
       [-SPNPort <0->]
       [-UseUTF16 ]

New-WSManSessionOption
           [-NoEncryption ]
           [-OperationTimeout <0->]
           [-ProxyAccessType <ProxyAutoDetect | ProxyIEConfig | ProxyNoProxyServer | ProxyWinHttpConfig>]
           [-ProxyAuthentication <Basic | Digest | Negotiate>]
           [-ProxyCredential <PSCredential>]
           [-SkipCACheck ]
           [-SkipCNCheck ]
           [-SkipRevocationCheck ]
           [-SPNPort <0->]
           [-UseUTF16 ] 
```

如您所见，您可以指定如何遍历代理，您可以向代理提供一组凭据，向端点提供一组不同的凭据。综上所述，简单的情况是您不指定任何内容，我们将使用端口 80。

实验！享受！从事！

Jeffrey Snover [MSFT]
Windows 管理合作伙伴架构师

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-11T19:22:02.143

用于 WS-Management 和 PowerShell 远程处理的默认端口已分别更改为 5985 和 5986，用于通过 HTTP 和 HTTPS 进行连接。

Windows 管理基础架构博客的更多详细信息 - [http://blogs.msdn.com/wmi/archive/2009/07/22/new-default-ports-for-ws-management-and-powershell-remoting.aspx](http://blogs.msdn.com/wmi/archive/2009/07/22/new-default-ports-for-ws-management-and-powershell-remoting.aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-10T14:46:00.413

您需要打开哪些端口完全取决于您计划在脚本中执行的操作。

# flash - rtmp 和 adobe 媒体播放器

> ID：532622
> 
> 赞同：1
> 
> 时间：2009-02-10T14:46:46.230
> 
> 标签：flash, actionscript-3, streaming, rtmp

我们已经获得了用于原型设计的 Flash Media Server 的托管，并且我们正在尝试使用 Adob​​e Media Player 流式传输视频。虽然我们知道这是可能的，但我们很好奇需要哪些步骤来做到这一点：

我们是否需要创建一个服务器端应用程序才能进行流式传输，或者我们可以只托管视频吗？

我们已经在 AMP 中拥有预先存在的提要，这些提要目前由普通播客组成。我们知道我们将需要修改提要或创建包含 rtmp 流的 URL 的新提要。这个问题不是关于这些提要的创建，而是更具体地说是关于如何在 AMP 中设置 rtmp 流。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T15:49:19.417

在玩了更多服务器之后，并按照[本教程](http://www.adobe.com/devnet/flashmediaserver/articles/beginner_vod_fm3.html)进行操作后，我似乎已经弄清楚了。

对于其他有相同问题的人：您只需要创建一个 VOD 应用程序（我们的服务器默认没有安装一个，但有几个通过点击安装的开箱即用插件） ，将视频放在实例文件夹中（同样，在我们的托管服务器上不同），并将 URL 放在提要中。

# msbuild - MSBuild 无法构建 C++/CLI 友元程序集

> ID：532623
> 
> 赞同：0
> 
> 时间：2009-02-10T14:46:54.543
> 
> 标签：msbuild, c++-cli, friend

我有 Visual Studio 2008 SP1，两个 C++/CLI 项目，比如说 proj1 和 proj2。proj2 依赖于 proj1，但方式很奇怪（见下文）。在项目依赖项中，我指定 proj2 依赖于 proj1。proj2 参考也包括 proj1。然后我希望 proj1 成为 proj2 的朋友，因此，正如[“Friend Assemblies”](http://msdn.microsoft.com/en-us/library/ms177208(VS.80).aspx)上的 MSDN 页面所说，我在 proj2 的某处写了这段代码：

```
#使用“proj1.dll”作为_friend。
```

编译说 proj1.dll 已经被引用，我应该从 proj2 项目设置中删除项目引用（从而删除 /FU 标志）。

这里出现了错误（？）：如果我从 proj2 中删除 proj1 引用，但仍然在解决方案 Project Dependencies 中指定 proj2 依赖于 proj1，那么在 VS2008 中一切都可以编译。但是 MSBUILD 解析项目引用，为 proj2 创建新的临时项目，添加 /FU:proj1.dll 和构建失败！

**问题 1：有没有办法禁用此 MSBuild 行为？**

然后，如果我删除项目依赖项中的依赖项，MSBuild 构建良好，但 Visual Studio 尝试并行编译 proj1 和 proj2，但失败，因为 proj2 小得多并且首先编译...在项目和解决方案中设置最大并行构建选项/ Build and Run 有帮助，但我必须在每台开发人员机器上都这样做，我无法在解决方案中保存此设置，这会使构建速度变慢等等......

**问题2：有没有办法让“项目依赖”成为条件选项？我希望它适用于 VS2008 和 MSBuild ......**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-25T17:13:15.847

正如OP已经发现的那样，这实际上是一个错误。OP 提交了一个[错误](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=413878)并得到了微软的承认。它似乎会影响 VS2005、VS2008 和 VS2010（针对 VS2008）。

我使用的解决方法是一个虚拟中间项目来“缓冲”两个依赖项目之间的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T08:41:53.107

如果 ProjA 依赖于 ProjB 而 ProjB 依赖于 ProjA，那么我很惊讶你可以构建它！这种循环构建依赖通常会杀死干净的构建。当您构建 ProjB 和 vise-vera 时，您经常在旧 ProjA 仍然存在的开发机器上侥幸逃脱。但是在干净的机器（构建服务器）上，这种依赖经常会破坏事情。

根据依赖项是什么，将公共依赖项移动到新的程序集 ProjC 可能是最简单的，它没有自己的依赖项，但 ProjA 和 ProjB 都依赖它。这意味着您可以随后以任何顺序构建 ProjC，然后是 ProjA 和 ProjB。当您只依赖 ProjC 的接口而不是具体的类时，这种重构通常是最简单的。

不确定这是否完全回答了您的问题，但它可能会为您提供解决问题的替代方法。

科林

# flash - Flash 风格运行时的可能继任者？

> ID：532625
> 
> 赞同：1
> 
> 时间：2009-02-10T14:47:21.690
> 
> 标签：flash

我倾向于认为 Flash 和其他专有的、基于浏览器的运行时不是一个好主意。

但是，人们似乎喜欢它们，因为它们很漂亮，只要他们愿意购买工具等，就可以为开发人员提供很大的权力。

有没有人看到这样的商业模式不存在的未来？我认为使用 javascript、css 和 html 的基于标准的图形工具集有很好的机会与基于 Flash 的工具竞争（对我来说，最好是击败）基于 Flash 的工具。

Flash 提供了什么是 Web 的基本构建块无法实现的？Flash 的可能继任者需要解决什么问题才能真正成为“Flash 杀手”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T14:53:10.973

Flash 通过试图吸引开发人员而不是设计师来非常有效地自我毁灭。

编辑：Flash 流行的主要原因是它接近“自由形式”的设计师心态，艺术是王道，而代码只是一个必须处理的烦恼。他们现在正在远离设计师，试图吸引更多的开发人员，但开发人员总是会在一些更开放的环境中感觉更舒服，比如 Javascript、Java、Dotnet，......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T14:54:44.290

Mozilla 在 HTML 5 中非常努力地尝试这方面的内容，例如视频、音频和拖放。但是，它们还不是很成功，因为其他一些浏览器，包括 Internet Explorer 和旧版本的 Firefox，没有实现这些技术。

因此，我认为类似 Flash 的技术（包括 Silverlight）不会很快消失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T09:46:44.040

你可以看看[Xinf](http://xinf.org/)。从网站：

> Xinf（Xinf Is Not Flash）致力于为 Haxe 中的图形编程提供统一的面向 SVG 的 API。使用 Xinf，您的应用程序可以在 Adob​​e 的 Flash Player（版本 9 以上）、我们自己的“Xinfinity”运行时以及（有限制）符合标准的 Web 浏览器（如 Mozilla Firefox）上运行 - 来自相同的源代码。
> 
> 它的跨运行时魔法大部分归功于出色的 Haxe 语言和编译器以及 neko 虚拟机。Xinf 添加了用于渲染和用户界面事件的抽象实现，以及跨平台（Linux/Windows/OSX）、基于 OpenGL 的运行时环境（称为 Xinfinity）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T14:53:11.813

无论您使用的是 Linux、Windows 还是 Mac，Flash 都是一个单一的产品。使用 javascript/css 我们已经遇到了浏览器兼容性问题。虽然我们被迫支持较旧的 IE 版本，但不幸的是，对于很多用途来说，javascript 的速度还不够快。

我不认为我们需要一个“闪光杀手”。最新浏览器支持的视频元素可能有助于消除一些 flash 的优势（无论如何对于视频），一旦几年过去了，并且对视频的支持更加广泛。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T14:53:22.547

这与标准工具无法完成的事情无关。任何事情都可以用任何语言完成。这完全不是重点。关键是，使用 Flex，您可以在几天的工作中运行一个富 Web 应用程序，该应用程序在所有浏览器上看起来都很棒并且一致。如果只有它们具有适当的库和工具，您理论上可以使用其他技术实现相同的事实并不会改变底线。现在，flash/flex/silverlight/wpf 都为您提供了大量开箱即用的功能，所以这就是为什么使用它们是一个*好*主意（假设您正在寻找完成任务）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T11:26:11.743

我第二个 luiscubal 并想补充一点，Flash 和 Silverlight 为开发人员提供了非常好的服务。我们不必关心插件分发。也没有关于标准的战争。

Flash 正走在标准构建模块无法完成的一些严肃道路上。您可以使用着色器和 graficacceleration。3D 越来越好，很快就会推翻 Shockwave。更好地控制文本，css3 不会那么快出现......无需 os-native 播放器的流式传输。

它可以完全控制您的网络/桌面项目，而无需解决操作系统或浏览器问题。

顺便说一句：Flex SDK 现在是开源的；）您根本不需要花任何钱来开发 Flash。还有Haxe。用于 as2、as3 和 JS 的开源编译器。

Flashdevelop 也是一个对 Flash 进行编码的开源程序。

Adobe 正在处理设计器问题。他们将推出一个新程序，我认为代号为 Termo。它将成为 Flex Builder 和任何通用图形程序之间的中间人。

继任者只需要一件事：时髦……而且可能比 Adob​​e 拥有更多的广告资金。

Genericrich：曾经真正看过 svg ;)

# html - 居中文本的问题

> ID：532626
> 
> 赞同：0
> 
> 时间：2009-02-10T14:47:56.197
> 
> 标签：html, css

我有一个导航层，我似乎无法获得指向中心的链接。

这是我正在使用的样式表

```
.Layer1 {
    position:absolute;
    width: 10%;
    height: 95%;
    list-style-position: outside;
    list-style-type: disc;
    background-color: #D2FFFF;
}
.Layer1 a {
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-weight: 600;
    color: #0066FF;
    text-decoration: none;
    text-align: center;
} 
```

使用标准的 a href 链接没有区别，也没有将样式指定为 href。我想知道我错过了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T14:49:40.623

您是否尝试过添加：

```
text-align: center; 
```

到 .Layer1 {}？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T15:08:40.733

我通过您的样式属性假设您将它们应用于`<ul>`元素。它们具有相当古怪的默认填充/边距属性（始终使用 a 的好理由[`reset`](http://developer.yahoo.com/yui/reset/)）。如果您`text-align: center;`按照 Stuart 的建议进行设置，然后设置`padding: 0;`它将按照您的预期居中。刚刚在IE和FF上测试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T15:09:07.253

第 1 层是 a`div`还是 a `ul`？如果它是 a `div`，`text-align: center`应该可以工作，只要你没有设置`display: block`你的 a 标签。

要使块元素居中，您需要使用`margin: auto`. 要使内联元素居中，它是`text-align: center`. 如果这不起作用，则与您的标记有关，或者与样式被覆盖的其他方式有关。我强烈建议使用 firebug 来查看发生了什么，我曾经一直使用 html 来获得这些“wtf is going on”的时刻，但是自从使用 firebug 后，它们很少持续超过几分钟。

另一件事是`text-indent`缩进段落的第一行。用于`padding-left`在块元素内添加空格，或`margin-left`将其添加到外部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T16:50:21.363

链接是内联元素，因此在它们上设置 text-align center 不会有任何效果。尝试使链接成为具有指定宽度的块，然后应用文本对齐中心。

# .net - console.writeline >> redirectedoutput.txt 乱码

> ID：532628
> 
> 赞同：0
> 
> 时间：2009-02-10T14:48:20.673
> 
> 标签：.net, console-application

我有一个从批处理文件在 Windows XP sp3 上运行的 VB.NET 3.5 sp1 控制台应用程序：

```
"D:\Program Files\PartsDepotJob\PartsDepotJob.exe" >> "D:\Program Files\PartsDepotJob\partdepot.log.txt" 
```

输出如下所示：

> 2009 年 2 月 10 日上午 9:03:19
> 处理 PO#：002 中的 2100
> 创建 OE# 135
> 处理 PO#：003 中的 2100
> 创建 OE# 136
> DONE
> 2009 年 2 月 10 日上午 9:03:30
> 处理 PO#：2100在 002
> 创建 OE# 137
> 处理 PO#: 2100 在 003
> 创建 OE# 138
> 完成

但是，当我在他们的 Windows 2003 sp2（也带有 .NET 3.5 sp1）框的客户端上运行相同的东西时，输出会出现如下乱码：

> 2/9/2009 4:03:37 PM
> DONE
> 2/9/2009 4:04:06 PM
> DONE
> 2/9/2009 4:11:01 PM
> DONE
> 2/9/2009 4:30:23 PM
> 处理 PO# : 1649400 在 702
> 创建 OE#
> 1/1/1900 4:30:26 PMCreated OE# 49
> 1/1/1900 4:30:26 PMProcessing PO#: 1649500 in 702
> Created OE# 49
> 1/1/1900 4:30 :28 PMCreated OE# 50
> 1/1/1900 4:30:28 PMDONE

即，有时 CrLf 被删除，输出有时似乎以 1/1/1900 {time} 为前缀。

关于可能导致这种情况的任何想法？

相关代码如下：

```
Imports Wisys.AllSystem
Imports Wisys.Oe
Imports Wisys.Po
Imports System.Configuration
Imports System.Data
Imports System.Linq

Public Class clsPartsDepot
    Private wsConn As Wisys.AllSystem.ConnectionInfo = Nothing
    Private wsPartDepotSalesOrd As Wisys.Oe.OrderEntryTables = Nothing

    Public Function ProcessPartDepotOrders() As Boolean
        Dim errMsg As String = ""
        Try
            Console.WriteLine(Now().ToString)
            ''//sendBadPOLineEmailtoDepot("test")
            Dim dsPO As New Data.DataSet
            Dim dbName As String = ""
            Dim dbServer As String
            Dim partDepotDbName As String = ConfigurationManager.AppSettings("partDepotDbName")
            Dim partDepotDbServer As String = ConfigurationManager.AppSettings("partdepotDBserver")
            Dim KeyName As String = ""
            Dim billToCompany As String ''//, billtoCompAddr1 As String
            Dim dtBillTo As DataTable
            Dim i As Integer = 1

            Dim appkeyQry = From key In ConfigurationManager.AppSettings Where key Like "CompanyDbName*" Select key

            ''//for each company database look for PO's
            For Each KeyName In appkeyQry
                dbName = ConfigurationManager.AppSettings(KeyName)
                dbServer = ConfigurationManager.AppSettings("CompanyDbServer" & i)
                billToCompany = ConfigurationManager.AppSettings(dbName)

                dtBillTo = GetCustomer(billToCompany, partDepotDbName, partDepotDbServer)
                If dtBillTo.Rows.Count = 0 Then
                    Throw New Exception("Customer record for company database '" & dbName & "' not found in the parts depot!")
                End If
                ''//billtoCompAddr1 = dtBillTo.Rows(0)("cmp_fadd1")

                ''//get all the unprocessed, printed PO's from the current company.
                dsPO = GetPoDataset(dbName, dbServer)

                If IsNothing(dsPO) Then
                    Console.WriteLine("Error processing part depot: " & errMsg)
                    Exit Function
                End If

                Dim itemNum As String, qtyOrd As Double, requestDate As Date, promiseDate As Date, lineNum As String, itemPrice As Double
                Dim errNum As Integer = 0
                Dim poNum As String = ""
                ''//for each unprocessed, printed PO in the current company
                For Each dr As DataRow In dsPO.Tables(0).Rows

                    If poNum <> dr("ord_no") Then
                        Console.WriteLine("Processing PO#: " & dr("ord_no") & " in " & dbName)

                        If Not poNum = "" Then 'for first run don't close it, not open
                            wsConn.CloseWisysConnection(TrxEnums.TransactionAction.Commit, errMsg)
                            wsConn.Dispose()
                            wsConn = Nothing
                        End If
                        wsConn = New Wisys.AllSystem.ConnectionInfo
                        OpenWiSysConn(partDepotDbName, partDepotDbServer, True)

                        If Not poNum = "" Then 'for first run don't Dispose it; already equal to nothing
                            If Not IsNothing(wsPartDepotSalesOrd) Then wsPartDepotSalesOrd.Dispose()
                            wsPartDepotSalesOrd = Nothing
                        End If
                        wsPartDepotSalesOrd = New Wisys.Oe.OrderEntryTables
                        wsPartDepotSalesOrd.Connection(wsConn, errMsg)

                        With wsPartDepotSalesOrd.OrderHeader
                            .UserName = My.User.Name
                            .Ship_to_name = If(IsDBNull(dr("cmp_name")), "", dr("cmp_name"))
                            .Ship_to_addr_1 = If(IsDBNull(dr("cmp_fadd1")), "", dr("cmp_fadd1"))
                            .Ship_to_addr_2 = If(IsDBNull(dr("cmp_fadd2")), "", dr("cmp_fadd2"))
                            .Ship_to_addr_3 = If(IsDBNull(dr("cmp_fadd3")), "", dr("cmp_fadd3"))
                            .Ship_to_addr_4 = If(IsDBNull(dr("cmp_fcity")), "", dr("cmp_fcity")) & " , " & _
                            If(IsDBNull(dr("StateCode")), "", dr("StateCode"))
                            .Ship_to_country = If(IsDBNull(dr("cmp_fcounty")), "", dr("cmp_fcounty"))
                            .Oe_po_no = dr("ord_no")
                        End With

                        ''//wsPartDepotSalesOrd.OrderHeader.Status 'readonly
                        errNum = wsPartDepotSalesOrd.OrderHeader.Insert(TrxEnums.OeOrderTypeEnum.Order, "", billToCompany, "", dr("ord_dt"), errMsg)
                        If errNum <> 0 Then
                            Console.WriteLine("Error Creating OE header:" & errMsg)
                        Else
                            Console.WriteLine("Created OE#" & wsPartDepotSalesOrd.OrderHeader.Ord_no)
                        End If
                    End If
                    poNum = dr("ord_no")

                    ''//if error then skip to the next loop iteration until the next PO # and it gets inserted ok
                    If errNum <> 0 Then
                        Continue For
                    End If

                    lineNum = If(IsDBNull(dr("line_no")), Now(), dr("line_no"))
                    itemNum = dr("item_no").ToString
                    qtyOrd = If(IsDBNull(dr("qty_ordered")), 0, CDbl(dr("qty_ordered")))
                    requestDate = If(IsDBNull(dr("request_dt")), Now(), dr("request_dt"))
                    promiseDate = If(IsDBNull(dr("promise_dt")), Now(), dr("promise_dt"))
                    itemPrice = If(IsDBNull(dr("price")), 0, dr("price"))

                    If itemNum.Length > 0 And qtyOrd <> 0 Then
                        CreateLine(wsPartDepotSalesOrd, itemNum, qtyOrd, 0, requestDate, requestDate, promiseDate, itemPrice, poNum)
                        ''//mark as processed, even if above fails. any lines that fail will be added to SO in parts depot by hand.
                        markPoLineAsProcessed(dbName, dbServer, poNum, lineNum)
                    End If

                Next
                poNum = ""
                i = +1
                If Not IsNothing(wsConn) Then
                    wsConn.CloseWisysConnection(TrxEnums.TransactionAction.Commit, errMsg)
                    wsConn.Dispose()
                End If
                If Not IsNothing(wsPartDepotSalesOrd) Then wsPartDepotSalesOrd.Dispose()
                wsConn = Nothing
                wsPartDepotSalesOrd = Nothing
            Next
            Console.WriteLine("DONE")

        Catch ex As Exception
            Console.WriteLine("Exception processing part depot: " & ex.Message)

        Finally
            Try
                ''//cleanup 
                If Not IsNothing(wsPartDepotSalesOrd) Then
                    wsPartDepotSalesOrd.Dispose()
                    wsPartDepotSalesOrd = Nothing
                End If

                If Not IsNothing(wsConn) Then
                    wsConn.CloseWisysConnection(TrxEnums.TransactionAction.Commit, errMsg)
                    wsConn.Dispose()
                    wsConn = Nothing
                End If
            Catch ex As Exception
                Console.WriteLine("Exception exiting part depot: " & ex.Message)
            End Try
        End Try
    End Function

    Private Function GetCustomer(ByVal CustomerNum As String, ByVal db As String, ByVal server As String) As DataTable
        Dim cn As New SqlClient.SqlConnection
        Dim cmd As New SqlClient.SqlCommand
        Dim da As New SqlClient.SqlDataAdapter
        Dim ds As New DataSet
        Try
            cn.ConnectionString = "Persist Security Info=False;Integrated Security=true;Initial Catalog=" & db & ";server=" & server
            cn.Open()
            cmd = cn.CreateCommand
            cmd.Parameters.Add(New SqlClient.SqlParameter("@cusnum", CustomerNum))
            cmd.CommandText = "select cmp_name,cmp_fadd1,coalesce(debnr,crdnr) as CusNum from dbo.cicmpy where ltrim(debnr) = @cusnum or ltrim(crdnr) = @cusnum"
            cmd.CommandType = CommandType.Text
            da.SelectCommand = cmd
            da.Fill(ds)
            If ds.Tables.Count > 0 Then
                Return ds.Tables(0)
            End If
            Return Nothing
        Finally
            If Not IsNothing(cmd) Then cmd.Dispose()
            If Not IsNothing(cn) Then cn.Dispose()
            If Not IsNothing(da) Then da.Dispose()
        End Try
    End Function

    Private Function GetPoDataset(ByVal db As String, ByVal server As String) As DataSet
        Dim cn As New SqlClient.SqlConnection
        Dim ds As New DataSet
        Dim dsa As New SqlClient.SqlDataAdapter
        Dim cmd As New SqlClient.SqlCommand
        Try
            Static Dim SQL As String = ConfigurationManager.AppSettings("getPoforPartsDepotSQL")
            cn.ConnectionString = "Persist Security Info=False;Integrated Security=true;Initial Catalog=" & db & ";server=" & server
            cn.Open()
            cmd.Connection = cn
            cmd.CommandType = CommandType.Text
            cmd.CommandText = SQL
            dsa.SelectCommand = cmd
            dsa.Fill(ds)
            Return ds
        Catch
            Throw
        Finally
            If Not IsNothing(ds) Then ds.Dispose()
            If Not IsNothing(cmd) Then cmd.Dispose()
            If Not IsNothing(cn) Then cn.Close()
            If Not IsNothing(cn) Then cn.Dispose()
        End Try
    End Function

    Private Function OpenWiSysConn(ByVal dbName As String, ByVal dbServer As String, ByVal useTran As Boolean) As Boolean
        Try
            Dim errMsg As String = ""

            wsConn.Parameters(dbServer, dbName, "MacMSS")

            If wsConn.OpenWisysConnection(useTran, errMsg) <> 0 Then
                Console.WriteLine("Error processing part depot: " & errMsg)
                Return False
            End If

            Return True
        Catch
            Throw
        End Try
    End Function

    Private Function CreateLine(ByVal p_oOEObj As Wisys.Oe.OrderEntryTables, ByVal partNum As String, ByVal qtyOrdered As Double, ByVal qtyToShip As Double, ByVal RequestDate As Date, ByVal RequestShipDate As Date, ByVal PromiseDate As Date, ByVal price As Double, ByVal PONum As String) As Boolean
        Dim OeLine As OEORDLIN
        Dim p_sRtnErrMsg As String = ""
        Dim p_lRtnVal As Long
        Dim p_lRtnLineNumber As Long

        With p_oOEObj
            ''//p_lRtnVal = .OrderHeader.Read(TrxEnums.OeOrderTypeEnum.Order, p_sRtnOrder, True, True, True, p_bRtnRecFound, p_sRtnErrMsg)

            OeLine = .OrderHeader.OrderLines.Add(TrxEnums.OrderLineType.InventoryItem, partNum.ToUpper, "", qtyOrdered, qtyToShip, price, price, RequestDate, PromiseDate, RequestShipDate, True, p_sRtnErrMsg)

            p_lRtnVal = OeLine.Insert(p_lRtnLineNumber, p_sRtnErrMsg)

            If p_lRtnVal = 0 Then
                Return True
            End If

            Console.WriteLine("Error creating sales order line# " & p_lRtnLineNumber & ": " & p_sRtnErrMsg)
            sendBadPOLineEmailtoDepot("Error creating sales order line for PO# " & PONum & " becuase of an error: " & p_sRtnErrMsg)
            Return False

        End With
    End Function

    Private Function markPoLineAsProcessed(ByVal DB As String, ByVal server As String, ByVal poOrdNum As String, ByVal poLineNum As String) As Boolean
        Dim cn As New SqlClient.SqlConnection
        Dim cmd As New SqlClient.SqlCommand
        Try
            Static Dim SQL As String = ConfigurationManager.AppSettings("markPoLineAsSendToDepotSQL")

            cn.ConnectionString = "Persist Security Info=False;Integrated Security=true;Initial Catalog=" & DB & ";server=" & server & ";"
            cn.Open()
            cmd.Connection = cn
            cmd.Parameters.Add(New SqlClient.SqlParameter("@poOrdNum", poOrdNum))
            cmd.Parameters.Add(New SqlClient.SqlParameter("@poLineNum", poLineNum))
            cmd.CommandType = CommandType.Text
            cmd.CommandText = SQL
            cmd.ExecuteNonQuery()
            Return True
        Catch
            Throw
        Finally
            If Not IsNothing(cmd) Then cmd.Dispose()
            If Not IsNothing(cn) Then cn.Dispose()
        End Try
    End Function

    Private Function sendBadPOLineEmailtoDepot(ByVal msgText As String) As Boolean
        Try
            If ConfigurationManager.AppSettings("EnableSentBadPOMail").ToLower <> "true" Then Return True
            Dim sMailServer As String = ConfigurationManager.AppSettings("MailServer")
            Dim mySmtpClient As New System.Net.Mail.SmtpClient(sMailServer)
            mySmtpClient.UseDefaultCredentials = True
            mySmtpClient.DeliveryMethod = Net.Mail.SmtpDeliveryMethod.Network
            Dim sTo As String = ConfigurationManager.AppSettings("BadPOMailTo")
            Dim sFrom As String = ConfigurationManager.AppSettings("BadPOMailFrom")

            mySmtpClient.Send(sFrom, sTo, msgText, msgText)

            Return True
        Catch ex As Exception
            Console.WriteLine("Exception sending sending bad PO line e-mail to depot: " & ex.Message)
            Return False
        End Try
    End Function

End Class 
```

更新：我不希望输出被覆盖，我希望它被附加。因此 >> 而不是 >

更新：控制台窗口中的前景相同，即。如果没有重定向到文件。这是输出到该文件的应用程序，一次只运行一个。客户端数据库中似乎没有任何错误数据。

我相信站点之间的代码是相同的。另外，我确保没有额外的 console.write/writeline 造成问题。

更新：我错过了一些可能相关的代码，我已经更新了上面的代码片段。

更新：我一直在我的客户“手动”运行这个过程，所以我确定只有一个在运行。ProcessPartDepotOrders() 只是从 sub main() 调用一次，所以我看不到有任何线程问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T16:36:30.333

你确定这是在一个线程上运行吗？它几乎看起来像几个迭代同时运行并写入同一个管道（stdout/console.wl）。尝试将日志写入文件，在 appkeyqry 中为每次迭代使用不同的日志（如“log-{date}.txt”）。也许您的服务器是多核的并且您有竞争条件？

编辑：尝试在每个 Console.Write (Console.Out.Flush) 之后刷新标准输出这可能是您的输出无序的原因。（我写了很多 perl 脚本，并且在快速服务器上，除非您将 stdout 设置为每次写入后始终刷新，否则输出会像您的一样混在一起）。

HTH，真的 ;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T15:50:05.580

使用较新的`If`而不是`IIf`. 但是，您的代码中还有一些其他结构仍然是 vb6 的回归。最大的是新的 AndAlso 运算符允许使用真正的控制/中断样式循环结构。在 .Net 中处理对象后也无需设置为 Nothing，您可以使用`Using`关键字更好地处理处理和 finally 块，.Net 样式指南特别建议不要使用匈牙利符号疣，如 's' 或 ' cls'。

我冒昧地重组了您的代码以利用这一点，所以我们将从这里开始。在我更进一步之前，我想确保这个重构没有引入新的错误：

### 更新：

更新了我的帖子以显示所有重构的代码。请注意一些简单的名称更改，以及分解连接字符串和更改 OpenWiSysConn() 函数的工作方式。

```
Public Class PartsDepot
    Public Function ProcessPartDepotOrders() As Boolean
        Dim errMsg As String = ""
        Try
            Console.WriteLine(Now)
            ''//sendBadPOLineEmailtoDepot("test")
            Dim POData As New DataSet
            Dim dbName As String = ""
            Dim dbServer As String
            Dim partDepotDbName As String = ConfigurationManager.AppSettings("partDepotDbName")
            Dim partDepotDbServer As String = ConfigurationManager.AppSettings("partdepotDBserver")
            Dim KeyName As String = ""
            Dim billToCompany As String ''//, billtoCompAddr1 As String
            Dim dtBillTo As DataTable

            Dim i As Integer = 1
            Dim appkeyQry = From key In ConfigurationManager.AppSettings Where key Like "CompanyDbName*" Select key

            ''//for each company database look for PO's
            For Each KeyName In appkeyQry
                dbName = ConfigurationManager.AppSettings(KeyName)
                dbServer = ConfigurationManager.AppSettings("CompanyDbServer" & i)
                billToCompany = ConfigurationManager.AppSettings(dbName)

                dtBillTo = GetCustomer(billToCompany, partDepotDbName, partDepotDbServer)
                If dtBillTo.Rows.Count = 0 Then
                    Throw New Exception("Customer record for company database '" & dbName & "' not found in the parts depot!")
                End If
                ''//billtoCompAddr1 = dtBillTo.Rows(0)("cmp_fadd1")

                ''//get all the unprocessed, printed PO's from the current company.
                POData  = GetPoDataset(dbName, dbServer)

                If POData Is Nothing Then
                    ''// do you really want to quit here, or do you want to move to the next key? 
                    ''// Your error handling is.. inconsistent
                    Console.WriteLine("Error processing part depot: " & errMsg)
                    Exit Function
                End If

                Dim itemNum As String, qtyOrd As Double, requestDate As Date, promiseDate As Date, lineNum As String, itemPrice As Double
                Dim errNum As Integer = 0
                Dim poNum As String

                ''//use control/break style processing loop
                Dim dt As DataTable = POData.Tables(0) ''// save some typing later
                Dim dr As DataRow = dt.Rows(0)
                Dim j As Integer = 0 ''// 'i' is already in use
                While j < dt.Rows.Count   ''//for each unprocessed, printed PO in the current company

                    ''//Do setup work for next Order Number
                    Console.WriteLine("Processing PO#: " & dr("ord_no") & " in " & dbName)

                    Using wsConn As Wisys.Allsystem.ConnectionInfo = OpenWiSysConn(partDepotDbName, partDepotDbServer, True), _
                          wsPartDepotSalesOrd As New Wisys.Oe.OrderEntryTables

                        wsPartDepotSalesOrd.Connection(wsConn, errMsg)

                        With wsPartDepotSalesOrd.OrderHeader
                            .UserName = My.User.Name
                            .Ship_to_name = If(IsDBNull(dr("cmp_name")), "", dr("cmp_name"))
                            .Ship_to_addr_1 = If(IsDBNull(dr("cmp_fadd1")), "", dr("cmp_fadd1"))
                            .Ship_to_addr_2 = If(IsDBNull(dr("cmp_fadd2")), "", dr("cmp_fadd2"))
                            .Ship_to_addr_3 = If(IsDBNull(dr("cmp_fadd3")), "", dr("cmp_fadd3"))
                            .Ship_to_addr_4 = If(IsDBNull(dr("cmp_fcity")), "", dr("cmp_fcity")) & " , " & _
                                If(IsDBNull(dr("StateCode")), "", dr("StateCode"))
                            .Ship_to_country = If(IsDBNull(dr("cmp_fcounty")), "", dr("cmp_fcounty"))
                            .Oe_po_no = dr("ord_no")
                        End With

                        ''//wsPartDepotSalesOrd.OrderHeader.Status 'readonly
                        errNum = wsPartDepotSalesOrd.OrderHeader.Insert(TrxEnums.OeOrderTypeEnum.Order, "", billToCompany, "", dr("ord_dt"), errMsg)
                        If errNum <> 0 Then
                            Console.WriteLine("Error Creating OE header:" & errMsg)
                        Else
                            Console.WriteLine("Created OE#" & wsPartDepotSalesOrd.OrderHeader.Ord_no)
                        End If

                        poNum = dr("ord_no")

                        ''//Process individual lines within one order
                        While j < dt.Rows.Count AndAlso poNum = dr("ord_no")
                            ''//if error then skip to the next loop iteration until the next PO # and it gets inserted ok
                            If errNum <> 0 Then
                                lineNum = If(IsDBNull(dr("line_no")), Now(), dr("line_no"))
                                itemNum = dr("item_no").ToString
                                qtyOrd = If(IsDBNull(dr("qty_ordered")), 0, CDbl(dr("qty_ordered")))
                                requestDate = If(IsDBNull(dr("request_dt")), Now(), dr("request_dt"))
                                promiseDate = If(IsDBNull(dr("promise_dt")), Now(), dr("promise_dt"))
                                itemPrice = If(IsDBNull(dr("price")), 0, dr("price"))

                                If itemNum.Length > 0 AndAlso qtyOrd <> 0 Then
                                    CreateLine(wsPartDepotSalesOrd, itemNum, qtyOrd, 0, requestDate, requestDate, promiseDate, itemPrice)
                                    ''//mark as processed, even if above fails. any lines that fail will be added to SO in parts depot by hand.
                                    markPoLineAsProcessed(dbName, dbServer, poNum, lineNum)
                                End If
                            End If
                            j += 1
                            dr = dt.Rows(j)
                        End While
                        ''//Do cleanup work from this order
                        wsConn.CloseWisysConnection(TrxEnums.TransactionAction.Commit, errMsg)
                    End Using ''// "End Using" will dispose of wsConn and wsPartDepotSalesOrd 
                End While

                poNum = ""
                i += 1
            Next KeyName
            Console.WriteLine("DONE")

        Catch ex As Exception
            Console.WriteLine("Exception processing part depot: " & ex.Message)
        End Try ''// No need for finally section: Using statement ensures the objects were disposed
    End Function

    Private Function GetCustomer(ByVal CustomerNum As String, ByVal db As String, ByVal server As String) As DataTable
        Dim ds As New DataSet
        Using cn As New SqlClient.SqlConnection(GetConnectionString(db, server)), _
                cmd As New SqlCommand("select cmp_name,cmp_fadd1,coalesce(debnr,crdnr) as CusNum from dbo.cicmpy where ltrim(debnr) = @cusnum or ltrim(crdnr) = @cusnum", cn), _
                da As New SqlClient.SqlDataAdapter(cmd)

            cmd.Parameters.Add(New SqlClient.SqlParameter("@cusnum", CustomerNum))
            da.Fill(ds) ''// .Fill() will open the connection if needed
        End Using ''// Using statement guarantees cn, cmd, and da are disposed
        If ds.Tables.Count > 0 Then
            Return ds.Tables(0)
        End If
        Return Nothing
    End Function

    Private Function GetPoDataset(ByVal db As String, ByVal server As String) As DataSet
        Static Dim SQL As String = ConfigurationManager.AppSettings("getPoforPartsDepotSQL")

        Dim ds As New DataSet
        Using cn As New SqlClient.SqlConnection(GetConnectionString(db, server)), _
                cmd As New SqlCommand(SQL, cn), _
                da As New SqlClient.SqlDataAdapter(cmd)

            da.Fill(ds)
        End Using
        Return ds
    End Function

    Private Function GetConnectionString(ByVal db As String, ByVal server As String)
        Return String.Format("Persist Security Info=False;Integrated Security=true;Initial Catalog={0};server={1}", db, server)
    End Function

    Private Function OpenWiSysConn(ByVal dbName As String, ByVal dbServer As String, ByVal useTran As Boolean) As Wisys.Allsystem.ConnectionInfo
        Dim ci As New Wisys.Allsystem.ConnectionInfo()
        ci.Parameters(dbServer, dbName, "MacMSS")

        Dim errMsg As String = String.Empty
        If ci.OpenWisysConnection(useTran, errMsg) <> 0 Then
            Console.WriteLine("Error processing part depot: " & errMsg)
            Return Nothing
        End If
        Return ci
    End Function

    Private Function CreateLine(ByVal OEObj As Wisys.Oe.OrderEntryTables, ByVal partNum As String, ByVal qtyOrdered As Double, ByVal qtyToShip As Double, ByVal RequestDate As Date, ByVal RequestShipDate As Date, ByVal PromiseDate As Date, ByVal price As Double, ByVal PONum As String) As Boolean
        Dim OeLine As OEORDLIN
        Dim RtnErrMsg As String = ""
        Dim RtnVal As Long
        Dim RtnLineNumber As Long

        With OEObj
            ''//p_lRtnVal = .OrderHeader.Read(TrxEnums.OeOrderTypeEnum.Order, RtnOrder, True, True, True, RtnRecFound, RtnErrMsg)
            OeLine = .OrderHeader.OrderLines.Add(TrxEnums.OrderLineType.InventoryItem, partNum.ToUpper, "", qtyOrdered, qtyToShip, price, price, RequestDate, PromiseDate, RequestShipDate, True, RtnErrMsg)
            RtnVal = OeLine.Insert(RtnLineNumber, RtnErrMsg)

            If RtnVal = 0 Then Return True

            Console.WriteLine("Error creating sales order line# " & RtnLineNumber & ": " & RtnErrMsg)
            sendBadPOLineEmailtoDepot("Error creating sales order line for PO# " & PONum & " because of an error: " & RtnErrMsg)
            Return False
        End With
    End Function

    Private Function markPoLineAsProcessed(ByVal DB As String, ByVal server As String, ByVal poOrdNum As String, ByVal poLineNum As String) As Boolean
        Static Dim SQL As String = ConfigurationManager.AppSettings("markPoLineAsSendToDepotSQL")

        Using cn As New SqlClient.SqlConnection(GetConnectionString(DB, server)), _
             cmd As New SqlClient.SqlCommand(SQL, cn)

            cmd.Parameters.Add(New SqlClient.SqlParameter("@poOrdNum", poOrdNum))
            cmd.Parameters.Add(New SqlClient.SqlParameter("@poLineNum", poLineNum))

            cn.Open()
            cmd.ExecuteNonQuery()
        End Using
        Return True
    End Function

    Private Function sendBadPOLineEmailtoDepot(ByVal msgText As String) As Boolean
        Try
            If ConfigurationManager.AppSettings("EnableSentBadPOMail").ToLower <> "true" Then Return True
            Dim MailServer As String = ConfigurationManager.AppSettings("MailServer")
            Dim ToAddress As String = ConfigurationManager.AppSettings("BadPOMailTo")
            Dim FromAddress As String = ConfigurationManager.AppSettings("BadPOMailFrom")

            Dim mySmtpClient As New System.Net.Mail.SmtpClient(MailServer)
            mySmtpClient.UseDefaultCredentials = True
            mySmtpClient.DeliveryMethod = Net.Mail.SmtpDeliveryMethod.Network

            mySmtpClient.Send(FromAddress, ToAddress, msgText, msgText)
            Return True
        Catch ex As Exception
            Console.WriteLine("Exception sending sending bad PO line e-mail to depot: " & ex.Message)
            Return False
        End Try
    End Function
End Class 
```

至于您的具体错误：看起来您有时会通过缓冲区写入，有时会绕过缓冲区。或者，如果文件中的每个“记录”段（记录以日期开头并以“完成”结尾）是您的应用程序的单独实例的结果，您可能还会看到多个实例写入的结果同时到文件。这也是有道理的，因为流量是服务器和测试环境之间的一大潜在差异。

# javascript - 没有过期日期的 Javascript Cookie

> ID：532635
> 
> 赞同：165
> 
> 时间：2009-02-10T14:49:41.900
> 
> 标签：javascript, cookies

我想设置一个永不过期的cookie。这甚至可能吗？

```
 document.cookie = "name=value; expires=date; path=path;domain=domain; secure"; 
```

我不想让日期变得非常大，我只是想知道 cookie 上的 expires 参数是否有一个值告诉它永不过期。

谢谢。

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2009-02-10T14:51:22.943

没有。那是做不到的。这样做的最佳“方法”就是将到期日期设为 2100。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2009-02-10T14:56:02.633

没有你想要的语法。不设置 expires 会导致 cookie 在会话结束时过期。唯一的选择是选择一些任意大的值。请注意，某些浏览器在日期超过 2038 年时会出现问题（当 unix 纪元时间超过 32 位 int 时）。

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2014-11-20T08:21:33.903

您可以作为[Mozilla docs](https://developer.mozilla.org/en-US/docs/Web/API/document.cookie)上的示例进行操作：

```
 document.cookie = "someCookieName=true; expires=Fri, 31 Dec 9999 23:59:59 GMT"; 
```

*附言*

*当然，如果人类在 10000 年的第一分钟仍然使用您的代码，那将是一个问题 :)*

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-01-04T07:55:09.927

所有 cookie 根据 cookie[规范](http://www.faqs.org/rfcs/rfc2965.html)过期，您可以设置的最大值为

```
 2^31 - 1 = 2147483647 = 2038-01-19 04:14:07 
```

所以最大cookie寿命是

```
$.cookie('subscripted_24', true, { expires: 2147483647 }); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-08-14T00:57:19.630

您可能会在一个月或某天的到期日期设置一个 cookie，然后在每次用户再次访问该网站时重新分配 cookie

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-10-13T15:12:13.663

如果您不设置过期日期，cookie 将在用户会话结束时过期。我建议使用在 unix 纪元时间之前的日期将扩展通过 32 位整数。将其放入您将使用的 cookie 中`document.cookie = "randomCookie=true; expires=Tue, 19 Jan 2038 03:14:07 UTC;`，假设这`randomCookie`是您正在设置的 cookie 并且`true`是它各自的值。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-05-04T06:51:04.007

**你就是不能**。没有用于设置永久 cookie 的确切代码，但可以使用旧技巧，例如`current time + 10 years`.

请注意，任何超出的日期`January 2038`都将注定您的 cookie（**32 位 int**）将被立即删除。希望奇迹能在不久的将来得到解决。对于**64 位 int**，几年左右`2110`将是安全的。随着时间的推移，软件和硬件会发生变化，并且可能永远不会适应旧的（我们现在拥有的东西）所以*为*未来*做好*准备。

> 参见[2038 年问题](https://en.wikipedia.org/wiki/Year_2038_problem)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-12-18T21:45:04.477

如果您打算仅从客户端读取数据，则可以使用本地存储。只有当浏览器的缓存被清除时才会被删除。

# internet-explorer - 使用 HTTPS 时如何避免 IE7 中的安全消息？

> ID：532643
> 
> 赞同：2
> 
> 时间：2009-02-10T14:52:55.950
> 
> 标签：internet-explorer, https, warnings

在 IE7 中，我的网站总是导致浏览器提示“安全信息”对话框：

> 此页面包含安全和非安全项目。
> 
> 是否要显示非安全项目？

在非安全页面和安全页面（HTTP 到 HTTPS）之间旅行时，如何避免收到此消息？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T14:55:54.337

如果您在安全页面上，则需要确保所有图像、脚本文件、CSS 文件等都具有 HTTPS 网址。

如果您查看源代码并搜索“http:”，这将很快告诉您哪个（或多个）错误。

例子：

```
<script src="script.js" type="text/javascript"></script> - Correct
<script src="https://ssl.google.com/ga.js" type="text/javascript"></script> - Correct
<script src="http://www.google.com/ga.js" type="text/javascript"></script> - Wrong 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T15:30:04.427

RoBorg已经死了。但是，有时很难找到导致问题的特定页面或项目。通常它是一个损坏的链接，它重定向到“404-page not found”页面。

我喜欢使用的一个技巧是点击页面并在提示上给出肯定的回答，然后查看为端口列中包含 80 而不是 443 的任何行生成的 IIS 日志条目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T14:56:17.673

你应该确保你没有`http://`明确地包含在你的代码中的任何地方。如果您这样做了，那么将显示该消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T15:10:58.683

当从 HTTP 页面移动到 HTTPS 页面时，IE 中还有一个选项可以切换此消息。在 IE7 中，它位于高级选项卡上，倒数第二个复选框。

IE7 中还有一个“显示混合内容”选项，安全选项卡，自定义级别。
对于您访问站点的站点级别，将其设置为启用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-18T13:47:44.497

对于仍在尝试解决奇怪的 IE7 安全警告的任何人：

我发现了一个 IE7 错误地发出警告的情况。如果使用 jQuery.get() 添加具有内联样式和相对 url 的 HTML 内容，则会发生这种情况。[请参阅测试用例](https://venko.net/testing/ie7-test.html)。

可能的修复包括：

*   使用绝对网址
*   将样式移动到 CSS 文件（可能需要在页面加载时加载）
*   使用 jQuery.load() 或其他一些技术也可能有帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-01T09:23:34.747

我们在 HTML5 Boilerplate 中使用这个技巧从 Google CDN 发出 jQuery 的巧妙请求：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.0.min.js"><\/script>')</script> 
```

而不是在 src 中添加任何 http: 或 https:。在任何情况下都可以正常工作

# erlang - Erlang 框架 - 字典数据类型

> ID：532657
> 
> 赞同：1
> 
> 时间：2009-02-10T14:55:31.777
> 
> 标签：erlang, runtime

我遇到了一些关于在 Erlang 中引入“框架”数据类型的文本，基本上是在其他语言中常见的字典（关联数组）类型......将在运行时保留（与记录不同）......任何关于这个倡议在哪里？它会在 R13 中实现吗？R14？会非常有用......我经常使用“dict”，但是更轻量级的内置数据类型会更酷

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T16:08:12.557

据我所知，Erlang/OTP 团队中没有人对此提案发表官方立场。此外，目前还没有关于该主题的[正式 EEP 。](http://www.erlang.org/eeps/eep-0000.html)虽然很多开发者都支持这个提议，但是在语法和一些语义上的妥协仍有待达成。有关更多信息，请参阅[erlang-questions 邮件列表存档](http://www.nabble.com/forum/Search.jtp?query=frames+records&local=y&forum=14096)。

# asp.net - 如何识别 ASP.NET / IIS / SQL Server 网站上的性能和并发问题

> ID：532662
> 
> 赞同：2
> 
> 时间：2009-02-10T14:56:20.170
> 
> 标签：asp.net, windows, sql-server-2005, iis-6

对于我可以用来确认我最近完成的网站是否正常运行的工具和实践的任何建议，我将不胜感激。

虽然我确信代码不会产生错误并且功能正常运行，但我对如何识别 IIS、SQL Server 和 Windows 性能/并发问题知之甚少。例如，如果网站短暂地受到大量流量的冲击，我如何知道该事件曾经发生过，以及我如何知道网站是否应对了它。

该网站是使用在 Windows 2003 R2 标准版、SQL Server 2005 工作组版和 IIS 6 上运行的 ASP.NET 2.0 和 C# 编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T15:00:32.873

您可以使用 WebLoad 之类的负载生成工具来捕获并重放（可能通过脚本编写变化）用户与应用程序 UI 的交互，其中包含大量线程和连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T15:04:16.483

如前所述，负载生成工具非常有用。您可以为数据库端添加的一件事是使用 SQL 跟踪。设置一个包含非常具体步骤的测试计划，并在您逐步完成计划时，跟踪服务器上运行的 SQL。

这样，您可以确定某些操作是否导致不必要的/重复的数据库调用。此外，您可能会发现正在为非常简单的操作运行非常大且性能不佳的查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T15:09:00.483

对于 SQL Server，使用 sys.dm_exec_requests DMV 并检查 CPU 使用率、读取、写入、阻塞等

```
select blocking_session_id,wait_type,* 
from sys.dm_exec_requests 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T15:20:50.780

考虑使用同时引发警报的日志记录机制，因此当数据库调用时间过长（表明服务器负载高）时，记录器会引发警告。查看[log4net](http://logging.apache.org/log4net/index.html)。

关于工具和实践，我推荐 badboy 和[jmeter](http://jakarta.apache.org/jmeter/)作为对站点进行负载测试的工具。Badboy 很简单，可以生成也可以在 jmeter 中使用的 url。后者在负载测试您的网站方面做得非常好。进行长时间运行的测试并使用不同的硬件设置来了解添加更多 Web/应用程序服务器如何影响性能。

另外，请查看[PerfMon](http://msdn.microsoft.com/en-us/library/aa645516(VS.71).aspx)，该工具可让您监控本地或远程 Windows 服务器的争用率、cpu 负载等。

# c++ - 为什么 wgluseFontBitmaps 在某些计算机上会消耗太多内存？

> ID：532663
> 
> 赞同：1
> 
> 时间：2009-02-10T14:56:28.017
> 
> 标签：c++, c, winapi, opengl, graphics

我正在 OpenGL 中创建一个游戏，它在加载时加载整个 Arial Unicode MS 字体。该程序使用平均。我的计算机上有 10 兆内存（操作系统是 WinXP SP2）并且运行没有问题，但是当我将程序移动到我的笔记本电脑（使用 Vista）时，wglUseFontBitmaps 挂起并流畅地分配内存并且永远不会返回。这个问题最近发生了，我不知道为什么，以前从未遇到过这样的问题。为什么 wglUseFontBitmaps 会这样做以及如何解决它？

更新：我尝试了一个旧版本，它运行但消耗了 400 兆内存（所以这不是一个新问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T15:55:40.790

您尝试使用 wglUseFontBitmaps() 生成多少个字形显示列表？你能告诉我们你的调用吗？或许 Vista 正在尝试一次性完成所有 60000 多个字形，而 XP 正在做某种按需构建？

我在使用 FreeType2 和 MS Arial Unicode 时运气不错，不过要掌握 API 的速度确实需要一些时间。 [本教程](https://fsrv.dyndns.org/mirrors/dmedia-tutorials-textrendering1/)可以进行 C++ 化，效果非常好。

# winforms - 自动调整 TabPages 中的控件大小

> ID：532668
> 
> 赞同：3
> 
> 时间：2009-02-10T14:57:04.177
> 
> 标签：winforms, c#-3.0, tabpage

我有一个由几个 TabPages 组成的 TabControl。其中一个 TabPages 包含一个 TreeView，另一个包含一个 DataGridView。我希望这些控件（和标签页）自动调整为 TabControl 中允许的最大大小而不滚动。

DataGridView 包含一个继承自 Control 的 AutoSize 属性，如果启用，该属性会使控件出现乱码。TreeView 没有这个属性。我尝试将 Size 设置为等于 TabControl.Size ，但这不考虑边框大小和 Tabbar 高度。

`treeView.Size = new Size(tabControl.Size.Width - SystemInformation.Border3DSize.Width * 2, tabControl.Size.Height - SystemInformation.Border3DSize.Height * 2);`

我的问题是：如何确定 Tab 按钮的高度，或者如何使用单个控件自动将 TabPages 填充到最大尺寸？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T15:08:24.353

您搜索的属性称为[Dock](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dock.aspx)。

您可能希望将其设置为`DockStyle.Fill`TreeView 和 DataGridView。

另一种方法是将[`Anchor`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.anchor.aspx)属性设置为`AnchorStyle.Top`、`AnchorStyle.Left`和（`AnchorStyle.Right`与`AnchorStyle.Bottom`二进制或管道符号“|”连接）。为此，您需要将孩子的大小设置为[`ClientSize`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.clientsize.aspx)

# html - 如何使 HTML 中的链接在悬停时变为颜色并使用 CSS 删除下划线？

> ID：532670
> 
> 赞同：3
> 
> 时间：2009-02-10T14:57:41.990
> 
> 标签：html, css

如何使 HTML 中的链接在悬停时变为颜色并使用 CSS 删除下划线？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T14:59:47.773

您想查看[:hover 伪](http://www.w3.org/TR/CSS2/selector.html#dynamic-pseudo-classes)选择器、[颜色属性](http://www.w3.org/TR/CSS2/colors.html#colors)和[文本装饰](http://www.w3.org/TR/CSS2/text.html#lining-striking-props)属性。

```
a:hover { color: red; text-decoration: none; } 
```

为了确保您的超链接的样式符合您的要求（并且不与其他样式规则冲突），请使用[`!important`](http://www.w3.org/TR/CSS2/cascade.html#important-rules)：

```
a:hover { color: red !important; text-decoration: none !important; } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T15:07:20.813

此外，除了 stragers 的回答之外，请确保以 LoVe HAte 方式声明伪类。你必须先声明：link，然后：visited，然后：hover，然后：active。否则某些浏览器可能不会应用伪类。

```
一条链接{
 /*这仅适用于命名锚*/
}
一个：访问{
 /*访问链接的可能样式*/
}
一：悬停{
 /*当鼠标悬停在标签上时*/
 文字装饰：无；
 红色;
}
一：活跃{
 /*活动时可能的样式（单击a-tag时）*/
}

```

# visual-studio - 将 Compact Framework 1 应用程序从 VS 2003 升级到 VS 2005 会破坏表单设计器？

> ID：532682
> 
> 赞同：0
> 
> 时间：2009-02-10T15:00:02.173
> 
> 标签：visual-studio, compact-framework

我正在尝试将 C# Compact Framework 1 应用程序从 Visual Studio 2003 移动到 Visual Studio 2005（请不要评论这一切有多过时:-)）。我现在可以在 VS 2005 中编译和运行该应用程序，但是当我打开其中一个表单时，表单设计器不会显示实际的表单布局，而只是显示一些图标行，一个用于表单上的每个控件。我不知道为什么，或者如何恢复标准表单设计器视图。有没有人有这方面的经验和任何提示或提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T15:08:15.350

好吧，从 VS2003 到 VS2005 的过程中发生了一些变化，其中之一是表单设计器将代码添加到您的 Form 类的方式。它创建一个单独的 .designer.cs 类，并创建一个与主窗体类同名的部分类。现在所有设计器生成的代码都在这个后台类中。这样做是为了让表单设计器生成的代码远离您的头发。

现在看来，VS2005 设计器不再识别以前版本生成的文件内设计器代码是合理的。您可以尝试创建一个新的 WinForms 项目，看看它与您当前的项目有何不同，然后对您当前的项目进行适当的修改。

# sql - SQL - 从两个不同的表中选择行

> ID：532694
> 
> 赞同：3
> 
> 时间：2009-02-10T15:03:59.637
> 
> 标签：sql, mysql

有这张桌子

```
Table "Items"

itemID
itemTitle
itemContent 
```

还有这个

```
Table "MyList"

userID
itemID
deleted 
```

如何从表“项目”中选择所有行并显示“已删除”字段，即使 itemID 在“MyList”中不存在，给定用户 ID？

查询结果示例：

```
itemID | itemTitle | deleted | userID
-------------------------------------
1      | Title1    | 1       | 2
2      | Title2    | 0       | 2
3      | Title3    | (null)  | (null)
4      | Title4    | (null)  | (null) 
```

查询是什么，以便我可以得到该结果？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-10T15:07:28.787

```
SELECT I.itemID, I.itemTitle, M.deleted
FROM
    Items I
    LEFT OUTER JOIN MyList M ON M.itemID = I.itemID
WHERE M.userID = 9 
```

**编辑：**基于OP的评论：

```
SELECT I.itemID, I.itemTitle, M.deleted, M.userID
FROM
    MyList M
    LEFT OUTER JOIN Items I ON I.itemID = M.itemID
WHERE M.userID = 9 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T15:11:13.473

您可以使用`outer join`：

```
select a.itemId, a.itemTitle, b.deleted
from Items a left outer join MyList b
on a.itemId = b.itemId 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T16:17:17.073

我不确定这是否是最好的方法，但它返回了我正在寻找的内容：

```
select itemID, itemTitle, deleted, userID
FROM(
SELECT i.id_itemID, i.itemTitle, M.deleted, M.userID
FROM
    MyList M
    right OUTER JOIN Items I ON I.itemID= M.itemID
) as MyTableItems
where itemID = 3 or itemID is null 
```

# c++ - 有什么方法可以使这个相对简单（嵌套用于内存复制）C++ 代码更高效？

> ID：532702
> 
> 赞同：5
> 
> 时间：2009-02-10T15:06:25.480
> 
> 标签：c++, optimization, image-processing, memory-management

我意识到这是一个愚蠢的问题，因为没有更好的术语。我只是在寻找有关提高此代码效率的任何外部想法，因为它使系统非常糟糕（它必须大量执行此功能）并且我的想法很少。

它正在做什么它加载存储在“unsigned char * pImage”中的图像的两个图像容器（用于全彩色img的imgRGB和用于黑白图像的imgBW）逐个像素的图像。

imgRGB 和 imgBW 都是用于根据需要访问单个像素的容器。

```
// input is in the form of an unsigned char
// unsigned char *pImage

for (int y=0; y < 640; y++) {
    for (int x=0; x < 480; x++) {
        imgRGB[y][x].blue = *pImage;
        pImage++;

        imgRGB[y][x].green = *pImage;
        imgBW[y][x]        = *pImage;
        pImage++;

        imgRGB[y][x].red = *pImage;
        pImage++;
    }
} 
```

就像我说的，我只是在寻找关于更好的内存管理和/或复制的新输入和想法。有时我看自己的代码太多，以至于我得到了狭隘的视野……有点精神障碍。如果有人想要/需要更多信息，请务必告诉我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T17:37:56.943

The obvious question is, do you need to copy the data in the first place? Can't you just define accessor functions to extract the R, G and B values for any given pixel from the original input array?

If the image data is transient so you have to keep a copy of it, you could just make a raw copy of it without any reformatting, and again define accessors to index into each pixel/channel on that.

Assuming the copy you outlined is necessary, unrolling the loop a few times may prove to help.

I think the best approach will be to unroll the loop enough times to ensure that each iteration processes a chunk of data divisible by 4 bytes (so in each iteration, the loop can simply read a small number of ints, rather than a large number of chars) Of course this requires you to mask out bits of these ints when writing, but that's a fast operation, and most importantly, it is done in registers, without burdening the memory subsystem or the CPU cache:

```
// First, we need to treat the input image as an array of ints. This is a bit nasty and technically unportable, but you get the idea)
unsigned int* img = reinterpret_cast<unsigned int*>(pImage);

for (int y = 0; y < 640; ++y)
{
  for (int x = 0; x < 480; x += 4)
  {
    // At the start of each iteration, read 3 ints. That's 12 bytes, enough to write exactly 4 pixels.
    unsigned int i0 = *img;
    unsigned int i1 = *(img+1);
    unsigned int i2 = *(img+2);
    img += 3;

    // This probably won't make a difference, but keeping a reference to the found pixel saves some typing, and it may assist the compiler in avoiding aliasing.
    ImgRGB& pix0 = imgRGB[y][x];
    pix0.blue = i0 & 0xff;
    pix0.green = (i0 >> 8) & 0xff;
    pix0.red = (i0 >> 16) & 0xff;
    imgBW[y][x] = (i0 >> 8) & 0xff;

    ImgRGB& pix1 = imgRGB[y][x+1];
    pix1.blue = (i0 >> 24) & 0xff;
    pix1.green = i1 & 0xff;
    pix1.red = (i0 >> 8) & 0xff;
    imgBW[y][x+1] = i1 & 0xff;

    ImgRGB& pix2 = imgRGB[y][x+2];
    pix2.blue = (i1 >> 16) & 0xff;
    pix2.green = (i1 >> 24) & 0xff;
    pix2.red = i2 & 0xff;
    imgBW[y][x+2] = (i1 >> 24) & 0xff;

    ImgRGB& pix3 = imgRGB[y][x+3];
    pix3.blue = (i2 >> 8) & 0xff;
    pix3.green = (i2 >> 16) & 0xff;
    pix3.red = (i2 >> 24) & 0xff;
    imgBW[y][x+3] = (i2 >> 16) & 0xff;
  }
} 
```

it is also very likely that you're better off filling a temporary ImgRGB value, and then writing that entire struct to memory at once, meaning that the first block would look like this instead: (the following blocks would be similar, of course)

```
ImgRGB& pix0 = imgRGB[y][x];
ImgRGB tmpPix0;
tmpPix0.blue = i0 & 0xff;
tmpPix0.green = (i0 >> 8) & 0xff;
tmpPix0.red = (i0 >> 16) & 0xff;
imgBW[y][x] = (i0 >> 8) & 0xff;
pix0 = tmpPix0; 
```

Depending on how clever the compiler is, this may cut down dramatically on the required number of reads. Assuming the original code is naively compiled (which is probably unlikely, but will serve as an example), this will get you from 3 reads and 4 writes per pixel (read RGB channel, and write RGB + BW) to 3/4 reads per pixel and 2 writes. (one write for the RGB struct, and one for the BW value)

You could also accumulate the 4 writes to the BW image in a single int, and then write that in one go too, something like this:

```
bw |= (i0 >> 8) & 0xff;
bw |=  (i1 & 0xff) << 8;
bw |=  ((i1 >> 24) & 0xff) << 16;
bw |=  ((i2 >> 16) & 0xff) << 24;

*(imgBW + y*480+x/4) = bw; // Assuming you can treat imgBW as an array of integers 
```

This would cut down on the number of writes to 1.25 per pixel (1 per RGB struct, and 1 for every 4 BW values)

Again, the benefit will probably be a lot smaller (or even nonexistent), but it may be worth a shot.

Taking this a step further, the same could be done without too much trouble using the SSE instructions, allowing you to process 4 times as many values per iteration. (Assuming you're running on x86)

Of course, an important disclaimer here is that the above *is* nonportable. The reinterpret_cast is probably an academic point (it'll most likely work no matter what, especially if you can ensure that the original array is aligned on a 32-bit boundary, which will typically be the case for large allocations on all platforms) A bigger issue is that the bit-twiddling depends on the CPU's endianness.

But in practice, this should work on x86\. and with small changes, it should work on big-endian machines too. (modulo any bugs in my code, of course. I haven't tested or even compiled any of it ;))

But no matter how you solve it, you're going to see the biggest speed improvements from minimizing the number of reads and writes, and trying to accumulate as much data in the CPU's registers as possible. Read all you can in large chunks, like ints, reorder it in the registers (accumulate it into a number of ints, or write it into temporary instances of the RGB struct), and then write those combined value out to memory.

Depending on how much you know about low-level optimizations, it may be surprising to you, but temporary variables are fine, while direct memory to memory access can be slow (for example your pointer dereferencing assigned directly into the array). The problem with this is that you may get more memory accesses than necessary, and it's harder for the compiler to guarantee that no aliasing will occur, and so it may be unable to reorder or combine the memory accesses. You're generally better off writing as much as you can early on (top of the loop), doing as much as possible in temporaries (because the compiler can keep everything in registers), and then write everything out at the end. That also gives the compiler as much leeway as possible to wait for the initially slow reads.

Finally, adding a 4th dummy value to the RGB struct (so it has a total size of 32bit) will most likely help a lot too (because then writing such a struct is a single 32-bit write, which is simpler and more efficient than the current 24-bit)

When deciding how much to unroll the loop (you could do the above twice or more in each iteration), keep in mind how many registers your CPU has. Spilling out into the cache will probably hurt you as there are plenty of memory accesses already, but on the other hand, unroll as much as you can afford given the number of registers available (the above uses 3 registers for keeping the input data, and one to accumulate the BW values. It may need one or two more to compute the necessary addresses, so on x86, doubling the above might be pushing it a bit (you have 8 registers total, and some of them have special meanings). On the other hand, modern CPU's do a lot to compensate for register pressure, by using a much larger number of registers behind the scenes, so further unrolling might still be a total performance win.

As always, measure measure measure. It's impossible to say what's fast and what isn't until you've tested it.

Another general point to keep in mind is that data dependencies are bad. This won't be a big deal as long as you're only dealing with integral values, but it still inhibits instruction reordering, and superscalar execution. In the above, I've tried to keep dependency chains as short as possible. Rather than continually incrementing the same pointer (which means that each increment is dependant on the previous one), adding a different offset to the same base address means that every address can be computed independently, again giving more freedom to the compiler to reorder and reschedule instructions.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T15:34:14.447

I think the array accesses (are they real array accesses or operator []?) are going to kill you. Each one represents a multiply.

Basically, you want something like this:

```
for (int y=0; y < height; y++) {
    unsigned char *destBgr = imgRgb.GetScanline(y); // inline methods are better
    unsigned char *destBW = imgBW.GetScanline(y);
    for (int x=0; x < width; x++) {
        *destBgr++ = *pImage++;
        *destBW++ = *destBgr++ = *pImage++; // do this in one shot - don't double deref
        *destBgr++ = *pImage++;
    }
} 
```

This will do two multiplies per scanline. You code was doing 4 multiplies per PIXEL.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T15:35:29.810

What I like to do in situations like this is go into the debugger and step through the disassembly to see what it is really doing (or have the compiler generate an assembly listing). This can give you a lot of clues about where inefficencies are. They are often not where you think!

By implementing the changes suggested by Assaf and David Lee above, you can get a before and after instruction count. This really helps me in optimizing tight inner loops.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T15:12:28.803

您可以使用下标运算符 [][] 一遍又一遍地优化一些指针算术，并改用迭代器（即推进指针）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T17:29:37.243

Memory bandwidth is your bottleneck here. There is a theoretical minimum time required to transfer all the data to and from system memory. I wrote a little test to compare the OP's version with some simple assembler to see how good the compiler was. I'm using VS2005 with default release mode settings. Here's the code:

```
#include <windows.h>
#include <iostream>
using namespace std;

const int
c_width = 640,
c_height = 480;

typedef struct _RGBData
{
  unsigned char
    r,
    g,
    b;
    // I'm assuming there's no padding byte here
} RGBData;

//  similar to the code given
void SimpleTest
(
  unsigned char *src,
  RGBData *rgb,
  unsigned char *bw
)
{
  for (int y = 0 ; y < c_height ; ++y)
  {
    for (int x = 0 ; x < c_width ; ++x)
    {
      rgb [x + y * c_width].b = *src;
      src++;

      rgb [x + y * c_width].g = *src;
      bw [x + y * c_width] = *src;
      src++;

      rgb [x + y * c_width].r = *src;
      src++;
    }
  }
}

//  the assembler version
void ASM
(
  unsigned char *src,
  RGBData *rgb,
  unsigned char *bw
)
{
  const int
    count = 3 * c_width * c_height / 12;

  _asm
  {
    push ebp
    mov esi,src
    mov edi,bw
    mov ecx,count
    mov ebp,rgb
l1:
    mov eax,[esi]
    mov ebx,[esi+4]
    mov edx,[esi+8]
    mov [ebp],eax
    shl eax,16
    mov [ebp+4],ebx
    rol ebx,16
    mov [ebp+8],edx
    shr edx,24
    and eax,0xff000000
    and ebx,0x00ffff00
    and edx,0x000000ff
    or eax,ebx
    or eax,edx
    add esi,12
    bswap eax
    add ebp,12
    stosd
    loop l1
    pop ebp
  }
}

//  timing framework
LONGLONG TimeFunction
(
  void (*function) (unsigned char *src, RGBData *rgb, unsigned char *bw),
  char *description,
  unsigned char *src, 
  RGBData *rgb,
  unsigned char *bw
)
{
  LARGE_INTEGER
    start,
    end;

  cout << "Testing '" << description << "'...";
  memset (rgb, 0, sizeof *rgb * c_width * c_height);
  memset (bw, 0, c_width * c_height);

  QueryPerformanceCounter (&start);

  function (src, rgb, bw);

  QueryPerformanceCounter (&end);

  bool
    ok = true;

  unsigned char
    *bw_check = bw,
    i = 0;

  RGBData
    *rgb_check = rgb;

  for (int count = 0 ; count < c_width * c_height ; ++count)
  {
    if (bw_check [count] != i || rgb_check [count].r != i || rgb_check [count].g != i || rgb_check [count].b != i)
    {
      ok = false;
      break;
    }

    ++i;
  }

  cout << (end.QuadPart - start.QuadPart) << (ok ? " OK" : " Failed") << endl;
  return end.QuadPart - start.QuadPart;
}

int main
(
  int argc,
  char *argv []
)
{
  unsigned char
    *source_data = new unsigned char [c_width * c_height * 3];

  RGBData
    *rgb = new RGBData [c_width * c_height];

  unsigned char
    *bw = new unsigned char [c_width * c_height];

  int
    v = 0;

  for (unsigned char *dest = source_data ; dest < &source_data [c_width * c_height * 3] ; ++dest)
  {
    *dest = v++ / 3;
  }

  LONGLONG
    totals [2] = {0, 0};

  for (int i = 0 ; i < 10 ; ++i)
  {
    cout << "Iteration: " << i << endl;
    totals [0] += TimeFunction (SimpleTest, "Initial Copy", source_data, rgb, bw);
    totals [1] += TimeFunction (       ASM, "    ASM Copy", source_data, rgb, bw);
  }

  LARGE_INTEGER
    freq;

  QueryPerformanceFrequency (&freq);

  freq.QuadPart /= 100000;

  cout << totals [0] / freq.QuadPart << "ns" << endl;
  cout << totals [1] / freq.QuadPart << "ns" << endl;

  delete [] bw;
  delete [] rgb;
  delete [] source_data;

  return 0;
} 
```

And the ratio between C and assembler I was getting was about 2.5:1, i.e. C was 2.5 times the time of the assembler version.

I've just noticed the original data was in BGR order. If the copy swapped the B and R components then it does make the assembler code a bit more complex. But it would also make the C code more complex too.

Ideally, you need to work out what the theoretical minimum time is and compare it to what you're actually getting. To do that, you need to know the memory frequency and the type of memory and the workings of the CPU's MMU.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T15:38:58.290

You might try using a simple cast to get your RGB data, and just recompute the grayscale data:

```
#pragma pack(1)
typedef unsigned char bw_t;
typedef struct {
    unsigned char blue;
    unsigned char green;
    unsigned char red;
} rgb_t;
#pragma pack(pop)

rgb_t *imageRGB = (rgb_t*)pImage;
bw_t *imageBW = (bw_t*)calloc(640*480, sizeof(bw_t));
// RGB(X,Y) = imageRGB[Y*480 + X]
// BW(X,Y) = imageBW[Y*480 + X]

for (int y = 0; y < 640; ++y)
{
   // try and pull some larger number of bytes from pImage (24 is arbitrary)
   // 24 / sizeof(rgb_t) = 8
   for (int x = 0; x < 480; x += 24)
   {
       imageBW[y*480 + x    ] = GRAYSCALE(imageRGB[y*480 + x    ]);
       imageBW[y*480 + x + 1] = GRAYSCALE(imageRGB[y*480 + x + 1]);
       imageBW[y*480 + x + 2] = GRAYSCALE(imageRGB[y*480 + x + 2]);
       imageBW[y*480 + x + 3] = GRAYSCALE(imageRGB[y*480 + x + 3]);
       imageBW[y*480 + x + 4] = GRAYSCALE(imageRGB[y*480 + x + 4]);
       imageBW[y*480 + x + 5] = GRAYSCALE(imageRGB[y*480 + x + 5]);
       imageBW[y*480 + x + 6] = GRAYSCALE(imageRGB[y*480 + x + 6]);
       imageBW[y*480 + x + 7] = GRAYSCALE(imageRGB[y*480 + x + 7]);
   }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-10T23:53:17.647

Several steps you can take. Result at the end of this answer.

First, **use pointers**.

```
const unsigned char *pImage;

RGB *rgbOut = imgRGB;
unsigned char *bwOut = imgBW;

for (int y=0; y < 640; ++y) {
    for (int x=0; x < 480; ++x) {
        rgbOut->blue = *pImage;
        ++pImage;

        unsigned char tmp = *pImage;  // Save to reduce amount of reads.
        rgbOut->green = tmp;
        *bwOut = tmp;
        ++pImage;

        rgbOut->red = *pImage;
        ++pImage;

        ++rgbOut;
        ++bwOut;
    }
} 
```

* * *

If `imgRGB` and `imgBW` are declared as:

```
unsigned char imgBW[480][640];
RGB imgRGB[480][640]; 
```

You can **combine the two loops**:

```
const unsigned char *pImage;

RGB *rgbOut = imgRGB;
unsigned char *bwOut = imgBW;

for (int i=0; i < 640 * 480; ++i) {
    rgbOut->blue = *pImage;
    ++pImage;

    unsigned char tmp = *pImage;  // Save to reduce amount of reads.
    rgbOut->green = tmp;
    *bwOut = tmp;
    ++pImage;

    rgbOut->red = *pImage;
    ++pImage;

    ++rgbOut;
    ++bwOut;
} 
```

* * *

You can exploit the fact that **word reads are faster than four char reads**. We will use a helper macro for this. Note this example assumes a little-endian target system.

```
const unsigned char *pImage;

RGB *rgbOut = imgRGB;
unsigned char *bwOut = imgBW;

const uint32_t *curPixelGroup = pImage;

for (int i=0; i < 640 * 480; ++i) {
    uint64_t pixels = 0;

#define WRITE_PIXEL         \
    rgbOut->blue = pixels;  \
    pixels >>= 8;           \
                            \
    rgbOut->green = pixels; \
    *bwOut = pixels;        \
    pixels >>= 8;           \
                            \
    rgbOut->red = pixels;   \
    pixels >>= 8;           \
                            \
    ++rgbOut;               \
    ++bwOut;

#define READ_PIXEL(shift) \
    pixels |= (*curPixelGroup++) << (shift * 8);

    READ_PIXEL(0);  WRITE_PIXEL;
    READ_PIXEL(1);  WRITE_PIXEL;
    READ_PIXEL(2);  WRITE_PIXEL;
    READ_PIXEL(3);  WRITE_PIXEL;
    /* Remaining */ WRITE_PIXEL;

#undef COPY_PIXELS
} 
```

(Your compiler will probably optimize away the redundant `or` operation in the first `READ_PIXEL`. It will also optimize shifts, removing the redundant `<< 0`, too.)

* * *

If the structure of `RGB` is thus:

```
struct RGB {
     unsigned char blue, green, red;
}; 
```

You can optimize even further, **copy to the struct directly**, instead of through its members (`red`, `green`, `blue`). This can be done using anonymous structs (or casting, but that makes the code a bit more messy and probably more prone to error). (Again, this is dependant on little-endian systems, etc. etc.):

```
union RGB {
    struct {
        unsigned char blue, green, red;
    };

    uint32_t rgb:24;  // Make sure it's a bitfield, otherwise the union will strech and ruin the ++ operator.
};

const unsigned char *pImage;

RGB *rgbOut = imgRGB;
unsigned char *bwOut = imgBW;

const uint32_t *curPixelGroup = pImage;

for (int i=0; i < 640 * 480; ++i) {
    uint64_t pixels = 0;

#define WRITE_PIXEL         \
    rgbOut->rgb = pixels;   \
    pixels >>= 8;           \
                            \
    *bwOut = pixels;        \
    pixels >>= 16;          \
                            \
    ++rgbOut;               \
    ++bwOut;

#define READ_PIXEL(shift) \
    pixels |= (*curPixelGroup++) << (shift * 8);

    READ_PIXEL(0);  WRITE_PIXEL;
    READ_PIXEL(1);  WRITE_PIXEL;
    READ_PIXEL(2);  WRITE_PIXEL;
    READ_PIXEL(3);  WRITE_PIXEL;
    /* Remaining */ WRITE_PIXEL;

#undef COPY_PIXELS
} 
```

You can optimize writing the pixel similarly as we did with reading (**writing in words** rather than 24-bits). In fact, that'd be a pretty good idea, and will be a great next step in optimization. Too tired to code it, though. =]

* * *

Of course, you can **write the routine in assembly language**. This makes it less portable than it already is, however.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T15:35:52.943

I'm assuming the following at the moment, so please let me know if my assumptions are wrong:

a) imgRGB is a structure of the type

```
 struct ImgRGB
    {
      unsigned char blue;
      unsigned char green;
      unsigned char red;
    }; 
```

or at least something similar.

b) imgBW looks something like this:

```
 struct ImgBW
    {
       unsigned char BW;
    }; 
```

c) The code is single threaded

Assuming the above, I see several problems with your code:

*   You put the assignment to the BW part right in the middle of the assignments to the other containers. If you're working on a modern CPU, chances are that with the size of your data your L1 cache gets invalidated every time you're switching containers and you're looking at reloading or switching a cache line. Caches are optimised for linear access these days so hopping to and fro doesn't help. Accessing main memory is a lot slower, so that would be a noticeable performance hit. To verify if this is a problem, temporarily I'd remove the assignment to imgBW and measure if there is a noticeable speedup.
*   The array access doesn't help and it'll potentially slow down the code a little, although a decent optimiser should take care of that. I'd probably write the loop along these lines instead, but would not expect a big performance gain. Maybe a couple percent.

```
 for (int y=0; y blue = *pImage;
            ...
        }
    } 
```

*   For consistency I would change from using postfix to prefix increment but I would not expect to see a big gain.
*   If you can waste a little storage (well, 25%) you might gain from adding a fourth dummy unsigned char to the structure ImgRGB provided that this would increase the size of the structure to the size of an int. Native ints are usually fastest to access and if you're looking at a structure of chars that are not filling up an int completely, you're potentially running into all sorts of interesting access issues that can slow your code down noticeably because the compiler might have to generate additional instructions to extract the unsigned chars. Again, try this and measure the result - it might make a noticeable difference or none at all. In the same vein, upping the size of the structure members from unsigned char to unsigned int might waste lots of space but potentially can speed up the code. Nevertheless as long as pImage is a pointer to an unsigned char, you would only eliminate half the problem.

All in all you are down to making your loop fit to your underlying hardware, so for specific optimisation techniques you might have to read up on what your hardware does well and what it does badly.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T19:12:22.783

Make sure pImage, imgRGB, and imgBW are marked __restrict. Use SSE and do it sixteen bytes at a time.

Actually from what you're doing there it looks like you could use a simple memcpy() to copy pImage into imgRGB (since imgRGB is in row-major format and apparently in the same order as pImage). You could fill out imgBW by using a series of SSE swizzle and store ops to pack down the green values but it might be cumbersome since you'd need to work on ( 3*16 =) 48 bytes at a time.

Are you sure pImage and your output arrays are all in dcache when you start this? Try using a prefetch hint to fetch 128 bytes ahead and measure to see if that improves things.

**Edit** If you're not on x86, replace "SSE" with the appropriate SIMD instruction set for your hardware, of course. (That'd be VMX, Altivec, SPU, VLIW, HLSL, etc.)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-10T15:18:04.203

如果可能，请在更高级别上修复此问题，然后再进行位或指令操作！

*   您可以将黑白图像类专门化为引用彩色图像类的绿色通道的类（从而为每个像素保存一个副本）。如果你总是成对创建它们，你甚至可能根本不需要天真的`imgBW`类。

*   By taking care about how your store the data in `imgRGB`, you could copy a triplet at a time from the input data. Better, you might copy the whole thing, or even just store a reference (which makes the previous suggestion easy as well).

If you don't control the implementation of everything here, you might be stuck, then:

*   Last resort: unroll the loop (cue someone mentioning Duff's device, or just ask the compiler to do it for you...), though I don't think you'll see much improvement...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-10T15:34:42.010

It seems that you defined each pixel as some kind of structure or object. Using a primitive type (say, int) could be faster. As others have mentioned, the compiler is likely to optimize the array access using pointer increments. If the compile doesn't do that for you, you can do that yourself to avoid multiplications when you use array[][].

Since you only need 3 bytes per pixel, you could pack one pixel into one int. By doing that, you could copy 3 bytes a time instead of byte-by-byte. The only tricky thing is when you want to read individual color components of a pixel, you will need some bit masking and shifting. This could give you more overhead than that saved by using an int.

Or you can use 3 int arrays for 3 color components respectively. You will need a lot more storage, though.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-10T19:44:48.120

Here is one very tiny, very simple optimization:

You are referring to imageRGB[y][x] repeatedly, and that likely needs to be re-calculated at each step.

Instead, calculate it once, and see if that makes some improvement:

```
Pixel* apixel;

for (int y=0; y < 640; y++) {
    for (int x=0; x < 480; x++) {
        apixel = &imgRGB[y][x];

        apixel->blue = *pImage;
        pImage++;

        apixel->green = *pImage;
        imgBW[y][x]   = *pImage;
        pImage++;

        apixel->red = *pImage;
        pImage++;
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T23:15:54.180

If pImage is already entirely in memory, why do you need to massage the data? I mean if it is already in pseudo-RGB format, why can't you just write some inline routines/macros that can spit out the values on demand instead of copying it around?

If rearranging the pixel data is important for later operations, consider block operations and/or cache line optimization.

# c# - EndInvoke() 是可选的，是可选的，还是绝对不是可选的？

> ID：532722
> 
> 赞同：56
> 
> 时间：2009-02-10T15:10:40.133
> 
> 标签：c#, multithreading, delegates

我读过关于是否每个 BeginInvoke() 都必须与 EndInvoke() 匹配的相互矛盾的意见。是否存在与不调用 EndInvoke() 相关的任何泄漏或其他问题？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-02-10T15:14:07.193

Delegate.EndInvoke 被记录为*你应该称之为*（即必要的 - 否则发生泄漏） - 来自[msdn](http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx)：

> **重要的提示**
> 
> 无论您使用哪种技术，始终调用 EndInvoke 来完成您的异步调用。

Control.EndInvoke 可以忽略即发即弃方法 - 来自[msdn](http://msdn.microsoft.com/en-us/library/0b1bf3y3.aspx)：

> 如果需要，您可以调用 EndInvoke 从委托中检索返回值，但这不是必需的。

但是 - 如果您正在使用`Delegate.BeginInvoke`并且不想要结果，请考虑使用`ThreadPool.QueueUserWorkItem`- 它会让生活变得更轻松，并避免`IAsyncResult`等的痛苦。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-10T15:13:28.460

EndInvoke 不是可选的。

更多信息[在这里](http://www.interact-sw.co.uk/iangblog/2005/05/16/endinvokerequired)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-10T15:14:28.037

而 EndInvoke 调用不是可选调用，它是合约的一部分。如果调用 BeginInvoke，则必须调用 EndInvoke。

为什么这是必要的经典示例。从 BeginInvoke 返回的 IAsyncResult 很可能已分配附加到它的资源。最常见的是 WaitHandle 之类的。因为 IAsyncResult 没有实现 IDisposable，所以必须选择另一个地方来释放资源。唯一可以这样做的地方是 EndInvoke。

我在下面的博客文章中简要讨论了这个问题。

[http://blogs.msdn.com/jaredpar/archive/2008/01/07/isynchronizeinvoke-now.aspx](http://blogs.msdn.com/jaredpar/archive/2008/01/07/isynchronizeinvoke-now.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-10T15:26:35.433

EndInvoke 不是可选的，因为它是在异步处理中出现问题时引发异常的地方。

无论如何，不​​应该有任何泄漏，因为如果 IAsyncResult 持有一些本机资源，它应该正确实现 IDisposable 并在 GC 调用其终结器时处置此类资源。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T16:01:22.150

它不是可选的，因为调用 BeginInvoke 使用了 WaitHandle，而 WaitHandle 又使用了一个内核对象，该对象维护对它的引用次数。调用 EndInvoke 会优雅地处理递减内核对象上的计数器的句柄，当该计数达到零时，内核对象管理器将销毁它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T15:38:10.053

如果您不介意程序的内存变得非常大，则它是唯一可选的。问题是 GC 保留了线程中的所有引用，因为您可能想在某个时候调用 EndInvoke。我会同意马克的回答，线程池会让你的生活更轻松。但是，您需要注意是否从线程中生成线程，因为它可以启动的线程数是有限的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-12-18T18:12:53.673

这篇文章的每个回复都说 EndInvoke() 不是可选的。但是，我发现以下排名很高的评论是此 SO 线程上接受的答案：

“请注意，Windows 窗体团队已保证您可以以‘即发即弃’的方式使用 Control.BeginInvoke - 即无需调用 EndInvoke。这通常不适用于异步调用：通常每个 BeginXXX 都应该有一个相应的 EndXXX 调用，通常在回调中。”

[Invoke() 和 BeginInvoke() 有什么区别](https://stackoverflow.com/questions/229554/whats-the-difference-between-invoke-and-begininvoke)

# sql - 损坏的 SQL Server 索引？

> ID：532734
> 
> 赞同：1
> 
> 时间：2009-02-10T15:14:37.207
> 
> 标签：sql, sql-server, sql-server-2008, indexing, corrupt

我遇到了一个非常奇怪的问题，该问题似乎是某种损坏的索引。从 dbcc checkdb 将拾取它的意义上说不是损坏，但从它具有不应该具有的行的意义上说是损坏的。

我有两个表，TableA 和 TableB。出于我的应用程序的目的，某些行在功能上被认为是重复的，这意味着虽然并非所有列值都相同，但我的应用程序将该行视为重复。为了过滤掉这些，我创建了一个名为 vTableAUnique 的视图。视图定义如下：

```
SELECT a.*   
FROM TableA a   
INNER JOIN  
(   
      SELECT ID, ROW_NUMBER() OVER   
          (PARTITION By Col1   
           ORDER BY Col1) AS Num   
      FROM TableA   
) numbered ON numbered.ID = a.ID   
WHERE numbered.Num = 1 
```

视图的结果是来自 TableA 的所有记录，这些记录在 TableA 中没有任何其他行与 Col1 的值相同。对于此示例，假设 TableA 总共有 10 行，但只有 7 行具有不同的值显示在 vTableAUnique 中。

TableB 基本上只是一个与 TableA 中 Col1 的值匹配的值列表。在这种情况下，假设 TableB 具有出现在 vTableAUnique 中的所有 8 个唯一值。因此，TableA、TableB 和 vTableAUnique 中的数据如下所示：

```
TableA (ID, Col1, Col2, Col3)

1,A,X,X

2,A,X,X

3,B,X,X

4,A,X,X

5,E,X,X

6,F,X,X

7,G,X,X

8,H,X,X

9,I,X,X

10,J,X,X

TableB (ID)

A

B

C

D

E

F

G

H

I

J

vTableAUnique (ID, Col1, Col2, Col3)

1,A,X,X

3,B,X,X

5,E,X,X

6,F,X,X

7,G,X,X

8,H,X,X

9,I,X,X

10,J,X,X 
```

所以这是奇怪的部分。有时，当我在 Col1 上将 vTableAUnique 与 TableB 连接时，我会从 TableA 中取回非不同的值。换句话说，在 vTableAUnique 中不存在但在 TableA 中存在的行会在我执行连接时出现。如果我在 vTableAUnique 之外进行选择，我不会得到这些行。在这种情况下，我不仅会返回 ID 为 1、3、5、6、7、8、9、10 的行，还会返回 ID 为 2 和 4 的行！

在把头撞在桌子上之后，我决定尝试重建数据库中的所有索引。果然，问题消失了。现在，相同的查询返回了正确的行。然而，经过一段不确定的时间后，问题又回来了。DBCC CHECKDB 没有显示任何问题，我很难追踪可能导致此问题的索引。

我在 Vista x64 上使用 SQL Server 2008 Developer Edition。

帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T15:46:51.763

```
ROW_NUMBER() OVER (PARTITION By Col1 ORDER BY Col1) 
```

不是一个稳定的排序顺序，它可以根据访问路径从查询更改为查询。

您的视图可能会返回多次运行的不同结果。

重建索引似乎会影响排序顺序。

用这个：

```
ROW_NUMBER() OVER (PARTITION By Col1 ORDER BY Id) 
```

相反，它保证了稳定的排序顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T15:18:35.670

编写索引并查看脚本，它是使用 ALLOW_DUP_ROW 创建的吗？如果是这样，那可能是你的问题

# asp.net - WCF REST Starter Kit - 支持多种资源？

> ID：532738
> 
> 赞同：1
> 
> 时间：2009-02-10T15:15:52.027
> 
> 标签：asp.net, wcf, rest

我刚刚开始修改 WCF REST Starter Kit，我观看了截屏视频，然后......我怀疑我只是在愚蠢。:) 开箱即用（使用提供的模板）我可以为单例资源或资源集合创建 REST 服务。但是在同一个项目中支持不同类型的资源呢？例如，如果我有 Books，我也想拥有 Authors 和 Publishers。使用提供的模板，我看不到实现此目的的简单方法。为每个资源创建一个服务（以及一个 VS 项目）对我来说听起来很荒谬。我需要在单个服务中支持多种资源类型，以便可以在类似的 URL 下访问它们，这样用户只需替换最后一部分，如*[http://service/books](http://service/books)*即可获取所有书籍和*[http:/ /服务/作者/32](http://service/authors/32)*获取特定作者。

任何人都可以对此有所了解吗？我知道这可以使用普通的 WCF 服务创建，但是 Starter Kit 已经具备所有样板文件，那么为什么不使用它呢？如何处理模板生成的项目来添加对不同资源类型的支持？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T16:55:20.387

我认为您对 WCF REST Starter Kit 的考虑过多。尝试将 WCF REST Starter Kit 视为一个 WCF 服务，该服务已配置为在 http 环境中轻松设置。为 WCF REST Starter Kit 设置的默认模板旨在用作示例。您将不得不创建自己的签名或调整他们的签名以满足您的需求。

您需要关注的关键部分是 .svc 文件中的代码（您无法双击访问它，您必须选择打开方式）和 [ServiceContract] 接口。

修改后面提供的代码中的 [ServiceContract] 接口，使其看起来与常规 WCF 服务一样。

这是根据您的需要修改的 ATOM Pub Feed 示例

```
[ServiceBehavior(IncludeExceptionDetailInFaults = true, InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode = ConcurrencyMode.Single)]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
[ServiceContract]
public partial class LibraryFeed
{
    public LibraryFeed()
    {
    }

    /// <summary>
    /// Returns an Atom feed.
    /// </summary>
    /// <returns>Atom feed in response to a HTTP GET request at URLs conforming to the URI template of the WebGetAttribute.</returns>
    [WebHelp(Comment = "Gets a list of Books.")]
    [WebGet(UriTemplate = "/books/?numItems={numItems}")]
    [OperationContract]
    public Atom10FeedFormatter GetBooks(int numItems)
    {
        var books = GetBooks();
        List<SyndicationItem> items = GetItems(books, numItems);

        SyndicationFeed feed = CreateFeed(items);

        WebOperationContext.Current.OutgoingResponse.ContentType = ContentTypes.Atom;
        return feed.GetAtom10Formatter();
    }

    /// <summary>
    /// Returns an Atom feed.
    /// </summary>
    /// <returns>Atom feed in response to a HTTP GET request at URLs conforming to the URI template of the WebGetAttribute.</returns>
    [WebHelp(Comment = "Gets a single author.")]
    [WebGet(UriTemplate = "/authors/?numItems={numItems}")]
    [OperationContract]
    public Atom10FeedFormatter GetAuthors(int numItems)
    {
        var authors = GetAuthors();
        List<SyndicationItem> items = GetItems(authors, numItems);

        SyndicationFeed feed = CreateFeed(items);

        WebOperationContext.Current.OutgoingResponse.ContentType = ContentTypes.Atom;
        return feed.GetAtom10Formatter();
    }

    /// <summary>
    /// Returns an Atom feed.
    /// </summary>
    /// <returns>Atom feed in response to a HTTP GET request at URLs conforming to the URI template of the WebGetAttribute.</returns>
    [WebHelp(Comment = "Gets a list of Authors.")]
    [WebGet(UriTemplate = "/authors/{id}")]
    [OperationContract]
    public Atom10FeedFormatter GetAuthor(string id)
    {
        var author = GetSingleAuthor(id);
        WebOperationContext.Current.OutgoingResponse.ContentType = ContentTypes.Atom;
        return GetItem(author.GetAtom10Formatter());
    }
} 
```

# wpf - WPF：如何使用 BackgroundWorker 处理错误

> ID：532740
> 
> 赞同：2
> 
> 时间：2009-02-10T15:16:46.750
> 
> 标签：wpf, multithreading, exception, error-handling, backgroundworker

在 Windows 客户端编程方面，我是一个新手。我有一个后台工作人员，它有一个 DoWork 事件和一个 RunCompleted 事件。如果在 DoWork 中抛出异常，我想对我的 UI 进行更改，但是我不能，因为它在不同的线程中。我可以将错误传达给 RunCompleted，但这也无济于事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T15:21:13.993

调用 Dispatcher.BeginInvoke。基本上，你想要这样的代码：

```
void UpdateState(WhatEverType someObject)
{
    if (! Dispatcher.CheckAccess())
    {
        Dispatcher.BeginInvoke(DispatcherPriority.Normal, new Action(()=>UpdateState(someObject));
    }
    else
    {
        //make the UI changes here.
    }
} 
```

# c# - 捕获 HTTP 请求

> ID：532746
> 
> 赞同：5
> 
> 时间：2009-02-10T15:17:51.723
> 
> 标签：c#, http

有没有办法使用 C# 监视和捕获来自机器的所有传出 HTTP 请求？

我需要一种独立于浏览器的方式来记录访问过的 URL。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T15:23:02.197

我使用提琴手（[http://www.fiddler2.com](http://www.fiddler2.com)）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-10T15:25:44.747

您可能希望使用现有的网络接口捕获库（如 pcap 或 winpcap）来执行此操作。自己重写所有必要的东西会非常耗时。

链接到[Pcap](http://www.tcpdump.org/pcap.htm)

链接到[WinPcap](http://www.winpcap.org/)

编辑：刚刚看到有人还写了 C# 绑定到 winpcap：[SharpPcap](http://www.codeproject.com/KB/IP/sharppcap.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T15:31:40.240

听起来您正在使用某种“数据包嗅探”实用程序。

以下是 Code Project 网站上关于用 C# 编写的数据包嗅探器（带有可下载源代码）的文章的几个链接：

[数据包捕获和分析器](http://www.codeproject.com/KB/cs/pacanal.aspx)

[C# 中的网络嗅探器](http://www.codeproject.com/KB/IP/CSNetworkSniffer.aspx)

如果您只是在捕获访问过的 URL 之后，这些实用程序可能有点过头了，但是，您将能够从 HTTP 数据包中提取 URL 并丢弃其余部分，但是，您可能还希望捕获所有数据包信息，其中情况下，这些实用程序将有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T15:23:20.353

通过某种代理设置，您可能会节省大量时间和精力。一个体面的本地计算机解决方案是[Fiddler](http://www.fiddlertool.com/)（需要 Windows），或类似[Squid](http://www.squid-cache.org/)服务器的网络解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T16:30:55.713

我希望[Wirehark](http://www.wireshark.org/)对你有用。它是免费且跨平台的。此外，“Wireshark 是世界上最重要的网络协议分析仪，并且是许多行业和教育机构事实上（通常是法律上）的标准”

看看， [Wireshark-维基百科](http://en.wikipedia.org/wiki/Wireshark)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-10T16:00:35.147

此外，在 C# 中为此目的编写一个简单的 http 代理是一项微不足道的任务。

# vb.net - 如何在 VS 2005 中为属性启用“自动填充”选项？

> ID：532752
> 
> 赞同：0
> 
> 时间：2009-02-10T15:19:04.937
> 
> 标签：vb.net, visual-studio-2005, properties

如何在 VS 2005 中为属性启用“自动填充”选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T15:21:44.850

我不确定这是否正确，但您可以键入 prop [tab] [tab] 来填充要填充的属性的外壳。

# php - PHP中静态成员的继承

> ID：532754
> 
> 赞同：37
> 
> 时间：2009-02-10T15:19:51.690
> 
> 标签：php, inheritance

在 PHP 中，如果在父类中定义了静态属性，则不能在子类中覆盖它。但我想知道是否有任何方法可以解决这个问题。

我正在尝试为别人的（有点笨重）功能编写一个包装器。有问题的函数可以应用于许多不同的数据类型，但每个数据类型需要不同的标志和选项。但在 99% 的情况下，每种类型的默认值就足够了。

如果这可以通过继承来完成，而不必每次都编写新函数，那就太好了。例如：

```
class Foo {
    public static $default = 'DEFAULT';

    public static function doSomething ($param = FALSE ) {
        $param = ($param === FALSE) ? self::$default : $param;
        return $param;
    }
}

class Bar extends Foo {
    public static $default = 'NEW DEFAULT FOR CHILD CLASS';
}

echo Foo::doSomething() . "\n"; 
// echoes 'DEFAULT'

echo Bar::doSomething() . "\n"; 
// echoes 'DEFAULT' not 'NEW DEFAULT FOR CHILD CLASS' 
// because it references $default in the parent class :( 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-17T09:53:29.530

实际上我认为这不是真的：您可以覆盖静态属性（为此**您需要> = 5.3 PHP**）。但是在引用该静态属性时必须小心（这是原始代码中的错误）

您需要使用**static::$myStaticProperty**而不是使用 self::$myStaticProperty

**self::**将引用**当前类**所以如果您在继承的静态方法中，这将引用该类的静态属性定义该方法！使用引用关键字 static:: 时，将像 $this 一样 - 当您使用实例方法/属性时。

在您的示例中，doSomething() 是类 Bar 中的继承静态方法。由于您在那里使用了 self::，它将引用类 Foo 的静态属性。这就是您没有看到任何区别的原因...**尝试将 self:: 更改为 static::**！

这是一个代码示例 - 我自己用它来测试这些东西。我们有静态属性/方法继承、覆盖和值更改 - 运行它，您将看到结果！

```
class A {

    // a static property - we will test override with it
    protected static $var = 'class A var - override';
    // a static property - we will test value overwrite with it
    protected static $var2 = 'class A var2 - value overwrite';

    public static function myStaticOverridePropertyTest() {
        return static::$var;
    }
    public static function myStaticValueOverwritePropertyTest() {
        return static::$var2;
    }

    /**
     * This method is defined only here - class B will inherit this one!
     * We use it to test the difference btw self:: and static::
     * 
     * @return string
     */
    public static function myStaticMethodTest() {
        //return self::getValue();
        return static::getValue();
    }

    /**
     * This method will be overwritten in class B
     * @return string
     */
    protected static function getValue() {
        return 'value from class A';
    }
}

class B extends A {

    // we override this inherited static property
    protected static $var = 'class B var - override';

    /**
     * This method is overwritten from class A
     * @return string
     */
    protected static function getValue() {
        return 'value from class B';
    }

    /**
     * We modify the value of the inherited $var2 static property
     */
    public static function modStaticProperty() {
        self::$var2 = 'class B - altered value! - value overwrite';
    }
}

echo ("-- testing class A:\n");
echo (A::myStaticOverridePropertyTest(). "\n");
echo (A::myStaticValueOverwritePropertyTest(). "\n");
echo (A::myStaticMethodTest(). "\n");

echo ("-- now testing class B:\n");
echo (B::myStaticOverridePropertyTest(). "\n");
echo (B::myStaticValueOverwritePropertyTest(). "\n");
echo ("  now invoking B::modStaticProperty()     .\n");
B::modStaticProperty();
echo (B::myStaticValueOverwritePropertyTest(). "\n");

echo ("-- now re-testing class A:\n");
echo (A::myStaticOverridePropertyTest(). "\n");
echo (A::myStaticValueOverwritePropertyTest(). "\n");
echo (A::myStaticMethodTest(). "\n"); 
```

这将输出：

-- 测试 A 类： A
类 var - 覆盖
A 类 var2 - 值覆盖
A 类的值
-- 现在测试 B 类：
B 类 var - 覆盖
A 类 var2 - 值覆盖
现在调用 B::modStaticProperty( ) ...
B 级 - 改变值！- 值覆盖
- 现在重新测试 A 类：
A 类 var - 覆盖
**B 类 - 改变值！- 值覆盖**
A 类的值

在这里，您可以看到覆盖静态属性和仅值覆盖静态属性之间的区别......看看我用粗体标记的输出行！当我们调用 B 类的 modStaticProperty() 时，它也改变了 A 类中该静态变量的值。由于该静态属性是继承的并且没有被覆盖！想一想...

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-10T15:29:57.560

即将发布的 PHP 5.3.0 版本包括[后期静态绑定](http://uk.php.net/oop5.late-static-bindings)，这可能会有所帮助。使用此功能，您可以在静态方法中使用静态变量，并让后期静态绑定负责找到“正确”的方法。

```
class Foo {
    public static function getDefault() {
        static $default = 'DEFAULT';
        return $default;
    }
    public static function doSomething ($param) {
        $default=static::getDefault(); // here is the late static binding
        $param = ($param === FALSE) ? $default : $param;
        return $param;

    }
}

class Bar extends Foo {
     public static function getDefault() {
        static $default = 'NEW DEFAULT FOR CHILD CLASS';
        return $default;
    }
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-10T15:30:19.573

为什么使用静态作为全局变量（在这种情况下是函数）的经典示例是一个坏主意，无论使用哪种语言。

最健壮的方法是创建抽象基“Action”类的多个实现子类。

然后尝试消除实例化类实例只是为了调用它的方法的一些烦恼，您可以将它包装在某种工厂中。

例如：

```
abstract class AbstractAction {
  public abstract function do();
}

class FooAction extends AbstractAction {
  public function do() {
    echo "Do Foo Action";
  }
}

class BarAction extends AbstractAction {
  public function do() {
    echo "Do Bar Action";
  }
} 
```

然后创建一个工厂来“帮助”函数的实例化

```
class ActionFactory {
  public static function get($action_name) {
    //... return AbstractAction instance here
  }  
} 
```

然后将其用作：

```
ActionFactory::get('foo')->do(); 
```

# c++ - 表达式的有效值是多少 (uninitialized_bool ? 1 : 2)？

> ID：532755
> 
> 赞同：1
> 
> 时间：2009-02-10T15:20:07.040
> 
> 标签：c++, initialization

根据标准，以下有效输出的集合是什么？

```
bool x;
cout << (x ? 1 : 2); 
```

编辑：**未知（谷歌）**已经得到它。`sprite.setFrame(isPressed ? 0 : 1)`在 gcc 中，由于条件返回 28，我的代码崩溃了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T15:22:54.503

如果 x 未初始化，则它可以为真或假。所以有效的输出是 1 或 2。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T15:29:08.297

[“++?????++ Out of Cheese Error。从头开始重做。”](http://en.wikipedia.org/wiki/Hex_(Discworld))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T15:23:49.930

使用未初始化的变量是未定义的。所以任何事情都可能发生

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T15:30:39.917

> 以本标准描述为“未定义”的方式使用布尔值，例如通过检查未初始化的自动变量的值，可能会导致它的行为既不是真也不是假。

欢迎来到未定义行为的世界。但首先，你为什么要这样做？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T15:32:57.523

任何事情都可能发生，包括 fireTheMissiles()。

# svn - 从 SVN 用户的角度来看，最常见的 CVS 陷阱

> ID：532758
> 
> 赞同：10
> 
> 时间：2009-02-10T15:21:11.047
> 
> 标签：svn, version-control, cvs

我自己是一个颠覆用户，总体上对它非常满意。但是，有时我需要处理存储在我无法控制的 CVS 存储库中的代码（即，一些开源项目）。我听过很多关于为什么 CVS 确实存在缺陷的恐怖故事，但没有什么非常具体的，我想避免自己陷入此类错误 :-)

我想知道您是否可以列举出在访问和使用 CVS 上的代码库时可能出现的所有问题和潜在问题，以及如何处理它们。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T15:25:52.610

*   CVS 不版本移动和重命名
*   它不版本符号链接
*   *最重要的是，IMO* - 不支持原子提交
*   昂贵且违反直觉的分支
*   默认情况下将所有文件视为文本
*   对 Unicode 的有限支持

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T15:43:44.190

CVS 中有一些与目录相关的怪异之处。

*   您不能真正删除目录。它粘在身边
*   “cvs update”不会给你带来新创建的目录。您必须添加“-d”选项

您会错过的另一件事是类似“svn revert”的工作，无需访问服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T15:53:55.070

您不能移动目录 - 您必须在**存储库**中手动移动它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T15:25:17.917

合并和分支通常是 CVS 的难点。

# exchange-server - 如何连接到多个 Exchange 服务器？

> ID：532764
> 
> 赞同：3
> 
> 时间：2009-02-10T15:22:27.953
> 
> 标签：exchange-server

我在一个客户站点工作，并通过网络邮件连接到他们的 Exchange 2000 服务器。我正在运行 Outlook 2007，并且通过 HTTP 连接到我的公司 Exchange 2007。

除了 Web 邮件，还有什么方法可以连接到客户端的 Exchange 2000 服务器？理想情况下，Outlook 2007 能够做到这一点，但我认为这是不可能的。POP 不是一个选项，因为我需要日历。

谢谢，

扎克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T00:37:15.700

不幸的是，Outlook 2007 每个配置文件只能连接到一台 Exchange 服务器。要获得此功能，您可以升级到 Outlook 2010。Outlook 2010 将毫无问题地连接到单个配置文件中的多个 Exchange 服务器。

作为一名顾问，我需要一直连接到多个电子邮件帐户——我当前的配置文件配置为连接到我的公司 Exchange 服务器、客户的 Exchange 服务器、两个不同的 Office 365 (Exchange Online) 帐户、两个不同的 Google应用程序帐户和 Hotmail 帐户。我喜欢能够通过本机 Outlook 2010 UI 在我经常使用的所有不同电子邮件帐户之间轻松导航；我永远无法回到多个浏览器窗口和 Outlook 配置文件！

*[我意识到这是一个“过时”的问题，但我注意到它出现在有关该主题的搜索中，因此我发布此答案，因为此信息未反映在任何早期答案中。]*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T17:08:32.393

您始终可以使用多个 Outlook 配置文件。

[http://office.microsoft.com/en-us/outlook/HA011471581033.aspx](http://office.microsoft.com/en-us/outlook/HA011471581033.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-05T08:27:01.087

有一种方法可以打开运行 2 个不同配置文件的 2 个 Outlook 实例。

请查看此链接-> [http://www.pcauthority.com.au/Feature/136036,server-101-access-multiple-exchange-servers-with-outlook.aspx](http://www.pcauthority.com.au/Feature/136036,server-101-access-multiple-exchange-servers-with-outlook.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-26T16:40:17.217

Apple 的邮件客户端将一次连接到任意数量的 Exchange 服务器。我相信 Open Source Evolution 邮件客户端也会这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T17:05:32.387

我不认为 Outlook 将允许超过 1 个交换服务器连接。一种选择是使用另一个电子邮件客户端（如雷鸟）连接到另一个交换服务器 [虽然我还没有尝试过]。如果您需要知道如何配置 thnderbird 以连接到 Exchange 服务器，这里有一个[链接](http://www.downloadsquad.com/2007/03/30/howto-thunderbird-and-ms-exchange-server/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T17:10:20.737

您可以在 Outlook 中创建多个配置文件。您将无法同时打开它们，但您可以将 Outlook 设置为在启动时询问您要打开的个人资料。

这是一个旧链接，但如果处理 2003 年或 2007 年，过程基本相同。 [http://www.cod.edu/it/howdoi/profiles/](http://www.cod.edu/it/howdoi/profiles/)

嗯……

安德烈斯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T17:11:25.460

对于 Exchange 2000，只能使用 Outlook Web Access 或 POP/IMAP 进行外部访问。在 Exchange 2003 和 2007 中，您可以使用使用 RPC 的 Outlook 客户端进行连接，但在 2000 中则不能。另一方面，Outlook 中只能有 1 个 Exchange 连接，因此您必须使用多个配置文件。

# c# - ASP.Net MVC：可以覆盖 AuthorizeAttribute 吗？

> ID：532773
> 
> 赞同：3
> 
> 时间：2009-02-10T15:23:54.877
> 
> 标签：c#, asp.net, asp.net-mvc

我当前的项目是一个使用 ASP.Net MVC 构建的内部 Web 应用程序，我正在向其中添加身份验证。我有一个预先构建的 HTTPModule，它创建了一个具有适当角色的 IPrincipal。如果用户未通过身份验证，我将获得一个角色为“Public”的用户对象

由于这是一个内部应用程序，大多数页面都是私有的，只有“管理员”角色才能查看。因为我有一个基本控制器，所以我可以这样做：

```
[Authorize(Roles="Admin")]
public abstract class MyControllerBase : Controller
{
    ...
} 
```

我有一个问题，因为某些操作可以在公共网站上查看，如果我将它们归为这样：

```
[Authorize(Roles="Public")]
public class LoginController : MyController
{
    public ActionResult Index()
    {

    }
} 
```

由于用户未通过身份验证，页面无法加载。看起来“公共的角色在继承的类上被忽略了。有谁知道这些角色是否可以被继承的类覆盖？

我还试图避免将所有控制器归为 Roles="Admin"

谢谢，基思。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T15:51:32.797

您可以从 AuthorizeAttribute 派生新属性并覆盖 OnAuthorization 方法，然后应用您的自定义属性而不是 Authorize。下面是来自我的自定义属性之一的 OnAuthorization 方法，如果权限不够，它会重定向到错误页面，而不是重定向到登录页面。

不过，我不确定这会给你带来什么。当你用属性装饰你的类时，大概你必须同时允许 Admin 和 Public （所以你在限制谁，因为 Public 是没有经过身份验证的人？）。然后，您必须装饰每个需要单独限制为 Admin 的控制器方法，因为 class 属性将允许访问。您可以使用常规 Authorize 属性来实现此行为，只需装饰那些非公开可用的方法（或没有公开可用方法的类）。

我想你可以检查你的属性，看看被调用的方法是否也用属性修饰，然后简单地批准授权，这将有效地将授权推迟到方法级别。您可能必须查看 AuthorizationContext 上的 RouteData 以获取操作并使用反射来尝试根据参数和请求类型找到适当的方法。

```
 public override void OnAuthorization( AuthorizationContext filterContext )
    {
        if (filterContext == null)
        {
            throw new ArgumentNullException( "filterContext" );
        }

        if (AuthorizeCore( filterContext.HttpContext ))
        {
            SetCachePolicy( filterContext );
        }
        else if (!filterContext.HttpContext.User.Identity.IsAuthenticated)
        {
            // auth failed, redirect to login page
            filterContext.Result = new HttpUnauthorizedResult();
        }
        else
        {
            ViewDataDictionary viewData = new ViewDataDictionary();
            viewData.Add( "Message", "You do not have sufficient privileges for this operation." );
            filterContext.Result = new ViewResult { MasterName = this.MasterName, ViewName = this.ViewName, ViewData = viewData };
        }

    }

    protected void SetCachePolicy( AuthorizationContext filterContext )
    {
        // ** IMPORTANT **
        // Since we're performing authorization at the action level, the authorization code runs
        // after the output caching module. In the worst case this could allow an authorized user
        // to cause the page to be cached, then an unauthorized user would later be served the
        // cached page. We work around this by telling proxies not to cache the sensitive page,
        // then we hook our custom authorization code into the caching mechanism so that we have
        // the final say on whether a page should be served from the cache.
        HttpCachePolicyBase cachePolicy = filterContext.HttpContext.Response.Cache;
        cachePolicy.SetProxyMaxAge( new TimeSpan( 0 ) );
        cachePolicy.AddValidationCallback( CacheValidateHandler, null /* data */);
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T14:48:26.263

最后，我认为我的答案就在问题中。我没有将 Authorize 属性放在我的基本控制器上，而是派生了一个新的 AdminBaseController。

```
[HandleError]
public abstract class MyControllerBase : Controller
{
    ...
}

[Authorize(Roles="Admin")]
public abstract class AdminControllerBase : MyControllerBase
{
    ....
} 
```

现在任何需要身份验证的控制器都可以从 AdminControllerBase 派生，而我的公共控制器可以从 MyControllerBase 派生。OO来救援。

# windows - 是否可以在 Windows 环境中限制文件夹大小？

> ID：532775
> 
> 赞同：14
> 
> 时间：2009-02-10T15:23:57.093
> 
> 标签：windows, directory

是否可以限制 Windows 中的文件夹大小，以便当用户尝试写入已满的文件夹时，他会收到错误消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T22:41:41.500

请记住，磁盘配额是每个用户而不是每个文件夹，还有其他解决方案可以让您锁定文件夹大小而不管用户如何，我的经验是使用 Veritas Storage Exec，但它似乎已停止使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T15:26:07.087

您是指如[http://www.windowsnetworking.com/articles_tutorials/Configuring-Disk-Quotas-Windows-2003.html中所述的](http://www.windowsnetworking.com/articles_tutorials/Configuring-Disk-Quotas-Windows-2003.html)**磁盘配额**吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T15:26:38.020

查看 NTFS 文件系统的[配额](http://www.google.co.uk/search?q=ntfs+quota)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T02:23:55.733

[Windows Server 2008 Administrator's Companion](http://technet.microsoft.com/en-us/library/dd163561.aspx)建议使用[文件服务器资源管理器](http://technet.microsoft.com/en-us/library/cc754810%28v=WS.10%29.aspx)而不是旧的“磁盘配额”功能，因为这些功能允许按目录设置。（我自己对这个工具并不熟悉；玩了 5 分钟后，我仍然不知道如何实际执行此操作。但是，“配额”肯定有一个专栏。）

另一个技巧是创建一个新卷，然后使用符号链接（请参阅[MKLINK](http://technet.microsoft.com/en-us/library/cc753194%28v=ws.10%29.aspx)）将目录映射到该卷。（MKLINK 是 Vista/2008 和更高版本；对于 XP/2003，使用[NTFS 连接](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T15:28:13.400

这取决于您想要的限制程度。:)

例如，编写一个侦听/监视文件夹并在用户超出配额时显示消息框错误/警告的程序并不难。但这并不能*阻止*他超越它——只是通知他他这样做了。

# delphi - Delphi 2009 图像列表和图像中的 PNG

> ID：532777
> 
> 赞同：4
> 
> 时间：2009-02-10T15:24:22.863
> 
> 标签：delphi, png, delphi-2009, imagelist

D2009 引入了对图像和图像列表的 PNG 支持。

然而...

我有一个包含带有 alpha 的 png 图像的图像列表。我想使用 TImage 将其中一个放在表单上。我该如何做到这一点并得到很好的合成图像？

作为我面临的问题的一个例子，下面的代码无法正常工作，并产生所示的效果：

```
ImageList.GetBitmap(index, Image1.Picture.Bitmap); 
```

[![替代文字](https://i.stack.imgur.com/MNUal.jpg)](https://i.stack.imgur.com/MNUal.jpg)
[（来源：[clip2net.com](http://clip2net.com/clip/m0/1234439882-clip-5kb.png)）]

再解释一下：

将 Timage 拖放到表单上，并在设计时使用 Picture 属性加载带有 alpha 的 PNG 文件。请注意它是如何以完全透明的方式正确合成到表单上的。

现在，在设计时，添加第二个空的 Timage，添加一个 TImagelist，并将相同的 PNG 添加到 imagelist。如何将 TImageList 中的 PNG 分配给第二个 TImage，并让它看起来与第一个相同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T20:04:14.750

根据我的研究，我发现 TImageList 将图像存储为 TBitmaps，因此 alpha 信息在存储时会丢失，并且您无法通过当前的 TImageList 实现来实现您正在寻找的内容。

**更新：**

更多的实验和下面的代码我可以使用下面的代码使透明度工作。

```
ImageList1.ColorDepth := cd32Bit;
Image2.Transparent := True;
Image2.Canvas.Pen.Style := psClear;
Image2.Canvas.Rectangle(0, 0, Image2.Width+1, Image2.Height+1);
ImageList1.Draw(Image2.Canvas, 0,0,0); 
```

但它看起来不像加载的 png 那样漂亮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-09T19:06:31.830

*在项目 -> 选项 -> 应用程序选项卡*的选项卡中检查启用运行时主题

 *这解决了我在 RAD Studio 2010 中的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T13:55:16.810

我偶然发现了这个讨论线程：

[D2009 TImageList 中的透明 PNG](https://forums.codegear.com/thread.jspa?threadID=3172&tstart=0)

> @Pekka Nyyssonen：将 ColorDepth 设置为 cd32Bit 并将 DrawingStyle 设置为 dsTransparent 对我有用。

我自己无法访问delphi 2009，所以我没有尝试过，不过......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T21:30:54.540

我只是尝试了一个简单的测试。TImageList 包含一个具有透明度的 PNG 图像。我使用以下方法在第二个 TImage 上渲染图像：

imlImageList.Draw(img2.Canvas, 0, 0, 0);

对我来说不同的是设置 img2.Transparent := true （我使用了设计器，而不是代码）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-14T19:50:07.993

有几种方法可以将透明图像添加到图像列表中。

使用 AddMasked 或 InsertMasked，您可以添加图像并将颜色标记为透明颜色：

```
procedure InsertMasked(Index: Integer; Image: TBitmap; MaskColor: TColor);
function AddMasked(Image: TBitmap; MaskColor: TColor): Integer; 
```

使用插入或添加，您可以添加图像和蒙版。如果 2 色（黑/白）图像仅使用图像中的白色像素，则遮罩，其他是透明的。

```
function Add(Image, Mask: TBitmap): Integer;
procedure Insert(Index: Integer; Image, Mask: TBitmap); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T17:48:49.410

据我所知，这是无法实现的。给出的任何建议都不会产生正确的 alpha 混合图像，这是主要要求。

也许通过定义一个从 TImageList 派生的类，然后它可以访问受保护的方法，可以开始工作。我现在的解决方案是为此专门使用第三方自定义 ImageList 组件。

# c++ - 有没有类似 GhostDoc for C++ 的东西

> ID：532779
> 
> 赞同：10
> 
> 时间：2009-02-10T15:24:57.480
> 
> 标签：c++, ghostdoc

当我使用 C# 进行开发时，我大量使用 GhostDoc 来加快注释我的代码的过程。我目前正在开发一个 C++ 项目，但我还没有找到等效的工具。我知道 Doxygen，但据我所知，它用于在代码之外创建文档，而不是在代码中创建注释。有没有好的等效工具？我更喜欢在 VS 中运行的一种，但我可以处理在任何 IDE 中运行的一种。

（在有人提出之前，我不仅仅依靠 GhostDoc 来创建评论。我只是用它来创建我的评论的起点。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-28T21:38:53.823

我编写了一个插件**[Atomineer Pro Documentation](http://www.atomineerutils.com/)**，它与 GhostDoc 非常相似（它生成/更新文档注释以在编写文档时节省大量时间和精力），但它直接为自己解析代码，因此能够处理 C、C++、C++/CLI、C#、Java 和 Visual Basic 代码，并且不需要周围的代码在它工作之前处于编译状态。它还将自动添加/更新文档以处理更棘手的事情，例如在方法体中抛出的异常。

它在 Visual Studio 11、2010、2008 和 2005 下运行，并支持 Documentation-Xml、Doxygen、JavaDoc 和 Qt 注释格式，以及注释块的格式/样式和使用的高度可配置的自动文档规则。它还有许多其他方便的功能，例如帮助将遗留文档注释转换为上述格式，以及文档注释和普通块注释中的自动换行。

以上只是一些关键功能的摘要 -与其他产品[的功能比较](http://www.atomineerutils.com/compare.php)可作为许多其他可用功能的更完整列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T19:05:30.193

[Visual Assist](http://www.wholetomato.com/)通过提供在键入（或其他）时执行的自定义脚本来提供帮助。

例如，您可以为这样的注释编写脚本：

```
/************************************************************************/
/* My comment : $end$                                                                     */
/************************************************************************/ 
```

例如，当您开始输入“/**”时，会建议（通过与智能感知完全相同的组合框）。当您选择此建议时（通过 Enter/Space/Click - 可自定义），它将在您的光标所在的位置插入脚本，并将“$”字符之间的标记替换为特殊值（例如当前文件名）。此处的 $end$ 标记将使光标在脚本执行时位于此位置。这样，您可以继续流畅地打字。例如，对于前面的脚本集，准确键入：

```
/** this is a test comment to show you one of the many features Visual Assit! 
```

只会给出：

```
/************************************************************************/
/* My comment : this is a test comment to show you one of the many features Visual Assit!                                                                     */
/************************************************************************/ 
```

它非常容易定制，并且建议（阅读：intellisense++）系统的行为是可定制的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T15:27:00.173

[Visual Assist](http://www.wholetomato.com/)可能会完成这项工作，但我不确定。

# c++ - CATIA-CAA CATKeyboardEvent

> ID：532780
> 
> 赞同：1
> 
> 时间：2009-02-10T15:25:16.917
> 
> 标签：c++, events, keyboard, catia, caa

我知道世界上只有少数 CAA 程序员，但我还是尝试了一下……

我无法让键盘事件起作用。我发现这段代码看起来很合理，但通知不会触发。

```
AddAnalyseNotificationCB(CATFrmLayout::GetCurrentLayout()->GetCurrentWindow()->GetViewer(),
                        CATKeyboardEvent::ClassName(),
                        (CATCommandMethod)&PROTrvTreeView::OnKeyboardEvent, NULL);

void PROTrvTreeView::OnKeyboardEvent(CATCommand * ipCmd, CATNotification * ipEvt, CATCommandClientData iobjData) {
    cout<< "KeyboardEvent" <<endl;
} 
```

有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T01:53:09.840

CAA 的开发人员群体更加密集：

[http://www.3ds.com/alliances/c-java-developers/forum/](http://www.3ds.com/alliances/c-java-developers/forum/)

同样的问题出现了，有几个人提到这个 API 是未经授权的，因此你不能依赖它，即使它有效。

那里的其他示例与您的代码基本相同，但唯一声称可以工作的示例不使用 CATKeyboardEvent::ClassName，而是使用“CATKeybdEvent”。也许值得尝试一下。

# ruby-on-rails - Rails 部分的依赖关系图

> ID：532790
> 
> 赞同：9
> 
> 时间：2009-02-10T15:27:28.363
> 
> 标签：ruby-on-rails, ruby

在我当前的 Ruby on Rails 视图中，我们有许多视图和部分视图。事实上太多了，不清楚哪个视图使用哪个部分（它本身也可能使用其他部分）。

问题是是否有一个工具可以生成所有视图和部分的依赖图（理想情况下生成一个图，但这很容易做到）或者你是如何解决这个问题的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T11:50:17.143

我创建了一个插件（基本上只是一个 rake 任务），它为您生成一个包含所有视图和部分依赖项的图形。

在[http://github.com/msales/partial_dependencies/tree/master获取](http://github.com/msales/partial_dependencies/tree/master)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T17:10:05.793

阅读所有视图和局部视图并动态创建有向图应该相对简单，唯一需要注意的是循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T16:58:00.393

[Noisy Partials](http://github.com/gwynm/noisy_partials)可能是您所需要的（尽管我实际上并没有尝试过）。

# c# - QueueUserWorkItem() 和 BeginInvoke() 之间有什么区别，用于执行不需要返回类型的异步活动

> ID：532791
> 
> 赞同：17
> 
> 时间：2009-02-10T15:27:30.047
> 
> 标签：c#, multithreading, delegates

继我的 BeginInvoke()/EndInvoke() 问题之后，Delegate.BeginInvoke() 和使用 QueueUserWorkItem() 异步调用委托之间在性能/其他方面是否存在重大差异？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-10T15:33:49.610

我能想到的主要事情`QueueUserWorkItem`是你必须使用`WaitCallback`委托类型，如果你已经有一个实例和一些参数，这*看起来很棘手。*`SomeRandomDelegate`好消息是你可以用闭包来解决这个问题：

```
ThreadPool.QueueUserWorkItem(
    delegate { someDelegate(arg1, arg2); }
); 
```

此模式还确保您在编译时获得正确的强类型（与将`object`状态 arg 传递给`QueueUserWorkItem`目标方法并将其强制转换不同）。直接调用方法时也可以使用此模式：

```
ThreadPool.QueueUserWorkItem(
    delegate { SomeMethod(arg1, arg2); }
); 
```

显然，如果没有`EndInvoke`等效项，除非您在方法结束时调用方法/引发事件/等，否则您也无法获得返回值……在相关说明中，您需要小心处理[异常](https://stackoverflow.com/questions/532282/532293#532293).

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-10T15:46:56.163

[http://blogs.msdn.com/cbrumme/archive/2003/07/14/51495.aspx](https://web.archive.org/web/20090201230346/http://blogs.msdn.com/cbrumme/archive/2003/07/14/51495.aspx)

说：

> “一个令人惊讶的事实是，这也是 Delegate.BeginInvoke / EndInvoke 与 ThreadPool.QueueUserWorkItem（或 UnsafeQueueUserWorkItem，如果您了解安全隐患并希望真正高效）相比如此缓慢的原因。BeginInvoke / EndInvoke 的代码路径快速变成通用远程处理路径的通用消息处理代码。”

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-10-18T17:41:36.977

EndInvoke() 有一个有用但很少提及的行为 - 它重新抛出委托在原始线程的上下文中生成的所有未处理的异常，因此您可以将异常处理逻辑移动到主代码中。

此外，如果您的委托具有 out/ref 参数，它们将被添加到 EndInvoke() 签名中，允许您在方法完成执行时获取它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-10-23T00:36:23.787

如果您调用 ThreadPool.QueueUserWorkItem，工作项中引发的异常将在后台线程上未处理（除非您明确捕获它们）。在 .Net 2 及更高版本中，这将终止您的 AppDomain。

如果您调用 delegate.BeginInvoke()，则异常会排队等待在调用 EndInvoke() 时重新抛出。如果您从不调用 EndInvoke()，则异常本质上是“泄漏”内存（与异步操作未释放的任何其他状态一样）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-10T15:34:40.500

应该没有什么大的区别，我也认为为委托生成的BeginInvoke/EndInvoke是使用线程池来执行的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-10T15:36:00.980

应该没有任何性能差异，因为 Delegate.BeginInvoke 和 ThreadPool.QueueUserWorkItem 都将在线程池线程上执行。

最大的不同是，如果您调用 BeginInvoke，您必须在某个时候调用 EndInvoke。相比之下，ThreadPool.QueueUserWorkItem 是“一劳永逸”。这有好处也有坏处。好处是你可以忘记它。缺点是您无法知道任务何时完成，除非您添加自己的同步/通知机制。

# c# - 显示 resx 文件中的所有资源字符串

> ID：532802
> 
> 赞同：1
> 
> 时间：2009-02-10T15:30:11.553
> 
> 标签：c#, winforms, user-interface, resources, internationalization

我的应用程序中有一个“GUI 字符串”.resx 文件，其中包含我显示的所有字符串。我显然可以通过直接访问每个字符串 `Resources.Resource_GUI_Strings.CameraSettings_BrightnessLabel`

但是如何列出 .resx 文件中的所有设置，作为它们的（名称，值）对，是我使用反射的唯一选择吗？

我想列出所有对（即 CameraSettings_BrightnessLabel 和“Brightness”），以便用户可以编辑每个项目的字符串。这样他们就可以本地化 GUI。我不想完全国际化应用程序，要求只是让用户能够自己做。

所以我需要能够从 .resx 文件中读取成对的值，然后在用户编辑它们时将它们写回。

只是添加我想在运行时在应用程序本身内部执行此操作，因此我无法解析磁盘上的 .resx 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T16:21:26.173

通常我会使用[ResXResourceReader](http://msdn.microsoft.com/en-us/library/system.resources.resxresourcereader.aspx)和[ResXResourceWriter](http://msdn.microsoft.com/en-us/library/system.resources.resxresourcewriter.aspx)类，但我猜你的 resx 文件将在运行时被锁定。您最好将文本存储在数据库中而不是资源文件中来解决这个问题。

[此答案](https://stackoverflow.com/questions/528218/localise-asp-net-2-0-app/528320#528320)显示了如何使自定义资源提供者/资源管理器在数据库中存储/编辑资源。或者，您可以完全放弃资源模型并推出自己的解决方案。

# iphone - 如何禁止 UITextview 中的某些字符

> ID：532804
> 
> 赞同：1
> 
> 时间：2009-02-10T15:30:28.807
> 
> 标签：iphone, cocoa-touch

我有一个可编辑的 uitextview，但我不想输入某些字符。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T15:40:10.720

您可以通过为 UITextView 分配一个委托并在委托中实现以下方法来做到这一点：

```
-(BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text; 
```

在正文中只需编写一些代码，扫描输入文本以查看是否找到要过滤的字符，如果看到则返回 NO，否则返回 YES。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T18:07:38.223

不幸的是，这并不是那么简单，因为`textView:shouldChangeTextInRange: replacementText:`不一定要用单字符的字符串来调用。它用于键盘输入，但不适用于粘贴或使用语音识别输入文本时。

那么，如果用户粘贴（或指示）包含禁止字符的字符串，您想做什么？您可能希望让所有有效文本都通过并且只删除（或替换）不需要的字符。

错误的想法是修复`textViewDidChange:`委托例程中的文本。虽然这似乎可行，但它以某种方式阻止语音输入在`UITextView`.

正确的想法是`textView:shouldChangeTextInRange: replacementText:`使用全过滤来实现。这是一个过滤掉换行符的示例实现：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text
{   
    if([text isEqualToString:@"\n"]) {
        [textView resignFirstResponder]; // dismiss keyboard
        return NO;
    }

    text = [text stringByReplacingOccurrencesOfString:@"\n" withString:@" "];   // replace by spaces

    NSString *fullText = [textView.text stringByReplacingCharactersInRange:range withString:text];
    textView.text = fullText;

    return NO;
} 
```

请注意，当用户按下回车键时，它会关闭键盘。但不是很完美：当用户粘贴一个换行符时，它也会关闭键盘。这可能是一个问题，但这应该很少发生。

# sql - 如何查看sql二进制数据字段的内容？

> ID：532815
> 
> 赞同：16
> 
> 时间：2009-02-10T15:32:08.087
> 
> 标签：sql, binary-data, sql-server-2005-express

有人知道如何查看 MS SQL Server 2005 数据库中包含二进制数据的字段内容吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-10T15:41:01.217

取决于它是否只是以二进制形式存储的文本，如果是，那么看看这个

```
create table #bla (col1 varbinary(400))

insert #bla values(convert(varbinary(400),'abcdefg'))

select col1,convert(varchar(max),col1)
from #bla 
```

输出 0x61626364656667 abcdefg

# c# - 使用 linq 读取属性值

> ID：532816
> 
> 赞同：3
> 
> 时间：2009-02-10T15:32:09.897
> 
> 标签：c#, linq, linq-to-xml

我有一个如下所示的 xml 文件。我要做的是创建一个查询，该查询仅选择具有“Channel”属性和“Automotive”值的项目。

```
<item>
      <title>Industries</title>
      <category type="Channel">Automotive</category>
      <category type="Type">Cars</category>
      <category type="Token">Article</category>
      <category type="SpecialToken">News</category>
      <guid>637f0dd7-57a0-4001-8272-f0fba60feba1</guid>
</item> 
```

这是我的代码

```
 var feeds = (from item in doc.Descendants("item")
    where item.Element("category").Value == "Channel"  
    select new { }).ToList(); 
```

我尝试使用 item.attribute 方法，但我无法获得项目中的值，只有“类型”的属性值

有人可以帮我解决这个问题吗？

干杯，克里斯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T15:39:07.133

我怀疑你想要：

```
var feeds = (from item in doc.Descendants("item")
             from category in item.Elements("category")
             where category.Value=="Automotive" && 
                   category.Attribute("type").Value == "Channel"
             select item).ToList(); 
```

# .net - .Net 的字符串模板化引擎

> ID：532827
> 
> 赞同：2
> 
> 时间：2009-02-10T15:35:43.070
> 
> 标签：.net, templates, template-engine

我已经满足了将模板化内容与生成填充该内容的动态字段的代码分开存储的需求（想想 word 中的邮件合并）。用例通常围绕这样一个事实，即我想编写可以发送某种类型的动态内容（通常是电子邮件）的代码，我希望允许我的用户在不更改任何代码的情况下对其进行自定义。

例如，我们向客户发送电子邮件。我们最终会调整发送出去的电子邮件并添加动态内容（例如，我们可能想说“亲爱的 {Contact.FirstName}”）。将这些电子邮件的格式放入数据库或一些 XML 文件中并编写代码分别为其提供所有属性的值是很方便的。因此，创建一个包含内容的 Email.XML，并使用一个引擎将 XML 文件传递​​给 Contact 对象并返回电子邮件的 HTML。从概念上讲，这与在 MVC 模式中分离视图层的目标非常相似（在这种情况下，电子邮件是视图，引擎是控制器，联系人对象是模型）。

看起来 .Net 领域有两个竞争者（都是 java 的端口）（这里还有更多[，](http://csharp-source.net/open-source/template-engines)但他们是相当小众的玩家）。

*   [字符串模板.Net](http://www.stringtemplate.org/)
*   NVelocity（[原始项目](http://nvelocity.sourceforge.net/)，[城堡项目的分支](http://castleproject.org/others/nvelocity/index.html)）

有没有人使用过这些或其他模板化引擎？在选择时我应该考虑它们之间的主要区别吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T17:35:18.447

我使用过[StringTemplate.NET](http://www.stringtemplate.org/)并且很享受这种体验。他们花了一点时间来适应他们的世界观——像循环这样的事情一开始似乎很神秘。不允许模板调用代码类型违背了大多数其他模板库的纹理。但是一旦你习惯了，他们的决定就会变得有意义并且感觉很自然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T16:21:41.867

我刚刚使用了 RegEx.Replace，对于在 { 和 } 之间找到的每个匹配项，我在 Dictionary<,> 中查找标签并执行 ITagParser。

亲爱的 {Salutation} {FamilyName}

当前日期是 {Now=yyyy-MM-dd}

其中 = 是可选格式。

证明 3rd 方图书馆的工作太少了。

# php - PHP 正则表达式问题

> ID：532850
> 
> 赞同：0
> 
> 时间：2009-02-10T15:42:28.670
> 
> 标签：php, regex

是否可以像`<?php echo $variable ?>`在 PHP 文件中一样制作一个读取 {variable} 的正则表达式？

谢谢

雷米

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T15:53:05.807

PHP 手册已经[为变量名提供了一个正则表达式](http://docs.php.net/manual/en/language.variables.basics.php)：

```
[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]* 
```

您只需将其更改为：

```
\{[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*\} 
```

你完成了。

* * *

**编辑**   您应该知道，[罗斯提出](https://stackoverflow.com/questions/532850/php-regex-question/532937#532937)的此类事件的简单顺序替换可能会导致一些不需要的行为，例如替换也包含此类变量。

因此，您应该更好地解析代码并分别替换这些变量。一个例子：

```
$tokens = preg_split('/(\{[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*\})/', $string, -1, PREG_SPLIT_DELIM_CAPTURE);
for ($i=1, $n=count($tokens); $i<$n; $i+=2) {
    $name = substr($tokens[$i], 1, -1);
    if (isset($variables[$name])) {
        $tokens[$i] = $variables[$name];
    } else {
        // Error: variable missing
    }
}
$string = implode('', $tokens); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T16:04:12.923

听起来您正在尝试进行一些模板变量替换；）

我建议首先收集你的变量，例如在一个数组中，然后使用类似的东西：

```
// Variables are stored in $vars which is an array
foreach ($vars as $name => $value) {
    $str = str_replace('{' . $name . '}', $value, $str);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T16:22:44.813

> （[在评论中](https://stackoverflow.com/questions/532850/php-regex-question/532865#532865)）我希望能够输入`{variable}` 而不是`<?php echo $variable ?>`

*原始方法*：您可以使用外部程序（例如 Python 脚本）来预处理您的文件，进行以下正则表达式替换：

```
"{([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)}" 
```

和

```
"<?php echo $\g<1> ?>" 
```

*更好的方法*：在您的 IDE 或代码编辑器中编写一个宏来自动为您进行替换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T15:47:50.967

{实际上不是答案，但需要澄清}

你能扩展你的问题吗？您想对 $variable 的内容应用正则表达式吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T15:49:25.253

以下行应将所有出现的字符串 ' `{variable}`' 替换为全局变量的值`$variable`：

```
$mystring = preg_replace_callback(
  '/\{([a-zA-Z][\w\d]+)\}/', 
  create_function('$matches', 'return $GLOBALS[$matches[1]];'), 
  $mystring); 
```

**编辑：**将此处使用的正则表达式替换为 Gumbo 提到的正则表达式，以精确捕获所有可能的 PHP 变量名称。

# asp.net - ASP.NET MVC 等效于 ASP.NET WebForms 中的“覆盖 void Render”

> ID：532856
> 
> 赞同：3
> 
> 时间：2009-02-10T15:45:16.790
> 
> 标签：asp.net, asp.net-mvc, render

什么是 ASP.NET MVC 等效于 ASP.NET WebForms 中的“覆盖无效渲染”？在将输出发送给客户之前，您在哪里有机会进行最后一分钟的处理？

例如，我不会在生产代码中使用它，但会说明当放置在 WebForms 应用程序的 MasterPage 中时清理整个站点`<title>`的`<head>`标记。

```
 protected override void Render(HtmlTextWriter writer)
    {
        System.IO.StringWriter sw = new System.IO.StringWriter();
        HtmlTextWriter htw = new HtmlTextWriter(sw);
        base.Render(htw);
        htw.Close();
        string h = sw.ToString();
        string fhtml = h.Replace("<title>\r\n\t", "\n<title>")
                             .Replace("\r\n</title>", "</title>")
                             .Replace("</head>","\n</head>");
        // write the new html to the page
        writer.Write(fhtml);
    } 
```

在 ASP.NET MVC 中使用最终文本呈现的最佳方法是什么？

**更新：**
因此，查看 Andrew Hare 提到的链接（图表），您可以在 View Engine 中执行此操作。你能把东西固定到或改变默认视图引擎的工作方式，还是你必须更换整个东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T15:49:10.493

这不是 MVC 的工作方式。

您所有的“onprerender”代码都在视图中完成。当您将数据从控制器传递到视图时，您应该已经完成​​了显示整个页面所需的所有处理。

唯一的例外是模型在被视图探测时可能仍会做一些处理。

这可能包括设置局部打开或关闭所需的变量等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T15:59:37.210

据我所知，您在 - 方法中唯一想做的`Render()`就是重新排列该`<head>`部分中的一些标签。这已经为您在 中正确完成`MVC`，除非您使用某种自制方式`<head>`在`Masterpage`.

我建议将标签完全按照您希望它们直接在`html`您的标记中的方式对齐`Master`，并确保`ViewData["title"]`您用来填充标签的内容不以换行符开头或结尾。

# xml - 可以在 XSLT 中模拟 StringBuilder 吗？

> ID：532859
> 
> 赞同：4
> 
> 时间：2009-02-10T15:46:25.947
> 
> 标签：xml, xslt

我正在尝试在 XSL 中模拟 StringBuilder 行为。有没有办法做到这一点。考虑到 XSLT 是一种函数式编程语言，这似乎很难

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T15:54:54.507

看看[`concat()`](http://www.w3.org/TR/2002/WD-xquery-operators-20021115/#func-concat)and[`string-join()`](http://www.w3.org/TR/2002/WD-xquery-operators-20021115/#func-string-join)函数，也许这就是你所追求的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T21:09:37.870

如果您正在查看节点集（只要您可以构造 xpath 来查找节点集），您只需一点点递归就可以非常简单地获得累积的 concats，这样做您可以添加任意位进进出出的流程开始变得混乱。

初学者试试这个（也加入）：

```
<xsl:template match="/">
     <xsl:variable name="s">
        <xsl:call-template name="stringbuilder">
            <xsl:with-param name="data" select="*" /><!-- your path here -->
        </xsl:call-template>
     </xsl:variable>
     <xsl:value-of select="$s" /><!-- now contains a big concat string -->
</xsl:template>

<xsl:template name="stringbuilder">
    <xsl:param name="data"/>
    <xsl:param name="join" select="''"/>
    <xsl:for-each select="$data/*">
        <xsl:choose>
            <xsl:when test="not(position()=1)">
                <xsl:value-of select="concat($join,child::text())"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="child::text()"/>
            </xsl:otherwise>
        </xsl:choose>       
    </xsl:for-each>
</xsl:template> 
```

可能需要对其进行各种扩展：也许您想要修剪，也许您还想要穿过层次结构。我不确定是否存在防弹的通用解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T17:26:19.857

**您可以使用所有可用的[标准 XPath 2.0 字符串函数](http://www.w3.org/TR/xpath-functions/#string-functions)**，例如[**`concat()`**](http://www.w3.org/TR/xpath-functions/#func-concat), [**`substring()`**](http://www.w3.org/TR/xpath-functions/#func-substring), [**`substring-before()`**](http://www.w3.org/TR/xpath-functions/#func-substring-before), [**`substring-after()`**](http://www.w3.org/TR/xpath-functions/#func-substring-after), **[`string-join()`](http://www.w3.org/TR/xpath-functions/#func-string-join)**, ... 等。

但是，**如果您需要非常快速的字符串实现（甚至比 .NET 字符串类更快），您可能会对[手指树数据结构](http://www.soi.city.ac.uk/~ross/papers/FingerTree.pdf)**的**[C# 实现](http://dnovatchev.spaces.live.com/Blog/cns!44B0A32C2CCF7488!582.entry)****以及**我为 Saxon XSLT 处理器[**提供的扩展函数**](http://dnovatchev.spaces.live.com/blog/cns!44B0A32C2CCF7488!672.entry)感兴趣包装基于手指树的字符串。

# visual-studio-2008 - 更改本地路径，团队资源管理器

> ID：532860
> 
> 赞同：9
> 
> 时间：2009-02-10T15:46:33.980
> 
> 标签：visual-studio-2008

有谁知道如何在团队资源管理器 2008 中更改下载项目的本地路径。我将项目下载到错误的目录，现在我将其删除并且确实是最新的，但我收到一条消息“所有文件都是最新的”

谢谢-米希尔

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T15:57:12.130

在源代码管理资源管理器中，单击“工作区：”下拉菜单中的“工作区...”选项。然后编辑您的工作区或设置一个新的。

当您收到您提到的消息时，您可以获取一个特定的-> 最新版本，并选中所有复选框。

# sql - SQL vs CODE，平衡点在哪里？

> ID：532875
> 
> 赞同：22
> 
> 时间：2009-02-10T15:51:11.677
> 
> 标签：sql

作为 CRUD 开发人员，需要做出的权衡之一是决定有多少工作应该在服务器上的 SQL 中完成，以及应该在客户端用代码完成多少。

**你如何决定支点在哪里？哪些因素会影响您的决定？你犯过什么样的错误？什么效果好？**

[编辑] 我对这个问题的回复量很少感到惊讶。我认为这是所有 CRUD 编程的基本问题。设置平衡的地方是性能和可维护性之间的权衡。

我没有真正考虑的另一个问题是域变化很大，答案可能需要在每个域的部分中表达。这就是我在回答中试图做的。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-10T16:06:58.783

我的优先事项：

1.  尽量减少数据库访问。如果可能，代码应该完成大部分工作，并且只在必要时访问数据库。当它这样做时，它应该尽可能多地满足当前操作的需要。

2.  最小化 SQL 复杂性。即使我们应该减少对数据库的访问，但这并不意味着构建一个过于复杂的 SQL 查询，该查询是非性能的并且做的太多。查询仍然需要维护，如果两个更简单的查询可以省去开发和维护一个大型查询的麻烦，那么应该使用额外的代码而不是更多的数据库工作。

3.  最小化代码列表迭代。代码很棒。一个放置业务逻辑的好地方，还有很多整洁的库函数。代码很棒。但是，如果使用代码意味着必须一遍又一遍地遍历从数据库返回的列表，其中一些简单的数据库 where 子句或连接可能会消除该工作，那么需要改进 SQL，并最小化代码。

这通常是根据具体情况而定的。对于长期存在的应用程序，维护是一项巨大的成本，而简单性通常会决定我的设计。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-10T16:02:07.873

数据库是保存数百万行表的地方，可以有效地对这些表进行读写。

数据库不是执行字符串操作或日期逻辑的地方。它不是计算余额或生成邮件的地方。使用其他工具（例如代码）可以更好地解决这些问题。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-10T16:20:19.000

任何与数据完整性有关的事情都应该在数据库中完成。原因是数据可能会受到多个来源的影响，而不仅仅是用户界面。因此，数据库应该存储键关系、字段中允许的数据约束、默认值等。如果约束对于常规约束而言过于复杂，则必须使用触发器。应该仔细考虑数据类型，并以某种方式作为约束。如果数据打算用于数学计算，则应使用某种类型的数字数据类型（不是浮点数或实数），如果数据是日期，请始终使用日期时间数据类型来防止存储非日期。如果数据是数字但不用于数学计算（例如 SSN），

这并不意味着您不应该在发送之前检查它是否是 GUI 中的有效日期。您应该对通过 GUI 发送到数据库的数据进行检查，以避免发送不会插入的数据，但应始终设置数据库以防止插入不正确的数据，无论它是如何发送的。浪费宝贵的网络和数据库资源处理已知的不良数据是没有意义的。

报表聚合通常可以在 GUI 上更快地完成，但如果需要返回的记录太多，最好在数据库端进行，或者您应该创建一个 OLAP 报表数据库以提高速度。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-13T17:21:57.313

这不是 SQL 与代码的问题，而是客户端与服务器的问题。Client/Server 的整体思想是让服务器以集中的方式向客户端提供服务。在实践中，这意味着：

*   如果服务器可以快速完成，请在服务器上完成
*   如果服务器可以返回一个小结果，然后在服务器上执行
*   如果您可以向客户端隐藏复杂性，请在服务器上执行

所涉及的许多问题都在其他设计领域中发现，例如面向对象设计。为其他类提供服务的类应该封装功能并只公开其客户所需的内容。SQL 服务器也是如此。如果您认为 SQL 服务器仅仅是一个数据检索系统，那么您就没有充分利用。

实际节省包括： 尽量减少通过网络发送的数据；集中/标准化处理；允许在不重新部署客户端软件的情况下进行更改；改进的性能。

至于到底在哪里画线……没有神奇的答案。真正的答案是数据库模式 + 存储过程 + 视图定义了一个 API，好的 API 设计不是微不足道的，但值得麻烦。使用信息隐藏、封装、内聚等原则，以及您在其余编程和设计工作中使用的所有其他内容。它们在这里是合适的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-10T16:01:04.100

我尝试在数据库中做数据库方面的事情。所以，排序，分组，过滤。这一切都在查询中完成（通常是一个存储过程）。我使用代码来执行查询，然后对代码执行我们需要的任何操作。我还尝试在谨慎的情况下采用“只获取一次数据”的心态，以减少到服务器的往返行程。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-10T16:06:05.510

在我看来，如果它直接处理数据，那么它应该在数据库中完成；如果它处理业务逻辑，它应该在代码中完成。

例如，按特定字段过滤数据应该由数据库决定。应在数据库中进行汇总以显示在报告中。与数据相关的次要逻辑（例如强制数据完整性的触发器）应该在两者中完成（不要因为那个评论而射击我！）以确保您的应用程序是安全的。

实际的业务逻辑，例如在订单总额超过 500 美元时应用折扣，应该在代码中完成，并且最终值仅存储在数据库中。但是，如果折扣金额因客户类型而异，则应将折扣金额存储在数据库中，而不是存储在执行计算的逻辑中。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-13T18:14:47.840

1.  尽可能少地访问数据库。

2.  如果您最终丢弃了从数据库中检索到的数据，则您的查询需要重新处理并变得更加具体。

3.  该脚本负责处理数据，除非存在使数据库更容易的索引。

4.  数据库应该能够在没有脚本的情况下存在。Cron 作业很好，但如果脚本没有在特定时间执行，数据库应该能够生存。

5.  切勿将查询置于循环中。总有一种方法可以在一个查询（又名连接）中产生相同的结果。

6.  数据库只是为了尽可能快地保存和检索原始数据而存在。为脚本保留任何格式或数学。

总而言之，尽可能少地对数据库施加压力。尽可能少地使用仅与数据插入和检索相关的查询。让脚本承担更多的负载，并确保数据库不是第一个宕机的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-10T15:57:34.110

取决于应用程序的类型。如果应用程序是唯一使用数据库的程序，那么代码就是主程序。如果 tha DB 可能比应用程序寿命更长，则尽可能多地使用 DB。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-14T05:39:26.167

你有哪些：

*   优秀的数据库开发人员可以开发出复杂且高效的存储过程和视图，并使用精心设计的外键和正确规范化的表来维护数据的完整性。

或者

*   掌握用于开发应用程序的语言和框架的优秀程序员。

如果上述问题的答案是数据库开发人员是您的强项，那么请在数据库中进行工作。一个真正优秀的 DB 人可以提供该功能，因此您的代码可以非常简单。可能需要更多的往返行程（在某些情况下这可能是致命的），但性能可能非常好。最大的问题是周围没有多少真正有才华的 DB 人。

如果编码是您的强项，请保持数据库简单并使用超级简单的参数化查询来获取和更新您的数据库。仅在遇到瓶颈时才使用触发器和存储过程之类的东西。您必须具备一些数据库管理技能。基本的事情，比如决定索引和维护这些索引。还需要知道何时规范化以及何时不规范化。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-10T15:58:32.047

我对代码与 sql 的决定通常取决于哪个似乎最容易/最快实现。一旦它在那里，我继续前进。后来，如果它看起来应该被移动，它就会被移动。<*耸耸肩*> 不过，我尽量不要一开始就出汗太多。

如果它与数据库密切相关——尤其是涉及大量使用数据库记录的东西——那么进入 sql 就很有意义。如果它是与应用程序密切相关的东西，它就在那里。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-13T16:35:50.403

SQL 是专门的代码，非常适合处理数据集，例如排序、过滤和连接。我认为“SQL vs. CODE”是一个误导性的问题。相反，我建议将您的问题视为多种专业语言之间的选择。对于这个答案，我将使用术语“服务器端”来指代 SQL 代码，使用“客户端”来指代以不同的、更通用的语言编写的所有内容。

根据我的经验，客户端代码更容易编写和维护，因为 (1) 我倾向于更熟悉客户端语言和工具，(2) 客户端开发往往拥有更好的工具、编辑器和源代码-控制集成，以及（3）维护更容易，因为我只需要在一个地方寻找逻辑。因此，除非我有令人信服的理由不这样做，否则我更喜欢编写客户端代码而不是服务器端代码。

但是，SQL 语句形式的服务器端代码对于足够的性能是必不可少的。连接、过滤和排序数据几乎总是属于 SQL，因为数据库比您在客户端做的更快、更容易。根据经验，如果我正在编写使用 SQL 游标过滤或排序记录集的代码，我可能做错了，应该将该逻辑移到 SQL 中，这样会更快、更容易编写、更容易理解。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-10T15:57:12.427

对我来说，由于技术限制，数据库是必需的：主内存很小并且不会持久化。所以对我来说，任何与持久性无关的东西都在代码中，只有当我需要来回获取数据时，我才会求助于 SQL（实际上甚至没有，我的 DAL 为我这样做）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-13T15:51:26.703

因为我的代码在我的客户端计算机上运行，​​并且我不想仅仅为了更新我的代码而需要数据库管理员访问权限，所以除了数据之外，我几乎没有在数据库中放置任何内容。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-13T16:56:08.560

我们使用 .NET 3.5 和 LINQ to SQL - 所以我们是 100% 的代码，根本没有手写 SQL。这是幸福！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-13T16:58:14.547

以下是我会考虑的一些权衡：

*   集合与单独的数据操作
*   大数据与小数据
*   秘密与非秘密位（开放代码）
*   单个与多个数据库平台目标
*   可能重用的库代码或特定于项目的代码
*   SQL 与代码开发人员技能组合

...如果我想到其他任何事情，我会告诉你的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-13T17:12:35.400

我关于何时使用 sql 的规则：

循环通过记录集时不要进行数据库调用。

保持你的逻辑。

想想其他将支持你的开发人员。写在最清楚的地方。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-13T17:29:08.917

我不确定我的经验是否能回答您的问题，但如果有帮助，我们会采取以下措施。

我们有一个用于更新的存储过程。它具有必须存在、必须不存在或不关心的参数。因此，如果操作员使用 CREATE 流程，那么记录必须是新的；如果使用 MODIFY 进程，则该帐户必须存在；如果进行某种导入，也许你想要一个*UpSert*，在这种情况下你不在乎。

我们的应用程序是基于 Web 的，因此数据来自 Web 表单。表单字段将包含数据或为空字符串。记录中可能有其他字段不在表单上。

我们的更新程序为表中的每个字段都有参数，参数默认为 NULL - 除了必须提供的 PK 字段:)

因此，将为过程提供一个空字符串字段，而不在表单上的字段将不提供，并且默认为 NULL。不允许将表单字段作为 NULL 传递 - 表单上的所有字段都必须传递一个值。

对于正在更新的现有记录，我们将 NULL 视为“没有更改”，将值视为导致更改。但是，我们不允许存储空字符串，因此传递空字符串的参数会导致该记录中的字段更改为 NULL。（与日期类型特别相关，例如，因为只能存储有效日期，而不是空字符串；如果我们不应用此规则，数字的空字符串可能会被视为零）

这对我们来说效果很好，使我们能够机械地生成这样的数据库过程和与之相关的相关表格。

此外，我们允许更新过程返回验证错误代码。通常，表单字段的验证由应用程序执行 - 首先在客户端使用 Javascript 来强制日期有效，等等；其次，应用程序可以应用相同的（为了安全）和额外的验证。最后，数据库程序可以执行进一步的验证——例如检查一个订单项目是否有相应的订单头记录；虽然这也由外键约束强制执行，但我们不喜欢捕获（和解释）导致的数据库错误，因此更新过程检查并返回对应用程序有用的错误号/消息（并对应到错误表中维护的消息，该错误表可以显示给操作员，以便他们知道问题所在）。

我们还机械地生成 Get/Read 过程。这将返回单行的所有字段。该过程的参数是所有 PK 字段。CRUD 表单可以使用它来获取任何现有数据。我们使用它，而不是为每个表单使用特定的过程，因为它会检索所有列，并且其中一些列可能不需要在特定表单上。它只是单行检索，并且很可能所有字段都将在 CRUD 维护表单上表示。但是，根据 80:20 ri;rule，对于具有不在表格上的文本列的记录，我们会更加谨慎 - 显然，检索许多 K 不在表格上的数据是不好的。对于其余部分，我们认为编程的一致性，并且例外情况相对较少，

这种方法还意味着，随着数据库模式的更改，过程与更改同步，并将揭示现在这对现有表单造成的问题。例如，如果一列被重命名，表单将立即失败 - 通过尝试使用不再有效的参数调用过程，或者通过使用不再检索的列。为了向后兼容，我们可以在必要时对此进行隔离 - 允许更新过程有一个带有原始名称的附加参数和一个带有表示列新名称的参数的 COALESCE，并让 Get/Read 在结果集中返回重复的列新旧名称。

对于删除也是如此。该过程是机械生成的，以 PK 作为参数，并且能够返回验证消息（例如，当尝试删除 Order Header，如果它仍有子 Order Item 记录时）。

我们所有的表都有创建者、创建日期、更新者、更新日期和 EditNo 字段 - 每当保存记录时都会递增。EditNo 值被赋予表单（在隐藏输入字段中），因此传递给更新或删除过程。它必须与现有记录的值匹配，否则该记录已被另一个操作员更改并且以后的更新被拒绝（再次，更新过程向操作员提供有用的消息 - 包括另一个更新者是谁，以及在什么时间）。

对于大多数数据表，我们还有一个存档表。这会在进行更新时存储“旧”记录的副本。我们不存储新记录 - 因为那是在主表中，因此减少了我们存储在存档中的数据量。

这包含主记录中的所有列，以及一个操作 - 更新或删除 - 和审核日期。记录通过主表上的更新/删除触发器插入到存档中。

我们也有机械生成的 Find 程序。这些具有匹配表中字段的参数，但可以用于开始/结束点（例如订单日期范围）、精确匹配或“包含”匹配 - 例如“名称如 XXXX”。这些仅返回显示器实际使用的特定字段，并且机械生成的过程具有使用定义参数的合适的 WHERE 子句。在实践中，这些程序需要手动更改以进行手动优化等，但在首次制作应用程序以提供用户数据查询的快速启动时很有用。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-13T17:48:24.877

平衡是您获得最高可维护性和可接受性能的点。

所有业务逻辑都应该在应用程序中完成。您可以从 Sql Server 开始，但如果策略更改为 Oracle。您只需将数据迁移到 Oracle，无需重写任何代码。

或者某些应用程序，必须支持多个数据库，所以你只是在应用程序中完成了所有代码。当您遇到问题时，您只需在应用程序中解决问题。无需修复多个数据库中的问题。

为此，必须在应用程序中生成所有 CRUD 代码。这意味着您需要一个好的 ORM 框架（Linq、Hibernate）来完成这项工作。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-14T05:53:43.590

我在商业界从事 CRUD 编程已经 10 多年了。我可以告诉你，我在存储过程和视图中加入了尽可能多的业务逻辑（并且是有道理的）。每当风吹草动时，需求往往会发生变化，并且数据库中的逻辑使其易于更改并且（带有体面的评论）它是自我记录的。加上 sprocs 可提供良好的安全性并易于代码重用。在业务中，存储过程*是*应用程序。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-15T18:12:25.057

答案取决于相关开发人员的实力。最后，您需要提高生产力，因此您必须在解决当今问题与长期维护考虑之间取得平衡，同时考虑到您的团队可能都是应用程序开发人员，而不是 SQL 重头戏。

你将如何向团队传达变化，每个人都能理解与你总是跑到角落里的那个人谁会在接下来的几年里发挥天才？如果您的代码返回错误，每个团队成员能多快找到问题的根源？

所有“管理层讲话”都说了，其他人在这里详细介绍了一些基础知识，我也会附和：

*   缺乏良好的数据库设计无法克服代码中的酷复杂性
*   数据完整性是数据库的工作
*   用程序代码解决复杂的问题——没有什么比阅读注释良好的结构代码更好的了。
*   从域对象报告可能非常困难，而编写报告的技能通常与更丰富的 DB 经验相吻合，而不是 DDD。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-10T16:05:04.373

通常在我参与的项目中，大部分数据由数据库服务器处理，大部分演示都是通过代码完成的。

例外是：SELECT col1, col2, col3 FROM table

演示文稿是：col1, col2, col3, col1/col2, col1/col3, ...

如果我得到一个方程中的所有操作数，我将在代码中执行，如果没有，我将作为查询的一部分执行（选择 col1、col2、col1/col4...）

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-10T16:30:47.743

根据我的经验，与 SQL 相比，在代码中执行复杂的数据验证更容易，因此答案在于我正在处理的应用程序和数据的类型。如果必要的验证是相当良性的，那么我将这个逻辑以存储过程的形式放在数据库层中是没有问题的。

但是，当需要升级您的应用程序时，就会出现这种方法的一个明显缺点。对架构的更改*可能*比对客户端代码的更改更具挑战性，尤其是当您将代码发送给客户而不是开发供内部使用的应用程序时。

此外，与执行应用程序代码的构建相比，为数据库模式更改（例如识别更改的对象、使更改脚本具有幂等性）组合更改脚本通常需要更多的工作。这主要是由于数据库开发方面可用的工具（或缺乏工具）。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-11T00:24:30.380

在我们的小组中，有几个案例。

**可以通过 INSERT/SELECT 满足的处理**

一般来说，我们让程序根据用户提供的参数编写插入选择，然后在服务器上执行

**控制中断处理**

该程序使用所需的 order by 构建选择，并在服务器的上下文中执行它。结果集被吸回到程序中，并作为控制中断逐行处理。

**复杂加工**

该程序构建选择，并在服务器的上下文中执行它。结果集被逐行吸回程序，在那里进行代码密集处理。结果进入一个文件，或者一个 UPSERT 返回到数据库。

**性能关键**

该程序构建选择，在服务器的上下文中执行它。完整的结果集被吸回到内存中，在那里进行代码密集处理。处理后的结果信息进入一个文件，或者 UPSERTED 回到数据库中。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-13T16:42:31.010

如果在 SQL 中执行它使其更易于管理，请在 SQL 中执行。如果在代码中执行它使其更易于管理，请在代码中执行。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2009-02-15T18:48:54.393

以下是我听到的一些建议：如果项目的预算低于 100 万美元，请将 SQL 语句放在客户端代码中。如果预算大于 100 万美元，请创建访问器类等。请参阅此[博客文章](http://www.johndcook.com/blog/2008/01/11/million-dollar-cutoff-for-software-technique/)。我不知道我是否同意具体的金额，但我同意预算（以及隐含的项目规模、重要性等）应该会影响你在开发中的正式程度。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2009-04-19T18:46:18.117

我将 SQL 用于**查询**（声明性），将 Python 用于**过程**（逐步操作）。

# mysql - 如何在 MySQL 中进行分组排名

> ID：532878
> 
> 赞同：34
> 
> 时间：2009-02-10T15:52:16.913
> 
> 标签：mysql, sql, window-functions

所以我有一个如下表：

```
ID_STUDENT | ID_CLASS | GRADE
-----------------------------
   1       |    1     |  90
   1       |    2     |  80
   2       |    1     |  99
   3       |    1     |  80
   4       |    1     |  70
   5       |    2     |  78
   6       |    2     |  90
   6       |    3     |  50
   7       |    3     |  90 
```

然后我需要对它们进行分组、排序和排序，以提供：

```
ID_STUDENT | ID_CLASS | GRADE | RANK
------------------------------------
    2      |    1     |  99   |  1
    1      |    1     |  90   |  2
    3      |    1     |  80   |  3
    4      |    1     |  70   |  4
    6      |    2     |  90   |  1
    1      |    2     |  80   |  2
    5      |    2     |  78   |  3
    7      |    3     |  90   |  1
    6      |    3     |  50   |  2 
```

现在我知道您可以使用临时变量进行排名，[就像这里一样](https://stackoverflow.com/questions/431053/what-is-the-best-way-to-generate-ranks-in-mysql)，但是我该如何为分组集呢？感谢您的任何见解！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-10T16:05:26.213

```
SELECT id_student, id_class, grade,
   @student:=CASE WHEN @class <> id_class THEN 0 ELSE @student+1 END AS rn,
   @class:=id_class AS clset
FROM
  (SELECT @student:= -1) s,
  (SELECT @class:= -1) c,
  (SELECT *
   FROM mytable
   ORDER BY id_class, id_student
  ) t 
```

这以一种非常简单的方式工作：

1.  初始查询按`id_class`第一、`id_student`第二排序。
2.  `@student`并`@class`初始化为`-1`
3.  `@class`用于测试是否进入下一组。`id_class`如果（存储在 中）的先前值`@class`不等于当前值（存储在 中`id_class`），则将`@student`归零。否则是递增的。
4.  `@class`被分配了新的值`id_class`，它将在下一行的步骤 3 的测试中使用。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-27T16:51:53.287

Quassnoi 的解决方案存在问题（标记为最佳答案）。

我有同样的问题（即在 MySQL 中模拟 SQL 窗口函数），我曾经实现 Quassnoi 的解决方案，使用用户定义的变量来存储前一行的值......

但是，也许在 MySQL 升级或其他什么之后，我的查询不再起作用了。这是因为不能保证 SELECT 中字段的评估顺序。@class 分配可以在@student 分配之前进行评估，即使它放在 SELECT 之后。

这在 MySQL 文档中提到如下：

> 作为一般规则，您永远不应为用户变量赋值并在同一语句中读取该值。您可能会得到预期的结果，但这不能保证。涉及用户变量的表达式的求值顺序是未定义的，并且可能会根据给定语句中包含的元素而改变；此外，不保证此顺序在 MySQL 服务器的版本之间是相同的。

来源：[http ://dev.mysql.com/doc/refman/5.5/en/user-variables.html](http://dev.mysql.com/doc/refman/5.5/en/user-variables.html)

最后，我使用了这样的技巧来确保在阅读后分配@class：

```
SELECT id_student, id_class, grade,
   @student:=CASE WHEN @class <> id_class THEN concat(left(@class:=id_class, 0), 0) ELSE @student+1 END AS rn
FROM
  (SELECT @student:= -1) s,
  (SELECT @class:= -1) c,
  (SELECT *
   FROM mytable
   ORDER BY id_class, grade desc
  ) t 
```

使用 left() 函数仅用于设置 @class 变量。然后，将 left() 的结果（等于 NULL）连接到预期的结果是透明的。

不是很优雅，但它有效！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-08T08:18:15.973

```
SELECT g1.student_id
     , g1.class_id
     , g1.grade
     , COUNT(*) AS rank
  FROM grades   AS g1
  JOIN grades   AS g2
    ON (g2.grade, g2.student_id) >= (g1.grade, g1.student_id)
   AND g1.class_id = g2.class_id
 GROUP BY g1.student_id
        , g1.class_id
        , g1.grade
 ORDER BY g1.class_id
        , rank
 ; 
```

结果：

```
+------------+----------+-------+------+
| student_id | class_id | grade | rank |
+------------+----------+-------+------+
|          2 |        1 |    99 |    1 |
|          1 |        1 |    90 |    2 |
|          3 |        1 |    80 |    3 |
|          4 |        1 |    70 |    4 |
|          6 |        2 |    90 |    1 |
|          1 |        2 |    80 |    2 |
|          5 |        2 |    78 |    3 |
|          7 |        3 |    90 |    1 |
|          6 |        3 |    50 |    2 |
+------------+----------+-------+------+ 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-10T16:25:38.847

从上面修改，这可行，但它比我认为的要复杂：

```
SELECT ID_STUDENT, ID_CLASS, GRADE, RANK
FROM
    (SELECT ID_STUDENT, ID_CLASS, GRADE,
        @student:=CASE WHEN @class <> id_class THEN 1 ELSE @student+1 END AS RANK,
        @class:=id_class AS CLASS
    FROM
        (SELECT @student:= 0) AS s,
        (SELECT @class:= 0) AS c,
        (SELECT * 
            FROM Students
            ORDER BY ID_CLASS, GRADE DESC
        ) AS temp
    ) AS temp2 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-03-26T19:36:51.730

```
SELECT ID_STUDENT, ID_CLASS, GRADE, RANK() OVER(
PARTITION BY ID_CLASS
ORDER BY GRADE ASC) AS 'Rank'
FROM table
ORDER BY ID_CLASS; 
```

我在家庭作业中遇到了类似的问题，发现 MySQL（不能代表任何其他 RDBMS）对其 RANK() 方法有一个分区参数。不明白为什么它不能解决这个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-07-04T15:02:45.757

虽然我没有足够的声誉点来评论（有点幽默），但 MySQL 近年来已经取得了长足的进步。添加了窗口函数和 CTE（WITH 子句），这意味着现在支持 rank（和 row_number 等）。

我是同一个“乔恩·阿姆斯特朗 - Xgc”，但那个帐户在旧电子邮件地址的风中丢失了。

一条评论提出了一个关于 MySQL 是否支持排名窗口函数的问题。回答：是的。

几年前我的原始回复：

```
SELECT p1.student_id
     , p1.class_id
     , p1.grade
     , COUNT(p2.student_id) AS rank
  FROM grades   AS p1
  JOIN grades   AS p2
    ON (p2.grade, p2.student_id) >= (p1.grade, p1.student_id)
   AND p1.class_id = p2.class_id
 GROUP BY p1.student_id, p1.class_id
 ORDER BY p1.class_id, rank
; 
```

结果：

```
+------------+----------+-------+------+
| student_id | class_id | grade | rank |
+------------+----------+-------+------+
|          2 |        1 |    99 |    1 |
|          1 |        1 |    90 |    2 |
|          3 |        1 |    80 |    3 |
|          4 |        1 |    70 |    4 |
|          6 |        2 |    90 |    1 |
|          1 |        2 |    80 |    2 |
|          5 |        2 |    78 |    3 |
|          7 |        3 |    90 |    1 |
|          6 |        3 |    50 |    2 |
+------------+----------+-------+------+
9 rows in set (0.001 sec) 
```

使用 ROW_NUMBER 窗口函数：

```
WITH cte1 AS (
        SELECT student_id
             , class_id
             , grade
             , ROW_NUMBER() OVER (PARTITION BY class_id ORDER BY grade DESC) AS rank
          FROM grades
     )
SELECT *
  FROM cte1
 ORDER BY class_id, r
; 
```

结果：

```
+------------+----------+-------+------+
| student_id | class_id | grade | rank |
+------------+----------+-------+------+
|          2 |        1 |    99 |    1 |
|          1 |        1 |    90 |    2 |
|          3 |        1 |    80 |    3 |
|          4 |        1 |    70 |    4 |
|          6 |        2 |    90 |    1 |
|          1 |        2 |    80 |    2 |
|          5 |        2 |    78 |    3 |
|          7 |        3 |    90 |    1 |
|          6 |        3 |    50 |    2 |
+------------+----------+-------+------+
9 rows in set (0.002 sec) 
```

使用 RANK 窗口函数：

```
WITH cte1 AS (
        SELECT student_id
             , class_id
             , grade
             , RANK() OVER (PARTITION BY class_id ORDER BY grade DESC) AS rank
          FROM grades
     )
SELECT *
  FROM cte1
 ORDER BY class_id, rank
; 
```

结果：

```
+------------+----------+-------+------+
| student_id | class_id | grade | rank |
+------------+----------+-------+------+
|          2 |        1 |    99 |    1 |
|          1 |        1 |    90 |    2 |
|          3 |        1 |    80 |    3 |
|          4 |        1 |    70 |    4 |
|          6 |        2 |    90 |    1 |
|          1 |        2 |    80 |    2 |
|          5 |        2 |    78 |    3 |
|          7 |        3 |    90 |    1 |
|          6 |        3 |    50 |    2 |
+------------+----------+-------+------+
9 rows in set (0.000 sec) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T16:40:10.950

我做了一些搜索，发现[这篇文章](http://forums.mysql.com/read.php?32,225340,225664#msg-225664)提出了这个解决方案：

```
SELECT S2.*, 
FIND_IN_SET(
S2.GRADE
, (
SELECT GROUP_CONCAT(GRADE ORDER BY GRADE DESC)
FROM Students S1
WHERE S1.ID_CLASS = S2.ID_CLASS
)
) AS RANK
FROM Students S2 ORDER BY ID_CLASS, GRADE DESC; 
```

关于哪个更好的想法？

# ruby-on-rails - Ruby on Rails 中的繁重算法工作？

> ID：532881
> 
> 赞同：2
> 
> 时间：2009-02-10T15:53:17.880
> 
> 标签：ruby-on-rails, ruby

我有一个相当密集的算法，必须在我的 RoR 应用程序中经常运行（每秒多次）。考虑到 Ruby 处理这类东西的速度有多[慢](http://shootout.alioth.debian.org/u32q/benchmark.php?test=mandelbrot&lang=all&sort=fullcpu)，我认为在 Ruby 中完成这项工作并不是一件好事。

您可能在想我应该将它添加到某种工作队列中并让 C++ 应用程序处理它，但我需要立即返回结果。有没有办法用 C++ 插件或其他东西来扩展 RoR？如果我想通过套接字连接到 C++ 应用程序怎么办？或者那只是疯了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T16:00:25.583

> [...] 我不认为 [...]

进行测量。

也就是说，如果用 Ruby 编写相当简单，请先用 ruby​​ 实现它并进行测量。*然后，如果它*真的太慢，找出如何绕过它。

即使你需要用另一种语言重写算法，你也有一个 ruby​​ 算法，你基本上只需要复制，所以它不会像第一次用（比如）C++ 编写它那样耗时。

但是先量一下。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T16:02:46.140

几种可能。

首先，看看您是否可以迁移到 Ruby 1.9：它比 1.8 快得多。

其次，确实有一种方法可以用[C 编写 Ruby 扩展](http://www.rubyinside.com/how-to-create-a-ruby-extension-in-c-in-under-5-minutes-100.html)。

第三，您确实可以用您认为方便的任何语言编写一个单独的进程并使用它。最好的方法很难猜测，因为您并没有真正提供太多细节，但请考虑一下 popen 的工作原理。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-10T16:36:10.163

另一种选择是[RubyInline](http://www.zenspider.com/ZSS/Products/RubyInline/)，它允许您在 Ruby 代码中编写 C/C++ 代码。这非常符合 Jonas Kölker 的[建议](https://stackoverflow.com/questions/532881/heavy-algorthmic-work-in-ruby-on-rails/532914#532914)，即先用 Ruby 编写算法，然后找到瓶颈。然后，您可以使用 RubyInline 来优化瓶颈。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T16:07:04.383

另一种可能性（如果您的设置允许）是使用 JRuby。然后您可以在 Java 中实现该算法。

# c# - 从 Access 2003 调用托管代码

> ID：532886
> 
> 赞同：2
> 
> 时间：2009-02-10T15:54:39.950
> 
> 标签：c#, .net, ms-access, ms-office

我已经在[access-programmers.co.uk上发帖了](http://access-programmers.co.uk/forums/showthread.php?t=144006)

请在该论坛上发布回复是可能的..

我在 c# 3.5 中编译了一个 dll。我在其中设置解决方案属性以注册 COM 互操作的构建。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;

namespace SBG_TestWithVBA
{
  [ClassInterface(ClassInterfaceType.AutoDual)]

  public class TestHello
  {
    [ComVisible(true)]

    public string SayHello(string name)
    {
      string message = "Hello " + name;
      return message;
    }
    public string HelloWorld()
    {
      string message = "Hello World!";
      return message;
    }
  }
} 
```

然后我使用注册了程序集和 tlb 文件

> "C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\regasm.exe" "\sbgfs01\users\Vincent Pirolli\My Docs\Visual Studio 2008\Projects\TestWithVBA\TestWithVBA\bin\Release\SBG_TestWithVBA.dll" /tlb: "\sbgfs01\users\Vincent Pirolli\My Docs\Visual Studio 2008\Projects\TestWithVBA\TestWithVBA\bin\Release\SBG_TestWithVBA.tlb"

然后，我从工具>参考菜单中将 tlb 文件添加到 vba 中。

我的VBA代码如下：

```
Sub test()
    Dim f As SBG_TestWithVBA
    Set f = New SBG_TestWithVBA
    f.HelloWorld
End Sub 
```

即使 Intellisense 在 VBA 编辑器中工作，我也会收到以下错误： **“自动化错误系统找不到指定的文件。”**

有人有什么想法吗？我有以前帖子中的文章，但我找不到解决方案。

* * *

好的，现在这真的很烦我..

我设法让它工作..但我不明白为什么..

在 Visual Studio 中的解决方案属性中。在“构建”选项卡上，我将“注册 COM 互操作”设置为 true，并在“应用程序 > 程序集信息”中，设置“使程序集 COM-Visible”= TRUE ..

我在共享驱动器中有 VS 项目文件。现在，如果我将构建位置设置为共享驱动器上的 bin 文件夹，在我的项目文件下，当我从 VBA 调用它时它不起作用.. 但是，如果我将构建文件夹设置为本地 C 驱动器上的文件夹，那么它从 VBA 调用时工作正常..

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T16:08:26.127

看起来您正在注册的程序集位于网络共享上。在这种情况下，.net 程序集应用了不同的安全模型。

您是否尝试过将程序集和 TLB 放在本地目录中，然后在“工具”>“参考”菜单中添加 TLB？

另外——这很可能完全不合时宜——但是是否需要将 DLL 注册到 RegSvr32 以便它是可寻址的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-08T18:10:13.140

您可以让它在本地工作，但它在网络共享上失败，这表明存在 .NET 安全问题。.NET 对待本地资源的方式不同于网络资源，也不同于受信任的 Internet 和不受信任的 Internet。我怀疑您的 .NET 组件被配置为信任本地程序集，但不信任 LocalIntranet 程序集。

有关获取本地 Intranet 的配置要求，请参见此处：

[http://support.microsoft.com/kb/892465](http://support.microsoft.com/kb/892465)

有关确定程序集尝试在哪个区域运行的方法，请参阅此答案：

[https://stackoverflow.com/questions/239463?sort=newest](https://stackoverflow.com/questions/239463?sort=newest)

顺便说一句，我发现将环境配置为以网络共享为目标是相当复杂的，因为在本地机器上使用代码时所做的许多假设都是无效的。出于这个原因，我更喜欢尽可能安装到本地机器上，并且只有在有充分理由不在本地安装时才与安全模型作斗争。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-30T02:54:51.397

如果您想了解有关 .net 安全性的更多信息，请在 google 上查找 CASPOL.EXE。CASPOL.EXE 是所有 .net 框架附带的安全工具。CASPOL 代表代码访问安全策略。使用此工具，您可以基于区域配置策略。

# .net - 客户端和内部应用程序设计之间的 Web 服务中介

> ID：532889
> 
> 赞同：0
> 
> 时间：2009-02-10T15:55:17.110
> 
> 标签：.net, wcf

我正在创建一个将接受许多连续请求的 wcf Web 服务，该 Web 服务将需要保留这些请求，直到内部应用程序（它将每隔几秒钟轮询一次 Web 服务）将向 Web 服务发出请求确定是否存在任何请求，如果存在则检索它们。然后，内部应用程序会将响应发送回 Web 服务，Web 服务会将响应传递回初始调用者。

IE：

客户端---1）请求---> Web服务<---2）请求---内部应用程序

客户端 <---4) 响应--- Web 服务 <---3) 响应---内部应用程序

我正在尝试设计 Web 服务的实现，并试图考虑实现接受请求的机制的方法，一直保持到内部应用程序请求数据并且 Web 服务等待响应从内部应用程序。

我主要担心的是：

1）如果在内部应用程序发出请求之前有数千个请求进来了怎么办？

2）如果内部应用程序死掉并且大量请求建立怎么办？（我需要让这些请求超时）

3) 如何将初始请求与客户端和内部应用程序的响应联系起来？

4）客户端将等待等待响应。

WCF 消息队列在这种情况下会有所帮助吗？Web 服务是否能够在内部管理消息队列，例如，当消息进入时，Web 服务会将消息添加到队列中，类似地，当内部应用程序发出请求时，Web 服务会从顶部抓取消息队列并将其传递给内部应用程序并等待内部应用程序的响应并将其传递回客户端？

这甚至可能吗？

如果同时有 2000 个客户端请求进来，因为客户端会同步等待响应，上面的场景会起作用吗？我能否将原始请求与来自内部应用程序线程的响应相匹配，以将响应提供回客户端？

消息队列方法是否显得矫枉过正？我可以将请求保存在一些静态字典中吗？

你有什么其他的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T16:57:28.693

首先，坦率地说，轮询式架构对于实时请求处理来说是非常错误的。如果完全有可能将请求直接转发给将要处理它们的应用程序，那将是无限可取的。你让自己面对一大堆额外的问题，你甚至将最好的响应时间限制在“几秒钟”，这是非常糟糕的。

但。假设您无法对架构做任何事情，将消息排队以供内部应用程序检索不是问题。内存中的队列结构可以很好地处理这个问题（只需将队列的大小限制为几千，如果它填满则返回错误）。您真正的瓶颈将是 Web 服务上打开的请求数。*如果每个请求都有最小值*，我只是看不到指定的架构如何能够处理数千个请求/秒*“几秒钟”的开放时间。服务器的设计不是为了保持这么多请求的开放。那些能够每秒处理数千个请求的人会在几毫秒内响应每个请求，然后将其清除。如果每个请求都打开了几秒钟，它将使您的服务器瘫痪 - 请求将排队，其中 90% 的请求最终会超时，假设您的服务器本身不会在重压下崩溃。*

 *# c# - 我可以“乘”一个字符串（在 C# 中）吗？

> ID：532892
> 
> 赞同：142
> 
> 时间：2009-02-10T15:56:51.287
> 
> 标签：c#, string, extension-methods

假设我有一个字符串，例如，

```
string snip =  "</li></ul>"; 
```

我想基本上写多次，取决于一些整数值。

```
string snip =  "</li></ul>";
int multiplier = 2;

// TODO: magic code to do this 
// snip * multiplier = "</li></ul></li></ul>"; 
```

编辑：我知道我可以轻松编写自己的函数来实现它，我只是想知道是否有一些我不知道的奇怪的字符串运算符

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2010-07-21T08:54:49.123

在 .NET 4 中，您可以这样做：

```
String.Concat(Enumerable.Repeat("Hello", 4)) 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2009-02-10T16:57:15.230

请注意，如果您的“字符串”只是一个字符，则字符串构造函数会重载来处理它：

```
int multipler = 10;
string TenAs = new string ('A', multipler); 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2009-02-10T15:59:56.740

不幸/幸运的是，字符串类是密封的，因此您不能从它继承并重载 * 运算符。您可以创建一个扩展方法：

```
public static string Multiply(this string source, int multiplier)
{
   StringBuilder sb = new StringBuilder(multiplier * source.Length);
   for (int i = 0; i < multiplier; i++)
   {
       sb.Append(source);
   }

   return sb.ToString();
}

string s = "</li></ul>".Multiply(10); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-10T16:13:52.883

[我和 DrJokepu 一起讨论这个问题](https://stackoverflow.com/questions/532892/can-i-multiply-a-string-in-c/532912#532912)，但如果出于某种原因您确实想使用内置功能作弊，那么您可以执行以下操作：

```
string snip = "</li></ul>";
int multiplier = 2;

string result = string.Join(snip, new string[multiplier + 1]); 
```

或者，如果您使用的是 .NET 4：

```
string result = string.Concat(Enumerable.Repeat(snip, multiplier)); 
```

我个人不会打扰 - 自定义扩展方法要好得多。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-06-05T20:44:48.557

只是为了完整起见 - 这是另一种方法：

```
public static string Repeat(this string s, int count)
{
    var _s = new System.Text.StringBuilder().Insert(0, s, count).ToString();
    return _s;
} 
```

我想我前段时间从 Stack Overflow 中取出了那个，所以这不是我的主意。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-10T16:00:01.327

您必须编写一个方法 - 当然，对于 C# 3.0，它可能是一个扩展方法：

```
public static string Repeat(this string, int count) {
    /* StringBuilder etc */ } 
```

然后：

```
string bar = "abc";
string foo = bar.Repeat(2); 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2011-09-12T21:04:09.377

有点晚了（只是为了好玩），如果你真的想使用`*`运算符来完成这项工作，你可以这样做：

```
public class StringWrap
{
    private string value;
    public StringWrap(string v)
    {
        this.value = v;
    }
    public static string operator *(StringWrap s, int n)
    {
        return s.value.Multiply(n); // DrJokepu extension
    }
} 
```

所以：

```
var newStr = new StringWrap("TO_REPEAT") * 5; 
```

需要注意的是，只要你能为他们找到合理的行为，你也可以通过`StringWrap`类来处理其他的操作符，比如`\`, `^`,`%`等等...

**PS：**

`Multiply()`[@DrJokepu](https://stackoverflow.com/questions/532892/can-i-multiply-a-string-in-c/532912#532912)的扩展学分保留所有权利；-)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2011-12-15T12:17:55.203

这更简洁：

```
new StringBuilder().Insert(0, "</li></ul>", count).ToString() 
```

`using System.Text;`在这种情况下应该导入命名空间。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-10T16:01:15.503

```
string Multiply(string input, int times)
{
     StringBuilder sb = new StringBuilder(input.length * times);
     for (int i = 0; i < times; i++)
     {
          sb.Append(input);
     }
     return sb.ToString();
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-07-22T05:38:35.117

如果你有 .Net 3.5 但没有 4.0，你可以使用 System.Linq 的

```
String.Concat(Enumerable.Range(0, 4).Select(_ => "Hello").ToArray()) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-12-16T19:57:27.177

由于每个人都在添加自己的 .NET4/Linq 示例，我不妨添加自己的。（基本上，它是 DrJokepu 的，简化为单线）

```
public static string Multiply(this string source, int multiplier) 
{ 
    return Enumerable.Range(1,multiplier)
             .Aggregate(new StringBuilder(multiplier*source.Length), 
                   (sb, n)=>sb.Append(source))
             .ToString();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-10T16:45:17.600

好的，这是我对此事的看法：

```
public static class ExtensionMethods {
  public static string Multiply(this string text, int count)
  {
    return new string(Enumerable.Repeat(text, count)
      .SelectMany(s => s.ToCharArray()).ToArray());
  }
} 
```

我当然有点傻，但是当我需要在代码生成类中进行制表时，Enumerable.Repeat 会为我完成。是的，StringBuilder 版本也很好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-07-21T08:52:08.037

这是我对此的看法，仅供将来参考：

```
 /// <summary>
    /// Repeats a System.String instance by the number of times specified;
    /// Each copy of thisString is separated by a separator
    /// </summary>
    /// <param name="thisString">
    /// The current string to be repeated
    /// </param>
    /// <param name="separator">
    /// Separator in between copies of thisString
    /// </param>
    /// <param name="repeatTimes">
    /// The number of times thisString is repeated</param>
    /// <returns>
    /// A repeated copy of thisString by repeatTimes times 
    /// and separated by the separator
    /// </returns>
    public static string Repeat(this string thisString, string separator, int repeatTimes) {
        return string.Join(separator, ParallelEnumerable.Repeat(thisString, repeatTimes));
    } 
```

# nhibernate - NHibernate：检索当前数据库服务器 DateTime

> ID：532901
> 
> 赞同：-1
> 
> 时间：2009-02-10T15:58:13.407
> 
> 标签：nhibernate, datetime

如何使用 NHibernate 从数据库服务器获取当前的 DateTime？我尝试使用 current_date 表达式，但它似乎在 where 子句之外不起作用。我需要的是类似`SELECT getdate()`. SQL 服务器中的此查询从服务器获取当前日期时间，我只是不知道如何将其放入 HQL 方言中。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T13:27:07.973

一种选择是在映射文件中使用命名 SQL 查询：

```
<sql-query name="CurrentDate">
  <![CDATA[
    select getdate()
  ]]>
</sql-query> 
```

然后在您的调用代码中：

```
IQuery q = session.GetNamedQuery("CurrentDate");
var date = q.UniqueResult<DateTime>(); 
```

当然，这仅在您只想检索日期而不是日期以及实体的其他部分时才有效。

# apache-flex - 如何在 ActionScript 3 sprite 中绘制文本？

> ID：532902
> 
> 赞同：8
> 
> 时间：2009-02-10T15:58:21.907
> 
> 标签：apache-flex, flash, actionscript-3

我有一些用户可以操纵、拖动和调整大小的精灵。现在我希望能够在这些精灵中显示文本。我已经尝试了很多，可能是愚蠢的方法。就像从 Label 继承并将 Label 子项添加到精灵，但没有文本显示。

一件令人不安的事情：从 Label 继承，如果我在调试器中运行并检查我的 Label 子类实例，我会显示文本。

我有这种感觉，我错过了一些非常明显的东西。这是如何完成的，正确的方法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T16:17:21.970

我会选择比标签更底层的东西。使用 TextField 并将其作为子项添加到 Sprite：

```
var text:TextField = new TextField();
text.text = "hello world";
addChild(text); 
```

注意：如果 Sprite 旋转且字体未嵌入，您的文本将不会显示。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T16:59:15.210

您应该阅读有关[显示列表的信息](http://www.adobe.com/devnet/flash/quickstart/display_list_programming_as3/)

```
var s:Sprite = new Sprite(); 
var txt:TextField = new TextField(); 
txt.text ="here is same text"; 
s.addChild(txt); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-10T16:12:45.633

添加一个新标签作为精灵对象的子对象。

# javascript - 滥用 CSS 类属性或有效的设计模式？

> ID：532906
> 
> 赞同：6
> 
> 时间：2009-02-10T15:58:47.257
> 
> 标签：javascript, jquery, html, css, oop

您很可能已经知道，在 JQuery 中选择文档中具有特定 CSS 类的所有元素很简单，然后使用链接将公共事件处理程序分配给所选元素：

```
$(".toolWindow").click(toolWindow_click);
$(".toolWindow").keypress(toolWindow_keypress); 
```

像往常一样，“toolWindow”类也通常在 CSS 中定义并与一些视觉样式相关联：

```
.toolWindow{
   color:blue;
   background-color:white;
} 
```

class 属性现在不仅负责指示元素的外观（视觉状态），还负责指示行为。结果，我经常使用这种方法并将 CSS 类名定义为伪面向对象的类，而不是仅可视化的 CSS 类。换句话说，每个类都代表状态（CSS 样式）和行为（事件）。

在某些情况下，我什至创建了没有视觉样式的类，只是将它们用作为元素分配行为的便捷方式。

此外，jQuery LiveQuery 插件（和 live() 内置函数）通过​​自动将事件绑定到属于特定类的动态创建的元素，使这种方法更加有效。

最近，我主要使用类名来定义关联 DOM 元素的一组通用行为，然后才使用它们来定义视觉样式。

问题：这是对 CSS“类”属性的严重误用，如果是，为什么？

另一方面，也许这是进一步实现“关注点分离”和提高 HTML/DHTML 页面的可维护性的一种完全有效的方法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-10T16:04:06.107

“类”实际上是文档数据的一部分（希望在语义上相关），而不是它的样式或设计。

这就是为什么两者都可以使用的原因。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T16:10:47.307

1.  这是完全有效的方法。
2.  类属性不定义行为 - JS 通过 CSS*选择器*来定义行为（感谢 jQuery）。
3.  类属性不定义视觉样式 - CSS*规则*做到了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T18:00:53.690

我认为这是完全有效的。

我试图坚持的唯一规则是类名应该具有语义价值。如果您不想，它们也不需要任何关联的 CSS 或 JavaScript。只需使类名描述内容即可。

错误的类名（根据我的规则）：

```
<span class="brightRedBold">Wear Protective Gloves</span>
<a class = "openInNewWindow" ...> 
```

在我看来，这些与编写内联样式和 javascript 一样糟糕

好的类名：

```
<span class="urgentWarning">Wear Protective Gloves</span>
<a class = "offSiteLink" ...> 
```

您可以将您想要的任何样式和行为附加到这些类，并提出更加一致和可维护的设计。例如，尝试为“brightRed”定义口语风格。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T16:05:52.623

我不认为这有什么问题。为了安全起见，您始终可以确保用于行为的类与用于表示的类是分开的。

从根本上说，jQuery 的优势在于它使用 CSS 选择器语法进行 DOM 操作。该语法最初是为 CSS 设计的，用于演示。然而，使用它来定义行为（无论您是否选择类）已被证明是一种非常强大的技术。谁能反对呢？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T16:07:16.910

我尽量使用 ID 并避免上课。这并不是说使用它们不好，恰恰相反。但我相信，如果你使用 ID，从某种意义上说，你会被迫使用非常结构化和有意义的语义标记。**如果您每次需要以某种方式查看元素时都吐出类-您可能做错了。**

这是一个相当有争议的话题，所以这就是我要扔进锅里的东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-10T16:23:56.823

*这是一种非常合理的*方法，并且非常适合使用 class 属性。

我想说，如果一个类只被 jQuery 使用而不被 CSS 使用，那么最好有一个明确的命名约定来指示用法 - 如果不是为了你自己，那么至少对于可能正在使用你的代码的其他人来说，请参阅CSS中未引用的类，然后将其删除:)

我倾向于有一个特定的类名来标识对象的用途，此外，通常听起来很笼统的类名指定对象的状态。例如

class="toolTip" - 工具提示 class="toolTip open" - 显示状态的工具提示

通过这种方式，您可以轻松地概括行为的命名约定（也可能是它们的 JS 代码）。

此外，通过使用 CSS 来定义不同状态的表示，您的 JS 代码比通过 JS 管理它要优雅得多。例如：

$('div.toolTip').addClass('open');

而不是

$('div.toolTip').css({display: 'block' ... etc etc });

附言。我不认为这是进入 Class vs ID 问题的地方，那真的是一场不同的辩论！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T16:03:38.183

这取决于你所说的“行为”是什么意思。例如，如果你的行为真的只是一种花哨的样式效果，我可能会让它作为一种更高级的样式滑动。

否则，我仍然认为没关系，但我可能会定义一个单独的（空）css 类来控制行为，以保持关注点的分离。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T16:38:22.203

我用它来为仅限数字的字段安装按键过滤器。该类将是“数字”、“十进制”、“负十进制”或“十进制列表”（允许逗号和空格）。这也很容易阅读。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T18:32:37.967

我一直在想这个。现在我认为多类仍然是最好的方法，正如人们所说，这不是不正确的。但是如果没有别的，当你有一百个元素时，它会导致一个混乱的 DOM：

```
<div class="draggable sortable droppable list-item editable text">text</div> 
```

有一些东西，比如标志，你可以用 jQuery 中的 data() 方法来赋值。我很乐意看到 jQuery 的 data() 演变成一个工具，就像我们使用类的方式一样。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-12T23:34:31.870

作为惯例，我喜欢在我的类上使用前缀，以便我知道 css 文件中的类与 Javascript 代码相关联。例如使用“Js”前缀：

.JsButton { ... } .JsToggleElement { ... }

另一种约定是通常只对 css 类和 id 使用小写字母（注意某些浏览器区分大小写！），并为 Javascript 绑定的类使用 CamelCasing。

这一切的原因是，与行为相关联的类通常会方便地采用样式规则。

我还考虑过创建纯粹用于 Javascript 行为的类，并使用一个单独的类来进行样式设置，但那是徒劳无功的。相反，我宁愿在 Javascript 代码中明确定义类：

```
mySuperObject =
{
    CSS_TOGGLE: 'JsToggle',
    CSS_HIDE:   'JsHide',

    initialize:function()
    {
        var elems = SomeJsLib.getElementsByClassname(document, 'a', this.CSS_TOGGLE);
        ... 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-06T01:53:17.713

真的，我不想在这次游行中下雨，因为它实际上似乎是犹太教。但是，我也看到没有人在 W3 建议不要使用 CSS 的那部分底部提到[http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#class-html](http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#class-html)类名形成非标准的微语法。我认为他们主要是在警告我们不要制作完全由 DIV 和 SPAN 元素组成的页面，并使用不同的类作为自定义标签。他们没有特别提到将课程与行为混合。

# c# - 如何读取 de Exchange 数据库？

> ID：532907
> 
> 赞同：1
> 
> 时间：2009-02-10T15:58:49.490
> 
> 标签：c#, database, visual-studio, exchange-server

我正在创建一个必须从 Microsoft Exchange 读取和更新联系人信息（如电话号码、电子邮件等）的应用程序......

有人知道我如何连接到 MS Exchange DB 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T16:13:04.493

WebDAV 是我使用的...

这是我为访问我们的交换服务器而编写的一个函数（请善待我几年前写的）..（：

```
 /// <summary>
    /// Returns XML string for a specific query
    /// </summary>
    /// <param name="Query"></param>
    /// <param name="Account"></param>
    /// <param name="Folder"></param>
    /// <returns></returns>
    private string ProcessRequest(string Query, string Account, string Folder) {

     System.Net.WebRequest req = WebRequest.Create("http://" + MailServer + "/exchange/" + Account + "/" + Folder);
      req.Headers.Add("Depth", "1");
      req.Headers.Add("Brief", "t");
      req.Credentials = ncCurrent;

      Byte[] bytes  = System.Text.Encoding.ASCII.GetBytes(Query);
      req.ContentType = "text/xml";
      req.ContentLength = bytes.Length;
      req.Method = "SEARCH";

      System.IO.Stream oStreamOut = req.GetRequestStream();
      oStreamOut.Write(bytes, 0, bytes.Length);
      oStreamOut.Close();

      WebResponse rsp = req.GetResponse();
      System.IO.Stream oStreamIn = rsp.GetResponseStream();
      System.IO.StreamReader oStreamRead = new System.IO.StreamReader(oStreamIn);
      return oStreamRead.ReadToEnd();
} 
```

这就是我调用它的方式

```
 string xmldata = "<?xml version= \"1.0\"?>" +
    "<g:searchrequest xmlns:g=\"DAV:\">" +
      "<g:sql> Select \"DAV:href\" , \"urn:schemas:httpmail:subject\" " + 
      "FROM Scope('SHALLOW TRAVERSAL OF \"/exchange/" + Account + "/" + Folder + "\"') " +
      "</g:sql>" +
    "</g:searchrequest>";

  XmlDocument d = new XmlDocument();
  d.LoadXml(ProcessRequest(xmldata, Account, Folder)); 
```

希望这会为您指明正确的方向

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:22:42.637

如果您使用的是 Exchange 2007，则可以使用[Exchange Web 服务](http://msdn.microsoft.com/en-us/library/bb204119.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:27:56.040

你可以：

使用扩展 MAPI。在网上寻找 MAPI33。我认为它有你想做的例子。

使用网络服务。这是 2007 年的首选方式

WebDAV 也可以工作，但我认为它在 2007 年根本不工作？

MAPI 是最好的方法，但它在 .NET 中不受官方支持（它可以工作），并且它根本不能在 64 位模式下工作。它只有 32 位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T16:09:31.820

您将不得不使用扩展 MAPI，它不是标准的 SQL 数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T13:15:56.400

*您可以使用 ExchangeManagmentShell 并发出诸如set-mailbox*之类的powershell 命令来更改电子邮件地址。

但如果你只想更新电话号码、房间号码等。这些都存储在 ActiveDirectory 中。

# flash - Flash 全屏在 Flash 播放器版本 9.0.47.0 和 9.0.28.0 中不起作用

> ID：532909
> 
> 赞同：1
> 
> 时间：2009-02-10T15:59:26.447
> 
> 标签：flash, video, actionscript-2

我的 Flash 视频播放器的全屏功能在 Flash 播放器版本 9.0.47.0 和 9.0.28.0 中不起作用。它适用于所有其他版本 9.0.115.0 及更高版本。单击全屏按钮时，该功能会被触发，但视频不会全屏显示，它会在视频播放器内延伸。Flash player 9.0.47.0 和 9.0.28.0 是否需要任何额外的处理？（Flash 代码在 Actionscript 2 中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T18:18:04.397

这可能与 wmode 不透明或透明无窗口时最初不支持全屏模式有关；较新版本的 Flash Player（9.0.64 应该足够了，9.0.115 肯定是）修复了这个问题。

另请注意，您必须拥有 9,0,115,0 或更高版本才能使用硬件缩放的全屏模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T02:09:27.043

我认为这是 Flash 播放器的错误。我们在 9.0.115 以下的 Flash 播放器版本的套接字连接（加载策略文件）方面遇到了很多问题。

但是，在我们的页面上，我们只有少数人使用这个旧版本的 Flash 播放器，它们非常少见，大多数人都有新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T12:50:05.930

一些 9.x 版本有很多 bug。检查您的访问者是否至少有 9.0.115 - 这是非常稳定的版本。

我为此推荐[SWFObject](http://blog.deconcept.com/swfobject/)。它嵌入了 SWF，还允许您指定需要哪个版本 + 有一个快速安装选项。

# oracle - 我的 oracle 10g 会话使用了多少个临时范围？

> ID：532911
> 
> 赞同：1
> 
> 时间：2009-02-10T15:59:53.620
> 
> 标签：oracle, temp-tables

我试图找出连接到我的数据库的每个会话正在使用多少临时空间，但我无法弄清楚。我正在尝试确定特定会话使用的范围数是否过高。

我尝试查看 V$TEMP_EXTENT_POOL 和 V$TEMP_EXTENT_MAP，但似乎找不到将其映射到特定会话的任何内容。

任何关于在哪里看的想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T16:17:51.503

```
SELECT *
FROM v$tempseg_usage 
```

请注意，`TEMPORARY`段由查询使用，而不是由会话使用，并且在查询完成后被释放。

# memory-leaks - 在 Windows 上处理不正确的内存泄漏报告

> ID：532917
> 
> 赞同：2
> 
> 时间：2009-02-10T16:00:46.787
> 
> 标签：memory-leaks

我正在编写一些 Windows 软件，当它终止时，我收到很多不正确的内存泄漏消息：

```
Detected memory leaks!
Dumping objects ->
{29745} normal block at 0x02938E38, 36 bytes long.
 Data: <, E             > 2C 0B 45 10 00 00 00 00 01 00 00 00 01 CD CD CD 
{29732} normal block at 0x02938C08, 500 bytes long.
 Data: <X)A         `  @> 58 29 41 10 00 00 00 00 01 00 00 00 60 93 0B 40 
{29721} normal block at 0x028DA8A0, 84 bytes long.
 Data: < 1D         0 %i> C8 31 44 10 00 00 00 00 01 00 00 00 30 85 25 69 
```

我敢肯定这些都是误报。你对处理这个问题有什么建议吗？随着软件的发展，可能会有一些实际的泄漏，至少可以说很难找到它们。

**编辑**：
我应该提到我正在使用一个名为`OpenSceneGraph`. 它在内部大量使用了引用计数的智能指针。所有这些泄漏都是实例，`new`然后我将其传递到库中，该库会立即将其包装在`ref_ptr<>`. 我知道实例没有泄漏，因为我已添加`fprintf`到析构函数中，并且当智能指针超出范围时我确实看到了消息。微软不久前在标准库中遇到过这样的问题，我想知道我是否在这里看到了类似的东西？显然，该错误与一些`_CRT_BLOCKS`被标记为`_NORMAL_BLOCKS`.

**编辑 2**：

我弄清楚发生了什么事。转储内存泄漏信息的代码发生在所有静态数据超出范围之前。在一种情况下，内部对象是通过原型模式构造的，原型对象是静态的，因此在 atexit 机制启动之前不会被销毁。因此，没有什么是真正的泄漏。只是在应用程序拆卸发生之前发生了转储。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T16:11:39.410

我发现这些都是误报的可能性很小。他们在[*Pragmatic Programmer*](http://www.pragprog.com/the-pragmatic-programmer)中说，[SELECT 没有损坏](http://www.travisswicegood.com/index.php/2009/01/04/select-isn-t-broken)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T18:43:31.200

哪个编译器？

获取另一个分析/泄漏检测工具。（边界检查器等）

我过去得到的误报从未妨碍我发现“真正的”泄漏。

我不同意其他人说你对误报是错误的 - 但请仔细检查 - 检查你所有的“新”并跟踪应用程序逻辑以说服自己这些是错误的。

您还可以在对象中添加保护或标签或内存签名，这样您就可以确保它们不是您创建的东西。

不知道该告诉你什么关于 3rd 方的东西。我会联系第 3 方软件公司，询问他们是否知道任何问题 - 误报或其他问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T09:49:52.283

我还要说你很可能有真正的韭菜（它们也可能在你正在使用的一些第 3 方代码中）。

但是有一种方法可以准确地找到未释放的分配。见这里： http: [//msdn.microsoft.com/en-us/library/w2fhc9a3 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/w2fhc9a3(VS.71).aspx)

（当然，对于其他版本的 VS，您必须在此更改 dll 名称：

```
{,,msvcr71d.dll}_crtBreakAlloc 
```

到正确的版本（msvcr90d.dll = VS 2008，msvcr80d.dll = VS 2005，msvcr71d.dll = VS 2003，msvcr70d.dll = VS 2002）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T16:19:18.020

当我之前遇到过这个问题时（似乎被删除的东西显示为泄露），这通常是因为我忘记或没有考虑替换我新的指针分配。

然后它“似乎”删除得很好，而原来的新对象泄漏了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-22T21:34:55.647

VS 为在 .dll 中分配为静态的内存（不使用 MFC）提供泄漏的内存报告，因为该报告是（出于某种原因）在 .dll 被删除之前生成的（并且当 dll 被正确取消分配时）已卸载）。因此出现误报。

# c# - C# 半透明“灯箱”控件调用父级的绘制方法

> ID：532918
> 
> 赞同：2
> 
> 时间：2009-02-10T16:00:47.130
> 
> 标签：c#, user-controls, lightbox

我正在尝试在我的应用程序中创建[灯箱效果。](http://www.useit.com/alertbox/modal-dialog-box-lightbox-xero.jpg)为了实现这一点，我有一个用户控件，它带有一个代表半透明覆盖的面板和一个单独的面板，其中包含所有必要的内容。

当我展示这个 UserControl 时，它经常尝试渲染自己 2-3 次，导致背景看起来越来越暗。我想过在 UserControl 中执行以下操作

```
protected override void OnPaint ( PaintEventArgs e )
{
    if ( Parent != null )
    {
        Parent.Refresh();
    }

    base.OnPaint( e );
} 
```

不幸的是，这似乎会导致可怕的循环效果，即 Parent red-raws itelf 然后 teh UserControl 重绘 itelf ......非常混乱。有没有办法以某种方式阻止这种情况？可能通过从应用程序中获取打印屏幕图像，在用户控件中显示该图像，并在顶部覆盖？

**编辑**

我注意到了[这个问题](https://stackoverflow.com/questions/72994/-net-winforms-transparent-control)，尽管我希望我不需要为我创建的每个灯箱创建一个新表单！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T19:31:57.400

根据经验，.Invalidate() 通常比 .Refresh() 好得多，因为 .Refresh() 会导致立即重绘，因此如果您调用它两次，则会进行两次重绘。不过，我认为这对您没有多大帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T09:57:27.213

这种行为似乎是因为我在 onPaint 函数中更新了 UserControl 的区域，例如

```
protected override void OnPaint ( PaintEventArgs e )
{
    // Update Region here

    base.OnPaint( e );
} 
```

这显然导致控件自身无效并重新绘制自身以克服我使用过的这个问题：

```
Graphics g = e.Graphics;
g.SetClip( Region, CombineMode.Intersect ); 
```

然后，这可用于减轻不透明灯箱效果，同时允许内容自行绘制。

# hibernate - 使用 Hibernate 映射从 Collection 访问列

> ID：532919
> 
> 赞同：0
> 
> 时间：2009-02-10T16:00:47.223
> 
> 标签：hibernate, collections

请求.hbm.xml：

```
 <id name="reqId" type="long" column="REQ_ID"> 
        <generator class="sequence">
            <param name="sequence">SEQUENCE</param> 
        </generator>
    </id>

    <bag name="lines" lazy="false" >
        <key column="REQ_ID" not-null="true" />
        <one-to-many class="com.Lines" />
    </bag> 
```

线.hbm.xml

```
 <id name="lineId" type="string" column="LINE">
        <generator class="assigned" />
    </id>

    <property name="reqId" type="long" column="REQ_ID" />

    <bag name="comments">
        <key column="LINE" />
        <one-to-many class="com.Comments"/>
    </bag> 
```

评论.hbm.xml：

Req.java 将包含行列表。和 Line.java 有评论列表。

在使用投影检索列时...我如何从 CMNTS 表中检索列。

我可以在 Projection 中使用lines.comments.commentId，我可以检索该列吗？

如何在 CMNTS 表的标准类中定义连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T03:02:48.843

不，您不能只使用“lines.comments.commentId”，您需要使用投影别名来遍历多个集合。看看 Projections.alias()

# vb.net - Windsor IoC 示例帮助 - “未注册的 HttpServiceWatcher&”。

> ID：532923
> 
> 赞同：0
> 
> 时间：2009-02-10T16:01:21.090
> 
> 标签：vb.net, inversion-of-control, castle-windsor

我正在关注 C# 中的[Windsor Inversion of Control (IoC) Getting Started example](http://www.castleproject.org/container/gettingstarted/part1/code.html)，但我在 VB.Net 中实现它，我遇到了一个小问题..

这是我完整的例外：

> 无法创建组件“form.component”，因为它需要满足依赖关系。form.component 正在等待以下依赖项：
> 
> 服务： - 未注册的 InversionOfControl.HttpServiceWatcher&。

但我想我正在注册它 - 这是第一个注册的！

我正在使用 VB 8 (Visual Studio 2005 / .Net 2.0) 和[Windsor 1.0 RC3](http://www.castleproject.org/castle/download.html "温莎下载页面")。

* * *

这是我的**App.vb**：

```
进口 Castle.Windsor

公开课应用

    公共共享子 Main()

        昏暗容器作为新的 WindsorContainer

        '注册组件
        container.AddComponent("httpservicewatcher", _
           GetType(HttpServiceWatcher))
        container.AddComponent("email.notifier", GetType(IFailureNotifier), _
           GetType(EmailFailureNotifier))
        container.AddComponent("alarm.notifier", GetType(IFailureNotifier), _
           GetType(AlarmFailureNotifier))
        container.AddComponent("form.component", GetType(Form1))

        '从容器中请求组件
        Dim aForm As Form = container(GetType(Form1))

        '用它！
        应用程序.Run(aForm)

        '释放它
        容器.Release(aForm)

    结束子

结束类

```

**表格1**

```
公开课形式1

    私有 oServiceWatcher 作为 HttpServiceWatcher

    Sub New(ByRef ServiceWatcher As HttpServiceWatcher)

        ' Windows 窗体设计器需要此调用。
        初始化组件（）

        ' 在 InitializeComponent() 调用之后添加任何初始化。
        Me.oServiceWatcher = ServiceWatcher
    结束子
结束类

```

**HttpServiceWatcher**

```
公共类 HttpServiceWatcher

    私有 oNotifier 作为 IFailureNotifier

    Sub New(ByRef Notifier As IFailureNotifier)
        oNotifier = 通知者
    结束子

    子开始观看（）

        '应该启动一个线程来ping服务
        '如果（pingresult = 失败）
        oNotifier.Notify()
        '万一

    结束子

    子秒表（）

        '停止线程

    结束子

结束类

```

**IFailureNotifier**

```
公共接口 IFailureNotifier

    子通知（）

端接口

```

**AlarmFailureNotifier**和**EmailFailureNotifier**都实现了 IFailureNotifier 但`Notify()`方法为空

* * *

我尝试通过将 IFailureNotifier 放在第一个、HttpServiceWatcher 3rd 和 Form 最后来更改顺序，但我得到了同样的错误。

我已经完成了清理和重建，但我得到了同样的错误。

我显然对此很陌生（因为我正在经历“入门”），你能指出我错过了什么吗？

谢谢 :o)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T17:20:03.037

我不是 VB 奇才，但我怀疑问题出在 New sub 中的 ByRef 关键字。尝试将其更改为：

```
Public Class Form1

    Private oServiceWatcher As HttpServiceWatcher

    Sub New(ServiceWatcher As HttpServiceWatcher)

        ' This call is required by the Windows Form Designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        Me.oServiceWatcher = ServiceWatcher
    End Sub
End Class 
```

# c# - 为什么 Visual Studio 调试模式无法正常工作（按 F11 时执行 F5）？

> ID：532924
> 
> 赞同：5
> 
> 时间：2009-02-10T16:01:21.713
> 
> 标签：c#, visual-studio, visual-studio-2008, debugging

> **可能重复：**
> [为什么 Microsoft Visual C# 2008 Express Edition 调试器随机退出？](https://stackoverflow.com/questions/310788/why-does-microsoft-visual-c-sharp-2008-express-edition-debugger-randomly-exit)

在我的职业生涯中，我遇到了 Visual Studio C# 调试器最奇怪的问题。简而言之，在我的代码中的断点被击中后，我无法单步执行代码。`F11`(step into) 和`F10`(step over) 工作多次，但最终 Visual Studio 执行`F5`(continue) 操作。我仍然可以在每一行上使用断点进行调试。

这种行为会在每个项目开发人员的机器上重现。到处都是 Visual Studio SP1。

我已经检查了每个（据我所知）选项。我已禁用“只是我的代码”。我已禁用“逐步执行属性”。我已禁用自动属性评估。绝望中，我从头开始重新创建了所有项目和解决方案文件。

我的问题有什么解决办法吗？

**更新**此行为只能在此项目上重现。

**更新 2**这似乎不是线程问题：它在 Visual Studio 的开发人员 Web 服务器下重现...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T20:26:03.590

这篇[知识库文章](http://support.microsoft.com/default.aspx/kb/957912)可能对那些找到该线程的人很感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:53:05.723

好吧。这是[NHProf](http://nhprof.com/)的错。我刚刚禁用它并且调试器运行正常。 如果没有母应用程序在旁边运行，[NHProf 会](http://nhprof.com/)生成*SocketException 。*它引发上下文切换。

谢谢你，乔恩·塔卡伯里

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T16:33:20.067

我更改了 Visual Studio 开发服务器的端口（菜单*项目*->*属性*-> *Web* -> *服务器：用户 Visual Studio 开发服务器：特定端口 = 49468），它工作正常。试试看。

# database-design - 为什么要将分隔列表存储在 SQL 文本列中？

> ID：532927
> 
> 赞同：8
> 
> 时间：2009-02-10T16:02:01.633
> 
> 标签：database-design

我必须维护一个应用程序，该应用程序有很多属于文本数据类型的列，其中插入了多个值，这些值用逗号、斜线或有时甚至是竖线 (|) 字符分隔。我试图弄清楚为什么在地球上你会想要这样做。

例如，订单表有一个名为 details 的列，其中包含以下信息：

```
2x #ABC-12345  Widget, Black: $24.99 /4x #ABC-12344 Widget, Blue: $23.50 
```

`/`分隔行项目的位置；有 VBScript 代码从记录集中读取值并在循环中将其解析出来以`For`使用类似的方式显示（这几乎正是代码读取、变量名和所有内容的方式）`arydtls = split(rstmp("details"), "/")`。此方法在整个代码中针对各种表重复。

在我看来，将详细信息放在单独的表中并链接回它会好 100 倍（更不用说更容易使用了）（有趣的是，对于 Orders 它**确实**这样做了，但数据没有始终匹配详细信息文本字段，因为 OrderDetail 表在代码中更新；详细信息字段在应用程序中被视为只读）。

我的前任是否知道我不知道的事情，或者我说“WTF？！！”是对的 当我查看此架构时？看起来它的效率极低且难以维护，并且它使运行报告变得更加困难，因为我需要的数据可能包含在文本字段中，或者它可能位于具有相似信息并用于不同用途的十几个表之一中应用程序的一部分。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T16:03:52.113

两种最可能的情况是：

*   你的前任不称职/不懂规范化
*   您的前任在规范化结构中遇到了一些性能问题，发现这种方法是一种改进

由于规范化在查询操作方面通常会非常昂贵，因此我们有时可以通过消除昂贵的连接并在应用程序端对单行进行操作来获得性能提升。

数据库设计没有绝对规则说“将分隔值存储在单行中更适合这种情况”。这完全是针对您的特定数据集和使用模式进行测试，*并**在*必要时进行改进。

 *以我的经验，这种模式在标准化方面的改进并不是很常见……这很不典型。

编辑：第三种可能性是每行具有 n 值是对原始模式的更改，而不是添加新表，您的前任调整了列的大小。这不一定与“无能”选项不同:) 但有时在数据库模式更改中涉及政治压力......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T01:44:32.520

> 我的前任是否知道我不知道的事情，或者我说“WTF？！！”是对的 当我查看此架构时？

不，你的前任没有。是的你是对的。但是，请参阅最后的注释。

> 看起来它的效率极低且难以维护，并且它使运行报告变得更加困难，因为我需要的数据可能包含在文本字段中，或者它可能位于具有相似信息并用于不同用途的十几个表之一中应用程序的一部分。

这*是*非常低效的。但是，请参阅最后的注释。

列应始终是行的不可分割属性。我在您展示的本列中看到了三个（可能是四个）属性的两个副本：

```
2x #ABC-12345  Widget, Black: $24.99 /4x #ABC-12344 Widget, Blue: $23.50 
```

*   数量（2x/4x）。
*   代码（#ABC-12345/#ABC-12344）。
*   description (Widget, Black:/Widget, Blue:) [可能是描述*和*颜色属性]。
*   价格（24.99 美元/23.50 美元）。

这本来可以更好地设计为：

```
StockItems
    Code char(10) primary key
    Desc varchar(50)
Transaction
    TxnId something primary key
    : : :
TransactionPart
    TxnId something \
    TxnSeq int      / primary key
    Quantity integer
    Code char(10) foreign key StockItems(Code)
    Price float 
```

**笔记：**

这样做可能是为了在数据库中其他地方的值发生变化时保留历史信息。例如，如果库存项目的描述发生更改或项目被删除。

但是，这*仍然*不是处理它的正确方法。在这种情况下，外键约束会阻止项目代码被删除，并且应该有流程来防止更新描述（例如版本控制库存项目代码）。

当然，如果您*永远不会*搜索该列中的任何项目，这是完全有效的，尽管就未来可能搜索它们的功能而言是不明智的。

也许在此表中搜索过的唯一内容是客户代码——那么自由格式的文本字段就足够了。

*我*仍然不会那样做，但可以提出一个 YAGNI 论点，即如果需要添加搜索功能以及何时需要在未来更改 DB 模式会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T16:14:20.153

很简单，他要么有原因，要么没有，不问不可能知道。如果您假设他不是一个完整的想法和某些可能原因的事情，那么可能是以下原因之一。

如果数据仅供参考并且您经常听到*“永远不会改变”*，那么将显示字符串直接扔到现场可能是一个快速的胜利。毕竟，只需用制表符替换管道，用 BR 替换斜线即可将其放在屏幕上非常容易。如果必须非常快速地编写代码**，**那么这可能是一个简单的选择。

自 SQL 2005 以来的一个新特性是 XML 数据类型。其主要用途是您可以针对特定记录存储和索引未知数量的值。你可能关心一件事的颜色，另一件事的尺寸，另一件事的重量。您可能无法生成这些内容的明确列表，并且存储这些数据的真正标准化的通用方法可能对系统来说太慢或过于复杂。这可能是一种尝试获得类似功能的解决方法。

这里的关键是，大多数事情都是有原因的。在试图找出这个原因时，您已经以正确的方式看待它。有一天，您可能会遇到它并想“哦，是的！”。仅仅从你自己的角度看东西通常会导致看不到树木的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T16:04:38.460

真的。永远不要将这些东西存储在数据库中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T16:06:26.367

您的前任可能有其他想法，而这还没有完成？？？

我可以告诉你，这对性能非常不利

您将如何创建一个查询来返回谁购买了蓝色小部件？您将不得不扫描整个表然后解析该信息，如果有另一个表并且这已被规范化，那么这将是更好的性能明智

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T16:08:54.817

我已经在某个企业软件中看到了一个数据库，它在很多地方都有这个。从维护的角度和性能的角度来看，这都非常糟糕。引用的原因一般有：

*   它“更简单”，因为它不需要连接
*   它更快，因为它不需要连接
*   它不会用大量表使数据库混乱

现在，第一点可能是正确的，但它只是“更简单”，直到您想要查询它。现在你完蛋了。所以我会说这被有效地驳斥了。只要您不反对它，第二点又是正确的。一旦你必须读入整个表，解析数据，然后在你的应用程序中过滤行，你就输了。最后一个总是正确的，但谁在乎数据库是否“混乱”？这就是它的目的！体面的 RDBMS 将允许您将表放入多个模式中，这有点像命名空间，有助于消除混乱。一个好的命名约定也有帮助（但如果你使用匈牙利疣，那么请帮助你 $deity）。

简而言之，这是一个坏主意。我希望你被允许修复它，但很可能你只需要按照原来的条件来处理它......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T16:13:50.000

在 Universe 等操作系统中，UniData 数据存储在由类似

Char(254) = 分隔属性 Char(253) = 分隔属性中的多个值 Char(252) = 分隔子子值等等

令人震惊的是不是 :-) 每当我与仍在使用 DataBasic 的前同事交谈时，他们问我使用什么数据库，他们问的第一个问题是“它可以处理多值吗？”

在 RDBMS 中，我们将有一个 Order 表和一个 OrderLine 表。OrderLine 上的 PK 很可能类似于 OrderNumber,LineNumber。

在 UniData 等中，他们要做的是在 Order 中有一个名为“Lines”的属性，该属性将保存 OrderLine 文件的键列表，复合键通常用星号分隔。

*   1234*1
*   1234*2
*   1234*3
*   ETC

然后，当他们将订单从文件加载到内存时，他们有一个键列表，他们需要从 OrderLine 文件加载 OrderLines。请注意，这些是文件而不是表格 :-)

在我看来，就像有过这种旧数据存储方式的人尝试使用关系数据库，但根本不理解它，然后试图让它像 UniData 一样工作。

解雇他们:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T18:13:44.283

我不能说你的前任是怎么想的。正如 Rex M 所说，有时政治压力会导致奇怪的实施。

许多将项目列表填充到表格中的单个值的人试图绕过（旧式）第一范式的限制。不利的一面是查询必须在应用程序中以编程方式完成，而不是在 WHERE 子句中使用简单的 citerion。

大约 10 年前，Oracle 添加了将表放入值的功能。大约在同一时间，Date 重新定义了 1NF，以便所有关系都自动在 1NF 中。这包括包含其他关系的关系。如果没有该功能，最简单和最强大的设计是将重复的项目分解为一个单独的值，每个项目一行。

（例如：学生注册的课程列表）

在很多情况下，根本原因是设计师的无知或固执。再说一次，我不知道你的前任面临什么限制。除非必要，否则不要模仿他。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T18:24:37.237

你为什么要这样做？

回到大约几十年前，我的妻子在 Pick 系统上工作，其中包括一个数据库和一个 BASIC 等。Pick 数据库和语言在将数组放入数据库字段时效果很好（不确定我是否应该将它们称为列）。所以，有一个环境让这完全合理。

我不知道Pick是否还在，但我已经很久没有听说过它了。该表可能是一个 Pick 数据库，被翻译成（严重）为基于 SQL 的数据库，并且编写它的人可能是一个前 Pick 开发人员，他当时还没有学会如何很好地使用关系数据库。

上次我遇到这样的数据库时，我问过。原来它是由一位前 Pick 开发人员设计的。

我不会称这个设计称职，除非这真的是一个只写可忽略的领域，但很可能设计师并不愚蠢。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-11T15:21:00.197

一种可能的，某种合理的原因，可能是**数据结构不固定**，详细属性与订单实例有很大不同。

在数据库强加的静态结构中使用动态属性并不容易。例如，XML 结构更适合这种情况，但考虑到 xml 固有的冗长，“类似 csv”的方法可能是更有吸引力的替代方案。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-17T02:18:07.383

对我来说看起来像个WTF。与其他表的实现方式不一致，肯定效率不高。而且当你在不知道里面的数据的情况下查看架构时，很容易误解列的含义。

但是，过去的开发人员为什么这样做可能是有原因的，您能否给我们更多的信息，比如关于业务逻辑的信息？谢谢

# python - python中基本类型的轻量级泡菜？

> ID：532934
> 
> 赞同：7
> 
> 时间：2009-02-10T16:03:57.417
> 
> 标签：python, serialization, pickle

我想做的就是序列化和反序列化字符串或整数的元组。

我查看了 pickle.dumps() 但字节开销很大。基本上，它看起来占用的空间大约是它需要的 4 倍。此外，我只需要基本类型，不需要序列化对象。

marshal 在空间方面稍微好一点，但结果充满了讨厌的 \x00 字节。理想情况下，我希望结果是人类可读的。

我想只使用 repr() 和 eval()，但有没有一种简单的方法可以在不使用 eval() 的情况下完成此操作？

这是存储在数据库中，而不是文件中。字节开销很重要，因为它可能会在需要 TEXT 列和 varchar 之间产生差异，并且通常数据紧凑性会影响数据库性能的所有领域。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-10T16:28:58.917

看看[json](http://docs.python.org/library/json.html)，至少生成`dumps`的可以用许多其他语言读取。

> JSON（JavaScript Object Notation）[http://json.org](http://json.org)是 JavaScript 语法（ECMA-262 第 3 版）的子集，用作轻量级数据交换格式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T16:47:10.980

我个人会使用[yaml](http://pyyaml.org/wiki/PyYAML)。它在编码大小方面与 json 相当，但在必要时它可以表示一些更复杂的事物（例如类、递归结构）。

```
In [1]: import yaml
In [2]: x = [1, 2, 3, 'pants']
In [3]: print(yaml.dump(x))
[1, 2, 3, pants]

In [4]: y = yaml.load('[1, 2, 3, pants]')
In [5]: y
Out[5]: [1, 2, 3, 'pants'] 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-10T17:39:57.187

也许您没有使用正确的协议：

```
>>> import pickle
>>> a = range(1, 100)
>>> len(pickle.dumps(a))
492
>>> len(pickle.dumps(a, pickle.HIGHEST_PROTOCOL))
206 
```

请参阅[pickle 数据格式](http://docs.python.org/library/pickle.html#data-stream-format)的文档。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-10T17:14:10.680

如果您需要节省空间的解决方案，您可以使用 Google 协议缓冲区。

[协议缓冲区 - 编码](http://code.google.com/apis/protocolbuffers/docs/encoding.html)

[协议缓冲区 - Python 教程](http://code.google.com/apis/protocolbuffers/docs/pythontutorial.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T16:15:16.080

[python 文档](http://docs.python.org/library/persistence.html)中提到了一些持久性内置函数，但我认为在生成的文件大小中没有任何一个明显更小。

你总是可以使用[configparser](http://docs.python.org/library/configparser.html)，但你只能得到 string、int、float、bool。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T16:15:50.570

“字节开销很大”

为什么这很重要？它完成了这项工作。如果您的磁盘空间不足，我很乐意以 500 美元的价格卖给您一个 1Tb。

你跑了吗？性能有问题吗？你能证明序列化的性能是**问题**吗？

“我想只使用 repr() 和 eval()，但有没有一种简单的方法可以在不使用 eval() 的情况下完成此任务？”

没有什么比 repr 和 eval 更简单的了。

评估有什么问题？

是“有人可以在我序列化列表的文件中插入恶意代码”的问题吗？

谁——特别是——会找到并编辑这个文件以放入恶意代码？您为保护这一点所做的任何事情（即加密）都会从中删除“简单”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-09-17T08:09:07.503

幸运的是，有一个使用 COMPRESSION 的解决方案，并解决了涉及任意 Python 对象（包括新类）的一般问题。有时，与其对元组进行微观管理，不如使用 DRY 工具。
您的代码将更加清晰，并且在未来类似的情况下更容易重构。

y_serial.py 模块 :: 使用 SQLite 存储 Python 对象

“序列化 + 持久性 :: 在几行代码中，将 Python 对象压缩和注释为 SQLite；然后在没有任何 SQL 的情况下通过关键字按时间顺序检索它们。数据库存储无模式数据的最有用的“标准”模块。”

[http://yserial.sourceforge.net](http://yserial.sourceforge.net)

[如果您仍然担心，为什么不将这些元组放在字典中，然后将 y_serial 应用于字典。由于 zlib 在后台的透明压缩，任何开销都可能会消失。]

至于可读性，文档还详细说明了为什么选择 cPickle 而不是 json。

# linq - linq grok'ed 假设检查

> ID：532935
> 
> 赞同：1
> 
> 时间：2009-02-10T16:04:04.530
> 
> 标签：linq

如果我的头是正确的，那就对了。

LINQ 使用与 SQL 类似的语法，即 select from where join group + other functions。

之所以可行，是因为`<IEnumerable>`您创建了一个事物列表[表]-您可以在其中进行交互的事物的集合

这是正确的还是遗漏了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:07:19.890

嗯，这是其中的一部分。

LINQ 有多个方面：

*   诸如 lambda 表达式、匿名类型、扩展方法等语言中的“支持特性”。这些并不是 LINQ 的真正组成部分，但 LINQ 依赖于它们。
*   语言集成：将 C# 和 VB 中的查询表达式翻译成通常使用扩展方法的普通代码
*   LINQ to Objects：`System.Linq.Enumerable`使用/产生`IEnumerable<T>`数据序列的扩展方法
*   其他大多数使用`IQueryable<T>`and的 LINQ 提供程序（例如 LINQ to SQL） `System.Linq.Queryable`；这些使用表达式树而不是委托来表达逻辑，以便提供者可以将逻辑转换为数据源的适当形式

# asp.net - 快速创建数据驱动的 Web 前端

> ID：532942
> 
> 赞同：0
> 
> 时间：2009-02-10T16:05:30.753
> 
> 标签：asp.net, database, frameworks

在过去的几年里，我数不清我必须在一个相对简单的数据库模式上创建多少个 Web 前端来使数据输入更加有趣。我不得不想象有人写了一个框架，我可以用它来简化这些简单 GUI 的创建。

快速谷歌一下，以下看起来像 .net 中的主要参与者：

*   ASP.Net 动态数据框架
*   亚音速
*   .net 的 NakedObjects

有没有人使用过这些并有任何偏好？更重要的是，在这个领域是否有其他框架可以很好地评估？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-07T01:04:11.173

就个人而言，我喜欢组合：路由、ASP.NET MVC 2、Linq to SQL 和 UI 模板。您会发现其中内置了一些动态数据概念。您可以将您的类绑定到 html 片段，这些片段几乎提供了可重用的屏幕元素。您可以在类定义之上构建数据验证，部分视图将遵循这些定义。真正快速的设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T16:09:16.843

另请查看[IronSpeed](http://www.ironspeed.com/) - 不是免费的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T23:28:29.987

我喜欢 SubSonic——你可以快速生成一个 AutoScaffold，它允许编辑数据库中的所有表，或者你可以直接在你的网页中使用脚手架控件。这可以是皮肤和样式。 [亚音速脚手架信息在这里](http://subsonicproject.com/web-forms-controls/the-scaffold/)

# flash - Flash 中的 ActionScript 3 时钟示例

> ID：532953
> 
> 赞同：1
> 
> 时间：2009-02-10T16:07:46.673
> 
> 标签：flash, actionscript-3

我目前正在阅读 Adob​​e 提供的名为“Programming ActionScript 3.0”的书。在“使用日期和时间”一章之后，本书提供了一些示例。

[http://livedocs.adobe.com/flex/3/html/help.html?content=Part6_ProgAS_1.html](http://livedocs.adobe.com/flex/3/html/help.html?content=Part6_ProgAS_1.html)

但是，他们的存档仅包含 Flex 版本的源代码。这是我尝试让它在 Flash CS4 中工作：

[http://www.mediafire.com/download.php?j2gkyyntqdo](http://www.mediafire.com/download.php?j2gkyyntqdo)

我更改了源文件以扩展 sprite 而不是 UIComponent，并在第一帧中添加了一些动作脚本：

```
import com.example.programmingas3.clock.*;

var a:SimpleClock = new SimpleClock();
a.initClock(100); 
```

这可以编译，我什至可以在输出窗口中看到我的跟踪命令的结果，但是 initClock 函数中的 addChild 不会向显示添加任何内容。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T16:15:43.613

尝试添加到下面的代码：

```
addChild(a); 
```

将其添加到舞台。

# visual-studio-2008 - VS 2008 编码和 MSBuild 执行任务

> ID：532966
> 
> 赞同：2
> 
> 时间：2009-02-10T16:11:55.137
> 
> 标签：visual-studio-2008, encoding, msbuild

我有一个 msbuild exec 任务，它调用一个 cmd 文件来设置我的数据库。

我正在使用这样的 msbuild exec 任务：

```
 <Exec Command="$(SqlFolder)\Setup\SetupDatabase.cmd $(DBServer) MyDB $(SqlCmdRunner)" IgnoreExitCode="False">
        <Output TaskParameter="ExitCode" ItemName="DBSetupExitCode"/>
    </Exec> 
```

在 setup cmd 中，它使用 osql 来运行我的 sql 脚本。

一切都很好，除了当我在 VS 2008 中创建一个 sql 文件（表/存储过程等）时，当我从 MSBuild 运行时，编码（UTF-8？）会导致问题。我收到一个不正确的语法错误（靠近一个看起来像 U 的字符），但语法是正确的。如果我在 MSBuild 之外执行 cmd，它会按预期工作。

如果我将 sql 文件“另存为”并“使用编码保存”US-ASCII，msbuild 不会出错，这就是我认为这是编码问题的原因。

虽然“另存为”目前有效，但似乎应该有更好的方法。我想其他人使用 MSBuild 来设置他们的数据库遇到了这个问题，所以寻找建议/提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T16:30:10.270

这确实是一个奇怪的问题。解决方法是更新 Visual Studio 2008 用于创建 SQL 文件的模板格式。只需在记事本中打开它们并保存为 ANSI（或 unicode，随您喜欢）。从那时起，当您在 Visual Studio 中创建新的 SQL 文件时，它将自动获得正确的编码。

您会在此目录下找到五个需要更新的 .SQL 文件：
C:\Program Files\Microsoft Visual Studio 9.0\Common7\Tools\Templates\Database Project Items

# c - 在 Emacs 中缩进 C 块注释

> ID：532981
> 
> 赞同：6
> 
> 时间：2009-02-10T16:15:07.500
> 
> 标签：c, emacs, comments

我正在尝试配置 emacs 以很好地缩进我的 C 块注释。

Emacs (22.3) 默认情况下（不管缩进样式）：

```
/* 我很长的评论，分布在多行
* 因此需要填写。
*/

```

但我更喜欢的是：

```
/* 我很长的评论，分布在多行
 * 因此需要填写。
 */

```

我尝试使用 c-offset-alist 和语法符号“c”，但它并没有帮助我理解问题：

```
(c-add-style "mine"
             '((c-basic-offset . 2)
               (c-block-comment-prefix . "* ")
               (c-offsets-alist
                (c . +)))
             ) 
```

有任何想法吗？提前致谢！

干杯，丹尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T18:12:22.570

嗯，它在这里与 22.3.1 一起工作，并以不加载任何个人或站点 lisp 文件的“-Q”选项开始。很抱歉没有太多帮助，但我认为这是您的设置。尝试执行“emacs -Q”，看看您是否仍然看到同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T18:12:12.053

您可以尝试将 c-block-comment-prefix 更改为“*”，

或确保 c-comment-prefix-regexp 是 '//+\\ | \\**'。

这是相关的[GNU.org CC 模式手册页](http://www.gnu.org/software/emacs/manual/html_node/ccmode/Custom-Filling-and-Breaking.html)。

# c# - 如何从 DataValueField 中提取值？

> ID：532982
> 
> 赞同：0
> 
> 时间：2009-02-10T16:15:11.027
> 
> 标签：c#, .net, asp.net, sql, sql-server

我有一个从 SQL 数据库读取的下拉列表。根据选择的选项，我想从 DataValueField 中提取实际的“值”。我怎么做？

```
Page_Load(object sender, EventArgs e)
{
...
ddlOption.DataTextField = "Option";
ddlOptions.DataValueField = "OptCode";
...
}

protected void ddlOptionSelectionChange(object sender, EventArgs e)
{
...
string menuOption = "";//NEED ACTUAL VALUE BASED ON OPTION SELECTED IN OPTCODE
...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T16:17:59.460

我认为 ddlOptions.SelectedValue 是您正在寻找的。

请注意，如果没有选择任何项目（即 ddlOptions.SelectedIndex == -1），则返回 string.Empty。

# xml - 我可以将 xslt 链接到另一个 xslt 吗？

> ID：532985
> 
> 赞同：8
> 
> 时间：2009-02-10T16:15:31.087
> 
> 标签：xml, xslt

基本上我想让一个 xslt 成为我的“基础”xslt，并希望将它链接到子 xslt 文件中。

这可能吗？

目的是减少代码重复。

我们将为各种客户提供许多子 xslt 文件，它们都有自己的格式和附加文本等，并且不想为每个客户 xslt 重复基本代码。

我知道我们可以根据客户的类型进行格式化，但这会使 xslt 变得混乱。理想情况下，就像每个客户的客户相关代码一样。

这不是做xslt的方法吗？我是 xslt 的新手！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T16:19:12.950

```
<xsl:import href="library/utility-include.xsl" /> 
```

href 路径是相对于当前 xsl 文件的。[`<xsl:import/>`文档](http://www.w3schools.com/Xsl/el_import.asp)。

请记住，您必须将导入行写为`<xsl:stylesheet>`or的第一个子元素`<xsl:transform>`。它们不能出现在您的文件中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-10T17:35:12.597

**正如所有其他答案所指定的，有两个 XSLT 指令**：

**[`<xsl:import>`](http://www.w3.org/TR/xslt#import)**

和

**[`<xsl:include>`](http://www.w3.org/TR/xslt#include)**

正是为了提供这种能力而设计的。

**您可能会感兴趣的是，有完整**的模板和函数库可以在内部导入该库的其他样式表。该库的样式表旨在导入到用户的 XSLT 样式表中。

例如，请查看用于 XSLT 中的函数式编程的[**FXSL 库**](http://fxsl.sf.net)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-25T05:54:15.877

所有其他答案都为您提供了足够的信息，
我想在这里提到一件更重要的事情..您甚至可以**在两者之间“传递（双向）参数”**（调用和被调用文件，如果它们需要共享任何数据）**xslt文件 ..**
此功能在 XSLT 1.0 版/之后起着重要作用，您将来可能需要它 ..
:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T16:19:12.233

是的，您可以 - 您可以`include`和`import`其他 XSLT。

[这是开始了解`import`](http://www.w3schools.com/Xsl/el_import.asp)您正在寻找的具体内容的好地方。 `include`不同但值得了解。

# delphi - Delphi/Pascal 有静态代码分析工具吗？

> ID：532986
> 
> 赞同：36
> 
> 时间：2009-02-10T16:15:31.820
> 
> 标签：delphi, static-analysis, pascal

Delphi/Pascal 有静态代码分析工具吗？

我已经看到很多 C++ 和 .NET 的选项，但对于 Delphi/Pascal 却没有。

理想情况下，可以集成到持续集成系统中。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-10T17:07:34.627

[帕斯卡分析器](http://www.peganza.com/)很好。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-10T17:10:26.227

如果您想要一些可以为您的代码提供各种软件指标（复杂性等）的东西，那么我强烈推荐 Campswood [Software](http://www.campwoodsw.com)的 SourceMonitor 。它也适用于 C 和 C++，而且是免费的。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-10T17:42:57.477

Delphi 的 Architect 版本具有非常强大的审计和度量功能，可以对您的代码进行全面分析。该功能提供了对源代码的完整分析。我认为这是一个非常被低估的功能。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-10T18:59:20.990

[CodeHealer](http://www.socksoftware.com/codehealer.php)做源代码分析和验证

BDS2006 附带一个版本，但可见性提示的数量限制为每个类别 4 个。 [看看这个链接](http://www.socksoftware.com/forums/viewtopic.php?f=4&t=255)

它在一个小项目上运行良好，但是这个限制使它很难在一个大项目上使用，如果不是不可能的话。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-10-20T15:27:05.290

There is a new [FixInsight](http://sourceoddity.com/fixinsight/) tool which does source code analysis and verification.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-10T17:36:51.330

[Pascal Analyzer](http://www.peganza.com/)，Delphi 2006+ 内置了审计和指标，[Source Monitor](http://www.campwoodsw.com/)和[Code Healer](http://www.socksoftware.com/codehealer.php)是我所知道的 - 所有这些都非常有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-27T16:29:00.507

On Sourceforge there is a project [Delphi Code Analyzer DCA](http://sourceforge.net/projects/dca/) with quite many downloads and last activity in 2009, maybe interesting

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T17:04:24.060

AutomatedQA 的 AQTime 提供了静态分析探查器。我从未使用过此分析器，但对我经常使用的那些 AQTime 分析器感到满意。如果您走这条路，您可以将 AQTime 与 TestComplete 集成以完成此类分析，作为持续集成方法的一部分。

# java - 如何防止 Netbeans 像这样打印行 // 打印代码时？

> ID：532988
> 
> 赞同：1
> 
> 时间：2009-02-10T16:15:50.430
> 
> 标签：java, netbeans, printing, comments

我试图阻止 Netbeans 打印这样的声明

```
// <editor-fold defaultstate="collapsed" desc=" UML Marker "> 
// #[regen=yes,id=DCE.B7E25FE1-C10B-ED91-77...
// </editor-fold> 
```

无需从代码中删除它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T20:57:56.990

当您从 Netbeans 中创建的 UML 图生成代码时，会添加您发布的编辑器折叠。此 UML 标记用于 UML 和您的 Java 类之间的源代码同步。因此，一种选择是不使用 UML 源代码生成功能。

UML 代码生成使用模板来生成代码。您可以在工具 -> 选项 -> UML -> 域模板下管理正在使用的模板。

这些模板是可自定义的，请参阅[NetBeans UML 自定义代码生成](http://www.netbeans.org/kb/docs/uml/codegen.html)文档。

# c# - UI 测试框架 + 持续集成？

> ID：532994
> 
> 赞同：10
> 
> 时间：2009-02-10T16:17:47.820
> 
> 标签：c#, winforms, unit-testing, continuous-integration, cruisecontrol.net

所以我有一个我继承的应用程序，我想围绕它构建一个自动化测试套件。该应用程序在设计时并未考虑可测试性，并且代码是“大泥球”。我的计划是使用 UI 自动化测试框架并在 UI 级别创建一套测试，直到我有足够的覆盖率，让我可以自信地开始重构并在代码中引入一些接缝以提高可测试性和设计。

这是一个 .Net WinForms 应用程序，我知道的两个框架是：

[NUnitForms](http://nunitforms.sourceforge.net/)

和

[白色计划](http://www.codeplex.com/white)

从我读到的内容来看，这两个框架在尝试作为自动构建（持续集成）的一部分运行时都会出现问题，因为大多数 CI 产品作为 Windows 服务运行，如果 UI 使用模式对话框，则应用程序将死得很惨死亡。我使用 CruiseControl.Net 作为我的 CI 工具。

有没有人有任何建议来解决这个问题？使用的替代框架可能会使情况变得更好？

谢谢，

迪伦

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T17:50:04.010

NUnitForms 有一个“隐藏桌面”功能，可以让你从 cc.net 运行单元测试。

[http://automaticchainsaw.blogspot.com/2007/09/winforms-testing-using-nunitforms.html](http://automaticchainsaw.blogspot.com/2007/09/winforms-testing-using-nunitforms.html) [http://automaticchainsaw.blogspot.com/2007/09/hidden-desktops-and-nunitforms.html](http://automaticchainsaw.blogspot.com/2007/09/hidden-desktops-and-nunitforms.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T22:56:22.667

您实际上可以通过控制台应用程序运行巡航控制，因此它可以进行交互式桌面访问。如果服务器重新启动或崩溃，它不会自动恢复，但至少你可以做到。

也就是说，大多数人采用自动化 UI 测试（winforms、wpf 或 web）的方法是通过构建服务器运行所有非交互式测试。一旦这些测试通过，他们就会将应用程序部署到测试环境并手动触发针对新构建的代码版本的测试运行。

这使人们有机会重置测试环境（对 UI 测试很重要），并检查新版本的应用程序是否正确构建以及所有单元测试是否通过。毕竟，如果您知道单元测试失败了，那么运行 UI 测试毫无意义。:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T16:24:00.037

我还没有尝试过，但是有来自 Microsoft的[UI 自动化框架：](http://msdn.microsoft.com/en-us/library/aa348551.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-06T13:26:03.793

我们在控制台模式下运行持续集成验收测试，而不是作为登录 Virtual PC 中的 Windows 服务。这对我们有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-28T11:18:04.323

看看[这个方法](https://github.com/theqaangel/custom-test-framework)。[该项目的 wiki](https://github.com/theqaangel/custom-test-framework/wiki)中有详细信息。***************