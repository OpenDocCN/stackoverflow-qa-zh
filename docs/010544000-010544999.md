# StackOverflow 问答 10544000-10544999

# javascript - Skype check.js 中出现 5x5 方点

> ID：10544002
> 
> 赞同：1
> 
> 时间：2012-05-11T00:47:27.760
> 
> 标签：javascript, html, skype

所以我正在尝试向页面添加一个简单的 Skype 呼叫按钮。除了出现在页脚底部的一个令人讨厌的小白点外，它工作正常。

这是脚本来源：

```
 <script  src="http://download.skype.com/share/skypebuttons/js/skypeCheck.js"></script> 
```

所以在那个脚本中有一个 detectionswf 对象，id 是“skypedetectionswf”。还有一个 5x5 的 div 容器。

我的问题是我到底该如何隐藏这个小痘痘？

我把它直接放在下面但没用：

```
<script> document.getElementById("skypedetectionswf").style.visibility='hidden'; </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T00:49:56.540

使用 CSS：

```
#skypedetectionswf{
    display: none;
    margin-left: -10000px;
} 
```

# iphone - iPhone，屏幕被绘制在最顶部，然后在决斗应用程序的菜单栏后开始绘制

> ID：10544008
> 
> 赞同：0
> 
> 时间：2012-05-11T00:48:41.453
> 
> 标签：iphone, ios, ipad

我有一个奇怪的错误。我有一个双应用程序。首次运行时，y 为零位于电池和信号强度条下方的最顶部。当它转到另一个视图控制器时，它工作正常，所有东西都向下移动，所以 y=0 就在菜单栏的正下方。当它返回到第一个视图控制器时，它也被绘制成 y 位于菜单栏之后。

这从来没有发生在我身上，这是否与成为双重应用程序（我的第一个双重应用程序）有关 Ted

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:14:13.007

创建通用应用程序时，我遇到了类似的问题。见这里：[奇怪的 UIView 坐标问题](https://stackoverflow.com/questions/10435814/weird-uiview-coordinate-issue)

问题是 XIB 中视图的自动调整大小。一旦我进入 IB 并修复了它（更改它或删除了所有自动调整大小选项），事情再次正常工作。

# c++ - 库中的静态变量对于所有对象来说都是相同的值吗？

> ID：10544010
> 
> 赞同：1
> 
> 时间：2012-05-11T00:49:20.340
> 
> 标签：c++, static, shared-libraries, static-libraries

假设我正在尝试生成特定于进程的 id：

```
class TestLib
{
  public:
  static int n;

  static int generate_id(){
    srand (time(NULL));
    if (n == 0)
    n = rand() % 10 + 1;

    return n;
  };
}; 
```

我有包含 TestLib 的库 A 和 B：

```
class TEST_A
{
  public:
    static void print() {
      std::cout << "A" << TestLib::generate_id() << std::endl;
    };
};

class TEST_B
{
  public:
    static void print() {
      std::cout << "B" << TestLib::generate_id() << std::endl;
    };
}; 
```

我是否可以保证使用 A 和 B 的任何单个进程都将具有相同的 ID？

如果我静态链接库，这会改变吗？

我已经在 linux-x86 中使用共享对象对此进行了测试，但我不确定这在原则上有多安全。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T00:54:58.853

不，除非您的程序是单线程的，否则您无法保证。否则，两个并发调用`generate_id`可能会覆盖彼此的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T00:54:49.167

常规（链接）库将共享其静态变量，但动态库将各自获得自己的副本。

希望您在源文件中有一些初始化`n`为零的东西。

# c++ - 为什么 std::allocator::construct 和 std::allocator::destroy 以元素类型为模板？

> ID：10544014
> 
> 赞同：8
> 
> 时间：2012-05-11T00:49:32.593
> 
> 标签：c++, c++11, allocation, allocator

`std::allocator`的`construct`和`destroy`成员函数根据要构造的元素的类型进行参数化：

```
template<class T>
  class allocator
{
  public:
    typedef T value_type;
    typedef T* pointer;

    template<class U, class... Args>
      void construct(U *p, Args&&... args);

    template<class U>
      void destroy(U *p);

  ...
}; 
```

这样做的理由是什么？为什么他们不接受`value_type*`or `pointer`？似乎`allocator<T>`应该只知道如何构造或销毁类型的对象`T`。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-11T01:08:00.707

出于同样的原因，`allocator`s 必须具有`rebind<U>`typedef：因为许多容器从不分配`T`s。

采取链表。这些分配节点，每个节点都*包含*一个`T`作为成员。所以`allocator`s 需要能够分配一些他们不知道的类型（通过`rebind<U>`）。但是，这需要一个复制操作：它需要创建一个新的类型的分配器`rebind<U>::other`。

最好尽可能避免这种情况。因此，对于构造和销毁，分配器需要对任何类型进行适当的操作，例如链表的内部节点类型。这也使得链表的内部节点类型可以`Allocator::construct/destruct`作为友元函数。

# jquery - 指innertext挂镀铬

> ID：10544015
> 
> 赞同：0
> 
> 时间：2012-05-11T00:49:36.930
> 
> 标签：jquery, arrays, find, each

代码如下。照原样，当 Chrome 调试器到达“result.push(...”时，它在崩溃之前永远不会回来。但是如果我注释掉“result.push(...”并取消注释“alert(.. .”，它运行良好，即它向我显示了我的“divedit” div 中的每一行，并且它永远不会崩溃。我很难过。

TIA

```
function getDivEditLines(divedit) {
    var result = new Array();
    $(divedit).find("div:not(:has('div'))").each(function(){
        result.push($(this)[0].innerText);
        //alert($(this)[0].innerText);
    });
    return result;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T00:58:05.333

如果您使用 jquery 为什么不使用`text()`：

```
var getDivEditLines = function ($divedit) {
    var result = [];
    $divedit.find('div')
        .filter(function () {
            return !$(this).find('div').length;
        })
        .each(function () {
            result.push($(this).text());
        });
    return result;
} 
```

# gcc - 如何确定构建 gcc 工具链的选项？

> ID：10544018
> 
> 赞同：0
> 
> 时间：2012-05-11T00:49:54.217
> 
> 标签：gcc, toolchain

我有一个非常旧的 gcc 工具链，我想用与旧工具链完全相同的配置选项重建新的工具链。假设我只有旧工具链的二进制文件，有什么方法可以确定工具链配置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T00:58:03.703

试试“gcc -v”：

> $ gcc -v
> 
> 使用内置规范。目标：x86_64-linux-gnu 配置：../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.4.4-14ubuntu5.1' --with-bugurl=file:///usr/share /doc/gcc-4.4/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.4 --enable-shared --enable- multiarch --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/ usr/include/c++/4.4 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-objc-gc -- disable-werror --with-arch-32=i686 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64- linux-gnu 线程模型：posix gcc 版本 4.4.5 (Ubuntu/Linaro 4.4.4-14ubuntu5.1)

# jquery - jQuery 的隐藏和显示方法在 IE8 中不会冒泡计算的高度

> ID：10544020
> 
> 赞同：0
> 
> 时间：2012-05-11T00:50:06.850
> 
> 标签：jquery, internet-explorer-8, show

使用：jQuery 1.7.1

我在 IE8 中看到一个问题，我有一个容器 div，当使用 hide() 和 show() 在其中隐藏/显示子元素 (UL) 时，无法正确计算其高度。

这个容器 div 是一个封装模块内容的模块体。每当模块中的某些内容需要调整模块的高度/宽度时，我们的模块都需要调用一个刷新方法，这是因为它们需要一个固定的高度才能正确渲染它。它通过抓取容器 div 的高度来做到这一点，但是当我在 IE 中展开或折叠内部部分时，容器 div 不会重新计算其高度。

我发现如果我用 .addClass("display-none") / .removeClass("display-none") 替换所有 hide() show() （其中 .display-none{display:none;}）它修复这个问题。但是，我希望有一个 css 解决方案，我仍然可以使用显示和隐藏、一些我不知道的规则或 IE 问题/hack。

**我想问的问题是为什么？**

这里有一些更多的细节，

1.  我隐藏和显示的项目是来自内部构建的树小部件的节点组，该小部件由嵌套的无序列表组成，也就是隐藏和显示正在应用于`<ul>`s。
2.  我在树节点中隐藏和显示元素有另一个动作，这个动作确实会导致容器 div 正确地重新计算其高度。
3.  包装树的其他 div 确实重新计算正确，由于某种原因它停止在容器 div 处冒泡。

如果代码示例或 html 示例有帮助，我也可以提供，但我真的很想看看是否有人碰巧对我遇到的问题有一个更一般的概念。

这是容器的样式

```
.module > div > div > * {
    word-spacing: normal;
}

.module-content-data {
    max-width: 962px;
    padding: 10px 10px 0;
}

* {
    margin: 0;
}

.module {
    word-spacing: -1em;
}

Inherited fromdiv.main
.main {
    word-spacing: -1em;
}

Inherited frombody
body {
    color: #333333;
    font-family: Arial,Calibri,Verdana,Helvetica,Sans-Serif;
    font-size: 11px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:35:01.800

我最终确实找到了解决方案，但仍然没有找到原因。显然在 IE8 中 $.hide() 和 $.show 在某些情况下没有正确设置计算高度。但是，我修改了我的方法，改为使用 addClass("display-none") 调用并正确计算高度。我希望这有助于任何其他有类似问题的人。

更新：在具有相同问题的另一个页面上，上面列出的“修复”无效。所以我还是不知道。如果我发现更多，会更新。

# jquery - 使用fancybox在模态窗口中加载特定的div

> ID：10544021
> 
> 赞同：0
> 
> 时间：2012-05-11T00:50:08.700
> 
> 标签：jquery, ajax, jquery-plugins, fancybox

我正在使用fancybox 2。我已经设法通过AJAX 在fancybox 中加载内容。但它会加载整个页面，我只对特定的 div 感兴趣。在 fancybox 1 中，我们可以通过在 ajax 中添加过滤器来做到这一点。但我不确定如何在fancybox 2 中过滤。

如何从fancybox 2中的AJAX加载页面中过滤特定的div？

```
 $(".fancybox").fancybox({
        maxWidth    : 800,
        maxHeight   : 600,
        fitToView   : false,
        width       : '70%',
        height      : '70%',
        autoSize    : false,
        closeClick  : false,
        openEffect  : 'none',
        closeEffect : 'none',
        type        : 'ajax',
        'ajax'      : {
            dataFilter: function(data) {
            return $(data).find('#modalArticleContainer')[0];
        }
    }); 
```

直到 ajax 它可以工作但会加载整个页面，当我添加过滤器时它会停止工作。这就是我之前在 fancybox 1 中所做的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T06:45:17.383

如果您使用的是最新的（https://github.com/fancyapps/fancyBox/zipball/master），那么有一个技巧可以从 ajax 响应中加载特定元素 -

```
<a href="mypage.html #my_id" class="fancybox fancybox.ajax">Load ajax</a>

$(".fancybox").fancybox(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-02T10:57:00.737

我已经使用`afterLoad`回调来更新内容以找到您的特定元素来实现这一点。

```
$('.fancybox').fancybox({
 afterLoad   : function() {
  this.content = $("<div>").html(this.content).find("#main-content").html();
 }
}); 
```

所以在这个例子中，只会`#main-content`加载元素中的内容。

这使我们可以只在移动设备上点击链接，但在桌面上加载fancybox内的页面，而不需要页眉和页脚等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-02T10:09:23.987

有了[fancybox 3](http://fancyapps.com/fancybox/3/docs/#ajax)，它就更简单了：

```
<a data-fancybox data-type="ajax" data-src="my_page.com/path/to/ajax/" data-filter="#yourDivId" href="javascript:;">AJAX Content</a> 
```

看[演示](https://codepen.io/fancyapps/pen/xrKxXp?editors=1100)

# iphone - 如何使用翻转动画显示 MapView 选项？

> ID：10544023
> 
> 赞同：1
> 
> 时间：2012-05-11T00:50:11.127
> 
> 标签：iphone, objective-c, ios, mkmapview

如何通过底部动画翻转在 mapView 中显示选项？就像 iPhone 中的原始地图应用程序一样？像这样：

![像这样](../Images/ba5ece256ec20c709bc3a4620716469e.png)

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T00:53:24.407

将底层视图呈现为模态控制器并使用过渡样式 - 部分卷曲。像这样：

```
controller.modalTransitionStyle = UIModalTransitionStylePartialCurl;
[self presentModalViewController:controller animated:YES]; 
```

**更新：** 在 iOS6 中你应该这样做：

```
SecondeViewController *nextView = [[SecondeViewController alloc] init];
nextView.modalTransitionStyle = UIModalTransitionStylePartialCurl;
[self presentViewController:nextView animated:YES completion:Nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:18:29.570

```
UIViewAnimationTransition transition = UIViewAnimationTransitionCurlUp;
UIViewAnimationCurve curve = UIViewAnimationCurveEaseInOut;
[UIView beginAnimations:@"anim" context:NULL];
[UIView setAnimationCurve:curve];
[UIView setAnimationTransition:transition forView:[self view] cache:YES];
[UIView setAnimationDuration:1.0f];
[UIView commitAnimations]; 
```

# ruby-on-rails - 为什么我的 html 没有出现在我的 ruby on rails 应用程序中？

> ID：10544024
> 
> 赞同：0
> 
> 时间：2012-05-11T00:50:14.427
> 
> 标签：ruby-on-rails

所以我正在尝试添加对此应用程序中的微博的回复[https://github.com/railstutorial/sample_app_2nd_ed](https://github.com/railstutorial/sample_app_2nd_ed)

我想我弄清楚了所有的模型和控制器的东西，但这不是重点。

当我尝试向 app/views/microposts/_micropost.html.erb 添加回复链接时。它永远不会起作用。

```
<li>
  <span class="content"><%= micropost.content %></span>
  <p>this text doesnt show up!</p>
  <span class="timestamp">
    Posted <%= time_ago_in_words(micropost.created_at) %> ago.
  </span>
  <% if current_user?(micropost.user) %>
    <%= link_to "delete", micropost, method:  :delete,
                                     confirm: "You sure?",
                                     title:   micropost.content %>
  <% end %>

  <%= link_to "reply", new_comment_path(:micropost_id => comment) %> |

  <p> why isnt this working!!?</p>
</li> 
```

如您所见，我已尝试在第 3 行、第 13 行和第 15 行添加基本文本或回复链接。它永远不会出现。我做错了吗？我应该以什么格式放置回复链接/甚至是我想要显示的基本文本？

这是我的微柱控制器代码

```
class MicropostsController < ApplicationController
  before_filter :signed_in_user
  before_filter :correct_user,   only: :destroy

  def create
    @micropost = current_user.microposts.build(params[:micropost])
    if @micropost.save
      flash[:success] = "Micropost created!"
      redirect_to root_path
    else
      @feed_items = []
      render 'static_pages/home'
    end
  end

  def destroy
    @micropost.destroy
    redirect_back_or root_path
  end

  private

    def correct_user
      @micropost = current_user.microposts.find_by_id(params[:id])
      redirect_to root_path if @micropost.nil?
    end
end 
```

这是我的评论控制器

```
class CommentsController < ApplicationController 
  def create 
    @comment = @micropost.comments.new(params[:comment]) 
    if @comment.save 
      redirect_to @user
    else 
      redirect_to @user
    end 
  end 

  def destroy
    @comment.destroy
    redirect_back_or root_path
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:37:57.863

在你的 index.html.erb 中大概是这样的

```
<% @microposts.each do |micropost| %>
  <%= render partial: 'micropost', locals: { :micropost => micropost} %>
<% end %> 
```

部分名称就是文件的名称减去 _ 和 .html.erb。局部变量将变量传递给部分

# hibernate - Hibernate 代理并不总是加载对象

> ID：10544025
> 
> 赞同：1
> 
> 时间：2012-05-11T00:50:15.243
> 
> 标签：hibernate, proxy

我有一个 Hibernate 实体，我已经使用了一段时间，没有任何问题。我添加了一些代码来保护带有状态变量的方法（没有任何问题），在单独的事务中设置和清除状态。这给我在同一个类中访问本地私有变量的方法带来了问题。以前我可以直接访问这些变量，但现在我必须使用 get 方法来检索变量，否则我会得到这些变量的卸载值。

以下是有效的初始代码

*   开启交易
*   通过 Hibernate 获取对象
*   调用方法 (doTheWork())
*   引用私有变量
*   我看到变量的保存值，而不是初始化为 (1) 的值

    ```
     public class Desktop
        {
            public static void main()
        {
            String tx = createTransaction();
            Desktop desktop = getDesktop(tx);
            desktop.doTheWork();
            commitTransaction(tx);
        }

        private static Desktop getDesktop(String tx)
        {
            return (Desktop)txFactory.getSession(tx).load(Desktop.class, 5L);
        }
        Long nextVersion = new Long(1);

    public Long getNextVersion()
    {
        return nextVersion;
    }

    public void doTheWork()
    {
        Log.info("Value of nextVersion is " + nextVersion);
    } 
    ```

    }

下面是修改后的代码

*   打开事务并获取对象
*   调用方法
*   在单独的事务中设置状态变量
*   打开另一个事务并在新事务中获取此对象的副本
*   调用（本质上）相同的方法（doTheWorkImpl（））
*   现在我看到了变量 (1) 的初始化值，而不是持久化的值。

    公共课桌面

    ```
    public static void main()
    {
        String tx = createTransaction();  // Hibernate transaction
        Desktop desktop = getDesktop(tx);  // Fetch object using Hibernate
        desktop.doTheWork();
        commitTransaction(tx);
    } 
    ```

    长 nextVersion = new Long(1);

    ```
    public Long getNextVersion()
    {
        return nextVersion;
    }

    private void doTheWork()
    {
        String tx = createTransaction();
        setState(State.BUSY);
        commitTransaction(tx);

        tx = createTransaction();
        Desktop desktop = getDesktop(tx);
        desktop.doTheWorkImpl();
        commitTransaction(tx);

        tx = createTransaction();
        setState(State.NORMAL);
        commitTransaction(tx);
    }

    private void doTheWorkImpl()
    {
        Log.info("Value of nextVersion is " + nextVersion);
    } 
    ```

    }

如果我更改对变量的直接引用以调用 getNextVersion()，我会看到正确的值。

我知道 Hibernate 使用代理，但我不明白为什么这段代码以前有效，现在我需要强制加载代理。我们有很多基本相同的 Hibernate 对象（通过 Hibernate 加载后直接引用变量），所以我想了解我在这里介绍的会改变模式的内容。

我在这里看到一个答案，建议使用 session.get() 而不是 session.load()，但我们一直使用 load，就像上面的代码一样。

# css - CSS问题：为什么侧边栏不可点击？

> ID：10544027
> 
> 赞同：0
> 
> 时间：2012-05-11T00:50:30.167
> 
> 标签：css, wordpress

[http://speedsociety.com/](http://speedsociety.com/)

如果您查看我的网站，左侧边栏下方的 instagram 小部件都不可点击（在第一个之后）......是 content_wrapper div 阻止了它吗？我在萤火虫中玩了一段时间，似乎无法解决这个问题..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T00:56:39.510

要解决您当前的问题，请更新您的 css `sidebar_left`：

```
.sidebar_left {
    float: left;
    padding-left: 20px;
    position: relative; // added
    width: 188px;
    z-index: 1; // added
} 
```

这将打开左栏，使其可供点击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T00:54:39.463

是的，您的 content_wrapper 是问题所在，它的左边距为负。我还在试图理解为什么会这样……哦，好吧，Zuul 比我快。他的建议肯定会奏效，如果这对你来说没问题，那么，没关系！但我相信你可以更好地组织你的 html/css，甚至不需要使用 z-index。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T00:54:47.973

你`div.content_wrapper`正在阻止它。
您必须设置一个更高的值`z-index`才能使其高于它。;)

![在此处输入图像描述](../Images/bfde6edcd2966007711a85a0011d3676.png)

# javascript - 如何用时钟重复 javascript 函数

> ID：10544037
> 
> 赞同：1
> 
> 时间：2012-05-11T00:52:07.147
> 
> 标签：javascript, date, time, repeat

我刚刚开始学习 javascirpt，并且正在尝试制作自己的时钟小部件。似乎当我使用“ourDate.toLocalString()”时，它只显示调用函数时的时间。所以我想我必须每秒连续重复该功能，以使其连续保持当前时间。但我遇到的问题是当我启动脚本时，它只重复一次该功能。我究竟做错了什么？下面是代码：

```
function updateclock(){
ourDate = new Date();
document.write(ourDate.toLocaleString());
}

function startclock() {
updateclock();
setInterval("updateclock()", 1000); 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T01:04:06.580

问题是`document.write`。如果您在文档加载后调用它，**它将覆盖整个文档**，包括您的`startclock`函数，无法再调用。

改为更新 HTML 元素的内容：

```
<div id="clock"></div>
<script type="text/javascript">
function updateclock(){
    ourDate = new Date();
    document.getElementById("clock").innerHTML = ourDate.toLocaleString();
}

function startclock() {
    updateclock();
    setInterval(updateclock, 1000); 
}
startclock();
</script> 
```

[http://jsfiddle.net/Ys87F/](http://jsfiddle.net/Ys87F/)

另外：不要将字符串传递给`setInterval`（或`setTimeout`），而是传递函数名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T00:55:42.723

你想这样做：

```
setInterval(updateclock, 1000); 
```

# java - 带有 jaxb/annox 和自定义注释的 ClassNotFoundException

> ID：10544042
> 
> 赞同：3
> 
> 时间：2012-05-11T00:53:18.753
> 
> 标签：java, bean-validation, jaxb2, jaxb2-basics, annox

我对注释使用场景有些困惑，我希望您能提供意见。

给定以下注释（在同一个项目中与**ExistingCustomerValidator**类一起定义）包 com.tktserver.constraints；

```
@Target({ ElementType.TYPE, ElementType.ANNOTATION_TYPE })
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = { ExistingCustomerValidator.class })
@Documented
public @interface ExistingCustomerMatch {
    String message() default "{customer.notfound}";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};

    /**
     * @return The field
     */
    String field();
} 
```

以及下面的 jxb 定制

```
<jaxb:bindings node="xsd:complexType[@name='customer']">
    <annox:annotate>
        <annox:annotate
            annox:class="com.tktserver.constraints.ExistingCustomerMatch"
            field="electronicUserId" />
    </annox:annotate>
</jaxb:bindings> 
```

当我通过 Maven 生成我的源时，我得到了这个（整个项目由它处理）

```
Caused by: org.jvnet.annox.annotation.AnnotationClassNotFoundException: Annotation class [com.tktserver.constraints.ExistingCustomerMatch] could not be found.
    ... 32 more
Caused by: java.lang.ClassNotFoundException: com.bgc.ticketserver.constraints.ExistingCustomerMatch
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:169)
    at org.jvnet.annox.parser.XAnnotationParser.parse(XAnnotationParser.java:76)
    ... 31 more 
```

其他 JSR-303 注释似乎工作正常。我想知道我是否在这里被循环依赖所困，即先运行 generate-sources，然后编译，因此在 generate-sources 运行时没有可用的 ExistingCustomerMatch 注释类，或者这是否是一个完全不同的野兽。

谢谢， 约安尼斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-24T17:58:24.710

我通过在 maven 中使用 antrun 插件和 org.jvnet XJC2Task 针对 maven.compile.classpath 使我的 annox JAXB 插件与 xjc 一起工作。（参见[http://confluence.highsource.org/display/J2B/JAXB2+Basics+XJC+Ant+Task](http://confluence.highsource.org/display/J2B/JAXB2+Basics+XJC+Ant+Task)）永远无法让它与直接的 maven 插件一起工作。

但这不是我来这里写作的原因。我猜你来到这里是因为你在谷歌搜索方面非常聪明，并且你坚定地决心通过这个令人讨厌的东西摆脱你所处的任何 JAXB 地狱。我怀着谦卑的心情写信给你，我一次又一次地和你在一起。我今天写信给你说： *停止挣扎，你做错了*

我的建议是针对那些在他们的个人“compile-xsd-to-jaxb-beans”冒险中想要通过 annox 或其他任何方式为生成的 JAXB bean 添加注释的人。如果您在那里，那么您可能会因为 XSD 的限制而感到束缚和束缚，或者您的 XSD 可能会失控。

我将我的 XML Schema 构建到 JAXB bean 的经验一开始就非常好，很高兴看到所有这些 pojo 出现，并且我的模式都很好地使用不同的命名空间进行了分解，并导入到一个主 XSD 中。我的构建非常清晰。我发现自己试图在各处添加 Javadoc 文档标签，而我的 XSD 变得越来越复杂。但是我生成的 bean 非常好看，而且我从交易中获得了免费的 Javadocs。我必须添加一些 JAXB 注释（主要是@XMLTransient），而我能让 annox 在 maven 中工作的唯一方法是使用 antrun 插件和 hacky Ant 任务，我对那个 kludge 不满意。我想，为什么这些东西不能正常工作？

然后越来越多的要求迫使我在架构设计上陷入越来越严格的困境，我花费越来越多的时间来破解 XSD - 直到突破点：我必须能够使用 EclipseLink MOXy 编组到 JSON，突然间我的架构可以不要被扭曲成椒盐卷饼，并获得漂亮的 JSON 和 XML。我被卡住了，而且很长时间。

我咨询了一位专家，他告诉我完全放弃我的 schema-to-JAXB-beans 工作。正确的方法是用 JAXB 和 MOXy 注释手写我的 JAXB bean，然后使用 schemagen 生成我的 .xsd。往另一个方向走！？有效。我的 schemagen 生成的 .xsd 并不漂亮，但谁在乎呢，它起作用了！对于我的 bean，架构是正确的，当我解析 XML 和使用 MOXy 时，一切正常，我可以将我的 bean 编组为 JSON。

为了转换我的代码，我什至使用了我从手写模式中获得的原始生成的 JAXB bean 作为起点，因此我什至不需要从头开始。事实上，我丢弃了一半以上生成的 JAXB bean；它们是多余的（xjc 生成大量丢弃类。）现在最好的部分是我熟悉 MOXy 注释。使用 MOXy 作为您的提供者，完全停止使用内置的 Oracle JAXB impl。MOXy 是 JAXB 的未来。

所以，我希望这能传达给那些试图让 XJC 工作的可怜人。我希望你不会因为你的椒盐卷饼扭曲而受苦。做出改变不会花很长时间，只要去做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T15:33:41.600

这是通过为验证器创建一个单独的 maven 模块并将其用作主项目中的依赖项来解决的。

# java - 使用等宽字体时 Substance UI 的 HighlightPainter 问题

> ID：10544046
> 
> 赞同：3
> 
> 时间：2012-05-11T00:54:46.220
> 
> 标签：java, swing, substance

我正在使用`Highlighter.HighlightPainter`界面突出显示文本区域的行。我使用了这个网站的源代码：[Line Painter](http://tips4java.wordpress.com/2008/10/29/line-painter/#comment-1445)。它工作得很好，但是当我用于`org.jvnet.substance.skin.SubstanceBusinessBlackSteelLookAndFeel`装饰 GUI 时，出现了一个问题。每当我将文本区域的字体更改为 时`Monospaced`，由于某种原因不会调用的`paint()`方法。`Highlighter.HighlightPainter`这是一个示例代码：

```
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Shape;
import javax.swing.BorderFactory;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.text.BadLocationException;
import javax.swing.text.Highlighter;
import javax.swing.text.JTextComponent;

public class TestFrame extends JFrame implements Highlighter.HighlightPainter
{
    private static final long serialVersionUID = 1L;

    static
    {
        try
        {
            JFrame.setDefaultLookAndFeelDecorated(true);
            JDialog.setDefaultLookAndFeelDecorated(true);
            UIManager.setLookAndFeel(new org.jvnet.substance.skin.SubstanceBusinessBlackSteelLookAndFeel()); 
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
    }

    public TestFrame() throws BadLocationException
    {
        super("The title");
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        JTextArea txt = new JTextArea(10, 30);
        txt.getHighlighter().addHighlight(0, 0, this);
        txt.setFont(new Font("Monospaced", Font.PLAIN, 12));
        JPanel container = (JPanel) getContentPane();
        container.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
        container.add(txt);
        pack();
        setLocationRelativeTo(null);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                try
                {
                    new TestFrame().setVisible(true);
                }
                catch(BadLocationException e)
                {
                    e.printStackTrace();
                }
            }
        });
    }

    @Override
    public void paint(Graphics g, int p0, int p1, Shape bounds, JTextComponent c)
    {
        System.out.println("paint() is invoked!");
    }
} 
```

如果我评论这一行：

```
txt.setFont(new Font("Monospaced", Font.PLAIN, 12)); 
```

`paint()`将被调用。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T02:49:14.997

好吧，有一个解决方案，在调用之前创建文本区域并为其设置字体`UIManager.setLookAndFeel()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T03:48:32.210

1）@Eng.Fouad 这是 n_times 提到的（@camickr，@StanislavL），用于样式化和高亮测试使用支持该功能的 JTextComponent

2）@Eng.Fouad 你是 JTextArea 的正确输出

![在此处输入图像描述](../Images/855a5cde37f3ae53cb810cb1519973a0.png) ![在此处输入图像描述](../Images/2a52e1c700dd0d341db546b1a414f350.png)

从代码

```
import java.awt.*;
import javax.swing.*;
import javax.swing.text.*;

public class TextPaneHighlighting {

    private static final long serialVersionUID = 1L;
    private Highlighter.HighlightPainter cyanPainter;
    private Highlighter.HighlightPainter redPainter;

    public TextPaneHighlighting() {
        JFrame frame = new JFrame();
        JTextPane textPane = new JTextPane();
        textPane.setText("one\ntwo\nthree\nfour\nfive\nsix\nseven\neight\n");
        //textPane.setFont(new Font("Monospaced", Font.PLAIN, 12)); // uncommnent
        JScrollPane scrollPane = new JScrollPane(textPane);
        frame.add(scrollPane, BorderLayout.CENTER);//  Highlight some text
        cyanPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.cyan);
        redPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.red);
        try {
            textPane.getHighlighter().addHighlight(0, 3, DefaultHighlighter.DefaultPainter);
            textPane.getHighlighter().addHighlight(8, 14, cyanPainter);
            textPane.getHighlighter().addHighlight(19, 24, redPainter);
        } catch (BadLocationException ble) {
        }
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setPreferredSize(new Dimension(300, 200));
        frame.setLocationRelativeTo(null);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame.setDefaultLookAndFeelDecorated(true);
                JDialog.setDefaultLookAndFeelDecorated(true);
                try {
                    UIManager.setLookAndFeel(new org.pushingpixels.substance.api.skin.SubstanceBusinessBlackSteelLookAndFeel());
                } catch (UnsupportedLookAndFeelException ex) {
                }
                TextPaneHighlighting tph = new TextPaneHighlighting();
            }
        });
    }
} 
```

3) 正如@trashgod 正确提到的，永远不要在没有invokeLater 的情况下在Substance 中设置任何内容，永远不要，无论外观敏感，也许在这一刻字体并不重要，也许不重要

4）简单的JTextArea在字体和外观方面有一些问题，可能有自己的Highlighter概念，如Renderer（对不起，我在wake_up之后懒惰阅读API）和Substance，对于Renderer概念你必须使用SubstanceRenderer而不是XxxRenderer，然后全部格式化工作，你除外

```
import java.awt.*;
import javax.swing.*;
import javax.swing.text.*;

public class Fonts implements Runnable {

    private String[] fnt;
    private JFrame frm;
    private JScrollPane jsp;
    private JTextPane jta;
    private int width = 450;
    private int height = 300;
    private GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
    private StyledDocument doc;
    private MutableAttributeSet mas;
    private int cp = 0;
    private Highlighter.HighlightPainter cyanPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.cyan);
    private Highlighter.HighlightPainter redPainter = new DefaultHighlighter.DefaultHighlightPainter(Color.red);
    private Highlighter.HighlightPainter whitePainter = new DefaultHighlighter.DefaultHighlightPainter(Color.white);
    private int _count = 0;
    private int _lenght = 0;

    public Fonts() {
        jta = new JTextPane();
        doc = jta.getStyledDocument();
        jsp = new JScrollPane(jta);
        jsp.setPreferredSize(new Dimension(height, width));
        frm = new JFrame("awesome");
        frm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frm.setLayout(new BorderLayout());
        frm.add(jsp, BorderLayout.CENTER);
        frm.setLocation(100, 100);
        frm.pack();
        frm.setVisible(true);
        jta.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
        fnt = ge.getAvailableFontFamilyNames();
        mas = jta.getInputAttributes();
        new Thread(this).start();
    }

    @Override
    public void run() {
        for (int i = 0; i < fnt.length; i++) {
            StyleConstants.setBold(mas, false);
            StyleConstants.setItalic(mas, false);
            StyleConstants.setFontFamily(mas, fnt[i]);
            StyleConstants.setFontSize(mas, 16);
            dis(fnt[i]);
            try {
                Thread.sleep(75);
            } catch (Exception e) {
                e.printStackTrace();
            }
            StyleConstants.setBold(mas, true);
            dis(fnt[i] + " Bold");
            try {
                Thread.sleep(75);
            } catch (Exception e) {
                e.printStackTrace();
            }
            StyleConstants.setItalic(mas, true);
            dis(fnt[i] + " Bold & Italic");
            try {
                Thread.sleep(75);
            } catch (Exception e) {
                e.printStackTrace();
            }
            StyleConstants.setBold(mas, false);
            dis(fnt[i] + " Italic");
            try {
                Thread.sleep(75);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        jta.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
    }

    public void dis(String s) {
        _count++;
        _lenght = jta.getText().length();
        try {
            doc.insertString(cp, s, mas);
            doc.insertString(cp, "\n", mas);
        } catch (Exception bla_bla_bla_bla) {
            bla_bla_bla_bla.printStackTrace();
        }
        if (_count % 2 == 0) {
            try {
                jta.getHighlighter().addHighlight(1, _lenght - 1, cyanPainter);
            } catch (BadLocationException bla_bla_bla_bla) {
            }
        } else if (_count % 3 == 0) {
            try {
                jta.getHighlighter().addHighlight(1, _lenght - 1, redPainter);
            } catch (BadLocationException bla_bla_bla_bla) {
            }
        } else {
            try {
                jta.getHighlighter().addHighlight(1, _lenght - 1, whitePainter);
            } catch (BadLocationException bla_bla_bla_bla) {
            }
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame.setDefaultLookAndFeelDecorated(true);
                JDialog.setDefaultLookAndFeelDecorated(true);
                try {
                    UIManager.setLookAndFeel(new org.pushingpixels.substance.api.skin.SubstanceBusinessBlackSteelLookAndFeel());
                } catch (UnsupportedLookAndFeelException ex) {
                }
                Fonts fs = new Fonts();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T04:14:03.947

仅供参考，这里有一个快速测试[`LinePainter`](http://tips4java.wordpress.com/2008/10/29/line-painter/)：

![线条画家](../Images/c6d4091a928f38dd384dc467a19b90e7.png)

```
import java.awt.Color;
import java.awt.EventQueue;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Rectangle;
import java.awt.Shape;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextPane;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.event.CaretEvent;
import javax.swing.event.CaretListener;
import javax.swing.text.BadLocationException;
import javax.swing.text.Highlighter;
import javax.swing.text.JTextComponent;

/**
 * @see http://stackoverflow.com/q/10544046/230513
 * @see http://tips4java.wordpress.com/2008/10/29/line-painter/
 */
public class LinePainterTest extends JPanel {

    public LinePainterTest() {
        JTextPane textPane = new JTextPane();
        textPane.setFont(new Font(Font.MONOSPACED, Font.PLAIN, 24));
        try {
            textPane.getDocument().insertString(0, "One\nTwo\nThree", null);
        } catch (BadLocationException ex) {
            ex.printStackTrace(System.err);
        }
        LinePainter painter = new LinePainter(textPane);
        this.add(textPane);
    }

    private void display() {
        JFrame f = new JFrame("LinePainterTest");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(this);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) throws Exception {
        UIManager.setLookAndFeel(
            "com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel");
        JFrame.setDefaultLookAndFeelDecorated(true);
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new LinePainterTest().display();
            }
        });
    }
} 
```

# php - 自定义类型自动增量 id codeigniter

> ID：10544052
> 
> 赞同：1
> 
> 时间：2012-05-11T00:55:13.340
> 
> 标签：php, mysql, codeigniter

`user`我的mysql 数据库中有一个表。我有一个自动增量`id`字段和一个`member_id`字段。和另一个用于选择包的单选按钮。`S for standard and P for premium`. 我想根据选择的包将我的成员 ID 设置为第一个 ID `P000001`。`S000001`

```
For example if the first member choose P his member_id will be P000001
            if the second member choose S his member_id will be S000002
            if the third member choose S his member_id will be S000003
            ...
            ... 
```

将`member_id`是精确的 7 长度，带有 P 或 S。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T07:05:10.753

您可以简单地使用此查询

```
select lpad(member_id,8,'0')
from table
where id = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T00:59:49.310

为什么不简单地有两张桌子？S会员一份，P会员一份。您可以使用零填充的 id。如果数字绝对需要唯一，即您不希望 S000001 和 P000001 同时存在，请使用另一个表来存储唯一 ID 并在您的 S 和 P 表中引用它们。

就像是：

```
-- Table `ids`
CREATE  TABLE IF NOT EXISTS `ids` (
  `master_id` INT ZEROFILL NOT NULL AUTO_INCREMENT ,
  `member_type` ENUM('S','P') NULL ,
  PRIMARY KEY (`master_id`) )
ENGINE = InnoDB;

-- Table `s_type`
CREATE  TABLE IF NOT EXISTS `s_type` (
  `s_type_id` INT NOT NULL ,
  `master_id` INT NULL ,
  PRIMARY KEY (`s_type_id`) ,
  INDEX `fk_s_type_1` (`s_type_id` ASC) ,
  CONSTRAINT `fk_s_type_1`
    FOREIGN KEY (`s_type_id` )
    REFERENCES `ids` (`master_id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

-- Table `s_type_copy1`
CREATE  TABLE IF NOT EXISTS `s_type_copy1` (
  `p_type_id` INT NOT NULL ,
  `master_id` INT NULL ,
  PRIMARY KEY (`p_type_id`) ,
  INDEX `fk_s_type_copy1_1` (`p_type_id` ASC) ,
  CONSTRAINT `fk_s_type_copy1_1`
    FOREIGN KEY (`p_type_id` )
    REFERENCES `ids` (`master_id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB; 
```

如果您想真正简单，只需将自动递增的 id 与 'S' 或 'P' 的枚举 CHAR(1) 结合使用。您只需要在需要显示时将它们放在一起即可。CHAR(1) 列可用于确定成员资格类型。

如果您不打算添加更多成员类型，您甚至可以使用 TINYINT 作为布尔值（0 = 'S'，1 = 'P'）。

```
-- Table `ids`
CREATE  TABLE IF NOT EXISTS `ids` (
  `member_id` INT ZEROFILL NOT NULL AUTO_INCREMENT ,
  `member_type` ENUM('S','P') NULL ,
  PRIMARY KEY (`member_id`) )
ENGINE = InnoDB; 
```

...或者...

```
-- Table `ids`
CREATE  TABLE IF NOT EXISTS `ids` (
  `member_id` INT ZEROFILL NOT NULL AUTO_INCREMENT ,
  `member_type` TINYINT ,
  PRIMARY KEY (`member_id`) )
ENGINE = InnoDB; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T03:53:32.633

这个怎么样。

假设您有 10 人使用 Premium，8 人使用 Standard。

新人加入标准账户。

```
function add_user($account_type)
{
   $count = query->result(SELECT COUNT(*) WHERE `member_id` LIKE '$account_type_%');

   $count = $count+1;

   convert count into 7 characters;
   $count = $account_type.$count;
   insert into database;
} 
```

LIKE 是用于匹配部分结果的 SQL 查询，而 % 充当通配符。

来源 = [http://www.techonthenet.com/sql/like.php](http://www.techonthenet.com/sql/like.php)

# c - 将指针字符打印为十六进制

> ID：10544053
> 
> 赞同：0
> 
> 时间：2012-05-11T00:55:16.257
> 
> 标签：c, string, pointers, character

```
#include <stdio.h>

int main(){
    char *c="";
    printf("Input: ");
    scanf_s("%c", c);
    printf("%x", *c);
} 
```

我想输入几个字符，然后将整个字符串输出为十六进制值。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:02:00.697

您需要一个*缓冲区*，而不是字符串常量来读取。另外，永远不要使用任何`*scanf`功能，也永远不要使用任何`*_s`功能。

编写程序的正确方法是这样的：

```
int
main(void)
{
  char line[80];
  char *p;

  fputs("Input: ", stdout);
  fgets(line, sizeof line, stdin);

  for (p = line; *p; p++)
    printf("%02x", *p);

  putchar('\n');
  return 0;
} 
```

...但我不确定“将整个字符串输出为十六进制值”的确切含义，因此这可能不是*您*想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T00:59:57.997

您的整个代码都是错误的。它应该看起来像这样：

```
printf("Input: ");

char c = fgetc(stdin);
printf("%X", c); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T00:59:57.107

您需要一个循环来读取多个字符并输出每个字符。您可能希望更改格式以`%02x`确保每个字符输出 2 位数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T01:26:22.297

```
#include <stdio.h>

int main(void)
{
    unsigned int i = 0;              /* Use unsigned to avoid sign extension */
    while ((i = getchar()) != EOF)   /* Process everything until EOF         */
    {
        printf("%02X ", i);
    }

    printf("\n");

    return 0;
} 
```

# python - 为什么 `virtualenv` 找不到 `pkg_resources`？

> ID：10544067
> 
> 赞同：9
> 
> 时间：2012-05-11T00:57:46.037
> 
> 标签：python, virtualenv, pkg-resources, python-wheel

我正在尝试在 Ubuntu 中使用 virtualenv 来安装本地虚拟 Python 环境。当我运行 shell 命令时：

```
$ virtualenv ./virt_python 
```

它抛出一个它不能 import 的异常`pkg_resources`。但是当我打开一个 Python shell 并且`from pkg_resources import load_entry_point`它运行良好时。作为参考，完整的堆栈跟踪如下。

```
$ virtualenv ./virt_python
New python executable in ./virt_python/bin/python
Installing setuptools............done.
Installing pip.......
  Complete output from command /home/rpsharp/local/...hon/bin/easy_install /usr/local/lib/pytho...pport/pip-1.1.tar.gz:
  Traceback (most recent call last):
  File "/home/rpsharp/local/workspace/invest-natcap.invest-3/virt_python/bin/easy_install", line 5, in <module>
    from pkg_resources import load_entry_point
ImportError: No module named pkg_resources
----------------------------------------
...Installing pip...done.
Traceback (most recent call last):
  File "/usr/local/bin/virtualenv", line 9, in <module>
    load_entry_point('virtualenv==1.7.1.2', 'console_scripts', 'virtualenv')()
  File "/usr/local/lib/python2.6/dist-packages/virtualenv.py", line 928, in main
    never_download=options.never_download)
  File "/usr/local/lib/python2.6/dist-packages/virtualenv.py", line 1042, in create_environment
    install_pip(py_executable, search_dirs=search_dirs, never_download=never_download)
  File "/usr/local/lib/python2.6/dist-packages/virtualenv.py", line 640, in install_pip
    filter_stdout=_filter_setup)
  File "/usr/local/lib/python2.6/dist-packages/virtualenv.py", line 1006, in call_subprocess
    % (cmd_desc, proc.returncode))
OSError: Command /home/rpsharp/local/...hon/bin/easy_install /usr/local/lib/pytho...pport/pip-1.1.tar.gz failed with error code 1 
```

我尝试了这里提出的解决方案[https://stackoverflow.com/a/10538412/42897](https://stackoverflow.com/a/10538412/42897)但没有任何效果。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-08-12T18:17:09.063

我在尝试运行 virtualenv 时遇到了同样的问题，发现 virtualenv 安装在 /home/{user}/install/lib/python2.7/site-packages 而 python 指向 /home/{user}/install /bin/virtualenv - 你应该通过运行知道这一点

```
which virtualenv 
```

所以我不得不卸载并重新安装 virtualenv

```
pip uninstall virtualenv 
pip install virtualenv 
```

这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-21T18:57:08.433

问题是最近的版本从不下载 setuptools (distribute) 或 pip 并期望在本地找到它们的轮子。通常 virtualenv 会说类似

```
Cannot find a wheel for setuptools
Cannot find a wheel for pip 
```

之后出现 ImportError 失败。这是[记录在案](https://virtualenv.pypa.io/en/latest/userguide.html#the-extra-search-dir-option)的：

> 如果没有找到令人满意的本地发行版，virtualenv 将失败。Virtualenv 永远不会下载包。

您可能想检查您是否**`VIRTUALENV_EXTRA_SEARCH_DIR`**在您的环境中设置或在 virtualenv 的[配置文件](https://virtualenv.pypa.io/en/latest/reference.html#configuration-file)中设置了相应的选项并禁用它。

要找出 virtualenv 实际搜索包的位置，您可以临时添加 print 语句`/usr/local/lib/python2.6/dist-packages/virtualenv.py`或类似`import pdb; pdb.set_trace()`. 有问题的功能是`find_wheels`，你让它看起来像这样：

```
def find_wheels(projects, search_dirs):
    # … skipping docstring and comments
    for project in projects:
        for dirname in search_dirs:
            print '*** search_dir:', dirname
            files = glob.glob(os.path.join(dirname, project + '-*.whl'))
            if files:
                wheels.append(os.path.abspath(files[0]))
                break
        else:
            logger.fatal('Cannot find a wheel for %s' % (project,))

    return wheels 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-07T13:09:23.833

1.  检查 virtualenv 的当前版本。正如[user2676043](https://stackoverflow.com/users/2676043/user2676043)在同一线程中回答的那样，virtualenv 安装在 /usr/local/lib/python2.7/dist-packages 中。所以运行以下命令：

    `$ python /usr/local/lib/python2.7/dist-packages/virtualenv.py --version`

它将返回系统上安装的 virtualenv 版本。

2.  现在，更改可执行文件。

    `$ vim /usr/local/bin/virtualenv`

将版本更改为上面收到的版本。保存文件，它工作顺利。

# javascript - 无法从 .NET 页面获取 javascript 中的表单？

> ID：10544073
> 
> 赞同：0
> 
> 时间：2012-05-11T00:58:57.097
> 
> 标签：javascript, asp.net, .net, dom, forms

我有一个带有母版页的典型 .NET 页面。该网页有一个`asp:Button`调用 javascript 函数`Form_Validator()`。`Form_Validator()`无论我尝试什么，我都无法在函数中获取表单。它始终为空。

我也尝试过像这样传递表单的传统方法：`OnClientClick="Form_Validator(this.form);`，但没有任何效果。我只是觉得它与母版页有关？

```
<asp:Button ID="cmdSubmit" runat="server" Text="Submit" OnClientClick="Form_Validator();" OnClick="cmdSubmit_Click" />

<script type="text/javascript">
function Form_Validator() {
var theForm = document.getElementById(this.Form1);
alert(theForm);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:44:40.597

ASP.net 具有 ClientID，它是呈现给页面的 ID。你可以使用

```
<script type="text/javascript">
   function Form_Validator() {
   var theForm = document.getElementById("<%=this.Form1.ClientID%>");
   alert(theForm);
</script> 
```

这会将呈现给页面的 FormID 插入到您的 javascript 中。如果您不使用“静态”客户端 ID 模式，这也是您访问其他表单元素的方式。

例如：

```
<form id="Form1" runat="server">
     <asp:TextBox ID="txtABox" runat="server" />
</form>
<script type="text/javascript">
   function Form_Validator() {
   var theForm = document.getElementById("<%=this.Form1.ClientID%>");
   alert(theForm);
   var aBox = document.getElementByID("<%=txtABox.CLientID%>")
</script> 
```

在旁注中，我会查看[内置的 asp.net 表单验证器](http://msdn.microsoft.com/en-us/library/debza5t0.aspx)。还有一个很好的[深入了解 asp.net 验证器](http://msdn.microsoft.com/en-us/library/aa479045.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T01:05:17.390

它可能确实与母版页有关，因为 ASP.NET 将使用像“[Content Placeholder ID]_[Control]”这样的命名约定。这应该可以工作：

```
var theForm = document.forms[0]; 
```

或者，您可以尝试将“ClientIDMode”（在页面指令中）设置为“静态”，这将告诉 ASP.NET 按照您告诉它的方式分配 ID，而不是使用所有疯狂的嵌套命名约定。

# hibernate - 在 JPA 中，如何将表映射到复合实体？

> ID：10544078
> 
> 赞同：1
> 
> 时间：2012-05-11T00:59:56.840
> 
> 标签：hibernate, jpa

有时您有一个包含许多字段的巨大实体，最好将实体拆分为单独的类以处理复杂性。

假设我有一个带有列的表 Foo

```
someStuff, aThingBlah, aThingEtc, bThingWhatever, bThingBacon 
```

和这个类（注释省略）

```
class Foo {
  String someStuff;
  String aThingBlah;
  String aThingEtc;
  String bThingWhatever;
  String bThingBacon;
} 
```

我想重构这个（不改变数据库表）

```
class Foo {
  String someStuff;
  AThing aThing;
  BThing bThing;
}
class AThing {
  String blah;
  String etc;
}
class BThing {
  String whatever;
  String bacon;
} 
```

是否有可能做到这一点以及如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:29:15.063

这里是基础...

```
class Foo {

  String someStuff;

  @Embedded
  @AttributeOverrides({
     @AttributeOverride( name = "blah", column = @Column(name="aThingBlah") ),
     ...
  })
  AThing aThing;

};

@Embeddable
class AThing {

  @Column(...)
  String blah;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T01:10:22.160

我不认为这是可能的。哪个持有身份证？听起来他们都将共享相同的 id，因此休眠将不知道如何加载或保存其中的任何一个。（没有某种鉴别器）

另外，如果我要保存*BThing*，那么*Foo*中定义的字段会发生什么，*Athing*？他们将完全超出休眠范围。

# audio - 给定音频源和准确转录的任何语言的时间戳音频

> ID：10544082
> 
> 赞同：3
> 
> 时间：2012-05-11T01:00:30.370
> 
> 标签：audio, transcription

我希望为音频文件中的每个单词获得大致准确的时间戳。我也有原始文本与音频文件一起使用，可以用作各种交叉引用源。这类似于“音频挖掘”，我相信你只有输入音频，而这里我有音频和文本。

理想情况下，我希望使用开源软件来执行此操作，并希望接受大多数语言作为输入（例如，英语、法语、德语、西班牙语，最好是俄语和普通话）。

我什至会接受只能匹配各种单词的时间戳的解决方案（例如，如果转录不完全准确）。然后将输出文本与原始文本交叉引用以帮助重新调整内容会更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:10:50.390

在我的语言学研究中，我确实是这样工作的。我使用了一个名为 ELAN 的程序，我刚刚注意到它们的版本 (4.5) 比我目前在我的 Mac 上安装的版本更新。该软件旨在帮助处理聋人语言，因此它支持视频和音频帧，并允许您准确对齐您的转录。我使用的版本是 3.9，该版本用于对单词进行某种自动分割，这正是我认为你想要做的。不过，我在最新版本中没有看到该功能，也许经过一些挖掘，它仍然存在。

![分割音频和视频](../Images/d3d61af57e52faa3e8a398a0545eae5a.png)从[这个页面](http://www.mpi.nl/corpus/html/elan_ug/ch02s05.html)。

当然如果你需要更早的版本，你总是可以使用 ELAN 3.9。ELAN 可以在 Mac、Linux 和 Windows 上运行，因为它是基于 Java 的（我记得）。这是[ELAN](http://tla.mpi.nl/tools/tla-tools/elan/)的链接。还有其他语言注释软件。另一个非常好，但很难学习。它被称为[PRAAT](http://www.fon.hum.uva.nl/praat/)。

我希望这可以帮助你。如果我不能正确理解您的需求，请告诉我，我会看看是否可以为您完善我的答案。干杯！

# dependency-properties - 带有 IEnumerable 的 WinRT DependencyProperty 根本不会触发

> ID：10544084
> 
> 赞同：5
> 
> 时间：2012-05-11T01:00:59.667
> 
> 标签：dependency-properties, windows-runtime

因为我知道已经发布了很多关于依赖属性的帖子，所以我一直在搜索和搜索，但我只是还没有看到任何有有效解决方案的东西。我正在尝试将我的 ViewModel 中的 ObservableCollection 绑定到我的 AutoCompleteBox。我的 ViewModel 正在返回数据，Getter 被击中。但是，在那之后，控件的 SetValue 或 OnItemsSourcePropertyChanged 不会触发。有什么想法可能是错的吗？

我有这样的控制：

```
[ContentProperty(Name = "ItemsSource")]
public partial class AutoCompleteBox : Control
{
    //local stuff
    private ListBox lb;
    private List<Person> _items;
    private ObservableCollection<Person> _view;

    public AutoCompleteBox() : base()
    {
        DefaultStyleKey = typeof(AutoCompleteBox);
        Loaded += (sender, e) => ApplyTemplate();
    }
    protected override void OnApplyTemplate()
    {
        this.lb = this.GetTemplateChild("Selector") as ListBox;
        base.OnApplyTemplate();

    }
    #region ItemsSource

    public IEnumerable ItemsSource
    {
        get { return GetValue(ItemsSourceProperty) as ObservableCollection<Person>; }
        set { SetValue(ItemsSourceProperty, value); } //Never gets called
    }

    public static readonly DependencyProperty ItemsSourceProperty =
        DependencyProperty.Register(
            "ItemsSource",
            typeof(IEnumerable),
            typeof(AutoCompleteBox),
            new PropertyMetadata(null, OnItemsSourcePropertyChanged));

    private static void OnItemsSourcePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
       //Never gets called :(
    }
    #endregion

    public String SearchText
    {
        get { return GetValue(SearchTextProperty) as String; }
        set
        {
            SetValue(SearchTextProperty, value);
        }
    }

    public static readonly DependencyProperty SearchTextProperty =
        DependencyProperty.Register(
            "SearchText",
            typeof(String),
            typeof(AutoCompleteBox),
            new PropertyMetadata(null, OnSearchTextPropertyChanged));

    private static void OnSearchTextPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
         //gets fired when loaded, with data being bound
    }

} 
```

以下是它是如何使用控件的：

```
<toolkit:AutoCompleteBox Grid.Row="5" Grid.Column="2" ItemsSource="{Binding Persons,Mode=TwoWay}" SearchText="WhatTheHell"/> 
```

作为测试和简单起见，我为 SearchText 创建了一个 String DependencyProperty。如果我绑定 SearchText，它工作正常，调用 OnSearchTextPropertyChanged：

```
<toolkit:AutoCompleteBox Grid.Row="5" Grid.Column="2" ItemsSource="{Binding Persons,Mode=TwoWay}" SearchText="{Binding SearchText}"/> 
```

还有其他人在使用 WinRT 时遇到过这些问题吗？或者看到我在做什么有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-24T18:02:52.903

# 有2个快速解决方案

（这里的**BaseClass**是例如一个抽象类或您从中派生的接口以及您尝试绑定到依赖属性的实例）

## 解决方案1：

注册依赖属性时需要更改`typeof(BaseClass)`为。`typeof(object)`Getter 和 setter 可以继续使用您的**BaseClass**，但如果您为此依赖属性设置了不同的类型实例，请注意 InvalidCastException。

```
 public BaseClass Item
        {
            get { return (BaseClass)GetValue(ItemProperty); }
            set { SetValue(ItemProperty, value); }
        }
        public static readonly DependencyProperty ItemProperty =
            DependencyProperty.Register("Item", typeof(object), typeof(MyUserControl), new PropertyMetadata(null)); 
```

## 解决方案2：

在代码的某处创建一个虚拟依赖属性（例如，在您尝试创建的依赖属性之后），该属性将具有所有派生类型的类型。像这样：

```
#region DummyProperty

public DerivedClass1 Dummy
{
    get { return (DerivedClass1)GetValue(DummyProperty); }
    set { SetValue(DummyProperty, value); }
}

public static readonly DependencyProperty DummyProperty =
    DependencyProperty.Register("Dummy", typeof(DerivedClass1), typeof(MyUserControl), new PropertyMetadata(default(DerivedClass1)));

#endregion 
```

这里**DerivedClass1**派生自**BaseClass**。

# 为什么？

我想原因是 XAML 对您的派生类型一无所知，只知道**BaseClass**。因此，为每种类型创建一个虚拟依赖属性应该可以解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T06:30:32.527

我会尝试检查绑定是否曾经使用 DebugConverter 触发 - 检查[WinRT XAML 工具包](http://bit.ly/WinRTXamlToolkit)中的[BindingDebugConverter](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/13396#270576) - 将其设置为绑定的转换器并查看它是否以及何时中断（它是在 Convert 还是 ConvertBack 中，正在设置什么值ETC。）。

如果这没有帮助 - 检查您的 DataContext 是否设置正确。

*编辑 1

如果您正在查看的是绑定集合的项目的更改 - 您可以检查 ItemsSource 是否为[INotifyCollectionChanged](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.interop.inotifycollectionchanged.aspx)并且如果为 true - 订阅[CollectionChanged](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.interop.inotifycollectionchanged.collectionchanged.aspx)事件以查看更改。否则 - 您可以修改您的控件以从[ItemsControl](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.itemscontrol.aspx)继承并覆盖[GetContainerForItemOverride](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.itemscontrol.getcontainerforitemoverride.aspx)和[IsItemItsOwnContainerOverride](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.itemscontrol.isitemitsowncontaineroverride.aspx)等方法。

*编辑 2

Windows 8 Consumer Preview 中的框架中似乎存在与使用 IEnumerable 作为依赖属性类型相关[的错误。](http://social.msdn.microsoft.com/Forums/en/winappswithcsharp/thread/6a579bce-bdb4-4a41-a1b2-6d94153e4c00)使用 object 作为类型解决了这个问题。如果启用本机代码调试，您将看到此绑定异常：

> 错误：转换器无法转换类型 'System.Collections.ObjectModel.ObservableCollection`1[[ACBDP.Person, ACBDP, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System, Version=4.0.0.0 的值, Culture=neutral, PublicKeyToken=b77a5c561934e089' 输入'IEnumerable'; BindingExpression：路径='Persons' DataItem='ACBDP.BlankPageViewModel，ACBDP，版本=1.0.0.0，Culture=neutral，PublicKeyToken=null'；目标元素是'ACBDP.AutoCompleteBox'（名称='null'）；目标属性是“ItemsSource”（类型“IEnumerable”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T12:46:54.783

将 typeof(IEnumerable) 更改为 typeof(object)

# php - mysqli删除不起作用

> ID：10544085
> 
> 赞同：0
> 
> 时间：2012-05-11T01:01:00.183
> 
> 标签：php, mysqli, sql-delete, rowid

我正在尝试`DELETE`在每个`$row`. 此外，在另一个页面上，有一个“下载”链接——它们应该以相同的方式工作。问题是这样的：我让 DELETE 和 DOWNLOAD 在每条记录旁边打印出来，但是使用我拥有的代码，没有任何反应，或者我的脚本因错误而退出。出于某种原因，我已经启动并运行了我的网站中最复杂的功能，但这仍然让我难以理解。这是一些代码：

```
 while ($row = mysqli_fetch_array($r,MYSQLI_ASSOC))
    {
  echo '<tr><td align="left">' .
    $row['title'] . '</td><td align="left">'
    . $row['genre'] . '</td><td align="left">'
    . $row['length'] . '</td><td align="left">'
    . $row['created'] . '</td><td align="left">'
    . $row['views'] . '</td><td align="left">'
    . "<a href='wprofile.php?id={$row['upload_id']}'>Delete</a></td> . '</td></tr>';
    } 
```

在同一个php页面上，我有这个让我失望的逻辑。该示例用于删除，但对于我的 DOWNLOAD 链接问题，同样失败。

```
 if(isset($_GET['upload_id']))
    {
    $id = intval($_GET['upload_id']);

    require_once (dbconnectionpath);

    $delquery = "DELETE FROM 'upload' WHERE 'upload_id' = {$id}";
    $done = @mysqli_query ($dbc, $delquery); //run the query

    if($done) {
    if (mysqli_num_rows($done)==1) {
    echo 'Record deleted';
    }
    else{
    echo 'Delete failed';
    }

    @mysqli_free_result($result);
    }
    else{
    echo "Error! Query failed: <pre>{$dbc->error}</pre>";
    }
    mysqli_close(dbconnection); 
```

我得到的错误是“错误，查询失败”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:07:41.877

在您的链接中，您似乎正在设置`id`：

```
<a href='wprofile.php?id={$row['upload_id']} ... 
```

但你的代码引用`$_GET['upload_id']`。换句话说，您在代码中引用了错误的名称。`id`在代码或`upload_id`链接中使用。

另一件事可能只是因为我看不到所有的 HTML - 您`</td>`的代码中似乎有很多元素。但是，请检查链接行末尾的那个，如上所述，这可能会关闭`<td>`未显示的较早内容。

* * *

如果正如您在评论中提到的那样，您的“查看源代码”将链接显示为：

```
<a href='newwriter_profile.php?id='>Delete</a></td> 
```

那么您创建该 HTML 链接有问题。

那里有很多可能出错的地方，首先想到的是您的原始查询中没有`update_id`，或者您正在查看的行的 ID 确实是空白的。

在生成 HTML 链接行之前检查 的值`$row['update_id']`，那至少应该确认或否定该假设。除此之外，您还必须弄清楚*为什么*您的链接不正确。

* * *

*我*刚刚注意到的一件事，您可能想研究一下，是您对引号的使用：

```
$delquery = "DELETE FROM 'upload' WHERE 'upload_id' = {$id}"; 
```

现在我知道 MySQL 有时使用反引号来保护表名和列名免受不正确的解析（例如 with `select `column with spaces` from tbl1 ...`），但是您的代码似乎有单引号而不是反引号。

这只是要检查的另一件事。可能是`where`您查询中的子句将*文字*字符串“upload_id”与您的变量进行比较，而不是比较`upload_id` *列。*

这可以解释为什么您`delete`没有点击任何行，因为您的 ID（可能）是一个自动递增的整数字段，这意味着它永远不会等于非数字字符串文字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T01:08:37.373

`if(isset($_GET['upload_id']))`改成`if(isset($_GET['id']))`

和 `$id = intval($_GET['id']);`

HTML 参数是 id，而不是 upload_id

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T04:42:25.157

尝试删除大括号，因为当您打印出创建的查询时，它会使用大括号显示 id 的值，这可能导致不删除 id。

这应该有效：“从上传中删除上传位置upload_id = $id”；

要防止页面指向另一个页面，请使用 preventdefault js 函数。

# android - Android - 使用 db.enableWriteAheadLogging 方法获取 java.lang.NoSuchMethodError

> ID：10544086
> 
> 赞同：2
> 
> 时间：2012-05-11T01:01:09.340
> 
> 标签：android, sqlite

我正在尝试在我的数据库上使用 enableWriteAheadLogging，我在 DatabaseHelper onCreate 方法中实现，尽管我尝试在其他地方调用。我总是收到错误 java.lang.NoSuchMethodError 并且应用程序崩溃。

```
@Override
public void onCreate(SQLiteDatabase db) {
    //The create statements work fine, but
    //I have tried putting the enable call first
    for(int i=0; i<CREATE_TABLES.length; i++){
        db.execSQL(CREATE_TABLES[i]);
    }
    for(int i=0; i<INSERT_DATA.length; i++){
        db.execSQL(INSERT_DATA[i]);
    }

    //Always crashes, but db works fine if I comment out
    db.enableWriteAheadLogging();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:11:24.627

该方法是使用 API 11 添加的。我的猜测是您的项目是使用旧版本的 SDK 构建的。因此，该方法在您的应用程序的上下文中不存在。

# java - 对大量 Java 字符串进行排序和散列处理

> ID：10544087
> 
> 赞同：1
> 
> 时间：2012-05-11T01:01:11.603
> 
> 标签：java, sorting, hash

我有一个应用程序，它将某种对象（例如 type `MyClass`）的值存储到许多不同的`Map<String, MyClass>`映射中。

该应用程序需要

*   将不同映射中的对象引用获取到单个集合（联合）
*   对单个集合进行排序（以应用顺序）
*   计算连续集合之间的差异（用于检测变化）
*   从每个集合的所有对象中产生一个哈希值

（统一）集合中对象的顺序很重要。

为了实现排序，对象（映射值）使用`addAll()`, in放置`ArrayList`并通过 排序`Collections.sort()`。顺序定义在 中，它通过比较它封装的一些字符串字段（比如， ）`MyClass`来实现接口。`Comparator``myField`

排序完成后，会生成来自所有对象的唯一签名。对于具有相同 值的对象，此签名需要相同，`myField`目前通过字符串连接（使用`toLowerCase()`和 a `StringBuilder`）然后对结果字符串进行散列处理，该字符串可能有几千个字符长。

有没有更有效的方法来做（任何或全部）上述（复制、排序、比较和散列）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:06:03.047

是的，有更好的方法。简单地散列哈希：

```
List<String> strings;

int hash = 0;
for (String string : strings)
    hash += hash * 31 + string.hashCode(); 
```

这将几乎不使用任何内存，速度非常快，并且会产生与您的 StringBuilder 方法相同强度的哈希码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T01:14:19.140

如果您需要一个唯一的签名，那么您（至少在概念上）需要：

*   将相关数据连接成字符串或缓冲区；
*   使用强哈希函数对该数据进行哈希处理。

我说“概念上”，因为您可以在不将所有数据实际复制到缓冲区的情况下即时计算哈希：这取决于您的特定应用程序这样做的方便程度。

Java 中标准使用的 32 位哈希码通常太弱，无法为您提供唯一代码。

我建议您至少使用 64 位散列函数（我的一篇文章中有[一个 64 位散列函数的示例实现](http://www.javamex.com/tutorials/collections/strong_hash_code_implementation.shtml)，可能会有所帮助）。为了更好地保证唯一性，像 MD5 这样更强大的散列函数会更理想，但会带来一点不便，即生成的散列码太宽而无法存储在原语中。（这是您需要做出的权衡：64 位强哈希通常有助于保证几百万个对象中所有意图和目的的唯一性；MD5 以更广泛的哈希码为代价为您提供了更强大的保证。）

PS我前几天对一个类似的问题给出了[这个答案](http://www.forum.javamex.com/index.php?p=/discussion/5/how-to-start-with-hash-function)，这也可能有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T01:42:55.150

假设您真正想要的只是一个以独特方式描述集合的组合哈希（因此内部排序并不重要）并且仅取决于 myField，我建议：

```
long hash = 0
for map in maps:
    for key in keys:
        if key in map:
            hash = hash + 64bithash(map[key].myfield) 
```

其中添加的都是有效的模块 2^64。这将为您提供整个集合的散列，该散列可能大到足以唯一（64 位），不依赖于排序（2+3 = 3+2），并且不需要排序或存储在其他结构中（所以会很快）。

**警告**这假设顺序不重要。可能是您的排序使用了比 myfield 其他的东西，因此有效的哈希取决于 myfield*和*排序中使用的信息。在这种情况下，上述功能将无法发挥同等作用（但可以通过在 has 中包含用于订购的信息来实现）。

# ms-access - MS Access：将单独的年、日计数和时间字段转换为日期/时间

> ID：10544090
> 
> 赞同：2
> 
> 时间：2012-05-11T01:01:20.397
> 
> 标签：ms-access, datetime

我有一个由另一个程序创建的文本文件，该文件已导入 MS Access 2003。日期和时间字段分为 3 个单独的字段，我想创建 1 个日期/时间字段。以下是数据示例：

```
YEAR,DAY_NUMBER,TIME
2002,231,223405
2004,117,000000 
```

YEAR：YYYY 格式的年份

DAY：一年中的某一天。例如，001 代表 1 月 1 日；034 是 2 月 3 日

TIME：HHMMSS 中的时间

如何创建具有相应日期/时间值的附加字段？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:33:14.807

此示例假定您的表名为`MyTable`，其`YEAR`和`DAY_NUMBER`字段均为数字数据类型，`TIME`字段为文本，并且您添加了名为 的日期/时间字段`date_time`。

`DateSerial()`尝试使用和`TimeSerial()`函数进行更新查询。

```
UPDATE MyTable
SET date_time = DateSerial([YEAR],1,DAY_NUMBER)
    + TimeSerial(Left([TIME],2), Mid([TIME],3,2), Right([TIME],2)); 
```

**编辑**：如果我误解了您的意图，并且您实际上不需要或不想存储日期/时间值，您可以在需要时通过`SELECT`查询导出它。

```
SELECT
    DateSerial([YEAR],1,DAY_NUMBER)
        + TimeSerial(Left([TIME],2), Mid([TIME],3,2), Right([TIME],2))
        AS date_time
FROM MyTable; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:11:15.510

```
' *********************************************************************
' FUNCTION: CJulian2Date()
'
' PURPOSE: Convert a Julian day to a date. The function works with
'          dates based on the Gregorian (modern) calendar.
'
' ARGUMENTS:
'    JulDay: The ordinal day of a year. Between 1 and 365 for all
'            years, or between 1 and 366 for leap years.
'
'    YYYY: A three or four digit integer for a year that is within the
'          range of valid Microsoft Access dates. If YYYY is omitted,
'          then YYYY is assumed to be the year of the current system
'          date.
'
' RETURNS: A date for a valid Microsoft Access year and Julian day,
'          or a Null value for an invalid Julian Day.
' *********************************************************************

Function CJulian2Date (JulDay As Integer, Optional YYYY)
    If IsMissing(YYYY) Then YYYY = Year(Date)
    If Not IsNumeric(YYYY) Or YYYY \ 1 <> YYYY Or YYYY < 100 Or YYYY _
      > 9999 Then Exit Function
    If JulDay > 0 And JulDay < 366 Or JulDay = 366 And _
      YYYY Mod 4 = 0 And YYYY Mod 100 <> 0 Or YYYY Mod 400 = 0 Then _
        CJulian2Date = Format(DateSerial(YYYY, 1, JulDay), "m/d/yyyy")
End Function 
```

来源： http: [//support.microsoft.com/kb/209922](http://support.microsoft.com/kb/209922)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T01:26:49.490

取年并转换为当年的 1 月 1 日。添加天数并转换为日期格式。你可以把它放在一个查询中。

> CalcDate: CDate(CLng(CDate("01/01/" & [Year]))+[day]-1)

# php - 对具有重复值的数组进行排序并在值排序后保留索引顺序

> ID：10544093
> 
> 赞同：1
> 
> 时间：2012-05-11T01:01:54.460
> 
> 标签：php

我不知道为什么我会遇到这个问题，但我正在尝试对数组进行排序，例如“0,1,0,0,1,1,0,0”，以便数字 1 出现在结束，但数组索引按其原始顺序保留。

使用以下代码示例

```
<pre><?php
  $array = array(0,1,0,0,1,1,0,0);
  print_r($array);
  asort($array);
  print_r($array);
?></pre> 
```

从原始数组开始：

```
Array
(
    [0] => 0
    [1] => 1
    [2] => 0
    [3] => 0
    [4] => 1
    [5] => 1
    [6] => 0
    [7] => 0
) 
```

执行 asort($array) 后：

```
Array
(
    [6] => 0
    [7] => 0
    [0] => 0
    [3] => 0
    [2] => 0
    [1] => 1
    [5] => 1
    [4] => 1
) 
```

但是我需要做什么才能获得以下输出？（注意索引顺序）

```
Array
(
    [0] => 0
    [2] => 0
    [3] => 0
    [6] => 0
    [7] => 0
    [1] => 1
    [4] => 1
    [5] => 1
) 
```

我真的很想避免必须进行进一步的处理循环来按不同的值组重新排序索引（即对值为“0”的项目上的所有索引进行排序，然后对值为“1”的项目进行排序并合并结果）

* * *

编辑：这真的很乱，但解决了我想要实现的一个例子

```
print_r(stupid_array_order_hack($array));
function stupid_array_order_hack($array) {
  if(isset($array) === TRUE AND is_array($array) === TRUE) {
    $reordering_group = array();
    $reordering_merge = array();
    // Group the index's by value
    foreach($array as $key => $value) {
      $reordering_group[$value][] = $key;
    }
    // sort the grouped index's
    foreach($reordering_group as $key => $value) {
      asort($reordering_group[$key]);
      $reordering_merge = array_merge($reordering_merge,$reordering_group[$key]);
    }
    return array_replace(array_flip($reordering_merge),$array);
  }
  return $array;
} 
```

* * *

**解决方案：**使用 array_multisort() 的方法

```
$array = array(0,1,0,0,1,1,0,0);
$temp = array($array,array_keys($array));
array_multisort($temp[0],SORT_ASC,$temp[1],SORT_ASC);
$array = array_combine($temp[1], $temp[0]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:41:15.187

您需要按值对数组进行分组并对各个组进行排序：

```
$array = array(0,1,0,0,1,1,0,0);

$groups = array();
foreach ($array as $key => $value) {
    $groups[$value][$key] = $value;
}

ksort($groups);

$array = array();
foreach ($groups as $group) {
    $array += $group;
}

print_r($array); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:15:07.280

如果键需要匹配，那么我建议您使用 array_multisort()。例如：

```
$array =        array(0,1,0,0,1,1,0,0);
$other_array =  array(1,2,3,4,5,6,7,8);

array_multisort($array, $other_array); 
```

这将对两个数组进行排序，使数组的键顺序匹配。

[http://us.php.net/manual/en/function.array-multisort.php](http://us.php.net/manual/en/function.array-multisort.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T01:06:20.860

您可能想使用`array_merge()`重置数组键。

# xcode - iPad 上的游戏中心视图（灰色屏幕）

> ID：10544094
> 
> 赞同：0
> 
> 时间：2012-05-11T01:01:56.480
> 
> 标签：xcode, view, leaderboard

我正在使用此代码显示排行榜：

```
 -(void)viewscores:(SPEvent*)event

   {
     tempVC = [[UIViewController alloc] init];

    GKLeaderboardViewController* leaderboardController = [[[GKLeaderboardViewController alloc] init] autorelease];
    if (leaderboardController != nil)
    {
        leaderboardController.leaderboardDelegate = self;
        UIView *sparrowView = self.stage.nativeView; // take care that self.stage != nil!
        [sparrowView addSubview:tempVC.view];
        //[tempVC.view addSubview:leaderboardController.view];
        [tempVC presentModalViewController:leaderboardController animated:YES];
    }
}

- (void)animationDidStop:(NSString*)animationID finished:(BOOL)finished context:(void *)context
{
    for(UIView *subview in [tempVC.view subviews]) {
        [subview removeFromSuperview];
    }
    [tempVC.view.superview removeFromSuperview];
    [tempVC release];
}

-(void)leaderboardViewControllerDidFinish:(GKLeaderboardViewController*)viewController
{
    CGRect frame = viewController.view.frame;
    // [tempVC dismissModalViewControllerAnimated:YES];
    [UIView beginAnimations:@"curldoup" context:nil];
    [UIView setAnimationDelegate:self];
    [UIView setAnimationDuration:.5];
    [UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:context:)];
    // [UIView setAnimationTransition:UIViewAnimationTransitionCurlUp forView:self.stage.nativeView cache:YES];
    frame.origin.y = 420;
    viewController.view.frame = frame;
    [UIView commitAnimations];
    //[viewController.view removeFromSuperview]; 
```

当我在排行榜上单击完成时，背景变为灰色，应用程序变得混乱。

我非常肯定这是由于以下原因：

```
frame.origin.y = 420; 
```

由于 iPhone 屏幕是 420。任何人都可以帮我输入正确的数字吗？

任何想法表示赞赏，非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T02:26:48.243

你应该像这样呈现它：

```
- (void)showGCLeaderboard {
leaderboardController = [[GKLeaderboardViewController alloc] init];
if (leaderboardController != NULL)
{
    leaderboardController.category = kLeaderboardID; 
    leaderboardController.leaderboardDelegate = self;
    [self presentModalViewController:leaderboardController animated:YES];
} 
```

}

因此，只需这样做即可消除它：

```
- (void)leaderboardViewControllerDidFinish:(GKLeaderboardViewController *)viewController {
    [self dismissModalViewControllerAnimated:YES];
    [viewController release];
} 
```

**或者**

由于您尝试在 iPad 上执行此操作，因此您可以通过使用 UIPopovers 来使用它，但这取决于您并且没有必要。

# web-applications - 将 Web 应用程序数据与用户桌面同步的方法

> ID：10544096
> 
> 赞同：2
> 
> 时间：2012-05-11T01:02:07.140
> 
> 标签：web-applications, google-drive-api, dropbox, data-synchronization, atom-feed

我们在学术研究领域有一个网络应用程序，它接收来自科学仪器的数据并存储它。能够自动将这些数据与用户的桌面同步会很酷——至少有一种方式（网络 -> 桌面），但另一种方式也可能有用。根据部署，用户的数据总量在几百兆字节到几兆字节之间。（我们不需要解决每个案例——这是“这会很酷”，而不是“这是关键任务”）

## 谷歌驱动器/Dropbox/...

第一个想法是复制 Google Drive 或 Dropbox 上的数据。

优点：

*   坚如磐石的桌面同步应用
*   对用户来说舒适、熟悉的技术（在许多情况下，用户拥有机构 Google 帐户）

缺点：

*   这些 API 并不是为简单地传输数据而设计的。我们可能不得不将*所有*数据存储在那里，这会变得很昂贵，或者管理诸如删除旧数据之类的事情。
*   与 Google Drive 集成似乎很麻烦（在 Chrome Web Store 上注册应用程序......）
*   需要管理这些外部凭据等。

## Atom/RSS 提要？

进一步的想法是我们也许可以为每个用户设置一个 Atom 提要，也许有 Atom 客户端可以搜索提要并将所有链接下载到本地目录？我没有调查过。这可行吗？在某些情况下，我们已经在使用 Atom 将数据*输入*我们的应用程序，但我们显然没有为此使用桌面客户​​端。

我们真的很想使用现有的应用程序，并且至少需要支持 Windows (XP+) 和 OS X。我们不想从事编写任何桌面软件的业务。

## 其他？

如果有两种方法，还有其他方法吗？

# ios - 点击图片，移除标签，仅显示图片

> ID：10544099
> 
> 赞同：0
> 
> 时间：2012-05-11T01:03:25.533
> 
> 标签：ios

这是一个多部分的问题，我认为我不需要代码，但我确实需要方法。我正在使用情节提要并有一个屏幕，该屏幕具有动态显示的图像，带有一些标签和描述性文本。我想添加这样的功能，当用户点击图像时，所有文本和标签“消失”，只显示图像，占据全屏。图像应该是可缩放的。当用户点击图像时，它应该将它们带回“带文本的图像”视图。感谢您的任何帮助和建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:25:18.937

我的方法：点击图像，创建一个新的视图控制器，带有大图像和 alpha 和缩放动画。Viewcontroller 具有缩放功能。点击时，在 alpha 和缩放动画后移除 viewcontroller。

# c# - .NET 中如何实现“事件”对象？

> ID：10544101
> 
> 赞同：3
> 
> 时间：2012-05-11T01:03:46.513
> 
> 标签：c#, .net, events

我只是想确保我理解这一点......

.net 中的“事件”只是代表的集合 - 当某个类想要获取“事件”时，它使用“+”运算符和代表将指向的方法（一种观察者）

因此，如果事件发生 => 某个指针将在集合上移动，并将调用在事件注册中定义的方法。

我对这个描述是否正确？是否有可能以某种方式看到“事件”对象的 Microsoft .net 实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T01:14:48.493

.Net中没有`Event`对象。.Net 中的事件都是基于[`MulticastDelegate`s 的](http://msdn.microsoft.com/en-us/library/system.multicastdelegate.aspx)（并且 .Net 中的每个委托都是 a `MulticastDelegate`）。

如果您有两个相同类型的委托，则可以使用`+`运算符将​​它们组合起来，这不是特定于事件的。

实现的方式`MulticastDelegate`是它有一个调用列表，其中包含调用此委托时将调用的简单委托。[`GetInvocationList()`](http://msdn.microsoft.com/en-us/library/system.delegate.getinvocationlist.aspx)您可以通过调用该委托来查看它。

您可以尝试查看 的实现`MulticastDelegate`，或者说，`EventHandler`在像 Reflector 这样的反编译器中，但您不会在那里看到太多，它们都是直接在框架中实现的。

如果您想查看处理调用委托的代码所在的框架的源代码，您可以尝试[SSCLI](http://en.wikipedia.org/wiki/Shared_Source_Common_Language_Infrastructure)，或者您可以尝试查看[mono 的源代码](https://github.com/mono/mono)（但这不会向您显示 MS 实现）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T01:18:16.537

一个事件实际上是一个单一的委托。代表实际上支持多个回调。这不是事件的事情。

事件可以像属性一样使用。属性有一个获取/设置，而事件有一个添加/删除（尽管这通常是自动实现的）。

```
private EventHandler<EventArgs> myEvent;

public event EventHandler<EventArgs> MyEvent
{
    add
    {
        myEvent = (EventHandler<EventArgs>)Delegate.Combine(myEvent, value);
    }
    remove
    {
        myEvent = (EventHandler<EventArgs>)Delegate.Remove(myEvent, value);
    }
} 
```

当一个事件被触发时，基本上会调用委托。那里没有太多的魔法。

我希望这有帮助。我认为您不会找到调用事件的实现，因为它内置在 CLR 中。有人提到您可以查看 Mono 源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T01:13:28.843

我认为**Event**封装了委托，就像属性和字段的相对关系一样。

# javascript - 为 gmaps4rails 放置自定义 js 的位置

> ID：10544103
> 
> 赞同：0
> 
> 时间：2012-05-11T01:04:16.307
> 
> 标签：javascript, ruby-on-rails, gmaps4rails

我正在使用 gmaps4rails gem，当我想创建信息框时，我有一个这样的 JS：

```
Gmaps.map.infobox = function(boxText) {
  return {
     content: boxText
    ,disableAutoPan: false
    ,maxWidth: 0
    ,pixelOffset: new google.maps.Size(-145, 0)
    ,zIndex: null
    ,boxStyle: {
      background: "url(/assets/content/tipbox.gif) no-repeat"
      ,opacity: 0.90
      ,width: "280px"
       }
    ,closeBoxMargin: "10px 2px 2px 2px"
    ,closeBoxURL: "assets/content/close.gif"
    ,infoBoxClearance: new google.maps.Size(1, 1)
    ,isHidden: false
    ,pane: "floatPane"
    ,enableEventPropagation: false
 }}; 
```

为了在我的源代码中添加这个 js，我在完成后立即渲染它：

```
<%= yield :scripts %> 
```

但我的问题是：还有其他更好的方法可以避免打开两个脚本标签吗？

# vb.net - 在主窗体中初始化一个朋友数组，VB

> ID：10544104
> 
> 赞同：0
> 
> 时间：2012-05-11T01:04:26.627
> 
> 标签：vb.net, arrays, windows-forms-designer, friend

我正在开发一个 VB Windows 窗体，我在这里有一个关于初始化数组（友元变量）的问题

我有一`BookInfo`堂课如下：

```
Public Class BookInfoForm
  Friend _books() As BookInfo
  ...
EndClass 
```

在我的主要形式中，我想将此`_books`数组初始化为大小 4。

我试过的是：

```
_bookInfoForm._books(4) = New BookInfo 
```

但这没有用，它抛出了一个异常说

`Object reference not set to an instance of an object.`

我想知道如何将数组初始化为大小 4。任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:19:38.677

首先，您需要初始化 BookInfoForm 类，然后用于`Redim`调整数组大小

```
Dim BookInfo As New BookInfoForm
Redim BookInfo._books(4) 
```

可以调整数组的`Redim`大小，但也可以清除数组中的所有数据，如果你想在调整数组大小的同时保留这些数据，那么你需要使用`Preserve`after`Redim`

```
Redim Preserve BookInfo._books(4) 
```

# arrays - 查找父（'TD'）ID循环不显示整个ID

> ID：10544107
> 
> 赞同：0
> 
> 时间：2012-05-11T01:04:51.703
> 
> 标签：arrays, loops, element, parent-child

我在获取父节点 ID 以完整显示时遇到了一些问题。

我正在使用循环来检测表中的 div 元素，然后我让它找到父 TD 节点，并在另一个变量中从中获取 id。

我的问题是，在这个循环中，我在数组中使用这个 TD id 在自身上构建一个变量，当它打印时，第一次它只会显示第一个字符，然后第二次它只会显示第二个字符并且任何时候之后会出现空白。

如果我从变量中删除数组，它将打印整个 id，但每次循环运行时它将旧值重命名为最新值。

有人可以帮我解决这个问题吗？

任何帮助表示赞赏，在此先感谢。

这是我正在写的功能

```
test.save = function () {

var cell = rd = REDIPS.drag,
    page1a = document.getElementById(redips.p1a),
    divs = TableID.getElementsByTagName('DIV'),
    rd.find_parent('TD', rd.obj),     //parent cell
    st = cell.id,                           //parent cell ID
    st,                     
    id,                                     //div id
    cid,                                   //cell id    
    ccid, 
    concatenator,                         // concatenate oDiv ID
    query = '',
    div,                                // current DIV element
    i;                                  // loop variable

    for (i = 0; i < divs.length; i++) {

    // set current DIV element
    div = divs[i];

    // set current TD ID
    cid = st[i];

    if (div.className.indexOf('drag') > -1) {

                    //takes two characters off of the DIV ID only
        concatenator = div.id.substring(0, div.id.length - 2);

        // creates the query through the loop
            query += cid + '=' + concatenator + ' ';
        }
}

     if (query.length > 0) {
     document.getElementById('message').innerHTML = query;
}
    }; 
```

这是一个使用带有 TD ID 的数组的版本的链接：http: [//stevenschemers.com/beta1/](http://stevenschemers.com/beta1/)

这里有一个不使用 TD ID 数组的版本的链接：http: [//stevenschemers.com/beta2/](http://stevenschemers.com/beta2/)

我还注意到，如果运行两次，这似乎是循环，因为“i”会向上计数 0、2、4、6。或者有时是 1、3、5、7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T23:32:03.443

```
// loop goes through each DIV element collected on the left side of page 1
for (i = 0; i < divs.length; i++) {
    // set current DIV element
    div = divs[i];

    if (div.className.indexOf('drag') > -1) {
        // sets current cell ID for dropped div
        cid = rd.find_parent('TD', div).id;

        concatenator = div.id.substring(0, div.id.length - 2);
        // creates the query through the loop
            querya += cid + '=' + concatenator + '&';
            qc++;
        }
} 
```

# html - 如何使用 HTML5 Drag&Drop 获取源 ID

> ID：10544110
> 
> 赞同：2
> 
> 时间：2012-05-11T01:05:27.260
> 
> 标签：html

我正在拖动一个图像，就像它在[这里](http://www.w3schools.com/html5/tryit.asp?filename=tryhtml5_draganddrop2)完成的那样。我正在尝试获取 div 的 id，我从中开始拖动过程​​。我怎样才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T01:28:37.333

在您链接的示例中，该函数`drag()`由图像节点的 onDragStart 事件触发。这个事件对象被传递给 的`ev`参数`drag()`，使`drag()`函数可以通过 访问事件的目标——也就是你拖动的元素`ev.target`。

既然有了目标，就可以用 访问目标的父节点`ev.target.parentNode`，也可以通过 访问父节点的ID `ev.target.parentNode.id`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-06T05:19:50.480

这对我有用...改编自 w3schools.com 示例。

打开 Javascript 控制台，查看拖拽项目的 id、源和目标的 console.log。

```
 <!DOCTYPE HTML>
  <html>
  <head>
  <style>
  .dropbox {
      width: 350px;
      height: 70px;
      padding: 10px;
      border: 1px solid #aaaaaa;
  }
  </style>
  <script>
  function addEventToClass(cls, fx, node = document, e = 'click') { 
     Array.from(node.querySelectorAll('.' + cls)).forEach(elem => elem.addEventListener(e, fx)); 
  }

  function clickEvent(ev) { console.log('clicked item:', ev.target.id); }
  function allowDrop(ev) { ev.preventDefault(); }

  function drag(ev) {
     var id = ev.target.id;
     ev.dataTransfer.setData("itemid", id);
     var source = id ? document.getElementById(ev.target.id).parentNode.id : '';
     ev.dataTransfer.setData("source", source);
  }

  function drop(ev, target) {
     ev.preventDefault();
     var item = ev.dataTransfer.getData("itemid");
     var source = ev.dataTransfer.getData("source");
     console.log('id of dragged item is:', item);
     console.log('id of source:', source);
     console.log('id of target:', target.id);
     ev.target.appendChild(document.getElementById(item));
  }
  </script>
  </head>
  <body>

  <div id="div1" class='dropbox' ondrop="drop(event, this)" ondragover="allowDrop(event)"></div>
  <div id="drag1" class='dragitem' draggable="true" ondragstart="drag(event, this)" width="336" height="69">Item 1</div>
  <div id="drag2" class='dragitem' draggable="true" ondragstart="drag(event, this)" width="336" height="69">Item 2</div>
  <div id="div2" class='dropbox' ondrop="drop(event, this)" ondragover="allowDrop(event)"></div>

  <script>
     addEventToClass('dragitem', clickEvent);
  </script>
  </body>
  </html> 
```

# android - 将检查的项目从列表视图保存到文件

> ID：10544112
> 
> 赞同：1
> 
> 时间：2012-05-11T01:05:53.583
> 
> 标签：android, listview, checkbox

我在任何地方都找不到一篇文章来解释如何在 ListView 中实际保留复选框的结果。很多展示如何显示，但他们都忽略了如何保存。

当我从菜单项中单击“设置收藏夹”时，我想加载一个名称列表并为每个名称显示一个复选框。我希望能够进行多次“检查”，然后我希望能够以某种形式将列表及其检查设置保存到一些持久性存储中，最好是在 SD 卡上。该列表只需要包含“name”的值和“isChecked”的值

我将只显示下面的结构，而不是所有代码，因为我认为我的问题是结构和范围之一，而不是语法

在主菜单活动中，我将一个列表（checkedlist）传递给一个自定义适配器

```
public class SetFavourites extends ListActivity {
 /** Called when the activity is first created. */
  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    .
    .
    FavouritesAdapter adapter = new FavouritesAdapter(this, checkedList);
    setListAdapter(adapter);

} 
```

适配器有一个 onCheckedChangeListener，所以每当一个复选框被更改时，在我写 //Here's where I'm 卡住的地方，我将拥有该行的名称和检查值

```
public class FavouritesAdapter extends ArrayAdapter<JSONObject> implements    OnCheckedChangeListener {

@Override
 public View getView(int position, View convertView, ViewGroup parent) {

}

@Override
 public void onCheckedChanged(CompoundButton cb, boolean isChecked) {

    JSONObject checked = getItem(posSelected);

    // Here's where I'm stuck
}

} 
```

所以我的问题是，如果有多个检查事件，我该如何保存数据？

如果我创建一个模型来保存行名称及其检查状态，那么我应该在哪里实例化该模型 - 从活动中还是从适配器中？

如果在适配器内，它没有告诉“检查”何时完成的事件，所以虽然它可以添加到模型中，但它不能进行保存。

如果Adapter实例化了模型，主Activity怎么保存呢？我可以使用什么事件来完成数据保存？后退按钮方法（在主 Activity 中定义，因此不能在 Adapter 中执行）或 Activity onStop() 方法，类似地。

如果我在Activity中实例化数据模型并传入，如何再次传出去保存？

如您所见，我完全不知道如何处理这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T06:43:23.063

我没有使用过 JSON，但我在使用 SQLite 数据库时遇到了类似的情况。

所以也许我可以给你一个粗略的布局，展示我是如何处理它的，你可以填写 JSON 位并使其符合你的需要。

在自定义适配器中设置一个数组：

```
public static int[] checked; 
```

有一个构造函数：

```
public FavouritesAdapter(Context context, int layout, Cursor c,
        String[] from, int[] to) {
    super(context, layout, c, from, to);

    initializeChecked();
}

public static void initializeChecked() {
    checked = new int[c.getCount()];
    int i = 0;
    while (i < c.getCount()) {
        checked[i] = 0;
        i++;
    }
} 
```

然后在您的 onCheckedChanged 中：

```
@Override
public void onCheckedChanged(CompoundButton cb, boolean isChecked) {
    if(isChecked == true){
        checked[posSelected] = 1;
    } else {
        checked[posSelected] = 0;
    }
} 
```

然后 onClick 用于列表外的按钮以提交您的更改：

```
commit.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        int i = 0;
        itemCursor.moveToFirst();  // existing cursor backing the list
        while (itemCursor.isAfterLast() == false) {  // iterate through cursor and match checked with rows
            if (FavouritesAdapter.checked[i] == 1) {
                // do your save to db/file/whatever here
        }
        i++;
        itemCursor.moveToNext();
    }
}; 
```

不特定于您的情况，但希望您会发现它有帮助。

# c# - 绑定一个 ObservableCollection 到标签

> ID：10544115
> 
> 赞同：1
> 
> 时间：2012-05-11T01:06:07.720
> 
> 标签：c#, wpf, xaml, data-binding, observablecollection

在我的代码隐藏中，我在课堂上有以下内容：

```
public ObservableCollection<int> ints; 
```

它的值在构造函数中初始化：

```
ints = new ObservableCollection<int>(); 
```

然后我将标签绑定到`ints`：

```
<Label Name="label" Content="{Binding Source={StaticResource ints}, Path=Count}"/> 
```

运行程序后，`XamlParseException`出现a：

> '在 'System.Windows.StaticResourceExtension' 上提供值引发了异常。' 行号“12”和行位置“20”。

我猜装订线有问题。有什么建议么？

说明该问题的完整演示程序如下：

XAML：

```
<Window x:Class="BindingObservableCollectionCountLabel.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">

    <DockPanel>            
        <StackPanel>
            <TextBox Name="textBox" Text="10"/>
            <Button Name="add" Click="add_Click" Content="Add"/>
            <Button Name="del" Click="del_Click" Content="Del"/>
            <Label Name="label" Content="{Binding Source={StaticResource ints}, Path=Count}"/>
        </StackPanel>            
    </DockPanel>
</Window> 
```

C＃：

```
using System;
using System.Windows;
using System.Collections.ObjectModel;

namespace BindingObservableCollectionCountLabel
{
    public partial class MainWindow : Window
    {
        public ObservableCollection<int> ints;

        public MainWindow()
        {
            InitializeComponent();

            ints = new ObservableCollection<int>();
        }

        private void add_Click(object sender, RoutedEventArgs e)
        {
            ints.Add(Convert.ToInt32(textBox.Text));
        }

        private void del_Click(object sender, RoutedEventArgs e)
        {
            if (ints.Count > 0) ints.RemoveAt(0);
        }
    }    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:42:27.233

如果不需要在资源中收集该集合，请执行以下操作：

1.  将绑定更改为

    ```
    <Label Name="label"
           Content="{Binding Path=ints.Count,
                             RelativeSource={RelativeSource AncestorType=Window}}"/> 
    ```

2.  创建`ints`一个属性：

    `public ObservableCollection<int> ints { get; private set; }`

如果您需要将此集合作为资源，请将窗口构造函数更改为

```
public MainWindow()
{
    // line order is important!
    Resources.Add("ints", ints = new ObservableCollection<int>());
    InitializeComponent();
} 
```

并保持 XAML 不变

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:41:09.567

您的绑定命令是错误的。

```
Content="{Binding ints.Count}" 
```

# wif - 如何在不使用 AD 的情况下向 STS 服务器提供声明

> ID：10544121
> 
> 赞同：0
> 
> 时间：2012-05-11T01:07:11.197
> 
> 标签：wif, claims-based-identity

我的 SaaS Web 应用程序需要一个身份验证/授权模块，并且我喜欢 WIF 的外观。问题在于，除了 Active Directory 之外，似乎没有一种即插即用的方式来服务声明。我的想法是使用[IdentityServer](http://identityserver.codeplex.com/)并用我自己的替换 ASP.NET Membership Provider 存储库。

诀窍是

*   面向许多不同客户的应用程序互联网。（所以[ADFS2](https://stackoverflow.com/questions/2827298/does-adfs2-0-provide-custom-authentication-stores)不适用）。
*   我想要精细的操作级别权限，而不是角色。（所以[ASP.NET Membership](http://msdn.microsoft.com/en-us/library/ms731049.aspx)不适合）
*   我希望我的应用程序中的用户管理他们自己的用户子集。

我打算构建的位是下面称为“索赔服务器”的粉红色框。

*IClaimsService*将允许创建新用户、创建角色、将权限分配给角色以及将用户分配给这些角色。我自己的应用程序将验证插入 IClaimsService 的管理屏幕并验证用户创建子用户的权限等。

我的问题是 - 这是一个有效的架构还是我完全错过了 WIF 的意义？

还是有我没有找到的替代即插即用选项？我很高兴没有重新发明轮子！

![身份服务器架构](../Images/9ec5097a0036859999460b056cf66cd8.png)

***附加信息***

我的网络应用程序是一个 SaaS，它需要允许我的客户在他们自己的数据围墙内创建自己的用户。

以招聘软件平台为例，在该平台上，您有竞争激烈的招聘团队，他们在系统中拥有自己的客户。一个团队不允许在另一个团队的数据上达到峰值，但每个团队都可以管理和管理他们自己的用户子集。可能有许多不同的公司在使用该平台，因此没有中央 IT 部门/域来管理它。都是自助服务。

我看过[netsqlazman](http://netsqlazman.codeplex.com/)，它与我想要的很接近，但 Windows Identity Foundation 看起来将具有更长期的好处，因为我连接新客户并且可以将他们自己的 STS 连接到我的身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:06:01.530

我认为你是正确的，WIF 会让你走上正确的道路。基于声明的身份将继续存在，并且所有事物都在融合。WIF 使得它比过去更容易实施。

我的建议是从最简单的事情开始，即首先使用声明对用户进行身份验证。然后将用户句柄（例如电子邮件或 user_id 等）与您在应用程序中构建的任何授权架构相关联。可以是会员资格、自定义数据库等。

您描述的供应和自我管理都是特定于应用程序的，与选择的身份提供者无关（例如 IdentityServer 或与 WIF 兼容的任何其他东西：SAML 令牌、WS-Federation 等）。

随着时间的推移，这个简单的步骤将为更复杂的解决方案奠定基础，并允许您通过稍微增加的努力提供即时价值。例如，您可以允许具有社交身份的用户登录您的网站。您仍然会在您的应用程序中定义：“fiat@mail.com”->“可以管理用户”。

随着时间的推移，您会发​​现可以进一步外化的常见的、经常出现的属性（例如角色）。然后像你提议的东西是有道理的。

一个澄清：ADFS仅针对 AD 进行*身份验证*，但可以从任何地方（数据库、LDAP、自定义等）检索属性。

# android - ViewPager 和 ActionItems 消失的 ActionbarSherlock

> ID：10544122
> 
> 赞同：1
> 
> 时间：2012-05-11T01:07:27.970
> 
> 标签：android, android-actionbar, actionbarsherlock

我有一个带有 ViewPager 和带有 ActionItems 实现的 ActionbarSherlock 的选项卡式“主页”活动，除了一个小怪癖外，它运行良好：如果我在选项卡之间切换太快（即从选项卡 A 开始，切换到选项卡 B 并快速切换在操作项更改之前到选项卡 C）然后操作项消失并且在我旋转屏幕或重新启动应用程序之前不会回来。

我查看了演示，其中没有与我正在做的类似的东西。所以我想知道是否有其他人经历过这种情况，并且有**正确**的方法可以做到这一点。

谢谢

# asp.net - 如何在其中查找控件 中继器

> ID：10544123
> 
> 赞同：4
> 
> 时间：2012-05-11T01:07:30.287
> 
> 标签：asp.net, controls, repeater

我有这个源代码：

```
<div id = "AddComment">
    <asp:TextBox ID="txtComment" runat="server" TextMode="MultiLine" Height="20"></asp:TextBox>
    <asp:Button ID="btnComment" CommandName="btnComment_click"  runat="server" Text="Comment" />                           
</div> 
```

它位于 ASP 中继器的项目模板标签内...我想做的是为这两个控件的某些事件编写 c# 代码.. 文本框和按钮...我如何从 c 访问这些控件＃ 代码 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T04:45:38.767

你需要连接到`OnItemDataBound`

```
<asp:Repeater OnItemDataBound="RepeaterItemEventHandler" ... /> 
```

现在，关于背后的代码......

```
 void RepeaterItemEventHandler(Object Sender, RepeaterItemEventArgs e) {
     if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem) {
        TextBox currentTextBox = (TextBox)e.Item.FindControl("txtComment");
        //do something cool 
     }
  } 
```

# c - 包含 2 个结构数组的结构数组未正确初始化，导致段错误

> ID：10544125
> 
> 赞同：1
> 
> 时间：2012-05-11T01:07:57.057
> 
> 标签：c, arrays, struct

这是我的两个结构：

```
struct upset {
  int location;     
  int trigger;    
  int type;      
  char bits[8]; 
  }; 

struct event {
  int category;
  int spill;
  int num_clock_ups;
  int num_data_ups;
  struct upset clock_ups[512];
  struct upset data_ups[512];
  }; 
```

但是当我尝试用这个进一步声明一个结构事件数组时：

```
int nevents = 1755;
struct event total_events[nevents]; 
```

我第一次尝试访问数组中的任何内容时遇到段错误，在使用 gdb 检查时，就在段错误 sizeof(total_events) 为 0 并且 total_events[1] 和 total_events[2] 的位置差为 0x10 之前，所以似乎结构不安的数组没有被初始化或其他东西。

我在初始化这个数组时做错了什么？我的结构设置不好吗？我对 C 和一般结构中的结构非常陌生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:13:50.577

您的进程堆栈空间是否足够大？根据我的计算，数组将至少占用（忽略潜在的结构成员对齐填充）：

```
[2*(13*512) + 4]*1755 = 22.3 MB 
```

的空间。如果`total_events`是局部变量，它将被分配到堆栈上。你有那么多堆栈空间吗？

# r - 基于R中的另一列删除重复日期

> ID：10544128
> 
> 赞同：3
> 
> 时间：2012-05-11T01:08:16.010
> 
> 标签：r, date, duplicates

我有几个小时的多个条目的时间序列。

```
 date  wd  ws temp sol octa pg  mh daterep
1 2007-01-01 00:00:00 100 1.5  9.0   0    8  D 100   FALSE
2 2007-01-01 01:00:00  90 2.6  9.0   0    7  E  50    TRUE
3 2007-01-01 01:00:00  90 2.6  9.0   0    8  D 100    TRUE
4 2007-01-01 02:00:00  40 1.0  8.8   0    7  F  50   FALSE
5 2007-01-01 03:00:00  20 2.1  8.0   0    8  D 100   FALSE
6 2007-01-01 04:00:00  30 1.0  8.0   0    8  D 100   FALSE 
```

我需要得到一个每小时一个条目的时间序列，在有多个条目的情况下获取具有最小 mh 值的条目。（所以在上面的数据中，我的第二个条目应该是第 2 行，第 3 行应该被删除。）我一直在研究这两种方法：将我想要的内容放入新的数据框中，并删除我不想要的内容存在，但无处可去。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:02:11.447

您可以通过`date`和`mh`使用对数据进行排序`plyr::arrange`，然后删除重复项：

```
df <- read.table(textConnection("

               date    wd  ws temp sol octa pg  mh daterep
'2007-01-01 00:00:00' 100 1.5  9.0   0    8  D 100   FALSE
'2007-01-01 01:00:00'  90 2.6  9.0   0    7  E  50    TRUE
'2007-01-01 01:00:00'  90 2.6  9.0   0    8  D 100    TRUE
'2007-01-01 02:00:00'  40 1.0  8.8   0    7  F  50   FALSE
'2007-01-01 03:00:00'  20 2.1  8.0   0    8  D 100   FALSE
'2007-01-01 04:00:00'  30 1.0  8.0   0    8  D 100   FALSE

"), header = TRUE)

library(plyr)
df <- arrange(df, date, mh)
df <- df[!duplicated(df$date), ]
df
#                  date  wd  ws temp sol octa pg  mh daterep
# 1 2007-01-01 00:00:00 100 1.5  9.0   0    8  D 100   FALSE
# 2 2007-01-01 01:00:00  90 2.6  9.0   0    7  E  50    TRUE
# 4 2007-01-01 02:00:00  40 1.0  8.8   0    7  F  50   FALSE
# 5 2007-01-01 03:00:00  20 2.1  8.0   0    8  D 100   FALSE
# 6 2007-01-01 04:00:00  30 1.0  8.0   0    8  D 100   FALSE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T08:08:56.983

类似于 flodel，但使用基 R 并确保它`date`是一个真正的 DateTimeClass：

```
d <- read.table(text = "
               date    wd  ws temp sol octa pg  mh daterep
'2007-01-01 00:00:00' 100 1.5  9.0   0    8  D 100   FALSE
'2007-01-01 01:00:00'  90 2.6  9.0   0    7  E  50    TRUE
'2007-01-01 01:00:00'  90 2.6  9.0   0    8  D 100    TRUE
'2007-01-01 02:00:00'  40 1.0  8.8   0    7  F  50   FALSE
'2007-01-01 03:00:00'  20 2.1  8.0   0    8  D 100   FALSE
'2007-01-01 04:00:00'  30 1.0  8.0   0    8  D 100   FALSE
", header = TRUE)

d$date <- as.POSIXct(d$date)

d <- d[order(d$date, d$mh), ]
d[!duplicated(d$date), ]

                 date  wd  ws temp sol octa pg  mh daterep
1 2007-01-01 00:00:00 100 1.5  9.0   0    8  D 100   FALSE
2 2007-01-01 01:00:00  90 2.6  9.0   0    7  E  50    TRUE
4 2007-01-01 02:00:00  40 1.0  8.8   0    7  F  50   FALSE
5 2007-01-01 03:00:00  20 2.1  8.0   0    8  D 100   FALSE
6 2007-01-01 04:00:00  30 1.0  8.0   0    8  D 100   FALSE 
```

# jquery - 如何通过 JQuery UI 可选小部件进行两组选择？

> ID：10544131
> 
> 赞同：0
> 
> 时间：2012-05-11T01:08:39.623
> 
> 标签：jquery, jquery-ui, jquery-ui-selectable

我正在尝试使用 UI Selectable 进行两组选择。

过程是这样的：

首先，我选择了几行，然后单击一个按钮来设置完成第一轮选择。并且选定的行将突出显示为一种颜色，即“红色”。然后，我开始第二轮选拔。此第二轮选择不应更改第一轮选定行的颜色。第二轮选择结束后，点击按钮设置第二轮选择结束；第二轮选择将以另一种颜色突出显示，例如“绿色”。

我可以轻松地进行第一轮选择，但我不知道如何在保持第一轮选择颜色不变的情况下进行第二轮选择。我可以手动为第一轮选择添加一个 id，但是当我进行第二轮选择时，我不知道如何保持第一轮选择的颜色不变。我什至尝试为第一轮选定的结果创建一个新的 css 样式以保持其突出显示的颜色，但它只是没有用。

在这里添加一些代码：

```
<!--<link rel="stylesheet" type="text/css" href="js/themes/blue/style.css"/>-->
<link rel="stylesheet" type="text/css" href="js/css/redmond/jquery-ui-1.8.20.custom.css">
<style>

#tablebody .ui-selecting { background: #F5F5DC; }
#tablebody .ui-selected { background: #98F5FF; color: black; }
.ui-selected-grp1 {background: red; color: black; }
#tablebody { list-style-type: none; margin: 0; padding: 0; width: 60%; }
#tablebody tr { margin: 3px; padding: 0.4em; font-size: 1.4em; height: 18px; }
</style>

<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="js/jquery.tablesorter.min.js" type="text/javascript"></script>
<script src="js/js/jquery-ui-1.8.20.custom.min.js" type="text/javascript"></script>

<script type="text/javascript">
$(document).ready(function(){
    $("#metatable").tablesorter();
    $("#tablebody").selectable();
        $('#grp1').click(function(){
        $('tr.ui-selected').addClass('ui-selected-grp1');

        return false;
    })
})
</script> 
```

如您所见，我尝试添加类“ui-selected-grp1”来控制第一轮选择颜色，但没有奏效。当我开始进行第二轮选拔时，第一轮的亮点刚刚过去。你能给我一些关于这个过程的建议或代码示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:07:19.633

这是实现此目的的基本方法 - [http://jsfiddle.net/vC7NP/](http://jsfiddle.net/vC7NP/)。通过 jQuery 的方法设置所选元素的样式`css`将覆盖 jQuery UI 应用的任何 CSS，因此第一轮的颜色变化应该保持不变。

# php - 使用 htaccess 将静态重定向到动态 url

> ID：10544134
> 
> 赞同：1
> 
> 时间：2012-05-11T01:09:12.110
> 
> 标签：php, .htaccess, mod-rewrite

在我的情况下，我需要反过来，我有超过 1000 个这样的链接`www.domain.com/msg/98212.html`，我必须将它们重定向到新的动态生成页面，比如`www.domain.com/msg/view.php?id=98212`

id 或`98212.html`因文件而异。

有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:11:50.920

```
RewriteRule ^msg/([0-9]+).html msg/view.php?id=$1 [L] 
```

`[R,L]`如果您希望新的 URL 显示在用户的浏览器中，请设置它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T01:11:41.703

```
RewriteRule /msg/[0-9]+).html /msg/view.php?id=$1 
```

# c# - 防止 FlipView 滚动

> ID：10544135
> 
> 赞同：1
> 
> 时间：2012-05-11T01:09:18.637
> 
> 标签：c#, windows-8, windows-runtime

正如标题所说，我想防止 FlipView 在某些情况下滚动。有没有办法做到这一点？（请在 C# 中！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T06:20:45.560

这很容易。放

```
FlipView.IsEnabled = false; 
```

如果上述情况以某种方式导致您的控件出现不希望的视觉状态 - 您也可以设置

```
ManipulationMode="All" 
```

在 FlipView 内的任何任何项目上，以从底层滚动视图中窃取对操作的控制。这也适用于具有滚动视图的任何其他控件 - 例如 ListView、GridView 或 ListBox。

# git - 如何强制将重置推送到远程存储库？

> ID：10544139
> 
> 赞同：100
> 
> 时间：2012-05-11T01:09:42.177
> 
> 标签：git

我们的远程主分支不知何故搞砸了。当前的开发代码与最新的提交一起在主分支上。显然，开发代码还没有准备好用于 master 分支。

所以在我的本地存储库中，我重置了最新的标签，`git reset --hard (Tag)`. master 分支现在在我的本地存储库上是正确的。现在，当我尝试将更改推送到远程存储库时，`git push origin master`出现错误：

```
To (REMOTE GIT REPOSITORY LOCATION)
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to '(REMOTE GIT REPOSITORY LOCATION)'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

所以环顾四周后，我发现了这个`--force`选项。所以我对远程存储库进行了强制推送，`git push --force origin master`但仍然出现错误：

```
Total 0 (delta 0), reused 0 (delta 0)
remote: error: denying non-fast-forward refs/heads/master (you should pull first)
To (REMOTE GIT REPOSITORY LOCATION)
 ! [remote rejected] master -> master (non-fast-forward)
error: failed to push some refs to '(REMOTE GIT REPOSITORY LOCATION)' 
```

我不能在 master 上做一个 pull，因为它包含不能在 master 上的开发代码。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-05-11T01:40:23.177

该消息意味着您不允许进行非快进推送。

您的远程存储库很可能`denyNonFastforwards = true`在其配置中。如果你改变它，`git push --force`应该工作。

要更改设置，您需要访问具有远程存储库的计算机。从那里，做`git config receive.denynonfastforwards false`。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-11T01:29:04.430

遥控器不允许非快进。

你最好的选择是`git revert`所有不应该存在的提交，并且在未来更加小心。

`git revert [commit]`将创建一个新的提交来撤消`[commit]`所做的一切。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-05-11T01:12:14.743

尝试使用该`-f`标志并将其放在远程分支名称之后。

`git push origin master -f`

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-03-25T20:31:31.093

以以下方式永久启用强制推送的步骤

```
git push -f myrepo my-branch 
```

**在远程存储库上以“.git”结尾的文件夹中编辑名为“config”的文件**

在失败推送的 git 命令行输出中，查找类似以下内容的行：

```
error: failed to push some refs to 'ssh://user@some-remote-server.mycompany.com/srv/git/myrepo.git 
```

然后

```
ssh user@some-remote-server.mycompany.com
cd /srv/git/myrepo.git
vi config 
```

**将“denyNonFastforwards”设置为 false**

在“配置”中，设置

```
[receive]
        denyNonFastforwards = false 
```

**现在您可以使用 -f 从本地计算机推送**

```
git push -f myrepo my-branch 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-09-05T18:56:47.067

解决此问题的最佳方法是删除远程分支并重新发送：

```
git push origin master --delete
git push origin master 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-10-25T13:14:07.730

你不能做不快进的 git push 。

1.  如果远程是 GitHub，请转到`https://github.com/$USER/$REPO/settings/branches`并取消保护有问题的分支。

    [![在此处输入图像描述](../Images/65097a67f44126e653cf0de852f00aa3.png)](https://i.stack.imgur.com/Kht72.png)

    你必须是 repo 的管理员才能做到这一点。

2.  如果远程是您自己的 git 服务器，请在`git config receive.denynonfastforwards false`那里运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-06T20:10:34.310

我通过从受保护的和默认的分支中删除主分支来解决，这在存储库的设置中刚刚超过受保护的分支规则。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-16T15:51:11.273

我正在使用这组命令来重置我的远程仓库，这将重新初始化您的本地仓库并与您的远程仓库重新链接，然后强制推送更新。

我认为这种方式不适用于您的情况，但可能对其他人有用

转到源文件夹，然后运行命令：注意这`https://github.com/*.git`是您的远程仓库链接

```
git init
git remote add origin https://github.com/*.git
git add .
git commit -m "initial commit"
git push origin master -f
git push --set-upstream origin master 
```

**`**Note: this will clear all your git history on your master branch**`**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-03T10:55:19.603

出现此问题的原因是当前分支未正确配置**PULL**。首先使用 - 检查上游分支是否正确配置为拉取`git remote show origin`。您可以在 -**为“git pull”配置的本地分支部分下找到它：**。如果没有，请使用以下命令进行配置：

```
git config branch.MYBRANCH.merge refs/heads/MYBRANCH 
```

为占位符提供适当的分支名称 - **MYBRANCH**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-11T19:44:26.770

对我来说，@svick 的暗示指向了正确的方向。由于我要修改的 git 服务器实际上是我的盒子，所以我登录它并`git config --global receive.denynonfastforwards false`更改所有 repos 以接受强制的非 ff 推送。没有开箱即用。我发现在配置中已经`receive.denynonfastforwards=true`设置了，并且不能用`git config --global --unset receive.denynonfastforwards`. 但是，手动在 repo 中进行编辑 ( `vi config`) 是有效的。

# mysql - 为什么在此创建表脚本中出现错误？

> ID：10544141
> 
> 赞同：1
> 
> 时间：2012-05-11T01:10:04.290
> 
> 标签：mysql, sql, mysql-error-1064

我正在尝试编写我的第一个 php/mysql 页面，但遇到了我找不到原因的 SQL 语法错误。

错误如下：

> 无法创建域建议表。错误 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“PRIMARY_KEY, domain TEXT, author TEXT, submitdate DATE NOT NULL ) DE”附近使用正确的语法

```
CREATE TABLE domainsuggestions(
    id INT NOT NULL AUTO_INCREMENT PRIMARY_KEY,
    domain TEXT,
    author TEXT,
    submitdate DATE NOT NULL
) DEFAULT CHARACTER SET utf8 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T01:13:03.550

在您的*CREATE TABLE*语句中，它应该`PRIMARY KEY`带有**空格**而不是`PRIMARY_KEY`包含**下划线**的空格。

### 解决方案：

从中删除*下划线*`PRIMARY_KEY`。

### 更正的脚本：

```
CREATE TABLE domainsuggestions
(
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    domain TEXT,
    author TEXT,
    submitdate DATE NOT NULL
) DEFAULT CHARACTER SET utf8 
```

### 演示：

[**单击此处查看 SQL Fiddle 中的工作 CREATE TABLE 脚本。**](http://sqlfiddle.com/#!2/000a1)

# wpf - 获取和修改 ControlTemplate 中的控件

> ID：10544147
> 
> 赞同：0
> 
> 时间：2012-05-11T01:10:56.213
> 
> 标签：wpf, xaml, controltemplate

我正在使用 xaml 和 ControlTemplate 如下：

```
<ControlTemplate TargetType="{x:Type local:MyControl}" x:Key="MyControlTemplate">

    <Grid Background="Transparent" Name="DisplayGrid"  >

        <local:MyDisplay x:Name="DisplayInstance" />
        <ContentPresenter   />

     </Grid>

</ControlTemplate> 
```

代码：

```
public class MyControl : UserControl
{

    ....
    ....
    ....
    public MyControl()
    {
         Template = (ControlTemplate)Resources["MyControlTemplate"];

         MyDisplay display = Template.FindName("DisplayInstance", this);
         // It return null
    }

} 
```

我想在模板中获取并设置“DisplayInstance”。我尝试了官方方法（使用 Template.FindName(string, Fr​​ameworkElement)），但它总是返回 null。

那么，我应该如何获取和修改 ControlTemplate/Xaml 中的“DisplayInstance”和任何其他控件？这样 ControlTemplate 的内容会在运行时发生变化。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:44:16.620

在您的自定义控件中覆盖[OnApplyTemplate](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.onapplytemplate.aspx)方法并将依赖于命名控件的代码放置在其中。例如尝试：

```
public override void OnApplyTemplate() {
        base.OnApplyTemplate();

        MyDisplay display = Template.FindName("DisplayInstance", this); 
    } 
```

# javascript - 没有 jquery/settimeout/setinterval 的 Javascript 动画

> ID：10544148
> 
> 赞同：0
> 
> 时间：2012-05-11T01:10:59.373
> 
> 标签：javascript

正如标题所说..有没有任何可能的方法可以在不使用 Jquery、settimeout 和 setinterval 的情况下在 javascript 中拥有最简单的动画。我已经研究太久了，找不到任何东西。可能没有办法做到这一点，只是想知道。也在寻找跨浏览器的东西，所以 CSS 动画也不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T01:18:27.390

现在做大多数动画的“正确”方法是 with `window.requestAnimationFrame`，它的作用类似于 a `setTimeout`，它在指定的时间运行一个回调函数。

它经过优化以 60fps 运行，在某些浏览器 (FF) 中，它将为您提供下一次绘制之前的确切毫秒数，以便您可以非常精确地计算动画位置。

谷歌“requestAnimationFrame shim”用于旧浏览器的各种跨浏览器实现。垫片都使用`setTimeout`- 没有办法解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:14:33.183

不，你怎么能在没有间隔/超时的情况下做到这一点并且能够跨浏览器做到这一点？你需要一些东西来继续触发它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T01:15:53.697

除非您在用户输入上制作动画，否则不会。如果您在用户触发鼠标移动事件或页面滚动事件时为某些东西设置动画，它可以工作，但它会是走走停停的，并且 100% 依赖于用户触发它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T01:24:32.793

不，我认为没有任何方法可以在不使用`setTimeout()`or的情况下暂停 javascript `setInterval()`。

我能想到的唯一选择是让 javascript 等待一些事件，例如 XMLHttpRequest 对象响应，这太荒谬了。

如果您正在寻找一些方便的“暂停执行 (x) 毫秒并继续”，例如`Thread.sleep()`在 JavaScript 或`usleep()`Unix 系统上，那么可悲的是没有这样的东西。

我记得听说为了在 Google Sketchup 中运行的 Ruby 脚本上的计时目的，有人费心制作一个不可见的 HTML 窗口，只是为了运行一点 JavaScript，`setInterval()`这样他们就有了计时机制。我认为，如果您不遗余力地运行 JavaScript 并且仍然使用 JavaScript，`setInterval()`则可能没有其他选择。

# r - 跨越数据框中多行的计算

> ID：10544155
> 
> 赞同：0
> 
> 时间：2012-05-11T01:11:39.967
> 
> 标签：r, time-series

在典型的电子表格中，我能够创建一个引用任何行上的单元格的公式。

所以让我们说我有以下数据：

```
a=1:10
b=11:20
c=data.frame(a,b) 
```

这将产生：

```
 a  b
1   1 11
2   2 12
3   3 13
4   4 14
5   5 15
6   6 16
7   7 17
8   8 18
9   9 19
10 10 20 
```

因此，在电子表格中，我可以将`c2`绝对公式放入单元格中`c$b2*c$a1`并获取数字`12`。或者甚至更复杂的东西，比如`ifelse(c$a>5,c$b*c$a[-1]*2,c$b*c$a[-1]`使用相对引用。

```
 a  b   c
1   1 11  NA
2   2 12  12
3   3 13  26
4   4 14  42
5   5 15  60
6   6 16  80
7   7 17 204
8   8 18 252
9   9 19 304
10 10 20 360 
```

我知道 R 不是电子表格，但是是否有一个包或函数可以让我以这种方式处理数据帧，或者这种功能是否存在根本性的问题？对于需要跨越多个记录或行的函数，我一直遇到这些问题。如果有帮助的话，我使用的几乎所有东西都是时间序列。是否有任何文件解释了这些功能？也许有一个`?topic`我错过的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:29:44.753

你很接近，你需要通过排除第一个和最后一个值来完成偏移量，然后将所有这些包装在`ifelse`：

```
a = 1:10
b = 11:20
d = data.frame(a,b)
d$c = ifelse(d$a > 5, c(NA, d$b[-1] * d$a[-nrow(d)]) * 2, c(NA, d$b[-1] * d$a[-nrow(d)])) 
```

（我选择`d`作为变量名，因为`c`它是一个非常常用的函数。）

要获得更整洁的答案，请将主要计算排除在外，`ifelse`并将其仅用于乘数：

```
 d$c = ifelse(d$a > 5, 2, 1) * c(NA, d$b[-1] * d$a[-nrow(d)]) 
```

# java - Android/OpenglES2：将 Java 对象映射到着色器结构？

> ID：10544159
> 
> 赞同：0
> 
> 时间：2012-05-11T01:12:27.723
> 
> 标签：java, android, opengl-es, opengl-es-2.0

我是 Android 上 OpenGLES2 编程的新手。我想知道如何将 Java 类映射到 Shader 程序中的属性/统一。假设在我的着色器中我定义了名为“light”的结构：

```
 struct light {
        vec4 position; 
        vec4 ambient_color;
        vec4 diffuse_color;
        vec4 specular_color;
        vec3 spot_direction;
        vec3 attenuation_factors;
        float spot_exponent;
        float spot_cutoff_angle;
        bool compute_distance_attenuation;
    };

uniform light light_state[8]; 
```

如果我编写一个反映相同结构的 Java 类，如下所示：

```
public class Light{
 public float[] position=new float[4];
 public float[] ambient=new float[4];
 public float[] diffuse=new float[4];
 public float[] specular=new float[4];
 public float[] spotDirection=new float[3];
 public float[] attenFactors=new float[3];
 public float spotExponent;
 public float spotCutoffAngle;
 public boolean computeDA;
} 
```

是否可以将 Light 实例映射到 Shader 程序中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T04:58:57.917

不，我认为不可能，您必须单独上传值。常规 OpenGL 有一个统一缓冲区对象的概念，它可能与您想要的类似，但我在 GLES api 中没有看到任何提及它们。

# .htaccess - .htaccess 子域的文件夹到 QueryString

> ID：10544167
> 
> 赞同：2
> 
> 时间：2012-05-11T01:13:27.193
> 
> 标签：.htaccess, redirect, query-string, subdomain

我需要`http://profiles.mysite.com/Me`展示会展示什么`http://mysite.com/profile.php?user=Me`。

“我”根据用户名而变化。它可以包含空格并且不是真正的文件夹。

我不希望在地址栏中更改 URL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T06:40:02.627

1.  通过启用 mod_rewrite 和 .htaccess`httpd.conf`
2.  在你的启用 mod_proxy`httpd.conf`

最后把这段代码放在你`.htaccess`的`DOCUMENT_ROOT`目录下

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f [OR]
RewriteCond %{REQUEST_FILENAME} !-d [OR]
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^ - [L]

RewriteRule ^([^\s]+)\s([^\s]+)(\s.*)?$ $1+$2$3 [L]
RewriteRule ^([^\s]+)\s $1 [L]

RewriteCond %{HTTP_HOST} ^profiles\.mysite\.com$ [NC]
RewriteRule ^(.*)$ http://mysite.com/profile.php?user=$1 [P,L,QSA] 
```

这个答案现在将支持 URI 中的任何空格，因为它是基于递归的规则。换句话说，像这样的 URI：

```
http://profiles.mysite.com/foo bar baz 
```

将被代理为：

```
http://mysite.com/profile.php?user=foo+bar+baz 
```

虽然浏览器中的 URL 将保留：

```
http://profiles.mysite.com/foo&20bar%20baz 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:21:47.440

将以下代码放入 web 根目录的 .htaccess 文件中应该可以满足您的需求：

```
RewriteCond %{HTTP_HOST} ^profiles.mysite.com
RewriteRule ^(.*)$ mysite.com/profile.php?user=$1 [L] 
```

# ios - Phonegap Hide Childbrowser 窗口插件

> ID：10544175
> 
> 赞同：0
> 
> 时间：2012-05-11T01:14:12.230
> 
> 标签：ios, cordova, phonegap-plugins, childbrowser

我想向 Childbrowser 窗口发送一个 URL。但是将其全部隐藏在页面之外，我需要进行哪些更改才能发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T12:40:43.217

虽然很受诱惑，但我不会问为什么？！？但是缺乏用处......无论如何，你不能。您可能必须自定义 ChildBrowser 的代码以*不*显示 webview，但我有点怀疑它会加载任何内容。

我对Objective-C不精通/不感兴趣，所以无法提供进一步的帮助。但是，如果您只需要不可见地加载页面，为什么不进行 JSONP 调用呢？

**编辑：**

我查看了 ChildBrowser 的 iOS 源代码，其中有一行`webview.hidden=NO;`可以更改为 ... `YES`。但是，您必须添加一些代码以提供稍后显示 web 视图。

# sql - 查询滚动日期范围内不同值的计数

> ID：10544182
> 
> 赞同：16
> 
> 时间：2012-05-11T01:14:37.470
> 
> 标签：sql, postgresql, date, count, rolling-computation

我有一组电子邮件地址和将这些电子邮件地址添加到表中的日期的数据集。对于不同的日期，一个电子邮件地址可以有多个条目。例如，如果我有下面的数据集。我希望获得在所述日期和 3 天前之间我们拥有的不同电子邮件的日期和数量。

```
Date   | email  
-------+----------------
1/1/12 | test@test.com
1/1/12 | test1@test.com
1/1/12 | test2@test.com
1/2/12 | test1@test.com
1/2/12 | test2@test.com
1/3/12 | test@test.com
1/4/12 | test@test.com
1/5/12 | test@test.com
1/5/12 | test@test.com
1/6/12 | test@test.com
1/6/12 | test@test.com
1/6/12 | test1@test.com 
```

如果我们使用 3 的日期周期，结果集将如下所示

```
date   | count(distinct email)
-------+------
1/1/12 | 3
1/2/12 | 3
1/3/12 | 3
1/4/12 | 3
1/5/12 | 1
1/6/12 | 2 
```

我可以使用下面的查询获得日期范围的不同计数，但希望按天获得一个范围的计数，因此我不必手动更新数百个日期的范围。

```
select test.date, count(distinct test.email)  
from test_table as test  
where test.date between '2012-01-01' and '2012-05-08'  
group by test.date; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-11T03:33:54.310

测试用例：

```
CREATE TABLE tbl (date date, email text);
INSERT INTO tbl VALUES
  ('2012-01-01', 'test@test.com')
, ('2012-01-01', 'test1@test.com')
, ('2012-01-01', 'test2@test.com')
, ('2012-01-02', 'test1@test.com')
, ('2012-01-02', 'test2@test.com')
, ('2012-01-03', 'test@test.com')
, ('2012-01-04', 'test@test.com')
, ('2012-01-05', 'test@test.com')
, ('2012-01-05', 'test@test.com')
, ('2012-01-06', 'test@test.com')
, ('2012-01-06', 'test@test.com')
, ('2012-01-06', 'test1@test.com`')
; 
```

查询 - 仅返回条目存在于的天数`tbl`：

```
SELECT date
     ,(SELECT count(DISTINCT email)
       FROM   tbl
       WHERE  date BETWEEN t.date - 2 AND t.date -- period of 3 days
      ) AS dist_emails
FROM   tbl t
WHERE  date BETWEEN '2012-01-01' AND '2012-01-06'  
GROUP  BY 1
ORDER  BY 1; 
```

或者 - 返回指定范围内的*所有日期*，即使当天没有行：

```
SELECT date
     ,(SELECT count(DISTINCT email)
       FROM   tbl
       WHERE  date BETWEEN g.date - 2 AND g.date
      ) AS dist_emails
FROM  (SELECT generate_series(timestamp '2012-01-01'
                            , timestamp '2012-01-06'
                            , interval  '1 day')::date) AS g(date); 
```

*db<>[在这里摆弄](https://dbfiddle.uk/?rdbms=postgres_13&fiddle=2dde16c22f516131bcab25c8198cb961)*

结果：

```
day        | dist_emails
-----------+------------
2012-01-01 | 3
2012-01-02 | 3
2012-01-03 | 3
2012-01-04 | 3
2012-01-05 | 1
2012-01-06 | 2 
```

起初这*听起来*像是[窗口函数](https://www.postgresql.org/docs/current/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS)的工作，但我没有找到定义合适窗口框架的方法。此外，[根据文档](https://www.postgresql.org/docs/current/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS)：

> 聚合窗口函数与普通聚合函数不同，不允许`DISTINCT`或`ORDER BY`在函数参数列表中使用。

所以我用相关的子查询来解决它。我想这是最聪明的方法。

顺便说一句，“在所述日期和 3 天前之间”将是**4**天。你的定义在那里是矛盾的。

稍微短一些，但几天慢一些：

```
SELECT g.date, count(DISTINCT email) AS dist_emails
FROM  (SELECT generate_series(timestamp '2012-01-01'
                            , timestamp '2012-01-06'
                            , interval  '1 day')::date) AS g(date)
LEFT   JOIN tbl t ON t.date BETWEEN g.date - 2 AND g.date
GROUP  BY 1
ORDER  BY 1; 
```

有关的：

*   [在 PostgreSQL 中生成两个日期之间的时间序列](https://stackoverflow.com/questions/14113469/generating-time-series-between-two-dates-in-postgresql/46499873#46499873)
*   [具有时间间隔的行的滚动计数](https://stackoverflow.com/questions/66879705/rolling-count-of-rows-withing-time-interval/66880059#66880059)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-02T03:01:39.443

A`lateral join`对于此类“滑动窗口”需求很有用，如下所示：

```
SELECT
       t.day
     , ljl.dist_emails
FROM   tbl t
LEFT JOIN LATERAL (
        SELECT
               count(DISTINCT email) as dist_emails
        FROM   tbl
        WHERE  day BETWEEN t.day - 2 AND t.day -- period of 3 days
       ) AS ljl ON TRUE
WHERE t.day BETWEEN '2012-01-01' AND '2012-01-06' 
```

请注意，这是 Erwin Brandstetter 先前查询的变体，令我惊讶的是他没有建议，但这些横向连接非常适合这种需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T01:40:26.887

在 sql 服务器中：

```
`select test.date, count(distinct test.email) from test_table as test  where convert(date,test.date) between '2012-01-01' and '2012-05-08' group by test.date` 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T11:52:54.510

您可以始终使用 dateadd 函数，而不是指定日期：

```
test.date > dateadd(dd,-7,getdate()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-10T19:06:20.417

滑动窗口不同计数的示例：

```
SELECT b.day, count(DISTINCT a.user_id)
from glip_production.presences_1d a,
 (SELECT distinct(day), TIMESTAMPADD(day,-6, day) dt_start
  from glip_production.presences_1d t1) b
where a.day >= b.dt_start and a.day <= b.day and b.day > '2017-11-01'
group by b.day 
```

# html - Boxshadow 插图无法从 Photoshop 重新创建

> ID：10544187
> 
> 赞同：0
> 
> 时间：2012-05-11T01:15:33.227
> 
> 标签：html, css

所以，这就是它需要的样子

![在此处输入图像描述](../Images/f6480396f7689fe4436a232077b57b60.png)

您会在中心看到漂亮的白色效果，我尝试重新创建它，但没有成功，这是我的代码：

```
 article .txt:after{
    position:absolute;
    content:'';
    width:50px;
    height:50px;
    top:50%;
    left:35%;
 -webkit-box-shadow: inset 0px 0px 10px rgba(255, 255, 255, 0.1);
    -moz-box-shadow: inset 0px 0px 10px rgba(255, 255, 255, 0.1);
    box-shadow: inset 0px 0px 10px rgba(255, 255, 255, 0.1);
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:27:42.333

您的 CSS 声明中缺少传播半径。也就是说，它应该看起来更像这样（请注意，在每个 box-shadow 定义中都有一个新的“20px”数字）：

```
article .txt:after{
    position:absolute;
    content:'';
    width:50px;
    height:50px;
    top:50%;
    left:35%;
    -webkit-box-shadow: inset 0px 0px 10px 20px rgba(255, 255, 255, 0.1);
    -moz-box-shadow: inset 0px 0px 10px 20px rgba(255, 255, 255, 0.1);
    box-shadow: inset 0px 0px 10px 20px rgba(255, 255, 255, 0.1);
} 
```

我还在 JSFiddle 中做了一个快速模型，你可以在这里看到它：http: [//jsfiddle.net/ZEuZ6/](http://jsfiddle.net/ZEuZ6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T01:30:58.203

从图像上看，你想要的并不是真正的阴影，而是渐变。

关于渐变的一些很好的信息：http: [//davidwalsh.name/css-gradients](http://davidwalsh.name/css-gradients)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T05:31:30.330

如果您要重现的是设备上的白色高光，请尝试使用透明 PNG 来实现效果，并将其绝对放置在设备图像的顶部。

一个例子看起来像这样

```
<figure class="frame">
    <img src="mobile-device.jpg" />
</figure> 
```

CSS：

```
.frame { display: block; position: relative; }
.frame:after {
    display: block;
    content: "";
    background: url('highlight.png');
    width: xx;
    height: yy;
    top: 0; left: 0;
 } 
```

# android - Android可加载内核模块错误：赋值使指针从没有强制转换的整数

> ID：10544188
> 
> 赞同：0
> 
> 时间：2012-05-11T01:15:37.347
> 
> 标签：android, linux-kernel

我的 HTC Sensation XL 有一个 Android LKM，如下所示，它会在调用 sys_open 之前打印一条调试消息。我的操作系统是 Ubuntu 11.10 64 位。[Android Kernel 是从http://www.htcdev.com/devcenter/downloads](http://www.htcdev.com/devcenter/downloads)下载的 runnymede-crc-2.6.35 。

> /*
> * mydebug.c
> * 系统调用 sys_open 调试
> */
> 
> `#include <linux/kernel.h>`
> `#include <linux/module.h>`
> `#include <asm/unistd.h>`
> 
> `asmlinkage ssize_t (*orig_open)(const char *pathname, int flags);`
> 
> `asmlinkage ssize_t hooked_open(const char *pathname, int flags)`
> `{`
> `printk(KERN_INFO "SYS_OPEN: %s\n", pathname);`
> `return orig_open(pathname, flags);`
> `}`
> 
> `static int __init root_start(void)`
> `{`
> `unsigned long sys_addr = 0xc003b104; /* System.map */`
> `unsigned long *sys_call_table= (unsigned long *)sys_addr;`
> 
> `orig_open = sys_call_table[__NR_open];`
> `sys_call_table[__NR_open] = hooked_open;`
> `return 0;`
> `}`
> 
> `static void __exit root_stop(void)`
> {
> 
> `unsigned long sys_addr = 0xc003b104;`
> `unsigned long *sys_call_table= (unsigned long *)sys_addr;`
> 
> `sys_call_table[__NR_open] = &orig_open;`
> `}`
> 
> `module_init(root_start);`
> `module_exit(root_stop);`

* * *

但它在编译过程中显示错误，

> `make -C /home/scott/runnymede-crc-2.6.35/ M=$(PWD) ARCH=arm CROSS_COMPILE=~/android-ndk-r7b/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/arm-linux-androideabi- modules`
> `make[1]: Entering directory '/home/scott/runnymede-crc-2.6.35'`
> `CC [M] /home/scott/workspace/debugkit/mydebug.o`
> `cc1: warnings being treated as errors`
> `/home/scott/workspace/debugkit/mydebug.c: In function 'root_start':`
> `/home/scott/workspace/debugkit/mydebug.c:23: error: assignment makes pointer from integer without a cast`
> `/home/scott/workspace/debugkit/mydebug.c:24: error: assignment makes integer from pointer without a cast`
> `/home/scott/workspace/debugkit/mydebug.c: In function 'root_stop':`
> `/home/scott/workspace/debugkit/mydebug.c:34: error: assignment makes integer from pointer without a cast`
> `make[2]: [/home/scott/workspace/debugkit/mydebug.o] Error 1`
> `make[1]: [_module_/home/scott/workspace/debugkit] Error 2`
> `make[1]: Leaving directory '/home/scott/runnymede-crc-2.6.35'`
> `make: [default] Error 2`

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T05:53:46.643

您定义`sys_call_table`为指向无符号长整数的指针，然后执行`sys_call_table[1234]`. 结果类型是无符号长整数。您尝试为此分配一个指针。

这正是编译器告诉你的。重新定义类型`sys_call_table`或强制转换分配。

请注意，替换系统调用是非常不受欢迎的，尤其是在内核模块中。您必须做一些愚蠢的事情，例如使用来自 system.map 的硬编码地址，这一事实应该被视为您不应该首先这样做的暗示。

# hibernate - 容器管理持久性 (EJB2.1) 中的 Oracle 死锁问题

> ID：10544189
> 
> 赞同：1
> 
> 时间：2012-05-11T01:15:41.140
> 
> 标签：hibernate, ejb, deadlock

这是我的第一篇文章，并且偶尔会访问任何与 Java 相关的问题。这是一个非常有用的网站，老年人非常乐于帮助他人。

环境：Oracle、Jboss、EJB 2、休眠、MDB、MQ、CMP

我们的应用程序每天随机面临一次/两次死锁问题，所以我打开了休眠跟踪。请是高级代码

```
@Stateless
public class SaveData() {

@TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)
methodA(){

    Method B();
    em.persist(obj1);

    Method C();
    Method D();

    em.flush();
}

methodB(){

}

methodC(){

  em.persist(obj2);
}

methodD(){
  em.persist(obj3);
} 
```

} // bean结束

由于这个问题只发生在生产中，没有其他地方发生，我无法重新创建它。因此，我将添加 TransactionAttributeType.REQUIRES_NEW 以将其保留在同一事务中，现在以下是我的问题：

1.  事务的开始是 MethodB() 和结束是 MethodD() 还是会有任何内部新事务？

2.  如何检查事务 ID 或日志消息以了解事务的开始和结束，以确保一切都在一个事务中发生？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T08:13:38.503

1.  事务的开始是 MethodB() 和结束是 MethodD() 还是会有任何内部新事务？***不，事务从 A 开始，也从 A 结束，因为它在内部调用其他方法。此外，您还没有明确指定任何事务属性，因此默认值为`Required`. 因此，同一事务将通过其他方法传播。***

2.  How do I check the transaction id or log message for start & end of the transaction to make sure everything is happening in one transaction?. ***In case of CMT not sure how to verify that, but if you want to monitor & manage it explicitly, you can have BMT. Then you will be able to start & end transaction manually.***

# android - 如何将类型保留在 proguard 中，但不保留与特定名称或模式匹配的类型？

> ID：10544196
> 
> 赞同：0
> 
> 时间：2012-05-11T01:16:47.963
> 
> 标签：android, proguard

我想指定类似的东西

```
 -keep class {
    public static int *;  // unless the constant name is 'ABC' perhaps !ABC   ??????
     } 
```

方法名称等也是如此。在 Proguard 中有没有这样做？所以基本上我想要一个 -keep 规则，但不包括与特定字符串或正则表达式匹配的元素。这可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:42:27.947

> 这可以做到吗？

我想，答案是肯定的。

[Proguard Manual](http://proguard.sourceforge.net/manual/usage.html#classspecification)说：“类名实际上可以是逗号分隔的类名列表，带有可选的 ! 否定符，就像文件名过滤器一样。”

# java - 从“Last,First MI”更改名称格式。到 Java 中的“First MI. Last”

> ID：10544197
> 
> 赞同：0
> 
> 时间：2012-05-11T01:16:55.887
> 
> 标签：java, format

我正在尝试在程序从非结构化文本中检索它们后给我的名称，并以用户指定的格式显示它们“First MI. Last”或“Last, First MI”。有任何想法吗？到目前为止，它会检查字符串中是否存在逗号。如果是这样，我想切换字符串中单词的顺序并删除逗号，如果有一个中间首字母并且它后面不包含句点，我想添加一个。

```
if (entity instanceof Entity) {
    // if so, cast it to a variable
    Entity ent = (Entity) entity;

    SName name = ent.getName();
    String nameStr = name.getString();
    String newName = "";

    // Now you have the name to mess with
    // NOW, this is where i need help
    if (choiceStr.equals("First MI. Last")) {
        String formattedName = WordUtils
                .capitalizeFully(nameStr);
        for (int i = 0; i < formattedName.length(); i++) {

            if (formattedName.charAt(i) != ',') {
                newName += formattedName.charAt(i);
            }
        }
    }
    name.setString(newName);
    network.updateConcept(ent); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:34:41.517

使用正则表达式和`String.replaceAll`：

```
"Obama, Barack H.".replace("(\\w+), (\\w+) (\\w\\.)", "$2 $3 $1") 
```

结果是`Barack H. Obama`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T01:29:46.167

这会更容易`substring`。这假定格式有效（您必须检查）。

```
//Separate the names
String newName;
String lastName = name.substring(0, name.indexOf(","));
String firstName = name.substring(name.indexOf(",")+1);

//Check for a space indicating a middle Name
//Check to see if the middle name already has the period if not add it
if(firstName.trim().contains(" ") && !firstName.contains(".")) {
   firstName += ".";
}

newName = firstName + " " + lastName;

//Set the name to whatever you're using 
```

请注意，如果名称允许包含，这将不起作用`"," " " or "."`

# javascript - 如何 .hide() 类中的单个 div

> ID：10544206
> 
> 赞同：1
> 
> 时间：2012-05-11T01:18:38.147
> 
> 标签：javascript, jquery

我有一组 div，它们在相同的类名下指定，并且没有 id。鉴于这种情况，我如何使用 Jquery 的`.hide()`方法来仅隐藏被单击的 div，而不是整个类，而不必为每个 div 指定一个 id？

```
<div class="div"><p>Some placeholder text </p> </div>
<div class="div"><p>Some more placeholder text </p> </div>
<div class="div"><p>And even placeholder text </p> </div>

$(".div").click (function(){  
    $(".div").hide(); 
    }); 
```

上面的脚本将隐藏所有具有“div”类的 div，但我们只想隐藏被点击的 div，而不是整个类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:19:49.020

这就是您要查找的内容：

```
$(".div").click (function(){  
    $(this).hide(); 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:20:01.967

您可以通过在事件处理程序中使用来引用`jQuery`对象中被单击的元素，如下所示：`$(this)`

```
$(".div").click (function(){  
    $(this).hide(); 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T01:20:18.800

```
$(function(){
  $(".div").click(function(){
    $(this).hide();
  });
}); 
```

`$(this)`将返回当前调用的项目。你可以用它来隐藏

工作示例[http://jsfiddle.net/sz4h2/](http://jsfiddle.net/sz4h2/)

# jquery - IE 8 双击 jquery 没有任何意义，也不会触发 click()

> ID：10544207
> 
> 赞同：0
> 
> 时间：2012-05-11T01:19:01.347
> 
> 标签：jquery, events, internet-explorer-8, click, cross-browser

我有 IE 8，我使用 .click(function(){}); 一旦我单击我的 li，它就会完美运行并触发事件。但是，如果我在短时间内单击两次，它只会触发一次。我想 IE 8 认为它是“双击” - 如果有这样的事件很好，但我不明白为什么它实际上取消了我的点击功能......

有什么办法可以解决这个问题吗？...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:21:47.520

您可以让 jquery 的 dblclick（双击）事件触发单击事件。如果这不起作用，则表明它不是双击事件问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T19:36:41.503

```
var okToClick = true;
$('ul li.arr_d, ul li.arr_u').click(OnDownClick).dblclick(OnDownClick);
function OnDownClick() {
    if (okToClick) {
        okToClick = false;
    //do the stuff here :)
    }
} 
```

# android - 有条件的哔声不起作用

> ID：10544213
> 
> 赞同：0
> 
> 时间：2012-05-11T01:20:12.990
> 
> 标签：android, conditional, beep

我正在为一个应用程序编写一个代码，当当前速度超过用户设置的警告速度限制时，它会“发出哔哔声”。下面显示的代码写在里面`onLocationChanged()`，但由于某种逻辑原因，它只发出一次哔声然后停止，这告诉我它通过了一次循环，之后过去时间和 curTime 失去了轨道，并且 if 条件在逻辑上不为真并因此跳过循环。我想要延迟 5 秒的原因是在哔哔声之间有足够的时间延迟并且不让它们重叠。我在活动一开始就用 0 初始化了 pasTime。对此修复的任何建议表示赞赏。此外`curTime = c.getTimeInMillis()`，每次位置侦听器中的位置发生变化。

```
if (Activity2.mySpeedmph > mySpeed_max & curTime > pastTime+5000)
{
    player = MediaPlayer.create(Activity2.this, R.raw.beep);  
    player.setLooping(false);     
    player.setVolume(100,100);         
    player.start();    
    pastTime = curTime;
} 
```

这是一个非常具体的问题，我找不到与此相关的任何内容。我知道这对专家来说是一个非常简单的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:29:37.350

在这里没有居高临下的意思（这个答案听起来像您的经典 IT 帮助台“您是否尝试过将其关闭再打开？”），只是涵盖所有基础。

你在更新`curTime`吗？您所描述的是您会看到的内容，如果`pastTime`最初设置在过去很长时间，并且在循环之外`curTime`设置*一次并且没有更新。*

如果做不到这一点，您可能需要对该`if`语句中涉及的变量（在 之前`if`）进行一些样本，以查看它们设置的值。

或者，预先强制其中一个条件为真（例如 with`Activity.mySpeedmph = mySpeed_max + 1;`以便检查*另一个*条件的操作。

# sql - java.sql.SQLException: could not use local transaction commit in a global transaction的解决方法

> ID：10544218
> 
> 赞同：0
> 
> 时间：2012-05-11T01:20:34.427
> 
> 标签：sql, jdbc, weblogic

我在 Weblogic 10.3 集群环境中运行 J2EE MDB。

在代码中的一种方法中，我创建了一个 JDBC 连接并关闭了自动提交。通过启用 XA 的数据源建立与数据库的连接。关闭自动提交的原因是因为我使用的是临时表。

当我完成临时表和其他 SQL 查询时，我提交事务并重新打开自动提交。在大多数情况下，这不是问题，但是在执行该方法时我收到了以下异常，该异常发生在我发出提交的代码行中。

不知道为什么我收到了我只调用单个数据库的方法，我想知道是不是因为数据源启用了 XA？任何关于为什么会发生这种异常以及为什么它有时只发生的见解将不胜感激

```
java.sql.SQLException: could not use local transaction commit in a global transaction
    at oracle.jdbc.driver.SQLStateMapping.newSQLException(SQLStateMapping.java:70)
    at oracle.jdbc.driver.DatabaseError.newSQLException(DatabaseError.java:112)
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:173)
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:229)
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:403)
    at oracle.jdbc.driver.PhysicalConnection.disallowGlobalTxnMode(PhysicalConnection.java:6139)
    at oracle.jdbc.driver.PhysicalConnection.commit(PhysicalConnection.java:3320)
    at oracle.jdbc.driver.PhysicalConnection.commit(PhysicalConnection.java:3357)
    at oracle.jdbc.OracleConnectionWrapper.commit(OracleConnectionWrapper.java:130)
    at weblogic.jdbc.wrapper.XAConnection.commit(XAConnection.java:844)
    at weblogic.jdbc.wrapper.JTAConnection.commit(JTAConnection.java:326)
    at com.myPackage.myApp.myDBCaller.tempTableMethod(myDBCaller.java:390)
    at com.myPackage.myApp.myDBCaller.start(myDBCaller.java:153)
    at com.myPackage.myApp.myDBCaller.onMessage(myDBCaller.java:117)
    at sun.reflect.GeneratedMethodAccessor1683.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:599)
    at com.bea.core.repackaged.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:281)
    at com.bea.core.repackaged.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:187)
    at com.bea.core.repackaged.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:154)
    at com.bea.core.repackaged.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:126)
    at com.bea.core.repackaged.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:114)
    at com.bea.core.repackaged.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:176)
    at com.bea.core.repackaged.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:89)
    at com.bea.core.repackaged.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:176)
    at com.bea.core.repackaged.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:126)
    at com.bea.core.repackaged.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:114)
    at com.bea.core.repackaged.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:176)
    at com.bea.core.repackaged.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:210)
    at $Proxy228.onMessage(Unknown Source)
    at weblogic.ejb.container.internal.MDListener.execute(MDListener.java:518)
    at weblogic.ejb.container.internal.MDListener.transactionalOnMessage(MDListener.java:423)
    at weblogic.ejb.container.internal.MDListener.onMessage(MDListener.java:325)
    at weblogic.jms.client.JMSSession.onMessage(JMSSession.java:4547)
    at weblogic.jms.client.JMSSession.execute(JMSSession.java:4233)
    at weblogic.jms.client.JMSSession.executeMessage(JMSSession.java:3709)
    at weblogic.jms.client.JMSSession.access$000(JMSSession.java:114)
    at weblogic.jms.client.JMSSession$UseForRunnable.run(JMSSession.java:5058)
    at weblogic.work.SelfTuningWorkManagerImpl$WorkAdapterImpl.run(SelfTuningWorkManagerImpl.java:516)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:173) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-21T06:09:49.157

尝试设置属性

> `<property name="AutomaticEnlistingEnabled" value="false"/>`

xaDatasource 的。

# facebook - preg_match Facebook 照片 URL

> ID：10544219
> 
> 赞同：0
> 
> 时间：2012-05-11T01:20:37.147
> 
> 标签：facebook, preg-match

我真的很喜欢 preg_match 的东西。

我真的希望有人能帮助我。

我想检查 url 中的粗体文本 this -> [http://a2](http://a2)。**sphotos.ak.fbcdn.net** /*somechars.jpg

我有一个表格，用户可以在其中发布图片。但我只希望他们可以从 Facebook Foto 发布图片。我已经检查了链接，如果它是 .jpg/.jpeg/png。

```
$is_pic = (bool) preg_match('/\.(jpe?g|png|gif|w?bmp|e)\z/i', $path_parse);
$file_type= ".jpeg, .jpg, .png";
if ($is_pic == true && strcmp ($pathparts['filename'], $file_type)) {
....} 
```

有人可以帮我提供 Facebook 网址吗？我真的很努力，但我失败了:(我需要 preg_match URL，如果它真的来自域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:49:31.890

```
$path_parse = "http://a2.sphotos.ak.fbcdn.net/hphotos-ak-prn1/p480x480/524936_353401681385716_243355085723710_939664_1788013879_n.jpg";

$is_pic = (bool) preg_match('/sphotos\.ak\.fbcdn\.net/i', $path_parse);

if ($is_pic) {
    echo("it matched");
} 
```

# javascript - 正确设置事件的目标动作

> ID：10544221
> 
> 赞同：1
> 
> 时间：2012-05-11T01:20:56.557
> 
> 标签：javascript, objective-c

我想知道如何正确设置事件的目标操作？在javascript中的事件处理函数中，我有

```
 alert(e.target.getAttribute('action')); // Outputs correctly
    alert(newAction); // Outputs newAction correctly
    e.target.setAttribute('action',newAction); // Seems to be the problem
    alert(e.target.action); // INCORRECT: Has some url prefixed to newAction 
```

新动作警报显示一些 url+newAction，但我只想要 newAction。对此的任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:25:50.983

尝试`alert(e.target.getAttribute('action'))`

# objective-c - ParseKit 版本。74 不工作？

> ID：10544226
> 
> 赞同：2
> 
> 时间：2012-05-11T01:21:49.893
> 
> 标签：objective-c, parsekit

我使用命令 svn checkout [http://todparsekit.googlecode.com/svn/trunk/](http://todparsekit.googlecode.com/svn/trunk/) todparsekit-read-only 版本号是 74 下载了 ParseKit。我尝试运行 DemoApp。应用程序启动。当我按下 Parse 按钮​​时，没有显示任何树。将 USE_TRACK 设置为 1 后，它显示的日志如下

```
After : [ 42
Expected : CaseInsensitiveLiteral ]
Found : e-12 
```

在我看来，“数字”的处理方式已经改变。当我尝试在自己的项目中使用相同的 ParseKit 代码时，ParseKit 在将“0.8”解析为 Number 时抛出异常。

我可能会遗漏一些东西。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:40:05.003

ParseKit 的开发者在这里。感谢您的提醒。我已经解决了这个问题。

问题是：

新`-[PKNumberState allowsFloatingPoint]`方法应该默认为`YES`，但是当通过 ParserFactory（一种语法）创建解析器时，它默认为`NO`.

该修复程序已作为 rev 78 签入。

# java - 我的泛型类型转换有什么问题？

> ID：10544229
> 
> 赞同：2
> 
> 时间：2012-05-11T01:22:26.117
> 
> 标签：java, generics

我有一个`Student`类和一个`StudentPool`定义如下的类：

```
public class Student {
    public Student copy () {
        return new Student();
    } 
} 
```

和

```
public class StudentPool<T extends Student> {
    public T copyStudent(T t) {
        return t.copy();
    }
} 
```

因此，该`copyStudent`方法无法编译，我必须使用不安全的类型转换。我不明白为什么 Java 确实认为这是非法的？

**编辑：** user845279、lcfseth 和 Bohemian：我认为对 Student 的以下修订可能会导致类似的情况，将父类转换为其子类，但此版本可以通过编译：

```
public class Student {
    public <T extends Student> T copy() {
       T rv = null; 
       return rv;
    } 
} 
```

**编辑：** 忘记上面的代码：`rv`可以`null`或不安全地铸造。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T01:27:49.847

假设您有一个`SmartStudent`扩展的类`Student`和一个`StudentPool<SmartStudent>`. 在这种情况下`copyStudent`，应该采用 a`SmartStudent`并返回 a `SmartStudent`，但是 in 中的实现`Student`并没有这样做——它只返回一个普通的`Student`实例。

**编辑：**

为了实现你想要的模式，你可以给`Student`它的所有子类一个[复制构造函数](http://www.javapractices.com/topic/TopicAction.do?Id=12)：

```
public class Student {
    public Student(Student other) {
        //copy other's Student fields to this instance
    } 
}

public class SmartStudent extends Student {
    public SmartStudent(SmartStudent other) {
        super(other);
        //copy other's SmartStudent fields to this instance
    }
} 
```

并`StudentPool`抽象：

```
public abstract class AbstractStudentPool<T extends Student> {
    public T copyStudent(T original);
} 
```

每个`AbstractStudentPool`实现都会调用适当的复制构造函数：

```
public class SmartStudentPool extends AbstractStudentPool<SmartStudent> {
    @Override
    public SmartStudent copyStudent(SmartStudent original) {
        return new SmartStudent(original);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T01:35:19.447

问题是，虽然从中`Student`返回，子类*也会*返回......而不是它们自己的类型。`Student``copy()`*`Student`*

 *这是解决您的问题的方法：

```
public static interface Copyable<T> {
    public T copy();
}

public static class Student implements Copyable<Student> {
    @Override
    public Student copy() {
        return new Student();
    }
}

public static class StudentPool<T extends Student> {
    public T copyStudent(Copyable<T> t) {
        return t.copy();
    }
} 
```

作为旁注，您似乎在这里不需要泛型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T01:28:45.413

您不能将父类转换为其子类。隐式强制转换只能反其道而行之。即使使用显式类型转换，这也极有可能产生运行时错误。*

# php - 如何通过脚本将一组文件/文件夹从 linux 服务器传输到另一个服务器？

> ID：10544230
> 
> 赞同：-1
> 
> 时间：2012-05-11T01:22:30.963
> 
> 标签：php, web-services, ftp, ssh

我正在创建一个 php 脚本来每天备份我的网站，备份到我的另一个 linux 服务器，但是我如何压缩所有文件并通过脚本发送到另一个 linux 服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:56:54.520

一种可能的解决方案（在 bash 中）。

```
BACKUP_SERVER_PATH=remote_user@remote_server:/remote/backup/path/
SITE_ROOT=/path/to/your/site/

cd "$SITE_ROOT"
now=$(date +%Y%m%d%H%M)
tar -cvzf /tmp/yoursite.$now.tar.gz .
scp /tmp/yoursite.$now.tar.gz "$BACKUP_SERVER_PATH" 
```

一些额外的东西要考虑到权限（对 docroot 的读取访问）和对远程服务器的 ssh 访问（对于 scp）。

请注意，确实有很多方法可以做到这一点。另一种方法是，如果您不介意存储站点的未压缩版本，则可以使用 rsync。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T08:04:55.013

Timothée Groleau 提供的答案应该有效，但我更喜欢反过来：从我的备份机器（一个有大量可用存储空间的服务器）启动一个进程来备份所有其他服务器。

在我的环境中，我使用列出所有服务器、每个服务器的有效用户和备份路径的配置文件：

*/usr/local/etc/backupservers.conf*

```
192.168.44.34 userfoo /var/www/foosites
192.168.44.35 userbar /var/www/barsites 
```

*/usr/local/sbin/backupservers*

```
#!/bin/sh
CONFFILE=/usr/local/etc/backupservers.conf
SSH=`which ssh`

if [ ! -r "$CONFFILE" ]
then
  echo "$CONFFILE not readable" >&2
  exit 1
fi

if [ ! -w "/var/backups" ]
then
  echo "/var/backups is not writable" >&2
  exit 1
fi

while read host user path
do
  file="/var/backups/`date +%Y-%m-%d`.$host.$user.tar.bz2"
  touch $file
  chmod 600 $file
  ssh $user@$host tar jc $path > $file
done 
```

要使其正常工作并且无需为要备份的每台服务器输入密码，您需要交换 SSH 密钥（关于如何执行此操作，stackoverflow 上有很多问题/答案）。

最后一步是将其添加到 cron 以每晚启动该过程：

*/etc/crontab*

```
0 2 * * * backupuser /usr/local/sbin/backupservers 
```

# java - Eclipse Hibernate 工具的问题

> ID：10544232
> 
> 赞同：0
> 
> 时间：2012-05-11T01:23:26.740
> 
> 标签：java, eclipse, hibernate, hibernate-tools

我正在尝试使用 Hibernate Tools Eclipse Add-On 中的 Hibernate Code Generation 功能。它给了我以下错误：

org.hibernate.InvalidMappingException：无法从资源 Alert.hbm.xml 解析映射文档 无法从资源 Alert.hbm.xml 解析映射文档寻找属性时：alertId org.hibernate.MappingException：找不到类警报 寻找属性时：alertId 类警报未找到 寻找属性时：alertId java.lang.ClassNotFoundException：警报警报

它没有找到类 Alert.java 但我认为代码生成器（因此得名......）应该为我生成所有休眠类。

将 eclipse Indigo 与 Hibernate Tools 3.4.x 一起使用。

这是我的 hibernate.cfg.xml：

```
<!DOCTYPE hibernate-configuration PUBLIC
        "-//休眠/休眠配置 DTD 3.0//EN"
        “http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd”>

<休眠配置>
    <会话工厂>
        <!-- 数据库连接设置 -->
        <property name="connection.driver_class">
            com.mysql.jdbc.Driver
        </属性>
        <property name="connection.url">
            jdbc:mysql://localhost:3306/findata?tcpKeepAlive=true
        </属性>
        <property name="connection.username">根</property>
        <property name="connection.password">madmax1.</property>

        <property name="connection.pool_size">2</property>
        <property name="show_sql">真</property>
        <属性名称="方言">
            org.hibernate.dialect.mysql方言
        </属性>
        <property name="current_session_context_class">线程</property>
        <property name="cache.provider_class">
            org.hibernate.cache.NoCacheProvider
        </属性>

        <映射资源="Alert.hbm.xml" />
        <映射资源="Entity.hbm.xml" />
        <映射资源="FactData.hbm.xml" />
        <映射资源="TimeEvent.hbm.xml" />
        <映射资源="User.hbm.xml" />
        <映射资源="AlertTarget.hbm.xml" />
        <mapping resource="LogAlert.hbm.xml" />
    </会话工厂>
</hibernate-configuration>

```

这是 Alert.hbm.xml：

```
<?xml 版本="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate 映射 DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<休眠映射>
    <类名=“警报”表=“警报”>
        <id name="alertId" column="id">
            <generator class="assigned"/>
        </id>
        <property name="limitValue" column="limit_value" type="decimal" />
        <!-- unique=true 属性使多对一成为一对一关系 -->
        <多对一名称="alertEntity"
            类=“实体”列=“实体ID”
            not-null="true" 级联="all" unique="true"/>
        <set name="alert_targets" table="alerts_alert_targets" cascade="all">
            <key column="alert_id" />
            <多对多列="alert_target_id"
                类="警报目标" />   
        </set>
   </class>
</hibernate-mapping>

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T08:08:59.553

奇怪的是它正在寻找要生成的类。

我将检查 hibernate-reverse.xml 文件并检查它是否没有可能导致此问题的其他属性。

或者，在生成过程中，尝试设置 hibernate-revenge.xml 和 hibernate.cfg.xml 而不是使用现有的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:34:10.250

原因是没有为 Alert.hbm.xml 中的“id”属性指定“类型”。

# ruby-on-rails - phusion 乘客没有看到环境变量？

> ID：10544233
> 
> 赞同：8
> 
> 时间：2012-05-11T01:23:42.510
> 
> 标签：ruby-on-rails, ubuntu, nginx, passenger

我们正在为我们的 rails 3.0x 应用程序运行带有 Nginx + Phusion Passenger 的 ubuntu 服务器。

我在测试机器上的 /etc/environment 中设置了一个环境变量：

```
MC_TEST=true 
```

如果我运行控制台（bundle exec rails c）并输出 ENV["MC_TEST"] 我看到'true'。但是，如果我将相同的代码放在页面上（ <%= ENV["MC_TEST"] %> ），它什么也看不到。该变量不存在。

这让我产生疑问：

1 - 使用 nginx（不是 apache SetEnv）将环境变量导入乘客的正确方法是什么？

2 - 为什么Passenger没有合适的环境？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-25T00:08:45.903

乘客融合 v4+ 可以直接从 bashrc 文件中读取环境变量。确保 bashrc 位于执行乘客进程的用户的主文件夹中（在我的情况下，它是 ubuntu，用于 ec2 linux 和 nginx）

这是详细介绍 bashrc的[文档](https://www.phusionpassenger.com/library/indepth/environment_variables.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T06:31:44.223

在 ubuntu 上使用带有 nginx 和 nginx 初始化脚本的乘客时，我遇到了同样的问题。原因是我使用 sudo service nginx restart（由 init 脚本安装）启动 nginx 并且
它是由 root 运行的，并且 root 没有获取您的登录用户环境变量。有两种解决方案。一种是手动运行 nginx。

```
sudo service nginx stop
sudo -E /path/to/your/nginx 
```

一种是将 env 添加到您的 nginx 初始化脚本中

```
export MC_TEST=true 
```

后一种解决方案有点丑陋，但它有效。而且我认为更好的方法是找到一个配置来告诉初始化脚本保留登录用户环境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-12T10:11:06.770

我得到了另一个丑陋的解决方案。

```
env_file = '/etc/environment'
if File.exist?(env_file)
  text = File.open(env_file).read
  text.each_line do |line|
    key, val = line.split('=', 2)
    ENV[key] = val.strip
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-08T05:57:39.973

使用 nginx，您可以对其使用变量 Passenger_env_var。请参阅下面的示例

```
passenger_env_var GEM_HOME /home/foo/.rbenv/rubygems;  
passenger_env_var GEM_PATH /home/foo/.rbenv/rubygems/gems; 
```

所以对于你的情况

```
passenger_env_var MC_TEST true; 
```

# algorithm - 递归关系 T(n) = T(n^(1/2)) + T(nn^(1/2)) + n

> ID：10544241
> 
> 赞同：2
> 
> 时间：2012-05-11T01:25:41.097
> 
> 标签：algorithm, asymptotic-complexity, recurrence

我和我的朋友发现了这个问题，我们无法弄清楚如何解决它。它不是微不足道的，标准的替换方法并没有真正起作用（或者我们不能正确应用它）这应该是快速排序与等级问题的枢轴。

以下是重现：

T(n) = T(n^(1/2)) + T(nn^(1/2)) + n

任何帮助将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:51:58.193

首先放轻松：

T(n) = T(nn^(1/2)) + n，迭代次数为 n^(1/2)，在每次迭代中，您将有 nk *sqrt(n) 时间复杂度，因此总时间复杂度为: ∑nk* sqrt(n) for 0<=k<=sqrt(n)，即 n^(3/2)。

现在解决你自己的问题：

```
T(n) = T(n^(1/2))+T(n-n^(1/2)) + n 
```

再次计算到达零或 1 的步数：第一部分 `T(n^(1/2)) 花费 O(log log n) 时间，第二部分花费 O(sqrt(n)) 次到达零或 1（请参阅我对相关问题的[回答](https://stackoverflow.com/questions/9550455/reccurrence-tn-tn1-2-1/9550494#9550494)），因此第二部分主导第一部分，而且在第二部分的每次迭代中，时间复杂度都会导致 sqrt(n) 额外项目，这不会影响第一部分的时间复杂度（n- sqrt(n))，所以你的总运行时间是 n*sqrt(n)。

# android - 从 SoapObject (kSOAP2) 获取布尔值

> ID：10544243
> 
> 赞同：2
> 
> 时间：2012-05-11T01:26:00.057
> 
> 标签：android, boolean, ksoap2

我正在尝试从 SoapObject 中获取布尔值，我已经从使用 Android 中的 kSOAP2 的 Web 服务器的响应中获得...

我已将 Web 调用的响应保存在 SoapObject 中：

```
SoapObject sResult = (SoapObject)envelope.bodyIn; 
```

我正在遍历响应并获取值

```
SoapObject soapresults = (SoapObject)sResult.getProperty(0);

for (int i = 0; i < count; i++)
{
    SoapObject mail = (SoapObject)soapresults.getProperty(i);

    /*Getting the values here*/   
} 
```

邮件 SoapObject 将与此类似：

> MessageInstance=anyType{AuthorName=Børnehaven; CreatedAtUtc=2012-04-10T18:30:00; 编号=631；MessageBody=Husk i morgen; 收件人=anyType{FullName=null; id=2104535421；读=真；ReadAtUtc=2012-04-10T18:30:00; }; };

我无法获取的唯一值是“IsRead”值，我想将其存储为布尔值......

我尝试了几件事：

```
(Boolean)mail.getProperty("IsRead");
((Boolean) mail.getProperty("IsRead")).booleanValue(); 
```

但我不断得到：

> W/System.err(1283)：java.lang.RuntimeException：非法属性：IsRead

获得它的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T12:27:56.137

试试这个代码片段：

```
SoapObject soRecipient = (SoapObject) mail.getProperty("Recipient");

boolean isRead = Boolean.parseBoolean(soRecipient.getPropertyAsString("IsRead"));
String fullName = soRecipient.getPropertyAsString("FullName");
String id = soRecipient.getPropertyAsString("Id");
String readAtUtc = soRecipient.getPropertyAsString("ReadAtUtc"); 
```

# c# - WebMatrix DynamicRecord - 在不知道所选表的任何列名的情况下获取列值

> ID：10544245
> 
> 赞同：2
> 
> 时间：2012-05-11T01:26:34.150
> 
> 标签：c#

我有件事要问。我正在使用 Razor 引擎

`var data = db.Querry(selectStatemnet)`-> 这会返回一组数据。

使用这个：

`foreach ( var row in data )`-> 我得到一排

这是我的问题：

`@row.columnName`-> 返回该列的值（如果我知道表中的所有列名都被选中）

那么我该怎么做：

`var/string myColumnName = columnName`-> 因为我不知道所有的列名，所以我必须从其他地方获取它 -> 我必须这样做。我不想使用 WebGrid，因为我不知道如何控制它。

我想要这个：

```
@row.myColumnName 
```

我试过了，但`@row.myColumnName`没有做我想做的事，它检查并说没有 myColumnName 列。这就像我不能这样做。我必须知道所有列名？

我也尝试过：`@row.@myColumName`-> 这确实返回如下内容：WebMatrix.DynamicRecord.mycolumnvalue -> 在这种情况下，程序只是`ToString()`一切。

我不想使用 WEBGRID，因为我控制较少。

那我该怎么办？

# xcode - 分发内部 iPad 应用程序现在使用 Xcode 4.3.2 (4E2002) 在 Lion 中生成代码签名错误

> ID：10544250
> 
> 赞同：1
> 
> 时间：2012-05-11T01:27:33.673
> 
> 标签：xcode, osx-lion

将我们的 Jenkins CI Mac mini 升级到 Lion 和 Xcode 4.3.2 (4E2002) 后，我们现在收到一个

> 来自代码签名的无法识别状态 -67068

在我们升级到 Lion 和新的 Xcode 之前，过去的代码签名工作得很好。现在我们所有的开发人员都在使用 Lion 和新版本的 Xcode，我们不得不更新我们的 CI 框。任何帮助将不胜感激。

5 月 10 日 18:17:49 未知已安装 [70]：来自协同设计库的无法识别状态 -67068

5 月 10 日 18:17:49 未知已安装 [70]：00281000 verify_signer_identity：无法复制验证签名：-402620415

5 月 10 日 18:17:49 未知已安装 [70]：00281000 preflight_application_install：无法在 /var/tmp/install_staging.aKaDJC/foo_extracted/Payload/Test.app 验证可执行文件

5 月 10 日 18:17:49 未知已安装 [70]：00281000 install_application：无法预检应用程序安装

5 月 10 日 18:17:49 未知 com.apple.itunesstored[110]：MobileInstallationInstall：失败并显示 -1

5 月 10 日 18:17:50 未知已安装 [70]：00281000 handle_install：API 失败

5 月 10 日 18:17:50 未知已安装 [70]：00281000 send_message：未能发送 71 字节的马赫消息：10000003

5 月 10 日 18:17:50 未知已安装 [70]：00281000 send_error：无法向客户端发送错误响应

5 月 10 日 18:18:18 未知异形[65]：（注）异形：空闲。

5 月 10 日 18:18:18 未知配置文件 [65] ：（注）配置文件：服务停止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T04:36:53.933

感谢 ThomasW，我能够在 Google 上搜索“无法在磁盘上找到代码对象”，并找到了这篇[文章](http://pennysmalls.com/cannot-find-code-object-on-disk)。

# .net - 如何捕获使用 tableadapter 插入的记录以避免记录重复？

> ID：10544251
> 
> 赞同：1
> 
> 时间：2012-05-11T01:27:35.127
> 
> 标签：.net, vb.net

这是我使用的表格适配器。现在在这段代码中，我想捕获数据库中是否存在用户名。我怎样才能做到这一点？我是 tableadapter 的新手，所以我很难解决这个问题。

```
 TblGradesUserTableAdapter1.Insert(txtUsername.Text, txtPassword.Text, userType) 
```

请帮我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T08:16:25.933

您可以在同一个表适配器中添加一个新查询，然后`SELECT count`对于某个用户名，它将返回用户名的计数

例如，您可以这样做

```
Dim n as int = TblGradesUserTableAdapter1.CheckUserName(txtUsername.Text)

If n = 0 then
// insert the record
Else
//messagebox the duplicate
End if 
```

# xpages - 重复控件内的重复控件：哈希图似乎被覆盖

> ID：10544252
> 
> 赞同：1
> 
> 时间：2012-05-11T01:27:36.863
> 
> 标签：xpages

我有一个外部重复控件，将它的集合作为哈希图（变量名称是 hmOuterCollection）。在这个重复控件内部还有另一个重复控件，它也将它的集合作为哈希图（变量名称是 hmInnerCollection）。内部重复控件集合基于外部重复条目的键。发生的情况是，当我单击外部重复条目时，内部重复控制条目似乎覆盖了以前的条目。

例如，考虑以下

**巴塞罗那**（外部进入，点击第一）
梅西哈维 ·普约尔
曼联**（**外部进入，点击第二） 鲁尼， xxx**皇家马德里**（外部进入，点击第三） 罗纳尔多· 卡卡

 ****在我扩展所有这些足球队后，我返回并单击名为梅西的球员。它在服务器控制台上打印名字 Ronaldo。如果我单击名称 Xavi，它会打印 Kaka。

我只是想不通这里发生了什么。我也尝试了“repeatControls”和“removeRepeat”属性。没运气。这是java hashmap缓存还是重复控制行为有问题。

如果有人有任何想法，请告诉我。

这是 XPage 源

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view xmlns:xp="http://www.ibm.com/xsp/core">
<xp:this.resources>
    <xp:script src="/xpTestCacheIssue.jss" clientSide="false"></xp:script>
</xp:this.resources>
<xp:repeat id="repeat1" rows="30" value="#{javascript:getTeams()}"
    var="entryTeam">
    <xp:panel>
        <xp:link escape="true"
            text="#{javascript:entryTeam.getValue()}" id="lnkTeam">
            <xp:eventHandler event="onclick" submit="true"
                refreshMode="partial" refreshId="panelPlayers"
                action="#{javascript:viewScope.teamID=entryTeam.getKey()}">
            </xp:eventHandler>
        </xp:link>
    </xp:panel>
    <xp:panel id="panelPlayers">
        <xp:repeat id="repeat2" rows="30"
            value="#{javascript:getPlayers(viewScope.teamID)}"
            var="entryPlayer">
            <xp:panel style="margin-left:20px;padding:10px">
                <xp:link escape="true"
                    text="#{javascript:entryPlayer.getValue()}" id="lnkPlayer">
                    <xp:eventHandler event="onclick" submit="true"
                        refreshMode="partial" refreshId="selectedPlayer"
                        execMode="partial" execId="lnkPlayer">
                        <xp:this.action><![CDATA[#{javascript:viewScope.PlayerName=entryPlayer.getValue();}]]></xp:this.action>
                    </xp:eventHandler>
                </xp:link>
            </xp:panel>
        </xp:repeat>
    </xp:panel>
</xp:repeat>
<xp:panel id="selectedPlayer" style="border:1px solid green;padding:20px;background-color:yellow;font-weight:bold">
    <xp:text escape="true" id="computedField1"
        value="#{javascript:viewScope.PlayerName}">
    </xp:text>
</xp:panel> 
```

这是获取这些重复的哈希图的 java 代码。有一个调用 java 方法的 SSJS 函数。

```
 public Map<String,String> getSoccerTeams() {
    Map<String,String> hmTeams=new HashMap<String,String>();
    try {
        ViewEntryCollection vec=vwTeams.getAllEntries();
        ViewEntry ve=vec.getFirstEntry();
        while (ve!=null) {
            hmTeams.put(ve.getUniversalID(), ve.getDocument().getItemValueString("TeamName"));
            ve=vec.getNextEntry(ve);
        }               
    } catch (Exception e) {
        e.printStackTrace();
    }
    return hmTeams;
}   
public Map<String,String> getPlayers(String idPlayer) {
    HashMap<String,String> hmPlayers=new HashMap<String,String>();
    try {
        View vwPlayers=this.dbCur.getView("playersview");
        DocumentCollection dc=vwPlayers.getAllDocumentsByKey(idPlayer, true);
        Document doc=dc.getFirstDocument();
        while (doc!=null) {
            hmPlayers.put(doc.getUniversalID(), doc.getItemValueString("PlayerName"));
            doc=dc.getNextDocument(doc);
        }               
    } catch (Exception e) {
        e.printStackTrace();
    }
    return hmPlayers;
} 
```

这是调用 java 方法的 SSJS 代码。

```
function getTeams() {
    var Teams=new LoadTeams();
    var hmTeams=Teams.getSoccerTeams();
    return hmTeams.entrySet();  
}

function getPlayers(playerID) {
    var Teams=new LoadTeams();
    var hmPlayers=Teams.getPlayers(playerID);
    return hmPlayers.entrySet();    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T04:53:58.913

你的问题在这里：

```
 value="#{javascript:getPlayers(viewScope.teamID)}" 
```

它应该读起来像：

```
 value="#{javascript:getPlayers(entryTeam.getKey())}" 
```

外部变量在内部重复中可用。如果您将代码填充到范围对象中，它将引用其中的最后一个值。

请在 Java 代码中回收您的 Notes 对象。您还想去缓存 bean 中的值，因此您不需要每次都通读视图。最后，您可以从代码中消除 SSJS，只使用 EL -> 甚至更快

在 EL 上：

假设您的 Java 类已注册为 ManagedBean“ **Soccer** ”，您可以编写以下代码：

```
 <xp:repeat id="repeat1" rows="30" value="#{javascript:getTeams()}"
var="entryTeam"> 
```

这个：

```
 <xp:repeat id="repeat1" rows="30" value="#{Soccer.teams}"
var="entryTeam"> 
```

而不是：

```
 <xp:repeat id="repeat2" rows="30"
        value="#{javascript:getPlayers(entryTeam.getKey())}"
        var="entryPlayer"> 
```

你写：

```
 <xp:repeat id="repeat2" rows="30"
        value="#{Soccer.teams[entryTeam.key]}"
        var="entryPlayer"> 
```

由于EL可以处理Maps，你实际上只需要`getTeams()`函数，不需要`getPlayers()`函数。您想稍微调整一下您的 Java 类以避免一遍又一遍地阅读视图：

```
 public class SoccerHandler {

private Map<String,Collection<String>> allTheTeams = null;

public Map<String,String> getTeams() {
    if (allTheTeams == null) {
        this.loadTheTeams();
    }
    return allTheTeams;
}

private void loadTheTeams() {
    // Add your own try/catch
    this.allTheTeams = new HashMap<String,Collection<String>>();
    View vwPlayers=this.getPlayersView(); // <-- Don't keep Notes objects in a BEAN
    ViewEntryCollection vec=vwPlayers.getAllEntries();
    String lastTeamName = "";
    Collection<String> curTeam = null;
    ViewEntry ve=vec.getFirstEntry();
    while (ve!=null) {
        Vector colVals = ve.getColumnValues();
        String curTeamName = colVals.get(0); // 1st column = team
        String curPlayerName = colVals.get(1); // 2nd column = player
        if (!curTeamName.equals(lastTeamName)) { // New team found
            if (curTeam != null) {
                this.allTheTeams.put(lastTeamName, curTeam);
            }
            curTeam = new ArrayList<String>();
            lastTeamName = curTeamName;
        }
        curTeam.put(curPlayerName);
        ve=vec.getNextEntry(ve);
    }
    // Make sure we don't miss the last team
    if (curTeam != null) {
        this.allTheTeams.put(lastTeamName, curTeam);
    }   
    ve.recycle();
    vec.recyle();
}

// If you want to be able to force a re-read
public void reset() {
    this.allTheTeams = null;
}
// more code here like getPlayerView that uses the resolver
} 
```

希望有帮助****

# java - Java 和 MySQL 事务

> ID：10544254
> 
> 赞同：3
> 
> 时间：2012-05-11T01:27:43.403
> 
> 标签：java, mysql, jdbc, transactions

我有一个在多台计算机上运行的 java 应用程序，它们都连接到同一个 MySQL 数据库。我需要事务以确保正确更新数据库。

我在释放锁时遇到问题。这是代码：

```
public boolean bookSeats(int numeroSala, Calendar dataOra, List<Posto> posti) {
    JDBConnection connection = JDBConnection.getDbConnection();
    Connection conn = connection.conn;
    java.sql.Date javaSqlDate = new java.sql.Date(dataOra.getTime().getTime());
    java.sql.Time javaSqlTime = new java.sql.Time(dataOra.getTime().getTime());

    try {
        conn.setAutoCommit(false);
        conn.setTransactionIsolation(Connection.TRANSACTION_SERIALIZABLE);
    } catch (SQLException e) {
        e.printStackTrace();
    }

    try
    {
        Posto p = null;
        ListIterator<Posto> itr = posti.listIterator();
        PreparedStatement stmt = null;
        stmt = conn.prepareStatement(
            "INSERT INTO sala?_tickets " + 
            "(giornoSpettacolo, orarioSpettacolo, fila, posto) " + 
            "VALUES (?, ?, ?, ?)");

        stmt.setInt(1, numeroSala);
        while(itr.hasNext())
        {
            p = itr.next();
            stmt.setString(2, javaSqlDate.toString()); // giornoSpettacolo
            stmt.setString(3, javaSqlTime.toString()); // orarioSpettacolo
            stmt.setInt(4, p.getFila()); // fila
            stmt.setInt(5, p.getNumero()); // posto
            stmt.addBatch();
        }

        stmt.executeBatch();

        conn.commit();
        return true;
    }
    catch (SQLException e) {
        e.printStackTrace();
    }

    return false;
} 
```

此方法工作正常，但是当我尝试同时在另一台计算机上执行此方法时，即使`conn.commit()`已完成，我也会收到 DEADLOCK 错误。

一旦我关闭第一个应用程序，另一个应用程序就可以运行该方法而不会出现死锁错误。好像 COMMIT 没有释放锁？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:41:11.160

根据 MySQL 文档，关于 SERIALIZABLE：

> 此级别类似于 REPEATABLE READ，但如果禁用自动提交，InnoDB 会将所有普通 SELECT 语句隐式转换为 SELECT ... LOCK IN SHARE MODE。

您可能想在提交后尝试重新启用自动提交，或尝试连接。REPEATABLE_READ 代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:38:21.550

您可以参考[此文档](http://docs.oracle.com/javase/tutorial/jdbc/basics/transactions.html)以了解如何使用裸 JDBC 进行事务。希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T01:40:53.597

您应该始终`conn.close()`在一个`finally`块中执行 a 以确保释放您的方法使用的任何资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T07:19:23.150

是的，按照第一个答案的说明关闭连接。但是，此外，如果您可以将上述代码放入“同步”方法中，它将确保一次只有一个线程可以访问它。

除此之外，只需看看下面的链接，它讨论了 JDBC 中的死锁处理

[Java中的死锁检测](https://stackoverflow.com/questions/217113/deadlock-in-java)

# ruby-on-rails - Yaml 中的百分号是什么意思？

> ID：10544260
> 
> 赞同：0
> 
> 时间：2012-05-11T01:28:54.663
> 
> 标签：ruby-on-rails, internationalization, yaml

我注意到在 i18n rails guide 中，它们具有以下代码：

```
en:
  activerecord:
    errors:
      template:
        header:
          one:   "1 error prohibited this %{model} from being saved"
          other: "%{count} errors prohibited this %{model} from being saved"
        body:    "There were problems with the following fields:" 
```

是什么`%{...}`意思？这与 有何不同`#{...}`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T01:39:12.287

如果您阅读该指南多一点，您会遇到将[变量传递给翻译](http://guides.rubyonrails.org/i18n.html#passing-variables-to-translations)部分：

> 您可以在翻译消息中使用变量并从视图中传递它们的值。
> 
> ```
> # app/views/home/index.html.erb
> <%=t 'greet_username', :user => "Bill", :message => "Goodbye" %>
> 
> # config/locales/en.yml
> en:
>   greet_username: "%{message}, %{user}!" 
> ```

和[插值](http://guides.rubyonrails.org/i18n.html#interpolation)部分：

> 在许多情况下，您希望将翻译抽象化，以便可以将变量插入到翻译中。出于这个原因，I18n API 提供了一个插值功能。
> 
> `:default`除了和之外的所有选项`:scope`都`#translate`将被插入到翻译中：
> 
> ```
> I18n.backend.store_translations :en, :thanks => 'Thanks %{name}!'
> I18n.translate :thanks, :name => 'Jeremy'
> # => 'Thanks Jeremy!' 
> ```

所以这些`%{...}`东西与 YAML 没有任何关系，这是 I18n 在消息中处理变量插值的方式。

# python - 将文件拆分为列表

> ID：10544269
> 
> 赞同：0
> 
> 时间：2012-05-11T01:30:07.683
> 
> 标签：python

这是我到目前为止所拥有的：

```
EX1 = open('ex1.txt')
EX1READ = EX1.read()
X1READ.splitlines(0)

['jk43:23 Marfield Lane:Plainview:NY:10023',
 'axe99:315 W. 115th Street, Apt. 11B:New      York:NY:10027',
 'jab44:23 Rivington Street, Apt. 3R:New York:NY:10002',
 'ap172:19 Boxer Rd.:New York:NY:10005',
 'jb23:115 Karas Dr.:Jersey City:NJ:07127',
 'jb29:119 Xylon Dr.:Jersey City:NJ:07127',
 'ak9:234 Main Street:Philadelphia:PA:08990'] 
```

我希望能够从该列表中获取 userId 并按字母顺序打印。任何提示都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:42:24.377

这样做：

```
IDs=[]
with open('ex1.txt', 'rb') as f:
    for line in f:
        IDs.append(line.split(':')[0])

print sorted(IDs) 
```

印刷：

```
['ak9', 'ap172', 'axe99', 'jab44', 'jb23', 'jb29', 'jk43'] 
```

如果您的用户 ID 喜欢`jk43:23`使用`IDs.append(line.split(' ')[0])`并打印：

```
['ak9:234', 'ap172:19', 'axe99:315', 'jab44:23', 'jb23:115', 'jb29:119', 'jk43:23'] 
```

如果您的用户 ID 只是数字，请使用`IDs.append(int(line.split(' ')[0].split(':')[1]))`which 打印：

```
[19, 23, 23, 115, 119, 234, 315] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T01:54:26.220

假设第一个“：”之前的部分是用户 ID，您可以以更 Python 的方式执行此操作：

```
with open("ex1.txt") as f:
    lines = f.readlines()
    userIDs = [l.split(":",1)[0] for l in lines]
    print "\n".join(sorted(userIDs)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T01:32:31.487

```
userIds = []

EX1 = open('ex1.txt')
X1READ = EX1.readlines()

for line in X1READ:
    useridname = line.split(" ")[0].split(":")[0];
    userid = line.split(" ")[0].split(":")[1]
    userIds.append([useridname, userid]) 
```

我确信有更多 Pythonic 方法可以做到这一点，但我的方法将返回一个列表列表，其中父列表中的每个子列表的格式如下：

```
["jk43", "23"] 
```

因此，要获取第一个用户 ID 和 ID 号，您可以这样做：

```
firstUserId = userIds[0][0] + ": " + userIds[0][1] 
```

哪个会输出

> > “jk43：23”

要对 ID 列表进行排序，您可以执行以下操作：

```
userIds = sorted(userIds, key = id: id[0]) 
```

# jquery - 创建单击即可更改的网站背景图像

> ID：10544270
> 
> 赞同：-1
> 
> 时间：2012-05-11T01:30:15.227
> 
> 标签：jquery, html, background

我想知道如何创建单击时会更改的背景图像。它应该通过这样的一系列图像。任何线索如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T02:15:59.867

### jQuery 方式

这是一个基本的 jQuery 解决方案：

```
var images = [
  'http://placekitten.com/500/500',
  'http://placekitten.com/400/400',
  'http://placekitten.com/750/750'
];

$(".changeBG").on("click", function(){
  $("body").css("backgroundImage", function( o, v ) {
    var backg = v.match( /\((.+)\)/ );
    var index = $.inArray( ( backg ? backg[1] : "" ), images );
    return "url('" + ( images[++index] || images[0] ) + "')";
  });
}); 
```

演示：http: [//jsbin.com/isubag/2/edit](http://jsbin.com/isubag/2/edit)

### 纯 JavaScript（几乎）方式

该解决方案在 jQuery 上相当繁重，这会稍微减慢它的速度。您可以采用更全面的方法。不幸的是，仍然有使用`$.inArray`（尽管[polyfills 确实存在](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf#Compatibility)），因为`indexOf`对数组的原生支持并不是那么好。

```
var bg = {
  images: [
    'http://placekitten.com/500/500',
    'http://placekitten.com/400/400',
    'http://placekitten.com/750/750'
  ],
  get: function () {
    var match = document.body.style.backgroundImage.match( /\((.+)\)/ );
    return match ? match[1] : "" ;
  },
  set: function ( url ) {
    document.body.style.backgroundImage = "url('" + url + "')" ; 
  }
};

function bgCycler () {
  var index = $.inArray( bg.get(), bg.images );
  bg.set( bg.images[++index] || bg.images[0] );
} 
```

演示：http: [//jsbin.com/isubag/edit#javascript,html](http://jsbin.com/isubag/edit#javascript,html)

# c# - 名字和姓氏的数组连接

> ID：10544271
> 
> 赞同：2
> 
> 时间：2012-05-11T01:30:31.497
> 
> 标签：c#, arrays

我有以下程序，我想要做的是加入我从 2 个文本文件中获得的姓名列表，在第一个文本文件中我有名字，在第二个姓氏中，我试图加入他们。此外，我正在尝试列出文件的所有组合，即名字是马克和迈克，姓氏是威尔逊和沃森，我想制作迈克沃森和迈克威尔逊

```
 TextReader sr = new StreamReader(textBox1.Text);
        TextReader sr2 = new StreamReader(textBox2.Text);
        string contents = sr.ReadToEnd();
        string contents2 = sr2.ReadToEnd();
        string[] myArray = { contents };
        string[] myArray2 = { contents2 };
        foreach (string element1 in myArray)
        {
            foreach (string element2 in myArray2)
            {
                System.Text.StringBuilder sb = new System.Text.StringBuilder();
                sb.Append(element1);
                sb.Append(" " + element2);
                Debug.WriteLine(sb.ToString());

                string str = sb.ToString();
                Debug.WriteLine(str);

                //MessageBox.Show(sb.ToString);
            }
        } 
```

最终结果应该是，来自 file1 的 Mike Smith：mike，file2：smith

谢谢您的帮助

使用上述答案的组合我想出了这个答案，分割文本文件时的 '\r' 至关重要，因为文本是从 Windows 2003 读取的（我不确定在 win 7 或 2008 上会产生什么结果）使用内置数组很好，但是当我尝试从文件系统运行它时，我得到了完全不同的结果，添加了 '\r' 修复请看这篇文章

[在 C# 中，\n 和 \r\n 有什么区别？](https://stackoverflow.com/questions/3986093/in-c-whats-the-difference-between-n-and-r-n)

```
TextReader sr = new StreamReader(textBox1.Text);
        TextReader sr2 = new StreamReader(textBox2.Text);
        string contents = sr.ReadToEnd();
        string contents2 = sr2.ReadToEnd();
        string[] firstNames = contents.Split(new Char[] { '\r','\n',' ', ',' }, StringSplitOptions.RemoveEmptyEntries);
        string[] lastNames = contents2.Split(new Char[] { '\r','\n',' ', ',' }, StringSplitOptions.RemoveEmptyEntries);
        var fullnames =
                    from fn in firstNames
                    from ln in lastNames
                    select new { Fullname = fn + " " + ln };

        foreach (var person in fullnames)
        {
            Debug.WriteLine(person.Fullname);
            //MessageBox.Show(person.Fullname);
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T01:32:41.200

**LINQ**

这将加入名字和名字

```
string[] joinednames = myArray.Zip(myArray2, (x, y) => x + " " + y).ToArray(); 
```

如果你想加入然后`first firstname with all lastname`使用这个`second firstname with all lastnames``so on`

```
string[] joinednames = myArray.Select(x => myArray2.Select(y => 
                       x + " " + y)).SelectMany(x => x).ToArray(); 
```

假设第一个列表包含名字

`"Mark"`,`"Marry"`

第二个列表包含姓氏

`"Watson"`和`"Wilson"`。

**第一个片段会给**

`"Mark Watson"`,`"Marry Wilson"`

**第二个片段会给**

`"Mark Watson"`, `"Mark Wilson"`, `"Marry Watson"`,`"Marry Wilson"`

我认为第二个片段是你需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:37:08.103

您当前的代码很接近。

```
TextReader sr = new StreamReader(textBox1.Text); 
TextReader sr2 = new StreamReader(textBox2.Text); 

string contents = sr.ReadToEnd(); 
string contents2 = sr2.ReadToEnd(); 

string[] myArray = contents.Split(new Char [] {' ', ','}, StringSplitOptions.RemoveEmptyEntries); 
string[] myArray2 = contents2.Split(new Char [] {' ', ','}, StringSplitOptions.RemoveEmptyEntries); 
System.Text.StringBuilder sb = new System.Text.StringBuilder();

var joinednames = myArray.Zip(myArray2, (x, y) => x + " " + y).ToList();

foreach (string str in joinednames)
{
    Debug.WriteLine(str);
} 
```

您可能应该在名称之间添加一些额外的分隔符。

**编辑：**我将我的答案与 Nikhil 的答案结合起来，并在 VS 中进行了一些测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T01:49:17.923

我同意 mgnoonan 的观点，即您的主要问题是您没有将名称列表正确解析到数组中。使用他将名称放入数组的方法。但是，一旦你把它们弄到了那里，我就会喜欢 Nikhil 的 LINQ 解决方案的优雅，它可以组合两个数组。使用它们。

**编辑：** 下面的示例

```
TextReader sr = new StreamReader(textBox1.Text); 
TextReader sr2 = new StreamReader(textBox2.Text); 

string contents = sr.ReadToEnd(); 
string contents2 = sr2.ReadToEnd(); 

string[] myArray = contents.Split(new Char [] {' ', ','}); 
string[] myArray2 = contents2.Split(new Char [] {' ', ','}); 

string[] joinednames = myArray.Zip(myArray2, (x, y) => x + " " + y).ToArray();

foreach(string element in joinednames)
{
    Debug.WriteLine(element);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T02:26:19.100

此答案**仅基于**您对问题所做的评论。根据您的评论，如果您希望创建所有可能的数组组合，这是一个**没有 LINQ 的解决方案**

```
string[] firstNames = {"Mark", "Mike" };
string[] lastNames = {"Watson", "Wilson" };
IList<string> allNameCombinations = new List<string>();

foreach (string firstname in firstNames)
{
    foreach (string lastname in lastNames)
         allNameCombinations.Add(firstname + " " + lastname);
}

string[] allNames = allNameCombinations.ToArray(); 
```

输出数组将包含以下元素

```
Mark Watson
Mark Wilson
Mike Watson
Mike Wilson 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T01:51:14.253

虽然其他答案很有帮助，但它们并没有解释你哪里出错了。您的原始代码的问题是这些语句：

```
string[] myArray = { contents }; 
string[] myArray2 = { contents2 }; 
```

第一条语句创建一个包含*一个元素*的数组；`contents`该元素是对变量引用的同一字符串的引用。同样，`myArray2`是一个具有单个元素的数组 等于`contents2`。

通过分割行分隔符来创建数组：

```
string[] myArray = contents.Split(new Char [] {'r', 'n'}, StringSplitOptions.RemoveEmptyEntries);    
string[] myArray2 = contents2.Split(new Char [] {'r', 'n'}, StringSplitOptions.RemoveEmptyEntries); 
```

并按照 Nikhil Agrawal 的建议将它们结合起来；但是，您可能会发现查询理解语法更容易理解：

```
IEnumerable<string> fullNames = 
    from firstName in myArray
    from lastName in myArray2
    select firstName + " " + lastName 
```

或者，颠倒产品的顺序：

```
IEnumerable<string> fullNames = 
    from lastName in myArray2
    from firstName in myArray
    select firstName + " " + lastName 
```

或者，如果您不想使用 linq：

```
foreach (string firstName in myArray)
    foreach (string lastName in myArray2)
    {
        string fullName = firstName + " " + lastName;
        // do something with the fullName here
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-11T01:58:16.787

您需要更好地从文件中读取条目（读取不止一行，每行不止一个条目，空格或逗号分隔）：

```
var firsts = File.ReadAllLines(textBox1.Text).SelectMany(n => n.Split(new Char [] {' ', ','}));
var lasts = File.ReadAllLines(textBox2.Text).SelectMany(n => n.Split(new Char [] {' ', ','})); 
```

然后您可以按照其他答案的建议进行操作：

```
var fullNames = firsts.Zip(lasts, (f, l) => f + " " + l).ToArray(); 
```

**注意：**确保导入 LINQ`using System.Linq;`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-11T02:26:08.117

阅读您的问题的评论，您想列出组合名字和姓氏的所有可能性，不是吗？

你可以试试这个：

```
var fullnames = 
        from fn in firstNames
        from ln in lastNames
        select new { Fullname = fn + " " + ln };

foreach(var person in fullnames) {
    Console.WriteLine (person.Fullname);
} 
```

* * *

完整代码：

```
using System;
using System.Collections.Generic;
using System.Linq;

public class Test
{
        public static string[] firstNames = {"Mark", "Mike" };
        public static string[] lastNames = {"Watson", "Wilson"};

        public static void Main (string[] args)
        {

                var fullnames = 
                        from fn in firstNames
                        from ln in lastNames
                        select new { Fullname = fn + " " + ln };

                foreach(var person in fullnames) {
                     Console.WriteLine (person.Fullname);
                }

      }
} 
```

输出：

```
Mark Watson
Mark Wilson
Mike Watson
Mike Wilson 
```

演示代码：http: [//ideone.com/ei6vh](http://ideone.com/ei6vh)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-11T02:38:07.750

这些行的代码有问题：

```
string contents = sr.ReadToEnd();
string contents2 = sr2.ReadToEnd();

// arrays don't automatically split string content
string[] myArray = { contents };
string[] myArray2 = { contents2 }; 
```

你应该这样做：

```
string contents = sr.ReadToEnd();
string contents2 = sr2.ReadToEnd();

// arrays don't automatically split file content
string[] myArray = contents.Split('\n');
string[] myArray2 = contents2.Split('\n'); 
```

或者更好的是，在阅读器上拆分它：

```
string[] myArray = sr.ReadToEnd().Split('\n');
string[] myArray2 = sr.ReadToEnd().Split('\n'); 
```

* * *

请注意，有些文本文件的行分隔符不一致，有些使用组合`\r\n`（大多数文本文件来自 Windows 应用程序），有些仅使用`\n`，我还没有看到`\r`仅用于行分隔符的文本文件。

改为这样做：

```
string[] myArray = 
    sr.ReadToEnd().Split (new[]{"\r\n", "\n", "\r"}, StringSplitOptions.None);

string[] myArray2 = 
    sr.ReadToEnd().Split (new[]{"\r\n", "\n", "\r"}, StringSplitOptions.None); 
```

# asp.net - 如何限制不同类型用户访问网页？

> ID：10544276
> 
> 赞同：0
> 
> 时间：2012-05-11T01:31:30.457
> 
> 标签：asp.net

我有一个 Web 应用程序，其中有一个管理员和许多用户。当用户登录时，他会被带到某个页面，他可以从该页面执行其他操作，从而将他引导到仅限于他的其他页面。管理员也是如此。但是，如果我在运行时将 url 更改为受限页面，则用户可以访问管理员页面，反之亦然。我听说过使用会员访问权限。但我不知道它是怎么做的。我正在使用一个 sql 数据库，其中登录详细信息存储在一个表中。

那么如何限制访问呢？我听说它与 web.config 有关系？仅使用后面的代码是否可以达到相同的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:36:59.007

您应该使用 ASP.NET Membership 提供程序。它会给你很多开箱即用的东西。Scott Mitchell有一个[很好的教程](http://www.asp.net/web-forms/tutorials/security/membership/creating-the-membership-schema-in-sql-server-cs)，它将指导您完成这个过程。

*   [第1部分](http://www.asp.net/web-forms/tutorials/security/membership/creating-the-membership-schema-in-sql-server-cs)
*   [第2部分](http://www.asp.net/web-forms/tutorials/security/membership/creating-user-accounts-cs)
*   [第 3 部分](http://www.asp.net/web-forms/tutorials/security/membership/validating-user-credentials-against-the-membership-user-store-cs)
*   [第 4 部分](http://www.asp.net/web-forms/tutorials/security/membership/user-based-authorization-cs)
*   [第 5 部分](http://www.asp.net/web-forms/tutorials/security/membership/storing-additional-user-information-cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T01:37:27.367

加载页面时，您可能必须检查用户是否具有正确的权限并允许访问或将他重定向到另一个页面。

如果 ！用户可以访问页面{重定向}

您的页面内容。

# java - 在JAVA中，将图像的RGB值转换为二进制的最快方法是什么？

> ID：10544277
> 
> 赞同：1
> 
> 时间：2012-05-11T01:31:44.777
> 
> 标签：java, image, binary, type-conversion, rgb

我试图将图像上任何给定像素的 RGB 值转换为 12 位二进制，每个通道由 4 位表示。例如，如果一个像素在“255”处有红色通道，或者二进制“11111111”。我希望将其转换为“1111”。

我有一个代码工作，但它相当慢，我想知道是否有更好的方法来做到这一点。

这就是我所做的。

1.  我使用 getRGB(x, y) 方法来获取一个像素的 RGB 值。例如-4278864
2.  我将其转换为 3 个单独的通道，例如 r 190 g 181 b 176
3.  我将它除以 16 以获得相当于 4 位表示的整数
4.  我将数字转换为二进制。
5.  如果生成的二进制小于 4 位，则在二进制前面添加 0。
6.  连接到 12 位二进制以表示 12 位颜色输出。例如 101110111011

这是我的代码：

```
import java.awt.Component;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;

public class LoadImageApp extends Component {
    private static int[] rgbArray;
    private static double bitPerColor = 4.0;

    public static void main(String[] args) {

       BufferedImage img = null;
       String fileName = "Image.jpg";

       try {
           //Read in new image file
           img = ImageIO.read(new File("src/"+fileName));
       } 
       catch (IOException e){
       }

       if (img == null) {
             System.out.println("No image loaded");
        } 
       else {

                //Get RGB Value
                int val = img.getRGB(500, 500);
                System.out.println("rgbValue from getRGB is: " + val);

                //Convert to three separate channels
                int a = (0xff000000 & val) >>> 24;
                int r = (0x00ff0000 & val) >> 16;
                int g = (0x0000ff00 & val) >> 8;
                int b = (0x000000ff & val);

                System.out.println("rgbValue in RGB is: ");
                System.out.println("a " + a + " r " + r + " g " + g + " b " + b);

                double power = Math.pow(2.0, bitPerColor);
                //Convert each channel to binary
                String r4bit = Integer.toBinaryString((int)(r/(power)));
                String g4bit = Integer.toBinaryString((int)(g/(power)));
                String b4bit = Integer.toBinaryString((int)(b/(power)));

                //Convert concatonate 0's in front to get desired bit count
                int rDifference = (int)bitPerColor - r4bit.length();
                int gDifference = (int)bitPerColor - g4bit.length();
                int bDifference = (int)bitPerColor - b4bit.length();

                for (int i = rDifference; i > 0; i--){
                    r4bit="0"+r4bit;}

                for (int i = gDifference; i > 0; i--){
                    g4bit = "0"+g4bit;}

                for (int i = bDifference; i > 0; i--){
                    b4bit = "0"+b4bit;}

                //Concatonate three channel together to form one binary
                String rgbValue = r4bit + g4bit + b4bit;

                System.out.println("rgbValue in binary is: " + rgbValue);

           }     
       }
} 
```

这一切都可以按需要正常工作。然而，读取一个像素需要 2-3 秒，这真的非常非常难看，而且速度很慢。我希望使用代码一次读取图像的一部分，但我可以用 AGES 对它进行成像。

因此，我们将不胜感激任何帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T02:51:39.510

您的原始代码（十六进制）是`0x00rrggbb`. 您想将其转换为`0x00000rgb`. 这将做到：

```
int rgb24 = ....;
int rgb12 = (rgb24 & 0x00f00000) >> 12 + 
            (rgb24 & 0x0000f000) >> 8  + 
            (rgb24 & 0x000000f0) >> 4; 
```

如果你想“四舍五入”到最接近的颜色而不是截断你可以这样做：

```
int r = (rgb24 & 0x00ff0000);
int g = (rgb24 & 0x0000ff00);
int b = (rgb24 & 0x000000ff);
r += (r >= 0x00f00000) ? 0x00080000 : 0;
g += (g >= 0x0000f000) ? 0x00000800 : 0;
b += (b >= 0x000000f0) ? 0x00000008 : 0;
int rgb12 = (r & 0x00f00000) >> 12 + (g & 0x0000f000) >> 8 + (b & 0x000000f0) >> 4; 
```

这会向上取整，但前提是高 4 位还不是 1111（当您有溢出的风险时）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T02:51:03.237

有一些事情可能会减慢速度，例如...

1.  分别从`BufferedImage`
2.  在循环中多次使用`Math.pow()`和可能`Integer.toBinaryString()`
3.  一直使用`String`s，而不是像`int`or之类的数字`short`。如果你想要一个，也许在最后从-->进行`String`一次转换。`short``String`

我可能会尝试做这样的事情......

```
// Get all the pixels
int pixelCount = imageWidth*imageHeight;
int[] pixelArray = new int[pixelCount];
img.getRGB(0,0,imageWidth,imageHeight,pixelArray,0,1);

// For storing the 4-bit data
short[] convertedArray = new short[pixelCount];

// calculate the conversion factor a single time
double power = Math.pow(2.0, bitPerColor);

// Loop over the pixels
for (int p=0;p<pixelCount;p++){
    int pixel = pixelArray[p];

    // Convert into separate channels
    int a = (0xff000000 & val) >>> 24;
    int r = (0x00ff0000 & val) >> 16;
    int g = (0x0000ff00 & val) >> 8;
    int b = (0x000000ff & val);

    // Convert to 4-bit
    a /= power;
    r /= power;
    g /= power;
    b /= power;

    // Create the short for the pixel (4 channels * 4 bits = a 2-byte short)
    short newPixel = (a & 0x0000000f) << 24 | (r & 0x0000000f) << 16 | (g & 0x0000000f) << 8 | (b & 0x0000000f);
    convertedArray[p] = newPixel;

    // If you want to have the value as a String, do it here.
    String binary = Short.toBinaryString(newPixel);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T02:44:51.923

顺便说一句，我注意到您使用字符串加运算符进行追加。我知道这是简单的代码，但是在循环中需要一些工作。运算符调用构造函数来执行其功能。循环到底有多大？

可能不使用加号运算符，而是使用其他类，如 StringBuilder 或与之等效的 Java。告诉我你最终使用哪个类。通过计时代码进行调查！

当您想查看可能的瓶颈时，请先查看堆或堆栈中的 LOOPS，因为可能有很多代码执行。这应该是某处的编码规则......

试试看，玩得开心。请投票给我的答案。我需要一个徽章和更多积分:-)

汤米奎

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-15T06:15:04.513

使用 SetRGB 设置时我在 RGB 中收集的值是否会为我提供二进制图像，其中图像存在的区域为白色，而图像不存在的区域为黑色？

# php - php登录脚本错误

> ID：10544278
> 
> 赞同：0
> 
> 时间：2012-05-11T01:31:57.447
> 
> 标签：php

我有这个登录脚本在一台服务器上工作得很好，但在另一台服务器上却不行，而且不知道为什么。

```
include_once 'include/processes.php';
$Login_Process = new Login_Process;
$Login_Process->check_status($_SERVER['SCRIPT_NAME']); 
```

第三行不会显示服务器状态，代码显示在我的网页上，并且没有转到主页。任何想法都可能导致问题。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:38:53.083

第三行不起作用，很可能是因为此行在某处生成了致命错误：

```
$Login_Process = new Login_Process; 
```

要么使用 ini_set 更改正在显示的错误，要么设置错误日志。你基本上需要知道错误是什么，然后你才能处理它们。

可能有很多东西，其中一些可能是配置。

我要检查的第一件事是 PHP 版本。确保您的脚本或 php.ini 文件中没有任何内容与您要迁移到的 PHP 版本冲突。

之后，检查您正在调用的函数，并确保在第二台服务器上的 PHP 中没有弃用任何内容。

# javascript - 使用发送按钮的参数无效错误

> ID：10544289
> 
> 赞同：0
> 
> 时间：2012-05-11T01:33:41.220
> 
> 标签：javascript

当我单击嵌入的 SendButton 时，我收到以下代码语句中出现的错误“Invalid Argument”：“a.width(b.style.width+'px');”。它发生在 InternetExplorer9 中。我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:11:44.667

尝试以下两种方法之一：

```
a.width((0 + b.style.width) +'px');

a.width(parseInt(b.style.width) +'px'); 
```

否则，请确保“b”是一个对象，它附加了样式信息等。

# javascript - 我应该如何处理将特定页面事件绑定到可重用 DOM？

> ID：10544293
> 
> 赞同：0
> 
> 时间：2012-05-11T01:34:48.250
> 
> 标签：javascript, jquery, javascript-events, backbone.js

我的应用程序具有跨多个页面重用的代码。假设我有这个：

```
+ page_A.html
  - includes partial_1.html
+ page_B.html
  - includes partial_1.html 
```

现在，partial_1.html 中的 DOM 元素具有与之关联的 JavaScript 事件。这些可以分为两类：

*   无论使用哪个页面都必须绑定的事件（类型 I）
*   必须以不同方式绑定的事件，具体取决于呈现部分的页面（类型 II）

我组织它的方式是这样的：

*   partial_1.html --> 用于模板
*   partial_1.css --> 用于 CSS
*   partial_1.js --> 用于模型/控制器和类型 I 绑定
    *   partial_1__A --> 用于特定于页面 A 的类型 II 绑定
    *   partial_1__B --> 用于特定于页面 B 的类型 II 绑定
    *   等等....

显然，如果有很多模板，这可能会让人厌烦。幸运的是，在这个阶段我只有两个，所以没什么大不了的。**但是**我想知道是否：

1.  有更好的方法来处理这个
2.  我可以利用一些现有的框架/库。*backbone.js*会为此提供某种机制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:37:18.280

我会使用 jquery 来绑定事件。

我还会将不同的绑定放在不同页面的代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:00:10.960

您想使用事件冒泡。假设这些 html 文件是部分文件并加载到现有元素中，您可以使用 jquery 的[on](http://api.jquery.com/on/)方法。这样，每个事件您将只有一个事件处理程序，并且不必在加载新内容时绑定/取消绑定事件。

# windows - xperf 拒绝加载任何符号

> ID：10544294
> 
> 赞同：0
> 
> 时间：2012-05-11T01:34:56.263
> 
> 标签：windows, profiling, symbols, xperf

使用这些命令行：

设置 _NT_SYMBOL_PATH=srv*C:\symbols*http://msdl.microsoft.com/downloads/symbols XPerf -on FILE_IO XPerf -d trace.etl XPerf -symbols verbose -i trace.etl > output.csv

我得到以下输出：

XPerf：警告：对跟踪处理应用访问限制 xperf：使用符号路径：srv*C:\symbols*http://msdl.microsoft.com/downloads/symbols xperf：使用可执行路径：srv*C:\symbols* http://msdl.microsoft.com/downloads/symbols xperf：使用 SymCache 路径：\SymCache xperf：SymCache 引擎版本：v1.1 xperf：接受的最低 SymCache 版本：v1.1

xperf：接受的最低 SymCache 版本：v1.1 [1/2] 100.0% [2/2] 100.0%

```
 Warning: This trace does not contain the information needed to perform proper symbol decoding.
            It was most likely stopped improperly. Please consult the documentation for information on how
            to stop trace sessions (for example XPerf -stop <logger names> -d <merged.etl>)

            If you still have access to the machine on which this trace was collected, you can have XPerf
            add the required symbol information by running the following on that machine:

                    XPerf -merge <trace1.etl> <trace2.etl> ... <merged.etl>

            Running this command on any machine other than the one on which the trace was collected will
            result in incorrect symbol decoding. 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T03:10:23.583

```
XPerf -merge trace.etl trace_with_correct_symbol_decoding_info.etl 
```

现在您可以使用原始命令解析 trace_with_correct_symbol_decoding_info.etl ：

```
XPerf -symbols verbose -i trace_with_correct_symbol_decoding_info.etl > output.csv 
```

合并命令不仅合并了多个etl文件，它还“添加了安全符号解码所需的图像识别信息”。

```
D:\>xperf -help merge
    Trace merge options:

    xperf -merge trace1.etl trace2.etl ... merged.etl

        -Merge      trace1.etl trace2.etl ... merged.etl Merge trace1.etl trace2.etl ... into
                                     merged.etl, also adding image identification
                                     information required for safe symbol
                                     decoding. 
```

# performance - windows server 2008 上的 UDP 性能上限

> ID：10544296
> 
> 赞同：2
> 
> 时间：2012-05-11T01:35:44.280
> 
> 标签：performance, udp, winsock, multicast

从我的测试来看，我的 10gb 网络似乎遇到了性能障碍。我似乎无法每秒读取超过 180-200k 个数据包。查看 perfmon 或任务管理器，如果不是更多，我每秒最多可以接收一百万个数据包。测试 1 个套接字或 10 个或 100 个，似乎并没有改变每秒 200-300k 个数据包的限制。我一直在摆弄 RSS 之类的东西，但没有成功。单播与多播似乎无关紧要，重叠 i/o 与同步也没有区别。数据包的大小也无关紧要。窗口可以从网卡复制到缓冲区的数据包数量似乎有一个硬性限制。这是戴尔 r410。有任何想法吗？

```
#include "stdafx.h"

#include <WinSock2.h>
#include <ws2ipdef.h>

static inline void fillAddr(const char* const address, unsigned short port, sockaddr_in &addr)
{
    memset( &addr, 0, sizeof( addr ) );
    addr.sin_family = AF_INET;
    addr.sin_addr.s_addr = inet_addr( address );
    addr.sin_port = htons(port);
}

int _tmain(int argc, _TCHAR* argv[])
{
#ifdef _WIN32
    WORD wVersionRequested;
    WSADATA wsaData;
    int err;

    wVersionRequested = MAKEWORD( 1, 1 );

    err = WSAStartup( wVersionRequested, &wsaData );
#endif
    int error = 0;
    const char* sInterfaceIP = "10.20.16.90";
    int nInterfacePort = 0;

    //Create socket
    SOCKET m_socketID = socket( AF_INET, SOCK_DGRAM, IPPROTO_UDP );

    //Re use address
    struct sockaddr_in addr;
    fillAddr( "10.20.16.90", 12400, addr ); //"233.43.202.1"

    char one = 1;
    //error = setsockopt(m_socketID, SOL_SOCKET, SO_REUSEADDR , &one, sizeof(one));
    if( error != 0 )
    {
        fprintf( stderr, "%s: ERROR setsockopt returned %d.\n", __FUNCTION__, WSAGetLastError() );
    }

    //Bind
    error = bind( m_socketID, reinterpret_cast<SOCKADDR*>( &addr ), sizeof( addr ) );

    if( error == -1 )
    {
        fprintf(stderr, "%s: ERROR %d binding to %s:%d\n",
            __FUNCTION__, WSAGetLastError(), sInterfaceIP, nInterfacePort);
    }

    //Join multicast group
    struct ip_mreq mreq;
    mreq.imr_multiaddr.s_addr = inet_addr("225.2.3.13");//( "233.43.202.1" );
    mreq.imr_interface.s_addr = inet_addr("10.20.16.90");

    //error = setsockopt( m_socketID, IPPROTO_IP, IP_ADD_MEMBERSHIP, reinterpret_cast<char*>( &mreq ), sizeof( mreq ) );

    if (error == -1)
    {
        fprintf(stderr, "%s: ERROR %d trying to join group %s.\n", __FUNCTION__, WSAGetLastError(), "233.43.202.1"  );
    }

    int bufSize = 0, len = sizeof(bufSize), nBufferSize = 10*1024*1024;//8192*1024;

    //Resize the buffer
    getsockopt(m_socketID, SOL_SOCKET, SO_RCVBUF, (char*)&bufSize, &len );
    fprintf(stderr, "getsockopt size before %d\n", bufSize );

    fprintf(stderr, "setting buffer size %d\n", nBufferSize );

    error =  setsockopt(m_socketID, SOL_SOCKET, SO_RCVBUF,
        reinterpret_cast<const char*>( &nBufferSize ), sizeof( nBufferSize ) );
    if( error != 0 )
    {
        fprintf(stderr, "%s: ERROR %d setting the receive buffer size to %d.\n",
            __FUNCTION__, WSAGetLastError(), nBufferSize );
    }

    bufSize = 1234, len = sizeof(bufSize);
    getsockopt(m_socketID, SOL_SOCKET, SO_RCVBUF, (char*)&bufSize, &len );
    fprintf(stderr, "getsockopt size after %d\n", bufSize );

    //Non-blocking
    u_long op = 1;
    ioctlsocket( m_socketID, FIONBIO, &op );

    //Create IOCP
    HANDLE iocp = CreateIoCompletionPort( INVALID_HANDLE_VALUE, NULL, NULL, 1 );
    HANDLE iocp2 = CreateIoCompletionPort( (HANDLE)m_socketID, iocp, 5, 1 );

    char buffer[2*1024]={0};

    int r = 0;

    OVERLAPPED overlapped; 
    memset(&overlapped, 0, sizeof(overlapped));

    DWORD bytes = 0, flags = 0;
//  WSABUF buffers[1];
//
//  buffers[0].buf = buffer;
//  buffers[0].len = sizeof(buffer);
//
//  while( (r = WSARecv( m_socketID, buffers, 1, &bytes, &flags, &overlapped, NULL )) != -121 )
    //sleep(100000);
    while( (r = ReadFile( (HANDLE)m_socketID, buffer, sizeof(buffer), NULL, &overlapped )) != -121 )
    {
        bytes = 0;
        ULONG_PTR key = 0;
        LPOVERLAPPED pOverlapped;

        if( GetQueuedCompletionStatus( iocp, &bytes, &key, &pOverlapped, INFINITE ) )
        {
            static unsigned __int64 total = 0, printed = 0;

            total += bytes;

            if( total - printed > (1024*1024) )
            {
                printf( "%I64dmb\r", printed/ (1024*1024) );
                printed = total;
            }
        }

    }

    while( r = recv(m_socketID,buffer,sizeof(buffer),0) )
    {
        static unsigned int total = 0, printed = 0;

        if( r > 0 )
        {
            total += r;

            if( total - printed > (1024*1024) )
            {
                printf( "%dmb\r", printed/ (1024*1024) );
                printed = total;
            }
        }
    }

    return 0;
} 
```

我使用 Iperf 作为发送方，并将接收到的数据量与发送的数据量进行比较： iperf.exe -c 10.20.16.90 -u -P 10 -B 10.20.16.51 -b 1000000000 -p 12400 -l 1000

编辑：对 iperf 执行 iperf 性能接近 180k 左右而不会下降（8mb 客户端缓冲区）。如果我在做 tcp，我可以做大约 200k 个数据包/秒。不过有趣的是 - 我可以使用多个 tcp 连接完成超过 200k 的操作，但是多个 udp 连接不会增加总数（我使用多个 iperfs 测试 udp 性能，因为具有多个线程的单个 iperf 似乎不起作用）。所有硬件加速都在驱动程序中进行了调整。似乎 udp 性能只是低于标准？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T08:15:47.213

我一直在使用类似的硬件进行一些 UDP 测试，因为我研究了在 Windows 8 Server 中使用[Winsock 注册 I/O 网络扩展 RIO](http://www.serverframework.com/asynchronousevents/2011/10/windows-8-registered-io-networking-extensions.html)可以获得的性能提升。为此，我一直在 Windows Server 2008 R2 和 Windows Server 8 上运行测试。

我还没有开始使用我们的 10Gb 卡进行测试（它们才刚到货），但我之前的测试结果和用于运行它们的示例程序可以[在我的博客上](http://www.serverframework.com/asynchronousevents/2012/03/windows-8-registered-io-performance.html)找到。

我可能会建议的一件事是，通过一个简单的测试，如您展示的对每个数据报所做的工作很少的测试，您可能会发现老式的同步 I/O 比 IOCP 设计更快。随着每个数据报工作负载的增加，IOCP 设计向前迈进了一步，您可以充分利用多个线程。

此外，您的测试机器是背靠背接线（即没有开关）还是通过开关运行？如果是这样，问题可能出在您的交换机性能而不是您的测试机器上吗？如果您使用的是交换机，或者服务器中有多个网卡，您可以针对服务器运行多个客户端，问题可能出在客户端而不是服务器上吗？

您在发送和接收机器上看到的 CPU 使用率是多少？您是否使用 Process Explorer 查看过机器的 cpu 使用情况？这比任务管理器更准确。哪个 CPU 正在处理 nic 中断，您可以通过将它们绑定到另一个 cpu 来改进吗？或更改您的测试程序的亲和力以在另一个 cpu 上运行？您的 IOCP 示例是将其线程分布在多个 NUMA 节点上，还是将它们全部锁定到一个节点？

我希望下周能够进行更多测试，并在完成后更新我的答案。

**编辑：**对我来说，问题是由于 NIC 驱动程序启用了“流控制”，这导致发送方以接收方的速度运行。这有一些不受欢迎的“非分页池”使用特性，关闭流量控制可以让您查看发送方的速度（发送方和接收方之间的网络利用率差异清楚地显示了丢失了多少数据）。[有关更多详细信息，请参阅我的](http://www.lenholgate.com/blog/2012/06/unexpected-causes-of-poor-datagram-send-performance.html)博客帖子。

# javascript - jQuery/HTML5 FileAPI：为什么似乎没有触发拖动事件？

> ID：10544297
> 
> 赞同：0
> 
> 时间：2012-05-11T01:36:00.107
> 
> 标签：javascript, jquery, html, drag-and-drop, fileapi

当我将文件拖到 imageContainer div 上时，为什么这里什么也没发生？控制台中没有任何内容，页面上没有任何内容等。

```
<div id="imageContainer" style="height: 724px; width: 100%; "></div>

...

$('#imageContainer').on({
    dragenter: function dragEnter() {
        console.log('enter');
        $(this).css('background-color', 'lightBlue');
    },
    dragleave: function dragLeave() {
        console.log('leave');
        $(this).css('background-color', 'white');
    },
    dragover: false,
    drop: function dragDrop (e) {
        console.log('drop');
        jQuery.each(e.dataTransfer.files, function (index, file) {
            var fileReader = new FileReader();
            fileReader.onload = (function (file) {
                return function (e) {
                    $(this).append('<div class="dataurl"><strong>' + file.fileName + '</strong>' + e.target.result + '</div>');
                };
            })(file);
            fileReader.readAsDataURL(file);
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T01:41:03.200

当您使用 Firebug 在 Firefox 上运行它时，会说：

```
e.dataTransfer is undefined 
```

所以你想改变它：

```
e.originalEvent.dataTransfer 
```

这是[示例](http://jsfiddle.net/78fdH/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T06:33:58.413

有几件事。

首先确保您使用 http: 而不是 file: 方案加载页面。使用文件：您的放置事件将触发，但 FileReader 将静默失败。

接下来在 FileReader.onload 中添加 html，**即**FileReader。尝试将其添加到 html 元素中。在下面的代码中，#files 指向一个列表。

最后 dataURL 嵌入到 html 中，使用 Elements 检查器检查，但在标记中不可见。

```
$(function () {
    $('#dropTarget').on({
        dragenter: function dragEnter() {
            console.log('enter');
            $(this).css('background-color', 'lightBlue');
        },
        dragleave: function dragLeave() {
            console.log('leave');
            $(this).css('background-color', 'white');
        },
        dragover: false,
        drop: function dragDrop(e) {
            console.log('drop');
            jQuery.each(e.originalEvent.dataTransfer.files, function (index, file) {
                var fileReader = new FileReader();
                fileReader.onload = function () {
                    console.log(this.result);
                    $('#files').append('<div class="dataurl"><strong>' + file.fileName + '</strong>' + this.result + '</div>');
                };

                fileReader.readAsDataURL(file);
            });
        }
    });
}); 
```

# ios - 如何使用与 nib 文件中指定的单元格标识符不同的单元格标识符加载 tableview 单元格

> ID：10544301
> 
> 赞同：0
> 
> 时间：2012-05-11T01:37:05.253
> 
> 标签：ios, nib, identifier, tableviewcell, loadnibnamed

**// 实际问题**
在使用与 nib 中指定的单元格标识符不同的单元格标识符加载 nib 文件（tableviewcell）时，我需要帮助。

**// 我正在做的事情的背景**
我有一个自定义 UITableViewCell，其中包含少量标签、少量图像和少量按钮。所有这些都放在一个 nib 文件中。表格视图单元格的内容需要根据某些条件动态更改，即如果横向则不显示按钮；如果标签中没有要显示的内容，则不显示标签等。左侧的相邻标签/视图应扩展以填充缺少的标签/按钮的空间。

我能够让它工作。我这样做的方法是在`cellForRowAtIndexPath`I
- 删除不需要显示的视图，`removeFromSuperView`并通过
- 调整`frame`并调用`setNeedsDisplay`需要调整的视图。

我使用 nib 文件中提到的相同单元格标识符来使单元格出列。如果返回的单元格为 nil，那么我使用`loadNibNamed:withOwner:options`加载笔尖。但是，我担心这会在来回滚动时导致问题，因为当条件不满足时，被重用的单元格可能没有显示内容所需的视图，因为它们可能已经被删除。

为了解决这个问题，我计划对不同的条件使用不同的单元格标识符，这些条件会触发单元格的不同外观。或者，我也在考虑只隐藏视图并将相邻视图扩展到隐藏视图。这样我就不需要处理不同的单元格标识符。

**Edit2：**
我隐藏和调整相邻视图框架的替代方法满足了我的需要。

但是我仍然想找到我上面描述的实际问题的答案。

**// 潜在的解决方案**
我想知道是否可以通过函数的`options`参数将单元格标识符传递给 nib 加载代码`loadNibNamed`。这可能吗？如果你们能提供一个示例代码来实现这一点，那就太棒了。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T05:02:28.790

您需要做的就是在 nib 中创建多个具有不同标识符的单元格，然后`dequeueReusableCellWithIdentifier`使用适当的标识符进行调用，以获得对适当类型单元格的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T08:34:07.850

我对这个解决方案不是很自豪并且可能会出现问题，但我会在从 nib 加载后尝试设置单元格的标识符。

```
- (id)initWithReuseIdentifier:(NSString *)reuseIdentifier
{
    self = [[NSBundle mainBundle] loadNibNamed:@"MyCell" owner:nil options:nil].lastObject;
    [self setValue:reuseIdentifier forKeyPath:@"_reuseIdentifier"];

    // ...

    return self;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-12T06:57:25.710

您无法更改 nib 中指定的单元重用标识符。[参考](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableViewCell/reuseIdentifier)。您正在谈论的选项字典也不会为您执行此操作。这些选项与 nib 中的代理对象相关。

与其删除子视图，不如简单地隐藏它们。您可以使用 IBOutletCollections 使批量隐藏/取消隐藏更容易。如果需要，您可以将单元格重置为其默认状态`prepareForReuse`。

也看看 UINib - 这可以比 loadNibNamed 更快地从 nob 创建对象，这将有助于您的滚动性能。

# javascript - 使用 SetTimeOut，因此消息不会一个接一个地发送得太快

> ID：10544305
> 
> 赞同：0
> 
> 时间：2012-05-11T01:37:19.067
> 
> 标签：javascript, jquery

我正在做一个小聊天:)

当用户正在输入（或停止输入）时，会向其他用户发出信号，并且仅当用户在输入与否之间切换时（检查 textarea 是否为空）

现在我想防止这些信号一个接一个地发送得太快。我认为一些 settimeout 可以做到这一点，但我不知道如何或将它放在我的代码中的位置：

```
var istyping = false;
var wastyping = false;

chatfield.keyup(function(e) {
    if (e.keyCode != 13) {

        function typesignal(state) {
            channel.send(JSON.stringify({
                username: username,
                type: 'typing',
                message: state
            }));
        }

        if (chatfield.val()) {

            istyping = true;

                if (wastyping==false) {
                    typesignal(1);
                    wastyping = true;
                }

        } else {

            istyping = false;

                if (wastyping==true) {
                    typesignal(0);
                    wastyping = false;
                }

        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:36:17.307

你可能会称之为“节流”，我已经在自动完成下拉列表之类的东西上使用了它，这样你就不会在每次击键时都杀死服务器。JS 标准库允许您清除超时，并且在调用 setTimeout 时还返回一个 id。所以如果在一定时间内再次调用该函数，可以使用这个id来清除超时（防止回调在该时间段内被调用）。例如：

```
var timeId;

function throttle(callback, ms) {
    if (timeId) {
      clearTimeout(timeId);
    }

    timeId = setTimeout(callback, ms)
}

chatfield.keyup(function(e) {
  throttle(your_fn, 500);
}); 
```

如果不清楚，setTimeout 会在一定时间后执行一个函数，以毫秒为单位指定为第二个参数。因此，如果我调用 setTimeout(function(){},300) 该函数将在 300 毫秒后调用。我也可以说，“取消”最初的请求。因此，如果我在第一个请求被触发之前收到另一个请求，只需取消它并重新开始。这就是我在上面试图描述的模式:-)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-11T01:44:53.143

我会这样做

```
chatfield.keyup(function(e) {
    if (e.keyCode != 13) {

        function typesignal(state) {
            channel.send(JSON.stringify({
                username: username,
                type: 'typing',
                message: state
            }));
        }

        if (chatfield.val()) {

            istyping = true;

                if (wastyping==false) {
                    typesignal(1);
                    wastyping = true;
                }

        } else {

            istyping = false;

                if (wastyping==true) {
                    typesignal(0);
                    wastyping = false;
                }

        }
    }
function doNothing() { 
}
setTimeout("doNothing()",1000);
}); 
```

# java - 如何在 JPQL 语句中使用类型转换？

> ID：10544307
> 
> 赞同：9
> 
> 时间：2012-05-11T01:37:25.970
> 
> 标签：java, jpa, openjpa, websphere-7

我`Integer`在数据库中有两列（derby 和 db2）。我需要在一个`JPQL`.

`Integer`如果余数是十进制数，则两个列的类型都返回零，例如`0.25`变成`0`等，并且可以理解，因为类型是 int。

例如`SQL`，我可以有这个

`select CAST(column1 as decimal(6,2))/CAST(column2 as decimal(6,2))from Sometable;`

但什么是`JPQL`等价的。

一种选择可能是（我还没有尝试过）是`@Transient`在实体中有一个方法返回 Decimal 类型并在那里进行计算并将其传递给`JPQL`但我宁愿让`SQL`这项工作。

* * *

Mysql 不需要在数据库级别进行强制转换。所以不同 RDBMS 的行为是不同的，这很好。但是 JPQL 应该做什么而不需要使用本机查询来知道此操作需要强制转换为十进制。

添加方言`<property name="openjpa.jdbc.DBDictionary" value="derby"/>`也没有解决它。

*请注意它是 JPA1*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-19T00:11:45.357

你基本上有三个选择。

1.  使用 postload 并让 java 来做。
2.  使用第三个类并在 JPQL 的 Select 语句中使用 New Operator 来调用构造函数，在调用内部，您可以管理将传递给 SQL 的数据类型，但您将得到不止一种对象，只要得到正确的对象就好了从右数组索引。更多关于这个[here](http://openjpa.apache.org/builds/1.0.4/apache-openjpa-1.0.4/docs/manual/jpa_langref.html#jpa_langref_constructor)。
3.  第三次使用像 Idanmo 说的 Native Query。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-17T05:27:18.873

除法运算符对整数参数执行整数除法是一个特征。在 MySQL 中，您必须明确选择`div`整数除法和`/`浮点除法，而在 JPQL 中，选择是自动进行的，就像在 Java 中一样。

所以我建议：

```
select (column1 * 1.0) / column2 from Sometable; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-13T12:38:46.687

AFAIK 没有办法在 JPQL 中进行这种类型的转换。

我建议使用 JPA 的本机查询执行，它可以让您像使用 JDBC 一样运行 SQL 查询。

例如：

```
Query query = em.createNativeQuery("select CAST(column1 as decimal(6,2))/CAST(column2 as decimal(6,2)) from Sometable");

Double result = (Double) query.getSingleResult(); 
```

或者

```
List<Double> results = (List<Double>) query.getResultList(); 
```

# android - 如何将单选按钮用作切换按钮 (Android)？

> ID：10544309
> 
> 赞同：1
> 
> 时间：2012-05-11T01:37:32.147
> 
> 标签：android, radio-button, toggle, togglebutton

出于外观和间距的目的，我需要使用单选按钮作为切换按钮，但对于我的生活，不能让愚蠢的东西改变它的状态。现在有谁可以让一个单选按钮在其选中状态之间切换？我不知道是否有办法通过使用 Radio Group 或一些 if/else 语句组合来欺骗它（尽管当我尝试这个时，它似乎认为它已被检查，即使它不是）。或者也许让一个切换按钮看起来像一个单选按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:50:47.150

[RadioButton](http://developer.android.com/reference/android/widget/RadioButton.html)有几个方法可以让你改变它的状态。

[切换（）](http://developer.android.com/reference/android/widget/CompoundButton.html#toggle%28%29)

[setChecked（布尔值 b）](http://developer.android.com/reference/android/widget/CompoundButton.html#setChecked%28boolean%29)

您称为“切换按钮”的小部件的名称被系统称为[CompoundButton](http://developer.android.com/reference/android/widget/CompoundButton.html)。RadioButton 实际上扩展了 CompoundButton。所以它可以访问所有相同的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-07T18:42:41.997

只需创建自己的`android.support.v7.widget.AppCompatRadioButton`类并覆盖调用的方法`toggle()`

这可以解决问题：

```
@Override
public void toggle(){
  setChecked(!isChecked());
} 
```

# php - 预订表格的加密数据检索

> ID：10544311
> 
> 赞同：0
> 
> 时间：2012-05-11T01:37:39.210
> 
> 标签：php, database, aes, encryption

嗨，我有一个预订系统，它从 AES 加密数据库中提取数据。在数据库中，邮政编码和目的地是加密的，曾经有一个带有列表输入的旧脚本，所以用户可以在列表中选择他们的目的地，因为目的地列表越来越大，我想做一个用户输入的表单在几个字母中，目的地出现使用ajax自动填充。我遇到的问题是，它的拉动数据是加密的。

第一个预订脚本有这一行要解密

```
$areafro = mysql_query("select AREA_NO, AES_DECRYPT(POSTCODE, 'qsi') as POSTCODE, AES_DECRYPT(AREA_NM, 'qsi') as AREA_NM from area_mst where AES_DECRYPT(POSTCODE, 'qsi') LIKE '$char%' group by POSTCODE"); 
```

这是新的预订脚本代码

```
if(isset($_GET['areas']) && isset($_GET['letters'])){
$letters = $_GET['letters'];
$letters = preg_replace("/[^a-z0-9 ]/si","",$letters);
$res = mysql_query("select POSTCODE,AREA_NM from area_mst where (POSTCODE like '".$letters."1' or AREA_NM like '".$letters."1') order by AREATYPE") or die(mysql_error();

while($inf = mysql_fetch_array($res)){
    if($inf["POSTCODE"]!='')
    {
    echo $inf["POSTCODE"]."-".$inf["AREA_NM"]."|";
    }
    else
    {
    echo $inf["AREA_NM"]."|";
    }
} 
```

有人可以帮助我如何解密数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:29:50.387

您在后一个代码中的查询不会解密。注意在旧代码中，你有

```
$areafro = mysql_query("select AREA_NO, AES_DECRYPT(POSTCODE, 'qsi') as POSTCODE,
 AES_DECRYPT(AREA_NM, 'qsi') as AREA_NM from area_mst 
where AES_DECRYPT(POSTCODE, 'qsi') LIKE '$char%' group by POSTCODE"); 
```

但在新代码中，您只是在不解密的情况下提取数据。

```
$res = mysql_query("select POSTCODE,AREA_NM from area_mst 
where (POSTCODE like '".$letters."1' or AREA_NM like '".$letters."1') 
order by AREATYPE") 
```

更改您的新代码以使查询与旧代码中的查询完全相同，

# perl - CAM::PDF 返回非 ascii 字符而不是引号

> ID：10544312
> 
> 赞同：1
> 
> 时间：2012-05-11T01:37:43.767
> 
> 标签：perl, pdf, cam-pdf

我在返回非 ascii 字符时遇到问题。我不确定问题存在于哪个级别。它可能是实际的 PDF 编码、CAM::PDF 使用的解码（即 FlateDecode）或 CAM::PDF 本身。下面返回一个字符串，其中包含用于创建 PDF 的命令（Tm、Tj 等）。

```
use CAM::PDF;

my $filename = "sample.pdf"; 
my $cam_obj = CAM::PDF->new($filename) or die "$CAM::PDF::errstr\n";
my $tree = $cam_obj->getPageContentTree(1);
my $page_string = $tree->toString();
print $page_string; 
```

[您可以在此处](https://www.yousendit.com/download/M3BsanZvYXlEbUtGa2RVag)下载 sample.pdf

Tj 中返回的文本通常有一个非 ASCII 字符。在 PDF 中，实际字符几乎总是单引号或双引号。

在重现此内容时，我发现返回的字符在 PDF 中是一致的，但在 PDF 中有所不同。我还注意到 PDF 正在使用特定的字体文件。我现在正在研究字体文件，看看是否可以将相同的字符映射到不同的二进制值。

:edit: 关于 Windows-1252。我的 PDF 返回一个“Õ”而不是撇号。在 Windows-1252 和 UTF-8 中，Õ 字符是十六进制 0xD5。如果想法是字符是用 Windows-1252 编码的，那么它应该是十六进制的 0x91 或 0x92，但它不是。这就是为什么以下对角色没有任何作用的原因：

```
use Encode qw(decode encode);
my $page_string = 'Õ';
my $characters = decode 'Windows-1252', $page_string;
my $octets = encode 'UTF-8', $characters;
open STS, ">TEST.txt";
print STS $octets . "\n"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:46:26.340

我是 CAM-PDF 的作者。您的 PDF 不合规。从 PDF 1.7 规范，第 3.2.3 节“字符串对象”：

> “在文字字符串中，反斜杠 (\) 用作各种目的的转义字符，例如在字符串中包含换行符、非打印 ASCII 字符、不平衡括号或反斜杠字符本身。[...] \ddd 转义序列提供了一种表示可打印 ASCII 字符集之外的字符的方法。”

如果您有大量的非 ASCII 字符，您可以使用十六进制字符串表示法来表示它们。

编辑：鉴于 a_note 的替代答案，也许我对规范的解释是不正确的。我将不得不重新审视这个......当然，这个领域的规范可能会更清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T23:14:13.577

抱歉打扰，恕我直言，先生，但文件符合要求。第 3.2.3 节进一步指出：

> [\ddd] 表示法提供了一种仅使用 ASCII 字符来指定 7 位 ASCII 字符集之外的字符的方法。**但是，任何 8 位值都可能出现在字符串中。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T17:29:48.687

“接收”——在哪里？你得到“Õ”而不是预期什么？究竟在做什么？你知道windows命令提示符使用dos代码页，而不是windows-1252，对吧？（哎呀，又是新线程......也许我应该在这里注册:-)）

# android - 如何在 Android Ice Cream Sandwich 上使 EditText 可选择但不可编辑？

> ID：10544315
> 
> 赞同：22
> 
> 时间：2012-05-11T01:38:05.293
> 
> 标签：android, android-edittext

我在 Activity 中有一个 ListView，在每个 item 中，我插入一个 EditText 来显示我的文本。我需要拖动手柄来选择文本并复制文本，但不能编辑文本。在 Android ICS 上，我该怎么做？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-06-08T09:49:45.573

`text.setTextIsSelectable(true)`需要 API 11。对于使用较低 API 的用户：在 xml 中使用：

```
android:inputType="none"
android:textIsSelectable="true" 
```

这将使您的 EditText 不可编辑但可选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T01:41:30.353

我认为你可以重写 onKeyDown() 方法，让它除了返回 true 之外什么都不做。它应该从键盘捕获按键并将它们否定，然后才能进入 EditText 中的文本。

您也可以[尝试像这样将 editable 设置](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3aeditable)为 false

```
android:editable="false" 
```

在您的 xml 布局中的 EditText 上。但是我不确定这是否会让你仍然突出和复制，但值得一试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T00:59:01.530

我解决了这个问题。
只需像这样设置 TextView ：

```
text.setTextIsSelectable(true); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-16T16:51:01.103

Althouth`android:editable`已被**弃用**，Lint 建议使用`inputType`，它似乎不起作用。所以`android:editable="false"`显然是所有安卓版本的最佳解决方案。

```
<EditText
    android:id="@+id/editText"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:editable="false"
    android:textIsSelectable="true"
    tools:ignore="Deprecated" /> 
```

# css - 宽度和高度流体设计

> ID：10544319
> 
> 赞同：0
> 
> 时间：2012-05-11T01:38:31.223
> 
> 标签：css

[http://www.juliabailey.com/](http://www.juliabailey.com/)

该网站具有流畅的设计，并且运行良好。

[http://goo.gl/j6snn](http://goo.gl/j6snn)

这是我的网站。流体视图取决于宽度。因此，当我让浏览器变大时，宽度和高度都会变大。但问题是高度太大并且创建了我不想要的滚动条。我没有什么滚动条出现在我的页面上。我认为最好的方法是根据高度的流体视图，因此无论您的浏览器是 800x600 还是 1600x1200，它总是适合浏览器。我该怎么做 ？

这是我的包装代码；

```
#wrapper {
    width:auto;
    height:auto;
    width:80%;
    min-width:550px;
    max-width:1150px;
    margin:50px auto 0 auto;
    z-index:100;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:48:57.490

对类的属性使用百分比。例如：

```
wrapper {
width: 92%;
}
content {
width: 73%;
}
sidebar {
width: 25%
} 
```

输入东西或

您还可以使用 javascript 来检测您需要什么，然后动态更改实现。有点像这样

```
 function dynamicLayout(){ var browserWidth = getBrowserWidth();  
    // Narrow CSS rules 
if (browserWidth < 640){ changeLayout("narrow"); } 
    // Normal (default) CSS rules 
if ((browserWidth >= 640) && (browserWidth <= 960)){ changeLayout("default"); } 

    // Wide CSS rules 
if (browserWidth > 960){ changeLayout("wide"); } } 
```

在您的示例中，您有一个最小宽度属性，这意味着如果它小于您将有滚动条。如果您不想要滚动条，则不能为任何布局元素设置任何静态值，因此它可能会根据浏览器窗口大小进行调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:07:40.470

使用`min-height`and `max-height`，这样浏览器会在到达它们时停止缩放。您的示例滚动条始终可见，即使它是“空的”，这就是它在调整大小时不会跳转的原因。

# entity-framework - WCF 数据服务 - 服务操作不返回相关实体

> ID：10544320
> 
> 赞同：0
> 
> 时间：2012-05-11T01:38:40.540
> 
> 标签：entity-framework, ef-code-first, wcf-data-services

我首先使用 EF 4.3 代码并使用 WCF 数据服务（刚刚发布的 5.0）通过 HTTP 公开数据我发现如果我从浏览器调用服务操作，我可以取回相关实体，但是当我使用客户端应用程序中的服务操作我没有取回相关实体。我一直在研究这个问题，似乎 EF 在引用 ICollection 时使用虚拟关键字启用延迟加载，这在某种程度上阻止了 WCF 数据服务返回实际实体 - 这是真的吗如果我在本地浏览并设置断点我的 getUsersByName 方法我可以看到相关的组实体，但是当它通过线路连接到客户端应用程序时，组实体丢失了。是否有启用此功能的配置。

谢谢，例如

```
 public partial class Group
    {
        public Group()
        {
            this.Users = new HashSet<User>();           
        }

        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int GroupID { get; set; }

        [Required(ErrorMessage = "Please enter a group name")]
        [StringLength(50, ErrorMessage = "The group name is too long")]
        public string GroupName { get; set; }

        [Required]
        public System.DateTime CreatedDate { get; set; }

        [Required]
        public bool Admin { get; set; }

        public virtual ICollection<User> Users { get; set; }

    }
    public partial class User
    {
        public User()
        {
            this.Groups = new HashSet<Group>();
        }

        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int UserID { get; set; }

        public string FirstName { get; set; }

        public string LastName { get; set; }

        [Required(ErrorMessage="Please enter a username")]
        [StringLength(50,ErrorMessage="Username is too long")]
        public string UserName { get; set; }

        [Required(ErrorMessage="Please enter an email address")]
        [RegularExpression(".+\\@.+\\..+",ErrorMessage="Please enter a valid email address")]
        public string Email { get; set; }

        [Required]
        public System.DateTime CreatedDate { get; set; }

        public virtual ICollection<Group> Groups { get; set; }
    }

    public partial class TestContext : DbContext
    {
        public Test()
            : base("name=TestEntities")
        {
        }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            // Tell Code First to ignore PluralizingTableName convention
            // If you keep this convention then the generated tables will have pluralized names.
            modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();

        }

        public DbSet<Group> Groups { get; set; }
        public DbSet<User> Users { get; set; }

    }

    [ServiceBehavior(IncludeExceptionDetailInFaults=true)]
    [JSONPSupportBehavior]
    public class TestSVC : DataService<TestContext>
    {

        // This method is called only once to initialize service-wide policies.
        public static void InitializeService(DataServiceConfiguration config)
        {
            config.SetEntitySetAccessRule("*", EntitySetRights.All);
            config.SetServiceOperationAccessRule("*", ServiceOperationRights.All);
            config.SetServiceActionAccessRule("*", ServiceActionRights.Invoke);
            config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;
            config.UseVerboseErrors = true;
        }        

        [WebGet]
        public User GetUserByName(string userName)
        {
            var user = (from u in this.CurrentDataSource.Users
                       where u.UserName == userName
                       select u).FirstOrDefault();

            return user;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T08:59:20.930

Actually regardless of what you do on the server side with the entity WCF DS will not return expanded entities by default. It's a feature. The reason is size of the message on the wire. The client can request this behavior though (and that should work without making any modifications to the EF entities on the server side).

Let's assume you have a service operation GetProducts. You can issue a query like ~/GetProducts?$expand=Category which will include the Category entities in the result.

You also noted that the client doesn't get to see these, but you do see them in the browser. So are you already using the $expand? If that's the case the problem is solely on the client. Make sure that you request the results using the $expand on the client as well (depends on what code you're using, there's an Expand method in the LINQ on the client for this). And then you can use Fiddler to see if the client actually gets the results back the way you want. If that's the case and you still don't get the results in your client code, it might be due to MergeOptions. Try setting DataServiceContext.MergeOption to OverwriteChanges and try again (but be sure that you're aware of what this setting does).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T04:00:38.890

尝试在构造函数中删除导航属性的初始化，因为它会导致代理对象出现问题。

在序列化中使用延迟加载几乎是不可能的，因为当序列化程序访问导航属性时，相关实体将被加载。这将导致加载整个数据库。因此，您需要禁用延迟加载并使用它`Include`来加载您想要的任何内容，或者您​​可以使用一些启用了延迟加载的 DTO。

# php - 从 Json 获取或提取数据到 php 并插入 mysql 数据库

> ID：10544321
> 
> 赞同：0
> 
> 时间：2012-05-11T01:38:43.833
> 
> 标签：php, mysql, xml, json, yql

任何人都可以帮助我如何从 yql 生成的这个 json 脚本中获取数据。我想将数据存储到从这里抓取的 mysql... 我想提取或抓取数据 AskRealtime、BidRealtime、LastTradeDate、LastTradePriceOnly、LastTradeTime、Ask

```
<?php
session_start();
query= Insert into table .....value ...
?> 
```

我想从下面的 json 做类似上面脚本的事情。如果我可以直接将提取的数据打印到其中一个 html 表中的同一页面而不将其发送到 mysql 并从那里提取数据，那就更好了...

`{

```
"query": {
    "count": 5,
    "created": "2012-05-11T01:14:55Z",
    "lang": "en-US",
    "diagnostics": {
        "publiclyCallable": "true",
        "redirect": {
            "from": "http://datatables.org/alltables.env",
            "status": "301",
            "content": "http://www.datatables.org/alltables.env"
        },
        "url": [
            {
                "execution-start-time": "425",
                "execution-stop-time": "865",
                "execution-time": "440",
                "proxy": "DEFAULT",
                "content": "http://datatables.org/alltables.env"
            },
            {
                "execution-start-time": "884",
                "execution-stop-time": "1097",
                "execution-time": "213",
                "proxy": "DEFAULT",
                "content": "http://www.datatables.org/yahoo/finance/yahoo.finance.quotes.xml"
            },
            {
                "execution-start-time": "1307",
                "execution-stop-time": "1307",
                "execution-time": "0",
                "proxy": "DEFAULT",
                "content": "http://download.finance.yahoo.com/d/quotes.csv?f=aa2bb2b3b4cc1c3c6c8dd1d2ee1e7e8e9ghjkg1g3g4g5g6ii5j1j3j4j5j6k1k2k4k5ll1l2l3mm2m3m4m5m6m7m8nn4opp1p2p5p6qrr1r2r5r6r7ss1s7t1t7t8vv1v7ww1w4xy&s=XAUUSD%3DX,XAGUSD%3DX,PLN12.NYM,PAK12.NYM,USDCAD%3DX"
            }
        ],
        "query": {
            "execution-start-time": "1105",
            "execution-stop-time": "1308",
            "execution-time": "203",
            "params": "{url=[http://download.finance.yahoo.com/d/quotes.csv?f=aa2bb2b3b4cc1c3c6c8dd1d2ee1e7e8e9ghjkg1g3g4g5g6ii5j1j3j4j5j6k1k2k4k5ll1l2l3mm2m3m4m5m6m7m8nn4opp1p2p5p6qrr1r2r5r6r7ss1s7t1t7t8vv1v7ww1w4xy&s=XAUUSD%3DX,XAGUSD%3DX,PLN12.NYM,PAK12.NYM,USDCAD%3DX]}",
            "content": "select * from csv where url=@url and columns='Ask,AverageDailyVolume,Bid,AskRealtime,BidRealtime,BookValue,Change&PercentChange,Change,Commission,ChangeRealtime,AfterHoursChangeRealtime,DividendShare,LastTradeDate,TradeDate,EarningsShare,ErrorIndicationreturnedforsymbolchangedinvalid,EPSEstimateCurrentYear,EPSEstimateNextYear,EPSEstimateNextQuarter,DaysLow,DaysHigh,YearLow,YearHigh,HoldingsGainPercent,AnnualizedGain,HoldingsGain,HoldingsGainPercentRealtime,HoldingsGainRealtime,MoreInfo,OrderBookRealtime,MarketCapitalization,MarketCapRealtime,EBITDA,ChangeFromYearLow,PercentChangeFromYearLow,LastTradeRealtimeWithTime,ChangePercentRealtime,ChangeFromYearHigh,PercebtChangeFromYearHigh,LastTradeWithTime,LastTradePriceOnly,HighLimit,LowLimit,DaysRange,DaysRangeRealtime,FiftydayMovingAverage,TwoHundreddayMovingAverage,ChangeFromTwoHundreddayMovingAverage,PercentChangeFromTwoHundreddayMovingAverage,ChangeFromFiftydayMovingAverage,PercentChangeFromFiftydayMovingAverage,Name,Notes,Open,PreviousClose,PricePaid,ChangeinPercent,PriceSales,PriceBook,ExDividendDate,PERatio,DividendPayDate,PERatioRealtime,PEGRatio,PriceEPSEstimateCurrentYear,PriceEPSEstimateNextYear,Symbol,SharesOwned,ShortRatio,LastTradeTime,TickerTrend,OneyrTargetPrice,Volume,HoldingsValue,HoldingsValueRealtime,YearRange,DaysValueChange,DaysValueChangeRealtime,StockExchange,DividendYield'"
        },
        "javascript": {
            "execution-time": "266",
            "instructions-used": "302754",
            "table-name": "yahoo.finance.quotes"
        },
        "warning": "Unable to sort response according to field 'Ask,Bid,AskRealtime,BidRealtime,LastTradeDate,LastTradePriceOnly,LastTradeTime'.",
        "user-time": "1373",
        "service-time": "653",
        "build-version": "27222"
    },
    "results": {
        "quote": [
            {
                "symbol": "XAUUSD=X",
                "Bid": "1590.9498",
                "AskRealtime": null,
                "BidRealtime": null,
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "1590.5499",
                "LastTradeTime": "9:12pm",
                "Ask": "1590.15"
            },
            {
                "symbol": "XAGUSD=X",
                "Bid": null,
                "AskRealtime": null,
                "BidRealtime": null,
                "LastTradeDate": "5/10/2012",
                "LastTradePriceOnly": "29.136",
                "LastTradeTime": "5:27pm",
                "Ask": null
            },
            {
                "symbol": "PLN12.NYM",
                "Bid": null,
                "AskRealtime": "1486.50",
                "BidRealtime": "1486.00",
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "1486.00",
                "LastTradeTime": "8:44pm",
                "Ask": null
            },
            {
                "symbol": "PAK12.NYM",
                "Bid": null,
                "AskRealtime": "616.00",
                "BidRealtime": "609.40",
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "658.80",
                "LastTradeTime": "8:00pm",
                "Ask": null
            },
            {
                "symbol": "USDCAD=X",
                "Bid": "1.0033",
                "AskRealtime": null,
                "BidRealtime": null,
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "1.0034",
                "LastTradeTime": "9:13pm",
                "Ask": "1.0035"
            }
        ]
    }
} 
```

}`

这个 json 脚本的链接在这里[由 YQL 生成的 Json 脚本](http://query.yahooapis.com/v1/public/yql?q=select%20symbol,%20Ask,Bid,AskRealtime,BidRealtime,LastTradeDate,LastTradePriceOnly,LastTradeTime%20from%20yahoo.finance.quotes%20where%20symbol%20in%20%28%22XAUUSD=X%22,%22XAGUSD=X%22,%22PLN12.NYM%22,%22PAK12.NYM%22,%22USDCAD=X%22%29%20%7C%20sort%28field=%22Ask,Bid,AskRealtime,BidRealtime,LastTradeDate,LastTradePriceOnly,LastTradeTime%22,%20descending=%22true%22%29%0A%09%09&format=json&diagnostics=true&env=http://datatables.org/alltables.env&callback=forex) json 脚本是从[http://jsonlint.com/验证的](http://jsonlint.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:52:37.923

如果我正确理解了您的问题，您是否希望使用该 JSON 并能够访问其中的数据？为了使 JSON 更易于使用，我建议使用以下代码，该代码利用[json_decode 函数](http://php.net/manual/en/function.json-decode.php)将 JSON 转换为 php 可用数组。（我包含了 echo 语句，以便您可以看到生成的关联数组的样子）

```
$yql_json =
'{
"query": {
    "count": 5,
    "created": "2012-05-11T01:14:55Z",
    "lang": "en-US",
    "diagnostics": {
        "publiclyCallable": "true",
        "redirect": {
            "from": "http://datatables.org/alltables.env",
            "status": "301",
            "content": "http://www.datatables.org/alltables.env"
        },
        "url": [
            {
                "execution-start-time": "425",
                "execution-stop-time": "865",
                "execution-time": "440",
                "proxy": "DEFAULT",
                "content": "http://datatables.org/alltables.env"
            },
            {
                "execution-start-time": "884",
                "execution-stop-time": "1097",
                "execution-time": "213",
                "proxy": "DEFAULT",
                "content": "http://www.datatables.org/yahoo/finance/yahoo.finance.quotes.xml"
            },
            {
                "execution-start-time": "1307",
                "execution-stop-time": "1307",
                "execution-time": "0",
                "proxy": "DEFAULT",
                "content": "http://download.finance.yahoo.com/d/quotes.csv?f=aa2bb2b3b4cc1c3c6c8dd1d2ee1e7e8e9ghjkg1g3g4g5g6ii5j1j3j4j5j6k1k2k4k5ll1l2l3mm2m3m4m5m6m7m8nn4opp1p2p5p6qrr1r2r5r6r7ss1s7t1t7t8vv1v7ww1w4xy&s=XAUUSD%3DX,XAGUSD%3DX,PLN12.NYM,PAK12.NYM,USDCAD%3DX"
            }
        ],
        "query": {
            "execution-start-time": "1105",
            "execution-stop-time": "1308",
            "execution-time": "203",
            "params": "{url=[http://download.finance.yahoo.com/d/quotes.csv?f=aa2bb2b3b4cc1c3c6c8dd1d2ee1e7e8e9ghjkg1g3g4g5g6ii5j1j3j4j5j6k1k2k4k5ll1l2l3mm2m3m4m5m6m7m8nn4opp1p2p5p6qrr1r2r5r6r7ss1s7t1t7t8vv1v7ww1w4xy&s=XAUUSD%3DX,XAGUSD%3DX,PLN12.NYM,PAK12.NYM,USDCAD%3DX]}",
            "content": "select * from csv where url=@url and columns=\'Ask,AverageDailyVolume,Bid,AskRealtime,BidRealtime,BookValue,Change&PercentChange,Change,Commission,ChangeRealtime,AfterHoursChangeRealtime,DividendShare,LastTradeDate,TradeDate,EarningsShare,ErrorIndicationreturnedforsymbolchangedinvalid,EPSEstimateCurrentYear,EPSEstimateNextYear,EPSEstimateNextQuarter,DaysLow,DaysHigh,YearLow,YearHigh,HoldingsGainPercent,AnnualizedGain,HoldingsGain,HoldingsGainPercentRealtime,HoldingsGainRealtime,MoreInfo,OrderBookRealtime,MarketCapitalization,MarketCapRealtime,EBITDA,ChangeFromYearLow,PercentChangeFromYearLow,LastTradeRealtimeWithTime,ChangePercentRealtime,ChangeFromYearHigh,PercebtChangeFromYearHigh,LastTradeWithTime,LastTradePriceOnly,HighLimit,LowLimit,DaysRange,DaysRangeRealtime,FiftydayMovingAverage,TwoHundreddayMovingAverage,ChangeFromTwoHundreddayMovingAverage,PercentChangeFromTwoHundreddayMovingAverage,ChangeFromFiftydayMovingAverage,PercentChangeFromFiftydayMovingAverage,Name,Notes,Open,PreviousClose,PricePaid,ChangeinPercent,PriceSales,PriceBook,ExDividendDate,PERatio,DividendPayDate,PERatioRealtime,PEGRatio,PriceEPSEstimateCurrentYear,PriceEPSEstimateNextYear,Symbol,SharesOwned,ShortRatio,LastTradeTime,TickerTrend,OneyrTargetPrice,Volume,HoldingsValue,HoldingsValueRealtime,YearRange,DaysValueChange,DaysValueChangeRealtime,StockExchange,DividendYield\'"
        },
        "javascript": {
            "execution-time": "266",
            "instructions-used": "302754",
            "table-name": "yahoo.finance.quotes"
        },
        "warning": "Unable to sort response according to field \'Ask,Bid,AskRealtime,BidRealtime,LastTradeDate,LastTradePriceOnly,LastTradeTime\'.",
        "user-time": "1373",
        "service-time": "653",
        "build-version": "27222"
    },
    "results": {
        "quote": [
            {
                "symbol": "XAUUSD=X",
                "Bid": "1590.9498",
                "AskRealtime": null,
                "BidRealtime": null,
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "1590.5499",
                "LastTradeTime": "9:12pm",
                "Ask": "1590.15"
            },
            {
                "symbol": "XAGUSD=X",
                "Bid": null,
                "AskRealtime": null,
                "BidRealtime": null,
                "LastTradeDate": "5/10/2012",
                "LastTradePriceOnly": "29.136",
                "LastTradeTime": "5:27pm",
                "Ask": null
            },
            {
                "symbol": "PLN12.NYM",
                "Bid": null,
                "AskRealtime": "1486.50",
                "BidRealtime": "1486.00",
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "1486.00",
                "LastTradeTime": "8:44pm",
                "Ask": null
            },
            {
                "symbol": "PAK12.NYM",
                "Bid": null,
                "AskRealtime": "616.00",
                "BidRealtime": "609.40",
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "658.80",
                "LastTradeTime": "8:00pm",
                "Ask": null
            },
            {
                "symbol": "USDCAD=X",
                "Bid": "1.0033",
                "AskRealtime": null,
                "BidRealtime": null,
                "LastTradeDate": "5/11/2012",
                "LastTradePriceOnly": "1.0034",
                "LastTradeTime": "9:13pm",
                "Ask": "1.0035"
            }
        ]
    }
}
}';

$yql_results = json_decode($yql_json, true);
echo "<pre>".print_r($yql_results, true)."</pre>"; 
```

$yql_json 输入是 json 本身作为字符串（无论您如何收集和存储它），传递给函数的 true 值使函数返回一个关联数组，该数组存储在 $yql_result 中。在此之后，您可以轻松访问它的所有项目。我希望我至少回答了你的部分问题。祝你的项目好运。

# java - 为什么这个本地 ArrayList 会发生变化？

> ID：10544326
> 
> 赞同：0
> 
> 时间：2012-05-11T01:39:48.573
> 
> 标签：java, arraylist

我有一个无法修复的奇怪错误。谁能帮我？谢谢你。

```
ArrayList<Choices> newSecurityChoicesList =
    securityChoicesController.getChoicesList();
System.out.println("first-" + newSecurityChoicesList.size());
securityQuestion.getChoices().clear();
System.out.println("second-" + newSecurityChoicesList.size()); 
```

一些解释：

我创造了这个`newSecurityChoicesList` `ArrayList`。它是方法中的局部变量。第一个系统打印出来的结果是 2。

为什么第二个打印出来的结果是 0？

当然是因为`securityQuestion.getChoices().clear();`方法。但是为什么方法可以改变方法中的局部变量呢？此方法仅在应用程序的最后调用一次。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T01:44:17.417

您正在处理一个引用变量并更改它所引用的对象的属性。因此，虽然方法的局部变量是局部变量，但它指的是传递给该方法的对象。同样，这不是 Java 中的错误，而是您对引用变量的理解存在问题。

如果您不想更改传递给方法的 ArrayList 的状态，请在使用它之前在方法中对其进行深层复制。换句话说，您需要创建一个新的 ArrayList，然后遍历参数 ArrayList，在将原始列表中的每个项目添加到新列表之前对其进行复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:44:39.347

是因为`ArrayList<Choice>`是通过引用保存的，因此您通过两个引用修改同一个对象——一个作为局部变量，另一个在`securityQuestion`对象中

# r - 将结果从一个数据帧移动到数据集

> ID：10544334
> 
> 赞同：0
> 
> 时间：2012-05-11T01:40:59.580
> 
> 标签：r

我正在使用两个不同的数据集，我想将数据从一个移动到另一个。我是这样想的：一个包含结果，与正确的因子（HTm）配对，我想将它们分散到另一个框架上。这是第一帧：

```
 head(five)
    Week      Game.ID      VTm VPts HTm HPts HDifferential VDifferential
  1 1  NFL_20050908_OAK@NE OAK   20  NE   30      10           -10
  2 1 NFL_20050911_ARI@NYG ARI   19 NYG   42            23           -23
  3 1 NFL_20050911_CHI@WAS CHI    7 WAS    9             2            -2
  4 1 NFL_20050911_CIN@CLE CIN   27 CLE   13           -14            14
  5 1  NFL_20050911_DAL@SD DAL   28  SD   24            -4             4
  6 1 NFL_20050911_DEN@MIA DEN   10 MIA   34            24           -24
    VTm.f HTm.f average
  1 OAK    NE 19.4375
  2 ARI   NYG 19.4375
  3 CHI   WAS 19.4375
  4 CIN   CLE 19.4375
  5 DAL    SD 19.4375
  6 DEN   MIA 19.4375

    > tail(five)
        Week              Game.ID VTm VPts HTm HPts HDifferential VDiff
    262   19 NFL_20060114_WAS@SEA WAS   10 SEA   20            10    -10
    263   19 NFL_20060115_CAR@CHI CAR   29 CHI   21            -8      8
    264   19 NFL_20060115_PIT@IND PIT   21 IND   18            -3      3
    265   20 NFL_20060122_CAR@SEA CAR   14 SEA   34            20    -20
    266   20 NFL_20060122_PIT@DEN PIT   34 DEN   17           -17     17
    267   21 NFL_20060205_SEA@PIT SEA   10 PIT   21            11    -11
            VTm.f HTm.f average
      262   WAS   SEA       0
      263   CAR   CHI       0
      264   PIT   IND       0
      265   CAR   SEA       0
      266   PIT   DEN       0
      267   SEA   PIT       0 
```

这是另一个（第一帧的聚合方法）。

```
 head(fiveINFO)
    HTm     HPts     VPts  average
   1 ARI 19.87500 19.00000 19.43750
   2 ATL 24.75000 19.12500 21.93750
   3 BAL 19.37500 13.75000 16.56250
   4 BUF 16.50000 17.37500 16.93750
   5 CAR 25.12500 23.27273 24.19886
   6 CHI 18.77778 14.00000 16.38889

    tail(fiveINFO)
    VTm  HPts   VPts average
 27 SEA 21.00 25.000 23.0000
 28 SF 30.75 12.625 21.6875
 29 STL 28.00 22.000 25.0000
 30 TB 15.75 15.375 15.5625
 31 TEN 28.00 14.750 21.3750
 32 WAS 20.60 18.800 19.7000 
```

作为参考，此数据正在查看 NFL 分数。我想在第 2 帧取 FiveINFO 中的平均值，然后将它们移动到第 1 帧中的相应团队。5 是 266 行，而 FiveINFO 是 32 行 - FiveINFO 包含每个 HTm 仅一次，而 5 包含每个 8-10 次，具体取决于每支球队参加的主场比赛的数量。我发现了几个看起来相似的答案，但数据集要小得多。我不想将两者合并；我希望第二帧的平均数据分布在第一帧中的适当 HTm 值中。

我想我需要为此使用某种 for 循环，但我所做的一切都是引人注目的。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:36:26.667

`total<-merge(five, fiveINFO, by="HTm")`

其中 total 是具有基于 htm 列的五和五信息合并列的数据框。五和五INFO 中不匹配的htm 的值将不被填充。但是，如果你想用 NA 填充，你可以明确地这样做（在合并函数中使用这个选项：`all=TRUE`、all.x 或 all.y = TRUE）。

您还可以删除合并后不需要的额外列。

`total=subset(total,select= -c(HPts,VPts))` #用于从合并的数据框中删除列 HPts、VPts

# .net - 从模板创建的项目具有错误的解决方案属性

> ID：10544340
> 
> 赞同：1
> 
> 时间：2012-05-11T01:41:58.137
> 
> 标签：.net, visual-studio, projects-and-solutions

我有一个只有项目文件和 AssemblyInfo 文件的类库项目模板。这是模板中项目文件的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- This adds default build flavors -->
  <Import Project="..\common.targets" />
  <PropertyGroup>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{$guid1$}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>$safeprojectname$</RootNamespace>
    <AssemblyName>$safeprojectname$</AssemblyName>
    <TargetFrameworkVersion>v4.0</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Properties\AssemblyInfo.cs" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project> 
```

在我使用此模板添加新项目后，错误的属性被添加到解决方案中。这是正在添加的解决方案文件的一部分：

```
 {C12D9BEF-3A1D-4E99-B314-35D92D8F5BC1}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
    {C12D9BEF-3A1D-4E99-B314-35D92D8F5BC1}.Debug|Any CPU.Build.0 = Debug|Any CPU
    {C12D9BEF-3A1D-4E99-B314-35D92D8F5BC1}.Debug|x86.ActiveCfg = Debug|Any CPU
    {C12D9BEF-3A1D-4E99-B314-35D92D8F5BC1}.Release|Any CPU.ActiveCfg = Debug|Any CPU
    {C12D9BEF-3A1D-4E99-B314-35D92D8F5BC1}.Release|Any CPU.Build.0 = Debug|Any CPU
    {C12D9BEF-3A1D-4E99-B314-35D92D8F5BC1}.Release|x86.ActiveCfg = Debug|Any CPU 
```

如您所见`Debug|Any CPU`，为`Release`配置指定。我应该怎么做才能使模板正常工作？

# css - 未在 CSS 文件中使用的图像

> ID：10544341
> 
> 赞同：2
> 
> 时间：2012-05-11T01:42:07.770
> 
> 标签：css, browser

他们怎么了？它们是由浏览器加载的吗？

我是否应该将我的 CSS 文件拆分为更多样式表，以便只在页面上加载所使用的 CSS/图像的图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:56:42.913

看到人们在说我在评论中所说的相同的话，我想我应该将其添加为答案。

我打算推荐firebug，但我相信直到你在html中引用它们之后才会下载图像。您可以使用 chrome 或 ie 或 firebug 开发人员工具确认这一点。至于分割 css，我只会在你有一个过大的 css 文件时这样做，或者你需要为不同的 css 文件分割它以获得浏览器功能，即你有特定于 ie7 或 ie 8 的样式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:46:24.977

浏览器只会下载页面上实际使用的图像。因此，除非在页面上应用了 CSS 规则，否则不会下载在 CSS 中指定为背景图像的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T01:48:35.447

您可以使用 Firebug 或其他类似程序来查看浏览器加载了什么；但是，我相信答案是，由于从未创建过 DOM 元素，因此永远不会从服务器请求图像。没有浪费带宽或加载时间（除了多几个字节的 CSS，但这不应该是太多的开销。）

# asp.net-mvc-3 - 检查单选按钮

> ID：10544345
> 
> 赞同：0
> 
> 时间：2012-05-11T01:42:43.107
> 
> 标签：asp.net-mvc-3, radio-button

我想根据@helper 方法的“culture”变量中设置的文化检查单选按钮。在调试期间，我知道变量已设置；它只是不检查英语或西班牙语单选按钮。

有人可以告诉我如何根据下面的代码来做到这一点，或者如果代码有更简单的方法，那也可以。我正在使用 MVC 3 Razor。

```
@helper selected(string c, string culture)
    {
        if (c == culture)
        {
            @:checked="checked"
        }  
    }

<script type="text/javascript">
    $(function () {
        $("input[type='radio']").click(function () {
            $(this).parents("form").submit();
        });

        // highlight selected language
        $("input[type='radio']:checked").next().css("font-weight", "bold");
    });
</script>

@using (Ajax.BeginForm("SetCulture", "Home", new AjaxOptions { UpdateTargetId = "setCulture" }))
{
    <fieldset id="setCulture">
        <legend>@Resources.SelectCulture</legend>
        <input name="culture" id="en-us" value="en-us" type="radio" @selected("en-us", culture) />
        <label for="en-us">
            English</label>
        <br />
        <input name="culture" id="es-es" value="es-es" type="radio" @selected("es-es", culture) />
        <label for="es-es">
            Español</label>
        <br />
    </fieldset>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:29:18.147

如果您的文化变量等于“en-us”或“es-es”，那么您已经拥有的应该可以工作。我不认为它等于你认为它的作用。你可以试试

```
<input name="culture" id="testing" value="testing" type="radio" @selected("testing","testing") /> 
```

测试你有什么。

也就是说，我建议使用`RadioButtonFor`具有强类型视图的方法

```
public class YourViewModel
{
    public string Culture { get; set; }
    // Other properties
}

@model YourViewModel

@*Rest of view*@

@Html.RadioButtonFor(m => m.Culture, "en-us")
@Html.RadioButtonFor(m => m.Culture, "es-us") 
```

# pentaho - 指定的查询在此处不可执行 - pentaho 报告

> ID：10544347
> 
> 赞同：2
> 
> 时间：2012-05-11T01:43:18.417
> 
> 标签：pentaho

所以我在 Pentaho Report Designer 3.9 中设计了一个报告，并在我的机器上预览并运行它，一切正常。

我有一个输入参数，它是一个下拉列表，并从名为 Vertical-List 的查询中获取其值。

现在下拉菜单在我的机器上工作。但是，当我将报告发布到 Online 界面并尝试访问它时，我收到一条消息，提示“指定的查询 'Vertical-List' 在此处不可执行”。我不知道这意味着什么以及该怎么做。它今天早上工作，突然停止工作。

请大哥帮忙。

这是生成下拉列表的查询

```
SELECT
     `verticals`.`vertical_id`,
     `verticals`.`vertical_name`
FROM
     `verticals` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:43:24.630

仔细检查您的数据源和查询，尤其是参数。如果您有参数，请记住在 Pentaho 报表设计器中将参数读取为`${parameter_name}`.

还要仔细检查您是否已在 BI 服务器中定义了数据源。

# grails - Grails executeQuery 给了我“没有这样的属性”异常

> ID：10544349
> 
> 赞同：0
> 
> 时间：2012-05-11T01:43:40.223
> 
> 标签：grails, hql, grails-orm

我有一个名为 Event 的域类：

```
class Event{
    String eventID // an ID for the event, (there are multiple events with same eventID)
    .....
} 
```

在我的 eventService 类中，我想获取具有不同 eventID 的所有事件，所以我有以下查询：

```
Event.executeQuery("select distinct e.eventID from Event e", [max: max, offset: offset]) 
```

根据[grails 文档](http://grails.org/doc/2.0.x/ref/Domain%20Classes/executeQuery.html)，它应该可以工作。但是，我收到此错误：

```
| Error 2012-05-10 18:14:09,643 [http-bio-8080-exec-9] ERROR errors.GrailsExceptionResolver  - MissingPropertyException occurred when processing request: [POST] /events/event/list - 
No such property: id for class: java.lang.String. Stacktrace follows:
Message: No such property: id for class: java.lang.String

Line | Method
->>   35 | run                 in C__src_Event_events_grails_app_views_event__List_gsp
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
|     18 | render . . . . . .  in org.events.EventController
|     67 | list . . . . . . .  in     ''
|   1110 | runWorker           in java.util.concurrent.ThreadPoolExecutor
|    603 | run . . . . . . . . in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run                 in java.lang.Thread 
```

我对 grails 相当陌生，任何帮助将不胜感激。顺便说一句，我正在使用 Grails 2.0.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:55:12.907

问题在于，通过包含分页参数（最大值和偏移量），您正在触发框架尝试创建 PagedResultList。

PagedResultList 期望保存具有 id 的域对象。

但是，您的 select 语句返回字符串。因此，String类没有id属性的消息。

如果您删除分页参数，它应该可以工作，并且您应该只获取字符串列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T18:50:52.287

我想出了答案，有两种方法可以做到这一点。GreyBeardedGeek 的回答部分正确。

**第一种方法**

```
def eveIdList = Event.executeQuery("select distinct e.eventID from Event e", [max: max, offset: offset]) 
```

**第二种方法** 获取 eventID 列表：

```
def eveIdList = Event.createCriteria().list{
    projections{
        distinct("eventID")
    }
    firstResult(offset?:0)
    maxResults(max?:10)
} 
```

我得到了长度 = 最大值和偏移量的字符串列表。我收到错误是因为我试图为每个 eventID 字符串执行 String.id 。为了获取具有相应 eventID 的域对象，我这样做：

```
def eveList = []
eveIdList.each{
    eveList << Event.findByEventID(it as String)
} 
```

**我的问题**

*   他们有效率吗？
*   一种方法比另一种更有效吗？
*   有没有更好的方法来解决这个问题？

# node.js - Socket.IO 和 Node.js 核心集群

> ID：10544350
> 
> 赞同：3
> 
> 时间：2012-05-11T01:44:05.513
> 
> 标签：node.js, websocket, redis, express, socket.io

是否可以将 Socket.IO 与 Node 的核心集群（不是过时的模块）一起使用？

我可以分叉多个工人，它似乎工作正常；但是，打开连接时出现错误：`solve: warn - client not handshaken client should reconnect`

这是相关的代码片段（删除了一些简单的东西，例如 expressjs 配置）：

```
if ( cluster.isMaster ) {
    for ( var i = 0; i < numCPUs; i++ ) {
        cluster.fork();
    }
} else {
    app.get('/', function (req, res) {
        res.sendfile( __dirname + '/public/html/index.html' );
    });

    io.configure( function() {
        var RedisStore = require('socket.io').RedisStore,
            opts = { host: 'localhost', port: 8888 };

        io.set('store', new RedisStore( { redisPub: opts, redisSub: opts, redisClient: opts } ));
    });

    app.listen( 8888 );

    io.sockets.on('connection', function (socket) {
        socket.emit( 'some', 'data' );
    });
} 
```

我已经尝试过使用和不使用 RedisStore 以及这个网站上的技巧（我认为现在已经过时了）：[http ://www.danielbaulig.de/socket-ioexpress/](http://www.danielbaulig.de/socket-ioexpress/)

我还查看了[http://www.ranu.com.ar/2011/11/redisstore-and-rooms-with-socketio.html](http://www.ranu.com.ar/2011/11/redisstore-and-rooms-with-socketio.html)上的代码，尽管我看不出该代码有什么不同使用内存存储。

我所有的测试连接都使用 Websockets (RFC 6455)。如果我将 numCPUs 设置为等于 1，这可以正常工作。

Node.js 版本 0.6.17 Socket.io 版本 0.9.5 Expressjs 版本 2.5.9

更新 - 包括控制台输出（注意，在这次尝试中，连接最终确实有效，尽管它引发了相同的错误）：

```
info  - socket.io started
info  - socket.io started
info  - socket.io started
info  - socket.io started
info  - socket.io started
debug - served static content /socket.io.js
debug - client authorized
info  - handshake authorized 17644195072103946664
debug - setting request GET /socket.io/1/websocket/17644195072103946664
debug - set heartbeat interval for client 17644195072103946664
debug - websocket writing 7:::1+0
warn  - client not handshaken client should reconnect
info  - transport end (error)
debug - set close timeout for client 17644195072103946664
debug - cleared close timeout for client 17644195072103946664
debug - cleared heartbeat interval for client 17644195072103946664
debug - discarding transport
debug - client authorized
info  - handshake authorized 16098526291524652257
debug - setting request GET /socket.io/1/websocket/16098526291524652257
debug - set heartbeat interval for client 16098526291524652257
debug - websocket writing 7:::1+0
warn  - client not handshaken client should reconnect
info  - transport end (error)
debug - set close timeout for client 16098526291524652257
debug - cleared close timeout for client 16098526291524652257
debug - cleared heartbeat interval for client 16098526291524652257
debug - discarding transport
debug - client authorized
info  - handshake authorized 13419993801561067603
debug - setting request GET /socket.io/1/websocket/13419993801561067603
debug - set heartbeat interval for client 13419993801561067603
debug - client authorized for 
debug - websocket writing 1::
debug - websocket writing 5:::{"some":"data","args":[11354]}
debug - websocket writing 5:::{"some":"data","args":[36448]} 
```

这是控制台输出在失败时结束的方式（大约 10 次失败中的 9 次）：

```
info  - transport end by forced client disconnection
debug - websocket writing 0::
info  - transport end (booted)
debug - set close timeout for client 1639301251431944437
debug - cleared close timeout for client 1639301251431944437
debug - cleared heartbeat interval for client 1639301251431944437
debug - discarding transport
debug - got disconnection packet
debug - got disconnection packet 
```

更新 - 在 github 上添加了可能票证的链接：

[https://github.com/LearnBoost/socket.io/issues/881](https://github.com/LearnBoost/socket.io/issues/881)

[https://github.com/LearnBoost/socket.io/issues/438](https://github.com/LearnBoost/socket.io/issues/438)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T17:16:03.163

看来问题可能与 Socket.IO 随附的节点模块有关。

当我安装 redis ( `npm install hiredis redis`) 并使用 redis 模块为 RedisStore 创建客户端时，一切突然变得完美。我已经用大约 500 个并发连接运行了一个多小时，并且没有看到一个错误，并且每个节点进程都在使用。

hiredis@0.1.14 redis@0.7.2

在端口 6379 上运行 Redis 2.6rc3。

更新：在 Node.s 0.8 中，集群库看起来应该更加成熟，所以上面的代码/问题可能会过时：[http ://nodejs.org/docs/v0.7.8/api/cluster.html](http://nodejs.org/docs/v0.7.8/api/cluster.html)

# ios - UITableView 中的单元格问题

> ID：10544356
> 
> 赞同：0
> 
> 时间：2012-05-11T01:44:52.723
> 
> 标签：ios, xcode, uitableview, pushviewcontroller

我正在编写一个简单的清单应用程序。我有两个 UIViewControllers。第一个在 UITableView 中显示清单。我正在使用 UIBarButtonItem 将第二个视图推送到堆栈上以添加新任务。所有任务都保存在一个数组中。

除了一件事，一切都很好。

如果我进入编辑模式并从表视图中删除一个项目，该项目将从表视图和数组中删除——这部分似乎工作正常。但是，删除项目后，如果我点击栏按钮项目添加新任务，我会遇到问题。

我的 NSLogs 告诉我新项目已添加到数组中，但是当我返回表视图时，显示的是已删除项目而不是新项目。表格视图似乎正在重用出队的单元格（不确定）。

我究竟做错了什么？

CLCheckListViewController.m

```
#import "CLCheckListViewController.h"
#import "CLTaskFactory.h"
#import "CLTaskStore.h"
#import "CLAddTaskViewController.h"

@implementation CLCheckListViewController
{
    __weak IBOutlet UITableView *checkList;
}

- (id)init
{
    self = [super init];
    if (self) {
        // add five sample tasks
        CLTaskFactory *task1 = [[CLTaskFactory alloc] init];
        [task1 setTaskName:@"Task 1"];
        [task1 setDidComplete:NO];
        [[CLTaskStore sharedStore] addTask:task1];

        CLTaskFactory *task2 = [[CLTaskFactory alloc] init];
        [task2 setTaskName:@"Task 2"];
        [task2 setDidComplete:NO];
        [[CLTaskStore sharedStore] addTask:task2];

        CLTaskFactory *task3 = [[CLTaskFactory alloc] init];
        [task3 setTaskName:@"Task 3"];
        [task3 setDidComplete:NO];
        [[CLTaskStore sharedStore] addTask:task3];

        CLTaskFactory *task4 = [[CLTaskFactory alloc] init];
        [task4 setTaskName:@"Task 4"];
        [task4 setDidComplete:NO];
        [[CLTaskStore sharedStore] addTask:task4];

        CLTaskFactory *task5 = [[CLTaskFactory alloc] init];
        [task5 setTaskName:@"Task 5"];
        [task5 setDidComplete:NO];
        [[CLTaskStore sharedStore] addTask:task5];
    }
    return self;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [checkList reloadData];
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    // create edit button
    [[self navigationItem] setLeftBarButtonItem:[self editButtonItem]];

    // create title
    [[self navigationItem] setTitle:@"Checklist"];

    // create add guest button
    UIBarButtonItem *bbi = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target:self action:@selector(pushAddTask)];
    [[self navigationItem] setRightBarButtonItem:bbi];
}

- (void)pushAddTask
{
    CLAddTaskViewController *advk = [[CLAddTaskViewController alloc] init];
    [[self navigationController] pushViewController:advk animated:YES];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [[[CLTaskStore sharedStore] allTasks] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [checkList dequeueReusableCellWithIdentifier:CellIdentifier];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

        // put the tasks into the cell
        [[cell textLabel] setText:[NSString stringWithFormat:@"%@", [[[CLTaskStore sharedStore] allTasks] objectAtIndex:[indexPath row]]]];

        // put the checkbox into the cell's accessory view
        UIButton *checkBox = [UIButton buttonWithType:UIButtonTypeCustom];
        checkBox = [UIButton buttonWithType:UIButtonTypeCustom];
        [checkBox setImage:[UIImage imageNamed:@"checkbox.png"] forState:UIControlStateNormal];
        [checkBox setImage:[UIImage imageNamed:@"checkbox-checked.png"] forState:UIControlStateSelected];
        checkBox.frame = CGRectMake(0, 0, 30, 30);
        checkBox.userInteractionEnabled = YES;
        [checkBox addTarget:self action:@selector(didCheckTask:) forControlEvents:UIControlEventTouchDown];
        cell.accessoryView = checkBox;
    }
    return cell;
}

- (void)didCheckTask:(UIButton *)button
{
    CGPoint hitPoint = [button convertPoint:CGPointZero toView:checkList];
    hitIndex = [checkList indexPathForRowAtPoint:hitPoint];

    task = [[[CLTaskStore sharedStore] allTasks] objectAtIndex:[hitIndex row]];

    if (task.didComplete) {
        task.didComplete = NO;
    } else {
        task.didComplete = YES;
    }

    NSInteger taskCount = [[[CLTaskStore sharedStore] allTasks] count];
    for (int i = 0; i < taskCount; i++) {
        NSLog(@"%@, status: %@", [[[CLTaskStore sharedStore] allTasks] objectAtIndex:i], [[[[CLTaskStore sharedStore] allTasks] objectAtIndex:i] didComplete]?@"YES":@"NO");
    }

    // toggle checkbox
    button.selected = !button.selected;
}

- (void)setEditing:(BOOL)editing animated:(BOOL)animated
{
    [super setEditing:editing animated:animated];

    // set editing mode
    if (editing) {
        self.navigationItem.title = @"Edit Checklist";
        [checkList setEditing:YES];
    } else {
        self.navigationItem.title = @"Checklist";
        [checkList setEditing:NO];
    }
}

- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle
                                            forRowAtIndexPath:(NSIndexPath *)indexPath
{
    // remove task
    if (editingStyle == UITableViewCellEditingStyleDelete) {

        // remove task from CLTaskStore
        task = [[[CLTaskStore sharedStore] allTasks] objectAtIndex:[indexPath row]];
        [[CLTaskStore sharedStore] removeTask:task];

        // remove guest from table view
        [checkList deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];

        // reload table view
        //[checkList reloadData];
    }
}

- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath
{
    [[CLTaskStore sharedStore] moveTaskAtIndex:[sourceIndexPath row] toIndex:[destinationIndexPath row]];
}

@end 
```

CLAddTaskViewController.m

```
#import "CLAddTaskViewController.h"
#import "CLTaskFactory.h"
#import "CLTaskStore.h"

@implementation CLAddTaskViewController

    - (void)viewDidLoad
    {
        [[self navigationItem] setTitle:@"Add Task"];
    }

    - (void)viewWillDisappear:(BOOL)animated
    {
        [super viewWillDisappear:animated];

        // clear first responder
        [[self view] endEditing:YES];

        // create new task
        CLTaskFactory *newTask = [[CLTaskFactory alloc] init];
        [newTask setTaskName:[newTaskName text]];

        // add new guest to RCGuestStore
        [[CLTaskStore sharedStore] addTask:newTask];
    }

    @end 
```

CLAddTaskFactory.m

```
#import "CLTaskFactory.h"

@implementation CLTaskFactory

@synthesize taskName;

- (void)setDidComplete:(BOOL)dc
{
    didComplete = dc;
}

- (BOOL)didComplete
{
    return didComplete;
}

- (NSString *)description
{
    // override the description
    NSString *descriptionString = [[NSString alloc] initWithFormat:@"%@", taskName];
    return descriptionString;
}

@end 
```

CLAddTaskStore.m

```
#import "CLTaskStore.h"
#import "CLTaskFactory.h"
#import "CLCheckListViewController.h"

@implementation CLTaskStore

+ (id)allocWithZone:(NSZone *)zone
{
    return [self sharedStore];
}

+ (CLTaskStore *)sharedStore
{
    static CLTaskStore *sharedStore = nil;
    if (!sharedStore) {
        sharedStore = [[super allocWithZone:nil] init];
    }
    return sharedStore;
}

- (id)init
{
    self = [super init];
    if (self) {
        allTasks = [[NSMutableArray alloc] init];
    }
    return self;
}

- (NSMutableArray *)allTasks
{
    return allTasks;
}

- (void)addTask:(CLTaskFactory *)task
{
    [allTasks addObject:task];
    NSLog(@"Task added: %@", task);
}

- (void)removeTask:(CLTaskFactory *)task
{
    // remove the item for the deleted row from the store
    [allTasks removeObjectIdenticalTo:task];

    NSInteger taskCount = [allTasks count];
    NSLog(@"Removed: %@, there are now %d remaining tasks, they are:", task, taskCount);
    for (int i = 0; i < taskCount; i++) {
        NSLog(@"%@, status: %@", [[[CLTaskStore sharedStore] allTasks] objectAtIndex:i], [[[[CLTaskStore sharedStore] allTasks] objectAtIndex:i] didComplete]?@"YES":@"NO");
    }
}

- (void)moveTaskAtIndex:(int)from toIndex:(int)to
{
    if (from == to) {
        return;
    }

    CLTaskFactory *task = [allTasks objectAtIndex:from];
    [allTasks removeObjectAtIndex:from];
    [allTasks insertObject:task atIndex:to];
}

@end 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:56:14.900

> 表视图似乎正在重用出队的单元格

这正是它的作用；它尽可能重复使用单元格。如果您有足够的项目使表格视图滚动，您也会看到同样的问题。

在`-tableView:cellForRowAtIndexPath:`您必须始终设置单元格以显示给定行索引的正确内容，无论是否`dequeueReusableCellWithIdentifier:`返回单元格。

基本上：

*   如果`-dequeueReusableCellWithIdentifier:`返回 nil，则创建一个新单元格并将您的复选框按钮添加到其中。

*   然后在这个新单元格或从返回的单元格上设置单元格文本和按钮状态`-dequeueReusableCellWithIdentifier:`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T03:44:35.940

达伦是正确的。如果您在这里查看您的代码：

```
if (!cell) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    // put the tasks into the cell
    [[cell textLabel] setText:[NSString stringWithFormat:@"%@", [[[CLTaskStore sharedStore] allTasks] objectAtIndex:[indexPath row]]]];

    // put the checkbox into the cell's accessory view
    UIButton *checkBox = [UIButton buttonWithType:UIButtonTypeCustom];
    checkBox = [UIButton buttonWithType:UIButtonTypeCustom];
    [checkBox setImage:[UIImage imageNamed:@"checkbox.png"] forState:UIControlStateNormal];
    [checkBox setImage:[UIImage imageNamed:@"checkbox-checked.png"] forState:UIControlStateSelected];
    checkBox.frame = CGRectMake(0, 0, 30, 30);
    checkBox.userInteractionEnabled = YES;
    [checkBox addTarget:self action:@selector(didCheckTask:) forControlEvents:UIControlEventTouchDown];
    cell.accessoryView = checkBox;
} 
```

您唯一的设置单元格`if(cell == nil)` 将您的代码更改为

```
if (!cell) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
// put the tasks into the cell
[[cell textLabel] setText:[NSString stringWithFormat:@"%@", [[[CLTaskStore sharedStore] allTasks] objectAtIndex:[indexPath row]]]];

// put the checkbox into the cell's accessory view
UIButton *checkBox = [UIButton buttonWithType:UIButtonTypeCustom];
checkBox = [UIButton buttonWithType:UIButtonTypeCustom];
[checkBox setImage:[UIImage imageNamed:@"checkbox.png"] forState:UIControlStateNormal];
[checkBox setImage:[UIImage imageNamed:@"checkbox-checked.png"] forState:UIControlStateSelected];
checkBox.frame = CGRectMake(0, 0, 30, 30);
checkBox.userInteractionEnabled = YES;
[checkBox addTarget:self action:@selector(didCheckTask:) forControlEvents:UIControlEventTouchDown];
cell.accessoryView = checkBox; 
```

# android - 如何阻止 Android 平板电脑重新映射设备轴

> ID：10544361
> 
> 赞同：2
> 
> 时间：2012-05-11T01:46:22.783
> 
> 标签：android, vector, orientation, tablet, axes

***我有一个非常具体的问题。***

* * *

对于默认方向为纵向的 Android 设备（大多数手机），设备的轴方向如下：

![手机的原生纵向](../Images/72e938ea5a9092755000ffb41c0d2e2a.png)

因此，当尝试使用向量和矩阵数学并且我需要为设备找到正确的、向上和向外的向量时，我可以使用以下方法，**它非常有效**：

```
SensorManager.getRotationMatrix(tempRot, null, gravVals, geoMagVals);
SensorManager.remapCoordinateSystem(tempRot, SensorManager.AXIS_Y, SensorManager.AXIS_MINUS_X, rot);

Vector right  = new Vector(rot[0], rot[3], rot[6]); // the direction the right side of the phone is pointing
Vector up     = new Vector(rot[1], rot[4], rot[7]); // the direction the top side of the phone is pointing
Vector screen = new Vector(rot[2], rot[5], rot[8]); // the direction the screen is facing 
```

* * *

对于默认方向为横向的 Android 设备（例如 Xoom），设备的轴方向如下：

![平板电脑原生横向](../Images/b123df7129f2471205bcf664abe48ddf.png)

因此，为了实现与手机上相同的向量，我使用以下**有问题**的方法：

```
SensorManager.getRotationMatrix(tempRot, null, gravVals, geoMagVals);
SensorManager.remapCoordinateSystem(tempRot, SensorManager.AXIS_X, SensorManager.AXIS_Y, rot); // this isn't really doing anything in this case

Vector right  = new Vector(rot[0], rot[3], rot[6]); // the direction the right side of the tablet is pointing
Vector up     = new Vector(rot[1], rot[4], rot[7]); // the direction the top side of the tablet is pointing
Vector screen = new Vector(rot[2], rot[5], rot[8]); // the direction the screen is facing 
```

* * *

所以它在手机上运行良好，但在平板电脑上它只适用于左右和上下移动，但是当我尝试旋转设备时，突然数据不再有意义。我相信它实际上是在改变平板电脑的轴，使它们与默认的纵向轴（如手机）相匹配，并根据我拿着平板电脑的方式在 4 个可能的方向之间来回切换。

我的应用程序在清单中使用以下代码锁定在横向模式：

```
<activity android:screenOrientation="landscape" android:configChanges="keyboardHidden|orientation" .... /> 
```

以及该方法的推荐实现：

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
} 
```

我不明白为什么当我明确告诉它不要改变它的方向时，它仍然会改变它的方向。该应用程序在 Android 2.2 中运行，而平板电脑正在运行 3.0.1，因此清单中不需要“screenSize”标志（尽管我尝试过，但也没有帮助）。当这些奇怪的数据开始传入时，您会期望会调用一些事件方法，但是“onConfigurationChanged”和“onWindowAttributesChanged”都没有被调用，并且“Display.getRotation()”和“Display.getOrientation()”都是始终保持在 0。

谁能告诉我如何获得平板电脑右侧、平板电脑顶部和平板电脑屏幕指向的三个向量？以及如何停止旋转平板电脑引起的问题。

[这是 nVidia 关于 Xoom 的信息](http://developer.download.nvidia.com/tegra/docs/tegra_android_accelerometer_v5f.pdf)

# php - SQL注入：这条线安全吗？

> ID：10544362
> 
> 赞同：1
> 
> 时间：2012-05-11T01:46:24.360
> 
> 标签：php, sql, code-injection

我有这条线：

```
$sql = "UPDATE votes SET up=up+1 WHERE id='{$p}'"; 
```

现在从我所读到的一种 sql 注入方式是由于没有正确“关闭” sql 查询而导致黑客可以添加额外的信息。

所以我的问题是，这条线对我来说是安全的吗？`up=up+1`它没有被“关闭”，但如果我这样设置它，`up='up+1'`这对我来说使它“关闭”它不起作用。

如果`int(11)`这有什么不同的话。

**更新：**

`$p`使用功能进行消毒

```
function sanitize($foo) { 
if(get_magic_quotes_gpc() == true) { 
 $foo = stripslashes($foo); 
} 
return mysql_real_escape_string(htmlspecialchars($foo)); 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T01:47:49.417

不容易受到攻击，`up=up+1`因为它不接受通过变量的用户输入。它只是增加`INT`数据库中已有的值。

但是，如果变量未正确过滤和转义，则可能很容易受到攻击，但`WHERE id='{$p}'` *正如*`$p`您在上面添加的那样，它已被函数清理。希望 sanitize 函数能够检查变量的适当类型（无论是 int 还是 string 或其他）并检查它的适当边界。

与往常一样，最安全的方法是使用准备好的语句和参数化查询，而不是将任何变量直接传递到 SQL 字符串中。PHP 中用于各种 RDBMS 的大多数数据库 API 都支持预准备语句。（但值得注意的是，*不是*`mysql_*()`函数）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:51:39.350

这是不安全的，除非`$p`正确逃脱。否则想象...

> $p = "foo'; DROP TABLE 投票；SELECT '1"

然后你最终会执行类似的东西：

```
UPDATE votes SET up=up+1 WHERE id='foo'; DROP TABLE votes; SELECT '1'; 
```

那不会很漂亮...

# javascript - 如何检查访问者是否来自 jQuery 的推荐

> ID：10544367
> 
> 赞同：1
> 
> 时间：2012-05-11T01:46:44.960
> 
> 标签：javascript, jquery

假设我的网站是 example.com，人们可以直接在浏览器中输入“example.com”来打开它。

但是我想检查人们是否从其他来源访问我的网站，例如谷歌或其他推荐。然后我想为这些访问者添加 jquery modal。可行吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T01:52:08.033

你不需要 JQuery；只是 JavaScript。document.referrer 属性将为您提供访问者在 example.com 之前所在的站点，应该可以为您解决问题。

```
var referrer = document.referrer; 
```

[参考](https://developer.mozilla.org/en/DOM/document.referrer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T06:02:17.717

[Google Analytics](http://www.google.com/analytics/)也提供此推荐信息，您只需申请一个帐户，在您的 body 标签前添加一个脚本。

```
<script>
var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'FILL-IN-YOUR-ACCOUNT']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
</script> 
```

# c++ - 如何将txt文件读取为字符串？

> ID：10544371
> 
> 赞同：0
> 
> 时间：2012-05-11T01:47:07.907
> 
> 标签：c++, imagemagick

我只想读取一个txt文件并接收一个这样的字符串文件

```
Blob rgbBlob;
    string strIccRGBFile = "./icc/RGB.icc";
    string strIccRGBContent = LoadFile(strIccRGBFile);
    rgbBlob.update(strIccRGBContent.c_str(), strIccRGBContent.length());
    image.profile("ICM", rgbBlob); 
```

我如何实现 LoadFile 函数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:00:58.337

```
#include <fstream>
#include <string>
int main()
{
  std::string buff;
   std::fstream fs("filename",std::ios::in | std::ios::ate)
   if(fs.is_open())
   {
       fstream::pos_type size = fs.tellg();
       fs.seekg(0);
       buff.resize(size);
       fs.read(&buff[0],size);
   }
   std::cout << buff << endl;
} 
```

这是一个如何将文件完整地读取到字符串缓冲区的示例。它应该让您对如何进行有一个好主意。

# wordpress - 在 WordPress 中动态生成页面列表

> ID：10544373
> 
> 赞同：0
> 
> 时间：2012-05-11T01:47:20.833
> 
> 标签：wordpress, sorting

我有一个页面列表，我想在网站的侧边栏中列出这些页面。我以前用一些帖子做过，并使用标签自动生成具有特定标签的链接列表。由于您无法向页面添加标签，因此我不确定使用什么将页面组合在一起，然后动态生成页面列表作为侧边栏中的选择菜单。我考虑为每个页面添加一个类，但不确定这将如何准确工作。你们有任何想法都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T01:56:29.230

如果您希望能够对它们进行分组和排序，我会考虑创建一个“自定义分类法”结构。Smashing Magazine 有一篇关于它们的好文章：[http ://wp.smashingmagazine.com/2012/01/04/create-custom-taxonomies-wordpress/](http://wp.smashingmagazine.com/2012/01/04/create-custom-taxonomies-wordpress/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:52:34.160

Wordpress 本身不支持在帖子中同样标记页面。但是，您可以通过安装插件来做到这一点。
检查此链接[TagPages](http://wordpress.org/extend/plugins/tagpages/)
此插件允许您标记您的页面，您将获得如屏幕截图所示的结果。然后您可以根据这些标签获取结果。希望这是你需要的。

![在此处输入图像描述](../Images/8c37855f25f70958dc5bd33b5839ffd4.png)

# android - Galaxy Note 上的动画不流畅

> ID：10544374
> 
> 赞同：2
> 
> 时间：2012-05-11T01:47:21.450
> 
> 标签：android, animation, view, galaxy

我有一个包含一些简单动画的应用程序，只是在用户触摸按钮时隐藏视图：

```
<?xml version="1.0" encoding="UTF-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">
<translate
    android:toYDelta="-200"
    android:duration="250" />
</set> 
```

我已经在三星 Galaxy S (1 GHz, 480x800)、三星 Galaxy Ace (800 MHz, 320x480)、索尼爱立信 Xperia X8 (600 MHz, 320x480) 和 AVD (240x320) 上测试了我的应用程序，动画在所有设备上看起来都很好设备。

但是，当我在两台三星 Galaxy Note（双核 1.4 GHz，800x1280）上测试时，动画看起来很糟糕，不流畅。我不知道为什么，因为这个设备应该是我测试过的设备中功能最强大的，它可以毫无问题地运行其他应用程序，只是我的应用程序的动画看起来很糟糕。为什么会这样？

如果您能给我一些有关根本原因的线索，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T17:42:23.803

最后，我仍然不知道为什么它会发生在 Gingerbread Galaxy Note 上，我怀疑 UI 的硬件加速没有启用以节省电池。无论如何，由于该设备已正式更新为冰淇淋三明治，我想没有必要进一步研究它，因为`hardwareAccelerated="true"`它将适用于新的和/或更新的设备。

dtmilano 的回答未被选中，因为在回答时，Galaxy Note 在 Gingerbread 上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T03:32:23.223

确保为您的应用程序启用了**硬件加速。**在你的清单中添加

```
<application android:hardwareAccelerated="true" ...> 
```

唯一的缺点可能是您的应用程序会消耗更多内存。

# ravendb - 返回 IQueryable 但需要 Raven 统计信息才能插入 TotalResults 标头

> ID：10544377
> 
> 赞同：6
> 
> 时间：2012-05-11T01:47:39.570
> 
> 标签：ravendb, iqueryable, asp.net-web-api, wcf-web-api

我有一个 WebApi 方法，它返回 RavenDB 文档的 IQueryable。调用者需要知道*可能*结果的数量（因为实际结果是有限的/分页的）。

所以，我在 WebApi 方法的末尾有这样的东西：

```
HttpContext.Current.Response.AddHeader("Total-Result-Count", 
    resultsStats.TotalResults.ToString()) 
```

不幸的是，这不起作用，因为 IQueryable 还没有实际执行 - 所以统计信息将为空。

如何将统计响应标头的人口*推迟*到查询执行后？

[更新]

我试图在控制器操作执行后应用 ActionFilter 来捕获结果......但似乎在实际枚举 IQueryable 之前调用了 ActionFilter......

```
public class CountQueryableResultsActionFilter : ActionFilterAttribute
{
    public override void OnActionExecuted(HttpActionExecutedContext filterContext)
    {
        var controllerStats = filterContext.ActionContext.ControllerContext.Controller as IControllerStatistics;
        System.Web.HttpContext.Current.Response.AddHeader("Total-Result-Count", controllerStats.TotalResults.ToString());
    }
} 
```

如果，我在 WebApi 方法的末尾调用了“IQueryable.ToArray()”，然后 Linq 查询立即执行，它生成统计信息，一切正常 - 但这将阻止用户应用他们自己的 OData 过滤器ETC...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-13T23:10:46.303

好的 - 我想通了。

***以下将导致仅发出一个 Raven 查询，该查询返回结果和结果计数。***

感谢[David Ruttka](http://thedevstop.wordpress.com/2012/04/05/adding-odata-inline-count-support-to-the-asp-net-web-api/)在这方面的实验。我已经修改了他的代码以与 RavenDb 一起使用。此代码将按照 RavenDB 的意图通过一个数据库查询返回结果和结果计数。

我在下面附加了我的代码 - 要使用它，您必须`IRavenQueryable<T>`从您的 WebApi 方法（不是`IQueryable<T>`）返回。然后，将 $inlinecount=allpages 附加到您的 Uri 将调用处理程序。此代码不会破坏其他 OData 查询扩展（$take、$skip 等）

*注意：此代码使用“内联”技术，因为统计信息会在消息正文中返回 - 如果您愿意，您可以更改代码以在标头中注入统计信息 - 我只是选择使用 OData 工作的标准方式.*

您可以修改此代码以包含 Raven 生成的任何和所有统计信息。

使用以下代码向 ASP.NET 注册处理程序（在您的 Global.asax.cs 中）

**注册码：**

`GlobalConfiguration.Configuration.MessageHandlers.Add(new WebApi.Extensions.InlineRavenCountHandler());`

**处理程序代码：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Net.Http;
using System.Threading;
using System.Threading.Tasks;
using System.Reflection;
using System.Net.Http.Headers;
using System.Net;

namespace WebApi.Extensions
{
    public class InlineRavenCountHandler : DelegatingHandler
    {
        protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
        {
            if (!ShouldInlineCount(request))
                return base.SendAsync(request, cancellationToken);

            // Otherwise, we have a continuation to work our magic...
            return base.SendAsync(request, cancellationToken).ContinueWith(
                t =>
                {
                    var response = t.Result;

                    // Is this a response we can work with?
                    if (!ResponseIsValid(response)) return response;

                    var pagedResultsValue = this.GetValueFromObjectContent(response.Content);
                    Type queriedType;

                    // Can we find the underlying type of the results?
                    if (pagedResultsValue is IQueryable)
                    {
                        queriedType = ((IQueryable)pagedResultsValue).ElementType;

                        // we need to work with an instance of IRavenQueryable to support statistics
                        var genericQueryableType = typeof(Raven.Client.Linq.IRavenQueryable<>).MakeGenericType(queriedType);

                        if (genericQueryableType.IsInstanceOfType(pagedResultsValue))
                        {
                            Raven.Client.Linq.RavenQueryStatistics stats = null;

                            // register our statistics object with the Raven query provider.
                            // After the query executes, this object will contain the appropriate stats data
                            dynamic dynamicResults = pagedResultsValue;
                            dynamicResults.Statistics(out stats);

                            // Create the return object.
                            var resultsValueMethod =
                                this.GetType().GetMethod(
                                    "CreateResultValue", BindingFlags.Instance | BindingFlags.NonPublic).MakeGenericMethod(
                                        new[] { queriedType });

                            // Create the result value with dynamic type
                            var resultValue = resultsValueMethod.Invoke(
                                this, new[] { stats, pagedResultsValue });

                            // Push the new content and return the response
                            response.Content = CreateObjectContent(
                                resultValue, response.Content.Headers.ContentType);
                            return response;

                        }
                        else
                            return response;
                    }
                    else
                        return response;
               });
        }

        private bool ResponseIsValid(HttpResponseMessage response)
        {
            // Only do work if the response is OK
            if (response == null || response.StatusCode != HttpStatusCode.OK) return false;

            // Only do work if we are an ObjectContent
            return response.Content is ObjectContent;
        }

        private bool ShouldInlineCount(HttpRequestMessage request)
        {
            var queryParams = request.RequestUri.ParseQueryString();
            var inlinecount = queryParams["$inlinecount"];
            return string.Compare(inlinecount, "allpages", true) == 0;
        }

    // Dynamically invoked for the T returned by the resulting ApiController
    private ResultValue<T> CreateResultValue<T>(Raven.Client.Linq.RavenQueryStatistics stats, IQueryable<T> pagedResults)
    {
        var genericType = typeof(ResultValue<>);
        var constructedType = genericType.MakeGenericType(new[] { typeof(T) });

        var ctor = constructedType
            .GetConstructors().First();

        var instance = ctor.Invoke(null);

        var resultsProperty = constructedType.GetProperty("Results");
        resultsProperty.SetValue(instance, pagedResults.ToArray(), null);

        var countProperty = constructedType.GetProperty("Count");
        countProperty.SetValue(instance, stats.TotalResults, null);

        return instance as ResultValue<T>;
    }

        // We need this because ObjectContent's Value property is internal
        private object GetValueFromObjectContent(HttpContent content)
        {
            if (!(content is ObjectContent)) return null;

            var valueProperty = typeof(ObjectContent).GetProperty("Value", BindingFlags.Instance | BindingFlags.NonPublic);
            if (valueProperty == null) return null;

            return valueProperty.GetValue(content, null);
        }

        // We need this because ObjectContent's constructors are internal
        private ObjectContent CreateObjectContent(object value, MediaTypeHeaderValue mthv)
        {
            if (value == null) return null;

            var ctor = typeof(ObjectContent).GetConstructors(BindingFlags.NonPublic | BindingFlags.Instance).FirstOrDefault(
                ci =>
                {
                    var parameters = ci.GetParameters();
                    if (parameters.Length != 3) return false;
                    if (parameters[0].ParameterType != typeof(Type)) return false;
                    if (parameters[1].ParameterType != typeof(object)) return false;
                    if (parameters[2].ParameterType != typeof(MediaTypeHeaderValue)) return false;
                    return true;
                });

            if (ctor == null) return null;

            return ctor.Invoke(new[] { value.GetType(), value, mthv }) as ObjectContent;
        }
    }

    public class ResultValue<T>
    {
        public int Count { get; set; }
        public T[] Results { get; set; }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T08:51:00.653

您可以包装 IQueryable 并拦截 GetEnumerator。示例如下：http: [//blogs.msdn.com/b/alexj/archive/2010/03/01/tip-55-how-to-extend-an-iqueryable-by-wrapping-it .aspx](http://blogs.msdn.com/b/alexj/archive/2010/03/01/tip-55-how-to-extend-an-iqueryable-by-wrapping-it.aspx)。它做了一些不同的事情，但它应该给你这个想法。

此外 - 调用者可以使用 URL 中的 $inlinecount=allpages 使用 OData 协议来执行此操作。虽然我不确定 WebAPI 是否支持这个查询选项。

# .net - 使用 md5 哈希的 Assembly.LoadFrom 不起作用

> ID：10544381
> 
> 赞同：0
> 
> 时间：2012-05-11T01:48:12.293
> 
> 标签：.net, reflection, powershell, powershell-2.0

我的 Assembly.LoadFrom(path, hashValue, hashAlgorithm) 不工作，因“定位程序集与程序集引用不匹配”异常而失败。

这是在powershell 2中。

我已经通过首先使用 Load(bytes) 加载程序集来确定哈希值，这工作正常。使用该结果，我从证据中访问 MD5 哈希值，如下所示：

```
$a= [System.Reflection.Assembly]::Load($bytes)  
$h=$a.Evidence|? {$_ -is [System.Security.Policy.Hash]}  
$md5= $h.MD5 
```

我将哈希值带入另一个 powershell 会话，所以我有一个干净的 AppDomain，并尝试这样做：

```
$md5=[byte[]] (values that I determined)  
[System.Reflection.Assembly]::LoadFrom("pathToMyAssembly", $md5, "MD5") 
```

这就是失败的原因。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T06:27:22.077

您调用的`LoadFrom`方法仅从 .NET 4 开始可用。看到 Powershell 仍然在 .NET 3.5 上运行，调用它是行不通的。

也许您可以只传递`null`给第二个参数。例如：

```
[System.Reflection.Assembly]::LoadFrom("pathToMyAssembly", null, $md5, "MD5") 
```

[根据 MSDN，上面的方法现在已经过时了](http://msdn.microsoft.com/en-us/library/f8c4tzhc.aspx)，但是对于 3.5 你别无选择:)

# linux - Systemtap PPC32 支持

> ID：10544382
> 
> 赞同：6
> 
> 时间：2012-05-11T01:48:13.870
> 
> 标签：linux, debugging, linux-kernel, systemtap

Systemtap 有 PPC32 支持吗？我看到有人提到它在 Intel 和 PPC64 平台上受支持，但关于 PPC32 的信息并不多。

另外，SystemTap 可以用来调试定制的可加载内核模块吗？

谢谢，塞图

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T14:11:28.960

Systemtap 仅支持 ppc64。

如果您使用“Red Hat Enterprise Linux 5 服务器”或其他较旧的发行版，您可以找到 ppc-32 支持。

如果您正在考虑使用任何其他类似的工具，这里有一个比较列表：

[http://sourceware.org/systemtap/wiki/SystemtapDtraceComparison](http://sourceware.org/systemtap/wiki/SystemtapDtraceComparison)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-06T18:27:01.083

Systemtap 还支持 PPC64LE 架构，这基本上是 PPC64 的新 ABI，并以小端模式运行。

```
brenohl@sid:~/stap$ apt-cache show systemtap
Package: systemtap
Priority: optional
Section: universe/devel
Installed-Size: 3066
Maintainer: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Original-Maintainer: Ritesh Raj Sarraf <rrs@debian.org>
Architecture: ppc64el 
```

# c# - TCP接收从后到先，我认为

> ID：10544386
> 
> 赞同：-2
> 
> 时间：2012-05-11T01:49:09.097
> 
> 标签：c#, .net, networking

我有两个用 c# 编写的程序，一个使用 networkStream.beginWrite 命令发送以下内容：

> 1,2,3,4,5......200,201,202...（一些终止字节数组）

现在，我让另一个程序获取字节，由于某种原因它读取的第一件事是：

> 197, 198, 199....（终端数组）

我的问题是，为什么我的 TCP beginWrite 发送它（缓冲区）乱序？

另外，对于一些背景信息，我正在使用 beginReceive 在另一边阅读它。此外，我发送的字节数组是 30000 字节长，我正在将它读入另一台计算机的 1024 字节缓冲区。如果我这样做并使用终止数组拆分它会不会有问题？

这是我在计算机 1 上的发送命令：

```
public bool sendToServer(SocketAsyncEventArgs e, params byte[][] buffer)
        {

            int length = 0;
            foreach (byte[] bytes in buffer)
            {

                length += bytes.Length;
            }
            byte[] buffer2 = new byte[length + 5];
            int index = 0;
            foreach (byte[] bytes in buffer)
            {
                Buffer.BlockCopy(bytes, 0, buffer2, index, bytes.Length);
                index += bytes.Length;
            }

            byte[] eof = { 60, 69, 79, 70, 62 };
            Buffer.BlockCopy(eof, 0, buffer2, index, 5);
           //  netStream.Write(buffer2, 0, buffer2.Length);
             netStream.BeginWrite(buffer2, 0, buffer2.Length, new AsyncCallback(SendCallback), clientSocket);
            //socketEventArg.SetBuffer(buffer2, 0, buffer2.Length);
            //Socket sock = socketEventArg.UserToken as Socket;
            //bool willRaiseEvent = sock.SendAsync(socketEventArg);
            Console.WriteLine("Sending: " + buffer2.Length + " bytes of data");
            //foreach (byte bi in buffer2)
            {
           //     Console.WriteLine(bi);
            }

         //   clientSocket.BeginSend(buffer2, 0, buffer2.Length, 0,
          //      new AsyncCallback(SendCallback), clientSocket);

            return true;
        } 
```

这是我接收该数据的代码：

```
public void AcceptCallback(IAsyncResult ar)
        {

            // Get the socket that handles the client request.
            Socket listener = (Socket)ar.AsyncState;
            Socket handler = listener.EndAccept(ar);
            Console.WriteLine("Connected!");
            // Create the state object.
            MonkeyObject state = new MonkeyObject();
            state.workSocket = handler;
            MonkeyObjects.Add(state);
            listener.BeginAccept(
                       new AsyncCallback(AcceptCallback),
                       listener);
            byte[] buffer = new byte[1024];
            state.currentBuffer = buffer;  
            handler.BeginReceive(buffer, 0, MonkeyObject.BufferSize, 0,
                new AsyncCallback(ReadCallback), state);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T01:55:30.760

您可能想使用像[Wireshark](http://www.wireshark.org/)这样的嗅探器来检查网络上数据包的顺序，以确保代码正在执行您认为正在执行的操作。

但是 TCP 在发送每个数据包时为其分配一个序列号，接收方使用序列号以正确的顺序重新组合消息。数据包不需要以正确的顺序*到达*，事实上它们有时也不需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:07:53.527

一个原因（因为您没有显示代码）是您对多个发送命令使用相同的缓冲区，并且它们会覆盖仍应发送的数据。在这种情况下，您可以发送半随机数据（取决于您何时更新缓冲区以及何时开始实际发送）。

# django - 在 Django 中管理没有 CMS 的页面？

> ID：10544388
> 
> 赞同：0
> 
> 时间：2012-05-11T01:49:18.697
> 
> 标签：django, content-management-system

我对 Django 很陌生，所以请多多包涵。

我的印象是，如果我使用像 Django-CMS 这样的完整 CMS，那么我将无法合并其他应用程序，如 Cartridge、Django-Celery 等。如果它是正确的，那么是否有一种很好的方法来管理帖子/页面没有完整的 CMS？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:17:37.107

不正确 :) 您可以使用任何第三方应用程序，也可以将您自己的应用程序模块与 Django-CMS 一起使用。它非常灵活且易于扩展。我强烈推荐它。

# c++ - 将 Switch 转换为非虚拟多态性

> ID：10544393
> 
> 赞同：1
> 
> 时间：2012-05-11T01:50:52.673
> 
> 标签：c++, polymorphism

我目前有一个 C++ 接口

```
void foo() ... 
```

和许多实现

```
void A::foo();
void B::foo(); 
```

目前 foo 定义如下

```
struct Wrapper
{
    void foo()
    {
        if(state == STATE_A) a.foo();
        else if(state == STATE_B) b.foo();
    }
    union {
        A a;
        B b;
    };
    State state;
}
//....
Wrapper a(STATE_A, existingA);
Wrapper b(STATE_B, existingB);
a.foo(); b.foo(); 
```

有没有更清洁的方法来做到这一点？我有多个类似 foo() 的函数和多个类似 A/B 的类。编写所有案例变得乏味/容易出错。

请注意，我不能使用虚函数（它在 N^5 循环内运行……每秒执行 1000 万次以上）。我希望编译器内联这个，很难。

我曾想过将 A、B 等一起收集并以面向数据的方式计算它们，但不幸的是我不能这样做（由于算法问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:07:18.083

> I want the compiler to inline this, hard.

That's not going to happen.

You're using *runtime polymorphism*. By definition, the compiler *cannot know* which function will be called at call time. You are going to pay for virtual dispatch, whether you do it manually or let the compiler do it.

The absolute *most* inlining you will get is in the calls to the member functions. It still has to do a conditional branch based on a memory access (fetching the "type") to get to the "inline" part. And every new "state" you add will add *another* condition to that branch. At best, this will become a state table... which is no different from just a virtual function pointer: it fetches from a memory address, and uses that to branch to a particular piece of code.

Just like a vtable pointer, only you wasted your time implementing something the compiler could do for you.

I strongly advise you to *profile* this instead of simply assuming that your hand-written method can beat the compiler.

* * *

If you've decided to abandon language-level polymorphism, then you should use a [`boost.variant`](http://www.boost.org/doc/libs/1_49_0/doc/html/variant/tutorial.html) and appropriate visitors instead. Your code would look like this:

```
typedef boost::variant<A, B> Wrapper;

struct FooVisitor : public boost::static_visitor<>
{
  template <typename T> void operator()(T &t) {t.foo()};
}; 
```

You will have to make a `FooVisitor` for every function you want to call. To call it, you do this:

```
Wrapper a = existingA;
boost::apply_visitor(FooVisitor(), a); 
```

Obviously, you can wrap that in a simple function:

```
void CallFoo(Wrapper &a) {boost::apply_visitor(FooVisitor(), a);} 
```

Indeed, you can make a whole template family of these:

```
template<typename Visitor>
void Call(Wrapper &a) {boost::apply_visitor(Visitor(), a);} 
```

Note that parameter passing is not allowed (you have to store the parameters in the visitor itself), but they can have return values (you have to put the return type in the `boost::static_visitor<Typename_Here>` declaration of your visitor).

Also note that `boost::variant` objects have value semantics, so copies will copy the internal object. You can also use the `boost::get()` syntax to get the actual type, but I would not suggest it unless you *really* need it. Just use visitors.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:26:16.847

你有两个选择。您可以在编译时进行函数选择，也可以在运行时进行。如果是运行时，你不会比现有的虚拟机制做得更好。如果是编译时间，您需要为要使用的每种类型使用不同的代码，但您可以使用模板来自动化该过程。

```
template<typename T>
struct Wrapper
{
    void foo()
    {
        t.foo();
    }
    T t;
}; 
```

当然这个例子是高度抽象的，我看不出`Wrapper`直接使用类和模板类型有什么区别。您必须更加充实您的示例才能获得更好的答案。

# razor - Umbraco 5 表面控制器和部分宏

> ID：10544395
> 
> 赞同：2
> 
> 时间：2012-05-11T01:51:30.853
> 
> 标签：razor, umbraco, umbraco5

我正在玩 Umbraco 5（完整的新手），目前正在尝试使用表面控制器和宏。

我创建了一个基本的表面控制器：

```
public class TestSurfaceController : SurfaceController
{
    //
    // GET: /TestSurface/

    [ChildActionOnly]
    public ActionResult GetTest()
    {
        List<Test> test = new List<Test>();
        test.Add(new Test { TestTitle = "Test" });

        return View(test);
    }

} 
```

还有一个部分宏：

```
@inherits PartialViewMacroPage
@using Umbraco.Cms.Web
@using Umbraco.Cms.Web.Macros
@using Umbraco.Framework

@model IEnumerable<Umbraco.Models.Test>

<ul>
  @foreach (var test in Model)
  {
    <li>@test.TestTitle</li>
  }
</ul> 
```

在我的主页模板上，我称之为：

```
@inherits RenderViewPage
@using System.Web.Mvc.Html;
@using Umbraco.Cms.Web;
@{
Layout = "_Layout.cshtml";
 }

@section head
{
@Umbraco.RenderMacro("getTest")
} 
```

如何让它只在 ul 中显示测试？我要么得到一个错误，说如果使用模型，我不能使用继承，然后如果我拿走继承，我会收到一条消息，说提供的模型不符合预期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T14:31:51.383

@inherits RenderViewPage 从您的部分页面中删除此行，如果您愿意，我可以发布一个工作表面控制器操作和部分视图的示例。希望有帮助。工作示例如下，

```
public class MDSSurfaceController : SurfaceController
{        
    public MDSSurfaceController(IRoutableRequestContext routableRequestContext)
        : base(routableRequestContext)
    {
    }
    [ChildActionOnly]
    public PartialViewResult ApartmentListMacro(string apartmentType, string Name, string PropertyRfDicItem, string RatesperNightDict, string SleepsDict, string BedroomsDict, string BathroomsDict, string ViewDict)
    {
        ApartmentListModel apM = new ApartmentListModel();
        //initialize model           
        return PartialView(apM);
    } 
```

然后我的部分观点是

```
@using Umbraco.Cms.Packages.SystemInfo.Models
@model Umbraco.Cms.Packages.SystemInfo.Models.ApartmentListModel
@{
//Html Code
} 
```

# java - Card DeckDriver java

> ID：10544398
> 
> 赞同：0
> 
> 时间：2012-05-11T01:51:52.120
> 
> 标签：java, arrays, sorting

我已经解决了这个问题，现在它可以正常运行了，我的问题是，我的构造函数有什么问题？正如有人指出存在问题但我找不到它，我也想从我的牌组中提取和删除一张卡片，关于如何做这件事的任何指示？

我的甲板类：

```
 import java.util.*;

public class Deck {

    private static Card[] cards;
    private static int counter;

    int i=52;
    int x=0;

    public Deck(Card[] card){
this.cards=card;
    }

    public int createDeck(){

        cards = new Card[52];
        for (int a=0; a<=3; a++)
        {
            for (int b=0; b<=12; b++)
            {
                cards[x] = new Card(a,b);
                x++;
                counter++;
            }
        }

    }

    public Card[] resetDeck(){
        createDeck();
        return cards;
    }

    public static void getRandomCard(){
        int chosen = (int) (52*Math.random())+1;
        System.out.println(cards[chosen]);
    }

    public static int getCounter(){
        return counter;
    }

    public static void print(){

         for(int x=0;x<52;x++){
            System.out.println(Deck.cards[x]);
        }
    }

} 
```

我的 DecktestDriver

```
public class DeckTestDriver {
    public static void main(String[] args){

        Deck test = new Deck(new Card[52]);
        test.createDeck();

        int input =test.getCounter();
        System.out.println("Number of cards in Deck = "+input);

        System.out.print("looking at one card in the deck-----");
        test.getRandomCard();
        System.out.println(".........................");

        System.out.println("Printing full list of cards in deck");
        System.out.println(".........................");

    test.print();
    System.out.println();
    System.out.println(".........................");
    System.out.println();

    System.out.println("Creating New Deck");
    System.out.println(".........................");
    System.out.println();

    Deck test1 = new Deck(new Card[52]);
    test1.createDeck();
    System.out.println();

    System.out.println("Printing new full list of cards in deck");
    System.out.println(".........................");

test1.print();
System.out.println(".........................");
System.out.println();

int input1 =test1.getCounter();
System.out.println("Number of cards in Deck = "+input1);

System.out.print("looking at one card in the deck-----");
test1.getRandomCard();
System.out.println(".........................");

    }
} 
```

我的卡类：

```
public class Card {

    private int CardFaceValue;
    private int CardFaceSuit;
    private int cardFlippedNum;
    private int cardFlippedSuit;
    final static int MIN_VALUE_NUM=1;
    final static String MIN_VALUE_SUIT="Diamond";
    final static int MAX_VALUE_NUM=13;
    final static String MAX_VALUE_SUIT="Spade";

    public Card(int cardFlippedNum,int cardFlippedSuit){
        cardFlippedNumber();
        cardFlippedSuitType();

    }

    public int cardFlippedNumber(){
        int cFn = (int) (Math.random()*13)+1;
        cardFlippedNum = cFn;
        return CardFaceValue;

    }
    public int cardFlippedSuitType(){
        int cFs = (int)(Math.random()*4)+1;

        cardFlippedSuit = cFs;

        return CardFaceSuit;

    }

    public int getNum(){

        return cardFlippedNum;
    }

    public int getSuit(){
        return cardFlippedSuit;

    }

    public String toString() {      
        return (getCardName() + " of " + getSuitName());
    }

    public String getCardName() {
        switch (cardFlippedNum) {           //Change return cases to numbers if you want a number shown e.g: 1 of Hearts
        case 1:
            return ("Ace"); 
        case 2:
            return ("TWO");
        case 3:
            return ("THREE");
        case 4:
            return ("FOURTH");
        case 5:
            return ("FIVE");
        case 6:
            return ("SIX");
        case 7:
            return ("SEVEN");
        case 8:
            return ("EIGHT");
        case 9:
            return ("NINE");
        case 10:
            return ("TEN");
        case 11:
            return ("Jack");
        case 12:
            return ("Queen");
        case 13:
            return ("King");
        default:
            return ("" + cardFlippedNum);
        }
    }

    public String getSuitName() {
        switch (cardFlippedSuit) {
        case 1:
            return ("Diamonds");
        case 2:
            return ("Clubs");
        case 3:
            return ("Hearts");
        case 4:
            return ("Spades");
        default:
            return ("Invalid");
        }
    }

} 
```

我的输出：

```
 Number of cards in Deck = 52
looking at one card in the deck-----Jack of Clubs
.........................
Printing full list of cards in deck
.........................
TWO of Spades
SIX of Clubs
NINE of Hearts
TWO of Diamonds
FOURTH of Clubs
FOURTH of Spades
TEN of Clubs
Jack of Spades
EIGHT of Diamonds
Queen of Diamonds
Queen of Diamonds
TEN of Spades
EIGHT of Hearts
Ace of Hearts
SIX of Diamonds
King of Clubs
THREE of Diamonds
TWO of Hearts
SIX of Spades
SIX of Hearts
THREE of Spades
EIGHT of Hearts
FIVE of Clubs
EIGHT of Diamonds
Jack of Clubs
Ace of Diamonds
NINE of Diamonds
SEVEN of Hearts
TEN of Diamonds
SEVEN of Diamonds
SEVEN of Diamonds
EIGHT of Hearts
FIVE of Hearts
THREE of Clubs
THREE of Spades
FIVE of Spades
TWO of Diamonds
TWO of Clubs
NINE of Hearts
FIVE of Hearts
SIX of Spades
TEN of Diamonds
FOURTH of Hearts
King of Hearts
Ace of Spades
THREE of Spades
NINE of Spades
King of Spades
King of Diamonds
King of Diamonds
Jack of Hearts
THREE of Clubs

.........................

Creating New Deck
.........................

Printing new full list of cards in deck
.........................
Ace of Clubs
SEVEN of Hearts
Queen of Clubs
TWO of Diamonds
King of Spades
Ace of Hearts
Ace of Spades
FOURTH of Spades
NINE of Spades
TWO of Hearts
FOURTH of Hearts
THREE of Hearts
THREE of Spades
Ace of Spades
Ace of Diamonds
Jack of Spades
TWO of Diamonds
Queen of Clubs
SIX of Hearts
TEN of Clubs
EIGHT of Diamonds
TWO of Spades
King of Hearts
TWO of Hearts
King of Hearts
NINE of Spades
FOURTH of Hearts
FIVE of Hearts
SIX of Clubs
Jack of Hearts
FOURTH of Spades
Queen of Clubs
TWO of Clubs
Ace of Clubs
NINE of Spades
TEN of Clubs
SIX of Spades
Jack of Spades
Queen of Spades
TWO of Diamonds
EIGHT of Spades
SIX of Hearts
Ace of Diamonds
FOURTH of Diamonds
Queen of Diamonds
Jack of Hearts
TWO of Clubs
FOURTH of Diamonds
SIX of Diamonds
King of Diamonds
TWO of Spades
TEN of Diamonds
.........................

Number of cards in Deck = 104
looking at one card in the deck-----SIX of Clubs
......................... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T01:55:35.800

后

```
Deck test = new Deck(new Card[52]); 
```

您从未调用过 createDeck()。顺便说一句，您的构造函数和 createDeck 有点精神分裂。您将卡片组传递给构造函数，但您无法在不创建新数组的情况下创建空白卡片组。

*编辑*

1.  关于精神分裂症...

    对于 Deck 的构造函数，你有这个：

    公共甲板（卡[]卡）{ this.cards=card; }

    奇怪的是，我将 Deck 视为卡片的集合，但您将卡片传递到 Deck 中。这可能只是风格问题。但是，我更早地期望：

    公共甲板（）{创建甲板（）；}

2.  顺便说一句，createDeck() 有一个奇怪的地方——它应该返回一个`int`但没有返回语句。也许签名中的“无效”返回会更好。我会把它设为私有的。如果有人想要一个新的甲板，他们应该从字面上使用`Deck deck = new Deck();`，而不是调用`createDeck();`

3.  我永远不会让 Deck 将 Cards[] 数组返回给用户。Deck 中的数据结构和其他内部结构与任何人无关。 `resetDeck()`这样做。不返回 Card[] 意味着 Deck 必须提供诸如`Card getTopCard()`或之类的方法，`Card getRandomCard()`因为它不再“打开和服”。但这是一件好事——我们希望 Deck（一个非常好的名词）有动词式的方法，允许人们操纵甲板。

4.  我看到了一个非标准的循环结构：`for (int b=0; b<=12; b++)` 这*没有*错。但是，一般来说，循环的条件部分是在没有 <= 的情况下编写的。而是使用 <。所以我希望话虽如此`for(int b=0; b<13; b++)` ，当循环不是从零开始时，我会忽略这个半标准。

5.  在卡片中，我看到`public String getCardName()`. 考虑一个稍微不同的实现。关键是通过定义数据结构而不是通过编写显式代码来删除代码行（以及因此的错误）。看看字符串 switch 语句是如何消失的，已被一行*运行时*代码所取代。cardNames 的 String 数组是新的，但它是编译时代码，不太可能引入错误。

> ```
> public class Card {
>     ...
>     private static final String[] cardName = new String[] {'ONE','TWO','THREE', ...etc};
>     ...
>     public String getCardName() {
>         return cardName[cardFlippedNum];
>         }
> 
>     } 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:02:32.330

你需要先创建52张带有循环的卡片，我建议在Deck的构造函数中进行这些操作。用伪写：

```
public Deck() {
    cards = new Cards[52];
    for(i=0; i<52; i++) {
        cards[i] = new Card(i % 13, i / 13);
    }
} 
```

在这个甲板的卡片阵列之后将是这样的：

```
 {0,0}, {1,0}, {2,0}..{12,0}
 {0,1}, {1,1}, {2,1}..{12,1}
 {0,2}, {1,2}, {2,2}..{12,2}
 {0,3}, {1,3}, {2,3}..{12,3} 
```

# php - 使用 JavaScript 重定向到 PHP 脚本中的动态 href

> ID：10544401
> 
> 赞同：1
> 
> 时间：2012-05-11T01:52:44.957
> 
> 标签：php, javascript, jquery, codeigniter, redirect

我有一个下拉用户菜单，其中包含无法正确重定向的子链接。不幸的是，我没有编写前端代码，所以我只是想让它链接到动态 PHP url。顺便说一句，我也在 CodeIgniter 框架内工作。用户的过程中有两次点击（类似于谷歌的用户图标）。1.您单击用户图像和下拉箭头， 2.您看到配置文件、设置、注销。

使用以下脚本，单击下拉箭头会重定向到第一个链接，配置文件，甚至不做下拉动画。有什么想法吗？

这是PHP文件：

```
<div class="user css3"> 
<a href="" class="css3"> <img src="images/user.jpg" alt="user" class="css3" /> </a>
    <div class="child css3">
      <ul class="user_links">
        <li><a href="<?=base_url()?>/profile/view/<?=$userID?>/myfeed">Profile</a></li>
        <li><a href="<?=base_url()?>/settings/">Settings</a></li>
        <li><a href="<?=base_url()?>/login/logout">Logout</a></li>
      </ul>
    </div>
  </div> 
```

这是下拉箭头按钮的 JavaScript：

```
$('div.user').click(function() {
    $('div.user div.child').slideToggle("fast");
    $('div.live div.action div.category div.child, div.live div.action div.sort div.child').slideUp();
    return false;
}); 
```

这是我想出的 JavaScript `<ul>`（我不是 JS 开发人员。哈哈）：

```
$('ul.user_links li a').click(function() {
    document.location($(this).attr("href"));
}); 
```

任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:10:02.043

我在评论中说：

> `<ul>`删除, 然后`return false`从另一个块中删除 js ，它应该可以工作。

Here is why: when you click an anchor, the event starts propagating upwards through the document structure (the DOM). When it reaches another element wired to catch the `click` event, it runs this element's event handler.

When you click the anchor, the `click` handler on `div.user` runs. The last statement there, `return false`, means "stop the event propagation, and prevent the default behavior". On an anchor, the default behavior would be to follow the link. Your code told the browser not to do it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:03:53.913

尝试将 onclick 事件添加到返回 false 的下拉列表中，从而停止链接的默认操作。

```
<a href="" class="css3" onclick="javascript:return false"> <img src="images/user.jpg" alt="user" class="css3" /> </a> 
```

或者更改它，使其只是一个“跨度”标签而不是“a”标签。您还必须更改导致下拉的 JQuery 选择器，以便它查找“span”而不是“a”

我不确定为什么您需要更改链接 3 链接的默认行为，但它们肯定会重定向到 href 位置吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T02:06:24.267

不确定这是否是根本原因，但无论如何使用：

```
window.location = $(this).attr("href"); 
```

代替

```
document.location($(this).attr("href")); 
```

# php - Zend Framework 创建完全动态的路由，同时维护默认路由

> ID：10544403
> 
> 赞同：1
> 
> 时间：2012-05-11T01:53:08.083
> 
> 标签：php, zend-framework, url-routing

我了解如何以以下形式创建简单的自定义路线

```
example.com/archive/:year 
```

但是，我需要以以下形式创建路线

```
example.com/:make/:model 
```

两个路径组件都是变量。同时我想保留默认的 Zend Framework 路由。我该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:17:53.173

如果您使用基于模块的文件架构，您可以维护 zend 框架的默认路由，并为您的模块添加自定义路由。

例如

```
class Example_Bootstrap extends Zend_Application_Module_Bootstrap
{

public function _initModuleRoutes()
{
    $this->bootstrap('FrontController');
    $frontController = $this->getResource('FrontController');
    $router = $frontController->getRouter();

    $route = new Zend_Controller_Router_Route(
        'modulename/:action/*',
        array(
                'module' => 'modulename',
                'controller' => 'modulecontroller',
                'action' => 'index'
        )
    );
    $router->addRoute('routename', $route);

    return $router;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T01:56:56.367

不适用于zend，但该技术具有指导意义并且可能会起作用。我也一直在努力解决这个问题，但更多的是为了国际化。

[http://darrenonthe.net/2011/05/06/dynamic-routing-from-database-in-codeigniter/](http://darrenonthe.net/2011/05/06/dynamic-routing-from-database-in-codeigniter/)

基本上，您将您的路由缓存到一个文件中，然后框架将它们与您的控制器/变量详细信息相匹配。我尝试了很多东西，复杂的正则表达式，最后，这真的非常非常好。对你来说可能也是一个很好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T04:07:58.950

您需要强制执行一些条件，即模型是整数类型或其他类型。像这样

```
 $route = new Zend_Controller_Router_Route(
    ':make/:model',
    array(
        'controller' => 'car',
        'action'     => 'logic'
    ),
    array('make' => '\d+')
); 
```

如果你不能用这些额外的条件来区分它们，那么软件是如何为你处理它的动作名称或制作的呢？

# jquery - JQuery克隆对象没有将值传递给SQL，Asp

> ID：10544405
> 
> 赞同：0
> 
> 时间：2012-05-11T01:53:49.450
> 
> 标签：jquery, asp-classic, clone

我正在构建一个允许用户插入调查/民意调查的工具。默认情况下，我为可能的答案提供了四个文本框。但是，如果调查需要更多答案选项，我会使用 JQuery clone()。但是，当用户单击以克隆额外的答案字段时，无法使用 Asp 将值传递到数据库中，就好像创建的文本字段不存在一样。

我的代码在这里工作：http: [//jsfiddle.net/LAECx/120/](http://jsfiddle.net/LAECx/120/)

渲染的 HTML 标记

```
 <table id='pollcreate' width="100%" cellpadding="2" cellspacing="0" border="0" >
<tbody>
<form name="pollcreation_form" action="pollcreate_action.asp" method="post">
    <tr id="qrow_poll_answer" name="qrow_poll_answer">
        <td id="qcell_poll_answer" name="qcell_poll_answer" align="left" valign="top"  class="formlabelcell" >Answer Option 1</td>
    </tr>
    <tr id="arow_poll_answer" name="arow_poll_answer">
        <td id="acell_poll_answer" name="acell_poll_answer" align="left" valign="top"  class="formquestioncell" ><input type="text" id="poll_answer" name="poll_answer" value="" size="50" maxlength="500"  class="forminputtext" ></td>
    </tr>
    <tr id="sprow_poll_answer" name="sprow_poll_answer">
        <td id="spcell_poll_answer" name="spcell_poll_answer" align="left" valign="top"><img src="http://img.lightreading.com/images/spacer.gif" width="1" height="8" border="0"></td>
    </tr>
    <tr id="brow_addrow" name="brow_addrow">
        <td align="left" valign="top"  class="formfullcell" ><input type="submit" name="addrow" id="addrow" value="Add Answer Option"  class="forminputbutton" ></td>
    </tr>
    <tr id="brow_submit" name="brow_submit">
        <td align="left" valign="top"  class="formfullcell" ><input type="submit" name="submit" id="submit" value="Create"  class="forminputbutton" ></td>
    </tr>
</tbody>
</table> 
```

jQuery

```
$(document).ready(function() {
    var index = 5;
  $("#addrow").click(function() {
    var row = $('#pollcreate tbody tr#qrow_poll_answer:last, #pollcreate tbody tr#arow_poll_answer:last, #pollcreate tbody tr#sprow_poll_answer:last').clone(true).insertAfter('#pollcreate tbody tr#sprow_poll_answer:last');
      $("td.formlabelcell:eq(0)", row).text("Answer Option " + index)
     $("td.formquestioncell:eq(0) input", row).attr("name", "poll_answer" + index).attr("id", "poll_answer" + index).attr("value", index)
                      index++;
        return false;
  });
}); 
```

# java - Spring AOP：选择性地选择建议

> ID：10544406
> 
> 赞同：1
> 
> 时间：2012-05-11T01:53:49.800
> 
> 标签：java, spring, aop, spring-aop

我有两个实现 MethodInterceptor 的建议类。我想将这些建议应用于一个切入点，并在调用目标方法时选择建议。

我认为这是不可能的，所以我做了一个目标类的子类，并为子类使用切入点表达。

类看起来像：

```
class SuperClass implements SomeInterface {
    public int getZero() {
        return 0;
    }
}

class SubClass extends SuperClass implements SomeInterface { 
} 
```

XML 看起来像：

```
<bean id="subAdvice" class="package.SomeAdvice" />
<aop:config>
    <aop:advisor advice-ref="subAdvice" pointcut="execution(* *..SubClass.*(..))"/>
</aop:config> 
```

但是`subAdvice`当我通过调用`getZero()`方法时没有应用`SubClass`，可能是因为在`SubClass`. 当我重写该`getZero()`方法时它起作用了，但我不想重写它，因为实际上方法太多，`SuperClass`如果我想调用`SuperClass`'s 方法是多余的。

我可以将建议应用于不实现方法的子类吗？或者有没有其他有选择地应用建议的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T05:12:05.137

你关于它的理论不起作用，因为你没有在你的子类中实现/覆盖它是正确的。您的切入点指定子类中定义的方法的所有执行，并且如果没有在类中实际定义的任何方法，您将没有任何匹配的连接点。

从您的问题中，我不确定您是要匹配所有子类的方法执行，还是只匹配在超类上定义但在子类实例上调用的那些。如果你问的是前者，你可能想使用这个切入点：

```
execution(* package.SuperClass+.*(..)) 
```

添加的加号选择了 SuperClass 的所有子类型，因此您的切入点现在选择 SuperClass 或其子类中定义的所有方法的所有执行。[在此处](http://www.eclipse.org/aspectj/doc/next/progguide/semantics-pointcuts.html#d0e5926)查看 AspectJ 参考以获取有关子类型模式的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T06:51:57.793

我发现我的方法是错误的。`bean`我可以像这样使用 express对子类应用建议：

```
<bean id="subAdvice" class="package.SomeAdvice" />
<aop:config>
    <aop:advisor advice-ref="subAdvice" pointcut="bean(subClass)"/>
</aop:config> 
```

但我不需要为此创建一个子类。我需要的只是一个应用其他建议的 bean。总之，我可以通过制作多个 bean 来应用多个建议，并通过 bean 名称有选择地选择建议。

# php - 用 PHP 构建多通知系统的最佳方法

> ID：10544412
> 
> 赞同：17
> 
> 时间：2012-05-11T01:54:58.460
> 
> 标签：php, mysql, codeigniter, database-design, database-schema

我目前正在开发一个移动应用程序，它可以让你向朋友询问最喜欢的东西，它是一个 HTML5 前端和一个 PHP 后端。我不知道构建通知系统的最佳方法是什么，更多的是数据库架构而不是实际代码本身。

移动应用流程如下：

*   用户请求帮助
*   用户可以选择；通知所有朋友，通知最喜欢的朋友或通知附近的朋友
*   根据用户选择的内容，通知人们

在 PHP 和 MySQL 中执行此操作的最佳方法是什么？我并不是真的要求任何人为我编写 PHP 代码，而是绘制出最理想的 MySQL 表和字段模式，因为这是我目前所坚持的。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-11T02:01:07.153

您可以创建通知表，例如：

```
from_user | to_user | notification | seen 
```

然后每当您想通知用户时，您只需添加一条包含所需信息的记录并设置`seen`为`0`/ `false`。

然后，当用户阅读通知时，您将该参数设置为`1`/ `true`。

例子：

```
from_user | to_user | notification | seen
    -          -          -           - 
```

用户 john 通知用户 jeff：

```
from_user | to_user | notification | seen
   john      jeff       whatever..    0 
```

用户 jeff 阅读了通知：

```
from_user | to_user | notification | seen
   john      jeff       whatever..    1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T02:30:32.320

为什么不在一个名为“通知”的表格中列出所有通知

```
id | user_id | from_user_id | notification 
```

*   id = 通知 id
*   user_id = 通知是谁？
*   from_user_id = 谁发送了通知？
*   通知 = 消息

然后作为伪代码：

```
// Create a notification from User A to User B
$this->db->insert ('notifications', array ('user_id' => $friends_id, 'from_user_id' => $current_user_id, 'notification' => $message));

 // The meanwhile, on your home page or somewhere, wherever you want to display notifications
 $this->db->where ('user_id', $current_user_id)
 $notifications = $this->db->get ('user_id');
 foreach ($notifications as $notification)
 {
         // Display the notification as needed
         // Optionally delete the notification as it is displayed if it is a "one off" alert only
 } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-02T20:25:12.883

扩展杰弗里的答案：

```
id  |  from_user | to_user | notification | seen | timestamp
 -         -          -          -           -         - 
```

时间戳将帮助您确定特定通知发生的时间。您还可以通过使用[timeago.js](http://timeago.yarp.com/)或[Livestamp.js扩展脚本来创建时间时刻](http://mattbradley.github.io/livestampjs/)

它还将帮助您创建通知时间线，并且通知的维护会更简单。

# javascript - 表单提交期间未设置 JavaScript 值

> ID：10544414
> 
> 赞同：0
> 
> 时间：2012-05-11T01:55:01.517
> 
> 标签：javascript, forms, post

我已经在整个网络上搜索了这个问题的解决方案。没有成功后，我来了。我有一个表单，其中有 3 个应该包含数据的字段。字段 1 是邮政编码，字段 2 和 3 分别是城市和州。

JS 函数 getCityByZipHome 和 getStateByZipHome 动态返回城市和州，并将值插入 city2 和 state2 输入字段。

无论出于何种原因，当我通过鼠标单击提交表单时.. 我通过 $_POST 看到数据。如果用户按 ENTER，则永远不会捕获数据，并且我永远不会从隐藏字段中看到该数据。

知道这里有什么问题吗？注意，我已经尝试了几乎所有的事件处理程序 onblur、onclick、onchange..etc。

```
<form  method="post" name="something" action="xxSome.php">
  <div class="s_row">
    <label for="zippy">Enter Zip Code</label>
    <input id="zipcode_home"  tabindex="2" type="text" onkeypress="javascript:getCityByZipHome(document.getElementById('zipcode_home').value, this.form.elements['city3']);javascript:getStateByZipHome(document.getElementById('zipcode_home').value, this.form.elements['state3']);" name="zipcode_home"/>
    <input id="state3" name="state3"type="hidden"/>
    <input id="city3" name="city3" type="hidden"/>
    <input type="submit"  value="Start Now!"/>
  </div>
</form> 
```

我已经尝试添加 onsubmit @ 表单级别，如下所示：

```
<form  method="post" name="something" action="xxSome.php" onsubmit="javascript:getCityByZipHome(document.getElementById('zipcode_home').value, this.form.elements['city3']);javascript:getStateByZipHome(document.getElementById('zipcode_home').value, this.form.elements['state3']);">
  <div class="s_row">
    <label for="zippy">Enter Zip Code</label>
    <input id="zipcode_home"  tabindex="2" type="text"  name="zipcode_home"/>
    <input id="state3" name="state3"type="hidden"/>
    <input id="city3" name="city3" type="hidden"/>
    <input type="submit"  value="Start Now!"/>
  </div>
</form> 
```

我已经尝试过 onblur 没有任何运气@输入级别：

```
<form  method="post" name="something" action="xxSome.php">
  <div class="s_row">
    <label for="zippy">Enter Zip Code</label>
    <input id="zipcode_home"  tabindex="2" type="text" onblur="javascript:getCityByZipHome(document.getElementById('zipcode_home').value, this.form.elements['city3']);javascript:getStateByZipHome(document.getElementById('zipcode_home').value, this.form.elements['state3']);" name="zipcode_home"/>
    <input id="state3" name="state3"type="hidden"/>
    <input id="city3" name="city3" type="hidden"/>
    <input type="submit"  value="Start Now!"/>
  </div>
</form> 
```

**经过所有的混乱，我实际上从未解决过这个问题。相反，我禁用了 ENTER 键作为提交方法。**

我有一些非常严重的时间限制，但我相信这会在稍后出现，我肯定会回到这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:00:33.173

您应该以 onSubmit 的形式执行 getcitybyzip 和 getstatebyzip。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:13:09.297

更改提交到按钮的类型，然后添加 onClick 方法。即，而不是让它，但你需要在表单上的一个 id 来做到这一点。不过，我会对找出问题所在的原因感兴趣。你试过萤火虫吗？

# blackberry - 设置自动完成字段行高

> ID：10544416
> 
> 赞同：0
> 
> 时间：2012-05-11T01:55:23.613
> 
> 标签：blackberry, java-me, blackberry-jde

![截图](../Images/0f943daf904ad9e10c2bfdb88a16e13b.png)

我正在使用 drawListRow 重新绘制自动完成字段，但我无法设置它的字段高度，这是我的代码：

```
autoCustomer = new AutoCompleteField(custList, style){
        public void drawListRow(ListField clistField, Graphics g,
                int index, int y, int width) {

                BasicFilteredListResult result = (BasicFilteredListResult) 
                        autoCustomer.get(clistField, index);//);
                if (result == null)
                    return;
                    String[] stringArray = parseMessage(result._object.toString(), Font.getDefault().derive(Font.PLAIN),fontSize, width-30);
                    int i;
                    int yCoord = 0;
                    int xCoord = 0;
                    //int rowHeight = (stringArray.length * fontHeight)+3;
                    clistField.setRowHeight((stringArray.length * fontHeight)+3); //already did this, but it won't work
                    System.out.println(stringArray.length);
                    g.setFont( Font.getDefault().derive(Font.PLAIN,fontSize,Ui.UNITS_px));
                    for(i = 0;i<stringArray.length;i++){
                        yCoord = y + (fontHeight*(i));
                        if(i>0)
                            xCoord = 20;       
                        g.drawText(stringArray[i].trim() , xCoord, yCoord, (DrawStyle.LEFT | DrawStyle.ELLIPSIS | DrawStyle.TOP ),  width-20);
                    }

        } 
```

我应该怎么做才能用这个自动完成来制作正确的行高？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T07:49:39.720

![在此处输入图像描述](../Images/c85ff987c8724597ec2dbea8b8f9be4c.png)

我无意中找到了答案，第一个参数是列表的索引，第二个是高度。文档没有提到这一点，我只在eclipse类的文档中找到了setRowHeight(int arg0, int arg1)。解决方法很简单

```
clistField.setRowHeight(index,(stringArray.length * fontHeight)+3); 
```

# objective-c - 文本字段背景颜色不随 UI 文本边框样式圆角矩形更改

> ID：10544419
> 
> 赞同：0
> 
> 时间：2012-05-11T01:55:58.217
> 
> 标签：objective-c, ios, ios5, uitextfield, ios4

我正在尝试更改 IUTextField 中的背景颜色，但只有在未设置 UITextBorderStyleRoundedRect 时才会成功。

```
theTextField.borderStyle=UITextBorderStyleNone; 
```

我试图在 IBuilder 和

```
theTextField.backgroundColor=[UIColor colorWithRed:m_r green:m_g blue:m_b alpha:1.0]; 
```

它发生在 IOS 4.X 上，而不是 IOS 5.X 上。知道会发生什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T18:21:31.980

我已经完成了一个示例代码，它在所有 iOS 版本 >= 3.2 上都能正常工作

这是代码

```
- (IBAction)button:(id)sender {

  if ([[textField backgroundColor] isEqual:[UIColor greenColor]]) {

    [textField setBackgroundColor:[UIColor yellowColor]];
  }
  else {

    [textField setBackgroundColor:[UIColor greenColor]];

  }
} 
```

这里的**textField**是一个 IBOutlet 连接，可在我的 xib 文件中找到。

还添加了一个连接此操作方法的 UIButton。它非常适合我..

我建议您尝试使用此代码的示例。

# javascript - 接受可变数量参数的 Javascript 函数 - 更改它们的值 - 然后返回它们

> ID：10544424
> 
> 赞同：2
> 
> 时间：2012-05-11T01:56:48.997
> 
> 标签：javascript, function, arguments

我是 Javascript（和一般编程）的新手，并且一直在寻找一种方法来使用 Javascript 函数更改任意数量的 aguments 的值。

这里的答案（[JavaScript variable number of arguments to function](https://stackoverflow.com/questions/2141520/javascript-variable-number-of-arguments-to-function)）非常有帮助。我能够使用它来创建我需要的两个功能，但我在使用第三个时遇到了麻烦。

基本上我想将可变数量的对象（原始或**更复杂**）传递给一个函数，并让函数改变每个对象的值。

```
var pants = true;
var house = true;
var hair = {/* lots of stuff */};

var onFire = function() {
        for (var i = 0; i < arguments.length; i++) {
            arguments[i] = false;
        }
};

onFire(pants, house, hair); 
```

控制台输出：

```
>pants;
 true

>house;
 true

>hair;
 Object 
```

我怎样才能制定这个函数，所以结果是：

```
>pants;
 false

>house;
 false

>hair;
 false 
```

任何帮助将不胜感激！

**编辑：**

为了澄清事情-我正在尝试创建一个可重用的辅助函数，该函数可以更改传入的任何对象的值，`false`而不是键入：

```
var a1 = false;
var a2 = false;
...
var a+n = false; 
```

如果我使用[mathec](https://stackoverflow.com/users/1388454/mathec)的方法 - 是否可以“解析”`object`以便它的属性覆盖同名的全局变量，还是我每次都坚持明确地输入它？

```
var object = {
    pants: {/* lots of stuff */},
    house: {/* lots of stuff */},
    hair: {/* lots of stuff */}
};

function modifyObject(obj) {
    obj.pants = false;
    obj.house = false;
    obj.hair = false;
}

function someMagic(object){
    // wand waves...
    // rabbit exits hat....
} 
```

控制台输出：

```
>pants;
 false

>house;
 false

>hair;
 false 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T02:12:32.670

当你在 JavaScript 中传递变量时，如果它是一个对象，你传递的是对一个值的引用的副本，但如果它是一个原始值（如真/假），你是在复制实际值。这基本上意味着，如果您传入一个对象并修改该对象的属性之一，您将修改原始对象。但是如果你传入一个像真/假这样的原语，你只会修改副本，而不是原始值。因此，如果您的目标是修改原始值，一种选择是将这些值存储在一个对象中，然后传入该对象。例如：

```
var object = {
    pants: true,
    house: true,
    hair: {}
};

function modifyObject(obj) {
    obj.pants = true;
    obj.house = true;
    obj.hair = true;
} 
```

如果您想修改任意数量的参数，请记住，如果您传入 true/false，您就是在复制这些值。因此，如果您在函数内部更改它们，您将不会修改原始值。

记住这一点的一种快速方法是，如果您曾经传递一个对象或数组，那么您就是在修改实际的对象。其他任何事情，您都在修改副本。

编辑

所以从字面上解释你想要做什么，你可以这样写：

```
var a = true,
    b = true;

/* pass in variable names */
function makeFalse() {
   var i, len;

   for (i = 0, len = arguments.length; i < len; ++i) {
     window[arguments[i]] = false;
   }
 }

 makeFalse("a", "b"); 
```

但我想不出这样做的充分理由:-)。我会使用配置对象来存储标志和状态变量，而不是全局变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:06:43.553

不幸的是，这不是直接可能的。

Javascript 是一种按值传递的语言，在对象类型的情况下，它是按值传递的引用（至少我看到它是这样引用的）

[JavaScript 是按引用传递还是按值传递语言？](https://stackoverflow.com/questions/518000/is-javascript-a-pass-by-reference-or-pass-by-value-language)

对此进行了深入研究，尤其是[https://stackoverflow.com/a/3638034/1093982](https://stackoverflow.com/a/3638034/1093982)有一个很好的答案。

这是一个 jsfiddle，演示了上述答案中的示例：

[http://jsfiddle.net/hjPHJ/](http://jsfiddle.net/hjPHJ/)

请注意分配给参数的任何内容如何*不*包含在上述范围内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T02:11:17.673

你可以尝试 JavaScript 的 typeof() 函数，它应该返回“object”，然后在你的代码中以不同的方式对待它。至于更改对象的值，我认为您实际上想更改属性的值，但我不确定我是否足够了解您的问题。

要更改对象属性，您可以执行以下操作。

```
hair.color = 'red'; 
```

如果要取消设置对象，可以执行此操作。

```
delete window.some_var; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T02:13:11.627

Javascript 按值将每个参数作为引用传递，因此当您更改传入引用的值时，它会修改复制的值。

然而，它确实有其他非常强大的东西，那就是关闭。在您的示例中，`onFire`已经可以通过闭包范围访问 、 和 ，并且可以直接修改`pants`它们`house`。`hair`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T02:20:22.170

当您在 javascript 中调用函数时，您传递的是值而不是对原始对象的引用。有几种方法可以做你想做的事，但不能直接通过传递每个值来更改函数。

首先你可以传递一个数组：

```
function onFire(arr) {
    for (var i = 0; i < arr.length; i++) {
        arr[i] = false;
    }
}

arr = [true, true, {}];
onFire(arr); // arr[0] through arr[2] are now false 
```

另一种方法是传递一个**可以**修改其属性的对象，您只是不能更改作为参数传递的变量的值：

```
function onFire(obj) {
    obj.pants = false;
    obj.house = false;
    obj.hair = false;
}

onFire( { pants: true, house: true, hair: { } } );
// obj.pants, obj.house and obj.hair are now false 
```

这些都不能满足您的要求，但是如果我知道这样做的原因，可能会有更好的方法...

# c# - 用于本地身份验证的 .Net 目录服务

> ID：10544428
> 
> 赞同：0
> 
> 时间：2012-05-11T01:57:06.670
> 
> 标签：c#, asp.net, .net, directoryservices

我第一次在.Net中使用目录服务。我想用它在asp.net网站应用程序中对我机器上的本地用户进行身份验证代码如下

```
DirectoryEntry entry = new DirectoryEntry("WinNT://"+Environment.MachineName+"/administrator", txtBoxUserName.Text, txtBoxPWD.Text); 
```

出于某种原因，尽管我为管理员用户使用了正确的用户名和密码，但我得到了“System.Runtime.InteropServices.COMException”的异常。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:03:11.010

尝试这个：

```
 public bool IsAuthenticationValid(string userName, string password)
{
    using (var context = new PrincipalContext(ContextType.Machine))
    {
        return context.ValidateCredentials(userName, password);
    }
} 
```

编辑：忘了提及您将需要 System.DirectoryServices 和 System.DirectoryServices.AccountManagement 参考。

如果您遇到同样的错误，请描述您在什么环境中运行此代码。我的意思是命令行、Web 应用程序等。只是更多的背景知识，看看我是否可以进一步帮助您。

# facebook - 应该修复的开放图警告？

> ID：10544430
> 
> 赞同：0
> 
> 时间：2012-05-11T01:58:01.103
> 
> 标签：facebook, facebook-opengraph

我正在通过 Yoast 的 WordPress SEO 插件使用 Facebook Open Graph，我该如何解决这个问题？在 Facebook 上，我的网站 URL 没有显示描述和缩略图？

> **外来财产**
> 
> 这种类型的对象不允许名为“fb:page_id”的属性。
> 
> **解析器不匹配的元数据**
> 
> 此元数据的解析器结果与输入元数据不匹配。这可能是由于数据以一种意外的方式排序、为一个属性提供了多个值而只期望一个值、或者给定属性的属性值不匹配造成的。以下是解析结果中未看到的输入属性 => 内容对：'og:locale:locale => en_US, fb:page_id => 2052817970'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T02:01:29.870

删除 fb:page_id 元标记；[它自 12 月以来](https://developers.facebook.com/blog/post/608/)已被弃用- 如果您在文档中仍然看到对它的任何引用，则它们是不正确的，需要更新

# winapi - 如何获取 VSS 快照的“NextUSN”日志条目？

> ID：10544433
> 
> 赞同：8
> 
> 时间：2012-05-11T01:58:39.710
> 
> 标签：winapi, volume-shadow-service

创建 VSS 快照后，我希望能够查询 USN 日志。这是可能的还是无法从 VSS 快照访问 USN 日志？

我的目标**是能够在两个 VSS 快照之间的增量备份中使用 USN 日志**。备份的过程是

1.  拍摄 VSS 快照并备份卷，记下每个文件的 USN 条目
2.  ...使用文件系统，添加/删除/修改文件
3.  拍摄第二个 VSS 快照，然后使用 USN 日志检测在步骤 #2 中发生的任何更改

我现在失败的是我试图在 VSS 快照上获取最高 USN 条目的部分

1.  创建 VSS 快照
2.  使用 CreateFile(\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy25) 打开快照
3.  DeviceIoControl(FSCTL_QUERY_USN_JOURNAL) - GLE:1179“卷更改日志未激活”失败

我可以从命令行模拟这个，如下所示

```
C:\>vssadmin list shadows
vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool
(C) Copyright 2001-2005 Microsoft Corp.

Contents of shadow copy set ID: {54fc99fb-65f2-4558-8e12-9308979327f0}
   Contained 1 shadow copies at creation time: 5/10/2012 6:44:19 PM
      Shadow Copy ID: {a2d2c155-9916-47d3-96fd-94fae1c2f802}
         Original Volume: (T:)\\?\Volume{a420b1fa-9744-11e1-9082-889ffaf52b70}\
         Shadow Copy Volume: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy25
         Originating Machine: computer
         Service Machine: computer
         Provider: 'Microsoft Software Shadow Copy provider 1.0'
         Type: Backup
         Attributes: Differential

C:\>fsutil usn queryjournal \\?\Volume{a420b1fa-9744-11e1-9082-889ffaf52b70}
Usn Journal ID   : 0x01cd2ebe9c795b57
First Usn        : 0x0000000000000000
Next Usn         : 0x000000000001b5f8
Lowest Valid Usn : 0x0000000000000000
Max Usn          : 0x7fffffffffff0000
Maximum Size     : 0x0000000000100000
Allocation Delta : 0x0000000000040000

C:\>fsutil usn queryjournal \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy25
Error:  The volume change journal is not active. 
```

如果可能的话，任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-24T12:56:16.583

这个问题对我正在从事的项目非常重要，所以我终于（几乎）100% 地工作了。

**注意：以下所有代码片段都在 C# 中**

感谢 Hannes de Jager 之前的回答，他为我指明了正确的方向和文档，我现在可以从 VSS 快照或任何其他常规 API 无法使用的特殊设备读取 USN 日志；就我而言，我的意思是使用 VDDK（用于 VM 磁盘的 VMware SDK）安装的 VMware 快照。

我还重用或导入了来自伟大项目的代码：

*   C# 中的 USN 期刊浏览器，来自 StCroixSkipper ( [http://www.dreamincode.net/forums/blog/1017-stcroixskippers-blog/](http://www.dreamincode.net/forums/blog/1017-stcroixskippers-blog/) )。仅使用官方 API 读取 USN（因此此处没有 VSS），但提供有用的 pinvokes 和 Win32 API 结构以及有关 USN 如何工作的一般信息

*   AlphaFS ( [https://github.com/alphaleonis/AlphaFS/](https://github.com/alphaleonis/AlphaFS/) )，它模仿大部分`System.IO`命名空间，但允许访问特殊的窗口路径（VSS 快照、原始设备）并提供有用的扩展。

如果其他人有兴趣，我会分享我现在使用的代码，仍然处于相当粗糙的状态，但可以正常工作。

它是如何工作的？

首先，您必须访问所需的 Usn 日志组件。它们作为隐藏条目中的 ADS（备用数据流）位于设备的根目录。无法使用标准`System.IO`命名空间访问它们，这就是为什么我之前告诉我使用了 AlphaFS 项目，但是 pinvoking`CreateFile()`应该`ReadFile()`就足够了。

1/2

该条目`\$Extend\$UsnJrnl:$Max` 具有有关日志当前状态的全局信息。最重要的部分是 usn 日志 ID（如果要比较多个 VSS 快照，您可以使用它来检查日志是否已重置）和最低有效 USN 日志序列号。

USN期刊结构：

```
 // can be directly extracted from $MAX entry using Bitconverter.ToUint64
 public struct USN_JOURNAL_DATA{
        public UInt64 MaximumSize; //offset 0
        public UInt64 AllocationDelta; // offset 8
        public UInt64 UsnJournalID; // offset 16
        public Int64 LowestValidUsn; // offset 24
    } 
```

2/2

该条目`\$Extend\$UsnJrnl:$J`包含日记帐记录。它是一个稀疏文件，因此其磁盘使用率远低于其大小。

要回答最初的问题，如何从以前的 VSS 快照中知道 Max used USN 序列并将其与另一个快照的序列进行比较？嗯，NextUsn 值只是等于`$Usnjrnl:$J`条目的大小。

在您的“新”vss 快照 USN 日志中，如果要解析两个快照之间更改的记录，您可以在开始解析记录之前查找“参考”VSS 快照最大 USN。

一般来说，每个 USN 日志条目作为一个唯一的 ID（USN 编号），它是`$J`日志条目本身所在的内部偏移量。每个条目的大小都是可变的，因此要按顺序读取，我们必须计算：

```
next entry offset inside $J = 
    offset of current entry (or its USN sequennce number + length of current entry 
```

幸运的是，记录长度也是 USN 条目记录的一个字段。说得够多了，这里是 USN 记录类：

```
public class UsnEntry : IComparable<UsnEntry>{
        private const int FR_OFFSET = 8;
        private const int PFR_OFFSET = 16;
        private const int USN_OFFSET = 24;
        private const int REASON_OFFSET = 40;
        private const int FA_OFFSET = 52;
        private const int FNL_OFFSET = 56;
        private const int FN_OFFSET = 58;

        public UInt32 RecordLength {get; private set;}
        public Int64 USN {get; private set;}
        public UInt64 FileReferenceNumber {get;private set;}
        public UInt64 ParentFileReferenceNumber {get; private set;}
        public UInt32 Reason{get; set;}
        public string Name {get; private set;}
        public string OldName{get; private set;}

        private UInt32 _fileAttributes;
        public bool IsFolder{
            get{
                bool bRtn = false;
                if (0 != (_fileAttributes & Win32Api.FILE_ATTRIBUTE_DIRECTORY))
                    bRtn = true;
                return bRtn;
            }
        }

        public bool IsFile{
            get{
                bool bRtn = false;
                if (0 == (_fileAttributes & Win32Api.FILE_ATTRIBUTE_DIRECTORY))
                    bRtn = true;
                return bRtn;
            }
        }

         /// <summary>
        /// USN Record Constructor
        /// </summary>
        /// <param name="p">Buffer pointer to first byte of the USN Record</param>
        public UsnEntry(IntPtr ptrToUsnRecord){
            RecordLength = (UInt32)Marshal.ReadInt32(ptrToUsnRecord); //record size
            FileReferenceNumber = (UInt64)Marshal.ReadInt64(ptrToUsnRecord, FR_OFFSET);
            ParentFileReferenceNumber = (UInt64)Marshal.ReadInt64(ptrToUsnRecord, PFR_OFFSET);
            USN = (Int64)Marshal.ReadInt64(ptrToUsnRecord, USN_OFFSET);
            Reason = (UInt32)Marshal.ReadInt32(ptrToUsnRecord, REASON_OFFSET);
            _fileAttributes = (UInt32)Marshal.ReadInt32(ptrToUsnRecord, FA_OFFSET);
            short fileNameLength = Marshal.ReadInt16(ptrToUsnRecord, FNL_OFFSET);
            short fileNameOffset = Marshal.ReadInt16(ptrToUsnRecord, FN_OFFSET);
            Name = Marshal.PtrToStringUni(new IntPtr(ptrToUsnRecord.ToInt32() + fileNameOffset), fileNameLength / sizeof(char));
        }

        public int CompareTo(UsnEntry other){
            return string.Compare(this.Name, other.Name, true);
        }

        public override string ToString(){
            return string.Format ("[UsnEntry: RecordLength={0}, USN={1}, FileReferenceNumber={2}, ParentFileReferenceNumber={3}, Reason={4}, Name={5}, OldName={6}, IsFolder={7}, IsFile={8}", RecordLength, USN, (int)FileReferenceNumber, (int)ParentFileReferenceNumber, Reason, Name, OldName, IsFolder, IsFile);
        }
    } 
```

我试图分离出可以解析 USN 日志并提取其条目的最小代码部分，从最低的有效条目开始。请记住，记录的长度是可变的；还要注意，一些记录指向下一个空记录（前 4 个字节，通常是记录长度，被归零）。在这种情况下，我寻找 4 个字节并重试解析，直到获得下一条记录。用 Python 编写过类似解析工具的人也报告了这种行为，所以我想我在这里并没有错。

```
string vol = @"\\?\path_to_your_VSS_snapshot";
string maxHandle = vol + @"\$Extend\$UsnJrnl:$Max";
string rawJournal= vol + @"\$Extend\$UsnJrnl:$J";

// cannot use regular System.IO here, but pinvoking ReadFile() should be enough
FileStream maxStream = Alphaleonis.Win32.Filesystem.File.OpenRead(maxHandle);
byte[] maxData = new byte[32];
maxStream.Read(maxData, 0, 32);

//first valid entry
long lowestUsn = BitConverter.ToInt64(maxData, 24);

// max (last) entry, is the size of the $J ADS
IntPtr journalDataHandle = Win32Api.CreateFile(rawJournal, 
            0, 
            Win32Api.FILE_SHARE_READ| Win32Api.FILE_SHARE_WRITE,
            IntPtr.Zero, Win32Api.OPEN_EXISTING,  
            0, IntPtr.Zero);
Win32Api.BY_HANDLE_FILE_INFORMATION fileInfo = new Win32Api.BY_HANDLE_FILE_INFORMATION();
Win32Api.GetFileInformationByHandle(journalDataHandle, out fileInfo);
Win32Api.CloseHandle(journalDataHandle);
long lastUsn = fileInfo.FileSizeLow;

int read = 0;
byte[] usnrecord;
byte[] usnraw = new byte[4]; // first byte array is to store the record length

// same here : pinvoke ReadFile() to avoid AlphaFS dependancy
FileStream rawJStream = Alphaleonis.Win32.Filesystem.File.OpenRead(rawJournal);
int recordSize = 0;
long pos = lowestUsn;

while(pos < newUsnState.NextUsn){
seeked = rawJStream.Seek(pos, SeekOrigin.Begin);
read = rawJStream.Read(usnraw, 0, usnraw.Length);
recordSize = BitConverter.ToInt32(usnraw, 0);
    if(recordSize == 0){
    pos = pos+4;
    continue;
}
    usnrecord = new byte[recordSize];
rawJStream.Read(usnrecord, 4, recordSize-4);
Array.Copy(usnraw, 0, usnrecord, 0, 4);
fixed (byte* p = usnrecord){
    IntPtr ptr = (IntPtr)p;
        // here we use the previously defined UsnEntry class
    Win32Api.UsnEntry entry = new Win32Api.UsnEntry(ptr);
    Console.WriteLine ("entry: "+entry.ToString());
    ptr = IntPtr.Zero;

}
    pos += recordSize;
} 
```

以下是我使用的 pinvokes：

```
public class Win32Api{

   [StructLayout(LayoutKind.Sequential, Pack = 1)]
    public struct BY_HANDLE_FILE_INFORMATION{
        public uint FileAttributes;
        public FILETIME CreationTime;
        public FILETIME LastAccessTime;
        public FILETIME LastWriteTime;
        public uint VolumeSerialNumber;
        public uint FileSizeHigh;
        public uint FileSizeLow;
        public uint NumberOfLinks;
        /*public uint FileIndexHigh;
        public uint FileIndexLow;*/
        public FileID FileIndex;
    }

    [DllImport("kernel32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool 
        GetFileInformationByHandle(
        IntPtr hFile,
        out BY_HANDLE_FILE_INFORMATION lpFileInformation);

   [DllImport("kernel32.dll", SetLastError = true)]
    public static extern IntPtr 
        CreateFile(string lpFileName, 
        uint dwDesiredAccess,
        uint dwShareMode, 
        IntPtr lpSecurityAttributes, 
        uint dwCreationDisposition,
        uint dwFlagsAndAttributes, 
        IntPtr hTemplateFile);

} 
```

这绝对不是地球上最好的代码，但我认为它将为任何必须做同样事情的人提供一个很好的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T22:53:01.093

您可能想再考虑一下鲁本的回答：

快照卷中的 USN 日志绝对可以通过读取快照 VSS 卷中的特殊文件来读取。**如果 Windows API 不允许您读取快照卷的 USN 日志，那么这可能是一个可行的选择**，尽管我确信这感觉像是一个 hack。

问题是，尽管 NTFS 没有开放规范，但不止一个项目发现了它，其中包括 NTFS 驱动程序的 Linux 实现。Ruben 为您发布的文档最初是为了帮助开发此驱动程序而编写的。

就像我提到的，USN 日志内容位于 NTFS 卷上的一个特殊文件中（就像 NTFS 中的许多东西一样，例如 NTFS 主文件表。实际上据说 NTFS 中的所有东西都是一个文件）。NTFS 中的特殊文件以美元符号 $ 开头，而你正在寻找的文件名为 $UsnJrnl，它又驻留在名为 $Extend 的特殊目录中。所以在你的 C: 卷上该文件是

```
C:\$Extend\$UsnJrnl 
```

或者对你来说是快照

```
\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy25\$Extend\$UsnJrnl 
```

您要查找的信息位于名为 $J 流的[备用数据流](http://en.wikipedia.org/wiki/NTFS#Alternate_data_streams_.28ADS.29)中，并且它具有这种格式的条目（请参阅 Ruben 的参考文档）：

```
Offset(in hex) Size Description
0x00 4 Size of entry
0x04 2 Major Version
0x06 2 Minor Version
0x08 8 MFT Reference
0x10 8 Parent MFT Reference
0x18 8 Offset of this entry in $J
0x20 8 Timestamp
0x28 4 Reason (see table below)
0x2B 4 SourceInfo (see table below)
0x30 4 SecurityID
0x34 4 FileAttributes
0x38 2 Size of filename (in bytes)
0x3A 2 Offset to filename
0x3C V Filename
V+0x3C P Padding (align to 8 bytes) 
```

因此，您可以读取此特殊文件的 $J 流以获取所需的 USN 条目。我想告诉你如何推导出你需要的 USN 号码，但我有点生疏。如果我再次弄清楚，我会更新这个答案。但是看看以这种方式阅读特殊文件，它很有趣;-)。我已使用此方法读取未挂载的 VHD 文件内的主文件表（特殊文件 $MFT），以便枚举 VHD 内卷上的所有文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T20:57:09.660

我认为在没有挂载卷的情况下使用WinAPI接口查询USN日志是不可能的。

您可以尝试打开文件“$UsnJrnl”并手动解析您需要的信息。

看：

[Richard Russon 和 Yuval Fledel 的 NTFS 文档](http://dubeyko.com/development/FileSystems/NTFS/ntfsdoc.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-23T21:29:21.850

也许这可能有用：日记条目不跨越集群边界。每个簇（通常每个簇 8 个扇区）都以一个新条目开始。如果在该簇的末尾下一个条目不适合剩余的簇空间，则该空间用零填充，并且下一个条目存储在下一个簇的开头（遗憾的是，这没有在“条目大小”）。所以你不需要解析这个空间 - 只需跳转到下一个集群（！不要忘记使用日志的 RUN 来获取下一个有效的磁盘集群）。罗伯特

顺便提一句。您可以使用USN（该条目在$J 中的偏移量）、簇号和该条目在集群中的位置来检查该条目的有效性。

# couchdb - CouchDB 内存实现

> ID：10544434
> 
> 赞同：8
> 
> 时间：2012-05-11T01:58:49.837
> 
> 标签：couchdb

是否有 CouchDB 的模拟后端，即相同的 REST 接口和语义但纯粹在内存中？我们有一个测试套件，每次都在原始数据库上运行每个测试（可重现），但针对真实数据库运行可能会更快。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T02:09:36.690

Do you mean running against a *mock* database?

I do not think there is something right out of the box. Two ideas:

1.  CouchDB on a memory filesystem. Set up a ramdisk, or tmpfs mount, and configure the CouchDB `database_dir` and `view_index_dir` to point to there.
2.  [PouchDB](https://github.com/daleharvey/pouchdb) is porting CouchDB to the browser IndexedDB standard. You did not say which language and environment you are using, but if you can run Node.js, this might be worth looking into. PouchDB has good momentum and I think it will be running in Node.js soon (perhaps through jsdom or some other library. Note, this does not get you the full solution; but you have expanded your question to "are there in-memory IndexedDB implementations for Node.js" for which the answer is either "yes" or "soon," given its adoption trajectory.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-13T06:55:54.163

发现这个：[https](https://github.com/RipcordSoftware/AvanceDB) ://github.com/RipcordSoftware/AvanceDB - 它支持不同的平台，似乎是一个认真的努力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-24T15:59:16.427

晚了，但我在使用[`pouchdb-server`](https://github.com/pouchdb/pouchdb-server)基于前面提到的 PouchDB 项目（CouchDB 的 JavaScript 实现）的基础上取得了巨大的成功。它可以针对各种后端运行，包括内存后端。这意味着你可以运行

```
pouchdb-server --in-memory 
```

获取内存中的 CouchDB 兼容服务器。还有其他几个命令行选项可供探索。

我认为它能够运行整个 CouchDB 测试套件，所以我猜你不太可能遇到太多的实现差异。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-05T20:07:43.543

我有同样的问题......对于测试我只是不想设置一个couchdb......我只想拥有一些记忆的东西，尽可能简单。

我做了什么： * 我创建了一个内存 CouchDB 连接器 => 它只是“org.ektorp.CouchDbConnector”的一个非常简单的实现 * 通过弹簧我连接了我需要的 CouchDbConnection-Implementation => 当我将它用于我的开发时-测试我连接我的内存 CouchDB 连接器，如果我想连接到真正的 CouchDb，我使用通常的连接器 => org.ektorp.impl.StdCouchDbConnector

唯一的问题是，“org.ektorp.CouchDbConnector”有 50 多个方法，必须实现。对于我的问题，只实现其中一些方法就足够了。取决于你的测试用例。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-10-14T09:48:08.733

[memorydb是与](https://github.com/go-kivik/memorydb)[Kivik](https://github.com/flimzy/kivik)一起使用的 CouchDB 的部分（进行中）内存实现，可以作为独立服务器运行。

尚未实现所有功能。

# c++ - 在头文件的另一个类中使用一个类作为值类型

> ID：10544435
> 
> 赞同：1
> 
> 时间：2012-05-11T01:58:51.427
> 
> 标签：c++, class, object, header

我在编写自助餐厅模拟项目时遇到了另一个问题。这个想法是我正在编写三个类（**学生、组和托盘**）和一个主程序来模拟一个正在运行的自助餐厅。**托盘**包含某些信息，例如颜色和拿起它的**学生**的姓名，以及托盘上的食物加起来的总量。在每个**托盘**与一个**学生**配对后，它被推入一个**组**堆栈。这就是问题出现的地方。尝试使用**托盘定义****组**函数时出现各种错误**论据。以下是这两个类的代码以及一些错误，再次，我将不胜感激：**

 **```
 class group
{
public:
    //CONSTRUCTOR
    group(string color="nocolor"){group_color=color; group_total=0;}
    //MEMBER FUNCTIONS for group class:
    void set_color(string new_color){group_color=new_color;}
    void add_member(simic_217A::tray new_member){assert(group_color==new_member.color());members.push(new_member);group_total+=new_member.price();}
    //void add_it_up();
    void remove_one() {members.pop();}
    void empty_group(){assert(!members.empty()); while(!members.empty()){members.pop();}} //    NEWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWw

    //CONST MEMBER FUNCTIONS for group class:
    string color() const {return group_color;}
    double  price_tot() const {assert(!members.empty()); return group_total;}
    bool is_empty() const {return members.empty();}
    simic_217A::tray top_item() const {return members.top();}

private:
    double group_total;
    string group_color;
    stack<simic_217A::tray> members;
};

//NONMEMBER FUNCTION for group class:
    std::ostream& operator <<(std::ostream& outs, const group& info);

class tray
{
public:
    //CONSTRUCTOR
    tray(string color="nocolor"){tray_color=color; tray_student_name="noname"; tray_price=0;}
    //MEMBER FUNCTIONS for tray class:
    void pick_up(student nextinline){tray_student_name= nextinline.get_name(); tray_price= nextinline.price(); nextinline.set_group(tray_color) ;}
    string set_color(string color){tray_color=color;}
    void drop_tray(){tray_student_name="noname"; tray_price=0;} 
    //CONST MEMBER FUNCTION for tray class:
    string tray_name() const {return tray_student_name;}
    double tray_price_func() const {return tray_price;}
    string color () const {return tray_color;}
private:
    string tray_color;
    string tray_student_name;
    double   tray_price;
};
  } 
```

以下是我在尝试编译时遇到的几个错误：

```
 error C2039: 'tray' : is not a member of 'simic_217A'

    error C2061: syntax error : identifier 'tray'

    error C2146: syntax error : missing ';' before identifier 'top_item' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:04:12.253

托盘的定义需要出现**在**任何依赖它的类之前，例如组。否则编译器将不知道托盘是什么。**

# php - PHP registerXPathNamespace() 错误

> ID：10544438
> 
> 赞同：2
> 
> 时间：2012-05-11T01:59:04.400
> 
> 标签：php, xml, soap, simplexml

> 致命错误：在第 83 行的 /home/gateway/public_html/index.php 中的非对象上调用成员函数 registerXPathNamespace()

所以我得到的错误在上面，在那一行是以下

```
$host = "services.incard.com.au/telechoicetransservice.asmx";

$timestamp = getGMTtimestamp();

$vars = 
"<?xml version=\"1.0\" encoding=\"UTF-8\"?>" .
"<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">" .
    "<soap:Body>" .
        "<ProcessPayment xmlns=\"https://services.incard.com.au\">".
        "<auth>" .
            "<AccountCode>". urlencode($_POST['AccountCode'])."</AccountCode>".
            "<Username>". urlencode($_POST['AccountCode'])."</Username>".
            "<Password>". urlencode($_POST['AccountCode'])."</Password>".
        "</auth>" .
        "<MerchantNumber>".urlencode($_POST['MerchantNumber'])."</MerchantNumber>" .
        "<CustomerNumber>".urlencode($_POST['CustomerNumber'])."</CustomerNumber>".
        "<Amount>".urlencode($_POST['Amount'])."</Amount>".
        "<Description>".urlencode($_POST['Description'])."</Description>".
        "</ProcessPayment>".
"</soap:Body></soap:Envelope>";

$response = openSocket($host, $vars);

$xmlres = array();
$xmlres = makeXMLTree ($response);
$xml = simplexml_load_string($response); 
$xml->registerXPathNamespace('soap:Envelope', 'http://schemas.xmlsoap.org/soap/envelope/');
foreach ($xml->xpath('//soap:Envelope:ResponseCode') as $item) {
    echo (string) $item; 
}
foreach ($xml->xpath('//soap:Envelope:ResponseDescription') as $item) {
    echo (string) $item; 
} 
```

我不知道为什么它不起作用。

我们从我们请求的服务器返回的响应如下

```
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <ProcessPaymentResponse xmlns="https://services.incard.com.au">
      <ProcessPaymentResult>
        <ResponseCode>string</ResponseCode>
        <ResponseDescription>string</ResponseDescription>
      </ProcessPaymentResult>
    </ProcessPaymentResponse>
  </soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T10:22:13.527

尝试更换

```
<?php
$xml->registerXPathNamespace('soap:Envelope', 
                                   'http://schemas.xmlsoap.org/soap/envelope/');
foreach ($xml->xpath('//soap:Envelope:ResponseCode') as $item) {
    echo (string) $item; 
}
foreach ($xml->xpath('//soap:Envelope:ResponseDescription') as $item) {
    echo (string) $item; 
}
?> 
```

和

```
<?php
$xml->registerXPathNamespace( 'soap', 
                                'http://schemas.xmlsoap.org/soap/envelope/' );
$result = $xml->xpath('//soap:Body');

foreach ($result as $body) {
  echo $body->ProcessPaymentResponse->ProcessPaymentResult->ResponseCode . "<br />";
  echo $body->ProcessPaymentResponse->ProcessPaymentResult->ResponseDescription . "<br />";
}
?> 
```

希望这可以帮助。

# c++ - 如何将无限长度的二进制转换为十进制

> ID：10544439
> 
> 赞同：4
> 
> 时间：2012-05-11T01:59:04.890
> 
> 标签：c++, algorithm, math

最常见的方法是对二进制数的每个非零位置求 2 的幂，然后将它们相加。当二进制数很大时，这不可行，例如，

10000...0001 //1000000 个位置

不可能让计算机计算 pow(2,1000000)。所以传统的方式是行不通的。

其他方式来做到这一点？

有人可以给出一个关于如何计算的算术方法，*而不是库*吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T03:31:34.033

正如happydave 所说，这种类型的东西有现有的库（例如GMP）。如果您出于某种原因需要自己动手，这里有一个相当有效的方法的大纲。您将需要 bigint 减法、比较和乘法。

以二进制格式缓存 10^(2^n) 的值，直到下一个值大于二进制数。这将允许您通过执行以下操作快速生成 10 的幂：

```
Select the largest value in your cache smaller than your remaining number, store this
in a working variable.
do{
  Multiply it by the next largest value in your cache and store the result in a
  temporary value.
  If the new value is still smaller, set your working value to this number (swapping 
  references here rather than allocating new memory is a good idea),
  Keep a counter to see which digit you're at. If this changes by more than one
  between instances of the outer loop, you need to pad with zeros
} Until you run out of cache
This is your next base ten value in binary, subtract it from your binary number while
the binary number is larger than your digit, the number of times you do this is the 
decimal digit -- you can cheat a little here by comparing the most significant bits
and finding a lower bound before trying subtraction.
Repeat until your binary number is 0 
```

就二进制位数而言，这大约是 O(n^4)，就内存而言，这大约是 O(nlog(n))。通过使用更复杂的乘法算法，您可以使 n^4 更接近 n^3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:06:10.640

您可以编写自己的类来处理任意大的整数（您可以将其表示为整数数组，或者任何最有意义的东西），并自己实现操作（*、pow 等）。或者你可以谷歌“C++ 大整数库”，找到其他已经实现它的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T03:12:13.803

> 不可能让计算机计算 pow(2,1000000)。所以传统的方式是行不通的。

这并非不可能。例如，Python 可以立即进行算术计算，并在大约两秒内转换为十进制数（在我的机器上）。Python 内置了处理超过机器字大小的大整数的功能。

在 C++（和 C）中，大整数库的一个不错的选择是[GMP](http://gmplib.org/)。它是健壮的、经过良好测试的和积极维护的。它包括一个[C++ 包装器](http://gmplib.org/manual/C_002b_002b-Interface-General.html)，它使用运算符重载来提供一个很好的接口（除了该操作没有 C++ 运算符`pow()`）。

这是一个使用 GMP 的 C++ 示例：

```
#include <iostream>
#include <gmpxx.h>

int main(int, char *[])
{
    mpz_class a, b;
    a = 2;
    mpz_pow_ui(b.get_mpz_t(), a.get_mpz_t(), 1000000);
    std::string s = b.get_str();
    std::cout << "length is " << s.length() << std::endl;
    return 0;
} 
```

上面的输出是

```
长度为 301030

```

在我的机器上执行 0.18 秒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-30T19:06:34.153

“就二进制位数而言，这大约是 O(n^4)，而就内存而言，这大约是 O(nlog(n))”。您可以执行 O(n^(2 + epsilon)) 操作（其中 n 是二进制位数）和 O(n) 内存，如下所示：设 N 是二进制长度为 n 的巨大数。计算余数 mod 2（容易；抓住低位）和 mod 5（不容易但不可怕；将二进制字符串分成连续的四位字符串；计算每个这样的 4 元组的余数 mod 5，并将它们相加就像将 9 用于十进制数一样。）。通过计算余数 mod 2 和 5，您可以读出低位十进制数字。减去这个；除以 10（互联网记录了这样做的方法），然后重复以获得下一个最小的数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T03:06:40.180

我在 Smalltalk 中计算了 2 ** 1000000 并在 9.3 秒内将其转换为十进制，所以这并非不可能。Smalltalk 内置了大型整数库。

```
2 raisedToInteger: 1000000 
```

正如另一个答案中提到的，您需要一个处理任意精度整数的库。一旦你有了它，你就可以对其进行 MOD 10 和 DIV 10 操作，以相反的顺序计算十进制数字（从最低有效到最高有效）。

粗略的想法是这样的：

```
LargeInteger *a;
char *string;

while (a != 0) {
    int remainder;
    LargeInteger *quotient;

    remainder = a % 10.
    *string++ = remainder + 48.
    quotient = a / 10.
    } 
```

这里有很多关于类型转换、内存管理和对象分配的细节缺失（或错误），但它旨在展示一般技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-11T03:25:47.010

[使用Gnu Multiprecision Library](http://gmplib.org/)非常简单。不幸的是，我无法测试这个程序，因为似乎我需要在编译器升级后重建我的库。但是没有太大的错误空间！

```
#include "gmpxx.h"
#include <iostream>

int main() {
    mpz_class megabit( "1", 10 );
    megabit <<= 1000000;
    megabit += 1;
    std::cout << megabit << '\n';
} 
```

# c - char 上的分段错误

> ID：10544441
> 
> 赞同：2
> 
> 时间：2012-05-11T01:59:11.357
> 
> 标签：c, string, segmentation-fault

运行 prog.c 时出现分段错误。我发现它与我的 *char 相关。这是代码。

程序.c

```
#include <stdio.h>
#include "worker.h"
#include "manager.h"
#include "employee.h"

int main(int argc, char **argv) {
  int i;
  Worker boss = (Worker) new_Manager("Carl Cracker", 80000, 1987, 12, 15);
  return 0;       
} 
```

工人.h

```
#ifndef _WORKER_H_
#define _WORKER_H_

 #define WORKER   char *name;   \
          double salary;    \
          long hireDay; \
          void (*raiseSalary)(Worker this, double byPercent);   

typedef struct Worker_struct* Worker;
struct Worker_struct {
   WORKER;
} Worker_struct;

void raiseSalary(Worker this, double byPercent);

#endif 
```

工人.c

```
#include <stdio.h>
#include <stdlib.h>

#include "worker.h"

void raiseSalary(Worker this, double byPercent) {
  Worker worker = (Worker) this; 
  printf("worker_c: raising salary\n");
  double raise = worker->salary * byPercent / 100;
  worker->salary = worker->salary + raise;
} 
```

经理.h

```
#ifndef _MANAGER_H_
#define _MANAGER_H_

#include "worker.h"

typedef struct Manager_struct* Manager;
struct Manager_struct {
  WORKER;
  double bonus;
void (*setBonus)(Worker this, double b);
} Manager_struct;

Manager new_Manager(char *name, double salary, int year, int month, int day);
#endif 
```

经理.c

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <malloc.h>
#include "manager.h"

static void setBonus(Worker this, double b) {
  Manager manager = (Manager) this; 
  manager->bonus = b;
}

Manager new_Manager (char *name, double salary, int year, int month, int day) {
  Manager manager;
  strcpy (manager->name, name);//----i think my problem is here----
 manager->salary = salary;
 manager->bonus = 0;    
 manager->setBonus = setBonus;
 manager->raiseSalary = raiseSalary;

return manager;
} 
```

我认为我的问题出在 strcpy 的 manager.c 中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:02:47.250

您已`char *name`在`WORKER`宏中声明，但尚未为其分配内存。

请不要像这样在宏中定义变量；绝对没有任何好处，并且不必要地使代码复杂化。直接在`Worker_struct`.

# r - 如何在 R 中创建尺寸为 M x N 的数据框

> ID：10544442
> 
> 赞同：3
> 
> 时间：2012-05-11T01:59:40.543
> 
> 标签：r, dataframe

有没有办法做到这一点？

我坚持这个：

```
m <- 10 # nof row
n <- 5  # nof column

# We will fill each cell with '0'

all <-c()
for (i in 1:m) {
   row_i <- c(rep(0,n))
   all <- c(all,row_i)
} 
```

仅创建 1 行作为输出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T02:05:28.790

为什么不使用矩阵？`data.frames`用于存储不同类型的列。

所以，

```
m = 10
n = 5
mat = matrix(0, nrow = m, ncol = n) 
```

如果你真的想要一个`data.frame`，强制为一个 - 列名将只是一个默认值：

```
dat = as.data.frame(mat)
names(dat)
[1] "V1" "V2" "V3" "V4" "V5" 
```

您的方法的问题是您只是一个接一个地附加值，而忽略了您想要的尺寸。你可以这样做，但增长数据不是一个好主意，最好像上面那样预先分配它。此外，这无论如何都会产生一个矩阵，我认为这是你应该使用的。

警告：前面有错误的代码！

```
m <- 10 # nof row
n <- 5  # nof column

all <- NULL
for (i in 1:m) {
  row_i <- c(rep(0,n))
  all <- rbind(all,row_i)
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T04:30:50.473

这会产生用零填充的 data.frame。

```
as.data.frame(lapply(structure(.Data=1:N,.Names=1:N),function(x) numeric(M))) 
```

# jquery - Jquery DataTable fnServerData 错误

> ID：10544443
> 
> 赞同：2
> 
> 时间：2012-05-11T02:00:00.880
> 
> 标签：jquery, .net, ajax, web-services, datatable

我正在尝试通过 Ajax 从 asp.net Web 服务器 (.asmx) 文件加载我的 jQuery 数据表。

我正在使用以下 jQuery：

```
 $("#taskTable").dataTable({
            "bProcessing": true,
            "bServerSide": true,
            "sAjaxSource": "ajaxPages/getTheTasks.asmx/getAllTasks",
            "fnServerData": function (sSource, aoData, fnCallback) {
                alert("test");
                aoData.push({ "name": "id", "value": ProjectID });
                $.getJSON(sSource, aoData, function (json) {
                    fnCallback(json);
                });
            }
        }); 
```

我一直在用萤火虫调试。我可以在每条线上一直停到“fnserverData”。一旦我到达那条线，我就无法进入该功能。警报永远不会触发。我什至从来没有向网络服务发送请求。它只是跳过。我已经多次重写了这段代码，并基于几个不同的例子。

这里的代码几乎是来自数据表网站的逐字记录，它确实有效。（数据表网站示例使用 PHP 源。我什至复制了该源并尝试通过 sAjaxSource 使用它，但它仍然没有进入 fnServerData。

如果有人问，我的 Web 服务会返回一个字符串（序列化 json）。我无法想象 Web 服务在这里是一个问题，好像请求甚至从未被发送。

如果我在 $.getJSON 行上放置一个断点，它永远不会命中。

感谢任何人检查这个！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T20:38:32.317

问题解决了。它真的很愚蠢，只是瞪着我。我在页面上没有 ID 为“taskTable”的表格。在我处理数据表的 Ajax 源代码部分之前，我正在从不同的页面加载表。我忘了把它提前。

# iphone - iOS 5.1 中没有使用 ARC 和情节提要释放内存

> ID：10544444
> 
> 赞同：3
> 
> 时间：2012-05-11T02:00:03.537
> 
> 标签：iphone, ios, xcode, storyboard, automatic-ref-counting

我正在为我的应用程序的内存问题而苦恼，该应用程序运行良好，只是一旦它遇到内存不足警告就会崩溃，并且在使用 10 到 20 分钟时非常非常缓慢。

编辑：如何弹出视图控制器？

introvideo-> welcomeview & tutorialview-> mainviewcontroller->scannerviewcontoller-> questionview->(如果回答正确->正确视图) else->wrongView

我如何弹回 mainView 控制器？

下面的代码是解决将视图控制器添加到 navigationcontroller.viewcontroller 堆栈的问题。因为我正在使用情节提要从视图控制器推送到另一个视图控制器而没有弹出。代码将弹出到已经在视图控制器堆栈中的视图控制器。

附上我的故事板的流程：

[http://dl.dropbox.com/u/418769/storyboard%20flow.png](http://dl.dropbox.com/u/418769/storyboard%20flow.png)

介绍视频 -> 欢迎视图和教程视图（如果用户名 !exist）-> 主视图控制器

这是用户将始终访问的主文件。

[http://dl.dropbox.com/u/418769/scannerViewController.h](http://dl.dropbox.com/u/418769/scannerViewController.h)

[http://dl.dropbox.com/u/418769/scannerViewController.m](http://dl.dropbox.com/u/418769/scannerViewController.m)

我正在使用自定义 segue 来弹出视图控制器，这解决了部分问题。

```
-(void)perform {
    UIViewController *sourceVC = (UIViewController *) self.sourceViewController;
    NSInteger index = -1;
    NSArray* arr = [[NSArray alloc] initWithArray:sourceVC.navigationController.viewControllers];
    for(int i=0 ; i<[arr count] ; i++)
    {
        if([[arr objectAtIndex:i] isKindOfClass:NSClassFromString(@"mainViewController")])
        {
            index = i;
        }       
    }    

    [UIView transitionWithView:sourceVC.navigationController.view duration:0.5
                       options:UIViewAnimationOptionTransitionCrossDissolve
                    animations:^{

                        [sourceVC.navigationController popToViewController:[arr objectAtIndex:index] animated:NO];

                    }
                    completion:^(BOOL  completed)
     {     

             }                      
     ];

} 
```

但是，该应用程序仍在消耗 RAM 和 VRAM。

我真的很感谢这里的任何朋友帮助解决我的问题，是否强大的价值导致了这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T05:24:05.930

计算机辅助分析是解决这个问题的方法。构建和分析并解决所有问题。在 Leaks and Allocations 工具下运行您的应用程序。[使用堆分析。](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-12T15:12:32.780

当您说您正在使用“自定义 segue 弹出到主视图控制器”时，我不确定我是否完全理解这一点。你在用`performSegueWithIdentifier`吗？如果是这样，那么您就不会弹出；您正在推送主视图控制器的另一个副本！

在大多数情节提要中，您不会看到右侧子视图的转场循环回到父视图的左侧（并且您的屏幕快照显示转场返回主视图控制器的数量令人眼花缭乱，这有点一面红旗）。这是 Ray Wenderlich 的一个更习惯的故事板（取自[*iOS 5 中的开始故事板*](https://www.raywenderlich.com/3004-beginning-storyboards-in-ios-5-part-1)）：

[![Ray Wenderlich 教程中的示例故事板](../Images/50e66a8b1337c5739c1c8389045da860.png)](https://i.stack.imgur.com/6VULu.png)
[（来源：[cloudfront.net](https://d1xzuxjlafny7l.cloudfront.net/wp-content/uploads/2012/11/Full-storyboard.png)）]

通常，您会使用以下内容关闭子视图，而不是使用 segue。

```
[self.navigationController popViewControllerAnimated:YES]; 
```

其中，如果您想弹出多个级别，您可以使用`popToViewController`or `popToRootViewControllerAnimated`。或者如果你使用模态序列，你会用`dismissViewControllerAnimated`.

如果我误解了你所说的“自定义 segue to pop”的意思，你能提供你正在使用的代码吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T06:02:12.070

1.  @ken-thomases 分析很到位。另请参阅[查找泄漏](https://developer.apple.com/library/ios/documentation/Performance/Conceptual/ManagingMemory/Articles/FindingLeaks.html)。

2.  我想你正在使用ARC？

3.  你能解释一下上述代码示例的目的是什么，以及你的应用程序正在做什么来要求这样的东西吗？感觉就像你在解决一个症状而不是解决一个问题。

4.  在回答您的问题时，除非您有*强大的参考周期*`strong`，否则使用不太可能成为问题的根源（请参阅[过渡到 ARC](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)）。如果您遵循 Ken 的建议，您将确定您的应用程序在哪里泄漏内存（假设是），如果是，它在哪里。到那时，如果您仍然不了解泄漏的来源，您可以在这里发布违规代码，我相信会有很多人愿意提供帮助。此外，如果您有一些代码不知道引用是否不合适，请发布相关代码，我相信如果可以的话，我们会很乐意提供帮助。*`strong`*

# prolog - 流模式不存在

> ID：10544452
> 
> 赞同：2
> 
> 时间：2012-05-11T02:00:41.807
> 
> 标签：prolog

我已经在 prolog 中编写了一段时间的代码，它几乎值得编译，我所有的想法似乎都很可靠，所以它在编译时应该可以工作。它是一个程序，它查询数据库文件以获取子句列表，然后等待用户查询，然后它将从句子中选择所需的信息并适当地查询数据库，但有一段代码保留给我错误，抱怨标准谓词中不存在流模式，这可能是一个愚蠢的问题，但即使我已经做了所有的调查，如果有人可以帮助我，我还是无法找到解决这个问题的方法或指出我正确的方向，将不胜感激。

这是给出错误的代码块：

```
loop(STR):- 
           scan(STR,LIST),
           filter(LIST,LISroT1),
           pars(LIST1,LIST2),
           fail.

loop(STR):-    STR >< "",readquery(L),loop(L).

readquery(QUERY):-nl,nl,write("Query: "),readln(QUERY).

scan(STR,[TOK|LIST]):-
    fronttoken(STR,SYMB,STR1),!,
    upper_lower(SYMB,TOK),
    scan(STR1,LIST). 
```

编译器抱怨的具体行是 fronttoken(STR,SYMB,STR),!, 任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:35:26.217

由于我们正在查看代码的“ex[c]er[p]t”，因此很难确定出了什么问题，但是给定的证据表明了这一点： `loop/1`被调用之前`readquery/1`可以完成其工作来填充（绑定）参数`STR`到`loop/1`.

请注意，它`loop/1`调用自身（递归地），并以重复/失败模式进行。但是第一次`loop/1`运行时，代码中没有显示参数`STR`将如何填充的迹象。

更清晰（更独立）的代码片段如下所示：

```
loop :- 
           readquery(STR),
           scan(STR,LIST),
           filter(LIST,LISroT1),
           pars(LIST1,LIST2),
           fail.

loop :-    loop. 
```

这清楚地表明谓词`loop`实际上并没有返回任何结果（并且给定的代码片段还不够完整，无法清楚地说明整个程序完成了什么）。它假设 in 前面的子句`fail`是`loop`确定性的，因此在失败时，控制权会传递到 的第二个（递归）子句`loop/0`。如果不是这种情况，则可以通过将每个调用包装在内部来强制确定性`once/1`。

# excel - 向用户表单动态添加标签 = 空白用户表单

> ID：10544456
> 
> 赞同：15
> 
> 时间：2012-05-11T02:01:12.557
> 
> 标签：excel, vba

我正在尝试向用户表单动态添加按钮，但用户表单只是空白。我已经尽可能地简化了代码的本质以进行错误检查（并不是说它对我有帮助）

```
Sub addLabel()
UserForm2.Show    
Dim theLabel As Label
Dim labelCounter As Integer

For labelCounter = 1 To 3
    Set Label = UserForm2.Controls.Add("Forms.Label.1", "Test" & labelCounter, True)
    With theLabel
        .Caption = "Test" & labelCounter
        .Left = 10
        .Width = 50
        .Top = 10
    End With
End Sub 
```

有什么方法可以检查按钮是否已添加但不可见？或者为什么没有添加它们。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-11T03:40:56.333

一些东西：

1.  您需要将您的用户窗体显示为`vbModeless`- 否则代码将停止`UserForm2.Show`
2.  您正在创建一个对象，`Label`然后使用`With`on`theLabel`
3.  然后，您需要增加三个标签的位置以避免重叠（我已经使用`Top`）。

    ```
    Sub addLabel()
    UserForm2.Show vbModeless
    Dim theLabel As Object
    Dim labelCounter As Long

    For labelCounter = 1 To 3
        Set theLabel = UserForm2.Controls.Add("Forms.Label.1", "Test" & labelCounter, True)
        With theLabel
            .Caption = "Test" & labelCounter
            .Left = 10
            .Width = 50
            .Top = 10 * labelCounter
        End With
    Next
    End Sub 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-17T20:47:51.033

在`end with`声明之后，添加：

```
userform1.show 
```

更正一项：

```
.top = 10*labelcounter+10 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2014-08-22T08:50:32.840

试试下面的代码

```
Set theLabel = UserForm2.Designer.Controls.Add("Forms.Label.1", "Test1", True) 
```

# jquery - 移动结束标签

> ID：10544460
> 
> 赞同：2
> 
> 时间：2012-05-11T02:01:56.027
> 
> 标签：jquery

我有一个pdf链接，文件大小如下...

```
<a class="pdf-link" href="some-pdf.pdf">Some PDF</a> <span class="filesize">(PDF 100kb)</span> 
```

该链接由我们的 CMS 生成，对于我们的移动网站，跨度需要位于链接内。

有谁知道将结束`</a>`标记移动到跨度末尾的方法，最好是使用 jQuery 吗？

```
<a class="pdf-link" href="some-pdf.pdf">Some PDF <span class="filesize">(PDF 100kb)</span></a> 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T02:05:27.503

尝试：

```
$('.filesize').each(function() {
   $(this).appendTo($(this).prev());
}); 
```

您不需要手动删除内容，因为`appendTo`在内部移动 DOM，从[docs](http://api.jquery.com/appendTo/)：

> 我们还可以选择页面上的一个元素并将其插入到另一个元素中：
> 
> $('h2').appendTo($('.container'));
> 
> 如果以这种方式选择的元素被插入到其他地方，它将被移动到目标中（不克隆）：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:14:05.493

像这样的东西应该工作：

```
$(".filesize").each( function(index) {
    $(this).prev().append(this);
});​ 
```

在此处查看演示：http: [//jsfiddle.net/hammerbrostime/u9r2z/](http://jsfiddle.net/hammerbrostime/u9r2z/)

# ruby-on-rails - 跨样式表的 SCSS 常量 (Rails)

> ID：10544463
> 
> 赞同：2
> 
> 时间：2012-05-11T02:02:29.367
> 
> 标签：ruby-on-rails, sass

我会在 /app/assets/stylesheets 中的每个 scss 文件中包含一长串颜色。我尝试将它包含在 application.css.scss 中，但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:47:05.217

**该怎么办：**

*   `colors.scss`使用您想要访问的颜色创建一个文件`layouts/application.html.erb`。

*   放置`colors.scss`在`app/assets/stylesheets/partials/shared`. 这不是必需的。我只是喜欢有条理。

*   在 application.css.scss 中包含文件`@import "partials/shared/colors".`您可能更喜欢不同的结构，但无需附加资产管道知道的文件扩展名。

*   （**可选**）删除`require_tree`指令。删除此指令并依赖于`@import`启用您的预处理样式表（例如 *.css.scss）是一种按样式出现的顺序加载样式的方法。

**你刚刚做了什么：**

默认情况下，`stylesheet_link_tag 'application'`声明的 in`application.html.erb`正在寻找`application.css.scss`。`application.html.erb`我们已经告诉资产管道在任何使用模板的视图中使用它。现在，每个视图都可以访问您指定的颜色。

更多资源：对 AP 有几个更深入的研究。我建议你检查一下。这里有一些我觉得很有帮助的。

[导轨导轨](http://guides.rubyonrails.org/asset_pipeline.html)

[资产管道的秘密](http://speakerdeck.com/u/metaskills/p/secrets-of-the-asset-pipeline)

# mysql - Mysql：使用 max(date) 来获取最新的行

> ID：10544465
> 
> 赞同：1
> 
> 时间：2012-05-11T02:02:43.973
> 
> 标签：mysql

我有两个表，mytableA 和 mytableB。

MytableA 看起来像这样

```
ColumnA|Columnb
Apple|fruitstand
Pear|fruitstand 
```

mytableB 看起来像这样：

```
A列|B列|C列
苹果|2|2012 年 4 月 1 日
苹果|3|2012 年 4 月 3 日
苹果|23|12/1/2011
梨|1|12/22/2011
梨|0|2012/4/22
```

我的查询是这个

```
select * 
from 
  mytableB 
  join mytableB on mytableA.ColumnA = mytableB.ColumA
     and mytableB.Columnc = (select max(Columnc) from mytableB b where b.ColumnA = mytableB.columnA) 
```

我正在寻找的结果是

```
苹果|3|2012 年 4 月 3 日
梨|0|2012/4/22
```

我知道这在 SQL 中有效，但 mysql 有类似的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:24:44.490

我试过了。它在 mysql 上有效（不包括大量拼写错误），但结果对我来说没有任何意义。

```
ColumnA | ColumnB       | ColumnA | ColumnB | ColumnC
Apple     fruitstand      Pear      0         4/22/2012
Pear      fruitstand      Pear      0         4/22/2012 
```

编辑：您应该使用某种索引来识别条目。

像 mytablea

```
ID | name | type 
```

我的表b

```
ID | fruitID | stock | date 
```

然后

```
SELECT mytablea.name, mytableb.stock, mytableb.date FROM mytablea, mytableb, 
       (SELECT MAX(mytableb.date) as maxDate FROM mytableb, mytablea 
       WHERE mytableb.fruitID = mytablea.ID GROUP BY mytablea.ID) AS maxTB 
       WHERE mytableb.date = maxTB.maxDate AND mytablea.ID = mytableb.fruitID 
```

应该做的伎俩......这是一些蹩脚的大子查询:-！

结果：

```
name | stock | date
Apple  4       4/3/2012
Pear   0       4/22/2012 
```

# sql-server - 存储过程辅助中的 t-sql 调用函数

> ID：10544469
> 
> 赞同：1
> 
> 时间：2012-05-11T02:03:03.197
> 
> 标签：sql-server, tsql

你能帮我写这段代码吗？

```
//** Stored procedure Generate list of items to be removed **//

Create Sp_Add_pass   /*purpose is to generate  list to the table to be removed Tbl_list_delete (Handle ,list_id,list_type,delete_handle) */ 

Parameter 
  @card_id nvarchar 
  @card_type nvarchar

Create function Gethandle /* purpose is to auto insert in the table, which returns the handle */

create function [dbo].[fnGetHandle]()
returns int
as
begin
    declare @Handle as int;
    declare @strUser as nchar(256);

    set @Handle = 0 ;
    set @strUser = Current_User;

    insert into tbl_handle
    Output Handle into @Handle output
    ( UserName )
    values
    ( @strUser );

    return @Handle  ;
end;

Insert into tbl_list_delete
(Handle ,list_id,list_type,delete_handle) 
Values (Handle ,list_id,list_type,delete_handle)

/* once the list of items ready & then I can go ahead and do the soft delete items */
Create Sp_remove_pass
Parameters 
  @card_id 
```

不知道如何调用`Fngethandle`上面创建的函数：

```
Update tbl_list_delete  
Set deletehandle- @handle 
Where card_id - @card_id, deletehandle = 0  --soft delete 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T05:07:42.510

您只需要在更新语句之前调用该函数一次 - 例如：

```
CREATE PROCEDURE dbo.Sp_remove_pass
    @card_id INT
AS BEGIN    
   DECLARE @Handle INT

   SELECT @Handle = dbo.GetHandle()

   UPDATE dbo.tbl_list_delete  
   SET deletehandle - @Handle 
   WHERE card_id - @card_id, deletehandle = 0  --soft delete
END 
```

警告：你不应该**为**`sp_`你的存储过程使用前缀！该前缀已被 Microsoft 保留供自己使用 - 不惜一切代价尽量避免使用它。根据您使用该前缀调用存储过程的方式，您可能还会`master`首先在数据库中进行不必要的查找 - 所以请尽量远离该前缀！

**更新：将数据实际***插入一个名为***Get....**的函数中是糟糕的设计- 你可能会让你的调用者感到惊讶......

我会做什么：直接在存储过程中执行所有这些逻辑；我不确定你的桌子是什么样子 - 但你可以尝试这样的事情：

```
CREATE PROCEDURE dbo.proc_RemovePass
    @card_id INT
AS BEGIN    
   DECLARE @Handle INT

   INSERT INTO dbo.tbl_handle(UserName)
   VALUES(CURRENT_USER)

   SELECT @Handle = SCOPE_IDENTITY()  
   /* I'm assuming here that your table "tbl_Handle" has a column of type
      INT IDENTITY which gets a new value for each row inserted - that's the value
      my code is reading out here. Change this if that's not the case for you */

   UPDATE dbo.tbl_list_delete  
   -- what do you want to set here? Which column?? Not clear.....
   SET DeleteHandle = @Handle   
   -- your WHERE clause is unclear, too - what are you trying to check for here??
   WHERE card_id - @card_id AND DeleteHandle = 0  
END 
```

# c# - 如何为字典对象中的相同键创建一组值？

> ID：10544472
> 
> 赞同：1
> 
> 时间：2012-05-11T02:03:48.680
> 
> 标签：c#, dictionary

我有一个实体如下

```
 public class ContextElements
{
        public string Property { get; set; }

        public string Value { get; set; }
} 
```

现在我已经填充了实体（它是来自网络服务的实际输入的模拟）

```
var collection = new List<ContextElements>();

collection.Add(new ContextElements { Property = "Culture", Value = "en-US" });

collection.Add(new ContextElements { Property = "Affiliate", Value = "0" });

collection.Add(new ContextElements { Property = "EmailAddress", Value = "sreetest@test.com" });

collection.Add(new ContextElements { Property = "Culture", Value = "fr-FR" });

collection.Add(new ContextElements { Property = "Affiliate", Value = "1" });

collection.Add(new ContextElements { Property = "EmailAddress", Value = "somemail@test.com" }); 
```

现在我有一个字典对象如下

```
Dictionary<string, List<string>> dictStr = new Dictionary<string, List<string>>(); 
```

我正在寻找的输出是对于每个字典键（即属性），例如这里的“文化”、“附属”、“电子邮件地址”，值将出现在列表集合中

即字典的最终输出将是下面的输出（显然在运行时和程序上）

```
dictStr.Add("Culture", new List<string>() { "en-US", "fr-FR" });

dictStr.Add("Affiliate", new List<string>() { "0","1" });

dictStr.Add("EmailAddress", new List<string>() { "sreetest@test.com", "somemail@test.com" 
}); 
```

需要帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:21:56.910

我相信肖邦的解决方案会起作用，但对于 IEnumerable 不能转换为您作为字典的第二个通用参数所获得的列表的小问题。试试这个：

```
collection.GroupBy(x => x.Property).ToDictionary(x => x.Key, x => x.Select(y => y.Value).ToList()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:12:32.240

如果您可以使用 LINQ（我认为是 .NET 3.5 及更高版本），您可以执行以下操作：

```
Dictionary<string, List<string>> dictStr = collection.GroupBy(x => x.Property)
          .ToDictionary(x => x.Key, x => x.Select(y => y.Value).ToList()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T02:14:49.370

```
var dictStr = new Dictionary<string, List<string>>();
foreach(var element in collection)
{
    List<string> values;
    if(!dictStr.TryGetValue(element.Property, out values))
    {
        values = new List<string>();
        dictStr.Add(element.Property, values);
    }
    values.Add(element.Value);
} 
```

# vb.net - 如何将 UnicodeEncoding 输出转换为纯字符串？

> ID：10544475
> 
> 赞同：3
> 
> 时间：2012-05-11T02:04:07.310
> 
> 标签：vb.net, delphi, character-encoding

嗨，我目前正在将一个 delphi 代码转换为 .net，他们在他们的数据库中有这个加密我已经解密，但问题是输出是字节数组。

这是我到目前为止所做的

```
Private Function EnDeCrypt(ByVal Value As String) As String

    Dim transformed = Encoding.Unicode.GetBytes(Value).Select( _
        Function(item) Not item)
    Return Encoding.Unicode.GetString(transformed.ToArray())

End Function 
```

结果：º»¯³¶½ = edplib（不可打印的字符）

我的问题是如何将输出转换为字符串
非常感谢建议和帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T06:41:48.867

简短的回答是，如果您的编码算法确实是 UTF-16 字符串的按位否定，那么您将无法打印输出。该算法产生不可打印的输出。

您可以在显示时向 base64 添加额外的编码，以使在您的代码中转换的否定字节可显示。

如果您需要更准确的帮助，我认为您需要解释上下文以及您的动机是什么。

# windows - 请参阅 .exe 的 std::cout

> ID：10544479
> 
> 赞同：6
> 
> 时间：2012-05-11T02:04:24.913
> 
> 标签：windows, command-line, msbuild, cmake, exe

我有一个在 Windows 上编译的 .exe 文件。但是当我从命令行运行它时，我看不到我的程序输出到 std::cout 或 std::cerr 的任何东西。即使在命令行返回到提示符后，程序也会运行并继续运行（它是一个 GUI 程序，在我按下退出按钮之前不会退出）。如何查看程序的输出？

我正在使用 cmake 制作一个 Visual Studio 项目，然后使用 msbuild 进行编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T04:22:14.237

最简单的方法是将程序重新构建为控制台应用程序。选项 to`link.exe`需要`/SUBSYSTEM:CONSOLE`代替`/SUBSYSTEM:WINDOWS`; 大概有一种直接的方法可以在 cmake 中指定它。

此更改根本不应该影响您的 GUI，但如果该进程尚未与一个控制台关联，它将导致 Windows 分配一个控制台。此外，命令行 shell 通常会在继续之前等待控制台应用程序退出。

另一种方法是调用[`AllocConsole`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681944.aspx)显式创建新控制台，或者[`AttachConsole`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681952.aspx)如果您想使用现有控制台。或者，当然，您可以将输出发送到日志文件。

*额外的*

根据 Google 搜索，您可以通过在源代码中添加以下行来将该程序构建为控制台应用程序：

```
#pragma comment(linker, "/SUBSYSTEM:CONSOLE") 
```

这可能是最简单的解决方案。`#if`如果您只希望控制台用于调试构建，则可以将其放在一个块中。

另请参阅[CMake：如何使用不同的 ADD_EXECUTABLE 进行调试构建？](https://stackoverflow.com/questions/8054734/cmake-how-to-use-different-add-executable-for-debug-build)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T06:32:14.760

如果您想*永久*更改您的应用程序以显示此信息，[Harry Johnston 的回答是正确的。](https://stackoverflow.com/a/10545408/366904)我会推荐他建议的后一种方法，因为将您的应用程序切换到以控制台子系统为目标将导致它*始终*在启动时分配和显示控制台窗口，即使您不希望它这样做。

但是，我注意到您提到要显示来自 的输出`std::cerr`，这意味着您可能仅出于调试目的对该信息感兴趣。在这种情况下，我的建议是调用[`OutputDebugString`函数](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363362.aspx)而不是输出到`std::cout`or `std::cerr`。然后，您可以使用[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647)之类的小实用程序来监视应用程序的调试输出。它发送给`OutputDebugString`函数的所有内容都将显示在 DebugView 窗口中。

如果您想在对现有代码库进行最小更改的情况下使用此设置，您实际上可以将流的输出重定向`std::cout`到`std::cerr`调试器，就像您调用该`OutputDebugString`函数一样。可以在[此问题](https://stackoverflow.com/questions/73286/capturing-cout-in-visual-studio-2005-output-window)的答案和[此博客文章](https://web.archive.org/web/20140825203329/http://blog.tomaka17.com/2011/07/redirecting-cerr-and-clog-to-outputdebugstring/)中找到有关如何执行此操作的建议。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-03T17:29:54.510

查看输出的一种方法是运行：

```
program.exe > output.txt 
```

然后监视该文件的输出。或者使用管道查看它：

```
program.exe | find /v "" 
```

要还监视您可以使用的错误输出

```
program.exe > output.txt 2>&1

program.exe 2>&1 | find /v "" 
```

我是根据[Microsoft的文档和](https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/redirection.mspx?mfr=true)[这里](https://stackoverflow.com/questions/12273866/is-there-a-way-to-redirect-only-stderr-to-stdout-not-combine-the-two-so-it-can)和[这里](https://stackoverflow.com/questions/8913119/in-windows-whats-the-difference-between-21-and-21)的更实际的例子来想出它的。

这有助于我查看来自我（和其他人）Windows 应用程序的“隐藏”标准输出和标准错误消息。有趣的是，在某些程序中留下了哪些消息，但通常看不到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T02:15:25.733

Windows 不支持双模式。这意味着当您运行 gui 时，您无法将输出输出到您运行应用程序的控制台。

# jquery - 您应该设置 async true 还是使用 jQuery beforeunload 来防止用户在文件上传期间离开？

> ID：10544481
> 
> 赞同：0
> 
> 时间：2012-05-11T02:04:51.700
> 
> 标签：jquery, html, ajax

如果您混合使用 jQuery 和 Ajax 来管理用户上传表单的前端，如下所示：

```
$('form :button').click(function(){

    var formData = new FormData($("form")[0]);

    $.ajax({
        url: '/upload',
        type: 'POST',
        xhr: function() {
            myXhr = $.ajaxSettings.xhr();
            if(myXhr.upload){
                myXhr.upload.addEventListener('progress', progressHandlingFunction, false);
            }
            return myXhr;
        },
        data: formData,
        success: function (res) {
            alert("Uploaded");
        },
        cache: false,
        contentType: false,
        processData: false
    });
}); 
```

`async:false`使用在上传完成之前停止所有浏览器移动或使用某种 jQuery 函数是否有意义，比如`beforeunload`通知用户离开页面会中断他们的上传？

```
$(window).bind('beforeunload', function(){
    return 'If you leave this page, your upload will not complete! Continue?';
}); 
```

Ajax 中是否有一个选项可以仅在上传过程中运行一个函数，以便仅在文件上传期间出现此警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:12:54.307

在上传过程开始时保存一个标志可能会更好：

```
$('form :button').click(function(){

    var formData = new FormData($("form")[0]);
    var $this = $(this);
    $this.data('uploading', true);

    $.ajax({
       ..., // your attributes
       success: function (res) {
           $this.data('uploading', false);
           alert("Uploaded");
       },
    ... // rest of your code
}); 
```

然后上`beforeunload`

```
$(window).bind('beforeunload', function(){
    if($('form :button').data('uploading') === true) {
       return 'If you leave this page, your upload will not complete! Continue?';
    }
}); 
```

# variables - 如何在java字节码中修改局部变量的类型

> ID：10544483
> 
> 赞同：4
> 
> 时间：2012-05-11T02:05:14.600
> 
> 标签：variables, types, local, javassist

我正在使用 Javassist 重写字节码。我需要将一些局部变量的类型修改为对象。如何使用 Javassist 访问局部变量并更改其类型？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-29T09:43:56.703

这个问题很老了，但是因为我做了类似的事情，所以我会发布我的解决方案：

由于我没有找到任何解决方案来更改 Javassist 中的类中的字段类型，因此我只是删除了旧方法并添加了一个具有相同名称但我想要的类型的新方法：

```
CtClass point = ClassPool.getDefault().get("Point");
CtField toBeDeleted = point .getField("fieldName");
point .removeField(toBeDeleted);
CtField newField = CtField.make("public int fieldName = 0;", point);
point.addField(newField ); 
```

因此，在这个示例中，我采用了`fieldName`类`point`中的字段，假设类型为`Object`并且知道已在“int”类型的字段中更改并初始化为`0`

# java - Java：如何检查用户是否点击或回复电子邮件（作为电子邮件身份验证方案的一部分）？

> ID：10544488
> 
> 赞同：4
> 
> 时间：2012-05-11T02:05:48.253
> 
> 标签：java, jakarta-ee, authentication

我希望不要重新发明轮子——我对 Java 还很陌生，但我需要一个简单但强大的算法/代码/软件来为 Web 应用程序的用户执行电子邮件验证（例如，我只需要帮助下面的第 4 步）。也就是说，我需要验证登录用户是否可以访问他/她在登录期间提供的电子邮件地址。

我为 Java 中间层考虑的步骤是：

1.  Java POJO 从客户端接收用户的电子邮件和密码。
2.  POJO 与数据库服务器对话以验证电子邮件/密码组合是否有效。
3.  如果有效，POJO 会向该电子邮件地址发送一封电子邮件，要求用户回复电子邮件（或单击某些提供的链接等）
4.  **POJO 收到通知（如何？）用户已回复电子邮件（或单击链接等）。**
5.  POJO 通知 Web 应用程序认证成功（或失败），从而允许或拒绝对应用程序的访问。

除了第 4 步，我什么都可以写。本质上**，我需要一种方法来向用户发送电子邮件，然后接收某种类型的响应，表明用户收到了电子邮件。**

任何人都知道如何做到这一点？如果不是，您推荐什么作为下一个最佳/最简单的解决方案？

我没有使用框架，因为我的 Java 中间层非常简单。我想保持解决方案的精简（意思是，不想安装/实施超过我需要的东西；Spring 似乎矫枉过正）。我阅读了[Shiro](http://shiro.apache.org/java-authentication-guide.html)，但没有找到任何支持电子邮件身份验证的证据。非常感谢任何建议，以帮助我避免编写不必要的/未经证实的例程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:06:26.340

涉及两个控制器（两个 POJO）。

第一个连接，对于步骤 1,2+3，与服务器中的一个对象进行对话。作为 (2) 的一部分，生成唯一代码（注释中提到的 UUID）并将*其保存到数据库*中。

第二个连接，当用户单击链接时，转到另一个控制器（另一个 POJO，可能是同一个类，也可能是不同的类，具体取决于您的实现）。它从链接中读取 UUID，进入数据库，找到与 UUID 关联的电子邮件，并将电子邮件标记为已验证。

**更新**我正在努力查看您缺少的内容，但是当用户单击电子邮件中的链接时，操作系统会打开 Web 浏览器。Web 浏览器与服务器建立连接。服务器接收到 URL 中带有 UUID 的 HTTP GET 请求，并将 UUID 传递给 POJO。

更多术语：在网络服务器中处理传入请求的过程通常称为“路由”，用于构造代码的一般模式称为“MVC”。确切的细节将取决于您使用的应用程序框架。对于基于 servlet 的 java 代码，存在从 URL 到 servlet 的映射（servlet 是实现某个接口的 java 代码 - 框架可能会提供 servlet，它最终会调用您所调用的 POJO，或者您可以自己编写 servlet，在这种情况下那将是您的 POJO，尽管在这种情况下它是用词不当，因为它实现了 web.xml 文件中的特定接口。

另外，我猜，客户端上的 Web 浏览器使用 TCP 通过网络建立连接（几乎总是在称为 IP 的协议之上，因为您正在使用互联网）。最重要的是，客户端在 HTTP 中“说出”消息。所有这些不同的层都在“7 层 osi 网络模型”中进行了描述。

在很多层面上都有大量的细节。希望这能让你开始。

另请参阅[http://www.quora.com/What-happens-when-you-type-a-URL-into-your-browser](http://www.quora.com/What-happens-when-you-type-a-URL-into-your-browser)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T03:32:02.000

最简单的方法是让一些代码使用 POP3 或 IMAP 连接到目标地址的邮箱，并等待新的传入消息。

发送电子邮件时，您可以添加`Message-ID`标题。当用户回复电子邮件时，会有一个`References`应该有用户正在回复的 Message-ID。

您何时可以使用此 ID 来关联他们的响应内容。

为安全起见，您可能希望将 ID 嵌入消息本身（因为今天大多数人不编辑回复），因此如果由于某种原因未提供 Reference 标头，您可以查看消息的正文。还有其他技术可以让您为每封邮件提供一个客户回复地址，这是可以做到的另一种方式，但这需要一些邮件服务器的支持。

但是，无论如何，一旦您弄清楚了消息结构，您只需收听地址的收件箱，然后查找新消息。当它们到达时，您会剥离消息 ID，并在数据库中将它们标记为适当的，或其他任何东西。

至于“等待”消息，您必须意识到这可能是一个漫长的等待。与其让 POJO 等待它，不如用一个简单的过程来 ping 状态。您可以有一个每秒触发一次的计时器，然后检查数据库以查看它是否已更新等。显然，这是您希望能够取消的。

对于所有的邮件需求，您可以使用 JavaMail——它可以完成所有这些，而且使用起来非常简单。

# jquery - 遍历 JSON - 将 JSON 元素与 DOM 元素匹配？

> ID：10544489
> 
> 赞同：1
> 
> 时间：2012-05-11T02:05:54.697
> 
> 标签：jquery, json, dom, getjson, traversal

如何遍历 JSON，遍历 DOM 和 JSON 以将 json 元素与 DOM 中的元素匹配？

我有html：

```
<div class="input alpha grid_4">
<label for="enterEmail">Email Address<label>
<input id="enterEmail"  name="enterEmail" type="text" />
<span class="validMark"></span>
</div> 
```

json渲染后我想要它：

```
<div class="input alpha grid_4">
<label for="enterEmail">Email Address <a class="toolTip" href="#" title=" By providing us with an email address for your user name, you are more likely to remember it."></a></label>
<input id="enterEmail"  name="enterEmail" type="text" />
<span class="validMark"></span>
<div class="helperText">john@test.com</div>
</div> 
```

和json：

```
[
     {
           “field”:  “enterEmail”,
           “contextHelpText”:  “By providing us with an email address for your user name, you are more likely to remember it.”,
           “helperText”:  “john@test.com”
     },
     {
           “field”:  “billAddress1”,
           “contextHelpText”:  “Please enter the address associated with your billing information.” 
     }
] 
```

我在概念化循环如何运行时遇到问题，如果 json 中不存在 helpertext 或 contexHelpText，如何解决这个问题。（将它们放在json中会更好，但没有价值吗？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:14:20.733

```
var numFields = jsonData.length;
var i, field, $field, $helper;
for (var i = 0; i < numFields; i++) {
  field = jsonData[i];
  $field = $(field.field);
  if (field.contextHelpText) {
    $field.attr('title', field.contextHelpText);
  }
  $helper = $field.parent().children('.helperText');
  if ($helper && field.helperText) {
    $helper.html(field.helperText);
  }
} 
```

凌乱，但不能更好地满足您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:47:39.603

也许是这样的：？？？( [**jsFiddle**](http://jsfiddle.net/SpYk3/gJ7Mf/) )

```
$(function() {
    var jDat = [
        {
            "field":  "enterEmail",
            "label":  "Enter Email",
            "contextHelpText":  "By providing us with an email address for your user name, you are more likely to remember it.",
            "helperText":  "john@test.com"
        },
        {
            "field":  "billAddress1",
            "label":  "Bill Address 1",
            "contextHelpText":  "Please enter the address associated with your billing information." 
        }
    ];

    for (i=0;i<jDat.length;i++) {
        var newDiv = $("<div />").addClass("input alpha grid_4"), // or could draw from json data on if statemtn for the classes
            newDat = jDat[i];

        if (newDat['field']) {
            var newLbl = $("<label />").attr("for", newDat.field).text(newDat.label).appendTo(newDiv), // you'll need to add data for label of each field
                newInp = $("<input />").attr({ id: newDat.field, name: newDat.field, type: "text" }).appendTo(newDiv);
                newSpn = $("<span />").addClass("validMark").appendTo(newDiv)

            if (newDat['contextHelpText']) newLbl.append($("<a />").attr({ href: 'javascript:void(0)', title: newDat.contextHelpText }).addClass("toolTip"));
            if (newDat['helperText']) newDiv.append($("<div />").addClass("helperText").text(newDat.helperText));

            $("#contentArea").append(newDiv);
        };
    };
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T14:37:10.007

我最终得到的是关于 SO 的大量输入和其他问题。

```
function addInfoHTML(data) {

    if (typeof data != 'undefined' && data.length > 0) {
        var i;
        for (i = 0; i < data.length; i++) {
            var $fieldDom = $('#' + data[i].field);
            //make sure field dom exists
            if ($fieldDom.length > 0) {
                var parentDiv = $fieldDom.parents('div.input');

                if (typeof data[i].contextHelpText != 'undefined') {
                    //find the first label from the input.div
                    var fieldLabel = $(parentDiv).find('label'),
                        $fieldLabel = $(fieldLabel),
                        ancHtml = " <a class='toolTip' href='#' alt='" + data[i].contextHelpText + "' title='" + data[i].contextHelpText + "'>some val</a>";

                    //append fieldLabel text(Enter Email) + ancHtml (tooltip)
                    $fieldLabel.html($fieldLabel.text() + ancHtml);
                }

                if (typeof data[i].helperText != 'undefined') {
                    var helperDiv = "<div class='helperText'>" + data[i].helperText + "</div>";
                    //append the helperDiv html at the end
                    $(parentDiv).append(helperDiv);
                }
            }
        }
    }
}

//on document ready call the addInfoHtml by passing json data
$(function(){
    addInfoHTML(data);
}); 
```

# c++ - Windows服务在停止时从services.msc列表中消失，c ++

> ID：10544491
> 
> 赞同：2
> 
> 时间：2012-05-11T02:06:01.463
> 
> 标签：c++, windows-services

我在 Windows 7 上用 c++ 编写的 Windows 服务存在问题。该服务工作正常，当我“安装”它并在我“卸载”（从 services.msc 列表中）时被删除，但我有 2我希望我能得到一些帮助的问题

1.  如果我停止服务（通过 services.msc），该服务将从 services.msc 列表中消失。
2.  如果我通过我的程序停止服务，服务的启动类型将更改为禁用，因此没有“启动/停止/重新启动”按钮。

服务已成功停止。

我希望有一个正确方向的指针，我使用 MSDN 作为编写服务的指南。启动时服务正常。

谢谢你

# php - mysqli DELETE ahref 不起作用

> ID：10544496
> 
> 赞同：3
> 
> 时间：2012-05-11T02:06:32.900
> 
> 标签：php, mysqli, delete-row

我在 all 旁边列出了一个 Delete 链接`$rows`，当我将鼠标悬停在它们上时，它们反映了正确的删除 ID，但是，当我单击时，`DELETE`我被重定向到`phpfile.php?id=4`，例如，没有任何内容被删除，也没有发布错误。

```
while ($row = mysqli_fetch_array($r,MYSQLI_ASSOC))
{
    echo '<tr><td align="left">' .
    $row['title'] . '</td><td align="left">'
    . $row['genre'] . '</td><td align="left">'
    . $row['length'] . '</td><td align="left">'
    . $row['created'] . '</td><td align="left">'
    . $row['views'] . '</td><td align="left">'
    . "<a href='newwriter_profile.php?id={$row['upload_id']}'>Delete</a></td>" .      '</tr>';
}
echo '</table>'; // Close the table 
```

代码的其余部分，存在于同一页面上：

```
if(isset($_GET['id'])) {
// Get the ID
$id = intval($_GET['upload_id']);

require_once ('../mysqli_connect.php'); //Connect to the db

    $delquery = "
        DELETE 
        FROM upload
        WHERE upload_id = {$id}";
    $done = @mysqli_query ($dbc, $delquery); // Run the query

    if($done) {
        // Make sure the result is valid
        if (mysqli_num_rows($done)==1) {
        echo 'Record Deleted';
        }
        else {
            echo 'error - delete failed';
        }

        // Free the mysqli resources
        @mysqli_free_result($result);
    }
    else {
        echo "Error! Query failed:" .$mysqli_error($dbc);
    }
    mysqli_free_result($done);
    mysqli_close($dbc);
} 
```

如果我能解决这个错误，我会解决一个类似的错误，除了下载功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:09:12.887

You are pulling `$id` from the non-existent `$_GET['upload_id']` when you intend to use `$_GET['id']`. Since `$_GET['upload_id']` is not set, its value is `NULL`, which gets interpreted as 0\. Your query ends up as: `DELETE FROM upload WHERE upload_id = 0`

```
$id = intval($_GET['upload_id']);
// Should be
$id = intval($_GET['id']); 
```

Instead of using `intval()`, I would suggest using more extensive bounds checking on `$id`. If for example, a string like `"abc"` were passed in `?id=abc`, `intval("abc")` would cast it to 0 and you would pass 0 into your query. If `id` needs to be a positive integer, use something like:

```
if (ctype_digit($_GET['id'])) {
  // ok, do your query
}
else {
  // invalid input, report error to user and don't touch your database.
} 
```

Finally, we don't see the rest of your script, but it is usually *crucial* when using a hyperlink to perform a delete action (or any action for that matter) that you check ownership of the row you are attempting to delete before completing the action. Make sure that the logged-in user has permission to delete the row, and if not, don't perform any database action. Otherwise, any user could pass any value into the URL to modify others' data. Suggested reading: [The Spider of Doom](http://thedailywtf.com/Articles/The_Spider_of_Doom.aspx)

# powershell - 从来宾实例 (VM) 检测虚拟化层 - C# 或 Powershell 中的 VPC 或 Hyper-V

> ID：10544498
> 
> 赞同：4
> 
> 时间：2012-05-11T02:06:55.217
> 
> 标签：powershell, virtualization, powershell-2.0, virtual-machine, hypervisor

我想在虚拟机上运行我的应用程序，但我想了解底层虚拟化层 Hyper-V、VPC(Windows/Microsoft Virtual PC) 或 VMware。如果是 VPC，我不想运行我的应用程序。我试着环顾四周[，](http://blogs.technet.com/b/enterprise_admin/archive/2009/10/20/detecting-the-virtualization-layer-from-within-a-guest-child-instance.aspx)但在 WIn32_BIOS/MotherBoard 上使用 WMI 提出的解决方案没有区分 Hyper-V 和 VPC。我也尝试查看代码项目中提到的指令集[方法](http://www.codeproject.com/Articles/9823/Detect-if-your-program-is-running-inside-a-Virtual)。有没有办法在两者之间进行识别（Hyper-V/VPC）？我没有要测试的 Hyper-V 设置，但我有 Virtual PC 2007。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T14:08:14.140

这是我开发的用于检测此功能的脚本

```
 Function Get-VMVirtualizationLayer{

    $Manufacturer = (Get-WmiObject win32_computersystem).manufacturer
    $model= (Get-WmiObject win32_computersystem).model
    $biosversion = (Get-WmiObject win32_bios).version

    if ($model -match "Virtual Machine")

    {

    Write-Output " Virtual Machine Running on Microsoft Virtualization Platform"

            if ($biosversion -match "VRTUAL")

            {

            Write-Output " Virtual Machine Running on Hyper-V "

            }

            elseif ($biosversion -match "A M I")

            {

            Write-Output "Virtual Machine Running on Windows Virtual PC"

            }

    }

    elseif ($model -match "VMware Virtual Platform")

    {

    Write-Output "Virtual Machine is Running on VMware Virtual Platform"

    }

    elseif ($model -match "VirtualBox")

    {

    Write-Output "Virtual Machine is Running on VirtualBox"

    }

    }

    Get-VMVirtualizationLayer 
```

将整个代码粘贴到虚拟机上的 powershell 提示符中，它会让你知道虚拟化平台

或者您可以将整个代码复制粘贴到记事本中并将其另存为 Get-VMVirtualizationLayer.ps1

运行脚本后，您将获得所需的输出，这是我在 Hyper-V 中托管的虚拟机上运行脚本时的输出：)

```
PS C:\INSTALL> .\Get-VMVirtualizationLayer.ps1
 Virtual Machine Running on Microsoft Virtualization Platform
 Virtual Machine Running on Hyper-V
PS C:\INSTALL> 
```

# mysql - UPDATE Syntax with ORDER BY, LIMIT and Multiple Tables

> ID：10544502
> 
> 赞同：6
> 
> 时间：2012-05-11T02:07:32.720
> 
> 标签：mysql, syntax, sql-update

Learning SQL, sorry if this is rudimentary. Trying to figure out a working `UPDATE` solution for the following pseudoish-code:

```
UPDATE tableA 
SET tableA.col1 = '$var'
WHERE tableA.user_id = tableB.id
AND tableB.username = '$varName'
ORDER BY tableA.datetime DESC LIMIT 1 
```

The above is more like `SELECT` syntax, but am basically trying to update a single column value in the **latest row** of tableA, where a username found in tableB.username (represented by $varName) is linked to its ID number in tableB.id, which exists as the id in tableA.user_id.

Hopefully, that makes sense. I'm guessing some kind of `JOIN` is necessary, but subqueries seem troublesome for `UPDATE`. I understand `ORDER BY` and `LIMIT` are off limits when multiple tables are involved in UPDATE... But I need the functionality. Is there a way around this?

A little confused, thanks in advance.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-11T14:58:47.123

解决方案是将 ORDER BY 和 LIMIT 作为连接的一部分嵌套在 FROM 子句中。这让您首先找到要更新的确切行 (ta.id)，然后提交更新。

```
UPDATE tableA AS target
    INNER JOIN (
      SELECT ta.id
      FROM tableA AS ta
        INNER JOIN tableB AS tb ON tb.id = ta.user_id
        WHERE tb.username = '$varName'
        ORDER BY ta.datetime DESC
        LIMIT 1) AS source ON source.id = target.id
    SET col1 = '$var'; 
```

向 Baron Schwartz（又名 Xaprb）致敬，以获取关于这个确切主题的出色帖子： [http ://www.xaprb.com/blog/2006/08/10/how-to-use-order-by-and-limit-在-multi-table-updates-in-mysql/](http://www.xaprb.com/blog/2006/08/10/how-to-use-order-by-and-limit-on-multi-table-updates-in-mysql/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-29T16:49:20.413

您可以使用以下查询语法：

```
update work_to_do as target
   inner join (
      select w. client, work_unit
      from work_to_do as w
         inner join eligible_client as e on e.client = w.client
      where processor = 0
      order by priority desc
      limit 10
   ) as source on source.client = target.client
      and source.work_unit = target.work_unit
   set processor = @process_id; 
```

这完美地工作。

# php - Error when try to use twig in slim, Fatal error: TwigView::getEnvironment()

> ID：10544503
> 
> 赞同：3
> 
> 时间：2012-05-11T02:07:49.970
> 
> 标签：php, php-5.3, twig, slim

i have a problem when i want to try implementation slim with Twig View.
the error :

```
Fatal error: TwigView::getEnvironment() [function.require]: Failed opening required '/Autoloader.php' (include_path='.:/opt/local/etc/php5') in /opt/local/apache2/htdocs/slim/Slim-Extras/Views/TwigView.php on line 87 
```

this is my code

```
require '/opt/local/apache2/htdocs/slim/Slim/Slim.php';
 17 require '/opt/local/apache2/htdocs/slim/Slim-Extras/Views/TwigView.php';
 18 /*
 19  * initialize slim to use TwigView Handler
 20  */
 21 $app = new Slim(array(
 22       'view'=> new TwigView()
 23 ));
 24 //$app->init(array('view' => 'TwigView'));
 25 $app->get('/',function() use ($app){                                                                                                                                            
 26    $title = "hi there are new twig";
 27    $body = "and this is body maybe you are have idea for this content...:)";
 28    $data = array('title' => $title, 'body' => $body);
 29    $app->view()->setData(array('title' => $title, 'body' => $body));
 30    $app->render('TopPage.html');
 31   // echo "hai you are coll man";
 32 
 33 });
 34 $app->get('/hello/',function(){
 35     echo 'Hello' ;
 36 });
 37 $app->get('/hello/:name',function($name){
 38     echo "yaay...exellent ".$name;
 39 });
 40 $app->run(); 
```

any suggestion? i don't know why i got error like that.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T06:45:19.027

对不起，我自己解决了我的问题，我找到了解决方案。

从 git 下载 Twig 示例

```
git clone git://github.com/fabpot/Twig.git 
```

并在您的苗条 php 文件中，设置 twig 目录示例，如下所示

```
TwigView::$twigDirectory = '/opt/local/apache2/htdocs/slim/Twig/lib/Twig';
 TwigView::$twigExtensions = array(
      'Twig_Extensions_Slim'
  ); 
```

# ruby-on-rails - Rails 3 应用程序中的急切加载

> ID：10544512
> 
> 赞同：1
> 
> 时间：2012-05-11T02:09:39.480
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试减少 Rails 3 应用程序中的数据库查询数量。

用户型号：

```
has_many :agreements 
```

协议模式：

```
belongs_to :user 
```

协议表有两个用户 ID 字段... payer_id 和 payee_id。是否可以进行以下工作：

```
user_payer_agreements = current_user.agreements
user_payee_agreements = current_user.agreements 
```

我可以将 user_id 用于交易的一侧，但我需要获得双方。是否可以在创建关联的过程中指定 payer_id 或 payee_id 而不是 user_id？如果没有，我需要使用联接还是 sql 语句。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T04:07:51.507

你可以这样做：

```
has_many :payer_agreements, :class_name => 'Agreement', :foreign_key => :payer_id
has_many :payee_agreements, :class_name => 'Agreement', :foreign_key => :payee_id 
```

有了这个，你可以这样做：

```
current_user.payer_agreements
current_user.payee_agreements 
```

这是你想要的？

# python - Breaking out of a recursive function?

> ID：10544513
> 
> 赞同：23
> 
> 时间：2012-05-11T02:09:44.913
> 
> 标签：python, recursion

I'm wondering how to break out of a recursive loop to the main function. I am trying to do a simple palindrome exercise. The function should return True for `"redivider"` but the `return True` is being passed to `is_pal()` and the function isn't breaking. Short of adding a second variable to `is_pal` to track True/False, what is the proper way to break out of this recursive loop?

```
def first(word):
    return word[0]

def last(word):
    return word[-1]

def middle(word):
    return word[1:-1]

def is_pal(str):    
    if len(str) == 1: 
        return True

    if first(str) == last(str) and len(str) > 1: 
        is_pal(middle(str))

print is_pal("redivider") 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-11T02:18:20.863

```
def is_pal(str):    
    if len(str) <= 1: 
        return True

    if first(str) == last(str): 
        return is_pal(middle(str))
    else:
        return False 
```

这样，如果它们不匹配，`False`则返回；如果它一直到最后，则返回 True。我还消除了冗余条件并检查了偶数长度回文的边缘情况。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-11T02:31:08.640

你不会“打破”递归函数。试图这样做表明你以错误的方式思考他们。目前你的递归调用忽略了输出，这意味着递归是没有意义的；无论`is_pal(middle(str))`返回什么都对函数的返回值没有影响。

递归算法通过将问题分解为较小的问题来解决输入问题，递归地得到较小问题的解决方案，然后使用较小的解决方案构造较大问题的正确解决方案。您不会“打破”内部调用，而是将解决方案返回到一个级别。您不知道（或需要知道）您是处于内部呼叫还是顶级呼叫中。在任何一种情况下，你的函数都应该做同样的事情：`True`如果参数是回文，`False`则返回，否则返回。

您尝试实现的算法基本上是这样的：

1.  如果字符串长度为 1，则为回文（return `True`）
2.  否则，如果第一个字符与最后一个字符相同，则如果中间字符是回文，则输入是回文。

所以这意味着一旦你确定第一个和最后一个字符是相同的，“我的输入是回文”的答案与“中间字符是回文”的答案**完全相同。**您需要返回该答案以履行您的合同。所以递归调用应该`return is_pal(middle(str))`不仅仅是`is_pal(middle(str))`. 如果这是一个顶级电话，那就是答案；如果这*不是*顶级调用，那么外部调用将需要这个答案来解决外部问题的答案（在这种情况下，只需返回它）。

* * *

顺便说一句，您的算法还有其他一些问题。

1.  你永远不会 return `False`，所以答案永远不会是`False`（在这种情况下，如果第一个和最后一个字符不匹配，你碰巧`None`从函数的末尾掉下来意外返回，并且在大多数情况下`None`可能会代替`False`，但它仍然不是真的*正确*）。

2.  如果字符串的长度是**0**而不是 1（如果传入一个空字符串，**或者**如果传入一个偶数长度的回文，一旦所有相等的第一个和最后一个字符对被剥离，就会发生这种情况），那么你不返回正确答案，实际上你试图获取空字符串的第一个和最后一个字符，这会导致异常。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2018-03-26T15:18:21.070

在 Python 中打破递归函数的一种方法是抛出异常并在顶层捕获它。有人会说这不是思考递归的正确方法，但它可以完成工作。此外，如果任务是识别数组/数组数组/ndarray 等中的“问题”元素，则中断技术很方便，因为它会在识别出全局解决方案后阻止算法继续进行。

```
def solve_problem(lst):
    def solve_rec(l):
        '''has impl. that may throw an exception '''
    try:
        solve_rec(lst)
        return True
    except:
        return False 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-07-07T07:43:30.703

`exit()`您可以在使用该功能打印结果后退出程序。

这可能不是一个好的做法，但它可能是您正在寻找的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T02:17:19.613

你错过了回报。另外，不要`str`用作变量名。最后一件事，第一个和最后一个函数可以命名得更好一些。

```
def first_letter(word):
    return word[0]

def last_letter(word):
    return word[-1]

def middle(word):
    return word[1:-1]

def is_pal(word):    
    if len(word) == 1: 
        return True

    if first_letter(word) == last_letter(word) and len(word) > 1:
        return is_pal(middle(word))

print is_pal("redivider") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-11T02:18:32.737

您需要返回 False 以防它们不匹配并添加返回语句。此外，您可能需要检查 len(str)==0 和 len(str)==1：

```
def is_pal(str):
    if len(str) in [0, 1]:
        return True
    if first(str) == last(str) and len(str) > 1:
        return is_pal(middle(str))
    else :
        return False 
```

# android - How to stop a running thread when Activity on destroy at Android?

> ID：10544515
> 
> 赞同：4
> 
> 时间：2012-05-11T02:09:57.703
> 
> 标签：android

I used some thread objects in my Android activity. But these threads do not stop itself when Activity on destroy. My code for thread-stopping as following:

```
@Override
public void onDestroy() {
    super.onDestroy();
    thread.interrupt();
} 
```

Above code is not only working for thread object stopping but also throws an InterruptedException. What's the correct way to stop a running thread without exceptions?

* * *

is it not an error when thread object throws InterruptedException?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:32:42.737

试试这种方式：

```
volatile boolean stop = false;

public void run() {
    while ( !stop ) {
     log.v("Thread", "Thread running..." );
      try {
      Thread.sleep( 1000 );
      } catch ( InterruptedException e ) {
      log.v("Thread","Thread interrupted..." );
      }
    }
}

@Override
public void onDestroy() {
    stop = true;
    super.onDestroy();

} 
```

和

```
@Override
public void onDestroy() {
    thread.interrupt();
    super.onDestroy();   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T07:41:31.070

试图从外部停止线程是不可靠的。

我建议在您的应用程序中使用 SharePreferences 或 Application Context（例如 IS_APP_ACTIVE ）使用全局参数，
并让线程自行终止。

让我试着解释一下……

在您的活动中

```
protected void onResume() {
        super.onResume();

// isAppActive
        CommonUtils.setAppActive(mContext, true);
}

protected void onPause() {
        super.onPause();

// isAppActive
        CommonUtils.setAppActive(mContext, true);
} 
```

在你的线程中

```
if ( !CommonUtils.isAppActive(mContext) ) 
```

刚刚离开线程循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-11T07:22:48.370

我是这样表演的。在你的活动中

```
@Override
public void onDestroy() {
    super.onDestroy();
    thread.interrupt();
} 
```

在你的线程中

```
@Override
public void run() {
    // stop your thread
    if (interrupted()) {
        return;
    }
    // do your work
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-05-11T02:20:20.373

`finish();`当调用 onDestroy() 或其他任何东西（例如按下按钮）时，添加应该结束 Activity。当您使用 onDestroy() 时，请确保`super.onDestroy();`将其放在调用其他所有内容之后。

# java - How to format a decimal number as currency.

> ID：10544516
> 
> 赞同：0
> 
> 时间：2012-05-11T02:10:08.670
> 
> 标签：java, jsp, number-formatting

I wanted to write price for the product in vector using number format. Here is my code

```
<%!
        class product
        {
            public String name;
            public int price;
            public String image;

            public product()
            {
            }
        }
    %>
<%
    NumberFormat nf = NumberFormat.getCurrencyInstance();
    DecimalFormatSymbols dfs = new DecimalFormatSymbols();
    dfs.setCurrencySymbol("$ ");
    dfs.setGroupingSeparator('.');
    dfs.setMonetaryDecimalSeparator('.');
    ((DecimalFormat) nf).setDecimalFormatSymbols(dfs);

    Vector<product> vec = new Vector<product>();
    gallery obj;

    obj=new product();
    obj.nama="Dark Chocolate";
    obj.price=Integer.parseInt(nf.format(3040000));
    obj.image="Image/Dark chocolate.jpg";
    vec.add(obj);

    obj = new product();
    obj.nama="Woodhouse Chocolates";
    obj.price=Integer.parseInt(nf.format(6000500));
    obj.image="Image/woodhouse_chocolates.jpg";
    vec.add(obj);

    obj = new product();
    obj.name="Semisweet Chocolate";
    obj.price=Integer.parseInt(nf.format(3050000));
    obj.image="Image/Semisweet chocolate.jpg";
    vec.add(obj);

    obj = new product();
    obj.name="White Chocolate";
    obj.price=Integer.parseInt(nf.format(2948000));
    obj.image="Image/White chocolate.jpg";
    vec.add(obj);

%> 
```

It said

> org.apache.jasper.JasperException: An exception occurred processing JSP page

at this section

```
 obj.price=Integer.parseInt(nf.format(3040000));
 obj.price=Integer.parseInt(nf.format(6000500));
 obj.price=Integer.parseInt(nf.format(3050000));
 obj.price=Integer.parseInt(nf.format(2948000)); 
```

Where's my the mistake? Could anyone help me?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:13:57.887

您正在尝试用一堆随机字符格式化一个数字，*然后*尝试将其解析为整数。

那不管用。

[整数](http://www.techterms.com/definition/integer)是没有小数部分和花哨字符的整数。

如果您尝试将其解析为整数，则 0-9（或负号）以外的任何字符都将引发 NumberFormatException。

...并且（就像*iangreen*说的）你应该把你的代码放在一个 try 块中。

...*并且*（就像*iangreen*说的那样）您可以轻松地将此代码移动到其他可以更轻松地对其进行测试/调试的地方*（* IDE 或控制台程序）。

...*并且*您应该始终以大写字母开头类名。

* * *

鉴于您在创建产品之前尝试格式化价格，您应该将它们作为字符串存储在您的产品类中。 *或者*您可以将它们存储为双精度或浮点数并在其他时间格式化它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:38:17.457

这完全没有意义。您正在尝试将整数格式化为人类可读的格式`String`，然后将其解析回`int`理论上会导致所有格式丢失。`int`无法存储格式。它应该存储在`String`. 但是，当你这样做是错误的时候，它应该在演示期间完成，而不是在预处理期间。您不应该`String`在格式上徘徊。

使用[JSTL](https://stackoverflow.com/tags/jstl/info) [`<fmt:formatNumber>`](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fmt/formatNumber.html)。

```
<fmt:formatNumber value="${product.price}" type="currency" currencyCode="USD" /> 
```

它将以标准美元格式对其进行格式化，并自动为`$`货币符号添加前缀。

我也会改变`int`，`BigDecimal`否则你不能谈论真正的价格格式。您不能在`int`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T02:12:33.647

将您的代码包装在 try/catch 中并打印出异常。更好的是 - 将您的代码移动到一个 java 类中并编写一个单元测试，以便您可以在 IDE 中快速执行它

# ios - iOS heapshot analysis, UIImage & NSData

> ID：10544517
> 
> 赞同：1
> 
> 时间：2012-05-11T02:10:09.630
> 
> 标签：ios, memory-management, heapshot

I used the heapshot analysis, and it pointed to the first two lines reproduced below. It seems like I am releasing all the memory I am allocating. I don't see how the memory is accumulating.

```
 NSData* data = [NSKeyedUnarchiver unarchiveObjectWithFile:archivePath];
        UIImage *view = [[UIImage alloc] initWithData:data];        

        background = [[UIImageView alloc] initWithImage:view];
        [view release];
        [display addSubview: background];
        if(fileExists){
            [background addSubview: newView];
        }
        [background release]; 
```

# javascript - Two onClick actions one button

> ID：10544520
> 
> 赞同：19
> 
> 时间：2012-05-11T02:11:06.427
> 
> 标签：javascript, html

Does someone know a wizards trick to make it work ?

```
<input type="button" value="Dont show this again! " onClick="fbLikeDump();" onclick="WriteCookie();" /> 
```

PS: I am using it in a .js file.

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-05-11T02:12:32.630

其他属性（在本例中为第二个`onClick`）将被忽略。因此，它不会`onclick`同时调用`fbLikeDump();`and `WriteCookie();`，而只会调用`fbLikeDump();`。要修复，只需定义一个`onclick`属性并在其中调用两个函数：

```
<input type="button" value="Don't show this again! " onclick="fbLikeDump();WriteCookie();" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T02:12:41.437

试试看：

```
<input type="button" value="Dont show this again! " onClick="fbLikeDump();WriteCookie();" /> 
```

或者也

```
<script>
function clickEvent(){
    fbLikeDump();
    WriteCookie();
}
</script>
<input type="button" value="Dont show this again! " onClick="clickEvent();" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T02:19:19.800

给你的按钮一个像这样的 id：

```
 <input id="mybutton" type="button" value="Dont show this again! " /> 
```

然后使用 jquery （使这个不显眼）并附加点击操作，如下所示：

```
 $(document).ready(function (){
    $('#mybutton').click(function (){
       fbLikeDump();
       WriteCookie();
    });
}); 
```

（这部分也应该在你的 .js 文件中）

我应该提到您将需要页面上的 jquery 库，因此在结束正文标记之前添加这些：

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://PATHTOYOURJSFILE"></script> 
```

在正文结束标记之前添加的原因是为了提高感知的页面加载时间

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-11T02:12:13.223

```
<input type="button" value="..." onClick="fbLikeDump(); WriteCookie();" /> 
```

# c - 代码有什么问题？

> ID：10544522
> 
> 赞同：2
> 
> 时间：2012-05-11T02:11:32.143
> 
> 标签：c

```
void* myfunction() { 
char *p; 
    *p = 0; 
    return (void*) &p; 
} 
```

我知道问题出在 return 语句中，但它令人困惑。有什么提示吗？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T02:14:47.293

您在 .return 语句之前有问题`*p = 0;`。你还没有初始化`p`，所以这会写入未初始化指针碰巧持有的任何随机位置。这给出了未定义的行为，因此之后没有任何有意义的解释。

假设您解决了这个问题，那么是的，return 语句也是一个问题——您将返回一个指向在返回完成之前被破坏的数据的指针，因此任何使用您返回的指针的尝试都会再次导致未定义的行为。

# java - 没有“：”的时区的java日期模式

> ID：10544524
> 
> 赞同：1
> 
> 时间：2012-05-11T02:11:37.487
> 
> 标签：java, datetime, jodatime, date-parsing

我将使用第三方 API。他们接受如下日期模式：

```
2012-02-15T17:34:37.937-0600 
```

我知道模式应该匹配

```
yyyy-MM-ddTHH:mm:ss.s 
```

但我不确定如何表示最后一个“-0600”时区？我认为标准时区是“-06:00”，有人知道如何摆脱日期模式中的“：”吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T02:14:21.490

也许你想要“Z”？

请参阅[http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)：

> *   'z' 为您提供“太平洋标准时间；太平洋标准时间；GMT-08:00”
> *   'Z' 给你“-0800”

这段代码：

```
final SimpleDateFormat f = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SZ"); 
```

产生：

> 2012-05-11T12:21:57.598+1000

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:16:12.683

java.text.SimpleDateFormat 应该对自定义字符串表示非常有帮助：

Z 时区 RFC 822 时区 -0800

# php - Any existing services for upload a huge video file (~5gb) via browser?

> ID：10544528
> 
> 赞同：1
> 
> 时间：2012-05-11T02:12:17.380
> 
> 标签：php, file, http, video, upload

My client having a requirement that need to upload huge video files (e.g. 5GB) to his own server via browser, need have progress bar and pause/resume would be even better.

Wondering if there's any existing services (paid or not) for doing such a thing. Also any technique that I might able to implement this by myself. I've seen Vimeo allows user upload huge file by HTTP, not sure how they make it.

Currently I'm using JAVA FTP applet but it really slow and not that stable if transferring time is hours (e.g. I got socket exception, peer reset). So really keen to seek some more stable and lightweighted solution

Any tips?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:29:49.083

为了使用浏览器上传如此大的文件，您可以使用 SWFUpload 和原生 HTML4 方法，如果用户选择一个大文件，系统会提示他单击一个按钮来切换原生上传器。在 Webkit、Firefox 和 IE8 中，这似乎对 10+ GB 范围内的文件非常有效。

记住 Youtube 在 Google 的自定义服务器软件上运行。

# freebsd - newsyslog：pid 文件不存在：/var/run/lighttpd.pid

> ID：10544533
> 
> 赞同：0
> 
> 时间：2012-05-11T02:12:39.937
> 
> 标签：freebsd, lighttpd, pid, rc

我们在 FreeBSD 7.2-RELEASE 上运行 lighttpd-1.4.26。每次我们重启机器，并且 lighttpd 是通过 rc 脚本启动的，pid 文件不会自动写入 /var/run/lighttpd.pid。但是，如果我们通过运行 /usr/local/etc/rc.d/lighttpd start 手动启动 lig​​httpd，pid 文件就可以了。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T16:20:38.617

当您说“lighttpd 由 rc 脚本启动”时，您是指 /usr/local/etc/rc.d/lighttpd 还是其他一些脚本？

因为你真的应该使用相同的脚本——事实上，/usr/local/etc/rc.d/lighttpd 会在启动时为你启动它，如果你在 rc.conf 中设置了 lighthttpd_enable——但是你的措辞让我想一想，您在启动时使用了不同的脚本。甚至可能是，您为此目的编辑了 /etc/rc（一个很大的禁忌）。

# jquery - 使用 load() 触发两次的动态内容加载

> ID：10544539
> 
> 赞同：0
> 
> 时间：2012-05-11T02:13:11.977
> 
> 标签：jquery

这是我的功能：

```
$(".link").click(function(event){
    event.preventDefault();
    event.stopPropagation();
    pageLoad = $(this).data('page');
    $('div#loading').fadeIn();
    $('div#content').load('pages/'+pageLoad);
}); 
```

我的页面上有一个带有 id 内容的 div，它显示了被调用的页面，但是它似乎加载了两次页面。我知道这一点是因为其中一个页面以打乱的顺序显示某些内容，并且我可以看到它加载了两次。有趣的是，当我添加时它工作正常

```
throw new Error('something here'); 
```

到函数的末尾，如下所示：

```
// LINK CLICK
$(".link").click(function(event){
    event.preventDefault();
    event.stopPropagation();
    pageLoad = $(this).data('page');
    $('div#loading').fadeIn();
    $('div#content').load('pages/'+pageLoad);
    throw new Error('bla bla');
}); 
```

但其他任何事情都会导致它触发两次。我尝试重新安排事情等等，但它仍然存在。我使用此功能的链接很简单：

```
<a href="#" class="link" data-page="whatever.php">link</a> 
```

只有一个 jQuery 1.7.2 实例被调用。我不知道该怎么做。我还尝试了 live() 和 on() 函数并体验了完全相同的结果。

！！！编辑 ！！！

```
$(".link").click(function(event){
    event.preventDefault();
    event.stopPropagation();
    pageLoad = $(this).data('page');
    console.log('clicked');
    $('div#loading').fadeIn(function() {
        console.log('faded');
        $('div#content').load('pages/'+pageLoad+'.php', function() {
            console.log('loaded');
        });
    });
}); 
```

现在......这就是真正有趣的地方。我没有更改我的链接之一

```
data-page="page.php" 
```

只是

```
data-page="page" 
```

（因为 .php 现在直接包含在函数中）

当我单击任何应该按预期工作的链接时，我会被加载、单击，然后在我的错误控制台中消失。每人只有一个。页面加载两次。但是，当我单击不应该工作的链接时（因为它包含 .php）它仍然有效！我在错误控制台中收到三个单词和一个错误，如下所示：

```
layout.js:25 clicked
layout.js:27 faded
jquery.min.js:4 GET pages/login1.php.php 404 (Not Found)
layout.js:29 loaded 
```

但是每次我点击它时，页面仍然会加载到内容 div 中，并且它只会像它应该加载的那样加载一次......

因此，从我在这里建立的情况来看，当我单击链接时，jquery 获取 page.php 和 page.php.php 时发生了一些奇怪的现象

```
<a href="#" class="link" page="login1.php"> 
```

当我尝试使用以下链接获取甚至不在我的服务器上的页面时，会显示证明：

```
<a href="#" class="link" data-page="no">no</a> 
```

，我遇到了 2 个错误：

```
jquery.min.js:4 GET pages/no 404 (Not Found)
jquery.min.js:4 GET pages/no.php 404 (Not Found) 
```

这怎么可能？为什么 jquery 会这样做？任何人都可以尝试解释这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:23:18.350

找出为什么会发生这种情况的最好方法（看起来你已经尽你所能来防止事件冒泡）是在点击处理程序中设置一个断点并检查到该点的堆栈跟踪。

如果它运行了两次，那么在第二次运行时，您应该知道为什么它又被触发了。

通过抛出一个异常，我猜你打破了一些 jQuery 循环。

# bash - 使用带有别名的“nice”命令

> ID：10544540
> 
> 赞同：4
> 
> 时间：2012-05-11T02:13:18.667
> 
> 标签：bash

如何使用带有别名的“nice”命令？

举个例子：

```
alias list=ls
list # works
nice -10 list # doesn't work 
```

我怎样才能使最后一行工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T02:28:05.557

Alias 是一个 shell 功能，`nice`是一个外部程序：

```
$ type nice
nice is hashed (/usr/bin/nice) 
```

它`nice`是运行作为参数传递的命令的程序，调用 C 函数`execve`，因此它的所有参数都需要在调用之前进行评估。

因此，最好不要使用别名，只需将所需的整个命令放在那里，但如果你真的想要，你可以尝试这样的事情：

```
$ nice -10 `alias list | sed "s/^\(alias \)\?[^=]\+='//; s/'$//;"` 
```

`alias list`以格式`alias list='ls'`（或者`list='ls'`，如果是`/bin/sh`）打印别名定义，所以我在那里做了一些 sed 替换，只得到它扩展的命令。

如果你确定只使用`bash`你可以使用`${BASH_ALIASES[list]}`，如评论中指出的那样：

```
$ nice -10 ${BASH_ALIASES[list]} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-04T23:51:25.533

虽然可能不像`nice -10 $UserVar1;`or那样令人兴奋`nice -10 ${BASH_ALIASES[list]}`，但您可能也有`nice -10 list`您所要求的，尽管通过包装脚本而不是别名：

```
# one-time setup
mkdir -p ~/.local/aliases
echo 'PATH=$HOME/.local/aliases:$PATH' >> ~/.bashrc
# open new terminal window, or
source ~/.bashrc

# create the wrapper. $@ to passthrough args.
echo 'ls $@' > ~/.local/aliases/list
chmod +x ~/.local/aliases/list

nice -10 list # works :)
nice -10 list --color=always -lathr # args passthrough also works :) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-21T13:02:29.420

对于 Zsh BASH_ALIASES 将不起作用。所以你可以这样使用它：

```
nice -10 `list` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T04:27:45.810

这是一个坏主意。您正在定义命令别名，但甚至没有将其用作别名扩展。这里的编码实践不佳。这就是你想要的。

```
declare -x UserVar1='ls';

nice -10 $UserVar1; 
```

如果您以后不会在代码中更改 UserVar1 的定义。您可以证明使用变量而不是实际命令名称的理由为零。

你正走向灾难。**简单明了**。使用变量或命令名称本身会更安全、更高效且更易于阅读。

# ruby - 代码不执行？

> ID：10544542
> 
> 赞同：0
> 
> 时间：2012-05-11T02:13:29.060
> 
> 标签：ruby

我有以下代码：

```
Array.class_eval do
    def abs_sort
        new_array = self
        self.each do |x|
            new_array.push(x.abs)
        end
        return new_array.sort
    end
end 
```

当我尝试运行代码时：

```
[1, 4, -2].abs_sort 
```

什么都没有发生，它只是显示一个空白屏幕。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T02:16:52.763

您需要设置`new_array`为实际的新数组，而不是`self`：

```
new_array = [] 
```

发生的事情是，因为`new_array`is `self`，您在*迭代它*时将项目添加到数组的末尾，这意味着迭代永远不会结束，因为您总是有更多的项目，并且您的方法无限循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T02:24:46.727

你在初始化时犯了一个错误`new_array`。无论如何，这是一个更简洁的解决方案：

```
Array.class_eval do
  def abs_sort
    map(&:abs).sort
  end
end 
```

# debugging - F# 调试。CLR

> ID：10544545
> 
> 赞同：5
> 
> 时间：2012-05-11T02:13:45.563
> 
> 标签：debugging, f#, clr, windbg, sos

我想多看看为某些功能生成的 ASM (F#->IL->ASM)，纯粹是出于好奇和学习。

我心中的答案是使用 SOS.dll，但我遇到了一些障碍......

让我们从 F# 中最基本的代码开始。文件名为 test.fs。

```
[<EntryPoint>]
  let main _ = 
    stdin.ReadLine()
    1 
```

我们正在定义一个入口点，它采用 'a （由于明显的原因（琐事：不能在入口点函数中使用“'a”？），但没有告诉我们 (?) 到字符串数组的约束）。然后我们等待用户输入。这使得在 windbg 中手动破解变得容易得多。编译 test.fs 生成 test.exe

打开windbg，打开windbg里面的test.exe：

```
>!load C:\Windows\Microsoft.NET\Framework64\v4.0.30319\sos.dll
>g 
```

Windbg 将运行我们的代码并等待 readline 循环，然后我们可以在控制台窗口中输入一些内容，windbg 将退出。

现在，我们如何在 main 上放置一个断点，以便我们可以在readline 循环*之前中断？*

```
>!bpmd test.exe Test.main; g 
```

然后windbg将进入readline循环......我期待它在readline循环之前中断，断点必须定义不明确。在此之后，我尝试了许多断点变体： !bpmd test.exe Test.main; !bpmd test.exe 测试；!bpmd test.exe 主程序；!bpmd test.exe 主要；!bpmd test.exe Main.test !bpmd test.exe Test... 等（但可能错过了一个）很明显我做错了什么，我也尝试过使用模块 xx = ...，

***问题：谁能告诉我如何使用 SOS 扩展从 windbg 中在 F# 托管代码中放置断点？***

参考：

[http://winterdom.com/2011/06/have-fun-with-windbg](http://winterdom.com/2011/06/having-fun-with-windbg)

[http://social.msdn.microsoft.com/Forums/en-US/clr/thread/a0ab6170-d53b-4c95-8f5e-efaf4e014fcd](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/a0ab6170-d53b-4c95-8f5e-efaf4e014fcd)

[http://blogs.msdn.com/b/vancem/archive/2006/09/05/742062.aspx](http://blogs.msdn.com/b/vancem/archive/2006/09/05/742062.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T02:35:58.300

试试 !sosex.mbm，它采用带有 */? 的方法过滤器。通配符语法类似于命令行。也可以试试 !sosex.mbp，它接受一个源文件、行号和可选的列号。要反汇编，请使用 !sos.dumpil 或 !sos.U。对于 source/IL/native 的交错反汇编，试试 !sosex.muf。

# ios - 在一个紧密的循环中读取或写入 NSUserDefaults 是不是很糟糕？

> ID：10544558
> 
> 赞同：1
> 
> 时间：2012-05-11T02:15:16.180
> 
> 标签：ios, object, loops, nsuserdefaults

重复设置 NSUserDefaults 中的 key 对象是否有任何性能或其他后果？

```
[self.myDefaults setObject:someObject forKey:someKey]; 
```

和/或

```
anObject = [self.myDefaults objectForKey:someKey]; 
```

我的循环将在一秒钟内重复大约 100 次，并且一次只持续几秒钟。

我只会`synchronize`在循环完成后调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T02:28:55.247

[NSUserDefaults 文档](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)状态： “ NSUserDefaults 缓存信息以避免每次需要默认值时都必须打开用户的默认数据库。”

因此，从内存字典变量中设置或获取对象没有什么不同。

但是，在类型循环中调用`[self.myDefault synchronize];`会产生性能影响，因为这会打开并写入磁盘上的默认数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:32:11.240

据我了解，NSUserDefaults 并不是存储大量数据的最佳数据存储。对于较大的数据集，建议写入 plist 或 sqlite。用户默认值仅用于一些用户偏好设置，而不是像典型数据库那样为“存储数据”而构建。

但是，您不应该在循环中真正遇到性能问题，除非您正在为每次迭代进行同步。

# visual-studio-2010 - 为 Allegro 插件添加运行时依赖项？

> ID：10544559
> 
> 赞同：0
> 
> 时间：2012-05-11T02:15:16.760
> 
> 标签：visual-studio-2010, dependency-management, allegro, allegro5

我正在尝试使用一些 Allegro 插件库。

例如：

```
#include <allegro5/allegro_primitives.h> 
```

但是 MSVS10 告诉我我所引用的东西是未定义的。我得到了标准

```
#include <allegro5/allegro.h> 
```

工作得很好，现在我猜我还需要为插件添加更多运行时依赖项。但我不知道该怎么做，也找不到指南/列表来说明需要将哪些值添加到属性中的哪些值字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T05:29:29.917

来自[http://alleg.sourceforge.net/a5docs/refman/primitives.html#al_draw_filled_polygon](http://alleg.sourceforge.net/a5docs/refman/primitives.html#al_draw_filled_polygon)：

> 自：5.1.0

预构建的二进制文件来自 5.0“稳定”系列。5.1 系列是“开发”，这意味着事情可以随着版本的变化而变化。一些功能可能会进入 5.0 系列，而大多数功能要等到下一个稳定系列（5.2）才会出现。

如此简短的版本是，如果您现在想要这些功能，您需要自己构建 5.1。

# regex - 使正则表达式匹配粗体 - VB.NET

> ID：10544561
> 
> 赞同：1
> 
> 时间：2012-05-11T02:15:28.230
> 
> 标签：regex, vb.net

这是我目前的正则表达式：`\[b\](.*?)\[/b\]`

这工作得很好，它完全取代了我想要的。但是，我试图弄清楚如何`[b][/b]`用粗体字符串替换字符串之间的字符串，但实际文本保持不变。

示例字符串：`[b]This is an example![/b]`

期望的输出：**这是一个例子！**

我正在使用 VB.NET，这就是我目前拥有的：

```
Dim reg As New Regex("\[b\](.*?)\[/b\]")
Dim str As String = String.Empty
For Each m As Match In reg.Matches(MainBox.Text)
  str = reg.Replace(MainBox.Text, "test")
Next

Preview.Show()
Preview.RichTextBox1.Text = str
Preview.Size = New Size(Preview.MaximumSize.Width, Preview.MaximumSize.Height) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:31:38.887

您需要设置选择的开始，并在插入之前设置文本的属性。

```
Preview.RichTextBox1.SelectionStart = Preview.RichTextBox1.Text.Length
Preview.RichTextBox1.SelectionFont = New Font("Tahoma", 12, FontStyle.Bold)
Preview.RichTextBox1.SelectedText = str 
```

# javascript - Backbone.js 在哪些方面不支持组合视图？

> ID：10544566
> 
> 赞同：3
> 
> 时间：2012-05-11T02:16:16.677
> 
> 标签：javascript, model-view-controller, backbone.js

我在这里指的是这篇文章

[http://codebrief.com/2012/01/the-top-10-javascript-mvc-frameworks-reviewed/](http://codebrief.com/2012/01/the-top-10-javascript-mvc-frameworks-reviewed/)

在我当前的应用程序中，我有两个视图。第一个是呈现表格的整体视图。第二个视图呈现单独的行并由主视图使用。我的行视图可以分成一个单独的文件并用于任何其他组件。这在什么方面是不可组合的？也许我误解了文章中使用的术语。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T03:36:43.700

那篇文章的作者特别提到了与主干视图对象相结合的可组合视图模板，如 Handlebars。

他本质上是想采用视图优先的合成方法，其中模板将定义哪些视图被合成到最终视图中。此组合还将确定使用哪些对象来运行视图。

例如，在 EmberJS 中，您可以将视图模板配置为与特定控制器关联。这样做，您可以在模板本身中编写视图，并且将使用正确的控制器。这对于 Backbone 来说是不可能的，即使在使用 Handlebars 时也是如此——至少，在没有大量定制的情况下是不可能的。Backbone 采用“演示者优先”方法（使用旧的模型-视图-演示者语言）或视图对象优先方法，其中视图对象本身控制渲染哪个模板。

# ruby-on-rails - Rails：如何在控制台中使用 Yaml 显示结果

> ID：10544567
> 
> 赞同：2
> 
> 时间：2012-05-11T02:16:22.550
> 
> 标签：ruby-on-rails, yaml

我正在使用`user = Users.all`控制台从数据库中检索一些记录，但它们非常不可读。

我知道 Yaml 会使它更清晰，但不知道如何将结果转换为 Yaml。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T02:18:05.727

```
require 'yaml'
puts user.to_yaml 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T14:26:54.487

您也可以在控制台中的命令前添加“y”：

```
y User.all 
```

获取 yaml 输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-17T08:32:12.170

如果您希望输出为 Rails 固定装置做好准备，请将其限制为属性：

```
User.all.each {|u| y u.attributes} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-23T20:59:01.157

您可以在输出后键入“y _”，例如：

```
User.all
y _ 
```

# php - 眼动追踪系统

> ID：10544568
> 
> 赞同：2
> 
> 时间：2012-05-11T02:16:29.143
> 
> 标签：php, jquery, html, eye-tracking

我需要将眼动追踪系统添加到网站中。带有热图的东西，用于跟踪用户点击次数最多的位置。

是否有任何开源 php（jquery，html）插件可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T02:18:30.250

试试[CrazyEgg](http://www.crazyegg.com/)或[ClickTale](http://www.clicktale.com/)。两者都运行良好且易于实施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:23:17.097

您不会在网上找到可以与您的网站集成的组合眼动追踪系统/热图。

您可能想查看 www.Gazehawk.com，这是一项相对便宜的眼动追踪服务。虽然他们已经让这样做变得更实惠，但它几乎不在你的手中 - 它不是你与你的网站集成的服务。

如果你想要的只是一个基于人们点击位置的热图，你可以通过谷歌分析免费获得类似的东西。

# php - 如何使用 Graph API POST 指定参数？

> ID：10544572
> 
> 赞同：0
> 
> 时间：2012-05-11T02:16:59.860
> 
> 标签：php, facebook-graph-api

我有一篇关于使用 API 的评论。根据文档：

您可以通过发出具有 publish_stream 权限和以下参数的 HTTP POST 请求写入 POST_ID/comments 连接以向帖子发布评论。

```
Parameter    Description     Type    Required
message Comment text    string   yes 
```

所以我对 API 调用看起来像这样感到压力：

```
$postId = "1234567890";
$facebook->api($postId."/comments", 'POST'); 
```

但是我在哪里指定消息参数？

我试过了：

```
$facebook->api($postId."/comments", 'POST', array("message"=>"hello world"); 
```

但没有骰子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T05:04:52.590

您的 postID 可能不准确。

据我所知，facebook的postID可能有几个段

例如粉丝页面上的帖子的 postId 将具有以下格式：

PAGEID_POSTID

例如：3201235968_1234567890

祝你好运

# html - 使用 CSS 的灵活大小的圆形图像

> ID：10544573
> 
> 赞同：1
> 
> 时间：2012-05-11T02:17:06.177
> 
> 标签：html, image, css, responsive-design

我正在使用这些[非常好的演示](http://webdesignerwall.com/demo/css3-image-styles/)为我的图像添加一些样式。

不幸的是，我在这些演示中注意到的一点是您无法重新调整图像的大小。如果这样做，则图像未正确居中。

这是一个屏幕截图，向您展示我的意思：

[http://webdesignerwall.com/demo/css3-image-styles/](http://webdesignerwall.com/demo/css3-image-styles/)

这是供人们玩耍的[jsfiddle 。](http://jsfiddle.net/trpeters1/XkGuu/3/)

有人可以帮助弄清楚如何将这些图像居中以使每只狗都完全在视野范围内吗？

**更新：**演示的开发人员最近更新了他的代码，以允许许多样式的可变图像大小：[http](http://webdesignerwall.com/demo/css3-image-styles-part-2/) ://webdesignerwall.com/demo/css3-image-styles-part-2/ 请注意，圆形图像*不是*一个这些更新的样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:24:55.067

您想使用`background-position`css 属性：

```
background-position: 0px 0px; 
```

请参阅居中的 [示例](http://jsfiddle.net/XkGuu/4/)。

您还可以使用`background-size`css 属性：

```
background-size: 30px 30px; 
```

请参阅放大的[示例](http://jsfiddle.net/XkGuu/9/)。

这是 30px 和 150px 的许多图像样式的更完整演示：http: [//jsfiddle.net/trpeters1/XkGuu/25/](http://jsfiddle.net/trpeters1/XkGuu/25/)

# javascript - jquery $.getJSON 的 JSON 数据可以分配给其他变量吗？

> ID：10544576
> 
> 赞同：0
> 
> 时间：2012-05-11T02:17:20.970
> 
> 标签：javascript, jquery

我正在使用 jQuery $.getJSON(..) 来获取一些 json。

传递的值向我显示**"undefined"**。

有没有办法做到这一点？

```
getTopMenuJson : function(currentPage) {
    if(currentPage == null) currentPage = 1;

    var retJSON;

    $.getJSON(
            requestURLs.topMenuJson, 
            {
                'ITEM_PER_PAGE' : TopMenuHandler.ITEM_PER_PAGE,
                'CURRENT_PAGE' : currentPage
            },
            function(JSON) {
                //alert(JSON); **<--This gives me result (Object)**
                retJSON = JSON;
            }
    );

    **alert(retJSON); //<!-- This doesn't, but Undefined**
}, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:20:30.143

它没有也不应该像`getJSON`在内部进行 AJAX 调用一样，AJAX 中的第一个`A`代表`Asynchronous`，它只是意味着脚本执行不会等到`success`调用你的函数。

您可以改为使用`$.ajax`并传入`async: false`其中一个选项，以确保您的脚本等待 ajax 调用完成，但请注意，这样做会冻结浏览器/选项卡，直到您的 AJAX 调用完成。

```
$.ajax({
  url: requestURLs.topMenuJson,
  dataType: 'json',
  data:  
  {
     'ITEM_PER_PAGE' : TopMenuHandler.ITEM_PER_PAGE,
     'CURRENT_PAGE' : currentPage
  },
  success: function(JSON) {
     //alert(JSON); **<--This gives me result (Object)**
     // this won't work without async:false
     // as the execution of script won't wait until this function 
     // is finished
     retJSON = JSON; 
  },
  async: false
}); 
```

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

> async 默认值：true 默认情况下，所有请求都是异步发送的（即默认设置为 true）。如果您需要同步请求，请将此选项设置为 false。跨域请求和 dataType: "jsonp" 请求不支持同步操作。 **请注意，同步请求可能会暂时锁定浏览器，从而在请求处于活动状态时禁用任何操作。**

# ruby-on-rails - Facebook 开放图抓取

> ID：10544588
> 
> 赞同：2
> 
> 时间：2012-05-11T02:18:31.113
> 
> 标签：ruby-on-rails, ruby, facebook, facebook-opengraph

我最近在我的网络应用程序上启用了 Facebook Open Graph 的东西（某某刚刚在这里和那里阅读了这个和那个）。现在，当用户发布内容时，我将请求发布到 Facebook，作为控制器中页面加载的一部分。问题是我收到以下错误：

> HTTP 500：响应正文：{"error":{"type":"Exception","message":"无法从 URL 检索数据。"}}

我的第一个想法是加载页面的打开请求阻止了任何 FB 抓取 OG 信息，因为似乎在缓存后我不再收到此错误。

这可能吗？如果是这样，解决它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:42:34.450

为什么会这样：我今天遇到了同样的问题，这是因为您的 Koala 脚本（假设您使用的是 koala - 如果没有，您应该尝试一下，因为它很棒）在您的 URL 启动之前将其请求发送到 Facebook。这意味着当 Facebook 注册帖子时，它会到达您指定的 URL 以获取元标记。不幸的是，页面本身还没有加载，给它一个 500 错误

如何解决它：使用[delayed_job gem](http://rubygems.org/gems/delayed_job)来防止在页面加载之前发生你的post call，这使得facebook 可以正确地抓取你的metatags。

例如：

```
def post_to_facebook([ACCESS_TOKEN])
  graph = Koala::Facebook::API.new([ACCESS TOKEN])
  graph.put_connections("me", "[APP NAMESPACE]:[ACTION]", :[OBJECT TYPE] => [OBJECT_URL])
end
handle_asynchronously :post_to_facebook 
```

# sql - SQL查询排除日期之间的数据并且还匹配另一个条件

> ID：10544596
> 
> 赞同：0
> 
> 时间：2012-05-11T02:20:47.087
> 
> 标签：sql

全部，

第一次在这里发海报。我正在尝试创建一个查询，我想在其中排除日期范围之间的数据，但也有某些代码。

```
Date:

(substring(CAST(UTCBigintToUTCTime(starttime) as varchar(19)),0,11) not between '2012-05-08%' and '2012-05-10% 
```

> 状态码：
> 
> 状态码不在 ('58','59'))

如果排除同时满足这两个条件的数据，我的陈述会是什么样子？我所做的一切都排除了该日期范围内的所有内容和状态代码范围内的所有内容。

提前致谢。SQL新手但正在学习:)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:39:54.303

在我看来，你有点想多了，让它变得比它需要的更复杂。让它变得如此复杂，尤其是在负逻辑的情况下，也会使其表现不佳。

怎么样：

```
select * from myTable where starttime < '2012-05-08' and starttime > '2012-05-10' and statuscode < 58 and statuscode > 59 
```

不确定您使用的是什么数据库，或者您的数据类型到底是什么 - 根据需要稍微调整，但尽量远离令人讨厌的日期/字符串转换和“NOT”条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:58:42.233

尝试这个

```
select * from myTable where convert(date,starttime) not between '2012-05-08' and '2012-05-10' and statuscode not in (58,59) 
```

让我知道。

# javascript - 将外部 Javascript 和 CSS 文件包含到另一个站点的 DOM 中

> ID：10544597
> 
> 赞同：0
> 
> 时间：2012-05-11T02:21:15.060
> 
> 标签：javascript, bookmarklet

我正在尝试将像 StackExchange 在其网站上使用的 Markdown 编辑器加载到带有 Bookmarklet 或浏览器扩展的 Forrst.com 网站。

基本上看起来我需要...

1.  将 CSS 文件加载到页面
    [https://raw.github.com/ujifgc/pagedown/master/demo/browser/demo.css](https://raw.github.com/ujifgc/pagedown/master/demo/browser/demo.css)

2.  将这 3 个 Javascript 文件加载到页面中

    [https://raw.github.com/ujifgc/pagedown/master/Markdown.Converter.js](https://raw.github.com/ujifgc/pagedown/master/Markdown.Converter.js)
    [https://raw.github.com/ujifgc/pagedown/master/Markdown.Editor.js](https://raw.github.com/ujifgc/pagedown/master/Markdown.Editor.js)
    [https://raw.github。 com/ujifgc/pagedown/master/Markdown.Sanitizer.js](https://raw.github.com/ujifgc/pagedown/master/Markdown.Sanitizer.js)

3.  将此 Javascript 加载到页面中以使其全部运行...

* * *

```
//Load and run this code in the page...
// Find and replace the curent textarea with the HTML we
// need for our markdown editor to work 
var htmlToReplace = ' \
  <div class="wmd-panel"> \
    <div id="wmd-button-bar"></div> \
      <textarea class="wmd-input" id="wmd-input" name="description"></textarea> \
  </div> \
  <div id="wmd-preview" class="wmd-panel wmd-preview"></div>';

$("#description").replaceWith(htmlToReplace)

//Run the markdown editor scripts
(function () {
    var converter1 = Markdown.getSanitizingConverter();
    var editor1 = new Markdown.Editor(converter1);
    editor1.run();
})(); 
```

* * *

如果有人能指出我如何完成这样的事情的正确方向，我相信有可能我会非常感谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:10:00.187

如果您想将它们加载到不同的网站，Chrome 为您提供了一种非常简单的方法，它们被称为[Content Scripts](http://code.google.com/chrome/extensions/content_scripts.html)。

本质上，您创建一个[extension](http://code.google.com/chrome/extensions/getstarted.html)，并在您的`manifest.json`文件中指定要加载的 javascript 文件，并给出它们在项目目录中的相对路径。

所以，这里是步骤：

1.  创建文件夹
2.  在该文件夹中，将您要加载的文件放在浏览器中
3.  创建一个`manifest.json`文件，并在其中指定要加载的*CSS*和*JavaScript文件（并提供它们到清单文件的相对路径）。*
4.  在 Chrome 中，[安装本地扩展程序](http://code.google.com/chrome/extensions/faq.html#faq-dev-01)
5.  继续测试，每当您对文件进行更改时，请确保您在 ( `chrome://extensions`) 安装它的页面上单击“重新加载扩展”，以便重新加载文件并自行重新启动。

这是否至少回答了您的部分问题？

# ruby-on-rails - 载波拇指问题

> ID：10544598
> 
> 赞同：6
> 
> 时间：2012-05-11T02:21:37.973
> 
> 标签：ruby-on-rails, imagemagick, carrierwave, rmagick

有人问了这个问题，但没有给出答案……我遇到了同样的问题。

我正在使用carrierwave上传文件一切都很好，直到我想创建拇指

图像直接保存在 tmp 中，但保持相同的大小......

我的 avatar_uploader.rb 文件如下所示：

```
class AvatarUploader < CarrierWave::Uploader::Base
include CarrierWave::RMagick
storage :file
def store_dir
   "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
end
version :thumb do
  process :resize_to_limit => [200, 200]
end 
```

我的观点有以下几点：

```
<% for image in @posts %>
<%= image_tag image.avatar_url(:thumb) if image.avatar? %>
<%= image.title %>
<% end %> 
```

当我不包含 (:thumb) 时，我会看到完整的图像......但是当我包含 (:thumb) 时，我会收到以下错误：

```
Version thumb doesn't exist! 
```

下面是我的模型设置

```
class Post < ActiveRecord::Base
  attr_accessible :comments, :frame, :title, :twitter, :avatar
  belongs_to :user
  mount_uploader :avatar, AvatarUploader
end 
```

我可以看到创建了一个 tmp 目录，但是图像没有调整大小...我安装了 imagemagick 和 rmagick...

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-12T07:57:13.057

I think you might want to recreate versions since you might have create thumb size for some images after you uploaded some other files.

```
image.avatar.url(:thumb) 
```

above syntax is fine

To recreate versions try running

```
image.avatar.recreate_versions! 
```

on all avatars you might be missing.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T06:35:22.450

尝试以下语法之一：

```
image.avatar.thumb.url
# or
image.avatar.url(:thumb) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-16T10:43:59.103

我建议使用

```
include CarrierWave::MiniMagick 
```

代替

```
include CarrierWave::RMagick 
```

因为它们可能是您没有 RMagick 的所有依赖库的情况。Thumb 版本是使用 RMagick 或 MiniMagick 创建的。问题出在你的 RMagick 上。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-11T06:01:07.657

你试过龙飞宝石吗？我知道我没有解决你的问题。但是经过几次使用后，我认为它在图像方面比载波更好。Dragonfly gem 不会创建很多图像，只是将一张图像调整为您指定的任何大小，与创建大量拇指的carrierwave 相比。

# android - 以编程方式设置片段类中的 WebView loadUrl

> ID：10544602
> 
> 赞同：5
> 
> 时间：2012-05-11T02:21:54.247
> 
> 标签：android

我需要实现的是在每个选项卡中我想显示不同的网站，比如

```
Tab 1: http://www.stackoverflow.com
Tab 2: http://www.google..com
Tab 3\. http://www.developers.android.com 
```

我的问题是我无法将 WebView 对象访问到 loadUrl()

为了澄清我的问题，这是我的代码：

**FragmentTabsPagerActivity.java**

```
 public class FragmentTabsPagerActivity extends FragmentActivity implements TabHost.OnTabChangeListener, ViewPager.OnPageChangeListener{

        private TabHost mTabHost;
        private ViewPager mViewPager;
        private HashMap<String, TabInfo> mapTabInfo = new HashMap<String, FragmentTabsPagerActivity.TabInfo>();
        private PagerAdapter mPagerAdapter;
        ...

        private void initialiseTabHost(Bundle args) {
            mTabHost = (TabHost)findViewById(android.R.id.tabhost);
            mTabHost.setup();

            TabInfo tabInfo = null;
            Bundle bundle1 = new Bundle();
            Bundle bundle2 = new Bundle();
            Bundle bundle3 = new Bundle();

            bundle1.putInt("id", 1);
            bundle2.putInt("id", 2);
            bundle3.putInt("id", 3);

            FragmentTabsPagerActivity.addTab(this, this.mTabHost, this.mTabHost.newTabSpec("Tab1").setIndicator("Tab 1"), (tabInfo = new TabInfo("Tab1", TabsFragment.class, bundle1)));
            FragmentTabsPagerActivity.addTab(this, this.mTabHost, this.mTabHost.newTabSpec("Tab2").setIndicator("Tab 2"), (tabInfo = new TabInfo("Tab2", TabsFragment.class, bundle2)));
            FragmentTabsPagerActivity.addTab(this, this.mTabHost, this.mTabHost.newTabSpec("Tab3").setIndicator("Tab 3"), (tabInfo = new TabInfo("Tab3", TabsFragment.class, bundle3)));

            this.mapTabInfo.put(tabInfo.tag, tabInfo);
            mTabHost.setOnTabChangedListener(this);
        }
} 
```

**TabsFragment.java**

```
public class TabsFragment extends Fragment{
    LinearLayout layout;
    WebView mWebView;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        layout = (LinearLayout)inflater.inflate(R.layout.fragments_layout, container, false);
        mWebView = (WebView) layout.findViewById(R.id.webView1);
        WebSettings setting =mWebView.getSettings();

        mWebView.setWebViewClient(new WebViewClient(){
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                return true;
            }
        });

        if(container == null){
            return null;
        }

        return layout;
        }

        public void setWebUrl(String url){
            mWebView.loadUrl(url);
        }
} 
```

**PagerAdapter.java**

```
public class PagerAdapter extends FragmentPagerAdapter{

    private List<Fragment> fragments;

    public PagerAdapter(FragmentManager fm, List<Fragment> fragments) {
        super(fm);
        this.fragments = fragments;
    }

    @Override
    public Fragment getItem(int position) {
        return this.fragments.get(position);
    }

    @Override
    public int getCount() {
        return this.fragments.size();
    }
} 
```

编辑：

**片段布局.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    >

    <WebView
        android:id="@+id/webView1"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T07:25:03.960

我解决了这个问题。我使用下面的代码使我的选项卡动态化。

在我的TabsFragment.java**我**添加一个**id**并**通过**`id = getArguments().getInt("id");`

```
public class TabsFragment extends Fragment{
    LinearLayout layout;
    WebView mWebView;
    int id;

    public static TabsFragment newInstance(int id){
        TabsFragment tab = new TabsFragment();
        Bundle args = new Bundle();
        args.putInt("id", id);
        tab.setArguments(args);

        return tab;
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        layout = (LinearLayout)inflater.inflate(R.layout.fragments_layout, container, false);
        mWebView = (WebView) layout.findViewById(R.id.webView1);
        WebSettings setting =mWebView.getSettings();

        mWebView.setWebViewClient(new WebViewClient(){
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                return true;
            }
        });

        if(container == null){
            return null;
        }

        return layout;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onActivityCreated(savedInstanceState);
        if(savedInstanceState != null){
            id = savedInstanceState.getInt("id");
        }else{
            id = getArguments().getInt("id");
        }

        Log.w("id", id+"");

        switch (id) {
        case 1:
            setWebUrl("http://www.stackoverflow.com");
            break;
        case 3:
            setWebUrl("http://www.google..com");
            break;
        case 2:
            setWebUrl("http://www.developers.android.com");
            break;

        default:
            break;
        }
    }

    public void setWebUrl(String url){
        mWebView.loadUrl(url);
    }
} 
```

在**PagerAdapter.java** **方法 getItem(int position)* * 我创建了**TabsFragment**类的新实例并返回新实例。

```
@Override
    public Fragment getItem(int position) {
        TabsFragment tab = TabsFragment.newInstance(position+1);

        //return this.fragments.get(position);
        return tab;
    } 
```

它完美地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T05:49:29.457

我认为问题出在这一行

```
layout = (LinearLayout)inflater.inflate(R.layout.fragments_layout, container, false); 
```

你正在投射整个视图布局，`LinearLayout`而不是做这样的事情......

```
View v = inflater.inflate(R.layout.fragments_layout, container, false);
mWebView = (WebView) v.findViewById(R.id.webView1);
...
return v 
```

希望有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T09:59:57.453

为什么必须使用 Tab？你不能用按钮代替吗？

单击不同的按钮，您使用 webview 加载相应的页面。

你应该知道，在你的应用程序中添加三个新的 webview 对你来说真的很糟糕。

# mysql - SQL Count() 没有给出想要的结果

> ID：10544605
> 
> 赞同：0
> 
> 时间：2012-05-11T02:22:15.840
> 
> 标签：mysql, count, aggregate-functions

我在弄清楚这个 SQL 语句时遇到了一些困难。

这是表的架构。

```
studentID |subjectID | attendanceStatus | classDate | 
1234567      ...           1               .....
1234567      ...           0 
```

基本上我想根据学生ID计算出勤率并将它们显示在这样的列中

```
studentID | subjectID | attendancePercentage 
```

出勤率是该学生的 0 数/总条目数

这是我所做的，但没有给出预期的结果。

```
SELECT studentID, COUNT(attendanceStatus =  0) AS Absent,
COUNT( attendanceStatus = 1) As Present
FROM attendance WHERE studentID = '1234567'; 
```

那失败了。

我希望我能理解我想要实现的目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:27:16.273

我认为你需要使用 sum 来代替。

```
SELECT  studentID ,
        SUM(CASE WHEN attendanceStatus = 0 THEN 1
                 ELSE 0
            END) AS Absent ,
        SUM(CASE WHEN attendanceStatus = 1 THEN 1
                   ELSE 0
              END) AS Present
FROM    attendance
WHERE   studentID = '1234567' 
```

# c - 将字符串和变量写入C中的缓冲区

> ID：10544606
> 
> 赞同：3
> 
> 时间：2012-05-11T02:22:25.613
> 
> 标签：c, serial-port, buffer, communication

我正在使用串行端口来控制一个名为 nano 控制器的设备。我用`CreateFile`,`writeFile`和`readFile`通信。

这是 , 的`writeFile`语法

```
if (!WriteFile(hComm, lpBuf, dwToWrite, &dwWritten, &osWrite)) {      
    if (GetLastError() != ERROR_IO_PENDING) {   
        // WriteFile failed, but isn't delayed. Report error and abort.
        fRes = FALSE;     
    }
} 
```

这里的数据应该包含在`lpBuf`. 它是一个缓冲区。

我想分配 "MINC,moveL" 。这里`MINC`有文字。然而，`moveL`是变量，其类型应该是双精度。值应该`moveL`与时间一起传递。`moveL`变化范围为 0~10 000。

那么如何填充缓冲区呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:30:11.360

听起来您想要`sprintf`（或其表亲之一）：

```
char buffer[128];

sprintf(buffer, "MINC,%f", moveL);
WriteFile(hComm, buffer, ...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:30:14.623

你可以`sprintf(lpBuf, "MINC,%lf", moveL);`用来创建字符串吗？

`lpBuf`在填充数据之前，请确保分配足够的内存。

# c# - 如何在 C# 中刷新列表框？

> ID：10544615
> 
> 赞同：2
> 
> 时间：2012-05-11T02:23:29.690
> 
> 标签：c#, winforms

我在 Google 中进行了一些搜索，但找不到有用的方法...请帮助...所以我有一个列表框来显示数据库中的数据，我的功能允许用户一次删除一个/多个数据，当然我想相应地刷新我的列表框。例如，我尝试 checkListBox1.Refresh(); 但没有用。请帮我。

```
 private void button1_Click(object sender, EventArgs e)
        {

            string item_name = "";
            foreach (object itemChecked in checkedListBox1.CheckedItems)
            {
                item_name = itemChecked.ToString();
                removefromdatabse2(item_name); // a function that update the database
                MessageBox.Show("successfully deleted");
               // checkedListBox1.Refresh();  , which didn't work

            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:41:04.473

您可以清除其项目的整个列表框并从数据库中重新填充它，或者找到要删除的项目并手动将其删除。或者，使用 ListBox 控件上的“DataSource”属性并在运行查询时更新源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:40:31.070

你有两个选择：

*   从数据库中删除选中的`ListBoxItem`实例`ListBox`（使用`ListBox.SelectedItems`属性获取选中的项目）和对应的项目存储在数据库中。每个`ListBoxItem`实例都应该有一个唯一的标识符，该标识符与存储项目的数据库表中使用的标识符相匹配。
*   删除数据库中存储的与 中所选项目相对应的项目`ListBox`，清除`ListBox`并重新加载数据库中存储的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T05:17:39.307

清除它，然后将列表框重新绑定到数据源

# .net - .NET：Image.FromFile() 可以处理哪些图像文件类型？

> ID：10544619
> 
> 赞同：7
> 
> 时间：2012-05-11T02:24:06.037
> 
> 标签：.net, image

我使用 Image.FromFile() 读取用户上传的图像文件。对于“选择文件”对话框，我可以允许哪些文件扩展名？

谢谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-11T02:28:00.433

来自微软的文档：http: [//msdn.microsoft.com/en-us/library/stf701f5.aspx](http://msdn.microsoft.com/en-us/library/stf701f5.aspx)

*   BMP
*   动图
*   JPEG
*   PNG
*   国际电影节

我相信这应该是过滤器字符串：

```
Bitmap images|*.bmp|GIF images|*.gif|JPEG images|*.jpg; *.jpeg; *.jpe; *.jif; *.jfif; *.jfi|PNG images|*.png|TIFF images|*.tiff; *.tif|All files|*.* 
```

请注意，我允许对 JPEG 和 TIFF 图像进行额外的有效扩展。

# c# - 如何过滤 XML 文件中的属性值？

> ID：10544621
> 
> 赞同：0
> 
> 时间：2012-05-11T02:24:40.153
> 
> 标签：c#, linq-to-xml

考虑下面的 xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<RootElement>
  <HomeSite>
    <Context enabled="1" active="1">
      <Culture>en-us</Culture>
      <Affiliate>0</Affiliate>
      <EmailAddress>sreetest@test.com</EmailAddress>
      <Password>sreesree1</Password>
    </Context>
  <Context enabled="0" active="1">
      <Culture>en-us</Culture>
      <Affiliate>0</Affiliate>
      <EmailAddress>sreetest@test.com</EmailAddress>
      <Password>sreesree1</Password>
    </Context>
  </HomeSite>
</RootElement> 
```

目前我在做

```
string applicationType="HomeSite";
    XDocument xmlSkuDescDoc = null;
    xmlSkuDescDoc = XDocument.Load(@"D:\Config.xml");
    var newContextElementCollection = new List<ContextElements>();
     //get the property and values
    (from data in xmlSkuDescDoc.Descendants(applicationType)
     select data)
     .Descendants("Context")
     .Elements()
     .ToList()
     .ForEach(i => newContextElementCollection.Add(new ContextElements { Property = i.Name.ToString(), Value = i.Value })); 
```

在哪里

```
public class ContextElements
{
    public string Property { get; set; }
    public string Value { get; set; }
} 
```

现在出现了一个新要求，我需要为那些属性值**启用=“1”的上下文提取记录。**

那么该怎么做呢？

需要帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:53:36.380

那这个呢：

```
xmlSkuDescDoc.Descendants("Context")
                .Where(el => el.Attribute("enabled").Value == "1")
                .Elements()
                .ToList()
                .ForEach(i => newContextElementCollection.Add(new ContextElements { Property = i.Name.ToString(), Value = i.Value })); 
```

# asp.net-mvc - 在 ASP.NET MVC 中使用实体框架创建和删除相关数据

> ID：10544625
> 
> 赞同：2
> 
> 时间：2012-05-11T02:24:50.067
> 
> 标签：asp.net-mvc, entity-framework, many-to-many

我对这一切都很陌生。我目前正在阅读 ASP.NET 网站上的教程“使用 MVC 开始使用 EF”：（第 6 章）

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/updating-related-data-with-the-entity-framework-in-an-asp-net-mvc-应用](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/updating-related-data-with-the-entity-framework-in-an-asp-net-mvc-application)

在教程中，在标题为“将课程作业添加到讲师编辑页面”的部分中，作者写了如何在讲师页面中编辑课程：

```
 public ActionResult Edit(int id)
    {
        Instructor instructor = db.Instructors
            .Include(i => i.OfficeAssignment)
            .Include(i => i.Courses)
            .Where(i => i.InstructorID == id)
            .Single();
        PopulateAssignedCourseData(instructor);
        return View(instructor);
    }

public ActionResult Edit(int id, FormCollection formCollection, string[] selectedCourses)
{
    var instructorToUpdate = db.Instructors
        .Include(i => i.OfficeAssignment)
        .Include(i => i.Courses)
        .Where(i => i.InstructorID == id)
        .Single();
    if (TryUpdateModel(instructorToUpdate, "", null, new string[] { "Courses" }))
    {
        try
        {
            if (String.IsNullOrWhiteSpace(instructorToUpdate.OfficeAssignment.Location))
            {
                instructorToUpdate.OfficeAssignment = null;
            }

            UpdateInstructorCourses(selectedCourses, instructorToUpdate);

            db.Entry(instructorToUpdate).State = EntityState.Modified;
            db.SaveChanges();

            return RedirectToAction("Index");
        }
        catch (DataException)
        {
            //Log the error (add a variable name after DataException)
            ModelState.AddModelError("", "Unable to save changes. Try again, and if the problem persists, see your system administrator.");
       }
    }
    PopulateAssignedCourseData(instructorToUpdate);
    return View(instructorToUpdate);
} 
```

有人可以告诉我如何使用与作者相同的概念来完成删除和创建操作方法吗？或者，如果您可以将我引导到一个有用的教程/站点，该教程/站点有关与 MVC 中的 EF 的多对多关系，特别是关于如何创建控制器和查看多对多相关数据，类似于上面提到的教程。我是这方面的初学者，但我仍然需要完成工作，所以如果使用的概念一致，这将非常有帮助，这对我来说会更容易。

提前非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T05:22:43.163

创建和删除通常更简单一些。我已经概述了基本结构。创建入口页面的控制器是：

```
public ViewResult CreateInstructor()
        {
            return View();
        } 
```

要生成创建表单，您可以使用脚手架（只需右键单击视图并选择添加视图...，然后选择适当的模型和页面类型）。此页面的回发由具有 [HttpPost] 属性的控制器处理，它将表单上的数据绑定到传递给控制器​​方法的对象，然后将其传递给您的 DBContext Add() 方法，最后执行SaveChanges() 方法实际命中数据库：

```
 [HttpPost]
        public ActionResult CreateInstructor(Instructor instructor)
        {
db.Instructors.Add(instructor);
db.Instructors.SaveChanges();
 return View(); //There will be some other logic here typically such as redirecting on a successful creation or showing specific validation issues with the object .

} 
```

删除是使用 DBContext Remove 方法实现的，请注意，您不必先访问数据库来加载对象，然后再删除它。通常会向您传递对象的 id，然后您可以将对象的新实例附加到上下文并删除它。

```
public ActionResult DeleteInstructor(int instructorId)
        {
var instructor = new Instructor {Id = instructorId};
db.Instructors.Attach(instructor);
db.Instructors.Remove(instructor);
db.Instructors.SaveChanges();
            return View();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:16:42.990

我知道这是一个旧线程。但我试图做同样的事情

这是我的解决方案

```
//
    // GET: /Project/Create/

    public ActionResult Create()
    {
        var project = new Project();
        ViewBag.Themes = db.Theme.ToList();
        return View(project);
    }

    //
    // POST: /Project/Create/

    [HttpPost]
    public ActionResult Create(Project projet, string[] selectedTheme)
    {
        var errors = ModelState.Select(x => x.Value.Errors).ToList();
        project.Themes = new List<Theme>();

        if (TryUpdateModel(project, "", null, new string[] { "Theme" }))
        {
            try
            {
                UpdateProjectTheme(selectedTheme, project);

                db.Project.Add(project);
                db.SaveChanges();

                return RedirectToAction("Index");
            }
            catch (DataException)
            {
                //Log the error (add a variable name after DataException)
                ModelState.AddModelError("", "Impossible to create project.");
            }
        }
        return View(project);
    } 
```

在创建视图中：

```
@{
  List<Project.Models.Theme> themes = ViewBag.Themes;
  @:<td>
    foreach (var display in themes)
  {

    <label class="checkbox">
        <input type="checkbox" 
                name="selectedTheme" 
                value="@display.ThemeID" /> 
        @display.Name
    </label>

    if (display.Name.Length > 20)
    {
        @:<br />
    }

    else
    {

        if (display.ThemeID % 2 == 0)
        {
            @:<br />
        }
    }
  }
   @:</td>
 @: </tr>
} 
```

希望你觉得它有用，你也可以看看我的 SO 帖子

[这是我的帖子！！](https://stackoverflow.com/questions/15484343/creating-and-deleting-related-data?noredirect=1#comment21921444_15484343)

# mercurial - 无法在 Mercurial 存储库中推送

> ID：10544626
> 
> 赞同：0
> 
> 时间：2012-05-11T02:24:50.223
> 
> 标签：mercurial

我有一个回购协议，我无法推送到...我已按照说明进行操作...

我的回购包含一个 hgrc ......

**/repo/.hg/hgrc**

```
[web]
push_ssl = false 
```

**hgwebdir.config**

```
[paths]
/ = /path/to/folder/*  

[web]
baseurl = /

push_ssl = false

allow_archive = zip 
```

当我尝试推动时，我仍然得到`abort: cannot lock static-http repository`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:34:21.227

[https://www.mercurial-scm.org/wiki/PublishingRepositories#Allowing_push](https://www.mercurial-scm.org/wiki/PublishingRepositories#Allowing_push)

看起来与许多其他帖子相似，但看看第 7 节是否对您没有帮助。

# php - 计数函数（）

> ID：10544628
> 
> 赞同：2
> 
> 时间：2012-05-11T02:25:00.813
> 
> 标签：php, mysql

我有这两个表，其中包含一些数据样本。我想提取每个类别中的分类广告数量。我试了一下，每一个都得到（2），这是不正确的。所以希望有人能帮助我。

```
CREATE TABLE IF NOT EXISTS `categories` (
  `id` int(255) NOT NULL AUTO_INCREMENT,
  `name` text COLLATE utf8_unicode_ci NOT NULL,
  `subcategory_id` int(2) NOT NULL DEFAULT '0',
  `parent_id` int(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=27 ;

--
-- Dumping data for table `categories`
--

INSERT INTO `categories` (`id`, `name`, `subcategory_id`, `parent_id`) VALUES
(1, 'Announcements', 0, 0),
(2, 'Employment', 0, 0),
(3, 'Items For Sale', 0, 0),
(4, 'Services', 0, 0),
(5, 'Garage Sales', 0, 0),
(6, 'Automobiles', 0, 0),
(7, 'Announcement1', 1, 1),
(8, 'Announcement2', 1, 1),

--
-- Table structure for table `classifieds`
--

CREATE TABLE IF NOT EXISTS `classifieds` (
  `classified_id` int(255) NOT NULL AUTO_INCREMENT,
  `title` text COLLATE utf8_unicode_ci NOT NULL,
  `description` text COLLATE utf8_unicode_ci NOT NULL,
  `category_id` int(10) NOT NULL,
  `name` text COLLATE utf8_unicode_ci NOT NULL,
  `authorized` int(10) NOT NULL DEFAULT '0',
  PRIMARY KEY (`adid`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=177 ;

--
-- Dumping data for table `classifieds`
--

INSERT INTO `classifieds` (`classified_id`, `title`, `description`, `category_id`, `name`, `authorized`) VALUES
(1, 'Test Classified', 'Here is the First Test classified listing.', 1, 1);

INSERT INTO `classifieds` (`classified_id`, `title`, `description`, `category_id`, `name`, `authorized`) VALUES
(2, 'GMC For Sell', 'Looks like new 1979 GMC.', 6, 1); 
```

这里

```
$query = "SELECT category_id, COUNT(title) FROM classifieds GROUP BY category_id"; 
$result = mysql_query($query) or die(mysql_error());
$row = mysql_fetch_array($result)
$num_items_in_category = $row['COUNT(title)'];
echo "<><a href='category-".$row['id'].".php' >".$row['name'].$num_items_in_category."</a></li>"; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T04:05:56.883

稍微改变一下 SQL，然后循环遍历结果？

```
$query = "SELECT c.id, c.name,
                 COUNT(cl.category_id) AS num_items_in_category
              FROM category_id c
                 LEFT JOIN aclassifieds cl ON cl.category_id=c.id
              GROUP BY c.id";  
$result = mysql_query($query) or die(mysql_error()); 

while ($row = mysql_fetch_array($result)) {
    echo "<li><a href='category-".$row['id'].".php' >".$row['name'].$row['num_items_in_category']."</."</a></li>"; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T16:22:03.357

以防万一其他人想使我受益：

```
enter $query = "SELECT c.id, c.name,
             COUNT(cl.title) AS num_items_in_category
          FROM categories c
             LEFT JOIN classifieds cl ON cl.category_id=c.id
          GROUP BY c.id";
  $result = mysql_query($query) or die(mysql_error()); 
```

while ($row = mysql_fetch_array($result)) { echo "

*   “.$row['name'].$row['num_items_in_category']。”"; } 这里 谢谢

# excel - 如何更新excel中的输入单元格

> ID：10544629
> 
> 赞同：0
> 
> 时间：2012-05-11T02:25:20.560
> 
> 标签：excel

好的..我整天都在尝试解决这个问题，现在我正在寻求帮助

**我所拥有的：**在 excel 中，我在单元格 A1 中输入了一个值 101。在它旁边的单元格 B1 中，我有一个显示 A1 单位的下拉列表。现在是 Pa。所以我有 (101 | Pa)

**我想要什么**：我将 B1 下拉列表更改为 atm，并且我希望它自动将单元格 A1 中的值更新为 1 | 自动取款机。

我有一个解决方法，需要用户输入另一个单元格，然后根据 B1 进行更新，但这不是那么干净和专业。

我希望你能理解我的问题。

您的意见表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:21:55.777

为此，您将需要一些 VBA。

使用 Change 事件检测单位何时更改，更新原始值

把它放在工作簿模块中：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim OldUnit As Variant
    Dim NewUnit As Variant
    Dim ConversionFactor As Double
    If Target.Cells.Count = 1 And Target.Column = 2 Then
        ' Save new units
        NewUnit = Target
        ' prevent recalling this code when we update cells
        Application.EnableEvents = False
        ' Get old units
        Application.Undo
        OldUnit = Target
        ' put new units back on sheet
        Target = NewUnit
        ' work out your conversion factor based on old and new units
        ConversionFactor = 0.5 ' for testing
        ' update value
        Target.Offset(0, -1) = Target.Offset(0, -1) * ConversionFactor

        Application.EnableEvents = True
    End If
End Sub 
```

# python - python和ctypes cdll，没有从函数中获得预期的回报

> ID：10544630
> 
> 赞同：3
> 
> 时间：2012-05-11T02:25:26.423
> 
> 标签：python, ctypes, robotics

我正在研究连接触觉机器人和眼动仪。因此，两者都有自己的编程要求，即眼动仪软件基于 python，是我编程的主要语言。我们的触觉机器人有一个 C 语言的 API，所以我不得不用 C 语言编写一个包装器，将其编译为 DLL，并在 python 中使用 ctypes 来加载函数。

我用 MATLAB 测试了我的 DLL，一切正常。但是，当我查询机器人的位置坐标时，关于我在 python 类中实现 ctypes 的一些事情并没有给我预期的返回值。

我将在此处发布代码，并在底部对问题进行更清晰的解释。

DLL 包装器的 C 源代码：

```
#include <QHHeadersGLUT.h>
using namespace std;
class myHapClass{
public:
void InitOmni()
{
    DeviceSpace* Omni = new DeviceSpace; //Find a the default phantom
}
double GetCoord(int index)
{
    HDdouble hapPos[3];
    hdGetDoublev(HD_CURRENT_POSITION,hapPos);
    return hapPos[index];
}
};

extern "C" {
int index = 1;
__declspec(dllexport) myHapClass* myHap_new(){ return new myHapClass();}
__declspec(dllexport) void myHapInit(myHapClass* myHapObj){ myHapObj->InitOmni();}
__declspec(dllexport) double myHapCoord(myHapClass* myHapObj){ double nowCoord = myHapObj->GetCoord(index); return nowCoord;}
} 
```

这段代码的理论是简单地拥有 3 个可用的 C（不是 C++）调用，这些调用将与 python/ctypes 兼容：

1.  myHap_new() 返回指向类实例的指针
2.  myHapInit 初始化触觉设备
3.  myHapCoord 返回 int Index 引用的轴的当前位置的双精度值。

python类如下：

```
import sreb
from ctypes import cdll
lib = cdll.LoadLibrary('C:\Documents and Settings\EyeLink\My Documents\Visual Studio 2010\Projects\myHapDLLSolution\Debug\myHapDLL.dll')

class CustomClassTemplate(sreb.EBObject):
def __init__(self):
    sreb.EBObject.__init__(self)
    self.pyMyHapObj = pyMyHap()
    self.coordval=2.0

def setCoordval(self,c):
    self.coordval = c
    pass

def getCoordval(self):
    return self.coordval

def initOmni(self):
    self.pyMyHapObj.pyHapInit()
    pass

def getCoord(self):
    self.coordval = self.pyMyHapObj.pyHapCoord()
    return self.coordval

class pyMyHap(object):
def __init__(self):
    self.obj = lib.myHap_new()
    self.coord = 1.0

def pyHapInit(self):
        lib.myHapInit(self.obj)

    def pyHapCoord(self):
    self.coord = lib.myHapCoord(self.obj)
    return self.coord 
```

python自定义类的原理是实例化加载的DLL类的一个对象（self.pyMyHapObj = pyMyHap()）。调用函数“initOmni”成功初始化机器人，但是调用“getCoord”不会返回预期值。事实上，我从“getCoord”得到的结果是 1（它被列为 1，而不是 1.0，所以我认为它返回的是一个整数，而不是它应该返回的双精度数）。

在 MATLAB 中，我使用了 DLL 库，myHapInit 和 myHapCoord 函数都可以工作，我可以初始化机器人并成功查询位置坐标。

那么我的 python 类导致 ctypes 没有从我的 DLL 中的 myHapCoord 返回的正确值是什么原因？

任何帮助，将不胜感激。谢谢

编辑：Python 2.3 版，如果重要的话……我坚持使用那个版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T03:00:21.530

返回值默认为`int`. 使用类似的东西：

```
lib.myHapCoord.restype = ctypes.c_double 
```

在调用函数以正确解释返回值之前。

# javascript - 使后退按钮转到不同的页面

> ID：10544631
> 
> 赞同：0
> 
> 时间：2012-05-11T02:25:32.407
> 
> 标签：javascript, jquery

我想使用 JavaScript 或 JQuery（或任何插件）来强制浏览器在单击后退按钮时加载特定页面。

基本上将页面插入浏览器的历史记录。

我在下面找到了一种方法，但它似乎很啰嗦。我错过了什么吗？

```
<html>
<head>
    <title>Back button test</title>
</head>
<body>
    <script type="text/javascript">
         window.history.pushState('other.html', 'Other Page', 'other.html');
         window.history.pushState('initial.html', 'Initial Page', 'initial.html');
    </script>

    Initial page <br />

    <script type="text/javascript">

         window.addEventListener("popstate", function(e) {
            if(document.URL.indexOf("other.html") >= 0){
                document.location.href = document.location;
            }
         });

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:28:24.603

一般来说，您不能修改浏览器的历史记录，这是一项主要的安全功能。如果您找到了解决方法，那可能对您很有效，但请记住，它可能会让人们感到不安。我知道如果我在一个劫持了后退按钮的网站上，我就不会回来了。相反，使用更好的用户体验为用户提供链接。

# iphone - OpenGL ES 2.0 for iOS - 多次调用 glDrawElements 导致 EXC_BAD_ACCESS

> ID：10544632
> 
> 赞同：4
> 
> 时间：2012-05-11T02:25:40.957
> 
> 标签：iphone, ios, opengl-es, opengl-es-2.0, 3d

几年前，我为 OpenGL ES 1.1 和 iPhone 编写了一个小型 Cocoa/Obj-C 游戏框架。这又回到了 iOS 3.x 流行的时候。我的 OpenGL ES 1.1 / iOS 3.x 实现这一切都很好。时间过去了，现在我们有了 iOS 5.1、OpenGL ES 2.0、ARC、块和其他东西。我决定是时候将项目移植到更……现代的标准了。

**编辑：**我自己解决了一个问题 - 为什么它在模拟器上崩溃。有点——我现在可以绘制更小的模型，但更大的模型（如测试警车）仍然会导致 EXC_BAD_ACCESS——即使这是对 glDrawElements 的唯一一次调用。我还能够在模拟器上修复绘图多个网格 - 但是，我不知道这是否会在明天早上之前在设备上运行。（我的 5.0 测试设备是我朋友的 iPhone，不要）。所以我想主要问题是，为什么较大的模型会在模拟器上导致 EXC_BAD_ACCESS？

## 下面是原帖

但是，在将其升级到 5.0 时，我遇到了一些 OpenGL ES 2.0 错误——特别是其中两个，尽管它们可能是相关的。*第一个很简单*- 如果我尝试在设备上渲染我的模型（运行 5.0.1 的 iPhone 4S），它会显示，但如果我尝试在模拟器上显示它（运行 5.0 的 iPhone 模拟器），它会抛出 EXC_BAD_ACCESS在 glDrawElements 上。*第二个，也很简单。*我无法绘制多个网格。当我将模型绘制为一个大组（一个顶点数组/索引数组组合）时，它绘制得很好 - 但是当我将模型绘制为多个部分（例如，多次调用 drawElements）时，它会失败，并显示一个大黑屏 -黑度*不是*来自正在绘制的模型（我已经验证了这一点，如下所述）。

在更详细的部分之前总结一下，尝试在模拟器上渲染我的模型崩溃

**警告：**对于小网格，这一切都很好。即使在模拟器上，我也可以一遍又一遍地绘制我的静态声明的小立方体。当我说静态声明时，我的意思是一个硬编码的 const 结构数组，它被绑定并加载到顶点缓冲区中，以及一个 GLushorts 的 const 数组绑定并加载到索引数组中。

**注意：**当我说“模型”时，我指的是一个整体模型，可能由多个顶点和索引缓冲区组成。在代码中，这意味着*模型只包含一组网格或模型组*。网格或模型组是模型的子单元，例如模型的一个连续部分，具有一个顶点数组和一个索引数组，并且还存储两者的长度。就我一直使用的模型而言，车身是一个网格，窗户是另一个网格，灯光是第三个网格。总之，它们构成了模型。

我使用的模型是一辆警车，有几千个顶点和面，并被分成多个部分（车身、灯光、窗户等）——车身大约有 3000 个面，窗户大约 100 个，灯光少了一点.

这里有一些事情要知道：

1.  我的模型加载正确。我已经通过两种方式验证了这一点 - 打印出模型顶点并手动检查它们，并单独显示每个模型组，如 2) 中所述。我会发布图片，但“声誉限制”，这是我的第一个问题，我不能。我还从头开始重新构建了两次模型加载器，没有任何变化，所以我知道顶点和索引缓冲区的顺序/格式正确。

2.  当我将模型加载为单个模型组（即一个顶点缓冲区/索引缓冲区）时，它会正确显示整个模型。当我将模型加载为多个模型组并单独显示任何给定的模型组时，它会正确显示。当我尝试绘制多个模型组（多次调用 glDrawElements）时，会出现大黑屏。

3.  黑屏不是因为正在绘制的模型。*我通过更改我的片段着色器以 无论如何都将每个像素绘制为**红色来验证这一点。***我总是将颜色缓冲区清除为中灰色（显然，我也清除了深度缓冲区），但尝试绘制多个网格/模型组会导致黑屏。我们知道模型不是简单地遮挡视图，因为它是黑色而不是红色。这发生在设备上，我不知道模拟器上会发生什么，因为我无法让它绘制。

4.  我的模型不会在模拟器中绘制。它不会绘制为单个网格/模型组，也不会绘制为多个网格/模型组。应用程序正确加载，但尝试绘制网格/模型组会导致 glDrawElements 中出现 EXC_BAD_ACCESS。回溯的相关部分是：

    ```
     thread #1: tid = 0x1f03, 0x10b002b5, stop reason = EXC_BAD_ACCESS (code=1, address=0x94fd020)
        frame #0: 0x10b002b5
        frame #1: 0x09744392 GLEngine`gleDrawArraysOrElements_ExecCore + 883
        frame #2: 0x09742a9b GLEngine`glDrawElements_ES2Exec + 505
        frame #3: 0x00f43c3c OpenGLES`glDrawElements + 64
        frame #4: 0x0001cb11 MochaARC`-[Mesh draw] + 177 at Mesh.m:81 
    ```

    **编辑：**它始终能够绘制更小的动态创建的模型（约 100 个面），但整个模型的 3000 个

5.  我能够让它渲染一个更小、更简单但仍然动态加载的模型，该模型由 192 个面/576 个顶点组成。我能够将其显示为单个顶点和索引缓冲区，也可以将其拆分为多个部分并呈现为多个较小的顶点和索引缓冲区。尝试在模拟器中绘制单网格模型导致 EXC_BAD_ACCESS 仍然被抛出，但仅在第一帧。如果我强迫它继续，它会显示一个非常糟糕的模型，然后之后的每一帧，它都会显示 100% 准确，完全符合它应该有的状态。

6.  我的着色器没有错误。当我使用小的静态声明的顶点缓冲区时，它们可以正确编译和显示。但是，为了完整起见，我会将它们发布在底部。

* * *

我的代码如下：

**渲染循环：**

```
glClearColor(0.65f, 0.65f, 0.65f, 1.0f);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    //muShader is a subclass of a shader-handler I've written that tracks the active shader
    //and handles attributes/uniforms
    //[muShader use] just does glUseProgram(muShader.program); then
    //disables the previous shader's attributes (if needed) and then
    //activates its own attributes - in this case:
    //it does:
    //    glEnableVertexAttribArray(self.position);
    //    glEnableVertexAttribArray(self.uv);
    //where position and uv are handles to the position and texture coordinate attributes
[self.muShader use];

GLKMatrix4 model = GLKMatrix4MakeRotation(GLKMathDegreesToRadians(_rotation), 0, 1, 0);
GLKMatrix4 world = GLKMatrix4Identity;
GLKMatrix4 mvp = GLKMatrix4Multiply(_camera.projection, _camera.view);
mvp = GLKMatrix4Multiply(mvp,world);
mvp = GLKMatrix4Multiply(mvp, model);

    //muShader.modelViewProjection is a handle to the shader's model-view-projection matrix uniform
glUniformMatrix4fv(self.muShader.modelViewProjection,1,0,mvp.m);

glActiveTexture(GL_TEXTURE0); 
glBindTexture(GL_TEXTURE_2D, self.policeTextureID);
    //ditto on muShader.texture
glUniform1i(self.muShader.texture, 0);

for(int i=0; i < self.policeModel.count; i++)
{
        //I'll expand muShader readyForFormat after this
    [self.muShader readyForFormat:ModelVertexFormat];
        //I'll expand mesh draw after this
    [[self.policeModel meshAtIndex:i] draw];
} 
```

* * *

**muShader 的东西**

muShader 绑定属性和制服

我不会发布整个 muShader 的课程，没有必要，只要说它有效，否则它根本不会显示任何东西。

```
//here is where we bind the attribute locations when the shader is created
-(void)bindAttributeLocations
{
    _position = glGetAttribLocation(self.program, "position");
    _uv = glGetAttribLocation(self.program, "uv");
}
//ditto for uniforms
-(void)bindUniformLocations
{
    _modelViewProjection = glGetUniformLocation(self.program, "modelViewProjection");
    _texture = glGetUniformLocation(self.program, "texture");
} 
```

muShader readyForFormat

```
-(void)readyForFormat:(VertexFormat)vertexFormat
{
    switch (vertexFormat)
    {
        //... extra vertex formats removed for brevity
        case ModelVertexFormat:

            //ModelVertex is a struct, with the following definition:
            //typedef struct{
            //    GLKVector4 position;
            //    GLKVector4 uv;
            //    GLKVector4 normal;
            //}ModelVertex;

            glVertexAttribPointer(_position, 3, GL_FLOAT, GL_FALSE, sizeof(ModelVertex), BUFFER_OFFSET(0));
            glVertexAttribPointer(_uv, 3, GL_FLOAT, GL_FALSE, sizeof(ModelVertex), BUFFER_OFFSET(16));
            break;
        //... extra vertex formats removed for brevity
    }
} 
```

* * *

**网状东西**

设置顶点/索引缓冲区

```
//this is how I set/create the vertex buffer for a mesh/model-group
//vertices is a c-array of ModelVertex structs
//    created with malloc(count * sizeof(ModelVertex))
//    and freed using free(vertices) - after setVertices is called, of course
-(void)setVertices:(ModelVertex *)vertices count:(GLushort)count
{
    //frees previous data if necessary
    [self freeVertices];
    glGenBuffers(1, &_vertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(ModelVertex) * count, vertices, GL_STATIC_DRAW);
    _vertexCount = count;

}
//this is how I set/create the index buffer for a mesh/model-group
//indices is a c-array of GLushort,
//    created with malloc(count * sizeof(GLushort);
//    and freed using free(vertices) - after setVertices is called, of course
-(void)setIndices:(GLushort *)indices count:(GLushort)count
{
    [self freeIndices];
    glGenBuffers(1, &_indexBuffer);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, _indexBuffer);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLushort) * count, indices, GL_STATIC_DRAW);
    _indexCount = count;
} 
```

网格绘制

```
//vertexBuffer and indexBuffer are handles to a vertex/index buffer
//I have verified that they are loaded properly
glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, _indexBuffer);
glDrawElements(GL_TRIANGLES, _indexCount, GL_UNSIGNED_SHORT, 0); 
```

* * *

**着色器的东西**

顶点着色器

```
attribute highp vec4 position;
attribute lowp vec3 uv;

varying lowp vec3 fragmentUV;

uniform highp mat4 modelViewProjection;
uniform lowp sampler2D texture;

void main()
{
    fragmentUV = uv;

    gl_Position = modelViewProjection * position;
} 
```

片段着色器

```
varying lowp vec3 fragmentUV;

uniform highp mat4 modelViewProjection;
uniform lowp sampler2D texture;

void main()
{
    gl_FragColor = texture2D(texture,fragmentUV.xy);
    //used below instead to test the aforementioned black screen by setting
    //every pixel of the model being drawn to red
    //the screen stayed black, so the model wasn't covering the whole screen or anything
    //gl_FragColor = vec4(1,0,0,1);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T16:18:05.660

自己回答，当使用多个缓冲区对象时，每次绑定顶点/索引缓冲区对象时都必须调用 glEnableVertexAttribArray，而不是每帧（每个着色器）仅调用一次。这是所有问题的原因，包括模拟器崩溃。

关闭。

# python - 如何使用 session 来显示模态消息？

> ID：10544633
> 
> 赞同：0
> 
> 时间：2012-05-11T02:25:58.227
> 
> 标签：python, django, django-sessions

我想知道如何使用会话变量来定义消息并将其显示在下一页上。

我创建了一个在所有模板中扩展的基本模板。我插入了模态消息代码以检查基本模板中是否有任何消息

我的基本模板（base.html）

```
...
{% if request.session.message %}
        <div id="modalAlert">
            <div class="modal-backdrop"></div>
            <div class="modal" id="myModal">
                <div class="modal-header">
                    <button class="close" data-dismiss="modal">
                        ×
                    </button>
                    <h3>{{ request.session.title }}</h3>
                </div>
                <div class="modal-body">
                    <p>
                        {{ request.session.message }}
                    </p>
                </div>
                <div class="modal-footer">
                    <a href="#" id="botao-fechar" class="btn">Ok</a>

                </div>
            </div>
        </div>
        <script type="text/javascript">
            $('#modalAlert').show();
            $('#myModal button.close,#myModal #botao-fechar').click(function() {
                $('#modalAlert').hide();
            })

        </script>

        {% endif %}
  ... 
```

在我看来，我已经在会话中插入了消息

```
 def home(request):
    request.session.message = 'Test message'
    context_instance = RequestContext(request)
    return render_to_response("professor/home.html", context_instance) 
```

但是没有出现该消息，会话中没有任何内容。我已经测试了模态，没关系。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:48:09.510

您需要将**django.core.context_processors.request**添加到您的`TEMPLATE_CONTEXT_PROCESSORS`设置中，以便您可以从模板访问请求，默认设置不包括此，因此您的消息不会显示。

为什么不使用 Django 默认消息框架？

# java - 如何在 java 中进行 MANOVA（统计）？

> ID：10544641
> 
> 赞同：0
> 
> 时间：2012-05-11T02:26:58.220
> 
> 标签：java, r, statistics, stata, anova

我需要做一个运行 MANOVA 分析的程序。最好的方法是在 java 中运行分析，但如果不可能，它可以调用 R 或 Stata，或一些运行 MANOVA 然后将结果再次导出到 java 的统计软件。

我想知道您是否知道任何可以帮助我解决此问题的库，或者是否有办法从 java 中调用统计软件...

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T06:51:02.040

[http://www.mhsatman.com/rcaller.php](http://www.mhsatman.com/rcaller.php)

他们有一个关于如何从 java 执行 R 命令的示例程序。看起来很简单。使用`manova`函数在 R 中进行分析并获取摘要。

但是这个博客评论中提到了存在的问题 - [http://stdioe.blogspot.com/2011/07/rcaller-20-calling-r-from-java.html](http://stdioe.blogspot.com/2011/07/rcaller-20-calling-r-from-java.html)

示例：[http ://code.google.com/p/rcaller/source/browse/#hg%2FRCaller%2Fsrc%2Fmain%2Fjava%2Fexamples%253Fstate%253Dclose](http://code.google.com/p/rcaller/source/browse/#hg%2FRCaller%2Fsrc%2Fmain%2Fjava%2Fexamples%253Fstate%253Dclosed)

不过我会试一试。

此外，另一个名为 rsession 的项目： [http ://code.google.com/p/rsession/](http://code.google.com/p/rsession/)

# oauth - 在 REST 请求中传递 oAuth 参数

> ID：10544644
> 
> 赞同：1
> 
> 时间：2012-05-11T02:27:33.187
> 
> 标签：oauth

我有一个以 REST 方式访问第三方远程 API 并需要 oAuth 的项目的规范。该规范包括以下文本：

> 访问 API 需要使用 OAuth 协议。每个组织共享的秘密/访问密钥组合可防止未经授权的各方访问。因为服务端点标识了组织，所以不希望在封装 REST 请求的 OAuth 标头中传递其他参数。

其中，我不完全理解以下内容：

> 因为服务端点标识了组织，所以不希望在封装 REST 请求的 OAuth 标头中传递其他参数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T05:36:57.637

`oauth_*`参数可以在授权标头中传递，也可以作为 URL 参数传递。如果您传递 Authorization 标头中的值，则我认为这句话的意思是`oauth_*`不要在标头中包含其他值。

OAuth 参数作为标头：

```
 GET /initiate?foo=bar HTTP/1.1
 Host: photos.example.net
 Authorization: OAuth realm="Photos",
    oauth_consumer_key="dpf43f3p2l4k3l03",
    oauth_signature_method="HMAC-SHA1",
    oauth_timestamp="137131200",
    oauth_nonce="wIjqoS",
    oauth_callback="http%3A%2F%2Fprinter.example.com%2Fready",
    oauth_signature="74KNZJeDHnMBp0EMJ9ZHt%2FXKycU%3D" 
```

OAuth params in the URL:

```
 GET /initiate?foo=bar&oauth_consumer_key=dpf43f3p2l4k3l03&oauth_signature_method=HMAC-SHA1&oauth_timestamp=137131200&oauth_nonce=wIjqoS&oauth_callback=http%3A%2F%2Fprinter.example.com%2Fready&oauth_signature=74KNZJeDHnMBp0EMJ9ZHt%2FXKycU%3D HTTP/1.1
 Host: photos.example.net 
```

# arrays - DIR 输出到 BAT 阵列？

> ID：10544646
> 
> 赞同：7
> 
> 时间：2012-05-11T02:28:00.457
> 
> 标签：arrays, batch-file

有没有办法将“dir”命令的输出读入 BAT 文件中的数组？还是我需要先将其输出到文件，然后读取文件并删除文件？

目的是获取目录中的文件夹列表，为每个文件夹附加一个数字，然后提示用户输入数字以选择文件夹。

更新：明白了！

```
SETLOCAL EnableDelayedExpansion
SET /A c=1

FOR /F "tokens=*" %%F in ('dir /on /b /a:d /p %svnLOCAL%') DO ( 
    ECHO !c!. %%F
    SET dir_!c!=%%F
    SET /a c=c+1    
)

REM test array
ECHO !dir_4!
ENDLOCAL 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-11T03:28:35.887

Batch 不正式支持数组，但您可以使用环境变量模拟数组。

```
@echo off
setlocal enableDelayedExpansion

::build "array" of folders
set folderCnt=0
for /f "eol=: delims=" %%F in ('dir /b /ad *') do (
  set /a folderCnt+=1
  set "folder!folderCnt!=%%F"
)

::print menu
for /l %%N in (1 1 %folderCnt%) do echo %%N - !folder%%N!
echo(

:get selection
set selection=
set /p "selection=Enter a folder number: "
echo you picked %selection% - !folder%selection%! 
```

在上面的代码中，“数组”元素被命名为 folder1、folder2、folder3...

有些人使用文件夹[1]、文件夹[2]、文件夹[3]...等名称。它当然看起来更像数组，但这正是我不这样做的原因。对批处理不太了解的人会看到这样的变量并假设批处理正确支持数组。

如果任何文件夹名称包含该`!`字符，上述解决方案将无法正常工作 - 由于延迟扩展，文件夹名称将在 %%F 变量的扩展过程中损坏。有一种解决方法涉及打开和关闭延迟扩展，但除非需要，否则不值得进入。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-13T07:18:18.000

这不是答案，而是对 dbenham 答案的回复。

我对这件事的看法与德本汉姆斯的观点正好相反。在我看来，在回答 Batch 主题时，我们必须非常简洁明了，尤其是对于初学者，并提供有助于解决问题的最少信息，但不要压倒答案并使答案混淆。在 Batch中有两种*模拟*数组的方法：通过广泛使用的方括号来包围下标，但在这两种情况下，*概念*是相同的：通过数字索引从具有相同名称的变量列表中选择特定元素.

如果不使用方括号，初学者将无法理解核心概念；相反，他们可能认为批处理文件使用了“奇怪的技巧”来解决问题。另一方面，经验丰富的程序员肯定会说：“嘿！这是一个数组，但以不同的方式编写”。没有办法将此功能误认为其他任何不同的东西，也没有理由将其伪装成其他不同的东西。

如果使用方括号，初学者会发现大量关于“数组”概念的信息以及许多编程语言中关于此主题的大量示例，甚至是独立于任何编程语言的描述，当然，这些语言可以立即用于批处理文件. 在这种情况下使用方括号比不这样做要清楚得多。但是，有些人认为这些好处不值得假设 Batch “正式支持数组”的“混乱”。

在我看来，这件事的中心点不是讨论 Batch 是否正式支持数组，而是任何人*都可以使用*数组概念来操作 Batch 文件中的数据这一事实。我认为有些人可能认为 Batch 正确支持数组，尤其是初学者，这完全没有问题；数组管理在不同的编程语言中是不同的，所以只需要解释批处理细节。但是，如果对这个主题进行更正式的讨论似乎很重要，我想举一个不同的例子。

你知道 C 编程语言不“正式支持”任何输入输出操作吗？当 Dennis Ritchie 设计它时，他专门将这些操作留在了语言设计之外，以保持编译器的小而紧凑。这是否意味着您不能在 C 程序中读/写任何数据？当然不是！这只是意味着这些操作是通过函数库在编译器*之外*实现的，所以如果你需要开发一个 C 编译器，你不必担心如何编译 PRINT、READ 或任何其他 I/O 语句，因为它们根本不存在用C语言！

很有趣，不是吗？

因此，如果初学者问：“如何用 C 语言编写消息？”，你认为正确的答案应该是：“你不能。C 语言没有正式支持任何 I/O*语句*，但你可以通过库函数模拟此类操作”？当然不是！大多数人只会回答描述 printf，但实际上没有人提到 printf()*不是 C 语言的一部分*，我认为这是正确的。归根结底，如果有人认为 C 语言支持 I/O 操作，那有什么问题呢？无论以何种方式实现，人们*都可以在 C 程序中使用I/O 操作，对吧？*

好吧，以我的拙见，对于批处理中的数组，应该使用相同的方法。

也许一个更接近的例子是这个：有很多关于“批处理中的算术运算”的问题，答案通常是：“使用`set /A`命令”。我从来没有看到一个答案表明“批处理文件不支持数字变量，只支持字符串，但算术运算可以通过多种方式模拟，比如`set /A`命令”。为什么？当纯粹主义者对 Batch 中的数组发表意见时，他们似乎是“更纯粹的人”，但他们并不关心其他主题，例如数字。实在不明白频繁澄清“批处理不支持数组”的目的！

用户[rojo](https://stackoverflow.com/u/1683264)关于这一点的看法：

> 这是一个迂腐的论点，无法解决提问者试图解决的问题

[（请参阅他在此答案](https://stackoverflow.com/a/30404094)上方的完整评论）。

# iis - Umbraco 4.7.2 安装不会加载图像、CSS、Javascript 等

> ID：10544649
> 
> 赞同：7
> 
> 时间：2012-05-11T02:28:23.310
> 
> 标签：iis, umbraco

我一直在尝试将 Umbraco 安装在 IIS 7 下的 Windows 7 机器上。我能够使用 Web 平台安装程序通过 WebMatrix 启动并运行它，但我希望它在 IIS 中运行。

无论我是通过设置一个新的网站复制二进制文件来手动执行安装，还是让 Web 平台安装程序来执行安装，我总是看到一个缺少所有 CSS、图像、js 等的安装页面。

当我尝试直接访问这些资源时，我总是被重定向回安装页面。

我告诉平台安装程序创建一个全新的网站。未指定虚拟目录/应用程序名称。我已经按照我能找到的所有在线说明进行操作。

日志显示 401 未经授权的错误：

2012-05-11 02:42:22 127.0.0.1 GET /umbraco_client/installer/css/all.css - 80 - 127.0.0.1 Mozilla/5.0+（兼容；+MSIE+9.0；+Windows+NT+6.1；+ WOW64;+Trident/5.0) 401 3 5 10 2012-05-11 02:42:22 127.0.0.1 GET /umbraco_client/installer/css/reset.css - 80 - 127.0.0.1 Mozilla/5.0+(兼容;+MSIE +9.0;+Windows+NT+6.1;+WOW64;+Trident/5.0) 401 3 5 10 2012-05-11 02:42:22 127.0.0.1 GET /umbraco_client/installer/css/form.css - 80 - 127.0 .0.1 Mozilla/5.0+（兼容；+MSIE+9.0；+Windows+NT+6.1；+WOW64；+Trident/5.0）401 3 5 10

我尝试将应用程序池标识更改为网络服务并授予网站根路径的完全权限，虽然它没有解决问题，但它把上述所有 401 错误都变成了 302 重定向。

思想？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-28T13:43:51.180

就我而言，我发现虽然我创建了一个自定义应用程序池，该应用程序池在具有此文件夹权限的身份下运行，但在 IIS 身份验证页面（ IIS 管理器 -> 身份验证 -> 匿名身份验证）中，它被`IUSR`用作匿名身份验证的默认用户. 通过选中“使用应用程序池标识”框，它可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T01:10:31.730

似乎根本原因是我的 umbraco 文件位于 c:\Projects\MySite\Umbraco\WWW 下。尽管 WWW 文件夹具有正确的权限，但 IIS 不会授予对相关资源的访问权限。

一旦我将内容移动到 c:\inetpub\wwwroot\，它就开始工作了。我仍然不完全确定为什么，因为权限*完全*匹配，但它就是这样。

# javascript - 使用 jQuery 查找和替换 HTML

> ID：10544654
> 
> 赞同：1
> 
> 时间：2012-05-11T02:29:43.787
> 
> 标签：javascript, jquery

我正在尝试做一个书签或浏览器扩展，当我查看它时会修改另一个网站，更具体地说，我正在尝试使用带有按钮栏的 Javascript Markdown 编辑器，例如 Stackexchange 在我不拥有的另一个网站上使用，所以我必须这样做带有书签或扩展名。

现在我需要在页面上找到 textarea 并将其替换为如下所示的不同代码块。该页面确实有 jQuery，所以我可以使用它......如果你能告诉我如何做到这一点，我将非常感激，谢谢

寻找

```
<textarea rows="10" cols="50" name="description" id="description" tabindex="4"></textarea> 
```

用。。。来代替...

```
<div class="wmd-panel">
    <div id="wmd-button-bar"></div>
    <textarea class="wmd-input" id="wmd-input" name="description"></textarea>
</div>

<div id="wmd-preview" class="wmd-panel wmd-preview"></div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T02:36:27.777

当然。我们只需要简单地替换 HTML，如下所示：

```
var htmlToReplace = ' \
  <div class="wmd-panel"> \
    <div id="wmd-button-bar"></div> \
      <textarea class="wmd-input" id="wmd-input" name="description"></textarea> \
  </div> \
  <div id="wmd-preview" class="wmd-panel wmd-preview"></div>';

$("#description").replaceWith(htmlToReplace) 
```

这将为您解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:33:25.690

查看 .replaceWith()

[http://api.jquery.com/replaceWith/](http://api.jquery.com/replaceWith/)

```
$("#description").replaceWith('ALL YOUR CODE'); 
```

如果需要匹配属性或其他特征，可以使用更多的[Selector](http://api.jquery.com/category/selectors/)

# asp.net-mvc-3 - 用我的版本替换 System.Web.WebPages dll 时出错

> ID：10544656
> 
> 赞同：2
> 
> 时间：2012-05-11T02:29:51.477
> 
> 标签：asp.net-mvc-3

我不得不对 ASP.NET MVC System.Web.Webpages dll 进行一些更改。但是当我替换 dll 时，它会抛出这个错误。

> 类型“System.Web.WebPages.WebPageBase”在未引用的程序集中定义。您必须添加对程序集“System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T22:07:18.467

我有同样的问题，

我最终按照[这里](https://stackoverflow.com/a/10431075/148998)的建议解决了这个问题。

并将以下内容添加到我的 web.config

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <!-- … -->
  <system.web>
    <!-- … -->
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" />
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" />
      </assemblies>
    </compilation>
    <!-- … -->
  </system.web>
  <!-- … -->
</configuration> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-09T04:31:52.933

我发现引用的“System.Web.Webpages”DLL 将“本地复制”设置为 true 对我来说很有帮助。我也必须对其他一些 DLL 做同样的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-29T20:18:47.407

当我在 TFS 中移动目录时，我也遇到了这个错误。我通过打开 NuGet 并更新在所有 DLL 中引用的 MVC 框架来修复此错误。

# asp.net - 使用 asp.net (VB) 从 MySQL 中选择、更新、插入和删除的脚本？

> ID：10544657
> 
> 赞同：0
> 
> 时间：2012-05-11T02:30:05.573
> 
> 标签：asp.net, mysql, vb.net, asp-classic, vbscript

我刚刚从经典的 ASP 切换到 .net，我总是使用以下命令从我的 MySQL 数据库中选择、插入、更新和删除：

```
' Create db connection
Function dbConn()
    Set objConn = Server.CreateObject("ADODB.Connection")
    objConn.Open "driver=x;Server=x;Port=x;Option=x;Database=x;Uid=x;Pwd=x"
    Set dbConn = objConn
End Function

' Store data in array
Function SQL(myCommand,strSQL)
    Set objConn = dbConn()
    If myCommand = 0 Then
        Set objRS = objConn.Execute(strSQL)
        If NOT objRS.EOF Then arrRS = objRS.GetRows Else arrRS = Null
    Else
        Set objRS = objConn.Execute(strSQL,,128)
    End If
    Set objRS = Nothing : Set objConn = Nothing
End Function 
```

例如，要使用 SELECT 我就去：

```
Call SQL(0,"SELECT * FROM Users") 
```

并显示数据：

```
If IsArray(arrRS) Then
    For i = 0 to UBound(arrRS,2)
        Response.Write(arrRS(0,i) & ", " & arrRS(1,i))
    Next
End If 
```

要插入、更新或删除，我会使用：

```
Call SQL(1,"DELETE FROM Users WHERE UserID = 1") 
```

有谁知道这是否可以通过 ASP.Net - VB 实现？还是有更方便的解决方案？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:44:30.697

是的，您当然可以使用 VB.NET 做到这一点。VB.NET 几乎支持 ASP 经典和 vbscript 可以做的所有事情。ADO.NET 几乎支持 ADO 所做的一切。

...不是你想这样做。

我强烈建议您研究 ASP.NET 允许的模式和实践。新方法比旧方法好得多。

# android - 为什么通知在android通知栏中出现一段时间然后消失

> ID：10544662
> 
> 赞同：4
> 
> 时间：2012-05-11T02:30:29.370
> 
> 标签：android, service, broadcastreceiver, android-pendingintent

我正在使用`BroadCastReceiver`, 接收`BOOT_COMPLETED`动作。收到此广播后，`AlarmManager`设置为，这`AlarmManager`会触发通知：广播接收器的代码：

```
package pit.opensource.events;

import java.util.Calendar;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.app.Service;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;

public class BootReciver extends BroadcastReceiver {

    Context c;
    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO Auto-generated method stub

    //  Intent i = new Intent(context,SetAlarmService.class);
    //  context.startService(i);
        setAlarm(context);
        Log.d("Alarm","Boot Reciver");

    }
    private void setAlarm(Context c){
        Log.d("Alarm","Set alarm service--------------");
        AlarmManager alarm = (AlarmManager)c.getSystemService(Service.ALARM_SERVICE);

        Calendar cal = Calendar.getInstance();

        cal.setTimeInMillis(System.currentTimeMillis());
        cal.clear();
        cal.set(2012,5,11,5,11);

        Intent i = new Intent(c,ShowNotificationService.class);
        PendingIntent pendingIntent = PendingIntent.getService(c, 12345,i, 0);

        //  alarm.set(AlarmManager.RTC_WAKEUP, dateNotif.getTime(), pendingIntent);
        //alarm.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), pendingIntent);
        alarm.set(AlarmManager.RTC_WAKEUP, 5000, pendingIntent);

        Log.d("Alarm","Alarm is alreday set*****************");

    }

} 
```

代码`ShowNotificationService`：

```
package pit.opensource.events;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.app.Service;
import android.content.Intent;
import android.os.IBinder;
import android.util.Log;
import android.widget.Toast;

public class ShowNotificationService extends Service {

    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub
        return null;
    }
    @Override
    public void onStart(Intent intent,int startId){

        Toast.makeText(getApplicationContext(), "Alaraaaaaaaam", Toast.LENGTH_LONG).show();
        Log.d("Alarm","Notification Service");
        showNotification();
    }
    private void showNotification(){
        Intent i = new Intent(getApplicationContext(), DetailsActivity.class);

        Toast.makeText(getApplicationContext(), "Dowanlod finished!", Toast.LENGTH_LONG).show();

        int notificationID = 1;
        NotificationManager nm = (NotificationManager) getSystemService(getApplicationContext().NOTIFICATION_SERVICE);

        Log.d("Notification","Notification is set--------------------");
        PendingIntent contentIntent = PendingIntent.getActivity(getApplicationContext(), 0, i, 0);

        CharSequence tickerText = "Alaraaaaaaaam!";
        long when = System.currentTimeMillis();
        int icon = R.drawable.ic_launcher;

        Notification notification = new Notification(icon,tickerText,when);

        CharSequence contentTitle = "Alarm Alarm Alarm Alarm !!";
        CharSequence contentText = "Please click here to display more details";

        notification.setLatestEventInfo(getApplicationContext(), contentTitle, contentText, contentIntent);

        //---100ms delay, vibrate for 250ms, pause for 100 ms and
        // then vibrate for 500ms---
        notification.vibrate = new long[] { 100, 250, 100, 500}; // Needs vibrate permissions

        nm.notify(notificationID, notification);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:20:24.137

通知消失了，因为`BroadcastReceiver`完成后您的应用程序不再处于活动状态。来自非活动应用程序的通知会被自动删除。

# php - Foreach $item 不显示

> ID：10544664
> 
> 赞同：0
> 
> 时间：2012-05-11T02:30:33.117
> 
> 标签：php, mysql, foreach

使用 foreach 输出 mysql 表的内容时遇到问题。正在为 mysql 表中的每个条目打印表 (tr, td) 等，但是 td 和 /td 标记之间没有任何内容，每个 $item 都应该被回显。

```
$sql = 'SELECT domain FROM domainsuggestions'; 
$domains = mysqli_query($link, $sql);  // get domain suggestions from table
<table>
    <tr>
        <td>Domain Suggestions</td>
    </tr>   
    <?php foreach ($domains as $item): ?>
    <tr>
        <td><?php echo htmlspecialchars($item, ENT_QUOTES, 'UTF-8'); ?></td>
    </tr>
    <?php endforeach; ?>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:31:45.330

你使用 MySQL 的逻辑是完全错误的。您需要先执行查询，获取结果的资源 ID，然后循环遍历结果。

```
$sql = 'SELECT domain FROM domainsuggestions'; 
$results= mysqli_query($link, $sql);  // get domain suggestions from table
<table>
    <tr>
        <td>Domain Suggestions</td>
    </tr>   
    <?php while ($item = mysqli_fetch_assoc($results)): ?>
    <tr>
        <td><?php echo htmlspecialchars($item['domain '], ENT_QUOTES, 'UTF-8'); ?></td>
    </tr>
    <?php endwhile; ?>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:01:28.440

`foreach`期望一个*可迭代*的元素，即具有许多可以*迭代*的条目的东西。这通常是一个数组，但也可以是一个实现`Iterable`接口的对象。

跑步时你得到的`mysqli_query`是一种*资源*。这只是对 MySQL 结果集的处理。数据还没有在 PHP 中，MySQL 只是给你一个句柄说*“好的，我已经为你准备好了结果，你需要的时候来获取它们”*。调用`mysqli_fetch_assoc`从 MySQL 获取一个结果行。再次调用它会得到下一个，下一个等等。这不是您可以*迭代*的过程，您可以继续调用`mysqli_fetch_assoc`直到没有更多结果。

这就是为什么`foreach`不起作用。

# ruby-on-rails - 无法让 mongoid/rails 字段接受输入作为数组

> ID：10544665
> 
> 赞同：0
> 
> 时间：2012-05-11T02:30:54.860
> 
> 标签：ruby-on-rails, mongoid

我正在 Mongoid/Rails 项目中创建一个问题/答案模型。我希望用户创建自己的问题，然后创建可能的答案：2 个答案或 3 个答案或更多。我有表格，所以他们可以添加任意数量的问题，但我收到了这个错误：

```
Field was defined as a(n) Array, but received a String with the value "d". 
```

我不仅没有得到数组，而且还消除了“a”、“b”和“c”的答案，只保存了“d”。

我的模型：

```
class Question
  include Mongoid::Document
  field :question
  field :answer, :type => Array
end 
```

_form.html.haml 的相关部分：

```
.field
  = f.label :question
  = f.text_field :question
%p Click the plus sign to add answers.
.field
  = f.label :answer
  = f.text_field :answer
#plusanswer
  = image_tag("plusWhite.png", :alt => "plus sign")

.actions
  = f.submit 'Save' 
```

在需要时重复答案字段的 jQuery：

```
$("#plusanswer").prev().clone().insertBefore("#plusanswer"); 
```

我在这里尝试了几种涉及 [] 的解决方案，但一无所获。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-10T01:22:17.420

如果您不想在 javascript 和您的模型之间来回争论很多值，并且您了解如何使用 fields_for 和嵌套属性，那么更好的方法可能是将答案分开模型并将它们嵌入到问题模型中所以：

```
class Question
  include Mongoid::Document
  embeds_many :answers
end

class Answer
 include Mongoid::Document
 field :content # or whatever you want to name it
end 
```

你的表格看起来像这样（请原谅我的 HAML）：

```
.field
  = f.label :question
  = f.text_field :question
%p Click the plus sign to add answers.
= f.fields_for :answers do |ff|
  .field
    = ff.label :content
    = f.text_field :content
  #plusanswer
    = image_tag("plusWhite.png", :alt => "plus sign")

.actions
  = f.submit 'Save' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:55:49.263

两种方法：

一种是编辑表单，而不是返回 question[answer]，而是返回 question[answer][]，它将 answer 构建为一个数组。

*编辑：我正在仔细阅读您的问题，似乎您有一些 JS 动态呈现表单。在这种情况下，在末尾使用空括号 set [] 设置 id 应该会将返回的表单对象转换为数组*

另一种是覆盖模型中的setter，将字符串转换为数组。最安全的方法是创建一个匹配的 getter

```
class Question
  field :answer, type: Array

  def answer_as_string
    answer.join(',')
  end

  def answer_as_string=(string)
    update_attributes(answer: string.split(','))
  end
end 
```

然后`:answer_as_string`在您的表格中使用

# algorithm - SIFT算法能否在PC上实时提速？

> ID：10544669
> 
> 赞同：3
> 
> 时间：2012-05-11T02:31:28.580
> 
> 标签：algorithm, image-processing, computer-vision, sift

在 David Lowe 2004 年的论文“Distinctive Image Features from Scale-Invariant Keypoints”的第 25 页中，他声称，“它们的计算效率很高，因此可以在标准 PC 上以近乎实时的性能从典型图像中提取数千个关键点硬件。” 这是链接：[http ://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf](http://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf)

但是，我使用 Andrea Vedaldi 的 sift++（又名 VLFeat）在 640x480 图像上测试了 SIFT 算法，这是一个 c++ 实现，从一张图像中提取大约 3000 个关键点需要 0.839 秒。我的电脑是 Intel i7 2600k，有 16GB RAM。这是代码的链接：[http ://www.vlfeat.org/~vedaldi/code/siftpp.html](http://www.vlfeat.org/~vedaldi/code/siftpp.html)

说实话，SIFT能做到实时速度我觉得挺奇怪的，因为它要从一张图像中提取这么多关键点。

有人知道现代 PC 上的 SIFT 有多快吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T10:07:46.873

可能这篇文章对您的问题提供了一些见解......文章实际上包括 SIFT 的并行版本，但也给出了一个核心版本的性能。

[SIFT的并行化](http://www.iiswc.org/iiswc2008/sildes/1-2.pdf)

# ruby - Rails - 分页

> ID：10544673
> 
> 赞同：1
> 
> 时间：2012-05-11T02:32:18.400
> 
> 标签：ruby, ruby-on-rails-3

这是 will_paginate 的使用方式吗？他们文档中的示例没有演示 sql 查询的结果。我在 gem 文件中安装了包含 gem，重新启动没有任何错误。但仍然无法正常工作。

```
def list_items
        @list = Item.find(:all, :select => 'status', :conditions => { :status => ["New"]} )
        @list_page = @list.paginate(:per_page => 10)
        respond_to do |format|
        format.html { render :partial => 'item_list'}
        format.js
        end
        end

NoMethodError (undefined method `paginate' for #<Array:0x97bd3fc>): 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T02:37:47.057

[https://github.com/mislav/will_paginate/wiki/Backwards-incompatibility](https://github.com/mislav/will_paginate/wiki/Backwards-incompatibility)

您需要添加`require 'will_paginate/array'`

# javascript - 如何构建多阶段 Web 表单？

> ID：10544677
> 
> 赞同：13
> 
> 时间：2012-05-11T02:33:09.320
> 
> 标签：javascript, jquery, html, forms, animation

我正在尝试构建一个具有多个阶段的网络表单。我正在将它从 Stack Overflow / Stack Exchange 标记网络表单中提取出来。问题是，我不确定如何触发“下一阶段”动作。

举例来说，如果有人想在 Stack Overflow 上标记一个问题，您单击`flag`，然后一个弹出窗口提示您做出选择。如果您选择第二个选项（“它不属于这里，或者它是重复的”），表单会自动将您带到第二个屏幕。

第一个画面：

![第一页](../Images/c320be3c764e81fe4f7d16834fc9b868.png)

单击后，它会自动重定向到：

![第二页](../Images/c6b61778590da4af13763ce6ac24a34e.png)

问题是我不知道潜在的触发器是什么。单击该单选按钮如何将最终用户发送到下一个屏幕？

我尝试检查来源，但我觉得我只看到了一半的图片：

![页面源](../Images/c3aa24f5bfc4053ca384f823901f931e.png)

我发现没有多少 HTML 教程有任何与此类似的练习示例。我怀疑这是 JavaScript，但我找不到会触发这些操作的链接 .js 文件。

那么：**网络表单如何在点击时自动重定向？**作为后续，如果它使用 JavaScript，我可以使用仅 HTML/CSS 的解决方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T02:49:23.420

在比框架更低的层次上考虑这一点可能会有所帮助。有两种方法可以制作多阶段表格。

第一种（通常也是较旧的）方法是将状态存储在服务器上。表单的每个阶段实际上是一个单独的表单，客户端通过问卷调查的进度保存在服务器上（例如，作为会话数据的一部分）。

第二种方式（更现代的方式）是使用 JavaScript，正如您所怀疑的那样。在这种情况下，实际上几乎没有什么黑魔法，而且点击时根本没有自动重定向。您所做的只是有一个很长的表单，您可以根据用户的选择显示/隐藏一些元素（当然，您可以`<form>`显示/隐藏多个元素）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T02:58:14.950

好吧，我会使用某种 jQuery 向导插件并使其适应我的需要。我是最近才做的，并不难。你应该试试 SmartWizard 3.0，它非常活跃，上一个版本大约是 2 个月前，编码人员很快回答了我的问题。

这是：[https ://github.com/mstratman/jQuery-Smart-Wizard](https://github.com/mstratman/jQuery-Smart-Wizard)

您可以触发向导前进到将事件链接到单击单选按钮的操作的下一步。

祝你好运 ：）

# ios - 无法同时显示两个 CorePlot 图

> ID：10544680
> 
> 赞同：3
> 
> 时间：2012-05-11T02:33:28.557
> 
> 标签：ios, core-plot

我在同一视图中显示两个不同的 CorePlot 图表时遇到问题。我在我的视图中设置了两个托管视图，并且所有引用插座都正确连接。只有一张图正确显示。向该方法添加一个快速的 NSLog`numberForPlot`表明只有第一个图被填充 ( `graph`and `graphView`) 而不是第二个 ( `trend`and `trendView`)。这是代码：

```
- (void) graphSetup {
    CPTTheme *theme = [CPTTheme themeNamed:kCPTPlainWhiteTheme];

    graph = (CPTXYGraph *)[theme newGraph]; 

    graphView.hostedGraph = graph;
    graphView.allowPinchScaling = YES;

    graph.paddingLeft = -5;
    graph.paddingTop = 0;
    graph.paddingRight = -5;
    graph.paddingBottom = -5;
    graph.fill = nil;
    graph.plotAreaFrame.fill = nil;
    int a = 0;
    for (int i = 0; i < [romAveragesArray count]; i++) {
        if ([romAveragesArray objectAtIndex:i] != NULL)
            a++;
    }

    int localMax = 0;
    int localMin = 0;

    for (int a = 0; a < [romAveragesArray count]; a++) {
        if ([[romAveragesArray objectAtIndex:a] getValue] > localMax)
            localMax = [[romAveragesArray objectAtIndex:a] getValue];
        else if ([[romAveragesArray objectAtIndex:a] getValue] < localMin)
            localMin = [[romAveragesArray objectAtIndex:a] getValue];
    }

    for (int a = 0; a < [obaAveragesArray count]; a++) {
        if ([[obaAveragesArray objectAtIndex:a] getValue] > localMax)
            localMax = [[obaAveragesArray objectAtIndex:a] getValue];
        else if ([[obaAveragesArray objectAtIndex:a] getValue] < localMin)
            localMin = [[obaAveragesArray objectAtIndex:a] getValue];

    }

    CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)graph.defaultPlotSpace;
    plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromInt(0)
                                                    length:CPTDecimalFromInt(145)];
    NSLog(@"%d",a);
    plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromInt(0)
                                                    length:CPTDecimalFromInt(localMax+15)];

    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)graph.axisSet;

    CPTXYAxis *x = axisSet.xAxis;
    x.majorIntervalLength = CPTDecimalFromFloat(10);
    x.minorTicksPerInterval = 2;
    x.borderWidth = 0;
    x.labelExclusionRanges = [NSArray arrayWithObjects:
                              [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(-100) 
                                                           length:CPTDecimalFromFloat(300)], 
                              nil];;

    CPTXYAxis *y = axisSet.yAxis;
    y.majorIntervalLength = CPTDecimalFromFloat(10);
    y.minorTicksPerInterval = 1;
    y.labelExclusionRanges = [NSArray arrayWithObjects:
                              [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(-100) 
                                                           length:CPTDecimalFromFloat(300)], 
                              nil];

    CPTScatterPlot *dataSourceLinePlot = [[CPTScatterPlot alloc] init];
    dataSourceLinePlot.identifier = @"Obama";
    dataSourceLinePlot.dataSource = self;
    CPTMutableLineStyle *style = [CPTMutableLineStyle lineStyle];
    style.lineColor = [CPTColor colorWithComponentRed:0.3215686274509804 green:0.6078431372549019 blue:1.0 alpha:1.0];
    dataSourceLinePlot.dataLineStyle = style;
    [graph addPlot:dataSourceLinePlot];

    CPTScatterPlot *dataSourceLinePlot1 = [[CPTScatterPlot alloc] init];
    dataSourceLinePlot1.identifier = @"Rom";
    dataSourceLinePlot1.dataSource = self;
    CPTMutableLineStyle *style1 = [CPTMutableLineStyle lineStyle];
    style1.lineColor = [CPTColor colorWithComponentRed:0.9803921568627451 green:0.47058823529411764 blue:0.47058823529411764 alpha:1.0];
    dataSourceLinePlot1.dataLineStyle = style1;
    [graph addPlot:dataSourceLinePlot1];
     [self trendSetup];

    [self postStats];

}

- (void) trendSetup {
    CPTTheme *theme1 = [CPTTheme themeNamed:kCPTPlainWhiteTheme];

    trend = (CPTXYGraph *) [theme1 newGraph];
    trendView.allowPinchScaling = YES;
    trendView.hostedGraph = trend;

    trend.paddingLeft = -5;
    trend.paddingRight = -5;
    trend.paddingTop = 0;
    trend.paddingBottom = -5;
    trend.fill =  nil;
    trend.plotAreaFrame.fill = nil;
    int obaMax, localMax;
    for (int i = 0; i < [obaArray count]; i++)
        obaMax += [[obaArray objectAtIndex:i] getValue];

    int romMax;
    for (int i = 0; i < [romArray count]; i++)
        romMax += [[romArray objectAtIndex:i] getValue];

    if (romMax > obaMax)
        localMax = romMax;
    else
        localMax = obaMax;

    CPTXYPlotSpace *trendSpace = (CPTXYPlotSpace *)trend.defaultPlotSpace;
    trendSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromInt(0) length:CPTDecimalFromInt(504)];
    trendSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromInt(0) length:CPTDecimalFromInt(localMax)];

    CPTXYAxisSet *trendSet = (CPTXYAxisSet *)trend.axisSet;

    CPTXYAxis *trendX = trendSet.xAxis;
    trendX.majorIntervalLength = CPTDecimalFromInt(10);
    trendX.minorTicksPerInterval = 2;
    trendX.borderWidth  = 0;
    trendX.labelExclusionRanges = [NSArray arrayWithObjects:[CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(-100) length:CPTDecimalFromFloat(300)], nil];;

    CPTXYAxis *trendY = trendSet.xAxis;
    trendY.majorIntervalLength = CPTDecimalFromInt(10);
    trendY.minorTicksPerInterval = 2;
    trendY.borderWidth  = 0;
    trendY.labelExclusionRanges = [NSArray arrayWithObjects:[CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(-100) length:CPTDecimalFromFloat(300)], nil];;

    CPTScatterPlot *trendSourceLinePlot = [[CPTScatterPlot alloc] init];
    trendSourceLinePlot.identifier = @"Obama Trend";
    trendSourceLinePlot.dataSource = self;
    CPTMutableLineStyle *style3 = [CPTMutableLineStyle lineStyle];
    style3.lineColor = [CPTColor colorWithComponentRed:0.3215686274509804 green:0.6078431372549019 blue:1.0 alpha:1.0];
    trendSourceLinePlot.dataLineStyle = style3;
    [trend addPlot:trendSourceLinePlot];

    CPTScatterPlot *trendSourceLinePlot1 = [[CPTScatterPlot alloc] init];
    trendSourceLinePlot1.identifier = @"Rom Trend";
    trendSourceLinePlot1.dataSource = self;
    CPTMutableLineStyle *style4 = [CPTMutableLineStyle lineStyle];
    style4.lineColor = [CPTColor colorWithComponentRed:0.9803921568627451 green:0.47058823529411764 blue:0.47058823529411764 alpha:1.0];
    trendSourceLinePlot1.dataLineStyle = style4;
    [trend addPlot:trendSourceLinePlot1];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T14:51:55.987

这是我发现您的代码不太正确的地方，我认为这就是 Eric 询问您两个托管视图是否可见的原因。

您正在创建两个`CPTXYGraph`s 一个称为`graph`另一个称为`trend`. 我不知道您如何在 Interface Builder 中设置 Views，但我不会创建两个`CPTXYGraph`s。我会将`trendSourceLinePlot`&添加`trendSourceLinePlot1`到`trend`or 或`graph`.

我认为，您需要做的是将它们呈现在相同的`CPTXYGraph`. 所以，这是我的建议...

1.  删除以下行`trentSetup`

    ```
    CPTTheme *theme1 = [CPTTheme themeNamed:kCPTPlainWhiteTheme];
    trend = (CPTXYGraph *) [theme1 newGraph];
    trendView.allowPinchScaling = YES;
    trendView.hostedGraph = trend;
    trend.paddingLeft = -5;
    trend.paddingRight = -5;
    trend.paddingTop = 0;
    trend.paddingBottom = -5;
    trend.fill =  nil;
    trend.plotAreaFrame.fill = nil; 
    ```

2.  **仅**替换以下行

    ```
    [trend addPlot:trendSourceLinePlot];
    [trend addPlot:trendSourceLinePlot1]; 
    ```

    分别与

    ```
    [graph addPlot:trendSourceLinePlot];
    [graph addPlot:trendSourceLinePlot1]; 
    ```

它还应该加快加载过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:59:40.967

图表的 Y 范围太长。我从刻度线部分中删除了部分，现在它会及时更新。

# php - javascript中引用的php代码中的javascript变量

> ID：10544681
> 
> 赞同：0
> 
> 时间：2012-05-11T02:33:28.813
> 
> 标签：php, javascript

标题听起来很奇怪，但这是我的问题。我在需要调用 PHP 变量的 Javascript 中创建这个循环。

```
 var data = new Array("<?php echo count($result) ?>");
    for (var i=0; i < "<?php echo count($result) ?>"; i++) {
        data[i] = "<?php echo $result[i] ?>";
    } 
```

第三行是问题。我试过了

```
 data[i] = "<?php echo $result [" + i + " ] ?>"; 
```

但它没有用。

有什么聪明的技巧可以解决这个问题吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T02:39:44.083

```
var data = <?= json_encode($result); ?>; 
```

# javascript - 在 Meteor 应用程序中加载音频文件

> ID：10544683
> 
> 赞同：2
> 
> 时间：2012-05-11T02:34:08.703
> 
> 标签：javascript, audio, mp3, meteor

我刚开始使用 Meteor，我想播放静态音频文件，MP3 或 M4A。我似乎找不到放置此类文件的正确位置。我创建了一个 public/ 目录并将我的音频文件放在那里，但是当我尝试加载时`http://localhost:3000/public/myfile.mp3`，它只是再次加载我的 Meteor 主页（即，一个普通的 HTML 页面，而不是音频文件）。就像服务器没有看到文件一样。有什么方法我必须用 Meteor 注册文件，还是应该在不同的位置？谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T03:13:15.533

好的，它就在那里，您只是不要通过 访问它`/public/myfile.mp3`，而是通过`/myfile.mp3`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T10:31:48.913

是的，当您将它放在公共文件夹中时，您可以通过将 domain/your.mp3 添加到您的音频 src 来播放该文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T01:59:06.787

是的，您可以通过这种方式访问​​所有公共文件。您还可以将文件放在子文件夹中。例如，如果您的文件在`./public/mp3z/myfile.mp3`其中，则可以通过 Meteor 访问它，例如`/mp3z/myfile.mp3`.

# php - mysql_query() 拒绝用户访问

> ID：10544685
> 
> 赞同：1
> 
> 时间：2012-05-11T02:34:54.290
> 
> 标签：php, mysql

我正在制作 PHP 和 MySQL RPG 游戏，但我的 changeEquipment 页面无法正常工作。我收到这些错误：

> 警告：mysql_query() [function.mysql-query]：第 21 行 /home/devinfa1/public_html/spellsword/changeEquipment.php 中用户 'devinfa1'@'localhost' 的访问被拒绝（使用密码：否）
> 
> 警告：mysql_query() [function.mysql-query]：无法在第 21 行的 /home/devinfa1/public_html/spellsword/changeEquipment.php 中建立到服务器的链接
> 
> 警告：mysql_query() [function.mysql-query]：第 27 行 /home/devinfa1/public_html/spellsword/changeEquipment.php 中用户 'devinfa1'@'localhost' 的访问被拒绝（使用密码：否）
> 
> 警告：mysql_query() [function.mysql-query]：无法在第 27 行的 /home/devinfa1/public_html/spellsword/changeEquipment.php 中建立到服务器的链接

这是我的代码：

```
<?php
// Get commonFunctions.php
require_once('commonFunctions.php');

// Start the session and connect to the database
session_start();
$con = mysql_connect("localhost","devinfa1_user","dbpass");
if (!$con) { die('Could not connect: ' . mysql_error()); }
mysql_select_db("devinfa1_spellsword", $con);   

// If logged in
if(isset($_SESSION['account_name'])) {
    // If form is submitted
    if(isset($_POST['submit']) || isset($_POST['submit_x'])) {

        // If the hero has more than one weapon
        if(hero_has_multiple_weapons()) {
            // Set new weapon
            mysql_query("UPDATE Hero_Weapons SET active_weapon = TRUE WHERE HW_hero_id =
                (SELECT hero_id FROM Heroes WHERE hero_name = '$_SESSION[hero_name]')
                AND HW_item_id = (SELECT item_id FROM Items WHERE item_name = '$_POST[weapon]')");

            // Unset previous weapon
            if(isset($_SESSION['hero_name'])) {
                mysql_query("UPDATE Hero_Weapons SET active_weapon = FALSE WHERE HW_hero_id =
                    (SELECT hero_id FROM Heroes WHERE hero_name = '$_SESSION[hero_name]')
                    AND HW_item_id = (SELECT item_id FROM Items WHERE item_name = '$_SESSION[weapon_name]')");
            }
        }

// Close the database connection
mysql_close($con);
?> 
```

因此，PHP 应该使用`devinfa1_user`用户名和`dbpass`密码连接到我的数据库，但它显然试图使用`devinfa1`没有密码的用户名。

我不知道为什么会这样，因为我的 changeHero 页面上有完全相同的连接代码和更新语句，而且效果很好。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:42:36.983

根据手册，通过查询传递连接：MySQL 连接。如果未指定链接标识符，则假定由 mysql_connect() 打开的最后一个链接。如果没有找到这样的链接，它将尝试创建一个，就好像 mysql_connect() 没有参数被调用一样。如果未找到或建立连接，则会生成 E_WARNING 级别错误。

看看这是否有效，它看起来好像覆盖了最后一个连接（即在对 hero_has_multiple_weapons() 的调用中打开了一个数据库连接）或者你的最后一个连接没有真正连接

# spring - 使用 Spring Data JPA 时我的存储库无法自动初始化

> ID：10544694
> 
> 赞同：1
> 
> 时间：2012-05-11T02:36:04.703
> 
> 标签：spring, spring-mvc, spring-data-jpa

在浏览了几个教程之后，我正在尝试将 spring data jpa 添加到我的 spring-mvc web 项目中。但是我发现我的存储库无法自动初始化，我的服务类中出现了 NullPointerException。请参阅我的以下示例代码：

我的存储库：

```
public interface SubjectRepository extends JpaRepository<PSubject, String>{
public Page<PSubject> findByType(String title, Pageable pageable);
public Page<PSubject> findByType(String title);
public Page<PSubject> findByMacaddress(String macaddress, Pageable pageable);
public Page<PSubject> findByMacaddress(String macaddress);
public Page<PSubject> findByUri(String uri); 
```

}

我的控制器：

 `````
@Controller
@RequestMapping("/subject")  
public class VPSubjectController
{
....
@RequestMapping("/{id}.htm")
    public ModelAndView detail(@PathVariable String id)
    {
        ModelAndView mav = new ModelAndView("subject/detail");
        PSubject subject = subjectService.get(id);
....
}
} 
````  `我的服务：</p>

```
@Service("subjectService")
public class SubjectServiceImpl extends VPService implements SubjectService
{

    @Autowired
    private SubjectRepository subjectRepository;
......
@Override
    @Transactional(propagation=Propagation.REQUIRED, readOnly=true)
    public PSubject get(String subject) {
        PSubject subObj = subjectRepository.findOne(subject);
        return subObj;
    }
..... 
```

我的配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:jpa="http://www.springframework.org/schema/data/jpa"
    xsi:schemaLocation="    
           http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans.xsd 
           http://www.springframework.org/schema/context 
           http://www.springframework.org/schema/context/spring-context.xsd 
           http://www.springframework.org/schema/mvc 
           http://www.springframework.org/schema/mvc/spring-mvc.xsd
           http://www.springframework.org/schema/util 
           http://www.springframework.org/schema/util/spring-util-3.0.xsd
           http://www.springframework.org/schema/data/jpa
           http://www.springframework.org/schema/data/jpa/spring-jpa.xsd">
....
<jpa:repositories base-package="com.mypacke.repository"  repository-impl-postfix="Impl" entity-manager-factory-ref="entityManagerFactory" transaction-manager-ref="transactionManager"/> 
```

……

我在这一行找到了 subjectRepository.findOne(subject) ，subjectRepository 为空，我的问题与这篇[文章类似](https://stackoverflow.com/questions/10539417/spring-data-jpa-injection-fails-beancreationexception-could-not-autowire-fi)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T07:25:48.123

@Autowired 注解由以下语句激活：

```
<context:component-scan base-package="base.package"/> 
```

如果你这样做，它将被初始化``

# android - Android，从不同的值文件夹中检索

> ID：10544702
> 
> 赞同：0
> 
> 时间：2012-05-11T02:36:37.673
> 
> 标签：android, string

我是安卓新手，真的需要大家帮忙完成我的任务^^。我目前正在做一个与 android 本地化非常相似的项目。但是，还有另一种母语未在语言或 android 设置提供的语言-区域组合中说明。Is there any other ways that i can do to make the application retrieve different strings when different language selected?

我尝试创建不同名称的值文件夹，但当文件夹命名为“values-penan”时它不起作用。

谢谢，如果有人可以帮忙！

# php - 不带引号的数组输出或 json 输出

> ID：10544708
> 
> 赞同：1
> 
> 时间：2012-05-11T02:37:19.460
> 
> 标签：php, arrays, json

在这种情况下，我如何输出不带引号的数组

```
for($i=1; $i <= date("d"); $i++) { $days[] = $i;    }
echo json_encode($days); // ouput [1,2,3,4,5,6,7,8,9,10] 
```

这个第一个很好，但是第二个

```
for($i=1;$i <= date("d"); $i++) {
        $Sql = "SELECT COUNT(Stats_Clicks) AS Total FROM tabstats WHERE DAY(Stats_Date) = $i
                AND MONTH(Stats_Date) = $month
                AND YEAR(Stats_Date) = $year 
                ";
        $Query = mysql_query($Sql,$Conn) or die (mysql_error($Conn));
        $Rs = mysql_fetch_array($Query);    

        $clicks[] = $Rs['Total'];
    }
    echo json_encode($clicks); 
```

json 输出返回这个

```
["1","1","0","0","0","0","0","0","0","0","0"] 
```

我需要这个不带引号的这种格式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T02:38:57.470

你只需要转换为整数。

```
$clicks[] = (int)$Rs['Total']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:38:21.553

未经测试：

```
$clicks[] = (int) $Rs['Total']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T02:54:13.313

尝试使用 intval 函数的 array_map

像这样：

```
echo json_encode(array_map("intval",($Rs['Total']))); 
```

例子：

```
print_r(json_encode(array_map("intval",array("1","2","3"))));
=> [1,2,3] 
```

# c# - 如何从服务器端调用 Ajax.BeginForm 的 OnFailure 事件？

> ID：10544709
> 
> 赞同：0
> 
> 时间：2012-05-11T02:37:22.900
> 
> 标签：c#, asp.net-mvc-3

当服务器端发生错误时，如何调用 Ajax.BeginForm 的 OnFailure 事件？
我应该处理 OnComplete 函数的错误吗？

**看法**

```
<script type="text/javascript">

function PullIntoTable(e) {
・・・・・
}

function search_start() {
....
}

function Failure() {
        alert("Called!!");
}

.........
</script>

@using (Ajax.BeginForm("Search", "SearchCompanyJP",
                       new AjaxOptions { HttpMethod = "POST", OnBegin = "search_start", OnSuccess = "PullIntoTable", OnFailure = "Failure", OnComplete = "search_close" }))
{
    <div>
        <span class="label">Company</span>
        @Html.TextBoxFor(m => m.CompanyName, new { @class = "textbox" })
    </div>
    <div>
        <span class="label">Address</span>
        @Html.TextBoxFor(m => m.Address, new { @class = "textbox" })
    </div>

    <input type="submit" value="Search"  />
} 
```

**XXXService.cs --**由控制器调用

```
Insertable = false;
if (Insertable)
{
・・・・・
}
else
{
    throw new CustomException(action, message);
} 
```

**Global.asax** --- 由于 ajax，此重定向不起作用。这就是我实现失败功能的原因。

```
void Application_Error(Object sender, EventArgs e)
{
    var exception = Server.GetLastError();
    Server.ClearError();
    Response.Redirect("/Error", false);
} 
```

# wordpress - 如何在给定的 post_id 是数组的情况下获取 postmeta 数据？

> ID：10544712
> 
> 赞同：0
> 
> 时间：2012-05-11T02:37:42.193
> 
> 标签：wordpress

我将如何获得仅给出 post_id 的某个 post_meta 数据，并注意，我的 post_id 是一个 id 数组？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:22:47.177

Post 元数据函数结构是这样的：

```
<?php $meta_values = get_post_meta($post_id, $key, $single); ?> 
```

因此，如果您的 $post_id 变量是数组，那么您可以使用如下内容：

```
 <?php $meta_values = get_post_meta($post_id[0], $key, $single); ?> 
```

# ios - xcode 更新 NSMutableArray

> ID：10544715
> 
> 赞同：0
> 
> 时间：2012-05-11T02:37:59.010
> 
> 标签：ios, xcode, nsmutablearray

我有一个全局 NSMutableArray，我需要用值更新它。NSMutableArray 在 .h 中定义如下；

```
@property (strong, nonatomic) NSMutableArray *myDetails; 
```

在 viewDidLoad 中像这样预填充；

```
 NSDictionary *row1 = [[NSDictionary alloc] initWithObjectsAndKeys:@"1", @"rowNumber", @"125", @"yards", nil];
    NSDictionary *row2 = [[NSDictionary alloc] initWithObjectsAndKeys:@"2", @"rowNumber", @"325", @"yards", nil];
    NSDictionary *row3 = [[NSDictionary alloc] initWithObjectsAndKeys:@"3", @"rowNumber", @"525", @"yards", nil];
self.myDetails = [[NSMutableArray alloc] initWithObjects:row1, row2, row3, nil]; 
```

然后，当用户更改文本字段时，此代码将运行此代码；

```
-(void)textFieldDidEndEditing:(UITextField *)textField{
    NSObject *rowData = [self.myDetails objectAtIndex:selectedRow];

    NSString *yards = textField.text;

    [rowData setValue:yards forKey:@"yards"];

    [self.myDetails replaceObjectAtIndex:selectedRow withObject:rowData];
} 
```

单步执行代码时 [rowData setValue:yards forKey:@"yards"]; 它返回此错误；

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '-[__NSCFDictionary setObject:forKey:]: mutating method sent to immutable object' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:46:55.000

该数组是可变的，但其中的内容... NSDictionary... 不是。你从数组中抓取一个对象......

```
NSObject *rowData = [self.myDetails objectAtIndex:selectedRow]; 
```

然后你尝试改变那个对象......

```
[rowData setValue:yards forKey:@"yards"]; 
```

数组中的对象就是你要改变的东西……它是 NSDictionary，不可变的，你不能改变它。如果你希望字典是可变的，你必须使用 NSMutableDictionary

# c# - 不在“包含”查询中的 LINQ 不起作用

> ID：10544721
> 
> 赞同：1
> 
> 时间：2012-05-11T02:39:05.397
> 
> 标签：c#, sql, linq

疯了。

简单的查询，但它只是不工作。我只需要获取当前未分配给任何用户的公司单位。

ID 是 GUID 类型。

调试时，我看到 companyUnits 中有 2 个对象，userCompanyUnits 中有 1 个对象。我正在尝试显示 1 个 companyUnit（在 userCompanyunit 中不存在）。相反，我没有得到任何结果。

知道查询有什么问题吗？也许我无法根据指南进行比较？

```
var companyUnitsList = from x in companyUnits
                       where !(from c in userCompanyUnits
                               select c.CompanyUnit.Id).Contains(x.Id)
                        select x; 
```

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:41:53.657

这是一种不使用 except 运算符并且需要自定义 IEqualityComparer 的方法：

```
 List<Tuple<int, string>> allUnits = new List<Tuple<int, string>>();
        allUnits.Add(new Tuple<int, string>(1, "unit1"));
        allUnits.Add(new Tuple<int, string>(2, "unit2"));
        allUnits.Add(new Tuple<int, string>(3, "unit3"));

        List<Tuple<int, string>> assignedUnits = new List<Tuple<int, string>>();
        assignedUnits.Add(new Tuple<int, string>(2, "unit2"));

        var unassigned = allUnits.Where(m => !assignedUnits.Any(asgn => asgn.Item1 == m.Item1));

//Yields unit1 and unit3 
```

*   Item1 对应 Unit.ID

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T03:47:15.160

由于您已将其标记为 sql，因此我假设这是可查询的并针对数据库运行。根据 ORM 以及您是否定义了导航属性并可用，您可以执行以下操作：

```
var notAssigned =
    from x in companyUnits
    where x.Users.Any() == false
    select x; 
```

IOW，将公司单位与分配的用户联系起来的任何导航属性或集合都是您将在查询中使用的（并且很可能会转换为 sql 'exists'）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T03:49:31.377

```
 var list1 = from s in new String[] {"ABC1","ABC2", "ABC3", "ABC4"} select new {Field1=s,Id = Guid.NewGuid().ToString()}  ;
    var list2 = new String[] {"ABC3","ABC4", "ABC5", "ABC6"} ;

    var requiredList = (from i1 in list1
                    from i2 in list2 
                    where !i1.Field1.Contains(i2)
                    select i1).Distinct(); 
```

# php - 如何使用 codeigniter 在 MySQL 数据库中存储动态单选按钮输入？

> ID：10544722
> 
> 赞同：0
> 
> 时间：2012-05-11T02:39:06.807
> 
> 标签：php, mysql, codeigniter, radio-button

我知道如何存储*静态*单选按钮（名称不会更改），但是名称是从数据库中动态获取的呢？

示例：控件

```
$this->load->model('model_name');
$var = array(
    'db_column_name' => $this->input->post('radio_btn_name')
);
$this->model_name->function_name($var); 
```

风景

```
echo form_radio('radio_btn_name','myValue', false); 
```

好的，但是这个例子呢：视图

```
echo form_open('control/form_event');
foreach ($query as $q) :
echo form_label($q['label_from_db'],$q['name_from_db']);
echo form_radio($q['name_from_db'],$q['value_from_db'], false);
endforeach;
echo form_submit('submit', 'Submit');
echo form_close(); 
```

*我将如何从动态*单选按钮编写控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T07:53:21.343

我不确定您何时真的想使用单选按钮或复选框。如果所有单选按钮都使用相同的`name=""`. 如果他们不这样做，那么他们就毫无意义。

此示例假定您改用复选框：

```
$arr_where = array('id' => $int_id); // The id for the row you wish to update

$arr_values = array();

$arr_fields = array('radio_name1', 'radio_name2', 'radio_name3');
foreach($arr_fields as $h)
    if ($this->input>post($h))
        $arr_values[$h] = 'TRUE'; // Or whatever you wish to store
    else $arr_values[$h] = 'FALSE'; // Or whatever you wish to store

if ($arr_values)
    $this->db->update('table_name', $arr_values, $arr_where); 
```

# ios - 关于要使用的持久数据类型的建议

> ID：10544727
> 
> 赞同：0
> 
> 时间：2012-05-11T02:40:20.643
> 
> 标签：ios, xcode, persistence

新手问题 - 我想对使用的最佳持久数据类型提出一些建议。

要求：

1.  要存储的数据：简单的文字和图片
2.  应用程序类型：信息应用程序，具有向下钻取表和详细视图屏幕，屏幕上有多个图像。
3.  数据更新：是的，应用程序将定期更新新的文本和图像，（更新最好在后台下载，而应用程序正在运行并存储此数据）

任何人都可以就使用的最佳持久数据类型向我提供一些建议。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T11:18:27.747

选择 SQlite 数据库。您可以在那里存储文本和图片。

# ruby-on-rails - 父资源中的嵌套资源表单

> ID：10544730
> 
> 赞同：0
> 
> 时间：2012-05-11T02:41:15.127
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, activerecord

我正在尝试在我的 Rails 3.2 应用程序中添加评论。它们目前是主题的嵌套资源，我无法在主题#show 中管理新评论表单的验证错误。

我的代码的工作方式与此完全相同： [Simple Parent-child forms](http://blog.dominicsayers.com/2011/08/24/howto-create-a-simple-parent-child-form-in-rails-3-1/)

我的问题是在上述帖子中使用父子表单管理验证错误的首选方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T02:06:09.273

由于该`child#update`方法重定向而不是呈现操作，因此在加载新控制器时会丢失错误对象。

我发现最常用的方法是在`flash[:error]`. 如果可用，可以为 Javascript 添加响应器。

# asp.net - 手动gridview分页

> ID：10544733
> 
> 赞同：3
> 
> 时间：2012-05-11T02:41:45.667
> 
> 标签：asp.net

我正在从数据库中提取 100 条记录中的 10 条并放入 gridview（这里没有数据源对象）。

如何启用gridview附带的分页？我知道总记录是 100 我可以用它来激活分页吗？

我知道我可以使用 DataSource 对象轻松地做到这一点，但我只是想知道就 GridView 而言我是否可以完全手动地做到这一点。

**标记**

```
<form id="form1" runat="server">
<div>

    <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
        AllowSorting="True" onpageindexchanging="GridView1_PageIndexChanging" 
        onsorting="GridView1_Sorting">
    </asp:GridView>

</div>
</form> 
```

代码隐藏

```
protected void Page_Load(object sender, EventArgs e)
{
    GridView1.DataSource = GetCustomers();
    GridView1.DataBind();
} 
```

**强文本**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:52:24.443

试试这个：

```
protected void Page_Load(object sender, EventArgs e)
{
   if(!Page.IsPostback) {BindData();}
}
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
     GridView1.DataSource = GetCustomers();
     GridView1.PageIndex = e.NewPageIndex;
     GridView1.DataBind();

}

void BindData()
{
   GridView1.DataSource = GetCustomers();
   GridView1.DataBind();

} 
```

您还需要将其添加到 gridview 标记中：

```
OnPageIndexChanging="GridView1_PageIndexChanging" 
```

# android - 从Android中的多个蓝牙设备读取？

> ID：10544737
> 
> 赞同：3
> 
> 时间：2012-05-11T02:42:22.390
> 
> 标签：android

只是为了让它简短。我想连接三个设备并同时读取这三个设备的数据。我知道如何连接到一个，我可以从中读取数据但我想要的是连接另外两个并从中读取。任何建议，或我可以遵循的其他示例。

这是与我的类似但更短的代码的一部分。此代码可以使用 mac 连接到一个设备。那么如何修改这个以同时连接三个设备并显示它们正在发送的数据呢？

请帮助我真的需要它，因为我卡在我项目的这一部分。谢谢您的帮助。

```
private boolean connected = false;
private BluetoothSocket sock;
private InputStream in;
public void test() throws Exception {
    if (connected) {
        return;
    }
    BluetoothDevice zee = BluetoothAdapter.getDefaultAdapter().
        getRemoteDevice("00:14:C5:A1:02:67");
    Method m = zee.getClass().getMethod("createRfcommSocket",
        new Class[] { int.class });
    sock = (BluetoothSocket)m.invoke(zee, Integer.valueOf(1));
    devicecon.setText("Connecting......");
    sock.connect();
    devicecon.setText("Connected");
    in = sock.getInputStream();
    byte[] buffer = new byte[50];
    int read = 0;
    Log.d("ZeeTest", "++++ Listening...");
    try {
        while (true) {
            read = in.read(buffer);
            connected = true;
            StringBuilder buf = new StringBuilder();
            for (int i = 0; i < read; i++) {
                int b = buffer[i] & 0xff;
                if (b < 0x10) {
                    buf.append("0");
                }
                buf.append(Integer.toHexString(b)).append(" ");
            }
            Log.d("ZeeTest", "++++ Read "+ read +" bytes: "+ buf.toString());
        }
    } catch (IOException e) {}
    Log.d("ZeeTest", "++++ Done: test()"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T02:53:16.597

您需要做的就是为每个设备创建一个新线程（我建议为此使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)实例而不是实际线程）并调用连接代码片段

```
BluetoothDevice zee = BluetoothAdapter.getDefaultAdapter().
    getRemoteDevice("00:14:C5:A1:02:67");
Method m = zee.getClass().getMethod("createRfcommSocket",
    new Class[] { int.class });
sock = (BluetoothSocket)m.invoke(zee, Integer.valueOf(1));
devicecon.setText("Connecting......");
sock.connect(); 
```

从那个新线程内部。

# cakephp - 如何在 cakephp 中为不同的模型设置不同的布局

> ID：10544739
> 
> 赞同：-1
> 
> 时间：2012-05-11T02:42:49.450
> 
> 标签：cakephp, view, model, controller

我有这个带有控制器“CommentsController”的模型“Comment”以及在 default.ctp 布局上查看的“add”、“edit”、“delete”功能的不同视图。但我想创建另一个模型，它是一个带有“LogInController”控制器和不同视图进行验证的“登录”模型。我当然希望在另一个布局上查看它，这将是登录面板的界面。但是我怎样才能为此创建另一个布局呢？每当我在视图中查看此日志时，它总是出现在 default.ctp 布局中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T02:44:37.340

在您的 中`logins_controller.php`，指定不同的布局：

```
class LoginsController extends AppController {
   var $layout = 'login';
} 
```

然后`APP/View/Layouts/login.ctp`为您的`login.ctp`html 等创建

# c++ - 包含后是否需要前向声明？

> ID：10544740
> 
> 赞同：2
> 
> 时间：2012-05-11T02:43:04.707
> 
> 标签：c++, visual-studio-2010, include, forward-declaration

我在自己的文件中有一个名为 GameState 的类，该类有一个指向另一个 StatusView 类型对象的指针，该对象位于它自己的文件中。在 GameState.h 中，我包含了 StatusView 标头，但是当我尝试编译它时，出现错误：

```
missing type specifier - int assumed 
```

但是，当我转发声明 StatusView 时，即使包含它，我也可以编译它。我不知道是什么导致了转发声明类的要求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T02:56:11.917

标题之间存在循环依赖关系。A 包含 B，B 包含 A，但 B*并不*真正包含 A，因为`#pragma once`已经针对 A 进行了评估。（与标准标头保护相同。）

因为内部包含被忽略了，就好像它根本不存在，你需要前向声明。

# sql-server - 如何在行列中动态分配 displayName - tooltip & displayName 显示 [object Object]

> ID：10544741
> 
> 赞同：0
> 
> 时间：2012-05-11T02:44:24.847
> 
> 标签：sql-server, actionscript-3, apache-flex, flex4.5, coldfusion-9

此 flashbuilder 4.6 应用程序根据从下拉列表中选择的名称在折线图上显示单个 lineSeries，并且lineseries 数据显示良好。但是，工具提示显示 [object Playername_returntype] 而不是下拉选择的名称。

我还想从下拉列表中动态地将相同的选择名称分配给 lineeries 的 displayName，但无法实现这一点。结果显示 [object Playername_returntype]，如工具提示中所示。

任何帮助将非常感激。

谢谢。

```
 xmlns:s="library://ns.adobe.com/flex/spark"
           xmlns:mx="library://ns.adobe.com/flex/mx"
           xmlns:pool_ratings_yr1service="services.pool_ratings_yr1service.*"
           xmlns:pool_playerservice="services.pool_playerservice.*"
           minWidth="955" minHeight="600">
<fx:Script>
    <![CDATA[
        import mx.controls.Alert;
        import mx.events.FlexEvent;

        protected function linechart1_creationCompleteHandler(event:FlexEvent):void
        {
            getpool_ratings_yr1Result.token = pool_ratings_yr1Service.getpool_ratings_yr1('Greenleaf');
        }

        protected function dropDownList_creationCompleteHandler(event:FlexEvent):void
        {
            getAllpool_playerResult.token = pool_playerService.getAllpool_player();
        }

        private function comboBoxChange():void
        {
            var selectedName:String = dropDownList.selectedItem.lname;
            getpool_ratings_yr1Result.token = pool_ratings_yr1Service.getpool_ratings_yr1(selectedName);

        }

    ]]>
</fx:Script>
<fx:Declarations>
    <s:CallResponder id="getpool_ratings_yr1Result"/>
    <pool_ratings_yr1service:Pool_ratings_yr1Service id="pool_ratings_yr1Service"
                                                     fault="Alert.show(event.fault.faultString + '\n' + event.fault.faultDetail)"
                                                     showBusyCursor="true"/>
    <s:CallResponder id="getAllpool_ratings_yr1Result"/>
    <s:CallResponder id="getAllpool_playerResult"/>
    <pool_playerservice:Pool_playerService id="pool_playerService"
                                           fault="Alert.show(event.fault.faultString + '\n' + event.fault.faultDetail)"
                                           showBusyCursor="true"/>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<mx:LineChart id="linechart1" x="151" y="88" width="800"
              creationComplete="linechart1_creationCompleteHandler(event)"
              dataProvider="{getpool_ratings_yr1Result.lastResult}" showDataTips="true">
    <mx:verticalAxis>
        <mx:LinearAxis id="v1" minimum="2000" maximum="2500" title="Average Elo Rating" /> 
    </mx:verticalAxis> 
    <mx:series>
        <mx:LineSeries id="lineSeries" displayName="{dropDownList.selectedItem}" yField="avg_rating"/>
    </mx:series>
    <mx:horizontalAxis>
        <mx:CategoryAxis id="categoryAxis" categoryField="yr"/>
    </mx:horizontalAxis>
</mx:LineChart>
<mx:Legend dataProvider="{linechart1}"/>
<s:DropDownList id="dropDownList" x="10" y="88"
                creationComplete="dropDownList_creationCompleteHandler(event)"
                labelField="lname"
                change="comboBoxChange()">
    <s:AsyncListView list="{getAllpool_playerResult.lastResult}"/>
</s:DropDownList> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T15:53:01.300

Not entirely sure what you're after, but for the LineSeries displayName, here's what I did:

Created a [Bindable] String variable for each Line Series, and then whenever the data changed, just assign whatever value you want to the variable. In your example:

```
private function comboBoxChange():void
    {
        var selectedName:String = dropDownList.selectedItem.lname;
        getpool_ratings_yr1Result.token = pool_ratings_yr1Service.getpool_ratings_yr1(selectedName);
        // Private Bindable String variable(myString) assigned earlier
        myString = selectedName;

    } 
```

And then in your mxml:

```
displayName="{myString}" 
```

Hope that's clear enough!

# c++ - C++：运算符重载，运算符+

> ID：10544742
> 
> 赞同：1
> 
> 时间：2012-05-11T02:44:24.910
> 
> 标签：c++, object, operator-overloading

```
#include<iostream>
#include"polynom.h"
using namespace std;

// operator= works !!!

int main()
{
    Polynomial p(5), q(5), r(5);
    cout<<"1"<<endl;
    cin>>x;

    p[0] = 1;
    p[1] = 2;
    p[2] = 3;

    q[0] = 4;
    q[1] = 5;
    q[2] = 6;

    cout<<p+q;
    return 0;
}

Polynomial::Polynomial(const Polynomial &copyConstructor) : size(copyConstructor.size)
{ 
    coeffs = new double(size);

    int i=0;
    while(i<size)
    {
        coeffs[i] = copyConstructor.coeffs[i];
        i++;
    }
} 

Polynomial::Polynomial(int s)
{
    size = s;
    coeffs = new double [s];

    // Setting all coefficients in the polynomial equal to 0 
    for(int i=0; i<size; i++)
        coeffs[i]=0;
}

Polynomial Polynomial::operator+ (const Polynomial &rightPoly) const
{

    int BigSize, SmallSize;
    Polynomial *newPoly = NULL;

    cout<<"in the operator\n";

    if(size == rightPoly.size)
    {
        cout<<"first if\n";
        newPoly = new Polynomial(size);

        cout<<"first if resize\n";
        for(int i=0; i<newPoly->size; i++)
            cout<<newPoly->coeffs[i]<<endl;
        cout<<"size = "<<size<<endl;
        cout<<"rightPoly.size = "<<rightPoly.size<<endl;
        cout<<"newPoly->size = "<<newPoly->size<<endl;

        cout<<"first if loop\n";
        for(int i=0; i<size; i++)
        {
            cout<<"i= "<<i;
            newPoly->coeffs[i] = rightPoly.coeffs[i]+coeffs[i];
            cout<<" newPoly[]"<<newPoly->coeffs[i]<<endl;
        }
        cout<<"out of loop\n"<<endl;
    }

    else if(size > rightPoly.size)
    {
        cout<<"second if\n";
        BigSize = size;
        SmallSize = rightPoly.size;

        newPoly = new Polynomial(BigSize);

        cout<<"second if loop\n";
        for(int i=0; i<SmallSize; i++)
            newPoly->coeffs[i] = rightPoly.coeffs[i] + coeffs[i];
        for(int i=SmallSize; i<BigSize; i++)
            newPoly->coeffs[i] = coeffs[i];
        cout<<"second if loop end\n";
    }

    else
    {
        cout<<"third if\n";
        BigSize = rightPoly.size;
        SmallSize = size;

        newPoly = new Polynomial(BigSize);

        for(int i=0; i<SmallSize; i++)
            newPoly->coeffs[i] = coeffs[i] + rightPoly.coeffs[i];
        for(int i=SmallSize; i<BigSize; i++)
            newPoly->coeffs[i] = rightPoly.coeffs[i];
    }

    cout<<"before return\n";
    return *newPoly;    
} 
```

问题：Visual Studio 2010 执行 p+q 行时，出现以下错误。p 和 q 具有相同的大小并且它们已正确初始化（我检查了它们）。

```
Windows has triggered a breakpoint in CNG242.exe.
This may be due to a corruption of the heap, which indicates a bug in CNG242.exe or any of the DLLs it has loaded.
This may also be due to the user pressing F12 while CNG242.exe has focus.
The output window may have more diagnostic information. 
```

我添加了评论以遵循这些路线并找出问题所在。我没有得到导致错误的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T09:11:42.907

The expression

```
coeffs = new double(size); 
```

allocates space for *one* `double` variable, initialises its value to `size`, and returns the pointer to `coeffs`. What you probably want is:

```
coeffs = new double[size]; 
```

Note the square brackets. This initializes space for `size` doubles, does not initialise them to anything in particular, and returns a pointer to the first one to `coeffs`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T09:09:38.357

You overflowed the heap block

```
coeffs = new double(size); // You allocated memory for only one double variable 
```

this way.

# c++ - 将 OpenCV 中的时间用于帧处理和其他任务

> ID：10544747
> 
> 赞同：2
> 
> 时间：2012-05-11T02:45:09.137
> 
> 标签：c++, image-processing, opencv, computer-vision, background-subtraction

我想从视频中数车辆。帧差分后，我得到了灰度图像或二进制图像。我已经定义了一个感兴趣的区域来处理帧的特定区域，通过感兴趣区域的车辆的像素值高于 0 甚至高于 40 或 50，因为它们是白色的。

我的想法是，当特定时间间隔（比如 1-2 秒）内的一定数量的像素是白色的，那么一定有车辆经过，所以我会增加计数器。

我想要的是，检查 1-2 秒后是否仍有白色像素出现。如果没有白色像素出现，则表示车辆已经通过，下一辆车将要来，这样计数器必须递增。

我想到的一种方法是计算视频的帧数并将其存储在一个名为 No_of_frames 的变量中。然后使用该变量，我想我可以估计经过的时间。如果变量 No_of_frames 的值大于 20，这意味着如果我的视频帧速率为 25-30 fps，则已经过去了将近 1 秒。

我在 Windows 7 和 OpenCV 2.3.1 中使用 Qt Creator

我的代码是这样的：

```
 for(int i=0; i<matFrame.rows; i++)
             {
                 for(int j=0;j<matFrame.cols;j++)

                 if (matFrame.at<uchar>(i,j)>100)//values of pixels greater than 100
                                                 //will be considered as white.
                     {
                        whitePixels++;
                     }
                 if ()// here I want to use time. The 'if' statement must be like: 
                 //if (total_no._of_whitepixels>100 && no_white_pixel_came_after 2secs)
                //which means that a vehicle has just passed so increment the counter. 
                    {  
                        counter++;      
                    }
             } 
```

任何其他计算车辆的想法，比我的更好，将受到欢迎。提前致谢。

对于背景分割，我使用以下算法，但速度很慢，我不知道为什么。整个代码如下：

```
// opencv2/video/background_segm.hpp OPENCV header file must be included.
IplImage*       tmp_frame = NULL;
CvCapture*      cap = NULL;
bool update_bg_model = true;

 Mat element = getStructuringElement( 0, Size( 2,2 ),Point() );
 Mat eroded_frame;
 Mat before_erode;
if( argc > 2 )
    cap = cvCaptureFromCAM(0);

else
//  cap = cvCreateFileCapture( "C:\\4.avi" );
   cap = cvCreateFileCapture( "C:\\traffic2.mp4" );

if( !cap )
{
    printf("can not open camera or video file\n");
    return -1;
}

tmp_frame = cvQueryFrame(cap);
if(!tmp_frame)
{
    printf("can not read data from the video source\n");
    return -1;
}

cvNamedWindow("BackGround", 1);
cvNamedWindow("ForeGround", 1);

CvBGStatModel* bg_model = 0;

for( int fr = 1;tmp_frame; tmp_frame = cvQueryFrame(cap), fr++ )
{
    if(!bg_model)
    {
        //create BG model
        bg_model = cvCreateGaussianBGModel( tmp_frame );
      //  bg_model = cvCreateFGDStatModel( temp );
        continue;
    }

    double t = (double)cvGetTickCount();
    cvUpdateBGStatModel( tmp_frame, bg_model, update_bg_model ? -1 : 0 );
    t = (double)cvGetTickCount() - t;
    printf( "%d. %.1f\n", fr, t/(cvGetTickFrequency()*1000.) );

    before_erode= bg_model->foreground;
    cv::erode((Mat)bg_model->background, (Mat)bg_model->foreground,  element );
    //eroded_frame=bg_model->foreground;
     //frame=(IplImage *)erode_frame.data;

     cvShowImage("BackGround", bg_model->background);
     cvShowImage("ForeGround", bg_model->foreground);
    // cvShowImage("ForeGround", bg_model->foreground);
    char k = cvWaitKey(5);
    if( k == 27 ) break;
    if( k == ' ' )
    {
        update_bg_model = !update_bg_model;
        if(update_bg_model)
            printf("Background update is on\n");
        else
            printf("Background update is off\n");
    }
}
cvReleaseBGStatModel( &bg_model );
cvReleaseCapture(&cap);
return 0; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T23:05:23.313

已经对车辆跟踪和计数进行了大量研究。您描述的方法似乎非常脆弱，不太可能稳健或准确。主要问题是使用高于某个阈值的像素计数，而不考虑它们的空间连通性或时间关系。

如果感兴趣的对象是唯一（或最大的）移动对象，则帧差分可用于将移动对象与其背景分离。

您真正需要的是首先识别感兴趣的对象，将其从背景中分割出来，并使用自适应滤波器（例如卡尔曼滤波器）随时间跟踪它。看看[OpenCV 视频参考](http://docs.opencv.org/modules/video/doc/video.html)。OpenCV 提供背景减法和对象分割来完成所有必需的步骤。

我建议你阅读 OpenCV - [Learning OpenCV](http://shop.oreilly.com/product/0636920022497.do)是一本很好的读物。还有关于更通用的计算机视觉算法和理论 - [http://homepages.inf.ed.ac.uk/rbf/CVonline/books.htm](http://homepages.inf.ed.ac.uk/rbf/CVonline/books.htm)有一个很好的列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T18:20:57.600

通常他们只是在马路对面放一根小气动管（软管半充满空气）。它附在一个简单的柜台上。每辆经过管道的车辆都会产生两个脉冲（先是前轮，然后是后轮）。计数器记录指定时间间隔内的脉冲数，然后除以 2 以获得大致的车辆计数。

# html - PlayN html 集成

> ID：10544748
> 
> 赞同：2
> 
> 时间：2012-05-11T02:45:26.930
> 
> 标签：html, gwt, web, playn

我在将 playn-root 组件与我的其他标准 gwt 面板和组件集成时遇到问题。换句话说，我有标准的 gwt 组件，例如按钮和表格，并且无法弄清楚如何将 playn root 添加到我想要的位置。

在 HtmlGraphics 中有一个名为 rootElement 的元素，它是一个受保护的包，我认为如果我可以访问它，那么我将能够像我需要的那样使用它。我曾尝试扩展 HtmlPlatform 类，但由于该类没有默认构造函数，因此不可扩展。

对于 html 目标游戏，我们应该如何将 playn 与 gwt 的其余部分集成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-12T15:43:27.203

如果你`<div>`在你的 HTML 主机页面中放一个 id ，`playn-root`那么 PlayN 会将游戏视图添加到该 div 中。可爱的示例游戏演示了这一点：

```
<body bgcolor="black">
  <div id='playn-root'></div>
  <script src="cutegame/cutegame.nocache.js"></script>
</body> 
```

如果您需要在 GWT 应用程序中访问该 div，您可以使用`Document`：

```
Document.get().getElementById("playn-root") 
```

# c#-4.0 - 如何从字典值集合中读取值并使其以逗号分隔？

> ID：10544749
> 
> 赞同：1
> 
> 时间：2012-05-11T02:45:30.923
> 
> 标签：c#-4.0, dictionary

我有一个字典对象如下

```
Dictionary<string, List<string>> dictStr = new Dictionary<string, List<string>>();
dictStr.Add("Culture", new List<string>() { "en-US", "fr-FR" });
dictStr.Add("Affiliate", new List<string>() { "0", "1" });
dictStr.Add("EmailAddress", new List<string>() { "sreetest@test.com", "somemail@test.com" }); 
```

我有一个实体如下

```
public class NewContextElements
{ 
    public string Value { get; set; }
} 
```

我需要做的是，对于字典值集合的特定索引中的每个值，我必须制作一个逗号分隔的字符串并将其放入 List 集合中。

例如 NewContextElements 集合将具有（显然在运行时）

```
var res = new List<NewContextElements>();
res.Add(new NewContextElements { Value = "en-US" + "," + "0" + "," + "sreetest@test.com" });
res.Add(new NewContextElements { Value = "fr-FR" + "," + "1" + "," + "somemail@test.com" }); 
```

我正在尝试

```
var len = dictStr.Values.Count;
for (int i = 0; i < len; i++)
{
    var x =dictStr.Values[i];
} 
```

不，这当然是不正确的。

需要帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:52:58.700

尝试这个：

```
Enumerable.Range(0, len).Select( i =>
    new NewContextElements {
        Value = string.Join(",", dictStr.Values.Select(list => list[i]))
    }
); 
```

`len`是单个列表中的项目数（在您的示例中，它是两个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:02:58.547

你的意思是转换你的数据像

```
1 2 
3 4
5 6 
```

至

```
1 3 5
2 4 6 
```

试试这段代码？它可以通过几种方式进行优化。

```
var res = new List<NewContextElements>();
int i = dictStr.values.count()
for (int i=0; i < len; i++) {

    NewContextElements newContextElements = new NewContextElements();

    foreach (List<string> list in dictStr) {

        if (newContextElements.value() == null ) {

            newContextElements.value = list[i];

        } else  {

            newContextElements.value += ", " + list[i] );
        }      
    }
    res.add(newContextElements);
} 
```

让我知道代码中是否存在问题，就像您在没有真正 ide 的情况下编写代码时出现的问题一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T03:06:11.590

这不像@dasblinkenlight 的解决方案那样巧妙，但它应该可以工作：

```
 Dictionary<string, List<string>> dictStr = new Dictionary<string, List<string>>( );
        dictStr.Add( "Culture", new List<string>( ) {"en-US", "fr-FR"} );
        dictStr.Add( "Affiliate", new List<string>( ) {"0", "1"} );
        dictStr.Add( "EmailAddress", new List<string>( ) {"sreetest@test.com", "somemail@test.com"} );

        int maxValues = dictStr.Values.Select(l => l.Count).Max(); 
        List<NewContextElements> resultValues = new List<NewContextElements>(dictStr.Keys.Count);
        for (int i = 0; i < maxValues; i++) {
            StringBuilder sb = new StringBuilder();
            string spacer = string.Empty;
            dictStr.Keys.ForEach( k => {
                                    sb.AppendFormat( "{0}{1}", spacer, dictStr[k][i] );
                                    spacer = ", ";
                                  } );
            resultValues.Add( new NewContextElements(  ){ Value = sb.ToString() });
        } 
```

# php - 在 MySQL 语句中使用数组的最有效方法？

> ID：10544752
> 
> 赞同：1
> 
> 时间：2012-05-11T02:45:53.940
> 
> 标签：php, string

好吧，举个例子：

```
$array['key'] = 'value';

$SQL = "SELECT column FROM table WHERE column='{$array[key]}'"; 
```

这就是我一直在做的事情，但当然，如果我要启用 E_ALL 错误报告，我会收到有关使用未声明常量的通知，它会假定“键”而不是常量。

因此，我认为这不是正确或更有效的方法，那么执行该 SQL 查询（或其他相关字符串）的最有效方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T02:49:01.587

实际上，如果您查找 PHP 字符串引用规则，如果您省略了内部键周围的引号`{}`，它将被解释为一个常量。但是，如果省略`{}`和 引号，则将正确解释简单的数组索引，而不会发出通知。

[PHP双引号字符串解析规则](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)（相关示例在变量解析部分）

`{}`为了可读性，我倾向于使用周围：

```
// Inside {}, you must quote the array key or it will be interpreted as a constant
$SQL = "SELECT column FROM table WHERE column='{$array['key']}'"; 
```

但这也是有效的，不应发出通知：

```
// Without {}, don't quote the array key and it will be correctly parsed.
$SQL = "SELECT column FROM table WHERE column='$array[key]'"; 
```

**请注意，将变量传递到 SQL 查询*的最佳方法是使用支持准备好的语句的 API，而不是在变量中连接***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:48:14.147

您需要引用密钥。

```
$SQL = "SELECT column FROM table WHERE column='{$array['key']}'"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T02:52:59.960

我总是喜欢这样做：

```
$SQL = "SELECT column FROM table WHERE column='".$array['key']."'"; 
```

我从来没有遇到过麻烦。

如果您重新使用 sql，绑定将是一个优势：

```
http://nz.php.net/manual/en/pdostatement.bindparam.php 
```

高温高压

# c# - 如何从多个相似序列中选择最后一组连接序列

> ID：10544758
> 
> 赞同：1
> 
> 时间：2012-05-11T02:47:09.423
> 
> 标签：c#, .net, linq, collections

我有一个 int 数组，它是来自多个相似数组的串联数组，它们都从 1 开始。

1, 2, 3, 4
1, 2
1, 2, 3
1, 2

```
int[] list = { 1, 2, 3, 4, 1, 2, 1, 2, 3, 1, 2 }; 
```

我想要实现的是获得结果的“最后一组”，即 {1, 2}。

**尝试**：

```
int[] list = { 1, 2, 3, 4, 1, 2, 1, 2, 3, 1, 2 };

List<int> lastSet = new List<int>();
var totalSets = list.Count(x => x == 1);

int encounter = 0;
foreach (var i in list)
{
    if (i == 1)
        encounter += 1;

    if (encounter == totalSets)
        lastSet.Add(i);
}

lastSet.ToList().ForEach(x => Console.WriteLine(x)); 
```

有没有更好的方法来使用 LINQ 来实现这一点，也许`SkipWhile`, `GroupBy`, `Aggregate`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:54:38.210

如果您可以使您的列表成为实际列表，`List<int>`或者如果通过 创建列表副本不打扰您，则`.ToList()`可以执行以下操作：

```
var list = new[]{ 1, 2, 3, 4, 1, 2, 1, 2, 3, 1, 2 }.ToList();
var lastSet = list.Skip(list.LastIndexOf(1)).ToList(); 
```

否则，`Aggregate`可以工作，但它有点难看：

```
var lastSet = list.Aggregate(new List<int>{1}, (seed, i) => {
    if(i == 1) {seed.Clear(); }
    seed.Add(i);
    return seed;
}) 
```

### 更新

正如 dtb 指出的那样，您可以使用 Array.LastIndexOf 而不是创建列表：

```
var list = new[]{ 1, 2, 3, 4, 1, 2, 1, 2, 3, 1, 2 };
var lastSet = list.Skip(Array.LastIndexOf(list, 1)).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:57:28.913

Works for any `IEnumerable` (but is slower than direct `List` versions)

```
var sub = list.Reverse<int>()
              .TakeWhile(i => i != 1)
              .Concat(new[]{1})
              .Reverse<int>(); 
```

Run a `ToArray()` on the result if you like.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T02:58:31.737

Using the [GroupAdjacent Extension Method](https://stackoverflow.com/a/10544835) below, you can split the list into the sequences beginning with 1 and then take the last sequence:

```
var result = list.GroupAdjacent((g, x) => x != 1)
                 .Last()
                 .ToList(); 
```

with

```
public static IEnumerable<IEnumerable<T>> GroupAdjacent<T>(
    this IEnumerable<T> source, Func<IEnumerable<T>, T, bool> adjacent)
{
    var g = new List<T>();
    foreach (var x in source)
    {
        if (g.Count != 0 && !adjacent(g, x))
        {
            yield return g;
            g = new List<T>();
        }
        g.Add(x);
    }
    yield return g;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T03:13:40.993

LINQ is overrated:

```
int[] list = { 1, 2, 3, 4, 1, 2, 1, 2, 3, 1, 2 };

int pos = Array.LastIndexOf(list, 1);

int[] result = new int[list.Length - pos];
Array.Copy(list, pos, result, 0, result.Length);

// result == { 1, 2 } 
```

* * *

Now with 100% more readable:

```
int[] list = { 1, 2, 3, 4, 1, 2, 1, 2, 3, 1, 2 };

int[] result = list.Slice(list.LastIndexOf(1));

// result == { 1, 2 } 
```

where

```
static int LastIndexOf<T>(this T[] array, T value)
{
    return Array.LastIndexOf<T>(array, value);
}

static T[] Slice<T>(this T[] array, int offset)
{
    return Slice(array, offset, array.Length - offset);
}

static T[] Slice<T>(this T[] array, int offset, int length)
{
    T[] result = new T[length];
    Array.Copy(array, offset, result, 0, length);
    return result;
} 
```

# dynamic-linking - 在 Linux 英特尔编译器 (icc) 中面临与 mkl 的链接问题

> ID：10544766
> 
> 赞同：1
> 
> 时间：2012-05-11T02:48:18.153
> 
> 标签：dynamic-linking, icc, intel-mkl

这是linux中的命令行：

```
icc test.c -o test.o -L/opt/intel/current/mkl/intel64 -I/opt/intel/current/mkl/include -lmkl_intel_ilp64 -lmkl_core -lmkl_scalapack_ilp64 
```

运行此命令后：我得到了一长串*未定义的参考错误*。我也在 eclipse 中尝试过，但也无法解决那里的链接问题。如果有人帮助我运行这样的小代码，我会很高兴：

```
//test.c- a sample code from user guide
#include "mkl.h"
#define N 5
void main()
{
int n, inca = 1, incb = 1, i;
typedef struct{ double re; double im; } complex16;
complex16 a[N], b[N], c;
void zdotc();
n = N;
for( i = 0; i < n; i++ ){
a[i].re = (double)i; a[i].im = (double)i * 2.0;
b[i].re = (double)(n - i); b[i].im = (double)i * 2.0;
}
zdotc( &c, &n, a, &inca, b, &incb );
printf( "The complex dot product is: ( %6.2f, %6.2f) ", c.re, c.im );
} 
```

我的服务器

```
> MKLROOT: /opt/intel/current/mkl/
>           library: $MKLROOT/lib/intel64/
>           include:$MKLROOT/include 
```

已安装 ICC 64 位。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T12:02:29.943

为英特尔 MKL 获取正确链接线的最佳方法是使用[MKL Linkline Advisor](http://software.intel.com/en-us/articles/intel-mkl-link-line-advisor/ "MKL 连接线顾问")。即使使用正确的 LD_LIBRARY_PATH 编译器选项和您链接的库集看起来也不正确。应该

```
-DMKL_ILP64 -I$(MKLROOT)/include -L$(MKLROOT)/lib/intel64 -lmkl_intel_ilp64 -lmkl_intel_thread -lmkl_core -openmp -lpthread -lm 
```

# sql - 如何为 IS-A 关系编写插入语句 (SQL)？

> ID：10544777
> 
> 赞同：0
> 
> 时间：2012-05-11T02:49:56.390
> 
> 标签：sql

我在演员和人之间有一个 IS-A 关系。

我了解如何为 PERSON 编写插入语句。但是我如何将它连接到 ACTOR？

编辑：澄清一下，除了手动设置关系之外，还有其他方法吗？

```
CREATE TABLE person
(
  person_id     INT,
  person_name   VARCHAR(20),
  birth_year    CHAR(4),
  gender        CHAR(1),
  PRIMARY KEY(person_id)
);

CREATE TABLE actor
(
  actor_id      INT NOT NULL REFERENCES person(person_id),
  PRIMARY KEY(actor_id)
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:59:38.983

这取决于你如何确定谁是演员。如果您在插入 person 表时已经知道这一点，那么您也可以使用另一个 INSERT 语句将该行插入到 actor 表中。

如果您已经定义了 person 表并且想要识别特定的人并将他们标记为演员（即按名称），您可以执行以下操作：

```
INSERT INTO actor (actor_id) 
  SELECT person_id    
  FROM person
  WHERE person_name = 'Will Smith'; 
```

[http://sqlfiddle.com/#!2/ce898/9](http://sqlfiddle.com/#!2/ce898/9)

无论哪种方式，只要 actor 中的 actor_id 与一个有效的 person_id 匹配，INSERT 就有效。如果不存在对应的 person_id，则 INSERT 将失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T03:10:52.900

如果您使用的是 Postgres，您可以进行继承，就像在 OOP 中一样：

```
CREATE TABLE person
(
  person_id     serial primary key,
  person_name   VARCHAR(20),
  birth_year    CHAR(4),
  gender        CHAR(1)
);

create table actor
(
  role text
) inherits(person); 
```

测试：

```
insert into person(person_name,birth_year,gender)
values('john lennon','1940','M');

insert into actor(person_name,birth_year,gender,role)
values('johnny depp','19xx','M','hacker');

insert into actor(person_name,birth_year,gender,role)
values('johnny walker','19xx','M','walker');

select * from person order by person_name;

select * from actor order by person_name;

Output:

PERSON_ID   PERSON_NAME     BIRTH_YEAR  GENDER
1           john lennon     1940        M
2           johnny depp     19xx        M
3           johnny walker   19xx        M

PERSON_ID   PERSON_NAME     BIRTH_YEAR  GENDER  ROLE
2           johnny depp     19xx        M       hacker
3           johnny walker   19xx        M       walker

----------------------------------------------------------------

update actor set 
  role = 'pirates', birth_year = 1963
where person_name = 'johnny depp';

select * from person;

select * from actor;

Output:

PERSON_ID   PERSON_NAME     BIRTH_YEAR  GENDER
1           john lennon     1940        M
2           johnny depp     1963        M
3           johnny walker   19xx        M

PERSON_ID   PERSON_NAME     BIRTH_YEAR  GENDER  ROLE
2           johnny depp     1963        M       pirates
3           johnny walker   19xx        M       walker

----------------------------------------------------------------

delete from actor where person_name = 'johnny depp';

select * from person;

select * from actor;

Output:

PERSON_ID   PERSON_NAME     BIRTH_YEAR    GENDER
1           john lennon     1940          M
3           johnny walker   19xx          M

PERSON_ID   PERSON_NAME     BIRTH_YEAR    GENDER  ROLE
3           johnny walker   19xx          M       walker 
```

现场测试：[http ://www.sqlfiddle.com/#!1/463f4/1](http://www.sqlfiddle.com/#!1/463f4/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T04:57:46.670

请试试这个

INSERT INTO ACTOR (ACTOR_ID) SELECT P.PERSON_ID FROM PERSON P LEFT JOIN ACTOR A ON P.PERSON_ID=A.ACTOR_ID

谢谢拉贾特

# php - 如何在运行较长的 PHP 脚本时清除内存？试过 unset()

> ID：10544779
> 
> 赞同：24
> 
> 时间：2012-05-11T02:50:53.070
> 
> 标签：php, mysql

我的脚本将一个 excel 文件导入到产品数据库中，以更新新产品的数量等......

我有内存问题，我尝试将内存限制提高到最大值（800MB+）。我尝试取消设置变量以释放循环之间的内存，但我仍然内存不足。我尝试将超时设置为无限，但这绝对是内存问题。

来自日志文件的错误消息：致命错误：允许的内存大小为 851443712 字节已用尽（尝试分配 71 字节）

任何脚本都不包含在函数中。如果我在一个函数内创建主 for 循环并重复调用该函数将有助于垃圾收集和清理内存吗？任何帮助或指导将不胜感激。

导入脚本：

```
error_reporting( E_ALL & ~E_NOTICE );
ini_set('memory_limit', '812M');
set_time_limit(0);

/* Config Start */
define('BasePath', '/home/xxxxx/public_html');
define('CfgMagentoPath',                    BasePath);
define('CfgCategoryMapDBxls',                   BasePath."/xxxx/Shdddddd.xls");
define('CfgVenderDBxls',                    BasePath."/xxxx/xxxxxx.xls");
define('CfgReportEmail',                    "xxxxxx@gmail.com");
/* Config End */

require_once(CfgMagentoPath . '/app/Mage.php');
Mage::app(); 
//$app = Mage::app('default'); 
//Mage::app()->setCurrentStore(Mage_Core_Model_App::ADMIN_STORE_ID);
require_once(BasePath.'/xxxxx/xxxx/libs/mage.func-inc.php');
require_once(BasePath.'/xxxxx/xxxxx/libs/excel-read.class.php');

//Alert Arrays
$AAnotmapped        = array();
$AAnewproducts  = array();
$AApriceupdated = array();
$AAimgerror         = array();
$PriceErrors        = array();

$SkipCat = false;

//Create Mapped Cats - In Magento

$excel = new ExcelReader(CfgCategoryMapDBxls,"UTF-8");
$CM = $excel->getWorksheetData('Sheet1');
if(!$SkipCat){
    echo "========   Generating Catagory Maps   ===========\n\n";
    CatMap_Create($CM);
    echo "======== ============================== ===========\n\n";
}

//Start Item Read
$excel = new ExcelReader(CfgVenderDBxls,"UTF-8");
$IT = $excel->getWorksheetData('New_DATA');
$ITcnt = 0;
$ITtotal = count($IT);

foreach($IT as $ItemRow){
    $ITcnt++;

    $cSKU                   = $ItemRow['ITEM'];
    $cProductName   = Clean_Data($ItemRow['ALTSHORTDESC']);
    $cCatName           = Clean_Data($ItemRow['CATEGORY']);
    $cManuf                 = Clean_Data($ItemRow['MANUFACTURER']);
    $cShortDesc         = Clean_Data($ItemRow['SHORTDESC']);
    $cLongDesc          = Clean_Data($ItemRow['LONGDESC']);
    $cUPC                       = Prod_GetUPC($ItemRow['UPC'], $ItemRow['ALTUPC']);
    $cStockQty          = $ItemRow['QTY'];
    $cWeight                = Prod_GetWeight($ItemRow['WEIGHT'], $ItemRow['ALTWEIGHT']);
    $cPrice                 = Prod_FigurePrice($ItemRow['COST'], $ItemRow['MSRP'], $ItemRow['MAP']);
    $cCost                  = $ItemRow['COST'];

    //Locate Catagory Map Magento ID
    $mCatId = CatMap_Search($CM, $ItemRow['CATEGORY']);

    //Now Create Product
    if($mCatId > 0 && $cProductName != ""){

        echo date("m.d.y g:i a")."\t($ITcnt / $ITtotal) Working On: " . $cProductName . " - SKU: $cSKU\n";
        $ProdID = Prod_GetIDfromSKU($cSKU);

        if($ProdID > 0){
            if(Prod_Update($ProdID, $cCost, $cStockQty, $cWeight, $cUPC)){
                echo "Updated: $cProductName\n";
                $ITindex++;
            }
        }else{
            Prod_Create($cSKU, $cProductName, $cManuf, $cPrice, $cCost, $cWeight, $cShortDesc, $cLongDesc, $cStockQty, $cUPC, $mCatId);
            echo "Created: $cProductName to Catagory: $mCatId\n";
            echo "$cShortDesc\n\n";
            $ProdID = Prod_GetIDfromSKU($cSKU);
        }

        if($cPrice <= $cCost){
            array_push($PriceErrors, "[$cSKU] $cProductName > Cost: $cCost | Price: $cPrice");  
            echo "Price Lower than Cost : Auto Inactive : Cost: $cCost | Price: $cPrice\n";
        }   

        Prod_AddImg($ProdID, $cSKU);

    }

    unset($ItemRow, $ProdID, $cSKU, $cProductName, $cManuf, $cPrice, $cCost, $cWeight, $cShortDesc, $cLongDesc, $cStockQty, $cUPC, $mCatId);
    echo "\n";  

}

echo "======== Disabling 0 Product Catagories ===========\n\n";
Cat_Disable_Empty($CM);
echo "======== ============================== ===========\n\n";

unset($CM, $IT, $excel);

//array_push($AAnotmapped, 'Cat not Mapped');
//array_push($AApriceupdated, '### Price Updated');
//array_push($AAimgerror , 'Image Error');

Send_Status_Email();

Mage_Reindex();

echo date("m.d.y g:i a")."\tCompleted\n\n";

//print_r($AAnotmapped);

//print_r($AApriceupdated);

//print_r($AAimgerror); 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-11T02:58:37.133

使用函数。
使用`$var = null;`而不是`unset($var);`. Unset 只会杀死变量引用。

如本[评论](https://stackoverflow.com/questions/10544779/how-can-i-clear-the-memory-while-running-a-long-php-script-tried-unset#comment13646797_10544838)所述：

> 当您使用 unset 时，只有在垃圾收集器决定时才会释放内存，但是当您将变量设置为不同的值（在这种情况下为 null）时，您当然可能会以 CPU 成本释放一些内存。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-06-29T10:45:01.670

即使您使用函数，您也希望垃圾收集器在函数返回时清理函数范围内的所有内容。这不是保证，如果您正在与内存使用作斗争，使用函数甚至可能对您不利。由于范围的原因，php 必须创建作为参数传递的变量的副本，这只会增加内存使用量。您可以查看传递引用。

只有当有可用的 CPU 周期时，垃圾收集器才会释放内存。通常在循环中它不会有机会，所以它会在循环之后尝试这样做，在这种情况下可能已经太晚了。

但是，您可以强制垃圾收集器通过调用`gc_collect_cycles`.

您也可以尝试使用调试代码`memory_get_usage()`

# bash - 如何从给定的行号和列号复制文本并将其粘贴到另一个文件中的给定行号和列号

> ID：10544788
> 
> 赞同：1
> 
> 时间：2012-05-11T02:52:18.630
> 
> 标签：bash

我 在第 1 行和第 2 列有一个包含
“0x0003FFB0”的文件 address.txt 我想将它粘贴到第 20 行和第 58 列的另一个文件“linker.txt”中 我如何使用 bash 脚本来做到这一点？ 请注意，输入文件的内容可以是随机的，不必每次都相同。 但是要复制的单词的长度总是一样的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:59:16.743

你可以使用 SED

```
sed -i.old '20s/^.{58}/&0x0003FFB0/' file 
```

它将生成一个带有原始内容的file.old，并且文件将使用该地址进行更新。快速解释

```
sed '20command'    file  # do command in line 20
sed '20s/RE/&xxx/' file  # search for regular expression, replace by the original text (&) + xxx 
```

读取地址并放入这个 sed，尽可能减少

```
ADDRESS=$(head -1 address.txt | cut -f2)
sed -i.old "20s/^.{58}/&${ADDRESS}/" file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T04:01:26.070

您可以使用 head 和 tail 的组合来获取任何行号。要获取第 2 行，请获取前两行（使用 head）的最后一行（使用 tail）：

```
ADDRESS=$(head -2 address.txt | tail -1 | cut -f2) 
```

对于第三行：

```
ADDRESS=$(head -3 address.txt | tail -1 | cut -f2) 
```

等等。

# jquery-ui - jQuery Droppable 元素 - 基于项目丢弃的条件丢弃事件

> ID：10544790
> 
> 赞同：1
> 
> 时间：2012-05-11T02:52:25.140
> 
> 标签：jquery-ui, jquery

我有一个我似乎无法弄清楚的问题。我试图让一个可放置元素有条件地根据放置的项目的类触发不同的功能。对于我的生活，我无法弄清楚如何做到这一点。这是链接：http: [//jsfiddle.net/643PC/22/](http://jsfiddle.net/643PC/22/)

pageContainer 接受行。行接受跨度。Spas 应该接受 Actions 和 Fields 并根据丢弃的项目触发不同的功能。有任何想法吗？

在大卫的帮助下完成的功能：

```
 function generalDrop(event, ui) {
        var appendTarget = $(this);
        if (ui.draggable.hasClass('field-item')) {
            fieldDrop(event, ui, appendTarget);
        }
        else {
            actionDrop(event, ui, appendTarget);
        }
    }

    function actionDrop(event, ui, appendTarget) {
        $(document.createElement('a'))
            .addClass('btn btn-primary')
            .attr('href', '#')
            .text('Button')
            .appendTo(appendTarget)
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:09:22.503

将您的 generalDrop 函数更改为：

```
function generalDrop(event, ui) {
    if (ui.draggable.hasClass('field-item')) {
        fieldDrop(event, ui);
    }
    else {
        actionDrop(event, ui);
    }
} 
```

# c# - 使用通用接口存储库

> ID：10544791
> 
> 赞同：0
> 
> 时间：2012-05-11T02:52:39.933
> 
> 标签：c#, .net

我的存储库设置如下。

```
interface IRepository<T> where T : DataRow
{
  T Get(int key);
}

interface ICartonRepository : IRepository<CartonDataRow>
{

}

class CartonRepository : ICartonRepository
{
  public CartonDataRow Get(int key)
  {

  }
} 
```

我还有一个 PackRepository，它的定义方式与 CartonRepository 相同。我想做的是类似以下的事情。

```
IRepository<DataRow> repository;
switch (rowType)
{
  case Carton:
    repository = new CartonRepository();
    break;
  case Pack:
    repository = new PackRepository();
    break;
} 
```

有没有办法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:09:41.543

```
interface IRepository<out T> where T : DataRow
{
  T Get(int key);
} 
```

不过，这需要 C# 4.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:21:04.727

您需要某种[工厂模式](http://sourcemaking.com/design_patterns/factory_method)。

下面的逻辑应该去工厂类

```
class RepositoryFactory
{
    IRepository<T>  Get(rowType)
    {
        IRepository<T> repository = default(IRepository<T>);
        switch (rowType)
        {
        case Carton:
            repository = new CartonRepository();
            break;
        case Pack:
            repository = new PackRepository();
            break;
        }

        return repository;
    }
} 
```

[您可以使用依赖注入](http://msdn.microsoft.com/en-us/magazine/cc163739.aspx)或基于在[字典](http://blogs.microsoft.co.il/blogs/gilf/archive/2009/11/22/applying-strategy-pattern-instead-of-using-switch-statements.aspx)中维护所有存储库来进一步改进 Get 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T03:23:51.520

对于 C# 3.5，您必须添加以下内容：

```
public interface IRepository {
   DataRow Get(int key);
}

public abstract class Repository<T> : IRepository<T>, IRepository
    where T : DataRow
{
   public abstract T Get(int key);

   DataRow IRepository.Get(int key) {
       return this.Get(key);
   }
} 
```

然后更改`CartonRepository`为`class CartonRepository : Repository<CartonDataRow>`（我认为您不需要`ICartonRepository`，但您可以根据需要使用它）。然后

```
IRepository repository;
switch (rowType)
{
  case Carton:
    repository = new CartonRepository();
    break;
  case Pack:
    repository = new PackRepository();
    break;
} 
```

# android - java代码如何支持多种屏幕尺寸

> ID：10544793
> 
> 赞同：0
> 
> 时间：2012-05-11T02:52:46.523
> 
> 标签：android, xml, resize, screen-size

我开发了一个应用程序。我开发的尺寸是**3.7in WVGA Nexus One**。

所以当显示大于这个屏幕时，它没有问题。当我显示小于 3.7 英寸时，问题来了。

这是我的 xml，我将固定 px 用于某些小部件。

```
<LinearLayout
    android:id="@+id/layout_content"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_below="@id/layout_title"
    android:background="@drawable/backrepeat"
    android:gravity="center_vertical|center_horizontal" >

    <ScrollView
        android:id="@+id/scrollView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center_vertical|center_horizontal" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:gravity="center_vertical|center_horizontal" >

            <TableLayout
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:gravity="center_vertical|center_horizontal" >

                <TableRow
                    android:layout_width="fill_parent"
                    android:gravity="center_vertical|center_horizontal"
                    android:paddingBottom="10px"
                    android:paddingTop="10px" >

                    <LinearLayout
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:gravity="center_vertical|center_horizontal" >

                        <TextView
                            android:id="@+id/fixtext_name"
                            android:layout_width="80px"
                            android:layout_height="wrap_content"
                            android:gravity="right"
                            android:paddingBottom="10px"
                            android:text="姓名 :"
                            android:textColor="#000000"
                            android:textSize="30px" />

                        <EditText
                            android:id="@+id/text_name"
                            android:layout_width="400px"
                            android:layout_height="wrap_content"
                            android:ems="15"
                            android:gravity="left"
                            android:inputType="textPersonName"
                            android:paddingBottom="10px"
                            android:textSize="30px" >
                        </EditText>
                    </LinearLayout>
                </TableRow>                        
            </TableLayout>
        </LinearLayout>
    </ScrollView>
</LinearLayout> 
```

这是我的应用程序布局的一个示例。总宽度为 480 像素，高度使用

> 填充父

所以，身高没有问题。

```
<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:resizeable="true"
    android:smallScreens="true"
    android:xlargeScreens="true"
    android:requiresSmallestWidthDp="480"
    android:compatibleWidthLimitDp="480"
    android:largestWidthLimitDp="480" >
</supports-screens> 
```

这是清单 xml 中的 support-screen 属性。我已经设置好了。

问题是当我在**2.7 英寸 QVGA**（类似于 SG Mini）中显示时，它只显示 240 像素宽度而不是全屏项目。

我想问一下如何根据应用程序的屏幕大小来压缩或调整应用程序的大小？

如果可以，我是否需要为所有活动编写相同的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T02:59:06.313

您可以指定一个仅适用于小屏幕的新 XML 文件。

1) 右键单击​​您的项目
2) 选择 new->Android XML 文件
3) 制作新布局，输入与您的原始文件相同的名称，然后按 NEXT（未完成）
4) 您现在可以选择限定符 - 例如“大小" 并指定 XML 仅适用于小屏幕 5) 一旦您指定了限定符及其属性，请按完成。
6) 您现在在名为 layout-SOMETHING 的文件夹中有一个 XML 文件（在本例中为 layout-small）

无需更改代码中的任何内容，即可修改此新布局以适应较小的屏幕。只需确保您具有相同的 id 等以避免 NULLPOINTER 异常。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T04:09:29.160

看起来您正在尝试使用“px”。这可能是问题所在。而是尝试为 XML 中的 width 和 padding 属性使用“dip”。

这是一个很好的例子，它向您解释了 px、dp、dip 等之间的区别。

[Android上的“px”、“dp”、“dip”和“sp”有什么区别？](https://stackoverflow.com/q/2025282/603744)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-16T09:06:33.980

根据小型仿真器视图设计新的 .xml 文件。设计 .xml 文件后，然后使用此代码。

.java 文件试试这个：

```
DisplayMetrics displaymetrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(displaymetrics);
screenHeight = displaymetrics.heightPixels;
screenWidth = displaymetrics.widthPixels;
screendensity = displaymetrics.densityDpi;
Log.i("screenHeight",""+screenHeight);
Log.i("screenWidth",""+screenWidth);
Log.i("screendensity",""+screendensity); 
```

然后在您将传递 .xml 文件 id 的地方应用 switch case。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-23T09:34:27.570

最终 ViewTreeObserver mLayoutObserver = mLayout.getViewTreeObserver();

```
mLayoutObserver.addOnGlobalLayoutListener(new OnGlobalLayoutListener() 
{

    @Override
    public void onGlobalLayout() 
    {
        DisplayMetrics metrics = getResources().getDisplayMetrics();

        int deviceWidth = metrics.widthPixels;

        int deviceHeight = metrics.heightPixels;

        float widthInPercentage =  ( (float) 280 / 320 )  * 100; // 280 is the width of my LinearLayout and 320 is device screen width as i know my current device resolution are 320 x 480 so i'm calculating how much space (in percentage my layout is covering so that it should cover same area (in percentage) on any other device having different resolution

        float heightInPercentage =  ( (float) 300 / 480 ) * 100; // same procedure 300 is the height of the LinearLayout and i'm converting it into percentage

        int mLayoutWidth = (int) ( (widthInPercentage * deviceWidth) / 100 );

        int mLayoutHeight = (int) ( (heightInPercentage * deviceHeight) / 100 );

        LayoutParams layoutParams = new LayoutParams(mLayoutWidth, mLayoutHeight);

        mLayout.setLayoutParams(layoutParams);
    }
}); 
```

# java - 如何比较 Intent.getStringExtra() 中的字符串？

> ID：10544800
> 
> 赞同：3
> 
> 时间：2012-05-11T02:53:16.747
> 
> 标签：java, android, android-intent

我可以将数据`getStringExtra()`与字符串进行比较吗？示例代码：

```
 Intent intent = getIntent();
  String path = intent.getStringExtra("category");

  if(path == "car"){
       setListAdapter(new ArrayAdapter<String>(this, R.layout.subcategory, car));
  } else {
       setListAdapter(new ArrayAdapter<String>(this, R.layout.subcategory, bike));
  } 
```

为什么脚本没有运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T03:01:17.133

在比较两个字符串以检查它们在 java 中是否相等时，您应该使用 equals()。

在您的情况下，您应该将比较线更改为

```
 if(path.equals("car")) 
```

在 java 中，equals() 比较字符串的实际内容，而 == 只会比较两个引用是否相等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T02:58:08.473

采用

```
path.equals("car") "or"
path.contains("car") "or"
path.equalsIgnoreCase("car") "or" 
```

因为这更精确

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T05:10:03.343

`==`对比是内存地址，等于对比是属性值。

# ruby-on-rails - 如何在mongodb中获取所有带有评论的文章？

> ID：10544802
> 
> 赞同：0
> 
> 时间：2012-05-11T02:53:37.387
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid

如何获取所有带有评论的文章？我有：

```
class Article
  include Mongoid::Document

  embeds_many :comments
end

class Comment
  include Mongoid::Document

  embedded_in :article
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:05:49.783

在这一刻。这似乎有效：

```
Article.where(:comments => {"$exists" => true}) 
```

我`$exists`是否在这种情况下正确使用了该指令？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:15:55.947

存在评论的文章（因此，不是零）

```
Article.where(:comments.ne => nil) 
```

# c# - 正则表达式匹配不在一个单词中的一系列字母

> ID：10544803
> 
> 赞同：2
> 
> 时间：2012-05-11T02:53:56.550
> 
> 标签：c#, regex

这应该是一个相当简单的正则表达式，但我不是这方面的专家。我正在尝试匹配一系列特定字母，但如果它是整个单词的一部分，我不希望它们匹配。我只需要捕获这些`STA`字母。这是一个例子：

```
My Regex: [Ss][Tt][Aa]

STA         -- Should Match
sta         -- Should Match
Start       -- Should NOT match
sta rt      -- Should Match
rt sta      -- Should Match
rtsta       -- Should NOT Match 
```

有人可以帮我吗？这是 C# .NET 正则表达式，如果重要的话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T02:57:08.610

使用*单词边界* `\b`标记[仅匹配整个单词](http://www.regular-expressions.info/wordboundaries.html)：

```
\b[Ss][Tt][Aa]\b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:50:55.683

此外，您可以考虑使用正则表达式选项，如下所示：

```
new Regex("\bsta\b", RegexOptions.IgnoreCase) 
```

# requirejs - RequireJS - 在相同的函数范围内同时使用定义和要求

> ID：10544805
> 
> 赞同：0
> 
> 时间：2012-05-11T02:54:15.530
> 
> 标签：requirejs

想知道是否可以在同一功能范围内同时使用定义和要求。通常是需要或定义，我如何在同一范围内拥有两者？

```
define(["my/cart", "my/inventory"],
    function(cart, inventory) {
        //Define foo/title object in here.
   }
);

require(["some/module", "a.js", "b.js"], function(someModule) {
    //This function will be called when all the dependencies
    //listed above are loaded. Note that this function could
    //be called before the page is loaded.
    //This callback is optional.
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:23:54.467

该`define`函数用于使用 AMD 样式“定义”具有依赖关系的模块，并且`require`主要用于调用以前使用`define`function 定义的那些模块。

`define`推荐的做法是每个文件只定义一个模块，但如果您将模块名称作为第一个参数传递给该函数，则可以添加多个。

如果将名称显式传递给`define`函数，则可以嵌套`define`在`require`调用中，但这没有任何意义，因为传递给的所有依赖项`require`都可以`define`直接传递给函数，这比在要求中嵌套定义更快更清晰。

也许，将 a 嵌套`require`在 a`define`中可能更有用，也许如果您有一个模块具有仅在某些条件下才需要的依赖项，那么在函数上添加公共依赖项以及在条件内部添加`define`更具体的依赖项可能是有意义的`require`陈述。

在我看来，重要的概念是理解它基本上`define`是用于定义 AMD 模块，并`require`用于调用它们。（您可以使用非 AMD 文件作为依赖项，但这是另一回事。）

# javascript - 用于创建文本字段的下拉菜单

> ID：10544811
> 
> 赞同：0
> 
> 时间：2012-05-11T02:55:19.070
> 
> 标签：javascript, jquery, html, drop-down-menu

我花了大约一两个小时试图找出当从下拉列表中选择某个值时如何使用 JavaScript 创建一个文本字段。

如果有任何帮助，这里是下拉菜单的代码。我曾尝试自己编写代码来执行此操作，但我仍然非常不熟悉如何编写 JavaScript 代码

```
<select name="claim">
    <option value="">Select a Claim</option>
    <option value="Insurance">Insurance</option> // this option I want when selected to create a text field
    <option value="Warranty">Warranty</option>
</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:03:06.503

试试这个希望它有帮助

```
 <div id="area">
         <select id="claim" name="claim">
            <option value="">Select a Claim</option>
        <option value="Insurance">Insurance</option>  
        <option value="Warranty">Warranty</option>
        </select>
        </div> 
```

和脚本

```
 $(document).ready(function(){
          $("#claim").change(function(){       
             $("#area").find(".field").remove(); 
             //or
               $('#area').remove('.field');
          if( $(this).val()=="Insurance")
             {
        $("#area").append("<input class='field' type='text' />");

             }
          });

}); 
```

示例[http://jsfiddle.net/cqjJy/](http://jsfiddle.net/cqjJy/)

# sql-server - 如何让 SQL Server 作业自行重启？

> ID：10544812
> 
> 赞同：1
> 
> 时间：2012-05-11T02:55:36.433
> 
> 标签：sql-server

有点卡在我们遇到的问题上，让我尽力解释场景，问题以及我们尝试过的内容。

1.  我们有一个 SQL 作业，它正在记录到一个特定的文件，该文件带有一个附加到末尾的日期标记
2.  第一步检查我们的日志文件是什么，例如 log_01012012.log，如果这不正确，我们更新表 sysjobsteps 以获得所有步骤的新文件位置 - 例如 log_02012012.log。我们通过在第一个工作步骤中调用存储过程来做到这一点。
3.  虽然这在表中得到更新，但其余步骤继续使用旧日志，因为我假设该表仅在作业开始时被读取一次。

我们尝试使用以下代码在存储过程中重新启动作业：

```
EXEC msdb.dbo.sp_stop_job @job_name = 'My Job'
waitfor delay '00:00:15'
EXEC msdb.dbo.sp_start_job @job_name = 'My Job' 
```

但是，当我们终止作业时，它会在终止存储过程（我猜它是作业的子进程）时出现，这意味着它永远不会进入重新启动作业的步骤。

有没有一种方法可以让作业重新启动，以便再次查看 sysjobsteps 表并使用正确的位置进行日志记录？

可能解决问题的事情是

*   能够从作业本身重新启动作业
*   能够在某些方面刷新工作。

任何我需要澄清的事情我都会尽力而为，但我们目前陷入困境，所有输入将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:37:33.620

转到 SSMS 上的 sql server 代理

扩大工作

1.  创造工作，

2.  定义步骤（sp 或简单查询）

3.  定义计划（sqlserver 重新启动时多久甚至启动一次作业）

4.  设置通知以在作业完成时向您发送电子邮件（成功/失败）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T10:51:25.273

您可以使用 Service Broker 做一些花哨的事情。就像是：

1) 作为工作的最后一步，将消息放入代理队列。内容可以为空；这只是表示“嘿......需要重新提交工作”的象征。

2）为延迟的队列编写一个激活存储过程（就像您在已经存在的过程中所做的那样），然后重新提交作业

或者，您不是在作业步骤本身中硬编码日志文件名，而是将该数据放在某个表中。然后，在更改位置的步骤中，将成功条件定义为“转到下一步”，将失败条件定义为“转到第 1 步”。然后修改更改文件位置的代码以返回错误（从而触发作业步骤的失败条件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-04T08:31:14.403

意识到将近十年了，但我遇到了同样的问题并解决如下。使用 OP 建议的代码：

```
EXEC msdb.dbo.sp_start_job @job_name = 'My Job A' 
```

只需创建一对匹配的作业，每个作业都有相同的第一步（执行实际工作）和包含上述代码但指向相反作业名称的最后一步（基本上你不能从自身重新启动同一个作业据我所知）。只需确保您在“高级”选项卡中设置“步骤行为”以在每种情况下执行最后一步，该工作就会无限期地消失。

# java - 想要使用 joda 在两个不同时区的两个 ISO 8601 时间之间获取分钟数

> ID：10544815
> 
> 赞同：0
> 
> 时间：2012-05-11T02:56:05.137
> 
> 标签：java, android, jodatime, iso8601

我有两个来自 ISO 8601 格式的 android 应用程序的字符串，我试图找出这两次之间的分钟数。我被指给了 Joda Time，它非常有帮助。但是我现在发现一个字符串是 UTC 时间，另一个是我的本地时间。

例如“2012-05-11T02:34:18+00:00”是UTC，“2012-05-10T21:44:09-05:00”是我的当地时间

我有以下代码块，可以找到两次之间的分钟数。我的问题是如何将 UTC 时间更改为本地时间，以便获得准确的分钟数

```
DateTime start = new DateTime(currentTime);
DateTime end = new DateTime(laterTime);
int min = Minutes.minutesBetween(start,end).getMinutes(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T04:45:02.323

> 如何将 UTC 时间更改为我的本地时间，以便在两者之间获得准确的分钟数？

我的理解是你不需要。

DateTime 实例代表时间线上的一个点，以及一个控制时间点如何映射到时间框架的时区（例如，当您调用 getter 时）。当您获取一对`DateTime`实例之间的时间差时，您会得到一个表示时间轴上两点之间持续时间的度量。这与时区无关。

换句话说，假设这两个`DateTime`实例被正确创建，您的代码应该可以按原样工作。

# android - 如何在填充的列表视图中为每个联系人链接一个复选框？

> ID：10544821
> 
> 赞同：2
> 
> 时间：2012-05-11T02:56:40.997
> 
> 标签：android, listview, checkbox

我在这个问题上遇到了很多麻烦。我有一个列表视图，其中包含：

**ImageView / contactName / TextView / CheckBox**

listview 中的**contactName是通过从****SimpleCursorAdapter**读取手机上的联系人来填充的。所有元素都显示应用程序何时运行，但我遇到的问题是将复选框连接到列表中的相应项目。

通过一些研究，我发现我必须使用**getView()**将复选框与列表中的项目链接起来，但通过实践，我似乎无法让它正常工作。此外，我尝试过的示例都没有真正解释如何应用 getView()。我一直在工作的最完整的例子来自这里：

[http://androidcocktail.blogspot.com/2012/04/adding-checkboxes-to-custom-listview-in.html](http://androidcocktail.blogspot.com/2012/04/adding-checkboxes-to-custom-listview-in.html)

不同之处在于，这会读取我的列表视图并用我的联系人填充：

```
private void populateContactList() {
    // Build adapter with contact entries
    Cursor cursor = getContacts();
    String[] fields = new String[] {
            ContactsContract.Data.DISPLAY_NAME       
    };

    SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, R.layout.contact_entry, cursor,
            fields, new int[] {R.id.contactEntryText});    
    lv.setAdapter(adapter);        
} // END POPULATECONTACTLIST

private Cursor getContacts()
{ 
    // Run query
    Uri uri = ContactsContract.Contacts.CONTENT_URI;
    String[] projection = new String[] {
            ContactsContract.Contacts._ID,
            ContactsContract.Contacts.DISPLAY_NAME
    };
    String selection = ContactsContract.Contacts.IN_VISIBLE_GROUP + " = '" +
            (chkboxAllVisible ? "0" : "1") + "'";
    String[] selectionArgs = null;
    String sortOrder = ContactsContract.Contacts.DISPLAY_NAME + " COLLATE LOCALIZED ASC";

    return managedQuery(uri, projection, selection, selectionArgs, sortOrder);
} // END GETCONTACTS 
```

**如何将每个复选框链接到我的列表视图中的相应联系人项目？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T05:05:33.790

好的，我已经为您创建了一个测试项目，如果您遇到任何问题，请尝试理解代码，然后询问我会尽力帮助您...

这是我的活动功能。

```
super.onCreate(savedInstanceState);
setContentView(R.layout.main);
ArrayList<String> elements = new ArrayList<String>();
for (int i = 0; i < 10; i++) {
    elements.add("elements " + i);
}

CheckBox master_cb = new CheckBox(getApplicationContext());
master_cb.setText("Check All");
//HERE IS THE LIST VIEW WHICH I HAVE CREATED IN MY XML FILE.
ListView lv = (ListView) findViewById(R.id.listView1);
//HERE I AM CREATING CUSTOM ADAPTER OBJECT.
my_custom_adapter adapter = new my_custom_adapter(this, android.R.layout.simple_list_item_1, elements);
lv.addHeaderView(master_cb);
lv.setAdapter(adapter);
master_cb.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        Intent my_intent = new Intent("master_check_change");
        my_intent.putExtra("check_value", isChecked);
        sendBroadcast(my_intent);
    }
}); 
```

}

这是我的自定义适配器。

```
public class my_custom_adapter extends ArrayAdapter<String> {
    private Context context                     = null;
    ArrayList<String>  elements                 = null;
    private ArrayList<Boolean> itemChecked      = null;

    public my_custom_adapter(Context context, int type, ArrayList<String>  elements)
    {
        super(context, type, elements);
        this.elements =  elements;
        this.context = context;
        itemChecked = new ArrayList<Boolean>();
        BroadcastReceiver receiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {
                if (intent.getAction().equals("master_check_change")) {
                    boolean check_value = intent.getBooleanExtra("check_value", false);
                    set_checked(check_value);
                    notifyDataSetChanged();
                }
            }
        };
        context.registerReceiver(receiver, new IntentFilter("master_check_change"));
        set_checked(false);
    }

    // AS EVERY TIME LISTVIEW INFLATE YOUR VIEWS WHEN YOU MOVE THEM SO YOU NEED TO SAVE ALL OF YOUR CHECKBOX STATES IN SOME ARRAYLIST OTHERWISE IT WILL SET ANY DEFAULT VALUE.
    private void set_checked(boolean is_checked)
    {
        for (int i=0; i < elements.size(); i++) {
            itemChecked.add(i, is_checked);
        }
    }

    //THIS IS SIMPLY A CLASS VIEW WILL HOLD DIFFERENT VIEWS OF YOUR ROW.
    static class ViewHolder
    {
        public TextView tv;
        public CheckBox cb;
        public ImageView iv;
    }

    @Override
    public View getView (final int position, View convertView, ViewGroup parent)
    {
        View rowView = convertView;
        ViewHolder holder = null;

        if (rowView == null) {
            LayoutInflater inflater = (LayoutInflater)context.getSystemService(
                                               Context.LAYOUT_INFLATER_SERVICE);
            // HERE I AM INFLATING LISTVIEW LAYOUT.
            rowView = inflater.inflate(R.layout.inflated_layout, null, false);
            holder = new ViewHolder();
            holder.cb = (CheckBox) rowView.findViewById(R.id.checkBox1);
            holder.tv = (TextView) rowView.findViewById(R.id.textView1);
            holder.iv = (ImageView) rowView.findViewById(R.id.imageView1);
            rowView.setTag(holder);

        } else {
            holder = (ViewHolder) rowView.getTag();
        }

        if (holder != null) {
            holder.tv.setText(elements.get(position));

            holder.cb.setOnCheckedChangeListener(new OnCheckedChangeListener() {

                @Override
                public void onCheckedChanged(CompoundButton buttonView,
                                             boolean isChecked) {
                    itemChecked.set(position, isChecked);
                }
            });

            if(position < itemChecked.size()) {
                holder.cb.setChecked(itemChecked.get(position));
            }
        }
        return rowView;
    }
} 
```

main.xml 文件是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/RelativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true" >

    </ListView>

</RelativeLayout> 
```

inflated_layout 代码是：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/RelativeLayout1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <CheckBox
        android:id="@+id/checkBox1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginRight="17dp" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:layout_toLeftOf="@+id/checkBox1"
        android:layout_toRightOf="@+id/imageView1"
        android:singleLine="true"
        android:text="Large Text"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerVertical="true"
        android:src="@drawable/ic_launcher" />

</RelativeLayout> 
```

如果你想使用字符串数组而不是 arraylist 然后替换

```
 String[] elements = new String[10];
    for (int i = 0; i < 10; i++) {
        elements[i] = "elements " + i;
    } 
```

// 在您的自定义适配器 CUNSTRUCTOR 中

```
public my_custom_adapter(Context context, int type, String[]  elements) 
```

以及一些相应的变化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T04:14:09.640

```
SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, R.layout.contact_entry, cursor,
        fields, new int[] {R.id.contactEntryText}); 
```

在这个特定的代码中看到，您只是将文本源（在字段中）与实际的 textView（R.id.contactEntryText）映射......所以同样你需要添加......另一个字段和相应的视图来映射复选框。

或者更好地制作一个CustomAdapter，你可以找到关于它的教程并覆盖getView方法，你可以获得最大的灵活性。你可以做任何你想做的事情。

这可能会有所帮助：[http ://windrealm.org/tutorials/android/listview-with-checkboxes-without-listactivity.php](http://windrealm.org/tutorials/android/listview-with-checkboxes-without-listactivity.php)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-11T03:03:56.427

不要使用自定义列表视图，您可以使用具有复选框功能的默认列表视图，但每个列表项只能使用一个在 android 开发人员网站上读取列表视图以获取列表视图属性。具有复选框的列表视图，您只需要设置多选列表视图

**编辑1：**

点击链接：[点击这里](http://developer.android.com/reference/android/widget/AbsListView.html#CHOICE_MODE_MULTIPLE)

```
public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);

      setListAdapter(new ArrayAdapter<String>(this,
              android.R.layout.simple_list_item_multiple_choice, GENRES));

      final ListView listView = getListView();

      listView.setItemsCanFocus(false);
      listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
  } 
```

# android - 如果 GPS 禁用，则强制关闭应用程序

> ID：10544822
> 
> 赞同：1
> 
> 时间：2012-05-11T02:56:52.360
> 
> 标签：android, gps, location

我有应用程序从 gps 获取位置
但是如果 GPS 禁用了我的应用程序
在模拟器中强制关闭它很好不是错误，但如果在设备中运行它是强制关闭
我该怎么做？这是我的代码：

```
public class Track extends Activity implements LocationListener{
String curTime;
double lat;
double lng;
double alt;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    final LocationManager locationManager;
    String context = Context.LOCATION_SERVICE;
    locationManager = (LocationManager)getSystemService(context);

    Criteria criteria = new Criteria();
    criteria.setAccuracy(Criteria.ACCURACY_FINE);
    criteria.setAltitudeRequired(false);
    criteria.setBearingRequired(false);
    criteria.setCostAllowed(true);
    criteria.setPowerRequirement(Criteria.POWER_LOW);
    final String provider = locationManager.getBestProvider(criteria, true);
    Dbhelper helper = new Dbhelper(this);
    final SQLiteDatabase db = helper.getWritableDatabase();
    updateWithNewLocation(null);
    Timer timer = new Timer();
    timer.scheduleAtFixedRate(new TimerTask(){
        @Override
        public void run(){
            db.isOpen();
            db.execSQL("INSERT INTO location (longitude,latitude,altitude,tgl_buat) VALUES " +
                    "('"+lng+"','"+lat+"','"+alt+"','"+curTime+"')");
            //db.close();
        }
    }, 10*60*1000, 10*60*1000);
    locationManager.requestLocationUpdates(provider, (10*60*1000), 10,
                                           locationListener);
    PackageManager manager = this.getPackageManager();
    PackageInfo info = null;
    try {
        info = manager.getPackageInfo(this.getPackageName(), 0);
    } catch (NameNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    Toast.makeText(this,
      "PackageName = " + info.packageName + "\nVersionCode = "
        + info.versionCode + "\nVersionName = "
        + info.versionName + "\nPermissions = "+info.permissions, Toast.LENGTH_SHORT).show();
    System.out.println("PackageName = " + info.packageName + "\nVersionCode = "
        + info.versionCode + "\nVersionName = "
        + info.versionName + "\nPermissions = "+info.permissions);
}
private final LocationListener locationListener = new LocationListener() {
    public void onLocationChanged(Location location) {
      updateWithNewLocation(location);
    }

    public void onProviderDisabled(String provider){
      updateWithNewLocation(null);
    }

    public void onProviderEnabled(String provider){ }
    public void onStatusChanged(String provider, int status, 
                                Bundle extras){ }
  };
  public void updateWithNewLocation(Location location) {

        if (location != null) {
            Dbhelper helper = new Dbhelper(this);
            final SQLiteDatabase db = helper.getWritableDatabase();
            long time = System.currentTimeMillis();
            SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd kk:mm:ss");
            curTime = df.format(time);
            lat = location.getLatitude();
            lng = location.getLongitude();
            alt = location.getAltitude();
            System.out.println(lat);
            System.out.println(lng);
            System.out.println(alt);
            /*db.execSQL("INSERT INTO location (longitude,latitude,altitude,tgl_buat) VALUES " +
            "('"+lng+"','"+lat+"','"+alt+"','"+curTime+"')");
            db.close();*/
            /*Timer timer = new Timer();
            timer.schedule(new TimerTask(){
                @Override
                public void run(){
                    db.execSQL("INSERT INTO location (longitude,latitude,altitude,tgl_buat) VALUES " +
                            "('"+lng+"','"+lat+"','"+alt+"','"+curTime+"')");
                    db.close();
                }
            }, 10*60*1000, 10*60*1000);*/

          } 
       }
public void onLocationChanged(Location location) {
    // TODO Auto-generated method stub

}
public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}
public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}
public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

}
} 
```

请给我一个解决方案..谢谢你的反馈:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T09:40:35.580

如果你想在你的应用程序中自动开启 GPS，恐怕除了提示用户之外别无他法。

您可以通过修改 LocationListener 中的 onProviderDisabled() 方法轻松实现此目的。这个想法是打开一个对话框，要求用户打开 GPS：

```
public void onProviderDisabled(String arg0) 
    {
        showDialog(CHOICE_GPS_ENABLE);          
    } 
```

添加您的活动：

```
 protected final static int CHOICE_GPS_ENABLE = 1; //or any other number

@Override
protected Dialog onCreateDialog(int id)
{
    Dialog dialog = null;
    switch (id)
    {
        case CHOICE_GPS_ENABLE:
            dialog = createGPSEnableDialog();
            break;

        default:
            dialog = super.onCreateDialog(id);
            break;
    }

    return dialog;
}

    protected Dialog createGPSEnableDialog()
{
    Dialog toReturnGPS;

    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("You don't have GPS enabled. Go to Settings and enable GPS?");

    builder.setTitle("GPS failed");

    builder.setPositiveButton("Yes, enable GPS",
            new DialogInterface.OnClickListener() 
                {
                    public void onClick(DialogInterface dialog, int which) 
                        {
                          Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                          startActivity(intent);
                        }
                });

    builder.setNegativeButton("No, quit application",
            new DialogInterface.OnClickListener() 
                {
                    public void onClick(DialogInterface dialog, int which) 
                        {
                            onDestroy();
                        }
                });

    toReturnGPS = builder.create();
    return toReturnGPS;
} 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:03:01.953

> 如果我的应用程序正在运行，我希望 GPS 自动打开，我该怎么做？

除了提示用户打开它之外，我认为您无法做任何事情。因此，恐怕您将无法使您的应用程序按照您的意愿运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T04:51:22.627

利用

```
Location locationtest;
     public void onLocationChanged(Location location) {
          locationtest=location;
          updateWithNewLocation(locationtest);
        }

        public void onProviderDisabled(String provider){
              locationtest= null;
              updateWithNewLocation(locationtest);
            } 
```

代替

```
 public void onProviderDisabled(String provider){
      updateWithNewLocation(null);
    } 
```

# python - 通过调用 unix-shell 命令在 python 中进行 Sftp

> ID：10544824
> 
> 赞同：4
> 
> 时间：2012-05-11T02:57:00.520
> 
> 标签：python, unix, command, sftp

我们如何通过使用 os.system 在 python 脚本中调用 unix shell 命令来将文件从源主机 sftp 到 python 中的目标服务器...请帮助

```
I have tried the following code

dstfilename="hi.txt"
host="abc.com"
user="sa"

os.system("echo cd /tmp >sample.txt)
os.system("echo put %(dstfilename)s" %locals())  // line 2 
os.system("echo bye >>sample.txt")
os.system("sftp -B /var/tmp/sample.txt %(user)s@%(host)s)

How to append this result of line to sample.txt?
os.system("echo put %(dstfilename)s %locals()) >>sample.txt" // Seems this is syntatically not correct.

cat>sample.txt      //should look like this
cd /tmp
put /var/tmp/hi.txt
bye

Any help?

Thanks you 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T05:47:06.743

您应该将您的命令通过管道传输到`sftp`. 尝试这样的事情：

```
import os
import subprocess

dstfilename="/var/tmp/hi.txt"
samplefilename="/var/tmp/sample.txt"
target="sa@abc.com"

sp = subprocess.Popen(['sftp', target], shell=False, stdin=subprocess.PIPE)

sp.stdin.write("cd /tmp\n")
sp.stdin.write("put %s\n" % dstfilename)
sp.stdin.write("bye\n")

[ do other stuff ]

sp.stdin.write("put %s\n" % otherfilename)

[ and finally ]

sp.stdin.write("bye\n")
sp.stdin.close() 
```

但是，为了回答你的问题：

```
os.system("echo put %(dstfilename)s %locals()) >>sample.txt" // Seems this is syntatically not correct. 
```

当然不是。您想将字符串传递给 os.system。所以它必须看起来像

```
os.system(<string expression>) 
```

以 a`)`结尾。

字符串表达式由具有应用`%`格式的字符串文字组成：

```
"string literal" % locals() 
```

字符串文字包含 shell 的重定向：

```
"echo put %(dstfilename)s >>sample.txt" 
```

并在一起：

```
os.system("echo put %(dstfilename)s >>sample.txt" % locals()) 
```

. 但如前所述，这是我能想象到的最糟糕的解决方案 - 更好地直接写入临时文件，甚至更好地直接进入子进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:59:03.667

好吧，我认为您问题的字面解决方案如下所示：

```
import os
dstfilename="/var/tmp/hi.txt"
samplefilename="/var/tmp/sample.txt"
host="abc.com"
user="sa"

with open(samplefilename, "w") as fd:
    fd.write("cd /tmp\n")
    fd.write("put %s\n" % dstfilename)
    fd.write("bye\n")

os.system("sftp -B %s %s@%s" % (samplefilename, user, host)) 
```

正如@larsks 所说，使用适当的文件处理程序为您制作 tmp 文件，我个人的偏好是不要使用`locals()`.

但是，根据用例，我认为这不是一种特别合适的方法 - 例如，如何输入 sftp 站点的密码？

[如果您查看Paramiko](http://www.lag.net/paramiko/docs/paramiko.SFTPClient-class.html)中的[SFTPClient](http://www.lag.net/paramiko/) ，我认为您将获得更强大的解决方案，否则您可能需要[pexpect 之](http://www.noah.org/wiki/pexpect)类的东西来帮助进行持续的自动化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-17T06:26:57.780

如果您希望在任何 sftp 命令失败时返回非零代码，则应将命令写入文件，然后对它们运行 sftp 批处理。以这种方式，您可以检索返回代码以检查 sftp 命令是否有任何故障。

这是一个简单的例子：

```
import subprocess

host="abc.com"
user="sa"

user_host="%s@%s" % (user, host)

execute_sftp_commands(['put hi.txt', 'put myfile.txt'])

def execute_sftp_commands(sftp_command_list):
    with open('batch.txt', 'w') as sftp_file:
        for sftp_command in sftp_command_list:
            sftp_file.write("%s\n" % sftp_command)
        sftp_file.write('quit\n')
    sftp_process = subprocess.Popen(['sftp', '-b', 'batch.txt', user_host], shell=False)
    sftp_process.communicate()
    if sftp_process.returncode != 0:
        print("sftp failed on one or more commands: {0}".format(sftp_command_list)) 
```

快速免责声明：我没有在 shell 中运行它，因此可能存在拼写错误。如果是这样，请给我评论，我会更正。

# jquery - 将 jQuery 文件上传添加到 Django Admin

> ID：10544826
> 
> 赞同：1
> 
> 时间：2012-05-11T02:57:09.270
> 
> 标签：jquery, django, file-upload, admin

[如果我可以将这个 jQuery 文件上传](http://blueimp.github.com/jQuery-File-Upload/)器添加到我的 Django 管理面板中，那就太棒了，但我是 Django 新手，我不确定从哪里开始。有人可以给我一些想法，并在这里为我指明正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T10:00:40.823

我认为这对你很有用。您可以将其嵌入到模板文件中，例如：

```
{% block extrahead %}{{ block.super }}
<script type="text/javascript" src="/static/js/admin/app/model/uploadjq.js"></script>
{% endblock %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-27T19:11:55.803

您可以通过下一个命令安装包 django-admin-multiupload，它会添加到 django admin 一个基于 jQuery File Upload 的表单：

```
pip install git+git://github.com/gkuhn1/django-admin-multiupload.git 
```

[或者只是从https://github.com/gkuhn1/django-admin-multiupload.git](https://github.com/gkuhn1/django-admin-multiupload.git)克隆到您的项目 中使用示例：

```
from django.contrib import admin
from django.shortcuts import get_object_or_404

from gallery.models import Gallery, Image

from multiupload.admin import MultiUploadAdmin

class ImageInlineAdmin(admin.TabularInline):
    model = Image

class GalleryMultiuploadMixing(object):

    def process_uploaded_file(self, uploaded, gallery, request):
        if gallery:
            image = gallery.images.create(file=uploaded)
        else:
            image = Image.objects.create(file=uploaded, gallery=None)
        return {
            'url': image.file.url,
            'thumbnail_url': image.file.url,
            'id': image.id,
            'name': image.filename
        }

class GalleryAdmin(GalleryMultiuploadMixing, MultiUploadAdmin):
    inlines = [ImageInlineAdmin,]
    multiupload_form = True
    multiupload_list = False

    def delete_file(self, pk, request):
        '''
        Delete an image.
        '''
        obj = get_object_or_404(Image, pk=pk)
        return obj.delete()

class ImageAdmin(GalleryMultiuploadMixing, MultiUploadAdmin):
    multiupload_form = False
    multiupload_list = True

admin.site.register(Gallery, GalleryAdmin)
admin.site.register(Image, ImageAdmin) 
```

Gallery 和 Image 模型在哪里：

```
from django.db import models

# Create your models here.

class Gallery(models.Model):
    class Meta:
        verbose_name_plural = 'Galleries'
    title = models.CharField('Title', max_length=20)

    def __str__(self):
        return self.title

class Image(models.Model):
    file = models.FileField('File', upload_to='images/')
    gallery = models.ForeignKey('Gallery', related_name='images', blank=True, null=True)

    def __str__(self):
        return self.filename

    @property
    def filename(self):
        return self.file.name.rsplit('/', 1)[-1] 
```

# java - 旋转图像（将其恢复到原始位置）

> ID：10544827
> 
> 赞同：2
> 
> 时间：2012-05-11T02:57:14.420
> 
> 标签：java, image, swing, rotation, paintcomponent

使用“仿射变换”我可以`imageA`轻松旋转。同样，`imageA`将与`imageB`. 但是，在我旋转它之后，我似乎无法找到一种方法来`imageA`回到原来的位置。

（我在一些网站上做了一些研究，显然最好的方法是将图像移回其原始位置，使其看起来像从锚点旋转。）

到目前为止，这是我的代码：

```
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    AffineTransform af = new AffineTransform();
    Graphics2D g2d = (Graphics2D) g;

    af.translate(imageBx, imageBy); // moves ImageA to imageb's position
    af.rotate(Math.toRadians(angle), imageB.getHeight(this) / 2, imageB.getWidth(this) / 2);

    g2d.drawImage(imageA, af, null);
    g2d.drawImage(imageB, imageBx, imageBy, null);
  } 
```

如果有人可以帮助我`imageA`回到原来的位置（就在 上`imageB`），那将非常有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T23:00:21.657

> 我看了一遍，但[代码](https://stackoverflow.com/a/3420651/230513)旋转了整个面板；我只想`Image`在一个固定的旋转点上旋转一个。

有两件事可能有助于指导您的理解：

*   引用的[示例](https://stackoverflow.com/a/3420651/230513)`rotate(double theta)`使用; 它之前是对原点*的**翻译*，然后是面板中心的翻译。请注意，这些操作的执行顺序与声明的顺序*明显*相反。您的示例（可能打算）调用`rotate(double theta, double anchorx, double anchory)`. 两者产生相同的结果，后者是前者的方便替代品。

*   此[示例](https://stackoverflow.com/a/5594424/230513)对比了如何转换图形上下文 (g2d) 或图像本身。您的示例调用`drawImage(Image img, AffineTransform xform, ImageObserver obs)`，它连接`xform`到现有的图形转换；这会影响所有后续绘图。将它们分开可能更容易。

# java - Spring Batch JobExecution 类的 getAllFailureExceptions() 和 getFailureExceptions() 方法有什么区别？

> ID：10544834
> 
> 赞同：2
> 
> 时间：2012-05-11T02:58:31.463
> 
> 标签：java, spring-batch

Spring Batch类的方法`getAllFailureExceptions()` 和方法有什么区别？什么是用于将作业异常记录到数据库的泛型的正确方法？`getFailureExceptions()``JobExecution``JobExecutionListener`

从我收集到的信息来看，一份工作只是一系列步骤的集合。那么获取失败异常不应该总是涉及从步骤中获取所有失败异常吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:07:03.900

看一下源码，貌似不同的是它包含了 StepExecutions 的失败异常

[spring-batch/spring-batch-core/src/main/java/org/springframework/batch/core/JobExecution.java](https://github.com/spring-projects/spring-batch/blob/master/spring-batch-core/src/main/java/org/springframework/batch/core/JobExecution.java)

# python - Python 模拟返回值

> ID：10544836
> 
> 赞同：2
> 
> 时间：2012-05-11T02:58:31.560
> 
> 标签：python, mocking

通常，在使用模拟时，我会有

```
from mock import Mock

m = Mock()
m
<Mock id='4334328720'> 
```

是否可以更改此输出？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T03:20:01.950

当然。您可以从 Mock 继承并更改`__repr__`方法：

```
from mock import Mock
class Mock2(Mock):
    def __repr__(self):
        return "Hello World!"

m = Mock2()

>> m
Hello World! 
```

您还可以像这样动态更改`__repr__`对象的方法：

```
from mock import Mock
m = Mock()

def new_repr(self):
    return "Hello dynamic Python!"
m.__repr__ = new_repr

>> m
Hello dynamic Python! 
```

# javascript - 使用 Javascript，我如何检测浏览器是在平板设备还是手机上运行？

> ID：10544843
> 
> 赞同：1
> 
> 时间：2012-05-11T02:58:52.290
> 
> 标签：javascript, browser, browser-detection

我有一个桌面、平板电脑和手机上的浏览器正在使用的 Web 应用程序。在平板电脑和桌面上使用的工具栏（用 HTML 制作）需要具有 16 x 16 的按钮，然后在手机上具有 48 x 48 的按钮。原因是 16 x 16 在台式机和平板电脑上是一个不错的尺寸，但在手机（iPhone 4/4s 等）上太小了。48 x 48 在台式机和平板电脑上太大了，但在我们测试过的手机上却完美。

如何使用 Javascript 对此进行必要的检测？

我想以英寸或毫米为单位检测物理屏幕尺寸将是一个不错的方法。这可以在浏览器中实现吗？我已经看到了一些关于以像素为单位检测屏幕分辨率的信息，但对我来说这似乎是有缺陷的，因为手机和平板电脑之间的分辨率界限正在模糊。

从浏览器内部检测平板电脑最可靠的方法是什么？

我们正在使用 iPad 2、Android 平板电脑和 Android 模拟器进行测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:09:31.987

CSS3 媒体查询非常适合识别设备宽度（即屏幕宽度），并且有一些有趣的技术可以使用 JavaScript 与它们挂钩，Jeremy Keith 一直在玩弄这些技术，他在他的日记中的[这篇文章中讨论了这些技术。](http://adactio.com/journal/5429/)一般的想法是，他在媒体查询中放置一个非渲染 css 规则，然后通过 JavaScript 检索该 css 值以确定哪个媒体查询有效。这确定了设备宽度范围，然后您可以从中得出关于您正在显示的设备类型的结论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T06:46:30.293

媒体查询解决方案是一个很好的解决方案，但如果您不想将 CSS 集成到解决方案中，并且如您的问题所述，使用 JS（仅），您应该能够使用 JavaScript 来检测设备是平板电脑还是平板电脑。 一部手机。这可以通过使用 window.orientation 结合屏幕宽度与高度的比率来检测默认方向来完成。

```
if (window.oriention == 0){            // this is the device's default orientation
    if (screen.width > screen.height) //means  default orientation is landscape
        isPhoneFormFactor = false;
} 
```

逻辑是宽度大于高度的设备的默认方向很可能是平板电脑而不是手机设备。

为了使其更加准确，您应该计算屏幕宽度与高度的比率并确保它超过某个阈值，以使假设更加准确，并允许您添加更多逻辑以使其更加准确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T00:04:49.500

最初我认为我需要知道 Web 应用程序运行在什么样的设备上，然后我继续认为我需要知道设备的物理屏幕尺寸。我现在认为实际上是**设备的 DPI 是相关的**。

在桌面显示器（通常远低于 150 DPI）或 iPad 2 (132 DPI) 等低分辨率设备上，16 x 16 按钮是一个不错的尺寸，但在高分辨率设备上，如具有视网膜显示屏的 iPhone ( 326 DPI），48 x 48 按钮更适合，因为 16 x6 16 显示得太小了。

使用[Modernizr](http://modernizr.com)`.mq()`及其运行媒体查询的功能，您可以使用 Javascript 代码确定设备的屏幕分辨率。

```
var isHighResolutionDisplay = Modernizr.mq("screen and (-webkit-min-device-pixel-ratio: 2), (min--moz-device-pixel-ratio: 2), (min-resolution: 250dpi)"); 
```

[此页面](http://en.wikipedia.org/wiki/List_of_displays_by_pixel_density)包含许多不同设备及其像素密度的大量列表。

# java - 我可以使用会话范围的 bean 而不是 httpsession 来维护会话吗

> ID：10544844
> 
> 赞同：0
> 
> 时间：2012-05-11T02:58:56.567
> 
> 标签：java, hibernate, javabeans, httpsession

我被这个问题困住了。我以前使用过httpsessions。但这一次，我在这两者之间做出了选择。会话范围的托管 bean 或 httpsession。

你有什么建议？请说明每个的优缺点。

感谢您的帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:47:05.720

这里有两个概念：
**HTTPSession 的案例**：假设您有一个名为的变量`var_one`，并且您希望`var_one`在跨多个托管 bean 的会话中访问（无论它们是否是会话范围），那么您需要使用 HTTPSession 来存储它多变的。

**Case Session Scoped Managed bean**：如果您只需要在一个特定的会话范围的托管 bean 中操作这个`var_one`变量，那么您可以直接将它保存在这个 bean 中并在整个会话中使用它。

# php - 如何从 php 中的数组中搜索 id / item？

> ID：10544851
> 
> 赞同：0
> 
> 时间：2012-05-11T03:00:18.590
> 
> 标签：php, mysql, arrays

我有`$_SESSION`一个物品的 id

例如我有这个项目

```
$_SESSION['items'] = array(1,4,5,7,8); 
```

我有一个来自数据库的数据

```
$query = mysql_query("SELECT * FROM items");

while($row =  mysql_fetch_array($query)){
   // Here in the loop; I want to Search 
   // $row['id'] if exist in $_SESSION['items']
   // if exist I want to display 'YES' else 'NO'
} 
```

如何为此做正确的代码？

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:04:05.960

使用`in_array` [http://sg2.php.net/in_array](http://sg2.php.net/in_array)

```
if(in_array($row['id'], $_SESSION['items'])) 
```

# uri - 为什么不允许更改用户名？

> ID：10544853
> 
> 赞同：2
> 
> 时间：2012-05-11T03:00:35.173
> 
> 标签：uri, search-engine, record

有几种服务允许频繁更改用户名`Twitter`，例如`LinkedIn`等。其他一些服务的选项非常有限（例如：`Facebook`两次）。休息不允许更改用户名。

我能理解的主要原因是，`records`与用户名保持一致，并且`URL`由搜索引擎针对用户名缓存。但是要解决第一个非常重要的问题，应用程序可以`userid`使用`username`.

是否有任何其他重要的问题/原因我应该考虑禁止更改用户名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:09:07.230

主要问题是社会工程学。人们将声誉与名称相关联（包括名称的用户以及与之交互的人）。如果您允许更改姓名，那么保持良好声誉和更多“不良行为”的社会压力就会减少。

这一切都是为了强迫用户将社会地位投入到持久的身份中。从技术上讲，他们可以实现一个支持名称更改的系统（例如，您可以使用任意的、唯一的、自动生成的 ID 来表示数据库/缓存/文件系统中的用户，并在以下情况下显示数据库中的一些（用户可修改的）字符串在网页中显示名称）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:13:06.813

一些网站不允许更改名称背后有技术原因，例如如果用户有能力存储文件，如果文件路径基于用户名，更改用户名可能会破坏它。但是，一个好的实现会使用用户 ID，并避免此类事情。在大多数情况下，保持用户名和帐户之间的永久链接是一个社会问题。赋予用户更改姓名的能力使其他用户能够冒充他们或窃取他们的名字，并且有时很难找到人。

我还想指出登录用户名和昵称之间存在差异。如果可以更改，您所说的“用户名”更是一个昵称，通常允许您“更改用户名”的网站只允许您更改显示名称 - 您的登录名保持不变。Steam 就是一个很好的例子，它允许您更改昵称，但您的登录名永远不会更改。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-07-08T05:54:58.020

我最近遇到了是否允许用户更改用户名的困境。

我已经在我的博客上输入了它：[http ://www.dizkover.com/post/423/programming-why-not-to-allow-users-to-change-username-in-social-web-application-design](http://www.dizkover.com/post/423/programming-why-not-to-allow-users-to-change-username-in-social-web-application-design)

# c# - process.start 从 ASP 页面，exe 文件放在哪里

> ID：10544854
> 
> 赞同：1
> 
> 时间：2012-05-11T03:00:39.747
> 
> 标签：c#, asp.net, .net

只是一个简单的问题，我应该将我试图在 ASP 项目中启动的 exe 放在哪里？它无法在 bin 文件夹中看到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T03:02:29.063

您需要将完整路径传递给`Process.Start`：

```
Process.Start(Server.MapPath("~/bin/whatever.exe")); 
```

但是，`~/bin/`适用于 .Net 程序集；通常最好将外部 EXE 放入`~/App_Data/`.

请注意，您只能在服务器上执行程序，而不能在客户端上执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T04:14:31.863

避免安全问题和多个进程并行运行。从asp页面我宁愿在某个表中排队请求进程启动，而不是让其他进程（如后台Windows服务）从队列中提取并执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T03:02:21.280

请记住，您的网站是在服务器上运行的，因此如果您对任何内容（ASP.Net 应用程序中的 Process.Start）进行外壳操作，它将在服务器上打开，而不是在客户端 PC 上打开。

确保您在生产环境中进行测试，并且当您在服务器上执行 shell 进程时（我不建议这样做），不要忘记关闭它们，否则您最终会在服务器上出现奇怪的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T03:08:27.957

```
Path.Combine(Server.MapPath(Request.ApplicationPath), "PathToExeFromWWWRoot"); 
```

# dom - 在 dojo.ready (dojo 1.7) 时填充 dojo 组合框

> ID：10544857
> 
> 赞同：0
> 
> 时间：2012-05-11T03:00:47.923
> 
> 标签：dom, combobox, dojo

我有一个组合框从 url 存储加载其数据。我的代码在下面...我在 Firebug 中注意到的是，一旦我将焦点放在 Combobox 上，它就会加载此信息。我希望在页面加载完成后填充组合框。我猜我使用 dojo.ready 了吗？有没有人建议我如何解决这个问题？非常感谢！珍妮

```
<!DOCTYPE html>
<html >
<head>

    <link rel="stylesheet" type="text/css" href="lib/dojo/dijit/themes/claro/claro.css" />
    <style type="text/css">html, body {
        width: 100%;
        height: 100%;
        margin: 0;
    }</style>
    <script src="lib/dojo/dojo/dojo.js" data-dojo-config="parseOnLoad: true"></script>
    <script>require(["dojo/ready", "dojo/data/ItemFileReadStore", "dijit/form/ComboBox"]); 

</script>

</head>
<body class="claro">
    <label for="user">User: </label>
<div dojoType="dojo.data.ItemFileReadStore" url="test.json" jsId="countryStore"> 
<input dojoType="dijit.form.ComboBox" searchAttr="last_name" store="countryStore" class="selectionNav tableData" value="" name="last_name" id="test.json" /> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T22:47:00.770

你的 require 函数应该是这样的

```
require(["dojo/ready", "dijit/registry", "dojo/data/ItemFileReadStore"],function(dom,reg,store){
    var combo = dijit.byId("test.json");
    var storeDate = new store({url:"path/to/file.json"});
    try{
        combo.store(storeData);
    }catch(e){
        combo.set("store",storeData)
    }
}); 
```

try catch 语句是因为我不记得哪个是正确的

# algorithm - 在 R 中用特定条件填充矩阵

> ID：10544858
> 
> 赞同：1
> 
> 时间：2012-05-11T03:00:54.100
> 
> 标签：algorithm, r

`M`给定一个大小为和的矩阵`N`，我们希望用整数值 (>=0) 填充每一行，使其总和为某个值。

请注意，`M`和的尺寸`N`是使用某些公式预先计算的，因此可以保证在给定所需条件（即`sum_val`以下）的情况下与填充相匹配。

这是两个例子

```
#sum_val <-2
#m<-6
#n<-3

# the value of "sum_val" may vary
# and 'm' 'n' also change depends on it

# First are initialized using 0
#mat <- matrix(0,nrow=m,ncol=n);

# Below results are hand coded:
       [,1] [,2] [,3]
[1,]    1    1    0   # Sum of each rows here is equal to 'sum_val = 2'
[2,]    1    0    1
[3,]    0    1    1
[4,]    2    0    0
[5,]    0    2    0
[6,]    0    0    2 
```

另一个例子：

```
> sum_val<-2;
#m<-15
#n<-5
#mat <- matrix(0,nrow=m,ncol=n);

# Below results are hand coded:
       [,1] [,2] [,3] [,4] [,5]
 [1,]    1    1    0    0    0   # rows also sums up to 2 
 [2,]    1    0    1    0    0
 [3,]    1    0    0    1    0
 [4,]    1    0    0    0    1
 [5,]    0    1    0    0    1
 [6,]    0    0    1    0    1
 [7,]    0    0    0    1    1
 [8,]    0    1    0    1    0
 [9,]    0    1    1    0    0
[10,]    0    0    1    1    0
[11,]    2    0    0    0    0
[12,]    0    2    0    0    0
[13,]    0    0    2    0    0
[14,]    0    0    0    2    0
[15,]    0    0    0    0    2 
```

我陷入了以下循环：

```
> for (ri in 1:m) {
+     for (ci in 1:n) {
+      
+        
+        # Not sure how to proceed from here
+        if(ci==2) {
+             mat[ri,ci] <- 1;
+        }
+     }
+ } 
```

解决它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T03:10:40.023

以下是我将如何解决它！

```
library(partitions)

sum_val <- 2
n <- 5

t(as.matrix(compositions(sum_val, n)))
      [,1] [,2] [,3] [,4] [,5]
 [1,]    2    0    0    0    0
 [2,]    1    1    0    0    0
 [3,]    0    2    0    0    0
 [4,]    1    0    1    0    0
 [5,]    0    1    1    0    0
 [6,]    0    0    2    0    0
 [7,]    1    0    0    1    0
 [8,]    0    1    0    1    0
 [9,]    0    0    1    1    0
[10,]    0    0    0    2    0
[11,]    1    0    0    0    1
[12,]    0    1    0    0    1
[13,]    0    0    1    0    1
[14,]    0    0    0    1    1
[15,]    0    0    0    0    2 
```

# php - 错误 310 (net::ERR_TOO_MANY_REDIRECTS)：

> ID：10544869
> 
> 赞同：10
> 
> 时间：2012-05-11T03:02:56.257
> 
> 标签：php, redirect

我没有在我的本地主机上收到此错误，只有当我上传到我的服务器时，此错误才会出现在我的一个页面上。知道我需要改变什么吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-11T03:21:27.240

我在网络浏览器中遇到了这个错误，其中我去的网页重定向到另一个无休止地重定向回原始网页的网页，我还遇到了编程错误不断重新加载或将页面重定向到自身的情况。

解决此类问题的方法是实际观察浏览器向服务器发出的请求。在出现此错误之前，您应该能够看到多个单独的请求。

您可以使用 Chrome 中开发人员工具的网络选项卡 (Ctrl+Shift+J) 或 firefox 中 Firebug 的网络标签查看浏览器发出的请求。我认为 IE9 在他们的开发人员工具（F12）中有一个网络工具，但我不记得了，我想不出足够好的理由打开 IE9 进行检查。但是，如果它没有网络工具，您可以安装免费版本的 HTTPWatch，它允许您观看浏览器发出的各个请求。

而且，如果这些都不起作用，您始终可以安装 Fiddler 或 WireShare，它们会嗅探浏览器发出的数据包和请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-18T10:10:49.190

localhost 和 web-servers 是您的文件的不同路径，因此您需要编辑 .htaccess 文件以获取实际的基本路径并将这行代码添加到其中

```
RewriteEngine On

# Some hosts may require you to use the `RewriteBase` directive.
# If you need to use the `RewriteBase` directive, it should be the
# absolute physical path to the directory that contains this htaccess file.
RewriteBase (your physical path)

....... 
```

这都是关于 .htaccess 错误

# iphone - 使用 Xcode3 和 iPhone 在同一网络上时 CPU 使用量很大

> ID：10544874
> 
> 赞同：1
> 
> 时间：2012-05-11T03:03:35.427
> 
> 标签：iphone, xcode, cpu, wireless, debug-symbols

Xcode4 有良好的意图，但在敏捷性方面无法击败 Xcode3。我发现自己时不时地回到 Xcode3，但有一个问题使这几乎不可能。每当我有我的 iPhone 时，Xcode3 都会尝试以无线方式连接到它，这会消耗大量的 CPU（在几分钟内使整个计算机停止运行）。到目前为止，我发现的唯一解决方案是将 iPhone 置于飞行模式。

有谁知道如何完全禁用这种无线通信，以便我可以正常使用 Xcode3？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T09:42:13.063

我安装了[TCPBlock（捐赠软件）](http://tcpblock.wordpress.com/)并通过 usbmuxd 阻止了所有流量，到目前为止，使用 Xcode 3 没有更多问题。

1.  安装 TCPBlock
2.  启动 xcode 并等待 usbmuxd 出现在“正在连接的应用程序”选项卡中并将其添加到
3.  封锁名单
4.  使用 Xcode3 没有问题。
5.  如果您需要 usbmuxd，请在下班后禁用 TCPBlock

# python - 在 Python 中使用 BeautifulSoup 从 HTML 中删除回车

> ID：10544877
> 
> 赞同：2
> 
> 时间：2012-05-11T03:04:23.477
> 
> 标签：python, beautifulsoup

我正在从网页解析数据，有时这些表格有不必要的回车，这给我带来了问题。我想删除回车，但一个简单的 strip() 不起作用。

我有以下代码：

```
html = """
<table>
<tr>
<td>
Commercial, financial and agricultural</td>
<td>
791
</td>
</tr>
</table>
"""

soup = BeautifulSoup(''.join(html))
table = soup.find('table')

rows = table.findAll('tr')
for tr in rows:
    rowdata = ''
    columns = tr.findAll('td')
    for td in columns:
        cell = ''.join(td.findAll(text=True))
        cell.strip()
        rowdata = rowdata+'|'+cell
    print rowdata 
```

输出是：

```
|
Commercial, financial and agricultural|
791 
```

我希望输出为：|商业、金融和农业|791

为什么 strip 函数不删除回车符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T03:10:49.240

```
>>> cell = 'text\n'
>>> cell.strip()
'text'
>>> rowdata = '|' + cell
>>> print rowdata
|text

>>> rowdata = '|' + cell.strip()
>>> print rowdata
|text 
```

Strip 正在删除返回值，但 strip 返回一个值。它不会将单元格设置为等于任何值。试试`rowdata = rowdata + '|' + cell.strip()`。

# php - 对大型正则表达式使用惰性求值（而不仅仅是 .*？）

> ID：10544882
> 
> 赞同：1
> 
> 时间：2012-05-11T03:05:42.253
> 
> 标签：php, regex, reluctant-quantifiers

使用以下正则表达式：

```
\[\w* \w* \d{2} [\w:]* \d{4}\] \[error\] \[client .*?\] .*? Using HTTP not .*?<br /> 
```

我得到以下结果（黄色框表示匹配）：

![崇高的文字 2](../Images/668392c5e1d53d073e351506ee97d6fb.png)

*原始文本： http:* [//pastebin.com/vSi0mLGv](http://pastebin.com/vSi0mLGv)

下面两段是正确的。我想要包含以下内容的所有部分：`&lt;&lt;&lt;NOTICE&gt;&gt;&gt; Non-Prod Server: Using HTTP not HTTP/S`

然而，顶部包含正确的字符串（类似于底部两个），但还带有我不想要的另一个块：

```
[Thu May 10 17:43:48 2012] [error] [client ::1] Current Name:
DashboardBar_projAnnualReview200, referer: http://
localhost/test/pages/TestPage.php<br />` 
```

我知道这归结为正则表达式是贪婪的，但是`<br />`如果这甚至是正确的方法，我怎样才能让它对 进行懒惰的评估。我试过`(<br />)*?`了，其他人都无济于事。

* * *

其他信息：我正在使用[Sublime Text 2](http://www.sublimetext.com/2)，如果有人想重新创建图像，则执行正则表达式搜索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T03:36:11.230

贪婪不是问题，*渴望*才是。正则表达式引擎在最早的机会开始尝试匹配，并且在用尽所有可能性之前它不会放弃。使量词不贪婪并不会改变这一点，它只会改变尝试可能性的顺序。

导致您的问题的不是`*`in `.*`，而是`.`. 你需要使用更严格的东西，因为它会让比赛过早开始。这个正则表达式可以按需要工作，因为我已经替换了`.*?`with `[^][]*`，它匹配除`]`or之外的任何字符`[`：

```
\[\w* \w* \d{2} [\w:]* \d{4}\] \[error\] \[client [^][]*\] [^][]* Using HTTP not .*?<br /> 
```

我不知道 SublimeText 使用什么正则表达式风格，因此您可能需要转义字符类中的方括号：

```
\[\w* \w* \d{2} [\w:]* \d{4}\] \[error\] \[client [^\]\[]*\] [^\]\[]* Using HTTP not .*?<br /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T03:22:52.287

你的意思是“不情愿”，而不是“懒惰”。

应该没有干预`<br />`吧？类似的东西`((?!<br />).)*`可能会起作用。

# asp.net-mvc-3 - 将输入文本从视图传递到控制器

> ID：10544885
> 
> 赞同：1
> 
> 时间：2012-05-11T03:06:00.577
> 
> 标签：asp.net-mvc-3, view, controller

我知道有很多这样的问题，但我真的无法得到答案的解释......这是我的观点......

```
<script type="text/javascript" language="javascript">
$(function () {
    $(".datepicker").datepicker({ onSelect: function (dateText, inst) { },
        altField: ".alternate"
    });

});
</script>

@model IEnumerable<CormanReservation.Models.Reservation>
@{
ViewBag.Title = "Index";
}

<h5>
    Select a date and see reservations...</h5>
<div>
    <div class="datepicker">
    </div>
    &nbsp;<input name="dateInput" type="text" class="alternate" />
</div> 
```

我想获取输入文本的值...我的输入文本中已经有一个值，因为日期选择器将其值传递给它...我不能做的是将它传递给我的控制器...这是我的控制器：

```
 private CormantReservationEntities db = new CormantReservationEntities();
    public ActionResult Index(string dateInput )
    {
        DateTime date = Convert.ToDateTime(dateInput);
        var reservations = db.Reservations.Where(r=>r.Date==date).Include(r => r.Employee).Include(r => r.Room).OrderByDescending(r => r.Date);
        return View(reservations.ToList());
    } 
```

我试图在我的主页中列出用户在我主页的日历中选择的日期期间所做的预订......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:29:25.250

我在您的视图中没有看到表单标签...或者您没有显示整个视图？很难说..但要发布到您的控制器，您应该通过 ajax 调用将值发送到控制器或发布模型。在您的情况下，您的模型是一个`IEnumerable<CormanReservation.Models.Reservation>`并且您的输入是一个日期选择器，并且看起来它没有绑定到您的 ViewModel。您在什么时候将日期发布回服务器？您是否有带有提交按钮的表单，或者您是否有未显示的 ajax 调用？

这是一个 Ajax 请求的示例，可以调用它来传递您的日期

```
$(function () {
    $(".datepicker").onselect(function{
          searchByDate();
        })
    });

});

function searchbyDate() {
   var myDate = document.getElementById("myDatePicker");

    $.ajax({
        url: "/Home/Search/",
        dataType: "json",
        cache: false,
        type: 'POST', 
        data: { dateInput: myDate.value },
        success: function (result) {
            if(result.Success) {
               // do something with result.Data which is your list of returned records
            }
        }
    });
} 
```

您的日期选择器控件需要一些东西来引用它

```
<input id="myDatePicker" name="dateInput" type="text" class="alternate" /> 
```

您的操作可能看起来像这样

```
private CormantReservationEntities db = new CormantReservationEntities();

public JsonResult Search(string dateInput) {
    DateTime date = Convert.ToDateTime(dateInput);
    var reservations = db.Reservations.Where(r=>r.Date==date).Include(r => r.Employee).Include(r => r.Room).OrderByDescending(r => r.Date);
    return View(reservations.ToList());
    return Json(new {Success = true, Data = reservations.ToList()}, JsonRequestBehaviour.AllowGet());
} 
```

**更新**

如果您想让它成为发布数据并返回视图的标准帖子，那么您需要进行与此类似的更改。

**创建一个视图模型**

```
public class ReservationSearchViewModel {
    public List<Reservation> Reservations { get; set; }
    public DateTime SelectedDate { get; set; }
} 
```

**修改您的控制器操作以最初加载页面，然后能够发布数据返回视图返回数据**

```
public ActionResult Index() {
    var model = new ReservationSearchViewModel();
    model.reservations = new List<Reservation>();
    return View(model);
}

[HttpPost]
public ActionResult Index(ReservationSearchViewModel model) {
    if(ModelState.IsValid)    
    var reservations = db.Reservations.Where(r => r.Date = model.SelectedDate).Include(r => r.Employee).Include(r => r.Room).OrderByDescending(r => r.Date);
    }
    return View(model)
} 
```

**修改您的视图，以便您有一个表单可以发布到 Index HttpPost 操作**

```
@model CormanReservation.Models.ReservationSearchViewModel

<h5>Select a date and see reservations...</h5>
@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    @Html.EditorFor(model => model.SelectedDate)
    @Html.EditorFor(model => model.Reservations) // this may need to change to a table or grid to accomodate your data
    <input type="submit" value="Search" />
} 
```

# objective-c - 旋转 CGImage

> ID：10544887
> 
> 赞同：15
> 
> 时间：2012-05-11T03:06:02.450
> 
> 标签：objective-c, ios, uiimage, cgimage

我有一个从 UIImagePickerController 获取的 UIImage。当我从`- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info`方法中接收到图像时，我将其直接放入 UIImageView 中进行预览，并为用户提供保存或丢弃图像的选项。

![预览画面](../Images/3eef031d57b01a7d1071e7bef6fe3a9e.png)

当用户选择保存选项时，应用程序获取图像的 png 数据并将其保存到它的文档目录。但是在两种可能的设备方向之一（仅限横向）下发生的情况是图像被颠倒保存（更具体地说，从它应该的位置旋转 180 度）。因此，当我在图库中加载图像时，它看起来是颠倒的。

（见画廊左下角的图片）

![见左下图](../Images/4a9002c4bdb73892b9c6458fb939df3b.png)

我已经解决了这个问题，即 UIImagePickerController 中的 UIImage 中的原始图像数据不会旋转，而是将方向存储为对象的属性，并且仅在显示时应用。所以我试图使用我在网上找到的一些代码来旋转与 UIImage 关联的 CGImage 。但它似乎对图像完全没有影响。我正在使用的代码如下：

```
- (void)rotateImage:(UIImage*)image byRadians:(CGFloat)rads
{   
    // calculate the size of the rotated view's containing box for our drawing space 
    UIView *rotatedViewBox = [[UIView alloc] initWithFrame:CGRectMake(0,0,image.size.width, image.size.height)];
    CGAffineTransform t = CGAffineTransformMakeRotation(rads);
    rotatedViewBox.transform = t;
    CGSize rotatedSize = rotatedViewBox.frame.size;

    // Create the bitmap context
    UIGraphicsBeginImageContext(rotatedSize);
    CGContextRef bitmap = UIGraphicsGetCurrentContext();

    // Move the origin to the middle of the image you want to rotate and scale around the center. 
    CGContextTranslateCTM(bitmap, rotatedSize.width/2, rotatedSize.height/2); 

    // Rotate the image context
    CGContextRotateCTM(bitmap, rads);

    // Now, draw the rotated/scaled image into the context
    CGContextScaleCTM(bitmap, 1.0, -1.0);
    CGContextDrawImage(bitmap, CGRectMake(image.size.width / 2, image.size.height / 2, image.size.width, image.size.height), [image CGImage]);

    image = UIGraphicsGetImageFromCurrentImageContext();
    image = [UIImage imageWithCGImage:image.CGImage scale:1.0 orientation:UIImageOrientationDown];
    UIGraphicsEndImageContext();
} 
```

我想知道为什么这段代码不起作用，因为我在网上找到的每段代码都可以做这个图像旋转似乎不起作用。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-11T08:58:22.937

```
-(UIImage*) rotate:(UIImage*) src andOrientation:(UIImageOrientation)orientation
{
    UIGraphicsBeginImageContext(src.size);

    CGContextRef context=(UIGraphicsGetCurrentContext());

    if (orientation == UIImageOrientationRight) {
        CGContextRotateCTM (context, 90/180*M_PI) ;
    } else if (orientation == UIImageOrientationLeft) {
        CGContextRotateCTM (context, -90/180*M_PI);
    } else if (orientation == UIImageOrientationDown) {
        // NOTHING
    } else if (orientation == UIImageOrientationUp) {
        CGContextRotateCTM (context, 90/180*M_PI);
    }

    [src drawAtPoint:CGPointMake(0, 0)];
    UIImage *img=UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return img;

} 
```

use this one .. it works perfect ! Just make sure you use this function when you are picking images from UIImagePicker:

example:

```
UIImage *image;
image = [self rotate:image andOrientation:image.imageOrientation]; 
```

Make sure to use this function in place where you pick photos from documents directory.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-01-01T12:41:26.377

## 旋转和镜像 UIImage CGImage 支持数据 - Swift

我最近想更正由 a`UIImage`支持的 a`CGImage`以匹配所需的方向，而不是依赖 API 来尊重 UIImageOrientation 参数。

```
func createMatchingBackingDataWithImage(imageRef: CGImage?, orienation: UIImageOrientation) -> CGImage?
{
    var orientedImage: CGImage?

    if let imageRef = imageRef {
        let originalWidth = imageRef.width
        let originalHeight = imageRef.height
        let bitsPerComponent = imageRef.bitsPerComponent
        let bytesPerRow = imageRef.bytesPerRow

        let bitmapInfo = imageRef.bitmapInfo

        guard let colorSpace = imageRef.colorSpace else {
            return nil
        }

        var degreesToRotate: Double
        var swapWidthHeight: Bool
        var mirrored: Bool
        switch orienation {
        case .up:
            degreesToRotate = 0.0
            swapWidthHeight = false
            mirrored = false
            break
        case .upMirrored:
            degreesToRotate = 0.0
            swapWidthHeight = false
            mirrored = true
            break
        case .right:
            degreesToRotate = 90.0
            swapWidthHeight = true
            mirrored = false
            break
        case .rightMirrored:
            degreesToRotate = 90.0
            swapWidthHeight = true
            mirrored = true
            break
        case .down:
            degreesToRotate = 180.0
            swapWidthHeight = false
            mirrored = false
            break
        case .downMirrored:
            degreesToRotate = 180.0
            swapWidthHeight = false
            mirrored = true
            break
        case .left:
            degreesToRotate = -90.0
            swapWidthHeight = true
            mirrored = false
            break
        case .leftMirrored:
            degreesToRotate = -90.0
            swapWidthHeight = true
            mirrored = true
            break
        }
        let radians = degreesToRotate * Double.pi / 180.0

        var width: Int
        var height: Int
        if swapWidthHeight {
            width = originalHeight
            height = originalWidth
        } else {
            width = originalWidth
            height = originalHeight
        }

        let contextRef = CGContext(data: nil, width: width, height: height, bitsPerComponent: bitsPerComponent, bytesPerRow: bytesPerRow, space: colorSpace, bitmapInfo: bitmapInfo.rawValue)
        contextRef?.translateBy(x: CGFloat(width) / 2.0, y: CGFloat(height) / 2.0)
        if mirrored {
            contextRef?.scaleBy(x: -1.0, y: 1.0)
        }
        contextRef?.rotate(by: CGFloat(radians))
        if swapWidthHeight {
            contextRef?.translateBy(x: -CGFloat(height) / 2.0, y: -CGFloat(width) / 2.0)
        } else {
            contextRef?.translateBy(x: -CGFloat(width) / 2.0, y: -CGFloat(height) / 2.0)
        }
        contextRef?.draw(imageRef, in: CGRect(x: 0.0, y: 0.0, width: CGFloat(originalWidth), height: CGFloat(originalHeight)))
        orientedImage = contextRef?.makeImage()
    }

    return orientedImage
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-11T10:38:49.543

I got your problem.You have to translate back the context using `CGContextTranslateCTM(context, -rotatedSize.width/2, -rotatedSize.height/2);` as well as set origin of rect in drawing to rotatedViewBox.frame.origin.x,rotatedViewBox.frame.origin.y. use this code.

```
UIView *rotatedViewBox = [[UIView alloc] initWithFrame:CGRectMake(0,0,image.size.width, image.size.height)];
CGAffineTransform t = CGAffineTransformMakeRotation(0.3);
rotatedViewBox.transform = t;
CGSize rotatedSize = rotatedViewBox.frame.size;

UIGraphicsBeginImageContext(rotatedSize);

CGContextRef context = UIGraphicsGetCurrentContext();
CGContextTranslateCTM(context, rotatedSize.width/2, rotatedSize.height/2);
CGContextRotateCTM (context, 0.3);
CGContextScaleCTM(context, 1, -1);
CGContextTranslateCTM(context, -rotatedSize.width/2, -rotatedSize.height/2);

CGContextDrawImage(context, CGRectMake(-rotatedViewBox.frame.origin.x, -rotatedViewBox.frame.origin.y, image.size.width, image.size.height), [image CGImage]);

UIImage *nn = UIGraphicsGetImageFromCurrentImageContext();

NSLog(@"size is %f, %f",nn.size.width,nn.size.height);
UIGraphicsEndImageContext();

UIImageWriteToSavedPhotosAlbum(nn, nil,nil,nil); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-20T23:24:37.287

Cameron Lowell Palmer的**Swift 3**版本[回答](https://stackoverflow.com/a/27730890/6282606)：

```
func createMatchingBackingDataWithImage(imageRef: CGImage?, orienation: UIImageOrientation) -> CGImage? {
    var orientedImage: CGImage?

    if let imageRef = imageRef {
        let originalWidth = imageRef.width
        let originalHeight = imageRef.height
        let bitsPerComponent = imageRef.bitsPerComponent
        let bytesPerRow = imageRef.bytesPerRow

        let colorSpace = imageRef.colorSpace
        let bitmapInfo = imageRef.bitmapInfo

        var degreesToRotate: Double
        var swapWidthHeight: Bool
        var mirrored: Bool
        switch orienation {
        case .up:
            degreesToRotate = 0.0
            swapWidthHeight = false
            mirrored = false
            break
        case .upMirrored:
            degreesToRotate = 0.0
            swapWidthHeight = false
            mirrored = true
            break
        case .right:
            degreesToRotate = 90.0
            swapWidthHeight = true
            mirrored = false
            break
        case .rightMirrored:
            degreesToRotate = 90.0
            swapWidthHeight = true
            mirrored = true
            break
        case .down:
            degreesToRotate = 180.0
            swapWidthHeight = false
            mirrored = false
            break
        case .downMirrored:
            degreesToRotate = 180.0
            swapWidthHeight = false
            mirrored = true
            break
        case .left:
            degreesToRotate = -90.0
            swapWidthHeight = true
            mirrored = false
            break
        case .leftMirrored:
            degreesToRotate = -90.0
            swapWidthHeight = true
            mirrored = true
            break
        }
        let radians = degreesToRotate * Double.pi / 180

        var width: Int
        var height: Int
        if swapWidthHeight {
            width = originalHeight
            height = originalWidth
        } else {
            width = originalWidth
            height = originalHeight
        }

        if let contextRef = CGContext(data: nil, width: width, height: height, bitsPerComponent: bitsPerComponent, bytesPerRow: bytesPerRow, space: colorSpace!, bitmapInfo: bitmapInfo.rawValue) {

            contextRef.translateBy(x: CGFloat(width) / 2.0, y: CGFloat(height) / 2.0)
            if mirrored {
                contextRef.scaleBy(x: -1.0, y: 1.0)
            }
            contextRef.rotate(by: CGFloat(radians))
            if swapWidthHeight {
                contextRef.translateBy(x: -CGFloat(height) / 2.0, y: -CGFloat(width) / 2.0)
            } else {
                contextRef.translateBy(x: -CGFloat(width) / 2.0, y: -CGFloat(height) / 2.0)
            }
            contextRef.draw(imageRef, in: CGRect(x: 0, y: 0, width: originalWidth, height: originalHeight))

            orientedImage = contextRef.makeImage()
        }
    }

    return orientedImage
} 
```

用法：

```
let newCgImage = createMatchingBackingDataWithImage(imageRef: cgImageRef, orienation: .left) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-14T08:04:03.677

这只是对先前答案的重构。

```
func correctImageOrientation(cgImage: CGImage?, orienation: UIImage.Orientation) -> CGImage? {
    guard let cgImage = cgImage else { return nil }
    var orientedImage: CGImage?

    let originalWidth = cgImage.width
    let originalHeight = cgImage.height
    let bitsPerComponent = cgImage.bitsPerComponent
    let bytesPerRow = cgImage.bytesPerRow
    let bitmapInfo = cgImage.bitmapInfo

    guard let colorSpace = cgImage.colorSpace else { return nil }

    let degreesToRotate = orienation.getDegree()
    let mirrored = orienation.isMirror()

    var width = originalWidth
    var height = originalHeight

    let radians = degreesToRotate * Double.pi / 180.0
    let swapWidthHeight = Int(degreesToRotate / 90) % 2 != 0

    if swapWidthHeight {
        swap(&width, &height)
    }

    let context = CGContext(data: nil, width: width, height: height, bitsPerComponent: bitsPerComponent, bytesPerRow: bytesPerRow, space: colorSpace, bitmapInfo: bitmapInfo.rawValue)

    context?.translateBy(x: CGFloat(width) / 2.0, y: CGFloat(height) / 2.0)
    if mirrored {
        context?.scaleBy(x: -1.0, y: 1.0)
    }
    context?.rotate(by: CGFloat(radians))
    if swapWidthHeight {
        swap(&width, &height)
    }
    context?.translateBy(x: -CGFloat(width) / 2.0, y: -CGFloat(height) / 2.0)

    context?.draw(cgImage, in: CGRect(x: 0.0, y: 0.0, width: CGFloat(originalWidth), height: CGFloat(originalHeight)))
    orientedImage = context?.makeImage()

    return orientedImage
}

extension UIImage.Orientation {
    func getDegree() -> Double {
        switch self {
        case .up, .upMirrored:
            return 0.0
        case .right, .rightMirrored:
            return 90.0
        case .down, .downMirrored:
            return 180.0
        case .left, .leftMirrored:
            return -90.0
        default:
            return 0
        }
    }

    func isMirror() -> Bool {
        switch self {
        case .up, .right, .down, .left:
            return false
        case .leftMirrored, .upMirrored, .downMirrored, .rightMirrored:
            return true
        default:
            return false
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-06-17T22:58:45.603

所有这些答案的问题在于它们具有 UIKit 依赖项。我正在开发面向 iOS 和 macOS 的 SwiftUI 通用应用程序。[Cameron Lowell Palmer](https://stackoverflow.com/questions/10544887/rotating-a-cgimage/27730890#27730890)的答案经过了一些修改：

1.  bytesPerRow 计算需要*在*交换高度和宽度之后进行，否则 CGImageContext 抱怨不正确的 bytesPerRow

2.  将 UIImageOrientation 更改为 CGImagePropertyOrientation，并交换左右旋转的符号

这是我的版本，适用于 iOS 和 macOS：

```
extension CGImage {
func rotating(to orientation: CGImagePropertyOrientation) -> CGImage? {
    var orientedImage: CGImage?

    let originalWidth = self.width
    let originalHeight = self.height
    let bitsPerComponent = self.bitsPerComponent
    let bitmapInfo = self.bitmapInfo

    guard let colorSpace = self.colorSpace else {
        return nil
    }

    var degreesToRotate: Double
    var swapWidthHeight: Bool
    var mirrored: Bool

    switch orientation {
    case .up:
        degreesToRotate = 0.0
        swapWidthHeight = false
        mirrored = false
        break
    case .upMirrored:
        degreesToRotate = 0.0
        swapWidthHeight = false
        mirrored = true
        break
    case .right:
        degreesToRotate = -90.0
        swapWidthHeight = true
        mirrored = false
        break
    case .rightMirrored:
        degreesToRotate = -90.0
        swapWidthHeight = true
        mirrored = true
        break
    case .down:
        degreesToRotate = 180.0
        swapWidthHeight = false
        mirrored = false
        break
    case .downMirrored:
        degreesToRotate = 180.0
        swapWidthHeight = false
        mirrored = true
        break
    case .left:
        degreesToRotate = 90.0
        swapWidthHeight = true
        mirrored = false
        break
    case .leftMirrored:
        degreesToRotate = 90.0
        swapWidthHeight = true
        mirrored = true
        break
    }

    let radians = degreesToRotate * Double.pi / 180.0

    var width: Int
    var height: Int

    if swapWidthHeight {
        width = originalHeight
        height = originalWidth
    } else {
        width = originalWidth
        height = originalHeight
    }

    let bytesPerRow = (width * bitsPerPixel) / 8

    let contextRef = CGContext(data: nil, width: width, height: height, bitsPerComponent: bitsPerComponent, bytesPerRow: bytesPerRow, space: colorSpace, bitmapInfo: bitmapInfo.rawValue)

    contextRef?.translateBy(x: CGFloat(width) / 2.0, y: CGFloat(height) / 2.0)

    if mirrored {
        contextRef?.scaleBy(x: -1.0, y: 1.0)
    }

    contextRef?.rotate(by: CGFloat(radians))

    if swapWidthHeight {
        contextRef?.translateBy(x: -CGFloat(height) / 2.0, y: -CGFloat(width) / 2.0)
    } else {
        contextRef?.translateBy(x: -CGFloat(width) / 2.0, y: -CGFloat(height) / 2.0)
    }

    contextRef?.draw(self, in: CGRect(x: 0.0, y: 0.0, width: CGFloat(originalWidth), height: CGFloat(originalHeight)))

    orientedImage = contextRef?.makeImage()

    return orientedImage
} 
```

}

# android - Eclipse 似乎不喜欢我的 sdkversion 要求

> ID：10544888
> 
> 赞同：0
> 
> 时间：2012-05-11T03:06:03.147
> 
> 标签：android, android-manifest, android-2.2-froyo

我的清单中有：

```
<uses-sdk android:minSdkVersion="8" 
                android:targetSdkVersion="13"/> 
```

我想允许 2.2 运行我的应用程序，但我必须有 targetsdkversion 13 才能使 admob 工作。但是 eclipse 说：“属性 minSdkVersion (8) 低于项目目标 API 级别 (13)”，甚至不会显示低于 3.2 的任何 avd ......但这直到不久前才发生。我在那里没有改变任何东西。发生了什么？我试过清理它，但没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T04:02:38.897

这只是一个警告。如果您运行您的应用程序，它应该可以在 SDK 版本 8 到 13 的任何设备上运行。您无法生成 apk 并运行它吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:05:08.357

我曾经在旧版本的 eclipse 和 ADT 中看到警告，但自从迁移到 Indigo 和更新的 android 插件后，我不再明白这一点，这很烦人，但没有引起任何其他问题。

# jquery - jquery验证引擎中的条件验证

> ID：10544892
> 
> 赞同：3
> 
> 时间：2012-05-11T03:06:31.197
> 
> 标签：jquery, validation, jquery-validation-engine

我有一个复选框和一个文本框。我要求，如果勾选了复选框，则文本框变为必填项。反之亦然，如果文本框已填满，则复选框变为必填项。

所以样本是

项目名称 - 复选框 - 到期日期 项目名称 2 - 复选框 2 - 到期日期 2

使用查询从数组中的数据库获取数据。

我的代码看起来像

```
<script type="text/javascript"> 
$(document).ready(function(){
    $("#sea").validationEngine();
   });

function industry(field, rules, i, options) {    
var atLeastOneIsChecked = $('input[name="extraqualification[]"]:checked').length > 0;
if (atLeastOneIsChecked == 1 )        {
if(document.getElementById('extraqualificationexpirydate<?php echo $extraqual['Id']?>').value=='')
{
   return "Please supply a certificate expiry";
}else{} }
    } </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T12:36:46.990

您需要有条件的必需验证。您可以使用如下`condRequired`方法：

```
<input value="" type="text" name="test" id="test" />
<input class="validate[condRequired[test]]" type="text" id="test_2" name="test_2"/> 
```

另外，请确保您使用的是 2.6 或更高版本。

# c# - 如何将报告 PDF 文件保存到我的本地文件夹

> ID：10544893
> 
> 赞同：0
> 
> 时间：2012-05-11T03:06:35.173
> 
> 标签：c#, reporting-services

如何使用 c# 编码将 pdf 文件保存在本地文件夹中？这个程序在命令提示符下运行，所以我只写了一个代码来将参数传递给我在报告服务器中的报告 nw 报告将以 pdf 格式发送，我想将它保存在我的本地文件夹中并访问这个文件以发送电子邮件之后。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T05:48:06.100

我在这里遗漏了很多信息：这是您下载的程序吗？还是这是您自己编写的程序？还是你还没写？

我猜是最后一个 您需要编写一个接受参数的控制台应用程序，然后使用 PDF 生成器工具生成您的 PDF。我猜您正在尝试读取一些数据以生成报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T09:45:56.140

由于缺乏代表，无法将此添加为评论，因此作为答案。

您可以直接将 SSRS 服务器输出保存为 PDF 格式。我假设使用 Report Viewer 控件对您的应用程序来说是不可能的。这样就可以直接通过它提供的 Web 服务访问报表服务器。有关不错的入门解决方案，请参阅此问题提供的答案。

[报告服务：获取生成报告的 PDF](https://stackoverflow.com/questions/10898999/reporting-services-get-the-pdf-of-a-generated-report)

根据您的描述，您需要将保存的 PDF 从下载文件夹复制到最终目的地。

希望有帮助。

# jquery - 将查询字符串添加到 Ajax url 调用

> ID：10544895
> 
> 赞同：4
> 
> 时间：2012-05-11T03:06:38.370
> 
> 标签：jquery, ajax, url

我想知道当我们调用 Jquery Ajax 时是否可以将查询字符串与 URL 一起传递；

例子 ：

```
 $.ajax({
           type: "POST",
           url: "index.php?task=addNewInfo",
           data: $('#regForm').serialize(),
           dataType: "json",
              .....
      }); 
```

那么 param 任务中的查询字符串可以正常工作吗？或者我们需要以另一种方式来做？谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T03:45:34.940

在data参数中发送任务

```
data:"task=addNewInfo&" + $('#regForm').serialize() 
```

这是为了使用 POST 方法。如果您想使用 GET 方法，那么 Arun 的解决方案可以正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T03:39:57.830

我认为以下将正常工作

```
url : "index.php?task=addNewInfo&" + $('#regForm').serialize() 
```

但是为什么要将表单值作为查询参数传递呢？无论如何，发布请求都会将值作为请求参数传递。这些参数将通过请求正文发送，这就是您使用`POST`请求类型的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-04T12:41:09.460

是的。查询字符串和请求正文在 HTTP 请求中是两个不同的东西。jQuery 将数据包装在 GET 请求的查询字符串中，这可能是混淆的根源

*   GET 请求：正文（或有效负载）为空，只有 url 保存数据。
*   POST 请求：根据需要填充正文，可以使用 url-encoding 像你一样，也可以使用 json-encoding

# c# - 如何在 Windows 安全对话框中获取枚举证书列表

> ID：10544897
> 
> 赞同：0
> 
> 时间：2012-05-11T03:06:44.503
> 
> 标签：c#, winapi, windows-7, automation, ui-automation

我正在尝试自动化测试，该测试涉及通过智能卡对网站进行身份验证。

我正在使用 c#，Windows 7。

当我启动 url 时，会出现一个`windows security`窗口，要求我从可用证书列表中选择一个证书。

我发现不可能想出一种方法来以编程方式遍历安全对话框中列出的证书列表。我只需要遍历列表并继续阅读列出的证书的友好名称，直到找到与我所需证书匹配的证书。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T23:55:20.950

```
AutomationElementCollection windows =  AutomationElement.RootElement.FindAll(TreeScope.Descendants, new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Window));
        foreach (AutomationElement window in windows)
        {
            if (window.Current.ClassName.Equals("#32770"))   //security dialog
            {
                AutomationElementCollection certs = window.FindAll(TreeScope.Descendants, new PropertyCondition(AutomationElement.ControlTypeProperty,ControlType.ListItem));
                foreach (AutomationElement cert in certs)
                {
                    Console.WriteLine(cert.Current.Name);
                }
            }
        } 
```

# javascript - Javascript 方法 pause() 仅适用于音频元素

> ID：10544900
> 
> 赞同：0
> 
> 时间：2012-05-11T03:07:04.113
> 
> 标签：javascript, jquery, html, audio

所以我有这样的功能：

```
function music(song) {
var audio = new Audio("audio/" + song + ".ogg");
audio.play();
} 
```

我遇到的问题是 audio.play() 工作得很好，但是如果我稍后尝试 audio.pause() （在定义相同的变量之后），它就不起作用了。但是，如果我这样做：

```
function music() {
var audio = document.getElementById("songname");
audio.play();
} 
```

然后我可以定义变量，然后使用 audio.pause() 暂停音轨。问题是我想在 javascript 中执行此操作，因为我有很多曲目，我不想为每个曲目创建音频元素。

为什么第一段代码不允许我稍后暂停音频？有什么办法可以让它稍后暂停音频吗？如果没有，是否有任何替代方法涉及通过传递作为歌曲标题的参数从 javascript 播放音频？我不想在 html 中包含 src。

我怀疑 jQuery 可能有一个简单的解决方案，但形成我研究过的我找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:12:35.577

`audio`只存在于函数内部。如果您需要在函数之外访问它，则返回`Audio`您正在创建的对象的实例：

```
function getAudio(song, play) {
var audio = new Audio("audio/" + song + ".ogg");
  if(play) {
    audio.play();
  }

  return audio;
}

var theTrack = getAudio('my_song', true);
theTrack.pause(); // pause the song
theTrack.play();  // play the song 
```

第二个例子是指我假设是一个音频元素，它反过来暴露了`Audio`对象的功能。第二个函数可以在任何地方工作的原因是因为 DOM 元素始终存在于 DOM 中，并且您引用它来获取底层音频 API，而不是直接使用音频对象/API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:12:51.333

我刚刚测试了一个片段，它就是这样工作的

```
function music(song) {

    var audio = new Audio("audio/" + song + ".ogg");
    audio.play();
    setTimeout(function() { audio.pause(); }, 5000);

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-30T14:06:40.447

您可以在定义函数之前创建音频变量。

```
var audio = new Audio();
function playMusic(song) {
  audio.src = "audio/" + song + ".ogg";
  audio.play();
}
function pauseMusic() {
  audio.pause();
} 
```

# gwt - 如何在 GWT 应用程序中实现 i18n？

> ID：10544901
> 
> 赞同：7
> 
> 时间：2012-05-11T03:07:16.380
> 
> 标签：gwt, internationalization, gwt2, uibinder

我有国际化的问题。我正在尝试在我的 GWT 应用程序中实现对两种语言的支持。不幸的是，我从来没有找到一个完整的例子，如何在 UiBinder 的帮助下做到这一点。这就是我所做的：

我的模块**I18nexample.gwt.xml**：

```
<?xml version="1.0" encoding="UTF-8"?>
<module rename-to='i18nexample'>
<inherits name="com.google.gwt.user.User" />
<inherits name='com.google.gwt.user.theme.clean.Clean' />
<inherits name="com.google.gwt.i18n.I18N" />
<inherits name="com.google.gwt.i18n.CldrLocales" />
<entry-point class='com.myexample.i18nexample.client.ExampleI18N' />
<servlet path="/start" class="com.myexample.i18nexample.server.StartServiceImpl" />
    <extend-property name="locale" values="en, fr" />
    <set-property-fallback name="locale" value="en" />
</module> 
```

我的界面**Message.java**：

```
package com.myexample.i18nexample.client;

import com.google.gwt.i18n.client.Constants;

public interface Message extends Constants {

    String greeting();
} 
```

同一个包`com.myexample.i18nexample.client`有三个属性文件：

**消息属性**：

```
greeting = hello 
```

**Message_en.properties**：

```
greeting = hello 
```

**Message_fr.properties**：

```
greeting = bonjour 
```

我的 UiBinder 文件**Greeting.ui.xml**：

```
<!DOCTYPE ui:UiBinder SYSTEM "http://dl.google.com/gwt/DTD/xhtml.ent">
<ui:UiBinder 
    xmlns:ui="urn:ui:com.google.gwt.uibinder"
    xmlns:g="urn:import:com.google.gwt.user.client.ui"
    ui:generateFormat="com.google.gwt.i18n.rebind.format.PropertiesFormat"
    ui:generateKeys="com.google.gwt.i18n.rebind.keygen.MD5KeyGenerator"
    ui:generateLocales="default" >
    <ui:with type="com.myexample.i18nexample.client.Message" field="string" />
    <g:HTMLPanel>   
        <ui:msg key="greeting" description="greeting">Default greeting</ui:msg>     
    </g:HTMLPanel>
</ui:UiBinder> 
```

当应用程序启动时，我总是在浏览器中得到输出：

```
Default greeting 
```

为什么？我究竟做错了什么？

我尝试从不同的 URL 运行应用程序：

```
http://127.0.0.1:8888/i18nexample.html?gwt.codesvr=127.0.0.1:9997

http://127.0.0.1:8888/i18nexample.html?locale=en&gwt.codesvr=127.0.0.1:9997

http://127.0.0.1:8888/i18nexample.html?locale=fr&gwt.codesvr=127.0.0.1:9997 
```

结果不变。尽管我希望在最后一种情况下会收到一条消息`bonjour`。

例如，如果我使用 a`g:Buttton`而不是消息`ui:msg`：

```
<g:HTMLPanel>   
     <g:Button text="{string.greeting}" />      
</g:HTMLPanel> 
```

然后我得到了带有文本的按钮的结果`"hello"`

如果我输入网址：

```
http://127.0.0.1:8888/i18nexample.html?locale=fr&gwt.codesvr=127.0.0.1:9997 
```

按钮上的文字变为`"bonjour"`。在这里一切都按预期工作。但是为什么国际化在我的第一个案例中不起作用？

以及以下是否有区别：

```
<ui:msg description="greeting">Default greeting</ui:msg>

<ui:msg description="greeting">hello</ui:msg>

<ui:msg description="greeting"></ui:msg> 
```

在这些情况下应该有不同的结果吗？如何正确书写？

请向我解释 GWT 中的国际化原则以及为什么我的示例不起作用。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T09:16:34.293

首先，文件应该命名为`Message_fr.properties`(resp. `Message_en.properties`)，而不是`Message.properties_fr`(resp. `Message.properties_en`)。

然后`ui:msg`等人。在 UiBinder 中将**生成**一个接口（扩展`com.google.gwt.i18n.client.Messages`）），而不是使用您定义的接口。为此，您必须使用`{string.greeting}`（您在哪里`string`给`ui:field`您的`ui:with`）。UiBinder 生成器将对你`GWT.create()`的`type`类做一个`ui:with`，这就是你在 Java 代码中所做的：

```
Message string = GWT.create(Message.class);
String localizedGreeting = string.greeting(); 
```

在隐式Messages接口中（由UiBinder生成），其`ui:generateXxx`上的各种属性`ui:UiBinder`都会转化为接口上的[`@Generate`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/i18n/client/LocalizableResource.Generate.html)注解（注解的属性，或者注解的值[`@GenerateKeys`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/i18n/client/LocalizableResource.GenerateKeys.html)）。
然后，将为每个 生成一个方法`ui:msg`，其中属性生成等效注释（`@Key`，`@Description`），`ui:msg`元素的内容是`@DefaultMessage`注释的值。当您在内容中拥有或小部件时，它们将被转换为`@DefaultMessage`文本中的方法和占位符的参数（值将由 UiBinder 填充）。

我建议你先在没有 UiBinder 的情况下制作一些东西，然后了解它是*如何*工作的；然后尝试`ui:msg`在 UiBinder 中，`-gen`在 DevMode 或编译器中使用，这样您就可以确切地看到 UiBinder 生成了哪些代码（是的，它实际上只生成您可以自己手动编写的代码）。

此外，您应该添加一个，`<set-property name="locale" value="en, fr" />`否则您仍然可以使用`default`语言环境，尽管`set-property-fallback`（它永远不会被使用））。

# android - 如何在 Android 中自动接受 Wi-Fi Direct 连接请求

> ID：10544906
> 
> 赞同：11
> 
> 时间：2012-05-11T03:07:49.530
> 
> 标签：android, wifi-direct, wifip2p

我有 2 台使用 WiFi Direct 的 Android 设备。在一台设备上，我可以使用该类获取有关另一台设备的信息`WifiP2pManager`，并请求连接到另一台设备。但是，当我请求连接时，另一台设备会弹出一个小窗口并询问用户是否要接受连接请求。

是否可以自动接受这些连接请求？IE无需用户确认即可连接到其他设备？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-05T06:57:15.357

它可以在[Xposed 框架](https://github.com/rovo89/XposedBridge/wiki/Development-tutorial)的帮助下轻松完成。您只需要替换其中一个 android java 类中的单个方法（请参阅 snihalani 答案中的链接）。当然，要使用 Xposed，您的设备必须是 root 的。主要思想可以用以下代码表达（使用Xposed）

```
@Override
public void handleLoadPackage(LoadPackageParam lpparam) {
    try {
        Class<?> wifiP2pService = Class.forName("android.net.wifi.p2p.WifiP2pService", false, lpparam.classLoader);
        for (Class<?> c : wifiP2pService.getDeclaredClasses()) {
            //XposedBridge.log("inner class " + c.getSimpleName());
            if ("P2pStateMachine".equals(c.getSimpleName())) {
                XposedBridge.log("Class " + c.getName() + " found");
                Method notifyInvitationReceived = c.getDeclaredMethod("notifyInvitationReceived");
                final Method sendMessage = c.getMethod("sendMessage", int.class);

                XposedBridge.hookMethod(notifyInvitationReceived, new XC_MethodReplacement() {
                    @Override
                    protected Object replaceHookedMethod(MethodHookParam param) throws Throwable {
                        final int PEER_CONNECTION_USER_ACCEPT = 0x00023000 + 2;
                        sendMessage.invoke(param.thisObject, PEER_CONNECTION_USER_ACCEPT);
                        return null;
                    }
                });

                break;
            }
        }
    } catch (Throwable t) {
        XposedBridge.log(t);
    }
} 
```

我在 SGS4 stock 4.2.2 ROM 上对其进行了测试，它工作正常。我想同样可以在[Substrate](http://www.cydiasubstrate.com/) for android 的帮助下完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-12T11:13:55.890

根据我目前对 API 的理解，如果没有用户的干预，您无法真正自动接受连接。您可以发起连接，无需用户干预。如果您的两台设备都是移动设备，则您必须在一端接受连接请求。

我已将此作为 android 项目托管中的功能请求。您可以在此处监控他们的回复：[https ://code.google.com/p/android/issues/detail?id=30880](https://code.google.com/p/android/issues/detail?id=30880)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T08:32:06.217

根据评论，如果您只想跟踪和记录您周围的车辆，您真的需要连接到设备吗？

我不知道该项目的范围，但您可以简单地使用在[WifiP2pManager](http://developer.android.com/reference/android/net/wifi/p2p/WifiP2pDeviceList.html)中[请求对等方时获得的 WifiP2pDeviceList](http://developer.android.com/reference/android/net/wifi/p2p/WifiP2pManager.html#requestPeers%28android.net.wifi.p2p.WifiP2pManager.Channel,%20android.net.wifi.p2p.WifiP2pManager.PeerListListener%29)。您可以获取您周围的设备（~= 车辆）列表并记录下来。

如果您想发送更详细的信息，我猜连接很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-13T10:36:32.877

如果可以修改框架，可以忽略接受窗口，直接发送“PEER_CONNECTION_USER_ACCEPT”。

基于Android 5.0，“frameworks/opt/net/wifi/service/java/com/android/server/wifi/p2p/WifiP2pServiceImpl.java”。

您必须找到“notifyInvitationReceived”，并修改为...

```
private void notifyInvitationReceived() {
    /*Direct sends the accept message.*/
    sendMessage(PEER_CONNECTION_USER_ACCEPT);
/*
... old code
*/
} 
```

# java - AWT（扩展）修饰符何时保证有效？

> ID：10544909
> 
> 赞同：3
> 
> 时间：2012-05-11T03:08:22.840
> 
> 标签：java, swing, awt, mouseevent

我正在将 AWT 事件（`mouse_pressed`、`mouse_released`、`key_pressed`、`key_released`等）记录到日志中，以便在单元测试中使用 Robot 重播它们。但我发现有时我需要在`mouse_released`事件丢失时插入事件，因为我的一些组件会自行移除，`mouse_pressed`因此`mouse_released`永远不会调度。我认为一个好的方法是`mouse_released`每当看到一个具有`modifiersEx`=的鼠标事件`Button1`后跟一个具有`modifiersEx`= 0 的事件时插入，除非第二个事件已经是 mouse_released。但是我在使用`JComboBox`.

这是一个简单的 main 函数，其中包含一个`JComboBox`在其下的组件，该组件也接收鼠标事件。

![带有 JComboBox 的窗口截图](../Images/141595ec7ac7065e276b72d53e1227ac.png)

```
import java.awt.AWTEvent;
import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.Toolkit;
import java.awt.event.AWTEventListener;
import java.awt.event.InputEvent;
import java.util.logging.Logger;

import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class DemoEvents {
    public static void main(String[] argv) {
        JFrame jframe = new JFrame("Test events");
        jframe.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        Container contentPane = jframe.getContentPane();
        contentPane.setLayout(new BorderLayout());
        JComboBox jcomboBox = new JComboBox(new String[]{"one", "two", "three"});
        JButton jbutton = new JButton("Hello");
        JPanel outerPanel = new JPanel();
        JPanel innerPanel = new JPanel();
        innerPanel.setLayout(new BoxLayout(innerPanel, BoxLayout.PAGE_AXIS));
        innerPanel.add(jcomboBox);
        innerPanel.add(jbutton);
        outerPanel.add(innerPanel);
        contentPane.add(outerPanel, BorderLayout.CENTER);
        jframe.setSize(200, 200);
        jframe.setVisible(true);

        long mask =
            AWTEvent.MOUSE_EVENT_MASK |
            AWTEvent.MOUSE_WHEEL_EVENT_MASK |
            AWTEvent.MOUSE_MOTION_EVENT_MASK;

        final Logger logger = Logger.getLogger("awt-events");
        Toolkit.getDefaultToolkit().addAWTEventListener(new AWTEventListener() {
            @Override
            public void eventDispatched(AWTEvent event) {
                InputEvent ev = (InputEvent)event;
                logger.info(ev.toString());
            }
        }, mask);
    }
} 
```

当单击`JComboBox`并单击项目“一”时，我得到了这些事件。with extModifiers `mouse_entered`=Button1 没有意义，因为它是**在**`mouse_released event`! 这是我单击组合框然后单击第一项时的简化日志。查看底部加粗的事件：

1.  MouseEvent[MOUSE_PRESSED,(1,13),button=1,modifiers=Button1,extModifiers=Button1,clickCount=1] 在 MetalComboBoxButton[...]
2.  MouseEvent[MOUSE_RELEASED,(1,13),button=1,modifiers=Button1,clickCount=1] on MetalComboBoxButton[...]
3.  MouseEvent[MOUSE_MOVED,(0,14),button=0,clickCount=0] 在 MetalComboBoxButton[...]
4.  MouseEvent[MOUSE_EXITED,(-2,15),button=0,clickCount=0] 在 MetalComboBoxButton[...]
5.  MouseEvent[MOUSE_ENTERED,(81,15),button=0,clickCount=0] 在 JComboBox[...]
6.  MouseEvent[MOUSE_MOVED,(81,15),button=0,clickCount=0] 在 JComboBox[...]
7.  （更多动作）
8.  MouseEvent[MOUSE_EXITED,(69,24),button=0,clickCount=0] 在 JComboBox[...]
9.  ComboPopup.popup 上的 MouseEvent[MOUSE_ENTERED,(69,0),button=0,clickCount=0]
10.  ComboPopup.popup 上的 MouseEvent[MOUSE_MOVED,(69,0),button=0,clickCount=0]
11.  ComboPopup.popup 上的 MouseEvent[MOUSE_EXITED,(68,2),button=0,clickCount=0]
12.  ComboBox.list 上的 MouseEvent[MOUSE_ENTERED,(67,1),button=0,clickCount=0]
13.  ComboBox.list 上的 MouseEvent[MOUSE_MOVED,(67,1),button=0,clickCount=0]
14.  （更多动作）
15.  MouseEvent[MOUSE_PRESSED,(57,9),button=1,modifiers=Button1,extModifiers=Button1,clickCount=1] 在 ComboBox.list
16.  ComboBox.list 上的 MouseEvent[MOUSE_RELEASED,(57,9),button=1,modifiers=Button1,clickCount=1]
17.  MouseEvent[MOUSE_ENTERED,(25,10),button=1,modifiers=Button1, **extModifiers=Button1** ,clickCount=1] 在 JButton[...]
18.  MouseEvent[MOUSE_MOVED,(26,10),button=0,clickCount=0] 在 JButton[...]

问题：什么时候`mouse_pressed`/的顺序`mouse_released`与其他鼠标事件的修饰符不一致？是否只有`mouse_entered`/`mouse_exited`事件发生在修饰符不一致的情况下？这仅在单击`JComboBox`弹出窗口时发生吗？

我在 Ubuntu 上运行 Java 1.6。

编辑：为清楚起见，包括更长的日志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T15:48:22.383

在我的平台上，“单击`JComboBox`并单击*第一*项”会产生如下所示的事件。

结果可能取决于`com.apple.laf.AquaComboBoxButton`平台的`ComboBoxUI`委托。我无法解释`MOUSE_CLICKED`你的结果中没有。点击后我没有移动鼠标`JComboBox`；看来您做到了，并且记录了该结果。

请注意，“[扩展修饰符](http://docs.oracle.com/javase/6/docs/api/java/awt/event/InputEvent.html#getModifiersEx%28%29)表示事件发生*后*所有模态键的状态，例如`ALT`, `CTRL`,`META`和鼠标按钮”，因此在某些事件上的存在似乎并不矛盾。我没有看到任何表明事件包含任何修饰符的信息。*`extModifiers`[`MOUSE_MOVED`](http://docs.oracle.com/javase/6/docs/api/java/awt/event/MouseEvent.html)*

 *我不知道潜在问题的解决方案，除了重新检查对合成`MOUSE_RELEASED`事件的需求。[作为替代方案，您可以通过检查包含层次结构](https://stackoverflow.com/a/10542850/230513)来验证组件是否已删除。

```
2012 年 5 月 11 日 10:36:36 AM DemoEvents$1 eventDispatched
信息：java.awt.event.MouseEvent[MOUSE_PRESSED,(85,9),absolute(124,58),button=1,modifiers=Button1,extModifiers=Button1,clickCount=1] on com.apple.laf.AquaComboBoxButton[ …]
2012 年 5 月 11 日 10:36:36 AM DemoEvents$1 eventDispatched
信息：com.apple.laf.AquaComboBoxButton[...] 上的 java.awt.event.MouseEvent[MOUSE_RELEASED,(85,9),absolute(124,58),button=1,modifiers=Button1,clickCount=1]
2012 年 5 月 11 日 10:36:36 AM DemoEvents$1 eventDispatched
信息：com.apple.laf.AquaComboBoxButton[...] 上的 java.awt.event.MouseEvent[MOUSE_CLICKED,(85,9),absolute(124,58),button=1,modifiers=Button1,clickCount=1]
2012 年 5 月 11 日 10:36:38 AM DemoEvents$1 eventDispatched
信息：ComboBox.list 上的 java.awt.event.MouseEvent[MOUSE_ENTERED,(91,6),absolute(124,58),button=1,modifiers=Button1,extModifiers=Button1,clickCount=1]
2012 年 5 月 11 日 10:36:38 AM DemoEvents$1 eventDispatched
信息：ComboBox.list 上的 java.awt.event.MouseEvent[MOUSE_PRESSED,(91,6),absolute(124,58),button=1,modifiers=Button1,extModifiers=Button1,clickCount=1]
2012 年 5 月 11 日 10:36:38 AM DemoEvents$1 eventDispatched
信息：ComboBox.list 上的 java.awt.event.MouseEvent[MOUSE_RELEASED,(91,6),absolute(124,58),button=1,modifiers=Button1,clickCount=1]

```*

# javascript - 基于时区重定向用户

> ID：10544915
> 
> 赞同：3
> 
> 时间：2012-05-11T03:09:38.683
> 
> 标签：javascript, redirect, timezone

我想知道是否有办法使用 JavaScript 根据用户的时区重定向用户？

例如，如果时区介于 gmt-12 和 gmt-8 之间，则重定向到 page1.htm。

我正在查看 getTimezoneOffset() 但我不知道如何根据结果重定向。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:13:50.740

你可以使用[`window.location`](https://developer.mozilla.org/en/DOM/window.location)：

```
var date = new Date(),
    offset = date.getTimezoneOffset();

if (offset <= 720 && offset >= 960) {
  window.location.href = 'page1.htm';
} 
```

# facebook - Facebook 弃用了分享功能……但它自己在使用它？

> ID：10544918
> 
> 赞同：1
> 
> 时间：2012-05-11T03:09:45.273
> 
> 标签：facebook, facebook-javascript-sdk

众所周知（[http://developers.facebook.com/docs/share/）Facebook](http://developers.facebook.com/docs/share/)已经弃用了分享功能。然而，即将上线的应用中心显然使用的是相同的共享 UI。

![应用中心](../Images/5772afd41eec5bc88a203479245c124d.png)

普通人有没有办法从 Facebook 提供的 JS SDK 访问相同的 UI？假设它与[https://developers.facebook.com/docs/share/](https://developers.facebook.com/docs/share/)中描述的不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:46:25.030

尽管它已被弃用，但您仍然可以按照以前使用的方式使用它。 [Facebook 分享文档](https://developers.facebook.com/docs/share/)

但是，使用它不是一个好主意。相反，您可以创建一个 facebook 应用程序并使用 FB.ui 来执行此操作：

示例代码：

```
<script>
      FB.init({appId: "<your_app_id>", status: truey, cookie: true});

      function postToFeed() {

       FB.ui({
          method: 'feed',
          link: '<the_link>',
          name: '<name>',
          caption: '<caption>',
          description: '<description>'
        });

      }   

   </script> 
```

# node.js - 为现代 Web 应用推荐 Node.js 技术堆栈/架构？

> ID：10544922
> 
> 赞同：2
> 
> 时间：2012-05-11T03:10:04.773
> 
> 标签：node.js

谁能指出我需要在 Node.js 中学习哪些技术/架构才能构建基于图片和位置的 Web 应用程序？（有点像 twitter+foursquare 的网格）

从我阅读的内容来看，以下内容被认为很受欢迎，我需要全部学习吗？我在图片中还缺少什么吗？

*   操作系统 = Ubuntu、Gentoo 或 Debian
*   数据库 = [MongoDB](http://www.mongodb.org)
*   模板=[玉](http://jade-lang.com)
*   css =[手写笔](http://learnboost.github.com/stylus/)
*   框架=[快递](http://expressjs.com/)
*   代码=[咖啡脚本](http://www.coffeescript.org/)
*   网络 = [socket.io](http://www.socket.io/)
*   mcv 结构 = [Backbone.js](http://documentcloud.github.com/backbone/)
*   身份验证 =[护照](http://www.passportjs.org/)
*   ide = [Sublime Text 2](http://www.sublimetext.com/2)或[WebStorm](http://www.jetbrains.com/webstorm/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:13:44.110

听起来不错。

您还可以为 CSS 预处理和护照 npm 包添加手写笔，以简化您的身份验证过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T04:06:29.723

您可能还想查看这些基于 node.js 的框架（都是用 coffescript 编写的）

*   TowerJS（模仿 Ruby on Rails）
    *   主页：[http ://towerjs.org/](http://towerjs.org/)
    *   来源：[https ://github.com/viatropos/tower](https://github.com/viatropos/tower)
*   王牌（模仿辛纳屈）
    *   来源[https://github.com/maccman/ace](https://github.com/maccman/ace)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:13:50.000

我建议查看[Flatiron 框架](http://flatironjs.com)- 它分为几个模块，您可以挑选自己喜欢的模块。路由模块[Union](http://github.com/flatiron/union)向后兼容 Connect/Express。

# python - Python：在循环中的 try-finally 语句中使用 continue

> ID：10544928
> 
> 赞同：28
> 
> 时间：2012-05-11T03:11:15.937
> 
> 标签：python, continue, try-finally

将以下代码：

```
while True:
    try:
        print("waiting for 10 seconds...")
        continue
        print("never show this")
    finally:
        time.sleep(10) 
```

总是打印消息“等待 10 秒……”，休眠 10 秒，然后再做一次？换句话说，`finally`即使循环被`continue`-ed，子句中的语句也会运行吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-11T03:15:36.197

来自[python 文档](http://docs.python.org/reference/compound_stmts.html#finally)：

当在 try...finally 语句的 try 套件中执行 return、break 或 continue 语句时，finally 子句也在“退出时”执行。finally 子句中的 continue 语句是非法的。（原因是当前实现存在问题——未来可能会取消此限制）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-10-12T22:52:52.790

该文档使用稍微不清楚的语言（“在路上”）来解释这种情况是如何发生的。如果在异常子句中执行 continue 语句，则 finally 子句中的代码将被执行，然后循环将继续进行下一次迭代。

这是一个非常清晰的示例，演示了该行为。

代码：

```
i=0
while i<5:
    try:
        assert(i!=3) #Raises an AssertionError if i==3
        print("i={0}".format(i))
    except:
        continue
    finally:
        i+= 1; #Increment i

'''
Output:

i=0
i=1
i=2
i=4
''' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-23T16:21:35.560

现在从最新版本的 python (3.8.4) 开始，可以在“finally”块中使用“continue”。[在此处输入图像描述](https://i.stack.imgur.com/RHf7x.png)

# opencv - SVM 的链接器错误 OpenCV

> ID：10544931
> 
> 赞同：0
> 
> 时间：2012-05-11T03:11:44.720
> 
> 标签：opencv, linker, svm

我的代码似乎有链接器问题。

代码是：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <assert.h>
#include <math.h>
#include <float.h>
#include <limits.h>
#include <time.h>
#include <ctype.h>
#include <iostream>
#include <vector>

#include "opencv/ml.h"
#include "opencv/cvaux.h"
#include "opencv/highgui.h"
#include "opencv/cxcore.h"
#include "opencv/cv.h"
#include "opencv/highgui.h"

using namespace cv;
int main (int argc, char* argv[])
{
// Data for visual representation
    int width = 512, height = 512;
    Mat image = Mat::zeros(height, width, CV_8UC3);

    // Set up training data
    float labels[4] = {1.0, -1.0, -1.0, -1.0};
    Mat labelsMat(3, 1, CV_32FC1, labels);

    float trainingData[4][2] = { {501, 10}, {255, 10}, {501, 255}, {10, 501} };
    Mat trainingDataMat(3, 2, CV_32FC1, trainingData);

    // Set up SVM's parameters
    CvSVMParams params;
    params.svm_type    = CvSVM::C_SVC;
    params.kernel_type = CvSVM::LINEAR;
    params.term_crit   = cvTermCriteria(CV_TERMCRIT_ITER, 100, 1e-6);

    // Train the SVM
    CvSVM SVM;
    SVM.train(trainingDataMat, labelsMat, Mat(), Mat(), params);

    Vec3b green(0,255,0), blue (255,0,0);
    // Show the decision regions given by the SVM
    for (int i = 0; i < image.rows; ++i)
        for (int j = 0; j < image.cols; ++j)
        {
            Mat sampleMat = (Mat_<float>(1,2) << i,j);
            float response = SVM.predict(sampleMat);

            if (response == 1)
                image.at<Vec3b>(j, i)  = green;
            else if (response == -1) 
                 image.at<Vec3b>(j, i)  = blue;
        }

    // Show the training data
    int thickness = -1;
    int lineType = 8;
    circle( image, Point(501,  10), 5, Scalar(  0,   0,   0), thickness, lineType);
    circle( image, Point(255,  10), 5, Scalar(255, 255, 255), thickness, lineType);
    circle( image, Point(501, 255), 5, Scalar(255, 255, 255), thickness, lineType);
    circle( image, Point( 10, 501), 5, Scalar(255, 255, 255), thickness, lineType);

    // Show support vectors
    thickness = 2;
    lineType  = 8;
    int c     = SVM.get_support_vector_count();

    for (int i = 0; i < c; ++i)
    {
        const float* v = SVM.get_support_vector(i);
        circle( image,  Point( (int) v[0], (int) v[1]),   6,  Scalar(128, 128, 128), thickness, lineType);
    }

    imwrite("result.png", image);        // save the image 

    imshow("SVM Simple Example", image); // show it to the user
    waitKey(0);
return EXIT_SUCCESS;
} 
```

这是错误报告：

> 2>SVM.obj：错误 LNK2019：无法解析的外部符号“public: void __thiscall cv::Mat::deallocate(void)”(?deallocate@Mat@cv@@QAEXXZ) 在函数“public: void __thiscall cv:: Mat::release(void)" (?release@Mat@cv@@QAEXXZ) 2>SVM.obj : error LNK2019: unresolved external symbol "public: void __thiscall cv::MatConstIterator::seek(int,bool)" ( ?seek@MatConstIterator@cv@@QAEXH_N@Z) 在函数“public: class cv::MatConstIterator & __thiscall cv::MatConstIterator::operator++(void)”中引用 (??EMatConstIterator@cv@@QAEAAV01@XZ) 2> SVM.obj：错误 LNK2019：未解析的外部符号“public：void __thiscall cv::Mat::copySize(class cv::Mat const &)”(?copySize@Mat@cv@@QAEXABV12@@Z) 在函数中引用“公共：__thiscall cv::Mat::Mat(类 cv::Mat const &)" (??0Mat@cv@@QAE@ABV01@@Z) 2>SVM.obj : error LNK2019: unresolved external symbol "void __cdecl cv::fastFree(void *)" (?fastFree@cv@ @YAXPAX@Z) 在函数 "public: __thiscall cv::Mat::~Mat(void)" (??1Mat@cv@@QAE@XZ) 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号 "public : void __thiscall cv::Mat::create(int,int const *,int)" (?create@Mat@cv@@QAEXHPBHH@Z) 在函数“public: void __thiscall cv::Mat::create(int ,int,int)" (?create@Mat@cv@@QAEXHHH@Z) 2>SVM.obj : error LNK2019: unresolved external symbol "public: void __thiscall cv::MatConstIterator::seek(int const *,bool) " (?seek@MatConstIterator@cv@@QAEXPBH_N@Z) 在函数 "public: __thiscall cv::MatConstIterator::MatConstIterator(class cv::Mat const *)" (??0MatConstIterator@cv@@QAE@PBVMat@1@@Z) 2>SVM.obj : 错误 LNK2019: 无法解析的外部符号 "public: void __thiscall cv::Mat::convertTo(class cv: :_OutputArray const &,int,double,double)const " (?convertTo@Mat@cv@@QBEXABV_OutputArray@2@HNN@Z) 在函数 "public: class cv::Mat_ & _ 中引用*thiscall cv::Mat* ::operator=(class cv::Mat const &)" (??4?$Mat_@M@cv@@QAEAAV01@ABVMat@1@@Z) 2>SVM.obj : 错误 LNK2019:未解析的外部符号“public: __thiscall cv::_OutputArray::_OutputArray(class cv::Mat &)” (??0_OutputArray@cv@@QAE@AAVMat@1@@Z) 在函数“public: class cv::”中引用Mat_ & _ *thiscall cv::Mat* ::operator=(class cv::Mat const &)" (??4?$Mat_@M@cv@@QAEAAV01@ABVMat@1@@Z) 2>SVM.obj :错误 LNK2019：未解析的外部符号“公共：类 cv::Mat __thiscall cv::Mat::reshape(int,int,int const *)const” (?reshape@Mat@cv@@QBE?AV12@HHPBH@Z)在函数“public：class cv::Mat_ & _ *thiscall cv::Mat ”中引用*::operator=(class cv::Mat const &)" (??4?$Mat_@M@cv@@QAEAAV01@ABVMat@1@@Z) 2>SVM.obj : error LNK2019: unresolved external symbol "public : virtual __thiscall CvSVM::~CvSVM(void)" (??1CvSVM@@UAE@XZ) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号“int __cdecl cv::waitKey(int)”（ ?waitKey@cv@@YAHH@Z) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号“void __cdecl cv::imshow(class std::basic_string,class std::allocator > const &,class cv::_InputArray const &)" (?imshow@cv@@YAXABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@ABV_InputArray@1@@Z)在函数 _main 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号“bool __cdecl cv::imwrite(class std::basic_string,类 std::allocator > const &,类 cv::_InputArray const &,类 std::vector > const &)" (?imwrite@cv@@YA_NABV?$basic_string@DU?$char_traits@D@std@@V ?$allocator@D@2@@std@@ABV_InputArray@1@ABV?$vector@HV?$allocator@H@std@@@3@@Z) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：函数 _main 2>SVM.obj 中引用的未解析外部符号“public: __thiscall cv::_InputArray::_InputArray(class cv::Mat const &)”(??0_InputArray@cv@@QAE@ABVMat@1@@Z) : 错误 LNK2019: 未解析的外部符号“public: virtual float const * __thiscall CvSVM::get_support_vector(int)const” (?get_support_vector@CvSVM@@UBEPBMH@Z) 在函数 _main 2>SVM.obj 中引用： 错误 LNK2019: 未解析的外部符号“公共：虚拟 int __thiscall CvSVM::get_support_vector_count(void)const " (?get_support_vector_count@CvSVM@@UBEHXZ) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号“void _*cdecl cv::circle(class cv::Mat &,class cv::Point*,int,class cv::Scalar_ const &,int,int,int)" (?circle@cv@@YAXAAVMat@1@V?$Point_@H@1@HABV?$Scalar_@N@1@HHH@Z ) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号“公共：虚拟浮点 __thiscall CvSVM::predict(class cv::Mat const &,bool)const” (?predict@CvSVM@@UBEMABVMat@cv @@_N@Z) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：无法解析的外部符号“public: virtual bool __thiscall CvSVM::train(class cv::Mat const &,class cv::Mat const &,class cv::Mat const &,class cv::Mat const &,struct CvSVMParams)" (?train@CvSVM@@UAE_NABVMat@cv@@000UCvSVMParams@@@Z) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号“public: __thiscall CvSVM::CvSVM(void)”(??0CvSVM@@QAE@XZ) 在函数 _main 2>SVM.obj 中引用：错误 LNK2019：未解析的外部符号“public: __thiscall CvSVMParams::CvSVMParams(void)”(??0CvSVMParams@@QAE@XZ) 在中引用函数 _main 2>SVM.obj：错误 LNK2019：未解析的外部符号“公共：静态类 cv::MatExpr __cdecl cv::Mat::zeros(int,int,int)”(?zeros@Mat@cv@@SA? AVMatExpr@2@HHH@Z) 在函数 _main 中引用

我有适用于 Windows 7 的 OpenCV 的最后一个完整版本，可在 WillowGarage 获得，我正在尝试从 wiki 页面运行此示例：[link](http://opencv.itseez.com/doc/tutorials/ml/introduction_to_svm/introduction_to_svm.html)。我的编译器是VC++。

我已经在 Google 上搜索过，但没有发现任何工作。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T15:09:31.010

对于那些有同样问题的人，请确保您拥有所有正确的链接器输入（配置 -> 链接器 -> 输入），包括诸如 opencv、highgui 等的 dll。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-22T03:32:24.507

对于那些想要一些输入列表的人：

```
opencv_core412.lib
opencv_imgcodecs412.lib
opencv_imgproc412.lib
opencv_highgui412.lib
opencv_ml412.lib
opencv_video412.lib
opencv_features2d412.lib
opencv_calib3d412.lib
opencv_objdetect412.lib
opencv_flann412.lib 
```

412 是版本，在这种情况下，因为它处于发布模式，所以最后没有 d，否则它将是`opencv_flann412d.lib`

# mysql - 将许多字段的 data_type 从 bit 转换为 tinyint

> ID：10544932
> 
> 赞同：2
> 
> 时间：2012-05-11T03:11:57.587
> 
> 标签：mysql, bit, tinyint

以下查询是转换字段数据类型的可接受方式吗？

```
UPDATE INFORMATION_SCHEMA.COLUMNS 
SET `COLUMNS`.`DATA_TYPE` = 'tinyint'
WHERE
`COLUMNS`.`TABLE_SCHEMA` = 'BAR' 
AND `COLUMNS`.`TABLE_NAME` = 'FOO'
AND `COLUMNS`.`DATA_TYPE` = 'bit' 
```

我应该关注数据完整性还是将存储为 bit 的数据毫无问题地转移到 tinyint？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-16T13:59:28.703

这不行。INFORMATION_SCHEMA 数据库上不允许操作 UPDATE、DELETE、INSERT。

[这就是为什么。](https://stackoverflow.com/a/16502196/7257187)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-16T14:16:14.817

您不能直接修改元数据表（它们实际上是视图，但在这种情况下区别并不重要），但您可以使用它们来生成您的 alter table 语句，如下所示：

```
SELECT 'ALTER TABLE ' + TABLE_SCHEMA + '.' + TABLE_NAME + ' ALTER COLUMN ' + COLUMN_NAME + ' TINYINT' + CASE WHEN IS_NULLABLE = 'YES' THEN ' NULL;' ELSE ' NOT NULL;' END
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE `COLUMNS`.`TABLE_SCHEMA` = 'BAR' 
AND `COLUMNS`.`TABLE_NAME` = 'FOO'
AND `COLUMNS`.`DATA_TYPE` = 'bit' 
```

# iphone - 如何让 iPhone 在地图上自行追踪？

> ID：10544934
> 
> 赞同：-3
> 
> 时间：2012-05-11T03:12:05.000
> 
> 标签：iphone, ios, xcode, location

例如，我从圣地亚哥到洛杉矶旅行，我希望 iPhone 跟踪从圣地亚哥到洛杉矶的时间并告诉我结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:23:22.627

当您的应用程序处于后台时，当位置发生重大变化（例如新的手机信号塔）时，它仍然可以接收位置信息。您的应用程序可以监控重要的位置变化以及可用的常规 gps 并计算时差。

查看启动重大变化定位服务

[http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW10](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW10)

这也是使用显着时间变化通知的一个很好的教程：http: [//www.mindsizzlers.com/2011/07/ios-background-location/](http://www.mindsizzlers.com/2011/07/ios-background-location/)

有关 MapKit 的基本用法，请查看[本教程](http://www.raywenderlich.com/2847/introduction-to-mapkit-on-ios-tutorial)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:22:19.133

您可以使用 CoreLocation 通过 GPS 跟踪手机，每隔一段时间存储一次位置（每 X 分钟或每 X 英里/度-纬度-经度存储一次。

[CLLocationManager](https://developer.apple.com/library/mac/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html)类很可能是您想要的。你给它一个接收事件的委托，并开始它的轮询。为了节省电池，您不一定希望它连续轮询，但您可以将其设置为自动关闭，然后稍后再重新打开。

在地图上显示它稍微复杂一些，但仍然很容易做到。如果您需要地理编码，您可能需要使用 Google Maps API。

# c# - 在 WPF 浮动撕下选项卡中托管 Win32 窗口

> ID：10544938
> 
> 赞同：2
> 
> 时间：2012-05-11T03:12:56.933
> 
> 标签：c#, wpf, winapi

我目前在 WPF 中托管一个 Win32 OSG（基于 OpenGL 构建）控件。我正在使用 Telerik 对接库。当窗格与 MainWindow 对接时，一切正常。但是，当我撕下标签时，**OSG 图形不会在撕下标签中重新创建**。

我是用于创建本机 Win32 主机并返回本机句柄的子类`HwndHost`化`CreateWindowEx`（请参见下面的代码）。然后我将该句柄传递给由用户控件托管的本机 OSG 代码。

```
 // inside my ControlHost class which derives from HwndHost
    protected override HandleRef BuildWindowCore(HandleRef hwndParent)
    {
        hwndControl = IntPtr.Zero;
        hwndHost = IntPtr.Zero;

        hwndHost = CreateWindowEx(0, "MDIClient", "",
                                  WS_CHILD | WS_VISIBLE | WS_CLIPCHILDREN,
                                  0, 0,
                                  hostHeight, hostWidth,
                                  hwndParent.Handle,
                                  (IntPtr)HOST_ID,
                                  IntPtr.Zero,
                                  0);
        return new HandleRef(this, hwndHost);
    } 
```

When debugging into the above method, as expected, the `hwndParent.handle`parameter is the handle of the WPF MainWindow when the tab is docked in the Main window. 但是，当我将选项卡拉出并变成浮动选项卡时，该`hwndParent.handle`属性是我无法使用 Spy++ 找到的值。根据 Spy++ 的浮动标签“hwnd”值与上述方法产生的值相同。我怀疑这可能是 OSG 图形不显示的原因。

我的问题是：

1.  我知道 WPF 本身只有一个与每个 Window 对象关联的 HWND，但是这如何与停靠库中的浮动面板一起使用？浮动面板实际上是作为基础对象的窗口还是用户控件？

2.  任何想法为什么我的原生 OSG 图形没有显示在浮动撕下选项卡上？它与传入的父句柄有关吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T08:53:19.763

RadDocking 控件默认使用透明 WPF 窗口来显示其 ToolWindows，并且作为 WPF 的平台限制，您不能在此类透明窗口中显示任何非 WPF 内容。您可以做的是通过将 ToolWindow 的 RadWindowInteropHelper.AllowTransparency 附加属性设置为 False 来使窗口不透明。这可以使用自定义 GeneratedItemsFactory 来实现。请参阅[此论坛主题](http://www.telerik.com/community/forums/wpf/docking/hosting-a-win32-window-in-a-wpf-floating-tear-off-tab.aspx)作为示例项目。

问候， Miroslav Nedyalkov，Telerik 团队。

# regex - 从任何输入字符串中提取第二个数值的正则表达式，例如从字符串“this23 is 67 test 56 string 45”中获取数字 67。

> ID：10544943
> 
> 赞同：1
> 
> 时间：2012-05-11T03:13:18.427
> 
> 标签：regex

我面临从输入字符串中提取特定数值的问题。

说，我有一个字符串“this23 is 67 test 56 string 45”，我必须从字符串中获取数字 67，那么如何使用正则表达式提取它？

我只需要使用正则表达式。

你有什么想法吗？

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:23:11.980

`[^\d]*[\d]+[^\d]+([\d]+)`

第一个块是 0 个或多个非数字，然后是 1 个或多个数字，然后是 1 个或多个非数字，然后是 1 个或多个数字。在括号中，以便您可以使用您使用的任何语言捕获它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:27:47.527

试试这个：

```
^\D*\d+\D+(\d+) 
```

我使用 Rubular 对此进行了测试-> 67 在第一组中。

可以使用后向命令 (?<=expression) 编写正则表达式，但不能在内部使用 * 或 +（至少在 Ruby 和 Perl 中是不可能的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T03:28:55.137

*   忽略任何非数字
*   忽略任何数字（第一个数字）
*   再次忽略任何非数字
*   捕获第二个数字

`[\D]*[\d]+[\D]+([\d]+)`

# database - Magento 自定义集合

> ID：10544951
> 
> 赞同：0
> 
> 时间：2012-05-11T03:14:28.260
> 
> 标签：database, magento, orm, entity-attribute-value

遍？

我有如下业务规则：在我的产品列表中，需要带一些超出标准数据的数据，数据会是他应该属于的类别，但是按照级别更高的类别排序，我会解释：

我的树类别：（*）产品属于类别

```
-- Root

---- Furniture *
------ Living Room
------ Bedroom

---- Electronics
------ Cameras
-------- Accessories *
-------- Digital Cameras *
------ Cell Phones
-------- Smartphone

---- Computers 
------ Build Your Own *
------ Laptops
-------- Nice
---------- Power *
-------- Master *
------ Hard Drives

---- Apparel 
------ Shirts 
------ Shoes 
------ Mens *
------ Womens 
------ Hoodies 
```

按级别排序的返回：

```
level-4 - Power

level-3 - Digital Cameras
level-3 - Accessories
level-3 - Master

level-2 - Build Your Own
level-2 - Mens

level-1 - Furniture 
```

当然，它可以很快完成，所以他们可以访问产品的 ID，我会在工作台上再次搜索所有类别，然后进行搜索。不喜欢这种方式，它会花费我两倍的处理和查询数据库，正如我所说的那样是一种解决方案，但希望集合本身也可以与类别表连接。

谢谢谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T13:47:11.533

查看此页面： http: [//www.magentocommerce.com/boards/viewthread/24947/](http://www.magentocommerce.com/boards/viewthread/24947/)

那里有一些关于构建树的不错的代码。从这个例子中，您应该能够`level`按照您需要的方式使用和订购它。

# facebook - Facebook API，正确使用 og: 元标记

> ID：10544955
> 
> 赞同：0
> 
> 时间：2012-05-11T03:14:44.747
> 
> 标签：facebook, facebook-graph-api, meta-tags

这一切都很完美，问题是我的一个页面使用了动态链接。

前任。www.blahblah.com/dynamic?gsgregfdgcvbdg

相对于：

www.blahblah.com/dynamic.html

* * *

出现问题是因为被喜欢的页面从来都不是 www.blahblah.com/dynamic.html 但总是 www.blahblah.com/dynamic?gsgregfdgcvbdg 和 facebook 在它是动态的时候无法识别标签。有没有解决的办法？

这是我的代码：`<meta property="og:title" content="titlename" /> <meta property="og:description" content="desc" /> <meta property="og:image" content="http://www.website.com/Background/Back2012/refImage.png" /> <meta name="medium" content="video" />`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:31:51.193

尝试将`og:url`标记设置为指向永久 URL，而不使用查询字符串中的参数。使用此标签应该会导致 Facebook Like 指向该`og:url`值，而不是带有查询字符串参数的实际 URL。

# java - Java Swing：在按键被按下时做一些事情

> ID：10544956
> 
> 赞同：4
> 
> 时间：2012-05-11T03:14:50.107
> 
> 标签：java, swing, keyboard, key-bindings, onkeypress

我使用 a`KeyAdpater`来获取事件和方法`addKeyListener`并且工作正常。问题是，当按下键时，动作只发生一次，而不是在按下键时发生，**在**按住键 3-4 秒后，动作一直发生，这正是我想要的。

我想知道是否有好的方法可以**从一开始**就一直按下键，而不是在按住 3-4 秒后。

我想到了下一个解决方案，但也许已经有一种实现的方法：

```
public abstract class MyKeyAdapter extends KeyAdapter{
    private boolean isPressed = false;
    private int pressedKey = 0;
    Thread t = new Thread(new Runnable() {
        @Override
        public void run() {
            while(isPressed)
                keyPressedAction(pressedKey);
        }
    });    

    @Override
    public void keyPressed(KeyEvent e) {
            if(!isPressed){
                pressedKey = e.getKeyCode();
                t.start();
            }
    }
    @Override
    public void keyReleased(KeyEvent e) {
         if(isPressed && e.getKeyCode()==pressedKey)}
             isPressed = false;
    }

    public abstract void keyPressedAction(int key);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T03:17:50.970

通过使用[Key Bindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)而不是 KeyListener 并在按键时启动[Swing Timer ，然后在 Swing 释放时停止 Timer，我已经取得了很好的成功。](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)您可以通过使用此处找到的方法将正确的 KeyStroke 对象传递到绑定组件的[InputMap](http://docs.oracle.com/javase/7/docs/api/javax/swing/InputMap.html)来区分按键和释放`KeyStroke.getKeyStroke(int keyCode, int modifiers, boolean onKeyRelease)`：[KeyStroke API](http://docs.oracle.com/javase/7/docs/api/javax/swing/KeyStroke.html)。如果布尔参数为假，输入将响应按键，如果参数为真则反之。

举一个快速而不优雅的例子：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;

import javax.swing.*;

@SuppressWarnings("serial")
public class KeyBindingEg extends JPanel {
   private static final String UP_KEY_PRESSED = "up key pressed";
   private static final String UP_KEY_RELEASED = "up key released";
   private static final int UP_TIMER_DELAY = 200;
   private static final Color FLASH_COLOR = Color.red;

   private Timer upTimer;
   private JLabel label = new JLabel();

   public KeyBindingEg() {
      label.setFont(label.getFont().deriveFont(Font.BOLD, 32));
      label.setOpaque(true);
      add(label);

      setPreferredSize(new Dimension(400, 300));

      int condition = WHEN_IN_FOCUSED_WINDOW;
      InputMap inputMap = getInputMap(condition);
      ActionMap actionMap = getActionMap();
      KeyStroke upKeyPressed = KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, false);
      KeyStroke upKeyReleased = KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, true);

      inputMap.put(upKeyPressed, UP_KEY_PRESSED);
      inputMap.put(upKeyReleased, UP_KEY_RELEASED);

      actionMap.put(UP_KEY_PRESSED, new UpAction(false));
      actionMap.put(UP_KEY_RELEASED, new UpAction(true));

   }

   private class UpAction extends AbstractAction {
      private boolean onKeyRelease;

      public UpAction(boolean onKeyRelease) {
         this.onKeyRelease = onKeyRelease;
      }

      @Override
      public void actionPerformed(ActionEvent evt) {
         if (!onKeyRelease) {
            if (upTimer != null && upTimer.isRunning()) {
               return;
            }
            System.out.println("key pressed");
            label.setText(UP_KEY_PRESSED);

            upTimer = new Timer(UP_TIMER_DELAY, new ActionListener() {

               @Override
               public void actionPerformed(ActionEvent e) {
                  Color c = label.getBackground();
                  if (FLASH_COLOR.equals(c)) {
                     label.setBackground(null);
                     label.setForeground(Color.black);
                  } else {
                     label.setBackground(FLASH_COLOR);
                     label.setForeground(Color.white);
                  }
               }
            });
            upTimer.start();
         } else {
            System.out.println("Key released");
            if (upTimer != null && upTimer.isRunning()) {
               upTimer.stop();
               upTimer = null;
            }
            label.setText("");
         }
      }

   }

   private static void createAndShowGui() {
      KeyBindingEg mainPanel = new KeyBindingEg();

      JFrame frame = new JFrame("KeyBindingEg");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(mainPanel);
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

# wpf - 为什么 WPF 在将值绑定到控件时使用控件的视图模型？

> ID：10544957
> 
> 赞同：0
> 
> 时间：2012-05-11T03:15:19.043
> 
> 标签：wpf, data-binding, mvvm

我正在写一个可以在任何地方使用的值输入控件。控件本身有一个视图模型，它像往常一样设置为其 DataContext。但是当我在父控件中使用控件时，例如：

```
<UserControl x:Class="X.Y.Z.ParentControl">
    ...
    <local:ValueInput Value="{Binding Path=MyValue}" />
    ...
</UserControl> 
```

我打算将's的`MyValue`属性绑定到控件，但是 WPF 告诉我它在类中找不到该属性，这是控件本身的视图模型。为什么 WPF 从 child's 中寻找价值？`ParentControl``DataContext``ValueInput``MyValue``ValueInputViewModel``ValueInput``DataContext`

我只想写一个可以像这样使用的控件：

```
<telerik:RadNumericUpDown Value="{Binding Path=NumberValue}" /> 
```

该`NumberValue`属性在父级中定义`DataContext`，而不是在控件中。这种模式适用于 Teleriks 控制，但不适用于我的控制。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:58:52.307

对于任何 FrameworkElement，只能有 1 个 DataContext。

如果 UserControl 有自己的 DataContext，则不能使用父级的 DataContext。

但是，您可以使用 RelativeSource 走到父级并获取其 DataContext（每次您需要引用父级的 DataContext）

```
Binding="{Binding RelativeSource={RelativeSource FindAncestor, 
AncestorType={x:Type Window}}, Path=DataContext.NumberValue}" 
```

要使此示例正常工作，Parent（任何级别的根）应该是 Window。如果是用户控件，

```
Binding="{Binding RelativeSource={RelativeSource FindAncestor, 
AncestorType={x:Type UserControl}}, Path=DataContext.NumberValue}" 
```

代码来自[fiq](https://stackoverflow.com/users/51428/flq)提供的[这个链接](https://stackoverflow.com/questions/1127933/wpf-databinding-how-do-i-access-the-parent-data-context)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T06:56:20.227

我的朋友告诉我不要`DataContext`在独立控件中用作视图模型，因为 DataContext 很容易被覆盖 -`ViewModel`在 XAML 中定义属性和绑定可以解决问题。这是一个例子：

查看模型类：

```
public class MyValueInputViewModel
{
    public string MyText { get; set; }
} 
```

后面的代码：

```
public partial class MyValueInput : UserControl
{
    public MyValueInput()
    {
        InitializeComponent();

        this.ViewModel = new MyValueInputViewModel
        {
            MyText = "Default Text"
        };
    }

    public static readonly DependencyProperty ViewModelProperty =
        DependencyProperty.Register("ViewModel", typeof(MyValueInputViewModel), typeof(MyValueInput));

    public MyValueInputViewModel ViewModel
    {
        get
        {
            return (MyValueInputViewModel)this.GetValue(ViewModelProperty);
        }
        private set
        {
            this.SetValue(ViewModelProperty, value);
        }
    }

    public static readonly DependencyProperty ValueProperty =
        DependencyProperty.Register("Value", typeof(string), typeof(MyValueInput), new PropertyMetadata(OnValuePropertyChanged));

    private static void OnValuePropertyChanged(DependencyObject o, DependencyPropertyChangedEventArgs args)
    {
        var input = (MyValueInput)o;
        input.ViewModel.MyText = input.Value;
    }

    public string Value
    {
        get { return (string)this.GetValue(ValueProperty); }
        set { this.SetValue(ValueProperty, value); }
    }
} 
```

XAML：

```
<UserControl x:Class="..." x:Name="Self" ...>
    <Grid>
        <TextBox Text="{Binding ViewModel.MyText, ElementName=Self, UpdateSourceTrigger=PropertyChanged}" />
    </Grid>
</UserControl> 
```

# compiler-construction - 学习的编译器

> ID：10544960
> 
> 赞同：1
> 
> 时间：2012-05-11T03:15:32.377
> 
> 标签：compiler-construction

我最近接触到了一个颜色编码编译器功能，它可以让你在运行前知道你的代码是否可以工作。我也见过其他编译器采用的类似的纠错方法

有没有一种编译器可以学习你的编程方式，甚至可以从你自己的编程错误中学习？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T18:11:45.620

我不知道自己学习的编译器，但我看到他们的开发人员学习并包括对典型错误模式的检测及其可能的更正。

例如 Clang 有：

*   通过推断你的意思（如果可能的话），向你建议，*并*继续解析，就好像它是你所做的那样来恢复错误
*   一些可能的错误的警告，`for ( );`然后是一个缩进的语句，例如

此外，它还包括一个善意的错字更正，这真的非常了不起。例如，测试套件中的[typo-correction.cpp文件显示：](http://llvm.org/svn/llvm-project/cfe/trunk/test/SemaCXX/typo-correction.cpp)

```
struct BaseType { };

struct Derived : public BaseType { // expected-note\
                                    {{base class 'BaseType' specified here}}

  static int base_type; // expected-note {{'base_type' declared here}}

  Derived() : basetype() {} // expected-error\
                             {{initializer 'basetype' does not name a non-static\
                               data member or base class; did you mean the base \
                               class 'BaseType'?}}
}; 
```

即使`base_type`更接近（距离方面），它也不是基类也不是属性，因此不予考虑。

问题是，与其他人相比，您最有可能犯同样的错误，因此整个社区能够了解自己并改进工具。

无论如何，编译器可能不是自己学习的情况，但是您有时可能想知道它是否有感觉！

# c# - 使用openFileDialog c#时的参数异常

> ID：10544966
> 
> 赞同：0
> 
> 时间：2012-05-11T03:16:38.007
> 
> 标签：c#, winforms, dialog, illegalargumentexception

我正在尝试使用文件打开对话框打开图像，但收到此错误消息：参数异常 - 路径不是合法形式。

图像怎么可能不是法律形式？

设置图片方法

```
public void SetPicture(String fileName)
    {
        pictureBox1.Image = Image.FromFile(fileName);
    } 
```

切换语句

```
 private void ViewButton_Click(object sender, EventArgs e)
    {
        switch (txtMediaType.Text)
        {
            case "Picture":
                PictureViewer p = new PictureViewer();
                p.SetPicture(ofdSelectMedia.FileName);
                p.Show();
                break; 
            case "Video":
                VideoViewer v = new VideoViewer();
                v.SetVideo(ofdSelectMedia.FileName);
                v.Show();
                break;

            case "URL":
                System.Diagnostics.Process.Start(txtFilePath.Text);
                break; 
```

# java - 3D Java 中的错误

> ID：10544968
> 
> 赞同：-3
> 
> 时间：2012-05-11T03:16:43.927
> 
> 标签：java, eclipse, 3d

我在 Eclipse 中从 oracle 运行一些 3d 示例代码，但我收到很多错误，说“在文件中重命名”。有人知道为什么会有这么多错误吗？

```
import java.applet.Applet;
import java.awt.BorderLayout;
import java.awt.Frame;
import java.awt.event.*;
import java.awt.GraphicsConfiguration;
import com.sun.j3d.utils.applet.MainFrame; 
import com.sun.j3d.utils.universe.*; 
import com.sun.j3d.utils.geometry.ColorCube;
import javax.media.j3d.*;
import javax.vecmath.*;

//HelloJava3Da renders a single, rotating cube.  

public class HelloJava3Da extends Applet
{
    public HelloJava3Da()
    {
        setLayout(new BorderLayout());
        GraphicsConfiguration config = SimpleUniverse.getPreferredConfiguration();

        Canvas3D canvas3D = new Canvas3D(config);
        add("Center", canvas3D);

        BranchGroup scene = createSceneGraph();

        // SimpleUniverse is a Convenience Utility class
        SimpleUniverse simpleU = new SimpleUniverse(canvas3D);

        // This will move the ViewPlatform back a bit so the
        // objects in the scene can be viewed.
        simpleU.getViewingPlatform().setNominalViewingTransform();

        simpleU.addBranchGraph(scene);
    } // end of HelloJava3Da (constructor)

    public BranchGroup createSceneGraph()
    {
        // Create the root of the branch graph
        BranchGroup objRoot = new BranchGroup();

        objRoot.addChild(new ColorCube(0.4));

        return objRoot;
    } // end of CreateSceneGraph method of HelloJava3Da

    //  The following allows this to be run as an application
    //  as well as an applet

    public static void main(String[] args)
    {
        Frame frame = new MainFrame(new HelloJava3Da(), 256, 256);
    } // end of main (method of HelloJava3Da)

} // end of class HelloJava3Da 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T03:37:07.233

在我看来，您缺少一些库。[例如](http://www.findjar.com/jar/java3d/vecmath/1.3.1/vecmath-1.3.1.jar.html)，使用它来查找您正在寻找的罐子。该链接包含 vecmath 的 jar。之后，根据您使用的 IDE，您必须下载丢失的 jar 并将它们添加到类路径中。

您将需要为以下代码行找到相应的 JAR：

```
import com.sun.j3d.utils.applet.MainFrame; 
import com.sun.j3d.utils.universe.*; 
import com.sun.j3d.utils.geometry.ColorCube;
import javax.media.j3d.*;
import javax.vecmath.*; 
```

findjar.com 是搜索丢失的 JAR 文件的好地方。

# click - 在 JUNG 中使用鼠标右键单击弹出菜单

> ID：10544970
> 
> 赞同：4
> 
> 时间：2012-05-11T03:16:58.630
> 
> 标签：click, mouse, jung

我想创建一个弹出菜单，如果我右键单击画布就会出现。我怎样才能做到这一点？我应该修改哪个功能？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:24:22.583

```
protected class PopupGraphMousePlugin extends AbstractPopupGraphMousePlugin implements      MouseListener {

    public PopupGraphMousePlugin() {
        this(MouseEvent.BUTTON3_MASK);
    }
    public PopupGraphMousePlugin(int modifiers) {
        super(modifiers);
    }

    /**
     * If this event is over a station (vertex), pop up a menu to
     * allow the user to perform a few actions; else, pop up a menu over the layout/canvas
     *
     * @param e
     */
    @SuppressWarnings("unchecked")
    protected void handlePopup(MouseEvent e) {
        final VisualizationViewer<String,String> vv =(VisualizationViewer<String,String>)e.getSource();
        final Point2D p = e.getPoint();
        final Point2D ivp = p;
        JPopupMenu popup = new JPopupMenu();

        System.out.println("mouse event!");

        GraphElementAccessor<String,String> pickSupport = vv.getPickSupport();
        System.out.println("GraphElementAccessor!");
        if(pickSupport != null) {

            final String pickV = pickSupport.getVertex(vv.getGraphLayout(), ivp.getX(), ivp.getY());

            if(pickV != null) {
               System.out.println("pickVisnotNull");

               popup.add(new AbstractAction("Add New") {
                   /**
                 * 
                 */

                public void actionPerformed(ActionEvent e) {
                   System.out.println("person added");  
                   }
               });//new abstraction

            }
        }///if picksupport

    }//handlePopup(MouseEvent e)
}//PopupGraphMousePlugin 
```

那是你第一个代码中的那个

这是第二部分

```
/Next, let's just build a simple mouse, to allow picking, translating, and zooming.
    AbstractModalGraphMouse gMouse = new DefaultModalGraphMouse<Object, Object>();
    vv.setGraphMouse(gMouse); //Add the mouse to our Visualization-Viewer.
    //PluggableGraphMouse pgm = new PluggableGraphMouse();
    gMouse.add(new PickingGraphMousePlugin<Object, Object>());
    //pgm.add(new TranslatingGraphMousePlugin(MouseEvent.BUTTON3_MASK));
    gMouse.add(new PopupGraphMousePlugin());
    gMouse.add(new ScalingGraphMousePlugin(new CrossoverScalingControl(), 0, 1 / 1.1f, 1.1f)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T01:19:50.550

当右键单击顶点或画布时，以下代码将创建一个弹出菜单...

```
/**
 * a GraphMousePlugin that offers popup
 * menu support
 */
protected class PopupGraphMousePlugin extends AbstractPopupGraphMousePlugin
implements MouseListener {

    public PopupGraphMousePlugin() {
        this(MouseEvent.BUTTON3_MASK);
    }
    public PopupGraphMousePlugin(int modifiers) {
        super(modifiers);
    }

    /**
     * If this event is over a station (vertex), pop up a menu to
     * allow the user to perform a few actions; else, pop up a menu over the layout/canvas
     *
     * @param e
     */
    protected void handlePopup(MouseEvent e) {
        final VisualizationViewer<GeoLocation.Station,GeoLocation.Link> vv =
                (VisualizationViewer<GeoLocation.Station,GeoLocation.Link>)e.getSource();
        final Point2D p = e.getPoint();
        final Point2D ivp = p;

        GraphElementAccessor<GeoLocation.Station,GeoLocation.Link> pickSupport = vv.getPickSupport();
        if(pickSupport != null) {

            JPopupMenu popup = new JPopupMenu();

            final GeoLocation.Station station = pickSupport.getVertex(vv.getGraphLayout(), ivp.getX(), ivp.getY());

            if(station != null) {
                boolean isRadio = station.getParentSet().contains(STATION_IDENTIFIER_KEY);

                if(isRadio)
                    if (station.getId().equalsIgnoreCase(SneakPeek.getUsername())){

                        String follow = "Follow " + station.getId();
                        if (followLocal){
                            follow = "Do not follow " + station.getId();
                        }
                        else {
                            follow = "Follow " + station.getId();
                        }

                        popup.add(new AbstractAction("<html><center>" + follow) {
                            public void actionPerformed(ActionEvent e) {

                                followLocal = !followLocal;

                            }
                        });

                    }

                if(popup.getComponentCount() > 0) {
                    popup.show(vv, e.getX(), e.getY());
                }
            }
        }
        else { //to pop-up over the canvas/layout rather than over the station

            popup.add(new AbstractAction("Create Unit") {
                public void actionPerformed(ActionEvent e) {
                    //do something here
                }
            });

            if(popup.getComponentCount() > 0) {
                popup.show(vv, e.getX(), e.getY());
            }
        }

    }
} 
```

将该类添加到`AbstractModalGraphMouse`处理鼠标侦听器的类中以使其工作：

```
private AbstractModalGraphMouse graphMouse;
...
graphMouse = new DefaultModalGraphMouse<Object, Object>();
vvMap.setGraphMouse(graphMouse);
graphMouse.add(new PopupGraphMousePlugin()); 
```

上面的代码确实有效。但是，如果您对通用零件使用不同的用户数据，那么您需要修改代码以适合您的设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T17:17:36.373

这不是一个特别的 JUNG 问题——画布只是一个标准问题的 Swing 画布，移植了一些额外的功能，并且您没有单击图形元素——但是 GraphEditorDemo 和 PluggableRendererDemo 展示了类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T08:31:02.760

```
protected void handlePopup(MouseEvent e) {
        final VisualizationViewer<Integer,Number> vv = (VisualizationViewer<Integer,Number>)e.getSource();
        Point2D p = e.getPoint();

        //vv.getRenderContext().getBasicTransformer().inverseViewTransform(e.getPoint());

        GraphElementAccessor<Integer,Number> pickSupport = vv.getPickSupport();
        if(pickSupport != null) {
            System.out.println("POPUP MOUSE is not NULL!");
            final Integer v = pickSupport.getVertex(vv.getGraphLayout(), p.getX(), p.getY());
            if(v != null) {
                JPopupMenu popup = new JPopupMenu();

                popup.add(new AbstractAction("Decrease Transparency") {
                    public void actionPerformed(ActionEvent e) {
                        Double value = Math.min(1,transparency.get(v).doubleValue()+0.1);
                        transparency.put(v, value);//vertex, value

                        vv.repaint();
                    }
                });
                popup.add(new AbstractAction("Increase Transparency"){
                    public void actionPerformed(ActionEvent e) {
                        Double value = Math.max(0, 
                                transparency.get(v).doubleValue()-0.1);
                            transparency.put(v, value);

                        vv.repaint();
                    }
                });
                popup.show(vv, e.getX(), e.getY());
            } 
            else {
                final Number edge = pickSupport.getEdge(vv.getGraphLayout(), p.getX(), p.getY());
                if(edge != null) {
                    JPopupMenu popup = new JPopupMenu();
                    popup.add(new AbstractAction(edge.toString()) {
                        public void actionPerformed(ActionEvent e) {
                            System.err.println("got "+edge);
                        }

                    });//popup.add
                    popup.show(vv, e.getX(), e.getY());

                }//if edge != null)
            }

        }// if(pickSupport != null)

        //rightclicked on Canvas
        else{
            System.out.println("On Canvas!");
        }

    }//handlePopup(MouseEvent e) 
```

# windows - Windows Server 与客户端的带外编程识别

> ID：10544975
> 
> 赞同：0
> 
> 时间：2012-05-11T03:17:59.003
> 
> 标签：windows, kernel, windows-server, computer-forensics

我有一些独立的 C++ 代码（即不是 Windows 程序）需要识别 PC 上安装的 Windows 版本。

我可以通过内核版本（例如在 ntoskrnl.exe 上）轻松区分不同的 Windows 客户端版本`GetFileVersionInfo`，但是我想知道是否有一种可靠的方法来区分客户端和服务器安装。

使用此方法区分 Windows Vista SP2 和 Windows Server 2008 SP2（两者均为 6.0 build 6002）和 Windows 7 和 Windows Server 2008 R2（用于 RTM 的 6.1 build 7600 和用于 SP2 的 6.1 build 7601，两者）时会出现问题. 对于在环境外运行的代码，正确识别客户端与服务器操作系统的可靠方法是什么（最好尽可能直接，避免注册表会很好，因为无法访问 Win32 API）？

我想我可以检查仅存在于服务器版本上的文件（无论配置如何，保证在任何服务器版本安装上都有什么好文件？），检查 Panther 文件夹（可以安全删除，所以不能保证），等等，但我敢肯定这是人们以前遇到过的问题，并且（希望）更优雅地解决了？

（旁注：这个问题之前已经[在 SO 上提出过](https://stackoverflow.com/questions/6368370/how-to-distinguish-the-server-version-from-the-client-version-of-windows)，但解决方案（WMI）不适用于带外检查）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:13:01.730

我最终在 system32 目录中搜索了一些通常与 Windows 服务器版相关联的二进制文件。它不是很干净，但在实践中效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T03:30:00.160

我不完全确定你所说的带外检查是什么意思，所以我暂时忽略它。

正常的方法是调用[`GetVersionEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724451.aspx)，然后查看 的`wProductType`成员[`OSVERSIONINFOEX`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724833.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T07:22:03.740

PE 映像没有指定该映像应该在客户端还是服务器上工作。它仅指定有关子系统、依赖项、内存、亲和性等的运行时要求......

# android - 将 PendingIntent onClick 添加到自定义对话框

> ID：10544978
> 
> 赞同：3
> 
> 时间：2012-05-11T03:18:35.167
> 
> 标签：android, android-intent, customdialog

我是一个复制和粘贴编码器，这可能真的很傻......

单击小部件后，我会出现一个自定义对话框：

```
public class ClockHandler extends Activity {

    final Context context = this;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        final Dialog dialog = new Dialog(context);
        dialog.setContentView(R.layout.clockhandler);
        dialog.setTitle("Available Clocks...");

        // set the custom dialog components - text, image and button 
        TextView text = (TextView) dialog.findViewById(R.id.text);
        text.setText("System Clocks");
        text.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Toast.makeText(getApplicationContext(), "Searching for System Clock...", Toast.LENGTH_SHORT).show();
        // Trying to open System Clock
        // referencing https://stackoverflow.com/a/4281243/805031
            }
        });

        TextView text2 = (TextView) dialog.findViewById(R.id.text2);
        text2.setText("More Clock Widgets!");

        text2.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                Toast.makeText(getApplicationContext(), "Clock Widget Gallery Coming SOON!!!", Toast.LENGTH_LONG).show();
        // Open clock widget gallery
        // eventually
            }
        });

        dialog.show();
    }

} 
```

单击时，我想实施[https://stackoverflow.com/a/4281243/805031](https://stackoverflow.com/a/4281243/805031)解决方案`TextView text`。我尝试了各种安排，包括：

在一个单独的文件中使用[https://stackoverflow.com/a/4281243/805031](https://stackoverflow.com/a/4281243/805031)`SystemClock.java`然后尝试从我那里调用`ClockHandler`它

```
final RemoteViews rv = new RemoteViews(context.getPackageName(), R.layout.clockhandler);
                final PendingIntent intent = SystemClock.getClockIntent(context);
                if (intent != null){
                    rv.setOnClickPendingIntent(R.id.text, intent); 
```

和

```
Intent intent = new Intent();  
                  PendingIntent.getActivity(context, 0, intent, 0); 
```

还包括[https://stackoverflow.com/a/4281243/805031](https://stackoverflow.com/a/4281243/805031)解决方案在 ClockHandler 文件下`public void onClick(View v) {`

# haskell - Haskell：具有逻辑上不同布尔值的类型安全

> ID：10544984
> 
> 赞同：7
> 
> 时间：2012-05-11T03:19:29.597
> 
> 标签：haskell, types, casting, type-safety

假设我有以下代码

```
type IsTall = Bool
type IsAlive = Bool

is_short_alive_person is_tall is_alive = (not is_tall) && is_alive 
```

说，稍后，我有以下

```
a :: IsAlive
a = False

b :: IsTall
b = True 
```

并调用以下命令，以错误的方式获取两个参数：

```
is_short_alive_person a b 
```

不幸的是，这成功编译，并且在运行时找到了高个子死人而不是短命人。

我希望上面的示例不要编译。

我的第一次尝试是：

```
newtype IsAlive = IsAlive Bool
newtype IsTall = IsTall Bool 
```

但是我不能做类似的事情。

```
switch_height :: IsTall -> IsTall
switch_height h = not h 
```

As`not`没有在`IsTall`s 上定义，只有`Bool`s。

我可以一直明确地提取`Bool`s ，但这在很大程度上违背了目的。

基本上，我希望`IsTall`s 与其他`IsTall`s 交互，就像它们是`Bool`s 一样，只是它们不会在没有显式强制转换的情况下与`Bool`s 和s 交互。`IsAlive`

实现这一目标的最佳方法是什么。

* * *

ps 我想我已经通过在 GHC 中的数字实现了这一点：

```
{-# LANGUAGE GeneralizedNewtypeDeriving #-}

newtype UserID = UserID Int deriving (Eq, Ord, Num)
newtype GroupID = GroupID Int deriving (Eq, Ord, Num) 
```

（即 UserID 和 GroupID 不应该交互）

但我似乎无法用`Bool`s 做到这一点（派生 Bool 不起作用）。我什至不确定以上是最好的方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T03:33:44.013

如果你稍微改变你的数据类型，你可以让它成为 Functor 的一个实例，然后你可以使用 fmap 对布尔值进行操作

```
import Control.Applicative

newtype IsAliveBase a = IsAlive a 
newtype IsTallBase a = IsTall a 

type IsAlive = IsAliveBase Bool
type IsTall = IsTallBase Bool

instance Functor IsAliveBase where
    fmap f (IsAlive b) = IsAlive (f b)

instance Functor IsTallBase where
    fmap f (IsTall b) = IsTall (f b)

switch_height :: IsTall -> IsTall 
switch_height h = not <$> h -- or fmap not h 
```

- 编辑

对于 && 之类的操作，您可以将其设为 Applicative 的实例

```
instance Applicative IsAliveBase where
    pure = IsAlive
    (IsAlive f) <*> (IsAlive x) = IsAlive (f x) 
```

然后你可以使用 liftA2 做 (&&)

例子：

```
*Main> let h = IsAlive True
*Main> liftA2 (&&) h h 
IsAlive True 
```

[您可以在http://en.wikibooks.org/wiki/Haskell/Applicative_Functors](http://en.wikibooks.org/wiki/Haskell/Applicative_Functors)阅读更多相关信息

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-11T03:30:53.767

您的选择是定义代数数据类型，例如

```
data Height = Tall | Short
data Wiggliness = Alive | Dead 
```

或定义新的运算符，例如 , ，`&&&`并在您选择的类型上重载它们。但即使重载，您也无法将它们与.`|||``complement``if`

无论如何，我不确定对高度的布尔运算是否有意义。你如何证明“高和矮等于矮”但“高或矮等于高”的结论？

我建议你为你的连接词寻找不同的名字，然后你可以重载它们。

PS Haskell 总是在获得新功能，所以我能说的最好的就是如果你可以超载`if`我不知道它。说 Haskell 说“不能做某事”总是很危险的……

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-11T05:13:28.327

`newtype`如果您导入 Prelude 隐藏您想要与您的`IsTall`和`IsAlive`值一起使用的布尔函数，您可以使用 s 和一个类来实现这一点。您将布尔函数重新定义为类中的方法，然后为所有 3 `Bool`、`IsTall`和`IsAlive`类型创建实例。如果您使用`GeneralizedNewtypeDeriving`，您甚至可以获取`IsTall`and`IsAlive`实例，而无需手动编写包装/展开样板。

这是我在 ghci 中实际尝试过的示例脚本：

```
{-# LANGUAGE GeneralizedNewtypeDeriving #-}

import Prelude hiding ((&&), (||), not)
import qualified Prelude

class Boolish a where
    (&&) :: a -> a -> a
    (||) :: a -> a -> a
    not :: a -> a

instance Boolish Bool where
    (&&) = (Prelude.&&)
    (||) = (Prelude.||)
    not = Prelude.not

newtype IsTall = IsTall Bool
    deriving (Eq, Ord, Show, Boolish)

newtype IsAlive = IsAlive Bool
    deriving (Eq, Ord, Show, Boolish) 
```

您现在可以使用`&&`、`||`和`not`三种类型中的任何一种，但不能同时使用。而且它们是独立的类型，因此您的函数签名现在可以限制他们想要接受的 3 个中的哪一个。

其他模块中定义的高阶函数可以正常工作，如下所示：

```
*Main> map not [IsTall True, IsTall False]
[IsTall False,IsTall True] 
```

但是您将无法将 an 传递`IsTall`给在其他地方定义的任何其他需要 a 的函数`Bool`，因为其他模块仍将使用布尔函数的 Prelude 版本。像这样的语言结构`if ... then ... else ...`仍然是一个问题（尽管 hammar 对 Norman Ramsey 的回答的评论说你可以用另一个 GHC 扩展来解决这个问题）。我可能会`toBool`向该类添加一个方法，以帮助统一转换回常规`Bool`s 以帮助缓解此类问题。

# ruby - 无法通过 (Date.today..Date.new(2012, 4, 1)).select 获取日期范围

> ID：10544988
> 
> 赞同：1
> 
> 时间：2012-05-11T03:20:14.403
> 
> 标签：ruby, range

我刚刚遇到了在 Ruby 中获取一系列日期的奇怪行为。

`(Date.new(2012, 4, 1)..Date.today).select { |d| p d }`作品

`(Date.today..Date.new(2012, 4, 1)).select { |d| p d }`失败。

任何想法？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:25:26.270

该范围不能向后移动，因此它返回一个空数组。

# c# - 如何将字符串变量放在双引号内？

> ID：10544990
> 
> 赞同：0
> 
> 时间：2012-05-11T03:20:25.397
> 
> 标签：c#

所以我想从数据库中创建一个文本（如日志文件）。每个文本代表一个用户的记录。显然，根据数据库，每条记录都有不同的名称。我想知道在创建文本文件时如何将字符串变量放在 doubleqoute 中。

```
public static void createLog()
{
    MySqlConnection con = new MySqlConnection();
    con.ConnectionString = "SERVER=localhost;DATABASE=s_project;UID=root;PASSWORD='';";SELECT

    con.Open();
    MySqlCommand thiscommand = con.CreateCommand();
    thiscommand.CommandText = "SELECT user_name FROM user_info";
    MySqlDataReader read = thiscommand.ExecuteReader();

    while (read.Read())
    {
        string user_name;
        user_name = read.GetString("user_name");

        StreamWriter SW;
        SW = File.CreateText("c:\\MyTextFile.txt"); //what should I put instead of MyTextFile if I would like it to be the variable user_name?
    }

    con.Close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:22:33.940

您可以使用 +（字符串连接）运算符。

```
SW = File.CreateText("c:\\" + user_name + ".txt"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T03:27:58.103

`String.Format`如果您开始需要更多变量，也可以使用：

```
SW = File.CreateText(String.Format("c:\\{0}.txt", user_name)); 
```

它可以更清晰地显示意图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T03:28:11.707

使用 + 符号

```
SW = File.CreateText(@"C:\" + user_name + ".txt"); 
```

# windows-phone-7 - 滑动时会短暂出现折叠的 PanoramaItem

> ID：10544991
> 
> 赞同：0
> 
> 时间：2012-05-11T03:20:27.623
> 
> 标签：windows-phone-7, windows-phone-7.1, panorama-control

在 7.1 上使用全景控件时，我有一种奇怪的体验……我正在尝试以编程方式切换 PanoramaItem 的可见性。但是，虽然它工作正常并且 PanoramaItem 切换（即 PanItemA 被隐藏，而 PanItemB 显示​​），但隐藏的 PanoramaItem 在向右滑动时会短暂重新出现（从第一个项目到最后一个项目）。

我不知道如何解决它。

任何帮助深表感谢。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T07:00:34.237

It's not good idea show/hide Items for Panorama. Try remove/add them instead.

# android - Android 4.0 ICS中调用音频流修改

> ID：10544992
> 
> 赞同：28
> 
> 时间：2012-05-11T03:20:33.137
> 
> 标签：android, audio, native, phone-call

我一直在从事一个将从调用流修改中受益匪浅的项目。这已被反复提及/假设是无法实现的，因为大多数人认为通话中音频的硬件循环与设备的主 MCU 完全断开。

[将音频流式传输到 Android 电话](https://stackoverflow.com/questions/5268964/stream-audio-to-a-phone-call-android)之类的问题已收到说明无法访问音频的答案。我同意 Android API 绝对不可能做到这一点，但完全不清楚硬件是否完全断开连接。

stackoverflow 用户“artsylar”表示，他们能够修改 Android 操作系统的“框架层”，将录制的音频注入到通话流中，这将是一大进步（请参阅[在正在进行的通话中播放音频剪辑](https://stackoverflow.com/questions/3900564/play-an-audio-clip-onto-an-ongoing-call)，artsylar 对选择的答案）。假设 artsylar 的成功是有效的，那么肯定有一种方法可以通过修改框架来控制呼叫流音频（我假设 Android 源代码中的电话基础框架）。

基本上，我完全同意从应用程序层修改或控制呼叫流是不可能的。但是，我有兴趣在框架或无线电接口层中自定义 Android 操作系统；artsylar 似乎取得了成功，但公开文献中没有解释如何取得成功。鉴于 Android 技术的当前状态，任何人都可以澄清上述内容以实际确定是否可以通过修改核心 Android 操作系统来控制通话音频，以及实现这一目标的良好途径？

我相信对这个问题的最终澄清对开源社区来说是非常有价值的。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-10T21:02:21.543

在某些平台（例如，高通的 MSM8960 和 APQ8064）上，将音频注入语音呼叫上行链路在技术上是可行的。支持存在于硬件级别和设备驱动程序级别。但是要使该功能可用于普通应用程序，您必须创建一个自定义 Android ROM，在其中您已在 Java 层和 Android 的本机层中添加了所有必要的用户空间部分。

所以简短的回答是：不，作为应用程序开发人员没有标准的方法（无论您使用 SDK 还是 NDK）。
如果您正在为 OEM 工作或通过其他方式能够构建和刷新您自己的 Android ROM，您可能可以通过询问您的平台供应商获得所需的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-29T01:29:25.390

这样做非常困难，因为它涉及在 Android 操作系统中处理 Linux 内核。

不仅没有API支持，而且安全问题也不允许这样做。

作为软件工程领域的专业人士，尤其是程序员，我们从不假设任何人在发明上取得成功，并且相关项目在项目被测试之前是有效的。

此外，在通话期间流式传输音频可能会引发智能手机用户和电话服务提供商之间的隐私和安全问题

# spring - 轴调用挂起tomcat

> ID：10544994
> 
> 赞同：0
> 
> 时间：2012-05-11T03:20:41.470
> 
> 标签：spring, apache, tomcat6, axis, freeze

我有使用 apache 轴的 web 服务的 tomcat 应用程序。如果单个用户使用应用程序，一切正常。除一种情况外，多个用户也可以正常工作。我有网络服务调用，可能需要 30 秒。当多个用户调用使用此特定方法的控制器时，两个线程似乎都进入死锁状态。最糟糕的是它会挂起整个应用程序。我能够在本地环境中多次重现这种情况，所以我非常有信心如果多个用户同时请求这个特定的调用块。我还尝试使用轴特定方法 ((Stub)service).setTimeout(1000*60); 在 Web 服务调用中设置超时。但它也不起作用。有没有人遇到过这种情况。我不知道为什么单线程阻塞会挂起整个 tomcat。Tomcat 正在工作，但它停止响应任何其他请求。我正在为我的 Web 应用程序使用 spring。