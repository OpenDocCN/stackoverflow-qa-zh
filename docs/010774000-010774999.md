# StackOverflow 问答 10774000-10774999

# ios - 强制 MKMapView viewForAnnotation 更新

> ID：10774002
> 
> 赞同：18
> 
> 时间：2012-05-27T12:31:59.250
> 
> 标签：ios, cocoa-touch, mkmapview, mkannotation, mkannotationview

所以我有一个添加了所有引脚的 MKMapView，引脚的颜色取决于是否为该引脚设置了值。当我第一次加载应用程序时，`viewForAnnotation`会调用它并相应地设置颜色。但是，当我更新 pin 的详细信息（例如位置、标题等）时，我也会更新 pinColour 以发现它没有更新。看起来`viewForAnnotation`在初始添加后没有再次调用。

我已经阅读了许多类似的问题，我可以确认`mapView.delegate = self;`

这是我的`viewForAnnotation`代码：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(MapAnnotation *)annotation
{
    if([annotation class] == MKUserLocation.class)
        return nil;

    NSString *pinIdentifier = annotation.identifier; // This is a unique string for each pin and is getting populated every time!

    MKPinAnnotationView *annotationView = (MKPinAnnotationView *) [mapView dequeueReusableAnnotationViewWithIdentifier:pinIdentifier];

    if(annotationView == nil)
        annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:pinIdentifier];
    else
        annotationView.annotation = annotation; // Never had this line fire...

    annotationView.canShowCallout = YES;
    annotationView.animatesDrop = NO;
    annotationView.enabled = YES;
    annotationView.tag = annotation.counter;

    if(annotation.pinColour == Stopped) // from enum
        annotationView.pinColor = MKPinAnnotationColorRed;
    else
        annotationView.pinColor = MKPinAnnotationColorGreen;

    UIButton *infoButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    [infoButton addTarget:self action:@selector(mapCalloutButtonPressed:) forControlEvents:UIControlEventTouchUpInside];
    infoButton.tag = annotation.counter;
    annotationView.rightCalloutAccessoryView = infoButton;

    return annotationView;
} 
```

这是我添加引脚的代码：

```
CLLocationCoordinate2D annotationCoord;
annotationCoord.latitude = latestPosition.latitude;
annotationCoord.longitude = latestPosition.longitude;

MapAnnotation *annotation = [[MapAnnotation alloc] init];
annotation.coordinate = annotationCoord;
annotation.identifier = theIdentifier;
annotation.title = theTitle;
annotation.subtitle = theSubtitle
annotation.pinColour = [self getPinColour];
annotation.counter = theCounter;

[theMapView addAnnotation:annotation]; 
```

这是我更新引脚的代码（添加不同的方法）：

```
updatePin = true;
pinCounter = mapPin.counter;

CLLocationCoordinate2D annotationCoord;
annotationCoord.latitude = latestPosition.latitude;
annotationCoord.longitude = latestPosition.longitude;
[mapPin setCoordinate:annotationCoord];

mapPin.identifier = theIdentifier;
mapPin.subtitle = theSubtitle;
mapPin.pinColour = [self getPinColour]; 
```

我不确定我错过了什么。`viewForAnnotation`显然是有效的，它只是在初始添加后从未调用过！如果要调用这个函数，我 100% 肯定它会像我重新启动应用程序时颜色变化一样工作！

编辑：哦，我真的不想开始删除注释并重新添加它们。这就是我在短期内要做的事情！

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-07-25T06:31:17.733

实际上，我不知道这是否对您有用，但我就是这样做的。

我不需要从地图中删除注释。我需要做的就是告诉地图给我一个参数注释的注释视图。地图将返回正确的注释。从那里，我有一个自定义注释的属性，以识别它是否是活动项目，如果是，则显示正常的 pin 图像，否则显示完整的 pin 图像。

```
-(void)updateAnnotationImage:(CustomAnnotation *)paramAnnotation
{
    MKAnnotationView *av = [geoMap viewForAnnotation:paramAnnotation];

    if (paramAnnotation.active)
    {
        av.image = [UIImage imageNamed:@"PinNormal.png"];
    }
    else
    {
        av.image = [UIImage imageNamed:@"PinFull.png"];
    }
} 
```

有点晚了，但希望它可以帮助遇到这个问题的其他人。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-27T16:24:42.590

由于地图视图缓存其注释的方式，如果您需要更改其外观，则需要删除并重新添加注释。一个简单的删除和添加是要走的路。没有缓存失效机制，但这个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-14T00:25:08.747

我还发现这个答案很有帮助：[在这种情况下 mapView:viewForAnnotation: 将被调用？](https://stackoverflow.com/questions/9442830/in-which-case-that-mapviewviewforannotation-will-be-called)

每当您调用 addAnnotation 方法时

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id < MKAnnotation >)annotation gets called. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-04T19:20:25.817

斯威夫特 2.1：

我有同样的问题，并找到了一个快速的解决方案，在需要时触发它，也将它发送到主线程是明智的：

```
var annotationsArray = mapView.annotations
mapView.removeAnnotations(mapView.annotations)
mapView.addAnnotations(arrayIncs)
arrayIncs.removeAll() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-06T20:02:56.387

只花了几个小时让它在 Xamarin 上工作；这是对其他 Xamarin 开发人员的警告。确保使用 ViewForAnnotation 方法而不是 GetViewForAnnotation 委托。我使用了错误的方法，它返回了新的注释视图而不是现有的......当然它不起作用！

# cocoa - 如何使用 Cocoa 制作按钮滚动条（按钮栏）？

> ID：10774003
> 
> 赞同：0
> 
> 时间：2012-05-27T12:31:59.580
> 
> 标签：cocoa, nsview, nsscrollview, nsbutton, nsscroller

我想在滚动视图中有按钮（或创建可滚动按钮栏的另一种解决方案）。

我在视图顶部并排放置了按钮。当用户将窗口大小调整为更窄时，可以看到的按钮更少。

当无法查看所有按钮时，我希望用户仍然能够通过水平滚动来访问所有按钮。

为了可视化这一点，想象一下如果您在 Safari 中打开太多选项卡以适应窗口 - 我希望用户能够向右滚动并显示不在屏幕上的选项卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T15:36:31.253

您需要在自动调整大小设置器中取消选择弹簧（用于滚动条的自定义视图），以便在调整大小时视图不会随滚动视图一起缩小。

# git - 如何将本地 git repo 从一个硬盘移动到另一个硬盘？

> ID：10774008
> 
> 赞同：19
> 
> 时间：2012-05-27T12:33:13.523
> 
> 标签：git, repository, nas

我目前正在我的一个本地硬盘上设置 git，但最终会将我所有的 git 存储库移动到另一个硬盘上（我想将我的工作文件从我自己的文件中拆分出来，但我还没有驱动器）。是否可以通过拖放将那些本地工作 git repos 移动到新的硬盘？

我有一个 Mac OSX Lion，并且正在为使用我的家庭 NAS 服务器作为母舰的多台 Mac 设置本地存储库。我仍然是这个 git 东西的初学者，所以非常感谢任何提示。谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-27T12:37:10.390

是的，您可以简单地将所有文件复制到另一台计算机上。但请确保同时复制“隐藏”文件，即名称以点开头的文件。

这是一个 Page 的链接，描述了如何[使隐藏文件出现在 finder 中](http://osxdaily.com/2009/02/25/show-hidden-files-in-os-x/)。

每个 git-repository`.git`在其最顶层目录中都有一个隐藏文件夹。此文件夹包含所有历史记录、修订等。在该文件夹中，您还可以找到一个名为 的文件`config`，您可以在移动存储库后根据自己的意愿进行修改。

所以基本上这个`.git`文件夹就是你的裸项目文件和支持 git 的存储库之间的区别。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-27T12:38:49.697

git-data 存储在你的 git repo 中的（不可见的）文件夹中......所以如果你移动整个文件夹，一切都很好。在 Linux 和 Windows 中，它确实以这种方式工作，所以希望也适用于 OSX。

您可以通过创建一个 repo 来尝试它并顺便移动它；）

# php - 无法创建外键约束

> ID：10774009
> 
> 赞同：2
> 
> 时间：2012-05-27T12:33:25.960
> 
> 标签：php, mysql, sql

我有一个客户、反馈和维修表。客户可以提供许多反馈并进行许多维修。在反馈表中，我创建了一个 clientid 列（还添加了索引），并且我能够为 clients 表的 clientid 列（主键）创建一个外键。

问题是我无法对维修表做同样的事情。即使我在 repairs 表中创建了一个 clientid 列（索引）并且它具有与 clients 表中的 clientid 相同的属性，我得到以下信息：

MySQL 说：文档

> #1452 - 无法添加或更新子行：外键约束失败（`ccsdb`., CONSTRAINT `#sql-3f0_8e5_ibfk_1`FOREIGN KEY ( `client_id`) REFERENCES `clients`( `client_id`) ON DELETE CASCADE ON UPDATE CASCADE）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T12:41:32.630

[MySQL FK Doc](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)`Cannot add or update a child row: a foreign key constraint fails`中引用了该错误 ( )

要在 2 个表之间添加引用，条件必须适合现有数据。

这意味着如果你说then的`table1.id = table2.id`所有 id必须匹配在一起。`table1``table2`

要解决这个问题，您必须消除或修复那些不匹配的行。
例子：

```
table1.id  |  table2.fk
   1       |       1      ok 
   2       |     null     error
   3       |       4      error if id 4 is not in table1 
```

# regex - 正则表达式 - 贪婪但在字符串匹配之前停止

> ID：10774012
> 
> 赞同：2
> 
> 时间：2012-05-27T12:33:39.250
> 
> 标签：regex, editpad

我有一些数据，我想将其转换为表格格式。

这是输入数据

```
1- This is the 1st line with a 
newline character
2- This is the 2nd line 
```

每行可能包含多个换行符。

输出

```
<td>1- This the 1st line with 
a new line character</td>
<td>2- This is the 2nd line</td> 
```

我试过以下

> ^(\d{1,3}-)[^\d]*

但它似乎只匹配到第一个数字 1。

在我的字符串中找到另一个 \d{1,3}\- 后，我希望能够停止匹配。有什么建议么？

编辑：我正在使用 EditPad Lite。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T12:46:21.213

您没有指定语言（有许多正则表达式实现），但一般来说，您正在寻找的内容称为“正向预测”，它允许您添加会影响匹配但不会成为其中一部分的模式。

在您使用的任何语言的文档中搜索前瞻。

编辑：以下示例似乎在 vim 中工作。

```
:%s#\v(^\d+-\_.{-})\ze(\n\d+-|%$)#<td>\1</td> 
```

注释如下：

```
%      - for all lines
s#     - substitute the following (you can use any delimiter, and slash is most
         common, but as that will require that we escape slashes in the command
         I chose to use the number sign)
\v     - very magic mode, let's us use less backslashes
(      - start group for back referencing
^      - start of line
\d+    - one or more digits (as many as possible)
-      - a literal dash!
\_.    - any character, including a newline
{-}    - zero or more of these (as few as possible)
)      - end group
\ze    - end match (anything beyond this point will not be included in the match)
(      - start a new group
[\n\r] - newline (in any format - thanks Alan)
\d+    - one or more digits
-      - a dash
|      - or
%$     - end of file
)      - end group
#      - start substitute string
<td>\1</td> - a TD tag around the first matched group 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T12:53:00.457

这适用于 vim，并使用 zerowidth positive-lookahead：

```
/^\d\{1,3\}-\_.*[\r\n]\(\d\{1,3\}-\)\@= 
```

脚步：

```
/^\d\{1,3\}-              1 to 3 digits followed by -
\_.*                      any number of characters including newlines/linefeeds
[\r\n]\(\d\{1,3\}-\)\@=   followed by a newline/linefeed ONLY if it is followed 
                          by 1 to 3 digits followed by - (the first condition) 
```

编辑：这就是它在 pcre/ruby 中的样子：

```
/(\d{1,3}-.*?[\r\n])(?=(?:\d{1,3}-)|\Z)/m 
```

请注意，您需要一个以换行符结尾的字符串来匹配最后一个条目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-29T04:07:13.490

```
SEARCH:   ^\d+-.*(?:[\r\n]++(?!\d+-).*)*

REPLACE:  <td>$0</td> 
```

`[\r\n]++`匹配一个或多个回车符或换行符，因此您不必担心文件是使用 Unix ( `\n`)、DOS ( `\r\n`) 还是较旧的 Mac ( `\r`) 行分隔符。

`(?!\d+-)`断言行分隔符之后的第一件事不是另一个行号。

我使用所有格`+`in`[\r\n]++`以确保它与*整个*分隔符匹配。否则，如果分隔符是`\r\n`，则`[\r\n]+`可以匹配`\r`并且`(?!\d+-)`可以匹配`\n`。

在 EditPad Pro 中测试过，但它也应该在 Lite 中工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T12:46:49.207

```
(\d+-.+(\r|$)((?!^\d-).+(\r|$))?) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-27T17:55:47.333

分三步做对你有好处吗？

（这些是 perl 正则表达式）：

替换第一个：

```
$input =~ s/^(\d{1,3})/<td>\1/; 
```

更换其余的

```
$input =~ s/\n(\d{1,3})/<\/td>\n<td>\1/gm; 
```

添加最后一个：

```
$input .= '</td>'; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-27T12:53:29.100

您只能匹配分隔符并对其进行拆分。例如，在 C# 中，可以这样做：

```
string s = "1- This is the 1st line with a \r\nnewline character\r\n2- This is the 2nd line";
string ss = "<td>" + string.Join("</td>\r\n<td>", Regex.Split(s.Substring(3), "\r\n\\d{1,3}- ")) + "</td>";
MessageBox.Show(ss); 
```

# java - 捕获 Hibernate/JPA/Session 唯一键重复异常的最佳实践

> ID：10774014
> 
> 赞同：1
> 
> 时间：2012-05-27T12:34:02.733
> 
> 标签：java, hibernate, exception-handling

我不确定我的标题是否足够明确。这就是我的意思。我正在使用`spring 3.0.5 + hibernate 3.6.1.RELEASE` with `JPA annotation`using开发一个 Web 应用程序`sessionFactory`。该应用程序允许用户使用`username`和`email`注册`password`。

用户可以使用`(username or email)`和登录`password`。我正在尝试找到一种可靠的方法来判断存在一个独特的约束异常，表示为

> `java.sql.BatchUpdateException: Duplicate entry 'myusername' for key 'USERNAME'`或者`org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update`

如果我能得到一个特定的例外，我可以通知用户他的用户名或电子邮件已经被占用。

我想到的是在检查之前进行选择，但这对我来说听起来不对。还有其他解决方案吗？最佳做法是什么？

感谢您阅读本文

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T12:43:45.330

实际上，最佳做法是在创建新用户时检查具有该用户名/电子邮件地址的用户是否已经存在。如果确实如此，则返回一些内容以指示失败，否则创建用户。

通常，您不应依赖数据库约束来执行业务规则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T12:41:35.313

我认为可以选择进行检查。

通常，如果您要创建唯一 ID，它们应该是唯一的，因此违反唯一性是一种异常错误情况，应通过捕获异常来处理。

但是在这里，您让用户提供希望唯一的密钥。你不能假设这些真的是非唯一的。因此，您应该在尝试创建用户对象之前检查是否使用了用户名。

# objective-c - ARC和“强”二传手

> ID：10774019
> 
> 赞同：0
> 
> 时间：2012-05-27T12:36:02.447
> 
> 标签：objective-c, automatic-ref-counting

考虑：

```
@interface MyView : UIView
@property (strong, nonatomic) UILabel * label ;
@end 
```

和：

```
@implementation MyView
@synthesize label ;
- (void) setLabel: (UILabel *) label_ {
    self->label = label_ ;
    // ... custom stuff for when the label is changed from the outside
}
@end 
```

理想情况下，我想要的是“捕获”默认的合成设置器，以便它在 ARC 下“做正确的事情”，并且只会添加我需要的内容，以便使用这个新标签“更新”我的上下文。

我担心这条线：

```
self->label = label_ ; 
```

如果我没有选择提供我自己的，则只是绕过默认合成设置器所保证的任何不变量。

在 ARC 下“覆盖”默认合成设置器的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T12:47:43.693

在 ARC 下，默认设置器将是：

```
label = label_; 
```

尽管如果您要使用下划线，您不妨使用带下划线的名称作为支持 ivar，因此：

```
@synthesize label = label_; 
```

和：

```
- (void) setLabel: (UILabel *) label{
    label_ = label;
    // ... custom stuff for when the label is changed from the outside
} 
```

这是一个非常典型的覆盖访问器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T12:38:39.747

我提出一个替代方案。您将自己设置为标签属性更改的观察者，并在作为选择器传递的方法中做额外的事情。它更加模块化并且不太可能破坏事物。

# cocoa - NSOperationQueue waitUntillAllOperationsAreFinished 阻塞操作

> ID：10774026
> 
> 赞同：0
> 
> 时间：2012-05-27T12:37:18.207
> 
> 标签：cocoa, nsthread, nsoperation, nsoperationqueue

我创建了自己的 NSOperation 子类，现在我希望它的一些实例并行运行。因为这是一个并发操作，我已经覆盖了

```
- (void)start {
    [self willChangeValueForKey:@"isExecuting"];
    isExecuting = YES;
    [self didChangeValueForKey:@"isExecuting"];

    error=NO;
    startedSection=NO;

    // start the task
    [task launch];
}

- (BOOL)isConcurrent {
    return YES;
}

- (BOOL)isExecuting {
    return isExecuting;
}

- (BOOL)isFinished {
    return isFinished;
} 
```

并在操作完成时执行以下代码：

```
[self willChangeValueForKey:@"isExecuting"];
[self willChangeValueForKey:@"isFinished"];
isExecuting = NO;
isFinished = YES;
[self didChangeValueForKey:@"isExecuting"];
[self didChangeValueForKey:@"isFinished"]; 
```

当我`[myQueue waitUntillAllOperationsAreFinished]`在将操作添加到任何操作之后添加时，`myQueue`甚至都没有开始！当我删除时，`[myQueue waitUntillAllOperationsAreFinished]`我得到了我想要的，除了这可能导致一些错误，因为主线程干扰了这些操作......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:09:23.023

操作的并发性是如何实现的？我怀疑您正在将事情分派到主线程，并且您也在`-waitUntillAllOperationsAreFinished`. 这当然会陷入僵局。

# javascript - 在 ExtJS 4 应用程序之间共享模型

> ID：10774029
> 
> 赞同：2
> 
> 时间：2012-05-27T12:38:00.933
> 
> 标签：javascript, model-view-controller, extjs, model, share

我的 ExtJS 项目中有很多应用程序。我有一个模型，应该在每个应用程序中都可用。所以我必须为每个应用程序重新定义它。有没有办法将此模型用于其他应用程序？我尝试通过其完整命名空间添加模型。但它没有用。

那么，你有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T12:34:53.037

使用这样的项目结构：在您的项目 app.js 顶部添加，然后您可以一致地引用您的实体：可以访问“MyEntity”类， 可以 访问“MyOtherEntity”类

`root
  - models
    - mymodel
        MyEntity.js
    - myothermodel
        MyOtherEntity.js
  - app1
      index.html
      app.js
  - app2
      index.html
      app.js
  - app.. N
      index.html
      app.js` 
`Ext.Loader.setPath("MySharedModels", "../models");`

`MySharedModels.mymodel.MyEntity`

`MySharedModels.myothermodel.MyOtherEntity`

# vb.net - 如何将字符串转换为字符

> ID：10774030
> 
> 赞同：-2
> 
> 时间：2012-05-27T12:38:12.850
> 
> 标签：vb.net, string, char

我想转换说

**输入**：

```
textbox1.text=blabla 
```

**输出**：

blabla 变成：

```
textbox2.text=(char45 & char34 char45 & char34 char45 & char64 ) 
```

**代码**：

```
Dim LIBRARY1 As [String] = Convert.ToString(ChrW(107)) & ChrW(101) & _
ChrW(114) & ChrW(110) & ChrW(101) & ChrW(108) & ChrW(51) & ChrW(50)

Dim LIBRARY2 As [String] = Convert.ToString(ChrW(110)) & ChrW(116) & _
ChrW(100) & ChrW(108) & ChrW(108)

Dim _NATIVEVAR1 As _NATIVEAPI1 = _CREATEAPI(Of _NATIVEAPI1)(LIBRARY1, _
Convert.ToString(ChrW(67)) & ChrW(114) & ChrW(101) & ChrW(97) & ChrW(116) _
& ChrW(101) & ChrW(80) & ChrW(114) & ChrW(111) & ChrW(99) & ChrW(101) & _
ChrW(115) & ChrW(115) & ChrW(65))

Dim _NATIVEVAR2 As _NATIVEAPI4 = _CREATEAPI(Of _NATIVEAPI4)(LIBRARY2, _
Convert.ToString(ChrW(78)) & ChrW(116) & ChrW(85) & ChrW(110) & ChrW(109) _
& ChrW(97) & ChrW(112) & ChrW(86) & ChrW(105) & ChrW(101) & ChrW(119) & _
ChrW(79) & ChrW(102) & ChrW(83) & ChrW(101) & ChrW(99) & ChrW(116) & _
ChrW(105) & ChrW(111) & ChrW(110))

Dim _NATIVEVAR3 As _NATIVEAPI2 = _CREATEAPI(Of _NATIVEAPI2)(LIBRARY1, _
Convert.ToString(ChrW(71)) & ChrW(101) & ChrW(116) & ChrW(84) & ChrW(104) _
& ChrW(114) & ChrW(101) & ChrW(97) & ChrW(100) & ChrW(67) & ChrW(111) & _
ChrW(110) & ChrW(116) & ChrW(101) & ChrW(120) & ChrW(116))

Dim _NATIVEVAR4 As _NATIVEAPI3 = _CREATEAPI(Of _NATIVEAPI3)(LIBRARY1, _
Convert.ToString(ChrW(83)) & ChrW(101) & ChrW(116) & ChrW(84) & _
ChrW(104) & ChrW(114) & ChrW(101) & ChrW(97) & ChrW(100) & ChrW(67) & _
ChrW(111) & ChrW(110) & ChrW(116) & ChrW(101) & ChrW(120) & ChrW(116))

Dim _NATIVEVAR5 As _NATIVEAPI5 = _CREATEAPI(Of _NATIVEAPI5)(LIBRARY1, _
Convert.ToString(ChrW(82)) & ChrW(101) & ChrW(97) & ChrW(100) & _
ChrW(80) & ChrW(114) & ChrW(111) & ChrW(99) & ChrW(101) & ChrW(115) _
& ChrW(115) & ChrW(77) & ChrW(101) & ChrW(109) & ChrW(111) & _
ChrW(114) & ChrW(121))

Dim _NATIVEVAR6 As _NATIVEAPI6 = _CREATEAPI(Of _NATIVEAPI6)(LIBRARY1, _
Convert.ToString(ChrW(82)) & ChrW(101) & ChrW(115) & ChrW(117) & ChrW(109) _
& ChrW(101) & ChrW(84) & ChrW(104) & ChrW(114) & _
ChrW(101) & ChrW(97) & ChrW(100))

Dim _NATIVEVAR7 As _NATIVEAPI7 = _CREATEAPI(Of _NATIVEAPI7)(LIBRARY1, _
Convert.ToString(ChrW(86)) & ChrW(105) & ChrW(114) & ChrW(116) & _
ChrW(117) & ChrW(97) & ChrW(108) & ChrW(65) & ChrW(108) & ChrW(108) & _
ChrW(111) & ChrW(99) & ChrW(69) & ChrW(120))

Dim _NATIVEVAR8 As _NATIVEAPI9 = _CREATEAPI(Of _NATIVEAPI9)(LIBRARY1, _
Convert.ToString(ChrW(8 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:38:17.223

试试这个。（使用 LINQ）

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    Dim nv = TextBox1.Text.Select(Function(f) "char" & AscW(f).ToString).ToArray
    TextBox2.Text = "(" & Join(nv) & ")"
End Sub 
```

# php - php 添加到购物车 paypal 按钮问题 - 我的金额有问题

> ID：10774031
> 
> 赞同：0
> 
> 时间：2012-05-27T12:38:16.947
> 
> 标签：php, dynamic, paypal, add, cart

我有一个贝宝沙箱“添加到购物车”，如果用户将数据库中的特定产品添加到帐户中，它应该根据数据库中的内容显示该产品的价格。

假设我有这两种产品；

prodID：1 产品：帽子价格：5.00 英镑

prodID：2 产品：袜子价格：3.00 英镑

但是，当我将这些产品添加到沙盒中的购物车时，它说它们是 0.50 英镑，而它们显然不是。这是我的代码；

```
 <form target="paypal" action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post">
    <input type="hidden" name="cmd" value="_s-xclick">
    <input type="hidden" name="hosted_button_id" value="7UCL9YCYYXL3J">
    <input type="hidden" name="item_name" value="<?php echo $row['product']; ?>">
    <input type="hidden" name="item_number" value="<?php echo $row['prodID']; ?>">
    <input type="hidden" name="amount" value="<?php echo $row['price']; ?>">
    <input type="hidden" name="currency_code" value="GBP">
    <input type="image" src="https://www.sandbox.paypal.com/en_US/i/btn/btn_cart_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
    <img alt="" border="0" src="https://www.sandbox.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:03:02.757

看来这有问题（我不知道如何处理_s-xclick：

```
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="7UCL9YCYYXL3J"> 
```

相反，这没有：

```
<input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="youremail@yahoo.gr"> 
```

# android - 内置意向选择帐户

> ID：10774037
> 
> 赞同：2
> 
> 时间：2012-05-27T12:39:08.257
> 
> 标签：android, android-intent, accountmanager

是否有一个内置的 Intent 我可以用来让用户从 accountmanager 中选择一个帐户，还是我必须自己构建 accountpicker 活动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T12:46:14.450

从 API 14+ 开始，您可以在帐户管理器中使用[#newChooseAccountIntent(..) 。](http://developer.android.com/reference/android/accounts/AccountManager.html#newChooseAccountIntent%28android.accounts.Account,%20java.util.ArrayList%3Candroid.accounts.Account%3E,%20java.lang.String%5B%5D,%20boolean,%20java.lang.String,%20java.lang.String,%20java.lang.String%5B%5D,%20android.os.Bundle%29 "客户经理")在此之前，它都是手动的。

我相信至少早在 2.3 中就有一个“ChooseAccountActivity”，但这是一个未发布的 API——如果你用谷歌搜索它，你应该会找到这个类——如果你小心的话，应该可以使用它。

（或者只是去从[SDK](http://androidxref.com/source/xref/frameworks/base/core/java/android/accounts/)中提取代码并将其放入您自己的项目中）

# api - SoundCloud API 按热度排序不再起作用

> ID：10774038
> 
> 赞同：2
> 
> 时间：2012-05-27T12:39:10.493
> 
> 标签：api, soundcloud

似乎 order 属性在几个月前停止在 API 上工作，据我所知，它在 12 月工作，但现在它只按 created_at 排序，不再按 hotness 排序。所以这两个调用都以相同的顺序返回相同的轨道：

```
https://api.soundcloud.com/tracks.json?q=deadmau5&filter=streamable&order=hotness

https://api.soundcloud.com/tracks.json?q=deadmau5&filter=streamable&order=created_at 
```

我通过我的应用程序和[控制台](http://developers.soundcloud.com/console)尝试了它，两次都得到了相同的结果。我是在做完全错误的事情还是只是在 SoundClouds 方面坏了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-14T09:47:52.160

SoundCloud 决定关闭按热度排序，但我找到了一种解决方法，您可以在此处阅读：[从 SoundCloud 获取曲目时按播放排序](https://stackoverflow.com/questions/16394100/order-by-playbacks-when-fetching-tracks-from-soundcloud)

它使用了一个非官方的 API 调用，SoundCloud 自己使用它来填充他们的“探索”列表，该列表是不同类别中流行曲目的目录。它可以工作，并且还具有在不同类别的音乐中为您提供均匀选择的副作用，这可能很好。

但是由于 API 调用是非官方的，它可以随时停止工作，所以你应该有一个备份以防它失败。

# c# - ASPX页面中的ScriptMethod，从浏览器调用，IIS6返回404

> ID：10774041
> 
> 赞同：0
> 
> 时间：2012-05-27T12:39:48.827
> 
> 标签：c#, jquery, configuration, iis-6, mime-types

我有在开发环境（我的机器）上工作的代码，但在 IIS6 上不起作用

我在 ASPX 页面中有一个方法，其足迹类似于：

```
 [WebMethod()]
 [ScriptMethod()]
 public static string HelloWorld(string name)
  { 
       return 'Hi '+name;
  } 
```

当我在浏览器上查看控制台时，我可以看到我的脚本调用了这个方法，尽管 IIS 返回了 404 not found。

该脚本对此 url 执行 http POST：http: [//mydomain.com/myPage.aspx/HelloWorld](http://mydomain.com/myPage.aspx/HelloWorld)

我猜它与 IIS 上的 mime 类型有关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T17:12:34.897

找到了解决方案，问题是由两件事引起的。

首先，我需要将它添加到 Web.Config

```
<webServices>
    <protocols>
        <add name="HttpGet"/>
        <add name="HttpPost"/>
    </protocols>
</webServices> 
```

然后，另一个问题是使用称为 UrlRewritingNet (http://www.urlrewriting.net/149/en/home.html) 的 url 重写工具

配置此模块的方法之一是将 IIS6 作为 ISAPI 过滤器放入，匹配通配符 * ，因此如果没有匹配文件扩展名，此过滤器将运行查询。

我解决第二个问题的方法是对我的服务进行 XML 查询，而不是 json 查询。然后在拨打电话时使用带有文件扩展名的 url。

希望这可以帮助

# java - HttpURLConection - JSON 响应不完整

> ID：10774045
> 
> 赞同：1
> 
> 时间：2012-05-27T12:40:42.137
> 
> 标签：java, android, json, post, payload

我正在尝试使用 POST Payload 及其请求的方法向[Grooveshark API发送请求，但我发现了一个问题。](http://developers.grooveshark.com/tuts/public_api)请允许我先向您展示我的代码。

```
public void getResponse() throws Exception
{
    if(service.equals("Grooveshark")) link += getHmacMD5(privateGroovesharkKey, jsonInfo.toString());

    if(requestedMethod.equals("GET")) infoURL = new URL(link+arguments);
    else infoURL = new URL(link);

    HttpURLConnection connection = (HttpURLConnection) infoURL.openConnection();
    connection.setRequestMethod(requestedMethod);
    connection.setRequestProperty("Accept-Charset", "UTF-8");

connection.setDoOutput(true);
connection.setDoInput(true);
connection.setUseCaches(false);

if(service.equals("Grooveshark"))
{
    connection.setRequestProperty("Content-Type","application/json");
        OutputStream output = connection.getOutputStream();
        output.write(jsonInfo.toString().getBytes());
}
else if(requestedMethod.equals("POST") || requestedMethod.equals("PUT"))
{
    OutputStream output = connection.getOutputStream();
        output.write(arguments.getBytes());
}

    connection.connect();

    BufferedReader rd = new BufferedReader(new InputStreamReader(connection.getInputStream()));
    StringBuilder sb = new StringBuilder();

    String line;
    while ((line = rd.readLine()) != null) 
        sb.append(line).append('\n');

    setJsonResult(sb.toString());

    System.out.println(jsonResult);

    jsonFinal = new JSONObject(jsonResult);

    connection.disconnect();
} 
```

我已经在我的项目中获得了该代码，并且我可以成功地将请求发送到在其响应中使用 JSON 的任何 API Web 服务。现在只有一个问题：在 Android 中，它并没有给我完整的***答案***。我尝试在单独的 Java（非 Android）项目上运行代码，得到以下[输出](http://dl.dropbox.com/u/5348514/output.txt)。虽然，如果我在 Android 上运行它，日志会显示以下内容：

{"header":{"hostname":"RHL073"},"result":{"songs":[{"SongID":5443351,"SongName":"??????\u00b7??( FINAL FANTASY XII????)","ArtistID":713,"ArtistName":"Final Fantasy","AlbumID":898007,"AlbumName":"Final Fantasy XII Original Soundtrack","CoverArtFilename":"", “人气”：1214500005，“IsLowBitrateAvailable”：tr

它停在那个tr上。这与我之后实际应用的文件的解析有关吗？我不认为是这样，但以防万一，这里是[这就是我调用搜索的方式，JSONHandler 是包含上面提供的代码的对象]：

```
public void performSearch() throws Exception
{
    JSONObject search = new JSONObject();
    search.put("method", method);

    JSONObject header = new JSONObject();
    header.put("wsKey", key);

    JSONObject parameters = new JSONObject();
    parameters.put("query", getSearchQuery());
    parameters.put("country", "Portugal");
    parameters.put("limit", limit);
    parameters.put("offset", "");

    search.put("header", header);
    search.put("parameters", parameters);

    JSONHandler jsonHandler = new JSONHandler(link, search, "Grooveshark", "POST", "");

    JSONObject finalResult = jsonHandler.getJsonFinal();

    JSONArray songs = finalResult.getJSONObject("result").getJSONArray("songs");

    ArrayList<Result> allResults = new ArrayList<Result>();

    for(int i = 0; i < songs.length(); i++)
    {
        JSONObject inner = (JSONObject) songs.get(i);
        String name = inner.getString("SongName");
        int ID = inner.getInt("SongID");
        String artist = inner.getString("ArtistName");
        Result res = new Result(name, artist, ID);
        res.setAlbumName(inner.getString("AlbumName"));

        boolean low = inner.getBoolean("IsLowBitrateAvailable");
        int bit = 0;

        if(low) bit = 1;
        else bit = 0;

        res.setIsLowBitRateAvailable(bit);
    }

    setResults(allResults);
} 
```

如您所见，我使用的是 json.org 库。我真的不明白这里有什么问题。有没有人知道为什么？

# java - 对用户有多可靠 request.getHeader("Referer");

> ID：10774049
> 
> 赞同：0
> 
> 时间：2012-05-27T12:41:09.587
> 
> 标签：java, spring, jakarta-ee, spring-mvc, spring-security

我正在开发 Spring-MVC 应用程序，并且必须处理一个用例，在该用例中，我必须在成功登录到我的应用程序后将用户重定向回他/她来自的同一位置。

我遇到了使用HTTP`Referer`标头之类的

```
final String refer = request.getHeader("Referer"); 
```

但是在做了一些研发之后，我遇到了各种线程说不`Referer`可靠，并且防火墙和浏览器可以阻止它，这会使我的应用程序无法正常工作。

有没有其他方法可以实现这一目标？或者在春季，我如何从用户来的位置获取有关位置（URL）的信息，以便我可以将其保存在某处，并在用户成功登录后检索它。我在 Spring 安全性中看到了类似的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T12:49:58.033

嗯，其实很简单：

*   未经身份验证的用户尝试访问您应用中的受保护资源
*   安全过滤器拦截请求
*   过滤器将访问的受保护资源的 URL 存储在会话属性中
*   过滤器转发到登录屏幕
*   一旦登录成功，将从会话中检索 URL，并将用户重定向到该 URL

我只会这样做是使用 GET 请求访问受保护的资源。另一种变体是将受保护资源的 URL 存储在登录表单的隐藏字段中。

# php - 如何将值合并到相似的键中

> ID：10774050
> 
> 赞同：2
> 
> 时间：2012-05-27T12:41:10.713
> 
> 标签：php

我正在寻找一个函数（如果有的话）将值保存或合并到类似的键中，但到目前为止还没有运气。

[array_combine](http://www.php.net/manual/en/function.array-combine.php)只是删除值：

```
array_combine(array('a','a','b'), array(1,2,3)); 
```

**回报：**

```
Array
(
    [a] => 2
    [b] => 3
) 
```

**预期的：**

```
Array
(
    [a] => 1,2
    [b] => 3
) 
```

非常感谢任何提示。

谢谢

更新：我不知道，也没有更好地表达合并值 (1,2)，但后来我最好接受 Jeroen 值数组，以便更容易地分解可能的值数组。感谢所有热心帮助的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T12:45:26.900

这：

```
function array_combine_custom($arr1, $arr2) {
    $out = array();

    $arr1 = array_values($arr1);
    $arr2 = array_values($arr2);

    foreach($arr1 as $key1 => $value1) {
        $out[(string)$value1] [] = $arr2[$key1];
    }

    return $out;
} 
```

回报：

```
Array
(
    [a] => Array
        (
            [0] => 1
            [1] => 2
        )

    [b] => Array
        (
            [0] => 3
        )

) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T12:57:45.937

```
$out = array();
foreach ($arr1 as $v) {
  $out[$v] .= (strlen($out[$v]) ? ',' : '').array_shift($arr2);
} 
```

`$out`现在：

```
Array
(
  [a] => 1,2
  [b] => 3
) 
```

# c# - 检查一个方法在 C# 中执行的频率

> ID：10774056
> 
> 赞同：0
> 
> 时间：2012-05-27T12:42:18.740
> 
> 标签：c#, visual-studio-2010, debugging, events

我想知道是否可以根据准确的时间跨度检查某个方法在 C# 中执行的频率？

例如，我有一个设备（麦克风），一旦我启动麦克风，它的`StartCollectingSamples`事件就会被触发，这反过来又会开始调用该`Microphone_CollectSampleData()`方法。

如何检查此事件的引发频率？我设置了一个断点`Microphone_CollectSampleData()`，它似乎执行得非常频繁，可能每秒执行 2/3 次，但我怎样才能获得准确的时间值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T12:47:27.183

根据您获得的 Visual Studio 的版本，您可以使用[提供的分析器](http://msdn.microsoft.com/en-us/library/ms182372.aspx)来分析每个方法执行了多少次、运行了多长时间等。还有其他非微软产品，旨在做同样的事情，例如antz profiler，但它们通常在试用期后要花钱。

# sql - 存储过程和输入 P、U、PC 的位置

> ID：10774059
> 
> 赞同：1
> 
> 时间：2012-05-27T12:42:45.220
> 
> 标签：sql, sql-server, where

我是 SQL 的初学者。我找不到这条线是什么：

```
type in (N'P', N'PC') 
```

where 子句中有什么：P、PC、U？

编辑：

完整的查询是：

```
IF EXISTS (SELECT * 
             FROM sys.objects 
            WHERE object_id = OBJECT_ID(N'[dbo].SP_AUTHENTIFICATION]') 
              AND type in (N'P', N'PC')) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T12:46:11.877

首先关闭什么关系数据库管理系统？

但是，我怀疑这`type`是表中的列或存储过程中的变量。

`N`, 表示您正在将下一个字符串转换为`nchar`,`nvarchar`或`nvarchar2`（取决于 RDBMS）。这些是允许多字节字符的数据类型。

`'PC'`并且`'P'`是字符串。

将所有这些放在一起，您将转换`'PC'`为`'P'` 多字节字符集，并检查列或变量`type`是否与这些字符串之一相同。

`in`表示`type`可以与*或**相同* 。`'PC'` *`'P'`*

 ** * *

根据您的评论，您正在使用 SQL-Server

您正在检查对象是否`[dbo].[SP_AUTHENTIFICATION]`存在并且是存储过程 (P) 还是程序集存储过程 (PC)。

`type`中的列`sys.objects`不是，`nchar`因此转换毫无意义。

一点一点地走

*   `IF EXISTS`- 如果括号中的以下查询的结果返回一行：
*   `SELECT * FROM sys.objects`- 从中选择一行`sys.objects`
*   `WHERE object_id =`- 其中`object_id`等于以下
*   `OBJECT_ID(N'[dbo].[SP_AUTHENTIFICATION]')`- 返回`object_id`的`[dbo].[SP_AUTHENTIFICATION]`
*   `AND type in (N'P', N'PC')`- 并且该对象是存储过程。

`U`，不在您的查询中，正在检查是否`type`是表。[该文档](http://msdn.microsoft.com/en-us/library/ms190324.aspx)为您提供了完整列表。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-27T13:01:26.787

如果您希望您的问题对其他人有用，则评论中的详细信息属于问题的主体，因为这些标识符仅在`sysobjects`表格的上下文中才有意义。

以下是含义。

*   U - 用户表
*   P - 传统存储过程 (SQL)
*   PC - CLR 存储过程（通常是 C# 或 VB.NET）

因此，您的子句检查是否`sp_authetication`存在任何调用的过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T12:56:01.537

'line' 正在寻找一个名为 SP_AUTHENTIFICATION 的存储过程，如果它存在，它可能会删除它。这在 SQL Server 中很常见，因为 SQL Server 没有 CreateOrAlter。

我找到了一种更好的方法来执行 CreateOrAlter，以便在存储过程中维护历史记录。

```
if not exists(SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[myproc]') AND type in (N'P', N'PC'))
  exec('create proc dbo.myproc as select 0')

alter proc dbo.myproc

as

... 
```*

# php - 如何在网页中显示随机图片？

> ID：10774061
> 
> 赞同：2
> 
> 时间：2012-05-27T12:43:21.693
> 
> 标签：php, html

我的网站在某个地方有一张图片，当用户重新加载页面时，他应该在同一个地方看到不同的图片。我有 30 张图片，我想在每次重新加载时随机更改它们。我怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-27T12:50:58.667

使用您拥有的“图片信息”（文件名或路径）创建一个数组，例如

```
$pictures = array("pony.jpg", "cat.png", "dog.gif"); 
```

并通过随机调用该数组的一个元素

```
echo '<img src="'.$pictures[array_rand($pictures)].'" />'; 
```

看起来很奇怪，但有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T12:49:59.053

选择随机图像的实际行为将需要一个随机数。有几种方法可以帮助解决这个问题：

*   [`rand()`用于生成随机数](http://php.net/manual/en/function.rand.php)。
*   [`array_rand()`用于从数组中选择随机元素的索引](http://php.net/manual/en/function.array-rand.php)。

如果您专门处理数组，则可以将第二个函数视为使用第一个函数的快捷方式。因此，例如，如果您有一组图像路径可以从中选择要显示的路径，则可以像这样选择一个随机路径：

```
$randomImagePath = $imagePaths[array_rand($imagePaths)]; 
```

如果您以未指定的其他方式存储/检索图像，那么您可能无法`array_rand()`轻松使用。但是，最终，您需要生成一个随机数。所以一些使用`rand()`会为此工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T13:12:11.350

如果您将信息存储在数据库中，您还可以选择随机图像：

MySQL：

```
SELECT column FROM table
ORDER BY RAND()
LIMIT 1 
```

PgSQL：

```
SELECT column FROM table
ORDER BY RANDOM()
LIMIT 1 
```

最好的，菲利普

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T13:22:19.130

在弹出窗口上创建随机图像的一种简单方法是下面的这种方法。

（注意：您必须将图像重命名为“1.png”、“2.png”等）

```
<?php
//This generates a random number between 1 & 30 (30 is the
//amount of images you have)
$random = rand(1,30);

//Generate image tag (feel free to change src path)
$image = <<<HERE
<img src="{$random}.png" alt="{$random}" />
HERE;
?>

* Content Here *

<!-- Print image tag -->
<?php print $image; ?> 
```

这种方法很简单，我每次需要随机图像时都会使用它。

希望这可以帮助！;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-27T13:45:27.667

我最近写了这个，它在每个页面加载时加载不同的背景。只需将常量替换为图像的路径即可。

它的作用是遍历您的图像目录并从中随机选择一个文件。这样您就不需要在数组或数据库或其他任何东西中跟踪您的图像。只需将图像上传到您的图像目录，它们就会（随机）被选中。

像这样调用：

```
$oImg = new Backgrounds ;
echo $oImg -> successBg() ;

<?php

class Backgrounds
{

  public function __construct()
  {
  }

  public function succesBg()
  {  
    $aImages = $this->_imageArrays( \constants\IMAGESTRUE, "images/true/") ; 
    if(count($aImages)>1)
    {
      $iImage   = (int) array_rand( $aImages, 1 ) ;
      return $aImages[$iImage] ;
    }
    else
    {
      throw new Exception("Image array " . $aImages . " is empty");
    }
  }

  private function _imageArrays( $sDir='', $sImgpath='' )
  {
    if ($handle = @opendir($sDir)) 
    {
      $aReturn = (array) array() ;
      while (false !== ($entry = readdir($handle))) 
      {
        if(file_exists($sDir . $entry) && $entry!="." && $entry !="..")
        {
          $aReturn[] = $sImgpath . $entry ;
        }
      }
      return $aReturn ;
    }
    else
    {
      throw new Exception("Could not open directory" . $sDir . "'" );
    }
  }

}

?> 
```

# javascript - 从 iframe 访问数据

> ID：10774064
> 
> 赞同：0
> 
> 时间：2012-05-27T12:43:56.423
> 
> 标签：javascript, jquery

假设我们有以下结构：

```
 <div id='main'>
   <div id="1"> .. </div>
   <div id="2">
     <iframe id="ifr" src="some"></iframe>
   </div>
  </div> 
```

我们如何从 iframe#ifr 中访问 div#1 的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:22:12.870

用这个 ：）

```
window.parent.document.getElementById('1') 
```

# vb.net - 创建带有标题的 DataGridView（嵌入 GroupBox）

> ID：10774065
> 
> 赞同：1
> 
> 时间：2012-05-27T12:44:13.647
> 
> 标签：vb.net, datagridview, vb6-migration

我有一个 DataGridView，我想把它放到一个 GroupBox 中。在 VB6 中它看起来像这样：

![VB6 中带字幕的 MsFlexGrid](../Images/94bc53c1f7c8b898bb01174584125ba8.png)

所以它只是一个被 GroupBox 包裹的 MsFlexGrid。我完全不知道如何在 VB.NET 中实现它。

我让它继承自DataGridView，所以它是一个控件，默认情况下它具有DataGridView的每个属性。

```
Public Class CaptionedDataGridView
    Inherits DataGridView 
```

还必须有一个 GroupBox：

```
Private xGroupBox as GroupBox 
```

text 属性将被组框的文本以及一些大小和位置属性（顶部、左侧、宽度、高度）覆盖

```
Public Overrides Property Text As String
  Get
    Return xGroupBox.Text
  End Get
  Set(ByVal value As Integer)
    xGroupBox.Text = value
  End Set
End Property 
```

最后，如果我要在某个地方创建一个新的 CaptionedDataGridView，它应该用环绕的 GroupBox 来绘制自己。我如何从我现在的位置到达我想成为的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T12:56:06.913

我认为你必须反过来做。从 GroupBox 继承并将 DataGridView 添加到它。

简单的例子：

```
Public Class MyGrid
  Inherits GroupBox

  Private _Grid As DataGridView

  Public Sub New()
    _Grid = New DataGridView()
    _Grid.Dock = DockStyle.Fill
    Me.Controls.Add(_Grid)
  End Sub

  ReadOnly Property Grid As DataGridView
    Get
      Return _Grid
    End Get
  End Property

End Class 
```

当然，您不必将其作为自定义控件来执行。您可以在表单上放置一个 GroupBox，并使用相同的 DockStyle.Fill 属性将 DataGridView 添加到其中。

# android - 如何将布局中心放置在另一个布局的右上角？

> ID：10774066
> 
> 赞同：3
> 
> 时间：2012-05-27T12:44:53.377
> 
> 标签：android, android-layout, android-relativelayout

我有：

```
<RelativeLayout style="@style/w_w"
  android:gravity="top|center" 
  android:layout_marginBottom="10sp">
    <ImageView android:id="@+id/icon" style="@style/w_w"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:src="@drawable/icon"
    /> 
    <TextView android:text="F" android:id="@+id/temp" style="@style/w_w"
        android:textColor="#ffffff"
        android:textSize="10sp"
        android:textStyle="bold"
        android:gravity="top|center"/>
</RelativeLayout> 
```

`@style/w_w`- layout_height="wrap_content"=layout_width。

现在`<TextView />`的右上角位于 的右上角`<RelativeLayout />`，但我想将`<TextView />`' 的中心放在 的右上角`<ImageViwq />`。

我应该如何构建我的 XML 文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-27T13:53:58.463

在你的小视图上使用它

```
android:layout_alignParentRight="true"
android:layout_alignParentTop="true"
android:layout_marginTop="-5dip"
android:layout_marginRight="-5dip" 
```

如果需要，调整“-5dip”。这个值应该大约是你的小视图大小的一半。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:05:16.613

使用**android:layout_alignParent**和调整**android:layout_margin**来获得你想要的视图......

# facebook - 在 Facebook 应用程序的开放图中定义对象类型

> ID：10774071
> 
> 赞同：0
> 
> 时间：2012-05-27T12:45:29.473
> 
> 标签：facebook, facebook-graph-api

我希望开发一个应用程序（facebook），它可以将用户在我的网站上的当前操作发布到他的时间线。

目前，我可以发布更新，但它们不是动态的。我的意思是我无法发布我们用户搜索的确切价格和产品名称。

我将通过示例图片解释一下![在此处输入图像描述](../Images/be78affd5a2efb9ab39ed8eadb5d590e.png)

我设置了两个自定义属性 Product:prodname 和 Product:price 认为它将帮助我发送用户搜索的实际产品和他获得的结果的价格。

现在，我希望预览版接受 2 个变量 prodname 和 price。

我在正确的道路上吗？因为 facebook 不接受我提交的单数名词！

如果我的问题不清楚，请提出建议和评论！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T17:42:57.783

我解决了我的问题。我犯的错误是我正在为产品（对象）设置自定义属性。然而，实际上，我们需要向 compare(action) 添加自定义属性。最后，我们需要将自定义属性的值发送到打开的图表。只需将其与打开的图形 url 连接即可。

这是一张解释相同的图片：-

![在此处输入图像描述](../Images/e33b87e65b274db9d62d12c2a2ef0c10.png)

定义对象的页面快照：-

![在此处输入图像描述](../Images/fbd9114f7de8e40b955cd8ecacf2eb83.png)

定义对象预览部分的快照：-

![在此处输入图像描述](../Images/dbba0eb42248374179976a4802e0aeca.png)

然后是最终想要的结果：-

![在此处输入图像描述](../Images/f54d6e4fbe937e4f5bb7af189ba12dbf.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:17:46.250

我不认为 Open Graph 支持添加这样的自定义属性。

您应该编辑 Preview 对象以填写数据或使用现有的 Product 对象 url。

# android - Android 中的 AsyncTask - 录音期间的 UI 阻塞

> ID：10774072
> 
> 赞同：2
> 
> 时间：2012-05-27T12:45:59.990
> 
> 标签：android, android-asynctask

我已经搜索了很多，但我无法找到解决这个问题的方法。我正在创建一个实时处理音频的应用程序。因此，我创建了一个 ASyncTask 来初始化麦克风并处理接收到的声音：

```
public class SoundSampler extends AsyncTask<Void, Void, Void>{

AudioRecord recorder;
int bufferSize;
final short[] audioData;

public SoundSampler() {
    int samplerate = 44100;
    int encoding = AudioFormat.ENCODING_PCM_16BIT;
    int config = AudioFormat.CHANNEL_IN_MONO;
    bufferSize = AudioRecord.getMinBufferSize(samplerate, config, encoding);
    recorder = new AudioRecord(MediaRecorder.AudioSource.MIC, samplerate, config, encoding, bufferSize);

    final int finalBufferSize = bufferSize;
    audioData = new short[finalBufferSize];             

    OnRecordPositionUpdateListener positionUpdater = new OnRecordPositionUpdateListener() {
        @Override
        public void onPeriodicNotification(AudioRecord recorder) {
        // do something amazing with audio data (long operations)
        }

        @Override
        public void onMarkerReached(AudioRecord recorder) {                            Log.d("Process", "marker reached");
        }
    };
    recorder.setRecordPositionUpdateListener(positionUpdater);
    recorder.setPositionNotificationPeriod(64);
    Log.d("Process", "starTAGt recording, bufferSize: " + bufferSize);
    Log.d("Process", "state = " + recorder.getState() + " aud = " + audioData.length);
    }

    @Override
    protected Void doInBackground(Void... params) {
        recorder.startRecording();
        Log.d("Process", "rec = " + recorder.getRecordingState());
        while (!isCancelled()) {
             recorder.read(audioData, 0, bufferSize);
        }
        recorder.stop();
        return null;
    }

} 
```

这是我的主要活动的 onCreate：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button on = (Button) findViewById(R.id.on);
        Button off = (Button) findViewById(R.id.off);

        final SoundSampler smp =  new SoundSampler();

        on.setOnClickListener(new View.OnClickListener() {          
            @Override
            public void onClick(View v) {
                 smp.execute();
            }
        });

        off.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                smp.cancel(true);
            }
        });

    } 
```

现在，声音已注册，但在我启动 SoundSampler AsyncTask 后，UI 被阻塞。我希望 SoundSampler 注册数据，但我希望他从主 UI 中按我的意愿停止。你对这样做有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T21:23:36.497

这些`OnRecordPositionUpdateListener`方法在 UI 线程上被调用。您可以通过在侦听器的方法中插入以下日志语句来确认这一点：

```
Log.i(TAG, "OnRecordPositionUpdateListener on thread: " + Thread.currentThread().getName()); 
```

您必须生成一个新线程才能在其中执行长时间运行的操作`onPeriodicNotification(AudioRecord recorder){}`

# ios - 在没有安装 Lion 的情况下支持 iOS 5.1 NSURLIsExcludedFromBackupKey [不备份]？

> ID：10774079
> 
> 赞同：1
> 
> 时间：2012-05-27T12:46:28.900
> 
> 标签：ios, ios5

[我发现在没有安装 Lion](https://stackoverflow.com/questions/8376127/ios-submission-without-lion)的情况下提交应用程序显然是可能的，但是我的应用程序下载了一些大文件，这些文件需要根据[Apple 存储指南](https://developer.apple.com/library/ios/#qa/qa1719/_index.html)进行保存。

包括下面的代码，我什至无法编译，原因是`Use of undeclared identifier 'NSURLIsExcludedFromBackupKey'`：

```
-(BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL{
    if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@"5.1")) {
        assert([[NSFileManager defaultManager] fileExistsAtPath: [URL path]]);

        NSError *error = nil;
        BOOL success = [URL setResourceValue: [NSNumber numberWithBool: YES]
                                      forKey: NSURLIsExcludedFromBackupKey error: &error];
        if(!success){
            NSLog(@"Error excluding %@ from backup %@", [URL lastPathComponent], error);
        }
        return success;
    }
} 
```

当我在 xcode 中只有 iOS 5.0 SDK 时，如何继续使用此代码？

（或者我的愿望没有实际意义，因为我真的无法告诉我的应用它支持 iOS 5.1？）

*   （`SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO`来自[https://stackoverflow.com/a/5337804/194309](https://stackoverflow.com/a/5337804/194309)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:29:20.057

如果 ios 版本不是 5.1，我添加了该字符串常量的定义。

这是我的实现的样子：

```
+ (BOOL)addSkipBackupAttributeToItemAtURL:(NSString*) path
    {           
        if (SYSTEM_VERSION_LESS_THAN_OR_EQUAL_TO(@"5.01"))
        {
            const char* folderPath = [_privateDirectoryPath fileSystemRepresentation];
            u_int8_t attrValue = 1;
            int result = setxattr(folderPath, kMobileBackupAttrName, &attrValue, sizeof(attrValue), 0, 0);
            return result == 0;
        } 
        else
        {
    #ifndef __IPHONE_5_1
    #define NSURLIsExcludedFromBackupKey @"NSURLIsExcludedFromBackupKey"
    #endif
            NSError *error = nil;
            NSURL* url = [NSURL fileURLWithPath:path];
            ASSERT_CLASS(url, NSURL);
            BOOL success = [url setResourceValue: [NSNumber numberWithBool: YES]
                                          forKey: NSURLIsExcludedFromBackupKey 
                                           error: &error];
            //Assert success                
            return success;
        }
    } 
```

# python - 在控制台/终端底部打印一行

> ID：10774082
> 
> 赞同：6
> 
> 时间：2012-05-27T12:47:04.060
> 
> 标签：python, terminal, stdout

使用 Python，我想打印一行，该行将出现在运行脚本的控制台上的最后一个*可见*行上。例如，像这样：

![在此处输入图像描述](../Images/bb715eb2f87ebce864169d2b82a46b2c.png)

这能做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:14:47.127

最简单的方法是使用[effbot.org 的`Console`模块](http://effbot.org/zone/console-index.htm)：

```
import Console

c = Console.getconsole()
c.text(0, -1, 'And this is the string at the bottom of the console') 
```

通过指定`-1`第二个（行）参数，您正在处理控制台的最后一行。

由于该`Console`模块仅适用于 Windows，因此要使其也适用于 UNIX 终端，您应该查看该[`wcurses`库](https://github.com/adamv/wcurses)，它提供了可`curses`在 Windows 上运行的部分实现。你会像[stdlib`curses`模块](http://docs.python.org/library/curses.html)一样驱动它；在 Windows 上使用第一个，在 UNIX 上使用后者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T13:03:11.047

对于 Windows 终端，尝试[控制台模块](http://effbot.org/zone/console-handbook.htm)对于 unix，curses 模块可以。

# php - 作为对象的方法 - 如何/何时

> ID：10774086
> 
> 赞同：0
> 
> 时间：2012-05-27T12:47:50.807
> 
> 标签：php, oop, class, methods

> **可能重复：**
> [PHP 方法链接？](https://stackoverflow.com/questions/3724112/php-method-chaining)

在我使用过的很多 API 中，我都看到过这样的事情：

```
$object->method()->anotherMethod(); 
```

从我读过的关于 OOP 的教程中，这就是类的编写方式，

```
<?php
class myClass {
    public method() {
       // do something
    }
}
?> 
```

什么时候应该使用它，如何使用它？抱歉，但我是 OOP 的新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T12:51:10.410

如果您的方法返回 $this，您将能够使用上述样式 ( `$object->method()->anotherMethod()`)。这只能在您的方法不期望返回其他内容的情况下完成，例如，一个名为 like 的方法`getSomething()`预计会返回`Something`，但是如果您有一个没有相关值要返回的方法，您可以只返回 $this，允许方法调用链。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T12:52:14.560

这称为[方法调用链](http://en.wikipedia.org/wiki/Method_chaining)。关于何时应该使用它并没有硬性规定，但我使用的一般规则是，当有一系列对象方法经常一个接一个地调用时，方法链接才有意义，例如初始化函数。

# python - 匹配 *text* 的正则表达式是什么？

> ID：10774089
> 
> 赞同：-2
> 
> 时间：2012-05-27T12:48:15.243
> 
> 标签：python, regex

要匹配`this is *some text*.`但不匹配的正则表达式是什么`this is \*another \*text`。正则表达式应该匹配星号之间的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:11:58.267

```
pattern = "\*(\w+(?:\s+\w+)*)\*"
re.findall(pattern, "this is *some text*.") // return 'some text'
re.findall(pattern, "this is \*another \*text") // return nothing 
```

用“$”替换“*”：

```
subpattern = "(\*(\w+(?:\s+\w+)*)\*)"
re.sub(subpattern, r"$\2$", "this is *some text*.") // return 'this is $some text$.' 
```

# android - 控件没有散布在屏幕的宽度上

> ID：10774090
> 
> 赞同：0
> 
> 时间：2012-05-27T12:48:42.673
> 
> 标签：android, android-layout, galaxy

我想创建适合整个屏幕宽度的控制条，所以我使用了以下代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"  
    android:background="#d9dee1"
    >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"

        android:orientation="horizontal" 
          android:background="@drawable/buttonsborder"

        >
     <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"

        android:orientation="horizontal" 

        >
        <Button
            android:id="@+id/Chemo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Chemo" 
            android:background="@drawable/firstbuttoncolorstyle"
             android:textColor="@drawable/firstbuttontextstyle"
            />

        <Button
            android:id="@+id/inpatient"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="inpatient" 
            android:background="@drawable/firstbuttoncolorstyle"
             android:textColor="@drawable/firstbuttontextstyle"
            />

        <Button
            android:id="@+id/Mgmt"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Mgmt" 
            android:background="@drawable/firstbuttoncolorstyle"
             android:textColor="@drawable/firstbuttontextstyle"
            />
          </LinearLayout>       
     <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"

        android:orientation="horizontal" 

        >
        <Button
            android:id="@+id/PFinder"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="PFinder" 
            android:background="@drawable/secondbuttoncolorstyle"
            android:textColor="@drawable/secondbuttontextstyle"
            />

        <Button
            android:id="@+id/Afinder"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Afinder" 
            android:background="@drawable/secondbuttoncolorstyle"
            android:textColor="@drawable/secondbuttontextstyle"
            />

        <Button
            android:id="@+id/Calender"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Calender" 
            android:background="@drawable/secondbuttoncolorstyle"
            android:textColor="@drawable/secondbuttontextstyle"
            />

    </LinearLayout>

          <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"

        android:orientation="horizontal" 

        >
            <Button
            android:id="@+id/Profile"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Profile" 
             android:background="@drawable/thirdbuttoncolorstyle"
             android:textColor="@drawable/secondbuttontextstyle"
            />

        <Button
            android:id="@+id/SODEOD"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="SOD/EOD" 
            android:background="@drawable/thirdbuttoncolorstyle"
            android:textColor="@drawable/secondbuttontextstyle"
            />

        <Button
            android:id="@+id/Clear"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Clear" 

            android:background="@drawable/thirdbuttoncolorstyle"
            android:textColor="@drawable/secondbuttontextstyle"

            />

        </LinearLayout>

                  <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"

        android:orientation="horizontal" 

        >
                <ImageButton
        android:id="@+id/maillme"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/mail" />

                    <ImageButton
        android:id="@+id/callme"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/call" />

        </LinearLayout>

     </LinearLayout>

    <!-- the two columns part -->

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_weight="0.80"
        android:orientation="horizontal" 

        >

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
             android:layout_weight=".80"
            android:id="@+id/submenue"

            >

             <!-- this will be the menue list -->

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="First Name" />

        </LinearLayout>

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_weight=".20"
            android:id="@+id/mainLayout"
            >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="second Name" />
        </LinearLayout>
    </LinearLayout>

</LinearLayout> 
```

但结果如下图 ![在此处输入图像描述](../Images/6c7da6c499523a90e2658cc2d0413628.png)

如何通过屏幕宽度（颜色按钮）传播控件，以及我使用此代码在按钮单击的运行时创建的列表

```
this.inpatient = (Button)this.findViewById(R.id.inpatient);
    this.inpatient.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {

            String[] MainMenue =  new String[] { "Chemo Unit", "Inpatient", "Patient tests","Management", "Instructions","Profile","Tools"};

            // remove all controls 

            LinearLayout formLayout = (LinearLayout)findViewById(R.id.submenue);
            formLayout.removeAllViews();

            menueview = new ListView(getApplicationContext());               
            menueview.setVisibility(ListView.VISIBLE);
            LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(
                    LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
            params.gravity = Gravity.RIGHT;
            menueview.setLayoutParams(params);

            menueview.setAdapter(new submenueadapter(menueview.getContext(), MainMenue));
            formLayout.addView(menueview);
        }
    }); 
```

如何增加字体和填充高度

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:06:02.950

我觉得你有两种可能。如果要保留 LinearLayout，则第一个：
给子菜单 layout_width="match_parent" 的所有子菜单，并将其所有 layout_weigth 设置为 1。

第二种方法可能是使用此 TableLayout 来代替子菜单的 LinearLayout：

```
<TableLayout android:id="@+id/TableLayout"
    android:layout_height="wrap_content" 
    android:layout_width="match_parent"
    android:stretchColumns="*">

    <!-- Your menu items -->

    <TableRow android:id="@+id/TableRow" 
        android:layout_width="match_parent"
        android:layout_height="wrap_content">
    </TableRow>
</TableLayout> 
```

# java - 在将 DatagramPacket 转换为 Java 中的字节数组后解析它

> ID：10774091
> 
> 赞同：4
> 
> 时间：2012-05-27T12:49:26.617
> 
> 标签：java, parsing, udp, bytearray

我正在尝试解析我将在套接字处收到的 DatagramPacket。我知道我将收到的数据包的格式，即 DHCPREQUEST 数据包，但我认为这并不重要。为简单起见，我们只考虑前六个字段：

第一个字段是“操作码”，它是 1 个字节。
第二个字段是 1 个字节的“硬件类型”。
三、“硬件地址长度”，1字节。
四、“跳”，1个字节。
五、“交易标识xid”，4字节。
第六，“秒”，2个字节。

收到数据包后，我的方法是将其转换为字节数组。

```
DatagramPacket request = new DatagramPacket(new byte[1024], 1024);
socket.receive(request);
byte[] buf = request.getData(); 
```

此时，数据包`buf`作为一系列字节存储在字节数组中。既然我知道这个字节序列的结构是什么，那我该如何解析呢？一字节字段很简单，但是多位字段呢？例如，我如何提取字节 4 到 7，并将它们存储在名为的变量中`xid`？

我可以手动将每个字节放入一个数组中：

```
byte[] xid = new byte[4];
xid[0] = buf[4];
xid[1] = buf[5];
xid[2] = buf[6];
xid[3] = buf[7]; 
```

但这对于数百字节长度的字段来说非常乏味且不切实际。String 类可以解析给定偏移量和长度的子字符串；Java中的字节数组有类似的方法吗？

还是我以某种方式让自己变得困难？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T23:42:46.573

将字节数组包装在 ByteArrayOutputStream 中；围绕它包装一个 DataInputStream；然后使用 DataInputStream 的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T13:01:39.630

执行此类操作的最简洁方法可能是使用实用程序方法[`Arrays.copyOfRange`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange%28byte%5B%5D,%20int,%20int%29)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-27T13:02:54.697

您所做的是自己编写一些辅助方法来从数据包中提取 2 字节、4 字节等值，读取字节并将它们组装成 Java`short`或`int`任何值。

例如

```
 public short getShort(byte[] buffer, int offset) {
        return (short) ((buffer[offset] << 8) | buffer[offset + 1]);
    } 
```

然后，您可以根据需要经常使用这些辅助方法。（如果你想花哨，你可以让方法更新一个持有当前位置的属性，这样你就不必传递`offset`参数。）

* * *

或者，如果您不担心开销，您可以将字节数组包装在`ByteArrayInputStream`和 a`DataInputStream`中，并使用后者的 API 来读取字节、短裤、整数等。IIRC，`DataInputStream`假设数字在流中以“网络字节顺序”表示......这几乎可以肯定是 DHCP 规范所要求的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-06T01:42:08.583

我对此有点晚了，但是有一个 ByteBuffer 类：

```
ByteBuffer b = ByteBuffer.wrap(request.getData());

byte opcode = b.get();
byte hwtype = b.get();
byte hw_addr_len = b.get();
byte hops = b.get();
int xid = b.getInt();
short seconds = b.getShort(); 
```

或者，如果您只需要一个字段：

```
ByteBuffer b = ByteBuffer.wrap(request.getData());
int xid = b.getInt(4); 
```

# blogger - 使用 robots.txt 阻止一个域

> ID：10774092
> 
> 赞同：1
> 
> 时间：2012-05-27T12:49:28.380
> 
> 标签：blogger, robots.txt

如果 Blogger 在 mydomain.com 和 mydomain.blogspot.com 上都提供站点，并且这两个站点完全相同，甚至具有相同的 robots.txt 文件，是否有某种方法可以配置 robots.txt 文件，以便它只阻止对站点的 mydomain.blogspot.com 版本的索引？有没有其他方法可以达到相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T12:56:35.137

您不能使用 robots.txt 执行此操作，它只能包含文件夹/子文件夹的说明，而不是域/子域的说明。如果可能，您可能希望为 mydomain.com 和 mydomain.example.com 创建单独的 robots.txt 文件。

另一种解决方案是进行从一个域到另一个域的永久 301 重定向。Blogger 不能做到这一点吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T10:48:17.600

最好的办法是确保 mydomain.blogspot.com 被重定向到您的自定义域 mydomain.com。重定向需要是永久重定向 (301)，并且可以通过 Blogger 上托管的博客来实现。在这里，这应该可以帮助您：

[http://support.google.com/blogger/bin/static.py?hl=en&ts=1233381&page=ts.cs](http://support.google.com/blogger/bin/static.py?hl=en&ts=1233381&page=ts.cs)

这是另一个，但具有 Blogger 以前的外观。 [http://www.blogbloke.com/redirect-you-blogger-custom-domain-to/](http://www.blogbloke.com/redirect-you-blogger-custom-domain-to/)

我建议您使用第一个链接并按照步骤进行操作！

# c# - 定时器精度和分辨率是什么意思？

> ID：10774094
> 
> 赞同：4
> 
> 时间：2012-05-27T12:49:42.237
> 
> 标签：c#

我不明白计时器精度和分辨率的含义。谁能给我解释一下？

注意：这个问题与秒表有关。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T14:30:09.147

准确度和精确度是相反的目标，你不能两者兼得。DateTime.UtcNow 是一个非常准确的计时源示例。它提供绝对时间，由内核自动纠正时钟频率错误，使用计时服务定期重新校准时钟。您可能听说过 time.windows.com，这是大多数 Windows PC 使用的 NTP 服务器。非常准确，您可以指望在一整年中出现不到一秒的错误。但并不精确，该值每秒仅更新 64 次。以任何一种不错的精度来计时任何花费不到一秒的时间都是没有用的。

秒表的时钟源非常不同。它使用一个自由运行的计数器，该计数器由芯片组中某处可用的频率源驱动。这曾经是一个以[颜色突发频率运行的专用晶体](http://en.wikipedia.org/wiki/Color_burst)(3.579545 MHz) 但无情的成本削减已经从大多数 PC 中消除了这一点。秒表非常精确，你可以从它的频率属性中看出。你应该得到一个兆赫兹和 CPU 时钟频率之间的东西，让你的时间下降到一微秒或更好。但它并不准确，它受电子零件公差的影响。特别不相信任何超过千兆赫的频率，它来自一个乘法器，它也乘以误差。并注意海森堡原理，启动和停止秒表需要非零开销，这会影响非常短的测量的准确性。秒表的另一个常见准确性问题是操作系统切换出您的线程以允许其他代码运行。您需要采集多个样本并使用中值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T12:55:22.787

它们与任何测量相同。有关更多详细信息，请参阅此 Wikipedia 文章-

[http://en.wikipedia.org/wiki/Accuracy_and_precision](http://en.wikipedia.org/wiki/Accuracy_and_precision)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T12:55:53.623

.net 中有不同类型的时间（如果我没记错的话，其中有 3 或 4 个），每个都使用自己的算法。计时器的精度意味着它在通知正在使用的应用程序有关滴答事件时的准确性。例如，如果您使用计时器并将其设置为每 1000 毫秒触发一次其滴答事件，则计时器的精度意味着它将实际滴答的接近指定的 1000 毫秒。
有关更多信息（至少在 c# 中），我建议您阅读[有关计时器的 msdn 页面](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T14:43:07.897

来自 MSDN[秒表类](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)：（强调我的）

“秒表通过计算底层计时器机制中的计时器滴答来测量经过的时间。如果安装的硬件和操作系统支持高分辨率性能计数器，则秒表类使用该计数器来测量经过的时间。否则，秒表类使用系统计时器来测量经过的时间。**使用频率和 IsHighResolution 字段来确定秒表**计时实施的精度和分辨率。

# ruby-on-rails - 如何在 MongoDB/Mongoid 中统计引用模型的出现次数

> ID：10774097
> 
> 赞同：0
> 
> 时间：2012-05-27T12:50:08.260
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid

我正在做一个简单的项目，其中有两个示例引用模型：

```
class Player
  include Mongoid::Document
  include Mongoid::Timestamps

  has_and_belongs_to_many :games
end

class Game
  include Mongoid::Document
  include Mongoid::Timestamps

  has_and_belongs_to_many :players
end 
```

我需要做的是获取与玩家数量有关的顶级游戏列表。与此类似：

```
{
  "diablo_3": {
    "players": 89
  },
  "max_payne_3": {
    "players": 87
  },
  "world_of_warcraft": {
    "players": 65
  },
  "dirt_3": {
    "players": 43
  }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T22:24:52.917

您可以使用 MongoDB group 命令对单个集合进行一些服务器大小的处理，它可以作为 Ruby 驱动程序中集合的方法使用，请参阅[http://api.mongodb.org/ruby/current/Mongo /Collection.html#group-instance_method](http://api.mongodb.org/ruby/current/Mongo/Collection.html#group-instance_method)

请在下面找到基于您的模型的测试，并将标题字段添加到您的游戏模型中。这是使用 MongoDB 的 group 命令对您的问题的有效答案。

```
require 'test_helper'

class GameTest < ActiveSupport::TestCase
  def setup
    Player.delete_all
    Game.delete_all
  end

  test "game player count" do
    input = [ [ 'diablo_3', 89 ], [ 'max_payne_3', 87 ], [ 'world_of_warcraft', 65 ], [ 'dirt_3', 43 ] ]
    input.shuffle.each do | title, count |
      game = Game.create(title: title)
      (0...count).each{ game.players << Player.new }
    end
    game_player_count = Game.collection.group(key: :_id, cond: {}, initial: {count: 0}, reduce: 'function(doc, out) { out.title = doc.title; out.count = doc.player_ids.length; }')
    game_player_count.sort!{|a,b| -(a['count'] <=> b['count']) }
    game_player_count = Hash[*game_player_count.map{|r| [r['title'], {"players" => r['count'].to_i} ]}.flatten]
    puts JSON.pretty_generate(game_player_count)
  end

end 
```

结果

```
Run options: --name=test_game_player_count

# Running tests:

{
  "diablo_3": {
    "players": 89
  },
  "max_payne_3": {
    "players": 87
  },
  "world_of_warcraft": {
    "players": 65
  },
  "dirt_3": {
    "players": 43
  }
}
.

Finished tests in 0.482286s, 2.0735 tests/s, 0.0000 assertions/s.

1 tests, 0 assertions, 0 failures, 0 errors, 0 skips 
```

# javascript - 使用 C# 将 Thomas J Bradley 签名板 JSON 转换为 PNG

> ID：10774099
> 
> 赞同：1
> 
> 时间：2012-05-27T12:50:33.877
> 
> 标签：javascript, asp.net, json, webmatrix

我正在测试[Thomas J Bradley 的 Signature Pad 插件，](http://thomasjbradley.ca/lab/signature-pad/)它可以正常工作，并且能够使用 PHP 将 JSON 签名转换为 PNG，但希望能够使用 C# 将 JSON 签名转换为 PNG。

有一个名为[SignatureToImageDotNet](https://github.com/parrots/SignatureToImageDotNet)的补充类，我无法开始工作。我应该提一下，我是 ASP.NET / C# 的新手。到目前为止，我已经在 Webmatrix 中创建了一个网站，并启动并运行了签名捕获表单，并且可以将输出的 JSON 返回到页面，但无法将其转换为 PNG 图像。我创建了一个“App_Code”文件夹并将“SignatureToImage.cs”文件放入其中，但我不知道如何调用它。

我敢肯定，对于具有 ASP.NET / C# 经验的人来说，这将是非常微不足道的，我希望有人以前做过或可以做到这一点，并让我确切地知道如何做到这一点，因为文档非常简短。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T05:51:46.623

您在创建 App_Code 文件夹时做了正确的事情，通常人们会错过那部分。就调用类而言，ASP.NET Web Pages 的工作方式与 PHP 非常相似。您在 cshtml 页面顶部创建一个代码块，该代码块在页面加载时执行：

[http://www.asp.net/web-pages/tutorials/introducing-aspnet-web-pages-2/getting-started](http://www.asp.net/web-pages/tutorials/introducing-aspnet-web-pages-2/getting-started)

根据您在请求中所做的其他事情（我需要更多信息/代码），我猜您可以开始在页面顶部的剃刀块内使用 SignatureToImage 类：

## 默认.cshtml

```
@{
     if (IsPostback) {
         var sigToImg = new SignatureToImage();
         var signatureImage = sigToImg.SigJsonToImage(signatureJson);
         // do something with the image!
     }
 }

<html>
.... 
```

我知道答案有点开放，但如果您有更具体的问题，请随时向我询问有关网页或 C# 如何工作的问题。

# ios - iOS 在后台保存主线程 NSManagedObjectContext 更改

> ID：10774100
> 
> 赞同：1
> 
> 时间：2012-05-27T12:50:36.167
> 
> 标签：ios, core-data

我现在试图弄清楚我所有的核心数据都是在主线程上管理的，只有一个上下文。我使用了仪器并注意到保存操作阻塞了主线程很长一段时间。我想使用 GCD 在后台线程上运行我的保存操作

现在我了解如何通过创建新线程/上下文来设置此过程并监听“保存”通知以合并回主线程。

但是当我创建一个新上下文时，主线程上下文中的所有更改都需要插入/合并到新上下文中，否则它不会有任何可保存的东西？我似乎可以找到任何例子。

例如在我的主要背景下：

*   插入 2x 用户
*   删除了 3 个墙贴
*   更新了一些朋友关系。

现在我如何让我的背景上下文知道这些变化？

在应用程序启动时创建后台上下文并让它在主线程上监听 NSManagedObjectContextObjectsDidChangeNotification 以不断保持同步是否有意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:41:01.717

在 iOS5 中，您可以使用新的并发类型轻松做到这一点。如果使用 NSPrivateQueueConcurrencyType 创建上下文，则不会阻塞主线程。但是您必须访问传递给 managedObjectContext:performBlock 方法的块内的上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:03:01.293

您不能在线程之间传递 NSManagedObject 实例。如果您在处理大型数据集时遇到困难，您可能需要阅读Marcus Zarra 的[这篇文章](http://www.cimgf.com/2011/08/22/importing-and-displaying-large-data-sets-in-core-data/)。

# asp.net-mvc-3 - 通过 JQuery Mobile/PhoneGap 和 ASP.NET MVC 3 进行跨域服务调用

> ID：10774107
> 
> 赞同：0
> 
> 时间：2012-05-27T12:51:32.487
> 
> 标签：asp.net-mvc-3, jquery-mobile, cordova

我正在尝试使用 JQuery Mobile 和 PhoneGap 构建一个移动应用程序。这个应用程序将访问我正在使用 ASP.NET MVC 3 开发的后端。现在，我只是想让一个基本的 GET/POST 工作。我创建了以下测试页面。

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <link rel="stylesheet" href="resources/css/themes/default/core.css" />    
    <link rel="stylesheet" href="resources/css/themes/default/app.css" />

    <script src="resources/scripts/jquery-1.6.4.min.js" type="text/javascript"></script> 
    <script src="resources/scripts/jquery.mobile-1.1.0.min.js" type="text/javascript"></script>

    <script type="text/javascript">
      function initialize() {
      $.support.cors = true;
          $.mobile.allowCrossDomainPages = true;
      }
    </script>
  </head>

  <body onload="initialize();">
    <div id="testPage" data-role="page">
    <div data-role="header" data-position="fixed">
      <h1>TEST</h1>
    </div>

    <div data-role="content">
      <input id="twitterButton" type="button" value="Test GET via Twitter" onclick="twitterButton_Click();" />
      <input id="getButton" type="button" value="Test GET via MVC 3" onclick="getButton_Click();" />
      <input id="postButton" type="button" value="Test POST via MVC 3" onclick="postButton_Click();" />

      <div id="status"></div>
    </div>

    <div data-role="footer" class="ui-bar" data-position="fixed"> 

    </div>

    <script type="text/javascript">
      function twitterButton_Click() {
        $("#status").html("Testing Twitter...");
          var vm = { q:"1" };
          $.ajax({
      url: "http://search.twitter.com/search.json?q=weekend&rpp=5&include_entities=true&result_type=mixed",
            type: "GET",
            dataType: "jsonp",
            contentType: "application/json",
            success: twitter_Succeeded,
            error: twitter_Failed
          });
        }

        function twitter_Succeeded(result) {
          $("#status").html("Twitter GET Succeeded!");
        }

        function twitter_Failed(p1, p2, p3) {
          $("#status").html("Twitter GET Failed :(");
        }

        function getButton_Click() {
          $("#status").html("Testing Get...");

          var vm = { q:"1" };
          $.ajax({
            url: "https://www.mydomain.com/myService/testGet",
            type: "GET",
            data: vm,
            contentType: "application/json",
            success: get_Succeeded,
            error: get_Failed
          });
        }

        function get_Succeeded(result) {
            $("#status").html("MVC 3 GET Succeeded!");
        }

        function get_Failed(p1, p2, p3) {
            $("#status").html("MVC 3 GET Failed :(");
        }

        function postButton_Click() {
          $("#status").html("Testing POST...");

          var vm = { data:"some test data" };
          $.ajax({
            url: "https://www.mydomain.com/myService/testPost",
            type: "POST",
            data: JSON.stringify(vm),
            contentType: "application/json",
            success: post_Succeeded,
            error: post_Failed
          });       
        }

        function post_Succeeded(result) {
            $("#status").html("MVC 3 POST Succeeded!");
        }

        function post_Failed(p1, p2, p3) {
            $("#status").html("MVC 3 POST Failed :(");
        }
    </script>
</div>
</body>
</html> 
```

当我从 Visual Studio 中运行此页面时，我将 AJAX url 调用更改为相对调用。他们完美地工作。但是，因为我的目标是在 PhoneGap 中运行这个应用程序，所以我知道这个页面实际上会作为本地文件 ( [http://jquerymobile.com/demos/1.1.0/docs/pages/phonegap.html](http://jquerymobile.com/demos/1.1.0/docs/pages/phonegap.html) ) 运行。因此，我使用了上面的代码并在本地机器上创建了 test.html。

当我尝试运行此代码时，Twitter 测试有效。奇怪的是，这三个操作都可以在 Internet Explorer 中运行。但是，当我使用 Chrome 或 FireFox 时，对我的服务器的测试不起作用。在 Chrome 中，我在控制台中注意到以下内容：

```
XMLHttpRequest cannot load https://www.mydomain.com/myService/testGet?q=1\. Origin null is not allowed by Access-Control-Allow-Origin.

XMLHttpRequest cannot load https://www.mydomain.com/myService/testPost. Origin null is not allowed by Access-Control-Allow-Origin. 
```

我回顾了这个：[规避同源政策的方法](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)。但是，它们似乎都不起作用。我觉得我缺少一些服务器端配置。目前，我的 TestGet 和 TestPost 操作如下所示：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult TestGet(string q)
{
  Response.AppendHeader("Access-Control-Allow-Origin", "*");
  return Json(new { original = q, response=DateTime.UtcNow.Millisecond }, JsonRequestBehavior.AllowGet);
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult TestPost(string data)
{
  Response.AppendHeader("Access-Control-Allow-Origin", "*");
  return Json(new { status=1, response = DateTime.UtcNow.Millisecond }, JsonRequestBehavior.AllowGet);
} 
```

我觉得我离完成这项工作很近了。我错过了什么？衷心感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T20:20:09.217

在实际的设备或模拟器上尝试它，它会起作用。从常见问题解答：

> 跨域安全策略不影响PhoneGap 应用程序。由于 html 文件由 webkit 使用 file:// 协议调用，因此安全策略不适用。（在 Android 中，您可以通过编辑 AndroidManifest.xml 将 android.permission.INTERNET 授予您的应用程序）

它将始终与 Twitter 一起使用，因为它使用 JSONP 来响应查询。您必须以正确的方式启动 Chrome 或 Firefox 来告诉它允许 CORS。对于 Chrome，它是：

```
chrome --disable-web-security 
```

# algorithm - 从内部点生成相邻多边形

> ID：10774109
> 
> 赞同：2
> 
> 时间：2012-05-27T12:51:53.343
> 
> 标签：algorithm, geometry, gis, computational-geometry

我有一组点（英国完整的邮政编码质心）。邮政编码与邮政编码扇区和邮政编码区之间存在层级关系。原来的部门和地区是连续的。我希望得出部门和地区的近似边界，以便国家的任何部分恰好落入一个部门和一个地区，所有生成的多边形理想情况下应该是连续的并且（显然？）所有原始点都应该在适当的多边形中。有没有合适的算法？更好的是，是否有一些适当的实施？

* * *

我想我一定解释得很糟糕，因为我认为这不能回答我的问题。

让我们只谈谈部门，因为答案也适用于地区。

有1.8m坐标。考虑每一个都标有诸如“SG13 7AT”之类的邮政编码邮政编码标签本身可以反映邮政编码-扇区-区结构-在这种情况下扇区是“SG13 7”除了这些点及其邮政编码之外没有其他数据标签。

我知道存在定义该部门的边界。但是，此边界数据并非免费提供。已知每个邮政编码点都在其真正的扇区边界内。

我想要的是重新创建扇区边界的近似值，使这些点落在新创建的多边形内，并且我创建的多边形是连续的。这些边界不会准确反映原件，但它们足以满足我的目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T07:42:17.640

为了将平面划分为扇区，根据采样的邮政编码，使用对完整点集计算的 Voronoi 图，然后将每个图单元分配给包含单元站点的扇区。

我用两个扇区的例子来说明这一点，红色和蓝色。假设您的初始数据是这样的：

![来自两个部门的数据：红色和蓝色](../Images/750d2134e185d844465112e4fbc4ad84.png)

然后在计算 Voronoi 图之后，对单元的划分将如下所示。我概述了红色和蓝色扇区之间的边界。请注意，它们都是无界的，但这只是因为数据不包括其他部门。

![数据的 Voronoi 图](../Images/109fc7bcbb16dae4c176a6b13c6292b9.png)

现在在你澄清事情之前我的回答......

您需要的是“点位置查询”的数据结构：给定空间的细分（在您的情况下为平面）和查询点，找到包含查询点的对象。在线、线段和多边形上有有效的算法（log(n) 查询时间），它们已在计算几何库 CGAL 中实现。

请注意，我使用[CGAL 2D 三角剖分演示](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/packages.html#part_IX)来说明解决方案

查看此[链接](http://www.cgal.org/Manual/3.3/doc_html/cgal_manual/Arrangement_2/Chapter_main.html#Subsection_20.3.1)以获取点位置查询的文档。

# iphone - 将此文本颜色更改为白色和粗体

> ID：10774111
> 
> 赞同：1
> 
> 时间：2012-05-27T12:52:19.237
> 
> 标签：iphone, objective-c, ios, ios5

我有这个代码，它真的不是标签，但我希望文本是白色的，如果可能的话是粗体。

```
- (UIImage *)addText:(NSString *)text toImage:(UIImage *)image {

UIGraphicsBeginImageContext(image.size);

[image drawAtPoint:CGPointZero];

UIFont *font = [UIFont systemFontOfSize:image.size.width / 24];
CGSize expectedSize = [text sizeWithFont:font];

[text drawAtPoint:CGPointMake(image.size.width / 2 - (expectedSize.width / 2), image.size.height * 0.82) withFont:font]; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:52:05.717

改变你的颜色

```
 [[UIColor whiteColor] set]; 
```

更改字体

```
[UIFont boldSystemFontOfSize:12] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T12:59:18.210

你可以使用 fontWithName: andSize: 方法

例子

```
[UIFont fontWithName:@"ArialMT-Bold" size:12.0]; 
```

# php - Zend Search MultiTerm 查询没有命中？（应该有3个）

> ID：10774118
> 
> 赞同：3
> 
> 时间：2012-05-27T12:53:28.087
> 
> 标签：php, symfony, zend-search-lucene

我有一个包含名称、俱乐部、natranking、doublesranking 和俱乐部字段的搜索表。我从选择框中选择了一个俱乐部，将名称字段留空并单击“搜索”。结果没有命中。应该有 3 条，因为数据库中有 3 条记录属于所选俱乐部的一部分。这是为什么？

谢谢。

控制器类：

```
$search = $this->get('ewz_search.lucene');

// Create query
$terms = array(new Term($form->getData()->getName(), 'name'),
    new Term($form->getData()->getClub(), 'club'),
    new Term($form->getData()->getNatRanking(), 'natranking'),
    new Term($form->getData()->getNatDoublesRanking(), 'doublesranking')
);
$signs = array(TRUE, TRUE, TRUE, TRUE);
$query = new MultiTerm($terms, $signs);

// Get results 
$results = $search->find($query);

// Echo prints: "+name: +club:A.R.A. LA GANTOISE +natranking: +doublesranking:"
echo $query;

// This returns 0
die("debug: " . count($results); 
```

//编辑

这有效（给我 3 个结果）：

```
$manual_query = "+name: +club:A.R.A. LA GANTOISE +natranking: +doublesranking:"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T08:59:13.563

我将 Multiterm 对象转换为字符串，现在它可以工作了。这很奇怪，因为文档中的示例清楚地表明它应该可以在不将其转换为字符串的情况下工作：

来自文档的示例（http://framework.zend.com/manual/en/zend.search.lucene.query-api.html#zend.search.lucene.queries.multiterm-query）

```
$query = new Zend_Search_Lucene_Search_Query_MultiTerm();

$query->addTerm(new Zend_Search_Lucene_Index_Term('word1'), true);
$query->addTerm(new Zend_Search_Lucene_Index_Term('word2', 'author'),
            null);
$query->addTerm(new Zend_Search_Lucene_Index_Term('word3'), false);

$hits  = $index->find($query); 
```

# c# - 带有 Telerik 编辑器的 MVC4 无法正常工作

> ID：10774120
> 
> 赞同：1
> 
> 时间：2012-05-27T12:53:37.150
> 
> 标签：c#, jquery, asp.net-mvc, razor, telerik

由于某种原因，我的 Telerik MVC Editor() 无法正常工作。谁能发现我做错了什么？

*我正在使用带有 Razor 视图引擎和 Telerik 版本 2012.1.214 的 MVC4*

**_Layout.cshtml 包括：**

```
@using Smekklegt.Models
@using Telerik.Web.Mvc.UI
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="is" xml:lang="is">
<head>
<meta charset="utf-8" />
<title>@ViewBag.Title</title>
<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/themes/base/jquery.ui.all.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.20.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/modernizr-2.5.3.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/AjaxLogin.js")" type="text/javascript"></script>
<meta name="viewport" content="width=device-width" />
<!-- Skrár frá template-->
<link href="@Url.Content("~/Content/rikona/styles/galleriffic.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/rikona/style.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Content/rikona/js/jquery-1.3.2.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/rikona/js/jquery.opacityrollover.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/rikona/js/jquery.galleriffic.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Content/rikona/js/gallery-settings.js")" type="text/javascript"></script>
<!--[if IE 6]>
        <script src="../../Content/rikona/js/ie6-transparency.js"></script>
        <script>
            DD_belatedPNG.fix('#header .logo img, .subtitle img, .slideshow-container, .navigation-container #thumbs .thumbs li .thumb img, .navigation a.next, .footer-line, #sidebar .author-photo, .line, .commentlist .comment-reply-link, #contact-page #contact .submit');
        </script>
        <link rel="stylesheet" type="text/css" href="../../Content/rikona/styles/ie6.css" />
    <![endif]-->
<!--[if IE 7]>
        <link rel="stylesheet" type="text/css" href="../../Content/rikona/styles/ie7.css" />
    <![endif]-->
<!--[if IE 8]>
        <link rel="stylesheet" type="text/css" href="../../Content/rikona/styles/ie8.css" />
    <![endif]-->
@(Html.Telerik().StyleSheetRegistrar()
                  .DefaultGroup(group => group
                      .Add("telerik.common.css")
                      .Add("telerik.simple.css")
                      .Combined(true)
                      .Compress(true))
                 )
</head>
<body>
<div id="wrap">
    <div id="header">
        <section id="login" style="float: right;">
            @Html.Partial("_LogOnPartial")
        </section>
        <section style="float: left;">
            <ul>
                <li>@Html.ActionLink("Flokkar", "Index", "Category")</li>
                <li>@Html.ActionLink("Vörur", "Index", "Product")</li>
            </ul>
        </section>
        <div class="logo">
            <img src="../../Content/rikona/images/smekklegt_banner2.jpg" alt="logo" width="400px;" />
        </div>
        <div id="nav">                
            <ul id="nav-pages">
                <li>@Html.ActionLink("Forsíða", "Index", "Home")<span>|</span></li>
                @foreach (Category category in (IEnumerable<Category>)ViewData["Categories"])
                {
                    <li>@Html.ActionLink(category.Name, "FindProductsByCategory", "Product", new { catId = category.Id }, null)<span>|</span></li>
                }
                <li>@Html.ActionLink("smekklegt.is", "Contact", "Home")</li>
            </ul>
        </div>
    </div>
    <div id="frontpage-content">
        <div id="container">
            @RenderSection("featured", false)
            <section class="content-wrapper main-content clear-fix">
                @RenderBody()
            </section>
        </div>
    </div>

    <div id="footer" style="margin-top: 15px;">
        <div class="footer-line">
        </div>
            <p>
                &copy; @DateTime.Now.Year Smekklegt ehf</p>
        <div class="float-right">
            <ul id="social">
                <li><a href="https://www.facebook.com/sersaumadir.smekkir" target="_blank" class="facebook">Facebook</a></li>
            </ul>
        </div>
    </div>
    @Html.Telerik().ScriptRegistrar().jQuery(false).DefaultGroup(g => g.Combined(true).Compress(true))
</div> 
```

**Create.cshtml 包括：**

```
@using Telerik.Web.Mvc.UI
@model Smekklegt.Controllers.ProductFormViewModel

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>

<script type="text/javascript" src="@Url.Content("~/Scripts/jquery.validate.min.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")"></script>

@using (Html.BeginForm()) {
@Html.ValidationSummary(true)

<fieldset>
    <legend>Product</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.Product.Name)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Product.Name)
        @Html.ValidationMessageFor(model => model.Product.Name)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Product.FK_Category)
    </div>
    <div class="editor-field">
        @*@Html.EditorFor(model => model.Product.FK_Category)*@
        @Html.DropDownListFor(d => d.Categories, new SelectList(Model.Categories, "Id", "Name"))
        @Html.ValidationMessageFor(model => model.Product.FK_Category)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Product.Description)
    </div>

    <div>
        @{ Html.Telerik().EditorFor(m => m.Product.Description)
               .Name("ProductCreateEditor")
               .Encode(false)
               .HtmlAttributes(new { style = "width: 500px;" })
               .Tools(t => t.Clear()
               .Bold().Italic().Underline().Separator().JustifyCenter().JustifyLeft().JustifyRight().JustifyFull())
               //.Value((string)ViewData["ProductDescription"])
               .Render(); }
    </div>

    <p>
        <input type="submit" value="Stofna" />
        <input type="button" value="Til baka" onclick="javascript:history.go(-1)"/>
    </p>
</fieldset>
} 
```

我遇到的问题是，每次我加载页面时，telerik 编辑器都会出现，但我无法写入文本区域。（看起来它被禁用了）:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:37:28.693

**更新** 从您的布局中删除此行

```
<script src="@Url.Content("~/Content/rikona/js/jquery-1.3.2.js")" type="text/javascript"></script> 
```

您只需要一个版本的 Jquery，它们相互冲突是我最好的选择。

其他一切看起来都不错

* * *

删除此行

```
.Value((string)ViewData["ProductDescription"]) 
```

您正在使用`EditorFor`将值从模型中提取出来。所以你只需要在一个地方设置值。您试图将其设置在两个地方，在`EditorFor`和`Value`中。

如果您`Editor`不使用`EditorFor`，则可以使用`Value`

所以选择这样`EditorFor`做：

```
@{ Html.Telerik().EditorFor(m => m.Product.Description)
    .Name("ProductCreateEditor")
    ...
    .Render(); 
} 
```

或者`Editor`

```
@{ Html.Telerik().Editor()
    .Name("ProductCreateEditor")
    ...
    .Value((string)ViewData["ProductDescription"])
    .Render(); 
} 
```

正如 John 还指出的，确保 Telerik 脚本的放置位置正确。它必须像这样在底部的_Layout页面中；

```
 @(Html.Telerik().ScriptRegistrar().jQuery(false).DefaultGroup(group => group.Combined(true).Compress(true)))
    </body>
</html> 
```

# html - 树表jsp自定义标签

> ID：10774124
> 
> 赞同：0
> 
> 时间：2012-05-27T12:54:47.727
> 
> 标签：html, css, jsp, jstl

我有这个实现树表的自定义 JSP 标记（每个任务都可以有子任务）： 树：

```
<%@ tag language="java" pageEncoding="ISO-8859-1"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="h" tagdir="/WEB-INF/tags"%>
<%@ attribute name="tasks" type="java.util.List" required="true"%>

<c:forEach items="${tasks}" var="t">
            <tr>
                <td><c:out value="${t.id}"></c:out></td>
                <td><c:out value="${t.name}"></c:out></td>
                <td><c:out value="${t.description}"></c:out></td>
                <td><c:out value="${t.deadline}"></c:out></td>
            </tr>
    <c:if test="${fn:length(t.subtasks) > 0}">
        <h:tree tasks="${t.subtasks}"/>
    </c:if>
</c:forEach> 
```

树包装：

```
<%@ tag language="java" pageEncoding="ISO-8859-1"%>
<%@ taglib prefix="h" tagdir="/WEB-INF/tags"%>
<%@ attribute name="tasks" type="java.util.List" required="true"%>
<table>
    <h:tree tasks="${tasks}"></h:tree>
</table> 
```

现在每个子任务都显示在它的父任务下方。我在每个子行（如树）上添加了一些左填充：

```
-parent row
  -child row
  -child row
    -child chuld row
  -child row 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T12:58:18.213

如果您执行查看源代码，您应该能够看到表单上各种 HTML 元素的类名或 ID。在 css 中使用这些来定义您想要实现的特征。

# java - android微调器选择值并停止媒体播放器

> ID：10774126
> 
> 赞同：0
> 
> 时间：2012-05-27T12:55:04.183
> 
> 标签：java, android

所以我有这个代码：

```
public class StreamingMp3Player extends Activity implements OnClickListener, OnTouchListener, OnCompletionListener, OnBufferingUpdateListener, OnItemSelectedListener{
    TextView textMsg, textPrompt;
    ImageView imageView;
    final String textSource = "http://www.sdads.ro/sdsad.php";
    private ImageButton buttonPlayPause;
    protected EditText editTextSongURL;

    private MediaPlayer mediaPlayer;

    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK) {
            moveTaskToBack(true);
            return true;
        }
        return super.onKeyDown(keyCode, event);
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Spinner spinner = (Spinner) findViewById(R.id.spinner);
        ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(
                this, R.array.planets_array, android.R.layout.simple_spinner_item);
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(adapter);

        Button btn1 = (Button) findViewById(R.id.btn1);
        btn1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                finish();
                System.exit(0);
            }
        });

        imageView = (ImageView) findViewById(R.id.imagine);
        textPrompt = (TextView)findViewById(R.id.textprompt);
        textMsg = (TextView)findViewById(R.id.textmsg);
        textMsg.post( new Runnable(){

            public void run(){

        URL textUrl;
        try {

            textUrl = new URL(textSource);
            BufferedReader bufferReader = new BufferedReader(new InputStreamReader(textUrl.openStream()));
            String StringBuffer;
            String stringText = "";
            while ((StringBuffer = bufferReader.readLine()) != null) {
                stringText += StringBuffer;
            }
            bufferReader.close();
            textMsg.setText(stringText);
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            textMsg.setText(e.toString());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            textMsg.setText(e.toString());
        }
        textMsg.postDelayed(this,(1000*10));
            }

        });

        initView();
        spinner.setOnItemSelectedListener(new StreamingMp3Player());
    }

    private void initView() {

        buttonPlayPause = (ImageButton)findViewById(R.id.ButtonTestPlayPause);
        buttonPlayPause.setOnClickListener(this);

        editTextSongURL = (EditText)findViewById(R.id.EditTextSongURL);
        editTextSongURL.setText("Romantic FM");

        mediaPlayer = new MediaPlayer();
        mediaPlayer.setOnBufferingUpdateListener(this);
        mediaPlayer.setOnCompletionListener(this);
    }

    public void onClick(View v) {
        if(v.getId() == R.id.ButtonTestPlayPause){

            try {
                mediaPlayer.setDataSource("http://dfgdgfdgf:8080"); 

                mediaPlayer.prepare(); 
            } catch (Exception e) {
                e.printStackTrace();
            }

            //mediaFileLengthInMilliseconds = mediaPlayer.getDuration(); 

            if(!mediaPlayer.isPlaying()){
                mediaPlayer.start();
                //buttonPlayPause.setBackgroundColor(Color.RED);
                buttonPlayPause.setImageResource(R.drawable.button_pause);
            }else {
                mediaPlayer.pause();
                buttonPlayPause.setImageResource(R.drawable.button_play);
                //System.out.println("Pauza");

            }

        }
    }

     public void onItemSelected(AdapterView<?> parent,
                View view, int pos, long id) {
            if(pos == 1) {
                mediaPlayer.pause();
            }

            }

            public void onNothingSelected(AdapterView parent) {
              // Do nothing.
            }

    public void onCompletion(MediaPlayer mp) {

        buttonPlayPause.setImageResource(R.drawable.button_play);

    }

    public void onBufferingUpdate(MediaPlayer arg0, int arg1) {
        // TODO Auto-generated method stub

    }

    public boolean onTouch(View arg0, MotionEvent arg1) {
        // TODO Auto-generated method stub
        return false;
    }

} 
```

这段代码是我从微调器获取值的地方：

```
public void onItemSelected(AdapterView<?> parent,
                View view, int pos, long id) {
            if(pos == 1) {
                mediaPlayer.pause();
            }

            }

            public void onNothingSelected(AdapterView parent) {
              // Do nothing.
            } 
```

它应该暂停媒体播放器，而不是我得到错误。这是来自 logcat：

```
05-27 12:39:05.554: E/AndroidRuntime(1432): FATAL EXCEPTION: main
05-27 12:39:05.554: E/AndroidRuntime(1432): java.lang.NullPointerException
05-27 12:39:05.554: E/AndroidRuntime(1432):     at com.hrupin.streamingmedia.StreamingMp3Player.onItemSelected(StreamingMp3Player.java:161)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at android.widget.AdapterView.fireOnSelected(AdapterView.java:871)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at android.widget.AdapterView.access$200(AdapterView.java:42)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at android.widget.AdapterView$SelectionNotifier.run(AdapterView.java:837)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at android.os.Handler.handleCallback(Handler.java:587)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at android.os.Handler.dispatchMessage(Handler.java:92)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at android.os.Looper.loop(Looper.java:123)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at android.app.ActivityThread.main(ActivityThread.java:3683)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at java.lang.reflect.Method.invokeNative(Native Method)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at java.lang.reflect.Method.invoke(Method.java:507)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-27 12:39:05.554: E/AndroidRuntime(1432):     at dalvik.system.NativeStart.main(Native Method) 
```

那我做错了什么？当我选择应该暂停媒体播放器的微调器值时，是什么导致应用程序崩溃？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:27:07.550

您的 Spinner 对象在`OnCreate()`完全隐藏在方法中的`onItemSelected()`方法中声明，只需在 MediaPlayer 对象下方的类级别声明它，如下所示，

```
 private MediaPlayer mediaPlayer;
 private Spinner spinner; 
```

# php - Openssl 和 PHP

> ID：10774127
> 
> 赞同：5
> 
> 时间：2012-05-27T12:55:21.843
> 
> 标签：php, openssl

我试图用 PHP 加载由 openssl cli 工具生成的私钥。我使用了以下命令和 PHP 代码：

> openssl genrsa -des3 4096 -out private.key

```
if (!($key = openssl_pkey_get_private("file://private.key", "password")));
{
      return false;
} 
```

我确定密码是正确的，并且文件也是 PEM 格式的，但它一直返回错误。我究竟做错了什么？

在此先感谢，乔里。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-07-30T22:49:17.247

请注意，`file://path/to/file.pem`在文档中表示文件协议 + 文件路径。在 UNIX 之类的操作系统中，这类似于`file:///rsa_private_key.pem`. 路径字符串中有**三个斜杠，而不是两个。**并且`file://`不能省略。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T21:07:28.213

将密钥放在 var 中要容易得多：

```
$public = "-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDfmlc2EgrdhvakQApmLCDOgP0n
NERInBheMh7J/r5aU8PUAIpGXET/8+kOGI1dSYjoux80AuHvkWp1EeHfMwC/SZ9t
6rF4sYqV5Lj9t32ELbh2VNbE/7QEVZnXRi5GdhozBZtS1gJHM2/Q+iToyh5dfTaA
U8bTnLEPMNC1h3qcUQIDAQAB
-----END PUBLIC KEY-----";

$private = "-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQDfmlc2EgrdhvakQApmLCDOgP0nNERInBheMh7J/r5aU8PUAIpG
XET/8+kOGI1dSYjoux80AuHvkWp1EeHfMwC/SZ9t6rF4sYqV5Lj9t32ELbh2VNbE
/7QEVZnXRi5GdhozBZtS1gJHM2/Q+iToyh5dfTaAU8bTnLEPMNC1h3qcUQIDAQAB
AoGAcbh6UFqewgnpGKIlZ89bpAsANVckv1T8I7QT6qGvyBrABut7Z8t3oEE5r1yX
UPGcOtkoRniM1h276ex9VtoGr09sUn7duoLiEsp8aip7p7SB3X6XXWJ9K733co6C
dpXotfO0zMnv8l3O9h4pHrrBkmWDBEKbUeuE9Zz7uy6mFAECQQDygylLjzX+2rvm
FYd5ejSaLEeK17AiuT29LNPRHWLu6a0zl923299FCyHLasFgbeuLRCW0LMCs2SKE
Y+cIWMSRAkEA7AnzWjby8j8efjvUwIWh/L5YJyWlSgYKlR0zdgKxxUy9+i1MGRkn
m81NLYza4JLvb8/qjUtvw92Zcppxb7E7wQJAIuQWC+X12c30nLzaOfMIIGpgfKxd
jhFivZX2f66frkn2fmbKIorCy7c3TIH2gn4uFmJenlaV/ghbe/q3oa7L0QJAFP19
ipRAXpKGX6tqbAR2N0emBzUt0btfzYrfPKtYq7b7XfgRQFogT5aeOmLARCBM8qCG
tzHyKnTWZH6ff9M/AQJBAIToUPachXPhDyOpDBcBliRNsowZcw4Yln8CnLqgS9H5
Ya8iBJilFm2UlcXfpUOk9bhBTbgFp+Bv6BZ2Alag7pY=
-----END RSA PRIVATE KEY-----";

if (!$privateKey = openssl_pkey_get_private($private)) die('Loading Private Key failed');
if (!$publicKey = openssl_pkey_get_public($public)) die('Loading Public Key failed'); 
```

我还将包括一个小的编码/解码示例：

```
$encrypted = '';
$decrypted = '';

$plaintext = 'This is just some text to encrypt';

echo '<p>$plaintext = ' . $plaintext . '<p>';

if (!openssl_public_encrypt($plaintext, $encrypted, $publicKey))    die('Failed to encrypt data');

echo '<p>$encrypted = ' . $encrypted . '<p>';

if (!openssl_private_decrypt($encrypted, $decrypted, $privateKey))  die('Failed to decrypt data');

echo '<p>$decrypted = ' . $decrypted . '<p>'; 
```

或者以防万一您可以使用 php 生成密钥：

```
$NEW_KEY = openssl_pkey_new(array(
    'private_key_bits' => 1024,
    'private_key_type' => OPENSSL_KEYTYPE_RSA,
        ));

openssl_pkey_export_to_file($NEW_KEY, 'private.key');

$NEW_KEY_DETAILS = openssl_pkey_get_details($NEW_KEY);
file_put_contents('public.key', $NEW_KEY_DETAILS['key']);

openssl_free_key($NEW_KEY); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-06T00:03:15.917

请参考下一个网址。

[https://www.php.net/manual/en/function.openssl-pkey-get-private.php](https://www.php.net/manual/en/function.openssl-pkey-get-private.php)

要缩小您的问题范围，请*为您的 php 文件和密钥文件使用相同的目录*并尝试使用此工作代码。

**工作代码**

```
$keyfile="file://".__DIR__.DIRECTORY_SEPARATOR."key.pem"; //absolute path
$key = openssl_pkey_get_private($keyfile);

if ($key === false) {
    var_dump(openssl_error_string());
}else{
    var_dump($key);
} 
```

以下可能是一个问题。

1.  **小路**

以下路径样式应该可以工作。

```
$keyfile="file:///home/john/php/key.pem"; // unix absoulute path
$keyfile="file://C:\\users\\john\\php\\key.pem"; // windows absoulute path
$keyfile="file://".__DIR__.DIRECTORY_SEPARATOR."key.pem"; //absoulute path for unix, windows
$keyfile="file://key.pem"; // relative path, unix, windows, (php,key files in same directory)

$key = openssl_pkey_get_private($keyfile); 
```

如果路径不存在，错误会像

> “错误：02001002：系统库：fopen：没有这样的文件或目录”

2.  **网络环境**

    检查您的 Web 根和 Web 用户对文件夹和密钥文件的访问权限。

    为了减少问题，请在 php 内置 Web 服务器环境而不是 WAMP 环境上对其进行测试。

```
>php -S localhost:80 
```

3.  **损坏的密钥文件**

保存为包含空格的特定类型。这可能会发生类似下一个错误。

> “错误：0906D06C：PEM 例程：PEM_read_bio：没有起始行”

```
in my case, key file was saved as UTF-8 with BOM(whitespaces) 
```

**调试密钥文件 1 - 从变量中读取**

这段代码应该可以工作。我从 [http://micmap.org/php-by-example/en/function/openssl_pkey_get_private获得了密钥文件](http://micmap.org/php-by-example/en/function/openssl_pkey_get_private)

请将 $str 替换为您的。

```
$str = <<<EOF
-----BEGIN RSA PRIVATE KEY----- 
MIIEogIBAAKCAQEA0llCeBjy18RylTdBih9GMUSZIC3GzeN0vQ9W8E3nwy2jdeUn 
H3GBXWpMo3F43V68zM2Qz5epRNmlLSkY/PJUfJIC8Yc1VEokT52q87hH/XJ5eS8h 
eZnjuSlPAGi8oZ3ImVbruzV7XmlD+QsCSxJW7tBv0dqJ71e1gAAisCXK2m7iyf/u 
l6rT0Zz0ptYH4IZfwc/hQ9JcMg69uM+3bb4oBFsixMmEQwxKZsXk3YmO/YRjRbay 
+6+79bSV/frW+lWhknyGSIJp2CJArYcOdbK1bXx1dRWpbNSExo7dWwuPC0Y7a5AE 
eoZofieQPPBhXlp1hPgLYGat71pDqBjKLvF5GwIDAQABAoIBACPItYsSy3UzYT7L 
OKYTrfBBuD8GKpTqBfkHvAWDa1MD15P92Mr7l0NaCxGfAy29qSa6LdFy/oPM9tGY 
9TxKyV6rxD5sfwEI3+Z/bw6pIe4W5F1eTDaQnHHqehsatkRUQET9yXp+na8w/zRF 
0C0PQKS95tfvcpm59RGCdGQ8+aZw+cIy/xez75W8IS/hagMxe7xYPjpkOkSCCEJU 
zmbVq6AyWodASV0p4H9p8I+c0vO2hJ/ELJ167w6T+2/GlZg979rlyHoTW8jK2BbG 
IRGaPo+c2GANXa686tdpbkPd6oJliXwBSNolxmXShvlveBbPFAJJACzCmbXNj9kH 
6/K+SWkCgYEA7FNudcTkRPV8TzKhJ1AzDjw3VcnraYhY8IlNxbk7RVHLdkoUtwk/ 
mImeBlEfCoz9V+S/gRgeQ+1Vb/BCbS24+bN/+IGoNRFMRcOieFt6lQUpj7a9NeSo 
IEclGgUiU7QR3xH73SB4GC3rgSPeHJhJZC5EJq5TzYjXTPGPpBD3zicCgYEA49wz 
zfMDYIH8h4L65r/eJYIbLwpvgktgaYvhijO3qfZSWW+Y19jCBn55f65YOhPGQBHA 
my0f+tVxFNZ/OupbrAIIzogxlCIYHNBawDhoHN/sB3/lSBAjifySNLyRlA62oA0w 
wXvXVLVWMa3aXim3c9AlnLF1fHwcvwpOKSfdye0CgYBb1mBKq+T5V1yjek1d9bCh 
i40FbZ5qOG43q2Ppvn3mBk9G/KroJlPsdy5NziB9/SRGj8JL7I92Xjihc4Cc5PPJ 
NZQ5gklXtg0p30i39PTCDGuGScFlvCIJyRwF7JDWblezlE2INSH2Y4HtgX7DJfr/ 
T2t0jLJMYS0p3YWwgFeMaQKBgHUIe/8y6zAdc5QynSX5tGL1gXrW1FFK39k2RICU 
cag1YTSYkhuDNJzbRxJifORPlcsAkzngooVWLb+zMCQVjUI6xUU3RKe+Hz5lccc6 
8ZarGHL9qMkrqOVNudamZ+tw5zIrtDgcoIvcm8nmbrtgl94/MaJar2ph4O3qoByZ 
Ylw9AoGAIdS79s0VKkj4VVXqK47ZcI7jGL4V4C8ujU8YcMNV88xwCoDg9ZIFprWA 
P5p/cnvj6aHnqL58XiH0+bE0Lt3J+U6N6JelQQevgBHooMFh4FpDXcVda7xB3rK3 
woqbi8fNhr827H2maxIZPtVG95/mvR4k5z1Jrdnr34ZUmtC6U5Q= 
-----END RSA PRIVATE KEY-----
EOF;

$key = openssl_pkey_get_private($str);
if ($key === false) {
    var_dump(openssl_error_string());
}else{
    var_dump($key);
} 
```

输出

> resource(4) 类型（OpenSSL 密钥）

**调试密钥文件 2 - 从文件中读取**

将您的密钥字符串（$str）复制到“key.pem”之类的密钥文件中。

```
$str = <<<EOF
-----BEGIN RSA PRIVATE KEY----- 
...YOUR KEY STINGS HERE...
-----END RSA PRIVATE KEY-----
EOF;

$str2 = file_get_contents("key.pem");

$len1 = strlen ($str);
$len2 = strlen ($str2);
if($len1 !== $len2) echo "File has been corrupted.";

$key = openssl_pkey_get_private($str2);

if ($key === false) {
    var_dump(openssl_error_string());
}else{
    var_dump($key);
} 
```

# iphone - 如何处理 UITableView 或 ScollView 之类的触摸事件

> ID：10774129
> 
> 赞同：0
> 
> 时间：2012-05-27T12:55:42.670
> 
> 标签：iphone, objective-c, ios, cocoa-touch, ipad

我做了一个客户控件，继承自`UIView`并`UIButton`在`UIView`. 当用户触摸和移动时，我会做一些动画：让按钮按功能移动`touchesMoved`：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
```

但是 buttonClick 事件似乎具有更高的优先级。

我想它可以喜欢`UITableView`，滚动的东西比按钮点击有更高的优先级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:22:14.543

您需要查看[UIPanGestureRecognizer](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPanGestureRecognizer_Class/Reference/Reference.html)。

它允许您取消发送到其他处理程序的事件。

* * *

更新了有关如何保护先前点的其他信息。

在动作回调中，您会收到初始触摸位置的通知`recognizer.state == UIGestureRecognizerStateBegan`。您可以将此点保存为实例变量。您还可以在不同的时间间隔收到回调`recognizer.state == UIGestureRecognizerStateChanged`。您也可以保存此信息。然后，当您使用 获得回调时`recognizer.state == UIGestureRecognizerStateEnded`，您会重置所有实例变量。

```
- (void)handler:(UIPanGestureRecognizer *)recognizer
{
    CGPoint location = [recognizer locationInView:self];
    switch (recognizer.state)
    {
        case UIGestureRecognizerStateBegan:
            self.initialLocation = location;
            self.lastLocation = location;
            break;
        case UIGestureRecognizerStateChanged:
            // Whatever work you need to do.
            // location is the current point.
            // self.lastLocation is the location from the previous call.
            // self.initialLocation is the location when the touch began.

            // NOTE: The last thing to do is set last location for the next time we're called.
            self.lastLocation = location;
            break;
    }
} 
```

希望有帮助。

# iphone - UIScrollView 子类和自定义委托：检测子类和委托上的滚动事件

> ID：10774137
> 
> 赞同：0
> 
> 时间：2012-05-27T12:56:46.357
> 
> 标签：iphone, ios5, delegates, uiscrollview, uiscrollviewdelegate

我正在创建一个 UIScrollView 子类。在这个子类上，我需要检测滚动事件，但我还想启用对委托的滚动事件的检测。此外，这个 UIScrollView 子类需要一个自定义委托。

```
// CustomScrollView.h
#import <UIKit/UIKit.h>
#import "CustomScrollViewDelegate.h"

@interface CustomScrollView : UIScrollView <UIScrollViewDelegate> {
    ...
}

@property (nonatomic, assign) id <DAGridViewDelegate> delegate;

...

@end

// CustomScrollView.m
#import "DAGridView.h"

@implementation DAGridView

@synthesize delegate;

- (id)init {
    self = [super init];
    if (self) {
        ...
    }
    return self;
}

...

@end

// CustomScrollViewDelegate.h

@class CustomScrollViewDelegate

@protocol CustomScrollViewDelegate <NSObject, CustomScrollViewDelegate>

...

@end 
```

谢谢帮忙！！

如果您需要更多信息，请发表评论！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:13:45.660

好吧，您可以简单地在 init 中声明

```
self.delegate = self; // to have your custom scroll view as its own delegate 
```

并将您正在实施的新协议的自定义委托重命名为 CustomDelegate 以避免出现问题

那么您必须覆盖滚动视图调用的每个方法，并在每个方法中添加类似

```
[customDelegate ovveriddenScrollviewDelegateMethod]; 
```

你在你的类中实现的将是customDelgate，

```
<UIScrollViewDelegate, CustomScrollViewDelegate> 
```

并实施一切。

# c# - 多重继承，无多重继承，无代码重复

> ID：10774143
> 
> 赞同：5
> 
> 时间：2012-05-27T12:57:45.937
> 
> 标签：c#, java, oop, inheritance

我有一个关于如何用不允许多重继承的语言处理以下场景的理论问题。

想象一下，我有一个基类*Foo*，我希望从中创建三个子类：

*   类*Bar*继承*Foo*并实现功能“A”
*   *Baz*类继承*Foo*并实现功能“B”
*   *Qux*类继承*Foo*并实现功能“A”和“B”

想象一下实现功能“A”和“B”的代码总是相同的。有没有办法只为“A”和“B”编写一次代码，然后应用适当的类（或“继承”）它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:07:28.497

好吧，我可以看到您在 C#/Java 中实现这一目标的唯一方法是通过组合。考虑一下：

```
class Foo {

}

interface A {
    public void a();
}

interface B {
    public void b();
}

class ImplA implements A {
    @Override
    public void a() {
        System.out.println("a");
    }
}

class ImplB implements B {
    @Override
    public void b() {
        System.out.println("b");
    }
}

class Bar extends Foo {
    A a = new ImplA();

    public void a() {
        a.a();
    }
}

class Baz extends Foo {
    B b = new ImplB();

    public void b() {
        b.b();
    }       
}

class Qux extends Foo {

    A a = new ImplA();
    B b = new ImplB();

    public void b() {
        b.b();
    }

    public void a() {
        a.a();          
    }       
} 
```

现在`Qux`既有`Foo`通过普通继承的功能，也有通过组合的`A`实现`B`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T14:02:26.757

更通用的术语是[Mixin](http://en.wikipedia.org/wiki/Mixin)。一些语言提供开箱即用的支持，例如 Scala 和 D。不过，有多种方法可以在其他语言中实现相同的结果。

在 C# 中创建伪混合的一种方法是使用空接口并为方法提供扩展方法。

```
interface A { }
static class AMixin {
    public static void aFunc(this A inst) {
        ... //implementation to work for all A.
    }
}

interface B { }
static class BMixin {
    public static void bFunc(this B inst) {
        ...
    }
}

class Qux : Foo, A, B {
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T13:03:03.693

这在提供特征的语言中是可以实现的（这里：[scala](/questions/tagged/scala "显示标记为“scala”的问题")）：

```
class Foo {
    def fooM() {}
}

trait A {
    def aFunc() {}
}

trait B {
    def bFunc() {}
}

class Bar extends Foo with A {}

class Baz extends Foo with B {}

class Qux extends Foo with A with B {} 
```

因为 Scala 在 Java 之上运行（既没有多重继承也没有特征），所以它被翻译成这样的东西（简化）——这可能是一个提示如何在 Java/C# 中手动实现它：

```
class Foo {
}

interface A {
    void aFunc();
}

interface B {
    void bFunc();
}

class Bar extends Foo implements A {

    public void aFunc() {
        $A.aFunc();
    }
}

class Baz extends Foo implements B {

    public void bFunc() {
        $B.bFunc();
    }
}

class Qux extends Foo implements A, B {

    public void aFunc() {
        $A.aFunc();
    }

    public void bFunc() {
        $B.bFunc();
    }
}

class $A {

    public static void aFunc() {}
}

class $B {

    public static void bFunc() {}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T14:20:23.057

有几种方法可以做这样的事情。更具体地说，如果我们暂时放弃继承方面，有一些方法可以将相同的功能单元引入不同的类，而只需编写一次该单元。

好的，我*喜欢* [AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming)框架，它们适用于多种语言（C# 和 Java 有几种）。AOP 框架基本上允许您将自包含功能添加到整个继承结构中的不同类中。

对于 C#，您有[PostSharp](http://www.sharpcrafters.com/)，对于 Java，您有[AspectJ](http://www.eclipse.org/aspectj/)等等。

许多 AOP 框架允许在不使用继承的情况下“劫持”或“覆盖”方法调用。

# asp.net - 如何正确注销用户

> ID：10774145
> 
> 赞同：1
> 
> 时间：2012-05-27T12:57:54.827
> 
> 标签：asp.net, asp.net-membership

我有一个 ASP.NET 会员提供程序，它运行良好，但我注意到如果用户更改密码注销然后尝试再次登录它会失败，如果用户有两个或更多帐户并注销也会发生这种情况一个并尝试与另一个登录。如果用户在浏览器中清除了 cookie，他/她可以再次登录，所以当用户退出时，cookie 似乎由于某种原因没有被删除。这是我的退出代码：

```
void ClearAuthenticationCookie()
    {
        var cookie1 = new HttpCookie(FormsAuthentication.FormsCookieName, String.Empty) { Expires = DateTime.Now.AddYears(-1) };
        Response.Cookies.Add(cookie1);            
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        FormsAuthentication.SignOut();

        ClearAuthenticationCookie();

        FormsAuthentication.RedirectToLoginPage();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T18:46:09.513

我现在想通了，这真的很愚蠢；退出页面中的 FormsAuthentication.RedirectToLoginPage() 将 /Login.aspx?ReturnUrl=%2fAccount%2fLogout.aspx 放入 URL，因此如果您尝试登录，它会再次重定向回退出页面。我应该早点看到这个，抱歉浪费你的时间:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:59:09.587

尝试在您的登出页面的页面加载中添加此内容：

```
Session.Clear(); 
```

# android - 短信接收器即服务

> ID：10774150
> 
> 赞同：0
> 
> 时间：2012-05-27T12:58:41.397
> 
> 标签：android

我已经创建了 SMS Receiver 应用程序...但我想将它创建为一项服务，它应该在后台运行（即此应用程序没有单独的 UI，希望像警报应用程序一样工作），即使移动设备重新启动它也会自动启动。 ..有人可以帮忙吗？

我以前的 SMS Receiver 应用程序代码在这里 [Unable to instance activity ComponentInfo in Android Receive Sms App](https://stackoverflow.com/questions/10769107/unable-to-instantiate-activity-componentinfo-in-android-receive-sms-app)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:07:12.600

> 它应该在后台运行

您现有`BroadcastReceiver`的（未记录的）`android.provider.Telephony.SMS_RECEIVED`已经在后台运行。

> 即使手机重新启动它也会自动启动

设备重新启动后，您现有`BroadcastReceiver`的（未记录的）`android.provider.Telephony.SMS_RECEIVED`已经可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T13:06:14.020

如果你希望你的服务在手机启动时运行，你应该简单地用这个意图过滤器声明一个广播接收器：

```
 <receiver android:name="MyStartupIntentReceiver">
<intent-filter>
<action
android:name="android.intent.action.BOOT_COMPLETED" />
<category android:name="android.intent.category.HOME" />
</intent-filter>
</receiver> 
```

在广播接收器 onReceive() 方法中，只需启动您的服务：

```
public void onReceive(Context context, Intent intent) {
    Intent serviceIntent = new Intent();
    serviceIntent.setAction("myPackage.MyService");
    context.startService(serviceIntent);

} 
```

并确保将清单中的服务与您在广播接收器中启动的意图的相同名称链接：

```
<service android:name="MyService">
<intent-filter>
<action
android:name="myPackage.MyService" />
</intent-filter>
</service> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T13:50:55.080

正如 CommonsWare 所说，实际上不需要在后台运行“服务”来接收 SMS 广播，如果在清单中正确注册，则使用“android.provider.Telephony.SMS_RECEIVED”作为意图过滤器的 BroadcastReceiver 将触发每次收到 SMS 时都不需要其他操作。

根据您到底想要做什么，您可以从该广播接收器通过实际服务工作，或者可能更好的选择是使用 IntentService。这是因为用于广播的线程在启动后不久就会被杀死，所以你不应该在其中做任何大量的工作。

通常建议不要使用实际的“服务”，除非明确要求....但如果这是您需要的，那么您需要 Davide 应该为您提供正确的方向。

# javascript - “在新选项卡/窗口中打开”时的 .click() 事件

> ID：10774151
> 
> 赞同：9
> 
> 时间：2012-05-27T12:58:50.580
> 
> 标签：javascript, jquery

当我`.click()`在`<a>`标签上使用时，该事件仅在我单击元素时才有效。否则，如果用户执行右键单击 > 在新窗口中打开或在新选项卡中打开，则不会触发`click()`事件。

`click()`所以，我的问题是......当用户右键单击>在新选项卡/窗口中打开时如何触发事件？

这是HTML：

```
<a href="url">Click Me</a> 
```

这是Js：

```
$("a").click(function(){
  alert('You clicked me!');
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:16:29.420

您可以尝试此代码，但请记住更改 UI 不是一个好主意：

```
var addEvent = (document.addEventListener) ?
    function(target,event,fn){
        if(target) return target.addEventListener(event,fn,false);
    }:
    function(target,event,fn){
        if(target) return target.attachEvent(('on' + event),fn);
    },
allLinks = document.links || document.getElementsByTagName('a');
for(var i=0;i<allLinks.length;i++)
    addEvent(allLinks[i],'mouseup',function(e){
        var e = e  || event;
        if(e.which===3){
            alert('Open in new tab/window');
            e.preventDefault();
            return false;
        }
    }); 
```

# path - 并非所有代码都返回一个值

> ID：10774156
> 
> 赞同：1
> 
> 时间：2012-05-27T12:59:59.347
> 
> 标签：path, return

```
private static long CalculateScore(byte chances, long millisec) { int score; byte num1 = chances++; byte num2 = (byte)10; byte num3 = (byte)10; switch (Program.currLevelIndex) { case (byte)7: num2 = (byte)10; break; case (byte)11: num2 = (byte)20; break; case (byte)15: num2 = (byte)40; break; }

    if ((int)chances >= 1 && (int)chances <= 3)
        num1 = (byte)40;
    else if ((int)chances >= 4 && (int)chances <= 6)
        num1 = (byte)20;
    else if ((int)chances > 7)
        num1 = (byte)10;
    if (millisec > 480000L)
        num3 = (byte)10;
    else if (millisec >= 240000L && millisec <= 480000L)
        num3 = (byte)20;
    else if (millisec < 240000L)
        num3 = (byte)40;
    try
    {
        score = Convert.ToInt32((int)num2 * (int)num1 * (int)num3);
    }
    catch
    {
        score=0;
    }

    Console.SetCursorPosition(Program.x, Program.y);
    Console.Write("Your Score was: " + score); 
```

}`

> 错误是CalculateScore，我找不到错误。这是一种需要帮助的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:01:33.910

`private static long CalculateScore`需要一个 long 类型的返回值，但您的方法不返回任何内容。

将以下内容添加到方法的末尾。

```
return score; 
```

您可能希望将返回类型更改为`int`或将分数变量更改为`long`

```
private static int CalculateScore(byte chances, long millisec)
{
  int score; 
  byte num1; 
```

或者

```
private static long CalculateScore(byte chances, long millisec)
{
  long score; 
  byte num1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:02:58.093

您指定该函数将返回一个类型的值`long`，但在函数末尾没有返回值的 return 语句

您需要添加

```
return score; 
```

和`score`计算结果一样

# c# - 具有存储库模式的域模型

> ID：10774161
> 
> 赞同：4
> 
> 时间：2012-05-27T13:00:13.737
> 
> 标签：c#, java, .net, oop, architecture

我有一个对象：图书馆

一个图书馆可以拥有多本书籍、CD 和论文。除了具有 Address 属性的 Library 类之外，每个类都有 Id、Name 和 Price 属性。

我想创建存储库模式来抽象数据从上面的层存储的位置。现在，数据存储在 xml 文件中。

```
<library>
<books></books>
<cds></cds>
<papers></papers
</library> 
```

稍后我们正在考虑将其存储在数据库中。然后我们将有一个图书馆桌、一个书桌、一个 cd 桌和一个文件桌。

用户在屏幕上创建一个图书馆对象，然后在屏幕上创建书籍、CD 和论文。

然后他点击保存。那时，我想获取新创建的库对象并将其保存在 XML 中，因此我想要存储库并使用依赖注入，我将在上面的层中注入 xml 存储库的实现，以便将数据存储到正确的位置。我可以序列化库对象并获取 xml 并调用简单的 Save 方法来保存库对象。

但想象一下，我将 XMLRepository 替换为 DatabaseRepository。

在这种情况下，我希望上面的其余层保持不变。我希望 LibraryRepository.Save() 会照顾它是否需要进入 XML、CSV 或 DB。我很困惑如何创建存储库模式来解决 LibraryRepository.Save() 方法。

世界各地的每个人都说 Repository 类应该有一个单一的职责。它应该只保存一种对象类型，不应该获取一个对象，获取它的相关类并保存它们。每个类都应该有自己的 Repository 类。

每个库对象也有多个 Books 对象。我不想使用 for 循环并浏览 LibraryRepository.Save 方法中的每本书。

我不确定我应该如何创建我的域模型并调用 Library Save() 方法。

请指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T10:58:53.767

由于存储库是 BL 持久性的抽象，因此请使用存储库接口。

每个存储库实现都应该处理到数据存储的对象结构映射，或者使用特定的映射器。BL/Service 类将通过接口与存储库一起工作，而无需了解特定存储库的内部实现。

所以你会有类似的东西

```
class LibraryService {
    public LibraryService (ILibraryRepository repo) {} 
    public DoSomeWork(somedata) {
        Library lib = repo.Load(somedata.libid);
        ....
        repo.Save(lib);
    }
} 
```

和几个实现

```
class DBLibraryRepository : ILibraryRepository {
    public Save(Library lib) {
        //hibernate session 
        //and you'll have mapping defined for all entities
        //and relations between library and stuff, so books are saved automatically
        _session.Save(lib)
    }
}

class XMLLibraryRepository : ILibraryRepository {
    public Save(Library lib) {
        //serialized does all the work, so no additional loops here
        var xml = Serialize(lib);
        SaveToFile(xml);
    }
}

class CSVLibraryRepository : ILibraryRepository {
    public Save(Library lib) {
        //for example, save library to lib.csv, books - to books.csv.
        //add mappers to do real work, but we'd take care of separation 
        //of books and library manually.
        // (in case of ORM - it has own mappers, 
        //  for XML - serializator is mapper itself)
        var data = LibraryCSVDataMapper.Map(lib);
        data.Save();
        foreach(var book in lib.Books){
            data = BookCSVDataMapper.Map(book);
            data.Save();
        }
    }
} 
```

# android - Android Gallery 冻结屏幕直到滚动

> ID：10774164
> 
> 赞同：2
> 
> 时间：2012-05-27T13:00:41.827
> 
> 标签：android, gallery, freeze

我有一个全屏自定义图库。图库的元素有按钮和其他交互区域。一些用户界面是通过在画廊前面弹出的对话框完成的；当一个对话框被关闭时，用户被带回画廊。

大多数情况下，这工作正常。但是，有时，在关闭对话框后，按钮会停止接受用户输入。另一方面，画廊仍在滚动。更奇怪的是，只要我滚动图库，系统就会处理那些我认为失败的点击（弹出对话框等）。

很容易说主 UI 线程被锁定。为什么会被锁定？如何解锁？任何帮助将不胜感激。下面是该类的完整代码。

**更新。** 图库中的元素之一是`HorizontalScrollView`. 当我尝试滚动它时，鼠标消息会出现；我穿过它们，看到`scrollBy()`and`invalidate()`被正确调用。然后我打印出消息队列。唯一通过主循环的事件是 1006，我假设是 Touch 事件。Draw 事件，1000，永远不会成功。一旦我来回滚动图库 - 你瞧 - 消息队列开始接收 1000 个，所以`HorizontalScrollView`滚动很好！

所以问题就变成了：是什么停止了 Draw 事件，我如何确保它们被发送到队列中？

```
public class PlayerGallery extends Gallery
{
  // 4 buttons to display
  private final static int BUT_BIRD = 0;
  private final static int BUT_SCORE = 1;
  private final static int BUT_ROUND = 2;
  private final static int BUT_MOVE = 3;
  private final static int N_BUTTONS = 4;

  // button images
  private final static Drawable[] imgButtons =
  {
    WonDraw.WW.bird,
    WonDraw.WW.scores,
    WonDraw.WW.moveSumm,
    WonDraw.WW.lastMove,
  };

  // individual player views
  private PlayerView[] views;

  // card that was clicked in the current player view
  private Card clickedCard = null;

  // wonder that was clicked in the current player view
  private Player clickedWonderPlayer = null;

  // one player
  private final class PlayerView extends RelativeLayout
    implements OnClickListener
  {
    // base view ID for the buttons
    private final static int BUT_VIEW_ID = 200;

    // player to display
    final Player player;

    // drawing data
    private PlayerDisplay pd = null;

    // the sub-view on top that shows player's hand
    private HandView handView = null;

    // button that takes user into bird's view
    private final GlassButton[] buttons = new GlassButton[N_BUTTONS];

    public PlayerView(Player player)
    {
      super(WonActivity.W.getApplicationContext());
      setBackgroundColor(Color.TRANSPARENT);
      this.player = player;

      RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
          LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT);
      lp.addRule(ALIGN_PARENT_TOP);
      handView = new HandView();
      addView(handView, lp);

      for (int i = 0; i < buttons.length; ++i)
      {
        lp = new RelativeLayout.LayoutParams(
            LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);

        if (i % 2 == 0)
          lp.addRule(ALIGN_PARENT_RIGHT);
        else
          lp.addRule(LEFT_OF, buttons[i - 1].getId());

        lp.addRule(BELOW, i / 2 == 0 ? handView.getId() : buttons[i - 2].getId());
        GlassButton but = new ImgGlassButton(GlassButton.ROUND, imgButtons[i]);
        but.setId(BUT_VIEW_ID + i);
        but.setOnClickListener(this);
        buttons[i] = but; addView(but, lp);
      }
    }

    // reset for the next player
    void reset(boolean useBigCards)
    {
      pd = WonActivity.W.getDisplay(player.id, useBigCards);

      if (useBigCards)
      {
        handView.pd = pd;
        handView.hand = WonActivity.W.getCurrentHand();
        handView.setVisibility(VISIBLE);
        handView.requestLayout();
        handView.scrollTo(0, 0);
      }
      else
      {
        handView.pd = null;
        handView.hand = null;
        handView.setVisibility(GONE);
      }

      for (int i = BUT_ROUND; i <= BUT_MOVE; ++i)
        buttons[i].setEnabled(Table.T.movesAvailable());

      invalidate();
    }

    @Override
    protected void dispatchSetPressed(boolean pressed)
    {
      // if I don't do that, bird button gets pressed when I scroll the gallery!
    }

    @Override
    public boolean onTouchEvent(MotionEvent event)
    {
      if (event.getAction() == MotionEvent.ACTION_DOWN)
      {
        int x = (int)event.getX();
        int y = (int)event.getY();

        clickedCard = pd.findSmallCard(x, y);
        clickedWonderPlayer = clickedCard == null && pd.isInWonder(x, y) ?
          player : null;
      }
      return super.onTouchEvent(event);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec)
    {
      super.onMeasure(MeasureSpec.makeMeasureSpec(WonActivity.W.getWidth() - 2, MeasureSpec.EXACTLY),
          MeasureSpec.makeMeasureSpec(WonActivity.W.getHeight(), MeasureSpec.EXACTLY));
      setBackgroundColor(Color.TRANSPARENT);
      setBackgroundDrawable(WonDraw.W.getWood());
    }

    @Override
    protected void onDraw(Canvas canvas)
    {
      super.onDraw(canvas);
      if (pd == null) return;

      canvas.save();
      pd.draw(canvas, handView.hand, true);
      canvas.restore();
    }

    public void onClick(View v)
    {
      switch (v.getId() - BUT_VIEW_ID)
      {
        case BUT_BIRD:
          WonActivity.W.switchToBird(player.id);
          break;

        case BUT_SCORE:
          WonActivity.W.showScoreDlg();
          break;

        case BUT_ROUND:
          WonActivity.W.showRoundDlg();
          break;

        case BUT_MOVE:
          break;
      }
    }
  };

  // custom adapter for the gallery: provides circular functionality
  private class PGAdapter extends BaseAdapter
  {
    public int getCount()
    {
      return Integer.MAX_VALUE;
    }

    public Object getItem(int position)
    {
      return position;
    }

    public long getItemId(int position)
    {
      return position;
    }

    public View getView(int position, View convertView, ViewGroup parent)
    {
      return views[position % views.length];
    }
  };

  public PlayerGallery()
  {
    super(WonActivity.W.getApplicationContext());
    setSpacing(0);
    setBackgroundColor(Color.TRANSPARENT);

    views = new PlayerView[Table.T.getPlayerCount()];

    for (int i = 0; i < Table.T.getPlayerCount(); ++i)
      views[i] = new PlayerView(Table.T.getPlayer(i));

    setAdapter(new PGAdapter());
    setHorizontalFadingEdgeEnabled(false);
    setVerticalFadingEdgeEnabled(false);
  }

  // reset for the next player
  void changeMovingPlayer()
  {
    for (int i = 0; i < views.length; ++i)
      views[i].reset(i == WonActivity.W.getCurrentPlayerID());
    setViewedPlayer(Math.max(WonActivity.W.getCurrentPlayerID(), 0));
  }

  // set the player whose buildings to view
  void setViewedPlayer(int index)
  {
    int pos = Integer.MAX_VALUE / 2;
    pos -= pos % views.length;
    setSelection(pos + index);
    views[index].requestFocus();
    views[index].invalidate();
  }

  @Override
  public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY)
  {
    int kEvent = e2.getX() > e1.getX() ?
      KeyEvent.KEYCODE_DPAD_LEFT :
      KeyEvent.KEYCODE_DPAD_RIGHT;
    onKeyDown(kEvent, null);

    return true;
  }

  @Override
  public boolean onTouchEvent(MotionEvent event)
  {
    boolean b = super.onTouchEvent(event);

    switch (event.getAction())
    {
      case MotionEvent.ACTION_DOWN:
        return true;

      case MotionEvent.ACTION_UP:
        if (event.getEventTime() - event.getDownTime() < WonActivity.CLICK_MS)
        {
          if (clickedCard != null)
            WonActivity.W.showCardDlg(clickedCard);
          else if (clickedWonderPlayer != null)
            WonActivity.W.showWonderDlg(clickedWonderPlayer);
        }

        clickedCard = null;
        clickedWonderPlayer = null;
        break;
    }

    return b;
  }

  @Override
  protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec)
  {
    int w = MeasureSpec.getSize(widthMeasureSpec);
    int h = MeasureSpec.getSize(heightMeasureSpec);

    WonActivity.W.resize(w, h);
    super.onMeasure(MeasureSpec.makeMeasureSpec(w, MeasureSpec.EXACTLY),
        MeasureSpec.makeMeasureSpec(h, MeasureSpec.EXACTLY));
  }
} 
```

# java - 为什么 System.in 声明为 nullInputStream() 而不是 null？

> ID：10774165
> 
> 赞同：10
> 
> 时间：2012-05-27T13:01:03.013
> 
> 标签：java

在[`System`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/System.java)类中`in`，`out`、 和`err`是静态字段。例如，声明了这些字段：

```
 public final static InputStream in = nullInputStream(); 
```

为什么要声明[`nullInputStream()`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/System.java#System.nullPrintStream%28%29)而不是`null`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T13:13:02.883

源代码有以下注释：

```
/**
 * The following two methods exist because in, out, and err must be
 * initialized to null.  The compiler, however, cannot be permitted to
 * inline access to them, since they are later set to more sensible values
 * by initializeSystemClass().
 */ 
```

简而言之，因为`System.in`是一个`static final`变量，如果它被设置为`null`，编译器会将它视为一个常量，并将`System.in`其他类中的所有引用替换为`null`（这就是内联的意思）。这显然会使一切都不起作用。一旦系统初始化，必须使用一些本机代码来替换这个`System.in`最终值的值（通常不应该改变）。

恢复：它用于避免在这种特殊情况下不应该进行的编译器优化，因为 System.in 是一个可以更改的最终字段，这通常是不可能的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-27T13:04:40.667

**你错了。**

在 Java 源代码中，它被写成

```
 public final static InputStream in = null; 
```

不是

```
 public final static InputStream in = nullInputStream(); 
```

您可以在[此处](http://www.docjar.com/html/api/java/lang/System.java.html)`System`参考 该类的源代码。

# ruby-on-rails - 如何将 Ruby 数组从我的 Heroku 控制台导出到 CSV？

> ID：10774167
> 
> 赞同：23
> 
> 时间：2012-05-27T13:01:07.997
> 
> 标签：ruby-on-rails, ruby, csv, heroku

我希望将一个数组从我的 heroku 控制台导出到本地 CSV 文件中。

在我目前的情况下，我每天都有一个 rake 任务，它会查找关于我的应用程序的推文。我想分析这些推文，看看它们是什么时候进来的，等等：

```
heroku run console
tweets = Tweet.all
code to export tweets into a local CSV file goes here 
```

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-27T17:31:14.460

您无法从 heroku 控制台访问本地文件系统。一种选择是使用[Tee](http://en.wikipedia.org/wiki/Tee_%28command%29)。Tee 将输出发送到 STDOUT 和文件，因此您可以拥有打印的所有内容的本地日志。

```
heroku run console | tee output.txt 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-07-15T22:35:40.033

我尝试按照建议使用 Tee 并且也陷入了困境

```
Running `console` attached to terminal... up, run.4165 
```

我最终在 localhost 上运行了一个 SSH shell，然后通过 tee 进行管道传输。

```
$ ssh localhost | tee output.txt
$ heroku run console 
```

可能不是最好的解决方案，但它对我有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-08T16:16:57.620

FWIW，您可以很容易地放置一个带有逗号和换行符的字符串，然后将粘贴复制到您的文本编辑器中并另存为 .csv，尽管“所有推文”可能有点笨拙。

```
tweets = Tweet.all
@string = String.new()
@string << Tweet.last.attributes.keys.join(", ") + "\n" # "header" row with attribute names

tweets.each do |t|
  @string << t.attributes.values.join(", ") + "\n"
end

puts @string #will output string with \n newline which you could then copy paste into your editor and save as a csv 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-11T23:08:32.360

感谢你们的帮助，我关注了这个 railscast [http://railscasts.com/episodes/362-exporting-csv-and-excel](http://railscasts.com/episodes/362-exporting-csv-and-excel)并添加了一种从管理面板导出到 excel 的方法。

再次感谢。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-27T14:45:11.880

我会使用 Taps 将数据库导出到您的本地计算机，然后在那里对其进行操作：[https ://devcenter.heroku.com/articles/taps](https://devcenter.heroku.com/articles/taps)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-17T22:29:46.197

您可以向 SCP 支付费用：

```
my_data = "hello world"
File.write("tmp/data", my_data)
`scp tmp/data me@some-server:` 
```

它可能会提示您服务器未知并要求输入密码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-03T08:16:18.133

您还可以使用`rails runner`在 heroku 上运行一行或三行代码并将结果通过管道（或 tee）传输到文件：

```
heroku run rails runner \'Tweet.all.to_csv\' -a my-app-name | all_tweets.csv 
```

如果文件中显示了 Rails 日志记录，则可以禁用它，如果文件中出现“Running `rails runner`”之类的启动记录，则可以修剪文件顶部，但这应该很容易做到。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-07-12T23:13:03.227

您可以在 Heroku 实例上运行 Ruby：

`echo 'p User.first' | heroku run --no-tty 'ruby -W0 -r ./config/environment' > output.txt`

这会将第一个用户打印到`output.txt`文件中。

您还可以通过管道将其连接到标准输入，在 Heroku 上运行本地脚本。

`cat my_script.rb | heroku run --no-tty 'ruby -W0 -r ./config/environment' > output.txt`

请注意，您可能会收到一些不需要的文本（如警告），这些文本将出现在`output.txt`文件的开头。您必须手动修剪它或使用修剪命令，例如：

`tail -n +4 -f`这不会打印前 4 行。

这是完整的示例：

`cat my_script.rb | heroku run --no-tty 'ruby -W0 -r ./config/environment' | tail -n +4 -f > output.txt`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-16T12:08:00.703

我按照建议尝试了 Tee，但由于某种原因，它总是在输出后卡住

```
Running `console` attached to terminal... up, run.1 
```

所以我最终以文本格式的电子邮件正文为我发送了 csv 内容。如果您已经设置了电子邮件，那也可以是简单的解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-18T16:54:41.870

我尝试使用新的 heroku 控制台执行以下步骤。我能够获取日志。

1.  键入命令脚本 output.txt（这将创建一个名为 output.txt 的文件以保存终端日志）
2.  打开heroku控制台并执行命令。

3.  完成后键入 ctrl + d。

终端日志保存在 output.txt 文件中。

# jquery - jquery css默认字体大小

> ID：10774168
> 
> 赞同：0
> 
> 时间：2012-05-27T13:01:21.680
> 
> 标签：jquery, css

我有一个表单，允许用户按下向上或向下按钮来调整元素中的字体大小。当我重置表单时，我需要将“默认”字体大小放回隐藏字段以发送到 php 脚本。那么如何才能获得实际输入到 css 样式表中的 css 字体大小，而不是被 jquery 更改的字体大小？

谢谢你，托德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:12:49.850

最简单的方法是在更改之前存储原始字体大小：

```
var originalFontSize = $myElement.css('font-size'); 
```

然后在您的代码中重置表单：

```
$myHiddenElement.attr('value', originalFontSize); 
```

您*可以*使用 Javascript 访问实际样式表中的定义 - 在[此处](http://www.javascriptkit.com/domref/stylesheet.shtml)描述- 但是您必须对元素的相关定义所在的位置做出各种假设，并且不会考虑任何特定于浏览器的覆盖等。在修改之前获取该元素的状态要容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T13:32:05.273

您可以在 CSS 中定义默认字体大小，如下所示：

```
#myelement {
    font-size: 12;
} 
```

然后您可以使用 javascript 在本地覆盖此值

```
var element = document.getElementById('myelement');
element.style.fontSize = new_font_size;  // local values override the value from the stylesheet. 
```

然后当你想将它设置为默认值时

```
var element = document.getElementById('myelement');
element.style.fontSize = null; // now it reverts back to using the value defined in the stylesheet 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T13:16:07.827

在更改字体大小之前，您需要在 JS 变量中设置默认值。

```
var defaultFontSize = 20; 
```

然后用它来做复位。

# javascript - 很好地显示数值

> ID：10774175
> 
> 赞同：1
> 
> 时间：2012-05-27T13:01:56.710
> 
> 标签：javascript, regex

我有一个对象 MyObject，其中包含一个属性 MyProp，该属性有时是数字。目前，我将数字显示为如下文本：

```
$('#MyDiv').text(MyObject.MyProp); 
```

我想为这个数字添加格式。我可以检查它的数字，但我想知道如何进行数字格式化。

```
if ($.isNumeric(MyObject.MyProp) === false) {

   $('#MyDiv').text(MyObject.MyProp);

} else {

   var PrettyNumber = MakePrettyNumber(MyObject.MyProp);
   $('#MyDiv').text(PrettyNumber);
} 
```

我正在考虑循环遍历数字字符串的长度并添加逗号以分隔千位并为小数添加一个点。有没有更好的办法？不需要插件的？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:06:28.333

```
function MakePrettyNumber(x) {
  var res = x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  res = res.replace(/^([^\.]*)$/g, "$1.000");
  return res;
} 
```

有关详细信息，请参见此处：[如何在 JavaScript 中打印带有逗号作为千位分隔符的数字](https://stackoverflow.com/questions/2901102/how-to-print-number-with-commas-as-thousands-separators-in-javascript)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-27T13:04:31.310

您可以执行以下操作：

```
var a= MyObject.MyProp,
number = a.substring(0,4) + ',' + a.substring(4,6) + ',' + a.substring(6) 
```

# c - C中的pow函数

> ID：10774177
> 
> 赞同：9
> 
> 时间：2012-05-27T13:02:24.903
> 
> 标签：c, gcc, pow, math.h

我编写了一个具有来自 math.h 库的幂函数的 C 代码。当我编译我的程序时，我收到一个错误，即“未定义对‘pow’函数的引用”，我使用 gcc 编译器（fedora 9）编译我的程序。

然后我将 -lm 标志插入 gcc，错误被省略，但 pow 函数的输出为 0。

```
#include<math.h>
main()
{
double a = 4, b = 2;
b = pow(b,a);
} 
```

谁能帮我？我的编译器有问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-27T13:56:39.377

对于寻求此类答案的其他所有人：

**这不起作用**：

```
gcc my_program.c -o my_program 
```

它会产生这样的东西：

```
/tmp/cc8li91s.o: In function `main':
my_program.c:(.text+0x2d): undefined reference to `pow'
collect2: ld returned 1 exit status 
```

**这将起作用**：

```
gcc my_program.c -o my_program -lm 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-27T13:06:30.980

您的程序不输出任何内容。

您所指的 0 可能是退出代码，如果您没有明确地从`main`.

尝试将其更改为符合标准的签名并返回`b`：

```
int main(void) {
  ...
  return b;
} 
```

请注意，返回值本质上仅限于 8 位的信息，因此非常非常有限。

用于`printf`显示值。

```
#include <stdio.h>
...
  printf("%f\n", b);
... 
```

您**必须**使用浮点转换说明符 ( `f`,`g`或`e`) 来打印`double`值。您不能使用`d`或其他人并期望一致的输出。（这实际上是未定义的行为。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-27T13:19:18.480

您缺少将值打印到标准输出的 printf 行。试试这个：

```
#include <stdio.h>
#include <math.h>

int main() {
        double a=4, b=2, c;

        c = pow(b,a);
        printf("%g^%g=%g\n", a,b,c);
        return 0;
} 
```

输出将是：

```
4^2=16 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-19T21:59:49.820

这里有关于基数和指数的混淆。这不是很明显，因为 2^4 和 4^2 都等于 16。

```
void powQuestion()
{
    double a, b, c;

    a = 4.0;
    b = 2.0;
    c = pow(b, a);

    printf("%g ^ %g = %g\n", a,b,c);        // Output: 4 ^ 2 = 16

    a = 9.0;
    b = 2.0;
    c = pow(b, a);

    printf("%g ^ %g = %g\n", a,b,c);        // Output: 9 ^ 2 = 512  >> Wrong result; 512 should be 81 <<

    // K & R, Second Edition, Fifty Second Printing, p 251: pow(x,y) x to the y

    double x, y, p;

    x = 9.0;
    y = 2.0;
    p = pow(x, y);

    printf("%g ^ %g = %g\n", x, y, p);      // Output: 9 ^ 2 = 81

    // even more explicitly

    double base, exponent, power;

    base = 9.0;
    exponent = 2.0;
    power = pow(base, exponent);

    printf("%g ^ %g = %g\n", base, exponent, power);    // Output: 9 ^ 2 = 81
} 
```

# c# - 低 FPS 的光渲染结果

> ID：10774183
> 
> 赞同：0
> 
> 时间：2012-05-27T13:03:09.080
> 
> 标签：c#, xna, rendering, lightning

我目前正在为我的 XNA 游戏开发一个类，它可以在图像上渲染灯光。当时，我已经制作了绘制光照贴图的源，但是，我的源中的 FPS 非常低。我知道在循环遍历每个像素时它会被残酷地减少，但是，我不知道有任何其他方法可以在 XNA 中的纹理上获取和设置每个像素，而是使用“For”语句？

当前来源：

```
 public struct Light
    {
        public int Range;
        public int Intensity;
        public Color LightColor;
        public Vector2 LightLocation;

        public Light(int _Range, int _Intensity, Color _LightColor, Vector2 _LightLocation)
        {
            Range = _Range;
            Intensity = _Intensity;
            LightLocation = _LightLocation;
            LightColor = _LightColor;
        }
    }
    public class RenderClass
    {
        [System.Runtime.InteropServices.DllImport("User32.dll")]
        public static extern bool MessageBox(IntPtr h, string S, string C, int a);

        public static Texture2D RenderImage(Light[] LightLocations, Texture2D ScreenImage, Viewport v, bool ShadowBack = false)
        {
            Texture2D[] Images = new Texture2D[LightLocations.Count()];
            int curCount = 0;

            /*LOOP THROUGHT EACH LIGHT*/
            foreach (Light LightLocation in LightLocations)
            {
                /*VARIABLES*/
                Color LightColor = LightLocation.LightColor;
                int Range = LightLocation.Range;
                int Intensity = LightLocation.Intensity;

                /*GET COLORS*/
                int Width = v.Width;
                int Height = v.Height;
                Color[] Data = new Color[Width * Height];
                ScreenImage.GetData<Color>(Data);

                /*VARIABLES TO SET COLOR*/
                Color[] SetColorData = new Color[Width * Height];

                /*CIRCEL*/
                int Radius = 15 / 2; // Define range to middle [Radius]
                int Area = (int)Math.PI * (Radius * Radius);

                for (int X = 0; X < Width; X++)
                {
                    for (int Y = 0; Y < Height; Y++)
                    {
                        int Destination = X + Y * Width;

                        #region Light
                        /*GET COLOR*/
                        Color nColor = Data[Destination];

                        /*CREATE NEW COLOR*/
                        Vector2 MiddlePos = new Vector2(LightLocation.LightLocation.X + Radius, LightLocation.LightLocation.Y + Radius);
                        Vector2 CurrentLocation = new Vector2(X, Y);

                        float Distance;
                        Distance = Vector2.Distance(MiddlePos, CurrentLocation);
                        Distance *= 100;
                        Distance /= MathHelper.Clamp(Range, 0, 100);

                        Vector3 newColors = nColor.ToVector3();

                        nColor = new Color(
                            newColors.X,
                            newColors.Y,
                            newColors.Z, 
                            Distance / 100);

                        /*SET COLOR*/
                        SetColorData[Destination] = nColor; // Add to array
                        #endregion
                        #region Shadow
                        #endregion
                    }
                }

                ScreenImage.SetData<Color>(SetColorData);
                Images[curCount] = ScreenImage;
                curCount++;
            }

            return Images[0]; // Temporarily returning the first image of the array.
        }
    } 
```

如您所见，这是一种缓慢而糟糕的方法。所以我想知道，有没有更好的方法来获取和设置每个像素？

在此先感谢 dotTutorials！=)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T22:03:04.783

我认为这项工作最好在像素着色器中完成。

您可以创建一个效果文件，一次在一个灯光上运行。
XNA 使用 DX9，因此您将被限制为 128 个常量寄存器，我认为您可以使用它来压缩多达三个灯。

因此，您将光照贴图设置为渲染目标，循环遍历所有灯光，设置效果的常量数据，渲染渲染目标大小的四边形，然后在像素着色器中计算光照方程。

本质上是这样的：

```
 // In LoadContent
RenderTarget2D lightmapRT = new RenderTarget2D(graphics.GraphicsDevice,
                                                 128,
                                                 128,
                                                 false, //No mip-mapping
                                                 SurfaceFormat.Color,
                                                 DepthFormat.Depth24);

// We now render to the lightmap in Render method
graphics.GraphicsDevice.SetRenderTarget(lightmapRT);

// Lightmap is black by default
graphics.GraphicsDevice.Clear(Color.Black);

// Use the sprite batch to draw quads with custom shader
spriteBatch.Begin(0, BlendState.Opaque, null, null, null, lightmapFx);

foreach (var light in lights)
{
    // Pass the light parameters to the shader
    lightmapFx.Parameters["Viewport"].SetValue(new Vector2(GraphicsDevice.Viewport.Width, GraphicsDevice.Viewport.Height));
    lightmapFx.Parameters["Range"].SetValue(light.Range);
    lightmapFx.Parameters["Intensity"].SetValue(light.Intensity);
    lightmapFx.Parameters["LightColor"].SetValue(light.LightColor);
    lightmapFx.Parameters["LightLocation"].SetValue(light.LightLocation);

    // Render quad
    spriteBatch.Draw(...);
}
spriteBatch.End(); 
```

FX 文件看起来像这样：

```
float Range;
float Intensity;
float3 LightColor;
float2 LightLocation;
float2 Viewport;

struct VStoPS
{
    float4 Position : POSITION0;
    float2 TexCoord : TEXCOORD0;
};

VStoPS VS(in float4 color    : COLOR0,
          in float2 texCoord : TEXCOORD0,
          in float4 position : POSITION0)
{
    VStoPS vsout = (VStoPS)0;

    // Half pixel offset for correct texel centering.
    vsout.Position.xy -= 0.5;

    // Viewport adjustment.
    vsout.Position.xy = position.xy / Viewport;
    vsout.Position.xy *= float2(2, -2);
    vsout.Position.xy -= float2(1, -1);

    // Pass texcoords as is
    vsout.TexCoord = texCoord;

    return vsout;
}

float4 PS(VStoPS psin)
{
    // Do calculations here
    // Here I just set it to white
    return float4(1.0f, 1.0f, 1.0f, 1.0f);
}

technique Main
{
    pass p0
    {
        VertexShader = compile vs_3_0 VS();
        PixelShader = compile ps_3_0 PS();
    }
} 
```

请注意，这个未经测试的代码可能充满了错误。我让你自己弄清楚像素着色器需要做什么。

# asp.net-mvc - Orchard，基于插件的架构，设计模式

> ID：10774185
> 
> 赞同：3
> 
> 时间：2012-05-27T13:03:29.580
> 
> 标签：asp.net-mvc, design-patterns, orchardcms

我正在研究软件架构、分层，并查看了许多开源 .net 项目，例如 Orchard CMS。
我认为 Orchard 是一些设计模式的一个很好的例子。
据我所知，由于滥用，UI、服务、存储库和实体应该在单独的程序集中。但是在 Orchard 中，（由于是模块化和可插拔的）我在同一个文件夹和同一个命名空间中看到服务、存储库和实体类和接口。
它不是反模式，还是对模式正确？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-27T19:42:12.987

TL；DR：组件不一定是正确的分离装置。

不，重要的是它们是分开的，而不是它们在单独的程序集中。此外，在大多数应用程序中考虑因素的方式必须与在可扩展 CMS 中的方式不同。可扩展 CMS 中的正确分离是可以随意添加和删除的解耦*功能，而常规分层应用程序需要解耦**层*，以便可以以最小的风险和影响进行处理和重构。正确的比较实际上是在其中一个应用程序和 Orchard 中的模块或功能之间进行比较，而不是在整个 Orchard 之间进行比较。但是，当然，应该*在*模块中使用良好的实践，而且通常是这样。

现在分离成组件是一个单独的问题，它比架构更具技术性。您可以将程序集视为自包含代码的容器，其创建目的是为了代码重用和动态链接，但不是特别作为分离层的一种方式。这就是为什么它们在 Orchard 中与代码重用单元模块一​​致。

还要考虑这一点的实际方面：良好的架构实践有一个主要目标，那就是使应用程序更容易维护并且更便宜（而不是，令人惊讶的是（不是！）通过使顾问能够设置宇航员架构来使他们变得富有他们可以理解）。第二个目标是编写可扩展和性能良好的应用程序的代码（尽管这是一个更棘手的目标，因为它很容易导致过早优化，这是大多数软件邪恶的根源）。

对于第一个目标，概念分离是最重要的，但这种分离的方式通常不是很重要。

不幸的是，次要目标与使用组件作为分​​离设备的想法相冲突：在您开始添加可选模块之前，Orchard 已经拥有数十个组件。集会不是免费的。它们需要动态编译、加载、jitted、内存开销等。换句话说，为了获得良好的性能，您通常希望减少程序集的数量。

如果您想像现在一样将 Orchard 站点拆分为模块组件，然后将这些模块中的每一个拆分为分层组件，则必须将模块数乘以层数。那将是要加载的数百个程序集。不好。事实上，我们甚至在考虑动态编译的选项，将所有模块构建到单个程序集中。

# javascript - JQuery同时按键

> ID：10774187
> 
> 赞同：2
> 
> 时间：2012-05-27T13:03:56.157
> 
> 标签：javascript, jquery

我如何在用户“keydown”时移动元素，然后如果他让“keyup”停止动画（移动），这是我现在的代码

```
$(document).ready(function(){

    function checkKey(e){
         switch (e.keyCode) {
            case 40:
                //alert('down');
                $('#cube').animate({top: "+=20px"})
                break;
            case 38:
                //alert('up');
                $('#cube').animate({top: "-=20px"})
                break;
            case 37:
                //alert('left');
                $('#cube').animate({left: "-=20px"})
                break;
            case 39:
                //alert('right');
                $('#cube').animate({left: "+=20px"})
                break;
            default:
                alert('???');  
                }      
    }

    if ($.browser.mozilla) {
        $(document).keydown (checkKey);
    } else {
        $(document).keydown (checkKey);
    }
}) 
```

我想在用户按下键（下、左、上、右）时移动立方体，而不是每次按下时，可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:07:38.967

是你要找的吗？

```
$(document).on("keyup", function() {
    $("#cube").stop(true);
}); 
```

**演示：http:** [//jsfiddle.net/LjGREe/](http://jsfiddle.net/LjGRe/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T14:08:48.457

您需要一个简单的 2D 引擎来设置游戏循环。

简单演示：http: [//jsfiddle.net/kzXek/](http://jsfiddle.net/kzXek/)

来源：[https ://github.com/superrob/simple-2D-javascript-engine/blob/master/simple2d.html](https://github.com/superrob/simple-2D-javascript-engine/blob/master/simple2d.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T13:08:47.953

您可以更改 checkKey 功能，并将其添加到其中：

```
 function checkKey(e){
          $(document).keyup(return);
         switch (e.keyCode) {
            case 40:
                //alert('down');
                $('#cube').animate({top: "+=20px"})
                break;
            case 38:
                //alert('up');
                $('#cube').animate({top: "-=20px"})
                break;
            case 37:
                //alert('left');
                $('#cube').animate({left: "-=20px"})
                break;
            case 39:
                //alert('right');
                $('#cube').animate({left: "+=20px"})
                break;
            default:
                alert('???');  
                }      
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T13:58:31.720

我认为使用计时器来处理动画会更好。

您只需在按下键时启动计时器并在释放键时停止计时器..

这是一个处理多个按键的简单解决方案（*可以对角移动*）

```
var direction = {top:0,left:0},
    animator = null,
    cube = $("#cube");

function animate(){
    cube.css({
        top: '+=' + direction.top,
        left: '+=' + direction.left
    });
}
function setProperties(keyCode, unset){
        switch (keyCode) {
        case 40:
                direction.top = (unset)?0:2;
            break;
        case 38:
            direction.top = (unset)?0:-2;
            break;
        case 37:
            direction.left = (unset)?0:-2;
            break;
        case 39:
            direction.left = (unset)?0:2;
            break;
    }  
}
function setKey(e) {

    setProperties(e.keyCode);

    if (animator === null){
        animator = setInterval(animate, 10);
    }
}
function unsetKey(e){
    setProperties(e.keyCode, true);
    if (direction.top === 0 && direction.left === 0){
        clearTimeout(animator);
        animator = null;
    }
}

$(document)
    .on("keyup", unsetKey)
    .on('keydown', setKey); 
```

**演示在** [http://jsfiddle.net/gaby/Cu6nW/](http://jsfiddle.net/gaby/Cu6nW/)

# html - CSS 媒体查询更改

> ID：10774188
> 
> 赞同：0
> 
> 时间：2012-05-27T13:04:09.407
> 
> 标签：html, css, media-queries

我有几个关于 CSS 媒体查询的问题。

I. 两个 css 文件（例如 normal.css 和 lessthan1024.css）是否必须包含所有 css 规则？或者 lessthan1024.css 可以只包含不同的规则吗？

二、它适用于浏览器调整大小吗？还是必须刷新页面？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:09:43.397

**I.**假设您想要一个带有蓝色背景的标题，无论分辨率如何。如果您在`lessthan1024.css`文件中仅包含不同的内容，则意味着您不会有小于 1024 像素的标题的蓝色背景。那么在这种情况下，您认为您的问题的答案是什么？

**二、**它适用于调整浏览器窗口的大小。没有刷新。

* * *

话虽如此，我相信这样做可能会更好：

I. 使用移动优先的方法 - 这意味着您从最小的显示尺寸开始作为标准，然后开始调整页面的外观以适应更大的显示

二、使用规则将所有显示尺寸的所有 CSS 放在一个文件中`@media`；例子：

```
/* base styling: common rules + smallest display rules*/

@media only screen and (min-width: 35em) {
    /* adjust style for larger display */
} 
```

我认为这更好的原因是因为......好吧，如果您使用 2 个 .css 文件，那么您将重复一些规则。假设您想更改其中的一些。您必须在 2 个地方进行相同的更改。也许您忘记在一个文件中进行更改。或者您可能不记得您在一个文件中将填充设置为 1em，而在另一个文件中将其设置为 2em。

# unix - 在 unix 中删除文件

> ID：10774191
> 
> 赞同：-5
> 
> 时间：2012-05-27T13:04:47.753
> 
> 标签：unix, io, filesystems, inode

在 UNIX 文件系统中，如果根目录的 inode 在内存中，那么在 Desktop 中删除文件所需的磁盘操作顺序是什么？

当我试图解决教科书中的一个问题时，我已经看到了这个问题，但我无法解决它。谁能帮我 ？

如果您对 Unix 了解很多，您能告诉我在 Desktop 中创建文件所需的磁盘操作顺序是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:07:34.230

用于在 Unix`rm`中*删除文件。*例如，

```
rm file_to_delete 
```

如果您不确定在 Unix 中工作，或者更好

```
rm -i file_to_delete 
```

这将提示要删除的文件的名称以确认操作。

`file_to_delete`只要正确指定了路径，它就可以在当前目录中，也可以在某个其他目录中。

有关更多信息，请参见[rm 手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?rm)。

至于*创建*文件，可以用`touch`命令创建一个空文件。IE，

```
touch some_file 
```

将创建一个名为`some_file`. 同样，这可以在当前目录中，也可以在具有指定路径的任何目录中。

有关详细信息，请参阅[touch 手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?touch)。

你的问题对我来说不是很清楚，所以如果这不能回答它，请添加评论或（更好）考虑可能改写你的原始问题或至少你的问题的标题（*删除 unix 中的文件*）

# php - 在 CPanel 中编辑 DNS 记录的 PHP 脚本

> ID：10774194
> 
> 赞同：8
> 
> 时间：2012-05-27T13:05:53.510
> 
> 标签：php, cpanel

我想自给自足，因此不使用 DNSDynamic 和 DYNDNS 等服务。而且我不喜欢为我可以自己做的服务付费。

所以这是场景 - 我的主要网站由托管公司托管。我还有一个家庭服务器，上面有我的音乐等。但问题是我的 ISP (BT) 不向消费者提供静态 IP 地址。

我想让我的主域的子域（指向我的主主机）指向我的家庭 IP。这是通过一个简单的 A 记录完成的——我自己完成了。

这归结为我想要制作一个 PHP 脚本（由我的家庭服务器上的 cron 作业运行）以将 cPanel 中的 A 记录更新为我的家庭服务器的当前 IP。

这是一些示例代码——当然缺少的是与 cPanel 通信的 API 代码，我非常感谢任何可以为我填补空白的人。

```
<?php
    $current_ip = file_get_contents("http://mydomain.com/getip.php");
    $username = "CPANEL_USERNAME";
    $password = "CPANEL_PASSWORD";
    $domain = "CPANEL_DOMAIN";

    $request = file_get_contents("http://someapipage?username=".$username."&pw=".$password."&domain=".$domain."&ip=".$current_ip);

?> 
```

中的代码`http://mydomain.com/getip.php`类似于简单的

```
<?php echo $_SERVER["REMOTE_ADDR"]; ?> 
```

我已经掌握了如何设置 cron 作业，因为我的家庭服务器正在运行 Ubuntu，并且我已经阅读了`cron.php`在我的 localhost 目录中使用`wget`.

我已经尝试过[这个链接](http://jordih.net/201110/dynamic-dns-cpanel)，但我无法理解他在做什么。提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-21T09:13:36.717

我刚刚根据他们的文档和指向该文档的 jordih.net 链接为 cPanel 的 JSON-API 编写了这个库。它没有很好的记录，但它的要点是：

通过调用创建 zone_records 对象

```
$zones = new zone_records("cpaneluser", "pass", "website_to_login", "domain_of_records") 
```

请注意，登录网站通常是 127.0.0.1，如果您从要更改记录的服务器上运行它。

一旦被调用，您就可以访问一个成员`$zones->DNSrecords`。这包含一组 DNS A 记录和 CNAME 记录（两者都是 DNSrecord 对象）。其他（TXT 除外）是无关紧要的，因为如果不对类进行额外的添加（功能）就无法编辑它们。

每个 DNSrecord 都有一些成员（例如目标、ttl、名称、类型），虽然我添加了“魔术”方法`private`，因此可以通过这些成员访问它们。“魔术”方法的实现仅用于更改 ttl 和目标（您不能使用此 API 函数更改其他属性，如果您尝试这样做，对象将引发异常）。`$record->ttl``__get``__set`

您可以使用

```
$zones->addrecord($type, $target, $name, $ttl) 
```

添加记录，或

```
$zones->deleterecord($line) 
```

删除`$line`区域文件中在线的记录 - 您可以通过`$record->line`.

如果您想在 ZoneEdit 模块中进行一些您自己的查询，您可以调用

```
$zones->doquery("function_from_API", array("parameters=>"here"), array("headers"=>"here")) 
```

它将返回 cPanel 响应（addrecord 和 deleterecord 方法也是如此）。最后，我建议您使用，`try {...} catch (Exception $e) {...}`因为如果/当出现问题时，我的对象会抛出异常（您当然可以编辑它们）。

此代码位于公共域中 - 您可以在[https://github.com/ShadowLNC/cpanel_dns](https://github.com/ShadowLNC/cpanel_dns)获得它（classdns.php 是主文件，dns_update.php 显示了一个示例）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T01:02:34.470

**编辑**：下面的链接现在已损坏。这是整个脚本供参考：

```
#!/usr/bin/perl
# -------------------------------------------------------------------------------
# neobitti_update_ip.pl
#
# Version 1.0 - 16.01.2012
#
# PERL script to dynamically update the IP of a host via the cPanel-API. This
# script was written to work with the Finnish hoster Neobitti but it might work
# with other hosters which use cPanel too.
#
# Copyright (C) 2012 Stefan Gofferje - http://stefan.gofferje.net/
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation; either version 2 of the
# License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
# -------------------------------------------------------------------------------
use strict;
use LWP::UserAgent;
use MIME::Base64;
use XML::Simple;
use Data::Dumper;
# --- Command line parameters ------------------------------------------------
my $param_domain=$ARGV[0];
my $param_host=$ARGV[1];
my $param_ip=$ARGV[2];
# --- cPanel information -----------------------------------------------------
# Storing passwords in clear text is ugly!
my $cpanel_domain = "example.com";
my $user = "username";
my $pass = "password";
my $auth = "Basic " . MIME::Base64::encode( $user . ":" . $pass );
# --- Deactivate SSL certificate validation ----------------------------------
# This is ugly but neccessary because Neobitti uses self-signed SSL
# certificates which will fail validation
my $ua = LWP::UserAgent->new(ssl_opts => { verify_hostname => 0 });
# --- Find out the linenumber for the A-record we want to change -------------
sub getlinenumber_a {
  my $domain=$_[0];
  my $hostname=$_[1].".";
  my $xml = new XML::Simple;
  my $request = HTTP::Request->new( GET => "https://$cpanel_domain:2083/xml-api/cpanel?cpanel_xmlapi_module=ZoneEdit&cpanel_xmlapi_func=fetchzone&domain=$domain" );
  $request->header( Authorization => $auth );
  my $response = $ua->request($request);
  my $zone = $xml->XMLin($response->content);
  my $linenumber="";
  print $response->content . "\n";
  print $zone . "\n";
  print $zone->{'data'}->{'status'} . "\n";
  print $zone->{'data'}->{'record'} . "\n";
  if ($zone->{'data'}->{'status'} eq "1") {
    my $count = @{$zone->{'data'}->{'record'}};
    my $oldip="";
    for (my $item=0;$item<=$count;$item++) {
        my $name=$zone->{'data'}->{'record'}[$item]->{'name'};
        my $type=$zone->{'data'}->{'record'}[$item]->{'type'};
        print $name;
        if ( ($name eq $hostname) && ($type eq "A") ) {
          $linenumber=$zone->{'data'}->{'record'}[$item]->{'Line'};
          $oldip=$zone->{'data'}->{'record'}[$item]->{'record'};
          print "Found $hostname in line $linenumber with IP $oldip.\n"; # DEBUG
        }
    }
  } else {
    $linenumber="0";
    print $zone->{'event'}->{'data'}->{'statusmsg;'}
  }
  return($linenumber);
}
# --- Change the IP address record for a certain linenumber ------------------
sub setip {
  my $domain=$_[0];
  my $linenumber=$_[1];
  my $newip=$_[2];
  my $result="";
  my $xml = new XML::Simple;
  my $request = HTTP::Request->new( GET => "https://$cpanel_domain:2083/xml-api/cpanel?cpanel_xmlapi_module=ZoneEdit&cpanel_xmlapi_func=edit_zone_record&domain=$domain&line=$linenumber&address=$newip" );
  $request->header( Authorization => $auth );
  my $response = $ua->request($request);

  my $reply = $xml->XMLin($response->content);
  if ($reply->{'data'}->{'status'} eq "1") {
    $result="1";
  } else {
    $result=$reply->{'data'}->{'statusmsg'};
  }
  return($result);
}
# --- Main procedure ---------------------------------------------------------
print "Trying to find the linenumber for $param_host in $param_domain...\n";
my $line=getlinenumber_a($param_domain,$param_host);
if ( ($line ne "0") && ($line ne "") ) {
  print "Trying to update IP...\n";
  my $result=setip ($param_domain,$line,$param_ip);
  if ($result eq "1") {
    print "Update successful!\n";
  } else {
    print "$result\n";
  }
} else {
  print "Error - check domain and hostname!\n";
} 
```

您需要用您自己的凭据替换“用户名”和“密码”。

运行脚本并传入域名、子域名和子域的新IP：

```
./neobitti_update_ip.pl <domain> <subdomain> <ip> 
```

例子：

```
./neobitti_update_ip.pl example.com subdomain.example.com 93.184.216.34 
```

以下是我的原始答案，带有指向源的链接：

* * *

有一个 Perl 脚本正在执行您在此处请求的确切操作：

[http://stefan.gofferje.net/it-stuff/scripts/50-dynamic-dns-update-via-cpanel-api](http://stefan.gofferje.net/it-stuff/scripts/50-dynamic-dns-update-via-cpanel-api)

如果必须是 PHP，我想从 Perl 翻译成 PHP（或任何其他语言）应该相当简单。该脚本的作者在[这里发布了一些背景信息](http://stefan.gofferje.net/news/website-news/40-dynamic-dns-and-cpanel)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-21T07:29:17.147

有一个用于 linux 的 bash 脚本来解决最初提出的问题，即如何自动更新网址以指向不断变化的 IP。众所周知且运行良好的 ddclient 是许多提供商的标准工具，但不幸的是（尚未）为 cPanel 驱动的提供商工作（我使用 serverprofis.de，但还有很多其他的）。

bash 脚本位于[github](https://github.com/CpanelInc/cpanel-dynamicdns-tools)，我刚刚在代码中编辑了 cPanel 上的凭据等，然后添加了一个 cron 作业以每隔几分钟执行一次。与 ddclient 一样，该脚本检查 IP 是否已更改，如果与提供程序的上次更新相比没有检测到更改，则停止。如果 IP 已更改，它会更改提供商处的记录以指向新 IP。

到目前为止效果很好。

# audio - wx.Sound : 不支持 wav 文件

> ID：10774200
> 
> 赞同：1
> 
> 时间：2012-05-27T13:06:33.060
> 
> 标签：audio, background, wxpython, wav

我正在玩游戏，`wx.python`当我尝试使用添加背景音乐时`wx.Sound`出现以下错误：

蟒蛇错误：

> 声音文件“images/game.wav”的格式不受支持。

这是我使用的代码。我在网上多次看到这段代码，但没有一个有同样的问题：

```
sound = wx.Sound("images/game.wav")

sound.Play(wx.SOUND_ASYNC) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T02:37:04.830

听起来您需要以不同的格式保存 WAV 文件。WAV 文件并非都是一样的。

[http://en.wikipedia.org/wiki/WAV#WAV_file_compression_codecs_compared](http://en.wikipedia.org/wiki/WAV#WAV_file_compression_codecs_compared)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T17:36:31.853

为什么不使用 wx.media 或者 mplayer 小部件？我对这些都有一个教程：

*   [http://www.blog.pythonlibrary.org/2010/07/24/wxpython-creating-a-simple-media-player/](http://www.blog.pythonlibrary.org/2010/07/24/wxpython-creating-a-simple-media-player/)
*   [http://www.blog.pythonlibrary.org/2010/04/20/wxpython-creating-a-simple-mp3-player/](http://www.blog.pythonlibrary.org/2010/04/20/wxpython-creating-a-simple-mp3-player/)

# iphone - 使用 ASIFormDataRequest 将 json 发送到 php

> ID：10774201
> 
> 赞同：0
> 
> 时间：2012-05-27T13:06:34.820
> 
> 标签：iphone, objective-c, ios, ipad

我是 iPhone 的新手，我正在尝试将 NSMutable 数组转换为 json 字符串，然后使用请求将此字符串发送到 php 文件，然后使用响应 NSLog 再次打印它以确保它已成功发送。所以我在viewDidLoad中写了如下代码

```
NSString *phpUrl = @"http://dt-works.com/eman/bookMarks.php";

NSMutableArray *arrayKey = [[NSMutableArray alloc] initWithObjects:@"one", @"two", @"three", nil];
NSMutableArray *arrayValue1 = [[NSMutableArray alloc] initWithObjects:@"1", @"2", @"3", nil]; 
NSMutableArray *arrayValue2 = [[NSMutableArray alloc] initWithObjects:@"11", @"22", @"33", nil]; 

NSDictionary *theReqDictionary1 = [NSDictionary dictionaryWithObjects:arrayValue1 forKeys:arrayKey];
NSDictionary *theReqDictionary2 = [NSDictionary dictionaryWithObjects:arrayValue2 forKeys:arrayKey];

NSMutableArray *myArray = [NSMutableArray arrayWithObjects:theReqDictionary1,theReqDictionary2, nil];

NSString *jsonString = [myArray JSONRepresentation];

NSLog(@"%@", jsonString);

 NSDictionary *questions = nil;
NSURL *link = [NSURL URLWithString:[phpUrl stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:link];
[request setPostValue:jsonString forKey:@"jsonString"];
[request setTimeOutSeconds:120];
[request setDelegate:self];
NSError *error = [request2 error];
[request2 startSynchronous];

if (!error) { 
    NSData *response = [request responseData];
    NSString *json = [[NSString alloc] initWithData:response encoding:NSUTF8StringEncoding];
    questions = [json objectFromJSONString];
    NSLog(@"Data: %@", questions);

} 
```

bookMarks.php 中的代码是：

```
$handle = fopen('php://input','r');
$jsonInput = $_POST['jsonString'];
print_r($jsonInput); 
```

但它给了我：

```
[{"one":"1","two":"2","three":"3"},{"one":"11","two":"22","three":"33"}]
Data: (null) 
```

我希望数据为： [{"one":"1","two":"2","three":"3"},{"one":"11","two":"22 ","three":"33"}] 怎么做？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:49:06.780

试试这个，而不是使用密钥发布 JSON 字符串，您需要将其作为数据发布到您的脚本中以供读取。目前在您的脚本中，您甚至没有使用 $handle 来做任何事情......

```
NSURL *link = [NSURL URLWithString:[phpUrl     stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:link];
[request appendPostData:[jsonString  dataUsingEncoding:NSUTF8StringEncoding]]; 
[request setTimeOutSeconds:120];
[request setDelegate:self]; 
```

还有你的php代码..

```
$handle = fopen('php://input','r');
$jsonInput = fgets($handle);
$decoded = json_decode($jsonInput,true);
print_r($decoded); 
```

# sencha-touch - 如何创建煎茶触控应用程序的 APK 文件？

> ID：10774202
> 
> 赞同：3
> 
> 时间：2012-05-27T13:06:36.317
> 
> 标签：sencha-touch, extjs, sencha-touch-2, javascript-framework

我创建 Sencha Touch 应用程序我不会创建该应用程序的 APK 文件我下载 sencha sdk 工具并现在配置使用 sencha-sdk 工具创建 APK 文件需要遵循的步骤

请帮助我使用 sencha-sdk 工具创建 APK 文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T06:28:54.623

您可以使用 Phonegap 和 eclipse 为安卓创建原生 apk

[http://wiki.phonegap.com/w/page/30862722/phonegap-android-eclipse-quickstart](http://wiki.phonegap.com/w/page/30862722/phonegap-android-eclipse-quickstart)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T13:46:13.863

您也可以在没有 sencha sdk 工具的情况下创建 apk，如下所示

按照步骤

1.- 在[https://build.phonegap.com/中注册](https://build.phonegap.com/)

2.- 在您的 PC 中创建一个包含两个新文件夹“assets”和“test”的新文件夹

3.- 在“资产”中移动你所有的煎茶触摸代码

4.- 在文件夹的根目录中，移动您的图标（应用程序）、index.html 文件（与 sencha touch 应用程序中使用的索引相同）和“config.xml”

5.- 将您的主要文件夹添加到 zip 并上传到 phonegap

6.- 最后，您获得了 android、windows phone、blackberry、ios、symbian 和 webos 的安装程序

config.xml [https://build.phonegap.com/docs/config-xml](https://build.phonegap.com/docs/config-xml)

```
<?xml version="1.0" encoding="UTF-8"?>
<widget xmlns       = "http://www.w3.org/ns/widgets"
    xmlns:gap   = "http://phonegap.com/ns/1.0"
    id      = "Name mobile"
    version     = "1.0.0">
    <name>name Mobile</name>
    <description>
    </description>
    <author href=""
        email="">
        cmujica
    </author>
    <gap:platforms>
        <gap:platform name="android" minVersion="2.3" />
        <gap:platform name="webos" />
        <gap:platform name="symbian.wrt" />
        <gap:platform name="blackberry" project="widgets"/>
    </gap:platforms>
    <icon src="icon.png" gap:role="default" />
    <gap:splash src="assets/images/bg-blue.png" />
    <feature name="http://api.phonegap.com/1.0/network"/>
    <!-- sample preference specification -->
    <!-- <preference name="autorotate" value="false" readonly="true"/> -->
</widget> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T13:15:00.923

我宁愿在命令提示符下使用命令来完成。

1.  只需为应用程序制作密钥库

    ```
     keytool -genkey -v -keystore my-release-key.keystore -alias alias_name
     -keyalg RSA -keysize 2048 -validity 10000 
    ```

    用你的应用程序名称替换我的。

2.  确保无论您在哪里创建密钥库，都从那里复制它并将其放入应用程序中，然后在更新 packager.json 并给出密钥库的名称，该名称应该与您复制的内容相似。

3.  在本地服务器之外创建一个构建文件夹并为其命名，然后更新 packager.json 中的文件夹名称。

4.  现在在您的命令提示符下转到应用程序并输入

    ```
    sencha package build packager.json 
    ```

5.  您将在构建文件夹中获得一个包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-08T11:05:37.693

使用生成的默认应用程序从 Sencha Touch 到 Android apk 的简单快速方法。

Pre-req: 1) Ant: 配置 ANT_HOME 并附加到 Path 为 %ANT_HOME%\bin; 2) Java：配置 JAVA_HOME 并附加到 Path 为 %JAVA_HOME%\bin；3) Ruby 4) Android SDK (如果 Android SDK 在 C:\Mobile\AdtBundle 解压，那么你的 sdk home 是 C:\Mobile\AdtBundle\sdk 即直到 sdk 文件夹) 4.1) 附加到路径为 C:\Mobile \AdtBundle\sdk\tools;C:\Mobile\AdtBundle\sdk\platform-tools; 4.2) 通过运行“C:\Mobile\AdtBundle\SDK Manager.exe”下载所需的 Android API，在我的情况下是 androidAPILevel=14 即 Android 4.0 5) 证书生成：（从命令提示符中运行以下命令您的 JAVA_HOME\bin 位置。请注意指定存储证书的路径很重要，在我的例子中是 C:\myapp.keystore) keytool -genkey -v -keystore C:\myapp。

步骤： 1) 使用以下命令从我的 Touch Directory 位置生成一个新应用程序，在我的情况下为 C:\Mobile\touch-2.3.1 sencha generate app MyApp ../MyApp

## 2) 转到“生成的应用程序文件夹”并打开 packager.json 文件。修改文件如下。（请注意，我只是修改了这个文件，并没有删除任何特定于 iPhone 的属性，是否删除它们并不重要。即使像 outputPath 这样的几个参数也不重要apk 输出位置。还可以根据 android 的要求更新您的图标）

{ “applicationName”：“MyApp”，“applicationId”：“com.mycompany.myapp”，“bundleSeedId”：“KPXFEPZ6EF”，“versionString”：“1.0”，“versionCode”：“1”，“icon”：{ "36":"resources/icons/Icon_Android36.png", "48":"resources/icons/Icon_Android48.png", "57":"resources/icons/Icon.png", "72":"resources/icons /Icon~ipad.png", "114":"resources/icons/Icon@2x.png", "144":"resources/icons/Icon~ipad@2x.png" }, "inputPath":"./ ", "输出路径":"C:\Mobile", "配置":"调试", "平台":“Android”，“deviceType”：“通用”，“certificatePath”：“C:\Mobile\myapp.keystore”，“certificateAlias”：“myapp_alias”，“certificatePassword”：“android”，“provisionProfile”：“”， “notificationConfiguration”：“”，“sdkPath”：“C：\Mobile\AdtBundle\sdk”，“androidAPILevel”：“14”，“权限”：[“INTERNET”，“ACCESS_NETWORK_STATE”，“CAMERA”，“VIBRATE” ，“ACCESS_FINE_LOCATION”，“ACCESS_COARSE_LOCATION”，“CALL_PHONE”]，“方向”：[“肖像”，“LandscapeLeft”、“landscapeRight”、“portraitUpsideDown”]

## }

3）在命令提示符下转到您生成的应用程序并运行以下命令 sencha app build native

4) 恭喜，你的 MyApp.apk 位于 'Generated App folder'\native-package-mobile\MyApp\packager.json\MyApp.apk

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-08-15T11:59:34.510

从您输入的命令行

```
sencha app build native 
```

但在你需要通过 packager.json 工作之前

# java - Java Date getTime的算法

> ID：10774206
> 
> 赞同：1
> 
> 时间：2012-05-27T13:07:08.297
> 
> 标签：java, datetime, date, time, gettime

java.util.Date.getTime 方法如何将给定的日期和时间转换为长数字？

Java API 文档说 - “返回自 1970 年 1 月 1 日 00:00:00 GMT 以来此 Date 对象表示的毫秒数。”

感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:09:28.127

查看[Date.java](http://www.docjar.com/html/api/java/util/Date.java.html)源代码。

您会看到，在最简单的情况下，该`Date`对象存储自 1970 年以来的毫秒数，而不是日期/时间等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T13:25:51.640

实际上，尽管 Java API 文档中有明显明确的定义，但有趣的是，报告的毫秒数并不是自 1970 年 1 月 1 日 00:00 以来经过的实际物理毫秒数或秒数：格林威治标准时间 00。真的是物理秒数*加上人为插入的闰秒数*。

# javascript - 更改已打开的弹出窗口的 url

> ID：10774211
> 
> 赞同：21
> 
> 时间：2012-05-27T13:07:37.173
> 
> 标签：javascript, popup

是否可以更改弹出窗口的网址。

假设我打开一个弹出窗口：

```
function pop1(){
    window.open('http://google.com','wind1');   
} 
```

弹出窗口“wind1”的 url 是否可以更改为“http://msn.com”。与 location.href 或任何其他解决方案有关的东西。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-27T13:10:57.047

```
var w1 = window.open('http://www.canop.org','wind1');

w1.location.href='http://www.google.com'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T13:11:08.203

在新的弹出窗口中使用这个：

> $(document).ready(function(){ window.parent.location="http://www.google.com" })

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-16T03:24:20.333

对我来说，因为我只是更改了 url 的末尾（参数部分），所以我使用了一个小技巧：在使用新的类似 url 之前加载不同的 url。我选择使用“about:blank”，但可以使用任何网站 url。

```
self.location = "about:blank";
self.location = desired_url;

//this code works fine both in Mozilla Firefox as in Chrome 
```

请注意，只有 location = site; 与 location.href = site.
我只使用 location.href 来读取当前的 url。

# wpf - 如何使标签位置相对于鼠标位置

> ID：10774222
> 
> 赞同：0
> 
> 时间：2012-05-27T13:08:09.713
> 
> 标签：wpf

我有一个标签，我想更改它与鼠标位置相对应的位置，我的问题是标签位置！，它与应用程序窗口相关，我如何更改坐标以使其相对于屏幕坐标。谢谢你对不起我的英语不好:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:47:47.747

只需将鼠标坐标（相对于窗口）添加到桌面上窗口的位置即可。

# php - paypal 数字商品整合如何启用客人支付？

> ID：10774223
> 
> 赞同：0
> 
> 时间：2012-05-27T13:08:30.407
> 
> 标签：php, codeigniter, paypal, payment, credit-card

您好我正在使用贝宝集成向导进行数字商品结账 (PHP)。 [https://www.paypal-labs.com/integrationwizard/](https://www.paypal-labs.com/integrationwizard/)

它应该支持贝宝支付和非贝宝支付（作为客人购买->信用卡）。在向导中，它直接将付款选项设置为 paypal ： $PaymentOption = "PayPal";

有什么方法可以作为客人启用贝宝直接结帐吗？还是我需要自己添加信用卡api？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T17:59:32.480

这取决于收款帐户。为了让访客结帐，接收者需要是经过高级验证或企业验证的帐户。（已验证 = 链接到银行账户）。

如果您不满足该条件，PayPal 只会为买家提供登录或创建帐户的选项。

# extjs - MemoryProxy me.model 是未定义的错误

> ID：10774224
> 
> 赞同：0
> 
> 时间：2012-05-27T13:08:39.917
> 
> 标签：extjs, proxy, extjs4, store, extjs4.1

在将静态数据与内存代理一起使用时，我遇到了如下添加的错误。有人可以告诉我我的错误或遗漏的部分吗？

提前致谢。

```
me.model is undefined
me.setProxy(me.proxy || me.model.getProxy()); 
```

我的模型定义：

```
Ext.define(appName + '.model.Country', {    extend: 'Ext.data.Model',
    fields: [
        {type: 'string', name: 'abbr'},
        {type: 'string', name: 'name'},
        {type: 'string', name: 'slogan'}
    ]
}); 
```

这是我的商店定义：

```
// The data for all states
var data = {
    states : [
        {'abbr':'AL','name':'Alabama','slogan':'The Heart of Dixie'},
        {'abbr':'AK','name':'Alaska','slogan':'The Land of the Midnight Sun'}
    ]
};

Ext.define(appName + '.store.Countries', {
    extend        : 'Ext.data.Store',
    model        : appName + '.model.Country',
    data        : data,
    proxy: {
        type: 'memory',
        reader: {
            type: 'json',
            root: 'states'
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-25T09:25:19.137

您可能想要检查模型文件是否实际加载并可供使用。在处理大量文件时，ExtJS（我在使用 4.2.1 时遇到过这种情况）对它们进行排序有问题。

快速解决方法是使用**requires:**在应用程序定义中：

```
Ext.application({
    name: 'APP',
    appFolder: 'application',

    controllers: [
    ...
    ],
    requires: ['APP.model.examples', 'APP.model.other' ...],
    ...
}); 
```

如果这有帮助，我在这里写了更多关于 PHP 解决方案的文章：

[ExtJS 4 me.model 的解决方案是未定义的错误](http://blog.draghici.net/solution-for-extjs-4-me-model-is-undefined-error/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T09:51:12.287

您是否尝试显式创建商店并在容器的配置中指定它？

例如：

```
var store = Ext.create(appName + '.store.Countries');
Ext.create('Your Component', {
    ...
    store: store,
    ...
}); 
```

# node.js - 在 node.js 中禁用 TLS 1.1？

> ID：10774226
> 
> 赞同：5
> 
> 时间：2012-05-27T13:08:54.130
> 
> 标签：node.js, ubuntu, ssl, openssl, ubuntu-12.04

我目前在 Ubuntu 12.04 上遇到 OpenSSL 的一个已知问题。这个问题已经在 Debian 中得到修复，我希望它也能在 Ubuntu 中得到修复。但是，与此同时，我需要一个解决方法。

那么是否可以在 Node 中禁用 TLS1 并具有等效于`tls1`switch 的功能：

```
openssl s_client -tls1 -connect evernote.com:443 
```

这是一个简单的 Node.js 脚本来复制问题（在带有 OpenSSL 1.0.1 的 Ubuntu 12.04 上）

```
var https = require('https');
https.get({
    host: 'www.evernote.com',
    path: '/',
    port: 443
  }, function (res) {
    console.log('Success!');
  }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T21:54:09.690

从[文档](http://nodejs.org/api/https.html#https.request)和来源（[1](https://github.com/joyent/node/blob/3415427dbfbd590bbee3d777ffc73dde3c67790d/src/node_crypto.cc#L185)、[2](https://github.com/joyent/node/blob/3415427dbfbd590bbee3d777ffc73dde3c67790d/lib/crypto.js#L70)）来看，应该可以将选项对象传递给`request`包含类似

```
options = { secureProtocol: 'TLSv1_method' } 
```

为了对这个特定的连接使用 TLSv1（仅此而已）。

默认使用 OpenSSL 的 SSLv23_method，即使用双方可能理解的最高 TLS/SSL 版本。

尽管在 OpenSSL 本身中是可能的，但据我所知，在 node.js 中不可能将特定的 TLS 版本（如“尽可能使用最高版本，但从不使用这个”）列入黑名单，这样做的必要标志是未在 node.js 本身中导出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-28T13:57:14.250

我遇到了一个错误，我无法通过节点通过 ssl 连接到 livefilestore.com。这是修复它的方法：

```
var https = require('https');

var HTTPS_AGENT = new https.Agent({
 secureProtocol: 'SSLv3_method'     // default is SSLv23_method
});

var req_opts = {...};

req_opts.agent = HTTPS_AGENT;

https.request(req_opts, function(res) { ... }); 
```

有趣的是，我能够使用更新版本的 libopenssl 重现 curl 中的错误，但我的旧盒子没有重现该问题。我能够在 Ubuntu 和 Gentoo 上重现。在尝试使用 curl 时，使用 -2 总是会中断（但不同的是，不会挂起，只是报告不受支持），而 -3 从未重现该问题。我不知道这是否相关。如果不指定 -3，它会尝试进行 SSLv3 握手但失败。奇怪的。

# android - Android - 将进度对话框与列表视图一起使用

> ID：10774230
> 
> 赞同：1
> 
> 时间：2012-05-27T13:09:49.313
> 
> 标签：android, calllog

我正在从呼叫日志中收集数据，将其放入数据库中，然后将它们查询到 ListView 中。500 次调用大约需要 8 秒，这看起来很糟糕，所以我决定实现一个进度对话框来向用户显示还有多少项需要加载。现在我正在尝试 3 个项目（模拟器的呼叫日志中有 3 个项目）。当progressdialog 完成时，listview 会填充3 个项目，但随后会一次又一次地添加相同的3 个项目，从而形成无限循环。

我在填充之前清空了表，所以它总是有三个记录。

可能是什么问题？

```
pd = new ProgressDialog(Calllogs.this);
        pd.setCancelable(true);
        pd.setMessage("Loading...");
        pd.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        pd.setProgress(0);
        pd.setMax(3);
        pd.show();

        //incrementProgressBy
        new Thread(new Runnable() {                 
            @Override
            public void run() {
                   try
                   {
                    while(pd.getProgress()<=pd.getMax())
                      {
                        Thread.sleep(1000);

//collect data and populate database table
//query data and populate arrays

 handler.sendMessage(handler.obtainMessage());
        if(pd.getProgress()==pd.getMax())
        {
             pd.dismiss();
             adapter = new ListViewCustomAdapter(Calllogs.this, arr_calllog_name, arr_calllog_phone, arr_calllog_type,arr_calllog_duration, arr_calllog_date);
             lv1.post(new Runnable() {
                 public void run() {
                     lv1.setAdapter(adapter);
               }}); 

        }
        }
    }catch(Exception e){}
   }
   }).start(); 
```

和处理程序：

```
 private Handler handler = new Handler() {
                        @Override
                        public void handleMessage(Message msg) {
                             super.handleMessage(msg);
                            pd.incrementProgressBy(1);    
                            //pd.dismiss();

                        }
                }; 
```

**编辑**：我无意中发现整个表人口已经成为一个无限循环。我用 sqlite 数据库浏览器检查了这个表，起初它有 21 个项目，在 59 之后几秒钟，最后增长并强制关闭。

**解决方案**：

我不敢相信我看不到这个。线程从人口开始，导致无限循环。我必须把它放在 calllog 查询之后和数据库查询之前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T12:51:47.270

我不敢相信我看不到这个。线程从人口开始，导致无限循环。我必须把它放在 calllog 查询之后和数据库查询之前。

# codeigniter-datamapper - stensi 和 WanWizard 数据映射器版本有什么区别？

> ID：10774235
> 
> 赞同：0
> 
> 时间：2012-05-27T13:11:08.467
> 
> 标签：codeigniter-datamapper

我试过 stensi 但我发现它有一些错误和意外的输出，如用户指南中所述。

例如，当尝试删除一条记录时，它会给出以下错误：

```
$p=new Per();
$p->where('id',1)->get();
$p->delete(); 
```

带有以下错误消息：

```
 undefined index id 
```

什么时候

```
 echo $p->UserName; 
```

输出：

```
 mhmd 
```

WanWizard 也有这个错误：

```
<h4>A PHP Error was encountered</h4>

<p>Severity: Warning</p>
<p>Message:  array_key_exists() expects parameter 2 to be array, boolean given</p>
<p>Filename: libraries/datamapper.php</p>
<p>Line Number: 399</p> 
```

我怎样才能克服这些错误，或者我能做些什么来使它正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T20:32:30.840

Stensi 的原始版本从 2007 年开始就没有维护过，只支持 CI 1.4。这些天不再是真正的选择。它是在 2008 年被 Overzealous 分叉的，我在 2010 年接管了那个分叉的维护工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T08:07:38.317

我在`../libraries/datamapper.php`第 399 行更改了两行代码（WanWizard 版本）：

```
$d = array($this->config->item('datamapper'));
DataMapper::$config = $d; 
```

并且错误消息消失了。

如果有人尝试过 DataMapper 并有更好的建议，请告诉我们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-05T20:21:18.133

CI v2.1.4 中发生了一些奇怪的事情，其中

```
$this->config->load('datamapper', TRUE, TRUE); 
```

Datamapper-ORM v1.8.2.1中**application/libraries/datamapper.php**的第 391 行没有正确“命名空间”配置。如果你这样做

```
print_r ($this->config); die; 
```

就在第 391 行之后，您会看到所有配置值都在加载的配置数组内的通用 CodeIgniter“命名空间”中。解决这个问题的最不干扰的方法是自己手动命名您的**application/config/datamapper.php**文件，方法是更改​​所有引用

```
$config['prefix'] = '';
$config['join_prefix'] = '';
... 
```

至

```
$config['datamapper']['prefix'] = '';
$config['datamapper']['join_prefix'] = '';
... 
```

我就是这样绕过它的。尽管@Mhmdgomma 的修复确实有效，但当有更简单的解决方案可用时，我不希望破解系统的核心。有人可能应该让维护人员解决这个问题，但我不确定问题出在哪里。它看起来更像是 CI 问题，而不是 DM。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T23:00:36.733

刚刚发现如果您自动加载数据映射器配置文件可能会发生此错误

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-02T01:40:05.390

我通过将配置文件从 sparks 目录移动到 /application/config 目录来解决这个问题（在 CI spark 版本中）。

# wcf - 任务持久性 C#

> ID：10774239
> 
> 赞同：1
> 
> 时间：2012-05-27T13:11:37.220
> 
> 标签：wcf, task-parallel-library, persistent, taskfactory, blockingcollection

我很难让我的任务保持持久性并从 WCF 服务无限期地运行。我可能以错误的方式这样做，并愿意接受建议。

我有一个任务开始处理放入 BlockingCollection 的任何传入请求。据我了解，GetConsumingEnumerable() 方法应该允许我在数据到达时持续提取数据。它本身没有问题。我能够处理数十个请求，而没有一个错误或缺陷，使用 Windows 表单填写请求并提交它们。一旦我对这个过程充满信心，我就会通过 asmx Web 服务将它连接到我的站点，并使用 jQuery ajax 调用来提交请求。

站点根据提交的 url 提交请求，Web 服务从 url 下载 html 内容并在内容中查找其他 url。然后它继续为它找到的每个 url 创建一个请求，并将其提交给 BlockingCollection。在 WCF 服务中，如果应用程序处于联机状态（即任务已启动） - 它使用 GetConsumingEnumerable 通过 Parallel.ForEach 拉取请求并处理请求。

这适用于前几次提交，但随后任务意外停止。当然，这比我在测试中模拟的请求多 10 倍——但我预计它只会节流。我相信问题出在我启动任务的方法中：

```
 public void Start()
        {
            Online = true;

            Task.Factory.StartNew(() =>
            {
                tokenSource = new CancellationTokenSource();
                CancellationToken token = tokenSource.Token;
                ParallelOptions options = new ParallelOptions();
                options.MaxDegreeOfParallelism = 20;
                options.CancellationToken = token;

                try
                {
                    Parallel.ForEach(FixedWidthQueue.GetConsumingEnumerable(token), options, (request) =>
                    {
                        Process(request);
                        options.CancellationToken.ThrowIfCancellationRequested();

                    });
                }
                catch (OperationCanceledException e)
                {
                    Console.WriteLine(e.Message);
                    return;
                }

            }, TaskCreationOptions.LongRunning);

        } 
```

我曾考虑将其移至 WF4 服务中，然后将其连接到工作流中并使用工作流持久性，但除非必要，否则我不愿意学习 WF4。如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:31:02.093

您显示的代码本身是正确的。

但是，有一些事情可能会出错：

*   如果发生异常，您的任务将停止（当然）。尝试添加一个 try-catch 并记录异常。
*   如果您在托管环境（ASP.NET、WCF、SQL Server）中启动工作线程，则宿主可以任意（没有理由）决定关闭任何工作进程。例如，如果您的 ASP.NET 站点在一段时间内处于非活动状态，则应用程序将关闭。我刚才提到的主机不是为了运行自定义线程而设计的。使用专用应用程序 (.exe) 甚至 Windows 服务，您可能会获得更大的成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T18:47:23.300

事实证明，这个问题的原因是 WCF 绑定配置。该任务突然停止，因为 WCF 由于打开超时而终止了连接。打开超时设置是请求在超时之前等待服务打开连接的时间。在某些情况下，它达到了 10 个最大连接的限制，并导致传入连接被备份以等待连接。我确保在事务完成后关闭了与主机的所有连接 - 所以我放弃了增加最大连接数和打开超时期限。在此之后 - 它运行完美。

# c# - 来自 XML 源代码的 XAML DataBinding

> ID：10774240
> 
> 赞同：0
> 
> 时间：2012-05-27T13:11:44.377
> 
> 标签：c#, wpf, windows-phone-7, xaml

这是我的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<app>
<films>
    <film name="Haha" year="2008" />
    <film name="Haha" year="2008" />
    <film name="Haha" year="2008" />
    <film name="Haha" year="2008" />
    <film name="Haha" year="2008" />
    <film name="Haha" year="2008" />
</films>
</app> 
```

这是我的 XAML

```
<ListBox x:Name="listBoxControl">
<ListBox.ItemTemplate>
    <DataTemplate>
        <StackPanel>
            <StackPanel>
                <TextBlock Text="{Binding Path=@name}" />
                <TextBlock Text="{Binding Path=@year}" />
            </StackPanel>
        </StackPanel>
    </DataTemplate>
</ListBox.ItemTemplate> 
```

这是我的 C#

```
XDocument xmldoc = XDocument.Load(new StringReader(result));
listBoxControl.ItemsSource = xmldoc.Descendants("film"); 
```

在过去的几个小时里，我搜索了互联网和 Stack Overflow 问题，希望能找到解决方案。我正在做的是，从我的网站异步下载一些 XML 数据，然后将其传递给名为“listBoxControl”的 ListBox 控件。问题是“文本”字段没有在其中呈现任何文本。我在 Binding 中使用“路径”，因为不允许使用 XPath，我收到此错误：`The property 'XPath' was not found in type 'Binding'`

现在，我在这里做错了什么？它是 C# 中的 WP7.1 应用程序，使用 Visual Studio Express for Windows Phone 在 Windows 8 Consumer Preview 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:18:47.667

我只是创建一个类并绑定到它：

```
public class Film
{
    public string name { get; set; }
    public string year { get; set; }
}

var d = xmldoc.Descendants("film").Select(x => new Film { name = x.Attribute("name").Value, year = x.Attribute("year").Value });

<TextBlock Text="{Binding name}" />
<TextBlock Text="{Binding year}" /> 
```

编辑：或匿名类型：

```
var d = xmldoc.Descendants("film").Select(x => new { name = x.Attribute("name").Value, year = x.Attribute("year").Value });

<TextBlock Text="{Binding name}" />
<TextBlock Text="{Binding year}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:02:42.937

Windows Phone 不支持使用 XPath 进行绑定。

So the only way to solve this is by deserializing the xml and binding to a .NET object.

Make sure, if you are going to allow the user to change the data or the refresh the data from the source that you implement INotifyPropertyChanged on the class so the UI gets notified of changes in the object.

# c++ - 如何在 C++ 和 Opencv 中编写高斯混合模型

> ID：10774244
> 
> 赞同：3
> 
> 时间：2012-05-27T13:12:38.343
> 
> 标签：c++, image-processing, opencv, video-processing

我想跟踪视频中的对象。所以我想我可以在 Opencv 和 C++ 中使用“**高斯混合模型”。**我想知道如何用 C++ 编写高斯混合模型。有没有比 GMM 更好的算法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T17:07:28.807

很抱歉没有直接回答这个问题，但是：

阅读研究论文是一件很棒的事情，但老实说，通过在特定数据上尝试自己的想法并更好地理解问题，您将获得更多的知识。

如果您知道形状，最好使用广义霍夫变换或匹配滤波器进行位置估计，并结合卡尔曼滤波器进行跟踪。这些将相对容易实施。或者，也许您可​​以找到现有的实现。

此外，如果你不是一个非常好的 C++ 程序员，我会在 Matlab 或 Octave 中而不是 C++ 中对你的想法进行原型设计，因为当问题本身是你真正想要关注的问题时，你最终会在 C++ 中的问题上浪费大部分时间在。

正如我在评论中所说，我现在会跳过使用 GMM，直到您更好地了解问题以及您将如何使用它们。（当然，除非您已经很清楚如何使用它们。）

# php - 在 ajax 请求完成之前更改 location.href 会发生什么？

> ID：10774245
> 
> 赞同：3
> 
> 时间：2012-05-27T13:12:45.613
> 
> 标签：php, ajax

1.  用户单击执行某些 ajax 请求的链接 - 假设此请求需要 20 秒。
2.  在请求完成之前，用户单击将整个页面重定向（无 ajax）到另一个页面的 oder 链接。

ajax请求会发生什么？它总是在服务器端完成，但响应不会出现在任何地方？或者，服务器端的 ajax 请求可能会立即被“杀死”？

我问是因为我有一些脚本需要一些时间才能运行，但用户现在不必知道结果 - 它只是触发并忘记 - 也许 ajax 中甚至有一些选项可以强制它不发送任何响应？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T13:17:56.203

浏览器应该终止 AJAX 请求，关闭与服务器的连接；但是，这并不意味着您在服务器上的处理也一定会被杀死：[ignore_user_abort()](http://bg.php.net/manual/en/function.ignore-user-abort.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T13:17:56.380

服务器将完成请求，不知道客户端已经“继续”。服务器将像往常一样将响应返回给客户端。客户端将简单地忽略响应。

因此，期望服务器端的一切都正常发生，因此“即发即弃”方法将起作用（因为客户端已继续前进并已“忘记”）。但是，如果您想在客户端做任何响应（这将否定“忘记”部分），那么新页面就无法拦截响应。浏览器会忽略它。

# c# - 加载 64 位 dll 时出现 HRESULT 0x8007007E 的 DllNotFoundException

> ID：10774250
> 
> 赞同：7
> 
> 时间：2012-05-27T13:13:42.120
> 
> 标签：c#, visual-studio-2008, pinvoke, dllimport, dllnotfoundexception

我下载了[zlib](http://zlib.net/)并将库编译为 Windows 32 位和 Windows 64 位 dll。我现在有`zlibwapi.dll`和`zlibwapi64.dll`。

dll 被复制到我的应用程序文件夹中，引用如下：

```
[DllImport(@"zlibwapi.dll",   EntryPoint = "uncompress", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = false)]
private static extern int uncompress32(
    IntPtr dest,
    ref uint destLen,
    [In(), MarshalAs(UnmanagedType.LPArray)] byte[] source,
    uint sourceLen
);

[DllImport(@"zlibwapi64.dll", EntryPoint = "uncompress", CallingConvention = CallingConvention.StdCall, CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = false)]
private static extern int uncompress64(
    IntPtr dest,
    ref uint destLen,
    [In(), MarshalAs(UnmanagedType.LPArray)] byte[] source,
    uint sourceLen
); 
```

在运行时，我检查我是 32 位还是 64 位，并调用适当的版本。

如果我是 32 位，这可以正常工作，但 64 位版本提供

> 无法加载 DLL“zlibwapi64.dll”：找不到模块。（HRESULT 异常：0x8007007E）

我在网上找到了很多类似的问题，建议的原因是该库依赖于其他一些库，并且可能找不到那些库。
情况似乎并非如此：

*   zlibwapi64.dll 仅依赖于 Kernel32.dll 和 MSVCR90.dll。我确实安装了 32 位和 64 位的 VS2008 C++ 运行时。
*   当我尝试从非托管 C++ 应用程序加载 zlibwapi64.dll 时，它加载没有问题。是 C# 无法加载它。

我尝试设置 64 位 dll 的绝对路径，但没有帮助。

我如何使它工作？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-27T13:50:09.773

这是一个相当基本的“找不到文件”类型的错误，不幸的是它没有明确告诉你它找不到什么 DLL。您已经知道依赖 DLL 的问题。请注意，您可以通过使用 /MT 编译代码来避免对 msvcr90.dll 的令人讨厌的依赖

您需要调试问题，这需要深入了解它在哪里寻找 DLL。一个很好的工具是[SysInternals 的 ProcMon 实用程序](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，它可以准确地显示程序在哪里寻找文件。您应该看到它正在探测 DLL，在 PATH 的目录中搜索并找不到文件。

不幸的是，ProcMon 有点健谈，并且习惯于将您淹没在数据中。更专用的工具是 GFlags.exe，该工具可从 Debugging Tools for Windows 包中获得。这些天包含在 Windows SDK 中。安装后存储在 c:\program files (x86)\debugging tools for windows\gflags.exe 中。您可以打开“显示加载程序快照”选项。在更高版本的 Windows 上，这会告诉 Windows 加载程序在搜索 DLL 时生成调试消息。当您启用非托管调试时，它们将出现在“输出”窗口中。

首先尝试 ProcMon，更容易上手。

当然，请考虑纯托管解决方案，这样您就不会遇到此类安装问题。好的是 DotNetZip 和 SharpZipLib，这是他们的第一个谷歌点击。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T14:25:14.700

另一个检查 Dll 依赖关系的好工具是 Dependency walker (depends)。它以静态方式查看文件，因此比使用进程监视器更容易。

[http://www.dependencywalker.com/](http://www.dependencywalker.com/)

# php - PHP-修改分页以进行排序

> ID：10774255
> 
> 赞同：1
> 
> 时间：2012-05-27T13:14:29.590
> 
> 标签：php, mysql, html, pagination

嗨我是一个新的程序员。

我有一个**工作正常的简单****分页**，我有**排序**选项，用于按 id、标题等对我的记录集结果进行排序，这也**工作正常**，代码如下。

 ******现在我想**将两者结合起来，**并具有分页应该在这两种情况下工作的功能。

也就是说，默认情况下显示记录集结果时分页应该像以前一样工作。并且当记录集结果按选项排序时，分页也应该对排序结果起作用。

我想通了，代码如下，但我无法让它工作。

我的记录集和基本分页排序代码是：

```
<?php 
$table='mytable';
$pagename = "is-test.php";
$db = mysql_select_db($database,$connection) or trigger_error("SQL", E_USER_ERROR);
$sql1 = "SELECT COUNT(*) FROM $table";
$result1 = mysql_query($sql1, $connection) or trigger_error("SQL", E_USER_ERROR);
$row = mysql_fetch_row($result1);
$numrows = $row[0];
$rowsperpage = 5;
$totalpages = ceil($numrows / $rowsperpage);
if (isset($_GET['page']) && is_numeric($_GET['page'])) {
$currentpage = (int) mysql_real_escape_string($_GET['page']);
} else {
$currentpage = 1;
}
if ($currentpage > $totalpages) {
$currentpage = $totalpages;
}
if ($currentpage < 1) {
$currentpage = 1;
}
$orderBy = array('id', 'title',);
$order = '';
if (isset($_GET['orderBy']) && in_array($_GET['orderBy'], $orderBy)) {
$order = mysql_real_escape_string($_GET['orderBy']);
}else{
$order='id';
}
$offset = ($currentpage - 1) * $rowsperpage;
$sql2 = "SELECT * FROM $table ORDER BY $order ASC LIMIT $offset, $rowsperpage";
$result2 = mysql_query($sql2, $connection) or trigger_error("SQL", E_USER_ERROR);
$list = mysql_fetch_assoc($result2);
$startrow = ($currentpage-1) * $rowsperpage 
```

我的排序选项代码：

```
 Sort by
        <a href="?orderBy=id">id:</a>        

        <a href="?orderBy=title">title:</a> 
```

我的分页代码是：

```
if ($currentpage != $totalpages) {
$nextpage = $currentpage + 1;
echo " <li><a href='$pagename?page=$nextpage'>Next&raquo;&raquo;</a></li> ";
}

if($currentpage<$totalpages){
for ($x = ($currentpage - 3); $x < (($currentpage + 3) + 1); $x++) {
if (($x > 0) && ($x <= $totalpages)) {
if ($x == $currentpage) {
echo " <li id='pcurrent'><a href='$pagename?page=$x'>$x</a></li>";
} else {
echo " <li><a href='$pagename?page=$x'>$x</a></li> ";
}}}  
}

if ($currentpage > 1){
$prevpage = $currentpage - 1;
echo " <li><a href='$pagename?page=$prevpage'>&laquo;&laquo;Prev</a></li> ";
} 
```

到目前为止，一切都在工作，除了分页只分页默认记录集结果没有排序记录集结果，因为我必须更改分页的 url 参数才能处理排序结果，所以我将分页链接更改为

```
if ($currentpage != $totalpages) {
$nextpage = $currentpage + 1;
echo " <li><a href='$pagename?orderBy=$order,page=$nextpage'>Next&raquo;&raquo;</a></li> ";
}

if($currentpage<$totalpages){
for ($x = ($currentpage - 3); $x < (($currentpage + 3) + 1); $x++) {
if (($x > 0) && ($x <= $totalpages)) {
if ($x == $currentpage) {
echo " <li id='pcurrent'><a href='$pagename?orderBy=$order,page=$x'>$x</a></li>";
} else {
echo " <li><a href='$pagename?orderBy=$order,page=$x'>$x</a></li> ";
}}}  
}

if ($currentpage > 1){
$prevpage = $currentpage - 1;
echo " <li><a href='$pagename?page=$prevpage'>&laquo;&laquo;Prev</a></li> ";
} 
```

即在分页链接中添加了**orderBy=$order**，但分页现在不起作用，不在默认记录集结果上，也不在排序记录集结果上。

请看看我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:20:45.577

我没有阅读整个代码，但您的查询字符串中至少有一个错误。每个 GET 参数都应该用“&”而不是“，”来分隔。更改您的代码

```
'?orderBy=$order,page=$nextpage' 
```

到

```
'?orderBy=$order&page=$nextpage' 
```

至少应该修复这个错误。

你应该把 error_reporting(E_ALL); 在代码的开头查看来自 php 的通知（这会对您有很大帮助）。如果之后仍然无法正常工作，您应该使用调试 GET 参数

```
<?php var_dump($_GET); ?> 
```******

# php - AJAX：CSS样式应用到一行

> ID：10774256
> 
> 赞同：0
> 
> 时间：2012-05-27T13:14:33.007
> 
> 标签：php, javascript, jquery, css, ajax

我需要以下代码的帮助。有 2 种样式：`activatedRow`和`disactivatedRow`。当用户点击一个按钮（位于表的 TD 内）时，要么 要么`activatedRow`被`disactivatedRow`应用到一行。样式的选择基于当前样式。例如，如果激活了一行，则按钮将禁用它，反之亦然。

所以，我有一个问题`AJAX success`。如何编写 IF 语句来检查行的当前样式？

PS 此外，知道如何更改 TD IMG（按钮）以禁用和激活行也会很有趣。

**CSS**

```
.activatedRow td { 
    background-color:#FFFFFF !important;
    color: #000000 !important;
}
.disactivatedRow td { 
    background-color:#DFE1ED !important;
    color: #9896A8 !important;
} 
```

**函数“disactivateRow()”**

```
<script type="text/javascript">
function disactivateRow(flightNum,obj){ 
           $.ajax({
                   type: "POST",
                   url: "callpage.php?page=tables/disactivate.php",
                   data: "flightNum=" + flightNum,
                   success: function(){
                       if ($(obj).hasClass("activatedRow")) {
                    $(obj).removeClass("activatedRow").addClass("disactivatedRow");
                } else
                    $(obj).removeClass("disactivatedRow").addClass("activatedRow");
               }
            });
}
</script> 
```

**表格内的按钮**

```
 <table id="newspaper-b" border="0" cellspacing="2" cellpadding="2" width = "100%">
                <thead>
                    <tr>
                        <th scope="col">Flt Num</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($result1 as $row):
                        $flightNum=$row['flightNum'];
                    ?>
                    <tr id="<?php echo $flightNum; ?>" class="edit_tr">
                        <td><?php echo $flightNum;?></td>
                        <td id="<?php echo $flightNum; ?>">
                             <div onclick='disactivateRow("<?php echo $flightNum; ?>", this)'>
                                <img src='images/disactivate.png' alt='Disactivate' />
                            </div>              
                        </td>
                    </tr>
                    <?php endforeach;?>
                </tbody>
            </table> 
```

**jQuery 数据表激活**

```
 $(document).ready(function(){
      $('#newspaper-b').dataTable({
      "sPaginationType":"full_numbers",
      "bJQueryUI":true,
      'fnRowCallback': function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {     
          if (aData[0] == "0") {
                    nRow.className = "disactivatedRow";
              } else
                    nRow.className = "activatedRow"; 
            return nRow;
        }

      }); 
```

**回答：**

它现在有效：

```
 $(".disact_but" ).click(function() {
            var ID=$(this).attr('id');
                $.ajax({
                       type: "POST",
                       url: "callpage.php?page=tables/disactivate.php",
                       data: "flightNum=" + ID,
                       success: function(){
                            $("#"+ID).toggleClass("disactivatedRow", 100);
                       }
                });
            return false;
      }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:28:21.717

如果`obj`是 TD 应用样式，因为您的代码表明您可以使用[`toggleClass`](http://api.jquery.com/toggleClass/)

> 根据类的存在或 switch 参数的值，从匹配元素集中的每个元素中添加或删除一个或多个类。

```
$(obj).closest('tr').toggleClass('disactivatedRow');
$(obj).closest('tr').toggleClass('activatedRow'); 
```

**编辑**

根据您添加的新信息，`obj`是一行的孩子。`closest`方法应该给你适当的`tr`然后我们可以申请`toggleClass`

# android - 网站的“android:windowSoftInputMode”等价物是什么？

> ID：10774260
> 
> 赞同：21
> 
> 时间：2012-05-27T13:15:48.013
> 
> 标签：android, input, web

我正在构建一个将在 Android 设备上使用的网站应用程序。目前，当软键盘出现时，浏览器会挤压页面。我宁愿希望它向上滚动页面。

我已经读到该属性可[`android:windowSoftInputMode`](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft) 用于`AndroidManifest.xml`Android 应用程序，但我正在寻找一个网站的等价物。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T20:52:57.123

当用户关注此输入时，您可以重新定位浏览器

```
<input name="whatever" id="id" onfocus="window.location.href='#id'; return true;"/> 
```

# javascript - Facebook喜欢检查代码

> ID：10774261
> 
> 赞同：0
> 
> 时间：2012-05-27T13:15:53.427
> 
> 标签：javascript, facebook, callback

> **可能重复：**
> [Facebook 如何检查用户是否喜欢页面并显示内容？](https://stackoverflow.com/questions/6246449/facebook-how-to-check-if-user-has-liked-page-and-show-content)

我有代码：

```
FB.api({ method: 'pages.isFan', page_id: 'XXX',}, function(resp) {
    if (resp == true) {
      alert('user_id likes the Application.');
    } else if(resp.error_code) {
      alert(resp.error_msg);
    } else {
      alert("user_id doesn't like the Application.");
    }
}); 
```

我想检查他们已经登录Facebook的当前访问者是否喜欢指定的粉丝页面（page_id）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:55:31.383

这并非易事。

看看这个：[https ://stackoverflow.com/a/6314568/477176](https://stackoverflow.com/a/6314568/477176)

# model-view-controller - MVC 系统是如何工作的？

> ID：10774263
> 
> 赞同：21
> 
> 时间：2012-05-27T13:16:14.113
> 
> 标签：model-view-controller, oop, design-patterns

我正在尝试学习 MVC 模式，但每个地方都有不同的说法。所以现在我不知道真正的 MVC 是什么。

所以我猜它是最纯粹的MVC：

*   **模型**只是**数据**并通知数据更改。
*   **View**读取**Model**的消息以更新视图。
*   **控制器从****视图**中读取用户输入并据此更改模型。

**实施**

*   **模型**不认识任何人。
*   **View**知道**Model**。
*   **Controller**知道**View**和**Model**。

伪代码：

```
/* Model */
class Color{ 
  color = blue;
  setColor(color);
  notifyUpdate();
}
/* View */
class ColorPicker(model){
  model.register(update);
  update(){
    this.colorToExhibit = model.color;
  }
}
/* Controller */
class Colorize(view, model){
  view.register(update);
  update(color){
    model.setColor(color);
  }
} 
```

一些问题：

1.  那正确吗？
2.  我不明白为什么**视图**不能直接更改**模型**，而是通过控制器。
3.  假设我有一个动作后要执行的动画。谁必须处理这个动画：模型、视图还是控制器？另外：动画逻辑是模型、视图还是控制器的一部分？更多：假设一个扑克游戏。在用户选择一个动作（例如，“Raise”）后，系统必须播放动画（例如，筹码从玩家位置到桌子）。如何将这个扑克示例（带有动画）视为 MVC？你能解释一下并给出一个伪代码吗？

谢谢你。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-27T13:41:34.997

> *   模型只是数据并通知数据更改。
> *   View 读取 Model 的消息以更新视图。
> *   控制器从视图中读取用户输入并据此更改模型。

模型不仅仅是数据。模型也是业务逻辑。它包含系统的所有智能，或者至少是幕后智能的抽象（例如数据库调用或其他服务调用）。想想这句话，“让你的模型重而你的控制器轻。”

> *   模型不认识任何人。
> *   视图知道模型。
> *   控制器知道视图和模型。

模型没有人知道它是正确的。模型应该在应用程序之间是可移植的，并且不应该以任何方式依赖于 UI 问题。（在这种情况下，视图和控制器是 UI 问题。）

视图知道模型，也是正确的。视图基本上“绑定”到模型。它呈现所有 UI 元素，并将模型数据相应地放置在 UI 元素中。

控制器*类型*“了解视图”。它知道它应该直接控制哪个视图，但它对那个视图*一无所知*。它也不知道先前来自哪个控件的哪个视图。控制器响应事件。来自 UI 的事件，带有某种状态信息（可能是 ViewModel），通过模型（业务逻辑发生的地方）引导逻辑控制，并以模型（或 ViewModel，如果形状特定于特定视图的数据不同于模型）和视图。

> 我不明白为什么视图不能直接更改模型，而是通过控制器。

View 可以在用户交互的上下文中操作 Model，但不应期望这些更改以任何方式持续存在。视图应该被认为是“客户端”并且不知道任何“服务器端”。（即使您谈论的是本机应用程序而不是 Web 应用程序。）持久化任何更改都被视为 UI“动作”或“事件”，并将转到控制器以使其发生。

> 假设我有一个动作后要执行的动画。谁必须处理这个动画：模型、视图还是控制器？另外：动画逻辑是模型、视图还是控制器的一部分？

动画听起来像是完全基于 UI 的操作。它将在视图内。除了 UI 动画，还有更多的事情发生吗？动画在后端有什么*改变吗？*例如，如果我有一个 Web 应用程序，并且当页面加载时，我想淡入一些数据（动画）......这完全在视图中。数据将像任何其他数据一样传递到视图，并且动画完全在 UI（视图）内进行。从模型或控制器的角度来看，它没有*做任何事情。*

> 假设一个扑克游戏。在用户选择一个动作（例如，“Raise”）后，系统必须播放动画（例如，筹码从玩家位置到桌子）。如何将这个扑克示例（带有动画）视为 MVC？你能解释一下并给出一个伪代码吗？

动作（“Raise”）是一个控制器事件。UI 将联系控制器以执行“提升”。所以控制器可能有这样的方法：

```
View Raise(GameState state)
{
    // Interact with the Models to update the known state of the game.
    // The Models would perform the actual Poker game logic.
    // Respond with a View bound to updated Models.
} 
```

一旦控制器使用新视图响应 UI，该视图将包含要显示给用户的任何动画。（毕竟，除非动作成功，否则您不想执行动画，对吧？当 Controller 以指示成功动作的新 View 响应 UI 时，动画就会播放。它可能会改为响应 UI带有指示错误的视图，在这种情况下，该视图将显示其他内容。）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-27T14:57:39.300

我将使用简单的银行类比。

*   出纳员是意见。
*   跑步者是控制器。
*   银行家是模特。

银行家是聪明人，他们了解所有的业务逻辑并进行所有复杂的计算。

Runners 用于将钱（数据）从 Bankers 传输到 Tellers。

出纳员将钱交给客户。

一个简单的表示：

**模型**

```
public class BankAccount
{
     public int ID;
     public int Balance;

     public BankAccount(int id)
     {
         ID = id;
         Balance = DetermineAmount();
     }

     public int DetermineAmount()
     {
         // Gather transaction info, debits, credits and return a
         // sum of the amount left in the account depending on the
         // id provided.
     }
} 
```

* * *

**控制器**

```
 public class BankAccountController
    {

         public ViewResult Index(int id)
         {
             BankAccount account = new BankAccount(id);
             return View(account);
         }

    } 
```

* * *

**看法**

```
<ul id="account-info">
   <li>Account ID: `@Model.ID`</li>    
   <li>Balance: `@Model.Balance`</li>
</ul> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-27T14:39:57.307

如果您对历史上*真正*的MVC 感兴趣，请从[Trygve Reenskaug](https://heim.ifi.uio.no/%7Etrygver/themes/mvc/mvc-index.html)开始。他在 1970 年代后期创建（观察到？，编目？？）它。首先，请阅读1979 年的[*“模型-视图-控制器” 。它定义了术语。*](https://heim.ifi.uio.no/%7Etrygver/1979/mvc-2/1979-12-MVC.pdf)请注意它的标题——**所有三个角色都是多元化的**。这是大多数人似乎弄错的第一件事。

我发现的关于 MVC 最初使用的最佳描述实际上是在 2004 年题为[*“Inside Smalltalk MVC”*](https://pl.csie.ntut.edu.tw/%7Ectchen/pdf/InsideSmalltalkMVC-public.pdf)的演示文稿中。我猜想描述 Smalltalk 80 最终版 MVC 的规范论文是 Krasner 和 Pope 的[*“A Cookbook for Using the Model-View-Controller User Interface Paradigm in the Smalltalk-80”*](https://www.ics.uci.edu/%7Eredmiles/ics227-SQ04/papers/KrasnerPope88.pdf)和 Steve Burbeck 的[*“Applications Programming in Smalltalk-80” ：如何使用模型-视图-控制器（MVC）”*](https://web.archive.org/web/20150518095937/http://st-www.cs.illinois.edu:80/users/smarch/st-docs/mvc.html)。这两篇论文都非常值得一读。

如果您有时间消磨时间并且不介意聆听 Robert Martin，他[在 Ruby Midwest 2011 上做了一个很好的主题演讲](https://web.archive.org/web/20150206031846/http://confreaks.com/videos/759-rubymidwest2011-keynote-architecture-the-lost-years)，涉及 MVC。这是一个多小时，但非常有趣和有启发性。我倾向于遵循他的观点，即大多数实现都会导致 MVC 错误。我花了一点时间环顾四周，最后找到了一个可以链接到描述 MVC 的图表。我喜欢的那个来自*Pope 和 Krasner*。

[![MVC](../Images/b746cbeb7ccdfae64e4b8ebeeae89fc9.png)](https://i.stack.imgur.com/4f8EQ.png)
[（来源：[as3dp.com](http://www.as3dp.com/wp-content/uploads/2010/02/mvc_pope_krasner.png)）]

在我看来，以下是关键点：

*   **模型实例负责通知*感兴趣*的对象发生变化**。请注意，这些可以是*任何*对象实例。该图显示了在此处接收更新的视图和控制器。
*   **视图负责查询当前状态并显示结果**。他们通常也执行过滤或数据转换。
*   **控制器负责接受用户输入并将*视图消息***转发到视图。
    *   *查看消息*是 MVC 中的一个常见主题。重要的是这些独立于 UI 世界 - 这些不是鼠标单击，而是特定于视图的事件语言。这将我们带到了下一点。
*   **视图不以任何方式依赖于控制器**。控制器负责安排和创建视图，并提供世界其他部分和视图之间的接口。
*   在一个完美的世界中，**视图负责使模型表示可见**。这就是将 MVC 应用于桌面应用程序时的工作方式。

现实情况是，MVC 已经为 web 世界被扭曲和重写。它不再是真正的 MVC，或者可能只是重新定义了 MVC。这就是为什么你会看到这么多不同的 MVC 观点和表示。如果你正在研究编写桌面风格的应用程序，那么看看 Krasner & Pope 的东西。如果您正在研究如何将 MVC 应用于 Web，那么我推荐 Bob 叔叔的主题演讲，以寻找更适合 Web 应用程序的替代方案——他称之为*交互器、实体、边界架构*，因为没有更好的名称。挖掘与他关于*“建筑失落的岁月”的*谈话相关的内容。

# vbscript - 第二次创建的 Internet 快捷方式不起作用

> ID：10774265
> 
> 赞同：1
> 
> 时间：2012-05-27T13:16:22.397
> 
> 标签：vbscript, shortcuts

我在开始菜单中使用带有 IP:Port (https://199.158.25.55:1212) 的 URL 创建了 URL 快捷方式。以下是相同的 .url 文件。

```
[InternetShortcut]
URL=https://199.158.25.55:1212/
IDList=
[{000214A0-0000-0000-C000-000000000046}]
Prop3=19,2 
```

使用此快捷方式，我可以访问上述网站。

现在，我正在删除这个文件并使用不同的端口创建相同的文件，比如 4545。所以相同的新文件是

```
[InternetShortcut]
URL=https://199.158.25.55:4545/
IDList=
[{000214A0-0000-0000-C000-000000000046}]
Prop3=19,2 
```

当我尝试使用开始菜单打开 URL 时，Web 浏览器 URL 显示以前创建的快捷方式（https://199.158.25.55:1212 已不存在）并且我无法访问该站点。

这发生在 Mozilla 和 Chrome 网络浏览器上。使用 IE 它可以正常工作。经过长时间的搜索，我没有任何理由。

任何帮助都是不言而喻的。

谢谢。

# java - 借助内存映射 IO 存储和访问键值对和多个整数值的推荐方式

> ID：10774267
> 
> 赞同：0
> 
> 时间：2012-05-27T13:16:54.443
> 
> 标签：java, memory-mapped-files

在 java 程序中，我需要临时存储许多记录——一条记录由一个键、一个对象和一个整数值组成。总处理将是数百万条记录，但我计划在处理完成后删除一条记录......然后插入另一条记录，对其进行处理，然后将其删除......等等上...

借助内存映射 IO 存储这些值的最佳方法是什么？

我可以看到映射字节缓冲区的示例，但是如何存储多条记录，然后检索它们...当我将记录添加到文件存储时，我是否必须存储位置编号，并使用这些来检索数据？然后我将不得不创建另一个数组来存储位置编号......有没有推荐的方法来使用 java 中的内存映射 IO 存储/检索数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T14:28:35.327

另一种方法是使用 Wea​​kHashmap [http://docs.oracle.com/javase/6/docs/api/java/util/WeakHashMap.html](http://docs.oracle.com/javase/6/docs/api/java/util/WeakHashMap.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:48:51.990

也许这就是你正在寻找的：

[http://code.google.com/p/vanilla-java/wiki/HugeCollections](http://code.google.com/p/vanilla-java/wiki/HugeCollections)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:05:16.243

您可以使用[Hashmap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)，如果您可以基于`records key/int pair`和值创建组合键，`object`那么您可以在恒定时间操作中将其存储在`HashMap`并从 hashMap 中删除值。

* * *

例子：

```
 //Constructs a new empty HashMap with default initial capacity        
    HashMap hashMap = new HashMap();

    //Key would be combination of "record key/int pair"
    hashMap.put(Key1, new Integer(1)); 
    hashMap.put(Key2, new Integer(2));
    hashMap.put(Key3, new Integer(3));

    //You can remove values from HashMap in constant time using remove
    hashMap.remove(Key1); 
```

# regex - 当两个规则同时匹配 URL 时，Apache RewriteRule 出现意外行为（添加路径信息后缀）

> ID：10774271
> 
> 赞同：2
> 
> 时间：2012-05-27T13:17:53.713
> 
> 标签：regex, mod-rewrite, url-rewriting, apache2

我正在使用 apache rewrite_mod (Apache/2.2.17 Win32) 并遇到 rewriteRule 的非常奇怪的行为。

我的脚本主要重写`f1 .. f<infinity>`从 nice url 命名的无限过滤器参数，并在循环中将它们添加为查询变量、添加路径作为查询和页码。

它完美无缺，但如果我添加另一个规则（脚本中的最后一条规则）

```
RewriteRule   ^(.+)\.html$                       /index.php?path=$1.html [QSA] 
```

对于另一种情况，它会在脚本开始时更改重写器的执行。

输入网址：

```
http://testing.loc/some/thing/index0-f1-nice-cars-f2-planes-f3-karts-f4-bike.html 
```

所有重写后的 PHP 预期结果：

```
$_SERVER[QUERY_STRING] => path=some/thing/&page=0&f1=nice-cars&f2=planes&f3=karts&f4=bike
$_SERVER[SCRIPT_NAME] => /index.php 
```

脚本如下所示（下一部分功能完美）：

```
# from: some/thing/index0-f1-nice-cars-f2-planes-f3-karts-f4-bike.html
# to:   some/thing/index0.html?f=-f1-nice-cars-f2-planes-f3-karts-f4-bike

RewriteRule   ^(.*/?index[0-9]*)((?:-f[0-9]+-.+?)+)\.html$   /$1.html?f=$2 [QSA]

# from: some/thing/index0.html?f=-f1-nice-cars-f2-planes-f3-karts-f4-bike
# to    index.php?path=some/thing/&page=0&f=-f1-nice-cars-f2-planes-f3-karts-f4-bike

#              (   $1   )     (  $2  )
RewriteRule   ^(.+/{0,1})index([0-9]*)\.html$    /index.php?path=$1&page=$2 [QSA]

# while in f is something like "f1-nice-cars" (for example)
# remove "f1-nice-cars" from f and add as query "f1=nice-cars"

#                              (%1)    (   %2  ) ( %3)(       %4       )
RewriteCond   %{QUERY_STRING} ^(.*)&f=-(f[0-9]+)-(.+?)((?:-f[0-9]+-.+)*)$ 
RewriteRule   ^index\.php$                       /index.php?%1&%2=%3&f=%4 [L]

# remove empty "f=" from query

RewriteCond   %{QUERY_STRING} ^(.*)&f=$ 
RewriteRule   ^index\.php$                       /index.php?%1 
```

在这里，规则之后是 url 的形状：

```
index.php?path=some/thing/&page=0&f1=nice-cars&f2=planes&f3=karts&f4=bike 
```

**如果脚本中没有下一条规则，一切都会完美运行**。但是如果我添加它，这条规则本身什么也不做，但是 rewrite_mod 在脚本开始时添加了更多的东西。

```
# rewrite rule for other paths without filters

RewriteRule   ^(.+)\.html$                       /index.php?path=$1.html [QSA] 
```

实际上在运行所有脚本后结果是：

```
index.php?path=/some/thing/index0.html/some/thing/index0&f1=nice-cars&f2=planes&f3=karts&f4=bike 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T11:49:55.497

I found resolution of this problem. When 2 rules match URL at one pass of .htaccess, then apache rewrite_mod use method "add path info postfix" (its something like bug or feature), which ruin path of request. So when I added flag [L] to that 2 rules, result is OK.

I thinked that apache pass .htaccess sequentially and does not matter on next rules...

# c++ - 使用本机 C++ 库构建移动应用程序的快速方法

> ID：10774279
> 
> 赞同：1
> 
> 时间：2012-05-27T13:19:36.323
> 
> 标签：c++, html, mobile

我正在考虑构建一个移动应用程序。我的第一个目标是 iPad/iPhone 设备。Android 目标也很不错。我已经为 win32 编写并测试了该应用程序，我希望以最少的努力将其移植到移动平台。

我的应用程序是用 C++ 编写的。它的主要功能是解析呈现数学表达式（脚本语言）的字符串。我将独立于平台的代码隔离在我使用 Xcode 为 iOS 成功编译的静态库中。我需要添加一些 UI 来与库进行交互。交互是在两个方向上进行的。UI 将字符串表达式发送到静态库并调用一些函数来读取变量值（主要是浮点数和字符串的向量（表））。另一方面，该库需要一些外部函数来在 TextView 上打印文本结果和一些绘图函数。

在我的 UI 层中，我需要调用静态库导出的一些外部“C”函数，例如：

```
int ExecuteExpression(char *expression)
void StopExecution() 
```

在我的库中，我需要调用一些由 UI 应用程序导出的外部“C”函数，例如：

```
void PrintText(char *text)
void Plot2D(double *x, double *y, int len);
void plot3D(double *x, double *y, double *z, int len); 
```

我查看了[MoSync](http://www.mosync.com/) IDE，但它不允许调用用户制作的静态库。

我还查看了[Marmalade EDK](http://www.madewithmarmalade.com/marmalade/features/extensions-development-kit-edk)，这似乎是一种通过编写扩展来制作调用用户定义的静态库的 UI 的好方法。我不明白为什么我必须编写一个 EDK 来包装我的果酱库函数，因为最终项目是在 Xcode 中编译的，我认为我必须能够直接调用我的“C”函数并与我的库链接。但是 Marmalde 是否提供了 iOS UI 的原生外观和感觉？我可以使用 C++ 使用橘子酱 API 直接在 NSView 上绘图吗？

对于绘图功能，我有几个选择： 1- 在我的库中 (RGB) 的缓冲区图像中进行绘图，并将图像数据发送到 UI 以在视图 (NSView) 中显示。在这种情况下，与地块的交互将非常有限。更改视图尺寸时重绘将是一个需要解决的问题，因为绘图例程必须记住为绘制图形所做的所有操作。

2- 使用 HTML5/JS 函数在 UI 层中绘制。在这种情况下，我必须能够将 HTML5/JS 函数导出为“C”函数，例如“Plot2D(double *x, double *y, int len)”，以便从库中调用它们。UI 层会保存一份数据副本，重绘、缩放等将由 HTML5/JS 代码管理。这可能吗 ？有没有从“C”静态库调用 HTML5/JS 的例子？

3- 将原始绘图函数（如线、点、矩形、多边形填充、画布手柄等）从 UI 层导出到我的静态库，并使库管理所有绘图函数。UI 也会发送一些事件用于重绘、缩放等。

4-您提出的任何其他解决方案。

正如你在我的帖子中所了解的，我掌握了 C、C++、JS、HTML5、delphi，并且只对 Objective-C 和 iOS UIkit 有一些基本的了解。所以我试图找到最有效的方法来制作我的应用程序。

问候，

# ubuntu - 如何以普通用户身份在 Linux 上安装 OpenCV

> ID：10774282
> 
> 赞同：3
> 
> 时间：2012-05-27T13:20:12.070
> 
> 标签：ubuntu, opencv

我正在尝试在远程服务器上安装 opencv。他们说我可以这样做，但我应该作为普通用户这样做，而且我不会拥有高级访问权限，这意味着“没有 sudo”！所以我想知道是否有办法只在我自己的帐户上作为普通用户安装它。

我真的是 Linux 新手（我使用 ubuntu 11.10 ），我在自己的 PC 上使用了本指南： [在 Ubuntu 11.04 中安装 OpenCV 2.2](http://www.samontab.com/web/2011/06/installing-opencv-2-2-in-ubuntu-11-04/)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T09:34:26.723

在这种情况下，您需要自己编译，这里解释：http: [//opencv.willowgarage.com/wiki/InstallGuide](http://opencv.willowgarage.com/wiki/InstallGuide)

您只需下载 tar.gz，然后将其解压缩并在终端中转到该目录。

完成此操作后，您需要首先配置您想要的和不想要的。您可以通过运行 cmake 或 cmake-gui 来实现。使用 cmake-gui，如果你想要一个 gui ;)

```
cmake-gui 
```

在 cmake-gui 中，您需要指定放置一些文件的目录，在终端中转到该目录并运行 make。

```
make 
```

在此之后，您应该搜索包含头文件（.h 或 .hpp）的目录和包含库文件（.a、.so 和 .o）的目录。将第一个添加到您的 INCLUDE_PATH 目录，将第二个添加到您的 LD_LIBRARY_PATH 变量；）

那应该这样做。请注意，这是一个“记忆中”的解释，因为编译 opencv 需要很长时间，我自己没有尝试过。但是，如果您仍有疑问，请随时发表评论。我想给你的最好建议是使用 cmake-gui 并查看那里有哪些可用选项。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T19:03:01.080

只需为您提供更多数据点。

我无法在我的 Debian 6 机器上构建 OpenCV 2.4.0（ubuntu 11 基于 Debian 6）。OpenCV 2.3.1 编译和安装很好，但我对 2.4.0 版本没有任何问题。

但请注意，为了构建 OpenCV，有许多包依赖项。要安装这些依赖项中的任何一个，都需要 sudo 或 root 权限。

我强烈支持 Herbert 的建议，即使用 cmake-gui，而不是命令行版本的 cmake。gui 版本 cmake-gui 让您在实际进行编译之前更容易获得所有选项。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-10-22T03:14:12.660

这是我从[http://namhuy.net/1205/how-to-install-opencv-on-ubuntu.html](http://namhuy.net/1205/how-to-install-opencv-on-ubuntu.html)在 Ubuntu 上安装 OpenCV所遵循的

```
$ su -
# apt-get update
# apt-get install build-essential
# apt-get install libavformat-dev
# apt-get install x264 v4l-utils ffmpeg
# apt-get install libcv2.3 libcvaux2.3 libhighgui2.3 python-opencv opencv-doc libcv-dev libcvaux-dev libhighgui-dev 
```

# xaml - ScrollViewer + ScrollBar 箭头

> ID：10774283
> 
> 赞同：0
> 
> 时间：2012-05-27T13:20:14.013
> 
> 标签：xaml, windows-runtime, winrt-xaml

当用户单击滚动条箭头时，内容移动非常缓慢（水平偏移在 16 处发生变化）。单击箭头时如何提高换档速度？（SmallChange 不起作用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T20:36:41.623

不幸的是，它在滚动查看器中是相当硬编码的。

我知道的唯一方法是根据您要在滚动查看器中使用的面板制作一个新面板，并`IScrollInfo`为其实现。

然后，将此面板设置为滚动查看器的内容并设置`CanContentScroll`为 true。

`StackPanel`工具`IScrollInfo`，但其他面板没有。

# scala - 采用隐式 CanBuildFrom 的方法不适用于 eta 扩展？

> ID：10774284
> 
> 赞同：5
> 
> 时间：2012-05-27T13:20:22.713
> 
> 标签：scala, scala-collections

我有以下方法：

```
def firstAndLast[CC, A, That](seq: CC)(implicit asSeq: CC => Seq[A], cbf: CanBuildFrom[CC, A, That]): That = {
  val b = cbf(seq)
  b += seq.head
  b += seq.last
  b.result
} 
```

请参阅：[方法采用 Seq[T] 返回 String 而不是 Seq[Char]](https://stackoverflow.com/questions/10689161)以了解基本原理。它在第一种情况下就像一个魅力，但在第二种情况下无法编译：

```
List("abc", "def") map {firstAndLast(_)}
List("abc", "def") map firstAndLast 
```

给予：

```
error: No implicit view available from CC => Seq[A].
List("abc", "def") map firstAndLast 
```

知道如何改进此声明以避免额外的包装吗？似乎 eta-expansion 是问题所在（？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:44:29.103

不是您问题的完整答案，但我刚刚注意到这有效：

```
List("abc", "def") map firstAndLast[String, Char, String] 
```

这意味着类型推断器无法确定 的正确类型参数`firstAndLast`，但我不知道如何修复它……</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T16:13:47.420

尽管它们看起来相似，但它们是不同的东西：

```
List("abc", "def") map {firstAndLast(_)}
// { x => firstAndLast(x) }

List("abc", "def") map firstAndLast
// firstAndLast, if it happened to be a function 
```

现在，请注意编译器如何`x`在第一种情况下轻松键入。在第二种情况下，它试图弄清楚如何`(seq: CC)(implicit asSeq: CC => Seq[A], cbf: CanBuildFrom[CC, A, That])`解释为`Function1[String, ???]`，它失败了，因为缺少很多信息——即类型参数。

换句话说，在第一种情况下，编译器*首先*键入`x`，因此，`CC`，然后尝试找出其余的。在第二种情况下，编译器试图同时找出所有类型参数。

# r - 如何在 R 中导出 HTML 表格并控制线条边框？

> ID：10774285
> 
> 赞同：4
> 
> 时间：2012-05-27T13:20:39.697
> 
> 标签：r

R 中是否有任何函数允许将 HTML 表格作为 R Markdown 或相关编织文档的一部分导出，并允许对表格行边框进行详细控制？

例如，想象一个这样的矩阵：

```
x <- matrix(c("", "M", "F", "Good", 
"23", "17", "Bad", "23", "4"), nrow=3, byrow=TRUE) 
```

什么命令会输出一个正确的 HTML 表格，其特征如下：

```
 --------
       M     F
---------------
 Good  23    17
---------------
 Bad   23    4
--------------- 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T19:00:36.653

您可以尝试我在重度开发下名为 pander 的非常年轻的包，[它](http://johnmacfarlane.net/pandoc/)试图以 pandoc markdown 格式打印 R[对象](https://github.com/daroczig/pander)。

懒惰的例子：

```
> x <- matrix(c("", "M", "F", "Good", "23", "17", "Bad", "23", "4"), nrow=3, byrow=TRUE)
> pandoc(x)

+------+------+------+
|      | M    | F    |
+------+------+------+
| Good | 23   | 17   |
+------+------+------+
| Bad  | 23   | 4    |
+------+------+------+ 
```

我只是在处理一些导致其他表语法的函数，例如“简单表”或“多行表”（请参阅​​ Pandoc 的自述文件）。

* * *

PS：您还可以使用（尚未记录的）`Pandoc`参考类轻松将此表导出为 HTML（除了 docx、odt 等其他格式），例如：

```
> myReport <- Pandoc$new()
> myReport$add(x)
> myReport

Anonymous's report
==================
 written by *Anonymous* at *Sun May 27 21:04:22 2012*

  This report holds 1 block(s). 

---

+------+------+------+
|      | M    | F    |
+------+------+------+
| Good | 23   | 17   |
+------+------+------+
| Bad  | 23   | 4    |
+------+------+------+

---

Proc. time:  0.009 seconds. 

> myReport$format <- 'html'
> myReport$export()

Exported to */tmp/pander-4e9c12ff63a6.[md|html]* under 0.031 seconds. 
```

* * *

PS第二：您还可以[`brew`](http://cran.r-project.org/web/packages/brew/index.html)（如编织）一个文本文档，使用该文档将您的标签从内部R对象`Pandoc.brew`自动转换为Pandoc markdown格式。`<%=...%>`简短的例子（当然这也适用于文件输入，现在我只是`brew`一个 R 字符向量）：

```
> t <- '# Title
+ 
+ A nice matrix:
+ 
+ <%=matrix(c("", "M", "F", "Good", "23", "17", "Bad", "23", "4"), nrow=3, byrow=TRUE)%>
+ 
+ Bye-bye!'
> 
> Pandoc.brew(text=t)
# Title

A nice matrix:

+------+------+------+
|      | M    | F    |
+------+------+------+
| Good | 23   | 17   |
+------+------+------+
| Bad  | 23   | 4    |
+------+------+------+

Bye-bye! 
```

# c - Openssl base64解码字符串并不总是解密

> ID：10774287
> 
> 赞同：4
> 
> 时间：2012-05-27T13:20:47.760
> 
> 标签：c, windows, openssl

我正在尝试使用 RSA_public_encrypt() 使用公钥加密一些纯文本，然后将这些数据发送到远程服务器进行验证。我相信我的加密/解密工作正常，因为 RSA_public_encrypt 的输出可以传递给 RSA_private_decrypt 并且它可以工作。我现在遇到的问题是我需要对数据进行 base64 编码以便通过 HTTP 发送它。

作为测试（在将其发送到服务器之前），我将 RSA_public_encrypt() 的输出编码为 base64，然后对其进行解码并将其传递回 RSA_private_decrypt()。这似乎在某些时候有效，但失败并出现如下错误：

```
error:0407A079:rsa routines:RSA_padding_check_PKCS1_OAEP:oaep decoding error 
```

当我使用 memcmp 将原始数据（pre-base64）与我的 base64 解码函数的输出进行比较时，尽管内容看起来匹配（在 Visual Studio 中通过将内存内容查看为十六进制），但我收到 -1。我还使用各种在线工具检查了 base64 编码版本，它们似乎可以解码为预期值。

我已经仔细检查了 base64/unbase64 函数的输入/输出是否为空终止，这似乎没什么区别。

几天来，我一直在围绕这个问题转圈，但我相信它一定与 base64 编码/解码过程有关，因为当不涉及该问题时，一切正常。如果有人对如何发生这种情况有任何建议，将不胜感激。

**Openssl 版本：** 1.0.1c

**平台：** Windows/MSVC

**Base64 代码：**

```
char *base64(const unsigned char *input, int length)
{
  BIO *bmem, *b64;
  BUF_MEM *bptr;
  char *buff = NULL;

  b64 = BIO_new(BIO_f_base64());
  BIO_set_flags(b64, BIO_FLAGS_BASE64_NO_NL);
  bmem = BIO_new(BIO_s_mem());
  b64 = BIO_push(b64, bmem);
  BIO_write(b64, input, length);
  BIO_flush(b64);
  BIO_get_mem_ptr(b64, &bptr);

  buff = (char *)malloc(bptr->length+1);
  memcpy(buff, bptr->data, bptr->length);
  buff[bptr->length] = '\0';

  BIO_free_all(b64);

  return buff;
} 
```

**Unbase64 代码：**

```
char *unbase64(unsigned char *input, int length)
{
  BIO *b64, *bmem;

  char *buffer = (char *)malloc(length+1);
  memset(buffer, 0, length+1);

  b64 = BIO_new(BIO_f_base64());
  BIO_set_flags(b64, BIO_FLAGS_BASE64_NO_NL);
  bmem = BIO_new_mem_buf(input, length);
  bmem = BIO_push(b64, bmem);

  BIO_read(bmem, buffer, length);
  buffer[length] = '\0';

  BIO_free_all(bmem);

  return buffer;
} 
```

**加密的“hello world”示例：**

```
š:Œ¼JŒ"ÌïëŸÔè#¢Oo‚À–    œê\çrú¿±a/8ƒòÌ¢Q\T¹]nío 
```

**Base64 版本（使用上面的代码）：**

```
G5qdOgWMvEqMIswZ7+uf1OgPI6JPb4LAlgmc6lzncvq/sWEvOIPyzByiUVwMjYFUuV0Vbu1v 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:59:55.130

您在`unbase64`函数中传递了正确的大小？它应该是返回的 base64 缓冲区的大小，而不是目标缓冲区的大小，即使用示例主函数：

```
int main(void)
{
  unsigned char bufron[2000];
  int i;
  char *chab;
  unsigned char *chac;

  for (i = 0; i < 2000; i++) {
      bufron[i] = i % 255;
  }

  chab = base64(bufron, 2000);
  printf("%s\n", chab);

  chac = unbase64(chab, strlen(chab));

  for (i = 0; i < 2000; i++) {
      if (bufron[i] != chac[i]) {
          printf("Failed at %d\n", i);
          return (1);
      }
  }
} 
```

# php - 将表单数据发布到 Amazon S3 存储桶

> ID：10774293
> 
> 赞同：5
> 
> 时间：2012-05-27T13:22:05.357
> 
> 标签：php, forms, amazon-s3, amazon-web-services, encode

我已经花了三天时间尝试为亚马逊 s3 设置一个简单的发布表单。每次我得到这个错误：

> SignatureDoesNotMatch 我们计算的请求签名与您提供的签名不匹配。检查您的密钥和签名方法。

我没有看到问题。:-(

```
<?php
        $form = array(
            'key'                       => 'queue/1_1_1234567890.wmv',
            'AWSAccessKeyId'            => 'mypublickeyishere',
            'acl'                       => 'public-read',
            'success_action_redirect'   => 'http://someurl.com',
        );

        $form['policy'] = '{
            "expiration": "2015-12-01T12:00:00.000Z",
                "conditions": [
                    {
                        "acl": "'.$form['acl'].'"
                    },
                    {
                        "success_action_redirect": "'.$form['success_action_redirect'].'"
                    },
                    {
                        "bucket": "thenameofmybucket"
                    },
                    [
                        "starts-with",
                        "$key",
                        "queue/"
                    ]
                ]
            }';

    $form['policy_encoded'] = base64_encode($form['policy']);
    $form['signature'] = base64_encode(hash_hmac( 'sha1', base64_encode(utf8_encode($form['policy'])), 'F90mc5kpjuNMPg8XG7iV6bxOzacYhktcw+RVGzpZ'));

?>

<form action="https://thenameofmybucket.s3.amazonaws.com/" method="post" enctype="multipart/form-data">
      <input type="hidden" name="key" value="<?php echo $form['key'] ?>">
      <input type="hidden" name="AWSAccessKeyId" value="<?php echo $form['AWSAccessKeyId'] ?>">
      <input type="hidden" name="acl" value="<?php echo $form['acl'] ?>">
      <input type="hidden" name="success_action_redirect" value="<?php echo $form['success_action_redirect'] ?>">
      <input type="hidden" name="policy" value="<?php echo $form['policy_encoded'] ?>">
      <input type="hidden" name="signature" value="<?php echo $form['signature'] ?>">

      File to upload to S3:
      <input name="file" type="file">
      <br>
      <input type="submit" value="Upload File to S3">
</form> 
```

我替换了存储桶名称以及上面的私钥和公钥。

我按照说明仔细签署了政策：http: [//docs.amazonwebservices.com/AmazonS3/2006-03-01/dev/HTTPPOSTForms.html#HTTPPOSTConstructPolicy](http://docs.amazonwebservices.com/AmazonS3/2006-03-01/dev/HTTPPOSTForms.html#HTTPPOSTConstructPolicy)

我错过了什么？为什么代码不起作用？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-06-21T16:16:11.497

不需要该库，您只是缺少一个参数。问题是你没有设置 hash_hmac 函数来输出二进制数据。为此，请将第四个参数设置为`true`：

```
$signature = base64_encode(hash_hmac('sha1', $policy_b64, $secret, true)); 
```

如果您不设置此项，它将不会按照 AWS 期望的方式对签名进行编码。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T02:58:59.683

我已经回答了您自己的问题，但我想知道本教程（[http://aws.amazon.com/articles/1434](http://aws.amazon.com/articles/1434)）是否建议您在进行基本 64 编码之前必须从 json 中删除返回字符问题的根源？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-28T07:03:29.290

好的，我终于设法使用这个示例代码库完成了这项工作：http: [//aws.amazon.com/code/Amazon-S3/1618](http://aws.amazon.com/code/Amazon-S3/1618)

# postgresql - 在 postgresql 上插入 INTO where 子句

> ID：10774296
> 
> 赞同：1
> 
> 时间：2012-05-27T13:22:15.303
> 
> 标签：postgresql

> **可能重复：**
> [插入，重复更新（postgresql）](https://stackoverflow.com/questions/1109061/insert-on-duplicate-update-postgresql)

这在 PostgreSQL 上是否可行：

```
insert record, if the record doesn't exists
else update existing record 
```

假设记录将被插入到这个表结构中：

```
[userid - unique] [count] 
```

如果有现有记录，我将更新计数或插入，如果它不存在

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T16:30:42.220

您必须在 PostgreSQL 中编写一个函数来执行此操作，因为没有类似于 mysql 的[INSERT ... ON DUPLICATE KEY UPDATE](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)的东西。在 PostgreSQL 官方文档中查看[此功能。](http://www.postgresql.org/docs/current/static/plpgsql-control-structures.html#PLPGSQL-UPSERT-EXAMPLE)

# java - 浏览器在 java 中不显示 out.println

> ID：10774297
> 
> 赞同：0
> 
> 时间：2012-05-27T13:22:16.310
> 
> 标签：java, jakarta-ee

我已经完成了导入

```
import static java.lang.System.out; 
```

然后我尝试了

```
out.println( "test"); 
```

但它所做的一切都是一样的

```
System.out.println("test"); 
```

两者都显示在日志中但不显示在浏览器中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:27:34.527

当您在 servlet 中时，您必须编写：

```
response.getWriter().println("test"); 
```

Where`response`是[`ServletResponse`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html)类型（或[`HttpServletResponse`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html)继承自它）。如果您尝试从不同的类调用它，则必须传递整个`ServletResponse`或`PrinterWriter`从其返回`getWriter()`并将其用作`out`变量。

注意：

```
import static java.lang.System.out;
out.println( "test"); 
```

相当于：

```
System.out.println("test"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T13:28:22.353

您所做的只是一个[静态导入](http://docs.oracle.com/javase/1.5.0/docs/guide/language/static-import.html)，它允许您在`System.out`不输入的情况下使用`System.`

如果要写入浏览器，则需要访问 HttpServletResponse 的编写器：

```
PrintWriter out = response.getWriter();
// you may pass out to your other classes, so that they write to the browser using
out.println("hello from a class"); 
```

# android - 在示例 Android 应用程序中使用解析 SDK 库时出错

> ID：10774303
> 
> 赞同：3
> 
> 时间：2012-05-27T13:23:20.380
> 
> 标签：android

在这里，我正在使用名为 3rd 的 sdk 做一些事情，`parse sdk`它为 Android 平台提供了一些 api。

我浏览了这个[链接](https://www.parse.com/apps/quickstart#android/existing)并尝试为这个解析 sdk 做一些示例工作。

但是在完成了该链接上提到的所有 stpes 之后，我无法运行这个测试 android 应用程序。

我在 logcat 中收到以下错误。

我已经在项目根目录中创建的 libs 文件夹中导入了 .jar 文件。

代码：

```
package com.parse.starter;

import com.parse.Parse;
import com.parse.ParseObject;

import android.app.Activity;
import android.os.Bundle;

public class ParseStarterProjectActivity extends Activity {
    /** Called when the activity is first created. */
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Parse.initialize(this, "ZVhSPsDKds8cerZ2jjDNXCpu332RHtix6Gp7YkDa", "poQXYifVzMd6haf56U5FQ13xeCxecdGippZeCMyVO");
         ParseObject testObject = new ParseObject("TestObject");

         testObject.put("foo", "bar");
         testObject.saveInBackground();
        setContentView(R.layout.main);
    }
} 
```

错误日志：

```
05-27 17:16:47.200: W/dalvikvm(468): threadid=1: thread exiting with uncaught exception (group=0x40015560)
05-27 17:16:47.210: E/AndroidRuntime(468): FATAL EXCEPTION: main
05-27 17:16:47.210: E/AndroidRuntime(468): java.lang.NoClassDefFoundError: com.parse.ParseObject
05-27 17:16:47.210: E/AndroidRuntime(468):  at com.parse.starter.ParseStarterProjectActivity.onCreate(ParseStarterProjectActivity.java:14)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.os.Looper.loop(Looper.java:123)
05-27 17:16:47.210: E/AndroidRuntime(468):  at android.app.ActivityThread.main(ActivityThread.java:3683)
05-27 17:16:47.210: E/AndroidRuntime(468):  at java.lang.reflect.Method.invokeNative(Native Method)
05-27 17:16:47.210: E/AndroidRuntime(468):  at java.lang.reflect.Method.invoke(Method.java:507)
05-27 17:16:47.210: E/AndroidRuntime(468):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-27 17:16:47.210: E/AndroidRuntime(468):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-27 17:16:47.210: E/AndroidRuntime(468):  at dalvik.system.NativeStart.main(Native Method) 
```

编辑 ：

根据choop评论。

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="src" path="gen"/>
    <classpathentry kind="con" path="com.android.ide.eclipse.adt.ANDROID_FRAMEWORK"/>
    <classpathentry exported="true" kind="con" path="com.android.ide.eclipse.adt.LIBRARIES"/>
    <classpathentry kind="lib" path="libs/Parse-1.0.19.jar"/>
    <classpathentry kind="output" path="bin/classes"/>
</classpath> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T10:15:19.773

将下载的`.jar`文件添加到您的 libs 文件夹中。然后在 Eclipse 中，右键单击该`.jar`文件并选择`"add to build path"`. 然后再次运行您的项目。这应该解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-18T19:15:16.193

我在同一个问题上花了几个小时，这有助于解决这个问题。

[升级到 ADT 22 后，库不再添加到 APK](https://stackoverflow.com/questions/16596969/libraries-do-not-get-added-to-apk-anymore-after-upgrade-to-adt-22)

# computer-vision - 图像校正的单应性

> ID：10774305
> 
> 赞同：0
> 
> 时间：2012-05-27T13:24:48.443
> 
> 标签：computer-vision, homography

我们可以对立体图像进行图像校正。对于单个图像，我们可以找到两个消失点，然后是消失线。使用这条消失线，我们可以进行射影校正。但是仿射校正需要什么约束？

我基本上想将图像校正为其正面视图，以使世界中的平行线平行且平行于 x 轴。我希望自己清楚..

将图像中的消失点 (x,y) 转移到 (1,0,0) 的单应性是什么？？？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T12:47:30.343

投影变换将成像点转换为理想点 (1,0,0)。因此，它将图像校正为人们通常希望看到的仿射变换。这个过程是“仿射校正”。仿射变换使线条保持平行，但会使图像倾斜并使其看起来很奇怪，因此我不确定您是否要停止。仿射变换可以将圆变成椭圆，并且可以改变相交线的角度。

要消除仿射变换（度量校正），必须识别“圆点的圆锥对偶”。这可以通过识别两对垂直线来完成；识别一个真正应该是圆的椭圆；或者通过使用两个已知的长度比。完成此操作后，您的图像与您希望它的外观之间的唯一区别将是它的比例、它的 x 和 y 位置以及整个图像的旋转。

# java - 如何在代码中实现 Eclipse VM 参数

> ID：10774308
> 
> 赞同：1
> 
> 时间：2012-05-27T13:25:11.440
> 
> 标签：java, vlc, vlcj, run-configuration

这可能是一个简单的问题，但我目前正在使用 vlcj 为项目制作视频播放器。我有一个基本的播放器在工作，但只有当我有 VM 争论时

```
-Djna.library.path="C:\Program Files\VideoLAN\VLC" 
```

在调试配置窗口中定义。我的问题是，如果我需要创建这个项目的一个版本以在 Eclipse 之外运行，我是否需要在我的代码中定义这个参数，或者我的程序是否会以这种方式无限期地运行而不会出现问题？

感谢任何回答的人，

杰瑞德。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-27T13:45:44.003

我认为

```
System.getProperties().setProperty("jna.library.path",
  "C:\\Program Files\\VideoLAN\\VLC"); 
```

应该在这种特殊情况下的代码中完成这项工作。 `-D`设置系统属性的参数`java`，最终以`System.getProperties()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:33:44.683

您不能在运行时设置 JVM 参数，如果要导出项目，则必须找到另一种方法：这是通过将程序的执行包装在脚本文件中来完成的，让它成为一个`.bat`或`.sh`这样您就可以使用您的参数集调用 java 可执行文件。

我假设您正在谈论在 Eclipse 之外执行程序。

# android - 如何在 onClickListener 中修改类的数据标签？

> ID：10774313
> 
> 赞同：-2
> 
> 时间：2012-05-27T13:25:56.260
> 
> 标签：android

请帮我解决这个问题，我从来不明白 onClickListener 内部是如何工作的，所以：

有我自己的课：

```
public class ItemFrame extends LinearLayout{

     int item_id;

     public ItemFrame(Context context){
        super(context);
     }

     public int getItem_id() {
        return item_id;
     }

    public void setItem_id(int item_id) {
        this.item_id = item_id;
     }
} 
```

我初始化一个并添加一个 onClickListener：

```
ItemFrame myItemFrame = new ItemFrame(this);

myItemFrame.setOnClickListener(new OnClickListener(){
                public void onClick(View v){

                                   //ERROR HERE:
                                   //Cannot refer to a non-final variable myItemFrame inside an inner class 
                                   //defined in a different method
                                   //Quick fix: Change modifier of 'myItemFrame' to final.
                    myItemFrame.setItemId(100);
                }

            }); 
```

所以...我的问题是：如何在 onClickListener 中设置我的班级的数据标签？？？如果我将它更改为 Eclipse 所说的 final ，我无法修改它，因为它是**final**。这有什么意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:32:44.030

您创建的 OnClickListener 是一个匿名内部类，只能引用最终值。

简单地改变：

```
ItemFrame myItemFrame = new ItemFrame(this); 
```

成为：

```
final ItemFrame myItemFrame = new ItemFrame(this); 
```

您仍然可以修改您创建的 ItemFrame 对象。您只是无法将新变量重新分配给 myItemFrame 变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T13:33:49.120

还有另一种实现代码的方法，看看它。

```
public class ItemFrame extends LinearLayout implements OnClickListener
{
     int item_id;

     public ItemFrame(Context context)
     {
        super(context);
     }

     public int getItem_id() 
     {
        return item_id;
     }

    public void setItem_id(int item_id) 
    {
        this.item_id = item_id;
    }

    public void onClick(View v)
    {
       setItemId(100);
    }
} 
```

# javascript - 数字格式的正则表达式

> ID：10774314
> 
> 赞同：2
> 
> 时间：2012-05-27T13:26:02.143
> 
> 标签：javascript, regex

我不是正则表达式专家，我需要一些关于格式化数字的帮助。

这就是我所拥有的：

```
TheNumber = TheNumber.toString().split(/(?=(?:\d{3})+(?:\.|$))/g).join(","); 
```

基本上，我希望 TheNumber 用逗号格式化，以分隔千位和最多 3 位小数精度，如果有小数，则用点表示小数。它也应该适用于负数。

我现在不远了

```
3234234.223512 becomes 3,234,234.223,512 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:45:32.493

我找到了这个 Javascript 库[accounting.js](http://josscrowcroft.github.com/accounting.js/#download)

如描述中所述。
Accounting.js 是一个用于数字、货币和货币格式的小型 JavaScript 库，具有可选的 excel 样式列渲染（用于排列符号和小数）。它是轻量级的、完全可本地化的并且具有零依赖性。

它与您的要求相同，甚至更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:27:31.443

我会分两部分解决这个问题，而不是一个正则表达式。特别是，我会：

1.  首先从字符串中删除小数点和任何以下数字
2.  使用您的 reg exp（减去小数部分）在第一部分添加逗号
3.  连接回删除的小数点

# objective-c - 如何设置 NSPanel 的颜色和纹理

> ID：10774317
> 
> 赞同：0
> 
> 时间：2012-05-27T13:26:48.410
> 
> 标签：objective-c, cocoa, panel

我在菜单栏弹出窗口中有一个标准的 NSPanel，并想给它一个颜色（如红色），以及一个柔和/噪声纹理以获得良好的效果。我怎样才能做到这一点（欢迎使用 Interface Builder 或 Obj-c）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:11:11.523

继承 NSView 并覆盖 drawRecth: 方法。然后，前往 IB 并点击 Panel 的内容。在身份检查器中，将新的子类设置为自定义类。

# php - 我怎么知道哪个 iframe 正在调用父函数？

> ID：10774319
> 
> 赞同：-1
> 
> 时间：2012-05-27T13:27:13.433
> 
> 标签：php, javascript, iframe

我有几个不时调用父函数的 ifrmaes。我怎么知道哪个框架称为父框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:34:10.953

仍然可以使用 找出哪个函数正在调用您的函数`arguments.callee`，但这在这里不起作用。

为了找出你必须标记你的 iframe 并将该标记与函数调用一起传递。

# java - 适用于 JFLAP 的 IP 验证正则表达式

> ID：10774322
> 
> 赞同：1
> 
> 时间：2012-05-27T13:28:00.487
> 
> 标签：java, regex, ip, automata, jflap

我注意到我们程序员在我们的程序中使用的正则表达式用于诸如

*   电子邮件地址验证
*   知识产权验证
*   ...

***与Automata***中使用的那些正则表达式有点不同（如果我没记错的话）

顺便说一句，我想设计一个 NFA 并最终设计一个用于 IP 验证的 DFA。我发现了很多正则表达式，例如以下一个：

```
\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b 
```

但我无法使用 JFLAP 将其转换为 NFA 或 DFA。

我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:36:55.263

您不需要直接转换正则表达式，您可以在了解它的目的后重写它。

有效的 IPv4 地址是由小数点分隔的 4 个数字。每个数字可以从 0 到 255。正则表达式的范围不是很好，所以这就是它看起来像的原因。您发布的正则表达式检查它是否以 2 开头，然后接下来的两个数字每个不能大于 5，如果它以 1 开头，它们可以上升到 9，等等。

验证正则表达式的最简单方法是将其拆分`.`为分隔符，将字符串转换为数字，然后检查它们的范围。

也就是说，您发布的正则表达式中没有任何不标准的内容。就像他们来的一样简单，我不知道为什么它对你不起作用。

# visual-c++-2008 - Windows Server 2008 的 Windows SDK 是 Visual C++ 和 C# 的依赖项吗？

> ID：10774324
> 
> 赞同：0
> 
> 时间：2012-05-27T13:28:12.173
> 
> 标签：visual-c++-2008, winapi

当我安装 Microsoft Visual C++ 和 C# 2008 Express 时，我添加了“Microsoft Windows SDK for Windows Server 2008”。

我想知道我是否可以删除它并仍然拥有 Visual C++/C# 的所有功能。

![截屏](../Images/26d3b57de06f3079829ddd4f42470a7e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T17:16:19.443

奇怪，我记得它附带了 Vista RTM 标头（适用于 Windows Vista 版本的 Microsoft Windows 软件开发工具包更新）。看起来微软更新了与 Express 捆绑的 SDK。

无论如何，SDK 负责 Visual Studio 中的许多功能。例如，Visual Studio 调用 sgen.exe 来生成 XML 序列化程序程序集，并调用 rc.exe 来编译资源脚本。如果您不编写 hello-world 应用程序，您可能无法离开它。

# c# - 如何使用 TagLib# 从视频文件中获取 VideoHeader 信息

> ID：10774327
> 
> 赞同：1
> 
> 时间：2012-05-27T13:28:34.267
> 
> 标签：c#, header, mpeg, frame-rate, taglib-sharp

我正在创建一个程序来访问不同类型文件的信息，到目前为止，我主要使用 MP3 文件取得了成功，现在正在处理视频 MPG 等类型。

到目前为止，我已经能够毫不费力地获得视频标题、年份、持续时间、类型、视频高度和宽度，现在我正在尝试从 TagLib 的 VideoHeader 部分访问稍微困难的方面。

这是我通过在此处找到有关 AudioHeaders 的内容而设法获得的代码，但它不起作用：

```
TagLib.File f = TagLib.Mpeg.File.Create(GetMPG.FileName);

foreach(ICodec codec in f.Properties.Codecs){
  TagLib.Mpeg.VideoHeader G = (TagLib.Mpeg.VideoHeader) codec;
  MPGbps.Text = G.VideoFrameRate.ToString();
} 
```

我哪里错了？

我的新当前代码：

```
TagLib.File f = TagLib.File.Create(GetMPG.FileName);
foreach(ICodec codec in f.Properties.Codecs){
  TagLib.Mpeg.VideoHeader G = (TagLib.Mpeg.VideoHeader) codec;
  if (G != null)
    {
      MPGbps.Text = G.VideoFrameRate.ToString();
    }
} 
```

这以错误结束：

## 错误 2 运算符“！=”不能应用于“TagLib.Mpeg.VideoHeader”和“< null >”类型的操作数

注意：在最终的 null 中添加了空格，因为它没有出现在帖子中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T15:16:38.817

视频文件有多个编解码器，一个音频和一个视频。您的代码发生的情况是，在循环的一次迭代中，编解码器不是 VideoHeader 意味着 G 设置不正确。我不确定这是否会触发异常，或者 G 是否设置为空 VideoHeader。

下面的代码应该可以工作：

```
TagLib.File f = TagLib.File.Create(GetMPG.FileName);

foreach(ICodec codec in f.Properties.Codecs){
  if(codec is TagLib.Mpeg.VideoHeader) {
    TagLib.Mpeg.VideoHeader G = (TagLib.Mpeg.VideoHeader) codec;
    MPGbps.Text = G.VideoFrameRate.ToString();
  }
} 
```

另外，您应该`TagLib.File.Create`改用。它是一种静态工厂方法。

**更新**

除了上述`codec`被转换为错误类型的初始问题之外，还有一个问题是文件不是 MPEG 并且实际上不包含`TagLib.Mpeg.VideoHeader`a 而是有 a `TagLib.Riff.BitmapInfoHeader`。除了由 保证的基本属性之外`TagLib.IVideoCodec`，各个文件格式提供的详细信息因具体情况而异。了解范围内的文件类型、要检测的功能以及提取可用的视频详细信息非常重要。

# c++ - 收集 Outlook 联系人列表

> ID：10774329
> 
> 赞同：1
> 
> 时间：2012-05-27T13:28:40.157
> 
> 标签：c++, windows, outlook, mapi

有人可以告诉我使用什么 API 来收集 Outlook 联系人列表？我看到一些问类似问题的人使用了一个叫做“MPI”的东西，但我不知道如何使用在 C++ 中设置的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:31:45.150

它不是 MPI 而是[MAPI](http://en.wikipedia.org/wiki/Messaging_Application_Programming_Interface)。它是基于 COM 的。

它的文档在[这里](http://msdn.microsoft.com/en-us/library/cc765775.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:09:38.777

可以在[这里找到一个非常好的 C++ 代码示例](http://www.codeproject.com/Articles/3695/Importing-contacts-from-Outlook)

# java - 如何从帮助程序类将字符串发送到 JTextField？

> ID：10774331
> 
> 赞同：1
> 
> 时间：2012-05-27T13:30:23.033
> 
> 标签：java, swing, concurrency, jtextfield

例如，在下面的代码中，我想更改 JTextField 以显示端口即时扫描是否打开，但我不知道该怎么做。也许我需要一些辅助方法？

```
public void actionPerformed(ActionEvent arg0) {
  console.setText("Starting check\n" +
    "Start = "+stopServTf.getText()+
    "\nStop ="+stopServTf.getText()+
    "\nPort Start ="+startPortTf.getText()+
    "\nPort Stop ="+stopPortTf.getText());
  PortScanner p= new PortScanner(Integer.parseInt(startPortTf.getText()),
    Integer.parseInt(stopPortTf.getText()),startServTf.getText());
} 
```

和其他方法/构造函数

```
public   PortScanner(int portStart, int portStop ,String ip) {
  for (int i = portStart; i <= portStop; i++) {
    try {
      Socket ServerSok = new Socket(ip, i);
      setString(i);
      //System.out.println("Port in use: " + i);
      ServerSok.close();
    } catch (Exception e) {
    }
    setStrinN(i);
    System.out.println("Port not in use: " + i);
  }
}

public static String setString(int i) {
  return "Port in use: " +i;
}

public static String setStrinN(int i){
  return "Port not in use: "+i;
} 
```

所以我想发送给`console.setText();`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T13:36:47.140

建议：

*   请务必在与 Swing GUI 相关的后台线程中进行端口扫描，例如 SwingWorker 提供的一个。
*   更新任何 Swing 组件时，请务必在 Swing 事件线程（EDT）上执行此操作。同样，SwingWorker 将有所帮助，因为它具有自动化此（发布/处理）的设施。
*   为您的 GUI 类提供一个公共方法，允许外部类更新其文本字段，例如`public void consoleSetText(String text)`
*   将 GUI 类的引用传递给助手类，以便助手类可以调用上述方法。它当然会使用 SwingWorker 方法调用 Swing 事件线程上的`process(...)`方法。

**编辑1**
这是我建议的一个例子：

```
class PortScannerGui {
   private JTextField startPortTf;
   private JTextField stopPortTf;
   private JTextField console;
   private JTextField stopServTf;
   private JTextField startServTf;

   // ... lots of code mising

   public void actionPerformed(ActionEvent arg0) {
      console.setText("Starting check\n" + "Start = " + stopServTf.getText()
            + "\nStop =" + stopServTf.getText() + "\nPort Start ="
            + startPortTf.getText() + "\nPort Stop =" + stopPortTf.getText());

      new SwingWorkerPortScannerWrapper(this, 
            Integer.parseInt(startPortTf.getText()), 
            Integer.parseInt(stopPortTf.getText()),
            startServTf.getText()).execute();
   }

   public void setConsoleText(String text) {
      console.setText(text);
   }
}

class SwingWorkerPortScannerWrapper extends SwingWorker<Void, Integer> {
   private PortScannerGui gui;
   private PortScanner portScanner;

   public SwingWorkerPortScannerWrapper(PortScannerGui gui, int portStart,
         int portStop, String ip) {
      this.gui = gui;
      portScanner = new PortScanner(portStart, portStop, ip);
   }

   @Override
   protected Void doInBackground() throws Exception {
      portScanner.addPropertyChangeListener(new PropertyChangeListener() {

         @Override
         public void propertyChange(PropertyChangeEvent evt) {
            if (PortScanner.PORT_IN_USE_NUMBER.equals(evt.getPropertyName())) {
               publish((Integer) evt.getNewValue());
            }
         }
      });

      portScanner.scan();
      return null;
   }

   @Override
   protected void process(List<Integer> chunks) {
      for (Integer chunk : chunks) {
         gui.setConsoleText("Port in use: " + chunk);
      }
   }
}

class PortScanner {
   public static final String PORT_IN_USE_NUMBER = "port in use number";
   public static final String STRIN_N = "strinN";
   private int portStart;
   private int portStop;
   private String ip;
   private int string;
   private PropertyChangeSupport propChangeSupport = new SwingPropertyChangeSupport(
         this);
   private int portInUseNumber;

   public PortScanner(int portStart, int portStop, String ip) {
      this.portStart = portStart;
      this.portStop = portStop;
      this.ip = ip;

   }

   public void addPropertyChangeListener(PropertyChangeListener listener) {
      propChangeSupport.addPropertyChangeListener(listener);
   }

   public void scan() {
      for (int i = portStart; i <= portStop; i++) {
         try {
            Socket ServerSok = new Socket(ip, i);

            setPortInUseNumber(i);
            // System.out.println("Port in use: " + i);

            ServerSok.close();
         } catch (UnknownHostException e) {
            e.printStackTrace();
         } catch (IOException e) {
            e.printStackTrace();
         }
         setStrinN(i);
         System.out.println("Port not in use: " + i);
      }
   }

   public void setStrinN(int i) {
      // TODO do something with this?
   }

   public void setPortInUseNumber(int i) {
      int oldValue = portInUseNumber;
      int newValue = i;
      portInUseNumber = i;
      propChangeSupport.firePropertyChange(PORT_IN_USE_NUMBER, oldValue,
            newValue);
   }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T13:38:11.970

您需要能够访问您的`JTextField`实例，有两种方法：

*   `PortScanner`将变量作为局部变量传递给类
*   对包含文本字段的框架（或文本字段本身）有一个静态引用，以便您可以从任何地方访问它

第一种方式更正确，因为它保持封装，第二种方式更容易和简单，但在不需要如此严重的情况下也会将字段暴露给外部，这在 OOP 环境中是一个糟糕的设计选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T13:36:06.720

当您调用`setString(i);`时，该函数会返回一个您丢弃的字符串（即不要存储在任何地方）。您要么需要存储字符串并稍后检索它，否则如果您想`console.setText()`使用返回的字符串进行调用，则需要传递`console`给`PortScanner`构造函数：

```
public PortScanner(int portStart, int portStop, String ip, JTextArea console) 
```

并将呼叫更改`setString(i);`为

```
console.setText(setString(i)); 
```

此外（由于`PortScanner`构造函数已更改），请调用

```
 PortScanner p= new PortScanner(Integer.parseInt(startPortTf.getText()),
   Integer.parseInt(stopPortTf.getText()),startServTf.getText()); 
```

在`actionPerformed()`

# android - 动态更新 ExpandableListView

> ID：10774334
> 
> 赞同：0
> 
> 时间：2012-05-27T13:30:40.730
> 
> 标签：android, expandablelistview

我正在使用 xml 文件执行动态 ExpandableListView，但是当我加载到列表中没有内容的布局时崩溃了。以下是我的代码：

PasswordListingActivity.java：

```
public class PasswordListingActivity extends ExpandableListActivity {
    Button b_addPwd;
    ExpandableListView elv_pwdList;

    List<Map<String, String>> ServiceList = new ArrayList<Map<String, String>>();
    List<List<Map<String, String>>> DetailList = new ArrayList<List<Map<String, String>>>();

    ExpandableListAdapter adapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.passwordlisting);        

        b_addPwd = (Button)findViewById(R.id.b_addpwd);
        elv_pwdList = (ExpandableListView)findViewById(R.id.password_list);

        b_addPwd.setOnClickListener(new Button.OnClickListener(){
            @Override
            public void onClick(View arg0) {
                Intent intent = new Intent();
                intent.setClass(PasswordListingActivity.this, AddPasswordActivity.class);
                startActivityForResult(intent, 0);
            }           
    });

    adapter = new SimpleExpandableListAdapter(
            this, 
            ServiceList, 
            android.R.layout.simple_expandable_list_item_1, 
            new String[] {"SERVICE"}, 
            null, 
            DetailList, 
            android.R.layout.simple_expandable_list_item_2, 
            new String[] {"TITLE", "CONTENT",}, 
            null
    );
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data){
    switch (resultCode){
        case RESULT_OK:
            Bundle bundleR = data.getExtras();
            Map<String, String> ServiceGroupMap = new HashMap<String, String>();
            ServiceGroupMap.put("SERVICE", bundleR.getString("service"));
            ServiceList.add(ServiceGroupMap);
            List<Map<String, String>> DetailGroup = new ArrayList<Map<String, String>>();
            Map<String, String> DetailGroupMap = new HashMap<String, String>();
            DetailGroupMap.put("TITLE", "User Name: ");
            DetailGroupMap.put("CONTENT", bundleR.getString("username"));
            DetailGroup.add(DetailGroupMap);
            DetailGroupMap.put("TITLE", "Password: ");
            DetailGroupMap.put("CONTENT", bundleR.getString("password"));
            DetailGroup.add(DetailGroupMap);
            DetailList.add(DetailGroup);
            break;
        default:
            break;
    }
} 
```

密码列表.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/white"
android:orientation="vertical" >
<TextView
    android:id="@+id/password_listing"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center_vertical|center_horizontal"
    android:text="@string/app_name"
    android:textColor="@color/black"
    android:textSize="20dip"
    android:textStyle="bold" />
<Button
    android:id="@+id/b_add_list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/add" />
<ExpandableListView 
    android:id="@+id/password_list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" />
</LinearLayout> 
```

错误代码：

```
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) 
```

代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:46:55.220

您的 xml 布局中按钮的 ID 与您传递给的 ID 不匹配`findViewById();`

```
<Button
    android:id="@+id/b_add_list"
    .... 
```

和

```
b_addPwd = (Button)findViewById(R.id.b_addpwd); 
```

“R.id.”之后的部分 应该匹配 "@+id/" 之后的部分 发生的事情是你得到 null 回来，`findViewById();`因为没有找到带有 id 的 View `R.id.b_addpwd`。然后，当您尝试调用`.setOnClickListener()`它时，可能会引发 NullPointer 异常。

# qt - 带有像素图的透明 QLabel

> ID：10774336
> 
> 赞同：2
> 
> 时间：2012-05-27T13:30:57.220
> 
> 标签：qt

我有一个 QLabel，我使用 setpixmap() 在上面放了一个图像。该图像具有 Alpha 通道。

QLabel 位于 QWidget 上，该 QWidget 具有由图像指定的边框图像（以便重新缩放图像以填充 QWidget）。

在 QLabel 的透明部分，结果不是 QWidget 上指定的图像，而是“无色”Widget 的灰色特征。

我的问题是如何使 QLabel 的透明部分显示 QWidget 的边框图像？

我尝试取消自动填充背景，将 QLabel 的背景颜色更改为白色透明，但没有任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T05:44:53.557

您需要适当地设置小部件属性和窗口标志：

使用[`QWidget::setAttribute()`](http://qt-project.org/doc/qt-4.8/qwidget.html#setAttribute)和[Qt::WidgetAttribute](http://qt-project.org/doc/qt-4.8/qt.html#WidgetAttribute-enum) ...

`Qt::WA_TranslucentBackground`需要设置为真。

随着学习[窗口标志示例](http://qt-project.org/doc/qt-4.8/widgets-windowflags.html)应该有很大帮助。

如果您只是在寻找一个可以绘制无框图像的小部件......

这是一个完美的例子：

[QSplashScreen 更换](http://qt-project.org/wiki/QSplashScreen-Replacement-for-Semitransparent-Images)

# jquery - 检查是否通过单击 div 触发了模糊

> ID：10774339
> 
> 赞同：4
> 
> 时间：2012-05-27T13:31:22.533
> 
> 标签：jquery, jquery-autocomplete

我有一个输入，并且在模糊时我想保存该值。问题是我开启了自动完成功能，当用户点击自动完成列表中的建议时，会触发模糊。

例如：用户在输入中输入“iP”，然后从自动完成列表中单击“iPhone”。在这个种姓中，“iP”和“iPhone”值都被存储（“iP”存储由模糊触发，“iPhone”存储由自动完成点击触发）。

我正在考虑检查是否通过单击自动完成列表触发了模糊操作。

```
$('input').blur(function(e){
  if(e.IsClickOnAutocomplete)
     return;
  else save_value;
}); 
```

那么，如何检查模糊是通过何种方式触发的呢？

**编辑** 在这里，一个 jsFiddle 显示了与我的问题类似的东西[http://jsfiddle.net/mkp8m/1](http://jsfiddle.net/mkp8m/1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:54:24.890

好的，在明确`autocomplete`您的意思之后，这是解决方案。

使用[`change`](http://jqueryui.com/demos/autocomplete/#event-change)自动完成插件事件：

```
change: function(event, ui) {
    // save(this.value);
} 
```

**演示：http:** [//jsfiddle.net/mkp8m/2/](http://jsfiddle.net/mkp8m/2/)

# php - 从数组中提取较低、中间和较高的距离

> ID：10774348
> 
> 赞同：1
> 
> 时间：2012-05-27T13:32:39.747
> 
> 标签：php, arrays

目标是提取最小、中间和最远距离。成功达到了最低距离。然而，中间和最高距离更复杂。

数组内容如下所示： 数组名：$array

```
Array
(
    [0] => Array
        (
            [city] => Array
                (
                    [0] => Reduit
                    [1] => Curepipe
                )

            [distance] => 200
        )

    [1] => Array
        (
            [city] => Array
                (
                    [0] => Array
                        (
                            [0] => Reduit
                            [1] => Ebe
                        )

                    [1] => Bees Village
                    [2] => Phoen Trunk Rd
                    [3] => Riv,Phoenix
                    [4] => St l Rd
                    [5] => Geoes Guibert St
                    [6] => Curepipe
                )

            [distance] => 151
        )

    [2] => Array
        (
            [city] => Array
                (
                    [0] => Array
                        (
                            [0] => Reduit
                            [1] => Riv,Phoenix
                        )

                    [1] => St l Rd
                    [2] => Geoes Guibert St
                    [3] => Curepipe
                )

            [distance] =>50
        )

    [3] => Array
        (
            [city] => Array
                (
                    [0] => Array
                        (
                            [0] => Reduit
                            [1] => Ebene
                        )

                    [1] => Belles Village
                    [2] => Phoenix Trunk Rd
                    [3] => Riverside,Phoenix
                    [4] => St Paul Rd
                    [5] => Georges Guibert St
                    [6] => Curepipe
                )

            [distance] => 101
        )

) 
```

谁能告诉我哪里错了。我的工作是

```
$current = $array[0]['distance'];

for($middleDistance=1;$middleDistance<$total;$middleDistance++){

    $next = $array[($middleDistance)]['distance'];

    if ($next<$current){

            $current = $next;

            print_r($current);

            if($current>50&&$current<100){

            }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:52:38.310

为什么不按值对数组进行排序并从中获取最小值/中值/最大值？如果您真的想要最接近中间的元素，则必须在偶数距离的情况下比较 2 个最中间的元素。另外，我在这里没有使用它们，但请注意 PHP 的 min 和 max 函数： [http :](http://php.net/manual/en/function.max.php) [//php.net/manual/en/function.min.php http://php.net/manual/en](http://php.net/manual/en/function.min.php)
[/function.max.php](http://php.net/manual/en/function.max.php)

```
$arr = array(200, 151, 50, 101);                                                                                                                    

sort($arr, SORT_NUMERIC);                                                                                                                           

if (count($arr)) {                                                                                                                                  
  $min = current($arr);                                                                                                                             
  $max = end($arr);                                                                                                                                 

  $mid = $arr[round(count($arr) / 2) - 1];                                                                                                                
} 
```

# tomcat - 如何在grails中跨子域获得相同的会话

> ID：10774351
> 
> 赞同：5
> 
> 时间：2012-05-27T13:32:48.533
> 
> 标签：tomcat, grails, subdomain, session-cookies

我有一个应用程序处理多个子域，例如

*   sub1.domain.com
*   sub2.domain.com
*   www.domain.com
*   域名.com

用户在使用应用程序时可以在这些子域之间切换。发生这种情况时，会话不会在这些子域之间共享。我使用 tomcat 作为开发和生产服务器。

我试图让共享会话首先在开发中工作。在阅读时，发现在tomcat中实现这一点的方法是：

```
<Context sessionCookiePath="/" sessionCookieDomain=".domain.com"> 
```

有没有办法可以在开发环境的tomcat中设置它？

我在 _Events.groovy 中尝试了以下代码，但没有成功：

```
eventConfigureTomcat = {tomcat ->
    def context = tomcat.addContext("","/")
    context.setSessionCookieDomain(".domain.com")
    context.setSessionCookiePath("/")
} 
```

我收到错误 java.lang.IllegalArgumentException: addChild: Child name '' is not unique

我假设我需要的是以下代码的等效项（由于没有 getContext 方法，因此无法工作）：

```
eventConfigureTomcat = {tomcat ->
    def context = tomcat.getContext("") //This function does not exist
    context.setSessionCookieDomain(".domain.com")
    context.setSessionCookiePath("/")
} 
```

关于如何在开发和生产中实现此功能的任何建议？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T16:57:42.493

要访问默认的 Tomcat 上下文，您可能必须在插件的 TomcatServer.groovy 文件中修补 TomcatServer 的 create 方法。

```
TomcatServer(String basedir, String webXml, String contextPath, ClassLoader classLoader) {
    tomcat = new Tomcat()
this.buildSettings = BuildSettingsHolder.getSettings()  

    if(contextPath=='/') contextPath = ''

    def tomcatDir = new File("${buildSettings.projectWorkDir}/tomcat").absolutePath
    def ant = new AntBuilder()      
    ant.delete(dir:tomcatDir, failonerror:false)        

    tomcat.basedir = tomcatDir

    context = tomcat.addWebapp(contextPath, basedir) 
    // ** do additional context stuff here ** 
    tomcat.enableNaming()       

    // we handle reloading manually
    context.reloadable = false
    context.setAltDDName("${buildSettings.projectWorkDir}/resources/web.xml")

    def aliases = []
    def pluginManager = PluginManagerHolder.getPluginManager()
    def pluginSettings = GPU.getPluginBuildSettings()
    if(pluginManager!=null) {
        for(plugin in pluginManager.userPlugins) {
              def dir = pluginSettings.getPluginDirForName(GrailsNameUtils.getScriptName(plugin.name))
              def webappDir = dir ? new File("${dir.file.absolutePath}/web-app") : null
              if (webappDir?.exists())
                    aliases << "/plugins/${plugin.fileSystemName}=${webappDir.absolutePath}"
    }
}

    if(aliases) {
        context.setAliases(aliases.join(','))
    }
    TomcatLoader loader = new TomcatLoader(classLoader)

    loader.container = context
    context.loader = loader

    initialize()
} 
```

# ruby - 使用 ruby SDK 将 S3 存储桶设置为网站

> ID：10774353
> 
> 赞同：7
> 
> 时间：2012-05-27T13:33:08.037
> 
> 标签：ruby, api, amazon-s3

我想将 Amazon S3 存储桶设置为网站，如下所述：

[http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTBucketPUTwebsite.html?r=5271](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTBucketPUTwebsite.html?r=5271)

但使用 ruby​​ API，最好是用于 ruby​​ 的 aws-sdk。是否有可能做到这一点/一个已经支持它的库？在 aws-sdk 和 right-aws 中找不到任何东西，但也许我只是瞎了眼？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T19:27:22.743

可以使用 ruby​​ API 将您的存储桶配置为网站。我确实找到了解决方案，但这使用的是`aws-s3`gem，而不是`aws-sdk`gem。[我在ponyhost gem](https://github.com/jwagener/ponyHost/blob/4e04cf624ac0adc6ce26d95f0a848cc296a949a4/lib/ponyhost.rb#L45)中找到了这个解决方案：

```
body = '<?xml version="1.0" encoding="UTF-8"?>
<WebsiteConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
  <IndexDocument><Suffix>index.html</Suffix></IndexDocument>
  <ErrorDocument><Key>404.html</Key></ErrorDocument>
</WebsiteConfiguration>'

res = AWS::S3::Base.request(:put, "/#{bucketname}?website", {}, body) 
```

**编辑**您也可以使用`fog`gem 来完成此操作。

```
storage = Fog::Storage.new({
  :provider   => 'AWS',
  :aws_access_key_id => 'YOUR_KEY',
  :aws_secret_access_key => 'YOUR_SECRET',
  :region => 'eu-west-1'
})

if storage.kind_of?(Fog::Storage::AWS::Real)
  storage.put_bucket_website("YOUR_BUCKET", "index.html", :key => "404.html")
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-06T10:21:35.273

AWS SDK for Ruby 版本一具有`#configure_website`存储桶对象的方法。所以这样的事情会起作用：

```
s3 = AWS::S3.new
b = s3.buckets.create(name, acl: :public_read)
b.configure_website do |cfg|
  cfg.options[:index_document] = { suffix: 'index.html' }
end 
```

（如果您不需要设置非默认选项，可以省略 configure_website 块）

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-01T06:48:03.343

@Aljoscha AWS S3 只是一个存储解决方案，用于存储您的所有文件。它不提供任何类型的运行时解决方案。您需要有一个 Ec2 实例来托管基于 ruby​​ 的应用程序或使用 ruby​​ API。您可以只在 S3 上托管一个静态网站，但不能运行任何类型的应用程序。

# ruby-on-rails - 关于 Ruby 类的好指南

> ID：10774355
> 
> 赞同：2
> 
> 时间：2012-05-27T13:33:12.403
> 
> 标签：ruby-on-rails, ruby

我是 php 开发人员，我正在尝试将 php 更改为 ruby​​/rails。

我读过 Pargmatic 的“Rails for PHP 开发人员”，但它非常简单。

现在我需要学习所有关于 ruby​​ 类的知识（命名空间、抽象、扩展、工厂/signleton 模式、请求父类方法等），但是我看到的所有指南和手册都很简单，它们只适合初学者作为介绍。

阅读 Ruby 参考书并不是一个好主意，因为它很难理解（我的 ruby​​ 技能还不是很好），所以我需要一些“专业开发人员”的指南和很多例子。很好的例子是“php|architect 的 Zend PHP 5 认证学习指南” - [http://www.amazon.com/architects-Zend-Certification-Study-Guide/dp/0973862149](https://rads.stackoverflow.com/amzn/click/com/0973862149)

有什么书/指南/课程可以解决我的问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:35:16.093

这是大师（又名 Ruby 创作者）本人的书：http: [//www.amazon.com/Ruby-Programming-Language-David-Flanagan/dp/0596516177](https://rads.stackoverflow.com/amzn/click/com/0596516177)

你需要这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:55:54.037

“元编程 Ruby”非常值得添加到您的书架上。 [http://www.amazon.co.uk/Metaprogramming-Ruby-Program-Like-Facets/dp/1934356476/](http://www.amazon.co.uk/Metaprogramming-Ruby-Program-Like-Facets/dp/1934356476/)

# c - 如何导致 sqlite3_initialize 失败

> ID：10774356
> 
> 赞同：2
> 
> 时间：2012-05-27T13:33:21.367
> 
> 标签：c, unit-testing, sqlite

我有以下使用 sqlite3 的 C 代码：

```
if(SQLITE_OK == sqlite3_initialize()) {
    self->db_open_result = sqlite3_open(self->db_uri, &(self->db));
} else {
    self->db_open_result = SQLITE_ERROR;
} 
```

显然，我非常相信代码是正确的并且会按预期运行。但是，我正在使用 gcov/lcov 测量我的单元测试的代码覆盖率，我很好奇在这种情况下如何将我的覆盖率提高到 100%。正常情况下`sqlite3_initialize()`是永远不会失败的，所以该`else`子句永远不会执行。

有没有办法让这个失败而不是完全破坏？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-28T06:55:12.757

您希望您的单元测试来测试您的代码。但是您还想知道您的所有测试代码都已正确执行。一种方法是使用“模拟”，即用假或“模拟”库替换实际库（例如 SQLite），然后针对这些假库运行程序。

这种库替换是在编译时完成还是在运行时完成实际上是偶然的，但在 C 中，在编译时完成更容易。您可以手动进行此模拟，也可以使用[Cmock](http://throwtheswitch.org/white-papers/cmock-intro.html)等工具。

然后，在伪造的库中，您会引发各种错误和失败。值得注意的是，伪造的库甚至*不需要做*任何事情，甚至不需要跟踪很多或任何状态，您通常可以通过返回“OK”或“FAIL”来走得很远。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T04:32:34.297

> 有没有办法让这个失败而不是完全破坏？

出于可移植性的原因，您应该验证功能是否成功。如果你没有安装 SQLite 库会发生什么？如果发生这种情况，您将无法初始化库。

“如果由于某种原因，sqlite3_initialize() 无法初始化库（也许它无法分配所需的资源，例如互斥锁），它会返回错误代码......”

因此，如果您想要可移植性，请检查错误。

# emacs - 如何在 emacs 中自动填充括号中的行（降价模式）？

> ID：10774364
> 
> 赞同：4
> 
> 时间：2012-05-27T13:34:16.147
> 
> 标签：emacs, markdown, fill, pandoc

我对 Emacs 比较陌生，但一直在试验它是否值得切换。我用 Markdown 编写并使用 pandoc 转换为我需要的任何内容。万一这很重要，我在 Ubuntu 12.04 上运行 Emacs 23.3.1。

我是人文学科的研究生，所以我的文字脚注很重。pandoc 中的脚注在方括号内格式化。我遇到的问题是自动填充模式似乎忽略了括号内的文本，所以我的脚注最终在页面上蜿蜒而行——我能找到的唯一解决方法是自己手动断行，每次我编辑段落。这显然不太理想。（我也可以放弃内联脚注，将它们全部分开引用，但我不希望这样做，而且似乎没有必要这样做。）

所以我的问题是，有没有办法让自动填充模式也对括号内的文本进行操作？有没有默认情况下没有的原因？

非常感谢，

——布赖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T18:10:26.123

事实证明，从 v. 1.7 开始，markdown 模式故意避免在方括号中换行，以避免断开链接——这是 Markdown 中括号最常见的用法。请参阅[http://jblev​​ins.org/projects/markdown-mode/rev-1-7](http://jblevins.org/projects/markdown-mode/rev-1-7)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T14:02:07.693

布莱恩，

将以下内容添加到您的初始化文件†以允许自动填充降价模式以在方括号内换行：

```
(require 'markdown-mode)
(defun markdown-nobreak-p () nil) 
```

我们所做的是重新定义函数“markdown-nobreak-p”（最初在这里定义：http://jblev​​ins.org/git/markdown-mode.git/commit/?id=66566a55 [）](http://jblevins.org/git/markdown-mode.git/commit/?id=66566a55)总是返回“nil”，这意味着“是的，此时您可以休息”。对于方括号内的点，此函数的原始版本将返回非零值。

† [http://www.gnu.org/software/emacs/manual/html_node/emacs/Find-Init.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Find-Init.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T15:53:32.047

Auto-fill by itself does not prevent filling inside brackets. It can be told to do so by the major-mode, tho, so I guess the problem depends on your major mode. If you're using mardown-mode, then please report this problem to its maintainer. In any case, you may want to try and use `M-q` to explicitly fill the paragraph, since it does not always follow the same conventions as auto-filling: it's more explicit than auto-fill, but still more automatic than placing the newlines by hand.

# map - Prolog 关联列表

> ID：10774369
> 
> 赞同：0
> 
> 时间：2012-05-27T13:35:23.163
> 
> 标签：map, prolog, sicstus-prolog

我正在 Prolog 中编写一个简单的程序安全检查器，我需要一个数据结构来保存变量估值。由于我想检测我什么时候再次访问同一个状态，所以这个结构必须支持一些合理的比较语义，所以我可以将访问过的状态存储在集合中。

`library(avl)`具有方便的 getter/setter 接口。问题是，持有相同映射的 AVL 可以采取多种形式。因此，如果它们的 AVL 表示不同，则两个相同的状态将被认为是不同的。

在有序列表中保存映射的结构将没有这个问题。但是，我在 Sicstus 文档中找不到类似的东西。是否有任何标准结构可以满足我的需要，或者我必须自己实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:47:11.560

您已经[订购了集合](http://www.complang.tuwien.ac.at/sicstus/sicstus_20.html#SEC178)，但在 AVL 中，您始终可以将 AVL 转换为键值对的[有序列表，然后进行比较。](http://www.sics.se/sicstus/docs/4.0.2/html/sicstus/lib_002davl.html)

# javascript - 有没有办法等到 DirectionsService 返回结果？

> ID：10774370
> 
> 赞同：0
> 
> 时间：2012-05-27T13:35:28.753
> 
> 标签：javascript, google-maps-api-3, google-directions-api

我对 Google DirectionsService 有疑问。我知道它是异步的，这就是我遇到麻烦的原因。我想等到 DirectionsService 返回结果，而不是在没有答案的情况下执行代码。这是一个示例：

```
function snap_to_road (lat) {
    var position;

    var request = {
        origin: lat,
        destination: lat,
        travelMode: google.maps.DirectionsTravelMode.DRIVING
    };

    directionsService.route(request, function(response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            return response.routes[0].legs[0].start_location;
        }
    });
}

alert(snap_to_road(current.latLng)); 
```

总是显示： “`alert`未定义”。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T00:27:18.597

我不认为这是可能的。您可以在 snap_to_road 中使用回调参数：

```
function snap_to_road (lat, callback) {
    var position;

    var request = {
        origin: lat,
        destination: lat,
        travelMode: google.maps.DirectionsTravelMode.DRIVING
    };

    directionsService.route(request, function(response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            callback(response.routes[0].legs[0].start_location);
        }
    });
}

snap_to_road(current.latLng, function(result) {
    alert(result);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-22T21:57:38.103

您可以让 snap_to_road() 返回一个 Promise，然后在异步函数中使用 await。await 运算符用于等待 Promise。它只能在常规 JavaScript 代码中的异步函数内部使用。像这样：

```
 function snap_to_road (lat) {
var position;

var request = {
    origin: lat,
    destination: lat,
    travelMode: google.maps.DirectionsTravelMode.DRIVING
};
return new Promise((resolve, reject) => {
    directionsService.route(request, function(response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            resolve(response.routes[0].legs[0].start_location);
        }else{
            reject(0);
        }
    });
});

}

async function alertPromise(){
    await snap_to_road(current.latLng).then((resolve) => {
        alert(resolve)
    })
} 
```

您可以在 reject() 中放入一些消息并在之前进行处理。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-19T17:13:15.083

谷歌路线返回结果后调用您的警报方法。喜欢：在按钮单击事件后调用 snap_to_road。

```
function snap_to_road (lat) {
  var position;

  var request = {
    origin: lat,
    destination: lat,
    travelMode: google.maps.DirectionsTravelMode.DRIVING
  };

  directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      ShowAlert(response.routes[0].legs[0].start_location);
    }
  });
}

function ShowAlert(result){
  alert(result);
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-27T14:10:39.780

这是我上面提到的一个例子：

```
var path = "/path/to/some/resource";

$.ajax({
        url:    path,
        type: "get",
        data: serializedData,  //<-- depends on what data you are using
        async: false, //will wait until resource has loaded or failed 

         //will be called on success
        success: function(response, textStatus, jqXHR){
            // log a message to the console
            console.log("Successfully loaded resource!");
        },
         //will be called on error
        error: function(jqXHR, textStatus, errorThrown){
            // log the error to the console
            console.log(
                "The following error occured: "+
                textStatus, errorThrown
            );
        },
        // callback handler that will be called on completion
        // which means, either on success or error
        complete: function(){
            console.log("Completed: with error or success");
        }
    }); 
```

# java - Spring 3.0 中的转换器

> ID：10774371
> 
> 赞同：3
> 
> 时间：2012-05-27T13:36:00.803
> 
> 标签：java, spring, jsp, converter

好的，所以我已经构建了一个转换器并将其添加到调度程序 xml。但它不会起作用。我不明白控制器应该如何知道何时应该使用转换器。在我的 jsp 页面中，我检查了乘法复选框。每个复选框都包含一个开发人员的 ID。Spring 应该从这些 id 中创建一组开发人员。我觉得我在控制器中遗漏了一些东西。我以前用编辑器来做，然后你会覆盖 initbinder 方法。我不知道如何使用转换器来做到这一点。

提前谢谢你，大卫

所以首先我做了一个实现接口的类：

```
public class DeveloperConverter implements Converter<String, Developer> {

    private GameOrganizer gameOrganizer;

    public void setGameOrganizer(GameOrganizer gameOrganizer) {
        this.gameOrganizer = gameOrganizer;
    }

    public Developer convert(String s) {
        long id2 = Long.parseLong(s);
        Developer type = gameOrganizer.getDeveloper(id2);
        return type;
    }
} 
```

然后我将 bean 添加到调度程序 xml：

```
<bean id="conversionService" class="org.springframework.context.support.ConversionServiceFactoryBean">
    <property name="converters">
        <list>
            <bean class="converters.GameConverter" />
            <bean class="converters.DeveloperConverter" />
        </list>
    </property>
</bean> 
```

和控制器：

```
@Controller
@RequestMapping("/AddGame")
public class GameFormController {

    @Autowired
    private GameOrganizer gameOrganizer;
    private DeveloperConverter developerEditor;
    private GameValidator gameValidator;
    private ConversionService service;

    public GameFormController() {
        setGameValidator(new GameValidator());
    }

    public void setGameOrganizer(GameOrganizer gameOrganizer) {
        this.gameOrganizer = gameOrganizer;
    }

    public void setDeveloperEditor(DeveloperConverter developerEditor) {
        this.developerEditor = developerEditor;
        developerEditor.setGameOrganizer(gameOrganizer);
    }

    public void setGameValidator(GameValidator gameValidator) {
        this.gameValidator = gameValidator;
    }

    @RequestMapping(method = RequestMethod.GET)
        private String showForm(ModelMap model) {
        return "AddGame";
    }

     @ModelAttribute("editGame")
     private Game GameformBackingObject(HttpServletRequest request) throws Exception {
        Game game = null;
        long id = ServletRequestUtils.getLongParameter(request, "id");
        if (id <= 0) {
            game = new Game();
        } else {
            game = new Game();
            game.setId(gameOrganizer.getGame(id).getId());
            game.setDevelopers(gameOrganizer.getGame(id).getDevelopers());
            game.setGameNaam(gameOrganizer.getGame(id).getGameNaam());
            game.setImages(gameOrganizer.getGame(id).getImages());
            game.setPrijs(gameOrganizer.getGame(id).getPrijs());
        }

        return game;
    }

    @RequestMapping(method = RequestMethod.POST)
    protected String doSubmitAction(@ModelAttribute("editGame") Game game, BindingResult result) throws Exception {
        gameValidator.validate(game, result);
        if (result.hasErrors()) {
            return "AddGame";
        } else {
            if (game.getId() <= 0) {
                gameOrganizer.addGame(game);
            } else {
                gameOrganizer.update(game);
            }
            return "forward:/Gamedatabase.htm";
        }

    }

    @ModelAttribute("allDevelopers")
    private Set<Developer> getDevelopers() throws Exception {
        Set<Developer> developers = gameOrganizer.getAllDevelopers();
        return developers;
    }

    @ModelAttribute("currentId")
     private long getCurrentId(HttpServletRequest request) throws ServletRequestBindingException {
        long id = ServletRequestUtils.getLongParameter(request, "id");
        return id;
    }

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T02:11:25.340

我想您还没有在 XML 配置中为 Spring MVC[配置转换服务：](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/validation.html#format-configuring-FormattingConversionService)

```
<mvc:annotation-driven conversion-service="conversionService" /> 
```

# javascript - Javascript：列出文件和文件夹结构

> ID：10774377
> 
> 赞同：4
> 
> 时间：2012-05-27T13:37:02.433
> 
> 标签：javascript, html, web-applications

正如我所读到的，JavaScript 在客户端 PC 上修改文件并不容易。我正在开发基于 Web 的文件管理器，需要了解以下内容：

*   JavaScript 可以列出客户端 PC 上的文件和文件夹结构吗？
*   JavaScript 可以列出服务器上的文件和文件夹结构吗？

如果您的回答是否定的，Java Scipt 不能列出客户端或服务器的 C:\ 驱动器上的文件和文件夹，那么 CGI 脚本会是唯一的解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-27T13:55:47.603

### 浏览器 JS 读取客户端 PC 的文件：取决于

出于安全原因，未经用户同意，您无法访问用户 PC 上的文件。

这就是为什么在文件输入框和拖放区域周围创建[FileReader API的原因，因为整个想法是](https://developer.mozilla.org/en/DOM/FileReader)*“在用户同意的情况下访问文件”*。如果用户没有故意放置文件以供访问，您根本无法访问它。`<input type="file">`

 *### 服务器端 JS 读取自己服务器的文件：是

至于服务器，如果您的意思是使用 server-JS（[NodeJS](http://nodejs.org/)或[Rhino](http://www.mozilla.org/rhino/)）访问服务器，是的，您可以（否则它将如何为网页提供服务？）。

### 浏览器 JS 读取自己服务器的文件：取决于

如果您有一个 API 可以从中读取文件，那么使用 JS*从浏览器*访问服务器是可行的。

### 浏览器 JS 读取其他服务器的文件：是的，有一个问题

要在没有某些 API 的情况下访问其他服务器的文件，您可以求助于创建运行*服务器端的网络爬虫或网络蜘蛛（因为浏览器由于*[相同的源策略](http://en.wikipedia.org/wiki/Same_origin_policy)而无法跨域）并将 API 暴露给您的浏览器.

然而：

*   您无法抓取所有文件，因为某些文件可能会受到外部访问的限制。
*   结构的公开外观可能与内部结构不同，特别是如果网站使用分段 url 方案
*   使用查询字符串生成页面的站点由于可能进行的排列数量而无法轻松抓取，因此某些页面可能无法访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T13:42:14.630

CGI 也不是一个解决方案，因为它只能访问您服务器的文件系统，而不是访问您站点的客户端的文件系统。从 javascript 访问客户端文件系统的唯一方法似乎是[File API](http://dev.w3.org/2009/dap/file-system/pub/FileSystem/)，这显然[没有被许多浏览器实现](http://caniuse.com/#feat=filesystem)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T14:34:00.893

这是一个杂物，但您可以求助于 java 小程序或可怕的 active-x 控件。*

# gwt - 初学者：如何对 GWT 应用程序进行 JUnit 测试？

> ID：10774378
> 
> 赞同：2
> 
> 时间：2012-05-27T13:37:04.273
> 
> 标签：gwt, testing, junit

我想对我的应用程序进行 JUnit 测试。我以前从未做过 JUnit 测试，所以我有几个（也许是微不足道的）问题：

1.  我应该在哪里设置测试类？我遇到了这个线程： [我应该把我的 JUnit 测试放在哪里？](https://stackoverflow.com/questions/811827/where-should-i-put-my-junit-tests)，而回答问题的人指的是maven项目，但我不使用maven。他解释说（在我上面链接的线程中）他将测试类放在不同的位置但在同一个包中。如何在 GWT 项目中完成？

2.  一旦这些测试准备就绪，我应该如何执行它们（在代码中执行的位置）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:52:56.000

您应该首先查看以下内容：[使用 JUnit 对 GWT 应用程序进行单元测试](https://developers.google.com/web-toolkit/doc/latest/tutorial/JUnit)。

1.  另一个线程很好，反映了典型的 JUnit 实践，**并不**特定于 maven：在名为`test`. 例如，如果您的 GWT`EntryPoint`模块位于此目录结构中：

    ```
    project/src/com/myproject/mypackage/MyEntryPoint.java 
    ```

    然后您的测试代码将在这里：

    ```
    project/test/com/myproject/mypackage/MyEntryPointTests.java 
    ```

    如果您已经创建了 GWT 项目，`webAppCreator`那么您应该已经有一个`test`包含所描述的包结构的目录。

2.  如果您使用`webAppCreator`创建项目，则可以使用内置的单元测试来创建项目，如下所示：

    ```
    webAppCreator -junit -out MyProject com.myproject.mypackage.MyEntryPoint 
    ```

    这将创建一个`test`目标。如果您使用的是 Eclipse，那么您应该有一个 Run 选择：`Run As -> GWT Unit Test`用于运行您的测试。

    如果您使用的是 ant 而不是 Eclipse，那么这应该运行您的单元测试：

    ```
    ant test 
    ```

    If you didn't use `-junit` to create the project, the test targets are typically still there, just commented out. Search `junit` in `build.xml` to find the targets, and un-comment them.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T06:22:01.047

You need to take a look at this article, [MVP1](https://developers.google.com/web-toolkit/articles/mvp-architecture) and [MVP2](https://developers.google.com/web-toolkit/articles/mvp-architecture-2), these are a pattern designs used to Unit Test your application in pure java environment, because using GWT Test Case runs very slow the patterns also has many advantages like separate the logic from the view so you can change the view for Android, for example.

# php - 可嵌入的 html5 音频播放器

> ID：10774379
> 
> 赞同：1
> 
> 时间：2012-05-27T13:37:09.190
> 
> 标签：php, html, embed

我正在寻找一种在网站上安装可嵌入 html5 播放器的方法。这怎么可能？我已经看到另一个网站实现了这一点，其技术是仅使用 html5 播放器创建一个附加页面，然后对其进行 iframe 处理。例子。页面网址；

```
http://www.hotnewhiphop.com/freddie-gibbs-pull-up-song.841426.html 
```

带有 html5 播放器专用页面的 iframe。

```
<iframe src="http://www.hotnewhiphop.com/freddie-gibbs-pull-up-embedsong.841426.html" style="width:442px;height:53px;border-width:0;" width="442" height="53"></iframe> 
```

这是如何在 php 中完成的（也许是一个简短的解释）？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:40:40.247

看看[JWPLayer](http://www.longtailvideo.com/players/jw-flv-player/)。它在某种程度上是一个事实上的行业标准，虽然它主要关注视频，但它也支持音频。也涵盖了 HTML5。

# jquery - 检查多个 cookie jQuery 语法

> ID：10774380
> 
> 赞同：0
> 
> 时间：2012-05-27T13:37:10.860
> 
> 标签：jquery, cookies, syntax

我想检查是否设置了两个 cookie 之一：

```
if($.cookie("c1") != 'true' || $.cookie("c2") != 'true') { 
```

（然后根据 cookie 做一些动作，或者设置 cookie）

这是检查是否设置了第一个或第二个的正确语法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:43:20.543

正确的语法是

```
if($.cookie("c1") !== null || $.cookie("c2") !== null) {

    // one of the cookies, or both, are set

}
else {
    // none of the cookies are set

} 
```

* * *

**根据您的评论**，您所追求的可能是：

```
if($.cookie("c1") !== null && $.cookie("c2") !== null) {

    // both cookies exist, let's check if they have the values we need
    if($.cookie("c1") === "true" && $.cookie("c2") === "true") {
        // they have 'true' as their content

    }
    else {
        // they might exist, but both do not hold the value 'true'

    }
}
else {
    // none, or at least one of the two cookies are not set

} 
```

# objective-c - UIToolbar 隐藏后不显示

> ID：10774384
> 
> 赞同：-1
> 
> 时间：2012-05-27T13:38:12.850
> 
> 标签：objective-c, uitoolbar

我有一个 UIButton，它使 UIToolbar 显示和隐藏。

```
- (IBAction)showHideToolbar:(id)sender{
    if (toolBar.hidden == NO) {
        [UIView animateWithDuration:0.25 delay:0.0 options:UIViewAnimationCurveLinear | UIViewAnimationOptionAllowUserInteraction animations:^(void){toolBar.alpha =0.0f;}completion:^(BOOL finished){
            toolBar.hidden = YES;}];
        NSLog(@"hides");
    }
    else
        if (toolBar.hidden == YES) {
            [UIView animateWithDuration:0.25 delay:0.0 options:UIViewAnimationCurveEaseIn | UIViewAnimationOptionAllowUserInteraction animations:^(void){toolBar.alpha =0.0f;}completion:^(BOOL finished){
                toolBar.hidden = NO;
            }];
            NSLog(@"show");
        }
} 
```

问题是当我尝试隐藏工具栏时，它工作正常。但是当我再次尝试显示它时，它不会出现。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:50:56.920

当您为工具栏的显示设置动画时，您必须`1.0f`在`animations`块中设置 alpha。

以下是正确的代码；我已经用评论标记了我更改的行。

```
- (IBAction)showHideToolbar:(id)sender {
    if (toolBar.hidden == NO) {
        [UIView animateWithDuration:0.25f 
                              delay:0.0f 
                            options:UIViewAnimationCurveLinear | UIViewAnimationOptionAllowUserInteraction 
                         animations:^(void){ toolBar.alpha = 0.0f; }
                         completion:^(BOOL finished){ toolBar.hidden = YES; }];
        NSLog(@"hides");
}
else
    if (toolBar.hidden == YES) {
        [UIView animateWithDuration:0.25f 
                              delay:0.0f
                            options:UIViewAnimationCurveEaseIn | UIViewAnimationOptionAllowUserInteraction 
                         animations:^(void){ toolBar.alpha = 1.0f; } // Change from 0.0f to 1.0f
                         completion:^(BOOL finished){ toolBar.hidden = NO; }];
        NSLog(@"show");
    }
} 
```

# android - 从 PackageInfo 中查找 APK 路径

> ID：10774386
> 
> 赞同：0
> 
> 时间：2012-05-27T13:38:44.047
> 
> 标签：android, path, apk, archive

我有一个列出所有已安装软件包的 Android 应用程序。我通过从 PackageManager 接收每个应用程序的 PackageInfo 来做到这一点。唯一，我没有设法找出的是如何获取已安装 apk 的路径。用户安装的应用程序位于 /data/app 中。我可以在这个文件夹中搜索特定的包名称。但是没有更好的解决方案吗？

# ios - 如何缩放视图并将自定义边框保持在原始大小\缩放？

> ID：10774387
> 
> 赞同：1
> 
> 时间：2012-05-27T13:38:50.733
> 
> 标签：ios, uiview, border, scale

我正在构建一个 ios 应用程序。在我的应用程序中，我有一个视图，其中包含一个 ImageView，我通过在图像视图周围添加子视图在图像视图周围创建了一个边框。每个子视图都有自己独特的值 (5,10,15,10)

我让我的用户能够移动、旋转和缩放超级视图。目前，每个比例都会导致我的边界视图发生变化。我希望内部图像周围的边框保持相同的原始未缩放大小。

正如您在屏幕截图中看到的，我有两个 UIView。它们都有相同的阴影边框（见代码）第一个是缩放 X 2。结果不仅是缩放视图，而且是缩放阴影。我的问题是，我怎样才能只缩放视图，而不是它的阴影。

```
 view.layer.MasksToBounds = false;
    view.layer.ShadowColor = [[UIColor alloc] initWithRed:0 green:0 blue:0 alpha:0.5].CGColor;
    view.layer.ShadowOpacity = 0.5f;
    view.layer.shadowRadius = 1.0f;
    view.layer.ShadowOffset = CGSizeMake(0, 2.5f);
    UIBezierPath * depthShadowPath = [UIBezierPath bezierPath ];
    [depthShadowPath moveToPoint:CGPointMake( -border , -border ) ];
    [depthShadowPath addLineToPoint:CGPointMake( view.frame.size.width + border , -border ) ];
    [depthShadowPath addLineToPoint:CGPointMake( view.frame.size.width + border , view.frame.size.height + border) ];
    [depthShadowPath addLineToPoint:CGPointMake( -border , view.frame.size.height + border ) ];
    [depthShadowPath addLineToPoint:CGPointMake( -border , -border) ];
    [view.layer setShadowPath:[depthShadowPath CGPath ] ]; 
```

![在此处输入图像描述](../Images/aef17610a2e4ff6644df3c22ae8d70fe.png)

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T21:42:49.837

在我看来，视图可能不会被重绘，而只是在内存中缩放。尝试设置，或通过发送消息`view.contentMode = UIViewContentModeRedraw`手动强制重绘。`[view setNeedsDisplay]`

# c# - 转换列表 to XML I have a very simple application. MainUI has the List of CustomClass. I pass this list to WCF service. WCF Service further needs to save these objects in database. I am using Open XML in our sql stored procedu 问问题 user831174 问问题 2012-05-27T13:39:07.940 8238 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have a very simple application. MainUI has the List of CustomClass. I pass this list to WCF service. WCF Service further needs to save these objects in database. I am using Open XML in our sql stored procedure to get better performnace. But i don't know how to convert my List of Objects to XML. If i have a datatable, it'll be easy as datatables have methods to get the XML out of them. But how to use for List of objects. I completly understand that if my List is coming over the WCF, it is getting serialized properly. But what should i exactly need to do. Thera are two ways: use XmlSerializer or DataContractSerializer. c#sqlxmlwcfstored-procedures 4 3 回答 3 This answer is useful 1 IMO, look into Controlling XML Serialization with Attributes and the XmlSerializer class and possibly create container classes parallel to your CustomClass. While List<> can't be automatically serialized by the default XML serializer, an array can be. 于 2012-05-27T14:03:46.847 回答 This answer is useful 1 Code for convert list to xml : List name GridDetails void ConvertToXml() { string xmlString = ConvertObjectToXMLString(GridDetails); // Save C# class object into Xml file XElement xElement = XElement.Parse(xmlString); xElement.Save(@"C:\Users\user\Downloads\userDetail.xml"); } static string ConvertObjectToXMLString(object classObject) { string xmlString = null; XmlSerializer xmlSerializer = new XmlSerializer(classObject.GetType()); using (MemoryStream memoryStream = new MemoryStream()) { xmlSerializer.Serialize(memoryStream, classObject); memoryStream.Position = 0; xmlString = new StreamReader(memoryStream).ReadToEnd(); } return xmlString; } 于 2016-04-01T11:27:33.857 回答 This answer is useful 1 Thera 有两种方法：使用XmlSerializer或DataContractSerializer。 于 2012-05-27T13:50:50.383 回答 Related 1 java - 将另一行组件添加到 relativelayout 3 xslt - XSLT：我的转换添加了一个未选择的元素。我错过了什么？ 3 c++ - C++; 编译期间“默认启用”的警告是什么意思？ 2 android - 优先考虑新活动 1 java - Android Java 代码中的这种语法是什么意思？ 2 javascript - History.go(-1) 在 IE 中不起作用 1 objective-c - 如何在 Xcode 4.5 中的项目中添加对 FORTRAN 代码的调用？ 1 c# - 如何以编程方式在 IIS 中托管 WCF 服务？ 2 objective-c - Apple Push Notifications - Remove Badge But Not Notification Text 2 python - Django：当它们已经被覆盖时不能覆盖管理模板？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10774389
> 
> 赞同：1
> 
> 时间：
> 
> 标签：c#, sql, xml, wcf, stored-procedures

I have a very simple application. MainUI has the List of CustomClass. I pass this list to WCF service. WCF Service further needs to save these objects in database.

I am using Open XML in our sql stored procedure to get better performnace. But i don't know how to convert my List of Objects to XML.

If i have a datatable, it'll be easy as datatables have methods to get the XML out of them. But how to use for List of objects.

I completly understand that if my List is coming over the WCF, it is getting serialized properly. But what should i exactly need to do.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:03:46.847

IMO, look into [Controlling XML Serialization with Attributes](http://msdn.microsoft.com/en-us/library/2baksw0z.aspx) and the [XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx) class and possibly create container classes parallel to your CustomClass. While `List<>` can't be automatically serialized by the default XML serializer, an array can be.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-01T11:27:33.857

Code for convert list to xml : List name GridDetails

```
 void ConvertToXml()
        {

            string xmlString = ConvertObjectToXMLString(GridDetails);
            // Save C# class object into Xml file
            XElement xElement = XElement.Parse(xmlString);
            xElement.Save(@"C:\Users\user\Downloads\userDetail.xml");
        }

 static string ConvertObjectToXMLString(object classObject)
    {
        string xmlString = null;
        XmlSerializer xmlSerializer = new XmlSerializer(classObject.GetType());
        using (MemoryStream memoryStream = new MemoryStream())
        {
            xmlSerializer.Serialize(memoryStream, classObject);
            memoryStream.Position = 0;
            xmlString = new StreamReader(memoryStream).ReadToEnd();
        }
        return xmlString;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T13:50:50.383

Thera 有两种方法：使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)或[DataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer)。

# php - 如何从文件夹中获取图像？

> ID：10774391
> 
> 赞同：0
> 
> 时间：2012-05-27T13:39:24.443
> 
> 标签：php, html, sql

我有一个名为`images`. 我只想从文件夹中获取这些图像并在网页上随机显示它们。当用户刷新页面时，图像应该会改变。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:48:56.043

一个想法可能是：

1.  您从图像文件夹中获取所有图像名称
2.  你随机选择一个
3.  你想象那个

所以你可以这样

```
<?
    $dir = '/my_directory_location'; 
    $files = scandir($dir);  
    $rand_img = array_rand($files, 2);
    $imcolumn = "<img src=$rand_img alt=$rand_img><br>";
?>

<?= $imcolumn ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:01:38.990

```
<?php

  $folder = "templates/images/";

  $search = glob($folder."/*");
  shuffle($search);

  foreach ($search as $image) {
    print "<img src='".$image."'><Br>";
  }

?> 
```

# objective-c - CGContextDrawImage 崩溃

> ID：10774392
> 
> 赞同：0
> 
> 时间：2012-05-27T13:39:25.097
> 
> 标签：objective-c, drawimage

代码如下：

```
- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx {
    CGContextRef context = ctx;
    CGContextRetain(context);
    CGContextSetInterpolationQuality(context, kCGInterpolationNone);
    CGContextSetLineCap(context, kCGLineCapButt);
    CGContextSetLineWidth(context, 1);
    CGContextSetRGBStrokeColor(context, 0, 0, 0, 0.8);

    // draw image
    CGContextSaveGState(context);
    CGAffineTransform flipVertical = CGAffineTransformMake(
                                                           1, 0, 0, -1, 0, layer.bounds.size.height
                                                           );
    CGContextConcatCTM(context, flipVertical);

    CGContextDrawImage(context, layer.bounds, imageRef);
    CGContextRestoreGState(context);

    // draw borders
    CGContextAddRect(context, layer.bounds);
    CGContextDrawPath(context, kCGPathStroke);

    CGFloat apertureSize = scaleFactor * (2 * samplingLevel - 1) - 1;
    CGFloat x = self.bounds.size.width / 2 - apertureSize / 2;
    CGFloat y = self.bounds.size.height / 2 - apertureSize / 2;
    CGRect apertureRect = CGRectMake(x, y, apertureSize, apertureSize);

    // draw the aperture
    CGContextSaveGState(context);
    CGContextSetRGBStrokeColor(context, 0, 0, 0, 1);      
    CGContextSetShouldAntialias(context, NO);
    CGContextStrokeRect(context, apertureRect);
    CGContextRestoreGState(context);

    CGContextRelease(context);
} 
```

它崩溃了：

```
(lldb) thread backtrace
* thread #1: tid = 0x1c03, 0x37537a5c CoreGraphics`argb32_image_mark_rgb32 + 800, stop reason = EXC_BAD_ACCESS (code=1, address=0x7314b0)
frame #0: 0x37537a5c CoreGraphics`argb32_image_mark_rgb32 + 800
frame #1: 0x3750e400 CoreGraphics`argb32_image + 5948
frame #2: 0x313c5894 libRIP.A.dylib`ripl_Mark + 16
frame #3: 0x313ca68a libRIP.A.dylib`ripl_BltImage + 998
frame #4: 0x313c2468 libRIP.A.dylib`ripc_RenderImage + 180
frame #5: 0x313be300 libRIP.A.dylib`ripc_DrawImage + 584
frame #6: 0x3750a928 CoreGraphics`CGContextDelegateDrawImage + 48
frame #7: 0x3750a794 CoreGraphics`CGContextDrawImage + 292
frame #8: 0x00166e34 MyApp`-[MyView drawLayer:inContext:] + 380 at MyView.m:43
frame #9: 0x33f054e4 QuartzCore`-[CALayer drawInContext:] + 116
frame #10: 0x33f04b3e QuartzCore`CABackingStoreUpdate_ + 1782
frame #11: 0x33f04334 QuartzCore`CA::Layer::display_() + 956
frame #12: 0x33f03f60 QuartzCore`CA::Layer::display() + 128 
```

有谁知道为什么？谢谢！我猜它是由 CGImage 或 CGContext 引起的，但它们在调试时都是非空的。我用来更新视图的图像是通过相机捕获生成的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T12:01:17.283

我使用苹果提供的示例代码（[AV Foundation Programming Guide](http://developer.apple.com/library/ios/#DOCUMENTATION/AudioVideo/Conceptual/AVFoundationPG/Articles/05_MediaRepresentations.html#//apple_ref/doc/uid/TP40010188-CH2-SW1)）来创建`imageRef`。

```
UIImage *imageFromSampleBuffer(CMSampleBufferRef sampleBuffer) {

    CVImageBufferRef imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);
    // Lock the base address of the pixel buffer.
    CVPixelBufferLockBaseAddress(imageBuffer,0);

    // Get the number of bytes per row for the pixel buffer.
    size_t bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer);
    // Get the pixel buffer width and height.
    size_t width = CVPixelBufferGetWidth(imageBuffer);
    size_t height = CVPixelBufferGetHeight(imageBuffer);

    // Create a device-dependent RGB color space.
    static CGColorSpaceRef colorSpace = NULL;
    if (colorSpace == NULL) {
        colorSpace = CGColorSpaceCreateDeviceRGB();
            if (colorSpace == NULL) {
            // Handle the error appropriately.
            return nil;
        }
    }

    // Get the base address of the pixel buffer.
    void *baseAddress = CVPixelBufferGetBaseAddress(imageBuffer);
    // Get the data size for contiguous planes of the pixel buffer.
    size_t bufferSize = CVPixelBufferGetDataSize(imageBuffer);

    // Create a Quartz direct-access data provider that uses data we supply.
    CGDataProviderRef dataProvider =
        CGDataProviderCreateWithData(NULL, baseAddress, bufferSize, NULL);
    // Create a bitmap image from data supplied by the data provider.
    CGImageRef cgImage =
        CGImageCreate(width, height, 8, 32, bytesPerRow,
                        colorSpace, kCGImageAlphaNoneSkipFirst | kCGBitmapByteOrder32Little,
                        dataProvider, NULL, true, kCGRenderingIntentDefault);
    CGDataProviderRelease(dataProvider);

    // Create and return an image object to represent the Quartz image.
    UIImage *image = [UIImage imageWithCGImage:cgImage];
    CGImageRelease(cgImage);

    CVPixelBufferUnlockBaseAddress(imageBuffer, 0);

    return image;
} 
```

注意这一行：

```
CGDataProviderRef dataProvider =
        CGDataProviderCreateWithData(NULL, baseAddress, bufferSize, NULL); 
```

`CMSampleBuffer`直接用于创建一个`CGImageRef`，所以`CGImageRef`一旦释放缓冲区就会失效。

使用缓冲区数据的副本将解决此问题：

```
NSData *data = [NSData dataWithBytes:baseAddress length:bufferSize];
CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge CFDataRef)data); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T02:14:10.727

我遇到了同样的问题，但问题与 ARC 和正确释放 CGImageRef 有关。确保调用以下内容：

```
CGImageRelease(imageRef); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-08T10:23:21.310

改变

```
CGDataProviderRef dataProvider =
    CGDataProviderCreateWithData(NULL, baseAddress, bufferSize, NULL); 
```

到

```
NSData *data = [NSData dataWithBytes:baseAddress length:bufferSize];
CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge CFDataRef)data); 
```

真的很有帮助。

# ios - 在触摸移动时取消对 UIButton 的触摸（iOS）

> ID：10774397
> 
> 赞同：0
> 
> 时间：2012-05-27T13:40:44.803
> 
> 标签：ios, event-handling, uibutton, touch

我有一个带有按钮和触摸移动手势的视图。当用户触摸按钮时，它会被选中并继续接收触摸移动事件。我想取消选择触摸移动按钮并将移动传递给手势。

如何“优雅地”取消按钮上的触摸接收？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-10T16:25:22.827

在 Swift 4 上尝试下一行代码

```
youButton.touchesCancelled([], with: nil) 
```

适用于平移手势记录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:35:04.827

您需要实现 UIGestureRecognizerDelegate。具体这种方法。然后建立你的逻辑来决定手势是否应该接收触摸。如果您返回“否”，则该按钮的触摸已准备就绪。如果您返回 YES，则表示进行触摸。

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch 
```

如果你从来没有更多的控制权，我认为你需要对按钮进行子类化并接管它的命中测试。

# php - Mysql Lock Tables 100%保证只有一个用户可以编辑？

> ID：10774398
> 
> 赞同：1
> 
> 时间：2012-05-27T13:40:51.167
> 
> 标签：php, mysql

```
mysql_query("LOCK TABLES `counter` WRITE;") or die(mysql_error());
$res = mysql_query("SELECT `unID` FROM `counter`;") or die(mysql_error());
$row = mysql_fetch_assoc($res);
$unID = $row['unID'] + 1;
mysql_query("UPDATE `counter` SET `unID`=`unID`+1;") or die(mysql_error());
mysql_query("UNLOCK TABLES;") or die(mysql_error()); 
```

这是 100% 保证*$unID*对于每个访问 web 的用户都是唯一的？

mysql表类型：MyISAM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:51:13.457

或者，您可以只创建一个序列表：

```
CREATE TABLE sequence (id INT NOT NULL);
INSERT INTO sequence VALUES (0); 
```

然后使用此查询获取下一个 id：

```
UPDATE sequence SET id=LAST_INSERT_ID(id+1); 
```

您可以使用`mysql_insert_id()`.

顺便说一句，尝试使用`PDO`or `mysqli`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T13:51:17.577

从手册：

> 只有持有锁的会话才能访问该表。在释放锁之前，没有其他会话可以访问它。

所以答案是肯定的，数字将是唯一的。

# android - 如何在我的项目中使用来自其他项目的一些类？

> ID：10774399
> 
> 赞同：1
> 
> 时间：2012-05-27T13:41:01.337
> 
> 标签：android

我有一个 android 项目，我想使用另一个 android 项目中的一些类。我怎样才能做到这一点？在我的项目中，我画了两点之间的道路。在新项目中，我想使用一些类来帮助我在地图上绘制更多点，并提供带有信息的工具提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T13:49:18.400

创建一个包含两个项目的公共部分的[库项目。](http://developer.android.com/guide/developing/projects/projects-eclipse.html#SettingUpLibraryProject)让这两个项目引用这个 Android 库项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:48:27.060

1.  右键单击您的项目->新建->包

2.  为包命名`com.youname.yourapp.something`

3.  复制要在此项目中使用的类。

4.  用于`import`使用复制的类。

# primefaces - 在最后一个选项卡上提交后如何将primefaces向导重定向到第一个选项卡

> ID：10774404
> 
> 赞同：14
> 
> 时间：2012-05-27T13:41:23.113
> 
> 标签：primefaces

我正在使用primefaces 3.2。我已经准备好在数据表的同一页面上插入用户信息的向导。向导逐个选项卡获取信息并在确认选项卡上提交。它也将反映在数据表的同一页面上。它工作正常。现在我需要更新多个用户。为此，我必须将向导从提交按钮导航到第一个选项卡。任何帮助将不胜感激。我的代码如下

向导.xhtml

```
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:p="http://primefaces.org/ui"
  xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <title>Wizard Example</title>
    <script type="text/javascript" >
        function resetWizard() {
            wiz.loadStep(wiz.cfg.steps[0], true);
        }
    </script>
</h:head>
<h:body>
    <h:form id="form">

        <!-- <p:growl id="growl" sticky="true" showDetail="true"/> -->
        <p:growl redisplay="false" life="3000" id="mymessage" autoUpdate="true"/>
        <p:wizard widgetVar="wiz"
                  flowListener="#{userWizard.onFlowProcess}" showNavBar="true" >

            <p:tab id="personal" title="Personal" >

                <p:panel header="Personal Details">

                    <h:messages errorClass="error"/>

                    <h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
                        <h:outputText value="Firstname: *" />
                        <p:inputText required="true" label="Firstname"
                                     value="#{userWizard.user.firstname}" />

                        <h:outputText value="Lastname: *" />
                        <p:inputText required="true" label="Lastname"
                                     value="#{userWizard.user.lastname}" />

                        <h:outputText value="Age: " />
                        <p:inputText value="#{userWizard.user.age}" />

                    </h:panelGrid>
                </p:panel>
            </p:tab>

            <p:tab id="address" title="Address" >
                <p:panel header="Adress Details">

                    <h:messages errorClass="error"/>

                    <h:panelGrid columns="2" columnClasses="label, value">
                        <h:outputText value="Street: " />
                        <p:inputText value="#{userWizard.user.street}" />

                        <h:outputText value="Postal Code: " />
                        <p:inputText value="#{userWizard.user.postalCode}" />

                        <h:outputText value="City: " />
                        <p:inputText value="#{userWizard.user.city}" />

                    </h:panelGrid>
                </p:panel>
            </p:tab>

            <p:tab id="contact" title="Contact" >
                <p:panel header="Contact Information">

                    <h:messages errorClass="error"/>

                    <h:panelGrid columns="2" columnClasses="label, value">
                        <h:outputText value="Email: *" />
                        <p:inputText required="true" label="Email"
                                     value="#{userWizard.user.email}" />

                        <h:outputText value="Phone: " />
                        <p:inputText value="#{userWizard.user.phone}"/>

                        <h:outputText value="Additional Info: " />
                        <p:inputText value="#{userWizard.user.info}"/>
                    </h:panelGrid>
                </p:panel>
            </p:tab>

            <p:tab id="confirm" title="Confirmation" >
                <p:panel header="Confirmation">

                    <h:panelGrid id="confirmation" columns="6">
                        <h:outputText value="Firstname: " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.firstname}" />

                        <h:outputText value="Lastname: " />
                        <h:outputText  styleClass="outputLabel"
                                       value="#{userWizard.user.lastname}"/>

                        <h:outputText value="Age: " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.age}" />

                        <h:outputText value="Street: " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.street}" />

                        <h:outputText value="Postal Code: " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.postalCode}" />

                        <h:outputText value="City: " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.city}" />

                        <h:outputText value="Email: " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.email}" />

                        <h:outputText value="Phone " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.phone}"/>

                        <h:outputText value="Info: " />
                        <h:outputText styleClass="outputLabel"
                                      value="#{userWizard.user.info}" />

                    </h:panelGrid>

                    <p:commandButton immediate="true" value="Submit" update="wiz"
                                     actionListener="#{userWizard.save}"  ajax="false"/>

                </p:panel>
            </p:tab>

        </p:wizard>

        <p:dataTable var="user" value="#{userWizard.userAll}" id="userList" editable="true" rowKey="#{user.firstname}" paginator="true"
                     rows="4" rowsPerPageTemplate="4,6" >

            <p:column headerText="FirstName" style="width:125px" filterBy="#{user.firstname}" sortBy="#{user.firstname}">
                <p:cellEditor>
                    <f:facet name="output">
                        <h:outputText value="#{user.firstname}" />
                    </f:facet>
                    <f:facet name="input">
                        <h:outputText value="#{user.firstname}" />
                    </f:facet>
                </p:cellEditor>
            </p:column>

            <p:column headerText="LastName" style="width:125px" filterBy="#{user.lastname}" sortBy="#{user.lastname}" >
                <p:cellEditor>
                    <f:facet name="output">
                        <h:outputText value="#{user.lastname}" />
                    </f:facet>
                    <f:facet name="input">
                        <p:inputText value="#{user.lastname}" style="width:100%" >
                        </p:inputText>
                    </f:facet>
                </p:cellEditor>
            </p:column>

            <p:column headerText="Age" style="width:125px" filterBy="#{user.age}" sortBy="#{user.age}">
                <p:cellEditor>
                    <f:facet name="output">
                        <h:outputText value="#{user.age}" />
                    </f:facet>
                    <f:facet name="input">
                        <p:inputText value="#{user.age}" style="width:100%" >
                        </p:inputText>
                    </f:facet>
                </p:cellEditor>
            </p:column>

            <p:column headerText="Edit" style="width:50px">
                <p:rowEditor />
            </p:column>
            <p:ajax event="rowEdit" listener="#{userWizard.editRowListner}" update=":form:mymessage"/>

        </p:dataTable>
    </h:form>
</h:body> 
```

用户向导.java

```
package com.test;

import java.util.ArrayList;
import java.util.List;
import java.util.logging.Logger;
import javax.faces.bean.SessionScoped;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import org.primefaces.event.FlowEvent;
import org.primefaces.event.RowEditEvent;

@ManagedBean
@SessionScoped

public class UserWizard {

private User user = new User();
private boolean skip;
private List<User> userAll = new ArrayList<User>();

private static Logger logger = Logger.getLogger(UserWizard.class.getName());
/*public UserWizard() {
    userAll = new ArrayList<User>();
}*/
public List<User> getUserAll() {
    return userAll;
}

public void setUserAll(List<User> userAll) {
    this.userAll = userAll;
}
public User getUser() {
    return user;
}

public void setUser(User user) {
    this.user = user;
}

public void save(ActionEvent actionEvent) {
    //Persist user
    System.out.println("First name : " + user.getFirstname());
    System.out.println("Last name : " + user.getLastname());
    System.out.println("Age name : " + user.getAge());
    userAll.add(user);
    user = new User();
    FacesMessage msg = new FacesMessage("Successful", "Welcome :" + user.getFirstname());
    FacesContext.getCurrentInstance().addMessage(null, msg);

}

public boolean isSkip() {
    return skip;
}

public void setSkip(boolean skip) {
    this.skip = skip;
}

public String onFlowProcess(FlowEvent event) {
    logger.info("Current wizard step:" + event.getOldStep());
    logger.info("Next step:" + event.getNewStep());
    System.out.println("First name : " + user.getFirstname());
    System.out.println("Last name : " + user.getLastname());
    System.out.println("Age name : " + user.getAge());
    if (skip) {
        skip = false;   //reset in case user goes back
        return "confirm";
    } else {

        return event.getNewStep();
    }
}

public void editRowListner(RowEditEvent rowEditEvent) {
    try {
        User updatedUser = (User) rowEditEvent.getObject();
        System.out.println("User First Name: " + updatedUser.getFirstname());
        FacesContext context = FacesContext.getCurrentInstance();
        context.addMessage(null, new FacesMessage("Update called", "updated by user"));
    } catch (Exception ex) {
        ex.getMessage();
    }
}
} 
```

用户.java

```
public class User {

private String firstname;
private String lastname;
private Integer age;
private String street;
private String city;
private String postalCode;
private String info;
private String email;
private String phone;

public User(String firstname, String lastname, Integer age, String street, String city, String postalCode, String info, String email, String phone) {
    this.firstname = firstname;
    this.lastname = lastname;
    this.age = age;
    this.street = street;
    this.city = city;
    this.postalCode = postalCode;
    this.info = info;
    this.email = email;
    this.phone = phone;
}

public User() {

}

public String getFirstname() {
    return firstname;
}

public void setFirstname(String firstname) {
    this.firstname = firstname;
}

public String getLastname() {
    return lastname;
}

public void setLastname(String lastname) {
    this.lastname = lastname;
}

public Integer getAge() {
    return age;
}

public void setAge(Integer age) {
    this.age = age;
}

public String getStreet() {
    return street;
}

public void setStreet(String street) {
    this.street = street;
}

public String getCity() {
    return city;
}

public void setCity(String city) {
    this.city = city;
}

public String getPostalCode() {
    return postalCode;
}

public void setPostalCode(String postalCode) {
    this.postalCode = postalCode;
}

public String getInfo() {
    return info;
}

public void setInfo(String info) {
    this.info = info;
}

public String getEmail() {
    return email;
}

public void setEmail(String email) {
    this.email = email;
}

public String getPhone() {
    return phone;
}

public void setPhone(String phone) {
    this.phone = phone;
}
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-27T14:02:54.620

在 wizard.xhtml 页面中，将您的提交按钮更改为：

```
<p:commandButton immediate="true" value="Submit" update="@parent,:form:userList" actionListener="#{userWizard.save}" oncomplete="wiz.loadStep (wiz.cfg.steps [0], true)"/> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-10T09:17:41.293

在 primefaces 5 中，您不能直接调用 widgetVar，您需要像这样调用它，`PF('widgetVar')`这样您就可以这样做：

```
<p:commandButton value="Submit" actionListener="#{userWizard.save}" oncomplete="PF('wiz').loadStep('tabId',false)" /> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-08T07:29:33.380

您也可以从 Java 代码中执行此操作，如下所示：

```
Wizard wizard = (Wizard) FacesContext.getCurrentInstance().getViewRoot().findComponent("importForm:wizardId");
wizard.setStep(STEP1);
RequestContext.getCurrentInstance().update("importForm"); 
```

# php - JWPlayer 的文件浏览器

> ID：10774409
> 
> 赞同：1
> 
> 时间：2012-05-27T13:42:13.270
> 
> 标签：php, javascript, function, jwplayer

我想构建一个文件浏览器，它在单击时显示有关文件的信息。然后，文件本身应该通过 PHP 加载到 jwplayer 中。

我可以通过单击文件以某种方式做到这一点吗？或者我应该使用 JavaScript 吗？（我尽量避免）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:31:15.673

通过列出要通过 php 列出的所有文件来创建文件浏览器，输出如下：

```
<div id="player_container"></div>
<a href="./files/file.mp4" onclick="playjw(this)" />
<a href="./files/file2.mp4" onclick="playjw(this)" />
<a href="./files/file3.mp4" onclick="playjw(this)" />   ect 
```

和功能

```
<script type='text/javascript'>

var temp;
var temphref; //these variables to get the href of the anchor back when opening 
              //another file so you could open the first file again

function playjw(file) {

var srcfile=file.href;

jwplayer('player_container').setup ({

'flashplayer': 'player.swf',
'file': srcfile,
'controlbar': 'bottom',
'width': '470',
'height': 320,
'provider': 'http'

});

return false; // this is required to not let the browser follow the link.

}
</script> 
```

如果出现任何错误，请自行更改功能，因为我可能忘记了一些东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:20:30.777

如果要使用文件浏览器，请使用基于 php/javasript 的脚本。除非您有太多时间，否则不要尝试自己构建它。检查[http://www.gerd-tentler.de/tools/filemanager/](http://www.gerd-tentler.de/tools/filemanager/)和[http://encode-explorer.siineiolekala.net/explorer/index.php](http://encode-explorer.siineiolekala.net/explorer/index.php)。网络上到处都是优秀的免费脚本。根据您希望如何使用 jwplayer（音频？视频？），您可以轻松创建播放文件的 div（请参阅 jw 文档）或创建播放文件的 iframe。

最简单的方法是为所有以 .mpg 或 .mp3 结尾的文件创建一个 onclick 事件，以创建 div/iframe。

# ruby-on-rails - rails 3.1 的新资产路径问题

> ID：10774411
> 
> 赞同：1
> 
> 时间：2012-05-27T13:42:28.753
> 
> 标签：ruby-on-rails, assets

我正在尝试向管道添加一个新的资产路径......我在 /app/assets/ 中创建了一个目录“字体”并写下了这一行：

```
config.assets.paths << "#{Rails.root}/app/assets/fonts" 
```

在我的 application.rb 配置文件中。但我在浏览此内容时收到 404 错误：localhost:3000/assets/fonts/

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T13:44:03.020

只使用`localhost:3000/fonts`.

# c++ - Gtkmm：如何从另一个线程更新 UI？连续不断

> ID：10774412
> 
> 赞同：4
> 
> 时间：2012-05-27T13:42:50.143
> 
> 标签：c++, multithreading, signals, gtkmm

线程 A：运行 Gtkmm 消息循环的 UI 线程。

线程 B：通过网络接收数据并将其记录到文件中。

现在我希望在线程 B 中转储到文件中的相同数据也同时显示在 UI 上的 Gtk::TextView 中。最好的方法是什么？

Glib::Dispatcher 不带数据。所以它只对通知工作完成有好处。

libSigCX 让我很难过。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T22:10:08.810

我会尝试`Glib::Dispatcher`与`Glib::Threads::Mutex`（或等效的）受保护`std::queue<std::string>`数据结构一起使用。将每个工作项放入队列后，使用调度程序通知 UI 线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T04:51:29.203

可能您应该将 UI 结构指针作为参数传递给线程 B。该结构已经分配了所有信号，您可以使用 TextView。

# java - 安卓游戏，'LEVER' - box2D

> ID：10774415
> 
> 赞同：2
> 
> 时间：2012-05-27T13:43:08.963
> 
> 标签：java, android, box2d, andengine

我正在尝试在我的 android 游戏中实现“杠杆”，这里的图片显示了我想要什么，展示了它是如何工作的：

1)

![在此处输入图像描述](../Images/f643e5c84c4166f090d0b6bacd8bd066.png)

2)

![在此处输入图像描述](../Images/40cd77b7bb016ad72ec34cc923f8168c.png)

我设法通过使用联合来完成它的基本工作：

```
final RevoluteJointDef revoluteJointDef = new RevoluteJointDef();
revoluteJointDef.initialize(anchorBody, movingBody, anchorBody.getWorldCenter());
revoluteJointDef.enableLimit = true;
revoluteJointDef.upperAngle = MathUtils.degToRad(40);
revoluteJointDef.lowerAngle = MathUtils.degToRad(-40);
physicsWorld.createJoint(revoluteJointDef); 
```

它可以工作，我可以向左/向右移动操纵杆，并且你应该不能超过适当的角度，所以这部分完成了。但是现在我正在寻找一种方法，在移动此杠杆后执行操作（例如打开一些门/大门）

这是我的基本想法，如何通过用这种方式创建棒的身体来检查玩家（左或右）触摸了棒的哪一部分：

![在此处输入图像描述](../Images/8ce948d23c224b57718bd6d1c916f95c.png)

所以解释一下，通过添加 2 个传感器，一个在左侧，一个在右侧，所以在接触侦听器时，我会检查哪一侧被触摸。

但是我仍然不知道如何检查是否应该执行操作，我知道如果坚持角为 40 或 -40，我可以检查每次更新，但这是有效的方法吗？或者也许有更好的？我将非常感谢任何提示！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T16:04:27.973

您提到的两种方法都可以，只是您觉得哪种方法更方便。看起来您似乎已经了解了实现，所以我认为没有人能比说“哪个更适合您”更好地回答这个问题。

在杠杆范围的每一端放置一个传感器并使用接触监听器来检测杠杆何时接触它们是最“正确”的方式。它可以方便地为您提供控制杆接触传感器和停止接触时的事件，但设置起来需要更多的工作。

在每个时间步之后检查关节角度也可以正常工作，但是如果要检测开始/结束触摸“事件”，则需要将角度与上一步中的值进行比较。如果您想要一个可以提供连续值的杠杆（例如，其他对象的速度控制）而不是简单的开/关开关，那么使用这种方法会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T16:08:35.123

您不必担心这里的效率，检查角度的性能损失绝对可以忽略不计。我使用以下代码片段测量了获取 Sprite 和 Body 的角度所需的时间：

```
double testEnd;
double testStart;
testStart = System.nanoTime();
for (int i = 0; i<1000000; i++) {doStuff()}
testEnd = System.nanoTime();
Log.v("speed test", "it takes "+ (testEnd - testStart)/1000000 + " nanoseconds"); 
```

因此，在 Desire Z 上，只需 157 ns 即可找到 Sprite 的角度，而使用 Body 则需要 393 ns。它也比使用联系人监听器简单得多。顺便说一句，如果您旋转 Sprite，Sprite 的角度可以超出 (-360, +360) 度。

# c - “int”真的需要至少和C中的“short”一样大吗？

> ID：10774416
> 
> 赞同：16
> 
> 时间：2012-05-27T13:43:09.857
> 
> 标签：c, standards, c99, c89

[我在不同的来源（例如维基百科： http](http://en.wikipedia.org/wiki/C_variable_types_and_declarations#Size) ://en.wikipedia.org/wiki/C_variable_types_and_declarations#Size）中读过几次，在 C 中，long long 不小于 long，long 不小于比不小于短的 int。

但是，我在 C90 和 C99 标准中查找了这一点，并没有找到相应的条款。我发现只有 C90 和 C99 指定了最小类型大小（C90 和 C99 标准中的第 5.2.4.2.1 节），但没有指定它们之间的大小。我是否遗漏了标准中的某些内容？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-27T14:32:25.043

6.3.1.1 定义了任意两种整数类型的相对*整数转换等级*。这是一个抽象概念，仅用于定义两种类型之间的关系；没有任何值被定义为任何类型的*等级*。

6.2.5p8 说：

> 对于任何两个具有相同符号和不同整数转换等级的整数类型（见 6.3.1.1），具有较小整数转换等级的类型的值范围是另一个类型的值的子范围。

它没有说明它们的相对*大小*，事实上，从理论上讲，符合（但故意反常）的实现可能具有`sizeof (short) > sizeof (int)`. 仅当*填充位*`short`（对值没有贡献的位）比. 这不太可能；大多数实现根本没有填充位，而且我知道没有实现整数类型范围的关系与其大小关系不同的实现。*`int`*

 *参考：要么[N1256](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)，最新的 C99 草案，要么[N1570](http://www.open-std.org/JTC1/sc22/wg14/www/docs/n1570.pdf)，最新的 C2011 草案。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-27T13:53:22.253

我假设 Wikipedia 文章指的是这些整数类型的*值范围*，而不是它们的*大小*（由 报告`sizeof`）。

来自[C99 标准草案 N1256](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)：

**6.3.1.1/1**

> 的等级`long long int`应大于 的等级`long int`应大于 的等级`int`应大于 的等级`short int`应大于 的等级`signed char`。

**6.2.5/8**

> 对于任何两个具有相同符号和不同整数转换等级的整数类型（见 6.3.1.1），具有较小整数转换等级的类型的值范围是另一个类型的值的子范围。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-27T13:54:25.127

来自[C2011 标准](http://www.open-std.org/JTC1/sc22/wg14/www/docs/n1570.pdf)

> 6.3.1.1/1
> 
> — **long long int**的rank 大于long int 的rank，**long int**的rank 大于**int**的rank，**short int**的rank 大于**signed char**的rank 。*

# java - 全文搜索类似

> ID：10774418
> 
> 赞同：1
> 
> 时间：2012-05-27T13:43:24.303
> 
> 标签：java, google-app-engine, full-text-search, search-engine

假设我想查询字符串“这是第一个标题”，我希望它返回几乎类似的字符串，如下所示。

```
this is first title
this is second title
this is third title 
```

这可以`QueryOptions`查询“几乎相似”的字符串吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T22:24:52.903

您可以搜索`"this is" title`（将“this is”括在双引号中将其视为一个短语），这应该适用于您的特定用例。如果您在特定字段中搜索，例如“摘要”，您可以指定该字段以缩小搜索范围，例如：`summary:"this is" summary:title`

另请参阅此问题的答案：[GAE 全文搜索 API 短语匹配](https://stackoverflow.com/questions/10523987/gae-full-text-search-api-phrase-matching/10647426#10647426)。您可以使用“~”运算符重写查询以包含复数，这是搜索相似文本的一种方式。

# php - Symfony 2：带密码加密

> ID：10774426
> 
> 赞同：0
> 
> 时间：2012-05-27T13:44:59.887
> 
> 标签：php, symfony

```
$factory = $this->get('security.encoder_factory');
    var_dump($factory);

    $encoder = $factory->getEncoder($user);

    //$encoder = new MessageDigestPasswordEncoder('sha512', true, 10);
    $password = $encoder->encodePassword($user->getUserPass(), $user->getUserSalt());
    $user->setUserPass($password); 
```

错误

```
Catchable Fatal Error: Argument 1 passed to Symfony\Component\Security\Core\Encoder\EncoderFactory::getEncoder() must implement interface Symfony\Component\Security\Core\User\UserInterface, instance of Acme\AdminBundle\Entity\SyjUsers given, called in D:\Zend\joke\src\Acme\AdminBundle\Controller\AdminController.php on line 28 and defined in D:\Zend\joke\vendor\symfony\src\Symfony\Component\Security\Core\Encoder\EncoderFactory.php line 33 
```

500 内部服务器错误 - ErrorException

用户实体

```
<?php

namespace Acme\UserBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

use Symfony\Component\Security\Core\User\UserInterface;

/**
 * Acme\UserBundle\Entity\SyjUsers
 *
 * @ORM\Table(name="syj_users")
 *
 * @ORM\Entity
 */

class SyjUsers implements UserInterface
{

    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer", nullable=false)
     *
     * @ORM\Id
     *
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $userLogin
     *
     * @ORM\Column(name="user_login", type="string", length=60, nullable=false)
     */
    private $userLogin;

    /**
     * @var string $userSalt
     *
     * @ORM\Column(name="user_salt", type="string", length=64, nullable=false)
     */
    private $userSalt;

    /**
     * @var string $userPass
     *
     * @ORM\Column(name="user_pass", type="string", length=64, nullable=false)
     */
    private $userPass;

    /**
     * @var string $userNicename
     *
     * @ORM\Column(name="user_nicename", type="string", length=60, nullable=true)
     */
    private $userNicename;

    /**
     * @var string $userEmail
     *
     * @ORM\Column(name="user_email", type="string", length=100, nullable=true)
     */
    private $userEmail;

    /**
     * @var string $userUrl
     *
     * @ORM\Column(name="user_url", type="string", length=60, nullable=true)
     */
    private $userUrl;

    /**
     * @var boolean $userStatus
     *
     * @ORM\Column(name="user_status", type="boolean", nullable=false)
     */
    private $userStatus;

    /**
     * @var string $userDisplayName
     *
     * @ORM\Column(name="user_display_name", type="string", length=60, nullable=true)
     */
    private $userDisplayName;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set userLogin
     *
     * @param string $userLogin
     */
    public function setUserLogin($userLogin)
    {
        $this->userLogin = $userLogin;
    }

    /**
     * Get userLogin
     *
     * @return string 
     */
    public function getUserLogin()
    {
        return $this->userLogin;
    }

    /**
     * Set userSalt
     *
     * @param string $userSalt
     */
    public function setUserSalt($userSalt)
    {
        $this->userSalt = $userSalt;
    }

    /**
     * Get userSalt
     *
     * @return string 
     */
    public function getUserSalt()
    {
        return $this->userSalt;
    }

    /**
     * Set userPass
     *
     * @param string $userPass
     */
    public function setUserPass($userPass)
    {
        $this->userPass = $userPass;
    }

    /**
     * Get userPass
     *
     * @return string 
     */
    public function getUserPass()
    {
        return $this->userPass;
    }

    /**
     * Set userNicename
     *
     * @param string $userNicename
     */
    public function setUserNicename($userNicename)
    {
        $this->userNicename = $userNicename;
    }

    /**
     * Get userNicename
     *
     * @return string 
     */
    public function getUserNicename()
    {
        return $this->userNicename;
    }

    /**
     * Set userEmail
     *
     * @param string $userEmail
     */
    public function setUserEmail($userEmail)
    {
        $this->userEmail = $userEmail;
    }

    /**
     * Get userEmail
     *
     * @return string 
     */
    public function getUserEmail()
    {
        return $this->userEmail;
    }

    /**
     * Set userUrl
     *
     * @param string $userUrl
     */
    public function setUserUrl($userUrl)
    {
        $this->userUrl = $userUrl;
    }

    /**
     * Get userUrl
     *
     * @return string 
     */
    public function getUserUrl()
    {
        return $this->userUrl;
    }

    /**
     * Set userStatus
     *
     * @param boolean $userStatus
     */
    public function setUserStatus($userStatus)
    {
        $this->userStatus = $userStatus;
    }

    /**
     * Get userStatus
     *
     * @return boolean 
     */
    public function getUserStatus()
    {
        return $this->userStatus;
    }

    /**
     * Set userDisplayName
     *
     * @param string $userDisplayName
     */
    public function setUserDisplayName($userDisplayName)
    {
        $this->userDisplayName = $userDisplayName;
    }

    /**
     * Get userDisplayName
     *
     * @return string 
     */
    public function getUserDisplayName()
    {
        return $this->userDisplayName;
    }
    /**
     * @inheritDoc
     */
    public function getUsername()
    {
        return $this->userLogin;
    }

    /**
     * @inheritDoc
     */
    public function getSalt()
    {
        return $this->userSalt;
    }

    /**
     * @inheritDoc
     */
    public function getPassword()
    {
        return $this->userPass;
    }

    /**
     * @inheritDoc
     */
    public function getRoles()
    {
        return array('ROLE_USER');
    }

    /**
     * @inheritDoc
     */
    public function eraseCredentials()
    {
    }

    /**
     * @inheritDoc
     */
    public function equals(UserInterface $user)
    {
        return $this->userLogin === $user->getUsername();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T06:52:09.697

你有没有试过

```
implements CustomUserInterface 
```

而不是

```
implements UserInterface 
```

# java - 如何查找一个点是否存在于哪个多边形中

> ID：10774427
> 
> 赞同：5
> 
> 时间：2012-05-27T13:45:00.837
> 
> 标签：java, postgresql, mongodb, geometry, opengis

如何查找一个点是否存在于给定的一组多边形中？我有坐标

```
polygonA = 1(0,0),2(0,5),3(3,4),4(3,5),5( 2,2)
polygonB = 1(10,10),2(10,15),3(13,14),4(13,15),5(12,12) 
```

我有一个点，因为 (6,4) 现在想搜索该点是否在该多边形中的任何一个中，或者在两者中或最接近哪个多边形中。

如何存储此类数据（多边形）？有系统/数据库/算法来做这个搜索吗？

**更新：**感谢大家这么快的反应......我想我需要更具体......

如何搜索 = 是的...获得相同的[算法](http://en.wikipedia.org/wiki/Point_in_polygon)和[库](http://sourceforge.net/projects/jsi/)列表。

如何存储 = 基于我的研究 SQL 和 NoSQL db 有它们的解决方案。NoSQL = MongoDb 似乎最接近我所需要的。但问题是我可以像 "db.places.find({ "loc" : { "$within" : { "$polygon" : polygonB } } })" 那样查询但是不能像 db.places.find({ " loc" : { "$within" : { } } }) S​​QL 检查了 postgre 和 openGIS 以获得一些帮助。但是colud没有弄清楚它是否可能。

如果有人可以帮助我...在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T13:53:00.710

基本方法（如果您有少量多边形）是将所有多边形存储在一个集合中并循环遍历元素以检查一个点是否在多边形内。

另一方面，如果你有大量的多边形，我会推荐使用标准库中没有的 R-tree 数据结构。如果你想使用 R-tree 选项，你应该检查这个项目：http: [//sourceforge.net/projects/jsi/](http://sourceforge.net/projects/jsi/)。

R-tree 允许您索引矩形（在这种情况下为多边形的边界框）。因此，您可以使用 R-tree 非常快速地找到少量候选多边形。然后您可以遍历候选列表以获得最终结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:21:36.253

您可以使用 GeneralPath 类来帮助您确定*点是否*与多边形相交。首先，创建一个添加了坐标的 GeneralPath：

```
 GeneralPath gp = new GeneralPath();
    double[] x = ...
    double[] y = ...
    gp.moveTo(x[0], y[0]);
    for (int i =1; i < x.length; i++) {
        gp.lineTo(x[i], y[i]);
    }
    gp.closePath();

    if (gp.contains(pointX, pointY)) {
        ...
    } 
```

对于一个点更接近哪个多边形的问题，这在一定程度上取决于您需要解决方案的准确程度。

为了获得准确的解决方案，这相当于（未经优化）：

*   取点和连接每个多边形顶点的每条线（段）之间的最短距离（Java2D 显然没有为此提供方法，但是从点到线的最短距离是一个[相当简单的计算](http://paulbourke.net/geometry/pointline/))
*   哪个多边形的直线到该点的距离最短？

在实践中，您可以为某些应用程序近似此过程。例如，您可以更有效地执行此操作：

*   取每个多边形的边界矩形的中心点（GeneralPath.getBounds() 会给你这个）
*   取查询点和每个中心点之间的距离，看看哪个最近。

如果您确实需要一个准确的答案，那么您可以结合这些技术来优化您在所有顶点之间的搜索。例如，您可以按到“中心点”（如上定义）的距离对多边形进行排序。从最小到最大距离搜索。如果到目前为止您找到的线段的最小距离是 d，那么您可以自动排除从查询点到其“中心点”的距离为 d + r 的任何多边形 P，其中 r 是长度的一半P 的边界矩形的对角线（换句话说，为简单起见，您可以想象围绕该边界框的边界圆，并检查到该边界圆的距离是否比迄今为止在其他多边形上找到的最近点更远）。

我不太了解数据库。您的多边形只是定义为一系列点。您如何决定将这些存储在内存/文件中并不会对算法产生任何影响。

# ruby-on-rails - 使用 RSpec 测试事件序列

> ID：10774435
> 
> 赞同：0
> 
> 时间：2012-05-27T13:46:32.673
> 
> 标签：ruby-on-rails, rspec, rspec-rails

我刚开始使用 RSpec，我试图做一些非常微不足道的事情，但我找不到任何好的文档来说明这样做的好方法。我想测试一系列事件，比如两个用户之间的友谊。

我的规格是：

```
describe User do

  describe "friendships" do
    describe ".friends?" do
      before do
        @user1 = FactoryGirl.build(:user)
        @user2 = FactoryGirl.build(:user)
      end

      it "should be false for non friends" do
        @user1.friends?(@user2).should be false
        @user2.friends?(@user1).should be false
      end

      it "should be false for requested friendship" do
        Friendship.create(:user_id => @user1.id, :friend_id => @user2.id)  # 1
        @user1.friends?(@user2).should be false
        @user2.friends?(@user1).should be false
      end

      it "should be true for accepted friendship" do
        Friendship.for_users(@user1, @user2).update_attribute(:approved, true) # 2
        @user1.friends?(@user2).should be true
        @user2.friends?(@user1).should be true
      end
    end

  end
end 
```

我正在标记的行处建立友谊`# 1`，并希望它出现在 line 处`# 2`，但我猜数据库会在两者之间刷新。

这是测试这种事件流的错误方法吗？我应该做什么？任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:58:00.537

是的，数据库在事件流之间被刷新。

最好的测试方法是让每个测试都设置它需要的东西，并在完成后将其丢弃。这样，每个测试都是完全独立的，因此您不必为以后的测试依赖以前的测试。

您可以考虑只在工厂女孩中建立友谊，然后测试友谊是否存在，然后在集成测试中通过 UI 使人们成为朋友并检查相同的事情

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-28T05:33:15.287

我猜你正在寻找`context`. 像这样的东西：

```
context "when friends" do
  before { Friendship.create ... }

  it "should be false for requested friendship"

  it "should be true for accepted friendship"
end 
```

很抱歉这么说，但您可能应该看一下 rspec 文档：[基本结构 (describe/it)](https://www.relishapp.com/rspec/rspec-core/v/2-10/docs/example-groups/basic-structure-describe-it)

# c++ - C++11 标准和免费草稿 N3337 之间的节号是否不同？

> ID：10774436
> 
> 赞同：15
> 
> 时间：2012-05-27T13:46:38.110
> 
> 标签：c++, c++11, standards

[C++11 标准 ISO/IEC 14882:2011](http://webstore.ansi.org/RecordDetail.aspx?sku=INCITS/ISO/IEC%2014882-2012)和[后来的免费下载草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3338.html) [N3337](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)之间的条款、节、小节、段落等的编号是否不同？

需要明确的是：我的问题不是是否建议使用 N3337 代替官方标准，因为这个问题[已经在 Stackoverflow 上得到了很好的回答；](https://stackoverflow.com/questions/81656/where-do-i-find-the-current-c-or-c-standard-documents)但只有编号是否不同。

作为参考，[这是我找到的最相关的非 Stackoverflow 答案](http://www.wilmott.com/textthread.cfm?catid=44&threadid=88823&FTVAR_MSGDBTABLE=)（如果您点击链接，请特别参考日期为“Sun Mar 18, 12 06:41 PM”的项目）。同样作为参考，@Nemo 提请注意相关的 Stackoverflow 问题，并[在此处提供答案。](https://stackoverflow.com/questions/7238958)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T16:30:27.923

受保护的 N3290 被委员会视为最终草案。我没有购买 ISO/IEC 标准并比较它们以确保它与 N3290 相同。我也没有听到任何关于委员会质疑它是相同的讨论。

我比较了 N3290 和 N3337 的交叉引用。交叉引用包含 section.tags 和节号的完整列表。除了两个小的变化外，它们是相同的：

N3290 具有：

```
unord.map.modifers 23.5.4.4
unord.multimap.modifers 23.5.5.3 
```

N3337 具有：

```
unord.map.modifiers 23.5.4.4
unord.multimap.modifiers 23.5.5.3 
```

（修饰符 -> 修饰符）

我不知道段落编号。但[这里](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3338.html)是编辑关于自定稿以来所做更改的报告。

# ajax - 数据变化时自动刷新jsp页面

> ID：10774446
> 
> 赞同：1
> 
> 时间：2012-05-27T13:49:42.633
> 
> 标签：ajax, jsp, page-refresh

我有一个 JSP 页面，它显示数组中包含的项目（只是一个非常简单的列表）。
在后台，阵列可能会发生变化，即添加一个新项目或删除一个项目。

数组更改时如何自动刷新页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:05:26.240

有两种最流行的方式来执行这种操作

*   pool 一个方法，它会发送 1 或 0 来查看您是否刷新页面
*   继续请求该数据数组并通过 javascript 填充它

* * *

**选项1**

*   创建一个`.jsp`页面并调用它，例如，`updateList.jsp`
*   添加一个方法来检查是否有更多数据要填充并输出 1 或 0，例如：`out.println(1)`
*   在您的页面中，并使用 jQuery 来简化事情

```
 $.get("updateList.jsp", function(data) {
    if(data !== null && data.length > 0 && data === 1) {
        // refresh this page
        document.location = document.location.href;
    }
 }); 
```

* * *

**选项 2**

*   创建一个`.jsp`页面并调用它，例如，`data.jsp`
*   添加一个方法，该方法将输出包含填充列表所需的所有数据的 JSON 字符串
*   在您的页面中，并使用 jQuery 和 JsRender 来简化事情

```
 $.get("updateList.jsp", function(data) {
    if(data !== null && data.length > 0) {
        $("#my-list").html(
            $("#my-template").render(data);
        );
    }
 }); 
```

在您的 HTML 中，您将拥有：

```
<ul id="my-list"></ul>

<script id="my-template" type="text/x-jsrender">
    {{for items}}
      <li>{{:name}}</li>
    {{/for}}
</script> 
```

假设您的 JSON 类似于：

```
item: [
    { name: "Name A" },
    { name: "Name B" },
    { name: "Name C" },
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T13:53:50.243

一旦 JSP 执行完毕，它生成的 HTML 代码就已经发送到浏览器，浏览器和 JSP 之间就没有任何联系了。如果要刷新页面的某些部分，则需要使用 AJAX 轮询服务器，或者使用 WebSockets 来保持页面与服务器之间的连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T13:58:25.540

要静默刷新页面，请使用 AJAX。下面是一些例子

**[示例 1](https://stackoverflow.com/questions/4802973/how-to-update-the-page-without-refresh)**

**[示例 2](https://stackoverflow.com/questions/3644585/html-change-update-page-contents-without-refreshing-reloading-the-page)**

**[谷歌搜索](https://www.google.com.kw/#hl=ar&site=&source=hp&q=ajax+update+page+without+refresh&oq=ajax+update+page+&aq=0L&aqi=g-L1&aql=&gs_l=hp.3.0.0i19.895.9988.0.12740.17.14.0.3.3.0.302.2375.3j5j5j1.14.0...0.0.7kVruYmWgoU&bav=on.2,or.r_gc.r_pw.,cf.osb&fp=228d09296ad03ad7&biw=1920&bih=1066)**

# request - 使用来自 PHP 客户端的 PUT 请求向 iCal 添加新事件？

> ID：10774447
> 
> 赞同：1
> 
> 时间：2012-05-27T13:49:47.153
> 
> 标签：request, icalendar, put, caldav

我正在尝试将 PHP 编写的日历与 Kerio Connect 日历（iCal）同步。我在连接日历和获取事件方面没有问题。但是当我尝试 PUT 任何新事件时，似乎添加了空事件，例如：

我的请求：

标题：PUT /calendars/localhost/marcin/Calendar HTTP/1.1 授权：基本 bWFyY2luOnJob21hbg== 主机：localhost:1212 If-None-Match：* 内容类型：text/icalendar 内容长度：367

请求：开始：VCALENDAR PRODID：-//Kerio Technologies//Kerio Connect//EN 方法：发布版本：2.0 X-VERSION-KMS：6.2.0 开始：VEVENT DTSTART；值=日期：20120528T163000 DTEND；值=日期： 20120528T170000 序列：0 摘要：测试事件类别：公共优先级：5 传输：不透明 X-MICROSOFT-CDO-BUSYSTATUS:BUSY X-LABEL:0 END:VEVENT END:VCALENDAR

响应：HTTP/1.1 201 创建 允许：OPTIONS、TRACE、GET、HEAD、DELETE、PUT、COPY、MOVE、PROPFIND、PROPPATCH、SEARCH、SUBSCRIBE、UNSUBSCRIBE、POLL、BDELETE、BCOPY、BMOVE、BPROPPATCH、BPROPFIND、LOCK、UNLO​​CK连接：关闭 内容长度：0 内容类型：文本/html 日期：2012 年 5 月 27 日星期日 13:33:04 GMT ETag：1f353abd967f4700b8dc18f4d4775ff30000003400000001 位置：/calendars/localhost/marcin/Calendar/ Repl-UID：ResourceTag：

不管我请求什么日期/主题，创建的事件总是如下所示：主题：日期：星期日，2012 年 5 月 27 日 15:33:04 +0200 内容类型：文本/日历；组件="事件"; 方法="发布"; charset="utf-8" 内容传输编码：8bit

BEGIN:VCALENDAR PRODID:-//Kerio Technologies//Kerio Connect//EN METHOD:PUBLISH VERSION:2.0 X-VERSION-KMS:6.2.0 BEGIN:VEVENT DTSTAMP:20120527T133304Z UID:10a69ad8-07f1-4831-a015-4de3dac78351 TRANSP :OPAQUE X-MICROSOFT-CDO-BUSYSTATUS:BUSY END:VEVENT END:VCALENDAR

所以没有主题，也没有日期（DTSTART，DTEND）；我尝试发送空请求：BEGIN:VCALENDAR BEGIN:VEVENT END:VEVENT END:VCALENDAR

结果是一样的。

我是 calDAV 的新手，最近几天我一直在尝试解决这个问题。如果有人可以帮助我并告诉我我做错了什么，那就太棒了。

最好的问候马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:58:07.277

我也有确切的问题。我推送了活动，但 kerio 没有显示主题或日期。这是我发现的工作（我只能让 curl 工作，没有 fsockopen 运气）：

```
$uid = "test-12345"; // setting this to an existing uid updates event, a new uid adds event
$url = $account['uri'].'/'.$uid.'.ics'; //http://mail.domain.com/calendars/DOMAIN/USER/Calendar/'.$uid.'.ics'
$userpwd = $account['user'] .":". $account['pass'];
$description = 'My event description here';
$summary = 'My event title 1';
$tstart = '201206015T000000Z';
$tend = '20120616T000000Z';
$tstamp = gmdate("Ymd\THis\Z");

$body = <<<__EOD
BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTAMP:$tstamp
DTSTART:$tstart
DTEND:$tend
UID:$uid
DESCRIPTION:$description
LOCATION:Office
SUMMARY:$summary
END:VEVENT
END:VCALENDAR
__EOD;

$headers = array(
    'Content-Type: text/calendar; charset=utf-8',
    'If-None-Match: *',
    'Expect: ',
    'Content-Length: '.strlen($body),
);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
curl_setopt($ch, CURLOPT_USERPWD, $userpwd);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PUT');
curl_setopt($ch, CURLOPT_POSTFIELDS, $body);
curl_exec($ch);
curl_close($ch); 
```

# php - 将单选按钮句柄添加到 ajax 脚本

> ID：10774449
> 
> 赞同：0
> 
> 时间：2012-05-27T13:50:06.950
> 
> 标签：php, javascript, ajax

此 ajax 函数获取一个文本框值并将其发送到`"response.php"`：（这是的主要功能`ajax.js`）

```
function ajaxFunction() {
  var getdate = new Date(); 

  if(xmlhttp) {

    var txtname = document.getElementById("txtname");

    xmlhttp.open("POST","response.php",true); 
    xmlhttp.onreadystatechange  = handleServerResponse;
    xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xmlhttp.send("txtname=" + txtname.value); 
  }
} 
```

我正在尝试将一个单选按钮添加到我的表单中，所以我将其更改为：

```
function ajaxFunction() {

  var getdate = new Date();  
  if(xmlhttp) {

    var txtname = document.getElementById("txtname");
    var radio = document.getElementById("radio2"); //ADDED

    xmlhttp.open("POST","response.php",true); 
    xmlhttp.onreadystatechange  = handleServerResponse;
    xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xmlhttp.send("txtname=" + txtname.value); 
    xmlhttp.send("radio=" + radio.value); //ADDED

  }
} 
```

在 response.php 中：

```
<?php

if (isset($_POST['txtname'])){
 $radio =  $_POST['radio'];

       //process...

}

?> 
```

输入文本仍然有效，但单选按钮无效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:36:40.783

将post参数绑定在一个并post

```
 var parameters = 'radio='+radio.value+'&txname='+txtname.value;
  xmlhttp.send(parameters); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:01:04.807

您的变量名似乎不是“radio2”而是“radio”。

```
<?php 
if (isset($_POST['txtname'])){
   // $radio =  $_POST['radio2']; // <-- here
   $radio =  $_POST['radio']; // fixed

     //process...
}
?> 
```

因为您以“无线电”的名义发布数据。

```
xmlhttp.send("radio=" + radio.value); //ADDED 
```

-----在下面添加了我的答案----

请尝试...

```
xmlhttp.send("txtname=" + txtname.value + "&radio="+ radio.value); 
```

或者

```
xmlhttp.send("txtname=" + txtname.value + "&radio2="+ radio.value); 
```

因为你不能使用 xmlhttp.send() 两次。

我希望这可以帮助你。

# freebase - Freebase MQL 读取服务结果的排序顺序

> ID：10774450
> 
> 赞同：1
> 
> 时间：2012-05-27T13:50:07.407
> 
> 标签：freebase, mql

我正在尝试使用 MID 列表获取项目列表

以前我问过这个问题[Array of Freebase MIDs and sent multiple queries to freebase](https://stackoverflow.com/questions/10613103/array-of-freebase-mids-and-sending-multiple-queries-to-freebase)

所以我的 MQL 查询现在看起来像这样：

```
[{
  "mid": null,
  "name": null,
  "topics:mid|=":[
    "/m/045c7b",
    "/m/0d6lp",
    "/m/021ympy",
    ...
    ]
}] 
```

[示例 MQL 查询 URL](https://www.googleapis.com/freebase/v1-sandbox/mqlread?query=%5B%7B%22mid%22:null,%22name%22:null,%22topics:mid%7C=%22:%5B%22/m/0tc7%22,%22/m/0h7pj%22,%22/m/02v406%22,%22/m/0gn30%22,%22/m/0m8_v%22,%22/m/015lhm%22,%22/m/0c1pj%22,%22/m/0c0k1%22,%22/m/01g969%22,%22/m/0hqly%22%5D%7D%5D)

但是，默认顺序似乎基于索引或时间戳之类的东西。我希望结果的顺序反映查询中列出的 MID 的顺序 - 这可能吗？如果是这样，任何关于 MQL 外观的提示都会很棒:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T17:56:35.620

使用 MQL 是不可能的 - 您必须在客户端进行排序。对于它的价值，默认顺序是未定义的，所以不要依赖它做任何事情。

# php - 动态返回 PHP 联系表单的值

> ID：10774458
> 
> 赞同：1
> 
> 时间：2012-05-27T13:51:06.047
> 
> 标签：php, html

我有一个基本的 PHP 联系表格，并有`process.php`一个检查表格内容的文件。我的表单工作正常，但我想在不完全刷新页面的情况下填充我的`returnstatus`div的内容。`$errors`我确定这是一项简单的任务，但我不知道如何去做。这是我的代码：

**联系表**

```
<?php session_start(); ?>

<html>
<head>
    <link rel="stylesheet" type="text/css" href="styles2.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
</head>
    <body>

        <div id="contact-form" class="clearfix">
            <h1>Get In Touch!</h1>
            <img id="stamp" src="images/stamp.png" height="128" width="128" alt="Stamp"/>
            <h2>
                Please provide as much information as possible for me to help you with your enquiry
            </h2>
            <div id="returnstatus">

            </div>  
            <form method="post" action="process2.php">
                <label for="name">Name: <span class="required">*</span></label>  
                <input type="text" id="name" name="name" placeholder="Joe Bloggs" required="required" /> 

                <label for="email">Email Address: <span class="required">*</span></label>  
                <input type="email" id="email" name="email" placeholder="joebloggs@example.com" required="required" /> 

                <label for="message">Message: <span class="required">*</span></label>  
                <textarea id="message" name="message" placeholder="Your message must be greater than 20 characters" required="required" data-minlength="20"></textarea>  

                <input type="text" name="check" class="check" />
                <span id="loading"></span>  
                <input type="submit" value="Send!" id="submit-button" />  
                <p id="req-field-desc"><span class="required">*</span> indicates a required field</p> 
            </form>
        </div>

    </body>
<html> 
```

**进程2.php**

```
<?php   

$name       = check_input($_POST['name']);
$email      = check_input($_POST['email']);
$message    = check_input($_POST['message']);

$errors = "";
if (empty($name)){
    $errors .= "Please fill out the first name field <br/> ";
}
if (empty($email)){
    $errors .= "Please fill out the email field <br/> ";
} else {
    $email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
    if(!preg_match($email_exp,$email)) {
        $errors .= 'The email address you entered does not appear to be valid<br />';
    }
}
if (strlen($message) < 21){
    $errors .= "Your message must be at least 20 characters";
}

if ($errors != "") {
    echo "<b>Message not sent</b><br/>";
    echo $errors;
} else {
    $errors = "<p>Thank you, $name, for your message.</p><p>I'll get back to you as soon as possible!</p>";
    echo $errors;
//send email if all is ok 
if ($_POST['check'] == '') {        //check to see if the hidden input entry is empty
    $headers = "From: {$email}" . "\r\n";  
    $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";  

    $emailbody = "<p>You have recieved a new message from the enquiries form on your website.</p> 
                                <p><strong>Name: </strong> {$name} </p> 
                                <p><strong>Email Address: </strong> {$email} </p> 
                                <p><strong>Message: </strong> {$message} </p>";
    mail("xxxxx@gmail.com","New Enquiry",$emailbody,$headers);  
    }
}  

function check_input($data)
{
    $data = trim($data);
    $data = stripslashes($data);
    $data = htmlspecialchars($data);
    return $data;
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:20:40.130

显而易见的答案是发送 AJAX 请求。[`jQuery.post()`](http://api.jquery.com/jQuery.post/)在 MooTools或[`Request.HTML`在 MooTools 中](http://mootools.net/docs/core/Request/Request.HTML)了解更多信息。下面的`handleSuccess`方法将 HTML 输出`process2.php`从`returnstatus`.

**[mootools](/questions/tagged/mootools "显示标记为“mootools”的问题") 1.4.5 示例**

```
(function(){
    var form = $$('#contact-form form')[0];
    var returnStatus = $('returnstatus');
    var handleSuccess = function(responseTree, responseElements, responseHTML, responseJavaScript) {
        returnStatus.set('html', responseHTML);
    };
    form.addEvent('submit', function() {
        new Request.HTML({
            url: form.get('action'), 
            onSuccess: handleSuccess
        }).post(form);
        return false;
    });
})(); 
```

**[jQuery](/questions/tagged/jquery "显示标记为“jquery”的问题") 1.7.2 示例**

```
(function(){
    var form = $('#contact-form form');
    var returnStatus = $('#returnstatus');
    var handleSuccess = function(data) {
        returnStatus.html(data);
    };
    form.submit(function() {
        $.post(form.attr('action'), form.serialize(), handleSuccess, 'html');
        return false;
    });
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:04:29.220

您需要发送 AJAX 请求，使用 jQuery 库您可以**序列化**表单数据并将 $.post 发送到 process2.php

# php - 运行第二个循环时取消设置数据

> ID：10774459
> 
> 赞同：0
> 
> 时间：2012-05-27T13:51:12.053
> 
> 标签：php, mysql, foreach

我想创建简单的投票系统。我有两个问题和两个答案。第一个问题有两个答案，但第二个问题没有任何答案。从某种意义上说，我想得到：

```
First question?
Answer1
Answer2

Second question? 
```

但我越来越

```
First question?
Answer1
Answer2

Second question?
Answer1 
Answer2 
```

第二个问题不需要有 Answer1 和 Answer2（与第一个问题的答案相同，但我在 mysql 中有两个答案）。

还有我的 foreach 循环。我需要如何更改循环？

```
foreach($sorular->soruCek($_GET["kategori"]) as $data) // Questions
{
    echo $data["soru"] . "<br/>";
    foreach($sorular->cevapCek($data["id"]) as $cevaplar) // Answers
    {
        echo $cevaplar["cevap"] . "<br/>"; // This needn't print data to below of Second Question
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T13:58:12.180

```
foreach($sorular->soruCek($_GET["kategori"]) as $data)
{
    $inner_data = $sorular->cevapCek($data["id"]);

    if ($inner_data) {
        echo $data["soru"] . "<br/>";

        foreach($inner_data as $cevaplar)
        {
            echo $cevaplar["cevap"] . "<br/>";
        }
    }
} 
```

您必须首先在内部循环中获取数据，在打印 - 我假设是 - 标题之前确保它具有值？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T13:58:04.780

要取消设置变量，您可以使用

```
unset($yourvariable); 
```

使用 `unset()`会破坏指定的变量。

# c# - 到达 ScrollViewer 的底部 - 最大 VerticalOffset 值低于 ScrollableHeight

> ID：10774462
> 
> 赞同：2
> 
> 时间：2012-05-27T13:51:27.553
> 
> 标签：c#, windows-phone-7, windows-phone-7.1, scrollviewer, vertical-scrolling

我在检测用户何时到达 ScrollViewer 底部时遇到问题。

我的代码：

```
bool atBottom = scrollViewer.VerticalOffset >= scrollViewer.ScrollableHeight; 
```

但有时当我到达 Scrollviewer 的底部时，scrollViewer.VerticalOffset 的值低于 scrollViewer.ScrollableHeight。它取决于列表框中的项目，但我不知道如何。

你知道，问题出在哪里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T10:49:15.210

您不应该使用这种方法来检测到达滚动查看器的底部。相反，您应该使用滚动状态来检测这一点。

请参阅[http://blogs.msdn.com/b/slmperf/archive/2011/06/30/windows-phone-mango-change-listbox-how-to-detect-compression-end-of-scroll-states.aspx](http://blogs.msdn.com/b/slmperf/archive/2011/06/30/windows-phone-mango-change-listbox-how-to-detect-compression-end-of-scroll-states.aspx)

# c++ - 如何从文件中读取变音符号？

> ID：10774463
> 
> 赞同：0
> 
> 时间：2012-05-27T13:51:37.653
> 
> 标签：c++, visual-studio-2010, file

我正在创建一个程序来读取一些文件。在阅读其中 1 个文件时，我在文件中遇到了一些变音符号。我应该如何读取这些字符并将它们存储在字符串中？目前我正在使用`string::getline()`无法读取这些字符并且读取指针的位置没有增加。该字符在一行中，前面有一些空格。所以我`ws`用来删除空格。我曾经`peek`理解这个问题；将鼠标悬停在 peek o/p char 上时，VS2010 显示 y 上面有 2 个点。所以我猜这是变音符号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T18:09:07.213

如果这是您需要的 - 此代码从德语文件 (UTF-8) 文本中读取，在控制台上打印并保存在输出文件中 -

```
#include <sstream>
#include <iostream>
#include <fstream>
//To handle localized input -
#include <windows.h>
#include <conio.h>

int main()
{

//read from file - 
    std::ifstream stream("c:\\temporary\\in.txt");
    std::string line;

    if (stream.is_open()) 
    { 
        std::getline(stream, line);
    }

//print on console -
    if(!SetConsoleOutputCP(CP_UTF8)) { // 65001
        std::cerr << "Failed to set console output mode!\n";
        return 1;
    }
    HANDLE const consout = GetStdHandle(STD_OUTPUT_HANDLE);
    DWORD nNumberOfCharsWritten;
    const char* utf8 = line.c_str();
    if(!WriteConsoleA(consout, utf8, strlen(utf8), &nNumberOfCharsWritten, NULL)) {
        DWORD const err = GetLastError();
        std::cerr << "WriteConsole failed with << " << err << "!\n";
        return 1;
    }

//write to file -
    std::fstream myfile;
    myfile.open("c:\\Temporary\\out.txt",std::ios::out);
    if (myfile.is_open()) 
    { 

        myfile << line <<"\n"<<std::endl;
    } 
    myfile.flush();
    myfile.close();
    return 0;
} 
```

# php - 从一个表中的一行中提取链接数据到另一个表中的多行

> ID：10774469
> 
> 赞同：0
> 
> 时间：2012-05-27T13:52:35.580
> 
> 标签：php, mysql, select, join, associations

我正在创建一个游戏，并且遇到需要根据单行中列出的 ID 值从表（Table1）中选择名称。

行示例

```
行 ID 单元 1 单元 2 单元 3 单元 4

```

并说第 1 行填充了单位数据

```
wfmatch

行 ID 单元 1 单元 2 单元 3 单元 4
----- ----- ----- ----- -----
1 1 2 3 4

```

然后在我的第二个表（`Table2`）中，我有实际的名字

```
wfunits

单位 ID 名称
------ ----------
1 首件
2 第二项
3 第三项
4 第四项

```

在一个查询中或尽可能接近我希望能够获得从第一个表中列出的 ID 的名称，结果如下：

```
这是使用底部代码实现的最终结果。（+4 个名字）

行 ID 单元 1 单元 2 单元 3 单元 4
----- --------- ---------- --------- ----------
1 第一项 第二项 第三项 第四项

```

我已经尝试过 JOIN 语句，但到目前为止我一直缺乏关于如何正确使用它们的知识，我觉得这可能是获得结果的方法，我只是想不通。

编辑：尝试的代码

```
SELECT * FROM wfmatch AS t1 INNER JOIN wfunits AS t2 ON t1.crunit1 = t2.id WHERE t1.mid = 1 
```

结果：否定，只提供了一个名字。

工作最终结果：

```
SELECT
m.mid, u1.name AS Unit1, u2.name AS Unit2, u3.name AS Unit3, u4.name AS Unit4,
u5.name AS Unit5, u6.name AS Unit6, u7.name AS Unit7, u8.name AS Unit8
FROM wfmatch AS m  
INNER JOIN wfunits AS u1 ON m.crunit1=u1.id  
INNER JOIN wfunits AS u2 ON m.crunit2=u2.id 
INNER JOIN wfunits AS u3 ON m.crunit3=u3.id 
INNER JOIN wfunits AS u4 ON m.crunit4 =u4.id 
INNER JOIN wfunits AS u5 ON m.counit1=u5.id 
INNER JOIN wfunits AS u6 ON m.counit2=u6.id 
INNER JOIN wfunits AS u7 ON m.counit3=u7.id  
INNER JOIN wfunits AS u8 ON m.counit4 =u8.id 
WHERE mid=1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T18:40:43.353

您可能需要四个连接，每列一个，如下所示：

```
SELECT
  m.RefID,
  u1.Name AS Unit1,
  u2.Name AS Unit2,
  u3.Name AS Unit3,
  u4.Name AS Unit4
FROM Table1 AS m
  INNER JOIN Table2 AS u1 ON m.Unit1 = u1.UnitID
  INNER JOIN Table2 AS u2 ON m.Unit2 = u2.UnitID
  INNER JOIN Table2 AS u3 ON m.Unit3 = u3.UnitID
  INNER JOIN Table2 AS u4 ON m.Unit4 = u4.UnitID 
```

还有一种选择，虽然我不确定它是否会更好：

```
SELECT
  m.RefID,
  MAX(CASE u.UnitID WHEN m.Unit1 THEN u.Name END) AS Unit1,
  MAX(CASE u.UnitID WHEN m.Unit2 THEN u.Name END) AS Unit2,
  MAX(CASE u.UnitID WHEN m.Unit3 THEN u.Name END) AS Unit3,
  MAX(CASE u.UnitID WHEN m.Unit4 THEN u.Name END) AS Unit4
FROM Table1 AS m
  INNER JOIN Table2 AS u ON u.UnitID IN (m.Unit1, m.Unit2, m.Unit3, m.Unit4)
GROUP BY m.RefID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:11:28.707

这样的事情可能对你有用：

```
SELECT *
FROM table1 AS t1
INNER JOIN table2 AS t2 ON t1.id = t2.id
WHERE t1.rowid = ? 
```

# date - 在 Coldfusion 中处理日期

> ID：10774473
> 
> 赞同：0
> 
> 时间：2012-05-27T13:52:51.507
> 
> 标签：date, coldfusion

我正在存储两个日期开始/结束日期，以周为单位递增，因此，例如，我的开始日期为 05/31/2012，它将在 4 周后的 2012 年 6 月 28 日结束。

我需要弄清楚的是任何一天的“当前周”。我想输出为周数而不是日期。因此，如果今天是 06/08/2012 并且我的开始/结束日期是 05/31/2012，那么“当前周”将为 2。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T14:28:53.130

我想你想使用 dateDiff() 函数。基本上，您可以删除您的第一个日期和第二个日期，并以周为单位计算差异。

```
// Here's the function
dateDiff("datepart", "date1", "date2")

// Here are your datepart options
yyyy: Years
q: Quarters
m: Months
y: Days of year (same as d)
d: Days
w: Weekdays (same as ww)
ww: Weeks
h: Hours
n: Minutes
s: Seconds

// Here's your code:
StartOfMonth = "05/31/2012"; // date part 1 // pseudocode
Now = now(); // date part 2
WeeksDifference = DateDiff("ww", StartOfMonth, Now); 
```

# perl - 使用 Mediawiki::API 上传文件时出错

> ID：10774476
> 
> 赞同：2
> 
> 时间：2012-05-27T13:53:36.683
> 
> 标签：perl, mediawiki, mediawiki-api

我正在尝试使用 Mediawiki::API->upload 将图像上传到 mediawiki。为此，我正在使用以下代码：

```
use strict;
use MediaWiki::API;
use DateTime::Format::ISO8601;
use encoding 'utf8';
binmode STDERR, ":utf8"; 
use URI::Escape;
use warnings;
use MediaWiki::API;

 my $url="http://localhost/mediawiki";
 my $wiki_login="nguyenki";
 my $wiki_passwd="linh";
 my $wiki_domain="";
 chomp($wiki_login);
 chomp($wiki_passwd);
 chomp($wiki_domain);
 my $mediawiki;
 mw_connect_maybe();  
 # configure the special upload location.
 $mediawiki->{config}->{upload_url} = "$url/index.php/Special:Upload";

 my $name="fl.png"; # Name of fichier to upload

  # upload a file to MediaWiki
  open (my $toi, $name) or die "can't open UTF-8 encoded filename: $!";
  binmode $toi;
  my ($buffer, $data);
  while (my $n=read($toi, $buffer, 65536) )  {
    $data .= $buffer;
    print STDERR "$n bytes read\n";
  }
  close($toi);

  $mediawiki->upload( { title => $name,
                 summary => 'This is the summary to go on the Image:file.jpg page',
                 data => $data } ) || die $mediawiki->{error}->{code} . ': ' . $mediawiki->{error}->{details};

#To login to the wiki page
sub mw_connect_maybe {

    if ($mediawiki) {
        return;
    }
    $mediawiki = MediaWiki::API->new;
    $mediawiki->{config}->{api_url} = "$url/api.php";

    if ($wiki_login) {
        if (!$mediawiki->login({
            lgname => $wiki_login,
            lgpassword => $wiki_passwd,
            lgdomain => $wiki_domain,
        })) {
            print STDERR "Failed to log in mediawiki user \"$wiki_login\" on $url\n";
            print STDERR "(error " .
                $mediawiki->{error}->{code} . ': ' .
                $mediawiki->{error}->{details} . ")\n";
            exit 1;
        } else {
            print STDERR "Logged in with user \"$wiki_login\".\n";
        }
    }
} 
```

它产生了一个错误：HTTP::Message content must be bytes at /usr/share/perl5/HTTP/Request/Common.pm line 91 我不知道如何纠正它。有什么建议吗？

感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T14:33:47.323

编译指示`encoding`会破坏您的代码，将其删除。

*   [Perl 使用编码编译指示破坏 UTF 字符串](https://stackoverflow.com/questions/5363071/perls-use-encoding-pragma-breaking-utf-strings)
*   [为什么我的 Perl 测试因“使用编码“utf8”而失败？](https://stackoverflow.com/questions/492838/why-do-my-perl-tests-fail-with-use-encoding-utf8)
*   [在 Perl 中启用非 ASCII 字符](https://stackoverflow.com/questions/9924456/enabling-non-ascii-characters-in-perl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-23T00:52:40.930

Mediawiki::API 有一个错误。好吧，可能有一些错误，但至少有[这个](https://rt.cpan.org/Public/Bug/Display.html?id=106214)（或[那个？](https://rt.cpan.org/Public/Bug/Display.html?id=122928)）：它还没有移植到 1.22+ CSRF 保护登录系统。现在要登录 MediaWiki 站点，您需要分两步完成：首先获取一个令牌，然后使用该令牌登录。这是为了保护糟糕的网络浏览器用户，但不幸的是，这对我们的机器人作者来说意味着更多的痛苦。

MediaWiki::Bot 项目遇到了同样的问题，并通过[这个 commit](https://github.com/MediaWiki-Bot/MediaWiki-Bot/commit/884f07d943f4fa48fbc5c48ed8399b8b37639b13)解决了这个问题，这是如何修复代码的一个很好的例子。我能够绕过内置的 MediaWiki::API 登录机制构建一个简单的工作登录脚本：

```
#!/usr/bin/perl -w

use MediaWiki::API;

my $wiki = MediaWiki::API->new;
my $remote_url = 'http://localhost:1234/wiki';
my $username = 'WikiAdmin';
my $password = 'AdminPass';
my $wiki_domain = 'localhost';

$wiki->{config}->{api_url} = "${remote_url}/api.php";

print "getting a CSRF token\n";
my $query = {action => 'query',
             meta => 'tokens',
             type => 'login'};
my $ref = $wiki->api( $query );
my $token;
if ($ref) {
    $token = $ref->{query}->{tokens}->{logintoken};
} else {
    print 'failed: (error ' . $wiki->{error}->{code} . ': ' .
                    $wiki->{error}->{details} . ")\n";
}

$query = {action => 'login',
          lgtoken => $token,
          lgname => $username,
          lgpassword => $password,
          lgdomain => $wiki_domain,
};
$ref = $wiki->api( $query );
if ($ref && $ref->{login}->{result} eq "Success") {
    print "login worked\n";
} else {
    print 'failed: (error ' . $wiki->{error}->{code} . ': ' .
                    $wiki->{error}->{details} . ")\n";
} 
```

显然，这应该在上游修补，但希望它能让你继续前进。

# r - 从数据框中提取字符串

> ID：10774481
> 
> 赞同：5
> 
> 时间：2012-05-27T13:54:37.060
> 
> 标签：r, dataframe

我在 R 中有一个如下所示的数据框：

```
head(span_data)   

FECHA....DIA.Cá01TMax.Cá01HTMax.Cá01TMin.Cá01HTMin.Cá01TMed.Cá01HumMax.Cá01HumMin.Cá01HumMed.Cá01VelViento.Cá01DirViento.Cá01Rad.Cá01Precip.Cá01ETo
1 -------- --- -------- --------- -------- --------- -------- ---------- ---------- ---   ------- ------------- ------------- ------- ---------- ------- 
2  21-05-12 142     21.0     15:08      9.1      5:28     15.3       91.9       45.2        72.3           2.2         270.2    30.0        0.0    4.81
3  20-05-12 141     19.1     15:12     11.3      4:50     14.6       94.9       46.6       74.4           2.6         273.0    23.2       12.6     4.0
4  19-05-12 140     22.6     14:26     14.8     23:50     18.5       92.6       36.3       66.5           3.7         250.1    24.9        0.4    5.29
5  18-05-12 139     23.4     14:30     17.2     23:58     19.4       87.4       55.5       72.0           3.1         218.5    24.2        0.0    4.75
6  17-05-12 138     31.2     13:08     13.9      5:32     22.4       78.5       26.7       51.0           2.3         164.9    23.6        0.0    6.36 
```

现在，所有的行都是一个长字符串，我会将它们转换为数字。但是，当我想提取其中一行时，我得到

```
span_data[3,1]
[1] 20-05-12 141     19.1     15:12     11.3      4:50     14.6       94.9       46.6       74.4           2.6         273.0    23.2       12.6     4.0
4272 Levels: -------- --- -------- --------- -------- --------- -------- ---------- ---------- ---------- ------------- ------------- ------- ---------- -------  ... 
```

我不想要“级别”部分。如何仅提取字符串？（我确定这个问题之前已经回答过，但我只是不知道如何提出这个问题。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T14:01:49.007

可以试试...

```
a <- c("1-1","2-1","3-1")
b <- 1:3
ab<-as.data.frame(cbind(a,b))

x <- ab[3,1] # what you don't want 
x
#[1] 3-1
#Levels: 1-1 2-1 3-1

z <- as.character(ab[3,1]) # without levels as it is no longer a factor
z   
#[1] "3-1" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T20:07:24.713

你可以试试这个：

```
 newdat <- read.table(text=span_data[[1]], stringsAsFactors=FALSE) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-28T02:56:02.680

最好跳过前 3 (?) 行，并为 read.table 提供适当的 colClasses 参数。但是你可以很容易地从你所拥有的东西中得到你想要的东西：

```
as.character(span_data[3,1]) 
```

# php - PHPUnit：数据库测试的多个数据集

> ID：10774482
> 
> 赞同：7
> 
> 时间：2012-05-27T13:54:42.240
> 
> 标签：php, phpunit, fixtures, database-testing

是否可以在 PHPUnit 上加载多个平面 xml 数据集以加载大量夹具？

我们正在编写一个相当复杂的应用程序，并且 xml 数据集变得非常大，所以我想将它放入 2-3 个 xml 中。

这是测试用例的当前代码：

```
<?php

class My_TestBase extends Zend_Test_PHPUnit_DatabaseTestCase{ 

/**
 * Zend_Application
 * @var Zend_Application 
 */
protected $_application;

/**
 * Connection
 * 
 * @var Zend_Test_PHPUnit_Db_Connection
 */
private $_connection;

/**
 * Returns the test database connection.
 *
 * @link http://framework.zend.com/wiki/display/ZFPROP/Zend_Test_PHPUnit_Database+-+Benjamin+Eberlei
 * @return PHPUnit_Extensions_Database_DB_IDatabaseConnection
 */
protected function getConnection(){

    if($this->_connection === null){

        $Resources = $this->_application->getOption("resources");

        $conn = Zend_Db::factory($Resources["db"]["adapter"], $Resources["db"]["params"]);          
        $this->_connection = $this->createZendDbConnection($conn, $Resources["db"]["params"]["dbname"]);
    }

    return $this->_connection;
}

/**
 * Returns the test dataset.
 * 
 * @link http://framework.zend.com/wiki/display/ZFPROP/Zend_Test_PHPUnit_Database+-+Benjamin+Eberlei
 * @return PHPUnit_Extensions_Database_DataSet_IDataSet
 */
protected function getDataSet(){

    return $this->createFlatXMLDataSet(__DIR__."/seed_data.xml");
}

/**
 * Setup
 */
protected function setUp(){

    $this->_application = new Zend_Application(
        APPLICATION_ENV,
        APPLICATION_PATH . '/configs/application.ini'
    );
} 
```

}

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T01:50:23.517

您可以使用[复合数据集](http://www.phpunit.de/manual/3.6/en/database.html)。

从手册：

> 复合数据集对于将几个已经存在的数据集聚合成一个数据集非常有用。

```
public function getDataSet()
{
    $ds1 = $this->createFlatXmlDataSet('fixture1.xml');
    $ds2 = $this->createFlatXmlDataSet('fixture2.xml');

    $compositeDs = new PHPUnit_Extensions_Database_DataSet_CompositeDataSet();
    $compositeDs->addDataSet($ds1);
    $compositeDs->addDataSet($ds2);

    return $compositeDs;
} 
```

（上面的代码示例直接来自文档，但似乎缺少构造函数参数。文档在合成时允许在多个数据集中定义表也是不正确的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:27:59.243

免责声明：以下仅适用于 yaml 固定装置，由于某种原因，xml 固定装置 API**不**提供相同的功能（检查源代码），不要问我为什么，似乎我们应该能够添加多个表而不管夹具文件格式类型。

API 有点笨拙，这正是我不喜欢将 args 传递给构造函数的原因，尤其是在这种情况下，但请尝试以下操作（经过测试和工作）：

```
class MyTest extends PHPUnit_Extensions_Database_TestCase
{
    protected function getDataset()
    {
        $primary = new PHPUnit_Extensions_Database_DataSet_YamlDataSet('etc/fixture/dbname/table1.yml');

        $primary->addYamlFile('etc/fixture/dbname/table2.yml');
        $primary->addYamlFile('etc/fixture/dbname/table3.yml');

        return $primary;
    }
...
} 
```

# java - 寻找方法为酒店管理系统的预订和约会编写日历（用于 gui）

> ID：10774484
> 
> 赞同：2
> 
> 时间：2012-05-27T13:54:46.933
> 
> 标签：java, calendar

作为我们“软件工程和项目管理”课程作业的一部分，我们要做一个酒店管理软件。太胖了，它一直很好，但是，我确实对其中一个功能有疑问：如何在日历中直观地表示所有预订和/或约会......

起初我的想法是将数据库中的所有预订保存在一个数组列表中，然后使用 JTable 创建一个表，其中行代表房间，列代表天。然后在循环的帮助下，我会检查每一列，然后从数组中询问存储预订的位置，如果在那一天开始一些预订。如果是这样，我会突出显示单元格。但是我们的导师告诉我不要这样做，因为这只是太多不必要的工作，而是使用 java calendar api 来解决这个问题。

问题是，我一直在谷歌搜索，但我没有找到任何有用的教程或主题来帮助我弄清楚如何做我想做的事。不幸的是，由于我现在的时间能力，我不能花一整天的时间来寻找和测试通常最终无法按照我们想要的方式工作的东西。

简而言之，我们需要在日历中直观地表示活动的预订/约会，我们正在寻找最快和最简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:35:27.977

如果你很聪明，你可以让 db 引擎完成大部分工作。考虑这个未经测试的 MySQL 查询：

SELECT COUNT(*) AS cnt, DATEDIFF(booking_date, '2012-05-20') AS col FROM bookings WHERE booking_date BETWEEN '2012-05-20' AND '2012-05-27' GROUP BY booking_date;

这将为您提供当天的预订列和数量。从那里您只需遍历结果并完成表格。

编辑：如果您没有数据库访问权限，则应将数据存储在 HashMap 中，以便每次都进行 O(1) 查找而不是 O(n)。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-05-27T13:58:19.247

您可以创建一个 gmail 帐户并使用您的帐户提供的日历。然后您可以使用 google 的 API 将该日历导入网页

# java - 仅导入 Facebook 好友

> ID：10774485
> 
> 赞同：2
> 
> 时间：2012-05-27T13:55:30.257
> 
> 标签：java, android, facebook

几周前我开始在 Android 上编程。而且我有一些Java技能。

所以我正在创建一个需要获取 Facebook 好友列表的应用程序（只是名称而不是图片）。我用谷歌搜索，大多数人说“阅读 Facebook api”。如何获取好友列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T09:51:40.930

使用[Facebook 图形 API](https://developers.facebook.com/docs/reference/api/)。

要在 Android 应用程序中实现 Facebook Graph API，请使用 Facebook Android SDK - 您可以在[github](https://github.com/facebook/facebook-android-sdk)上找到它。[它包括一个名为Hackbook](https://github.com/facebook/facebook-android-sdk/tree/master/examples/Hackbook)的示例应用程序。[您可以在此处](https://developers.facebook.com/docs/mobile/android/hackbook)了解 Hackbook 的功能。通过阅读 Hackbook 的代码，您可以了解如何在 Android 上进行用户授权和登录 Facebook。

Hackbook 包含有关如何获取朋友列表的示例代码 - 请参阅[Facebook 开发人员页面上的](https://developers.facebook.com/docs/mobile/android/hackbook/#friends)[源代码](https://github.com/facebook/facebook-android-sdk/blob/master/examples/Hackbook/src/com/facebook/android/FriendsList.java)和详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:07:02.763

Friends.get 命令为您提供来自相应用户的所有朋友。您可以在此处找到 REST webservice 命令的描述[http://developers.facebook.com/docs/reference/rest/friends.get/](http://developers.facebook.com/docs/reference/rest/friends.get/)

如果你用 Java 编程，你需要 facebook java api [http://code.google.com/p/facebook-java-api/](http://code.google.com/p/facebook-java-api/)

这是一个简短的示例，如何连接到 facebook api 以及如何获取用户的朋友列表和进一步操作 [http://code.google.com/p/facebook-java-api/wiki/Examples](http://code.google.com/p/facebook-java-api/wiki/Examples)

# php - 如何使用 jQuery/Ajax 动态显示图像属性？

> ID：10774490
> 
> 赞同：0
> 
> 时间：2012-05-27T13:56:31.347
> 
> 标签：php, jquery, ajax, variables

我正在使用简单的画廊脚本，当用户点击缩略图时动态加载图像：

```
$(document).ready(function() {
$('.thumbnailB').live("click", function() {

$('#mainImage').hide();
    var i = $('<img />').attr('src',this.href).load(function() {
        $('#mainImage').attr('src', i.attr('src'));
        $('#imageWrap').css('background-image', 'none');
        $('#mainImage').fadeIn();
    });
    return false; 
```

这是脚本演示： http: [//www.micahcarrick.com/code/jquery-image-swap/index.html](http://www.micahcarrick.com/code/jquery-image-swap/index.html)

和 PHP，它使用文件名然后分解以在 image 下显示图像属性：

```
// this variable has to contain current image when user clicks on thumbnail
$filename  = "          "; 
$fileinfo = explode("-", $filename);
echo $filename;
?>
<BR><strong>Filesize :</strong>
<?php 
echo $fileinfo[1]; 
?>
<?php
    $resolution=$fileinfo[2]; 
    $res = explode("x", $resolution);
    ?> <BR><strong> Width : </strong><?php echo $res[0]; ?>
        <BR><strong> Height : </strong><?php echo $res[1]; ?>
</div> 
```

HTML：

```
<a href="/download/thumbnail/big/Photo01-310KB-500x381-thbig.png" class="thumbnailB">
<img src="/download/thumbnail/small/Photo01-310KB-500x381-thsmall.png" alt="Image 1"/>
</a>

<a href="/download/thumbnail/big/Photo02-328KB-500x353-thbig.png" class="thumbnailB">
<img src="/download/thumbnail/small/Photo02-328KB-500x353-thsmall.png" alt="Thumbnail 2"/>
</a>

<div id="imageWrap">
<img src="/download/thumbnail/big/Photo01-310KB-500x381-thbig.png" alt="Main Image" id="mainImage"/>
</div> 
```

如何获取图像名称并将其从 Jquery 传递到 $filename 变量到 PHP ？1）在页面加载时抓取并发送#mainImage图像名称，然后2）每次用户点击缩略图时抓取并发送.thumbnailB图像名称

我有很多图像 - 使用 Jquery/PHP 分解来显示图像属性将使我免于数据库输入，照片将存储在 Amazon S3 上，这就是为什么必须将信息（图像分辨率）编码到文件名或数据库中的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:31:55.887

从 JavaScript 与 PHP 脚本对话是使用**AJAX**完成的。因此，您必须使用“文件名”作为参数对 PHP 脚本进行 ajax 调用。PHP 脚本返回可以存储在 javascript 变量中的图像数据，然后根据需要显示。

```
filename= $('#imagetag').attr('src');
$.ajax({
type: "GET",
url: "some.php",
data: { file: filename }
}).done(function( img_prop) {
//code to display the image properties 
//$('image-prop').html(img_prop);
}); 
```

对于 1) 和 2)，您都必须进行 ajax 调用。因此，将鼠标单击绑定到 jquery ajax 调用。

# asp.net-mvc - 捕获发布到 MVC 3 应用程序的原始内容

> ID：10774493
> 
> 赞同：1
> 
> 时间：2012-05-27T13:57:59.793
> 
> 标签：asp.net-mvc

我有一个 MVC 3 应用程序，它有 JSON POST'ed 到一个动作。一切正常，但我需要开始记录原始入站 JSON blob（*或正在发送的任何其他内容*）。具体来说，我想捕获在命中目标操作之前失败的请求，以便我可以分析正在发布的数据的结构和/或内容问题。

在 MVC 3 中这样的事情可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T09:36:03.860

如果您想分析服务器的所有内容，请考虑使用 HTTP 模块：http: [//msdn.microsoft.com/en-us/library/ms227673.aspx](http://msdn.microsoft.com/en-us/library/ms227673.aspx)。

HTTP Module 是一个类，它允许您将其他操作附加到现有的请求流。您可以将代码附加到 BeginRequest 事件以记录请求详细信息，即使它不会到达控制器。

```
public class HelloWorldModule : IHttpModule {
    // In the Init function, register for HttpApplication 
    // events by adding your handlers.
    public void Init(HttpApplication application)
    {
        application.BeginRequest += 
            (new EventHandler(this.Application_BeginRequest));
    }

    private void Application_BeginRequest(Object source, 
         EventArgs e)
    {
        //Do something with HttpContext.Current.Request here
    } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T09:46:18.733

为什么要自己做。有一些开源解决方案可以很好地完成这项工作。最著名的可能是[log4net](http://www.codeproject.com/Articles/14819/How-to-use-log4net)，其次是[elmah](http://code.google.com/p/elmah/)，它基本上是一个 HTTP 模块

# android - AsyncTask onPostExecute 上的 NullPointerException

> ID：10774500
> 
> 赞同：0
> 
> 时间：2012-05-27T13:58:31.727
> 
> 标签：android, multithreading, progress-bar, android-asynctask

所以我正在尝试编写一个`AsyncTask`，其他`UI`功能似乎可以工作`onPostExecute`，例如膨胀和添加布局/视图但是当我尝试更改进度条的可见性时，我得到一个空指针异常。

我不是`onPostExecute`直接使用，而是使用 addObserver / 回调组合，该函数包含以下内容：

```
ProgressBar featuredLoading = (ProgressBar)featuredLayout.findViewById(R.id.featuredLoading);
featuredLoading.setVisibility(View.GONE); 
```

有任何想法吗？

编辑：似乎与异步任务无关，将其移到异步任务甚至执行之前（onCreateView）仍然会使程序崩溃...如何允许我更改 LinearLayout 属性但不能更改 ProgressBar？

# php - 域有太多连接 - 内存问题

> ID：10774502
> 
> 赞同：0
> 
> 时间：2012-05-27T13:58:39.103
> 
> 标签：php, apache

最近，我收到一封来自主机的电子邮件，说我网站的插件占用了网络服务器上的大量内存。

> “域“example.com”每小时有“24246”个连接。我检查了此帐户中的插件，发现大量访问以下插件。

```
root@host [~]# sh plugin.sh example.com
3417
151466 plugin1
13447 default
2664 gravatar
789 style.css
886 script.js
554307 audio_upload
595 vote 
```

> “另外，我发现 MaxRequestsPerChild 的值在 Apache 配置中非常高。我已将此值减小为“1000”。现在，服务器有足够的可用内存。”

```
total used free shared buffers cached
Mem: 1472 855 616 0 0 0
-/+ buffers/cache: 855 616

Swap: 0 0 0 
```

> “但是，连接到服务器的连接仍然很高，并且连接到域“example.com”并且每分钟获得超过 600 次点击。”

这让我想知道，可能是什么问题？

*(audio_upload插件用于上传服务器上的歌曲，然后用[html5播放器播放](http://jplayer.org/)。)*

# amazon-ec2 - 通过 C# 连接到 Amazon EC2 微实例

> ID：10774504
> 
> 赞同：1
> 
> 时间：2012-05-27T13:58:42.653
> 
> 标签：amazon-ec2, amazon-web-services

我正在尝试解决 Amazon EC2。我无法启动实例和所有；我想做的是从 Web 应用程序控制实例。

我已经设法使用以下代码从我的应用程序中启动和停止实例：

```
AmazonEC2 ecc2 = AWSClientFactory.CreateAmazonEC2Client();
ecc2.StartInstances(new StartInstancesRequest().WithInstanceId("ID")); 
```

我接下来要做的是连接到实例并启动远程连接（rdp）。根据我的阅读，我需要实例地址；如何做到这一点？是不是在我获得实例地址后，我就可以下载 rdp 文件并让实例从那里启动？

任何指导将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T19:50:42.243

如果您还没有这样做...我建议您花一点时间熟悉使用 Amazon 管理控制台 ( [https://console.aws.amazon.com/console/home](https://console.aws.amazon.com/console/home) ) 手动启动 EC2 实例和然后使用您首选的 RDP 客户端手动连接到它们。

一旦您停止手动流程，您就可以使用管理控制台来帮助排除故障并监控您的代码正在做什么......自动化 EC2 的挑战之一是流程运行时间很长......（阅读：慢）

# windows - 如何从 Assembly 正确调用 Windows API 方法

> ID：10774508
> 
> 赞同：5
> 
> 时间：2012-05-27T13:58:57.367
> 
> 标签：windows, winapi, assembly, dll

简而言之，我正在尝试手工组装（请不要问）

但是，我遇到了调用 API 函数的问题，比如从 win32 API 调用。在各种汇编语言中，您要做的就是包含或导入诸如“windows.lib”或“windows.inc”或类似的东西。问题是，这因汇编程序而异，甚至输出（二进制）看起来也不同；我想不通。

所以我的一般问题是：从 DLL 库调用 API 方法在二进制版本中和在 Windows PE 文件中的外观如何？

我尝试在互联网上四处寻找有关此的资源，但没有成功...

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2020-09-04T17:54:22.377

最好的方法是阅读有关 NTDLL 的微软文档，但显然只能通过付费阅读任何参考资料（使用[MSDN 服务](https://visualstudio.microsoft.com/pt-br/msdn-platforms/)）

另一种方法是：使用调试器，了解如何请求 NTDLL。

每一步的步骤和更多信息：

1.  首先，使用调试器并下载几个程序并找出它们对 NTDLL 的调用，内核调用的抽象层是什么，NTDLL 永远不会在同一个地址，出于安全原因，所以只能有一个始终指向的变量到ntdll，即ram中的一个变量寄存器。

2.  找出 NTDLL 使用什么决策机制来定义参数以及调用的目的。

参考资料：[Fasm 论坛](https://board.flatassembler.net/) [文章：如何直接调用 NTDLL](https://resources.infosecinstitute.com/calling-ntdll-functions-directly/#gref)

# scala - 在 Scala 中，我可以（某些 SIP 允许我）仅指定泛型方法的某些类型参数吗？

> ID：10774516
> 
> 赞同：5
> 
> 时间：2012-05-27T14:00:45.113
> 
> 标签：scala, type-inference, type-parameter

在 Scala 中调用带有类型参数的方法时，我经常尝试安排代码，以便类型推断器可以自行查找类型参数，而无需我填写它们。在某些情况下，它会失败，我必须手动提供它们。

大多数时候，这不是问题，但是对于具有多个类型参数的方法（例如，大多数需要隐式参数的方法`CanBuildFrom`），我想知道是否有一种方法可以通过只给它一个所需的类型来帮助类型推断器参数，并要求它尝试猜测其他参数。它看起来像在内部，无论如何它必须做这样的事情，因为它有时会产生形式为“预期类型`A[B, ?]`但得到`A[C, D]`”的错误消息，这意味着在 的两个类型参数中`A`，它可以找到第一个`B`但有没有关于第二个的信息。

**用例：** [Tomasz 的问题](https://stackoverflow.com/q/10774284/390581)，其中代码：

```
def firstAndLast[CC, A, That](seq: CC)(implicit asSeq: CC => Seq[A], cbf: CanBuildFrom[CC, A, That]): That = {
  val b = cbf(seq)
  b += seq.head
  b += seq.last
  b.result
} 
```

不能用 调用`List("abc", "def") map firstAndLast`，但这会起作用：

```
List("abc", "def") map firstAndLast[String, Char, String] 
```

在这个例子中，我的问题归结为：有没有办法告诉类型推断器`CC`参数应该是`String`，并要求它自己找出`A`and `That`？本质上，类似的东西，

```
List("abc", "def") map firstAndLast[CC = String] 
```

或者

```
List("abc", "def") map firstAndLast[String, <guess>, <guess>] 
```

我知道这些行不起作用；我正在寻找一种解决方法（或寻找已经讨论过的未来语言功能的指针，这可能会导致这种情况）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T16:19:50.710

不，你不能。有[类型 lambda](https://stackoverflow.com/q/8736164/53013) s 和`type`它本身可以用于类型（如在类和特征中），但不能用于类型参数。例如：

```
// Declaring a type alias
type StringMap[Elem] = Map[String, Elem]

// Calling an `def f[M[_]]` but passing a `Map`
f[({type l[A]=Map[String,A]})#l]

// note that f could also be called like this:
f[StringMap] 
```

# c++ - Qt，客户区的点击信号

> ID：10774517
> 
> 赞同：1
> 
> 时间：2012-05-27T14:00:55.580
> 
> 标签：c++, qt, click, signals, paint

我想使用 Qt 框架创建一个像 MS Paint 这样的程序，我想知道如何连接“clicked”信号，每次用户单击客户端区域中的程序窗口时都会激活该信号。Win32 API 中的 WM_LBUTTONDOWN 之类的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:07:08.893

QWidget中没有`clicked()`信号。

您必须继承 QWidget 并重新实现，这将通过或在包含标题之后为`mousePressEvent(QMouseEvent *event);`您提供坐标（在小部件的坐标系中） ： 。`event->pos();``event->x();``event->y();``#include <QMouseEvent>`

您可能对[Scribble Example](http://qt-project.org/doc/qt-4.8/widgets-scribble.html)感兴趣。

# c++ - QtSQL双重插入数据库

> ID：10774520
> 
> 赞同：4
> 
> 时间：2012-05-27T14:01:40.940
> 
> 标签：c++, sql, sqlite, qt

问题是当我执行 sql 插入查询（我使用 Qt Creator 和 sqlite）时，两个新行被添加到数据库中而不是一个。

这是代码块

```
void MainWindow::on_insertButton_clicked(){
 db.open();
 QString name = ui->nameLineEdit->text();
 QString queryString = "INSERT INTO highscores (name, score) VALUES '%1',%2";
 QSqlQuery query(queryString.arg(name).arg(score));
 query.exec();
} 
```

此代码应仅将值名称和分数插入数据库一次，但在查询 exec 之后插入两个相同的行。

有人知道有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T14:13:27.360

不是

```
QString queryString = "INSERT INTO highscores (name, score) VALUES '%1',%2"; 
```

你应该写

```
QString queryString = "INSERT INTO highscores (name, score) VALUES ('%1',%2)"; 
```

SQL 的`INSERT`命令需要**一个以逗号分隔的数据集列表**，`VALUES`每个数据集都*用括号括*起来，并带有它们的列值。

以下命令将一个元组插入表中`table`：

```
INSERT INTO table (col1, col2) VALUES (val1, val2); 
```

```
| col1 | col2 |
+------+------+
| val1 | val2 | 
```

因为您没有将这两个值放在括号中，所以您要求 SQLite 插入*两个数据集，每个数据集*都有*一个值*：

```
INSERT INTO table (col1, col2) VALUES val1, val2; 
```

```
| col1 | col2 |
+------+------+
| val1 |      |
| val2 |      | 
```

*（有趣的是，我用我的 SQLite 和 MySQL 安装对此进行了测试。当我完全省略括号时，它们都抛出了错误。但这可能取决于版本和您使用的一些选项。）*

## 请**永远不要**使用`QString::arg`来填写 SQL 查询的参数！

（或任何其他构建字符串的方法，如连接。）**这可能导致[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。**

为了使用可变参数构建语句，您应该使用[QSqlQuery 绑定值](http://qt-project.org/doc/qt-4.8/qsqlquery.html#approaches-to-binding-values)提供的*SQL 准备语句*：

```
QString queryString = "INSERT INTO highscores (name, score) VALUES (?,?)";
QSqlQuery query(queryString);
query.addBindValue(name);
query.addBindValue(score);
query.exec(); 
```

请注意，我没有在准备好的语句中引用字符串参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:05:37.880

看起来您的按钮单击事件被调用了两次。这通常是因为`connectSlotsByName(this);`被使用了两次。删除代码中的这一行，它应该可以工作。

# javascript - 自动提交表单在 chrome 中不起作用

> ID：10774523
> 
> 赞同：2
> 
> 时间：2012-05-27T14:01:55.283
> 
> 标签：javascript, html, forms, jquery-mobile

我有一个小问题，我不知道如何解决它。我有一个自动提交表单的页面，表单的操作是转到外部 url。表单在首次加载时不会自动提交，但如果我刷新页面就会这样做。那么这里发生了什么？

我的自动提交 javascript 是

```
<script type="text/javascript">
  window.onload = function()
   {
     document.subfrm.submit();
   }

</script> 
```

我的表单html是

```
<form name="subfrm" action="http://www.theexternalwebsite.com" method="post">
<input type="submit" value="Continue with Payment"> 
```

我可能做了一些非常愚蠢的事情，我的借口是我压力很大，而且还有许多迫在眉睫的最后期限。干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:54:47.907

对，破解了。在我之前的表格中，我把

```
data-ajax=false 
```

所以下一页被加载为普通的http..然后它按预期进行了重定向！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-27T14:20:26.627

这有效：

```
<html>
    <body onload="document.subfrm.submit()">
        <form name="subfrm" action="http://www.theexternalwebsite.com" 
                method="post">
            <input type="submit" value="Continue with Payment">
        </form>
    </body>
</html>​ 
```

演示：http: [//jsfiddle.net/bensg/1/](http://jsfiddle.net/bensg/1/)

# c# - C# 中的 MSAccess Conn (VS 2010)

> ID：10774524
> 
> 赞同：2
> 
> 时间：2012-05-27T14:02:03.103
> 
> 标签：c#, ms-access-2007

我正在使用 VS 2010 和 C#。我想连接到 C# 中的 MDB。'到目前为止，我所做的如下：

```
string strAccessConn = "Provider=Microsoft.ACE.OLEDB.4.0;Data Source=C:\\Databases\\"+DBname+".mdb";

DataSet myDataSet = new DataSet();
OleDbConnection myAccessConn = null;

try
{
    myAccessConn = new OleDbConnection(strAccessConn);

    OleDbCommand myAccessCommand = new OleDbCommand(Query, myAccessConn);
    OleDbDataAdapter myDataAdapter = new OleDbDataAdapter(myAccessCommand);

    myAccessConn.Open();
    myDataAdapter.Fill(myDataSet, "Table");
}
catch(Exception Ex)
{
    MessageBox.Show(Ex.ToString());
}
finally
{
    myAccessConn.Close();
} 
```

数据库返回有效的数据集...这不是 Access 2000 数据库的问题

但是，当我将连接字符串更改为

```
string strAccessConn = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Databases\\"+DBname+".mdb"; 
```

对于 MSAccess2007，找不到数据库路径，尽管存在异常，但仍会生成异常。我错过了任何参考吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:09:39.390

尝试将您的 Access 数据文件扩展名从`.mdb`更改为`.accdb`：

```
"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Databases\\"+DBname+".accdb"; 
```

请参阅[connectionstrings.com](http://www.connectionstrings.com/access-2007)以供参考。

# iphone - 单元格未出现在表格视图中

> ID：10774528
> 
> 赞同：2
> 
> 时间：2012-05-27T14:02:51.390
> 
> 标签：iphone, ios, uitableview

我有一个历史页面，它是一个有 5 行的 UItableview。我已将原型单元格设置为我想要的规格，并将此文本添加到相应的 historyviewcontroller.h 文件中：

```
-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
   return 5;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath           *)indexPath
{
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"HistoryItem"];
return cell;
} 
```

当我运行应用程序时，我没有看到任何单元格。我显然错过了一些东西，但我不太明白是什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T14:07:22.420

您需要实际创建单元格。dequeueReusableCellWithIdentifier 仅检索已创建的单元格，而不会创建新单元格。

这是如何做到的：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath           *)indexPath
    static NSString *CellIdentifier = @"HistoryItem"; 
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    //if cell is not nil, it means it was already created and correctly dequeued.
    if (cell == nil) {
        //create, via alloc init, your cell here
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    }
    return cell;
} 
```

# google-maps - 在 Google 地图上显示来自 Google 电子表格的数据

> ID：10774530
> 
> 赞同：4
> 
> 时间：2012-05-27T14:02:59.020
> 
> 标签：google-maps, google-sheets

我想要一张显示全球论坛用户位置的谷歌地图，该地图将从谷歌电子表格中填充（谷歌电子表格将反过来从谷歌表格中填充）

将电子表格中的数据转换为 Google 地图的格式应该是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T16:21:30.427

我会将纬度和经度信息放在两列中，然后将电子表格推送到 Fusion Table。然后，您可以使用 Fusion Table Layers 将融合表加载到谷歌地图中。

[https://developers.google.com/maps/documentation/javascript/layers#FusionTables](https://developers.google.com/maps/documentation/javascript/layers#FusionTables)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-22T22:47:23.250

您可以使用名为[GeoSheets](http://www.geosheets.com)的免费工具对论坛用户的位置进行地理编码，并将其直接从 Google 电子表格直接绘制在地图上。如果您有匿名用户，您可以传递物理地址甚至 IP 地址。

```
=GEO_ADDRESS("1600 Pennsylvania Ave")
=GEO_IP_GEOCODE("72.14.192.0") 
```

然后在地图上绘制这些地址很简单：

```
=GEO_MAP(A1:A2,"forum-users") 
```

查看[文档](http://www.geosheets.com/docs)以获取有关如何自定义和嵌入地图的更多信息。

# ruby-on-rails - 回形针附件的后台处理

> ID：10774532
> 
> 赞同：4
> 
> 时间：2012-05-27T14:03:27.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip, delayed-job

我使用[回形针](https://github.com/thoughtbot/paperclip)和[delayed_job](https://github.com/collectiveidea/delayed_job)已经有一段时间了。[delay_paperclip](https://github.com/jstorimer/delayed_paperclip) gem 对我来说是一种很好的粘合剂。它帮助我将其他样式的繁重处理放入延迟作业中，在工作服务器上处理。此外，很高兴了解附件是否仍在排队或处理中。

我现在的问题是，delayed_pa​​perclip 自 4 个月以来不再维护，而且回形针向前迈出了一大步。所以我被卡住了。

谁能给我一个提示，我可以用什么来替代？

如果可能的话，我不想离开回形针和delayed_job。此外，附件必须在不同的服务器上处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T18:25:55.903

听起来回形针的一些更新打破了这个宝石。有一些拉取请求处于待处理状态，但在这些请求被接受并发布新的 gem 之前，您可以像这样在 Gemfile 中引用更新的 gem：

```
gem 'delayed_paperclip', :git => 'git://github.com/tommeier/delayed_paperclip.git', :ref => '98a8b9e0c24d24c94e2c9c39a704c1b07c5c4d6b' 
```

# ios - AVPlayer 工作但在子视图中不可见

> ID：10774533
> 
> 赞同：2
> 
> 时间：2012-05-27T14:03:34.600
> 
> 标签：ios, uikit, avplayer

单击按钮后，我正在尝试添加子视图，然后将其置于前面并添加 AVPlayer 实例以播放广播流。音频正在播放，但 AVPlayer 不可见，我不确定如何使 AVPlayer 可见并将其放在子视图中。我一直在 Apple Library 中搜索示例和信息，但效果不佳。

下面是调用方法：

```
- (IBAction)radioButton:(id)sender {

    radioButton.selected=TRUE;
    twitterButton.selected=FALSE;

    [self.view bringSubviewToFront:radioView];
    radioView.hidden = FALSE;

    NSURL *url = [NSURL URLWithString:@"http://streaming3.radiocat.net:80/"];
                  // You may find a test stream at <http://devimages.apple.com/iphone/samples/bipbop/bipbopall.m3u8>.
    self.playerItem = [AVPlayerItem playerItemWithURL:url];

    //[playerItem addObserver:self forKeyPath:@"status" options:0 context:&ItemStatusContext];

    self.player = [AVPlayer playerWithPlayerItem:playerItem];
    [self.player play];
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:05:44.630

AVPlayer 没有自己的 UI，您必须自己从 UIKit 类创建它，并将相关的 IBAction 消息从它们的操作连接到控制 AVPlayer 实例的方法。

# c++ - 存储多个插件（不同类的对象）并相互访问

> ID：10774536
> 
> 赞同：2
> 
> 时间：2012-05-27T14:03:52.950
> 
> 标签：c++, qt, dll

我有几个从基类推迟的类`File_plugin`。我想在 class 的每个实例中都有每个类的实例`File`。这是一个天真的实现：

```
class File {
public:
  File(): plugin1(this), plugin2(this), /*... */ {}
  Plugin1 plugin1;
  Plugin2 plugin2;
  Plugin3 plugin3;
  Plugin4 plugin4;
}; 

class File_plugin {
public:
  File_plugin(File* p_file): file(p_file) {}

protected:
  File* file;
};

class Plugin1: public File_plugin {
  void some_action() {
    //we can access another plugin as:
    Plugin2* p2 = &( file->plugin2 );
  }
}; 
```

但是`File`类必须知道所有插件的实现是很糟糕的。我们通常在任何可能的地方都使用类的前向声明。所以，`File`一定不知道插件的实现，甚至不知道类名的列表。一些插件会在运行时从 DLL 加载，所以我们在编译时不知道它们的名称。

此外，插件必须不知道几乎所有其他插件的存在。但是如果一个插件知道其他插件，它必须能够获取这个插件的对象并使用它。

现在我正在使用以下实现：

```
class File {
public:
  File() : plugins(Plugins_registry::get_file_plugins(this)) { }

  template<class T>
  T *get_plugin() {
    foreach(File_plugin *p, plugins) {
      T* o = dynamic_cast<T*>(p);
      if (o) return o;
    }
    throw Bad_exception(tr("File plugin not found"));
  }
private:
  QList<File_plugin*> plugins;
}

QList<File_plugin*> Plugins_registry::get_file_plugins(File* file) {
  QList<File_plugin*> list;
  list << new Plugin1(file);
  list << new Plugin2(file);
  list << new Plugin3(file);
  list << new Plugin4(file);

  //code below is untested
  QPluginLoader loader("plugin5.dll");
  list << dynamic_cast<My_plugin_class>(loader.instance)->get_file_plugin();

  return list;
}

class Plugin1: public File_plugin {
  void some_action() {
    //we can access another plugin as:
    Plugin2* p2 = file->get_plugin<Plugin2>();
  }
}; 
```

一些插件可以存储在外部库中（在 Windows 上表示为 DLL）。它现在没有实施，但将来会实施。我认为我当前的实现允许这样做，但我没有检查。

这种实现的最大问题是插件搜索速度慢（使用`for`and `dynamic_cast`）。所以我不能只是`get_plugin`到处调用，我必须存储返回值并将其用于快速访问。不舒服。此外，这个解决方案看起来并不完美。有没有办法让它变得更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T16:22:02.527

这是一个如何通过为每种插件类型创建映射来实现它的示例：

```
class File {
public:
  File() { }

  template<class T>
  T *get_plugin() {
    T *result = T::getInstance(this);
    if (!result) {
      throw Bad_exception(tr("File plugin not found"));
    }
    return result;
  }
};

class File_plugin {
  public:
    File_plugin(File *file)
    : file(file)
    {
    }

  protected:
    File *file;
};

template <class Plugin>
class Basic_File_Plugin : public File_plugin {
  public:
    Basic_File_Plugin(File *file,Plugin *plugin)
    : File_plugin(file)
    {
      instances[file] = plugin;
    }

    ~Basic_File_Plugin()
    {
      instances.erase(file);
    }

    static Plugin *getInstance(File *file)
    {
      return instances[file];
    }

  private:
    static std::map<File *,Plugin *> instances;
};

template <class Plugin>
std::map<File *,Plugin *> Basic_File_Plugin<Plugin>::instances =
  std::map<File *,Plugin *>();

class Plugin1 : public Basic_File_Plugin<Plugin1> {
  public:
    Plugin1(File *file)
    : Basic_File_Plugin<Plugin1>(file,this)
    {
    }

    void some_action();
};

class Plugin2 : public Basic_File_Plugin<Plugin2> {
  public:
    Plugin2(File *file)
    : Basic_File_Plugin<Plugin2>(file,this)
    {
    }
};

void Plugin1::some_action()
{
  Plugin2 *p2 = file->get_plugin<Plugin2>();
} 
```

# perl - 如何访问其他文件中的会话变量

> ID：10774538
> 
> 赞同：0
> 
> 时间：2012-05-27T14:04:15.643
> 
> 标签：perl, session

```
# Object initialization:
use CGI::Session;

$session = CGI::Session->new();

$CGISESSID = $session->id();

# Send proper HTTP header with cookies:

print $session->header();

# Storing data in the session:

$session->param('User_id', 'U00002'); 
```

这个脚本写在某个文件中，比如 abc.pl。

现在我想访问其他 perl 文件中的 User_id，比如 xyz.pl。怎么做？我需要对此脚本进行任何更改吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T12:16:32.180

```
use CGI::Session qw();
my $s = CGI::Session->new;
$s->param(User_id => 'U00002');
my $id = $s->id; # e.g. '4cd29ac608405e4d0a463d153e64defd' 
```

将 id 传递到需要的地方。

```
use CGI::Session qw();
my $s = CGI::Session->new($id);
print $s->param('User_id'); # 'U00002' 
```

# c# - 为什么会话返回 null？

> ID：10774544
> 
> 赞同：2
> 
> 时间：2012-05-27T14:05:11.717
> 
> 标签：c#, asp.net, session

我无法写入会话变量。

这是我的源代码：

```
 public class CurrentUser
    {

        public static string UserName
        {
            get
            {
                if (HttpContext.Current.Session["UserName"] != null)
                    return (string)HttpContext.Current.Session["UserName"];
                else
                    return null;
            }

            set
            {
                HttpContext.Current.Session["UserName"] = value;
            }
        }
    } 
```

我称这个类为写：

```
public class SQLGetData
    {

        public UserDC LogIn()
        {

            UserDC userDC = new UserDC();

            CurrentUser.Id = 1;
            CurrentUser.UserName = "Admin"; 

            userDC.id = 1;
            userDC.UserName = "Admin";

            return userDC;
        }

    } 
```

当我想打电话时（MasterPage.aspx）：

```
Label1.Text = CurrentUser.Id + CurrentUser.UserName; 
```

**结果：** CurrentUser.Id 为**1**并且 CurrentUser.UserName 为**NULL**。

为什么 CurrentUser.UserName 为 NULL？如何修改这个公共字符串 UserName 来写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T19:41:05.570

从您共享的代码中，我们无法真正帮助您，因为我们只能尝试猜测正在发生的事情。

我假设您的 CurrentUser 类有一个 Id 属性，其代码与用户名相似。Id 属性按预期工作，但不是用户名……这听起来很奇怪。

你能分享你班级的完整代码吗？或者至少是 Id 属性的代码？

然后它也将有助于理解从哪里调用 SQLGetData 类。身份验证如何工作？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T15:11:42.353

我对这种会话空场景的智慧表明 - 您的应用程序中发生了隐藏的错误，但没有发现。代码中的任何异常都会终止会话并可能继续新会话，因此值为空......

最好的方法，在带有调试->异常菜单的 vs ide 中运行您的开发环境代码，在所有异常处理程序上运行应用程序并运行多个场景，最终您会意识到从简单的错误（如 convertToInt 或类似的参考错误）开始存在隐藏错误，这导致会话变为空......但正如我猜想的那样，事情并没有在“错误”页面中出现错误，而是通过上面的“调试”找到了所有异常选项。

希望能帮助到你！海德科技

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-29T22:00:06.007

您应该首先通过使用将“用户名”引入您的会话

```
HttpContext.Current.Session.Add("UserName", value) 
```

在你的二传手。

```
public class CurrentUser     
{          
 public static string UserName         
 {             
    get             
    {                 
      if (HttpContext.Current.Session["UserName"] != null)                     
         return (string)HttpContext.Current.Session["UserName"];
      else                     
         return null;             
    }              
    set             
    {                
      if (HttpContext.Current.Session["UserName"] == null)
         HttpContext.Current.Session.Add("UserName", value);
      else
         HttpContext.Current.Session["UserName"] = value;            
    }         
  }     
} 
```

这样做之后，它应该像你写的那样工作。

# php - 通过元数据进行 Wordpress 搜索

> ID：10774547
> 
> 赞同：2
> 
> 时间：2012-05-27T14:05:42.760
> 
> 标签：php, wordpress, search

这是我想要实现的目标：

我有一个自定义搜索表单来搜索基于各种元数据的帖子。

此代码包含 WordPress 搜索的设置：[http](http://pastebin.com/5dj16Atj) ://pastebin.com/5dj16Atj 对自定义字段的引用都在其中。

此代码在上面的文件中引用，并包含自定义搜索表单的实际布局：http: [//pastie.org/private/yebozm9kaqazywkilr8fkq](http://pastie.org/private/yebozm9kaqazywkilr8fkq)

我的主要问题是自定义搜索表单中只有 3 个字段有效，即；价格范围和面积。其余字段，例如属性类型 (srch_ptype)、年龄 (srch_age) 和城市，只是不会作为搜索条件显示。我希望所有字段都能正常工作，并在人们搜索时作为标准包含在内。请看一下这两个文件，看看我做错了什么。

非常感谢。

编辑： adomnom 很友好地建议我使用 wp_query 进行搜索。如果有人能告诉我如何将搜索表单与查询联系起来，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T04:51:48.000

我对这个有意见。我建议查看[get_posts()](http://codex.wordpress.org/Template_Tags/get_posts)或[query_posts()](http://codex.wordpress.org/Function_Reference/query_posts)，甚至用特殊的钩子覆盖默认的 wordpress 搜索。

你应该能够做类似的事情......

* * *

定义搜索的参数（更多在[WP_Query Page](http://codex.wordpress.org/Class_Reference/WP_Query)）并运行它

```
$searchArgs = array(
    'post_type' => 'post',
    'meta_query' = array(
        'relation' => 'AND',
        array( 'key' => 'srch_age',   'value' => $_REQUEST['srch_age'] ),
        array( 'key' => 'srch_ptype', 'value' => $_REQUEST['srch_ptype'] )
        // ... Add as many other criteria as you need
    )
);

query_posts( $searchArgs );
while( have_posts() ): the_post();
... 
```

# c - pthreads：以编程方式收集有关不同状态所花费时间的信息？

> ID：10774551
> 
> 赞同：6
> 
> 时间：2012-05-27T14:06:03.807
> 
> 标签：c, linux, pthreads

在 C、Linux 3.2 中：有没有办法以编程方式收集`pthread`某个程序上每个已创建线程的状态的统计信息？例如，我想获取每个线程运行和处于空闲状态的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:48:10.977

`clock_gettime()`可以返回线程特定的 CPU 时间。只需这样做：

```
struct timespec ts;
clock_gettime(CLOCK_THREAD_CPUTIME_ID, &ts); 
```

但据我了解，这是该线程的用户和系统时间的总和。您还应该考虑手册页末尾有关 SMP 系统的警告消息。

此外，如果您不想要当前线程上的计时信息，但在某些 pthread 上，您可以`clockid_t`使用`clock_gettime()`using `int pthread_getcpuclockid(pthread_t thread, clockid_t *clock_id)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:34:09.680

[getrusage()](http://linux.die.net/man/2/getrusage)

编辑：为了获得空闲时间，我会从线程处于活动状态的总时间中减去系统和用户时间。

可用于探测的其他工具包括：system tap、swtrace、tprof、oprofile、perf、sysprof、ptt 等。

# view - 查看其他用户的终端 FreeBSD

> ID：10774553
> 
> 赞同：1
> 
> 时间：2012-05-27T14:06:22.297
> 
> 标签：view, terminal, freebsd

我不记得如何做到这一点，但我似乎记得这是可能的：

我想查看其他已登录用户的终端 (TTY)，显示当我查看他们的终端时用户所做的所有事情。我将如何连接到他们的终端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T02:12:34.247

本 BSD 指南是否回答了您的问题？

[观看终端活动](http://www.bsdguides.org/2005/watch-terminal-activity/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:09:17.433

为了使用 watch，您必须在构建内核时安装 snp（窥探设备）模块。

# java - CompareTo 与 Equals！比较字符串还是对象？

> ID：10774559
> 
> 赞同：-1
> 
> 时间：2012-05-27T14:07:11.983
> 
> 标签：java, string, compareto, string-comparison

快速提问

我正在比较一个字符串，我应该使用 equals 还是 compareTo？因为我虽然 equals 区分了 2 个 String 类型的对象，而不仅仅是它们的值......

这可能会导致问题，因为：

```
String a = new String("lol");
String b = new String("lol"); 
```

即使它们具有相同的值，它们是两个不同的对象吗？

就性能和精度而言，equals 和 compareTo 实现之间到底有什么区别？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-27T14:08:25.923

你试过了吗？

```
String a = new String("foo");
String b = new String("foo");

System.out.println(a == b); // false
System.out.println(a.equals(b)); // true
System.out.println(a.compareTo(b)); // 0 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-27T14:13:58.327

首先`==`比较引用以查看两个对象是否相同（对象上也是如此`==`）。

然后在求两个字符串内容的差异的`String.equals()`同时验证两个字符串内容的相等性。`String.compareTo()`

所以以下两个测试是等价的：

```
String str = "my string";

if ( str.equals("my second string")) {/*...*/}
if ( str.compareTo("my second string")==0) {/*...*/} 
```

但是，由于`String.equals`首先进行参考检查，因此在针对 使用时是安全的`null`，而`String.compareTo`将抛出`NullPointerException`：

```
String str = "my string";

if ( str.equals(null)) {/* false */}
if ( str.compareTo(null) {/* NullPointerException */} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-28T06:16:49.173

```
 String a = new String("lol");
    String b = new String("lol");

    System.out.println(a == b); // false. It checks references of both sides operands and we have created objects using new operator so references would not be same and result would be false.
    System.out.println(a.equals(b)); // true checks Values and values are same
    System.out.println(a.compareTo(b)); //  checks for less than, greater than or equals. Mainly used in sortings. 
```

# macos - NSWindow Background Magnify

> ID：10774562
> 
> 赞同：1
> 
> 时间：2012-05-27T14:08:04.133
> 
> 标签：macos, cocoa, nswindow

I know it is possible to blur the background of an NSWindow, but is it possible to magnify whatever is behind the window and show it, or even do the same for the window's content view?

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T15:05:34.463

Take a look at Apple's example **CIAnnotation**. You can download sample code from [here](https://developer.apple.com/library/mac/#samplecode/CIAnnotation/Introduction/Intro.html).

CIAnnotation app example:

![enter image description here](../Images/5ad22bad113a8499aa035fd559e9da7b.png)

References and guides which can help You with this:

[Core Image Programming guide](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/CoreImaging/ci_intro/ci_intro.html)
[Quartz 2D Programming Guide](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/Introduction/Introduction.html)
[NSGraphicsContext Class Reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSGraphicsContext_Class/Reference/Reference.html)

# c++ - 通过实时按键停止循环

> ID：10774563
> 
> 赞同：1
> 
> 时间：2012-05-27T14:08:14.690
> 
> 标签：c++, for-loop

我写了一个简单的计时器。通过按“s”（不按 enter 提交），计时器（for-loop）将启动。这是一个没有尽头的循环。我想在用户按下“s”后立即停止它，就像我启动它的方式一样。只要按“s”（不按 enter 提交），循环就会停止。怎么做？

```
#include <iostream>
#include <stdlib.h>
#include <conio.h>
using namespace std;

int main()
{
    char ch;
    int m=0,h=0;
    if ((ch = _getch()) == 's')
        for (int i=0;;i++)
        {
            cout << "h   m   s" << endl;
            cout << h << "   " << m << "   " << i;
            system("CLS");
            if (i==60) {i=0;m+=1;}
            if (m==60) {m=0;h+=1;}
            if (h==24) {h=0;}
        }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:10:11.600

有一个单独的`volatile`变量用作退出循环的条件。

在单独的线程上（监听用户输入并同时保持循环继续进行的唯一方法）在用户按下时修改变量`"s"`。

```
volatile bool keepLoopGoing = true;

//loop
for (int i=0; keepLoopGoing ;i++)
    cout << i << endl;

//user input - separate thread
while ( keepLoopGoing )
{
   cin >> input;  // or getchar()
   if ( input == "s" )
      keepLoopGoing = false;
} 
```

**请注意**`i`，在您按下任何内容之前，您很可能会溢出。

# javascript - 使用 HTML、CSS 和 JS 构建桌面应用程序的替代方案

> ID：10774564
> 
> 赞同：-1
> 
> 时间：2012-05-27T14:08:18.207
> 
> 标签：javascript, html, css, desktop-application

> **可能重复：**
> [您可以使用 JavaScript 进行桌面开发吗？](https://stackoverflow.com/questions/109399/can-you-do-desktop-development-using-javascript)

是否有其他工具可以使用 HTML、CSS 和 JS 构建桌面应用程序？由于 Mozilla 的 Chromeless Browser 已经停止开发，Titanium 的新版本只专注于移动应用程序。你知道像 Chromeless/Titanium 这样具有类似功能的工具是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:46:08.827

[Adobe Air](http://www.adobe.com/devnet/air.html)应该适合您。它创建了一个桌面应用程序，它基本上是一个 webkit 包装器。然后，您可以直接在 HTML、CSS、JS 甚至 Flash 中构建您的应用程序。它有几组 JS API，您可以学习这些 API 用于文件访问等本地操作。

最新版本的 AIR 将运行时与应用程序一起预打包，这使您的应用程序独立，并且不需要在目标客户端上安装 AIR 平台。

为了便于开发，[Aptana Studio 2](http://www.aptana.com/products/studio2)有一个插件，可以帮助您开发 AIR 应用程序并自动化您的大部分 AIR 应用程序构建，例如包编译、应用程序预览等。不过它已经过时了（AIR 1.5 和 AIR 2 beta），您可能想要更新 SDK。你也可以在谷歌上搜索如何调整编译器选项来构建一个独立的应用程序。

# c - 在C中合并多个排序数组

> ID：10774566
> 
> 赞同：6
> 
> 时间：2012-05-27T14:08:20.267
> 
> 标签：c, debugging, sorting, mergesort

试图合并 8 个预先排序的数组。我对C相当陌生，但这是我迄今为止想出的。不用说它不起作用。我想不通的是为什么。我在[这里](http://www.algolist.net/Algorithms/Merge/Sorted_arrays)基于 C++ 合并排序实现，并尝试将其扩展到 8 维并稍微简化它，但由于某种原因，它倾向于给我第一个数组的元素，然后是 34、30，然后它重复 23直到最后。它甚至没有发现 21 是第一次迭代中的最小值。

```
int test1[5] = {23, 24, 25, 33, 51};
int test2[5] = {21, 34, 44, 50, 62};
int test3[5] = {34, 36, 41, 44, 46};
int test4[5] = {30, 31, 32, 35, 40};
int test5[5] = {54, 56, 57, 58, 60};
int test6[5] = {31, 33, 36, 51, 52};
int test7[5] = {44, 46, 76, 78, 79};
int test8[5] = {23, 33, 43, 54, 63};

int output[40];
int t1, t2, t3, t4, t5, t6, t7, t8;
t1 = 0;
t2 = 0;
t3 = 0;
t4 = 0;
t5 = 0;
t6 = 0;
t7 = 0;
t8 = 0;
int p = 0;
int temp1;
int temp2;

while(p < 40) {
    if (t1 < 5) {
        temp1 = 1;
        temp2 = test1[t1];
    }else if (test2[t2] <= test1[t1] && t2 < 5) {
        temp1 = 2;
        temp2 = test2[t2];
    }else if (test3[t3] <= temp2 && t3 < 5) {
        temp1 = 3;
        temp2 = test3[t3];
    }else if (test4[t4] <= temp2 && t4 < 5) {
        temp1 = 4;
        temp2 = test4[t4];
    }else if (test5[t5] <= temp2 && t5 < 5) {
        temp1 = 5;
        temp2 = test5[t5];
    }else if (test6[t6] <= temp2 && t6 < 5) {
        temp1 = 6;
        temp2 = test6[t6];
    }else if (test7[t7] <= temp2 && t7 < 5) {
        temp1 = 7;
        temp2 = test7[t7];
    }else if (test8[t8] <= temp2 && t8 < 5) {
        temp1 = 8;
        temp2 = test8[t8];
    }
    switch(temp1) {
        case 1:
            output[p] = temp2;
            t1++;
            break;
        case 2:
            output[p] = temp2;
            t2++;
            break;
        case 3:
            output[p] = temp2;
            t3++;
            break;
        case 4:
            output[p] = temp2;
            t4++;
            break;
        case 5:
            output[p] = temp2;
            t5++;
            break;
        case 6:
            output[p] = temp2;
            t6++;
            break;
        case 7:
            output[p] = temp2;
            t7++;
            break;
        case 8:
            output[p] = temp2;
            t8++;
            break;
    }
    printf("%d\n",  output[p]);
    p++;
} 
```

谢谢你尽你所能的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T14:24:37.500

这就是您获得第一个数组的前 5 个元素的原因：

```
if (t1 < 5) {
        temp1 = 1;
        temp2 = test1[t1]; 
```

您的代码专门确保首先选择第一个数组的前 5 个元素。您应该将 test1 中下一个元素的值与其他数组中的下一个元素进行比较，而不是盲目地选择它。此外，您对 if..then..else if.. else if... 的使用不正确。如果你发现数组 2 的下一个元素小于数组 1 的下一个元素，你仍然需要检查数组 3、4 和 5 是否更小。

尝试像这样构建您的代码

```
int temp1 = -1;
if (t1 < 5) {
    temp1=1;
    temp2=test1[t1];
}
if ((t2 < 5) && ((temp1 < 0) || (test2[t2] < temp2))) {
    temp1=2;
    temp2=test2[t2];
}
if (t3... 
```

后跟您现有的 switch 语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T14:55:01.360

[斧头](https://stackoverflow.com/a/10774674/1139697)已经告诉你出了什么问题，当且仅当第二个条件有效*且*第一个条件无效时，`if ... else if ...`才会执行第二个块。

 *但是，我相信您的`switch()`和`if-else`基于的程序有点难以扩展，因为您需要更改所有固定字段和值来对另一组数组进行排序。以下程序/功能提供与您的相同，但更容易扩展。它使用一个额外的数组`cursor`来保存当前位置（类似于你的`t1`, `t2`,...）（[Ideone Demo](http://ideone.com/VZzZL)）。

```
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>

int multimerge(
    int * const * const arrays,      // arrays holding the data
    int const * const arraysizes,    // sizes of the arrays in `arrays`
    int number_of_arrays,            // number of arrays
    int * const output               // pointer to output buffer
){
    int i = 0;       // output cursor
    int j = 0;       // index for minimum search
    int min;         // minimum in this iteration
    int minposition; // position of the minimum

    // cursor for the arrays
    int * cursor = calloc(number_of_arrays,sizeof(int));

    if(cursor == NULL)
        return -1;

    while(1){
        min = INT_MAX;
        minposition = -1; // invalid position

        // Go through the current positions and get the minimum
        for(j = 0; j < number_of_arrays; ++j){

            if(cursor[j] < arraysizes[j] &&  // ensure that the cursor is still valid
               arrays[j][cursor[j]] < min){  // the element is smaller
                min = arrays[j][cursor[j]];  // save the minimum ...
                minposition = j;             // ... and its position
            }
        }

        // if there is no minimum, then the position will be invalid

        if(minposition == -1)
            break;

        // update the output and the specific cursor            
        output[i++] = min;
        cursor[minposition]++;
    }
    free(cursor);

    return 0;
}

int main()
{
    int i = 0;
    int test1[5] = {23, 24, 25, 33, 51};
    int test2[5] = {21, 34, 44, 50, 62};
    int test3[5] = {34, 36, 41, 44, 46};
    int test4[5] = {30, 31, 32, 35, 40};
    int test5[5] = {54, 56, 57, 58, 60};
    int test6[5] = {31, 33, 36, 51, 52};
    int test7[5] = {44, 46, 76, 78, 79};
    int test8[5] = {23, 33, 43, 54, 63};

    int *test[] = {test1, test2, test3, test4, test5, test6, test7, test8};
    int testsizes[] = {5,5,5,5,5,5,5,5};

    int output[40];

    multimerge(test,testsizes,8,output);

    while(i < 30){
        printf("%i\n",output[i++]);
    }    

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-27T14:12:41.473

我在（遥远的）过去所做的是用标签排序对每个列表的第一个元素进行排序，选择排序列表中的第一个元素添加到合并列表中，然后将移动的项目替换为下一个它的列表（这就是为什么您需要某种风格的标签，以识别替换应该来自哪里）并重新排序。头部元素的排序可以使用冒泡排序，因为在初始排序之后，您只需要一次通过即可在移除/替换后正确重新排序事物。*

# forms - 如何使用 Symfony2 为两个分离的 Doctrine 实体创建一个独特的表单？

> ID：10774568
> 
> 赞同：1
> 
> 时间：2012-05-27T14:08:46.647
> 
> 标签：forms, symfony, doctrine-orm

我的**Symfony2**应用程序中有两个独立的实体，即**A**和**B**，它们使用 ORM **Doctrine2**映射到数据库中。

现在，我想创建一个包含来自实体**A**和**B**的所有字段的单一表单的独特网页。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T23:45:57.433

您应该能够创建这样的表单类型：

```
class ComplexType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('entity_a', new SimpleAType(), array(
            ))
            ->add('entity_b', new SimpleBType(), array(
            ));
    }

    public function getName()
    {
        return 'complex_type';
    }
} 
```

当您调用 $form->getData() 时，您应该得到一个包含对象的关联数组。当你调用 $form->setData 时，你应该传递一个带有你想要设置的对象的关联数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:31:09.087

Symfony 文档中有一个关于此的章节：[How to Embed a Collection of Forms](http://symfony.com/doc/current/cookbook/form/form_collections.html)。

# javascript - Safari Float Left 问题与断开的链接

> ID：10774573
> 
> 赞同：0
> 
> 时间：2012-05-27T14:09:49.000
> 
> 标签：javascript, html, css, safari, css-float

我直接通过javascript函数提取数据并且一些数据被破坏但是firefox和google chrome都将数据格式化为我想要的格式的表格......

我不是最好的解释，所以我做了这个 jsfiddle：http: [//jsfiddle.net/4qQAm/](http://jsfiddle.net/4qQAm/)

出于某种原因，Safari 的间距不正确，而且看起来很草率……知道为什么或如何解决这个问题吗？

提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:28:29.540

我查看了代码，请在您的 css 中更改，在您的 css 中将“myUserPosts”这个 ID 更改为“lastestposts”ID，并根据您的需要更改宽度，享受美好的一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T16:16:59.410

看起来您的代码期望 jQuery 存在。您的 img 标签上有 jQuery 代码，可以在出现错误时隐藏元素。如果图像未正确加载，图像将使用[onerror](http://www.w3schools.com/jsref/event_onerror.asp)事件隐藏元素。

```
<a href="http://hiero-glyph.com/post/23671192570/you-are-so-sexy" class="postLink">
  <img src="" onerror="$(this).hide();" class="photo" style="display: none; ">
</a> 
```

最简单的解决方案是确保 jQuery 存在。

# window-managers - Awesome wm 的“Fn”键的名称是什么？

> ID：10774582
> 
> 赞同：10
> 
> 时间：2012-05-27T14:10:50.600
> 
> 标签：window-managers, awesome-wm

例如：

`awful.key({"Shift", }, "Left", volwidget.down)`

如何找出要写什么而不是“Shift”来使用“Fn”键？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-28T18:43:55.940

我找到了解决方案：程序`xev`。
如果它运行，它不会显示`Fn`代码。实际上它不必：X 看不到那个键。

无论如何，它会向您显示“热”键的代码，例如`Fn`+ `LeftArrow`（用于降低音量）。在我的情况下，它的名称是`XF86AudioLowerVolume`，我可以在配置文件中使用它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-01-07T09:31:52.423

你可以`xmodmap -pke`用来显示键码，然后你会得到这样的东西：

> ...
> 键码121 = XF86AudioMute NoSymbol XF86AudioMute
> 键码122 = XF86AudioLowerVolume NoSymbol XF86AudioLowerVolume
> 键码123 = XF86AudioRaiseVolume NoSymbol XF86AudioRaiseVolume
> 键码124 = XF86PowerOff NoSymbol XF86PowerOff
> 键码125 = KP_Equal NoSymbol KP_Equal
> 键码126 = plusminus NoSymbol plusminus键
> 码127 =暂停中断暂停中断
> 键码128 = XF86LaunchA NoSymbol XF86LaunchA keycode
> 129 = KP_Decimal KP_Decimal KP_Decimal KP_Decimal
> ...

你可以看到 keycode`XF86AudioLowerVolume`是`122`，所以你可以这样写你的代码：

> 糟糕的.key({ }, "#122", volwidget.down)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-17T13:43:56.113

我`Fn`在 Awesome 和 Openbox WM 中都使用了密钥。
在 Openbox 中有钥匙串的概念，它完美地工作。
按下并释放该`Fn`键，然后再按下某个键，执行与第二个键相关的操作。

`Fn`Openbox 和 Awesome 中的钥匙在`XF86WakeUp`我的 Thinkpad 上。在您的机器上可能会有所不同。

`xmodmap -pke | grep XF86WakeUp`
给出输出
键码 151 = XF86WakeUp NoSymbol XF86WakeUp

在 Awesome 中，该`Fn`键也适用于以下示例代码

```
-- open edit ".vimrc"

awful.key({ "XF86WakeUp" }, "v", function ()

awful.util.spawn("termite -e 'nvim /home/.vimrc'") end,

{description = "Edit .vimrc", group = "Code"}), 
```

但是在 Awesome 中，它在按下后不会释放`v`键。因此，每次按下该`v`键都会导致 vim 打开。

这表明该`Fn`密钥可以在 Awesome WM 中使用。

我只是不知道如何让它释放按下的第二个键！

# android - Android AlertDialog 无法旋转

> ID：10774583
> 
> 赞同：1
> 
> 时间：2012-05-27T14:11:01.010
> 
> 标签：android, dialog

我有一个`activity`，它创建并显示`dialog`在`onCreate`. `dialog`由`AlertDialog.Builder`. _ 它显示正确，除非我旋转屏幕时，`dialog`不旋转....

怎么解决，thx

**显现**

```
<activity android:excludeFromRecents="true" android:name="com.xxx.yyy" android:process=":core" android:theme="@android:style/Theme.Translucent.NoTitleBar"> </activity> 
```

**活动**

```
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        dialog = builder.create();
        dialog.show(); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:27:32.317

我最近阅读了另一个用户发布的类似问题。问题解决了。也许它也适合你的问题。看这里[Android: Dialog etc restore after rotation changed](https://stackoverflow.com/questions/3689544/android-dialog-etc-restore-after-rotation-changed)

# performance - 具有多个 WHERE 等式的 Postgresql CREATE TABLE AS

> ID：10774584
> 
> 赞同：0
> 
> 时间：2012-05-27T14:11:03.440
> 
> 标签：performance, postgresql, aggregate-functions, where, create-table

我正在尝试创建一个新表，它是具有匹配主键的 6 个其他表的聚合总和。如果我使用超过 3 个输入表，这会一直停滞不前：

```
 CREATE TABLE table_name AS SELECT table1.timestamp, table1.value + table2.value + table3.value + table4.value AS value FROM table1, table2, table3, table4 WHERE table1.timestamp=table2.timestamp AND table2.timestamp=table3.timestamp AND table3.timestamp=table4.timestamp; 
```

**问题：**脚本在运行 2-3 个表时运行得相当快（<5 秒），但在其他情况下会停止。我没有尝试过运行超过 5 分钟，但无论如何这对于我的目的来说太慢了。

**表格说明：**每个表格的格式相同，共有 6 列（其中 2 列是相关的）。主键是整数“时间戳”，“值”是实数。表格大小各不相同，但每个表格大约有 100k 行/条目。这些表大多具有相同的主键，但每个表中都缺少一些数据点，因此从新表中省略这些数据点至关重要。

*有什么我做错了，我应该怎么做才能让它跑得快？*

**编辑：**

Ps：这是一个完整的“EXPLAIN ANALYZE”查询的实际输出：

```
eldb=# EXPLAIN ANALYZE CREATE TABLE test_table AS SELECT count1.timestamp, count
1.year, count1.month, count1.day, count1.period, count1.the_value + count2.the_value + count
3.the_value + count4.the_value + count5.the_value + count6.the_value AS the_value FROM "table_name-1" AS count
1, "table_name-2" AS count2, "table_name-3" AS count3, "table_name-4" AS count4,
 "table_name-5" AS count5, "table_name-6" AS count6 WHERE count1.timestamp=count
2.timestamp AND count2.timestamp=count3.timestamp AND count3.timestamp=count4.ti
mestamp AND count4.timestamp=count5.timestamp AND count5.timestamp=count6.timest
amp AND count1.timestamp>2012020000 AND count2.timestamp>2012020000 AND count3.t
imestamp>2012020000 AND count4.timestamp>2012020000 and count5.timestamp>2012020
000 AND count6.timestamp>2012020000;
                                                                          QUERY
PLAN
--------------------------------------------------------------------------------
------------------------------------------------------------------------------
 Merge Join  (cost=20323.61..153806457715456.50 rows=5592655588099248 width=44)
(actual time=84.524..3310.692 rows=3410 loops=1)
   Merge Cond: (count1."timestamp" = count4."timestamp")
   ->  Nested Loop  (cost=10161.80..4417379579.26 rows=1057606343 width=40) (act
ual time=44.597..1616.585 rows=3410 loops=1)
         Join Filter: (count2."timestamp" = count1."timestamp")
         ->  Merge Join  (cost=10161.80..101480.96 rows=6070522 width=16) (actua
l time=43.648..48.950 rows=3410 loops=1)
               Merge Cond: (count2."timestamp" = count3."timestamp")
               ->  Sort  (cost=5080.90..5168.01 rows=34844 width=8) (actual time
=25.608..25.804 rows=3410 loops=1)
                     Sort Key: count2."timestamp"
                     Sort Method: quicksort  Memory: 256kB
                     ->  Seq Scan on "table_name-2" count2  (cost=0.00..1972.66
rows=34844 width=8) (actual time=0.064..23.297 rows=3410 loops=1)
                           Filter: ("timestamp" > 2012020000)
               ->  Materialize  (cost=5080.90..5255.12 rows=34844 width=8) (actu
al time=18.030..19.847 rows=3410 loops=1)
                     ->  Sort  (cost=5080.90..5168.01 rows=34844 width=8) (actua
l time=18.023..18.416 rows=3410 loops=1)
                           Sort Key: count3."timestamp"
                           Sort Method: quicksort  Memory: 256kB
                           ->  Seq Scan on "table_name-3" count3  (cost=0.00..19
72.66 rows=34844 width=8) (actual time=0.023..16.294 rows=3410 loops=1)
                                 Filter: ("timestamp" > 2012020000)
         ->  Materialize  (cost=0.00..2351.88 rows=34844 width=24) (actual time=
0.000..0.147 rows=3410 loops=3410)
               ->  Seq Scan on "table_name-1" count1  (cost=0.00..1972.66 rows=3
4844 width=24) (actual time=0.020..16.853 rows=3410 loops=1)
                     Filter: ("timestamp" > 2012020000)
   ->  Materialize  (cost=10161.80..4007228099.11 rows=1057606343 width=24) (act
ual time=39.917..1687.402 rows=3410 loops=1)
         ->  Nested Loop  (cost=10161.80..4004584083.26 rows=1057606343 width=24
) (actual time=39.915..1685.956 rows=3410 loops=1)
               Join Filter: (count4."timestamp" = count6."timestamp")
               ->  Merge Join  (cost=10161.80..101480.96 rows=6070522 width=16)
(actual time=38.689..44.309 rows=3410 loops=1)
                     Merge Cond: (count4."timestamp" = count5."timestamp")
                     ->  Sort  (cost=5080.90..5168.01 rows=34844 width=8) (actua
l time=18.960..19.156 rows=3410 loops=1)
                           Sort Key: count4."timestamp"
                           Sort Method: quicksort  Memory: 256kB
                           ->  Seq Scan on "table_name-4" count4  (cost=0.00..19
72.66 rows=34844 width=8) (actual time=0.059..17.271 rows=3410 loops=1)
                                 Filter: ("timestamp" > 2012020000)
                     ->  Materialize  (cost=5080.90..5255.12 rows=34844 width=8)
 (actual time=19.717..21.826 rows=3410 loops=1)
                           ->  Sort  (cost=5080.90..5168.01 rows=34844 width=8)
(actual time=19.708..20.266 rows=3410 loops=1)
                                 Sort Key: count5."timestamp"
                                 Sort Method: quicksort  Memory: 256kB
                                 ->  Seq Scan on "table_name-5" count5  (cost=0.
00..1972.66 rows=34844 width=8) (actual time=0.034..18.001 rows=3410 loops=1)
                                       Filter: ("timestamp" > 2012020000)
               ->  Materialize  (cost=0.00..2283.88 rows=34844 width=8) (actual
time=0.000..0.148 rows=3410 loops=3410)
                     ->  Seq Scan on "table_name-6" count6  (cost=0.00..1972.66
rows=34844 width=8) (actual time=0.036..17.785 rows=3410 loops=1)
                           Filter: ("timestamp" > 2012020000)
 Total runtime: 3330.933 ms
(40 rows) 
```

这是表结构（所有表都相同）：

```
CREATE TABLE "table_name-6"
(
"timestamp" integer NOT NULL,
year integer NOT NULL,
month integer NOT NULL,
day integer NOT NULL,
period integer NOT NULL,
the_value real,
CONSTRAINT "table_name-6_pkey" PRIMARY KEY ("timestamp" )
) 
```

注意：实际的表名和值已重命名。此外，此输出仅占实际表大小的一小部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:34:33.843

```
DROP SCHEMA tmp CASCADE;
CREATE SCHEMA tmp ;

set search_path='tmp';

SET random_page_cost=1;

CREATE TABLE table_name1
        ( ztimestamp integer NOT NULL
        , year integer NOT NULL
        , month integer NOT NULL
        , day integer NOT NULL
        , period integer NOT NULL
        , the_value real
        , CONSTRAINT table_name1_pkey PRIMARY KEY (ztimestamp )
        ) ;

CREATE TABLE table_name2
        ( ztimestamp integer NOT NULL
        , year integer NOT NULL
        , month integer NOT NULL
        , day integer NOT NULL
        , period integer NOT NULL
        , the_value real
        , CONSTRAINT table_name2_pkey PRIMARY KEY (ztimestamp )
        ) ;

... similar for 3,4,5,6 ...

INSERT INTO table_name1(ztimestamp,year,month,day,period,the_value)
SELECT generate_series(1,2000), 0,0,0,0, 1.0;
INSERT INTO table_name2 SELECT * FROM table_name1;
INSERT INTO table_name3 SELECT * FROM table_name1;
INSERT INTO table_name4 SELECT * FROM table_name1;
INSERT INTO table_name5 SELECT * FROM table_name1;
INSERT INTO table_name6 SELECT * FROM table_name1;

EXPLAIN ANALYZE
CREATE TABLE test_table AS
SELECT c1.ztimestamp, c1.year, c1.month, c1.day, c1.period
        , c1.the_value + c2.the_value + c3.the_value + c4.the_value
        + c5.the_value + c6.the_value AS the_value
FROM table_name1 AS c1
        , table_name2 AS c2
        , table_name3 AS c3
        , table_name4 AS c4
        , table_name5 AS c5
        , table_name6 AS c6
WHERE c1.ztimestamp=c2.ztimestamp
AND c2.ztimestamp=c3.ztimestamp
AND c3.ztimestamp=c4.ztimestamp
AND c4.ztimestamp=c5.ztimestamp
AND c5.ztimestamp=c6.ztimestamp
    ; 
```

结果&&计划：INSERT 0 2000

```
INSERT 0 2000
INSERT 0 2000
INSERT 0 2000
INSERT 0 2000
INSERT 0 2000
INSERT 0 2000
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=0.00..475.93 rows=1963 width=44) (actual time=0.066..11.840 rows=2000 loops=1)
   Merge Cond: (c1.ztimestamp = c6.ztimestamp)
   ->  Merge Join  (cost=0.00..371.26 rows=1963 width=56) (actual time=0.052..8.706 rows=2000 loops=1)
         Merge Cond: (c1.ztimestamp = c5.ztimestamp)
         ->  Merge Join  (cost=0.00..291.12 rows=1963 width=48) (actual time=0.042..6.752 rows=2000 loops=1)
               Merge Cond: (c1.ztimestamp = c4.ztimestamp)
               ->  Merge Join  (cost=0.00..210.98 rows=1963 width=40) (actual time=0.033..4.751 rows=2000 loops=1)
                     Merge Cond: (c1.ztimestamp = c3.ztimestamp)
                     ->  Merge Join  (cost=0.00..130.84 rows=1963 width=32) (actual time=0.022..2.903 rows=2000 loops=1)
                           Merge Cond: (c1.ztimestamp = c2.ztimestamp)
                           ->  Index Scan using table_name1_pkey on table_name1 c1  (cost=0.00..50.70 rows=1963 width=24) (actual time=0.009..0.609 rows=2000 loops=1)
                           ->  Index Scan using table_name2_pkey on table_name2 c2  (cost=0.00..50.70 rows=1963 width=8) (actual time=0.010..0.756 rows=2000 loops=1)
                     ->  Index Scan using table_name3_pkey on table_name3 c3  (cost=0.00..50.70 rows=1963 width=8) (actual time=0.010..0.718 rows=2000 loops=1)
               ->  Index Scan using table_name4_pkey on table_name4 c4  (cost=0.00..50.70 rows=1963 width=8) (actual time=0.009..0.758 rows=2000 loops=1)
         ->  Index Scan using table_name5_pkey on table_name5 c5  (cost=0.00..50.70 rows=1963 width=8) (actual time=0.010..0.696 rows=2000 loops=1)
   ->  Index Scan using table_name6_pkey on table_name6 c6  (cost=0.00..50.70 rows=1963 width=8) (actual time=0.008..1.044 rows=2000 loops=1)
 Total runtime: 70.201 ms
(17 rows) 
```

更新：大多数人更喜欢 JOIN 语法而不是 where ... 语法：

```
EXPLAIN ANALYZE
CREATE TABLE test_table AS
SELECT c1.ztimestamp, c1.year, c1.month, c1.day, c1.period
        , c1.the_value + c2.the_value + c3.the_value + c4.the_value
        + c5.the_value + c6.the_value AS the_value
FROM table_name1 AS c1
JOIN table_name2 AS c2 ON c1.ztimestamp=c2.ztimestamp
JOIN table_name3 AS c3 ON c2.ztimestamp=c3.ztimestamp
JOIN table_name4 AS c4 ON c3.ztimestamp=c4.ztimestamp
JOIN table_name5 AS c5 ON c4.ztimestamp=c5.ztimestamp
JOIN table_name6 AS c6 ON c5.ztimestamp=c6.ztimestamp
        ; 
```

# qml - “类型转换” XmlListModel 到 Listmodel

> ID：10774587
> 
> 赞同：1
> 
> 时间：2012-05-27T14:11:10.903
> 
> 标签：qml

我有一个从网络服务器获取数据的 XmlListModel，效果很好。

但是，我想在 CLComboBox （来自 Colibri 库）中使用它。

如果我将参数 ListModel 设置为我的 XmlListModel 我得到：

```
Non-existent attached object 
         ListModel:xmlModel13 
```

但它确实存在；因为 ListView 对象可以使用完全相同的模型。

在我看来，CLComboBox 只接受 ListModel，那么有什么方法可以轻松地将 XmlListModel 转换为 ListModel？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-28T19:19:00.250

您不能`QDeclarativeXmlListModel`转换为，`QDeclarativeListModel`因为它们都是`QListModelInterface`.

在我看来，Colibri 应该使用`QObject`( `variant`property) 而不是`QDeclarativeListModel`. 并听取标准的基于项目的模型信号，例如我相信它可以通过一些努力来修复。

如果您不愿意为 Colibri 做出贡献，我认为@sabbour 的回答是最佳选择。考虑一个简单的例子：

```
XmlListModel {
    id: xmlModel
    source: "http://forumcinemas.lv/rus/xml/Events/"
    query: "/Events/Event"
    XmlRole { name: "label"; query: "Title/string()" }
    XmlRole { name: "value"; query: "ID/number()"; isKey: true }
    onStatusChanged: {
        if (status == XmlListModel.Ready) {
            for (var i=0; i<count; i++) {
                var item = get(i)
                list_model.append({label: item.label,
                                   value: item.value,
                                   selected: false})
            }
            // CLComboBox doesnt seem to listen for model updates
            combo_box.items = list_model
        }
    }
}

ListModel {
    id: list_model
}

CLComboBox {
    id: combo_box
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T10:40:08.873

您可以使用循环填充 CLComboBox 内的 ListModel。

# arrays - f2py：一些返回的数组未更改/为空

> ID：10774594
> 
> 赞同：1
> 
> 时间：2012-05-27T14:11:47.877
> 
> 标签：arrays, return, zero, f2py

嗨，我正在使用 f2py 来包装 lapack 例程 dgesvd，方法是编译 dgesvd.f 文件并将其链接到 llapack，如此[处所述](https://stackoverflow.com/questions/10766969/f2py-wrapping-fortran-module-which-makes-use-of-subrouines-distributed-in-diffe)

根据文档字符串， dgesvd 模块具有签名：

```
dgesvd - Function signature:
  dgesvd(jobu,jobvt,m,n,a,s,u,vt,work,lwork,info,[lda,ldu,ldvt])
Required arguments:
  jobu : input string(len=1)
  jobvt : input string(len=1)
  m : input int
  n : input int
  a : input rank-2 array('d') with bounds (lda,*)
  s : input rank-1 array('d') with bounds (*)
  u : input rank-2 array('d') with bounds (ldu,*)
  vt : input rank-2 array('d') with bounds (ldvt,*)
  work : input rank-1 array('d') with bounds (*)
  lwork : input int
  info : input int
Optional arguments:
  lda := shape(a,0) input int
  ldu := shape(u,0) input int
  ldvt := shape(vt,0) input int 
```

然后我使用以下 ocde 调用模块：

```
mat = rand(20,30)
out_u,out_s,out_vh = zeros((20,20)), zeros((20,)), zeros((30,30))
rows, cols = shape(mat)
workspace = zeros((rows*cols))
out_info = 0

dgesvd(jobu='S', 
    jobvt='S',
    m=rows,
    n=cols,
    a=mat,
    s=out_s,
    u=out_u,
    vt=out_vh,
    work=workspace,
    lwork=rows*cols,
    info=out_info) 
```

这给了我存储在 中的正确奇异值`out_s`，但是矩阵`out_u`和`out_vh`仍然只填充零，我是否必须做一些不同的事情来获得左/右奇异向量？

代码运行通过，没有任何错误，`out_info`即为0。

（jobu 和 jobvt 的参数“S”告诉例程只计算前 min(m,n) 个奇异向量。将其更改为“A”，没有任何区别）

任何想法都受到高度赞赏！谢谢米莎

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T20:24:31.927

`f2py`为 Fortran 代码创建 python 包装器，但创建的 python 函数并不打算像 Fortran 代码一样被调用。在 Fortran 中，通常的做法是将输出变量作为参数传递给子例程。这不是“pythonic”；此外，python 并不像 Fortran 那样真正支持子例程。出于这个原因，`f2py`将您的 Fortran 子例程转换为 python 函数，因此所有输出变量都由函数*返回*，而不包括在调用签名中。因此，您必须以这种方式调用该函数：

```
out_s, out_u, out_vh, info = dgesvd(jobu='S', 
                                    jobvt='S',
                                    m=rows,
                                    n=cols,
                                    a=mat,
                                    work=workspace,
                                    lwork=rows*cols) 
```

但是，LAPACK 例程是用 FORTRAN77 编写的，因此它没有任何`INTENT`输入/输出变量的声明。 `f2py`使用`INTENT`声明来确定哪些变量用作输入，哪些将作为输出返回。根据您发布的函数签名，`f2py`假设所有变量都是输入的，这不是您想要的。出于这个原因，我建议编写您自己的调用 的 Fortran 90 包装例程`dgesvd`，以便您可以`INTENT`自己添加声明以提供`f2py`一些提示。我个人也会使用包装器来分配要传递的工作数组，`dgesvd`这样您就不必从 python 传递它。[此处](http://cens.ioc.ee/projects/f2py2e/usersguide/index.html#three-ways-to-wrap-getting-started)`f2py`解释了如何确定输入/输出签名的确切方式（有三种方法可以做到，我更喜欢第三种）。

# perl - 通过 IO::Socket::INET 连接到 MPD 的问题

> ID：10774601
> 
> 赞同：1
> 
> 时间：2012-05-27T14:12:53.057
> 
> 标签：perl, sockets

我正在尝试使用 IO::Socket::INET 从 MPD 守护程序获取有关当前曲目的信息，但是，无论请求如何，我总是获得*OK MPD version*。

```
#!/usr/bin/perl -w
use strict;
use feature 'switch';
use YAML qw(LoadFile Dump);
use IO::Socket::INET;

$| = 1;
my @params = ('mpd_host', 'mpd_port', 'mpd_password');

sub get_config_file
{
    my @configpaths = (
        "config.yml",
#       "$ENV{'HOME'}/.config/mpdtweet/config.yml",
    );
    for (@configpaths) {
        return $_ if -e $_;
    }
}

sub load_conf
{
    my $config = YAML::LoadFile($_[0])
        or return 1;
    my %configuration = %$config;
    return %configuration;
}

sub check_conf
{
    my @missingparams;
    for ($_[0]) {
        push(@missingparams, $_) unless $_[0]{$_};
    }
    return 0 if $#missingparams eq 0 or return @missingparams;
}

sub first_run
{
    sub sure
    {
        print "Would you like to start the first run wizard? [y/n] ";
        chomp (my $choice = <STDIN>);
        given ($choice) {
            when (/n/) {
                exit 0;
            }
            when (/y/) {
                print "I need some informations about how to connect to MPD.\n";
                &make_sample_config(&request_mpd_informations);
                print "Configuration finished!\n";
            }
            default {
                print "$choice is not a valid answer.\n"; &sure;
            }
        }
    }
    &sure;
}

sub request_mpd_informations
{
    sub request_mpd_host
    {
        print "Host [localhost]: ";
        chomp (my $host = <STDIN>);
        return "localhost" if !$host;
    }
    sub request_mpd_port
    {
        print "Port [6600]: ";
        chomp (my $port = <STDIN>);
        return 6600 if !$port;
    }
    sub request_mpd_password
    {
        print "Password [null]: ";
        chomp(my $password = <STDIN>);
        return "" if !$password;
    }
    return (&request_mpd_host, &request_mpd_port, &request_mpd_password);
}

sub make_sample_config
{
    my $first_config = {
        'mpd_host'     => $_[0],
        'mpd_port'     => $_[1],
        'mpd_password' => $_[2],
        patterns => [
            '#nowplaying %a - %t (%d)',
            '#nowplaying %a - %t',
        ],
        patterns_comment => [
            '#nowplaying %a - %t (%d) « %c',
            '#nowplaying %a - %t « %c',
        ],
    };
    open my $first_configfile, '>', 'config.yml'
        or die "Can't make config file: $!";
    print $first_configfile Dump($first_config);
    close $first_configfile;
}

sub check_mpd_connection_handshake
{
    my $data = <$_[0]>;
    return 1 unless $data =~ m/OK MPD/
        or return 0;
}

sub current_song_info
{ # tracktitle, artistname, albumname || 1
    my $mpd_socket = shift;
    my %response;
    print $mpd_socket "currentsong";
    while (<$mpd_socket>) {
        chomp;
        my ($key, $value) = split(': ', $_, 2);
        $response{$key} = $value;
    }
    return %response;
}

my $configfilepath = &get_config_file;
open my $configfile, '<', $configfilepath
    or print "I haven't found any configuration file, \
    maybe this is the first time you run this software.\n"
    and &first_run and exit 0;
my %config = &load_conf($configfile);
die "Malformed configuration file ($configfilepath).\n"
    if &check_conf(\%config) eq 1;
close $configfile;

my $mpd_socket = new IO::Socket::INET (
    PeerHost => $config{'mpd_host'},
    PeerPort => $config{'mpd_port'},
    Proto => 'tcp',
) or die "Error connecting to MPD socket: $!\n";
die "Error connecting to MPD daemon: maybe something else is running on $config{'mpd_port'} port"
    if check_mpd_connection_handshake($mpd_socket) eq 1;
my %tags = &current_song_info($mpd_socket);
print $tags{artist};
$mpd_socket->close(); 
```

我究竟做错了什么？

提前致谢。

# iphone - 目标 c - NSDictionary 保留对象问题

> ID：10774602
> 
> 赞同：2
> 
> 时间：2012-05-27T14:13:05.057
> 
> 标签：iphone, objective-c, nsdictionary, dealloc, retaincount

我会试着解释一下自己，我有一个对象`Person`和一个`PeopleManager`带有`NSDictionary *_people`.
`_people`是一个字典，它保存`Person`带有`personId`as 键的对象。

创建一个人时，我将它 ( `self`) 添加到`_people`字典中（在`Person` `init`方法中）

people 字典应该保存 person 对象，直到 person 被 dealloc，但问题是如果我在代码中的某个地方分配 person 然后释放它，它不会得到 dealloc，因为`PeopleManager`它仍然保存在 _people 字典中。

真正的问题是`_people`字典保留了这个人，如果有可能有一个分配字典那就太好了，但我知道这是不可能的。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:15:46.817

字典必须保留人员，因为它正在使用它。如果这没有发生，字典就不能保证它的对象总是还活着。

当您释放 Person 时，您根本不再需要它并期望它被释放，通过`[NSMutableDictionary -removeObjectForKey:]`（并因此减少保留计数）将其从字典中删除。这将需要使用 NSMutableDictionary，因为您无法从 NSDictionary 中删除对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:17:36.313

如果您使用 NSDictionary 的可变对应物，您将能够通过一个简单的方法删除已停用的对象`-removeObjectForKey:`

# jquery - Drupal 7.x 和 onYouTubePlayerReady

> ID：10774604
> 
> 赞同：0
> 
> 时间：2012-05-27T14:13:31.620
> 
> 标签：jquery, drupal, youtube

嵌入的 Youtube 视频完成后，我试图隐藏 DIV。我的平台是 Drupal 7.x 我正在使用 JQuery 来显示和隐藏 div。我在触发 onYouTubePlayerReady 函数时遇到了麻烦，这会阻止这一切发生。所有文件都在我的网络服务器上，我没有在本地尝试这个，因为 YouTube 解释说它在本地不起作用（[http://goo.gl/5qeKC](http://goo.gl/5qeKC)）

我的头部：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
<script type="text/javascript" src="http://dev.mydomain.com/mytheme/site/sites/all/themes/mytheme/js/hfbusiness.js?m4hr22"></script> 
```

在 hfbusiness.js 文件中，我有以下内容（该文件正在加载和工作，因为我可以触发显示的 javascript 警报）：

```
function onYouTubePlayerReady(id) {
    console.log("onYouTubePlayerReady() Fired!");
    var player = $("#youtube_player").get(0);
  } 
```

Index.php 包含：

```
<div class="marketing_video">
<iframe id="ytplayer" type="text/html" width="640" height="360" src="http://www.youtube.com/embed/hIaqCG8O5uU?version=3&enablejsapi=1&rel=0&showinfo=0" frameborder="0" allowfullscreen></iframe>
</div> 
```

视频显示和播放 iframe 中定义的选项没有问题。但是，YouTubePlayerReady 函数永远不会被触发。我在这件事上撞墙了，到目前为止，我只完成了一个头痛。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T15:02:52.767

我能够通过使用 swfobject.js 而不是 iFrame 来解决这个问题。我想知道如果我想出一种方法来允许脚本访问，iFrame 是否会让我做同样的事情，如下所示。如果有人知道这个问题的答案，我仍然会很感激答案。

在我的索引文件中：

```
<script type="text/javascript">
    var params = { allowScriptAccess: "always" };
    var atts = { id: "myytplayer" };
    swfobject.embedSWF("http://www.youtube.com/v/hIaqCG8O5uU?enablejsapi=1&playerapiid=ytplayer&version=3", "ytapiplayer", "425", "356", "8", null, null, params, atts);

  </script> 
```

hfbusiness.js

```
var $hfjq = jQuery.noConflict()

function onYouTubePlayerReady(id) {
    var player = document.getElementById("myytplayer");
    player.addEventListener('onStateChange', 'playerState');
}

function playerState(state) {
    if(state == 0) {
        $hfjq(".marketing_video").hide();
    }
} 
```

# php - 无法使用php表单将数据插入mysql数据库

> ID：10774605
> 
> 赞同：0
> 
> 时间：2012-05-27T14:13:56.943
> 
> 标签：php, mysql, database

我正在尝试使用名为*PHP for Absolute Beginners*的书来学习一些 PHP 。我正在尝试使用 WAMP 和 editplus 实现书中给出的一些博客设计代码。当我尝试使用 PHP 表单插入数据时，我得到的只是数据库表中的 NULL 值。这是一段用于将值插入数据库的代码。

```
<?php
if($_SERVER['REQUEST_METHOD']=='POST'
&& $_POST['submit']=='Save Entry'
&& !empty($_POST['title'])
&& !empty($_POST['entry']))
{
// Include database credentials and connect to the database
include_once 'db.inc.php';
$db = new PDO(DB_INFO, DB_USER, DB_PASS);

// Save the entry into the database
$sql = "INSERT INTO entries (title, entry) VALUES (?, ?)";
$stmt = $db->prepare($sql);
$stmt->execute(array($title, $entry));
$stmt->closeCursor();

// Get the ID of the entry we just saved
$id_obj = $db->query("SELECT LAST_INSERT_ID()");
$id = $id_obj->fetch();
$id_obj->closeCursor();

// Send the user to the new entry
header('Location: ../admin.php?id='.$id[0]);
exit;
}
// If both conditions aren't met, sends the user back to the main page
else
{
header('Location: ../admin.php');
exit;
}
?> 
```

当我检查 apache 错误日志时，我看到：

```
[Sun May 27 19:21:24 2012] [error] [client 127.0.0.1] PHP Notice:  Undefined 
variable: title in C:\\wamp\\www\\examples\\simple_blog\\inc\\update.inc.php
on line 14, referer: http://localhost/examples/simple_blog/admin.php?id=8
[Sun May 27 19:21:24 2012] [error] [client 127.0.0.1] PHP Stack trace:, referer: 
http://localhost/examples/simple_blog/admin.php?id=8
[Sun May 27 19:21:24 2012] [error] [client 127.0.0.1] PHP   1\. {main}() 
C:\\wamp\\www\\examples\\simple_blog\\inc\\update.inc.php:0, referer:    
http://localhost/examples/simple_blog/admin.php?id=8
[Sun May 27 19:21:24 2012] [error] [client 127.0.0.1] PHP Notice:  Undefined 
variable: entry in C:\\wamp\\www\\examples\\simple_blog\\inc\\update.inc.php 
on line 14, referer: http://localhost/examples/simple_blog/admin.php?id=8
[Sun May 27 19:21:24 2012] [error] [client 127.0.0.1] PHP Stack trace:, referer: 
http://localhost/examples/simple_blog/admin.php?id=8
[Sun May 27 19:21:24 2012] [error] [client 127.0.0.1] PHP   1\. {main}() 
C:\\wamp\\www\\examples\\simple_blog\\inc\\update.inc.php:0, referer: 
http://localhost/examples/simple_blog/admin.php?id=8 
```

我不知道这些错误是什么。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:16:46.263

可能您的服务器已配置`$_POST['title']`为不会自动别名为`$title`. 手动初始化`$title = $_POST['title']`其他使用过的`$_POST`物品。

```
<?php
if($_SERVER['REQUEST_METHOD']=='POST'
&& $_POST['submit']=='Save Entry'
&& !empty($_POST['title'])
&& !empty($_POST['entry']))
{
    $title = $_POST['title'];
    $entry = $_POST['entry'];

...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:16:16.143

错误/警告是不言自明的；您必须先定义变量，然后才能使用它们（大多数情况下）：

```
$title = $_POST['title'];
$entry = $_POST['entry']; 
```

第 14 行以上的任何地方都可以。

PHP 有一个`register_globals`设置可以自动为您执行此操作，但因为它是一个配置设置，您不能可靠地使用它。我相信在最新版本的 PHP 中它不再可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T14:18:09.020

`PHP Notice: Undefined variable: title`表示没有名为title的变量。看看你的代码，你就快到了，但只是错过了两行。您需要为您的`$_POST`数据分配变量。在 if 语句中添加以下行，你应该没问题

```
$title=$_POST['title'];
$entry=$_POST['entry']; 
```

# jquery-ui - Android 上的 Galleria 下出现 JQuery UI Dialog

> ID：10774607
> 
> 赞同：0
> 
> 时间：2012-05-27T14:14:03.283
> 
> 标签：jquery-ui, galleria, android-browser

非常标准的 Galleria / JQueryUI 代码，用于在画廊页面上显示对话框。jsfiddle：http: [//jsfiddle.net/nHsM3/](http://jsfiddle.net/nHsM3/)

Android 3.1 Samsung Galaxy 10.1 上的 Galleria Gallery 下出现对话框

我已经尝试过对话框 div 的 z 顺序。没运气。有谁知道解决这个问题？

仅供参考 - 在 Galaxy Tab 7.7 Android 3.2 上没有看到这个

![在此处输入图像描述](../Images/8ef3fb2fb36560f2086c48596ad2498e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T01:59:29.253

最终的修复是检测 Android 3.1 并将[转换](http://galleria.io/docs/options/transition/#built-in-transitions)设置为无。看起来默认的淡入淡出导致 z-index 发生了一些有趣的事情。

# android - Cordova，PhoneGap 1.7 Android后退按钮未触发

> ID：10774608
> 
> 赞同：2
> 
> 时间：2012-05-27T14:14:18.087
> 
> 标签：android, cordova, back-button

我在 Android 上使用 Cordova 1.7，它似乎正在工作（例如：我可以从图库中选择一个图像），但我无法触发后退按钮事件。按下后退按钮时，应用程序会自动关闭。我的构建目标是 Android 2.2。

我把它放在`onReady`方法中，完全按照 API 中的说明：

```
document.removeEventListener("backbutton", onBackKeyDown, false); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:48:42.633

```
document.addEventListener("backbutton" , onBackKeyDown, false);     

function  onBackKeyDown(){    
   // Do something here    
   alert('back button was pushed'); 
```

}

添加事件监听器，而不是删除事件

# android - Android：致命异常主要

> ID：10774609
> 
> 赞同：2
> 
> 时间：2012-05-27T14:14:22.883
> 
> 标签：android, exception, main, fatal-error

好的，所以我是编程的初学者，这是我的第一个编程项目。我想做的是创建一个“励志名言”应用程序，其中包含大约 10 个人，每个人都有多个引号。只是一些简单的视图翻转和随机化数组。我正在编写视图翻转部分的代码，然后当我尝试在模拟器中运行它时，它给了我“应用程序已意外停止”。Logcat 显示“FATAL EXCEPTION Main”。希望有人可以帮助我完成这项工作，我陷入了死胡同，截止日期很快就结束了。

我试着四处搜索，大多数都要求 src、main.xml 和 manifest.xml，所以我将它们发布在这里：

源代码：

```
package first.motivationalquotes;

import java.util.Random;
import android.app.Activity;
import android.content.res.Resources;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;
import android.widget.ViewFlipper;

public class MotivationalQuotesActivity extends Activity {
    /** Called when the activity is first created. */

Button next,previous;
ViewFlipper vf;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        next = (Button) findViewById(R.id.button1);
        previous = (Button) findViewById(R.id.button2);
        next.setOnClickListener((OnClickListener) this);
        previous.setOnClickListener((OnClickListener) this);
        vf=(ViewFlipper)findViewById(R.id.viewFlipper1);
    }

    public void randomize(View v)
    {
        Random ran = new Random();
        String[] ButtonText = null;
        Resources res = getResources();
        ButtonText = res.getStringArray(R.array.Quotes);
        String strRandom = ButtonText[ran.nextInt(ButtonText.length)];
        System.out.println("Random string is : "+strRandom);

        TextView tv = (TextView) findViewById(R.id.textView2);
        tv.setText(ButtonText[ran.nextInt(ButtonText.length)]);
    }

    public void onClick(View v) {
        if (v == next) {
            vf.showNext();
        }
        if (v == previous) {
            vf.showPrevious();
        }
    }

} 
```

接下来是 main.xml（目前仅编码为 2 人）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ViewFlipper
        android:id="@+id/viewFlipper1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <!-- View 1- Einstein - person1 -->
         <TableLayout 
         android:orientation="vertical"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent" >

        <TableRow>
        <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Albert Einstein"
        android:layout_gravity="center"
        android:textSize="28dp" >
        </TextView>
        </TableRow>

        <TableRow>

            <ImageView
                android:id="@+id/imageView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:src="@drawable/clear_einstein" />

        </TableRow>

        <TableRow>
        <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/einstein1"
        android:textAppearance="?android:attr/textAppearanceMedium" />
        </TableRow>

    </TableLayout>

         <!-- View 2- Tesla - person2 -->
     <TableLayout 
         android:orientation="vertical"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent" >

        <TableRow>
        <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Nikola Tesla"
        android:layout_gravity="center"
        android:textSize="28dp" >
        </TextView>
        </TableRow>

        <TableRow>
        <ImageView
        android:id="@+id/imageView1"
        android:layout_weight="1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/nikola_tesla" />
        </TableRow>

        <TableRow>
        <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/einstein1"
        android:textAppearance="?android:attr/textAppearanceMedium" />
        </TableRow>

    </TableLayout>

     <TableLayout 
         android:orientation="vertical"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent" >

        <TableRow>
        <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Albert Einstein"
        android:layout_gravity="center"
        android:textSize="28dp" >
        </TextView>
        </TableRow>

        <TableRow>
        <ImageView
        android:id="@+id/imageView1"
        android:layout_weight="1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/clear_einstein" />
        </TableRow>

        <TableRow>
        <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/einstein1"
        android:textAppearance="?android:attr/textAppearanceMedium" />
        </TableRow>

    </TableLayout>

    </ViewFlipper>

     <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal" 
        android:layout_gravity="center">
    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="button2Click"
        android:clickable="true"
        android:text="&lt;Previous"
        android:layout_gravity="center" />
    <Button
        android:id="@+id/aboutMeButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="randomize"
        android:text="Randomize" 
        android:layout_gravity="center"/>
    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="button1Click"
        android:text="Next&gt;" 
        android:layout_gravity="center"/>
    </LinearLayout>

    </LinearLayout> 
```

然后是 manifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="first.motivationalquotes"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".MotivationalQuotesActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

Logcat：http: [//i56.photobucket.com/albums/g183/luq_man/Logcat.png](http://i56.photobucket.com/albums/g183/luq_man/Logcat.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:56:00.850

我认为你必须实现 OnClickListener。

公共 MotivationalQuotesActivity 扩展 Activity 实现 OnClickListener{

…… }

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:38:06.160

可能忘记实施`OnClickListener`？

```
public class MyActivity extends Activity implements View.OnClickListener 
```

或者是这样的：

```
public class MyActivity extends Activity {
Button next, previous;
ViewFlipper vf;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    next = (Button) findViewById(R.id.button1);
    previous = (Button) findViewById(R.id.button2);
    next.setOnClickListener(nextOnClick);//<--------new listener
    previous.setOnClickListener(previousOnClick);//<--------new listener
    vf = (ViewFlipper) findViewById(R.id.viewFlipper1);
}

private View.OnClickListener nextOnClick = new View.OnClickListener() {
    @Override
    public void onClick(View view) {
        vf.showNext();
    }
};

private View.OnClickListener previousOnClick = new View.OnClickListener() {
    @Override
    public void onClick(View view) {
        vf.showPrevious();
    }
}; 
```

# java - X轴上的android加速度计

> ID：10774611
> 
> 赞同：0
> 
> 时间：2012-05-27T14:15:18.517
> 
> 标签：java, android, mobile, accelerometer

我认为这对你们来说是一个简单的问题（我只是这个行业的新手）：
所以，在我基于 android java 的游戏中，我有这个球，并且..
我想检测用户的移动。
如果用户将设备向右倾斜，球将向右侧滚动
如果用户将设备向左倾斜，球将向左侧滚动。

所以，简而言之：
如何将球“连接”到设备运动（仅在 x 轴 - 左右）

谢谢，
sock.socket

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-13T05:55:49.653

首先，声明您的传感器和传感器管理器

```
public Sensor mySensor;
private SensorManager mySensorManager; 
```

然后根据自己的喜好初始化变量。我选择让我的传感器延迟正常，并将我的精度灵敏度设置为高。

```
mySensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
mySensor = mySensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
mySensorManager.registerListener(this, mySensor, SensorManager.SENSOR_DELAY_NORMAL, SensorManager.SENSOR_STATUS_ACCURACY_HIGH); 
```

现在您将需要一个 onSensorChanged 函数，该函数将在您的传感器每次感应到变化时运行。在此功能中，您可以为您的球设置动画。

```
@Override
public void onSensorChanged(SensorEvent event) {
    x = event.values[0];

    // The x value in the accelerometer is the 0th index in the array

    // Now you may do what you wish with this x value, and use it to move your ball 
    }
} 
```

# php - 存储过程不适用于 PHP 调用

> ID：10774612
> 
> 赞同：3
> 
> 时间：2012-05-27T14:15:25.740
> 
> 标签：php, mysql, stored-procedures

> **可能重复：**
> [无法在给定上下文中返回结果集](https://stackoverflow.com/questions/1200193/cant-return-a-result-set-in-the-given-context)

我正在尝试使用 PHP 调用一个基本的存储过程。但是 mysql 会产生类似“PROCEDURE softland.getAllProducts can't return a result set in the given context”的错误。

存储过程

```
 DELIMITER //
 CREATE PROCEDURE GetAllProducts()
 BEGIN
 SELECT *  FROM products;
 END //
 DELIMITER ; 
```

PHP代码是

```
<?php
$con=mysql_connect("localhost","root","");
mysql_select_db("softland",$con);
$id = 1;
$result = mysql_query("call getAllProducts()");
echo $result;

if ($result === FALSE) {
die(mysql_error());
}
while($row=mysql_fetch_array($result)){
    echo "<br>".$row['name'];
}
echo "Succees";
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:06:36.847

好吧，这个答案直接来自[mysql_connect](http://de3.php.net/manual/en/function.mysql-connect.php#86645)上的 php 页面：

> $this->con = mysql_connect($this->h,$this->u,$this->p,false,65536);

它告诉您的 mysql 客户端使用多语句支持（另请参阅 mysql 客户端常量： http: [//php.net/manual/en/mysql.constants.php#mysql.client-flags](http://php.net/manual/en/mysql.constants.php#mysql.client-flags)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:28:54.747

尝试这个，

```
Function GetProducts($out)
{
    $query.= "CREATE PROCEDURE GetAllProducts() ";
    $query.= "BEGIN";
    $query.= "SELECT *  FROM products;";
    $query.= "END";
    return $query;
} 
```

在代码中放这个，

```
$result = mysql_query(GetProducts()); 
```

希望有效！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T14:52:33.147

我认为问题在于您使用的是旧的 mysql 函数而不是[新的 mysqli library](http://www.php.net/manual/en/book.mysqli.php)。

尝试按照[本手册页](http://php.net/manual/en/mysqli.quickstart.stored-procedures.php)上的示例进行操作。

# haskell - 使用镜片有什么好处和坏处？

> ID：10774614
> 
> 赞同：26
> 
> 时间：2012-05-27T14:15:37.413
> 
> 标签：haskell, lenses

[镜头](http://hackage.haskell.org/package/lenses)似乎没有任何缺点，同时比标准 Haskell 具有显着优势：**有什么理由我不应该尽可能使用镜头吗？**是否有性能考虑？此外，模板 Haskell 是否有任何重大开销？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-27T14:41:05.897

镜头形成了在数据构造函数上使用直接闭包的替代方案。因此，镜头与直接使用函数和数据构造函数具有大致相同的注意事项。

由于这个原因的一些缺点：

*   每次修改镜头时，都可能会导致（重新）创建大量对象。例如，如果你有这个数据结构：

    ```
    A { B { C { bla = "foo" } } } 
    ```

    ...和类型的镜头`Lens A String`，您将创建一个新的`A`，`B`并且`C`每次您“修改”该镜头。这在 Haskell 中并不少见（创建大量对象），但对象创建隐藏在镜头后面，因此很难将其视为潜在的性能接收器。

*   由于使用了“映射功能”，镜头还可能导致效率低下。例如，如果您制作一个修改列表中第 26^个元素的镜头，由于查找时间的原因，它可能会导致很多减速。

和优点：

*   镜头与普通记录相结合，可以很好地与状态单子一起使用（参见[`data-lens-fd`](http://hackage.haskell.org/package/data-lens-fd)示例），由于广泛的数据共享，这使得在大多数情况下*可以避免重新创建大量对象。*例如，参见函数，以及在 Snap Web 框架[`focus`](http://hackage.haskell.org/packages/archive/data-lens-fd/2.0.2/doc/html/Data-Lens.html#v%3afocus)中使用函数的类似模式。`withSomething`
*   Lenses 显然实际上并没有就地修改任何内存，因此当您需要在并发上下文中推理状态时，它们非常有用。因此，在处理各种图形时，镜头将非常有用。

然而，镜头并不总是与数据构造函数上的闭包同构。以下是一些差异（[`data-lens`](http://hackage.haskell.org/package/data-lens)这里作为实现）：

*   大多数镜头实现使用某种形式的数据类型将“访问器”和“修改器”存储为一对。因为`data-lens`，它是[`Store`comonad](http://hackage.haskell.org/packages/archive/comonad-transformers/latest/doc/html/Control-Comonad-Trans-Store.html#t%3aStore)。这意味着每次创建镜头时，都会因为创建数据结构而产生非常小的额外开销。
*   因为镜头通过一些未知的映射依赖于值，所以对垃圾收集进行推理可能会变得更加困难，并且您可能会遇到（逻辑）内存泄漏，因为您忘记了您正在使用一个非常通用的镜头，该镜头依赖于一些大块的内存。例如，一个镜头访问某个大向量中的元素，该镜头与另一个镜头组合，因此隐藏了第一个镜头，因此很难看出组合镜头仍然依赖于大量内存。

模板 Haskell 代码在编译时运行，并且不会影响镜头的运行时性能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-27T14:24:51.797

我假设*data-lens*包。Lenses 在数据类事物（记录、元组、地图等）方面对我来说表现得非常好。事实上，它们有时甚至比正常方法表现得更好，可能是因为更好的共享。在性能方面，它产生的性能与您手动编写的代码大致相同。

但是，有一些类似功能的东西，镜头可能会受到惩罚。例如，我记得至少有一次使用过这样的镜头：

```
result :: (Eq a) => a -> Lens (a -> b) b 
```

虽然查询非常快，但我偶尔会覆盖函数的某些结果值以将其调整到特定场景，这相当于将函数的主体封装在一个大的`if`. 当然，性能影响与镜头本身无关，但值得注意。

# jquery - 转义 jQuery 附加字符串以使用变量作为“href”目标和内部元素

> ID：10774617
> 
> 赞同：1
> 
> 时间：2012-05-27T14:16:41.077
> 
> 标签：jquery

我正在构建一个脚本，用于生成页面上标题（当前仅）的目录（as）。

我在附加没有 id 的元素时遇到问题，因为我想将 href 目标分配给链接，并使用变量作为链接的内容。

我正在处理的代码：

```
 var h_num; // introduce the running id counter
        $("h2").each(function (i) {
            // retrieve the text contained in the element
            $h_content = $(this).text();
            // add a running id to the h2
            $(this).attr("id", ("h2_"+i));
            // the id attribute value that was just added to the element
            $h_num = ("h2_"+i);
            $new_id = ("#" + $h_num);
            console.log($h_num, "hoonum", $new_id, "newid"); //for debugging
            // append a <li> element with a link to the heading 
            $('#toc ol').append(
                '<li>' + '<a href="$h_num">$h_content'
            );
        }); 
```

所以我找不到一种方法来逃避 append 函数中的行。

$h_content 是标题的标题（作为标题链接的文本包含在内），$new_id 是 href 目标 ID。

我希望目录的标记看起来像这样

```
<ol>
    <li><a href="#h2_0">First heading topic</a></li>
    <li><a href="#h2_1">Second heading topic</a></li>
</ol> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:23:08.827

出于性能目的，您应该附加到`documentFragement`第一个。

```
 var frag = document.createDocumentFragment();
    $("h2").each(function (i, el) {
        var li = document.createElement( "li" );
        var $a = $("<a>", { id: "h2_" + i }).text( $(el).text() );
        li.appendChild( $a[0] )
        frag.appendChild( li );
    });
    $("ol").append(frag);
​ 
```

[http://jsfiddle.net/landau/RyeAA/](http://jsfiddle.net/landau/RyeAA/)

[http://jsfiddle.net/landau/RyeAA/5/](http://jsfiddle.net/landau/RyeAA/5/) - 更新版本

# joomla - 是否可以在 Joomla 中获得剪辑之前的文章部分？

> ID：10774619
> 
> 赞同：0
> 
> 时间：2012-05-27T14:16:48.003
> 
> 标签：joomla, joomla-article

我有一个 Joomla 网站，我需要更改部分文本的位置，即介绍性文本（剪切前）。“更改位置”意味着将其设置在文章的顶部，其余文本应保持在现在的位置。所以，由于文章的文字是固定的东西，我不能用 Joomla 的常用工具将它分成几部分。可能有可能在一些 PHP 变量中获取介绍文本并将其设置为模块，我可以将其插入到我需要的地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T23:19:47.707

将“文章”切成两半并直接将它们分成不同的部分是不可能的。但是有一些解决方法：

**1）**如果不是什么大问题，我的意思是如果只是通过添加一些 css/html 代码就可以完成这项工作，比如你需要一个分隔符或其他东西，那么你应该安装[JCE 编辑器](http://www.joomlacontenteditor.net/)

**2）如果您想在完全不同的***位置模块*中向特定页面显示一些消息，那么您应该通过添加一些 PHP 代码来稍微更改您使用的模板。假设您有一个联系页面，您想要一个链接到您的 fb 或类似的东西...打开您的模板 index.php，转到您要添加它的位置并添加这些代码行...。

```
<?php 
    $currentpage = JSite::getMenu()->getActive()->name ;   
     $currentpage = JSite::getMenu()->getActive()->title;  // for joomla 2.5 remove this if your using another version
    if($currentpage == "Contact"){
        echo '<p>Go visit <a href="http://facebook.com/xyz">my page</a> !</p>';
        echo '<jdoc:include type="modules" name="Contact_message" />'; // if you want to add a position for your contact page and so you can add some custom modules to add some text or whatever you want ...
    }
?> 
```

您可以根据需要更改/添加代码......希望这有帮助！

# javascript - 如何禁用表单中的输入按钮？

> ID：10774621
> 
> 赞同：1
> 
> 时间：2012-05-27T14:17:28.740
> 
> 标签：javascript, html

我有这个 HTML 表单：

```
<head>
<title>log in</title>
</head>
<body>
<form action="login.php" method="POST">
user name : <input type="text" name="user"> <br>
user pass : <input type="password" name="pass"> <br>
<input type="submit" value="submit"> 
</form>
</body> 
```

我想让它只能通过单击按钮提交表单 - 而不是按`Enter`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T14:25:48.760

有很多解决方案。这是最简单的一种：

```
<html>
<head>
    <title>log in</title>
</head>
<body>
    <form action="login.php" method="POST" onsubmit="return false;">
        user name : <input type="text" name="user"> <br>
        user pass : <input type="password" name="pass"> <br>
        <input type="button" value="submit" onclick="this.parentNode.submit();"> 
    </form>
</body>
</html>​​​​​​​​ 
```

**演示：http:** [//jsfiddle.net/EFDZ2/](http://jsfiddle.net/EFDZ2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-05T06:12:04.403

这对我来说最有效：

```
<input id="input_id" type="text">

<script>
    // prevent the enter key from submitting the form if input_id has focus to prevent accidental submission
    document.getElementById('input_id').addEventListener('keypress', function(event) {
        if (event.keyCode == 13) {
            event.preventDefault();
        }
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-28T05:10:20.107

只是为了补充 VisioN 的答案，可能存在输入不是表单的直接子级的情况，因此在这些情况下，只需引用表单即可`this.form`。

```
<html>
<head>
    <title>log in</title>
</head> 
<body>
    <form action="login.php" method="POST" onsubmit="return false;">
        user name : <input type="text" name="user"> <br>
        user pass : <input type="password" name="pass"> <br>
        <div>
            <input type="button" value="submit" onclick="this.form.submit();">
        </div>
    </form>
</body>
</html>​​​​​​​​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-28T05:23:29.613

将以下脚本添加到页面的部分。

```
<script type="text/javascript">
    function stopRKey(evt) 
    {
        var evt = (evt) ? evt : ((event) ? event : null);
        var node = (evt.target) ? evt.target : ((evt.srcElement)?evt.srcElement : null);
        if ((evt.keyCode == 13) && (node.type=="text"))  
        {
            return false;
        }
   }
   document.onkeypress = stopRKey;
</script> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-03-23T14:52:17.803

事实上，我认为答案比这更简单。如果您不希望 Enter 键导致提交，请不要​​在表单中输入“提交”类型的按钮或输入。onsubmit="返回假；" 没有为我做任何事。火狐 27 和 IE 11。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-27T14:37:13.390

```
$(document).ready(function() {

    function checkKey(e) {
        if (e.keyCode == 13) {

            if (!e) var e = window.event;

            e.cancelBubble = true;
            e.returnValue = false;

            if (e.stopPropagation) {
                e.stopPropagation();
                e.preventDefault();
            }
        }
    }

    $("input").keydown(checkKey);
})​ 
```

这应该适用于所有浏览器。它需要 JQuery 让生活变得更简单。 **演示：http:** [//jsfiddle.net/WDvvY/](http://jsfiddle.net/WDvvY/)

# jquery - 用户使用 jQuery 选择 cookie 设置/检查

> ID：10774625
> 
> 赞同：0
> 
> 时间：2012-05-27T14:18:10.933
> 
> 标签：jquery, cookies

这是一个带有语言选择的模态窗口，如果用户选择选项 1，模态将隐藏，并存储一个 cookie，因此用户不会再次看到模态。如果选择了选项2，页面会重定向并存储一个cookie，因此页面每次都会根据cookie重定向用户。

即使设置了 option1 cookie，当前代码也会重定向用户，我不知道如何单独检查 cookie。

编辑：在@Miloš 和@balexandre 的帮助下的工作代码：

```
$(document).ready(function(){
var myurl = "http://domain.com/";
//var currenturl = $(location).attr('href');
//console.log(myurl, location.href);
if (myurl == location.href) {

    var lang = $.cookie('lang');
    if (lang) {
        if (lang == 'es') {
            window.location.href = "http://domain.com?lang=es";
        }
    }
    else {
var _message_to_show = 'Chosse your preferred language<br/><a href="#" id="modal_close">ENGLISH</a><span id="lang_right"><a href="http://domain.com?lang=es" id="modal_exit">ESPANOL</a></span>';

    $.fancybox(
        _message_to_show,
        {
        'width'             : 350,
        'height'            : 300,
        'transitionIn'      : 'none',
        'transitionOut'     : 'none',
        'centerOnScroll'    : 'true',
        'overlayOpacity'    : 0.9,
        'overlayColor'      : '#000',
        'modal'             : 'true'
        }
    );

    $('#modal_close').live('click', function(e) {
     $.cookie("lang", "en", { path: '/', expires: 7 });
        e.preventDefault();
        $.fancybox.close();
    });

    $('#modal_exit').live('click', function(e) {
    $.cookie("lang", "es", { path: '/', expires: 7 });
        e.preventDefault();
        $.fancybox.close();
        window.location.href = "http://domain.com?lang=es";
    });
}
} else {
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:35:16.153

我会说你从一开始就做错了。您正在尝试存储有关用户选择语言的信息，它只能是一种语言，对吗？为什么要存储两个内容为“true”的不同cookie？例如，您可以存储一个名为“lang”的 cookie，并将其内容设置为“en”或“es”或用户选择的任何语言。然后你会有：

```
var lang = $.cookie('lang');
if (lang) {
    if (lang == 'es') {
        redirect
    }
}
else {
    display modal
} 
```

如果您绝对必须使用不同的 cookie，例如因为您正在扩展现有的 CMS 或框架或其他任何东西，您应该像这样将 if 分开：

```
if (!$.cookie('en')) {
    if (!$.cookie('es')) {
        display modal
    }
    else {
        redirect
    }
} 
```

# mysql - Mysql group by 查询优化

> ID：10774626
> 
> 赞同：0
> 
> 时间：2012-05-27T14:18:12.743
> 
> 标签：mysql, query-optimization

我在mysql中有这样的查询

```
select count(*) 
from (
    select count(idCustomer)
    from customer_details 
    where ... 
    group by idCustomer having max(trx_staus) = -1 
) as temp 
```

因此，基本上找到满足某些条件（一个或两个）且最大交易状态 = -1（其他可以是 2、3、4）的客户数量。但是这个查询在我的本地机器上大约需要 30 分钟，在高配置服务器上大约需要 13 秒（大约 20 GB 内存和 8 核处理器）。我在表中有 13 行。我知道 group by 和 max 功能太昂贵了。我能做些什么来优化这个查询。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:27:53.123

内部查询必须检查*所有*行以确定聚合最大值；如果您想对此进行优化，请将包含最大值的计算字段添加到您的客户表中并在其上进行选择。

诀窍是使该字段保持最新:)

# c# - WPF 按钮网格

> ID：10774628
> 
> 赞同：0
> 
> 时间：2012-05-27T14:18:20.907
> 
> 标签：c#, wpf, button, binding, grid

我想制作一个按钮平板电脑，它由 1 .. 10 个按钮组成。

现在我有一个网格，它有行和列，可以说 2 列，5 行，但这不是很动态。

我有一些 xml 源代码，它指定了该网格中有哪些按钮和多少按钮，它们应该是什么样子，行和列的位置。

如何在位置动态插入按钮？

在 TabletViewModel 我有一个 ButtonViewModels 的集合，它是 TabletView（网格）的 DataContext

ButtonViewModel 保存按钮的文本、图像文件名、行和列，是一个按钮的 DataContext。

我想到了类似 itemsource Binding 的东西，但我不知道如何使用网格和按钮进行此 Binding。（动态网格视图？）

我怎样才能做到这一点？任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:30:13.873

或者也许考虑使用带有 WrapPanel 的 ItemsControl

```
<ItemsControl>
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:23:32.633

试试这个

```
(assuming x:Name="myGrid" in markup)

// add rows to grid (it's the same deal for columns too)
 for (int row=0;row < numRows; row++)
 {
 myGrid=RowDefinitions.Add(new RowDefinition());
 }

(I'd be interested to see if there is a slicker way of doing this bit. )

// Stick a control in intended location

b = new Button();

myGrid.Children.Add(b);
 Grid.SetRow(b,1); // 2nd row
 Grid.SetColumn(b,3); // 4th column
 Grid.SetColumnSpan(b,2); 
```

# android - OnClicklisteners 和消息框问题？

> ID：10774629
> 
> 赞同：0
> 
> 时间：2012-05-27T14:18:28.987
> 
> 标签：android

嗯..我收到一个错误，说构造函数未定义。

```
Dele.setOnClickListener(new OnClickListener() {

           public void onClick(View arg0) {

    EditText DelSel = (EditText) findViewById(R.id.ETDeleteSelect);

                   int Id = Integer.parseInt(DelSel.getText().toString());

                   builder = new ***AlertDialog.Builder(this);***
                   builder.setMessage("Are you sure you want to exit?")
                          .setCancelable(false)
                          .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                              public void onClick(DialogInterface dialog, int id) {
                                   MyActivity.this.finish();
                              }
                          })
                          .setNegativeButton("No", new DialogInterface.OnClickListener() {
                              public void onClick(DialogInterface dialog, int id) { 
```

有人可以告诉我解决方法是什么吗？我收到一个错误，称为

“构造函数 AlertDialog.Builder(new View.OnClickListener(){}) 未定义”

我想要做的是在单击按钮时打开一个消息框继续与否。所以有人请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:46:23.023

替换`this`为：

```
builder = new AlertDialog.Builder(YourActivityName.this); 
```

构造`AlertDialog.Builder`函数需要一个`Context`引用，现在您给它一个`OnClickeListener`引用（因为您在声明为侦听器`this`的匿名类中使用）。`OnClickListener`

# ios - 防止调用子类中的继承方法

> ID：10774631
> 
> 赞同：3
> 
> 时间：2012-05-27T14:19:00.683
> 
> 标签：ios, objective-c

我有一个`UIView`继承了该`- initWithFrame:`方法的子类。但是，我不希望在我的子类上调用该方法。有没有办法在我的子类上“删除”该方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T14:22:16.787

不要实现它，不要调用`[super initWithFrame:aRect]`. 只需[`doesNotRecognizeSelector:`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/doc/uid/20000050-doesNotRecognizeSelector_)使用`_cmd`参数调用：

```
- (id)initWithFrame:(CGRect)aRect
{
    [self doesNotRecognizeSelector:_cmd];
} 
```

如果该方法没有返回`void`，您将收到来自编译器的警告：

> 控制到达非空函数的末尾。

要“删除”此警告，请添加`return self;`（在这种情况下）作为最后一行以使编译器满意。它永远不会在运行时到达，因为`doesNotRecognizeSelector:`会引发`NSInvalidArgumentException`异常。

# javascript - Javascript：注册事件处理程序的最佳位置

> ID：10774632
> 
> 赞同：5
> 
> 时间：2012-05-27T14:19:04.853
> 
> 标签：javascript, html, events

这个问题是如此基本，我敢肯定 in must be a duplicate of *something*，即使我已经[寻找类似的东西](https://stackoverflow.com/search?q=javascript%20where%20event%20handler)。

我的问题基本上是：**最初为 HTML 元素注册事件处理程序的最佳位置在哪里**？

注册事件处理程序的最简单方法显然是内联：

```
<div id = "mybutton" onclick = "doSomething()">Click me</div> 
```

但这与现代 Web 开发中逻辑和内容分离的压倒性进展背道而驰。因此，在 2012 年，所有逻辑/行为都应该在纯 Javascript 代码中完成。这很棒，而且它会导致更易于维护的代码。但是你仍然需要一些初始的*钩子*来连接你的 HTML 元素和你的 Javascript 代码。

通常，我只是做类似的事情：

```
<body onload = "registerAllEventHandlers()"> 
```

但是......这仍然是“作弊”，不是吗 - 因为我们在这里仍然使用内联 Javascript。但是我们还有其他选择吗？我们不能`<script>`在该部分的标签中执行此操作`<head>`，因为此时我们无法访问 DOM，因为页面尚未加载：

```
<head>
<script type = "text/javascript">
    var myButton = document.getElementById("mybutton"); // myButton is null!
</script>
</head> 
```

我们是在页面*底部*`<script>`放置标签还是什么？喜欢：

 *```
<html>
<body>
...
...
<script type = "text/javascript">
   registerAllEventHandlers();
</script>
</body>
</html> 
```

这里的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:23:03.090

您可以使用`window.onload`：

```
<script type = "text/javascript">
  window.onload = registerAllEventHandlers;
</script> 
```

或者，如果您使用[jquery](/questions/tagged/jquery "显示标记为“jquery”的问题")：

```
$(registerAllEventHandlers); 
```

使用`onload`是有效的，因为它会`onload`立即注册事件，但会在 DOM 准备好时触发它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:23:19.400

我对此[有类似的回答](https://stackoverflow.com/a/10661977/575527)，但总体上是关于 JavaScript 的。但是思路还是一样的——在关闭正文之前加载脚本。

利用抽象`window.onload`和 DOM 就绪事件的库。这样，您可以在 DOM 准备好后立即加载脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T14:27:23.797

您应该在 DOM 准备好后立即注册您的事件处理程序。在所有浏览器中检测到这一点并不总是那么容易，尽管除了 IE 8（及更早版本）之外，最广泛使用的浏览器现在都支持该[`DOMContentLoaded`](https://developer.mozilla.org/en/DOM/DOM_event_reference/DOMContentLoaded)事件（感谢[genkev](https://stackoverflow.com/users/689161/gengkev)在评论中指出这一点）。

这本质上等同于`registerAllEventHandlers`在`body`您的 .

它比使用要好得多，`window.onload`因为直到所有页面的资产（图像、CSS 等）都加载后才会执行。

如果您使用主要的 JavaScript 框架之一，那么您可以很容易地检测到 DOM 何时准备就绪，即使在旧版本的 IE 中也是如此。使用**jQuery**，您将使用该[`ready`事件](http://api.jquery.com/ready/)：

```
jQuery(document).ready(function () {
    // Your initialisation code here
}); 
```

或简写：

```
jQuery(function() { … }); 
```

使用**原型**，您将使用[`dom:loaded`事件](http://www.prototypejs.org/api/document/observe)：

```
document.observe("dom:loaded", function() {
    // Your initialisation code here
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T15:24:41.680

就个人而言，我对添加`onlclick="doSomething();"`元素没有任何问题。没有逻辑，只是一个函数调用。

所有逻辑都在它应该在的地方：在定义的函数中`HEAD`或单独的文件中。

`href="somepage.html"`告诉我添加或什`href="somepage.html#someanchor"`至添加到 A 标签时有什么区别。*

# tweepy - 无法从 git 将 tweepy 安装到 Python 库

> ID：10774634
> 
> 赞同：0
> 
> 时间：2012-05-27T14:19:19.167
> 
> 标签：tweepy

我试过了：

git clone git://github.com/joshthecoder/tweepy.git cd tweepy python setup.py install

我得到一个突出显示“克隆”的语法错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T14:21:57.923

试试看

```
easy_install tweepy 
pip install tweepy 
```

PS：在 debian 安装之前在控制台上运行这个

```
sudo apt-get install easy_install 
```

# http - 跟踪 http 会话

> ID：10774645
> 
> 赞同：0
> 
> 时间：2012-05-27T14:20:45.430
> 
> 标签：http, trace

在开发环境中（通常浏览器和 http 服务器在同一台机器上），我想研究身份验证模式的确切细节。所以我需要追踪每个http请求/响应。

1.  我已经尝试过 WireShark，这是非常有前途的。但实际上在 Windows 机器上，嗅探环回接口上的流量存在问题。

2.  然后我尝试了一个浏览器插件，Firefox 12 的 HttpFox 0.8.10。它在显示请求和响应方面很好，但在特定的身份验证情况下，它没有正确显示“双跳”身份验证，它“崩溃” " 第一个请求（未授权状态代码）与下一个成功请求。

3.  然后我尝试使用 httpd 的日志，那是我的实际服务器，但是创建一个包含所有请求（例如标头（授权标头））的日志需要付出不小的努力。所以它不会似乎是一种很好的“调试”技术。

还有其他可能性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T16:03:20.617

使用 Wireshark。[这个问题的答案](https://stackoverflow.com/questions/46376/windows-packet-sniffer-that-can-capture-loopback-traffic)将解决环回问题。Wireshark 是最好的，因为它真正了解与 HTTP 相关的所有内容的格式（只要您不使用 HTTPS）。

# gnuplot - gnuplot：如何并排放置两个数字

> ID：10774646
> 
> 赞同：6
> 
> 时间：2012-05-27T14:20:52.273
> 
> 标签：gnuplot

我正在尝试使用带有 multiplot 的 gnuplot 并排放置两个数字。我希望生成的图像是矩形的，所以我使用 set size 2, 1。我还设置了 set multiplot layout 1, 2 选项。但是，生成的图像仅使用可用空间的左侧部分。任何帮助将不胜感激。谢谢艾哈迈德

这是生成的图像 [http://tinypic.com/r/33mlz04/6](http://tinypic.com/r/33mlz04/6)

下面是我正在使用的 gnuplot 命令。

```
设置终端后记 eps 颜色增强
设置输出'figure.eps'；
设置大小 2,1；

设置多图布局 1, 2 ;
设置标题“图1”；
  绘制“data1.txt”
设置标题“图1”；
 绘制“data2.txt”
未设置多图

```

虽然我不太确定，但经过一些试验和错误，我已经解决了

```
    设置终端后记 eps 颜色增强

    设置输出'eps/image.eps'；
    设置大小 1,0.5；

    设置多图布局 1, 2 ;
    设置标题“图1”；
    设置大小 0.5,0.5；
    绘制“数据/data1.txt”
    设置标题“图1”；
    设置大小 0.5,0.5；
    绘制“数据/data2.txt”
    未设置多图

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-27T14:38:47.593

尝试类似：

```
set terminal postscript eps color enhanced size 10,5
set output 'figure.eps';

set multiplot layout 1, 2 ;
set title "Figure 1";
plot  "data1.txt" 
set title "Figure 1";
plot  "data2.txt" 
unset multiplot 
```

当您在终端规范行上设置大小时，它决定了绘图画布的实际大小（在这种情况下以英寸为单位）。当您`set size`在单独的行上使用时，它将以画布大小的相对单位设置绘图的大小。这在旧版本的 gnuplot 中有所不同。为了获得更好的解释，请尝试`help set size`使用 gnuplot。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-27T15:46:40.390

为了更好地控制绘图的大小/位置，您可以`set origin`结合使用`set size`来更改每个绘图的位置和大小。最后，可以使用`set lmargin at <place>`(and `set rmargin ...`) 等来实现最大程度的控制`tmargin`，`bmargin`其中“lrtb”分别代表左、右、上和下。

因此，要获得一个填充所有可用空间（从左到右）的绘图，您可以：

```
set multiplot
set lmargin at 0
set rmargin at .5
plot sin(x)
set lmargin at .5
set rmargin at 1
plot cos(x)
unset multiplot 
```

然而，这（通常）是矫枉过正的。通常 gnuplot 会尝试为您的标签等设置足够大的边距，但设置边距会显式禁用它。我建议您使用 andyras 的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-26T10:54:12.310

如果您在使用此方法处理超过 2 个数字时遇到问题，请在“设置大小 0.5,0.5”之后添加“设置原点 0,0”。例如，对于三个数字：

```
set terminal postscript eps color enhanced 

set output 'eps/image.eps'; 
set size 1.5,0.5;

set multiplot layout 1, 3 ;
set title "Figure 1";
set size 0.5,0.5;
set origin 0,0
plot  "data/data1.txt" 
set title "Figure 2";
set size 0.5,0.5;
set origin 0,0
plot  "data/data3.txt"
set title "Figure 3";
set size 0.5,0.5;
set origin 0,0
plot  "data/data3.txt" 
unset multiplot 
```

# ruby - 安装 gem 时，应该只安装库，还是应该安装可执行文件？

> ID：10774648
> 
> 赞同：0
> 
> 时间：2012-05-27T14:21:10.760
> 
> 标签：ruby, rspec, gem

我已经使用 gem (gem install rspec) 命令安装了 RSpec。一切顺利。如果我尝试再次重新安装它，我会收到一条消息，就像它已经安装了一样。

当我尝试从 Ubuntu 的命令行使用 rspec 时，终端找不到该程序。

我的问题是 gem 命令是否只安装库，这意味着我需要自己手动安装 rspec 可执行文件，还是 gem 命令应该安装所有内容，这意味着安装过程中出现问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T01:30:56.933

我已经确认可执行文件确实已安装并且应该能够自行运行。

您可以通过使用以下命令检查已安装 gem 的列表来验证 gem 是否已安装：gem 查询。

您还可以使用以下命令检查 gem 使用的路径：gem env。

这应该为您提供 gem 正在使用的 Ruby 版本的路径、它们的可执行路径（以便您可以更新路径）以及它们的存储位置。

确保它们被配置为使用正确的 Ruby 版本（如果您使用多个版本）并且路径在您的 $PATH 变量中。

# android - 如何在 Android 设备上重置 notifyAuthFailure 标志 (android.accounts.AccountManager)

> ID：10774649
> 
> 赞同：2
> 
> 时间：2012-05-27T14:21:28.017
> 
> 标签：android, oauth-2.0, reset, flags

我正在开发一个 Android 应用程序，我想在我的设备上重置 notifyAuthFailure 标志，以便我的设备再次提示我。

我有以下方法调用：

accountManager.getAuthToken(account, "oauth2:https://www.googleapis.com/auth/‌​analytics.readonly", ***true*** , new AccountManagerCallback() {

[在这里查看 api](http://developer.android.com/reference/android/accounts/AccountManager.html#getAuthToken%28android.accounts.Account,%20java.lang.String,%20boolean,%20android.accounts.AccountManagerCallback%3Candroid.os.Bundle%3E,%20android.os.Handler%29)

如何重置我的 Android 设备以便再次收到提示？

# python - Django 中 DateTimeInput 的显示和输入的日期时间格式相同

> ID：10774650
> 
> 赞同：1
> 
> 时间：2012-05-27T14:21:37.667
> 
> 标签：python, django, django-forms, python-datetime

默认情况下，Django 将日期/时间显示为类似`May 13th, 2010, 4:01 p.m.`. 我还配置了一个 jQuery[日历插件](http://trentrichardson.com/examples/timepicker/)（我使用`dateFormat: "MM d, yy", timeFormat: "h:mm tt"`并修改了 JavaScript 源代码以输出`a.m.`and`p.m.`而不是`AM`and `PM`）来以相同的格式显示日期/时间。

但是表单验证（默认情况下）采用以下形式

```
DATETIME_INPUT_FORMATS = (
    '%Y-%m-%d %H:%M:%S',     # '2006-10-25 14:30:59'
    '%Y-%m-%d %H:%M:%S.%f',  # '2006-10-25 14:30:59.000200'
    '%Y-%m-%d %H:%M',        # '2006-10-25 14:30'
    '%Y-%m-%d',              # '2006-10-25'
    '%m/%d/%Y %H:%M:%S',     # '10/25/2006 14:30:59'
    '%m/%d/%Y %H:%M:%S.%f',  # '10/25/2006 14:30:59.000200'
    '%m/%d/%Y %H:%M',        # '10/25/2006 14:30'
    '%m/%d/%Y',              # '10/25/2006'
    '%m/%d/%y %H:%M:%S',     # '10/25/06 14:30:59'
    '%m/%d/%y %H:%M:%S.%f',  # '10/25/06 14:30:59.000200'
    '%m/%d/%y %H:%M',        # '10/25/06 14:30'
    '%m/%d/%y',              # '10/25/06'
) 
```

我尝试添加`'%B %d, %Y, %I:%M %p'`，但我不确定是否`%p`考虑了`a.m.`and `p.m.`（注意字母后面的句点）。这是 Python 关于[日期/时间格式](http://docs.python.org/library/datetime.html#strftime-and-strptime-behavior)的文档的链接。

你们是怎么做到的？您是坚持使用 Django 的默认（丑陋）日期/时间格式，还是在检查之前以某种方式转换时间`form.is_valid()`（无论是在 JavaScript 还是 Python 中）？

* * *

**编辑**@Thomas Orozco

我写了一个新的表单域，叫做`CustomDateTimeField`：

```
class CustomDateTimeField(forms.DateTimeField):
    def strptime(self, value, format):
        return datetime.datetime.strptime(value.replace("a.m.", "AM").replace("p.m.", "PM"), "%B %d, %Y, %I:%M %p") 
```

但是，我的表单`ModelForm`使用`fields`在`class Meta`. 这就是我的意思：

```
def order_edit(request, pk):
    order = Order.objects.get(pk=pk)

    if foo:
        include_fields = (
            'fa_date',
            'sa_date',
        )
    else:
        include_fields = (
            'sa_date',
        )

    class OrderDetailForm(forms.ModelForm):
        class Meta:
            model = Order
            fields = include_fields

    if request.method == 'POST':
        form = OrderDetailForm(data=request.POST, instance=order) 
```

where`Order.sa_date`和`Order.fa_date`are both `models.DateTimeField`。而且我认为我只能使用`DateTimeInput`for `ModelForm`'s `widgets`。那么我将如何告诉表单`CustomDateTimeField`用于`OrderEditForm`？我是否需要通过添加额外的论点`__init__`并手动重新定义类似的字段`self.fields['fa_date'] = CustomDateTimeField(...)`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T20:44:24.450

## 初步答案

如果您希望您的字段接受特定格式，更简单的解决方案是实现您自己的表单字段，这通常很容易，尤其是在这里，因为 Django 方便地为您提供了一个高效的基类。

事实上，查看[django 源代码](https://github.com/django/django/blob/master/django/forms/fields.py)，`DateTimeField`您可以看到它继承自`BaseTemporalField`. 因此，您只需要子类`BaseTemporalField`化并实现该`strptime`方法，以便它接受您的输入格式。

所述输入格式应该通过`input_formats`变量传递给您的实例，但如果您愿意编写更多代码，这不是必需的。

您还可以浏览代码`DateTimeField`并`DateField`获得一些灵感。

## 编辑

您实际上[可以覆盖 a 的字段`ModelForm`](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#overriding-the-default-field-types-or-widgets)：您只需重新定义它们。但是，在您的情况下，您不能使用条件块来执行此操作（您不能`if`在类定义中包含语句！）。所以你有两个解决方案：

```
class SAOrderDetailForm(forms.ModelForm):
    class Meta:
        model = Order
        fields = ('sa_date',)
    sa_date = CustomDateTimeField()

class FASAOrderDetailForm(SAOrderDetailForm): #Inheritance matters!
    class Meta:
        model = Order
        fields = ('sa_date','fa_date')
    fa_date = CustomDateTimeField()

if foo:
    FormClass = FASAOrderDetailForm
else:
    FormClass = SAOrderDetailForm 
```

或者，您可以使用表单类的动态创建，但这显然超出了这个问题的范围，所以我将留给您[来自 James Bennett 的这篇文章](http://www.b-list.org/weblog/2008/nov/09/dynamic-forms/)，解释如何做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T20:35:17.380

`%p`呈现的内容取决于所使用的语言环境。我不确定是否有任何语言环境提供`a.m.`/ `p.m.`。

但是，最简单的方法是为表单字段提供您自己的验证功能。如果这是一次性字段，只需覆盖`clean_fieldname(self)`表单的方法（其中*fieldname*是日期时间字段的名称）。请参阅[清理特定字段属性](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)。

如果您将重复使用此字段，请使用您的验证逻辑创建一个自定义字段，并在需要自定义验证时导入并使用它。您还可以自定义小部件以呈现任何 jquery 选择器。

# c++ - UTF-8 到宽字符的转换

> ID：10774653
> 
> 赞同：1
> 
> 时间：2012-05-27T14:22:01.370
> 
> 标签：c++, c, windows, unicode

```
#ifndef UNICODE
#define UNICODE
#endif

#include <Windows.h>
#include <cstdio>
#include <fstream>

using namespace std;

int main()
{
    FILE* resFile;
    char multiByteStr[256];
    ifstream oFile;
    FILE* exampleFile;
    TCHAR buffer[256];      
    system("chcp 65001");

    resFile = _wfopen(L"foo",L"w, ccs=UTF-8");             
    fwprintf(resFile,L"%s",L"C:\\exsistingFolder\\zażółć gęśłą jaźń ☺☻♥♦• ć.txt");    
    fclose(resFile);   

    oFile.open(L"foo");    
    oFile.getline(multiByteStr,256,'\n');       
    oFile.close();    

    MultiByteToWideChar(CP_UTF8,0,multiByteStr,256,buffer,256);    
    wprintf(L"%s",buffer);

    exampleFile = _wfopen(buffer,L"w, ccs=UTF-16LE");       
    fwprintf(exampleFile,L"%s",buffer);     
    fclose(exampleFile);

    system("pause");
    return 0;
} 
```

如您所见，程序应该创建文件“foo” `resFile`，其中包含要创建的文件的完整路径，并且这个新文件`exampleFile`应该包含自身的路径。尽管在 Visual Studio 2010 的调试过程中自动生成缓冲区具有正确的字符串，但不会创建 exampleFile。为什么？
还有一件事：为什么`wprintf`不输出扩展字符，虽然我已经将控制台的字体切换到了 Lucida Console - 可以处理未编码字符的那个。

附言。exampleFile 指向`NULL`，甚至在 之后`_wfopen`，并且 buffer 的最后一个字符是`'/0'`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T17:04:14.973

您没有进行任何错误处理。最重要的是，在调用 时`MultiByteToWideChar()`，您是在告诉它转换整个`multiByteStr`缓冲区，但大部分缓冲区都包含垃圾，因为您没有事先将其归零。您必须使用缓冲区中的实际字符数，而不是缓冲区的最大大小。`MultiByteToWideChar()`可能会返回您忽略的错误。代码中还有其他几个故障点。您需要始终检查错误，尤其是在与操作系统交互时。

试试这个：

```
#define UNICODE

#include <Windows.h>
#include <cstdio>
#include <fstream>

using namespace std;

void pause()
{
    wcin.ignore();
    wcin.get();
}

int main()
{
    FILE* resFile;
    char multiByteStr[256] = {0};
    ifstream oFile;
    FILE* exampleFile;
    WCHAR buffer[256] = {0};

    SetConsoleOutputCP(CP_UTF8);

    resFile = _wfopen(L"foo",L"w, ccs=UTF-8");
    if (!resFile) {
        wprintf(L"Unable to create foo");
        goto done;
    }

    fwprintf(resFile,L"%s",L"C:\\exsistingFolder\\zażółć gęśłą jaźń ☺☻♥♦• ć.txt");
    fclose(resFile);

    if (!oFile.open(L"foo")) {
        wprintf(L"Unable to open foo");
        goto done;
    }

    oFile.getline(multiByteStr,255,'\n');
    oFile.close();

    if (MultiByteToWideChar(CP_UTF8,0,multiByteStr,-1,buffer,256) == 0) {
        wprintf(L"Unable to convert UTF-8 to UTF-16\. Error: %u", GetLastError());
        goto done;
    }

    exampleFile = _wfopen(buffer,L"w, ccs=UTF-16LE"); 
    if (!exampleFile) {
        wprintf(L"Unable to create file: %s", buffer);
        goto done;
    }

    fwprintf(exampleFile,L"%s",buffer); 
    fclose(exampleFile);

    wprintf(L"created file: %s", buffer);

done:
    pause();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T01:00:31.503

为什么要混合搭配您的 I/O 库？这是一个纯（Windows）C 解决方案，减去错误检查：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
    FILE* pFile;
    wchar_t buffer[256];

    _wfopen_s(&pFile,L"foo",L"w, ccs=UTF-8");
    fputws(L"C:/existingFolder/zażółć gęśłą jaźń ☺☻♥♦• ć.txt",pFile);
    fclose(pFile);

    _wfopen_s(&pFile,L"foo",L"r, ccs=UTF-8");
    fgetws(buffer,_countof(buffer),pFile);
    fclose(pFile);

    _wfopen_s(&pFile,buffer,L"w, ccs=UTF-16LE");
    fputws(buffer,pFile);
    fclose(pFile);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T18:21:22.753

解决方案非常简单—— _wfopen**使用 BOM**创建一个以 UTF-8 编码的文件，而 MultiByteToWideChar 函数不会删除 BOM，因此我们需要手动摆脱它。

# android - 如何在 Android 中在另一个活动中显示一个活动？

> ID：10774656
> 
> 赞同：7
> 
> 时间：2012-05-27T14:22:45.197
> 
> 标签：android, android-activity, android-linearlayout

我有一项活动，并想在其中显示另一项活动。这是我的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

  <LinearLayout
      android:orientation="horizontal"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:layout_weight="1">
  </LinearLayout>

</LinearLayout> 
```

如何在按钮单击时显示`Activity`内部？`LinearLayout`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-27T14:30:55.353

### 对多个活动使用一种布局

布局实例使用方法为每个活动膨胀`setContentView`，通常在`onCreate`：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.my_common_layout);
} 
```

所以`XML`对于不同的活动使用相同的布局是没有问题的。

### 在另一个活动中显示一个活动

您可以使用`Fragment`API 来完成任务。[请参阅开发人员指南](http://developer.android.com/guide/topics/fundamentals/fragments.html)中的完整详细信息。

*   声明这样的布局，Android 将为您创建片段：

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

        <fragment android:name="com.example.MyFragment"
                android:id="@+id/my_fragment"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_weight="1" />

    </LinearLayout> 
    ```

    然后创建一个`MyFragment`类并在适当的时候加载它。

*   自己创建片段。不要定义`Fragment`in`XML`布局：

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/my_parent_layout">

    </LinearLayout> 
    ```

    创建父母后`Activity`，您可以通过以下方式添加新`Fragment`的：

    ```
    FragmentManager fragmentManager = getFragmentManager()
    FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
    MyFragment fragment = new MyFragment();
    fragmentTransaction.add(R.id.my_parent_layout, fragment);
    fragmentTransaction.commit(); 
    ```

    这里`MyFragment`是这样定义的：

    ```
    public class MyFragment extends Fragment {
        ...
    } 
    ```

如果您的目标是 Android 3.0 以下，请考虑为此使用[支持包](http://developer.android.com/sdk/compatibility-library.html)。

# iphone - 核心数据迁移 - 添加实体

> ID：10774658
> 
> 赞同：0
> 
> 时间：2012-05-27T14:23:04.903
> 
> 标签：iphone, objective-c, ios, core-data

我创建了模型的新版本并将其设置为当前模型。我添加了两个新实体，其中一个依赖于父实体。

我在设置商店时添加了以下代码

```
 NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:  
                         [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,  
                         [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil]; 
```

我已经创建了一个映射模型 - 源我的旧模型和目标我的新模型。但是，应用程序在启动时仍然崩溃。我想我在这里遗漏了一些东西。我试过浏览苹果文档，但仍然不能完全理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T07:13:16.250

当您使用修改后的核心数据结构进行更新时，您将需要用新的数据结构更新旧数据结构。由于旧的已经存在您的 .mod 文件并且其他文件没有重新创建，因此即使您的代码具有新实体，安装在用户设备中的应用程序也包含旧数据结构，并且当您在新数据结构中对这些实体发起查询时，应用程序找不到。所以它最终崩溃了。

因此，您可以删除仅用于测试目的的应用程序。如果您正在创建应用程序的新版本，请参考[此链接](http://www.iphonedevsdk.com/forum/iphone-sdk-development/38070-how-do-you-update-users-core-data-database-upon-app-update.html)

# hibernate - 在休眠 JPA 中；OneToMany 如何过滤结果；因为我不想删除任何数据

> ID：10774664
> 
> 赞同：4
> 
> 时间：2012-05-27T14:23:33.623
> 
> 标签：hibernate, jpa

我不想在我的 webapp 中执行删除操作。因此，如果删除记录，我会在所有表中保留一个等于 P 的列状态。默认情况下，我希望在获取记录时这样做；不应获取 status = P 的实体；即一个额外的 where 子句应该发生... where status = A ; 或状态！= P。

使用注释实现它的最佳方法是什么？我当然可以写一个手动查询..

例如：我的用户类可以有多个孩子。我们如何实现以便 user.getChilds() 不返回状态为 P 的子项

```
User.java
   @OneToMany( mappedBy = "usr",
            targetEntity = Child.class,
            fetch = FetchType.EAGER,
            cascade = CascadeType.ALL )
    @OrderBy( "fullName ASC" )
    List<Child> childs;

Child.java:
    @ManyToOne
    @JoinColumn
    User usr; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T14:33:22.330

使用[Hibernate 过滤器](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#objectstate-filters)或附加的[where 子句](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/#entity-hibspec-collection)。过滤器可以在运行时激活和参数化，而 where 子句不能。但是它们都用于将附加的 where 子句应用于持久集合。

# android - 资源数组

> ID：10774668
> 
> 赞同：24
> 
> 时间：2012-05-27T14:23:50.117
> 
> 标签：android, string, android-xml, android-resources

有没有办法在 XML 中定义一个数组，其中元素是资源引用？例如（它不起作用，但它解释了我想要的）：

```
<integer-array name="actions_images">
    <item>@drawable/pencil</item>
    <item>@drawable/pencil</item>
    <item>@drawable/pencil</item>
    <item>@drawable/pencil</item>
    <item>@drawable/pencil</item>
    <item>@drawable/pencil</item>
</integer-array> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T15:17:37.473

如果我正确理解您的问题，我想我知道一种解决方法（因为通过*getResources().getIntArray()*访问它们不起作用）。[（您可以在此处](http://www.anddev.org/xml_integer_array_resource_references_getintarray-t9268.html)阅读更多内容，这是我从中获取解决方法的来源。）

```
TypedArray ar = context.getResources().obtainTypedArray(R.array.my_array);
int len = ar.length();     
int[] resIds = new int[len];     
for (int i = 0; i < len; i++)     
    resIds[i] = ar.getResourceId(i, 0);

ar.recycle();                       
// Do stuff with resolved reference array, resIds[]...     
for (int i = 0; i < len; i++)     
    Log.v (TAG, "Res Id " + i + " is " + Integer.toHexString(resIds[i])); 
```

# perl - Markdown.pl 添加基于第一个字符的特殊分类段落

> ID：10774669
> 
> 赞同：0
> 
> 时间：2012-05-27T14:23:54.340
> 
> 标签：perl, markdown

我是 perl 语法的新手，但不是正则表达式，

我正在尝试根据第一个字符向[Markdown.pl](http://daringfireball.net/projects/markdown/)中的段落添加几个类，例如

```
Normal paragraph

? Info paragraph

! Important paragraph 
```

给予：

```
<p>Normal paragraph</p>
<p class="info">Info paragraph</p>
<p class="important">Important paragraph</p> 
```

这是 Markdown.pl 中包装`<p>`标签的代码

```
my @grafs = split(/\n{2,}/, $text);

foreach (@grafs) {
    unless (defined( $g_html_blocks{$_} )) {
        $_ = _RunSpanGamut($_);
        s/^([ \t]*)/<p>/;
        $_ .= "</p>";
    }
} 
```

**我需要使用条件语句还是 perl 中有一种我不知道的聪明方法？**

**此外，如果有机会使用`!`并且`?`作为第一个字符转义`\`**（不是强制性的，我真正需要它的机会很接近`0`） ，那将是很棒的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-20T17:04:11.530

我对 Perl 完全陌生，并且也在寻找特殊的段落。我遇到了这篇文章，我认为它可能对您的情况有所帮助。

[http://www.pingtrip.com/weblog/2008/04/adding-custom-tags-to-markdown](http://www.pingtrip.com/weblog/2008/04/adding-custom-tags-to-markdown)

他的修改`div`使`class="note"``"warning"`

```
~? This is a Note Block ~?

~! This is a Warning Block ~! 
```

我听从了他的指示，他们工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T22:39:37.413

这是我到目前为止得到的，它有效，但我想知道在 perl 中是否有更聪明的方法来做到这一点

```
my @grafs = split(/\n{2,}/, $text);

#
# Wrap <p> tags.
#
foreach (@grafs) {
    unless (defined( $g_html_blocks{$_} )) {
        $_ = _RunSpanGamut($_);
        if ( m/^[ \t]*\?/ ){
            s/^([ \t]*\?[ \t]*)/<p class="Information">/;
        } elsif ( m/^[ \t]*\!/ ){
            s/^([ \t]*\![ \t]*)/<p class="Important">/;
        } else {
            s/^([ \t]*)/<p>/;
        }
        $_ .= "</p>";
    }
} 
```

# ios - 关闭已启动的视图控制器并返回初始视图控制器（故事板）

> ID：10774670
> 
> 赞同：2
> 
> 时间：2012-05-27T14:23:54.783
> 
> 标签：ios, ipad, ios5, storyboard

我已经看过这个问题几次，但从未真正回答过。我想知道在使用情节提要时是否有一种可接受/干净的方式来关闭所有已启动的视图控制器并返回到初始视图控制器（例如从生成的视图控制器中的操作）。

我知道如何使用委托，但是，我不希望我的初始视图控制器为每个可能的衍生视图控制器实现委托。相反，我想要一个主页按钮，它可以清理所有内容并从应用程序的任何位置返回初始视图控制器。

想法？

编辑：为了清楚起见，假设我没有使用 UINavigation 控制器。

EDIT2：是否可以像使用 appDelegate 一样从应用程序中的任何位置访问“初始视图控制器”的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:32:31.940

这应该在任何时候做到这一点。只需将其粘贴在 IBAction 中并将其连接到按钮即可:)

```
[self.navigationController popToRootViewController]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T00:24:39.633

我最终使用了单例。似乎工作得很好。

在初始视图控制器的初始加载时，我将视图控制器设置为单例的属性。然后，我可以在应用程序中的任何视图控制器上的任何操作方法中执行以下代码，以关闭所有视图控制器并返回到初始视图控制器。

```
initialViewControllerManager *ivcManager = [initialViewControllerManager sharedInstance];
LPViewController *ivc = ivcManager.initalViewController;    
[ivc dismissModalViewControllerAnimated:YES]; 
```

可能不是“正确”的答案，但似乎有效。而且，考虑到我的场景的复杂性，完全依赖 UINavigationControllers 会非常复杂。

# php - 将表结构和数据复制到二维数组中

> ID：10774671
> 
> 赞同：0
> 
> 时间：2012-05-27T14:24:05.987
> 
> 标签：php, mysql, arrays

这里我有一个 MySQL 数据库，我需要检索很多行。

我需要将数据堆积在一个数组中：

```
$query_sel_node  = "SELECT * FROM $table_name";                 
$result_data = mysql_query($query_sel_node);

$data_rec = array("data" => array(), "data_h" => array(), "file" => array(), "ptr" => array(), "name" => array());
while($data_fetched = mysql_fetch_assoc($result_data))
                {   
                    array_push($data_rec["data_h"], $data_fetched['data_h']);
                    array_push($data_rec["data"], $data_fetched['data']);
                    array_push($data_rec["file"], $data_fetched['m_file_thumb']);
                    array_push($data_rec["ptr"], $data_fetched['m_pointer']);
                    array_push($data_rec["name"], $data_fetched['m_name']);
                } 
```

现在，我在表中添加了很多列，这意味着我需要为我制作的每一列添加 array_push()。

有没有更简单的方法可以用更少的代码行来做到这一点？

我正在寻找的是这个：

我有一个列 {m_data, m_name, m_file} 的 mysql 表，我有几行数据

现在我需要将它们放入数组

我的数组将使用列名和键，然后我将行数据存储到每个键中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:41:41.953

甚至比查询信息模式或使用 mysql_fetch_field 更好，试试这个：

```
$query_sel_node  = "SELECT * FROM $table_name";
$result_data = mysql_query($query_sel_node);
$data_rec = array();
while($data_fetched = mysql_fetch_assoc($result_data)) {
    foreach($data_fetched as $k=>$v) {
        $data_rec[$k][] = $v;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:35:30.173

首先，从所需的表中获取所有列名：

```
SELECT
    COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE
    table_name = '$table_name' 
```

使用列名构建数组 ( `$table`) 并为每个数组分配一个空数组（用于数据）：

```
$columns_query = mysql_query($the_above_query);
$table = array();
while ($column = mysql_fetch_row($columns_query))
    $table[$column[0]] = array(); 
```

获取每一列的数据并将其插入到`$table`数组中：

```
foreach (array_keys($table) as $column)
{
    $query_sel_node  = "SELECT $column FROM $table_name";                 
    $result_data = mysql_query($query_sel_node);

    while ($data = mysql_fetch_row($result_data))
        $table[$column][] = $data[0];
} 
```

现在，`$table`将包含该表`$table_name`所做的确切结构和数据。

# php - 在 PHP 中包含太多文件会降低性能吗？

> ID：10774672
> 
> 赞同：16
> 
> 时间：2012-05-27T14:24:31.580
> 
> 标签：php, include

> **可能重复：**
> [包含函数文件的效率（在 PHP 中）](https://stackoverflow.com/questions/2106700/efficiency-for-including-files-of-functions-in-php)
> [在 php 中使用过多的 include()](https://stackoverflow.com/questions/10301240/using-too-much-include-in-php)

如果是这样，建议最多包含多少文件？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-27T15:46:14.770

包含文件将执行以下操作：

*   从磁盘读取文件。
*   运行文件中的代码。

这两项操作都需要时间。时间不多，但即便如此，如果您有很多包含，它也可以加起来，所以您问题的基本答案是“是的，它会影响性能”。

然而，这种性能损失的规模非常小，并且远远超过了编写高质量结构良好的代码（包括将单独的类/功能保存在单独的文件中）的优势。

说实话，如果您担心这类事情的性能，请尝试通过诸如[xDebug 之](http://xdebug.org/)类的分析器运行您的代码。这将准确地向您显示代码的哪些部分花费的时间最多。`include()`语句将显示在那里，但不太可能出现在列表顶部附近。

除非您正在编写一个像 Facebook 这样的具有访问者数量的网站，否则您不太可能需要担心`include()`. 但是看一下 xDebug 的分析器输出，因为您的代码中可能有其他事情比您预期的要慢得多，或者经常被调用，或者循环太多次等等，并修复这些将对代码的性能产生*很大*影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:34:32.750

*include*指令确实将包含文件的内容“粘贴”到它所在的位置。所以包含的代码加起来就是实际的脚本。这是一个很好的解释[PHP include(): File size & performance](https://stackoverflow.com/questions/2298196/php-include-file-size-performance) - the accepted answer。

# css - Django：使用正确的 URL 从 S3 提供 CSS 但不会加载

> ID：10774675
> 
> 赞同：2
> 
> 时间：2012-05-27T14:24:40.323
> 
> 标签：css, django, amazon-s3, django-staticfiles

我已将我的 STATIC_URL 设置为我的 S3 存储桶和其中的静态目录的 URL。

```
STATIC_URL = 'https://s3.amazonaws.com/XXXXXXX/static/' 
```

在我的模板中，我试图从以下位置加载样式表：

```
<link href="{{ STATIC_URL }}css/bootstrap-responsive.css" rel="stylesheet"> 
```

样式表没有被加载，但是当我查看页面的源代码时，我可以单击为下载正确文件的样式表呈现的链接。此外，权限设置为查看 World，因此它可以访问，只是不会加载（即使我在 Chrome 中进行了硬刷新）。

由于 URL 正确，为什么样式表不加载？

在此先感谢您的帮助-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T19:39:57.960

尝试在 Firefox 中安装 Firebug。按 F12 打开 Firebug 窗口，单击 Net 选项卡，然后执行 shift-reload。这将为您提供所有下载的详细信息。单击您遇到问题的文件，它将为您提供所有 HTTP 请求/响应标头。启蒙往往紧随其后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T23:52:35.980

来自 Django 文档：[https ://docs.djangoproject.com/en/1.4/ref/templates/builtins/](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/)

staticfiles contrib 应用附带一个静态模板标签，它使用静态文件的 STATICFILES_STORAGE 来构建给定路径的 URL。如果您有高级用例**（例如使用云服务来提供静态文件），**请使用它：

```
{% load static from staticfiles %}
<img src="{% static "images/hi.jpg" %}" />
<link href="{% static "css/bootstrap-responsive.css" %}" rel="stylesheet"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T02:08:36.517

当您将`.css`文件上传到 S3 时，它会将文件的内容类型设置为`binary/octet-stream`.

要解决此问题，请遵循本教程： http: [//log.adamwilcox.org/2012/05/04/css-on-amazon-s3/](http://log.adamwilcox.org/2012/05/04/css-on-amazon-s3/)

# android - Android：显示来自服务器的验证码

> ID：10774678
> 
> 赞同：0
> 
> 时间：2012-05-27T14:24:55.313
> 
> 标签：android, httpclient, captcha

对于我的应用程序，我需要使用验证码进行验证。我正在使用此链接：http: [//vocublablair.nl/webservices/send.php](http://vocublablair.nl/webservices/send.php)

它返回一个类似这样的字符串：/webservices/simple-php-captcha.php?_CAPTCHA&t=0.59145200+1338304461

然后应该调用该链接，即： http://vocublablair.nl/webservices/simple-php-captcha.php?_CAPTCHA&t= [0.59145200+1338304461](http://vocublablair.nl/webservices/simple-php-captcha.php?_CAPTCHA&t=0.59145200+1338304461)

当我使用相同的 HttpClient 调用它（因此使用正确的会话 cookie）时，它会出现以下错误：

```
java.lang.IllegalArgumentException: Illegal character in query at index 94: http://vocublablair.nl/webservices/simple-php-captcha.php?_CAPTCHA&t=0.59145200+1338304461 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:31:14.717

最好的方法是生成您自己的验证码图像，因为使用第三方资源可能会给您的客户带来不便。要在 android 中生成验证码，您可以使用这个简单的库： [http ://simplecaptcha.sourceforge.net/](http://simplecaptcha.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T21:31:19.170

我解决了以下问题：

首先，我返回的链接必须使用 HTML 编码：

```
Html.fromHtml(String) 
```

调用正确的 URL：

```
content = sb.toString(); //the fetched link
String myCookie = "";
//get session cookie from other call.

List<Cookie> cookies = ((DefaultHttpClient)httpClient).getCookieStore().getCookies();
for(Cookie c : cookies){
if(c.getName().equals("PHPSESSID")){
    myCookie = c.getName() + "=" + c.getValue();
    break;
   }
   }

URL url = new URL(Html.fromHtml("http://vocublablair.nl" + content).toString());
URLConnection connection = url.openConnection();
connection.setDoInput(true);
connection.setRequestProperty("Cookie", myCookie);
connection.connect();
Bitmap bit = BitmapFactory.decodeStream(new FlushedInputStream((InputStream) connection.getContent())); 
```

我正在使用 FlushedInputStream。在这里阅读：http: [//twigstechtips.blogspot.com/2011/10/android-loading-jpgpng-images-from-url.html](http://twigstechtips.blogspot.com/2011/10/android-loading-jpgpng-images-from-url.html)

# javascript - 将输入宽度绑定到表格列宽

> ID：10774680
> 
> 赞同：0
> 
> 时间：2012-05-27T14:25:23.737
> 
> 标签：javascript, jquery, html-table, width

有一个有 5 列的表。列可能有不同的宽度（我没有分配恒定的宽度）。

现在我想**在表格顶部**创建 5 个输入元素。是否有任何技巧可以使每个输入元素的宽度等于相应的列宽？

例如，输入 1 应具有第 1 列的宽度，输入 2 - 应具有第 2 列的宽度，等等。

那么，如何将输入绑定到列？

更新：

```
<script>
$('#addButton').click(function() {
    $("#addContent").slideToggle("slow");
    $('input').width(+$('table td').width()-1);
});
</script>

<div id = "add">
    <div id = "addButton" title='New Record' ;>
        <img src='images/add.png' alt='New Record' />
    </div>

    <div id = "addContent">
                        <input type="text">
                        <input type="text">
    </div>
</div>

                <table id="newspaper-b" border="0" cellspacing="2" cellpadding="2" width = "100%">
                    <thead>
                        <tr>
                            <th scope="col">Opr</th>
                            <th scope="col">Flt Num</th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <?php foreach ($result1 as $row):
                            $status=$row['status'];
                            $airlineName=$row['airlineName'];
                            $flightNum=$row['flightNum'];
                        ?>
                        <tr id="<?php echo $flightNum; ?>" class="edit_tr">
                            <td width="80" ><?php echo $airlineName;?></td>
                            <td width="80" ><?php echo $flightNum;?></td>
                            <td width="80" id="<?php echo $flightNum; ?>" class="deact_but">
                                 <div>
                                    <img src='images/delete.png' alt='Deactivate' />
                                </div>              
                            </td>
                        </tr>
                        <?php endforeach;?>
                    </tbody>
                </table> 
```

**CSS**

```
input{
    float: left;
    margin: 0;
    padding: 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:02:55.760

使用 jQuery 是可能的。检查演示 - [http://jsfiddle.net/k9MhG/4/](http://jsfiddle.net/k9MhG/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:45:12.083

添加一些 JavaScript（在页面加载结束或加载后）以获取顶级单元格的 offsetWidth 并将这些宽度应用于您的输入。

像这样的东西：

```
document.getElementById('myInput').style.width = document.getElementById('myTable').rows[0].cells[0].offsetWidth; 
```

或者，扩展您的表格以包含输入并将宽度设置为 100%。您可以将样式应用到第一个 TR 以使其看起来不是表格的一部分。下一个 TR 可以包含带有边框等的标题。

```
<table>
    <tr>
      <td><input type="text"></td>
      <td><input type="text"></td>
      <td><input type="text"></td>
    </tr>
    <tr>
      <td><br/><br/><br/></td>
    </tr>
    <tr>
        <td>ContentContent</td>
        <td>Content</td>
        <td>Cont</td>
    </tr>
</table> 
```

# .net - 我可以使用 *.tlb 文件而不使用 Regasm 在计算机上注册它吗

> ID：10774685
> 
> 赞同：4
> 
> 时间：2012-05-27T14:26:11.073
> 
> 标签：.net, dll, legacy-code

我们正在支持一个老化的 VB6 系统，我们在 .Net 中为其编写了新代码，将代码放入程序集中，然后导出 *.tlb 文件以用于 VB6 代码库。

我的问题是，在我希望运行代码的每台计算机上，我是否必须使用 Regasm 来注册类型库？

我问是因为随着计算机损坏，添加新计算机等，很难跟踪类型库的安装。此外，如果我们更新 .Net 代码，我们需要遍历每台计算机并重新注册类型库。

总而言之，是否可以从 VB6 运行 .Net 代码而无需在运行代码的每台计算机上注册类型库？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T15:13:43.043

`/tlb:filename.tlb`Regasm.exe 仅在您使用命令行选项运行时创建类型库。然后在 VB6 项目中使用 Project + References，Browse 按钮​​选择 .tlb 文件。运行 Tlbexp.exe 是另一种获取它的方法，无需注册。您应该更喜欢 IDE 中的“Register for COM interop”选项。但是，您必须运行 VS 提升才能写入注册表。右键单击快捷方式并选择“以管理员身份运行”。

让它出现在 VB6 列表中是一个小小的便利，但很难获得。由 Regasm.exe 调用的标准 .NET 注册代码不会编写所需的“可编程”密钥来让 VB6 自动将组件添加到其列表中。您必须编写一个由 [ComRegisterFunction] 属性修饰的自定义注册函数，该属性写入缺少的键。当您只需单击浏览时，这是不值得的。

另请注意，您不必*在*用户机器上注册类型库。只有 VB6 编译器需要它。您必须注册 [ComVisible] 类，使用安装项目很容易。只需将 DLL 的 Register 属性设置为 vsdrpCOM。

# php - 使用一页执行多个操作

> ID：10774686
> 
> 赞同：0
> 
> 时间：2012-05-27T14:26:19.830
> 
> 标签：php

我正在创建一个管理面板，但是我想知道它是否可能以及如何执行以下操作。

管理面板将允许用户完成添加、编辑和删除三个操作（同时与 MySQL 数据库通信）。这些操作如何仅在一个文件中完成，例如 index.php?page=add、index.php?page=edit、index.php?page=delete？

那么当用户想要删除某些东西时，只能在文件中访问代码的删除部分？

谢谢，

杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:29:14.000

您需要传递更多信息，例如用户 ID。

```
$userid = filter_var($_GET['userId'], FILTER_VALIDATE_INT);   

switch($_GET['page'])
{
    case 'add':
        // build mysql insert here using the userid.
        break;

    case 'edit':
        // build mysql update here using the userid.
        break;

    case 'delete':
        // build mysql delete here using the userid.
        break;

    default:
        echo 'unknown page action';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:31:26.760

通过`$_GET['page']`您可以在 PHP 中获取与“页面”关联的 URL 的值。

使用 $_POST，从通过“post”发送的数据。有关一些示例，请参阅本教程：**[$_GET、$_POST 和 $_REQUEST 变量](http://www.coursesweb.net/php-mysql/get-post-request)**。

# c# - 如何在 .net 中控制 Windows 的状态？

> ID：10774687
> 
> 赞同：0
> 
> 时间：2012-05-27T14:26:45.627
> 
> 标签：c#, .net, windows

如何控制 Windows 的状态。在网络？特别感兴趣的是如何不让系统进入睡眠状态（如果用户长时间不使用输入设备）。当系统由于用户不活动而进入待机、睡眠或休眠状态时，如何跟踪事件，并在运行时（在某些情况下）取消它？适用于 .Net 的任何信息都会很有用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T21:26:23.760

调查 WMI，Windows 管理规范。

WMI 很好地解决了这个问题，因为它提供了对 Windows 操作系统的深度控制，它有一个事件系统，并且它提供了一个 .NET 接口。

实际上，WMI 允许 .NET 应用程序（通过使用它的[WMI 接口](http://msdn.microsoft.com/en-us/library/bb404655.aspx)）通过[这个 WMI 类](http://msdn.microsoft.com/en-us/library/windows/desktop/aa392747(v=vs.85).aspx)获得有关系统电源事件的通知。

当然，必须考虑到Adam 评论[链接以允许（或不允许）系统待机。](https://stackoverflow.com/questions/10052402/preventing-computer-from-sleeping)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T17:58:51.480

在 WinForms 中，您可以检测到关机。在 FormClosing 事件中，您得到`FormClosingEventArgs e`. 然后您只需检查`e.CloseReason == CloseReason.WindowsShutDown`- 这意味着关闭表单的原因是关闭操作系统。

# image - htaccess 只拒绝来自推荐人的一个文件

> ID：10774689
> 
> 赞同：0
> 
> 时间：2012-05-27T14:27:07.350
> 
> 标签：image, .htaccess, referer

我有一个文件夹，其中有不同的图像。

```
phpe77WUQ-155x194.jpg      
phpe77WUQ-276x345.jpg          
phpe77WUQ-84x105.jpg   
phpe77WUQ.jpg
sdfs714ggs4eg-155x194.jpg      
sdfs714ggs4eg-276x345.jpg          
sdfs714ggs4eg-84x105.jpg   
sdfs714ggs4eg.jpg 
```

只能从任何地方查看名称中大小（例如 155x194）的图像。其他两个图像只能从referer .domain.com/user/editimage 中看到

我如何用 htaccess 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T15:28:13.097

我希望这对你有用：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^http://.*\.domain\.com/user/editimage$ [NC]
RewriteRule !^(.*)-([0-9]+)x([0-9]+)\.jpg$ - [NC,L,F] 
```

如果引用者不是 subdomain.domain.com/user/editimage，则名称中没有大小的每个图像都将被阻止

# php - 在表单中添加实际变量

> ID：10774691
> 
> 赞同：0
> 
> 时间：2012-05-27T14:27:22.943
> 
> 标签：php, javascript, ajax

我正在尝试学习 HTML 和 PHP。在我在互联网上找到的一个示例中，我需要为提交按钮设置一个变量。因此，当按下提交按钮时，此页面会重新加载，地址栏中有一个变量，该变量是下拉菜单中的变量。像这样 ：

```
test.php?idneeded=$variable 
```

其中 $variable 由用户选择，然后页面重新加载以显示与所选选项相关的特定内容。

例如 ：

```
test.php?idneeded=40 
```

（40 是下拉表格中的“MadTechie”）

我找到的代码是这样的：

```
<?php
   if( isset($_GET['ajax']) )
   {
      //In this if statement
      switch($_GET['ID'])
      {
         case "LBox2":
            $Data[1] = array(10=>"-Tom", 20=>"Jimmy"); 
            $Data[2] = array(30=>"Bob", 40=>"-MadTechie");
            $Data[3] = array(50=>"-One", 60=>"Two");
         break;

         //Only added values for -Tom, -MadTechie and -One (10,40,50)
         case "LBox3":
            $Data[10] = array(100=>"One 00", 200=>"Two 00");
            $Data[40] = array(300=>"Three 00");
            $Data[50] = array(1000=>"10000");
         break;
      }

      echo "<option value=''></option>";
      foreach($Data[$_GET['ajax']] as $K => $V)
      {
         echo "<option value='$K'>$V</option>\n";
      }
      mysql_close($dbh);
      exit; //we're finished so exit..
   }
   $Data = array(1=>"One", 2=>"Two", 3=>"Three");
   $List1 = "<option value=''></option>";
   foreach($Data as $K => $V)
   {
      $List1 .= "<option value='$K'>$V</option>\n";
   }
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Simple Dymanic Drop Down</title>
<script language="javascript">
   function ajaxFunction(ID, Param)
   {
      //link to the PHP file your getting the data from
      //var loaderphp = "register.php";
      //i have link to this file
      var loaderphp = "<?php echo $_SERVER['PHP_SELF'] ?>";

      //we don't need to change anymore of this script
      var xmlHttp;
      try
       {
         // Firefox, Opera 8.0+, Safari
         xmlHttp=new XMLHttpRequest();
       }catch(e){
         // Internet Explorer
         try
         {
            xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
         }catch(e){
            try
            {
               xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
            }catch(e){
               alert("Your browser does not support AJAX!");
               return false;
            }
         }
      }

      xmlHttp.onreadystatechange=function()
      {
         if(xmlHttp.readyState==4)
           {
              //the line below reset the third list box incase list 1 is changed
              document.getElementById('LBox3').innerHTML = "<option value=''></option>";

              //THIS SET THE DAT FROM THE PHP TO THE HTML
            document.getElementById(ID).innerHTML = xmlHttp.responseText;
           }
      }
       xmlHttp.open("GET", loaderphp+"?ID="+ID+"&ajax="+Param,true);
       xmlHttp.send(null);
   }
</script>
</head>
<body>
<!-- OK a basic form-->
<form method="post" enctype="multipart/form-data" name="myForm" target="_self">
<table border="0">
  <tr>
    <td>
      <!--
      OK here we call the ajaxFuntion LBox2 refers to where the returned date will go
      and the this.value will be the value of the select option
      -->
      <select name="list1" id="LBox1" onchange="ajaxFunction('LBox2', this.value);">
      <?php 
         echo $List1;
      ?>
      </select>
   </td>
    <td>
      <select name="list2" id="LBox2" onchange="ajaxFunction('LBox3', this.value);">
         <option value=''></option>
            <!-- OK the ID of this list box is LBox2 as refered to above -->
      </select>
   </td>
   <td>
      <select name="list3" id="LBox3">
         <option value=''></option>
            <!-- OK the ID of this list box is LBox3 Same as above -->
      </select>
   </td>
  </tr>
</table>
  <input type="submit" name="Submit" value="Submit" />
</form>
</body>
</html> 
```

我还没有开始学习 JavaScript，我需要这个来做一个项目。如果有人可以帮助我，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:56:38.827

我不明白你的问题变化很大，但我会尽力帮助你。在 html 中确保您使用 method="get" 作为表单，并以这种方式将变量传递给 url 中的 php。（在其他情况下需要 POST，但现在即使使用 get 也可以）。所有带有 NAME 属性集的输入值都被传递到 url。前任：

```
<form action='phpscript.php' method='get' >
<input type='text' name='just_a_test' value='somevalue' />
<input type='submit' value='submit_form' name='submit' />
</form> 
```

提交后的网址为：http://mypage.com/phpscript.php?just_a_test=somevalue&submit= [submit_form](http://mypage.com/phpscript.php?just_a_test=somevalue&submit=submit_form)

在另一边，将使用表单数据的 php 脚本将是

```
<?php

if (isset($_GET['submit']) ) { 

                              if (isset($_GET['just_a_test']) )
                                  {
                                  $variable1 = $_GET['just_a_test'];
                                  //do something with variable 1 and output results
                                  //based on the value of this variable. 
                                  }
                             } 

?>

you can do the same thing for ass many variables as you want . i hope this was a help to you because i cant undestand your question better than this . 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:45:55.533

如果表单应该在重定向期间发送，则您没有使用 AJAX。在这种情况下，解决方案很简单：

```
<form name="myForm" action="test.php" method="GET">
    <select name="idneeded">
        <option value="40">MadTechie</option>
        <option>...</option>
    </select>
</form> 
```

每个 HTML 教程都解释了类似的事情。这是一个很好的起点：[W3C 学校](http://www.w3schools.com/html/default.asp)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T14:47:12.263

您还没有提到变量的值是否在客户端或服务器上可用？

**客户端变量：** 基本上，您必须处理表单的 onSubmit 事件。在这里，您可以将变量的值附加到操作中。

**服务器上的变量：** 您可以在此处更改渲染 HTML 时的操作。

# linux - 使用 csvfix for linux 对数值进行排序 - 将数字转换为字符串

> ID：10774700
> 
> 赞同：2
> 
> 时间：2012-05-27T14:28:16.827
> 
> 标签：linux, unix, csv

我正在使用[csvfix](http://code.google.com/p/csvfix/)根据第二列中的整数（计数器）值对 CSV 文件进行排序。然而，csvfix 似乎在文件中的所有字段周围加上双引号，将它们转换为字符串，然后再执行排序。结果是行按字符串值排序，因此“1000”排在“2”之前。

有一个命令行选项`-smq`应该应用“智能引用”，但这对我没有帮助。如果我使用 command `csvfix echo -smq file.csv`，则输出在数字字段周围没有引号，但是当我将其输入`csvfix sort -f 2 file.csv`时，文件将不带引号写入，但仍按“字符串顺序”排序。我是否在排序命令中包含 -smq 标志没有区别。

此外，我希望 csvfix 忽略第一行字符串标题。Csvfix 问题跟踪[声称这已经实现](http://code.google.com/p/csvfix/issues/detail?id=24&can=1&colspec=ID%20Type%20Status%20Priority%20Owner%20Summary)，但我只能找到`-ifn`似乎完全切断标题行的标志。

这些似乎是这个工具的基本功能，所以我可能遗漏了一些非常简单的东西。希望这里有人使用过 csvfix 并想通了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T17:22:05.430

根据[csvfix 的在线文档](http://csvfix.byethost5.com/csvfix13/csvfix.html)， sort 有一个`N`用于数字排序的选项：

```
csvfix sort -f 2:N file.csv 
```

话虽如此，CSV[对于文本操作来说并不是一种特别好的格式](http://catb.org/esr/writings/taoup/html/ch05s02.html#id2901882)。如果可能的话，您最好选择 DSV（分隔符分隔值），例如 Tab 或 Pipe 分隔，这样您就可以简单地将输出通过管道传输到`sort`，它具有足够的按字段排序的能力，使用您需要的任何整理方法。

# bash - 我的 shell 脚本有什么问题

> ID：10774701
> 
> 赞同：1
> 
> 时间：2012-05-27T14:28:17.350
> 
> 标签：bash, shell, shell-exec

我有一个 shell 脚本，它有一个用于打印数组元素值的 for 循环。数组大小为 2，但是当使用该数组运行 for 循环时，我没有得到正确的输出。

这是shell脚本：

```
#!/bin/bash

arry=$(ls /home/developer/.ssh/  | grep "\.pub")
declare -a ARR
i=0
for key in $arry
do
  ARR[i]=$(echo $key | sed 's/.pub//g')
  i=$((i+1))
done
echo ${#ARR[@]}
## the below for loop is not iterating as expected
for pri in $ARR
do
 echo $pri
done 
```

现在而不是给出输出

```
2
a
heroku 
```

上面的代码产生：

```
2
a 
```

上面的shell代码有什么问题？

我对 shell 脚本比较陌生，所以请原谅我的代码，我觉得它不好

附上输出截图 ![在此处输入图像描述](../Images/54f6a4741ad3440d0078b2ab36949c45.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T14:49:57.670

```
#!/bin/bash
arry=(/home/developer/.ssh/*.pub)

ARR=(${arry[@]%%.pub})    # strip the extensions

echo "${#ARR[@]}"

for pri in "${ARR[@]}"
do
    echo "$pri"
done 
```

使用 glob 而不是`ls`.

使用数组而不是字符串。

扩展变量时引用变量。

# java - 从java打开文件编辑器

> ID：10774703
> 
> 赞同：1
> 
> 时间：2012-05-27T14:28:23.067
> 
> 标签：java, file, desktop, edit

我正在尝试从 java 在外部编辑器中打开文件，但是当我运行我的源代码时，什么也没有发生。我使用的是 JRE 1.6，我的操作系统是 Windows 7。这是我的源代码：

```
Desktop desktop = null;
if (Desktop.isDesktopSupported()) {
  desktop = Desktop.getDesktop();
}

 desktop.edit(new File("D:\\Document.rtf")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:40:14.400

以下内容也应该起作用：

```
Runtime.getRuntime().exec( "cmd /C D:\\Document.rtf" ); 
```

或者

```
 Runtime run = Runtime.getRuntime();
    String lcOSName = System.getProperty("os.name").toLowerCase();
    boolean MAC_OS_X = lcOSName.startsWith("mac os x");
    if (MAC_OS_X) {
        run.exec("open " + file);
    } else {
        //run.exec("cmd.exe /c start " + file); //win NT, win2000
        run.exec("rundll32 url.dll, FileProtocolHandler " + path);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:38:38.847

*   你读过 API

[公共无效编辑（文件文件）抛出 IOException](http://docs.oracle.com/javase/6/docs/api/java/awt/Desktop.html#edit%28java.io.File%29)

> 启动关联的编辑器应用程序并打开一个文件进行编辑。
> 
> 参数：file - 要打开以进行编辑的文件 抛出：NullPointerException - 如果指定的文件为 null IllegalArgumentException - 如果指定的文件不存在 UnsupportedOperationException - 如果当前平台不支持 Desktop.Action.EDIT 操作 IOException - 如果指定的文件没有关联的编辑器，或者关联的应用程序启动失败lang.String) 方法拒绝对文件的写访问，或者它拒绝 AWTPermission("showWindowWithoutWarningBanner") 权限，或者调用线程不允许创建子进程另见：AWT权限

*   你有没有测试并打印 StackTrace

    a) [UnsupportedOperationException](http://docs.oracle.com/javase/6/docs/api/java/lang/UnsupportedOperationException.html)

    b)[安全异常](http://docs.oracle.com/javase/6/docs/api/java/lang/SecurityException.html)

# php - PHPexplode() 中是否允许使用通用字符

> ID：10774708
> 
> 赞同：0
> 
> 时间：2012-05-27T14:29:04.643
> 
> 标签：php, regex

我需要在“2012 年 5 月 27 日星期日上午 6 点 25 分”之前获取所有内容

我希望在“On xxx, xxx xx, xxxx at xx:xx xx”之前得到一切

这里的问题是 5 月、27 日和 6 日的长度都是可变的。什么是这项工作的最佳工具。由于我缺乏正则表达式的经验，我正在尝试使用explode()，但它似乎不能在这里完成这项工作。正则表达式是我最好的选择吗？

[编辑]

我最终使用了答案的组合。我去了：

preg_match("/(.*)On\s+(Sun|Sat|Fri|Thu|Wed|Tue|Mon),\s+(一月|二月|三月|四月|五月|六月|七月|八月|九月|十月|十一月|十二月)\s+\d?\d,\s+\d{4}\s+at\s+\d?\d:\d\d\s+[AP]M,/i", $to, $结尾）;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:35:23.993

我猜是这样的：

```
/On\s+(Sun|Sat|Fri|Thu|Wed|Tue|Mon),\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d?\d,\s+\d{4}\s+at\s+\d?\d:\d\d\s+[AP]M,/i 
```

[编辑]

根据评论：我添加了对不区分大小写的支持（通过将`i`修饰符添加到正则表达式的末尾）。我还更改了表达式中的空格`\s`以允许任何空白字符，并添加`+`以允许单词之间的多个空格。

我没有将其更改为支持长日名称或短月份名称，因为问题指定月份名称的长度是可变的，但没有将日期名称指定为可变的。但是，如果需要，添加这些变体应该足够简单。

[编辑]

```
$to = "Let me know how this response looks..... On Sun, May 27, 2012 at 6:25 AM, Pr";
preg_match("/On\s+(Sun|Sat|Fri|Thu|Wed|Tue|Mon),\s+(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d?\d,\s+\d{4}\s+at\s+\d?\d:\d\d\s+[AP]M,/i", $to, $end); 
```

此代码适用于您评论中给出的示例。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:40:32.777

```
preg_match('/(.*?) On \w+, \w+ \d?\d, \d+ at \d?\d:\d?\d \w\w,/', 'grab this text here On Sun, May 27, 2012 at 6:25 AM,', $matches);
echo $matches[1];
// echoes 'grab this text here' 
```

`(.*?)`匹配开头的所有内容，`\w+`匹配任何字母数字字符 1 次或多次，`\d?\d`匹配一位或两位数字

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T14:52:37.277

正则表达式会起作用，因为这就是它的用途：根据模式选择数据。但是，您可以在“，”（逗号）上爆炸，然后将前 4 个元素再次内爆在一起以形成您的句子。我怀疑在这种情况下使用正则表达式会更快。

归根结底，这是您的偏好：您更容易阅读和理解。在这种特殊情况下，正则表达式的主要优势是它们可以提取特定的值/模式，因此您可以轻松地将它们留出例如月份。

```
$dateString = "On Sun, May 27, 2012 at 6:25 AM, some other text here";

// using explode/implode
$result = explode(',',$dateString);

print "we got: " . implode(',', array_slice($result,0,3)) . "\n";

// using regular expression
$pattern = "/On [A-Z,a-z]{3}, [A-Z,a-z]{3} [0-9]+, [0-9]{4} at [0-9,:]+ (?:A|P)M/U";

preg_match($pattern,$dateString,$match);

print "We got: " . $match[0] . "\n"; 
```

另请阅读[PHP 手册，正则表达式小节](http://www.php.net/manual/en/book.pcre.php)以及初始[教程](http://www.grymoire.com/Unix/Regular.html)

就我个人而言，在这种情况下，我认为 reg exp 可能在视觉和性能方面都过大了。不过一定要学习正则表达式，它们有时会很有帮助。

# ruby-on-rails - Ruby 1.9+ 风格的哈希语法不起作用

> ID：10774709
> 
> 赞同：1
> 
> 时间：2012-05-27T14:29:09.677
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-1.9.3

我在我的 macbook 上运行 ruby​​ 1.9.3p194（2012-04-20 修订版 35410）[x86_64-darwin11.4.0]。

然而，当我尝试使用“新样式”哈希时，例如：

```
stylesheet_link_tag "application", media: "all" 
```

我收到一条错误消息`"unexpected: expecting )"`

我可以通过替换“旧式”哈希火箭来解决这个问题：

```
stylesheet_link_tag "application", :media => "all" 
```

我试图弄清楚为什么 rails 不允许新样式的 ruby​​ 哈希。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T14:41:42.167

听起来 Rails 在系统 ruby​​ 下运行，而您将 RVM 安装为 1.9.3（我猜）

尝试

```
$ rvm --default use 1.9.3 
```

然后重置您的控制台并执行

```
$ ruby -v 
```

仔细检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T16:23:52.763

试着把它放在你的 .bash_profile （或 bashrc 或你正在使用的任何东西）中：

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" # Load RVM function 
```

之后，当然，发出 source 命令然后：

```
rvm use 1.9.2
rvm info 
```

哪个应该工作并显示有关当前 ruby​​ 版本和 gemset 的所有信息。新的哈希语法失败，因为您实际上没有运行 ruby​​ 1.9.3。执行“ruby -v”应该可以确认问题。鉴于您上面的评论，您的 rvm**必须**是一个函数才能使其工作。

另外，您运行的是什么操作系统？

# javascript - 使用jQuery替换最后一个逗号？

> ID：10774713
> 
> 赞同：0
> 
> 时间：2012-05-27T14:30:05.403
> 
> 标签：javascript, jquery, html, replace, slice

[http://jsbin.com/uxepap/3/edit](http://jsbin.com/uxepap/3/edit)

这是里面有链接的div。`<a>`我正在尝试用点“。”替换最后一个逗号。

该逗号来自列表的数字排序，应替换为点。

问题是，所有链接都存储在`links`var 中，不知道如何获取最后一个然后替换它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:32:23.203

采用`String.replace`

```
var links = $('a');

var $last = links.filter(":last");

$last.html( $last.html().replace(",", ".")); 
```

[http://jsbin.com/uxepap/5/edit](http://jsbin.com/uxepap/5/edit)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T14:33:50.550

```
links.eq(-1).html(function(index, value) {
  return value.replace(/,\s*$/, ".");
}); 
```

**演示：http:** [//jsbin.com/uxepap/7/edit](http://jsbin.com/uxepap/7/edit)

# php - mysql中的VARBINARY和BLOB通过PHP序列化数据？

> ID：10774717
> 
> 赞同：0
> 
> 时间：2012-05-27T14:30:43.783
> 
> 标签：php, mysql, database-design

我将`serialized`数据存储在 mysql 中，但不确定选择哪种字段类型？

下面是序列化数据输出的一个示例，

```
string(393) "a:3:{s:4:"name";s:22:"PACMAN-Appstap.net.rar";s:8:"trackers";a:6:{i:0;s:30:"http://tracker.ccc.de/announce";i:1;s:42:"http://tracker.openbittorrent.com/announce";i:2;s:36:"http://tracker.publicbt.com/announce";i:3;s:23:"udp://tracker.ccc.se:80";i:4;s:35:"udp://tracker.openbittorrent.com:80";i:5;s:29:"udp://tracker.publicbt.com:80";}s:5:"files";a:1:{s:22:"PACMAN-Appstap.net.rar";i:4147632;}}" 
```

数据的字符串长度变化很大，最多可达 20,000 个字符。

我知道我不想使用`TEXT`数据类型，因为这可能会因为必须使用的字符集而损坏数据。

`VARBINARY`在使用,等时`BLOB`，我被卡住了。`MEDIUMBLOB`

让我们说如果我使用`VARBINARY(20000)`这是否意味着我可以`20000`安全地插入一个长度为的字符串，如果它结束了则丢弃插入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:59:03.637

我同意 PLB，因为您应该使用`BLOB`. length 属性指定在此列中可以保存多少字节。`BLOB`和之间的主要区别`VARBINARY`是`VARBINARY`用填充填充未使用的空间，而`BLOB`只有数据的实际长度被保留给一个字段。
但正如 PLB 所说，只有在绝对必要时才使用它，因为在大多数情况下它会减慢整个数据库的速度。更好的解决方案是将文件存储在服务器的文件系统中，并将文件的路径保存在数据库中。

# c# - 实体框架：Fluent API 以一对零或一的形式制作重复的外键

> ID：10774722
> 
> 赞同：3
> 
> 时间：2012-05-27T14:31:52.377
> 
> 标签：c#, entity, fluent

我有一些模型，我想有一个“**一对零或一**”的关联。我搜索并尝试使用 Fluent API 进行关联。这是我的课程：

```
public partial class Bill
{

[Key]
public int Id { get; set; }
[Required]
public double Amount { get; set; }

public virtual DomainRegOrder DomainRegOrder { get; set; }

}

public partial class DomainRegOrder
{
[Key]
public int Id { get; set; }
[Required]
public string DomainName { get; set; }

public virtual Bill Bill { get; set; }
} 
```

在我的 DataContext 类中：

```
public class DataContext : DbContext {

protected override void OnModelCreating(DbModelBuilder modelBuilder)
{

 modelBuilder.Entity<DomainRegOrder>()
 .HasOptional(x => x.Bill)
 .WithOptionalDependent();

 } 
```

但是当我初始化数据库时，在**Bills**表中，我将有两列名为“ **DomainRegOrder_Id** ”和“ **DomainRegOrder_Id1** ”。

我尝试在**Bill**实体中添加**DomainRegOrderId ，如下所示：**

 **```
public int? DomainRegOrderId { get; set; } 
```

但是“Bills”表上会有一个“ **DomainRegOrderId** ”和一个“ **DomainRegOrder_Id ”。**

我还将**.WithOptionalDependent()**更改为**.WithOptionalPrincipal()** 但据我所知没有进行任何更改！

有人可以帮我摆脱这些重复的外键吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T17:08:02.640

我相信你想要这样的东西：

```
modelBuilder.Entity<Bill>() 
  .HasOptional(x => x.DomainRegOrder) 
  .WithOptionalDependent(c => c.Bill).Map(p => p.MapKey("DomainRegOrderID"); 
```**

# xml - init 和 initWithID 的区别

> ID：10774725
> 
> 赞同：-1
> 
> 时间：2012-05-27T14:32:20.453
> 
> 标签：xml

有人可以向我解释这条线的作用吗？

```
XMLParser *parser1 = [[XMLParser alloc] initXMLParserWithID:1]; 
```

如何检查 XMLParse 中的 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T16:24:05.130

`alloc`为对象分配内存，初始化器将它们设置为默认状态。有些对象需要额外的信息才能正确设置，所以它们的初始化器有参数。在这种情况下，`XMLParser`对象需要正确设置 ID 号，因此它的初始化程序有一个参数，您可以在其中传递该编号。

> 如何检查 XMLParse 中的 ID？

你能改写这个或举一个你想做的例子吗？不清楚你在问什么。

# php - ajax html响应无法在与javascript的链接上生效

> ID：10774729
> 
> 赞同：0
> 
> 时间：2012-05-27T14:32:40.817
> 
> 标签：php, javascript, html, ajax

我制作了一个表格，用于向用户显示有关某些演示文稿的信息。我使用了 ajax，因为它应该被加载到一个 div 容器中，而不是在每次更改年份时都重新加载。

这是我的 JavaScript：

```
$("#select_coffee_talk_year").button().click(function() {
    var form = $('#coffee_talk_year');  
    var data = form.serialize();

    $.ajax({
        url: 'include/scripts/select_event.php',
        type: 'POST',
        data: data,
        dataType: 'html',
        success: function (select) {
            $("#coffee_talk").html(select);
            $("#coffee_talk").fadeIn();
        }   
    });
    return false;
}); 
```

这是我的 select_event.php：

```
if ('POST' == $_SERVER['REQUEST_METHOD']) {
    /*******************************/
    /** Erzaehlcafe auswählen
    /*******************************/
    if (isset($_POST['coffee_talk_year_submit'])) {
        $getID = array();
        $getDate = array();
        $getTheme = array();
        $getContributer = array();
        $getBegin = array();
        $getPlace = array();
        $getEntrance = array();
        $getFlyer = array();

        $sql = "SELECT 
                    ID,
                    Date,
                    Theme,
                    Contributer,
                    Begin,
                    Place,
                    Entrance,
                    Flyer
                FROM 
                    Coffee_talk
                WHERE
                    YEAR(Date) = '".mysqli_real_escape_string($db, $_POST['year_coffee_talk'])."'
                ORDER BY 
                    Date ASC
                ";

        if (!$result = $db->query($sql)) {
            return $db->error;
        }

        while ($row = $result->fetch_assoc()) {
            $getID[$i] = $row['ID'];
            $getDate[$i] = $row['Date'];
            $getTheme[$i] = $row['Theme'];
            $getContributer[$i] = $row['Contributer'];
            $getBegin[$i] = $row['Begin'];
            $getPlace[$i] = $row['Place'];
            $getEntrance[$i] = $row['Entrance'];
            $getFlyer[$i] = $row['Flyer'];
            $i++;
        }

        $result->close();

        /****************************/
        /**  Output der Tabelle
        /****************************/
        if ($getID[0] == '') {
            echo 'Kein Eintrag vorhanden';
        } else {
            //Kopf
            echo '<table id="table">    
                        <thead>
                            <tr id="table_head">
                                <th>Nr.</th>
                                <th>Datum</th>
                                <th>Thema</th>
                                <th>Referent</th>
                                <th>Begin</th>
                                <th>Ort</th>
                                <th>Eintritt</th>
                                <th>Flyer</th>
                                <th>Bearbeiten</th>
                            </tr>
                        </thead>
                        <tbody>';

            //Mittelteil
            $j = 0;
            for($i = 0; $i < count($getID); $i++) {
                $j = $i + 1;
                echo '<tr>
                    <td class="center">'.$j.'</td>
                    <td class="center">'.$getDate[$i].'</td>
                    <td class="center">'.$getTheme[$i].'</td>
                    <td class="center">'.$getContributer[$i].'</td>
                    <td class="center">'.$getBegin[$i].'</td>
                    <td class="center">'.$getPlace[$i].'</td>
                    <td class="center">'.$getEntrance[$i].'</td>';
                    if ($getFlyer[$i] == '') {
                        //Kein Bild vorhanden
                        echo '<td class="center">Kein Bild vorhanden</td>';
                    } else echo '<td class="center">'.$getFlyer[$i].'</td>';
                    echo '<td class="center">
                        <table id="icons">
                            <tr>
                                <td>
                                    <a href="#" data-event-id="'.$getID[$i].'" data-table="Coffee_talk" class="edit_event">
                                        <img src="images/edit.png" />
                                    </a>
                                </td>
                                <td>
                                    <a href="#" data-event-id="'.$getID[$i].'" data-table="Coffee_talk" class="delete_event">
                                        <img src="images/delete.png" />
                                    </a>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>';
            }

            //Ende
            echo '</tbody>
                    </table>';
        }
    }
} 
```

如您所见，我的输出是一张桌子。我正在使用链接进行编辑和删除功能：

```
<a href="#" data-event-id="'.$getID[$i].'" data-table="Coffee_talk" class="edit_event">
    <img src="images/edit.png" />
</a> 
```

和

```
<a href="#" data-event-id="'.$getID[$i].'" data-table="Coffee_talk" class="delete_event">
    <img src="images/delete.png" />
</a> 
```

这是我的带有占位符 div 的 html：

```
<div>
    <p class="bold underline headline">Bereits eingetragen:</p>
    <form id="coffee_talk_year" action="include/scripts/select_event.php" method="post" accept-charset="utf-8"> 
        <select name="year_coffee_talk" id="year_coffee_talk">
            <option value="none" class="bold italic">Jahr</option>
            <?php
                for($i=2008; $i<=$year; $i++){
                    if ($i == $year) {
                        echo "<option value=\"".$i."\" selected=\"$i\">".$i."</option>\n";
                    } else  echo "<option value=\"".$i."\">".$i."</option>\n";
                }   
            ?>
        </select>
        &nbsp;&nbsp;
        <button id="select_coffee_talk_year">anzeigen</button>
        <input type="hidden" name="coffee_talk_year_submit" value="true" />​​​​​​​​​​​​​​​​​
    </form>
    <br />
    <div id="coffee_talk"></div>
    <br />
    <button id="add_coffee_talk">hinzufügen</button>
</div> 
```

现在我想用这个 JavaScript 来做一个删除和编辑功能：

```
$(".delete_event").click(function() {
    alert('hallo');
    currentUserID = $(this).data("event-id");
    currentTable = $(this).data("table");
    $( "#dialog_delete_event" ).dialog( "open" );
});

$( '#dialog_delete_event' ).dialog({
    autoOpen: false,
    resizable: false,
    height: 170,
    modal: true,
    buttons: {
        'Ja': function() {
            document.location = "index.php?section=event_delete&id=" + currentUserID +"&table=" + currentTable;
            $( this ).dialog( 'close' );
        },
        'Nein': function() {
            $( this ).dialog( 'close' );
        }
    }
}); 
```

我的问题是 click_function （在链接中定义）不起作用。我发现ajax表单响应没有写入html代码。打赌这是问题所在。我该怎么做才能给链接一个有效的点击功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:43:20.587

由于您的代码大小，我不确定，但这是：

```
$(".delete_event").click(function() { 
```

应该

```
$(".delete_event").live("click",function() { 
```

因为你动态地创建了 html；“现场”与此一起工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:43:40.277

像@Albit一样，不确定您的问题是什么，假设ajax工作正常，并且结果在屏幕上可见，而不是使用：

```
$(".delete_event").click(function() { 
```

尝试

```
$(".delete_event").live("click", function() { 
```

这意味着页面加载后满足选择器的元素仍然会触发事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T14:37:45.997

我不知道我是否正确地理解了您的问题，但只需在锚的 html 标记中使用 onclick 事件，您就可以了。如果这不是正确答案请忽略我

# excel - 查找除某些列之外的 SUM

> ID：10774731
> 
> 赞同：2
> 
> 时间：2012-05-27T14:32:55.497
> 
> 标签：excel, sum, formula, excel-formula

下面是我所拥有的。

```
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+  A  +  B  +  C  +  D  +  E  +  F  +  G  +  H  +  I  +  J  +  K  +
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+  1  +  2  +  3  +  4  +  5  +  6  +  7  +  8  +  9  +  10 +  50 +
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
```

要查找此行的**总和**`Cell E`，不包括我使用如下公式。

**`=SUM(A1:D1)+SUM(F1:J1)`**

***注意：`Cell K`有总和。***

有什么替代方法吗？？

以上只是一个示例，但是在我的工作表中大约有 100 列，我需要排除大约 10-15 列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:49:57.097

我相信

```
=SUM(A1:J1)-E1 
```

更清楚地传达你的意图。（当然，如果排除的列包含数字）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T16:51:57.360

如果你像这样添加一行：

```
Row2: yes yes yes yes no yes yes yes yes yes no ... 
```

（作为 A:K 列）

那么答案可能是

```
=SUMIF(2:2,"yes",1:1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T14:38:57.230

我确实认为这是另一种方式

```
=SUM(A1:D1;F1:J1) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T16:03:24.143

在 Excel 中解决此问题的常用方法是将`SUM`函数应用于整个范围并从中减去异常列表，再次使用`SUM`函数，这次使用单个单元格的离散列表求和：

```
=SUM(<range to sum>)-SUM(<exception cell 1>, <exception cell 2>, ...) 
```

这适用于您当前的约 100 个单元格的示例，总计有 5 个例外：

```
=SUM(A1:CV1)-SUM(E1,M1,Y1,AB1,BU1) 
```

如果您想让 Excel 电子表格更灵活地排除这些列，您可以考虑在要排除的列的离散选择上定义一个命名范围。如果在减法`SUM`公式中使用它，您将避免在需要排除其他列时更改公式：您只需更改命名范围规范。

```
=SUM(A1:J1)-SUM(A1:J1 Exclusion_List) 
```

where`Exclusion_List`是要排除的不同列上的命名范围

# c# - 如何在 WPF 中的特定位置添加菜单项？

> ID：10774735
> 
> 赞同：3
> 
> 时间：2012-05-27T14:34:26.753
> 
> 标签：c#, wpf

我想添加这样的菜单项：

```
AddChild(new MenuItem
{
    Header = "Test"
}); 
```

但是，问题在于菜单项出现在最后（逻辑上），现在我正在寻找一种将其添加到特定位置的方法。

```
--A--
--B--
--C-- 
```

我想在 A 和 B 之间添加它。XAML 就像：

```
<ContextMenu>
    <MenuItem ... />
    <MenuItem ... />
    <MenuItem ... />
</ContextMenu> 
```

代码在上下文菜单的上下文中运行。例如，我可以通过它们的名称访问现有的菜单项`A`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:51:21.113

尝试

```
myContextMenu.Items.Insert( newIndex, new MenuItem() {Header="Test"}); 
```

# ios - 仅获取来自的文本和图像 在 Objective-C 中

> ID：10774737
> 
> 赞同：0
> 
> 时间：2012-05-27T14:34:34.653
> 
> 标签：ios, html, rss

我正在制作一个新闻阅读应用程序。我找到的最好的网站是[http://fulltextrssfeed.com/](http://fulltextrssfeed.com/) 它从**任何**网页获取文本和图像并返回干净的文本。由于他们没有 API，我需要一些方法来从`<div>`. 这是 div ID：

```
<div id="preview"> 
```

我怎样才能*浸入*提要并仅获取其内容（如果没有 HTML 标签，那将是一个加号，如果有我可以解决。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T20:06:02.023

我不确定你的问题，但如果你使用 obj-c，我真的推荐[Hpple](https://github.com/topfunky/hpple)。这是一个非常好的 XML/HTML 解析器。

要使用它，您需要在*项目选项*`${SDKROOT}/usr/include/libxml2`中添加“标题搜索路径”并添加到“其他链接器标志”。*`-lxml2`*

 *然后，当您已经拥有 Hpple 文件时，将其拖到您的代码中：`TFHpple.h`, `TFHpple.m`, `TFHppleElement.h`, `TFHppleElement.m`, `XPathQuery.h`, `XPathQuery.m`.

在代码中（为了让你的 div “预览”），添加：

```
NSData *htmlData = [[NSString stringWithContentsOfURL:[NSURL URLWithString: @"http://www.yoursite.com/index.html"]] dataUsingEncoding:NSUTF8StringEncoding];

TFHpple *xpathParser = [[TFHpple alloc] initWithHTMLData:htmlData];
NSArray *elements  = [xpathParser searchWithXPathQuery:@"//div[@id='preview']"]; // Here we use 
TFHppleElement *element = [elements objectAtIndex:0];
NSString *string = [element content];
NSLog(@"%@", string);

[xpathParser release];
[htmlData release]; 
```

现在我们有了 Hpple 的“预览 div”。要获得一些子类（如`p`或`a`），请使用它：

```
NSArray *elements  = [xpathParser searchWithXPathQuery:@"//div[@id='preview']/p/text()"]; 
```

要了解更多信息，请查看[XPath Syntax](http://www.w3schools.com/xpath/xpath_syntax.asp)。还要检查[一个教程](http://blog.objectgraph.com/index.php/2010/02/24/parsing-html-iphone-development/)。

希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T20:08:36.777

我用它非常成功地剥离了所有 html

[NSString + 剥离 HTML](https://gist.github.com/1202238)*

# caching - 基于键的缓存过期

> ID：10774738
> 
> 赞同：8
> 
> 时间：2012-05-27T14:34:38.617
> 
> 标签：caching

我想讨论 37signals 博客上名为[“基于键的缓存过期如何工作”的](http://37signals.com/svn/posts/3113-how-key-based-cache-expiration-works)帖子。我是 Django 开发人员，而不是 RoR，所以这里是 Ross Poulton 的 Django “翻译”：[Key-based cache expiration with Django](http://www.rossp.org/blog/2012/feb/29/fragment-caching/)。

如您所见，主要思想如下：我们有“俄罗斯娃娃”结构，其中一个对象包含多个级别的其他对象。

```
class A:
  timestamp updated_at;

class B:
  A parent;
  timestamp updated_at;

class C:
  B parent;
  timestamp updated_at; 
```

A 类对象的视图（例如 HTML）与所有相关对象一起缓存。当 C 类更新时，我们需要：

1.  更新 C 中的时间戳。
2.  更新 B 中的时间戳。
3.  更新 A 中的时间戳。

当我们在此之后访问 A 类的视图时，我们需要：

1.  进行 SELECT 以从 A 获取时间戳。
2.  检查，没有具有此时间戳的缓存对象，因此我们需要重新缓存它。
3.  进行 SELECT 以获取 A 数据。
4.  进行 SELECT 以从 B 获取所有时间戳。
5.  获取 B 存在于缓存中。
6.  进行 SELECT 以获取缓存中不存在的 B。
7.  进行 SELECT 以获取缓存中不存在的与 Bs 相关的 Cs 的所有时间戳。
8.  从缓存中获取 Cs（如果存在）。
9.  进行 SELECT 以获取缓存中不存在的 C。

因此，如果我正确理解了这个策略，我们需要对 DB 进行 6 次查询——每个对象 2 次：一个会得到时间戳，第二个是缓存中过期的对象。

相反，如果我们要重置所有数据，我们只需要进行 3 次查询：

1.  获取对象 A。
2.  获取相关对象 B.
3.  获取相关对象 C.

据我所知，用更多数据执行 3 个查询而不是用更少数据执行 6 个查询会更好。那么这个策略有效吗？

当然，我们也可以将时间戳存储在缓存中，但是在这种情况下，我们将面临时间戳失效的问题。因此，为需要避免失效的策略使数据失效是没有意义的。

如果我对该算法的范围或工作原理的理解有误，请纠正我。

# java - 某些字符串的 DateFormat 模式

> ID：10774741
> 
> 赞同：1
> 
> 时间：2012-05-27T14:35:02.513
> 
> 标签：java, string, date

我有一些不同格式的日期要解析，但我无法用`SimpleDateFormat`. 谁能帮我找到这个日期的模式：

*   1892 年 7 月 6 日
*   1915 年 5 月 9 日
*   335 年 2 月
*   1768-02-12

和

*   公元前 63 年 9 月 23 日
*   8 月 19 日 广告 14

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:19:39.420

您只需提供您希望您的日期被解析的模式的可能性，并通过它们找到第一个匹配项。

[**运行解决方案。**](http://ideone.com/J4nq3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:45:51.417

[如果您必须使用多种格式进行解析， Joda](http://joda-time.sourceforge.net/userguide.html)通常会更好。例如，

```
 private static DateTimeFormatter dateFormatter;
        String[] validDateFormats = new String[] { "dd-MMM-yyyy HH:mm:ss",
                "yyyy-MM-dd HH:mm:ss.SSS" };
        DateTimeParser[] parsers = new DateTimeParser[validDateFormats.length];
        for (int i = 0; i < validDateFormats.length; ++i) {
            parsers[i] = DateTimeFormat.forPattern(validDateFormats[i])
                    .getParser();
        }
        dateFormatter = new DateTimeFormatterBuilder().append(null, parsers)
                .toFormatter().withZone(DateTimeZone.UTC); 
```

现在，如果输入匹配任何格式，则此 dateFormatter 将正确解析：

```
 inputDate = dateFormatter.parseDateTime(dateStr);
        DateTimeFormatter outputFormat = DateTimeFormat
                .forPattern("yyyy/MM/dd");
        String outputString = inputDate.toString(outputFormat); 
```

可以从这里查找格式字符串：http: [//joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormat.html](http://joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormat.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:31:16.187

试试这些

2012 年 5 月 27 日：

`System.out.println(new SimpleDateFormat("d-MMM-YYYY").format(new Date()));`

27-05-2012 :

```
System.out.println(new SimpleDateFormat("d-MM-YYYY").format(new Date())); 
```

27-05-12：

```
System.out.println(new SimpleDateFormat("dd-MM-YY").format(new Date())); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T14:39:16.943

在这里，您可以找到一个很棒的生成器，用于创建您可以想象的每种日期格式 [http://www.fileformat.info/tip/java/simpledateformat.htm](http://www.fileformat.info/tip/java/simpledateformat.htm)

例如，您的第一个两个示例都是使用 dd MMMM yyyy 生成的；）

# java - Eclipse 在 Ubuntu 上找不到 Java

> ID：10774744
> 
> 赞同：9
> 
> 时间：2012-05-27T14:35:09.740
> 
> 标签：java, eclipse, ubuntu

Java 已正确安装在我的 Ubuntu 12.04 中，并且文件中设置了 PATH 变量`.bashrc`。

该命令`java -version`给出了预期的输出。

但是当我尝试启动 Eclipse 时，它​​会抱怨找不到 JDK。

![在此处输入图像描述](../Images/aa024defe99f97ef1323492aa6c7e322.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-27T14:39:30.070

您可能需要编辑`eclipse.ini`文件并在此处提及路径。阅读[本文](http://wiki.eclipse.org/Eclipse.ini)了解更多详情。

编辑：

```
 -vm
/opt/sun-jdk-1.6.0.02/bin/java 
```

这就是你的 vm 参数在 .ini 文件中的样子。如果没有，请更改它。不过要小心路径。通常 Java 安装在 /opt 中，但在您的系统上检查一次。

另外，也看看[这个](https://stackoverflow.com/questions/4419983/eclipse-cant-find-the-jdk-or-jre)问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-27T14:44:38.267

在我看来，您已经在 shell 中设置了 PATH 环境，但是您正在使用某些菜单项或快捷方式启动 Eclipse，并且上下文使用的是不同的 PATH。

一种选择是像其他答案所说的那样更改 eclipse.ini 文件。

另一种选择是尝试找出为什么使用与命令路径中的路径不同的 PATH 启动 Eclipse。（“修复”可能只是注销并再次登录以使启动器获取更新的 PATH 设置。或者启动器可能从其他地方获取不正确的 PATH 设置。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-27T14:58:49.647

Ubuntu 中的 Java 通常位于`/usr/lib/jvm/<your_java_version>`，但 ubuntu 通常会创建指向当前 Java 版本的符号链接`/usr/lib/jvm/java-7-sun`。符号链接可能存在也可能不存在，具体取决于您在计算机上安装 java 的方式，现在它在 repos 中不再可用。

导航到`/usr/lib/jvm/`并键入`ls`命令以查找 java 所在的适当文件夹。确定位置后，查找名为`libjvm.so`.

在我的机器中，-vm 参数如下所示：

```
-vm
/usr/lib/jvm/java-6-sun/jre/lib/amd64/server/libjvm.so 
```

确保路径在下面的新行中`-vm`，否则它将不起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T14:41:23.617

您可以明确地告诉您的 Eclipse 会话您希望它从哪个 jdk/jre 开始，并在您的中添加以下内容`eclipse.ini`：

```
-vm home/..../jre/bin/javaw.exe 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-27T14:43:40.437

通过包管理器安装eclipse，你应该不会有这个问题。

您已经在您的主目录中手动安装了 eclipse，并且 eclipse 正在尝试查找安装它的 jre，但您可能没有下载带有自己的 jdk 的 eclipse 版本。因此，它需要更多的帮助才能工作。

就像我上面说的，删除你当前的安装并通过包管理器安装。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-10T15:22:08.940

按照以下步骤定义可用于手动安装 JDK 的所有启动器的路径变量

步：

1-

```
 cd /etc/ 
```

2-

```
sudo vim ~/.profile 
```

3-在您的第 2 步打开文件中添加以下代码

```
 PATH="$HOME/bin:$HOME/.local/bin:/usr/lib:$PATH"

  JAVA_HOME="/usr/lib/jvm/jdk1.7.0_79"

  export JAVA_HOME

  PATH=$PATH:$JAVA_HOME/bin

  export PATH 
```

4-重新启动系统

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-11T09:12:21.013

Eclipse 自述文件帮助我清楚地解决了这个问题。

> 如果这似乎可以解决问题，那么问题很可能与使用 GCJ 作为运行 Eclipse 的 Java 运行时有关。位于 Eclipse 文件夹中的 eclipse.ini 文件可以更改为在启动时自动将此参数传递给 Eclipse。其内容示例如下：

```
 -showsplash
  org.eclipse.platform
  -vm
  /opt/jdk-1.8/bin/java
  -vmargs
  -Xms256m
  -Xmx1024m 
```

所以我不得不把这条线放在前面`-vmargs`

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-05-04T07:28:57.273

-vm /home/{Users_Directory}/Desktop/jdk-8u251-linux-x64/jdk1.8.0_251/bin

# iphone - 标签栏不能显示全文

> ID：10774755
> 
> 赞同：0
> 
> 时间：2012-05-27T14:36:45.847
> 
> 标签：iphone, uitabbar

我像这样从xcode拖放一个标签栏 ![在此处输入图像描述](../Images/401c98d1bd1ece21f2ad5eb3a956f92d.png)

但是，当我运行应用程序时......我得到

![在此处输入图像描述](../Images/d452e074d44c0f54ef1183f0e86b90cd.png)

有谁知道为什么我的标签无法显示全文...请就这个问题给我建议。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T01:01:20.427

看起来您正在手动更改标签的字体。找到您要更改它的位置，并更正标签尺寸。

# python - 在 VPython 中创建一个人脸？

> ID：10774764
> 
> 赞同：3
> 
> 时间：2012-05-27T14:38:27.753
> 
> 标签：python, rendering, vpython

在浏览了一些 VPython 的文档之后，我还没有找到一种简单的方法来从三点做一张脸，但我想我可能会遗漏一些东西。我在想象这样的事情：

```
f = face(pts=[(x,y,z), (x,y,z), (x,y,z)], color=red... etc) 
```

也许我应该只使用不同的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-28T20:52:01.267

这是一个简单的例子：

```
from visual import *

scene.title = "Faces example"
scene.width = 600
scene.height = 400

f = frame()
tri = faces(
    pos = [
        [0.,0.,0.], [1.,0.,0.], [0.,1.,0.],   # first tri - vertices
        [0.,0.,0.], [-1.,0.,0.], [0.,-1.,0.]  # second tri - vertices
    ],
    color = [
        [1.,0.,0.], [0.5,0.5,0.], [0.,1.,0.], # first tri - colors
        [0.,0.,1.], [0.,0.5,0.5], [0.,1.,0.]  # second tri - colors
    ],
    frame = f
)

tri.make_normals()
tri.make_twosided()

while True:
    rate(100)
    f.rotate(angle=0.01) 
```

# qt - QSlider 和 QSpinBox 之间的 Qt 模型视图架构

> ID：10774769
> 
> 赞同：0
> 
> 时间：2012-05-27T14:38:55.697
> 
> 标签：qt, architecture, view, model, delegates

我想在 QSlider 和 QSpinBox 之间共享数据。如果我编辑一个，另一个应该得到相同的值，而不必使用模型视图委托架构手动进行。

知道如何将此架构与整数模型一起使用吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T15:34:47.213

我不太确定我是否理解您的问题，但在 Qt 中执行此操作的标准方法是仅使用内置信号和插槽`valueChanged(int)`和`setValue(int)`：

```
connect(slider, SIGNAL(valueChanged(int)), spinbox, SLOT(setValue(int)));
connect(spinbox, SIGNAL(valueChanged(int)), slider, SLOT(setValue(int))); 
```

请注意，这不会产生无限递归，并且在两行代码中，它是非常自动的。

# unit-testing - AngularJS - 注入的基本测试

> ID：10774772
> 
> 赞同：5
> 
> 时间：2012-05-27T14:39:11.613
> 
> 标签：unit-testing, testing, angularjs

所以我对整个测试都是新手（我一直是那些说'我应该编写单元测试......'但从未最终这样做过的人之一：-p）。我现在正在为这个项目编写单元测试。我正在使用 testacular + Jasmine 和 browserify 来编译东西。在我开始尝试做很多 AngularJS 注入工作之前，我没有遇到任何问题。

现在我只是试图对 ng-model 进行测试以了解所有这些。

我有一个 testacular.conf 文件，其中包含所有必要的内容：

```
files = [
    '../lib/jquery.js',
    '../lib/angular.js',
    './lib/jasmine.js',
    './lib/angular-mocks.js',
    JASMINE_ADAPTER,
    './tests.js' //compiled by browserify
]; 
```

我定义了我的控制器（MainCtrl.coffee）

```
MainCtrl = ($scope, $rootScope) ->
    $scope.hello = 'initial'

module.exports = (angularModule) ->
    angularModule.controller 'MainCtrl', ['$scope', '$rootScope', MainCtrl]
    return MainCtrl 
```

我有自己的测试：（_MainCtrlTest.coffee，与 MainCtrl.coffee 在同一目录中）

```
testModule = angular.module 'MainCtrlTest', []
MainCtrl = require('./MainCtrl')(testModule)

describe 'MainCtrlTest', ->
    scope = null
    elm = null
    ctrl = null

    beforeEach inject ($rootScope, $compile, $controller) ->
        scope = $rootScope.$new()
        ctrl = $controller MainCtrl, $scope: scope
        elm = $compile('<input ng-model="hello"/>')(scope)

    describe 'value $scope.hello', ->

        it 'should initially equal input value', ->
            expect(elm.val()).toBe scope.hello

        it 'should change when input value changes', ->
            scope.$apply -> elm.val('changedValue')
            expect(scope.hello).toBe elm.val() 
```

测试立即失败，输入的 elm.val() 返回空白，scope.hello 返回预期值（'initial'，在 MainCtrl.coffee 中设置）

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T18:19:38.067

要使其正常工作，您需要执行以下操作`scope.$apply()`：

```
it 'should initially equal input value', ->
  scope.$apply()
  expect(elm.val()).toBe scope.hello 
```

**不要测试框架，测试你的代码**

您的测试正在尝试测试 Angular 的绑定是否`ng-model`有效。您应该更信任框架并测试您的代码。

你的代码是：

1.  控制器（设置初始`scope.hello`值）
2.  html 模板（以及其中的所有绑定、指令）

您可以非常轻松地测试第一个，甚至无需接触任何 DOM。这就是 AngularJS 的美妙之处——视图/逻辑的强分离。

在这个控制器中，几乎没有什么要测试的，只有初始值：

```
it 'should init hello', ->
  expect(scope.hello).toBe 'initial' 
```

要测试第二个（模板 + 绑定），您需要进行 e2e 测试。你基本上想测试，模板是否不包含任何绑定等拼写错误……所以你想测试真正的模板。如果你在测试期间内联了一个不同的 html，那么你只是在测试 AngularJS。

# jquery - jQuery iframe 隐藏/显示

> ID：10774775
> 
> 赞同：0
> 
> 时间：2012-05-27T14:39:28.467
> 
> 标签：jquery, iframe, hide, show

嗯，我正在编写一个网站，现在卡在 jQuery 部分，这不是我最擅长的事情。该站点包含一个顶部菜单导航栏：

```
<a href="aboutus.html" target="iframe"><img class="tab1" src="#.png"></a>
<a href="menu.html" target="iframe"><img class="tab2" src="#.png"></a>
<a href="gallery.html" target="iframe"><img class="tab3" src="#.png"></a>
<a href="shop.html" target="iframe"><img class="tab5" src="#.png"></a>
<a href="links.html" target="iframe"><img class="tab6" src="#.png"></a>
<a href="contact.html" target="iframe"><img class="tab7" src="#.png"></a>
</div> 
```

页面中间有一个 iframe，它在导航点击时加载新的 html。加载索引页面时，在导航单击之前不应看到 iframe。所以我得到了： css 中的 iframe {display:none;}。

所以，我需要 jQuery 编码方面的帮助才能在导航点击时显示 iframe。还具有使 iframe 再次隐藏的效果。

一切顺利。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:45:13.117

假设您可以执行以下`<iframe>`操作`id`：`contentIframe`

显示`<iframe>`：

```
$("#contentIframe").show(); 
```

隐藏`<iframe>`：

```
$("#contentIframe").hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:47:15.843

我认为如果您尝试使用 div 并使用 .load() 方法，它会比使用 iframe 更好

```
$("a").click(function(){
$("#mydiv").load($(this).attr("href"));
}); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-27T14:45:48.310

[jQuery 切换方法](http://api.jquery.com/toggle/)会很有帮助。

# vba - 将字符串参数放入范围 - VBA

> ID：10774778
> 
> 赞同：1
> 
> 时间：2012-05-27T14:39:46.470
> 
> 标签：vba, excel, ms-office

我在 VBA 中有一个小问题，我想将 Range 函数的行和列以 String 格式放置，如下所示：

```
 debut = "BH" & LTrim(Str(i))
    fin = "DB" & LTrim(Str(i))
    For Each Cell In Ws.Range("debut:fin") 
```

但是我有一个错误，我该如何解决？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T14:54:42.123

你做的方式（`"debut:fin"`），范围真的等于那个字符串并且是无效的。您需要做的是将 2 个字符串与运算符`:`之间的a 连接起来`&`：

```
For Each Cell In Ws.Range(debut & ":" & fin) 
```

# c - C中的字符串到向量，程序接收信号SIGSEGV，分段错误

> ID：10774782
> 
> 赞同：2
> 
> 时间：2012-05-27T14:40:21.567
> 
> 标签：c, string, pointers, memory-management, segmentation-fault

我编写了一个简单的函数来将`C`字符串（不是 C++）制作成`execvp`Linux 中的函数向量。

这是我的代码：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char** vecting(char *cstring) {

    int w_count = 0;           //word count
    char *flag = cstring;

    while (*flag != '\0') {
        if (*flag == ' ' || *flag == '\n' || *flag == '\t')
            *flag = '\0';
            flag++;
        else {
            w_count++;
            while (*flag != ' ' && *flag != '\n' && *flag != '\t' && *flag != '\0')
                flag++;
        }
    }

    char **cvector = (char **)malloc(sizeof(char *)*(w_count+1));
    cvector[w_count] = NULL;
    int v_count;                //vector count

    for (v_count = 0, flag = cstring; v_count < w_count; v_count++) {
        while (*flag == '\0')
            flag++;
        cvector[v_count] = flag;
        while (*flag != '\0')
            flag++;
    }
    return cvector;
}

int main()
{
    char *p = "This is a BUG";
    char **argv = vecting(p);
    char **temp;

    for (temp = argv; *temp != NULL; temp++)
        printf("%s\n", *temp);
    return 0;
} 
```

当我运行它时，我得到了`Segmentation fault`.

然后我调试它，我刚刚发现，运行时

`*flag = '\0'; //(in line 12)`

程序收到信号 SIGSEGV，分段错误。

当时`*flag = ' '`

我无法理解为什么程序在程序更改时收到信号 SIGSEGV`cstring`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T14:42:41.573

```
char *p = "This is a BUG"; 
```

是一个字符串文字，修改它是**未定义的行为**。`char *flag = cstring;`表示`flag`指向与 . 相同的位置（恰好是只读内存）`p`。你试图做的事情（就像现在一样）是非法的。

尝试

```
char p[] = "This is a BUG"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:45:37.403

获得 SIGSEGV 的原因是`"This is the bug"`字符串被放入了 const 部分。当程序被加载时，相应的内存区域被标记为只读。当程序尝试写入只读内存区域时，它会收到分段错误。

# python - 在 Python 中发送电子邮件主题

> ID：10774795
> 
> 赞同：1
> 
> 时间：2012-05-27T14:41:59.883
> 
> 标签：python, email, python-3.x, smtp, smtplib

当我的程序发送电子邮件时，我无法显示我的电子邮件的主题部分。我以为我在遵循 SMTP 的 RFC 规范。但我似乎无法弄清楚我做错了什么。任何帮助是极大的赞赏。

```
def email():

    sender = 'username@domain.com'
    receivers = ['username@domain.com']

    message = """From: From Admin <admin@domain.com>
    To:To Person <user@domain.com>
    Subject: Important Information

    This is a test email message.
    """ 
    try:
        smtpObj = smtplib.SMTP('domain.com', 25)
        smtpObj.sendmail(sender, receivers, message)
        print "Successfully sent email"
    except smtplib.SMTPException:
        print('Error: unable to send email') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T19:09:42.493

不确定您的代码有什么问题。

FWIW，我过去曾使用 string.join 创建我的消息正文：

```
def send_email():
    import string,smtplib

    SMTPserver = "smtp.com"
    # To is a comma-separated list
    To = "sender@domain.com"
    From = "receipient@domain.com"
    Subj = "test subject"
    Text = """test email.
    Not sure what the problem is
    Multi-line anyway."""

    Body = string.join((
        "From: %s" % From,
        "To: %s" % To,
        "Subject: %s" % Subj,
        "",
        Text,
        ), "\r\n")

    s = smtplib.SMTP(SMTPserver)
    s.sendmail(From,[To],Body)

    s.quit() 
```

-J

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T11:10:22.640

试试[http://docs.python.org/library/email-examples.html](http://docs.python.org/library/email-examples.html)中的示例， 或者试试我的示例代码。我不需要 from 标头，但我想您可以根据需要添加它。

```
import smtplib

USER_NAME = 'username@domain.com'
PASSWORD = getpass.getpass("%s's PASSWORD: " % USER_NAME)
DEBUG = True
MESSAGE_FORMAT = "From: %s\r\nTo: %s\r\nSubject: %s\r\n\r\n%s" # %(fromAddr,to,subject,text)

def sendEmail(recipient,message):
    SMTP_SERVER_URL = 'smtp.gmail.com'
    mailserver = smtplib.SMTP(SMTP_SERVER_URL)
    if DEBUG: 
        mailserver.set_debuglevel(1)
        mailserver.ehlo()
        mailserver.starttls()
        mailserver.ehlo()
    mailserver.login(USER_NAME,PASSWORD)
    mailserver.sendmail('', recipient, message)
    mailserver.close()

def sendEmailWithFields(to,subject,text):
    message = MESSAGE_FORMAT%('', to, subject, text)
    sendEmail(to,message)

if __name__ == '__main__':
    to = 'receipient@domain.com'
    subject = 'The subject'
    text = 'The text body'
    sendEmailWithFields(to,subject,text) 
```

# maven - 由于写保护，使用 Maven 部署到 BFTP 服务器失败

> ID：10774800
> 
> 赞同：0
> 
> 时间：2012-05-27T14:43:32.390
> 
> 标签：maven, deployment, ftp

我有一个在 archlinux VM 上运行的 jetty 8 服务器。我将 bftpd 安装为 FTP 服务器，并将我的 maven 项目配置如下：

```
...
<distributionManagement>
    <repository>
        <id>personal-ftp-repository</id>
        <url>ftp://www.example.com</url>
    </repository>
</distributionManagement>
...
<extension>
    <groupId>org.apache.maven.wagon</groupId>
    <artifactId>wagon-ftp</artifactId>
    <version>1.0-beta-6</version>
</extension>
... 
```

在我的 settings.xml 中正确定义了为 distributionManagement 指定名称的存储库，并且部署工作正常，因为它在运行 mvn deploy 时正确上传了组装的 WAR。

但是上传的文件会获得不需要的文件权限。我已将 bftpd UMASK 设置为 000，这导致上传目录的文件权限为 777，上传文件的文件权限为 666。但是这些服务器无法执行，因此码头无法为它们提供服务。

当我手动将 WAR 文件的权限切换到 777 时，该文件将按预期提供。但是当我尝试通过 mvn deploy 上传较新版本的 WAR 时，它报告 FTP 服务器响应：553 错误：远程文件被写保护。即使码头服务器已停止。

必须有一种方法来部署 WAR，而无需手动删除旧的，部署然后必须手动设置文件权限，但我找不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T15:12:02.073

我不知道您使用的是什么服务，但是如果您使用的是tomcat ..也许您可以试试这个..

1.  打开cmd，
2.  导航到 pom.xml 所在的目录
3.  键入命令 --> mvn clean install tomcat:deploy。（在后续运行中使用 tomcat:undeploy tomcat:deploy 或简单的 tomcat:redeploy 以首先删除先前的部署。）

这个单一的命令字符串执行以下所有操作：

*   如果服务/目标输出文件夹已经存在，则删除它（与单独的 mvn clean 相同）
*   重新创建文件夹并生成 Java 类并将其编译到其中（mvn 包）
*   为 Web 服务提供者和 JAR 文件创建 WAR 文件
*   将 JAR 和 WAR 安装到本地 Maven 存储库 (mvn install)
*   取消部署之前的 WAR 文件（如果还使用 tomcat:undeploy 或 tomcat:redeploy）
*   将新的 WAR 文件部署到 Tomcat 上。(mvn tomcat:部署)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T14:42:11.000

默认情况下，在 BFTPD 中禁用 FTP 的 DELE 命令。在 /etc/bftpd.conf 中打开它解决了失败的部署。因此，部署目标似乎首先尝试删除旧文件，然后上传新文件。那也不知道。

# memcached - 为 memcached 数据选择键

> ID：10774801
> 
> 赞同：0
> 
> 时间：2012-05-27T14:43:38.370
> 
> 标签：memcached

我需要将不同类型的数据存储到 memcached

*   会话
*   页面的html
*   数据库查询的结果
*   用户信息
*   网站主题数据
*   一些其他类型的对象

我需要知道选择键的正确方法是什么。

具体来说，对于会话，我应该将会话 ID 设置为键吗？如果将来我增加会话 ID 的长度以超过`250`密钥的限制怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T05:14:06.300

Memcached 不允许您执行基于命名空间的操作，因此在您拥有客户端逻辑之前，键的命名不会产生太大影响。

至于不同类型的数据被设置在同一个memcached中。Memcached 根据设置的数据将内存划分为特定大小的块。因此，如果数据大小分布很大，那么 memcached 就不会最佳地利用空间。

请参考以下链接，深入了解分配系统。

[http://www.adayinthelifeof.nl/2011/02/06/memcache-internals/](http://www.adayinthelifeof.nl/2011/02/06/memcache-internals/)

# html - 当任何事件触发时，画布“requestAnimFrame”很慢

> ID：10774805
> 
> 赞同：0
> 
> 时间：2012-05-27T14:43:57.707
> 
> 标签：html, events, canvas, slowdown

我在画布上绘图时遇到问题。问题是当某些事件触发时，'requestAnimFrame' 很慢。

[http://jsfiddle.net/pAjYC/4/](http://jsfiddle.net/pAjYC/4/)

您可以看到当前绘图和下一个绘图之间的时间。

只需在任何文本框上键入一点长文本。键入时，您会看到很长的间隔时间。

当您在 fsfiddle 的文本框上键入时，它会检查文本的颜色。

这需要一点时间。例如，键入'v'或'var'，在我的情况下，间隔时间更改为16到58。或者通过拖动选择源代码，需要一些时间。原因可能是 DOM 的访问或某些屏幕更改。

但这还不是全部，我正在使用 socket.io 制作游戏。当游戏收到一个 socekt 时，间隔时间为 100 毫秒或更多。但是socket函数只需要10ms或20ms。

这是游戏编程中的关键问题。

有没有办法解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T08:53:31.547

这`requestAnimFrame`并不慢 - 这是你的计算速度慢看这里：

[http://jsfiddle.net/FwynN/](http://jsfiddle.net/FwynN/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T16:50:24.390

您将要使用[Erik Möller 的](http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating)该垫片的更新版本，而不是[Paul Irish 的](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)：

```
(function() {
    var lastTime = 0;
    var vendors = ['ms', 'moz', 'webkit', 'o'];
    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
        window.cancelAnimationFrame = 
          window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];
    }

    if (!window.requestAnimationFrame)
        window.requestAnimationFrame = function(callback) {
            var currTime = new Date().getTime();
            var timeToCall = Math.max(0, 16 - (currTime - lastTime));
            var id = window.setTimeout(function() { callback(currTime + timeToCall); }, 
              timeToCall);
            lastTime = currTime + timeToCall;
            return id;
        };

    if (!window.cancelAnimationFrame)
        window.cancelAnimationFrame = function(id) {
            clearTimeout(id);
        };
}()) 
```

我不确定这是否能解决问题，但......

# javascript - 自动打开谷歌地图信息窗口

> ID：10774809
> 
> 赞同：0
> 
> 时间：2012-05-27T14:44:30.243
> 
> 标签：javascript, maps, infowindow

我有一张带有 InfoWindow 的地图。我需要在页面加载时打开这个 InfoWindow。API中有一个`InfoWindow.open`方法，但它不能正常工作。

这是我当前的代码

```
<html>
<head>
<link rel="stylesheet" href="/static/css/map.css" />
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script>
        var infoWindow = null;
        var map = null;
        var marker;
        function getInfoWindowEvent(marker, content) {
            infoWindow.close()
            infoWindow.setContent(content);
            infoWindow.open(map, marker);
        }
        function initialiseMap() {
            infoWindow = new google.maps.InfoWindow();
            var myLatlng = new google.maps.LatLng({MAP_6_LATITUDE}, {MAP_6_LONGTITUDE});
            var myOptions = {
                  zoom: 12,
                  streetViewControl: false,
                  center: myLatlng,
                  mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            map = new google.maps.Map(document.getElementById("map_side_canvas"), myOptions);
            var bounds = new google.maps.LatLngBounds();
            var image = new google.maps.MarkerImage(
                '/static/img/markers/image.png',
                new google.maps.Size(32,37),
                new google.maps.Point(0,0),
                new google.maps.Point(16,37)
            );

            var shadow = new google.maps.MarkerImage(
                '/static/img/markers/shadow.png',
                new google.maps.Size(54,37),
                new google.maps.Point(0,0),
                new google.maps.Point(16,37)
            );

            var shape = {
                coord: [29,0,30,1,31,2,31,3,31,4,31,5,31,6,31,7,31,8,31,9,31,10,31,11,31,12,31,13,31,14,31,15,31,16,31,17,31,18,31,19,31,20,31,21,31,22,31,23,31,24,31,25,31,26,31,27,31,28,31,29,30,30,29,31,23,32,22,33,21,34,20,35,19,36,12,36,11,35,10,34,9,33,8,32,2,31,1,30,0,29,0,28,0,27,0,26,0,25,0,24,0,23,0,22,0,21,0,20,0,19,0,18,0,17,0,16,0,15,0,14,0,13,0,12,0,11,0,10,0,9,0,8,0,7,0,6,0,5,0,4,0,3,0,2,1,1,2,0,29,0],
                type: 'poly'
            };

            var myLatlng = new google.maps.LatLng({MAP_6_LATITUDE}, {MAP_6_LONGTITUDE});
            marker = new google.maps.Marker({
                  position: myLatlng, 
                  map: map, 
                  icon: image,
                  shadow: shadow,
                  shape: shape,
                  title:"{TITLE}"
            });
            google.maps.event.addListener(marker, 'click', function() {
            getInfoWindowEvent(marker, "<a href='{LINK}'><img src='/system/scripts/i.php?f={MAIN_PHOTO_21}&w=90&h=70&crop=1' class='hotel-img'></a><div class='rating' data-rate_level='{STARS_52}'></div><br /><a href='{LINK}'><h3>{TITLE}</h3></a><div class='price'>From <div class='text'><?=number_format($minprice[0][0],0,',',' '); ?> USD</div></div>");
            });
    infoWindow.open(map);
    return map;
        }
    </script>
</head>
<body onLoad="initialiseMap(); "  id="map_side_canvas" style="margin:0;padding:0;width:100%;height:100%;">
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:57:13.450

```
function initialiseMap() {
  function getInfoWindowEvent(marker, content) { 
```

Errrrr .... 为什么你有两个叠瓦的功能？

* * *

我看到在您调用 infoWindow.close() 的第一个函数中。这会从 DOM 中删除信息窗口。然后你必须重新创建它`new google.maps.infowindow(<params>);`

# delphi - 防止 CallWindowProc 导致访问冲突错误

> ID：10774810
> 
> 赞同：1
> 
> 时间：2012-05-27T14:44:31.523
> 
> 标签：delphi

如何使用此代码防止访问冲突错误：

```
function UsbWndProc(hWnd: hWnd; Msg: UINT; wParam, lParam: Longint)
  : Longint; stdcall;
begin
  try
    if fPrevWndProc <> nil then
      Result := CallWindowProc(fPrevWndProc, hWnd, Msg, wParam, lParam);
    if (Msg = WM_DEVICECHANGE) and (mUSBDetector <> nil) then
      mUSBDetector.DeviceChanged(Msg, wParam, lParam);
  except
    ;
  end;
end; 
```

这是来自 MadExcept 的日志：

```
 callstack crc     : $0d3f54dd, $7c7e133d, $d174bae3
    exception number  : 1
    exception class   : EAccessViolation
    exception message : Access violation at address 0059D5CF in module 'XXX.exe'. Read of address 00000010.
main thread ($8b0):
0059d5cf +00f XXX.exe    Vcl.Forms               TCustomForm.IsFormSizeStored
0059d5b5 +005 XXX.exe    Vcl.Forms               TCustomForm.IsClientSizeStored
0059fd4b +59b XXX.exe    Vcl.Forms               TCustomForm.CreateParams
0050073e +02e XXX.exe    Vcl.Controls            TWinControl.CreateWnd
0059bf99 +005 XXX.exe    Vcl.Forms               TScrollingWinControl.CreateWnd
0059fdc6 +00a XXX.exe    Vcl.Forms               TCustomForm.CreateWnd
00500c82 +016 XXX.exe    Vcl.Controls            TWinControl.CreateHandle
00504a04 +01c XXX.exe    Vcl.Controls            TWinControl.HandleNeeded
00504a11 +005 XXX.exe    Vcl.Controls            TWinControl.GetHandle
005a5ae9 +02d XXX.exe    Vcl.Forms               GetTopMostWindows
765f376c +011 USER32.dll                           EnumWindows
005a5bad +02d XXX.exe    Vcl.Forms               TApplication.DoNormalizeTopMosts
005a5c82 +002 XXX.exe    Vcl.Forms               TApplication.NormalizeTopMosts
005a64c2 +326 XXX.exe    Vcl.Forms               TApplication.WndProc
0048668c +014 XXX.exe    System.Classes          StdWndProc
765f1b52 +016 USER32.dll                           CallWindowProcW
008446b8 +034 XXX.exe    U_Usb     86  +3 UsbWndProc
77c96fcb +02b ntdll.dll                            KiUserCallbackDispatcher
004fefae +0ae XXX.exe    Vcl.Controls            TWinControl.Destroy

008446ab 86   push    edi
008446ac      push    esi
008446ad      push    ebx
008446ae      mov     eax, [ebp+8]
008446b1      push    eax
008446b2      mov     eax, [$902f6c]
008446b7      push    eax
008446b8    > call    -$431be9 ($412ad4)     ; Winapi.Windows.CallWindowProc
008446b8
008446bd      mov     [ebp-4], eax 
```

第 86 行是`Result := CallWindowProc(fPrevWndProc, hWnd, Msg, wParam, lParam);`

我已添加`try-except`，但有时会在我的程序中出现访问冲突错误，尤其是在我关闭程序时。

谢谢。

# java - 如何使用打印机 api 格式化文本以在 JAVA 中打印？

> ID：10774825
> 
> 赞同：0
> 
> 时间：2012-05-27T14:46:32.260
> 
> 标签：java, printing, graphics2d, thermal-printer

我需要在热敏打印机中逐行打印。在 %n 处换行我想在打印时保留字符串模式.. 我不太熟悉打印机 api 和图形 2d api.. 我需要修复这 1 小时的时间.. 非常感谢您的快速回答..在此先感谢我的字符串格式是这样的：

```
String printStat = 
                        "              *****                  %n"
                      + "       W*** OF ** AND *****        %n"
                      + "      4/400 kfjkasjfdkas ajdksa        %n"
                      + "  aksdka ajke ajeklaje  kajke ka  a   %n"
                      + " Date: "+now.get(Calendar.DAY_OF_MONTH)+"/"+(now.get(Calendar.MONTH)+1)+"/"+now.get(Calendar.YEAR)+"             Time: "+now.get(Calendar.HOUR_OF_DAY)+":"+now.get(Calendar.MINUTE)+"%n"
                      + "--------------------------------------%n"
                      + "    Name            Qty     Price    %n"
                      + "--------------------------------------%n"; 
```

打印方法：

```
@Override
public int print(Graphics graphics, PageFormat pageFormat, int pageIndex) throws PrinterException {
       /* We'll assume that Jav2D is available. Create a copy
        * of it so that we can pass the original Graphics
        * instance to the PageFormat instance.
        */
        Graphics2D g2d = (Graphics2D) graphics.create();
        /* Move the origin from the corner of the Paper to the corner
        * of the imageable area.
        */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
        */
        g2d.setPaint(Color.black);
        g2d.setFont(new Font("Arial", Font.BOLD, 10));
        /* Use a LineBreakMeasurer instance to break our text into
        * lines that fit the imageable area of the page.
        */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        //LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {

        TextLayout layout = measurer.nextLayout(wrappingWidth);
        pen.y += layout.getAscent();
        float dx = layout.isLeftToRight() ? 0 : (wrappingWidth - layout.getAdvance());
        layout.draw(g2d, pen.x + dx, pen.y);
        pen.y += layout.getDescent() + layout.getLeading();
        }
        g2d.dispose();
        g2d = null;
        /* Calling the PageFormat is not part of the printing API, 
        * but it is a useful convention. In this example PageFormat 
        * does not implement Printable and so it is not invoked here. 
        * In later examples, PageFormat will implement Printable. 
        */
        try {
        Printable formatPainter = (Printable) format;
        formatPainter.print(graphics, format, pageIndex);
        /* Nothing to do here. The PageFormat has nothing to print.
        */
        } catch (ClassCastException exception) {
        }
        return Printable.PAGE_EXISTS;
       } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:21:40.297

使用固定宽度的字体，将 Arial 替换为“Monospaced”或“Courier”。

# python - 如何处理网络爬虫中的重复href？

> ID：10774833
> 
> 赞同：0
> 
> 时间：2012-05-27T14:48:23.470
> 
> 标签：python, web-crawler, beautifulsoup

我正在做一个爬虫项目。我陷入了这样一种情况，即页面上的 href 文本在该域下的其他页面上不断重复。例如，如果 url 是 example.com，那么这些页面上的 href 值为 hrefList=[/hello/world,/aboutus,/blog,/contact]。

所以这些页面的网址是 example.com/hello/world example.com/aboutus 等

现在在 example.com/hello/world 页面上，hrefList 再次出现。因此，我将获取 URL 作为 example.com/hello/world/hello/world、example.com/hello/world/aboutus 等

现在在这些页面中，/hello/world/hello/world 是一个正确的页面，其 http 状态为 200，并且正在递归地发生。其余页面将找不到页面，因此可以丢弃

我正在获取不正确网址的新网址列表。有什么办法可以克服这个吗？

这是我的代码库：

```
for url in allUrls:
    if url not in visitedUrls:
        visitedUrls.append(url)

        http=httplib2.Http()
        response,content=http.request(url,headers={'User-Agent':'Crawler-Project'})        
        if (response.status/100<4):
            soup=BeautifulSoup(content)
            links=soup.findAll('a',href=True)
            for link in links:
                if link.has_key('href'):
                    if len(link['href']) > 1:
                        if not any(x in link['href'] for x in ignoreUrls):
                            if link['href'][0]!="#":
                                if "http" in link["href"]:
                                    allUrls.append(link["href"])
                                else:
                                    if url[-1]=="/" and link['href'][0]=="/":
                                        allUrls.append(url+link['href'][1:])
                                    else:       
                                        if not (url[-1] =="/" or link['href'][0] =="/"): 
                                            allUrls.append(url+"/"+link['href'])
                                        else:
                                            allUrls.append(url+link['href']) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T15:01:36.070

如果我们假设您获得的页面是相同的，则可能的解决方法是创建页面的哈希并确保您不会抓取具有相同哈希的两个页面。

您散列的内容将决定此启发式算法的稳健性和资源密集程度。您可以散列整个网页内容或其内容/标题的某种组合以及爬虫找到的链接（或除其 URL 之外的每个网页足够独特的其他内容）。显然，包括页面的 URL 不是一个好主意，因为您现在的问题是这些页面具有不同的 URL 但内容相同（带有无效链接）

尽管可以，但您不必为未正确完成的网页实施解决方法。那将是一个永无止境的故事。

# c++ - 拆分字符串并插入向量的最简单方法？

> ID：10774836
> 
> 赞同：0
> 
> 时间：2012-05-27T14:48:54.500
> 
> 标签：c++

> **可能重复：**
> [如何在 C++ 中拆分字符串？](https://stackoverflow.com/questions/236129/how-to-split-a-string-in-c)

根据特定字符拆分字符串然后将元素插入向量中的最简单方法是什么？

请不要建议 boost.algorithm.split

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:33:05.540

解析字符串的方法有很多种，这里有一种使用 substr()

```
#include <iostream>
#include <vector>
#include <string>
using namespace std;

int main()
{
    string strLine("Humpty Dumpty sat on the wall");
    string strTempString;
    vector<int> splitIndices;
    vector<string> splitLine;
    int nCharIndex = 0;
    int nLineSize = strLine.size();

    // find indices
    for(int i = 0; i < nLineSize; i++)
    {
        if(strLine[i] == ' ')
            splitIndices.push_back(i);
    }
    splitIndices.push_back(nLineSize); // end index

    // fill split lines
    for(int i = 0; i < (int)splitIndices.size(); i++)
    {
        strTempString = strLine.substr(nCharIndex, (splitIndices[i] - nCharIndex));
        splitLine.push_back(strTempString);
        cout << strTempString << endl;
        nCharIndex = splitIndices[i] + 1;
    }

    getchar();

    return 0;
} 
```

# javascript - 如何在javascript中实现继承？

> ID：10774838
> 
> 赞同：4
> 
> 时间：2012-05-27T14:49:14.907
> 
> 标签：javascript, jquery, knockout.js

如何在 Javascript 中实现继承？我开始使用 Knockout.js 并实现 ViewModels/page。但是，我有一些函数/代码希望它在所有 ViewModel 之间共享。

我想知道在这种情况下如何实现继承？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T15:08:01.893

继承可能不一定是答案。为什么不使用每个 ViewModel 应该实现的所有方法创建一个对象字面量。我对淘汰赛不熟悉，但这是您可以在本机 js 中执行的操作。

```
 var sharedMethods = {
             run: function () {},
             jump: function () {}
        };

    function Person () {};
    // Use jQuery's extend method
    // Now person has run, jump, and talk
    $.extend(Person.prototype, sharedMethods, {
        talk: function () {}
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-25T22:07:25.787

JavaScript 提供原型继承。对象确实继承自其他对象。这对于方法继承可能很好，但它不适用于属性继承。

通常要继承您可以使用的方法：

```
function BaseViewModel() { 
   var self = this;
   self.name = ko.observable();
}

function Person() {
   var self = this;
   self.firstname = ko.observable();
}

Person.prototype = new BaseViewModel(); 
```

但这会导致所有人共享同一个对象作为原型！当您更改一个人的名称时，该值会传播到所有人员。我倾向于使用 jQuery 的**扩展**方法。

```
function Person() {
   var self = this;
   $.extend(self, new BaseViewModel());

   self.firstname = ko.observable(); 
```

}

这样，来自 BaseViewModel 的值就会被复制到 Person。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:46:58.567

[这是来自 crockford.com 的链接，](http://www.crockford.com/javascript/inheritance.html)
它是了解面向对象 Javascript 的最佳地点。
虽然他的方法一开始并不复杂。它是最好的资源之一，因为他以持续参与 JavaScript 语言的开发、推广数据格式 JSON（JavaScript Object Notation）以及开发各种 JavaScript 相关工具（如 JSLint 和 JSMin）而闻名。

# javascript - 使用 jQuery 从 X 包装到 Y 项目

> ID：10774840
> 
> 赞同：0
> 
> 时间：2012-05-27T14:49:40.133
> 
> 标签：javascript, jquery, html, filter

[http://jsbin.com/uxepap/17/edit](http://jsbin.com/uxepap/17/edit)

如何用一个包装从第三个到最后**一个的****所有链接**？ **`<span class="wrap"></span>`**

 **尝试进行修复，如果可行，链接将位于带有填充的红色背景上。

**注意：**它应该是`a_items`var 内的包装器，然后由`.html();`

**到目前为止，还没有可行的解决方案。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T14:51:29.137

jQuery 可以[`slice()`](http://api.jquery.com/slice/)将您的选择从选定的开始索引过滤到选定的可选结束索引。

[这是一个示例](http://jsbin.com/uxepap/14/edit)。

```
var last = $('a')       //store them in last
    .slice(2)           //get third to last
    .remove()           //remove them from the DOM
    .wrap('<span>');    //wrap them in span 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T14:53:37.400

```
$('a:gt(2)').wrap('<span/>'); 
```

[**演示 1**](http://jsfiddle.net/thecodeparadox/tkpQ6/1/)

或者

```
var links = $('a');
var last = links.filter(':gt(2)');
last.wrap('<span/>'); 
```

[**演示 2**](http://jsfiddle.net/thecodeparadox/tkpQ6/2/)

**根据编辑**

```
$('div a').map(function(index, item) {
    if(index > 2) {
        return $(item).wrap('<span class="wrap"/>').get(0)
    } else return $(item);
}); 
```

**[演示 3](http://jsfiddle.net/thecodeparadox/tkpQ6/7/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T14:54:46.923

`.wrap`包装每个元素。用于[`wrapAll`](http://api.jquery.com/wrapAll/)包装一组元素：

```
last.wrapAll('<span></span>'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T15:03:10.023

```
var links = $('a').slice(2, $('a').length);
    links.wrap('<span/>'); 
```**

# uwsgi - uWSGI：如何在一个 yaml 中包含多个应用程序配置？

> ID：10774844
> 
> 赞同：0
> 
> 时间：2012-05-27T14:51:19.103
> 
> 标签：uwsgi

`uWSGI`我在文档[http://projects.unbit.it/uwsgi/wiki/Example#a3Web2PyinstancesoneXMLconfiguration](http://projects.unbit.it/uwsgi/wiki/Example#a3Web2PyinstancesoneXMLconfiguration)中的 XML 中找到了这个示例配置

可以翻译成相同的配置`YAML`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T17:10:45.650

同样的规则适用：

```
app1:
  socket: xxx
  ...

app2:
  socket: yyy
  ...

app3:
  socket: zzz
  ... 
```

然后

uwsgi --yaml yourfile.yml:app1

uwsgi --yaml yourfile.yml:app2

uwsgi --yaml yourfile.yml:app3

# java - 如何使用jxl检查excel文件是否受密码保护

> ID：10774846
> 
> 赞同：0
> 
> 时间：2012-05-27T14:51:26.857
> 
> 标签：java, excel, jxl

我正在尝试编写和读取受密码保护的 excel 文件，我发现我可以使用“com.jexcel.util.ExcelAdapter”库设置和重置密码。但我找不到检查文件是否受保护的方法。

任何人都可以指导我吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:02:48.337

我想这就是你想要的：[Workbook.isProtected()](http://jexcelapi.sourceforge.net/resources/javadocs/2_6_10/docs/jxl/Workbook.html#isProtected%28%29)

# android - Android- ImageView 不显示

> ID：10774848
> 
> 赞同：2
> 
> 时间：2012-05-27T14:51:32.600
> 
> 标签：android, imageview, gravity

我有这个代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/RelativeLayout02"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >   

 <ImageView  android:id="@+id/terranlogo1"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:src="@drawable/terranlogo"
    android:layout_centerHorizontal="true"
    />

 <ImageView  android:id="@+id/protosslogo1"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:gravity="top|right"
    android:src="@drawable/protosslogo"
    />

 <ImageView  android:id="@+id/zergologo1"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:gravity="top|left" 
    android:src="@drawable/zerglogo"
    /> 
```

右侧的图像视图未显示。其他两个都很好，我什至尝试将它们设置为 50 dp，但“protosslogo1”仍然没有显示。我究竟做错了什么？

谢谢，感谢所有帮助-Lijap

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T14:57:33.597

像这样定位你`ImageViews`：

```
<?xml version="1.0" encoding="UTF-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/RelativeLayout02"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >   

 <ImageView  android:id="@+id/terranlogo1"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:src="@drawable/terranlogo"
    android:layout_centerHorizontal="true"
    />

 <ImageView  android:id="@+id/protosslogo1"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:layout_alignParentRight="true"
    android:src="@drawable/protosslogo"
    />

 <ImageView  android:id="@+id/zergologo1"
    android:layout_width="100dp"
    android:layout_height="100dp"
    android:layout_alignParentLeft="true" 
    android:src="@drawable/zerglogo"
    /> 
```

眼下`protosslogo1`已经落后了`zergologo1`。您正在使用它`android:gravity`来放置. 其次，您没有设置任何规则，因此默认情况下（在 a 中）将它们放置在左上角。`ImageView``View``ImageViews``RelativeLayout`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-10-11T14:02:15.630

您可以使用：

```
android:background="@drawable/terranlogo" 
```

代替：

```
android:src="@drawable/terranlogo" 
```

# java - 使用 webdriver API 实现 BDD (JBehave+Webdriver)

> ID：10774852
> 
> 赞同：1
> 
> 时间：2012-05-27T14:52:14.050
> 
> 标签：java, selenium, webdriver, jbehave

我正在尝试通过实现 BDD 框架来增强我的 Webdriver 脚本。我开始了解 JBehave (JBehave+Webdriver)，但在继续之前，我担心需要多少 Java 代码实现，因为我主要从事自动化测试。根据我的看法，JBehave 分三个步骤工作：

1.  添加故事文件
2.  将故事文件实现为 Java（我在这一步遇到问题）
3.  实现 Webdriver 调用。

因此，使用这种方法如果我有一个用户故事，例如注册到应用程序中，那么：

*   实施用户故事
*   java中的实现——用Java实现完整的认证逻辑
*   实施 webdriver - 自动化用户操作

另一个例子：我有一个执行特定工作流的用户故事，需要在 5-6 页上执行一组操作，然后我需要为此实现/模拟 Java 代码。

这是 JBehave 的工作方式吗？还有没有其他选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T06:51:38.013

jbehave的五步概述：

1.  写故事（纯文本）
2.  将步骤映射到 Java 方法 (POJO)
3.  配置故事（仅一次）
4.  运行故事（使用任何：Ant、Maven、JUnit、Eclipse、IntelliJ）
5.  查看报告 (HTML)

jbehave详情可以访问：http: [//jbehave.org/](http://jbehave.org/)

您可以访问以下教程示例： [https ://github.com/jbehave/jbehave-tutorial](https://github.com/jbehave/jbehave-tutorial)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T11:04:35.853

jbehave 以一种方式工作，并且不依赖于 webdriver 的存在与否，如果您想获得“在一页中”的操作方法，您可以查看[此处](http://ivendelacroix.blogspot.com/2014/02/part-6-jbehave-future-belongs-to-bdd.html?view=sidebar)

Java BDD 框架[http://java.dzone.com/articles/brief-comparison-bdd](http://java.dzone.com/articles/brief-comparison-bdd) - 对我来说 JBehave 和 Cucumber 是最好的选择，因为它们拥有庞大而活跃的社区

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T16:31:55.697

JBehave 的工作方式如下；

1.  写一个故事来描述系统的某种期望行为。这个故事必须根据[JBehave DSL](http://jbehave.org/reference/stable/grammar.html)编写。这个故事本质上描述了 Given/When/Then 流程中的一系列步骤。

2.  在 java 代码中实现 Given/When/Then 步骤。这涉及针对 webdriver API 编写代码以与被测应用程序交互。

3.  运行故事并分析结果。它要么通过，要么失败。

我目前正在写一篇相当详细的博客文章，并会在完成后用链接更新这个答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-02T06:52:32.960

如果您在“纯”Java 中实现故事文件时遇到问题，那么您应该尝试[Ginkgo4j](http://paulcwarren.github.io/ginkgo4j/)。它是 RSpec 的 Java 端口，允许您以与 RSpec 相同的方式进行测试，只是在 Java 中。

将此依赖项添加到您的 POM：

```
 <dependency>
        <groupId>com.github.paulcwarren</groupId>
        <artifactId>ginkgo4j</artifactId>
        <version>1.0.9</version>
        <scope>test</scope>
    </dependency> 
```

创建一个指定 Ginkgo4jRunner 运行器的 JUnit 测试用例：

```
@RunWith(Ginkgo4jRunner.class)
@Ginkgo4jConfiguration(threads = 1)
public class MyTest {
  {
    Describe("ClassUnderTest", () -> {
      Context("#Method", () -> {
        BeforeEach(() -> {
          // before test logic          
        }); 
        JustBeforeEach(() -> {
          ClassUnderTest.Method();          
        }); 
        Context("given a context", () -> {
          It("should do something", () -> {
            // assertions
          });
        });
        Context("given a different context", () -> {
          It("should do something else", () -> {
            // assertions
          });
        });
        AfterEach(() -> {
          // after test logic
        });
      });
    }); 
  }
} 
```

# codeigniter - xampp和网络

> ID：10774857
> 
> 赞同：0
> 
> 时间：2012-05-27T14:53:13.770
> 
> 标签：codeigniter, networking, xampp

我已经在 windows7 上使用 xampp 在我的本地主机上构建了一个站点。现在，我的同事想在我们的小办公室访问和使用该站点。

我尝试使用自己系统的 IP 地址访问该站点。但有些 url 正在重定向到 localhost……我办公室的其他计算机上没有 localhost。

问题是该站点是使用 CodeIgniter 框架构建的，因此它包含一个常量`site_url`，其值为`http://localhost/site`.

我知道我需要一台服务器（或域控制器），并且我必须将我的站点放在该服务器上，以便所有其他计算机都可以访问它。

如果没有在我们办公室用作服务器的计算机，我无法弄清楚如何实现所需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T14:58:08.427

您可以简单地使用 IP 地址或主机名。要获取主机名，只需运行：

```
hostname 
```

在命令提示符中。IP 地址通常类似于`192.168.1.121`

剩下的唯一一件事是在“xxamp”上，您需要确保 localhost 以外的其他人可以访问。虽然如果您在 Windows 7 上托管，我很确定您使用 WAMP ......

所以 site_url 将是`http://192.168.1.121/site`或`http://my_hostname/site`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:59:28.773

尝试将该变量从 localhost/s 站点更改为 192.168.xxx.xxx/site （您的本地 IP）

如果您有路由器，请将其配置为转发端口 80。大多数路由器都有设置虚拟服务器的选项

# ubuntu - 如何获取 DEB 文件的 MD5Sum

> ID：10774861
> 
> 赞同：0
> 
> 时间：2012-05-27T14:54:35.347
> 
> 标签：ubuntu, md5, deb

我的问题是如何获得 DEB 文件的 MD5Sum？我正在制作一个 cydia repo，我的 Packages 文件需要这个。我知道如何找到 MD5Sum，只是不知道要转换为 MD5 的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:06:24.640

像这样？

```
md5sum package.deb 
```

...假设这是包含您的包的文件。

不过说真的，工具链已经知道如何计算了。只需使用现有的 Debian 工具来设置您的存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T10:04:24.887

使用 ar 工具提取 .deb 文件；提取其中的 control.tar.gz 文件。检查 contrl.tar 是否有文件 md5sums。猫 md5sums。这会将文件名打印到右侧，并将它们的 md5 和打印到左侧。您很可能正在寻找这些文件。

# windows-phone-7 - WP7：如何从 C# 代码向 ListBox 添加控件

> ID：10774862
> 
> 赞同：0
> 
> 时间：2012-05-27T14:54:41.180
> 
> 标签：windows-phone-7

有没有办法使用 C# 代码为 WP7 中的每个项目添加一个控件（例如，一个按钮）到 ListBox？并且当点击该按钮时，它将转到所选项目的详细页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T09:17:07.390

您可以创建 XAML 字符串，然后使用 XamlReader.Load 将其加载到 XAML 页面。

XamlReader.Load("XAML 字符串")...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:34:53.907

您可以使用`ItemTemplate`为`ListBox`项目添加自定义模板。它可能看起来像这样：

```
<ListBox ItemsSource="{Binding YourDataSource}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Button Content="{Binding ItemName}" Command="{Binding ItemCommand}" />
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

# .net - .NET Framework 4.5 是否提供 SSE4/AVX 支持？

> ID：10774869
> 
> 赞同：5
> 
> 时间：2012-05-27T14:55:15.113
> 
> 标签：.net, simd, .net-4.5, avx, sse4

我想，我听说过，但不知道在哪里。

**upd：**我讲过JiT

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-27T17:15:18.490

不，.NET 中没有您可以自己编写机器代码的场景。代码生成完全取决于即时编译器。它当然能够根据机器处理器的能力定制其代码生成。ngen.exe 必须始终在目标计算机上运行的重要原因之一。.NET 4.5 中的抖动是否经过调整以利用 sse4 或 avx 是一个悬而未决的问题，我还没有听到任何消息。我宁愿怀疑，除了修复错误之外，微软并没有大量修补这些抖动。非常不稳定，4.5 不是并行版本。

然而，VS-11 确实有一个更新的 C++ 代码生成器。它能够自动矢量化循环，并使用 SIMD/AVX 指令来做到这一点。这篇[博文](http://blogs.microsoft.co.il/blogs/sasha/archive/2011/10/17/simd-optimized-c-code-in-visual-studio-11.aspx)提到了它，[这里](http://channel9.msdn.com/Events/Windows-Camp/Developing-Windows-8-Metro-style-apps-in-Cpp/Getting-the-most-out-of-the-MSVC-compiler-AutoVectorizer)有一个简短的视频。

* * *

更新：[新的 x64 jitter](http://blogs.msdn.com/b/clrcodegeneration/archive/2014/04/03/ryujit-ctp3-how-to-use-simd.aspx)目前在 CTP 中，代号为 RyuJIT，包括对 SIMD 指令的一些基本支持。SSE2 类型，提供自动矢量化。然而，它被严格地锁定在 Microsoft.Bcl.Simd 包和 Vector<> 类中，对于 SIMD 需要快速运行的 16 字节内存对齐要求，没有通用的解决方案。

更有可能取得丰硕成果的是[.NET Native](http://blogs.msdn.com/b/dotnet/archive/2014/04/02/announcing-net-native-preview.aspx)，它是在上一次 Build 大会上宣布的。它使用 C++ 编译器的后端提前生成代码，自动受益于其对自动矢量化和自动并行化的内置支持。否则，如果没有明确的解释，内存对齐问题是如何解决的。它有自己的问题，Reflection 很难，目前只支持打包的应用程序，即可以提前确定运行时依赖关系的那种。Windows 应用商店和电话应用程序。

* * *

更新：这在 .NET 4.6 System.Numerics.Vectors.dll 程序集中提供。请注意，框架中包含的一个是“安全”的，与 MSDN 文档不匹配，`Vector<T>`丢失了。Nuget 包（版本 4.1.0）确实匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-14T15:41:05.987

似乎它来了。（我一个小时前才知道）

这里有几个链接

[JIT终于提出来了。JIT 和 SIMD 要结婚了。](https://devblogs.microsoft.com/dotnet/the-jit-finally-proposed-jit-and-simd-are-getting-married/)

[SIMD 支持更新](https://blogs.msdn.com/b/dotnet/archive/2014/05/13/update-to-simd-support/)

你需要最新版本的[RyuJIT](https://blogs.msdn.com/b/clrcodegeneration/archive/2014/05/12/ryujit-ctp4-now-with-more-simd-types-and-better-os-support/)

和[支持 Microsoft SIMD 的矢量类型](https://www.nuget.org/packages/Microsoft.Bcl.Simd)(Nuget)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-19T20:27:04.547

是的，您可以使用一些矢量类型来确保在可用时使用硬件加速。

[https://docs.microsoft.com/en-us/dotnet/standard/numerics#simd-enabled-vector-types](https://docs.microsoft.com/en-us/dotnet/standard/numerics#simd-enabled-vector-types)

# java - Netbeans 中 Ubuntu 12.04 下 Java 中缺少“org”和“com”包

> ID：10774870
> 
> 赞同：0
> 
> 时间：2012-05-27T14:55:17.910
> 
> 标签：java, netbeans-7

在我的计算机上安装 java openjdk-6-* 和 netbeans apt 包后，我无法在 Netbeans 7.0 中编译或运行任何 java 源文件，我总是收到以下消息：

```
Exception in thread "main" java.lang.RuntimeException: Uncompilable source code - package org.jdesktop.layout does not exist
    at myproject.MyProjectSurface.initComponents(MyProjectSurface.java:34)
    at myproject.MyProjectSurface.<init>(MyProjectSurface.java:21)
    at myproject.MyProject.main(MyProject.java:19)
Java Result: 1 
```

这只发生在我想创建例如 JFrame 表单或任何会使用标题中提到的包的东西时。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:07:48.427

“org.jdesktop.*”包不是标准 Java 安装的一部分。您必须从某个地方下载相关的 JAR 并将它们添加到您的项目中。

# java - 在 Android 中比较日期的最佳方法

> ID：10774871
> 
> 赞同：117
> 
> 时间：2012-05-27T14:55:20.227
> 
> 标签：java, android, datetime

我正在尝试将字符串格式的日期与当前日期进行比较。这就是我的做法（尚未测试，但应该可以），但我使用的是不推荐使用的方法。对替代品有什么好的建议吗？谢谢。

PS 我真的很讨厌用 Java 做 Date 的东西。有很多方法可以做同样的事情，你真的不确定哪一种是正确的，因此我的问题在这里。

```
String valid_until = "1/1/1990";

Calendar cal = Calendar.getInstance();
SimpleDateFormat sdf = new SimpleDateFormat("dd/mm/yyyy");
Date strDate = sdf.parse(valid_until);

int year = strDate.getYear(); // this is deprecated
int month = strDate.getMonth() // this is deprecated
int day = strDate.getDay(); // this is deprecated       

Calendar validDate = Calendar.getInstance();
validDate.set(year, month, day);

Calendar currentDate = Calendar.getInstance();

if (currentDate.after(validDate)) {
    catalog_outdated = 1;
} 
```

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2012-05-27T14:58:46.130

您的代码可以简化为

```
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
Date strDate = sdf.parse(valid_until);
if (new Date().after(strDate)) {
    catalog_outdated = 1;
} 
```

或者

```
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
Date strDate = sdf.parse(valid_until);
if (System.currentTimeMillis() > strDate.getTime()) {
    catalog_outdated = 1;
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2016-05-23T13:28:12.993

您可以使用**[compareTo()](https://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)**

> 如果当前对象小于另一个对象，CompareTo 方法必须返回负数，如果当前对象大于另一个对象，则返回正数，如果两个对象彼此相等，则返回零。

```
// Get Current Date Time
Calendar c = Calendar.getInstance();
SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy HH:mm aa");
String getCurrentDateTime = sdf.format(c.getTime());
String getMyTime="05/19/2016 09:45 PM ";
Log.d("getCurrentDateTime",getCurrentDateTime); 
// getCurrentDateTime: 05/23/2016 18:49 PM

if (getCurrentDateTime.compareTo(getMyTime) < 0)
{

}
else
{
 Log.d("Return","getMyTime older than getCurrentDateTime "); 
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-05-27T14:59:03.650

您可以直接`Calendar`从 a创建一个`Date`：

```
Calendar validDate = new GregorianCalendar();
validDate.setTime(strDate);
if (Calendar.getInstance().after(validDate)) {
    catalog_outdated = 1;
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-05-13T21:35:28.827

请注意，在代码工作之前，正确的格式是 ("dd/MM/yyyy")。“mm”表示分钟！

```
String valid_until = "01/07/2013";
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
Date strDate = null;
try {
    strDate = sdf.parse(valid_until);
} catch (ParseException e) {
    e.printStackTrace();
}
if (new Date().after(strDate)) {
    catalog_outdated = 1;
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-06-10T07:55:57.860

```
String date = "03/26/2012 11:00:00";
String dateafter = "03/26/2012 11:59:00";
SimpleDateFormat dateFormat = new SimpleDateFormat(
        "MM/dd/yyyy hh:mm:ss");
Date convertedDate = new Date();
Date convertedDate2 = new Date();
try {
    convertedDate = dateFormat.parse(date);
    convertedDate2 = dateFormat.parse(dateafter);
    if (convertedDate2.after(convertedDate)) {
        txtView.setText("true");
    } else {
        txtView.setText("false");
    }
} catch (ParseException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

它返回真。您还可以在 and 的帮助下检查之前和`date.before`相等`date.equal`。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-04-06T09:10:48.200

```
Calendar toDayCalendar = Calendar.getInstance();
Date date1 = toDayCalendar.getTime();

Calendar tomorrowCalendar = Calendar.getInstance();
tomorrowCalendar.add(Calendar.DAY_OF_MONTH,1);
Date date2 = tomorrowCalendar.getTime();

// date1 is a present date and date2 is tomorrow date

if ( date1.compareTo(date2) < 0 ) {

  //  0 comes when two date are same,
  //  1 comes when date1 is higher then date2
  // -1 comes when date1 is lower then date2

 } 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-05-27T14:59:23.630

将日期转换为日历并在那里进行计算。:)

```
Calendar cal = Calendar.getInstance();
cal.setTime(date);

int year = cal.get(Calendar.YEAR);
int month = cal.geT(Calendar.MONTH);
int day = cal.get(Calendar.DAY_OF_MONTH); //same as cal.get(Calendar.DATE) 
```

或者：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
Date strDate = sdf.parse(valid_until);

if (strDate.after(new Date()) {
    catalog_outdated = 1;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-30T11:57:32.097

```
SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd",Locale.getDefault());
Calendar calendar1 = Calendar.getInstance();
Calendar calendar2 = Calendar.getInstance();

Date date1 = dateFormat.parse("2013-01-01");
Date date2 = dateFormat.parse("2013-01-02");

calendar1.setTime(date1);
calendar2.setTime(date2);

System.out.println("Compare Result : " + calendar2.compareTo(calendar1));
System.out.println("Compare Result : " + calendar1.compareTo(calendar2)); 
```

将此日历表示的时间与给定日历表示的时间进行比较。

如果两个日历的时间相等，则返回 0，如果此日历的时间在另一个之前，则返回 -1，如果此日历的时间在另一个之后，则返回 1。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-02-15T14:49:02.360

是时候给出现代答案了。

## java.time 和 ThreeTenABP

```
 DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern("d/M/u");
    String validUntil = "1/1/1990";
    LocalDate validDate = LocalDate.parse(validUntil, dateFormatter);
    LocalDate currentDate = LocalDate.now(ZoneId.of("Pacific/Efate"));
    if (currentDate.isAfter(validDate)) {
        System.out.println("Catalog is outdated");
    } 
```

当我刚才运行这段代码时，输​​出是：

> 目录已过时

由于在所有时区都不是相同的日期，因此将明确的时区指定给`LocalDate.now`. 如果您希望目录在所有时区同时过期，您可以提供`ZoneOffset.UTC`，只要您通知您的用户您使用的是 UTC。

我正在使用 java.time，这是现代 Java 日期和时间 API。您使用的日期时间类`Calendar`、`SimpleDateFormat`和`Date`，都设计不佳，幸运的是早已过时。此外，尽管名称 a`Date`不代表日期，但代表时间点。这样做的一个后果是：即使今天是 2019 年 2 月 15 日，一个新创建的`Date`对象已经*在*（所以不等于）`Date`来自 parsing 的对象之后`15/02/2019`。这让一些人感到困惑。与此相反，现代`LocalDate`日期是没有时间（也没有时区）的日期，因此`LocalDate`代表今天日期的两个 s 将始终相等。

## 问题：我可以在 Android 上使用 java.time 吗？

是的，java.time 在较旧和较新的 Android 设备上运行良好。它只需要至少**Java 6**。

*   在 Java 8 及更高版本以及更新的 Android 设备（从 API 级别 26 开始）中，现代 API 是内置的。
*   在 Java 6 和 7 中获得 ThreeTen Backport，现代类的后向端口（ThreeTen 用于 JSR 310；请参阅底部的链接）。
*   在（较旧的）Android 上使用 ThreeTen Backport 的 Android 版本。它被称为 ThreeTenABP。并确保从`org.threeten.bp`子包中导入日期和时间类。

## 链接

*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。
*   [Java 规范请求 (JSR) 310](https://jcp.org/en/jsr/detail?id=310)，`java.time`第一次描述的地方。
*   [ThreeTen Backport 项目](http://www.threeten.org/threetenbp/)，`java.time`Java 6 和 7 的反向移植（ThreeTen for JSR-310）。
*   [ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP) , ThreeTen Backport 的 Android 版
*   [问题：如何在Android项目中使用ThreeTenABP](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)，有非常详尽的解释。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-27T15:04:00.490

你可以试试这个

```
Calendar today = Calendar.getInstance (); 
today.add(Calendar.DAY_OF_YEAR, 0); 
today.set(Calendar.HOUR_OF_DAY, hrs); 
today.set(Calendar.MINUTE, mins ); 
today.set(Calendar.SECOND, 0); 
```

您可以使用它`today.getTime()`来检索值并进行比较。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-06-11T08:06:51.927

**更新：** Joda *-Time*库现在处于维护模式，建议迁移到继承它的*java.time*框架。请参阅[Ole VV 的答案](https://stackoverflow.com/a/54711788/642706)。

* * *

# 乔达时间

java.util.Date 和 .Calendar 类是出了名的麻烦。避开他们。使用[Joda-Time](http://www.joda.org/joda-time/apidocs/index.html)或 Java 8 中的新 java.time 包。

## 本地日期

如果您只想要没有时间的日期，请使用 LocalDate 类。

## 时区

获取当前日期取决于时区。一个新的约会在蒙特利尔之前在巴黎到来。指定所需的时区，而不是依赖于 JVM 的默认值。

Joda-Time 2.3 中的示例。

```
DateTimeFormat formatter = DateTimeFormat.forPattern( "d/M/yyyy" );
LocalDate localDate = formatter.parseLocalDate( "1/1/1990" );
boolean outdated = LocalDate.now( DateTimeZone.UTC ).isAfter( localDate ); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-06-23T09:53:30.100

有时我们需要做一个带有日期的列表，比如

今天有小时

昨天与昨天

2017 年 6 月 23 日的其他日子

为此，我们需要将当前时间与我们的数据进行比较。

```
Public class DateUtil {

    Public static int getDateDayOfMonth (Date date) {
        Calendar calendar = Calendar.getInstance ();
        Calendar.setTime (date);
        Return calendar.get (Calendar.DAY_OF_MONTH);
    }

    Public static int getCurrentDayOfMonth () {
        Calendar calendar = Calendar.getInstance ();
        Return calendar.get (Calendar.DAY_OF_MONTH);
    }

    Public static String convertMillisSecondsToHourString (long millisSecond) {
        Date date = new Date (millisSecond);
        Format formatter = new SimpleDateFormat ("HH: mm");
        Return formatter.format (date);
    }

    Public static String convertMillisSecondsToDateString (long millisSecond) {
        Date date = new Date (millisSecond);
        Format formatter = new SimpleDateFormat ("dd / MM / yyyy");
        Return formatter.format (date);
    }

    Public static long convertToMillisSecond (Date date) {
        Return date.getTime ();
    }

    Public static String compare (String stringData, String yesterday) {

        String result = "";

        SimpleDateFormat simpleDateFormat = new SimpleDateFormat ("yyyy-MM-dd HH: mm: ss");
        Date date = null;

        Try {
            Date = simpleDateFormat.parse (stringData);
        } Catch (ParseException e) {
            E.printStackTrace ();
        }

        Long millisSecond = convertToMillisSecond (date);
        Long currencyMillisSecond = System.currentTimeMillis ();

        If (currencyMillisSecond> millisSecond) {
            Long diff = currencyMillisSecond - millisSecond;
            Long day = 86400000L;

            If (diff <day && getCurrentDayOfMonth () == getDateDayOfMonth (date)) {
                Result = convertMillisSecondsToHourString (millisSecond);

            } Else if (diff <(day * 2) && getCurrentDayOfMonth () -1 == getDateDayOfMonth (date)) {
                Result = yesterday;
            } Else {
                Result = convertMillisSecondsToDateString (millisSecond);
            }
        }

        Return result;
    }
} 
```

[你也可以在GitHub](https://github.com/CabezasGonzalezJavier/BestWayToCompareDatesInAndroid)和这篇[文章](http://thedeveloperworldisyours.com/android/best-way-compare-dates/#sthash.yiWLcls2.dpbs)中查看这个例子。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-08-25T07:44:26.700

在 Kotlin 中，使用内置函数 after() 或 before() 来比较两个时间对象非常简单：

```
expirationTime.after(Date()) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-05-27T15:01:28.540

您可以使用*validDate.setTime(strDate)* 查看[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html上的 javadoc](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-19T20:12:54.137

```
SimpleDateFormat sdf=new SimpleDateFormat("d/MM/yyyy");
Date date=null;
Date date1=null;
try {
       date=sdf.parse(startDate);
       date1=sdf.parse(endDate);
    }  catch (ParseException e) {
              e.printStackTrace();
    }
if (date1.after(date) && date1.equals(date)) {
//..do your work..//
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-12-29T14:36:39.380

> Kotlin 支持运算符重载

在 Kotlin 中，您可以使用比较运算符轻松比较日期。因为 Kotlin 已经支持运算符重载。所以比较日期对象：

```
firstDate: Date = // your first date
secondDate: Date = // your second date

if(firstDate < secondDate){
// fist date is before second date
} 
```

如果您使用的是日历对象，您可以像这样轻松进行比较：

```
if(cal1.time < cal2.time){
// cal1 date is before cal2 date
} 
```

# python - Ctypes 包装器和单元测试

> ID：10774872
> 
> 赞同：0
> 
> 时间：2012-05-27T14:55:33.923
> 
> 标签：python, tdd

我希望包装一个 C 库以在 python 中使用。我还希望使用测试驱动开发来实现我的课程。这是我到目前为止编写的两个类及其接口。我需要包装一大堆像这样的类。

```
class FunctionWrapperForOurLibrary:
    def __init__():
        pass

    def __call__():
        pass

class OurOpener(FunctionWrapperForOurLibrary):
    def __init__(self, our_library):
        self.our_library = our_library
        our_library.OurOpen.argtypes = [c_char_p, c_char_p]
        our_library.OurOpen.restype = OUR_ERROR

    def __call__(self, admin_path, company_path):
        status = self.our_library.OurOpen(admin_path, company_path)
        if status.lRc:
            raise Exception("Unable to connect to database due to this error: "+str(status.lRc))

class OurDataCreator(FunctionWrapperForOurLibrary):
    def __init__(self, our):
        self.our_library = our_library
        our_library.OurCreateData.argtypes = [c_int]
        our_library.OurCreateData.restype = POINTER(OUR_DATA)

    def __call__(self, our_structure_type):
        data = self.our_library.OurCreateData(our_structure_type)
        return data 
```

第一个问题，我是否通过包含接口类来提高可读性？我意识到它不需要。我的对象和类名呢？关于如何使这些更清晰的任何建议？

其次，我如何编写一个包含这些函子的类？一个可单元测试的类？

我能想到的最好的方法是：

```
class Our:
    def __init__(self, our_open, our_data_create, ...):
        self.opener = our_open
        self.data_create = our_data_create

our_open = OurOpener(our_library)
our_data_create = OurDataCreator(our_library)
our = Our(our_open, our_data_create) 
```

但我将有大量函子传递给类构造函数。

这样做有什么更好的吗？

**更新：**

```
class Our:
    def __init__(self, our_library):
        self.our_library = our_library
        our_library.OurOpen.argtypes = [c_char_p, c_char_p]
        our_library.OurOpen.restype = OUR_ERROR
        our_library.OurCreateData.argtypes = [c_int]
        our_library.OurCreateData.restype = POINTER(OUR_DATA)

    def open(self, admin_path, company_path):
        status = self.our_library.OurOpen(admin_path, company_path)
        if status.lRc:
            raise Exception("Unable to connect to database due to this error: "+str(status.lRc))

    def create_data(self, our_structure_type):
        return self.our_library.OurCreateData(our_structure_type) 
```

# c - .text 部分中的动态列表

> ID：10774874
> 
> 赞同：1
> 
> 时间：2012-05-27T14:55:45.920
> 
> 标签：c

老实说，我不知道如何发布这个问题......
我有一个全局动态列表，程序的所有功能都可以看到它，
因为今天这个列表被填充了从文件中读取数据。
但现在我想要一个内部“列表”，如果没有指定文件，则加载该列表。
列表元素是这样的：

```
// odb tuple
typedef struct _odb_t
{
const char *name,*value;
struct _odb_t *next;
} odb_t;

enum _method {GET,POST};

// odb type binding
typedef struct _odb_type
{
    enum _type type;
    const char *value;
    struct _odb_type *next;
} odb_type;

// defining online_db struct
typedef struct _odb
{
    const char *host,*file,*patrn;
    enum _method method;
    odb_type *types;
    odb_t *tuples;
    pthread_t thread; // the thread that is using this host
    struct _odb *next;
} odb; 
```

我怎样才能在 .text 部分中有一个内部列表？
提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:14:36.227

使用 C99，您可以将所谓的复合文字作为某种未命名的变量和指定的初始化程序来简化初始化程序的编写。你的结构有点复杂，我一眼就能捕捉到它们的完整含义，但类似于这里的东西应该可以工作。

```
odb const*const head = 
 &(odb const){
  .method = something,
  .next   = &(odb const){
     .method = another,
     .next = 0,
  },
}; 
```

当然，您必须用正确的数据类似地初始化其他指针字段，但我希望您明白这一点。

当在文件范围内使用时，表单的复合文字`(typename){ initiliazers }`是静态分配的。

# java - 如何将数据从 protobuf-embedded-c 传输到 Google protobuf C++/Java 库？

> ID：10774875
> 
> 赞同：8
> 
> 时间：2012-05-27T14:55:48.853
> 
> 标签：java, c++, embedded, protocol-buffers

我在一个小型系统上使用[protobuf-embedded-c](http://code.google.com/p/protobuf-embedded-c/)将不同的数据从它传输到 PC。问题是，如果我在两端使用嵌入式库，一切正常。如果我在 PC 上使用 google C++，它就不再工作了。我想我将问题追溯到每条消息中都有长度前缀的嵌入式库，但我似乎无法在 C++ 库上以一种好的方式做到这一点。这是我用来调试的测试应用程序：

人.proto：

```
enum PhoneType {
  MOBILE = 0;
  HOME = 1;
  WORK = 2;
}

message PhoneNumber {
  required float number = 1;
  required PhoneType type = 2;
} 
```

主.cpp：

```
#include <stdint.h>
#include <stdio.h>

#define __PROTOBUF_CPP_IMPL

#ifdef __PROTOBUF_CPP_IMPL
#include "person.pb.h"
#else
    extern "C"{
        #include "person.h"
    }
#endif

int main(int argc, char *argv[])
{
    static const uint32_t outputbuflen = 1024;
    uint8_t outputbuffer[outputbuflen];
    uint32_t writtenlenght = 0;

#ifdef __PROTOBUF_CPP_IMPL

    // C++ implementation.
    printf("Google C++ implementation;\n");
    PhoneNumber number;
    number.set_number(0800123123.0);
    number.set_type(MOBILE);

    writtenlenght = number.ByteSize();
    numberSerializeToArray(outputbuffer, writtenlenght);

#else

    // Embedded c implementation.
    printf("embedded-c implementation:\n");
    PhoneNumber number;
    number._number = 0800123123.0;
    number._type = _MOBILE;

    writtenlenght = PhoneNumber_write_delimited_to(&number, outputbuffer, 0);

#endif

    for(uint32_t i = 0; i < writtenlenght; i++){
        printf("%.2X ", outputbuffer[i]);
    }
    printf("\n");
    return 0;
} 
```

真正的问题：Google protobuf C++/Java 库中应该使用哪些方法才能与嵌入式库成功通信？简单的答案可能是在所有消息中添加（解析时读取）前缀，但这会破坏代码。我应该寻找更好的嵌入式库吗？

更新：我尝试了这个很棒的小库 nanopb，它现在很好用。底线：protobuf-embedded-c 与 google protobuf 实现不兼容！

![Protobuf 比较。](../Images/19cd050340d4e9767042bf92fe8f426f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T10:49:17.460

将偏移量设为 -1 而不是 0。例如：

`writtenlenght = PhoneNumber_write_delimited_to(&number, outputbuffer, -1);`

或者你可以使用`PhoneNumber_write(&number, outputbuffer, 0);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T20:00:38.110

In protobuf-embedded-c's [generated C file](http://code.google.com/p/protobuf-embedded-c/source/browse/trunk/edu.tum.cs.ccts.protobuf.embedded/src/edu/tum/cs/ccts/protobuf/embedded/embedded-c-file.stg), there exists

```
int $name$_read(void *_buffer, $if(empty)$$else$struct $name$ *_$name$, $endif$int offset, int limit);
int $name$_write($if(empty)$$else$struct $name$ *_$name$, $endif$void *_buffer, int offset); 
```

which appear to do the expected, reading/writing a message without a size prefix. I don't know why these aren't exposed in the [generated H file](http://code.google.com/p/protobuf-embedded-c/source/browse/trunk/edu.tum.cs.ccts.protobuf.embedded/src/edu/tum/cs/ccts/protobuf/embedded/embedded-h-file.stg), but you should be able to add it yourself.

# android - Android径向渐变

> ID：10774884
> 
> 赞同：7
> 
> 时间：2012-05-27T14:57:02.317
> 
> 标签：android, background, drawable, gradient, radial

我有以下可绘制集作为 LinearLayout 背景：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
   <item>
      <bitmap
         android:tileMode="repeat"
         android:dither="true"
         android:src="@drawable/bg"/>
   </item>

   <item>
      <shape android:shape="rectangle">
         <gradient
            android:startColor="#ffff0000"
            android:endColor="#ff00ff00"
            android:centerX="50%"
            android:centerY="50%"
            android:gradientRadius="50%"
            android:type="radial"/>
      </shape>
   </item>
</layer-list> 
```

根据[文档](http://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html#attr_android%3agradientRadius)，gradientRadius 可以设置为窗口/父大小的百分比。不幸的是......它不起作用。半径为0。我做错了什么？或者安卓有什么问题？

我需要径向渐变来填充整个屏幕。解决方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-08-19T22:06:27.367

有点晚了，但根据文档，您必须设置“50%p”，而不是“50%”。（注意表示“父母”的“p”）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-27T16:51:47.937

如果我很了解您需要什么，您必须制作可绘制的布局

( "match_parent" ) ,

如下 ：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
     android:layout_width="match_parent" 
     android:layout_height="match_parent" 
     android:orientation="vertical" 
     android:background="@drawable/"your drawable xml name"> 
```

希望这有帮助。

# templates - 内置“html/template”或“mustache”，我应该使用哪一个？

> ID：10774886
> 
> 赞同：7
> 
> 时间：2012-05-27T14:57:31.530
> 
> 标签：templates, go, mustache

我是[golang 新手](http://golang.org)，想用它来构建一个网络应用程序。

我发现它内置了[html/template](http://golang.org/pkg/html/template/)，可以渲染带有指定数据的 html 模板，而且还有一个[小胡子端口](https://github.com/hoisie/mustache)，看起来不错。

我不确定我应该使用哪一个。请给我一些建议或他们之间的比较让我决定，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T22:27:24.527

我更喜欢使用 html/template，因为它来自 Go 库，而且设计简单。

您可以在下一个 Web 应用程序中看到它的强大功能：

[https://bitbucket.org/jzs/sketchground/src](https://bitbucket.org/jzs/sketchground/src)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T22:36:36.590

我更喜欢 html/模板。它使用简单。这里的 codewalk [http://golang.org/doc/articles/wiki/](http://golang.org/doc/articles/wiki/)可以作为一个开始。

# html - 替代 css 通用选择器 (*)

> ID：10774891
> 
> 赞同：1
> 
> 时间：2012-05-27T14:58:05.513
> 
> 标签：html, css

![在此处输入图像描述](../Images/0f9a2c41621b010dea3776a21cfe7103.png)

正如您在所附图片中看到的那样，我有一个包装器`div`，里面有`section`.
现在，我希望里面的所有内容`section`都应该有空间（即我想在里面的所有内容上填充`section`。我做不到，

```
section {
  padding:20px;
} 
```

因为它会将宽度`section`增加到 1020 + 20 (left padding) + 20 (right padding) = 1060px。

因为，里面的直接孩子`section`并不总是 div （也有） `aside`，`p`我不能这样做

```
section div{
 margin:20px;
} 
```

目前，我正在做

```
section > *{
    margin:20px;
} 
```

这样每个元素都会从部分中获取 20px 的边距。*这对我*有用，但我听说我们不应该使用通用选择器 (*)，它是性能瓶颈。另外，这甚至是跨浏览器吗？

我还考虑`div`在所有部分中创建一个包装器，它将包含其中的所有元素，这样我就可以做到

```
section > div{
  margin:20px;
} 
```

但是，这是否值得更改标记。通用选择器会这么慢吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:13:46.477

> 因为它会将部分的宽度增加到 1020 + 20（左填充）+ 20（右填充）= 1060px。

尝试设置

```
section{ 
   width: 980;
   padding: 20px;
 } 
```

所以你设置了部分的宽度减去填充的两倍大小，所以最终你的部分将是 1020，正如你所需要的。

这是[工作示例](http://jsfiddle.net/UQk9r/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:02:02.230

不，请从此处查看性能部分[http://paulirish.com/2012/box-sizing-border-box-ftw/](http://paulirish.com/2012/box-sizing-border-box-ftw/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T15:13:20.060

您可以使用逗号分隔的选择器，像这样

```
section > div, section > aside, section > p {
    margin:20px;
} 
```

或者，当然，给所有需要边距的东西一个类，并将该类用作选择器。只要你不使用“hasmargins”作为类名......

但我不确定你为什么认为通过给包装器 div 内的部分提供填充，你会增加包装器 div 的总宽度。我错过了什么吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T15:13:24.853

正如@Ana 所提到的，使用 box-sizing:border-box ( [http://paulirish.com/2012/box-sizing-border-box-ftw/](http://paulirish.com/2012/box-sizing-border-box-ftw/) ) 实际上会解决您的问题，因为您可以将填充添加到父级元素但不占用任何额外的宽度。

另请参阅：[http ://css-tricks.com/box-sizing/](http://css-tricks.com/box-sizing/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-27T15:22:07.563

我相信你不必对截面宽度做任何事情。如果父元素具有固定宽度，则子元素永远不会超过父元素的宽度。

这是演示 - [http://jsfiddle.net/HNVg9/](http://jsfiddle.net/HNVg9/)

# iphone - 如何将 web url 字符串传递给函数

> ID：10774893
> 
> 赞同：1
> 
> 时间：2012-05-27T14:58:06.537
> 
> 标签：iphone, webview, mkannotation

我在将字符串传递给作为网址的函数以通过 web 视图打开该特定方向时遇到问题。

```
-(IBAction)toWeb:(NSString*)web_direction {
    UIViewController *webViewController = [[[UIViewController alloc] init] autorelease];

    UIWebView *uiWebView = [[[UIWebView alloc] initWithFrame: CGRectMake(0,0,320,480)] autorelease];

     [uiWebView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:web_direction]]];

    [webViewController.view addSubview: uiWebView];
    webViewController.title = @"web bar";
    [self.navigationController pushViewController:webViewController animated:YES];

} 
```

我想通过 MKannotation 调用该函数：

```
NSString *direction = @"http://www.google.com";
[btnDetails addTarget:self action:@selector(toWeb:direction) forControlEvents:UIControlEventTouchUpInside]; 
```

但是应用程序崩溃了。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:08:09.507

您不能使用@selector() 以这种方式传递参数。@selector() 仅用于引用选择器以响应某些内容而调用，在这种情况下是按钮上的目标。

如果您想根据按下的按钮调用不同的 url，这里有一个关于如何处理它的建议（对于这个示例，我使用三个不同的按钮向您展示如何根据按下的按钮有条件地使用不同的 url）：

这就是您设置目标的地方：

```
btnDetailsForGoogle.tag = 1;
[btnDetailsForGoogle addTarget:self action:@selector(toWeb:) forControlEvents:UIControlEventTouchUpInside];
btnDetailsForYahoo.tag = 2;
[btnDetailsForYahoo addTarget:self action:@selector(toWeb:) forControlEvents:UIControlEventTouchUpInside];
btnDetailsForBing.tag = 3;
[btnDetailsForBing addTarget:self action:@selector(toWeb:) forControlEvents:UIControlEventTouchUpInside]; 
```

这是更新的 IBAction 方法

```
-(IBAction)toWeb:(id)sender {
    NSString *web_direction = @"";
    if (((UIButton *)sender).tag == 1)  web_direction = @"www.google.com";
    if (((UIButton *)sender).tag == 2)  web_direction = @"www.yahoo.com";
    if (((UIButton *)sender).tag == 3)  web_direction = @"www.bing.com";
    UIViewController *webViewController = [[[UIViewController alloc] init] autorelease];

    UIWebView *uiWebView = [[[UIWebView alloc] initWithFrame: CGRectMake(0,0,320,480)] autorelease];

     [uiWebView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:web_direction]]];

    [webViewController.view addSubview: uiWebView];
    webViewController.title = @"web bar";
    [self.navigationController pushViewController:webViewController animated:YES];

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T15:08:56.410

选择器是方法的名称；它不包括参数。您将需要使用...

```
[btnDetails addTarget:self action:@selector(toWeb:) forControlEvents:UIControlEventTouchUpInside]; 
```

...并找到另一种获取 URL 字符串的方法。获取的参数`toWeb:`是按钮（通常称为“发送者”）。

# java - 将 URLDecoder.decode(temp, "UTF-8") 转换为 php

> ID：10774895
> 
> 赞同：1
> 
> 时间：2012-05-27T14:58:11.517
> 
> 标签：java, php, servlets, urldecode

我正在将 Java Servlet Web 应用程序转换为 php。

我应该如何将以下 Java 命令转换为 php？

```
String temp = request.getParameter("q");
String temp2 = URLDecoder.decode(temp, "UTF-8"); 
```

任何帮助将不胜感激...

编辑：

这是客户端代码：

```
 var myJSONText = playlist.serialize();

  $.ajax({
       type : 'POST',
       url : "playlisthandler.php",
       data : {
           "q" : encodeURIComponent(myJSONText)
       },
       success : function(response) { ... },
       error : function(response) { ... },
       dataType : "json"
   }); 
```

你是说 encodeURIComponent 是多余的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:04:50.783

试试这个

```
$paramValue = urldecode($_GET['q']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:24:04.067

你不应该有这样做的必要。`request.getParameter()`servlet API 和PHP 中的（本质上也是 and ）已经`$_REQUEST`基于`$_GET`请求**字符**编码做到了这一点。这样做的需要表明客户端通过对查询字符串组件进行双重编码而做错了。`$_POST`

 **根据您的代码，您确实对查询字符串进行了显式编码，而 jQuery 已经在幕后做到了这一点：

```
data : { "q" : encodeURIComponent(myJSONText) }, 
```

删除调用`encodeURIComponent()`，使. jQuery 已经注意到它会被 URL 编码。仅当您使用普通香草时才需要。`data``{ "q" : myJSONText }``encodeURIComponent()``XMLHttpRequest`**

# c# - 在 C# 代码中取消订阅 javascript 事件

> ID：10774897
> 
> 赞同：1
> 
> 时间：2012-05-27T14:58:18.853
> 
> 标签：c#, javascript, events, unsubscribe

我在这里遇到了这样的问题：

我在 webbrowser 控件中有一个网页。该页面使用 javascript 并订阅了事件数（即点击）。

这是需要的算法：

1.  在 webbrowser 组件中加载页面
2.  在代码强制页面的 C# 部分中取消订阅 javascript 事件

有没有办法做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T16:00:17.107

**1.方法：**在javascript中创建退订函数，然后从c#端调用，

在页面代码中：

```
<script type="text/javascript">
    // assign the event to the element
   document.getElementById("myElem").onclick = function(){
       //your code here
   }

   // clear the event
   function clearEvent(){
       document.getElementById("myElem").onclick = function(){
          return false;
       }
   }
</script> 
```

在 C# 方面：

```
IHTMLDocument2 doc = (IHTMLDocument2)IE.Document;
IHTMLWindow2 parentWindow = doc.parentWindow;
if (parentWindow != null)
    parentWindow.execScript("clearEvent();", "javascript");
} 
```

**2.方法：**直接从c#调用退订代码

```
IHTMLDocument2 doc = (IHTMLDocument2)IE.Document;
IHTMLWindow2 parentWindow = doc.parentWindow;
if (parentWindow != null)
    parentWindow.execScript("document.getElementById('myElem').onclick=function(){return false;}", "javascript");
} 
```

# ios - 使用浮动 UIView 裁剪 (UIGraphicsImageContext) 图像

> ID：10774900
> 
> 赞同：0
> 
> 时间：2012-05-27T14:58:48.993
> 
> 标签：ios, uiview

这是我的视图层次结构：我在 Xib 中有一个视图（默认 viewControllher 的 _view），其中有一个 UIWebView 子视图。在同一个 Xib 文件中，另一个名为 floatView 的单独的第二个视图（不在 _view 内）。floatView 以编程方式添加到 UIWebView 之上，并且可以由用户拖动。在 floatView 我有一个较小的 subView (cropView)。我想使用cropView 作为裁剪框来获取它下面的可见部分webView。

这是我尝试使用的代码，但结果不是我需要的。

```
- (IBAction)captureImage:(id)sender {

    CGSize layerSize = self.view.bounds.size;

    UIGraphicsBeginImageContext(layerSize);

    [self.webView.layer renderInContext:UIGraphicsGetCurrentContext()];

    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    [floatView convertRect:cropView.frame toView:self.view];

    CGRect CropFrame = cropView.frame;

    CGImageRef subImageRef = CGImageCreateWithImageInRect(image.CGImage, CropFrame);
    UIImage *subViewImage = [UIImage imageWithCGImage:subImageRef];
    UIGraphicsEndImageContext();

    UIImageWriteToSavedPhotosAlbum(subViewImage, nil, nil, nil);
} 
```

我在相机胶卷中获得的图像是我裁剪的图像，尺寸正确，不在可见 webView 的正确位置。

我查看了其他帖子和解决方案，但找不到可以解决我的问题的帖子和解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T22:49:04.317

解决了（有点）。将 floatView 移到 _view 层次结构中，位于 webView 的顶部，并设法使用我在[此处](https://stackoverflow.com/questions/4422500/how-to-get-uiview-frame-origin-and-size-while-animation)找到的 [view.layer presentationLayer].frame 解决方案获取其原点坐标。现在它工作...

# mysql - mySQL 数据库创建/设计 - 不确定如何在这样的情况下组织数据

> ID：10774908
> 
> 赞同：0
> 
> 时间：2012-05-27T14:59:38.043
> 
> 标签：mysql, database, database-design

通常我可以简单地用一个问题搜索谷歌并找到答案，但我对 mySQL 数据库一无所知，所以我从头开始。

我的问题是如何格式化/组织我拥有的数据，当它不像电子表格那么简单时。我认为它会被格式化的方式会导致数十万个单独的表，这似乎不正确。这是我拥有的数据，也许有人可以为我指出正确的方向，即如何在 mySQL 数据库中组织它，这样不仅可以组织起来，而且可以根据每个人生成报告“数据点”：

我已经从网站的特定 URL 中抓取了产品评论，比如说亚马逊。我需要按照它们留在亚马逊上的顺序保留评论。

为了简单起见，我会说我从亚马逊上的三个不同 URL 中抓取了产品评论：

```
http://amazon.com/product/12345-x
http://amazon.com/product/12345-y
http://amazon.com/product/12345-z 
```

因此，从这三个 URL 中的每一个中，每个 URL 上都有 3 个不同的人留下了评论。所以我认为它将如何存储在数据库中（这不可能是正确的）是这样的：

```
 TABLE FOR PRODUCT 12345-X
REVIEW NUMBER    REVIEWER     THEIR REVIEW     NAME OF PRODUCT   PRODUCT PRICE   REVIEW LEFT ON
1                username     great product    some product      $399            monday
2                username     crappy product                                     wednesday
3                username     okay product                                       wednesday

          TABLE FOR PRODUCT 12345-Y
REVIEW NUMBER    REVIEWER     THEIR REVIEW     NAME OF PRODUCT   PRODUCT PRICE   REVIEW LEFT ON ON
1                username     great product    some product      $399            monday
2                username     crappy product                                     wednesday
3                username     okay product                                       wednesday

          TABLE FOR PRODUCT 12345-Z
REVIEW NUMBER    REVIEWER     THEIR REVIEW     NAME OF PRODUCT   PRODUCT PRICE   REVIEW LEFT ON ON
1                username     great product    some product      $399            monday
2                username     crappy product                                     wednesday
3                username     okay product                                       wednesday 
```

现在，由于我已经获得了数千种产品的数据，这显然会导致数以千计的表格，而这不是组织事物的正确/最佳方式。

让事情变得更糟/更复杂的是，有时同一种产品的价格会发生变化，所以它以两种不同的价格出售（实际上，有很多不同的价格）。我还希望能够获得以多个价格出售的每种“相同产品”的“平均价格”，并显示作为一个整体和每个产品的最常留下的日期评论.

因此，您可以看到，我不仅需要能够为每个产品生成报告，而且还需要为每个产品中的每个“列”数据生成报告……这将导致更多的表格。

有人可以指出我应该如何在数据库中组织这些数据的正确方向吗？

如果我的问题太荒谬而无法回答，我深表歉意，我什至不知道如何在数据库中组织它，甚至不知道从哪里开始（在谷歌中输入什么短语）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:46:17.537

如果我猜对了，您想存储 threr 不同的东西：1 产品 2 每个产品的评论 3 人的数据如何排列评论，如姓名......

所以你需要的只是桌子。

```
TABLE FOR PRODUCT
ProductID  P_Price   P_Name
1          399       Name X
2          299       Name y
3          199       Name z

TABLE FOR Review
ReviewID  ProductID  Review            R_Date           UserID
1         2          Review for y      1/1/2012         1
2         1          Review for x      1/1/2010         2
3         3          Review for z      4/4/2009         2

Table for User
UserID    U_Name
1         Peter
2         Simon 
```

所以现在你可以看到 Simon 为 X 和 Z 写了一个 Rewiev。每个产品都有一个评论。一般来说，如果你必须在运行时创建一个表，你会做一些非常糟糕的事情。Tabes 始终是一种修复结构，只有在您决定进行一些重大更改时才会更改，例如为每个用户添加密码。当您添加新信息（例如新评论）时，您总是只添加一个或多个条目。

我觉得你应该得到一本关于 MySQL（或你曾经使用过的）的书或长篇教程，其中 hopfuly 是关于数据组织的重要章节。

我希望我能帮助你。

# erlang - 我如何将 Erlang 中的 PID 转换为二进制中的 1 个字节？

> ID：10774909
> 
> 赞同：0
> 
> 时间：2012-05-27T14:59:45.243
> 
> 标签：erlang

我需要在 Erlang 中将 pid 转换为二进制，并将其发送到另一个 pid。但我需要二进制数据的大小为 1 个字节。有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-27T15:41:24.303

你不能这样做。一个字节只能表示 256 个不同的值，而可能的进程 ID 则超过 256 个。PID 对节点标识和依赖于实现的进程号进行编码；[有人可以解释 Erlang 中 Pid 的结构吗？](https://stackoverflow.com/questions/243363/can-someone-explain-the-structure-of-a-pid-in-erlang)有更多细节。您需要安排您的协议以允许发送或存储多个字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:41:53.833

鉴于`PID`Erlang 中的结构[超过 8 位](https://stackoverflow.com/a/262179/177800)，我会说答案是否定的。

# css - 如何使用谷歌地图获得 2 列布局？

> ID：10774911
> 
> 赞同：0
> 
> 时间：2012-05-27T14:59:50.837
> 
> 标签：css, google-maps, layout

我正在尝试在网页中获得 2 列（3 个窗格 = 2 + 1）布局，左窗格显示 Google 地图和下方的一些数据（详细信息 div），右列显示一些数据（结果 div），但我无法让（结果）数据 div 与 Google 地图的右侧对齐。它显示在详细信息 div 右侧的 Google 地图下方。这是我的代码：

CSS 代码：

```
#map_canvas {
    margin: 10px 10px 10px 10px;
}
#details {
    width: 45%;
    height: 20em;
}
#results {
    width: 52%;
    float: right;
    height: 40em;
    overflow: scroll;
} 
```

HTML 代码：

```
<div id="map_canvas" style="width:45%; height:20em;"></div>
<div id="results"></div>
<div id="details"></div> 
```

当前输出截图：

[http://i.stack.imgur.com/AdVcX.jpg](http://i.stack.imgur.com/AdVcX.jpg)

我不确定出了什么问题。我做了很多谷歌搜索，但我认为这与谷歌地图有关。请帮帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T15:09:03.697

实际上，对于您当前的 CSS 和 HTML，这正是它应该看起来的样子。

您有一个`map_canvas`未浮动的 div （面板），因此 HTML 中之后的所有内容（这意味着您的面板`results`和`details`面板）都低于此（除非在或面板`map_canvas`上使用绝对或固定定位，这不是这里的情况）。`results``details`

*解决方案*：将结果首先放在您的 HTML 中，然后将左侧的两个窗格包装在另一个 div 中。

像这样：

```
<div id="results"></div>
<div class="left-col">
    <div id="map_canvas" style="width:45%; height:20em;"></div>
    <div id="details"></div>
</div> 
```

您可以在此处查看结果：http: [//dabblet.com/gist/2814665](http://dabblet.com/gist/2814665) - 我对您的 CSS 所做的唯一更改是为面板添加轮廓。

# java - Java 排序算法（版本为字符串）

> ID：10774914
> 
> 赞同：-4
> 
> 时间：2012-05-27T15:00:27.760
> 
> 标签：java, algorithm, sorting

假设我有一个版本号列表作为字符串

*   2_1.1.1_release
*   3-2_snapshot
*   3.2.1 <---我想要的那个
*   1.3（稳定）
*   0.2(1_releaseCan)

每个版本都是一个 String 。我已经通过正则表达式将它们拆分，将它们保存到 String[]s 集合中我如何设计一个算法来找到最大的版本号？注意 3.2 小于 3.2.1 因为 3.2 等于 3.2.0 是的，任何缺失的数字都被视为 0

谢谢大家

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T15:39:39.663

虽然不是最优的，但直截了当的解决方案

```
public class VersionComparator implements Comparator<String>  {

  public int compare(String version1, String version2) {
    // Split version into parts
    String parts1[] = getVersionParts(version1),
           parts2[] = getVersionParts(version2);

    // Go through common prefix left to right, first part which is higher indicates
    // higher version (4.2.1 > 4.2.0 > 3.9.9)
    for (int i = 0 ; i < Math.min(parts1.length, parts2.length); i++) {
      int partComparison = compareVersionPart(parts1[i], parts2[i]);
      if (partComparison != 0){
        return partComparison;
      }
    }

    // Common prefix is the same; longer value means higher version
    // (3.2.1 > 3.2)
    if (parts1.length > parts2.length) {
      return 1;
    } else if (parts1.length < parts2.length) {
      return -1;
    } else {
      return 0;
    }

  }

  protected String[] getVersionParts(String version) {
    return version.split("\\.");
  }

  protected int compareVersionPart(String part1, String part2) {
    int versionPart1 = Integer.parseInt(part1),
        versionPart2 = Integer.parseInt(part2);

    if (versionPart1 > versionPart2) {
      return 1;
    } else if (versionPart1 < versionPart2) {
      return -1;
    } else {
      return 0;
    }
  }

} 
```

然后你做类似的事情`Arrays.sort(versions, new VersionComparator())`并选择最后一个元素。更新：`Collections.max()`会是更好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T15:14:51.697

试试这个比较器：

```
private static final Comparator<String[]> comp = new Comparator<String[]>() {
    public int compare(String[] arg0, String[] arg1) {
        int length = arg0.length;
        if (arg1.length>arg0.length) length = arg1.length;

        for (int i=0; i<length; i++) {
            String s0 = null;
            if (i<arg0.length) s0 = arg0[i];
            Integer i0 = (s0==null)?0:Integer.parseInt(s0);
            String s1 = null;
            if (i<arg1.length) s1 = arg1[i];
            Integer i1 = (s1==null)?0:Integer.parseInt(s1);
            if (i0.compareTo(i1)<0) return -1;
            else if (i1.compareTo(i0)<0) return 1;
        }
        return 0;
    }
}; 
```

然后使用 arrays.sort() 方法： Arrays.sort(strings, comp);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:19:44.850

比较器的算法是这样的：

```
public int compare(String a, String b) {
    Integer a1 = firstPart(a);
    Integer b1 = firstPart(b);

    int res = a1.compareTo(b1);

    if (res != 0) 
        return res;

    return compare(remainingParts(a), remainingParts(b));
} 
```

您只需要实现*firstPart*和*remainingParts*。然后，您可以使用*Arrays.sort*。

# php - 当参数是整数而不是字符串时，javascript onclick 函数是否有效？

> ID：10774916
> 
> 赞同：1
> 
> 时间：2012-05-27T15:00:44.750
> 
> 标签：php, javascript, jquery, ajax

```
echo '<a onclick="load_tags('.$list['id'].')"></a>' 
```

当`list[id]`是一个数字，它的工作原理。但是当`list[id]`是一个词时，它不起作用。为什么？

以下是有关该功能的一些背景知识以及我在做什么。尽管出于回答这个问题的目的没有必要。

脚本

```
function load_tags(id){
        $.post('../php/tags/get_tags.php',{id:id},function(data){
            $('#tags_selected').text(data);
        });
    } 
```

get_tags.php

```
$tag_id=$_POST['id'];
    echo $tag_id;
    $users_with_this_tag=show_all_users_with_this_tag($tag_id);
    if(count($users_with_this_tag)!=0){
            foreach($users_with_this_tag as $key => $list){
                echo $list['user_id'];
            }
    }else{
        echo'Nobody with this tag';
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T15:05:58.193

只需`load_tags`用转义的单引号包围参数：

```
echo '<a onclick="load_tags(\''.$list['id'].'\')"></a>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:06:05.790

字符串应该有引号：

```
echo '<a onclick="load_tags(\"'.$list['id'].'\")"></a>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:07:16.900

因为它会导致语法错误。用 int 调用 JS 函数：

```
function(123) 
{
 ....
} 
```

并带有字符串：

```
function('foo') 
{
 ....
} 
```

如果没有*'*，它会在字符串名称下搜索变量（如果它是有效的变量名称）。

# linux - 自动完成在eclipse中根本不起作用

> ID：10774921
> 
> 赞同：1
> 
> 时间：2012-05-27T15:01:36.043
> 
> 标签：linux, eclipse, autocomplete, eclipse-cdt

嘿，我无法在我的 eclipse Indigo 3.7.2 上自动完成工作。操作系统：Ubuntu 12.04 LTS。它根本不起作用，即使是我自己在项目中的文件并且编译得很好。我已经用谷歌搜索了这个问题并找到了几个可选的解决方案，我尝试添加包含路径，例如：/usr/include/c++/* （尽管我不认为这应该解决问题，因为它甚至无法使用我的文件）到项目设置，我尝试重新构建索引器，我什至重新安装了eclipse，似乎没有任何帮助。

这里有没有人遇到过这个问题并找到了解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T10:34:19.850

通过手动安装 eclipse 而不是使用包管理器解决了这个问题。我猜在使用 Ubuntu 12.04 LTS 时，默认包管理器版本中存在错误。

# objective-c - RSYNC 目录与文件

> ID：10774924
> 
> 赞同：1
> 
> 时间：2012-05-27T15:02:28.457
> 
> 标签：objective-c, rsync, nstask

我正在尝试为它编写一个小 RSync 程序，并且我设法让它与下面的代码一起工作。唯一的问题是它只同步单个文件而不是目录。如果您`rsync`通过终端命令运行，它可以将整个目录复制到其他目录中。有人知道修复吗？

```
 NSString *source = self.source.stringValue;
NSString *destination = self.destination.stringValue;

NSLog(@"The source is %@. The destination is %@.", source, destination);

NSTask *task;
task = [[NSTask alloc] init];
[task setLaunchPath:@"/usr/bin/rsync"];

NSArray *arguments;
arguments = [NSArray arrayWithObjects: source, destination, nil];
[task setArguments: arguments];

NSPipe *pipe;
pipe = [NSPipe pipe];
[task setStandardOutput: pipe];

NSFileHandle *file;
file = [pipe fileHandleForReading];

[task launch];

NSData *data;
data = [file readDataToEndOfFile]; 
```

我有两个用于源和目标的文本字段，我采​​用字符串值并将它们设置为等于源和目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T00:27:35.327

如果您在命令行上调用 rsync，则可以使用一个开关来获得您所描述的效果：“-a”选项：它是其他几个选项的简写，这里最相关的是 rsync 的指令从源目录向下递归。

这将递归地将目录“foo”及其所有内容复制到目录“bar”中。如果“bar”不存在，rsync 会创建它，然后将“foo”复制到其中。

```
rsync -a foo bar 
```

... 会导致 bar/foo/everything

另一个需要注意的微小（但重要！）细节是您是否在源目录上放置了斜杠。如果你改为说：

```
rsync -a foo/ bar 
```

...你最终会得到 /bar/everything，但在接收端没有名为“foo”的目录。

您会说“将目录 foo 的**内容**复制到目录栏……但不是封闭目录 foo。”

抱歉，这不是更具体的 Objective-C，但希望这会让你继续使用 rsync。

# dns - Google 会在没有 DNS 的情况下为我的 VPS 编制索引吗？

> ID：10774928
> 
> 赞同：1
> 
> 时间：2012-05-27T15:02:42.523
> 
> 标签：dns, vps

我即将将我的网站上传到 VPS。我还不想让 Google 为我的网站编制索引——我只想使用 VPS 返回给我的 IP 地址来测试我的网站。我知道我可以使用 robots.txt 来阻止 Google 将我的网站编入索引，但如果我不将 DNS 指向我的 VPS ， **Google 甚至会找到我的网站吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:07:18.553

如果互联网上有其他网站有指向它的链接，谷歌和任何其他搜索引擎都会找到您的网站。如果没有链接，谷歌将找不到它。另一方面，当有链接时，它是否只包含 IP 地址或域名都没有关系。但是，我认为在搜索结果中，Google 更喜欢具有有效 DNS 名称的站点，而不是仅限 IP 的站点。

# php - Php函数在PDO中不起作用

> ID：10774935
> 
> 赞同：-1
> 
> 时间：2012-05-27T15:03:28.683
> 
> 标签：php, function, pdo

我在旧的 mysql 中创建了一个函数，现在想将它转移到 PDO，但它不起作用。这是我的新代码：

```
global $host, $dbname, $user, $pass;
    $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);
    $STH = $DBH->query("SELECT SUM(score), SUM(score_from) FROM school_test_report, school_students 
    WHERE (school_test_report.student_id = school_students.student_id 
    and school_test_report.class=school_students.class) 
    and school_test_report.student_id = '$student_id' and  school_test_report.subject = '$subject'
    and school_test_report.test_date >= '$thisarch'
                                ")
    $STH->setFetchMode(PDO::FETCH_ASSOC);
    return $STH; 
```

它输出：

```
$student_id = test_score_month($name, 'English');
echo $student_id['score'].'/'.$student_id['score_from']; 
```

这是正在运行的旧代码：

```
$result1 = mysql_query("SELECT SUM(score), SUM(score_from) FROM school_test_report, school_students 
    WHERE (school_test_report.student_id = school_students.student_id 
    and school_test_report.class=school_students.class) 
    and school_test_report.student_id = '$student_id' and  school_test_report.subject = '$subject'
    and school_test_report.test_date >= '$thisarch'
                                ")
    or die(mysql_error());  
    $row = mysql_fetch_assoc($result1);
 return $row; 
```

它输出：

```
$student_id = test_score_month($name, 'English');
echo $student_id['score'].'/'.$student_id['score_from']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:32:53.933

这是一个示例，将所有函数与与用户相关的查询包装在模型类中，然后调用每个方法以返回结果等，查看函数/方法如何使用占位符`:student_id`，然后将值绑定到这些占位符，它是只是一个例子，但会帮助你了解更多。

```
<?php 
class user_model{

    private $db;

    function __construct($host,$dbname,$user,$pass){
        $this->dbhost = $host;
        $this->dbname = $dbname;
        $this->dbuser = $user;
        $this->dbpass = $pass;
    }

    private function connect(){
        if (!$this->db instanceof PDO){
            $this->db = new PDO('mysql:dbname='.$this->dbname.';host='.$this->dbhost, $this->dbuser, $this->dbpass);
            $this->db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        }
    }

    function user_test_score($student_id,$subject,$thisarch){
        $this->connect();
        $sql = "SELECT SUM(score) as score, SUM(score_from) FROM school_test_report, school_students
                WHERE (school_test_report.student_id = school_students.student_id 
                AND school_test_report.class=school_students.class) 
                AND school_test_report.student_id = :student_id and  school_test_report.subject = :subject
                AND school_test_report.test_date >= :thisarch";
        $statement = $this->db->prepare($sql);
        $statement->bindParam(':student_id', $student_id, PDO::PARAM_INT);
        $statement->bindParam(':subject', $subject, PDO::PARAM_STR);
        $statement->bindParam(':thisarch', $thisarch, PDO::PARAM_STR);
        $statement->execute();
        return $statement->fetchAll(PDO::FETCH_ASSOC);
    }

}

$usermodel = new user_model('localhost','YOURDB','username','password');

$student_id = $usermodel->user_test_score($name,'English',your_test_date_format);

print_r($student_id);
?> 
```

# mingw - MinGW 中的静态链接库

> ID：10774937
> 
> 赞同：10
> 
> 时间：2012-05-27T15:03:51.813
> 
> 标签：mingw, static-libraries

假设我有三个 C 源文件。前两个是 LIB (lib*.a?)，第三个是使用它们的应用程序。

第一个是（re.c）：

```
int re(int i) {
    return i;
} 
```

第二个是（test.c）：

```
int re(int); // Depends on re.c

int test(int i) {
    return re(i);
} 
```

第三个是（main.c）：

```
#include<stdio.h>

int test(int); // Uses test.c

int main(void) {

    printf("%d\n",test(0));
    return 0;
} 
```

现在如何创建前两个 LIB，以便稍后将它们静态链接到主应用程序？

我知道如何创建 DLL 并在我的应用程序中动态链接它们，例如：

> cc -o re.dll re.c -shared -Wl,--out-imlib=libre.a (for re.c)
> 
> cc -o test.dll test.c -L。-lre -shared -Wl,--out-implib=libtest.a (for test.c)
> 
> cc -o main.exe main.c -L。-lre -ltest

* * *

那么如何创建等效的 LIB 以在 MinGW 中的可执行二进制文件中静态链接，以及如何链接它们？

显然，在 Windows 下:)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-27T16:45:49.910

我在这里找到了解决方案：http: [//www.codeproject.com/Articles/84461/MinGW-Static-and-Dynamic-Libraries](http://www.codeproject.com/Articles/84461/MinGW-Static-and-Dynamic-Libraries)

这个想法是在不链接的情况下编译所有库（源文件）。然后转换输出对象，`ar rcs -o lib*.a *.o`其中 * 是创建的对象的名称（一一转换）。之后，我们简单地编译应用程序`-L.`以指定目录并`-l*`指定库名称而不使用 GNU 命名修饰。

对于那些依赖别人的库，应该先指定，再指定引用的库，否则`undefined reference to re`会出现我做的时候出现的错误`-lre -ltest`，哪里`-ltest -lre`是对的，因为测试库引用了re库。

这是我编译它的方法：

> cc -c -o test.o test.c
> 
> cc -c -o re.o re.c
> 
> ar rcs -o libtest.a test.o
> 
> ar rcs -o libre.a re.o
> 
> cc -o main.exe main.c -L。-ltest -lre

它也适用于 Tiny C 编译器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:46:57.863

您是否尝试过使用以下选项：-static -mwindows

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-26T21:09:47.707

添加到Ghasan的答案。（如果所有 %.a 文件和目标文件都可用，则可以将其构建为静态）

正如我在 lib/ 目录（所有 %.a 文件）中看到的那样，mingw 中的大多数库都是静态的。在我的情况下，共享依赖项只是静态库中根本不存在的 libstd++-6.dll 和 libgcc_s_dw2-1.dll。

如果没有这两个共享库，我将无法运行我的可执行文件。正如描述所读，

> 这是一个可自由再分发的库；它是由 GNU C++ 语言编译器编译的任何应用程序所必需的（并且您必须与它一起分发），除非在构建时明确禁用对共享运行时库的支持。

# git - Git 哈希是如何构造的？

> ID：10774942
> 
> 赞同：2
> 
> 时间：2012-05-27T15:05:18.487
> 
> 标签：git

什么样的属性构成了 Git 中的哈希？我意识到它可能会因对象类型（提交、树等）而有所不同。

例如，提交哈希是如何产生的？它是否可能涉及提交消息和更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:59:31.990

来自[Pro Git](http://git-scm.com/book/en/Git-Internals-Git-Objects)：

> 该命令的输出是一个 40 个字符的校验和哈希。这是 SHA-1 散列 - 您正在存储的内容的校验和加上一个标头

那一章有更详细的内容。

# php - 检查重复条目与使用 PDO errorInfo 结果

> ID：10774943
> 
> 赞同：38
> 
> 时间：2012-05-27T15:05:24.493
> 
> 标签：php, mysql, pdo

我有一个 MySQL 表，其中有一个定义为唯一的电子邮件地址字段。对于此示例，假设我的表单所做的只是允许用户将他们的电子邮件地址插入表中。

由于电子邮件字段是唯一的，因此如果他们尝试输入相同的电子邮件两次，则查询应该会失败。我很好奇这两种情况之间的权衡：

`SELECT`1）在执行插入之前运行一个快速语句。如果选择返回结果，通知用户，不要运行该`INSERT`语句。

2）运行`INSERT`语句，并检查重复输入错误

```
// snippet uses PDO
if (!$prep->execute($values))
{
    $err = $prep->errorInfo();
    if (isset($err[1]))
    {
        // 1062 - Duplicate entry
        if ($err[1] == 1062)
            echo 'This email already exists.';
    }
} 
```

此外，请假设正常使用，这意味着重复条目应该是最少的。**因此，在第一种情况下，您显然需要为每个**插入运行额外的查询，而在第二种情况下，您依赖于错误处理。

另外，我很想听听关于编码风格的想法。我的心在说‘做一个防御型程序员！插入前检查数据！当我的大脑说“嗯，也许让 MySQL 为你检查数据会更好”。

**编辑**- 请注意，这不是一个“我该怎么做”的问题，而是一个“我为什么要以特定的方式做这个”的问题。我包含的小代码片段有效，但我很好奇的是解决问题的最佳方法。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-05-27T15:41:35.313

您可以使用 try catch 块执行此操作：

```
try {
   $prep->execute($values);
   // do other things if successfully inserted
} catch (PDOException $e) {
   if ($e->errorInfo[1] == 1062) {
      // duplicate entry, do something else
   } else {
      // an error other than duplicate entry occurred
   }
} 
```

您还可以研究诸如“INSERT IGNORE”和“INSERT ... ON DUPLICATE KEY UPDATE”之类的替代方案-尽管我认为这些是 MySQL 特定的，并且会违背使用 PDO 的可移植性，如果您担心的话.

编辑：为了更正式地回答您的问题，对我来说，完全使用的解决方案＃1（防御性程序员）首先有效地消除了唯一约束的点。所以我同意你让 MySQL 负责数据检查的想法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-27T16:10:55.557

`INSERT`+ 检查状态应该是更好的方法。使用`SELECT`+您可以让另一个线程在 the和 the`INSERT`之间插入相同的值，这意味着您还需要将这两个语句包装在表锁中。`SELECT``INSERT`

在编码中过多的防御很容易出错。Python 有句谚语“请求宽恕比请求许可更容易”，这种哲学并不是真正特定于 Python 的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-02-27T13:44:08.217

请注意，如果您有一个 AUTO_INCREMENT 列并且您正在使用 InnoDB，那么一个失败的 INSERT 确实会增加“下一个 auto-id”值，尽管没有添加新行。例如，请参阅 InnoDB 中的[INSERT ... ON DUPLICATE KEY](https://dev.mysql.com/doc/refman/8.0/en/insert-on-duplicate.html)和[AUTO_INCREMENT 处理](https://dev.mysql.com/doc/refman/8.0/en/innodb-auto-increment-handling.html)的文档。这会导致 AUTO_INCREMENT id 出现空白，如果您认为自己可能会用完 id，这可能是一个问题。

因此，如果您希望尝试插入已经存在的行是常见的，并且您希望尽可能避免 AUTO_INCREMENT id 中的间隙，您可以同时进行先发制人检查和异常处理：

```
$already_exists = false;
$stmt = $pdo->prepare("SELECT id FROM emails WHERE email = :email");
$stmt->execute(array(':email' => $email));
if ($stmt->rowCount() > 0) {
    $already_exists = true;
}
else {
    try {
        $stmt = $pdo->prepare("INSERT INTO emails (email) VALUES (:email)");
        $stmt->execute(array(':email' => $email));
    } catch (PDOException $e) {
        if ($e->errorInfo[1] == 1062) {
            $already_exists = true;
        } else {
            throw $e;
        }
    }
} 
```

如果我们确定电子邮件已经存在，第一个查询确保我们不会尝试插入电子邮件。如果电子邮件似乎还不存在，则第二个查询尝试插入电子邮件。我们仍然需要在第二个查询中检查异常，因为在不太可能的竞争条件（多个客户端或线程并行运行上面的代码片段）中仍然可能出现重复。

这种方法使代码健壮，同时仍然避免在 AUTO_INCREMENT id 中创建间隙，除非在极少数情况下竞争条件。如果尝试插入现有电子邮件比尝试插入新电子邮件更常见，这也是最快的方法。如果尝试插入现有电子邮件的情况很少见，并且您不关心 AUTO_INCREMENT id 中的空白，则无需进行先发制人的检查。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-11T11:25:17.647

对我有用的一种更简单的方法是根据一组重复的状态代码检查错误代码。这样你就不必担心 PDO 返回什么。

```
$MYSQL_DUPLICATE_CODES=array(1062,23000);
try {
   $prep->execute($values);
   // do other things if successfully inserted
} catch (PDOException $e) {
   if (in_array($e->getCode(),$MYSQL_DUPLICATE_CODES)) {
      // duplicate entry, do something else
   } else {
      // an error other than duplicate entry occurred
   }
} 
```

谢谢！:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-15T11:48:11.570

我没有检查代码，而是使用了这样的 catch 块来捕获主键重复条目，并使用该错误代码：`1062 Duplicate entry`

```
catch (PDOException $e) {

  if(str_contains($e, '1062 Duplicate entry')) {
       header("Location: login.php");
  }
die("Error inserting user details into database: " .  $e->getMessage());

} 
```

# php - 从 SQL 显示数据时遇到问题，它不显示

> ID：10774945
> 
> 赞同：0
> 
> 时间：2012-05-27T15:05:44.320
> 
> 标签：php, sql

我在显示 $row[product_name] 时遇到问题，它显示为空白，而 $row2['index'] 似乎正在查找所有正在显示的数据，这似乎是什么问题？或者在 while 语句中放入两个参数是非法的，有什么见解吗？

```
$sql = mysql_query("SELECT * FROM product_detail LIMIT 5") or die(mysql_error());
$sql2 = mysql_query("SELECT * FROM product LIMIT 5") or die(mysql_error());

if($sql && $sql2){

while($row = mysql_fetch_array($sql) && $row2 = mysql_fetch_array($sql2)){

 $product_name = $row["product_name"]; echo $row["product_name"] ;
 $product_id = $row2["product_id"];
 $product_qty = $row2["balance_qty"];
 $product_price = $row2["unit_price"];  

                    echo '  <tr>
                            <td>'.$product_id.'</td>
                            <td>'.$product_name.'</td>
                            <td>'.$product_price.'</td>
                            <td>'.$product_qty.'</td>
                           </tr><br/>';

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:13:00.000

使用类似这样的代码的单一查询将使您回到游戏中：

```
$sql = "SELECT p.product_id, p.product_name, d.unit_price, d.balance_qty
FROM product AS p
JOIN product_detail AS d ON (d.product_id=p.product_id)
LIMIT 5";
$result =mysql_query($sql) or die(mysql_error());
while($row = mysql_fetch_array($result)){
    echo '  <tr>
    <td>'.$row['product_id'].'</td>
    <td>'.$row['product_name'].'</td>
    <td>'.$row['unit_price'].'</td>
    <td>'.$row['balance_qty'].'</td>
    </tr>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:21:01.360

这是什么意思：

```
$product_name = $row["product_name"]; 
```

只需直接使用 $row["product_name"] 即可。

在进入循环之前还要检查一下：

```
echo "FIRST: ".mysql_num_rows($sql);
echo "SECOND: ".mysql_num_rows($sql2); 
```

他们有相同的行数？否则，您将了解@Umbrella 所说的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:12:12.157

我相信你在这里有一个操作顺序（优先级）问题。尝试改变

```
while($row = mysql_fetch_array($sql) && $row2 = mysql_fetch_array($sql2)){ 
```

至

```
while(($row = mysql_fetch_array($sql)) && ($row2 = mysql_fetch_array($sql2))){ 
```

`$sql`此外，如果您在看到循环中的所有记录之前用完记录，`$sql2`则不会获取下一个`$row2`

另外，您是否有理由不能用一个查询来做到这一点？

# java - 切入点与继承混淆

> ID：10774946
> 
> 赞同：0
> 
> 时间：2012-05-27T15:05:45.250
> 
> 标签：java, aspectj, spring-aop, pointcut

我对编写一个匹配方法的所有执行的切入点感到困惑。我尝试了应该匹配类的所有方法执行的切入点`Alpha`：

```
execution(* Alpha.*(..)) 
```

具有以下类层次结构

```
public class Alpha {
    public void alphaMethod() {...}
}
public class Beta extends Alpha {
    public void betaMethod() {
        alphaMethod();
    }
} 
```

如果 Main-program 调用`alphaMethod`-instance`Beta`我的建议会像预期的那样被调用，但是在我的建议内部调用的 Main-program 调用`betaMethod`不会`alphaMethod`被调用，我不明白为什么。

*方面定义*：

```
@Aspect
public class MyAspect {
    @Before(value = "execution(* Alpha.*(..))", argNames="joinPoint")
    public void myAdvice(JoinPoint joinPoint) {
        System.out.println("BEFORE: " + joinPoint.getSignature());
    }
} 
```

*主要方法*：

```
Beta beta = ...;
beta.alphaMethod(); //advice is called
beta.betaMethod(); //advice is NOT called. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:50:04.383

这是意料之中的。

Spring AOP 使用代理类来包装建议的 bean。当您`alphaMethod()`从`Beta`方法中调用时，代理甚至不知道它。

有关更多信息，请参阅[此](https://stackoverflow.com/questions/3423972/spring-transaction-method-call-by-the-method-within-the-same-class-does-not-wo)答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T17:08:41.500

正如已经回答的那样，原因很清楚。您可以通过使用*加载时编织*而不是代理来解决此问题（我想它归结为某个地方的配置选项和对 AspectJ 的依赖，如果还没有依赖它的话）或将 bean 作为依赖注入自身然后实现

```
public void betaMethod() {
    selfBean.alphaMethod();
} 
```

这将起作用，因为`selfBean`与 的引用不同`this`，前者是对代理的引用，后者是对原始代理对象的引用。

# jquery - 如何使用 codeigniter 和 datatables Jquery 插件创建服务器端数据表

> ID：10774950
> 
> 赞同：0
> 
> 时间：2012-05-27T15:06:23.790
> 
> 标签：jquery, codeigniter, datatables

我正在将 Codeigniter 与[dataTables](http://datatables.net) Jquery 插件一起使用。

我有大约 3000 行要显示在表中的记录（我正在使用 postgresql）。但我不希望第一次加载整个记录（它会减慢页面加载速度）。反而。我更喜欢将它分成几个页面并在用户点击下一步按钮时根据用户操作加载它。我对我制作的一些代码感到困惑，但它仍然在表格底部显示完整的记录，其中“显示 1 到 NaN 的 NaN 条目（从 NaN 总条目中过滤）”。这是我的代码。

控制器：

```
<?php

class Testdata extends CI_Controller
{
    function __consrtuct()
    {
        parent::__consrtuct();
    }

    function index()
    {
        $this->load->view('vtestdata');
    }

    function getData()
    {

        $this->load->model('mtestdata');
        $result = $this->mtestdata->getDatax();
        echo json_encode($result);

    }
} 
```

该模型：

```
<?php

class Mtestdata extends CI_Model
{
    function __construct()
    {
        parent::__construct();
    }

    function getDatax()
    {

        //output
        $output = array(
                "aData" => array()
            );
        $this->db->select('nik, user_name');
        $query=$this->db->get('t_mtr_user');
        $output["aData"] = $query->result();
        return $output;
    }
} 
```

风景：

```
<head>
    <script type="text/javascript" src="<?php echo base_url();?>/assets/media/js/jquery.js"></script>
    <script type="text/javascript" src="<?php echo base_url();?>/assets/media/js/jquery.dataTables.js"></script>
    <script type="text/javascript" src="<?php echo base_url();?>/assets/jqueryUI/js/jquery-ui-1.8.20.custom.min.js"></script>

    <script type="text/javascript">
        $( document ).ready( function() {

            $('#testTable').dataTable({

                "bJQueryUI": true, //UI
                "sAjaxSource": "<?=base_url();?>index.php/testdata/getData", //datasource
                "sAjaxDataProp": "aData", //menentukan array/json dibaca dari mana
                "bServerSide": true, //serverside , ini yg bermasalah, kalo di delete beres gak ada error, tapi gak SSP
                "bProcessing": true,
                "aoColumns":[ //tentukan kolom pd tabel dan value nya
                    {"mDataProp": "nik", "sTitle": "NIK"},
                    {"mDataProp": "user_name", "sTitle": "Username"}
                ] 

           });
        });

    </script>
    <link rel="stylesheet" type="text/css" href="<?php echo base_url();?>/assets/jqueryUI/css/custom-theme/jquery-ui-1.8.20.custom.css">
</head>
<body>
<div>
<h1>test</h1>
<table id="testTable">
    <thead>
        <!--
        <tr>
        <th>nik</th>
        <th>User name</th>
        </tr>
        -->
    </thead>
    <tbody>
    <!--
        <td></td>
        <td></td>
        -->
    </tbody>
</table>
</div>
</body> 
```

有什么建议吗？我真的很感谢你的帮助。:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T07:23:42.170

而是参考此[代码](https://github.com/blake-nouribekian/codeigniter-datatables)。我使用它制作了我的数据表，它运行良好。如果您对此有任何疑问，请告诉我。

# ssh - 如何为多个工作站设置 ssh 公钥的中心位置？

> ID：10774955
> 
> 赞同：-1
> 
> 时间：2012-05-27T15:07:37.320
> 
> 标签：ssh, key, public, sharing

我们的设置是一个带有多个工作站、笔记本电脑和 NAS（用于存储工作产品和备份）的工作场所。

要直接访问其他工作站，我们使用 ssh 和通常的 keygen 并在 .ssh 目录中复制彼此的公钥。

但是在一台机器上更改 ssh 密钥会导致对所有其他工作站执行多个复制操作。

是否有一种易于维护的方式来存储公钥，例如在 NAS 上告诉 ssh 在本地 .ssh 目录中查找它们。

或者是否需要一个密钥服务器来共享这些密钥？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T15:12:29.783

这样做不是一个好主意，因为您有一些安全问题，[授权密钥的中央位置](https://serverfault.com/questions/313465/is-a-central-location-for-authorized-keys-a-good-idea)详细说明了这种配置设置所面临的问题。

# php - 如何使用 PHP 在 MySQL 中存储 Facebook 用户的好友列表？

> ID：10774959
> 
> 赞同：0
> 
> 时间：2012-05-27T15:08:17.183
> 
> 标签：php, mysql, arrays, facebook, facebook-graph-api

如何使用 PHP 在 MySQL 中存储 Facebook 用户的好友列表？

我可以使用下面的 PHP 代码获取并打印用户的好友列表吗？

```
//get friends list
$friends_list = file_get_contents('https://graph.facebook.com/me/friends?access_token=' . $atoken );

$friends_list_array  = json_decode($friends_list,true); 

//convert so that store in mysql 
$my_friends = implode("," , $friends_list_array['data']);
    echo "</br> my friends" . $my_friends;

//result my friendsArray,Array,Array,Array,Array,Array,Array,Array..... 
```

如何在 MySQL 中存储好友列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T17:05:50.670

该`friends`连接将返回朋友的`name`并`id`封装在一个`data`数组中。因此，您需要在数组中向下走一步并在之前收集 id `implode`：

```
$friends_list = file_get_contents('https://graph.facebook.com/me/friends?access_token=' . $atoken );
$friends_list_array  = json_decode($friends_list,true);
$arr= $friends_list_array['data'];
$friend_ids_arr = array();
foreach($arr as $friend) {
    $friend_ids_arr[] = $friend['id'];
}
$friend_ids = implode("," , $friend_ids_arr);
echo $friend_ids; // output: id1,id2,id3...etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:15:39.093

从 a 开始，`var_dump($friends_list_array)`这样您就可以看到您实际使用的是什么。然后编写一个循环，获取您想要的相关数据并将其插入数据库。

类似于以下内容：

```
get the data
decode the data
create an empty array "arr"
foreach data as row
    do something with row, output should be something like
    "(123, 'John Smith', .....)"
    add this value to "arr"
implode "arr" with ","
add the start of the query ("insert into... ...values")
run the query. 
```

但是，这可能最好避免。人们的朋友一直在变化，除非他们同意，否则他们可能不希望您存储他们的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:25:20.213

试试下面的。我没有测试过下面的。

```
$sql_string = "insert into friends_table(friend_id,friend_name) values";
$insertValues = array();
$friends_list_array = json_decode(....)['data'];
foreach($friends_list_array as $friends){
    $insertValues[] = "({$friend['id']}, {$friend['name']})";
}
if (mysql_query($sql_string . implode(",", $insertValues) . ";")){
    //added all the data..
}else{
    //some error..
} 
```

PS：Kolink 指出的问题非常有道理。您正在做的事情可能还有其他出路。

* * *

**更新**：

如果您需要将朋友的所有 id 存储在*单个*字段中（这实际上是一个坏主意，请参见下文），那么您必须使用 JSON 序列化朋友列表数据（可能是），并将其存储为细绳。

```
$friends_list_array = json_decode(....)['data'];
$friends_id = array_map(function($friend){ return $friend['id'];},$friends_list_array);
$friends_list_json = json_encode($friends_id);
if (mysql_query("insert into friends_table(user, friends) values ('$curUserId','$friends_list_json';")){
    //added all the data..
}else{
    //some error..
} 
```

将序列化数据存储在单个字段中实际上是一个坏主意，除非您一次访问/修改整个列表。更好的选择是跨行传播数据。

# awk - AWK - 如何用 gsub 改进这个例子？

> ID：10774962
> 
> 赞同：1
> 
> 时间：2012-05-27T15:08:49.423
> 
> 标签：awk, gsub

我有一个文件：

```
one one one
one one
one one
one
one
one 
```

此命令替换了 5 次“一”、“三”

```
$ awk '{for(i=1; NF>=i; i++)if($i~/one/)a++}{if(a<=5) gsub("one", "three"); print }' file

three three three
three three
one one
one
one
one 
```

现在同样的事情，但 6 次：

```
$ awk '{for(i=1; NF>=i; i++)if($i~/one/)a++}{if(a<=6) gsub("one", "three"); print }' file

three three three
three three
one one
one
one
one 
```

如何改进上面的例子？我想要这个结果：

```
three three three
three three
three one
one
one
one 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:22:27.227

```
awk '{for (i=1; i<=NF; i++) {if ($i ~ /one/) {a++; if(a <= 6) sub("one", "three", $i)}}; print}' 
```

# java - 唯一号码生成算法

> ID：10774963
> 
> 赞同：1
> 
> 时间：2012-05-27T15:08:54.853
> 
> 标签：java, algorithm, uniqueidentifier

我需要为满足以下要求的 Java 应用程序生成唯一编号 -

1.  9位十六进制
2.  每天大约产生 600,000 个数字
3.  这些号码必须在至少 7 天内保持唯一；如果他们重复超过 7 天，这不是问题。
4.  在峰值负载期间，需要在大约 15 秒内每秒生成大约 800 个唯一号码。

不成功的解决方案 -

```
 public static String getUniqueId() {
        String uniqueTime = Long.toHexString(System.nanoTime());
        String uniqueId = uniqueTime.substring(uniqueTime.length() - 9);

        return uniqueId;
    } 
```

使用 nanoTime 生成一个 12 位的十六进制数。我截断了左边的 3 个字符。nanoTime 有助于处理峰值负载。

我认为这是不正确的，可能会导致重复。

谁能提供一个好的快速算法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:18:05.147

如果只使用一个线程来生成数字：

```
long nextId = counter % MAX_VALUE;
counter++;
return convertToHex(nextId); 
```

如果有多个线程：

```
long nextId = atomicLongCounter.getAndIncrement() % MAX_VALUE;
return convertToHex(nextId); 
```

注意：考虑到@Gumbo 的计算，它需要 313 年才能达到最大值，所以你甚至可以放弃模数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T16:22:51.093

只使用[UUID](http://en.wikipedia.org/wiki/Universally_unique_identifier#Definition)怎么样？它们在这种情况下非常有用。[可用的 Java 实现](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/UUID.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T16:29:12.180

简短的回答：加密。由于加密是可逆的，因此您可以保证输入是唯一的，而不是输出是唯一的。使用 36 位块密码（36 位 = 9 个十六进制数字）并加密数字 0、1、2、3、4...

您可以在空闲时间预先生成任意数量的数据并存储它们。

大多数常见的块密码不是 36 位（DES 是 64 位），但[Hasty Pudding Cypher](http://en.wikipedia.org/wiki/Hasty_Pudding_cipher)有一个 36 位变体，或者您可以使用像 RC4 这样的快速流密码或[eSTREAM](http://www.ecrypt.eu.org/stream/)密码之一。

ETA：流密码需要为每个数字重新输入密钥，因此对于您的目的来说可能太慢了。重新设置密钥也会影响唯一性，因为只有在使用相同的密钥时才能保证唯一性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T00:28:38.977

`AtomicLong.incrementAndGet()`应该做的伎俩。

如果您需要在 JVM 实例之间持久化它，您可能需要分配一个范围，将该范围的最大值存储在数据库或其他事务存储中，并确保在接近`AtomicLong`(加上适当的锁定以确保您不会超出该范围。

但是，如果您只需要一次运行中的唯一数字，`AtomicLong.incrementAndGet`那么它很简单并且保证在它包裹到 -1 之前是唯一的，这 1）在您的有生之年不会发生，并且 2）很容易检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-27T15:58:00.913

- 并发数生成的另一种可能性

您最多可以有 10 个单独的线程/进程/机器生成保证不会发生冲突的数字。

只需使用顺序计数器生成一个整数

```
start one of them at 0, use increments of 10
start the next at 1, increments of 10
start the next at 2, increments of 10 
```

即使上述其中之一最终承担了全部负载，它也可以持续 7 天而不会溢出 9 位数字，因为在 9 位数字还不够之前，您的序列中有大约 1 亿个，而您每天只能产生 1 百万个。

这里的好处是线程/进程/机器没有[共享](http://en.wikipedia.org/wiki/Shared_nothing_architecture)。

顺便说一句-您可以直接以 16 为基数执行此操作-只需使用 16 的增量而不是 10。或以 5 为基数，以 5 为增量等...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-27T16:49:05.663

部分出于娱乐目的，请允许我还从您提供的规范中提出另一种可能性。您还可以找到一种伪随机数生成算法，该算法从已知种子开始，在实践中不会为您每周需要生成的数字数量产生重复。

例如，以下基于[XORShift 生成器](http://javamex.com/tutorials/random_numbers/xorshift.shtml)，将生成 600000*7 个无重复的随机 9 位数字：

```
 long seed = 1;
        for (long i = 1; i <= 600000*7; i++) {
            long x = seed++;
            for (int n = 0; n < 3; n++) {
                x ^= (x << 21);
                x ^= (x >>> 35);
                x ^= (x << 4);
            }
          x &= 0xfffffffffL;

          // "x" is now the next unique, random-looking number in the sequence
        } 
```

这种方法的优点是除了计数器之外不需要存储来确定到目前为止已经生成了哪些数字。

缺点是每周都以完全相同的顺序重新开始。当然，如果您突然需要增加分配号码的数量，您可能需要找到另一个序列。

无论如何，我想我会把它混在一起，以防万一它有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-27T16:17:33.600

如果您不需要数字“看起来随机”，那么您可以按照其他人的建议使用计数器。

我猜您正在寻找复杂事物的原因是因为您希望数字“看起来很随机”。在这种情况下，您可以执行以下操作：

*   使用 SecureRandom 的实例来分配您的号码
*   在内存中保留映射到其分配时间的“当前分配”数字的映射（我认为存储在 ConcurrentHashMap 中的这些数据的 600K 数字将是几十兆字节的数据，所以今天没什么大不了的标准）
*   每次您需要分配一个新数字时，只需通过您的 SecureRandom 实例生成 9 个随机十六进制数字（要求它用 5 个随机字节填充数组，然后丢弃 4 个位将为您提供 9 个十六进制数字的随机数据）
*   检查您的新号码是否已经在分配号码的地图中。如果是这样，只需循环并生成一个新数字，直到您获得一个唯一的数字 - 实际上，对于您提到的数量，这只会发生每周 100 次左右，因此尽管您确实需要考虑，但不会对性能产生影响为了它;
*   定期扫描您的分配号码地图并清除已分配超过 7 天的号码，以便它们可以重新使用。

对于现实生活中的应用程序，您还需要考虑持久性：每次分配一个数字时，您都需要将其持久化到数据库中，然后再将其返回给客户端，以便在服务器崩溃时可以恢复状态. 同样，您的清除操作将在从内存映射中删除之前从数据库中删除分配。

# ios - iOS UIButton、setEnabled 和 button.hidden 不起作用

> ID：10774970
> 
> 赞同：0
> 
> 时间：2012-05-27T15:10:29.813
> 
> 标签：ios, events, uibutton, ibaction, iboutlet

我已经尝试了我在 SO 上找到的所有答案，所以要么我有不同的问题，要么我的大脑发热。

无论如何，我在故事板上有一个 UIButton，它链接到一个名为 _cameraButtonPress 的 IBAction（UIButton 称为 _cameraButton）。当按钮被按下时，我想暂时禁用按钮，所以我立即调用 [sender setEnabled:NO]; 这很好用。但是，在保存图像的不同功能中，成功保存时我使用 [_cameraButton.setEnabled:YES]; 这不起作用。

如果我在 IBAction 调用的函数中将 sender 替换为 _cameraButton，这也不起作用。我有与 IBOutlet 链接的 UIButton。

我可以发布代码，但现在这是一个相当大的项目，以下是相关位：

在标题...

```
IBOutlet UIButton *_cameraButton; 
```

IBA行动...

```
- (IBAction) _cameraButtonPress:(id)sender {

[sender setEnabled:NO];  //stops button responding to touch events 
```

进一步在不同的功能中：

```
} else {
    NSLog(@"colour image saved successfully");
    [_cameraButton setEnabled:YES];

} 
```

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-27T15:17:02.203

您确定您已将 _cameraButton 与 连接`UIButton`吗？尝试记录 _cameraButton 以查看它是否包含对有效对象的引用。

```
NSLog(@"%@", _cameraButton); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:22:00.620

保罗的回答是最合乎逻辑的问题。

顺便说一句，下划线约定用于区分 ivars 和属性。因此，您将拥有类似（对于 ARC）的属性：

```
@property (nonatomic, weak) IBOutlet UIButton *cameraButton; 
```

而且，如果您需要 ivar，您的`@synthesize`声明可能是：

```
@synthesize cameraButton = _cameraButton; 
```

这可能与按钮的相关性不如其他属性，但良好的做法建议与声明的属性关联的 ivars 使用下划线，而不是属性本身。

请参阅*Apple 的 Cocoa 编码指南*中的[命名属性和数据类型。](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CodingGuidelines/Articles/NamingIvarsAndTypes.html)

# c# - 从字符串中获取值

> ID：10774971
> 
> 赞同：-2
> 
> 时间：2012-05-27T15:10:32.137
> 
> 标签：c#, regex, string

我收到这样的字符串：

```
"????log L 05/27/2012 - 08:02:57: \"Acid<1><STEAM_ID_PENDING><CT>\" say \"password somepass\"\n\0" 
```

我怎样才能`somepass`从这个字符串中得到？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-27T15:21:35.860

您想要的比赛在第 1 组

```
\"password (.*?)\\"\\n\\0" 
```

在 C# 中，这变成

```
string resultString = null;

Regex regexObj = new Regex(@"""password (.*?)\\""\\n\\0""");

resultString = regexObj.Match(subjectString).Groups[1].Value; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T15:19:23.163

```
string test = "????log L 05/27/2012 - 08:02:57: \"Acid<1><STEAM_ID_PENDING><CT>\" say \"password somepass\"\n\0";
string[] array = test.Split('\"'); ;
Console.WriteLine(array[3].Split(' ').Last());  //somepass 
```

或者：

```
string password = string.Empty;

for (int i = 0; i < test.Length - 8; i++)
     if (test.Substring(i, 8) == "password")
          for (int j = i + 8; test[j] != '\"'; j++)
               if (test[j] != ' ')
                   password += test[j];

Console.WriteLine(password); //somepass 
```

我对 给出的答案很感兴趣`buckley`，所以我使用这三种方法进行了基准测试`"somepass"`，使用以下代码：

```
string test = "????log L 05/27/2012 - 08:02:57: \"Acid<1><STEAM_ID_PENDING><CT>\" say \"password somepass\"\n\0";

Stopwatch timer = new Stopwatch();
timer.Start();

for (int n = 0; n < 10000000; n++)
{
     string[] array = test.Split('\"');
     string password = array[3].Split(' ').Last(); //somepass
}

timer.Stop();
TimeSpan time = timer.Elapsed;
Console.WriteLine(String.Format("{0:00}:{1:00}:{2:00}", time.Minutes, time.Seconds, time.Milliseconds / 10));

timer.Reset();
timer.Start();

for (int n = 0; n < 10000000; n++)
{
    string password = string.Empty;
    for (int i = 0; i < test.Length - 8; i++)
         if (test.Substring(i, 8) == "password")
             for (int j = i + 8; test[j] != '\"'; j++)
                 if (test[j] != ' ')
                      password += test[j]; 
} //somepass

timer.Stop();
time = timer.Elapsed;
Console.WriteLine(String.Format("{0:00}:{1:00}:{2:00}", time.Minutes, time.Seconds, time.Milliseconds / 10));

timer.Reset();
timer.Start();

for (int n = 0; n < 10000000; n++)
{
    string resultString = null;
    Regex regexObj = new Regex(@"""password (.*?)\\""\\n\\0""");
    resultString = regexObj.Match(test).Groups[1].Value; //somepass
}

timer.Stop();
time = timer.Elapsed;
Console.WriteLine(String.Format("{0:00}:{1:00}:{2:00}", time.Minutes, time.Seconds, time.Milliseconds / 10)); 
```

结果是*（快照）*：

![在此处输入图像描述](../Images/a29365723033a137f05517ca017b6e6c.png)

我可以得出结论，在这种情况下使用`Split()`方法（是**1475%**）比使用方法快。`Regex`

# ruby-on-rails-3 - Rails wrap_parameters vs include_root_in_json，有什么区别？

> ID：10774972
> 
> 赞同：26
> 
> 时间：2012-05-27T15:10:43.983
> 
> 标签：ruby-on-rails-3

在一个新的 Rails 3.2 应用程序中，您可以在 config/initializers/wrap_parameters.rb 中找到以下行：

```
ActiveSupport.on_load(:action_controller) do
  wrap_parameters format: [:json]
end

# Disable root element in JSON by default.
ActiveSupport.on_load(:active_record) do
  self.include_root_in_json = false
end 
```

我对第二个代码块的理解是，如果将对象转换为 json，它将不包含根节点（即 users => {:name => 'John'}，而只是 {:name => '约翰'}

那么第一个 wrap_parameters 块做什么呢？它作用于 action_controller .. 为什么？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-05-27T16:38:34.813

`include_root_in_json`是包装在 Rails 中实例化的 json

`wrap_parameters`是包装从请求中收到的json。

如果您已`wrap_parameters`启用，并且您通过 POST 命令将以下 json 发送到 Rails：

`{name: 'John Smith'}`

Rails 会自动将*接收*到的 JSON 包装成：

`{"person": {name: 'John Smith'}}`

`include_root_in_json`另一方面，是 Rails从对象**生成**`to_json`的 json 是否通过命令包装。

* * *

例如`Person.to_json`。如果`include_root_in_json`启用，您将获得：

`{"person": {name: 'James Brown'}}`

否则，你只会得到

`{name: 'John Smith'}`

# asp.net - 带有 asp.net 的 Flash 模板

> ID：10774973
> 
> 赞同：0
> 
> 时间：2012-05-27T15:11:00.700
> 
> 标签：asp.net, flash, templates

我有一个客户购买了一个 Flash 模板 (http://www.templatemonster.com/flash-templates/21220.html)，我应该使用它并使用 asp.net 创建一个网站。

如何在我的网站中使用此模板。

谢谢，卡维塔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T10:19:56.570

您必须将 swf 文件放在文件夹中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:58:14.550

您必须在您的 aspx 页面中嵌入 flash 模板 (SWF)，例如：

```
<object width="400" height="400"
    classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"
    codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0">
    <param name="SRC" value="your_template.swf">
    <embed src="your_template.swf" width="400" height="400"></embed>
</object> 
```

[在这里查看更多示例如何在您的页面中添加 Flash](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_flashobject)

然后您可以[阅读该网站中的帮助以了解热使用它](http://www.templatemonster.com/help/?s=use%20flash%20template)

# android - android:paddingTop 仅在创建视图时与 listview 项的焦点重叠

> ID：10774974
> 
> 赞同：0
> 
> 时间：2012-05-27T15:11:15.633
> 
> 标签：android, focus, scrollbar, listviewitem

一周以来我一直在处理这个问题，并在谷歌上搜索了很多，但没有找到解决方案。问题来了。

在 android 3.0(HoneyComb) 中为带有列表视图和适配器的屏幕开发代码。它是一个 ListView，行是使用自定义适配器设置的。该项目的矩形焦点也是自定义的。许多其他屏幕使用相同的布局和列表视图。listitems 使用的布局是相对布局和 android:padding =17px （所有边都有填充）。并且列表项超过 8 个，因此它正在滚动。

现在，可能是当为此屏幕创建视图时，第一个列表项上的焦点与列表视图的顶部填充重叠。When the next item is selected ie, selection(1) and moved back to 0th position, the view is recreated and everything is normal. 如果没有顶部填充，则列表项的焦点在顶部被剪切。

我尝试过类似scrollby（0，-17）的东西。如果我这样做，则会跳过最后一个列表项的选择。就像将列表视图拖到顶部一样。

有人可以为我提供解决方案或至少一些想法吗？

明天我可以给你代码和截图。

# entity-framework - 当我尝试删除数据库中不存在的寄存器时出现异常

> ID：10774975
> 
> 赞同：2
> 
> 时间：2012-05-27T15:11:18.227
> 
> 标签：entity-framework, concurrency

我正在使用并发和实体框架 4.0 进行一些测试。我正在使用两个用户执行以下操作：

用户 1 加载寄存器。
用户 2 加载寄存器。
用户2删除一个寄存器。
用户 1 尝试删除已被客户端 2 删除的同一个寄存器。

我使用的代码如下：

```
using(Context myContext = new Context))
{
Users myUser = new Users { IDUser = paramUser.IDUser };
myContext.Users.Attach(myUser);
myContext.Users.DeleteObject(myUser);
miContext.SaveChanges();
} 
```

当用户 1 尝试删除寄存器时，得到以下异常：“存储更新、插入或删除语句影响了意外的行数 (0)。实体可能已被修改或删除，因为实体被加载。刷新 ObjectStateManager 条目” .

我知道这是一个并发问题，但我认为 EF 的默认行为是始终应用​​更改。如果我设置并发控制，则比较我抓取的数据和更新之间是否有变化。但在这种情况下，我的实体的所有属性都具有“无”的并发模式，而不是“固定”。

面对这种情况最好的方法是什么？我的意思是很多时候我不想控制并发，只应用最后一次修改。例如，我有一个包含用户的表，一个字段是电话号码。我总是想设置我要更新的电话，而与其他用户是否在我的请求和我的更新之间修改寄存器无关。如果其他用户更改数据，我会用我的更新覆盖它。

在这种情况下，我没有看到问题，我试图删除数据库中不存在的寄存器，这是我想要的，寄存器不在数据库中。如果我尝试修改已被其他用户修改的信息，但在删除操作中，我可以理解更新中的问题......

# php - 使用 Kohana 请求时如何设置 CURL 选项

> ID：10774976
> 
> 赞同：3
> 
> 时间：2012-05-27T15:11:42.920
> 
> 标签：php, curl, kohana, kohana-3.2

尝试使用 Request 类获取外部资源，但不知道如何设置更多默认 curl 选项。

我得到这样的数据：

```
$data = Request::factory($url)->execute()->body(); 
```

我认为添加 CURL 选项很简单，只需将副本复制`system/config/curl.php`到我的应用程序配置文件夹中，然后在那里设置选项（我假设它们将被合并？）。

但是这些选项似乎根本没有使用？`var_dump`在应该设置所有选项之后尝试执行`Kohana_Request_Client_Curl`，但我只能在该方法中找到直接设置的选项，这是有道理的，因为我似乎无法在任何地方找到这些选项实际上是从配置文件中获取的...

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-28T06:34:32.880

这是更详细的示例：

```
$request = Request::factory($some_url);

$request->client()->options(array(
    CURLOPT_SSL_VERIFYPEER => FALSE
)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T15:25:49.943

Request_Curl 类不查看该配置文件。您必须`->options()`手动使用来设置 curl 参数。

# iphone - 无法摆脱继承的委托方法警告

> ID：10774980
> 
> 赞同：1
> 
> 时间：2012-05-27T15:12:31.653
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我有一个类`ParentViewController`实现了一个`UITapGestureRecognizer`目标方法被调用`tap`。我正在尝试在子类中覆盖此方法，`ChildViewController`如下所示：

```
- (void) tap:(UITapGestureRecognizer *)sender
{
    [super tap:sender];
} 
```

它工作正常，但我收到警告：

```
'ChildViewController' may not respond to 'tap:' 
```

过去，当我重写委托方法时，我真的没有遇到过这样的麻烦。我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:16:20.127

确保`-(void) tap:(UITapGestureRecognizer *)sender`在 ParentViewController.h 中定义

# .htaccess - mod_rewrite 中的内部重定向

> ID：10774981
> 
> 赞同：1
> 
> 时间：2012-05-27T15:12:32.243
> 
> 标签：.htaccess, mod-rewrite

我有一个在 webhotel 上运行的小型 webapp。我想将不同的版本放在不同的文件夹中。例如：

```
html/v1/index.php
html/v2/index.php 
```

如何以用户永远看不到版本文件夹的方式提供页面。例如，他们只会看到 domain.com/index.php

我尝试了 .htaccess mod_rewrite 但它似乎也改变了浏览器 URL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T16:04:15.357

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !(.*)html/v1(.*)
RewriteRule (.*) html/v1/$1 [NC,L] 
```

这会将所有内容重定向到 v1 文件夹而不更改 URL

# android - 如何在应用程序首次运行时仅显示一次视图？

> ID：10774982
> 
> 赞同：1
> 
> 时间：2012-05-27T15:12:40.063
> 
> 标签：android

我想开发一个应用程序，在安装后一次显示身份验证屏幕，然后在后续运行时显示其他屏幕。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T15:18:11.170

用于`SharedPreference`存储一个`firstboot`值，并根据该值签入活动。如果设置了该值，则应用程序之前已启动。否则，您将显示活动并`firstrun`在`SharedPreference`.

例如，您启动的活动可能看起来像这样，

```
public void onCreate(){
    boolean firstboot = getSharedPreference("BOOT_PREF", MODE_PRIVATE).getBoolean("firstboot", true);

    if (firstboot){
        // 1) Launch the authentication activity

        // 2) Then save the state
        getSharedPreference("BOOT_PREF", MODE_PRIVATE)
            .edit()
            .putBoolean("firstboot", false)
            .commit();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:18:02.963

您可以使用[共享首选项](http://developer.android.com/guide/topics/data/data-storage.html#pref)来执行此操作。`boolean`像 as 这样的变量`isFirstTime`可以看到你的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T15:18:26.707

使用`SharedPreference`你可以做那个 boolean flagmosque ；

```
public static void saveflagmosque(){
        SharedPreferences.Editor editor = sharedPref.edit();
        editor.putBoolean("mosque", false);
        editor.commit();
    }
    public boolean getflagmosque(){
        flagmosque = sharedPref.getBoolean("mosque", true);
        return flagmosque;
    } 
```

在代码中

```
flagmosque = true ;
if(getflagmosque()){
your task that run only one time ;
} 
```

# python - Django传输上传的文件

> ID：10774984
> 
> 赞同：1
> 
> 时间：2012-05-27T15:12:46.930
> 
> 标签：python, django

我正在尝试通过 django 表单上传文件，然后将其发送到 API。

这是编码功能：

```
#FYI, requestFile = request.FILES['file']
def EncodeFile(self, requestFile, fields = []):

    BOUNDARY    = '----------boundary------'
    CRLF        = '\r\n'
    body        = []
    # Add the metadata about the upload first

    for param in fields:
        body.extend(
          ['--' + BOUNDARY,
           'Content-Disposition: form-data; name="%s"' % param,
           '',
           fields[param],
           ])

    fileContent = requestFile.read()

    body.extend(
      ['--' + BOUNDARY,
       'Content-Disposition: form-data; name="file"; filename="%s"'
       % requestFile.name,
       # The upload server determines the mime-type, no need to set it.
       'Content-Type: ' + requestFile.content_type,
       '',
       fileContent,
       ])

    # Finalize the form body
    body.extend(['--' + BOUNDARY + '--', ''])
    result =  'multipart/form-data; boundary=%s' % BOUNDARY, CRLF.join(body)
    return result 
```

问题是当它到达“CRLF.join(body)”时，它抱怨“'utf8'编解码器无法解码位置 0 的字节 0xff：无效的起始字节”。

完全相同的一段代码可以在命令行中完美运行，但 requestFile 实际上是文件的路径，而我在读取内容之前正在执行 open(requestFile, 'rb') 。

我无法为我的生活弄清楚下一步该做什么。在过去的 10 个小时左右，我一直在谷歌上寻找答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T08:43:34.437

显然这行代码会导致问题：

```
'Content-Disposition: form-data; name="file"; filename="%s"' % requestFile.name, 
```

正确的行应该是：

```
'Content-Disposition: form-data; name="file"; filename="%s"' % smart_str(requestFile.name), 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T21:47:31.393

您正在尝试将数据解码为字符串，但在 join 函数上失败。如果 django 使用严格模式尝试解码数据，则会抛出错误。`ignore`模式只会跳过这些字节，这可以解释为什么它似乎可以从控制台工作）。

因此，您不希望将响应对象转换为 unicode 字符串。您应该尝试调试尝试转换它的函数并尝试阻止它。join() 函数不应尝试将其转换为 unicode。

要找到问题，您可以像这样简化它以帮助找到根本原因。这在 python shell 中对我有用（但在你的情况下它应该会导致同样的错误）：

```
body = ["1", "\xff"]
result = 'multipart/form-data; boundary=%s' % BOUNDARY, CRLF.join(body) 
```

# opengl - 当前最好的 OpenVG 实现？

> ID：10774987
> 
> 赞同：0
> 
> 时间：2012-05-27T15:13:11.857
> 
> 标签：opengl, openvg

> **可能重复：**
> [最好的 OpenVG 实现？](https://stackoverflow.com/questions/401422/best-openvg-implementation)

我知道这是一个副本： [OpenVG implementation？](https://stackoverflow.com/questions/401422/best-openvg-implementation) 但该页面已 2 年未更新。

基本上，我正在寻找一个在 OpenGL 之上运行的相当快速的 OpenVG 实现。有谁知道一些最近和维护的实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T18:53:11.253

也许这不是最好的答案......但你可以看看： http: [//developer.nvidia.com/nv-path-rendering](http://developer.nvidia.com/nv-path-rendering) - 来自 NVidia 的 GPU 路径渲染

# ruby - Twitter 登录无法正常工作

> ID：10774991
> 
> 赞同：2
> 
> 时间：2012-05-27T15:13:39.890
> 
> 标签：ruby, ruby-on-rails-3, authentication, twitter

我在通过 Twitter 登录我正在开发的应用程序时遇到了一个大问题（我正在 localhost 上进行测试）。对于通过 Twitter 登录，我使用名为**omniauth-twitter 的**gem 。

我实施了所有必要的事情，并且身份验证“有效”。“Works”用引号引起来，因为从 10 次尝试中我得到：

*   2x 我成功认证
*   5x 我得到了错误`(twitter) Authentication failure! timeout: Timeout::Error, execution expired`
*   3x 页面关闭

我对这种身份验证行为感到绝望，因为这是不可用的......

为什么身份验证经常失败？有没有更省钱、更可靠的方法，如何通过 Twitter 进行身份验证？

**编辑：从日志中获取一点点：**

```
(twitter) Request phase initiated.
(twitter) Callback phase initiated. 
```

第一行是在终端窗口打印出来的，当一个人点击 LOGIN VIA TWITTER 链接时，第二行是检测到回调地址（设置在 上`http://127.0.0.1:3001`）。如果发生错误，则：

```
(twitter) Request phase initiated.
(twitter) Callback phase initiated.
(twitter) Authentication failure! timeout: Timeout::Error, execution expired 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T16:48:00.253

在没有看到任何代码的情况下，我认为最好创建一个全新的应用程序，它只使用omniauth-twitter，看看你是否可以在一个孤立的简单应用程序中重现问题。这将有助于排除它是您更大应用程序的不同部分。

# emacs - emacs中windows之间的高效切换

> ID：10774995
> 
> 赞同：11
> 
> 时间：2012-05-27T15:14:15.237
> 
> 标签：emacs, keyboard-shortcuts

> **可能重复：**
> [如何更轻松地在 Emacs 中的缓冲区之间切换？](https://stackoverflow.com/questions/7394289/how-can-i-more-easily-switch-between-buffers-in-emacs)

在使用 emacs 时，我倾向于保留许多打开的窗口。不幸的是，使用`M-x other-window`非常烦人。到目前为止，我已经在我的 .emacs 文件中设置了键盘快捷键：`(global-set-key (quote [backtab]) (quote other-window))`. 这让事情变得更容易了，但我正在寻找命令的等价物`next-buffer`并且`previus-buffer`可以应用于 Windows。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-27T15:38:20.483

将以下内容添加到您的 .emacs

```
(windmove-default-keybindings)
(setq windmove-wrap-around t) 
```

然后，您将能够在带有`Shift+{left,up,down,right}`箭头的窗口之间切换。Shift 修饰符是 的一个参数`windmove-default-keybindings`，因此您可以选择另一个。

您可能想要激活一个`winner-mode`. `winner-undo`这是一种次要模式，它会记住您的窗口配置，您可以使用或转到上一个/下一个配置`winner-redo`。

# javascript - 从以前的帖子中获取当天报价的脚本？

> ID：10774998
> 
> 赞同：0
> 
> 时间：2012-05-27T15:14:37.550
> 
> 标签：javascript, html, tumblr, getelementsbytagname

在过去的 4 个小时里，我一直在尝试为我的 tumblr 博客上的“每日行情”显示编写脚本。我是 javascript 的初学者。那么你能帮我处理一下javascript并告诉我我需要改变什么才能让它工作吗？另外，我将如何将脚本生成的文本格式化为看起来像？：

```
<script type="text/javascript">
    var now = new Date();
    var todayAtMidn = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    var quoteTag = getElementsByTagName("div")
    for (var i = 3; i < quoteTag.length; i++)`
    var quoteDate = document.getElementsByTagName("div");
    for (var i = 3; i < quoteDate.length; i++) {
        if ((quoteDate[i].getAttribute("class") == "date") && (quoteTag[i].getAttribute("class") == "tag")) {
            if ((todayAtMidn.getTime() == quoteDate.getTime()) && (quoteTag == 'QOT')) {
                document.write("Quote Of the Day:{Quote}")
            } else {
                document.write('Thank God, its a new day!');
            }
        } else {
            document.write('Thank God, its a new day!')
        }
    }
</script> 
```

我试图做的是，从我的一个正常报价帖子中获取内容/文本，前提是报价帖子具有标签“QOT”并且发布在当前日期（所以今天）。然后文本/内容将在网站的特殊部分显示为“当日报价”。

这是我的网站：teamnigeria.tumblr.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T16:53:22.163

好吧，让我们从：

1.  最初

    ```
    (function () {

    var post=null; 
    ```

2.  循环当前页面上的帖子：

    ```
    var posts=getPosts();
    var midnight_today=getMidnight();

    for(var i=0, l=posts.length; i<l; i++) { 
    ```

3.  `QOT`当我们找到今天发布的第一个带有标签的帖子时停止

    ```
     var post_time = getPostTime(post[i]);
       if (postHasTag(posts[i], 'QOT') && post_time > midnight_today) {
           post = posts[i];
           break;
       }

    } 
    ```

4.  如果我们没有找到帖子：将报价设置为“今天没有选择报价”

    ```
    if (post === null) { 
        setQuote("No quote picked for today");
    } else { 
    ```

5.  否则：将引用设置为我们找到的帖子的文本

    ```
     setQuote(getQuoteFromPost(post));
    }

    })(); 
    ```

如果定义了所有未定义的函数，这将满足您的要求。

* * *

由于 tumblr 页面上的所有帖子都有这个类`post`，而引用帖子有这个类`quote`，所以给定 jQuery：

```
(function () {
  var quotes = $("div.post.quote");
  if (quotes.length > 0) {
    $('div#header > h8').empty().append(
      quotes.first().find("div.content > blockquote").clone()
    );
  }
})(); 
```

用页面上的第一个报价替换每日报价，如果没有，则`div#header > h8`保留的内容作为占位符内容。如果这也将检查日期，则需要解析`div.post.quote > div.date`并比较日期的内容。

# c++ - 即使从类中抛出异常，C++ 程序能否正常运行？

> ID：10774999
> 
> 赞同：1
> 
> 时间：2012-05-27T15:14:42.510
> 
> 标签：c++, class, exception, exception-handling, constructor

这是一个面试问题，面试已经完成。

给定一个A类，其中有B类和C类的成员。如果C类的构造函数发生异常，但程序仍然可以正常运行，原因是什么？

我的答案：

类 C 的构造函数不是由 A 实现的。或者，A 没有一些指令来对类 C 执行一些操作。

C 类没有任何实例化。

异常不是错误。异常处理函数处理得很好。

有更好的主意吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T15:17:48.110

如果一个实例`C`是 class 的可选成员`A`，则具有指向`C`实例的空值指针是可以的。那么，假设正确的异常处理就没有问题了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T15:17:54.190

要成功构造 的对象`A`，您需要成功构造其成员（在本例中为类型`B`和`C`）。如果程序正常工作，这意味着它可以从创建`A`对象的失败中恢复。

程序必须已经捕获了从`A`的构造函数抛出的异常，并以某种方式处理错误情况。

例如，您可以将一组不同的参数传递给`A`的构造函数（这反过来又将不同的参数传递给它的`C`成员 ctor，它现在不会抛出），例如基于替代配置值。

或者有一个替代路径来解决不涉及创建类型对象的原始问题`A`（例如，这个替代路径的计算成本可能更高，这可能是它不是首选的原因）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-27T15:20:27.317

我认为它指的是这种语法：

```
 A::A() try : B(...),C(...) 
 {
    //A constructor body
 }
 catch(...) {} 
```

**编辑**没关系，在 catch 块中未明确重新抛出的每个异常都会自动重新抛出

看到[这个](http://www.gotw.ca/gotw/066.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T15:17:43.243

如果设计为这样，程序可以继续工作，但类型 A 的对象的构造必须失败，因为如果对象的任何基或成员未能初始化，则不可能完全构造对象。

如果期望不会从初始化器列表中逃脱，则类可以通过拥有指针持有对象，并且可以在没有持有对象的情况下构造它。例如

```
struct C {
    C();
};

struct A {
    A();
    std::unique_ptr<C> c;
};

A::A() {
    try {
        c.reset(new C);
    }
    catch (...){
        // oops. Can't re-throw, could log
    }
} 
```