# StackOverflow 问答 000485000-000485999

# .net - 从 C# 客户端调用远程 COM+ ServicedComponent

> ID：485000
> 
> 赞同：6
> 
> 时间：2009-01-27T20:06:17.080
> 
> 标签：.net, com+

我在 COM+ 服务器应用程序中安装了一个服务组件。我想从远程客户端创建一个实例。客户端需要能够动态指定服务器机器的名称。我该怎么做呢？

我尝试使用激活器：

```
 (XSLTransComponent.XSLTransformer)Activator.GetObject(
                        typeof(XSLTransComponent.XSLTransformer),
                        serverName
                        ); 
```

但我明白了：

System.Runtime.Remoting.RemotingException：无法创建通道接收器以连接到 URL“服务器”。可能尚未注册适当的频道。在 System.Runtime.Remoting.RemotingServices.Unmarshal（类型 classToProxy，字符串 url，对象数据）

我需要注册频道吗？如果是这样，怎么做？

另一个想法是使用 Marshall.BindToMoniker，但是如何为服务器 x 上的 COM+ 上托管的远程对象指定一个名字对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T20:57:50.813

尤里卡！这有效：

```
string serverName = serverTextBox.Text;
Type remote = Type.GetTypeFromProgID("XSLTransComponent.XSLTransformer", serverName);
return (XSLTransComponent.XSLTransformer)Activator.CreateInstance(remote); 
```

感谢[这个问题](http://social.msdn.microsoft.com/forums/en-US/netfxremoting/thread/6bf76216-f46d-4f04-89c5-6db450a529ac/)

# asp.net - 将现有表格样式应用于 Gridview

> ID：485007
> 
> 赞同：1
> 
> 时间：2009-01-27T20:07:58.217
> 
> 标签：asp.net, vb.net, gridview, code-reuse, datagridtablestyle

我正在开发我们现有 winforms 项目的网络版本。Gridviews 似乎是我们一直在使用的数据网格的充分替代品。我们为旧数据网格编写了广泛的表格样式。是否可以重用此代码以将样式应用于网格视图？

如果需要重写，那么设置网格视图样式的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-01T15:42:38.463

使用主题和皮肤文件是您所需要的。

检查此链接： http: [//msdn.microsoft.com/en-us/library/ykzx33wh (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ykzx33wh(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T10:14:05.147

我认为没有一种简单的方法可以将样式从数据网格移植到网格视图。

您可以考虑使用[CSS 友好控制适配器](http://www.codeplex.com/cssfriendly)作为应用样式的机制：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T15:11:53.953

您可以通过 CopyFrom() 方法将样式从数据网格复制到网格视图。

要将标题样式从数据网格复制到网格视图：

```
GridView1.HeaderStyle.CopyFrom(DataGrid1.HeaderStyle); 
```

页脚样式：

```
GridView1.FooterStyle.CopyFrom(DataGrid1.FooterStyle); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T03:46:20.667

GridView 控件具有多个 TableItemStyle 类型的属性（FooterStyle、HeaderStyle、RowStyle 等）。

这些 TableItemStyle 属性包含一个名为 CopyFrom 的方法，该方法需要 System.Web.UI.WebControls.Style。您将无法使用此方法为您的 WinForms DataGrid 复制样式。

您*最快*的路径可能是重写和使用 GridView 的 FooterStyle、HeaderStyle、RowStyle 等属性。

# java - 在 Java Web 应用程序中防止 SQL 注入攻击和 XSS 的方法

> ID：485023
> 
> 赞同：12
> 
> 时间：2009-01-27T20:12:16.850
> 
> 标签：java, regex, xss, sql-injection

我正在编写一个 java 类，该类将由 servlet 过滤器调用，并检查基于 Struts 的 java web 应用程序的注入攻击尝试和 XSS。InjectionAttackChecker 类使用 regex 和 java.util.regex.Pattern 类根据 regex 中指定的模式验证输入。

话虽如此，我有以下问题：

1.  应该阻止所有特殊字符和字符模式（例如 <>、*.*、--、<=、==、>=）以防止注入攻击。
2.  是否有任何现有的正则表达式模式可以按原样使用？
3.  在某些特定情况下，我必须允许一些特殊字符模式，一些示例值（被允许）是（使用 'pipe' | 字符作为不同值的分隔符）*Atlanta | #654，大厦 8 #501 | 单纯疱疹：慢性溃疡（持续时间>1 个月）或支气管炎、肺炎或食管炎 | FUNC & COMP(date_cmp), "NDI & MALKP & HARS_IN(icd10, yes)"。我应该采用什么策略才能防止注入攻击和 XSS，但仍然允许这些字符模式。

我希望我已经清楚地提到了这个问题。但如果我没有，我会道歉，因为这只是我的第二个问题。如果需要任何澄清，请告诉我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T20:19:02.500

根据您的问题，我假设您正在尝试过滤错误值。我个人觉得这种方法很快就会变得非常复杂，因此建议将编码值作为替代方法。这是一篇关于该主题的 IBM 文章，其中列出了这两种方法的优缺点，[http://www.ibm.com/developerworks/tivoli/library/s-csscript/](http://www.ibm.com/developerworks/tivoli/library/s-csscript/)。

为了避免 SQL 注入攻击，只需使用准备好的语句而不是创建 SQL 字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T20:42:58.567

如果您尝试清理输入中的所有数据，您将遇到非常困难的时期。有很多涉及字符编码的技巧，可以让人们绕过你的过滤器。这个[令人印象深刻的清单](http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/)只是可以作为 SQL 注入完成的无数事情中的一部分。您还必须防止 HTML 注入、JS 注入和其他可能的注入。唯一可靠的方法是对应用程序中使用的数据进行编码。对您写入网站的所有输出进行编码，对所有 SQL 参数进行编码。对后者要特别小心，因为正常编码不适用于非字符串 SQL 参数，如该链接中所述。使用参数化查询是完全安全的。另请注意，理论上您可以在用户输入数据时对其进行编码并将其编码存储在数据库中，但这仅在您始终以使用该类型编码的方式（即 HTML编码，如果它只会与 HTML 一起使用；如果它在 SQL 中使用，你' 不会受到保护）。这就是为什么经验法则是永远不要将编码数据存储在数据库中并始终在使用时进行编码的部分原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T20:24:36.717

验证和绑定所有数据是必须的。执行客户端和服务器端验证，因为 10% 的人在他们的浏览器中关闭了 JavaScript。

Jeff Atwood 有一个关于该主题的[不错的博客](https://blog.codinghorror.com/preventing-csrf-and-xsrf-attacks/)，让您了解它的复杂性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T17:47:56.570

不要过滤或阻止值。

1.  您应该确保在组合文本位时进行正确的类型转换 :) 即：如果您有一个 HTML 类型的字符串和一个 TEXT 类型的字符串，您应该将 TEXT 转换为 HTML，而不是盲目地连接它们。在[haskell](http://blog.moertel.com/articles/2006/10/18/a-type-based-solution-to-the-strings-problem)中，您可以使用类型系统方便地执行此操作。

好的 html 模板语言默认会转义。如果您正在生成 XML/HTML，那么有时使用 DOM 工具比使用模板语言更好。如果您使用 DOM 工具，那么它可以消除很多此类问题。不幸的是，与模板相比，DOM 工具通常是垃圾:)

2.  如果您从用户那里获取 HTML 类型的字符串，您应该使用库对其进行清理，以删除所有不好的标签/属性。那里有很多好的白名单 html 过滤器。
3.  您应该始终使用参数化查询。总是！如果您必须动态构建查询，则使用参数动态构建它们。永远不要将非 SQL 类型的字符串与 SQL 类型的字符串结合起来。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T20:24:17.903

[这是一篇](http://www.securityfocus.com/infocus/1768)关于这个主题的相当广泛的文章。

不过，我认为你不会在这里获得圣杯。我还建议尝试以某些标准方式对接收到的文本进行编码/解码（uuencode，base64）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T17:31:33.850

看看[AntiSamy 项目 [www.owasp.org]](http://www.owasp.org/index.php/Category:OWASP_AntiSamy_Project)。我认为这正是您想要的；您可以设置过滤器来阻止某些标签。他们还提供策略模板，slashdot 策略将是一个好的开始，然后添加您需要的标签。

此外，www.osasp.org 网站上还有很多关于保护您的应用程序的知识。

用户 'nemo' 所说的关于使用准备好的语句和编码的内容也应该被执行。

# .net - 使用依赖注入框架还是自己编写？

> ID：485024
> 
> 赞同：2
> 
> 时间：2009-01-27T20:12:19.970
> 
> 标签：.net, dependency-injection

当开始一个新的应用程序时，您宁愿只使用现有的依赖框架并冒可能出现的缺点，还是选择编写自己的完全适应的框架，为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-27T20:16:33.910

IMO，我们的工作是解决客户的问题，而不是编写依赖注入（或日志记录，或 ORM 等）框架。我认为，当存在合适的框架时，您应该始终使用该框架。

除此之外，如果该框架是开源的，那么没有理由不使用它，因为您可以修复任何可能的缺点。

我认为我们经常失去目标的位置。作为程序员，我们倾向于专注于有趣的问题（例如编写依赖注入框架）并拖延无聊的问题（为客户端编写另一个 CRUD 应用程序。）：D

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T20:16:34.097

我认为现在的 DI 框架非常可靠（至少对于 .Net 而言）......为什么要花那么多时间[重新发明轮子](http://blog.ashmind.com/index.php/2008/08/19/comparing-net-di-ioc-frameworks-part-1/)？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T20:24:27.450

最初，做一个 DI 框架似乎不是一项大任务，但如果你看看 Castle 和 Spring.NET 等框架提供了哪些框架，我可以想出更好的方式来消磨时间。除非您需要真正特别的东西，否则我会采用其中一种可用的框架并利用其他人的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T20:23:19.153

我当然会使用其中一种可用的解决方案。虽然一开始很简单，但在全功能 DI 框架中，有一些功能（如各种代理功能）绝对不简单。也许你也想要一些 AOP？

但是任何体面的 DI 框架都应该对您编写实际代码的方式影响不大，因此可以争辩说它对您的代码没有那么重要。

不过，这对支付费用的人来说可能很重要。在您的情况下，我将获得一个带有可用源代码的 DI 框架，并了解*该*源代码而不是编写您自己的源代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T22:38:51.860

DI 框架一直在发展，它们也增加了功能，例如使您的代码更易于测试。随着项目的发展，编写自己的代码会更容易出错并且可能会更复杂。

如果您需要 DI，我会说使用它们并选择一个具有良好支持的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T22:20:04.690

选项 3：不要使用依赖注入（暂时）。

你刚刚开始一个新项目。你真的需要一个 DI 框架吗？

开始开发项目，您可能会开始看到一些有问题的依赖项。一旦它们开始出现，您就可以评估现有的 DI 框架并决定哪些是合适的。

谁知道呢，你可能会发现你根本不需要 DI 框架。

甚至马丁福​​勒也说：

> 控制反转是框架的一个共同特征，但它是有代价的。当您尝试调试时，它往往难以理解并导致问题。所以总的来说，除非我需要它，否则我宁愿避免它。这并不是说这是一件坏事，只是我认为它需要证明自己比更直接的选择更合理。

[http://martinfowler.com/articles/injection.html](http://martinfowler.com/articles/injection.html)

如果我是你，我会避免使用任何依赖注入，直到你绝对不能没有它。

请记住，在大多数情况下，[YAGNI](http://en.wikipedia.org/wiki/YAGNI)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T06:41:58.297

您可以围绕依赖注入位编写一个包装器，因此如果您想稍后切换 DI 框架，则无需担心库依赖关系或在任何地方更改代码。比如不直接调用container.Resolve，写一个工厂类，为你调用container.Resolve，只调用到工厂类。

# asp.net - 对象数据源和缓存

> ID：485027
> 
> 赞同：1
> 
> 时间：2009-01-27T20:12:52.217
> 
> 标签：asp.net, caching

我有一个数据集，其中包含大约 500 条记录，每条记录有 7 列。我想使用 objectdatasource 和缓存。我确信数据不会改变。但是会有很多用户访问数据。我的问题是缓存具有 500 条记录的数据是否是个好主意。它是最优的吗？我认为 objectdatasource 缓存每个用户的数据。所以我想知道如果我缓存数据，这种大小的数据是否会出现性能问题。

谢谢，斯里达尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T04:25:25.327

答案实际上取决于记录的大小，而不仅仅是它们的数量。无论如何，ASP.NET 的缓存算法使用最近最少使用 (LRU) 算法来驱逐最近未使用的项目，以便为其他项目腾出空间。因此，除非您的站点非常繁忙或您的结果集非常大，否则您应该可以缓存结果集并让 ASP.NET 的缓存处理将最常用的数据保留在缓存中和使最少使用的数据过期的细节。

如果页面上没有其他内容是用户特定的，您也可以考虑使用页面级输出缓存，因为这可能会为您提供稍微更高的性能，而额外的内存使用量最少。其他要调查的领域是控件、SqlDependencies，当然，如果数据是只读的，请确保在用于显示数据的任何控件上禁用 ViewState。

# asp.net - 在 ASP.NET 表单中提供“审查”阶段的简洁方式

> ID：485035
> 
> 赞同：2
> 
> 时间：2009-01-27T20:15:27.467
> 
> 标签：asp.net, webforms, input

我目前正在研究一个相当复杂的数据输入表单，它基于 ASP.NET Web 表单。表单完成后，我们希望用户有机会在实际提交表单之前查看他们的输入（如果需要，还可以返回对他们的数据进行更改）。

由于字段数量众多，我想使用 FormView 控件，因为它具有自动数据绑定能力，删除了很多繁琐的代码，但是似乎没有一种简单的方法来提供此功能。

目前，我当前的方法使用 ObjectDataSource 来绑定所有表单字段。我在数据源上创建了两种操作“模式”；一种模式将对象临时保存到用户会话（允许稍后再次检索只读/编辑模式 - 这有助于查看/修改功能），而第二种模式实际上执行数据库插入。

虽然这在这一点上看起来相当强大，但对我来说仍然感觉很脏。我知道我可以使用向导/多视图类型的方法，但是你会失去自动数据绑定的细节（我相信？）。我确信这是一个相当普遍的问题，那么这通常如何在 Web 窗体环境中完成呢？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T20:38:57.013

我目前正在处理的项目使用自定义向导设置（不是 asp.net 2.0 向导）。它包含您的向导可能需要的几个步骤，当您从一个步骤转到下一步时，代码会将值保存到最后一步（只读审查）。当用户到达最后一步时，他们可以返回到需要更新的步骤。高兴时，用户提交向导，并将数据保存到数据库中。它基本上是一系列可以切换其可见性的面板。

您应该仍然可以为每个可编辑字段使用 ObjectDataSource，面板或多视图是否可见不应该影响绑定。当您从一个面板转到下一个面板时，您可以更新只读步骤（如我之前所说），同时保持可编辑控件绑定到 ObjectDataSource。当您返回任何需要修改的步骤时，您仍然受到约束，因此当您进行任何更改并单击提交或任何按钮时，它应该使用 ObjectDataSource。

还有其他人有其他想法吗？

# asp.net - ASP.NET lock() 不起作用

> ID：485036
> 
> 赞同：1
> 
> 时间：2009-01-27T20:15:27.577
> 
> 标签：asp.net, caching, locking

我尝试锁定静态字符串对象以访问缓存，lock() 块在我的本地执行，但每当我将它部署到服务器时，它就会永远锁定。我将每一步都写入事件日志以查看进程，而锁定（对象）只会导致服务器上的死锁。lock() 之后的命令永远不会执行，因为我在事件日志中看不到条目。下面是代码：

```
public static string CacheSyncObject = "CacheSync";
public static DataView GetUsers()
{

    DataTable dtUsers = null;
    if (HttpContext.Current.Cache["dtUsers"] != null)
    {
        Global.eventLogger.Write(String.Format("GetUsers() cache hit: {0}",dtUsers.Rows.Count));
        return (HttpContext.Current.Cache["dtUsers"] as DataTable).Copy().DefaultView;
    }

    Global.eventLogger.Write("GetUsers() cache miss");
    lock (CacheSyncObject)
    {
        Global.eventLogger.Write("GetUsers() locked SyncObject");

        if (HttpContext.Current.Cache["dtUsers"] != null)
        {
            Global.eventLogger.Write("GetUsers() opps, another thread filled the cache, release lock");
            return (HttpContext.Current.Cache["dtUsers"] as DataTable).Copy().DefaultView;
        } 
```

Global.eventLogger.Write("GetUsers() 锁定 SyncObject"); ==> 这永远不会写入日志，所以这对我来说意味着 lock() 永远不会执行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T20:35:06.647

您正在锁定一个字符串，由于实习，这在 .NET 中通常是一个坏主意。.NET 运行时实际上只存储所有相同的文字字符串一次，因此您几乎无法控制谁可以看到特定字符串。

我不确定 ASP.NET 运行时是如何处理这个问题的，但是常规的 .NET 运行时实际上对整个进程使用了​​实习，这意味着即使在不同的 AppDomain 之间也可以共享实习字符串。因此，您可能会在方法的不同实例之间陷入僵局。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T20:28:26.037

如果你使用会发生什么：

```
public static object CacheSyncObject = new object(); 
```

# sql - MySQL 插入查询不适用于 WHERE 子句

> ID：485039
> 
> 赞同：138
> 
> 时间：2009-01-27T20:16:11.523
> 
> 标签：sql, mysql

这个查询有什么问题：

```
INSERT INTO Users( weight, desiredWeight ) VALUES ( 160, 145 ) WHERE id = 1; 
```

它在没有该`WHERE`子句的情况下有效。我似乎忘记了我的 SQL。

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2009-01-27T20:21:30.153

MySQL [INSERT 语法](http://dev.mysql.com/doc/refman/5.5/en/insert.html)不支持 WHERE 子句，因此您的查询将失败。假设您的`id`列是唯一的或主键：

如果您尝试插入 ID 为 1 的新行，您应该使用：

```
INSERT INTO Users(id, weight, desiredWeight) VALUES(1, 160, 145); 
```

如果您尝试更改 ID 为 1 的现有行的权重/desiredWeight 值，您应该使用：

```
UPDATE Users SET weight = 160, desiredWeight = 145 WHERE id = 1; 
```

如果您愿意，还可以使用 INSERT .. ON DUPLICATE KEY 语法，如下所示：

```
INSERT INTO Users (id, weight, desiredWeight) VALUES(1, 160, 145) ON DUPLICATE KEY UPDATE weight=160, desiredWeight=145 
```

或者甚至像这样：

```
INSERT INTO Users SET id=1, weight=160, desiredWeight=145 ON DUPLICATE KEY UPDATE weight=160, desiredWeight=145 
```

同样重要的是要注意，如果您的`id`列是自动增量列，那么您最好将其从 INSERT 中全部省略，并让 mysql 正常增加它。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-01-27T20:21:00.607

您不能将 WHERE 子句与 VALUES 子句结合使用。据我所知，您有两种选择-

1.  插入指定值

    ```
    INSERT INTO Users(weight, desiredWeight) 
    VALUES (160,145) 
    ```

2.  使用 SELECT 语句插入

    ```
    INSERT INTO Users(weight, desiredWeight) 
    SELECT weight, desiredWeight 
    FROM AnotherTable 
    WHERE id = 1 
    ```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-01-27T20:18:43.310

您将 WHERE 子句用于 UPDATE 查询。当您插入时，您假设该行不存在。

OP的声明将变为；

> 更新用户 SET weight = 160，desiredWeight = 45 其中 id = 1；

~~在 MySQL 中，如果要进行 INSERT 或 UPDATE，可以使用带有 WHERE 子句的 REPLACE 查询。如果 WHERE 不存在，则插入，否则更新。~~

**编辑**

我认为 Bill Karwin 的观点非常重要，可以从评论中提取出来并使其非常明显。谢谢比尔，我已经很久没有使用 MySQL 了，我记得我在使用 REPLACE 时遇到了问题，但我忘记了它们是什么。我应该查一下。

*这不是 MySQL 的 REPLACE 的工作方式。它执行 DELETE（如果该行不存在，则可能是空操作），然后是 INSERT。想想后果。触发器和外键依赖项。相反，使用 INSERT...ON DUPLICATE KEY UPDATE。*

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-27T20:17:11.130

我不相信插入有 WHERE 子句。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-08-06T17:17:45.973

# 插入查询不支持 where 关键字*

条件适用，因为您可以将 where 条件用于子选择语句。您可以使用子选择执行复杂的插入。

例如：

```
INSERT INTO suppliers
(supplier_id, supplier_name)
SELECT account_no, name
FROM customers
WHERE city = 'Newark'; 
```

通过在插入语句中放置“选择”，您可以快速执行多次插入。

使用这种类型的插入，您可能希望检查插入的行数。您可以通过在执行插入之前运行以下 SQL 语句来确定将要插入的行数。

```
SELECT count(*)
FROM customers
WHERE city = 'Newark'; 
```

您可以使用 EXISTS 条件确保不插入重复信息。

例如，如果您有一个名为 clients 的表，其主键为 client_id，则可以使用以下语句：

```
INSERT INTO clients
(client_id, client_name, client_type)
SELECT supplier_id, supplier_name, 'advertising'
FROM suppliers
WHERE not exists (select * from clients
where clients.client_id = suppliers.supplier_id); 
```

此语句使用子选择插入多条记录。

如果要插入单个记录，可以使用以下语句：

```
INSERT INTO clients
(client_id, client_name, client_type)
SELECT 10345, 'IBM', 'advertising'
FROM dual
WHERE not exists (select * from clients
where clients.client_id = 10345); 
```

使用双表允许您在选择语句中输入值，即使这些值当前未存储在表中。

另请参阅[如何使用 where 子句插入](https://stackoverflow.com/questions/545593/how-to-insert-with-where-clause)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-07-06T10:38:48.737

这个问题的正确答案是这样的：

一种）。如果想在插入之前选择：

```
INSERT INTO Users( weight, desiredWeight ) 
  select val1 , val2  from tableXShoulatNotBeUsers
  WHERE somecondition; 
```

乙）。IF 记录已存在使用更新而不是插入：

```
 INSERT INTO Users( weight, desiredWeight ) VALUES ( 160, 145 ) WHERE id = 1; 
```

应该

```
Update Users set weight=160, desiredWeight=145  WHERE id = 1; 
```

C）。如果要同时更新或插入

```
Replace Users set weight=160, desiredWeight=145  WHERE id = 1;

Note):- you should provide values to all fields else missed field in query 
        will be set to null 
```

d)。如果你想从同一张表中克隆一条记录，请记住你不能从你要插入的表中选择

```
 create temporary table xtable ( weight int(11), desiredWeight int(11) ;

 insert into xtable (weight, desiredWeight) 
    select weight, desiredWeight from Users where [condition]

 insert into Users (weight, desiredWeight) 
    select weight , desiredWeight from xtable; 
```

我认为这很好地涵盖了大多数场景

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-08-09T12:43:49.787

在执行 INSERT 语句时，您根本不能使用 WHERE：

```
 INSERT INTO Users( weight, desiredWeight ) VALUES ( 160, 145 ) WHERE id = 1; 
```

应该：

```
 INSERT INTO Users( weight, desiredWeight ) VALUES ( 160, 145 ); 
```

WHERE 部分仅适用于 SELECT 语句：

```
SELECT from Users WHERE id = 1; 
```

或在 UPDATE 语句中：

```
UPDATE Users set (weight = 160, desiredWeight = 145) WHERE id = 1; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-02-21T08:35:36.913

一种使用 INSERT 和 WHERE 的方法是

`INSERT INTO MYTABLE SELECT 953,'Hello',43 WHERE 0 in (SELECT count(*) FROM MYTABLE WHERE myID=953);` 在这种情况下，就像一个存在测试。如果你运行它两次或更多次也不例外......

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-10-01T01:06:33.687

我认为在指定行上插入值的正确形式是：

```
UPDATE table SET column = value WHERE columnid = 1 
```

它可以工作，如果您在 Microsoft SQL Server 上编写，则类似

```
INSERT INTO table(column) VALUES (130) WHERE id = 1; 
```

在 mysql 上，您必须更新表。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-27T20:20:41.200

插入 = 向表中添加行

Upate = 更新特定行。

where 子句将在您的插入中描述什么？它没有任何东西可以匹配，该行不存在（还）......

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-11-21T09:19:08.120

您可以根据用户输入进行有条件的 INSERT。仅当输入变量 '$userWeight' 和 '$userDesiredWeight' 不为空时，此查询才会插入

```
INSERT INTO Users(weight, desiredWeight )
select '$userWeight', '$userDesiredWeight'  
FROM (select 1 a ) dummy
WHERE '$userWeight' != '' AND '$userDesiredWeight'!=''; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-01-15T20:23:19.163

这取决于 INSERT 实际上可以有 where 子句的情况。

例如，如果您要匹配表单中的值。

```
Consider INSERT INTO Users(name,email,weight, desiredWeight) VALUES (fred,bb@yy.com,160,145) WHERE name != fred AND email != bb@yy.com 
```

有道理不是吗？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-12-06T22:42:26.420

最简单的方法是使用 IF 违反您的键约束。这仅适用于 INSERT IGNORE，但允许您在 INSERT 中使用约束。

```
INSERT INTO Test (id, name) VALUES (IF(1!=0,NULL,1),'Test'); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-14T06:51:03.293

After`WHERE`子句放置一个条件，它用于获取数据或更新行。插入数据时，假定该行不存在。

那么，问题是，是否有任何 id 为 1 的行？如果是这样，请使用[MySQL UPDATE](http://w3resource.com/mysql/update-table/update-table.php)，否则使用[MySQL INSERT](http://w3resource.com/mysql/inserting-updating-deleting/MySQL-insert-into-statement.php)。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-08-06T06:32:21.563

如果您要指定特定的记录号来插入数据，则最好使用`UPDATE`语句而不是`INSERT`语句。

您在问题中编写的这种类型的查询就像一个虚拟查询。

您的查询是：-

```
INSERT INTO Users( weight, desiredWeight ) VALUES ( 160, 145 ) WHERE id = 1; 
```

这里指定id=1，所以最好使用`UPDATE`statement来更新已有记录。不建议`WHERE`在的情况下使用子句`INSERT`。应该使用`UPDATE`。

现在使用更新查询：-

```
UPDATE Users SET weight=160,desiredWeight=145 WHERE id=1; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-08-07T19:37:25.467

> 在任何情况下，WHERE 子句是否可以实际与 INSERT-INTO-VALUES 一起使用？

答案肯定是否定的。

在 INSERT INTO ... VALUES ... 之后添加 WHERE 子句只是无效的 SQL，不会解析。

MySQL返回的错误是：

```
mysql> INSERT INTO Users( weight, desiredWeight ) VALUES ( 160, 145 ) WHERE id = 1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'WHERE id = 1' at line 1 
```

错误消息中最重要的部分是

```
... syntax to use near 'WHERE id = 1' ... 
```

它显示了解析器不希望在这里找到的特定部分：WHERE 子句。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-08-10T10:39:01.663

它完全错误。INSERT QUERY 没有 WHERE 子句，只有 UPDATE QUERY 有它。如果你想在 id = 1 的地方添加数据，那么你的查询将是

```
UPDATE Users SET weight=160, desiredWeight= 145 WHERE id = 1; 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-08-11T05:14:17.833

不，据我所知，您不能将 WHERE 子句添加到此查询中。也许我也忘记了我的 SQL，因为我不确定你为什么需要它。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-08-11T06:01:28.993

您不应该在插入语句中使用 where 条件。如果您想这样做，请在更新语句中使用插入，然后更新现有记录。

实际上我可以知道为什么您需要在 Insert 语句中使用 where 子句吗？

也许基于我可能会建议你一个更好的选择的原因。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-08-11T08:03:16.353

我认为你最好的选择是使用 REPLACE 而不是 INSERT

> 替换成用户（id、weight、desiredWeight）值（1、160、145）；

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-08-11T08:48:09.927

## **也请阅读此内容**

这没有意义……甚至从字面上看

`INSERT`意味着添加一个`new row`，当你说`WHERE`你定义你在谈论哪一行时`SQL`。

因此，在现有行的条件下无法添加新行。

您必须从以下选项中进行选择：

A. 使用`UPDATE`代替`INSERT`

B. 使用`INSERT`和删除`WHERE`子句（我只是说......）或者如果你真的必须使用`INSERT`并且`WHERE`在单个语句中它只能通过[INSERT..SELECT 子句](http://dev.mysql.com/doc/refman/5.1/en/insert-select.html)来完成......

```
INSERT INTO Users( weight, desiredWeight ) 
SELECT FROM Users WHERE id = 1; 
```

但这用于完全不同的目的，如果您将 id 定义为主键，则此插入将失败，否则将插入 id = 1 的新行。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-04-21T15:19:16.990

我知道这是一篇旧帖子，但我希望这仍然会对某人有所帮助，我希望这是一个简单的例子：

背景：

我有很多情况：同一个用户多次列出多个值，我想创建一个新记录，因此 UPDATE 在我的情况下没有意义，我需要像我一样处理特定用户使用 WHERE 子句。

```
INSERT into MyTable(aUser,aCar)
value(User123,Mini) 
```

通过使用这个结构，你实际上定位了一个特定的用户（user123，他有其他记录），所以我认为你真的不需要 where 子句。

输出可能是：

```
aUser   aCar
user123 mini
user123 HisOtherCarThatWasThereBefore 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-04-27T16:43:07.903

使用 post 方法的 mysql insert into 语句的正确语法是：

```
$sql="insert into ttable(username,password) values('$_POST[username]','$_POST[password]')"; 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-08-04T12:00:33.347

我不认为我们可以在插入语句中使用 where 子句

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-05-05T21:20:27.277

```
INSERT INTO Users(weight, desiredWeight )
SELECT '$userWeight', '$userDesiredWeight'  
FROM (select 1 a ) dummy
WHERE '$userWeight' != '' AND '$userDesiredWeight'!=''; 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-09-05T06:00:52.840

您不能同时使用 INSERT 和 WHERE。您可以使用 UPDATE 子句为特定字段中的特定列添加值，如下面的代码；

```
UPDATE Users
SET weight='160',desiredWeight ='145'  
WHERE id =1 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-05-30T04:11:42.423

您可以使用以下代码执行此操作：

```
INSERT INTO table2 (column1, column2, column3, ...)
SELECT column1, column2, column3, ...
FROM table1
WHERE condition 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-02-04T02:26:39.690

我认为你应该这样做，如果你想验证表不使用电子邮件两次

代码 ：

```
INSERT INTO tablename(fullname,email) 

SELECT * FROM (SELECT 'fullnameValue' AS fullname_field,'emailValue' AS email_field) entry WHERE entry.email_field NOT IN (SELECT email FROM tablename); 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2022-01-27T20:45:08.973

以上所有答案都为您提供了简单的 MySQL 语句。

如果您在 PHPMyAdmin 中使用 where 条件来更新表的现有行，以下是使用的建议。

```
UPDATE `Table_Name` SET `row1`='[value-1]',`row2`='[value-2]',`row3`='[value-3]' WHERE 1 
```

您可以在每行的 '' 之间包含任何值。不一定要放[]来表示值。在 where 之后不要更改任何内容。只需在给出要更新的值后单击 go。

例子：

```
UPDATE `Mytable_name` SET `abc`='xyz',`def`='uvw'
 WHERE 1 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2022-03-05T16:59:06.930

如果您希望通过提及其主键将一些值插入到每行中已更改表的新列中，那么只需-->

1.  `UPDATE <table_name> SET <column_name> = '<value> WHERE <primary_key> = <primary_value>`

# flash - 如何停止以 Flash 形式复制/粘贴

> ID：485072
> 
> 赞同：0
> 
> 时间：2009-01-27T20:23:53.097
> 
> 标签：flash, actionscript, copy-paste

我在一家医疗转录公司工作，我们对申请人进行的医疗转录测试是一个较旧的 Flash 表单应用程序，当您输入表单时，它会通过清空剪贴板来停止复制和粘贴。这在 IE 7 中效果很好，但最近我注意到它在 Firefox 中效果不佳。或者它可能是 flash 的版本，因为 flash 应该是独立于浏览器的。我绝不是一个 Flash 开发者，事实上我在这方面很糟糕。所以我需要知道的是如何使用动作脚本停止复制和粘贴。

根据评论，显然需要一些额外的信息。测试实际上是播放一个语音文件（基本 MP3），他们必须将其转录为收听。当他们的转录员伙伴已经参加了测试并将其通过电子邮件发送给他们的朋友以便他们可以跳过时，就会出现复制和粘贴问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T20:29:17.190

我假设由于这是一个转录测试，因此您将一些源文档与您希望用户根据所述源文档填写的表单并排显示。与其清空剪贴板，阻止他们复制源文档不是更容易吗？如果源文档也在您的 Flash 对象的控制之下，将其设置为只读和不可选择应该很简单。这具有允许他们在表单字段之间复制的额外好处，因为这可能是他们在转录期间的正常使用，并允许他们更快地进行测试。

请注意，像这样的解决方案永远不会阻止一个有决心并有一点时间的人——如果你试图做任何事情而不是阻止他们在这个测试中作弊，那么你就进入了 DRM 领域，这既非常困难又非常徒劳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T20:38:06.907

最近，Flash 更新使访问剪贴板变得更加困难。作为一般经验法则，如果不是由用户发起，程序化剪贴板访问通常会失败。因此，如果将剪贴板清除代码放在按钮调用中，则它更有可能工作。这确实对您没有帮助，但它确实告诉您出了什么问题，以及为什么您尝试修复的问题无法修复。我建议利用 rmeador 的建议。

如果这不切实际，请截取文本并使用图形作为文本。固执的人仍然可以通过一些努力进行复制和粘贴，但这是一种相当简单的方法，可以阻止它在不使用 Flash 表单的情况下随意完成。

在内部闪存，您可能需要查看粘贴事件处理程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T21:32:20.213

您可能无法像这样“禁用粘贴”（如果您自己不以某种方式托管 Flash 控件，例如，在 Windows 应用程序或某种浏览器扩展中），但您当然可以对方式做出很好的猜测有人正在使用基于计时器的数学应用程序。这是一个 Flex 应用程序的（超级）粗略示例，说明了我的意思：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" xmlns:local="*" creationComplete="this_creationComplete(event)">

    <mx:Script>
        <![CDATA[

            private var timer:Timer;
            import flash.events.Event;

            private function this_creationComplete(event:Event):void
            {
                timer = new Timer(1000);
                timer.addEventListener(TimerEvent.TIMER, timer_tick);
                timer.start();
            }

            private function timer_tick(event:TimerEvent):void  
            {
                var elapsedTimeInMinutes:Number = timer.currentCount / 60;
                var averageWordLength:Number = 4;
                var humanlyPossible:Number = 200;

                var thisPersonsSpeed:Number = (txtTest.text.length / averageWordLength) / elapsedTimeInMinutes;

                if (thisPersonsSpeed > humanlyPossible)
                {
                    txtSpeed.text = "Wait, " + Math.floor(thisPersonsSpeed).toString() +  " words per minute?  This clown is probably cheating.";
                    txtTest.enabled = false;
                    timer.stop();
                }
                else
                {
                    txtSpeed.text = "Currently typing " + Math.floor(thisPersonsSpeed).toString() + " wpm.  Hurry up!  Faster!";
                }
            }

        ]]>
    </mx:Script>    

    <mx:VBox>
        <mx:TextArea id="txtTest" width="600" height="300" />
        <mx:Text id="txtSpeed" />
    </mx:VBox>

</mx:Application> 
```

本质上，它只是一个计算每分钟字数的计时器；如果该数字超过某个阈值，则计时器停止，并且表单禁用。

当然，它不是铁板钉钉的，如果我自己实现它，我会加入一些额外的面向时间的保护措施（例如，在不活动期间停止计时器等），但它应该说明这一点。我敢肯定还有其他解决方案，但是像这样简单的事情可能对您来说已经足够了。

* * *

更新：有几个人提到了 Event.PASTE，它可以工作，但在 ActionScript 2 / Flash Player 9 中不存在。如果您能够确保 Flash Player 10 并且可以在 ActionScript 3 中编写脚本，那就另当别论了选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T21:43:22.360

您不能注册一个事件句柄来捕获文本字段上的过去事件吗？

```
function onPasteMessage(event:Event){ ... }

...

myTextField.addEventListener(Event.PASTE, onPasteMessage) 
```

onPasteMessage 可以是对用户的简单警告，即不允许过去，也可以是撤消粘贴操作的操作，具体取决于触发事件的时间以及修改文本字段的时间/方式。如果您在此级别捕获事件，则可能会阻止默认 eventHandler 将文本从剪贴板复制到文本字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T11:09:48.310

在早期版本的 flash 中没有 event.paste 的情况下，您可能会设置类似 onKeyUp 侦听器的东西，该侦听器检查是否在按下控制/命令键的情况下按下 V 键。我想它会像这样：

```
var listening_object = new Object();
Key.addListener(listening_object);
listening_object.onKeyUp(){
  if ( Key.getCode() == whatevercodeforVis && Key.isDown(Key.CONTROL)){
    freakout();
  }
} 
```

fractout() 做了一些事情，比如清除文本字段或弹出一个警告对话框。右键单击粘贴无济于事，但您可能可以禁用上下文菜单 - 您可以在大部分 Flash 中使用，但我不确定它是否适用于文本字段。

准备一些在运行时随机分配的*略有*不同的读数以找出可能倾向于作弊的人是否完全超出了范围？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-24T23:54:32.320

```
 package {  
     import flash.desktop.Clipboard;  
     import flash.desktop.ClipboardFormats;  
     import flash.display.MovieClip;  
     import flash.display.Sprite;  
     import flash.events.Event;  
     import flash.ui.ContextMenu;    
     public class PasteExample extends MovieClip {  

         public function PasteExample():void {  
             //make a movie
             var pasteTarget:Sprite = addChild(new Sprite()) as Sprite;  
             pasteTarget.graphics.beginFill(0);  
             pasteTarget.graphics.drawRect(0, 0, 100, 100); 
             pasteTarget.endFill();

             var contextMenu:ContextMenu = new ContextMenu();  
             contextMenu.clipboardMenu = true;
             contextMenu.clipboardItems.paste = true;  
             pasteTarget.contextMenu = contextMenu;  

             pasteTarget.addEventListener(Event.PASTE,pasteHandler)  
         }  

         private function pasteHandler(e:Event):void {  
             var clipboadStr:String =  Clipboard.generalClipboard.getData(ClipboardFormats.TEXT_FORMAT) as String;  
             trace(clipboadStr)  
         }     
     } 
```

# python - 有没有人有使用 scipy.stats.distributions 的示例代码？

> ID：485076
> 
> 赞同：10
> 
> 时间：2009-01-27T20:24:27.747
> 
> 标签：python, scipy

我正在努力弄清楚如何使用 scipy.distributions 包，并想知道是否有人可以为我发布一些示例代码。它似乎可以满足我的所有需求，我只是不知道如何使用它。

我需要生成两种分布，一种是对数正态分布，一种是泊松分布。我知道每个的方差和 lambda。

资源链接也可以。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-27T21:00:25.880

我假设您的意思是`scipy.stats`. 要创建分布，请生成随机变量并计算 pdf：

Python 2.5.1 (r251:54863, Feb 4 2008, 21:48:13) [GCC 4.0.1 (Apple Inc. build 5465)] on darwin 键入“帮助”、“版权”、“信用”或“许可证”了解更多信息。

```
>>> from scipy.stats import poisson, lognorm
>>> myShape = 5;myMu=10
>>> ln = lognorm(myShape)
>>> p = poisson(myMu)
>>> ln.rvs((10,)) #generate 10 RVs from ln
array([  2.09164812e+00,   3.29062874e-01,   1.22453941e-03,
         3.80101527e+02,   7.67464002e-02,   2.53530952e+01,
         1.41850880e+03,   8.36347923e+03,   8.69209870e+03,
         1.64317413e-01])
>>> p.rvs((10,)) #generate 10 RVs from p
array([ 8,  9,  7, 12,  6, 13, 11, 11, 10,  8])
>>> ln.pdf(3) #lognorm PDF at x=3
array(0.02596183475208955) 
```

其他方法（以及`scipy.stats`文档的其余部分）可以在新的[SciPy 文档](http://docs.scipy.org/doc/scipy/reference/stats.html)站点上找到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-25T15:20:48.310

这是一些示例代码：[SciPy 中的概率分布](http://www.johndcook.com/blog/2009/07/20/probability-distributions-scipy/)

# .net - Entity Framework AddTo 功能不一致？

> ID：485080
> 
> 赞同：0
> 
> 时间：2009-01-27T20:26:20.783
> 
> 标签：.net, entity-framework

让我描述一下我得到的行为：

*   从数据库加载用户：这意味着用户附加到上下文
*   创建一个新的对象 C：
    *   C tempC = 新 C();
    *   tempC.User = 先前加载的用户；
    *   Context.AddToCSet( tempC );
    *   最后一行引发异常，因为在设置属性 user 时将对象添加到上下文中。

但如果我执行以下操作：

*   从数据库加载用户：这意味着用户附加到上下文
*   创建一个新的对象 C：
    *   C tempC = 新 C();
    *   tempC.User = 先前加载的用户；
    *   Context.SaveChange();
*   创建一个与对象 C 有关系的新对象 E。
    *   E tempE = 新 E();
    *   tempE.C = 先前创建的 C；
    *   Context.AddToESet( tempE );

它*不会*抛出异常。我期待一个例外，因为那时 C 已附加到上下文中，这应该与第一个示例相同。但事实并非如此。为什么，我能做些什么来保持一致性？

我计划在将对象添加到集合之前检查对象的状态（EntityState == Detached），但我认为我一开始肯定做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T16:40:21.723

`User`假设and之间存在一对多的关系`C`，您可能希望使用不同的语法将 a 添加`C`到父级`User`。而不是`tempC.User = previously loaded user;`您可能想要`tempC`添加`User`. 这就是我的意思：

```
C tempC = new C(); 
(previously created user).C.Add(tempC);
Context.AddToCSet(tempC); 
```

# c# - 从降价文本中获取原始文本

> ID：485083
> 
> 赞同：1
> 
> 时间：2009-01-27T20:26:46.447
> 
> 标签：c#, .net, formatting, markdown

在我的数据库中，我有一个已降价的文本。与显示问题摘录时的方式相同，我想获取文本的前 N ​​个字符，即必须删除所有格式。当然，必须避免 MD -> HTML 步骤，并且必须在 MD 编辑的文本上完成工作。性能是一种要求。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T10:06:53.257

> 在我的数据库中，我有一个已降价的文本。与显示问题摘录时的方式相同，我想获取文本的前 N ​​个字符，即必须删除所有格式。

我们将文本的两种表示形式都存储在数据库中：

1.  Raw Markdown 适合编辑
2.  适合输出的 HTML 化版本

当我们显示它时，我们使用 HTML 化的输出版本并简单地应用我们的标准 HTML 剥离算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T22:29:51.440

如果我误解（或只是理解）你需要在这里做的事情，请原谅我，但我突然想到，如果阅读量（页面浏览量）多于插入量（添加新的降价记录）到这个数据库，从性能的角度来看，您***可以***通过将所有标记剥离到数据库中的单独字段中的文本版本来获得最大的收益。这样，您的前端就不必在显示给浏览器之前反复解析从数据库中读取的内容......当添加新记录时，它只会被解析一次。

从性能的角度来看，这是否真的有意义取决于特定于您的情况的各种变量......文本条目有多大，插入记录与读取记录的频率等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T20:45:22.510

我处理这个问题的方法是为包含/表示标记的文本的类定义一个格式化程序接口。然后，您将拥有支持 HTML 格式和纯文本格式的具体实现。您需要做的就是注入正确的实现并调用格式化程序。

您的纯文本格式化程序可以简单地遍历字符串中的字符，复制字符直到遇到一些降价。然后它会跳过降价并在遇到文本时再次开始输出。

```
public interface IFormatter
{
    string Format();
}

public class HtmlFormatter: IFormatter
{
    public Format()
    {
        return ...string translated to HTML...
    }
}

public class PlainTextFormatter : IFormatter
{
    public Format()
    {
        ...go through and remove all markdown and return rest
    }
}

public class Post : IFormattable
{
    public IFormatter Formatter { get; set; }

    public Post( IFormatter formatter )
    {
        this.Formatter = formatter ?? new HtmlFormatter();
    }

    public Format()
    {
        return this.Formatter.Format();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T16:52:22.907

这是我要走的路：我将修改 Markdown 代码，以便通过一个开关，我可以生成 html 或简单的文本。摘录生成后，我一定会将其存储在数据库中。

我不会将任何答案标记为解决方案，因为有很多方法可以做到这一点。每个人都得到我的投票；）

# web-services - 我们是否绝对需要用于 SAML 的 STS？

> ID：485084
> 
> 赞同：8
> 
> 时间：2009-01-27T20:26:56.947
> 
> 标签：web-services, saml

我第一次尝试实现启用 SAML 的 SOAP 服务，我对安全令牌服务 (STS) 在 SAML 实现中的作用有一些概念性的问题。

用户 ---> Web 应用程序 ---SOAP/SAML--> 消息应用程序

基本上这个场景是用户使用他的用户名和密码登录到 Web 应用程序，Web 应用程序依次使用外部服务对用户进行身份验证和授权，在成功的身份验证/授权后，Web 应用程序创建一个 Sender Vouches SAML 断言，用户为主题，使用其私钥对断言进行签名，使用 WS-S 将断言封装在一个肥皂信封中，并对消息传递应用程序进行 SOAP 调用。一旦消息传递应用程序收到请求，它会使用 Web 应用程序的公钥验证签名，从 SAML 断言中提取身份验证和属性语句，并基于它们在端点上执行身份验证策略。

正如您在上述场景中看到的那样，没有涉及外部 STS，但是我读过的关于 SAML 的大多数文献都表明绝对需要 STS。我的问题是我在上述情况下做错了什么，因为我看不出我绝对需要 STS 的任何理由。当然，拥有 STS 会很好，但至少在我看来，没有它并不会阻止我为我的用例实施 SAML。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-28T07:07:42.487

不，您不需要 STS 用于 Web 服务中的 SAML 令牌。STS 将一个令牌（其中“令牌”包括用户名+密码之类的内容）交换为另一个令牌，因此它很有用，因为您的 Web 服务使用者可以发送一些输入令牌（通常是用户名+密码或签名+X.509 证书以方便使用案例）到 STS 并取回一个 SAML 断言，一切准备就绪。

现在，如果您有能力创建将被您的 Web 服务提供商接受的 SAML 令牌，那就去做吧！不需要 STS - 线上的实际 SOAP 消息是相同的，无论 STS 是否参与其创建。

几年前，我写了几篇博客文章，详细介绍了其中的一些内容：

[Java EE Tools/NetBeans 5.5 Enterprise Pack 中的 Access Manager 7.1 Beta](http://blog.superpat.com/2006/05/23/access-manager-7-1-beta-in-java-ee-toolsnetbeans-5-5-enterprise-pack/)

[SAML 保护的 SOAP 消息剖析](http://blog.superpat.com/2006/05/24/anatomy-of-a-saml-secured-soap-message/)

Sun Access Manager 7.1 已被[OpenAM](http://forgerock.com/products/open-identity-stack/openam/)取代，但原则保持不变。特别是，第二个条目独立于任何实际产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T21:35:31.947

您可以利用任何开源 SAML 工具包。如果您的应用程序是用 Java 编写的，并且您在 JBoss 或 Weblogic 上运行，那么 SAML 支持是内置的。

# c# - 单线程单元 vs 多线程单元

> ID：485086
> 
> 赞同：41
> 
> 时间：2009-01-27T20:27:41.420
> 
> 标签：c#, .net, multithreading, apartments

> **可能重复：**
> [您能解释一下 STA 和 MTA 吗？](https://stackoverflow.com/questions/127188/could-you-explain-sta-and-mta)

> 所有 ThreadPool 线程都在多线程单元中。

--根据 MSDN

这意味着什么？我真的很关心多线程与单线程单元模型之间的区别。或者公寓模型是什么意思？我已经阅读了关于它的 MSDN，这对我来说真的没有意义。我想我可能有一个想法，但我想这里有人可以用简单的英语解释它。

谢谢，安东尼 D

**更新 1**

找到这个 [你能解释一下 STA 和 MTA 吗？](https://stackoverflow.com/questions/127188/could-you-explain-sta-and-mta)

任何人都可以更具描述性吗？

**更新 2**

我也在寻找有关这如何应用于线程池的答案，以及因此我需要注意的事项。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-01-27T20:35:57.660

STA（单线程单元）和 MTA（多线程单元）与[COM](http://msdn.microsoft.com/en-us/library/ms690156(VS.85).aspx)有关。COM 组件可以设计为由单个线程访问，在这种情况下，它们托管在[STA](http://msdn.microsoft.com/en-us/library/ms680112.aspx)中，或者它们可以内部线程安全，并托管在[MTA](http://msdn.microsoft.com/en-us/library/ms693421(VS.85).aspx)中。一个进程只能有一个 MTA，但可以有多个 STA。如果您只打算使用 COM 组件，那么您真正需要知道的是您必须将单元与组件匹配，否则会发生令人讨厌的事情。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-28T18:26:02.087

实际上，STA 和 MTA 对 .NET 代码有影响。有关更多详细信息，请参阅 Chris Brumme 的博客条目，然后您可能需要：

[https://devblogs.microsoft.com/cbrumme/apartments-and-pumping-in-the-clr/](https://devblogs.microsoft.com/cbrumme/apartments-and-pumping-in-the-clr/)

了解 STA 如何在 .NET 中发送消息非常重要。它确实有后果。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-27T20:33:03.407

如果您的 COM 对象需要相信它处于单线程环境中，请使用 STA。您可以保证创建和所有调用都将由同一个线程进行。您可以安全地使用 Thread 本地存储，而无需使用临界区。

如果您的 COM 对象可以被多个线程同时访问，请使用 MTA——不会有任何保护措施。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-27T20:45:42.290

正如其他人所指出的，它通常对 .NET 应用程序几乎没有影响。

但是，请注意，用于单元测试的 Microsoft 测试主机实际上是在 STA 中实现的，这意味着您可以在单元测试中执行的操作存在限制。例如，如果您使用的是 Microsoft 的测试主机，则您不能在单元测试中执行 a `WaitAll`on a 。`WaitHandle`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-27T20:32:16.187

除非您正在执行 COM 互操作，否则您不必担心它，在这种情况下会出现编组问题。它对 .net 本身没有任何影响。

# python - 为什么 dir(x) 中的所有名称都不能用于属性访问？

> ID：485095
> 
> 赞同：3
> 
> 时间：2009-01-27T20:30:47.983
> 
> 标签：python, introspection, python-datamodel

`__dict__`为什么编码员会将不能用于属性访问的东西塞入其中？例如，在我的 Plone 实例中，`dir(portal)`包含`index_html`，但`portal.index_html`会引发 AttributeError。`__class__`的属性也是如此`Products.ZCatalog.Catalog.mybrains`。有充分的理由`dir()`不值得信任吗？

在模块周围戳`inspect`，我看到他们使用`object.__dict__['x']`而不是属性访问是出于这个原因并且因为他们不想触发`getattr`魔法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T22:30:02.877

我不了解Plone，所以以下是一般性的。

来自以下[文档](http://docs.python.org/library/functions.html#dir)：`dir`

> 如果对象有一个名为 的方法 `__dir__()`，该方法将被调用并且必须返回属性列表。这允许实现自定义`__getattr__()`或 `__getattribute__()`功能的对象自定义`dir()`报告其属性的方式。

只是在这里猜测，但我能想到可能发生的两件事——

*   该对象有一个`__dir__()`方法可以返回它没有的属性

*   （不太可能）该对象*具有*您要求的属性（即它在`obj.__dict__`or中`type(obj).__dict__`，但覆盖`__getattr__`返回`AttributeError`

**编辑**：`__dir__`仅在 Python 2.6+ 中受支持，但是（不推荐使用的）特殊属性`__methods__`可以`__members__`用于早期版本。

# javascript - 选择 YUI 还是 jQuery 会影响 .js 文件的整体设计吗？

> ID：485098
> 
> 赞同：3
> 
> 时间：2009-01-27T20:31:59.917
> 
> 标签：javascript, jquery, yui

在 jquery 或 YUI 之间进行选择会改变您的 .js 文件的整体/高级设计，还是由于框架 API 的差异，它实际上只会成为您的 js 函数的内部工作？（即您如何访问/遍历 DOM、选择器、内置函数、触发事件等）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T21:12:32.687

当您比较两个库的结构时：

优：

```
YAHOO.util.Dom.setStyle(['test', 'test2'], 'opacity', 0.5); 
var opacity = YAHOO.util.Dom.getStyle('test2', 'opacity'); 
```

和 jQuery：

```
$("#test, #test2").css("opacity", 0.5);
var opacity = $("#test2").css("opacity"); 
```

它们看起来很相似。

所以脚本的一般流程应该与两个库大致相同。

我看到的区别在于简单性和长度。我个人觉得 jQuery 更有意义，但如果你不介意每个细节的细微差别，我相信它们都能满足你的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T23:05:05.253

YUI 和 jQuery 在架构决策方面没有太大区别。像 Google Web Toolkit (GWT) 或 Dojo 这样的库可能会对您的架构方式产生重大影响，因为它们需要被编译。

在旁注中，我会说我更喜欢 YUI 而不是 jQuery，原因与此问题的其他答案完全相同。我发现 jQuery 的风格很迟钝，有点像 Perl。如果您还不知道语法，则不清楚其含义。虽然 YUI 有点冗长，但我发现代码很容易解析。

我的免责声明是我在雅虎工作！虽然所以我习惯于使用 YUI 很多，而且大多只在个人项目中使用 jQuery ;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-24T15:41:00.793

我会说 yui，尤其是 yui3 鼓励并使代码模块化变得容易。您拥有 yui 加载器，您可以在其中即时拉入应用程序的某些部分，并且您还拥有对合成事件的丰富支持，可以让您更多地分离应用程序的各个部分。

您不必被迫使用这些功能，但如果您这样做，它可以帮助您构建更多模块化应用程序并帮助代码重用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-13T12:30:36.930

与 YUI 相比，jQuery 更容易学习，尽管在架构上没有太大区别。

# sql-server - 如何使用 SSIS 解析 Serv-U FTP 日志？

> ID：485100
> 
> 赞同：1
> 
> 时间：2009-01-27T20:32:29.337
> 
> 标签：sql-server, ssis

不久前，我需要解析一堆 Serve-U FTP 日志文件并将它们存储在数据库中，以便人们可以报告它们。我最终开发了一个小型 C# 应用程序来执行以下操作：

1.  查找目录中尚未加载到数据库中的所有文件（有一个先前加载文件的表）。

2.  打开一个文件并将所有行加载到一个列表中。

3.  遍历该列表并使用 RegEx 来识别行的类型（CONNECT、LOGIN、DISCONNECT、UPLOAD、DOWNLOAD 等），将其解析为与行类型对应的特定类型的对象，并将该 obj 添加到另一个列表中。

4.  循环遍历每个不同的对象列表并将每个对象列表写入关联的数据库表。

5.  记录文件导入成功。

6.  洗涤，冲洗，重复。

这很丑陋，但它在我们的最后期限内完成了工作。

问题是我担任 DBA 角色，我对运行已编译的应用程序作为解决此问题的方法不满意。我更喜欢更开放和更面向 DBA 的东西。

我可以在 PowerShell 中重写它，但我更喜欢开发一个 SSIS 包。我第一次在 SSIS 中找不到基于 RegEx 拆分输入的好方法，而且我对 SSIS 还不够熟悉。我现在正在深入研究 SSIS，但仍然找不到我需要的东西。

有人对我如何在 SSIS 中进行重写有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T20:57:25.840

我必须对 Exchange 日志做类似的事情。我还没有找到一个使用全 SSIS 解决方案的更简单的解决方案。话虽如此，这就是我所做的：

首先，我使用 Microsoft 的 logparser 和 sql2005 的批量复制功能

我将日志文件复制到可以使用它们的目录中。

我创建了一个用于解析日志的 sql 文件。它看起来类似于：

```
SELECT TO_Timestamp(REPLACE_STR(STRCAT(STRCAT(date,' '), time),' GMT',''),'yyyy-M-d h:m:s') as DateTime, [client-ip], [Client-hostname], [Partner-name], [Server-hostname], [server-IP], [Recipient-Address], [Event-ID], [MSGID], [Priority], [Recipient-Report-Status], [total-bytes], [Number-Recipients], TO_Timestamp(REPLACE_STR([Origination-time], ' GMT',''),'yyyy-M-d h:m:s') as [Origination Time], Encryption, [service-Version], [Linked-MSGID], [Message-Subject], [Sender-Address] INTO '%outfile%' FROM '%infile%' WHERE [Event-ID] IN (1027;1028) 
```

然后我用 logparser 运行前面的 sql：

```
logparser.exe file:c:\exchange\info\name_of_file_goes_here.sql?infile=c:\exchange\info\logs\*.log+outfile=c:\exchange\info\logs\name_of_file_goes_here.bcp -i:W3C -o:TSV 
```

它输出一个 bcp 文件。

然后我使用以下命令将该 bcp 文件批量复制到 SQL Server 中的预制数据库表中：

```
bcp databasename.dbo.table in c:\exchange\info\logs\name_of_file_goes_here.bcp -c -t"\t" -T -F 2 -S server\instance -U userid -P password 
```

然后我对表运行查询。如果您能弄清楚如何使用 SSIS 自动执行此操作，我会很高兴听到您的所作所为。

# programming-languages - 在一个项目中使用多种语言

> ID：485102
> 
> 赞同：4
> 
> 时间：2009-01-27T20:33:22.410
> 
> 标签：programming-languages, language-design, complexity-theory

从我对语言设计的讨论来看，似乎很多人认为不存在也永远不会是“一种真正的语言”。根据这些人的说法，另一种选择是熟悉几种语言并为工作选择合适的工具。 *这在整个项目或大型子项目的级别上非常有意义，只需通过非常狭窄、定义明确的界面与项目的其余部分进行交互。*

另一方面，当试图优雅地解决许多小子问题时，使用许多不同的语言似乎是一件非常尴尬的事情。换句话说，恕我直言，在所有方面都不错的通用语言仍然很重要。作为一个简单的示例，假设您需要执行以下操作：

1.  从文件中读取一些任意格式的数据。检查它是否有错误等（最好在 Perl 之类的东西中完成）。
2.  将此数据加载到矩阵中，对其执行一堆核心矩阵操作（最好在 Matlab 之类的东西中完成）。
3.  在其上运行自定义的计算密集型例程，该例程必须快速且节省空间（最好在 C 或 C++ 中完成）。

这是一个相当简单的项目，除了编写计算密集型的自定义矩阵处理例程之外，但关于使用什么语言的唯一好答案似乎是一个通用的，在所有方面都不错。

我在这里想念什么？一个人如何有效地使用多种语言来充分利用它们的每一种优势？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T20:41:07.213

我参与过许多项目，其中包含相当多样化的语言组合。除非它是一个 .NET 项目，否则您通常会在不同的层级或不同的进程中使用这些不同的语言。也许您的 webapp 在 PHP 中，而您的应用程序服务器在 java 中。因此，您并没有在方法级别真正“混合和匹配”。

在 .NET 和一些 java vm 语言中，规则会发生一些变化，因为您可以更自由地混合使用。但是这些语言的特性主要是由类库定义的——它们很常见。因此，在 .net 中切换语言的动机通常是由其他因素驱动的，例如开发人员知道哪种语言。F# 实际上提供了很多特定于该语言的语言功能，因此在 .NET 中似乎有点例外。一些 java VM 语言还向标准 java 库添加方法，添加 java 中不可用的功能。

实际上，只要所有语言都具有良好的 IDE 支持，您就会非常习惯使用多种语言。没有那个，我真的认为我会迷路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T20:58:31.313

Lua 等嵌入式语言使这变得非常容易。Lua 是一种类似于 Ruby 或 Python 的优秀动态语言，可让您快速开发高质量的代码。它还与 C 紧密集成，这意味着您可以利用 C/C++ 库并通过用 C 或 C++ 编写它们来优化性能关键部分。

在科学计算中，有一个脚本也很常见，例如将在 Matlab 中进行一些数据处理，使用 Perl 重新格式化输出，然后将其传递到另一个用 Matlab、C 或其他语言编写的应用程序中。不过，在集成由不同人编写的应用程序时，这种情况往往比从头开始开发时更为常见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T05:48:18.487

您是说选择是 a) 用一种语言编写所有内容并降低效率，或者 b) 将一堆不同的可执行文件拼凑在一起，以便为工作的每个部分使用最好的语言。

大多数在职程序员选择选项 c：尽其所能使用其 IT 部门在生产中支持的语言。通常，程序员在特定框架（例如 JVM 或 CLR）中的语言选择有限——因此它既不是工具箱乌托邦，也不是单一语言的贫民区。

甚至 LAMP 和 Rails 也支持（实际上是需求）不同级别的不同语言——在 Rails 的情况下，HTML、Javascript、Ruby、C。如果您正在编写软件服务（这是当今最有趣的工作发生的地方），那么您几乎不会只用一种语言编写。但你的选择也不是无限的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T20:59:11.373

考虑你的任务中最困难的部分。解析文件是最复杂的部分吗？阅读文件然后操作它们的好语言可能是最相关的选择。

数学转换是最困难的部分吗？您可能想吸收它并使用 matlab，用脚本或其他自制工具输入它。

性能是最重要的部分吗？与转换和解析相比，将进行多少计算？如果完成的工作的 90% 将在计算上，而其他部分只是暂时的，那么请考虑使用 C/C++ 解决方案。

在一个简单的解决方案中发挥多种语言的优势并没有本质上的错误，特别是如果您不介意将它与脚本粘合在一起。但是，您集成的语言和模块越多，您的依赖项就越多，您拥有的依赖项越多，分发和维护您的应用程序就越困难。这就是真正的权衡所在：运行应用程序所需的技术、库和软件位越少，它就会变得越简单。应用程序越简单，它就越可维护、可分发、可调试和可用。

如果您不介意集成多项技术的额外开销，或者该开销将为您节省相同或更多的开发时间，请继续。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T21:03:48.230

我认为这很好。如果您将其设置为 n 层设置，其中每一层都以相同的方式访问其下方的内容（SOAP/XML/COM 等），我发现它最终是不可见的。

对于您的示例，我会为前端选择一种简单、快速、灵活的语言，并且可以对不同的接口（例如 com、corba、xml、.net）进行许多、许多、许多、许多类型的调用，自定义 dll 库、ftp 和自定义事件网关。这确保您可以轻松调用或与任何其他语言进行交互。

为此我选择的工具是使用 ASP/PHP/Java 和一点 Ruby 的 Coldfusion。它似乎将所有内容都集中在一个地方，并且非常简单。对于您的特定情况，COldfusion 将允许您编译您自己的库标签，您可以在您的网络代码中调用这些标签。在标签内，您可以放置​​您喜欢的所有 c 代码，并使其随心所欲。

有可用的免费和开源版本的 Coldfusion，它非常适合从一个代码库天真地进行 Java 和 .NET 调用。看看吧，我真的觉得它可能是最适合这类企业解决方案的。

我知道根据您的情况，PHP 也可以很好地解决这个问题，而且我相信 Asp.net 也不会落后太多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T21:18:49.947

我在多种语言方面的工作只涉及 C# 和 C++/CLI 的简单混合（如果你没有听说过，这就像 C++ 和 .NET）。我确实认为值得一提的是，.NET 和 Visual Studio 允许您将许多不同的语言组合在一起的方式意味着您在组合两种语言时不会像通常期望的那样高昂的开销 - Visual Studio 保留了这一切一起。鉴于有许多不同语言的 .NET 克隆——例如 F#、IronPython、IronRuby、JScript.NET——Visual Studio 是一种很好的组合各种语言的方法。

到听起来像您感兴趣的技术级别，它在 Visual Studio 中完成的方式是您必须为每种单独的语言创建一个项目，并且每个项目都被编译成一个程序集 - 基本上意味着它成为一个库其他项目使用。您将拥有一个主项目，它驱动一切并调用其他库。每种不同语言必须是不同的项目的要求意味着您不会在方法级别更改语言，但是如果您正在做一个足够大的应用程序，您可以在逻辑上将其分成多个项目，它实际上会非常有用。特别是，分离和抽象可以使事情变得更容易。

# c# - 移植 Active Directory 身份验证以使用 SQL 成员资格提供程序

> ID：485103
> 
> 赞同：0
> 
> 时间：2009-01-27T20:34:05.497
> 
> 标签：c#, active-directory, asp.net-membership, sqlmembershipprovider

我正在考虑将我的应用程序从使用活动目录成员资格提供程序转移到使用 sql 服务器提供程序。我们看到的主要问题是无法从 AD 中检索用户密码。有人有什么想法吗？有人认为我应该独自离开AD吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T06:25:04.360

出于设计和安全原因，您将无法从 AD 检索密码。您可以对照 AD 检查您的凭据（用户输入的用户名和密码） - 但您无法从 AD 中提取密码 - 不能。

要检查凭据，您可以使用 .NET 中 ActiveDirectoryMembershipProvider 上的“ValidateUser”方法 - 这将告诉您用户名/密码是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T06:27:20.627

啊，抱歉 - 我只是看到您想离开 ActiveDirectoryMembershipProvider（提出问题：为什么？？）。

如果您在 SqlMembershipProvider 中有自己的用户存储库，显然您必须存储、管理和验证自己的密码。再次 - 您无法从 AD 中检索它们，您必须让所有用户都过来并再次将它们输入到您自己的 SQL 服务器存储中。然后调用 SqlMembershipProvider 上的 ValidateUser 来验证用户的凭据。

但是再说一遍：如果您有 AD - 为什么首先要远离 ActiveDirectoryMembershipProvider？

马克

# sql-server - 满足脚本/开发需求的最佳 Sql Server IDE

> ID：485105
> 
> 赞同：3
> 
> 时间：2009-01-27T20:34:07.320
> 
> 标签：sql-server, ide

我正在寻找最适合脚本/开发需求的 Sql Server IDE。必备品：

*   用于创建复杂查询的可视化 GUI
*   所有数据库对象的智能感知
*   将 SQL 脚本格式化为特定格式/编码标准的自动格式化功能。
*   选择 Sql 输出到 .xls、.txt，并在分隔符/格式中自定义选择

成本不是问题。当您提出建议时，您能否说明您喜欢它的原因，以及您之前尝试过的其他 IDE。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T20:48:21.957

带有 SQL 助手 (www.softtreetech.com) 或 SQL 提示 (www.red-gate.com) 的 SQL Management Studio

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-28T19:31:36.437

我建议查看[SQL Everywhere](http://www.atlantis-interactive.co.uk/products/sqleverywhere/default.aspx)。我已经完全放弃了 MS SQL Studio 管理工具。对我来说，SQL Everywhere 的最大优势是自动完成（Intelisense），即使是针对 SQL 2005 服务器也是如此。格式化 SQL 功能没问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T20:39:23.240

Sql Server 自带的管理工作室有什么问题吗？2008 版满足您的所有要求。

[编辑]：我收回它：它可以在正确的情况下进行自动格式化，但这很痛苦，据我所知，它不允许您指定编码标准。此外，智能感知很弱。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T17:24:41.883

尝试[linqpad](http://www.linqpad.net/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T20:50:58.940

试用

*   [EMS SQL MANAGER 精简版](http://sqlmanager.net/en/products/mssql/manager/download)
*   [适用于 SQL Server 的蟾蜍](http://www.toadsoft.com/toadsqlserver/toad_sqlserver.htm)

我个人喜欢 EMS SQL Manager Lite，它让你的工作更轻松，相信我 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T20:54:50.960

ApexSQL[编辑](http://www.apexsql.com/sql_tools_edit.asp)。他们的 GUI 查询编辑器并不疯狂，但在智能感知和格式化方面非常出色。还包括通过剪贴板和一些方便的自定义列复制工具将结果集复制到 Excel、CSV 和 HTML 的选项。我在 SSMS 中几乎瘫痪了，因为 ApexSQL Edit 让我被宠坏了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-03T09:01:41.480

作为 SQL 开发人员的出色工具，我可以推荐[dbForge Studio for SQL Server](http://www.devart.com/dbforge/sql/studio/)。它符合您的所有要求。具体来说，它具有： - 可以创建复杂查询的可视化查询构建器 - 与 SQL Prompt 提供的类似的 Intellisense - 具有多个选项的 SQL 脚本格式 - SELECT 输出导出为 .xls 和 .txt 以及 6 种其他格式（具有导出自定义向导)

# php - 如何保护我的论坛免受垃圾邮件的侵害？

> ID：485106
> 
> 赞同：6
> 
> 时间：2009-01-27T20:34:19.490
> 
> 标签：php, mysql, forum, spam-prevention

我在我掌握的网站上有一个论坛，每天都会收到垃圾邮件。目前我删除垃圾邮件并阻止IP。但这不是很好。被阻止的 IP 列表正在迅速增长，但论坛中的垃圾邮件数量也在迅速增长。

论坛完全是我自己的代码。它是用 PHP 和 MySQL 构建的。

阻止垃圾邮件的具体方法有哪些？

**编辑** 我忘了提到的是，论坛需要对未注册用户开放才能发帖。有点像博客评论。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-27T20:48:30.147

在我编写的留言簿应用程序中，我实现了两个功能来防止大部分垃圾邮件：

*   不允许 POST 作为会话中的第一个请求

*   发布时需要有效的 HTTP Refer(r)er

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T20:40:32.177

我知道哪种方法有效的一种方法是在提交表单之前使用 JavaScript。例如，将方法从 GET 更改为 POST。;) 垃圾邮件机器人在执行 JavaScript 方面很糟糕。当然，这也意味着非 Javascript 的人将无法使用您的网站……如果您关心他们的话。;)（注意：我没有）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-27T21:17:05.520

In my experience, the best easy defenses come from just doing something "non-standard". If you make your site non-standard, this makes it so that any automated spam would have to be coded specifically for your site, which (no offense) probably isn't worth the effort. Note that if the spam is coming from human spammers, there's not really anything you can do that won't also stop legitimate posters. So the goal is to find a solution that will throw away any "standard" posts - that is, "fill out the whole form and push submit".

A couple examples that come to mind of things that you could try:

*   Have a hidden form field with a name that sounds like something a spammer would want to fill out, like "website" or "homepage" or something like that. If the form field gets filled out, throw away the message instead of posting it, because it was a bot automatically filling in the whole form, even invisible fields.
*   You don't have to use a "real" captcha, but even something simple like "Enter the following word backwards: <random backwards word>" or "What is the domain name of this website?". Easy for a human to do, but it would require a fairly complex bot to figure out what to fill in.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-27T20:41:35.027

你可以使用验证码，有一些很好的脚本，比如[PHPCaptcha](http://www.phpcaptcha.org/)，或者使用垃圾邮件控制服务，比如[Akismet](http://akismet.com/)，它们有一个[PHP API](http://akismet.com/development/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-27T20:42:37.663

您可能想查看[这个问题](https://stackoverflow.com/questions/8472/practical-non-image-based-captcha-approaches)，其中有几个答案描述了如何实现非侵入式验证码。

要考虑的另一件事是在帖子之间需要时间以防止大量垃圾邮件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-27T21:30:33.073

Include a CAPTCHA that is always "orange".

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-27T21:32:35.533

The spams may be by bots or humans - bots are more likely.

To stop the bots, put in a hidden field populated by Javascript - there is a 99.5% chance that a standard, stupid bot that isn't customised to your site will fail to fill that in.

If they fail to fill it in correctly, give them a message that Javascript is required or something, and give them an opportunity to post some other way (e.g. with a captcha or registration). That way anonymous users who aren't spambots can (mostly) still post with no problems, and most spambots (which haven't been tailored for your specific site) won't.

Don't bother blacklisting IP addresses or using third party blacklists, that will just generate false positives. Almost all bots use the same IP addresses as (some) legitimate users.

* * *

Another trick is to put in a text field with a plausible sounding name, which is made difficult to see with CSS - anyone filling this field in with anything is considered to be a bot.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-05T15:56:07.703

Advanced solutions:

*   [Akismet](http://akismet.com)
*   [Defensio](http://defensio.com/)
*   [Sblam!](http://sblam.com/en.html) ([open source](http://code.google.com/p/sblam/) clone of the above)

You can try your luck with non-standard form:

*   fields that must stay empty hidden with CSS
*   fields with misleading names, e.g. `<input name=email>` for something that is *not* an e-mail.

For me CAPTCHA is like giving up to spammers and letting them damage your forum anyway – except that instead of spam damage, you get usability and accessibility damage.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-05T16:11:51.690

Something I've found to be surprisingly effective: disallow comments that contain too many URLs (more than, say, 5). Since doing that, I've had zero comment spam.

**Edit:** Since writing the above, I've had recurring comment spam with only one link. I have now added some [honeypot fields](http://nedbatchelder.com/text/stopbots.html) and have had no commend spam for a few months now.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-27T20:37:08.627

在他们回复发送到他们注册的电子邮件地址的电子邮件之前，不要让任何人发帖。您会看到许多论坛和邮件列表会生成一个唯一的电子邮件地址或 Web url，该电子邮件地址或网址会发送到新用户给定的电子邮件地址，他们必须回复电子邮件或单击链接以完成注册。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-27T20:52:38.797

Captcha 绝对是最简单的方法——如果你想要一些防 bot 的东西，试试 KittenAuth（虽然这次我有 pandas）

*   [小猫认证](http://www.thepcspy.com/contact)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-27T21:30:43.837

There is no single answer since Spam is really a matter of economics: how much is it worth it to someone to put their stuff onto the web. There, however, some solutions that seem pretty good

*   [Recaptcha](http://recaptcha.net/)
*   Use [CCS to create an invisible field](http://nedbatchelder.com/text/stopbots.html) that robots fill-in
*   Create a time-specific hidden field in your form so the robot can't use the same form over and over again.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-05T15:49:05.630

I want to say that in most time, a CAPTCHA is enough for you to prevent SPAMers. But do use a strong one, like [http://www.captcha.net/](http://www.captcha.net/).

Remember that SPAMers do not want to spend much time to deal with a particular site(except heavy traffic sites), they use a tool to post AD on a lot of sites. So make your FORM a little unusual, (e.g. give the user a image says '1.5+2.4=?' and let users to answer, this will block most of the spam tools :) )

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-05-09T01:36:09.673

The easiest thing I've done to stop spammers with (so far) 100% consistency is to validate the text that was submitted. If you use the php function strstr() to check for "a href" or even a non-clickable http or www, you can then just reroute the spammer elsewhere. I actually have a script then write to my .htaccess file to deny the offending IP address. Not sure if there's any other kind of spam to be concerned about, but links are all I've seen so far.

# html - “框架”他人的网站是什么意思？

> ID：485107
> 
> 赞同：3
> 
> 时间：2009-01-27T20:34:23.640
> 
> 标签：html, iframe

我收到了一份拟议的场地协议的副本，其中一个条件是：

> ...我们每个人都可以在任期内： ...框架对方的网站

“构图”是什么意思？我认为这可能与 iframe 嵌入有关，或者在没有额外徽标和其他此类图像的情况下捕获我们主页的一部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T20:39:25.827

我的理解是，“框架”基本上是劫持您的内容并使其看起来像是我网站的一部分，就像您说的那样，将内容窃取到 iframe 中。

来自[互联网法律问题：框架](http://www.publaw.com/framing.html)

> 框架技术的使用是几年前解决的华盛顿邮报诉 TotalNews 案的核心问题，包括《华盛顿邮报》、《华尔街日报》和 CNN 在内的几家著名新闻机构对网络新闻提起诉讼收集网站 TotalNews。TotalNews 使用框架技术和超链接在 TotalNews 网站上显示新闻机构的信息，并在框架周围放置自己的广告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T20:37:54.427

在这种情况下，这听起来就像只是做一个

```
<iframe src='http://www.test.com' title='My Test Frame'/> 
```

但是，如果您不确定，最好询问并了解它们的含义，这样就不会产生误解，并且像往常一样，始终以书面形式提出:)

G人

# asp.net - 没有复杂类型的 ASP.NET WebService

> ID：485113
> 
> 赞同：0
> 
> 时间：2009-01-27T20:37:29.780
> 
> 标签：asp.net, web-services

我正在尝试使用 ASP 构建一个 Web 服务，该服务将被赋予三个参数：一个字符串、一个日期/时间和另一个字符串。制作方法后，wsdl 包含以下内容：

```
<s:element name="TimesheetAudit">
<s:complexType>
<s:序列>
<s:element minOccurs="0" maxOccurs="1" name="employeeNumber" type="s:string"/>
<s:element minOccurs="1" maxOccurs="1" name="periodEndDate" type="s:dateTime"/>
<s:element minOccurs="0" maxOccurs="1" name="timesheet" type="s:string"/>
</s:序列>
</s:complexType>
</s:元素>
```

调用我的 Web 服务的黑匣子抱怨参数数量不匹配。我假设这是因为我的 webmethod 在技术上采用 1 个参数，一个复杂类型，而不是三个。

这是问题吗？如果是这样，我能做些什么来克服它？

编辑：在这种情况下，消费者是黑匣子，我必须塑造我的 Web 服务以匹配调用者。添加

```
[SoapDocumentMethod(ParameterStyle = SoapParameterStyle.Bare)]
```

我的方法签名给出了以下错误：

```
' does not conform to WS-I Basic Profile v1.1\. Please examine each of the normative statement violations below. To turn off conformance check set the ConformanceClaims property on corresponding WebServiceBinding attribute to WsiClaims.None.
R2204: A document-literal binding in a DESCRIPTION MUST refer, in each of its soapbind:body element(s), only to wsdl:part element(s) that have been defined using the element attribute. 
  -  Part 'input' of message 'TimesheetAuditSoapIn' from service description with targetNamespace='[http://www.netdes.com/](http://www.netdes.com/)'.
  -  Part 'TimesheetAuditResult' of message 'TimesheetAuditSoapOut' from service description with targetNamespace='[http://www.netdes.com/](http://www.netdes.com/)'. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T20:56:33.377

如果没有关于客户期望的更多信息，很难确定，但这可能是参数样式问题。

默认情况下，ASP.NET Web 服务使用“Wrapped”参数样式，这意味着所有参数都包装在单个元素中，该元素在 SOAP 主体内发送。

您可以更改方法声明以使用“Bare”参数样式，它将所有参数直接放在 SOAP 主体中，而无需包装元素。这是通过 Web 方法上的 SoapDocumentMethodAttribute 上的 ParameterStyle 属性实现的。

有关详细信息，请参阅[此 MSDN 条目](http://msdn.microsoft.com/en-us/library/2b4bx2t6(VS.80).aspx)。

* * *

响应一致性错误：您可以通过将以下内容放入 web.config 来禁用 WS-I 一致性检查：

```
<configuration>
  <system.web>
    <webServices>
      <conformanceWarnings>
        <remove name='BasicProfile1_1'/>
      </conformanceWarnings>
    </webServices>
  </system.web>
</configuration> 
```

一致性通常是一件好事，但这不是必需的。由于在这种情况下您无法控制定义，因此您没有太多选择。

客户端也可能期望 RPC 样式的 Web 服务而不是文档样式的 Web 服务。（这将使用 SoapRpcMethodAttribute 而不是 SoapDocumentMethodAttribute 来控制。）如果您在关闭一致性警告后仍然没有运气，您可以尝试更改为 RPC 样式并查看是否有效。

如果有任何方法可以获得客户端的定义（源代码，或者更好的是，用于生成源代码的 WSDL），以便您可以准确地知道它所期望的内容，这将有所帮助。如果您可以获得 WSDL，您可以让 .NET 以正确的格式为您生成 Web 服务方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T05:07:08.283

听起来你是构建网络服务主机的人，所以你可以运行这个节目，对吧？

如果您可以启动 Visual Studio，单击文件、新网站，向其中添加 Web 服务，使用自动生成的 WSDL 并从测试工具成功连接到它，那么该 Web 服务的使用者应该能够阅读相同的 WSDL 并与您一样连接到它。重要的是你有一个有效的测试工具。

如果是这种情况，那么黑匣子问题出在他们的一端，而不是你的一端。

# .net - 设置父控件的 Enabled 属性时会发生什么？

> ID：485118
> 
> 赞同：0
> 
> 时间：2009-01-27T20:38:22.977
> 
> 标签：.net, asp.net, vb.net, web-controls

我有一个自定义控件容器，每个控件中有 2 个控件。启用时显示一个（即文本框或复选框），禁用时显示一个标签。

我已经`Render`像这样超载了：

```
 Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)
        If Me.Enabled Then
            _item.RenderControl(writer)
        Else
            _display_text.RenderControl(writer)
        End If
    End Sub 
```

但是，当我将容器（即表）设置为 时`Enabled = False`，我的预期功能不会发生。相反，我的文本框和复选框是灰色的。

当您设置父母的`Enabled`财产时，实际上会发生什么？我的假设是它将这种状态传播到它的所有孩子，但看来我错了。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T20:53:12.617

简短的回答是您的假设实际上是错误的。

如果你喜欢（并且正在扩展 WebControl，并且你的容器有一个 runat=server），你可以使用

```
If NamingContainer.Enabled Then 
```

代替

```
If Me.Enabled Then 
```

但是属性不会在 asp 中自动沿树向下传播。

# c# - “字面意思”这个词是什么意思？

> ID：485119
> 
> 赞同：88
> 
> 时间：2009-01-27T20:38:41.773
> 
> 标签：c#, language-agnostic, terminology, glossary

在诸如文字字符串和文字值之类的上下文中使用时，“文字”一词​​是什么意思？

文字值和值有什么区别？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2009-01-27T20:46:04.613

文字是“在源代码中**表示值的任何符号”（**[维基百科](http://en.wikipedia.org/wiki/Literal)）

*（与identifiers*对比，它*引用*内存中的一个值。）

例子：

*   `"hey"`（一个字符串）
*   `false`（一个布尔值）
*   `3.14`（实数）
*   `[1,2,3]`（数字列表）
*   `(x) => x*x`（一个函数）
*   `/^1?$|^(11+?)\1+$/`（一个正则表达式）

一些不是文字的东西：

*   `std::cout`（标识符）
*   `foo = 0;`（一份声明）
*   `1+2`（一种表达）

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-01-27T20:42:29.037

文字是直接硬编码到源代码中的值。

例如：

```
string x = "This is a literal";
int y = 2; // so is 2, but not y
int z = y + 4; // y and z are not literals, but 4 is
int a = 1 + 2; // 1 + 2 is not a literal (it is an expression), but 1 and 2 considered separately are literals 
```

一些文字可以有特殊的语法，所以你知道文字是什么类型：

```
//The 'M' in 10000000M means this is a decimal value, rather than int or double.
var accountBalance = 10000000M; 
```

它们与变量或资源的不同之处在于编译器可以将它们视为常量或对使用它们的代码执行某些优化，因为可以肯定它们不会改变。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-01-27T20:41:13.890

文字是对显式值的赋值，例如

```
int i = 4;  // i is assigned the literal value of '4'
int j = i   // j is assigned the value of i.  Since i is a variable,  
            //it can change and is not a 'literal' 
```

编辑：正如所指出的，赋值本身与文字的定义无关，我在示例中使用了赋值，但文字也可以传递给方法等。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-27T20:58:35.167

文字是指在源代码中包含值（而不是引用变量或常量）。例如：

```
int result = a + 5; // a is a variable with a value, 5 is a literal

string name = "Jeff Atwood"; // name is a variable initialized
                             // with the string literal, "Jeff Atwood"

int[] array = new int[] {1, 2, 3}; // C# has array literals (this is actually three
                                   // int literals within an array literal) 
```

如果字面量表示某个量，例如物理常数，最好给它一个名称，而不是在需要的任何地方都写相同的字面量。这样，当您阅读源代码时，您就会知道数字的*含义*，这通常比它的值更重要（无论如何都可能改变）。

```
const int maxUsers = 100;
const double gravitationalAcceleration = 9.8; 
```

通常，我使用的唯一数字文字（除了像上面那样初始化常量）是 0 或 1，如果我在循环中跳过所有其他项目，有时是 2。如果数字的*含义*比它的实际*值*更重要（通常是），最好命名它。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-27T20:47:47.700

文字值*是一个*值，但一个值也可以存储在一个变量中。在声明中

```
string str = "string literal"; 
```

有一个字符串变量 (str) 和一个字符串文字。语句执行后，它们都具有相同的值。

请注意，在许多语言中，变量和文字值甚至不一定必须是相同的类型。例如：

```
int a = 1.0; 
```

上面的文字值是一个浮点类型。编译器将强制该值适合 int 变量。

再举一个例子，在上面的第一行 C++ 代码中，字符串文字的类型实际上根本不是库类型`string`。为了保持与 C 的向后兼容性，C++ 中的字符串文字是 char 数组。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-27T20:43:43.620

快速示例：

int my_int_var = 723;

723 - 这组字符指的是一个**文字**整数值。

my_int_var - 这组字符是指一个**变量**整数值。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-27T20:42:15.713

文字是当您将其放入代码中时。所以字符串文字是

```
string s = "SomeText"; 
```

这与构建字符串或将其作为参数相反。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-27T21:03:03.457

通常，当有人使用文字一词时，他们的意思是可以从代码（文本）中破译该值，如其他帖子中的许多示例所示。

另一种常见用法是在汇编中转换为立即值的值。这些是直接插入机器指令而不需要寄存器加载的值。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-12-25T11:36:54.170

文字是“数据的源代码表示”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-27T20:54:27.687

我听说过随便使用字符串文字来指代[C# 规范](http://msdn.microsoft.com/en-us/library/aa691090.aspx)实际上所指的逐字字符串文字。常规字符串文字允许转义某些字符（以 a 为前缀），例如 \t 用于制表符。逐字字符串文字以@ 开头并逐字处理，\ 没有特殊含义。

```
//regular
string regular = "\thello world";
//verbatim
string verbatim = @"C:\";
//the regular equivalent of this would be "C:\\" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-05-07T14:45:49.343

文字是某些类型的值的简写符号，语言认为如此重要或基本，以至于它专门为它们提供了专门的语法糖。

其值通常由文字表示的类型示例：

```
Boolean = { true, false }
Integer = { ..., -2, -1, 0, 1, 2, ... }
Character = { 'a', 'b', ... }
String = { "hello", "world", ... } 
```

有些语言甚至对于函数类型也有[文字：](https://stackoverflow.com/questions/5241147/what-is-a-function-literal-in-scala/38807657#38807657)

```
Integer -> Integer = { (x: Integer) => x + 2), (x: Integer) => x/2, ...} 
```

通常不使用文字表示的值的一个示例是类类型的值：

```
Car(brand: String, seats: Integer) = { Car("BMW", 5), Car("Ferrari", 2), ...} 
```

这里`Car("BMW", 5)`类型中的值`Car`确实使用一系列符号唯一地表示，但是，该值不是使用专用的速记文字表示的，而是使用通用（详细）概念机制来表示任何类类型的值。

*字面*量这个词是*value*、*instance*、*constant*、*member*和*element* of a type的同义词，但带有一些额外的含义，告诉我们有一种速记方式可以将其写下来。

我喜欢将文字视为埃及象形文字，而不是将字母表中的字符串在一起以表达概念。

# emacs - Emacs 会让我成为更好的程序员吗？

> ID：485120
> 
> 赞同：129
> 
> 时间：2009-01-27T20:38:55.893
> 
> 标签：emacs, text-editor, vi

Steve Yegge[在他的博客上写了一条评论](http://steve.yegge.googlepages.com/tour-de-babel)：

> 世界上所有最伟大的工程师都使用 Emacs。改变世界的类型。不是你旁边立方体里的大美女。不是弗雷德，大厅里那个了不起的家伙。我说的是我们行业中最伟大的软件开发人员，他们改变了行业的面貌。James Goslings、Donald Knuths、Paul Grahams、Jamie Zawinskis、Eric Bensons。真正的工程师使用 Emacs。你必须非常聪明才能很好地使用它，如果你能掌握它，它会让你变得异常强大。如果你不相信我的话，在他工作的时候去看看保罗诺德斯特罗姆的肩膀。对于整个职业生涯都在使用类似 Visual Blub .NET 的 IDE 的人来说，这真是大开眼界。
> 
> Emacs 是 100 年的编辑器。

上一次使用文本编辑器编写代码是在大约 1000 年前我还在记事本中编写 HTML 的时候。从那时起，我或多或少地依赖于 IDE，在我的整个职业生涯中都使用过 Visual Studio、NetBeans、IntelliJ、Borland/Codegear Studio 和 Eclipse。

对于它的价值，我*已经*尝试过 Emacs，但我的体验令人沮丧，因为它完全缺乏开箱即用的可发现特性。（显然有一个用于发现其他 Emacs 命令的 Emacs 命令，顺便说一句，我找不到 - 这就像在生活你自己的残酷的禅宗般的笑话。）我试图让自己喜欢这个程序一个月，但最终决定我宁愿使用拖放式 GUI 设计器、IntelliSense 和交互式调试。

很难将事实与粉丝主义区分开来，所以我现在还不愿意接受耶格的评论。

**依赖 IDE 的人和不依赖 IDE 的人在技能、生产力或编程乐趣方面是否存在可衡量的差异，或者这只是狂热？**

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-01-27T21:10:12.757

首先让我说，我自称是 Emacs 的忠实信徒。

也就是说，博主是疯了。你写你觉得有用的东西。我发现 Emacs 对我有帮助，主要是因为我在大学期间预付了启动成本，学习如何修改它以满足我的需要，并根据它的需要修改自己。

但是其他人做事不同，就像他们说的“没关系”。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-01-27T21:16:42.570

他（史蒂夫·耶格）在他的其他帖子中一点一点地详细阐述了这一点。[http://steve-yegge.blogspot.com/2008_04_01_archive.html](http://steve-yegge.blogspot.com/2008_04_01_archive.html)可能是最全面的，但信息被埋在那里，因为它与主要主题相切。

*我想总结一下：仅仅优秀*或*有能力*的程序员会拿起一个 IDE 并真正了解它，并且可能在其中做得足够体面，但他们会将自己限制在 IDE 为他们提供的东西上。换句话说，它们使自己适应 IDE。另一方面，*伟大的*程序员会调整他们的*环境*以适应*他们自己*，例如编写脚本或他们自己的工具，或者扩展他们的工具。最后一点，Emacs 不仅是*最*可扩展的环境，也是*最容易*扩展的环境，而且它是您获得最大*收益的环境*从扩展它——您的扩展集成到 Emacs 中，就像它们是库存功能一样，因此您未来的扩展可能建立在您以前的扩展之上（正反馈循环之类的东西）。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2009-01-27T21:09:15.767

最好的程序员使用 vi 或 emacs，因为最有经验的程序员是最好的，而 20 年前，除了 vi 和 emacs 没有太多选择。

在一台文本终端非常慢的机器上开始使用 vi（约 1987 年）后，几年后（在一台速度更快的机器上）我转换为 (GNU) Emacs，并且几乎只使用了近 10 年。

Emacs 是第一个真正集成的开发环境 - 整个编辑/链接/编译周期可以在 emacs 中控制，您可以为您使用的任何编译器滚动自己的编译器。

如今，诸如 eclipse 之类的 IDE 集成度更高（说实话：emacs 在图形方面很烂），但 Emacs 仍然是“纯”文本编辑的最佳环境之一。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2009-01-28T00:03:24.217

**提高你的清晰思维和解决问题的能力将使你成为一个更好的程序员。没有任何程序可以做到这一点。**

除非我知道如何以及为什么，否则使用更好的锤子不会帮助我建造更好的房子。;)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-01-27T20:42:11.673

Yegge 需要见 Bill Joy。他不仅是世界上最伟大的程序员之一，他还编写了大量的 vi。在六。

简短的可耻忏悔：在使用 vi（以及近年来的 vim/gvim）处理所有事情之后，在过去一年左右，我开始使用 Eclipse 进行 java 编辑（和 Thunderbird 进行电子邮件），尽管在我目前的工作中我机器内存太少，我通常使用 vi，除非我需要调试器。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-01-31T20:17:24.087

> 依赖 IDE 的人和不依赖 IDE 的人在技能、生产力或编程乐趣方面是否存在可衡量的差异，或者这只是狂热？

让我们把它缩小到 Visual Studio 与 Emacs ——否则这个问题太宽泛了，我怀疑大多数人（至少在 StackOverflow 上）都熟悉这两个。[我是，我使用并更喜欢 emacs]

接下来，让我们分解问题的三个组成部分。

编程的乐趣归结为主要是喜欢编程本身，其次是当你这样做时不会出现烦人的因素。使用您难以使用的工具会减少乐趣。所以，我猜想，使用你喜欢和熟悉的工具可能会最大限度地享受乐趣。

当然，一旦你熟悉了一个新工具，你可能会发现你更喜欢那个工具，因此如果你用你最喜欢的*新*工具来编程，你会更喜欢编程。我不清楚当人们对 VS 都很了解时，他们一般会喜欢 VS 而不是 emacs（反之亦然）。

其次，编程技巧。如果技能和VS / emacs的选择之间有任何联系，我认为是技能导致选择，而不是选择导致技能。根据我的经验，{VS, emacs} 似乎都没有让我学到任何关于编写*更好*代码的东西。

一个好的工具可能使我能够在更短的时间内编写相同的代码（因此代码*质量*相同）；如果我们假设`productivity = quality of code `times` code per time`，那么任何可以让您在更短的时间内编写好代码的编辑器都可以提高生产力。

我可能对VS太陌生了，但是在这里我觉得emacs有一些我在VS中没有发现的优势。这听起来可能很荒谬，但是像光标移动这样简单的事情`Ctrl-[fbnp]`是真正的福音——这意味着您不必将手移到箭头键上。另一件事：您可以进行包含换行符的搜索或替换，我经常使用它，以至于我不想错过它。

我喜欢的另一件事是在我的编辑器中嵌入 shell 的能力。根据我的经验，它在非 Windows 平台上更有价值（我的第一次“编程”体验 IIRC 是编写 DOS .bat 文件，所以我不仅仅是一个狂热的粉丝），但在那些平台上这是一个巨大的胜利. 它使 emacs 与“一切”“集成”（使用 find/locate 进行文件搜索，使用 grep 进行文本搜索，使用 svn/git/hg/...进行版本控制，你可以命名它）。

最终判决——你应该学习emacs还是不学习？这都是狂热分子吗？如果你有时间，我想说学习做同样事情的新方法总是值得的，因为新方法可能对你更有效。我鼓励你不要拒绝它，因为当你对它完全陌生时，它看起来是这样的。从这个意义上说，这就像切换到 Dvorak 键盘布局：一开始你会比较慢，但是一旦你加快了速度，你可能至少会和 qwerty 一样快，而且更舒服。我也推荐学习新（编程）语言的相同方法：因为你不知道词汇（标准库），所以说东西很难，但奖励仍在等待你。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-01-27T20:52:18.393

引用的文字以“世界上所有最伟大的工程师都使用 Emacs”开头，我也不会从表面上看它。他认识世界上所有最伟大的工程师吗？世界上最伟大的工程师名单和你我一样吗？

一旦学会了，像 EMACS 或 vi 这样强大的编辑器会让你更有效率，或者如果你碰巧在没有你最喜欢的 IDE 的情况下被抓到，至少效率会更高。

“曾经学过”的部分才是杀手锏。高效地使用这些工具需要大量的工作和练习，而且一开始非常艰难。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-01-27T23:46:08.870

我个人是 Emacs 的忠实拥趸，但 Emacs 只是一个工具。它不会让你成为更好的程序员，就像一支超级花哨的笔不会让你成为更好的作家一样。

澄清“伟大的程序员”使他们的环境适应自己可能有一些优点，但是很多工具可以做到这一点（例如 vim 和 SlickEdit），所以在这方面 Emacs 没有什么特别之处。

我认为最有可能的是，“伟大的程序员”对编程充满热情，而对编程充满热情的人往往会找到有助于激发这种热情的工具。Emacs（以及 vim 和 SlickEdit 等）就是这样一个工具。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-01-27T20:43:00.673

我不相信有区别，这更像是一个偏好问题。

然而我注意到的是，你编码的时间越长，或者你编码的级别越低，你使用 emacs 或 vi 的机会就越大。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-01-27T21:51:52.500

尽管 IDE 在过去十年中变得更好，但它们仍然将编程包含在一个安全的“泡沫”中，远离一些丑陋的细节。倾向于发生的情况是，这种抽象的增加允许更多的程序员用更少的知识做更多的事情。当然，这并不适用于所有程序员，但更简单的工具确实将编程带给了更广泛的受众。

对低级工具的更多了解通常会转化为代码的更高稳定性，因为意外“违背常规”的机会更少。将 EMACS 列为唯一的领先指标是不公平的，因为它来自各种语言和工具，而且更多的是关于理解的深度，而不是具体的技术。

回到过去，您要么在 UNIX 机器上学习 VI 或 EMACS，要么专攻 PC（好吧，还有 VMS、CMS、AS400 等，但这些都是较旧的技术）。这两个流都吸引了非常热心的人，但 UNIX 人倾向于想要一个复杂的解决方案，而 PC 人只是希望它快点完成。文化非常不同。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-04-29T23:10:11.630

恕我直言 IDE 倾向于围绕特定平台或语言或操作系统进行优化：Eclipse JDT 非常适合 Java，Visual Studio 以 C++/.NET 为中心等等。如果您只是在工作，它们会极大地提高生产力（再次恕我直言）那个平台，但是如果你改变平台，你基本上必须学习一个新的 IDE（或者至少一组新的插件、视图、透视图，我不知道 Eclipse 还有什么）。

了解 emacs、Textmate、vim（我的个人偏好）或任何*通用*编辑器的优势在于，无论您为什么平台编写代码，您在该编辑器中获得的技能都适用。它们针对*编辑文本*进行了优化，一旦掌握它们，您就可以非常高效地编辑任何语言的文本。

Yegge 还断言，伟大的程序员会根据自己的工作风格调整他们的工具，而不是反过来。我认为这对于通用编辑器来说是一个胜利，因为您可以自定义*一个*编辑器，而不必研究如何调整四个不同的 IDE 以使其都按照您想要的方式运行。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-09-24T14:27:52.213

我认为最好的程序员往往会花时间定制他们的环境，从而更快/更容易地执行他们可能完成的任务。在自定义环境方面，Emacs 是最强大的编辑器之一。它有一个陡峭的学习曲线，但是一旦你过去了，你可以让它为你做的几乎没有限制。

有人曾经说过，最好的程序员是懒惰的；那些，一旦他们需要做不止一次的事情，找到一种方法来自动化它，这样就可以减少工作量。Emacs 让你变得非常非常懒惰；）

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-27T21:37:28.380

我从一开始就使用 IDE（可以说是从 QBASIC 开始），并且已经使用了很多很多年。我现在几乎完全切换到 VIM（多种风格）来完成我的所有开发工作，我不后悔。我的工作效率肯定提高了。

当然，没有什么能取代 Visual Studio 中的 Windows 窗体设计器。但与 VIM（和 Emacs，我敢肯定）相比，Visual Studio 中的文本编辑器真的很糟糕。一旦您利用了控制台和 GNU 开发人员工具（我指的是`make`GCC`binutils`和`gdb`IDE 提供的工具（除了表单设计器）。

只是当您第一次开始使用这些工具时，您有一个非常陡峭的攀登，并且激励可能很小。我很幸运（？）被迫使用这些工具，所以我没有选择可以摆脱的选择。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-01-27T20:48:24.797

对我来说，我选择 Emacs 而不是 IDE 的主要原因是因为它允许我只用我的键盘做所有事情。这很好，因为它为我通常使用鼠标时节省了一些时间。此外，由于我发现自己非常灵活，我倾向于使用我的慢速触摸板来中断我的编程“槽”。此外，它的定制使它在我的一些 IDE 上大放异彩。但是，如果您发现自己使用 IDE 编程速度足够快，那么我会说 Emacs 的学习曲线不值得麻烦。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-01-27T20:52:43.913

就个人而言，我觉得你应该使用任何能让你更有效率的东西。如果您没有时间投资于一个项目来坐下来学习 Emacs，那么此时这可能不是您时间的最佳利用方式。

但是，我确实认为，当您有足够的时间了解其他 IDE 时，这是一个好主意。我在日常工作中使用 Visual Studio，但在家里我使用 Eclipse 来处理小型项目并使用过Emacs 也一样。在我考虑使用 Emacs 的特定点上，我努力完成实际工作比放慢自己与 Emacs 搏斗的速度更好。

我认为在某种程度上认为所有最好的程序员都使用 Emacs 是荒谬的。有许多不使用 Emacs 的不那么受欢迎（或者可能不那么有声望）的优秀程序员。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-01-27T22:00:44.027

大约一年半前，我开始使用 Emacs，因为它融合了多种需求——想要使用正则表达式（在支持它们的编辑器中），想要学习 lisp，想要更好的编辑器。

用正则表达式编辑我的代码教会了我很多关于在代码中寻找模式的知识。击键需要一段时间才能习惯，但没有鼠标我飞得更快。

Emacs 让我能够在同一个应用程序中继续处理我的笔记和编码——最少的上下文切换意味着最少的大脑切换，我可以继续专注于手头的任务。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-01-28T06:30:40.457

不，好的代码会让你成为更好的程序员。

也就是说，良好的文本操作是提高效率的关键。vim 或 emacs 都会改变你处理文本的方式——两者都被证明是有效的，但在风格上几乎是相互矛盾的。此外，这场争论相当古老（回到 80 年代和 90 年代，文本 -> 编译器是关键），因此还有许多其他文本编辑器和/或 IDE 可以帮助您成为最好的程序员。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-02-04T17:15:08.697

不会。如果您认为使用 emacs 可以让您成为更好的程序员，那么您就是在混淆因果关系。

不过，我确实每天都使用它。我发现使用 emacs+maven 比使用 Eclipse 进行 Java 开发更有效率（尽管我仍然不时启动 Eclipse 来进行偶尔的重构或调试会话）。

这些是我的理由：

*   emacs 中的实际文本编辑体验胜过其他一切。仅使用键盘即可完成如此多的任务，令人惊讶。Eclipse 更面向鼠标，当您键入时会遇到很多烦人的障碍。
*   能够使用 elisp 自定义 emacs 非常强大。我什至会说，如果您不花时间学习基本的 elisp 和自定义环境，那么您只是在浪费时间。
*   几乎所有你想在文本编辑器中做的事情都有扩展。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-01-27T20:50:18.460

**依赖 IDE 的人和不依赖 IDE 的人在技能、生产力或编程乐趣方面是否存在可衡量的差异，或者这只是狂热？**

我认为你无法真正得到答案。有很多不同的方法可以衡量技能、生产力和编程乐趣——而且所有这些方法都可能非常主观和/或不能分解为一个导致它或不导致它的事情。

这仍然是一个有趣的问题。

我个人的信念是 - 这取决于程序员:)

G人

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-01-27T21:24:38.123

emacs 的一大特点是它可以处理几乎任何你扔给它的文件类型，任何大小。诚然，如果您打开一个疯狂的巨大加密文件，它不一定有用，但它会打开。如果你交给他们一个太大的文件和/或不是他们预期的格式之一，大多数编辑器（和 IDE）会让你非常心痛。

例如，尝试在记事本中打开一个 1 Gig 文件。

我在 1980 年左右开始使用 Emacs，它一直是我工具箱中的一个工具。它不是*唯一*的工具，但它始终是我可以求助的工具，并且我知道我将能够完成一些有用的工作。

*强制性的煽动性评论*：另一方面，我对 vi 没什么好说的。我一直觉得vi会出于恶意而高兴地杀了我并卖掉我的器官……

在现实生活中，我使用 Netbeans 进行几乎所有形式的开发，并且不时使用 emacs 进行快速编辑。当谈到现在做一些疯狂的事情时，几乎没有什么比 emacs（对我来说）更方便的了。

还有其他人必须在编译的二进制可执行文件中编辑静态字符串吗？有没有比 emacs 更好的工具呢？它当然对我有用。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-01-27T21:42:45.920

我不认为它会让你成为一个更好的程序员，但是当你达到那个水平时，你很可能会使用 emacs（或 vi）

： - /

这两个的好处（我以前从未使用过 emacs，但我仍然使用 vi 来完成最普通的任务）是事实，它们不会打断你[的思路](http://www.azarask.in/blog/post/help-your-train-of-thought-is-sacred/)，你不必把手移开键盘抓住鼠标，并在文件菜单中寻找正确的选项。你只是，继续写。在你的脑海中，你会说：“用这个词替换所有出现的词”，然后按 Enter 键并继续你的工作。

此外，我不认为他们使用 emacs 是他们唯一的工具。

它会让你成为更好的程序员吗？可能不是。但是，当您拥有该级别的专业知识时，您可能会喜欢使用这些工具编写代码的速度。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-01-28T00:00:06.767

不。

纪律、批判性思维和自我提升的愿望将使您成为更好的程序员。您的工具集虽然是您生产力的主要因素，但不会创造天才。

如果您不喜欢 emacs 或 vi，请不要使用它们。通过有意识地选择不这样做，您正在塑造您的开发环境以适应您自己的需求和工作实践。在任何情况下，你都有权使用你喜欢的东西——并且忽略任何愚蠢到因为你用来将比特写入磁盘的工具而责备你的人——重要的是比特。

*注意：这里的“工具集”字面意思是工具的“品牌”——特定的编辑器、编译器等。概念性工具集，例如版本控制的使用、单元测试——通常来说——都是自我的一部分。改进过程。*

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-01-31T19:36:47.227

我知道您没有问这个问题，但是学习 emacs（出乎意料地）对我来说有所改进的一件事是操作命令行。在我学习 emacs 键绑定之前，我曾经使用光标键移动光标和浏览历史记录，因为我不知道更好。当我意识到我可以使用`backward-word`,`move-beginning-of-line`和（[正如 Stevey 建议](http://steve.yegge.googlepages.com/effective-emacs)的那样，`backward-kill-word`我一直都必须使用） in (通常也很有用，并且对那些以前从未见过它的人来说最令人印象深刻的时候，这是一个灯泡时刻。`C-w``bash``M-t`

我在 Solaris 上做了很多工作，其中 root shell 是“posix shell”，默认情况下没有 emacs 绑定。我发现我的手指现在可以`exec bash`自己打字了，每次我登录时，我都觉得现在熟悉的编辑命令在我的手指下快得多了。

不过必须承认，我仍然觉得 Knuth 的书很难读（尽管值得）——所以我不认为它神奇地改进了我的编程。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2009-09-23T19:57:47.360

Emacs 让我在文本操作和文件系统导航方面更有*效率。*而且由于我在编程时会涉及到这两件事，这让我成为了一个更高效（因此更好）的程序员。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2009-10-15T04:44:52.963

我认为 Emacs 可以让你成为一个更好的程序员，尽管是间接的。我认为 Emacs 让我真正用函数式语言 ( [Elisp](http://en.wikipedia.org/wiki/Emacs_Lisp) ) 编写，这让我对其他函数式语言 ( [Clojure](http://en.wikipedia.org/wiki/Clojure) ) 感兴趣，我被告知这将使我成为一个更好的程序员。也就是说，我想时间会证明一切。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-01-27T22:57:45.830

能够使用*一些*可定制的编辑器可以让您做一些漂亮的事情，但特别是 emacs 不一定是最好的。我自己是一个 SlickEdit 用户，我用它做所有与 emacs 著名的奇怪的半自动化的东西。我见过人们用 vi 和各种基于 Windows 的编辑器做类似的事情。

所以，是的，插座套装很好，但认为工匠制作了一个真正的插座套装有点愚蠢。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-01-28T20:59:48.190

掌握 Emacs 键绑定及其内置功能将使您能够比 Eclipse 或 Visual Studio 等 IDE 更快地操作文本。

不要相信我的话，看看这些[使用 Emacs 的专业人士](https://stackoverflow.com/questions/140336/where-can-i-find-a-video-of-a-pro-using-emacs)的视频。

一旦你在 Emacs 中达到了不错的水平，你就可以有效地编辑任何语言：Java Script、Java、Ruby、Python、HTML、C、C++ 等。

开始使用 Emacs 是一件很痛苦的事，开箱即用的体验比糟糕还糟糕。Emacs 默认配置不会让 Emacs 新手接触 Emacs 更强大的功能（嬉皮扩展、etags、yasnippets 等）。我建议从[Emacs Starter Kit](http://technomancy.us/119)点文件开始。

Steve Yegge 声称世界上最好的程序员使用 Emacs 的另一个原因是 elisp。Elisp 让经验丰富的程序员能够**轻松**扩展 Emacs。在 Eclipse 或 Visual Studio 中编写扩展比在 elisp 中编写快速函数甚至新的[次要模式要困难得多。](http://www.cs.cmu.edu/cgi-bin/info2www?(emacs)Minor%20Modes)

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-01-30T17:04:37.800

我认为使用这些基于文本的编辑器（例如 VI 和 Emacs）被高度评价或需要成为“伟大的程序员”，这是一个很大的误解。我一直觉得 IDE 比以前更强大，而且它确实归结为一种偏好和风格。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-27T21:13:51.920

我在大学用过emacs。那是大约 16 年前的事了。我没有回头。虽然我希望我仍然可以对 emacs 感到满意，但事实是我对我的 MS IDE 的工作效率很高。

您发布的文字只是一个巨魔。是的。除了发动一场宗教战争之外，没有其他原因。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-01-27T21:45:21.343

我从 emacs 开始，但切换到 vi，因为它简单，所以对我来说更优雅。此外，如果您陷入单用户模式，ed 命令是 vi 命令的子集。我不知道emacs是否可以处理。

所以在这方面我认为 vi 让你成为一个更好的程序员..

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-27T22:09:26.973

我会说他至少在某种程度上是对的。正如其他人所指出的，与 vim 或 emacs 相比，IDE 中的编辑器有点受限。同时，vim 和 emacs 都可用，当没有机会让一个成熟的 IDE 工作时（例如通过 ssh 会话）。还有一件事是不必伸手去拿鼠标。它确实是一个杀手级功能 - 一个人可以轻松地以至少两倍的速度做事。但是，除非您至少是一个体面的打字员，否则您不会从中受益（顺便说一句，这是 Yegge 在他的博客上明确指出的另一点，您必须打字好）。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-01-28T06:06:00.693

Vi 和 Emacs 之间的比较在*我看来就像是 GNOME 和 KDE 的比较。*Vi（及其方言/实现）是简单、简洁、易于掌握、可编写脚本、可扩展、几乎普遍可用（在所有 Unix 上）的编辑器。另一方面，Emacs，IMO 采取更难的方式来做同样的事情。掌握它需要时间，但我想既然伟大的程序员都使用过它，我在掌握它之后也感觉很棒:-)

但是，当我有基于文本的编辑器时，要完成这项工作，Vi 绝对很容易上手。也许，Emacs 最终会激励你学习 Lisp，这肯定*会*改变你的编程方式。这是间接影响，IMO。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-01-28T06:41:42.460

不

我们都走着不同的人生道路，我们从不同的角度看待问题。

要成为一名优秀的程序员，编辑器不能帮助你变得更好，其他的东西会让你的编程技能更好。但请注意，对您没有帮助的错误工具实际上会阻碍您作为程序员的发展。

或者，如果我们以木匠为例，一把好锤子不能让一个伟大的木匠变得更好，但一把坏锤子可以阻止他尽力而为。

/约翰

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-06-16T18:54:59.277

“你发布的文字只是一个巨魔。是的。除了发动一场宗教战争之外没有其他原因。”

我同意报价。

任何认为程序员的真正附加价值在于该程序员使用的编辑器的人都是白痴。

任何认为一个真正有价值的程序员的真正价值会因为给程序员错误的编辑器而降低的人，都是白痴。

（哦，是的，我可能会在此处包含形式逻辑的练习 - 添加真值以使这些命题与常见逻辑一致:) FORALL 程序员：好（程序员）===> usesEMACS（程序员） FORALL 程序员：usesEMACS（程序员）= ==>好（程序员）（FORALL程序员：好（程序员）===>使用EMACS（程序员））===>（FORALL程序员：使用EMACS（程序员）===>好（程序员））

（至于宗教战争 :) 所有真正有价值的程序员都是在 ISPF 而不是 EMACS 上长大的。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2011-04-15T23:27:03.357

嗯...对我来说，这是一个生产力和享受的问题。

你提到的所有东西，比如智能感知、集成调试器等都可以添加到 Emacs 中。并且可以根据您的口味添加它们。您最终会得到一个满足您需求的环境。这提高了工作效率，因为它也让您可以更轻松地使用最常用的功能。这也提高了你的乐趣，因为你可以修改你的动力过程，从而更好地了解它，最终也会提高你的生产力，因为你更享受你正在做的事情。

此外，您还可以获得视觉工具中没有的功能：不错的键盘支持。我没有尝试过任何一个可视化 IDE，它的键盘支持是不错的。鼠标使用缓慢。我想要一个专家的界面。不是“奶奶的界面”。IDE 旨在成为专家的界面。鼠标不是程序员的专家界面。这是一个颓废且耗时的外围设备，可让您与第一次看到的程序进行交互。

我认为你应该再试一次emacs...我有一些提示要开始：

Mx 允许您在 minibuffer 中输入命令

有用的命令：

*   apropos：列出与某个字符串相关的所有命令
*   describe-function：描述命令的作用
*   where-is：发现给定命令的键盘快捷键
*   global-set-key：将自定义快捷方式关联到给定命令

有用的键盘快捷键：

*   Cx b 选择一个特定的缓冲区
*   C-2 水平分割缓冲区
*   C-3 垂直分割缓冲区
*   Co 在拆分时选择其他缓冲区
*   C-0 拆分缓冲区
*   C- 是您应该定义自定义快捷方式的地方。

有用的插件：支持 ctags。它们允许您跳转到函数/类定义。

*   ido-mode - 在 minibuffer 自动完成模式下更好的完成
*   cua-mode - 类似 Windows 的剪切复制粘贴撤消
*   pc-selection-mode - 移位箭头选择

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2011-04-16T03:22:26.660

披露：我大部分时间都使用 emacs。

我认为不必在使用 emacs 或 IDE 之间进行选择。您可以在 IDE 中使用“emacs”。使用 emacs，一旦您用手指记住了键绑定，您就可以非常高效，并且您会觉得使用任何其他编辑器都无能为力。但是，如果您的 IDE 中提供了许多（遗憾的是并非全部）的 emacs 键绑定，那么您的工作效率将显着提高，并且您不会觉得花在学习 emacs 上的时间被浪费了。

我尝试了 eclipse 的 emacs 插件，我发现它非常有用。当然它并不完美。但是你会得到使用 IDE 的所有好处，比如代码完成、重构等。我希望这个插件得到改进，以提供更多的 emacs 功能。

关于 emacs，遗憾的是，它并没有跟上时代的步伐，坚持下去的程序员会错过很多。

但是，如果您碰巧在 scala 中编程并且是 emacs 爱好者，那么您很幸运，因为您可以将[ensime](https://github.com/aemoncannon/ensime)包用于 emacs 并获得大部分 IDE 功能 --- 语法错误突出显示、代码完成、包浏览、类型检查，重构，调试等。

* * *

## 回答 #37

> 赞同：-2
> 
> 时间：2009-01-27T20:41:53.437

占有是必要的，但还不够；“聪明”部分让我觉得你必须在后面深入研究 Lisp 并彻底掌握前面。

与任何其他编辑器一起“聪明”的开发人员会同样聪明吗？我会说是的。

* * *

## 回答 #38

> 赞同：-2
> 
> 时间：2009-06-16T18:05:26.160

没有冒犯任何人，但这是我很长时间以来听到的最愚蠢的事情。

任何编辑器/IDE 只有在您知道如何使用它时才是好的，这将使您更有效率。对于某些人来说，它是 emacs，对于另一些人来说，它是 Visual Studio，等等。重要的是你从编辑器中获取的内容。

# .net - WinDbg -- TraceListener 和饱和线程池

> ID：485130
> 
> 赞同：0
> 
> 时间：2009-01-27T20:40:32.627
> 
> 标签：.net, windbg, deadlock, trace

我有一个间歇性挂起的多线程 .NET Windows 服务——可能每两周 24/7 运行一次。当挂起发生时，线程池完全饱和，因为对我们自定义跟踪侦听器的调用由于某种原因开始阻塞。根据windbg，违规代码中没有任何锁，也没有任何阻塞，但它们肯定在某个地方阻塞。堆栈上也没有任何异常。在 BufferedStream.Write 代码中偶尔会遇到一个 Thread.Sleep(1)，但我的问题是 ReOpenMetaDataWithMemory、CreateApplicationContext 和 DllCanUnloadNow 是什么意思？

ThreadPool 上几乎所有 2000 个挂起的工作线程（不是正常操作！）都有一个类似于以下的堆栈：

```
0:027> !dumpstack
OS Thread Id: 0x1638 (27)
Child-SP         RetAddr          Call Site
000000001d34df58 0000000077d705d6 ntdll!ZwDelayExecution+0xa
000000001d34df60 000006427f88901d kernel32!SleepEx+0x96
000000001d34e000 000006427f454379 mscorwks!DllCanUnloadNowInternal+0xf53d
000000001d34e080 000006427fa34749 mscorwks!CreateApplicationContext+0x41d
000000001d34e0e0 0000064280184902 mscorwks!ReOpenMetaDataWithMemory+0x1ff59
000000001d34e290 0000064280184532 Company_Common_Diagnostics!Company.Common.Diagnostics.BufferedStream.Write(Byte[], Int32, Int32)+0x1b2
000000001d34e300 00000642801831fd Company_Common_Diagnostics!Company.Common.Diagnostics.XmlRollingTraceListener+TraceWriter.Write(System.String)+0x52
000000001d34e350 00000642801b3304 Company_Common_Diagnostics!Company.Common.Diagnostics.XmlRollingTraceListener.InternalWrite(System.Text.StringBuilder)+0x3d
000000001d34e390 0000064274e9d7ec Company_Common_Diagnostics!Company.Common.Diagnostics.XmlRollingTraceListener.TraceTransfer(System.Diagnostics.TraceEventCache, System.String, Int32, System.String, System.Guid)+0xc4
000000001d34e410 00000642801b2f59 System_ni!System.Diagnostics.TraceSource.TraceTransfer(Int32, System.String, System.Guid)+0x2ec 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-21T23:33:20.430

不是真正的答案，而是要检查的东西...

确保您的跟踪源中还没有注册 DefaultTraceListener。如果您没有明确**清除**或**删除****DefaultTraceListener**它可能仍然存在。**DefaultTraceListener**的IsThreadSafe**属性**返回**false**，在这种情况下 System.Diagnostics.Trace 类围绕**TraceEvent()**调用 创建一个**lock() 。**

**只是需要注意的事情。**

**更多信息：**

 **[TraceListener.IsThreadSafe 属性](http://msdn.microsoft.com/en-us/library/system.diagnostics.tracelistener.isthreadsafe.aspx)

> IsThreadSafe 的值用于确定在写入侦听器时是否使用全局锁。如果 IsThreadSafe 的值为 false，则无论 UseGlobalLock 的值如何，都会使用全局锁。仅当 IsThreadSafe 的值为 true 且 UseGlobalLock 的值为 false 时才使用全局锁。默认行为是在写入侦听器时使用全局锁。

谢谢，亚伦

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T21:37:35.883

事实上，这些函数的偏移量似乎很大（mscorwks！ReOpenMetaDataWithMemory+0x1ff59），我会说你没有 mscorwks 的符号。

使用以下方法设置本地符号存储：

> .symfix+ c:\websymbols
> .reload mscorwks.dll

其中 c:\websymbols 是您为系统符号选择的路径。这应该为您提供合理的函数名称，从中调用 kernel32!Sleep。

至于其余的，所有其他挂起线程的堆栈是什么样的？另外，您也可以发布本机堆栈（kb）吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T23:00:30.787

你是对的。

大约有 2000 个挂起的线程，它们上的堆栈跟踪几乎相同。代码中有一个 KeepAlive 函数，每 1 秒响一次。丁代码周围有一个monitor.tryenter。如果它无法获得锁，它会发出跟踪。这就是所有这些线程正在做的事情。具有锁 (18) 的线程几乎具有相同的堆栈跟踪。

有没有办法在 BufferedStream 类中查看局部变量，看看它是否卡在循环中？

```
0:047> kb
RetAddr           : Args to Child                                                           : Call Site
00000000`77d705d6 : ffffffff`fffffffe 00000000`00000000 00000000`00000000 00000000`1ef7f160 : ntdll!ZwDelayExecution+0xa
00000642`7f88901d : 00000000`00000029 00000642`00000001 00000000`00000000 00000000`1c00f820 : kernel32!SleepEx+0x96
00000642`7f454379 : 00000000`00c70128 00000642`7fa2b159 00000000`00000001 00000000`00000001 : mscorwks!EESleepEx+0x2d
00000642`7fa34749 : 06000000`00000001 00000000`1c00f820 00000000`00c6ff08 00000000`00000001 : mscorwks!Thread::UserSleep+0x71
00000642`80184902 : 00000000`00000001 00000642`782f1950 00000000`015695e0 00000000`00000000 : mscorwks!ThreadNative::Sleep+0xf9
00000642`80184532 : 00000000`00c6fe90 00000642`783924e2 00000000`00db11d8 00000000`00000008 : 0x642`80184902
00000642`801831fd : 00000000`00c6fe90 00000000`00000008 00000642`80043680 00000000`00c02d58 : 0x642`80184532
00000642`74e9e494 : ffffffff`fffffffe 00000000`00000001 0000c0c9`0263a71f 00000642`7f361300 : 0x642`801831fd
00000642`8018d3d3 : 00000000`00c02d58 00000000`00000008 00000000`00000000 00000000`00db11d8 : System_ni+0x61e494
00000642`782f173b : 00000000`00c036a0 00000642`7834901c 00000642`78431598 00000000`77ef9971 : 0x642`8018d3d3
00000642`7834d696 : 00000000`00a061b0 00000000`00400080 00000000`00000000 00000642`7f529408 : mscorlib_ni+0x2f173b
00000642`7f602672 : 00000000`00db0cb8 000007ff`7d370000 000007ff`7d370000 000007ff`fffdb000 : mscorlib_ni+0x34d696
00000642`7f50c053 : 00000642`7f39f3f6 00000000`77dbc178 00000000`00000000 00000000`00000000 : mscorwks!CallDescrWorker+0x82
00000642`7f51449a : 00000000`1ef7f9f8 ffffffff`fffffffe 00000000`00000000 00000000`77d6f447 : mscorwks!CallDescrWorkerWithHandler+0xd3
00000642`7f46b023 : 00000000`00000001 00000000`77d6f491 00000000`00000000 00000000`1ee81000 : mscorwks!DispatchCallDebuggerWrapper+0x3e
00000642`7f41729e : 00000000`1ef7fb88 00000000`1c00f801 00000000`00000001 00000000`1c00f820 : mscorwks!DispatchCallNoEH+0x5f
00000642`7f447ee8 : 00000000`00db0cb8 00000000`00db0cb8 00000000`00000001 00000642`7f50946a : mscorwks!AddTimerCallback_Worker+0x92
00000642`7f556aa9 : 00000000`00000001 00000000`00000000 ffffffff`fffffffe 00000000`1ef7fba8 : mscorwks!Thread::DoADCallBack+0x488
00000642`7f43afdd : 00000000`001597d0 00000000`1c00f820 00000000`1ef7fab0 00000000`0019fcb0 : mscorwks!CNgenEntryBind::Create+0x15d
00000642`7f435296 : 00000000`1ef7fba8 ffffffff`ffffffff 00000000`1c00f820 00000642`7f885bdb : mscorwks!MethodTable::IsAbstract+0x49
0:047> !dumpstack
OS Thread Id: 0x15b0 (47)
Child-SP         RetAddr          Call Site
000000001ef7f138 0000000077d705d6 ntdll!ZwDelayExecution+0xa
000000001ef7f140 000006427f88901d kernel32!SleepEx+0x96
000000001ef7f1e0 000006427f454379 mscorwks!EESleepEx+0x2d
000000001ef7f260 000006427fa34749 mscorwks!Thread::UserSleep+0x71
000000001ef7f2c0 0000064280184902 mscorwks!ThreadNative::Sleep+0xf9
000000001ef7f470 0000064280184532 Company_Common_Diagnostics!Company.Common.Diagnostics.BufferedStream.Write(Byte[], Int32, Int32)+0x1b2
000000001ef7f4e0 00000642801831fd Company_Common_Diagnostics!Company.Common.Diagnostics.XmlRollingTraceListener+TraceWriter.Write(System.String)+0x52
000000001ef7f530 0000064274e9e494 Company_Common_Diagnostics!Company.Common.Diagnostics.XmlRollingTraceListener.InternalWrite(System.Text.StringBuilder)+0x3d
000000001ef7f570 000006428018d3d3 System_ni!System.Diagnostics.TraceSource.TraceEvent(System.Diagnostics.TraceEventType, Int32, System.String)+0x2b4
000000001ef7f620 00000642782f173b Company_Common_Routing_Service!Company.Common.RouterService.KeepAlive(System.Object)+0x2a3
000000001ef7f6f0 000006427834d696 mscorlib_ni!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)+0x9b
000000001ef7f740 000006427f602672 mscorlib_ni!System.Threading._TimerCallback.PerformTimerCallback(System.Object)+0x86
000000001ef7f790 000006427f50c053 mscorwks!CallDescrWorker+0x82
000000001ef7f7e0 000006427f51449a mscorwks!CallDescrWorkerWithHandler+0xd3
000000001ef7f880 000006427f46b023 mscorwks!DispatchCallDebuggerWrapper+0x3e
000000001ef7f8e0 000006427f41729e mscorwks!DispatchCallNoEH+0x5f
000000001ef7f960 000006427f447ee8 mscorwks!AddTimerCallback_Worker+0x92
000000001ef7f9f0 000006427f556aa9 mscorwks!Thread::DoADCallBack+0x488
000000001ef7fa40 000006427f43afdd mscorwks!CNgenEntryBind::Create+0x15d
000000001ef7fb10 000006427f435296 mscorwks!MethodTable::IsAbstract+0x49
000000001ef7fb50 000006427f4162bb mscorwks!AddTimerCallbackEx+0xba
000000001ef7fc10 000006427f495fa7 mscorwks!ThreadpoolMgr::AsyncTimerCallbackCompletion+0x53
000000001ef7fc70 000006427f4aad0a mscorwks!UnManagedPerAppDomainTPCount::DispatchWorkItem+0x157
000000001ef7fd10 000006427f41f9a0 mscorwks!ThreadpoolMgr::WorkerThreadStart+0x1ba
000000001ef7fdb0 0000000077d6b6da mscorwks!Thread::intermediateThreadProc+0x78
000000001ef7ff80 0000000000000000 kernel32!BaseThreadStart+0x3a 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T23:39:42.563

想通了，我相信。我进入 BufferStream 并看到它处于这样一种状态：任何调用 TraceListener 的东西都会卡在 Thread.Sleep(1) 循环中。我希望这是解决方法，因为我无法终生重现该问题。

我在跟踪配置中有 usegloballock=false 和 autoflush=true 。TraceListener 上的 flush 方法不是线程安全的 - 侦听器旨在使用数据缓冲，因此有时 TraceListener 会在刷新和写入并发时处于错误状态。解决方法是简单地设置 autoflush=false。我不敢相信我没有早点抓住这个。

# ruby - 如何获得对方法的引用？

> ID：485151
> 
> 赞同：34
> 
> 时间：2009-01-27T20:44:07.143
> 
> 标签：ruby, methods, hash, reference

是否有可能在 Ruby 中获得对对象方法的引用（我想知道这是否可以在没有 procs/lambdas 的情况下完成），例如，考虑以下代码：

```
 class X
  def initialize
    @map = {}
    setup_map
  end

  private
  def setup_map
    # @map["a"] = get reference to a method
    # @map["b"] = get reference to b method
    # @map["c"] = get referebce to c method
  end

  public
  def call(a)
    @map["a"](a) if a > 10
    @map["b"](a) if a > 20
    @map["c"](a) if a > 30
  end

  def a(arg)
     puts "a was called with #{arg}"
  end

  def b(arg)
     puts "b was called with #{arg}"
  end

  def c(arg)
    puts "c was called with #{arg}"
  end
end 
```

有可能做这样的事情吗？我想避免 procs/lambdas 因为我希望能够通过子类化来改变 A,B,C 的行为。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-27T21:24:48.437

你想要`Object#method`：

```
---------------------------------------------------------- Object#method
     obj.method(sym)    => method
------------------------------------------------------------------------
     Looks up the named method as a receiver in obj, returning a Method 
     object (or raising NameError). The Method object acts as a closure 
     in obj's object instance, so instance variables and the value of 
     self remain available.

        class Demo
          def initialize(n)
            @iv = n
          end
          def hello()
            "Hello, @iv = #{@iv}"
          end
        end

        k = Demo.new(99)
        m = k.method(:hello)
        m.call   #=> "Hello, @iv = 99"

        l = Demo.new('Fred')
        m = l.method("hello")
        m.call   #=> "Hello, @iv = Fred" 
```

现在您的代码变为：

```
private
def setup_map
  @map = {
    'a' => method(:a),
    'b' => method(:b),
    'c' => method(:c)
  }
  # or, more succinctly
  # @map = Hash.new { |_map,name| _map[name] = method(name.to_sym) }
end

public
def call(arg)
  @map["a"][arg] if arg > 10
  @map["b"][arg] if arg > 20
  @map["c"][arg] if arg > 30
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T20:48:21.660

您可以使用 lambdas 做到这一点，同时保持更改子类行为的能力：

```
class X
  def initialize
    @map = {}
    setup_map
  end

  private
  def setup_map
    @map["a"] = lambda { |a| a(a) }
    @map["b"] = lambda { |a| b(a) }
    @map["c"] = lambda { |a| c(a) }
  end

  public
  def call(a)
    @map["a"].call(a) if a > 10
    @map["b"].call(a) if a > 20
    @map["c"].call(a) if a > 30
  end

  def a(arg)
     puts "a was called with #{arg}"
  end

  def b(arg)
     puts "b was called with #{arg}"
  end

  def c(arg)
    puts "c was called with #{arg}"
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T21:03:49.647

Ruby 方法不是一流的对象。它通过消息传递实现OO。

```
class X
  def call(a)
    self.send(:a, a) if a > 10
    self.send(:b, a) if a > 20
    self.send(:c, a) if a > 30
  end

  def a(arg)
     puts "a was called with #{arg}"
  end

  def b(arg)
     puts "b was called with #{arg}"
  end

  def c(arg)
    puts "c was called with #{arg}"
  end
end 
```

或者直接打电话给他们：

```
def call(a)
  self.a(a) if a > 10
  self.b(a) if a > 20
  self.c(a) if a > 30
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-15T05:32:44.777

您可以通过 获取对该方法的引用`object.method(:method_name)`。

例如：获取对`system`方法的引用。

```
m = self.method(:system)
m.call('ls') 
```

# c++ - C/C++ 性能全局变量与获取/设置方法

> ID：485155
> 
> 赞同：3
> 
> 时间：2009-01-27T20:45:09.747
> 
> 标签：c++, c, performance, methods, global

我看到这个问题询问[全局变量是否不好](https://stackoverflow.com/questions/484635/are-global-variables-bad)。

当我考虑它的后果时，我能提出的唯一论点是它们在某些情况下是必要的，这可能是出于性能原因。

但是，我不太确定。所以我的问题是，使用全局会比使用 get/set 方法调用更快吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-27T20:48:40.193

一个好的现代编译器应该内联 get/set 方法调用，这样可能没有真正的区别。

几乎在任何情况下，担心静态/全局变量是否会让您头疼比担心性能影响更重要，因为性能影响无论如何都几乎无法检测到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T21:00:54.663

通过用汇编程序编写，您可以获得更多性能。而且还会浪费更多时间来调试代码。

这是完全相同的交易类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T21:12:49.880

更合适的比较是访问全局*（静态）*和本地。

实际上，全局更快，因为访问局部需要将变量偏移量添加到堆栈指针的值。

但是，您*永远*不需要担心这一点。尝试专注于重要的事情，例如使您的代码可读、可写和工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T20:52:28.470

它可能会稍微快一点，但速度不会有很大的提高。不过，全局变量对所有事物都具有 getter 和 setter 函数确实可以减小应用程序的大小。这种类型的大小节省是否对您的应用程序有益与您的目标平台相关。例如，在开发嵌入式应用程序、内存有限的平台时，它可能是一个可行的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T22:26:16.440

这取决于 CPU 和编译器。在至少一个流行的 PPC 芯片组上，加载全局变量需要额外的指令，因为它不能以 16 位相对偏移量编码。

此外，它可能会对缓存局部性产生巨大影响和/或破坏任何假设没有混叠的优化。假设全局变量可以提高性能有点幼稚。

# asp.net - ASP.NET - 在默认模拟用户时临时模拟应用程序池服务 ID？

> ID：485160
> 
> 赞同：2
> 
> 时间：2009-01-27T20:45:49.480
> 
> 标签：asp.net, sharepoint, impersonation

我必须调用 SharePoint 站点中的一些代码，这些代码在运行 Web 应用程序的同一服务 ID 下运行。默认情况下，SharePoint 会模拟查看网页的用户，而用户没有必要的权限。

使用 Web 应用程序的服务 ID 运行一些代码，然后恢复使用默认模拟的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T20:56:59.460

[SPSecurity.RunWithElevatedPrivileges](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsecurity.runwithelevatedprivileges.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T00:29:05.597

纳特是对的。您应该使用 SPSecurity.RunWithElevatedPrivileges。在幕后，它执行了 Anthony 提到的 ReverToSelf，但使用辅助方法要容易得多。您可以使用内联委托，如下例所示。

要实现的主要事情是这个委托在一个单独的应用程序域下运行，这基本上意味着您想要使用 SPSite 或 SPWeb，您必须在委托中重新实例化它们，如下所示。

```
SPSecurity.RunWithElevatedPrivileges(delegate()
{
    // Your are now inside the delegate
    // Anything provided within this block is marshaled across the app domain
    using (SPSite site = new SPSite("http://myserver/sites/mysite"))
    {
        using (SPWeb web= site.OpenWeb())
        {
            // Do stuff here
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T21:05:31.970

在 ASP 下，我有一个实用程序 DLL，我可以使用它来调用 Win32 的 RevertToSelf() 函数（在 advapi32.dll 中找到），以使 ASP 在应用程序池的标识下运行。

当然，一旦到达那里，就无法回到线程使用的原始身份，但这并不是真正的问题。当前请求结束后，下一个请求将以用户身份（或匿名用户）再次运行。

您可能可以对 ASP.NET 中的 PInvoke 执行相同的操作，但我不知道这可能对框架产生什么影响。我敢肯定它只会持续到当前的请求。我认为没有任何标准的.NET API 可以做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T22:42:59.517

简单的！将您正在进行的调用包装在 HostingEnvironment.Impersonate() 块中。

[http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.impersonate.aspx](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.impersonate.aspx)

# ruby-on-rails - 在 Rails 应用程序中访问 Word 文档

> ID：485170
> 
> 赞同：0
> 
> 时间：2009-01-27T20:48:31.130
> 
> 标签：ruby-on-rails, ms-word

我有许多文档（主要是 Word 和 Excel），我想将它们提供给我的 Rails 应用程序的用户。但是，我以前从未尝试过这样的事情，并且想知道最好的方法是什么？鉴于只有少量 Word 文档，并且全部由我上传，我是将它们存储在我的 Rails 应用程序中的某个位置（即公共/文档或类似文件）还是应该设置一个单独的 FTP 并链接到那？也许有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T21:17:55.783

我会按照你的建议去做，并将它们放在 public/docs 中。如果您计划为文件制作概览/索引页面并直接链接到它们，那么将它们存储在本地而不是远程 FTP 服务器会更容易。但是，由于您是上传和维护这些文件的人，我认为您应该选择对您来说最简单的选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T00:51:59.313

如果要公开访问它们，您肯定只想将它们粘贴在`public`某个地方。编写一个小助手来根据您希望在应用程序中引用它们的方式为您生成 URL，以保持整洁（因此，如果您稍后更改 URL，例如[存储文件以控制目录大小](http://www.anchor.com.au/hosting/dedicated/efficient_file_storage#head-0223cc36898f2a8676ccf5fdf47f6df9ebee95db)，您不必更改整个应用程序的链接，只需在一个地方即可。

另一方面，如果您的文件仅适用于已登录的用户，则您需要使用类似[`send_file`](http://api.rubyonrails.org/classes/ActionController/Streaming.html#M000266)的方法来完成这项工作，或者使用特定于网络服务器的方法之一（如`X-Sendfile`标头）来检查用户是否有权查看文件，然后再发回给他们。

# c# - 检查浮点值是否等于 0 是否安全？

> ID：485175
> 
> 赞同：106
> 
> 时间：2009-01-27T20:50:14.620
> 
> 标签：c#, .net, floating-point, precision, zero

我知道您通常不能依赖 double 或 decimal 类型值之间的相等性，但我想知道 0 是否是一种特殊情况。

虽然我可以理解 0.00000000000001 和 0.00000000000002 之间的不精确性，但 0 本身似乎很难搞砸，因为它什么都不是。如果你什么都不精确，那它就不再是什么了。

但我对这个话题了解不多，所以不由我说。

```
double x = 0.0;
return (x == 0.0) ? true : false; 
```

这总是会返回真实的吗？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-01-27T22:58:04.253

可以**安全**地预期，`true`当且仅当 double 变量的值恰好为时`0.0`（在您的原始代码片段中当然是这种情况），比较才会返回。这与运算符的语义一致`==`。`a == b`表示“`a`等于`b`”。

当纯数学中相同计算的结果为零时，期望某些计算的结果在双精度（或更一般地，浮点）算术中为零是**不安全**的（因为它是**不正确的）。**这是因为当计算落地时，会出现浮点精度误差——这是数学实数算术中不存在的概念。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-01-27T23:06:54.110

如果您需要进行大量“相等”比较，最好在 .NET 3.5 中编写一些辅助函数或扩展方法进行比较：

```
public static bool AlmostEquals(this double double1, double double2, double precision)
{
    return (Math.Abs(double1 - double2) <= precision);
} 
```

这可以通过以下方式使用：

```
double d1 = 10.0 * .1;
bool equals = d1.AlmostEquals(0.0, 0.0000001); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-27T20:58:16.633

对于您的简单样本，该测试是可以的。但是这个呢：

```
bool b = ( 10.0 * .1 - 1.0 == 0.0 ); 
```

请记住，0.1 是二进制重复的十进制数，不能精确表示，就像尝试将 1/3 写为以 10 为底的十进制数一样。现在将其与此代码进行比较：

```
double d1 = 10.0 * .1; // make sure the compiler hasn't optimized the .1 issue away
bool b = ( d1 - 1.0 == 0.0 ); 
```

我会让您进行测试以查看实际结果：您更有可能以这种方式记住它。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-27T20:56:03.360

[从Double.Equals](http://msdn.microsoft.com/en-us/library/ya2zha7s.aspx)的 MSDN 条目中：

> **比较精度**
> 
> 应谨慎使用 Equals 方法，因为由于两个值的精度不同，两个明显等效的值可能不相等。下面的示例报告 Double 值 .3333 和通过将 1 除以 3 返回的 Double 不相等。
> 
> ...
> 
> 一种推荐的技术不是比较相等性，而是定义两个值之间的可接受差异范围（例如其中一个值的 0.01%）。如果两个值之间的差值的绝对值小于或等于该余量，则差异可能是由于精度差异造成的，因此这些值很可能相等。下面的示例使用此技术比较 .33333 和 1/3，这是前面的代码示例发现不相等的两个 Double 值。

另请参阅[Double.Epsilon](http://msdn.microsoft.com/en-us/library/system.double.epsilon.aspx)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-09-08T12:55:34.513

当您比较不同类型的浮点值实现时会出现问题，例如将浮点数与双精度数进行比较。但是同类型的应该问题不大。

```
float f = 0.1F;
bool b1 = (f == 0.1); //returns false
bool b2 = (f == 0.1F); //returns true 
```

问题是，程序员有时会忘记隐式类型转换（double to float）是为了比较而发生的，这会导致错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-27T22:07:08.943

如果数字直接分配给浮点数或双精度数，则可以安全地针对零或任何整数进行测试，对于双精度数或浮点数可以以 53 位或 24 位表示。

或者换一种说法，您始终可以将整数值分配给双精度，然后将双精度与相同的整数进行比较，并保证它是相等的。

您也可以从分配一个整数开始，并通过坚持加、减或乘以整数来继续进行简单的比较（假设结果小于 24 位浮点数和 53 位双精度数）。因此，您可以在某些受控条件下将浮点数和双精度数视为整数。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-10T15:27:05.287

不，这样不行。所谓的非规格化值（次正规），当比较等于 0.0 时，会比较为假（非零），但在等式中使用时会被标准化（变为 0.0）。因此，将其用作避免被零除的机制是不安全的。相反，添加 1.0 并与 1.0 进行比较。这将确保所有次正规都被视为零。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2018-06-19T08:21:22.497

试试这个，你会发现 == 对于 double/float 是不可靠的。
`double d = 0.1 + 0.2; bool b = d == 0.3;`

这是来自Quora的[答案。](https://www.quora.com/Why-is-0-1+0-2-not-equal-to-0-3-in-most-programming-languages#)

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2011-12-15T17:22:24.450

实际上，我认为最好使用以下代码将双精度值与 0.0 进行比较：

```
double x = 0.0;
return (Math.Abs(x) < double.Epsilon) ? true : false; 
```

浮点数相同：

```
float x = 0.0f;
return (Math.Abs(x) < float.Epsilon) ? true : false; 
```

# google-app-engine - appengine 网站的架构指南？

> ID：485178
> 
> 赞同：4
> 
> 时间：2009-01-27T20:50:34.433
> 
> 标签：google-app-engine, architecture

我使用 PHP 创建了不可维护的网站，因为它很容易做事又快又脏。我不想在 Google 的 appengine 上对 Python/Django 做同样的事情。

使用 Django 和 appengine 创建网站有什么好的架构参考吗？（例如，业务逻辑放在哪里，数据访问逻辑放在哪里，如何干净地分离视图，如何进行单元测试等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T21:23:57.320

如果您决定**不**使用 Django，来自 Werkzeug 团队的[这些提示可能会很有趣。](http://werkzeug.pocoo.org/documentation/organizing)这种应用程序结构从 Django 中汲取了最好的东西，但让您对实际布局有完全的自由（`models.py`即使您在应用程序中没有任何模型也不需要......）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T20:54:39.683

Django 就其本质而言，会让你更难把东西放在错误的地方。这是新一代 MVC 框架的一个很酷的地方，你必须努力创造一个泥球。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T05:24:12.587

如前所述，通过选择 Django，您已经在避免意大利面方面迈出了一大步。Django 为您提供了一个 MVC 框架（[模型模板视图](http://jeffcroft.com/blog/2007/jan/11/django-and-mtv/)是 Django 特定的）。因此，您现在的工作是**学习**并正确遵循 Django 指导您的 MVC 设计模式。您放置业务逻辑的位置将取决于您的特定应用程序和要求。在某些情况下，一些业务逻辑被放置在模型中更靠近数据的位置，而在其他时候，它被放置在控制器中。此外，GAE 不需要 Django，在某些情况下，GAE 的 webapp 框架就足够了。

# c++ - C++ 相当于 Python 的文档测试？

> ID：485179
> 
> 赞同：12
> 
> 时间：2009-01-27T20:50:40.547
> 
> 标签：c++, doctest

我认为[Python 的 doctests](http://docs.python.org/library/doctest.html)的概念很棒，作为实时商店的 C++ 程序员，我非常嫉妒。我们基本上没有单元测试能力，这是一个严重的障碍。我见过 C++Unit 等，但是有什么东西可以从 Python 的 doctests 之类的注释中提取测试用例，而不是直接将它们放入代码中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-05-22T13:05:33.763

我刚刚发布了[doctest](https://github.com/onqtam/doctest) - 最轻量级的功能丰富的 C++ 单头测试框架。

它不是用于在注释中编写测试 - 而是用于直接在生产代码中编写测试。它不能完全满足您的需求，但它仍然是 C++ 中的最佳选择，无需预处理步骤

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-05-30T02:41:02.013

您可能会发现这很有用。在我自己的代码中需要它之后，我开始开发它。

[http://github.com/panyam/DocTestPlusPlus](http://github.com/panyam/DocTestPlusPlus)

它是一个 Python 脚本，它会检查您的评论并提取测试并生成测试文件。

仍在开发和测试中。感谢任何和所有反馈。

干杯斯里

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T21:34:38.743

我刚刚看了一下doctest，它确实很棒。Python 语言的易用性方法也是如此。

但是，对于 C++，您可能找不到这样的工具。

如果其中一项测试失败，您可能需要调试发生的情况。从评论中生成测试用例的来源并不是那么容易。相反，在现有的 C++ 单元测试框架中，您拥有具有特殊语法的测试源，该语法经过编译且易于调试。此外，从评论中生成源代码将是另一个额外的（预）编译步骤，这只会让生活变得更加困难。

您应该接受 C++ 中的编码不像 Python 中那样快速，因此单元测试同样有些困难。另一方面，你有更多的工具，你可以为类型关系放置静态断言，例如，这在 Python 中是不可能的。

简而言之，我认为 C++ 的 Python doctest 的类似物与现有工具相比会有很多缺点，以至于没有人开始实施它。

如果您真的相信它可以比现有工具更好，请提供一些示例。我几乎不相信在现实生活中它可以更有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T22:20:43.877

我正在考虑从评论中生成[CxxTest](http://cxxtest.tigris.org/)文件。我没有使用过那个框架，但它看起来很有希望。从他们的[手册](http://cxxtest.com/guide.html#TOC5)中，单元测试文件看起来像这样：

```
 // MyTestSuite.h
 #include <cxxtest/TestSuite.h>

 class MyTestSuite : public CxxTest::TestSuite 
 {
 public:
    void testAddition( void )
    {
       TS_ASSERT( 1 + 1 > 1 );
       TS_ASSERT_EQUALS( 1 + 1, 2 );
    }
 }; 
```

我的建议是一个解析器，它可以从注释中提取那些 testX 函数的内容，而不必编写整个内容。例如（我只是在这里编写注释语法，可能有一种更简洁的方式来编写它）：

```
// MyRegularCode.cpp

/// Description of the function here
/// Then test case below that gets extracted
/// and turned into CxxTest .h files
/**testAddition
MyClass mc;
mc.MyFunction();
TS_ASSERT( mc.m_value > 1 );
TS_ASSERT_EQUALS( mc.m_value, 3 );
**/
void MyClass::MyFunction()
{
    m_value = 3;
}; 
```

我不确定 CxxTest 更强大的方面将如何实现，例如创建固定装置，但这样的事情可能会在 C++ 世界中提供 python 文档字符串和文档测试的共同性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T22:29:20.037

我知道将东西放入真实代码注释中的旧技巧（IIRC，这是*编程实践的*一部分）。但是，将单元测试简单地放在`#ifdef`块中可能更容易。对于这类事情，您通常可以自行运行预处理器。

再说一次，我知道有[一个项目](http://www.sidhe.org/~dan/blog/archives/000462.html)使用 Perl 作为超级预处理器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-24T09:54:52.580

[Fost](http://support.felspar.com/Fost%204)附带的测试框架确实处理了一些非常相似的事情。测试不会嵌入到文档中，但它们可以与测试的代码并排放置。在结构上，测试看起来与 cxxtest 代码非常相似。

```
#include "myclass.hpp"
#include <fost/test>

FSL_TEST_SUITE( myclass );

/*
    Your documentation
*/
FSL_TEST_FUNCTION( constructors ) {
    fostlib::test::default_constructable< myclass >();
}
myclass::myclass() {
}

FSL_TEST_FUNCTION( some_method ) {
    myclass instance;
    FSL_CHECK_NOTHROW( instance.some_method(0) );
    FSL_CHECK_EQ( instance.some_method(2), 2 );
    FSL_CHECK_NEQ( instance.some_method(-2), 0 );
}
int myclass::some_method( int arg ) {
    // implementation
} 
```

所有这些都是用嵌入的测试编译的（你可以通过#define 从构建中删除它们——没有实现，但很容易做到）。然后通过一个单独的程序运行测试，该程序加载已构建的 .DLL 或 .so，找到测试并运行它们。

我们还没有尝试过，但它应该可以与静态库一起使用，并且可以在 Windows 上的 .EXE 文件中动态加载和运行测试，但我不太确定它是否可以在 Linux 或 Mac 上完成。

# c# - 为什么不使用类型后缀就不能直接将带小数点的数字分配给十进制类型？

> ID：485185
> 
> 赞同：66
> 
> 时间：2009-01-27T20:51:54.850
> 
> 标签：c#

为什么不使用类型后缀就不能直接将带小数点的数字赋给十进制类型呢？这种数字不被认为是十进制类型的数字吗？

```
decimal bankBalance = 3433.20; // ERROR! 
```

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-01-27T20:57:30.427

**编辑**：我可能错过了问题的最后一部分，所以下面的概述几乎没有用。

无论如何，你不能做你想做的事情的原因是因为浮点类型和`decimal`. 但是，您可以从整数分配它，因为存在从 int 到十进制的隐式转换。

* * *

你可以，但你必须使用这个语法（或做一个明确的转换为十进制）。

```
decimal bankBalance = 3433.20m; 
```

对于花车来说

```
float bankBalance = 3433.20f; 
```

默认为双

```
double bankBalance = 3444.20; 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-27T23:30:20.740

实际上，隐藏的规格功能：您可以；-p

```
decimal bankBalance = (decimal)3433.20; 
```

这被编译器真正解析为十进制（不是浮点数和强制转换）。参见 IL 来证明这一点。请注意，精度会被截断（这有 1 个十进制数字，而不是您从`M`版本中获得的 2）。

IL生成：

```
L_0001: ldc.i4 0x861c
L_0006: ldc.i4.0 
L_0007: ldc.i4.0 
L_0008: ldc.i4.0 
L_0009: ldc.i4.1 
L_000a: newobj instance void [mscorlib]System.Decimal::.ctor(int32, int32, int32, bool, uint8)
L_000f: stloc.0 
```

相比：

```
decimal bankBalance = 3433.20M; 
```

生成：

```
L_0001: ldc.i4 0x53d18
L_0006: ldc.i4.0 
L_0007: ldc.i4.0 
L_0008: ldc.i4.0 
L_0009: ldc.i4.2 
L_000a: newobj instance void [mscorlib]System.Decimal::.ctor(int32, int32, int32, bool, uint8)
L_000f: stloc.0 
```

唯一的区别是十进制数字（1 对 2，相应的因子为 10）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-27T20:58:15.307

这

```
decimal bankBalance = 3433.20M; 
```

将工作。原因是 float 和 decimal 是非常不同的类型。float 将为您提供与您输入的数字非常接近的近似值，但 decimal 将为您提供确切的数字。99% 的时间你不会注意到差异，应该只使用浮点数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-11-21T08:57:58.583

您的回答包括两个重点：

1.  所有带小数点的数字文字都被`double`C# 编译器推断为类型，因此默认情况下`3433.20`是 a `double`。

2.  `double`数字不会隐式转换为，`decimal`因为虽然它`decimal`比`double`它涵盖的***范围更短***更精确，所以在从双精度到十进制的转换过程中可能会溢出。

`double`的范围：`±(~10^−324 to 10^308)`有效数字为 15 位或 16 位。

`decimal`的范围：`±(~10^-28 to 10^28)`有效数字为 28 或 29。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-27T20:58:39.330

请参阅有关[十进制](http://msdn.microsoft.com/en-us/library/364x0z75(VS.80).aspx)的 MSDN 页面，该页面解释了普通浮点类型和十进制之间没有隐式转换。

尝试

`decimal bankBalance = 3433.20m;`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-19T12:20:52.587

在很多情况下，我真的很喜欢[Convert 类。](https://docs.microsoft.com/en-us/dotnet/api/system.convert)它非常可靠。

十进制银行余额 = Convert.ToDecimal(3433.20);

# database - 为 Sybase 表和索引生成 DDL

> ID：485192
> 
> 赞同：1
> 
> 时间：2009-01-27T20:52:55.270
> 
> 标签：database, sybase, ddl, operations

我正在寻找一个命令行工具来为我处理的数据库中的一些 Sybase 表生成表和索引的 DDL（不需要更复杂的东西）。我可以访问用于查看单个 DDL 的 GUI 工具，并且可以剪切和粘贴它们，但是我想要一些能够遍历数据库中所有表并生成一些可以签入 CVS 的漂亮文本文件的东西。

我尝试使用 Sybase 提供的名为 的工具`ddlgen`，但它只是抛出如下异常：

```
bash-3.00# ./ddlgen -SdatabaseServer:4100 -Uusername -PsecretPassword -TDB -NdatabaseName 
U64: null: databaseName.dbo.firstTable
U64: null: databaseName.dbo.firstTable
        at com.sybase.ddlgen.container.UserTableContainer.getDependentDDL(UserTableContainer.java:1065)
        at com.sybase.ddlgen.container.UserTableContainer.open(UserTableContainer.java:1364)
        at com.sybase.ddlgen.container.UserTableMetaContainer.open(UserTableMetaContainer.java:94)
        at com.sybase.ddlgen.container.DDLBaseContainer.load(DDLBaseContainer.java:76)
        at com.sybase.ddlgen.container.DatabaseContainer.addChildren(DatabaseContainer.java:552)
        at com.sybase.ddlgen.container.DatabaseContainer.open(DatabaseContainer.java:104)
        at com.sybase.ddlgen.container.DatabaseMetaContainer.open(DatabaseMetaContainer.java:114)
        at com.sybase.ddlgen.DDLThread.run(DDLThread.java:89) 
```

这不是很有帮助。我一直在想一定有一个很好的 Perlish 方式来做到这一点，但我不知道那会是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T17:46:56.837

使用以下命令获取定义

defncopy -P tester1 -S sqppdb2 -U pmestr -D ppdb2 -o tab4 ppdb2..tab4

谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T21:43:55.227

您还可以使用基于 Perl 的 dbschema.pl

[http://www.isug.com/Sybase_FAQ/ASE/section9.html#9.3.2](http://www.isug.com/Sybase_FAQ/ASE/section9.html#9.3.2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T20:00:30.163

ddlgen 会给你你需要的东西，而且效果很好。您似乎遇到了 Java 的环境问题。再试一次并完整地发布您遇到的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T10:27:13.457

另一种方法是[MyGeneration](http://www.mygenerationsoftware.com)一个代码生成器（类似于 CodeSmith，但开源），它使用模板来创建代码。该代码可以是您喜欢的任何代码 - Sql、C# 等。我使用 Sql Server，并且我使用了一些免费提供的模板来创建您指定的 DDL，并自动创建 NHibernate 映射文件 - 太棒了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T21:25:44.160

[下载Embarcadero DBArtisan](http://www.embarcadero.com/products/dbartisan/)的评估版并使用其提取功能来获取 DDL。

您可以在 DBArtisan (Logfile -> Log SQL) 中打开 Logging，然后查看它发送到 Sybase 以获取表 DDL 的 SQL。将日志文件中的 SQL 复制并粘贴到您从命令行运行且可能有效的脚本中。

如果您不使用 Windows，请提前道歉...DBArtisan 仅适用于 Windows。

# c# - 在特定情况下自动滚动列表框

> ID：485196
> 
> 赞同：9
> 
> 时间：2009-01-27T20:53:32.727
> 
> 标签：c#, listbox, scroll

添加新项目后如何自动滚动列表框，但前提是在添加项目之前滚动条位于底部？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T14:07:25.423

你可以试试：

```
listBox1.SelectedIndex = listBox1.Items.Count - 1;    
listBox1.SelectedIndex = -1; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-03T22:40:27.883

此示例代码应该可以帮助您。我已经用 TextBox 做了很多次，但花了一段时间才弄清楚 ListBox

显然，它只是一个带有 Button 和 ListBox 的 Form。修改以满足您的需求：

```
private void button1_Click(object sender, EventArgs e)
{
    listBox1.Items.Add("Some Text " + listBox1.Items.Count.ToString());

    //The max number of items that the listbox can display at a time
    int NumberOfItems = listBox1.ClientSize.Height / listBox1.ItemHeight;

    if (listBox1.TopIndex == listBox1.Items.Count - NumberOfItems - 1)
    {
        //The item at the top when you can just see the bottom item
        listBox1.TopIndex = listBox1.Items.Count - NumberOfItems + 1;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-26T19:31:09.463

我想出了以下解决方案，它也适用于具有可变高度项的所有者绘制的列表框。

基本思想是，它通过使用 IndexToPoint 方法和列表框底部的一个点来判断它是否滚动到底部，以查看最后一项是否在该位置。这有一个小缺陷，如果最后一个项目位于底部但不完全可见，它仍会认为它已滚动到底部。

它使用 TopIndex 属性来滚动列表框。请注意，将 TopIndex 设置为列表框中的最后一项时，如果有足够的空间容纳其他项，它实际上不会将其放在顶部。在这种情况下，它将把它放在底部，这就是你想要的。

它还有一些额外的代码，通过在列表填满后删除顶部的项目，将列表中的项目数量保持在最大数量（由常量 MAX_LISTBOX_ITEMS 在其他地方定义）。当它这样做时，它会找出需要滚动列表的位置，以保持相同的项目即使在删除后仍显示。如果您不关心控制添加到列表框中的项目数量，您应该能够从代码中删除中间的 if 子句以及任何提到的 scrollToIndex 变量。

```
private void AddItemToListBox(ListBox listBox, object newItem)
    {
        int scrollToIndex = -1;
        bool scrollToEnd = false;

        //Work out if we should scroll to the end after adding a new item
        int lastIndex = listBox.IndexFromPoint(4, listBox.ClientSize.Height - 4);
        if ((lastIndex < 0) || (lastIndex == listBox.Items.Count - 1))
        {
            scrollToEnd = true;
        }

        //To prevent listbox jumping about as we delete and scroll
        listBox.BeginUpdate();

        //Work out if we have too many items and have to delete
        if (listBox.Items.Count >= MAX_LISTBOX_ITEMS)
        {
            //If deleting an item, and not scrolling to the end when new item added anyway,
            //then we will need to scroll to keep in the same place, work out new scroll index
            if (!scrollToEnd)
            {
                scrollToIndex = listBox.TopIndex - 1;
                if (scrollToIndex < 0)
                {
                    scrollToIndex = 0;
                }
            }

            //Remove top item
            listBox.Items.Remove(listBox.Items[0]);
        }

        //Add new item
        listBox.Items.Add(newItem);

        //Scroll if necessary
        if (scrollToEnd)
        {
            listBox.TopIndex = listBox.Items.Count - 1;
        }
        else if (scrollToIndex >= 0)
        {
            listBox.TopIndex = scrollToIndex;
        }

        listBox.EndUpdate();
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-03T03:17:06.847

我使用与 colithium 类似的方法解决了这个问题，但后来我意识到并发更新存在错误。所以有一个名为 m_previousCount 的类成员，它存储了更新发生之前 ListBox 中的项目数。

我用 ListView 做到了这一点，但它应该对 ListBox 起作用。

在这种情况下，我的 listView1 内容绑定到 listViewModel1.Entries。

```
private void EventMessageViewModel_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
{
    listView1.Dispatcher.BeginInvoke(DispatcherPriority.Background, new ScrollToLastItemDelegate(ScrollToLastItem)); 
}

/// <summary>
/// Scroll to last item, unless you have scrolled up the list
/// </summary>
private void ScrollToLastItem()
{
    // Get scrollviewer
    Decorator border = System.Windows.Media.VisualTreeHelper.GetChild(listView1, 0) as Decorator;
    ScrollViewer scrollViewer = border.Child as ScrollViewer;

    double vo = scrollViewer.VerticalOffset;

    // assume they are all the same height
    ListBoxItem lbi = listView1.ItemContainerGenerator.ContainerFromIndex(0) as ListBoxItem;

    //The max number of items that the listbox can display at a time
    double NumberOfItemsOnScreen = listView1.ActualHeight / lbi.ActualHeight;

    // use previousCount in case we get multiple updates in one go
    if (m_previousCount > NumberOfItemsOnScreen) // scrollbar should be active
    {
        if (vo < (m_previousCount - NumberOfItemsOnScreen)) // you're not at the bottom
        {
            return; // don't scroll to the last item
        }
    }

    m_previousCount = listView1.Items.Count;

    // scroll to the last item
    listView1.SelectedItem = listView1.Items.GetItemAt(listViewModel1.Entries.Count - 1);

    listView1.ScrollIntoView(listView1.SelectedItem);
} 
```

# c# - 切换到设计模式时，带有 SP1 的 Visual Web Developer Express 崩溃

> ID：485209
> 
> 赞同：0
> 
> 时间：2009-01-27T20:55:29.320
> 
> 标签：c#, asp.net

我最近刚刚升级到使用带有 Service Pack 1 的 Visual Studio Express Edition。以前我使用的是 Express Edition 减去 Service Pack。C++ 和 C# 的 IDE 对我来说运行良好，但是在运行 Visual Web Developer IDE 时，当我尝试在任何页面上切换到设计模式时都会崩溃。

我已经能够追踪到发生此崩溃的特定行和模块。它来自 DLL fpacutl.dll 的文件 afxcrit.cpp。发生崩溃的相关功能如下...

```
void AFXAPI AfxLockGlobals(int nLockType)
{
    ENSURE((UINT)nLockType < CRIT_MAX);

    // intialize global state, if necessary
    if (!_afxCriticalInit)
    {
        AfxCriticalInit();
        ASSERT(_afxCriticalInit);
    }

    // initialize specific resource if necessary
    if (!_afxLockInit[nLockType])
    {
        EnterCriticalSection(&_afxLockInitLock);
        if (!_afxLockInit[nLockType])
        {
            InitializeCriticalSection(&_afxResourceLock[nLockType]);
            VERIFY(++_afxLockInit[nLockType]);
        }
        LeaveCriticalSection(&_afxLockInitLock);
    }

    // lock specific resource
    EnterCriticalSection(&_afxResourceLock[nLockType]); // <--- CRASH HERE !!!
#ifdef _DEBUG
    ASSERT(++_afxResourceLocked[nLockType] > 0);
#endif
} 
```

非常感谢任何帮助/想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T16:18:28.867

好吧，计算机最终还是像往常一样丢失了！我发现这个帖子很有帮助，因为有很多人发布了与我非常相似的问题......

[http://forums.asp.net/t/1186584.aspx?PageIndex=1](http://forums.asp.net/t/1186584.aspx?PageIndex=1)

在第一页有以下建议......

> 确保 Microsoft Web 创作组件出现在控制面板中。如果是，请卸载它。转到 VS DVD 中的 WCU\WebToolsCore\en-us 并运行 WebToolsCore.exe。设置没有用户界面，大约需要 10 分钟才能完成。验证 Web 创作组件是否出现在控制面板中。再次尝试去DV。

我遵循了这个建议并卸载了“Microsoft Web Authoring Component”，但是我在快速安装光盘中找不到“WebToolsCore”文件夹，如详细信息中所述。但是我确实找到了文件夹“ *X:\VWDExpress\WCU\WebDesignerCore* ”。弄清楚这与我安装的*WebDesignerCore.EXE*和*WebDesignerCore_KB945140.EXE*几乎相同，它们都在 WebDesignerCore 文件夹中。它是一个静默安装，所以看起来没有立即生效，但是当我进入 Visual Web Developer 并切换到设计模式时成功！有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T22:14:53.577

无论如何，您的安装是定制的吗？是否安装了 VS 插件等？如果是这样，请尝试将它们一一删除和/或将所有应用程序设置恢复为默认值。我对特快版不太熟悉，所以我不确定它们支持什么样的定制。

如果一切都失败了，我不想这么说，但是......

1) 确保您的所有工作都安全地与应用程序文件夹分开保存和/或备份

2) 卸载应用程序（如果提供卸载选项，请使用最完整的一个，例如删除所有文件、设置、首选项等）

3) 重启

4）运行[CCleaner](http://www.ccleaner.com/)（文件删除和注册表修复程序）

5) 重启

6）重新安装

这是我尝试和测试的后备方法，用于简单地“所有其他方法都失败”。除非软件中存在真正的错误，否则它通常可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-22T22:10:22.823

您实际上不必删除 Microsoft Web 创作组件。从添加/删除程序对话框进行简单修复就可以了。

# coldfusion - 当需要 var 作用域时，如何在 n-recordsets 上使用 query-of-query UNION？

> ID：485212
> 
> 赞同：5
> 
> 时间：2009-01-27T20:56:16.077
> 
> 标签：coldfusion, cfquery, qoq

我希望能够对 UNION 未知数量的记录集进行查询。但是，在进行查询查询时，记录集名称中不允许使用点或括号。

例如，这失败了：

```
<cfquery name="allRecs" dbtype="query">
    SELECT * FROM recordset[1]
    UNION
    SELECT * FROM recordset[2]
</cfquery> 
```

使用诸如“recordset1”之类的动态变量名可以工作，但这是在一个函数中并且需要在 var 范围内，所以我不能动态地建立变量名而不在持久对象中产生内存泄漏。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T21:08:59.013

发布问题后，我想出了几个解决方案，但可能会有更好的解决方案

*   我可以将动态命名的变量写入参数范围，然后在没有查询范围的情况下引用它们

*   创建一个接受 2 个记录集作为参数并返回一个组合记录集的函数。这可以循环以逐步添加一个记录集。不过，与在一个查询中执行所有 UNION 相比，我确信这非常低效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T21:46:16.630

困难的任务。我可以想象一个基于`GetColumnNames()`、使用`QueryAddRow()`和的嵌套循环的解决方案`QuerySetCell()`。它不会是最有效的，但也不是很慢。当然，这取决于任务的大小。

当您创建它以接受例如十个参数时，您的“创建一个组合两个记录集的函数”可以变得更加高效。即时修改 SQL：

```
<cfset var local = StructNew()>

<cfquery name="local.union" dbtype="query">
  SELECT * FROM argument1
  <cfloop from="2" to="#ArrayLen(arguments)#" index="local.i">
    <cfif IsQuery(arguments[local.i])>
      UNION
      SELECT * FROM argument#local.i#
    </cfif>
  </cfloop>
</cfquery>

<cfreturn local.union> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T22:31:46.070

在快速浏览了一下之后，我发现了这个： [CFLib.org](http://cflib.org/udf/queryConcat)上的 queryConcat。它使用 queryaddrow/querysetcell 连接两个查询。

我添加了一个快速功能（没有错误检查或数据验证，所以我不会按原样使用它）：

```
<cffunction name="concatenate">
     <cfset var result = arguments[1]>
     <cfloop from="2" to="#arraylen(arguments)#" index="i">
             <cfset result=queryconcat(result, arguments[i])>
     </cfloop>
     <cfreturn result>
 </cffunction> 
```

作为测试，我把它放在一起：

事实上，这确实给了你 fred/sammy/fred。

这可能不是最有效的实现，但如果需要，您可以随时更改插入/联合代码以使其更快。大多数情况下，我的目标是自己编写尽可能少的代码。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T14:08:24.423

这里添加的所有解决方案都应该适合您，但我还要提到，根据您使用的数据量和您使用的数据库，您最好尝试在数据库端找到一种方法来执行此操作. 对于非常大的记录集，将记录写入临时表并再次选择它们可能是有益的，但无论哪种方式，如果您可以以任何方式重写查询以让数据库首先处理这个问题，您将过得更好。

# c# - 在 ASP.NET MVC (C#) 中返回多个列表

> ID：485227
> 
> 赞同：0
> 
> 时间：2009-01-27T20:58:46.227
> 
> 标签：c#, asp.net-mvc

我对 ASP.NET MVC 体系结构有些陌生，我正在尝试理清如何将多组数据返回到视图中。

```
 public ActionResult Index(string SortBy)
    {
        var actions = from a in dbActions.Actions
                       orderby a.action_name
                       ascending
                       select a;
        return View(actions.ToList());
    } 
```

此代码非常适合返回单个数据集。我的情况是我有一个对象列表，每个对象都有一个对象子集，我想在输出页面的层次结构中显示这些对象。我不确定我是在寻找快速方法还是正确方法，非常感谢您对这两种途径的想法。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T21:26:41.460

您可以通过 ViewData 传递它们，这是一个从控制器传递到视图的对象。控制器看起来像这样：

```
ViewData["ActionList"] = actions.ToList(); 
```

在视图中检索它：

```
<% foreach (var action in (List)ViewData["ActionList"]) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-01T23:26:43.127

如上所述的 ViewData 是快速的方法。但我相信将列表包装在单个对象模型中更有意义，然后将其传递给视图。您还将获得智能感知...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T21:29:33.200

该对象子集可以/应该由 Action 上的属性返回（假设 db.Actions 返回 Action 对象）。

```
public class Action 
{

    //...

    public IEnumerable<SubAction> SubActions 
    {
         get { return do-what-ever; }
    }

    //...
} 
```

这里没有什么特别的 MVC'ish ......

在您看来，您只需遍历两者：

```
<%
   foreach (Action a in ViewData.Model as IList<Action>) 
   {
       foreach (SubAction sa in a.SubActions)
       {
          // do whatever
       }
   }
%> 
```

# c++ - 在 eof() 循环中使用迭代器进行 C++ 标记化

> ID：485230
> 
> 赞同：3
> 
> 时间：2009-01-27T20:59:34.260
> 
> 标签：c++, string, iterator

我正在尝试调整这个答案

[如何在 C++ 中标记字符串？](https://stackoverflow.com/questions/53849/how-do-i-tokenize-a-string-in-c#53921)

我当前的字符串问题涉及从文件中读取直到 eof。

从这个源文件：

```
Fix grammatical or spelling errors

Clarify meaning without changing it

Correct minor mistakes 
```

我想用所有标记化的词创建一个向量。示例：v`ector<string> allTheText[0] should be "Fix"`

我不明白的目的，`istream_iterator<std::string> end;`但我包括因为它在原始海报的答案中。

到目前为止，我有这个非工作代码：

```
vector<string> allTheText;
          stringstream strstr;
          istream_iterator<std::string> end;
          istream_iterator<std::string> it(strstr);

          while (!streamOfText.eof()){
                getline (streamOfText, readTextLine);
                cout<<readTextLine<<endl;

                stringstream strstr(readTextLine);
                // how should I initialize the iterators it and end here?

                } 
```

编辑：

我将代码更改为

```
 vector<string> allTheText;
          stringstream strstr;
          istream_iterator<std::string> end;
          istream_iterator<std::string> it(strstr);

          while (getline(streamOfText, readTextLine)) {
               cout << readTextLine << endl;

        vector<string> vec((istream_iterator<string>(streamOfText)), istream_iterator<string>()); // generates RuntimeError

          } 
```

并得到一个 RuntimeError，为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T21:05:52.093

在 C++ 中使用`while (!….eof())`循环被破坏了，因为当流进入错误状态时循环将永远不会退出！

相反，您应该直接测试流的状态。适应您的代码，这可能如下所示：

```
while (getline(streamOfText, readTextLine)) {
    cout << readTextLine << endl;
} 
```

但是，您已经*有*一个流。为什么还要将其放入字符串流中？或者您是否需要出于任何原因逐行执行此操作？

您可以使用输入迭代器**直接初始化您的向量。**无需构建字符串流，也无需使用`copy`算法，因为有适当的构造函数重载。

```
vector<string> vec((istream_iterator<string>(cin)), istream_iterator<string>()); 
```

注意第一个参数周围的额外括号，这是从函数声明中消除歧义所必需的。

**编辑**此代码的作用的一个小解释：

C++ 提供了一种指定*范围*的统一方式。范围只是类型值的集合，没有详细说明这些值是如何存储的。在 C++ 中，这些范围表示为半开区间 [ `a`, `b`[。这意味着一个范围由两个*迭代器*分隔（它们有点像指针，但更通用；指针是一种特殊的迭代器）。第一个迭代器 ,`a`指向范围的第一个元素。第二个`b`, 指向最后一个元素的*后面。*为什么在后面？因为这允许非常容易地迭代元素：

```
for (Iterator i = a; i != b; ++i)
    cout << *i; 
```

像指针一样，迭代器通过应用于它们来*取消引用*`*`。这将返回它们的值。

C++ 中的容器类（例如`vector`, `list`）有一个特殊的构造函数，它允许将值从另一个范围轻松复制到新容器中。因此，此构造函数需要两个迭代器。例如，以下将 C 样式的数组复制到向量中：

```
int values[3] = { 1, 2, 3 };
vector<int> v(values, values + 3); 
```

在这里，`values`是同义词`&values[0]`，表示它指向数组的第一个元素。`values + 3`，由于指针算法，*几乎*等同于`&values[3]`（但这是**无效**的C++！）并指向数组*后面*的虚拟元素。

现在，我上面的代码与上一个示例完全相同。唯一的区别是我使用的迭代器类型。我没有使用普通指针，而是使用 C++ 提供的特殊迭代器类。这个迭代器类以这样一种方式*包装*输入流，即`++` *推进*输入流并从流`*`中读取下一个元素。元素的种类由 type 参数指定（因此`string`在这种情况下）。

为了使它作为一个范围工作，我们需要指定一个开始和结束。唉，我们不知道输入的结尾（这是合乎逻辑的，因为随着用户在控制台中输入更多输入，流的结尾实际上可能会随着时间而移动！）。因此，要创建一个虚拟*结束*迭代器，我们不将参数传递给`istream_iterator`. 相反，要创建一个开始迭代器，我们传递一个输入流。然后，这将创建一个迭代器，该迭代器指向流中的当前位置（此处为`cin`）。

我上面的代码在功能上等同于以下内容：

```
istream_iterator<string> front(cin);
istream_iterator<string> back;

vector<string> vec;

for (istream_iterator<string> i = front; i != back; ++i)
    vec.push_back(*i); 
```

反过来，这等效于使用以下循环：

```
string word;
while (cin >> word)
    vec.push_back(word); 
```

# c# - Linq to Objects 性能和最佳实现

> ID：485231
> 
> 赞同：0
> 
> 时间：2009-01-27T20:59:54.710
> 
> 标签：c#, linq

我在一个 Web 应用程序上工作，该应用程序修改了存储在数据库中的 XML 文档。当您单击菜单中的“首选项”选项时，它就像任何程序一样模仿。XML 文档由本地客户端应用程序读取，并且任何更改都会反映在本地客户端中。

我的 web 应用程序有 3 层，我猜你会说 aspx 页面是“视图”，我验证/处理所有用户输入的服务层，以及更新 XML 文档的数据层。

对于设置的每一页，我一直在递归遍历页面上的所有控件，如果我找到一个我想要处理的控件（复选框、文本框......），我将它添加到 IList，然后将该 IList 发送到然后我必须将控件从列表中拉出，以便我可以处理它的服务层。

我注意到这似乎有点慢，所以我分析了页面，基本上我一直在使用的 LINQ to Objects 查询往往会占用大量时间。

```
(CheckBox)lstControls.Where(x => x.ID == "some_id").SingleOrDefault(); 
```

然后我切换到手动将页面上的控件添加到 IList，然后通过索引器按照它们放入的顺序在服务层中将它们拉出。这完全取决于你不搞砸控件的索引正在找。

最后，这打破了将视图中的元素与服务层或数据层混合的规则。我知道我应该只使用数据，但我不知道如何有效地做到这一点。

每个设置页面都有一到三十个需要处理的控件。如何在不发送实际控件的情况下将所有数据从控件获取到服务层？

谢谢您的帮助....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T21:39:52.150

如果您将数据（您真正感兴趣的内容）收集到具有某些语义的对象结构中，您可能会遇到更好的情况，这将帮助您构建传递到下一层的内容。关键字“数据绑定”也应该可以帮助您获取输入的值。无需将任何控件传递回下一层..

# .net - 是否有可用于展开/折叠面板的 WPF 控件（动画）

> ID：485232
> 
> 赞同：15
> 
> 时间：2009-01-27T21:00:06.240
> 
> 标签：.net, wpf, user-interface, accordion

我有一个包含很多内容的窗口。我希望能够使用面板分隔内容，并有一个分隔符，用户可以单击每个面板之间的切换（通过动画将分隔符从左向右移动，显示一个部分并隐藏另一个部分） . 想想 Microsoft Office (2007)[导航窗格](http://www.devexpress.com/Products/NET/DXperience/WhatsNew2007v2/i/navbar-collapse.png)。有没有简单的方法来实现这一点？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-12-13T14:51:10.070

我的 WPF 应用程序也需要这个，我发现最好的是 Silverlight 工具包中功能齐全的 Accordion 控件：

[替代文字 http://www.sitechno.com/Blog/ct.ashx?id=a7c3c2d9-9446-4236-bc6e-c436427002ff&url=http%3a%2f%2fwww.sitechno.com%2fBlog%2fcontent%2fbinary%2fWindowsLiveWriter% 2fAccordionpart1_102BB%2fimage_2.png](http://www.sitechno.com/Blog/ct.ashx?id=a7c3c2d9-9446-4236-bc6e-c436427002ff&url=http%3a%2f%2fwww.sitechno.com%2fBlog%2fcontent%2fbinary%2fWindowsLiveWriter%2fAccordionpart1_102BB%2fimage_2.png)

源代码可[在此处](http://silverlight.codeplex.com/SourceControl/ListDownloadableCommits.aspx)获得，现场演示可[在此处](http://silverlight.net/content/samples/sl3/toolkitcontrolsamples/run/default.html)获得。移植到 WPF 可能很容易。Ruurd Boeke有一篇[5 部分的博客文章](http://www.sitechno.com/Blog/AccordionPart5AccordionButton.aspx)详细讨论了它。在[第 4 部分](http://www.sitechno.com/Blog/AccordionPart4TemplatingExample.aspx)中，他讨论了如何使用模板重新设置手风琴的样式以获得这种出色的手风琴外观：

[![替代文字](https://i.stack.imgur.com/SAkVT.png)](https://i.stack.imgur.com/SAkVT.png)
[（来源：[sitechno.com](http://www.sitechno.com/Blog/content/binary/WindowsLiveWriter/AccordionPart4templatingexample_1219A/image_thumb_7.png)）]

[![替代文字](https://i.stack.imgur.com/bGmbE.png)](https://i.stack.imgur.com/bGmbE.png)
[（来源：[sitechno.com](http://www.sitechno.com/Blog/content/binary/WindowsLiveWriter/AccordionPart4templatingexample_1219A/image_thumb_8.png)）]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-27T22:09:27.673

我使用扩展器。

```
<Expander Header="Items" IsExpanded="False">
    ...
</Expander> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-28T10:52:57.727

我认为您正在寻找的是“手风琴”控件，这是一篇关于如何从扩展器控件堆栈中构建一个的帖子：

[http://www.rooijakkers.net/Blog/post/2007/11/WPF-implementation-of-a-basic-Accordion-control.aspx](http://www.rooijakkers.net/Blog/post/2007/11/WPF-implementation-of-a-basic-Accordion-control.aspx)

对于动画，请查看 Kevin 的 bag-o-tricks 中的“Reveal”控件，网址为[http://j832.com/bagotricks/](http://j832.com/bagotricks/)

我认为甚至还有一个基于示例项目中的 Reveal 控件的动画 Expander 控件模板。

# c# - 使用 MSBuild 从命令行定义预处理器值

> ID：485237
> 
> 赞同：22
> 
> 时间：2009-01-27T21:01:53.630
> 
> 标签：c#, compiler-construction, msbuild, c-preprocessor

我需要创建一个包含多个项目的现有大型应用程序的演示版本。我想使用现有的项目，并通过预处理器指令中性化功能

```
#if DEMO
    mycode.NeuterNow();
#endif 
```

我们正在使用 MSBuild 构建我们的应用程序，理想情况下我会使用以下内容：

```
MSBuild -DefineProperty:DEMO MySolution.sln 
```

是否存在这样的功能？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-27T22:18:03.070

尝试

```
msbuild /p:DefineConstants=DEBUG;DEMO MySolution.sln 
```

您必须包含 DEBUG 或 RELEASE 以及解决方案文件中已定义的任何其他常量，但我认为这应该可行。免责声明：我自己从未真正尝试过。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-27T22:21:03.113

[这是这个的副本](https://stackoverflow.com/questions/479979/)，是的，/p:DefineConstants 确实可以正常工作，并且配置器是正确的，这将覆盖项目文件中已经定义的所有条件符号（恕我直言），所以你必须定义它们全部。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-28T08:03:16.580

在寻求自己解决这个问题的方法时，我发现了一些有趣的事情，我想我会分享。

MSBuild 中的 /p 指令不限于构建文件中已存在的属性。你可以用它来设置任何东西。

因此，例如，如果您使用 $(FeatureSet) 引导预处理器指令，然后调用 MSBuild，例如

```
MSBuild solution.sln /p:FeatureSet=DEMO 
```

它会相应地得到#defined，而无需手动破坏并重新指定您正在运行的任何其他预处理器指令。

我已经验证了这在 VS2010 中有效。不太确定如何为在没有 MSBuild 的 Visual Studio 中完成的构建定义 FeatureSet。

# c# - 测试 URL 时 Java 和 C# 代码的性能不同

> ID：485240
> 
> 赞同：0
> 
> 时间：2009-01-27T21:02:20.743
> 
> 标签：c#, http, timeout

运行以下 Java 代码时，在确定我正在测试的网页是否启动时，我得到了非常准确和一致的结果。

```
protected synchronized boolean checkUrl(HttpURLConnection connection){
    boolean error = false;
    //HttpURLConnection connection = null;
    GregorianCalendar calendar = new GregorianCalendar();

    try{
        if(connection != null){
            connection.connect();

            //200 is the expected HTTP_OK response
            error = processResponseCode(connection.getResponseCode());

            connection.disconnect();
        } else{
            error = false;
        }

    }catch(java.net.UnknownHostException uhe){
        ...     } 
    catch(Exception e){
        ...     }

    return error;
} 
```

与 c# 中的 Java 模式最接近的匹配具有更高的误报结果（主要是由于超时 - 默认周期为 100000 毫秒）。

```
protected bool connectedToUrl = false;
        response = null;

        HttpWebRequest webreq = (HttpWebRequest)WebRequest.Create(this.getUri());
        webreq.Credentials = CredentialCache.DefaultCredentials;
        WebResponse res = null;// webreq.GetResponse();

        try
        {
            WebRequest request = WebRequest.Create(this.getUri()) as WebRequest;
            request.Credentials = CredentialCache.DefaultCredentials;

            if (request != null)
            {
                // Get response 
                res = webreq.GetResponse();

                connectedToUrl = processResponseCode(res);
            }
            else
            {
                logger.Fatal(getFatalMessage());

                string error = string.Empty;
            }
        }
        catch (Exception e)
        {
            throw e;
        }

        return connectedToUrl;
    } 
```

我在 c# 中尝试了各种模式来匹配引用的 Java 代码的有效性，但无济于事。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T21:06:42.327

我相信这是因为您没有关闭任何请求对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T21:12:39.647

还有这个：

```
 catch (Exception e)
   {
      throw e;
   } 
```

除了在向上冒泡的异常上破坏堆栈跟踪之外什么都不做。如果您在代码的其他地方有错误处理，我建议删除 try catch 块。否则，您应该记录异常并继续。不要只是抓住它来扔它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T21:18:40.133

简单地改变这个：

```
res = webreq.GetResponse();
connectedToUrl = processResponseCode(res); 
```

到

```
using (WebResponse res = webreq.GetResponse()) 
{
    connectedToUrl = processResponseCode(res);
} 
```

（删除之前的声明。）

在您没有关闭/处置响应（或它已完成）之前，它会保持连接。您一次只能有一定数量（默认为 2，我相信）与任何一台主机的连接，因此会超时。当您处理响应时，它允许另一个请求使用相同的连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T21:06:56.333

我认为您在 C# 版本中缺少 GregorianCalendar :-)

为什么在 C# 版本中有两个请求对象？

# cocoa - Cocoa 中的共享对象

> ID：485245
> 
> 赞同：2
> 
> 时间：2009-01-27T21:04:20.833
> 
> 标签：cocoa, arrays, core-data, instance

我正在使用 Cocoa 中的 CoreData（不是基于文档的）。我的问题是，我想从不同的 NIB 访问 SAME NSArrayController。但是每个 NIB 都有一个自己的 NSArrayController 实例。

我现在的问题是如何生成 sharedObjects（如 NSUserDefaultsController）。这对我有很大帮助。感谢您的回答。=)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T22:32:31.293

您通常不想在 nib 之间共享 NSArrayController。拥有多个 NSArrayController（每个 NIB 一个）可能会更好，它们都绑定到同一个底层模型。如果您希望此模型（例如 NSArray）是应用程序全局的，您可以通过 NSApplication 的委托公开它（例如，在 MainMenu.nib 中实例化您的自定义 MyAppDelegate 类并将 NSApplication 的`delegate`出口连接到您的 MyAppDelegate 类的实例）。在其他 NIB 中，您可以将 NSArrayController 的`contentArray`绑定绑定到`Shared Application.delegate.myArray`（假设 MyAppDelegate 通过符合 KVC 的方法公开了一个名为 的 NSArray 绑定`myArray`）。您实际上是在使用 IB 和 MainMenu.nib 来创建 MyAppDelegate 的单例实例。

请记住，这种方法会使您的应用程序的单元测试变得困难，因为现在对象图中的单例在测试期间无法模拟或存根。为每个辅助（非 MainMenu.nib）NIB 创建一个 NSWindowController 或 NSViewController 并将这些 nib 中的 NSArrayControllers 绑定到`File Owner.myArray`. 然后，您可以实例化 NSWindowController 或 NSViewController，在加载辅助 NIB 之前向其传递一个数组（或数组 KVC 兼容对象）。通过这种方式，您可以单独测试 nib 的功能（使用阵列的模拟或存根）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T21:08:11.370

我不确定尝试重用 NSArrayController 是不是最好的选择（我需要更多地了解你的项目，但我从来没有遇到过我会做这样的事情的情况），但你可以使用类方法中的静态变量，如下所示：

```
+ (id)sharedObject;
{
    static id object = nil;

    if ( object == nil )
    {
        object = [[self alloc] init];
    }

    return object;
} 
```

请记住，这不是真正的单例，因为您仍然可以分配该类的其他对象。如果您真的想要严格，可以使用[本指南。](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaObjects/chapter_3_section_10.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T01:33:20.743

Matt Gallagher 在他的博客上有一篇[关于单例和其他获取“全局”数据](http://cocoawithlove.com/2008/11/singletons-appdelegates-and-top-level.html)的方法的好文章，您可能也想查看一下。它比 Apple 的文档更清晰一些，并且有一个指向头文件的链接，可以轻松轻松地从几乎任何 Cocoa 类中创建单例。

我实际上在我的一些项目中使用了他的头文件，效果很好。

# .net - .NET：如何使 WebBrowser 控件在 IE 中启动、显示 HTML、进程外？

> ID：485266
> 
> 赞同：3
> 
> 时间：2009-01-27T21:11:51.440
> 
> 标签：.net, internet-explorer

我想创建一个 WebBrowser 控件，为其提供要显示的 HTML，然后使其在其自己的 Internet Explorer 窗口中显示为进程外。

可以做到吗？

* * *

*   是的，它必须不在进程中
*   我已经有一种涉及编写临时文件的技术。我想删除这个黑客​​解决方案

* * *

我对stackoverflow运行还有其他三个问题，所有这些问题都在使以下代码工作的一小部分工作：

```
public static void SpawnIEWithSource(String szHtml)
{
   IWebBrowser2 ie = (IWebBrowser2)new InternetExplorer();

   object mv = System.Reflection.Missing.Value; //special "nothing" value
   object url = (String)@"about:blank";
   ie.Navigate2(ref url, ref mv, ref mv, ref mv, ref mv);

   mshtml.HTMLDocumentClass doc = (mshtml.HTMLDocumentClass)ie.Document;
   doc.Write(szHtml);
   doc.Close();

   ie.Visible = true;
} 
```

**注意：**上面的代码在本机应用程序中运行良好。

我想我会切入正题，看看是否有人有其他想法，这不涉及我能够弄清楚的唯一方法。

* * *

使用临时文件的破解解决方案是：

```
public static void SpawnIEWithSource(String szHtml)
{
   IWebBrowser2 ie = (IWebBrowser2)new InternetExplorer();

   object mv = System.Reflection.Missing.Value; //special "nothing" value
   object url = (String)@"about:blank";
   ie.Navigate2(ref url, ref mv, ref mv, ref mv, ref mv);

   //Todo: Figure out the .NET equivalent of the following
   //so that it doesn't have to write a temporary file
   //IDispatch webDocument = ie.Document;
   //webDocument.Write(szHtml);
   //webDocument.Close();

   String tempFilename = Path.GetTempFileName();
   try
   {
      //Rename to .htm, or else ie won't show it as actual HTML
      String htmlFile = Path.ChangeExtension(tempFilename, "htm");
      File.Move(tempFilename, htmlFile); //.NET's version of File.Rename
      tempFilename = htmlFile;

      //Write string to file
      StreamWriter writer = new StreamWriter(tempFilename);
      writer.Write(szHtml);
      writer.Close();

      url = (String)tempFilename;
      ie.Navigate2(ref url, ref mv, ref mv, ref mv, ref mv);

      //If we're going to delete the file, then we have to wait for IE to use it
      //else we delete it before it uses it
      while (ie.ReadyState != tagREADYSTATE.READYSTATE_COMPLETE)
      {
         System.Threading.Thread.Sleep(10);
      }
   }
   finally
   {
      File.Delete(tempFilename);
   }

   //Make IE Visible
   ie.Visible = true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T04:18:42.547

我之前这样做的方法是将 HTML 文件保存到磁盘，并将文件名传递给 shell，如下所示：

```
 System.Diagnostics.Process p = new System.Diagnostics.Process();
 p.StartInfo.FileName = "C:\Path\To\myHTMLFile.html";
 p.StartInfo.UseShellExecute = true;
 p.StartInfo.RedirectStandardOutput = false;
 p.StartInfo.Arguments = "";
 p.Start(); 
```

这样做的好处是它将使用用户的默认 Web 浏览器打开。如果您需要 IE，那么您可能必须深入注册表并获取其路径，并专门执行它。

您可能还希望在完成后处理该过程。您可以订阅一个名为 Exited 的事件，该事件将通知您何时可以处理该进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T22:27:14.690

使用 HTML 加载 WebBrowser 控件，如下例所示。
也许本身不是一个单独的过程，但可以完成工作。让我知道它是否真的需要在一个单独的过程中，我也许可以做这样的事情。其中可能涉及 System.Diagnostics.Process.start() 方法和一些 JavaScript。

```
 <html xmlns="http://www.w3.org/1999/xhtml">
        <head>
            <title></title>
        </head>
        <body>
        <div id="holdingArea" style="display:none">
            <div>
            <strong>In a new page</strong>
            </div>
        </div>
        <script type="text/javascript">
            var h = document.getElementById('holdingArea').innerHTML;
            var w = window.open('', '_blank');
            w.document.write(h);
        </script>
        </body>
        </html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T02:14:14.623

我用它来创建一个具有唯一随机句柄的新 IE 窗口，以使多个窗口可以同时打开。

```
 Dim WindowName As String = CStr(Rnd())
 WindowName = "W" & Replace(WindowName, ".", "0")
 Page.ClientScript.RegisterStartupScript(Me.GetType(), WindowName, WindowName & "=window.open('NominateList.aspx?Inviters=" & InviterList & "','" & WindowName & "','menubar=1,resizable=1,scrollbars=1,status=1,width=900,height=900');" & WindowName & ".moveTo(0,0);", True) 
```

我可以使用它来根据需要启动尽可能多的页面。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T01:26:34.980

WebBrowser 控件具有*DocumentText*属性。如果将其设置为 HTML 字符串，控件将在屏幕上呈现正确的 HTML。希望这可以帮助！

# .net - 在 .net 中设置 Windows 服务描述的最佳方法是什么

> ID：485268
> 
> 赞同：22
> 
> 时间：2009-01-27T21:12:23.157
> 
> 标签：.net, windows

我使用 VS2005 模板创建了一个 C# 服务。它工作正常，但服务的描述在 Windows 服务控制小程序中是空白的。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-27T21:16:05.833

创建ServiceInstaller并设置描述

```
private System.ServiceProcess.ServiceInstaller serviceInstaller = 
  new System.ServiceProcess.ServiceInstaller();
this.serviceInstaller.Description = "Handles Service Stuff"; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-02-10T20:26:50.680

澄清如何在不使用代码的情况下完成此操作：

*   如下所述将服务安装程序添加到您的项目中：http: [//msdn.microsoft.com/en-us/library/ddhy0byf%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/ddhy0byf%28v=vs.80%29.aspx)

*   在设计视图中打开安装程序（例如 ProjectInstaller.cs）。

*   单击服务安装程序组件（例如 serviceInstaller1）或右键单击它并选择属性。

*   在“属性”窗格中，设置描述和/或显示名称（这也是您设置 StartType 等的位置）。描述可能是您想要更改的所有内容，但如果您想提供更易读的 DisplayName（第服务经理）您也可以这样做。

*   如果需要，打开自动生成的设计器文件（例如 ProjectInstaller.Designer.cs）以验证属性设置是否正确。

*   构建解决方案并使用`installutil.exe`或其他方式安装。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-09-24T21:10:05.707

在 VS2010 中创建服务安装程序项目后，需要在 VS 创建的类中添加对 Install 方法的覆盖，以便为您的服务描述创建注册表项。

```
using System;
 using System.Collections;
 using System.ComponentModel;
 using System.Configuration.Install;
 using System.ServiceProcess;
 using Microsoft.Win32;

 namespace SomeService
 {
    [RunInstaller(true)]
    public partial class ProjectInstaller : System.Configuration.Install.Installer
    {
        public ProjectInstaller()
        {
            InitializeComponent();
        }
        /// <summary>
        /// Overriden to get more control over service installation.
        /// </summary>
        /// <param name="stateServer"></param>      
        public override void Install(IDictionary stateServer)
        {
            RegistryKey system;

            //HKEY_LOCAL_MACHINE\Services\CurrentControlSet
            RegistryKey currentControlSet;

            //...\Services
            RegistryKey services;

            //...\<Service Name>
            RegistryKey service;

            // ...\Parameters - this is where you can put service-specific configuration
            // Microsoft.Win32.RegistryKey config;

            try
            {
                //Let the project installer do its job
                base.Install(stateServer);

                //Open the HKEY_LOCAL_MACHINE\SYSTEM key
                system = Registry.LocalMachine.OpenSubKey("System");
                //Open CurrentControlSet
                currentControlSet = system.OpenSubKey("CurrentControlSet");
                //Go to the services key
                services = currentControlSet.OpenSubKey("Services");

                //Open the key for your service, and allow writing
                service = services.OpenSubKey("MyService", true);
                //Add your service's description as a REG_SZ value named "Description"
                service.SetValue("Description", "A service that does so and so");
                //(Optional) Add some custom information your service will use...
                // config = service.CreateSubKey("Parameters");
            }
            catch (Exception e)
            {

                throw new Exception(e.Message + "\n" + e.StackTrace);
            }
        }
    }
 } 
```

[http://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.aspx](http://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey.aspx)

[http://www.codeproject.com/KB/dotnet/dotnetscmdescription.aspx](http://www.codeproject.com/KB/dotnet/dotnetscmdescription.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-06T11:06:50.823

您还可以在 IDE 中设置服务名称和描述，方法是在 ProjectInstaller 类的设计视图中右键单击“serviceInstaller”图标。

[![从 IDE 设置服务描述](https://i.stack.imgur.com/4vRYU.png)](https://i.stack.imgur.com/4vRYU.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T13:59:46.663

您也可以创建一个 ServiceInstaller，然后在服务安装程序的属性窗口中，您将看到可以设置的描述属性。如果你不想编码。

# vb.net - 如何在 VB 中定义 64 位常量？

> ID：485285
> 
> 赞同：2
> 
> 时间：2009-01-27T21:15:41.123
> 
> 标签：vb.net, constants

在 Visual Basic 中

```
Friend Const xxx As UInt64 = 400 * 365 * 24 * 60 * 60 ''// Number of secs in 400 years 
```

这失败并出现错误

```
constant expression not representable in type integer 
```

问题是 400 * 365 * 24 * 60 * 60 大于 2^32

我会认为通过将常量声明为 UInt64 可以为其分配 64 位值

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T21:22:30.483

除了每年略多于 365 天（您需要添加 97 个闰日）之外，每个乘以组成常量的值都是整数文字，因此在您将它们分配给 UInt64 之前，它是全部在整数空间中完成。试试这个：

```
Friend Const xxx As UInt64 = 400UL * 365UL * 24UL * 60UL * 60UL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T21:24:22.040

在常量末尾放置一个哈希，并将其声明为“双精度”...

我用我的位掩码字段做到了这一点：

```
Public Const EDIT_TRANSACTION              As Double = 1073741824
Public Const EDIT_DWRDELIVERY              As Double = 2147483648#
Public Const ENTER_DWRORDER                As Double = 4294967296#
Public Const DELETE_DWRORDER               As Double = 8589934592#
Public Const DELETE_TRANSACTION            As Double = 17179869184#
Public Const DELETE_WATERORDER             As Double = 34359738368#
Public Const ENTER_METERREADING            As Double = 68719476736# 
```

** 编辑 **

我想我在这方面被标记了，因为这是我为 VB6 编写的旧代码，而不是你所要求的。所以，如果有人阅读这篇文章使用的是 VB6，并且必须将 Bitmask 字段传递给 SQL 之类的东西，那么这对我来说非常有效。

否则，请继续投票否决我的答案。:)

# .net - 使用 LINQ2Sql 验证用户

> ID：485298
> 
> 赞同：1
> 
> 时间：2009-01-27T21:19:03.940
> 
> 标签：.net, sql, linq, linq-to-sql, lambda

嗨，我正在使用 Linq 检查两个用户字段是否对应于 SQL 表中的唯一用户寄存器，例如

UID：用户ID PIN：passID

所以字段必须来自单个用户，我正在尝试这个：

```
 public bool AutentificacionUsuario(string userID , string password passID)
    {
        USER _userID = _db.USER.FirstOrDefault(uid => uid.siglas == userID);
        USER _passID = _db.USER.FirstOrDefault(pwd => pwd.codigousuario == passID); 
```

但是两者都从 Datacontext 返回一个 USER Table 实例（两个而不是一个），我想在 lambda 表达式中匹配它们，例如“此用户 ID 匹配 passID”

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T21:22:29.673

```
var usr = db.Users.From(uid => uid.dsiglas == userID && 
            uid.codigousuario == passID).FirstOrDefault();

if(usr != null)
   //Authenticate user here 
```

或者

```
var usr = (from u in db.Users
          where u.dsiglas == userID && uid.codigousuario == passID
          select u).FirstOrDefault()

if(usr != null)
    //Authenticate user here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T21:24:44.927

您需要使用 Where 子句来选择用户。我不确定 LINQ-2-SQL 是否是我一直在使用的，但我会这样做：

```
USER u = (
 from u in _db.USER
 where u.uid == userID && u.pwd == password
 select u
).FirstOrDefault() 
```

我希望代码是正确的，我现在无法在 LINQ 项目上访问智能感知来检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T22:06:25.887

为什么不这样做？

```
var doesUserExist=db.User.Any(p => p.UserID.Equals(userID) && p.Password.Equals(password)); 
```

# .net - 查找两个 .NET 数据表的交集

> ID：485306
> 
> 赞同：7
> 
> 时间：2009-01-27T21:20:32.267
> 
> 标签：.net, datatable

有没有一种相对简单的方法可以在 .NET 中获取两个 DataTables 的交集？

我可以想到明显的方法（我自己在 O(n^2) 中迭代这两个表），但如果它可用的话，我想要更优雅的东西。我怀疑可能有一种我没有看到的智能方式。当然，可读性和可维护性很重要，所以我试图远离任何过于“花哨”的东西。

有什么好主意吗？

**编辑：看起来 Bryan Watts 为 3.5 提供了一个非常棒的解决方案，但不幸的是我在 .NET 2.0 中（我应该提到过。）**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-27T21:28:08.553

使用 .NET 3.5：

```
using System.Data;

public static class DataTableExtensions
{
    public static IEnumerable<DataRow> Intersect(this DataTable table, DataTable other)
    {
        return table.AsEnumerable().Intersect(other.AsEnumerable());
    }

    public static IEnumerable<DataRow> Intersect(this DataTable table, DataTable other, IEqualityComparer<DataRow> comparer)
    {
        return table.AsEnumerable().Intersect(other.AsEnumerable(), comparer);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T21:30:23.463

[在MSDN](http://msdn.microsoft.com/en-us/library/bb386969.aspx)上看到了这个示例，您可能会发现它很有用。它使用 LINQ 语法。

```
DataSet ds = new DataSet();
ds.Locale = CultureInfo.InvariantCulture;
FillDataSet(ds);

DataTable orders = ds.Tables["SalesOrderHeader"];
DataTable details = ds.Tables["SalesOrderDetail"];

var query =
    from order in orders.AsEnumerable()
    join detail in details.AsEnumerable()
    on order.Field<int>("SalesOrderID") equals
        detail.Field<int>("SalesOrderID")
    where order.Field<bool>("OnlineOrderFlag") == true
    && order.Field<DateTime>("OrderDate").Month == 8
    select new
    {
        SalesOrderID =
            order.Field<int>("SalesOrderID"),
        SalesOrderDetailID =
            detail.Field<int>("SalesOrderDetailID"),
        OrderDate =
            order.Field<DateTime>("OrderDate"),
        ProductID =
            detail.Field<int>("ProductID")
    };

foreach (var order in query)
{
    Console.WriteLine("{0}\t{1}\t{2:d}\t{3}",
        order.SalesOrderID,
        order.SalesOrderDetailID,
        order.OrderDate,
        order.ProductID);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T18:31:17.037

由于您使用的是 .NET 2.0，因此您应该考虑重新实现 Intersect 方法。

[这个伪代码应该对你很有帮助。](http://www.hookedonlinq.com/IntersectOperator.ashx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T04:56:09.080

protected void Page_Load(object sender, EventArgs e) {

```
 DataTable dt1 = new DataTable();

    dt1.Columns.Add("ColX", typeof(int));

    DataTable dt2 = new DataTable();

    dt2.Columns.Add("ColX", typeof(int));

    for (int i = 1; i <= 5; i++)
    {
        DataRow row = dt1.NewRow();

        row["ColX"] = 5 + i;

        dt1.Rows.Add(row);

        row = dt2.NewRow();

        row["ColX"] = 9 + i;
        dt2.Rows.Add(row);
    }

    intesect(dt1, dt2);

}

public void intesect(DataTable contacts1, DataTable contacts2)
{
    var contacts = contacts1.AsEnumerable().Intersect(contacts2.AsEnumerable(), DataRowComparer.Default);

    foreach (DataRow row in contacts)
    {
        Response.Write(row["ColX"]);
    }
} 
```

# ruby-on-rails - 您如何在 RESTful 设计中处理对资源的“操作”，例如将电子邮件标记为已读？

> ID：485318
> 
> 赞同：3
> 
> 时间：2009-01-27T21:22:22.527
> 
> 标签：ruby-on-rails, rest, states

您将如何将这样的东西集成到 RESTful 设计中？

*   将电子邮件标记为已读
*   为故事投票
*   举报不当消息

此外，您将如何做到这一点，使得人们可以制作一个小图标链接或按钮来执行操作而无需太多的魔法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T21:38:38.720

这取决于你在做什么。有时只需将您的观点从“对资源执行操作”转变为“创建另一个不同但相关的资源”。

对故事进行投票很容易：您可以创建、查看等投票资源。报告也是如此。这可以应用于任何事情，而不是将订单标记为已提交，而是将有提交等。关键是要弄清楚如何将您的动词转换为名词。

将电子邮件标记为已读有点不同。为此我要做的是使用虚拟属性：在模型上创建自己的设置方法（例如，mark_as_read=）将允许您在#Update 操作中通过 params 数组传递 mark_as_read。

以对故事进行投票为例。您要做的是创建一个属于 Story 的 Vote 模型。创建一个 Votes 控制器，并将其嵌套在您的路由文件中的 Stories 控制器之外。然后，您可以使用嵌套资源路由（传递您的故事记录）轻松创建范围为单个故事的投票。

请注意，资源不一定必须由数据库模型支持，尽管它是正确的形式。在这种情况下，您始终可以简单地修改 Story 记录，同时保持 RESTful 和在需要时轻松扩展为完整模型的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T21:35:15.873

这是任何 REST 不可或缺的资源：

[http://oreilly.com/catalog/9780596529260/](http://oreilly.com/catalog/9780596529260/)[宁静的网络服务](http://oreilly.com/catalog/9780596529260/)

# javascript - Javascript：如何撤消 element.style 的设置？

> ID：485323
> 
> 赞同：0
> 
> 时间：2009-01-27T21:23:57.267
> 
> 标签：javascript, css, animation

我的文档中有一个元素，该元素具有通过常规 CSS 规则设置的背景颜色和图像。

当某个事件发生时，我想为该项目设置动画，突出显示它（我正在使用 Scriptaculous，但这个问题适用于任何会做同样事情的框架）。

```
new Effect.Highlight(elHighlight, { startcolor: '#ffff99', endcolor: '#ffffff', afterFinish: fnEndOfFadeOut }); 
```

我面临的问题是动画完成后，元素留下以下样式（根据 FireBug）：

```
element.style {
  background-color:transparent;
  background-image:none;
} 
```

它覆盖了 CSS 规则，因为它是在元素级别设置的，所以我失去了该项目曾经拥有的背景......

我想要做的是，在动画完成后我正在运行的回调函数中，将样式属性设置为使它们“消失”的值。

```
var fnEndOfFadeOut = function() {
  elHighlight.style.backgroundColor = "xxxxx";
  elHighlight.style.backgroundImage = "xxxxx";
} 
```

我想弄清楚的是在“xxxx”中放入什么（或者如何以不同的方式做同样的事情）。
我尝试了'auto'、'inherit'和''（空白字符串），但都没有奏效（我没想到它们会起作用，但我在这里一无所知）。

我也试过：elHighlight.style = ""; 不出所料，这引发了异常。

我能做些什么来克服这个问题？
我知道我可以在我突出显示的元素内放置一个跨度并突出显示该跨度，但我希望我能够避免额外无用的标记。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T21:29:00.050

您可能没有在正确的元素上设置样式。它可能被设置在父节点的某处。

```
elHighlight.style.backgroundColor = "";
elHighlight.style.backgroundImage = ""; 
```

您还可以通过调用删除*所有*默认样式：

```
elHighlight.style.cssText = ""; 
```

在任何情况下，您仍然需要对设置这些属性的特定元素执行此操作，这意味着您可能需要对 parentNode 进行递归，直到找到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T21:44:53.870

尝试
`elHighlight.style.removeProperty('background-color')` `elHighlight.style.removeProperty('background-image')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T21:27:53.843

你试过 elHightlight.style.background = ""; 吗？

我的网站上有一个荧光笔代码，这有效

```
function highlight(id) {
var elements = getElementsByClass("softwareItem");
for (var ix in elements){
    elements[ix].style.background = ""; //This clears any previous highlight
}
document.getElementById(id).style.background = "#E7F3FA";
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-27T21:28:10.630

一个 HTML 元素可以有多个 CSS 类。将高亮信息放在 CSS 类中。将此类添加到您的元素中以突出显示它。删除类以撤消效果。

# sql - 休眠性能调整

> ID：485331
> 
> 赞同：4
> 
> 时间：2009-01-27T21:25:27.263
> 
> 标签：sql, performance, hibernate, jpa

根据您的经验，有哪些好的 Hibernate 性能调整？我的意思是插入/更新和查询。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-01-25T19:09:48.640

一些特定于 Hibernate 的性能调优技巧：

*   避免由并行对多关联获取连接引起的连接重复（因此避免重复的对象实例化）
*   使用带有 fetch="subselect" 的延迟加载（防止 N+1 选择问题）
*   在巨大的只读结果集中，不要提取到映射对象，而是提取到平面 DTO（使用 Projections 和 AliasToBean-ResultTransformer）
*   应用 HQL 批量更新、批量删除和按选择插入
*   在适当的地方使用 FlushMode.Never

Taken from [http://arnosoftwaredev.blogspot.com/2011/01/hibernate-performance-tips.html](http://arnosoftwaredev.blogspot.com/2011/01/hibernate-performance-tips.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T05:49:11.693

我不确定这是一个调整，但如果你知道你需要一个多对一，join fetch 会很有用。例如，如果一个人可以是单个部门的成员，并且您知道您将在一个特定的地方同时需要这两者，您可以使用类似 from Person p left join fetch p.department 和 Hibernate 将执行单个查询一个人的查询，然后是部门的 n 个查询。

当进行大量插入/更新时，定期调用刷新，而不是在每次保存后或结束时调用 - Hibernate 将批处理这些语句并将它们一起发送到数据库，这将减少网络开销。

最后，小心二级缓存。如果你知道你通过 id 读取的大部分对象都在缓存中，它可以让事情变得非常快，但是如果指望它们在那里但没有很好地配置它，你最终会做很多事情单行数据库查询，当您只需要一次网络/数据库行程就可以带回一个大型结果集时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T22:06:01.067

适当地使用缓存、级联和延迟加载。

调整？Hibernate 根据您提供的映射为您生成 SQL。如果您不喜欢 SQL，那么 Hibernate 可能不是正确的工具。

其余的性能与数据库设计有关：规范化、索引等。

# ruby-on-rails - 在 Ruby on Rails 中登录/注册？

> ID：485336
> 
> 赞同：2
> 
> 时间：2009-01-27T21:27:46.543
> 
> 标签：ruby-on-rails, openid, user-controls

我开始学习 RoR，我想用这种语言制作我的个人博客。我通常在我在博客中所做的任何事情的基础上编写几个原型。所以我希望人们能够登录并使用他们的 openID 注册。因此，当我意识到 gems 的概念时，我正要跳到编码的地方，而所有这些东西都在为你提供这类东西的工具。

那么是否有某种包来管理用户、配置文件和 openId？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T21:32:10.933

查看 technoweeni 的 restful-authentication 插件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T23:39:21.253

看看 bort 骨架应用程序。它已经设置了 restful auth 和 openid 身份验证。

Railscasts 还有许多关于设置身份验证、restful 身份验证和 OpenID 的截屏视频。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T23:40:01.253

我建议您将[bort](http://jimneath.org/bort/)视为一个完整的 RoR 骨架应用程序，内置 RESTful auth，它的一个分支[在这里](http://matthall.wordpress.com/2008/09/09/a-bort-fork-rails-base-application/)或在[AuthLogic](http://www.railsinside.com/plugins/145-authlogic-another-take-on-rails-authentication.html)中为 Rails（以及 Merb 和其他一些）提供的侵入性较小的身份验证解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T21:56:08.823

为了避免数小时的头痛，您需要注意一件事：Ruby OpenID[库](http://openidenabled.com/ruby-openid/)在 OpenID 2.0 中发生了重大变化，因此如果您使用博客中的插件或示例代码，请确保您使用的是 OpenID 版本它对应的。

有几个插件；一个有很多活动的是[`open_id_authentication`](http://github.com/rails/open_id_authentication/network)。

Dan Webb 有一个很好的 Rails 中 OpenID 身份验证[指南](http://www.danwebb.net/2007/2/27/the-no-shit-guide-to-supporting-openid-in-your-applications)，它会引导您编写实际代码，但请注意，至少我上次检查过，它还没有针对 OpenID 2.0 进行更新。

# sql - 最高性能的数据库存储机制

> ID：485340
> 
> 赞同：-1
> 
> 时间：2009-01-27T21:28:15.963
> 
> 标签：sql, database, performance, storage, data-storage

我需要想法来实现（真正的）高性能内存数据库/存储机制。在存储 20,000 多个对象的范围内，每个对象每 5 秒左右更新一次。 **我想要一个 FOSS 解决方案**。

我最好的选择是什么？你有什么经验？

我主要使用 Java 工作，但我需要数据存储具有良好的性能，因此数据存储解决方案不需要以 Java 为中心。

我还需要能够查询这些对象，并且我需要能够在程序启动时恢复所有对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T21:34:51.833

[SQLite](http://sqlite.org/)是一个开源的自包含数据库，支持内存数据库（只需连接到`:memory:`）。它具有许多流行编程语言的绑定。它是一个传统的基于 SQL 的关系数据库，但您无需运行单独的服务器——只需将其用作程序中的库即可。它很快。我不知道它是否足够快，但它可能值得一试。

[Java 驱动程序](http://www.zentus.com/sqlitejdbc/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T21:30:54.290

您是每 5 秒更新 20K 对象还是每 5 秒更新 20K 对象之一？

什么样的物体？为什么传统的 RDBMS 不够用？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T21:32:42.570

查看[HSQLDB](http://hsqldb.org/)和[Prevayler](http://www.prevayler.org/)。Prevayler 是对传统 RDBMS 的一种范式转变——我在许多项目中都使用过（范式，即不是专门为 Prevayler），并发现它具有真正的优点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T21:33:44.533

完全取决于您需要如何查询它，但是您是否查看过 memcached？

[http://www.danga.com/memcached/](http://www.danga.com/memcached/)

如果您使用 PHP ，其他选项可能包括[MySQL MEMORY Tables](http://dev.mysql.com/doc/refman/5.0/en/memory-storage-engine.html)和[APC Cache 。](http://php.net/manual/en/function.apc-add.php)

有关项目/要求的更多详细信息会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T21:33:46.857

内存存储？

1) 一个简单的 C 'malloc' 数组，所有结构都将被索引。

2）berkeleyDB：[http](http://www.oracle.com/technology/products/berkeley-db/index.html) ://www.oracle.com/technology/products/berkeley-db/index.html 。它很快，因为您构建了自己的索引（辅助数据库）并且没有要评估的 SQL 表达式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T21:47:17.923

查看此处列出的一些产品：[http ://en.wikipedia.org/wiki/In-memory_database](http://en.wikipedia.org/wiki/In-memory_database)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T21:38:17.973

您需要什么级别的耐用性？如果您将数据写回磁盘，则每 5 秒更新 20,000 次对于大多数 IO 硬件而言，就事务数量而言可能很困难。

如果您有能力丢失一些更新，那么您可以每 100 毫秒将其刷新到磁盘，如果您的数据库和操作系统支持这样做，那么使用相当便宜的硬件就不会出现问题。

如果它真的是一个您不想经常刷新到磁盘的内存数据库，那听起来很简单。我听说 H2 很不错，但 SQLite 也可以。一个经过适当调整的 MySQL 实例也可以做到（但可能更复杂）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T21:39:25.520

Oracle TimesTen 内存数据库。请参阅： http: [//www.informationweek.com/whitepaper/Business-Intelligence/Datamarts-Data-Warehouses/oracle-timesten-in-memory-databas-wp1228511232361](http://www.informationweek.com/whitepaper/Business-Intelligence/Datamarts-Data-Warehouses/oracle-timesten-in-memory-databas-wp1228511232361)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-08T16:41:53.337

[Chronicle Map](https://github.com/OpenHFT/Chronicle-Map)是一个*纯 Java*键值存储

*   [它具有非常高的性能，单线程每秒可](http://vanillajava.blogspot.com/2014/10/chronicle-map-and-yahoo-cloud-service.html)维持100 万次写入。无法用 Java 编写快速数据库是一个神话。
*   无缝存储和加载任何可序列化的 Java 对象，提供简单的`Map`接口
*   LGPLv3

由于您没有很多“表”，因此成熟的 SQL 数据库可能是一种过大的解决方案，索引和查询可以使用少数不同的键值存储来实现，这些键值存储由普通 Java 代码手动更新。如果您需要， Chronicle Map[提供](https://github.com/OpenHFT/Chronicle-Map#multi-key-queries)了使此类更新同时彼此隔离的机制。

# .net - 在 VB.NET 中，如何获取当前 Windows 机器中所有用户的列表？

> ID：485341
> 
> 赞同：1
> 
> 时间：2009-01-27T21:28:31.017
> 
> 标签：.net, windows, vb.net

在 VB.NET 中，如何获取当前 Windows 机器中所有用户的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T23:00:49.210

您可以使用需要一些解析的注册表，但是它可以工作。这是一些代码：

**C＃**

```
 RegistryKey userskey = Registry.LocalMachine.OpenSubKey(@"SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList");
        foreach (string keyname in userskey.GetSubKeyNames())
        {
                using (RegistryKey key = userskey.OpenSubKey(keyname))
                {
                    string userpath = (string)key.GetValue("ProfileImagePath");
                    string username = System.IO.Path.GetFileNameWithoutExtension(userpath);
                    Console.WriteLine("{0}", username);
                }
        } 
```

**VB**

```
Dim userskey As RegistryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList")
For Each keyname As String In userskey.GetSubKeyNames()
    Using key As RegistryKey = userskey.OpenSubKey(keyname)
        Dim userpath As String = DirectCast(key.GetValue("ProfileImagePath"), String)
        Dim username As String = System.IO.Path.GetFileNameWithoutExtension(userpath)
        Console.WriteLine("{0}", username)
    End Using
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:49:47.530

[这是Nathan W](https://stackoverflow.com/questions/485341/in-vb-net-how-do-you-get-a-list-of-all-users-in-the-current-windows-machine#485754)答案的改进版本：

```
Function GetUsers() As List(Of String)
    Dim ret As New List(Of String)
    Dim userskey As RegistryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList")
    For Each keyname As String In userskey.GetSubKeyNames()
        Using key As RegistryKey = userskey.OpenSubKey(keyname)
            Dim userpath As String = DirectCast(key.GetValue("ProfileImagePath"), String)
            Dim username As String = System.IO.Path.GetFileNameWithoutExtension(userpath)
            'Console.WriteLine("{0}", username)
            ret.Add(username)
        End Using
    Next
    If Not ret.Contains("Guest") Then ret.Add("Guest")
    ret.Sort()

    Return ret
End Function 
```

此函数从注册表返回当前域/机器上所有用户的列表。对于他的回答，它无法识别我系统上的来宾帐户。不知道为什么。

# c# - 关于在逐字字符串中转义引号的语法问题

> ID：485342
> 
> 赞同：0
> 
> 时间：2009-01-27T21:28:35.510
> 
> 标签：c#

为什么必须添加 2 组额外的引号才能在逐字字符串中转义一组引号？

```
string s = @"""Hi"""; //Note: three quotes on either side 
```

前面的代码生成以下字符串：“Hi”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T21:31:47.783

@ 符号当然意味着它是一个未转义的字符串文字。但是，“未转义”并不完全成立，因为您仍然需要一些方法来表示未转义字符串文字中的双引号。为此，您只需同时输入两个双引号。你的字符串也可以这样写：

```
string s = "\"H\""; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T21:33:03.193

如果您想在字符串中添加引号，则必须以某种方式对其进行转义-否则它将终止字符串。

MS 决定使用 2 个引号字符的序列对逐字字符串中的引号字符进行转义。就那么简单。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T21:30:38.767

好的，想象一个字符流。

突然发现了一段话。这是字符串文字的开始。我们继续阅读，直到我们找到另一个报价。现在可能发生两件事。我们要么找到第二个报价，这意味着我们记下一个报价并继续阅读。或者我们找到另一个字符，这意味着字符串已经结束，

这可以用一个简单的状态图表示：

```
 +--------+ --- " ---> +-------+
--- " ---> | String |            | Quote | --- any ---> end of string
           +--------+ <--- " --- +-------+
           |        ^
           |        |
           \- any -/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T21:31:45.037

因为报价本身就逃脱了。

# c++ - 为什么我在插入地图时遇到分段错误

> ID：485358
> 
> 赞同：1
> 
> 时间：2009-01-27T21:32:03.490
> 
> 标签：c++

我想将 a 插入 `pair< string, vector<float> >`到地图中，首先它可以工作，但是在几个循环之后，它不能再插入并给我一个分段错误。有人能给出一个可能的理由吗？

顺便说一句：我首先读取一个文件并生成地图（大约 200,000 个元素），然后我读取另一个文件并更新旧地图。更新步骤时发生错误。

有人可以帮我提供上面提供的信息吗？非常感谢

代码很长......我只是删除了以前的密钥然后插入一个新的，看起来并不复杂......但让我发疯......你猜猜这里发生了什么？

非常感谢您的所有回答！而且我发现它确实是解决问题的好地方。再次感谢，我将尝试简化我的代码，并在今天或明天将其添加到这里。

更新：我使用了 MSN 的代码，它可以工作，非常感谢您在没有看到我的代码的情况下解决了我的问题......也非常感谢这里的其他好心人！但是，我只能选择一个作为答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T21:44:56.477

您是否使用您称为 erase() 的迭代器进行插入？或者以任何方式使用该迭代器？调用erase(p) 后，p 无效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T21:36:24.263

没有更多信息，很难说，但你在插入什么？难道仅仅是你的内存不足？虽然，我确实认为普通 C++ 在这种情况下会引发异常，但您是否在堆栈上使用了任何可能溢出的自定义分配器、malloc 或数组？

也许描述您所做工作的代码片段可能有助于确定问题的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T21:45:26.147

> 你能猜到这里发生了什么吗？

你以某种方式滥用内存。

在 C++中有**很多**方法可以做到这一点！

与其猜测，也不要阅读你的代码，我建议运行一种特定于平台的调试器来检测这个问题，例如`valgrind`.

您的替代方法是使问题更小：仅用几行代码重现问题，然后您可以将其发布以供人们查看。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T21:42:17.650

如果您修改数据结构中已经存在的元素的键，或者如果您有一个错误的比较函数，这很容易发生，这会误导搜索算法。

如果您可以检测到导致 seg.fault 的具体插入操作，则尝试使用调用比较函数的值进行调试/记录。

或者，您应该在错误插入之前打印地图的内容，键可能不按顺序排列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T21:46:09.673

有问题的类型是`pair<string, vector<float> >`. 您将在每次插入时复制该对。如果字符串或向量很大，则可能内存不足。

编辑：要解决内存不足的问题，您可以将插入键值对的方式更改为：

```
pair<map::iterator, bool> insert_result= map.insert(make_pair(name, vector<float>());
if (insert.second) { insert_result.first->second.swap(vector_read_in); } 
```

这将确保您不复制内存，只移动它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T21:51:39.020

请发布一些代码，您不能指望我们仅靠猜测工作来调试您的问题。

...但无论如何我都会给它一个刺伤:) 还有什么编译器，你在做什么系统？

如果您在循环中读取数据，您可能会用完堆栈空间，这会导致段错误。

如果您发布一些代码，我会编辑我的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T22:32:52.917

请记住，如果您正在遍历地图，查找要删除的内容，请保存密钥以供以后删除。如果在迭代时删除，则会冒使迭代循环无效的风险。

```
std::map<string, vector<float> >::iterator iter = my_map.begin();
while (iter != my_map.end()) {
  if (somethingBadAboutItem(iter)) {
    my_map.erase(iter);   // this can mess up my_map iteration above 
                          // and cause bad data access later
  }
  ++iter;
} 
```

相反，尝试

```
std::map<string, vector<float> >::iterator iter = my_map.begin();
std::vector<string> keys_to_delete;
while (iter != my_map.end()) {
  if (somethingBadAboutItem(iter)) {
    keys_to_delete.push_back(iter->first);
  }
  ++iter;
}

for (std::size_t i = 0; i < keys_to_delete.size(); ++i) {
  iter = my_map.find(keys_to_delete[i]);
  my_map.erase(iter);
} 
```

如果其他人发现比这更优雅的东西，我很感兴趣，但这是我的首选技术。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T22:42:59.683

比尔：你有没有尝试过这样的事情：

```
for(std::map<string, vector<float> >::iterator iter = my_map.begin(); iter != my_map.end();) {
    if(somethingBadAboutItem(iter)) {
        my_map.erase(iter++);
    } else {
        ++iter;
    }
} 
```

关键是在删除时对迭代器进行后递增，因此在递增时它仍然有效，但您会擦除（并因此使其无效）指向前一项的副本。

我不确定这种技术是否一定适用于所有 STL 容器。我不记得所有的失效规则（例如，似乎不太可能适用于矢量，但通常最好将 remove_if 用于非平凡尺寸的那些），但它应该适用于 map。

# sql - T-SQL：如何创建区分大小写的唯一键？

> ID：485359
> 
> 赞同：46
> 
> 时间：2009-01-27T21:32:08.297
> 
> 标签：sql, sql-server, tsql, constraints

如何在`varchar`区分大小写的字段上创建唯一约束 (SQL Server 2005)？

目前我的约束看起来像这样：

```
alter table MyTable
add constraint UK_MyTable_MyUniqueKey unique nonclustered (MyCol) 
```

当我尝试插入以下两个值时，我收到“违反 UNIQUE KEY 约束...”错误。

```
insert into MyTable (MyCol) values ('ABC')
insert into MyTable (MyCol) values ('abc') --causes a violation of UNIQUE KEY constraint 'UK_MyTable_MyUnqiueKey' 
```

我希望将两个不同大小写的值作为 unqiue 处理。我想它将涉及以下代码，但我不知道它如何改变我的`add constraint`语法。

```
COLLATE SQL_Latin1_General_CP1_CS_AS 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-27T21:38:38.143

这会将列更改为区分大小写。我认为您的约束没有任何变化...

```
ALTER TABLE mytable 
ALTER COLUMN mycolumn VARCHAR(10) 
COLLATE SQL_Latin1_General_CP1_CS_AS 
```

由于此操作，此列上的任何选择或连接都将区分大小写。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T21:45:03.497

您只能设置数据库中数据的大小写敏感（最小的列粒度）。您不能设置索引的区分大小写 - 这相当于能够对表达式进行索引，这在某些数据库中是可能的，但不是 Sql Server。

# c++ - 如何更改此标记化过程以处理具有多行的文本文件？

> ID：485371
> 
> 赞同：1
> 
> 时间：2009-01-27T21:34:38.103
> 
> 标签：c++, iterator, token

我正在处理这个源代码：

```
#include <string>
#include <vector>
#include <iostream>
#include <istream>
#include <ostream>
#include <iterator>
#include <sstream>
#include <algorithm>

int main()
{
  std::string str = "The quick brown fox";

  // construct a stream from the string
  std::stringstream strstr(str);

  // use stream iterators to copy the stream to the vector as whitespace separated strings
  std::istream_iterator<std::string> it(strstr);
  std::istream_iterator<std::string> end;
  std::vector<std::string> results(it, end);

  // send the vector to stdout.
  std::ostream_iterator<std::string> oit(std::cout);
  std::copy(results.begin(), results.end(), oit);
} 
```

它不是对单行进行标记并将其放入向量结果中，而是对从该文本文件中取出的一组行进行标记并将结果单词放入单个向量中。

```
Text File:
Munroe states there is no particular meaning to the name and it is simply a four-letter word without a phonetic pronunciation, something he describes as "a treasured and carefully-guarded point in the space of four-character strings." The subjects of the comics themselves vary. Some are statements on life and love (some love strips are simply art with poetry), and some are mathematical or scientific in-jokes. 
```

到目前为止，我只清楚我需要使用

```
while (getline(streamOfText, readTextLine)){} 
```

让循环运行。

但我认为这行不通：

while (getline(streamOfText, readTextLine)) { cout << readTextLine << endl;

// 从字符串构造一个流 std::stringstream strstr(readTextLine);

// 使用流迭代器将流作为空格分隔的字符串复制到向量 std::istream_iterator it(strstr); std::istream_iterator 结束；std::vector 结果（它，结束）；

```
/*HOw CAN I MAKE THIS INSIDE THE LOOP WITHOUT RE-DECLARING AND USING THE CONSTRUCTORS FOR THE ITERATORS AND VECTOR? */

  // send the vector to stdout.
  std::ostream_iterator<std::string> oit(std::cout);
  std::copy(results.begin(), results.end(), oit);

          } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T21:48:39.277

是的，那么您在`readTextLine`. 这是你在那个循环中想要的吗？然后不是从 istream 迭代器构造向量，而是复制到向量中，并在循环外定义向量：

```
std::vector<std::string> results;
while (getline(streamOfText, readTextLine)){
    std::istringstream strstr(readTextLine);
    std::istream_iterator<std::string> it(strstr), end;
    std::copy(it, end, std::back_inserter(results));
} 
```

如果您只需要来自流的所有单词，并且不需要每行处理，那么您实际上不需要先将一行读入字符串。就像您在代码中所做的那样直接从另一个流中读取。它不仅会从一行中读取单词，还会从整个流中读取单词，直到文件结尾：

```
std::istream_iterator<std::string> it(streamOfText), end;
std::vector<std::string> results(it, end); 
```

要手动完成所有这些操作，就像您在评论中要求的那样，请执行

```
std::istream_iterator<std::string> it(streamOfText), end;
while(it != end) results.push_back(*it++); 
```

我建议你读一本关于这方面的好书。我认为它将向您展示更多有用的技术。[Josuttis 的C++ 标准库](https://rads.stackoverflow.com/amzn/click/com/0201379260)是一本好书。

# .net - 为什么不从 GridView 的下拉列表中触发 SelectedIndexChanged 事件？

> ID：485390
> 
> 赞同：2
> 
> 时间：2009-01-27T21:38:08.423
> 
> 标签：.net, asp.net, gridview, events

我无法触发我的下拉列表中的 SelectedIndexChanged。我有以下内容：

```
<form id="form1" runat="server">
<div>
<asp:GridView id="grdPoll" runat="server" AutoGenerateColumns="false">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:DropDownList ID="DropDownList1" runat="server" 
                 AutoPostBack="true"
                 OnSelectedIndexChanged="DropDownList1_SelectedIndexChanged">
                    <asp:ListItem Text="Review" Value="Review" Selected="True">Review</asp:ListItem>
                    <asp:ListItem Text="Level1" Value="lvl1">Send Back to Level1</asp:ListItem>
                </asp:DropDownList>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView>

<asp:Label ID="lblCity" runat="server" Text="Label"></asp:Label>  
</div>
</form> 
```

在我背后的代码中，我有这个：

```
protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
    this.lblCity.Text = ((DropDownList)sender).SelectedValue;
} 
```

如果我把这个相同的 ddl 放在 gridview 之外，它就会触发。

回发正在发生，并且自动回发设置为 true。该事件永远不会触发。为什么我不能从 gridview 中触发我的事件？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T20:08:34.440

好吧，这个问题是一个多月前提出的，现在可能无关紧要，但@LFSR 最近很友好地对其进行了编辑，它在“活动问题”列表中。

由于它仍未得到答复（224 次观看！），我想我应该试一试：

* * *

问题是在 GridView 的上下文中，DropDownList（以下简称 DDL）是一个动态控件，因此它的事件需要在 Postback 时重新附加。

当理解了这个概念后，解决方案就变得相对简单了：

**ASPX：**

```
<asp:DropDownList ID="DDL1" runat="server" AutoPostBack="true" OnSelectedIndexChanged="DDL1_SelectedIndexChanged">
  <asp:ListItem Text="Review" Value="Review" Selected="True">Review</asp:ListItem>
  <asp:ListItem Text="Level1" Value="lvl1">Send Back to Level1</asp:ListItem>
</asp:DropDownList> 
```

客服代码：

```
protected void Page_Load(object sender, EventArgs e)
{
  if(!Page.IsPostBack)
  {
    // Bind the GridView to something.
    DataBindGrid();
  }
}

protected void DDL1_SelectedIndexChanged(object sender, EventArgs e)
{
  this.lblCity.Text = ((DropDownList)sender).SelectedValue;
}

protected void grdPoll_RowDataBound(object sender, GridViewRowEventArgs e)
{
  if(Page.IsPostBack)
  {
    if(e.Row.RowType == DataControlRowType.DataRow)
    {
      DropDownList ddl = e.Row.FindControl("DDL1") as DropDownList;
      if(ddl != null)
      {
        ddl.SelectedIndexChanged += new EventHandler(DDL1_SelectedIndexChanged);
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-01T04:23:27.380

我发现在 ItemDataBound 中附加一个事件处理程序不起作用；DropDownList 也没有 CommandName 或 CommandArgument 属性，因此网格的 ItemCommand 事件不会响应下拉选择的索引更改而触发。

但是，您可以在 Page_Load 中执行此操作以确定导致帖子的原因：-

```
 var target = Request.Form["__EVENTTARGET"];

        if (!string.IsNullOrEmpty(target) && target.Contains("cboAttribute"))
        {
            var cboAttribute = Page.FindControl(target) as DropDownList;

            if (cboAttribute != null)
            {
                // this one fired the event
            }
        } 
```

我的网格包含一堆名为 cboAttribute 的下拉列表，这让我可以参考导致该帖子的下拉列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-12T23:49:21.010

进行数据绑定时要小心。我在测试页面上遇到了同样的问题。DD selectedIndex 事件不会触发。事实证明，我在每个页面服务上重新绑定了 gridview，这有效地终止了事件。只要我只绑定`page.ispostback=false`按预期触发的事件并被通用 DD 处理程序拾取。从那里你可以迭代你的 DD 的 gridview clientIDs 来找到`sender.clientID`在通用处理程序中匹配的那个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T07:03:35.047

好吧，这并没有解决我的问题。我必须说即使不必在 RowDataBound 中连接事件，这在我的盒子上也能正常工作。这不是 gridview 现在似乎存在的唯一问题，甚至 datakey 集合也消失了，我认为这个网格仅设计用于与 asp.net 数据源一起正常工作。我将重写我的代码以使用对象数据源来验证我的怀疑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T13:27:36.380

我无法解释原因，但是当我将 ListItem 动态添加到 DropDown 时，我遇到了同样的行为。仅当您不需要 ListItem 值时才有用。

尝试添加字符串值而不是 ListItem：

例如：

```
//  change this
DDL1.Items.Add(new ListItem("Review","Review"));

// To this
DDL1.Items.Add("Review"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-25T17:40:50.400

我在网格中的组合框未触发时遇到了类似的问题。在我的情况下，该方法没有触发的原因是因为有一个需要验证的项目被隐藏了。因此，请务必检查您是否没有任何隐藏的验证器可以触发并阻止组合框执行。

# c# - 如何将数据作为参数绑定到 ActionLink？

> ID：485393
> 
> 赞同：4
> 
> 时间：2009-01-27T21:38:23.760
> 
> 标签：c#, asp.net-mvc

我对 ActionLink 有疑问。我想为我的 MessageController 传递给我的 ActionLink 参数，用于编辑操作：生成类似 /MessagesController/Edit/4 的东西

所以我有带有绑定表达式的 ListView 控件：

以及如何将此 ID 传递给 ActionLink 作为我的控制器编辑操作的参数？这不起作用: , null) %>

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T00:46:52.567

在 MVC 中，您不应该以您拥有的方式从视图中绑定数据。您要传递给 ActionLink 方法的数据需要添加到控制器中的 ViewData 中。然后在视图中从 ViewData 中检索它：

```
<%= Html.ActionLink("My Edit Link", "Edit", "Message", new { id = ViewData["id"] }) %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T23:10:50.900

```
<%= Html.ActionLink("My Edit Link", "Edit", "Message", new { id = ((Message)Container.DataItem).ID }, null) %> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T21:42:23.813

试试这个

```
<%= Html.ActionLink("my link", "Edit", "Message", new { id = ((Message)Container.DataItem).ID }) %> 
```

您需要将它放在 RouteData 中才能显示出来。注意我假设*id*是您的路线定义中的路线部分之一。

# c# - 如何在 LINQ 的表达式树中创建连接？

> ID：485398
> 
> 赞同：1
> 
> 时间：2009-01-27T21:38:55.350
> 
> 标签：c#, .net, linq, linq-to-sql, join

我有一个包含标签对象集合的任务对象......在数据库中，这些表称为任务和标签。

有多种方法可以搜索任务，因此使用 LINQ，我在表达式树中构造我的 LINQ 查询......类似于下面的代码示例：

```
IQueryable<Data.Task> query = ctx.DataContext.Tasks;    

if (criteria.Number > 0)    
    query = query.Where(row => row.Number == criteria.Number);  

if (criteria.CustomerId != Guid.Empty)
    query = query.Where(row => row.Project.CustomerId == criteria.CustomerId);

if (criteria.ProjectId != Guid.Empty)
    query = query.Where(row => row.ProjectId == criteria.ProjectId);

var data = query.Select(row => TaskInfo.FetchTaskInfo(row));

this.AddRange(data); 
```

这很好用......但现在我想搜索具有特定标签的任务，例如会计或功能请求。

我可以通过完整的查询在 LINQPad 中执行此操作：

```
from t in Tasks
join l in Labels on t.TaskId equals l.SourceId 
where l.Name == "accounting"
select t 
```

无论如何使用表达式树来做到这一点？我被困住了！任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T21:49:54.657

查询表达式中的“join”（不是“join ... into”）子句转换为 Join 调用。棘手的一点是透明标识符 - 只有一个序列从连接中出来，并且它必须同时具有`t`和`l`在其中（在您的示例中），因此编译器会发挥一些作用。

我没有太多时间在这里详细介绍，但最好只向您展示您的查询表达式是如何翻译的。

这：

```
from t in Tasks
join l in Labels on t.TaskId equals l.SourceId 
where l.Name == "accounting"
select t 
```

被翻译成：

```
Tasks.Join(Labels, t => t.TaskId, l => l.SourceId, (t, l) => new { t, l })
     .Where(z => z.l.Name == "accounting")
     .Select(z => z.t) 
```

请注意此处“z”的引入——基本上它包含原始表达式中的 t 和 l。

编辑：大卫莫顿的回答提供了一种更有效的方法。他的行相当于：

```
from t in Tasks
join l in (from x in Labels where x.Name == "accounting") 
       on t.TaskId equals l.SourceId 
select t 
```

如果在 join 之后只有一个 select 子句，编译器可以跳过透明标识符，直接将投影作为 Join 调用的最后一个参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T21:47:41.743

我相信这应该这样做：

```
Tasks.Join(Labels.Where(l => l.Name == "accounting"), t => t.TaskId, l => l.SourceId, (t, l) => t) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T21:53:22.857

如果您单击 LINQPad 中的小 lambda 按钮，它将显示您尝试创建的表达式树，它位于结果框上方和表达式框下方的三个按钮的列表中。

# .htaccess - .htaccess 排序？

> ID：485404
> 
> 赞同：0
> 
> 时间：2009-01-27T21:40:19.527
> 
> 标签：.htaccess, apache2

对 .htaccess 文件的各个部分进行排序的最有效和最合乎逻辑的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T10:17:58.563

顺序取决于您想要表达的内容，因为指令是按照它们被发现的顺序应用的。但如果可能的话，我会把在开发过程中经常变化的部分放在首位，这样我会很快找到它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T18:50:04.573

如果可能的话，我会查看最新的 Apache 版本并在 apache.conf 文件上设计您的 htaccess 布局，看看 .htaccess 文件本质上是服务器配置的扩展。

# sql - 从数据库中的列值生成直方图

> ID：485409
> 
> 赞同：28
> 
> 时间：2009-01-27T21:41:37.763
> 
> 标签：sql, sql-server, histogram

假设我有一个这样的数据库列“等级”：

```
|grade|
|    1|
|    2|
|    1|
|    3|
|    4|
|    5| 
```

SQL 中是否有一种不平凡的方式来生成这样的直方图？

```
|2,1,1,1,1,0| 
```

其中 2 表示第 1 级出现两次，1s 表示第 {2..5} 级出现一次，0 表示第 6 级根本不出现。

我不介意直方图是否每次计数一行。

如果这很重要，那么数据库是由 perl CGI 通过 unixODBC/FreeTDS 访问的 SQL Server。

**编辑：**感谢您的快速回复！如果不存在不存在的值（如上例中的 6 年级）没有出现也没关系，只要我能确定哪个直方图值属于哪个年级。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-27T21:45:27.927

```
SELECT COUNT(grade) FROM table GROUP BY grade ORDER BY grade 
```

尚未验证它，但它应该可以工作。但是，它不会显示 6s 等级的计数，因为它根本不存在于表中......

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-12-22T03:09:44.713

如果有很多数据点，您还可以像这样将[范围分组在一起](https://web.archive.org/web/20180205094300/https://www.wagonhq.com/sql-tutorial/creating-a-histogram-sql "https://www.wagonhq.com/sql-tutorial/creating-a-histogram-sql 的存档")：

```
SELECT FLOOR(grade/5.00)*5 As Grade, 
       COUNT(*) AS [Grade Count]
FROM TableName
GROUP BY FLOOR(Grade/5.00)*5
ORDER BY 1 
```

此外，如果您想标记整个范围，您可以使用 CTE 提前获得地板和天花板。

```
With GradeRanges As (
  SELECT FLOOR(Score/5.00)*5     As GradeFloor, 
         FLOOR(Score/5.00)*5 + 4 As GradeCeiling
  FROM TableName
)
SELECT GradeFloor,
       CONCAT(GradeFloor, ' to ', GradeCeiling) AS GradeRange,
       COUNT(*) AS [Grade Count]
FROM GradeRanges
GROUP BY GradeFloor, CONCAT(GradeFloor, ' to ', GradeCeiling)
ORDER BY GradeFloor 
```

**注意**：在某些 SQL 引擎中，您可以`GROUP BY`使用序数列索引，但对于 MS SQL，如果您希望在`SELECT`语句中使用它，您还需要按它进行分组，因此也将范围复制到组表达式中。

**选项 2**：您可以使用[case 语句有选择地将值计数到任意 bin 中，然后对它们进行 unpivot](https://stackoverflow.com/a/52105218/1366033)以获得包含值的逐行计数

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-27T21:49:24.673

使用临时表来获取您的缺失值：

```
CREATE TABLE #tmp(num int)
DECLARE @num int
SET @num = 0
WHILE @num < 10
BEGIN
  INSERT #tmp @num
  SET @num = @num + 1
END

SELECT t.num as [Grade], count(g.Grade) FROM gradeTable g
RIGHT JOIN #tmp t on g.Grade = t.num
GROUP by t.num
ORDER BY 1 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-27T21:47:59.683

Gamecat 对 DISTINCT 的使用对我来说似乎有点奇怪，当我回到办公室时必须尝试一下......

我会这样做的方式虽然相似......

```
SELECT
    [table].grade        AS [grade],
    COUNT(*)             AS [occurances]
FROM
    [table]
GROUP BY
    [table].grade
ORDER BY
    [table].grade 
```

为了克服出现 0 次出现数据不足的问题，您可以 LEFT JOIN 到包含所有有效成绩的表中。COUNT(*) 将计算 NULLS，但 COUNT(grade) 不会计算 NULLS。

```
DECLARE @grades TABLE (
   val INT
   )  

INSERT INTO @grades VALUES (1)  
INSERT INTO @grades VALUES (2)  
INSERT INTO @grades VALUES (3)  
INSERT INTO @grades VALUES (4)  
INSERT INTO @grades VALUES (5)  
INSERT INTO @grades VALUES (6)  

SELECT
    [grades].val         AS [grade],
    COUNT([table].grade) AS [occurances]
FROM
    @grades   AS [grades]
LEFT JOIN
    [table]
        ON [table].grade = [grades].val
GROUP BY
    [grades].val
ORDER BY
    [grades].val 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-09-06T22:58:56.583

根据 Shlomo Priymak 的文章[How to Quickly Create a Histogram in MySQL](http://blog.shlomoid.com/2011/08/how-to-quickly-create-histogram-in.html)，您可以使用以下查询：

```
SELECT grade, 
       COUNT(*) AS 'Count',
       RPAD('', COUNT(*), '*') AS 'Bar' 
FROM grades 
GROUP BY grade 
```

这将产生下表：

```
grade   Count   Bar
1       2       **
2       1       *
3       1       *
4       1       *
5       1       * 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-27T21:46:16.363

```
select Grade, count(Grade)
from MyTable
group by Grade 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-29T23:40:25.557

我正在构建 Ilya Volodin 上面所做的事情，这应该允许您选择要在结果中组合在一起的等级范围：

```
DECLARE @cnt INT = 0;

WHILE @cnt < 100 -- Set max value
BEGIN
SELECT @cnt,COUNT(fe) FROM dbo.GEODATA_CB where fe >= @cnt-0.999 and fe <= @cnt+0.999 -- set tolerance
SET @cnt = @cnt + 1; -- set step
END; 
```

# php - 网站结构

> ID：485412
> 
> 赞同：5
> 
> 时间：2009-01-27T21:42:11.990
> 
> 标签：php, structure

我对 php 很陌生，我正在尝试确定组织页面的最佳方式，并使用 PHP 来交付它们。我有两个（基本）想法是：

*   一堆使用 PHP 的单独页面包括页眉、页脚和菜单。

*   具有菜单、页眉和页脚以及主要内容的包含的单个主页。页面名称来自 URL 中的变量。

有没有人有任何其他的建议或想法？这是非常基本的东西，但我想看看是否有人有更好的想法。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T21:56:54.097

我之前已经在两个方向上进行过，尽管它们都有优点和缺点，但我倾向于您的第二个选项，即包含布局的单个主页。这类似于母版页在桌面发布应用程序中的工作方式，并且 ASP.NET 很好地实现了这个想法 - 我并不是说您应该切换技术。

但是，如果您确实走这条路，请使用 mod_rewrite 将路径获取到 PHP 母版页，而不是 URL 中的查询字符串。您的 .htaccess 文件应包含以下内容：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [S=1]
RewriteRule ^(.*)$ /index.php?path=$1 [QSA] 
```

这基本上说明了他们要求的文件是否不存在，而不是使用查询字符串变量中的 URL 路径向 index.php 提供 404 错误移交处理。因此，“ [http://example.com/path/to/page](http://example.com/path/to/page) ”最终会在 $_GET['path'] 设置为“/path/to/page”的情况下访问 index.php。从那里您可以从数据库、平面文件或您拥有的文件中提取内容。您还可以根据请求的路径选择不同的模板。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T21:49:04.550

我喜欢包含标题和诸如此类的单个页面。

我必须维护一个网站，其中原始开发人员在 URL 中使用带有变量的单个页面，这很痛苦。除了添加新的类似页面之外，它很难进行任何更改。尽管他也使用了框架，但这也可能是问题的一部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T21:50:09.803

鉴于这两个选择，我会选择 2。如果您的网站增长到需要适当框架的水平，则移动单个页面而不包含所有 include('header.php'); 东西会容易很多。对于奖励积分，请使用模型和视图文件夹，分别在其中放置数据库访问和显示逻辑，并且您已经完成了[真正的 MVC 环境](http://en.wikipedia.org/wiki/Model-view-controller)的一半。

编辑以添加 - 带有条件包含的单个索引还为您的应用程序提供了一个单一的入口点，这对于安全性非常有价值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-28T10:48:38.237

**为什么只走了一半正确的方向？**使用现有的 MVC 框架之一。它们是强大的工具，可以比任何自定义解决方案更好地构建代码。选择 MVC，学习如何将业务逻辑与表示逻辑和数据结构分开，**增加你作为潜在员工在就业市场上的价值**，节省你的时间并让你快乐。

*   [Zend 框架](http://framework.zend.com/)
*   [蛋糕 PHP](http://cakephp.org/)
*   [Symfony 框架](http://www.symfony-project.org/)
*   [小花 PHP](http://kohanaphp.com/)

您可能应该开始（但不限于）Kohana PHP，因为它具有温和的学习曲线。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T21:52:34.090

PHP 的主要特点是您需要**“保持演示文稿和程序逻辑分开”**。或者换句话说，确保您没有在执行业务或处理逻辑的脚本中间将 html 回显到屏幕上。

您的第二个解决方案是该问题的一个相当普遍（而且还不错）的解决方案。它允许您使用所有布局信息构建单个页面，然后包含要呈现的特定页面内容。显然，如果您需要将大部分布局模板从一页交换到下一页，这将不会很好地工作。在这种情况下，您的第一个解决方案会更好。

最后，我强烈建议您查看现有的各种 PHP 框架，例如[Zend Framework](http://framework.zend.com)、[Symfony](http://www.symfony-project.org/)或[CakePHP](http://cakephp.org/)，看看它们是如何处理这个问题的。如果你找到了你喜欢的，那就用它吧。否则，您仍然可能会获得一些关于如何构建自己的网站的好主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T21:47:55.567

这实际上取决于您正在设计的网站。如果您想重新利用您的组件，那么使用包含的方法将起作用。您可以尝试拥有一种母版页，然后在其中呈现您想要的页面

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T21:50:19.647

在 header.php 中拥有菜单和页眉，在 footer.php 中拥有页脚、sopyright 等，让您的生活变得更加轻松。然后只需将这些文件包含到您创建的每个页面中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T21:51:29.660

要看。

页面的内容是否存储在数据库中？如果是这样，您最好为每个内容页面设置一个模板，该模板只从数据库中获取内容、标题和元信息并将其插入模板中。您甚至可以拥有不同类型的页面（新闻、静态内容页面、存档页面等），它们都可以有不同的模板。

如果内容位于或多或少的平面文件中，那么您的两个建议确实有效，我认为后一个是最容易维护的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-27T21:56:20.650

在过去使用这两种技术后，我发现前者更灵活，但它会鼓励不良做法。后者提供了更加一致的用户体验，因为它将所有站点范围的逻辑保存在一个地方，并阻止您做出一次性异常。

实际上，我正在将几年前编写的网站从包含的页眉/页脚/菜单模型转换为母版页模型。最初的 include 系统简洁明了，运行良好。但是，我创建的附加内容越多，我就越意识到该项目开始违反[DRY 原则](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。网站上的每一页都以相同的方式开始和结束（重复应该总是发出警告信号），我很想通过省略单个包含并编写一次性替换来对标准布局做出例外。（谢天谢地，我没有经常屈服于这种诱惑！）

重构站点使页面更加一致，布局更易于更新（您可以“一目了然”看到整个内容），并且更易于创建新页面。

# haskell - 函数式语言的显着特征

> ID：485418
> 
> 赞同：19
> 
> 时间：2009-01-27T21:42:51.380
> 
> 标签：haskell, f#, functional-programming, erlang, clojure

众所周知，所有函数式语言都共享一些基本属性，例如将函数用作程序的基本构建块，并具有所有后果，例如使用递归而不是迭代。但是，也存在一些根本性差异。Lisp 对 Lisp 代码和数据使用单一表示，而 ML 没有 ML 代码的标准表示。Erlang 有一个内置的基于actor的并发。Haskell 有单子。Haskell 在静态类型系统中区分了纯函数和不纯函数；机器学习没有。

其他函数式语言（Clojure、F#、Arc 等）之间有哪些显着的**根本区别？**基本我的意思是影响你用这种语言开发的方式，而*不是*例如它是否与一些广泛传播的运行时集成。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-28T01:54:45.800

在我的头顶上：

*   [*懒惰*与*急切*](http://en.wikipedia.org/wiki/Evaluation_strategy)（又名*非严格*与*严格*或*按需*调用与*按值调用*）：函数参数是在函数应用之前评估，还是之后评估，还是从不评估？
*   [*纯*与*不纯*](http://en.wikipedia.org/wiki/Referential_transparency_(computer_science))：语言是否允许函数具有副作用？它有可变引用吗？
*   [*静态*与*动态*](http://en.wikipedia.org/wiki/Type_system)：语言是否在编译时或运行时检查类型？
*   [*代数数据类型*](http://en.wikipedia.org/wiki/Algebraic_data_type)：语言是否支持变体类型的模式匹配？
*   [*元编程*](http://en.wikipedia.org/wiki/Metaprogramming)：该语言是否提供强大的代码生成系统？
*   [*并发性*](http://en.wikipedia.org/wiki/Concurrency)和[*并行性*](http://en.wikipedia.org/wiki/Parallelism)：线程/进程是一流的抽象吗？该语言是否可以轻松地同时运行多个计算？
*   *“异国情调”类型*：静态类型系统的表现力如何？GADT？依赖类型？线性类型？F系统？

只有前两项是函数式语言真正独有的（即，几乎所有命令式语言都是急切的和不纯的）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-28T13:43:48.867

我喜欢 Chris Conway 的回答，它陈述了一些有助于对不同功能语言进行分类的重要轴。

在特定语言的特性方面，我将选择**[F#](http://fsharp.net)**来调出许多其他 FPL 中没有的一些特性：

*   **活动模式**：许多 FPL 具有代数数据类型和模式匹配，但称为“活动模式”的 F# 功能允许您定义允许您对任意数据使用模式匹配语法的新模式。
*   **计算表达式**：F# 有一些用于编写单子代码的漂亮语法糖；虽然类型系统不能表达更高种类的多态性（没有对类型构造函数的抽象）所以你不能为任意的 monad M 编写代码，你可以为固定的 monad 编写的代码非常酷，人们在seq{} 或 async{} 单子。
*   **引用**：通常的“代码作为元编程的数据”位，尽管 F# 具有富有表现力的静态类型系统和丰富的语法，但我不确定有多少非 lisps 可以做到这一点。

在一般分类方面，F# 是

*   **急切**（严格，按值调用；但 'lazy' 是一个关键字和库，使用 seq/IEnumerable 来处理一些惰性是一种常见的策略）
*   **不纯**的（尽管语法使您偏向于更纯的默认样式）
*   **静态**的（带有类型推断，所以 F# 经常“感觉像脚本”，只有类型安全）

你的问题的措辞明显偏向于一些额外的语言语用学（例如它与什么运行时集成），但你也问什么“影响你的开发方式”，这些事情确实会影响：

*   Visual Studio 集成意味着**出色的编辑体验**（例如 Intellisense）
*   Visual Studio 集成意味着**出色的调试体验**（例如断点/跟踪点、本地变量、即时窗口……）
*   **用于脚本或 UI-on-the-fly 的REPL**是热门（fsi.exe 命令行，或集成在 VS 中的“F# Interactive”）
*   .NET 集成意味着对于大多数“X”来说，已经有一个库可以做到这一点
*   FsLex/FsYacc 等辅助工具，以及与 MSBuild 的集成，这使得“构建系统”变得容易

（我认为尝试将一种语言与其运行时和工具分开是一项学术活动。）

因此，我对一种特定语言的许多独特特征进行了描述，我是该语言的粉丝。我希望其他人可能会发布类似的答案，以突出其他个别语言的独特特征。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-06T03:05:18.067

1.  非严格与严格评估。

2.  静态与动态类型。

3.  结构与名义静态类型。OCaml 是我能想到的唯一一种结构类型（在对象和多态变体中）的语言，它通过消除定义许多类型（例如变体类型）的需要来缩小与动态类型的差距。

4.  Hindley-Milner 导数与其他静态类型推理算法。SML、OCaml、Haskell 和 F# 使用基于 Hindley-Milner 的类型推断算法，而 Scala 只有本地类型推断（如 C# 3）并且需要更多注释才能编译。（Haskell 代码通常在函数级别上充满了类型注释，但大多数都是不必要的，并且添加用于文档并在出现错误时帮助编译器）。

5.  模式匹配与手动解构。SML、OCaml、F#、Haskell、Mathematica 和 Scheme 自动解构值。

6.  封闭总和类型与仅开放总和类型。SML、OCaml、F# 和 Haskell 允许定义封闭/密封代数类型，以通过隐式传递更具体的约束来加强静态类型。OCaml 和 F# 也允许开放求和类型，而 SML 不允许，Haskell 需要精心设计的解决方法（由 Oleg Kiselyov 描述）。

7.  限时模式。模式匹配在 SML 和（普通）OCaml 中非常快，但在 F# 中由于活动模式甚至 Mathematica 中未知的渐近复杂性而具有未知的性能。

8.  即时编译为本机代码。F#、Lisp 和 Scheme 允许在运行时高效地生成、编译和执行代码。

9.  宏。OCaml、Mathematica、Lisp 和 Scheme 是可扩展的语言。

10.  Standardized vs proprietary. SML, Haskell 2010, Common Lisp and Scheme are standardized languages whereas OCaml, Erlang, F# and Mathematica are proprietary.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-30T03:10:23.753

有很多差异，但**我认为只有两个差异是基本**的，因为它们对您的发展有很大的影响：

1.  具有代数数据类型和类型推断的动态类型与静态、多态类型系统。静态类型系统在一定程度上限制了代码，但有很多优点：
    *   类型是编译器检查的文档。
    *   类型系统可帮助您选择接下来要编写的代码，当您不确定要编写什么代码时，类型系统可帮助您轻松快速地排除许多替代方案。
    *   一个强大的、现代的、多态的类型系统非常擅长检测小的、愚蠢的、浪费时间的错误。
2.  延迟评估作为默认值无处不在，而延迟评估仅限于仔细控制的构造。
    *   懒惰与渴望对您预测和理解程序的时间和空间成本的能力有巨大的影响。
    *   在一种完全惰性的语言中，您可以将数据的生成与关于如何处理*生成的数据的决策完全分离。*这对于搜索问题尤其重要，因为模块化和重用代码变得更加容易。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-27T21:47:45.143

**函数式编程是一种风格，而不是一种语言结构**

大多数函数式语言都有一些共同的原则：

*   不可变对象
*   闭包和匿名函数
*   通用算法
*   继续

但最重要的原则是，它们通常会迫使你以功能性风格写作。您可以使用几乎任何语言以功能样式进行编程。如果您编写这样的代码，C# 可以被认为是“功能性的”，就像任何其他语言一样。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-27T21:47:57.670

基本属性？

*   功能纯度（无副作用）
*   作为上述的搭配，缺乏状态。
*   函数中的模式匹配

第一个是美丽的，第二个是前者的丑陋副作用（双关语）。

我发现对状态缺失的现实补偿是函数式语言之间最大的区别。

这几样东西给了很多免费赠品。大多数时候，语言处理记忆。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-28T01:12:52.297

当您说代码作为数据时，您指的是一种以数据结构表示代码的语言。这被称为[Homoiconicity](http://en.wikipedia.org/wiki/Homoiconicity)，它通常只适用于 lisp 方言或接近它的语言。Haskell、Erlang 和 Scala 不是 Homoiconic，Clojure 是。

Clojure 的基本区别在于：

1.  它有一个软件事务内存系统，这使得共享状态并发编程更容易

2.  它是一个 Lisp，与 Haskell 或 Erlang 不同，因此所有代码都是数据，它允许您通过宏系统在运行时对语言本身进行看起来像的更改

3.  它在 JVM 上运行，这意味着您可以直接访问所有 J​​ava 库

4.  Clojure 数据结构在适当的地方实现了 Java 接口，例如 Collection、List、Map、Runnable 和 Callable。字符串只是 Java 字符串，数字是 Java 整数和双精度数。这意味着 Clojure 数据结构可以直接传递给 Java 库，无需任何桥接或翻译

# java - 使用 DCM4CHEE 实现 MySQL 国际化

> ID：485428
> 
> 赞同：1
> 
> 时间：2009-01-27T21:45:08.880
> 
> 标签：java, mysql, internationalization, collation

我正在尝试使用 MySQL 国际化 dcm4chee（一个基于 Java 的开源医学影像存储系统），并且有很多问题。

这是我到目前为止所知道的 1\. 我需要在 MySQL 中将字符集从 latin1 更改为 utf8 （以支持所有国际字符） 2\. 我很确定我想将排序规则设置为 utf8_unicode_ci

以下是我需要知道的 1\. 我应该如何/何时做这些事情？一个。可以对现有表进行这些更改吗？湾。如果是这样，我该怎么做？C。在数据库的整个生命周期中，这些更改是否只需要进行一次？d。所做的更改会仅影响未来的条目还是所有条目？2\. 如何更改 dcm4chee 未来安装的默认值以使用 utf8？3\. 从我的研究看来，改变字符集和排序规则以使用足够宽的字符集 (utf8) 是我需要做的所有事情来国际化 MySQL。这是真的？如果没有，我还需要做什么？

谢谢，对此的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T21:05:04.643

我不是专家，但过去我不得不更改数据库上的字符集/排序规则。

1.  a) 您可以随时更改 MySQL 表。在进行更改之前备份您的数据库。

    b) 来自[每个开发人员每天面临的挑战的](http://devcha.blogspot.com/2008/03/convert-existing-mysql-database-from.html)SQL 查询：

    > ALTER TABLE db_table CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci;

    c) 应该只需要更改一次。如果创建新表，请注意确保使用正确的字符集创建它们。

    d) 更改将影响未来/现有条目（但如果由于先前的字符集，旧表条目是垃圾字符而不是预期的 UTF8 字符，则此更改不会神奇地将它们更改为预期状态）。

2.  对不起，我从未使用过 dcm4chee。如果数据库是预先构建的并与安装捆绑在一起，那么您将不得不更改捆绑的数据库。如果数据库是在安装软件时构建的，您必须找到源代码的这一部分并更改“CREATE TABLE...”SQL 查询，以便它使用适当的字符集创建表。在每个源文件中搜索“CREATE TABLE”可能是个好主意，以确保没有遗漏。

3.  在我有限的 MySQL 经验中，更改字符集/排序规则足以使数据库国际化。我只有中文+英文数据库的经验，虽然每次更改字符集/排序规则后我都没有遇到任何问题。

# .net - 温莎城堡：那么 ActAs 是做什么的？

> ID：485430
> 
> 赞同：4
> 
> 时间：2009-01-27T21:45:25.540
> 
> 标签：.net, castle-windsor, fluent-interface

我注意到 Castle Windsor fluent 组件注册接口有相当混乱的 ActAs() 方法。

谷歌搜索它，我发现的唯一参考是在他们的 wiki[上](http://using.castleproject.org/display/IoC/Fluent+Registration+API)。

> TODO（可以记录的东西）
> 
> *   ActAs() 是做什么的？

不太有帮助。

来源似乎没有任何单元测试可以提供有关其用法的线索，而且我对他们的来源太不熟悉，无法自己告诉自己发生了什么。

有人知道更多吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T01:42:02.240

它将[自定义依赖项（标签）添加](http://fisheye2.atlassian.com/changelog/castleproject?cs=4961)到正在注册的组件中。例如，WcfFacility[使用](http://www.castleproject.org/container/facilities/trunk/wcf/index.html)[这些附加的依赖](http://fisheye2.atlassian.com/browse/castleproject/trunk/Facilities/Wcf/Castle.Facilities.WcfIntegration/Service/WindsorServiceHostFactory.cs?r=5525#l93)项来[设置端点和其他东西](http://fisheye2.atlassian.com/browse/castleproject/trunk/Facilities/Wcf/Castle.Facilities.WcfIntegration.Tests/Rest/RestServiceFixture.cs?r=5525#l36)。

# silverlight - DataGrid 中的 Silverlight DataGridRows - 如何有选择地隐藏它们？

> ID：485437
> 
> 赞同：1
> 
> 时间：2009-01-27T21:46:37.470
> 
> 标签：silverlight, datagrid

我有一个 ObservableCollection 提供一个很好更新的 DataGrid。

要点：我想过滤（折叠）行而不将它们从集合中删除。

有没有办法做到这一点，或者像普通的.Net一样在网格上放置一个视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T11:46:13.527

我刚刚[在我的博客上发表了一篇文章来解决这个确切的问题](http://petermcg.wordpress.com/filtering-silverlight-datagrid-rows)。

附在帖子中的是一个简单的演示应用程序，它演示了如何实现您想要的。

该解决方案应该足够通用以便可重用，并且基于以下自定义扩展方法：

```
public static class Extensions
{
    /// <summary>
    /// Applies an action to each item in the sequence, which action depends on the evaluation of the predicate.
    /// </summary>
    /// <typeparam name="TSource">The type of the elements of source.</typeparam>
    /// <param name="source">A sequence to filter.</param>
    /// <param name="predicate">A function to test each element for a condition.</param>
    /// <param name="posAction">An action used to mutate elements that match the predicate's condition.</param>
    /// <param name="negAction">An action used to mutate elements that do not match the predicate's condition.</param>
    /// <returns>The elements in the sequence that matched the predicate's condition and were transformed by posAction.</returns>
    public static IEnumerable<TSource> ApplyMutateFilter<TSource>(this IEnumerable<TSource> source,
                                                                  Func<TSource, bool> predicate,
                                                                  Action<TSource> posAction,
                                                                  Action<TSource> negAction)
    {
        if (source != null)
        {
            foreach (TSource item in source)
            {
                if (predicate(item))
                {
                    posAction(item);
                }
                else
                {
                    negAction(item);
                }
            }
        }

        return source.Where(predicate);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T21:08:15.810

如果您在可观察集合之上有一个视图，则可以实现这一点。我写了一篇关于过滤 Silverlight 数据网格的文章。您有一个 FilteredCollectionView，您可以在其上添加任何 IFilter。这是文章的链接：

[http://www.codeproject.com/KB/silverlight/autofiltering_silverlight.aspx](http://www.codeproject.com/KB/silverlight/autofiltering_silverlight.aspx)

希望它可以帮助你。

# asp.net - AJAX Accordion 中的 ASP FileUpload 控制器

> ID：485438
> 
> 赞同：0
> 
> 时间：2009-01-27T21:46:47.097
> 
> 标签：asp.net, controls

我在 AJAX Accordion 中有一个 FileUpload 控制器和按钮，但我无法正常工作。问题是 FileUpload Controller 需要完整的回发才能工作。但是，由于控件位于更新面板内，asp 决定进行部分回发。通常，您只需将 ControlId 放入更新面板上的触发器中。但是，由于手风琴使用不同的命名空间，您无法（至少直接）执行此操作。

你会建议我如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T00:38:04.677

您可以在更新面板上将 ChildrenAsTriggers 属性设置为 false，同时 UpdateMode 是有条件的。然后对面板的任何更新都需要明确编码。从未尝试过，但它可能会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T13:27:37.153

只要手风琴窗格都有自己的更新面板，您就可以将控件 ID 放入回发触发器中。

```
 <ajaxToolkit:AccordionPane
                                HeaderCssClass="accordionHeader"
                                HeaderSelectedCssClass="accordionHeaderSelected"
                                ContentCssClass="accordionContent">
                                <Header><asp:LinkButton ID="lbtnOption1" runat="server">Option 1</asp:LinkButton></Header>
                                <Content>
                                    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
                                        <ContentTemplate>
                                             /* Put HtmlInputFile and upload button here*/
                                        </ContentTemplate>                  
                                        <Triggers>
                                              <asp:PostBackTrigger ControlID="btnUpload" />
                                        </Triggers></asp:UpdatePanel>                                        
                                </Content>
                            </ajaxToolkit:AccordionPane> 
```

# command-line - 使用 Windows 进行命令行压缩

> ID：485447
> 
> 赞同：1
> 
> 时间：2009-01-27T21:49:05.953
> 
> 标签：command-line, zip, command

> **可能重复：**
> [可以编写 Windows 的内置 ZIP 压缩脚本吗？](https://stackoverflow.com/questions/30211/can-windows-built-in-zip-compression-be-scripted)

我正在尝试通过命令行为 SSIS 包压缩文件。我知道 7-Zip 是一个很棒的开源工具，但我将要部署的服务器也没有 7-Zip。

我拥有的唯一工具是 Windows Compress.exe 和 Compact.exe。但是，在尝试此操作时，它似乎会创建无效/损坏的 zip 文件。

```
This is what I have tried:
Compress -z c:\test.xls c:\test.zip
Compress -zx c:\test.xls c:\test.zip
Compress c:\test.xls c:\test.zip 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T06:28:06.543

DotNetZip 包含可以包含在脚本中的命令行工具。它适用于 NTFS ;) 它是免费的、开源的。

[CodePlex 上的 DotNetZip](http://www.codeplex.com/DotNetZip)

```
c:\temp> zipit -?
Zipit.exe:  zip up a directory, file, or a set of them, into a zipfile.
            Depends on Ionic's DotNetZip library. This is version 1.8.2.13 of the utility.
usage:
   ZipIt.exe <ZipFileToCreate> [arguments]

arguments:
  -utf8                 - use UTF-8 encoding for entries with comments or
                          filenames that cannot be encoded with the default IBM437
                          code page.
  -aes                  - use WinZip-compatible AES 256-bit encryption for entries
                          subsequently added to the archive. Requires a password.
  -sfx [w|c]            - create a self-extracting archive, either a Windows or console app.
  -64                   - use ZIP64 extensions, for large files or large numbers of files.
  -cp <codepage>        - use the specified numeric codepage for entries with comments
                          or filenames that cannot be encoded with the default IBM437
                          code page.
  -p <password>         - apply the specified password for all succeeding files added.
                          use "" to reset the password to nil.
  -c <comment>          - use the given comment for the next file added to the archive.
  -zc <comment>         - use the given comment for the archive.
  -d <path>             - use the given directory path in the archive for
                          succeeding items added to the archive.
  -s <entry> 'string'   - insert an entry of the given name into the
                          archive, with the given string as its content.
  -flat                 - store the files in a flat dir structure; do not use the
                          directory paths from the source files.
  <directory> | <file>  - add the directory or file to the archive. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T01:33:55.407

据我所知，compress.exe 不是广泛使用的 (PK-)Zip 格式，而是用于设置和 cab 文件的 MS 特定压缩。

用它压缩的文件的扩展名曾经是._??，例如program._xe。

# c++ - 以编程方式访问笔记本电脑上的 CPU 风扇？（视窗）

> ID：485448
> 
> 赞同：21
> 
> 时间：2009-01-27T21:49:19.977
> 
> 标签：c++, windows, acpi

是否有 Windows 标准方法可以从 C/C++ 执行“启动风扇”、“降低速度”等操作？

我怀疑它可能是 ACPI，但我是一个虚弱的凡人，无法阅读那种文档。

编辑：例如，Windows 7 允许您在电源计划选项中进行选择，例如“被动冷却”（仅当事情变热时？）与“主动冷却”（保持 CPU 主动冷却？）。似乎操作系统确实有办法控制风扇。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-06-02T22:44:32.627

我目前正在做一个项目，其中包括控制电脑风扇。基本上，风扇是由你电脑的 superIO 芯片控制的。我们使用端口映射的 IO 直接访问芯片，从那里我们可以访问逻辑风扇设备。使用端口映射 IO 需要代码在内核模式下运行，但 windows 不提供任何通用端口 IO 驱动程序（有充分的理由，因为它是一个非常强大的工具），所以我们编写了自己的驱动程序并使用了它。

如果你想走这条路，你基本上需要两个方面的知识：驱动程序开发以及如何访问和解释 superIO 芯片信息。当我们开始这个项目时，我们对这两个领域都一无所知，所以它一直在通过浏览、阅读和最终做来学习。为了获得知识，我们通过查看这些链接得到了特别帮助：

1.  [WDK](https://docs.microsoft.com/en-us/windows-hardware/drivers/)，即 Windows 驱动程序工具包。你需要它来编译你为 Windows 编写的任何驱动程序，它附带了很多源代码，例如驱动程序，包括一个用于通用端口映射 IO 的驱动程序，称为 portio。
2.  [WinIO](http://www.internals.com/)有 C 语言驱动程序的源代码、以编程方式安装和加载该驱动程序的 C 语言 dll 以及一些用于 GUI 的 C# 代码，用于加载 dll 并读取/写入端口。驱动程序与 portio 中的驱动程序非常相似。
3.  [lm-sensors](http://www.lm-sensors.org/)是一个 linux 项目，除其他外，它可以检测您的 superIO 芯片。/prog/detect/sensors-detect 是执行检测的 perl 程序，我们花了一些时间查看代码以了解如何与 superIO 芯片接口。
4.  当我们检查 lm-sensors 代码时，拥有[RapidDriver](http://www.entechtaiwan.com/dev/rapid/index.shtm)和[RW-everything 之](http://jacky5488.myweb.hinet.net/)类的工具非常好，因为它们允许我们模拟传感器检测的运行。后者功能更强大，对 IO 空间的可视化非常有帮助，而前者提供了对某些操作的更轻松访问，这些操作更好地映射到传感器检测中的操作（读/写字节到端口）
5.  最后，您需要找到您的 superIO 芯片的数据表。从我所看到的示例中，每个芯片的环境控制器都提供类似的功能（读写风扇速度、读取温度、读取芯片电压），但是您必须写入哪些寄存器才能获得此功能. [这个](http://www.alldatasheet.com/)地方有我们目前需要的所有数据表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-21T21:53:30.183

如果您想要真正快速地将风扇降低到您知道事情不会过热的水平，那么可以使用 speedfan 程序。弄清楚如何在早期版本中配置它以在计算机启动时自动将风扇降低到 50% 非常痛苦，以至于我的第一个方法是简单地对其进行字节修补，以启动我仅有的低速超级管理风扇。较新的版本仍然有点困难，但它是可行的 - 有一个图形滑块系统，看起来像音频均衡器，除了 x 轴是温度，y 是风扇速度。你把它们一一拖下来。在您弄清楚如何手动控制您想要的风扇之后，这是下一步。

有一个使用 C# 监控硬件（如风扇）的项目： [http ://code.google.com/p/open-hardware-monitor/](http://code.google.com/p/open-hardware-monitor/)

我没有深入研究它，但至少 WinRing0.sys 的源代码和使用给人的印象是，如果你知道你有什么风扇控制器并拥有数据表，它应该可以修改以设置值而不是仅仅获取它们. 我不知道什么工具适合（除了内核调试器）来查看 Speedfan 的功能，如果您更喜欢窥探并模仿 speedfan 而不是查看数据表并尝试一下。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T21:52:40.517

是的，这将是 ACPI，据我所知，windows 并没有从用户空间对它进行太多/任何控制。因此，您必须开始使用驱动程序，这在 Windows 上几乎是不可能的。

也就是说，[谷歌透露](http://sourceforge.net/projects/tp4xfancontrol)有一些针对特定硬件的开源 Windows 库......所以根据你的硬件，你可能会找到一些东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T22:47:10.657

ACPI 可能允许也可能不允许您调整风扇设置。但是，某些 BIOS 实现可能不允许该控制——它们可能会根据 BIOS/CMOS 设置强制控制。在 BIOS 控制（甚至自定义）不足的情况下，可能很难找到一个*好的用例。*我遇到过 BIOS 控制确实不足的情况，但并非适用于所有可能的主板平台。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T23:01:28.960

WIndows Management Instrumentation 库 (WMI) 确实提供了[Win32_Fan 类](http://msdn.microsoft.com/en-us/library/aa394146(VS.85).aspx)，甚至提供了 SetSpeed 方法。唉，文档说这没有实现，所以我想这不是很有帮助。但是您可以通过设置电源状态来控制事物。

# smalltalk - Smalltalk 的 whileTrue 消息是如何在幕后实现的？

> ID：485451
> 
> 赞同：2
> 
> 时间：2009-01-27T21:49:25.517
> 
> 标签：smalltalk

我正在尝试自学 Smalltalk。[一个教程](http://objectsroot.com/squeak/squeak_tutorial-2.html#ss2.5)有这个while循环的例子：

```
|i| 
i:=5\. 
[i >0] whileTrue:[ 
 Transcript show: ((i*2) asString) ; cr. 
 i:=i-1\. 
]. 
```

据我了解，whileTrue 是发送到 BlockClosure 的消息，告诉接收方 BlockClosure 运行作为参数给出的 BlockClosure，只要接收方为真。

BlockClosure 响应的 whileTrue 消息是如何在 Smalltalk 中没有 while 循环结构的情况下实现的？或者它是用运行时编写的任何语言实现的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T23:47:10.037

在我的 VisualWorks 图像中，它是通过递归完成的：

```
whileTrue: 一个块

   ^自我价值
      如果真实：
      [aBlock 值。
      [self 值] whileTrue: [aBlock 值]]

```

但是，还有一个注意事项，如果接收者和参数都是文字块，编译器将内联 #whileTrue: 调用。因此，在大多数情况下，您还可以考虑#whileTrue：一种“神奇”消息，在语法上看起来像消息发送，但实际上已优化为不同的字节码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T22:27:19.497

根据[这个论坛](http://www.groupsrv.com/computers/about253216.html)， whileTrue 不是真正的消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-22T08:20:36.570

如前所述：编译器在我已知的所有实现中作弊和内联。因此，在正常情况下并不需要该方法存在，并且通常不会调用它。然而，当执行或解释动态生成的代码结构而不实际使用编译器时，该方法可能很有用。

顺便说一句，由于 Smalltalk 语言标准（实际上并不存在）并不强制实现消除尾调用（例如，与 Scheme 相比），VW 中的递归实现对于执行或解释并不是真正有用（除非编译器作弊是标准化的）。

没有递归的替代方法可能是：

```
whileTrue:aBlock
    self value ifFalse:[^ nil].
    aBlock value.
    thisContext restart 
```

# javascript - 获得原始目标的最佳方法

> ID：485453
> 
> 赞同：28
> 
> 时间：2009-01-27T21:50:00.927
> 
> 标签：javascript, jquery, events, dom, delegates

什么是 jQuery 之类的和/或在 jQuery（或一般的浏览器 javascript 中）获取事件的原始目标的最佳实践方式。

我一直在使用这样的东西

```
$('body').bind('click', function(e){
        //depending on the browser, either srcElement or 
        //originalTarget will be populated with the first
        //element that intercepted the click before it bubbled up
        var originalElement = e.srcElement;
        if(!originalElement){originalElement=e.originalTarget;}                         
}); 
```

这有效，但我对两行特征嗅探不满意。有没有更好的办法？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-27T21:56:19.060

您可以在一行中完成它，`var originalElement = e.srcElement || e.originalTarget;`但它不像 JQuery ;-)

[编辑：但根据[http://docs.jquery.com/Events/jQuery.Event#event.target](http://docs.jquery.com/Events/jQuery.Event#event.target) `event.target`可能会...]

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-27T22:07:52.063

我相信 e.target 是您所需要的

```
$('body').bind('click', function(e){
                e.target // the original target
                e.target.id // the id of the original target                                               
}); 
```

如果您访问[jQuery in Action 网站](http://www.manning.com/bibeault/)并下载源代码，请查看

*   **第 4 章 -** dom.2.propagation.html

它使用气泡和捕获处理程序处理事件传播

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2011-01-27T13:35:07.020

使用`event.originalTarget`会导致“Permission denied to access property 'XYZ' from a non-chrome context”-错误，所以我建议使用以下内容：

```
var target = event.target || event.srcElement || event.originalTarget; 
```

`event.target`适用于 Firefox、Opera、Google Chrome 和 Safari。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-02T18:08:55.327

结合[如何检测元素外的点击？](https://stackoverflow.com/questions/152975/how-to-detect-a-click-outside-an-element "如何检测元素外的点击？")以下是您可以如何捕获具有类似的“点击时隐藏”功能的子小部件，以防止您自己的弹出窗口与其一起隐藏；在这种情况下，我们将捕获 JQuery UI Datepicker 弹出窗口小部件：

```
// not using jquery .one handler for this, so we can persist outside click later
$('html').click(function(evt) {
    // just return if element has the datepicker as a parent
    if ($(evt.target).parents('#ui-datepicker-div').length>0) return;

    //toggle shut our widget pop-over
    $('#mywidget').toggle();

    // now, unbind this event since our widget is closed:
    $(this).unbind(evt);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-27T11:20:21.063

在普通的 Javascript 中，var t = (e.originalTarget)?e.originalTarget:e.srcElement; 应该足以在所有浏览器中阅读它。

# editor - 您使用什么编辑器进行 OpenLaszlo 编码？

> ID：485469
> 
> 赞同：7
> 
> 时间：2009-01-27T21:53:15.540
> 
> 标签：editor, openlaszlo

我是在 OpenLaszlo 中开发的新手，并且尝试过 Eclipse（希望代码完成得体），但发现它对我的口味来说太重了。回退到使用 Textmate，但 OpenLaszlo 的捆绑包已经过时了。

有什么建议么？还是我应该卷起袖子为 Textmate 写一个新包？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T14:50:41.233

我个人使用[SpketIDE](http://www.spket.com/)作为 Eclipse 插件。它有一些代码完成，良好的语法突出显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T16:08:03.467

我为此使用 VIM。OpenLaszlo 附带的 VIM 模式可以识别 XML 标记和嵌入的 JavaScript。当然，如果您还不是 VIM 用户，那么这是一个需要深入研究的大项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T13:46:21.683

如果您使用支持 XSD 模式的文本编辑器或 XML 编辑器，则可以使用此[OpenLaszlo 模式生成器](http://code.google.com/p/openlaszlo-schemagenerator/)工具生成应用程序的自定义 XSD 文件。该工具使用 Ant 生成模式文件，然后可以由您选择的编辑器使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T05:55:04.617

我们使用了 Visual Studio。我们将它用作出色的 XML 编辑器。我还使用了 Notepad2，因为它非常轻量并且有语法高亮。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T19:46:03.393

否则我不会添加它，但是由于提到了它的宿敌 VI(m)：

[Emacs](http://en.wikipedia.org/wiki/Emacs)

值得上市。:)

在对 OL 了解不多的情况下，我很确定它拥有的众多模式之一可以为您的编辑需求提供一定程度的支持。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T11:03:53.937

我一直在使用 Notepad++ 并选择了 XML 语言（因为 Open Laszlo 基本上只是 XML 和 javascript）。简单，但有效且免费。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-14T19:55:25.227

自 2006 年以来，我一直在 OpenLaszlo 中进行开发。我目前使用 NotePad++，将 .lzx 文件设置为解释为 XML 文件，这允许代码以不同颜色突出显示，用于构成 OpenLaszlo 代码的不同部分（XML 节点， JavaScript/AS3 等）。

您可以在以下网址找到 NotePad++： http: [//notepad-plus-plus.org/](http://notepad-plus-plus.org/)

这是免费的。

我只是通过将其加载到 Web 浏览器页面来测试我的应用程序。

# vb.net - 这个 Lambda 是怎么回事？

> ID：485473
> 
> 赞同：0
> 
> 时间：2009-01-27T21:54:21.637
> 
> 标签：vb.net, lambda

```
Dim count As Func(Of Integer, Boolean) = Function(x As Integer) x = 1

If (count(GetSelectedCount())) Then
    'Proceed
Else
    MessageBox.Show("You can only select one item at a time.", "Multiple items selected", MessageBoxButtons.OK)
End If 
```

GetSelectedCount 返回网格中选中的项目数。未选择任何内容时返回 0。Lambda 应该仅在选择 1 个项目时返回 true。消息框应仅在选择 > 1 个项目时运行。即使没有选择任何项目，我也会收到消息框。

解决方案 ~ 决定放弃 Lambda 去老学校

```
Select Case GetSelectedCount()
    Case 1

    Case Is > 1
        MessageBox.Show("You can only select one item at a time.", "Multiple Selection", MessageBoxButtons.OK)
    Case Else
        MessageBox.Show("You have no items selected.", "No Selection", MessageBoxButtons.OK)

End Select 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T21:57:13.597

= 运算符在 VB.Net 中为赋值和相等提供双重任务。是否有可能在这里被错误地解释为赋值？试试这个：

```
Dim count As Func(Of Integer, Boolean) = Function(x As Integer) Return x = 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T22:00:34.883

您的 lambda 函数（检查是否选择了一项）和您声明的目标（如果选择了 >1 项，则运行消息框）不是相互排斥的。两者都没有涵盖没有选择任何项目的情况。

因此，如果未选择任何项目，则“x=1”为假，因此“If”语句失败，您将进入消息框。

怎么写

```
Dim count As Func(Of Integer, Boolean) = Function(x As Integer) (x <= 1) 
```

??

# sql - (MySQL) OrderBy Field1=3, Field2

> ID：485489
> 
> 赞同：1
> 
> 时间：2009-01-27T21:57:18.107
> 
> 标签：sql, mysql

我想订一张桌子：

首先按 Field1=3 然后按 Field2 DESC

我知道我不能写 OrderBy Field1=3, Field2 DESC

那么我该如何实现呢？

澄清：

假设我有一张书桌。我希望列出表中的所有书籍。我希望 1990 年的书籍出现在顶部，然后按标题的字母顺序排列其余书籍。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T22:03:41.353

实际上，你可以写你说你不能的陈述。使用您的说明示例：

```
SELECT * FROM Books ORDER BY (year = 1990) DESC, name 
```

对于年份为 1990 的年份，“year = 1990”将为“1”，因此它们将位于顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T22:01:28.970

这是 TSQL 而不是 MySQL，但它应该给你的想法......

（假设我理解你的问题......）

```
ORDER BY
    CASE WHEN Field1 = 3 THEN 0 ELSE 1 END    ASC,
    Field2                                   DESC 
```

# grails - Controllers in Grails

> ID：485490
> 
> 赞同：7
> 
> 时间：2009-01-27T21:57:28.493
> 
> 标签：grails, controller, grails-orm

I'm writing a small webapp in Grails and I have the following question regarding best practices for controller design and using GORM:

I'm storing the user object in session.user. Currently all my action methods start with the following code to make sure a valid user is logged in and that the user object is fresh:

```
class FooController {
  def actionMethodThatRequiresAValidUser = {
    if (!session?.user) {
      redirect(controller: "authentication", action: "login")
    }
    session.user.refresh()
    ...
    /* do stuff */
    ...
  }
} 
```

Is that best practice? Can it be done in a better and/or more concise way?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T22:23:45.290

Use a [filter](http://grails.org/doc/1.0.x/guide/6.%20The%20Web%20Layer.html#6.6%20Filters), that way you can put that same repeated code in the filter and keep your controllers focussed on the real action.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T08:48:02.753

I think using beforeInterceptor is appropriate.And give some look at this [JSecurity plugin](http://grails.org/JSecurity+Plugin).For user authentication jsecurity plugin is very useful.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T22:29:07.603

You might try defining this as a [filter](http://grails.org/Filters) rather than [duplicating code](http://en.wikipedia.org/wiki/Code_duplication).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T22:35:23.723

I agree with the filter suggestions others have made. If that doesn't work for you, you could define a [beforeInterceptor](http://grails.org/doc/1.0.x/ref/Controllers/beforeInterceptor.html) on your controller to minimize some duplication as well.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-23T09:09:38.693

Have you gone through [Spring Security Core](http://grails.org/plugin/spring-security-core).
It's nice framework for security purpose..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-06T17:00:03.423

There is many ways Better approach is use filter (before) and put if (!session?.user) { redirect(controller: "authentication", action: "login") } this code in filter.

second thing you can use spring security plugin so that you don't have to worry about user session it will automatically control it. see [http://blog.springsource.org/2010/08/11/simplified-spring-security-with-grails/](http://blog.springsource.org/2010/08/11/simplified-spring-security-with-grails/) for further information about plugin

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-13T10:22:34.263

Have a look at the [Spring Security Core Plugin](http://grails.org/plugin/spring-security-core) which is a rich framework for security purposes. You can use the `springSecurityService.isLoggedin()` method after injecting the framework, but the framework provides for much finer access and privilege controls that also avoid the need for boilerplate.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-01T11:02:37.150

```
import grails.plugins.springsecurity.Secured 
```

@Secured(['ROLE_ADMIN', 'ROLE_SUB_ADMIN', 'ROLE_USER'])

class DashboardController{

def create() {

```
 [bankInstance: new Bank(params)]

}

def save() {
    def bankInstance = new Bank(params)
    if (!bankInstance.save(flush: true)) {
        render(view: "create", model: [bankInstance: bankInstance])
        return
    }

    flash.message = message(code: 'default.created.message', args: [message(code: 'bank.label', default: 'Bank'), bankInstance.id])
    redirect(action: "show", id: bankInstance.id)
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-10T08:52:34.497

you can also try [apache shiro plugin for grails](http://grails.org/plugin/shiro)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-11T14:05:25.990

Use [Spring Security Core](http://grails.org/plugin/spring-security-core).... map Role of usages(User) in the System .. Configure the Same while Installing the Plugin... and dont forget to create an Admin user on bootstrap...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-12-16T22:38:47.803

If you aren't looking for a completely secure answer, like Spring Security Core, you can use this code from the grails documentation as a filter:

```
class SecurityFilters {
   def filters = {
       loginCheck(controller:'*', action:'*') {
           before = {
              if(!session.user && !actionName.equals('login')) {
                  redirect(action:'login')
                  return false
               }
           }
       }
   }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-12-27T20:49:15.707

I second spring security. You are trying to reinvent the wheel here. All this has been done for you and more.

# wpf - VS2008 在使用 WPF 时会默默地死掉很多

> ID：485518
> 
> 赞同：3
> 
> 时间：2009-01-27T22:04:47.747
> 
> 标签：wpf, visual-studio-2008, crash

在 VS2008 (C#) 中工作时，VS2008 是否会在使用 WPF 时默默地崩溃？如果我触摸 XAML，它很可能会崩溃。我可以回来，清理，然后构建，然后运行，直到我不得不再次触摸 XAML。然后重新开始。

这是一个包含大约 12 个项目的解决方案。

谢谢，杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T18:41:23.280

我发现问题出在 AnkhSvn 插件上。我去了一个 nightlybuild，现在它工作得很好。任何高于 2.0.6110.379。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T23:57:28.410

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=375594](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=375594)

解决方法：

[在http://www.dotnet6.com/blogs/wesley_walraeve/archive/2008/10/22/visual-studio-2008-sp1-crashes-toolbox-gt-choose-items.aspx](http://www.dotnet6.com/blogs/wesley_walraeve/archive/2008/10/22/visual-studio-2008-sp1-crashes-toolbox-gt-choose-items.aspx)找到了真正的解决方法，它正在删除 TFS Power Commands 2008。其他人不得不删除其他东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T08:24:49.727

SP1 解决了一些崩溃问题，但确实崩溃了很多。特别是当您混合和匹配 winforms + WPF 时。仅崩溃就是我们坚持使用winforms一段时间的原因......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T10:46:02.440

我知道，这不好，但简单地清理解决方案对我有用。至少在 VS 下一次重新启动之前，但在那之前你不应该遇到任何崩溃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T10:37:30.270

我们遇到同样的问题......我注意到 resharper 不时让 WPF 编辑器变得更糟......

啊，好吧.. 每天的 VS 崩溃让医生远离？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T23:02:56.850

我和我公司的其他一些人在编辑资源字典并且使用该资源字典的 XAML 窗口打开时遇到了很多问题。故事的道德，如果您要编辑资源字典，请关闭所有 XAML 窗口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T11:05:17.860

VS 经常在我的计算机上崩溃：当我使用 WPF 时，每天会崩溃几次。但通常它会停止响应，我不记得它会默默地崩溃。

# .net - n 层应用程序中的依赖注入？

> ID：485519
> 
> 赞同：7
> 
> 时间：2009-01-27T22:04:47.917
> 
> 标签：.net, dependency-injection, n-tier-architecture

我有一个 3 层 .NET 服务应用程序，它遵循标准方法：

```
Frontend -> Object Model / Business Logic -> Data Access 
```

我一直在尝试学习依赖注入，到目前为止发现它很棒（使用 Autofac）。3 层中的每一层都需要创建各种各样的对象，有时还需要额外的配置等。看起来 DI 容器应该是解决这个问题的理想之选，但我遇到了一些问题，看它应该与系统的其余部分相关联。

目前我在前端有一个配置 DI 容器的类。它基本上是一大堆代码`container.Register<SomeType>()`，等等。

问题是，它正在为所有 3 层配置容器，因此必须对数据访问层有相当深入的了解。在我的前端拥有这样知识的代码会在我脑海中敲响警钟，因为将应用程序分成几层是为了避免这种确切的情况。
更糟糕的是，我的数据访问层不仅仅是 SQL 服务器，它是一个愚蠢的比特桶，而是由许多复杂的 COM 互操作和 P/Invoke 调用组成，因此对 DI 有相当大的影响配置。

我已经考虑过将其分解——也许每层有一个容器，或者在每一层都有一个“设置”类，它与全局 DI 容器对话以注册它自己的位，但我不确定这是否会导致解决的问题多于解决的问题...

如果有人能分享他们在多层应用程序中使用 DI 的经验，我将不胜感激。

谢谢，猎户座。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T19:23:07.273

这取决于您是否具有三层（物理分离）或所有逻辑层是否部署在一起。如果前端与您的 BL 分离并通过 Web 服务或 WCF 进行通信，那么前端和后端需要自己的容器，因为它们在不同的进程或不同的机器中运行。容器只会注册它自己的组件和“下一个”层的接口。

另一方面，如果所有层都在同一个进程中运行，那么您应该只有一个容器。容器将被初始化并托管在应用程序的起点，例如 web 应用程序的 global.asax。

容器主机知道系统的所有不同部分的问题可以通过不逐个注册类来解决，而是在程序集中注册所有类型。这样，您就不需要对解决方案中的所有程序集进行强引用来配置容器。使用 Castle Winsdor 可以做到这一点的示例：

```
Kernel.Register(AllTypes.Pick().FromAssemblyName("DataAccessLayer.dll"));
Kernel.Register(AllTypes.Pick().FromAssemblyName("BusinessLogic.dll")); 
```

# c++ - 在 C++ 中用于浮点数的 round()

> ID：485525
> 
> 赞同：245
> 
> 时间：2009-01-27T22:06:30.207
> 
> 标签：c++, floating-point, rounding

我需要一个简单的浮点舍入函数，因此：

```
double round(double);

round(0.1) = 0
round(-0.1) = 0
round(-0.9) = -1 
```

我可以在 math.h中找到`ceil()`and - 但不是。`floor()``round()`

它是否以另一个名称出现在标准 C++ 库中，还是丢失了？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2009-01-27T22:10:28.577

> **编者注：**以下答案提供了一个简单的解决方案，其中包含几个实现缺陷（有关完整解释，请参阅[Shafik Yaghmour 的答案）。](https://stackoverflow.com/a/24348037/7941251)请注意，C++11 已经包含[`std::round`、`std::lround`和`std::llround`](http://en.cppreference.com/w/cpp/numeric/math/round)as 内置函数。

C++98 标准库中没有 round()。不过你可以自己写一个。以下是[round-half-up](https://en.wikipedia.org/wiki/Rounding#Round_half_up)的实现：

```
double round(double d)
{
  return floor(d + 0.5);
} 
```

C++98 标准库中没有 round 函数的可能原因是它实际上可以以不同的方式实现。以上是一种常见的方法，但还有其他方法，例如[round-to-even](http://en.wikipedia.org/wiki/Rounding#Round_half_to_even)，如果您要进行大量舍入，则偏差较小且通常更好；不过实现起来有点复杂。

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2011-05-01T16:19:30.537

Boost 提供了一组简单的舍入函数。

```
#include <boost/math/special_functions/round.hpp>

double a = boost::math::round(1.5); // Yields 2.0
int b = boost::math::iround(1.5); // Yields 2 as an integer 
```

有关详细信息，请参阅[Boost 文档](http://www.boost.org/doc/libs/1_46_1/libs/math/doc/sf_and_dist/html/math_toolkit/utils/rounding/round.html)。

**编辑**：从 C++11 开始，有[`std::round`,`std::lround`和`std::llround`](http://en.cppreference.com/w/cpp/numeric/math/round).

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2014-06-22T04:07:51.643

C++03 标准依赖于 C90 标准，该标准称为*标准 C 库*，该标准包含在 C++03 标准草案（*[与 C++03 最接近的公开可用草案标准是 N1804](http://www.open-std.org/Jtc1/sc22/wg21/docs/papers/2005/n1804.pdf)*）部分`1.2` *规范性参考*：

> ISO/IEC 9899:1990 第 7 条和 ISO/IEC 9899/Amd.1:1995 第 7 条中描述的库在下文中称为标准 C 库。^(1))

如果我们[在 cppreference 上查看 round、lround、llround 的 C 文档，](http://en.cppreference.com/w/c/numeric/math/round)我们可以看到*round*和相关函数是*C99*的一部分，因此在 C++03 或更早版本中不可用。

在 C++11 中，这发生了变化，因为 C++11 依赖于*C 标准库*的 C99 草案标准，因此提供[std::round 和整数返回类型 std::lround、std::llround](http://en.cppreference.com/w/cpp/numeric/math/round)：

```
#include <iostream>
#include <cmath>

int main()
{
    std::cout << std::round( 0.4 ) << " " << std::lround( 0.4 ) << " " << std::llround( 0.4 ) << std::endl ;
    std::cout << std::round( 0.5 ) << " " << std::lround( 0.5 ) << " " << std::llround( 0.5 ) << std::endl ;
    std::cout << std::round( 0.6 ) << " " << std::lround( 0.6 ) << " " << std::llround( 0.6 ) << std::endl ;
} 
```

C99 的另一个选项是[std::trunc](http://en.cppreference.com/w/cpp/numeric/math/trunc)，它：

> 计算幅度不大于 arg 的最接近整数。

```
#include <iostream>
#include <cmath>

int main()
{
    std::cout << std::trunc( 0.4 ) << std::endl ;
    std::cout << std::trunc( 0.9 ) << std::endl ;
    std::cout << std::trunc( 1.1 ) << std::endl ;

} 
```

如果您需要支持非 C++11 应用程序，最好的办法是使用[boost round、iround、lround、llround](http://www.boost.org/doc/libs/1_53_0/libs/math/doc/sf_and_dist/html/math_toolkit/utils/rounding/round.html)或[boost trunc](http://www.boost.org/doc/libs/1_46_1/libs/math/doc/sf_and_dist/html/math_toolkit/utils/rounding/trunc.html)。

**滚动你自己的圆形版本很难**

自己滚动可能不值得付出努力，因为[比看起来更难：将浮点数舍入到最接近的整数，第 1 部分](https://www.frama-c.com/2013/05/02/Harder-than-it-looks-rounding-float-to-nearest-integer-part-1.html)，将[浮点数舍入到最接近的整数，第 2 部分](https://www.frama-c.com/2013/05/03/Rounding-float-to-nearest-integer-part-2.html)和[将浮点数舍入到最接近的整数，第 3 部分](https://www.frama-c.com/2013/05/04/Rounding-float-to-nearest-integer-part-3.html)解释：

例如，您的实现使用`std::floor`和添加的常见滚动`0.5`不适用于所有输入：

```
double myround(double d)
{
  return std::floor(d + 0.5);
} 
```

这将失败的一个输入是`0.49999999999999994`，（*[现场查看](http://coliru.stacked-crooked.com/a/e8c613b87fc742ca)*）。

另一种常见的实现涉及将浮点类型转换为整数类型，这可以在整数部分无法在目标类型中表示的情况下调用未定义的行为。我们可以从草稿 C++ 标准部分`4.9` *Floating-integral Conversions*中看到这一点（*强调我的*）：

> 浮点类型的纯右值可以转换为整数类型的纯右值。转换截断；也就是说，小数部分被丢弃。**如果截断的值不能在目标类型中表示，则行为未定义。**[...]

例如：

```
float myround(float f)
{
  return static_cast<float>( static_cast<unsigned int>( f ) ) ;
} 
```

给定`std::numeric_limits<unsigned int>::max()`的是`4294967295`以下调用：

```
myround( 4294967296.5f ) 
```

会导致溢出，（*[现场观看](http://coliru.stacked-crooked.com/a/695c239c461104e7)*）。

[通过查看Concise way to implement round() in C](https://stackoverflow.com/a/4572877/1708801)的答案，我们可以看到这到底有多困难？它引用了单精度浮点数的*newlibs*版本。对于看似简单的事情来说，这是一个很长的函数。对浮点实现没有深入了解的人似乎不太可能正确实现此功能：

```
float roundf(x)
{
  int signbit;
  __uint32_t w;
  /* Most significant word, least significant word. */
  int exponent_less_127;

  GET_FLOAT_WORD(w, x);

  /* Extract sign bit. */
  signbit = w & 0x80000000;

  /* Extract exponent field. */
  exponent_less_127 = (int)((w & 0x7f800000) >> 23) - 127;

  if (exponent_less_127 < 23)
    {
      if (exponent_less_127 < 0)
        {
          w &= 0x80000000;
          if (exponent_less_127 == -1)
            /* Result is +1.0 or -1.0\. */
            w |= ((__uint32_t)127 << 23);
        }
      else
        {
          unsigned int exponent_mask = 0x007fffff >> exponent_less_127;
          if ((w & exponent_mask) == 0)
            /* x has an integral value. */
            return x;

          w += 0x00400000 >> exponent_less_127;
          w &= ~exponent_mask;
        }
    }
  else
    {
      if (exponent_less_127 == 128)
        /* x is NaN or infinite. */
        return x + x;
      else
        return x;
    }
  SET_FLOAT_WORD(x, w);
  return x;
} 
```

另一方面，如果其他解决方案都不可用，那么*newlib*可能是一种选择，因为它是一个经过良好测试的实现。

* * *

## 回答 #4

> 赞同：71
> 
> 时间：2011-01-11T16:45:51.687

值得注意的是，如果您想从舍入中获得整数结果，则无需将其传递给 ceil 或 floor。IE，

```
int round_int( double r ) {
    return (r > 0.0) ? (r + 0.5) : (r - 0.5); 
} 
```

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2012-06-19T13:23:09.353

它从 cmath 中的 C++11 开始可用（根据[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)）

```
#include <cmath>
#include <iostream>

int main(int argc, char** argv) {
  std::cout << "round(0.5):\t" << round(0.5) << std::endl;
  std::cout << "round(-0.5):\t" << round(-0.5) << std::endl;
  std::cout << "round(1.4):\t" << round(1.4) << std::endl;
  std::cout << "round(-1.4):\t" << round(-1.4) << std::endl;
  std::cout << "round(1.6):\t" << round(1.6) << std::endl;
  std::cout << "round(-1.6):\t" << round(-1.6) << std::endl;
  return 0;
} 
```

输出：

```
round(0.5):  1
round(-0.5): -1
round(1.4):  1
round(-1.4): -1
round(1.6):  2
round(-1.6): -2 
```

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2009-01-27T22:08:38.097

它通常实现为`floor(value + 0.5)`.

编辑：它可能不叫round，因为我知道至少有三种舍入算法：四舍五入到零，四舍五入到最接近的整数，以及银行家的四舍五入。您要求四舍五入到最接近的整数。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-05-29T08:49:02.577

我们正在研究两个问题：

1.  舍入转换
2.  类型转换。

舍入转换意味着舍入 ± float/double 到最接近的 floor/ceil float/double。可能你的问题到此为止。但是如果您希望返回 Int/Long，则需要执行类型转换，因此“溢出”问题可能会影响您的解决方案。所以，检查你的函数中的错误

```
long round(double x) {
   assert(x >= LONG_MIN-0.5);
   assert(x <= LONG_MAX+0.5);
   if (x >= 0)
      return (long) (x+0.5);
   return (long) (x-0.5);
}

#define round(x) ((x) < LONG_MIN-0.5 || (x) > LONG_MAX+0.5 ?\
      error() : ((x)>=0?(long)((x)+0.5):(long)((x)-0.5)) 
```

来自：[http ://www.cs.tut.fi/~jkorpela/round.html](http://www.cs.tut.fi/~jkorpela/round.html)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2010-06-29T13:02:15.750

Boost 中还实现了某种类型的舍入：

```
#include <iostream>

#include <boost/numeric/conversion/converter.hpp>

template<typename T, typename S> T round2(const S& x) {
  typedef boost::numeric::conversion_traits<T, S> Traits;
  typedef boost::numeric::def_overflow_handler OverflowHandler;
  typedef boost::numeric::RoundEven<typename Traits::source_type> Rounder;
  typedef boost::numeric::converter<T, S, Traits, OverflowHandler, Rounder> Converter;
  return Converter::convert(x);
}

int main() {
  std::cout << round2<int, double>(0.1) << ' ' << round2<int, double>(-0.1) << ' ' << round2<int, double>(-0.9) << std::endl;
} 
```

请注意，这仅在您进行整数转换时才有效。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-11-17T09:27:33.497

如今，使用包含 C99/C++11 数学库的 C++11 编译器应该不是问题。但是问题就变成了：您选择哪个舍入函数？

C99/C++11**`round()`实际上通常不是您想要的舍入函数**。它使用一种时髦的舍入模式，从 0 舍入作为中途情况下的抢七（`+-xxx.5000`）。如果您确实特别想要这种舍入模式，或者您的目标`round()`是比 更快的 C++ 实现`rint()`，那么请使用它（或使用该问题的其他答案之一来模拟其行为，该答案从表面上看并仔细复制了该特定舍入行为。）

`round()`的舍入不同于 IEEE754 默认舍入[到最接近的模式，甚至作为 tie-break](https://en.wikipedia.org/wiki/Rounding#Round_half_to_even)。Nearest-even避免了数字平均大小的统计偏差，但确实偏向偶数。

有两个使用当前默认舍入模式的数学库舍入函数：[`std::nearbyint()`](http://en.cppreference.com/w/cpp/numeric/math/nearbyint)和[`std::rint()`](http://en.cppreference.com/w/cpp/numeric/math/rint)，都在 C99/C++11 中添加，因此它们随时可用`std::round()`。唯一的区别是它`nearbyint`永远不会引发 FE_INEXACT。

**`rint()`出于性能原因更喜欢**：gcc 和 clang 都更容易内联，但 gcc 从不内联`nearbyint()`（即使使用`-ffast-math`）

* * *

### x86-64 和 AArch64 的 gcc/clang

[我**在 Matt Godbolt 的 Compiler Explorer 上放置了一些测试函数**](https://gcc.godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAKxAEZSBnVAV2OUxAHIBSAJgGY8AMyxCA1AH0JyAA4AbZg3mLuABgCCfQQDtkCrGO78AwsgC2AQwIIj2NZoGY5DTPa15d%2BzIZOXrAOht%2BOw0tTG18ITcNAHoYsQsZGQticII5AE8xYGRkMXRUTAZtME4CMQBrbVQAdzEEWrEiMQ85D29rPAYxTAA3cLEawgQxIQsGAgBaPxsNAuYAIzlvRUwJbUwUhYyIeaXvAA8ASkMAdgAhMVSCVm0xDa2MjwIIY6NL7lOAEWj1OLEACoIbyobSZfLCISYVK6bwLTAEGqYAYTdAgEAPYjbZ4JCJiVHo4g4rpNBBWfEENEYzZYp7acobfrEK4WLpFMQAMWwEgAkgA5bAADXUxgB/ns/xyeQseL0MuAYgWqGslWqdQadWarXaV2e9j2yzEqwkRPpuxY%2BzExzOl2ut11Zre/A%2B31%2BBpWLhNLAi5sWhutn1tCPtxG96FeR3eZx%2BoVi8Slp1x6DEcu0CqGcjkLTBOs63T6AyG1hY5UmQmq0ysCEm0OI1Ql8dyADYkz0Um1ofdkcmxhNK9Z9RbDcxtAwLFCJEI5KgSL7LQGLvYxMursG66Np7ODoZeJdVP4AKyR51uV1x/JDj1rAjEEfIOf%2Bk6B5d29c3u8RqOfGOaDQ400EBIzwPocT6LhoK6rjc64QM8RwAZ%2BJ6hGe6jTmmDqAWhwAgVaYHnEuK6vncEBYfBwFOvhyE/jixpyAh7q4TaBEvmudx0eRx6UZo3ycEcpByFwB6cKQ2hcKowmoFwxh8Phu74iwbDeFotDCQQYm8XxFQgPw/D%2BAAnAALAeTZGacpwABy0KcqiqAeBn8VwBnCaJnDiaQkmcMJDAgKopBqa5vGkHAsAwIgKCoGYMh4MsZAUBAaCRdF0IgMApy8KQQjRQQ0LeRACzqaQCweCkGRcCppAJWYaQAPJgqVAWkFglhpssBX4KkyAEHg/TeQ1mAHJgyDMNlZXCc8TgFTeeBmKNfFtAs3mQHxqAyF1oK9ZMqJGF8wDaMwMkybQtBiJMADqFiZid1X8CdlhsEEXxkgwSKZl5CnsHQc2Cc5BUeQc5lNpMJnZLkYinP4vBiBAuCECQO78PQYjGBFUUxfDtBHKp6lHJp2m8IetBNnphOnAZqi8FZaX2QJnBOaQM0Hr5LluR5Xk%2BX52NBaFEBIAlqPQuQlB80lxApXZvmZXI2XELl%2BUNUV2glaNFURVV9K1ZkbWYM1wCtQ17WDV1PUFf1g3DRwnDleNNNuVNM2W4F82LRAy2rXg61cJMBx5JtlLbbtzB6XpJ3nZdkzXbdKTIA9T0vVmZa9lMMxvawH0Yw5nBCSJv1cP9gPA1KYgHv4BlQzDRDMsppBIyjIvw/wmMcwFOOkMCFhYKLLsZ3TDNMznnmMOz/niS3Wn8PjaW0OTqjmbPBl6U2Ta8AeGf8D9DWs03I9c/AwVhcLMWC/FtcxSgcjyvwekS1lOWUHLbkK0rDsq2YasEBr9VuU18p61/eAdUbIoJsBpDRGs/a2k0iT2xUnNPAC14CuzWqOT2W1%2BA7T2gdXcR0Q4XXjhHSs91tobDJMsMwKdFKfQzlnZmElc4AyBqXVMCpdJ6X8KoMu%2BAK7o2rsjRKaMtC8EbsPDSpAx66R0hIyRUju7CV7tnDeXA2a%2BWEXxPePNwp8IFnFA%2ByUUhmBMsAJs/Br5S1vnlAqj9iD1XKpVGqdUtY61/sJA2nVupAL6iA82ysIENTtrNficDnaIPdsgzgvt0D%2BwwbuQ6x0zq4KumvRg70ODpxptQ/u6gABKABZAuoMmz%2BF0uwkiHhmDWmhpwuGVca6aMrgIAyQjsZ8Tbh3SgX1aayJAIzeRLNFGD2UU00R2lxFSNGTpVe69ekDxUe03gkzaHTMGUyBgISQAGSAA%3D%3D%3D)，您可以在其中看到 source + asm 输出（用于多个编译器）。有关阅读编译器输出的更多信息，请参阅[此问答](https://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output)和 Matt 的 CppCon2017 演讲：[“我的编译器最近为我做了什么？解开编译器的盖子”</a>,](https://youtu.be/bSkpMdDe4g4)

 [在 FP 代码中，内联小函数通常是一个巨大的胜利。特别是在非 Windows 上，标准调用约定没有保留调用的寄存器，因此编译器无法在`call`. 因此，即使您并不真正了解 asm，您仍然可以轻松查看它是否只是对库函数的尾调用，还是内联到一两条数学指令。任何内联到一个或两个指令的东西都比函数调用好（对于 x86 或 ARM 上的这个特定任务）。](https://youtu.be/bSkpMdDe4g4) 

[在 x86 上，内联到 SSE4.1 的任何内容都`roundsd`](https://youtu.be/bSkpMdDe4g4)[`roundpd`](http://felixcloutier.com/x86/ROUNDPD.html)可以使用 SSE4.1 （或 AVX ）[自动矢量化](https://youtu.be/bSkpMdDe4g4)`vroundpd`。（FP->integer 转换也可以打包 SIMD 形式使用，除了需要 AVX512 的 FP->64 位整数。）

*   `std::nearbyint()`：

    *   x86 clang：内联到单个 insn 与`-msse4.1`.
    *   x86 gcc：内联到单个 insn 仅与`-msse4.1 -ffast-math`，并且仅在 gcc 5.4 和*更早版本*上。后来 gcc 从来没有内联它（也许他们没有意识到立即位之一可以抑制不精确的异常？这就是 clang 使用的，但是旧的 gcc 使用与`rint`内联时相同的立即数）
    *   AArch64 gcc6.3：默认内联到单个insn。
*   `std::rint`：

    *   x86 clang：内联到单个insn`-msse4.1`
    *   x86 gcc7：内联到带有`-msse4.1`. （没有SSE4.1，内联到几条指令）
    *   x86 gcc6.x 及更早版本：内联到带有`-ffast-math -msse4.1`.
    *   AArch64 gcc：默认内联到单个 insn
*   `std::round`：

    *   x86 clang：不内联
    *   x86 gcc：内联到多个指令`-ffast-math -msse4.1`，需要两个向量常量。
    *   AArch64 gcc：内联到单个指令（硬件支持这种舍入模式以及 IEEE 默认和大多数其他模式。）
*   `std::floor`// `std::ceil`_`std::trunc`

    *   x86 clang：内联到单个insn`-msse4.1`
    *   x86 gcc7.x：内联到单个insn`-msse4.1`
    *   x86 gcc6.x 及更早版本：内联到单个insn`-ffast-math -msse4.1`
    *   AArch64 gcc：默认内联到单个指令

* * *

# 四舍五入到`int`/ `long`/ `long long`：

您在这里有两个选择：使用`lrint`（如`rint`但返回`long`，或`long long`for `llrint`），或使用 FP->FP 舍入函数，然后以正常方式（使用截断）转换为整数类型。一些编译器优化一种方式比另一种更好。

```
long l = lrint(x);

int  i = (int)rint(x); 
```

请注意，首先`int i = lrint(x)`转换`float`或`double`-> `long`，然后将整数截断为`int`. 这对超出范围的整数产生了影响：C++ 中的未定义行为，但为 x86 FP -> int 指令定义良好（编译器将发出，除非它在编译时看到 UB，同时进行常量传播，然后它是允许制作如果曾经执行过就会中断的代码）。

在 x86 上，溢出整数的 FP->integer 转换产生`INT_MIN`or `LLONG_MIN`（`0x8000000`或 64 位等效的位模式，仅设置符号位）。英特尔将此称为“整数不定”值。（请参阅[手册`cvttsd2si`条目](http://felixcloutier.com/x86/CVTTSD2SI.html)，将（截断）标量双精度数转换为有符号整数的 SSE2 指令。它适用于 32 位或 64 位整数目标（仅在 64 位模式下）。还有一个`cvtsd2si`（使用当前舍入转换mode)，这是我们希望编译器发出的，但不幸的是 gcc 和 clang 不会在没有`-ffast-math`.

另请注意，`unsigned`在 x86（没有 AVX512）上，往返 int / long 的 FP 效率较低。在 64 位机器上转换为 32 位无符号是相当便宜的；只需转换为 64 位有符号并截断即可。但除此之外，它的速度要慢得多。

*   x86 clang with/without `-ffast-math -msse4.1`: `(int/long)rint`inlines to `roundsd`/ `cvttsd2si`。（错过了对 的优化`cvtsd2si`）。 `lrint`根本不内联。

*   x86 gcc6.x 及更早版本没有`-ffast-math`: 都不是内联

*   x86 gcc7 without `-ffast-math`:分别舍入和转换（启用了 SSE4.1 的总共 2 条指令，否则为without`(int/long)rint`内联一堆代码）。 不内联。`rint``roundsd``lrint`
*   x86 gcc *with* `-ffast-math` : **allways inline to `cvtsd2si`(optimal)**，不需要 SSE4.1。

*   AArch64 gcc6.3 没有`-ffast-math`:`(int/long)rint`内联到 2 条指令。 `lrint`不内联

*   `-ffast-math`带有:的AArch64 gcc6.3`(int/long)rint`编译为对`lrint`. `lrint`不内联。这可能是一个错过的优化，除非我们得到的两条指令`-ffast-math`非常慢。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2010-02-12T03:02:23.563

您可以使用以下方法四舍五入到 n 位精度：

```
double round( double x )
{
const double sd = 1000; //for accuracy to 3 decimal places
return int(x*sd + (x<0? -0.5 : 0.5))/sd;
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-04-25T21:02:09.957

如果您最终想将函数的`double`输出转换为，那么这个问题的公认解决方案将类似于：`round()``int`

```
int roundint(double r) {
  return (int)((r > 0.0) ? floor(r + 0.5) : ceil(r - 0.5));
} 
```

当传入统一的随机值时，这在我的机器上的时钟大约为**8.88 ns 。**

据我所知，以下在功能上是等效的，但在我的机器上的时钟频率为**2.48 ns**，具有显着的性能优势：

```
int roundint (double r) {
  int tmp = static_cast<int> (r);
  tmp += (r-tmp>=.5) - (r-tmp<=-.5);
  return tmp;
} 
```

性能更好的原因之一是跳过的分支。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-06-17T20:50:40.727

当心`floor(x+0.5)`。以下是 [2^52,2^53] 范围内的奇数可能发生的情况：

```
-bash-3.2$ cat >test-round.c <<END

#include <math.h>
#include <stdio.h>

int main() {
    double x=5000000000000001.0;
    double y=round(x);
    double z=floor(x+0.5);
    printf("      x     =%f\n",x);
    printf("round(x)    =%f\n",y);
    printf("floor(x+0.5)=%f\n",z);
    return 0;
}
END

-bash-3.2$ gcc test-round.c
-bash-3.2$ ./a.out
      x     =5000000000000001.000000
round(x)    =5000000000000001.000000
floor(x+0.5)=5000000000000002.000000 
```

这是[http://bugs.squeak.org/view.php?id=7134](http://bugs.squeak.org/view.php?id=7134)。使用类似@konik 的解决方案。

我自己的强大版本将类似于：

```
double round(double x)
{
    double truncated,roundedFraction;
    double fraction = modf(x, &truncated);
    modf(2.0*fraction, &roundedFraction);
    return truncated + roundedFraction;
} 
```

[此处](https://stackoverflow.com/questions/9902968/why-does-math-round0-49999999999999994-return-1)给出了避免使用 floor(x+0.5) 的另一个原因。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-02-09T11:35:25.343

函数`double round(double)`配合使用`modf`函数：

```
double round(double x)
{
    using namespace std;

    if ((numeric_limits<double>::max() - 0.5) <= x)
        return numeric_limits<double>::max();

    if ((-1*std::numeric_limits<double>::max() + 0.5) > x)
        return (-1*std::numeric_limits<double>::max());

    double intpart;
    double fractpart = modf(x, &intpart);

    if (fractpart >= 0.5)
        return (intpart + 1);
    else if (fractpart >= -0.5)
        return intpart;
    else
        return (intpart - 1);
    } 
```

要编译干净，包括“math.h”和“limits”是必要的。该函数根据以下舍入模式工作：

*   5.0 轮是 5.0
*   3.8 轮是 4.0
*   2.3轮是2.0
*   1.5轮是2.0
*   0.501 的回合是 1.0
*   0.5 轮是 1.0
*   0.499 的回合是 0.0
*   0.01 的回合是 0.0
*   0.0 的回合是 0.0
*   -0.01 的回合是 -0.0
*   -0.499 的回合是 -0.0
*   -0.5 的回合是 -0.0
*   -0.501 的回合是 -1.0
*   -1.5 的回合是 -1.0
*   -2.3 的回合是 -2.0
*   -3.8 的回合是 -4.0
*   -5.0 的回合是 -5.0

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-02-04T08:16:47.193

不需要实现任何东西，所以我不确定为什么这么多答案涉及定义、函数或方法。

**在 C99 中**

对于泛型宏，我们有以下和头文件 <tgmath.h>。

```
#include <math.h>
double round (double x);
float roundf (float x);
long double roundl (long double x); 
```

如果你不能编译它，你可能遗漏了数学库。与此类似的命令适用于我拥有的每个 C 编译器（几个）。

```
gcc -lm -std=c99 ... 
```

**在 C++11 中**

我们在 #include <cmath> 中有以下和其他重载，它们依赖于 IEEE 双精度浮点。

```
#include <math.h>
double round (double x);
float round (float x);
long double round (long double x);
double round (T x); 
```

[std 命名空间中](http://en.cppreference.com/w/cpp/numeric/math/round)也有等价物。

如果你不能编译它，你可能正在使用 C 编译而不是 C++。对于 g++ 6.3.1、x86_64-w64-mingw32-g++ 6.3.0、clang-x86_64++ 3.8.0 和 Visual C++ 2015 Community，以下基本命令既不会产生错误也不会产生警告。

```
g++ -std=c++11 -Wall 
```

**带序数除法**

当划分两个序数时，其中 T 是 short、int、long 或其他序数，舍入表达式是 this。

```
T roundedQuotient = (2 * integerNumerator + 1)
    / (2 * integerDenominator); 
```

**准确性**

毫无疑问，浮点运算中会出现看起来很奇怪的不准确性，但这只是在数字出现时，与四舍五入无关。

来源不仅仅是浮点数的 IEEE 表示的尾数中的有效位数，它与我们人类的十进制思维有关。

10 是 5 和 2 的乘积，5 和 2 互质。因此，IEEE 浮点标准不可能完美地表示为所有二进制数字表示的十进制数。

这不是舍入算法的问题。在选择类型和设计计算、数据输入和数字显示时，应考虑数学现实。如果应用程序显示显示这些十进制-二进制转换问题的数字，则该应用程序在视觉上表达了数字现实中不存在的准确性，应该进行更改。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-10-24T00:03:47.680

根据 Kalaxy 的回复，以下是一个模板化的解决方案，它基于自然舍入将任何浮点数四舍五入为最接近的整数类型。如果值超出整数类型的范围，它也会在调试模式下引发错误，从而大致用作可行的库函数。

```
 // round a floating point number to the nearest integer
    template <typename Arg>
    int Round(Arg arg)
    {
#ifndef NDEBUG
        // check that the argument can be rounded given the return type:
        if (
            (Arg)std::numeric_limits<int>::max() < arg + (Arg) 0.5) ||
            (Arg)std::numeric_limits<int>::lowest() > arg - (Arg) 0.5)
            )
        {
            throw std::overflow_error("out of bounds");
        }
#endif

        return (arg > (Arg) 0.0) ? (int)(r + (Arg) 0.5) : (int)(r - (Arg) 0.5);
    } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-12-16T00:59:22.983

如果您需要能够在支持 C++11 标准的环境中编译代码，但还需要能够在不支持它的环境中编译相同的代码，您可以使用函数宏在 std 之间进行选择::round() 和每个系统的自定义函数。只需将`-DCPP11`or传递`/DCPP11`给符合 C++11 的编译器（或使用其内置版本宏），并制作如下标题：

```
// File: rounding.h
#include <cmath>

#ifdef CPP11
    #define ROUND(x) std::round(x)
#else    /* CPP11 */
    inline double myRound(double x) {
        return (x >= 0.0 ? std::floor(x + 0.5) : std::ceil(x - 0.5));
    }

    #define ROUND(x) myRound(x)
#endif   /* CPP11 */ 
```

有关简单示例，请参阅[http://ideone.com/zal709](http://ideone.com/zal709)。

这近似于不符合 C++11 的环境中的 std::round()，包括为 -0.0 保留符号位。但是，它可能会导致轻微的性能下降，并且可能会在舍入某些已知的“问题”浮点值时出现问题，例如 0.49999999999999994 或类似值。

或者，如果您可以访问符合 C++11 的编译器，则可以从其`<cmath>`标头中获取 std::round() ，并使用它来制作您自己的标头来定义该函数（如果尚未定义）。但是请注意，这可能不是最佳解决方案，尤其是当您需要针对多个平台进行编译时。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-11-16T11:57:30.687

正如评论和其他答案中所指出的，ISO C++ 标准库`round()`直到 ISO C++11 才添加，当时这个函数是通过引用 ISO C99 标准数学库引入的。

对于 [½, *ub* ]`round(x) == floor (x + 0.5)`中的正操作数，当映射到 IEEE-754 (2008) 时*ub*为 2 ^(23)，`float`当映射到 IEEE-754 (2008) 时ub 为`binary32`2 ^(52)。数字 23 和 52 对应于这两种浮点格式中*存储的尾数位数。*对于 [+0, ½)中的正操作数和 ( *ub* , +∞]中的正操作数。由于函数关于 x 轴对称，因此可以根据 处理负参数。`double``binary64`*`round(x) == 0`*`round(x) == x``x``round(-x) == -round(x)`**

 **这导致下面的紧凑代码。它可以跨各种平台编译成合理数量的机器指令。我观察到 GPU 上最紧凑的代码，其中`my_roundf()`需要大约十几个指令。根据处理器架构和工具链，这种基于浮点的方法可能比[其他答案](https://stackoverflow.com/a/24348037/780717)中引用的 newlib 中基于整数的实现更快或更慢。

我使用英特尔编译器版本 13`my_roundf()`对 newlib 实现进行了详尽的测试，同时使用和. 我还检查了 newlib 版本是否与Intel 编译器库中的版本匹配。双精度无法进行详尽的测试，但是代码在结构上与单精度实现相同。`roundf()``/fp:strict``/fp:fast``roundf()``mathimf``round()`

```
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <math.h>

float my_roundf (float x)
{
    const float half = 0.5f;
    const float one = 2 * half;
    const float lbound = half;
    const float ubound = 1L << 23;
    float a, f, r, s, t;
    s = (x < 0) ? (-one) : one;
    a = x * s;
    t = (a < lbound) ? x : s;
    f = (a < lbound) ? 0 : floorf (a + half);
    r = (a > ubound) ? x : (t * f);
    return r;
}

double my_round (double x)
{
    const double half = 0.5;
    const double one = 2 * half;
    const double lbound = half;
    const double ubound = 1ULL << 52;
    double a, f, r, s, t;
    s = (x < 0) ? (-one) : one;
    a = x * s;
    t = (a < lbound) ? x : s;
    f = (a < lbound) ? 0 : floor (a + half);
    r = (a > ubound) ? x : (t * f);
    return r;
}

uint32_t float_as_uint (float a)
{
    uint32_t r;
    memcpy (&r, &a, sizeof(r));
    return r;
}

float uint_as_float (uint32_t a)
{
    float r;
    memcpy (&r, &a, sizeof(r));
    return r;
}

float newlib_roundf (float x)
{
    uint32_t w;
    int exponent_less_127;

    w = float_as_uint(x);
    /* Extract exponent field. */
    exponent_less_127 = (int)((w & 0x7f800000) >> 23) - 127;
    if (exponent_less_127 < 23) {
        if (exponent_less_127 < 0) {
            /* Extract sign bit. */
            w &= 0x80000000;
            if (exponent_less_127 == -1) {
                /* Result is +1.0 or -1.0\. */
                w |= ((uint32_t)127 << 23);
            }
        } else {
            uint32_t exponent_mask = 0x007fffff >> exponent_less_127;
            if ((w & exponent_mask) == 0) {
                /* x has an integral value. */
                return x;
            }
            w += 0x00400000 >> exponent_less_127;
            w &= ~exponent_mask;
        }
    } else {
        if (exponent_less_127 == 128) {
            /* x is NaN or infinite so raise FE_INVALID by adding */
            return x + x;
        } else {
            return x;
        }
    }
    x = uint_as_float (w);
    return x;
}

int main (void)
{
    uint32_t argi, resi, refi;
    float arg, res, ref;

    argi = 0;
    do {
        arg = uint_as_float (argi);
        ref = newlib_roundf (arg);
        res = my_roundf (arg);
        resi = float_as_uint (res);
        refi = float_as_uint (ref);
        if (resi != refi) { // check for identical bit pattern
            printf ("!!!! arg=%08x  res=%08x  ref=%08x\n", argi, resi, refi);
            return EXIT_FAILURE;
        }
        argi++;
    } while (argi);
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-10-28T10:32:50.327

对于 x86 体系结构和 MS VS 特定的 C++，我在 asm 中使用以下 round 实现：

```
__forceinline int Round(const double v)
{
    int r;
    __asm
    {
        FLD     v
        FISTP   r
        FWAIT
    };
    return r;
} 
```

UPD：返回双精度值

```
__forceinline double dround(const double v)
{
    double r;
    __asm
    {
        FLD     v
        FRNDINT
        FSTP    r
        FWAIT
    };
    return r;
} 
```

输出：

```
dround(0.1): 0.000000000000000
dround(-0.1): -0.000000000000000
dround(0.9): 1.000000000000000
dround(-0.9): -1.000000000000000
dround(1.1): 1.000000000000000
dround(-1.1): -1.000000000000000
dround(0.49999999999999994): 0.000000000000000
dround(-0.49999999999999994): -0.000000000000000
dround(0.5): 0.000000000000000
dround(-0.5): -0.000000000000000 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-13T00:21:14.173

round_f 用于带有数学的 ARM

```
static inline float round_f(float value)
{
    float rep;
    asm volatile ("vrinta.f32 %0,%1" : "=t"(rep) : "t"(value));
    return rep;
} 
```

round_f 用于没有数学的 ARM

```
union f__raw {
    struct {
        uint32_t massa  :23;
        uint32_t order  :8;
        uint32_t sign   :1;
    };
    int32_t     i_raw;
    float       f_raw;
};

float round_f(float value)
{
    union f__raw raw;
    int32_t exx;
    uint32_t ex_mask;
    raw.f_raw = value;
    exx = raw.order - 126;
    if (exx < 0) {
        raw.i_raw &= 0x80000000;
    } else if (exx < 24) {
        ex_mask = 0x00ffffff >> exx;
        raw.i_raw += 0x00800000 >> exx;
        if (exx == 0) ex_mask >>= 1;
        raw.i_raw &= ~ex_mask;
    };
    return  raw.f_raw;
}; 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2019-08-09T01:34:44.397

将浮点值四舍五入“n”小数位的最佳方法是在 O(1) 时间内如下：-

我们必须将值四舍五入 3 位，即 n=3。所以，

```
float a=47.8732355;
printf("%.3f",a); 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-07-19T20:28:17.510

从 C++ 11 开始：

```
#include <cmath>
std::round(1.1) 
```

或得到 int

```
static_cast<int>(std::round(1.1)) 
```

* * *

## 回答 #22

> 赞同：-4
> 
> 时间：2010-06-29T12:31:34.290

```
// Convert the float to a string
// We might use stringstream, but it looks like it truncates the float to only
//5 decimal points (maybe that's what you want anyway =P)

float MyFloat = 5.11133333311111333;
float NewConvertedFloat = 0.0;
string FirstString = " ";
string SecondString = " ";
stringstream ss (stringstream::in | stringstream::out);
ss << MyFloat;
FirstString = ss.str();

// Take out how ever many decimal places you want
// (this is a string it includes the point)
SecondString = FirstString.substr(0,5);
//whatever precision decimal place you want

// Convert it back to a float
stringstream(SecondString) >> NewConvertedFloat;
cout << NewConvertedFloat;
system("pause"); 
```

这可能是一种低效的肮脏转换方式，但见鬼，它有效，哈哈。这很好，因为它适用于实际的浮动。不仅在视觉上影响输出。

* * *

## 回答 #23

> 赞同：-6
> 
> 时间：2009-05-09T16:47:36.557

我这样做了：

```
#include <cmath.h>

using namespace std;

double roundh(double number, int place){

    /* place = decimal point. Putting in 0 will make it round to whole
                              number. putting in 1 will round to the
                              tenths digit.
    */

    number *= 10^place;
    int istack = (int)floor(number);
    int out = number-istack;
    if (out < 0.5){
        floor(number);
        number /= 10^place;
        return number;
    }
    if (out > 0.4) {
        ceil(number);
        number /= 10^place;
        return number;
    }
} 
```

# sharepoint - 如何以编程方式更新 SharePoint Web 部件中的内容？

> ID：485527
> 
> 赞同：7
> 
> 时间：2009-01-27T22:06:55.230
> 
> 标签：sharepoint, web-parts

有人知道如何以编程方式更新任何标准 SharePoint v3 Web 部件的内容吗？

例如，将链接摘要 Web 部件放在页面上。添加一些链接。现在，如何使用 WSS API 更新这些信息？我还没有找到任何直接的方法来做到这一点，到目前为止我唯一的想法是导出 Web 部件（然后将其删除），修改生成的 XML，然后将其导入回来。但可以肯定的是，一定有更简单的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T18:06:48.960

您可以使用[SPLimitedWebPartManager](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.webpartpages.splimitedwebpartmanager.aspx)类来操作 Web 部件页上的 Web 部件。可以从 SPFile 对象中获取此类的实例，如下所示：

```
using (SPSite site = new SPSite("<site url>"))  // e.g. http://server/sites/asite
using (SPWeb web = site.OpenWeb())
{
    SPFile file = web.GetFile("<page url>");   // e.g. /sites/asite/default.aspx
    SPLimitedWebPartManager lwpm = file.GetLimitedWebPartManager();
    SPLimitedWebPartCollection webParts = lwpm.WebParts;
    WebPart wp = webParts[<id, index or Guid>];

    // Add your code to update the Web Part

    lwpm.SaveChanges(wp);
} 
```

您还可以使用 SPLimitedWebPartManager 添加或删除 Web 部件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T22:39:40.547

您可能需要调用[SPWeb.GetWebPartCollection](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spweb.getwebpartcollection.aspx)并使用 webpart 集合来弄乱[WebParts](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.webpartpages.webpart.aspx)

# asp.net - 如何向 ASP.NET Web 服务发出 HTTPWebRequest 并显示我已登录到该域？

> ID：485528
> 
> 赞同：3
> 
> 时间：2009-01-27T22:07:03.373
> 
> 标签：asp.net, session

我有一个 Web 服务，只有在我登录到该 Web 服务所在的网站时才能访问它。我需要远程测试服务。因此，我编写了一些代码来创建一个假会话，该会话在另一个浏览器中登录到该站点。然后我发出了 HTTP Web 请求，并尝试设置一个包含该登录用户的 ASP.NET 会话 ID 的 cookie。但是 Web 服务没有检测到 Web 请求是登录用户或会话。我需要给 Web 服务什么来说服它这是一个有效的会话？

```
// used on each read operation

byte[] buf = new byte[8192];

CookieContainer myContainer = new CookieContainer();

string sessionID = SessionID;

myContainer.Add(new Cookie("ASP.NET_SessionId", sessionID, "/", WebsiteUrl));

// prepare the web page we will be asking for
HttpWebRequest request = (HttpWebRequest)
    WebRequest.Create(CreateWebserviceUrl("doneScreenScore"));
request.ContentType = "text/xml; charset=utf-8";            
request.Method = "POST";
request.Accept = "text/xml";
request.Headers.Add("SOAPAction", "http://detectent.net/doneScreenScore");

request.CookieContainer = myContainer;

Stream s = request.GetRequestStream();

string soaprequest = "";
soaprequest += "<?xml version=\"1.0\" encoding=\"utf-8\"?>";
soaprequest += "<soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\">";
soaprequest += "  <soap12:Body>";
soaprequest += "    <doneScreenScore xmlns=\"http://detectent.net/\">";
soaprequest += "      <input1>string</input1>";
soaprequest += "<input2>string</input2>";
soaprequest += "<input3>string</input3>";
soaprequest += "<input4>string</input4>";
soaprequest += "</doneScreenScore>";
soaprequest += "</soap12:Body>";
soaprequest += "</soap12:Envelope>";

s.Write(System.Text.Encoding.ASCII.GetBytes(soaprequest), 0, soaprequest.Length);

s.Close();

// execute the request
HttpWebResponse response = (HttpWebResponse)
    request.GetResponse();

// we will read data via the response stream
Stream resStream = response.GetResponseStream();
string responseFromWebServiceCall = ReadResponseStream(resStream); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T22:42:09.590

如果我自己没有真正搞砸这件事，我无法确切地告诉你为什么它不起作用。但是，我已经完成了一些编写应用程序的工作，这些应用程序为了测试目的而伪装成典型用户，并且我建议您熟悉的工具称为 WireShark。（以前称为空灵）

WireShark 是一个数据包嗅探器。如果您在正常浏览网站时运行它，您将能够看到在浏览器和 Web 服务器之间来回发送的所有数据。一旦您找到了向此 Web 服务发出请求所需的信息，您应该可以轻松构建一个以相同方式运行的正确 WebRequest。

您可以从[官方网站](http://www.wireshark.org/)下载 WireShark 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T23:54:02.707

我认为您可以使用凭据做一些事情...我正在为网络服务做这件事...

`rpt.Credentials = new System.Net.NetworkCredential(UserName, Password, Domain);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T06:43:46.590

如果网站使用 Windows 身份验证，则 NetworkCredentials 有效。

在做这类事情时，我在模拟浏览器方面取得了不同程度的成功。通常我必须先向他们的登录页面发出有效请求。响应将包含一个带有 SessionID 的 cookie。只要我为之后的所有请求重用相同的 CookieCollection（即，每个请求都重用一个全局 CookieCollection），它就可以正常工作。

在奇怪的情况下，我仍然发现网站无法识别我新登录的会话。在这种情况下，我使用 FireFox 手动登录并使用 WebDeveloper 工具栏查看 cookie。我获取 cookie 名称/值并将它们放入应用程序设置中，程序使用该设置来填充 cookie 集合。

确保你也欺骗了一个有效的用户代理。我也有网站因此而拒绝我。

# java - 如何使用 Swing 实现自动完成？

> ID：485530
> 
> 赞同：29
> 
> 时间：2009-01-27T22:07:16.963
> 
> 标签：java, swing, autocomplete

我有兴趣在 JFrame 中提供一个自动完成框。触发机制将基于助记符（我认为），但我不确定“自动完成框”使用什么（我希望在用户按键时过滤结果）。

你将如何实现这一点？某种 JFrame 或 JPopupMenu？

我想知道这是如何实现的，所以请不要发布指向可用 [J]Components 的链接。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-27T22:31:20.907

您可能想在 SwingLabs 试用免费的 AutoComplete 组件。

[http://swinglabs.org](http://swinglabs.org)

编辑：这个站点似乎已经移动了[http://java.net/projects/swinglabs](http://java.net/projects/swinglabs)

有一个示例如何在以下位置实现此代码：

[http://download.java.net/javadesktop/swinglabs/releases/0.8/docs/api/org/jdesktop/swingx/autocomplete/package-summary.html](http://download.java.net/javadesktop/swinglabs/releases/0.8/docs/api/org/jdesktop/swingx/autocomplete/package-summary.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-14T09:13:41.947

**[Sun 的教程“使用 Swing 组件”](http://java.sun.com/docs/books/tutorial/uiswing/components/textarea.html)**中有一个文本区域自动完成的示例。

它以文字处理器的风格完成（没有弹出窗口，但
建议的文本是在光标之前输入的）。

只需向下滚动到**“另一个示例：TextAreaDemo”**
，然后 点击启动按钮！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-14T09:27:05.767

这是我的简化示例。遗憾的是，在开始输入之前，您必须先单击文本字段，否则会出现异常。*如果有人能找出原因，请让我知道/更新这个答案。*

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class _Autocompleter {

  private final static JPopupMenu textPopupMenu
      = new JPopupMenu("MENU") {

    {
      add(new JMenuItem("item 1"));
      add(new JMenuItem("item 2"));
      setFocusable(false);
    }

  };

  private final static KeyListener textInputListener
      = new KeyAdapter() {

    @Override
    public void keyTyped(KeyEvent e) {
      Point p = textInput.getCaret().getMagicCaretPosition();
      if (textPopupMenu.isVisible()) {
        SwingUtilities.convertPointToScreen(p, textInput);
        textPopupMenu.setLocation(p.x, p.y + 20);
      } else {
        textPopupMenu.show(textInput, p.x, p.y + 20);
      }
    }

  };

  private final static JTextArea textInput
      = new JTextArea("type something") {

    {
      addKeyListener(textInputListener);
      setCaretPosition(getText().length());
    }

  };

  private final static JFrame f = new JFrame("TEST") {

    {
      setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

      add(textInput);

      setSize(400, 60);
      setLocationRelativeTo(null);
      setVisible(true);
    }

  };

  public static void main(String[] args)
      throws Exception {
        // YES, IT'S EMPTY !!!
        // It'll start anyway because of static initializers
  }

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-08-26T11:32:24.190

这是一篇很棒的文章，它使用了几个库：向 Swing Comboboxes @Java.net[添加自动完成支持](http://today.java.net/pub/a/today/2007/07/19/adding-auto-completion-to-swing-comboboxes.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-09-21T09:06:16.480

你可以使用这个库： http: [//fifesoft.com/autocomplete/](http://fifesoft.com/autocomplete/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-11T06:47:46.737

您可以将[JEdit 的 textarea](http://www.jedit.org/)与内置的完成和语法高亮框架一起使用。

一个更重量级的解决方案（从长远来看是好的）是使用[NetBeans Platform](http://platform.netbeans.org/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T22:13:57.870

我会添加一个 actionListener，这样您就可以在按下每个键时获取它。

然后您可以在后台进行搜索（另一个线程）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-21T21:06:47.667

用这个

```
import java.awt.*;
import java.awt.event.*;

import javax.swing.*;

public class Autocompleter2
{
    //~ Methods ------------------------------------------------------------------------------------

    public static void main(String[] args)
      throws Exception
    {
        // YES, IT'S EMPTY !!!
        // It'll start anyway because of static initializers
        SwingUtilities.invokeLater(new Runnable()
            {
                @Override
                public void run()
                {
                    final JPopupMenu textPopupMenu = new JPopupMenu("MENU")
                    {

                        {
                            add(new JMenuItem("item 1"));
                            add(new JMenuItem("item 2"));
                            setFocusable(false);
                        }
                    };

                    final JTextArea textInput = new JTextArea("type something la")
                    {

                        {
                            setCaretPosition(getText().length());
                        }
                    };

                    KeyListener textInputListener = new KeyAdapter()
                    {
                        @Override
                        public void keyTyped(KeyEvent e)
                        {
                            Point p = textInput.getCaret().getMagicCaretPosition();

                            if (textPopupMenu.isVisible())
                            {
                                SwingUtilities.convertPointToScreen(p, textInput);
                                textPopupMenu.setLocation(p.x, p.y + 20);
                            }
                            else
                            {
                                textPopupMenu.show(textInput, p.x, p.y + 20);
                            }
                        }
                    };

                    textInput.addKeyListener(textInputListener);
                    new JFrame("TEST")
                        {

                            {
                                setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                                add(textInput);
                                setSize(400, 60);
                                setLocationRelativeTo(null);
                                setVisible(true);
                            }
                        };
                }
                ;
            });
    }
} 
```

# emacs - 如何在 Emacs 中禁用软返回？

> ID：485531
> 
> 赞同：1
> 
> 时间：2009-01-27T22:07:40.377
> 
> 标签：emacs

如何在 emacs 中禁用软返回？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T21:07:31.513

啊哈！[Mx toggle-truncate-lines] 是我想要的。

不过感谢您的帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T22:29:56.417

看看：[http ://www.emacswiki.org/emacs/LongLines](http://www.emacswiki.org/emacs/LongLines)

> 默认情况下，软回车会在您编辑时自动插入，以保持您的文本包裹。如果您不想要这种效果，请将“longlines-auto-wrap”设置为“nil”。您仍然可以键入“M-q”，或使用任何其他填充命令，使用软回车填充文本（请参阅 FillParagraph。）

# jquery - JQuery 追加和绑定

> ID：485532
> 
> 赞同：3
> 
> 时间：2009-01-27T22:07:42.890
> 
> 标签：jquery

我有一个包含元素的无序列表，我想在最后附加一个项目。这是当前代码：

初始名单：

```
<ul id="all">
  <li>
    Some text <input type="button" class="remove" value="-" />
  </li>
  <li>
    Some text <input type="button" class="remove" value="-" />
  </li>
</ul> 
```

删除列表项的代码：

```
$(".remove").click(function() {
  $(this).parent().remove();
}); 
```

添加新列表项的代码：

```
$("#add").click(function() {
  $("#all").append(
    "<li>"
    + "Some text"
    + "<input type=\"button\" class=\"remove\" value=\"-\" />"
    + "</li>"
  );
}); 
```

添加新列表项的按钮：

```
<input type="button" id="add" value="Add" /> 
```

当我单击按钮时，确实会向列表中添加一个新列表，但单击删除按钮不会执行任何操作。

我该如何进行这项工作？

* * *

奖励：将“一些文本”更改为“ `<input type="text" /> <input type="text" />`”，您将看到两个新添加的输入元素与初始元素之间的距离将有所不同。为什么？（注意：使用 Firefox 3.0.5）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-27T22:19:52.427

我认为您所追求的是新的 jQuery 1.3 功能之一 - 现场活动。请参阅[http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)。

这对我有用：

```
$(".remove").live("click", function() {
  $(this).parent().remove();
}); 
```

奖金：

我也在使用 FF 3.0.5，两个文本框之间的空间相同。如果您的意思是在第二个文本框和按钮之间，那么我必须同意 eimaj 并说空格是原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-27T22:24:57.643

`#add`添加到节点树（DOM）*，但* `.remove`仅应用于所有具有“删除”类的现有元素一次（大概是 onload）。Using`live`也将处理程序添加到新元素。

（奖励：大小/渲染问题只是空白：添加这样的空间“某些文本”在 Ff3.0.5 中对我有用）

# unit-testing - 如何使用 Selenium 连续运行单个测试用例？

> ID：485554
> 
> 赞同：1
> 
> 时间：2009-01-27T22:12:53.627
> 
> 标签：unit-testing, firefox, testing, selenium

我记录了一个非常简单的测试用例，使用与 Firefox 集成的 Selenium IDE。我希望测试用例在一段时间内连续运行。如何使测试连续运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T22:25:07.377

您可以使用[Selenium Remote Control](http://seleniumhq.org/projects/remote-control/)从命令行启动测试的运行。

1.  将 IDE 中的测试保存在测试套件中

2.  [使用以下语法](http://seleniumhq.org/documentation/remote-control/languages/selenese.html)从命令行运行您的测试套件。

3.  使用您最喜欢的脚本语言来编写脚本，一遍又一遍地重新运行您的测试

另一种方法是将您的测试从 IDE 保存到测试套件中，然后在文本编辑器中打开该套件并复制/粘贴相同的测试数百/数千次。我从未尝试过，但假设 IDE 不会阻塞大型套件文件，这将让您一次又一次地运行测试 X 次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T22:16:36.287

试试[flowControl](http://wiki.openqa.org/display/SEL/flowControl) Selenium 扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-08T07:26:17.590

如果您希望您的测试在 Selenium IDE 中连续运行，请使用 IDE 扩展插件（如[ISFW](http://seleniumhq.org/about/platforms.html#testing-frameworks) IDE 扩展插件）中提供的无限 while 循环命令。

步骤如下：

```
<tr>
<td>while</td>
<td>true</td>
<td></td> 
```

你的脚步

```
<tr>
<td>endWhile</td>
<td></td>
<td></td> 
```

您还可以使用 ISFW 插件中提供的定义模块命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-08T12:10:11.200

```
Command   Target    Value
Label     Jump1
Your Script Line1
Line2
Line3
goto      Jump1 
```

这将继续一次又一次地执行您的命令集。

# ruby-on-rails - Rails 和 javascript 缓存

> ID：485555
> 
> 赞同：0
> 
> 时间：2009-01-27T22:13:14.017
> 
> 标签：ruby-on-rails

我将开始开发一个使用大量重型 js 库（prototype、scriptaculous、tinymce 等）的新应用程序。

有人告诉我使用 ajax 制作所有应用程序，因此所有 js 文件将只加载一次。

我的问题是，我真的必须在 ajax 上做所有事情吗？

假设我调用 myapp.com/projects 并且项目使用所有这些 js 文件，然后我单击“显示”链接并在此重定向上重定向到 myapp.com/projects/1，所有 js 将再次重新加载?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T22:21:06.217

不，您的 Javascript 文件不会再次加载，它们将被缓存在客户端上。

但是，是的，您的应用程序需要在每次页面加载时与服务器进行检查，服务器通常会响应脚本没有更改。通过使用 AJAX，您可以减少与服务器的连接数。您可以通过将所有 Javascript 文件合并为一个来减少连接数。

但是请注意，AJAX 会添加一些新问题，例如强制您跟踪内存泄漏，因为如果您从不重新加载新页面，您的应用程序将永远不会卸载其对象。

如果您对 Javascript 不满意，我强烈建议您坚持每次都重新加载页面的“旧”模型。如果您有性能问题，您可以稍后处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T22:23:09.877

## 重新加载图像、脚本等...

### 简短的回答：是的

### 长答案：取决于

当您查看页面时，您的浏览器将请求 HTML，一旦获得 HTML，它将开始加载外部引用（图像、脚本等）。当它去请求图像或脚本时，您的浏览器可能会发送一个标头，说明它最后一次获取它的时间并将其存储在其缓存中。Web 服务器可能会用一个`304 Not Modified`代码响应，告诉浏览器使用缓存版本，避免再次下载它。

即使浏览器不使用这些标头，它仍然会缓存，只是不知道缓存何时到期。当您使用 rails 助手来包含图像和脚本时，它会在 url 的末尾附加一个数字，该数字对脚本内容是唯一的。因此，如果您更改内容，将使用新的 url 强制浏览器获取更新的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T09:05:30.143

使用 Google 的[Ajax 库 API](http://code.google.com/apis/ajaxlibs/)！Google 现在拥有最流行的 js 库，包括 Prototype、Scriptaculous 和 jQuery。一旦他们托管了特定版本，他们就会承诺无限期地托管该版本。

Ryan Heath 在 github 上有一个小的 Rails 插件：

```
script/plugin install git://github.com/rpheath/google_ajax_libraries_api.git 
```

然后在您的视图中而不是使用默认值

```
<%= javascript_include_tag :defaults => 
```

改用这个：

```
<%= google_jquery =>
<%= google_prototype =>
<%= google_scriptaculous => 
```

如果需要，您可以指定版本。查看[Ryan 在 github 上的自述文件以](http://github.com/rpheath/google_ajax_libraries_api/)获取更多信息。

这样您就不必费心设置资产主机（至少不是为您的标准 javascript 设置）并为自己节省大量带宽！

# c# - 使用 LINQ 时避免代码重复

> ID：485567
> 
> 赞同：6
> 
> 时间：2009-01-27T22:16:24.277
> 
> 标签：c#, .net, linq, refactoring

好的，所以我有许多看起来像这样的方法：- 按艺术家、专辑、年份等对列表进行排序。

```
 public void SortByAlbum(SortOrder sortOrder)
        {
           if (sortOrder == SortOrder.Ascending)
              _list = _list.OrderBy(x => x.Album).ToList();
           else if (sortOrder == SortOrder.Descending)
              _list = _list.OrderByDescending(x => x.Album).ToList();
        } 
```

还有这个：

```
 public void SortByArtist(SortOrder sortOrder)
        {
           if (sortOrder == SortOrder.Ascending)
              _list = _list.OrderBy(x => x.Artist).ToList();
           else if (sortOrder == SortOrder.Descending)
              _list = _list.OrderByDescending(x => x.Artist).ToList();
        } 
```

现在显然这不是好的代码，所以它需要重构为一个 Sort() 方法，但我只是想不出如何以最简单的方式做到这一点。我不在乎它是使用 IComparer 还是 LINQ。

我希望它看起来像这样：

```
 public void Sort(SortOrder sortOrder, SortType sortType)
    {
        //implementation here
    }

    public enum SortType
    {
       Artist,
       Album,
       Year
    } 
```

那么在没有代码重复的情况下最干净的方法是什么？

谢谢，李

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-27T22:25:03.727

您应该能够模仿 OrderBy 扩展方法的签名：

**更新 1**，您必须在 keySelector Func 的第一个通用参数中明确。我将猜测您的类型并称其为“歌曲”。

```
public void Sort<TKey>(SortOrder sortOrder,
                       Func<Song, TKey> keySelector)
{
    if (sortOrder == SortOrder.Descending)
    {
        _list = _list.OrderByDescending(keySelector).ToList(); 
    }
    else
    {
        _list = _list.OrderBy(keySelector).ToList(); 
    }
} 
```

现在您可以像这样调用“排序”：

```
Sort(SortOrder.Descending, x => x.Album); 
```

**更新 2**

跟进 Tom Lokhorst 的评论：如果您想预定义一些速记排序标准，您可以通过定义这样的类来实现：

```
public static class SortColumn
{
    public static readonly Func<Song, string> Artist = x => x.Artist;
    public static readonly Func<Song, string> Album = x => x.Album;
} 
```

现在您可以简单地调用：

```
Sort(SortOrder.Descending, SortColumn.Artist); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T06:37:32.593

您可以尝试使用[通用比较器](http://www.c-sharpcorner.com/UploadFile/dipenlama22/SortingUsingGeneric07052006081035AM/SortingUsingGeneric.aspx?ArticleID=dafdb8cc-fd02-4a4d-bd17-0c5785b1b91d)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T12:39:19.410

我认为您应该将扩展方法添加到`IList<T>`：

```
 public static class extIList {
    public static IList<T> Sort<T, TKey>(this IList<T> list, SortOrder sortOrder, Func<T, TKey> keySelector) {
            if (sortOrder == SortOrder.Descending) {
                return list.OrderByDescending(keySelector).ToList();
            } else {
                return list.OrderBy(keySelector).ToList();
            }
    }
} 
```

然后你可以对你的每个对象使用 pretty：

```
IList<Person> list = new List<Person>();

list.Add(new Person("David","Beckham"));
list.Add(new Person("Gennaro","Gattuso"));
list.Add(new Person("Cristian","Carlesso"));

list = list.Sort(SortOrder.Descending, X => X.Name); 
```

ps SortOrder 已经存在：

```
using System.Data.SqlClient; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-28T06:54:01.360

如果您有几种专门的方法，那么排序听起来就像它自己的生命一样。也许他们可以聚集成一个班级。

```
public enum SortOrder
{
    Ascending = 0,
    Descending = 1
}
public class Sorter<T>
{
    public SortOrder Direction { get; set; }
    public Func<T, object> Target { get; set; }
    public Sorter<T> NextSort { get; set; }

    public IOrderedEnumerable<T> ApplySorting(IEnumerable<T> source)
    {
        IOrderedEnumerable<T> result = Direction == SortOrder.Descending ?
            source.OrderByDescending(Target) : 
            source.OrderBy(Target);

        if (NextSort != null)
        {
            result = NextSort.ApplyNextSorting(result);
        }
        return result;
    }

    private IOrderedEnumerable<T> ApplyNextSorting
        (IOrderedEnumerable<T> source)
    {
        IOrderedEnumerable<T> result = Direction == SortOrder.Descending ?
            source.ThenByDescending(Target) :
            source.ThenBy(Target);
        return result;
    }
} 
```

* * *

这是示例用法：

```
List<string> source = new List<string>()
    { "John", "Paul", "George", "Ringo" };

Sorter<string> mySorter = new Sorter<string>()
{
    Target = s => s.Length,
    NextSort = new Sorter<string>()
    {
        Direction = SortOrder.Descending,
        Target = s => s
    }
};

foreach (string s in mySorter.ApplySorting(source))
{
    Console.WriteLine(s);
} 
```

输出是保罗、约翰、林戈、乔治。

# visual-studio - 用于小型项目的带有 Visual Studio 集成的源代码控制

> ID：485569
> 
> 赞同：5
> 
> 时间：2009-01-27T22:16:57.583
> 
> 标签：visual-studio, visual-studio-2008, version-control, tfs

我开始开发个人 Web 应用程序项目。我想为该项目提供一个源代码控制系统。

在工作中，我们使用 Team Foundation Server，我对此非常满意，主要用于 Visual Studio 集成。

我想知道是否有与 VS2008 具有相同集成的**免费源代码控制解决方案。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T22:45:30.207

实际上，我刚开始使用 Subversion，我所做的只是去他们的网站并下载服务器（安装和设置大约需要 10 分钟）。安装程序会询问您希望代码存储库在哪里，然后它会完全设置服务器。我唯一要做的就是放入密码文件中。我安装了 ankhsvn（这是一个集成到 Visual Studio 中的 SVN 客户端），它运行良好，没有任何问题。正是你所期望的。总体来说工作量很小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T22:20:16.390

[颠覆](http://ankhsvn.open.collab.net/)，[善变](http://sharesource.org/project/visualhg/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T22:35:57.513

我认为你有两个选择，真的：

颠覆。它很容易设置等，而且是免费的。我喜欢 VisualSVN，它是 50 美元，价值至少是 5 倍，但你可以使用 Ankh（免费，OSS）或只使用 tortose（Windows 资源管理器插件，OSS，免费）。

一旦你有了 tortoseSVN（VisualSVN 也需要它），你可以制作本地 repo，或者使用远程 repo，例如 VisualSVNServer（也是免费的），或者个人，我的网站托管在我的 dreamhost :)

另一种选择是[SourceGear Vault](http://sourcegear.com/vault/)。如果您在某处拥有基于 Windows 的服务器（它基于 SQL 200x + ASP.NET，包括我认为的 SQL Express 版），那就太好了，而且它对一个用户免费。如果你习惯了 SourceSafe 或 TFS 那就太好了，如果你愿意，它可以以 SVN/CVS checkout-merge-commit 的方式工作（不是默认的，但很容易改变），或者只使用 check out - lock -像VSS一样签入。

您可能在前一周的 Stack Overflow 播客上听过 SourceGear 的 Eric Sink - 同一家公司。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T22:21:02.177

[50 Bucks](http://www.visualsvn.com/)为您提供所需的所有颠覆控制。

编辑：从长远来看...... 50 美元和免费一样好......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T13:21:49.237

我发现 Subversion 很容易安装。AnkhSVN 很好地集成到 Visual Studio IDE 中，并确保您不会忘记将在 IDE 中创建的新文件添加到 SVN。然而，AnkhSVN 似乎也有它的周期性打嗝。

当我使用 TortoiseSVN 时，它似乎更稳定，而且它还有一些 Ankh 仍然缺乏的高级功能（比如一个很好的冲突编辑器）。这就是为什么我同时使用 Ankh 和 SVN 来实现两全其美。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T22:24:00.330

Subversion 很好，但安装起来并不容易（因为它需要 Apache）。看看[Vault](http://www.sourcegear.com/vault/)的安装非常简单，并且与 Visual Studio 配合得很好。它对单个开发人员也是免费的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T22:25:04.647

visualsvn + ankhsvn 非常适合我

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T22:55:07.363

[尽管TortoiseSVN](http://tortoisesvn.net/)没有直接集成到 Visual Studio 中，但我对它有很好的体验。它是免费的，并且可以很好地集成到 Windows 中。

如果您想要一个集成度更高的解决方案，我会推荐[SourceGear](http://www.sourcegear.com/vault/)的 Vault 。它对个人用户免费，并且易于设置。它具有比 SVN 更多的功能，并且可以从 VS 内部直接访问。

# javascript - HTML/CSS：嵌套元素树的布局比嵌套表格有什么更好的选择？

> ID：485573
> 
> 赞同：8
> 
> 时间：2009-01-27T22:19:10.510
> 
> 标签：javascript, jquery, html, css, cross-browser

好的，我有一组用于选择标准的复选框。为了论证的缘故，我们会说数据如下所示：

```
[] Vehicles
   [] Unpowered
      [] Bicycle
      [] Skateboard
   [] Powered
      [] Two-wheeled
         [] Motorcycle
         [] Scooter
      [] Four-wheeled
etc 
```

[] 代表复选框。

忽略这个例子明显做作的性质，这个想法是这样的：

*   首先，只有 Vehicle 复选框可见；
*   如果用户点击 Vehicle 复选框，则进入下一个级别（Powered，Unpowered）；
*   如果用户选择 Powered，则会打开下一个级别（两轮、四轮）；
*   如果用户随后取消选中 Powered，则该级别将消失。

现在这相对容易设置，通过 onclick 在块和无之间切换显示 CSS 属性。

目前在页面上的结构如下：

```
<table>
<tr>
  <td><input type="checkbox" onclick="toggle('__Vehicles');"></td>
  <td>Vehicles
    <table id="__Vehicles">
    <tr>
      <td><input type="checkbox"></td>
      <td>Unpowered
etc 
```

在有人问之前我应该​​指出：将复选框放在表格单元格中的原因是为了控制格式。它使有效缩进变得容易，因为下一个表格单元格中的所有内容都会对齐。

一切正常，但表格嵌套变得非常深。我一直认为必须有比这更好的方法。它必须能够轻松地动态构建，并且对“树”的格式化具有良好的跨浏览器支持。

我还应该提到 jQuery 是可用的。我用它来做其他事情。

建议？

**编辑：**是的，复选框样式很重要，正如一些评论所指出的那样。此外，我已经根据我得到的回复发布了一个解决方案，作为下面的答案（太大，无法在此处添加），仅供那些好奇的人查看示例。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-27T22:24:17.613

```
<ul>
    <li><input type="checkbox" />Vehicles <ul>
        <li><input type="checkbox" />Unpowered</li>
        <li><input type="checkbox" />Bicycle</li>
        <li><input type="checkbox" />Skateboard</li>
    </ul></li>
    <li><input type="checkbox" />Powered <ul>
        <li><input type="checkbox" />Two-wheeled <ul>
            <li><input type="checkbox" />Motorcycle</li>
            <li><input type="checkbox" />Scooter</li>
        </ul></li>
        <li><input type="checkbox" />Four-wheeled</li>
     </ul></li>
</ul> 
```

编辑：一点 css 和 js 来显示和隐藏嵌套元素（没有复选框）

```
li.opened ul {
display: block;
}

li.closed ul {
    display: none;
} 
```

和js...

```
$(document).ready(function() {

$('li input:checkbox').click(function () {
    $(this).parent().toggleClass('opened');
    $(this).parent().toggleClass('closed');
});

$('li').addClass('closed');
}); 
```

再次编辑，因为 Sparr 想要一些更好的样式（假设复选框具有“复选框”的样式

```
li input.checkbox { /* input:checkbox is not 100% compatible */
    width: 6px;
    margin: 0 2px;
    /* This makes 10px be the total "width" ofh the checkbox */
}

ul {
    margin: 0 0 0 10px; /* Or whatever your total checkbox width is */
    padding: 0;
}

li {
    padding: 0;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-27T22:24:53.837

你可以这样做：

```
<ul>
  <li>
    <input type="checkbox" /> Option 1
    <ul>
      <li><input type="checkbox" /> Option 1 Sub Option A</li>
    </ul>
  </li>
</ul> 
```

然后将 UL 的 padding/margin 设置为 0 和 0。然后将 LI 的 padding-left 设置为 10px。

```
ul {
  margin:0;
  padding:0;
}

li {
  margin:0;
  padding:0 0 0 20px; /* Each nested li will be padded incrementally */
} 
```

对于 javascript，将一个事件附加到每个复选框，以确定同级 UL（如果存在）是否应该可见。如果选中该框，则显示它，否则，隐藏它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-27T22:23:36.930

嵌套无序列表是这类事情的最佳实践。

```
<ul>
   <li>Item 1</li>
   <li>Item 2
      <ul>
         <li>Sub Item 1</li>
         <li>Sub Item 2</li>
         <li>Sub Item 3</li>
      </ul>
   </li>
   <li>Item 3</li>
   <li>Item 4
      <ul>
         <li>Sub Item 1</li>
         <li>Sub Item 2</li>
         <li>Sub Item 3</li>
      </ul>
   </li>
</ul> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-28T02:08:51.950

想看一些深刻的 jQuery 魔法吗？

```
<ul class="tree">
  <li><input type="checkbox" name="Vehicles" checked>Vehicles
    <ul>
      <li<input type="checkbox" name="Unpowered">Unpowered
        <ul>
          <li><input type="checkbox" name="Bicycle">Bicycle</li>
          <li><input type="checkbox" name="Skateboard">Skateboard</li>
        </ul>
      </li>
      <li><input type="checkbox" name="Powered" checked>Powered
        <ul>
          <li><input type="checkbox" name="Two-wheeled">Two-wheeled
            <ul>
              <li><input type="checkbox" name="Motorcycle" checked>Motorcycle</li>
              <li><input type="checkbox" name="Scooter">Scooter</li>
            </ul>
          </li>
          <li><input type="checkbox" name="Two-Wheeled">Four-wheeled</li>
        </ul>
    </ul>
  </li>
</ul> 
```

**注意：**这里唯一的装饰是树类。

```
ul.tree {
    list-style-type: none;
    margin: 0 0 0 -22px;
    padding: 0;
}

ul.tree ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
}

ul.tree input {
    margin-right: 6px;
}

ul.tree li {
    padding: 0 0 0 22px;
    margin: 1px;
}

.closed ul {
    display: none;
} 
```

和魔法：

```
$(function() {
    $("ul.tree li:has(ul) > :checkbox").click(function() {
        jQuery(this).parent().toggleClass('closed');
    }).not(":checked").parent().addClass("closed");
}); 
```

当您单击复选框时，这会将整个事物变成一个有效的打开和关闭树。惊人的。

感谢 davethegr8、Jonathon Sampson 和其他人的建议。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-27T22:33:08.720

除了上面的建议之外，我不得不建议您从标记中提取 javascript。使用诸如 lowpro（我最喜欢的）之类的库，您可以创建 1 个对象来处理您的嵌套复选框行为，并使其自动应用，不显眼。像这样打包你的代码使你的标记更容易维护，你的代码更容易和更快地编写，更强大，更容易维护。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T22:23:19.550

表格用于表格数据。改用嵌套列表和 CSS 进行格式化。

* * *

如果您正在寻找一个完整的解决方案，这里有一个为现代浏览器使用纯 CSS 和为 IE 使用 JavaScript 的解决方案：

```
<style>
ul.tree, ul.tree ul {
    position: relative;
    list-style: none;
    margin: 0 0 0 20px;
    padding: 0;
}
ul.tree input {
    position: absolute;
    margin-left: -20px;
}
ul.tree ul {
    display: none;
}
ul.tree input:checked ~ ul {
    display: block;
}
ul.tree label:hover {
    text-decoration: underline;
}
</style>
<ul class="tree">
  <li>
    <input type="checkbox" id="option1">
    <label for="option1">Option 1</label>
    <ul>
      <li>
       <input type="checkbox" id="option1a">
       <label for="option1a">Option 1 Sub Option A</label>
      </li>
      <li>
       <input type="checkbox" id="option1b">
       <label for="option1b">Option 1 Sub Option B</label>
      </li>
    </ul>
  </li>
  <li>
   <input type="checkbox" id="option2">
   <label for="option2">Option 2</label>
  </li>
</ul>
<!--[if lte IE 7]>
<script>
var tree = document.getElementsByTagName('ul')[0];
tree.attachEvent('onclick', function() {
    var src = event.srcElement;

    if(src.nodeName.toLowerCase() === 'label')
        var box = document.getElementById(src.htmlFor);
    else if(src.nodeName.toLowerCase() === 'input')
        var box = src;
    else return;

    for(var current = src.nextSibling;
        current && current.nodeName.toLowerCase() !== 'ul';
        current = current.nextSibling);

    if(current)
        current.style.display = box.checked ? 'block' : 'none';
});
</script>
<![endif]--> 
```

假设复选框不宽于`20px`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T01:33:50.553

虽然 jQuery 插件[mcDropdown](http://www.givainc.com/labs/mcdropdown_jquery_plugin.htm)以不同的方式处理嵌套列表问题（没有复选框），但它可能适合您的需要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T22:30:13.797

在创建 cb 时，根据级别给他们一个 css 类

```
<input class="LevelXcb" type="checkbox" /> 
```

CSS：

```
.Level0cb{left:4px;}
.Level1cb{left:16px;}
.Level2cb{left:28px;} 
```

如果“left”不起作用，请尝试设置“margin-left”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-27T22:45:32.953

我知道这与问题没有太大关系，所以请不要投票只是一个建议。

在 davethegr8 的这个例子中：

```
<ul>
    <li>Vehicles <ul>
        <li>Unpowered</li>
        <li>Bicycle</li>
        <li>Skateboard</li>
    </ul></li>
    <li>Powered <ul>
        <li>Two-wheeled <ul>
            <li>Motorcycle</li>
            <li>Scooter</li>
        </ul></li>
        <li>Four-wheeled</li>
     </ul></li>
</ul> 
```

如果你给每个步骤一个类，你可以使用 jquery 通过单击来制作一些很酷的下拉效果：

像

```
$("li.Two-wheeled").click(function(event){
   $("div.main_wrapper ul.Moto_or_scooter:hidden").slideDown("slow");
} 
```

只是一个小小的建议：）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T01:05:30.673

如果复选框的宽度仍然是一个问题（在所有先前的答案之后......），您可以：

*   将所有复选框放在一个固定的框中，以便您确切知道文本的开始位置（以及下一级复选框）
*   使用一些 jquery 计算来获取宽度并动态设置其他元素的边距（虽然看起来有点多......）

显然使用建议的嵌套列表结构。

# .net - 可移植/可互操作的 WCF 合同

> ID：485580
> 
> 赞同：9
> 
> 时间：2009-01-27T22:20:40.930
> 
> 标签：.net, wcf, interop, datacontract, contract

我想知道是否有人在设计 WCF 合同时有一些好的提示/注意事项，考虑到 Web 服务互操作性，无论是在旧的 Microsoft Web 服务技术（例如 WSE）和非 Microsoft 技术方面，例如Java 调用 WCF Web 服务。

例如：在将 DateTime 暴露为合同中的类型时，是否需要考虑任何特殊规则？字典和哈希表怎么样？使用各种可用的绑定可能会遇到什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T23:55:42.390

## WCF 日期时间问题

关于您的 DateTime 问题，您担心通过 WCF 传递 DateTime 是正确的。这只是许多抱怨困难的链接之一...... [http://daveonsoftware.blogspot.com/2008/07/wcf-datetime-field-adjusted.html](http://daveonsoftware.blogspot.com/2008/07/wcf-datetime-field-adjusted.html)

## 关于类型等价

根据 Juval Lowy 的名为 Programming WCF Services, 2nd Edition 的书的第 3.1.3 节......

> WCF 为原始类型提供隐式数据协定，因为这些类型的架构有一个行业标准。

他还指出了关于使用自定义类型作为 Operation Contract 方法的参数的问题。我认为这也适用于方法返回类型。

> 为了能够使用自定义类型作为操作参数，有两个要求：首先，该类型必须是可序列化的，其次，客户端和服务都需要具有该类型的本地定义，从而产生相同的数据架构。

您可能还想查看第 F.4 节。Data Contracts，这是他的 WCF 编码标准的一部分。Bullet #9 适用于您的问题...

> 不要将 .NET 特定类型（例如 Type）作为操作参数传递。

## 绑定建立期望

基于 WSHttpBindingBase（在 Reflector.NET 中搜索它的四个派生）的绑定将是最具互操作性的，因为它们是为互操作性而设计的。

## 书籍推荐

我强烈推荐 Juval 的书： http: [//www.bookpool.com/sm/0596521308](http://www.bookpool.com/sm/0596521308)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T22:32:30.233

因此，如果您想与非 microsoft 服务互操作，您可能希望避开任何非原始类型。WCF 使用序列化来编码数据以进行传输，例如 Java 将无法反序列化哈希表。然而，WCF 是建立在 SOAP 之上的，因此通过一些工作，您应该能够让任何 SOAP 功能在 JAVA 客户端和 WCF 服务之间工作，反之亦然。

只要记住编写原语合同，你就可以了。

# sql - 从 SQL 2008 中的外键关系生成删除语句？

> ID：485581
> 
> 赞同：22
> 
> 时间：2009-01-27T22:20:41.660
> 
> 标签：sql, code-generation, foreign-keys, dynamic-sql

是否可以通过脚本/工具根据表 fk 关系生成删除语句。

即我有表：DelMe(ID) 并且有 30 个表，其中我需要首先删除其 ID 的 fk 引用，是否有一些我可以运行的工具/脚本将根据 FK 关系生成 30 个删除语句为了我 ？

（顺便说一句，我知道关系上的级联删除，我不能在这个现有的数据库中使用它）

我正在使用 Microsoft SQL Server 2008

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-24T15:32:52.727

这是[Aasim Abdullah](http://connectsql.blogspot.co.il/2011/03/sql-server-cascade-delete.html)的级联删除脚本，适用于 MS SQL Server 2008：

```
IF OBJECT_ID('dbo.udfGetFullQualName') IS NOT NULL
    DROP FUNCTION dbo.udfGetFullQualName;

GO
CREATE FUNCTION dbo.udfGetFullQualName
(@ObjectId INT)
RETURNS VARCHAR (300)
AS
BEGIN
    DECLARE @schema_id AS BIGINT;
    SELECT @schema_id = schema_id
    FROM   sys.tables
    WHERE  object_id = @ObjectId;
    RETURN '[' + SCHEMA_NAME(@schema_id) + '].[' + OBJECT_NAME(@ObjectId) + ']';
END

GO
--============ Supporting Function dbo.udfGetOnJoinClause
IF OBJECT_ID('dbo.udfGetOnJoinClause') IS NOT NULL
    DROP FUNCTION dbo.udfGetOnJoinClause;

GO
CREATE FUNCTION dbo.udfGetOnJoinClause
(@fkNameId INT)
RETURNS VARCHAR (1000)
AS
BEGIN
    DECLARE @OnClauseTemplate AS VARCHAR (1000);
    SET @OnClauseTemplate = '[<@pTable>].[<@pCol>] = [<@cTable>].[<@cCol>] AND ';
    DECLARE @str AS VARCHAR (1000);
    SET @str = '';
    SELECT @str = @str + REPLACE(REPLACE(REPLACE(REPLACE(@OnClauseTemplate, '<@pTable>', OBJECT_NAME(rkeyid)), '<@pCol>', COL_NAME(rkeyid, rkey)), '<@cTable>', OBJECT_NAME(fkeyid)), '<@cCol>', COL_NAME(fkeyid, fkey))
    FROM   dbo.sysforeignkeys AS fk
    WHERE  fk.constid = @fkNameId; --OBJECT_ID('FK_ProductArrearsMe_ProductArrears')
    RETURN LEFT(@str, LEN(@str) - LEN(' AND '));
END

GO
--=========== CASECADE DELETE STORED PROCEDURE dbo.uspCascadeDelete
IF OBJECT_ID('dbo.uspCascadeDelete') IS NOT NULL
    DROP PROCEDURE dbo.uspCascadeDelete;

GO
CREATE PROCEDURE dbo.uspCascadeDelete
@ParentTableId VARCHAR (300), @WhereClause VARCHAR (2000), @ExecuteDelete CHAR (1)='N', --'N' IF YOU NEED DELETE SCRIPT
@FromClause VARCHAR (8000)='', @Level INT=0 -- TABLE NAME OR OBJECT (TABLE) ID (Production.Location) WHERE CLAUSE (Location.LocationID = 7) 'Y' IF WANT TO DELETE DIRECTLY FROM SP,  IF LEVEL 0, THEN KEEP DEFAULT
AS -- writen by Daniel Crowther 16 Dec 2004 - handles composite primary keys
SET NOCOUNT ON;
/* Set up debug */
DECLARE @DebugMsg AS VARCHAR (4000), 
@DebugIndent AS VARCHAR (50);
SET @DebugIndent = REPLICATE('---', @@NESTLEVEL) + '> ';
IF ISNUMERIC(@ParentTableId) = 0
    BEGIN -- assume owner is dbo and calculate id
        IF CHARINDEX('.', @ParentTableId) = 0
            SET @ParentTableId = OBJECT_ID('[dbo].[' + @ParentTableId + ']');
        ELSE
            SET @ParentTableId = OBJECT_ID(@ParentTableId);
    END
IF @Level = 0
    BEGIN
        PRINT @DebugIndent + ' **************************************************************************';
        PRINT @DebugIndent + ' *** Cascade delete ALL data from ' + dbo.udfGetFullQualName(@ParentTableId);
        IF @ExecuteDelete = 'Y'
            PRINT @DebugIndent + ' *** @ExecuteDelete = Y *** deleting data...';
        ELSE
            PRINT @DebugIndent + ' *** Cut and paste output into another window and execute ***';
    END
DECLARE @CRLF AS CHAR (2);
SET @CRLF = CHAR(13) + CHAR(10);
DECLARE @strSQL AS VARCHAR (4000);
IF @Level = 0
    SET @strSQL = 'SET NOCOUNT ON' + @CRLF;
ELSE
    SET @strSQL = '';
SET @strSQL = @strSQL + 'PRINT ''' + @DebugIndent + dbo.udfGetFullQualName(@ParentTableId) + ' Level=' + CAST (@@NESTLEVEL AS VARCHAR) + '''';
IF @ExecuteDelete = 'Y'
    EXECUTE (@strSQL);
ELSE
    PRINT @strSQL;
DECLARE curs_children CURSOR LOCAL FORWARD_ONLY
    FOR SELECT DISTINCT constid AS fkNameId, -- constraint name
                        fkeyid AS cTableId
        FROM   dbo.sysforeignkeys AS fk
        WHERE  fk.rkeyid <> fk.fkeyid -- WE DO NOT HANDLE self referencing tables!!!
               AND fk.rkeyid = @ParentTableId;
OPEN curs_children;
DECLARE @fkNameId AS INT, 
@cTableId AS INT, 
@cColId AS INT, 
@pTableId AS INT, 
@pColId AS INT;
FETCH NEXT FROM curs_children INTO @fkNameId, @cTableId; --, @cColId, @pTableId, @pColId
DECLARE @strFromClause AS VARCHAR (1000);
DECLARE @nLevel AS INT;
IF @Level = 0
    BEGIN
        SET @FromClause = 'FROM ' + dbo.udfGetFullQualName(@ParentTableId);
    END
WHILE @@FETCH_STATUS = 0
    BEGIN
        SELECT @strFromClause = @FromClause + @CRLF + '      INNER JOIN ' + dbo.udfGetFullQualName(@cTableId) + @CRLF + '       ON ' + dbo.udfGetOnJoinClause(@fkNameId);
        SET @nLevel = @Level + 1;
        EXECUTE dbo.uspCascadeDelete @ParentTableId = @cTableId, @WhereClause = @WhereClause, @ExecuteDelete = @ExecuteDelete, @FromClause = @strFromClause, @Level = @nLevel;
        SET @strSQL = 'DELETE FROM ' + dbo.udfGetFullQualName(@cTableId) + @CRLF + @strFromClause + @CRLF + 'WHERE   ' + @WhereClause + @CRLF;
        SET @strSQL = @strSQL + 'PRINT ''---' + @DebugIndent + 'DELETE FROM ' + dbo.udfGetFullQualName(@cTableId) + '     Rows Deleted: '' + CAST(@@ROWCOUNT AS VARCHAR)' + @CRLF + @CRLF;
        IF @ExecuteDelete = 'Y'
            EXECUTE (@strSQL);
        ELSE
            PRINT @strSQL;
        FETCH NEXT FROM curs_children INTO @fkNameId, @cTableId;
    --, @cColId, @pTableId, @pColId
    END
IF @Level = 0
    BEGIN
        SET @strSQL = @CRLF + 'PRINT ''' + @DebugIndent + dbo.udfGetFullQualName(@ParentTableId) + ' Level=' + CAST (@@NESTLEVEL AS VARCHAR) + ' TOP LEVEL PARENT TABLE''' + @CRLF;
        SET @strSQL = @strSQL + 'DELETE FROM ' + dbo.udfGetFullQualName(@ParentTableId) + ' WHERE ' + @WhereClause + @CRLF;
        SET @strSQL = @strSQL + 'PRINT ''' + @DebugIndent + 'DELETE FROM ' + dbo.udfGetFullQualName(@ParentTableId) + ' Rows Deleted: '' + CAST(@@ROWCOUNT AS VARCHAR)' + @CRLF;
        IF @ExecuteDelete = 'Y'
            EXECUTE (@strSQL);
        ELSE
            PRINT @strSQL;
    END
CLOSE curs_children;
DEALLOCATE curs_children; 
```

**使用示例 1**

请注意示例中使用完全限定的列名。这很微妙，但您必须为生成的 SQL 指定表名才能正确执行。

```
EXEC uspCascadeDelete
@ParentTableId = 'Production.Location',
@WhereClause = 'Location.LocationID = 2' 
```

**使用示例 2**

```
EXEC uspCascadeDelete
@ParentTableId = 'dbo.brand',
@WhereClause = 'brand.brand_name <> ''Apple''' 
```

**使用示例 3**

```
exec uspCascadeDelete
@ParentTableId = 'dbo.product_type',
@WhereClause = 'product_type.product_type_id NOT IN 
(SELECT bpt.product_type_id FROM dbo.brand_product_type bpt)' 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-28T10:40:50.170

生成的 DELETE 语句用于带参数的 SP，并作为 ON DELETE 触发器：（此变体仅支持单列 FK）

```
SELECT 'DELETE '+detail.name+' WHERE '+dcolumn.name+' = @'+mcolumn.name AS stmt, 
    'DELETE ' + detail.name + ' FROM ' + detail.name + ' INNER JOIN deleted ON ' + 
    detail.name + '.' + dcolumn.name + ' = deleted.' + mcolumn.name AS trg
FROM sys.columns AS mcolumn 
INNER JOIN sys.foreign_key_columns ON mcolumn.object_id = 
            sys.foreign_key_columns.referenced_object_id 
    AND  mcolumn.column_id = sys.foreign_key_columns.referenced_column_id 
INNER JOIN sys.tables AS master ON mcolumn.object_id = master.object_id 
INNER JOIN sys.columns AS dcolumn 
    ON sys.foreign_key_columns.parent_object_id = dcolumn.object_id 
    AND sys.foreign_key_columns.parent_column_id = dcolumn.column_id 
INNER JOIN sys.tables AS detail ON dcolumn.object_id = detail.object_id
WHERE (master.name = N'MyTableName') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-27T23:02:42.623

我很确定我在 Stack Overflow 上发布了代码，它会自动使用它`INFORMATION_SCHEMA`来生成动态 SQL，但我找不到它。让我看看我是否可以重新生成它。

你可能需要检查一下，我找不到我的原始代码，所以我修改了一些我的代码，这些代码自动为星型模式构建扁平视图。

```
DECLARE @COLUMN_NAME AS sysname
DECLARE @TABLE_NAME AS sysname
DECLARE @IDValue AS int

SET @COLUMN_NAME = '<Your COLUMN_NAME here>'
SET @TABLE_NAME = '<Your TABLE_NAME here>'
SET @IDValue = 123456789

DECLARE @sql AS varchar(max) ;
WITH    RELATED_COLUMNS
          AS (
              SELECT    QUOTENAME(c.TABLE_SCHEMA) + '.'
                        + QUOTENAME(c.TABLE_NAME) AS [OBJECT_NAME]
                       ,c.COLUMN_NAME
              FROM      INFORMATION_SCHEMA.COLUMNS AS c WITH (NOLOCK)
              INNER JOIN INFORMATION_SCHEMA.TABLES AS t WITH (NOLOCK)
                        ON c.TABLE_CATALOG = t.TABLE_CATALOG
                           AND c.TABLE_SCHEMA = t.TABLE_SCHEMA
                           AND c.TABLE_NAME = t.TABLE_NAME
                           AND t.TABLE_TYPE = 'BASE TABLE'
              INNER JOIN (
                          SELECT    rc.CONSTRAINT_CATALOG
                                   ,rc.CONSTRAINT_SCHEMA
                                   ,lkc.TABLE_NAME
                                   ,lkc.COLUMN_NAME
                          FROM      INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS rc
                                    WITH (NOLOCK)
                          INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE lkc
                                    WITH (NOLOCK)
                                    ON lkc.CONSTRAINT_CATALOG = rc.CONSTRAINT_CATALOG
                                       AND lkc.CONSTRAINT_SCHEMA = rc.CONSTRAINT_SCHEMA
                                       AND lkc.CONSTRAINT_NAME = rc.CONSTRAINT_NAME
                          INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc
                                    WITH (NOLOCK)
                                    ON rc.CONSTRAINT_CATALOG = tc.CONSTRAINT_CATALOG
                                       AND rc.CONSTRAINT_SCHEMA = tc.CONSTRAINT_SCHEMA
                                       AND rc.UNIQUE_CONSTRAINT_NAME = tc.CONSTRAINT_NAME
                          INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE rkc
                                    WITH (NOLOCK)
                                    ON rkc.CONSTRAINT_CATALOG = tc.CONSTRAINT_CATALOG
                                       AND rkc.CONSTRAINT_SCHEMA = tc.CONSTRAINT_SCHEMA
                                       AND rkc.CONSTRAINT_NAME = tc.CONSTRAINT_NAME
                          WHERE     rkc.COLUMN_NAME = @COLUMN_NAME
                                    AND rkc.TABLE_NAME = @TABLE_NAME
                         ) AS j
                        ON j.CONSTRAINT_CATALOG = c.TABLE_CATALOG
                           AND j.CONSTRAINT_SCHEMA = c.TABLE_SCHEMA
                           AND j.TABLE_NAME = c.TABLE_NAME
                           AND j.COLUMN_NAME = c.COLUMN_NAME
             )
    SELECT  @sql = COALESCE(@sql, '') + 'DELETE FROM ' + [OBJECT_NAME]
            + ' WHERE ' + [COLUMN_NAME] + ' = ' + CONVERT(varchar, @IDValue)
            + CHAR(13) + CHAR(10)
    FROM    RELATED_COLUMNS

PRINT @sql 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T10:20:50.943

另一种技术是使用代码生成器来创建 Sql。我很确定[MyGeneration](http://mygeneration.sourceforge.net/)（无连接）具有执行此操作的现有模板。使用该工具和正确的模板，您可以创建一个 sql 脚本，轻松删除相关内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T22:27:46.717

不幸的是，我认为级联*是*您要求的工具。我理解无法使用它，但它作为数据库的内置部分存在这一事实几乎扼杀了对替代品的需求。

# c - select() 调用的剩余时间

> ID：485586
> 
> 赞同：7
> 
> 时间：2009-01-27T22:22:03.220
> 
> 标签：c, linux, select, polling

我`select()`在 Linux/ARM 平台上使用来查看 udp 套接字是否收到了数据包。如果它在超时之前返回（检测到数据包），我想知道选择调用中剩余的时间。

类似于以下内容：

```
int wait_fd(int fd, int msec)
{
    struct timeval tv;
    fd_set rws;

    tv.tv_sec = msec / 1000ul;
    tv.tv_usec = (msec % 1000ul) * 1000ul;

    FD_ZERO( & rws);
    FD_SET(fd, & rws);

    (void)select(fd + 1, & rws, NULL, NULL, & tv);

    if (FD_ISSET(fd, &rws)) { /* There is data */
        msec = (tv.tv_sec * 1000) + (tv.tv_usec / 1000);
        return(msec?msec:1);
    } else { /* There is no data */
        return(0);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T15:40:04.117

最安全的事情是忽略模糊的定义`select()`并自己计时。

只需获取选择之前和之后的时间，然后从您想要的间隔中减去它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T23:23:43.967

如果我没记错的话，select() 函数会处理超时和 I/O 参数，当 select 返回时，剩余时间会在 timeout 变量中返回。

否则，您将不得不在调用之前记录当前时间，然后再次获取两者之间的差异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T23:59:45.907

从 OSX 上的“人选”：

```
 Timeout is not changed by select(), and may be reused on subsequent calls, however it 
 is good style to re-ini-tialize it before each invocation of select(). 
```

您需要在调用 select 之前调用 gettimeofday，然后在退出时调用 gettimeofday。

[编辑] linux 似乎略有不同：

```
 (ii)   The select function may update the timeout parameter to indicate
          how much time was left. The pselect  function  does  not  change
          this parameter.

   On Linux, the function select modifies timeout to reflect the amount of
   time not slept; most other implementations do not do this.  This causes
   problems  both  when  Linux code which reads timeout is ported to other
   operating systems, and when code is  ported  to  Linux  that  reuses  a
   struct  timeval  for  multiple selects in a loop without reinitializing
   it.  Consider timeout to be undefined after select returns. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T15:37:06.930

Linux select() 更新超时参数以反映过去的时间。

请注意，这不能跨其他系统移植（因此上面引用的 OS X 手册中的警告），但适用于 Linux。

吉拉德

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-12-23T03:31:59.813

不要使用 select，尝试在代码中使用大于 1024 的 fd，看看会得到什么。

# .net - .NET Framework 3.5 中的 OleDbPermission

> ID：485620
> 
> 赞同：0
> 
> 时间：2009-01-27T22:29:34.577
> 
> 标签：.net, permissions

我在 .net framework 3.5 中有一个 windows 程序来更新访问数据库，我需要将权限设置为完全信任级别。客户端没有在他们的服务器上安装框架配置工具，那么我还有其他地方可以进行此更改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-01T11:22:58.293

您可以使用记事本配置信任级别：

[http://msdn.microsoft.com/en-us/library/ff648344.aspx](http://msdn.microsoft.com/en-us/library/ff648344.aspx)

# cygwin - 设置独立的 cygwin 应用程序

> ID：485637
> 
> 赞同：5
> 
> 时间：2009-01-27T22:32:16.350
> 
> 标签：cygwin

我想设置一组最小的 cygwin 应用程序（ls、diff、path、find、grep），以便它们在没有完整 cygwin 安装的机器上运行。

我假设我需要的只是相关的 *.exe 文件和 *.dll。到目前为止，这就是我所拥有的。到目前为止它有效，但我想知道我可能会遇到任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T22:42:14.207

不是真的，但你可能想看看[UnxUtils](http://unxutils.sourceforge.net/)，对于你描述的那种应用程序，它比 cygwin 有一些优势：

1.  它不依赖于外部 DLL。

2.  可执行文件使用 msvcrt.dll，而不是 cygwin.dll，因此它们可以很好地与本机 Windows 路径配合使用。/cygdrive 路径与系统其余部分使用的本机路径之间没有断开连接。

3.  由于（2），如果您有机会必须这样做，它可以更好地集成到命令或 bat 文件中。

UnxUtils 非常适合将 sed 等功能部署到 Windows 机器，因为您只需将 sed.exe 放入应用程序目录，而不必担心注册任何 DLL 或其他安装复杂性。CMD.exe 将很好地管道和重定向以在批处理文件中使用它们，并且实用程序不介意`\r\n`行终止符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T21:49:34.340

还有[GnuWin32](http://gnuwin32.sourceforge.net/)项目。我使用它*和*CygWin，所以有时我很难说出我在什么样的环境中工作......这并不是一件坏事！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T22:40:46.613

我可以看到的一个问题是许可。您可能需要研究在什么条件下可以重新分发二进制文件。（这可能很简单，例如在 README 文件中包含关于从何处获取源的语句。）

另一个问题是 Cygwin 更新。当新的二进制文件发布时，您将如何让最终用户保持最新状态？

第三个潜在问题是应用程序需要的配置文件。然而，毫无疑问，这很容易在测试中弄清楚。

你考虑过[MinGW](http://www.mingw.org/)吗？它似乎比 Cygwin 更适合您的目的。

# sharepoint-2007 - 如何在 Sharepoint DataSheet 视图中处理仅附加文本字段？

> ID：485641
> 
> 赞同：1
> 
> 时间：2009-01-27T22:32:31.933
> 
> 标签：sharepoint-2007

我们创建了一个 Sharepoint 站点来跟踪流程。最终，我们将用它制作一个工作流程，但与此同时，我们都必须查看一份清单，其中列出了每件作品应该完成的各种日期。

所以基本上我的小组需要查看和更新​​列 X、Y、Z 和评论，而忽略其他 300 亿左右的列。这在数据表视图中很棒，因为我们可以轻松地查看我们的列，并在此处更新它们，而无需深入研究项目并浏览我们不需要的所有其他废话。

问题是 Comments 字段，我们真的需要在其中查看最后的实际评论。不幸的是，每当有人保存记录时，该字段都会更新为空白值（除非他们输入了评论），并且最后的实际评论会丢失，除非您深入研究该项目。

有没有办法让数据表视图显示所有条目？

我还应该注意，我对 Sharepoint 2007 知之甚少......所以详细的答案会很好！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T23:52:16.870

仅附加注释是通过版本机制实现的，因此在数据表视图中，您会看到每一行更新都是带有新注释的项目的新版本。在普通数据视图中，此逻辑由[AppendOnlyHistory 控件](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.webcontrols.appendonlyhistory.aspx)处理。对于像数据表这样不了解历史的视图，我不知道有任何解决方法。

# c++ - 令人困惑的 gprof 输出

> ID：485649
> 
> 赞同：4
> 
> 时间：2009-01-27T22:33:27.783
> 
> 标签：c++, optimization, profiling, gprof

我`gprof`在一个 C++ 程序上运行`16.637s`，根据`time()`，我在输出的第一行得到了这个：

```
%   cumulative   self              self     total           
time   seconds   seconds    calls   s/call   s/call  name    
31.07      0.32     0.32  5498021     0.00     0.00  [whatever] 
```

`31.07%`如果只需要几秒钟，为什么它会列出时间`.32`？这是每次通话时间吗？（那不是自己打电话吗？）

这是我第一次使用`gprof`，所以请善待:)

编辑：通过向下滚动，gprof 似乎只认为我的程序需要 1.03 秒。为什么它会变得如此错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-01T21:04:43.880

结果发现瓶颈出现在文件 I/O 中（请参阅[Is std::ifstream 明显慢于 FILE？](https://stackoverflow.com/questions/477225/is-stdifstream-significantly-slower-than-file)）。我切换到读取缓冲区中的整个文件，它的速度大大加快。

这里的问题是 gprof 在等待文件 I/O 时似乎没有生成准确的分析（参见[http://www.regatta.cs.msu.su/doc/usr/share/man/info/ru_RU/a_doc_lib /cmds/aixcmds2/gprof.htm](http://www.regatta.cs.msu.su/doc/usr/share/man/info/ru_RU/a_doc_lib/cmds/aixcmds2/gprof.htm)）。事实上，`seekg`甚至`tellg`不在分析列表上，他们是瓶颈！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-27T23:53:52.987

**Self seconds**是在 [whatever] 中花费的时间。

**累积秒数**是在 [whatever] 和它上面的调用中花费的时间（例如 [whatever] + main）

**这些都不包括在从 [whatever] 调用的函数中花费的时间。** 这就是为什么您没有看到更多时间列出的原因。

例如，如果您的 [whatever] 函数正在调用大量 printf，那么您的 gprof 输出会告诉您 printf 大部分时间都在吃东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T22:58:55.813

[这似乎是对如何阅读 gprof 输出](http://badgertronics.com/writings/gprof.html)的一个很好的概述。您正在查看的 31.07% 是 gprof 认为仅用于该函数（不包括它调用的函数）的总运行时间的一部分。赔率是百分比如此之大而时间很小的原因是 gprof 认为该程序不会像你那样花很长时间。这很容易通过向下滚动 gprof 输出的第一部分来检查：累积秒数会越来越大，直到它限制在程序的总运行时间（从 gprof 的角度来看）。我想你会发现这大约是 1 秒，而不是你期望的 16 秒。

至于为什么会有这么大的差异，我也说不上来。也许 gprof 没有看到所有的代码。或者您在分析时是否在检测代码上使用了时间？我不希望它能正常工作......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T00:23:01.540

您是否尝试过[此问题](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux)中提到的其他一些工具？他们如何比较会很有趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-23T21:22:04.497

您遇到了**gprof**和其他基于相同概念的分析器常见的问题 - 1) 对程序计数器进行采样以获得某种直方图，2) 测量函数以测量时间、计数并获取调用图。

对于实际定位性能问题，他们没有抓住重点。
这不是关于测量例程，而是关于找到有罪的代码。

假设您有一个采样器，它以随机的挂钟时间对程序进行频闪 X 射线扫描。在每个示例中，程序可能位于 I/O 中间，可能位于您编译的代码中，也可能位于某些库例程中，例如**malloc**。

但不管它在哪里，[它花费那段时间的责任是由调用堆栈上的每一行代码共同分担的](https://stackoverflow.com/questions/1777556/alternatives-to-gprof/1779343#1779343)，因为如果没有进行任何一个调用，它就不会在携带过程中完成该电话要求的工作。

因此，请查看显示在调用堆栈的多个样本上的每一行代码（样本越多越好）。那就是钱的所在。不要只看程序计数器在哪里。在堆栈的上方有“深口袋”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T22:48:46.940

是的，这些“秒”值~~不是~~每次调用。百分比时间适用于程序的整个运行。实际上，您的程序在该函数中花费了 31% 的时间（由于调用次数 + 每次调用所花费的时间）。

您可能想[了解](http://www.cs.utah.edu/dept/old/texinfo/as/gprof.html#SEC5)如何分析 gprof 的平面配置文件。

**更正：**对不起，前两秒的值是 OP 指出的累积值。

我认为奇怪的是，您看到“self”和“total s/call”为 0。

引用关于[gprof 准确性](http://www.cs.utah.edu/dept/old/texinfo/as/gprof.html#SEC12)的部分：“实际的误差量通常不止一个采样周期。事实上，如果一个值是采样周期的 n 倍，那么它的预期误差是 n 个采样周期的平方根。如果采样周期为 0.01 秒，foo 的运行时间为 1 秒，foo 运行时间的预期误差为 0.1 秒。从一次分析运行到下一次，平均可能会有这么大的差异。（有时会有所不同更多的。）”

此外，可能相关的是，可能值得注意的是 gprof 不会分析多线程程序。在这种情况下，您最好使用[Sysprof](http://www.daimi.au.dk/~sandmann/sysprof/)或[OProfile之类的东西。](http://oprofile.sourceforge.net/news/)

# c++ - C++中不同字符串类型的优缺点

> ID：485654
> 
> 赞同：3
> 
> 时间：2009-01-27T22:34:44.800
> 
> 标签：c++, string, cstring

很抱歉开始另一个关于 SO 的无法回答的问题，但我只是对 C++ 中所有不同字符串类型的优缺点感到好奇。我的特殊问题是在 MFC 的 CStrings 和 std::string 之间（因为我正在做仅限 Windows 的软件），但这将扩展到 C++ 中的任何字符串格式。在 C++ 中使用的最佳字符串类型是什么，为什么？

更新：我实际上发现了一个重复的问题。感谢那些已经回答的人。请对其他问题提出任何新的答复： [您如何在 C++ 中处理字符串？](https://stackoverflow.com/questions/133364/how-do-you-handle-strings-in-c)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T22:52:09.647

在罗马做到入乡随俗。如果您使用 MFC，请使用 CString，因为所有类都针对它进行了优化。其他任何事情，请使用 std::string，因为它是标准，您会发现这种体验在其他情况下很有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T22:39:32.857

标准::字符串

1.  它是 STL 的一部分
2.  它是便携式的。
3.  正确使用它可以像 c-strings 一样高效
4.  它比 c-strings 更安全。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T00:31:39.027

总结...

**std::string 优点：**

*   便携的
*   STL 和 Boost 算法支持
*   比 CStrings 更安全

**std::string 缺点：**

*   为 MFC 转换为 CString 可能会更慢

**CString 优点：**

*   针对 CString 优化的 MFC 函数

**CString 缺点：**

*   不便携
*   不支持 Boost 或 STL 算法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T22:57:29.200

除了 STL 中的算法之外，std::string 还可以通过 boost 字符串算法进行操作。对我来说，std::string 的支持库完全击败了 MFC。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T22:40:42.573

c++ 字符串类型的大多数问题来自需要太大内存开销的一种或另一种字符串类型。也就是说，如果您必须从一种字符串类型转换为另一种字符串类型，它也会变得繁重。如果您正在构建一个大型应用程序，我建议您制定一个关于使用哪些字符串的策略。

# c# - C# 绘制面向图

> ID：485655
> 
> 赞同：0
> 
> 时间：2009-01-27T22:34:58.263
> 
> 标签：c#, tree, drawing

是否有一种在 C# 语言中绘制有向图或树的有据可查的方法，而无需使用外部库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T22:40:35.367

您应该能够使用 System.Drawing 命名空间进行绘制，然后自己进行数学和计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T22:41:05.037

是的。您将使用 System.Drawing 命名空间（[此处](http://www.ondotnet.com/pub/a/dotnet/2002/05/20/drawing.html)有更多信息）。您需要创建一个足够大的虚拟画布来处理您最宽和最高的范围。这些可以通过计算树中的叶子数量来计算（使用图表有点困难），然后添加间距因子等。

这不是一个*难题*，但它很乏味。几年前我花了大约一天的时间。抱歉，我放弃了界面，因为太笨拙并且没有保留代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T22:41:10.247

是的，使用[`System.Drawing`](https://docs.microsoft.com/en-us/dotnet/api/system.drawing?view=netframework-4.7.2)包含绘图函数/类的命名空间。

基本上要画，你这样做：

```
Bitmap bmp = new Bitmap(width, height);
Image img = bmp;
Graphics g = Graphics.FromImage(img); 
```

然后使用`g.FillRectangle`,`g.DrawLine`等`g.DrawString`。

请记住，`0,0`虽然它在左上角:)

# c# - .NET 可以加载和解析与 Java Properties 类等效的属性文件吗？

> ID：485659
> 
> 赞同：62
> 
> 时间：2009-01-27T22:36:17.263
> 
> 标签：c#, configuration, file-io, load

在 C# 中是否有一种简单的方法来读取属性文件，该文件在单独的行中包含每个属性，后跟等号和值，如下所示：

```
ServerName=prod-srv1
Port=8888
CustomProperty=Any value 
```

在 Java 中，Properties 类很容易处理这种解析：

```
Properties myProperties=new Properties();
FileInputStream fis = new FileInputStream (new File("CustomProps.properties"));
myProperties.load(fis);
System.out.println(myProperties.getProperty("ServerName"));
System.out.println(myProperties.getProperty("CustomProperty")); 
```

我可以轻松地在 C# 中加载文件并解析每一行，但是是否有一种内置方法可以轻松获取属性，而无需自己解析键名和等号？我发现的 C# 信息似乎总是偏爱 XML，但这是一个我无法控制的现有文件，我更愿意将其保留为现有格式，因为它需要更多时间让另一个团队将其更改为 XML而不是解析现有文件。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-27T22:49:16.567

不，没有对此的内置支持。

您必须制作自己的“INIFileReader”。也许是这样的？

```
var data = new Dictionary<string, string>();
foreach (var row in File.ReadAllLines(PATH_TO_FILE))
  data.Add(row.Split('=')[0], string.Join("=",row.Split('=').Skip(1).ToArray()));

Console.WriteLine(data["ServerName"]); 
```

编辑：更新以反映保罗的评论。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-07T17:24:04.580

大多数Java“.properties”文件可以通过假设“=”是分隔符来分割——但格式比这要复杂得多，并且允许在属性名称或值中嵌入空格、等号、换行符和任何Unicode字符。

我需要为 C# 应用程序加载一些 Java 属性，因此我实现了 JavaProperties.cs 以使用与 Java 版本相同的方法正确读取和写入“.properties”格式的文件 - 您可以在[http://www.kajabity找到它.com/index.php/2009/06/loading-java-properties-files-in-csharp/](http://www.kajabity.com/index.php/2009/06/loading-java-properties-files-in-csharp/)。

在那里，您会找到一个 zip 文件，其中包含该类的 C# 源代码和一些我测试过的示例属性文件。

享受！

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-10-08T11:05:19.783

最后一堂课。谢谢[@eXXL](https://stackoverflow.com/questions/485659/can-net-load-and-parse-a-properties-file-equivalent-to-java-properties-class/862690#862690)。

```
public class Properties
{
    private Dictionary<String, String> list;
    private String filename;

    public Properties(String file)
    {
        reload(file);
    }

    public String get(String field, String defValue)
    {
        return (get(field) == null) ? (defValue) : (get(field));
    }
    public String get(String field)
    {
        return (list.ContainsKey(field))?(list[field]):(null);
    }

    public void set(String field, Object value)
    {
        if (!list.ContainsKey(field))
            list.Add(field, value.ToString());
        else
            list[field] = value.ToString();
    }

    public void Save()
    {
        Save(this.filename);
    }

    public void Save(String filename)
    {
        this.filename = filename;

        if (!System.IO.File.Exists(filename))
            System.IO.File.Create(filename);

        System.IO.StreamWriter file = new System.IO.StreamWriter(filename);

        foreach(String prop in list.Keys.ToArray())
            if (!String.IsNullOrWhiteSpace(list[prop]))
                file.WriteLine(prop + "=" + list[prop]);

        file.Close();
    }

    public void reload()
    {
        reload(this.filename);
    }

    public void reload(String filename)
    {
        this.filename = filename;
        list = new Dictionary<String, String>();

        if (System.IO.File.Exists(filename))
            loadFromFile(filename);
        else
            System.IO.File.Create(filename);
    }

    private void loadFromFile(String file)
    {
        foreach (String line in System.IO.File.ReadAllLines(file))
        {
            if ((!String.IsNullOrEmpty(line)) &&
                (!line.StartsWith(";")) &&
                (!line.StartsWith("#")) &&
                (!line.StartsWith("'")) &&
                (line.Contains('=')))
            {
                int index = line.IndexOf('=');
                String key = line.Substring(0, index).Trim();
                String value = line.Substring(index + 1).Trim();

                if ((value.StartsWith("\"") && value.EndsWith("\"")) ||
                    (value.StartsWith("'") && value.EndsWith("'")))
                {
                    value = value.Substring(1, value.Length - 2);
                }

                try
                {
                    //ignore dublicates
                    list.Add(key, value);
                }
                catch { }
            }
        }
    }

} 
```

样品用途：

```
//load
Properties config = new Properties(fileConfig);
//get value whith default value
com_port.Text = config.get("com_port", "1");
//set value
config.set("com_port", com_port.Text);
//save
config.Save() 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-01-03T06:14:31.843

旧问题（2009 年 1 月）的另一个答案（2018 年 1 月）。

Java 属性文件的规范在`[java.util.Properties.load(java.io.Reader)](https://docs.oracle.com/javase/9/docs/api/java/util/Properties.html#load-java.io.Reader-)`. 一个问题是规范比我们可能的第一印象有点复杂。另一个问题是这里的一些答案任意添加了额外的规范 - 例如，`;`被`'`视为注释行的开始，但它们不应该是。属性值周围的双引号/单引号被删除，但它们不应该被删除。

以下是需要考虑的要点。

1.  线有两种，*自然线*和*逻辑线*。
2.  自然行以`\n`、`\r`或`\r\n`流的结尾终止。
3.  通过使用反斜杠字符转义行终止符序列，可以将逻辑行分散到多个相邻的自然行中`\`。
4.  逻辑行中第二个和后续自然行开头的任何空白都将被丢弃。
5.  空格是空格 ( `, `\u0020`)、制表符 ( `\t`, `\u0009`) 和换页 ( `\f`, `\u000C`)。`
`*   正如规范中明确指出的那样，*“仅检查行终止符序列之前的字符来确定行终止符是否被转义是不够的；行终止符必须有奇数个连续的反斜杠才能被转义。由于输入是从左到右处理的，在转义处理后，行终止符（或其他地方）编码 n 个反斜杠之前的非零偶数 2n 个连续反斜杠。”**   `=`用作键和值之间的分隔符。*   `:`也用作键和值之间的分隔符。*   键和值之间的分隔符可以省略。*   注释行具有`#`or`!`作为其第一个非空白字符，这意味着在`#`or之前的前导空白`!`是允许的。*   注释行不能扩展到下一个自然行，即使它的行终止符前面是`\`.*   正如规范中明确指出的那样，如果用反斜杠转义`=`，`:`和空格可以嵌入到键中。*   甚至可以使用`\r`和`\n`转义序列包含行终止符。*   如果省略值，则使用空字符串作为值。*   `\uxxxx`用于表示 Unicode 字符。*   无效转义字符之前的反斜杠字符不被视为错误；它被默默地丢弃。`

 `因此，例如，如果`test.properties`具有以下内容：

```
# A comment line that starts with '#'.
   # This is a comment line having leading white spaces.
! A comment line that starts with '!'.

key1=value1
  key2 : value2
    key3 value3
key\
  4=value\
    4
\u006B\u0065\u00795=\u0076\u0061\u006c\u0075\u00655
\k\e\y\6=\v\a\lu\e\6

\:\ \= = \\colon\\space\\equal 
```

它应该被解释为以下键值对。

```
+------+--------------------+
| KEY  | VALUE              |
+------+--------------------+
| key1 | value1             |
| key2 | value2             |
| key3 | value3             |
| key4 | value4             |
| key5 | value5             |
| key6 | value6             |
| : =  | \colon\space\equal |
+------+--------------------+ 
```

`PropertiesLoader`[Authlete.Authlete](https://www.nuget.org/packages/Authlete.Authlete) NuGet 包中的类可以解释规范的格式。下面的示例代码：

```
using System;
using System.IO;
using System.Collections.Generic;
using Authlete.Util;

namespace MyApp
{
    class Program
    {
        public static void Main(string[] args)
        {
            string file = "test.properties";
            IDictionary<string, string> properties;

            using (TextReader reader = new StreamReader(file))
            {
                properties = PropertiesLoader.Load(reader);
            }

            foreach (var entry in properties)
            {
                Console.WriteLine($"{entry.Key} = {entry.Value}");
            }
        }
    }
} 
```

将生成此输出：

```
key1 = value1
key2 = value2
key3 = value3
key4 = value4
key5 = value5
key6 = value6
: = = \colon\space\equal 
```

Java中的一个等效示例如下：

```
import java.util.*;
import java.io.*;

public class Program
{
    public static void main(String[] args) throws IOException
    {
        String file = "test.properties";
        Properties properties = new Properties();

        try (Reader reader = new FileReader(file))
        {
             properties.load(reader);
        }

        for (Map.Entry<Object, Object> entry : properties.entrySet())
        {
            System.out.format("%s = %s\n", entry.getKey(), entry.getValue());
        }    
    }
} 
```

源代码`[PropertiesLoader.cs](https://github.com/authlete/authlete-csharp/blob/master/Authlete/Util/PropertiesLoader.cs)`可以在[authlete-csharp](https://github.com/authlete/authlete-csharp)中找到。[xUnit](https://xunit.github.io/)测试`PropertiesLoader`是用`[PropertiesLoaderTest.cs](https://github.com/authlete/authlete-csharp/blob/master/Authlete.Tests/Util/PropertiesLoaderTest.cs)`.

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-14T10:53:28.127

我编写了一个方法，允许在文件中使用空行、注释和引用。

例子：

var1="value1"
var2='value2'

'var3=outcommented
;var4=outcommented, too

这是方法：

```
public static IDictionary ReadDictionaryFile(string fileName)
{
    Dictionary<string, string> dictionary = new Dictionary<string, string>();
    foreach (string line in File.ReadAllLines(fileName))
    {
        if ((!string.IsNullOrEmpty(line)) &&
            (!line.StartsWith(";")) &&
            (!line.StartsWith("#")) &&
            (!line.StartsWith("'")) &&
            (line.Contains('=')))
        {
            int index = line.IndexOf('=');
            string key = line.Substring(0, index).Trim();
            string value = line.Substring(index + 1).Trim();

            if ((value.StartsWith("\"") && value.EndsWith("\"")) ||
                (value.StartsWith("'") && value.EndsWith("'")))
            {
                value = value.Substring(1, value.Length - 2);
            }
            dictionary.Add(key, value);
        }
    }

    return dictionary;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-27T22:50:41.837

是的，我知道没有内置的类可以做到这一点。

但这不应该是一个真正的问题吗？它看起来很容易解析，只需将结果存储`Stream.ReadToEnd()`在字符串中，根据新行拆分，然后拆分`=`字符上的每个记录。剩下的是一堆键值对，您可以轻松地将它们扔进字典中。

这是一个可能对您有用的示例：

```
public static Dictionary<string, string> GetProperties(string path)
{
    string fileData = "";
    using (StreamReader sr = new StreamReader(path))
    {
        fileData = sr.ReadToEnd().Replace("\r", "");
    }
    Dictionary<string, string> Properties = new Dictionary<string, string>();
    string[] kvp;
    string[] records = fileData.Split("\n".ToCharArray());
    foreach (string record in records)
    {
        kvp = record.Split("=".ToCharArray());
        Properties.Add(kvp[0], kvp[1]);
    }
    return Properties;
} 
```

以下是如何使用它的示例：

```
Dictionary<string,string> Properties = GetProperties("data.txt");
Console.WriteLine("Hello: " + Properties["Hello"]);
Console.ReadKey(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-09T22:00:14.573

真正的答案是否定的（至少不是本身）。您仍然可以编写自己的代码来执行此操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-27T22:45:43.530

C# 通常使用基于 xml 的配置文件，而不是像你说的 *.ini 样式的文件，所以没有内置的东西来处理这个问题。然而，谷歌返回了[一些有希望的结果](http://www.google.com/search?q=c%23+ini+file)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-27T22:48:28.347

我不知道有任何内置方法可以做到这一点。但是，这似乎很容易做到，因为您唯一需要担心的分隔符是换行符和等号。

在给定文件内容的情况下，编写一个返回 NameValueCollection 或 IDictionary 的例程将非常容易。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-09-12T19:56:50.307

您还可以使用具有默认值和限制集的 C# 自动属性语法。这里的优点是您可以在属性“文件”（现在实际上是一个类）中拥有任何类型的数据类型。另一个优点是您可以使用 C# 属性语法来调用属性。但是，您只需要为每个属性写几行（属性声明中的一行，构造函数中的一行）即可完成这项工作。

```
using System;
namespace ReportTester {
   class TestProperties
   {
        internal String ReportServerUrl { get; private set; }
        internal TestProperties()
        {
            ReportServerUrl = "http://myhost/ReportServer/ReportExecution2005.asmx?wsdl";
        }
   }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-03-20T16:06:42.053

为此有几个 NuGet 包，但目前都处于预发布版本。

*   [Capgemini.Cauldron.Core.JavaProperties](https://www.nuget.org/packages/Capgemini.Cauldron.Core.JavaProperties/) 2.0.39-beta
*   [Kajabity.Tools.Java](https://www.nuget.org/packages/Kajabity.Tools.Java/) 0.2.6638.28124

[更新] 截至 2018 年 6 月，[Capgemini.Cauldron.Core.JavaProperties](https://www.nuget.org/packages/Capgemini.Cauldron.Core.JavaProperties/)现在处于稳定版本（版本 2.1.0 和 3.0.20）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-03-16T20:07:51.747

我意识到这并不是您要问的，但以防万一：

当您想要加载一个*实际*的Java 属性文件时，您需要适应它的编码。 [Java 文档](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html)表明编码是 ISO 8859-1，其中包含一些您可能无法正确解释的转义序列。例如，查看[这个 SO 答案](https://stackoverflow.com/questions/1273986/converting-utf-8-to-iso-8859-1-in-java)，了解将 UTF-8 转换为 ISO 8859-1 的必要条件（反之亦然）

当我们需要这样做时，我们找到了一个开源的[PropertyFile.cs](http://www.koders.com/csharp/fidD3E2404580831F70556765AC914A17C54B2D7BDA.aspx)并进行了一些更改以支持转义序列。这个类是读/写场景的好类。您还需要支持的[PropertyFileIterator.cs](http://www.koders.com/csharp/fid03086EAED46338438F1DFF6BD2D90A50B7E4CFC4.aspx)类。

即使您没有加载真正的 Java 属性，请确保您的 prop 文件可以表达您需要保存的所有字符（至少 UTF-8）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-02-14T22:03:59.643

不，没有：但我创建了一个简单的课程来帮助：

```
public class PropertiesUtility
{
    private static Hashtable ht = new Hashtable();
    public void loadProperties(string path)
    {
        string[] lines = System.IO.File.ReadAllLines(path);
        bool readFlag = false;
        foreach (string line in lines)
        {
            string text = Regex.Replace(line, @"\s+", "");
            readFlag =  checkSyntax(text);
            if (readFlag)
            {
                string[] splitText = text.Split('=');
                ht.Add(splitText[0].ToLower(), splitText[1]);
            }
        }
    }

    private bool checkSyntax(string line)
    {
        if (String.IsNullOrEmpty(line) || line[0].Equals('['))
        {
            return false;
        }

        if (line.Contains("=") && !String.IsNullOrEmpty(line.Split('=')[0]) && !String.IsNullOrEmpty(line.Split('=')[1]))
        {
            return true;
        }
        else
        {
            throw new Exception("Can not Parse Properties file please verify the syntax");
        }
    }

    public string getProperty(string key)
    {
        if (ht.Contains(key))
        {
            return ht[key].ToString();
        }
        else
        {
            throw new Exception("Property:" + key + "Does not exist");
        }

    }
} 
```

希望这可以帮助。

# java - Java 小程序通过 ssl 使用 Web 服务

> ID：485663
> 
> 赞同：1
> 
> 时间：2009-01-27T22:37:32.547
> 
> 标签：java, web-services, ssl, applet, certificate

我需要让我的 java 小程序通过 ssl 使用基于肥皂的 Web 服务。我知道您可以让 servlet 充当中间人/代理，但我想让 applet 直接通过 SSL 使用 Web 服务。问题是将证书提供给托管 Web 服务的 Web 服务器。我通过 Java 控制面板提供了这些 Java Applet 运行时设置：

> -Djavax.net.ssl.keyStore= `<local path to .p12`>
> 
> -Djavax.net.ssl.keyStorePassword= `<password`>

我还通过 Java 控制面板将客户端证书 (.p12) 作为客户端证书导入。我希望这样做：

> KeyStore ks = KeyStore.getInstance("JKS"); ks.load(new FileInputStream(System.getProperty("javax.net.ssl.keyStore"), System.getProperty("javax.net.ssl.keyStorePassword").toCharArray());

并从那里使用 KeyStore。但是，没有骰子！似乎我无法从小程序中访问这些属性。我也不想硬编码路径。我正在使用 JRE 1.6.0_10

有没有其他方法可以让小程序在没有 servlet 代理方法的情况下使用 Web 服务？我很可能走错了路。另外，如果可能的话，当 Web 服务与托管小程序的服务不同时，我会对这项工作感兴趣。

顺便说一句：我想摆脱的 servlet 代理方法在这里详细说明：http: [//www.ibm.com/developerworks/xml/library/x-jappws/](http://www.ibm.com/developerworks/xml/library/x-jappws/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T23:00:34.873

要访问这些属性并连接到您提供小程序的主机以外的主机，您需要 (a) 签名的小程序，以及 (b) 授予您的小程序所需访问权限的权限。

您可能希望研究 Java Web Start 来交付应用程序，而不是使用小程序。

编辑：一旦小程序签名，权限*可能*是自动的。

# asp.net - 如何在 Web 应用程序中实现时区？

> ID：485668
> 
> 赞同：2
> 
> 时间：2009-01-27T22:38:56.243
> 
> 标签：asp.net, timezone

我想在我的 Web 应用程序中实现时区。我研究并看到大多数网络应用程序使用 GMT 下拉菜单，这里是该下拉菜单的链接[http://www.attackwork.com/BlogEntry/6/Time-Zone-Dropdown-Select-List/Default.aspx](http://www.attackwork.com/BlogEntry/6/Time-Zone-Dropdown-Select-List/Default.aspx)

然后我看到这篇文章建议 UTC 是实现时区的方法。[http://aspnet.4guysfromrolla.com/articles/081507-1.aspx](http://aspnet.4guysfromrolla.com/articles/081507-1.aspx) 基本上是说不要使用**DateTime.Now**而是使用**DateTime.UtcNow**

我的问题是，

1.  是否有 UTC 时区的下拉列表，就像我在 GMT 上显示的第一个链接一样？
2.  我真的应该使用 UTC 还是 GMT？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T22:51:27.060

.NET 3.5 提供了[TimeZoneInfo](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)类，它可以让您相对简单地使用时区填充下拉列表。GMT 早于 UTC，而 UTC 于 1972 年 1 月 1 日正式成立。有关更多信息，请参阅[此链接](http://geography.about.com/od/timeandtimezones/a/gmtutc.htm)。就今天而言，这两者几乎是同义词，尽管它们具有不同的历史渊源。为您的目的使用更好的外观和功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T22:58:15.440

我不确定这是否是您要问的，但是在您的数据库中，您应该始终将时间戳存储在 UTC/GMT 中（正如其他人所指出的，它们的含义基本相同）。对于您的 Web 应用程序的每个用户，存储时区首选项。

然后，每当您向用户显示某事的时间戳时，将数据库中的 UTC 时间转换为用户的时区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T22:43:29.837

GMT（格林威治标准时间）与 UTC（世界协调时间）相同。这不是一个非此即彼的选择 - 使用它:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T22:53:36.337

尽可能使用本地化设置、功能和特性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T22:53:48.770

如果您不是针对 SQL Server 2008 运行或不想将时区管理抽象到数据库中，则应将所有时间存储为 UTC/GMT 并根据用户的配置文件设置应用时区差异，以便来自各地的用户世界可以看到他们当地时间的事件的时间戳。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T23:00:18.057

UTC 和 GMT 之间的区别可能太细了，无法在您的代码中打扰。但是，始终以零时区偏移在内部保存和处理时间可能是一个好主意，并将其作为演示问题进行处理。

也可以使用 JavaScript 来确定用户可能的时区：检查一些`Date`合理地接近至点的对象对的时区偏移量（即使是 1 月 1 日和 7 月 1 日也是一个合适的近似值）以获得粗略的时区标识。随意使用此信息来确定默认时区，但请允许用户更改它：JavaScript 没有提供足够的详细信息来选择具有国家和地区历史变化的确切时区，并且可能无法由反正用户。

# starteam - Starteam“未知”文件

> ID：485703
> 
> 赞同：3
> 
> 时间：2009-01-27T22:46:43.573
> 
> 标签：starteam

我们有一个 StarTeam 视图，其中包含两个处于“未知”状态的文件 - 有没有人了解它们为什么处于这种状态和/或我们如何让它们脱离这种状态？

删除它们并用不同的名称重新添加它们是唯一的解决方案吗？

请注意，如果您检出这两个文件（定期或使用“强制检出”），它们将始终被列为“未知”（烦人）。

谢谢。

* * *

更多信息基于克雷格的以下建议：

a) 使用 MD5 校验和计算文件状态：相同的结果（“未知”状态）

b) 这两个有问题的文件在服务器上只有一个修订版。我不确定这是否是因为我们的 CM 小组试图通过删除和重新创建文件来解决问题，或者是否真的只有一个修订版。这些文件是文本文件。

c) 我尝试删除本地机器上的文件并刷新状态。当我这样做时，我看到的不是列出为“未知”的两个文件，而是总共列出了四个状态为“丢失”的文件。每个文件列出两个条目 - 每对具有相同的文件名、文件夹路径、“修改者”和“签入时的文件戳”。我不知道为什么每个文件都列出了两次。如果我选择一对中的每个条目并选择“比较内容”，我的差异工具会说它们是相同的。

无论我使用 MD5 校验和比较还是非 MD5，这四个文件都有同样的奇怪问题。

如果我尝试检查所有四个丢失的文件，我会收到两个提醒我合并文件的警报。我说不，这些文件现在在我的本地文件系统上，状态又回到了我开始的地方——两个文件被列为“未知”。

* * *

克雷格的更新：

你肯定在做某事。我将每个重复的项目移动到另一个目录。这立即解决了这个问题，因为我现在可以在没有任何“未知”项目的情况下签出四个项目（两个在同一目录中，两个在新目录中）。然后我删除了我移动到新目录的两个项目。

在这样做时，我看到了更多信息。我们不知何故有一个这样的目录结构：

```
Parent_Dir
--SubDir1
--SubDir1
--SubDir1
--SubDir1 <- Two items were here
--SubDir1 <- Two items were here
--SubDir2
--SubDir3
--SubDir4
--SubDir5 
```

不知何故，我们有五个同名的子目录，而这两个文件存在于两个同名的子目录中。

问题似乎已解决。你认为我应该手动删除额外的子目录吗？

* * *

感谢克雷格，这个问题似乎得到了解决。我不知道这种情况是如何造成的（任何人？）但是..我们现在很好。谢谢克雷格！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T15:42:44.163

在确定问题所在之前删除文件将是一个巨大的错误。删除并重新添加该文件将终止历史记录和该文件的任何链接。由于 StarTeam 内部的工作方式（无论如何，使用 Native-II 存储库），它也可能无法解决问题。删除文件并重新添加相同的文件实际上不会更新存储库中的任何内容，除了指向该修订的指针。当您删除文件时，修订本身会保留在那里，重新添加它只会创建一个指向该修订的新指针。

如果您还没有这样做，我强烈建议您告诉 StarTeam 使用 MD5 校验和来计算文件状态。通过工具->个人选项->文件->使用文件校验和计算状态在客户端中执行此操作。然后再次尝试更新状态。这不是默认设置（至少在某些版本的 StarTeam 中），因此值得检查。如果您还没有这样做，它可能会自行解决问题。

首先要做的是确定修订版在服务器上是否有效。如果文件是文本，最简单的方法是比较该修订版和之前修订版之间的内容。如果确实发现修订已损坏，那么最好的解决方案是签出较早的修订，然后强制签入。这样您就可以保留文件的历史记录。

如果文件在服务器上看起来没问题，则通过比较内容在本地对其进行测试。如果文件在本地损坏，请随时在本地删除文件，然后再次检查。与删除服务器上的文件不同，这样做不会丢失任何内容，除了本地修订。

如果这些建议不能解决问题，我仍然不建议删除服务器上的文件。在这里告诉我你的调查结果，我们会看看我们可以从那里去。在我看来，扼杀历史几乎总是错误的。

## 更新

根据帖子中的更新信息，我对这里发生的事情有了更好的了解。很可能有两个项目指向同一个文件，并且具有相同的名称。“项目”是 StarTeam 中的一个概念，与单个文件、更改请求、需求等可以同时存在于多个位置这一事实相关。例如，您可以在两个不同的视图或项目中拥有一个文件。

通常，您在同一个文件夹中没有同名的项目。但它可能发生。这可能解释了“未知”状态。当您告诉 StarTeam 将磁盘上的文件与服务器上的同名项目进行比较时，它可能无法确定应该查看哪个项目。

我会尝试的第一件事是尝试将这两个项目中的一个拖动到其他地方。如果这样可以解决相关文件夹中的问题，您可以在其他位置删除该项目，而不会影响文件夹中的项目。另一方面，如果将其中一个项目拖到别处导致它们都移动，则很容易将项目拖回它们原来的位置。

## 更新 2

> 你认为我应该手动删除额外的子目录吗？

是的，但就像文件一样，先移动它们，并确保您要保留的子目录不受影响，然后再删除它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T08:47:08.687

如果再次出现此问题，识别此问题的一个好方法是单击根文件夹，将文件夹路径添加到显示的列，然后单击所有后代按钮。按名称对文件进行排序，并查找未知文件并查看是否有多个同名文件检出到同一路径。这通常是错误共享、添加或更改文件夹签出路径的结果。

由于尚未确定 StarTeam 检出文件的顺序，因此将两个同名的不同文件指向同一个本地位置是错误的。2005R2 本机 Windows 客户端和跨平台客户端会以稍微不同的顺序提取文件，导致存在此问题的视图生成具有不同文件的签出。

有几种方法可以合法地结束这种情况 - 在提示中保留单个文件的多个分支并通过视图标签指定要使用的分支是一种常见的方法。StarTeam 是少数几个可以像这样处理多个引用的 VC 之一。

Separately, if you can help it, never delete and re-add a file. 99% of the time, it isn't what you want to do. Re-adding a file to the server gives it a whole new archive in the database and it will not be tied in any way to existing shares of that file. You will also lose all of your revision history. Instead, look for ways to move files. And if you have multiple files with the same name and content on your server, it is usually a good idea to make an effort to share the file to the various places it should exist rather than re-add it. This will make sure your changes propagate so you don't need to check-in fixes multiple times.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T22:11:51.833

这些文件是否添加了两次？您可以多次添加相同的文件，这可能会导致此错误。另外，检查参考选项卡 - 这些链接文件是否指向存储库中的其他位置？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T23:04:20.777

那可能是文​​件或它们的状态在服务器上损坏了吗？在这种情况下，删除并重新添加是唯一的方法。

# development-environment - 最大化和多个显示器

> ID：485721
> 
> 赞同：4
> 
> 时间：2009-01-27T22:52:29.023
> 
> 标签：development-environment, multiple-monitors

我为拥有多台显示器的用户编写软件，并根据以下假设做出设计决定：通常用户将最大化每个显示器的窗口，而不是“手动调整”它们。

最近我注意到，在使用多台显示器方面似乎有两个“学校”。有“最大化”学派，然后是“手工大小”学派，它几乎永远不会最大化。

只是好奇，在阅读本文的多显示器用户中，有多少人最大化而不是手动调整大小？我很想知道你在什么平台上（Mac vs Windows vs *nix）。

编辑：我认为从设计的角度来看，这是一个合法的民意调查。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-28T00:19:47.037

我基本上最大化了*一切*，自从我在 3.11 天开始使用 Windows 以来，我真的做到了。事实上，直到大约一年前，当我升级到双 1600x1200 LCD 时，我才终于觉得我不必*最大化*每个窗口，并且一次可以打开多个窗口。通常，我的编程 IDE 在一个显示器上最大化，而 Web 浏览器或某种文档或文档在另一个显示器上最大化。

实际上，我将“最大化”和“最小化”绑定到鼠标上的额外按钮，就在滚轮的前后，而“ctrl-tab”和“alt-tab”绑定到我的拇指按钮。它们是令人惊讶的生产力提升。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T23:06:55.110

我将我的 IDE 延伸到两台显示器上，尽可能地填充它们。然后，我将窗口分成两个窗格，这样我的测试夹具在一侧，我正在测试的课程在另一侧。与我必须查看一门课程或另一门课程相比，点击/键盘输入/记忆要少得多。

将一个 IDE 窗口最大化到每个监视器会更容易，但我的 IDE 不会那样滚动，所以我必须模仿它 - 所以也许让我失望一半，另一半……

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T22:59:36.810

最大化（Windows）

我一直看到人们，手动调整大小，抓住一侧，然后是另一侧，然后......我真的不明白人们为什么这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-01T21:49:56.130

我也不做。相反，我使用一个窗口管理器，它实际上为我管理窗口，消除了窗口定位和定位的痛苦。这并不真正适用于多台显示器，但可以说是。

wmii 是我首选的 WM，但也有一些非常好的基于平铺和标签/视图的 WM，例如 stumpwm 和 xmonad。都具有多显示器支持。

当您想要同时查看多个窗口时，标准的类似 Windows（OS X、Gnome、KDE ​​等）的一组窗口管理隐喻真的会崩溃。对于使用非游戏计算机完成的任何有趣的事情，几乎一直都是这样。

即使用户的 WM 是这样工作的，我也不认为他们会将您的应用程序最大化到屏幕上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T23:28:29.823

这取决于应用程序。我的 2 台显示器是我的笔记本电脑 LCD 和一个 20 英寸宽的屏幕，因此它们不能完全对齐，也不利于在两个屏幕上最大化。如果我正在编程，我会将我的 IDE 放在宽屏上并在那里最大化以获得最多的编码空间。但由于我喜欢宽屏，我经常将应用程序拖入和拖出 LCD，如果它们没有最大化，那会更容易。（我的平台是Windows）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T23:35:07.363

我在 Windows 中手动调整大小，以便可以看到更多窗口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T22:55:38.643

我最大化。但这取决于系统如何反应的驱动程序。

我曾经有一个最大化两个显示器的设置，这有点太多了。但我解决了那个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T23:00:17.417

我几乎总是在 19 英寸或更小的显示器上最大化。大于这个尺寸，我通常手动调整大小。

当谈到多显示器最大化时，我使用 Ultramon。很棒的小应用程序，甚至为额外的显示器提供了额外的任务栏。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-27T23:01:35.090

我分开差价。一些监视器将包含最大化的项目，例如编辑器窗口，而另一些则包含大量手动调整大小的项目。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-27T23:16:19.287

最大化是最快的方法。我注意到如果您一次执行许多任务并且您必须经常打开和关闭窗口，那么拥有许多调整大小的窗口不起作用。它只是变得一团糟，最大化使它更清晰。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-27T23:19:04.943

我在我的 windows 和 linux 机器上最大化，并在我的 mac 上手动设置大小。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-01T21:29:06.437

我在 linux 上使用两台显示器，每台显示器上有多个桌面，我将所有内容最大化。我还使用了一个平铺窗口管理器，但更多的是这样它才能*真正*最大化所有内容 - 平铺并没有按照我想要的方式工作，所以我在很大程度上忽略了这一点。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-01T21:34:15.820

除了视频游戏，我从不最大化我的窗口。我可以临时在单个屏幕上最大化 IDE。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-01T21:34:30.810

最大化 IDE、Photoshop、Illustrator 和 Outlook，其余部分几乎是窗口化的。

在单个 24 英寸显示器 (1920x1200) 上运行 Windows Vista。

在较小的屏幕上，我几乎可以最大化所有内容。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-01T21:34:46.567

作为一名 Web 开发人员，当我有幸拥有两台显示器时，我将始终使用两个典型的配对应用程序（IDE/浏览器、IDE/Profiler、IDE/SQL、浏览器/Photoshop 等） - 无论如何总是成对最大化。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-01T21:49:44.697

我有一个双显示器设置 (@1680x1050)，在我的“编程”显示器上，它包含我的终端、编辑器和文档，我总是最大化一切。

在我的另一台显示器上，包括我的浏览器、IM 客户端和音乐播放器，我用手调整大小，这样我就可以同时在屏幕上显示所有这些应用程序。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-01T22:14:02.137

我很少最大化窗口——事实上我*讨厌*最大化窗口，如果应用程序需要我最大化它们，我更讨厌它。在某些情况下，最大化窗口对我来说没有意义：谁需要浏览器中的文本比典型的 1024 像素更宽？而且通常网站的设计最大宽度就是这个宽度，那么为什么要浪费屏幕上的空间来显示其他内容呢？即使它是运行 IRC 客户端并与前景窗口重叠的终端窗口，也会提供额外的信息。只有少数情况下，总是最大化应用程序窗口确实有意义。

此外，如果我可以一直看到终端窗口，那么在编辑器和终端之间切换会更好。最大化一切对我来说感觉很不自然——你也没有最大化你在桌子上的文书工作（好吧，你身体上也不能，但是......）

这确实适用于我的单显示器和多显示器设置。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-01T22:51:52.887

*   窗口：最大化
*   没有 Xmonad 的 Linux：手动
*   Linux 与 XMonad：由 xmonad

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-02T01:51:05.550

我很少最大化，我希望窗口重新定位并调整到上次编辑会话中的位置。这应该基于每个文件进行记录（而不是应用程序的最后一次编辑会话的单个记录）。

在我的应用程序中，我创建设置文件，在其中记录窗口位置、大小和（取决于应用程序）、文件中的位置、最后一个输入字段/控件或其他信息以恢复编辑上下文。

这应该为每个用户单独记录（该位置不应记录在文件中，因为如果文件与不同的用户共享或在不同的上下文中编辑，其他用户可能会将窗口移动到不希望的位置），所以对于 Windows，我把它放在用户的本地设置文件夹中（不要把它放在注册表中），对于 UNIX，我把它放在 ~home/.app 目录中。我通常为每个应用程序有一个文件（因此应用程序可以轻松找到它的位置设置），每个文件（或编辑会话）都有一个记录条目。我肯定不会为此使用 XML（我将使用简单的格式化文本或二进制文件）。

用户应该能够轻松清除/重置所有和/或最近访问保存的窗口位置（即在应用程序的工具/选项/设置菜单中）。还要确保处理窗口位于屏幕外的情况（即桌面已调整大小或位于断开连接的多台显示器上），您可能需要将窗口移回桌面。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-20T03:13:50.667

我使用 Linux。

我最大化，但更经常使用'muximize'插件，它检测同一桌面上其他窗口的边缘并调整大小以适应开放的桌面空间。

例如，如果您在右上角有一个小的 IM 窗口，并 muximize 一个位于屏幕下半部分的窗口，它将水平延伸到屏幕的整个宽度，然后垂直向上延伸到屏幕的底部边缘。即时通讯窗口。

# c++ - C++ 中迭代器的键/值功能

> ID：485730
> 
> 赞同：7
> 
> 时间：2009-01-27T22:54:57.410
> 
> 标签：c++, stl, map, iterator

我知道这个问题以前曾以各种形式出现过，但这略有不同。

我有一个包含 std::map 的类。尽管我希望在类内将映射用于其他目的，但在外部我想将迭代器适配器公开给映射内的值（即 std::pair 中的第二项）。

例如在python中我可能会做这样的事情：

```
def __iter__(self):
    return self._dict.itervalues() 
```

我如何在 C++ 中执行此操作，将实现隐藏在类中？

谢谢，

担

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-27T22:58:38.653

看看 Boost[`transform_iterator`](http://www.boost.org/doc/libs/1_37_0/libs/iterator/doc/transform_iterator.html)提供的正是这种功能：

```
template <typename K, typename V>
struct get_value {
    const V& operator ()(std::pair<K, V> const& p) { return p.second; }
};

class your_class {
    typedef map<int, float> TMap;
    TMap mymap;

public:
    typedef get_value<TMap::key_type, TMap::data_type> F;
    typedef
        boost::transform_iterator<F, TMap::iterator>
        value_iterator;

    value_iterator begin() { return make_transform_iterator(mymap.begin(), F()); }

    value_iterator end() { return make_transform_iterator(mymap.end(), F()); }

    // TODO Same for const versions.
    // Rest of the interface …
}; 
```

现在您可以迭代这些值，例如：

```
your_class c;
// Fill c with some values …
copy(c.begin(), c.end(), ostream_iterator<float>(cout, " ")); 
```

# c# - 使用 ASP.NET 表单身份验证，如何让图像出现在登录屏幕上？

> ID：485735
> 
> 赞同：9
> 
> 时间：2009-01-27T22:56:38.500
> 
> 标签：c#, asp.net, .net-3.5, asp.net-2.0

我正在为一个小型 ASP.NET（3.5，C#）应用程序进行简单的表单身份验证，并在 web.config 中设置我的用户名和密码。

我想应用默认样式表并包含标题图形（包含在其他每个页面上），但图形和样式表将不适用，大概是因为匿名用户无权访问这两个文件。是否有一些简单的方法可以让我添加它们或其他一些方法让图像出现在页面上？

这是 web.config 的相关部分：

```
<authentication mode="Forms">
  <forms name=".ASPXFORMSAUTH" 
    path="/" 
    loginUrl="login.aspx" 
    protection="All" timeout="30">

    <credentials passwordFormat="SHA1">
      <user
          name="testuser"
          password="hashgoeshere"/>
    </credentials>
  </forms>
</authentication>
<authorization>
  <deny users="?" />
</authorization> 
```

样式表位于：/stylesheet.css，图像位于：/img/logoimage.png

谢谢。这个网站让我很高兴，因为希望它能让专家交流和他们蹩脚的付费墙死掉！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-27T23:02:06.820

您可以使用特定于位置的规则在 Web.Config 中添加例外（在 System.Web 部分之后添加这些）：

```
<location path="stylesheet.css">
    <system.web>
        <authorization>
            <allow users="*" />
        </authorization>
    </system.web>
</location>

<location path="img/">
    <system.web>
        <authorization>
            <allow users="*" />
        </authorization>
    </system.web>
</location> 
```

# installshield - installshield中是否有类似实体的speedfolder？

> ID：485736
> 
> 赞同：1
> 
> 时间：2009-01-27T22:56:38.797
> 
> 标签：installshield, installanywhere

我似乎已经获得了选择一些安装盾项目的特权。我过去在任何地方都使用过 install ，我想知道 installshield 中是否有相当于 speedfolder 的东西。speedfolder 是一种在不明确选择每个文件的情况下盲目地将整个文件夹复制到项目中的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T15:10:39.190

有几种方法可以做到这一点。

[动态文件链接](http://helpnet.acresso.com/robo/projects/HelpLibDevStudio9/IHelpDynamicFileLinking.htm)或使用[文件和文件夹](http://helpnet.acresso.com/robo/projects/installshield12helplib/IHelpISXFiles.htm)视图。

使用动态文件链接，您可以将项目指向一个或多个目录，IS 将在构建时刷新文件列表并将它们添加到您的安装中。

文件和文件夹视图可用于一次性将大量文件和文件夹拖放到您的项目中。

如果您选择使用动态文件链接，请务必先阅读其含义。查看 Installshield 帮助文件

# language-agnostic - PDL 在实际编程中是如何使用的？

> ID：485737
> 
> 赞同：2
> 
> 时间：2009-01-27T22:56:42.027
> 
> 标签：language-agnostic, pseudocode

我一直在阅读完整的代码，但它谈到的其中一件事是 PDL - 一种更高级别的设计语言，您可以在使用所选语言进行编码之前编写每个例程。

我想知道是否有人在现实生活中真的这样做过？它说的另一件事是将代码中的每一行 PDL 作为注释。这肯定是过于冗长的评论吗？

我从来没有在现实生活中使用过 PDL，除了可能在大学课程中使用类似 ISWIM 的东西，但我在编写自己的代码时从未使用过它。

当然，如果您首先用伪代码编写每个例程/方法/任何内容，您最终会浪费很多时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T23:14:09.447

> 当然，如果您首先用伪代码编写每个例程/方法/任何内容，您最终会浪费很多时间吗？

一点也不——事先计划好你要做什么可以节省时间。它迫使您在最简单的阶段（即在您真正做任何事情之前）仔细思考和重构。

您不必完全编写每个例程 - 只需关键步骤，即可为您提供足够的心理地图，了解每个部分将做什么，以及您是否已计划好所需的一切。

不过，我从来没有听说过 PDL（[程序设计语言](http://en.wikipedia.org/wiki/Program_Design_Language)？），而且 - 看过之后 - 它确实看起来很冗长、丑陋且费时费力，我不建议使用它 - 坚持简洁但易读伪代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-26T22:05:19.270

I used it in the 1980s when I worked in defense. PDL is overkill for a solo programmer's weekend project of 1-1000 lines of code. But if you are developing a 10k-100k line of code system with a team of a dozen software engineers, it is excellent for defining preliminary software designs in a waterfall methodology. Also, it was designed for compliance with MIL-STD software development requirements.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T19:04:35.047

我记得我在大学一年级软件工程学位期间遇到的一位讲师拒绝帮助学生，如果他们至少没有尝试过某种伪代码。

很多人曾经抱怨过它，但这是我从他那里学到的一项技能，我发现自己在设计软件时大部分时间都在使用它。编码时，我旁边总是有一个垫子和笔！**:)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-02T20:04:12.567

是的，我愿意。不过，直到我读了这本书，我才意识到它被称为 PDL。我称之为伪代码。伪代码和 PDL 之间的区别并不大 - PDL 避免使用目标语言结构，这在实践中并不是什么大问题。

如果例程不那么简单，我会从 PDL 开始。

顺便说一句，McConnell 在 Code Complete 的第二版中使用 word 伪代码而不是 PDL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-14T16:16:07.763

用伪代码编写东西非常有用，您最终会得到已经编写好的文档；-)。它将您的意图与您的实现脱钩，这很多时候是针对您的语言或环境的优化黑客。当您将伪代码保留在文档中时，将来的维护者或重构您的代码或翻译成其他语言的人会非常感谢您。我从来没有调用过 PDL，也是因为 Perl 中的 PDL 意味着 Perl 数据语言，这是一个非常有用的包，可以像在 R 中一样将大型数据集作为向量或矩阵处理。

# winforms - Empty BindingSource problem

> ID：485746
> 
> 赞同：3
> 
> 时间：2009-01-27T22:58:48.607
> 
> 标签：winforms, data-binding, datagridview, strongly-typed-dataset, bindingsource

I have a problem with binding data using BindingSource, typed dataset and DataGridView. My problem is: BindingSource, therefore grid, is empty after binding data (bindingSource.Count is 0). I couldn't figure out what I'm doing wrong and I'd be very happy if anyone could help me with this. My application structure is like this: I have two assemblies, one is Winforms UI and other is database class library.

**UI**

*   DataGridView, datasource as BindingSource
*   BindingSource, datasource = DBAssembly.typedDataset, datamember = DBAssembly.typedDataset.myTable

**Database assembly**

*   Sql Server CE database
*   Typed Dataset
*   DB class for database operations

**UI Code**

*OnLoad*

```
this.db = new DB(); 
db.BindData(); 
```

**DB Code**

*constructor*

```
create typedDataSet object 
create typedDataSetTableAdapters.MyTableTableAdapter object 
create typedDataSetTableAdapters.TableAdapterManager object 
```

*BindData()*

```
this.myTableTableAdapter.Fill(this.typedDataSet.MyTable) 
```

I'd appreciate any help with this.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T23:26:26.163

Well, the first thing to ask would be: what is `this.typedDataSet.MyTable.Rows.Count`? i.e. did the adapter do anything? If not, it has nothing to do with the binding.

Assuming it is non-empty, then what **exact** code are you using to set up `DataSource` and `DataMember`? I expect it should be:

```
bindingSource.DataSource = this.typedDataSet;
bindingSource.DataMember = "MyTable";
dataGridView.DataSource = bindingSource; 
```

Alternatively, you could set the `bindingSource`'s DataSource to `this.typedDataSet.MyTable` and leave the table blank.

Basically, I expect that you've told it the **type** of data to anticipate, but so far you haven't actually given it the data-set/data-table you want to use.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T20:41:57.767

*Basically, I expect that you've told it the type of data to anticipate, but so far you haven't actually given it the data-set/data-table you want to use.*

Marc you were right about this one. I hade to create a public DataSet property in my DB class and use it as DataSource of BindingSource to make this work. Thanks for the help.

# c++ - 如何找到计算机的 IP 地址？

> ID：485769
> 
> 赞同：1
> 
> 时间：2009-01-27T23:04:50.467
> 
> 标签：c++, sockets, ip-address

我正在用 C++ 编写一个使用网络套接字的程序。我需要找出计算机的 IP 地址是什么，以便将其显示给用户。该程序必须在 Windows 和 Linux 上运行。

我在某处听说一台计算机可以有多个 IP 地址。我想要不同计算机上的其他程序可以用来连接到计算机的那个。

这是我已经拥有的相关代码（变量在其他地方声明）：

```
master = new fd_set;
FD_ZERO(master);
struct sockaddr_in my_addr;

listener = socket(PF_INET, SOCK_STREAM, 0);

my_addr.sin_family = AF_INET;
my_addr.sin_port = htons(port);
my_addr.sin_addr.s_addr = INADDR_ANY;
memset(my_addr.sin_zero, '\0', sizeof my_addr.sin_zero);

bind(listener, (struct sockaddr *)&my_addr, sizeof my_addr);

listen(listener, 10);

FD_SET(listener, master);

fdmax = listener; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T23:07:27.993

> 我在某处听说一台计算机可以有多个 IP 地址。我想要不同计算机上的其他程序可以用来连接到计算机的那个。

嗯……那可能是他们中的任何一个。如果一台计算机有多个 IP 地址，则可以在其中任何一个上访问它。当然，其中一个可能受制于不同的防火墙规则，或者它们可能位于两个完全不同的网段上，但无法检测到所有这些情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T23:32:04.777

我发布了一个类似的问题，但最近在 OS X 上。我收到的[答案](https://stackoverflow.com/questions/409418/running-a-socket-server-in-cocoa#409426)是使用 0.0.0.0 或 INADDR_ANY。这将导致您的套接字侦听所有可用地址，因此您无需确定哪个是“正确的”地址。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-27T23:34:18.440

在 Windows 上，您想使用[GetAdaptersAddresses](http://msdn.microsoft.com/en-us/library/aa365915(VS.85).aspx) - 这会列出您机器中的所有适配器以及绑定到它们的 IP 地址。它也支持 IPv6 地址。您也可以使用[gethostbyname](http://msdn.microsoft.com/en-us/library/ms738524.aspx)，但这不支持 IPv6。

在 Linux 上，我们读取`/proc/net/dev`并`/proc/net/if_inet6`解析结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-27T23:17:59.487

我相信您可以将 getaddrinfo() 与您的侦听器套接字一起使用，以获取您绑定到的套接字的 IP 地址。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T23:15:22.317

这取决于您是想获取您的 LAN IP 地址（即您的计算机在您的计算机组中的地址）还是您的服务提供商在您每次连接到 Internet 时提供给您的 IP 地址。后者可以通过对某些 IP 检测 Web 服务的查询（我猜你会找到一个适当的 C++ 库，只需很少的谷歌搜索就可以做到这一点）来识别。

如果您想要一个**快速而肮脏**的解决方案，您可以尝试访问[http://www.whatismyip.org](http://www.whatismyip.org)并阅读内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T06:07:11.970

您可以使用C++项目中的[轻量级客户端/服务器套接字类进行参考。](http://www.codeproject.com/KB/IP/client_server_socket.aspx?fid=49576&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=51)

# delphi - Delphi - 从表单访问框架对象

> ID：485787
> 
> 赞同：2
> 
> 时间：2009-01-27T23:10:02.373
> 
> 标签：delphi, frames

我需要运行一个附加到按钮（比如 SQLBtn）的操作，该按钮位于我的应用程序中的 Frame1 上，来自 Form1。
我已经在 Form1 使用中包含了框架，但似乎无法以任何方式解决。
我已经尝试过 Frame1.SQLbtn TFrame1.SQLbtn TFrameSQLBtn 等，但无法做到。
我想得到类似于“SQLbtn.click”的东西来运行它背后的事件。

有谁知道如何解决它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T23:32:32.343

我不确定我是否正确理解了您的问题。听起来您有一个带有按钮的框架（以及按钮上的 TAction 或单击事件处理程序），并且该框架位于表单上。现在您想以编程方式模拟对该按钮的单击。

显然，您需要将框架单元添加到表单的 uses 子句中。您还需要表单上的框架实例，它应该导致框架类型的表单字段，例如

```
TForm1...
  ...
  Frame1: TFrame1;
end; 
```

`Frame1.SQLbtn.Click`然后，您可以通过表单的任何方法执行该代码。更好的方法可能是在框架上提供一个公共方法，您可以从表单中使用它。那么就不需要直接访问按钮了（按钮是框架的一个实现细节，可以说是框架私有）。

**澄清后编辑**

我了解到您有以下情况：

```
TFrameForm1...
  ...
  Frame1: TFrame1;
end;

TForm1...
  ...
  procedure something;
end;

procedure TForm1.something;
begin
  // how to call a method on Frame1 which is on FrameForm1
end; 
```

您最好的选择是将代码从框架按钮 OnClick 事件处理程序移动到一个单独的单元中。这可以是一个数据模块，也可以是具有独立过程的另一个单元。然后，您可以从 Form1 和 Frame1 按钮事件处理程序中调用该代码。这是 Vegar 所评论的。

如果这是不可能的，例如因为处理需要访问 Frame1 上的其他控件，请将代码移动到 Frame1 上的新过程中（我最初的建议）：

```
TFrame1...
  ...
public
  procedure framestuff;
end;

procedure TFrame1.framestuff;
begin
  ...
end;

procedure TFrame1.SQLbtnClick(Sender...);
begin
  framestuff;
end; 
```

现在您需要从 Form1 调用该方法。为此，您需要参考 FrameForm1。创建 TFrameForm1 时需要手动初始化（！）。在这个例子中，引用是一个字段 FFrameForm：

```
TForm1...
  ...
  FFrameForm: TFrameForm1;
  procedure something;      
end;

procedure TForm1.something;
begin
  FrameForm.framestuff;
end; 
```

或者，默认情况下，Delphi 将所有表单的全局变量添加到表单单元（自动创建表单，检查项目选项/表单）。然后你这样做：

```
procedure TForm1.something;
begin
  FrameForm1.framestuff; // if FrameForm1 is the name Delphi used for the global variable
end; 
```

当然还有很多其他的变化...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T11:01:41.250

```
procedure TDiferentForm.DoSomething();
begin
  Form1.YourFrame.ButtonClick(nil);
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T01:30:54.117

一件事可能会帮助您理解：当您创建表单（或框架）的实例时，delphi 会通过 DFM 并创建其中描述的所有对象的实例。

**如果**表单定义中有一个变量与 DFM 中的对象名称匹配，则加载程序将使变量指向该对象；如果您没有变量，则会创建对象，但您必须遍历 .Components 或 .Controls 才能获得它。

如果表单有一个框架的实例变量（并且该变量是公共的），那么任何其他表单的代码都可以访问它（例如 MainForm.Frame1...）并做它想做的事情。

为了封装框架，表单（毕竟只是一个类）可以具有公共*属性*，这些属性具有访问器和修改器来代理与嵌入框架之间的信息。封装是好的（恕我直言，OOP 最重要的方面），因为它使调用者和框架之间的链接松散：你可以在不破坏任何东西的情况下改变任何一方。

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T17:01:57.460

另一种解决方案是使用接口来避免循环引用问题并稍微简化代码。假设您有一个名为**foo**的过程，您想从系统中的任何位置调用它。这个过程的实现是在**tFooForm**中，它不是主窗体，而是主窗体知道的一个窗体。

首先创建一个新单元并将其命名为*Foo_Intf.pas*

其内容如下：

```
unit Foo_Intf;

interface

type
  IFoo = interface
    ['{4AC12AB9-557B-4E61-AB2D-8B10E591E33A}'] 
    // CTRL-SHIFT-G to create a new guid
    procedure Foo;
  end;

implementation

end. 
```

然后将方法添加到 tFooForm 类中，并包含接口。不要忘记在你的接口使用子句中使用 foo_intf.pas 单元。实现 foo 类以执行您希望该过程执行的任何操作。

```
tFooForm = class(tForm,IFoo)
  :
  procedure Foo;
  :
end; 
```

还将 IFoo 接口添加到主窗体，与上一步完全相同，但将实现更改为以下内容：

```
procedure tMainForm.Foo;
begin
  if not Assigned(FooForm) then
    FooForm := tFooForm.Create(Application);  // for simplicity sake
  FooForm.Foo;
end; 
```

现在，在任何你想调用 foo 函数的地方，只需要在 uses 子句中包含 Foo_Intf 单元并使用以下代码片段：

```
var
  FooIntf : IFoo;
begin
  if Not Supports(Application.MainForm, IFoo, FooIntf) then
    Raise Exception.create('Application.mainform does not implement IFoo');   
  FooIntf.Foo;
end; 
```

# python - 为什么我会得到 TypeError：不能将序列乘以“浮点”类型的非整数？

> ID：485789
> 
> 赞同：117
> 
> 时间：2009-01-27T23:11:02.840
> 
> 标签：python

我正在输入一个销售金额（通过输入）乘以定义的销售税（0.08），然后让它打印总金额（销售税乘以销售金额）。

我遇到了这个错误。任何人都知道可能出了什么问题或有任何建议吗？

```
salesAmount = raw_input (["Insert sale amount here \n"])
['Insert sale amount here \n']20.99
>>> salesTax = 0.08
>>> totalAmount = salesAmount * salesTax

Traceback (most recent call last):
  File "<pyshell#57>", line 1, in <module>
    totalAmount = salesAmount * salesTax
TypeError: can't multiply sequence by non-int of type 'float' 
```

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-01-27T23:19:00.530

`raw_input`返回一个字符串（字符序列）。在 Python 中，字符串和浮点数相乘没有定义的含义（而字符串和整数相乘有含义：`"AB" * 3`是`"ABABAB"`；多少是`"L" * 3.14`？请不要回复`"LLL|"`）。您需要将字符串解析为数值。

您可能想尝试：

```
salesAmount = float(raw_input("Insert sale amount here\n")) 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2014-12-15T16:28:02.713

也许这会在未来对其他人有所帮助 - 我在尝试多个浮点数和浮点数列表时遇到了同样的错误。问题是这里的每个人都在谈论将浮点数与字符串相乘（但这里我所有的元素一直都是浮点数）所以问题实际上是在列表上使用 * 运算符。

例如：

```
import math
import numpy as np
alpha = 0.2 
beta=1-alpha
C = (-math.log(1-beta))/alpha

coff = [0.0,0.01,0.0,0.35,0.98,0.001,0.0]
coff *= C 
```

错误：

```
 coff *= C 
TypeError: can't multiply sequence by non-int of type 'float' 
```

解决方案 - 将列表转换为 numpy 数组：

```
coff = np.asarray(coff) * C 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T23:16:17.120

问题是 salesAmount 被设置为一个字符串。如果您在 python 解释器中输入变量并按回车键，您将看到输入的值被引号括起来。例如，如果您输入 56.95，您会看到：

```
>>> sales_amount = raw_input("[Insert sale amount]: ")
[Insert sale amount]: 56.95
>>> sales_amount
'56.95' 
```

在乘以销售税之前，您需要将字符串转换为浮点数。我会把它留给你弄清楚。祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-03T08:34:32.427

你不能乘以字符串和浮点数。而不是你尝试如下。它工作正常

```
totalAmount = salesAmount * float(salesTax) 
```

# asp.net - 寻求建议：根据 DropdownList 值更新 FormView

> ID：485799
> 
> 赞同：0
> 
> 时间：2009-01-27T23:16:23.327
> 
> 标签：asp.net, data-binding, formview, xmldatasource

问候！

我正在寻找一些关于基于在该 FormView 控件中选择 DropDownList 在 FormView 中显示数据的方法的建议。例如，我有一个具有以下内容的 UserControl：

```
<asp:XmlDataSource ID="xdsMyXmlData" runat="server" EnableCaching="false" XPath="Root/Membership" />
<asp:FormView ID="fvwMyFormView" runat="server" DataSourceID="xdsMyXmlData">
    <ItemTemplate>
        <div>
            <h2><%# XPath("Title") %></h2>

            <fieldset>
                <asp:DropDownList ID="ddlMemberTypes" runat="server" DataSource='<%# XPathSelect("MenuItems/*") %>'></asp:DropDownList>
            </fieldset>
            <table>
                <thead>
                    <tr>
                        <th><%# XPath("Columns/Name") %></th>
                        <th><%# XPath("Columns/Age") %></th>
                        <th><%# XPath("Columns/DateJoined")%></th>
                    </tr>
                </thead>
                <tbody>
                    <asp:Repeater ID="rptMembershipInfo" runat="server" DataSource='<%# XPathSelect("Members/*") %>'>
                        <ItemTemplate>
                            <tr>
                                <th><%# XPath("Data/Name") %></th>
                                <td><%# XPath("Data/Age") %></td>
                                <td><%# XPath("Data/DateJoined") %></td>
                            </tr>
                        </ItemTemplate>
                    </asp:Repeater>
                </tbody>
            </table>
        </div>    
    </ItemTemplate>
</asp:FormView> 
```

到目前为止，UserControl 的 OnLoad() 看起来像这样：

```
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);

    string l_XmlData = MyControllerClass.GetMembershipTableXml(0);
    xdsMyXmlData.Data = l_XmlData;
} 
```

我希望能够将 DropDownList 的选定项的值传递给 GetMembershipTableXml() 以检索相应的 XML，然后使用它来填充 FormView 的值。最好的方法是什么？使用选定的 DropDownList 值作为查询字符串变量执行 Response.Redirect 回到当前页面？我希望有更好的方法。你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T23:26:56.333

您可以在 DropDownList 上为 OnSelectedItemChanged 创建一个事件；发生这种情况时，您可以获取所选项目，并调用 GetMembershipTableXml 函数。

最后，不要忘记在 FormView 控件上调用 DataBind 来更新值:)

我*想*这就是你所追求的，希望对你有帮助！

# algorithm - 绘制抗锯齿圆的算法？

> ID：485800
> 
> 赞同：15
> 
> 时间：2009-01-27T23:16:46.137
> 
> 标签：algorithm, drawing, rendering, graphics

什么是绘制抗锯齿圆的好算法？（填充和未填充。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-27T23:36:32.163

Bresenham（以直线算法闻名）也有一个圆形算法。

Xiaolin Wu 采用了 line 算法进行抗锯齿，同样对 circle 算法做了同样的事情。

[http://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm](http://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm)

您可以通过以下搜索找到圆形算法：

[http://www.google.com/search?q=小林%20Wu%20circle](http://www.google.com/search?q=Xiaolin%20Wu%20circle)

-亚当

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-27T23:23:45.810

如果您想要一个简单的，请从像素矩阵 A 到像素矩阵 B 进行柔和模糊。

这是我用过的（这里是伪代码）

```
anti_alised_matrix[x][y] = point[x][y] / 2 + point[x+1][y]/8 + point[x-1][y]/8 + point[x][y-1]/8 + point[x][y+1]/8; 
```

当然，这适用于灰度，但您可以轻松地在 RGB 中执行相同的操作。

这真的是一个非常简单的，你也可以添加对角线，即[x+1][y+1]，然后除以16或32。

* * *

## 回答 #3

> 赞同：-11
> 
> 时间：2009-01-27T23:27:40.683

创建一个图形对象 g。做

```
g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias; 
```

使用 g.FillEllipse 或 g.DrawEllipse 绘制抗锯齿圆

# actionscript-3 - 拖过进度条填充的 Flash 视频播放器洗涤器

> ID：485803
> 
> 赞同：0
> 
> 时间：2009-01-27T23:17:58.643
> 
> 标签：actionscript-3, progress-bar

我正在尝试对自定义视频播放器的擦洗器进行故障排除，如果 flv 尚未完全加载，我遇到了一个问题，即擦洗器被拖过进度条填充。

播放器在这里： http: [//mindfilemultimedia.com/stage/portfolio.html](http://mindfilemultimedia.com/stage/portfolio.html)

如果您播放视频，您会看到当 flv 仍在下载时，当您将滑动条移过黄色进度条进入该行的白色部分时，视频播放器将冻结。这样做是因为用户告诉它寻找尚未完全下载的视频部分。我想要它做的是确定flv 是否仍在下载并限制用户只能将scrubber 向上拖动直到黄色进度条的宽度。现在我已经设置了代码来检索 bytesLoaded 和 bytesTotal ，我想做的是说类似（在 actionscript 3 中）：

```
if (videoPlayer.bytesLoaded < videoPlayer.bytesTotal) {
    var newBounds:Rectangle = new Rectangle(0, 0, (videoPlayer.bytesLoaded/videoPlayer.bytesTotal) * MovieClip(root).SeekBar.SeekProgressBar.width, 0);
    MovieClip(root).SeekBar.SeekBarHandle.startDrag(false, newBounds);
} 
```

我绝不是一个动作脚本人，所以这是我尝试做我需要的事情。我感觉它不起作用，因为我错误地访问了进度条和洗涤器句柄的类，但我只是采用默认类，因为 seekbar 是 Fl​​ash 组件。好吧，我可能完全错了。这里的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T09:06:02.420

你把这段代码放在哪里？它需要放在某个地方，并定期更新。根据您使用的视频播放器类型，您可以查看它调度的事件并使用事件侦听器定期检查缓冲了多少。您也可以使用输入帧事件，尽管您需要确保在缓冲区完成后停止侦听，因为它会在每一帧上增加额外的开销。

作为旁注，SeekBar 和 SeekBarHandle 可能应该分别是 seekBar 和 seekBarHandle，因为在 actionscript 中以小写字母开头实例名称是标准做法。

# java - 为什么我的 java 程序会发送 TTL 为 1 的多播数据包？

> ID：485810
> 
> 赞同：3
> 
> 时间：2009-01-27T23:20:09.047
> 
> 标签：java, sockets, multicast, ttl

我有一个 java 客户端程序，它使用 mdns 和服务发现来查找其关联的服务器。在使用 Windows、Fedora 10 和 Ubuntu 8.10 在单一网络上进行大量测试后，我们向客户交付了一个测试版本。他们报告客户端和服务器从不连接。他们向我们发送了一个 wireshark 捕获，显示 mdns 数据包的 TTL 为 1，即使我们的代码将其设置为 32。当我们在本地测试时，TTL 为 32，就像我们设置的一样。客户正在使用 Redhat Enterprise 5。

我看到[Java Multicast Time To Live 始终为 0](https://stackoverflow.com/questions/139909/java-multicast-time-to-live-is-always-0)，但这让我很好奇为什么那个提问者的 TTL 为 0，而我的是 1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T00:12:28.410

您是否查看过[Java Multicast Time To Live 始终为 0](https://stackoverflow.com/questions/139909/java-multicast-time-to-live-is-always-0)的答案？这也可以解决您的问题。那里的答案引用了回答者的[博客条目](http://www.peterfranza.com/2008/09/25/setting-multicast-time-to-live-in-java/)。

# visual-studio - Visual Studio 2008 C# Express 中类底部的大量额外空间

> ID：485815
> 
> 赞同：2
> 
> 时间：2009-01-27T23:23:04.080
> 
> 标签：visual-studio, visual-studio-2008

滚动条滚动到我的课程结束。有没有办法调整这个？它只是VS约定吗？我不能删除空格，所以它不是回车。

我不喜欢这样的原因是我一直不小心滚动到课堂结束！

我特别想听听实际安装了 Visual Studio 2008 的人的意见；）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T23:45:05.657

要么您有额外的换行符（吉姆安德森所说的 cr/lfs），在这种情况下，您可以选择所有空白行并点击删除以摆脱额外的空间。另一种可能性是，您认为空白只是 IDE 让您向下滚动一页后的文件末尾（直到文件的最后一行位于屏幕的最顶部）。这是为了让您滚动到文件底部并开始输入，而不会在每次开始新行时滚动屏幕。

编辑：快速浏览一下我电脑上的其他编辑器表明这种事情很常见 - CodeWright 会让你继续向下滚动到你想要的范围（页面和页面超出文本末尾） - 尽管它确实显示了滚动当文件的底部位于文本屏幕的中间时，bar 一直到底部。

即使是像查询分析器这样的基本工具也有这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T23:44:27.657

这是一项功能（不，不是重新标记为“功能”的错误）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T23:24:45.637

重启？不严重，需要更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T23:38:37.010

我猜你有你需要删除的 CR/LF。

# .net - 如何将变量传递给 SqlDataSource 的 SelectCommand？

> ID：485821
> 
> 赞同：30
> 
> 时间：2009-01-27T23:24:54.340
> 
> 标签：.net, asp.net, variables, parameters, sqldatasource

我想将变量从后面的代码传递给 SqlDataSource 的 SelectCommand？

我不想使用内置参数类型（如 ControlParameter、QueryStringParameter 等）

我需要传递一个变量，但以下示例不起作用：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:itematConnectionString %>" SelectCommand = "SELECT items.name, items.id FROM items INNER JOIN users_items ON items.id = users_items.id WHERE (users_items.user_id = @userId) ORDER BY users_items.date DESC" >
    <SelectParameters>
        <asp:Parameter  DefaultValue="<%= userId %>" Name="userId"  DbType="Guid" />
    </SelectParameters>
</asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-27T23:28:45.363

试试这个，删除 SelectCommand 属性和 SelectParameters：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:itematConnectionString %>"> 
```

然后在后面的代码中这样做：

```
SqlDataSource1.SelectParameters.Add("userId", userId.ToString());

SqlDataSource1.SelectCommand = "SELECT items.name, items.id FROM items INNER JOIN users_items ON items.id = users_items.id WHERE (users_items.user_id = @userId) ORDER BY users_items.date DESC" 
```

虽然这对我有用，但以下代码也适用：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:itematConnectionString %>"
    SelectCommand = "SELECT items.name, items.id FROM items INNER JOIN users_items ON items.id = users_items.id WHERE (users_items.user_id = @userId) ORDER BY users_items.date DESC"></asp:SqlDataSource>

SqlDataSource1.SelectParameters.Add("userid", DbType.Guid, userId.ToString()); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-28T06:29:48.540

我们不得不经常这样做，所以我做了一个我称之为 DelegateParameter 的类

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Web.UI.WebControls;
using System.Reflection;

namespace MyControls
{
    public delegate object EvaluateParameterEventHandler(object sender, EventArgs e);

    public class DelegateParameter : Parameter
    {
        private System.Web.UI.Control _parent;
        public System.Web.UI.Control Parent
        {
            get { return _parent; }
            set { _parent = value; }
        }

        private event EvaluateParameterEventHandler _evaluateParameter;
        public event EvaluateParameterEventHandler EvaluateParameter
        {
            add { _evaluateParameter += value; }
            remove { _evaluateParameter -= value; }
        }

        protected override object Evaluate(System.Web.HttpContext context, System.Web.UI.Control control)
        {
            return _evaluateParameter(this, EventArgs.Empty);
        }
    }
} 
```

将此类放在您的 app_code 中（如果将其放在此处，请删除命名空间）或自定义控件程序集中。在 web.config 中注册控件后，您应该可以执行此操作

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:itematConnectionString %>"
    SelectCommand = "SELECT items.name, items.id FROM items INNER JOIN users_items ON items.id = users_items.id WHERE (users_items.user_id = @userId) ORDER BY users_items.date DESC">
    <SelectParameters>
    <asp:DelegateParameter Name="userId"  DbType="Guid" OnEvaluate="GetUserID" />
    </SelectParameters>
</asp:SqlDataSource> 
```

然后在你后面的代码中实现你喜欢的 GetUserID。

```
protected object GetUserID(object sender, EventArgs e)
{
  return userId;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-06-29T21:35:06.477

只需向页面添加一个自定义属性，该属性将返回您选择的变量。然后，您可以使用内置的“控制”参数类型。

在后面的代码中，添加：

```
Dim MyVariable as Long

ReadOnly Property MyCustomProperty As Long
    Get
        Return MyVariable
    End Get
End Property 
```

在选择参数部分添加：

```
<asp:ControlParameter ControlID="__Page" Name="MyParameter" 
PropertyName="MyCustomProperty" Type="Int32" /> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-28T03:38:40.147

附加到 GUID：

```
 SqlDataSource1.SelectParameters.Add("userId",  System.Data.DbType.Guid, userID); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-10-01T14:19:26.580

您可以使用 asp:SqlDataSource 的内置 OnSelecting 参数

示例：[.aspx 文件]

```
<asp:SqlDataSource ID="SqldsExample" runat="server"
SelectCommand="SELECT [SomeColumn], [AnotherColumn] 
               FROM [SomeTable]
               WHERE [Dynamic_Variable_Column] = @DynamicVariable"
OnSelecting="SqldsExample_Selecting">
<SelectParameters>
    <asp:Parameter Name="DynamicVariable" Type="String"/>
</SelectParameters> 
```

然后在你的代码后面实现你的 OnSelecting 方法：[.aspx.cs]

```
protected void SqldsExample_Selecting(object sender, SqlDataSourceCommandEventArgs e)
{
     e.Command.Parameters["@DynamicVariable"].Value = (whatever value you want);
} 
```

您也可以将其用于其他类型的数据库操作，只需实现您自己的方法：

```
OnInserting="SqldsExample_Inserting"
OnUpdating="SqldsExample_Updating"
OnDeleting="SqldsExample_Deleting" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-08-11T02:36:08.807

```
SqlDataSource1.SelectCommand = "select * from ta where name like '%'+@p+'%'";
if (SqlDataSource1.SelectParameters.Count == 0)
{
   SqlDataSource1.SelectParameters.Add("p", DbType.String, TextBox1.Text);
}
SqlDataSource1.SelectParameters["p"].DefaultValue = TextBox1.Text; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-18T18:20:01.043

试试这个。

```
Protected Sub SqlDataSource_Selecting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.SqlDataSourceSelectingEventArgs) Handles SqlDataSource.Selecting

    e.Command.CommandText = "SELECT [ImageID],[ImagePath] FROM [TblImage] where IsActive = 1"

    End Sub 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T23:29:20.667

您需要定义一个有效类型的 SelectParameter。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/xt50s8kz.aspx)描述了各种类型以及如何使用它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-01T22:41:15.627

我喜欢Al W的回答。不过有错别字。

```
<asp:DelegateParameter Name="userId"  DbType="Guid" OnEvaluate="GetUserID" /> 
```

- - 应该 - -

```
<asp:DelegateParameter Name="userId"  DbType="Guid" OnEvaluateParameter="GetUserID" /> 
```

希望这可以节省几分钟。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-28T01:16:11.293

如果您只是从标记中删除 DbType="Guid" ，请查看它是否有效。

# mobile - 谁支持WTAI（无线电话应用接口）

> ID：485824
> 
> 赞同：1
> 
> 时间：2009-01-27T23:27:00.997
> 
> 标签：mobile, wtai

有谁知道 WTAI 在手机中的支持范围有多广，或者可以指向支持的设备列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T09:34:46.123

绝大多数设备都支持一些 WTAI 原语（因为它们包含在 WAP 中）。当前支持：WTAPublic.makeCall、WTAPublic.sendDTMF 和 WTAPublic.addPBEntry

更多信息[在这里](http://discussion.forum.nokia.com/forum/showpost.php?p=9463&postcount=2)和[这里](http://www.nowsms.com/discus/messages/1/1673.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T16:57:42.763

我今天遇到了一些关于设备功能的资源。

[DeviceAtlas](http://deviceatlas.com)
和
[WURFL](http://wurfl.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:52:58.333

这取决于您希望使用 WTAPI 做什么。

如果是 wap 站点，请查看 Device Atlas 或 WURFL，或移动元素

我们遇到的下一个问题是在您点击通话链接后，您需要对其进行跟踪，我们过去曾使用 OnSip 等服务完成此操作。

因此，每个呼叫都会转到 OnSip，然后他们将呼叫转发到正确的号码上，然后每当有呼叫通过时，他们就会呼叫到托管在我们服务器上的 url，使我们能够跟踪点击点击呼叫链接的人数

# css - CSS 100% 高度与填充/边距

> ID：485827
> 
> 赞同：855
> 
> 时间：2009-01-27T23:28:18.187
> 
> 标签：css

使用 HTML/CSS，我怎样才能使一个元素的宽度和/或高度是其父元素的 100% 并且仍然具有适当的填充或边距？

“正确”是指如果我的父元素`200px`很高并且我指定`height = 100%`了`padding = 5px`我希望我应该得到一个`190px`高元素，并且`border = 5px`在父元素中很好地居中。

现在，我知道这不是标准盒子模型指定它应该如何工作的方式（尽管我想知道为什么，确切地说......），所以明显的答案不起作用：

```
#myDiv {
    width: 100%
    height: 100%;
    padding: 5px;
} 
```

但在我看来，必须有某种方法可以可靠地为任意大小的父级产生这种效果。有谁知道完成这个（看似简单的）任务的方法？

哦，为了记录，我对 IE 的兼容性并不是很感兴趣，所以这应该（希望）让事情变得更容易一些。

**编辑：**由于要求提供示例，因此这是我能想到的最简单的示例：

```
<html style="height: 100%">
    <body style="height: 100%">
        <div style="background-color: black; height: 100%; padding: 25px"></div>
    </body>
</html> 
```

接下来的挑战是让黑框在所有边缘都显示为 25 像素的填充，而页面不会变得足够大而需要滚动条。

* * *

## 回答 #1

> 赞同：778
> 
> 时间：2009-01-27T23:53:17.637

[通过阅读“ PRO HTML 和 CSS 设计模式](http://cssdesignpatterns.com/)” ，我学会了如何做这些事情。是的`display:block`默认显示值`div`，但我喜欢明确说明。容器必须是正确的类型；`position`属性是`fixed`、`relative`或`absolute`。

```
.stretchedToMargin {
  display: block;
  position:absolute;
  height:auto;
  bottom:0;
  top:0;
  left:0;
  right:0;
  margin-top:20px;
  margin-bottom:20px;
  margin-right:80px;
  margin-left:80px;
  background-color: green;
}
```

```
<div class="stretchedToMargin">
  Hello, world
</div>
```

Nooshu[评论中的](https://stackoverflow.com/questions/485827/css-100-height-with-padding-margin#comment2356498_485887)[小提琴](http://jsfiddle.net/Rpdr9/)

* * *

## 回答 #2

> 赞同：420
> 
> 时间：2010-06-14T14:10:08.503

[CSS3](https://www.w3.org/TR/css-sizing-3/#box-sizing)中有一个新属性，您可以使用它来更改盒子模型计算宽度/高度的方式，它称为 box-sizing。

通过将此属性设置为值“border-box”，当您添加填充或边框时，它会使您应用它的任何元素都不会拉伸。如果你定义了 100px 宽度和 10px 内边距的东西，它仍然是 100px 宽。

```
box-sizing: border-box; 
```

[有关浏览器支持，请参见此处](http://caniuse.com/#feat=css3-boxsizing)。它不适用于 IE7 及更低版本，但是，我相信 Dean Edward 的[IE7.js](http://dean.edwards.name/IE7/notes/)增加了对它的支持。享受 ：）

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2010-04-09T20:03:17.143

解决方案是根本不使用高度和宽度！使用顶部、左侧、右侧、底部连接内框，然后添加边距。

```
.box {margin:8px; position:absolute; top:0; left:0; right:0; bottom:0}
```

```
<div class="box" style="background:black">
  <div class="box" style="background:green">
    <div class="box" style="background:lightblue">
      This will show three nested boxes. Try resizing browser to see they remain nested properly.
    </div>
  </div>
</div>
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2013-06-15T17:34:43.107

更好的方法是使用 calc() 属性。所以你的情况看起来像：

```
#myDiv {
    width: calc(100% - 5px);
    height: calc(100% - 5px);
    padding: 5px;
} 
```

简单，干净，没有变通办法。只要确保你不要忘记值和运算符之间的空格（例如`(100%-5px)`，这会破坏语法。享受吧！

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-01-27T23:45:00.727

根据 w3c 规范，高度是指可视区域的高度，例如在 1280x1024 像素分辨率的显示器上 100% 高度 = 1024 像素。

min-height 是指包含内容的页面的总高度，因此在内容大于 1024px min-height:100% 的页面上将拉伸以包含所有内容。

另一个问题是除了 ie6 之外的大多数现代浏览器中的高度和宽度都添加了填充和边框（ie6 实际上很合乎逻辑，但不符合规范）。这称为盒子模型。所以如果你指定

```
min-height: 100%;
padding: 5px; 
```

它实际上会给你 100% + 5px + 5px 的高度。为了解决这个问题，您需要一个包装容器。

```
<style>
    .FullHeight { 
       height: auto !important; /* ie 6 will ignore this */
       height: 100%;            /* ie 6 will use this instead of min-height */
       min-height: 100%;        /* ie 6 will ignore this */
    }

    .Padded {
       padding: 5px;
    }
</style>

<div class="FullHeight">
   <div class="Padded">
      Hello i am padded.
   </div
</div> 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-01-15T20:30:45.023

**1\. 全高带`padding`**

```
body {
  margin: 0;
}
.container {
  min-height: 100vh;
  padding: 50px;
  box-sizing: border-box;
  background: silver;
}
```

```
<div class="container">Hello world.</div>
```

**2\. 全高与`margin`**

```
body {
  margin: 0;
}
.container {
  min-height: calc(100vh - 100px);
  margin: 50px;
  background: silver;
}
```

```
<div class="container">Hello world.</div>
```

**3\. 全高与`border`**

```
body {
  margin: 0;
}
.container {
  min-height: 100vh;
  border: 50px solid pink;
  box-sizing: border-box;
  background: silver;
}
```

```
<div class="container">Hello world.</div>
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-27T23:33:16.663

这是 CSS 的彻头彻尾的白痴之一——我还没有理解其中的原因（如果有人知道，请解释一下）。

100% 表示容器高度的 100% - 添加任何边距、边框和填充。因此，实际上不可能获得一个填充其父级并具有边距、边框或填充的容器。

另请注意，浏览器之间的设置高度也是出了名的不一致。

* * *

自从我发布这篇文章以来，我学到的另一件事是，百分比是相对于容器的*长度*，即宽度，使得百分比对于高度变得毫无价值。

如今，vh 和 vw 视口单元更有用，但对于除了顶级容器之外的任何东西都不是特别有用。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-11-30T14:35:08.840

另一种解决方案是使用具有不同盒子模型行为的 display:table。

您可以为父级设置高度和宽度并添加填充而不扩展它。孩子有 100% 的高度和宽度减去填充。

[**JSBIN**](http://jsbin.com/usudef/1/)

另一种选择是使用 box-sizing 属性。两者的唯一问题是它们不能在 IE7 中工作。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-10-29T19:12:38.960

另一种解决方案：您可以使用百分比单位来表示边距和大小。例如：

```
.fullWidthPlusMargin {
    width: 98%;
    margin: 1%;
} 
```

这里的主要问题是边距会随着父元素的大小而略微增加/减少。大概您更喜欢的功能是让边距保持不变，让子元素增长/缩小以填充间距的变化。因此，根据您需要显示器的紧密程度，这可能会出现问题。（我也会选择较小的利润率，比如 0.3%）。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-06-28T12:36:56.287

使用[flexbox](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)的解决方案（在 IE11 上工作）：（[或在 jsfiddle 上查看](https://jsfiddle.net/hLkj56fg/8/)）

```
<html>
  <style>
    html, body {
      height: 100%; /* fix for IE11, not needed for chrome/ff */
      margin: 0; /* CSS-reset for chrome */
    }
  </style>
  <body style="display: flex;">
    <div style="background-color: black; flex: 1; margin: 25px;"></div>
  </body>
</html> 
```

（[CSS 重置](https://css-tricks.com/reboot-resets-reasoning/)对于实际问题不一定重要。）

重要的部分是`flex: 1`（与`display: flex`父级结合）。有趣的是，我所知道的关于 Flex 属性如何工作的最合理的解释来自 react-native 文档，[所以我还是参考了它](https://facebook.github.io/react-native/docs/height-and-width.html#flex-dimensions)：

> (...) flex: 1，它告诉组件填充所有可用空间，在具有相同父级的其他组件之间平均共享

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-05-14T09:52:59.487

添加 -webkit 和 -moz 会更合适

```
-webkit-box-sizing: border-box;
-moz-box-sizing: border-box;
box-sizing: border-box; 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-02-08T07:37:49.440

弗兰克的例子让我有点困惑——它在我的情况下不起作用，因为我对定位还不够了解。需要注意的是，父容器元素需要有一个非静态的位置（他提到了这一点，但我忽略了它，他的例子中没有）。

这是一个示例，其中子级 - 给定填充和边框 - 使用绝对定位来填充父级 100%。父级使用相对定位来为子级的位置提供参考点，同时保持正常流程 - 下一个元素“more-content”不受影响：

```
#box {
    position: relative;
    height: 300px;
    width: 600px;
}

#box p {
    position: absolute;
    border-style: dashed;
    padding: 1em;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
} 
```

```
<div id="box">
  <p>100% height and width!</p>
</div>
<div id="more-content">
</div> 
```

快速学习 CSS 定位的有用[链接](http://www.barelyfitz.com/screencast/html-training/css/positioning/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-12-18T03:19:13.650

### div 周围的边框，而不是页面正文边距

另一种解决方案 - 我只想要一个简单的页面边缘边框，当内容小于该值时，我想要 100% 的高度。

Border-box 不起作用，对于如此简单的需求，固定定位似乎是错误的。

我最终为我的容器添加了一个边框，而不是依赖于页面主体的边距 - 它看起来像这样：

```
body, html {
    height: 100%;
    margin: 0;
}

.container {
    width: 100%;
    min-height: 100%;
    border: 8px solid #564333;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-02-26T16:02:52.060

`display: block`这是您可以在 2020 年修复它的最快方法的默认行为，即设置`display: 'flex'`父元素和填充，例如 20px，然后其所有子元素的高度将相对于其高度为 100%。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2012-01-20T13:10:13.003

```
 <style type="text/css">
.stretchedToMargin {
    position:absolute;
    width:100%;
    height:100%;

}
</style> 
```

# sql-server - CLR UDT 是否常用于企业应用程序？

> ID：485829
> 
> 赞同：1
> 
> 时间：2009-01-27T23:28:40.650
> 
> 标签：sql-server, sqlclr, user-defined-types

我正在研究 SQL Server 2005/2008 中可用的一些较新的技术。我的大多数应用程序都是用 C# 编写的，并且通常具有数据库组件。我在 Google 上找到的大部分内容都是基本的，“这就是您设置 CLR UDT 的方式”。我对它们的实际应用和使用有一些一般性的问题。

*   CLR 托管的 UDT 是否常用于应用程序？大或小规模
*   使用它们是否存在性能问题？
*   DBA 通常只喜欢使用内置类型吗？

它们似乎是一种将物体塞进桌子的方法。我是否正确假设由于使用而简化解决方案的实际问题范围很小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T23:49:00.547

我调查了使用它们，但对版本控制感到不安。如果您将更新版本的程序集上传到服务器会发生什么情况？由于依赖关系，您必须删除 UDT 并重新创建它，但是数据会怎样呢？我们坚持使用内置类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T01:27:45.153

只有当 UDT 真正代表您的应用程序的某些基本项目时，它们才有好处。几乎总是可以将它们分解为内置类型，但好处是您不必强制转换返回的对象。因此，您可能不应该使用表示复杂对象（例如 Employee）的 UDT，但是像 Size 或 Location 这样的基本对象可能是一个不错的选择，因为它很轻但在定义上非常严格。

# c# - ASP.NET MVC RC1 - 区域的自定义视图引擎 - FindView 覆盖未触发

> ID：485840
> 
> 赞同：1
> 
> 时间：2009-01-27T23:33:11.423
> 
> 标签：c#, asp.net-mvc

我在 ASP.NET MVC 中有一个自定义视图引擎，并且自从升级到 RC1 后，我的自定义视图引擎实现[了 Phil Haack 在这篇文章中的区域，](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)没有进入覆盖方法 FindView，因此破坏了作为应用程序位于区域内的任何控制器无法找到它们。我知道有很多人在他们的 MVC 应用程序中使用区域，有没有人知道这个问题的解决方案或为什么会发生？

下面是我的findview方法供参考。

```
 public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName)
    {
        ViewEngineResult areaResult = null;

        if (controllerContext.RouteData.Values.ContainsKey("area"))
        {
            string areaViewName = FormatViewName(controllerContext, viewName);
            areaResult = base.FindView(controllerContext, areaViewName, masterName);
            if (areaResult != null && areaResult.View != null)
            {
                return areaResult;
            }
            string sharedAreaViewName = FormatSharedViewName(controllerContext, viewName);
            areaResult = base.FindView(controllerContext, sharedAreaViewName, masterName);
            if (areaResult != null && areaResult.View != null)
            {
                return areaResult;
            }
        }

        return base.FindView(controllerContext, viewName, masterName);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T23:53:16.547

他们在 FindView 方法中添加了一个参数。您现在可以指定在 FindView 和 FindPartialView 上使用缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T06:40:50.430

顺便说一句，Phil 更新了他的帖子以使用 RC1。[在这里检查](http://haacked.com/Tags/areas/default.aspx)

# phptal - PHPTAL：优雅地处理未定义的变量

> ID：485848
> 
> 赞同：2
> 
> 时间：2009-01-27T23:36:08.170
> 
> 标签：phptal, template-tal

如果我使用尚未放入范围的变量，PHPTAL 会引发异常。有没有办法让 PHPTAL 回到优雅的默认值，例如在布尔上下文中评估为 false，在字符串上下文中评估为空白等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T00:03:23.423

您可以将“ `| nothing`”添加到 TALES 表达式或使用`isset()`in`php:`表达式。

```
<p tal:attributes="class php:isset(class)?class:NULL" 
   tal:content="variable | nothing" /> 
```

如果您有大量代码依赖于某个变量，请使用`exists:`修饰符：

```
<div tal:condition="exists:variable">
…
</div> 
```

如果你想伪造任何变量的存在，它可以做到，但我不推荐它（它会隐藏错别字）：

```
class FakeAll extends stdClass
{
    function __get($var){return "";}
    function __isset($var){return true;}
}

$p = new PHPTAL();
$p->getContext()->setGlobal(new FakeAll()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T14:03:31.937

还有更短的版本：

```
<input type="text" name="id" value="${data/formvalues/id|nothing}" /> 
```

# asp.net - 到本地数据库文件的连接字符串不起作用

> ID：485849
> 
> 赞同：4
> 
> 时间：2009-01-27T23:36:20.870
> 
> 标签：asp.net, sql-server, database, connection-string, aspnetdb

```
connectionString="AttachDbFilename=C:\Documents and Settings\nmartin\My Documents\PS_Upload\TimeTrack\src\TimeTracker\TimeTrack\App_Data\ASPNETDB.MDF;Integrated Security=True; User Instance=True"
     providerName="System.Data.SqlClient" /> 
```

这是从服务器资源管理器为我的本地 MDF 文件提供给我的连接字符串。尝试运行应用程序时，我不断收到以下错误。

```
"Format of the initialization string does not conform to specification starting at index 25." 
```

有谁知道这是什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T15:32:09.130

非常感谢大家。我的问题实际上与我提供 NHibernate 配置的连接字符串有关。看来本地数据文件路径不应包含在 's 或 "s 中。感谢您的回复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T23:41:31.857

我会说这是文件名中的空格。尝试将其括在 '' 例如

```
connectionString="AttachDbFilename='C:\Documents and Settings\nmartin\My Documents\PS_Upload\TimeTrack\src\TimeTracker\TimeTrack\App_Data\ASPNETDB.MDF';Integrated Security=True; User Instance=True" 
```

或将其复制到 c:\ 进行测试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T00:09:35.857

尝试替换：Integrated Security=True

与：Trusted_Connection=Yes

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T23:41:44.900

您是否尝试过在反斜杠上使用转义字符？

```
connectionString="AttachDbFilename=C:\Documents and Settings\nmartin\My Documents\PS_Upload\TimeTrack\src\TimeTracker\TimeTrack\App_Data\ASPNETDB.MDF;Integrated Security=True; User Instance=True"
 providerName="System.Data.SqlClient" /> 
```

变成

```
connectionString="AttachDbFilename=C:\\Documents and Settings\\nmartin\\My Documents\\PS_Upload\\TimeTrack\\src\\TimeTracker\\TimeTrack\\App_Data\\ASPNETDB.MDF;Integrated Security=True; User Instance=True"
 providerName="System.Data.SqlClient" /> 
```

# java - 你如何处理 Java 中的套接字断开连接？

> ID：485855
> 
> 赞同：13
> 
> 时间：2009-01-27T23:38:52.907
> 
> 标签：java, sockets

大家好。我有一个使用 ServerSocket 和 Socket 类用 java 编写的服务器。

我希望能够检测和处理断开连接，然后在必要时重新连接新客户端。

检测客户端断开连接、关闭套接字然后接受新客户端的正确程序是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-27T23:44:17.280

据推测，您正在从套接字读取，可能使用输入流上的包装器，例如 BufferedReader。在这种情况下，当相应的读取操作返回 -1（对于原始 read() 调用）或 null（对于 readLine() 调用）时，您可以检测到流结束。

某些操作在关闭的套接字上执行时会导致 SocketException，您还需要适当地处理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T06:47:35.150

检测另一端已经消失的唯一安全方法是定期发送心跳，并根据缺少心跳让另一端超时。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-08-09T13:18:15.253

只是我，还是没有人注意到 JavaDoc 在[ServerSocket api](https://docs.oracle.com/javase/7/docs/api/java/net/ServerSocket.html#isClosed())下声明了一个方法，它允许我们根据 serversocket 的关闭状态获取布尔值？

您可以每隔几秒钟循环一次以检查它的状态：

```
if(!serverSocket.isClosed()){
  // whatever you want to do if the serverSocket is connected
}else{
  // treat a disconnected serverSocket
} 
```

编辑：再次阅读您的问题，您似乎需要服务器不断搜索连接，如果客户端断开连接，它应该能够重新检测客户端何时尝试重新连接。这不应该只是你的解决方案吗？

有一个正在监听的服务器，一旦它获得一个客户端连接，它应该将它传递给一个工作线程对象并启动它以异步操作。然后服务器可以循环回监听新的连接。如果客户端断开连接，启动的线程应该终止，当它重新连接时，会再次启动一个新线程来处理新连接。

[Jenkov](http://tutorials.jenkov.com/java-multithreaded-servers/multithreaded-server.html)提供了这个实现的一个很好的例子。

# data-structures - C++：形成不同数据类型的集合的合适解决方案是什么？

> ID：485862
> 
> 赞同：0
> 
> 时间：2009-01-27T23:42:53.617
> 
> 标签：data-structures, c++-cli

我正在编写一个命令行解释器，并且正在尝试为各个命令设置格式。我有诸如命令名称、最大参数数量和最小参数数量之类的东西。我想要一个集合，一个参数类型的原型。我的第一个想法只是声明一个没有泛型的向量，但后来我意识到这不是 Java。

假设我有一个命令，例如“read test.dat 2”，我想要一个结构，显示典型的读取命令有一个字符串，然后是一个整数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T23:47:50.487

我不太清楚你在问什么，所以我可能弄错了。

根据您的描述，听起来好像您有一个抽象的命令概念，并且它们具有名称和参数方面的预期结构。根据您的描述，听起来您需要一个类型标识符列表以及它们是否是可选的指示。

然后，您可以为您希望使用的每个命令实例化一个命令对象，并将它们全部添加到命令集合中。

或者，使用映射集合将命令名称映射到实际的命令对象。每个命令对象还可以保存对处理程序对象的引用以实际执行命令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T23:51:28.500

### 异构容器

如果您想要一个可以存储一组固定类型的容器，您可以使用以下之一`boost::variant`：

```
typedef boost::variant<std::string, int> optval;
typedef std::vector<optval> options; 
```

现在，您可以将字符串或整数 push_back 放入向量中，并且变体将记录它包含的内容：

```
options opts;
opts.push_back(10);
opts.push_back("hello"); 
```

[您可以在Boost variant](http://www.boost.org/doc/libs/1_37_0/doc/html/variant.html)的文档中了解它，包括如何从变体中获取正确的值。如果您已经设置了命令行解析，并且不再需要用于此的库，您当然也可以拥有从参数名称到此类变体的映射：

```
std::map<std::string, optval> map;
map["--max-foo"] = 10;
map["--title"] = "something fun"; 
```

### 命令行解析

如果你想解析程序的命令行参数，你可以查看[Boost.Program Options](http://www.boost.org/doc/libs/1_37_0/doc/html/program_options.html)库，它将极大地帮助你做到这一点。

然而，大多数情况下，我最终使用 posix`getopt`函数，它也可以解析命令行。我建议您先查看 boost 程序选项，如果您觉得它太重，您可以查看 getopt（请参阅 参考资料`man 3 getopt`）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T23:54:09.133

像这样的东西，也许：

```
enum ParameterType
{
  Int,
  String
};

struct Command
{
  string name;
  vector<ParameterType> maxParameters;
  int minParameters;
}; 
```

# flash - 使用来自父 swf 的 flashvar 加载子 swf

> ID：485865
> 
> 赞同：0
> 
> 时间：2009-01-27T23:43:33.523
> 
> 标签：flash, flashvars

我必须从我的 swf 加载另一个 swf，我需要给他们 flashvars 属性，我该怎么做？

我试过这个，但它不工作：

```
loader.load(new URLRequest(url+"id=33")); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T00:03:05.060

你不是少了一个问号吗？

`loader.load(new URLRequest(url+"?id=33"));`

# .net - ASP.NET 网页的密码保护？

> ID：485866
> 
> 赞同：1
> 
> 时间：2009-01-27T23:43:47.190
> 
> 标签：.net, asp.net, passwords, access-control

我正在尝试为网站实现最简单的共享“文件”文件夹，但希望具有“合理”级别的访问控制——即通过 hoi-polloi 不会随意上传多兆字节。

用户获得密码等。然后他们登录，一旦成功检查凭据，他们就会获得两种可能的访问权限之一 - 对文件的只读 (RO) 或读写 (RW) 访问。在这种情况下，“写”意味着他们可以上传文件。

用户管理/注册/密码提醒都可以手动处理——此时不需要代码。

做这个的最好方式是什么：

1.  在会话变量中写一个秘密？
2.  将某种限时会话密钥存储为本地 cookie？
3.  检查本地数据库以获取某种会话密钥？
4.  （走向太复杂）使用 pukka .NET 身份验证机制

欢迎任何建设性的建议。如果有人能指出基于 C#/ASP.NET 的品种的一个很好的例子，我会特别高兴。

非常感谢

杰瑞。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-28T01:08:55.083

当 asp.net 中内置了身份验证机制时，我认为没有理由重新发明轮子。最容易实现的是 asp.net 表单身份验证。

这是一篇关于它的文章： [http ://www.15seconds.com/Issue/020220.htm](http://www.15seconds.com/Issue/020220.htm)

您可以在 web.config 中映射目录的权限，甚至可以在此处存储用户和密码，如果您选择使用该路径。这将是最容易快速起步的方法，尽管不是那么灵活或面向未来。

然后你就拥有了 asp.net 会员资格。这是一个 asp.net 2.0 功能，它使用提供者模型来提供会员功能。有一个 SqlMembershipProvider，它提供了在 sql server 数据库中存储成员信息所需的所有管道（还有自动创建表、存储过程等的脚本）。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/ms998347.aspx](http://msdn.microsoft.com/en-us/library/ms998347.aspx) [http://aspnet.4guysfromrolla.com/articles/102208-1.aspx](http://aspnet.4guysfromrolla.com/articles/102208-1.aspx)

这有点复杂，但也更加健壮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:25:34.887

最简单的例子：

[http://www.asp101.com/samples/login_aspx.asp](http://www.asp101.com/samples/login_aspx.asp)

# windows - Windows - 未知文件类型和 Windows Web“查找”

> ID：485877
> 
> 赞同：3
> 
> 时间：2009-01-27T23:46:52.423
> 
> 标签：windows, web-services, file-extension

在 MS Windows 上，当您双击具有未知文件扩展名的文件时，操作系统会显示一条消息，让您选择：

**1 - 使用 Web 服务找到合适的程序**

**2 - 从列表中选择程序**

有没有办法向 MS（或任何人）“注册”您的文件扩展名，以便在选择“使用 Web 服务查找适当的程序”时显示您的应用程序？

# ruby-on-rails - 在 Ruby On Rails 上学习 BDD 的路径是什么？

> ID：485893
> 
> 赞同：19
> 
> 时间：2009-01-27T23:54:14.220
> 
> 标签：ruby-on-rails, ruby, rspec, cucumber, bdd

我想在 Ruby On Rails 上开始 BDD 我应该学习什么？我对 BDD、RSpec 或 Cucumber 一无所知。最好的学习方法是什么？教程？涵盖诸如“我应该测试什么行为？”之类的东西。等等

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-28T01:37:26.053

RSpec 特定的；我保留这些链接以供参考（对于初学者来说可能是提前的）。但只是想和你分享。（其中一些可能已经过时，但我认为仍然值得一读）

[Rspec Link Fest - 指向其他参考的链接](http://www.decodeuri.com/2008/10/02/rspec-link-fest/)

控制器中的 RSpec： [使用 rSpec 测试您的应用程序控制器](http://www.movesonrails.com/articles/2008/01/23/spec-ing-your-application-controller)

[使用 rspec 测试控制器](http://www.elevatedrails.com/articles/2007/09/10/testing-controllers-with-rspec/)

[在控制器上使用 Rspec](http://www.vaporbase.com/postings/Using_Rspec_on_Controllers)

模型中的 RSpec： [Dave Chelimsky 的 stub_model](http://www.nabble.com/stub_model-ts16120964.html)

[我们真的需要控制器和视图测试吗？- 一些讨论](http://www.railway.at/articles/2008/05/14/do-we-really-need-controller-and-view-tests)

视图中的 RSpec：

[转义 HTML 的 RSpec 测试视图](http://blog.wolfman.com/articles/2007/07/06/rspec-testing-views-for-escaped-html)

Rspec 故事（现为 Cucumber）：

[了解 RSpec 故事 - 教程](http://blog.emson.co.uk/2008/06/understanding-rspec-stories-a-tutorial/)

Windows 上的 Rspec：

[Windows 上的 RSpec、自动测试和 Snarl - 不知道这是否仍然相关](http://thewebfellas.com/blog/2007/12/10/rspec-autotest-and-snarl-on-windows)

p/s：有些是 2007 年的，我不确定这些东西是否过时，但这些是我用来学习 RSpec 的一些参考资料。希望能帮助到你

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T00:15:12.693

从 Dan North 的两篇文章开始：[BDD 简介](http://dannorth.net/introducing-bdd)，紧随其后[的是什么是故事？](http://dannorth.net/whats-in-a-story)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-28T00:12:00.593

从顶部开始，RSpec 主页：

[http://rspec.info/](http://rspec.info/)

# .net - IEnumerable 上的动态 LINQ？

> ID：485895
> 
> 赞同：16
> 
> 时间：2009-01-27T23:56:08.740
> 
> 标签：.net, linq, ienumerable

假设我需要使用动态查询过滤通用列表（`List<string> l; var x = l.Where(*dynamic query*)`）

我将如何使用 LINQ 执行此操作？（目前在数据视图上使用行过滤器）

我看过[scott g 的帖子](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)：但它似乎不适用于使用的对象`IEnumerable`（包括通用列表）

任何人都可以提供任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-28T08:24:29.807

假设您的意思是基于字符串的查询：动态 LINQ 库可以正常工作；只需`.AsQueryable()`先打电话：

```
string s = *dynamic query*
var qry = l.AsQueryable().Where(s); 
```

这为您的`IQueryable<T>`列表提供了一个包装器，它提供对动态 LINQ 扩展方法的访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T00:11:05.153

您可以使用采用谓词的 FindAll() 方法。这是一个基本的例子。

```
List<string> stringList = new List<string>(new string[]{"Smith", "Johnson", "Jordan","Doe"});

List<string> filteredStringList = stringList.FindAll(x => x == "Smith"); 
```

Find 方法也返回单个项目。

MSDN 上还有一个示例项目，用于在 IEnumerable 和 IQueryable 上执行动态 LINQ 查询。您可以从中重用 DynamicQueryable 类。这是[链接](http://code.msdn.microsoft.com/Release/ProjectReleases.aspx?ProjectName=csharpsamples&ReleaseId=8)。该项目位于 C# 示例项目中。

# scala - 如何在 Scala 中编写毕达哥拉斯定理？

> ID：485896
> 
> 赞同：24
> 
> 时间：2009-01-27T23:57:24.290
> 
> 标签：scala

> 直角三角形斜边的平方等于其他两条边的平方和。

这就是毕达哥拉斯定理。根据边的长度“a”和“b”计算斜边的函数将返回 sqrt(a * a + b * b)。

问题是，**您将如何在 Scala 中定义这样的函数，使其可以与任何实现适当方法的类型一起使用？**

对于上下文，想象一下您想要与 Int、Double、Int-Rational、Double-Rational、BigInt 或 BigInt-Rational 类型一起使用的整个数学定理库，具体取决于您在做什么，以及速度、精度、准确性和范围要求.

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-09-06T05:32:22.943

这仅适用于 Scala 2.8，但确实有效：

```
scala> def pythagoras[T](a: T, b: T, sqrt: T => T)(implicit n: Numeric[T]) = {
     | import n.mkNumericOps
     | sqrt(a*a + b*b)
     | }
pythagoras: [T](a: T,b: T,sqrt: (T) => T)(implicit n: Numeric[T])T

scala> def intSqrt(n: Int) = Math.sqrt(n).toInt
intSqrt: (n: Int)Int

scala> pythagoras(3,4, intSqrt)
res0: Int = 5 
```

更一般地说，特征`Numeric`是如何解决此类问题的有效参考。另请参阅`Ordering`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-28T05:29:38.003

最明显的方式：

```
type Num = {
  def +(a: Num): Num
  def *(a: Num): Num
}

def pyth[A <: Num](a: A, b: A)(sqrt: A=>A) = sqrt(a * a + b * b)

// usage
pyth(3, 4)(Math.sqrt) 
```

这很可怕，原因有很多。首先，我们遇到了递归类型的问题`Num`。仅当您使用设置为某个整数值的选项编译此代码时才允许这样做`-Xrecursive`（对于数字来说，5 可能绰绰有余）。其次，类型`Num`是结构化的，这意味着它定义的成员的任何使用都将编译为相应的反射调用。说得委婉一点，这个版本的`pyth`效率非常低，运行速度比传统实现慢几十万倍*。*`pyth`但是，如果您想为*任何*定义并且存在函数的类型定义`+`，则无法绕过结构类型。`*``sqrt`

最后，我们来到了最基本的问题：它过于复杂。为什么要以这种方式实现该功能？实际上，它需要应用的唯一类型是真实的 Scala 数字。因此，最简单的方法是执行以下操作：

```
def pyth(a: Double, b: Double) = Math.sqrt(a * a + b * b) 
```

所有问题都解决了！由于隐式转换的奇迹，此函数可用于类型`Double`, `Int`,`Float`甚至奇数的值。`Short`虽然这个函数在技术上确实不如我们的结构类型版本灵活，但它的效率要高*得多*，而且可读性要强得多。`+`我们可能已经失去了为定义和的不可预见类型计算勾股定理的能力`*`，但我认为你不会错过这种能力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-05T16:48:17.587

关于丹尼尔的回答的一些想法：

我已经[尝试](http://github.com/scalaz/scalaz/blob/master/core/src/main/scala/scalaz/math/FAD.scala)泛化`Numeric`到`Real`，这会更适合这个函数来提供`sqrt`函数。这将导致：

```
def pythagoras[T](a: T, b: T)(implicit n: Real[T]) = {
   import n.mkNumericOps
   (a*a + b*b).sqrt
} 
```

在这样的通用函数中使用文字数字很棘手，但可能。

```
def pythagoras[T](a: T, b: T)(sqrt: (T => T))(implicit n: Numeric[T]) = {
   import n.mkNumericOps
   implicit val fromInt = n.fromInt _

   //1 * sqrt(a*a + b*b)   Not Possible!
   sqrt(a*a + b*b) * 1    // Possible
} 
```

`sqrt`如果在第二个参数列表中传递 ，则类型推断效果更好。

参数`a`和`b`将作为对象传递，但@specialized 可以解决这个问题。不幸的是，数学运算仍然会有一些开销。

您**几乎**可以不导入 mkNumericOps。我[沮丧地接近了！](http://gist.github.com/296654)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-05T14:25:43.037

java.lang.Math中有一个方法：

```
public static double hypot (double x, double y) 
```

javadocs为此断言：

> 返回 sqrt(x2 +y2) 没有中间溢出或下溢。

查看 src.zip，Math.hypot 使用 StrictMath，这是一种原生方法：

```
public static native double hypot(double x, double y); 
```

# visual-studio - 启动新项目时的最佳实践

> ID：485906
> 
> 赞同：4
> 
> 时间：2009-01-28T00:03:39.410
> 
> 标签：visual-studio

当您第一次启动 Visual Studio 时，甚至在此之前（希望如此）您在启动新项目时认为最佳实践是什么？

我过去做过的不同的事情

*   考虑技术选择
*   尝试识别潜在的瓶颈/砖墙
*   扔掉规范
*   问很多很多问题
*   直接启动到代码中！（谁没有？）

作为程序员，我们的方法应该有条不紊。
当你开始一个新项目时，你会做什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T00:11:52.607

**立即开始使用版本控制。**

构建最终被丢弃的原型“一次性代码”总是令人沮丧 - 然后意识到其中一些代码真的非常有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T00:06:16.753

（如果适用）弄清楚您是在构建一次性原型、可扩展原型还是最终生产系统。

我认为很多项目的一个主要问题是人们一开始就没有弄清楚这个问题。他们要么过度设计并且项目不能按时交付，要么他们编写的一次性代码后来变得过于昂贵而无法丢弃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T00:08:24.720

在为他人构建时，我会执行以下操作。当我使用更敏捷的开发概念构建自己时，我仍然会循环执行这些步骤。这也让其他人的参与变得非常容易。

**分析：**我们需要做什么以及为什么。又名功能规范。

**设计：**我们要构建什么，它将如何工作，为什么？又名。技术规格

**计划：**我们需要什么和谁，何时，做什么

**实施：**构建、测试、重复。

**发射：**快到了。

**支持/文件/火车等：**如果您被公共汽车撞到，或有人安排。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T00:13:34.600

[Scrum](http://en.wikipedia.org/wiki/Scrum_(development))

++

1.  需求收集
2.  范围
3.  超出范围
4.  选择平台交付和适当的开发环境
5.  计算费用，制定预算
6.  日程
7.  在每个阶段进行审查并让最终用户了解整个过程中所做的事情

[简单的提示](http://www.projectkickstart.com/downloads/tips10-project-management-best-practices.cfm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T00:05:14.353

创建我的第一个测试项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T00:06:48.827

我一直想知道的一件主要事情是，到底是谁在做什么！即使从起点。停止浪费很多时间。

# sql - SQL 2005 链接服务器查询定期失败

> ID：485908
> 
> 赞同：4
> 
> 时间：2009-01-28T00:04:38.487
> 
> 标签：sql, sql-server-2005, active-directory, linked-server

我们有一个在 SQL 2005 上运行的数据库。其中一个存储过程使用链接服务器从 Active Directory 中查找用户的电子邮件地址。对链接服务器的调用发生在数据库函数中。

我第一次可以从我的 Asp.Net 应用程序成功调用，但之后会定期失败，并出现以下错误：

{"无法执行请求的操作，因为链接服务器 \"ADSI\" 的 OLE DB 提供程序 \"ADsDSOObject\" 不支持所需的事务接口。"}

似乎调用函数之间的时间量会影响链接服务器查询是否正常工作。我没有使用任何交易。当我尝试在快速临时 SQL 脚本中调用该函数时，它每次都运行良好（即使在快速连续测试时也是如此）。

如果我不再尝试再次调用该过程，是否有某种交易处于打开状态而自然死亡？我在这里不知所措。

这是存储过程中的简单调用：

```
DECLARE @email varchar(50)

SELECT @email = LEFT(mail, 50)
FROM OPENQUERY (
    ADSI,
    'SELECT mail, sAMAccountName FROM ''LDAP://DC=Katz,DC=COM'' WHERE objectCategory = ''Person'' AND objectClass = ''User'''
)
WHERE sAMAccountName = CAST(@LoginName AS varchar(35))

RETURN @email 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T01:52:24.463

我经常使用 SQL Server 链接服务器，虽然很少使用 LDAP 查询……但我很好奇并阅读了 Ric Tokyo 上一篇文章中链接到的 Microsoft 支持页面。底部写着：

> 目录服务器通常会对给定查询返回的对象数量实施服务器限制。这是为了防止拒绝服务攻击和网络过载。要正确查询目录服务器，应该将大型查询分解为许多较小的查询。一种方法是通过称为分页的过程。虽然可以通过 ADSI 的 OLEDB 提供程序进行分页，但目前无法从 SQL 分布式查询中执行它。这意味着可以为查询返回的对象总数是服务器限制。在 Windows 2000 Active Directory 中，默认服务器限制为 1,000 个对象。

我认为它失败的原因（或不）取决于是从应用程序还是从“快速临时 sql 脚本”（如您所说）调用它，这可能与安全上下文有关操作正在执行。根据链接服务器连接的设置方式，可能会在各种可能的凭据下执行操作，具体取决于您启动查询的方式。

我不知道，但这是我最好的猜测。我会查看链接服务器配置，特别是链接服务器设置，哪些凭据集用作跨链接服务器执行的操作运行的安全上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T00:57:35.823

与其通过链接服务器查询 Active Directory，不如将 AD 数据缓存到 SQL 数据库中，然后进行查询。您可以通过使用“用于 Microsoft 目录服务的 OLE DB PROvider”创建 OLE DB 连接并使用带有如下查询的 DataReader 源来使用集成服务：

```
 SELECT physicalDeliveryOfficeName, department, company, title, displayName, SN, 
    givenName, sAMAccountName, manager, mail, telephoneNumber, mobile  
    FROM 'LDAP://DC=SOMECO,DC=COM' 
    WHERE objectClass='User'  and objectCategory = 'Person' 
    order by mail 
```

使用这种方法，您仍然会遇到 AD 查询结果的 1000 行限制（请注意，不建议尝试在 AD 中增加此限制，它是为了防止域控制器过载）。有时可以使用查询组合来返回完整的数据集，例如名称 A - L 和 M - Z

或者，您可以使用 Windows Server 中的 CSVDE 命令行实用程序将目录信息导出到 CSV 文件，然后将其导入 SQL 数据库（有关更多信息，请参见[http://computerperformance.co.uk/Logon/Logon_CSVDE_Export.htm](http://computerperformance.co.uk/Logon/Logon_CSVDE_Export.htm)使用 CSVDE 导出 AD 数据）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T02:27:00.163

I suspect that it might be the cached query plan due to your statement that "When I try calling the function in a quick make-shift SQL script, it runs fine everytime (even when tested in quick succession)."

Could you try executing your stored procedure like so:

```
EXEC usp_MyProcedure WITH RECOMPILE 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T00:46:47.467

请阅读[Microsoft 的支持页面](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q299410)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-03T12:08:13.927

当搜索错误字符串但没有有效答案时，此问题出现在第一个谷歌页面的顶部。

当 .NET 代码和存储过程中未指定隔离级别时，此错误会间歇性发生。

此错误也发生在 SQL Server 2008 中。

该修复是强制`SET TRANSACTION ISOLATION LEVEL READ (UN)COMMITTED`的，因为 Active Directory 不支持更高的隔离级别，并且 SQL Server 正在尝试使用`SERIALIZABLE`.

现在，因为这个错误是间歇性的。为什么 ADO.NET 或 SQLServer 有时将其默认隔离切换为`SERIALIZABLE`有时不切换？是什么触发了这种切换？

# air - Adobe AIR 中的主题

> ID：485917
> 
> 赞同：1
> 
> 时间：2009-01-28T00:06:21.667
> 
> 标签：air, flexbuilder

为 AIR 应用程序设置皮肤/主题的最佳方式是什么。例如，我想使用深色/黑色主题（类似于 Tour de Flex）而不是默认的灰色主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-07T13:24:38.190

ScaleNine 主题是一个很好的起点，找到一个有点像您想要的主题，将其插入您的应用程序，然后逐渐用您自己的颜色、图像和控件替换。

[http://www.scalenine.com/](http://www.scalenine.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T00:24:51.957

我也只是刚刚开始使用 AIR，但如果您使用 Flex，请查看[Flex in a Week 视频系列](http://www.adobe.com/devnet/flex/videotraining/)。有几个视频介绍了如何创建自定义 MXML 组件和项目渲染器，它们可以有效地让您的应用程序皮肤。

您还可以使用 CSS 来为您的应用设置样式。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-28T00:34:45.603

首先，您需要将 air 应用程序属性文件中的系统 chrome 属性设置为*none*。

```
<initialWindow>
...
<systemChrome>none</systemChrome>
...
</initialWindow> 
```

如果您的空中应用程序中的主文件名为*Main.mxml*，那么您的应用程序属性文件将命名为*Main-app.xml*。该文件不难找到，它应该与*Main.mxml*文件位于同一位置。

通过将此属性设置为 none，您表示您不希望您的 air 应用程序窗口采用运行该应用程序的 OS 窗口的样式。

由于此属性设置为 none，因此 air 应用程序的 chrome 必须来自您的 Main.mxml 文件，该文件应该是**WindowedApplication**

使用*WindowedApplication的***titleBarBackgroundSkin**属性来设置 air 应用的皮肤。**titleBarBackgroundSkin**默认为“mx.skins.halo.ApplicationTitleBarBackgroundSkin”

 ***# css-selectors - Mootools - 使用 .each 选择器定位子元素

> ID：485922
> 
> 赞同：0
> 
> 时间：2009-01-28T00:09:28.773
> 
> 标签：css-selectors, mootools, targeting

我正在尝试针对 LI 内的 UL，但遇到了麻烦。这是HTML：

```
<ul id="main_nav">
  <li class="main"><a href="#">Section 1</a>
    <ul id="dropdown">
      <li><a href="#">Item 1</a></li>
      <li><a href="#">Item 2</a></li>
      <li><a href="#">Item 2</a></li>
    </ul>
  </li>

  <li class="main"><a href="#">Section 2</a>
    <ul id="dropdown">
      <li><a href="#">Item 1</a></li>
      <li><a href="#">Item 2</a></li>
      <li><a href="#">Item 2</a></li>
    </ul>
  </li>

  <li class="main"><a href="#">Section 3</a></span>
   <ul id="dropdown">
      <li><a href="#">Item 1</a></li>
      <li><a href="#">Item 2</a></li>
      <li><a href="#">Item 2</a></li>
    </ul>
  </li> 
```

这是JS：

```
 window.addEvent('load', function() {
    $$('li.main').each(function(el){
    el.getChild('dropdown').addEvent('mouseenter',function(e){
        alert("over!");
    });
    el.getChild('dropdown').addEvent('mouseleave',function(e){
        alert("out!");
    });
});
} 
```

我认为问题在于当我尝试使用 el.getChild('dropdown') 获取 LI 的孩子时，但我不知道有任何其他方法可以做到这一点。我不是编码员，因此不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T00:18:32.687

可能导致问题的是您的重复 ID。一个`id`应该只在整个页面中使用**一次。**因此，超过 1 个`<ul id="dropdown">`是无效的 HTML，并且可能会给您带来不需要的库结果。

如果要保留重复项，请尝试`name`或`class`属性。

现在，我不确定它是否可能在版本之间发生了变化，但我只在文档中找到了**复数。** [`getChildren`](http://mootools.net/docs/Element/Element#Element:getChildren)

```
window.addEvent('load', function() {
    $$('li.main').each(function(el){
        el.getChildren('.dropdown').addEvent('mouseenter',function(e){
            alert("over!");
        });
        el.getChildren('.dropdown').addEvent('mouseleave',function(e){
            alert("out!");
        });
    });
}); 
```

但是，话又说回来，我对 Mootools 不是很熟悉。
正如你可能知道的那样。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T09:16:32.617

您可以使用 getFirst 方法而不是 getChild：

```
window.addEvent('load', function() {
    $$('li.main').each(function(el){
        el.getFirst().addEvent('mouseenter',function(e){
            alert("over!");
        });
        el.getFirst().addEvent('mouseleave',function(e){
            alert("out!");
        });
    });
}); 
```

# c# - 字节流单元测试

> ID：485927
> 
> 赞同：3
> 
> 时间：2009-01-28T00:12:02.107
> 
> 标签：c#, asp.net, unit-testing, reporting-services, interface

我正在使用 Reporting Services Web 服务来生成报告并允许用户下载它。这是通过 PDF、Excel、XML 等进行的，并且工作得很好。我试图在我的报告类和实现之间创建一些分离，但我正在努力解决如何在一个仍然可以测试的庄园中做到这一点。

由于我的自定义报告对象/类直接调用 Web 服务，我是否应该使用接口将其进一步分离？无论字节源如何，对此以及如何仍可进行单元测试的任何建议都将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T00:22:30.263

罗素，我认为你的答案在于学习依赖注入/控制反转。你可以从这里开始...

*   [http://codebetter.com/blogs/jeremy.miller/archive/2005/10/06/132825.aspx](http://codebetter.com/blogs/jeremy.miller/archive/2005/10/06/132825.aspx)
*   [http://misko.hevery.com/2009/01/14/when-to-use-dependency-injection/](http://misko.hevery.com/2009/01/14/when-to-use-dependency-injection/)
*   [http://iridescence.no/post/Using-Uni​​t-Tests-to-Uncover-Design-Flaws.aspx](http://iridescence.no/post/Using-Unit-Tests-to-Uncover-Design-Flaws.aspx)
*   [http://en.wikipedia.org/wiki/Dependency_injection](http://en.wikipedia.org/wiki/Dependency_injection)
*   [http://martinfowler.com/articles/injection.html](http://martinfowler.com/articles/injection.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T04:45:43.100

如果您不熟悉依赖注入/控制反转，此链接是 Carl Franklin 和 James Kovacs 的精彩截屏视频。

[DNR 电视节目 #126：James Kovacs 的自滚 IoC 容器](http://www.dnrtv.com/default.aspx?showNum=126)

我很喜欢通过听别人清楚地解释并看着他们编写代码来学习新事物。James 解释了原理、执行代码以及如何使用框架来进一步学习。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T07:14:14.970

如前所述，依赖注入/控制反转是要走的路。编码到接口而不是具体类。然后，当您的单元测试运行时，它可以将 Web 服务实现与返回虚假、固定数据的模拟实现交换。

# vim - VimL 脚本语言：有其他语言的实现吗？

> ID：485933
> 
> 赞同：10
> 
> 时间：2009-01-28T00:14:45.177
> 
> 标签：vim, scripting, plugins, extensibility

**问题：**我最喜欢 Vim 的一个方面是它的灵活性。我最不喜欢的一种是 VimL 脚本语言本身。我知道每个人对语言和编辑都有自己的偏好，所以我想当然地认为不是每个人都同意我的观点。

**问题：** *如果*您是 Vim 用户，并且*您*对使用 VimL 扩展 vim 有类似的不满，那么您使用了哪些替代方案来扩展 Vim，同时避免使用默认语言？我正在寻找可能有助于超出我已经尝试过的想法的想法，包括但不限于：

*   使用对 python、ruby 和 perl 的附加支持重新编译 vim（很好，但是当我在没有添加支持的情况下在其他人的机器上运行 vim 时它没有帮助）
*   永远不要写一行 VimL 脚本，而只是下载预先存在的附加组件（很好，当且仅当现有的东西完全符合你的要求，如果你必须做出改变并最终不得不查看更多内容，那就不是很好了VimL 脚本）

**免责声明：**请注意，这*不是*对 VimL 脚本或任何人偏好的抨击。如果它对您有用，那就太好了！我只是在询问那些发现需要替代方案的人，以及满足他们需求的满足需求的方法。

**更新：**此问题已更新，要求提供对特定工具的具体参考。不需要讨论、辩论、投票或扩展讨论。如果存在*特定*工具，请随时参考。

*   参见例如， [https://github.com/luke-gru/riml](https://github.com/luke-gru/riml)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-11-15T19:26:27.440

我爱`vim`又恨`VimL`。所以我一直在尝试`emacs`使用该`evil`插件。这是一种类似`vim`的模式，但具有`emacs`插件和`emacs-lisp`脚本语言的所有优点。多半是胜利。（它不是 100% 像 vim ——例如，它不像 vim 中`$`的特殊行列——但足够接近。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T01:21:53.107

很可能适合您的开发生态系统。即一种您可能在 vim 之外使用的语言，因为它具有有用的支持库

我个人在这个 trac 插件中使用了 +python

[http://www.vim.org/scripts/script.php?script_id=2147](http://www.vim.org/scripts/script.php?script_id=2147)

在广泛使用和学习这个很棒的调试器脚本之后......

[http://www.vim.org/scripts/script.php?script_id=1929](http://www.vim.org/scripts/script.php?script_id=1929)

至于在其他机器上工作，通常你只是在没有小工作的情况下生活。但是如果需要，您可以随时将 netrw 用于 scp 等。

但实际上它是你想学习和可以使用的任何东西

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-11-15T22:27:11.673

如果我们无视你提到的那些，没有其他选择。

*   在 Vim 中你可以使用 VimL
*   如果你想用 Python/Perl/Ruby 编程，你可以为自己找到一个预制的二进制文件，或者构建 Vim 以包含对它的支持，然后像许多人一样使用其中一个
*   正如您所说，您可以下载插件，但越来越多的插件需要对上述之一的支持（通常在 *nix 盒子上找到，所以这真的不是什么大问题）
*   您可以使用上述任何一种，或 Vim 之外的其他 *nix 工具，但这与 Vim 不再有任何关系

*我认为这涵盖了它。*

# c - K&R练习：多维数组转指针数组

> ID：485940
> 
> 赞同：3
> 
> 时间：2009-01-28T00:17:06.293
> 
> 标签：c, multidimensional-array, kernighan-and-ritchie

`day_of_year`练习（5-9）：用指针而不是索引重写例程。

```
static char daytab[2][13] = {
    {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31},
    {0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31}
};

/* day_of_year: set day of year from month and day */
int day_of_year(int year, int month, int day)
{
    int i, leap;

    leap = (year%4 == 0) && (year%100 != 0) || (year%400 == 0);
    for (i = 1; i < month; i++)
    {
        day += daytab[leap][i];
    }

    return day;
} 
```

我可能只是累了，没有思考，但实际上如何创建一个带有指针的多维数组？

我可能会弄清楚该函数的其余部分，但我无法正确使用语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T00:20:44.697

有两种处理方法：

第一个是模仿 C 实际处理多维数组的方式，也就是说完全没有。char[4][4] 实际上只是 char[16] 周围的语法糖。您可以创建一个指向 16 字节数组的指针（在本例中），并且得到了相同的结果。

另一种是创建指向指针的指针。按照前面的例子：

```
char **foo = malloc(sizeof(char *) * 4);
for(int i = 0; i < 4; ++i)
    foo[i] = malloc(sizeof(char) * 4);
foo[0][0] = bar; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T01:57:24.907

The following complete program will do what you desire. I've converted your array into a char pointer (string) and interspersed the leap year values. I've also removed the dummy entries and adjusted the loop.

The test program lacks serious error checking so don't expect it to work with dodgy arguments.

```
#include <stdio.h>

static char *daytab =
    "\x1f\x1f\x1c\x1d\x1f\x1f"
    "\x1e\x1e\x1f\x1f\x1e\x1e"
    "\x1f\x1f\x1f\x1f\x1e\x1e"
    "\x1f\x1f\x1e\x1e\x1f\x1f";

/* day_of_year: set day of year from month and day */
int day_of_year(int year, int month, int day) {
    int i, leap;

    leap = (year%4 == 0) && (year%100 != 0) || (year%400 == 0);
    for (i = 0; i < month-1; i++) {
        day += *(daytab+i*2+leap);
    }

    return day;
}

int main (int argc, char *argv[]) {
    if (argc != 4) {
        printf ("Usage: blah yy mm dd\n");
        return 1;
    }
    printf ("%4.4s/%2.2s/%2.2s -> %04d/%02d/%02d -> %d\n",
        argv[1], argv[2], argv[3],
        atoi (argv[1]), atoi (argv[2]), atoi (argv[3]),
        day_of_year (atoi(argv[1]),atoi(argv[2]),atoi(argv[3])));
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T02:33:46.003

You're just asked to modify the `day_of_year` routine, not the `daytab` declaration. I would leave that array as-is, and modify `day_of_year` as follows:

```
/* day_of_year: set day of year from month and day */
int day_of_year(int year, int month, int day)
{
    char* p = (year%4 == 0) && (year%100 != 0) || (year%400 == 0) ? 
        daytab[0] : daytab[1];

    p++;
    for (i = 1; i < month; i++, p++)
    {
        day += *p;
    }

    return day;
} 
```

If you want to the declaration of `p` to be shorter, you can do this:

```
 char* p = daytab[(year%4 == 0) && (year%100 != 0) || (year%400 == 0)]; 
```

If you still want to remove that access, too:

```
 char* p = *(daytab + ((year%4 == 0) && (year%100 != 0) || (year%400 == 0))); 
```

One might argue that it looks ugly, but hey, that's what you get with pointers.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-05T14:28:51.940

Old thread, but I actually have a solution that doesn't use indexing, not even [0]. So instead of writing

```
day += daytab[leap][i]; 
```

write

```
day += *(*(daytab+leap)+i); 
```

# sql - SQL 存储过程使用参数作为服务器名称？

> ID：485962
> 
> 赞同：1
> 
> 时间：2009-01-28T00:26:50.363
> 
> 标签：sql, sql-server

我有一个从 SQL Server 获取所有非系统数据库名称的存储过程：

```
select name from MySQLServer.master.sys.databases
where name not like ('master')
and name not like ('tempdb')
and name not like ('msdb')
and name not like ('model')
and name not like ('Admin') 
```

我想做的是将服务器名称作为参数传递，所以这个存储过程更可重用：

```
@servername = 'some passed servername'

select name from @servername.master.sys.databases
where name not like ('master')
and name not like ('tempdb')
and name not like ('msdb')
and name not like ('model')
and name not like ('Admin') 
```

这可以做到吗？我该怎么做？

我可以创建一个变量，如：

```
DECLARE @serverPointer nvarchar(MAX)
SET @serverPointer = @servername + '.master.sys.databases'

select name from @serverPointer 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T01:36:29.800

如果您已将服务器链接到要查询的所有 SQL Server，这将起作用。至于要使用的查询，系统数据库占用前 4 个 database_id 值。因此，您可以运行以下命令来获取用户数据库：

```
SELECT '[' + name + ']' 
FROM sys.databases
WHERE database_id > 4 
```

综上所述，您基本上可以为您的 proc 执行以下操作：

```
CREATE PROC GetUserDBs
  @Server sysname
AS
BEGIN
  DECLARE @SQL nvarchar(2000);
  SET @SQL = 'SELECT ''['' + name + '']'' FROM [' + @Server + '].master.sys.databases WHERE database_id > 4';
  EXECUTE sp_executesql @SQL;
END
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T00:57:24.950

```
declare @servername nvarchar(max)
DECLARE @serverPointer nvarchar(MAX)
declare @qry nvarchar(max) 
@serverPointer = @servername + '.master.sys.databases' 
set @qry = 'select name from '+@serverPointer
exec sp_executesql @qry 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T00:51:24.837

为此，您需要在存储过程中创建一个动态查询并使用 exec 命令执行它，这里有几个示例：

[http://www.sqlteam.com/article/introduction-to-dynamic-sql-part-1](http://www.sqlteam.com/article/introduction-to-dynamic-sql-part-1)

[http://www.sqlteam.com/article/introduction-to-dynamic-sql-part-2](http://www.sqlteam.com/article/introduction-to-dynamic-sql-part-2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T01:00:25.067

```
Declare @query as varchar(1000)

set @query = ''
+ CHAR(10) + ' select name from '+ CAST(@servername AS VARCHAR(15))+'.master.sys.databases'
+ CHAR(10) +  'where name not in (''master'',''tempdb'',''msdb'',''model'',''Admin'')'

--print (@query)
exec (@query) 
```

# .net - 对启用 AJAX 的 ASP.NET MVC 网站进行单元测试

> ID：485966
> 
> 赞同：1
> 
> 时间：2009-01-28T00:28:29.000
> 
> 标签：.net, asp.net-mvc, ajax, unit-testing, asp.net-ajax

我刚刚开始我的第一个单元测试项目，并立即遇到了一些问题。向我指出的关于单元测试概念的一个很好的细节是，我不必为了测试我的应用程序而模拟 http-contexts 等。

但是，我在我的控制器中使用了 Request.IsMvcAjaxRequest() 检查，以便根据请求是否使用 AJAX 来确定返回给浏览器的内容。当我运行单元测试时，我收到一个 System.ArgumentNullException on Request ...

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T00:41:52.453

您将不得不模拟 ControllerContext。

请参阅[http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)

# wysiwyg - 在动态网站上使用 MarkDown？

> ID：485969
> 
> 赞同：3
> 
> 时间：2009-01-28T00:29:50.013
> 
> 标签：wysiwyg, markdown, rtf, richtext

是否存在任何在 Markdown 中本地工作的WYSIWYG**编辑器？***（任何平台/语言）* ...因此消费者不必查看背后的代码，只需在类似 MS-Word 的界面中工作。

一个**辅助**MarkDown 编辑器，您可以在其中查看和编辑 Markdown 源（就像我正在写这个问题的那个）也可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-28T00:32:33.783

有[Wysiwym Markdown Editor](http://wmd-editor.com/demo)（我们在这里使用的那个）。它显示了实时降价，而不是掩盖它。我认为 Markdown 的伟大之处在于几乎任何人都可以理解它的基础知识。

这是我所知道的唯一一个编辑器。在粗略浏览了谷歌之后，它似乎是少数几个之一，如果不是目前广泛使用的唯一一个的话。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T00:36:27.520

Markdown Wiki 上的大量[Markdown 实现列表。](http://markdown.infogami.com/)

*   Perl
*   PHP
*   Python
*   红宝石
*   C
*   C＃
*   爪哇
*   Javascript
*   通用 Lisp
*   卢阿
*   哈斯克尔

和：

*   博客软件
*   维基软件
*   文本编辑器
*   桌面软件
*   其他工具

# c# - 是否有 FillRectangle 的 WPF 版本

> ID：485972
> 
> 赞同：0
> 
> 时间：2009-01-28T00:31:40.353
> 
> 标签：c#, wpf

我想（通过鼠标拖动）在画布上绘制一些矩形。通常我会在 mousemove 上使用 Graphics 类和 FillRectangle。

有没有人有任何好的资源在 WPF 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-28T00:46:36.563

使用`Rectangle`类。并将 Fill 依赖属性设置为您想要的画笔。

这是 XAML 中的一个简单示例

```
<Rectangle Fill="Black" Height="100" Width="200" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T00:58:44.620

找到了答案，基本上最好把一个Rect和RectangleGeometry放到一个Path里面，把Path添加到画布上，然后在mousemove上改变Rect数据。

至少是这样的……

# .net - 是否有允许在正在运行的进程中检查 .NET 对象的工具？

> ID：485975
> 
> 赞同：6
> 
> 时间：2009-01-28T00:32:49.243
> 
> 标签：.net, reverse-engineering

我正在考虑一种在运行时检查对象的工具，主要用于逆向工程，我想知道这样的事情是否存在。

我的想法是你有两个视图，一个对象图和一个类列表。从类列表中，您可以选择一个类并在列表或图表中查看它的实例。在图中，您可以看到对象之间的连接，并进行了适当的注释，例如哈希表中的键可以是哈希表对象和值之间的边上的标签。

您还可以拉出对象属性列表并查看/操作其中的值。.NET 中提供的元数据将使这变得相当简单。

有谁知道可以做到这一点的工具？它似乎是一个非常有用的调试和逆向工程工具。

编辑：另外，另一个有用的功能是在查看二进制文件时设置名称映射的能力。也就是说，如果您有一个混淆的二进制文件，您可以将混淆的名称交换为占位符或真实姓名。这不会影响实际的二进制文件，只会影响检查器中的视图。

编辑第 2 部分：该工具应该能够在 Vista 和 XP 上运行并支持 x64。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T01:01:01.400

有一个名为 Crack.NET 的工具，专门用于分析托管堆。

[http://joshsmithonwpf.wordpress.com/cracknet/](http://joshsmithonwpf.wordpress.com/cracknet/)

[http://www.codeplex.com/cracknetproject](http://www.codeplex.com/cracknetproject)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T00:36:51.060

如果你有一个正在运行的进程，那么你的机器上的某个地方就有二进制文件。

您可以在 Reflector 中加载此二进制文件。

或者，如果您安装了 Visual Studio，则可以将 Visual Studio 调试器附加到正在运行的进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T00:37:36.627

有一个名为[Hawkeye](http://www.acorns.com.au/Projects/Hawkeye/)的程序可以让您查看 .NET 应用程序中的 UI 元素。

我还找到了一个名为[.NET Component Inspector](http://oaklandsoftware.com/product_compinsp1/product_1.html)的程序，我不确定它有多好（现在尝试一下）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T00:59:26.707

您总是可以从有问题的应用程序中获得一个小型转储，并使用 WinDBG 和 SOS 对其进行检查。

# c# - C# 如何确定我的代码的慢速部分在哪里？

> ID：485976
> 
> 赞同：19
> 
> 时间：2009-01-28T00:32:51.863
> 
> 标签：c#, profiling, performance

我的编码时间不长，所以我不熟悉哪种技术最快，所以我想知道是否有办法在 VS 或使用 3rd 方工具中做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-26T13:25:48.323

好的，投票时间...

Profiler 非常适合测量。

但是您的问题是“我怎样才能确定我的代码的慢速部分在哪里？”。

那是一个不同的问题。是诊断，不是测量。

**我知道这不是一个流行的观点，但这是真的。**

这就像一个试图削减成本的企业。

一种方法（自上而下）是衡量整体财务状况，然后按类别和部门进行细分，并尝试猜测可以消除的情况。*那就是测量。*

另一种方法（自下而上）是随机走进办公室，随机挑选某人，并详细询问他们当时在做什么以及（重要的是）为什么。

**不止一次这样做。**

这就是哈里杜鲁门在二战爆发时在美国国防工业中所做的事情，并通过访问多个网站立即发现了大规模的欺诈和浪费。*那就是诊断。*

在代码中，您可以通过一种非常简单的方式做到这一点：“暂停”它并询问它为什么要花费那个特定的周期。通常调用堆栈会详细告诉您原因。

**不止一次这样做。**

这是抽样。一些分析器对调用堆栈进行采样。但是出于某种原因，他们坚持总结每个功能所花费的时间，包括包容性和排他性。这就像在业务中按部门进行总结，包容性和排他性。

它丢失了您需要的信息，即说明循环是否必要的细粒度细节。

**要回答您的问题：**

只需暂停您的程序几次，然后每次都捕获调用堆栈。如果您的代码非常慢，那么浪费的函数调用将出现在几乎每个堆栈上。他们将精确地指向“代码的缓慢部分”。

补充：RedGate ANTS 正在到达那里。它可以为您逐行提供成本，而且非常漂亮。因此，如果您使用 .NET，并且可以节省 3 个数字，并且不介意等待安装和学习它，它可以告诉您 Pause 键可以告诉您的大部分内容，并且更漂亮。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-28T00:34:24.467

分析。

[RedGate](http://www.red-gate.com/products/ants_profiler/index.htm)有一个产品。
[JetBrains](http://www.jetbrains.com/profiler/)有一个产品。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T16:07:28.297

I've used ANTS Profiler and I can join the others with recommendation.

The price is NEGLIGIBLE when you compare it with the amount of dev hours it will save you.

I you're developer for a living, and your company won't buy it for you, either change the company or buy it for yourself.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T16:37:42.047

为了分析大型复杂的 UI 应用程序，您通常需要一组工具和方法。我将概述我最近在一个项目中使用的方法和工具，以提高 .Net 2.0 UI 应用程序的性能。

首先，我采访了用户并自己研究了用例，列出了目标用例列表，突出了系统性能较差的区域。即，我不想花 n 个工作日来优化一个几乎从未使用过但速度很慢的功能。但是，我想花时间优化一个有点迟缓但每天调用 1000 次的功能，等等。

一旦确定了候选用例，我就使用我自己的轻量级日志记录类来检测我的代码（我使用了一些高性能计时器和自定义日志记录解决方案，因为需要亚毫秒级的精度）。但是，您可能能够摆脱 log4net 和时间戳。我检测代码的原因是有时阅读您自己的日志而不是分析器的输出更容易。出于各种原因，我需要两者（例如，使用分析器测量 .Net 用户控件布局并不总是那么简单）。

然后，我使用 ANTS 分析器运行我的检测代码并分析用例。通过结合 ANTS 配置文件和我自己的日志文件，我能够很快发现我们的应用程序存在的问题。

我们还对服务器和 UI 进行了概要分析，并且能够计算出在 UI 上花费的时间、在网络上花费的时间、在服务器上花费的时间等的细分。

另外值得注意的是 1 次运行是不够的，第 1 次运行通常值得扔掉。让我解释一下：PC 负载、网络流量、JIT 编译状态等都会影响特定操作所需的时间。一个简单的策略是测量一次操作 n 次（比如 5 次），丢弃最慢和最快的运行，分析剩余轮廓。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T13:34:20.737

[Eqatec profiler](http://www.eqatec.com/tools/profiler)是一款可爱的小型 profiler，免费且易于使用。就功能而言，它可能不会接近 Ants profiler 的“哇”因素，但它仍然是非常酷的 IMO，值得一看。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T00:33:31.223

使用[分析器](http://en.wikipedia.org/wiki/Code_profiler#Use_of_profilers)。 [ANTS](http://www.red-gate.com/Products/ants_profiler/index.htm)花钱，但非常好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-12T14:03:08.723

我只是设置了断点，视觉会告诉你断点之间已经过去了多少毫秒。所以你可以手动找到它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T00:34:54.840

[ANTS Profiler](http://www.red-gate.com/Products/ants_profiler/index.htm)非常好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-28T00:39:30.557

ANTS Profiler[教程/说明](http://www.codeproject.com/KB/showcase/RedGate_ANTSProfilerv2.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-28T00:51:05.837

如果您不想付费，较新的 VS 版本带有分析器，但老实说，它似乎不是很好。ATI/AMD 制作了一个免费的分析器……但它对用户不太友好（对我来说，我无法从中获得任何有用的信息）。

我会给出的建议是使用代码自己调用函数。如果它们很快并且您没有高精度计时器，或者由于多种原因（例如，每个 x 调用构建某种缓存），调用速度不同，请尝试将每个调用运行 x10000 次或其他东西，然后除以结果因此。这对于某些代码部分可能并不完美，但如果您无法找到一个好的、免费的第 3 方解决方案，除非您想付费，否则它几乎是剩下的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-16T16:25:41.280

另一个选择是英特尔的[VTune](http://www.intel.com/cd/software/products/asmo-na/eng/239144.htm)。

# java - JDBC 连接问题

> ID：485984
> 
> 赞同：1
> 
> 时间：2009-01-28T00:36:25.727
> 
> 标签：java, jdbc, connection

我在我的 Java 应用程序中创建了一个 getDBConnection 方法。这将返回一个连接对象，因此我没有在此方法本身中关闭此连接。

现在，我定期从应用程序中的各种方法调用此方法，并在 try - finally 块中关闭它们。我认为这应该在使用后释放连接。但是，我看到在 MySQL 管理员的服务器连接选项卡中打开了大量连接（大约 50 个）。

```
//Defining a method to retrieve a database connection
// PropDemo is a properties class that retrieves Database related values from a file
public Connection getDBConnection() {

    //Instantiating the Properties object
    PropDemo prop = new PropDemo();
    Connection con = null;

    // Retrieving values from the parameters.properties file
    String JdbcDriver = prop.getMessage("JdbcDriver");
    String JdbcUrlPrefix = prop.getMessage("JdbcUrlPrefix");
    String DBIP = prop.getMessage("DBIP");
    String DBName = prop.getMessage("DBName");
    String DBUser = prop.getMessage("DBUser");
    String DBPassword = prop.getMessage("DBPassword");

    try {

        // Loading and instantiating the JDBC MySQL connector driver class
        Class.forName(JdbcDriver).newInstance();
        con = DriverManager.getConnection(JdbcUrlPrefix + DBIP + "/" + DBName, DBUser, DBPassword);

          if (con.isClosed())
                    Logger.log("Connection cannot be established", "vm");

    } catch (Exception e) {
        Logger.log("Exception: " + e, "vm");
        Logger.log(Logger.stack2string(e), "vm");
    }
    return con;

} 
```

我还将关闭相关的 ResultSet 和 Statement 对象。这里可能缺少什么？

出于效率和安全原因，我计划用 PreparedStatements 替换所有 Statements。这会有很大帮助吗？还有什么可以做的？

编辑：这只是一个核心 java 应用程序，它通过 MySQL-JDBC 连接器反复查询 MySQL 数据库中某些字段的更改。我没有使用 Spring 或 Hibernate 等任何框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T18:54:04.980

你的代码看起来很正常。

这就是您创建新连接的方式。

错误可能是您关闭它的位置。

您应该在 finally 块中关闭它。

一些额外的问题。

1) 你确定这 50 个连接来自这个程序吗？也许还有其他人来自您的同一个办公室。要确认这一点，您需要停止该程序，并再次查看您的连接监视器。

2）您的应用程序是否同时使用多个连接？当您同时使用 50 个时，它可能是一个高峰。

如果您可以在关闭连接的位置发布代码。问题可能就在那里。

另外，我建议您使用连接池。您可以自己构建一个，也可以从此页面查看结果：

[Java中有多少个JDBC连接？](https://stackoverflow.com/questions/471745/how-many-jdbc-connections-in-java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T00:51:23.090

当您的应用程序关闭时，您是否也在关闭连接对象？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T01:08:51.417

您是在 J2EE 应用程序服务器中还是在 Hibernate 中使用 JDBC 连接？这两者都倾向于从一个相当高的连接池开始，所以你会看到一个很大的数字。

查看有关连接池的详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T14:39:54.290

您可以对问题采取单例方法，并且仅在当前对象为空时才创建新的 Connection 对象：

```
If (connectionObject != null){
   return connectionObject;
}else {
   //create new connection object
} 
```

这将确保您在任何时候都只有一个非空连接。

# svn - 如何进行 SVN 合并

> ID：485996
> 
> 赞同：1
> 
> 时间：2009-01-28T00:40:06.700
> 
> 标签：svn, merge

我以前做过的颠覆合并遇到了麻烦，而且我的本地帮助不在身边……所以我希望这里的人可以提供帮助。是的，我已经阅读了文档，我想要一个人工响应，因为这种合并非常重要。

我正在尝试从 branch123 合并到 branch124，它直接从分支 123 分支出来。我的合并命令是：

```
svn merge -r 18089:HEAD  svn+ssh://my.private.url/usr/local/svn/myappname/branches/123/ . 
```

这里当前目录是新签出的 branch124 副本。修订版 18088 是上一个修订版，它使 branch124 保持最新。

合并的结果似乎清除了自上次刷新以来在 branch124 中所做的更改。语法错了吗？还有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T00:49:23.937

我简化 svn 合并的心智模型是将其视为 diff->patch。

例如，如果您将 123 合并为 124，则执行

```
svn diff -r 18089:HEAD svn/myappname/branches/123 
```

应该为您提供您打算修补/合并的目标路径中应该更改的内容的差异。*仔细*检查它，确保它没有删除你想留在 124 中的东西。

如果差异看起来正确，请像您尝试的那样继续合并它：

```
svn merge -r 18089:HEAD svn/myappname/branches/123 svn/myappname/branches/124 
```

这只是上一个命令，除了 diff 变为 merge 并且您在命令末尾附加了合并的目标目录***`****