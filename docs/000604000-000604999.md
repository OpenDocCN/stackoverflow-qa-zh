# StackOverflow 问答 000604000-000604999

# html - .htaccess 中的重写引擎以捕获不以 html 结尾的文件

> ID：604012
> 
> 赞同：5
> 
> 时间：2009-03-02T21:09:12.870
> 
> 标签：html, regex, .htaccess, mod-rewrite

在标准 LAMP 托管情况下，我想使用 mod rewrite in 将**/directory**之类的网页地址转换为**/directory/index.html 。**我所拥有的适用于以斜杠结尾的地址。我找不到处理**不以斜线结尾的地址**的方法。

它似乎应该起作用的是：

```
rewriterule ^(.*)/$ $1/index.html [L] /* addresses ending in / */
rewriterule ^(.*(?!html))$ $1/index.html [L] /* where the problem is */ 
```

但是第二行会导致 500 服务器错误。如果我在第二行添加一个字母 x：

```
rewriterule ^(.*)/$ $1/index.html [L]
rewriterule ^(.*x(?!html))$ $1/index.html [L] 
```

它开始工作，但**仅适用于以 x 结尾的目录名称**。我尝试用许多不同的东西替换 x。任何比真实字符更复杂的字符（如 [^x] 或 .+）都会导致 500 服务器错误。

而且，为了满足我自己的好奇心，有谁知道为什么添加一个真实的字母会在服务器错误和完美运行的规则之间产生差异？

**[接受的答案]**感谢 Gumbo，我能够使用 rewritecond 近似解决方案：

```
重写条件 %{REQUEST_URI} !\.[^/]+$
重写 (.+) $1/index.html [L]

```

这可行，但过滤的不仅仅是 .html——它可能会阻止其他页面。很遗憾，

```
rewritecond %{REQUEST_URI} !\.html$ 
```

导致服务器错误：

> 由于可能的配置错误，请求超出了 10 个内部重定向的限制。如有必要，使用“LimitInternalRecursion”增加限制。

**我仍然想知道为什么：**

```
rewriterule ^(.*(?!html))$ $1/index.html [L] 
```

导致循环。前半部分应该检查它*是否不*以 .html 结尾。由于后半部分*添加了*.html，它的功能似乎相当于：

```
while(substr($address,-4)!='html') $address.='html'

```

显然我错过了一些东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T21:55:31.183

使用`RewriteCond`指令检查 URL 路径是否不以`.html`:结尾

```
RewriteCond %{REQUEST_URI} !\.html$
RewriteRule ^(.*[^/])?/?$ $1/index.html [L] 
```

* * *

**编辑**   您正在使用前瞻断言（`(?!…)`）。但是之后没有任何东西`.*`（只有一个`$`）。因此，请尝试使用后向断言：

```
RewriteRule ^.*$(?<!html) $0/index.html [L] 
```

但请注意，您可能需要 Apache 2.2 才能使用这些断言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T21:38:07.827

好吧，为了让它真正发挥作用，你可以只使用负面的后视而不是前瞻：

```
RewriteRule ^(.*)(?<!html)$ $1/index.html [L] 
```

我不确定为什么添加“x”会使其正常工作，如果我弄清楚了，我会进行编辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T21:50:50.180

为什么添加`x`它使它起作用：如果替换将匹配正则表达式，则将再次应用 RewriteRule。例如，这会导致错误：

```
RewriteRule ^(.*)$ $1.rb 
```

因为它将替换`script`为`script.rb`. 这与正则表达式匹配，因此它一次又一次地替换`script.rb`为, ......`script.rb.rb`

错误日志中暗示了这一点：

```
Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. 
```

在您的示例中，您将 index.html 添加到末尾。当`x`正则表达式末尾有 a 时，它将与您的替换不匹配，替换以`l`.

# c# - SQL Server 程序集和 SQLBinary 数据类型

> ID：604015
> 
> 赞同：0
> 
> 时间：2009-03-02T21:09:45.180
> 
> 标签：c#, sql-server, assemblies, types, varbinary

我有一个 ac# 程序集，它接受一个 SQLBinary 变量来解密......

```
[SqlProcedure(Name="Decrypt")]
public static SqlInt32 Decrypt(SqlBinary toDecrypt)
{
    return runQuery(toDecrypt);
}

// decrypt or encrypt is determined based on the datatype of argValue
private static SqlInt32 runQuery(object argValue)
{
    // create connection and command

       command.Parameters.Add("@argValue", SqlDbType.VarBinary, 1024).Value = (SqlBinary)argValue; 
```

我将 (SqlBinary)argValue 作为一列包含在 select 语句中以进行简单调试。它似乎没有将此 SqlBinary 值正确放入查询中。

argValue 的使用方式如下：

```
QueryString += "SELECT decryptbykey(@argValue);"; 
```

返回的内容看起来像 (SqlBinary)argValue 的截断版本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T21:46:46.790

回答我自己的问题：

我不得不将decryptbykey的结果转换为varchar ... duh！:)

# wcf - WCF 测试客户端错误：无法调用服务

> ID：604020
> 
> 赞同：5
> 
> 时间：2009-03-02T21:12:11.490
> 
> 标签：wcf, rest, wcf-client

尝试将 WCF 测试客户端与我的 WCF 服务一起使用时出现错误。这是服务代码：

```
[ServiceContract]
public interface IEmployeeService
{
    [OperationContract(Name = "GetEmployee")]
    [WebGet(RequestFormat = WebMessageFormat.Xml,
        UriTemplate = "/Employees/{employeeNumber}")]
    Employee GetEmployee(string employeeNumber);
}

public Employee GetEmployee(string employeeNumber)
{
    var employeeNumberValue = Convert.ToInt32(employeeNumber);
    var employee = DataProvider.GetEmployee(employeeNumberValue);
    return employee;
}

<system.serviceModel>
    <services>
        <service name="Employees.Services.EmployeeService"
                 behaviorConfiguration="metaBehavior">
            <endpoint address=""
                      behaviorConfiguration="webHttp"
                      binding="webHttpBinding"
                      contract="Employees.Services.IEmployeeService">
            </endpoint>
            <endpoint address="mex"
                      binding="mexHttpBinding"
                      contract="IMetadataExchange">
            </endpoint>
        </service>
    </services>
    <behaviors>
        <endpointBehaviors>
            <behavior name="webHttp">
                <webHttp/>
            </behavior>
        </endpointBehaviors>
        <serviceBehaviors>
            <behavior name="metaBehavior">
                <serviceMetadata httpGetEnabled="true" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

我可以使用 WCF 测试客户端连接到服务，但是当我尝试调用 GetEmployee(employeeNumber) 时，我收到以下错误：

*调用服务失败。可能原因：服务离线或无法访问；客户端配置与代理不匹配；现有代理无效。有关更多详细信息，请参阅堆栈跟踪。您可以尝试通过启动新代理、恢复到默认配置或刷新服务来恢复。*

通过从浏览器发送请求，我能够成功调用此服务。

知道为什么我不能使用 WCF 测试客户端吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-04T07:52:45.640

请忽略我之前的回答。我不认为问题出在客户端配置上。

请参阅[WCF 测试客户端和 WebHttpBinding](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/deabd25b-a219-4e95-9826-d40dc2f75543/)。

> 这是 Web 编程模型本身的限制。与 SOAP 端点（即具有 BasicHttpBinding、WSHttpBinding 等的端点）不同，SOAP 端点（即具有 BasicHttpBinding、WSHttpBinding 等的端点）可以通过端点中所有操作/参数的信息来公开有关自身的元数据（WSDL 或 Mex），目前没有标准方法来公开元数据非 SOAP 端点——这正是基于 webHttpBinding 的端点。简而言之，WCF 测试客户端对基于 Web 的端点没有用处。如果 WCF 发布下一个版本时出现了一些表示 Web 样式端点的标准，我们可能会更新测试客户端以支持它，但目前还没有被广泛采用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T05:17:25.457

我认为你的配置是错误的，你应该添加节点安全模式=“无”和属性绑定配置=“无安全”

更改为我的配置，再试一次：

```
<system.serviceModel>
    <bindings>
      <wsHttpBinding>
        <binding name="NoneSecurity"
          maxBufferPoolSize="12000000" maxReceivedMessageSize="12000000" useDefaultWebProxy="false">
          <readerQuotas maxStringContentLength="12000000" maxArrayLength="12000000"/>
          <security mode="None"/>
        </binding>
      </wsHttpBinding>
    </bindings>
    <services>
      <service behaviorConfiguration="Elong.GlobalHotel.Host.IHotelAPIBehavior"
        name="Elong.GlobalHotel.Host.IHotelAPI">
        <endpoint address="" binding="wsHttpBinding" bindingConfiguration="NoneSecurity" contract="Elong.GlobalHotel.Host.IIHotelAPI">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="Elong.GlobalHotel.Host.IHotelAPIBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-30T09:09:19.900

```
 I had a similar problem, the solution was in a minor error in the message alias ... that very generic message ... in our case was assigned a Boolean false if the right is true.
  This value was in the MDM application that was running on websphere. 
```

在我的情况下的路径：

```
 /opt/infamdm/hub/server/resources/cmxserver.properties
   /opt/infamdm/hub/cleanse/resources/cmxcleanse.properties 
```

# c++ - 现在要删除与谓词匹配的元素？

> ID：604024
> 
> 赞同：5
> 
> 时间：2009-03-02T21:13:32.703
> 
> 标签：c++, stl

我有一个字符串的源容器我想从源容器中删除与谓词匹配的任何字符串并将它们添加到目标容器中。

`remove_copy_if``erase`而其他算法只能对容器中的元素进行重新排序，因此必须由成员函数跟进。我的书（Josuttis）说`remove_copy_if`在目标容器的最后一个位置之后返回一个迭代器。因此，如果我只有一个指向目标容器的迭代器，我该如何调用`erase`源容器？我曾尝试使用目标的大小来确定要从源容器的末尾删除多远，但没有运气。我只提出了以下代码，但它进行了两次调用（`remove_if`和`remove_copy_if`）。

有人可以让我知道正确的方法吗？我确信两个线性调用不是做到这一点的方法。

```
#include <iostream>
#include <iterator>
#include <vector>
#include <string>
#include <algorithm>
#include <functional>

using namespace std;  

class CPred : public unary_function<string, bool>
{
public:
        CPred(const string& arString)
                :mString(arString)
        {
        }

        bool operator()(const string& arString) const
        {
                return (arString.find(mString) == std::string::npos);
        }
private:
        string mString;
};

int main()
{
        vector<string> Strings;
        vector<string> Container;

        Strings.push_back("123");
        Strings.push_back("145");
        Strings.push_back("ABC");
        Strings.push_back("167");
        Strings.push_back("DEF");

        cout << "Original list" << endl;
        copy(Strings.begin(), Strings.end(),ostream_iterator<string>(cout,"\n"));

        CPred Pred("1");

        remove_copy_if(Strings.begin(), Strings.end(),
                       back_inserter(Container),
                       Pred);

        Strings.erase(remove_if(Strings.begin(), Strings.end(),
                      not1(Pred)), Strings.end());

        cout << "Elements beginning with 1 removed" << endl;
        copy(Strings.begin(), Strings.end(),ostream_iterator<string>(cout,"\n"));

        cout << "Elements beginning with 1" << endl;
        copy(Container.begin(), Container.end(),ostream_iterator<string>(cout,"\n"));

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T21:24:15.753

在充分尊重 Fred 的辛勤工作的情况下，让我补充一点：这与抽象层面`move_if`没有什么不同`remove_copy_if`。唯一的实现级别更改是`end()`迭代器。你仍然没有得到任何`erase()`. **接受的答案不是`erase()`匹配的元素——OP 问题陈述的一部分。**

**至于OP的问题：您想要的是就地拼接。这对于列表是可能的。但是，`vectors`这将不起作用。阅读有关迭代器何时、如何以及为何失效的信息。您将不得不采用两遍算法。**

> `remove_copy_if`而其他算法只能对容器中的元素进行重新排序，

来自 SGI 的文档[`remove_copy_if`](http://www.sgi.com/tech/stl/remove_copy_if.html)：

> 此操作是稳定的，这意味着复制的元素的相对顺序与范围 [first, last) 中的相对顺序相同。

所以不会发生相对重新排序。此外，这是一个副本，这意味着`Source` `vector`您案例中的元素正在被复制到`Container vector`.

> 如何在源容器上调用擦除？

您需要使用不同的算法，称为[`remove_if`](http://www.sgi.com/tech/stl/remove_if.html)：

> `remove_if`从范围中删除每个为真的`[first, last)`元素。也就是说，返回一个迭代器，使得范围不包含任何为真的元素。范围内的迭代器仍然是可解引用的，但它们指向的元素是未指定的。是稳定的，这意味着没有被移除的元素的相对顺序是不变的。`x``pred(x)``remove_if``new_last``[first, new_last)``pred``[new_last, last)``Remove_if`

因此，只需将该`remove_copy_if`调用更改为：

```
vector<string>::iterator new_last = remove_if(Strings.begin(), 
                                              Strings.end(), 
                                              Pred); 
```

一切就绪。请记住，您`Strings vector`的范围不再是由迭代器定义的，`[first(), end())`而是由`[first(), new_last)`.

如果需要，您可以`[new_last, end())`通过以下方式删除剩余部分：

```
Strings.erase(new_last, Strings.end()); 
```

现在，您`vector`已缩短并且您的`end()`和`new_last`是相同的（最后一个元素之后的一个），因此您可以像往常一样使用：

```
copy(Strings.begin(), Strings.end(), ostream_iterator(cout, "\")); 
```

在控制台 ( `stdout`) 上打印字符串。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T22:07:32.217

我明白你的意思，你想避免在你的源容器上做两次传递。不幸的是，我不相信有一个标准算法可以做到这一点。可以创建自己的算法，将元素复制到新容器并从源容器中删除（与 remove_if 相同；您必须在之后进行擦除）。您的容器大小和性能要求将决定创建这种算法的努力是否比两次通过更好。

编辑：我想出了一个快速的实现：

```
template<typename F_ITER, typename O_ITER, typename FTOR>
F_ITER move_if(F_ITER begin, F_ITER end, O_ITER dest, FTOR match)
{
  F_ITER result = begin;
  for(; begin != end; ++begin)
  {
    if (match(*begin))
    {
      *dest++ = *begin;
    }
    else
    {
      *result++ = *begin;
    }
  }

  return result;
} 
```

编辑：“通过”的含义可能存在混淆。在 OP 的解决方案中，有一个对 remove_copy_if() 的调用和对 remove_if() 的调用。这些中的每一个都将遍历整个原始容器。然后调用erase()。这将遍历从原始容器中删除的所有元素。

如果我的算法用于将删除的元素复制到一个新容器（使用 begin() 输出迭代器的原始容器将不起作用，正如直接演示的那样），它将执行一次传递，将删除的元素复制到新容器手段 back_inserter 或一些这样的机制。与 remove_if() 一样，仍需要擦除。消除了原始容器的一次通过，我相信这是 OP 所追求的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T21:26:01.007

会有copy_if和remove_if。

```
copy_if( Strings.begin(), Strings.end(), 
         back_inserter(Container), not1(Pred) );
Strings.erase( remove_if( Strings.begin(), Strings.end(), not1(Pred) ), 
               Strings.end() ); 
```

如果存在某些东西，最好理解谓词类回答“真”的代码。在这种情况下，您不需要两次 not1。

因为 std::find 从一开始就查找子字符串不是必须的，所以您需要将“以 1 开头”更改为“以 1”以避免将来对代码的误解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T21:26:58.943

1.  remove_* 算法不擦除元素的全部原因是不可能仅通过迭代器“擦除”元素。**无法通过迭代器获取容器** 这一点在《Effective STL》一书中有更详细的解释

2.  使用' `copy_if`'，后跟' `remove_if`'。`remove_copy_if`不修改源。

3.  在列表上你可以做得更好——重新排序，然后拼接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T14:35:59.733

如果您不介意将字符串放在同一个容器中，并且只使用一个迭代器来分隔它们，那么此代码可以工作。

```
#include "stdafx.h"

#include <iostream>
#include <iterator>
#include <vector>
#include <string>
#include <algorithm>
#include <functional>

using namespace std;

class CPred : public unary_function<string, bool>
{
public:
        CPred(const string& arString)
                :mString(arString)
        {
        }

        bool operator()(const string& arString) const
        {
                return (arString.find(mString) == std::string::npos);
        }
private:
        string mString;
};

int main()
{
        vector<string> Strings;

        Strings.push_back("213");
        Strings.push_back("145");
        Strings.push_back("ABC");
        Strings.push_back("167");
        Strings.push_back("DEF");

        cout << "Original list" << endl;
        copy(Strings.begin(), Strings.end(),ostream_iterator<string>(cout,"\n"));

        CPred Pred("1");

        vector<string>::iterator end1 = 
        partition(Strings.begin(), Strings.end(), Pred);

        cout << "Elements matching with 1" << endl;
        copy(end1, Strings.end(), ostream_iterator<string>(cout,"\n"));

        cout << "Elements not matching with 1" << endl;
        copy(Strings.begin(), end1, ostream_iterator<string>(cout,"\n"));

        return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T21:26:37.680

remove*() 不会真正删除元素，它只是将它们重新排序并将它们放在集合的末尾，并在同一容器中返回一个 new_end 迭代器，指示新端的位置。然后，您需要调用 erase 以从向量中删除范围。

```
source.erase(source.remove(source.begin(), source.end(), element), source.end()); 
```

remove_if() 做同样的事情，但有一个谓词。

```
source.erase(source.remove_if(source.begin(), source.end(), predicate), source.end()); 
```

remove_copy_if() 只会复制与谓词不匹配的元素，保持源向量不变，并为您提供目标向量的结束迭代器，以便您可以缩小它。

```
// target must be of a size ready to accomodate the copy
target.erase(source.remove_copy_if(source.begin(), source.end(), target.begin(), predicate), target.end()); 
```

# c# - OpenGL 游戏一次在屏幕上显示多个实体，使用什么语言？

> ID：604029
> 
> 赞同：1
> 
> 时间：2009-03-02T21:16:24.600
> 
> 标签：c#, opengl, programming-languages

打算用 OpenGL 作为辅助项目创建一个小游戏。将成为一个自上而下的射手，重​​点是大量敌人（越多越好）

考虑将最大分辨率设置为 800x600（老派感觉）

您会推荐哪种语言，C# 是否能够处理我想要在屏幕上显示的实体数量（60-100），或者我应该尝试 C 或 C++ 甚至其他语言。

在进行这样的项目时，您是否有任何其他建议，您推荐的特殊文档等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T21:23:32.587

C# 可以轻松地同时处理数百个对象。真正的速度问题来自渲染，它不会在 C# 空间中，并且可能是您希望为每个对象完成的任何计算，例如物理。理想情况下，无论如何你都会使用 Box2D 或 Chipmunk 之类的库，这也使得 C# 的速度也不再是问题。

我个人愿意用比 C# 更高级别的语言编写这样的游戏。C# 应该很容易就足够了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T21:29:03.527

在脚本语言技巧中，请考虑 Python 中出色的 Pygame：

[http://www.pygame.org/news.html](http://www.pygame.org/news.html)

或者 Lua 中较新的 LÖVE

[http://love2d.org/](http://love2d.org/)

对于一个自上而下的射手来说，两者都可能是很好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T21:25:28.853

您是否考虑过[Haskell](http://www.haskell.org)、[D](http://www.digitalmars.com/d/)或[ADA](http://www.cs.chalmers.se/~bond/OPENGL/ADA/)？

C# 肯定能够在任何合理的硬件上处理微不足道的 60-100 个 OpenGL 渲染实体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T21:56:13.960

一般来说，对于这个范围的项目，我建议使用你接下来想学习的任何语言。

您的项目范围并不大，但足够丰富，它可能会扩展您对所选语言的了解。所以选择一个你想变得更好的人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T21:59:51.627

我只涉足过它，但[LWJGL](http://lwjgl.org/)将促进 Java 版本。[例如， puppygames.net](http://www.puppygames.net/)上的所有内部游戏都是用 Java 和 LWJGL 完成的，而且奇怪的是，它们也是自上而下或侧向冲击波风格的游戏。

# .net - 软件带宽/数据库增长公式

> ID：604030
> 
> 赞同：2
> 
> 时间：2009-03-02T21:16:45.800
> 
> 标签：.net, database, performance, architecture, networking

是否有任何行业标准公式或经验法则来确定：

1.  应用程序带宽使用/要求
2.  数据库增长要求

我最近开始管理一个新的 .NET 3.5/SQL Server 项目，并且在确定我的应用程序在存储和带宽方面的需求时，我希望采用比以前更结构化的方法。如果有人有任何指示，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T18:17:52.697

我不是 SQL Server 专家，但总的来说，对于数据库大小调整，前进的最佳方法是稍微了解架构。例如，数据库中是否存在分区？是否有很多索引等。现在将每个事务中进入数据库的记录数乘以每小时的事务频率。这给出了每小时进入数据库的记录总数。将此乘以平均行大小，这提供了没有分区和索引空间开销的数据库大小。要计算分区开销，需要了解分区类型，如范围分区或哈希分区等，每小时或每天将创建的分区数量，并为分区添加空间开销。通常这个数字需要增加 50% 才能估计数据库的大小。在网络的情况下，有很多方法可以做到这一点。我运行 etheral 来捕获网络流量。如果您捕获网络流量，它会变得很有趣-数据的季节性如何-例如高峰时间是什么时候，繁忙时间的最大带宽使用量是多少等。然后您需要一个好的工具来进行预测-例如它将处理数据的季节性，了解数据的趋势并大致预测如果增加负载会发生什么。使用 y=mx+c 的简单图形和直线拟合曲线也将在这里为您提供帮助。然后你需要一个好的工具来进行预测——比如它会处理数据中的季节性，了解数据的趋势并大致预测如果你增加负载会发生什么。使用 y=mx+c 的简单图形和直线拟合曲线也将在这里为您提供帮助。然后你需要一个好的工具来进行预测——比如它会处理数据中的季节性，了解数据的趋势并大致预测如果你增加负载会发生什么。使用 y=mx+c 的简单图形和直线拟合曲线也将在这里为您提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-22T13:23:46.863

首先披露：我在[Quest Software](http://www.quest.com/sql-server/ "探索软件")工作，这是一家进行绩效管理和容量规划的公司。

有很多产品可以满足这些需求。Quest 制作了一些，例如 Spotlight for SQL Server、Spotlight for IIS、Capacity Manager for SQL Server 等等。没有单一的公式或经验法则，因为系统中的每个组件对负载的反应都不同，而且您存储的每件东西的比例都不同。

例如，如果您将销售数据存储在数据仓库中，您的销售数据将呈线性增长。这是一个简单的公式：

（开放天数）*（每天交易）*（每笔交易项目）

当您第一次开店时，每天的交易量相当低，但随着您业务的传播，每天的交易量会增加。如果您开始携带更多物品（例如亚马逊从书籍到所有物品），您的每次交易物品数量也可能会增加 - 但不一定。随着时间的推移，随着您的报告需求增长，您将实施汇总表以包含有关您的客户、人口统计等的数据，这也会改变您存储的数据量。

另一方面，如果您正在构建一个 Web 过滤应用程序，那么公式将围绕每家公司拥有的员工数量。随着时间的推移，人们上网的次数大致相同，但这个公式会受到你是要雇用更多人还是裁员的影响。

如果您确定一个公式来预测数据增长，那么该公式不一定对预测您的 CPU 需求或带宽需求有用。

因此，每个容量规划产品都有自己的一套公式。例如，[Capacity Manager](http://www.quest.com/capacity-manager-for-sql-server/)有大约六种不同的公式来预测磁盘增长，这甚至不涉及 CPU 或内存需求。在大商店里，你会发现不同的公式更适合不同类型的数据。一般来说，我发现购买内置所有这些公式的现成产品比重新发明轮子成为预测公式专家更有效。（我知道，我知道，你会希望我这么说，因为我为供应商工作，但在我来 Quest 工作之前，我作为 DBA 购买了容量管理器，呵呵。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T21:58:26.917

我会不敬地指出[帕金森的数据定律](http://catb.org/jargon/html/P/Parkinsons-Law-of-Data.html)。

但是，对于数据库中的每个表，我尝试了解平均记录大小（尤其是在处理像 varchars 这样的可变长度字段时），然后将其乘以您希望在一年内添加的记录数。然后我把它们加在一起，四舍五入到最重要的数字，然后把结果加倍。这为开销和增长留下了充足的空间。

```
 round_up_to_one_sig_digit(sum(average_table_row_size 
                             * num_rows_in_one_year)) * 2 
```

类似的方法适用于网络容量，但您会遇到人类和网络的一些特殊性。他们并非都以平均间隔登录（因此您会在白天/晚上获得高峰，而在清晨获得低谷。您也不想超过 80% 的网络容量或性能，只是发生碰撞的普通坦克等.)

# date - 一个月的第一周/最后一周是什么时候？

> ID：604031
> 
> 赞同：17
> 
> 时间：2009-03-02T21:16:58.797
> 
> 标签：date, definition

如果有人说某个月的第一周或最后一周发生了什么事，你会如何定义这个跨度？

* * *

## 背景

我正在开发一个需要以直观方式处理此类事情的库，但我的直觉并没有要求任何一种情况。

我可以让它选择不同的行为，但仍然需要一个好的默认值。

* * *

举一个具体的例子，我将随机选择一个月份：2008 年 7 月

```
s  m  t  w  r  f  s
--------------------
      1  2  3  4  5
6  7  8  9  10 11 12
13 14 15 16 17 18 19
20 21 22 23 24 25 26
27 28 29 30 31 
```

*（注意：我假设这周从星期日开始，但这个问题也可以在星期一提出）*

一个月的第一周是几星期？

1.  6 月 29 日 - 7 月 5 日*——包括第一个*
2.  7 月 6 日至 12 日*——进入本月的第一周*

第二周是第一周之后的7天吧？

一个月的最后一周是多少天？

1.  7 月 27 日 - 8 月 2 日*——同上，但最后一天*
2.  7 月 20 日至 26 日*——同上，但最后一周*

*欢迎非wiki评论*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T21:23:13.913

[没有答案，因为即使在一个国家内部它也会有所不同。](http://www.linguistlist.org/issues/12/12-1858.html)

但是，[该消息来源](http://www.perlmonks.org/?node_id=484347)似乎认为 ISO 标准将其定义为包含星期四的第一周。然而，上述消息来源称 ISO 标准没有列出“每月第一周”的规范

* * *

*超过 300 个字符 - 对不起！*

ISO 8601 标准将一年的第一周定义为：

> 日历周数
> 
> 序号，它根据以下规则标识其日历年内的日历周：一年的第一个日历周是包括该年的第一个星期四的那个，并且一个日历年的最后一个日历周是紧接在该周之前的一周下一个日历年的第一个日历周

ISO 8601 中没有关于该月的第一周的内容，因为如前所述，定义因国家/地区而异（例如，甚至因公司而异）。哦，标准说每周从星期一开始。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-02T21:24:18.950

如果您正在构建一个库，您应该允许用户选择他们希望如何处理它，方法是使用返回一个月的第一个/最后一个完整/部分周的方法，或者传递一个指示您是否想要完整/部分周。如果您提供不需要规范的方法，请清楚地记录默认值。

```
public Week GetFirstFullWeekOfMonth( DateTime forDate ) { }

public Week GetFirstPartialWeekOfMonth( DateTime forDate ) { } 
```

或者

```
public Week GetFirstWeekOfMonth( DateTime forDate, bool includePartial ) {} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T21:17:45.207

该月的第一周是该月的第一周

2.  7 月 6 日至 12 日

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T21:17:14.367

该月的第一周是包括第一周的那一周

1.  6 月 29 日 - 7 月 5 日

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T21:18:08.030

一个月的最后一周是包括最后一天的那一周

1.  7 月 27 日 - 8 月 2 日

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T21:18:24.223

该月的最后一周是该月的最后一周

2.  7 月 20 日至 26 日

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T21:22:02.013

我的定义是第一周是该月第一个工作日的那一周，同样最后一周是该月最后一个工作日的那一周。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-14T17:40:08.513

该月的第一周是第 0 周 - 具有该月第一天的那一周。上周是有该月最后一天的那一周

因此，七月最后一周的周数与八月第一周的周数相同

** 除非 **

有问题的月份在上周的最后一天结束，在这种情况下，下个月将从新一周的第一天开始，并且有不同的周数

:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-02T21:38:44.720

每月的第一周是拥有定义周期间的 4 天或更多天的第一周。（不是真的，但我想我会把它作为一种选择）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T22:27:19.203

您缺少一个相当明显的选项。每月的第一周是从该月的第一天开始的 7 天。因此，在您的示例中，第一周是周二，第一周到周一，第七周。这样，第一周到第 4 周将始终完全包含在该月内，并且只有第 5 周会交叉。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-14T17:48:12.237

*与您的用户交谈*并询问他们，当程序对他们说“本月的第一周”和“本月的最后一周”时，他们认为这意味着什么。

# sql-server - PRE ANSI-92 左连接语法 (Sybase)

> ID：604045
> 
> 赞同：0
> 
> 时间：2009-03-02T21:20:56.260
> 
> 标签：sql-server, sybase, left-join

当 Where 子句的一部分具有“等于某个常数”条件时，使用 ANSI-92 之前的语法（即 *=）指定左连接的语法是什么？（在这种情况下 100 是常数）

例子：

```
 SELECT t1.ID, t.* 
FROM (select * from SybaseTable where ID=1) t, SqlServerTable t1
WHERE t1.ID *= 100 and t1.SeqNo *= t.SeqNo 

```

在这种情况下，我想要派生表“t”中的所有记录，即使“t1”没有匹配项。当“t”中不存在 SeqNo 上的匹配行时，我希望 t1.ID 在 Select 子句中返回 NULL。

我收到的错误是“外连接的两个术语都必须包含列”。

我现在在 SQL Server 2005 中执行此查询，但它最终将用于 Sybase 实现，这需要旧的连接语法。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T21:23:48.640

我认为这会做到，但您必须进行测试才能确定：

```
SELECT t1.ID, t.* 
FROM (select * from SybaseTable where ID=1) t, SqlServerTable t1
WHERE t.SeqNo *= t1.SeqNo AND 100 *= t1.ID 
```

请注意，我颠倒了 SeqNo 部分的顺序，以便更好地指示哪个是连接的左侧。

# php - 有一个网站的单一入口点。坏的？好的？没问题？

> ID：604046
> 
> 赞同：24
> 
> 时间：2009-03-02T21:20:56.930
> 
> 标签：php, model-view-controller

这个问题源于[从 Drupalcon 观看 Rasmus Lerdorf 的演讲](http://www.archive.org/details/simple_is_hard)。顺便说一句，这个问题和他的谈话与 Drupal 没有任何特别的关系……只是在他们的骗局中给出的。我自己的问题也与 PHP 无关。总的来说，这是我很好奇的单一入口点。

如今，似乎大多数框架都为您使用它们构建的任何东西提供了一个入口点。在他的谈话中，拉斯穆斯提到他认为这很糟糕。在我看来，他的这种想法是正确的。如果访问该站点的每个人都通过同一个入口点进入，那么在流量达到某个点后，事情不会陷入困境吗？让人们直接访问站点中的特定点而不让他们的请求通过同一点不是更有效吗？但也许实际影响不是很差？也许现代建筑可以处理它？也许在它变得值得考虑之前，你必须在规模上真正做到巨大？我很好奇这个网站上的人是怎么看待这个问题的。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-02T22:03:05.300

总之，拉斯穆斯的解释还是错误的。

这表明明显缺乏对计算机如何工作的理解。使用的东西越多，它就越有可能离 CPU 越近，因此**速度越快**。请注意，单点入口！=单点故障。但这不是重点，当人们说单点入口时，我们指的是应用程序，它是您逻辑的单点入口。

更不用说在架构上没有一个中心入口点，或者总体上减少入口点的数量。一旦你想在你的应用程序的每个入口点做一件事，猜猜有多少地方需要改变？在处理了一个每个页面都独立存在的应用程序之后，不得不改变它很糟糕，我向你保证，我们需要它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T21:26:41.970

重要的是您使用的 Web 框架通过负载平衡和声明性代码等方法支持可伸缩性。

不，单入口点本身并不构成瓶颈。谷歌的首页获得了很多点击，但他们有很多服务器。

所以答案是：没关系。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T01:24:18.640

就像软件开发中的任何事情一样，这取决于。Rasmus 对前端控制器样式框架的反对意见是，您必须在每个请求上预先加载如此多的代码，从而降低性能。这是 100% 正确的。即使您使用某种智能资源加载模块/对象/等，使用框架也是一种性能折衷。你的表现受到打击，但作为回报，你会回来

1.  鼓励分离“业务逻辑”（无论是什么）和模板/布局逻辑

2.  即时和（更重要的是）**统一**访问您将用于数据库查询、调用的服务、您的数据模型等的对象。

对于像拉斯穆斯这样的人来说，这不值得表现不佳。他是一名 C/C++ 程序员。对他来说，如果您想以高性能的方式分离业务逻辑，您可以编写一个 C/C++ 对 PHP 的扩展。

因此，如果您有一个环境和团队，您可以轻松地为 PHP 编写 C/C++ 扩展，并且您的上市时间与性能比是可以接受的，那么可以，扔掉您的前端控制器框架。

如果这不是您的环境，请考虑前端控制器框架可以为您[（可能）简单的 CRUD 应用程序](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)带来的生产力提高。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T21:31:14.503

我认为与只有一个入口点相比，您拥有的最大优势之一就是安全性。如果在一个地方检查和验证所有输入，则不太可能破坏系统。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-03T02:56:28.623

我认为从“一个文件”与“几个文件”的角度讨论这个问题是一个很大的误解。

人们倾向于认为，因为入口点位于单个文件中，所以我们只需要关注那个文件中的代码——这是错误的。

所有流行的框架都有大量包含条目操作代码、解释代码和请求验证代码的文件。代码不在一个地方，而是散布在一堆 require/include 语句中，根据请求的内容和方式调用不同的类。

在这两种情况下，请求实际上是由不同的文件处理的。

那么为什么我应该有一个带有某种 _detect_uri() 函数的入口点，当我需要调用其他几个函数（如 strpos()、substr()、strncmp() 来清理、验证和拆分请求字符串时）可以只使用几个入口点一起消除该代码吗？

看看 URI.php 中的 CodeIgniters _detect_uri() 函数。不要选择 CodeIgniter，这只是一个例子。其他框架也这样做。

您可以使用单个入口点以及多个入口点来实现 MVC 模式的目标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T21:26:59.257

这是我一开始的想法，但似乎没有影响。毕竟，您的入口点（通常）只做几件事：设置一些环境常量，包括引导加载程序，可选地捕获任何抛出的异常并调度前端控制器。我*认为*这不是低效的原因是因为这个文件不会根据控制器、操作甚至用户而改变。

不过，我确实觉得这很奇怪。我目前正在自己​​构建一个小型 MVC 框架，但它与我使用的大多数框架略有相反。我将控制器逻辑放在访问的文件中。例如，index.php 将包含 IndexController 及其操作。这种方法至少对我很有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T21:35:18.160

由于大多数 php mvc 框架都使用某种 url 重写，或者至少自己解析 index.php 之后的任何内容，因此**需要**一个入口点。

除此之外，我喜欢为每个上下文提供入口点，比如 web(/soap)/console/...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-20T23:37:59.593

顺便说一句，人们通常认为，既然有一个 php 页面，它就是一个服务所有请求的页面。有点像排队。

需要注意的重要一点是，每个请求都会创建一个脚本实例，因此负载与同时访问两个不同的页面相同。因此，仍然是相同的负载。几乎。

然而，一些框架可能有一大堆你不需要在入口脚本中进行的东西。有点像满足所有可能场景的包罗万象，这可能会导致负载。

就个人而言，我更喜欢多页面，就像我混合 oop 和程序一样。我喜欢 php 的老派方式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-12T19:47:05.390

使用前端控制器文件架构肯定有缺点。正如 Saem 解释的那样，访问同一个文件通常对性能有利，但正如 Alan Storm 和 Rasmus Lerdorf 解释的那样，试图让代码处理多种情况（例如，前端控制器试图处理对站点上每个“页面”的请求) 导致臃肿而复杂的代码集合。在每次页面加载时使用臃肿而复杂的代码集合可能被认为是不好的做法。

Saem 认为前端控制器可以让您不必在多个位置编辑代码，但我认为在某些情况下，最好通过分离冗余来解决。

拥有一个由 Web 服务器实际使用的目录结构可以使 Web 服务器更简单，对开发人员来说更明显。对于 Web 服务器来说，通过将 url 转换为它们传统上表示的位置来提供文件比将它们重写为新的 URL 更简单。非前端控制器文件架构对开发人员来说可能更明显，因为他们不是从一个臃肿的控制器开始处理所有事情，而是从一个更具体到他们需要开发的文件/控制器开始。

# c# - 将函数（带参数）作为参数传递？

> ID：604048
> 
> 赞同：32
> 
> 时间：2009-03-02T21:21:29.003
> 
> 标签：c#, parameters, delegates

我想创建一个泛型，我可以将函数作为参数传递给它，但是这个函数本身可能包含参数，所以......

```
int foo = GetCachedValue("LastFoo", methodToGetFoo) 
```

这样：

```
protected int methodToGetFoo(DateTime today)
{ return 2; // example only } 
```

本质上，我想要一个方法来检查缓存中的值，否则将根据传入的方法生成值。

想法？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-02T21:25:59.367

听起来你想要一个`Func<T>`：

```
T GetCachedValue<T>(string key, Func<T> method) {
     T value;
     if(!cache.TryGetValue(key, out value)) {
         value = method();
         cache[key] = value;
     }
     return value;
} 
```

然后调用者可以用多种方式包装它；对于简单的功能：

```
int i = GetCachedValue("Foo", GetNextValue);
...
int GetNextValue() {...} 
```

或者在涉及参数的地方，一个闭包：

```
var bar = ...
int i = GetCachedValue("Foo", () => GetNextValue(bar)); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-10-28T09:12:45.403

使用`System.Action`和 lambda 表达式（匿名方法）。例如：

```
public void myMethod(int integer) {     
    // Do something
}

public void passFunction(System.Action methodWithParameters) {
    // Invoke
    methodWithParameters();
}

// ...

// Pass anonymous method using lambda expression
passFunction(() => myMethod(1234)); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T21:27:13.233

您可以创建自己的委托，但在 C# 3.0 中，您可能会发现使用内置`Func<T>`委托系列来解决此问题更方便。例子：

```
public int GetCachedValue(string p1, int p2,
                          Func<DateTime, int> getCachedValue)
{
    // do some stuff in here
    // you can call getCachedValue like any normal function from within here
} 
```

此方法将采用三个参数：一个字符串、一个 int 和一个接受 DateTime 并返回一个 int 的函数。例如：

```
int foo = GetCachedValue("blah", 5, methodToGetFoo);   // using your method
int bar = GetCachedValue("fuzz", 1, d => d.TotalDays); // using a lambda 
```

框架中存在不同`Func<T, U, V...>`的等类型以适应具有不同数量参数的方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T21:28:11.890

为方法创建委托`methodToGetFoo`

```
public delegate object GenerateValue(params p);
public event GenerateValue OnGenerateValue; 
```

定义 GetCachedValue 以使用委托

```
int GetCachedValue(string key, GenerateValue functionToCall); 
```

然后在 OnGenerateValue 的实现中，您可以检查参数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T22:01:05.943

[这](http://xacc.wordpress.com/2008/10/20/simple-memomization-with-linq/)是我开始的一些简单的事情，可以更进一步（就像我为商业项目所做的那样）。

在我的情况下，这是为了缓存 Web 服务调用，并且使用了类似的东西：

```
WebService ws = new WebService();
var result = ws.Call( x => x.Foo("bar", 1));  // x is the ws instance 
```

# c++ - 从微软的 STL 切换到 STLport

> ID：604050
> 
> 赞同：15
> 
> 时间：2009-03-02T21:22:34.447
> 
> 标签：c++, windows, visual-studio, performance, stl

我在 Windows 下的性能关键 C++ 代码中使用了相当多的 STL。获得一些额外性能的一种可能的“廉价”方法是更改​​为更快的 STL 库。

根据这篇[文章](http://garrys-brain.blogspot.com/2007/01/development-stlport-versus-microsoft.html)，STLport 更快并且使用更少的内存，但是它已经有几年的历史了。

最近有没有人做出这个改变，你的结果是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T09:05:33.430

我没有将 STLPort 的性能与 MSCVC 进行比较，但如果有*显着*差异，我会感到惊讶。（当然在发布模式下 - 调试版本可能会完全不同。）不幸的是，您提供的链接 - 以及我见过的任何其他比较 - 细节太少而无用。

在考虑更改标准库提供程序之前，我建议您深入分析您的代码以确定瓶颈所在。这是标准建议；在尝试任何性能改进之前始终配置文件！

即使分析确实揭示了标准库容器或算法中的性能问题，我还是建议您首先分析*一下您是如何使用它们*的。算法改进和适当的容器选择，特别是考虑到 Big-O 成本，*更有*可能带来更大的性能回报。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-03T15:19:05.340

在进行切换之前，请务必在关闭[检查迭代器的情况下测试 MS（实际上是 Dinkumware）库。](http://www.codeproject.com/KB/stl/checkediterators.aspx)出于某种奇怪的原因，即使在发布版本中它们也会默认打开，这在性能方面有很大的不同。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-06-04T12:15:05.587

我们最近做了相反的任务。我们的应用程序是一个跨平台的 C++ 服务器程序，它构建在带有 VS 2008 (x86) 的 Windows 和带有 gcc 4.3 的 HP-UX ia64 和 Linux 上。在每个平台上，我们都使用 STLport 5.1.7 作为 STL 库和 Boost 1.38。

为了比较性能，前段时间我们还构建了没有 STLport 的应用程序，然后我们测量了性能。

之后在 Windows 上的性能变得稍微好一些。所以我们选择停止在 VS 2008 中使用 STLport 并使用默认的 VS 2008 STL 库。

在 HP-UX ia64 上，性能下降了 20%。Caliper（HP-UX 分析器）显示字符串分配需要更多时间。在默认的 gcc STL 库中的字符串赋值内部有对 pthread_mutex_unock 的调用。据我所知，使用 pthread_mutex_lock/pthread_mutex_unlock 是因为默认 gcc 的 STL 库使用 COW 字符串。在我们的应用程序中，我们进行了大量的字符串分配，并且由于 COW 字符串，我们得到了更差的性能。所以我们仍然在 HP-UX 上使用 STLPort 和 gcc。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-03T05:51:17.437

在我从事的一个大量使用 stl 的项目中，切换到 STLport 导致完成任务的时间是 Microsoft 的 STL 实现时间的一半。这不是证据，但我猜这是表现的一个好兆头。我相信这部分归功于 STLport 先进的内存管理系统。

我确实记得在进行此更改时收到了一些警告，但没有什么不能快速解决。作为一个缺点，我要补充一点，使用 Visual Studio 的调试器进行 STLport 调试比使用 Microsoft 的 STL 更容易（更新：似乎有一种方法可以向调试器解释如何处理 STLport 容器，感谢 Jalf！）。

最新版本可以追溯到 2008 年 10 月，因此仍有人在研究它。请参阅[此处](http://sourceforge.net/projects/stlport/)下载。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-09-18T19:50:19.533

一年前我做了完全相反的事情，原因如下：

*   StlPort 很少更新（据我所知只有一位开发人员正在开发它，您可以查看他们的提交[历史](http://gitorious.org/stlport)）
*   每当您切换到新的 Visual Studio 版本时，都会出现构建它的问题。您等待新的 make 文件或您自己创建它，但有时您无法构建它，因为您正在使用某些配置选项。然后你等待他们建造它。
*   当您提交错误报告时，您将永远等待，因此基本上没有支持（也许如果您付费）。如果你知道怎么做，你通常最终会自己修复它。
*   Visual Studio 中的 STL 已[检查迭代器](http://msdn.microsoft.com/en-us/library/aa985965(v=VS.100).aspx)和[调试迭代​​器支持](http://msdn.microsoft.com/en-us/library/aa985982(v=VS.100).aspx)，这比 StlPort 中的要好得多。这是大多数减速的原因，尤其是在调试中。检查的迭代器在调试和发布中都启用了，这不是每个人都知道的（你必须自己禁用它们）。
*   Visual Studio 2008 SP1 中的 STL 带有 TR1，而您在 StlPort 中没有这个
*   Visual Studio 2010 中的 STL 使用来自 C++0x 的右值引用，这是您获得真正性能优势的地方。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-03T12:45:55.007

如果您使用 STLPort，您将进入一个世界，您使用的每个基于 STL 的第三方库都必须使用 STLPort 重新编译以避免出现问题......

STLPort 确实有不同的内存策略，但如果这是您的瓶颈，那么您的性能增益路径正在更改分配器（例如切换到 Hoard），而不是更改 STL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T21:39:53.407

我没有尝试过，但据我所知，微软的 STL 实现并没有发生重大变化。（VS2008 编译器在 2005 年也没有巨大的新优化）所以如果 STLPort 更快，那么可能仍然如此。

但这只是猜测。:) 如果您尝试一下，请务必报告结果。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-03-03T00:19:05.007

stlport 的一个好处是它是开源的。

# f# - 是什么导致 F# 序列重新枚举？

> ID：604051
> 
> 赞同：2
> 
> 时间：2009-03-02T21:22:50.793
> 
> 标签：f#, sequences

我有一个解析器，它实际上是一组对一系列词法分析器标记进行操作的递归函数。

我遇到的问题是该序列似乎从递归函数调用的开头重新开始。给定以下功能的骨架定义`Parse`

```
 let restricted = Seq.take_while token_search tokens
    let compiled_nodes = Seq.fold (fun list (next: Lexer.Token) -> list @ parse_token this restricted next) [] restricted 
```

该函数`parse_token`可能会导致调用`Parse`.

但是，当这种情况发生时，参数`tokens`最终会定位在序列的开头。

关于如何将序列保持在需要的位置的任何想法？

蒂亚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T22:29:33.100

我认为您可能需要发布一个稍微大一点的片段，因为我并没有完全关注您。

也就是说，一个序列（IEnumerable）就是一个序列，每次你 for (foreach) 或 Seq.Whatever 时，它都会“重新迭代”这个序列。我不清楚您想要做什么，以及您期望发生什么，但是对于解析，将“令牌”表示为序列可能是“错误的”，因为您通常将令牌划分为消耗/提交区域和前瞻区域。

另请注意，您通常不希望“迭代序列”产生副作用。

# c# - C#中的抽象与真实类继承

> ID：604058
> 
> 赞同：1
> 
> 时间：2009-03-02T21:24:22.680
> 
> 标签：c#, .net, inheritance, class

我想知道在使用抽象类和真实类进行继承时，派生类是否有任何区别？

在我看来，真正的类继承创建了一个层次结构，而抽象类继承只是将编译器的代码复制粘贴到派生类？

抽象类是否创建层次结构？可以使用特殊关键字访问吗？

我知道你使用base关键字访问基类，但是抽象成员看起来就像派生类中的原始成员？

最后两者之间的性能差异是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T21:26:24.997

是的，抽象类确实存在——编译器不进行复制粘贴。您不会发现任何性能差异，因为 CLR 仍然必须执行虚拟方法调用。

例如下面的 C#：

```
abstract class Foo { }

class Bar : Foo { } 
```

生成以下 IL：

```
.class private abstract auto ansi beforefieldinit Foo
    extends [mscorlib]System.Object { }

.class private auto ansi beforefieldinit Bar
    extends Foo { } 
```

抽象类型的概念在很大程度上是 IL 的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T21:26:35.903

唯一的区别是抽象基类不能在没有派生的情况下被实例化，而非抽象基类可以。从派生类的角度来看，一切都是一样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-06T08:42:02.557

抽象类的强大之处在于它的未实现。它可用于确信派生类的实例将具有所需的全部功能

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-18T15:36:59.003

抽象类是基类的原始形式。这些无法实例化，这意味着开发人员必须从这些类派生才能使用它们的功能。抽象类中定义的任何抽象方法都必须在其子类中实现。因此，可以实现必须存在于从抽象类派生的子类中的方法。因此，您可以定义对象的基本元素，开发人员可以在派生类中随意自定义这些元素。

非抽象类最好用于扩展类功能，同时继续使用非抽象类中的内容。派生类可以访问所有非私有成员和方法。

# ruby-on-rails - 如何在 Rails 中为具有多个关键字段的资源定义 RESTful 路由？

> ID：604062
> 
> 赞同：4
> 
> 时间：2009-03-02T21:25:58.477
> 
> 标签：ruby-on-rails, resources, rest, primary-key, routes

我的用户模型具有通常的`id`主键，但它也有一个`login`可以用作标识符的唯一键。因此，我想定义路由，以便用户可以通过 id 或登录访问。理想情况下，路线应该是这样的：

```
/users/:id (GET) => show (:id)
/users/:id (PUT) => update (:id)
...

/users/login/:login (GET) => show (:login)
/users/login/:login (PUT) => update (:login)
... 
```

执行此操作（或类似方法）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T01:42:36.863

到目前为止，我能想到的最好的是：

```
map.resources :users

map.resources :users_by_login,
     :controller => "User",
     :only => [:show, :edit, :update, :destroy],
     :requirements => {:by_login => true} 
```

为用户创建了通常的 RESTful 路由，除此之外，`users_by_login`资源添加了以下路由（并且仅添加了这些路由）：

```
GET    /users_by_login/:id/edit
GET    /users_by_login/:id/edit.:format
GET    /users_by_login/:id
GET    /users_by_login/:id.:format
PUT    /users_by_login/:id
PUT    /users_by_login/:id.:format
DELETE /users_by_login/:id
DELETE /users_by_login/:id.:format 
```

这些路由实际上也映射到了`UserController`（仅适用于`show`///方法`edit`）`update`。`destroy`添加了一个额外的`by_login`参数（等于`true`）：这样，这些`UserController`方法可以判断该`id`参数是代表登录名还是 id。

它可以完成工作，但我希望有更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T02:31:35.403

只需检查传递给控制器​​方法的 ID 是否为整数。

```
if params[:id].is_a?(Integer)
    @user = User.find params[:id]
else
    @user = User.find_by_login params[:id] 
```

无需添加特殊路线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T02:47:49.827

实际上，Kyle Boon 的想法是正确的。但它有点偏离。当 params 变量出现时，所有值都存储为字符串，因此他的示例每次都会返回 false。你可以做的是：

```
if params[:id].to_i.zero?
@user = User.find_by_login params[:id]
else
@user = User.find params[:id]
end 
```

这样，如果 :id 是一个实际的字符串，Ruby 只需将其转换为 0。您可以通过使用 ruby​​-debug gem 查看 params 哈希来测试这一点。

（我本来只是发表评论，但我还没有足够的经验来做这件事；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T01:32:48.527

不完全确定您在这里做什么，但这可能会有所帮助。

[您可以通过添加:member 或 :collection](http://www.railsbrain.com/api/rails-2.2.2/doc/index.html?a=M000255&name=resources)选项来定义 rails 提供的自动 RESTful 路由之外的操作。

```
map.resources :users, :member => { :login => [:post, :get] } 
```

这将生成如下所示的路由：

```
/users/:id (GET)
...
/users/:id/login (GET)
/users/:id/login (POST) 
```

您可以做的另一件事是使用登录作为您查找的属性（假设它是唯一的）。查看 Ryan Bates的[截屏视频](http://railscasts.com/episodes/63-model-name-in-url)。在您的控制器中，您将拥有：

```
def show
@user = User.find_by_login(params[:id])
...
end 
```

他还有另一个[截屏视频](http://railscasts.com/episodes/34-named-routes)可以帮助你。第二个谈论自定义命名路线。

# c# - 设置项目 COM 注册

> ID：604075
> 
> 赞同：2
> 
> 时间：2009-03-02T21:27:37.600
> 
> 标签：c#, visual-studio, interop, installation, bho

我有一个使用 COM 互操作用 C#/.NET 2.0 编写的 IE BHO（工具栏）。我正在使用 Visual Studio 2005 使用安装项目为我的工具栏生成一个 MSI 安装程序。

**在我的程序集中，我有使用ComRegisterFunctionAttribute**的 COM 注册/取消注册方法，它设置注册表项，为 IE 提供有关我的工具栏的一些关键信息（如工具栏的名称）。**在我的设置项目中，我使用vsdrpCOMRelativePath**属性为 COM 注册我的 dll （参见下面的代码）。

当我使用 MSI 安装时，工具栏功能正常，但我有一个烦人的问题：当我启动 IE 并选择我的工具栏时，它出现在有效工具栏列表中，但它具有完全限定的类名：“ *MyToolbar .IEHelperToolbar* ”而不是普通名称：“ *IEHelperToolbar* ”

似乎安装项目生成的 MSI 没有调用我在程序集中定义的自定义注册方法。我得出这个结论是因为如果我使用 regasm.exe 注册 dll，IE 会显示正确的名称。

我应该在我的安装项目中使用不同的注册设置，还是应该遵循这篇[文章](https://stackoverflow.com/questions/12807/how-to-register-com-from-vs-setup-project)中的方法：，或者我应该放弃 VS2005 安装项目并转到 WIX 之类的东西，还是我离基地很远？

这是我的注册/注销功能：

```
 /// <summary>
/// Called when derived class is registered as a COM server.
/// </summary>
[ComRegisterFunctionAttribute]
public static void Register(Type t)
{
    string guid = t.GUID.ToString("B");

    RegistryKey rkClass = Registry.ClassesRoot.CreateSubKey(@"CLSID\" + guid);
    RegistryKey rkCat = rkClass.CreateSubKey("Implemented Categories");

    ToolbarAttribute[] boa = (ToolbarAttribute[])t.GetCustomAttributes(
        typeof(ToolbarAttribute),
        false);

    string name = t.Name;
    string help = t.Name;
    ToolbarStyle style = 0;
    if (boa.Length == 1)
    {
        if (boa[0].Name != null)
            name = boa[0].Name;

        if (boa[0].HelpText != null)
            help = boa[0].HelpText;

        style = boa[0].Style;
    }

    rkClass.SetValue(null, name);
    rkClass.SetValue("MenuText", name);
    rkClass.SetValue("HelpText", help);

    if (0 != (style & ToolbarStyle.Vertical))
        rkCat.CreateSubKey("{00021493-0000-0000-C000-000000000046}");

    if (0 != (style & ToolbarStyle.Horizontal))
        rkCat.CreateSubKey("{00021494-0000-0000-C000-000000000046}");

    if (0 != (style & ToolbarStyle.TaskbarToolBar))
        rkCat.CreateSubKey("{00021492-0000-0000-C000-000000000046}");

    if (0 != (style & ToolbarStyle.ExplorerToolbar))
        Registry.LocalMachine.CreateSubKey(@"SOFTWARE\Microsoft\Internet Explorer\Toolbar").SetValue(guid, name);

}

/// <summary>
/// Called when derived class is unregistered as a COM server.
/// </summary>
[ComUnregisterFunctionAttribute]
public static void Unregister(Type t)
{
    string guid = t.GUID.ToString("B");
    ToolbarAttribute[] boa = (ToolbarAttribute[])t.GetCustomAttributes(
        typeof(ToolbarAttribute),
        false);

    ToolbarStyle style = 0;
    if (boa.Length == 1) style = boa[0].Style;

    if (0 != (style & ToolbarStyle.ExplorerToolbar))
        Registry.LocalMachine.CreateSubKey(@"SOFTWARE\Microsoft\Internet Explorer\Toolbar").DeleteValue(guid, false);

    Registry.ClassesRoot.CreateSubKey(@"CLSID").DeleteSubKeyTree(guid);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-30T18:58:23.567

（非常）迟到的响应，但这些问题很好地讨论了如何使用和安装程序类以及安装项目来完成此操作：

*   [如何从 Visual Studio 2008 安装项目中使用 regasm 注册 .NET CCW](https://stackoverflow.com/questions/239465/how-to-register-a-net-ccw-with-regasm-from-a-visual-studio-2008-setup-project)

*   [如何使用 RtdServer 在 C# 中创建实时 Excel 自动化加载项？](https://stackoverflow.com/questions/5397607/how-do-i-create-a-real-time-excel-automation-add-in-in-c-using-rtdserver)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-31T17:32:02.193

与 VS2005 一起打包的安装程序对于需要 COM 注册的项目来说非常糟糕。几年前，我花了大约 2 天的时间试图让它正常工作，然后发现了免费的 NSIS 安装程序，并且再也没有回头。

看一下：

[http://nsis.sourceforge.net/Main_Page](http://nsis.sourceforge.net/Main_Page)

# entity-framework - 在 Entity SQL 中比较日期

> ID：604077
> 
> 赞同：0
> 
> 时间：2009-03-02T21:28:24.573
> 
> 标签：entity-framework, .net-3.5, entity-sql

比较日期的正确 eSQL 语法是什么？

等效的 LINQ-to-Entities 表达式如下所示：

```
var lastYearsShipments = from p in MyDataServiceContext.Products
                         where p.ShipDate.Value.Year == DateTime.Now.Year - 1
                         select p; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T21:45:26.467

他们说[回答你自己的问题是可以接受的](https://stackoverflow.com/questions/18557/how-does-stackoverflow-work-the-official-faq/119658#119658)，所以这里......

```
var predicate = string.Format(
    "Year(it.ShipDate) == Year(cast('{0}' as System.DateTime)) -1",
    System.DateTime.Now);

var lastYearsShipments = 
    myQuery.Products.Where(predicate); // myQuery is type ObjectQuery<T> 
```

另请参阅：[msdn 文档](http://msdn.microsoft.com/en-us/library/bb738563.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-25T16:47:49.027

```
string datetimeFormatter = "yyyy-MM-dd HH:mm";

var predicate = string.Format("Year(it.ShipDate) == Year(DATETIME'{0}')) -1", System.DateTime.Now.ToString(datetimeFormatter)); 

var lastYearsShipments = myQuery.Products.Where(predicate); 
```

# python - 寻找关于神经网络的良好参考

> ID：604078
> 
> 赞同：11
> 
> 时间：2009-03-02T21:28:31.890
> 
> 标签：python, neural-network

### 复制

> [有哪些学习人工神经网络的好资源？](https://stackoverflow.com/questions/478947/what-are-some-good-resources-for-learning-about-neural-networks)

我正在寻找一本关于不同类型的神经网络/它们的应用程序/示例的好的（初级）参考书（或网站）。我没有考虑任何特定的应用程序，我只是好奇如何使用它们。我对将它们与 Python 一起使用特别感兴趣，但任何语言，甚至只是理论都可以。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T08:58:55.067

[Heaton Research](http://www.heatonresearch.com/course/intro-neural-nets-cs)提供相当广泛的系列课程。该课程适用于 C#（也适用于 Java），但它详细解释了这些概念，因此即使您自己使用 python 编写代码，我也建议您看一看。

课程采用视频格式，但也记录了最重要的概念。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T05:29:20.547

请参阅以下三个使用 Python 的神经网络链接：

[神经网络简介](http://www.ibm.com/developerworks/library/l-neural/)

[用 Python 编织一个神经网络](http://www-128.ibm.com/developerworks/library/l-neurnet/?ca=dgr-lnxw961NeuralNet)

[Pyro 中的神经网络](http://pyrorobotics.com/?page=PyroModuleNeuralNetworks)

罗恩斯蒂芬斯

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T09:16:52.717

Toby Segaran 的“[集体智能编程](http://oreilly.com/catalog/9780596529321/)”有一章是关于 NN 的，还有一些 Python 示例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-24T09:55:08.483

您可能想试试David Kriesel[的神经网络简介](http://www.dkriesel.com/en/science/neural_networks)。这是一本插图丰富的电子书，可免费获得。它涵盖了许多网络范式，并且没有 Rojas 的电子书那么理论化。似乎是您可以免费获得的网络上最好的

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T21:37:47.373

[AI-Junkie](http://www.ai-junkie.com/)有一个非常好的关于神经网络的直观教程。该站点旨在最大程度地减少所需的数学知识，以便可以访问该教程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T22:36:04.270

我目前正在使用[这个站点](http://www.willamette.edu/~gorr/classes/cs449/intro.html)作为入门 - 不是 python，而是一个很好的前馈网络示例，并且非常简单易懂。

与此同时，我一直在阅读 Robert Callan 的 The Essence of Neural Networks（ISBN 0-13-908732-X），它具有广泛的网络架构和应用，并且很容易阅读。

既然你提到了 python，我应该引导你到[这个 IBM 站点](http://www.ibm.com/developerworks/library/l-neural/)，我发现它非常有用，并且底层代码在 python[中](http://arctrix.com/nas/python/bpnn.py)。引文应归[Neil Schemenauer](http://arctrix.com/nas/)。

我还应该提到，我使用了 python 代码并将其移植到 numpy，因为它运行得非常慢。我没有成功，但在我垃圾 numpy 之前，我不得不说我怀疑我的实现不是很好，我确信有一种矢量化的方式来进行前向传播和反向传播，我只是没有找到它。

我最终做的是通过一个简单的python代码端口在Java中实现。这只花了一个小时左右，它的运行速度提高了大约 100 倍。我认为这更能证明我不知道我在用 numpy 做什么，但如果你从头开始，我会质疑原始 python 是否适合你。如果你必须使用 python，你可能会更好地用 C 或 C++ 编写这种东西。

祝你好运。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-18T00:51:24.927

我认为上面给出的答案涵盖了 python 位。至于“甚至只是理论”，劳尔·罗哈斯 ( [Raúl Rojas](http://en.wikipedia.org/wiki/Ra%C3%BAl_Rojas) ) 有一本厚厚的电子书，您可以从[他的 wiki 页面](http://en.wikipedia.org/wiki/Ra%C3%BAl_Rojas)下载。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-03-02T17:39:45.627

最好的参考资料是 Bishop 的“ **Neural Networks for Pattern Recognition** ”。另一**本好书是 Haykin 的《神经网络和学习机器**》。

更实用的参考资料包括[Matlab 的神经网络工具箱](http://www.mathworks.es/help/toolbox/nnet)或[开源神经网络 C++ 库洪水](http://www.cimne.com/flood)的用户指南。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-03T14:54:19.720

[常见问题解答 ANN](ftp://ftp.sas.com/pub/neural/FAQ.html) 新闻组 comp.ai.neural-nets 档案可在线或离线使用

# ruby-on-rails - 使用 Globalize2 (rails) 转换模型

> ID：604084
> 
> 赞同：0
> 
> 时间：2009-03-02T21:31:04.083
> 
> 标签：ruby-on-rails, localization

我正在使用最新的 globalize2 和 rails 2.2。我想知道以下是否是错误或功能：数据集中的每个项目似乎都有一个单独的数据库查询来获取翻译。这听起来不对，因为它可能很容易导致数百个查询。

插图。简单的控制器：

```
def index
    @menu_sections = MenuSection.find(:all)
end 
```

然后 @menu_sections 在视图中循环，其中调用了本地化属性（名称）：

```
 <% @menu_sections.each do |menu_section| %>
    <p><%= link_to menu_section.name, :controller => 'store', :action => 'list_menu_items_for_section', :section_id => menu_section.id %></p>
  <% end %> 
```

看起来每个 menu_section.name 都会导致数据库查询：

```
处理 StoreController#index（2009-03-02 16:05:53 的 10.0.2.2）[GET]
  会话 ID：468f54928cbdc0b19c03cfbd01d09fa9
  参数：{"action"=>"index", "controller"=>"store"}
  MenuSection 加载 (0.0ms) SELECT * FROM `menu_sections`
在布局/商店中渲染模板
渲染存储/索引
渲染的应用程序/_js_includes (0.0ms)
  MenuSection Columns (0.0ms) SHOW FIELDS FROM `menu_sections`
  MenuSectionTranslation 加载 (0.0ms) SELECT * FROM `menu_section_translations` WHERE (`menu_section_translations`.menu_section_id = 1 AND (`menu_section_translations`.`locale` IN ('en','root')))
  MenuSectionTranslation Columns (0.0ms) SHOW FIELDS FROM `menu_section_translations`
  MenuSectionTranslation Load (0.0ms) SELECT * FROM `menu_section_translations` WHERE (`menu_section_translations`.menu_section_id = 2 AND (`menu_section_translations`.`locale` IN ('en','root')))
  MenuSectionTranslation Load (0.0ms) SELECT * FROM `menu_section_translations` WHERE (`menu_section_translations`.menu_section_id = 3 AND (`menu_section_translations`.`locale` IN ('en','root')))
在 340 毫秒内完成（查看：320，DB：0）| 200 OK [http://www.dev.babooka.com/store]

```

你怎么看？也许有更好的方法可以在 Rails 中翻译 db 数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-16T22:46:18.897

你可以通过说类似的话来完成你想做的事情：

```
def index
    @menu_sections = MenuSection.find(:all,:include=>:globalize_translations)
end 
```

这将急切加载翻译，因此只有 2 个查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-17T14:02:09.363

我不知道你是否喜欢这个问题。但我遇到了同样的问题。我只翻译表格的一列（比如标题）。如果我在一个表中有 100 行并且如果我对给定的语言环境进行这样的查询：

rows = Category.find(:all, .....)

它将导致对数据库的 101 次查询！我不确定这是否是 Globalize 的设计者所期望或有意的。

或者我遗漏了一些东西（比如查询中的可选配置参数）。

但是，我确实找到了 Saimon Moore 的替代解决方案，他实施了 Globalize Model Translations 的替代实现。你可以阅读它：

[http://saimonmoore.net/2006/12/1/alternative-implementation-of-globalize-model-translations](http://saimonmoore.net/2006/12/1/alternative-implementation-of-globalize-model-translations)

但是，如果这适用于 Globalize2，我找不到任何参考资料。

我正在抛弃 Globalize2 插件并使用 Ruby I18N 库推出我自己的解决方案。

# javascript - jQuery等效选择器

> ID：604097
> 
> 赞同：3
> 
> 时间：2009-03-02T21:35:49.140
> 
> 标签：javascript, jquery

以下是完全等价的吗？你使用哪个成语，为什么？

```
$('#form1 .edit-field :input')
$('#form1 .edit-field').find(':input')
$('.edit-field :input', '#form1')
$(':input', '#form1 .edit-field') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T22:16:57.763

我会使用＃2或＃4：

```
$('#form1 .edit-field').find(':input')
$(':input', '#form1 .edit-field') 
```

以上两者本质上是一样的。当您指定上下文时，幕后就是这样：

```
jQuery( context ).find( selector ); 
```

我会避免 #1 和 #3 的原因是因为它们都比 #2/#4 慢得多。

* * *

编辑：刚刚做了一个快速测试：使用您的选择器的 1000 个输入元素：

```
$('#form1 .edit-field :input')            // 55ms
$('#form1 .edit-field').find(':input')    // 21ms
$('.edit-field :input', '#form1')         // 47ms
$(':input', '#form1 .edit-field')         // 18ms 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T22:13:43.170

在比较元素选择时，前两个是等效的。然而，第二种形式，当在带有相应`end()`调用的命令链中使用时，可用于在“#form1 .edit-field”中选择更多的子元素，即：

```
$('#form1 .edit-field').find(':input')
   ...
.end().find(':hidden')...
.end()... 
```

我不确定后两种形式，实际上，我相信它们是无效的。如果我错了，请纠正我，但根据文档，正确的语法如下所示：

```
$('.edit-field :input', $('#form1'))
$(':input', $('#form1 .edit-field')) 
```

无论哪种方式，恕我直言，这些都是不太简洁的说法。

总之，通常我会坚持第一种形式，除非你利用第二种形式的优势来遍历更多的孩子，如上所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T22:15:40.963

我在 jQuery 中编写的代码越多，我使用选择器的次数就越少，而是越多地遍历。我会做：

```
$('#form1').find('.edit-field').find(':input') 
```

它更长，但更好地传达了选择过程，每个步骤都具有更多意义。遍历更有利于链接，它使 end() 有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T22:36:46.903

我会根据我已经拥有的以及我还需要使用的元素使用不同的形式。例如，如果我需要处理同一表单中的其他字段，我将保存对 $('#form1') 的引用以保存多次搜索。

# c - 什么是双星（例如 NSError **）？

> ID：604099
> 
> 赞同：54
> 
> 时间：2009-03-02T21:37:11.103
> 
> 标签：c, objective-c, cocoa, pointers, multiple-indirection

所以，我看到了这个：

```
error:(NSError **)error 
```

在苹果文档中。为什么是两星？有什么意义？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-03-02T21:42:28.097

“双星”是指向指针的指针。`NSError **`指向指向类型对象的指针也是如此`NSError`。它基本上允许您从函数返回错误对象。您可以在函数中创建指向`NSError`对象的指针（调用它`*myError`），然后执行以下操作：

```
*error = myError; 
```

将该错误“返回”给调用者。

* * *

回复下面发布的评论：

您不能简单地使用 an，`NSError *`因为在 C 中，函数参数是*按值*传递的——也就是说，值在传递给函数时会被*复制。*为了说明，请考虑以下 C 代码片段：

```
void f(int x)
{
    x = 4;
}

void g(void)
{
    int y = 10;
    f(y);
    printf("%d\n", y);    // Will output "10"
} 
```

`x`in的重新分配`f()`不会影响参数在外部的值`f()`（`g()`例如 in ）。

同样，将指针传递给函数时，会复制其值，并且重新分配不会影响函数外部的值。

```
void f(int *x)
{
    x = 10;
}

void g(void)
{
    int y = 10;
    int *z = &y;
    printf("%p\n", z);    // Will print the value of z, which is the address of y
    f(z);
    printf("%p\n", z);    // The value of z has not changed!
} 
```

当然，我们知道我们可以`z`很容易地更改指向的值：

```
void f(int *x)
{
    *x = 20;
}

void g(void)
{
    int y = 10;
    int *z = &y;
    printf("%d\n", y);    // Will print "10"
    f(z);
    printf("%d\n", y);    // Will print "20"
} 
```

所以按理说，要改变 an 所`NSError *`指向的值，我们还必须将指针传递给该指针。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-03-02T21:44:01.820

在 C 中，一切都是按值传递的。如果你想改变一些东西的值，你传递它的地址（它传递内存地址的值）。如果要更改指针指向的位置，请传递指针的地址。

[看看这里的简单解释](http://www.eskimo.com/~scs/cclass/int/sx8.html)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-02T21:40:52.717

在 C 中，双星是指向指针的指针。这样做有几个原因。首先是指针可能指向一个指针数组。另一个原因是将指针传递给函数，函数修改指针（类似于其他语言中的“out”参数）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-04-24T04:58:54.880

双星 ( `**`) 符号并不特定于初始化类中的变量。它只是对对象的双重间接引用。

```
float myFloat; // an object
float *myFloatPtr; // a pointer to an object
float **myFloatPtrPtr; // a pointer to a pointer to an object

myFloat = 123.456; // initialize an object
myFloatPtr = &myFloat; // initialize a pointer to an object
myFloatPtrPtr = myFloatPtr; // initialize a pointer to a pointer to an object

myFloat; // refer to an object
*myFloatPtr; // refer to an object through a pointer
**myFloatPtrPtr; // refer to an object through a pointer to a pointer
*myFloatPtrPtr; // refer to the value of the pointer to the object 
```

双指针表示法用于调用者打算通过函数调用修改其自己的指针之一，因此将指针的地址而不是对象的地址传递给函数。

一个例子可能是使用链表。调用者维护一个指向第一个节点的指针。调用者调用函数来搜索、添加和删除。如果这些操作涉及添加或删除第一个节点，则调用者的指针必须更改，而不是任何节点中的 .next 指针，并且您需要指针的地址来执行此操作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T21:40:01.707

如果它与 C 类似，则**`**`**表示指向指针的指针。

# c - C 会自动为我分配内存吗？

> ID：604104
> 
> 赞同：4
> 
> 时间：2009-03-02T21:38:15.470
> 
> 标签：c, malloc

我只写了几个星期的 C 语言，并没有花时间为自己担心太多`malloc()`。不过，最近，我的一个程序返回了一串幸福的面孔，而不是我期望的真/假值。

如果我创建这样的结构：

```
typedef struct Cell {
  struct Cell* subcells;
} 
```

然后像这样初始化它

```
Cell makeCell(int dim) {
  Cell newCell;

  for(int i = 0; i < dim; i++) {
    newCell.subcells[i] = makeCell(dim -1);
  }

  return newCell; //ha ha ha, this is here in my program don't worry!
} 
```

我最终会访问存储在某个地方的内存中的快乐面孔，或者可能会覆盖以前存在的单元格，还是什么？我的问题是，当我实际上还没有 malloc() 分配适当的内存量时，C 如何分配内存？默认是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-02T21:42:33.447

**简短的回答：**它不是为您分配的。

**稍微长**一点的答案：`subcells`指针未初始化，可能指向*任何地方*。这是一个错误，*您*永远不应该允许它发生。

**更长的答案仍然是：**自动变量在堆栈上分配，全局变量由编译器分配，并且通常占用特殊段或可能在堆中。全局变量默认初始化为零。自动变量没有默认值（它们只是获取在内存中找到的值），程序员负责确保它们具有良好的起始值（尽管许多编译器会在您忘记时尝试提示您）。

您函数中的`newCell`变量是自动的，并且未初始化。你应该解决这个问题。要么`newCell.subcells`立即给出一个有意义的值，要么指向它`NULL`直到你为它分配一些空间。这样，如果您在为其分配一些内存之前尝试取消引用它，您将引发分段冲突。

更糟糕的是，您按值返回 a ，但在尝试填充数组时`Cell`将其分配给 a 。要么返回指向堆分配对象的指针，要么将值分配给本地分配的对象。`Cell *``subcells`

一个通常的习惯用法是这样的

```
Cell* makeCell(dim){
  Cell *newCell = malloc(sizeof(Cell));
  // error checking here
  newCell->subcells = malloc(sizeof(Cell*)*dim); // what if dim=0?
  // more error checking
  for (int i=0; i<dim; ++i){
    newCell->subCells[i] = makeCell(dim-1);
    // what error checking do you need here? 
    // depends on your other error checking...
  }
  return newCell;
} 
```

虽然我给你留下了一些问题要解决..

请注意，您必须跟踪最终需要释放的所有内存位......

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-02T21:42:10.327

您的指针没有默认值。您的指针将指向它当前存储的任何内容。由于您尚未对其进行初始化，因此该行

```
newCell.subcells[i] = ... 
```

有效地访问一些不确定的内存部分。请记住 subcells[i] 等价于

```
*(newCell.subcells + i) 
```

如果左侧包含一些垃圾，您最终将添加`i`一个垃圾值并访问该不确定位置的内存。正如您所说的，您必须初始化指针以指向某个有效的内存区域：

```
newCell.subcells = malloc(bytecount) 
```

在哪一行之后，您可以访问那么多字节。关于其他内存来源，有不同类型的存储都有它们的用途。您获得哪种类型取决于您拥有哪种对象以及您告诉编译器使用哪种存储类。

*   `malloc`返回一个指向没有类型的对象的指针。您可以使指针指向该内存区域，并且对象的类型将有效地成为指向对象类型的类型。内存未初始化为任何值，访问通常较慢。如此获得的对象称为`allocated objects`。
*   您可以全局放置对象。他们的记忆将被初始化为零。对于点，您将获得 NULL 指针，对于浮点数，您也将获得适当的零。您可以依赖适当的初始值。
*   如果您有局部变量但使用`static`存储类说明符，那么您将具有与全局对象相同的初始值规则。内存的分配方式通常与全局对象相同，但这绝不是必要的。
*   如果你有没有任何存储类说明符或 with 的局部变量`auto`，那么你的变量将被分配到堆栈上（即使 C 没有这样定义，这当然是编译器实际上所做的）。您可以获取其地址，在这种情况下，编译器将不得不省略优化，例如将其放入寄存器中。
*   与存储类说明符一起使用的局部变量`register`被标记为具有特殊存储。结果，您无法再获取它的地址。在最近的编译器中，通常不需要再使用`register`了，因为它们具有复杂的优化器。如果您真的是专家，那么如果使用它，您可能会从中获得一些性能。

对象具有相关的存储持续时间，可用于显示不同的初始化规则（正式地，它们仅定义对象至少存活多长时间）。声明为`auto`并`register`具有自动存储持续时间*且未*初始化的对象。如果您希望它们包含某些值，则必须显式初始化它们。如果不这样做，它们将包含编译器在它们开始生命周期之前留在堆栈中的任何内容。由`malloc`（或该系列的另一个函数，如`calloc`）分配的对象已分配存储持续时间。它们的存储也*没有*初始化。一个例外是使用时`calloc`，在这种情况下，内存被初始化为零（“真正的”零。即所有字节 0x00，不考虑任何 NULL 指针表示）。`static`使用和全局变量声明的对象具有静态存储持续时间。它们的存储*被*初始化为零适合它们各自的类型。请注意，对象不能有类型，但获得无类型对象的唯一方法是使用分配的存储空间。（C 中的对象是“存储区域”）。

那么什么是什么？这是固定代码。因为一旦你分配了一块内存，你就无法再找回你分配了多少项目，最好总是将这个计数存储在某个地方。我已经向`dim`获取存储计数的结构引入了一个变量。

```
Cell makeCell(int dim) {
  /* automatic storage duration => need to init manually */
  Cell newCell;

  /* note that in case dim is zero, we can either get NULL or a 
   * unique non-null value back from malloc. This depends on the
   * implementation. */
  newCell.subcells = malloc(dim * sizeof(*newCell.subcells));
  newCell.dim = dim;

  /* the following can be used as a check for an out-of-memory 
   * situation:
   * if(newCell.subcells == NULL && dim > 0) ... */
  for(int i = 0; i < dim; i++) {
    newCell.subcells[i] = makeCell(dim - 1);
  }

  return newCell;
} 
```

现在，dim=2 的情况如下所示：

```
Cell { 
  subcells => { 
    Cell { 
      subcells => { 
        Cell { subcells => {}, dim = 0 }
      }, 
      dim = 1
    },
    Cell { 
      subcells => { 
        Cell { subcells => {}, dim = 0 }
      }, 
      dim = 1
    }
  },
  dim = 2
} 
```

请注意，在 C 中，函数的返回值不需要是对象。根本不需要存储。因此，您不能更改它。例如，以下是不可能的：

```
makeCells(0).dim++ 
```

您将需要一个“免费功能”来再次释放分配的内存。因为分配对象的存储不会自动释放。您必须调用以释放树`free`中每个指针的内存。`subcells`把它写下来作为练习留给你:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T21:41:50.203

相反，未在堆上分配的任何内容（通过`malloc`和类似调用）都在堆栈上分配。因此，在特定函数中创建的任何没有被`malloc`'d 的东西都将在函数结束时被销毁。这包括返回的对象；当堆栈在函数调用后展开时，返回的对象被复制到调用者函数在堆栈上为其留出的空间。

**警告：**如果要返回一个对象，其中包含指向其他对象的指针，请确保指向的对象是在堆上创建的，更好的是，也在堆上创建该对象，除非它不打算生存创建它的函数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T21:43:30.590

> 我的问题是，当我实际上还没有 malloc() 分配适当的内存量时，C 如何分配内存？默认是什么？

不分配内存。您必须明确地在堆栈上或动态地创建它。

在您的示例中，子单元格指向*未定义*的位置，这是一个错误。您的函数应该在某个时候返回指向 Cell 结构的指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T21:43:26.440

局部变量在堆栈上“分配”。堆栈是预先分配的内存量，用于保存这些局部变量。当函数退出时，变量不再有效，将被接下来的任何内容覆盖。

在您的情况下，代码什么也不做，因为它不返回您的结果。此外，当范围退出时，指向堆栈上对象的指针也将不再有效，所以我猜在你的精确情况下（你似乎在做一个链表），你将需要使用 malloc()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T21:45:34.047

> 我最终会访问存储在某个地方的内存中的快乐面孔，或者可能会覆盖以前存在的单元格，还是什么？

你很幸运，你有一张快乐的脸。在那些不幸的日子之一，它可能已经把你的系统擦干净了；）

> 我的问题是，当我实际上还没有 malloc() 分配适当的内存量时，C 如何分配内存？

它没有。但是，当您定义 Cell newCell 时会发生什么，subCells 指针被初始化为垃圾值。这可能是一个 0（在这种情况下你会崩溃）或一些足够大的整数，使它看起来像一个实际的内存地址。在这种情况下，编译器会很高兴地获取那里存在的任何值并将其带回给您。

> 默认是什么？

如果您不初始化变量，*这*就是行为。而且您的`makeCell`功能看起来有点欠发达。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T21:47:05.823

实际上可以分配三个部分 - 数据，堆栈和堆。

在您提到的情况下，它将在堆栈上分配。在堆栈上分配一些东西的问题是它只在函数的持续时间内有效。一旦您的函数返回，该内存就会被回收。所以，如果你返回一个指向堆栈上分配的东西的指针，那个指针将是无效的。如果您返回实际对象（不是指针），则会自动制作对象的副本以供调用函数使用。

如果您已将其声明为全局变量（例如，在头文件中或函数外部），它将被分配在内存的数据部分中。本节中的内存在程序启动时自动分配，并在程序结束时自动释放。

如果您使用 malloc() 在堆上分配某些内容，那么只要您想使用它，该内存就可以使用 - 直到您调用 free() 时它被释放。这使您可以根据需要灵活地分配和取消分配内存（而不是使用全局变量，其中所有内容都预先分配并且仅在程序终止时才释放）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T01:00:20.880

我要假装我是这里的电脑，阅读这段代码......

```
typedef struct Cell {
  struct Cell* subcells;
} 
```

这告诉我：

*   我们有一个称为 Cell 的结构类型
*   它包含一个称为 subcells 的指针
*   指针应该指向 struct Cell 类型的东西

它没有告诉我指针是指向一个 Cell 还是指向 Cell 数组。当一个新的 Cell 被创建时，该指针的值是不确定的，直到一个值被分配给它。在定义指针之前使用指针是个坏消息。

```
Cell makeCell(int dim) {
  Cell newCell; 
```

新的 Cell 结构，带有未定义的子单元指针。所有这一切都是保留一小块内存，称为 newCell，它是 Cell 结构的大小。它不会改变那个记忆中的值——它们可以是任何东西。

```
 for(int i = 0; i < dim; i++) {
    newCell.subcells[i] = makeCell(dim -1); 
```

为了获得 newCell.subcells[i]，计算从子单元格偏移 i，然后*取消引用*。具体来说，这意味着该值是从该内存地址中提取的。举个例子，i==0...然后我们将取消引用子单元指针本身（无偏移）。由于子单元格是未定义的，它可以是任何东西。从字面上看！因此，这将要求内存中某个完全随机的值。无法保证任何结果。它可能会打印一些东西，它可能会崩溃。绝对不应该这样做。

```
 }

  return newCell;
} 
```

每当您使用指针时，在取消引用它之前确保它被设置为一个值是很重要的。鼓励你的编译器尽可能地给你任何警告，许多现代编译器可以捕捉到这种事情。您还可以为指针提供可爱的默认值，例如 0xdeadbeef（是的！这是一个十六进制数字，它也是一个单词，所以看起来很有趣），以便它们脱颖而出。（printf 的 %p 选项有助于显示指针，作为一种粗略的调试形式。调试器程序也可以很好地显示它们。）

# javascript - 可以使用 Javascript 获取当前鼠标坐标吗？

> ID：604118
> 
> 赞同：8
> 
> 时间：2009-03-02T21:41:16.757
> 
> 标签：javascript

可以使用 Javascript 获取当前鼠标坐标吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T21:45:14.547

来源：http: [//javascript.internet.com/page-details/mouse-coordinates.html](http://javascript.internet.com/page-details/mouse-coordinates.html)

```
<form name="Show">
    X
    <input type="text" name="MouseX" value="0" size="4">
    <br>
    Y
    <input type="text" name="MouseY" value="0" size="4">
    <br>
</form>

<script language="JavaScript">
    var IE = document.all ? true : false;
    if (!IE) {
        document.captureEvents(Event.MOUSEMOVE)
    }
    document.onmousemove = getMouseXY;
    var tempX = 0;
    var tempY = 0;
    function getMouseXY(e) {
        if (IE) {// grab the x-y pos.s if browser is IE
            tempX = e.clientX + document.body.scrollLeft;
            tempY = e.clientY + document.body.scrollTop;
        } else {// grab the x-y pos.s if browser is NS
            tempX = e.pageX;
            tempY = e.pageY;
        }
        if (tempX < 0) {
            tempX = 0;
        }
        if (tempY < 0) {
            tempY = 0;
        }
        document.Show.MouseX.value = tempX;
        document.Show.MouseY.value = tempY;
        return true;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:05:56.997

[这](http://www.webreference.com/programming/javascript/mk/column2/)是一个带有演示的紧凑函数，它返回带有 .x 和 .y 坐标的值：

```
function mouseCoords(ev){
    // from http://www.webreference.com/programming/javascript/mk/column2/
    if(ev.pageX || ev.pageY){
        return {x:ev.pageX, y:ev.pageY};
    }
    return {
        x:ev.clientX + document.body.scrollLeft - document.body.clientLeft,
        y:ev.clientY + document.body.scrollTop  - document.body.clientTop
    };
} 
```

（我发现 quirksmode 是 JavaScript 智慧的一个很好的资源。如果你想更深入地挖掘，[这里](http://www.quirksmode.org/js/events_properties.html#position)是函数的一些背景。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T21:43:56.733

这是可以做到的。刚刚google了一下，得到了下面的代码

```
if (IE) { // grab the x-y pos.s if browser is IE
    tempX = event.clientX + document.body.scrollLeft;
    tempY = event.clientY + document.body.scrollTop;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T21:44:56.280

[你可以像这样](http://www.codelifter.com/main/javascript/capturemouseposition1.html)在浏览器中获取鼠标坐标。

# optimization - 取消的分支与常规分支有何不同？

> ID：604119
> 
> 赞同：4
> 
> 时间：2009-03-02T21:41:33.993
> 
> 标签：optimization, assembly, sparc

特别是对于 SPARC 程序集，已取消的分支与常规分支有何不同？

我一直认为，当我需要填充分支指令的 nop 延迟槽时，需要取消分支指令。但是，我认为我在这部分上是不正确的，因为您可以在不取消分支的情况下填充 nop。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-08T18:44:55.773

如果不采用分支，则被取消的分支指令会导致延迟槽中的指令（分支之后的指令）被忽略。

为什么这很重要？因为通常情况下，分支之后的指令都会被执行，即使是分支被取走。这是因为有两个程序计数器，PC 和 NPC。表示正在执行的指令的PC被更新为NPC，即PC+4，同时NPC被更新为分支指令的目标。因此，由于这些事件的时间安排，必须加载下一条指令。如果可以的话，使用这个循环比直接扔掉那个循环更有利可图。然后，我们只需将该指令作为循环的一部分。

```
loop:   someOp                
        someOtherOp
        branch      loop      ;
        delayslotOp           ; will actually be executed, before someOp, after branch 
```

如果我们不能在分支之后使用指令槽，那么我们会在其中插入一个 nop，并且在那个循环中什么都不做。

那么为什么会有不同的指令与取消和非取消分支选项？让我们选择退出循环时会发生什么。如果我们将延迟槽作为循环活动的一部分，我们可能不希望在离开循环时执行该操作。因此，我们将在分支指令的末尾添加“，a”。

[这个页面有一些很好的例子。](http://www.cs.unm.edu/~maccabe/classes/341/labman/node3.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-28T21:31:12.043

根据[SPARC 架构手册 (v9)](http://www.sparc.com/standards/SPARCV9.pdf)：

> **3.2.3 控制转移**
> 
> [...]
> 
> 大多数控制转移指令都有延迟；即，在控制转移到目标地址完成之前，按逻辑顺序紧跟在控制转移指令之后的指令被调度。
> 
> [...]
> 
> 延迟控制转移指令之后的指令称为**延迟指令**。如果不采用分支，延迟控制转移指令中的位（取消位）会导致延迟指令被取消（即无效）。
> 
> **6.3.4 控制转移指令（CTI）**
> 
> [...]
> 
> **编程注意事项**：annul 位增加了编译器在分支后找到有用指令来填充延迟槽的可能性，从而减少了程序执行的指令数量。例如，annul 位可用于从循环中移动指令以填充关闭循环的分支的延迟槽。同样，annul 位可用于将指令从“ifthen-else”程序块的“else”或“then”分支移动到在它们之间进行选择的分支的延迟槽。由于提供了全套条件，编译器可以安排代码（可能颠倒条件的意义），以便可以将来自“else”分支或“then”分支的指令移动到延迟槽。

以下代码显示了两个分支，在第一个中，延迟指令始终执行，在第二个中，如果未采用分支，则延迟指令被取消：

```
cmp   %i3, %i0
ble   %icc, -0x5c
ld    [%l0 - 0x4], %i5  ; executed whether the branch is taken or not

...

cmp   %l1, 0x80
bl,a  %icc, +0x40
ld    [%fp + 0x7c7], %g2    ; annulled if the branch is not taken, executed otherwise 
```

# silverlight - 在 Silverlight 中查找所有 TextBox 控件的通用方法

> ID：604144
> 
> 赞同：11
> 
> 时间：2009-03-02T21:45:38.040
> 
> 标签：silverlight

我在一个页面上有几个 Silverlight 控件，并希望查询所有 TextBox 类型的控件并使其正常工作。

现在我正在处理的 Silverlight 表单*可以*添加更多的 TextBox 控件。所以当我测试一个 TextBox 控件是否有值时，我可以这样做：

```
if (this.TextBox.Control.value.Text() != String.Empty)
{
    // do whatever
} 
```

但我宁愿灵活地在任何 Silverlight 表单上使用它，而不管我拥有多少 TextBox 控件。

关于我将如何去做的任何想法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T09:58:38.700

我已经遇到过这个问题并在这里通知它：http: [//megasnippets.com/en/source-codes/silverlight/Get_all_child_controls_recursively_in_Silverlight](http://megasnippets.com/en/source-codes/silverlight/Get_all_child_controls_recursively_in_Silverlight)

在这里，您有一个通用方法可以在 VisualTree 中递归查找所有文本框：

```
IEnumerable<DependencyObject> GetChildrenRecursively(DependencyObject root)
{
    List<DependencyObject> children = new List<DependencyObject>();
    children.Add(root);
    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(root); i++)
        children.AddRange(GetChildrenRecursively(VisualTreeHelper.GetChild(root, i)));

    return children;
} 
```

使用这种方法来查找所有文本框：

```
var textBoxes = GetChildrenRecursively(LayoutRoot).OfType<TextBox>(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-02T23:25:31.170

听起来您需要一个*递归*例程，例如下面的 GetTextBoxes：

```
void Page_Loaded(object sender, RoutedEventArgs e)
{
    // Instantiate a list of TextBoxes
    List<TextBox> textBoxList = new List<TextBox>();

    // Call GetTextBoxes function, passing in the root element,
    // and the empty list of textboxes (LayoutRoot in this example)
    GetTextBoxes(this.LayoutRoot, textBoxList);

    // Now textBoxList contains a list of all the text boxes on your page.
    // Find all the non empty textboxes, and put them into a list.
    var nonEmptyTextBoxList = textBoxList.Where(txt => txt.Text != string.Empty).ToList();

    // Do something with each non empty textbox.
    nonEmptyTextBoxList.ForEach(txt => Debug.WriteLine(txt.Text));
}

private void GetTextBoxes(UIElement uiElement, List<TextBox> textBoxList)
{
    TextBox textBox = uiElement as TextBox;
    if (textBox != null)
    {
        // If the UIElement is a Textbox, add it to the list.
        textBoxList.Add(textBox);
    }
    else
    {
        Panel panel = uiElement as Panel;
        if (panel != null)
        {
            // If the UIElement is a panel, then loop through it's children
            foreach (UIElement child in panel.Children)
            {
                GetTextBoxes(child, textBoxList);
            }
        }
    }
} 
```

实例化一个空的 TextBox 列表。调用 GetTextBoxes，传入页面上的根控件（在我的例子中，就是 this.LayoutRoot），GetTextBoxes 应该递归循环遍历作为该控件后代的每个 UI 元素，测试它是否是 TextBox（添加它到列表），或者一个面板，它可能有它自己的后代来递归。

希望有帮助。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T22:19:21.877

从最上面的面板中，您可以执行此操作（我的网格称为 ContentGrid）

```
var textBoxes = this.ContentGrid.Children.OfType<TextBox>();
var nonEmptyTextboxes = textBoxes.Where(t => !String.IsNullOrEmpty(t.Text));
foreach (var textBox in nonEmptyTextboxes)
{
    //Do Something
} 
```

但是，这只会找到直接子级的文本框。像下面这样的某种递归会有所帮助，但我认为必须有更好的方法。

```
private List<TextBox> SearchForTextBoxes(Panel panel)
{
    List<TextBox> list = new List<TextBox>();
    list.AddRange(panel.Children.OfType<TextBox>()
        .Where(t => !String.IsNullOrEmpty(t.Text)));

    var panels = panel.Children.OfType<Panel>();
    foreach (var childPanel in panels)
    {
        list.AddRange(SearchForTextBoxes(childPanel));
    }
    return list;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-08-12T09:31:05.847

采用Scott最初[的](https://stackoverflow.com/users/5007/scott-ferguson) [想法](https://stackoverflow.com/questions/604144/generic-method-to-find-all-textbox-controls-in-silverlight/604485#604485)并将其扩展为

1.  使用泛型，因此可以轻松应对多种控件类型。
2.  支持更多容器类型。在我的 WP7 中，我需要支持不是 Panels 的 panaorama、滚动查看器等。因此，这允许支持他们。
3.  最大的问题是字符串比较，尤其是在面板和派生项目上。

代码：

```
private static void GetControls<T>(UIElement uiElement, List<T> controlList) where T : UIElement
{
    var frameworkFullName = uiElement.GetType().FullName;
    if (frameworkFullName == typeof(T).FullName)
    {
        controlList.Add(uiElement as T);
        return;
    }

    if (frameworkFullName == typeof(Panel).FullName ||
        frameworkFullName == typeof(Grid).FullName ||
        frameworkFullName == typeof(StackPanel).FullName)
    {
        foreach (var child in (uiElement as Panel).Children)
        {
            GetControls(child, controlList);
        }
        return;
    }

    if (frameworkFullName == typeof(Panorama).FullName)
    {
        foreach (PanoramaItem child in (uiElement as Panorama).Items)
        {
            var contentElement = child.Content as FrameworkElement;
            if (contentElement != null)
            {
                GetControls(contentElement, controlList);
            }
        }
        return;
    }

    if (frameworkFullName == typeof(ScrollViewer).FullName)
    {
        var contentElement = (uiElement as ScrollViewer).Content as FrameworkElement;
        if (contentElement != null)
        {
            GetControls(contentElement, controlList);
        }
        return;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-08T20:03:15.697

与上述想法类似的逻辑也可以处理具有“内容”属性的控件，例如 TabItems 和 Scrollviewers，其中子级可能嵌入较低级别。查找所有孩子：

```
 IEnumerable<DependencyObject> GetControlsRecursive(DependencyObject root)
   {
       List<DependencyObject> elts = new List<DependencyObject>();
       elts.Add(root);
       string type = root.GetType().ToString().Replace("System.Windows.Controls.", "");
       switch (root.GetType().ToString().Replace("System.Windows.Controls.", ""))
       {
           case "TabItem":
               var TabItem = (TabItem)root;
               elts.AddRange(GetControlsRecursive((DependencyObject)TabItem.Content));
               break;
           case "ScrollViewer":
               var Scroll = (ScrollViewer)root;
               elts.AddRange(GetControlsRecursive((DependencyObject) Scroll.Content));
               break;
           default: //controls that have visual children go here
               for (int i = 0; i < VisualTreeHelper.GetChildrenCount(root); i++) elts.AddRange(GetControlsRecursive(VisualTreeHelper.GetChild(root, i)));
               break;
       }
       return elts;
   } 
```

# rss - 选择 Syndication 格式是否有非技术原因？

> ID：604156
> 
> 赞同：1
> 
> 时间：2009-03-02T21:48:37.067
> 
> 标签：rss, feed, syndication, atom-feed

我有一个项目需要能够为提要阅读器导出数据。是否有非技术原因我应该选择 RSS 而不是 Atom、Atom 而不是 RSS、RSS 的一种风格而不是另一种或其他任何东西？

特别是，我正在寻找诸如低采用率或高采用率、困难/不兼容或与流行的聚合器等类似的东西。我最近才开始在自己的个人生活中每天使用 RSS。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T21:56:38.793

[这](http://www.intertwingly.net/wiki/pie/Rss20AndAtom10Compared)应该是*答案*；）关于我所看到的唯一迫使一个人做出选择的非技术原因是：嘿，[插入任何著名网友]使用RSS！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T21:55:15.147

与 Atom 相比，RSS 的采用率肯定是天文数字，因此，如果您有兴趣成为主流，我建议您提供 RSS 提要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T22:09:23.180

*   RSS 是最广泛支持的，但有时解释会有所不同（当您生成带有嵌入 HTML 的 RSS 时，一些阅读器会使其不可读），但几年前它确实是一个问题，现在它几乎不是问题。
*   Atom 对如何嵌入 HTML 的规范更加清晰，所有支持它的阅读器都做得很好。它有时不受支持，但至少从两年前开始，这又不是一个真正的问题。

因此，大多数差异正在慢慢消失，只需在您选择的语言中选择更好的库。如果两者都很好，包括两者或掷骰子......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T21:51:03.037

我认为 RSS 肯定会成为首选的联合样式。在我个人浏览的数十个提要中，我会说少于 5 个是原子提要。

# mysql - 切换服务器时mysql查询爬取

> ID：604157
> 
> 赞同：0
> 
> 时间：2009-03-02T21:48:53.540
> 
> 标签：mysql

上周我从开发测试中遇到了一个问题，我的一个在开发中完美运行的查询正在我的测试服务器上爬行。

它是通过在查询中的一个索引上添加 FORCE INDEX 来修复的。

现在我已经将相同的数据库加载到生产服务器中（并且它正在使用 FORCE INDEX 命令运行，并且它再次变慢了。

知道什么会导致这样的事情发生吗？testing 和 prod 都运行相同的操作系统和版本的 mysql（与 dev 不同）。

这是查询和解释。

```
 EXPLAIN SELECT showsdate.bid, showsdate.bandid, showsdate.date, showsdate.time,
    -> showsdate.title, showsdate.name, showsdate.address, showsdate.rank, showsdate.city, showsdate.state,
    ->  showsdate.lat, showsdate.`long` , tickets.link, tickets.lowprice, tickets.highprice, tickets.source
    -> , tickets.ext, artistGenre, showsdate.img
    -> FROM tickets
    -> RIGHT OUTER JOIN (
    -> SELECT shows.bid, shows.date, shows.time, shows.title, artists.name, artists.img, artists.rank, artists
    -> .bandid, shows.address, shows.city, shows.state, shows.lat, shows.`long`, GROUP_CONCAT(genres.genre SEPARATOR
    ->  ' | ') AS artistGenre
    -> FROM shows FORCE INDEX (biddate_idx)
    -> JOIN artists ON shows.bid = artists.bid JOIN genres ON artists.bid=genres.bid
    -> WHERE  `long` BETWEEN -74.34926984058 AND -73.62463215942 AND lat BETWEEN 40.39373515942 AND 41.11837284058
    ->  AND shows.date >= '2009-03-02'  GROUP BY shows.bid, shows.date ORDER BY  shows.date, artists.rank  DESC
    ->  LIMIT 0, 30
    -> )showsdate ON showsdate.bid = tickets.bid AND showsdate.date = tickets.date;
+----+-------------+------------+--------+---------------+-------------+---------+------------------------------+--------+----------------------------------------------+
| id | select_type | table      | type   | possible_keys | key         | key_len | ref                          | rows   | Extra                                        |
+----+-------------+------------+--------+---------------+-------------+---------+------------------------------+--------+----------------------------------------------+
|  1 | PRIMARY     | <derived2> | ALL    | NULL          | NULL        | NULL    | NULL                         |     30 |                                              |
|  1 | PRIMARY     | tickets    | ref    | biddate_idx   | biddate_idx | 7       | showsdate.bid,showsdate.date |      1 |                                              |
|  2 | DERIVED     | genres     | index  | bandid_idx    | bandid_idx  | 141     | NULL                         | 531281 | Using index; Using temporary; Using filesort |
|  2 | DERIVED     | shows      | ref    | biddate_idx   | biddate_idx | 4       | activeHW.genres.bid          |      5 | Using where                                  |
|  2 | DERIVED     | artists    | eq_ref | bid_idx       | bid_idx     | 4       | activeHW.genres.bid          |      1 |                                              |
+----+-------------+------------+--------+---------------+-------------+---------+------------------------------+--------+----------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T21:54:38.347

当你问这个关于 dev -> test 差异的问题时，我想我插话了。

您是否尝试过重建索引并重新计算统计信息？通常，强制索引是一个坏主意，因为优化器通常会很好地选择要使用的索引。但是，这假设它有良好的统计数据可供使用，并且索引没有严重碎片化。

**预计到达时间：**

要重建索引，请使用：

```
REPAIR TABLE tbl_name QUICK; 
```

要重新计算统计数据：

```
ANALYZE TABLE tbl_name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T09:47:30.817

测试服务器是否只有 10 条记录而生产服务器只有 1000000000 条记录？这也可能导致不同的执行时间

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T22:08:30.427

两台服务器配置一样吗？听起来您可能正在跨越 MySQL 性能的“临界点”。我会比较 MySQL 配置；可能存在不同的内存参数方式。

# css - IE 与 Firefox 中的行高

> ID：604161
> 
> 赞同：4
> 
> 时间：2009-03-02T21:50:35.783
> 
> 标签：css

我有一个定义了字体大小和行高以及零填充和边距的 H1。但是，IE 中的结果在文本开始之前在顶部有一个额外的填充像素，即使该元素仍然占用相同的垂直空间。

跨浏览器呈现行高的方式是否不一致？

## 款式：

```
h1, h1 a { font-size:32px; line-height:44px; margin:0px;padding:0px;border:0px;} 
```

* * *

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T13:12:52.773

您尚未为`H1`元素设置高度，渲染元素的高度取决于正在渲染的文本。

在 FF 中，没有设置高度，两个不同`H1`的 ' 被渲染在不同的高度，40 和 44 像素，由于不同的字符高度，设置高度后，两个元素都按预期渲染。（FF 与 IE 文本渲染器的差异将解释您发现的差异。）

该`line-height`属性将仅确定文本在围绕字体高度的概念框内垂直放置的位置。（包括上升器（f）和下降器（q））。

强制`height`&`line-height`相同使浏览器可以将文本框放置在相同的位置，无论文本内容如何。

```
h1, h1 a { 
    font-size:32px; 
    line-height:44px;
    height:44px;       /* ++ */
    margin:0px;
    padding:0px;
    border:0px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-05T16:12:35.127

这也可能是一个`vertical metrics`问题。如果字体本身的垂直度量很差，它永远不会正确对齐。使字体在浏览器中一致呈现的唯一方法是修复其垂直度量。

大多数字体提供商允许您在下载字体之前更新和修复字体的垂直指标。不过，他们可能会以不同的方式调用该选项。例如：Fontsquirrel 称之为`Auto-Adjust Vertical Metrics`，myFonts.com 称之为`Line Height Adjustments`。

更多信息：[字体：糟糕的垂直度量会导致跨浏览器的行高呈现不一致。解决方案？](https://stackoverflow.com/questions/33633992/font-poor-vertical-metrics-cause-inconsistent-line-height-rendering-across-brow/)

# javascript - 我们如何使用 DOM 访问单选按钮的值？

> ID：604167
> 
> 赞同：16
> 
> 时间：2009-03-02T21:51:33.580
> 
> 标签：javascript, dom, radio-button

我们如何使用 DOM 访问单选按钮的值？

例如。我们有单选按钮：

```
<input name="sex" type="radio" value="male">

<input name="sex" type="radio" value="female"> 
```

它们位于带有 name 的表单中`form1`。当我尝试

```
document.getElementByName("sex").value 
```

无论检查值如何，它总是返回“男性”。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-11-16T17:15:54.780

只是为了“生成” Canavar 非常有用的功能：

```
function getRadioValue(theRadioGroup)
{
    var elements = document.getElementsByName(theRadioGroup);
    for (var i = 0, l = elements.length; i < l; i++)
    {
        if (elements[i].checked)
        {
            return elements[i].value;
        }
    }
} 
```

...现在将这样引用：

```
getRadioValue('sex'); 
```

奇怪的是，这样的东西还不是prototype.js的一部分。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-10-28T14:50:47.447

令人惊讶的是，没有人建议实际使用 Selector API：

```
document.querySelector('input[name=sex]:checked').value 
```

[浏览器支持不错](http://caniuse.com/#feat=queryselector)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-02T21:58:06.373

如果您需要选择一个，大多数框架都支持这样的功能：

```
//jQuery
$("input[name='sex']:checked").val() 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-02T21:53:25.370

有几种方法。

### 1.在每个输入上放置一个id

```
<input name="sex" id="sex_male" type="radio" value="male">
<input name="sex" id="sex_female" type="radio" value="female"> 
```

然后你可以使用`document.getElementById("sex_male")`

### 2\. 使用类似 PrototypeJS 的东西（jQuery 也可以）

然后你可以做这样的事情：

```
//This loops over all input elements that have a name of "sex"
$$('input[name="sex"]').each( function(elem) {
  //Do something
}); 
```

或者甚至只是为了获得“男性”单选按钮：

```
$$('input[name="sex"][value="male"]').each(function(elem) {
  //Do something
}); 
```

开始使用[Prototype](http://www.prototypejs.org)的一种简单方法是通过在页面的 <head></head> 标记之间添加它来从 Google 包含它：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/prototype/1.6.0.3/prototype.js"></script> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-02T22:00:22.983

您可以通过此方法获取所选收音机的值：

```
<script>
function getRadioValue()
{
    for (var i = 0; i < document.getElementsByName('sex').length; i++)
    {
        if (document.getElementsByName('sex')[i].checked)
        {
            return document.getElementsByName('sex')[i].value;
        }
    }
}
</script> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T22:01:12.607

如果您想要选择一个，但手边没有框架，您可以遍历元素数组以查找选中的那个：

```
for (var i = 0; i < document.form1.sex.length; i++) {
    if (document.form1.sex[i].checked) alert(document.form1.sex[i].value);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T21:56:44.147

如果使用`document.form1.sex`，则会返回一个数组。

`document.form1.sex[0]`= 第一个单选按钮

`document.form1.sex[1]`= 第二个单选按钮

要检查哪个已检查，您需要循环：

```
whoChecked(document.form1.sex)

function whoChecked(fieldName) {
   for(var x=0;x<fieldName.length;x++) {
     if(fieldName[x].checked) {
        return fieldname[x].value
     }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-02T21:59:33.640

```
var list = document.getElementsByName('sex');
for(var i=0;i<list.length;i++){
   if(list[i].type=='radio' && list[i].checked){
      alert(list[i].value);
      break;
   }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T22:00:02.203

```
document.getElementByName("sex").value 
```

你的意思是`getElementsByName('sex')[0].value`？（没有`getElementByName`。）

当然，这总是会选择第一个具有该名称的输入元素——其值确实是男性。然后，您可以使用“.checked”属性检查它是否被选中。

对于这个简单的案例，您可以摆脱：

```
var sex= document.getElementsByName("sex")[0].checked? 'male' : 'female'; 
```

对于一般情况，您必须遍历每个无线电输入以查看哪个被检查。首先获取表单对象可能会更好（在表单上放置一个id并使用`document.getElementById`通常比使用基于'name'的document.forms集合更好），然后访问form.elements.sex来获取列表，如果页面上有任何其他元素具有`name="sex"`属性（可能是表单字段以外的其他元素）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-08-28T15:56:15.940

```
function getEleByName(){
    if(true==document.getElementsByName('gender')[0].checked){
        alert('selected gender is: male');
    }
    else{
        alert('selected gender is: female');
    }
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-08-11T14:18:12.123

*   document.all.sex[0].checked
*   document.all.set[1].checked

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-09-23T20:42:53.493

正如其他人所展示的那样，循环可以完成任务，但它可能比使用循环更简单，如果需要，这将有助于提高性能。此外，它可以是便携式/模块化的，因此可以用于不同的无线电组。

简单示例

```
function getValue(x) {
  alert(x.value);
}
```

```
<input name="sex" type="radio" value="male" onChange="getValue(this)" />
<input name="sex" type="radio" value="female" onChange="getValue(this)" />
```

一个更复杂的例子：

```
function getValue(x){
  alert(x.value);
}
```

```
<fieldset>
  <legend>Sex</legend>
  <label>Male:
    <input name="sex" type="radio" value="male" onChange="getValue(this)"/>
  </label>
  <label>Female:
    <input name="sex" type="radio" value="female" onChange="getValue(this)" />
  </label>
</fieldset>
<fieldset>
  <legend>Age Group</legend>
  <label>0-13:
    <input name="ageGroup" type="radio" value="0-13" onChange="getValue(this)" />
  </label>
  <label>13-18:
    <input name="ageGroup" type="radio" value="13-18" onChange="getValue(this)" />
  </label>
  <label>18-30:
    <input name="ageGroup" type="radio" value="13-18" onChange="getValue(this)" />
  </label>
  <label>30+:
    <input name="ageGroup" type="radio" value="13-18" onChange="getValue(this)" />
  </label>
</fieldset>
```

# wpf - 如何将 WPF DataGridTemplateColumn 中的控件绑定到 DataTable？

> ID：604171
> 
> 赞同：1
> 
> 时间：2009-03-02T21:53:07.603
> 
> 标签：wpf, datagrid, binding, datatable

我有一个绑定到 DataTable 的 DataGrid，我想为使用 DataGridTemplateColumn 创建自定义列，但我不确定如何引用 DataTable 单元格中的值。我在网上看到的每个示例要么绑定 DataTable 并且不更改模板，要么使用自定义对象并引用绑定对象的属性。有谁知道如何从 DataGridTemplateColumn 的控件中引用存储在 DataTable 中的值？

谢谢，布赖恩

编辑：我现在看到我可以使用数据表中列的名称作为绑定路径。不幸的是，我打算尝试动态地将模板分配给列，所以我不知道当前列的名称。是否有另一种方法可以做我想做的事情（以编程方式为 DataGrid 中的每一列或单元格分配一个模板）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-20T17:04:56.210

我遇到了同样的问题，我不得不说微软为 WPF DataGrid 提供的文档完全是垃圾。我在互联网上搜索了如何执行此操作的示例，并发现 NONE 显然控制不足。

唯一似乎在 WPF Datagrid 上工作的是原始类型。

我尝试做一些基本的事情，例如创建具有某些属性的自定义类型（例如 Person）的 DataTable。在将 DataTable 绑定到 WPF DataGrid 时，我已经尝试了我读过的所有技巧，以编程方式使用 DataGridTemplateColumn，并且所有示例都给出了政治家的答案（从而避免了真正的问题）。

一种解决方案在设计时在 XAML 中声明 DataTemplate，这是无用的，因为 DataTable 是动态的（所以不是答案）。

我最接近的方法是创建一个 ObservableCollection 并将其绑定到 DataGrid （同样不是真正的答案）。

除此之外。无论我改变或尝试了多少东西，都没有任何约束力。所以我最终得到了空白控件，这很烦人。

# asp.net - 如何使用动态数据和 Active Directory 实现基于角色的安全性？

> ID：604175
> 
> 赞同：3
> 
> 时间：2009-03-02T21:54:57.660
> 
> 标签：asp.net, security, active-directory, dynamic-data

在 asp.net 动态数据站点上使用活动目录角色实现安全性的最佳方法是什么？

我想将某些视图（和相关链接）限制为某些角色。即用户 A 只能查看表 x 的列表操作，用户 B 只能查看表 y 的列表操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T16:59:44.513

我在许多应用程序中都这样做了。

为您的应用程序启用 Windows 身份验证。

制作一些可以存储用户凭据的对象，并将该对象存储在会话中以便快速检索。如果它不存在，您可以快速重建它。我通常将每个角色设置为一些，例如：

```
 enum USER_ROLE : int
{
  Role1 = 1,
  Role2 = 2,
  Role3 = 4,
  Role4 = 8,
  etc
}

if (Context.User.IsInRole("Roll1Name")) YourUserObject.Roles += USER_ROLE.Role1;
if (Context.User.IsInRole("Roll2Name")) YourUserObject.Roles += USER_ROLE.Role2;
etc 
```

然后，每当需要保护控件时，我都会将它传递给一个函数，该函数采用 HtmlControl 和一个基于用户角色和该控件的安全要求的属性。

例如。bool SetControlSecurity（HtmlControl ctrl，int iUserRoles，int iControlRoles，ACTION eAction）

所以做一个面板的例子可能是：

SetControlSecurity(pnlUserInfo, YourUserObject.Roles, eRole.Role2, ACTION.Hide);

我通常还会将参数设置为在安全失败时执行的操作类型，例如隐藏、只读、清除数据等...

比较函数中的角色很容易：

```
 bool bHasAccess = ((iUserRole & iControlRoles) > 0);
if (bHasAcess)
{
  // leave the control or make sure it is visible etc
}
else
{
  // take action to secure the control based on the action
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T17:32:44.370

我的[博客](http://csharpbits.notaclue.net)上有很多关于此的文章A [DynamicData Attribute Based Permission Solution using User Roles](http://csharpbits.notaclue.net/2008/05/dynamicdata-attribute-based-security.html)和这里 [DynamicData: Database Based Permissions - Part 1](http://csharpbits.notaclue.net/2008/06/dynamicdate-database-based-permissions_16.html)我还会看看使用路由处理程序[的 codeplex 上的 Securing Dynamic Data 示例。](http://aspnet.codeplex.com/Release/ProjectReleases.aspx#ReleaseFiles)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T00:49:39.487

您可以只使用 ASP.NET Active Directory Memebrship & Role 提供程序来验证\授权用户到应用程序。然后，您可以在要检查 AD 角色成员资格的地方调用[Roles.IsUserInRole](http://msdn.microsoft.com/en-us/library/4z6b5d42.aspx)，以在呈现内容之前检查用户是否属于相关组。

# unix - 在 Solaris 上哪里设置 LD_LIBRARY_PATH？

> ID：604184
> 
> 赞同：9
> 
> 时间：2009-03-02T21:58:02.333
> 
> 标签：unix, path, solaris

在 Solaris 上设置应用程序特定`LD_LIBRARY_PATH`变量的最佳位置是什么？如何

> `LD_LIBRARY_PATH`

可变工作？

我们目前将它设置在 中`.kshrc`，但是不同的应用程序需要不同版本的消息传递框架，但是这些应用程序在相同的用途下运行，因此它们需要不同`LD_LIBRARY_PATH`的 ，那么您认为设置此变量的最佳位置是什么？

基本上我想弄清楚如何使这个变量路径成为应用程序的一部分，而不是特定于用户环境。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-02T22:11:09.913

通常我只会有一个启动应用程序的 shell 脚本。在 shell 脚本中，我会将 LD_LIBRARY_PATH 设置为该应用程序所需的任何值，然后让脚本启动该应用程序。这样做应该会导致仅为该应用程序设置路径。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T21:58:18.597

您可以在“ld.so.1”的手册页上找到正式的描述`LD_LIBRARY_PATH`，即运行“man ld.so.1”。它还描述了运行时链接器支持的一些其他变量。

除了`LD_LIBRARY_PATH`，可执行文件和共享库还可以具有内置的库搜索路径。如果您正在运行一个您自己链接的应用程序，您可以使用 ld 的 -R 选项来设置内置路径（Sun CC 和 gcc 都有执行相同操作的选项）。这可以让您避免`LD_LIBRARY_PATH`一开始就使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-04T02:47:59.860

弗拉德，alnc 是正确的。

不建议在 Solaris 上设置 LD_LIBRARY_PATH。完全没有。

如果您需要将特定的运行路径烘焙到您的库或可执行文件中，那么您应该对链接器使用 -R 标志。如果使用 gcc 构建，则使用 -Wl,Rpath （我认为）。

如果您需要为后期构建步骤执行此操作（例如，因为您缺少重新编译的源代码），那么 elfedit(1) 将帮助您很多。它记录在手册页中，也记录在[http://docs.oracle.com/cd/E26502_01/html/E26507/index.html的 Linker+Libraries Guide 中](http://docs.oracle.com/cd/E26502_01/html/E26507/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-09T15:34:52.900

crle 响应是最正确的。在 Solaris 上，`LD_LIBRARY_PATH`不应使用。请改用 crle。要查看当前路径，只需单独运行“crle”。要更新列表，请使用`crle -u -l /path/to/your/lib/directory`. 需要将`-u`更改写入系统配置，否则更改将是临时的。有关更多选项，请参见手册页。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-17T01:36:01.387

刚发现一个全局LD_LIBRARY_PATH不生效的案例，只好在app前封装一个脚本，设置LD_LIBRARY_PATH。如果您通过 blastwave 中的 pkgutil 在 /opt/csw/lib 下安装了很多库，crle 是一个很好的全局解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-20T23:10:51.630

您可以检查您的 .profile 或 .profile.user 文件。会有一个注释条目。不建议使用它，因为它已损坏。您应该通过将值传递给标志而不是使用变量来构建二进制文件。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-01-03T02:11:47.243

您可以使用 crle 命令：

crle -l /path/to/your/lib/file

# asp.net - 如何绑定 DropDownList 的选定值

> ID：604186
> 
> 赞同：22
> 
> 时间：2009-03-02T21:58:26.433
> 
> 标签：asp.net, data-binding

数据绑定都是关于声明性代码的，对吧？所以我用属性指定我想要的东西，其余的由框架处理。除非我弄错了，数据绑定与 S&M 有关，对吧？

那么，为什么DropDownList控件只为其数据源（即列表源）提供绑定字段，而不为其实际数据字段提供绑定字段。即如何将我的名字 DropDownList 的选定值绑定到我的个人记录中的名称字段？这是微软的严重疏忽，还是我的疏忽？

如果我仍然必须手动设置和读取所选值，那么双向数据绑定有什么意义？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-02T23:15:37.670

您可能想要执行类似下面的代码的操作。您不能以声明方式设置“SelectedValue”，但通过说“SelectedValue=<%# [code here] %>，您实际上是在控件绑定数据时设置了值。

```
<asp:DropDownList
                ID="DropDownInfoSource"
                runat="server"
                DataSourceID="_employeeDataSource"
                DataTextField="EmployeeName"
                DataValueField="EmployeeID"
                SelectedValue='<%# Bind("EmployeeID") %>'
                /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-29T18:27:57.363

我不知道它是否真的对您有帮助，但是您是否尝试在 Code behind 上设置“SelectedValue”？

例子：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    DropDownInfoSource.SelectedValue = "1" ' your value, here
End Sub 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-02T22:03:51.243

您可以在其中定义数据源、datatextfield（显示在列表中的内容）和 datavaluefield 的字段。

示例（我有一个包含“EmployeeID”列和“EmployeeName”列的数据表）：

```
dropdownlist1.datasource = DT
dropdownlist1.datatextfield = "EmployeeName"
dropdownlist1.datavaluefield = "EmployeeID"
dropdownlist1.databind() 
```

# java - 房地产的动机是什么？

> ID：604188
> 
> 赞同：3
> 
> 时间：2009-03-02T21:59:00.427
> 
> 标签：java, oop, properties, java-7

我对为什么语言有这些感到有点困惑。我是一名 Java 程序员，在我职业生涯的开始阶段，所以 Java 是我写的唯一语言，因为我开始真正了解它。

所以在 Java 中我们当然没有属性，我们编写 getThis() 和 setThat(...) 方法。

拥有属性我们会得到什么？

谢谢。

**编辑：**另一个查询：在具有属性的语言中会出现哪些命名约定？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T22:02:58.500

你觉得哪一个更自然？

```
// A
person.setAge(25)
// B
person.age = 25;
// or
person.Age = 25; //depending on conventions, but that's beside the point 
```

大多数人会回答B。

它不仅是语法糖，在进行反射时也有帮助；您实际上可以在数据和操作之间做出区别，而无需借助方法的名称。

对于不熟悉属性的人，这里有一个 C# 示例：

```
class Person
{
    public int Age
    {
        set
        {
            if(value<0)
                throw new ArgumentOutOfRangeException();

            OnChanged();
            age = value;
        }

        get { return age; }
    }

    private int age;
    protected virtual void OnChanged() { // ... }
} 
```

此外，大多数人总是使用属性而不是稍后提升公共成员，原因与我们总是使用 get/set 的原因相同；无需重写绑定到数据成员的旧客户端代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T22:04:03.863

语法更好：

```
button.Location += delta; 
```

比：

```
button.setLocation(button.getLocation() + delta); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-02T22:10:18.653

编辑：

下面的代码假定您是手动完成所有操作。在我的示例世界中，编译器将生成简单的 get/set 方法并将所有直接变量访问转换为这些方法。如果不是这样，则必须重新编译客户端代码，这在很大程度上违背了目的。

原来的：

属性的主要论点是，如果您从变量转到方法，则无需重新编译代码。

例如：

```
public class Foo
{
    public int bar;
} 
```

如果我们后来决定对“bar”进行验证，我们需要这样做：

```
public class Foo
{
    private int bar;

    public void setBar(final int val)
    {
        if(val <= 0)
        {
            throw new IllegalArgumentException("val must be > 0, was: " + val);
        }

        bar = val;
    }

    public int getBar()
    {
        return (bar);
    }
} 
```

但是添加 set/get 方法会破坏所有代码。如果它是通过属性完成的，那么您将能够在事后添加验证而不会破坏客户端代码。

我个人不喜欢这个想法 - 我对使用注释和自动简单的 set/geterate 的想法更满意，并且能够根据需要提供自己的 set/get 实现（但我不喜欢隐藏的方法来电）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T22:01:14.603

两个原因：

1.  清洁/简洁的语法；和
2.  它更清楚地向类的用户表明状态（属性）和行为（方法）之间的区别。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T22:06:41.937

在 Java 中，getter 和 setter 本质上是属性。

在其他现代语言 (c#) 等中，它只是使语法更易于使用/理解。

它们是不必要的，并且在大多数情况下都有解决方法。

这确实是一个偏好问题，但是如果您使用的语言支持它们，我建议您使用它们:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T22:07:12.247

起初我也为此苦苦挣扎，但是我真的很欣赏它们。在我看来，属性允许我以自然的方式与公开的数据进行交互，而不会丢失 getter/setter 方法提供的封装。换句话说，我可以将我的属性视为字段，但如果我选择不公开实际字段，则不会真正公开。使用 C# 3.0 中的自动属性，对于大多数字段来说，它变得更好——我希望允许消费者读/写数据——我要写的更少：

```
public string Prop { get; set; } 
```

在我想要部分可见性的情况下，我可以轻松地限制我想要的访问器。

```
public string Prop { get; private set; } 
```

所有这些都可以通过 getter/setter 方法来完成，但措辞要高得多，用法也不太自然。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T22:10:18.747

面向对象编程的一般规则是永远不要更改现有接口。这确保了虽然内部内容可能会更改，但调用对象的对象不需要知道这一点。

其他语言中的属性是伪装成特定语言特征的方法。在 Java 中，属性仅通过约定进行区分。虽然通常这有效，但在某些情况下它会限制您。例如，有时您会使用 hasSomething 而不是 getSomething 的 isSomething。

因此它允许名称的灵活性，而依赖的工具和其他代码仍然可以区分。

此外，代码可以更紧凑，get 和 set 按设计组合在一起。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-02T23:01:26.237

在*面向对象的软件构造 2*中，Bertrand Meyer 将此称为“统一访问原则”，一般的想法是，当一个属性从一个简单的（即只是一个整数）变为派生的（一个函数调用）时，使用它的人不应该知道。

您不希望每个使用您的代码的人都必须从

诠释 x = foo.y;

至

int x = foo.y();

这打破了封装，因为你没有改变你的“接口”只是你的“实现”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-02T22:08:02.840

您还可以创建派生字段和只读/只写字段。我在使用过的语言中看到的大多数属性不仅允许您分配简单的字段，还允许您为属性分配完整的功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T22:13:19.473

属性提供了一种简单的方法，可以将对象中一组逻辑背后的细节抽象为外部世界的单个值。

虽然您的属性可能仅作为一个值开始，但此抽象将接口解耦，以便以后可以更改其细节而影响最小。

一般的经验法则是抽象和松耦合是好事。属性是实现两者的模式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-03T22:28:38.320

语言级别的属性是个坏主意。他们没有很好的约定，他们在代码中隐藏了性能缺陷。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-05T06:12:22.347

**一切都与绑定有关**

曾经有一段时间我认为属性只是语法糖（即通过减少它们的类型来帮助开发人员）。随着我进行了越来越多的 GUI 开发并开始使用绑定框架（JGoodies、JSR295），我发现语言级别的属性远不止语法糖。

在绑定场景中，您基本上定义了“对象 A 的属性 X 应始终等于对象 B 的属性 Y”的规则。简写是：Ax <-> By

现在，想象一下您将如何实际使用 Java 编写绑定库。现在，绝对不可能将“x”或“y”直接称为语言原语。您只能将它们称为字符串（并通过反射访问它们）。本质上，A."x" <-> B."y"

当你去重构代码时，这会导致大量的问题。

还有其他注意事项，包括正确实施属性更改通知。如果你看一下我的代码，每个有福的 setter 至少需要 3 行代码来完成非常简单的事情。再加上这 3 行之一包括另一个字符串：

```
public void setFoo(Foo foo){
  Foo old = getFoo();
  this.foo = foo;
  changeSupport.firePropertyChange("foo", old, foo);
} 
```

所有这些四处飘荡的弦乐都是一场彻头彻尾的噩梦。

现在，想象一下，如果财产是该语言的一等公民。这开始提供几乎无限的可能性（例如，想象直接使用 Property 注册侦听器，而不是必须使用 PropertyChangeSupport，这是必须添加到每个类的 3 个神秘方法）。想象一下能够将属性本身（不是属性的值，而是属性对象）传递到绑定框架中。

对于 Web 层开发人员，想象一个 Web 框架，它可以根据属性本身的名称（例如 registerFormProperties(myObject.firstname, myObject.lastname, someOtherObject.amount) 来构建它自己的表单 id 值，以允许对象的往返填充表单提交回服务器时的属性值。现在要做到这一点，你必须传入字符串，重构变得很头疼（一旦你依赖字符串和反射来连接东西，重构实际上变得非常可怕）。

所以无论如何，对于我们这些通过绑定处理动态数据更新的人来说，属性是语言中非常需要的特性——不仅仅是语法糖。

# c# - C# SQL Server 程序集引发错误？

> ID：604189
> 
> 赞同：0
> 
> 时间：2009-03-02T21:59:17.103
> 
> 标签：c#, sql-server, error-handling, assemblies

我有几个用于 SQL Server 2005 的程序集。

如果输入了无效数据以由我的 SP 函数（使用 C#）运行，我想将错误传递回 sql server。

例如，如果有人输入了我不希望他们输入的内容，那么我想在执行任何查询之前将某些内容输出回 SQL Server。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-29T14:13:27.720

抛出异常。或者，如果您使用 SQL 上下文连接，则可以使用 SqlPipe 在 SQL 中调用“raiserror”。

# entity-framework - 模拟实体框架模型？

> ID：604191
> 
> 赞同：2
> 
> 时间：2009-03-02T21:59:35.590
> 
> 标签：entity-framework, testing, linq-to-entities, mocking

是否可以模拟 EF 模型，以便我可以测试使用模型类的代码，而无需摆脱遍布整个项目的 LINQ to Entities 代码？或者是否有必要为模型建立一个测试数据库来代替？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T22:24:08.540

您可以将 LINQ 代码包装在[Data Access Objects](http://en.wikipedia.org/wiki/Data_Access_Object)中。DAO 将具有单独的接口和实现代码。您的测试代码会模拟 DAO。

如果您不想这样做，则需要一个测试数据库。

# .net - 列表 或链表

> ID：604192
> 
> 赞同：6
> 
> 时间：2009-03-02T21:59:46.197
> 
> 标签：.net, algorithm, data-structures, collections

我需要一个包含相同类型元素列表的数据结构。需要的功能是

*   添加
*   获取枚举器
*   （可能）清楚

*不需要*索引访问、排序、搜索、删除元素。什么是它最好的收藏类？应考虑以下方面：性能、内存使用、垃圾收集器的行为。

`List<T>`我目前的候选人是`LinkedList<T>`

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-02T22:03:04.723

除非你正在处理一个巨大的结构，或者你计划迭代这个东西一万亿次，否则这并不重要。只需选择一个并**开始编码**。如果您的应用程序稍后会缓慢爬行，请找出原因并根据需要进行更改。

（说真的，没关系。有一点点。你花在寻找这个问题的答案上的每一分钟都比你本可以拥有工作代码的时间更近一分钟）。

如果有人已经到了*需要*知道差异的地步，LinkedList 比 List 更快，如果您只需要非随机、只进的读取和附加功能，就可以使用它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-04T19:06:06.737

几乎所有情况下都
默认使用简短答案。`List<T>`

与枚举这些值相比，如果您要进行大量添加和删除值并且列表的大小很大，那么稍微长一点的答案
`LinkedList<T>`只会更好。`List<T>`如果在分析之后发现使用是一个问题，这应该是您选择的一个因素。

更长的答案

假设，您已将其中一个或另一个的使用确定为性能问题。

如果您进行大量随机访问，那么`List<T>`无论如何几乎总是会快得多。如果您枚举很多并且很少插入（或几乎总是在附近/末尾插入），那么`List<T>`几乎总是会更快。如果您在随机位置不断插入/删除，但在迭代列表时已经在相关节点处或附近，并且至少有几千个元素，您可能想尝试`LinkedList<T>`

确定哪些值/使用情况可以转化为更好的性能在很大程度上取决于您的使用情况。微基准测试在这里可能会产生很大的误导性，因为它们会在链表行为的地毯方面刷过，例如在内存中分布的节点，而不是如果它们碰巧在您的测试中一次全部分配，则它们会很好地相邻。同样，预先创建`List<T>`具有正确尺寸的 可以产生很大的不同。

至于计算机科学风格的推理和大 O 表示法（在这种情况下*确实*需要大 N 才有意义）

*   手术
    *   成本`List<T>`
    *   成本`LinkedList<T>`
*   在末尾插入
    *   O(1)（摊销成本，根据需要分配到两倍大小）
    *   每次分配 O(1)
*   在开头插入
    *   O(N) （虽然完成了快速内存移动，所以运行时间行为有点复杂）
    *   O(1)
*   插入位置 x （并删除）
    *   O(Nx)（见末尾插入的注释）
    *   O(1)
*   前向枚举
    *   O(N)（尽管缓存未命中最小化）
    *   O(N)（虽然严重依赖缓存位置）
*   反向枚举
    *   在）
    *   O(N)（`LinkedList<T>`实现是双向的）
*   随机访问
    *   O(1)
    *   在）

内存使用很复杂，因为 List 在任何时候最多可以有 Count - 1 个多余的单元格，但每个单元格`LinkedList<T>`会消耗一个`LinkedListNode<T>`额外的 3 个引用（每次弹出 4/8 个字节）加上通常的对象开销。在正常使用中，List 可能会获胜，但如果您发现内存消耗实际上是一个问题，那么这应该只是您担心的事情。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-02T22:03:11.027

我会使用`List<T>`，因为如果您的所有数据都是值类型并且仍然可以很好地使用引用类型，那么它们将按顺序存储（在内部，`List<T>`管理一个数组，每次空间不足时它都会增长两倍）。

`LinkedList<T>`当事物不受 IO 限制时，它曾经更有意义。人们经常会引用它看似“O(1)”的性质。但是，这降低了页面错误获取节点的机会增加所带来的真实成本。

如果您可以使用数组获得连续的内存区域，或者`List<T>`避免潜在的页面错误，那么使用现代处理器和主内存缓存线会更好。

如果您事先知道将拥有多少个元素，请使用数组。如果您对元素的数量有一个很好的了解，请使用 a `List<T>`（并在构造函数中传递可能的上限以潜在地避免重新分配）。

我唯一会使用 a`LinkedList<T>`是如果您需要不断地将列表中的项目增加一个值。例如，如果您正在实现[最近最少使用](http://en.wikipedia.org/wiki/Cache_algorithms#Least_Recently_Used)的缓存算法，并且需要在前面添加一些内容并从末尾删除一些内容。

对于小件物品，它真的不会有什么不同。分代垃圾收集器将随着时间的推移将分散的堆项目压缩在一起，因此链表不会变得太糟糕。

除非您发现问题（通过分析），否则我会选择`List<T>`并运行它

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-02T22:04:27.183

除非您正在处理数十万或数百万个条目，并且您已经对程序进行了概要分析以发现存在重大问题，否则您可能不会注意到两者之间的区别。

除此之外：

> `LinkedList<T>`提供单独的类型节点`LinkedListNode<T>`，因此插入和删除是 O(1) 操作。

从[这里](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-02T22:03:10.057

如果不需要索引访问，则最好使用`LinkedList<T>`. 没有太大区别，但 LinkedList 可以更快地追加。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T23:09:57.900

鉴于您对接口的要求，您应该`ICollection<T>`在代码中的任何地方使用，而不是引用特定的具体类。

原因是如果您使用`List`then 您可能会编写一堆代码`l[0]`来获取第一项。另一方面，如果您使用then 您可能会在整个代码中`LinkedList`传播调用。`AddLast`为了保留切换的选择，您需要避免意外依赖您并不真正需要的功能。您需要使用两个容器都支持的接口。

所以写一个这样的类：

```
public static class Collections
{
    public static ICollection<T> Make<T>()
    {
        return new List<T>();
    }
} 
```

然后，每当您需要一个集合时，请执行以下操作：

```
ICollection<int> c = Collections.Make<int>(); 
```

将您选择的容器与程序的其余部分隔离开来。现在，当您分析并改变主意时，您只需编辑`Make<T>`方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T22:15:42.197

LinkedList 将带来更多的内存开销（对于节点），但如果您在中间插入许多元素会更好。链表也需要更多的内存分配，因为 LinkedListNode 是一个类并且是动态分配的。如果您不插入元素（只是追加），我会使用 List。列表应该与追加一样快或更快，尽管偶尔需要放大。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T22:18:50.893

如果您的数组足够大，那么您需要自己滚动......否则只需使用列表。

# user-interface - 缇，像素和点，哦，我的！

> ID：604203
> 
> 赞同：22
> 
> 时间：2009-03-02T22:02:13.867
> 
> 标签：user-interface, layout, types, point

或“我如何学会停止担忧并学会爱上测量系统”

我想要一个可以稍后参考的中心点，让我快速了解编程中使用的各种测量单位。SO似乎是放置它的最佳位置，虽然我可以继续自己回答这个问题，但你们都比我聪明得多，所以我不妨让你去做。

请选择一个您熟悉的单位，在第一行使用“#name”作为标题（以便于查找）并在您的答案中定义它。请不要重复 - 添加评论或编辑现有答案，而不是添加新答案。类似的单位仍然是分开的 - 所以请不要在同一个答案中定义 em 和 en 。如果一个单位与另一个单位完全相同，请在标题下方添加一行“别名”。

如果它是一种特别模糊的测量类型，请链接到第二个参考，这样人们就不会因为他们从未听说过而对你投反对票。

*   [观点](https://stackoverflow.com/questions/604203/twips-pixels-and-points-oh-my/604220#604220)
*   [异食癖](https://stackoverflow.com/questions/604203/twips-pixels-and-points-oh-my/604270#604270)
*   [缇](https://stackoverflow.com/questions/604203/twips-pixels-and-points-oh-my/604276#604276)
*   [像素](https://stackoverflow.com/questions/604203/twips-pixels-and-points-oh-my/604326#604326)
*   恩
*   恩
*   消费物价指数
*   [DPI](https://stackoverflow.com/questions/604203/twips-pixels-and-points-oh-my/605911#605911)

我看到很多反对意见 - 我想人们认为这不会为 StackOverflow 的社区增加价值。如果您认为这不会增加社区，或者您认为这是一个不好的问题，请考虑在下面发表评论。如果您有任何建议，我有兴趣改进它。

*标准的好处是有很多可供选择！*

-亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T22:29:49.010

## [像素](http://en.wikipedia.org/wiki/Pixel)

屏幕上的彩色小方块之一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T13:03:35.900

我建议使用以下描述修改上述答案

# 皮卡

Pica 英美点系统中的印刷测量单位。1 个 pica 为 1/72 英寸（0,351 毫米），等于 12 个 pica 点。异食癖的 didot 等价物是西塞罗。报纸上的标准计量单位。一英寸有 6 个 pica，一 pica 有 12 个点。

# 皮卡点

异食癖点 1/12 异食癖

# 观点

996 点等于 35 厘米，或 1 点等于 0.01383 英寸。这意味着每英寸大约有 72.3 磅。我们在电子印刷中使用每英寸 72 点

1 点（Truchet）= 0.188 毫米（今天已过时）

1 点 (Didot) = 0.376 毫米 = 1/72 的法国皇家英寸 (27.07 毫米)

1 点 (ATA) = 0.3514598 毫米 = 0.013837 英寸

1 点 (TeX) = 0.3514598035 毫米 = 1/72.27 英寸

1 点（后记）= 0.3527777778 毫米 = 1/72 英寸

1 分 (l'Imprimerie nationale, IN) = 0.4 毫米

# 电磁场

一个古老的印刷术语，表示与字体高度一样宽的方形空白空间；换句话说，一个 10 磅的 em 空间将是 10 磅宽。

# CN

半个 em 空间；一个 10 点的空间将是 5 点宽。

# DPI

打印机每英寸打印的点数。dpi 越高，输出的分辨率越精细。

# 像素

你可以在电脑屏幕上画的最小的点

# 消费物价指数

鼠标属性的每英寸计数和打印机属性的每英寸可容纳的水平字符数

# PITCH 别名 CPI

音高描述了字符的宽度。间距等于 1 英寸内可以并排放置的字符数；例如，10 间距等于每英寸 10 个字符或 10 个 CPI。间距是一个通常与非比例（固定宽度）字体一起使用的术语。

# TWIPS

缇（源自英制点的 20 分之一）是印刷量度，定义为印刷点的 1/20。一缇是 1/1440 英寸或 17.639 µm，当从 72 英寸的 PostScript 点得出时，1/1445.4 英寸或 17.573 µm 基于打印机在 72.27 英寸的点

# 附加单位：

# LPI

适合一英寸的文本垂直行数

# 生产者价格指数

纸张的厚度，以千分之一英寸或每英寸页数表示。或者有时每英寸没有紧密打印或显示的水平像素。

# 字体大小

字体大小或类型大小是设计字体的基线距离。字体通常应按此大小标识和选择，因为与某些字符的实际尺寸相比，预期的基线距离与实际布局工作更相关。

# 字体高度

字体高度是指 k 或 H 等字母的高度（以毫米为单位）。通常，字体高度约为字体大小的 72%，但这当然由字体设计者自行决定。

# X-高度

x-height 表示不包括升序和降序的小写字母的排版大小（从小写 x 的高度开始）

# H-高度

h 高度或大写高度是指特定字体基线上方大写字母的高度。它专门指的是扁平的大写字母（例如 H 或 I）的高度，而不是圆形字母（例如 O）的高度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T22:19:42.890

## [异食癖](http://en.wikipedia.org/wiki/Pica_(unit_of_measure))

12 分的印刷测量，有时（错误地）称为[Em](http://en.wikipedia.org/wiki/Em_(typography))。（实际上，一个em实际上是一个水平距离，与类型的点大小相同）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T22:21:08.783

## [缇](http://en.wikipedia.org/wiki/Twip)

'帝国点的二十分'。用于标记 Visual BASIC 用户界面中小部件位置的度量。它以这种方式使用，以便可以使用整数精确指定位置。一缇 = 1/20 点 = 1/1440 英寸。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T03:40:35.013

# 电磁场

一个古老的印刷术语，表示与字体高度一样宽的方形空白空间；换句话说，一个 10 磅的 em 空间将是 10 磅宽。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T10:43:05.100

## [DPI](http://en.wikipedia.org/wiki/Dots_per_inch)

Dots per inch. A dimensionless number used to measure the resolution of something in space, i.e. with respect to real occupied physical size.

dds complexity and headache since the standard/default DPI of a computer screen [varies with the operating system](http://home.clara.net/rfwilmut/about/fonts.html). Macintosh screens generally have 72 DPI, while Windows favors 96\. If you don't compensate for this when displaying images (and text), you will get unexpected variations.

Always amusing when people start talking of "the DPI of this image", for digital images such as PNG or JPEG. To me, they only have absolute pixels in them, unconnected to any physical size. If you want to print the image on a (for instance) 300 DPI printer, then you need to adapt and scale to get it correct, but the image itself only has pixels.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-04T03:41:25.947

# CN

半个 em 空间；一个 10 点的空间将是 5 点宽。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-04T03:42:27.707

# 消费物价指数

鼠标属性的每英寸计数和

打印机属性的一英寸内可容纳的水平字符数

# PITCH 别名 CPI

音高描述了字符的宽度。间距等于 1 英寸内可以并排放置的字符数；例如，10 间距等于每英寸 10 个字符或 10 个 CPI。间距是一个通常与非比例（固定宽度）字体一起使用的术语。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T22:06:42.327

# 后记[点](http://en.wikipedia.org/wiki/Point_(typography))

1/72 英寸。

# c# - 使用 AesManaged 的 “填充无效且无法移除”

> ID：604210
> 
> 赞同：39
> 
> 时间：2009-03-02T22:03:23.130
> 
> 标签：c#, .net, encryption

我正在尝试使用 AesManaged 进行简单的加密/解密，但是在尝试关闭解密流时我不断收到异常。此处的字符串被正确加密和解​​密，然后在 Console.WriteLine 打印正确的字符串后得到 CryptographicException "Padding was invalid and cannot be removed"。

有任何想法吗？

```
MemoryStream ms = new MemoryStream();
byte[] rawPlaintext = Encoding.Unicode.GetBytes("This is annoying!");

using (Aes aes = new AesManaged())
{
  aes.Padding = PaddingMode.PKCS7;
  aes.Key = new byte[128/8];
  aes.IV = new byte[128/8];

  using (CryptoStream cs = new CryptoStream(ms, aes.CreateEncryptor(),
                                            CryptoStreamMode.Write))
  {
    cs.Write(rawPlaintext, 0, rawPlaintext.Length);
    cs.FlushFinalBlock();
  }

  ms = new MemoryStream(ms.GetBuffer());
  using (CryptoStream cs = new CryptoStream(ms, aes.CreateDecryptor(),
                                            CryptoStreamMode.Read))
  {
    byte[] rawData = new byte[rawPlaintext.Length];
    int len = cs.Read(rawData, 0, rawPlaintext.Length);
    string s = Encoding.Unicode.GetString(rawData);
    Console.WriteLine(s);
  }
} 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-02T23:15:59.697

诀窍是使用`MemoryStream.ToArray()`. 我还更改了您的代码，使其`CryptoStream`在加密和解密中都使用 to Write。而且您不需要`CryptoStream.FlushFinalBlock()`显式调用，因为您在语句中拥有它`using()`，并且刷新将发生在`Dispose()`. 以下对我有用。

```
byte[] rawPlaintext = System.Text.Encoding.Unicode.GetBytes("This is all clear now!");

using (Aes aes = new AesManaged())
{
    aes.Padding = PaddingMode.PKCS7;
    aes.KeySize = 128;          // in bits
    aes.Key = new byte[128/8];  // 16 bytes for 128 bit encryption
    aes.IV = new byte[128/8];   // AES needs a 16-byte IV
    // Should set Key and IV here.  Good approach: derive them from 
    // a password via Cryptography.Rfc2898DeriveBytes 
    byte[] cipherText= null;
    byte[] plainText= null;

    using (MemoryStream ms = new MemoryStream())
    {
        using (CryptoStream cs = new CryptoStream(ms, aes.CreateEncryptor(), CryptoStreamMode.Write))
        {
            cs.Write(rawPlaintext, 0, rawPlaintext.Length);
        }

        cipherText= ms.ToArray();
    }

    using (MemoryStream ms = new MemoryStream())
    {
        using (CryptoStream cs = new CryptoStream(ms, aes.CreateDecryptor(), CryptoStreamMode.Write))
        {
            cs.Write(cipherText, 0, cipherText.Length);
        }

        plainText = ms.ToArray();
    }
    string s = System.Text.Encoding.Unicode.GetString(plainText);
    Console.WriteLine(s);
} 
```

另外，我猜你知道你会想要显式设置 AesManaged 实例的[模式](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged.mode.aspx)，并使用[System.Security.Cryptography.Rfc2898DeriveBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx) 从密码和盐中派生密钥和 IV。

另请参阅
：[-AesManaged](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged.aspx)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2010-12-01T10:51:12.727

此异常可能是由多个加密参数中的任何一个不匹配引起的。

我使用[Security.Cryptography.Debug](https://github.com/microsoftarchive/clrsecurity/blob/7250c56ccfd40413e68af755e3de40d00c673431/Wiki/Security.Cryptography.Debug.dll.md)接口来跟踪加密/解密方法中使用的所有参数。

最后我发现我的问题是我在设置导致类重新生成随机密钥`KeySize`之后设置了属性，`Key`而不是使用我最初设置的密钥。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-06-12T01:39:49.993

对于它的价值，我会记录我所面临的。我试图在 CryptoStream 关​​闭之前读取加密器内存流。我很天真，浪费了一天的时间来调试它。

```
 public static byte[] Encrypt(byte[] buffer, byte[] sessionKey, out byte[] iv)
    {
        byte[] encrypted;
        iv = null;
        using (AesCryptoServiceProvider aesAlg = new AesCryptoServiceProvider { Mode = CipherMode.CBC, Padding = PaddingMode.PKCS7 })
        {
            aesAlg.Key = sessionKey;
            iv = aesAlg.IV;
            ICryptoTransform encryptor = aesAlg.CreateEncryptor(sessionKey, iv);

            // Create the streams used for encryption.
            using (MemoryStream msEncrypt = new MemoryStream())
            {
                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                {
                    csEncrypt.Write(buffer, 0, buffer.Length);

                    //This was not closing the cryptostream and only worked if I called FlushFinalBlock()
                    //encrypted = msEncrypt.ToArray(); 
                }

                encrypted = msEncrypt.ToArray();

                return encrypted;
            }
        }
    } 
```

在 cypto 流关闭后移动读取的加密器内存流解决了这个问题。正如 Cheeso 提到的。`FlushFinalBlock()`如果您正在使用该`using`块，则无需调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T22:08:28.190

> byte[] rawData = new byte[rawPlaintext.Length];

您需要读取缓冲区的长度，这可能包括必要的填充（IIRC，已经有几年了）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-03T09:11:17.110

没有人回答，实际上 MemoryStream.GetBuffer 返回分配的缓冲区，而不是该缓冲区中的真实数据。在这种情况下，它返回 256 字节的缓冲区，而它只包含 32 字节的加密数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-06T05:37:48.050

正如其他人所提到的，如果未正确初始化密钥/iv 以进行解密，则可能会发生此错误。就我而言，我需要从一些更大的缓冲区中复制 key 和 iv 。这是我做错的事情：

**不起作用：（**填充无效，无法删除）

```
aes.Key = new byte[keySize];
Buffer.BlockCopy(someBuffer, keyOffset, aes.Key, 0, keySize);

aes.IV = new byte[ivSize];
Buffer.BlockCopy(someBuffer, ivOffset, aes.IV, 0, ivSize); 
```

**作品：**

```
var key = new byte[keySize];
Buffer.BlockCopy(someBuffer, keyOffset, key, 0, keySize);
aes.Key = key;

var iv = new byte[ivSize];
Buffer.BlockCopy(someBuffer, ivOffset, iv, 0, ivSize);
aes.IV = iv; 
```

OP 没有犯这个错误，但这可能有助于其他人看到同样的错误。

# ajax - 在 EJB 和 AJAX 中使用观察者模式

> ID：604217
> 
> 赞同：3
> 
> 时间：2009-03-02T22:05:28.773
> 
> 标签：ajax, design-patterns, ejb, reverse-ajax

我想构建一个 Ajax gui，它会在我的 ejb 应用程序中发生的任何状态更改时得到通知。为了实现这一点，我认为我构建了一个有状态的 ejb (3.0)，它实现了将 Ajax 客户端添加为观察者的 Observable 接口。首先，这对 Ajax 是否可行。如果是，这是一个好的设计理念还是有更合适的方法来做到这一点？

提前致谢！

干杯，

安德烈亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T22:10:10.540

听起来您对“Reverse-Ajax”感兴趣，当服务器端发生事件时通知客户端。这与标准 Ajax 不同，标准 Ajax 基于某些客户端操作将异步事件发送到服务器。反向 Ajax 是可能的，并且在允许这样做并简化底层复杂性方面做得非常好的一个框架是 DWR。

[http://directwebremoting.org/dwr/reverse-ajax](http://directwebremoting.org/dwr/reverse-ajax)

无论您使用哪种框架，您都需要根据您的预期负载、webapp 容器等了解各种实现方式对性能的影响。

至于这是否是好的做法，这真的取决于你的应用程序。如果将近乎实时的数据推送回客户端很重要，并且您不想使用 Flex 或其他较重的框架之类的东西，那么我会说您走在正确的轨道上。如果数据不需要是实时的，或者如果您的负载非常高，那么也许更简单的方法（如计划的页面刷新）会为您节省一些复杂性并有助于提高性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-06T13:50:14.463

现在，一段时间后，您的问题有了一个新的可能答案：Websockets 的使用

来自[Pete](https://stackoverflow.com/users/17123/pete)之前[链接的网站](http://directwebremoting.org/dwr/reverse-ajax)：“Web 的设计初衷不是允许Web 服务器连接到Web 浏览器……” 现在html5 正在改变这种情况。

[http://en.wikipedia.org/wiki/WebSockets](http://en.wikipedia.org/wiki/WebSockets)

# c# - 如何在 PdfSharp 中添加指向文件的链接？

> ID：604218
> 
> 赞同：3
> 
> 时间：2009-03-02T22:05:44.997
> 
> 标签：c#, .net, pdfsharp

我似乎无法让 PdfSharp 显示此注释的图片。它没有 PdfAnnotation.Icon 属性，所以我不能设置它。

```
XFont font = new XFont("Verdana", 10);
PdfPage page = wDoc.Parent.Page;
XGraphics gfx = wDoc.Parent.gfx;
XRect rec = gfx.Transformer.WorldToDefaultPage(new XRect(new XPoint(30, 60), new XSize(30, 30)));
PdfRectangle rect = new PdfRectangle(rec);
PdfLinkAnnotation link = PdfLinkAnnotation.CreateFileLink(rect, wDoc.FileLocation);
gfx.DrawString("These files were attached:", font, XBrushes.Black, 30, 50, XStringFormat.Default);

link.Rectangle = new PdfRectangle(rec);
page.Annotations.Add(link); 
```

我已经做到了，并且注释确实存在，除了它是一个空白框！我该如何让它说些什么，甚至只是展示一张图片？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-07T12:04:09.883

您需要使用 page.AddWebLink(AREArect) 然后使用 gfx.drawstring(AREArect) 添加文本区域

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-02T10:47:52.423

[Uri](https://msdn.microsoft.com/en-us/library/system.uri(v=vs.110).aspx)使用示例代码：

```
...
PdfDocument pdfDoc = PdfReader.Open(myUri.LocalPath, PdfDocumentOpenMode.Import);
PdfDocument pdfNewDoc = new PdfDocument();
for (int i = 0; i < pdfDoc.Pages.Count; i++)
{
   PdfPage page = pdfNewDoc.AddPage(pdfDoc.Pages[i]);
   XFont fontNormal = new XFont("Calibri", 10, XFontStyle.Regular);    
   XGraphics gfx = XGraphics.FromPdfPage(page);
   var xrect = new XRect(240, 395, 300, 20);
   var rect = gfx.Transformer.WorldToDefaultPage(xrect);
   var pdfrect = new PdfRectangle(rect);

   //file link
   page.AddFileLink(pdfrect, myUri.LocalPath);
   //web link
   //page.AddWebLink(pdfrect, myUri.AbsoluteUri);

   gfx.DrawString("MyFileName", fontNormal, XBrushes.Black, xrect, XStringFormats.TopLeft);
}
pdfNewDoc.Save(myDestinationUri.LocalPath + "MyNewPdfFile.pdf");
... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-25T09:41:24.660

我不熟悉类 PdfLinkAnnotation。您可以使用 page.AddDocumentLink、page.AddWebLink 和 page.AddFileLink 来创建链接。如果您使用这些方法，您可以将图标绘制为图像。

# powershell - 在 PowerShell 中添加大整数的数字

> ID：604223
> 
> 赞同：0
> 
> 时间：2009-03-02T22:07:02.873
> 
> 标签：powershell

在 PowerShell 中添加数字的数字时，长度为 -le 29 的整数一切正常。

```
$largeInteger = 11111111111111111111111111111 #29 位数字总和正确
$sumDigits = 0
$大整数
而 ($largeInteger -ne 0)
{
    $sumDigits += $largeInteger % 10
    $largeInteger = [数学]::Floor($largeInteger /10)   
}

$sumDigits

```

当数字的长度 -gt 29 时，事情变得有趣了。在长度为 30 的情况下，总和 = 77。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T06:21:17.130

您将必须安装一个 bignum 库。这里有[一些指针](https://stackoverflow.com/questions/25375/how-can-i-represent-a-very-large-integer-in-net)。要么使用内置 bignums 的平台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T22:28:25.787

`largeInteger`从 29 个 1更改为 30 个 1 将变量的类型从 Decimal 更改为 Double。用`$largeInteger.GetType()`来看。

算法中的数学在双打上效果不佳。在提示符下重复运行循环中的 2 行以查看每个步骤中的值。

一旦`largeInteger`从十进制变为双精度，算术就不再精确了。这就是为什么我建议在提示符下运行 2 行。

这是输出 -

```
PS C:\> $largeInteger  % [double]10<br/>
8<br/>
PS C:\> $largeInteger  % [double]100<br/>
88<br/>
PS C:\> $largeInteger  % [double]1000000000000000000<br/>
1.11105501764518E+17<br/>
PS C:\> $largeInteger  % [double]1000000000000000000000<br/>
1.11111105501765E+20<br/>
PS C:\> $largeInteger  % [double]1000000000000000000000000000<br/>
1.11111111111104E+26<br/>
PS C:\> $largeInteger  % [double]100000000000000000000000000000<br/>
1.11111111111111E+28<br/>
PS C:\> $largeInteger  % [double]1000000000000000000000000000000<br/>
1.11111111111111E+29<br/> 
```

您可以看到由于无法以二进制准确表示的 double 的内部不精确表示而发生的失真。随着除数的增加，增加的余数的准确性也提高了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T22:29:09.777

您有一个溢出的 double 被 Powershell 作为特殊情况处理。你可以试试`$largeInteger = [float]111111111111111111111111111111`。使用浮点数仍然会丢失一些精度。

有关详细信息，请参阅[浮点数（C# 参考）](http://msdn.microsoft.com/en-us/library/b1e65aza(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-17T06:40:18.113

这应该有帮助`($largeInteger -split '' | measure -sum).Sum`

# .net - 将更改历史记录保存到 SQL Server 2008 中的 XML 字段

> ID：604229
> 
> 赞同：0
> 
> 时间：2009-03-02T22:08:13.697
> 
> 标签：.net, sql-server, xml, diff

我曾开发过几个将 XML 数据保存到数据库中的应用程序。迄今为止，它们都只是用新的 XML 内容覆盖了当前的 XML 内容。

我想将对 XML 的更改保存到数据库中，但不覆盖数据库中当前的内容。

除了为更改创建新行并保持旧行完好无损之外，我还可以使用哪些其他选项？

我考虑过将差异保存为实际的文本差异，这并不总是适用于 XML。

我什至想要这个都疯了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T22:38:08.837

您可能需要考虑在数据表旁边添加一个审计表。

它只有您有兴趣跟踪历史记录的列以及日期时间列（记录更改日期），通常您还需要一些用户信息（即从连接中拉出登录用户或提供用户插入/更新中的名称）。

然后在您的数据表上创建一个更新触发器，并将新行从已删除的伪表中插入到您的审计表中。如果您正在执行更新，这将包含更新之前的数据，因为更新实际上是删除和插入。

还有一个更通用的解决方案，它建议使用 SQL CLR 来抽象实现一个独特的审计表并为您希望审计的每个数据表触发：[http ://www.sqljunkies.ddj.com/Article/4CD01686-5178 -490C-A90A-5AEEF5E35915.scuk](http://www.sqljunkies.ddj.com/Article/4CD01686-5178-490C-A90A-5AEEF5E35915.scuk)

# c# - 从 .NET 应用程序中读取和解码存储在图像或 PDF 文件中的 PDF-417 条形码

> ID：604233
> 
> 赞同：10
> 
> 时间：2009-03-02T22:09:26.503
> 
> 标签：c#, .net, barcode, decode

我正在寻找一个 .NET 库，它能够从嵌入在图像文件或 PDF 中的[PDF-417 条形码中解码数据。](http://en.wikipedia.org/wiki/PDF417)此时，我只能找到一个[Java 版本](http://turbulence.org/Works/swipe/barcode.html)和一个[C 版本](http://sourceforge.net/projects/pdf417decode/)。

理想情况下，这个库既是开源的又是免费的，但我怀疑这样的解码器是否存在。

我愿意尝试您可能体验过的现有产品的演示 - 这让我想到了一个问题 - 您是否有任何使用 .NET 阅读嵌入图像或 PDF 中的 PDF-417 条形码的经验，以及哪些可用产品你会建议这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-03T22:05:13.073

[ClearImage Barcode Recognition SDK for .NET](http://www.inliteresearch.com/barcode-recognition/)可能是解码 PDF 417 和许多其他条形码的最简单方法。我在许多项目中使用它......虽然它不是免费的

```
 var bitmap = WpfImageHelper.ConvertToBitmap(_BarcodeCam.BitmapSource);

        _ImageEditor.Bitmap = bitmap;
        _ImageEditor.AutoDeskew();
        _ImageEditor.AdvancedBinarize();

        var reader = new BarcodeReader();
        reader.Horizontal = true;
        reader.Vertical = true;
        reader.Pdf417 = true;

        //_ImageEditor.Bitmap.Save("c:\\barcodeimage.jpg", System.Drawing.Imaging.ImageFormat.Jpeg);

        var barcodes = reader.Read(_ImageEditor.Bitmap);

        if (barcodes.Count() > 0) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T22:35:17.983

[我们使用来自IDAutomation](http://www.idautomation.com)的 PDF417组件（不是免费的） 。他们很好。我们将它们用于编码，而不是读取和解码。

没用过他们的这个组件，但是看看它是C#的，你可以得到源代码，但同样，不是免费的。

[http://www.idautomation.com/barcode-recognition/](http://www.idautomation.com/barcode-recognition/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-27T09:21:08.283

试试这个

[http://platform.twit88.com/projects/mt-barcode](http://platform.twit88.com/projects/mt-barcode)

这是一个 zxing c# 端口

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-21T19:49:22.313

我刚刚成功地从 java 集成了 ZXing .Net 端口。它不如其他付费 SDK 强大——例如它无法检测旋转图像中的条形码。但是，它是免费的，如果您有预算，它可能对您有用。通常，您会发现付费 SDK 的价格在 400 美元以上。如果这意味着什么，它在 Nuget 上的下载量已超过一百万。

[https://github.com/micjahn/ZXing.Net](https://github.com/micjahn/ZXing.Net)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-19T02:27:41.900

Aspose 有一个适用于 .NET 和 Java 的 PDF417 编码器/解码器，但它不是开源的：[http ://www.aspose.com/categories/.net-components/aspose.barcode-for-.net/default.aspx](http://www.aspose.com/categories/.net-components/aspose.barcode-for-.net/default.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-01T17:19:26.240

Morovia 提供免费的[pdf417 解码器](http://forums.morovia.com/free-pdf417-decoder-pdf417decode-t231.html)。

# python - 如何在 Python 中解析十六进制或十进制整数

> ID：604240
> 
> 赞同：40
> 
> 时间：2009-03-02T22:10:36.313
> 
> 标签：python

我有一个字符串，它可以是前缀为“0x”的十六进制数字，也可以是没有特殊前缀的十进制数字，可能是减号。“0x123”以 16 为基数，“-298”以 10 为基数。

如何在 Python 中将其转换为 int 或 long？

我不想使用 eval() ，因为它不安全且矫枉过正。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-03-02T22:12:25.323

```
int("0x123", 0) 
```

（为什么不这样`int("0x123")`做？）

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-02T22:52:48.690

以 16 到 10 为基数（返回一个整数）：

```
>>> int('0x123', 16)
291 
```

以 10 到 16 为基数（返回一个字符串）：

```
>>> hex(291)
'0x123' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T22:16:13.350

像这样的东西可能是你正在寻找的东西。

```
def convert( aString ):
    if aString.startswith("0x") or aString.startswith("0X"):
        return int(aString,16)
    elif aString.startswith("0"):
        return int(aString,8)
    else:
        return int(aString) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-28T03:35:57.060

如果您在不同的数字系统之间进行大量转换，那么位串库使许多二进制/十六进制操作更容易。它还支持字符串解释：

[http://pythonhosted.org/bitstring/](http://pythonhosted.org/bitstring/)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2011-03-04T16:10:31.143

这是一个更简单的版本，就像一个魅力。返回字符串，因为 hex() 返回相同的类型：

```
def itoh(int): return hex(int)[2:] 
```

# c++ - OpenGL跨平台窗口

> ID：604247
> 
> 赞同：6
> 
> 时间：2009-03-02T22:13:35.370
> 
> 标签：c++, opengl, cross-platform

我正在寻找一个窗口......呃...... OpenGL的东西，我一直在使用SDL，但最近发现它至少在我见过的任何代码中都不能满足我的需求。我想找到一些 GUI 库，它允许我使用带有菜单栏的 OpenGL（和 SDL，如果可能的话）进行开发，可能在侧面有选项，以及一个开箱即用的关闭按钮。Qt 是我正在寻找的那种东西，但我想使用一些不会强迫我使其开源的东西。

我想要的东西的快速列表，一个工作关闭按钮，使用 OGL 的能力，跨平台，任何不强迫我成为开源、免费的许可证，以及全屏和动态更改分辨率的能力。

我已经搜索过自己，我真的不是一个懒惰的人；）我只是想在这里获得一些意见，然后再深入研究任何事情并发现它并不真正适合我的需求。

提前感谢您的任何反馈。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T22:16:46.110

试试 wxWidgets。[这里](http://www.wxwidgets.org/docs/tutorials/opengl.htm)有一个关于在 OpenGL 中使用它的链接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T22:36:59.587

当 Qt 4.5 发布时（我认为本月晚些时候）它将是 LGPL，因此如果您可以等待几周，您可以使用 Qt 而无需开源您的程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T22:18:43.500

[GLUT](http://www.opengl.org/resources/libraries/glut/)（GL 实用工具包）接近您正在寻找的东西。尽管不支持菜单栏，但它快速简便且跨平台。 [此页面](http://www.opengl.org/resources/libraries/windowtoolkits/)还有许多类似 GLUT 的替代品。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T22:38:05.373

对于开箱即用的关闭按钮启用窗口，您可以拥有[GLUT](http://www.opengl.org/resources/libraries/glut/)，如前所述，如果您的额外 GUI 需求非常简单，我认为 GLUT 可以为您提供一些。

您还可以使用[NVidia Widgets](http://code.google.com/p/nvidia-widgets/)或[AntTweakBar](http://www.antisphere.com/Wiki/tools:anttweakbar)使用简单的 OpenGL 渲染菜单和按钮。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T03:38:43.747

只要您可以将正确的信息传递给 OGL，您就不需要对 OGL 的“支持”。至少在 Windows 上，如果您有一个可以从中挂钩 HWND 的窗口 API，您可以设置 OGL 以使用几乎任何您想要的窗口。我已经用 wxWidgets 和直接的 win32 成功地做到了这一点。我无法在其他平台上为您提供帮助，但我怀疑您可以做类似的事情。

这也适用于 D3D，是一种将渲染代码与窗口 API 分离的好方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T22:24:25.343

SDL 可以创建 OpenGL Windows。

[http://gpwiki.org/index.php/C:SDL_OGL](http://gpwiki.org/index.php/C:SDL_OGL)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T11:10:02.937

有许多渲染的小部件库，例如 rotoglup 建议的那些。看看 CEGUI 和 QuickGUI，它们可能会让你开心（尽管 CEGUI 对 XML 的滥用令我失望）。这是一个无耻的插件：[GLICT](http://glict.sf.net/)。

# powershell - powershell exchange 2003：wmi-object 不拉所有邮箱存储？

> ID：604251
> 
> 赞同：0
> 
> 时间：2009-03-02T22:14:35.383
> 
> 标签：powershell, exchange-server

我从我的 Exchange Server 2003 中提取了以下代码。

```
 connect-qadservice -service 'localhost'    
foreach ($server in $exchangeservers)
    {
    $AllUsers += get-wmiobject -class Exchange_Mailbox -namespace Root\MicrosoftExchangeV2 -computername $server| select servername,storagegroupname, storename,mailboxdisplayname,totalitems,size, DeletedMessageSizeExtended, legacyDN, datediscoveredabsentInDS
    }
 $exchngver = "2003"

foreach ($user in $AllUsers)
{
  $obj = new-object psObject
  $office = get-qaduser -Identity $user.legacyDN | select office, description
}
disconnect-qadservice 
```

并且它不会抓取服务器上的所有邮箱存储。知道为什么或可能是什么原因造成的吗？

提前致谢

注意：IT 似乎获取了除第二个存储组中的 1 之外的所有邮箱存储。我不知道这是为什么...有趣的是我的 vbscript 使用相同的命名空间和类来抓取所有邮箱存储就可以了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T00:09:06.153

因此，从简单开始，在您展开并开始使用任务内容之前，它是否恢复正确？

您是否从以下渠道获得正确的号码：

```
(get-wmiobject -class Exchange_Mailbox -namespace Root\MicrosoftExchangeV2 -computername srv02).count 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T08:50:38.987

几件事（不确定它们是原因（#1））：

1.  您正在循环`$exchangeservers`但不要使用`$server`（`-computerName`有一个固定的“srv02”服务器名称）。

2.  我将移出`connect-qadservice -service 'localhost'`服务器`foreach`循环（您为 exchangeservers 中的每个服务器调用它）。

3.  您要调用`get-qaduser`两次（`$tmp`和`$office`）来获取用户办公室和描述，您可以一次调用（`$tmo`多余）：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T14:10:59.583

您是否检查了商店/SG 的权限？

# c# - HttpWebRequest 不返回，连接关闭

> ID：604252
> 
> 赞同：1
> 
> 时间：2009-03-02T22:14:59.173
> 
> 标签：c#, asp.net, web-services, httpwebrequest

我有一个 Web 应用程序正在轮询另一台服务器上的 Web 服务。服务器位于同一网络上，并由内部 IP 引用，在端口 8080 上运行。

每 15 秒发出一个请求，该请求会收到一个带有作业信息的 xml 响应。95% 的情况下，这很好用，但是在随机时间，对服务器的请求为空，并报告“远程主机强制关闭响应”。

研究这个问题，其他人设置了 KeepAlive = false。这并没有解决问题。Web 服务器正在运行 .NET 3.5 SP1。

```
Uri serverPath = new Uri(_Url);

// create the request and set the login credentials
_Req = (HttpWebRequest)WebRequest.Create(serverPath);
_Req.KeepAlive = false;
_Req.Credentials = new NetworkCredential(username, password);
_Req.Method = this._Method; 
```

调用响应：

```
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
_ResponseStream = response.GetResponseStream(); 
```

方法是 GET。我尝试更改超时，但默认值足够大，可以考虑到这一点。

我们执行的另一个请求是将数据发布到服务器的 POST，我们也随机遇到相同的问题。没有影响这一点的防火墙，我们排除了病毒扫描程序。非常感谢任何有助于解决此问题的想法！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T22:24:04.767

您是否正在关闭响应流并处理响应本身？这是 WebRequest “挂起”的最常见原因 - 您可以同时打开到同一台计算机的连接数是有限的。GC 最终将完成连接，但如果您正确处理它们，这不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T22:41:56.907

我不排除网络问题是问题的可能原因。您是否对您的服务器运行 ping 以查看您是否收到与失败请求相对应的丢弃数据包？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-18T07:37:14.237

将 FtpWebRequest 对象的超时属性设置为最大值，我用 4 GB 文件尝试过，效果很好。

# python - Django 设置默认表单值

> ID：604266
> 
> 赞同：279
> 
> 时间：2009-03-02T22:18:18.243
> 
> 标签：python, django, django-models, django-forms

我有一个模型如下：

```
class TankJournal(models.Model):
    user = models.ForeignKey(User)
    tank = models.ForeignKey(TankProfile)
    ts = models.IntegerField(max_length=15)
    title = models.CharField(max_length=50)
    body = models.TextField() 
```

我也有上述模型的模型形式如下：

```
class JournalForm(ModelForm):
    tank = forms.IntegerField(widget=forms.HiddenInput()) 

    class Meta:
        model = TankJournal
        exclude = ('user','ts') 
```

我想知道如何设置该坦克隐藏字段的默认值。到目前为止，这是我显示/保存表单的功能：

```
def addJournal(request, id=0):
    if not request.user.is_authenticated():
        return HttpResponseRedirect('/')

    # checking if they own the tank
    from django.contrib.auth.models import User
    user = User.objects.get(pk=request.session['id'])

    if request.method == 'POST':
        form = JournalForm(request.POST)
        if form.is_valid():
            obj = form.save(commit=False)

            # setting the user and ts
            from time import time
            obj.ts = int(time())
            obj.user = user

            obj.tank = TankProfile.objects.get(pk=form.cleaned_data['tank_id'])

            # saving the test
            obj.save()

    else:
        form = JournalForm()

    try:
        tank = TankProfile.objects.get(user=user, id=id)
    except TankProfile.DoesNotExist:
        return HttpResponseRedirect('/error/') 
```

* * *

## 回答 #1

> 赞同：468
> 
> 时间：2009-03-02T22:29:46.780

您可以使用[这里](https://djangobook.com/tying-forms-views/#setting-initial-values)解释的*初始*

在调用表单构造函数时，您有两个选项可以填充值：

```
form = JournalForm(initial={'tank': 123}) 
```

或在表单定义中设置值：

```
tank = forms.IntegerField(widget=forms.HiddenInput(), initial=123) 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2018-03-30T13:39:42.067

其他解决方案：创建表单后设置初始值：

```
form.fields['tank'].initial = 123 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-02-12T18:18:27.023

如果您从 POST 值创建模型表单，则可以通过以下方式分配初始值：

```
form = SomeModelForm(request.POST, initial={"option": "10"}) 
```

[https://docs.djangoproject.com/en/1.10/topics/forms/modelforms/#providing-initial-values](https://docs.djangoproject.com/en/1.10/topics/forms/modelforms/#providing-initial-values)

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2018-04-03T00:17:03.010

我有这个其他解决方案（我发布它以防我这样的其他人使用模型中的以下方法）：

```
class onlyUserIsActiveField(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(onlyUserIsActiveField, self).__init__(*args, **kwargs)
        self.fields['is_active'].initial = False

    class Meta:
        model = User
        fields = ['is_active']
        labels = {'is_active': 'Is Active'}
        widgets = {
            'is_active': forms.CheckboxInput( attrs={
                            'class':          'form-control bootstrap-switch',
                            'data-size':      'mini',
                            'data-on-color':  'success',
                            'data-on-text':   'Active',
                            'data-off-color': 'danger',
                            'data-off-text':  'Inactive',
                            'name':           'is_active',

            })
        } 
```

初始在`__init__`函数上定义为`self.fields['is_active'].initial = False`

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2020-05-13T11:51:44.317

正如[Django 文档](https://docs.djangoproject.com/en/stable/ref/forms/api/#dynamic-initial-values)中所解释的，`initial`不是`default`。

*   字段的**初始**值旨在以 HTML 形式显示。但是如果用户删除了这个值，最后给这个字段发回了一个空白值，这个`initial`值就丢失了。因此，您不会获得*默认*行为所期望的内容。

*   **默认**`data`行为是：如果参数不包含该字段的任何值，则验证过程将采用的值。

要实现这一点，一种简单的方法是结合`initial`and `clean_<field>()`：

```
class JournalForm(ModelForm):
    tank = forms.IntegerField(widget=forms.HiddenInput(), initial=123) 

    (...)

    def clean_tank(self):
        if not self['tank'].html_name in self.data:
            return self.fields['tank'].initial
        return self.cleaned_data['tank'] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-06T08:23:06.327

我希望这可以帮助你：

```
form.instance.updatedby = form.cleaned_data['updatedby'] = request.user.id 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-25T10:47:03.260

我在开发过程中也遇到了需要在表单中设置默认值。我的解决方案是

```
initial={"":""}
form=ArticleModel(request.POST)
if form.has_changed():
    data = {i: form.cleaned_data[i] for i in form.changed_data}
    data.update({key: val for key, val in init_praram.items() if key not in form.changed_data}) 
```

使用 form.has_changed ，如果需要 form.fields 可以使用这个方法

# javascript - 动态调整 iframe 的大小

> ID：604272
> 
> 赞同：4
> 
> 时间：2009-03-02T22:20:12.327
> 
> 标签：javascript, html, dom

我可以看到这个问题已经被问过好几次了，但是所提出的解决方案似乎都不适用于我正在构建的网站，所以我重新打开了这个帖子。我正在尝试根据内容的高度来调整 iframe 的大小。包含 iframe 的页面和它的源页面都存在于同一个域中。

我已经在以下每个线程中尝试了建议的解决方案：

*   [根据其中的内容高度调整 iframe 高度](https://stackoverflow.com/questions/525992/resize-iframe-height-according-to-content-height-in-it)
*   [根据内容调整 iframe 的大小](https://stackoverflow.com/questions/153152/resizing-an-iframe-based-on-content)

我相信上面的解决方案不起作用，因为当引用 body.clientHeight 时，浏览器实际上并没有确定文档的高度。

这是我正在使用的代码：

```
 var ifmBlue = document.getElementById("ifmBlue");
    ifmBlue.onload = resizeIframe;

    function resizeIframe()
    {
        var ifmBlue = document.getElementById("ifmBluePill");
        var ifmDiv = ifmBlue.contentDocument.getElementById("main");
        var height = ifmDiv.clientHeight;
        ifmBlue.style.height = (ifmBlue.contentDocument.body.scrollHeight || ifmBlue.contentDocument.body.offsetHeight || ifmBlue.contentDocument.body.parentNode.clientHeight || height ||  500) + 5 + 'px';
    } 
```

如果我使用 fire debug 调试脚本，iframe.contentDocument 的主 div 的客户端高度为 0。此外，body.offsetHieght 和 body.scrollHeight 为 0。但是，在脚本运行完成后，如果我检查 DOM HTML iframe 元素（使用 Fire 调试）我可以看到主体的 clientHeight 为 456，内部 div 的 clientHeight 为 742。这让我相信当 iframe.onload 被触发时这些值尚未设置。因此，根据上述线程之一，我将代码移动到 iframe 源页面的 body.onload 事件处理程序中。该解决方案也不起作用。

非常感谢您提供的任何帮助。

谢谢，

CJ

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-14T08:41:08.143

DynamicDrive 有[这样一个脚本](http://dynamicdrive.com/dynamicindex17/iframessi.htm)，我认为它可以满足您的要求。

现在还有一个[更新的版本](http://www.dynamicdrive.com/dynamicindex17/iframessi2.htm)。

* * *

# 2011 年更新：

我*强烈*建议在这样的事情上使用 AJAX，特别是考虑到动态调整大小的 iframe 只适用于同一个域。

即便如此，它还是有点不确定，所以如果你绝对必须在标准页面加载上使用 AJAX，那么你真的，*真的*应该使用类似的东西`history.pushState`（并且将标准页面加载作为不支持它的浏览器的后备）。有一个 jQuery 插件可以为您处理这些内容，由 GitHubber 编写，名为[pjax](https://github.com/defunkt/jquery-pjax)，它们*仅*用于 repo 导航。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T23:13:57.010

你移动了处理程序？也许您也应该将该函数移动到内部框架，以便在获取高度值时直接引用主体而不是框架对象...然后调用 parent.set 高度函数

另一个技巧，在 settimeout 10 毫秒后调用函数

我记得我曾经遇到过这个问题，但是我使用 IE 的 getBoundingClientRect() 来获取内容的高度，检查 mozilla 开发人员中心是否有类似的东西，这只是一个提示，我没有研究它

另一方面，ifmBluePill 是什么？是 iframe 吗？还是里面的div？为什么要引用 div 的“contentDocument”？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-16T19:50:04.250

顺便说一句，DynamicDrive 改进了他们的脚本，即使 iframe 内容发生变化也总是调整大小：[http ://www.dynamicdrive.com/dynamicindex17/iframessi2.htm](http://www.dynamicdrive.com/dynamicindex17/iframessi2.htm)

从他们的页面：

> 这是原始 Iframe SSI 脚本的第二版，与原始脚本一样，您可以通过 IFRAME 在页面上无缝显示外部内容。它通过将 IFRAME 的大小动态调整为其中包含的页面的高度来实现这一点，从而消除了任何可能出现的 IFRAME 滚动条，同时紧贴地显示整个外部内容。将其视为使用 DHTML 模拟的 SSI（包括服务器端）！此脚本适用于 IE5+ 和 NS6+，对于其他浏览器，支持完全隐藏相关 iframe 或使用其默认高度显示它的选项。
> 
> 现在，此脚本与原始脚本的不同之处在于，即使在页面加载后，您也可以将其他文档* 加载到 IFRAME 中，并且 IFRAME 将动态调整其高度以适应新文档。因此，如果您不仅需要通过 IFRAME 标记显示外部内容，而且打算在页面加载后更改此内容，请使用此脚本。

# sql-server - 请提供建议：使用实体框架时的 SQL Server 标识与唯一标识符键

> ID：604273
> 
> 赞同：3
> 
> 时间：2009-03-02T22:20:26.350
> 
> 标签：sql-server, entity-framework, replication, identity, uniqueidentifier

我正在设计一个相当复杂的系统。我们的主要关注点之一是支持 SQL Server 对等复制。这个想法是支持几个地理上分离的节点。

第二个问题是在中间层使用现代 ORM。我们的首选一直是实体框架，主要是因为开发人员喜欢使用它。（他们喜欢 LiNQ 支持。）

所以问题来了：

考虑到点对点复制，我决定对每个表的主键使用具有默认值 newsequentialid() 的 uniqueidentifier。这似乎在避免键冲突和减少索引碎片之间提供了良好的平衡。

然而，事实证明，当前版本的 Entity Framework 有一个[非常奇怪的限制](http://blogs.msdn.com/dsimmons/pages/ef-faq-entity-services.aspx#Section_17)：如果实体的键列是唯一标识符 (GUID)，则无法将其配置为使用数据库提供的默认值 (newsequentialid())。应用层必须生成 GUID 并填充键值。

所以这里是辩论：

1.  放弃实体框架并使用另一个 ORM：
    *   使用 NHibernate 并放弃对 LiNQ 的支持
    *   使用 linq2sql 并放弃未来的支持（更不用说绑定到数据库上的 SQL Server）
2.  放弃 GUID 并采用另一种 PK 策略
3.  设计一种在应用层生成顺序 GUID（COMB？）的方法

我倾向于使用 linq2sql（我的开发人员真的很喜欢 linq2[stuff]）和 3 的选项 1。这主要是因为我有点不知道支持我们目标的复制方案的替代关键策略，同时也让事情保持清醒开发人员的观点。

任何见解或意见将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T06:32:48.803

我同意克雷格的建议 - 选项 4。

您始终可以使用由中间层填充的 GUID 列作为您的 PRIMARY KEY（这是一个 LOGICAL 构造）。

为避免大量索引（因此：表）碎片，请使用其他一些键（最好是 INT IDENTITY 列）作为 CLUSTERING KEY - 这是一个物理数据库结构，可以与主键分开。

默认情况下，主键是集群键——但不一定是这样。事实上，通过在我“继承”的数据库上执行此操作，我提高了性能并大大降低了碎片 - 添加一个 INT IDENTITY 列并将集群键放在那个小、不断增长、永不改变的 INT 上 - 就像一个魅力！

马克

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T02:10:02.337

嗯？我认为您的三个选项是错误的选择。考虑选项 4：

> 4) 将实体框架与*非顺序的*、客户端生成的 GUID 一起使用。

EF 看不到*由框架本身插入的新行*的数据库服务器生成的 GUID，当然，但您不需要在数据库服务器上生成 GUID。您可以在创建实体实例时在客户端上生成它们。GUID 的全部意义在于在哪里生成它并不重要。至于由复制数据库生成的 GUID，EF 会很好地看到它们。

您的客户端 GUID 不会是连续的（使用 Guid.NewGuid()），但它们将是全球范围内的，保证唯一。

我们在具有复制功能的运输、生产软件中执行此操作。它*确实*有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-24T12:57:16.480

另一个选项（发布时不可用）是升级到支持服务器生成的 GUID 的 EF 4。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T01:06:15.767

为什么不使用标识列？如果您正在进行合并复制，您可以让每个系统从一个单独的种子开始并朝一个方向工作（例如，节点 a 从 1 开始并加 1，节点 b 从 0 开始并减一）...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T19:42:51.097

如果你真的坚持使用 NewSequentialID()，你可以使用存储过程。您可以将过程中的结果列绑定到适当的属性，一旦插入，SQL 生成的 GUID 就会反馈到对象中。

不幸的是，您必须为所有三个操作（插入、更新、删除）定义 SP，即使其他操作可以使用默认值正确完成。您还需要维护 SP 代码并确保它在您进行更改时与您的 EF 模型同步，这可能会因为额外的开销而使此选项没有吸引力。

[http://blogs.msdn.com/bags/archive/2009/03/12/entity-framework-modeling-action-stored-procedures.aspx](http://blogs.msdn.com/bags/archive/2009/03/12/entity-framework-modeling-action-stored-procedures.aspx)有一个分步示例，非常简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T05:51:56.940

将 newseqid 与您自己的 orm 一起使用（这并不难）和 linq

# html - 网页上的所有链接都应该加下划线吗？

> ID：604277
> 
> 赞同：4
> 
> 时间：2009-03-02T22:21:17.673
> 
> 标签：html, web-standards

是否有规定所有链接都应加下划线以使它们看起来像链接？例如，我见过很多网站的页脚没有带下划线的链接。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-02T22:23:09.200

没有规则，但是让您的设计按照用户期望的方式运行是很好的设计（大多数用户希望文本中的链接带有下划线）。因此，如果您不给它们下划线，请确保外观明显可点击。见：[http ://www.useit.com/alertbox/20040510.html](http://www.useit.com/alertbox/20040510.html)

我个人无法忍受文本中没有下划线的链接（参见：Stack Overflow）。您不必擦洗文本即可查看可点击的内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T22:23:27.200

我会说不，这些天下划线链接非常恶心。您在本网站上看到任何带下划线的文字吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T22:23:50.040

没有规则，但如果网页上的链接以某种方式从周围的文本中脱颖而出，它确实可以帮助人们浏览您的网站，并且一种方便的方法是让它们加下划线。这样，您可以随心所欲地为它们着色，但它们仍然会脱颖而出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-06-14T06:52:51.837

我见过的使用下划线的最大论点（无法指出确切的位置）是可访问性。尽管对于那些有权看到颜色的用户来说改变链接的颜色可能就足够了，但对于那些色盲的用户来说，他们可能会遇到极端的问题，试图在没有任何其他区别的情况下找到链接。

我发现虽然下划线不是最干净的外观，但对于许多专业人士来说它看起来并不可怕，包括我上面提到的可访问性以及下划线的即时“知道如何使用”因素非常值得。我谈到了与正文中的链接有关的这些观点。在主站导航、页脚等非常明显的地方当然可以更自由地自定义。

很抱歉复活了一个旧线程，但我看到没有人提到带下划线的链接的色盲论点，所以我认为对于未来阅读这篇文章的任何人来说都是值得的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T22:24:47.400

以[Stackoverflow](http://stackoverflow.com)为例。=p

做你想做的。就个人而言，我喜欢没有下划线的链接的简洁外观，以便在我的网站上获得更多“按钮式”的感觉。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T22:25:07.040

链接应该与普通文本区分开来。如果您通过在它们下划线或仅通过更改其颜色来做到这一点，那是您的决定。下划线只是经典的方式。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-02T22:56:01.477

链接不必加下划线——我认为下划线本身很难阅读，而且我们继承了一个糟糕的默认标准。

但链接应该是**一致**的。换句话说，无论您的链接是什么颜色或样式，只要有可能，请在整个站点中使用相同的颜色和样式。不要让一件事变成红色，另一件事变成绿色。

是的，我们有时会在 Stack Overflow 上打破这条规则。请注意，这个问题的标题是一个可点击的链接，但它不在链接颜色中，因为那会有点......令人讨厌。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-02T22:22:52.600

这是一个美学决定——看起来最好的取决于你。没有定义这种事情的网络标准。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-02T22:23:22.567

您可以向用户提供哪些其他视觉提示，即文本是链接而不是普通文本？不同的颜色作品，也许是一种风格？

从视觉上看，下划线简单而通用，但没有硬性规定。让它们显而易见。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-02T22:23:24.317

不一定，但是当用户悬停链接时，它可能会被加下划线。并且链接应该以某种方式脱颖而出，要么更大胆，要么颜色不同。蓝色是一种极好的超链接颜色。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-02T22:23:40.867

没有你必须遵守的“规则”。这是一种常见的界面约定，它告诉人们这些词实际上是链接。如果你选择不给它们下划线，你应该找到一些其他的方法来告诉人们哪些词是链接，如果不清楚的话。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-02T22:24:08.930

只要页面上的链接作为链接是不同的，您就应该没问题。

例如：

与文本的其余部分不同的颜色

悬停时改变颜色

有背景颜色

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-02T22:24:32.113

没有硬性规定说它们**必须**加下划线，但是有一个普遍的约定是链接应该与常规文本有*明显的区别*（并且应该始终显示链接光标，例如“手”光标）。

然而，人们普遍认为，用户识别带下划线的链接比那些不符合某人“期望”为链接的链接更快。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-02T22:39:21.127

链接应该看起来可区分且可点击，而无需将鼠标悬停在屏幕上。如果你想摆脱正常的布局，最好有一个朋友，一个不精通技术的朋友试试这个网站，看看他们的想法。如果他们可以在没有问题或打嗝的情况下从一个页面导航到另一个页面，那么该页面很好，否则您应该重新考虑您的方法。拥有一个好看的网站是一件好事，但让它可用是另一件好事。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-02T22:50:39.163

如果您只对链接使用彩色文本，则不需要下划线。

在设计不允许高对比度链接颜色的情况下，您可能需要使用下划线。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-02T23:59:15.117

我真正讨厌的是那些在没有链接的文本下划线的网站......请不要那样做。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-02T22:41:34.520

页面应该保持一致——如果一个链接带有下划线，那么它们都应该是。如果你不喜欢带下划线的链接，没什么大不了的——只要让它们保持不变，以获得更好的用户界面。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-02T22:42:04.647

所有网页设计的重要一点是清晰。如果您没有为链接添加下划线，那么您应该至少提供一致的渲染方法（例如后退或前景色）和一些直观的视觉反馈给用户以指示链接存在，例如悬停时下划线，鼠标图标更改或改变以前的前或后颜色。

测试这些东西的最好方法是创建一个模型并让你的大人去做。如果她第一次明白，那么你已经说清楚了！

快乐编码。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-02T22:48:53.770

我不介意任何一种方式。差不多吧。
至少，蓝色下划线是用户识别为链接的明确信号。一个完善的约定以及浏览器默认设置。这就是为什么大多数网页设计文章建议避免下划线印刷效果。
而且我不喜欢看起来不像链接的链接。例如，我最近发现了一个带有完全相同字体的黑色文本和深灰色链接（或者是相反的链接？）的网站：很难看到链接（除非用鼠标扫描！ack！）。
同样，将已访问链接与未访问链接区分开来是一种很好的做法：这是一个很好的导航帮助。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-02T22:58:24.153

这真的取决于让它们在页面上脱颖而出是否是一个有用的属性。

例如，维基百科取消了这条线，这可能是一件好事，考虑到如果保留默认设置，一半的页面会被加下划线。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-02-08T21:30:02.723

只要很明显什么是链接，什么不是链接，我认为去掉带下划线的链接是完全可以接受的。

# javascript - 将行插入表中

> ID：604281
> 
> 赞同：1
> 
> 时间：2009-03-02T22:22:52.850
> 
> 标签：javascript, html-table, innerhtml

在 IE 中将 X 行插入到表中的最佳纯 JavaScript 方法是什么。

表格 html 如下所示：

```
<table><tbody id='tb'><tr><td>1</td><td>2</td></tr></tbody></table> 
```

我需要做的是删除旧正文，然后插入一个 1000 行的新正文。我有我的 1000 行作为 javascript 字符串变量。

问题是IE中的table没有innerHTML函数。我见过很多黑客来做到这一点，但我想看看你最好的。

注意：使用 jquery 或任何其他框架不计算在内。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T22:37:34.890

这是实施 IE 的人写的一篇很棒的文章，`innerHTML=`介绍[了他如何让 IE 去做`tbody.innerHTML="<tr>..."`](http://www.ericvasilik.com/2006/07/code-karma.html)：

> 起初，我认为 IE 无法对带有 innerHTML 的已修改表格执行重绘，但后来我想起了我对这个限制负责！

顺便说一句，他使用的技巧基本上是所有框架如何为`table`/`tbody`元素执行此操作。

*编辑*：@mkoryak，你的评论告诉我你的想象力为零，不值得回答。但无论如何我都会取笑你。你的观点：

> 他没有插入我需要的东西

世界卫生大会？他正在将行（他作为 html 字符串）插入到`table`元素中。

> 他还使用了一个额外的隐藏元素

该元素的重点是说明所有 IE 需求都是“上下文”。您可以使用动态创建的元素 ( `document.createElement('div')`)。

> 而且文章很旧

我再也不会帮助你了；）

但说真的，如果您想了解其他人是如何实现它的，请查看 jQuery 源代码[`jQuery.clean()`](http://dev.jquery.com/browser/trunk/jquery/src/core.js#L890)或 Prototype 的[`Element._insertionTranslations`](http://www.prototypejs.org/assets/2008/1/25/prototype-1.6.0.2.js).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T22:28:36.113

像 jQuery 那样做，例如。添加`<table>`并`</table>`围绕它，插入文档并将您想要的节点移动到您想要它们的位置并丢弃临时元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:29:01.463

代码最终是这样的：

```
 if($.support.scriptEval){
    //browser needs to support evaluating scripts as they are inserted into document
        var temp  = document.createElement('div');
    temp.innerHTML = "<table><tbody id='"+bodyId +"'>"+html;
    var tb = $body[0];
    tb.parentNode.replaceChild(temp.firstChild.firstChild, tb);
    temp = null;
    $body= $("#" + bodyId);
    } else {
    //this way manually evaluates each inserted script
        $body.html(html);
    } 
```

必须事先存在的东西：一个表，其主体的 id 为“bodyId”。$body 是一个全局变量（或者函数上有一个闭包），其中也有一些 jquery，因为 IE 不会评估动态插入到 html 中的脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-10T16:38:05.177

我遇到了同样的问题（和很多其他人一样），在玩了很多之后，这就是我要工作的地方。

您必须通过 document.createelement ('tr') 创建一个 tr，然后以同样的方式创建一个 td。将 td 附加到 tr，将 tr 附加到 tbody（而不是表）然后您可以使用您创建的 td 的 innerhtml 并且它将起作用。这是我使用的ie8。基本上，表格结构必须使用 createelement 制作，但其余部分可以是 innerHTMLed。我在 IE8 调试器中观看，它会说它会添加它（如果我做了 tr.innerhtml="blah"）并且没有给出错误，但它不会显示，并且 html dom 视图显示非常破碎表（没有 td 出现过，但 /td 出现了）

因此，当我最终通过 createelement 调用执行 tr AND td 时，它创建了一个外观正确的 dom 并正确绘制了页面。

# asp.net - 网页加载时出现零散？

> ID：604289
> 
> 赞同：1
> 
> 时间：2009-03-02T22:23:42.677
> 
> 标签：asp.net, html, css

第一次加载页面时，图像不会显示一秒钟（就像它们不可见一样）。页面的结构变得显得分散。如果你点击刷新，那很好。有没有可以解决这个问题的修复程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T22:27:59.517

如果问题完全出在图像上，我相信您可以使用标签的`height`and`width`属性`<img>`来告诉浏览器图像的大小。这将允许它在能够加载所有内容之前正确“放置”所有内容。

编辑：其他人建议使用 CSS，我相信使用 CSS 中的`height`and`width`指令会给您带来与使用`<img>`标签的相同属性相同的结果，但不会严格限制您使用图像，并且 a 将与任何`margin`or`padding`指令一起玩得更好你可能会使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T22:25:57.257

是的，但它们都不是很简单。最简单的方法之一是将页面隐藏在 div 或其他内容中，直到所有内容都加载完毕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T22:27:26.303

这就是 HTML 在完全加载之前的布局方式。它在加载时显示正在加载的内容。当元素被加载时，它们可能会推动事物以适应 HTML 的宽容。

如果您希望页面在加载时“正确”加载，请查看 CSS 布局。

当您点击刷新时它会正确显示，因为数据已经缓存在您的计算机上并且加载速度更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T15:23:51.820

试试这个：

```
<script type="text/javascript">
window.onload = function() {
    document.body.style.display = 'none';
    document.body.style.display = 'block';
};
</script> 
```

# c# - 良好、安全的加密

> ID：604290
> 
> 赞同：2
> 
> 时间：2009-03-02T22:23:43.567
> 
> 标签：c#, .net, security, file-transfer

嗨，我正在考虑开发一种文件传输程序，并且想知道我是否想要像我能得到我应该使用的那样好的加密？

我会用 c# 开发它，所以我可以访问 .net lib :P 在我的 USB 上有一个证书来访问服务器是没有问题的，如果这会增加安全性！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T22:29:30.150

.NET Framework 最简单的内置方式可能是使用内置的[SslStream](http://msdn.microsoft.com/en-us/library/system.net.security.sslstream.aspx)类。使用示例[here](http://geekswithblogs.net/luskan/archive/2007/10/01/115758.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T22:27:58.267

[研究通过SSL](http://en.wikipedia.org/wiki/Transport_Layer_Security)建立隧道连接。它为您完成所有艰苦的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T08:02:54.470

您可以使用 System.IO.MemoryStream 围绕常规数组包装流。

# c# - 创建具有可变宽度字体的文本列

> ID：604298
> 
> 赞同：6
> 
> 时间：2009-03-02T22:24:32.347
> 
> 标签：c#, text-formatting, windows-live-messenger

我正在尝试为将在 MSN Messenger 上运行的 C# 应用程序创建文本列。我很难让一切都排队。

这是我想要的输出示例：

```
1)  Pizza Hut                                            123 Fake St.
2)  Domino's Pizza                                       123 Fake St.
3)  The Cheesecake Cafe                                  123 Fake St.
4)  Capital Pizza & Steakhouse                           123 Fake St.
5)  Funky Pickle Pizza                                   123 Fake St.
6)  Boston Pizza                                         123 Fake St.
7)  Rose Bowl Rouge Lounge                               123 Fake St.
8)  Royal Pizza                                          123 Fake St.
9)  A Columbus Pizza & Donair Inc                        123 Fake St. 
```

但因为它是可变宽度字体，所以显示如下：

```
1)  Pizza Hut                                        123 Fake St.
2)  Domino's Pizza                                   123 Fake St.
3)  The Cheesecake Cafe                                  123 Fake St.
4)  Capital Pizza & Steakhouse                               123 Fake St.
5)  Funky Pickle Pizza                                   123 Fake St.
6)  Boston Pizza                                     123 Fake St.
7)  Rose Bowl Rouge Lounge                               123 Fake St.
8)  Royal Pizza                                          123 Fake St.
9)  A Columbus Pizza & Donair Inc                    123 Fake St. 
```

我尝试过使用 C# string.PadRight() 函数以及创建自己的函数来使用空格和制表符添加填充。两者都适用于固定宽度的字体，但会破坏可变宽度的字体。

有没有办法确定给定字体中字符串的宽度？

或者有人有其他建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T22:29:30.540

只需使用[TextRenderer](http://msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.aspx)类。最简单的情况：

```
Size size = TextRenderer.MeasureText("Hello world", someFont); 
```

如果您无权访问 System.Windows.Fonts [Graphics.MeasureString](http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx)仍然存在，它有一些限制，但应该可以完成工作：

```
Bitmap bmp = new Bitmap(1,1);
Graphics graphics = Graphics.FromImage(bmp);
SizeF size = graphics.MeasureString("Hello world", someFont); 
```

但请注意，如果您的文本字体和空格必须相同，则会出现无法完美对齐文本的情况。我不知道 MSN Messenger 在您的情况下能做什么，但除非您至少可以访问 HTML 的子集，否则您将无法获得完美的输出。

您还应该知道，如果您在本地计算机上进行测量并发送到另一台没有安装正确字体的列，您的列将不再看起来像列，因此您仅限于所有计算机上存在的基本字体子集。

如果多操作系统支持也是一项要求，您将遇到一些大问题，因为 Mac 和 PC 上的 Arial 字体看起来（和测量）并不完全相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T22:27:45.723

您可以尝试使用 Graphics 类来测量给定特定字体的字符串的长度，然后使用它来确定要使用多少个选项卡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T07:17:21.177

看起来您正试图在单个文本字段中以 ASCII 格式呈现这一切。是的？如果是这样的话，那就太棘手了。看起来你现在每个标签后面都有固定数量的标签，这就是问题所在。您可以改为使用空格 - 我怀疑您正在使用 padright （不太熟悉该特定功能）。

然而，关键是，像这样的纯 ASCII，以可变宽度字体显示，你永远不会让它在第二列中完美排列。如果你勤奋，你可以把它弄得很近，但就是这样——如果你有一排有很多大写的 W，而另一排有很多小写的 i，那么无论你做什么，都会有很大的宽度差异。如果您在 GDI 中进行渲染，最好的方法是每列调用一次 DrawText。如果需要，您可以从每列中制作一个大字符串，然后在第一列上调用 MeasureString 以确定您需要为第二列移动多少空间。

或者，如果这是一个可以执行 html 的界面，表格或 div 会很好用。取决于您的环境的具体情况。如果这是 WinForms 等，您还可以在 FlowLayout 面板中设置两个自动高度设置标签等。有很多选项可以使这项工作正常工作，但不是纯 ascii 具有可变宽度字体。

编辑：另外，我看到您询问如何在 Web 服务中获取 Graphics 类实例。你可以这样做：

```
 private static Bitmap bitmap = new Bitmap( 1, 1 );
    private static Graphics graphics = null;

    public static Graphics GetGeneralGraphics()
    {
        if ( graphics == null )
            graphics = Graphics.FromImage( bitmap );
        return graphics;
    } 
```

您可能希望在 Web 服务上下文中创建这些局部变量（完成后正确处理）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-02T22:28:33.540

您可能应该在 HTML 中格式化所有内容，然后您可以为列输出 TABLE 和 TR/TD 元素

# php - 保存动态创建页面的原始 html

> ID：604303
> 
> 赞同：1
> 
> 时间：2009-03-02T22:25:39.833
> 
> 标签：php, javascript, jquery, dynamic

我正在编写一个应用程序，它允许用户编辑日历、它的描述和其他一些东西。我正在使用 jquery、php 和 mysql。每次用户进行更改时，它都会异步更新数据库。

我想让他们选择将他们制作的内容变成 pdf。有没有一种方法可以在用户进行更改后将页面的原始 html 发布到我的服务器？

我可以在服务器上仅使用 php 重新生成页面，但如果可能的话，这种方式会更容易。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T22:36:07.873

您可以使用它来获取页面的大部分 HTML：

```
var htmlSource = document.getElementsByTagName('html')[0].innerHTML; 
```

但是，它将缺少打开和关闭 HTML 标记和文档类型，这对您来说可能无关紧要，因为您可以很容易地在服务器上重新创建它。

我假设您可以使用已经使用的相同 AJAX 将*htmlSource*发送到服务器，一旦您获取了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T22:40:45.333

您当然可以`innerHTML`从 jQuery 返回您可以选择的任何对象，尽管这似乎不是最好的方法（请参阅其他答案以获取替代方案）。

当心[XSS 攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)。如果您只是来回运行 HTML 而不首先检查它，那么您将面临重大风险。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T22:37:36.433

从服务器重新生成页面将是您最好的选择。为了获得良好的下载体验，您需要能够发送 Content-Type 和大小的标头。

为了回答您的问题，我将使用[输出缓冲](http://us.php.net/manual/en/ref.outcontrol.php)来捕获脚本的输出，然后使用可用于将 HTML 转换为 PDF 的众多工具之一。

# javascript - Greasemonkey 脚本可以覆盖 AdBlock 过滤器吗？

> ID：604304
> 
> 赞同：2
> 
> 时间：2009-03-02T22:25:46.807
> 
> 标签：javascript, greasemonkey, adblock

我有一个[Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/748)脚本试图访问[Adblock](http://adblockplus.org)禁用的 HTML 元素。是否可以使用 Greasemonkey 脚本创建解决方法以防止与 Adblock 插件发生冲突？

我对任何想法持开放态度，但是目前更改脚本以避免 Adblock 元素并不是解决方案。

**附加信息**

我试图“启用”的 addblock 元素是来自谷歌搜索结果的 Table 元素。

```
<table id="mbEnd" width="30%" style="margin-bottom: 1em;"> 
```

隐藏元素的 Adblock 过滤器是：

```
google.com,google.com.au,google.co.uk,google.ca,google.se#table(id=mbEnd)(width=30%) 
```

**更新：**有些人建议我简单地禁用我正在处理的页面的 adblock 过滤器。我也认为这是一个非解决方案，因为任何使用我的脚本的人都必须执行相同的操作，而且我不能指望我的所有用户都手动修改他们的 Adblock 设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T22:29:15.580

您可以为特定页面或域禁用广告拦截。只需单击符号旁边的箭头，它就会为您提供更多禁用广告拦截的选项。

没有办法让 Greasemonkey 脚本自动覆盖 Adblock，因为 Adblock 在加载任何 Greasemonkey 脚本之前会影响页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T05:29:51.723

您要访问什么类型的元素？大多数页面元素应该仍然可用，只是使用'display：none;'。

我在我的 Greasemonkey 脚本中使用 jQuery，并且在我使用 ABP 禁用它之后，它能够从图像中获取替代文本。

```
$('#s1 + img')[0].alt
=> Rohm and Haas Paint Quality Institute 
```

如果您提供一些更具体的信息，我也许能够提供更具体的解决方案。

访问被阻止的 iframe 可能更难但可行。同样，更多细节将帮助我回答。

# css - 如何防止内容重新调整其包装 div 的大小？

> ID：604318
> 
> 赞同：0
> 
> 时间：2009-03-02T22:28:42.867
> 
> 标签：css, xhtml

我是一个 CSS 菜鸟，虽然我希望这个 DIV 在调整窗口大小时调整大小，但我不希望内部内容改变它的大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T22:30:10.227

尝试使用：

```
div {
  overflow: hidden;
} 
```

[在这里](http://www.w3schools.com/Css/pr_pos_overflow.asp)阅读更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T22:32:44.853

使用溢出语句。例如

溢出：隐藏；/* 溢出时隐藏的所有内容 */

溢出：自动；/* 当需要允许移动时，滚动条会出现在 div 上 */

溢出：滚动；/* 滚动条会一直出现 */

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T22:30:01.647

`overflow: hidden`在包含的 div 上设置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T22:30:48.603

您是否研究过 CSS 和`overflow`指令？当内容太大时，您可以使用它来告诉 div 滚动或截断/隐藏其内容。

# c++ - 操作方法：在 Windows 上以编程方式安装？

> ID：604329
> 
> 赞同：5
> 
> 时间：2009-03-02T22:30:28.603
> 
> 标签：c++, windows, installation

任何人都可以列出以编程方式在 Windows 上安装应用程序所需的步骤。除了将文件复制到需要的位置外，还需要哪些额外步骤才能使您的应用程序成为 Windows 中的一等公民（即显示在程序列表、卸载列表...等中）

我试图用谷歌搜索这个，但没有运气。

顺便说一句：这是针对非托管 c++ 应用程序（在 Qt 中开发的），所以如果我不需要，我宁愿不涉及 .net 框架。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T22:37:17.230

我强烈推荐[NSIS](http://nsis.sourceforge.net/)。开源，非常活跃的开发，很难匹配/超越它的可扩展性。

要将您的程序添加到添加/删除程序（或程序和功能）列表中，请添加以下注册表项：

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\PROGRAM_NAME]
"DisplayName"="PROGRAM_NAME"
"Publisher"="COMPANY_NAME"
"UninstallString"="PATH_TO_UNINSTALL_PROGRAM"
"DisplayIcon"="PATH_TO_ICON_FILE"
"DisplayVersion"="VERSION"
"InstallLocation"="PATH_TO_INSTALLATION_LOCATION" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T23:39:44.273

我认为您将在这里看到的答案的主题是您应该**使用安装程序**并且**您不应该自己编写安装程序**。使用众多安装程序制造商之一，例如 Inno Setup、InstallSheild 或其他任何人推荐的东西。

如果您尝试自己编写安装程序，您可能会做错。这对您个人而言并不是轻视。只是安装程序应该考虑很多小细节，还有很多可能出错的事情，如果你想自己编写安装程序，你只需要把所有这些事情都做好。这意味着您需要进行大量研究和大量测试。为自己省去麻烦。

除了复制文件之外，安装任务也有很大不同，具体取决于您的程序需要什么。也许你需要在开始菜单上放一个图标；安装工具应该有一种方法可以很容易地做到这一点，自动填写客户在安装之前选择的安装位置，甚至可能为快捷方式的标签选择正确的本地语言。

您可能需要创建注册表项，例如用于文件关联或许可。您的安装工具应该已经有一种简单的方法来指定要创建或修改的键和值。

您可能需要注册一个 COM 服务器。这是一个足够常见的操作，您的安装程序工具可能有一种方法将其指定为后文件复制操作的一部分。

如果您选择的安装程序工具尚未提供某些操作，该工具可能会提供一种添加自定义操作的方法，可能是通过脚本语言，或者可能通过链接您将编写的 DLL 中包含的外部代码与您的安装程序。自定义操作可能包括从特定网站下载更新、发送电子邮件或盘点贵公司已安装的其他产品。

安装工具应该提供的最后几件事是对现有安装**应用升级的方法，以及****卸载**程序、撤消所有这些安装任务（删除文件、恢复备份、注销 COM 服务器等）的方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T22:35:10.310

我使用 Inno Setup 为 C++ 打包我的软件。与 InstallShield 等重型解决方案相比，它非常简单。一切都可以包含在单个 setup.exe 中，而无需创建所有这些疯狂的批处理脚本等等。

在这里查看：[http ://www.jrsoftware.org/isinfo.php](http://www.jrsoftware.org/isinfo.php)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T23:01:09.310

听起来您需要检查 Windows Installer 系统。如果您需要详细信息，请参阅[官方文档](http://msdn.microsoft.com/en-us/library/aa372866.aspx)。有关新闻，请阅读安装团队的[博客](http://blogs.msdn.com/windows_installer_team/default.aspx)。最后，由于您是程序员，您可能希望像程序员一样构建安装程序。 [WiX 3.0](http://wix.sourceforge.net/)是我选择的工具——开源代码，从微软开始。[从WiX](http://www.tramontana.co.hu/wix/)上的本教程开始。很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T22:51:17.370

innosetup（强烈推荐）的 GUI 是[Istool](http://www.istool.org/)

您还可以使用 Visual Studio 中内置的 MSI 安装程序，这是一个更陡峭的学习曲线（即是一种痛苦），但如果您在公司环境中安装软件，它会很有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T23:29:32.330

要让您的程序显示在“开始”程序菜单中，您需要创建文件夹 C:\Documents and Settings\All Users\Start Menu\Programs 并为要启动的程序添加快捷方式。（如果您希望您的应用程序直接在开始菜单或程序子菜单中列出，您可以将快捷方式放在相应的目录中）

要以编程方式创建快捷方式，您可以使用 IShellLink [（请参阅 MSDN 文章）。](http://msdn.microsoft.com/en-us/library/bb774950(VS.85).aspx)

由于您要卸载，因此涉及更多，因为您不想在不检查依赖关系的情况下简单地删除 DLL 或其他常见文件。我建议使用设置/安装生成器，尤其是现在 Vista 如此挑剔，如果您需要的不仅仅是单个可执行文件和开始菜单快捷方式，那么滚动自己的安装会变得相当复杂。

我已经使用[Paquet Builder](http://www.gdgsoft.com/pb/)设置生成器好几年了。（注册版本包括卸载）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T22:36:46.157

您已经掌握了主要步骤。您遗漏的一个是安装在“开始”菜单上，并提供创建桌面和/或快速启动图标的选项。

我鼓励您按照 Jeremy 的建议考虑使用安装程序。

# web - 检测网络用户的语言，例如 JavaScript？

> ID：604330
> 
> 赞同：1
> 
> 时间：2009-03-02T22:30:36.123
> 
> 标签：web, language-detection

我正在考虑制作我的网站的多种语言版本（例如英语和德语）。我想根据用户的语言提供一个合理的默认值。

最简单、最不突兀的方法是什么？

编辑：理想的解决方案是不使用任何服务器端技术，而是对 html 文件中的所有内容进行编码。目前，我有一个自动转发到主页的起始页面。如果可能的话，我想让它更“聪明”一点，以便它转发到德语或英语版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T22:33:23.933

最简单的方法是解析[`Accept-Language`header 字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T22:33:09.143

最简单的方法是检查 Accept-Language 标头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T22:35:44.880

我相信属性要么是 navigator.language 要么是 navigator.userLanguage。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T22:33:29.517

正如 Gumbo 指出的那样（您可以使用 Accept-Language HTTP 请求标头 - 如果它是由用户的客户端发送的），但您将无法从 Javascript 直接访问它。您将需要来自服务器端平台的一些帮助（即 PHP、ASP.NET 或您正在使用的任何其他工具）

# sharepoint - 通过 WebDAV 重定向器保存到 SharePoint。获取新对象 ID 并丢失版本历史

> ID：604332
> 
> 赞同：2
> 
> 时间：2009-03-02T22:31:19.570
> 
> 标签：sharepoint, webdav

我正在使用 WebDAV 重定向器来编辑 SharePoint 存储库上的文件。看起来每次我以这种方式保存文件时，都会得到一个替换前一个对象的新对象。这导致所有版本历史记录丢失。

打开文件是通过 CreateFile 完成的：

文件名 - 与对 CreateFile 的只读调用相同（有效）

所需访问：GENERIC_READ | GENERIC_WRITE

dwShareMode：FILE_SHARE_READ SecurityHandle：长度已设置，但其他2个字段为0

dwCreationDisposition：OPEN_EXISTING dwFlagsAndAttributes：FILE_ATTRIBUTE_NORMAL

h模板文件：空

在我将文件写入此调用返回的句柄后，如果我获得此文件的列表项，则对象编号 (ID=) 已递增。此外，此 ID 号似乎被添加到列表项中的每个字段（通过序列“#;”与实际数据分隔）

如果我使用 Web 界面签出、编辑然后签入，则不会发生这种 ID 号的增加（以及版本历史记录的丢失）；它保留相同的 ID，并且版本历史记录保持不变。

我怎样才能避免这种情况？我必须保留版本历史。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:20:12.257

我建议获取 HTTP 跟踪。

很可能，它会显示重定向器使用临时文件，然后将其移动到原始文件上。

修复：使用更智能的 WebDAV 客户端（Xythos 驱动器可能更好）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T04:31:40.310

通过使用 WebDav，您绕过了 SharePoint 运行时，这就是您 . 为确保您获得版本历史记录，您应该使用[SharePoint api](http://msdn.microsoft.com/en-us/library/cc768559.aspx)（Web 服务或 OM）

# jquery - jQuery 选择器问题。选择所有不以（字符串）开头的节点

> ID：604344
> 
> 赞同：24
> 
> 时间：2009-03-02T22:33:47.677
> 
> 标签：jquery

尝试在这里组装一个相当复杂的 jQuery 选择器，但遇到了麻烦。

本质上，我试图抓住所有锚点，即 1）没有“facebox”的“rel”，~~或者~~ **2**）没有以“mailto”开头的“href”。

这就是我一直在尝试做的事情：

```
$('a[rel!=facebox], a[href!^="mailto"]') 
```

对此的微小变化似乎不起作用。有没有更好的方法来解决这个问题？

这些选择器似乎可以单独工作，但在连续坐在同一个选择器中时却不行：

```
$('a:not([rel=facebox]), a:not([href^=mailto])') 
```

**最终解决方案：**我们有赢家！

```
$('a:not([rel=facebox],[href^=mailto])') 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-02T22:36:55.017

你想要[:not 选择器](http://docs.jquery.com/Selectors/not#selector)

```
$("a:not([rel=facebox],[href^=mailto])"); 
```

编辑：我偷了你的正确答案

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T22:42:57.637

好的，杰里米·里基茨先生。Jquery 搞砸了你的脑袋。您正在尝试链接选择器逻辑......有点像 jQuery 如何链接方法。在您的第二个选择器 ( `a[href!^="mailto"]`) 中，您试图说...不是包含 THIS 属性的东西。您所说的是“搜索所有不是 mailto 的东西”和“搜索所有包含 mailto 的东西”。就像滤光片......如果你过滤红光......并在顶部放置一个黄色滤光片......你没有过滤橙色光......你只是过滤掉了所有东西（对不起，类比的延伸） . 所以你要做的是使用伪选择器：not。

像这样 -`$(a:not([href^=mailto:])).whateverJqueryMethodYouWant();`

编辑：现在你已经正确地说明了这个问题......你可以这样做 -`$(a:not([href^=mailto:] , [rel=facebox])).whateverJqueryFunctionYouWant();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T06:23:42.660

不应该是：

```
$("a:not([rel='facebox'],[href^='mailto'])"); 
```

# javascript - 考虑到框架在javascript中的滚动，如何确定iframe中元素的绝对位置？

> ID：604348
> 
> 赞同：0
> 
> 时间：2009-03-02T22:34:46.003
> 
> 标签：javascript

我想知道已滚动的 iFrame 中 HTML 元素的绝对位置（顶部和左侧的像素）。我尝试使用`findpos`quirksmode ( [http://www.quirksmode.org/js/findpos.html](http://www.quirksmode.org/js/findpos.html) ) 中的脚本：

```
function findPos(obj) {
    var curleft = curtop = 0;
    if (obj.offsetParent) {
        do {
            curleft += obj.offsetLeft;
            curtop += obj.offsetTop;
        }
        while (obj = obj.offsetParent);
        return [curleft, curtop];
    }
} 
```

这似乎没有考虑 iFrame 可能已经滚动的事实。如何修改此脚本以考虑 iFrame 的滚动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T23:34:30.027

```
function findPosRelativeToViewport(obj) {
    var pos= findPos(obj);
    var root= document.compatMode=='BackCompat'? document.body : document.documentElement;
    pos[0]-= root.scrollLeft;
    pos[1]-= root.scrollTop;
    return pos;
} 
```

（compatMode 的东西是为了在 Quirks 模式下迎合 IE。但不要使用 Quirks 模式。）

# c++ - 关于 c++ 异常。函数（）抛出（）

> ID：604372
> 
> 赞同：8
> 
> 时间：2009-03-02T22:39:29.473
> 
> 标签：c++, exception, throw

我正在阅读这个页面[http://www.cplusplus.com/doc/tutorial/exceptions.html](http://www.cplusplus.com/doc/tutorial/exceptions.html) 它说如果我写 function() throw(); 该函数中不能抛出异常。我尝试在 msvc 2005 中编写 throw()、throw(int)、throw()，但什么也没有。每个都有完全相同的结果。没有。我扔了 int, char*, 另一种类型，它们都以相同的方式被捕获。看起来 throw 根本不影响它。function() throw() 实际上做了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T22:42:50.010

有关C++ 异常规范和 Microsoft 实现的详细信息，请参阅[本文：](http://www.codeproject.com/KB/cpp/stdexceptionspec.aspx)

> Microsoft Visual C++ 7.1 忽略异常规范，除非它们为空。空异常规范相当于`__declspec(nothrow)`，它们可以帮助编译器减少代码大小。
> 
> [...] 如果它看到一个空的异常规范，它将假定您知道自己在做什么，并优化处理异常的机制。如果你的函数无论如何都会抛出 - 好吧，你感到羞耻。仅当您 100% 肯定您的函数不会抛出并且永远不会抛出时，才使用此功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T23:05:02.093

你会发现那个版本的 VC++ 没有强制规范异常。我相信这被记录为与标准的差异。

但是，异常规范通常不是一个好主意。如果程序在符合标准的实现中违反了它们（VS 2005 中的 VC++ 在这种情况下不存在），系统应该会捕获它。这意味着规范不是编译器优化提示，而是强制编译器花费额外的长度，有时会产生次优代码。

有关备受推崇的 Boost 项目不使用异常规范的原因，请参阅[Boost 基本原理。](http://www.boost.org/development/requirements.html#Exception-specification)这就是 Boost，它是用语言的高级部分做奇怪而有用的事情的典型代表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-28T20:48:29.860

引自 [A Pragmatic Look at Exception Specifications](http://www.gotw.ca/publications/mill22.htm)：

> **（错误）理解**
> 
> 第二个问题与知道你得到了什么有关。正如许多知名人士（包括 Boost 异常规范基本原理的作者）所说的那样，程序员倾向于使用异常规范，就好像它们的行为方式是程序员想要的，而不是他们实际行为的方式。
> 
> 以下是许多人认为异常规范所做的事情：
> 
> *   保证函数只会抛出列出的异常（可能没有）。
>     
>     
> *   基于仅抛出列出的异常（可能没有）的知识启用编译器优化。
>     
>     
> 
> 上述预期再次看似接近正确。

有关完整详细信息，请参阅链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T22:44:55.950

抛出异常是不够的，你需要一个`try {} catch()`块来捕获异常。如果您没有捕获异常，`std::terminate()`则会调用并且您的程序会突然退出。花一些时间去看看[这个](http://www.parashift.com/c++-faq-lite/exceptions.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T23:00:07.207

投掷规格设计用于两个目的：

1.  作为接口实现和接口用户之间的契约——你声明可以从你的方法中抛出哪些异常，有些人认为它是接口的一部分。（合同）Ala 检查了 Java 中的异常。

2.  作为向编译器发出信号的一种方式，它可以应用某些优化，以防无法从方法/过程中抛出异常（设置异常处理会花费一些东西）

抛出未在 throw() 子句中指定的异常是错误的，但是**在任何时候都不需要实现来为您验证它**。事实上，它甚至无法验证，因为它包含了子程序调用的所有可能的异常。（可能来自其他模块）在单个模块中甚至不可能，因为很容易减少到停止问题:)

# nhibernate - 使用 property-ref 映射到非键字段时，延迟加载不适用于多对一关系

> ID：604373
> 
> 赞同：18
> 
> 时间：2009-03-02T22:39:57.473
> 
> 标签：nhibernate, lazy-loading, icriteria

我有一个使用 NHibernate 映射的遗留数据库。关注的对象是一个 Account 和一个 Notification 对象列表。对象看起来像：

```
public class Notification
{
    public virtual int Id { get; set; }
    public virtual DateTime BatchDate { get; set; }
    /* other properties */

    public virtual Account Account { get; set; }
}

public class Account 
{
    public virtual int Id { get; set; }
    public virtual string AccountNumber { get; set; }
    /* other properties */ 
} 
```

映射文件如下所示：

```
<class name="Account" table="Account" dynamic-update="true">
<id name="Id" column="AccountID">
    <generator class="native" />
</id>
<property name="AccountNumber" length="15" not-null="true" />
    <!-- other properties -->
</class>

<class name="Notification" table="Notification">
    <id name="Id" column="Id">
        <generator class="native" />
    </id>
    <!-- other properties -->
    <many-to-one name="Account" class="Account" property-ref="AccountNumber" lazy="proxy">
        <column name="AcctNum" />
    </many-to-one> 
```

但是，当我创建一个标准时，例如

```
return session.CreateCriteria(typeof(Notification)).List<Notification>(); 
```

我得到一个 Select N+1 案例，其中每个帐户都被加载，即使该帐户从未被引用。当多对一映射为惰性代理时，为什么所有帐户都被加载？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-09-30T16:11:32.870

问题是由`property-ref`属性引起的。延迟加载仅在`many-to-one`引用使用其他对象的主键时有效，因为 NHibernate 假定存在强制此类值有效性的外键约束。对于非主键（由 property-ref 指示），NHibernate 不会做出此假设，因此不会假设相关对象必须存在。由于它不想为不存在的对象创建代理（即应该为 null 而不是代理），因此它急切地获取远程对象。指定时存在同样的问题，`not-found="ignore"`因为这表明未强制执行外键关系并且可能导致空引用。

也可以看看：

*   [NHibernate 通过 session.Load() 创建代理，而不是通过 Linq 或 Criteria API](https://stackoverflow.com/questions/1643905/nhibernate-creates-proxy-via-session-load-but-not-via-linq-or-criteria-api/1649547#1649547)
*   [http://frankmao.com/2007/12/05/lazy-load-conflicts-with-property-ref-in-many-to-one-mapping/](http://frankmao.com/2007/12/05/lazy-load-conflicts-with-property-ref-in-many-to-one-mapping/)

# mysql - 如何在更新时加入表

> ID：604375
> 
> 赞同：2
> 
> 时间：2009-03-02T22:40:24.367
> 
> 标签：mysql, sql, join, sql-update

我有以下查询：

```
select      count(L.ID)
from        LA inner join L on (LA.leadid = L.ID)
where       L.status = 5
and         L.city = "cityname"
and         Date(LA.Datetime) < Date_Sub(Now(), INTERVAL 6 MONTH); 
```

它会查找特定城市中状态为 5 且超过 6 个月的记录（该日期存储在 LA）。这将返回大约 4k 个结果。我想将每条记录的状态值更新为 1，因此我的更新如下所示：

```
update      L, LA
set         L.status = 1
where       L.status = 5 
and         L.city = "cityname" 
and         Date(LA.SomeDatetime) < Date_Sub(Now(), INTERVAL 6 MONTH); 
```

但它会停止并锁定数据库。我怀疑有问题，因为没有加入，但我尝试类似：

```
update      L, LA
from        L inner join LA on (L.OID = LA.leadid)
set         L.status = 1
where       L.status = 5 
and         L.syscity = "cityname" 
and         Date(LA.SomeDatetime) < Date_Sub(Now(), INTERVAL 6 MONTH); 
```

它显然不起作用，因为更新中没有“来自”。

编辑>我正在使用 MySQL

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T22:45:02.797

```
update      L
set         L.status = 1
where       L.status = 5 
and         L.city = "cityname" 
and         EXISTS (
  select * from LA 
  where Date(LA.SomeDatetime) < Date_Sub(Now(), INTERVAL 6 MONTH)
  and LA.leadid = L.ID
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T23:14:49.310

对于`MySQL`，您可以使用旧的连接语法：

```
UPDATE  l, la
SET     l.status = 1
WHERE   l.status = 5
  AND   l.city = "cityname"
  AND   la.leadid = l.id
  AND   DATE(la.datetime) < DATE_SUB(NOW(), INTERVAL 6 MONTH) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T22:42:21.510

我会这样做：

```
update L
set status = 1
from LA
where L.OID = LA.leadid
and L.status = 5
and L.syscity = "cityname"
and Date(LA.SomeDatetime) < Date_Sub(Now(), INTERVAL 6 MONTH) 
```

也可以看看：

[SQL 根据 ID 匹配从一个表更新到另一个表](https://stackoverflow.com/questions/224732/sql-update-from-one-table-to-another-based-on-a-id-match)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T23:02:33.160

在 SQL Server 2005 中，这将起作用：

```
Update L
   set L.status = 1
from
   L
   --
   JOIN LA
      on (LA.leadid = L.id)
where
   L.status = 5
   and L.city = "cityname"
   and Date(LA.Datetime) < Date_Sub(Now(), INTERVAL 6 MONTH); 
```

# solaris - 如何将 Solaris 9 配置为在启动时自动启动 Synergy 或依赖于 X 的应用程序？

> ID：604376
> 
> 赞同：1
> 
> 时间：2009-03-02T22:40:44.353
> 
> 标签：solaris, sysadmin

如何将 Solaris 9 机器配置为在启动时自动启动 Synergy(synergy2.sourceforge.net) 或任何其他依赖于 X 的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T22:49:10.620

您需要将它添加到适当的 rc 目录中，并让脚本名称出现在按字典顺序启动 X 之后。我现在没有要查看的 S9 系统，但我*认为*您希望将其添加到运行级别 3 的 RC（副 4，感谢 Martin），如果您在90年代。

哦，[BigAdmin](http://bigadmin.sun.com)会为这类事情提供很多方便的操作指南。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T06:34:07.053

为什么 Synergy 的[“自动启动”说明](http://synergy2.sourceforge.net/autostart.html)不适用于您的设置？如果您使用 CDE，即 dtlogin 提供图形登录，您将在`/usr/dt/config/`. 请务必阅读`/usr/dt/config/Xconfig`正确修改配置文件的说明。（刚刚在 Solaris 10 上检查过。）

# java - 用于 Java 项目的 Hudson 和 CruiseControl 有什么区别？

> ID：604385
> 
> 赞同：72
> 
> 时间：2009-03-02T22:42:38.997
> 
> 标签：java, continuous-integration, hudson, jenkins, cruisecontrol

我认为标题总结了它。我只是想知道为什么其中一种更适合来自 Svn 的 Java 项目的持续集成构建。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2009-05-20T13:55:14.610

我同意[这个答案](https://stackoverflow.com/questions/604385/what-is-the-difference-between-hudson-and-cruisecontrol-for-java-projects/604419#604419)，但想补充几点。

简而言之，**Hudson**（更新：**[Jenkins](http://jenkins-ci.org/)**）现在可能是更好的选择。首先也是最重要的，因为通过 Hudson 的 Web UI 创建和配置作业（CC 词汇中的“项目”）比编辑 CruiseControl 的 XML 配置文件（我们曾经保留在版本控制中以便更好地跟踪它）*快得多*. 后者并不是特别困难 - 它只是更慢更乏味。

CruiseControl 非常棒，但正如 Dan Dyer 名副其实的博文所述，*[为什么您仍然不使用 Hudson？](http://blog.uncommons.org/2008/05/09/why-are-you-still-not-using-hudson/)*，它首先受到影响。（嗯，像英国一样，如果你愿意的话，后来进入工业革命，当时其他人开始用更新的技术超越它。）

我们大量使用 CruiseControl，并逐渐切换到 Hudson，最终独占使用它。*更*重要的是：在这个过程中，我们已经开始将 CI 服务器用于许多其他事情，因为设置和管理 Hudson 作业非常方便。（我们现在在 Hudson 有大约 40 多个工作：用于稳定和开发分支的常规构建和测试工作；与发布相关的工作（构建安装程序等）；针对代码库运行一些（实验性）指标的工作；运行（慢) 针对特定数据库版本的 UI 或集成测试；等等。)

根据这个经验，我认为即使你有很多构建，包括复杂的构建，Hudson 也是一个非常安全的选择，因为就像 CC 一样，基本上你可以用它来做*任何事情。*只需将您的作业配置为按照您希望的顺序运行任何 Ant 或 Maven 目标、Unix shell 脚本或 Windows .bat 脚本。

至于第 3 方的东西（[Jeffrey Fredrick 在此提到](https://stackoverflow.com/questions/604385/what-is-the-difference-between-hudson-and-cruisecontrol-for-java-projects/605452#605452)） - 这是一个很好的观点，但我的印象是 Hudson 正在迅速追赶，并且已经有大量[可用的插件](http://wiki.hudson-ci.org/display/HUDSON/Plugins)。

对我来说，我想念 CruiseControl 的两件事是：

1.  它有关损坏构建的警告电子邮件比 Hudson 的警告电子邮件更能提供信息。在大多数情况下，根本原因从 CC 格式精美的 HTML 邮件本身就很明显，而对于 Hudson，我通常需要点击 Hudson Web UI 的链接，然后单击一下以获取详细信息。
2.  [CruiseControl 仪表板](http://cruisecontrol.sourceforge.net/dashboard.html)更适合开箱即用，作为“信息[辐射器](http://www.agileadvice.com/archives/2005/05/information_rad.html)”（显示在公共监视器上，或投影在墙上，以便您始终可以快速查看所有项目的状态）。在 Hudson 的首页上，我们需要一些 Greasemonkey 技巧来获得漂亮的绿色/红色作业行。

次要免责声明：我在过去一年左右没有密切关注 CC 项目。（但[快速浏览一下](http://cruisecontrol.sourceforge.net/download.html)，它并没有发生任何戏剧性的变化。）

**注意**（2011-02-03）：Hudson 已被[重命名/分叉](http://jenkins-ci.org/content/hudsons-future)为[Jenkins](http://jenkins-ci.org/)（由 Hudson 的创建者[Kohsuke Kawaguchi](http://kohsuke.org/2011/01/11/bye-bye-hudson-hello-jenkins/)和其他人）。看起来甲骨文——控制着 Hudson 的名字——也会保留“ [Hudson](http://hudson-ci.org/) ”，但我个人的建议是选择**Jenkins**，不管甲骨文怎么说。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-03-03T07:41:21.620

作为一名长期的 CruiseControl 提交者**和**从未使用过 Hudson 的人，我非常有偏见，但我的看法是：

Hudson 更容易启动和运行（很大程度上来自一个漂亮的 Web 界面），并且拥有一个非常活跃的插件开发社区。

CruiseControl 得到了许多[3rd 方](http://confluence.public.thoughtworks.org/display/CC/3rdPartyCCStuff)的支持，并且可以使用 xml 配置做一些巧妙的技巧，比如插件预配置和 include.projects，它可以让您使用项目对配置信息进行版本控制。

如果您只打算进行一些构建，我认为 Hudson 是明显的赢家。如果你有很多——而且不介意xml——那么我认为CruiseControl 的xml 配置技巧会成为一种真正的优势。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-02T22:55:15.987

我的上一个项目是从 CruiseControl 开始的。震撼。然后我们搬到了哈德逊，那里更加震撼。我喜欢哈德森的地方：

*   上下游项目。因此，对数据访问代码的提交最终也会触发表示层的构建。

*   轻松使用现有项目作为新项目的起点 - 因此，如果您有创建开发分支的习惯，那么确保这些分支处于持续集成状态是一件轻而易举的事。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-02T22:46:11.763

一个不同之处在于，哈德逊是一位天才智慧的产物——川口康介。正因为如此，它是一致的、连贯的、坚如磐石的。不利的一面可能是对进展速度的一些限制。但是，Kohsuke 非常多产，所以我不会太担心这一点。而且，它是可扩展的，所以如果 Kohsuke 没有时间（或不想）做某事，您可以自己做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T23:08:40.713

我查看了 Cruise Control 和 Hudson，但选择了 Hudson，因为它更容易设置和配置。如今，Hudson 似乎被广泛使用，定期发布并通过插件实现大量可扩展性。我会极力推荐它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-02T23:07:01.747

在我看来，Hudson 是更用户友好的选择。它可以完全通过 Web 界面进行设置和维护（当然，除了 webapp 的初始安装）。

关于 CruiseControl，唯一可以这么说的方法是，如果您算上内置的 XML 文件编辑器。

尽管如此，两者都使用了，我仍然更喜欢没有自动构建的任何一个。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T17:18:38.070

我试过巡航控制......它很好......但是文件是零散的。仪表板令人困惑。小部件的创建也令人困惑。没试过哈德森。周末会试试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-18T22:20:07.423

我最近使用 Subversion 设置 Jenkins 来构建 Borland BDS 2006 项目，我对此非常满意。我还没用过 CruiseControl，所以无法比较。阅读我的博客文章了解更多信息。

[Delphi 项目与 Jenkins 的持续集成](http://www.ictexpertise.com/blog/2016/02/10/continuous-integration-of-delphi-project-with-jenkins/)

# flash - Flash 编码 (FLV)：首选比特率是多少？

> ID：604390
> 
> 赞同：3
> 
> 时间：2009-03-02T22:45:11.987
> 
> 标签：flash, video, flv, bitrate

我继承了一个项目，该项目将视频发送到远程编码器以编码为 FLV。

今天，我注意到我们要求他们以 1024kbps 的速度进行编码，对我来说，这似乎非常高。

其他人都在用什么？YouTube 在“标准”和“高质量”版本中使用什么？

先感谢您。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T22:55:37.733

通常，“标准”质量视频的平均速度在 400-600kbps 之间。更高质量的视频通常为 800-1200kbps，但对于许多人来说，比特率太高而无法维持，因此除非您知道您的目标受众将拥有快速连接，否则您不应该将这么高的东西作为您唯一的速率。

为连接速度非常慢的人提供低比特率流（大约 250-300kbps）也是一个好主意，尽管即使使用 H.264 也很难让视频在这个速率下看起来不错，如果你是仍然使用 VP6 然后不要打扰，因为它看起来很糟糕。

如果您正在制作高清 (720p) 内容，那么比特率在 2500kbps 左右开始看起来相当不错，但这超出了许多互联网用户的能力范围。（请注意，YouTube 使用 1000kbps 来表示他们所谓的高清，但实际上并非如此，因为数字阻塞很糟糕。他们最好使用较低的分辨率。）

我们分别对低/中/高质量视频使用 272kbps/544kbps/1088kbps。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T04:11:47.010

在 Ooyala，对于我们的可变速率编码，我们对大多数内容从 225kbps 开始编码，最高可达 1.5-2mbps。

# c - 修改指针指向的字符串是否有效？

> ID：604391
> 
> 赞同：1
> 
> 时间：2009-03-02T22:45:17.960
> 
> 标签：c

这是一个连接两个字符串的程序的简单示例。

```
#include <stdio.h>

void strcat(char *s, char *t);

void strcat(char *s, char *t) {
    while (*s++ != '\0');
    s--;
    while ((*s++ = *t++) != '\0');
}

int main() {
    char *s = "hello";
    strcat(s, " world");
    while (*s != '\0') {
        putchar(*s++);
    }
    return 0;
} 
```

我想知道为什么它有效。在 main() 中，我有一个指向字符串“hello”的指针。根据 K&R 的书，修改这样的字符串是未定义的行为。那么为什么程序能够通过附加“world”来修改它呢？或者附加不被视为修改？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-02T22:46:15.477

未定义的行为意味着编译器可以发出执行任何操作的代码。工作是未定义的子集。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T22:51:44.420

我 +1 了 MSN，但至于它为什么起作用，那是因为还没有任何东西可以填补你的字符串后面的空间。声明更多变量，增加一些复杂性，你会开始看到一些古怪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T23:14:57.827

也许令人惊讶的是，您的编译器已将文字分配给`"hello"`读/写初始化数据，而不是只读初始化数据。您的作业破坏了与该点相邻的任何内容，但您的程序小而简单，以至于您看不到效果。（把它放在一个 for 循环中，看看你是否破坏了`" world"`文字。）

它在 Ubuntu x64 上失败，因为`gcc`将字符串文字放入只读数据中，并且当您尝试写入时，硬件 MMU 对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T22:48:00.310

这次你很幸运。
特别是在调试模式下，一些编译器会在声明周围放置备用内存（通常填充一些明显的值），以便您可以找到这样的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T22:51:13.953

它还取决于指针的声明方式。比如可以改变ptr，ptr指向什么：

```
char * ptr; 
```

可以更改 ptr 指向的内容，但不能更改 ptr：

```
char const * ptr; 
```

可以更改 ptr，但不能更改 ptr 指向的内容：

```
const char * ptr; 
```

不能改变任何东西：

```
const char const * ptr; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T22:56:28.853

> 我想知道为什么它有效

它没有。它会在 Ubuntu x64 上导致分段错误；为了让代码工作，它不应该只[在你的机器上工作](http://www.codinghorror.com/blog/archives/000818.html)。

将修改后的数据移动到堆栈中绕过了 linux 中的数据区保护：

```
int main() {
    char b[] = "hello";
    char c[] = " ";
    char *s = b;

    strcat(s, " world");

    puts(b);
    puts(c);

    return 0;
} 
```

虽然你只有在“世界”适合堆栈数据之间的未使用空间时才是安全的 - 更改`b`为“hello to”并且linux检测到堆栈损坏：

```
*** stack smashing detected ***: bin/clobber terminated 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T11:27:02.670

根据 C99 规范（C99：TC3，6.4.5，§5），字符串文字是

> [...] 用于初始化一组静态存储持续时间和长度刚好足以包含序列的数组。[...]

这意味着它们具有 type `char []`，即原则上可以进行修改。§6 中解释了为什么不应该这样做：

> 如果它们的元素具有适当的值，则未指定这些数组是否不同。如果程序尝试修改这样的数组，则行为未定义。

具有相同内容的不同字符串文字可以（但不必）映射到相同的内存位置。由于行为未定义，编译器可以自由地将它们放在只读部分中，以便彻底失败，而不是引入可能难以检测的错误源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T22:48:48.840

编译器允许您修改 s 因为您错误地将其标记为非常量 - 指向静态字符串的指针应该是

```
const char *s = "hello"; 
```

由于缺少 const 修饰符，您基本上禁用了阻止您写入不应写入的内存的安全性。C 几乎没有阻止你射中自己的脚。在这种情况下，你很幸运，只是擦伤了你的小脚趾。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-02T22:55:44.427

s 指向一个包含“hello”的内存，但不打算包含更多。这意味着您很可能会覆盖其他内容。这是非常危险的，即使它看起来很有效。

两个观察：

1.  *s-- 中的 * 不是必需的。s-- 就足够了，因为您只想减小该值。
2.  你不需要自己写 strcat 。它已经存在（你可能知道，但我还是要告诉你:-)）。

# git - 你如何只推送一些本地 git 提交？

> ID：604399
> 
> 赞同：182
> 
> 时间：2009-03-02T22:48:25.003
> 
> 标签：git, version-control

假设我有 5 个本地提交。我只想将其中 2 个推送到集中式存储库（使用 SVN 风格的工作流程）。我该怎么做呢？

这不起作用：

```
git checkout HEAD~3  #set head to three commits ago
git push #attempt push from that head 
```

这最终推动了所有 5 个本地提交。

我想我可以执行 git reset 来实际撤消我的提交，然后是 git stash ，然后是 git push ——但是我已经编写了提交消息并组织了文件，我不想重做它们。

我的感觉是传递给 push 或 reset 的一些标志会起作用。

如果有帮助，这是我的 git 配置

```
[ramanujan:~/myrepo/.git]$cat config 
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        logallrefupdates = true
[remote "origin"]
        url = ssh://server/git/myrepo.git
        fetch = +refs/heads/*:refs/remotes/origin/*
[branch "master"]
        remote = origin
        merge = refs/heads/master 
```

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2009-03-02T23:31:44.353

假设您的提交在 master 分支上，并且您希望将它们推送到远程 master 分支：

```
$ git push origin master~3:master 
```

如果您使用的是 git-svn：

```
$ git svn dcommit master~3 
```

在 git-svn 的情况下，您也可以使用 HEAD~3，因为它期待提交。在直接 git 的情况下，您需要使用分支名称，因为 HEAD 在 refspec 中未正确评估。

您还可以采取更长的方法：

```
$ git checkout -b tocommit HEAD~3
$ git push origin tocommit:master 
```

如果您正在养成这种类型的工作流程的习惯，您应该考虑在单独的分支中进行工作。然后你可以做类似的事情：

```
$ git checkout master
$ git merge working~3
$ git push origin master:master 
```

请注意，“origin master:master”部分对于您的设置可能是可选的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-11-29T15:53:26.263

# 简短的回答：

`git push <latest commit SHA1 until you want commits to be pushed>`

例子：

`git push origin fc47b2:master`

`git push origin HEAD~2:main`

# 长答案：

提交作为具有父/子机制的链链接在一起。因此，*推送提交*实际上也将*所有父提交*推送到远程不知道的提交。这是在您`git push`当前提交时隐式完成的：所有先前的提交也会被推送，因为此命令等效于`git push HEAD`.

所以这个问题可能会被重写为*如何推送特定的提交*，例如，这个特定的提交可能是 HEAD~2。

如果您要推送的提交是非连续的，只需在*特定 push*`git rebase -i`之前使用 a 重新排序它们。

 ** * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-02T22:53:56.503

我所做的是在一个名为“work”的本地分支机构工作。此分支包含我不打算推​​送到上游存储库的所有临时提交（如解决方法或私有构建选项或其他）。我在那个分支上工作，然后当我想提交时，我切换到 master 分支，选择我想要提交的适当提交*，*然后推送 master。

从上游将更改拉到我的主分支后，我`git checkout work`和`git rebase master`. 这将我所有的本地更改重写为历史的结尾。

我实际上正在使用`git svn`这个工作流程，所以我的“推送”操作涉及`git svn dcommit`. 我还使用[`tig`](http://jonas.nitro.dk/tig/)它是一个很好的文本模式 gui 存储库查看器，以挑选适当的提交来掌握。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-05-13T18:58:52.440

默认情况下， git-push 推送所有分支。当你这样做时：

```
 git checkout HEAD~3  #set head to three commits ago
 git push #attempt push from that head 
```

你移动到一个分离的 HEAD（你不在任何分支上），然后你将所有分支，包括本地 master（仍然在它所在的位置）推送到远程 master。

手动解决方案是：

```
 git push origin HEAD:master 
```

如果您发现推送所有分支的默认行为令人困惑（并且很危险！），请将其添加到您的 ~/.gitconfig 中：

```
 [remote.origin]
    push = HEAD 
```

然后只推送你所在的分支。在您的示例（分离的头）中，您会收到此错误消息，而不是意外推送错误的提交：

```
 error: unable to push to unqualified destination: HEAD 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-03-01T15:59:06.853

1）如果你愿意，使用“git rebase”重新排序你的提交。

```
git rebase -i 
```

此命令将在您的编辑器中显示类似的内容（我正在使用 vim）

```
pick 4791291 commitA
pick a2bdfbd commitB
pick c3d4961 commitC
pick aa1cefc commitD
pick 9781434 commitE

# Rebase ..............
#
# Commands:
#  p, pick = use commit
#  r, reword = use commit, but edit the commit message
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit
#  f, fixup = like "squash", but discard this commit's log message
#  x, exec = run command (the rest of the line) using shell
#
# These lines can be re-ordered; they are executed from top to bottom.
#
# If you remove a line here THAT COMMIT WILL BE LOST.
#
# However, if you remove everything, the rebase will be aborted.
#
# Note that empty commits are commented out

^G Get Help         ^O WriteOut         ^R Read File        ^Y Prev Page                ^K Cut Text         ^C Cur Pos
^X Exit             ^J Justify          ^W Where Is         ^V Next Page            ^U UnCut Text       ^T To Spell 
```

2）根据您的选择通过简单的剪切粘贴重新排序您的提交。假设新订单是

选择 9781434 commitE

选择 c3d4961 commitC

选择 4791291 提交A

选择 aa1cefc 提交D

选择 a2bdfbd 提交B

在您的编辑器中进行这些更改，然后按 ctrl+ O (writeOut)

或者你也可以使用

```
git rebase -i HEAD~<commitNumber> 
```

您可以检查新序列

```
git log 
```

3）现在使用

```
git push <remoteName> <commit SHA>:<remoteBranchName> 
```

如果只有一个远程（原点）分支和一个本地（主）分支，只需使用

```
git push <commit SHA>
git push aa1cefc 
```

这将推送 commitB 和 commitD。

# gtk - 堆叠 GTK+ 小部件

> ID：604403
> 
> 赞同：2
> 
> 时间：2009-03-02T22:49:25.657
> 
> 标签：gtk, widget

有没有办法将 GTK+ 小部件放入堆栈中？即在标签上放一个按钮，以便按钮覆盖标签的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-07T14:13:54.737

您可以使用 GtkFixed 作为布局。这将允许您控制子小部件的确切位置，并且它们可以重叠。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T00:21:59.773

您必须使用 Canvas 控件来显式设置控件的位置 - GTK+ 努力*不做*您所描述的事情:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T00:28:03.890

包装在 GtkTable 中似乎允许这样做，虽然我没有测试很远 - 只是在空地里稍微玩弄了一下。

我很好奇你想用这个来实现什么。

# .net - C# 应用程序中的全局键盘捕获

> ID：604410
> 
> 赞同：92
> 
> 时间：2009-03-02T22:52:02.843
> 
> 标签：.net, events, keyboard-hook

我想在我的应用程序中捕获一个键盘快捷键，并在用户即使在应用程序之外按下键盘组合时触发一个对话框。类似于 Google 桌面搜索的 Ctrl，Ctrl 可以调出搜索对话框。

我尝试过使用一些键盘钩子模块，这些模块基本上使用 Win32 互操作来获得这种效果，但是我尝试的每个实现都会在某种程度上将键盘绑定到您在应用程序执行密集操作时开始出现奇怪行为的地方。比如加载大量数据，会导致键盘鼠标死机。

我正在寻找一种轻量级的解决方案，可以在不束缚键盘和鼠标的情况下完成这项工作。

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-03-02T22:54:08.173

Stephen Toub[写了一篇](https://docs.microsoft.com/en-us/archive/blogs/toub/low-level-keyboard-hook-in-c)关于在 C# 中实现全局键盘挂钩的精彩文章：

```
using System;
using System.Diagnostics;
using System.Windows.Forms;
using System.Runtime.InteropServices;

class InterceptKeys
{
    private const int WH_KEYBOARD_LL = 13;
    private const int WM_KEYDOWN = 0x0100;
    private static LowLevelKeyboardProc _proc = HookCallback;
    private static IntPtr _hookID = IntPtr.Zero;

    public static void Main()
    {
        _hookID = SetHook(_proc);
        Application.Run();
        UnhookWindowsHookEx(_hookID);
    }

    private static IntPtr SetHook(LowLevelKeyboardProc proc)
    {
        using (Process curProcess = Process.GetCurrentProcess())
        using (ProcessModule curModule = curProcess.MainModule)
        {
            return SetWindowsHookEx(WH_KEYBOARD_LL, proc,
                GetModuleHandle(curModule.ModuleName), 0);
        }
    }

    private delegate IntPtr LowLevelKeyboardProc(
        int nCode, IntPtr wParam, IntPtr lParam);

    private static IntPtr HookCallback(
        int nCode, IntPtr wParam, IntPtr lParam)
    {
        if (nCode >= 0 && wParam == (IntPtr)WM_KEYDOWN)
        {
            int vkCode = Marshal.ReadInt32(lParam);
            Console.WriteLine((Keys)vkCode);
        }
        return CallNextHookEx(_hookID, nCode, wParam, lParam);
    }

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr SetWindowsHookEx(int idHook,
        LowLevelKeyboardProc lpfn, IntPtr hMod, uint dwThreadId);

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool UnhookWindowsHookEx(IntPtr hhk);

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr CallNextHookEx(IntPtr hhk, int nCode,
        IntPtr wParam, IntPtr lParam);

    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr GetModuleHandle(string lpModuleName);
} 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2015-12-20T18:14:58.237

这是我的有效代码：

```
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace SnagFree.TrayApp.Core
{
    class GlobalKeyboardHookEventArgs : HandledEventArgs
    {
        public GlobalKeyboardHook.KeyboardState KeyboardState { get; private set; }
        public GlobalKeyboardHook.LowLevelKeyboardInputEvent KeyboardData { get; private set; }

        public GlobalKeyboardHookEventArgs(
            GlobalKeyboardHook.LowLevelKeyboardInputEvent keyboardData,
            GlobalKeyboardHook.KeyboardState keyboardState)
        {
            KeyboardData = keyboardData;
            KeyboardState = keyboardState;
        }
    }

    //Based on https://gist.github.com/Stasonix
    class GlobalKeyboardHook : IDisposable
    {
        public event EventHandler<GlobalKeyboardHookEventArgs> KeyboardPressed;

        public GlobalKeyboardHook()
        {
            _windowsHookHandle = IntPtr.Zero;
            _user32LibraryHandle = IntPtr.Zero;
            _hookProc = LowLevelKeyboardProc; // we must keep alive _hookProc, because GC is not aware about SetWindowsHookEx behaviour.

            _user32LibraryHandle = LoadLibrary("User32");
            if (_user32LibraryHandle == IntPtr.Zero)
            {
                int errorCode = Marshal.GetLastWin32Error();
                throw new Win32Exception(errorCode, $"Failed to load library 'User32.dll'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
            }

            _windowsHookHandle = SetWindowsHookEx(WH_KEYBOARD_LL, _hookProc, _user32LibraryHandle, 0);
            if (_windowsHookHandle == IntPtr.Zero)
            {
                int errorCode = Marshal.GetLastWin32Error();
                throw new Win32Exception(errorCode, $"Failed to adjust keyboard hooks for '{Process.GetCurrentProcess().ProcessName}'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
            }
        }

        protected virtual void Dispose(bool disposing)
        {
            if (disposing)
            {
                // because we can unhook only in the same thread, not in garbage collector thread
                if (_windowsHookHandle != IntPtr.Zero)
                {
                    if (!UnhookWindowsHookEx(_windowsHookHandle))
                    {
                        int errorCode = Marshal.GetLastWin32Error();
                        throw new Win32Exception(errorCode, $"Failed to remove keyboard hooks for '{Process.GetCurrentProcess().ProcessName}'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
                    }
                    _windowsHookHandle = IntPtr.Zero;

                    // ReSharper disable once DelegateSubtraction
                    _hookProc -= LowLevelKeyboardProc;
                }
            }

            if (_user32LibraryHandle != IntPtr.Zero)
            {
                if (!FreeLibrary(_user32LibraryHandle)) // reduces reference to library by 1.
                {
                    int errorCode = Marshal.GetLastWin32Error();
                    throw new Win32Exception(errorCode, $"Failed to unload library 'User32.dll'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
                }
                _user32LibraryHandle = IntPtr.Zero;
            }
        }

        ~GlobalKeyboardHook()
        {
            Dispose(false);
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        private IntPtr _windowsHookHandle;
        private IntPtr _user32LibraryHandle;
        private HookProc _hookProc;

        delegate IntPtr HookProc(int nCode, IntPtr wParam, IntPtr lParam);

        [DllImport("kernel32.dll")]
        private static extern IntPtr LoadLibrary(string lpFileName);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
        private static extern bool FreeLibrary(IntPtr hModule);

        /// <summary>
        /// The SetWindowsHookEx function installs an application-defined hook procedure into a hook chain.
        /// You would install a hook procedure to monitor the system for certain types of events. These events are
        /// associated either with a specific thread or with all threads in the same desktop as the calling thread.
        /// </summary>
        /// <param name="idHook">hook type</param>
        /// <param name="lpfn">hook procedure</param>
        /// <param name="hMod">handle to application instance</param>
        /// <param name="dwThreadId">thread identifier</param>
        /// <returns>If the function succeeds, the return value is the handle to the hook procedure.</returns>
        [DllImport("USER32", SetLastError = true)]
        static extern IntPtr SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hMod, int dwThreadId);

        /// <summary>
        /// The UnhookWindowsHookEx function removes a hook procedure installed in a hook chain by the SetWindowsHookEx function.
        /// </summary>
        /// <param name="hhk">handle to hook procedure</param>
        /// <returns>If the function succeeds, the return value is true.</returns>
        [DllImport("USER32", SetLastError = true)]
        public static extern bool UnhookWindowsHookEx(IntPtr hHook);

        /// <summary>
        /// The CallNextHookEx function passes the hook information to the next hook procedure in the current hook chain.
        /// A hook procedure can call this function either before or after processing the hook information.
        /// </summary>
        /// <param name="hHook">handle to current hook</param>
        /// <param name="code">hook code passed to hook procedure</param>
        /// <param name="wParam">value passed to hook procedure</param>
        /// <param name="lParam">value passed to hook procedure</param>
        /// <returns>If the function succeeds, the return value is true.</returns>
        [DllImport("USER32", SetLastError = true)]
        static extern IntPtr CallNextHookEx(IntPtr hHook, int code, IntPtr wParam, IntPtr lParam);

        [StructLayout(LayoutKind.Sequential)]
        public struct LowLevelKeyboardInputEvent
        {
            /// <summary>
            /// A virtual-key code. The code must be a value in the range 1 to 254.
            /// </summary>
            public int VirtualCode;

            /// <summary>
            /// A hardware scan code for the key. 
            /// </summary>
            public int HardwareScanCode;

            /// <summary>
            /// The extended-key flag, event-injected Flags, context code, and transition-state flag. This member is specified as follows. An application can use the following values to test the keystroke Flags. Testing LLKHF_INJECTED (bit 4) will tell you whether the event was injected. If it was, then testing LLKHF_LOWER_IL_INJECTED (bit 1) will tell you whether or not the event was injected from a process running at lower integrity level.
            /// </summary>
            public int Flags;

            /// <summary>
            /// The time stamp stamp for this message, equivalent to what GetMessageTime would return for this message.
            /// </summary>
            public int TimeStamp;

            /// <summary>
            /// Additional information associated with the message. 
            /// </summary>
            public IntPtr AdditionalInformation;
        }

        public const int WH_KEYBOARD_LL = 13;
        //const int HC_ACTION = 0;

        public enum KeyboardState
        {
            KeyDown = 0x0100,
            KeyUp = 0x0101,
            SysKeyDown = 0x0104,
            SysKeyUp = 0x0105
        }

        public const int VkSnapshot = 0x2c;
        //const int VkLwin = 0x5b;
        //const int VkRwin = 0x5c;
        //const int VkTab = 0x09;
        //const int VkEscape = 0x18;
        //const int VkControl = 0x11;
        const int KfAltdown = 0x2000;
        public const int LlkhfAltdown = (KfAltdown >> 8);

        public IntPtr LowLevelKeyboardProc(int nCode, IntPtr wParam, IntPtr lParam)
        {
            bool fEatKeyStroke = false;

            var wparamTyped = wParam.ToInt32();
            if (Enum.IsDefined(typeof(KeyboardState), wparamTyped))
            {
                object o = Marshal.PtrToStructure(lParam, typeof(LowLevelKeyboardInputEvent));
                LowLevelKeyboardInputEvent p = (LowLevelKeyboardInputEvent)o;

                var eventArguments = new GlobalKeyboardHookEventArgs(p, (KeyboardState)wparamTyped);

                EventHandler<GlobalKeyboardHookEventArgs> handler = KeyboardPressed;
                handler?.Invoke(this, eventArguments);

                fEatKeyStroke = eventArguments.Handled;
            }

            return fEatKeyStroke ? (IntPtr)1 : CallNextHookEx(IntPtr.Zero, nCode, wParam, lParam);
        }
    }
} 
```

用法：

```
using System;
using System.Windows.Forms;

namespace SnagFree.TrayApp.Core
{
    internal class Controller : IDisposable
    {
        private GlobalKeyboardHook _globalKeyboardHook;

        public void SetupKeyboardHooks()
        {
            _globalKeyboardHook = new GlobalKeyboardHook();
            _globalKeyboardHook.KeyboardPressed += OnKeyPressed;
        }

        private void OnKeyPressed(object sender, GlobalKeyboardHookEventArgs e)
        {
            //Debug.WriteLine(e.KeyboardData.VirtualCode);

            if (e.KeyboardData.VirtualCode != GlobalKeyboardHook.VkSnapshot)
                return;

            // seems, not needed in the life.
            //if (e.KeyboardState == GlobalKeyboardHook.KeyboardState.SysKeyDown &&
            //    e.KeyboardData.Flags == GlobalKeyboardHook.LlkhfAltdown)
            //{
            //    MessageBox.Show("Alt + Print Screen");
            //    e.Handled = true;
            //}
            //else

            if (e.KeyboardState == GlobalKeyboardHook.KeyboardState.KeyDown)
            {
                MessageBox.Show("Print Screen");
                e.Handled = true;
            }
        }

        public void Dispose()
        {
            _globalKeyboardHook?.Dispose();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2019-08-29T13:03:46.843

按照 dube 的要求，[我](https://stackoverflow.com/users/304179/dube)发布了[Siarhei Kuchuk](https://stackoverflow.com/users/212746/siarhei-kuchuk)答案的修改版本。
*如果您想查看我的更改，请搜索`// EDT`. 我评论了大部分。*

**设置**

```
class GlobalKeyboardHookEventArgs : HandledEventArgs
{
    public GlobalKeyboardHook.KeyboardState KeyboardState { get; private set; }
    public GlobalKeyboardHook.LowLevelKeyboardInputEvent KeyboardData { get; private set; }

    public GlobalKeyboardHookEventArgs(
        GlobalKeyboardHook.LowLevelKeyboardInputEvent keyboardData,
        GlobalKeyboardHook.KeyboardState keyboardState)
    {
        KeyboardData = keyboardData;
        KeyboardState = keyboardState;
    }
}

//Based on https://gist.github.com/Stasonix
class GlobalKeyboardHook : IDisposable
{
    public event EventHandler<GlobalKeyboardHookEventArgs> KeyboardPressed;

    // EDT: Added an optional parameter (registeredKeys) that accepts keys to restict
    // the logging mechanism.
    /// <summary>
    /// 
    /// </summary>
    /// <param name="registeredKeys">Keys that should trigger logging. Pass null for full logging.</param>
    public GlobalKeyboardHook(Keys[] registeredKeys = null)
    {
        RegisteredKeys = registeredKeys;
        _windowsHookHandle = IntPtr.Zero;
        _user32LibraryHandle = IntPtr.Zero;
        _hookProc = LowLevelKeyboardProc; // we must keep alive _hookProc, because GC is not aware about SetWindowsHookEx behaviour.

        _user32LibraryHandle = LoadLibrary("User32");
        if (_user32LibraryHandle == IntPtr.Zero)
        {
            int errorCode = Marshal.GetLastWin32Error();
            throw new Win32Exception(errorCode, $"Failed to load library 'User32.dll'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
        }

        _windowsHookHandle = SetWindowsHookEx(WH_KEYBOARD_LL, _hookProc, _user32LibraryHandle, 0);
        if (_windowsHookHandle == IntPtr.Zero)
        {
            int errorCode = Marshal.GetLastWin32Error();
            throw new Win32Exception(errorCode, $"Failed to adjust keyboard hooks for '{Process.GetCurrentProcess().ProcessName}'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
        }
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposing)
        {
            // because we can unhook only in the same thread, not in garbage collector thread
            if (_windowsHookHandle != IntPtr.Zero)
            {
                if (!UnhookWindowsHookEx(_windowsHookHandle))
                {
                    int errorCode = Marshal.GetLastWin32Error();
                    throw new Win32Exception(errorCode, $"Failed to remove keyboard hooks for '{Process.GetCurrentProcess().ProcessName}'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
                }
                _windowsHookHandle = IntPtr.Zero;

                // ReSharper disable once DelegateSubtraction
                _hookProc -= LowLevelKeyboardProc;
            }
        }

        if (_user32LibraryHandle != IntPtr.Zero)
        {
            if (!FreeLibrary(_user32LibraryHandle)) // reduces reference to library by 1.
            {
                int errorCode = Marshal.GetLastWin32Error();
                throw new Win32Exception(errorCode, $"Failed to unload library 'User32.dll'. Error {errorCode}: {new Win32Exception(Marshal.GetLastWin32Error()).Message}.");
            }
            _user32LibraryHandle = IntPtr.Zero;
        }
    }

    ~GlobalKeyboardHook()
    {
        Dispose(false);
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    private IntPtr _windowsHookHandle;
    private IntPtr _user32LibraryHandle;
    private HookProc _hookProc;

    delegate IntPtr HookProc(int nCode, IntPtr wParam, IntPtr lParam);

    [DllImport("kernel32.dll")]
    private static extern IntPtr LoadLibrary(string lpFileName);

    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    private static extern bool FreeLibrary(IntPtr hModule);

    /// <summary>
    /// The SetWindowsHookEx function installs an application-defined hook procedure into a hook chain.
    /// You would install a hook procedure to monitor the system for certain types of events. These events are
    /// associated either with a specific thread or with all threads in the same desktop as the calling thread.
    /// </summary>
    /// <param name="idHook">hook type</param>
    /// <param name="lpfn">hook procedure</param>
    /// <param name="hMod">handle to application instance</param>
    /// <param name="dwThreadId">thread identifier</param>
    /// <returns>If the function succeeds, the return value is the handle to the hook procedure.</returns>
    [DllImport("USER32", SetLastError = true)]
    static extern IntPtr SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hMod, int dwThreadId);

    /// <summary>
    /// The UnhookWindowsHookEx function removes a hook procedure installed in a hook chain by the SetWindowsHookEx function.
    /// </summary>
    /// <param name="hhk">handle to hook procedure</param>
    /// <returns>If the function succeeds, the return value is true.</returns>
    [DllImport("USER32", SetLastError = true)]
    public static extern bool UnhookWindowsHookEx(IntPtr hHook);

    /// <summary>
    /// The CallNextHookEx function passes the hook information to the next hook procedure in the current hook chain.
    /// A hook procedure can call this function either before or after processing the hook information.
    /// </summary>
    /// <param name="hHook">handle to current hook</param>
    /// <param name="code">hook code passed to hook procedure</param>
    /// <param name="wParam">value passed to hook procedure</param>
    /// <param name="lParam">value passed to hook procedure</param>
    /// <returns>If the function succeeds, the return value is true.</returns>
    [DllImport("USER32", SetLastError = true)]
    static extern IntPtr CallNextHookEx(IntPtr hHook, int code, IntPtr wParam, IntPtr lParam);

    [StructLayout(LayoutKind.Sequential)]
    public struct LowLevelKeyboardInputEvent
    {
        /// <summary>
        /// A virtual-key code. The code must be a value in the range 1 to 254.
        /// </summary>
        public int VirtualCode;

        // EDT: added a conversion from VirtualCode to Keys.
        /// <summary>
        /// The VirtualCode converted to typeof(Keys) for higher usability.
        /// </summary>
        public Keys Key { get { return (Keys)VirtualCode; } }

        /// <summary>
        /// A hardware scan code for the key. 
        /// </summary>
        public int HardwareScanCode;

        /// <summary>
        /// The extended-key flag, event-injected Flags, context code, and transition-state flag. This member is specified as follows. An application can use the following values to test the keystroke Flags. Testing LLKHF_INJECTED (bit 4) will tell you whether the event was injected. If it was, then testing LLKHF_LOWER_IL_INJECTED (bit 1) will tell you whether or not the event was injected from a process running at lower integrity level.
        /// </summary>
        public int Flags;

        /// <summary>
        /// The time stamp stamp for this message, equivalent to what GetMessageTime would return for this message.
        /// </summary>
        public int TimeStamp;

        /// <summary>
        /// Additional information associated with the message. 
        /// </summary>
        public IntPtr AdditionalInformation;
    }

    public const int WH_KEYBOARD_LL = 13;
    //const int HC_ACTION = 0;

    public enum KeyboardState
    {
        KeyDown = 0x0100,
        KeyUp = 0x0101,
        SysKeyDown = 0x0104,
        SysKeyUp = 0x0105
    }

    // EDT: Replaced VkSnapshot(int) with RegisteredKeys(Keys[])
    public static Keys[] RegisteredKeys;
    const int KfAltdown = 0x2000;
    public const int LlkhfAltdown = (KfAltdown >> 8);

    public IntPtr LowLevelKeyboardProc(int nCode, IntPtr wParam, IntPtr lParam)
    {
        bool fEatKeyStroke = false;

        var wparamTyped = wParam.ToInt32();
        if (Enum.IsDefined(typeof(KeyboardState), wparamTyped))
        {
            object o = Marshal.PtrToStructure(lParam, typeof(LowLevelKeyboardInputEvent));
            LowLevelKeyboardInputEvent p = (LowLevelKeyboardInputEvent)o;

            var eventArguments = new GlobalKeyboardHookEventArgs(p, (KeyboardState)wparamTyped);

            // EDT: Removed the comparison-logic from the usage-area so the user does not need to mess around with it.
            // Either the incoming key has to be part of RegisteredKeys (see constructor on top) or RegisterdKeys
            // has to be null for the event to get fired.
            var key = (Keys)p.VirtualCode;
            if (RegisteredKeys == null || RegisteredKeys.Contains(key))
            {
                EventHandler<GlobalKeyboardHookEventArgs> handler = KeyboardPressed;
                handler?.Invoke(this, eventArguments);

                fEatKeyStroke = eventArguments.Handled;
            }
        }

        return fEatKeyStroke ? (IntPtr)1 : CallNextHookEx(IntPtr.Zero, nCode, wParam, lParam);
    }
} 
```

**用法** *差异可以在这里看到*

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private GlobalKeyboardHook _globalKeyboardHook;

    private void buttonHook_Click(object sender, EventArgs e)
    {
        // Hooks only into specified Keys (here "A" and "B").
        _globalKeyboardHook = new GlobalKeyboardHook(new Keys[] { Keys.A, Keys.B });

        // Hooks into all keys.
        _globalKeyboardHook = new GlobalKeyboardHook();
        _globalKeyboardHook.KeyboardPressed += OnKeyPressed;
    }

    private void OnKeyPressed(object sender, GlobalKeyboardHookEventArgs e)
    {
        // EDT: No need to filter for VkSnapshot anymore. This now gets handled
        // through the constructor of GlobalKeyboardHook(...).
        if (e.KeyboardState == GlobalKeyboardHook.KeyboardState.KeyDown)
        {
            // Now you can access both, the key and virtual code
            Keys loggedKey = e.KeyboardData.Key;
            int loggedVkCode = e.KeyboardData.VirtualCode;
        }
    }
} 
```

感谢[Siarhei Kuchuk](https://stackoverflow.com/users/212746/siarhei-kuchuk)的帖子。即使我已经简化了使用，这个初始代码对我来说也非常有用。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-02T23:41:31.600

如果全局热键就足够了，那么[RegisterHotKey](http://www.pinvoke.net/default.aspx/user32/RegisterHotKey.html)就可以了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-11T10:58:44.923

我的代表太低无法评论，但关于`CallbackOnCollectedDelegate`异常，我修改了`public void SetupKeyboardHooks()`C4d 中***的***答案，如下所示：

```
public void SetupKeyboardHooks(out object hookProc)
{
  _globalKeyboardHook = new GlobalKeyboardHook();
  _globalKeyboardHook.KeyboardPressed += OnKeyPressed;

  hookProc = _globalKeyboardHook.GcSafeHookProc;
} 
```

哪里`GcSafeHookProc`只是`_hookProc`OP 中的公共吸气剂

```
_hookProc = LowLevelKeyboardProc; // we must keep alive _hookProc, because GC is not aware about SetWindowsHookEx behaviour. 
```

并将 存储`hookProc`为调用 的类中的私有字段`SetupKeyboardHooks(...)`，因此使引用保持活动状态，从垃圾收集中保存，不再有`CallbackOnCollectedDelegate`异常。似乎在课堂上有这个额外的参考`GlobalKeyboardHook`是不够的。也许确保在关闭您的应用程序时也处理此引用。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2020-02-21T11:58:06.443

```
private void buttonHook_Click(object sender, EventArgs e)
{
    // Hooks only into specified Keys (here "A" and "B").
    // (***) Use this constructor

    _globalKeyboardHook = new GlobalKeyboardHook(new Keys[] { Keys.A, Keys.B });

    // Hooks into all keys.
    // (***) Or this - not both

    _globalKeyboardHook = new GlobalKeyboardHook();
    _globalKeyboardHook.KeyboardPressed += OnKeyPressed;
} 
```

然后工作正常。

# java - 如何从Java中的字符串值中获取枚举值

> ID：604424
> 
> 赞同：2230
> 
> 时间：2009-03-02T22:56:34.750
> 
> 标签：java, enums

说我有一个枚举，它只是

```
public enum Blah {
    A, B, C, D
} 
```

我想找到一个字符串的枚举值，`"A"`例如`Blah.A`. 怎么可能做到这一点？

是[`Enum.valueOf()`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Enum.html#valueOf(java.lang.Class,java.lang.String))我需要的方法吗？如果是这样，我将如何使用它？

* * *

## 回答 #1

> 赞同：2491
> 
> 时间：2009-03-02T22:57:44.217

是的，`Blah.valueOf("A")`会给你`Blah.A`。

请注意，名称必须*完全*匹配，包括 case:`Blah.valueOf("a")`并且`Blah.valueOf("A ")`两者都抛出`IllegalArgumentException`.

静态方法`valueOf()`和`values()`是在编译时创建的，不会出现在源代码中。不过，它们确实出现在 Javadoc 中；例如，[`Dialog.ModalityType`](http://docs.oracle.com/javase/7/docs/api/java/awt/Dialog.ModalityType.html)显示这两种方法。

* * *

## 回答 #2

> 赞同：977
> 
> 时间：2010-06-03T10:57:50.377

如果文本与枚举值不同的另一种解决方案：

```
public enum Blah {
    A("text1"),
    B("text2"),
    C("text3"),
    D("text4");

    private String text;

    Blah(String text) {
        this.text = text;
    }

    public String getText() {
        return this.text;
    }

    public static Blah fromString(String text) {
        for (Blah b : Blah.values()) {
            if (b.text.equalsIgnoreCase(text)) {
                return b;
            }
        }
        return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：139
> 
> 时间：2016-06-15T16:37:01.017

使用[Joshua Bloch](https://en.wikipedia.org/wiki/Joshua_Bloch) , *Effective Java*中的模式：

（为简洁而简化）

```
enum MyEnum {
    ENUM_1("A"),
    ENUM_2("B");

    private String name;

    private static final Map<String,MyEnum> ENUM_MAP;

    MyEnum (String name) {
        this.name = name;
    }

    public String getName() {
        return this.name;
    }

    // Build an immutable map of String name to enum pairs.
    // Any Map impl can be used.

    static {
        Map<String,MyEnum> map = new ConcurrentHashMap<String, MyEnum>();
        for (MyEnum instance : MyEnum.values()) {
            map.put(instance.getName().toLowerCase(),instance);
        }
        ENUM_MAP = Collections.unmodifiableMap(map);
    }

    public static MyEnum get (String name) {
        return ENUM_MAP.get(name.toLowerCase());
    }
} 
```

另见：

[使用枚举和实例映射的 Oracle Java 示例](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#d5e12267)

[Enum 类型中静态块的执行顺序](https://stackoverflow.com/questions/11776698/execution-order-of-of-static-blocks-in-an-enum-type-w-r-t-to-constructor)

[如何从其 String 值中查找 Java 枚举](https://stackoverflow.com/questions/1080904/how-can-i-lookup-a-java-enum-from-its-string-value)

* * *

## 回答 #4

> 赞同：129
> 
> 时间：2009-11-12T15:52:49.027

这是我使用的一个漂亮的实用程序：

```
/**
 * A common method for all enums since they can't have another base class
 * @param <T> Enum type
 * @param c enum type. All enums must be all caps.
 * @param string case insensitive
 * @return corresponding enum, or null
 */
public static <T extends Enum<T>> T getEnumFromString(Class<T> c, String string) {
    if( c != null && string != null ) {
        try {
            return Enum.valueOf(c, string.trim().toUpperCase());
        } catch(IllegalArgumentException ex) {
        }
    }
    return null;
} 
```

然后在我的枚举类中，我通常有这个来节省一些打字：

```
public static MyEnum fromString(String name) {
    return getEnumFromString(MyEnum.class, name);
} 
```

如果您的枚举不是全部大写，只需更改该`Enum.valueOf`行。

太糟糕了，我不能使用`T.class`，`Enum.valueOf`因为`T`被擦除了。

* * *

## 回答 #5

> 赞同：77
> 
> 时间：2009-05-09T16:33:36.007

你也应该小心你的情况。让我解释一下：做`Blah.valueOf("A")`有效，但`Blah.valueOf("a")`不会有效。然后`Blah.valueOf("a".toUpperCase(Locale.ENGLISH))`又会工作。

[`Locale.US`](http://developer.android.com/reference/java/util/Locale.html#default_locale)正如[sulai 指出的那样](https://stackoverflow.com/questions/604424/java-convert-string-to-enum/843600#comment27337289_843600)，您应该在 Android 上使用。

* * *

## 回答 #6

> 赞同：51
> 
> 时间：2017-08-01T10:17:36.793

在 Java 8 或更高版本中，使用[Streams](https://docs.oracle.com/javase/tutorial/collections/streams/)：

```
public enum Blah
{
    A("text1"),
    B("text2"),
    C("text3"),
    D("text4");

    private String text;

    Blah(String text) {
        this.text = text;
    }

    public String getText() {
        return this.text;
    }

    public static Optional<Blah> fromText(String text) {
        return Arrays.stream(values())
          .filter(bl -> bl.text.equalsIgnoreCase(text))
          .findFirst();
    }
} 
```

* * *

## 回答 #7

> 赞同：40
> 
> 时间：2011-12-01T21:53:29.490

这是一种可以对任何 Enum 执行此操作的方法，并且不区分大小写。

```
/** 
 * Finds the value of the given enumeration by name, case-insensitive. 
 * Throws an IllegalArgumentException if no match is found.  
 **/
public static <T extends Enum<T>> T valueOfIgnoreCase(
        Class<T> enumeration, String name) {

    for (T enumValue : enumeration.getEnumConstants()) {
        if (enumValue.name().equalsIgnoreCase(name)) {
            return enumValue;
        }
    }

    throw new IllegalArgumentException(String.format(
        "There is no value with name '%s' in Enum %s",
        name, enumeration.getName()
    ));
} 
```

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2009-05-09T17:23:23.863

使用`Blah.valueOf(string)`是最好的，但你也可以使用`Enum.valueOf(Blah.class, string)`。

* * *

## 回答 #9

> 赞同：35
> 
> 时间：2017-07-13T13:38:02.023

我的两分钱：使用 Java 8 Streams 并检查一个确切的字符串：

```
public enum MyEnum {
    VALUE_1("Super"),
    VALUE_2("Rainbow"),
    VALUE_3("Dash"),
    VALUE_3("Rocks");

    private final String value;

    MyEnum(String value) {
        this.value = value;
    }

    /**
     * @return the Enum representation for the given string.
     * @throws IllegalArgumentException if unknown string.
     */
    public static MyEnum fromString(String s) throws IllegalArgumentException {
        return Arrays.stream(MyEnum.values())
                .filter(v -> v.value.equals(s))
                .findFirst()
                .orElseThrow(() -> new IllegalArgumentException("unknown value: " + s));
    }
} 
```

我将该函数重命名为 ，`fromString()`因为使用该约定命名它，您将从 Java 语言本身获得一些好处；例如：

1.  [在 HeaderParam 注解处直接转换类型](https://docs.oracle.com/javaee/7/api/javax/ws/rs/HeaderParam.html)

* * *

## 回答 #10

> 赞同：29
> 
> 时间：2014-04-02T20:12:18.980

如果您不想编写自己的实用程序，请使用 Google 的[guava](/questions/tagged/guava "显示标记为“番石榴”的问题")库：

```
Enums.getIfPresent(Blah.class, "A") 
```

与内置的 Java 函数不同，它让您检查 A 是否存在于 Blah 中并且不会引发异常。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2015-07-02T11:54:04.433

您可能需要这样做：

```
public enum ObjectType {
    PERSON("Person");

    public String parameterName;

    ObjectType(String parameterName) {
        this.parameterName = parameterName;
    }

    public String getParameterName() {
        return this.parameterName;
    }

    // From the String method, it will return you the Enum for the provided input string
    public static ObjectType fromString(String parameterName) {
        if (parameterName != null) {
            for (ObjectType objType : ObjectType.values()) {
                if (parameterName.equalsIgnoreCase(objType.parameterName)) {
                    return objType;
                }
            }
        }
        return null;
    }
} 
```

### 又多了一个

```
 public static String fromEnumName(String parameterName) {
        if (parameterName != null) {
            for (DQJ objType : DQJ.values()) {
                if (parameterName.equalsIgnoreCase(objType.name())) {
                    return objType.parameterName;
                }
            }
        }
        return null;
    } 
```

这将通过字符串化枚举名称返回值。例如，如果您在 fromEnumName 中提供“PERSON”，它将返回 Enum 的值，即“Person”。

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2011-11-29T05:02:25.897

另一种方法是使用`name()`Enum 的隐式静态方法。*name*将返回用于创建该枚举的确切字符串，该枚举可用于检查提供的字符串：

```
public enum Blah {

    A, B, C, D;

    public static Blah getEnum(String s){
        if(A.name().equals(s)){
            return A;
        }else if(B.name().equals(s)){
            return B;
        }else if(C.name().equals(s)){
            return C;
        }else if (D.name().equals(s)){
            return D;
        }
        throw new IllegalArgumentException("No Enum specified for this string");
    }
} 
```

测试：

```
System.out.println(Blah.getEnum("B").name());

// It will print B  B 
```

灵感：*[Java 中的 10 个枚举示例](http://javarevisited.blogspot.com/2011/08/enum-in-java-example-tutorial.html)*

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2014-08-22T20:07:47.170

这是使用[Guava](https://en.wikipedia.org/wiki/Google_Guava)库的解决方案。方法 getPlanet() 不区分大小写，因此 getPlanet ("MerCUrY") 将返回 Planet.MERCURY。

```
package com.universe.solarsystem.planets;
import org.apache.commons.lang3.StringUtils;
import com.google.common.base.Enums;
import com.google.common.base.Optional;

//Pluto and Eris are dwarf planets, who cares!
public enum Planet {
   MERCURY,
   VENUS,
   EARTH,
   MARS,
   JUPITER,
   SATURN,
   URANUS,
   NEPTUNE;

   public static Planet getPlanet(String name) {
      String val = StringUtils.trimToEmpty(name).toUpperCase();
      Optional <Planet> possible = Enums.getIfPresent(Planet.class, val);
      if (!possible.isPresent()) {
         throw new IllegalArgumentException(val + "? There is no such planet!");
      }
      return possible.get();
   }
} 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2017-04-27T17:10:02.040

在 Java 8 中，静态 Map 模式更加简单，是我的首选方法。如果您想将枚举与杰克逊一起使用，您可以覆盖 toString 并使用它而不是名称，然后使用注释`@JsonValue`

```
public enum MyEnum {
    BAR,
    BAZ;
    private static final Map<String, MyEnum> MAP = Stream.of(MyEnum.values()).collect(Collectors.toMap(Enum::name, Function.identity()));
    public static MyEnum fromName(String name){
        return MAP.get(name);
    }
}

public enum MyEnumForJson {
    BAR("bar"),
    BAZ("baz");
    private static final Map<String, MyEnumForJson> MAP = Stream.of(MyEnumForJson.values()).collect(Collectors.toMap(Object::toString, Function.identity()));
    private final String value;

    MyEnumForJson(String value) {
        this.value = value;
    }

    @JsonValue
    @Override
    public String toString() {
        return value;
    }

    public static MyEnumForJson fromValue(String value){
        return MAP.get(value);
    }
} 
```

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2019-06-23T08:44:06.447

枚举非常有用。我一直在使用`Enum`很多不同语言为某些字段添加描述，如下例所示：

```
public enum Status {

    ACT(new String[] { "Accepted", "مقبول" }),
    REJ(new String[] { "Rejected", "مرفوض" }),
    PND(new String[] { "Pending", "في الانتظار" }),
    ERR(new String[] { "Error", "خطأ" }),
    SNT(new String[] { "Sent", "أرسلت" });

    private String[] status;

    public String getDescription(String lang) {
        return lang.equals("en") ? status[0] : status[1];
    }

    Status(String[] status) {
        this.status = status;
    }
} 
```

然后您可以根据传递给`getDescription(String lang)`方法的语言代码动态检索描述，例如：

```
String statusDescription = Status.valueOf("ACT").getDescription("en"); 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2014-10-10T10:10:17.463

为了补充前面的答案，并解决一些关于 null 和[NPE](https://en.wikipedia.org/wiki/Null_pointer#Dereferencing)的讨论，我使用[Guava](https://en.wikipedia.org/wiki/Google_Guava) *Optionals*来处理缺席/无效的情况。这对于 URI 和参数解析非常有用。

```
public enum E {
    A,B,C;
    public static Optional<E> fromString(String s) {
        try {
            return Optional.of(E.valueOf(s.toUpperCase()));
        } catch (IllegalArgumentException|NullPointerException e) {
            return Optional.absent();
        }
    }
} 
```

对于那些不知道的人，这里有一些关于使用*[Optional](https://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained#Optional)*避免 null 的更多信息。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2011-11-09T09:50:35.827

```
public static MyEnum getFromValue(String value) {
    MyEnum resp = null;
    MyEnum nodes[] = values();
    for(int i = 0; i < nodes.length; i++) {
        if(nodes[i].value.equals(value)) {
            resp = nodes[i];
            break;
        }
    }
    return resp;
} 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2014-10-29T12:22:18.807

`java.lang.Enum`定义了几个有用的方法，适用于 Java 中的所有枚举类型：

*   您可以使用该`name()`方法获取任何 Enum 常量的名称。用于编写枚举常量的字符串文字是它们的名称。
*   同样，该`values()`方法可用于从 Enum 类型中获取所有 Enum 常量的数组。
*   对于问的问题，您可以使用该`valueOf()`方法将任何 String 转换为 Java 中的 Enum 常量，如下所示。

```
public class EnumDemo06 {
    public static void main(String args[]) {
        Gender fromString = Gender.valueOf("MALE");
        System.out.println("Gender.MALE.name() : " + fromString.name());
    }

    private enum Gender {
        MALE, FEMALE;
    }
}

Output:
Gender.MALE.name() : MALE 
```

在此代码片段中，该`valueOf()`方法返回一个 Enum 常量*Gender.MALE*，并在其上调用 name `"MALE"`。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2015-09-23T09:08:33.813

一种 O(1) 方法，灵感来自[Thrift](https://en.wikipedia.org/wiki/Apache_Thrift)生成的代码，该代码使用哈希图。

```
public enum USER {
        STUDENT("jon",0),TEACHER("tom",1);

        private static final Map<String, Integer> map = new HashMap<>();

        static {
                for (USER user : EnumSet.allOf(USER.class)) {
                        map.put(user.getTypeName(), user.getIndex());
                }
        }

        public static int findIndexByTypeName(String typeName) {
                return map.get(typeName);
        }

        private USER(String typeName,int index){
                this.typeName = typeName;
                this.index = index;
        }
        private String typeName;
        private int index;
        public String getTypeName() {
                return typeName;
        }
        public void setTypeName(String typeName) {
                this.typeName = typeName;
        }
        public int getIndex() {
                return index;
        }
        public void setIndex(int index) {
                this.index = index;
        }

} 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2015-10-22T06:46:11.117

Apache 的[commons-lang](https://commons.apache.org/proper/commons-lang%20commons-lang)库有一个静态函数[org.apache.commons.lang3.EnumUtils.getEnum](https://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/EnumUtils.html#getEnum(java.lang.Class,%20java.lang.String) "EnumUtils.getEnum")，它将一个 String 映射到你的 Enum 类型。基本上与[Geoffrey Zheng 的](https://stackoverflow.com/questions/604424/how-to-get-an-enum-value-from-a-string-value-in-java/1723239#1723239)答案相同，但是当它已经在野外时，没有必要自行推出。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2017-12-30T07:38:31.523

采用：

```
public enum MyEnum {
    FIRST,
    SECOND,
    THIRD;

    public static Optional<MyEnum> fromString(String value) {
        try {
            return Optional.of(MyEnum.valueOf(value));
        }catch(Exception e) {
            return Optional.empty();
        }
    }
} 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2017-01-26T20:30:18.587

添加到[迈克尔迈尔斯的答案](https://stackoverflow.com/questions/604424/how-to-get-an-enum-value-from-a-string-value-in-java/604426#604426)，有一个有用的实用程序......

`valueOf()`在不喜欢其输入的情况下抛出两个不同的异常。

*   `IllegalArgumentException`
*   `NullPointerExeption`

如果您的要求无法保证您的 String 肯定会匹配枚举值，例如，如果 String 数据来自数据库并且可能包含旧版本的枚举，那么您将需要处理这些经常...

所以这是我写的一个可重用的方法，它允许我们定义一个默认的枚举，如果我们传递的字符串不匹配，则返回。

```
private static <T extends Enum<T>> T valueOf( String name , T defaultVal) {
        try {
            return Enum.valueOf(defaultVal.getDeclaringClass() , name);
        } catch (IllegalArgumentException | NullPointerException e) {
            return defaultVal;
        }
    } 
```

像这样使用它：

```
public enum MYTHINGS {
    THINGONE,
    THINGTWO
}

public static void main(String [] asd) {
  valueOf("THINGTWO" , MYTHINGS.THINGONE);//returns MYTHINGS.THINGTWO
  valueOf("THINGZERO" , MYTHINGS.THINGONE);//returns MYTHINGS.THINGONE
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2018-08-02T19:57:17.570

由于`switch`尚未提及-version，因此我介绍了它（重用OP的枚举）：

```
 private enum Blah {
    A, B, C, D;

    public static Blah byName(String name) {
      switch (name) {
        case "A":
          return A;
        case "B":
          return B;
        case "C":
          return C;
        case "D":
          return D;
        default:
          throw new IllegalArgumentException(
            "No enum constant " + Blah.class.getCanonicalName() + "." + name);
      }
    }
  } 
```

由于这不会给该方法带来任何额外的价值`valueOf(String name)`，因此如果我们想要有不同的行为，定义一个额外的方法才有意义。如果我们不想提出 an`IllegalArgumentException`我们可以将实现更改为：

```
 private enum Blah {
    A, B, C, D;

    public static Blah valueOfOrDefault(String name, Blah defaultValue) {
      switch (name) {
        case "A":
          return A;
        case "B":
          return B;
        case "C":
          return C;
        case "D":
          return D;
        default:
          if (defaultValue == null) {
            throw new NullPointerException();
          }
          return defaultValue;
      }
    }
  } 
```

通过提供一个默认值，我们可以保持[合约](https://docs.oracle.com/javase/10/docs/api/java/lang/Enum.html#valueOf(java.lang.Class,java.lang.String))of ，而不会 以那种在任何情况下都不会返回的方式`Enum.valueOf(String name)`抛出 an 。因此我们抛出一个if name is和if is的情况。就是这样工作的。`IllegalArgumentException``null``NullPointerException``null``default``defaultValue``null``valueOfOrDefault`

这种方法采用了`Map`-Interface 的设计，它提供了`Map.getOrDefault(Object key, V defaultValue)`Java 8 的方法。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2020-12-29T11:18:29.250

我正在寻找一个答案来找到“blah”名称而不是它的值（不是文本）。根据[Manu 的回答](https://stackoverflow.com/questions/604424/how-to-get-an-enum-value-from-a-string-value-in-java/45082346#45082346)，我发现这段代码很有用：

```
public enum Blah {
    A("text1"),
    B("text2"),
    C("text3"),
    D("text4");

private String text;

Blah(String text) {
    this.text = text;
}

public String getText() {
    return this.text;
}

public static Blah valueOfCode(String blahCode) throws IllegalArgumentException {
    Blah blah = Arrays.stream(Blah.values())
            .filter(val -> val.name().equals(blahCode))
            .findFirst()
            .orElseThrow(() -> new IllegalArgumentException("Unable to resolve blah: " + blahCode));

    return blah;
} 
```

}

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2021-03-05T06:46:08.530

枚举 valueOf()

枚举类在编译时会自动获取类中的静态 valueOf() 方法。valueOf() 方法可用于获取给定 String 值的枚举类的实例。

例如：

```
public class Main {
    public static void main(String[] args) throws Exception {
        System.out.println(Strings.TWO.name());
    }
    enum Strings {
        ONE, TWO, THREE
    }
} 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2021-07-08T14:02:24.863

`Blah.valueOf("A")`是您要查找的语句，但请记住，这是区分大小写的，因此**Blah.valueOf** ("a") 将不起作用并会生成异常。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-02-24T11:23:07.287

另一个以相反方式捕获的实用程序。使用标识该枚举的值，而不是其名称。

```
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;
import java.util.EnumSet;

public class EnumUtil {

    /**
     * Returns the <code>Enum</code> of type <code>enumType</code> whose a 
     * public method return value of this Enum is 
     * equal to <code>valor</code>.<br/>
     * Such method should be unique public, not final and static method 
     * declared in Enum.
     * In case of more than one method in match those conditions
     * its first one will be chosen.
     * 
     * @param enumType
     * @param value
     * @return 
     */
    public static <E extends Enum<E>> E from(Class<E> enumType, Object value) {
        String methodName = getMethodIdentifier(enumType);
        return from(enumType, value, methodName);
    }

    /**
     * Returns the <code>Enum</code> of type <code>enumType</code> whose  
     * public method <code>methodName</code> return is 
     * equal to <code>value</code>.<br/>
     *
     * @param enumType
     * @param value
     * @param methodName
     * @return
     */
    public static <E extends Enum<E>> E from(Class<E> enumType, Object value, String methodName) {
        EnumSet<E> enumSet = EnumSet.allOf(enumType);
        for (E en : enumSet) {
            try {
                String invoke = enumType.getMethod(methodName).invoke(en).toString();
                if (invoke.equals(value.toString())) {
                    return en;
                }
            } catch (Exception e) {
                return null;
            }
        }
        return null;
    }

    private static String getMethodIdentifier(Class<?> enumType) {
        Method[] methods = enumType.getDeclaredMethods();
        String name = null;
        for (Method method : methods) {
            int mod = method.getModifiers();
            if (Modifier.isPublic(mod) && !Modifier.isStatic(mod) && !Modifier.isFinal(mod)) {
                name = method.getName();
                break;
            }
        }
        return name;
    }
} 
```

例子：

```
public enum Foo {
    ONE("eins"), TWO("zwei"), THREE("drei");

    private String value;

    private Foo(String value) {
        this.value = value;
    }

    public String getValue() {
        return value;
    }
} 
```

`EnumUtil.from(Foo.class, "drei")`返回`Foo.THREE`，因为它将`getValue`用于匹配“drei”，这是唯一的公共方法，不是 Foo 中的最终方法和静态方法。如果 Foo 有多个 public、not final 和 not static 方法，例如，`getTranslate`它返回“drei”，则可以使用其他方法：`EnumUtil.from(Foo.class, "drei", "getTranslate")`.

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2021-08-19T12:00:30.993

```
public enum ToggleStatusUpdate {
    OFF("off", 1),
    ON("on", 2);

    private final String name;
    private final int position;

    private ToggleStatusUpdate(String name, int position) {
        this.name = name;
        this.position = position;
    }

    public String getName() {
        return name;
    }

    public int getPosition() {
        return position;
    }

    public static int getPositionForName(String name) {
        for(ToggleStatusUpdate toggleStatusUpdate : ToggleStatusUpdate.values()) {
            if (toggleStatusUpdate.getName().equals(name)) {
                return toggleStatusUpdate.getPosition();
            }
        }
        return -1;
    }

    public static void main(String[] args) {
        System.out.println(ToggleStatusUpdate.getPositionForName("off"));
    }
} 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2022-02-01T16:42:57.690

使用 Streams 的 Java 8 答案和评论的组合。它使用默认值创建一个静态 Map 进行查找，以防止空检查。

```
public enum Blah {
    A, B, C, D, INVALID

    private static final Map<String, Blah> ENUM_MAP = Stream.of(Blah.values())
            .collect(Collectors.toMap(Enum::name, Function.identity()));

    public static Blah of(final String name) {
        return ENUM_MAP.getOrDefault(name, INVALID);
    }
}

// e.g.
Blah.of("A");
A

Blah.of("X")
INVALID 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-08-30T09:11:58.353

我喜欢使用这种过程将命令作为字符串解析为枚举。我通常将其中一个枚举设为“未知”，因此在未找到其他枚举（即使在不区分大小写的情况下）而不是 null （这意味着没有值）时返回它会有所帮助。因此我使用这种方法。

```
static <E extends Enum<E>> Enum getEnumValue(String what, Class<E> enumClass) {
    Enum<E> unknown=null;
    for (Enum<E> enumVal: enumClass.getEnumConstants()) {  
        if (what.compareToIgnoreCase(enumVal.name()) == 0) {
            return enumVal;
        }
        if (enumVal.name().compareToIgnoreCase("unknown") == 0) {
            unknown=enumVal;
        }
    }  
    return unknown;
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-04-16T13:25:25.633

获取枚举名称的最快方法是在应用程序启动时创建枚举文本和值的映射，并调用函数 Blah.getEnumName() 获取名称：

```
public enum Blah {
    A("text1"),
    B("text2"),
    C("text3"),
    D("text4");

    private String text;
    private HashMap<String, String> map;
    Blah(String text) {
    this.text = text;
    }

    public String getText() {
      return this.text;
    }

    static{
      createMapOfTextAndName();
    }

    public static void createMapOfTextAndName() {
        map = new HashMap<String, String>();
        for (Blah b : Blah.values()) {
             map.put(b.getText(),b.name());
        }
    }
    public static String getEnumName(String text) {
        return map.get(text.toLowerCase());
    }
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2020-01-18T00:08:41.987

## Kotlin 解决方案

创建一个分机，然后调用`valueOf<MyEnum>("value")`. 如果类型无效，你会得到 null 并且必须处理它

```
inline fun <reified T : Enum<T>> valueOf(type: String): T? {
    return try {
        java.lang.Enum.valueOf(T::class.java, type)
    } catch (e: Exception) {
        null
    }
} 
```

或者，您可以设置默认值，调用`valueOf<MyEnum>("value", MyEnum.FALLBACK)`并避免空响应。您可以扩展您的特定枚举以使默认值为自动

```
inline fun <reified T : Enum<T>> valueOf(type: String, default: T): T {
    return try {
        java.lang.Enum.valueOf(T::class.java, type)
    } catch (e: Exception) {
        default
    }
} 
```

或者如果你想要两者，做第二个：

```
inline fun <reified T : Enum<T>> valueOf(type: String, default: T): T = valueOf<T>(type) ?: default 
```

# sql - ADO.net 无需编写 SQL（尤其是 WHERE）

> ID：604430
> 
> 赞同：1
> 
> 时间：2009-03-02T23:00:17.160
> 
> 标签：sql, stored-procedures, ado.net, datatable, views

我有这样的想法，使用 SQL VIEWS 来抽象简单的数据库计算（例如对关系的计数）就足够了，并且您不需要过程（== 过程代码）

一个简单的 sql***视图***+ ***where***子句 >> 有时带有参数的存储过程

在提出这一点时，我设想了一种无需编写 SQL 且无需编写 where 子句即可检索表/视图数据的方法。

但是，令我惊讶的是，在 ADO.NET 2.0 或更高版本中似乎没有办法实现这一点。

让我告诉你我尝试了什么：

*   SqlDataAdapter + SqlCommandBuilder 仍然需要您在字符串中编写“SELECT ... FROM”和**WHERE CLAUSE**（另外，如果您放置“where”，则不会过多使用 Update/Insert/DeleteCommand）

*   类型化的 DataSet 只允许您检索_整个 DataTable_s，然后对其应用过滤器。过滤器是字符串，没有转义帮助...（必须双引号！）

*   SQL to Entities 看起来很有希望，但它们似乎：仅限于 MSSQL，生成臃肿的 SQL 查询，生成全新的 DAO 堆栈（除了现有的域模型类），所有这些都需要 .net 3.5+ 等等（也就是说，所有这些对我来说都是缺点）

其他 ORM 也有与 SQL to Entity 类似的问题。

我正在寻找的是一种访问数据库表/***视图***的强类型方法：

*   不附带另一套 DAO (KISS)
*   允许我查询表而不在字符串中写入“SELECTs”（强类型）
*   允许我过滤（***WHERE***）具有正确转义参数的表（并且无需事先检索整个数据）
*   以后可以发布更新/插入/删除

我对.Net 相当陌生，但并不愚蠢：这存在吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-15T15:44:05.200

[流利的ADO](http://fluentado.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-15T15:26:55.017

我真的不相信如果不使用某种 ORM 或带有编译器的专用 DSL 以某种方式*知道*您的数据库模式、类型/列信息等，您想要做的事情是可以实现的。

考虑到 C# 是一种通用语言，它的编译器完全不知道你的数据库类型，这就是为什么你不能在不使用一些抽象层的情况下绑定它们，这通常涉及即席 SQL 查询（字符串）、NHibernate 或类似的映射文件（更多字符串）和/或 DAO。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-20T20:23:24.567

[Subsonic](http://subsonicproject.com)有一个相当轻量级的[查询工具](http://subsonicproject.com/docs/Simple_Query_Tool)，您可以使用它直接使用抽象 SQL 的 Query 对象查询数据库。如果您愿意，您还可以使用它的代码生成工具将您的数据库表映射到 POCO，或者只创建一个强类型模式（用于列/表名等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T23:13:19.470

如果您不想编写 WHERE 子句，一种方法是使用 Filter 对象并添加您想要的条件。例如：

```
 var sc = new Filter();
        sc.Add("Contacttitle", "Sales Agent");
        sc.Add("city", "london", Logical.Or);
        var customers = D2Bk.Fetch(sc, new Customers()); 
```

但是您不想使用 DAO（上面的客户就是这样），因此您必须编写 SQL 语句并指定 where 子句：

```
 DataSet ds = D2Bk.Fetch("SELECT * FROM Customers WHERE Contacttitle=@PAR1 OR City=@PAR2", "Sales Agent", "london"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-15T12:38:39.473

我曾经用存储过程做过类似的事情。基本上，我想在 WHERE 子句中指定要匹配的任何字段排列，但我不想编写 100 个参数列表和 where 子句略有不同的存储过程。

所以，我做了这样的事情：

```
CREATE PROCEDURE [GetSimpleCustomers]
(
@ID varchar(50) = null,
@Name varchar(50) = null,
@IsActive  bit = null,
@Address1 varchar(50) = null,
@Address2 varchar(50) = null,
@City varchar(50) = null,
@State varchar(50) = null,
@Zip varchar(50) = null
)
AS

SELECT ID, Name, IsActive, Address1, Address2, City, State, Zip
FROM SimpleCustomerExample
WHERE (ID = @ID OR @ID is NULL)
AND (Name = @Name OR @Name is NULL)
AND (IsActive = @IsActive or @IsActive is NULL)
AND (Address1= @Address1 or @Address1 is NULL)
AND (Address2= @Address2 or @Address2 is NULL)
AND (City= @City or @City is NULL)
AND (State= @State or @State is NULL)
AND (Zip= @Zip or @Zip is NULL) 
```

这将让您在代码中调用 sproc 并只传递您有兴趣过滤的参数，如果您将它们留空，其余的将不会被考虑在内。

所以，你可以做类似的事情

```
public List<SimpleCustomer> GetAllCustomersFromOhio()
{
    List<SimpleCustomer> list = new List<SimpleCustomer>();
    using (SqlCommand cmd = new SqlCommand(blah blah))
    {
        cmd.Parameters.AddWithValue("State", "Ohio");//or "OH" depending on your convention
        using(IDataReader oDR = cmd.ExecuteReader())
        {
             //hydrate your list of SimpleCustomers from the record set.
        }
    }
    return list;
} 
```

编辑：回复评论：您可以通过更改 GetSimpleCustomers 很容易地更改为 DeleteSimpleCustomers

```
SELECT <columns> FROM SimpleCustomers 
```

到

```
DELETE FROM SimpleCustomers 
```

并保持相同的逻辑。更新也是如此。另外，我将用一个问题来回答一个问题：您有多少表实际上需要这种级别的自定义过滤？语法将非常相似，您可以在一天内完成所有操作（如果您拼凑一个简单的脚本为您编写它，则更少）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-15T12:44:47.557

我假设您已经查看了[LINQ](https://connect.microsoft.com/office)和[ADO.Net 数据服务](http://msdn.microsoft.com/en-us/data/bb931106.aspx)，但这些不符合您的某些要求？

本机 ADO.Net 是一个数据库提供程序，因此它提供了一个直接连接到底层数据源的 SQL 接口。有各种基于 CRUB 的解决方案可以在不同程度上模拟您的建议。

我们有一个强烈的内部趋势，将数据库留给数据库团队，并使用 Web 服务作为我们数据库的主要接口，主要是因为仍然需要支持 Delphi 代码库。

实际上不敢相信我忘记添加[ADO.Net 实体框架](http://msdn.microsoft.com/en-us/library/aa697427.aspx)，它被 ADO.Net 数据服务等使用。还有一个 LINQ to Entities 提供程序。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-15T20:20:29.540

如果您使用强类型数据集，您可以在 Visual Studio 编辑器中创建参数化查询，方法是在查询中添加前缀为 @ 的标识符。在 Visual Studio 中创建一个 DataSet XSD 文件并创建一个名为 Products 的新表，然后向其中添加一个新查询。

例如：

```
select * from Products where Category = @category; 
```

这将自动生成填充数据集的方法或获取采用额外参数的数据表。它还将处理转义字符串的属性（使用命令对象上的参数）。我用它相当快地创建了一些超级简单的原型网络应用程序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-16T01:09:44.333

我最近编写了一个用于生成 SQL where 子句的查询“框架”。

主要组件是带有 ToWhereClause() 函数的 BaseQueryArgs 类，该函数使用反射将属性转换为字符串部分。这需要处理转义和正确格式化值的工作。

任何继承 BaseQueryArgs 的类都只需要声明公共属性，最终得到一个强类型查询对象。对于可选属性，您将值设为可为空（引用类型或 Nullable<>），SQL 生成器会过滤掉空值。

您可以使用自定义属性为每个属性定义额外的功能：

*   与属性名称不同的自定义列名称
*   自定义值处理（例如用作 BETWEEN 测试表达式的日期值）

这可用于创建具有强类型查询对象的查询，如下所示：

```
MyCustomQueryArgs args = new MyCustomQueryArgs
{
    ProductFamilyID = 17,
    Region = Regions.Northwest,
    Active = true
};

List<Product> product = QueryProcessor.GetProductsWhere(args); 
```

GetProductsWhere() 显然会调用一些使用生成的 SQL 访问视图的数据方法。

我没有更新/删除的解决方案，但编写一个使用开关或属性来确定表名的方法将对象实例转换为 SQL 语句似乎并不难。

这是非常“自己动手”的，但是这使您可以根据需要自由定制它，并且不包括大量繁重的 ORM/DAO 包装。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-16T22:27:17.727

看看[Mindscapes Lightspeed](http://www.mindscape.co.nz/)产品

它构建了严格类型的 LINQ 可查询模型，从而在各种数据库引擎中生成高效的 SQL 代码，并包括 Memcached 和 Lucene 支持

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-19T03:26:04.497

我在几个项目中使用过 XPO，他们的新版本对查询有更好的支持。

[http://www.devexpress.com/Products/NET/ORM/](http://www.devexpress.com/Products/NET/ORM/)

然而，与所有这些实施一样，实施并非没有缺点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-20T08:40:28.467

我在我的项目中使用[Data Abstract](http://www.dataabstract.com/)。

# c++ - C ++从文件流中读取无符号字符

> ID：604431
> 
> 赞同：22
> 
> 时间：2009-03-02T23:00:39.843
> 
> 标签：c++, file-io, stream, ifstream

我想从二进制文件中读取无符号字节。所以我写了下面的代码。

```
#include <iostream>
#include <fstream>
#include <vector>
#include <istream>

std::string filename("file");
size_t bytesAvailable = 128;
size_t toRead = 128;

std::basic_ifstream<unsigned char> inf(filename.c_str(), std::ios_base::in | std::ios_base::binary) ;
if (inF.good())
{
    std::vector<unsigned char> mDataBuffer;
    mDataBuffer.resize(bytesAvailable) ;
    inF.read(&mDataBuffer[0], toRead) ;
    size_t counted = inF.gcount() ;
} 
```

这导致读取始终为 0 字节，如变量计数所示。

网上似乎有参考资料说我需要设置语言环境才能完成这项工作。我不清楚如何做到这一点。

相同的代码使用数据类型“char”而不是“unsigned char”工作

上面使用 unsigned char 的代码似乎可以在 Windows 上运行，但在 colinux Fedora 2.6.22.18 中运行失败。

我需要做什么才能让它在 linux 上工作？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-02T23:31:57.753

C++ 确实只需要实现为两个版本的字符特征提供明确的特化：

```
std::char_traits<char>
std::char_traits<wchar_t> 
```

流和字符串使用这些特征来计算各种事物，例如 EOF 值、字符范围的比较、将字符扩展为 int 等等。

如果您实例化一个流，例如

```
std::basic_ifstream<unsigned char> 
```

您必须确保流可以使用相应的字符特征特化，并且该特化确实有用。此外，流使用构面来进行数字的实际格式化和读取。同样，您必须手动提供这些专业化。该标准甚至不要求实现具有主模板的完整定义。所以你也可能会得到一个编译错误：

> 错误：无法实例化特化 std::char_traits。

我会`ifstream`改用（这是 a `basic_ifstream<char>`）然后去读入 a `vector<char>`。在解释向量中的数据时，您仍然可以将它们转换为`unsigned char`以后。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-02T23:06:28.330

不要使用 basic_ifstream，因为它需要专业化。

使用静态缓冲区：

```
linux ~ $ cat test_read.cpp
#include <fstream>
#include <iostream>
#include <vector>
#include <string>

using namespace std;

int main( void )
{
        string filename("file");
        size_t bytesAvailable = 128;

        ifstream inf( filename.c_str() );
        if( inf )
        {
                unsigned char mDataBuffer[ bytesAvailable ];
                inf.read( (char*)( &mDataBuffer[0] ), bytesAvailable ) ;
                size_t counted = inf.gcount();
                cout << counted << endl;
        }

        return 0;
}
linux ~ $ g++ test_read.cpp
linux ~ $ echo "123456" > file
linux ~ $ ./a.out
7 
```

使用向量：

```
linux ~ $ cat test_read.cpp

#include <fstream>
#include <iostream>
#include <vector>
#include <string>

using namespace std;

int main( void )
{
        string filename("file");
        size_t bytesAvailable = 128;
        size_t toRead = 128;

        ifstream inf( filename.c_str() );
        if( inf )
        {

                vector<unsigned char> mDataBuffer;
                mDataBuffer.resize( bytesAvailable ) ;

                inf.read( (char*)( &mDataBuffer[0]), toRead ) ;
                size_t counted = inf.gcount();
                cout << counted << " size=" << mDataBuffer.size() << endl;
                mDataBuffer.resize( counted ) ;
                cout << counted << " size=" << mDataBuffer.size() << endl;

        }

        return 0;
}
linux ~ $ g++ test_read.cpp -Wall -o test_read
linux ~ $ ./test_read
7 size=128
7 size=7 
```

在第一次调用中使用保留而不是调整大小：

```
linux ~ $ cat test_read.cpp

#include <fstream>
#include <iostream>
#include <vector>
#include <string>

using namespace std;

int main( void )
{
        string filename("file");
        size_t bytesAvailable = 128;
        size_t toRead = 128;

        ifstream inf( filename.c_str() );
        if( inf )
        {

                vector<unsigned char> mDataBuffer;
                mDataBuffer.reserve( bytesAvailable ) ;

                inf.read( (char*)( &mDataBuffer[0]), toRead ) ;
                size_t counted = inf.gcount();
                cout << counted << " size=" << mDataBuffer.size() << endl;
                mDataBuffer.resize( counted ) ;
                cout << counted << " size=" << mDataBuffer.size() << endl;

        }

        return 0;
}
linux ~ $ g++ test_read.cpp -Wall -o test_read
linux ~ $ ./test_read
7 size=0
7 size=7 
```

如您所见，如果不调用 .resize(counted)，向量的大小将是错误的。请记住这一点。使用强制转换很常见，请参阅[cppReference](http://www.cppreference.com/wiki/io/read)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-03T00:36:08.257

一个更简单的方法：

```
#include <fstream>
#include <vector>

using namespace std;

int main()
{
    vector<unsigned char> bytes;
    ifstream file1("main1.cpp", ios_base::in | ios_base::binary);
    unsigned char ch = file1.get();
    while (file1.good())
    {
        bytes.push_back(ch);
        ch = file1.get();
    }
    size_t size = bytes.size();
    return 0;
} 
```

# xml - 使用 SVG 创建单独的图像文件

> ID：604440
> 
> 赞同：1
> 
> 时间：2009-03-02T23:06:56.927
> 
> 标签：xml, xslt, svg

我之前处理过 XSLT 以输出应该在浏览器中查看的单个 HTML 文件。

现在我希望如果有人可以概述是否可以使用 XML 数据和 XSLT 来神奇地自动创建单独的图像文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T23:08:51.523

如果您的 XSLT 处理器支持 EXSLT，则[exsl:document](http://exslt.org/exsl/elements/document/index.html)元素将允许您从单个输入文件创建多个输出文件。

AFAIK，目前只有基于[libxslt](http://xmlsoft.org/XSLT/)的处理器支持这个标签，但这包括[PHP 5](http://us.php.net/manual/en/book.xsl.php)，当然还有 xsltproc。

**编辑：**

正如您所发现的，XSLT 2.0 提供了类似的[xsl:result-document](http://www.w3.org/TR/xslt20/#element-result-document)标记。我知道的 XSLT 2.0 处理器是[Saxon](http://saxon.sourceforge.net/)、[Altova XML](http://www.altova.com/altovaxml.html)和[Gexslt/Gestalt](http://www.gobosoft.com/eiffel/gobo/gexslt/)。

# perl - 如何在 Perl 中解析 JSON 日期格式？

> ID：604442
> 
> 赞同：3
> 
> 时间：2009-03-02T23:08:03.507
> 
> 标签：perl, json

如何解析我的 Web 服务在 Perl 中以 JSON 格式接收的日期格式？我想将其转换为 DateTime 对象：

```
Date(1216647000000-0400) 
```

我假设它是自纪元以来的毫秒数以及时区偏移量，但日期已经过时了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T23:24:20.533

自纪元以来的时间以毫秒为单位列出。除以 1000 得到纪元秒。

确保这适用于您遇到的其他情况：

```
use DateTime;

my $json_date = 'Date(1216647000000-0400)';
if ($json_date =~ m{ \b (\d+) \b ([+-]\d\d\d\d\b)? }x ) {
    my ( $epoch_milliseconds, $time_zone ) = ( $1, $2 );
    my $dt = DateTime->from_epoch( epoch => $epoch_milliseconds / 1000 );
    if ($time_zone) {
        $dt->set_time_zone($time_zone);
    }
    print $dt->datetime;
} 
```

# javascript - jQuery 幻灯片切换不工作 - 已解决

> ID：604444
> 
> 赞同：3
> 
> 时间：2009-03-02T23:08:32.477
> 
> 标签：javascript, jquery

在第一次单击时，它按预期工作：

1.  班级变了
2.  并且 html 内容从“显示...”更改为“关闭...”
3.  内容区域通过slideDown效果展开，

目前很好。

在第二次点击时，...

1.  班级变化
2.  html 内容从“关闭...”更改为“显示...”
3.  内容区域不会像预期的那样消失。

第三次点击，...

1.  班级变了
2.  html内容已更改
3.  已经显示的内容以滑下效果重新显示。

因此，除了应该再次隐藏内容的第二次单击之外，一切正常。

这是jQuery：

-

```
$('.open_user_urls').live('click', function() {
    $('#user_urls').slideDown('slow');
    $(this).addClass('close_user_urls');
    $(this).removeClass('open_user_urls');
    $(this).html('Close Search History');
    return false;
});

$('.close_user_urls').live('click', function() {
    $('#user_urls').slideUp('slow');
    $(this).addClass('open_user_urls');
    $(this).removeClass('close_user_urls');
    $(this).html('Show Search History');
    return false;
}); 
```

这是它所作用的 HTML：

```
<h3 class='open_user_urls'>Show Search History</h3>
<div id='user_urls'>
// an OL tag with content
</div> 
```

唯一适用的 CSS：

```
#user_urls { display: none; } 
```

编辑 - 我用下面答案中提供的功能等效代码替换了我的 jquery 代码，但问题仍然存在。所以原因一定在别处。我确实记得这段代码最初是有效的，但后来它停止了。我难住了。是时候把所有的东西一块一块地剥掉了……

编辑 2 - 由于错误必须在其他地方，我接受我的 jquery 的代码改进作为答案。谢谢。

编辑 3 - 找到问题的根源。

在#user_urls div 中，我有一系列具有以下css 的OL：

```
.url_list {float: left; width: 285px; list-style-position: outside; margin-left: 25px;} 
```

每个 OL 都包含 20 个 url 的列表，旨在显示在显示所有 URL 所需的多个列中。

删除浮动：左；在这些 OL 标签上会导致问题消失。

因此，在显示和隐藏的 DIV 中包含的内容上浮动会导致它根本不隐藏。为什么会发生这种情况？

编辑 4：在 #user_urls DIV 中添加一个允许隐藏操作正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T23:18:43.403

也许这样的事情会更简单？

```
$(".open_user_urls").toggle(
    function () {
        $(this).text("Close Search History").siblings(".user_urls").slideDown("slow");
    },
    function () {
        $(this).text("Show Search History").siblings(".user_urls").slideUp("slow");
    }
); 
```

切换功能专为您遇到的场景而设计。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T23:49:53.203

重申问题和解决这个问题......

里面`#user_urls` `DIV`有一系列`OL`标签，每个标签都向左浮动。是浮动导致了问题。

`<br style='clear: left;' />`在里面添加一个`#user_urls` `DIV`解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T23:23:23.673

根据我的发现，jQuery 需要设置高度样式才能正确滑动它。我使用的一种解决方法是在滑动关闭之前设置高度。

```
$('#user_urls').css('height', $('#user_urls').height() + 'px'); 
```

设置一次后，它应该从那时起正常工作。查看[本教程](http://www.switchonthecode.com/tutorials/jquery-tutorial-dynamic-sliding-panels)以获得更详细的说明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-09T10:20:49.610

自从这个问题被打开以来，jQuery 已经自己解决了这个问题。

更新到[最新版本的 jQuery](http://docs.jquery.com/Downloading_jQuery#Current_Release)为我们解决了这个问题，没有 CSS 更改。（截至 2010 年 12 月 9 日的 jQuery 1.4.4）

[通过在Google Groups](http://groups.google.com/group/jquery-dev/browse%5Fthread/thread/ec9eae4fe143dacb/947059b9f047c3a4?lnk=raot&pli=1)上的讨论又从[d12 的答案](https://stackoverflow.com/questions/604444/jquery-slide-toggle-not-working-resolved/1066884#1066884)中找到。根据讨论，在某些 jQuery 1.3x 版本中，如果被隐藏/向上滑动的元素是包含浮动子项的非浮动父项，则此错误会影响几个动作，slideUp、fadeOut 和切换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T23:29:39.367

我认为康纳的回答可能会让你走上正轨。我可能还会建议 slideToggle 和 toggleClass：

[http://docs.jquery.com/Attributes/toggleClass](http://docs.jquery.com/Attributes/toggleClass)

[http://docs.jquery.com/Effects/slideToggle](http://docs.jquery.com/Effects/slideToggle)

我可以很简单：

```
$("h3.open_user_urls").click(function () { 
      next("div#user_urls").slideToggle(); 
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T23:32:38.970

我不能复制你的错误。我使用了您的确切代码，无法复制您的问题。

这一定是来自 JS 代码中不同位置的脚本错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-01T01:23:16.090

谢谢这个问题。它真的让我在解决切换带有浮动子元素的元素的问题上。

可以 [在此 Google 小组讨论中找到另一个真正帮助并解释该行为的资源。](http://groups.google.com/group/jquery-dev/browse_thread/thread/ec9eae4fe143dacb/947059b9f047c3a4?lnk=raot&pli=1)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-19T04:50:24.480

在您的 div 中放置一个非中断空间是另一种解决方案，类似于 The Reddest 在类似问题上对我有用的建议。

# java - 强制 FileNotFoundException

> ID：604449
> 
> 赞同：1
> 
> 时间：2009-03-02T23:10:55.807
> 
> 标签：java, junit, testing, ioexception, filenotfoundexception

我正在为一段代码编写一个测试，其中包含我试图覆盖的 IOException 捕获。try/catch 看起来像这样：

```
try {
    oos = new ObjectOutputStream(new FileOutputStream(cacheFileName));
} catch (IOException e) {
    LOGGER.error("Bad news!", e);
} finally { 
```

最简单的方法似乎是让 FileOutputStream 抛出 FileNotFoundException，但也许我做错了。

有没有人有任何提示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T23:13:12.323

您可以设置`cacheFileName`为无效名称或您知道不存在的名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T23:37:04.403

从您的评论中：

> 是的，我想问题应该是“如何创建一个在 Linux 和 Windows 上都不存在的文件？” 在 Windows 上，我可以使用 'new File("X:/")'，其中 X: 是一个不存在的驱动器号。在 Linux 上，这不起作用，因为这是一个有效的文件名。

查看 java.io.File.createTempFile。使用它来创建文件，然后将其删除。

可能通过它是这样的：

```
File tempFile;

tempFile = createTempFile(getClass().getName(), 
                          Long.toString(System.currentTimeMillis());
tempFile.delete(); 
```

这应该以平台缩进方式为您提供一个唯一的名称，您可以安全地使用它而无需（非常）担心它存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T01:51:53.487

任何测试都有两个部分：让它发生和衡量你得到了正确的结果。

## 故障注入

最简单的答案是已经提到的那个，即设置`cacheFileName`为一个永远不会存在的文件。在这种情况下，这可能是最实际的答案。

但是，要导致诸如 的任意条件`IOException`，您真正想要的是[故障注入](http://en.wikipedia.org/wiki/Fault_injection)。这会强制您的代码出现错误，而不会强制您检测源代码。这里有一些方法可以做到这一点：

*   **模拟对象**您可以使用工厂方法来创建覆盖的`ObjectOutputStream`或`FileOutputStream`. 在测试代​​码中，实现会`IOException`在您想要的时候抛出，而在生产代码中不会修改正常行为。
*   **依赖注入**为了将您的 Mock 对象放在正确的位置，您可以使用[Spring](http://www.springsource.org/)或[Seam](http://www.seamframework.org/)等框架将适当的对象“注入”到正在执行工作的类中。您可以看到这些框架甚至对将要注入的对象具有优先级，因此在单元测试期间您可以使用测试对象覆盖生产对象。
*   **[Aspect Oriented Programming](http://en.wikipedia.org/wiki/Aspect-oriented_programming)**你可以使用 AOP 将错误注入到正确的位置，而不是完全改变代码的结构。例如，使用[AspectJ](http://www.eclipse.org/aspectj/) ，您可以定义一个[切入点](http://www.eclipse.org/aspectj/doc/released/progguide/starting-aspectj.html#pointcuts)，您希望从中抛出异常，并让[Advice](http://www.eclipse.org/aspectj/doc/released/progguide/starting-aspectj.html#advice)抛出所需的异常。

Java 上的故障注入还有其他答案；例如，一个名为[AProbe](http://www.ocsystems.com/tech_aprobe.html)的产品很早以前就开创了 C 语言中可以称为 AOP 的东西，他们也有一个 Java 产品。

## 验证

抛出异常是一个好的开始，但您还必须验证您得到了正确的结果。假设您拥有的代码示例是正确的，您想要验证您是否记录了该异常。上面有人提到为您的记录器使用 Mock 对象，这是一个可行的选择。您还可以在此处使用 AOP 来捕获对记录器的调用。

我假设记录器是[log4j](http://logging.apache.org/log4j/1.2/)；为了解决类似的问题，我实现了自己的 log4j appender，它捕获 log4j 输出：我专门只捕获`ERROR`and `FATAL`，在这种情况下，它们很可能是有趣的日志消息。appender`log4j.xml`在测试运行期间被引用并被激活以捕获错误日志输出。这本质上是一个模拟对象，但我不必重组所有得到 log4j 的代码`Logger`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T23:18:10.220

> 我正在为一段代码编写一个测试，其中包含我试图覆盖的 IOException 捕获。

我不完全确定我理解你的目标，但如果你想测试是否抛出异常，你可以告诉测试你希望它抛出异常：

```
@Test(expected=IOException.class) 
```

如果没有抛出异常，您的测试将失败，如果抛出异常（例如，如果`cacheFileName`文件不存在）则成功。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T23:18:49.737

FileNotFoundException 显然会触发捕获。javadoc 说明了将被抛出的情况。

您还应该考虑 ObjectOutputStream 构造函数可能会引发 IOException，因此可能希望在您的测试中涵盖这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T23:20:40.107

两种简单的方法是将 cacheFileName 设置为不存在的文件或将指定的文件设置为只读访问。

-约翰

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T23:23:01.770

由于当前编写的代码，您可以尝试模拟 LOGGER 对象上的 error() 调用，并检查它是否在您期望 IOException 时被调用。

您的测试愿望可能在编写代码时发现了一个根本问题。发生错误，但没有布尔值或标志值（将文件名设置为特殊模式）提供其他代码部分以确定写入文件是否成功。如果它包含在一个函数中，也许你可以返回一个布尔值或设置一个对象级变量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T23:40:16.330

```
cacheFileName = "thisFileShouldNeverExistAndIfItDoesYouAreScrewingUpMyTests"; 
```

当然，您可以采取步骤并跳过箍以编程方式确保文件名永远不会存在，或者您可以使用在 99.99999% 的情况下永远不会存在的字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-03T05:50:14.047

我希望这就是你的意思。

```
if(new File(cachedFile).exists()) {
    oos = new ObjectOutputStream(new FileOutputStream(cacheFileName));
    //do your code here
} else {
    throw new FileNotFoundException("File doesn't exist!");
} 
```

# .net - 如何用 CAS 拒绝 Assert？

> ID：604450
> 
> 赞同：4
> 
> 时间：2009-03-02T23:11:56.010
> 
> 标签：.net, cas, permissions

在这段代码中，我希望禁止 ReadFileSystem 方法在文件系统上声明权限。

我预计这会抛出 fileIo.Assert()，但事实并非如此。为什么？

```
using System.Security.Permissions;
static void Main(string[] args)
{
    var fileIo = new FileIOPermission(PermissionState.Unrestricted);
    var secuPerm = new SecurityPermission(SecurityPermissionFlag.Assertion);
    PermissionSet set = new PermissionSet(PermissionState.Unrestricted);
    set.AddPermission(fileIo);
    set.AddPermission(secuPerm);
    set.Deny();
    ReadFileSystem();
    Console.Read();
}

private static void ReadFileSystem()
{
    var fileIo = newFileIOPermission(PermissionState.Unrestricted);
    fileIo.Assert();

    DirectoryInfo dir = new DirectoryInfo("C:/");
    dir.GetDirectories();
} 
```

***更新***

CAS 上的精彩链接：http: [//blogs.msdn.com/shawnfa/archive/2004/08/25/220458.aspx](http://blogs.msdn.com/shawnfa/archive/2004/08/25/220458.aspx)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-08T01:33:49.807

随后的 Assert 否定了 Deny 的效果。

断言 FileIOPermission 的能力主要取决于您的程序集是否受信任。它不受先前拒绝 FileIOPermission 的影响。事实证明，它也不受前面的 Deny of the Assertion SecurityPermission 的影响。**这是因为 SecurityPermissionFlag.Assertion 被检查为链接时间需求。**这没有明确记录；我在[这里](http://www.grimes.demon.co.uk/workshops/secWSSix.htm#link_demands)找到了。

要强制 CLR 不信任您的程序集的 FileIOPermission，您可以在 using 语句之后在文件顶部使用以下内容。当您将此添加到文件中时，断言将不会生效。这会影响整个装配。没有更精细的粒度。

```
[assembly:FileIOPermission(SecurityAction.RequestRefuse, Unrestricted=true)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-08T10:15:59.163

我想你可能误解了 Asserting permissions 的目的。当您在 CAS 中声明权限集时，您实际上是在说“我知道我在做什么......我不在乎权限在堆栈中的深度是什么”。这几乎*不是*你想要的。您通常希望请求权限集。这会导致堆栈遍历，它会在堆栈上找到拒绝，然后导致安全异常。

但是，由于 .NET 几乎内置了所有必需的 Demand，因此几乎不需要实际 Demand 任何东西，除非您正在执行 Asserts（同样，这种情况很少见）或者您已经编写了自己的自定义 Permission 类。

# python - 使用快速傅里叶变换分析音频

> ID：604453
> 
> 赞同：110
> 
> 时间：2009-03-02T23:13:17.377
> 
> 标签：python, audio, signal-processing, fft, spectrum

我正在尝试在 python 中创建一个图形频谱分析仪。

我目前正在读取 16 位双通道 44​​,100 Hz 采样率音频流的 1024 字节，并将 2 个通道的幅度平均在一起。所以现在我有一系列 256 条签名短裤。我现在想在该阵列上执行 fft，使用像 numpy 这样的模块，并使用结果创建图形频谱分析仪，开始时只有 32 个柱。

我已经阅读了关于快速傅里叶变换和离散傅里叶变换的维基百科文章，但我仍然不清楚结果数组代表什么。这是我使用 numpy 在我的数组上执行 fft 后数组的样子：

```
 [ -3.37260500e+05 +0.00000000e+00j   7.11787022e+05 +1.70667403e+04j
   4.10040193e+05 +3.28653370e+05j   9.90933073e+04 +1.60555003e+05j
   2.28787050e+05 +3.24141951e+05j   2.09781047e+04 +2.31063376e+05j
  -2.15941453e+05 +1.63773851e+05j  -7.07833051e+04 +1.52467334e+05j
  -1.37440802e+05 +6.28107674e+04j  -7.07536614e+03 +5.55634993e+03j
  -4.31009964e+04 -1.74891657e+05j   1.39384348e+05 +1.95956947e+04j
   1.73613033e+05 +1.16883207e+05j   1.15610357e+05 -2.62619884e+04j
  -2.05469722e+05 +1.71343186e+05j  -1.56779748e+04 +1.51258101e+05j
  -2.08639913e+05 +6.07372799e+04j  -2.90623668e+05 -2.79550838e+05j
  -1.68112214e+05 +4.47877871e+04j  -1.21289916e+03 +1.18397979e+05j
  -1.55779104e+05 +5.06852464e+04j   1.95309737e+05 +1.93876325e+04j
  -2.80400414e+05 +6.90079265e+04j   1.25892113e+04 -1.39293422e+05j
   3.10709174e+04 -1.35248953e+05j   1.31003438e+05 +1.90799303e+05j... 
```

我想知道这些数字究竟代表什么，以及如何将这些数字转换为 32 个条形中每个条形的高度百分比。另外，我应该将两个通道平均在一起吗？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-03-03T01:19:43.423

您显示的数组是音频信号的傅立叶变换系数。这些系数可用于获取音频的频率内容。FFT 是为复值输入函数定义的，因此即使您的输入都是实数值，您得到的系数也将是虚数。为了获得每个频率的功率量，您需要计算每个频率的 FFT 系数的大小。这**不仅仅是**系数的实部，您需要计算其实部和虚部的平方和的平方根。也就是说，如果你的系数是 a + b*j，那么它的大小是 sqrt(a^2 + b^2)。

一旦你计算了每个 FFT 系数的大小，你需要弄清楚每个 FFT 系数属于哪个音频频率。N 点 FFT 将为您提供从 0 开始的 N 个等距频率处的信号频率内容。因为您的采样频率为 44100 个样本/秒。FFT 中的点数为 256，频率间隔为 44100 / 256 = 172 Hz（大约）

数组中的第一个系数将是 0 频率系数。这基本上是所有频率的平均功率水平。其余系数将从 0 以 172 Hz 的倍数递增，直到达到 128。在 FFT 中，您只能测量最多一半采样点的频率。如果您喜欢惩罚并且需要知道原因，请阅读有关[Nyquist 频率](http://mathworld.wolfram.com/NyquistFrequency.html "MathWorld：奈奎斯特频率")和[Nyquist-Shannon 采样定理](http://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem "维基百科：奈奎斯特-香农采样定理")的这些链接，但基本结果是您的较低频率将在较高频率桶中被复制或[混叠。](http://en.wikipedia.org/wiki/Aliasing "维基百科：别名")所以频率将从 0 开始，每个系数增加 172 Hz，直到 N/2 系数，然后减少 172 Hz，直到 N - 1 系数。

这应该是足够的信息让你开始。如果您想要比维基百科更容易理解的 FFT 介绍，您可以尝试[了解数字信号处理：第 2 版。](https://rads.stackoverflow.com/amzn/click/com/0131089897 "亚马逊：了解数字信号处理：第 2 版。"). 这对我很有帮助。

这就是这些数字所代表的。可以通过将每个频率分量幅度按所有分量幅度之和缩放来转换为高度百分比。虽然，这只会为您提供相对频率分布的表示，而不是每个频率的实际功率。您可以尝试按频率分量可能的最大幅度进行缩放，但我不确定这会显示得很好。找到可行比例因子的最快方法是对响亮和柔和的音频信号进行试验以找到正确的设置。

最后，如果您想将整个音频信号的频率内容显示为一个整体，您应该将两个通道一起平均。您正在将立体声音频混合成单声道音频并显示组合频率。如果您想要两个单独的左右频率显示，那么您需要分别在每个通道上执行傅里叶变换。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-05-05T13:01:10.990

虽然这个线程已有多年历史，但我发现它非常有帮助。我只是想把我的意见提供给任何发现这个并试图创造类似东西的人。

至于分成条形，这不应该像 antti 建议的那样，通过根据条形数平均划分数据来完成。最有用的是将数据分成倍频程部分，每个倍频程的频率是前一个倍频程的两倍。（即100hz是50hz以上的一个八度音程，即25hz以上的一个八度音程）。

根据您想要的小节数，您将整个范围划分为 1/X 倍频程范围。根据条形图 A 的给定中心频率，您可以从以下获得条形图的上限和下限：

```
upper limit = A * 2 ^ ( 1 / 2X )
lower limit = A / 2 ^ ( 1 / 2X ) 
```

要计算下一个相邻的中心频率，您可以使用类似的计算：

```
next lower =  A / 2 ^ ( 1 / X )
next higher = A * 2 ^ ( 1 / X ) 
```

然后，您对适合这些范围的数据进行平均，以获得每个条的幅度。

例如：我们想分成 1/3 个八度音程，我们从 1khz 的中心频率开始。

```
Upper limit = 1000 * 2 ^ ( 1 / ( 2 * 3 ) ) = 1122.5
Lower limit = 1000 / 2 ^ ( 1 / ( 2 * 3 ) ) =  890.9 
```

给定 44100hz 和 1024 个样本（每个数据点之间为 43hz），我们应该平均出 21 到 26 的值。（890.9 / 43 = 20.72 ~ 21 和 1122.5 / 43 = 26.10 ~ 26）

（1/3 个八度小节可以让你在 ~40hz 和 ~20khz 之间获得大约 30 个小节）。正如您现在所知道的那样，随着我们走得更高，我们将平均更大范围的数字。低条通常仅包含 1 个或少量数据点。而较高的条形可以是数百个点的平均值。原因是 86hz 比 43hz 高一个八度……而 10086hz 听起来几乎与 10043hz 相同。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-02T23:29:37.713

您所拥有的是一个样本，其时间长度为 256/44100 = 0.00580499 秒。这意味着您的频率分辨率为 1 / 0.00580499 = 172 Hz。从 Python 中得到的 256 个值基本上对应于频率，从 86 Hz 到 255*172+86 Hz = 43946 Hz。你得到的数字是复数（因此每隔一个数字末尾有一个“j”）。

已编辑：修复错误信息

^(您需要通过计算 sqrt(i 2) + j ² )将复数转换为幅度，其中 i 和 j 分别是实部和虚部。

如果你想要 32 根柱线，据我所知，你应该取四个连续振幅的平均值，得到 256 / 4 = 32 根柱线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-05T19:02:01.157

FFT 返回 N 个复数值，您可以计算`module=sqrt(real_part^2+imaginary_part^2)`. 要获得每个频段的值，您必须对频段内所有谐波的模块求和。您可以在下面看到一个关于 10 条频谱分析仪的示例。必须包装 c 代码才能获得 pyd python 模块。

```
float *samples_vett;
float *out_filters_vett;
int Nsamples;
float band_power = 0.0;
float harmonic_amplitude=0.0;
int i, out_index;

out_index=0;

for (i = 0; i < Nsamples / 2 + 1; i++)       
        {
            if (i == 1 || i == 2 || i == 4 || i == 8 || i == 17 || i == 33 || i == 66 || i == 132 || i == 264 || i == 511)
            {
                out_filters_vett[out_index] = band_power; 
                band_power = 0; 
                out_index++;  
            }

            harmonic_amplitude = sqrt(pow(ttfr_out_vett[i].r, 2) + pow(ttfr_out_vett[i].i, 2));
            band_power += harmonic_amplitude;

        } 
```

我用 Python 设计并制作了一个完整的 10 LED 条形频谱分析仪。取而代之的是使用 nunmpy 库（太大且无法仅获取 FFT），而是创建了一个 python pyd 模块（仅 27KB）来获取 FFT 并将整个音频频谱拆分为频段。

此外，为了读取输出音频，创建了一个环回 WASapi portaudio pyd 模块。[您可以在图像10BarsSpectrumAnalyzerWithWASapi.jpg](https://i.stack.imgur.com/0jrkf.jpg)中看到项目（框图）

刚刚在我的 YouTube 频道上添加了一个教程视频：[如何设计和制作一个非常智能的 Python Spectrum Analyzer 10 Led Bar](https://www.youtube.com/watch?v=4Otqdwql63c)

# wcf - 使用 WCF 支持“application/x-www-form-urlencoded”发布数据的最佳方式？

> ID：604463
> 
> 赞同：8
> 
> 时间：2009-03-02T23:17:50.643
> 
> 标签：wcf, web-services, http, rest, post

我正在构建一个基于 W3C 规范的 WCF 服务，该规范定义了一个接受“application/x-www-form-urlencoded”发布数据的 RESTful Web 服务端点。默认情况下，WCF 不支持这种类型的消息编码，我发现了许多不同的创建合同的示例，如下所示：

```
XElement Query_Post(Stream postData); 
```

然后在实现中使用该方法解码`postData`流。`HttpUtility.ParseQueryString`

有谁知道在 WCF 中支持“application/x-www-form-urlencoded”的更强烈类型的方式？

我希望我的运营合同是：

```
XElement Query_Post(string query, string [] params); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T07:48:43.777

最好的方法是`Stream`像使用 WCF或你所说的那样使用[Raw HTTP POST 。](http://blogs.southworks.net/erossetto/2007/09/03/raw-http-post-with-wcf/)原因是 WCF 从服务代码中抽象出所有通信级别的物理布局内容。理想情况下，您可能希望通过拨动开关来创建可以转换为 SOAP 或 REST 的服务。

要原生支持它，您可能必须扩展`WebHttpBinding`或制作自己的绑定并实现[自定义编码器](http://msdn.microsoft.com/en-us/library/ms751486.aspx)。正如链接的帖子所说，这与输出对称。你必须扭动它的手臂才能让 WCF 输出非 XML/JSON 的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T03:57:56.903

WCF REST Contrib 库启用此功能：

[https://github.com/mikeobrien/WcfRestContrib](https://github.com/mikeobrien/WcfRestContrib)

它包括一个 POX 格式化程序和表单 url 编码格式化程序，并允许您轻松创建自己的格式化程序。格式化程序映射到 mime 类型，并根据内容类型自动选择序列化/反序列化实体主体并接受标头。

# java - 如何避免 Java 正则表达式匹配中的隐式“^”和“$”？

> ID：604464
> 
> 赞同：4
> 
> 时间：2009-03-02T23:18:07.163
> 
> 标签：java, regex

我一直在努力在 Java 1.4.2 中进行一些相对简单的正则表达式匹配。我对 Perl 的做事方式更满意。这是发生了什么：

我正在尝试从“<foo><bar>”匹配 /^<foo>/

我尝试：

```
Pattern myPattern= Pattern.compile("^<foo>");
Matcher myMatcher= myPattern.matcher("<foo><bar>");
System.out.println(myMatcher.matches()); 
```

我得到“假”

我习惯说：

```
print "<foo><bar>" =~ /^<foo>/; 
```

确实返回true。

经过大量搜索和实验，我发现了[这个](http://book.javanb.com/java-regular-expressions-taming-the-java-util-regex-engine/LiB0055.html)说：

“String 方法通过在模式前放置一个不可见的 ^ 并在其后放置一个 $ 来进一步优化其搜索条件。”

当我尝试时：

```
Pattern myPattern= Pattern.compile("^<foo>.*");
Matcher myMatcher= myPattern.matcher("<foo><bar>");
System.out.println(myMatcher.matches()); 
```

然后它返回预期的真。我不想要那种模式。终止 .* 应该不是必需的。

然后我发现了 Matcher.useAnchoringBounds(boolean) 方法。我认为明确告诉它不要使用锚定边界会起作用。它没有。我试着发出一个

```
myMatcher.reset(); 
```

以防我在关闭属性后需要刷新它。没运气。随后调用 .matches() 仍然返回 false。

我忽略了什么？

编辑：嗯，这很容易，谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-02T23:28:06.577

使用 Matcher[查找](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#find())方法（而不是[匹配](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#matches())方法）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T23:34:42.973

[`Matcher.useAnchoringBounds()`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#useAnchoringBounds(boolean))是在 JDK1.5 中添加的，所以如果您使用的是 1.4，我不确定它是否会帮助您，即使它确实有效（请注意`@since 1.5`Javadocs 中的）。

Javadocs`Matcher`还声明[该`match()`方法](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#matches())：

> 尝试将**整个**区域与模式匹配。

（强调我的）

这就解释了为什么只有`.matches() == true`在将模式更改为以 . 结尾时才会得到`.*`。

要匹配从头开始的区域，但不一定要求匹配整个区域，请使用[`find()`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#find())or[`lookingAt()`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#lookingAt())方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T23:35:33.533

如果您检查“匹配”，您希望找到输入字符串的哪一部分？

换句话说，

```
Matcher myMatcher= myPattern.matcher("<foo><bar>");
if (myMatcher.matches()) {
  System.out.println(myMatcher.group(0));
} 
```

……应该打印什么？

如果您希望它只打印“ `<foo>`”，请使用`find()`方法 on`Matcher`而不是`matches()`. 如果您真的想在输入以“ ”*开头*`<foo>`时找到匹配项，那么您需要使用`'^'`.

如果您希望它匹配“ `<foo><bar>`”，则需要包含尾随“ `.*`”。

# c# - 从 C# 获取非托管 C++ 函数

> ID：604470
> 
> 赞同：4
> 
> 时间：2009-03-02T23:20:56.597
> 
> 标签：c#, c++, unmanaged, managed

我有一些权威的 ANSI 标准 C 代码。这意味着虽然我有源代码，但我不能翻译成另一种语言，也不能修改调用参数，因为这些操作会使权限失效。有超过 150 种功能。

我可以进行附带更改，例如将文件名从 .C 更改为 .CPP，以便使用 Visual Studio 2009 的 C++ 编译器进行编译，我已经这样做了。也可以添加编译器指令等。如有必要，我还可以通过包装层。

另一个限制是我的公司不**希望**我在任何 C# 代码中使用**不安全**的关键字。

**我需要从 C# 程序中获取这些功能。**

典型的 C/C++ 函数如下所示：
`double SomeFunction(double a, double[3] vec, double[3][3] mat);`
数组内容有时输入，有时输出，很少同时输入。

我首先尝试制作一个非托管 DLL（带有标记为 Extern C 的函数）。只有简单参数（int、double）的函数运行良好，但我无法确定如何编组数组。（其实我确实找到了一些示例代码，但是复制150次是极其复杂和不合理的。）

然后我在同一个解决方案中尝试了两个项目，一个在 C++ 中，另一个在 C# 中。在 C++ 项目中，我创建了一个托管函数，它只调用了标记为非托管的原始函数。这是非常干净和简单的，同样，简单的参数也很好用。但是对于数组，我找不到如何使参数类型在 C# 到 C++ 边界上匹配：（
`*Argument '2': cannot convert from 'double[]' to 'double*'*`
如上所述，我不能使用 unsafe 来获取指针）。

当然，我正在尝试做的事情必须是可能的。
获得这些功能的最佳方法是什么？
（使用上述函数的示例代码真的很酷。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T02:49:58.620

示例 C/C++ 实现：

```
extern "C" __declspec(dllexport)
double SomeFunction(double a, double vec[3], double mat[3][3]) {
  double sum = a;
  for (int ix = 0; ix < 3; ++ix) {
    sum += vec[ix];
    for (int iy = 0; iy < 3; ++iy) {
      sum += mat[ix][iy];
    }
  }
  return sum;
} 
```

示例 C# 用法：

```
private void Form1_Load(object sender, EventArgs e) {
  double[] vec = new double[3];
  double[,] mat = new double[3, 3];
  for (int ix = 0; ix < 3; ++ix) {
    vec[ix] = ix;
    for (int iy = 0; iy < 3; ++iy) {
      mat[ix, iy] = (ix + 1) * iy;
    }
  }
  double sum = SomeFunction(1, vec, mat);
}
[System.Runtime.InteropServices.DllImport("cpptemp8.dll")]
private static extern double SomeFunction(double a, double[] vec, double[,] mat); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T23:24:13.593

如果您无法使 extern 和 P/Invoke 解决方案正常工作，那么包装器可能是您最好的选择。创建一个同时使用托管和非托管代码的托管 C++ DLL。向这个 DLL 添加一个 .NET 类，它只是 C DLL 中函数的一个薄包装器。您的 C# 代码可以调用 C++ .NET 类，该类将依次转发 C 函数。

这样，您可以自己编写 .NET 和非托管代码之间的转换，而不是依赖运行时为您完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T17:21:02.917

使用 swig，它会为你生成你的 pinvoke

# c# - 可以使用相同的接口定义但提供不同的行为吗？

> ID：604471
> 
> 赞同：0
> 
> 时间：2009-03-02T23:21:32.443
> 
> 标签：c#, oop

我的问题的总结是“我有 2 个类共享一个公共接口，但是这两个类在属性方面有不同的行为。如果参数值无效，一个接口会引发异常，另一个会更新其内部状态以处理无效值。这两个类可以共享同一个接口，还是应该定义两个接口以向开发人员表明两者具有不同的行为？

我会尝试用一些代码来澄清。我在下面定义了接口。

```
公共接口 IStationDictionary
{
    bool this[string stationId] { get; 放; }
}

```

还有一个实现接口的类，这个类用来设置数字IO板上的输出端口。

```
公共类 DigitalStationAdapter : IStationDictionary
{
    public bool this[string stationId]
    {
        获取{返回端口[stationId].Value; }
        设置 { 端口 [stationId].Value = 值；}
    }

    公共无效 AddDigitalStation（字符串 stationId，DigitalIoPort 端口）
    {
        ports.Add(stationId, 端口);
    }

    私有 IDictionary<string, DigitalIoPort> 端口 = new Dictionary<string, DigitalIoPort>();
}

```

我还有一个类可以记录哪些站点的值发生了更改，以便可以将这些更改传播到数字 IO。

```
公共类 StationTransitions : IStationDictionary
{
    public bool this[string stationId]
    {
        得到
        {
            布尔结果=假；

            如果（更改。包含密钥（stationId））
                结果=更改[stationId]；

            返回结果；
        }
        放
        {
            if(!changes.ContainsKey(stationId))
                更改。添加（stationId，值）；
            别的
                更改[stationId] = 值；
        }
    }

    公共 IDictionary GetChanges()
    {
        IDictionary<string, bool> 结果 = 变化；

        更改 = 新字典<string, bool>

        返回结果；
    }

    private IDictionary<string, bool> changes = new Dictionary<string, bool>();
}

```

因此，虽然两个类都实现了相同的接口，但如果您尝试使用不在字典中的 stationId 访问索引器，DigitalStationAdapter 将抛出 KeyNotFoundException。而 StationTransitions 将成功，即不同的行为。可以吗，我认为接口用于定义行为和结构？

基思。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T23:31:09.333

这可以。这样想：判断任何继承关系是否“ok”的关键是里氏[替换原则。](http://en.wikipedia.org/wiki/Liskov_Substitution_Principle) 这要求期望基类的代码应该能够在不知道派生类的情况下使用它。这意味着方法的先决条件不能在派生类中得到加强，但可以被削弱。接口只是基类的一个特例。

在您的情况下，接口的隐式前提条件是输入在您定义时是有效的。所有期望基类的代码都应该假设这个前提条件并避免传递无效数据或准备处理异常。在更新其内部状态以处理无效输入的具体类中，您正在削弱先决条件。就 Liskov 替代原则而言，这是可以接受的。

另一方面，如果您要创建一个自动处理无效输入的类而不抛出一个基类，并创建一个抛出后代的类，这将是不好的，因为期望基类的代码不能使用派生类就好像它是基类一样。它必须知道派生类才能处理可能的异常。

# c# - 在 MVC 应用程序中放置默认内容的最佳位置是什么？

> ID：604473
> 
> 赞同：0
> 
> 时间：2009-03-02T23:21:47.857
> 
> 标签：c#, asp.net-mvc, model-view-controller

我正在开发一种 CMS/Wiki 应用程序来帮助我试验新的 Asp.Net MVC 框架，并且我正在尝试围绕一些代码组织进行思考。

现在，我有三个视图来显示一篇文章：索引、编辑和重命名。所有三个视图都显示当前页面的内容，或说明该页面不存在的占位符内容。

目前这是通过每个视图的操作方法中的以下代码来完成的：

```
MyPage myPage = null;

if (!string.IsNullOrEmpty(pageName)) {
    myPage = mRepository.GetMyPage(pageName);
}

//Page does not exist.
if (myPage != null) {
    ViewData["pageContent"] = myPage.GetParsedSource(new PageState());
    ViewData["pageSource"] = myPage.Source;
    ViewData["title"] = myPage.Title;
}
else {
    ViewData["title"] = pageName;
    ViewData["pageContent"] = "Page does not exist, feel free to create it!";
    ViewData["pageSource"] = "";
}

ViewData["pageName"] = pageName; 
```

我的问题是，这个逻辑实际上应该去哪里？

1）控制器（就像现在一样），它需要在操作方法之间复制上述代码？
2) 模型，将 pageSource 的默认值设置为上面显示的措辞？这将具有将显示文本移动到模型中的缺点。
3) 视图，使用空合并运算符将空 ViewData 条目转换为其默认值？
4) 在视图中，但添加额外的控制器来处理 pageName 不存在的情况。

* * *

编辑：希望这应该澄清一些事情。应用程序的流程如下：当用户输入一个 URL（即 /pages/page_title）时，他们到达一个显示文章内容的屏幕，以及标记为“编辑”和“重命名”的超链接。

单击编辑会显示一个包含文章内容的页面，以及用于编辑文章来源的表单控件。

单击重命名会显示一个包含文章内容的页面，以及用于编辑文章名称的表单控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T23:27:38.903

我会有几个动作：

*   抬头
*   展示
*   创造
*   编辑
*   改名

在您的默认查找控制器操作中（当用户请求时，例如“/wiki/article-title”，该操作会被命中），您可以`RedirectToAction()`根据需要将 ( ) 重定向到适当的操作。它将您的 Create 逻辑封装到它自己的控制器中，也可以直接调用（RESTful）。和其他人一样。这也可以让你保持你的观点非常非常愚蠢（总是一件好事）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T23:40:25.627

我会将它保存在控制器中，但将其提取出来，这样您就不必在每个操作中复制代码。

也许在控制器的构造函数中设置一些默认值，然后有一个单独的私有方法（即不是操作方法），它获取您的 MyPage 对象并设置您的操作之间共享的视图数据。

# c# - 在枚举队列时插入队列

> ID：604478
> 
> 赞同：0
> 
> 时间：2009-03-02T23:23:11.397
> 
> 标签：c#, data-structures, queue, breadth-first-search

我想使用队列对树进行广度优先搜索

```
var q = new Queue<T>();

q.Enqueue(Root);

foreach(T root in q)
{
  foreach(T t in root.Children)
    q.Enqueue(t);
} 
```

但是我得到一个“枚举器被实例化后集合被修改”。例外。

有没有我可以使用的 C# 类型？

* * *

编辑：一点阅读让我觉得我可能做错了。

有没有办法使用 foreach 从队列中出列？

* * *

这可行但很丑（OMHO）

```
var q = new Queue<T>();

q.Enqueue(Root);

while(q.Count > 0)
{
  T root = q.Dequeue();
  foreach(T t in root.Children)
    q.Enqueue(t);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T23:27:45.457

您不能枚举 IEnumerable 并同时更改相同的 IEnumerable。我认为没有 C# Collection 允许这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T23:36:19.833

*foreach*构造在这里不起作用。

您可以使用提供索引访问的容器来解决该问题。

```
var l = new List<T>();
l.Add(Root);
int i = 0;
while(i < l.Count)
{
    T root = l[i];
    foreach(T t in root.Children)    
    {
        l.Add(t);
    }
    ++i;
}

// And because you really wanted a queue
var q = new Queue<T>(l); 
```

# c# - 在 ASP.NET 中转换/访问 QueryString 值

> ID：604480
> 
> 赞同：21
> 
> 时间：2009-03-02T23:23:41.300
> 
> 标签：c#, .net, asp.net

我很好奇每个人在处理/抽象 ASP.NET 中的 QueryString 时都做了什么。在我们的一些网络应用程序中，我在整个网站上看到了很多这样的内容：

```
int val = 0;
if(Request.QueryString["someKey"] != null)
{
val = Convert.ToInt32(Request.QueryString["someKey"]);
} 
```

有什么更好的方法来处理这种粗暴？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-02T23:39:48.470

我倾向于喜欢将它们抽象为属性的想法。例如：

```
 public int age { 
        get
        {
            if (Request.QueryString["Age"] == null)
                return 0;
            else
                return int.Parse(Request.QueryString["Age"]);                                    
        }
    } 
```

如果您愿意，可以添加更多验证。但我倾向于以这种方式包装我的所有查询字符串变量。

编辑：--- 同样正如另一位海报指出的那样，您必须在每个页面上创建这些属性。我的回答是不，你不。您可以在一个可以称为“QueryStrings”或其他名称的类中创建这些属性。然后您可以在要访问查询字符串的每个页面中实例化此类，然后您可以简单地执行类似的操作

```
var queryStrings = new QueryStrings();
var age = queryStrings.age; 
```

这样，您可以将用于访问和处理每种类型的查询变量的所有逻辑封装在一个可维护的位置。

EDIT2: --- 因为它是类的一个实例，你也可以使用依赖注入在你使用它的每个地方注入 QueryStrings 类。 [StructureMap](http://structuremap.github.io/)在这方面做得很好。这还允许您模拟 QueryStrings 类并在您想要进行自动化单元测试时注入它。模拟它比 ASP.Net 的 Request 对象容易得多。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-02T23:33:42.087

一件事是您没有在这里捕获空白值。您可能有一个类似“ [http://example.com?someKey=&anotherKey=12345](http://example.com?someKey=&anotherKey=12345) ”的网址，在这种情况下，“someKey”参数值为“”（空）。您可以使用 string.IsNullOrEmpty() 检查 null 和空状态。

我还将“someKey”更改为存储在变量中。这样你就不会在多个地方重复文字字符串。它使这更容易维护。

```
int val = 0;
string myKey = "someKey";
if (!string.IsNullOrEmpty(Request.QueryString[myKey]))
{
    val = int.Parse(Request.QueryString[myKey]);
} 
```

我希望这会有所帮助！

伊恩

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T00:17:58.830

编写某种辅助方法（库）来处理它......

```
public static void GetInt(this NameValueCollection nvCol, string key, out int keyValue, int defaultValue)
{
    if (string.IsNullOrEmpty(nvCol[key]) || !int.TryParse(nvCol[key], out keyValue))
        keyValue = defaultValue;
} 
```

或类似的规定...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-25T20:13:51.353

这就是我想出的。它使用泛型从 QueryString 中返回强类型值，如果参数不在 QueryString 中，则返回可选的默认值：

```
/// <summary>
    /// Gets the given querystring parameter as a the specified value <see cref="Type"/>
    /// </summary>
    /// <typeparam name="T">The type to convert the querystring value to</typeparam>
    /// <param name="name">Querystring parameter name</param>
    /// <param name="defaultValue">Default value to return if parameter not found</param>
    /// <returns>The value as the specified <see cref="Type"/>, or the default value if not found</returns>
    public static T GetValueFromQueryString<T>(string name, T defaultValue) where T : struct
    {
        if (String.IsNullOrEmpty(name) || HttpContext.Current == null || HttpContext.Current.Request == null)
            return defaultValue;

        try
        {
            return (T)Convert.ChangeType(HttpContext.Current.Request.QueryString[name], typeof(T));
        }
        catch
        {
            return defaultValue;
        }
    }

    /// <summary>
    /// Gets the given querystring parameter as a the specified value <see cref="Type"/>
    /// </summary>
    /// <typeparam name="T">The type to convert the querystring value to</typeparam>
    /// <param name="name">Querystring parameter name</param>
    /// <returns>The value as the specified <see cref="Type"/>, or the types default value if not found</returns>
    public static T GetValueFromQueryString<T>(string name) where T : struct
    {
        return GetValueFromQueryString(name, default(T));
    } 
```

自从写这篇文章以来，我编写了一个非常小的类库来操作查询字符串值 - 请参阅[https://github.com/DanDiplo/QueryString-Helper](https://github.com/DanDiplo/QueryString-Helper)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T04:10:54.557

我们一直在使用常量将所有这些“松散”的键保存在一个中心位置：

```
public class Constants
{
  public class QueryString
  {
    public const string PostID = "pid";
    public const string PostKey = "key";
  }
  public class Cookie
  {
    public const string UserID = "mydomain.com-userid";
  }
  public class Cache
  {
    public const string PagedPostList = "PagedPostList-{0}-{1}";
  }
  public class Context
  {
    public const string PostID = "PostID";
  }
  public class Security
  {
    public const RoleAdministrator = "Administrator";
  }
} 
```

这样，您可以轻松访问所需的常量：

```
public void Index()
{
  if (Request[Constants.QueryString.PostKey] == "eduncan911")
  {
    // do something
  }
}

public object GetPostsFromCache(int postID, int userID)
{
  String cacheKey = String.Format(
      Constants.Cache.PagedPostList
      , userID
      , postID);
  return Cache[cacheKey] as IList<Post>;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-18T14:44:25.283

据我说，获取查询字符串值的最佳方法如下：
如果找不到查询字符串，则`val`值为`0`.

```
int val = 0;
int.TryParse(Request.QueryString["someKey"], out val); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T07:05:45.433

我和建议帮助方法的海报在一起（我会评论他的，但还不能）。其他人不同意他支持创建属性，但我对此的回答是它不能优雅地处理检查空值或无效格式等问题。如果你有辅助方法，所有这些逻辑都可以编写一次并且集中。

如果您有很多页面，为每个页面添加属性可能会比其价值更耗时。但这显然只是一种偏好，所以对每个人来说都是如此。

您可以改进另一张海报的辅助方法的一件很酷的事情是将 out 参数改为参考参数（将 out 更改为 ref）。这样你就可以为属性设置一个默认值，以防它没有被传递。例如，有时您可能需要可选参数——那么对于那些未显式传递可选参数的情况（比单独传入默认值更容易），您可以让它以一些默认值开头。您甚至可以在末尾添加一个 IsRequired 布尔参数，如果布尔设置为 true 并且未传递参数，则让它抛出异常。这在许多情况下会有所帮助。

# c# - 是否在异步循环中处理数据包？

> ID：604483
> 
> 赞同：0
> 
> 时间：2009-03-02T23:25:22.560
> 
> 标签：c#, networking, asynchronous

在 C# 中，当使用 BeginReceive/EndReceive 方法接收网络数据时，有什么理由不应该在收到数据包后立即处理它们？一些任务可能需要相当多的 CPU 密集型。我问是因为我已经看到一些将数据包推入处理队列然后在那里处理它们的实现。对我来说，这似乎是多余的，因为据我所知，异步方法*也在*线程池上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T00:18:55.427

通常，您需要接收“足够”的数据包才能拥有“可处理”的数据项。

IMO，最好有一个线程来接收数据，而另一个线程来实际处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T09:25:05.347

正如 Mitch 指出的那样，您需要能够接收足够的数据包才能拥有完整的 message/frame 。但是没有理由不立即开始处理该帧并发出另一个 BeginReceive。事实上，如果您认为您的处理可能需要一些时间，您最好将其交给工作线程池，而不是阻止来自 i/o 池的线程（这是您的回调将触发的地方）。

此外，除非您期望连接数量较少，否则生成一个线程来处理每个连接并不是一种非常可扩展的方法，尽管它确实具有一些简单性的好处。

我最近写了一篇关于网络套接字流水线数据处理的文章，你可以在[这里](http://iodyner.spaces.live.com/blog/cns!7B505254340D5E9A!180.entry)找到。

# visual-studio - Visual C++ 中多个项目之间的链接器错误

> ID：604484
> 
> 赞同：11
> 
> 时间：2009-03-02T23:25:28.177
> 
> 标签：visual-studio, visual-c++, projects-and-solutions

我有一个包含多个项目的解决方案。我有一个“主”项目，它充当菜单，用户可以从那里访问任何其他项目。在这个主项目上，我得到每个调用的函数的链接器错误。如何避免这些链接器错误？我已经在“项目依赖项...”对话框中设置了项目依赖项。

谢谢

**编辑——我按照建议做了，并将输出文件夹添加到链接器的附加目录中。但是，现在我收到一百万个错误，如下所示：**

```
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: void __thiscall std::basic_ios >::setstate(int,bool)" (?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: int __thiscall std::ios_base::width(int)" (?width@ios_base@std@@QAEHH@Z) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: int __thiscall std::basic_streambuf >::sputn(char const *,int)" (?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHPBDH@Z) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: static bool __cdecl std::char_traits::eq_int_type(int const &,int const &)" (?eq_int_type@?$char_traits@D@std@@SA_NABH0@Z) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: static int __cdecl std::char_traits::eof(void)" (?eof@?$char_traits@D@std@@SAHXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: int __thiscall std::basic_streambuf >::sputc(char)" (?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: class std::basic_streambuf > * __thiscall std::basic_ios >::rdbuf(void)const " (?rdbuf@?$basic_ios@DU?$char_traits@D@std@@@std@@QBEPAV?$basic_streambuf@DU?$char_traits@D@std@@@2@XZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: char __thiscall std::basic_ios >::fill(void)const " (?fill@?$basic_ios@DU?$char_traits@D@std@@@std@@QBEDXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: int __thiscall std::ios_base::flags(void)const " (?flags@ios_base@std@@QBEHXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: int __thiscall std::ios_base::width(void)const " (?width@ios_base@std@@QBEHXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: static unsigned int __cdecl std::char_traits::length(char const *)" (?length@?$char_traits@D@std@@SAIPBD@Z) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: class std::basic_ostream > & __thiscall std::basic_ostream >::flush(void)" (?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: class std::basic_ostream > * __thiscall std::basic_ios >::tie(void)const " (?tie@?$basic_ios@DU?$char_traits@D@std@@@std@@QBEPAV?$basic_ostream@DU?$char_traits@D@std@@@2@XZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: bool __thiscall std::ios_base::good(void)const " (?good@ios_base@std@@QBE_NXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: void __thiscall std::basic_ostream >::_Osfx(void)" (?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: void __thiscall std::basic_streambuf >::_Lock(void)" (?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: void __thiscall std::basic_streambuf >::_Unlock(void)" (?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEXXZ) already defined in panels.lib(panel_main.obj)
3>msvcprtd.lib(MSVCP90D.dll) : error LNK2005: "public: class std::locale::facet * __thiscall std::locale::facet::_Decref(void)" (?_Decref@facet@locale@std@@QAEPAV123@XZ) already defined in panels.lib(panel_main.obj)
3>libcpmtd.lib(ios.obj) : error LNK2005: "private: static void __cdecl std::ios_base::_Ios_base_dtor(class std::ios_base *)" (?_Ios_base_dtor@ios_base@std@@CAXPAV12@@Z) already defined in msvcprtd.lib(MSVCP90D.dll)
3>libcpmtd.lib(ios.obj) : error LNK2005: "public: static void __cdecl std::ios_base::_Addstd(class std::ios_base *)" (?_Addstd@ios_base@std@@SAXPAV12@@Z) already defined in msvcprtd.lib(MSVCP90D.dll)
3>libcpmtd.lib(locale0.obj) : error LNK2005: "void __cdecl _AtModuleExit(void (__cdecl*)(void))" (?_AtModuleExit@@YAXP6AXXZ@Z) already defined in msvcprtd.lib(locale0_implib.obj)
3>libcpmtd.lib(locale0.obj) : error LNK2005: __Fac_tidy already defined in msvcprtd.lib(locale0_implib.obj)
3>libcpmtd.lib(locale0.obj) : error LNK2005: "private: static void __cdecl std::locale::facet::facet_Register(class std::locale::facet *)" (?facet_Register@facet@locale@std@@CAXPAV123@@Z) already defined in msvcprtd.lib(locale0_implib.obj)
3>libcpmtd.lib(locale0.obj) : error LNK2005: "private: static class std::locale::_Locimp * __cdecl std::locale::_Getgloballocale(void)" (?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ) already defined in msvcprtd.lib(MSVCP90D.dll)
3>libcpmtd.lib(locale0.obj) : error LNK2005: "private: static class std::locale::_Locimp * __cdecl std::locale::_Init(void)" (?_Init@locale@std@@CAPAV_Locimp@12@XZ) already defined in msvcprtd.lib(MSVCP90D.dll)
3>libcpmtd.lib(locale0.obj) : error LNK2005: "public: static void __cdecl std::_Locinfo::_Locinfo_ctor(class std::_Locinfo *,class std::basic_string,class std::allocator > const &)" (?_Locinfo_ctor@_Locinfo@std@@SAXPAV12@ABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@2@@Z) already defined in msvcprtd.lib(MSVCP90D.dll)
3>libcpmtd.lib(locale0.obj) : error LNK2005: "public: static void __cdecl std::_Locinfo::_Locinfo_dtor(class std::_Locinfo *)" (?_Locinfo_dtor@_Locinfo@std@@SAXPAV12@@Z) already defined in msvcprtd.lib(MSVCP90D.dll)
3>libcpmtd.lib(xlock.obj) : error LNK2005: "public: __thiscall std::_Lockit::_Lockit(int)" (??0_Lockit@std@@QAE@H@Z) already defined in msvcprtd.lib(MSVCP90D.dll)
3>libcpmtd.lib(xlock.obj) : error LNK2005: "public: __thiscall std::_Lockit::~_Lockit(void)" (??1_Lockit@std@@QAE@XZ) already defined in msvcprtd.lib(MSVCP90D.dll) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-03T10:32:23.097

如果不了解有关您的解决方案的所有详细信息，很难回答，但我会假设您的“其他”项目已设置为生成一个 .lib 文件，然后主项目链接所有这些 lib 文件。如果是这种情况，那么您遇到错误的一个可能原因是您的项目链接到不同版本的运行时库。

从[Microsoft 的文档](http://msdn.microsoft.com/en-us/library/2kzt1wy3%28v=vs.80%29.aspx)中，“传递给链接器的给定调用的所有模块都必须使用相同的运行时库编译器选项（/MD、/MT、/LD）进行编译。”

尝试更改所有项目以使用相同版本的运行时库。在 Visual Studio 2010 中，这是在项目的属性 | 配置属性 | C/C++ | 代码生成 | 运行时库。选择**多线程调试 DLL**或多**线程调试**（用于您的调试配置）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-02T23:32:28.300

在不了解您的解决方案的任何其他细节的情况下，很难说，但是 Rebuild All 可能会有所帮助。当存在不同架构的混合目标文件时，有时会发生这种情况。

您可能还想考虑使用“引用”而不是“依赖项”

**编辑：**

在您发布之后，您与标准库的链接似乎不一致。会不会是其中一个项目静态链接标准库而其他项目动态链接？（见项目属性->链接器）或者一个到发布运行时，而其他的调试？（虽然最后一个应该是可能的，但需要注意的是）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T23:44:38.847

你其他项目中的功能有导出吗？如果它们没有被导出，那么就没有任何东西可以从主 exe 链接到，所以这会导致错误。有关详细信息，请参阅[使用 __declspec(export) 从 DLL 导出](http://msdn.microsoft.com/en-us/library/a90k134d(VS.80).aspx#)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-01T01:57:22.357

您遇到的错误是“错误 LNK2005”，其中您正在链接的库 (msvcprtd.lib) 中的符号已在另一个库中定义（例如 panel.lib）。如果将 panel.lib 添加到“忽略特定库”字段（在 VS2008 配置属性--> 链接器--> 输入--> 忽略特定库中），错误将停止。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T23:33:36.893

我认为您得到的链接器错误是“未解析的符号”？

如果使用静态库（即 .lib 文件），您需要将库添加到链接器输入，以便在链接时可以链接符号。如果你不这样做，你会得到一个未解析的符号：

1.  右键单击项目，然后选择属性。
2.  选择配置属性->链接器->输入
3.  在 Additional Dependencies 下输入库名称（例如 filename.lib）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-12T12:33:00.717

我有一个与此非常相似的问题，原来是因为我的一个库将选项“将 wchar_t 视为内置类型”设置为与其他库不同的值。默认情况下，此设置在新项目上为 false。将它们全部更改为 true 可以解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-06T10:52:57.683

确切地说，至少您的一个项目是使用不同的“运行时库”编译的，然后是其他项目。也许您使用不同的默认值添加了一个新的。检查您的项目的属性，以确保“配置属性”->“C/C++”->“代码生成”->“运行时库”的值相等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-01T03:35:34.207

就我而言，问题是因为我将函数原型、类定义和函数实现以及类实现保存在单个 cpp 文件中。只有当我将声明和原型转移到单独的头文件时，这些错误才会消失。真的很奇怪！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-09T02:30:55.863

就我而言，我有两种方法：

1.  **项目属性 -> C/C++ -> 代码生成 -> 运行时库。**将其更改为 MT。

2.  将您的缺少库添加到：**链接器-> 输入-> 附加依赖项。**如果它不起作用，请尝试添加完整路径而不是库名称。

例如：C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\lib\amd64\libvcruntime.lib；

这对我有用。为任何需要帮助的人回答这个问题。

# visual-studio-2008 - Team Foundation Server 文件弃用

> ID：604489
> 
> 赞同：1
> 
> 时间：2009-03-02T23:27:09.030
> 
> 标签：visual-studio-2008, tfs, deprecated

我们的环境使用 ODP.Net oracle 数据库驱动程序。所以从逻辑上讲，我们在后端使用 Oracle。

我们的文件包含 TFS 中存储过程的脚本。

我的 oracle 开发人员希望弃用一个文件，以防止其他 oracle 开发人员将来使用它，但当然他也希望将其保留在源代码中，以防他决定以后再使用它。

现在弃用 .Net 类是使用 Obselete 标记的问题，我不会在这种情况下讨论这样做。

这是一个文本文件，我们的数据库开发人员正试图与我们作为一个团队很好地合作，只是想在 TFS 中弃用一个文本文件。

那么 TFS 是否有一些本质上会弃用任何文件的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T23:56:07.837

只需删除它。如果以后需要，您仍然可以在将来检索文件的当前版本。

# c# - 在运行时动态生成 DLL 程序集

> ID：604501
> 
> 赞同：33
> 
> 时间：2009-03-02T23:30:12.173
> 
> 标签：c#, .net, dll, code-generation

目前我有一些动态生成的代码。换句话说，C# .cs 文件是由程序动态创建的，其目的是将这个 C# 文件包含在另一个项目中。

挑战在于我想生成一个 .DLL 文件而不是生成一个 C# .cs 文件，以便它可以被任何类型的 .NET 应用程序（不仅是 C#）引用，因此更有用。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-02T23:34:46.423

```
using System.CodeDom.Compiler;
using System.Diagnostics;
using Microsoft.CSharp;

CSharpCodeProvider codeProvider = new CSharpCodeProvider();
ICodeCompiler icc = codeProvider.CreateCompiler();
System.CodeDom.Compiler.CompilerParameters parameters = new CompilerParameters();
parameters.GenerateExecutable = false;
parameters.OutputAssembly = "AutoGen.dll";
CompilerResults results = icc.CompileAssemblyFromSource(parameters, yourCodeAsString); 
```

改编自[http://support.microsoft.com/kb/304655](http://support.microsoft.com/kb/304655)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-04-16T21:28:01.973

不推荐使用的方法（使用 .NET 4.0，如之前的海报所述）：

```
using System.CodeDom.Compiler;
using System.Reflection;
using System;
public class J
{
    public static void Main()
    {       
        System.CodeDom.Compiler.CompilerParameters parameters = new CompilerParameters();
        parameters.GenerateExecutable = false;
        parameters.OutputAssembly = "AutoGen.dll";

        CompilerResults r = CodeDomProvider.CreateProvider("CSharp").CompileAssemblyFromSource(parameters, "public class B {public static int k=7;}");

        //verify generation
        Console.WriteLine(Assembly.LoadFrom("AutoGen.dll").GetType("B").GetField("k").GetValue(null));
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T23:35:18.417

现在，你最好的选择是[CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)；4.0 的计划包括“编译器即服务”，这将使其完全托管。

# c++ - 在 Windows 上的 C++ 中执行等效的“终止进程树”

> ID：604522
> 
> 赞同：16
> 
> 时间：2009-03-02T23:36:21.847
> 
> 标签：c++, windows, kill

我们有一个 C++ 任务，它将派生一个新进程。该进程又可能有几个子进程。如果任务运行超过了分配的时间，我们将要终止该分叉进程。

但是，我们不想孤立它产生的进程。我们希望他们都死去。我使用了 Process Explorer，它有一个“Kill Process Tree”选项，类似于 Windows 任务管理器的“End Process Tree”，所以我猜测/假设有一个公共 API 可以做到这一点。有没有人这样做，或者知道对公共 API 的引用？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-02T23:39:29.717

您可能需要考虑“Jobs API”。[`CreateJobObject`](https://msdn.microsoft.com/en-us/library/ms682409%28VS.85%29.aspx)和朋友。您可以通过设置适当的属性来强制子进程留在作业中。然后你可以随时打电话`TerminateJobObject`。

澄清：这不是任务管理器所做的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T00:01:37.123

我建议走工作对象路线，如上所述，它将是最可靠的。

如果您无法执行作业对象路径，则可以使用 toolhelp API 获取父进程 ID 并以这种方式构建树。不过要小心，因为 Windows 没有强大的父/子关系，并且 PID 可能会被回收。您可以使用`GetProcessTimes`查询进程的创建时间，并检查它是否比子进程更老。如果树中的中间进程终止，您将无法进一步遍历树。

```
// Error handling removed for brevity
HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
PROCESSENTRY32 process;
ZeroMemory(&process, sizeof(process));
process.dwSize = sizeof(process);
Process32First(snapshot, &process);
do
{
    // process.th32ProcessId is the PID.
    // process.th32ParentProcessID is the parent PID.

} while (Process32Next(snapshot, &process)); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T23:49:32.017

有一个名为[TerminateProcess()](http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx)的 Win32 函数。它应该为您完成这项工作。

或者，我发现 taskkill 命令对这样的事情很有用。

**从命令行：**

```
taskkill /F /T /IM program.exe 
```

**来自代码：**

```
system("taskkill /F /T /IM program.exe"); 
```

**其他开关（直接来自 taskkill /? ）：**

```
TASKKILL [/S系统[/U用户名[/P
 [密码]]]]
          { [/FI 过滤器] [/PID 进程 ID | /IM 图像名] } [/F] [/T]

 描述：
     此命令行工具可用于结束一个或多个进程。
     进程可以通过进程 ID 或图像名称来终止。

 参数列表：
     /S system 指定要连接的远程系统。

     /U [domain\]user 指定用户上下文
                            该命令应该执行。

     /P [password] 指定给定的密码
                            用户上下文。如果省略则提示输入。

     /F 指定强制终止
                            进程。

     /FI filter 显示一组匹配的任务
                            给定过滤器指定的标准。

     /PID 进程 ID 指定进程的 PID
                            必须终止。

     /IM image name 指定进程的镜像名称
                            必须终止。通配符 '*'
                            可用于指定所有图像名称。

     /T Tree kill：终止指定进程
                            以及由它启动的任何子进程。

     /？显示此帮助/用法。
```

-约翰

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T23:53:35.987

你想找到你想杀死的进程的进程ID，然后“走树”它的孩子（和他们的孩子，等等......），记下他们的pid，然后快速杀死所有的进程.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T00:15:06.637

您还可以使用 WMI，路线规划您可以创建一个类来执行任务。
请参阅此[“我在哪里可以找到 WMI 文档？”](https://stackoverflow.com/questions/483501/where-can-i-find-the-wmi-documentation)
和[WMI COM 库](http://www.vsj.co.uk/articles/display.asp?id=439)
和[WMI C++ 应用程序示例](http://msdn.microsoft.com/en-us/library/aa394558(VS.85).aspx)

# android - 是否可以通过 Wifi 或 TMobile 网络强制网络流量？

> ID：604535
> 
> 赞同：8
> 
> 时间：2009-03-02T23:43:29.070
> 
> 标签：android, networking, gsm, wifi

我想知道使用 G1 是否可以强制网络流量通过 Wifi 或通过 Cell GSM 网络。我需要强制应用程序通过塔网络连接以获取一些登录信息。这可能吗？有人对这怎么可能有任何想法吗？我正在尝试在使用 Android SDK 的应用程序中完成此操作（抱歉，我最初对此并不太清楚）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T19:39:34.813

事实证明，可以使用 WifiManager 对象禁用然后重新启用连接。如果您想通过蜂窝网络强制数据，您可以在网络调用期间阻止它。我想那里有一个类似的 GSM 网络管理器，它将为单元连接执行类似的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T00:51:43.337

我假设您可以同时通过任一通道进行通信，因此在某种程度上，每个通道都应该有单独的网络接口。由于 android 是基于 linux 的，您可以尝试使用 ifconfig 或库函数来确定哪些接口可用，哪些接口可以做什么。如果你能做到这一点，应该有一种方法可以通过你想要的通道显式发送/接收（即通过该接口的 ip 进行通信）。

对不起，我不能更具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T01:20:39.617

您在 G1 上寻找的是设置默认路由。您可以使用 linux 实用程序恰当地命名路由来执行此操作，默认路由将是 ip 0.0.0.0，然后是网关。

不确定您是否可以针对每个应用程序执行此操作，但您可以在系统范围内执行此操作！

# c# - 类似 DateTimePicker 的输入控件

> ID：604539
> 
> 赞同：2
> 
> 时间：2009-03-02T23:47:06.207
> 
> 标签：c#, .net, winforms, user-controls

我对 .NET 开发不是很有经验，所以如果我遗漏了一些明显的东西，请原谅我。

我的场景很简单：我的程序将同时处理英制和公制测量系统。我需要一个能够优雅地容纳 {feet,inches} 和 {meters,cmits} 的输入控件（一次只能设置一组）。

根据我在 VC# 的 Control Toolbox (Winforms .NETF 3.5) 中看到的内容，我正在寻找`MaskedTextBox`、`NumericUpDown`和`DateTimePicker`.

即：

*   `MaskedTextBox`过滤用户输入的能力
*   `NumericUpDown`的 [in/de] 递减用户选择的 [sub-] 测量单位的能力
*   `DateTimePicker`在单个控件中“分解”信息的能力。我对分解说英尺和英寸特别感兴趣，同时仍然在同一个控件上显示它们

我还应该指出，我最感兴趣的是复制`DateTimePicker`将单独的输入片段保留在单个控件中的能力。

我将非常感谢您对我应该对哪些基本控件进行子类化以实现此功能的想法。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T23:50:14.123

您是否看过这篇可能是起点的[代码项目文章。](http://www.codeproject.com/KB/vb/UpDownEx_with_measure.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T23:54:54.110

我认为 DateTimePicker 不够灵活，无法做到这一点。

您应该创建一个复合用户控件。主控件应包含：

*   三个 NumericUpDown 控件（年、月、日）
*   将事件委托给每个 Validate 事件（而不是屏蔽文本框）
*   即显示日历控件。用户单击 NumbericUpDown 控件（或者您可以在右侧指定一个带有“...”标签的按钮）

或者，您可以在 CodeProject 或 Codeplex 上搜索开源，在 Telerik 和 DevX 上搜索共享软件组件。

# java - 在 Java 中跟踪操作系统级别的窗口事件

> ID：604541
> 
> 赞同：2
> 
> 时间：2009-03-02T23:47:22.397
> 
> 标签：java, user-interface, awtrobot

我需要能够跟踪用户与其机器上运行的不同应用程序交互的程度。在我看来合乎逻辑的做法是记录带有时间戳的窗口焦点事件，它会告诉您在一天中哪些应用程序处于焦点位置。

在这个应用程序中，我们还有一些其他的事情要做，这些事情在 Java 中很简单。但是我没有在 Java 中进行任何 GUI 编程，所以我不确定是否可以通过 awt API 获取有关操作系统级窗口的信息。这甚至可能吗？是否有另一种方法可以通过 JNI 执行此操作，或者是否需要本机应用程序来执行此操作？

PS：我知道这个要求听起来有点邪恶，但我只是在这里确定这在技术上是否可行。请不要向信使开枪，这不是我的主意。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T23:54:02.350

如果不诉诸本机代码，我认为这是不可能的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T23:55:35.013

焦点事件可能会起作用；您可能还想考虑 Windows[键盘和鼠标挂钩](http://msdn.microsoft.com/en-us/library/ms644990(VS.85).aspx)。使用这些方法中的任何一种，您都需要创建一个 DLL（本机代码）并使用 JNI 来访问它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T00:57:49.997

您可能会寻找一个窗口测试库——其中一些是用来创建和拦截 win32 本机事件的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T23:53:26.893

我认为使用 AWT 是不可能的。Java 无法访问其他应用程序的进程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T23:59:03.773

我认为你应该考虑使用另一种语言。
例如，还有其他语言（例如 C++）专门针对此类问题 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T00:40:38.837

您基本上要求将您的应用程序包含在其他应用程序的操作系统通知中。您可能需要有一个应用程序将其他应用程序作为子进程启动，或者使用诸如 rootkit API 之类的东西来建立高于普通应用程序授予的权限。

如果目标是查看用户与您的应用程序交互的时间，您可能会通过查看为您的应用程序安排的 CPU 时间或如何查看 I/O 事件之间的延迟并将其映射到统计数据来获得一些粗略的想法关于用户的活跃程度。

否则，我认为您可能可以与一些间谍软件开发人员联系以获得您需要的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T00:40:42.363

如果您想从 Java 中执行此操作并且不想编写自己的本机代码，您可以尝试[SWT](http://www.eclipse.org/swt/)。我怀疑它是否有与平台无关的方式来完成你想要的，但你可以在特定于 Windows 的类中四处寻找，尤其是 org.eclipse.swt.internal.win32.OS。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-05T07:25:35.870

我们还可以监视 Windows 任务列表以跟踪用户使用的应用程序，它在 Java 中很容易读取控制台，您还可以从中获取进程数据，但您需要在其中进行少量繁重的字符串处理，bcz 您的所有数据get 将采用字符串格式，您必须从中获取所需的数据，以使其有用，如果您需要进一步的帮助，我可以提供用于监视和保存该数据以进行跟踪的代码，但此解决方案不会覆盖窗口事件，它会给出任务信息，

# ajax - 通过 AJAX 发送登录信息

> ID：604550
> 
> 赞同：3
> 
> 时间：2009-03-02T23:53:29.577
> 
> 标签：ajax, security, login

我使用 jQuery 验证插件，每个表单都有多个验证级别。

1.  级别是通过验证插件
2.  水平是：
    *   数据提交到网站
    *   我收到回复
        *   如果一切正常 -> JS 重定向到 url
        *   如果有错误，它会显示警告

现在我想知道，通过 ajax 发送登录信息是否安全？我知道使用像 firebug 这样的插件，我还可以通过正常提交获取所有 POST 参数。但是其他人可以干扰 ajax 登录请求并窃取宝贵的数据吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T23:54:49.773

> 通过ajax发送登录信息是否安全

你确实使用HTTPS，是吗？如果您这样做，则与表单提交一样安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T23:54:23.707

您是否通过 HTTPS 发出请求？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T00:05:47.783

如果您指的是网络上的其他人，请参阅前面关于 HTTPS 的评论。

如果您的意思是“有人可以在页面中注入一些东西并窃取数据”，那么答案是肯定的。正如您所观察到的，用户可以安装可以执行此操作的插件；您的页面也有可能无意中成为通过[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)或其他缺陷注入的目标。

# flash - zend 框架丢失会话

> ID：604555
> 
> 赞同：4
> 
> 时间：2009-03-02T23:54:14.893
> 
> 标签：flash, zend-framework, session, upload

我正在尝试在我的 Zend 框架应用程序中实现 Flash 上传器，但我遇到了会话问题。

Flash 不发送任何 cookie 标头，这就是会话丢失的原因。我正在尝试将 sessionId 作为 post 参数发送，并在我的引导文件中添加了 session_id($_POST['session_id]) 但这似乎有效。

我正在使用 MySQL 表作为会话存储

我尝试调试错误，据我所见，已设置 session_id，并且存储从数据库返回了正确的数据，但在 $_SESSION 全局中似乎没有正确设置。

更奇怪的是，它似乎可以在我的 Windows 计算机上运行，​​但不能在 Linux 登台服务器上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T01:28:25.697

你知道你是否在你的 PHP 安装中使用 Suhosin 吗？

我听说过[一些关于](http://swfupload.org/forum/generaldiscussion/1206)Suhosin 对会话执行此操作的报告，这种情况下的解决方案是`suhosin.session.cryptua`在 php.ini 中禁用。

无论如何，如果这不是你的问题，只是为了确保基础知识：

1.  确保您`session_id()`从 Flash 中传递您的帖子，例如，使用[SWF Upload](http://swfupload.org/)，这是通过将其传递[`post_params`](http://demo.swfupload.org/Documentation/)到配置数组的值中来完成的。
2.  确保你`session_id($_POST['session_id])`之前打电话`session_start()`

但无论如何，如果你说它在你的 Windows 环境下工作，它可能与你的 PHP 安装有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T00:58:09.200

这听起来与多年来报告的各种错误相似，尽管在大多数情况下它适用于 linux 而不是 windows。

[http://framework.zend.com/issues/browse/ZF-2459](http://framework.zend.com/issues/browse/ZF-2459) [https://www.zend.com/en/forums/index.php?t=msg&goto=16104&S=de7d9b854db445eb37d0f33470cac6b0](https://www.zend.com/en/forums/index.php?t=msg&goto=16104&S=de7d9b854db445eb37d0f33470cac6b0)

就在上个月：

[http://blog.rac.me.uk/2009/01/09/php-zend-session-dont-set-it-up-in-the-initalizer/](http://blog.rac.me.uk/2009/01/09/php-zend-session-dont-set-it-up-in-the-initalizer/)

——马库斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-22T10:05:29.030

在您的控制器操作中尝试以下操作：

```
session_write_close();
session_id($this->_getParam('PHPSESSID'));
session_start(); 
```

# .net - 您如何通过 OSS 推销 ASP.net 的想法？

> ID：604569
> 
> 赞同：0
> 
> 时间：2009-03-03T00:02:58.913
> 
> 标签：.net, asp.net, open-source

你们中有多少人试图将 ASP.net 推销给客户或老板，但却碰上了免费 OSS 堆栈（PHP、RoR...等）的墙？

OSS 或 ASP.net 没有任何问题。我对如何克服针对 OSS 销售 ASP.net 解决方案很感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T00:05:18.627

[ASP.NET 可以是免费的/OSS。](http://www.mono-project.com/)

除了单声道之外，ASP.NET 没有任何其他语言/平台无法做到的事情。它们都有其优点和缺点，在这里和其他地方都在争论不休，但最终这一切都归结为生态系统和商店偏好。如果您的开发人员是 PHP 人员，请使用 PHP。如果你有一个 Windows 生态系统（尤其是 SQL Server），那么使用 ASP.NET 会非常有利——但前提是你的商店有这样的技能。

如果您是 Ruby 商店中唯一的 ASP.NET 人，那么在 ASP.NET 中做一个项目就没有什么意义了。它不适合您的应用程序组合，它在架构上不健全，如果您被公共汽车撞到，那么您的公司会在招聘或培训方面花费大量开销，以便其他人可以接管。

生态系统和现有技能组合几乎是唯一能有效说服管理层的论据。并非巧合，它们也是您应该问的最合理的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T00:39:24.380

认真问问自己为什么对使用 ASP.NET 如此执着。如果您如此热衷于为使用它而战，那么您显然有一些理由 - 它是什么？

那么这个理由对您的公司是否明智（“我认为我将能够在 ASP.NET 中用一半的时间构建这个站点”）或不是（“我讨厌 Ruby”）应该是相当明显的。

请记住，它还有其他因素 - 特别是考虑到您提到“客户”。试图将特定技术推向他们可能不会让任何人喜欢你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T00:27:34.423

把它卖给老板或非技术人员我只想说微软在他们的技术背后有支持。如果存在错误或其他问题，您不必依赖没有获得报酬的人来解决问题。如果应用程序是“Enterprise'ish”，那么这可能很重要。

您还可以提到，有很多人了解 ASP.NET 及其附带的所有内容。我认为开发人员的成本比 Java 开发人员的成本要低一些。

也许您可以指出的最后一件事是如何通过 ASP.NET 堆栈中的某些东西最好地解决您的特定问题。可以节省大量开发时间的东西。在 ASP.NET 世界中，您究竟在看什么将使您的生活更轻松并为公司节省资金。之类的东西。

当然，就像 Rex 说的那样，有一堆 Pro 和 Con，你必须考虑除此之外的其他事情，但我想我会在那里提出一些想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T00:37:19.857

Microsoft 堆栈确实有​​很多用途。除了初始成本（Windows Server 2008 Web 版的价格不算太高，但在某些情况下可能“过高”），还有相对易于使用和管理（质量合理的图形管理工具，虽然肯定有一个好的 ol' shell 没有错）等。

该平台本身在许多方面通常都相当不错，并且工具总体上也相当不错。说出您喜欢 ASP.NET Web 窗体的哪些方面，但它很容易上手，再加上 Linq-to-SQL 或 ADO.NET 实体之类的东西，设置和运行一个沼泽标准 CRUD 应用程序是轻而易举的事。当然，如果你想走这条路，ASP.NET MVC 也很漂亮。

这并不是说微软堆栈在所有场景中都优于传统的 LAMP 堆栈；在奶牛回家之前，您可以对技术和哲学上的优势争论不休，但在一天结束时，您会希望在完成工作的同时让纯粹主义者争论利弊。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T01:34:23.480

好的组件套件可以加速开发（因此中和非 oss 成本） 就我个人而言，我更喜欢基于 python 的解决方案。然而，对于当前的项目，这些演示将我引诱到 ASP.NET

试着把这些展示给你的客户或老板。

[http://demos.devexpress.com/ASPxperienceDemos/](http://demos.devexpress.com/ASPxperienceDemos/)

[http://demos.telerik.com/aspnet-ajax/controls/examples/default/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/controls/examples/default/defaultcs.aspx)

[http://aspnetajax.componentart.com/](http://aspnetajax.componentart.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T02:28:57.097

**我对如何克服针对 OSS 销售 ASP.net 解决方案很感兴趣。**

这个问题应该自己回答——如果您不知道在给定情况下一个与另一个相比的差异和优势，我们无能为力帮助您。

说服别人你的立场是正确的最好方法是向他们展示它如何比其他选择更好地解决他们当前的问题，通常更好的意思是“**更便宜、实施更快、技术上更优越**”。

*以该顺序。*

很难说服某人商业解决方案比 OSS 解决方案便宜，但可以就程序员的数量和成本、支持合同的可用性和可以加快上市时间的承包商的可用性以及随着时间的推移降低维护成本提出案例因为您使用的是“行业标准”工具。

它有时会更快，因为现在商业工具的培训计划比 OSS 工具多。需要让您的程序员跟上进度吗？他们可以在佛罗里达州以 1.5 美元的价格在一周内学习 C#。他们必须自己学习 PHP，或者当地的 PHP 商店可能会举办几天的研讨会，但这并不是 PHP 公司的“​​认证”培训。

无论哪种方式都可以争论技术上的优越性，因此如果您想证明这一点，最好了解两者之间的差异。

**取决于项目、人员、资源**

请注意，商业解决方案在这三个方面是否优于 OSS 解决方案**完全**取决于项目、公司、开发人员、IT 等。

不要立即认为一种解决方案在所有情况下都比另一种更好。好木匠的腰带上有 4 种不同的锤子，商店里有 15 种锤子，这是有原因的。

# c - 读取文件访问/修改时间戳

> ID：604570
> 
> 赞同：1
> 
> 时间：2009-03-03T00:03:08.070
> 
> 标签：c, windows, winapi

我可以使用哪些 win32 API C 函数来读取文件的修改/访问/创建日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T00:11:02.497

使用[GetFileTime](http://msdn.microsoft.com/en-us/library/ms724320(VS.85).aspx)函数。您需要打开文件才能使用此功能。

此外，适当命名的[SetFileTime](http://msdn.microsoft.com/en-us/library/ms724933(VS.85).aspx)函数将允许您修改时间。

# javascript - 为 Web 开发人员提供一个 JavaScript 库

> ID：604571
> 
> 赞同：1
> 
> 时间：2009-03-03T00:03:51.377
> 
> 标签：javascript, unobtrusive-javascript

这是一个基础广泛的问题，围绕交付其他 Web 开发人员将在其网站上使用的 javascript 库。这是我的图书馆的范围：

*   我正在提供以 JS 文件形式提供的数据服务。类似的实现是谷歌分析。
*   将永远由我主持。开发人员将简单地使用 <script> 标签上的@src 属性。
*   我的库由一个具有一组属性的对象（我们现在称之为 Jeff）组成。没有方法，只有价值观。
*   该库不是静态的，而是基于会话的。我们提供的数据点只能在请求时确定。（想想通常通过 AJAX 调用的 Web 服务，在页面加载时可用。）
*   这不是免费服务；实施者将为使用付费。
*   将始终返回 Jeff 对象，但由于在我的服务器上发生的运行时错误，并非所有属性都可能被填充。Jeff 对象包括指示成功/失败的响应部分和描述。

现在，我的问题是：就如我所描述的以 JS 库的形式提供服务的最佳实践而言，什么是理想的？标准谷歌搜索并没有给我太多的帮助，但是非常感谢对指南的引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:10:46.693

听起来不像我会用的东西。您希望它始终托管在您的服务器上这一事实使该服务的任何消费者都可以在他们审查并确定其有用和安全之后替换恶意代码。因此，除非您是一家声誉良好的大公司，否则我认为它的接受度有限。

不对你个人发表评论，只是我如何看待这样的事情以及大公司的信息安全监督员也可能会如何看待它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T17:07:57.077

YUI 托管所有文件供开发人员直接访问，并免费使用他们的 CDN 启动。全球还有数十万家公司使用谷歌分析，这与“杰夫”的风险状况相同。

诚然，雅虎的信任配置文件！Goole 比“Jeff”高很多，但我的观点是，这种交付模式有很多先例。

就个人而言（顺便说一句，除了市场的反应之外，没有正确的答案）我相信它可能具有价值，具体取决于“杰夫”背后的价值主张。我同意 MadMurf 的观点，将其描述为一种“网络服务”，只需要一个 JS 文件即可集成到客户的网站中。

PS：我不确定“javascript”是否是讨论这个问题的最佳标签。也许“商业”标签会引起更广泛的反馈。祝你好运！

# nhibernate - 使用 ICriteria 和 NHibernate 按集合计数排序

> ID：604572
> 
> 赞同：1
> 
> 时间：2009-03-03T00:04:58.830
> 
> 标签：nhibernate, icriteria

使用猫和小猫的标准 NHibernate 示例，我将如何使用 ICriteria 根据小猫数量对猫进行分类？例如，我想做类似的事情：

```
ICriteria crit = Session.CreateCriteria(typeof(Cat));
return crit.Order(Order.Asc("**Kittens.Count**")); 
```

任何人都知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:36:57.210

在 HQL 中，您可以这样做：

```
select cat
from Eg.Cat cat
join cat.Kittens kitten
group by cat
order by count(kitten) asc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T00:49:23.717

见[http://forum.hibernate.org/viewtopic.php?p=2401219](http://forum.hibernate.org/viewtopic.php?p=2401219)

它是 Java Hibernate，但几乎相同（Projection、AddOrder）

# wcf - 设置 SSL 以在 Azure 上使用 WCF 的步骤是什么？

> ID：604573
> 
> 赞同：8
> 
> 时间：2009-03-03T00:05:07.817
> 
> 标签：wcf, ssl, azure

请发布您为设置 SSL 以在 Azure 上使用 WCF 所采取的步骤。

我已成功[上传有效证书](http://msdn.microsoft.com/en-us/library/dd203056.aspx)（[使用 cspack](http://social.msdn.microsoft.com/Forums/en-US/windowsazure/thread/53b54dbc-0408-47c3-9479-9155aa1693cc/)）并与站点的其余部分一起使用，但添加后，我以前工作的 WCF 服务停止工作。（我得到的只是返回 Silverlight 的 404 错误，这不是很有帮助。投票给提出更好日志记录的人，我也可以这样做以帮助诊断问题！）

我在这个配置上尝试了很多变体：

```
<system.serviceModel>
     <!--start added for SSL--> 
    <bindings>
      <basicHttpBinding>
        <binding name="SecureBasicHttpBinding">
          <security mode="Transport">
            <transport clientCredentialType="None"  />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
     <!--end added for SSL--> 
    <behaviors>
      <!--start added for SSL--> 
      <endpointBehaviors>
        <behavior name="DisableServiceCertificateValidation">
          <clientCredentials>
            <serviceCertificate>
              <authentication certificateValidationMode="None"
                              revocationMode="NoCheck" />
            </serviceCertificate>
          </clientCredentials>
        </behavior>
      </endpointBehaviors>
      <!--start added for SSL--> 
      <serviceBehaviors>
        <behavior name="Silverheat.Cloud_WebRole.API.DataServiceBehavior">
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
          <!-- certificate checking removed --> 
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
    <services>
      <service behaviorConfiguration="Silverheat.Cloud_WebRole.API.DataServiceBehavior"
          name="Silverheat.Cloud_WebRole.API.DataService">
        <!--<endpoint address="" binding="basicHttpBinding" contract="Silverheat.Cloud_WebRole.API.DataService" />-->
        <endpoint bindingConfiguration="SecureBasicHttpBinding"
                  behaviorConfiguration="DisableServiceCertificateValidation"
                  address="" binding="basicHttpBinding"
                  contract="Silverheat.Cloud_WebRole.API.DataService" />
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
  </system.serviceModel> 
```

不幸的是，调试这个并获得更多信息真的很难，因为我无法像在实时服务器上使用的那样远程调试和调试任何配置，因为[绑定标签](http://social.msdn.microsoft.com/Forums/en/windowsazure/thread/d69b7c6f-5648-417a-a379-23b0f012c4aa/)在调试时存在问题（但不是实时）。

感谢您的帮助和兴趣！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T04:57:30.000

哇！它还活着！它的工作！

仍然无法在调试（[安​​全异常](http://social.msdn.microsoft.com/Forums/en-US/windowsazure/thread/d69b7c6f-5648-417a-a379-23b0f012c4aa/)）中工作，但我会一直忍受到下一个版本。

这是有效的配置：

```
 <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="SecureBasicHttpBinding">
          <security mode="Transport">
            <transport clientCredentialType="None"  />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="Silverheat.Cloud_WebRole.API.DataServiceBehavior">
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
    <services>
      <service behaviorConfiguration="Silverheat.Cloud_WebRole.API.DataServiceBehavior"
          name="Silverheat.Cloud_WebRole.API.DataService">
        <endpoint bindingConfiguration="SecureBasicHttpBinding"
          address="" binding="basicHttpBinding"
          contract="Silverheat.Cloud_WebRole.API.DataService" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
      </service>
    </services>
  </system.serviceModel> 
```

（我认为是“mexHttpsBinding”使它最终起作用，虽然我不完全理解为什么它已经配置后需要元数据，回到我猜的书）

I'd still like to know how to enable some kind of logging for WCF, but I'll poke around this great site a bit more and I'm sure I'll find an answer.

# javascript - 如何在屏幕上显示消息而不像 SO 那样刷新？

> ID：604577
> 
> 赞同：4
> 
> 时间：2009-03-03T00:05:55.160
> 
> 标签：javascript, html, ajax

最好的例子是通过 SO。您可以查看一个问题，并且无需刷新页面，您将在屏幕顶部收到一条橙色消息，让您知道您获得了徽章并检查您的个人资料。这一切都在不刷新页面的情况下发生。

我很好奇你是怎么做到的？我会用 AJAX 来猜测一些东西。任何方向都会很棒。

# database - Oracle中的按位异或

> ID：604598
> 
> 赞同：7
> 
> 时间：2009-03-03T00:11:47.347
> 
> 标签：database, oracle, stored-procedures, bit-manipulation

在**SQL Server**中，我一直在使用该符号，但是在**Oracle**`^`中似乎不起作用。

 **如何`OR`在 Oracle 中进行按位排他？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T00:43:54.523

从文档：

```
function bitor(p1 number, p2 number) return number is
begin
  return p1-bitand(p1,p2)+p2;
end;

function bitxor(p1 number, p2 number) return number is
begin
  return bitor(p1,p2)-bitand(p1,p2);
end; 
```

要查看这些工作，请遵循仅输入 0 和 1 的逻辑，而不是没有借位或龋齿。

——马库斯

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T00:14:29.040

有 BITAND 运算符：

```
select bitand(49,54)+0 from dual; 
```

您可以从中[构建其他运算符](http://www.jlcomp.demon.co.uk/faq/bitwise.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T00:19:39.450

没有简单的方法。

您可以将字符串`HEX`值转换为`RAW`值并使用`UTL_RAW`：

```
SELECT UTL_RAW.bit_xor(HEXTORAW(TO_CHAR(1, 'FMX')), HEXTORAW(TO_CHAR(2, 'FMX')))
FROM dual

---
 03 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-25T07:55:48.273

我在 SQL 中将它用于 XOR：

```
--9 XOR 7 = 14
SELECT 7+9-2*bitand(7,9) FROM dual 
```

# math - LaTex 宏让 LaTex 在数学中更加人性化？

> ID：604603
> 
> 赞同：0
> 
> 时间：2009-03-03T00:12:41.713
> 
> 标签：math, latex, macros

如何制作一个替换每个的 LaTex 宏

1.  \and by the word "and"
2.  \或通过单词“或”

这样名词就不用斜体了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T00:15:58.850

`\text{and}`或者`\text{or}`

如果您坚持使用宏，只需使用普通的 LaTeX`\newcommand.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T00:20:24.113

在数学模式下`\mbox{}`，参数正立（罗马）排版。

# .net - 我们可以加速沙堡吗？

> ID：604613
> 
> 赞同：20
> 
> 时间：2009-03-03T00:14:34.080
> 
> 标签：.net, sandcastle

我们利用[sandcastle](http://www.codeplex.com/SHFB)（和[SHFB](http://blogs.msdn.com/sandcastle/)）从内联 XML 注释生成类库文档。它是维护完整且专业的参考 + 概述文档（包括[正确的代码示例](https://stackoverflow.com/questions/301365/automatically-unit-test-example-code/604525#604525)）的绝佳工具。

不幸的是，它也很慢。这是迄今为止我们自动化构建中最耗时的步骤，并且开始受到影响。有什么办法可以加快速度吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-05-17T12:54:05.500

If you have SdkLinkType=Msdn (see properties of your SHFB project) sandcastle connects to MSDN documentation using web service. That may slooowww build down in case of connection troubles. You may try to set SdkLinkType=None to turn off building MSDN links (in that case you will not have links to MSDN in your help). In my case that improved my build time 5 times (2 minutes instead of 10 minutes).

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T01:05:44.020

CodePlex 的讨论组非常活跃且知识渊博。这是一个半主题帖子（虽然没有帮助）：[http ://sandcastle.codeplex.com/Thread/View.aspx?ThreadId=32267](http://sandcastle.codeplex.com/Thread/View.aspx?ThreadId=32267)

# .net - 有没有办法将内部控件放入 ASP.NET 自定义控件中？

> ID：604620
> 
> 赞同：9
> 
> 时间：2009-03-03T00:15:48.493
> 
> 标签：.net, asp.net, asp.net-controls

我想做类似的事情（更新的例子）：

```
<uc:Tabs>
  <Tab Name="A handy tab">
    <Node Url="~/Default.aspx" />
    <Node Url="~/Node2.aspx" />
  </Tab>      
  <Tab Name="Another handy tab">
    <Node Url="~/Neato.aspx" />
    <Node Url="~/Node3.aspx" />
    <Node Url="~/Node4.aspx" />
  </Tab>
<uc:Tabs> 
```

可能的？有什么教程或操作方法吗？我不确定要搜索什么或这叫什么，所以到目前为止还没有找到任何东西。内部控制？内藏什么东西……？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T00:19:49.807

使用[ParseChildrenAttribute](http://msdn.microsoft.com/en-us/library/system.web.ui.parsechildrenattribute.aspx)和[PersistChildrenAttribute](http://msdn.microsoft.com/en-us/library/system.web.ui.persistchildrenattribute.aspx)属性：

```
[ParseChildren(false)]
[PersistChildren(true)]
public class MyControl : UserControl { } 
```

这将导致您放入参考中的任何控件：

```
<uc:MyControl runat="server">
  <asp:TextBox runat="server" />
<uc:MyControl> 
```

附加到您的 UserControl 内容的 Controls 集合的末尾。

但是，如果您想拥有一组控件，您可能应该使用服务器控件而不是用户控件。对于像这样工作的控件：

```
<foo:TabControl runat="server">
    <Tabs>
        <foo:Tab CssClass="myclass" Title="Hello World" />
    </Tabs>
</foo:TabControl> 
```

您需要一个具有 Tabs 属性的 Control 类；Tabs 属性应该是一个集合；它应该包含 Tab 类型的对象。我在这里创建了三个类：

```
[ParseChildren(true, "Tabs")]
public class TabControl: WebControl, INamingContainer
{
    private TabCollection _tabs;

    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
    [PersistenceMode(PersistenceMode.InnerDefaultProperty)]
    public TabCollection Tabs
    {
        get
        {
            if (_tabs == null)
            {
                _tabs = new TabCollection();
            }
            return _tabs;
        }
    }

    protected override void Render(HtmlTextWriter writer)
    {
        foreach (Tab tab in Tabs)
        {
            writer.WriteBeginTag("div");
            writer.WriteAttribute("class", tab.CssClass);
            writer.Write(HtmlTextWriter.TagRightChar);
            writer.Write("this is a tab called " + tab.Title);
            writer.WriteEndTag("div");
        }
    }
} 
```

和选项卡类：

```
public class Tab
{
    public string CssClass { get; set; }
    public string Title { get; set; }
} 
```

和选项卡集合：

```
public class TabCollection : Collection<Tab> { } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T16:58:32.310

**跟进**

Rex M 提供了答案，但只是想跟进我也为后代找到的内容。

似乎您可以执行以下任一操作：

```
<ui:Tabs runat="server">
    <ui:Tab TabText="Blah">
        <ui:Node Url="~/Default.aspx" />
        <ui:Node Url="~/More.aspx" />
        <ui:Node Url="~/Another.aspx" />
    </ui:Tab>
    <ui:Tab TabText="Nanner">
        <ui:Node Url="~/Default.aspx" />
        <ui:Node Url="~/More.aspx" />
        <ui:Node Url="~/Another.aspx" />
    </ui:Tab>
    <ui:Tab TabText="High There">
        <ui:Node Url="~/Default.aspx" />
        <ui:Node Url="~/More.aspx" />
        <ui:Node Url="~/Another.aspx" />
    </ui:Tab>
</ui:Tabs> 
```

或者

```
<ui:Tabs runat="server">
    <TabItems>
        <ui:Tab InnerHeading="Big Huge Heading" TabText="Big">
            <NodeItems>
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
            </NodeItems>
        </ui:Tab>
    </TabItems>
    <TabItems>
        <ui:Tab InnerHeading="Hi ya" TabText="Hi">
            <NodeItems>
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
                <ui:Node Url="~/Default.aspx" />
            </NodeItems>
        </ui:Tab>
    </TabItems>
</ui:Tabs> 
```

然后在代码中：

```
namespace Controls
{
    [ToolboxData("<{0}:Tabs runat=server></{0}:Tabs>"), ParseChildren(true, "TabItems")]
    public class Tabs : BaseControl, INamingContainer
    {
        private TabCollection tabItems;
        [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
        [PersistenceMode(PersistenceMode.InnerDefaultProperty)]
        public TabCollection TabItems
        {
            get
            {
                if (tabItems == null) 
                { 
                    tabItems = new TabCollection(); 
                } 
                return tabItems;
            }
        }

        protected override void Render(HtmlTextWriter writer)
        {
            writer.Write("<div id=\"tabs\" class=\"pane\" style=\"display: none\"><ul>");
            int tabNumber = 1;
            foreach (Tab tab in TabItems)
            {
                string li = string.Format("<li id=\"tab_{0}\"><a href=\"#tab{0}\"><span>{1}</span></a></li>", tabNumber, tab.TabText);
                tabNumber++;
                writer.Write(li);
            }
            writer.Write("</ul>");
            tabNumber = 1;
            foreach (Tab tab in TabItems)
            {
                string div = string.Format("<div id=\"tab{0}\" class=\"pane\"><h1>{1}</h1>", tabNumber, tab.InnerHeading);
                tabNumber++;
                writer.Write(div);
                foreach (Node node in tab.NodeItems)
                {
                    string a = string.Format("<a href='{0}'>{1}</a>", node.Url, "Text holder");
                    writer.Write(a);
                }
                writer.Write("</div>");
            }
            writer.Write("</div>");
        }
    }

    public class TabCollection : List<Tab> { }

    [ParseChildren(true, "NodeItems")]
    public class Tab
    {
        private string tabText = string.Empty;
        private string innerHeading = string.Empty;
        private string showOn = string.Empty;
        public string TabText
        {
            get { return tabText; }
            set { tabText = value; }
        }
        public string InnerHeading
        {
            get { return innerHeading; }
            set { innerHeading = value; }
        }

        public string ShowOn
        {
            get { return showOn; }
            set { showOn = value; }
        }

        private NodeCollection nodeItems;
        [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
        [PersistenceMode(PersistenceMode.InnerDefaultProperty)]
        public NodeCollection NodeItems
        {
            get
            {
                if (nodeItems == null)
                {
                    nodeItems = new NodeCollection();
                }
                return nodeItems;
            }
        }
    }

    public class NodeCollection : List<Node> { }

    public class Node
    {
        private string url = string.Empty;
        public string Url
        {
            get { return url; }
            set { url = value; }
        }
    }
} 
```

这显然会发生变化（我的将阅读 web.sitemap 以及其他变化），但这应该让任何有相同需求的人都能顺利进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-15T19:44:26.427

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Text;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Collections;
using System.Web.UI.HtmlControls;

namespace Gui.Controls
{

    [DefaultProperty("Text")]
    [ToolboxData("<{0}:GPMenu runat=server></{0}:GPMenu>")]
    [ParseChildren(false)]
    public class GPMenu : WebControl
    {

        private void CreateDynamicControls()
        {
            //some code for Creating Dynamic Controls 

        } //eof method 

        #region FieldsAndProps

        #region ActiveTab

        protected int _ActiveTab;
        [Bindable(true)]
        [Category("Appearance")]
        public int ActiveTab // Public properties   
        {
            get { return _ActiveTab; }
            set { _ActiveTab = value; }
        }
        #endregion ActiveTab

        #region Caption

        protected string _Caption = "";
        [Bindable(true)]
        [Category("Appearance")]
        [DefaultValue("")]
        [Localizable(true)]
        public string Caption // Public properties  
        {
            get { return _Caption; }
            set { _Caption = value; }
        }
        #endregion Caption

        #region MenuId

        protected string _MenuId = "0";
        [Bindable(true)]
        [Category("Appearance")]
        [DefaultValue("")]
        [Localizable(true)]
        public string MenuId // Public properties   
        {
            get { return _MenuId; }
            set { _MenuId = value; }
        }
        #endregion MenuId

        #region Text

        protected string _Text = "";
        [Bindable(true)]
        [Category("Appearance")]
        [DefaultValue("")]
        [Localizable(true)]
        public string Text // Public properties 
        {
            get { return _Text; }
            set { _Text = value; }
        }
        #endregion Text

        #region UserObj

        private FB.User userObj;
        public FB.User UserObj
        {
            get
            {
                return userObj;
            } //eof get 
            set
            {
                userObj = value;

            } //eof set 

        } //eof prop 

        #endregion UserObj

        #region ListTabWizard

        private List<App.Models.TabWizard> _ListWizard;

        [Bindable(true)]
        [Category("Appearance")]
        [Description(" The data structure used for databinding the menu ")]
        public List<App.Models.TabWizard> ListWizard
        {
            get { return _ListWizard; }
            set { _ListWizard = value; }
        }

        #endregion ListWizard

        #endregion FieldsAndProps

        #region Constructors
        public GPMenu()
        {
            //Statement to run while initialize of control  
        }
        #endregion Constructors

        #region Overrides

        public override void RenderControl(HtmlTextWriter writer)
        {
            RenderContents(writer);
        }

        protected override void RenderContents(HtmlTextWriter output)
        {
            //Codes for rendering html to be written here   
            output.WriteBeginTag("div");
            output.WriteAttribute("class", _Caption);
            output.WriteAttribute("ID", this.ID);
            RenderChildren(output); // Render Child Control is Exists   
            output.WriteEndTag("div");
        }

        public override void DataBind()
        {
            this.Controls.Clear();
            base.DataBind();

            #region Debug

            //old configure the logger
            //logger.Debug("Custom GPMenu DataBind called ");

            #endregion Debug

            #region AddTheTopDiv

            Panel panTabMenuTop = new Panel();
            panTabMenuTop.ID = "panTabMenuTop";
            panTabMenuTop.CssClass = "CssClassPanTabMenuTop";
            this.Controls.Add(panTabMenuTop);

            #endregion AddTheTopDiv

            #region AddTheUlOpenTag

            HtmlGenericControl conGenUi = new HtmlGenericControl("ul");
            conGenUi.ID = "paakallo";

            #endregion AddTheUlOpenTag

            #region ForEachMenuItemInTheListAddTheLinks

            if (this.ListWizard == null)
                throw new Exception(" The List of menu items is null for " + this.ID);

            #region ForEachWizardItem

            for (int iListMenuItem = 0; iListMenuItem < this.ListWizard.Count; iListMenuItem++)
            {
                App.Models.TabWizard objMenuItem = this.ListWizard[iListMenuItem];

                #region AddTheLiOpenTag

                PlaceHolder objPlaceHolderLiOpen = new PlaceHolder();
                objPlaceHolderLiOpen.Controls.Add(new LiteralControl("<li>"));
                conGenUi.Controls.Add(objPlaceHolderLiOpen);

                #endregion AddTheLiOpenTag

                #region BuildTheLocalizedLink

                #region Check that the whole MenuItem data structure is not null

                if (objMenuItem == null)
                    throw new Exception(
                        "The building of the GPMenu failed since \n: " +
                        " null MenuItem at  " + iListMenuItem.ToString() + " for " + this.ID);

                #endregion Check that the whole MenuItem data structure is not null

                //the variant with LinkButton does PostBack == BAD !!!                
                PlaceHolder objPlaceHolderLink = new PlaceHolder();

                #region BuildTheLinkId_with_MenuItemId

                if (String.IsNullOrEmpty(objMenuItem.Link_Id.ToString()))
                {
                    throw new Exception(
                        "The building of the GPMenu failed since \n: " +
                        " null or empty MenuItemId for  " + iListMenuItem.ToString() + " for " + this.ID);
                }

                #endregion BuildTheLinkId_with_MenuItemId

                #region AddTheTextForTheLink_with_GuiPageLinkURL

                //check that this LinkItem points to a registered page 
                if (objMenuItem.Link_Id == null)
                {
                    throw new Exception(
                        "The building of the GPMenu failed since \n: " +
                        " null GuiPage for " + iListMenuItem.ToString() + " for " + this.ID);
                }

                string strActiveLinkCssClass = String.Empty;

                string strTabTxt = String.Empty;
                try
                {
                    strTabTxt = objMenuItem.TabTitle;
                }
                catch (System.Exception ex)
                {
                    continue;
                }

                #region BuildTheActualLink

                string strLinkTxt = String.Empty;
                strLinkTxt += "<a " + strActiveLinkCssClass + " href=\"";
                string strLinkUrl = Http.UrlHandler.ExpandUrl(objMenuItem.LinkURL);

                #endregion BuildTheActualLinks

                #region AddTheColorForTheLinkAndRemoveTheBorderOfActiveTab

                if (this.ActiveTab != null && strLinkUrl.Contains("tabid=" + this.ActiveTab.ToString()))
                    strActiveLinkCssClass = "class=\"CssClassGPMenuActiveLink\"";

                #endregion AddTheColorForTheLinkAndRemoveTheBorderOfActiveTab

                strLinkTxt += strLinkUrl + "\"" + strActiveLinkCssClass;

                #endregion AddTheTextForTheLink_with_GuiPageLinkURL

                #region AddTheToolTip

                string strVisibleToolTipTxt = String.Empty;
                try
                {
                    strVisibleToolTipTxt = objMenuItem.ItemButtonToolTip;
                }
                catch (System.Exception ex)
                {
                    continue;
                }

                strLinkTxt += "\" title=\"" + strVisibleToolTipTxt +
                    "\"><span>" + strTabTxt + "</span></a>";

                #endregion AddTheToolTip

                #region AddTheLabel_used_in_The_TabMenu

                objPlaceHolderLink.Controls.Add(new LiteralControl(strLinkTxt));
                conGenUi.Controls.Add(objPlaceHolderLink);

                #endregion AddTheLabel_used_in_The_TabMenu

                #endregion BuildTheLocalizedLink

                #region AddTheLiCloseTag

                PlaceHolder objPlaceHolderLiClose = new PlaceHolder();
                objPlaceHolderLiClose.Controls.Add(new LiteralControl("</li>"));
                conGenUi.Controls.Add(objPlaceHolderLiClose);

                #endregion AddTheLiCloseTag

            } //eof foreach MenuItem in List
            #endregion ForEachWizardItem

            #endregion ForEachMenuItemInTheListAddTheLinks

            #region AddTheUlCloseTag

            this.Controls.Add(conGenUi);

            #region AddTheBottomDiv

            Panel panTabMenuBottom = new Panel();
            panTabMenuBottom.ID = "panTabMenuBottom";
            panTabMenuBottom.CssClass = "CssClassPanTabMenuBottom";
            this.Controls.Add(panTabMenuBottom);

            #endregion AddTheBottomDiv

            #endregion AddTheUlCloseTag

        } //eof method 

        #region TemplateMethods
        protected override void OnInit(EventArgs e)
        {
            base.OnInit(e);
        } //eof method

        protected override void CreateChildControls()
        {
            base.CreateChildControls();
            this.CreateDynamicControls();
        } //eof method 

        protected override object SaveViewState()
        {
            return new Pair(base.SaveViewState(), null);
        } //eof method 

        protected override void LoadViewState(object savedState)
        {
            base.LoadViewState(((Pair)savedState).First);
            EnsureChildControls();
        } //eof method 

        #endregion TemplateMethods

        #endregion Overrides

    } //eof class 
} //eof namespace 

using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data;
using System.Collections.Specialized;

namespace App.Models
{
    /// <summary>
    /// Serves as the model for  the tabwizard page 
    /// </summary>
    public class TabWizard
    {
        #region Properties

        #region TabWizardId

        public long tbGuiTabWizardId { get; set; }

        #endregion TabWizardId

        #region TabId

        public int TabId { get; set; }

        #endregion TabId

        #region Link_Id

        public int Link_Id { get; set; }

        #endregion Link_Id

        #region WizardId

        public int WizardId { get; set; }

        #endregion WizardId

        #region TabOrder

        public int TabOrder { get; set; }

        #endregion TabOrder

        #region TabTitle

        public string TabTitle { get; set; }

        #endregion TabTitle

        #region TabHasManyButtons

        public bool TabHasManyButtons { get; set; }

        #endregion TabHasManyButtons

        #region ButtonTitle

        public string ButtonTitle { get; set; }

        #endregion ButtonTitle

        #region Description

        public string Description { get; set; }

        #endregion Description

        #region ProcToStart

        public string ProcToStart { get; set; }

        #endregion ProcToStart

        #region ProcId

        public string ProcId { get; set; }

        #endregion ProcId

        #region ItemMetaId

        public string ItemMetaId { get; set; }

        #endregion ItemMetaId

        #region ItemId

        public string ItemId { get; set; }

        #endregion ItemId

        #region ItemStartProc

        public string ItemStartProc { get; set; }

        #endregion ItemStartProc

        #region ItemButtonToolTip

        public string ItemButtonToolTip { get; set; }

        #endregion ItemButtonToolTip

        #region ItemButtonText

        public string ItemButtonText { get; set; }

        #endregion ItemButtonText

        #region TypeOfTab

        public string TypeOfTab { get; set; }

        #endregion TypeOfTab

        #region WizardHasStepping

        public bool WizardHasStepping { get; set; }

        #endregion WizardHasStepping

        #region RunProcOnTabClick

        public bool RunProcOnTabClick { get; set; }

        #endregion RunProcOnTabClick

        #region TabIsPRS

        public bool TabIsPRS { get; set; }

        #endregion TabIsPRS

        #region ItemIsPRS

        public bool ItemIsPRS { get; set; }

        #endregion ItemIsPRS

        #region FlagPresentAreYouSurePrompt

        public bool FlagPresentAreYouSurePrompt { get; set; }

        #endregion FlagPresentAreYouSurePrompt

        #region PromptAreYouSureText

        public string PromptAreYouSureText { get; set; }

        #endregion PromptAreYouSureText

        #region PageId

        public int PageId { get; set; }

        #endregion PageId

        #region MenuId

        public int MenuId { get; set; }

        #endregion MenuId

        #endregion Properties

        #region Props

        #region Constructor

        public TabWizard(System.Data.DataRow dr)
        {
            if (dr["tbGuiTabWizardId"] != null && !(dr["tbGuiTabWizardId"] is DBNull))
                this.tbGuiTabWizardId = System.Convert.ToInt64(dr["tbGuiTabWizardId"]);

            if (dr["TabId"] != null && !(dr["TabId"] is DBNull))
                this.TabId = System.Convert.ToInt32(dr["TabId"]);

            if (dr["Link_Id"] != null && !(dr["Link_Id"] is DBNull))
                this.Link_Id = System.Convert.ToInt32(dr["Link_Id"]);

            if (dr["WizardId"] != null && !(dr["WizardId"] is DBNull))
                this.WizardId = System.Convert.ToInt32(dr["WizardId"]);

            if (dr["TabOrder"] != null && !(dr["TabOrder"] is DBNull))
                this.TabOrder = System.Convert.ToInt32(dr["TabOrder"]);

            if (dr["TabTitle"] != null && !(dr["TabTitle"] is DBNull))
                this.TabTitle = System.Convert.ToString(dr["TabTitle"]);

            if (dr["TabHasManyButtons"] != null && !(dr["TabHasManyButtons"] is DBNull))
                this.TabHasManyButtons = System.Convert.ToBoolean(dr["TabHasManyButtons"]);

            if (dr["ButtonTitle"] != null && !(dr["ButtonTitle"] is DBNull))
                this.ButtonTitle = System.Convert.ToString(dr["ButtonTitle"]);

            if (dr["Description"] != null && !(dr["Description"] is DBNull))
                this.Description = System.Convert.ToString(dr["Description"]);

            if (dr["ProcToStart"] != null && !(dr["ProcToStart"] is DBNull))
                this.ProcToStart = System.Convert.ToString(dr["ProcToStart"]);

            if (dr["ProcId"] != null && !(dr["ProcId"] is DBNull))
                this.ProcId = System.Convert.ToString(dr["ProcId"]);

            if (dr["ItemMetaId"] != null && !(dr["ItemMetaId"] is DBNull))
                this.ItemMetaId = System.Convert.ToString(dr["ItemMetaId"]);

            if (dr["ItemStartProc"] != null && !(dr["ItemStartProc"] is DBNull))
                this.ItemStartProc = System.Convert.ToString(dr["ItemStartProc"]);

            if (dr["ItemButtonToolTip"] != null && !(dr["ItemButtonToolTip"] is DBNull))
                this.ItemButtonToolTip = System.Convert.ToString(dr["ItemButtonToolTip"]);

            if (dr["ItemButtonText"] != null && !(dr["ItemButtonText"] is DBNull))
                this.ItemButtonText = System.Convert.ToString(dr["ItemButtonText"]);

            if (dr["TypeOfTab"] != null && !(dr["TypeOfTab"] is DBNull))
                this.TypeOfTab = System.Convert.ToString(dr["TypeOfTab"]);

            if (dr["WizardHasStepping"] != null && !(dr["WizardHasStepping"] is DBNull))
                this.WizardHasStepping = System.Convert.ToBoolean(dr["WizardHasStepping"]);

            if (dr["RunProcOnTabClick"] != null && !(dr["RunProcOnTabClick"] is DBNull))
                this.RunProcOnTabClick = System.Convert.ToBoolean(dr["RunProcOnTabClick"]);

            if (dr["TabIsPRS"] != null && !(dr["TabIsPRS"] is DBNull))
                this.TabIsPRS = System.Convert.ToBoolean(dr["TabIsPRS"]);

            if (dr["ItemIsPRS"] != null && !(dr["ItemIsPRS"] is DBNull))
                this.ItemIsPRS = System.Convert.ToBoolean(dr["ItemIsPRS"]);

            if (dr["FlagPresentAreYouSurePrompt"] != null && !(dr["FlagPresentAreYouSurePrompt"] is DBNull))
                this.FlagPresentAreYouSurePrompt = System.Convert.ToBoolean(dr["FlagPresentAreYouSurePrompt"]);

            if (dr["PromptAreYouSureText"] != null && !(dr["PromptAreYouSureText"] is DBNull))
                this.PromptAreYouSureText = System.Convert.ToString(dr["PromptAreYouSureText"]);

            if (dr["PageId"] != null && !(dr["PageId"] is DBNull))
                this.PageId = System.Convert.ToInt32(dr["PageId"]);

            if (dr["LinkURL"] != null && !(dr["LinkURL"] is DBNull))
                this.LinkURL = System.Convert.ToString(dr["LinkURL"]);

            if (dr["MenuId"] != null && !(dr["MenuId"] is DBNull))
                this.MenuId = System.Convert.ToInt16(dr["MenuId"]);

        } //eof constructor  

        #endregion Constructor

        #region LinkURL

        private string _LinkURL = String.Empty;
        public string LinkURL
        {
            get { return _LinkURL; }
            set { _LinkURL = value; }
        }

        #endregion LinkURL

        #endregion Props

    } //eof class 
} //eof namespace 
```

# python - Python 有类似 Perl 5.10 的“状态”变量吗？

> ID：604622
> 
> 赞同：8
> 
> 时间：2009-03-03T00:17:47.677
> 
> 标签：python, perl

在 Perl 5.10 中，我可以说：

```
sub foo () {
  state $x = 1;
  say $x++;
}

foo();
foo();
foo(); 
```

...它会打印出来：

```
1
2
3 
```

Python有这样的东西吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-03T00:27:45.920

一个类可能更适合这里（并且通常更适合任何涉及“状态”的东西）：

```
class Stateful(object):

    def __init__(self):
        self.state_var = 0

    def __call__(self):
        self.state_var = self.state_var + 1
        print self.state_var

foo = Stateful()
foo()
foo() 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-03T00:30:11.517

最接近的平行可能是将值附加到函数本身。

```
def foo():
    foo.bar = foo.bar + 1

foo.bar = 0

foo()
foo()
foo()

print foo.bar # prints 3 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-03T00:28:47.930

Python 具有执行类似操作的生成器：

[Python中的“yield”关键字有什么作用？](https://stackoverflow.com/questions/231767/can-somebody-explain-me-the-python-yield-statement)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-03T00:30:49.250

不确定这是否是您要查找的内容，但是 python 具有本身不返回值的生成器函数，而是每次生成新值的生成器对象

```
def gen():
   x = 10
   while True:
      yield x
      x += 1 
```

用法：

```
>>> a = gen()
>>> a.next()
10
>>> a.next()
11
>>> a.next()
12
>>> a.next()
13
>>> 
```

在这里查看更多关于[yield](https://stackoverflow.com/questions/231767/can-somebody-explain-me-the-python-yield-statement)的解释：
[“yield”关键字在 Python 中的作用是什么？](https://stackoverflow.com/questions/231767/can-somebody-explain-me-the-python-yield-statement)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-03T03:04:30.897

这是在python中实现闭包的一种方法：

```
def outer():
    a = [4]
    def inner():
        print a[0]
        a[0] = a[0] + 1
    return inner

fn = outer()
fn() # => 4
fn() # => 5
fn() # => 6 
```

[我从python 邮件列表帖子](http://mail.python.org/pipermail/python-list/2004-July/270951.html)中逐字借用了这个示例。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T00:23:41.360

是的，尽管您必须先声明全局变量，然后才能在以下位置遇到它`foo`：

```
x = 0

def foo():
    global x
    x += 1
    print x

foo()
foo()
foo() 
```

编辑：作为对评论的回应，python确实在函数内没有静态变量。请注意，`x`在此示例中，仅对模块的其余部分公开为全局。例如，假设上面的代码在`test.py`. 现在假设您编写以下模块：

```
from test import foo
x = 100
foo()
foo() 
```

输出将只有`1`and `2`，而不是`101`and `102`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-03T00:29:13.873

你也可以使用类似的东西

```
def static_num2():
    k = 0
    while True:
        k += 1
        yield k

static = static_num2().next

for i in range(0,10) :
    print static() 
```

避免全局变量。[从这个链接](http://www.daniweb.com/forums/thread33025.html)中解除关于同样的问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-03T01:03:56.410

不是我推荐这个，只是为了好玩：

```
def foo(var=[1]):
    print var[0]
    var[0] += 1 
```

这是因为[可变默认参数](http://effbot.org/zone/default-values.htm)在 Python 中的工作方式。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-03T17:02:09.587

更可取的方法是使用[类](https://stackoverflow.com/questions/604622/does-python-have-something-like-perl-5-10s-state-variables/604645#604645)或[生成器](https://stackoverflow.com/questions/604622/does-python-have-something-like-perl-5-10s-state-variables/604658#604658)( `yield`)。

为了完整起见，这里有一个 Python 3.x 中带有闭包的变体：

```
>>> def make_foo():
...     x = 1
...     def foo():
...         nonlocal x
...         print(x)
...         x += 1
...     return foo
...
>>> foo = make_foo()
>>> foo()
1
>>> foo()
2
>>> foo()
3 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-03T00:45:05.940

```
>>> def foo():
    x = 1
    while True:
        yield x
        x += 1

>>> z = iter(foo())
>>> next(z)
1
>>> next(z)
2
>>> next(z)
3 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-24T01:19:16.120

这是另一种肮脏廉价的方法，它是 Tryiptich 答案的变体，但使用装饰器

```
def static_var( name, value ):
    def dec( function ):
        setattr( function, name, value )
        return function
    return dec

@static_var( 'counter', 0 )
def counting_function():
    counting_function.counter = counting_function.counter + 1
    print counting_function.counter

"""
>>> counting_function()
1
>>> counting_function()
2
>>> counting_function()
3
>>> counting_function()
4
>>> counting_function()
5
>>> 
""" 
```

# ios - 如何向 UIButton 添加多行文本？

> ID：604632
> 
> 赞同：386
> 
> 时间：2009-03-03T00:22:11.893
> 
> 标签：ios, objective-c, cocoa-touch, uibutton, uikit

我有以下代码...

```
UILabel *buttonLabel = [[UILabel alloc] initWithFrame:targetButton.bounds];
buttonLabel.text = @"Long text string";
[targetButton addSubview:buttonLabel];
[targetButton bringSubviewToFront:buttonLabel]; 
```

...我的想法是我可以为按钮设置多行文本，但文本总是被 UIButton 的 backgroundImage 遮挡。显示按钮子视图的日志调用显示已添加 UILabel，但无法看到文本本身。这是 UIButton 中的错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：699
> 
> 时间：2009-12-01T22:34:56.043

**对于 iOS 6 及更高版本，使用以下命令允许多行：**

```
button.titleLabel.lineBreakMode = NSLineBreakByWordWrapping;
// you probably want to center it
button.titleLabel.textAlignment = NSTextAlignmentCenter; // if you want to 
[button setTitle: @"Line1\nLine2" forState: UIControlStateNormal]; 
```

**对于 iOS 5 及更低版本，请使用以下命令来允许多行：**

```
button.titleLabel.lineBreakMode = UILineBreakModeWordWrap;
// you probably want to center it
button.titleLabel.textAlignment = UITextAlignmentCenter;
[button setTitle: @"Line1\nLine2" forState: UIControlStateNormal]; 
```

**2017，对于 iOS9 前进**，

通常，只需执行以下两件事：

1.  选择**“属性文本”**
2.  在“换行符”弹出窗口中选择**“自动换行”**

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2014-05-14T15:36:05.383

选择的答案是正确的，但如果您更喜欢在 Interface Builder 中执行此类操作，您可以执行以下操作：

![图片](https://i.stack.imgur.com/Qk9Bg.png)

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2015-10-21T09:03:53.627

如果要添加标题居中的多行按钮，请设置 Interface Builder 的按钮设置：

[ ![这里](https://i.stack.imgur.com/xZaOC.png)]

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2012-10-08T07:14:08.883

对于 IOS 6：

```
button.titleLabel.lineBreakMode = NSLineBreakByWordWrapping;
button.titleLabel.textAlignment = NSTextAlignmentCenter; 
```

作为

```
UILineBreakModeWordWrap and UITextAlignmentCenter 
```

从 IOS 6 起已弃用..

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2010-10-28T15:45:02.900

重申 Roger Nolan 的建议，但使用明确的代码，这是一般解决方案：

```
button.titleLabel?.numberOfLines = 0 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2017-05-08T09:56:36.190

# 斯威夫特 3

```
button.titleLabel?.lineBreakMode = .byWordWrapping
button.titleLabel?.textAlignment = .center  
button.setTitle("Button\nTitle",for: .normal) 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2019-04-11T21:25:00.460

我遇到了自动布局的问题，启用多行后结果是这样的： 所以大小不会影响 我添加的按钮大小（在这种情况下 contentEdgeInsets 是 (10, 10, 10, 10 ) 致电后： 希望对您有所帮助（swift 5.0）：
[![在此处输入图像描述](https://i.stack.imgur.com/AdaOn.png)](https://i.stack.imgur.com/AdaOn.png)
`titleLabel`
`Constraints``contentEdgeInsets`
`makeMultiLineSupport()`
[![在此处输入图像描述](https://i.stack.imgur.com/xz0Z3.png)](https://i.stack.imgur.com/xz0Z3.png)

```
extension UIButton {

    func makeMultiLineSupport() {
        guard let titleLabel = titleLabel else {
            return
        }
        titleLabel.numberOfLines = 0
        titleLabel.setContentHuggingPriority(.required, for: .vertical)
        titleLabel.setContentHuggingPriority(.required, for: .horizontal)
        addConstraints([
            .init(item: titleLabel,
                  attribute: .top,
                  relatedBy: .greaterThanOrEqual,
                  toItem: self,
                  attribute: .top,
                  multiplier: 1.0,
                  constant: contentEdgeInsets.top),
            .init(item: titleLabel,
                  attribute: .bottom,
                  relatedBy: .greaterThanOrEqual,
                  toItem: self,
                  attribute: .bottom,
                  multiplier: 1.0,
                  constant: contentEdgeInsets.bottom),
            .init(item: titleLabel,
                  attribute: .left,
                  relatedBy: .greaterThanOrEqual,
                  toItem: self,
                  attribute: .left,
                  multiplier: 1.0,
                  constant: contentEdgeInsets.left),
            .init(item: titleLabel,
                  attribute: .right,
                  relatedBy: .greaterThanOrEqual,
                  toItem: self,
                  attribute: .right,
                  multiplier: 1.0,
                  constant: contentEdgeInsets.right)
            ])
    }

} 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2018-05-31T06:14:28.007

在 Xcode 9.3 中，您可以使用下面的**情节提要**来做到这一点，

[![在此处输入图像描述](https://i.stack.imgur.com/ZRdnx.png)](https://i.stack.imgur.com/ZRdnx.png)

您需要将按钮标题 textAlignment 设置为居中

`button.titleLabel?.textAlignment = .center`

您不需要像下面那样使用换行符 (\n) 设置标题文本，

`button.setTitle("Good\nAnswer",for: .normal)`

只需设置标题，

`button.setTitle("Good Answer",for: .normal)`

这是结果，

[![在此处输入图像描述](https://i.stack.imgur.com/U0Uly.png)](https://i.stack.imgur.com/U0Uly.png)

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2009-10-25T19:48:31.960

有一个更简单的方法：

```
someButton.lineBreakMode = UILineBreakModeWordWrap; 
```

（针对 iOS 3 及更高版本进行编辑：）

```
someButton.titleLabel.lineBreakMode = UILineBreakModeWordWrap; 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2013-06-28T19:07:50.057

在 iOS7 上使用自动布局左对齐：

```
button.titleLabel.lineBreakMode = NSLineBreakByWordWrapping;
button.titleLabel.textAlignment = NSTextAlignmentLeft;
button.contentHorizontalAlignment = UIControlContentHorizontalAlignmentLeft; 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-03-03T08:35:36.170

首先，你应该知道 UIButton 里面已经有一个 UILabel 。您可以使用`–setTitle:forState:`.

您的示例的问题是您需要将 UILabel 的`numberOfLines`属性设置为默认值 1 以外的其他值。您还应该查看该`lineBreakMode`属性。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2019-11-22T09:45:52.907

Swift 5，用于 UIButton 中的多行文本

```
 let button = UIButton()
  button.titleLabel?.lineBreakMode = .byWordWrapping
  button.titleLabel?.textAlignment = .center
  button.titleLabel?.numberOfLines = 0 // for Multi line text 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-05-09T18:12:27.617

对于那些使用 Xcode 4 的故事板的人，您可以单击该按钮，然后在 Attributes Inspector 下的右侧 Utilities 窗格中，您将看到 Line Break 的选项。选择自动换行，你应该很高兴。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-05-01T09:50:09.847

这里的答案告诉你如何以编程方式实现多行按钮标题。

我只是想补充一点，如果您使用情节提要，您可以键入 [Ctrl+Enter] 以在按钮标题字段上强制换行。

高温高压

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-08-31T20:21:44.733

将 lineBreakMode 设置为 NSLineBreakByWordWrapping（在 IB 或代码中）使按钮标签变为多行，但不影响按钮的框架。

如果按钮具有动态标题，则有一个技巧：将隐藏的 UILabel 放入相同的字体并将其高度与布局的按钮高度联系起来；当将文本设置为按钮和标签时​​，自动布局将完成所有工作。

**笔记**

单行按钮的固有尺寸高度大于标签的，所以为了防止标签的高度收缩，它的垂直内容拥抱优先级必须大于按钮的垂直内容压缩阻力。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2018-02-21T11:41:43.403

您必须添加以下代码：

```
buttonLabel.titleLabel.numberOfLines = 0; 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-03-09T14:25:47.963

至于 Brent 将标题 UILabel 作为同级视图的想法，在我看来这不是一个好主意。我一直在思考与 UILabel 的交互问题，因为它的触摸事件没有通过 UIButton 的视图。

另一方面，使用 UILabel 作为 UIButton 的子视图，我很高兴知道触摸事件将始终传播到 UILabel 的超级视图。

我确实采用了这种方法，并没有注意到 backgroundImage 报告的任何问题。我在 UIButton 子类的 -titleRectForContentRect: 中添加了这段代码，但代码也可以放在 UIButton 父视图的绘图例程中，在这种情况下，您应该用 UIButton 的变量替换所有对 self 的引用。

```
#define TITLE_LABEL_TAG 1234

- (CGRect)titleRectForContentRect:(CGRect)rect
{   
    // define the desired title inset margins based on the whole rect and its padding
    UIEdgeInsets padding = [self titleEdgeInsets];
    CGRect titleRect = CGRectMake(rect.origin.x    + padding.left, 
                                  rect.origin.x    + padding.top, 
                                  rect.size.width  - (padding.right + padding.left), 
                                  rect.size.height - (padding.bottom + padding].top));

    // save the current title view appearance
    NSString *title = [self currentTitle];
    UIColor  *titleColor = [self currentTitleColor];
    UIColor  *titleShadowColor = [self currentTitleShadowColor];

    // we only want to add our custom label once; only 1st pass shall return nil
    UILabel  *titleLabel = (UILabel*)[self viewWithTag:TITLE_LABEL_TAG];

    if (!titleLabel) 
    {
        // no custom label found (1st pass), we will be creating & adding it as subview
        titleLabel = [[UILabel alloc] initWithFrame:titleRect];
        [titleLabel setTag:TITLE_LABEL_TAG];

        // make it multi-line
        [titleLabel setNumberOfLines:0];
        [titleLabel setLineBreakMode:UILineBreakModeWordWrap];

        // title appearance setup; be at will to modify
        [titleLabel setBackgroundColor:[UIColor clearColor]];
        [titleLabel setFont:[self font]];
        [titleLabel setShadowOffset:CGSizeMake(0, 1)];
        [titleLabel setTextAlignment:UITextAlignmentCenter];

        [self addSubview:titleLabel];
        [titleLabel release];
    }

    // finally, put our label in original title view's state
    [titleLabel setText:title];
    [titleLabel setTextColor:titleColor];
    [titleLabel setShadowColor:titleShadowColor];

    // and return empty rect so that the original title view is hidden
    return CGRectZero;
} 
```

[我确实花时间在这里](http://unsolicitedfeedback.com/2009/03/09/how-to-set-a-multi-line-title-in-uibutton)写了更多关于此的内容。在那里，我还指出了一个较短的解决方案，尽管它并不完全适合所有场景并且涉及一些私人视图黑客攻击。此外，您还可以下载一个可供使用的 UIButton 子类。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2013-05-01T18:45:41.753

如果您在 iOS 6 上使用自动布局，您可能还需要设置`preferredMaxLayoutWidth`属性：

```
button.titleLabel.lineBreakMode = NSLineBreakByWordWrapping;
button.titleLabel.textAlignment = NSTextAlignmentCenter;
button.titleLabel.preferredMaxLayoutWidth = button.frame.size.width; 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-11-17T07:12:59.827

如今，如果您真的需要在界面构建器中逐个访问这种东西，您可以使用如下简单的扩展来实现：

```
extension UIButton {
    @IBInspectable var numberOfLines: Int {
        get { return titleLabel?.numberOfLines ?? 1 }
        set { titleLabel?.numberOfLines = newValue }
    }
} 
```

然后，您可以简单地将 numberOfLines 设置为任何 UIButton 或 UIButton 子类的属性，就好像它是一个标签一样。对于其他许多通常无法访问的值也是如此，例如视图层的角半径，或者它投射的阴影的属性。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2019-04-29T04:54:53.240

在**Swift 5.0**和**Xcode 10.2中**

```
//UIButton extension
extension UIButton {
     //UIButton properties
     func btnMultipleLines() {
         titleLabel?.numberOfLines = 0
         titleLabel?.lineBreakMode = .byWordWrapping
         titleLabel?.textAlignment = .center        
     }
} 
```

在像这样的**ViewController**调用中

```
button.btnMultipleLines()//This is your button 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2020-03-04T18:28:33.783

**要将标题标签的间距固定到按钮，请在 setTitle之前**设置 titleEdgeInsets 和其他属性：

```
 let button = UIButton()
    button.titleLabel?.lineBreakMode = .byWordWrapping
    button.titleLabel?.numberOfLines = 0
    button.titleEdgeInsets = UIEdgeInsets(top: 10, left: 10, bottom: 20, right: 20)
    button.setTitle("Dummy button with long long long long long long long long title", for: .normal) 
```

PS 我测试了设置 titleLabel?.textAlignment 不是必需的，并且标题在`.natural`.

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2011-05-11T10:04:58.020

它完美地工作。

添加与 Plist 等配置文件一起使用，您需要使用 CDATA 编写多行标题，如下所示：

```
<string><![CDATA[Line1
Line2]]></string> 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-12-09T10:55:27.320

如果您使用自动布局。

```
button.titleLabel?.adjustsFontSizeToFitWidth = true
button.titleLabel?.numberOfLines = 2 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-03-25T12:50:04.153

迅捷4.0

```
btn.titleLabel?.lineBreakMode = .byWordWrapping
btn.titleLabel?.textAlignment = .center
btn.setTitle( "Line1\nLine2", for: .normal) 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-03-10T13:16:10.243

滚动你自己的按钮类。从长远来看，这是迄今为止最好的解决方案。UIButton 和其他 UIKit 类在如何自定义它们方面非常严格。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-06-08T15:34:17.103

在 2021 年的 iOS 15 中，Apple 首次通过[UIButton.Configuration](https://developer.apple.com/documentation/uikit/uibutton/configuration) API 正式支持多行 UIButtons。

> ### [UIButton.Configuration](https://developer.apple.com/documentation/uikit/uibutton/configuration)
> 
> 指定按钮及其内容的外观和行为的配置。

[![UIButton.Configuration](https://i.stack.imgur.com/KW92R.png)](https://i.stack.imgur.com/KW92R.png)

这个新的 API[在 UIKit 中的新功能](https://developer.apple.com/videos/play/wwdc2021/10059/)以及会话中进行了探索：

> ### 满足 UIKit 按钮系统
> 
> 每个应用程序都使用按钮。在 iOS 15 中，您可以采用更新的样式来创建精美的按钮，轻松融入您的界面。我们将探索可以更轻松地创建不同类型按钮的功能，了解如何提供更丰富的交互，并了解如何在使用 Mac Catalyst 时获得出色的按钮。
> 
> [https://developer.apple.com/videos/play/wwdc2021/10064/](https://developer.apple.com/videos/play/wwdc2021/10064/)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-08-03T09:40:40.380

```
self.btnError.titleLabel?.lineBreakMode = NSLineBreakMode.byWordWrapping

self.btnError.titleLabel?.textAlignment = .center

self.btnError.setTitle("Title", for: .normal) 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-05-05T23:27:21.537

我在[STAButton中合并了](https://github.com/Stunner/STAControls/blob/master/STAControls/STAControls/Button/STAButton.h)[jessecurry 的答案](https://stackoverflow.com/a/1829420/347339)，这是我的[STAControls](https://github.com/Stunner/STAControls)开源库的一部分。我目前在我正在开发的一个应用程序中使用它，它可以满足我的需求。随意打开有关如何改进它的问题或向我发送拉取请求。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2020-08-09T20:18:34.563

添加按钮约束和子视图。这就是我在我的项目中的做法，让我们说这样更容易。我实际上 99% 的时间都以编程方式制作所有内容。因为这对我来说更容易。情节提要有时可能会出现问题 [1]：[https ://i.stack.imgur.com/5ZSwl.png](https://i.stack.imgur.com/5ZSwl.png)

* * *

## 回答 #30

> 赞同：-4
> 
> 时间：2009-03-03T12:04:43.500

尽管可以将子视图添加到控件中，但不能保证它会真正起作用，因为控件可能不希望它在那里，因此可能表现不佳。如果你能摆脱它，只需将标签添加为按钮的兄弟视图并设置其框架，使其与按钮重叠；只要它被设置为出现在按钮的顶部，按钮就无法做任何事情来掩盖它。

换句话说：

```
[button.superview addSubview:myLabel];
myLabel.center = button.center; 
```

# perl - 如何在 Perl 脚本中加密或隐藏密码？

> ID：604634
> 
> 赞同：9
> 
> 时间：2009-03-03T00:23:58.520
> 
> 标签：perl, encryption, passwords, expect

我正在研究使用[Expect](http://search.cpan.org/dist/Expect)通过 telnet 登录到远程机器的 Perl 脚本（不要问，必须使用 telnet）。我还根据需要执行 p4 登录操作，并使用 expect 来输入正确的密码。现在我只是从明文环境变量 ie 中读取密码`export PASSWORD=password`，我知道这在安全方面并不好。

对于像这样的脚本需要大量密码用于多个系统，存储密码的最佳方法是什么？以某种方式加密在文本文件中？或者是其他东西？

请记住，我无法轻易更改现有系统，例如我无法真正安装 SSH 或类似的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T00:28:44.763

可能您最好的方法是将密码放在单独的文件中，并锁定该文件的安全性，以便只有您具有读取权限。不幸的是，如果您在脚本中存储了加密密码，您还必须存储解密方法，以便攻击者可以运行解密并恢复您的密码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T04:13:20.963

之前有一个非常相似的问题，请参阅[我的回答](https://stackoverflow.com/questions/559611/password-storage-in-source-control/559633#559743)。

简而言之，人类必须启动信任链。其他一切都是混淆。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T00:33:22.257

如果您使用 telnet，为什么还要担心脚本中的密码？一个假定的攻击者会发现从网络上捕获数据比从远程机器上捕获数据更容易或更容易，而且在任何情况下你都无能为力。

这听起来像是试图在窗户上放上铁栏并让门一直打开的情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T00:28:22.470

由于您已经在使用 expect，您应该考虑能够在包含您的密码的加密文件上重定向 gpg -d。在系统环境变量中存储密码是完全错误的。用于解密 gpg 文件的密码将在启动时输入，然后从文件中加载所有密码并运行您的东西。然后你就完成了，所以密码只在应用程序运行时以明文形式存在。

**编辑**只是附带说明，将任何密码放在脚本中都是不好的；请记住，该脚本只是一个纯文本文件，它可以让您轻松查看密码。同样，即使您编译的应用程序也可以用“字符串”反转，它可以查找代码中包含的字符串（通常是密码）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-21T19:39:47.160

如果您使用的是 Mac OS X，我发现[了这种从您的 Keychain 中获取用户名和密码的好方法](http://www.maclovin.de/2010/02/access-os-x-keychain-from-terminal/)。

**更新**：截至 2013 年 7 月 22 日，该链接似乎已断开。以下 bash 代码片段显示了我如何使用该技术（下载 iTunes 销售数据）：

```
domain="itunesconnect.apple.com"
user="user@example.com"
pass=$(security find-internet-password -ws $domain -a $user) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T04:48:36.210

我喜欢已经提到的将密码放在单独的文件中的解决方案。此外，您可以散列实际密码，就像在 /etc/passwd 中所做的那样。尽管您可能对所有这些都使用相同的哈希键，具体取决于您的应用程序。显然，这样做的缺点是有人必须输入哈希键才能运行您的脚本，而这在批处理环境中不起作用。

一个开始学习散列的地方是从这个stackoverflow[问题](https://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database/287883#287883)

# php - 不需要大量安装或桌面应用程序的 PHP 控制台？

> ID：604635
> 
> 赞同：3
> 
> 时间：2009-03-03T00:24:04.260
> 
> 标签：php, console

当我想看看发生了什么时，我正在寻找一种干净的方法来打破我目前在 PHP 中使用打印命令的习惯。

我知道诸如 Zend Debugger 之类的选项，但我使用[Coda](http://www.panic.com/coda/)进行开发，而且我对混合其他软件或必须执行服务器命令不感兴趣。我只需要一个可以添加到我的代码库然后打开/关闭的控制台。

这样的事情存在吗？此外，您使用什么以及为什么？

**编辑**：那里有很多东西，但我需要一些更简单的东西，所以我最终自己编写了代码。没过多久（也不是很漂亮），但我已经把它放在[我的服务器](http://www.pieffedesign.com/free/Console.zip)上，供其他感兴趣的人使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-12-27T21:33:19.757

[Google Chrome - PHP Console](https://chrome.google.com/extensions/detail/nfhmhhlpfleoednkpnnnkolmclajemef)有很好的扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T00:36:51.327

您可以将[Xdebug与](http://xdebug.org/)[许多可用选项](http://xdebug.org/docs/remote)中的任何一种结合使用，以查看其调试信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T00:31:30.077

[FirePHP](http://www.firephp.org/)会将您的PHP 日志消息写入 Firebug 控制台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T01:20:43.873

使用尾声？这意味着您使用的是mac。你可能想看看 XDebug 和[http://www.bluestatic.org/software/macgdbp/](http://www.bluestatic.org/software/macgdbp/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T08:47:36.453

> 我知道诸如 Zend Debugger 之类的选项，但我使用 Coda 进行开发，而且我对混合其他软件或必须执行服务器命令不感兴趣。我只需要一个可以添加到我的代码库然后打开/关闭的控制台。

不完全确定我是否理解您的意思，但是您不能[登录到文件](http://www.php.net/manual/en/function.error-log.php)然后运行控制台窗口`tail -f /path/to/log-file.txt`吗？这对我来说效果很好。当然，为此您*确实*需要到服务器的控制台连接。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-20T01:04:08.813

Chrome 有另一个可用的扩展名为 ChromePHP。它比其他一些解决方案简单一点：
[https ://chrome.google.com/webstore/detail/noaneddfkdjfnfdakjjmocngnfkfehhd](https://chrome.google.com/webstore/detail/noaneddfkdjfnfdakjjmocngnfkfehhd)

入门指南位于：http:
[//www.chromephp.com](http://www.chromephp.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T00:41:44.607

在我的开发生涯中，我没有偶然发现显示您在问题中描述的输出的软件。我相信这将是一个很棒的程序或功能，但遗憾的是我还没有找到。

就像 Andrew 和 nickf 回答的那样，那里有一些很好的工具，直到有人坐下来写这个，看起来我们已经被冷落了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-25T08:54:38.987

我一直在寻找类似的解决方案，它不重，甚至更好，我不需要包含任何类，所以我创建了将 php 输出到浏览器控制台的简单**函数**，你可以在这里查看：

*   [将 PHP 输出到浏览器控制台](http://sarfraznawaz.wordpress.com/2012/01/05/outputting-php-to-browser-console/)

![在此处输入图像描述](https://i.stack.imgur.com/DHBKy.gif)

# asp.net-mvc - 在 ASP.NET MVC 中上传多个图像 + 文本字段

> ID：604640
> 
> 赞同：5
> 
> 时间：2009-03-03T00:26:04.473
> 
> 标签：asp.net-mvc, file-upload

我对 ASP.net MVC 很陌生，所以请在你的回答中尽可能描述性:)

让我简化我正在尝试做的事情。想象一下，我有一个表格，您想在其中输入有关汽车的一些信息。这些字段可能是：品牌、型号、年份、Image1、Image2。

表格底部是一个“保存”按钮。关联的 Controller 方法会将 Image1 和 Image2 保存到磁盘，获取它们的文件名并将它们与汽车模​​型相关联，然后将它们保存到数据库中。

有任何想法吗？

多谢你们！

**编辑**

[winob0t](https://stackoverflow.com/questions/604640/uploading-multiple-images-text-fields-in-asp-net-mvc/604720#604720)让我大部分时间都在那里。唯一突出的问题是：Image1 和 Image2 不是必填字段，所以我现在可以保存 0,1 或 2 张图像；但如果用户只上传 1 张图片，我无法知道它是来自 imageUpload1 还是 imageUpload2。

再次感谢任何帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T00:58:25.160

在您的控制器中，您可以通过以下方式访问上传的文件：

```
 if(Request.Files.Count > 0 && Request.Files[0].ContentLength > 0) {
        HttpPostedFileBase postFile = Request.Files.Get(0);
        string filename = GenerateUniqueFileName(postFile.FileName);
        postFile.SaveAs(server.MapPath(FileDirectoryPath + filename));
    }

protected virtual string GenerateUniqueFileName(string filename) {

    // get the extension
    string ext = Path.GetExtension(filename);
    string newFileName = "";

    // generate filename, until it's a unique filename
    bool unique = false;

    do {
        Random r = new Random();
        newFileName = Path.GetFileNameWithoutExtension(filename) + "_" + r.Next().ToString() + ext;
        unique = !File.Exists(FileDirectoryPath + newFileName);
    } while(!unique);
    return newFileName;
} 
```

文本字段将像往常一样到达您的控制器操作，即 Request.Form[...]。请注意，您还需要将表单上的 enctype 设置为“multipart/form-data”。听起来您对 ASP.NET MVC 了解得足够多，可以完成剩下的工作。另请注意，您可以按如下方式在 aspx 视图中声明表单标记，但如果您愿意，可以使用更传统的方法。

```
<% using(Html.BeginForm<FooController>(c => c.Submit(), FormMethod.Post, new { enctype = "multipart/form-data", @id = formId, @class = "submitItem" })) { %> 

<% } %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T06:31:14.393

这是我的解决方案，上面的答案对我的情况不太适用。它不关心表单细节，并允许多次上传。

```
 for (int i = (Request.Files.Count - 1); i >= 0; i--)
    {
          if (Request.Files != null && Request.Files[i].ContentLength > 0)
          {
               string path = this.Server.MapPath("~/Content/images/");
               string filename = Path.GetFileName(Request.Files[i].FileName);
               string fullpath = Path.Combine(path, filename);
               Request.Files[i].SaveAs(fullpath);
           }
     } 
```

# listview - ListView 控件加载非常缓慢

> ID：604643
> 
> 赞同：6
> 
> 时间：2009-03-03T00:27:13.097
> 
> 标签：listview, ms-access, vba, recordset

当 ListView 有超过 15000 个包含 9 个子项的列表时，从查询中填充 ListView 的最快方法是什么。加载大约需要 6 分钟。

这是我为填充 ListView 控件而编写的内容。

```
Set rs = db.OpenRecordset(strSQL, dbOpenForwardOnly, dbReadOnly)

With Me.listViewData
    .View = lvwReport
    .GridLines = True
    .FullRowSelect = True
    .ListItems.Clear
    .ColumnHeaders.Clear
End With
'Set up column headers
With Me.listViewData.ColumnHeaders
    .Add , , "Client", 1440, lvwColumnLeft
    .Add , , "Contact", 2160, lvwColumnLeft
    .Add , , "Quote #", 720, lvwColumnCenter
    .Add , , "Date", 1140, lvwColumnLeft
    .Add , , "GrandTotal", 1440, lvwColumnRight
    .Add , , "Weighted Value", 1440, lvwColumnRight
    .Add , , "Chance %", 500, lvwColumnRight
    .Add , , "Sales Cycle", 1140, lvwColumnRight
    .Add , , "Won Orders", 1000, lvwColumnRight
    .Add , , "SalesRep", 1000, lvwColumnRight
End With

While Not rs.EOF
    Set lstItem = Me.listViewData.ListItems.Add()
    lstItem.Text = Nz(rs!Name, "")
    lstItem.SubItems(1) = Nz(rs!Company, "")
    lstItem.SubItems(2) = Nz(rs!QuoteNumber, "")
    lstItem.SubItems(3) = Nz(rs!OrderDate, "")
    lstItem.SubItems(4) = Nz(Format(rs!GrandTotal, "Currency"), "0.00")
    lstItem.SubItems(5) = Nz(Format(rs!GrandTotal * rs!Customfield1 / 100, "Currency"), "")
    lstItem.SubItems(6) = Nz(rs!Customfield1, "")
    lstItem.SubItems(7) = Nz(rs!Date1, "none")
    lstItem.SubItems(8) = Nz(rs!Detail, "")
    lstItem.SubItems(9) = Nz(rs!CustomT1, Nz(rs!UserID, ""))

    For I = 1 To Me.listViewData.ColumnHeaders.Count - 1
        Set sb = lstItem.ListSubItems(I)
        If rs!Customfield1 = 100 Or Not IsNull(rs!List) Then
            sb.ForeColor = vbBlue
            lstItem.ForeColor = vbBlue
        ElseIf rs!Cancelled = -1 Then
            sb.ForeColor = vbRed
            lstItem.ForeColor = vbRed
        Else
            sb.ForeColor = vbBlack
            lstItem.ForeColor = vbBlack
        End If
        DoEvents
    Next
    rs.MoveNext
Wend 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T00:41:26.683

首先你应该做的是摆脱“doevents”，这是一个真正的性能杀手。

您是否必须动态加载列表视图？为什么不直接将其绑定到数据源？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:50:17.067

我能想到几件事：

While...Wend 是一种较慢的循环机制；使用 For...Next。For...Next 更快——即使您必须运行另一个命令来获取 RecordCount。这就是我使用的：

```
With rs
  If .RecordCount > 0 Then
    '-- MoveLast...MoveFirst will update the .RecordCount; depending on the type of DAO Recordset, RecordCount might only return "1" when there are more than that.
    .MoveLast
    .MoveFirst

    For lngCounter = 1 To .RecordCount
      '-- Code to add ListItems here

      .MoveNext
    Next lngCounter
  End If
  .Close
End With 
```

使用 With...End With 添加您的子项：

```
With Me.listViewData.ListItems.Add
  .Text = Nz(rs!Name, "")
  .SubItems(1) = Nz(rs!Company, "")
  .SubItems(2) = Nz(rs!QuoteNumber, "")
  .SubItems(3) = Nz(rs!OrderDate, "")
  .SubItems(4) = Nz(Format(rs!GrandTotal, "Currency"), "0.00")
  .SubItems(5) = Nz(Format(rs!GrandTotal * rs!Customfield1 / 100, "Currency"), "")
  .SubItems(6) = Nz(rs!Customfield1, "")
  .SubItems(7) = Nz(rs!Date1, "none")
  .SubItems(8) = Nz(rs!Detail, "")
  .SubItems(9) = Nz(rs!CustomT1, Nz(rs!UserID, ""))
End With 
```

将填充器代码包装在：

```
DoCmd.Echo False

'-- Populate code

DoCmd.Echo True 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T09:23:57.817

检查 Listview 控件的方法，例如 beginupdate / endupdate 或将 refresh 设置为 false（如果可能）。这意味着在添加每个项目后，UI 不会尝试刷新屏幕，从而使添加速度更快。

Listview 控件旨在获取大量项目，因此应该可以通过一些挖掘来实现。

# apache-flex - 在服务器上使用 Pojo 的 Flex 示例

> ID：604646
> 
> 赞同：0
> 
> 时间：2009-03-03T00:27:50.600
> 
> 标签：apache-flex, blazeds, pojo

我刚刚开始了一个新项目，我的老板希望我们将 IDE 从 NetBeans 更改为 Eclipse，将 RichFaces 更改为 Flex。我以前从未使用过 Eclipse 和 Flex。今天我试图在 Eclipse 上用它打招呼，但没有运气。有人可以发帖或给我链接到 Flex->BlazeDS->Pojo on Eclipse for Beginner (Dummy) :D 谢谢

**更新：**忘了提到我正在使用 glassfish 但我认为它不会产生任何问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:52:11.197

这似乎是一个很好的教程：[Set up blazeds on tomcat with eclipse for FLEX](http://techmytongue.blogspot.com/2008/11/set-up-blazeds-on-tomcat-with-eclipse.html)。这是他们使用的 POJO：

```
package test;

public class tester {
public String getData() {
return "hi";
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T07:44:33.560

它不涉及 BlazeDS 或 Pojo，但 Adob​​e为 Flex 和 Flex Builder提供了[一系列出色的免费培训视频。](http://www.adobe.com/devnet/flex/videotraining/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-02T10:45:37.343

我推荐这本书：[Beginning Java Flex](https://rads.stackoverflow.com/amzn/click/com/1430223855)，它让我在几天内上手，是一本关于 flex、blazeds、spring 和 hibernate 的很好的介绍，并且易于阅读。它会引导您了解每个部分的一些示例。

# .net - 安装顺序：Sharepoint ajax 和 .NET 3.5 ajax

> ID：604665
> 
> 赞同：0
> 
> 时间：2009-03-03T00:37:15.320
> 
> 标签：.net, sharepoint, .net-3.5, asp.net-ajax, sharepoint-2007

据我所知，Sharepoint 2007 使用带有 System.Web.Extensions 1.0 的 ASP.NET Ajax 1.0，而我正在使用 VS2008 SP1 和 .NET 3.5 SP1（包括 System.Web.Extensions 3.5）创建 webpart。

那么安装顺序是什么？如何安装才能使两个版本都正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T00:40:01.600

我们正在使用 3.5 SP1 开发 Web 部件并将它们部署到 SP2007，没有任何问题。只需在 SP2007 服务器上安装 3.5 SP1 即可。

# browser - 埃林克斯还是猞猁？

> ID：604666
> 
> 赞同：42
> 
> 时间：2009-03-03T00:38:50.497
> 
> 标签：browser, lynx, text-based, elinks

请说明您使用终端浏览器的原因。你为什么使用 Lynx 或 Elinks？它们如何帮助您进行编程？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-03T00:49:36.210

如果您问我更喜欢哪个以获得更完整的浏览体验，我更喜欢 Elinks。它具有标签式浏览、下载/密码管理和标签式导航（在终端中很方便）。它还（部分）支持 CSS 2.1，（完全）支持框架。它还（部分）支持 JavaScript。没那么重要，但 Elinks 支持的协议比 Lynx 多（我专门使用 Bittorrent 协议）。

如果你问哪个更适合测试纯文本浏览器，Lynx 可能更受欢迎，但 Elinks 在这里也是一个不错的选择。

比较看[这里](https://en.m.wikipedia.org/wiki/Comparison_of_lightweight_web_browsers)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-14T11:38:37.087

Quoting from [*A comparison of text-based browsers.*](http://kmandla.wordpress.com/2011/01/13/a-comparison-of-text-based-browsers/) This text contains reviews and screen shots of six text-based browsers.

> Lynx does a lot of the things elinks does, and does a fairly quick and clean job doing it.
> 
> I found only one options page and it is very easy to navigate. In fact, one of the things I liked best about lynx was it’s flat approach to configuration. Everything is right there, and easy to control.
> 
> That being said, lynx probably has the most configuration options at the command line of all the six listed here. Looking over the --help list, it seems like just about anything can be turned on or off … even turning things on or off.

## Screen-shot of lynx

![lynx](https://i.stack.imgur.com/ND4QM.png)

## Screen-shot of elinks

![elinks](https://i.stack.imgur.com/P9PT3.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-27T11:49:00.980

This is a complement of [Nick Presta's answer](https://stackoverflow.com/a/604699/938111).

There are [ten text-based web browsers listed on Wikipedia](http://en.wikipedia.org/wiki/Text-based_web_browser). The three most active are:

1.  [**`elinks`**](http://en.wikipedia.org/wiki/ELinks) is the active version of [**`links`**](http://en.wikipedia.org/wiki/Links_(web_browser)). Its [Git repo](http://repo.or.cz/w/elinks.git) is alive ([six 0.12 beta versions since July 2008](http://www.elinks.cz/news/2008.html)) but last stable release is old ([0.11.7 in August 2009](http://www.elinks.cz/news.html)).

2.  [**`lynx`**](http://en.wikipedia.org/wiki/Lynx_%28web_browser%29) is a bit more active than `elinks` and last stable release is almost as old ([2.8.7rel.2 in June 2010](http://lynx.isc.org/current/index.html#release_top)). The [RCS/PRCS](http://en.wikipedia.org/wiki/Revision_Control_System) repository is not public but you can check activity of the [lynx-dev mailing list](http://lists.gnu.org/archive/html/lynx-dev/).

3.  [**`w3m`**](http://en.wikipedia.org/wiki/W3m) can display pictures on xterm and can handle table, cookies, authentication, and almost everything except JavaScript. [Last stable release](http://sourceforge.net/projects/w3m/files/w3m/) is not so old (0.5.3 in January 2011) but [CVS repo](http://w3m.cvs.sourceforge.net/viewvc/w3m/w3m/?sortby=date) is sleeping.

See also [findthebest.com](http://web-browsers.findthebest.com/compare/8-18-25-26/w3m-vs-ELinks-vs-Lynx-vs-Links) that compares software based on their technical data.

While testing these browsers through a proxy (using `http_proxy=http://user:pwd@host:port/`) I have been pleased to see that **`lynx`** requested for `user` and `password` so you can avoid putting them on `http_proxy`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T00:41:03.953

我将它们用作粗略的视觉隐喻，以说明使用屏幕阅读器的感觉。当我解决可访问性问题时，当我无法访问屏幕阅读器时，我会使用 Lynx 检查页面。

为什么我要使用 Lynx？因为我不知道任何替代方案！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T00:51:02.620

CLI Web 浏览器有时仍然明显快于 GUI 浏览器。

More importantly, they're also more distraction-free (no images, JavaScript, Flash, etc.), in much the same vein as apps like [WriteRoom](http://www.hogbaysoftware.com/products/writeroom).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T00:52:04.647

Two reasons for using lynx:

1.  It's a great way to see a lower-level of the HTTP transaction going on with the server (though, of course, you can do this with curl and such tools, but it's a pain to post forms in those tools :-) ).
2.  I can test whether or not my HTML really holds up to a lesser browsing experience where users have images turned off... I can verify that the ALT tags make sense, etc.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T00:48:04.343

Lynx，因为有时我想在不被 GUI 吸引的情况下查找一些东西。但这些年来它变得越来越不频繁，因为启动 X 的缓慢但稳定增加的开销未能跟上摩尔的死亡行军的性能。

在这一点上，我几乎保持一个 GUI 外壳，甚至不担心它。

——马库斯

# java - 解决餐饮哲学家的另一种方法（需要指向正确的方向）

> ID：604667
> 
> 赞同：2
> 
> 时间：2009-03-03T00:39:20.963
> 
> 标签：java, multithreading, dining-philosopher

对于一项编程任务，我被要求实施解决餐饮哲学家问题的方法。我必须以两种方式这样做：

1.  使用 wait() 和 notifyAll() 机制
2.  使用 Java API 中提供的现有并发数据结构

我已经完成了第一个实现。我的教授在第二步谈论哪种并发数据结构？我不记得她提过什么。我不需要任何源代码，只需要一个指向正确方向的指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T00:46:19.837

您可能想查看[java.util.concurrent](http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html) Javadoc 页面以获得一些想法。这些不是唯一的并发数据结构（一些 java.util 数据结构也有内置的并发支持），但这是一个很好的起点。

`Collections.synchronizedList`不是我所说的“现有并发数据结构”——它是不支持并发的数据结构的包装器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T00:45:20.043

也许她的意思是在同步包装器中包装 Java 集合，例如使用`Collections.synchronizedList()`，或者在 中始终同步的数据结构`java.util.concurrent`，例如`CopyOnWriteArrayList`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T00:47:14.860

不是真正的数据结构......但在你可能需要的附近[http://java.sun.com/javase/6/docs/api/java/util/concurrent/Semaphore.html](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Semaphore.html)？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T00:47:37.043

Java API 中有一个并发库。

它有一些收藏

查看 java.util.concurrent 包

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html)

# javascript - 雅虎压缩器

> ID：604669
> 
> 赞同：2
> 
> 时间：2009-03-03T00:39:57.310
> 
> 标签：javascript, yui, yui-compressor

有人知道如何在我的网站上应用 Yahoo Compressor（YUI 压缩器）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T00:43:43.730

这是 YUI Compressor 的[README](http://www.julienlecomte.net/yuicompressor/README)。这是他们网站上的[如何使用](http://developer.yahoo.com/yui/compressor/#using)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T00:45:53.163

您需要使用 YUI 压缩器来压缩您的`.js`和`.css`文件，然后再将它们放到服务器上。由于压缩器是用Java编写的，所以需要运行java文件进行压缩。[这是从YUI web](http://developer.yahoo.com/yui/compressor/)复制的：

从命令行使用 YUI Compressor

```
$ java -jar yuicompressor-x.y.z.jar

Usage: java -jar yuicompressor-x.y.z.jar [options] [input file] 
```

以下命令行（xyz 代表版本号）：

```
java -jar yuicompressor-x.y.z.jar myfile.js -o myfile-min.js 
```

将缩小文件`myfile.js`并输出文件`myfile-min.js`。有关如何使用 YUI 压缩器的更多信息，请参阅存档中包含的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T00:43:52.417

您使用 YUI 压缩器在将 javascript 文件加载到您的网站之前对其进行压缩，从而创建较小的下载。它不用于动态压缩。查找 Http 压缩模块或在您的网络服务器上启用压缩。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T00:44:29.827

它的文档在[这里](http://developer.yahoo.com/yui/compressor/)。你用它来压缩/缩小你的 JavaScript 和 CSS 文件。如果您对加快网站速度感兴趣，也可以试试[YSlow](http://developer.yahoo.com/yslow/)。

# sql - SQL 查询连接

> ID：604677
> 
> 赞同：0
> 
> 时间：2009-03-03T00:42:36.447
> 
> 标签：sql, join

我有一个名为 tblIssueTicket 的表 tblIssueTicket 包含以下字段：TicketID、TicketRequesterID、ApprovalManagerID、RequestDate、ApprovalDate、TicketStatus

还有一个名为 tblEmployeeProfile 的表。tblEmployeeProfile 包含字段 EmployeeID、EmployeeFirstName、EmployeeLastName

我需要显示以下记录：

> TicketID、TicketRequesterFullName、ApprovalManagerFullName、RequestDate、ApprovalDate、TicketStatus

我在弄清楚查询以返回 TicketRequester 的全名和 ApprovalManager 字段的全名时遇到问题。

到目前为止，我的查询如下所示：

```
Select it.TicketID,
    ep.Firstname + ' ' + ep.EmployeeLastName AS TicketRequestorFullName,
    it.RequestDate, it.ApprovalDate, it.TicketStatus
FROM    tblIssueTicket it, tblEmployeeProfile ep
WHERE   ep.EmployeeID = it.TicketRequesterID 
```

任何建议将不胜感激。

谢谢

厘米

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T00:48:07.057

```
SELECT
  it.TicketID,    
  ep.Firstname + ' ' + ep.EmployeeLastName AS TicketRequestorFullName,    
  mp.Firstname + ' ' + mp.EmployeeLastName AS ApprovalManagerFullName,    
  it.RequestDate, 
  it.ApprovalDate, 
  it.TicketStatus
FROM    
  tblIssueTicket it
  INNER JOIN  tblEmployeeProfile ep ON ep.EmployeeID = it.TicketRequesterID
  INNER JOIN  tblEmployeeProfile mp ON mp.EmployeeID = it.ApprovalManagerID 
```

# silverlight - XDocument.Descendants() 不返回任何元素

> ID：604680
> 
> 赞同：17
> 
> 时间：2009-03-03T00:43:44.790
> 
> 标签：silverlight, wcf-binding, linq-to-xml

我正在尝试将 Silverlight DataGrid 绑定到 WCF 服务调用的结果。我没有看到网格中显示的数据，所以当我运行调试器时，我注意到 XDocument.Descendants() 没有返回任何元素，即使我传入了一个有效的元素名称。以下是从服务传回的 XML：

```
<ArrayOfEmployee xmlns="http://schemas.datacontract.org/2004/07/Employees.Entities" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <Employee>
    <BirthDate>1953-09-02T00:00:00</BirthDate>
    <EmployeeNumber>10001</EmployeeNumber>
    <FirstName>Georgi</FirstName>
    <Gender>M</Gender>
    <HireDate>1986-06-26T00:00:00</HireDate>
    <LastName>Facello</LastName>
  </Employee>
  <Employee>
    <BirthDate>1964-06-02T00:00:00</BirthDate>
    <EmployeeNumber>10002</EmployeeNumber>
    <FirstName>Bezalel</FirstName>
    <Gender>F</Gender>
    <HireDate>1985-11-21T00:00:00</HireDate>
    <LastName>Simmel</LastName>
  </Employee>
</ArrayOfEmployee> 
```

这是我用来将结果加载到匿名对象集合中的方法，使用 Linq to XMl，然后将集合绑定到网格。

```
void client_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs args)
{
    if (args.Error != null) return;
    var xml = XDocument.Parse(args.Result);
    var employees = from e in xml.Descendants("Employee")
                    select new
                    {
                        EmployeeNumber = e.Element("EmployeeNumber").Value,
                        FirstName = e.Element("FirstName").Value,
                        LastName = e.Element("LastName").Value,
                        Birthday = e.Element("BirthDate").Value
                    };
    DataGrid.SelectedIndex = -1;
    DataGrid.ItemsSource = employees;
} 
```

知道为什么`xml.Descendants("Employee")`不返回任何东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-03T01:05:06.877

传递给 Descendents 的字符串参数实际上已隐式转换为 XName 对象。XName 表示完全限定的元素名称。

该文档定义了一个命名空间“i”，因此我认为您需要使用完全限定名称来访问 Employee。IE。i:Employee，其中前缀“i: 实际上解析为完整的命名空间字符串。

您是否尝试过类似的方法：

```
XName qualifiedName = XName.Get("Employee", "http://www.w3.org/2001/XMLSchema-instance");

var employees = from e in xml.Descendants(qualifiedName)

... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-16T14:17:47.160

您不包括来自父元素的命名空间：

```
XNameSpace ns = "http://schemas.datacontract.org/2004/07/Employees.Entities";
foreach (XElement element in xdoc.Descendants(ns + "Employee")
{
    ...
} 
```

# vb6 - 终端服务器中的 VB 6.0 为非管理员用户启动“准备安装”Windows 安装程序

> ID：604707
> 
> 赞同：0
> 
> 时间：2009-03-03T00:53:00.383
> 
> 标签：vb6, windows-installer, rdp

这似乎是一个 IT 问题，但我问过的大多数 IT 人员都无法帮助我。在我工作的地方，我们有一个**Windows 2003 服务器**，几个开发人员通过 RDP 进行连接。我们降低了其中一些人的权限（他们是管理员）。现在，当他们启动**Visual Basic 6.0**时，他们会看到 Windows Installer“准备安装”对话框。它在大约 2 分钟后消失，但这是一个烦恼和浪费时间。我尝试了几件事，包括在 system32 和 dllcache 中重命名***msi.dll***，让开发人员完全控制注册表和***c:\Program Files***，但似乎没有任何效果。

任何帮助，将不胜感激。

谢谢

纳尔逊马尔莫尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T03:19:47.053

我会尝试改变他们启动 VB 的方式。创建一个指向 vb6.exe 的链接并使用该链接而不是安装程序创建的现有链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T01:10:45.380

在服务器上启动[ProcessMonitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，为特定用户登录设置过滤器，然后让他们正常登录。这可能会向您显示在尝试访问特定文件时哪些权限失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T21:56:43.733

重命名/杀死 msi.dll 并不能解决此类问题的原因，这只是掩盖了问题。

通常有两种可能的原因：

1.  终端服务器中的某些驱动器，非特权用户无法访问 - 有助于允许对该驱动器根文件夹进行读取访问；

2.  一些错误安装的组件（上次对我来说是 mscomctl32.ocx），什么是可发现的调查事件日志（虽然通常只记录丢失组件的 GUID，但要找到丢失/错误注册的真实文件并不总是那么容易）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-26T20:53:13.620

此处提供的解决方案均未解决该问题。谢谢你的帮助。经过一番研究，我在一篇文章中找到了这个步骤，这解决了问题： 1）转到 C:\Windows\System32 文件夹，然后查找 msi.dll。

2) 将 msi.dll 重命名为任何其他名称。

3) 转到 C:\Windows\System32\dllcache 文件夹，并重命名**msi.dll**。

如果您没有执行此步骤，System32 文件夹中的 msi.dll 将自动重新创建。

如果找不到此 dllcache 文件夹，您可能需要更改文件夹选项中的属性。

在 Windows 资源管理器中 --> 转到工具菜单 --> 选择文件夹选项 --> 单击查看选项卡 --> 取消选中选项“**隐藏受保护的操作系统文件（推荐）** ”。

4) 启动 VB6，现在您可以启动 VB6 而不会收到错误消息。

5) 将文件重命名为System32 文件夹和**dllcache文件夹中的****msi.dll**。

 **# .net - 为动态添加的 ToolStripItem 更改 ToolStripPanel 溢出行为

> ID：604713
> 
> 赞同：2
> 
> 时间：2009-03-03T00:56:57.660
> 
> 标签：.net, winforms, toolstrip, toolstrippanel

我有一个 Windows 窗体 ToolStripPanel，我会动态地向它添加新的 ToolStrips。每个 ToolStrip 都有我动态添加到其中的 ToolStripItems（主要是 ToolStripButtons）。

只要您可以看到每个 ToolStrip 中的所有 ToolStripItem，我希望所有 ToolStrip 都放在一行上。如果将新 ToolStripItem 添加到 ToolStrip 导致发生溢出，我希望行尾的 ToolStrip 跳到新行。我唯一希望看到溢出按钮的情况是 ToolStrip 有太多项目以致无法适应表单的宽度。

我希望这是默认行为，除非用户手动移动 ToolStrip。如果用户移动 ToolStrip，那么我希望发生现有的溢出（例如，带有下拉选项的溢出按钮）行为。如果用户自己定位工具栏，我假设用户会接受这种默认的 Winforms 溢出行为。

如果在用户重新定位事物后添加了新的动态工具栏，我希望将新工具栏添加到底行最后一个 ToolStrip 的右侧。在用户手动重新定位它之前，该工具栏应该具有更新的溢出行为（例如，如果无法容纳，则使用新行）。

我做了一些研究但没有取得很大成功：

*   这似乎应该是更改[ToolStripLayoutStyle](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstriplayoutstyle.aspx)的简单问题，但事实并非如此。（充其量，当溢出按钮显示在给定行中的所有工具条上时，会创建新行）。
*   MSDN 文章“[如何：在 Windows 窗体中管理 ToolStrip 溢出](http://msdn.microsoft.com/en-us/library/2z69s2kh(VS.80).aspx)”似乎仅涵盖溢出按钮是否/何时发生。
*   ToolStrip 上有一个[LayoutCompleted](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstrip.layoutcompleted.aspx)事件，似乎可以用来调整东西，似乎应该有一个更简单的方法。
*   [创建自定义 LayoutEngine](https://stackoverflow.com/questions/403769/trying-to-add-a-toolstrip-to-a-toolstrippanel-side-by-side-with-an-existing-tools)似乎有点过头了，因为内置的 LayoutEngine 非常接近我想要做的。

我错过了一个简单的解决方案吗？

更新：仍在寻找一个好的解决方案。似乎 LayoutCompleted 路线是可能的。但它的问题是它被多次调用。有一次它说 ToolStripItem 位于溢出区域，然后立即位于 Main 区域，因此仅检查一次是否溢出似乎并不安全。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T02:59:03.930

1）将项目添加到工具条

2) 将工具条的宽度与最后一行剩余的空间量进行比较。ToolStripPanel 有一个 Rows[] 属性，它将告诉您最后一行是什么以及该行上有哪些工具条。将它们的宽度相加，然后从面板的宽度中减去它们。

3) 使用 Join 方法将新工具条添加到面板，指定最后一行（如果合适）或高一行（如果不合适）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T15:30:35.117

最后，我认为没有一个很好的简单解决方案。[该线程](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/c6b66dba-0da0-451e-868e-d921c4d563db/)清楚地表明，ToolStrips 并不是真正为动态场景而设计的。

一种独特的方法是将 ToolStrip 的[MinimumSize](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/c6b66dba-0da0-451e-868e-d921c4d563db/)设置为所有按钮的大小。就像我描述的那样，这将开始与溢出一起工作，但即使这样也有边缘情况的问题。

我发现的最佳方法是尽一切可能提前了解工具栏的大小，然后使用[Join](http://msdn.microsoft.com/en-us/library/ms161023.aspx)方法将其放置在 ToolStripPanel 上。如果您提前做出合理的猜测，那么稍后添加更多按钮可能没问题，因为它们最终会出现在溢出区域中。

# c# - 重命名显示列表的 DataGridView 列的最简单方法是什么 ?

> ID：604716
> 
> 赞同：2
> 
> 时间：2009-03-03T00:58:08.670
> 
> 标签：c#, .net, list, datagridview

我有一个 DataGridView，我将其 DataSource 设置为`List<T>`. `T`在这种情况下，是一个具有名为 的属性的类，`Foo`我想将其标题显示为`Foo bar`。

如果它是一个数据表，我可以更改查询：

```
select Foo as [Foo bar] from Baz 
```

但是有了这样的东西，我将 DataGridView 的 DataSource 设置为`List<Baz>`：

```
public class Baz {
   public string Foo { get; set; }
} 
```

我无法将“ `Foo`”重命名为“ `Foo bar`”，因为它包含空格。我是否必须手动重命名 DataGridViewColumn？

最棒的事情是如果我可以使用类装饰器，就像这样：

```
public class Baz {
   [DataGridViewColumnTitle("Foo bar")]
   public string Foo { get; set; }
} 
```

但据我所知，标准库中不存在这样的东西。

我最好的选择是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T01:22:51.263

```
[DisplayName("Foo bar")] 
```

（在 System.ComponentModel 命名空间中；[MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.displaynameattribute.aspx)）

# asp.net - Windows 身份验证提示输入用户名/密码

> ID：604718
> 
> 赞同：9
> 
> 时间：2009-03-03T00:58:16.220
> 
> 标签：asp.net, windows, security, authentication

我正在尝试使用 AD/域控制器在客户端网络中部署应用程序。

我的应用程序是一个简单的 asp.net c# 应用程序，使用 Windows 身份验证。

我用的是win2003。

基本上，使用VS2008，创建一个新网站，托管在IIS6.0上。只有2个变化。1\. 在应用程序的 IIS 目录安全性上，启用“集成安全性”。
注意：匿名也被启用。

生成的骨架代码只有一处更改。在 default.aspx 的 page_load 方法中添加以下内容

```
using System.Security.Principal;
...
protected void Page_Load(object sender, EventArgs e)
{
    WindowsIdentity id = WindowsIdentity.GetCurrent();
    Response.Write("<B>Windows Identity Check</B><br>");
    Response.Write("Name: " + id.Name + "<br>");
    Response.Write("<BR>");
    Response.Write("User.Identity: " + User.Identity.Name);
    Response.Write("<BR>");
} 
```

浏览到页面的输出： **Windows 身份检查 - 名称：** NT AUTHORITY\NETWORK SERVICE **User.Identity：**

User.Identity.Name 不输出当前用户名。

如本文所述[http://weblogs.asp.net/scottgu/archive/2006/07/12/Recipe_3A00_-Enabling-Windows-Authentication-within-an-Intranet-ASP.NET-Web-application.aspx](http://weblogs.asp.net/scottgu/archive/2006/07/12/Recipe_3A00_-Enabling-Windows-Authentication-within-an-Intranet-ASP.NET-Web-application.aspx)

我补充说：

```
<authorization>
    <deny users="?"/>
</authorization> 
```

从我的用户立场来看，当它被添加时，我可以从 User.Identity.Name 获取当前用户，用户名。

但是，一旦我添加了上述内容，浏览器现在会提示我输入用户名和密码。一旦我输入它，我就可以使用 User.Identity.Name 来获取用户名。但是我不希望弹出用户名/密码。我希望应用程序根据用户的网络凭据对用户进行身份验证。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-20T02:53:00.277

您在 IIS 中的配置不正确 - 关闭匿名访问，然后集成身份验证将启动，假设您还在 web.config 中通过

```
<configuration>
    <system.web>
        <authentication mode="Windows" />
    </system.web>
</configuration> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T20:05:27.520

检查 Internet Explorer 是否知道该站点是本地 Intranet 区域的一部分。此外，在 Intranet 区域的设置下检查是否启用了自动登录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-14T03:41:28.267

您不想更改 we.config 文件中的任何配置。在IS服务器管理器中的站点身份验证中，只启用Windows身份验证，禁用其他身份验证。[在此处输入图像描述](https://i.stack.imgur.com/OJrxC.png)

Windows 身份验证需要您的 =windows 凭据来对用户进行身份验证。这就是提示登录的原因。为避免这种情况，您需要在客户端浏览器中将您的站点 IP 或域设置为可信任的 Intranet 站点。为了那个原因;

1）转到浏览器设置 -> 打开代理设置 -> 安全 -> 本地 Intranet -> 站点 -> 高级

2）然后添加您的站点域或IP地址 [在此处输入图像描述](https://i.stack.imgur.com/IPzmB.png)

现在看看清除浏览器缓存后您的问题是否正常。

这对我有用。:)

检查这个也 [使用集成的 Windows 身份验证接收登录提示](https://stackoverflow.com/questions/5402381/receiving-login-prompt-using-integrated-windows-authentication?rq=1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T04:39:43.413

您的网站使用什么 URL，IE 区域是什么？如果您的应用程序在 LocalIntranet 区域之外运行，则会阻止直通身份验证，始终提示输入用户/密码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T19:48:06.580

IE 的 Internet 选项中是否选择了“启用 Windows 集成身份验证”？

您输入的 IUSR_ 和用户名是否对托管应用程序的目录具有读取和执行权限？

应用程序的目录是驻留在 IIS 服务器上，还是位于 Windows 共享权限将发挥作用的共享上？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-12T10:28:00.417

我认为您无法从服务器应用程序控制它，它是传递凭据的浏览器功能，在 IE 中，您可能会建议您的用户在 Internet 选项->高级中选中“启用 Windows 集成身份验证”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-14T03:34:16.117

您不想更改 we.config 文件中的任何配置。在IS服务器管理器中的站点身份验证中，只启用Windows身份验证，禁用其他身份验证。[在此处输入图像描述](https://i.stack.imgur.com/OJrxC.png)

Windows 身份验证需要您的 =windows 凭据来对用户进行身份验证。这就是提示登录的原因。为避免这种情况，您需要在客户端浏览器中将您的站点 IP 或域设置为可信任的 Intranet 站点。为了那个原因;

1）转到浏览器设置 -> 打开代理设置 -> 安全 -> 本地 Intranet -> 站点 -> 高级

2）然后添加您的站点域或IP地址 [在此处输入图像描述](https://i.stack.imgur.com/IPzmB.png)

现在看看清除浏览器缓存后您的问题是否正常。

这对我有用。:)

# python - 你会如何把它从 Perl 翻译成 Python？

> ID：604721
> 
> 赞同：11
> 
> 时间：2009-03-03T00:59:21.180
> 
> 标签：python, perl

我有一个 Perl 函数，它接受一个时间戳并返回未更改的时间戳（如果它以前从未见过），否则它会附加一些字母以使其唯一：

```
sub uniqify($) {
  my $timestamp = shift;

  state $last_ts = -1;
  state $next_letter = 'A';

  if ($timestamp == $last_ts) {
    $timestamp .= $next_letter++;
  } else {
    $last_ts = $timestamp;
    $next_letter = 'A';
  }

  return $timestamp;
} 
```

因此，如果您调用它四次，使用值 1、1、1 和 2，它将返回 1，然后是 1A，然后是 1B，然后是 2。

注意：它只会以不断增加的时间戳被调用，因此它不需要调用它见过的每一个，只需调用最后一个。

现在我需要把这个函数翻译成 Python。我了解到我可以用全局变量（糟糕！）替换“状态”变量，或者将它们作为属性附加到函数中，但这些都不是特别优雅。

此外，Python 没有类似 Perl 的神奇自动增量功能，如果你“++”一个值为“A”的变量，它变成“B”——或者如果它是“Z”，它变成“AA”。所以这也是一个曲线球。

我正在拼凑一个解决方案，但它真的很丑陋且难以阅读。从 Perl 翻译到 Python 应该会产生相反的效果，对吧？:) 所以我将此作为对 SO 用户的挑战。你能把它变成一个优雅的 Python 函数吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T01:27:41.580

查看[此答案，了解将数字转换为字母数字 id 的可靠方法](https://stackoverflow.com/questions/410485/whats-the-5-character-alphanumeric-id-in-reddit-url/410504#410504)

我提供的代码不是从“Z”变为“AA”，而是变为“BA”，但我想这没关系，它仍然会产生一个唯一的 id

```
from string import uppercase as up
import itertools

def to_base(q, alphabet):
    if q < 0: raise ValueError( "must supply a positive integer" )
    l = len(alphabet)
    converted = []
    while q != 0:
        q, r = divmod(q, l)
        converted.insert(0, alphabet[r])
    return "".join(converted) or alphabet[0]

class TimestampUniqifier( object ):
    def __init__(self):
        self.last = ''
        self.counter = itertools.count()
    def __call__( self, str ):
        if str == self.last:
            suf = self.counter.next()
            return str + to_base( suf, up )
        else:
            self.last = str
            self.counter = itertools.count()
            return str            

timestamp_uniqify = TimestampUniqifier() 
```

用法：

```
timestamp_uniqify('1')
'1'
timestamp_uniqify('1')
'1A'
timestamp_uniqify('1')
'1B'
timestamp_uniqify('1')
'1C'
timestamp_uniqify('2')
'2'
timestamp_uniqify('3')
'3'
timestamp_uniqify('3')
'3A'
timestamp_uniqify('3')
'3B' 
```

您可以随时调用它，它仍然会产生良好的结果：

```
for i in range(100): print timestamp_uniqify('4')

4
4A
4B
4C
4D
4E
4F
4G
4H
4I
4J
4K
4L
4M
4N
4O
4P
4Q
4R
4S
4T
4U
4V
4W
4X
4Y
4Z
4BA
4BB
4BC
4BD
4BE
4BF
4BG
4BH
4BI
4BJ
4BK
4BL
4BM
4BN
4BO
4BP
4BQ
4BR
4BS
4BT
4BU
4BV
4BW
4BX
4BY
4BZ
4CA
4CB
4CC
4CD
4CE
4CF
4CG
4CH
4CI
4CJ
4CK
4CL
4CM
4CN
4CO
4CP
4CQ
4CR
4CS
4CT
4CU
4CV
4CW
4CX
4CY
4CZ
4DA
4DB
4DC
4DD
4DE
4DF
4DG
4DH
4DI
4DJ
4DK
4DL
4DM
4DN
4DO
4DP
4DQ
4DR
4DS
4DT
4DU 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T01:11:36.563

好吧，很抱歉，但你不能只是直接从 Perl 翻译到 Python（包括逐位 Perlisms）并期望结果会更漂亮。不会的，会丑很多。

如果你想要 Python 的漂亮，你将需要使用 Python 习惯用法。

现在对于手头的问题：

```
from string import uppercase

class Uniquifier(object):

    def __init__(self):
        self.last_timestamp = None
        self.last_suffix = 0

    def uniquify(self, timestamp):
        if timestamp == self.last_timestamp:
            timestamp = '%s%s' % (timestamp,
                                  uppercase[self.last_suffix])
            self.last_suffix += 1
        else:
            self.last_suffix = 0
            self.timestamp = timestamp
        return timestamp

uniquifier = Uniquifier()
uniquifier.uniquify(a_timestamp) 
```

更漂亮？也许。更具可读性？大概。

**编辑（重新评论）：**是的，这在 Z 之后失败了，我对这个解决方案完全不满意。所以我不会修复它，但可能会提供更好的东西，比如使用数字代替：

```
timestamp = '%s%s' % (timestamp,
                      self.last_suffix) 
```

如果是我，我会这样做：

```
import uuid

def uniquify(timestamp):
    return '%s-%s' % (timestamp, uuid.uuid4()) 
```

开心就好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T03:05:50.173

我刚刚针对原始 perl 实现测试了最多 1000 次，并且 diff 为两者返回了相同的结果。后缀代码很棘手——这不是一个以 36 为基数的计数器。Hasen J 的解决方案——尽管它产生了一个唯一的时间戳——并不完全相同，因为它从“Z”变为“BA”，而应该改为“AA”以匹配 perl ++ 运算符。

```
#!/usr/bin/python

class uniqify:
    def __init__(self):
        self.last_timestamp = -1
        self.next_suffix = 'A'
        return

    def suffix(self):
        s = self.next_suffix
        letters = [l for l in self.next_suffix]
        if letters[-1] == 'Z':
            letters.reverse()
            nonz = None
            for i in range(len(letters)):
                if letters[i] != 'Z':
                    nonz = i
                    break
            if nonz is not None:
                letters[nonz] = chr(ord(letters[nonz]) + 1)
                for i in range(0, nonz):
                    letters[i] = 'A'
            else:
                letters = ['A'] * (len(letters) + 1)
            letters.reverse()
        else:
            letters[-1] = chr(ord(letters[-1]) + 1)

        self.next_suffix = ''.join(letters)
        return s

    def reset(self):
        self.next_suffix = 'A'
        return

    def __call__(self, timestamp):
        if timestamp == self.last_timestamp:
            timestamp_str = '%s%s' % (timestamp, self.suffix())
        else:
            self.last_timestamp = timestamp
            self.reset()
            timestamp_str = '%s' % timestamp

        return timestamp_str

uniqify = uniqify()

if __name__ == '__main__':
    for n in range(1000):
        print uniqify(1)
    for n in range(1000):
        print uniqify(2) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T03:36:25.233

该类是通用且无聊的，**但这是我的第一个递归生成器。** <3

```
def stamptag():
    yield ''
    prefixtag = stamptag()
    prefix = prefixtag.next()
    while True:
        for i in range(ord('A'),ord('Z')+1):
            yield prefix+chr(i)
        prefix = prefixtag.next()

tagger = stamptag()
for i in range(3000):
    tagger.next()
print tagger.next()

class uniquestamp:
    def __init__(self):
        self.timestamp = -1
        self.tagger = stamptag()

    def format(self,newstamp):
        if self.timestamp < newstamp:
            self.tagger = stamptag()
            self.timestamp = newstamp
        return str(newstamp)+self.tagger.next()

stamper = uniquestamp()
print map(stamper.format, [1,1,1,2,2,3,4,4]) 
```

输出：

```
DKJ
['1', '1A', '1B', '2', '2A', '3', '4', '4A'] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T01:16:44.117

与 Ali A 非常相似，但我还是会发布我的：

```
class unique_timestamp:
    suffixes = " ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    def __init__(self):
        self.previous_timestamps = {}
        pass
    def uniquify(self, timestamp):
        times_seen_before = self.previous_timestamps.get(timestamp, 0)
        self.previous_timestamps[timestamp] = times_seen_before + 1
        if times_seen_before > 0:
            return str(timestamp) + self.suffixes[times_seen_before]
        else:
            return str(timestamp) 
```

用法：

```
>>> u = unique_timestamp()
>>> u.uniquify(1)
'1'
>>> u.uniquify(1)
'1A'
>>> u.uniquify(1)
'1B'
>>> u.uniquify(2)
'2' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T01:22:41.560

后缀必须是这样的字母吗？

```
from itertools import count
def unique(timestamp): 
  if timestamp in unique.ts.keys():
    return timestamp + '.' + str(unique.ts[timestamp].next())
  else:
    unique.ts[timestamp] = count()
    return timestamp
unique.ts = {} 
```

如果您想要返回字母，您可以定义不同的计数。

不过，这与您的 perl 代码不同。

*   它保留了一个字典，所以如果你有很多独特的时间戳，那么你将使用大量内存。
*   它处理乱序调用，而原始调用没有（即 u(1)、u(2)、u(1)）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T07:23:45.437

这是我第一次回答，我使用了全局变量，但这对我来说似乎是最简单的方法。

```
from string import uppercase

last_ts = None
letters = None

def increment(letters):
    if not letters:
        return "A"
    last_letter = letters[-1]
    if last_letter == "Z":
        return increment(letters[:-1])  + "A" 
    return letters[:-1] + uppercase[uppercase.index(last_letter) + 1]

def uniquify(timestamp):
    global last_ts, letters
    if timestamp == last_ts:
        letters = increment(letters)
        return timestamp + letters
    last_ts = timestamp
    letters = None
    return timestamp

print uniquify("1")
print uniquify('1')
print uniquify("1")
print uniquify("2")
for each in range(100): print uniquify("2")

1
1A
1B
2
2A
2B
2C
2D
2E
2F
2G
2H
2I
2J
2K
2L
2M
2N
2O
2P
2Q
2R
2S
2T
2U
2V
2W
2X
2Y
2Z
2AA
2AB
2AC
2AD
2AE
2AF
2AG
2AH
2AI
2AJ
2AK
2AL
2AM
2AN
2AO
2AP
2AQ
2AR
2AS
2AT
2AU
2AV
2AW
2AX
2AY
2AZ
2BA
2BB
2BC
2BD
2BE
2BF
2BG
2BH
2BI
2BJ
2BK
2BL
2BM
2BN
2BO
2BP
2BQ
2BR
2BS
2BT
2BU
2BV
2BW
2BX
2BY
2BZ
2CA
2CB
2CC
2CD
2CE
2CF
2CG
2CH
2CI
2CJ
2CK
2CL
2CM
2CN
2CO
2CP
2CQ
2CR
2CS
2CT
2CU
2CV 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T04:08:24.647

看看这个问题，它似乎很适合协程（Python 2.5 或更高版本）。下面是一些将大致产生相同结果的代码：

```
def uniqify():
    seen = {}
    val = (yield None)
    while True:
        if val in seen:
            idxa, idxb = seen[val]
            idxb += 1
        else:
            idxa, idxb = (len(seen)+1, ord('a'))
        seen[val] = (idxa, idxb)
        uniq = "%s%s" % (idxa, chr(idxb))
        val = (yield uniq) 
```

以下是你如何使用它：

```
>>> u = send.uniqify()
>>> u.next() #need this to start the generator
>>> u.send(1)
'1a'
>>> u.send(1)
'1b'
>>> u.send(1)
'1c'
>>> u.send(2)
'2a'
>>> u.send(2)
'2b'
>>> u.send(1) #you can go back to previous values
'1d'
>>> u.send('stringy') #you can send it anything that can be used as a dict key
'3a' 
```

# asp.net - YUI MenuBar 位于 ASP.NET Silverlight 控件后面

> ID：604723
> 
> 赞同：0
> 
> 时间：2009-03-03T01:00:01.803
> 
> 标签：asp.net, silverlight, yui, yui-menu

使用 YUI 菜单栏，当项目下拉时，它们会出现在 ASP.NET Silverlight 控件的后面。我没有使用 YUI 布局。

我已经尝试在菜单栏 css 中设置 z-index:99 和 position:relative，以及设置 div 的 z-index:-1 和 position:relative。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T01:24:02.697

另一种可能性是尝试配置变量“iframe: true”以强制在页面上使用 iframe 填充程序。iframe shims 通常可以通过浏览器上的插件解决 z-index 问题（我已使用此变量通过 Adob​​e Reader 修复内联 PDF）。

创建菜单时可以设置配置变量：

```
var oMenu = new YAHOO.widget.Menu("basicmenu", { iframe: true }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T01:06:28.277

将 ASP.NET Silverlight 控件的**Windowless**属性设置为**true**可消除此问题。 *注意：这样做将启用浏览器的选定虚线边框，只要 Silverlight 控件处于焦点，就会出现...*

# c# - 如何在 C# 中正确关闭显示器电源？

> ID：604727
> 
> 赞同：4
> 
> 时间：2009-03-03T01:01:11.237
> 
> 标签：c#

我已经在使用一些代码来关闭显示器电源，但我仍然有一个小问题。

该代码在大多数情况下都可以正常工作，但偶尔，监视器会变为空白。我的意思是屏幕是全黑的，你什么都看不到，但你可以看到它仍然亮着。LCD 灯仍亮着，但屏幕全黑。

我不知道为什么会发生这种情况，也许你们中的一些人知道为什么......如果我将 Windows 电源设置设置为在 X 分钟后关闭显示器，这将永远不会发生，但我需要一个应用程序来执行此操作，以便我可以调用它随时随地的捷径。

我正在使用的代码是这样的：

```
[System.Runtime.InteropServices.DllImport("user32.dll")]
private static extern int SendMessage(int hWnd, int hMsg, int wParam, int lParam);

const int WM_SYSCOMMAND   = 0x0112;
const int SC_MONITORPOWER = 0xF170;
const int HWND_BROADCAST  = 0xFFFF;

SendMessage(HWND_BROADCAST, WM_SYSCOMMAND, SC_MONITORPOWER, 2); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T01:47:05.293

您不想将该消息广播到所有窗口。您依靠他们中的每一个人来按您的期望处理它。

您需要创建自己的并且仅将消息发送给它，以便您可以控制行为。

Raymond Chen的这篇文章的评论中有一些解决方案：http: [//blogs.msdn.com/oldnewthing/archive/2006/06/13/629451.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/06/13/629451.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T01:02:42.060

你在多台机器上测试过这个吗？可能是驱动问题...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T10:09:35.660

我也有这个问题。机器通常可以正常工作，然后不知何故不允许屏幕进入睡眠状态。我找不到具体的共性。

甚至在机器注销时也会发生。通常 1 次重新启动将清除问题。不总是。

我什至看到屏幕在一台已注销且没有人与之交互的机器上醒来并拒绝再次入睡。

显然有一个或多个过程要归咎于，但是你如何追踪它们呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T01:32:15.810

没有任何效果，我创建了自己的 Window 并使用了那个 Window 句柄，大多数时候，屏幕关闭并且完全黑屏（LCD 灯关闭），但每隔一段时间，LCD 灯不会关闭... :(

# c# - 将 [0] 或 First() 与 LINQ OrderBy 一起使用

> ID：604729
> 
> 赞同：1
> 
> 时间：2009-03-03T01:02:04.027
> 
> 标签：c#, .net, linq-to-sql, .net-3.5, sql-order-by

如果我有这样的结构

> 专辑
>     - 专辑
>         - 光盘
>             - 曲目

我想按第一张光盘上第一首曲目的标题订购专辑集合。

有没有类似于以下我可以做的事情（请记住，我需要使用接受字符串的 OrderBy 扩展方法）？

```
albums.OrderBy("Discs[0].Tracks[0].Title") 
```

我需要能够使用字符串表达式进行排序，因此需要使用 OrderBy 方法，即专辑.OrderBy("Track[0].Title")。原因是我们的自定义框架使用从 GridView 传回的排序表达式（例如“Title”），该表达式在字典中查找（例如“Track[0].Title”）以获取正确的 order by 子句。也就是说，排序的字段和方向是在运行时动态确定的。

或者

```
albums.OrderBy("Discs.First().Tracks.First().Title") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T01:09:30.237

未经测试，但如何：

```
 var query = from album in albums
                let disc = album.Discs.First()
                let track = disc.Tracks.First()
                orderby track.Title
                select album; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-26T17:23:48.793

LINQ 有两种方法可以查询“from .in ..”和 Lambda 表达式。他们几乎写它的方式看起来像 Lambda 一样。这将是 Lambda 表达式：

> Albums.OrderBy(a=>a.Discs.First().Tracks.First().Title)

我使用变量“a”来表示专辑，但您可以使用任何变量，这与第一个表达式相同：

> Albums.OrderBy(album=>album.Discs.First().Tracks.First().Title)

或者您可以使用 from obj in obj 形式作为其他答案中的提及。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T18:54:47.990

怎么样，为了满足您对不执行排序的初始查询的需求？这使用匿名类型来存储专辑信息，以及第一首曲目的名称，以便您稍后对其进行排序。

```
var query = from album in albums
            let disc = album.Discs.First()
            let track = disc.Tracks.First()
            select new { Album = album, FirstTrack = track.Title };

var sortedQuery = from album in query
                  order by album.FirstTrack
                  select album.Album; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T07:12:56.983

对不起人们，

看起来我正在询问并尝试使用的 OrderBy 方法特定于我们正在使用的 ORM（genom-e），并且没有反映在 .net Queryable 或 IEnumerable 类上（不像大多数 genom-e 的 LINQ功能）。.net 中没有接受字符串的 OrderBy 重载，这是特定于基因组的。

那些使用 .net 遇到类似问题的人可能应该**尝试上述两个答案中的任何一个**。

# wcf - 如何使用 WCF 和 Unity 进行拦截

> ID：604733
> 
> 赞同：1
> 
> 时间：2009-03-03T01:04:56.503
> 
> 标签：wcf, unity-container, enterprise-library, aop

我有一个设置为托管在统一容器中的 WCF 服务。我打算使用这个容器来执行方法拦截。问题是我无法让我的拦截器开火......

首先在这里定义我的拦截器属性和处理程序：

```
[AttributeUsage(AttributeTargets.Method)]
public class PCSecurityAttribute : HandlerAttribute
{
    public PCSecurityAttribute(Modules module, int modulePermission)
    {
        SecurityModule = module;
        SecurityModulePermission = modulePermission;
    }

    public Modules SecurityModule
    {
        get;
        set;
    }

    public int SecurityModulePermission
    {
        get;
        set;
    }

    public override ICallHandler CreateHandler(IUnityContainer container)
    {
        return new PCSecurityCallHandler(0, SecurityModule, 
           SecurityModulePermission);
    }
}

using System.ServiceModel.Security;
using MHC.PracticeConnect.Contract.Data.Security;
using Microsoft.Practices.Unity.InterceptionExtension;

namespace MHC.PracticeConnect.Service
{
    public class PCSecurityCallHandler : ICallHandler
    {
        private Modules securityModule;
        private int securityModulePermission;

        public PCSecurityCallHandler(Modules module, int modulePermission)
        {
            securityModule = module;
            securityModulePermission = modulePermission;
            Order = 0;
        }

        public PCSecurityCallHandler(int order, Modules module, 
            int modulePermission)
        {
            securityModule = module;
            securityModulePermission = modulePermission;
            Order = order;
        }

        public IMethodReturn Invoke(IMethodInvocation input,
            GetNextHandlerDelegate getNext)
        {
            bool validPermission = false;
            // check security permission

            IMethodReturn result;

            if (validPermission)
                result = getNext().Invoke(input, getNext);
            else
                throw new SecurityAccessDeniedException(
                    "The current user does not have security " +
                    "permissions to call this module.");

            return result;
        }

        public int Order
        {
            get;
            set;
        }
    }
} 
```

在我的主机中，我尝试将其配置为使用拦截无济于事......帮助！！！！

```
public class DocumentTemplateServiceHostFactory : ServiceHostFactory
{
    protected override ServiceHost CreateServiceHost(Type serviceType, 
        Uri[] baseAddresses)
    {
        UnityServiceHost host = 
            new UnityServiceHost(serviceType, baseAddresses);
        UnityContainer unity = new UnityContainer();
        host.Container = unity;
        host.Container.AddNewExtension<Interception>(); ;
        host.Container.RegisterType<IDocumentTemplateService, 
            DocumentTemplateService>().Configure<Interception>().
        SetInterceptorFor<IDocumentTemplateService>(
            new TransparentProxyInterceptor());

        return host;
    }
} 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T02:53:15.263

您可能希望使用 WCF 行为进行检查。这是可能有用的链接。

[http://msdn.microsoft.com/en-us/magazine/cc136759.aspx](http://msdn.microsoft.com/en-us/magazine/cc136759.aspx)

和

[http://www.global-webnet.net/blogengine/post/2009/01/03/Integrating-IIS-WCF-and-Unity.aspx](http://www.global-webnet.net/blogengine/post/2009/01/03/Integrating-IIS-WCF-and-Unity.aspx)

-布莱恩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T15:45:43.060

我已经创建了完全符合您要求的东西。我把它放在 CodePlex 上：
[http ://wcfaop.codeplex.com/](http://wcfaop.codeplex.com/)

基本上，您必须创建自己的 InstanceProvider，然后从 Unity 容器创建 WCF 服务对象并允许您进行拦截。

# php - 如何从 Magento 获取类别列表？

> ID：604743
> 
> 赞同：10
> 
> 时间：2009-03-03T01:09:33.417
> 
> 标签：php, magento, categories, product, catalog

我想在 Magento 中创建一个页面，显示类别的视觉表示.. 示例

```
CATEGORY
 product 1
 product 2

ANOTHER CATEGORY
 product 3 
```

我的问题是，他们的数据库的组织方式与我过去看到的非常不同。他们有专门用于 varchar、int 等数据类型的表。我认为这是为了性能或类似的。

我还没有找到一种方法来使用 MySQL 来查询数据库并获取类别列表。然后我想将这些类别与产品相匹配，以获得每个类别的产品列表。不幸的是，Magento 似乎让这变得非常困难。

此外，我还没有找到可以在页面块内工作的方法。我创建了 showcase.phtml 并将其放入 XML 布局中，它会显示并运行其 PHP 代码。我希望有一些简单的东西，比如循环`$this->getAllCategories()`，然后在里面有一个嵌套循环，比如`$category->getChildProducts()`.

谁能帮我？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-04T22:50:08.680

来自 SEO 相关类 (Mage_Catalog_Block_Seo_Sitemap_Category) 中的代码

```
$helper     = Mage::helper('catalog/category');
$collection = $helper->getStoreCategories('name', true, false);
$array      = $helper->getStoreCategories('name', false, false); 
```

试着忘记它是为您的商店提供动力的数据库，而是专注于使用 Magento 系统提供的对象。

例如，我不知道如何获取类别列表。但是，我通过 Mage 代码库

```
grep -i -r -E 'class.+?category' 
```

它返回了大约 30 个类的列表。滚动浏览这些，相对容易猜测哪些对象可能具有方法或需要进行方法调用来获取类别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T10:27:29.013

嘿[，这样的事情](http://www.juretic.com/news/index.php/2009/02/23/developing-magento-outside-of-magento/)可能会对你有所帮助，我已经稍微调整了它以更具体地回答你的问题。

```
 $h3h3=Mage::getModel('catalog/category')->load(5);  // YOU NEED TO CHANGE 5 TO THE ID OF YOUR CATEGORY

$h3h3=$h3h3->getProductCollection();

foreach($h3h3->getAllIds() as $lol)
{
    $_product=Mage::getModel('catalog/product')->load($lol);

    print $_product->getName()."<br/>";

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-06T01:12:32.963

我改编自[Paul Whipp 的网站](http://paulwhippconsulting.com.au/webdevelopment/50-sorting-magento-categories-alphabetically-with-mysql)：

```
SELECT e.entity_id AS 'entity_id', vn.value AS 'name'   
FROM catalog_category_entity e  
LEFT JOIN catalog_category_entity_varchar vn  
ON e.entity_id = vn.entity_id AND vn.attribute_id = 33 
ORDER BY entity_id; 
```

这将为您提供目录类别 ID。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-18T21:20:22.357

这是一个简单的例子

```
$categories = Mage::getModel('catalog/category')->getCollection()  
    ->addAttributeToSelect('name')
    ->addAttributeToSelect('url_key')
    ->addAttributeToSelect('my_attribute')
    ->setLoadProductCount(true)
    ->addAttributeToFilter('is_active',array('eq'=>true))
    ->load(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-27T19:54:58.097

我在 /app/design/frontend/default/default/template/catalog/product/feature.xml 中使用了它

```
<?php
/**
 * Home page Featured Product list template
 *
 * @see Mage_Catalog_Block_Product_List
 */
?>
<?php 
if (!is_null($this->_productCollection)) {
    $_origCollection = $this->_productCollection;
    $this->setCollection(null);
}
$this->setCategoryId(16);
$_productCollection=$this->getLoadedProductCollection() ?>
<?php if($_productCollection->count()): ?>
<div class="featured-products">
    <h2><?php echo $this->__('Featured Products') ?></h2>
    <?php foreach ($_productCollection as $_product): ?>
        <div>
            <a href="<?php echo $_product->getProductUrl() ?>" title="<?php echo $this->htmlEscape($_product->getName()) ?>">
                <img src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(150, 50); ?>" alt="<?php echo $this->htmlEscape($this->getImageLabel($_product, 'small_image')) ?>" />
                <h3 class="product-name"><?php echo $this->htmlEscape($_product->getName())?></h3>
                <?php echo nl2br($this->htmlEscape($_product->getShortDescription())) ?>
            </a>
        </div>
    <?php endforeach; ?>
</div>
<?php endif; ?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-01T03:36:36.443

I made this little video on how I create custom category listing blocks with Magento. I am sure there are better ways of achieving this or even something I could have done better, but it's just my method. I only created this it in hopes that it helps explain somethings to some people out there.

[Magento Custom Category Listing Tutorial](http://www.devinrolsen.com/magento-custom-category-listing-block/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-01T08:09:10.523

非常感谢。真的很有帮助。要获取游戏，请循环然后 getName()

```
foreach ($collection as $cat):

    echo $cat->getName();

endforeach; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-08T10:06:26.510

类别列表块：

```
<?php
$categories = Mage::getModel('catalog/category')->load(2)->getChildren();
$catIds = explode(',',$cats);
?>
<ul>
<?php foreach($catIds as $catId): ?>
    <li>
        <?php
            $category = Mage::getModel('catalog/category')->load($catId);
            echo $category->getName();

            $subCats = Mage::getModel('catalog/category')->load($category->getId())->getChildren();
            $subCatIds = explode(',',$subCats);
        ?>
            <?php if(count($subCatIds) > 1):?>
                <ul>
                <?php foreach($subCatIds as $subCat) :?>
                    <li>
                    <?php
                        $subCategory = Mage::getModel('catalog/category')->load($subCat);
                        echo $subCategory->getName();
                    ?>
                    </li>
                <?php endforeach;?>
                </ul>
            <?php endif; ?>
    </li>
<?php endforeach; ?>
</ul> 
```

# project-management - 项目管理和过程管理的区别

> ID：604748
> 
> 赞同：6
> 
> 时间：2009-03-03T01:11:40.353
> 
> 标签：project-management, terminology, process-management

项目管理和过程管理有什么区别？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-03T10:27:12.640

**流程与项目的定义特征是可重复性与独特性。**

*   过程是旨在实现某个目标的相互关联的任务的重复集合。

*   项目是一项独特的努力，有始有终，以实现目标。

过程管理强调提高任务的“可重复性”、效率（减少所需时间、降低成本）、提高质量（包括质量一致性）。

项目管理强调把事情做好，达到最终结果。更高的效率更难实现，因为它可能需要定制工具和方法，而这些工具和方法只有在项目变成重复过程时才能开发。

**应用于软件开发进行每日构建是一个过程：**

*   这是一系列针对最终结果的任务。

*   顺序是重复的。

*   任务从一开始就是已知的，因为这个过程是重复的。

*   在管理日常构建时，我们希望它们便宜、快速且始终符合质量标准，在大多数情况下，这最好通过提高自动化来实现。

**设计新功能是一个项目：**

*   该功能是独一无二的，一旦我们设计了它，我们就不会再设计它了。也许是第二版，但它会是一个不同的努力。

*   在某些时候，我们需要停止设计该功能（即使它远非完美），最好提前规定我们如何知道我们已经达到了这一点。

*   我们不太关心设计是通过最有效的步骤序列来实现的，而是实际上最终提出了一个足够好的设计。

*   因此，进入设计的任务序列将难以自动化，我们需要专注于保持界限，重新评估标准，调整新发现的事实，并通常将整个事情推向完成。

*   我们必须不断地从根据新发现的事实出现的越来越多的可能任务中进行选择，并从中挑选出能让我们更接近目标的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T01:21:34.013

流程管理将是对流程的管理，例如软件开发流程（请注意，我没有*说*“软件流程”）。这样的过程可以用于各种项目。一个过程除了自身之外没有最终产品。

项目管理将是对项目的管理，通常使用一些过程，并产生产品或产品的新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-04T03:04:51.730

如果项目是需要完成以产生最终结果的工作，无论是产品还是服务，那么过程就是对该工作的描述。每个项目都遵循一个过程，即使没有正式定义。通过尝试为每个项目捕获该过程，将出现一种模式，即类似的过程正在用于某些组或类型的项目。还可以显示，某些过程导致更好的最终结果或导致更快和/或更便宜的最终结果。然后可以采用这种过程以用于相关项目，从而导致更高的生产力和最终结果的质量。因此，项目管理是应用过程以产生最终结果。没有过程管理，只有过程开发、实施、测量和改进，它们本身就是项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-08T22:55:15.950

过程是项目的抽象。它用于概括项目的变异性、独特性和瞬态性。为了提高项目预期或实现的产品的效率、生产力、有效性和价值，借助过程和/或流程。流程的目标是服务，而项目的目标是产品。流程寻求长期目标，但项目旨在短期目标。项目需求基于最终产品，而流程需求基于流程本身。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T10:34:10.410

一句话总结是流程管理管理项目的一般运行方式，除了解释流程的文档之外没有其他可交付成果，而项目管理正在管理项目以确保在预算内按时创建可交付成果，同时遵循通过流程管理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-31T07:56:59.943

过程基本上是项目的一部分。过程意味着完成某些任务已遵循某些规则，而项目意味着通过应用某些过程来完成任务

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-01T06:38:18.083

上面说的好，流程管理将现有项目的完整流程定义为文档并向上级报告状态。甚至，他们会在他们不在的情况下相应地进行资源规划。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-24T11:16:23.777

> ***流程与项目的定义特征是可重复性与独特性。***

...我听过的最好的描述。一个糟糕的类比可能是一个过程就像一份日常工作，一个项目就像一份合同。

用外行的话来说，流程是一堆需要一次又一次地执行以保持组织运行的任务。这些任务可以手动（由从事日常工作的人）或自动（由 IT）执行。

eTOM 业务流程框架 (www.tmforum.org) 说有三种类型的流程：

1.  战略、基础设施和产品生命周期管理 - 一种复杂的方式来说明组织为规划和构建新事物而需要执行的所有任务
2.  运营 - 所有日常任务，以保持一切正常运行并让您的客户满意
3.  企业管理 - 其余的......如财务报告等

* * *

> ***项目是一项独特的努力，有始有终，以实现目标。***

....大师

*在外行中，您只需执行一次即可构建、更改（或删除）您的组织能力*（例如，它的基础架构或产品）的一堆任务。

* * *

**他们怎么一样**

为了给这种动态增加一点混乱，项目管理本身就是一个过程（参见 PRINCE2 www.prince2.com）

它适合*(1) 战略、基础设施和产品*类别（抱歉鞭打 eTOM，还有很多其他框架，如**ITIL**和**SCOR**，我是一家电信公司的 EA，所以它是我最了解的框架。）

虽然每个项目都有一个开始和结束日期 - 您的组织可能永远在建设和改变能力（基础设施和产品）。因此，每个项目交付的东西都不同，但每次交付项目的步骤或执行的任务应该是相同的（再次参见 [PRINCE2][2]）。

# python - 如何在 Python 中访问我的网络摄像头？

> ID：604749
> 
> 赞同：79
> 
> 时间：2009-03-03T01:11:44.880
> 
> 标签：python, webcam

我想从 Python 访问我的网络摄像头。

我尝试使用[VideoCapture](http://videocapture.sourceforge.net/)扩展（[教程](http://technobabbler.com/?p=22)），但这对我来说效果不佳，我不得不解决一些问题，例如分辨率 >320x230 时它有点慢，有时它会`None`无缘无故地返回。

有没有更好的方法从 Python 访问我的网络摄像头？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-03-03T12:09:22.660

OpenCV 支持从网络摄像头获取数据，默认情况下它带有 Python 包装器，您还需要安装`numpy`OpenCV Python 扩展（称为`cv2`）才能工作。截至 2019 年，您可以使用 pip 安装这两个库： `pip install numpy` `pip install opencv-python`

[有关将 OpenCV 与 Python 结合使用的更多信息](https://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_tutorials.html)。

[从Displaying webcam feed using opencv and python](https://stackoverflow.com/a/11449901/660921)复制的示例：

```
import cv2

cv2.namedWindow("preview")
vc = cv2.VideoCapture(0)

if vc.isOpened(): # try to get the first frame
    rval, frame = vc.read()
else:
    rval = False

while rval:
    cv2.imshow("preview", frame)
    rval, frame = vc.read()
    key = cv2.waitKey(20)
    if key == 27: # exit on ESC
        break

vc.release()
cv2.destroyWindow("preview") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T02:33:17.227

gstreamer 可以处理网络摄像头输入。如果我没记错的话，它有 python 绑定！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-05T10:36:15.583

```
import cv2 as cv

capture = cv.VideoCapture(0)

while True:
    isTrue,frame = capture.read()
    cv.imshow('Video',frame)
    if cv.waitKey(20) & 0xFF==ord('d'):
        break

capture.release()
cv.destroyAllWindows() 
```

0 <-- 指摄像头，替换为文件路径读取视频文件

cv.waitKey(20) & 0xFF==ord('d') <-- 按键时销毁窗口

# asp.net - 检测更改 webform 控件 asp.net

> ID：604755
> 
> 赞同：0
> 
> 时间：2009-03-03T01:18:47.623
> 
> 标签：asp.net, .net-3.5, controls

我有一个包含大约 20 个文本框/下拉列表控件的网络表单，我想要一种干净简单的方法来检查表单字段是否已更改。有谁知道这样做的干净方法？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T22:38:50.697

javascript 中的 onkeypress / onkeydown / onkeyup 方法。能够监控针对输入的击键。

如果输入时有击键，则可能会发生变化。

[例子](http://www.w3schools.com/jsref/jsref_onkeypress.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T22:39:46.700

最简单的方法是遍历控件集合，然后检查 TextChanged 属性。

请注意，集合中的控件可能有自己的控件，因此您必须进行递归检查。

# c# - C#中可中断锁的语法

> ID：604757
> 
> 赞同：0
> 
> 时间：2009-03-03T01:19:46.450
> 
> 标签：c#, locking, interrupt

我怀疑这是一个非常愚蠢的问题：C# 中可中断锁语句的正确语法是什么？例如获取锁；如果锁定在锁定代码完成之前被中断，则从封闭方法中返回 false。可能完全是错误的术语......谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T01:36:22.370

使用;*获取*锁时，您可以有一个超时。`Monitor.TryEnter`同样，在锁中，您可以执行`Monitor.Wait`/之类的操作`Monitor.Pulse`来暂时放弃锁，但您不能因此被打断。

应用的主要时间中断可能在 Thread.Sleep 中，它可以被 Thread.Interrupt 中断 - 但同样，这不会将控制权从正在执行的方法块中拉出来。

你到底想要达到什么目的？有了更多的上下文，我们可能可以提供更多帮助......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T01:22:03.560

您所说的“中断”是什么意思尚不清楚。

**异常中断**

```
private bool SomeLockingMethod(object foo)
{
    // Verify foo is valid

    try
    {
       lock(foo)
       {
          while(something)
          {
             // Do stuff

             Thread.Sleep(1); // Possibly yield to another 
                              // thread calling Thread.Interrupt
          }
       }

       return true;
    }
    catch(ThreadInterruptedException ex)
    {
       // Handle exception
    }

    return false;
} 
```

如果`return true`未达到 ，则在`foo`保持锁定时发生了一些事情，并且代码返回`false`。无论哪种方式，锁都会自动释放。

另一个线程可以通过调用来中断这个[`Thread.Interrupt`](http://msdn.microsoft.com/en-us/library/system.threading.thread.interrupt.aspx)。

**代码中的“中断”**

如果您是“中断”代码的人，则可能很简单

```
private bool SomeLockingMethod(object foo)
{
    // Verify foo is valid

    lock(foo)
    {
       // Do stuff

       if(shouldInterrupt)
       {
          return false;
       }

       // Do more stuff
    }

    return true;
 } 
```

同样，无论是否有“中断”，锁都会自动释放。

**由于其他人试图获取锁而中断**

可能这就是您正在寻找的；在这种情况下，您可能想要使用其他东西，例如 a[`Semaphore`](http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx)或[`ManualResetEvent`](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T01:26:46.200

我不确定你想在这里做什么。该`lock`语句的目的是您不应该被打断，这样您就可以确保一致的行为。

你想在这里完成什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T03:39:48.877

您可能还会查看 2.0 中添加的事务范围，这可能是您正在寻找的内容（未知，由于您的问题含糊不清）。它允许您尝试一些操作，如果这些操作未正确完成，则回滚。

[有关更多详细信息，请参见此处](http://msdn.microsoft.com/en-us/library/ms172152.aspx)。

# javascript - 你将如何调试这个 javascript 问题？

> ID：604758
> 
> 赞同：0
> 
> 时间：2009-03-03T01:20:04.813
> 
> 标签：javascript, debugging, networking, geocoding

在过去的几周里，我一直在旅行和发展。我正在开发的网站运行良好。

然后，前几天，我连接到网络并且页面“看起来”很好，但事实证明 javascript 没有运行。我检查了萤火虫，没有错误，因为我怀疑可能没有加载脚本（我正在使用 jQuery 和 jQuery UI 的 google api，以及加载 google maps api 和 fbconnect）。我怀疑如果问题是其中一个页面未加载，我会收到错误消息，但什么也没有。

想也许我没有正确连接或其他什么，我重新连接到网络，甚至重新启动了我的计算机，并尝试运行本地版本。我什么都没有。本地版本未运行也向我暗示，是加载了外部 javascript 导致了问题。

我让它作为一个网络奇怪的东西通过。不幸的是，现在我在 100 英里之外。

今天我哥哥给我发了一封电子邮件，说他在机场的网络无法加载我的页面。同样的问题。一切都布局妥当，部分布局是用 Javascript 设置的，因此很明显 javascript 正在运行。

他也没有错误。当然，他上了飞机，现在已经不在机场了。现在该站点在他的计算机上运行（我没有更改任何内容）。

在这种情况下，您究竟会如何弄清楚发生了什么？那是大约 12 个网络中的两个。但我不知道如何找到一个不起作用的网络（而且住在一个小镇，我可能很难找到一个不起作用的网络）。

有任何想法吗？该站点仍处于开发阶段，因此我宁愿暂时不发布链接（但可以在几天后发布）。我可以看到不起作用的是在加载和点击时调用的 javascript 函数。所以我认为这是一个javascript问题，但没有错误。

如果我能找到并坐在其中一个网络上，这不会是一个大问题，但我不能。那你会怎么做？

编辑 - - - - - - - - - - - - - - - - - - - - - - - - - --------- 第一个没有被调用的函数（s - 它们的链接）在下面。由于未进行调用，因此我已在 .ajax 调用中删除了代码。

```
function getResultsFromForm(){

    jQuery('form#filterList input.button').hide();
    var searchAddress=jQuery('form#filterList input#searchTxt').val();
    if(searchAddress=='' || searchAddress=='<?php echo $searchLocation; ?>'){
        mapShow(20, -40, 0, 'areaMap', 2);
        jQuery('form#filterList input.button').show();
        return;
    }

    if (GBrowserIsCompatible()) {
        var geo = new GClientGeocoder(); 
        geo.setBaseCountryCode(cl.address.country);

        geo.getLocations(searchAddress, function (result) 
                {    

                if(!result.Placemark && searchAddress!='<?php echo $searchLocation; ?>'){
                jQuery('span#addressNotFound').text('<?php echo $addressNotFound; ?>').slideDown('slow');
                jQuery('form#filterList input.button').show();

                } else {
                jQuery('span#addressNotFound').slideUp('slow').empty();
                jQuery('span#headerLocal').text(searchAddress);
                var date = new Date();
                date.setTime(date.getTime() + (8 * 24 * 60 * 60 * 1000));
                jQuery.cookie('address', searchAddress, { expires: date});
                var accuracy= result.Placemark[0].AddressDetails.Accuracy;

                var lat = result.Placemark[0].Point.coordinates[1];
                var long = result.Placemark[0].Point.coordinates[0];
                lat=parseFloat(lat);
                long=parseFloat(long);
                var getTab=jQuery('div#tabs div#active').attr('class');

                jQuery('div#tabs').show();
                loadForecast(lat, long, getTab, 'true', 0);
                var zoom=zoomLevel();
                mapShow(lat, long, accuracy, 'areaMap', zoom );

                }
                });
    }

}

function zoomLevel(){

    var zoomarray= new Array();
    zoomarray=jQuery('span.viewDist').attr('id');
    zoomarray=zoomarray.split("-");
    var zoom=zoomarray[1];
    if(zoom==''){
        zoom=5;
    }
    zoom=parseFloat(zoom);
    return(zoom);

}
function loadForecast(lat, long, type, loadForecast, page){

    jQuery('div#holdForecast').empty();
    var date = new Date();
    var d  = date.getDate();
    var day = (d < 10) ? '0' + d : d;
    var m = date.getMonth() + 1;
    var month = (m < 10) ? '0' + m : m;
    var year='2009';
    toDate=year+'-'+month+'-'+day;

    var genre=jQuery('span.genreblock span#updateGenre').html();

    var numDays='';

    var numResults='';

    var range=jQuery('span.viewDist').attr('id');
    var dateRange = jQuery('.updateDate').attr('id');
    jQuery('div#holdShows ul.showList').html('<li class="show"><div class="showData"><center><img src="../hwImages/loading.gif"/></center></div></li>');

    jQuery('div#holdShows ul.'+type+'List').livequery(function(){
            jQuery.ajax({
type: "GET",
url: "processes/formatShows.php",
data: "output=&genre="+genre+"&numResults="+numResults+"&date="+toDate+"&dateRange="+dateRange+"&range="+range+"&lat="+lat+"&long="+long+'&page='+page,
success: function(response){ 
```

编辑 2 ------------------------------------------------ -----------------------------------------

请记住，问题不在于我无法加载该站点，该站点在大多数连接上都可以正常工作，但是有时该站点无法正常工作，并且没有抛出任何错误，并且没有任何变化。我的兄弟今天早些时候无法运行它，而我没有问题，所以这与他的位置/网络有关。然而，页面加载，他有一个连接，这是他第一次访问该网站，所以没有任何东西可以兑现。和我前几天遇到这个问题的时候一样。我没有改变任何东西，我进入了不同的网络，一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T01:36:54.583

两件事：第一 - 在开发时获取您网站的本地 javascript。从其他地方加载它以利用缓存是我将保留到最后的优化。我也只会从高度可用的远程站点（如 Google）加载它，以尽量减少问题。其次，在不启用 javascript 的情况下，使您的网站至少可以使用。例如，使用在页面加载时运行的 javascript 中的 Ajax 功能替换的表单回发。你可能无法获得所有东西，但我发现我可以让大多数事情在没有 javascript 的情况下以一种可行的方式运行，即使不是优雅的方式。

我意识到这并不能解决您当前的问题，但我认为这将有助于您的网站在面对这种情况时保持可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-14T16:57:41.370

事实证明，问题在于假设谷歌地图可以通过 IP 地址可靠地找到北美境内的任何纬度/经度。

我添加一个

```
如果（！google.loader.ClientLocation）
```

适用于谷歌无法通过 ip 找到位置的情况。

最奇怪的是，我在帕洛阿尔托市中心的一个办公室里遇到了这个错误，我认为这会被谷歌地理编码器大量映射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T01:39:02.660

如果某些 JS 由不同的服务器托管（例如：如果您从 jQuery 站点包含类似 jQuery 的东西，而不是自己托管它的副本），那么这些站点中的一个可能会暂时关闭。

您可以尝试使用类似“Live HTTP Headers”（可在[Mozilla Addons 站点](https://addons.mozilla.org/en-US/firefox/)获得）来实时观看 HTTP 标头，这在进行 Web 开发时非常有用。您应该能够非常快速地确定您的所有 JS 是否实际上都正确加载。

您也可以使用 Ethereal 或 Wireshark 之类的东西，但是当您只需要查看请求/响应标头时，这可能有点笨拙。使用插件的麻烦要少得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T01:58:16.747

一些东西：

1.) 你在哪里包含你的脚本......确保你有一个单独的结束标签！不要自行关闭它们。

```
<script src="..."/><!--self-closing will fail, -->

<script src="..."></script><!--this will work --> 
```

2.) 你使用 jQuery() 而不是 $() 有什么原因吗？

3.) 您的 SERVER 是否指定了本地环境没有指定的 DOCTYPE？

4.) 你在测试什么浏览器？特别是您是否在 IE 中进行测试，如果是的话，它是否可以在 Firefox 中使用？

5.) 如果你不能提供 URL，你能发布一些生成的代码吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T02:07:28.177

一旦您确定所有脚本都在开发环境中按预期加载，您可以尝试从页面中逐个删除它们，然后查看哪个脚本重新创建了您遇到的问题 - 那就是脚本不是加载。

Firebug 有一个 Net Tab，它的功能与 Live HTTP Headers 非常相似，甚至可以跟踪加载时间和任何 ajax 请求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-14T08:11:04.747

我几乎总是为此推荐 Firefox 插件“Firebug”。

首先，您可以检查脚本以检查它们是否已加载，这将排除“它没有从远程源加载”的问题。

其次，它会显示在 JavaScript 控制台中发生的错误，这可能会指出一些以前似乎默默无闻的东西。

最后，在使用来自其他域的 JavaScript 时，请注意跨站点脚本问题。

# cocoa - 等待 [NSAlert beginSheetModalForWindow:...];

> ID：604768
> 
> 赞同：21
> 
> 时间：2009-03-03T01:22:56.850
> 
> 标签：cocoa, macos, alerts, document-based

当我显示这样的 NSAlert 时，我会立即得到响应：

```
int response;
NSAlert *alert = [NSAlert alertWithMessageText:... ...];
response = [alert runModal]; 
```

问题是这是应用程序模式，我的应用程序是基于文档的。我使用工作表在当前文档的窗口中显示警报，如下所示：

```
int response;
NSAlert *alert = [NSAlert alertWithMessageText:... ...];
[alert beginSheetModalForWindow:aWindow
                  modalDelegate:self
                 didEndSelector:@selector(alertDidEnd:returnCode:contextInfo:)
                    contextInfo:&response];

//elsewhere
- (void) alertDidEnd:(NSAlert *) alert returnCode:(int) returnCode contextInfo:(int *) contextInfo
{
    *contextInfo = returnCode;
} 
```

唯一的问题是它会`beginSheetModalForWindow:`立即返回，因此我无法可靠地向用户提问并等待回复。如果我可以将任务分成两个区域，这没什么大不了的，但我不能。

我有一个循环处理大约 40 个不同的对象（在树中）。如果一个对象失败，我希望显示警报并询问用户是继续还是中止（在当前分支继续处理），但由于我的应用程序是基于文档的，Apple Human Interface Guidelines 要求在警报出现时使用工作表特定于文档。

如何显示警报表并等待回复？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-06-10T16:31:36.217

我们创建了一个[类别`NSAlert`来同步运行警报](https://github.com/incbee/NSAlert-SynchronousSheet)，就像应用程序模式对话框一样：

```
NSInteger result;

// Run the alert as a sheet on the main window
result = [alert runModalSheet];

// Run the alert as a sheet on some other window
result = [alert runModalSheetForWindow:window]; 
```

该代码可通过[GitHub](https://github.com/incbee/NSAlert-SynchronousSheet)获得，为了完整起见，下面发布了当前版本。

* * *

头文件`NSAlert+SynchronousSheet.h`：

```
#import <Cocoa/Cocoa.h>

@interface NSAlert (SynchronousSheet)

-(NSInteger) runModalSheetForWindow:(NSWindow *)aWindow;
-(NSInteger) runModalSheet;

@end 
```

* * *

实施文件`NSAlert+SynchronousSheet.m`：

```
#import "NSAlert+SynchronousSheet.h"

// Private methods -- use prefixes to avoid collisions with Apple's methods
@interface NSAlert ()
-(IBAction) BE_stopSynchronousSheet:(id)sender;   // hide sheet & stop modal
-(void) BE_beginSheetModalForWindow:(NSWindow *)aWindow;
@end

@implementation NSAlert (SynchronousSheet)

-(NSInteger) runModalSheetForWindow:(NSWindow *)aWindow {
    // Set ourselves as the target for button clicks
    for (NSButton *button in [self buttons]) {
        [button setTarget:self];
        [button setAction:@selector(BE_stopSynchronousSheet:)];
    }

    // Bring up the sheet and wait until stopSynchronousSheet is triggered by a button click
    [self performSelectorOnMainThread:@selector(BE_beginSheetModalForWindow:) withObject:aWindow waitUntilDone:YES];
    NSInteger modalCode = [NSApp runModalForWindow:[self window]];

    // This is called only after stopSynchronousSheet is called (that is,
    // one of the buttons is clicked)
    [NSApp performSelectorOnMainThread:@selector(endSheet:) withObject:[self window] waitUntilDone:YES];

    // Remove the sheet from the screen
    [[self window] performSelectorOnMainThread:@selector(orderOut:) withObject:self waitUntilDone:YES];

    return modalCode;
}

-(NSInteger) runModalSheet {
    return [self runModalSheetForWindow:[NSApp mainWindow]];
}

#pragma mark Private methods

-(IBAction) BE_stopSynchronousSheet:(id)sender {
    // See which of the buttons was clicked
    NSUInteger clickedButtonIndex = [[self buttons] indexOfObject:sender];

    // Be consistent with Apple's documentation (see NSAlert's addButtonWithTitle) so that
    // the fourth button is numbered NSAlertThirdButtonReturn + 1, and so on
    NSInteger modalCode = 0;
    if (clickedButtonIndex == NSAlertFirstButtonReturn)
        modalCode = NSAlertFirstButtonReturn;
    else if (clickedButtonIndex == NSAlertSecondButtonReturn)
        modalCode = NSAlertSecondButtonReturn;
    else if (clickedButtonIndex == NSAlertThirdButtonReturn)
        modalCode = NSAlertThirdButtonReturn;
    else
        modalCode = NSAlertThirdButtonReturn + (clickedButtonIndex - 2);

    [NSApp stopModalWithCode:modalCode];
}

-(void) BE_beginSheetModalForWindow:(NSWindow *)aWindow {
    [self beginSheetModalForWindow:aWindow modalDelegate:nil didEndSelector:nil contextInfo:nil];
}

@end 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-21T10:54:15.167

这是解决问题的 NSAlert 类别（正如 Philipp 建议的，Frederick 提出并由 Laurent P. 改进的解决方案：我使用代码块而不是委托，因此再次简化）。

```
@implementation NSAlert (Cat)

-(NSInteger) runModalSheetForWindow:(NSWindow *)aWindow
{
    [self beginSheetModalForWindow:aWindow completionHandler:^(NSModalResponse returnCode)
        { [NSApp stopModalWithCode:returnCode]; } ];
    NSInteger modalCode = [NSApp runModalForWindow:[self window]];
    return modalCode;
}

-(NSInteger) runModalSheet {
    return [self runModalSheetForWindow:[NSApp mainWindow]];
}

@end 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-04-06T18:37:54.677

解决方法是调用

```
[NSApp runModalForWindow:alert]; 
```

在 beginSheetModalForWindow 之后。此外，您需要实现一个委托来捕获“对话框已关闭”操作，并调用 [NSApp stopModal] 作为响应。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-25T01:33:17.623

万一有人来找这个（我做过），我用以下方法解决了这个问题：

```
@interface AlertSync: NSObject {
    NSInteger returnCode;
}

- (id) initWithAlert: (NSAlert*) alert asSheetForWindow: (NSWindow*) window;
- (NSInteger) run;

@end

@implementation AlertSync
- (id) initWithAlert: (NSAlert*) alert asSheetForWindow: (NSWindow*) window {
    self = [super init];

    [alert beginSheetModalForWindow: window
           modalDelegate: self didEndSelector: @selector(alertDidEnd:returnCode:) contextInfo: NULL];

    return self;
}

- (NSInteger) run {
    [[NSApplication sharedApplication] run];
    return returnCode;
}

- (void) alertDidEnd: (NSAlert*) alert returnCode: (NSInteger) aReturnCode {
    returnCode = aReturnCode;
    [[NSApplication sharedApplication] stopModal];
}
@end 
```

然后同步运行 NSAlert 很简单：

```
AlertSync* sync = [[AlertSync alloc] initWithAlert: alert asSheetForWindow: window];
int returnCode = [sync run];
[sync release]; 
```

请注意，正如所讨论的那样，可能会出现重入问题，因此在这样做时要小心。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T02:29:21.027

不幸的是，您在这里无能为力。您基本上必须做出决定：重新架构您的应用程序，以便它可以以异步方式处理对象，或者使用未经批准、已弃用的架构来呈现应用程序模式警报。

在不了解有关您的实际设计以及如何处理这些对象的任何信息的情况下，很难提供任何进一步的信息。不过，在我的脑海中，有几个想法可能是：

*   在通过某种运行循环信号或队列与主线程通信的另一个线程中处理对象。如果窗口的对象树被中断，它会向主线程发出它被中断的信号，并等待来自主线程的信号，其中包含有关要做什么的信息（继续这个分支或中止）。然后主线程显示文档模式窗口，并在用户选择要做什么后向进程线程发出信号。

但是，对于您需要的东西，这可能真的过于复杂了。在这种情况下，我的建议是使用已弃用的用法，但这实际上取决于您的用户要求。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-02-04T13:23:50.543

斯威夫特 5：

```
extension NSAlert {

  /// Runs this alert as a sheet.
  /// - Parameter sheetWindow: Parent window for the sheet.
  func runSheetModal(for sheetWindow: NSWindow) -> NSApplication.ModalResponse {
    beginSheetModal(for: sheetWindow, completionHandler: NSApp.stopModal(withCode:))
    return NSApp.runModal(for: sheetWindow)
  }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-18T15:48:24.307

这是我的答案：

创建一个全局类变量 'NSInteger alertReturnStatus'

```
- (void)alertDidEndSheet:(NSWindow *)sheet returnCode:(NSInteger)returnCode contextInfo:(void *)contextInfo
{
    [[sheet window] orderOut:self];
    // make the returnCode publicly available after closing the sheet
    alertReturnStatus = returnCode;
}

- (BOOL)testSomething
{

    if(2 != 3) {

        // Init the return value
        alertReturnStatus = -1;

        NSAlert *alert = [[[NSAlert alloc] init] autorelease];
        [alert addButtonWithTitle:@"OK"];
        [alert addButtonWithTitle:@"Cancel"];
        [alert setMessageText:NSLocalizedString(@"Warning", @"warning")];
        [alert setInformativeText:@"Press OK for OK"];
        [alert setAlertStyle:NSWarningAlertStyle];
        [alert setShowsHelp:NO];
        [alert setShowsSuppressionButton:NO];

        [alert beginSheetModalForWindow:[self window] modalDelegate:self didEndSelector:@selector(alertDidEndSheet:returnCode:contextInfo:) contextInfo:nil];

        // wait for the sheet
        NSModalSession session = [NSApp beginModalSessionForWindow:[alert window]];
        for (;;) {
            // alertReturnStatus will be set in alertDidEndSheet:returnCode:contextInfo:
            if(alertReturnStatus != -1)
                break;

            // Execute code on DefaultRunLoop
            [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode 
                                     beforeDate:[NSDate distantFuture]];

            // Break the run loop if sheet was closed
            if ([NSApp runModalSession:session] != NSRunContinuesResponse 
                || ![[alert window] isVisible]) 
                break;

            // Execute code on DefaultRunLoop
            [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode 
                                     beforeDate:[NSDate distantFuture]];

        }
        [NSApp endModalSession:session];
        [NSApp endSheet:[alert window]];

        // Check the returnCode by using the global variable alertReturnStatus
        if(alertReturnStatus == NSAlertFirstButtonReturn) {
            return YES;
        }

        return NO;
    }
    return YES;
} 
```

希望它会有所帮助，干杯——汉斯

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-28T21:23:16.150

这是上面的 Laurent 等人的版本，翻译成 Xcode 6.4 的 Swift 1.2（截至今天的最新工作版本）并在我的应用程序中进行了测试。感谢所有为这项工作做出贡献的人！Apple 的标准文档没有给我任何关于如何进行的线索，至少在我能找到的任何地方都没有。

对我来说还有一个谜团：为什么我必须在 final 函数中使用双感叹号。NSApplication.mainWindow 应该只是一个可选的 NSWindow （NSWindow？），对吧？但是编译器给出了显示的错误，直到我使用第二个'！'。

```
extension NSAlert {
    func runModalSheetForWindow( aWindow: NSWindow ) -> Int {
        self.beginSheetModalForWindow(aWindow) { returnCode in
            NSApp.stopModalWithCode(returnCode)
        }
        let modalCode = NSApp.runModalForWindow(self.window as! NSWindow)
        return modalCode
    }

    func runModalSheet() -> Int {
        // Swift 1.2 gives the following error if only using one '!' below:
        // Value of optional type 'NSWindow?' not unwrapped; did you mean to use '!' or '?'?
        return runModalSheetForWindow(NSApp.mainWindow!!)
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T02:03:36.643

与 Windows 不同，我不相信有办法阻止模式对话框。输入（例如用户单击按钮）将在您的主线程上处理，因此无法阻止。

对于您的任务，您要么必须将消息向上传递，然后从中断的地方继续。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-03T13:09:10.443

当一个对象失败时，停止处理树中的对象，记下哪个对象失败（假设有订单，您可以从上次中断的地方继续），然后扔掉工作表。当用户关闭工作表时，让该`didEndSelector:`方法从它离开的对象重新开始处理，或者不处理，具体取决于`returnCode`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-06T07:56:46.243

```
- (bool) windowShouldClose: (id) sender
 {// printf("windowShouldClose..........\n");
  NSAlert *alert=[[NSAlert alloc ]init];
  [alert setMessageText:@"save file before closing?"];
  [alert setInformativeText:@"voorkom verlies van laatste wijzigingen"];
  [alert addButtonWithTitle:@"save"];
  [alert addButtonWithTitle:@"Quit"];
  [alert addButtonWithTitle:@"cancel"];
  [alert beginSheetModalForWindow: _window modalDelegate: self
              didEndSelector: @selector(alertDidEnd: returnCode: contextInfo:)
                 contextInfo: nil];
  return false;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-24T13:07:08.133

您可以使用`dispatch_group_wait(group, DISPATCH_TIME_FOREVER);`：

```
dispatch_group_t group = dispatch_group_create();
dispatch_group_enter(group);

NSAlert *alert = [[NSAlert alloc] init];
[alert setMessageText:@"alertMessage"];
[alert addButtonWithTitle:@"Cancel"];
[alert addButtonWithTitle:@"Ok"];

dispatch_async(dispatch_get_main_queue(), ^{
    [alert beginSheetModalForWindow:progressController.window completionHandler:^(NSModalResponse returnCode) {
         if (returnCode == NSAlertSecondButtonReturn) {
             // do something when the user clicks Ok

         } else {
             // do something when the user clicks Cancel
         }

         dispatch_group_leave(group);
     }];
});

dispatch_group_wait(group, DISPATCH_TIME_FOREVER);

//you can continue your code here 
```

希望有帮助。

# visual-studio-2005 - 如何将报表设计器标尺单位从英寸更改为厘米？

> ID：604773
> 
> 赞同：6
> 
> 时间：2009-03-03T01:25:40.523
> 
> 标签：visual-studio-2005, reporting-services

一个简单（我希望）的问题，我正在使用 Visual Studio，我在 SQL Server Business Intelligence Development Studio 中创建了一个新报告。在布局视图中，标尺以英寸为单位，我想将其更改为厘米。

**更新 1**

更改区域设置有效。

不更改区域设置就不能做到这一点吗？我希望这将是 Visual Studio 中的一个设置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T01:29:38.703

试试 Windows 区域设置？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-12T14:32:54.367

不确定如何在 BIDS 中进行设置，但如果您在文本编辑器（例如记事本）中打开 RDL 文件，您应该会看到文件底部：

```
 <Language>en-GB</Language>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>b5fa3be2-c9a8-41b7-bb70-df2e2e9e86ec</rd:ReportID>
</Report> 
```

将 rd:ReportUnitType 更改为

```
 <rd:ReportUnitType>Inch</rd:ReportUnitType> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T02:51:53.297

将区域设置从英语（美国）更改为英语（澳大利亚）

即通过开始 > 控制面板 > 区域和语言设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-27T13:42:02.810

这是可能的，至少在 9.0 版本中是这样。带上记录属性（报告/报告属性），您可以在那里选择以英寸或厘米为单位的度量。这包括报表元素的标尺和度量，如果您决定自己使用属性面板输入它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-04T10:46:27.233

无需更改 Windows 区域设置。您可以通过报告属性来完成。

我有 ReportBuilder 的 v15。你可以打开它，如图所示：

[![在此处输入图像描述](https://i.stack.imgur.com/u8gx7.png)](https://i.stack.imgur.com/u8gx7.png)

为了显示“**报告**”属性，而不是其他对象属性（正文，文本框字段的图表）。

取消选择报告中的任何内容以使报告属性可见。

请注意该设置仅适用于该报告，您需要为您拥有的每个报告更改它。

# apache-flex - 为什么从 getDefinitionByName() 返回对象？

> ID：604774
> 
> 赞同：1
> 
> 时间：2009-03-03T01:26:03.627
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3

在 Actionscript 3 中，为什么当文档说 getDefinitionByName() 返回一个对象：

> 返回对 name 参数指定的类的类对象的引用。

基于此，我会得出结论，返回的对象应该是 Class 而不是 Object。有人可以启发我为什么不是这样吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T01:31:33.330

getDefinitionByName 也可以返回一个 Function，例如 getDefinitionByName('flash.utils.getDefinitionByName')。不过，这只适用于命名空间级别的函数，不适用于静态类方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T09:52:58.527

尽管有方法签名，但 getDefinitionByName 确实返回[Class](http://livedocs.adobe.com/flex/3/langref/Class.html)。我认为误导性签名是由于 Class 对象之前存在的方法（当它用于返回匿名/扩展对象实例时）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T00:00:43.177

也许 Adob​​e 认为这个函数在 Flash Player 的未来版本中可能会返回不同的值。例如，ActionScript 所基于的标准 ECMAScript 历来使用`Function`带有原型的对象作为类对象的基础。在讨论 ECMAScript 标准的最新版本时，有人建议在运行时“冻结”基于函数的类，以使它们成为类似于编译时`Class`对象的东西。如果您还可以为它们指定定义名称怎么办？此时它们实际上是 type `Class`，还是仍然是 type `Function`？在我看来，可能是后者。'Class' 和 'Function' 引用都可以概括为`Object`，因此返回类型在这种情况下是有意义的。

注意：这个解释纯粹是基于我在[ECMAScript 规范 wiki](http://wiki.ecmascript.org/doku.php)和各个委员会成员的博客中阅读的内容的推测。

# .net - .NET 中是否有相当于进程外 COM EXE 的功能？

> ID：604776
> 
> 赞同：9
> 
> 时间：2009-03-03T01:27:11.597
> 
> 标签：.net, com, activex

COM/ActiveX 的优点之一是进程外 EXE。您可以有一个 EXE，它以一种其他进程（包括 VBScript 和 JScript）都可以使用的形式公开方法和属性。同时，EXE 可以有自己的功能，与它的类型库公开的功能相关或无关。

.NET 等价物是什么？

我有一个现有的 VB6 项目，它是一个脚本语言解释器（使用 MSScript）和其他脚本语言的各种工具功能的资源。有人建议我尝试将其转换为 .NET。

这会起作用吗，还是我最终会将一件物品分成两份？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T19:38:06.807

企业服务将允许您这样做。您可以将 COM 组件运行为：

*   一个 DLLHost 进程
*   一项服务
*   一个 inproc 库（这与您的其他代码在同一进程中）

互联网上有很多关于这些的例子。它归结为：

*   使用接口装饰您需要向 COM 公开的类
*   您要托管的组件需要从 ServicedComponent 派生
*   使用 GuidAttribute 装饰您的界面（使用唯一的 Guid）
*   使用 ComVisible(true) 属性装饰向 COM 公开的接口和类

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T01:35:05.883

.NET 对应关系是[.NET Remoting](http://en.wikipedia.org/wiki/.NET_Remoting)用于 .NET 2.0，[WCF](http://en.wikipedia.org/wiki/Windows_Communication_Foundation)用于 3.0+。但是，如果您需要与 COM 对象通信，则必须创建一个 COM 公开对象。那里有很多教程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T01:40:05.137

有几个选择；最明显的是[服务组件](http://msdn.microsoft.com/en-us/library/3x7357ez(VS.80).aspx)；这允许您在 COM+ 中托管托管代码以在单独的进程中运行它，但您需要 GAC/COM 可调用等。

# asp.net - 没有名称的 ASP.NET 网页，例如 stackoverflow？

> ID：604778
> 
> 赞同：5
> 
> 时间：2009-03-03T01:28:07.897
> 
> 标签：asp.net, seo, url-rewriting, url-routing

仅作为示例提到了 stackoverflow，但如果您查看 URL 上方的 ask 是

```
http://stackoverflow.com/questions/ask 
```

这意味着 /ask 是一个子目录，但他们也为特定的问题页面执行此操作。您如何在 .NET 中对此进行编码？

与其说是代码问题，不如说是技术问题。我知道这对 SEO 来说非常有用，但是您如何创建一个站点以使每个“页面”都是它自己的目录？动态地。

你有模板还是隐藏重定向？？？

如何？？:)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T01:31:42.803

它被称为 URL 重写：

[使用 ASP.NET 重写 URL](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)

[MSDN：ASP.NET 中的 URL 重写](http://msdn.microsoft.com/en-us/library/ms972974.aspx)

**编辑**：正如@Justice 指出的那样，StackOverflow 使用[Routing](http://msdn.microsoft.com/en-us/library/cc668201.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T01:51:41.833

StackOverflow 使用 .NET 3.5 SP1 附带的称为路由的东西。路由是许多 MVC 框架的流行特性，例如 ASP.NET MVC、Ruby on Rails 以及许多 Python 和 PHP 框架。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-03T01:39:04.923

Stack Overflow 是使用 ASP.NET MVC 构建的，它使用了一种称为路由的技术，请参阅：

[Stack Overflow 是用什么构建的？](https://blog.stackoverflow.com/2008/09/what-was-stack-overflow-built-with/)

和[路由](http://msdn.microsoft.com/en-us/library/cc668201.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T01:34:26.073

Stack Overflow 使用[ASP.net MVC](http://www.asp.net/mvc/)

MVC 使用 URL + Query String 来确定内容，所以它不像是指向特定页面的 URL，而更像是一些要显示的数据属性的分层路径

EG [https://stackoverflow.com/users/](https://stackoverflow.com/users/[Put) [把用户名放在这里]/[把用户名放在这里]

提示网站显示路径中指定 ID 的用户（在这种情况下，用户名可能只是为了踢球），而不是仅为该用户创建的特定页面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T03:38:19.270

我已经看到通过简单地为每个网页创建一个文件夹然后让每个文件夹包含一个 Default.aspx 文档来实现这一点（假设 Default.aspx 在 IIS 中设置为默认文档，这是默认设置）。然后，您可以导航到站点上的任何文件夹，而无需指定页面 (Default.aspx)。

对于动态部分，我使用过这种方式的 CMS 系统，Default.aspx 页面只是从一些主模板继承而来，CMS 系统利用 ASP.NET 渲染引擎来动态完成网页。

使用文件夹对站点结构来说可能有点繁重，但它是一种从浏览器中删除页面名称的简单方法。

This is how I structure my website and avoid having to use page names... for example [http://www.innovaapps.net/Blog](http://www.innovaapps.net/Blog) simply brings up the default.aspx page without having to specify the page name.

# svn - 为什么我的 SVN 命令行结账提供的文件/文件夹权限与 TortoiseSVN 不同？

> ID：604781
> 
> 赞同：2
> 
> 时间：2009-03-03T01:29:40.203
> 
> 标签：svn, tortoisesvn

当我使用命令行签出我的 SVN 存储库时

```
TortoiseProc /command:checkout /path:"C:/Sandbox/SPB" /url:"https://svn.digipen.edu/users/sbentley" /closeonend:3 
```

我可以很好地访问其中的所有文件。但是，这会提示我结帐，这是我不想要的。根据[自动化手册页](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-automation.html)：

> 请记住，TortoiseSVN 是一个 GUI 客户端，本自动化指南向您展示了如何使 TortoiseSVN 对话框出现以收集用户输入。如果你想编写一个不需要输入的脚本，你应该使用官方的 Subversion 命令行客户端。

但是，当我通过

```
svn co https://svn.digipen.edu/users/sbentley c:/sandbox/SPB 
```

并尝试运行任何可执行文件，我收到错误

> Windows 无法访问指定的设备、路径或文件。您可能没有适当的权限来访问该项目。

# 3gp - 如何上传 3gp 文件

> ID：604782
> 
> 赞同：0
> 
> 时间：2009-03-03T01:30:04.553
> 
> 标签：3gp

如何将 3gp 文件上传到我的服务器并查看它？有人告诉我我需要一个 htaccess。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T01:35:19.830

显然，如果您键入：

```
AddType video/3gpp 3gp .3gp 
```

在 .htaccess 文件中它会有所帮助。根据[诺基亚的论坛](http://discussion.forum.nokia.com/forum/showthread.php?t=109684)。好吧，如果我正确理解了这个问题。

# security - 最好的通用摘要功能？

> ID：604792
> 
> 赞同：2
> 
> 时间：2009-03-03T01:38:09.060
> 
> 标签：security, hash, digest

在 2009 年编写一个普通的新应用程序时，就安全性和性能而言，最合理的摘要功能是什么？（随着条件的变化，我如何在未来确定这一点？）

[之前](https://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database)[提出](https://stackoverflow.com/questions/657/encrypting-passwords)[类似](https://stackoverflow.com/questions/116684/what-algorithm-should-i-use-to-hash-passwords-into-my-database) [问题](https://stackoverflow.com/questions/184089/what-is-the-strongest-hashing-algorithm-commonly-available-today) 时，答案包括 SHA1、SHA2、SHA-256、SHA-512、MD5、bCrypt 和 Blowfish。

我意识到，在很大程度上，如果明智地使用这些中的任何一个都可以工作，但我宁愿不掷骰子并随机选择一个。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T01:42:00.283

我会遵循[NIST/FIPS 指南](http://csrc.nist.gov/groups/ST/hash/policy.html)：

> 2006 年 3 月 15 日：联邦机构可以将 SHA-2 系列哈希函数（即 SHA-224、SHA-256、SHA-384 和 SHA-512）用于使用安全哈希算法的所有应用程序。联邦机构应尽快停止将 SHA-1 用于数字签名、数字时间戳和其他需要抗碰撞的应用程序，并且必须在 2010 年之后将 SHA-2 系列哈希函数用于这些应用程序。2010 年之后，联邦机构可以仅将 SHA-1 用于以下应用： 基于散列的消息验证码 (HMAC)；密钥派生函数（KDF）；和随机数生成器 (RNG)。无论使用哪种方式，NIST 都鼓励应用程序和协议设计人员将 SHA-2 系列哈希函数用于所有新的应用程序和协议。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T02:08:58.423

你说“消化功能”；大概这意味着您想使用它来计算“长”消息的摘要（而不仅仅是像密码一样散列“短”“消息”）。这意味着 bCrypt 和类似的选择已经出局；它们的设计速度很慢，无法抑制对密码数据库的暴力攻击。MD5 彻底坏了，SHA-0 和 SHA-1 太弱了，不是很好的选择。Blowfish 是一种流密码（尽管您可以在产生摘要的模式下运行它），因此它也不是一个好的选择。

这留下了几个哈希函数系列，包括 SHA-2、HAVAL、RIPEMD、WHIRLPOOL 等。其中，SHA-2 系列是最彻底的密码分析，因此我建议将其用于一般用途。对于典型应用，我建议使用 SHA2-256 或 SHA2-512，因为这两种尺寸是最常见的，并且将来可能会被 SHA-3 支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T02:27:22.747

这真的取决于你需要什么。

如果您需要实际的安全性，而轻松发现冲突的能力会危及您的系统，我会使用 SHA-256 或 SHA-512 之类的东西，因为它们得到了各个机构的大力推荐。

如果你需要一些快速的东西，并且可以用来唯一地识别一些东西，但没有实际的安全要求（即，如果攻击者发现碰撞，他们将无法做任何令人讨厌的事情），那么我会使用类似 MD5 的东西。

MD4、MD5 和 SHA-1 已被证明比预期更容易破坏，即通过生日攻击方法发现碰撞。RIPEMD-160 备受推崇，但只有 160 位的生日攻击只需要 2^80 次操作，因此它不会永远持续下去。Whirlpool 具有出色的特性，并且看起来是最强大的，尽管它没有与 SHA-256 或 SHA-512 相同的支持 - 从某种意义上说，如果 SHA-256 或 SHA-512 有问题，你' d更有可能通过适当的渠道了解它。

# php - 从汇总的 MySQL 记录中选择

> ID：604800
> 
> 赞同：1
> 
> 时间：2009-03-03T01:43:56.067
> 
> 标签：php, mysql, sum

我正在使用 PHP 和 MySQL。

我有一个名为数量的表。里面有产品名称、产品价格和产品数量的记录。除此之外，还有一些其他工具可以帮助我根据日期和位置选择最后的记录，以及名为 price 的字段的 GROUP BY，因为同一产品有不同的数量和不同的价格。所以，我目前选择我的产品特定价格和数量，如下所示：

```
SELECT `price`,`quantity` FROM (SELECT `price`,`quantity` FROM `quantity` WHERE `product_name` = 'DELL' ORDER BY `date` DESC, `position`) AS `Actions` GROUP BY `price` 
```

此查询是一种解决方法，因为我需要获取如下数据：

```
product_name   |    price  |    quantity

DELL           |     100   |      30
DELL           |     120   |      10
DELL           |     130   |      2 
```

假设我有多个这样的记录，我需要获取最新的记录。无论如何，从这个查询中我需要执行以下操作：我需要选择其数量与另一个产品的数量之和等于 35 的记录。因此，通过使用我的查询，我知道它应该在第 2 行停止，因为我可以取 30 个产品价格为 100 美元，第 2 行的另外 5 种产品价格为 120 美元。然后我需要输入我的更新。因此，新数据如下所示：

```
product_name   |    price  |    quantity

DELL           |     100   |      0
DELL           |     120   |      5
DELL           |     130   |      2 
```

我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T02:16:25.253

**选项 1：使用程序逻辑而不是查询：**

使用编程层进行更高级的数据库交互并没有错。SQL 不是所有事情的答案......（也考虑一个存储过程）。

```
enough = 35
running_total = 0

START TRANSACTION
while running_total < enough:
    select one record order by price limit 1 FOR UPDATE
    add to running_total

UPDATE records...
COMMIT 
```

* * *

**选项 2：使用运行总计的查询：**

在此选项中，您使用派生查询获取运行总计，然后将其过滤到外部查询中的特定记录。如果您打算更新它们，则应将其包装在具有正确隔离级别的事务中。

```
SET @running_total = 0;
SELECT
    row_id,
    product_name,
    price,
    quantity
FROM
    (
    SELECT 
        row_id, 
        product_name, 
        price, 
        quantity, 
        @running_total := @running_total + quantity AS running_total
    FROM 
        sometable
    WHERE
        quantity > 0
    ORDER BY
        quantity
    LIMIT 
        35  /* for performance reasons :) */
    ) as T1
WHERE
    running_total < 35 
```

* * *

我倾向于选择选项 1，因为它更“明显”，但也许这会给你一些思考的余地。

# python - Python：在列表中查找元素

> ID：604802
> 
> 赞同：204
> 
> 时间：2009-03-03T01:45:02.990
> 
> 标签：python, list

什么是在 Python 中查找列表中元素索引的好方法？
请注意，列表可能未排序。

有没有办法指定使用什么比较运算符？

* * *

## 回答 #1

> 赞同：293
> 
> 时间：2009-03-03T01:52:21.770

从[潜入 Python](http://www.diveintopython.net/native_data_types/lists.html)：

```
>>> li
['a', 'b', 'new', 'mpilgrim', 'z', 'example', 'new', 'two', 'elements']
>>> li.index("example")
5 
```

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2011-02-17T10:00:06.910

如果你只是想知道一个元素是否包含在列表中：

```
>>> li
['a', 'b', 'new', 'mpilgrim', 'z', 'example', 'new', 'two', 'elements']
>>> 'example' in li
True
>>> 'damn' in li
False 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-03-03T01:51:56.983

最好的方法可能是使用[列表方法 .index](https://docs.python.org/tutorial/datastructures.html#more-on-lists)。

对于列表中的对象，您可以执行以下操作：

```
def __eq__(self, other):
    return self.Value == other.Value 
```

与您需要的任何特殊处理。

您还可以使用带有 enumerate(arr) 的 for/in 语句

查找值 > 100 的项目的索引的示例。

```
for index, item in enumerate(arr):
    if item > 100:
        return index, item 
```

[来源](http://www.daniweb.com/forums/thread174502.html)

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2010-09-24T09:35:48.307

这是使用列表理解的另一种方式（有些人可能会觉得它值得商榷）。对于简单的测试来说它非常平易近人，例如对象属性的比较（我需要很多）：

```
el = [x for x in mylist if x.attr == "foo"][0] 
```

当然，这假设列表中存在合适的元素（并且实际上是唯一性）。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2011-01-27T15:03:19.267

假设你想在一个 numpy 数组中找到一个值，我想这样的事情可能会起作用：

```
Numpy.where(arr=="value")[0] 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-03T01:50:45.080

有`index`方法，`i = array.index(value)`但我认为您不能指定自定义比较运算符。不过，编写自己的函数来做到这一点并不难：

```
def custom_index(array, compare_function):
    for i, v in enumerate(array):
        if compare_function(v):
            return i 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-10-20T12:30:48.473

我使用函数返回匹配元素的索引（Python 2.6）：

```
def index(l, f):
     return next((i for i in xrange(len(l)) if f(l[i])), None) 
```

然后通过 lambda 函数使用它来通过任何所需的方程式检索所需的元素，例如使用元素名称。

```
element = mylist[index(mylist, lambda item: item["name"] == "my name")] 
```

如果我需要在代码中的多个位置使用它，我只需定义特定的查找函数，例如按名称查找元素：

```
def find_name(l, name):
     return l[index(l, lambda item: item["name"] == name)] 
```

然后它非常简单易读：

```
element = find_name(mylist,"my name") 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-03T01:52:31.067

列表的 index 方法将为您执行此操作。如果要保证顺序，请先使用 对列表进行排序`sorted()`。Sorted 接受 cmp 或 key 参数来指示排序将如何发生：

```
a = [5, 4, 3]
print sorted(a).index(5) 
```

或者：

```
a = ['one', 'aardvark', 'a']
print sorted(a, key=len).index('a') 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-10-16T11:41:22.940

我通过改编一些 tutos 发现了这一点。感谢谷歌，感谢你们所有人；）

```
def findall(L, test):
    i=0
    indices = []
    while(True):
        try:
            # next value in list passing the test
            nextvalue = filter(test, L[i:])[0]

            # add index of this value in the index list,
            # by searching the value in L[i:] 
            indices.append(L.index(nextvalue, i))

            # iterate i, that is the next index from where to search
            i=indices[-1]+1
        #when there is no further "good value", filter returns [],
        # hence there is an out of range exeption
        except IndexError:
            return indices 
```

一个非常简单的用法：

```
a = [0,0,2,1]
ind = findall(a, lambda x:x>0))

[2, 3] 
```

PS scuse 我的英语

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-03T02:06:00.410

这个怎么样？

```
def global_index(lst, test):
    return ( pair[0] for pair in zip(range(len(lst)), lst) if test(pair[1]) ) 
```

用法：

```
>>> global_index([1, 2, 3, 4, 5, 6], lambda x: x>3)
<generator object <genexpr> at ...>
>>> list(_)
[3, 4, 5] 
```

# c# - 字符串规范化

> ID：604804
> 
> 赞同：0
> 
> 时间：2009-03-03T01:48:15.510
> 
> 标签：c#, .net-3.5, string, normalization

我正在编写一些需要进行字符串规范化的代码，我想将给定的字符串转换为驼峰式表示（嗯，至少最好的猜测）。例子：

```
"the quick brown fox" => "TheQuickBrownFox"
"the_quick_brown_fox" => "TheQuickBrownFox"
"123The_quIck bROWN FOX" => "TheQuickBrownFox"
"the_quick brown fox 123" => "TheQuickBrownFox123"
"thequickbrownfox" => "Thequickbrownfox" 
```

我认为你应该能够从这些例子中得到这个想法。我想去掉所有*特殊*字符（'、"、!、@、. 等），将每个单词大写（单词由空格、_ 或 - 定义）和删除的任何**前导数字**（尾随/内部都可以，但是这个要求并不重要，具体取决于难度）。

我正在努力找出实现这一目标的最佳方法。我的第一个猜测是使用正则表达式，但我的正则表达式技能充其量是不好的，所以我真的不知道从哪里开始。

我的另一个想法是循环和解析数据，将其分解为*单词*，解析每个单词，然后以这种方式重建字符串。

或者还有其他方法可以解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T02:20:38.083

在 Microsoft.VisualBasic 命名空间中使用[Strings.StrConv](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.strings.strconv.aspx)的简单解决方案怎么样？（不要忘记添加对 Microsoft.VisualBasic 的项目引用）：

```
using System;
using VB = Microsoft.VisualBasic;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(VB.Strings.StrConv("QUICK BROWN", VB.VbStrConv.ProperCase, 0));
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T02:15:24.570

此正则表达式匹配所有单词。然后，我们`Aggregate`使用一种方法将第一个字符大写，并将`ToLower`字符串的其余部分大写。

```
Regex regex = new Regex(@"[a-zA-Z]*", RegexOptions.Compiled);

private string CamelCase(string str)
{
    return regex.Matches(str).OfType<Match>().Aggregate("", (s, match) => s + CamelWord(match.Value));
}

private string CamelWord(string word)
{
    if (string.IsNullOrEmpty(word))
        return "";

    return char.ToUpper(word[0]) + word.Substring(1).ToLower();
} 
```

顺便说一下，这个方法忽略了数字。要添加它们，您可以将正则表达式更改为`@"[a-zA-Z]*|[0-9]*"`，我想 - 但我还没有测试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T02:36:40.867

任何涉及匹配特定字符的解决方案都可能不适用于某些字符编码，尤其是在使用 Unicode 表示时，它具有数十个空格字符、数千个“符号”、数千个标点字符、数千个“字母”等。尽可能使用内置的 Unicode 感知函数会更好。就什么是“特殊字符”而言，您可以根据[Unicode 类别](http://www.fileformat.info/info/unicode/category/index.htm)来决定。例如，它会包含“标点符号”，但会包含“符号”吗？

ToLower()、IsLetter() 等应该没问题，并考虑到 Unicode 中所有可能的字母。对破折号和斜杠的匹配可能应该考虑到 Unicode 中的几十个空格和破折号字符中的一些。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T04:08:53.423

你可以[穿红宝石拖鞋上班](http://whytheluckystiff.net/articles/wearingRubySlippersToWork.html):)

```
def camelize str
  str.gsub(/^[^a-zA-z]*/, '').split(/[^a-zA-Z0-9]/).map(&:capitalize).join
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T02:11:41.240

认为尝试它会很有趣，这就是我想出的：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            StringBuilder sb = new StringBuilder();
            string sentence = "123The_quIck bROWN FOX1234";

            sentence = sentence.ToLower();

            char[] s = sentence.ToCharArray();

            bool atStart = true;
            char pChar = ' ';

            char[] spaces = { ' ', '_', '-' };
            char a;
            foreach (char c in s)
            {
                if (atStart && char.IsDigit(c)) continue;

                if (char.IsLetter(c))
                {
                    a = c;
                    if (spaces.Contains(pChar))
                        a = char.ToUpper(a);
                    sb.Append(a);
                    atStart = false;
                }
                else if(char.IsDigit(c))
                {
                    sb.Append(c);
                }
                pChar = c;
            }

            Console.WriteLine(sb.ToString());
            Console.ReadLine();
        }
    }
} 
```

# ajax - 如何在不离开页面的情况下提供文件？

> ID：604806
> 
> 赞同：13
> 
> 时间：2009-03-03T01:49:44.727
> 
> 标签：ajax, web-applications, file-io

## 目标

我试图让用户通过单击页面上的按钮来下载文件（在这种情况下为 myfile.zip），**而不**让他们离开页面 - 即浏览器必须停留在当前页面上，并将它们留在他们所在的位置可以继续使用该页面，包括再次单击按钮（如果他们希望获得文件的新副本）。

我需要它在所有浏览器（IE6-8、Firefox、Chrome、Opera、Safari）上工作。

## 背景

打包在 zip 中的是基于来自同一页面的其他交互（其中一些可能部分完成）选择的内容（这都是通过 ajax 完成的），我不希望他们离开页面，因为他们会丢失任何未保存的更改。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-03T02:00:14.730

提供下载文件时添加以下标头：

```
Content-disposition: attachment; filename=filename.zip 
```

大多数浏览器会在清除当前页面之前等待查看它们正在加载的内容类型，如果它应该作为文件下载，它们将不会离开当前页面（它们将显示另存为对话框在页面前面，可以关闭返回页面）。

但是，如果您发现某个浏览器确实离开了当前页面，您可以尝试将下载链接包含在一个小的 iframe 中，这样只有该框架会发生变化。

我认为这是在新窗口中打开链接的更好解决方案，因为即使确定它是应该下载的文件，某些浏览器也会保留新窗口，因此您最终会得到一个空白窗口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T01:56:16.410

如果您使链接在新窗口/选项卡中打开（例如通过`<a>`标签的`target="_blank"`属性），它不会干扰当前窗口的内容。

该`target`属性已[弃用](http://diveintoaccessibility.org/day_16_not_opening_new_windows.html)，但得到广泛支持。根据浏览器的不同，您可能还可以使用 CSS3[`target-name`属性](http://www.w3.org/TR/css3-hyperlinks/#target0)。

如果您的目标是绝对保证主窗口不受干扰，这可能是最安全的方法，因为它可以抵御下载错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-05T19:48:40.343

为避免离开页面（如果您这样做，页面会尝试先自行关闭，以确保您已保存所有内容，如果未保存，则会收到警告消息）或留下空白标签（我没有喜欢，也没有使用 depreciated target 属性）我使用了一个 iframe，它的 src 属性在 javascript 中发生了更改。

除了某些版本的 Opera 之外，这适用于任何地方，我认为这是可以接受的损失（我可能会通过使用其他解决方案之一以及稍后的浏览器检测来解决这个问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T01:57:11.010

我相信如果您将用户引导到一个文件并且 MIME 类型是浏览器知道它必须下载和渲染的东西，浏览器将不会离开页面。例如，如果您提供一个 zip 文件，浏览器会知道它是一个 zip 文件并提示下载。但是，如果您要从页面请求中提供一个 zip 文件（即 /file.aspx?file=myinfo.zip），那么 file.aspx 需要在发回响应之前将 MIME 类型更改为“application/zip”为了提示用户下载。

这里的一个主要警告是，如果文件由于某种原因不存在，用户将收到 404 并被定向到错误页面。

作为不重定向用户的可靠方法，您可以打开一个弹出窗口进行下载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T02:01:55.163

我们通过将 ContentType 设置为“application/octet-stream”，然后使用 Response.BinaryWrite(..) 和 Response.Flush() 流式传输 zipfile，在 aspx 页面上的回发中执行此操作。

给用户一个弹出窗口“你想打开还是保存”文件。

页面仍然可用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T05:09:00.113

顺便说一句，单独指定适当的内容处置标头可能不适用于所有浏览器。具体来说，我看到它在 Opera 中不起作用，并且 IE7 显示黄色安全警告栏。

除了适当的标题，如 thomasrutter 所述，我完成此操作的方法是使用隐藏表单：

```
<form id="download_form" method="get" action=""></form> 
```

当用户单击一个按钮时，您可以使用文件的 URL 来操作表单的“action”属性。

这似乎适用于所有浏览器，甚至 IE7！

# emacs - Option 或 Command 键作为 Macintosh 上 LispBox 的 Meta 键

> ID：604808
> 
> 赞同：5
> 
> 时间：2009-03-03T01:50:15.050
> 
> 标签：emacs, lisp

我是 emacs 的新手，刚刚下载了带有 SBCL 的 LispBox（从 Practical Common Lisp 页面）到我的 Macintosh。我确实知道足够意识到我希望选项或命令键成为元键。

LispBox 附带的 emacs 版本不关注我的主目录中的 .emacs。

与 LispBox 一起交付的 Emacs 会触发到 REPL。我不知道我应该输入什么来将命令键设置为 Meta，也不知道在哪里或如何永久配置它。

编辑：我对加载另一个版本的 emacs 并不感兴趣。我已经从终端运行了 emacs，并将我的选项键映射为元。能够密切关注假设 LispInABox 的“Practical Common Lisp”教程是我在这里感兴趣的。

TIA。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T05:46:01.380

导航到`/Applications/Lispbox/Emacs.app/Contents/MacOS`并编辑`lispbox.`sh，删除`--no-init-file`参数。然后，在里面`~/.emacs`，添加`(setq mac-command-modifier 'meta)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T02:14:02.060

作为替代方案，请查看适用于 Mac OS X 的[Ready Lisp](http://www.newartisans.com/projects/ready-lisp.html)。它使用适用于 Emacs 的 Aquamacs。

Aquamacs 是专门为 Mac OS X 增强的 GNU Emacs。

如果您在 Mac OS X 终端中运行 Emacs，您可以使用“Preferences”对话框将 Option 键设置为 Meta 键。

# dns - 子域映射到另一个外部子域

> ID：604810
> 
> 赞同：0
> 
> 时间：2009-03-03T01:51:04.067
> 
> 标签：dns, mapping, cname

我正在尝试将 help.domain1.com 映射到 help.domain2.com。我在 UserVoice 上看到过这个。他们让您将something.yourdomain.com 映射到something.uservoice.com。

在 domain1.com 上，我为 help.domain2.com 设置了一个 CNAME。

它工作正常，但是当我打开 help.domain1.com 时，我得到的是 domain2.com 的内容，而不是 help.domain2.com。

经过一些实验，我意识到这是一种预期的行为。

所以我的问题是，当我浏览 help.domain1.com 时，我必须在 domain2.com（或者可能在 domain1.com 上？）上做什么才能让它显示子域“help.domain2.com”的内容？

（我使用的是 Plesk，操作系统是 Windows Server 2003）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-26T13:41:23.387

这两天我也遇到了同样的问题，刚刚找到了解决办法……

在 /etc/apache2/site-available/default 中，我有两个虚拟主机，第一个用于我的域，第二个用于我的子域。我所要做的就是颠倒虚拟主机块的顺序，将子域放在域的前面，它就起作用了！:D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T10:23:21.713

我找到了解决方案。一种方法是在 domain2.com 上使用 mod_rewrite 规则，如果引用者是 domain1.com，则进行重定向。或者分配一个专用IP地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:38:17.533

HTTP/1.1 使用`Host:`标头来确定正在请求哪个站点，如果有多个站点托管在同一个 IP 地址上。

您需要确保将第二个（目标）网络服务器配置为预期传入的 HTTP 请求，其中包含原始 URI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T10:25:31.367

我不是 100% 确定如何在 Windows 中执行此操作，但在 apache 中，您只需要设置一个虚拟主机即可将其从主域重定向到您的子域。

您没有说您使用的是 IIS 还是 apache 或网络服务器是什么。

我想您需要做的是在 IIS（不是虚拟目录）中设置一个新网站，然后在网站选项卡中单击高级并编辑其中的条目，以便“主机标头名称”是您想要的子域。

乔恩·霍金斯

# apache-flex - Flex：将 MXML 文件作为 XML 参数传递

> ID：604820
> 
> 赞同：2
> 
> 时间：2009-03-03T01:56:59.200
> 
> 标签：apache-flex, mxml

是否可以将 MXML 作为参数（XML 参数）从外部应用程序传递并动态加载到 Flash Player 中以创建页面。例如

将 xml = <mx:canvas><mx:label text="hello" /></mx:canvas> 传递给 Flex 和 flex 应该创建带有标签控件的画布。有没有相关的例子。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T03:12:09.473

需要先将 MXML 代码编译为 ActionScript，然后 Flash Player 才能对其执行任何操作。Flash Player 在运行时不解释 MXML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T13:59:58.697

你想做的事情是不可能的。就像 brd6644 所说，mxml 被编译成 swf 中的字节码，由 flash 播放器解释。Flash 播放器不理解 mxml（甚至是 actionscript）。

话虽如此，有一个可用于动态 MXML 的 JSP 库。看这里：

[http://www.adobe.com/devnet/flex/articles/server_perf_05.html](http://www.adobe.com/devnet/flex/articles/server_perf_05.html)

该链接很旧，现在我似乎找不到更新的链接，但我知道该项目仍然存在。我相信它实际上仍然是 ColdFusion 的一部分。它允许您创建动态 mxml，该 mxml 会根据请求编译 JIT。它当然会因此而对性能产生重大影响，但如果您需要动态 MXML，它是一种选择。

当我找到它时，我会用更好的链接更新这个评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-25T03:22:36.930

> **只需将组件的属性存储到 XML 并放置一个 className 属性，这样如果您加载 XML，您就可以使用一个函数将 XML 的属性设置为您创建的组件的属性，这将在您的 className 属性中确定**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T03:00:24.383

我最初的猜测是否定的，它仍然是“XML”类型，并且 Actionscript 3 中没有“eval”。我快速搜索了一下，我不得不说不，这是不可能的。

然而，我在我创建的应用程序中做了类似的事情。

我所做的是将对象类型和一些属性（x、y、宽度、高度等）存储在数据库中。此数据从远程对象调用返回，然后在运行时创建这些对象，这可以获得您想要实现的类似效果。

例如：

```
var resultAC:ArrayCollection = event.result as ArrayCollection;
var tmpCanvas:Canvas;

    for(var i:int = 0; i < resultAC.length; i++)
    {
      if(resultAC.getItemAt(i).type == "Canvas")
      {
         tmpCanvas = new Canvas();
         tmpCanvas.x = resultAC.getItemAt(i).x;
         tmpCanvas.y = resultAC.getItemAt(i).y;
         ...
         parent.addChild(tmpCanvas);
      }
    } 
```

# hosting - 移动主机，我如何查看网站？

> ID：604822
> 
> 赞同：0
> 
> 时间：2009-03-03T01:57:38.060
> 
> 标签：hosting, dns, windows-xp

我最近用我的博客移动了主机，我已经等了 72 小时才能正确正确地安装它。我刚刚检查了那里的网站，它显示在旧主机上。当我使用代理时，我可以在新主机上完美地看到该站点。问题似乎来自我的电脑。

**编辑：试图刷新 dns 并且它是同样的故事，这很奇怪。**

任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T02:12:00.273

您的旧 DNS 记录将保存在各种 DNS 缓存中，直到它们的 TTL（生存时间）计时器到期。最佳做法是在移动之前修改您的 DNS 记录，并将 TTL（生存时间）超时值拉低，留出足够的时间让旧记录超时并用短 TTL 记录刷新。然后在移动之后，您将 TTL 值放在新记录上（为了提高效率）。

现在您处于这种情况下，您将不得不忍受不一致，直到所有缓存记录都过期。如果你有办法在旧的 Web 服务器上放置一个 HTTP 重定向，指向一个 IP URL，这可能会让你在短期内渡过难关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T02:21:06.507

您的 ISP 是缓存记录的那个。使用主机文件[http://en.wikipedia.org/wiki/Hosts_file](http://en.wikipedia.org/wiki/Hosts_file)临时强制您的计算机使用新的 IP 地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T01:59:36.480

听起来您的机器上缓存了 DNS。这可以缓存在您的 PC 或 DNS 服务器上。短期期权；可以尝试刷新您的 DNS 缓存，您可以编辑您的主机文件以临时指向正确的位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T02:04:50.367

打开命令提示符并键入：

```
ipconfig /flushdns 
```

然后再次尝试您的网站。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T02:07:16.447

我看到这个：

www.keithdonegan.com [81.17.254.87]

我的 DNS 更改总是在几分钟内传播，最多几个小时。

# c# - 收藏已修改；枚举操作可能无法执行

> ID：604831
> 
> 赞同：1068
> 
> 时间：2009-03-03T02:01:58.987
> 
> 标签：c#, wcf, concurrency, dictionary, thread-safety

我无法深入了解这个错误，因为在附加调试器时，它似乎没有发生。

> 收藏已修改；枚举操作可能无法执行

下面是代码。

这是 Windows 服务中的 WCF 服务器。只要有数据事件，服务就会调用该方法`NotifySubscribers()`（以随机间隔，但不是很频繁 - 每天大约 800 次）。

当 Windows 窗体客户端订阅时，订阅者 ID 会添加到订阅者字典中，当客户端取消订阅时，它会从字典中删除。当（或之后）客户端取消订阅时，会发生错误。似乎下次`NotifySubscribers()`调用该方法时，`foreach()`循环失败，主题行出现错误。该方法将错误写入应用程序日志，如下面的代码所示。当附加调试器并且客户端取消订阅时，代码执行良好。

你看到这段代码有问题吗？我需要使字典线程安全吗？

```
[ServiceBehavior(InstanceContextMode=InstanceContextMode.Single)]
public class SubscriptionServer : ISubscriptionServer
{
    private static IDictionary<Guid, Subscriber> subscribers;

    public SubscriptionServer()
    {            
        subscribers = new Dictionary<Guid, Subscriber>();
    }

    public void NotifySubscribers(DataRecord sr)
    {
        foreach(Subscriber s in subscribers.Values)
        {
            try
            {
                s.Callback.SignalData(sr);
            }
            catch (Exception e)
            {
                DCS.WriteToApplicationLog(e.Message, 
                  System.Diagnostics.EventLogEntryType.Error);

                UnsubscribeEvent(s.ClientId);
            }
        }
    }

    public Guid SubscribeEvent(string clientDescription)
    {
        Subscriber subscriber = new Subscriber();
        subscriber.Callback = OperationContext.Current.
                GetCallbackChannel<IDCSCallback>();

        subscribers.Add(subscriber.ClientId, subscriber);

        return subscriber.ClientId;
    }

    public void UnsubscribeEvent(Guid clientId)
    {
        try
        {
            subscribers.Remove(clientId);
        }
        catch(Exception e)
        {
            System.Diagnostics.Debug.WriteLine("Unsubscribe Error " + 
                    e.Message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1889
> 
> 时间：2009-03-03T02:10:17.173

可能发生的情况是，`SignalData`在循环过程中间接更改了引擎盖下的订阅者字典并导致该消息。您可以通过更改来验证这一点

```
foreach(Subscriber s in subscribers.Values) 
```

到

```
foreach(Subscriber s in subscribers.Values.ToList()) 
```

如果我是对的，问题就会消失。

调用`subscribers.Values.ToList()`将 的值复制`subscribers.Values`到 开头的单独列表中`foreach`。没有其他东西可以访问这个列表（它甚至没有变量名！），所以没有任何东西可以在循环内修改它。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-03-03T02:13:12.563

当订阅者取消订阅时，您将在枚举期间更改订阅者集合的内容。

有几种方法可以解决这个问题，一种是将 for 循环更改为使用显式`.ToList()`：

```
public void NotifySubscribers(DataRecord sr)  
{
    foreach(Subscriber s in subscribers.Values.ToList())
    {
                                              ^^^^^^^^^  
        ... 
```

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2009-03-03T06:58:46.510

在我看来，一个更有效的方法是有另一个列表，您声明您将任何“要删除”的内容放入其中。然后在你完成你的主循环之后（没有.ToList()），你在“待删除”列表上做另一个循环，删除每个条目。因此，在您的课程中，您添加：

```
private List<Guid> toBeRemoved = new List<Guid>(); 
```

然后你把它改成：

```
public void NotifySubscribers(DataRecord sr)
{
    toBeRemoved.Clear();

    ...your unchanged code skipped...

   foreach ( Guid clientId in toBeRemoved )
   {
        try
        {
            subscribers.Remove(clientId);
        }
        catch(Exception e)
        {
            System.Diagnostics.Debug.WriteLine("Unsubscribe Error " + 
                e.Message);
        }
   }
}

...your unchanged code skipped...

public void UnsubscribeEvent(Guid clientId)
{
    toBeRemoved.Add( clientId );
} 
```

这不仅可以解决您的问题，还可以防止您必须继续从字典中创建列表，如果那里有很多订阅者，这会很昂贵。假设在任何给定迭代中要删除的订阅者列表低于列表中的总数，这应该更快。但是，如果您对特定的使用情况有任何疑问，当然可以随意对其进行分析，以确保情况确实如此。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2014-11-11T12:12:12.777

### 为什么会出现这个错误？

一般来说，.Net 集合不支持同时枚举和修改。如果您尝试在枚举期间修改集合列表，则会引发异常。所以这个错误背后的问题是，当我们循环遍历列表/字典时，我们不能修改它。

### 解决方案之一

如果我们使用它的键列表来迭代字典，我们可以并行地修改字典对象，因为我们正在迭代键集合而不是字典（并迭代它的键集合）。

### 例子

```
//get key collection from dictionary into a list to loop through
List<int> keys = new List<int>(Dictionary.Keys);

// iterating key collection using a simple for-each loop
foreach (int key in keys)
{
  // Now we can perform any modification with values of the dictionary.
  Dictionary[key] = Dictionary[key] - 1;
} 
```

这是有关此解决方案的[*博客文章。*](https://languagelassi.blogspot.com/2014/11/Collection-was-modified-enumeration-operation-may-not-execute.html)

并深入了解 StackOverflow：[为什么会出现此错误？](https://stackoverflow.com/a/3875401/1957479)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-07-22T14:14:46.080

好的，所以帮助我的是向后迭代。我试图从列表中删除一个条目，但向上迭代并且它搞砸了循环，因为该条目不再存在：

```
for (int x = myList.Count - 1; x > -1; x--)
{
    myList.RemoveAt(x);
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-03-16T07:20:55.977

**InvalidOperationException** - 发生 InvalidOperationException。它在 foreach 循环中报告“集合已修改”

使用 break 语句，一旦对象被删除。

前任：

```
ArrayList list = new ArrayList(); 

foreach (var item in list)
{
    if(condition)
    {
        list.remove(item);
        break;
    }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-05-23T16:10:21.383

实际上，在我看来，问题在于您正在从列表中删除元素并期望继续阅读列表，就好像什么都没发生一样。

你真正需要做的是从头开始，然后回到起点。即使您从列表中删除元素，您也可以继续阅读它。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-09-05T06:26:40.227

在最坏的情况下，接受的答案是不精确和不正确的。**如果在 期间进行了更改`ToList()`**，您仍然可能会遇到错误。此外`lock`，如果您有一个公共成员，则需要考虑哪些性能和线程安全性，一个合适的解决方案是使用[不可变类型](https://docs.microsoft.com/en-us/dotnet/api/system.collections.immutable)。

一般来说，不可变类型意味着一旦创建就不能更改它的状态。所以你的代码应该是这样的：

```
public class SubscriptionServer : ISubscriptionServer
{
    private static ImmutableDictionary<Guid, Subscriber> subscribers = ImmutableDictionary<Guid, Subscriber>.Empty;
    public void SubscribeEvent(string id)
    {
        subscribers = subscribers.Add(Guid.NewGuid(), new Subscriber());
    }
    public void NotifyEvent()
    {
        foreach(var sub in subscribers.Values)
        {
            //.....This is always safe
        }
    }
    //.........
} 
```

如果您有公共成员，这可能特别有用。其他类可以始终`foreach`使用不可变类型，而不必担心集合被修改。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-01-27T13:50:32.380

我想指出任何答案中都没有反映的其他情况。我`Dictionary<Tkey,TValue>`在一个多线程应用程序中有一个共享，它使用一个`ReaderWriterLockSlim`来保护读写操作。这是一个引发异常的读取方法：

```
public IEnumerable<Data> GetInfo()
{
    List<Data> info = null;
    _cacheLock.EnterReadLock();
    try
    {
        info = _cache.Values.SelectMany(ce => ce.Data); // Ad .Tolist() to avoid exc.
    }
    finally
    {
        _cacheLock.ExitReadLock();
    }
    return info;
} 
```

一般来说，它工作正常，但有时我会遇到异常。问题是 LINQ 的一个微妙之处：这段代码返回一个`IEnumerable<Info>`，在离开受锁保护的部分后仍然没有枚举。因此，它可以在被枚举之前被其他线程更改，从而导致异常。解决方案是强制枚举，例如`.ToList()`注释中所示。这样，可枚举的对象在离开受保护部分之前就已经被枚举了。

因此，如果在多线程应用程序中使用 LINQ，请注意始终在离开受保护区域之前实现查询。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-06-16T07:29:50.843

我有同样的问题，当我使用`for`循环而不是`foreach`.

```
// foreach (var item in itemsToBeLast)
for (int i = 0; i < itemsToBeLast.Count; i++)
{
    var matchingItem = itemsToBeLast.FirstOrDefault(item => item.Detach);

   if (matchingItem != null)
   {
      itemsToBeLast.Remove(matchingItem);
      continue;
   }
   allItems.Add(itemsToBeLast[i]);// (attachDetachItem);
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-03-04T20:55:23.760

我已经看到了很多选择，但对我来说这是最好的。

```
ListItemCollection collection = new ListItemCollection();
        foreach (ListItem item in ListBox1.Items)
        {
            if (item.Selected)
                collection.Add(item);
        } 
```

然后简单地遍历集合。

请注意，ListItemCollection 可以包含重复项。默认情况下，没有什么可以阻止将重复项添加到集合中。为避免重复，您可以这样做：

```
ListItemCollection collection = new ListItemCollection();
            foreach (ListItem item in ListBox1.Items)
            {
                if (item.Selected && !collection.Contains(item))
                    collection.Add(item);
            } 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-11-12T10:58:40.020

这种方式应该涵盖在仍在执行时再次调用函数时的并发情况（并且项目只需要使用一次）：

```
 while (list.Count > 0)
 {
    string Item = list[0];
    list.RemoveAt(0);

    // do here what you need to do with item

 } 
```

如果函数在仍在执行时被调用，项目将不会从第一次重复，因为它们一旦被使用就会被删除。对于小型列表，应该不会对性能产生太大影响。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-12-13T05:33:59.970

有一个链接，它阐述得非常好，还给出了解决方案。如果您有正确的解决方案，请尝试在此处发布，以便其他人可以理解。给定的解决方案是好的，然后就像帖子一样，所以其他人可以尝试这些解决方案。

供您参考原始链接：- [https://bensonxion.wordpress.com/2012/05/07/serializing-an-ienumerable-produces-collection-was-modified-enumeration-operation-may-not-execute/](https://bensonxion.wordpress.com/2012/05/07/serializing-an-ienumerable-produces-collection-was-modified-enumeration-operation-may-not-execute/)

当我们使用 .Net 序列化类来序列化其定义包含 Enumerable 类型（即集合）的对象时，您将很容易收到 InvalidOperationException 说“集合已修改；枚举操作可能无法执行”，而您的编码是在多线程场景下。根本原因是序列化类将通过枚举器遍历集合，因此，问题在于在修改集合时尝试迭代集合。

第一种方案，我们可以简单的使用锁作为同步方案，保证对List对象的操作一次只能从一个线程执行。显然，如果您想序列化该对象的集合，那么您将获得性能损失，那么对于它们中的每一个，都将应用锁。

好吧，.Net 4.0 可以方便地处理多线程场景。对于这个序列化 Collection 字段问题，我发现我们可以从 ConcurrentQueue(Check MSDN) 类中受益，它是一个线程安全和 FIFO 集合，并且使代码无锁。

使用这个类，简单来说，你需要为你的代码修改的东西是用它替换 Collection 类型，使用 Enqueue 在 ConcurrentQueue 的末尾添加一个元素，删除那些锁定代码。或者，如果您正在处理的场景确实需要 List 之类的集合内容，您将需要更多代码来将 ConcurrentQueue 调整到您的字段中。

顺便说一句，ConcurrentQueue 没有 Clear 方法，因为底层算法不允许原子地清除集合。所以你必须自己做，最快的方法是重新创建一个新的空 ConcurrentQueue 进行替换。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-10-30T04:52:41.343

以下是需要采用专门方法的特定场景：

1.  `Dictionary`经常被列举。
2.  `Dictionary`不经常修改。

`Dictionary`在这种情况下，在每次枚举之前创建（或）的副本`Dictionary.Values`可能会非常昂贵。我解决这个问题的想法是在多个枚举中重用相同的缓存副本，并观察`IEnumerator`原始`Dictionary`的异常。枚举器将与复制的数据一起被缓存，并在开始新的枚举之前被询问。如果出现异常，缓存的副本将被丢弃，并创建一个新副本。这是我对这个想法的实现：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;

public class EnumerableSnapshot<T> : IEnumerable<T>, IDisposable
{
    private IEnumerable<T> _source;
    private IEnumerator<T> _enumerator;
    private ReadOnlyCollection<T> _cached;

    public EnumerableSnapshot(IEnumerable<T> source)
    {
        _source = source ?? throw new ArgumentNullException(nameof(source));
    }

    public IEnumerator<T> GetEnumerator()
    {
        if (_source == null) throw new ObjectDisposedException(this.GetType().Name);
        if (_enumerator == null)
        {
            _enumerator = _source.GetEnumerator();
            _cached = new ReadOnlyCollection<T>(_source.ToArray());
        }
        else
        {
            var modified = false;
            if (_source is ICollection collection) // C# 7 syntax
            {
                modified = _cached.Count != collection.Count;
            }
            if (!modified)
            {
                try
                {
                    _enumerator.MoveNext();
                }
                catch (InvalidOperationException)
                {
                    modified = true;
                }
            }
            if (modified)
            {
                _enumerator.Dispose();
                _enumerator = _source.GetEnumerator();
                _cached = new ReadOnlyCollection<T>(_source.ToArray());
            }
        }
        return _cached.GetEnumerator();
    }

    public void Dispose()
    {
        _enumerator?.Dispose();
        _enumerator = null;
        _cached = null;
        _source = null;
    }

    IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();
}

public static class EnumerableSnapshotExtensions
{
    public static EnumerableSnapshot<T> ToEnumerableSnapshot<T>(
        this IEnumerable<T> source) => new EnumerableSnapshot<T>(source);
} 
```

使用示例：

```
private static IDictionary<Guid, Subscriber> _subscribers;
private static EnumerableSnapshot<Subscriber> _subscribersSnapshot;

//...(in the constructor)
_subscribers = new Dictionary<Guid, Subscriber>();
_subscribersSnapshot = _subscribers.Values.ToEnumerableSnapshot();

// ...(elsewere)
foreach (var subscriber in _subscribersSnapshot)
{
    //...
} 
```

不幸的是，这个想法目前不能与`Dictionary`.NET Core 3.0 中的类一起使用，因为这个类在枚举和调用方法时不会[抛出*Collection was modified*异常](https://stackoverflow.com/questions/58617273/unexpected-behavior-in-dictionary-methods-remove-and-clear-net-core)。我检查的所有其他容器都表现一致。我系统地检查了这些类： 、、、、和。只有.NET Core 中类的上述两个方法不会使枚举无效。[`Remove`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.remove)[`Clear`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.clear)`List<T>``Collection<T>``ObservableCollection<T>``HashSet<T>``SortedSet<T>``Dictionary<T,V>``SortedDictionary<T,V>``Dictionary`

* * *

**更新：**我通过比较缓存和原始集合的长度来解决上述问题。此修复假定字典将作为参数直接传递给`EnumerableSnapshot`的构造函数，并且它的身份不会被（例如）如下投影隐藏：`dictionary.Select(e => e).ΤοEnumerableSnapshot()`。

* * *

**重要提示：**上述类**不是**线程安全的。它旨在从专门在单个线程中运行的代码中使用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-05-29T13:59:41.383

您可以将订阅者字典对象复制到相同类型的临时字典对象，然后使用 foreach 循环迭代临时字典对象。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-10-04T14:04:10.027

因此，解决此问题的另一种方法是不删除元素，而是创建一个新字典，只添加您不想删除的元素，然后用新字典替换原始字典。我不认为这是一个太大的效率问题，因为它不会增加迭代结构的次数。

# c# - 在 DAL 中使用单例模式的优缺点

> ID：604844
> 
> 赞同：4
> 
> 时间：2009-03-03T02:10:35.207
> 
> 标签：c#, singleton, data-access-layer

我已经要求使用单例模式实现的 DAL，但我认为很难汇集连接，使用事务..等等

我想知道利弊，也想知道连接连接的最佳方式，因为我正在开发的站点可能有超过 500 个并发用户。

数据库服务器是 Oracle 10g。

DAL 使用 Enterprise library 3.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T06:50:17.873

单例模式非常适合 DAL —— 我在自己的企业 Web 应用程序中使用它（数百个用户和 20 多个单例类中的 2,000 多个方法）。连接池确实由 ado.net 和 sql 服务器本身处理得最好。如果您想要拥有多种类型的后端服务器，那不是问题。即使使用单例模式，您也可能需要一个集中的数据访问类来处理实际直接调用数据库的细节（参数、文本/过程名称、凭据/连接字符串都传入）。

在我的情况下，单个方法上的每个方法与我的数据库中的存储过程 1:1 对应。这实质上为每个存储过程创建了一个 C#“前端”钩子，因此从语法上讲，它们几乎可以像本机 C# 代码一样被调用。它使对 DAL 的调用非常简单。由于有大量的 SP，我有多个单身人士。每个 SP 都有一个前缀，例如 Development_、Financial_、Organization_ 或其他。然后我有一个对应于每个的单例类，例如开发、财务或组织。所以 sp Organization_ViewData 在 C# 中将是一个名为 ViewData 的方法，位于名为 Organization 的单例类上。

当然，这只是一种实现方式，但我发现在过去六年中，它可以很好地与多个开发人员和大量代码一起工作。最重要的是一致性是关键。如果前端程序员正在查看您的一个单例代理上的方法的名称，那应该告诉他们确切地知道它进入数据库端的位置。这样，如果出现问题，或者如果有人不得不搜索代码以试图理解它，那么必须进行的跟踪就会减少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T02:28:05.630

连接池的最佳实践是不要自己实现它，而是让 ADO.NET 框架来处理它。

您可以将连接池选项设置为连接字符串中的参数。然后，使用该字符串打开的每个连接都将由框架实现和管理的连接池提供。当您关闭或处置 OracleConnection 时，底层连接不会被破坏，而是会返回到池中。

这在这里描述：http: [//msdn.microsoft.com/en-us/library/ms254502.aspx](http://msdn.microsoft.com/en-us/library/ms254502.aspx)[](http://msdn.microsoft.com/en-us/library/ms254502.aspx)

关于 Singletons 的一般使用：我用它们来包装数据访问层，它一直运行良好。

请注意，事务仅适用于特定连接，而不适用于整个数据库。这意味着您可以运行多个线程，并且每个线程可以通过独立的事务读取和写入数据库，前提是每个线程使用单独的 OracleConnection 实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T02:12:13.190

我不了解 DAL，但单例模式是一种在保持良好封装的同时使数据全局化的好方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T02:14:35.600

在 DAL 中为数据库连接工厂使用单例是很常见的。它使您可以更轻松地插入工厂的不同实现，而无需更改大量代码。很多人似乎不喜欢单例模式，但我认为它适用于这种类型的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T02:32:56.807

我认为无论是否使用单例都不会产生性能差异，因为您仍然可以同时在同一方法上运行多个线程。如果您注意没有将在所有线程中共享的内部字段，那么一切都会运行良好。

最后，管理连接池的类需要是线程安全的，您最终会制作一些可能影响性能的锁，但它们都是必需的。（它是在框架内部制作的，无论如何你都无法改变它的行为）

如果您决定不使用单例，请确保您的 DAL 实例是轻量级的，因为这可能会有所作为，但通常情况并非如此。

注意：谈到连接池，您必须注意的唯一重要的事情是遵循“迟开早关”的模式。这意味着，尽可能延迟打开连接，并在完成所有需要后尽快关闭它。

使用此魔术规则构建所有系统后，您可以使用连接字符串参数来更改一些池选项（初始大小，最大大小，...）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T02:39:01.737

在 DAL 的情况下，我对使用单例有点不安。如果我想使用多个数据库后端怎么办。也许我想将 MsSQL 用于发票，但将 Active Directory 用于身份验证。或者也许我想使用 MySQL 来发布论坛帖子，但 PostgreSQL 用于地理集群（对我来说更现实，呵呵）。当我无法将模拟数据库连接传递给测试时，单例接口可能会使测试数据库层更具挑战性。

# perl - Perl 的 Expect 有 autoexpect 吗？

> ID：604853
> 
> 赞同：4
> 
> 时间：2009-03-03T02:14:14.837
> 
> 标签：perl, expect, autoexpect

我想[`Expect`](http://search.cpan.org/dist/Expect)自动生成 Perl 代码，Perl 是否[`autoexpect`](http://expect.nist.gov/example/autoexpect.man.html)存在类似的东西`Expect`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T21:53:04.747

这不是一个好的答案，但在一个好的答案出现之前必须这样做。

我运行了 TCL autoexpect 并创建了一个脚本文件，然后我编写了几行 perl 代码来解析带有“send”和“expect”标签的行，然后使用 perl expect 模块来运行它们以及其他一些操作。

这种混合方法让我通过，但我仍然希望有一个更好的答案。

# c++ - 如何在 MS Visual Studio 调试器中查看 DOMString（来自 apache xerces 库）？

> ID：604857
> 
> 赞同：2
> 
> 时间：2009-03-03T02:16:22.837
> 
> 标签：c++, visual-studio, apache, debugging, xerces

我正在研究使用[Apache Xerces-C](http://xerces.apache.org/xerces-c/)库的代码（遗留代码）。我试图`DOMString`在 Microsoft Visual Studio 调试器中查看（和其他相关 DOM 对象）的值，但徒劳无功。我试过以下

1）我在`autoexp.dat`文件中添加了以下内容：

```
;------------------------------------------------------------------------------
;Xerces
DOMString=<fHandle->fDSData->fData,su>
;------------------------------------------------------------------------------ 
```

结果：相同的行为，它显示了内存位置

2) 我尝试使用“ ”语法快速查看`DOMString`变量`var,su`

```
Result: "" 
```

我在[Apache Xerces General 邮件列表](http://mail-archives.apache.org/mod_mbox/xerces-general/)中提出了这个问题。

如果有人遇到这个问题并有解决方法，那对我会有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T20:22:07.500

在查看了 Xerces 库代码及其在我的代码库中的用法（我们只包含头文件）之后，我发现有一个用于调试的预处理器指令 (XML_DEBUG)。

如果尚未添加，您必须通过添加此预处理器指令来构建您的项目（使用 Xerces 项目/libaray）。

在 Visual Studio 中右键单击项目 -> 属性 -> C/C++ -> 预处理器，然后在预处理器定义中添加 XML_DEBUG

除此之外，您还需要编辑上面帖子中提到的 autoexp.dat 文件。

希望这可以帮助。

# javascript - Javascript RegExp 的有趣测试

> ID：604860
> 
> 赞同：8
> 
> 时间：2009-03-03T02:18:18.870
> 
> 标签：javascript, regex

我写了一个 Javascript RegExp 测试来检测日期字符串格式，我错误地添加了一个多余的“g”标志，发现了一些有趣的东西。

```
var s = "2009/03/10";
var regex=/^\d{4}[/]\d{2}[/]\d{2}$/g;
alert(regex.test(s));
alert(regex.test(s));
alert(regex.test(s));
alert(regex.test(s)); 
```

我得到一个“真”，然后是一个“假”，然后是另一个“真”，然后是另一个“假”。

如果我使用循环来执行它，我发现了更有趣的东西，我在 IE 和 Safari 中得到了四个“真”，在 FF、Chrome 中得到了真、假、真、假。

```
for (var i=0; i<4; i++)
{
  var s = "2009/03/10";
  var regex=/^\d{4}[/]\d{2}[/]\d{2}$/g;
  alert(regex.test(s));
} 
```

有没有人知道为什么 Javascript 正则表达式的行为如此，以及是什么原因导致浏览器返回不同的结果？（与变量声明和生命范围有关？）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-03T02:30:25.843

当您在 JS RegExp 上使用全局标志时，“test”和“exec”方法都会在第一次匹配时停止，但会保留一个指向它们在字符串中停止搜索的位置的指针。可以在`lastIndex`属性上检查该指针。当您再次调用“test”或“exec”时，它开始搜索从`lastIndex`.

因此，当您在与整个字符串匹配的字符串上测试 RegExp 时，lastIndex 设置为字符串的末尾。下次测试时，它会从字符串的末尾开始，返回`false`并设置`lastIndex`回零。

MDC 对这种行为有一个[不错的解释](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp/lastIndex)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-22T16:12:42.453

为了避免这种奇怪的行为，不要使用全局 (g) 标志。

此代码应输出：'True','True','True','True'

```
var s = "2009/03/10";
var regex=/^\d{4}[/]\d{2}[/]\d{2}$/i;
alert(regex.test(s));
alert(regex.test(s));
alert(regex.test(s));
alert(regex.test(s)); 
```

全局 (g) 平面设置属性 RegExp.lastIndex。所以每个 test() 将从最后一个停止的地方开始。

有关更多信息，请参阅有关[RegExp.lastIndex 的文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/lastIndex)

# c# - 使用C#将sql语句作为字符串传递给mssql？

> ID：604862
> 
> 赞同：1
> 
> 时间：2009-03-03T02:18:42.907
> 
> 标签：c#, ado.net

这是一个非常非常愚蠢的问题，但我非常习惯于使用 linq / 其他方法来连接和查询数据库，因此我从未停止过从头开始学习如何做到这一点。

问题：如何建立到数据库的手动连接并在 C# 中将字符串参数传递给它？（是的，我知道......纯粹的无知）。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T02:26:19.817

```
using (SqlConnection conn = new SqlConnection(databaseConnectionString))
{
    using (SqlCommand cmd = conn.CreateCommand())
    {
        cmd.CommandText = "StoredProcedureName";
        cmd.CommandType = CommandType.StoredProcedure;

        cmd.Parameters.AddWithValue("@ID", fileID);

        conn.Open();
        using (SqlDataReader rdr =
                   cmd.ExecuteReader(CommandBehavior.CloseConnection))
        {
            if (rdr.Read())
            {
                // process row from resultset;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T02:21:10.470

使用[`SqlCommand`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx)ado.net 使用该类在 SQL Server 上执行命令（存储过程或 sql）。教程比比皆是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T02:22:21.667

[这是来自http://www.csharp-station.com/Tutorials/AdoDotNet/Lesson07.aspx](http://www.csharp-station.com/Tutorials/AdoDotNet/Lesson07.aspx)的示例

```
public void RunStoredProcParams()
    {
        SqlConnection conn = null;
        SqlDataReader rdr  = null;

        // typically obtained from user
        // input, but we take a short cut
        string custId = "FURIB";

        Console.WriteLine("\nCustomer Order History:\n");

        try
        {
            // create and open a connection object
            conn = new 
                SqlConnection("Server=(local);DataBase=Northwind;Integrated Security=SSPI");
            conn.Open();

            // 1\.  create a command object identifying
            //     the stored procedure
            SqlCommand cmd  = new SqlCommand(
                "CustOrderHist", conn);

            // 2\. set the command object so it knows
            //    to execute a stored procedure
            cmd.CommandType = CommandType.StoredProcedure;

            // 3\. add parameter to command, which
            //    will be passed to the stored procedure
            cmd.Parameters.Add(
                new SqlParameter("@CustomerID", custId));

            // execute the command
            rdr = cmd.ExecuteReader();

            // iterate through results, printing each to console
            while (rdr.Read())
            {
                Console.WriteLine(
                    "Product: {0,-35} Total: {1,2}",
                    rdr["ProductName"],
                    rdr["Total"]);
            }
        }
        finally
        {
            if (conn != null)
            {
                conn.Close();
            }
            if (rdr != null)
            {
                rdr.Close();
            }
        }   
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T03:13:18.067

其他人还没有向您展示的 3 件事：

*   使用语句“堆叠”
*   设置明确的参数类型，而不是让 .Net 尝试为您选择一个
*   “var”关键字

.

```
string sql = "MyProcedureName";

using (var cn = new SqlConnection(databaseConnectionString))
using (var cmd = new SqlCommand(sql, cn))
{
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.Parameters.Add("@ParameterName", SqlDbType.VarChar, 50)
        .Value = "MyParameterValue";

    conn.Open();
    using (SqlDataReader rdr =
               cmd.ExecuteReader(CommandBehavior.CloseConnection))
    {
        if (rdr.Read())
        {
            // process row from resultset;
        }
    }
} 
```

# linux - 在 Bash 中打印文件，跳过前 X 行

> ID：604864
> 
> 赞同：681
> 
> 时间：2009-03-03T02:19:54.090
> 
> 标签：linux, bash, printing, skip

例如，我有一个很长的文件要打印，跳过前 1,000,000 行。

我查看了 cat 手册页，但没有看到任何选项可以执行此操作。我正在寻找执行此操作的命令或简单的 Bash 程序。

* * *

## 回答 #1

> 赞同：1106
> 
> 时间：2009-03-03T02:24:05.813

你需要尾巴。一些例子：

```
$ tail great-big-file.log
< Last 10 lines of great-big-file.log > 
```

如果您确实需要跳过特定数量的“第一”行，请使用

```
$ tail -n +<N+1> <filename>
< filename, excluding first N lines. > 
```

也就是说，如果要跳过 N 行，则开始打印第 N+1 行。例子：

```
$ tail -n +11 /tmp/myfile
< /tmp/myfile, starting at line 11, or skipping the first 10 lines. > 
```

如果您只想查看最后这么多行，请省略“+”：

```
$ tail -n <N> <filename>
< last N lines of file. > 
```

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2012-10-17T07:17:01.723

我发现删除文件前十行的最简单方法：

```
$ sed 1,10d file.txt 
```

在一般情况下，`X`要删除的初始行数是多少，请将此归功于评论者和编辑：

```
$ sed 1,Xd file.txt 
```

* * *

## 回答 #3

> 赞同：112
> 
> 时间：2009-03-03T02:28:45.270

如果您的系统上有可用的 GNU tail，您可以执行以下操作：

```
tail -n +1000001 huge-file.log 
```

它是`+`做你想做的事的角色。引用手册页：

> 如果 K 的第一个字符（字节数或行数）是“+”，则从每个文件开头的第 K 个项目开始打印。

因此，如注释中所述，将 +1000001 放在前 1,000,000 行之后的第一项开始打印。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2013-07-09T18:10:26.630

如果你想跳过前两行：

```
tail -n +3 <filename> 
```

如果你想跳过第一个 x 行：

```
tail -n +$((x+1)) <filename> 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2013-04-26T14:31:59.840

使用 AWK 的不那么冗长的版本：

```
awk 'NR > 1e6' myfile.txt 
```

但我建议使用整数。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2016-12-02T16:19:22.947

使用带有[范围地址的](https://www.gnu.org/software/sed/manual/html_node/Addresses.html)[sed`delete`命令](https://www.gnu.org/software/sed/manual/html_node/Common-Commands.html#Common-Commands)。例如：

```
sed 1,100d file.txt # Print file.txt omitting lines 1-100. 
```

或者，如果您只想打印已知范围，请使用带有`-n`标志的 print 命令：

```
sed -n 201,300p file.txt # Print lines 201-300 from file.txt 
```

无论是否存在 GNU 实用程序，该解决方案都应该在所有 Unix 系统上可靠地工作。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2018-08-03T16:23:44.437

采用：

```
sed -n '1d;p' 
```

此命令将删除第一行并打印其余部分。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2012-12-20T10:04:41.057

如果您想查看前 10 行，可以使用 sed，如下所示：

```
sed -n '1,10 p' myFile.txt 
```

或者，如果您想查看从 20 到 30 的行，您可以使用：

```
sed -n '20,30 p' myFile.txt 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2012-01-26T06:53:15.973

只是提出一个`sed`替代方案。:) 要跳过前一百万行，请尝试`|sed '1,1000000d'`.

例子：

```
$ perl -wle 'print for (1..1_000_005)'|sed '1,1000000d'
1000001
1000002
1000003
1000004
1000005 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2009-03-31T13:28:55.043

这个 shell 脚本对我来说很好用：

```
#!/bin/bash
awk -v initial_line=$1 -v end_line=$2 '{
    if (NR >= initial_line && NR <= end_line) 
    print $0
}' $3 
```

与此示例文件 (file.txt) 一起使用：

```
one
two
three
four
five
six 
```

命令（它将从文件的第二行到第四行提取）：

```
edu@debian5:~$./script.sh 2 4 file.txt 
```

此命令的输出：

```
two
three
four 
```

当然，您可以改进它，例如通过测试所有参数值是否符合预期:-)

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2009-03-03T02:25:27.043

您可以使用 head 和 tail 命令执行此操作：

```
head -n <num> | tail -n <lines to print> 
```

其中 num 是 1e6 + 要打印的行数。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-11-21T20:14:27.230

```
cat < File > | awk '{if(NR > 6) print $0}' 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-05-28T17:30:58.980

我需要做同样的事情并找到了这个线程。

我尝试了“tail -n +，但它只是打印了所有内容。

更多的 + 行在提示符下工作得很好，但事实证明它在无头模式（cronjob）下运行时表现完全不同。

我终于自己写了这个：

```
skip=5
FILE="/tmp/filetoprint"
tail -n$((`cat "${FILE}" | wc -l` - skip)) "${FILE}" 
```

# ruby-on-rails - 我可以在做 STI 的同时仍然使用多态路径助手吗？

> ID：604870
> 
> 赞同：13
> 
> 时间：2009-03-03T02:23:54.767
> 
> 标签：ruby-on-rails, ruby

我正在使用单表继承并对所有子类进行评论。对于所有不同的 STI 类型，我只使用 1 个控制器。当 form_for 助手为子类型生成 URL 时，它会尝试为子类型使用助手，但我希望它为父类型使用助手。

这是我得到的错误：

```
undefined method `subclasstypename_comments_path' for #<ActionView::Base:0x41ef27c> 
```

它“应该”使用的路径助手是

```
parentclasstypename_comments_path 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-03-03T05:08:44.950

是的，只需使用`AR::Base#becomes`.

假设您的基类是`Account`，它是 and 的子`GuestAccount`类`LoginAccount`。

```
@account.is_a? LoginAccount? #=> true 
```

然后你可以做一个

```
form_for [@account.becomes(Account), @comment] do |f|
  ... 
```

# sql - 如何学习 SQL Server 索引调优？

> ID：604879
> 
> 赞同：7
> 
> 时间：2009-03-03T02:28:10.920
> 
> 标签：sql, sql-server, tsql, indexing, performance

在编写 tsql 查询时学习索引调优的最佳实用方法是什么？我有 VS2008 SQL Express。有人可以给我提供例子等吗？我已经找到了在线文章，它们在理论上很不错，但是我仍然看不到索引调整在现实生活中的作用。有没有容易创建的小例子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T02:38:14.953

要调整索引，您往往需要包含大量数据的大型表，因此不容易获得简单的小示例。

我的经验是使用 SQL 2000 工具。查询分析器，显示执行计划并查看使用的索引类型和连接。在这里很难描述。

我可以推荐一本关于这个主题的好书，尤其是第 9 章。

[http://www.amazon.com/Professional-Server-Performance-Tuning-Programmer/dp/0470176393](https://rads.stackoverflow.com/amzn/click/com/0470176393)

在您了解如何自己手动操作之前，我不鼓励您使用自动索引调整工具。我认为当它建议添加一个索引时，你有能力对建议进行健全性检查并自行决定它是否是一个好的选择，这一点很重要。通常它会建议您添加一个包含许多列的“覆盖”索引，以加快您要求分析的单个查询，但是当您查看针对该表的所有查询时，这可能会对您的数据库整体产生不利影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T03:19:28.050

Kimberly Trip（SQL 女神）是一位专家，并就该主题进行了很多讨论和撰写：

[http://www.sqlskills.com/BLOGS/KIMBERLY/category/Indexes.aspx](http://www.sqlskills.com/BLOGS/KIMBERLY/category/Indexes.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T03:26:19.783

Ken England 的[Microsoft SQL Server 2000 性能优化和调优手册](https://rads.stackoverflow.com/amzn/click/com/1555582419)是经典之作。（亚马逊评论说这本书的 2005 年版本没有那么好）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T02:37:14.017

如果你有 SQL Developer 版本，你想看看数据库引擎优化顾问。

如果您使用分析器针对您的数据库捕获标准工作负载，DETA 可以推荐您可以应用哪些统计信息和索引。

请注意，尽管调整需要深思熟虑，因为添加新索引可能会增加工作负载的速度，但您可能会增加不重要查询的速度而损害非常重要的查询。

有一本关于 TSQL 查询的好书，其中有一些关于查询如何工作以及如何调整它们的非常好的建议，这是特定于 MSSQL 的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T02:37:58.073

在 SQL Server 中，如果您的数据库架构更简单，您实际上不需要进行太多调整，因为主键会自动生成聚集索引，而外键约束需要唯一索引。因此，通常会处理您的联接。

棘手的地方在于应用程序中的查询使用的搜索和过滤器。您必须专门查看这些查询并确定其他索引的候选者。

另一种选择是 SQL Server Tuning Advisor，但我不鼓励使用它，因为它会产生很多噪音。不过，您可以使用它来查找最糟糕的查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T02:40:17.007

有关识别性能最差查询的起点，请[在此处](https://stackoverflow.com/questions/257906/ms-sql-server-2008-how-can-i-log-and-find-the-most-expensive-queries)查看我的答案。

学习如何调音是需要练习的。如果您想精通它，请先购买 Sajal Dam 的书[SQL Server Query Performance Tuning Distilled](https://rads.stackoverflow.com/amzn/click/com/1590594215)

# asp.net-mvc - 将特定于视图的 javascript 文件放在 ASP.NET MVC 应用程序中的什么位置？

> ID：604883
> 
> 赞同：97
> 
> 时间：2009-03-03T02:30:14.503
> 
> 标签：asp.net-mvc

在 ASP.NET MVC 应用程序中放置特定于视图的 javascript 文件的最佳位置是什么（哪个文件夹等）？

为了使我的项目井井有条，我真的很希望能够将它们与视图的 .aspx 文件并排放置，但是在不暴露 ~/Views 的情况下，我还没有找到一种引用它们的好方法/Action/ 文件夹结构。让文件夹结构的细节泄露真的是一件坏事吗？

另一种方法是将它们放在 ~/Scripts 或 ~/Content 文件夹中，但这有点烦人，因为现在我不得不担心文件名冲突。不过，如果这是“正确的事情”，我可以克服这种烦恼。

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2011-06-23T12:07:25.363

老问题，但我想提出我的答案，以防其他人来寻找它。

我也希望在 views 文件夹下查看特定于视图的 js/css 文件，这就是我的做法：

在 /Views 根目录的 web.config 文件夹中，您需要修改两个部分以使网络服务器能够提供文件：

```
 <system.web>
        <httpHandlers>
            <add path="*.js" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
            <add path="*.css" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
            <add path="*" verb="*" type="System.Web.HttpNotFoundHandler"/>
        </httpHandlers>
        <!-- other content here -->
    </system.web>

    <system.webServer>
        <handlers>
            <remove name="BlockViewHandler"/>
            <add name="JavaScript" path="*.js" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
            <add name="CSS" path="*.css" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
            <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler" />
        </handlers>
        <!-- other content here -->
    </system.webServer> 
```

然后从您的视图文件中，您可以像您期望的那样引用网址：

```
@Url.Content("~/Views/<ControllerName>/somefile.css") 
```

这将允许提供 .js 和 .css 文件，并禁止提供任何其他文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-06-07T05:44:11.893

实现此目的的一种方法是提供您自己的`ActionInvoker`. 使用下面包含的代码，您可以添加到控制器的构造函数中：

```
ActionInvoker = new JavaScriptActionInvoker(); 
```

`.js`现在，每当您在视图旁边放置文件时：

![在此处输入图像描述](https://i.stack.imgur.com/k7j9G.png)

您可以直接访问它：

```
http://yourdomain.com/YourController/Index.js 
```

以下是来源：

```
namespace JavaScriptViews {
    public class JavaScriptActionDescriptor : ActionDescriptor
    {
        private string actionName;
        private ControllerDescriptor controllerDescriptor;

        public JavaScriptActionDescriptor(string actionName, ControllerDescriptor controllerDescriptor)
        {
            this.actionName = actionName;
            this.controllerDescriptor = controllerDescriptor;
        }

        public override object Execute(ControllerContext controllerContext, IDictionary<string, object> parameters)
        {
            return new ViewResult();
        }

        public override ParameterDescriptor[] GetParameters()
        {
            return new ParameterDescriptor[0];
        }

        public override string ActionName
        {
            get { return actionName; }
        }

        public override ControllerDescriptor ControllerDescriptor
        {
            get { return controllerDescriptor; }
        }
    }

    public class JavaScriptActionInvoker : ControllerActionInvoker
    {
        protected override ActionDescriptor FindAction(ControllerContext controllerContext, ControllerDescriptor controllerDescriptor, string actionName)
        {
            var action = base.FindAction(controllerContext, controllerDescriptor, actionName);
            if (action != null)
            {
                return action;
            } 

            if (actionName.EndsWith(".js"))
            {
                return new JavaScriptActionDescriptor(actionName, controllerDescriptor);
            }

            else 
                return null;
        }
    }

    public class JavaScriptView : IView
    {
        private string fileName;

        public JavaScriptView(string fileName)
        {
            this.fileName = fileName;
        }

        public void Render(ViewContext viewContext, TextWriter writer)
        {
            var file = File.ReadAllText(viewContext.HttpContext.Server.MapPath(fileName));
            writer.Write(file);
        }
    }

    public class JavaScriptViewEngine : VirtualPathProviderViewEngine
    {
        public JavaScriptViewEngine()
            : this(null)
        {
        }

        public JavaScriptViewEngine(IViewPageActivator viewPageActivator)
            : base()
        {
            AreaViewLocationFormats = new[]
            {
                "~/Areas/{2}/Views/{1}/{0}.js",
                "~/Areas/{2}/Views/Shared/{0}.js"
            };
            AreaMasterLocationFormats = new[]
            {
                "~/Areas/{2}/Views/{1}/{0}.js",
                "~/Areas/{2}/Views/Shared/{0}.js"
            };
            AreaPartialViewLocationFormats = new []
            {
                "~/Areas/{2}/Views/{1}/{0}.js",
                "~/Areas/{2}/Views/Shared/{0}.js"
            };
            ViewLocationFormats = new[]
            {
                "~/Views/{1}/{0}.js",
                "~/Views/Shared/{0}.js"
            };
            MasterLocationFormats = new[]
            {
                "~/Views/{1}/{0}.js",
                "~/Views/Shared/{0}.js"
            };
            PartialViewLocationFormats = new[]
            {
                "~/Views/{1}/{0}.js",
                "~/Views/Shared/{0}.js"
            };
            FileExtensions = new[]
            {
                "js"
            };
        }

        public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
        {
            if (viewName.EndsWith(".js"))
                viewName = viewName.ChopEnd(".js");
            return base.FindView(controllerContext, viewName, masterName, useCache);
        }

        protected override IView CreatePartialView(ControllerContext controllerContext, string partialPath)
        {
            return new JavaScriptView(partialPath);
        }

        protected override IView CreateView(ControllerContext controllerContext, string viewPath, string masterPath)
        {
            return new JavaScriptView(viewPath);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-15T20:14:37.427

您可以反转 davesw 的建议并仅阻止 .cshtml

```
<httpHandlers>
    <add path="*.cshtml" verb="*" type="System.Web.HttpNotFoundHandler"/>
</httpHandlers> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-27T18:56:56.293

我知道这是一个相当古老的话题，但我有几件事想补充。我尝试了 davesw 的回答，但在尝试加载脚本文件时抛出 500 错误，所以我不得不将其添加到 web.config：

```
<validation validateIntegratedModeConfiguration="false" /> 
```

到 system.webServer。这是我所拥有的，我能够让它工作：

```
<system.webServer>
  <handlers>
    <remove name="BlockViewHandler"/>
    <add name="JavaScript" path="*.js" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
    <add name="CSS" path="*.css" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
    <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler" />
  </handlers>
  <validation validateIntegratedModeConfiguration="false" />
</system.webServer>
<system.web>
  <compilation>
    <assemblies>
      <add assembly="System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    </assemblies>
  </compilation>
  <httpHandlers>
      <add path="*.js" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
      <add path="*.css" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
      <add path="*" verb="*" type="System.Web.HttpNotFoundHandler"/>
  </httpHandlers>
</system.web> 
```

以下是有关验证的更多信息：[https ://www.iis.net/configreference/system.webserver/validation](https://www.iis.net/configreference/system.webserver/validation)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-24T20:49:31.107

将此代码添加到 system.web 标记内的 web.config 文件中

```
<handlers>
    <remove name="BlockViewHandler"/>
    <add name="JavaScript" path="*.js" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
    <add name="CSS" path="*.css" verb="GET,HEAD" type="System.Web.StaticFileHandler" />
     <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler" />
</handlers> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-10T19:01:10.013

我还想将与视图相关的 js 文件放在与视图相同的文件夹中。

我无法让该线程中的其他解决方案正常工作，并不是说它们坏了，而是我对 MVC 太陌生，无法让它们正常工作。

使用此处给出的信息和其他几个堆栈，我想出了一个解决方案：

*   允许将 javascript 文件放置在与其关联的视图相同的目录中。
*   脚本 URL 不会泄露底层物理站点结构
*   脚本 URL 不必以斜杠 (/) 结尾
*   不干扰静态资源，例如：/Scripts/someFile.js 仍然有效
*   不需要启用 runAllManagedModulesForAllRequests。

注意：我也在使用 HTTP 属性路由。在我的灵魂中使用的路线可能会被修改为在不启用此功能的情况下工作。

给定以下示例目录/文件结构：

```
Controllers
-- Example
   -- ExampleController.vb

Views
-- Example
   -- Test.vbhtml
   -- Test.js 
```

使用下面给出的配置步骤，结合上面的示例结构，测试视图 URL 将通过以下方式访问：`/Example/Test`并且 javascript 文件将通过以下方式引用：`/Example/Scripts/test.js`

**第 1 步 - 启用属性路由：**

编辑您的 /App_start/RouteConfig.vb 文件并`routes.MapMvcAttributeRoutes()`在现有 routes.MapRoute 上方添加：

```
Imports System
Imports System.Collections.Generic
Imports System.Linq
Imports System.Web
Imports System.Web.Mvc
Imports System.Web.Routing

Public Module RouteConfig
    Public Sub RegisterRoutes(ByVal routes As RouteCollection)
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}")

        ' Enable HTTP atribute routing
        routes.MapMvcAttributeRoutes()

        routes.MapRoute(
            name:="Default",
            url:="{controller}/{action}/{id}",
            defaults:=New With {.controller = "Home", .action = "Index", .id = UrlParameter.Optional}
        )
    End Sub
End Module 
```

**第 2 步 - 将您的站点配置为将 /{controller}/Scripts/*.js 视为 MVC 路径而不是静态资源并进行处理**

编辑 /Web.config 文件，将以下内容添加到文件的 system.webServer --> handlers 部分：

```
<add name="ApiURIs-ISAPI-Integrated-4.0" path="*/scripts/*.js" verb="GET" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" /> 
```

这里又是上下文：

```
 <system.webServer>
    <modules>
      <remove name="TelemetryCorrelationHttpModule"/>
      <add name="TelemetryCorrelationHttpModule" type="Microsoft.AspNet.TelemetryCorrelation.TelemetryCorrelationHttpModule, Microsoft.AspNet.TelemetryCorrelation" preCondition="managedHandler"/>
      <remove name="ApplicationInsightsWebTracking"/>
      <add name="ApplicationInsightsWebTracking" type="Microsoft.ApplicationInsights.Web.ApplicationInsightsHttpModule, Microsoft.AI.Web" preCondition="managedHandler"/>
    </modules>
    <validation validateIntegratedModeConfiguration="false"/>
    <handlers>
      <remove name="ExtensionlessUrlHandler-Integrated-4.0"/>
      <remove name="OPTIONSVerbHandler"/>
      <remove name="TRACEVerbHandler"/>
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="*" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0"/>
      <add name="ApiURIs-ISAPI-Integrated-4.0" path="*/scripts/*.js" verb="GET" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
  </system.webServer> 
```

**第 3 步 - 将以下脚本操作结果添加到您的控制器文件**

*   确保编辑路由路径以匹配控制器的 {controller} 名称，在本例中为：<Route(" **Example** /Scripts/{filename}")>
*   您需要将其复制到每个控制器文件中。如果您愿意，可能有一种方法可以以某种方式将其作为单一的、一次性的路由配置来完成。

    ```
     ' /Example/Scripts/*.js
        <Route("Example/Scripts/{filename}")>
        Function Scripts(filename As String) As ActionResult
            ' ControllerName could be hardcoded but doing it this way allows for copy/pasting this code block into other controllers without having to edit
            Dim ControllerName As String = System.Web.HttpContext.Current.Request.RequestContext.RouteData.Values("controller").ToString()

            ' the real file path
            Dim filePath As String = Server.MapPath("~/Views/" & ControllerName & "/" & filename)

            ' send the file contents back
            Return Content(System.IO.File.ReadAllText(filePath), "text/javascript")
        End Function 
    ```

对于上下文，这是我的 ExampleController.vb 文件：

```
Imports System.Web.Mvc

Namespace myAppName
    Public Class ExampleController
        Inherits Controller

        ' /Example/Test
        Function Test() As ActionResult
            Return View()
        End Function

        ' /Example/Scripts/*.js
        <Route("Example/Scripts/{filename}")>
        Function Scripts(filename As String) As ActionResult
            ' ControllerName could be hardcoded but doing it this way allows for copy/pasting this code block into other controllers without having to edit
            Dim ControllerName As String = System.Web.HttpContext.Current.Request.RequestContext.RouteData.Values("controller").ToString()

            ' the real file path
            Dim filePath As String = Server.MapPath("~/Views/" & ControllerName & "/" & filename)

            ' send the file contents back
            Return Content(System.IO.File.ReadAllText(filePath), "text/javascript")
        End Function

    End Class
End Namespace 
```

**最后说明** test.vbhtml 视图/test.js javascript 文件没有什么特别之处，此处未显示。

我将我的 CSS 保存在视图文件中，但您可以轻松地添加到此解决方案中，以便您可以以类似的方式引用您的 CSS 文件。

# user-interface - GUI框架插件设计

> ID：604887
> 
> 赞同：1
> 
> 时间：2009-03-03T02:32:34.903
> 
> 标签：user-interface, plugins, frameworks

作为插件框架开发人员，我想指定插件必须实现的接口 myNameSpace.IPlugin。接口成员之一 IPlugin.GetWidget() 的返回值必须是派生自 System.Windows.Forms.Control 的类型，并且它还必须实现 myNameSpace.IFoo 接口。我还希望允许插件开发人员从 IPlugin.GetWidget() 返回第三方控件（它们已经是 System.Windows.Forms.Control 的后代）。明确指定此要求的最佳方法是什么，除了记录它，当然:)，并执行它？插件开发人员将如何设计插件（使用 3rd 方控件）来满足这些要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T04:48:05.653

你的设计闻起来有点腥。为什么小部件既要继承自一个具体的类又要实现另一个不相关的接口呢？听起来你有点继承快乐。取而代之的是，试试这个：

```
interface IPlugin
{
    IWidget Widget { get; }
}

interface IWidget
{
    System.Windows.Forms.Control Control { get; }
    IFoo Foo { get; }
} 
```

IFoo 是由控件本身实现还是由另一个类实现，实际上应该取决于实现者。你的代码不应该关心。

# nant - Nant、Booc 和 x64

> ID：604890
> 
> 赞同：1
> 
> 时间：2009-03-03T02:34:06.723
> 
> 标签：nant, 64-bit, boo

我有一个始终由 32 位机器构建/运行/运行的 .NET 项目。我有一台新的 64 位计算机，并试图解决让它在那里工作的任务。构建脚本在 nant 中，有一次我们使用 nant 任务编译了一些 boo 代码。boo 代码引用了我们的核心 DLL，它是在构建过程的早期从 c# 源构建的。

我尝试了两件事：将其构建为在 32 位模式下运行，并将其构建为在 64 位模式下运行。通过在几个程序（包括 booc）上使用 corflags，我能够构建以 32 位模式构建的项目，但最终在运行时遇到了一堆下游问题。所以我需要让它以 64 位模式构建，无论如何我认为这是更可取的。

根据 nant/booc 源代码，booc nant 任务使用 CLR 的 Process 类在进程内调用 booc.exe，因此（我认为）它应该从父进程继承 32 位或 64 位。不过，这并不能反映我所看到的。

这是我所做的：

1.  使用64位版本的powershell调用nant
2.  在我的任务中指定了 platform="x64"。我觉得我不应该这样做，因为 anycpu 应该没问题，但它似乎有所作为。

这是我得到的错误：

```
[booc] Compiling 5 files to 'C:\dev\build\MyProjectBoo.dll'.
[booc] BCE0106: Failed to access the types defined in assembly 'MyProject, Version=5.5.0.0, Culture=neutral, PublicKeyToken=null' - (C:\dev\build\MyProject.dll):Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
[booc]  is not a valid Win32 application. (Exception from HRESULT: 0x800700C1)
[booc]  is not a valid Win32 application. (Exception from HRESULT: 0x800700C1)
[booc] .
[booc] 1 error(s). 
```

这意味着，根据 booc 源代码，“我试图反思性地列出您引用的程序集中的类型，但失败了”。我不知道这是否意味着“我认为我是 32 位但这些是 64 位 dll”或什么，我很困惑。

关于如何让它发挥作用的任何想法？

**一些工作后更新**，我发现这个问题与 boo 无关。我编写了一个快速的 c# 程序，它反射性地加载 dll 并以相同的方式中断。因此，出于某种原因，无论我设置什么平台（x86、x64 或 anycpu），我都无法在 x64 机器上反射加载它。所以不是嘘的错。因此，如果我有更好的问题，我将深入研究并重新发布。

**较新的更新** 事实证明，我的主要 DLL 的第三方依赖项之一坚持在 32 位环境中，即使它不是用 corflags 构建的。这会导致 assembly.GetTypes() 在 64 位模式下失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T05:52:59.243

问题是依赖于需要 32 位模式的第三方 DLL，即使它们没有设置 corflags 也是可能的。

# html - html 表单不适用于 IE8 中的选择列表（IE7 兼容性）

> ID：604891
> 
> 赞同：1
> 
> 时间：2009-03-03T02:35:02.307
> 
> 标签：html, internet-explorer-8, forms, html-select

我遇到了一个 ASP.net MVC 项目的奇怪问题。

以下代码在 Firefox、chrome、Safari IE8 中运行良好 - 但在 IE7 兼容模式下无法使用 IE8

```
<%  Using Ajax.BeginForm("SetStatus", "StatusControl", New AjaxOptions With {.Confirm = "Are you sure you wish to change the Status?", .OnBegin = "Show_Updating", .OnComplete = "Hide_Updating"})%>
    <%=Html.Hidden("ItemID")%>
    <select id="SelectStatus" name="SelectStatus">
        <option selected="selected">Active</option>
        <option>Disable</option>
    </select>
    <input type="submit" value="OK" title="Set Status" class="small_button" />
<% End Using%> 
```

当我在 SetStatus 方法中设置断点时，表单集合会列出 SelectStatus 和 ItemID。SelectStatus 解析为“”而不是“活动”或“禁用”在所有其他浏览器中，这可以正确解析！

任何想法是怎么回事？我正在使用 IE-8 RC1。

下面是SetStatus Control方法

```
<AcceptVerbs(HttpVerbs.Post)> _
 Function SetStatus(ByVal form As FormCollection)
    Dim status = form("SelectStatus")

    Select Case status
        Case "Active"
            Dim ItemID As Integer = form("ItemID")
            Return Restore(ItemID)
        Case "Disable"
            Dim ItemID As Integer = form("ItemID")
            Return Disable(ItemID)
    End Select

    Return Content("Errors")
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T03:02:21.510

尝试为选项设置显式值

```
<option value="Active" selected="selected">Active</option>
<option value="Disable">Disable</option> 
```

# ruby-on-rails - 关于 Ruby 的一般问题

> ID：604895
> 
> 赞同：5
> 
> 时间：2009-03-03T02:37:10.790
> 
> 标签：ruby-on-rails, ruby, acts-as-versioned

我已经在我的rails应用程序中安装了来自github.com的acts_as_versioned插件，并且有一段我不完全理解的代码，我希望有人能为我解决这个问题

```
class_eval <<-CLASS_METHODS
  def a_bunch_of_stuff
   ....
  end
CLASS_METHODS 
```

我知道块内的方法（或任何它是）被定义为类内的实例方法，但我在插件中的任何地方都找不到定义为常量的 CLASS_METHODS，而且我也不确定 <<-在 class_eval 意味着之后。该插件位于[此处](http://github.com/technoweenie/acts_as_versioned/tree/master)，相关代码从 lib/acts_as_versioned.rb 的第 199 行开始。如果有人能告诉我这里的内幕，我将非常感激。

谢谢

-C

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T02:51:49.413

这是一个heredoc。[http://en.wikipedia.org/wiki/Heredoc#Ruby](http://en.wikipedia.org/wiki/Heredoc#Ruby)

匹配的 CLASS_METHODS 标记本质上是开始和结束引号。如果您使用 <<- 而不是 <<，则结束标记可以用空格缩进。

您可以在 Ruby 中一次使用多个 heredocs（我让我的 heredocs 与参数名称相同，但这只是为了美观 - 没有区别）：

```
def define_with_description description, code
  puts "defining a method to #{description}"
  class_eval code
end

define_with_description <<-DESCRIPTION, <<-CODE
  set up us the bomb
DESCRIPTION
  Bomb.new.set_up(us)
CODE 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T02:43:40.523

这是一个[“here document”](http://en.wikipedia.org/wiki/Heredoc)，它是一种内联引用大型多行字符串的方式。从[编程 Ruby](http://www.ruby-doc.org/docs/ProgrammingRuby/html/language.html)：

> 字符串可以跨越多个输入行，在这种情况下，它们将包含换行符。也可以使用这里的文档来表达长字符串文字。每当 Ruby 解析序列`<<identifier`or`<<quoted string`时，它都会将其替换为从连续的逻辑输入行构建的字符串文字。当它找到以标识符或带引号的字符串开头的行时，它会停止构建字符串。您可以在字符后立即放置一个减号`<<`，在这种情况下，终止符可以从左边距缩进。如果使用带引号的字符串来指定终止符，则其引用规则将应用于此处的文档；否则，适用双引号规则。

这将导致`class_eval`将之间的内容`CLASS_METHODS`视为字符串并在适当的上下文中执行它。这个名字的使用`CLASS_METHODS`是任意的，它可以很容易地被称为其他任何东西。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-03T03:49:36.683

这些是等价的：

```
class SomeClass
  class_eval <<-CLASS_METHODS
    def first_method
    end
    def second_method
    end
  CLASS_METHODS
end

class SomeClass
  def self.first_method
  end
  def self.second_method
  end
end 
```

# browser - 开发人员应该注意黑莓网络浏览器中的哪些怪癖？

> ID：604897
> 
> 赞同：4
> 
> 时间：2009-03-03T02:37:34.517
> 
> 标签：browser, blackberry

在我开始解决任何“已知问题”之前，是否有任何我应该注意的怪癖或问题。

特别是 cookie、JavaScript、HTML、CSS 和图像。

PS 我有 RIM 提供的文档的副本，但我希望其他人知道一些鲜为人知的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T02:47:24.650

以下是我注意到的一些：

*   出于某种原因，BB 浏览器似乎无法正确处理主机名中的下划线。我不记得发生了什么，但如果你的主机名是这样的： [http://some_host/blah](http://some_host/blah)，我记得它有问题。

    *   这可以通过删除 _ 的 DNS 条目来纠正
*   我们看到的另一件事是为 Java 下载提供 .jad 文件。如果您的模块包含 _ 或其他特殊字符，BB 浏览器会在尝试获取 .jar 或解析 .jad 时显示 HTTP 500 错误。这特别烦人，因为它实际上不是 HTTP 错误，服务器正在提供文件，但 BB 浏览器无法解析它，所以它归咎于服务器。

    *   我们通过使用 Fiddler 访问 .jad URL 并查看 HTTP 响应的内容来解决此问题。如果您的 .jad 有任何特殊字符（或有时是 URL/HTTP 编码字符串），您可能需要简化模块名称以仅使用 A-Za-z0-9

我知道那些不完全是 html/css 的东西，但我想我还是会发布这个！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-27T05:50:45.863

我曾**在模拟器版本上使用过黑莓浏览器来测试我的网页**。这些是我想指出的一些。

如果与真实案例有任何偏差，请原谅我，因为**这些特定于 windows 7 OS 上的模拟器版本**。我有设备可以检查和验证。

1.  当我们降到 5.X 以下的 BB OS 版本时（例如 BB 9630），浏览器对 java 脚本的支持将默认关闭。所以你需要去浏览器选项手动打开它。

2.  当我们进一步深入到 BB OS 版本 4.2 时，样式表支持将默认关闭。导致您的网页在不应用样式表的情况下呈现。所以那个时候你需要手动打开java脚本和样式表支持。

3.  即使我在操作系统版本 7.X 或 6.X 上，互联网连接也能正常工作，我可以连接到页面。当我降到第 5 版时，那些模拟器浏览器显示连接问题。在谷歌上搜索时，我发现当我们下载版本并寻求互联网访问时，MDS 是一项要求。

4.  我安装了 MDS，但它仍然不适用于 6 以下的版本，原因是我的计算机属性的高级系统设置中没有设置 JAVA_HOME 环境变量。但它甚至没有指出问题，MDS 立即关闭。因此，在将我的 JAVA_HOME 设置为“C:\Program Files (x86)\Java\jre1.6.0_07”之后，我安装了 JDK（我们需要 JDK 用于 MDS），互联网连接开始工作。

5.  此外，如果您对页面使用 g zip 压缩，在 Blackberry OS 版本 6 以下，浏览器不再请求压缩的。（在 OS 版本 5 模拟器 BB 9700、BB 8520 上找到它）。

6.  此外，当您要使用您怀疑支持的 css 属性或 html 实体时，请务必转到相应的操作系统版本内容开发人员指南，并查找他们提供完全支持和部分支持的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T03:28:27.310

查看[BlackBerry 浏览器 4.2 版内容开发人员指南](http://na.blackberry.com/eng/deliverables/1143/browser_devguide.pdf)。它适用于较旧的 4.2 浏览器，但仍然有很多关于支持哪些 HTML、CSS 和 javascript 的好信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T17:40:07.387

一个已知问题是黑莓浏览器完全忽略 css display 属性，因此您不能使用 display:none 隐藏内容。

我们在提交基本表单时也遇到了麻烦——有时，POST 根本不会发生，有时它会发生，但部分或全部表单字段会退出。我们无法深入了解这个问题，但它似乎主要发生在 BB 曲线系列中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T19:58:57.407

我对 BB 8700 的经验是你不应该使用 JavaScript，也不应该依赖 CSS 来正确呈现。默认情况下它也没有 Flash 播放器，因此您可以使用普通的服务器端 HTML 表单处理/ASP/CGI。还要注意大小，因为在旅途中互联网可能会变得非常慢。

# c# - 如何获取 SSRS 数据源凭据并在 .NET 中打开 SQL 连接

> ID：604900
> 
> 赞同：2
> 
> 时间：2009-03-03T02:38:10.630
> 
> 标签：c#, .net, sql-server, reporting-services

我正在使用 ASP.Net 和 C# 前端来运行一些报告。我想打开报表使用的数据源的 SQL 连接。

当报表使用集成安全性时，创建连接很容易，但是我想在报表服务器存储用户名和密码时创建连接。

我可以获得 SQL Server 路径和初始目录，使用

```
 DataSource[] dataSources;
    DataSourceReference dsReference;
    DataSourceDefinition dsDefinition;
    string dsPath;
    ReportingService2005 rs = new ReportingService2005();

    dataSources = rs.GetItemDataSources(reportPath);
    if (dataSources.Length > 0)
    {
        dsReference = (DataSourceReference)dataSources[0].Item;
        dsPath = dsReference.Reference;
        dsDefinition = rs.GetDataSourceContents(dsPath);
        // ....
    } 
```

我也可以使用

```
 username = dsDefinition.UserName; 
```

但是，如果我使用

```
 password = dsDefinition.Password; 
```

password = null，并且不能用于打开 Sql 连接。

**有没有办法创建一个使用数据源的连接字符串以及用户名和密码凭据的 SQLConnection？**

我正在使用 Reporting Services 2008 和 .NET 3.5，以及对 ReportService2005.asmx 和 ReportExecution2005.asmx 的 Web 引用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T03:33:15.100

我真的不认为这是可能的，因为这几乎会构成一个安全漏洞。我知道这不是您正在寻找的答案，但我会参数化您的报告的位置（即您的 MSRS 服务器的 IP/名称）并将它们与匹配的 SQL 实例一起存储在您的 web.config 中。虽然这并不完全是您所追求的，但我认为这与您将获得的差不多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-14T08:41:12.253

我认为您应该阅读此页面：http: [//msdn.microsoft.com/en-us/library/reportservice2005.datasourcedefinition_properties.aspx](http://msdn.microsoft.com/en-us/library/reportservice2005.datasourcedefinition_properties.aspx)

它显示密码字段是只写的，所以你不能设置它的值，只能读取它。

# jquery - jQuery需要从表单输入框的值中设置变量的值

> ID：604903
> 
> 赞同：1
> 
> 时间：2009-03-03T02:39:25.200
> 
> 标签：jquery, ajax, forms

我正在寻找表单输入的值。

我认为我的问题出在这条线上：

```
 var vid = $(this).next(".pid").val(); 
```

我需要将名为“pid”的输入框的值发送到 php 页面，但是页面上有几个表单，所有表单都带有名为“pid”的输入框。当我只有：

```
next(".pid").val(); 
```

发送的值来自页面上的另一个表单。

**编辑：** 我真正想做的就是将“数据”设置为表单中所有数据的数组。因此，如果有更好的方法将“formdata”变量设置为表单的 id，那也可以。

下面是jQuery函数：

```
$(".varSel").live("change", function(){
    var vid = $(this).next(".pid").val();
    var formdata = $('form#addToCart'+ vid).serialize();
    $.ajax({
        type: "POST",
        url: "library/varPrice.php",
        data: formdata,
        success: function(html){
        $('.price').html(html);
      }
    });
}); 
```

**编辑：**

下面是一个表格：

```
<form name='addToCart' id='addToCart99' action='cart.php?action=add' method='post'>
    <ul class='vars' id='varlist_p99'>
        <li>
        <label for="color">color</label> 
        <select id="color" name="color" class='varSel'>
            <option>blue</option>
            <option>green</option>
            <option>red</option>
        </select>
        </li>

        <li>
        <label for="size">size</label> 
        <select id="size" name="size" class='varSel'>
            <option>large</option>
            <option>small</option>
        </select>
        </li>

        <li>
            <div class='price'>
                $$
            </div>
        </li>

        <li>
                <input type='hidden' value='99' name='pid'> 
                <input type='submit' class='buynow' value=''>
        </li>
    </ul>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T04:22:12.923

替换这个：

```
var vid = $(this).next(".pid").val();
var formdata = $('form#addToCart'+ vid).serialize(); 
```

有了这个：

```
var formdata = $(this).parents('form').serialize(); 
```

测试和工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T03:01:48.873

为什么要使用 next()？

您应该尝试在**上下文中**搜索：

```
$(".pid", this) // if "this" is the current form 
```

无论如何，我建议使用唯一的 id 属性进行每个输入。因此，您不必猜测将处理哪个元素。

# javascript - ActionScript 的函数调用中是否允许函数声明？

> ID：604905
> 
> 赞同：0
> 
> 时间：2009-03-03T02:40:57.847
> 
> 标签：javascript, actionscript

我有以下代码：

```
var a= 1 + (function (x) { return x+1;} (2)); 
```

这在 JavaScript 中是允许的，但在 ActionScript 中，它总是显示一条错误消息，说这行代码是错误的。我在 ActionScript 上找不到关于此的文档，有人对此有任何想法吗？

先感谢您！

我有一个想法： var a = 1+(function (x) {return x+1;}).call(function(x) {return x+1;},2); 它适用于这个例子。this 指的是与“call”字符串之前的函数完全相同的函数。arguments.caller 是上述“call(..)”发生的位置，arguments.callee 是指“call”字符串之后的函数。arguments.length 是 1。恩...这样可以吗？

通过修改SWF标签解决了。^^

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T02:59:17.913

请尝试以下语法：

```
var a = 1 + (function (x) { return x+1;})(2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T03:11:41.563

“2”是函数的参数？

IAC：为什么不将其分解并将函数分配给局部变量，然后将变量传入。它也更易于理解和调试。

干杯

# nhibernate - Hibernate/NHibernate 中的枚举表

> ID：604907
> 
> 赞同：5
> 
> 时间：2009-03-03T02:41:45.567
> 
> 标签：nhibernate, hibernate, enums

我们正在使用 NHibernate，我们用于存储类枚举信息的常见模式之一是为枚举定义单独的表，并且只需引用使用枚举的主实体/表中的 ID。一个简单的例子：

```
Message
-------
ID (bigint PK)
MessageTypeID (bigint FK)
Body (varchar)

MessageType
-----------
ID (bigint PK)
Value (varchar) 
```

MessageType 表包含少量枚举值，例如：SMS、MMS、PSMS 等。

像这样将枚举值放在单独的表中是否值得？我想枚举的优点是您可以在将来更轻松地扩展它并且它更加规范化，但缺点是每次获取消息时都必须进行连接。是否有一个转折点，您会选择一个而不是另一个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T03:04:41.363

使用枚举意味着不要像现在这样使用另一个表。正如你所说，它也更快，而且更简单。

在这两种情况下，您都可以添加更多选项，但问题是：如果您在表中添加其他项目，您是否需要重新编译应用程序才能添加此类功能？

我的意思是，如果您的应用程序设计是耦合的并且要支持您需要重新编译的新消息类型（可能是因为您需要包含 SMS 实现），那么拥有单独的表是不值得的，您应该使用枚举

另一方面，如果您的实体缺少逻辑（例如 Country 或 States 表），或者您的应用程序可以插入新的消息类型而无需重新编译，您应该使用另一个表。为此，您可以将表格更改为以下内容：

```
MessageType
-----------
ID (bigint PK)
Value (varchar)
ImplementationType (varchar) (ie: Xyz.SMSSender, Xyz) 
```

或者您可以有一个单独的配置文件，您可以在其中自定义注入的依赖项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T02:50:15.813

我会在您的代码中创建一个与您的 MessageType 表匹配的 ID 的枚举。然后在你的类上使用它，nHibernate 应该能够正确映射它。

我一直偏离枚举表，尤其是当该数据不需要托管数据时。您是否会在执行过程中添加越来越多的 MessageType？

# objective-c - 如何使用 Objective-C 在自定义视图中绘制文本？

> ID：604908
> 
> 赞同：11
> 
> 时间：2009-03-03T02:42:07.783
> 
> 标签：objective-c, cocoa

我已经想出了如何使用 NSBezierPath 类在我的自定义视图类的 drawRect 函数中绘制形状，但是我似乎无法弄清楚如何绘制文本。以下代码是我迄今为止绘制文本的代码（位于 drawRect 函数中）：

```
NSText *text = [NSText new];
[text setTextColor: [NSColor yellowColor]];
[text setText: @"Hello!"]; 
```

我猜我可能需要提供一个 NSRect 或 NSPoint 来告诉 NSText 对象在哪里绘制自己，但我在 Cocoa 文档中找不到有关如何执行此操作的任何内容。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-03T02:51:27.900

您可以尝试以下方法：

```
//note we are using the convenience method, so we don't need to autorelease the object
NSDictionary *attributes = [NSDictionary dictionaryWithObjectsAndKeys:[NSFont fontWithName:@"Helvetica" size:26], NSFontAttributeName,[NSColor blackColor], NSForegroundColorAttributeName, nil];

NSAttributedString * currentText=[[NSAttributedString alloc] initWithString:@"Cat" attributes: attributes];

NSSize attrSize = [currentText size];
[currentText drawAtPoint:NSMakePoint(yourX, yourY)]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T03:03:13.677

NSText 是一个视图（特别是 NSTextView 的超类）。

有几种绘制文本的方法，有和没有属性（字体、颜色、段落样式等）。请参阅[AppKit 对 NSString](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSString_AppKitAdditions/)和[NSAttributedString](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSAttributedString_AppKitAdditions/)的补充。

# coldfusion - 为什么人们不使用 ?

> ID：604909
> 
> 赞同：10
> 
> 时间：2009-03-03T02:42:14.833
> 
> 标签：coldfusion, cflogin

为什么人们不使用 CFLOGIN？我记得几个月前 CF7 有问题，但我不记得它出了什么问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T03:42:27.497

我一直在使用 cflogin，效果很好。以你喜欢的方式工作可能有点棘手，但好处是巨大的。能够使用用户角色微调您的应用程序可以处理我的大部分基于权限的自定义。过去，会话管理存在一些问题，使其难以处理。打开 j2ee 会话似乎可以解决大部分问题。

一些流行的框架与 cflogin 不兼容，因此这可能是您看不到很多框架的原因之一。他们往往有自己的方法来保护应用程序功能。

我认为很多人对此感到沮丧，因为它有点古怪，他们放弃了。其他人有更复杂的安全需求，cflogin 无法完全解决这些需求，因此他们最终编写了自己的系统。具体来说，没有一种简单的方法来处理内容资产的权利。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T06:13:07.447

我遇到的唯一问题是 CF8 中的角色。它的实现非常出色，但有点残酷，它不能按应有的方式工作。也许在CF9。

无论如何，构建您自己的基于角色的系统（为用户分配一个会话变量，其中包含系统可以检查的访问级别的逗号分隔列表）并不太难，我克服了它。

cfLogin 可能仍然值得使用的一个优点是它如何与服务器监视器关联以查看有多少人登录等。

上面关于使用 jsession 的观点是正确的，在所有 cf 应用程序中都值得这样做。我拖着自己完成的最好的事情之一就是按照我想要的方式工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T14:39:24.843

**不使用 CFLogin 有 3 个原因。**

**首先**，它有点敏感，有点奇怪，而且没有多少人会想。你在这里放了一些代码，如果用户没有登录，它就会运行它……这很奇怪，你知道吗？早期存在一些错误也无济于事。

**其次**，虽然它具有 Web 应用程序所需的基本安全功能，但它并没有更进一步。你不能轻易地扩展它。谁说这就是每个人都想要的样子？

**第三**，也是最现实的，因为人们已经解决了这个问题。保护应用程序、身份验证和授权的问题领域已经在社区中考虑了足够长的时间，并且大多数人都知道如何去做。CFLogin 正在重塑大门。太少了，太晚了。

现在，这并不是说没有人使用它。我个人已经使用它几次，基本成功，但没有理由敲响警钟。对于我的大多数应用程序，不使用 CFLogin 更有意义。问题域是这样或那样的，CFLogin 并不总是以最智能的方式解决它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T14:36:12.160

请记住，CFLOGIN 有一个基本 HTTP Auth 的陷阱，即使在您调用 CFLOGOUT 之后，它也可以继续发送其用户 ID 和密码。

我知道这已经驱使一些高级用户远离它。

[这是LiveDocs](http://livedocs.adobe.com/coldfusion/7/htmldocs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=ColdFusion_Documentation&file=00001182.htm)的摘录

> 注意：如果您使用基于 Web 服务器的身份验证或任何使用基本 HTTP 授权标头的表单身份验证，浏览器会继续将身份验证信息发送到您的应用程序，直到用户关闭浏览器，或者在某些情况下，关闭所有打开的浏览器窗口。因此，在用户注销并且您的应用程序使用 cflogout 标记后，直到浏览器关闭，cflogin 标记中的 cflogin 结构将包含已注销用户的用户 ID 和密码。如果用户注销并且没有关闭浏览器，则另一个用户可能会使用第一个用户的登录名访问页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T07:37:41.487

就我而言（也假设其他一些人），主要原因是从其他平台迁移，比如 PHP。我的意思是我已经*掌握*了一些 ACL 开发的知识和习惯，并开始在 CF 中使用它们。

我知道如何使它对用户方便，对开发人员灵活且安全，并且*不需要*切换到 cflogin。

有时其他东西也会发生同样的情况，比如说在大多数情况下，我更喜欢使用自己的 JS 而不是使用 cfform/cfinput 来实现客户端验证。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-01-19T20:43:05.730

因为它（仍然！）有严重的错误，比如这个：

[http://www.raymondcamden.com/index.cfm/2009/8/7/Watch-out-for-this-CFLOGIN-Bug](http://www.raymondcamden.com/index.cfm/2009/8/7/Watch-out-for-this-CFLOGIN-Bug)

# ruby-on-rails - RoR：保护封闭的 API

> ID：604924
> 
> 赞同：3
> 
> 时间：2009-03-03T02:52:00.987
> 
> 标签：ruby-on-rails, ruby, security, api

我在不同的虚拟服务器上有两个 Rails 应用程序，但在同一个设施中。两个应用程序都可以通过本地 IP 地址进行通信。

这是一个两部分的问题：

1）我如何检查请求的来源并将请求仅限于来自该位置的请求？

2）你认为这足够安全吗？

我的直觉告诉我，由于 IP 欺骗，这还不够安全，但我认为 OAuth 或类似的东西对于我的需求来说有点太硬核了。虽然，也许不是。

这是我第一次接触这样的事情，我正在寻找任何可以将我推向正确方向的人。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T05:08:34.857

根据谁在托管您，本地网络（您的本地地址所属的）*可能*是只有您的实例可以访问的专用网络，或者更有可能与不属于您的其他虚拟机共享。您不会对直接的外部攻击持开放态度，但任何与您共享同一本地网络的受感染虚拟机都可能成为攻击的跳板，因此您的担忧是绝对正确的。

按顺序回答您的两个问题：

1.  **将本地接口配置`iptables`**为仅接受来自特定本地 IP 的特定端口上的请求（阅读[教程](http://iptables-tutorial.frozentux.net/iptables-tutorial.html)以更好地理解`iptables`配置。）本地网络上的所有其他虚拟机应该无法探测您，尽管它们可能能够拦截您的流量（如下所述。）
2.  不; 您应该**在所有节点内连接上使用 SSL**。这将通过两种方式保护您：首先，它将保护您免受欺骗（如果攻击者没有您的证书，即使他`iptables`通过欺骗他的地址绕过，或者因为您的`iptables`配置被管理员覆盖，攻击者也会被拒绝），以及其次，它将保护您的数据不被窥探（例如，攻击者将无法窥探您的密码流量。）一些应用程序（例如，大多数数据库引擎、以 v3 模式设置的 net-snmpd 等）本身就支持 SSL。或者，建立和使用`ssh`隧道，或使用[stunnel](http://www.stunnel.org/)

示例基本`iptables`配置允许在公共（互联网）接口上提供基本服务（HTTP、SSH 等），以及允许`www1`并在接口`www2`上的端口 3306 上连接到该节点的 MySQL `eth0`（`www1`并`www2`定义为`/etc/hosts`使它们解析为适当的 IP地址。）：

```
# * raw
#
#  Allows internal traffic without loading conntrack
# -A PREROUTING -i lo -d 127.0.0.0/8 -j NOTRACK

*filter

#  Allows all loopback (lo0) traffic and drop all traffic to 127/8 that doesn't use lo0
-A INPUT -i lo -j ACCEPT
-A INPUT -i ! lo -d 127.0.0.0/8 -j DROP

#  Accepts all established inbound connections (TCP, UDP, ICMP incl. "network unreachable" etc.)
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

#  Allows all outbound traffic
#  You can modify this to only allow certain traffic
-A OUTPUT -j ACCEPT

# Allows HTTP and HTTPS connections from anywhere (the normal ports for websites)
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp --dport 443 -j ACCEPT

#  Allows SSH connections
-A INPUT -p tcp -m state --state NEW --dport 22 -j ACCEPT

# Allow ping
-A INPUT -p icmp -m icmp --icmp-type echo-request -j ACCEPT

# log iptables denied calls
-A INPUT -m limit --limit 5/min -j LOG --log-prefix "iptables denied: " --log-level debug

# Reject all other inbound - default deny unless explicitly allowed policy
-A INPUT -j REJECT
-A FORWARD -j REJECT

#  Allows MySQL within our cluster ONLY
-A INPUT -p tcp -s www1 -i eth0 --dport 3306 -j ACCEPT
-A INPUT -p udp -s www1 -i eth0 --dport 3306 -j ACCEPT
-A INPUT -p tcp -s www2 -i eth0 --dport 3306 -j ACCEPT
-A INPUT -p udp -s www2 -i eth0 --dport 3306 -j ACCEPT

COMMIT 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T02:59:35.773

这听起来不像是一个 Rails 问题，它更像是一个关于 Web 架构的问题。我假设两台机器都可以通过 HTTP 访问外部世界。如果是这种情况，您可能需要考虑在两台机器前面放置防火墙，以创建两台机器所在的本地网络。

完成此操作后，您应该能够配置防火墙以根据您指定的任何标准禁止请求。鉴于这是一个 Rails 应用程序，我将假设 API 是一组资源。如果是这种情况，您可以配置防火墙以过滤对私有 API 的请求。

这样，本地网络上的机器可以自由通信，因为它们彼此的请求不会通过防火墙。

# c# - 使用 Excel 2007 互操作和 C# 设置单元格的格式

> ID：604930
> 
> 赞同：1
> 
> 时间：2009-03-03T02:54:57.860
> 
> 标签：c#, excel-2007, office-interop, primary-interop-assembly

我正在使用 Office 2007 互操作程序集来创建一些 Excel 电子表格。

这里有很多关于入门的问题，MSDN 包含大量文章，比如[这篇](http://msdn.microsoft.com/en-us/library/bb491102.aspx)。

API 很时髦，有时有点混乱。

当我设置一个单元格的值时，有没有办法设置它的格式？我想将特定字段标记为日期，以便我的客户可以在它们上运行 excel 宏。此外，数字会很有用。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T05:58:59.430

基于 VBA 的代码。但是同样适用于 c#（忽略语法）。

```
 cells(1,1).Value = 39875
cells(1,1).NumberFormat = "dd-mmm-yyyy" 

```

学习 Excel 对象模型的最佳方法是创建一个您希望执行的操作的宏，查看代码并修改需要外部输入的部分。此外，对象模型很容易理解（应用程序 -> 工作簿 -> 工作表 -> 工作表 -> 范围（单元格））。

# asp.net - 将 Linq 查询绑定到 Gridview 时获取“数据源是无效类型”

> ID：604931
> 
> 赞同：2
> 
> 时间：2009-03-03T02:55:06.597
> 
> 标签：asp.net, linq, linq-to-sql

我正在尝试将 gridview 绑定到使用存储过程的 linq to sql 查询。当我运行页面时，我收到以下错误：

*数据源是无效类型。它必须是 IListSource、IEnumerable 或 IDataSource。*

```
var db = new TableItemDataContext();
var q = db.sp_SearchForItems("1","2","3","4"); 
GridView1.DataSource = q;
GridView1.DataBind(); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T03:05:50.393

使用 ToList() 扩展方法将查询转换为项目列表。

```
GridView1.DataSource = q.ToList(); 
```

这也将产生在转换时运行查询的效果，因此您可能想看看是否只转换为 IEnumerable 会起作用。

**编辑**：根据评论线索进行澄清。问题出在 SPROC 的构造和 LINQ 无法检测到返回值。根据[存储过程和 LINQ 更改 SPROC，Dmbl 文件无法解释结果集](https://stackoverflow.com/questions/521736/stored-procedure-linq-dmbl-file-unable-to-interpret-the-result-set)允许 LINQ 检测架构，之后可以将 SPROC 改回。

# jquery - jQuery DataTables：控制表格宽度

> ID：604933
> 
> 赞同：103
> 
> 时间：2009-03-03T02:55:59.700
> 
> 标签：jquery, datatables, jquery-datatables

我在使用 jQuery DataTables 插件控制表格宽度时遇到问题。该表应该是容器宽度的 100%，但最终是任意宽度，而不是小于容器宽度。

建议赞赏

表声明如下所示

```
<table id="querytableDatasets" class="display" cellspacing="0"
cellpadding="3"     width="100%"> 
```

和 javascript

```
jQuery('#tab-datasets').load('/cgi-bin/qryDatasets', '', function (){  
    jQuery('#querytableDatasets').dataTable({  
        "bPaginate": false,  
        "bInfo": false,  
        "bFilter": false  
    });  
});  ` 
```

在 Firebug 中检查 HTML，您会看到这一点（注意添加的 style="width: 0px;"）

```
<table id="querytableDatasets" class="display" cellspacing="0" 
cellpadding="3" width="100%" style="width: 0px;"> 
```

在 Firebug 中查看样式，table.display 样式已被覆盖。看不到这是从哪里来的

```
element.style {  
  width:0;}    

-- dataTables.css (line 84
table.display { 
  margin:0 auto;  
  width:100%;  
} 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-10-09T16:52:48.167

```
jQuery('#querytableDatasets').dataTable({  
        "bAutoWidth": false
}); 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2011-03-17T19:32:40.230

这个问题是因为 dataTable 必须计算它的宽度 - 但是当在选项卡内使用时，它是不可见的，因此无法计算宽度。解决方案是在选项卡显示时调用“fnAdjustColumnSizing”。

**前言**

> 这个例子展示了如何将带有滚动功能的 DataTables 与 jQuery UI 选项卡一起使用（或者实际上任何其他在初始化时表格位于隐藏 (display:none) 元素中的方法）。这需要特别考虑的原因是，当初始化 DataTables 并且它位于隐藏元素中时，浏览器没有任何测量值可用于提供 DataTables，这将需要在启用滚动时列错位。
> 
> 解决此问题的方法是调用 fnAdjustColumnSizing API 函数。此函数将根据当前数据计算所需的列宽，然后重绘表格——这正是表格第一次可见时所需要的。为此，我们使用 jQuery UI 表提供的“显示”方法。我们检查 DataTable 是否已创建（注意 'div.dataTables_scrollBody' 的额外选择器，这是在初始化 DataTable 时添加的）。如果表已经初始化，我们重新调整它的大小。可以添加优化以仅对表格的第一次显示重新调整大小。

**初始化代码**

```
$(document).ready(function() {
    $("#tabs").tabs( {
        "show": function(event, ui) {
            var oTable = $('div.dataTables_scrollBody>table.display', ui.panel).dataTable();
            if ( oTable.length > 0 ) {
                oTable.fnAdjustColumnSizing();
            }
        }
    } );

    $('table.display').dataTable( {
        "sScrollY": "200px",
        "bScrollCollapse": true,
        "bPaginate": false,
        "bJQueryUI": true,
        "aoColumnDefs": [
            { "sWidth": "10%", "aTargets": [ -1 ] }
        ]
    } );
} ); 
```

有关更多信息，请参阅[此](http://www.datatables.net/examples/api/tabs_and_scrolling.html)内容。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2009-03-12T23:40:27.203

初始化 dataTables 时，您需要调整两个变量：`bAutoWidth`和`aoColumns.sWidth`

假设您有 4 列，宽度分别为 50px、100、120px 和 30px，您会这样做：

```
jQuery('#querytableDatasets').dataTable({  
        "bPaginate": false,  
        "bInfo": false,  
        "bFilter": false,
        "bAutoWidth": false,
        "aoColumns" : [
            { sWidth: '50px' },
            { sWidth: '100px' },
            { sWidth: '120px' },
            { sWidth: '30px' }
        ]  
    }); 
```

有关 dataTables 初始化的更多信息，请访问[http://datatables.net/usage](http://datatables.net/usage)

注意此宽度设置与您正在应用的 CSS 之间的交互。您可以在尝试此操作之前评论您现有的 CSS，看看您有多接近。

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2009-03-03T03:05:29.567

好吧，我不熟悉那个插件，但是你能在添加数据表后重新设置样式吗？就像是

```
$("#querydatatablesets").css("width","100%") 
```

在 .dataTable 调用之后？

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-05-10T09:34:43.280

我对数据表的列宽有很多问题。对我来说，神奇的修复是包括这条线

```
table-layout: fixed; 
```

这个 css 与表格的整体 css 一起使用。例如，如果您已声明如下数据表：

```
LoadTable = $('#LoadTable').dataTable..... 
```

然后神奇的 css 行将进入类 Loadtable

```
#Loadtable {
margin: 0 auto;
clear: both;
width: 100%;
table-layout: fixed; 
```

}

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-06-18T17:47:41.507

TokenMacGuys 解决方案效果最好，因为这是 jQdataTable 中的错误的结果。如果您使用 $('#sometabe').dataTable().fnDestroy() 会发生什么情况，表格宽度将设置为 100px 而不是 100%。这是一个快速修复：

```
$('#credentials-table').dataTable({
        "bJQueryUI": false,
        "bAutoWidth": false,
        "bDestroy": true,
        "bPaginate": false,
        "bFilter": false,
        "bInfo": false,
    "aoColumns": [
           { "sWidth": "140px" },
           { "sWidth": "300px" },
           { "sWidth": "50px" }       
        ],
        "fnInitComplete": function() {

            $("#credentials-table").css("width","100%");
        }

    }); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-07-10T12:03:18.637

您必须至少保留一个没有固定字段的字段，例如：

```
$('.data-table').dataTable ({

 "bAutoWidth": false,
 "aoColumns" : [
    null,
    null,
    null,                    
    null,
    {"sWidth": "20px"},
    { "sWidth": "20px"}]
}); 
```

您可以全部更改，但只保留一个为空，这样它就可以拉伸。如果你把宽度放在 ALL 上，它将不起作用。希望我今天帮助了某人！

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-08-11T10:16:58.013

将此 css 类添加到您的页面，它将解决问题：

```
#<your_table_id> {
    width: inherit !important;
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-06-18T04:49:29.550

在初始化中`sWidth`为每列和显式设置宽度解决了我的（类似）问题。喜欢溢出的堆栈。`bAutoWidth: false``dataTable`

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-05-24T08:15:23.660

与 Datatable 10.1 一样，这是直截了当的。只需将宽度属性放在 HTML 中的表格中即可。即width="100%"，这将覆盖DT设置的所有CSS样式。

请参阅此[http://www.datatables.net/examples/basic_init/flexible_width.html](http://www.datatables.net/examples/basic_init/flexible_width.html)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-09-08T06:04:47.063

```
"fnInitComplete": function() {
    $("#datatables4_wrapper").css("width","60%");
 } 
```

这可以很好地调整整个表格的宽度。谢谢@Peter Drinnan！

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-10-02T09:34:46.270

这里没有一个解决方案对我有用。甚至数据表[主页](http://datatables.net/examples/api/tabs_and_scrolling.html)上的示例也无法正常工作，因此在 show 选项中初始化数据表。

我找到了解决问题的方法。诀窍是**使用选项卡的激活选项**并**在可见表上调用 fnAdjustColumnSizing()**：

```
$(function () {

// INIT TABS WITH DATATABLES
$("#TabsId").tabs({
    activate: function (event, ui) {
        var oTable = $('div.dataTables_scrollBody>table:visible', ui.panel).dataTable();
        if (oTable.length > 0) {
            oTable.fnAdjustColumnSizing();
        }
    }
});

// INIT DATATABLES
// options for datatables
var optDataTables = {
    "sScrollY": "200px",
    "bScrollCollapse": true,
    "bPaginate": false,
    "bJQueryUI": true,
    "aoColumnDefs": [
        { "sWidth": "10%", "aTargets": [-1] }
    ]
};
// initialize data table
$('table').dataTable(optDataTables);

}); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-03T03:39:11.530

你在准备好的活动中这样做吗？

```
$(document).ready(function() { ... });

```

大小很可能取决于文件是否已满载。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-10-23T12:05:51.043

只是说我遇到了和你完全相同的问题，虽然我只是将 JQuery 应用于没有任何 Ajax 的普通表。出于某种原因，Firefox 在显示表格后并未将其展开。我通过将表格放在 DIV 中并将效果应用到 DIV 来解决问题。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-03-06T16:50:01.660

也检查此解决方案。这很容易解决了我的 DataTable 列宽问题

JQuery DataTables 1.10.20 引入`columns.adjust()`了修复 Bootstrap 切换选项卡问题的方法

```
 $('a[data-toggle="tab"]').on( 'shown.bs.tab', function (e) {
    $.fn.dataTable.tables( {visible: true, api: true} ).columns.adjust();
} ); 
```

请参阅文档：[滚动和引导选项卡](https://datatables.net/examples/api/tabs_and_scrolling.html)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-04-16T21:15:25.353

**对于使用固定标题插件调整表格/单元格宽度时遇到问题的任何人：**

数据表依赖于列宽参数的广告标签。这是因为它确实是唯一的原生 html，因为大多数表格的内部 html 都是自动生成的。

但是，发生的情况是您的某些单元格可能大于存储在 thead 单元格内的宽度。

即，如果您的表格有很多列（宽表格）并且您的行有很多数据，那么调用“sWidth”：更改 td 单元格大小将无法正常工作，因为子行会根据溢出自动调整 td 的大小内容，这发生*在*表被初始化并传递了它的 init 参数之后。

原始的 thead "sWidth": 参数被覆盖（缩小），因为 datatables 认为您的表格仍然具有 %100 的默认宽度——它无法识别某些单元格溢出。

为了解决这个问题，我计算出溢出宽度，并通过在表初始化*后*相应地调整表大小来解决这个问题——当我们这样做时，我们可以同时初始化我们的固定标题：

```
$(document).ready(function() {
  $('table').css('width', '120%');
  new FixedHeader(dTable, {
        "offsetTop": 40,
      });
}); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-02-11T15:54:26.213

在 ajax 调用的“成功”中创建您的固定标题，标题和行中不会有任何对齐问题。

```
success: function (result) {
              /* Your code goes here */

    var table = $(SampleTablename).DataTable();

        new $.fn.dataTable.FixedHeader(table);
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-06-24T09:15:21.950

希望这对仍在苦苦挣扎的人有所帮助。

不要把你的桌子放在任何容器里。表格呈现后，将表格的包装器设为您的容器。我知道这在你有其他东西的地方可能是无效的，但你总是可以将这些内容附加回来。

对我来说，如果你有一个侧边栏和一个实际上是该侧边栏偏移量的容器，就会出现这个问题。

```
$(YourTableName+'_wrapper').addClass('mycontainer'); 
```

（我添加了一个面板面板默认）
和你的班级：

```
.mycontainer{background-color:white;padding:5px;} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-08-17T06:04:25.343

找到有关此问题的另一个有用链接，它解决了我的问题。

```
<table width="100%">
<tr>
    <td width="20%"> Left TD <td>
    <td width="80%"> Datatable </td>
</tr>
</table> 
```

[Datatables力宽表](https://stackoverflow.com/questions/30074910/datatables-force-width-table)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-01-12T23:06:25.727

将 div 包裹在桌子上时，我遇到了类似的问题。

添加位置：相对为我固定它。

```
 #report_container {
 float: right;
 position: relative;
 width: 100%;
}
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-08-31T16:07:09.827

我有一个类似的问题，表格的内容大于表格的页眉和页脚。在桌子周围添加一个 div 并设置 x-overflow 似乎已经解决了这个问题：

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-10-11T19:22:42.813

确保正确输入 bAutoWidth 和 aoColumns 之前的所有其他参数。之前的任何错误参数都会破坏此功能。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-05-29T07:37:47.950

我有类似的问题，发现列中的文本不会中断，使用这个 css 代码解决了这个问题

```
th,td{
max-width:120px !important;
word-wrap: break-word
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-01-25T11:20:15.683

这是我的做法。。

```
$('#table_1').DataTable({
    processing: true,
    serverSide: true,
    ajax: 'customer/data',
    columns: [
        { data: 'id', name: 'id' , width: '50px', class: 'text-right' },
        { data: 'name', name: 'name' width: '50px', class: 'text-right' }
    ]
}); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-08-15T09:20:14.313

我今天遇到同样的问题。

我用了一个棘手的方法来解决它。

我的代码如下。

```
$('#tabs').tabs({
    activate: function (event, ui) {
       //redraw the table when the tab is clicked
       $('#tbl-Name').DataTable().draw();
    }
}); 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2013-02-27T14:07:17.967

这工作正常。

```
#report_container {
   float: right;
   position: relative;
   width: 100%;
} 
```

# javascript - 如何“过滤”JSON 以获得唯一的键名/值对？

> ID：604935
> 
> 赞同：5
> 
> 时间：2009-03-03T02:56:27.670
> 
> 标签：javascript, jquery, arrays, json, object

我有一些 JSON 数据，它为我提供了一个语言列表，其中包含 lat/lng 等信息。它还包含我用于图标的组值——我想用它构建一个图例。JSON 看起来像这样：

```
{"markers":[
  {"language":"Hungarian","group":"a", "value":"yes"},
  {"language":"English", "group":"a", "value":"yes"},
  {"language":"Ewe", "group":"b", "value":"no"},
  {"language":"French", "group":"c", "value":"NA"}
]} 
```

我想“过滤”它最终是这样的：

```
{"markers":[
 {"group":"a", "value":"yes"},
 {"group":"b", "value":"no"},
 {"group":"c", "value":"NA"}
]} 
```

现在我有了这个，使用 jQuery 来创建我的图例..但当然它会引入所有值：

```
$.getJSON("http://127.0.0.1:8000/dbMap/map.json", function(json){
    $.each(json.markers, function(i, language){
        $('<p>').html('<img src="http://mysite/group' + language.group + '.png\" />' + language.value).appendTo('#legend-contents');
    });
}); 
```

对于给定的对，如何仅获取整个 JSON 对象中唯一的名称/值对？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T03:18:04.700

我会将标记数组转换为键值对，然后循环该对象属性。

```
var markers = [{"language":"Hungarian","group":"a", "value":"yes"}, 
  {"language":"English", "group":"a", "value":"yes"}, 
  {"language":"Ewe", "group":"b", "value":"no"},
  {"language":"French", "group":"c", "value":"NA"}];

var uniqueGroups = {};
$.each(markers, function() {
  uniqueGroups[this.group] = this.value;
}); 
```

然后

```
$.each(uniqueGroups, function(g) {
  $('<p>').html('<img src="http://mysite/group' + g + '.png\" />' + this).appendTo('#legend-contents');
}); 
```

或者

```
for(var g in uniqueGroups)
{
  $('<p>').html('<img src="http://mysite/group' + g + '.png\" />' + uniqueGroups[g]).appendTo('#legend-contents');
} 
```

此代码示例用循环中的最后一个值覆盖唯一值。如果您想使用第一个值，则必须执行一些条件检查以查看密钥是否存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T06:21:39.143

更通用的东西怎么样？

```
function getDistinct(o, attr)
{
 var answer = {};
 $.each(o, function(index, record) {
   answer[index[attr]] = answer[index[attr]] || [];
   answer[index[attr]].push(record);
 });

 return answer;    //return an object that has an entry for each unique value of attr in o as key, values will be an array of all the records that had this particular attr.
} 
```

这样的函数不仅会返回您指定的所有不同值，而且如果您需要访问它们，它还会对它们进行分组。

在您的示例中，您将使用：

```
$.each(getDistinct(markers, "group"), function(groupName, recordArray)
{ var firstRecord = recordArray[0];
        $('<p>').html('<img src="http://mysite/group' + groupName+ '.png\" />' + firstRecord.value).appendTo('#legend-contents');

} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-03T03:13:39.797

看到这个 [- 在对象的 javascript 数组中查询唯一属性值的最佳方法？](https://stackoverflow.com/questions/591894/best-way-to-query-back-unique-attribute-values-in-a-javascript-array-of-objects)

您只需要一个检查 2 个值而不是 1 个值的变体。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-17T05:19:25.503

```
var markers  = _.uniq( _.collect( markers , function( x ){
                        return JSON.stringify( x ); 
                    })); 
```

[参考](http://bateru.com/news/2012/03/code-of-the-day-get-unique-objects-from-an-array-of-json-objects/)

# c# - C# Windows 窗体应用程序的设计

> ID：604936
> 
> 赞同：1
> 
> 时间：2009-03-03T02:56:53.753
> 
> 标签：c#, winforms

我有 ac# windows 窗体应用程序，我们在其中为客户做了一个快速原型。我的 c# 经验范围是 ASP.NET/C#，因此在软件的实际结构方面它有点不同。时间是这个项目的一个因素，因为它是一个学校项目，我们还有不到 2 个月的时间要做。

*该软件将主要由数据库驱动。*

**当前项目设计**

目前有 1 个主窗口窗体和一堆类文件。

我们的一个想法是，由于程序的大部分实际代码将在类中，我们是否应该将窗口窗体拆分成一堆带有一个主驱动程序的小窗口窗体？还是将其保留为一种较大的形式并尝试在主要获胜形式中包含尽可能少的代码？

**您对 ac# 数据库驱动的窗体应用程序的设计有何建议？**

请给每个人的优点和缺点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T03:10:36.573

就个人而言，我更喜欢 MDI（多文档界面）而不是单个表单，因为如果没有仔细规划，单个表单可能会变得混乱。大多数客户也喜欢用于数据库驱动应用程序的 MDI 的想法，因为它让他们想起了 Microsoft Access。我也喜欢把所有东西都分成类的想法。我用来决定天气或不上课的经验法则是“我在我的编程生涯中是否需要再做一次X？”。在这种情况下，X 是您将在该类中放入的内容（例如，确定闰年）。如果您认为您的表格不会变得混乱，那么完全选择单一表格。希望这可以帮助您做出决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T03:31:34.760

虽然我同意您几乎肯定需要不止一种形式，但我一点也不喜欢 MDI。相反，我更愿意考虑用户将执行的常见任务，并围绕用户预期的工作流程设计应用程序，这样就可以自然地从一个部分到另一个部分。当然，这也意味着为高级用户提供一种方法，让他们在他们真正想要的时候超越这个预期的流量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T03:11:04.297

提供“厨房水槽”功能的单片形式与提供“厨房水槽”功能的单片类一样糟糕。

由于这是一个学校项目，我假设你还在学习这些东西。

将应用程序分解为执行较少的较小形式。每个表格都应该做一件事并且做得非常好。它的功能应该是明确定义的、有凝聚力的，并且尽可能地松散耦合。尝试将数据库代码排除在外（将该代码移动到您的类中，并从表单中调用它们）。

表单只不过是显示类返回的信息的一种方式（换句话说，数据视图）。保持这样简单，您会发现添加新表单、更改现有表单以及在需要时扩展您的应用程序会更容易。

# reflection - 如何获取 SQLite 数据库表中的列列表？

> ID：604939
> 
> 赞同：117
> 
> 时间：2009-03-03T02:59:48.973
> 
> 标签：reflection, sqlite, list

我正在寻找检索表中的列列表。该数据库是 SQLite 的最新版本（我相信是 3.6）。我正在寻找使用 SQL 查询执行此操作的代码。与列相关的元数据（例如长度、数据类型等...）

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-03-03T03:04:17.400

您要查找的内容称为数据字典。在 sqlite 中，可以通过查询 sqlite_master 表（或视图？）找到所有表的列表

```
sqlite> create table people (first_name varchar, last_name varchar, email_address varchar);
sqlite> select * from sqlite_master;
table|people|people|2|CREATE TABLE people (first_name varchar, last_name varchar, email_address varchar) 
```

要获取列信息，您可以使用以下`pragma table_info(table_name)`语句：

```
sqlite> pragma table_info(people);
0|first_name|varchar|0||0
1|last_name|varchar|0||0
2|email_address|varchar|0||0 
```

有关 pragma 语句的更多信息，请参阅[文档](http://www.sqlite.org/pragma.html)。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2012-02-10T04:52:55.363

这是简单的方法：

```
.schema <table> 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-11-21T14:43:34.130

这个问题很老，但尚未提及以下问题。

在许多情况下，另一种方便的方法是通过以下方式打开标题：

```
sqlite> .headers on 
```

然后，

```
sqlite> SELECT ... FROM table 
```

将在输出顶部显示一个标题，显示所有选定的字段（如果您选择 *，则全部）。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2018-05-27T02:14:42.340

这是一个列出当前数据库中所有表和列的 SELECT 语句：

```
SELECT m.name as tableName, 
       p.name as columnName
FROM sqlite_master m
left outer join pragma_table_info((m.name)) p
     on m.name <> p.name
order by tableName, columnName
; 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-03-03T03:13:51.917

只需进入您的 sqlite shell：

```
$ sqlite3 path/to/db.sqlite3 
```

然后就打

```
sqlite> .schema 
```

你会得到一切。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2018-11-01T02:17:10.480

这是一个查询，列出了所有表及其列，以及我可以根据 OP 请求获得的关于每列的所有元数据（作为奖励积分）。

```
SELECT
  m.name AS table_name, 
  p.cid AS col_id,
  p.name AS col_name,
  p.type AS col_type,
  p.pk AS col_is_pk,
  p.dflt_value AS col_default_val,
  p.[notnull] AS col_is_not_null
FROM sqlite_master m
LEFT OUTER JOIN pragma_table_info((m.name)) p
  ON m.name <> p.name
WHERE m.type = 'table'
ORDER BY table_name, col_id 
```

感谢@David Garoutte 向我展示了如何`pragma_table_info`在查询中工作。

运行此查询以查看所有表元数据：

```
SELECT * FROM sqlite_master WHERE type = 'table' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-04-27T16:50:36.267

在上述基础上，您可以一次完成所有操作：

```
sqlite3 yourdb.db ".schema" 
```

这将为您提供创建表的 SQL，该表实际上是列的列表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-07-15T08:56:45.797

我知道，已经很久了，但永远不会太晚……我有一个与 TCL 类似的问题作为翻译，经过几次搜索，没有发现对我有任何好处。所以我提出了一些基于 PRAGMA 的东西，知道你的数据库是“主要的”</p>

```
db eval { PRAGMA main.table_info(<your table name>) } TBL { puts $TBL(name) } 
```

和数组使用来获取列表

```
set col_list {}
db eval { PRAGMA main.table_info(<your table name>) } TBL { lappend col_list $TBL(name) }
puts $col_list 
```

# wpf - 允许调整 TextBox 的大小但不根据用户输入增长

> ID：604952
> 
> 赞同：12
> 
> 时间：2009-03-03T03:06:44.277
> 
> 标签：wpf, textbox

我在窗口中定义了一个 TextBox，如下所示：

```
<Window x:Class="NS.MainWindow"
    ...
    SizeToContent="WidthAndHeight">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100" />
            <ColumnDefinition MinWidth="200" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition MinHeight="50" />
        </Grid.RowDefinitions>
        <TextBlock Grid.Column="0" Grid.Row="0">Description:</TextBlock>

        <TextBox Grid.Column="1" Grid.Row="0" TextWrapping="WrapWithOverflow" />
    </Grid>
</Window> 
```

问题是当用户在 TextBox 中键入时，它会向右扩展，因为只设置了 MinWidth。我真正想要的是换行到下一行的文本。如果我将列上的 MinWidth 更改为 Width ，我可以做到这一点。但是，如果我这样做，则在调整窗口大小时 TextBox 不再调整大小。

有没有办法让我两者兼得？（即仅在窗口调整大小时调整大小，否则换行）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T06:32:39.037

您出现这种行为的原因是因为您设置了**Window 的 SizeToContent 属性**- 它基本上授权 Window 根据其内容请求的大小调整自身大小。所以当你输入更多的东西时，文本框说我需要更多的空间，窗口就乖乖地变大了。如果您不设置 SizeToContent 属性，您的文本框将不会增长。

所以我会说失去 SizeToContent 属性设置器并使用比例网格大小。这里我说使 Column#2 的宽度是 Column#1 的两倍。Grid 的 Horizo​​ntalAlignment 和 VerticalAlignment 的默认“拉伸”值应确保您的控件在窗口调整大小时正确调整大小。

```
<Window ...
    Title="MyWindow" WindowStyle="ToolWindow" ResizeMode="CanResizeWithGrip"
        MinWidth="300" Width="300" Height="80">
    <Grid x:Name="myGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*" MinWidth="100"/>
            <ColumnDefinition Width="2*" MinWidth="200" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition MinHeight="50" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Column="0" Grid.Row="0">Description:</TextBlock>
        <TextBox Grid.Column="1" Grid.Row="0" TextWrapping="WrapWithOverflow"/>
    </Grid> 
```

如果您只是将 SizeToContent 属性设置器添加回上面的代码片段...您会看到一些奇怪的行为，其中文本框最初随着文本内容增长.. 但是如果您调整窗口大小一次.. 文本框将停止增长。奇怪...无法解释这种行为。
高温高压

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-02-21T14:33:29.283

WPF 的 TextBox 似乎没有内置该选项。

要解决此问题，您可以使用报告所需 (0, 0) 大小的自定义 TextBox。这是一个丑陋的黑客，但它有效。

在您的 MainWindow.xaml.cs 文件中：

```
namespace NS
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        ...
    }

    // Ugly HACK because the regular TextBox doesn't allow autoresize to fit the parent but NOT autoresize when the text doesn't fit.
    public class TextBoxThatDoesntResizeWithText : TextBox
    {
        protected override Size MeasureOverride(Size constraint)
        {
            return new Size(0, 0);
        }
    }
} 
```

然后，在您的 MainWindow.xaml 文件中：

```
<Window x:Class="NS.MainWindow"
    ...
    xmlns:local="clr-namespace:NS"
    SizeToContent="WidthAndHeight">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100" />
            <ColumnDefinition MinWidth="200" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition MinHeight="50" />
        </Grid.RowDefinitions>
        <TextBlock Grid.Column="0" Grid.Row="0">Description:</TextBlock>

        <local:TextBoxThatDoesntResizeWithText Grid.Column="1" Grid.Row="0" TextWrapping="WrapWithOverflow" />
    </Grid>
</Window> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T04:48:35.933

将第二个 ColumnDefinition 更改为 Width="*"。

# algorithm - 两点之间的对数分布曲线的正确算法是什么？

> ID：604953
> 
> 赞同：5
> 
> 时间：2009-03-03T03:07:18.890
> 
> 标签：algorithm, tag-cloud, logarithm

我已经阅读了一堆关于生成标记云权重对数分布的正确方法的教程。他们中的大多数将标签分组为步骤。这对我来说似乎有点傻，所以我根据我读过的内容开发了自己的算法，以便它沿着阈值和最大值之间的对数曲线动态分布标签的计数。这是它在python中的本质：

```
from math import log
count = [1, 3, 5, 4, 7, 5, 10, 6]
def logdist(count, threshold=0, maxsize=1.75, minsize=.75):
    countdist = []
    # mincount is either the threshold or the minimum if it's over the threshold
    mincount = threshold<min(count) and min(count) or threshold
    maxcount = max(count)
    spread = maxcount - mincount
    # the slope of the line (rise over run) between (mincount, minsize) and ( maxcount, maxsize)
    delta = (maxsize - minsize) / float(spread)
    for c in count:
        logcount = log(c - (mincount - 1)) * (spread + 1) / log(spread + 1)
        size = delta * logcount - (delta - minsize)
        countdist.append({'count': c, 'size': round(size, 3)})
    return countdist 
```

基本上，如果不对单个计数进行对数计算，它将在点之间生成一条直线，(mincount, minsize) 和 (maxcount, maxsize)。

该算法很好地近似了两点之间的曲线，但存在一个缺点。mincount 是一种特殊情况，它的对数产生零。这意味着 mincount 的大小将小于 minsize。我尝试编造数字来尝试解决这种特殊情况，但似乎无法正确解决。目前我只是将 mincount 视为一种特殊情况，并将“ `or 1`”添加到 logcount 行。

是否有更正确的算法在两点之间绘制曲线？

**3 月 3 日更新**：如果我没记错的话，我正在记录计数，然后将其代入线性方程。换句话说，就是对特殊情况的描述，在 y=lnx at x=1, y=0。这就是 mincount 发生的情况。但是mincount不能为零，标签没有被使用过0次。

尝试代码并插入您自己的数字进行测试。将 mincount 视为特殊情况对我来说很好，我觉得这比实际解决这个问题的方法要容易。我只是觉得*必须*有一个解决方案，并且有人可能已经提出了解决方案。

**更新 4 月 6 日**：一个简单的[谷歌](http://www.google.com/search?q=logarithmic%20tag%20cloud)搜索出现了我读过的许多教程，但这[可能](http://www.echochamberproject.com/node/247)是阶梯标签云最完整的例子。

**4 月 28 日更新**：响应 antti.huima 的解决方案：绘制图形时，您的算法创建的曲线位于两点之间的线下方。我一直在尝试调整数字，但似乎仍然无法想出将曲线翻转到线的另一侧的方法。我猜如果将函数更改为某种形式的对数而不是指数，它将完全符合我的需要。那是对的吗？如果是这样，谁能解释如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T03:10:14.593

感谢 antti.huima 的帮助，我重新思考了我想要做什么。

采用他解决问题的方法，我想要一个方程，其中 mincount 的对数等于两点之间的线性方程。

```
weight(MIN) = ln(MIN-(MIN-1)) + min_weight
min_weight = ln(1) + min_weight 
```

虽然这给了我一个很好的起点，但我需要让它通过点（MA​​X，max_weight）。它需要一个常数：

```
weight(x) = ln(x-(MIN-1))/K + min_weight 
```

求解 K 我们得到：

```
K = ln(MAX-(MIN-1))/(max_weight - min_weight) 
```

所以，把这一切放回一些python代码：

```
from math import log
count = [1, 3, 5, 4, 7, 5, 10, 6]
def logdist(count, threshold=0, maxsize=1.75, minsize=.75):
    countdist = []
    # mincount is either the threshold or the minimum if it's over the threshold
    mincount = threshold<min(count) and min(count) or threshold
    maxcount = max(count)
    constant = log(maxcount - (mincount - 1)) / (maxsize - minsize)
    for c in count:
        size = log(c - (mincount - 1)) / constant + minsize
        countdist.append({'count': c, 'size': round(size, 3)})
    return countdist 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T16:01:35.000

让我们从记录的计数到大小的映射开始。这就是你提到的线性映射：

```
   尺寸
    |
最大 |_____
    | /
    | /|
    | / |
分钟 |/ |
    | |
   /| |
0 /_|___|____
    0个

```

其中 min 和 max 是最小和最大*尺寸*，a=log(maxcount)-b。该行是 y=mx+c 其中 x=log(count)-b

从图中，我们可以看到梯度 m 为 (maxsize-minsize)/a。

我们需要在 y=minsize 时 x=0，所以 log(mincount)-b=0 -> b=log(mincount)

这给我们留下了以下python：

```
mincount = min(count)
maxcount = max(count)
xoffset = log(mincount)
gradient = (maxsize-minsize)/(log(maxcount)-log(mincount))
for c in count:
    x = log(c)-xoffset
    size = gradient * x + minsize 
```

如果要确保最小计数始终至少为 1，请将第一行替换为：

```
mincount = min(count+[1]) 
```

在执行 min 之前将 1 附加到计数列表中。确保 maxcount 始终至少为 1 也是如此。因此，上面的最终代码是：

```
from math import log
count = [1, 3, 5, 4, 7, 5, 10, 6]
def logdist(count, maxsize=1.75, minsize=.75):
    countdist = []
    mincount = min(count+[1])
    maxcount = max(count+[1])
    xoffset = log(mincount)
    gradient = (maxsize-minsize)/(log(maxcount)-log(mincount))
    for c in count:
        x = log(c)-xoffset
        size = gradient * x + minsize
        countdist.append({'count': c, 'size': round(size, 3)})
    return countdist 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T20:19:27.993

你所拥有的是你有计数从 MIN 到 MAX 的标签；这里可以忽略阈值问题，因为它相当于将低于阈值的每个计数设置为阈值，然后才取最小值和最大值。

您想将标签计数映射到“权重”，但以“对数方式”，这基本上意味着（据我了解）以下内容。首先，带有 count MAX 的标签获得 max_weight 权重（在您的示例中为 1.75）：

```
weight(MAX) = max_weight 
```

其次，计数为 MIN 的标签获得 min_weight 权重（在您的示例中为 0.75）：

```
weight(MIN) = min_weight 
```

最后，它认为当您的计数减少 1 时，权重乘以常数 K < 1，这表示曲线的陡度：

```
weight(x) = weight(x + 1) * K 
```

解决这个问题，我们得到：

```
weight(x) = weight_max * (K ^ (MAX - x)) 
```

请注意，当 x = MAX 时，指数为零，右侧的被乘数变为 1。

现在我们有了 weight(MIN) = min_weight 的额外要求，我们可以解决：

```
weight_min = weight_max * (K ^ (MAX - MIN)) 
```

我们从中得到

```
K ^ (MAX - MIN) = weight_min / weight_max 
```

两边取对数

```
(MAX - MIN) ln K = ln weight_min - ln weight_max 
```

IE

```
ln K = (ln weight_min - ln weight_max) / (MAX - MIN) 
```

右手边如所愿为负，因为 K < 1。然后

```
K = exp((ln weight_min - ln weight_max) / (MAX - MIN)) 
```

所以现在你有了计算 K 的公式。在此之后，你只需申请 MIN 和 MAX 之间的任何计数 x：

```
weight(x) = max_weight * (K ^ (MAX - x)) 
```

你完成了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T03:15:06.423

在对数刻度上，您只需线性绘制数字的对数（换句话说，假装您正在线性绘制，但首先获取要绘制的数字的对数）。

零问题无法通过分析解决——您必须为您的规模选择一个最小数量级，而且无论如何您都无法达到零。如果你想在零处绘制一些东西，你的选择是任意给它比例的最小数量级，或者省略它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T03:58:46.427

我没有确切的答案，但我认为您想查找线性化指数数据。首先计算通过点的线的方程，并取该方程两边的对数。

# html - 如何在不设置固定大小的情况下强制 ul 中的所有 li 元素与最大项的大小相同？

> ID：604956
> 
> 赞同：3
> 
> 时间：2009-03-03T03:09:26.843
> 
> 标签：html, css

我在页面上有一个类别列表，每个类别都有一个嵌套的子类别列表。类别列表项样式以网格模式（通过`display:inline; float:left`）排列项目，子类别显示在正常列表布局的下方。类别和子类别是用户配置的，但我预计不会有数百个（对于 3 或 4 个类别中的每一个，可能不超过 10 或 20 个子类别）。

我宁愿不为每个列表项设置固定大小。我想在每个元素周围画一个边框，但是当每个列表项的大小都基于它的内容时，我不喜欢它的外观。有没有办法解决这个问题而不在列表项上设置固定大小？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T03:40:03.790

设置`ul`to have`float: left`似乎有帮助。

示例：http: [//jsbin.com/uluke](http://jsbin.com/uluke)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T03:18:54.247

实际上，这是可能的。

```
<div style="float: left"> 
  <div style="display: block">
    <div class="cat">Category #1</div>
    <div class="sub">Sub category #1</div>
    <div class="sub">Sub category #2</div>
  </div>
  <div style="display: block">
    <div class="cat">Category #2</div>
    <div class="sub">Sub category #1</div>
    <div class="sub">Sub category #2 LONG LONG LONG</div>
  </div>
</div> 
```

只是因为块元素填充到最大尺寸的方式。我知道它是默认的，只是添加它以使其更明显。"float: left" 不是必需的，但 "display: inline" 是必需的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T12:57:12.717

如果您知道**平均**类别项目的文本大小，您可以使用`min-width`将所有项目设置为此大小，但允许它们为超大项目增长。这甚至可以在渲染时以编程方式设置。

请原谅这个巨大的例子。
CSS

```
ul.tags {
    display:block;
    margin: 0;
    padding:0;
    width:40em;
}
ul.tags li {
    display:inline-block;
    /* 
    *  or for FF2 compat use            
    display:inline-block;
    float:left;
    */
    margin:2px;
    padding:2px;
    min-width:8em;
    border:1px solid #ddd;
    text-align:center;
} 
```

HTML

```
<ul class="tags">
        <li>lorem ipsum dolor </li>
        <li>dolor sit amet</li>
        <li>consectetur adipisicing elit</li>
        <li>sed do </li>
        <li>eiusmod tempor incididunt </li>
        <li>ut labore </li>
        <li>et dolore </li>
        <li>magna </li>
        <li>aliqua</li>
        <li>ut enim </li>
        <li>ad minim veniam</li>
        <li>quis nostrud </li>
        <li>exercitation ullamco laboris </li>
        <li>nisi ut </li>
        <li>aliquip </li>
        <li>ex ea </li>
        <li>commodo </li>
        <li>consequat</li>
        <li>duis aute irure </li>
        <li>dolor in </li>
        <li>reprehenderit </li>
        <li>in voluptate </li>
        <li>velit esse </li>
        <li>cillum dolore </li>
        <li>eu fugiat nulla </li>
        <li>pariatur excepteur </li>
        <li>sint </li>
        <li>occaecat cupidatat </li>
        <li>non proident</li>
        <li>sunt in </li>
        <li>culpa qui </li>
        <li>officia deserunt </li>
        <li>mollit anim id est laborum</li>
</ul> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T03:17:32.017

你不能用css，你必须使用javascript。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T03:26:23.853

显示：内联和浮动：左不是一个好的组合。事实上，在浮动元素上设置显示是多余的，因为一旦浮动，它们就会自动变为块级。（除了一个奇怪的带有双边距的 ie6 错误，没有理由设置 display: on a floated element）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T03:18:03.763

我知道在一列中有多个单元格具有相同宽度的唯一方法涉及表格。IE 表达式也可能有效，但我不推荐它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T03:50:22.487

如果您可以更改标记，则：

```
ul {
    float: left;
    margin: 0;
    padding: 0;
    list-style: none;
}

li {
    border: 1px solid black;
    margin-left: 1em;
}

li.category {
    border: none;
    margin-left: 0;
}

<ul>
    <li class='category'>Category #1</li>
    <li>Sub #A</li>
    <li>Sub #B</li>

    <li class='category'>Category #2</li>
    <li>Longer Sub #C</li>
    <li>Sub #D</li>
</ul> 
```

# c# - 如何使用 .NET 读取和修改 NTFS 备用数据流

> ID：604960
> 
> 赞同：53
> 
> 时间：2009-03-03T03:11:00.317
> 
> 标签：c#, .net, ntfs, alternate-data-stream

如何使用 .NET 读取和修改“NTFS 备用数据流”？

似乎没有对它的本机 .NET 支持。我会使用哪些 Win32 API？另外，我将如何使用它们，因为我不认为这是记录在案的？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-03T03:29:26.857

这是 C# 的版本

```
using System.Runtime.InteropServices;

class Program
{
    static void Main(string[] args)
    {
        var mainStream = NativeMethods.CreateFileW(
            "testfile",
            NativeConstants.GENERIC_WRITE,
            NativeConstants.FILE_SHARE_WRITE,
            IntPtr.Zero,
            NativeConstants.OPEN_ALWAYS,
            0,
            IntPtr.Zero);

        var stream = NativeMethods.CreateFileW(
            "testfile:stream",
            NativeConstants.GENERIC_WRITE,
            NativeConstants.FILE_SHARE_WRITE,
            IntPtr.Zero,
            NativeConstants.OPEN_ALWAYS,
            0,
            IntPtr.Zero);
    }
}

public partial class NativeMethods
{

    /// Return Type: HANDLE->void*
    ///lpFileName: LPCWSTR->WCHAR*
    ///dwDesiredAccess: DWORD->unsigned int
    ///dwShareMode: DWORD->unsigned int
    ///lpSecurityAttributes: LPSECURITY_ATTRIBUTES->_SECURITY_ATTRIBUTES*
    ///dwCreationDisposition: DWORD->unsigned int
    ///dwFlagsAndAttributes: DWORD->unsigned int
    ///hTemplateFile: HANDLE->void*
    [DllImportAttribute("kernel32.dll", EntryPoint = "CreateFileW")]
    public static extern System.IntPtr CreateFileW(
        [InAttribute()] [MarshalAsAttribute(UnmanagedType.LPWStr)] string lpFileName, 
        uint dwDesiredAccess, 
        uint dwShareMode, 
        [InAttribute()] System.IntPtr lpSecurityAttributes, 
        uint dwCreationDisposition, 
        uint dwFlagsAndAttributes, 
        [InAttribute()] System.IntPtr hTemplateFile
    );

}

public partial class NativeConstants
{

    /// GENERIC_WRITE -> (0x40000000L)
    public const int GENERIC_WRITE = 1073741824;

    /// FILE_SHARE_DELETE -> 0x00000004
    public const int FILE_SHARE_DELETE = 4;

    /// FILE_SHARE_WRITE -> 0x00000002
    public const int FILE_SHARE_WRITE = 2;

    /// FILE_SHARE_READ -> 0x00000001
    public const int FILE_SHARE_READ = 1;

    /// OPEN_ALWAYS -> 4
    public const int OPEN_ALWAYS = 4;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-03T05:04:34.617

没有对它们的本机 .NET 支持。您必须使用 P/Invoke 来调用本机 Win32 方法。

要创建它们，请[使用](http://www.pinvoke.net/default.aspx/kernel32/CreateFile.html)类似`filename.txt:streamname`. 如果您使用返回 SafeFileHandle 的互操作调用，则可以使用它来构造一个 FileStream，然后您可以对其进行读写。

要列出文件中存在的流，请使用[FindFirstStreamW](http://msdn.microsoft.com/en-us/library/aa364424(VS.85).aspx)和[FindNextStreamW](http://msdn.microsoft.com/en-us/library/aa364430(VS.85).aspx)（仅存在于 Server 2003 及更高版本 - 不是 XP）。

~~我不相信您可以删除流，除非复制文件的其余部分并保留其中一个流。将长度设置为 0 也可能有效，但我没有尝试过。~~

您还可以在目录上拥有备用数据流。您可以像访问文件一样访问它们 - `C:\some\directory:streamname`.

流可以独立于默认流设置压缩、加密和稀疏性。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-01-23T08:59:11.080

这个 nuget 包[CodeFluent 运行时客户端](https://nuget.org/packages/CodeFluentRuntimeClient)（在其他实用程序中）有一个支持创建/读取/更新/删除/枚举操作的[NtfsAlternateStream 类。](http://www.softfluent.com/documentation/CodeFluent.Runtime~CodeFluent.Runtime.BinaryServices.NtfsAlternateStream_members.html)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-11-02T22:57:52.400

答 首先，Microsoft® .NE​​T Framework 中没有任何东西提供此功能。如果你想要它，简单明了，你需要直接或使用第三方库进行某种互操作。

如果您使用的是 Windows Server™ 2003 或更高版本，Kernel32.dll 会向 FindFirstFile 和 FindNextFile 公开对应项，从而提供您正在寻找的确切功能。FindFirstStreamW 和 FindNextStreamW 允许您查找和枚举特定文件中的所有备用数据流，检索有关每个数据流的信息，包括其名称和长度。从托管代码中使用这些函数的代码与我在 12 月专栏中展示的代码非常相似，如图 1 所示。

**图 1** 使用 FindFirstStreamW 和 FindNextStreamW

```
[SecurityPermission(SecurityAction.LinkDemand, UnmanagedCode = true)]
public sealed class SafeFindHandle : SafeHandleZeroOrMinusOneIsInvalid {

    private SafeFindHandle() : base(true) { }

    protected override bool ReleaseHandle() {
        return FindClose(this.handle);
    }

    [DllImport("kernel32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
    private static extern bool FindClose(IntPtr handle);

}

public class FileStreamSearcher {
    private const int ERROR_HANDLE_EOF = 38;
    private enum StreamInfoLevels { FindStreamInfoStandard = 0 }

    [DllImport("kernel32.dll", ExactSpelling = true, CharSet = CharSet.Auto, SetLastError = true)]
    private static extern SafeFindHandle FindFirstStreamW(string lpFileName, StreamInfoLevels InfoLevel, [In, Out, MarshalAs(UnmanagedType.LPStruct)] WIN32_FIND_STREAM_DATA lpFindStreamData, uint dwFlags);

    [DllImport("kernel32.dll", ExactSpelling = true, CharSet = CharSet.Auto, SetLastError = true)] [return: MarshalAs(UnmanagedType.Bool)] private static extern bool FindNextStreamW(SafeFindHandle hndFindFile, [In, Out, MarshalAs(UnmanagedType.LPStruct)] WIN32_FIND_STREAM_DATA lpFindStreamData);
    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    private class WIN32_FIND_STREAM_DATA {
        public long StreamSize;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 296)]
        public string cStreamName;
    }

    public static IEnumerable<string> GetStreams(FileInfo file) {
        if (file == null) throw new ArgumentNullException("file");
        WIN32_FIND_STREAM_DATA findStreamData = new WIN32_FIND_STREAM_DATA();
        SafeFindHandle handle = FindFirstStreamW(file.FullName, StreamInfoLevels.FindStreamInfoStandard, findStreamData, 0);
        if (handle.IsInvalid) throw new Win32Exception();
        try {
            do {
                yield return findStreamData.cStreamName;
            } while (FindNextStreamW(handle, findStreamData));
            int lastError = Marshal.GetLastWin32Error();
            if (lastError != ERROR_HANDLE_EOF) throw new Win32Exception(lastError);
        } finally {
            handle.Dispose();
        }
    }
} 
```

您只需调用 FindFirstStreamW，将目标文件的完整路径传递给它。FindFirstStreamW 的第二个参数指示您希望返回数据的详细程度；目前，只有一个级别（FindStreamInfoStandard），其数值为 0。函数的第三个参数是指向 WIN32_FIND_STREAM_DATA 结构的指针（从技术上讲，第三个参数指向的内容由第二个参数的值决定详细说明信息级别，但由于目前只有一个级别，因此出于所有意图和目的，这是一个 WIN32_FIND_STREAM_DATA）。我已经将该结构的托管副本声明为一个类，并在互操作签名中将其标记为编组为指向结构的指针。最后一个参数保留供将来使用，应为 0。如果从 FindFirstStreamW 返回有效句柄，则 WIN32_FIND_STREAM_DATA 实例包含有关找到的流的信息，并且其 cStreamName 值可以作为第一个可用流名称返回给调用者。FindNextStreamW 接受从 FindFirstStreamW 返回的句柄，并使用有关下一个可用流（如果存在）的信息填充提供的 WIN32_FIND_STREAM_DATA。如果另一个流可用，FindNextStreamW 返回 true，否则返回 false。结果，我不断地调用 FindNextStreamW 并产生结果流名称，直到 FindNextStreamW 返回 false。发生这种情况时，我会仔细检查最后一个错误值，以确保迭代停止是因为 FindNextStreamW 用完了流，而不是出于某种意外原因。不幸的是，如果您使用的是 Windows® XP 或 Windows 2000 Server，您无法使用这些功能，但有几种选择。第一个解决方案涉及当前从 Kernel32.dll、NTQueryInformationFile 导出的未记录函数。但是，未记录的函数是未记录的，将来可以随时更改甚至删除。最好不要使用它们。如果您确实想使用此功能，请在 Web 上搜索，您会发现大量参考资料和示例源代码。但这样做需要您自担风险。另一种解决方案，也是我在 并且它们可以在将来的任何时间更改甚至删除。最好不要使用它们。如果您确实想使用此功能，请在 Web 上搜索，您会发现大量参考资料和示例源代码。但这样做需要您自担风险。另一种解决方案，也是我在 并且它们可以在将来的任何时间更改甚至删除。最好不要使用它们。如果您确实想使用此功能，请在 Web 上搜索，您会发现大量参考资料和示例源代码。但这样做需要您自担风险。另一种解决方案，也是我在**图 2**依赖于从 Kernel32.dll 导出的两个函数，这些函数已记录在案。顾名思义，BackupRead 和 BackupSeek 是 Win32® API 的一部分，用于备份支持：

```
BOOL BackupRead(HANDLE hFile, LPBYTE lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, BOOL bAbort, BOOL bProcessSecurity, LPVOID* lpContext);
BOOL BackupSeek(HANDLE hFile, DWORD dwLowBytesToSeek, DWORD dwHighBytesToSeek, LPDWORD lpdwLowByteSeeked, LPDWORD lpdwHighByteSeeked, LPVOID* lpContext); 
```

**图 2** 使用 BackupRead 和 BackupSeek

```
public enum StreamType {
    Data = 1,
    ExternalData = 2,
    SecurityData = 3,
    AlternateData = 4,
    Link = 5,
    PropertyData = 6,
    ObjectID = 7,
    ReparseData = 8,
    SparseDock = 9
}

public struct StreamInfo {
    public StreamInfo(string name, StreamType type, long size) {
        Name = name;
        Type = type;
        Size = size;
    }
    readonly string Name;
    public readonly StreamType Type;
    public readonly long Size;
}

public class FileStreamSearcher {
    [DllImport("kernel32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool BackupRead(SafeFileHandle hFile, IntPtr lpBuffer, uint nNumberOfBytesToRead, out uint lpNumberOfBytesRead, [MarshalAs(UnmanagedType.Bool)] bool bAbort, [MarshalAs(UnmanagedType.Bool)] bool bProcessSecurity, ref IntPtr lpContext);[DllImport("kernel32.dll")]

    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool BackupSeek(SafeFileHandle hFile, uint dwLowBytesToSeek, uint dwHighBytesToSeek, out uint lpdwLowByteSeeked, out uint lpdwHighByteSeeked, ref IntPtr lpContext); public static IEnumerable<StreamInfo> GetStreams(FileInfo file) {
        const int bufferSize = 4096;
        using (FileStream fs = file.OpenRead()) {
            IntPtr context = IntPtr.Zero;
            IntPtr buffer = Marshal.AllocHGlobal(bufferSize);
            try {
                while (true) {
                    uint numRead;
                    if (!BackupRead(fs.SafeFileHandle, buffer, (uint)Marshal.SizeOf(typeof(Win32StreamID)), out numRead, false, true, ref context)) throw new Win32Exception();
                    if (numRead > 0) {
                        Win32StreamID streamID = (Win32StreamID)Marshal.PtrToStructure(buffer, typeof(Win32StreamID));
                        string name = null;
                        if (streamID.dwStreamNameSize > 0) {
                            if (!BackupRead(fs.SafeFileHandle, buffer, (uint)Math.Min(bufferSize, streamID.dwStreamNameSize), out numRead, false, true, ref context)) throw new Win32Exception(); name = Marshal.PtrToStringUni(buffer, (int)numRead / 2);
                        }
                        yield return new StreamInfo(name, streamID.dwStreamId, streamID.Size);
                        if (streamID.Size > 0) {
                            uint lo, hi; BackupSeek(fs.SafeFileHandle, uint.MaxValue, int.MaxValue, out lo, out hi, ref context);
                        }
                    } else break;
                }
            } finally {
                Marshal.FreeHGlobal(buffer);
                uint numRead;
                if (!BackupRead(fs.SafeFileHandle, IntPtr.Zero, 0, out numRead, true, false, ref context)) throw new Win32Exception();
            }
        }
    }
} 
```

BackupRead 背后的想法是，它可用于将文件中的数据读取到缓冲区中，然后可以将其写入备份存储介质。但是，BackupRead 也非常方便查找有关构成目标文件的每个备用数据流的信息。它将文件中的所有数据作为一系列离散字节流处理（每个备用数据流都是这些字节流之一），并且每个流前面都有一个 WIN32_STREAM_ID 结构。因此，为了枚举所有流，您只需从每个流的开头读取所有这些 WIN32_STREAM_ID 结构（这是 BackupSeek 变得非常方便的地方，因为它可以用于从流跳转到流而无需读取文件中的所有数据）。开始，

```
typedef struct _WIN32_STREAM_ID { 
    DWORD dwStreamId; DWORD dwStreamAttributes;
    LARGE_INTEGER Size; 
    DWORD dwStreamNameSize; 
    WCHAR cStreamName[ANYSIZE_ARRAY];
} WIN32_STREAM_ID; 
```

在大多数情况下，这就像您通过 P/Invoke 编组的任何其他结构一样。但是，有一些并发症。首先，WIN32_STREAM_ID 是一个可变大小的结构。它的最后一个成员 cStreamName 是一个长度为 ANYSIZE_ARRAY 的数组。虽然 ANYSIZE_ARRAY 定义为 1，但 cStreamName 只是结构中前四个字段之后其余数据的地址，这意味着如果分配的结构大于 sizeof (WIN32_STREAM_ID) 字节，则额外的空间将实际上是 cStreamName 数组的一部分。前一个字段 dwStreamNameSize 指定了数组的确切长度。虽然这对 Win32 开发非常有用，但它对需要将此数据从非托管内存复制到托管内存的封送拆收器造成严重破坏，作为对 BackupRead 的互操作调用的一部分。鉴于 WIN32_STREAM_ID 结构的大小是可变的，编组器如何知道它实际上有多大？它没有。第二个问题与打包和对齐有关。暂时忽略 cStreamName，考虑一下托管 WIN32_STREAM_ID 对应项的以下可能性：

```
[StructLayout(LayoutKind.Sequential)] 
public struct Win32StreamID { 
    public int dwStreamId; 
    public int dwStreamAttributes; 
    public long Size; 
    public int dwStreamNameSize;
} 
```

Int32 大小为 4 个字节，Int64 大小为 8 个字节。因此，您会期望该结构为 20 个字节。但是，如果您运行以下代码，您会发现两个值都是 24，而不是 20：

```
int size1 = Marshal.SizeOf(typeof(Win32StreamID));
int size2 = sizeof(Win32StreamID); // in an unsafe context 
```

问题是编译器希望确保这些结构中的值始终在正确的边界上对齐。四字节值应位于可被 4 整除的地址处，8 字节值应位于可被 8 整除的边界处，以此类推。现在想象一下如果您要创建一个 Win32StreamID 结构数组会发生什么。数组第一个实例中的所有字段都将正确对齐。例如，由于 Size 字段跟在两个 32 位整数之后，因此它距离数组的开头有 8 个字节，非常适合 8 字节的值。但是，如果结构的大小为 20 字节，则数组中的第二个实例不会使其所有成员都正确对齐。整数值都可以，但 long 值将是数组开头的 28 个字节，这个值不能被 8 整除。要解决这个问题，编译器将结构填充为 24 的大小，以便所有字段始终正确对齐（假设数组本身是）。如果编译器做对了，你可能想知道我为什么要关心这个。如果您查看图 2 中的代码，您就会明白为什么。为了解决我描述的第一个封送处理问题，我确实将 cStreamName 排除在 Win32StreamID 结构之外。我使用 BackupRead 读取足够的字节来填充我的 Win32StreamID 结构，然后检查结构的 dwStreamNameSize 字段。现在我知道名称有多长，我可以再次使用 BackupRead 从文件中读取字符串的值。这一切都很好，但如果 Marshal.SizeOf 为我的 Win32StreamID 结构返回 24 而不是 20，我将尝试读取太多数据。为了避免这种情况，我需要确保 Win32StreamID 的大小实际上是 20 而不是 24。这可以使用装饰结构的 StructLayoutAttribute 上的字段以两种不同的方式完成。第一种是使用 Size 字段，它向运行时指示结构应该有多大：

```
[StructLayout(LayoutKind.Sequential, Size = 20)] 
```

第二个选项是使用 Pack 字段。Pack 指示在指定 LayoutKind.Sequential 值时应使用的打包大小，并控制结构内字段的对齐方式。托管结构的默认打包大小是 8。如果我将其更改为 4，我会得到我正在寻找的 20 字节结构（因为我实际上并没有在数组中使用它，所以我不会失去效率或这种包装变化可能导致的稳定性）：

```
[StructLayout(LayoutKind.Sequential, Pack = 4)]
public struct Win32StreamID {
    public StreamType dwStreamId;
    public int dwStreamAttributes;
    public long Size;
    public int dwStreamNameSize; // WCHAR cStreamName[1];
} 
```

有了这段代码，我现在可以枚举文件中的所有流，如下所示：

```
static void Main(string[] args) {
    foreach (string path in args) {
        Console.WriteLine(path + ":");
        foreach (StreamInfo stream in FileStreamSearcher.GetStreams(new FileInfo(path))) {
            Console.WriteLine("\t{0}\t{1}\t{2}", stream.Name != null ? stream.Name : "(unnamed)", stream.Type, stream.Size);
        }
    }
} 
```

您会注意到此版本的 FileStreamSearcher 返回的信息比使用 FindFirstStreamW 和 FindNextStreamW 的版本多。BackupRead 不仅可以提供关于主要流和备用数据流的数据，还可以对包含安全信息、重新解析数据等的流进行操作。如果您只想查看备用数据流，则可以根据 StreamInfo 的 Type 属性进行过滤，该属性将为备用数据流的 StreamType.AlternateData。要测试此代码，您可以在命令提示符处使用 echo 命令创建具有备用数据流的文件：

```
> echo ".NET Matters" > C:\test.txt
> echo "MSDN Magazine" > C:\test.txt:magStream
> StreamEnumerator.exe C:\test.txt
test.txt:
        (unnamed)               SecurityData    164
        (unnamed)               Data            17
        :magStream:$DATA        AlternateData   18
> type C:\test.txt
".NET Matters"
> more < C:\test.txt:magStream
"MSDN Magazine" 
```

因此，现在您可以检索存储在文件中的所有备用数据流的名称。伟大的。但是，如果您想实际操作其中一个流中的数据怎么办？不幸的是，如果您尝试将备用数据流的路径传递给 FileStream 构造函数之一，则会引发 NotSupportedException：“不支持给定路径的格式。” 为了解决这个问题，您可以通过直接访问从 kernel32.dll 公开的 CreateFile 函数来绕过 FileStream 的路径规范化检查（参见**图 3**）。我为 CreateFile 函数使用了 P/Invoke 来打开和检索指定路径的 SafeFileHandle，而不对路径执行任何托管权限检查，因此它可以包含备用数据流标识符。然后使用此 SafeFileHandle 创建一个新的托管 FileStream，提供所需的访问权限。有了这些，就可以很容易地使用 System.IO 命名空间的功能来操作备用数据流的内容。以下示例读取并打印出上一个示例中创建的 C:\test.txt:magStream 的内容：

```
string path = @"C:\test.txt:magStream"; 
using (StreamReader reader = new StreamReader(CreateFileStream(path, FileAccess.Read, FileMode.Open, FileShare.Read))) { 
    Console.WriteLine(reader.ReadToEnd());
} 
```

**图 3** 为 CreateFile 使用 P/Invoke

```
private static FileStream CreateFileStream(string path, FileAccess access, FileMode mode, FileShare share) {
    if (mode == FileMode.Append) mode = FileMode.OpenOrCreate; SafeFileHandle handle = CreateFile(path, access, share, IntPtr.Zero, mode, 0, IntPtr.Zero);
    if (handle.IsInvalid) throw new IOException("Could not open file stream.", new Win32Exception());
    return new FileStream(handle, access);
}

[DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
private static extern SafeFileHandle CreateFile(string lpFileName, FileAccess dwDesiredAccess, FileShare dwShareMode, IntPtr lpSecurityAttributes, FileMode dwCreationDisposition, int dwFlagsAndAttributes, IntPtr hTemplateFile); 
```

[Stephen Toub](https://social.msdn.microsoft.com/profile/Stephen+Toub+-+MSFT)于 2006 年 1 月在[MSDN 杂志上发表](http://msdn.microsoft.com/en-us/magazine/cc163677.aspx)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-03T03:14:49.920

不在 .NET 中：

[http://support.microsoft.com/kb/105763](http://support.microsoft.com/kb/105763)

```
#include <windows.h>
   #include <stdio.h>

   void main( )
   {
      HANDLE hFile, hStream;
      DWORD dwRet;

      hFile = CreateFile( "testfile",
                       GENERIC_WRITE,
                    FILE_SHARE_WRITE,
                                NULL,
                         OPEN_ALWAYS,
                                   0,
                                NULL );
      if( hFile == INVALID_HANDLE_VALUE )
         printf( "Cannot open testfile\n" );
      else
          WriteFile( hFile, "This is testfile", 16, &dwRet, NULL );

      hStream = CreateFile( "testfile:stream",
                                GENERIC_WRITE,
                             FILE_SHARE_WRITE,
                                         NULL,
                                  OPEN_ALWAYS,
                                            0,
                                         NULL );
      if( hStream == INVALID_HANDLE_VALUE )
         printf( "Cannot open testfile:stream\n" );
      else
         WriteFile(hStream, "This is testfile:stream", 23, &dwRet, NULL);
   } 
```

# content-management-system - 您将使用什么 CMS 来重新创建 slashdot 的分布式审核系统？

> ID：604965
> 
> 赞同：1
> 
> 时间：2009-03-03T03:12:54.573
> 
> 标签：content-management-system, comments

总而言之，这里的菜鸟很尴尬，所以这里什么都没有：如果你想创建一个基于 karma 的信誉系统，它几乎像 Slashdot 那样处理用户评论，但从未发明过 slashcode，你会怎么做？是否有接近于这样做的开源 CMS？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T03:22:34.423

为什么不使用[真正的交易](http://www.slashcode.com/)？

**编辑：**

不知何故，我错过了中间关于 Slashcode 的评论。对不起。

我仍然很好奇您为什么不使用 Slashcode，但我可能会做的是对所有登录用户进行审核，但根据他们的参与度和类似于元审核的内容给予他们的审核权重值。

想一想，SO和/。他们的社区排名策略并没有那么不同。业力和参与度与您获得适度分数的频率有很大关系......

**摘自评论：**

带有[社区审核](http://lussumo.com/addons/index.php?PostBackAction=AddOn&AddOnID=412)插件的[香草可能是一个不错的起点。](http://getvanilla.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T03:15:21.367

从软件工程师的角度来看，我可能会选择 PHP、MySQL 和一个很好的开发框架，并且会使用它。

如果您确切地知道您需要它做什么，通常不需要很长时间就可以使系统进入工作状态。好处是你得到了你想要的**。**

有了像 PHP 和 MySQL 这样的开源工具，您已经掌握了很多方法，可能更容易手动编写您需要的代码，而不是学习如何让 X 框架为您做这件事。

# wcf - 是否可以在 WCF 中没有无参数构造函数的情况下序列化对象？

> ID：604974
> 
> 赞同：7
> 
> 时间：2009-03-03T03:15:23.850
> 
> 标签：wcf, .net-3.5, serialization, c#-3.0

我知道私有无参数构造函数可以工作，但是没有无参数构造函数的对象呢？

我想从第三方库中公开类型，所以我无法控制类型定义。

如果有办法，最简单的方法是什么？例如，我不需要创建子类型。

编辑：

我正在寻找的是类似于此处显示的自定义级别：http: [//msdn.microsoft.com/en-us/magazine/cc163902.aspx](http://msdn.microsoft.com/en-us/magazine/cc163902.aspx) 虽然我不想求助于流来序列化/反序列化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T06:15:41.967

您不能真正使任意类型可序列化；在某些情况下（`XmlSerializer`例如 ），运行时会公开用于欺骗属性的选项。但`DataContractSerializer`不允许这样做。可行的选择：

*   *隐藏您自己的可*序列化类型后面的类（大量工作）
*   提供二进制格式化程序代理（yeuch）
*   编写你自己的序列化核心（做很多工作才能做好）

本质上，如果某些东西不是为序列化而*设计*的，那么很少有框架可以*让*你序列化它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T04:19:20.170

我刚刚运行了一个小测试，使用 WCF 服务返回一个没有默认构造函数的基本对象。

```
//[DataContract]
//[Serializable]
public class MyObject
{
    public MyObject(string _name)
    {
        Name = _name;
    }

    //[DataMember]
    public string Name { get; set; }

    //[DataMember]
    public string Address { get; set; }
} 
```

这是服务的样子：

```
public class MyService : IMyService
{
    #region IMyService Members

    public MyObject GetByName(string _name)
    {
        return new MyObject(_name) { Address = "Test Address" };
    }

    #endregion
} 
```

这实际上有效，只要 MyObject 是 [DataContract] 或 [Serializable]。有趣的是，它似乎不需要客户端的默认构造函数。这里有一个相关的帖子：

[WCF反序列化如何在不调用构造函数的情况下实例化对象？](https://stackoverflow.com/questions/178645/how-does-wcf-deserialization-instantiate-objects-without-calling-a-constructor)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T03:39:01.890

我不是 WCF 专家，但它们不太可能支持对具有任意类型的构造函数进行序列化。即因为他们会传递什么值？您可以为引用类型传递 null，为结构传递空值。但是，可以用完全空的数据构造一个类型有什么好处呢？

我认为你被困在 2 个选项中的 1 个

1.  子类化有问题的类型并将适当的默认值传递给非无参数构造函数
2.  创建一个单独存在的类型以进行序列化。完成后，它可以创建您感兴趣的原始类型的实例。它是各种各样的桥梁。

我个人会选择#2。使类成为仅数据结构并针对序列化和工厂目的对其进行优化。

# c# - 为什么加密字节数组的长度与其 char[] 表示不同？

> ID：604978
> 
> 赞同：3
> 
> 时间：2009-03-03T03:17:40.207
> 
> 标签：c#, encryption

我正在研究一些加密/解密算法，我注意到加密的 byte[] 数组的长度总是 33，而 char[] 数组的长度总是 44。有谁知道这是为什么？

（我正在使用 Rijndael 加密。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T03:30:25.717

[填充](http://www.di-mgt.com.au/cryptopad.html)和[文本编码](http://en.wikipedia.org/wiki/Binary-to-text_encoding)。大多数加密算法都有块大小，输入需要填充到该块大小的倍数。此外，将二进制数据转换为文本通常涉及[Base64 算法](http://en.wikipedia.org/wiki/Base64)，该算法将 3 个字节扩展为 4 个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T03:27:25.770

对于所有加密算法当然不是这样，它必须只是您正在使用的特定算法的属性。在不知道它是什么算法的情况下，我只能猜测，但 33/44 的比率表明该算法可能会将输出字节数组中的每个字符压缩为 6 位。这可能意味着它假设使用不超过 64 个不同的字符，这对于纯文本来说是一个很好的假设（事实上，这就是 base64 解码的工作方式）。

但同样，在不知道您使用的是什么算法的情况下，这都是猜测。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T03:28:20.323

在不知道您使用的加密的情况下，确定确切原因有点困难。首先，这是一篇关于[如何计算加密数据大小的](http://www.obviex.com/Articles/CiphertextSize.aspx)文章。听起来您可能正在使用明文的哈希，这就是结果更短的原因。

编辑：这是[Rijndael Implementation](http://www.obviex.com/samples/Encryption.aspx)的来源。看起来密文输出最初与明文输入的长度相同，然后他们对其进行 base64 处理，正如之前的海报所提到的，这会将您的最终输出减少到原始输入的 3/4。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T03:23:55.670

不，根本不知道，但我的第一个想法是您的加密算法是这样构建的，它从输出数据中每 10 删除 1 位。

只有您可以确定，因为我们无法从这里看到您的代码 :-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T03:46:23.370

如果它只是一对一地替换字节，那将是一个非常糟糕的加密算法。那是 50 年前最先进的技术，[即使在那时也不是很好](https://secure.wikimedia.org/wikipedia/en/wiki/Cryptanalysis_of_the_Enigma)。:)

# metaphone - 双变音器的测试套件？

> ID：604982
> 
> 赞同：2
> 
> 时间：2009-03-03T03:18:47.337
> 
> 标签：metaphone, actionscript-3

我已经将 Double-Metaphone 翻译成 ActionScript3 并且我想（显然）在我将源代码发布到……嗯……开放之前对其进行测试。

我正在寻找一长串带有主要和次要代码的名称。除了一个带有成对名称的列表（大概它们应该匹配）之外，谷歌没有找到任何东西。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T05:21:16.900

您可以找到其他人的双变音位实现，在相同的长单词列表上运行它，然后将结果与您自己的结果进行比较。

对于长长的单词列表，我喜欢 infochimps。他们有很多单词列表，例如[350,000 个英文单词](http://infochimps.org/dataset/word_list_mobywords_all_simple)中的一个或[地名中的这个](http://infochimps.org/dataset/word_list_mobywords_place_names)，等等。

以下是[您可以将结果与](http://aspell.net/metaphone/). 这是一个[在线示例](http://swoodbridge.com/DoubleMetaPhone/mptest.php3)，但它一次只测试一个单词 - 我想您必须下载并运行其中一个脚本才能测试大量单词。

对于每个单词，将返回两个代码；您可能想要测试返回的两个代码是否与另一个实现返回的代码匹配。您可能知道[参考实现在这里](http://www.ddj.com/cpp/184401251)有[完整的源代码](ftp://ftp.cuj.com/sourcecode/cuj/2000/cujjun2000.zip)，但为了其他人的利益，无论如何都包括链接。

# data-structures - Lisp/Scheme 中的自引用数据结构

> ID：604988
> 
> 赞同：18
> 
> 时间：2009-03-03T03:25:05.730
> 
> 标签：data-structures, functional-programming, lisp, graph, scheme

有没有办法在lisp或scheme中构建一个自引用数据结构（比如一个带循环的图）？我以前从未想过它，但由于缺乏进行破坏性修改的方法，我找不到直接的方法来制作它。这只是函数式语言的一个本质缺陷吗？如果是这样，那么像 haskell 这样的惰性函数式语言呢？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T09:33:35.703

在 Common Lisp 中，您可以修改列表内容、数组内容、CLOS 实例的插槽等。

Common Lisp 还允许读写循环数据结构。利用

```
? (setf *print-circle* t)
T

; a list of two symbols: (foo bar)

? (defvar *ex1* (list 'foo 'bar))
*EX1*

; now let the first list element point to the list,
; Common Lisp prints the circular list

? (setf (first *ex1*) *ex1*)
#1=(#1# BAR)

; one can also read such a list

? '#1=(#1# BAR)
#1=(#1# BAR)

; What is the first element? The list itself

? (first '#1=(#1# BAR))
#1=(#1# BAR)
? 
```

所谓的**纯**函数式编程语言不允许副作用。大多数 Lisp 方言**并不**纯粹。它们允许副作用，并且允许修改数据结构。

有关更多信息，请参阅 Lisp 介绍书籍。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-03T04:05:16.023

Common Lisp 支持使用`setf`.

[您可以通过打结](http://www.haskell.org/haskellwiki/Tying_the_Knot)在 Haskell 中构建循环数据结构。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-03T03:35:51.723

在 Scheme 中，您可以使用`set!`、`set-car!`和`set-cdr!`（以及以 bang ( ) 结尾的任何其他内容`'!'`，表示修改）轻松完成：

```
(let ((x '(1 2 3)))
  (set-car! x x)
  ; x is now the list (x 2 3), with the first element referring to itself
  ) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-03T14:49:58.687

1.  您不需要“破坏性修改”来构建自引用数据结构；例如，在 Common Lisp 中，`'#1=(#1#)`是一个包含自身的 cons-cell。

2.  Scheme 和 Lisp 能够进行破坏性修改：您可以像这样构建上面的循环 cons： `(let ((x (cons nil nil))) (rplaca x x) x)`

你能告诉我们你在学习 Lisp/Scheme 时使用了什么材料吗？我正在为我们的黑色直升机编制一份目标清单；这种关于 Lisp 和 Scheme 的错误信息的传播必须停止。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T18:30:51.840

是的，它们很有用。我的一位大学教授创建了一个名为 Medusa Numbers 的 Scheme 类型。它们是可以包含重复小数的任意精度浮点数。他有一个功能：

```
(create-medusa numerator denominator) ; or some such 
```

它创造了代表理性的美杜莎数。因此：

```
(define one-third (create-medusa 1 3))
one-third => ; scheme hangs - when you look at a medusa number you turn to stone
(add-medusa one-third (add-medusa one-third one-third)) => 1 
```

如前所述，这是通过设置车的明智应用完成的！和设置-cdr！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-03T23:08:41.937

这不仅是可能的，而且是 Common Lisp 对象系统的核心：标准类是它自己的一个实例！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-04T04:10:03.723

我赞成明显的方案技术；此答案仅针对 Haskell。

在 Haskell 中，您可以使用 纯函数式来执行此操作`let`，这被认为是很好的风格。一个很好的例子是正则表达式到 NFA 的转换。您也可以使用`IORef`s 命令式地执行此操作，这被认为是糟糕的样式，因为它强制您的所有代码进入 IO monad。

一般来说，Haskell 的惰性求值适用于循环和无限数据结构的可爱功能实现。在任何复杂`let`的绑定中，所有绑定的事物都可以在所有定义中使用。例如，将特定的有限状态机翻译成 Haskell 是一件轻而易举的事，无论它可能有多少个周期。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T18:14:03.860

关闭示例：

```
（定义类节点（）
  ((child :accessor node-child :initarg :child)))

(defun make-node-cycle ()
  (let* ((node1 (make-instance 'node))
         (node2 (make-instance 'node :child node1)))
     (setf (node-child node1) node2)))

```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-06T13:32:07.047

在 StackOverflow 上打结[（Haskell 中的循环数据结构）](https://stackoverflow.com/questions/357956/explanation-of-tying-the-knot)

另请参阅 Haskell Wiki 页面：[打结](https://wiki.haskell.org/Tying_the_Knot)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-07T06:03:44.337

我在搜索“CIRCULAR LISTS LISP SCHEME”时偶然发现了这个问题。

这就是我如何制作一个（在 STk 方案中）：

首先，列一个清单

```
(define a '(1 2 3)) 
```

此时，STk 认为 a 是一个列表。

```
(list? a)
> #t 
```

接下来，转到最后一个元素（`3`在本例中为 the）并将`cdr`当前包含的元素替换`nil`为指向自身的指针。

```
(set-cdr! (cdr ( cdr a)) a) 
```

现在，STk 认为 a 不是列表。

```
(list? a)
> #f 
```

（它是如何解决的？）

现在，如果您打印`a`，您会发现一个无限长的列表，`(1 2 3 1 2 3 1 2 ...`您将需要终止该程序。在 Stk 你可以`control-z`或`control-\`退出。

但是循环列表有什么用呢？

我可以想到一些与模算术有关的晦涩示例，例如一周中各天的`(M T W T F S S M T W ...)`循环列表，或由 3 位表示的整数的循环列表`(0 1 2 3 4 5 6 7 0 1 2 3 4 5 ..)`。

有没有现实世界的例子？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T06:30:49.117

嗯，没有提到 Lisp/Scheme 和 SICP 流中的自引用数据结构？好吧，总而言之，流 == 惰性评估列表。它可能正是您想要的那种自我参照，但它是一种自我参照。

因此，`cons-stream`在 SICP 中是一种延迟评估其参数的语法。 `(cons-stream a b)`将立即返回而不评估 a 或 b，并且仅在您调用`car-stream`或时评估 a 或 b`cdr-stream`

来自 SICP，http://mitpress.mit.edu/sicp/full-text/sicp/book/node71.html [:](http://mitpress.mit.edu/sicp/full-text/sicp/book/node71.html "SICP") >

> ```
> (define fibs
>   (cons-stream 0
>                (cons-stream 1
>                             (add-streams (stream-cdr fibs)
>                                          fibs)))) 
> ```
> 
> 这个定义说 fibs 是一个以 0 和 1 开头的流，因此流的其余部分可以通过将 fibs 添加到自身移位一个位置来生成：

在这种情况下，“fibs”被分配了一个对象，其值是根据“fibs”延迟定义的

差点忘了提，惰性流存在于常用库 SRFI-40 或 SRFI-41 中。我认为这两个中的一个应该在最流行的方案中可用

# javascript - 是否可以检测东亚语言支持？

> ID：604993
> 
> 赞同：7
> 
> 时间：2009-03-03T03:27:49.730
> 
> 标签：javascript, browser, internationalization

我正在开发一个需要显示日文字符的 javascript 记忆游戏。是否有跨浏览器的方式来检测对亚洲语言或日语的支持？

window.navigator.language 将被设置为浏览器的语言，但会错过没有将日语设置为浏览器语言的人（？）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T11:44:25.030

> 是否有跨浏览器的方式来检测对亚洲语言或日语的支持？

你的意思是“是否安装了日文字体”？因为现代操作系统可以配置的“对亚洲语言的支持”的唯一其他方面是与 Shift-JIS 等字符编码是否已知（在 Windows 上也称为代码页 932）有关。但是无论如何您通常都不需要它，因为您可以使用 UTF-8，它更干净并且在任何地方都受支持。

一般来说，您无法直接判断是否安装了特定字符范围的字体，但有一些迂回的方法。例如测量页面文本的渲染大小：

```
var half= document.createElement('span');
var full= document.createElement('span');
half.appendChild(document.createTextNode('\uFF71'));
full.appendChild(document.createTextNode('\u30A2'));
document.body.insertBefore(half, document.body.firstChild);
document.body.insertBefore(full, document.body.firstChild);
var havejapanesefont= half.offsetWidth!=full.offsetWidth;
document.body.removeChild(half);
document.body.removeChild(full); 
```

这会临时创建包含片假名“a”的半角和全角变体的元素。如果可以使用日文字体，我们希望它们具有不同的宽度。如果不存在这样的字体，它们很可能会被渲染为具有相同宽度的类似“不可渲染字符”字形。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T03:45:14.900

您的服务器可能能够检查[`Accept-Charset`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.2)标题，如果它不包含日文字符，则重定向到警告页面。不幸的是，正如[这个线程](https://stackoverflow.com/questions/220149/how-do-i-access-the-http-request-header-fields-via-javascript)所指出的，标头不适用于 javascript。

# c# - 尝试将数据填充到 DataTable 时总是出现异常

> ID：604996
> 
> 赞同：2
> 
> 时间：2009-03-03T03:30:05.093
> 
> 标签：c#, oracle

下面的代码只是连接Oracle数据库并将数据填充到DataTable的测试。执行语句**da.Fill(dt);后** ，我总是得到异常

> “抛出了‘System.OutOfMemoryException’类型的异常。”

有没有人遇到过这种错误？我的项目是在VS 2005上运行的，我的Oracle数据库版本是11g。我的电脑使用的是 Windows Vista。如果我复制此代码以在 Windows XP 上运行，它可以正常工作。

谢谢你。

```
using System.Data;
using Oracle.DataAccess.Client;

...

string cnString = "data source=net_service_name; user id=username; password=xxx;";
OracleDataAdapter da = new OracleDataAdapter("select 1 from dual", cnString);

try
{
   DataTable dt = new DataTable();
   da.Fill(dt);  // Got error here
   Console.Write(dt.Rows.Count.ToString());

}
catch (Exception e)
{
   Console.Write(e.Message); // Exception of type 'System.OutOfMemoryException' was thrown.
} 
```

**更新**

我不知道我的电脑会发生什么。我只是重新安装了Oracle 11g，然后我的代码就可以正常工作了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T04:33:52.083

`dual`你的桌子有多大？这个查询：

```
select 1 from dual 
```

将返回一个包含与表一样多的行的单`dual`列表，每行有 1 个。如果表有数百万行，那么如果它抛出内存不足异常，我不会感到惊讶。

**编辑**当然，这并不能解释为什么它可以在 XP 上运行，但不能在 Vista 上运行，除非它是特定于实现的（例如，在两个不同的工作站上查询数据库的不同实例）。

**编辑2：**

好的，所以大概只有一行，`dual`因为您的评论表明查询只返回一行。

需要调查的几件事：

1.  Oracle ADO.NET 连接需要 Oracle 客户端软件，对吗？您的 Vista 机器上的 Oracle 软件与 XP 机器上的版本是否相同？也许那里有差异。

2.  不要显示`e.Message`，而是尝试显示`e.ToString()`以获取完整的堆栈跟踪 - 它可能会让您更深入地了解错误是从哪里引发的。

# c# - 设置注册表值时出现 NullReferenceException

> ID：604998
> 
> 赞同：1
> 
> 时间：2009-03-03T03:31:12.220
> 
> 标签：c#, winforms, registry

当我尝试为注册表项设置值时，我收到了 NullReference 异常。下面是我的代码。有谁知道为什么？

```
using System;
using Microsoft.Win32;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button2_Click(object sender, EventArgs e)
        {
           RegistryKey myKey = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\Current Version\\Policies\\System", true);
            myKey.SetValue("DisableTaskMgr", 0, RegistryValueKind.DWord);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T03:34:26.550

尝试使用 CreateSubKey 而不是 OpenSubKey。如果键不存在，后者将返回 null。很可能该键不存在，这就是您在下一行点击空引用的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T03:39:44.727

当前版本应该是一个词。即当前版本。

**编辑：**我也同意 Jared 你也应该使用 CreateSubKey。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T03:38:30.440

问题是当前版本之间的空间。*****