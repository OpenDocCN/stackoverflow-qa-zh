# StackOverflow 问答 1002000-1002999

# hibernate - hibernate级联删除示例

> ID：1002000
> 
> 赞同：0
> 
> 时间：2009-06-16T14:52:19.640
> 
> 标签：hibernate

谁能给我提供完整的2个实现级联删除的映射文件。测量如果 A 包含一组 B，那么当 A 被删除时，B 会自动被删除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-03T12:48:30.167

您只需要 1 个映射文件：父对象之一。例如这个例子来自[Hibernate in action](https://rads.stackoverflow.com/amzn/click/com/193239415X)

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD//EN" "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">
<hibernate-mapping>
    <class name="hello.Message" table="MESSAGES">
    <id
        name="id"
        column="MESSAGE_ID">
        <generator class="increment"/>
    </id>
    <property
        name="text"
        column="MESSAGE_TEXT"/>
    <many-to-one
        name="nextMessage"
        cascade="all"
        column="NEXT_MESSAGE_ID"/>
    </class>
</hibernate-mapping> 
```

“级联”参数完成了这项工作。如果你只想要级联删除，那么你应该使用 cascade="delete"。其他选项是“all-delete-orphan”和“delete-orphan”。查看[Hibernate 文档](http://docs.jboss.org/hibernate/stable/core/reference/en/html_single/)以获取更多信息。

# python - 在 python 中创建代理框架以实现灵活的脚本分发和数据收集的最佳方法是什么

> ID：1002002
> 
> 赞同：0
> 
> 时间：2009-06-16T14:52:35.130
> 
> 标签：python

我正在尝试做的事情：我有数百台服务器，它们的日志文件非常大，分布在数十个不同的客户端上。我正在创建漂亮的 python 脚本来以不同的方式解析日志，并希望汇总我从所有不同服务器收集的数据。我还想集中更改脚本。这个想法是有一个可以连接到每个服务器的工具，将脚本 scp 到服务器，使用 pexpect 或类似的东西运行该过程，然后将结果数据 scp 回单独的文件中以进行聚合或（最好，我认为) 流式传输数据并即时聚合。我没有设置密钥（我也不想设置它们），但我有一个包含连接信息、登录名、密码等的数据库。

我的问题：这似乎是一个已解决的问题，我想知道是否有人知道做这种事情的东西，或者是否有一种可靠且经过验证的方法来做到这一点......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:19:19.930

看起来[hadoop](http://hadoop.apache.org/core/)是你的答案 [http://www.michael-noll.com/wiki/Writing_An_Hadoop_MapReduce_Program_In_Python](http://www.michael-noll.com/wiki/Writing_An_Hadoop_MapReduce_Program_In_Python)

或 Pyro 也不错，但我不确定您是否可以自动分发脚本。 [http://pyro.sourceforge.net/features.html](http://pyro.sourceforge.net/features.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:56:13.143

Parallel Python 为分布式计算和通信提供了一些功能：

[http://www.parallelpython.com/](http://www.parallelpython.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:06:08.597

看看[Func](https://fedorahosted.org/func/)。它是一个使用 python 与大量机器进行 rpc 风格通信的框架。作为奖励，它带有内置的 TLS，因此您无需在 ssh 隧道之上进行分层以确保安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-19T12:56:09.433

至少你的一部分工作 - 脚本分发，可以由[麻雀](https://github.com/melezhik/sparrow)- 脚本分发系统完成。

因此，您也可以使用多种语言和 Python 编写脚本！Sparrow 将脚本视为具有版本、所有权和文档的软件包，就像您通过 deb 或 rpm 安装软件包一样。

Sparrow 提供了一种以集中方式开发和管理各种脚本的简洁方法。

PS。免责声明 - 我是工具作者

# java - 修饰键状态

> ID：1002004
> 
> 赞同：1
> 
> 时间：2009-06-16T14:52:38.953
> 
> 标签：java, keyboard, swt, modifier

我在 SWT 中有一个小*（rikiki）问题......*

我正在制作一个扩展**org.eclipse.swt.widgets.Composite**的小类，它应该嵌套在 RCP 应用程序中......

在这个小课堂中，我有应该对鼠标或键盘事件做出反应的小部件

**但**

当我单击它们或向它们发送键盘事件时，我需要使用修饰键（*Shift/Ctrl/Alt/... ）来改变我的 coponents 行为...*

问题是我不能只听*mod-key*敲击，因为我的用户可以从我的组件中删除它然后单击它......

我不能使用显示过滤器来避免干扰嵌套我的组件的外壳。（*但如果没有其他解决方案，这可能是我的最后一个解决方案*）

我无法制作一个透明组件来读取事件并将其分派给我的所有组件，因为它最多与我的组件一样大，并且不会从我的*组件*（甚至是从外壳） ) ...

有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-26T10:17:13.040

或多或少就像

```
myComponent.add<Any>Listener(new <Appropriate>Listener(){
    @Override
    public void <AppropriateMethod>(like KeyPress)>(<Appropriate>Event e) {
        int stateMask=e.stateMask;
        if((stateMask & SWT.ALT)==SWT.ALT){
            <Do_appropriate_actions>;
        }
        if((stateMask & SWT.CTRL)==SWT.CTRL){
            <Do_another_appropriate_actions>;
        }
        if((stateMask & SWT.SHIFT)==SWT.SHIFT){
            <Do_an_even_more_appropriate_actions_cause_you_are_kind_of_a_code_roxxor_!>;
        }
    };
};
```

希望能帮助到你 ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T18:04:04.100

尝试按照以下方式捕获所有密钥并将它们保存以备后用：

```
 Display.getDefault().addFilter( SWT.KeyDown, new Listener() {

        public void handleEvent( Event passedEvent ) {
            //Listen for and store as static var last pressed keycode
            System.out.println( "Key Event: " + passedEvent );
        }
    } ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-28T08:59:11.980

您可以使用以下方法测试修饰键：

```
/**
 * Key code of pressed modifier key.
 *
 * @param keyEvent the received key event
 * @return the key code or 0 if no modifier key is pressed
 */
private static int getModifierKeyCode(KeyEvent keyEvent) {
    return (keyEvent.stateMask & SWT.MODIFIER_MASK);
} 
```

示例调用：

```
item.addKeyListener(new KeyAdapter() {
    @Override
    public void keyPressed(KeyEvent keyEvent) {
        if(getModifierKeyCode(keyEvent) == SWT.CTRL && keyEvent.keyCode == 'f') { // CTRL + F
            // do something
        )
    }
} 
```

# c - 进程如何知道它何时被后台处理？

> ID：1002008
> 
> 赞同：2
> 
> 时间：2009-06-16T14:53:13.383
> 
> 标签：c, linux, signals, tty

当我 scp 一个文件时，我可以用 ^Z 停止它并将它放在后台。当它在后台时，它会停止打印其进度，但复制会继续。如果我再次将其置于前台，它将继续打印。它是怎么知道的？看头？这会发生在标准的ptty上吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:02:04.580

是的，你明白了。该进程将捕获或忽略 SIGTTOU（可能还有 SIGTTIN，这取决于它在做什么），然后在接收到这些信号时它会表现得适当。Linux 确实在普通的伪终端上发送这些信号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:06:11.763

我和我的一个同事实际上查看了源代码并找到了答案。

每当 scp 即将打印输出时，它都会在标准输出上运行 tcgetpgrp。这将返回终端的控制进程组（假设它是一个终端）。仅当控制终端的进程组与 scp 的进程组相同时才会打印出来。原来不需要信号！（虽然它确实处理 SIGWINCH 来计算进度线的大小）。

# apache-flex - Nginx 和代理避免 Flex 安全错误

> ID：1002009
> 
> 赞同：1
> 
> 时间：2009-06-16T14:53:17.687
> 
> 标签：apache-flex, url, nginx

使用 flex bipmapdata.draw() 进行快照时，如果图像不是来自允许的域，则会引发安全错误。

我正在尝试添加来自多个 url 源（谷歌图像）的图像，因此我无法调用 draw()。

但是，如果图像是我的服务器 www.foo.com，它有一个不错的 crossdomain.xml，那一切都很好。

我与 Nginx 相关的问题如下：

我如何制作一个代理，其中[http://www.foo.com/img_proxy/bar_img_url](http://www.foo.com/img_proxy/bar_img_url)将感染来自[http://bar_img_url](http://bar_img_url)的图像并将其返回，就好像它来自**www.foo.com**域一样。

到目前为止，我用过：

```
location /img_proxy/ {
    rewrite  ^/img_proxy/(.*)  http://$1  last;
} 
```

它完成了获取图像的工作，但不知何故 flex 仍然知道它不是来自我的服务器，因为 .draw() 仍然失败。

我希望我能看穿 flash 发送的 http 标头。

你会如何解决这个问题？

谢谢

# jquery - ASP.Net MVC 基于文件上传切换 IsAjaxRequest 属性？

> ID：1002012
> 
> 赞同：0
> 
> 时间：2009-06-16T14:53:55.363
> 
> 标签：jquery, asp.net-mvc

我有一个表格，所有设置都可以上传文件，并且工作正常。但是我的表单提交方式是通过 AJAX。如果 JS 关闭，提交的按钮仍然是 type="submit"。

当我保存表单时，控制器确定 IsAjaxRequest 是否为真，如果是则返回一些 JSON，否则它会执行 RedirectToAction。

当我没有在我的输入 type="file" 中指定文件路径时，它认为 IsAjaxRequest 为真。如果设置了文件路径，则它认为 IsAjaxRequest 为假。它是如何确定的？

我的另一个问题是，当它认为 IsAjaxRequest 为 false 并执行 RedirectToAction("Index") 时，我实际上并没有被发送到 Index 视图。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T15:09:53.067

也许问题不在`IsAjaxRequest()`？- 它只是`["X-Requested-With"] == "XMLHttpRequest"`在传入的请求中查找。查看[Mvc\AjaxRequestExtensions.cs](http://aspnet.codeplex.com/sourcecontrol/changeset/view/23011?projectName=aspnet#338547)：

```
public static class AjaxRequestExtensions {
    public static bool IsAjaxRequest(this HttpRequestBase request) {
        if (request == null) {
            throw new ArgumentNullException("request");
        }

        return (request["X-Requested-With"] == "XMLHttpRequest")
            || ((request.Headers != null)
                && (request.Headers["X-Requested-With"] == "XMLHttpRequest"));
    }
} 
```

# java - 我应该如何在 Openjpa 实体中使用枚举？

> ID：1002016
> 
> 赞同：0
> 
> 时间：2009-06-16T14:54:40.883
> 
> 标签：java, openjpa

我正在尝试在 openjpa 实体中使用枚举字段。一切正常，我尝试增强我的实体，这些实体因 Enum 类型的 ClassNotFound 异常而中断。我正在使用 openjpa maven 插件来增强实体，并且枚举被声明为 public 并且位于类路径上。我不确定我在这里缺少什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:08:53.167

我们遇到了同样的问题。

您需要在定义任务时使用的类路径中包含缺少的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T21:00:08.697

It looks like it may be a bug -- see this [bug report](https://issues.apache.org/jira/browse/OPENJPA-1121).

# asp.net - 如何将验证器分配给按钮

> ID：1002021
> 
> 赞同：2
> 
> 时间：2009-06-16T14:55:29.853
> 
> 标签：asp.net, validation

有没有办法分配一组 asp.net 验证来验证单击按钮的时间？

我的网站上有两个部分。如果一个部分未提交而用户决定提交另一个部分，我想阻止第一部分的验证也被触发。

有什么建议或指示吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T14:56:51.737

将验证器和按钮上的 ValidationGroup 设置为相同的值以将它们绑定在一起。在下面的示例中，有 2 个按钮，每个按钮都验证一个或另一个部分，但不能同时验证两者。

```
<asp:RequiredFieldValidator runat="server" ... ValidationGroup="GroupOne" />
<asp:RequiredFieldValidator runat="server" ... ValidationGroup="GroupTwo" />
<asp:Button runat="server" ID="ButtonOne" ... CausesValidation="true" ValidationGroup="GroupOne" />
<asp:Button runat="server" ID="ButtonTwo" ... CausesValidation="true" ValidationGroup="GroupTwo" /> 
```

# c++ - 根据内存位置对两个链表进行排序

> ID：1002024
> 
> 赞同：0
> 
> 时间：2009-06-16T14:56:04.157
> 
> 标签：c++, data-structures, linked-list

我需要合并两个双向链表，但不是按它们的值（列表未排序）。我想获得一个列表，其中包含两者中的所有节点，但按照它们在内存中出现的顺序。

也许这张图片有更多帮助：http: [//img140.imageshack.us/i/drawing2.png/](http://img140.imageshack.us/i/drawing2.png/)

有没有可以进行这种合并的算法（最好是快速算法）？也许这有点帮助：

*   列表的起始节点总是在其他节点之前。
*   一个列表最多可以有 8192 个节点。
*   我知道节点在内存中的位置，因为列表会跟踪一大块内存中的空闲位置（用于内存分配器）。
*   我在 C++ 中工作。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T15:02:29.417

好吧，听起来您没有使用`std::list`，所以我将使用通用解决方案。由于您的要求是合并列表，但让节点按内存中物理位置的顺序排列。您可能只附加两个列表，然后按节点的地址对节点进行排序。

有关链表的排序算法，请参见：[http ://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html。](http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html)

排序时，而不是**`node1->value < node2->value`**只比较 do**`(size_t)node1 < (size_t)node2`**或类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:01:00.450

“合并”在这里有点误导，因为您只能合并已排序的列表，而您的未排序。

您需要排序，而不是合并。

将指向节点的指针放入向量中。在向量上使用 std::sort ，并传递一个比较函子，该函子将每个指针转换为 size_t （我认为）并比较结果数字。

然后，您可以根据向量中的结果顺序重新排列链接列表。

# java - 如何在 PrintStackTrace 后保持 CFEXECUTE 不挂起

> ID：1002025
> 
> 赞同：2
> 
> 时间：2009-06-16T14:56:04.267
> 
> 标签：java, coldfusion, cfexecute

我正在使用 ColdFusion MX7 对一些 Java 6 代码执行 CFEXECUTE。

不幸的是，由于 CF7 在 JDK 6 下不起作用，我必须这样做。

我的问题是，当 Java 代码中发生异常时，如果我`printStackTrace`在异常上调用 a，CFEXECUTE 命令会挂起。ColdFusion 最终超时，但 Java 进程继续在后台挂起。

我猜有一些阻塞正在发生，但我似乎无法弄清楚为什么。

如果我不这样做，`printStackTrace`那么一切正常。

这些异常是使用来自 Oracle Information Rights Management wsdl 的 JAXWS 生成的 WebService 异常。

**编辑**

我注意到我可以`printStackTrace`用文件`PrintStream`作为参数调用它，它工作正常。所以，看起来错误流有问题。

这是Java代码：

```
public void Execute(){
    AdminUtils AU = AdminUtils.GetInstance();

    AccountServicesPort AA = AU.GetAccountServicesPort(); 

    LicenseServerRef LicSerRef = AU.GetLicenseServerRef();

    User UserToSave = new User();
    UserToSave.setUserName(UserName);
    UserToSave.setFirstName(FirstName);
    UserToSave.setLastName(LastName);
    UserToSave.setEmailAddress(EmailAddress);
    UserToSave.setServer(LicSerRef);

    try{
        AU.LogMessage("Change User: " + UserName + " " + FirstName + " " + LastName + " " + EmailAddress);
        AA.saveChangesToUser(UserToSave);
    }catch(Exception e){
        e.printStackTrace();
    }
} 
```

这是 ColdFusion 调用：

```
<!--- Update the IRM User. --->
<CFEXECUTE name="c:\Program Files\Java\jdk1.6.0_14\bin\javaw.exe"
           arguments="-cp C:\CFusionMX7\Externals\IRM.jar;C:\CFusionMX7\Externals\Config IRMWebServices.UpdateUser #LoginID# #NewFname# #NewLname#"
           timeout="15" 
           variable="OUTPUT">
</CFEXECUTE> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T16:27:24.287

是的，`e.printStackTrace();`写入 stderr（标准错误流）。由于`cfexecute`不捕获标准错误，这可能是导致 cfexecute 挂起的原因。有一个补丁可以修复 CF8 中的这种行为。

由于您使用的是 7，请尝试 Ben Forta 的提示：

*   将标准错误重定向到标准输出：[几个陷阱](http://www.forta.com/blog/index.cfm/2006/9/11/A-Couple-Of-CFEXECUTE-Gotchas)
*   运行命令并在完成后终止的标志：[使用 CFEXECUTE 执行命令行实用程序](http://www.forta.com/blog/index.cfm/2006/7/31/Using-CFEXECUTE-To-Execute-Command-Line-Utilities)

`/c`两者都使用`2>&1`应该可以解决悬挂问题。

**更新：添加示例**

*冷融合代码：*

```
<cftry>  
    <cfset argString = '/c "C:\Program Files\Java\jdk1.6.0_13\bin\java.exe" -cp c:\myJar.jar TestStdErr 2>&1'  >  
    <cfexecute name="c:\windows\system32\cmd.exe" 
        arguments="#argString#"    
        outputFile="c:\cfexcuteResults.log" 
        timeout="5" />  
    <cfcatch>  
       <cfdump var="#cfcatch#">  
    </cfcatch>  
</cftry> 
```

*Java 类：*

```
public class TestStdErr {
    public static void main(String[] args) {
        try {
            // cause a divide by zero exception 
            int a = 0;
            int b = 2 /a;
         }
         catch(Exception e){
            e.printStackTrace();
        }
    }
} 
```

# .net - WPF ListView 问题

> ID：1002031
> 
> 赞同：0
> 
> 时间：2009-06-16T14:56:48.773
> 
> 标签：.net, wpf, listview

这是我在这里的第一个问题。我开始使用 WPF，但我被卡住了。这是问题所在：我有一个 ListView 如下：

```
<UserControl.Resources>
    <DataTemplate x:Key="FirstCell">
        <StackPanel Orientation="Horizontal">
            <CheckBox Margin="2"></CheckBox>
        </StackPanel>
    </DataTemplate>
</UserControl.Resources>

<ListView Name="lvRights">
    <ListView.View>
        <GridView>
            <GridViewColumn Width="100" Header="Select" CellTemplate="{StaticResource FirstCell}"/>
            <GridViewColumn Width="200" Header="Right" DisplayMemberBinding="{Binding Path=Name}" />
        </GridView>       
    </ListView.View>
</ListView> 
```

我将列表绑定到**只有**ID 和名称的“角色”集合。我正在使用该 DataTemplate 在第一列中显示一个复选框。

这是一个问题：

我如何在运行时知道用户是否选中了其中一​​个复选框？在列表视图的 .Items 属性中，我有角色，但我无法获得有关第一列的任何信息。

我觉得这很简单，但不知何故我错过了答案。

提前10倍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:07:47.673

你可以

1）在模板中的复选框中添加一个点击处理程序。在后面的代码中，您可以将复选框的 DataContext 转换回 Role 以确定它是哪一个。

2) 您可以在 Role 类中添加某种布尔属性。然后，您可以将复选框的 IsChecked 属性绑定到此布尔属性。您可能需要一个[绑定转换器](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.converter.aspx)来转换 boolean 和 is checked 属性之间的转换器

# sql - SQL 查询：如何根据查找表更改值？

> ID：1002036
> 
> 赞同：10
> 
> 时间：2009-06-16T14:57:23.327
> 
> 标签：sql

[更新：我正在使用 MySQL 4.1.25]

我认为这一定是一件简单的事情，但我是一个 SQL 菜鸟，需要一些帮助。我有一个类似的查找表：

## 查找表

key1, value1
key2, value2
key3, value3
...
keyN, valueN

然后我有另一个表，其中有一列中的键（带有重复）的随机列表，我需要在相应的列中添加关联的值。

例如，第二个表可能是：

## second_table

键 3, ?
键 1, ?
键 1, ?
关键40，？

我需要`second_table`用以下值替换 ?s in `lookup_table`：

## second_table（更新）

键 3 ，值 3 键 1，值 1 键
1
，值 1
键 40，值 40

这似乎是一个简单的 SQL 查询应该解决的问题。有什么建议么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-16T15:02:06.047

在使用连接更新（而不是执行子查询）时，我更喜欢以下语法。它允许您在更新结果之前查看结果并知道查询的正确性。

```
select
   st.key,
   lt.value
--update st set value = lt.value
from
   second_table st
   inner join lookup_table lt on
       st.key = lt.key 
```

请注意，当您准备好更新时，请`update`从上到下选择所有内容。

**更新**：感谢 tekBlues，我发现上述方法至少适用于 SQL Server 和 Oracle。MySQL 有一些不同的语法：

```
update
    second_table st
    inner join lookup_table lt on
        st.key = lt.key
set
    st.value = lt.value 
```

这些是大型 RDBMS，因此希望其中之一对您有所帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-16T15:01:37.780

除了其他答案，您还可以通过加入来完成此操作...

```
UPDATE second_table
SET    value = L.value
FROM   second_table S join lookup_table L on S.key = L.key 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-16T14:59:27.223

```
update second_table 
set value = 
(select value from lookup_Table
where lookup_table.key = second_table.key) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-03T04:36:24.693

如果查找表是查询，一种选择是使用[PostgreSQL WITH 子句](https://www.postgresql.org/docs/9.1/queries-with.html)。

```
WITH nested_table AS 
(SELECT key, MAX(valA) as valA, MAX(valB) as valB 
 FROM .. 
 ... JOIN/GROUP BY ...
)
UPDATE second_table 
SET valA = nested_table.valA, valB = nested_table.valB 
FROM nested_table 
WHERE nested_table.key = second_table.key; 
```

# oracle - 如果只有一个与数据库的连接，我可以得到 ORA-08177 吗？

> ID：1002038
> 
> 赞同：2
> 
> 时间：2009-06-16T14:57:37.850
> 
> 标签：oracle, oracle10g, serialization, ora-08177, read-committed

我的任务是在 oracle 的 Storm 后端上运行单元测试，以便我们可以查看后端是否有足够的质量用于生产。我遇到的一个问题是，如果我以可序列化模式连接，我将得到 ORA-08177（无法序列化此事务的访问）。当我使用读取提交模式时，问题就消失了。

现在我已经阅读[了这篇 ask tom](http://www.oracle.com/technology/oramag/oracle/05-nov/o65asktom.html)文章，它表明这基本上是一个并发问题。

假设我只有一个线程连接到数据库并且世界上没有其他人连接到这个数据库，是否有可能得到这个错误？如果是这样，有人可以为我提供一个会产生此错误的示例查询吗？

或者这可能表明游标或连接没有在某处关闭？或者一个事务没有被提交或回滚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:08:55.737

只有一个会话你不应该得到这个错误。然而，以下脚本将生成一个辅助会话，它将独立于第一个会话更新一行，从而允许我们触发 ORA-8177。我不确定这是否是你想要的。

考虑：

```
SQL> alter session set isolation_level=serializable;

Session altered
SQL> create table test (a number);

Table created
SQL> insert into test values (1);

1 row inserted
SQL> commit;

Commit complete
SQL> declare
  2     pragma autonomous_transaction;
  3  begin
  4     update test set a = 2;
  5     commit;
  6  end;
  7  /

PL/SQL procedure successfully completed
SQL> update test set a = 3;

update test set a = 3

ORA-08177: can't serialize access for this transaction 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T00:22:50.320

“*涉及*到触发器，但我在 DDL 语句中遇到错误，而不是在更新或插入时。”

DDL 语句应该处理它们自己的提交。基本上他们进行提交，然后元数据更改（可能涉及许多底层对象）然后再次提交（假设 DDL 成功 - 如果失败，则应回滚更改）。

因此，如果您正在执行 DDL，那么提交应该是安全的，将事务更改为读取已提交，执行 DDL，然后将事务更改回可序列化。如果您可以提供完整的测试用例（或至少您正在谈论的那种 DDL），它可能会有所帮助。例如，物化视图创建或 CREATE TABLE AS SELECT 可能是“奇怪的”，因为它是 DDL（具有其特殊提交）加上 DML。

# windows - 使 OS 磁盘读取缓存无效

> ID：1002045
> 
> 赞同：1
> 
> 时间：2009-06-16T14:59:03.057
> 
> 标签：windows, caching, file-io

我正在尝试比较 Windows 程序在磁盘缓存处于最佳状态时的性能（当程序运行所需的所有文件都在内存缓存中时，我只是多次运行它以获得此状态），以及当缓存处于最坏的状态，即完全为空。

我知道确保缓存完全为空的唯一方法是重新启动计算机，但这并不理想，因为它需要太多时间。有没有办法在不重新启动的情况下做到这一点？我尝试了同步，但它不会使读取缓存无效...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:16:32.057

在您对 的调用中[`CreateFile`](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)，包括`FILE_FLAG_NO_BUFFERING`标志。有关详细信息，请参阅 MSDN 上的[CreateFile 参考页](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)。特别注意[要求](http://msdn.microsoft.com/en-us/library/cc644950(VS.85).aspx)。

如果修改您的代码来执行此操作太费力，请尝试编写一个简单的实用程序来读取大于物理内存的文件。这可能足以从文件系统缓存中刷新您关心的文件。

# .net - 如何指定表单打开时应该关注哪个控件？

> ID：1002052
> 
> 赞同：8
> 
> 时间：2009-06-16T14:59:38.597
> 
> 标签：.net, winforms

每当打开表单时，系统都会自动为您聚焦其中一个控件。据我所知，根据 Windows 标准行为，获得焦点的控件是选项卡顺序中第一个启用的控件。

问题是如何在运行时更改它，而不必动态重新调整标签顺序。例如，某些表单可能希望根据程序逻辑改变最初聚焦的控件，以将焦点放在最合适的控件上。如果您只关注`OnLoad`处理程序中的其他一些控件，则默认逻辑无论如何都会执行并重新关注默认控件。

如果您使用 C/C++ 编写并使用原始窗口过程或[MFC](http://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library)`FALSE` ，则可以从处理程序返回 0 ( ) `WM_INITDIALOG`，并跳过默认的聚焦逻辑。[但是，我在Windows Forms](http://en.wikipedia.org/wiki/Windows_Forms)中找不到任何方法。我想出的最好的方法是`BeginInvoke`在完成后设置焦点`OnLoad`，如下所示：

```
protected override void OnLoad( System.EventArgs e )
{
    base.OnLoad( e );
    // ... code ...
    BeginInvoke( new MethodInvoker( () => this.someControl.Focus() ) );
} 
```

必须有一些适当的方法来做到这一点 - 它是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-16T20:27:56.657

在通过反射器挖掘之后，我发现似乎是“正确”的方法：使用[ContainerControl.ActiveControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.containercontrol.activecontrol.aspx)。这可以从 OnLoad（或其他地方；请参阅文档了解限制）完成，并直接告诉框架您想要关注哪个控件。

示例用法：

```
protected override void OnLoad( System.EventArgs e )
{
    base.OnLoad( e );
    // ... code ...
    this.ActiveControl = this.someControl;
} 
```

这似乎是迄今为止最干净和最简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:03:22.177

```
 public void ControlSetFocus( Control^ control )
   {

      // Set focus to the control, if it can receive focus.
      if ( control->CanFocus )
      {
         control->Focus();
      }
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:15:08.830

除了使用 OnLoad 事件，您不能使用`Form.Activated`或`Form.Shown`事件来查看它们是否被称为控制焦点的后期渲染？

# java - BufferedReader / PrintWriter 的问题？

> ID：1002054
> 
> 赞同：5
> 
> 时间：2009-06-16T15:00:12.697
> 
> 标签：java, file, bufferedreader

我正在使用 BufferedReader 和 PrintWriter 遍历输入文件的每一行，对某些行进行更改，然后输出结果。如果一行没有发生变化，它只是按原样打印到输出文件中。然而，由于某种原因，该过程提前结束。代码看起来像这样：

```
BufferedReader in = new BufferedReader(new FileReader("in.txt"));
FileOutputStream out = new FileOutputStream("out.txt");
PrintWriter p = new PrintWriter(out);
String line = in.readLine();

while(line!=null)
{
   if(line is special)
      do edits and p.println(edited_line);
   else
      p.println(line);

   line = in.readLine();
} 
```

然而，由于某些奇怪的原因，这个过程在我的输入文件的最后提前结束（实际上打印了半行）。这有什么明显的原因吗？while 循环显然以空值结束。它在我的 250k+ 行 txt 文件的末尾。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T15:03:43.080

你在哪里刷新/关闭你的 PrintWriter 或 FileOutputStream ？如果程序退出并且没有完成，则不会写出所有结果。

您需要`out.close()` （可能`p.flush()`也是？）在进程结束时关闭文件输出流

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:03:12.177

尝试在循环后添加 p.flush() 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:03:23.080

PrintWriter 没有启用自动刷新，因此在程序终止之前文件的最后一位可能没有被刷新。

`p.flush()`在你的while循环之后添加一个 应该可以解决问题。

# sharepoint - 在具有变体的共享点发布站点中自定义面包屑

> ID：1002057
> 
> 赞同：4
> 
> 时间：2009-06-16T15:00:40.247
> 
> 标签：sharepoint, moss, navigation, breadcrumbs

我有一个带有变体的 Sharepoint 发布网站。默认情况下，面包屑显示如下：

Variation Root > English Site > Some Page 我要显示的是：“Home” > Some Page，其中 Home 指向英文站点根目录。

有没有办法在不创建自定义服务器控件的情况下实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T19:38:25.880

如果您知道确切的级别数，则可以使用 SiteMapPath，例如：

```
<asp:SiteMapPath runat="server" ParentLevelsDisplayed="1" /> 
```

否则 SiteMapPath 总是直接与当前正在使用的 SiteMapProvider 再次发生冲突，您可能可以挂钩到 SiteMapPath 的渲染中进行检查，例如：

```
protected void SiteMapPath_ItemCreated(object sender, SiteMapNodeItemEventArgs e)
{
    if (e.Item.ItemType == SiteMapNodeItemType.Root ||         
       (e.Item.ItemType == SiteMapNodeItemType.PathSeparator && 
        e.Item.ItemIndex == 1))
    {
        e.Item.Visible = false;
    }
} 
```

这将使您 SiteMapPath 不显示根节点（和第一个分隔符）。

如果希望您的节点显示“Home”，您可以绑定另一个值，例如：

```
<asp:SiteMapPath ID="siteMapPath" runat="server"
    Pathseparator="/"
    OnItemCreated="SiteMapPath_ItemCreated">

<NodeTemplate>
    <a href='<%# Eval("url") %>'><%# Eval("description") %></a>
</NodeTemplate>

<CurrentNodeTemplate>
    <%# Eval("title") %>
</CurrentNodeTemplate>    

</asp:SiteMapPath> 
```

如果 description 的值为“Home”，则将显示该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:07:00.737

就在最近，我创建了几个新的菜单控件来解决这个问题。我的控件接受自定义 ~Variation/ 标记作为 StartingNode，以便您可以创建一个面包屑，该面包屑从您的变体的主页而不是您的网站集的根开始。你可以找到更多信息[@http://blog.mastykarz.nl/templates-based-menu-control-sharepoint/](http://blog.mastykarz.nl/templates-based-menu-control-sharepoint/)

# maven-2 - 向档案添加新的文物

> ID：1002061
> 
> 赞同：1
> 
> 时间：2009-06-16T15:01:14.443
> 
> 标签：maven-2, repository, archiva

我使用 Archiva 作为我的存储库管理器。它已设置为用户点击档案回购，如果没有，档案回购将检查 maven 中央回购（内部回购代理 maven 中央）。现在，如果我想向档案存储库添加一个新的依赖项，是否可以运行一个命令来告诉它从 maven 中央存储库中获取它，还是我需要手动上传它？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:08:37.487

Archiva 将按需获取依赖项，除了构建请求它的东西之外，没有办法告诉它。只要确保您设置了正确的“代理连接器”，这让我有一阵子难住了。

如果您的依赖项不在 maven Central 中，您要么必须通过 Archiva Web 界面手动上传它，要么可以`mvn deploy`在命令行上使用。您必须检查如何使用后者指定远程仓库，我不记得了。

# c# - 来自 Windows 服务的屏幕截图

> ID：1002064
> 
> 赞同：4
> 
> 时间：2009-06-16T15:01:26.063
> 
> 标签：c#, c++, windows-services, screen-capture

我有基于 DirectShow 的屏幕捕捉软件。它在内部调用 CopyScreenToBitmap 函数来抓取屏幕。然后图片被ffdshow压缩。它作为桌面应用程序运行良好，但作为窗口服务，在某些计算机上它不起作用（黑色图片）。我已设置“允许服务与桌面交互”并在当前用户帐户上运行该服务。有什么想法可能是错的吗？

我在 Windows XP 上对其进行了测试，但预计它也可以在 Vista 和 7 上运行。

是的，它在所有计算机上都作为桌面应用程序工作，但在其中一些（大多数）上它作为服务失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T15:27:16.573

据我了解，在 Vista 中进行了一项更改，将服务从控制台用户移到了单独的桌面上。虽然您已勾选“允许访问”桌面的框，但我认为您仍然必须务实地切换服务以使用该桌面。

[这是一篇博客文章，其中包含一些有用的信息和示例](http://blogs.msdn.com/cjacks/archive/2006/11/09/a-desktop-of-your-own.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T15:36:53.153

除了允许访问桌面之外，试试这个：

1.  枚举所有窗口站：[**EnumWindowStations**](http://msdn.microsoft.com/en-us/library/ms682644(VS.85).aspx)
2.  找到登录用户的窗口站，并将其设为您的进程的窗口站：[SetProcessWindowStation](http://msdn.microsoft.com/en-us/library/ms686232(VS.85).aspx) - 请参阅[**此线程中的示例**](http://social.msdn.microsoft.com/Forums/en-US/windowsuidevelopment/thread/967f4cba-bd2a-4f90-a8d2-9c335fa57936)
3.  [**然后在此处也**](http://social.msdn.microsoft.com/Forums/en-US/windowsuidevelopment/thread/967f4cba-bd2a-4f90-a8d2-9c335fa57936)将当前线程的桌面设置为窗口站的默认桌面[](http://social.msdn.microsoft.com/Forums/en-US/windowsuidevelopment/thread/967f4cba-bd2a-4f90-a8d2-9c335fa57936)
***   然后使用以下几种方法之一获取桌面的 DC，包括

    CreateDC(TEXT("DISPLAY"),NULL,NULL,NULL)

    祝你好运**

# firefox - 是否有相当于 sun-java6-plugin 的 Ubuntu 9.04 OpenJDK？

> ID：1002070
> 
> 赞同：3
> 
> 时间：2009-06-16T15:02:21.913
> 
> 标签：firefox, java, openjdk

我想知道是否存在用于 OpenJDK 的 firefox 插件的实现，或者如何让 firefox 将 OpenJDK 的 java 用于小程序。我无休止地搜索，似乎找不到任何好的资源。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T19:46:54.850

我认为您正在寻找**icedtea6-plugin**。

# python - 在cherrypy服务中处理sys.exit()

> ID：1002072
> 
> 赞同：2
> 
> 时间：2009-06-16T15:02:36.827
> 
> 标签：python, windows-services, cherrypy

当您启动/停止 python cherrypy 服务（使用 py2exe 编译）时，这工作正常当我`sys.exit()`接到电话（来自我的错误处理程序）时，cherrypy 退出，但服务仍然挂起。

代码：

```
import cherrypy
import win32serviceutil
import win32service
import sys

SERVICE = None

class HelloWorld:
    """ Sample request handler class. """

    def __init__(self):
        self.iVal = 0

    @cherrypy.expose
    def index(self):
        self.iVal += 1 
        if self.iVal == 5:
            StopService(SERVICE)
        return "Hello world! " + str(self.iVal) 

class MyService(win32serviceutil.ServiceFramework):
    """NT Service."""

    _svc_name_ = "CherryPyService"
    _svc_display_name_ = "CherryPy Service"
    _svc_description_ = "Some description for this service"

    def SvcDoRun(self):
        SERVICE = self
        StartService()

    def SvcStop(self):
        StopService(SERVICE)

def StartService():

    cherrypy.tree.mount(HelloWorld(), '/')

    cherrypy.config.update({
        'global':{
            'tools.log_tracebacks.on': True,
            'log.error_file': '\\Error_File.txt',
            'log.screen': True,
            'engine.autoreload.on': False,
            'engine.SIGHUP': None,
            'engine.SIGTERM': None
            }
        })

    cherrypy.engine.start()
    cherrypy.engine.block()

def StopService(classObject):
    classObject.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
    cherrypy.engine.exit()
    classObject.ReportServiceStatus(win32service.SERVICE_STOPPED)

if __name__ == '__main__':
    print sys.argv
    win32serviceutil.HandleCommandLine(MyService) 
```

任何建议都会很棒:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-03T22:55:49.797

我不完全确定`sys.exit`电话来自哪里或您的首选行为是什么。但是，当[`sys.exit`](http://docs.python.org/library/sys.html#sys.exit)被调用时，它会引发[`SystemExit`](http://docs.python.org/library/exceptions.html#exceptions.SystemExit)异常。你可以拦截它并继续你的方式：

```
import sys
try:
    sys.exit()
except SystemExit:
    print "Somebody called sys.exit()."
print "Still running." 
```

...或用于`finally`进行一些清理：

```
try:
    do_something()
finally:
    cleanup() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-21T10:36:01.510

建议[通过 http 停止cherrypy 服务器](https://stackoverflow.com/questions/2125175/stopping-a-cherrypy-server-over-http/2130438#2130438)`cherrypy.engine.exit()`而不是`sys.exit()`.

# javascript - 一个字符串数组作为 jQuery 选择器？

> ID：1002073
> 
> 赞同：33
> 
> 时间：2009-06-16T15:03:05.313
> 
> 标签：javascript, jquery

我有一个字符串数组，它们是有效的 jQuery 选择器（即页面上元素的 ID）：

```
["#p1", "#p2", "#p3", "#p4", "#p5"] 
```

我想将具有这些 ID 的元素选择到 jQuery 数组中。这可能是基本的，但我在网上找不到任何东西。我可以有一个 for 循环来创建一个字符串`"#p1,#p2,#p3,#p4,#p5"`，然后可以将其作为单个选择器传递给 jQuery，但是没有其他方法吗？没有办法将字符串数组作为选择器传递吗？

**编辑：**实际上，已经[有答案了](https://stackoverflow.com/questions/201724/easy-way-to-turn-javascript-array-into-comma-separated-list/201733)。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-06-16T15:06:37.083

好吧，有“加入”：

```
["#p1", "#p2", "#p3", "#p4", "#p5"].join(", ") 
```

编辑 - 额外信息：

可以选择一个元素数组，问题是这里你还没有元素，只有选择器字符串。无论您以何种方式对其进行切片，您都必须执行类似 .getElementById 的搜索或使用实际的 jQuery 选择。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-16T15:07:37.317

试试[Array.join 方法](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/join)：

```
var a = ["#p1", "#p2", "#p3", "#p4", "#p5"];
var s = a.join(", ");
//s should now be "#p1, #p2, #p3, ..."
$(s).whateverYouWant(); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-16T15:10:12.287

怎么样`$(foo.join(", "))`？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-16T15:08:20.340

使用 array.join 方法将它们连接在一起

```
$(theArray.join(',')); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-11T13:23:26.973

将正式回答您的问题：单行：

```
//If this is only one use variable you can use
$(['#p1','#p2','#p3','#p4','#p5'].join(',')).methodToUse();
//if you DO need it as a variable you can
var joined = ['#p1','#p2','#p3','#p4','#p5'].join(',');
$(joined).methodsToUse(); 
```

如果您希望他们单独做某事，还有 .each();

在下面的示例中，每个 p id 点击都会使其中任何一个变为红色：

```
var peas = ['#p1','#p2','#p3','#p4','#p5'];
$.each(peas, i => {
    $(peas[i]).click(() => {
        $(peas[i]).css({'color':'red'});
    });
}); 
```

当您将“i”放入函数参数时，它会适当地找到数组中的值。当您执行 '.each()' 时，格式如下所示：

```
$.each(array, function(i){
    // any code you wish as long as you have an array selector
    //$(array[i]).whatever function
}); 
```

一个更大的例子。假设你想让你点击的 P 变成红色，但想让其他 ps 恢复默认颜色。只需创建一个从数组中删除所选 ID 的函数，瞧！

```
var peas = ['#p1','#p2','#p3','#p4','#p5'],
    poppy=(v,i)=>peas.toString().replace(`,${v[i]}`,'').replace(`${v[i]},`,'');

(// get each pea index
  $.each(peas,i=>///funciton(i){ code inside}

    (//set up each individual index's functions
      $('.peastock').append(`<p id="p${[i+1]}">I am ${peas[i]}</p>`),
      $(peas[i]).click(()=>(
        $(peas[i]).css({"color":"red","background-color":"rgba(128,0,0,0.1)"}),
        $(poppy(peas,i)).css({'color':'black','background-color':'rgba(255,255,255,0.2)'}))))),

  $('.peastock').append(`
    <div id="ree">ES6 isnt suitable for all of jQuery's usage!</div>
    <div>Since some functions inside of jQuery's methods dont require 'this' or 'return'</div>
    <div>You can learn this by going <a href="https://www.w3schools.com/Js/js_es6.asp">here</a></div>
  `),
  $("*").css({"margin":"0 auto","padding":"1%"}),
  $("* .peastock, .peastock, .peastock *").css({"background-color":"rgba(128,0,0,0.1)"})
); 
```

我知道有人一定想知道每个值数组作为 jquery 选择器。希望一切顺利！

资料来源： [jQuery .each()](http://api.jquery.com/jQuery.each/ "jQuery .each()") [实际操作中的小提琴（有更新！）](https://jsfiddle.net/NitroXAce/t9ewpnj2/82/ "小提琴在行动（有更新！）")

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-16T15:08:37.000

我想你正在寻找[join](http://www.w3schools.com/jsref/jsref_join.asp)。

```
var arr = ["#p1", "#p2", "#p3", "#p4", "#p5"];
$(arr.join(",")) 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-04-30T15:33:00.560

更短：

```
["#p1", "#p2", "#p3", "#p4", "#p5"].toString() 
```

# ruby-on-rails - 覆盖ApplicationHelper？

> ID：1002080
> 
> 赞同：0
> 
> 时间：2009-06-16T15:04:03.453
> 
> 标签：ruby-on-rails, ruby

我们正在使用的引擎中有一个`ApplicationHelper`如下所示：

```
module ApplicationHelper
  def page_title()
    # ...
  end
end 
```

这被引擎中的许多视图调用。我想在我的应用程序中覆盖此方法以提供不同的默认标题。我该怎么做呢？简单地定义我自己的`ApplicationHelper`似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T20:32:14.057

您是否在模块中定义了 page_title 方法`ApplicationHelper`？仅仅拥有一个 ApplicationHelper 本身是行不通的。

默认情况下，您的`ApplicationHelper`模块应该已经在`app/helpers/application_helper.rb`. Rails 需要您正在使用的插件后才需要您的应用程序文件。这意味着您在 app/helpers/application_helper.rb 中定义的任何方法都应该覆盖插件代码中定义的方法。

这种行为源于 ruby​​ 的开放类结构。可以随时随地重新打开任何类/模块/对象以向其添加方法和属性。或多或少。

你能发布一些你试图覆盖引擎方法的代码吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T20:47:41.733

您的 ApplicationHelper 中定义的其他方法是否可用？

如果**是**，则引擎助手可能在您的 ApplicationHelper 之前加载，并且您的方法被覆盖。

如果**没有**，Rails 可能永远不会加载您的模块，因为它认为它已经知道 ApplicationHelper 并且不会尝试再次加载它。

# reporting-services - Reporting Services，自定义百分比格式

> ID：1002082
> 
> 赞同：0
> 
> 时间：2009-06-16T15:04:15.293
> 
> 标签：reporting-services, formatting

我有一些我目前用 P0 填充的字段。结果是这样的：

```
2,434% 
```

但是我想要这样的东西：

```
2434% 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T03:58:26.737

你试过像0000%这样的东西吗？或者，像这样的表达式：

```
=right(format(Fields!YourField.Value,"#%"),5). 
```

我现在没有打开 BI 工作室，所以我无法测试这些。该表达式当然会将值转换为文本，这在您将报表导出到 Excel 时可能会出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:26:56.783

```
 ####% 
```

注意：不幸的是，这不会锁定到最多 4 个字符（就像我期望/想要的那样），但它已经足够接近了。

# android - Android WebView：处理方向变化

> ID：1002085
> 
> 赞同：148
> 
> 时间：2009-06-16T15:05:17.210
> 
> 标签：android, webview, orientation

问题是轮换后的性能。WebView 必须重新加载页面，这可能有点乏味。

在不每次都从源重新加载页面的情况下处理方向更改的最佳方法是什么？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2010-02-11T18:10:08.187

如果您不希望 WebView 在方向更改时重新加载，只需在 Activity 类中覆盖 onConfigurationChanged ：

```
@Override
public void onConfigurationChanged(Configuration newConfig){        
    super.onConfigurationChanged(newConfig);
} 
```

并在清单中设置 android:configChanges 属性：

```
<activity android:name="..."
          android:label="@string/appName"
          android:configChanges="orientation|screenSize" 
```

有关更多信息，请参阅：http:
[//developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange](http://developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange)

[https://developer.android.com/reference/android/app/Activity.html#ConfigurationChanges](https://developer.android.com/reference/android/app/Activity.html#ConfigurationChanges)

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2010-04-23T18:03:28.227

编辑：此方法不再像[文档中所述的那样工作](http://developer.android.com/reference/android/webkit/WebView.html#saveState(android.os.Bundle))

* * *

原答案：

这可以通过覆盖`onSaveInstanceState(Bundle outState)`您的活动并从网络视图调用来处理`saveState`：

```
 protected void onSaveInstanceState(Bundle outState) {
      webView.saveState(outState);
   } 
```

然后在 webview 重新膨胀之后在你的 onCreate 中恢复它：

```
public void onCreate(final Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   setContentView(R.layout.blah);
   if (savedInstanceState != null)
      ((WebView)findViewById(R.id.webview)).restoreState(savedInstanceState);
} 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-07-04T12:27:55.257

对此的最佳答案是遵循[此处](http://developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange)找到的 Android 文档 基本上这将阻止 Webview 重新加载：

```
<activity android:name=".MyActivity"
      android:configChanges="keyboardHidden|orientation|screenSize|layoutDirection|uiMode"
      android:label="@string/app_name"> 
```

编辑（1/4/2020）：您不需要此可选代码，清单属性就是您所需要的，将可选代码留在这里以保持答案完整。

**或者**，您可以通过覆盖活动来修复异常（如果有）`onConfigurationChanged`：

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);

    // Checks the orientation of the screen
    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        Toast.makeText(this, "landscape", Toast.LENGTH_SHORT).show();
    } else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
        Toast.makeText(this, "portrait", Toast.LENGTH_SHORT).show();
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-14T20:42:51.867

我试过使用**onRetainNonConfigurationInstance**（返回*WebView*），然后在**onCreate**期间用**getLastNonConfigurationInstance**取回它并重新分配它。

 **似乎还没有工作。我不禁认为我真的很亲近！到目前为止，我只是得到一个空白/白色背景的*WebView*。在这里发帖希望有人可以帮助将这个推过终点线。

也许我不应该通过*WebView*。也许是*WebView*中的一个对象？

我尝试的另一种方法 - 不是我最喜欢的 - 是在活动中设置它：

```
 android:configChanges="keyboardHidden|orientation" 
```

...然后在这里几乎什么都不做：

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
  super.onConfigurationChanged(newConfig);
  // We do nothing here. We're only handling this to keep orientation
  // or keyboard hiding from causing the WebView activity to restart.
} 
```

这行得通，但它可能不被视为[最佳实践](http://www.androidguys.com/2008/11/11/rotational-forces-part-three/#IDComment31451819)。

同时，我还有一个*ImageView*我想根据旋转自动更新。事实证明这很容易。在我的`res`文件夹下，我拥有`drawable-land`并`drawable-port`保存横向/纵向变化，然后我使用`R.drawable.myimagename`ImageView*的*源代码和 Android“做正确的事” - 耶！

...除非您注意配置更改，否则不会。:(

所以我很矛盾。使用**onRetainNonConfigurationInstance**和*ImageView*旋转工作，但*WebView*持久性不...或使用**onConfigurationChanged**和*WebView*保持稳定，但*ImageView*不更新。该怎么办？

最后一点：就我而言，强制定向不是可接受的折衷方案。我们真的很想优雅地支持轮换。有点像 Android 浏览器应用程序的功能！;)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-11-15T01:45:05.067

我很感激这有点晚了，但是这是我在开发解决方案时使用的答案：

AndroidManifest.xml

```
 <activity
        android:name=".WebClient"
        android:configChanges="keyboard|keyboardHidden|orientation|screenSize" <--- "screenSize" important
        android:label="@string/title_activity_web_client" >
    </activity> 
```

WebClient.java

```
public class WebClient extends Activity {

    protected FrameLayout webViewPlaceholder;
    protected WebView webView;

    private String WEBCLIENT_URL;
    private String WEBCLIENT_TITLE;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_web_client);
        initUI();
    }

    @SuppressLint("SetJavaScriptEnabled")
    protected void initUI(){
        // Retrieve UI elements
        webViewPlaceholder = ((FrameLayout)findViewById(R.id.webViewPlaceholder));

        // Initialize the WebView if necessary
        if (webView == null)
        {
            // Create the webview
            webView = new WebView(this);
            webView.setLayoutParams(new ViewGroup.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.FILL_PARENT));
            webView.getSettings().setSupportZoom(true);
            webView.getSettings().setBuiltInZoomControls(true);
            webView.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);
            webView.setScrollbarFadingEnabled(true);
            webView.getSettings().setJavaScriptEnabled(true);
            webView.getSettings().setPluginState(android.webkit.WebSettings.PluginState.ON);
            webView.getSettings().setLoadsImagesAutomatically(true);

            // Load the URLs inside the WebView, not in the external web browser
            webView.setWebViewClient(new SetWebClient());
            webView.setWebChromeClient(new WebChromeClient());

            // Load a page
            webView.loadUrl(WEBCLIENT_URL);
        }

        // Attach the WebView to its placeholder
        webViewPlaceholder.addView(webView);
    }

    private class SetWebClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.web_client, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        int id = item.getItemId();
        if (id == R.id.action_settings) {
            return true;
        }else if(id == android.R.id.home){
            finish();
            return true;
        }

        return super.onOptionsItemSelected(item);
    }

    @Override
    public void onBackPressed() {
        if (webView.canGoBack()) {
            webView.goBack();
            return;
        }

        // Otherwise defer to system default behavior.
        super.onBackPressed();
    }

    @Override
    public void onConfigurationChanged(Configuration newConfig){
        if (webView != null){
            // Remove the WebView from the old placeholder
            webViewPlaceholder.removeView(webView);
        }

        super.onConfigurationChanged(newConfig);

        // Load the layout resource for the new configuration
        setContentView(R.layout.activity_web_client);

        // Reinitialize the UI
        initUI();
    }

    @Override
    protected void onSaveInstanceState(Bundle outState){
        super.onSaveInstanceState(outState);

        // Save the state of the WebView
        webView.saveState(outState);
    }

    @Override
    protected void onRestoreInstanceState(Bundle savedInstanceState){
        super.onRestoreInstanceState(savedInstanceState);

        // Restore the state of the WebView
        webView.restoreState(savedInstanceState);
    }

} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-05-05T11:19:20.250

处理方向更改和防止 WebView 在旋转时重新加载的最佳方法。

```
@Override
public void onConfigurationChanged(Configuration newConfig){
super.onConfigurationChanged(newConfig);
} 
```

考虑到这一点，为了防止每次更改方向时都调用 onCreate() ，您必须添加`android:configChanges="orientation|screenSize" to the AndroidManifest.`

要不就 ..

```
android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize"` 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-11-11T02:58:50.693

一种折衷方案是避免轮换。添加此项以仅修复纵向方向的活动。

```
android:screenOrientation="portrait" 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-01-16T15:59:43.157

只需在您的清单文件中编写以下代码行 - 仅此而已。真的行：

```
<activity android:name=".YourActivity"
  android:configChanges="orientation|screenSize"
  android:label="@string/application_name"> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-11-28T23:20:57.157

您可以尝试在您的 Activity 上使用`onSaveInstanceState()`和`onRestoreInstanceState()`来调用您`saveState(...)`的`restoreState(...)`WebView 实例。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-09-15T13:32:59.027

现在是 2015 年，许多人正在寻找一种仍然适用于 Jellybean、KK 和 Lollipop 手机的解决方案。经过*一番*挣扎后，我找到了一种在更改方向后保持 webview 完好无损的方法。我的策略基本上是将 webview 存储在另一个类的单独静态变量中。然后，如果发生旋转，我将 webview 从 Activity 中分离出来，等待方向完成，然后将 webview 重新附加到 Activity。例如......首先把它放在你的清单上（keyboardHidden 和键盘是可选的）：

```
<application
        android:label="@string/app_name"
        android:theme="@style/AppTheme"
        android:name="com.myapp.abc.app">

    <activity
            android:name=".myRotatingActivity"
            android:configChanges="keyboard|keyboardHidden|orientation">
    </activity> 
```

在单独的应用程序类中，输入：

```
 public class app extends Application {
            public static WebView webview;
            public static FrameLayout webviewPlaceholder;//will hold the webview

         @Override
               public void onCreate() {
                   super.onCreate();
    //dont forget to put this on the manifest in order for this onCreate method to fire when the app starts: android:name="com.myapp.abc.app"
                   setFirstLaunch("true");
           }

       public static String isFirstLaunch(Context appContext, String s) {
           try {
          SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(appContext);
          return prefs.getString("booting", "false");
          }catch (Exception e) {
             return "false";
          }
        }

    public static void setFirstLaunch(Context aContext,String s) {
       SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(aContext);
            SharedPreferences.Editor editor = prefs.edit();
            editor.putString("booting", s);
            editor.commit();
           }
        } 
```

在活动中放：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        if(app.isFirstLaunch.equals("true"))) {
            app.setFirstLaunch("false");
            app.webview = new WebView(thisActivity);
            initWebUI("www.mypage.url");
        }
}
@Override
    public  void onRestoreInstanceState(Bundle savedInstanceState) {
        restoreWebview();
    }

public void restoreWebview(){
        app.webviewPlaceholder = (FrameLayout)thisActivity.findViewById(R.id.webviewplaceholder);
        if(app.webviewPlaceholder.getParent()!=null&&((ViewGroup)app.webview.getParent())!=null) {
            ((ViewGroup) app.webview.getParent()).removeView(app.webview);
        }
        RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.FILL_PARENT, RelativeLayout.LayoutParams.FILL_PARENT);
        app.webview.setLayoutParams(params);
        app.webviewPlaceholder.addView(app.webview);
        app.needToRestoreWebview=false;
    }

protected static void initWebUI(String url){
        if(app.webviewPlaceholder==null);
          app.webviewPlaceholder = (FrameLayout)thisActivity.findViewById(R.id.webviewplaceholder);
        app.webview.getSettings().setJavaScriptEnabled(true);       app.webview.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);
        app.webview.setLayoutParams(new ViewGroup.LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, ViewGroup.LayoutParams.FILL_PARENT));
        app.webview.getSettings().setSupportZoom(false);
        app.webview.getSettings().setBuiltInZoomControls(true);
        app.webview.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);
        app.webview.setScrollbarFadingEnabled(true);
        app.webview.getSettings().setLoadsImagesAutomatically(true);
        app.webview.loadUrl(url);
        app.webview.setWebViewClient(new WebViewClient());
        if((app.webview.getParent()!=null)){//&&(app.getBooting(thisActivity).equals("true"))) {
            ((ViewGroup) app.webview.getParent()).removeView(app.webview);
        }
        app.webviewPlaceholder.addView(app.webview);
    } 
```

最后，简单的 XML：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".myRotatingActivity">
    <FrameLayout
        android:id="@+id/webviewplaceholder"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        />
</RelativeLayout> 
```

在我的解决方案中有几件事可以改进，但我已经花了很多时间，例如：一种更短的方法来验证 Activity 是否是第一次启动，而不是使用 SharedPreferences 存储。这种方法可以使您的 webview 保持完整（afaik），它的文本框、标签、UI、javascript 变量和导航状态不会被 url 反映。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-09-26T19:44:32.627

更新：当前的策略是将 WebView 实例移动到 Application 类，而不是像 Josh 那样在分离和重新附加到恢复时保留片段。为了防止应用程序关闭，您应该使用前台服务，如果您想在用户在应用程序之间切换时保留状态。

~~如果您正在使用片段，则可以使用 WebView 的保留实例。Web 视图将保留为该类的实例成员。但是，您应该在 OnCreateView 中附加 Web 视图并在 OnDestroyView 之前分离，以防止它被父容器破坏。~~

 ~~```
class MyFragment extends Fragment{  

    public MyFragment(){  setRetainInstance(true); }

    private WebView webView;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
       View v = ....
       LinearLayout ll = (LinearLayout)v.findViewById(...);
       if (webView == null) {
            webView = new WebView(getActivity().getApplicationContext()); 
       }
       ll.removeAllViews();
       ll.addView(webView, new LinearLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT));

       return v;
    }

    @Override
    public void onDestroyView() {
        if (getRetainInstance() && webView.getParent() instanceof ViewGroup) {
           ((ViewGroup) webView.getParent()).removeView(webView);
        }
        super.onDestroyView();
    } 
} 
```~~ 

~~PS Credits go to [kcoppock answer](https://stackoverflow.com/a/24985760/241986)~~

至于 'SaveState()' 它不再根据[官方文档](http://developer.android.com/reference/android/webkit/WebView.html#saveState%28android.os.Bundle%29)工作：

> 请注意，此方法不再存储此 WebView 的显示数据。如果从不调用 restoreState(Bundle)，则先前的行为可能会泄漏文件。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-01-08T18:35:27.397

您唯一应该做的就是将此代码添加到清单文件中：

```
<activity android:name=".YourActivity"
      android:configChanges="orientation|screenSize"
      android:label="@string/application_name"> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-07-12T16:00:48.167

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);    
}

@Override
protected void onRestoreInstanceState(Bundle state) {
    super.onRestoreInstanceState(state);    
} 
```

这些方法可以在任何活动上被覆盖，它基本上允许您在每次创建/销毁活动时保存和恢复值，当屏幕方向更改时，活动被销毁并在后台重新创建，因此您可以使用这些方法在更改期间临时存储/恢复状态。

您应该更深入地研究以下两种方法，看看它是否适合您的解决方案。

[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-11-19T15:37:46.903

这是唯一对我有用的东西（我什至使用了保存实例状态，`onCreateView`但它并不可靠）。

```
public class WebViewFragment extends Fragment
{
    private enum WebViewStateHolder
    {
        INSTANCE;

        private Bundle bundle;

        public void saveWebViewState(WebView webView)
        {
            bundle = new Bundle();
            webView.saveState(bundle);
        }

        public Bundle getBundle()
        {
            return bundle;
        }
    }

    @Override
    public void onPause()
    {
        WebViewStateHolder.INSTANCE.saveWebViewState(myWebView);
        super.onPause();
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState)
    {
        View rootView = inflater.inflate(R.layout.fragment_main, container, false); 
        ButterKnife.inject(this, rootView);
        if(WebViewStateHolder.INSTANCE.getBundle() == null)
        {
            StringBuilder stringBuilder = new StringBuilder();
            BufferedReader br = null;
            try
            {
                br = new BufferedReader(new InputStreamReader(getActivity().getAssets().open("start.html")));

                String line = null;
                while((line = br.readLine()) != null)
                {
                    stringBuilder.append(line);
                }
            }
            catch(IOException e)
            {
                Log.d(getClass().getName(), "Failed reading HTML.", e);
            }
            finally
            {
                if(br != null)
                {
                    try
                    {
                        br.close();
                    }
                    catch(IOException e)
                    {
                        Log.d(getClass().getName(), "Kappa", e);
                    }
                }
            }
            myWebView
                .loadDataWithBaseURL("file:///android_asset/", stringBuilder.toString(), "text/html", "utf-8", null);
        }
        else
        {
            myWebView.restoreState(WebViewStateHolder.INSTANCE.getBundle());
        }
        return rootView;
    }
} 
```

我为 WebView 的状态制作了一个单例持有者。只要应用程序的进程存在，状态就会被保留。

编辑：这`loadDataWithBaseURL`不是必需的，它与just一样好用

```
 //in onCreate() for Activity, or in onCreateView() for Fragment

    if(WebViewStateHolder.INSTANCE.getBundle() == null) {
        webView.loadUrl("file:///android_asset/html/merged.html");
    } else {
        webView.restoreState(WebViewStateHolder.INSTANCE.getBundle());
    } 
```

虽然我读到这不一定适用于 cookie。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-05-06T04:33:17.840

我发现在不泄漏先前`Activity`参考且不设置`configChanges`.. 的情况下执行此操作的最佳解决方案是使用[MutableContextWrapper](http://developer.android.com/reference/android/content/MutableContextWrapper.html)。

我在这里实现了这个：[https ://github.com/slightfoot/android-web-wrapper/blob/48cb3c48c457d889fc16b4e3eba1c9e925f42cfb/WebWrapper/src/com/example/webwrapper/BrowserActivity.java](https://github.com/slightfoot/android-web-wrapper/blob/48cb3c48c457d889fc16b4e3eba1c9e925f42cfb/WebWrapper/src/com/example/webwrapper/BrowserActivity.java)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-01-09T20:01:51.750

尝试这个

```
import android.os.Bundle;
import android.support.v7.app.AppCompatActivity;
import android.view.View;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MainActivity extends AppCompatActivity {

    private WebView wv;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        wv = (WebView) findViewById(R.id.webView);
        String url = "https://www.google.ps/";

        if (savedInstanceState != null)
            wv.restoreState(savedInstanceState);
        else {
            wv.setWebViewClient(new MyBrowser());
            wv.getSettings().setLoadsImagesAutomatically(true);
            wv.getSettings().setJavaScriptEnabled(true);
            wv.setScrollBarStyle(View.SCROLLBARS_INSIDE_OVERLAY);
            wv.loadUrl(url);
        }
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        wv.saveState(outState);
    }

    @Override
    public void onBackPressed() {
        if (wv.canGoBack())
            wv.goBack();
        else
            super.onBackPressed();
    }

    private class MyBrowser extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    }

} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-10-12T06:53:03.597

此页面解决了我的问题，但我必须在最初的页面中稍作更改：

```
 protected void onSaveInstanceState(Bundle outState) {
       webView.saveState(outState);
       } 
```

这部分对我来说有一个小问题。在第二个方向更改应用程序以空指针终止

使用它对我有用：

```
 @Override
protected void onSaveInstanceState(Bundle outState ){
    ((WebView) findViewById(R.id.webview)).saveState(outState);
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-01-31T11:26:58.320

你应该试试这个：

1.  创建一个服务，在该服务内部，创建您的 WebView。
2.  从您的活动启动服务并绑定到它。
3.  在`onServiceConnected`方法中，获取 WebView 并调用该`setContentView`方法来呈现您的 WebView。

我对其进行了测试，它可以工作，但不能与 XWalkView 或 GeckoView 等其他 WebView 一起使用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-11-17T04:46:55.007

```
@Override
    protected void onSaveInstanceState(Bundle outState )
    {
        super.onSaveInstanceState(outState);
        webView.saveState(outState);
    }

    @Override
    protected void onRestoreInstanceState(Bundle savedInstanceState)
    {
        super.onRestoreInstanceState(savedInstanceState);
        webView.restoreState(savedInstanceState);
    } 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2014-07-19T16:31:28.027

我喜欢这个解决方案[http://www.devahead.com/blog/2012/01/preserving-the-state-of-an-android-webview-on-screen-orientation-change/](http://www.devahead.com/blog/2012/01/preserving-the-state-of-an-android-webview-on-screen-orientation-change/)

根据它，我们重用了相同的 WebView 实例。它允许在配置更改时保存导航历史记录和滚动位置。**

# sql-server - 关于如何在十亿行表上扩展和改进“基于枢轴的查询”的执行时间的建议，每天增加一百万

> ID：1002086
> 
> 赞同：2
> 
> 时间：2009-06-16T15:05:26.680
> 
> 标签：sql-server, database, cloud, scaling

我们公司正在开发一个内部项目来解析文本文件。这些文本文件由使用常规表达式提取的元数据组成。十台计算机 24/7 全天候解析文本文件，并为高端 Intel Xeon SQL Server 2005 数据库提供提取的元数据。

简化的数据库模式如下所示：

```
项目

| 身份证 | 姓名 |
|----|--------|
| 1 | 样品 |

```

```
Items_Attributes

| 项目 ID | 属性 ID |
|--------|-------------|
| 1 | 1 |
| 1 | 2 |

```

```
属性

| 身份证 | 属性类型 ID | 价值 |
|----|-----------------|--------|
| 1 | 1 | 500MB |
| 2 | 2 | 1.0.0 |

```

```
属性类型

| 身份证 | 姓名 |
|----|---------|
| 1 | 尺寸 |
| 2 | 版本 |

```

有许多不同的文本文件类型，里面有不同的元数据。对于每个文本文件，我们都有一个`Item`，对于每个提取的元数据值，我们都有一个`Attribute`.``

 ```Items_Attributes` allow us to avoid duplicate `Attribute` values which avoids database size to increase x^10.

This particular schema allows us to dynamically add new regular expressions and to obtain new metadata from new processed files no matter which internal structure they have.

Additionally this allow us to filter the data and to obtain dynamic reports based on the user criteria. We are filtering by `Attribute` and then pivoting the resultset ([http://msdn.microsoft.com/en-us/library/ms177410.aspx](http://msdn.microsoft.com/en-us/library/ms177410.aspx)). So this example pseudo-sql query` 

```
SELECT FROM Items WHERE Size = @A AND Version = @B 
```

would return a pivoted table like this

```
| ItemName | Size  | Version |
|----------|-------|---------|
| Sample   | 500mB | 1.0.0   |

```` 

`The application has been running for months and performance decreased terribly at the point is no longer usable. Reports should take no more than 2 seconds and Items_Attributes`table 每周平均增加 10,000,000 行。一切都已正确索引，我们花费了大量时间分析和优化查询执行计划。

所以我的问题是，您将如何扩展它以减少报告执行时间？

我们提出了这个可能的解决方案：

*   购买更多硬件并设置 SQL Server 集群。（我们需要关于正确的“集群”策略的建议）
*   使用像 HBase 这样的键/值数据库（我们真的不知道是否能解决我们的问题）
*   使用 ODBMS 而不是 RDBMS（我们一直在考虑 db4o）
*   将我们的软件迁移到云端（我们的经验为零）
*   在运行时静态生成报告。（我们真的不想）
*   常见报表的静态索引视图（性能几乎相同）
*   非规范化架构（我们的一些报告在单个查询中涉及多达 50 个表）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T16:26:44.693

大量使用此类模式。他们从来没有表现好。最好的办法是根据需要存储数据，格式为：

| 物品名称 | 尺寸 | 版本 | |---------|--------|---------| | 样品 | 500MB | 1.0.0 |

然后你不需要转动。顺便说一句，请不要将您的原始 EAV 模式称为“规范化”——它没有被规范化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:14:08.550

我将从发布准确的表元数据（以及索引详细信息）、准确的查询文本和执行计划开始。

使用您当前的表格布局，查询类似于以下内容：

```
SELECT FROM Items WHERE Size = @A AND Version = @B 
```

不能从使用复合索引中受益`(Size, Version)`，因为不可能建立这样的索引。

你甚至不能建立一个索引视图，因为它会包含一个自连接`attributes`。

可能最好的决定是像这样对表进行非规范化：

```
id 名称 大小 版本

```

并创建一个索引`(size, version)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T15:15:00.203

SQL Server CAT 团队关于实体-属性-值数据库模型陷阱的这份白皮书或许可以提供帮助：[http ://sqlcat.com/whitepapers/archive/2008/09/03/best-practices-for-semantic-data -modeling-for-performance-and-scalability.aspx](http://sqlcat.com/whitepapers/archive/2008/09/03/best-practices-for-semantic-data-modeling-for-performance-and-scalability.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T15:24:14.163

在我看来，就像在为 OLTP 事务优化的数据库上发出一些 OLAP 查询一样。不知道细节，我建议为您正在执行的查询类型构建一个单独的“数据仓库”。这将涉及聚合数据（如果可能）、非规范化以及拥有 1 天左右的数据库。您将每天或按您希望的任何时间间隔增量更新数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T15:28:07.820

请发布准确的 DDL 和索引，如果您在 ID 列上有索引，那么您的查询将导致扫描

而不是这样的

```
SELECT FROM Items WHERE Size = @A AND Version = @B 
```

你需要这样做

```
SELECT FROM Items WHERE ID = 1 
```

换句话说，您需要获取文本值，找到要索引的 id，然后将其用作查询来返回结果

查看分区功能以分配数据可能也是一个好主意

集群是为了可用性而不是性能而完成的，如果一个节点（主动集群）死亡，另一个节点（被动集群）将变得活跃......当然也有主动主动集群，但那是另一回事

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T07:39:29.087

您在单个查询中提到了 50 个表。虽然 SQL Server 在单个整体查询中支持多达 256 个表，但采用这种方法会降低优化器生成有效计划的机会。

如果您对目前的模式很感兴趣，请考虑将您的报告查询分解为一系列步骤，将其结果具体化为临时 (#) 表。这种方法使您能够单独执行查询中最具选择性的部分，并且根据我的经验，可以提供很大的性能提升。查询通常也更易于维护。

另外（这个有点长镜头）你没有说你使用的是哪个 SQL Server 版本。但如果您使用的是 SQL 2005，鉴于报告中涉及的表数量和数据量，值得检查您的 SQL 服务器是否已至少修补到 SP2。

我在一个 ETL 项目中使用具有数亿行数的表，我们发现 SQL 2005 RTM/SP1 中的查询优化器无法始终如一地为连接超过 5 个表的查询生成有效计划，其中一个或多个表是这个规模的。此问题已在 SP2 中得到解决。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T15:20:22.533

短期修复可能是使用[水平分区](http://www.databasejournal.com/features/mssql/article.php/3456991/SQL-Server-2005-Part-5---High-Availability-and-Scalability-Enhancements.htm)。我假设你最大的桌子是`Items_Attributes`. 您可以对该表进行水平分区，将每个分区放在单独磁盘控制器上的单独文件组中。

这是假设您没有尝试同时报告所有`ItemId`s。

# php - 获取文件编码

> ID：1002089
> 
> 赞同：4
> 
> 时间：2009-06-16T15:05:32.373
> 
> 标签：php, encoding, utf-8

> **可能重复：**
> [检测 PHP 中的文件编码](https://stackoverflow.com/questions/505562/detect-file-encoding-in-php)

我怎样才能用 PHP 找出一个文件有什么文件编码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T15:18:50.257

检测编码对于所有 8 位字符集来说真的很困难，但 utf-8 （因为不是每个 8 位字节序列都是有效的 utf-8），并且通常需要对要检测编码的文本的语义知识。

想一想：任何特定的纯文本信息都只是一堆没有相关编码信息的字节。如果您查看任何特定字节，它可能意味着*任何东西*，因此为了有机会检测编码，您必须在其他字节的上下文中查看该字节，并根据可能的*语言*组合尝试一些启发式方法。

但是，对于 8 位字符集，您永远无法确定。

例如，启发式方法出错的演示如下：

[http://www.hoax-slayer.com/bush-hid-the-facts-notepad.html](http://www.hoax-slayer.com/bush-hid-the-facts-notepad.html)

一些 16 位的集合，您有机会检测到，因为它们可能包含字节顺序标记或每隔一个字节设置为 0。

如果您只想检测 UTF-8，可以使用 mb_detect_encoding （如前所述），也可以使用这个方便的小函数：

```
function isUTF8($string){
    return preg_match('%(?:
    [\xC2-\xDF][\x80-\xBF]        # non-overlong 2-byte
    |\xE0[\xA0-\xBF][\x80-\xBF]               # excluding overlongs
    |[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}      # straight 3-byte
    |\xED[\x80-\x9F][\x80-\xBF]               # excluding surrogates
    |\xF0[\x90-\xBF][\x80-\xBF]{2}    # planes 1-3
    |[\xF1-\xF3][\x80-\xBF]{3}                  # planes 4-15
    |\xF4[\x80-\x8F][\x80-\xBF]{2}    # plane 16
    )+%xs', $string);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:10:48.963

mb_detect_encoding 应该能够完成这项工作。

[http://us.php.net/manual/en/function.mb-detect-encoding.php](http://us.php.net/manual/en/function.mb-detect-encoding.php)

在它的默认设置中，它只会检测 ASCII、UTF-8 和一些日本 JIS 变体。如果您手动指定它们，它可以配置为检测更多编码。如果文件既是 ASCII 又是 UTF-8，它将返回 UTF-8。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:11:15.343

你真的不能，除非文件好心地告诉你它里面的某个地方。

例如，HTML 文件的目的是在顶部附近包含一个内容类型元标记，以便您的网络浏览器知道使用什么编码.. 例如

```
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /> 
```

或者

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

有一些方法可以通过查看文件并发现暗示某些编码的字节序列来尝试猜测，但这些实际上只是猜测。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:16:50.667

您可以使用 fread() 函数查看文件的前几个字节中的“[幻数](http://en.wikipedia.org/wiki/Magic_number_(programming)#Examples)”，然后将该幻数映射到文件类型的已知幻数列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:19:35.670

BlackAura 的建议非常好，恕我直言。

另一种选择是使用 system() 等在相关文件上调用[文件(1)。](http://docs.oracle.com/cd/E23824_01/html/821-1461/file-1.html#scrolltoc)通常，它也能够告诉您编码。它应该在任何健全的 UNIX 环境中都可用。

# .net - 使 .NET 2.0 Windows 窗体应用程序向后兼容 .NET 1.1

> ID：1002090
> 
> 赞同：0
> 
> 时间：2009-06-16T15:05:39.067
> 
> 标签：.net, winforms, .net-1.1

我使用 Visual C# 2008 Express Edition 创建了一个 Windows 窗体应用程序，目标为 .NET 2.0。现在我需要为 .NET 1.1 构建这个项目。我面临的问题是.NET 1.1 不支持设计器类。它们使用 .NET 1.1 中不支持的 partial 关键字。我需要遵循哪些步骤才能使我的项目向后兼容 .NET 1.1？我想保留我的 .NET 2.0 项目，以便我可以使用设计器进行编辑，但在构建期间想转换为 1.1。

请让我知道最简单的方法是什么。

问候，贾格纳特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T15:08:27.453

部分类只是将您的代码与设计器生成的代码分开。因此，为了使表单 1.1 兼容，您必须将部分类中的代码复制到包含设计器生成代码的类中，使其成为单个类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:12:44.543

您可能需要更改许多其他内容以及部分类，但这是一个很好的起点。1.1 和 2.0 之间有很多差异。如果您的 Winform 相对简单，您可能不需要进行太多其他更改。如果您使用了 1.1 中没有的组件和基类，您最终可能会发现您的工作更容易从头开始重新编程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:19:51.130

为什么需要为 .NET 1.1*构建它？*为什么不在 .NET 1.1 系统上安装 .NET Framework 2.0 并运行 .NET 2.0 版本？

您和您的客户是否真正意识到 .NET 1.1 的历史？它随 Visual Studio **2003**一起提供。Visual Studio 2010 测试版刚刚发布。2003-2010=计算机行业的一段很长的时间。

当安装在同一系统上时，这两个框架运行良好。我唯一要注意的是任何.NET 1.1 系统是否正在运行ASP.NET。如果是这样，那么在安装 .NET 2.0 之后，您需要在所有 .NET 1.1 Web 应用程序上运行 .NET 1.1 版本的 aspnet_regiis。.NET 2.0 安装将脚本映射升级到 2.0，这并不适用于所有 Web 应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:25:32.083

基本上，您正在执行从 1.1 到 2.0 的反向移植，因此[Microsoft .NET Framework 1.1 和 2.0 兼容性](http://msdn.microsoft.com/en-us/library/ms994381.aspx)应该会派上用场。

# emacs - 如何强制 Emacs 不在特定窗口中显示缓冲区？

> ID：1002091
> 
> 赞同：18
> 
> 时间：2009-06-16T15:05:43.933
> 
> 标签：emacs, lisp, elisp, advising-functions

我的 Windows 配置如下所示：

```
 +----------+-----------+
      |          |           |
      |          |           |
      |          |           |
      |          |           |
      |          |           |
      |          +-----------+
      |          |           |
      +----------+-----------+ 
```

我将右下角的窗口用于特殊显示（如帮助、完成等），但当我调用使用的命令（`find-file-other-window`等）时，emacs 坚持使用该窗口`display-buffer`，并调整该窗口的大小。这很烦人......有没有办法让emacs不使用那个窗口？我正在考虑提供建议`display-buffer`，但它是 c 中的一个函数。对此有什么想法吗？

*编辑：*

很大程度上基于 Trey 的回答，到目前为止，这对我有用：

```
(setq special-display-function 'my-display-buffer)
(setq special-display-regexps '(".*"))

(defun display-special-buffer (buf)
  "put the special buffers in the right spot (bottom rigt)"
    (let ((target-window (window-at (- (frame-width) 4) (- (frame-height) 4)))
          (pop-up-windows t))
      (set-window-buffer target-window buf)
      target-window))

(defun my-display-buffer (buf)
  "put all buffers in a window other than the one in the bottom right"
  (message (buffer-name  buf))
  (if (member (buffer-name buf) special-display-buffer-names)
      (display-special-buffer buf)
      (progn
        (let ((pop-up-windows t)
              (windows (delete (window-at (- (frame-width) 4) (- (frame-height) 4))
                         (delete (minibuffer-window) (window-list)))))
          (message (buffer-name (window-buffer (car windows))))
          (set-window-buffer (car (cdr windows)) buf)
          (car (cdr windows)))))) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-16T15:16:20.793

好吧，有人已经问过[同样的问题了](https://stackoverflow.com/questions/900372/in-emacs-how-do-i-change-the-minibuffer-completion-list-window)。我写了一个似乎效果很好的[答案。](https://stackoverflow.com/questions/900372/in-emacs-how-do-i-change-the-minibuffer-completion-list-window/900440#900440)

看起来您可以使用相同的解决方案，除了添加 to 之外`special-display-buffer-names`，您可以使用变量`special-display-regexps`。所以类似于：

```
(add-to-list 'special-display-regexps '(".*" my-display-buffers))

(defun my-display-buffers (buf)
  "put all buffers in a window other than the one in the bottom right"
  (let ((windows (delete (window-at (- (frame-width) 2) (- (frame-height) 4))
                         (delete (minibuffer-window) (window-list))))
    (if (<= 2 (length windows))
        (progn 
          (select-window (cadr windows))
          (split-window-vertically)))
    (let ((pop-up-windows t))
      (set-window-buffer (car windows) buf)
      (car windows))))) 
```

显然，您必须修改正则表达式，使其与`*Help*`右下方窗口中实际需要的缓冲区和其他缓冲区不匹配。

关于建议`display-buffer`，那会起作用。您可以建议用 c 编写的函数，建议几乎适用于您想要的所有情况，除非从 c*调用*函数或建议宏（这不起作用 b/c 宏通常已经在使用它们的任何地方展开）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T16:35:21.177

也许这样的事情可以工作：

```
(defun display-buffer-avoiding-lr-corner (buffer &optional not-this-window)
  (save-selected-window
    (when (buffer-file-name buffer)
      (select-window (window-at (- (frame-width) 1)
                                (- (frame-height) 2))))
    (let ((display-buffer-function nil))
      (display-buffer buffer not-this-window))))

(setq display-buffer-function 'display-buffer-avoiding-lr-corner) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T21:58:30.700

> 我正在考虑建议显示缓冲区，但它是 c 中的一个函数。

```
"display-buffer is an interactive Lisp function in `window.el'." 
```

此外，无论如何，您都可以建议 C 函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T15:19:43.733

也许让这个右下角的窗口专门由`set-window-dedicated-p`. 然后这个窗口将在`find-file-other-window`你想要的操作中被忽略。

# asp.net - WMV 文件的 HttpHandler

> ID：1002092
> 
> 赞同：1
> 
> 时间：2009-06-16T15:05:45.043
> 
> 标签：asp.net

我为 WMV 文件创建了一个 HttpHandler。我也在 web.config 中注册了它。但由于某种原因，它永远不会触发。让我解释一下场景：

我已经使用锚标签链接到网站上的视频。当您单击链接时，wmv 文件将在 windows 媒体播放器中运行。现在，我希望媒体播放器应该在页面上而不是链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:13:30.970

如果您使用的是 IIS（Internet 信息服务），您应该将 .WMV 扩展名映射到 ASP.NET 解析器。

更多信息在这里：[http ://www.zorched.net/2006/01/20/aspnet-web-application-without-aspx-extension/](http://www.zorched.net/2006/01/20/aspnet-web-application-without-aspx-extension/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:19:51.887

如果您希望视频在您的网页中播放，您需要嵌入一个能够播放 WMV 的播放器。一个很好的候选者是[ASP.NET MediaPlayer 控件](http://msdn.microsoft.com/en-us/library/cc838173(VS.95).aspx)，它使您可以轻松地将基于 Silverlight 的媒体播放器嵌入到任何 ASP.NET 页面中。

# c# - WPF View 在关闭时将 ViewModel 属性设置为 null

> ID：1002098
> 
> 赞同：8
> 
> 时间：2009-06-16T15:06:34.197
> 
> 标签：c#, .net, wpf, mvvm

我有一个应用程序，我在 GroupBox 中显示用户控件。为了显示控件，我绑定到主窗体的 ViewModel 中的一个属性，该属性返回一个要显示的 ViewModel。我已经设置了 DataTemplates，以便表单自动知道使用哪个 UserControl/View 来显示每个 ViewModel。

当我显示不同的 UserControl 时，我保持前一个控件的 ViewModel 处于活动状态，但 WPF 会自动丢弃视图。

我遇到的问题是，当视图关闭时，任何两种方式绑定到 ViewModel 中的属性都会立即设置为 null，因此当我再次显示 ViewModel 时，所有值都设置为 null用户界面。

我认为这是因为作为关闭视图的一部分，它会处理并清除它包含的控件中的任何值，并且由于绑定已经到位，它们也会向下传播到 ViewModel。

我的资源中的数据模板

```
<DataTemplate DataType="{x:Type vm:HomeViewModel}">
    <vw:HomeView />
</DataTemplate>
<DataTemplate DataType="{x:Type vm:SettingsViewModel}">
    <vw:SettingsView />
</DataTemplate>
<DataTemplate DataType="{x:Type vm:JobListViewModel}">
    <vw:JobListView />
</DataTemplate> 
```

用于显示用户控件的代码

```
<GroupBox>
    <ContentControl  Content="{Binding Path=RightPanel}" />
</GroupBox> 
```

我在其中一个视图中绑定的控件示例：

```
 <ComboBox Name="SupervisorDropDown" ItemsSource="{Binding Path=Supervisors}" DisplayMemberPath="sgSupervisor" 
           SelectedValuePath="idSupervisor" SelectedValue="{Binding Path=SelectedSupervisorID}" /> 
```

以及相关的 ViewModel 属性：

```
public ObservableCollection<SupervisorsEntity> Supervisors
    {
        get
        {
            return supervisors;
        }
    }

public int? SelectedSupervisorID
{
    get
    {
        return selectedSupervisorID;
    }
    set
    {
        selectedSupervisorID = value;
        this.OnPropertyChanged("SelectedSupervisorID");
    }
} 
```

关于如何阻止我的视图将我的视图模型中的值归零的任何想法？我在想，也许我需要在视图关闭之前将它的 DataContext 设置为 null，但我不确定如何以当前绑定的方式来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-23T20:54:01.957

在尝试通过各种方式停止 null 设置后，我放弃了，而是让它按如下方式工作。在关闭视图之前，我将 ViewModel 设为只读。我在我的 ViewModelBase 类中完成了这项工作，我在其中添加了一个 IsReadOnly 布尔属性。然后在 ViewModelBase.SetProperty() （见下文）中，当 IsReadOnly 为真时，我忽略任何属性更改。

```
 protected bool SetProperty<T>( ref T backingField, T value, string propertyName )
    {
        var change = !IsReadOnly && !EqualityComparer<T>.Default.Equals( backingField, value );

        if ( change ) {
            backingField = value;
            OnPropertyChanged( propertyName );
        }
        return change;
    } 
```

它似乎是这样工作的，尽管我仍然很想知道一个更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:37:23.237

我找到了一种可能的解决方案，但我真的不喜欢它。

事实证明 DataContext IS 已经设置为 null ，但这无济于事。它发生在属性设置为 null 之前。似乎正在发生的事情是，在 UserControl/View 自行处理之前，数据绑定没有被删除，因此当控件被删除时，null 值会向下传播。

所以当 DataContext 发生变化时，如果新的上下文为空，那么我会移除 ComboBox 上的相关绑定，如下所示：

```
private void UserControl_DataContextChanged(object sender, DependencyPropertyChangedEventArgs e)
{
    if (e.NewValue == null)
    {
        SupervisorDropDown.ClearValue(ComboBox.SelectedValueProperty);
    }
} 
```

我不是这种方法的忠实拥护者，因为这意味着我必须记住对我使用的每个数据绑定控件都这样做。如果有一种方法我可以让每个 UserControl 在它们关闭时自动删除它们的绑定就可以了，但我想不出任何方法来做到这一点。

另一种选择可能是仅重组我的应用程序，以便在 ViewModel 完成之前视图不会被破坏 - 这将完全回避问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-27T19:40:25.917

我有同样的问题。对我有用的是从我的 SelectedValueBindings中删除**UpdateSourceTrigger=PropertyChanged 。**当您使用该模式时，PropertyChanged UpdateSourceTriggers 似乎会触发关闭视图的绑定属性：

```
<!--Users DataGrid-->
<DataGrid Grid.Row="0" ItemsSource="{Binding DealsUsersViewSource.View}"
    AutoGenerateColumns="False" CanUserAddRows="True" CanUserDeleteRows="False"
    HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
    <DataGrid.Resources>
        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="#FFC5D6FB"/>
    </DataGrid.Resources>
    <DataGrid.Columns>

          <!--Username Column-->
          <DataGridComboBoxColumn 
            SelectedValueBinding="{Binding Username}" Header="Username" Width="*">
              <DataGridComboBoxColumn.ElementStyle>
                  <Style TargetType="{x:Type ComboBox}">
                      <Setter Property="ItemsSource" Value="{Binding DataContext.DealsUsersCollection.ViewModels,
                          RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}" />
                      <Setter Property="SelectedValuePath" Value="Username"/>
                      <Setter Property="DisplayMemberPath" Value="Username"/>
                  </Style>
              </DataGridComboBoxColumn.ElementStyle>
              <DataGridComboBoxColumn.EditingElementStyle>
                  <Style TargetType="{x:Type ComboBox}">
                      <Setter Property="ItemsSource" Value="{Binding DataContext.BpcsUsers,
                          RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}" />
                      <Setter Property="SelectedValuePath" Value="Description"/>
                      <Setter Property="DisplayMemberPath" Value="Description"/>
                      <Setter Property="IsEditable" Value="True"/>
                  </Style>
              </DataGridComboBoxColumn.EditingElementStyle>
          </DataGridComboBoxColumn>

          <!--Supervisor Column-->
          <DataGridComboBoxColumn 
            SelectedValueBinding="{Binding Supervisor}" Header="Supervisor" Width="*">
              <DataGridComboBoxColumn.ElementStyle>
                  <Style TargetType="{x:Type ComboBox}">
                      <Setter Property="ItemsSource" Value="{Binding DataContext.DealsUsersCollection.ViewModels,
                          RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}" />
                      <Setter Property="SelectedValuePath" Value="Username"/>
                      <Setter Property="DisplayMemberPath" Value="Username"/>
                  </Style>
              </DataGridComboBoxColumn.ElementStyle>
              <DataGridComboBoxColumn.EditingElementStyle>
                  <Style TargetType="{x:Type ComboBox}">
                      <Setter Property="ItemsSource" Value="{Binding DataContext.BpcsUsers,
                          RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}" />
                      <Setter Property="SelectedValuePath" Value="Description"/>
                      <Setter Property="DisplayMemberPath" Value="Description"/>
                      <Setter Property="IsEditable" Value="True"/>
                  </Style>
              </DataGridComboBoxColumn.EditingElementStyle>
          </DataGridComboBoxColumn>

          <!--Plan Moderator Column-->
          <DataGridCheckBoxColumn Binding="{Binding IsPlanModerator}" Header="Plan Moderator?" Width="*"/>

          <!--Planner Column-->
          <DataGridCheckBoxColumn Binding="{Binding IsPlanner}" Header="Planner?" Width="*"/>

    </DataGrid.Columns>
</DataGrid> 
```

**容器视图：**

```
<!--Pre-defined custom styles-->
<a:BaseView.Resources>

    <DataTemplate DataType="{x:Type vm:WelcomeTabViewModel}">
        <uc:WelcomeTabView/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:UserSecurityViewModel}">
        <uc:UserSecurityView/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type vm:PackItemRegisterViewModel}">
        <uc:PackItemsRegisterView/>
    </DataTemplate>

</a:BaseView.Resources>

<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="30"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="30"/>
    </Grid.ColumnDefinitions>

    <Grid.RowDefinitions>
        <RowDefinition Height="30"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="30"/>
    </Grid.RowDefinitions>

    <TabPanel Grid.Column="1" Grid.Row="1">
        <TabControl TabStripPlacement="Top" ItemsSource="{Binding TabCollection}" SelectedIndex="{Binding SelectedTabIndex}"
                    DisplayMemberPath="DisplayName" MinWidth="640" MinHeight="480"/>
    </TabPanel>

</Grid> 
```

**容器视图模型：**

```
TabCollection.Add(new WelcomeTabViewModel());
TabCollection.Add(new UserSecurityViewModel(_userService, _bpcsUsersLookup));
TabCollection.Add(new PackItemRegisterViewModel(_packItemService, _itemClassLookup));
SelectedTabIndex = 0; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T16:46:12.730

> 当我显示不同的 UserControl 时，我保持前一个控件的 ViewModel 处于活动状态，但 WPF 会自动丢弃视图。
> 
> 我遇到的问题是，当视图关闭时，任何两种方式绑定到 ViewModel 中的属性都会立即设置为 null，因此当我再次显示 ViewModel 时，所有值都设置为 null用户界面。

我不是 WPF 或 MVVM 方面的专家，但这听起来不太对劲。我很难相信视图的 WPF 处理会导致您的问题。至少，在我有限的经验中，我从来没有发生过这样的事情。我怀疑罪魁祸首要么是视图模型中的代码，要么是换出用于数据上下文的视图模型的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-16T14:49:27.613

将**UpdateSourceTrigger**显式设置为**LostFocus**

如果视图正在关闭并将其数据设置为 null，则它对视图模型中的数据没有影响。

```
<ComboBox Name="SupervisorDropDown" ItemsSource="{Binding Path=Supervisors}" DisplayMemberPath="sgSupervisor" 
SelectedValuePath="idSupervisor" 
SelectedValue="{Binding Path=SelectedSupervisorID, UpdateSourceTrigger=LostFocus}" /> 
```

# python - bin() 可以像 Python 2.6 中的 oct() 和 hex() 一样重载吗？

> ID：1002116
> 
> 赞同：16
> 
> 时间：2009-06-16T15:08:55.817
> 
> 标签：python, binary, overloading, python-2.6

在 Python 2.6（及更早版本）中，可以通过定义特殊函数在类中重载内置函数`hex()`和`oct()`内置函数。然而，没有一个特殊的函数可以重载 Python 2.6 的新内置函数的行为。`__hex__``__oct__``__bin__``bin()`

我想知道是否有任何灵活重载的方法`bin()`，如果没有我想知道为什么接口不一致？

我知道`__index__`可以使用特殊函数，但这并不灵活，因为它只能返回一个整数。我的特定用例来自[bitstring](http://code.google.com/p/python-bitstring/)模块，其中前导零位被认为是重要的：

```
>>> a = BitString(length=12)       # Twelve zero bits
>>> hex(a)
'0x000'
>>> oct(a)
'0o0000'
>>> bin(a)
'0b0' <------ I want it to output '0b000000000000' 
```

我怀疑没有办法实现这一点，但我认为问它不会有什么坏处！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T10:04:34.817

正如您已经发现的那样，您不能 override `bin()`，但听起来您不需要这样做。您只需要一个 0 填充的二进制值。不幸的是，在 python 2.5 及之前的版本中，你不能使用“%b”来表示二进制，所以你不能使用“%”字符串格式化操作符来达到你想要的结果。

[幸运的是，python 2.6 确实以新的str.format()](http://docs.python.org/library/string.html#string-formatting)方法的形式提供了你想要的东西。我相信您正在寻找这种特殊的线路噪音：

```
>>> '{0:010b}'.format(19)
'0000010011' 
```

这种迷你语言的语法在文档中的“[格式规范迷你语言”下。](http://docs.python.org/library/string.html#format-specification-mini-language)为了节省您一些时间，我将解释我正在使用的字符串：

1.  参数零（即`19`）应该被格式化，使用
2.  一个神奇的 " `0`" 表示我想要 0 填充的右对齐数字，使用
3.  10 位精度，单位为
4.  二进制格式。

您可以使用这种语法来实现对齐和填充的各种创意版本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-07-06T16:01:13.373

我认为简短的回答是“不，`bin()`不能像`oct()`and一样重载`hex()`。”

至于为什么，答案必须在 Python 3.0 中，它用于`__index__`重载`hex()`,`oct()`和`bin()`, 并且完全去掉了`__oct__`和`__hex__`特殊函数。

So the Python 2.6 `bin()` looks very much like it's really a Python 3.0 feature that has been back-ported without much consideration that it's doing things the new Python 3 way rather than the old Python 2 way. I'd also guess that it's unlikely to get fixed, even if it is considered to be a bug.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:23:38.127

bin 函数从对象的`__index__`函数中接收它的值。所以对于一个对象，你可以定义转换为二进制的值，但是你不能定义字符串的格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T16:49:54.647

您可以通过使用您自己的实现覆盖/替换内置的 bin() 函数来实现与十六进制和八进制相同的行为，该实现试图在传递的对象上调用**bin**并在对象没有时回退到标准 bin() 函数不提供**bin**。但是，在显式优于隐式的基础上，将应用程序编码为依赖于 bin() 的自定义版本可能不是一个好主意，所以也许只是给函数一个不同的名称，例如

```
def mybin(n):
    try:
        return n.__bin__()
    except AttributeError:
        return bin(n) 
```

至于为什么界面不一致，我不确定。也许是因为 bin() 是最近添加的，所以这是一个轻微的疏忽？

# php - PHP 透传速度慢

> ID：1002139
> 
> 赞同：3
> 
> 时间：2009-06-16T15:10:59.477
> 
> 标签：php

由于各种原因，我需要在 HTTP 请求和磁盘上的文件之间发挥中介作用。我的方法是填充标题，然后执行 readfile('/path/to/file.jpg');

现在，一切正常，除了它返回一个中等大小的图像非常缓慢。

发送标头后，谁能为我提供一种更有效的方式将文件流式传输到客户端？

注意：如果重要的话，它是共享主机环境中的一个 linux 盒子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:20:44.763

几个 Web 服务器允许外部脚本告诉他们这样做。[Apache 上的 X-Sendfile](http://blog.adaniels.nl/articles/how-i-php-x-sendfile/)（带有 mod_xsendfile）就是其中之一。

简而言之，您发送的只是标题。特殊`X-Sendfile`标头指示 Web 服务器将命名文件作为响应的主体发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:20:43.623

您可以从实现有条件的 GET 请求支持开始。

每当客户端使用“If-Modified-Since”请求文件并且您看到文件没有被修改时，发送带有文件的“Last-Modified”标头并回复“304 Not Modified”。一些明智的新鲜信息（通过“Cache-Control”/“Expires”标头）也是可取的，以首先防止重复请求未更改的资源。

这样至少可以提高感知性能，即使您应该发现您对实际性能无能为力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:46:31.963

这实际上应该相当快。我们已经用大图像做到了这一点，没有问题。在输出可能会减慢处理速度的图像之前，您是否在做任何其他事情，例如计算图像上的一些元数据？

编辑：您可能需要刷新输出并使用 fread。IE：

```
$fp = fopen($strFile, "rb");
//start buffered download
while(!feof($fp))
    {
    print(fread($fp,1024*16));
    flush();
    ob_flush();
    }
fclose($fp); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-06-16T15:26:39.290

基本上你想建立一个服务器......这不是微不足道的。

有一个非常有前途的基于 PHP 的服务器项目：[Nanoweb](http://nanoweb.si.kz/)。

它是免费的，并且完全可扩展。

# java - 偶尔无法上传 zip 文件

> ID：1002140
> 
> 赞同：1
> 
> 时间：2009-06-16T15:11:01.147
> 
> 标签：java, https

Tomcat 服务器在美国运行。我正在使用 Java 的 HTTPURLConnection 从中国连接到服务器。请参阅下面客户端使用的代码片段和tomcat服务器端的https连接器配置。

```
<!-- Define a SSL Coyote HTTP/1.1 Connector on port 8443 -->
    <Connector acceptCount="100" clientAuth="false" connectionTimeout="-1" debug="4" disableUploadTimeout="true" enableLookups="false" keystoreFile="conf/server.keystore" keystorePass="passw47d" maxSpareThreads="75" maxThreads="150" minSpareThreads="25" port="443" scheme="https" secure="true" sslProtocol="TLS" useBodyEncodingForURI="true"/>

    URL url=new URL(urlString);
    HttpsURLConnection connection=null;
    try
    {
        connection=(HttpsURLConnection)url.openConnection();
        connection.setDoOutput(true);
        connection.setDoInput(true);
        connection.setRequestMethod("POST");
        connection.setRequestProperty("Content-Type", "application/zip");
        connection.setRequestProperty("Transfer-Encoding", "chunked" );
        connection.setChunkedStreamingMode(4096);
        connection.connect();
        sout=new BufferedOutputStream(connection.getOutputStream());
        break;
    }
    catch(FileNotFoundException exc)
    {
        throw exc;
    }
    bis=new FileInputStream(zipfile);

    int i;    
    byte bytes[]=new byte[4096]; 
    while((i=bis.read(bytes))!=-1)
    {
        sout.write(bytes,0,i);
        sout.flush();
    }  
    sout.close();
    bis.close(); 
```

大多数情况下，客户端都会成功上传 zip 文件。有时客户端程序会抛出以下异常。

```
java.io.IOException: Error writing request body to server
at sun.net.www.protocol.http.HttpURLConnection$StreamingOutputStream.checkError(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection$StreamingOutputStream.write(Unknown Source)
at java.io.BufferedOutputStream.flushBuffer(Unknown Source)
at java.io.BufferedOutputStream.flush(Unknown Source)
at SendFiles.sendNowThruHttp(SendFiles.java:449)
at SendFiles.run(SendFiles.java:180) 
```

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:24:06.283

可能是网络超时。但可以肯定的是，请查看服务器日志文件。它们也将包含一条错误消息。

我还建议查看[HttpClient Java 库](http://hc.apache.org/httpclient-3.x/)，它使这些事情变得更加简单可靠。有关示例，请参见[本文（接近尾声）。](http://www.theserverside.com/tt/articles/article.tss?l=HttpClient_FileUpload)

# java - 创建对象

> ID：1002144
> 
> 赞同：0
> 
> 时间：2009-06-16T15:11:18.540
> 
> 标签：java, object

```
Box buttonBox = new Box(BoxLayout.Y_AXIS);  
Name1 name2 = new Name1(); 
```

有两个 Name1

```
checkboxList = new ArrayList<JCheckBox>();  
name2 = new Name1(); 
```

只有一个 Name1

它有效，但为什么呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T15:13:01.797

第一次，`Name1 name2`声明一个`Name1`名为的变量`name2`，然后立即将其分配给`new Name1()`。第二次，变量已经存在；你只是重新分配它。

有些人喜欢使用：

```
Name1 name2;
name2 = new Name1(); 
```

而不是等价的：

```
Name1 name2 = new Name1(); 
```

但我发现第二个更容易阅读。

我建议您阅读[Java 教程](http://java.sun.com/docs/books/tutorial/)，尤其是[入门](http://java.sun.com/docs/books/tutorial/getStarted/index.html)和[学习 Java 语言](http://java.sun.com/docs/books/tutorial/java/index.html)。它们涵盖了各种像这样的初学者问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:20:11.067

```
Name1 name2 = new Name1(); 
```

在这一行中，您正在做两件事：

1.  声明一个名为`name2`type的变量`Name1`
2.  通过调用类的无参数构造函数`Name1`来创建对象，并将新创建对象的引用分配给变量`name2`

您还可以将步骤分开：

```
Name1 name2;
name2 = new Name1(); 
```

在您的第二段代码中，您只执行第 2 步，*并重*用（即覆盖）已经存在的变量`name2`。这是可能的，因为一旦声明，变量就可以在同一范围内尽可能频繁地使用（读取*和*写入）。变量是例外`final`，您只能写入一次。如果你这样做：

```
final Name1 name2 = new Name1();
name2 = new Name1(); 
```

您将收到编译器错误，因为您第二次尝试使用相同的变量。这很有用，因为它可以防止重用变量时发生的程序员错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:22:09.160

正如 Mmyers 所说，您已经声明了一个名为 name2的*类Name1 的变量。*

当你写作时会发生`X y = new X()`三件事：

1.  在等号的左侧，您将变量 y**声明**为 X 类型。它尚未创建并且在内存中不存在，您只是说它将存在。

2.  在右侧，您使用关键字*new***创建**X 的实例。它现在存在于堆中。

**   等号本身**将**步骤 2 中创建的实例分配给步骤 1 中创建的变量。* 

 *在您的第二行中，您只是跳过了第 1 步并创建了一个新实例，您将其分配给了一个已使用的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:48:30.150

除了已经描述的语法和形式问题之外，通常认为最好不要以这种方式重用变量。原因之一是状态爆炸；如果变量在程序中的任何给定点都*可能*处于不同的状态，那么您必须处理更多的可能性。因此，通常最好声明和使用*单独*的变量，将它们标记为 Michael Borgwardt 发布的“最终”。*

# wpf - WPF：SelectedValue 始终为空

> ID：1002149
> 
> 赞同：0
> 
> 时间：2009-06-16T15:12:32.017
> 
> 标签：wpf, xaml, selectedvalue

在下面的例子`SelectedValue`中`TabControl`总是`null`。为什么？

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:s="clr-namespace:System;assembly=mscorlib">
<DockPanel>
    <TextBlock Text="{Binding SelectedValue, ElementName=Tabs}" DockPanel.Dock="Bottom"/>
    <TabControl x:Name="Tabs" SelectedValuePath="Content.SelectedItem">
        <TabItem Header="TabOne">
            <ListView>
                <ListView.View>
                    <GridView>
                        <GridViewColumn/>
                    </GridView>
                </ListView.View>
                <s:String>ItemOne</s:String>
                <s:String>ItemTwo</s:String>
            </ListView>
        </TabItem>
        <TabItem Header="TabTwo">
            <ListView>
                <ListView.View>
                    <GridView>
                        <GridViewColumn/>
                    </GridView>
                </ListView.View>
                <s:String>ItemOne</s:String>
                <s:String>ItemTwo</s:String>
            </ListView>
        </TabItem>
    </TabControl>
</DockPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T16:30:04.363

正如 micahtan 在评论中指出的那样，`SelectedValue`当您切换标签时会更新。这意味着`TabControl`不监视属性`SelectedValuePath`的更改，仅在每次更改时轮询它们`SelectedItem`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:29:48.223

不知道你想做什么，但是：

假设您希望所选 TabItem 的名称显示在 TextBlock 中，这是因为您的 SelectedValuePath 不正确。尝试将您的 TabControl 标记更改为：

```
<TabControl x:Name="Tabs" SelectedValuePath="Header"> 
```

假设您正在尝试获取 ListView 中的字符串内容，请尝试将您的 TextBox 绑定更改为：

```
<TextBlock Text="{Binding SelectedItem.Content.SelectedItem, ElementName=Tabs}" DockPanel.Dock="Bottom"/> 
```

# apache2 - Apache2 访问仅限于本地 LAN

> ID：1002150
> 
> 赞同：5
> 
> 时间：2009-06-16T15:12:37.523
> 
> 标签：apache2, virtualhost

直到最近，我还设置了一堆虚拟站点，如下所示：

```
<VirtualHost 127.0.0.1:1234>
    ... 
```

这适用于在我使用 Linux 桌面的本地机器上进行测试。为了测试 MS 和资源管理器如何从我的 Windows 笔记本电脑显示我的页面，我将其更改为

```
<VirtualHost *:1234>
    ... 
```

这也可以正常工作，从我笔记本电脑的 IE 上的[http://[mylinuxservername]:1234](http://[mylinuxservername]:1234)调用该站点。但是，我想将该通配符限制为本地局域网。插入任何 ip，如 192.nnn.nnn.nnn 或 192.*.*.* 通配符在上面会导致 Windows 机器上的 403 Forbidden。本地服务器在我的 Linux 机器上仍然可以正常工作：

```
<VirtualHost 127.0.0.1:1234 192.*.*.*:1234>
    ... 
```

或者

```
<VirtualHost 127.0.0.1:1234 192.nnn.nnn.nnn:1234> #exact IP of laptop
    ... 
```

无论如何，我不喜欢上面第二个配置示例中的通配符。提示任何人？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-16T15:22:41.140

的参数`VirtualHost`是您收听的本地地址，而不是远程地址。

在 Apache 2.4 和更新版本中，使用[`Require`](https://httpd.apache.org/docs/current/mod/mod_authz_core.html#require)指令：

```
Require ip 127.0.0.0/8
Require ip 192.0.0.0/8 
```

如果您使用的是 Apache 2.2 或更早版本，请使用[authz_host](http://httpd.apache.org/docs/2.2/mod/mod_authz_host.html)配置：

```
Order Allow,Deny
Allow from 127.0.0.0/8
Allow from 192.168.0.0/16 
```

这可能也适用于 Apache 2.4，但[`Order`已`Allow`被弃用](http://httpd.apache.org/docs/current/mod/mod_access_compat.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-20T09:53:51.377

只是一个说明，以防像我这样的菜鸟来这里:)

> Apache HTTP Server 是通过在纯文本配置文件中放置指令来配置的。主配置文件通常称为 httpd.conf。 [主要配置文件](http://httpd.apache.org/docs/current/configuring.html)

## 对于 2.4 版

> mod_access_compat 提供的 Allow、Deny 和 Order 指令已被弃用，并将在未来的版本中消失。您应该避免使用它们，并避免推荐使用它们的过时教程。 [访问控制](http://httpd.apache.org/docs/current/howto/access.html)

```
Require ip 127.0.0.0/8
Require ip 192.0.0.0/8 
```

**或**（不完全相同）

```
Require ip 127.0
Require ip 192.168 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:24:18.997

使用 iptables 限制对机器本身的访问。第一个命令将允许来自 192 范围内的任何网络的 HTTP 流量（请注意，我认为您需要 192.168 才能真正成为本地但我可能错了）。第二个命令只是丢弃来自端口 80 的其他来源的数据包

```
iptables -I 1 INPUT -s 192.0.0.0/8 -p tcp --dport 80 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT

iptables -I 2 INPUT -p tcp --dport 80 -m state --state NEW -j DROP 
```

然后在你的虚拟主机中你可以做`<VirtualHost *:80>`

# c# - 如何结合RegularExpressionValidator控件和RequiredFieldValidator？

> ID：1002156
> 
> 赞同：4
> 
> 时间：2009-06-16T15:13:35.993
> 
> 标签：c#, asp.net, regex, validation

我经常使用也是必填字段的正则表达式验证器。这导致页面上看起来像是多余的控件。正则表达式验证器没有“必需”属性，这意味着我需要另一个控件。像这样：

```
<asp:TextBox ID="tbCreditCardNumber" runat="server" Width="200"></asp:TextBox>
<asp:RegularExpressionValidator ID="revCreditCardNumber" runat="server"
    ControlToValidate="tbCreditCardNumber" ValidationGroup="CheckoutGroup" ErrorMessage="Invalid Credit Card Number!"
    ValidationExpression="^(3[47][0-9]{13}|5[1-5][0-9]{14}|4[0-9]{12}(?:[0-9]{3})?)$">*</asp:RegularExpressionValidator>
<asp:RequiredFieldValidator ID="rfvCreditCardNumber" runat='server' ControlToValidate="tbCreditCardNumber" ValidationGroup="CheckoutGroup"
    ErrorMessage="Credit Card Number Required">*</asp:RequiredFieldValidator> 
```

有没有办法将这两个控件结合起来，这样我就不必输入那么多代码了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T08:16:53.880

一个常见的问题是验证器组件在未显示时仍然占用空间，如果您有多个验证器组件，这看起来很奇怪，即最后一个被触发，给星号或其他错误标记留下更大的间隙。这可以通过添加以下内容轻松解决：

```
display="Dynamic" 
```

...给验证者。

但是它并没有解决同时触发的问题，仍然会连续显示许多验证器错误。那么自定义验证器可能是最好的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:15:13.277

您可以结合功能推出自己的 CustomValidator。除此之外，据我所知，不。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:01:50.060

您可以覆盖**EvaluateIsValid**方法

```
 public class RegularExpressionValidatorEx : RegularExpressionValidator
{
    protected override bool EvaluateIsValid()
    {
        string controlValidationValue = base.GetControlValidationValue(base.ControlToValidate);
        if ((controlValidationValue == null) || (controlValidationValue.Trim().Length == 0))
        {
            return false;
        }
        return base.EvaluateIsValid();
    }

    protected override void OnPreRender(EventArgs e)
    {
        base.OnPreRender(e);
        Page.ClientScript.RegisterStartupScript(GetType(), "customVal", ClientID + @".evaluationfunction = function(val){
var value = ValidatorGetValue(val.controltovalidate);
if (ValidatorTrim(value).length == 0)
    return false;
return RegularExpressionValidatorEvaluateIsValid(val);}", true);

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:40:13.037

更具体地说，您需要将 CustomValdiator 的 ValidateEmptyMessage 属性设置为 true，否则他不会验证空输入字段。例子：

```
<script type="text/javascript">
    function clientValidate(sender, args){
        if (args.Value.length == 0) {
            args.IsValid = false;
        }
    }

</script>
 <asp:CustomValidator runat="server" 
        ID="CustomValidator" 
        ControlToValidate="TextBox1"
        ClientValidationFunction="clientValidate"
        ValidateEmptyText="true"
        Text="Error!">
    </asp:CustomValidator> 
```

但是，正如您所看到的，这绝不比您以前的代码短，所以如果由我决定，在这种情况下使用自定义验证器是**没有意义的。**至于原始问题，不幸的是，没有办法让默认的 RegExpressValidator 验证空输入字段。

# asp.net - 有史以来最奇怪的错误：ASP.NET 和 Firefox？

> ID：1002159
> 
> 赞同：0
> 
> 时间：2009-06-16T15:13:48.567
> 
> 标签：asp.net, firefox

我一直认为服务器端代码不受浏览器请求的影响，但我刚刚遇到了一个异常：

我有一个按钮，当单击它时，会更改按钮的 CSS 类（以及与它相关的类）并用新数据重新绑定 GridView。功能是这样的：

```
Private Sub lbViewUnUsed_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles lbViewUnUsed.Click
    lbViewUsed.CssClass = "button small"
    lbViewUnUsed.CssClass = "button small selected"
    BindUsage(UsageBinding.UnUsed)
End Sub 
```

在 IE 中，这非常有效。但是，在 Firefox 中，该`BindUsage()`函数会在中途停止触发，并且什么也没有完成！在我的挫败感中，我`Debug.Assert()`在每行代码之后插入语句`BindUsage()`以查看发生了什么，果然，该函数仅在 Firefox 中不会一直运行。

函数是这样的`BindUsage()`（调试断言仍在）：

```
Private Sub BindUsage(ByVal bindWhat As UsageBinding)
    Debug.Assert(False, 1)

    If bindWhat = UsageBinding.Used Then
        gvUsage.DataSource = sUser.GetWordsMarkedWithUsage(True)
        gvUsage.Columns(0).Visible = False 'hide button column'
    Else
        Debug.Assert(False, 2)

        gvUsage.DataSource = sUser.GetWordsMarkedWithUsage(False)
        Debug.Assert(False, 3)

        Dim userInfo As UserAccount.LoginInfo = UserAccount.GetUserLoginInfo
        Debug.Assert(False, 4)

        Dim showUsedButton As Boolean
        Debug.Assert(False, 5)

        showUsedButton = (userInfo.UserName.ToLowerInvariant = sUser.UserName.ToLowerInvariant)
                       Debug.Assert(False, 6)

        gvUsage.Columns(0).Visible = showUsedButton 'show button column'
        Debug.Assert(False, 7)

    End If
    Debug.Assert(False, 8)

    gvUsage.DataBind()
    Debug.Assert(False, 9)

End Sub 
```

上述函数在 Firefox 中不会超过 5。我猜变量的分配存在某种问题`showUsedButton`，但我无法弄清楚它会是什么。为什么这只会在 Firefox 中失败，而在任何其他浏览器中都不会失败，**尤其是因为这发生在服务器上？？？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T15:18:49.803

它发生在服务器上，但您正在检索客户端生成的数据：

> UserAccount.GetUserLoginInfo

我会查看您存储的数据，并根据客户端应用程序查看其中有什么不同，并查看它是如何处理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:21:28.317

好吧，这有点猜测，但是...

具体是`UserAccount.GetUserLoginInfo`做什么的？如果我不得不猜测，它会尝试做一些特定于浏览器的事情。例如，它可以尝试从客户端读取 cookie？如果是这样，那么我的下一个猜测是`userInfo`或者`userInfo.UserName`是 null，从而引发 NullReferenceException。

可能是 IE 接受 cookie，而 Firefox 不接受。因此在 IE 中没有错误，但仅在 Firefox 中。同样，这是猜测，我不擅长 VB.NET，也不知道 UserAccount 类是什么。也许如果你愿意使用错误消息，它可能意味着更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:19:43.237

如果抛出任何异常，您肯定会发现吗？如果没有，请在执行其他任何操作之前修复它。

至于为什么它可能是特定于浏览器的：

*   如果它取决于浏览器发送什么数据以及如何发送，那么显然浏览器可以改变行为
*   我相信 ASP.NET 以特定于浏览器的方式呈现；如果您的代码涉及渲染逻辑，则根据用户代理的不同，它的行为可能会有所不同。

# c++ - 用 C 或 C++ 为 Android 编写应用程序？

> ID：1002164
> 
> 赞同：288
> 
> 时间：2009-06-16T15:14:50.017
> 
> 标签：c++, c, android

我正在尝试将游戏开发/移植到 Android，但它是 C 语言，并且 Android 支持 Java，但我确信必须有一种方法可以在其中获取 C 应用程序，有人知道实现此目的的方法吗？

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2009-10-15T11:00:30.833

对于通过 Google 了解此内容的任何人，请注意，从 SDK 1.6 开始，Android 现在拥有官方原生 SDK。

您可以从此处下载 Android NDK（本机开发工具包）： [https ://developer.android.com/ndk/downloads/index.html](https://developer.android.com/ndk/downloads/index.html)

还有一篇关于 NDK 的博文：
[http ://android-developers.blogspot.com/2009/06/introducing-android-15-ndk-release-1.html](http://android-developers.blogspot.com/2009/06/introducing-android-15-ndk-release-1.html)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-06-25T23:39:27.963

[Android NDK](https://developer.android.com/ndk/index.html)是一个工具集，可让您使用C 和 C++ 等语言在本机代码中实现部分应用。对于某些类型的应用程序，这可以帮助您重用以这些语言编写的代码库。

有关如何开始原生开发的更多信息，请点击[此链接](https://developer.android.com/ndk/guides/index.html)。

示例应用程序可以在[这里](https://developer.android.com/ndk/samples/index.html)找到。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-02-16T10:03:42.080

通常，您必须：

1.  安装谷歌安卓 NDK。它包含库、头文件、makfile 示例和 gcc 工具链
2.  从您的 C 代码为 ARM 构建可执行文件，如果需要，优化并链接到提供的库
3.  使用提供的 adb 接口连接到手机并测试您的可执行文件

如果您正在寻找销售应用程序：

1.  从您的 C 代码构建一个库
2.  创建将使用此库的简单 Java 代码
3.  将此库嵌入到应用程序包文件中
4.  测试你的应用
5.  出售或免费分发

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-06-18T15:03:56.273

Google 已经发布了一个原生开发工具包 (NDK)（根据[http://www.youtube.com/watch?v=Z5whfaLH1-E](http://www.youtube.com/watch?v=Z5whfaLH1-E)在 00:07:30）。

希望这些信息会在 google 群组页面 ( [http://groups.google.com/group/android-ndk](http://groups.google.com/group/android-ndk) ) 上更新，因为它表示尚未发布。

我不知道在哪里可以得到一个简单的下载，但我听说你可以从谷歌的 Git 存储库的 donut 分支下获得一份 NDK 的副本。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-06-16T15:45:15.447

官方立场*似乎*是，这不是你“想做”的事情。请参阅Android 开发人员列表中的[此线程](http://groups.google.com/group/android-developers/browse_thread/thread/278ac1b47594c37a)。Google 设想 android 可以在各种不同的设备（CPU、显示器等）上运行。因此，实现开发的最佳方式是使用以 Dalvik VM 为目标的（可移植的）托管代码。因此，Android SDK 不支持 C/C++。

但是，看看[这个页面](http://developer.android.com/guide/basics/what-is-android.html)：

> Android 包含一组供 Android 系统的各种组件使用的 C/C++ 库。这些功能通过 Android 应用程序框架向开发人员公开。

托管应用程序框架似乎位于这些库之上。该页面继续列出 C/C++ 库：标准 C 库、媒体、3D、SQL lite 等。

所以你所需要的只是一个编译器链，它将 C/C++ 编译到适当的 CPU（ARM，在 G1 的情况下）。有关如何执行此操作的一些简要说明在[这里](http://benno.id.au/blog/2007/11/13/android-native-apps)。

我不知道在哪里可以找到这些库提供的 API 的描述。我猜可能在 SDK 中某处埋有头文件，但文档可能粗略/缺失。但我认为这是可以做到的！

希望那有用。作为记录，我没有写过任何原生的安卓应用——只是一些简单的托管应用。

安迪

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-01-17T18:10:42.427

Google 已经启动了**Google I/O 2011：将 C 和 C++ 游戏带入 Android**会议，可在[http://www.youtube.com/watch?v=5yorhsSPFG4获得](http://www.youtube.com/watch?v=5yorhsSPFG4)

了解使用 NDK 用 c 和 c++ 为 android 编写应用程序是很好的。

如果您只想交叉编译任何基于控制台的原生游戏并在 android 上运行它们，那么[本文](http://shareprogrammingtips.com/c-language-programming-tips/cross-compile-cc-based-programs-run-android-smart-phones/)展示了 3 种相同的方法。

1：使用独立工具链进行静态编译

2：使用Android NDK的工具链进行交叉编译

3：使用AOSP源码交叉编译

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-10-27T23:25:36.573

您可以使用[nestedvm](http://nestedvm.ibex.org/)将 C（或其他 GCC 语言）转换为 Java 字节码，并将其用作移植的基础。例如，请参阅[Simon Tathams 便携式拼图合集的 Android 端口](http://chris.boyle.name/projects/android-puzzles)。

我预计这种方法会被 NDK 淘汰，但如果某些网络或某些东西不允许人们升级手机，它可能不会出现。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-06-16T15:35:05.730

看着这似乎是可能的：

*   [http://openhandsetmagazine.com/2007/11/running-c-native-applications-on-android-the-final-point/](https://web.archive.org/web/20140627112457/http://openhandsetmagazine.com/2007/11/running-c-native-applications-on-android-the-final-point/)（现在只能通过 WayBack Machine 获得）

> “事实上，仅支持 Java 语言并不意味着您不能开发其他语言的应用程序。这一点已被许多开发人员、黑客和移动应用程序开发专家证明。Edgelib 背后的公司 Elements Interactive BV 的人库，成功在 Android 平台上运行原生 C++ 应用程序，即使此时在显示和声音上仍然存在很多问题......等等。这包括 S-Tris2 游戏和 Edgelib 的 3D 动画演示。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2010-10-11T23:22:10.890

也许你正在寻找这个？

[http://www.mosync.com/](http://www.mosync.com/)

它是使用 c++ 为多个移动平台开发的中间层。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-07-02T08:08:21.033

自 2009 年以来，这件事有了进展。
[Necessitas](http://sourceforge.net/p/necessitas/home/necessitas/) - 适用于 Android 的 Qt（C++ 框架）
入门[视频](http://labs.qt.nokia.com/2011/02/28/necessitas/)。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-06-16T21:26:44.227

看看[google ndk group](http://groups.google.com/group/android-ndk)，它看起来很有希望，NDK 的第一个版本将在 1H2009 提供。

更新：它已发布[http://android-developers.blogspot.com/2009/06/introducing-android-15-ndk-release-1.html](http://android-developers.blogspot.com/2009/06/introducing-android-15-ndk-release-1.html)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2010-08-20T02:35:17.470

我不确定 NDK 是否提供了对官方 Java API 的完整覆盖。

来自[http://developer.android.com/sdk/ndk/index.html#overview](http://developer.android.com/sdk/ndk/index.html#overview)：

> 请注意，NDK 不允许您开发纯原生应用程序。Android 的主要运行时仍然是 Dalvik 虚拟机。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-06-26T13:28:14.247

谷歌刚刚发布了允许这样做的 NDK。

[http://feedproxy.google.com/~r/blogspot/hsDu/~3/2foWz7hwFtE/introducing-android-15-ndk-release-1.html](http://feedproxy.google.com/~r/blogspot/hsDu/~3/2foWz7hwFtE/introducing-android-15-ndk-release-1.html)

可以在这里找到：http: [//developer.android.com/sdk/ndk/1.5_r1/index.html](http://developer.android.com/sdk/ndk/1.5_r1/index.html)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-11-18T09:52:49.860

来自 Ubuntu 的本机 C/c++ 文件 libstdc++.* 是 x86（或 x86_64）二进制文件，但 Android 设备和模拟器是 ARM。当然，这无论如何都行不通，即使您设置了正确的 soname。这是非常幼稚的方式，无处可去。Android 对 C++ 的支持非常有限，这意味着没有例外，标准 C++ 库（包括 STL）和 RTTI。如果您需要此类功能，请使用我的自定义 NDK 分发版

[http://crystax.net/android/ndk.php](http://crystax.net/android/ndk.php) - 它支持上面列出的完整 C++ 功能。

为什么会出现错误：未定义引用 '__cxa_end_cleanup' 链接错误。安卓 stlport

时间。因为没有链接到libstdc++。A. 错了。

因为它使用了一些静态库，所以需要链接完整的libstdc++。一个罐头

[http://crystax.net/android/ndk.php](http://crystax.net/android/ndk.php)这里下载包

sources\cxx-stl\gnu-libstdc++\libs\armeabi 目录。

Android 对自己的libstdc++ 支持是有限的，它必须链接到一个完整的libstdc++。一份工作。

在 Android.mk 中添加文件 `LOCAL_LDFLAGS = $ (LOCAL_PATH) / libs / libcurl.a \`

```
 $ (LOCAL_PATH) / libs / liblua.a \
 `$ (LOCAL_PATH) / libs / libstdc + +. A` 
```

并且`LOCAL_CPPFLAGS + =-lstdc + +-fexceptions`可以编译

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-12-01T22:42:12.303

我不知道一个教程，但一个很好的开发工具：来自 Ideaworks Labs 的 Airplay SDK。（最近更名为“ [Marmelade](http://www.madewithmarmalade.com/devnet/faqs#-rebranding) ”）使用 C/C++，您可以为 Windows Mobile、iPhone、Android 构建应用程序。我唯一不喜欢的组件是 GUI 作曲家——一个有问题的组件，但你总是可以用记事本代替它。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-06-16T15:41:19.573

这篇博文可能是一个好的开始：[http](http://benno.id.au/blog/2007/11/13/android-native-apps) ://benno.id.au/blog/2007/11/13/android-native-apps 不幸的是，许多重要的东西“留给读者作为练习”。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2012-02-11T21:33:18.163

这三个步骤很适合在这篇文章中拥有和存储。

1）[如何在android上移植本机c代码](https://stackoverflow.com/questions/4656732/how-to-port-native-c-code-on-android)

2) [http://www.integratingstuff.com/2010/12/12/calling-native-c-code-through-jni-in-android-applications/](http://www.integratingstuff.com/2010/12/12/calling-native-c-code-through-jni-in-android-applications/)

3) [http://mindtherobot.com/blog/452/android-beginners-ndk-setup-step-by-step/](http://mindtherobot.com/blog/452/android-beginners-ndk-setup-step-by-step/)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-01-19T16:12:55.717

您可以下载 c4droid 然后安装 GCC 插件并安装到您的 SD。我只是从 shell 遍历到 GCC 二进制文件所在的目录，然后调用它来制作板载可执行文件。

# 查找 / -name *gcc*

/mnt/sdcard/Android/data/com.n0n3m4.droidc/files/gcc/bin/arm-linux-androideabi-gcc

# 猫> test.c

```
#include<stdio.h>
int main(){ 
 printf("hello arm!\n");
return 0;
} 
```

# ./arm-linux-androideabi-gcc test.c -o 测试

# 。/测试

你好手臂！

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-06-17T19:49:57.440

有计划在 Android 的下一个 SDK 版本中允许 C/C++ 库（代号 Eclair？）迄今为止，通过 Android Java SDK 是不可能的。但是，您可以获取 HUGE 开源项目，推出您自己的库，然后刷写您自己的设备……但是任何想要使用您的库的人也必须刷写您的自定义构建。

* * *

## 回答 #20

> 赞同：-7
> 
> 时间：2009-06-16T15:55:17.547

简短的回答：你不能。

@Backslash17：通过文章和以下链接以及安装说明，公司所做的只是在模拟器上启动一个自编译的可执行文件，绕过 android 框架。一旦你有了模拟器，你就可以远程登录并拥有一个 linux shell。在那里运行一个linux程序当然是微不足道的。但这不适用于没有越狱（又名 root 访问）且无法在市场上交付的手机。

除非 Google 提供其他机会或有人编写自定义编译器将语言 X 编译为 Dalvik 字节码（Dalvik 是运行 Android 程序的 VM），否则您将无法编写本机代码。

# grails - Grails 网络流

> ID：1002170
> 
> 赞同：3
> 
> 时间：2009-06-16T15:15:40.857
> 
> 标签：grails, groovy, spring-webflow

有没有办法将模型数据传递给视图状态？考虑以下示例视图状态：

```
class BookController {
  def shoppingCartFlow = {
    showProducts {
      on("checkout").to "enterPersonalDetails"
      on("continueShopping").to "displayCatalogue"
    }
  }
} 
```

如果我想将数据模型传递`[products: Product.list()]`给 showProducts.gsp，除了在视图状态之前使用将模型存储在流范围内的操作状态之外，还有什么方法可以做到这一点？

谢谢，唐

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T01:10:43.377

嗯，自从我做了一个流程以来已经有一段时间了，你的例子很简单（我希望只是为了作为一个例子）。

您缺少的是流程中的初始操作。请记住，作为您的 showProducts 的“查看”流程操作只是说明您的 showProducts gsp POST 时要执行的操作。将您发送到 showProducts 的操作应该创建要在 showProducts.gsp 中使用的模型

```
def ShoppingCartFlow = {
   initialize {
       action {  // note this is an ACTION flow task
           // perform some code
           [ model: modelInstance ] // this model will be used in showProducts.gsp
       }
       on ("success").to "showProducts"      
       // it's the above line that sends you to showProducts.gsp
   }

   showProducts {
        // note lack of action{} means this is a VIEW flow task
        // you'll get here when you click an action button from showProducts.gsp
      on("checkout").to "enterPersonalDetails"
      on("continueShopping").to "displayCatalogue"
   }

   // etc. (you'll need an enterPersonalDetails task, 
   // displayCatalogue task, and they
   // should both be ACTION tasks)
} 
```

说得通？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T18:14:00.433

你可以试试这个（假设你想去结账）：

```
showProducts {
      on("checkout"){
           // do somethings here too if you like
           // then pass your data as below:
           [products: Product.list()]
      } .to "enterPersonalDetails"
      on("continueShopping").to "displayCatalogue"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T04:14:25.370

也许我不明白这个问题，但你不能

> 渲染（视图：“showProducts”，模型：[产品：Product.list（）]

在你的控制器里面？

# jquery - 如何使用 jQuery 将 Windows 身份验证传递给 Web 服务？

> ID：1002179
> 
> 赞同：36
> 
> 时间：2009-06-16T15:17:43.427
> 
> 标签：jquery, web-services, windows-authentication

我正在使用 jQuery 调用这样的 .Net Web 服务：

```
var service_url = "https://example.com/myservice.asmx"
$.ajax({
    type: "GET",
    url: service_url,
    dataType: "xml",
    data: "ParamId=" + FormId.value,
    processData: false,
    error: function(XMLHttpRequest, textStatus, errorThrown) { ajaxError(XMLHttpRequest, textStatus, errorThrown); },
    success: function(xml) { DoSomething(xml); }
}); 
```

现在我想在 Windows 身份验证中包装“ [https://example.com/myservice.asmx ”。](https://example.com/myservice.asmx)如何使用 jQuery/javascript 将凭据传递给服务？

理想情况下，我想使用当前用户的凭据，但如果需要，我可以为所有服务调用使用 1 个主凭据。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2011-11-18T23:07:23.410

我认为现在您可以`withCredentials`将请求对象的属性设置为`true`，例如：

```
$.ajax({
    type: "GET",
    url: service_url,
    dataType: "xml",
    data: "ParamId=" + FormId.value,
    processData: false,
    xhrFields: {
        withCredentials: true
    },
    error: function(XMLHttpRequest, textStatus, errorThrown) { ajaxError(XMLHttpRequest, textStatus, errorThrown); },
    success: function(xml) { DoSomething(xml); }
}); 
```

这会导致在 AJAX 请求中传递现有的身份验证标头/cookie，这对我有用。无需进行自己的 Base 编码等。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-16T15:29:22.437

看来您需要手动设置带有 base64 身份验证数据的请求标头。

说明在这里：[http ://coderseye.com/2007/how-to-do-http-basic-auth-in-ajax.html](http://coderseye.com/2007/how-to-do-http-basic-auth-in-ajax.html)

您首先需要从这里获取以下代码：[http](http://www.webtoolkit.info/javascript-base64.html) ://www.webtoolkit.info/javascript-base64.html进行 base64 编码

```
/**
*
*  Base64 encode / decode
*  http://www.webtoolkit.info/
*
**/

var Base64 = {

    // private property
    _keyStr : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

    // public method for encoding
    encode : function (input) {
        var output = "";
        var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
        var i = 0;

        input = Base64._utf8_encode(input);

        while (i < input.length) {

            chr1 = input.charCodeAt(i++);
            chr2 = input.charCodeAt(i++);
            chr3 = input.charCodeAt(i++);

            enc1 = chr1 >> 2;
            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
            enc4 = chr3 & 63;

            if (isNaN(chr2)) {
                enc3 = enc4 = 64;
            } else if (isNaN(chr3)) {
                enc4 = 64;
            }

            output = output +
            this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) +
            this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);

        }

        return output;
    },

    // public method for decoding
    decode : function (input) {
        var output = "";
        var chr1, chr2, chr3;
        var enc1, enc2, enc3, enc4;
        var i = 0;

        input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

        while (i < input.length) {

            enc1 = this._keyStr.indexOf(input.charAt(i++));
            enc2 = this._keyStr.indexOf(input.charAt(i++));
            enc3 = this._keyStr.indexOf(input.charAt(i++));
            enc4 = this._keyStr.indexOf(input.charAt(i++));

            chr1 = (enc1 << 2) | (enc2 >> 4);
            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
            chr3 = ((enc3 & 3) << 6) | enc4;

            output = output + String.fromCharCode(chr1);

            if (enc3 != 64) {
                output = output + String.fromCharCode(chr2);
            }
            if (enc4 != 64) {
                output = output + String.fromCharCode(chr3);
            }

        }

        output = Base64._utf8_decode(output);

        return output;

    },

    // private method for UTF-8 encoding
    _utf8_encode : function (string) {
        string = string.replace(/\r\n/g,"\n");
        var utftext = "";

        for (var n = 0; n < string.length; n++) {

            var c = string.charCodeAt(n);

            if (c < 128) {
                utftext += String.fromCharCode(c);
            }
            else if((c > 127) && (c < 2048)) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            }
            else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }

        }

        return utftext;
    },

    // private method for UTF-8 decoding
    _utf8_decode : function (utftext) {
        var string = "";
        var i = 0;
        var c = c1 = c2 = 0;

        while ( i < utftext.length ) {

            c = utftext.charCodeAt(i);

            if (c < 128) {
                string += String.fromCharCode(c);
                i++;
            }
            else if((c > 191) && (c < 224)) {
                c2 = utftext.charCodeAt(i+1);
                string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                i += 2;
            }
            else {
                c2 = utftext.charCodeAt(i+1);
                c3 = utftext.charCodeAt(i+2);
                string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                i += 3;
            }

        }

        return string;
    }

} 
```

然后您将需要代码来构造身份验证数据，它只是用户和密码的 base64：

```
function make_base_auth(user, password) {
  var tok = user + ':' + password;
  var hash = Base64.encode(tok);
  return "Basic " + hash;
} 
```

然后您只需在发出请求之前使用 jQuery 添加标头：

```
var service_url = "https://example.com/myservice.asmx"
$.ajax({
    type: "GET",
    url: service_url,
    dataType: "xml",
    data: "ParamId=" + FormId.value,
    processData: false,
    beforeSend : function(req) {
         req.setRequestHeader('Authorization', 
               make_base_auth ('USERNAME', 'PASSWORD'));
    },
    error: function(XMLHttpRequest, textStatus, errorThrown) {   
         ajaxError(XMLHttpRequest, textStatus, errorThrown); 
    },
    success: function(xml) { DoSomething(xml); }
}); 
```

# jquery - 通过 jQuery.Ajax 向 MVC 控制器发送多个项目

> ID：1002180
> 
> 赞同：6
> 
> 时间：2009-06-16T15:17:57.967
> 
> 标签：jquery, asp.net-mvc, json, controller, arguments

如果您正在使用 jQuery 之类的东西序列化表单，它通常会将 JSON 键和值映射到您要发布到的控制器操作上的对象的属性。所以：

jQuery：

```
function PostForm() {
    $.ajax({
        url: "/Home/TestMVC",
        type: "POST",
        dataType: "application/JSON",
        data:  $('#form').serialize(),
        complete: callFunction
        }
    }); 
```

假设主要细节包含将参数名称作为键的元素，它们应该直接映射到对象：

行动：

```
public void TestMVC(MyObject obj)
{
//Obj should now contain the data from the serialised form
} 
```

邮政：

```
Name: "Bob"
Age: "999"
Sex: "Unknown" 
```

有谁知道这是如何工作的？每次我将表单***和任何其他数据***传递给控制器​​时，它都会中断。

我想将数据的内容以及可以包含任意数量和类型的键/值对的 QueryString 发送到控制器。我可以在服务器上提取这些键/值对，因为我无法在方法签名上为它们创建对象。但是，这无法按预期工作。

jQuery：

```
function PostForm() {

    $.ajax({
        url: "/Home/TestMVC",
        type: "POST",
        dataType: "application/JSON",
        data: 
        { 
           Obj: $('#form').serialize(),
           TheWeirdQueryString: $('.additionalParams').serialize(),
        }
    });
}; 
```

行动：

```
public void TestMVC(MyObject obj, String TheWeirdQueryString)
{
//Obj now does NOT contain the element, it is NULL. Whereas TheWeirdQueryString works fine. 
} 
```

邮政：

```
Obj: name=bob&age=999&sex="unknown"
TheWeirdQueryString: param1=1&param2=2 
```

我认为这是因为我实际上已经创建了一个 JSON 对象作为数据并将属性设置为对象的名称。

Firebug 中出现的 POST 值有所不同。当我单独发布对象时，POST 值是对象/表单的所有键及其对应的值。在第二个示例中，有两个简单的属性，我给它们的名称，每个都包含一个 QueryString ( `Foo=1&Bar=2`)，并且 MVC 不能将 QueryString 映射到对象的成员（或者它会出现）。

无论如何都可以像在第一个实例中那样开始工作，而且还要将额外的数据发送到动作的第二个参数？我猜它是为 jquery 对表单进行序列化时创建的所有现有属性添加一个额外的属性。

我真正想要的 POST 是：

```
Name: "Bob"
Age: "999"
Sex: "Unknown"
TheWeirdQueryString: param1=1&param2=2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T15:27:54.717

$.ajax 方法中的 dataType 参数是响应类型（您期望从服务器返回的数据类型），而不是请求。试试这个：

```
function PostForm() {
    $.ajax({
        url: "/Home/TestMVC",
        type: "POST",
        dataType: "application/JSON",
        data: $('#form').serialize() + "&" + $('.additionalParams').serialize()
    });
}; 
```

或者：

```
function PostForm() {
    $.ajax({
        url: "/Home/TestMVC" + "?" + $('.additionalParams').serialize(),
        type: "POST",
        dataType: "application/JSON",
        data: $('#form').serialize()
    });
}; 
```

**更新：**

试试这个：

控制器：

```
public void TestMVC(MyObject obj, String[] TheWeirdQueryString)
{
} 
```

客户：

```
function PostForm() {
    $.ajax({
        url: "/Home/TestMVC",
        type: "POST",
        dataType: "application/JSON",
        data: $('#form').serialize() + "&" + $('.additionalParams').serialize()
    });
}; 
```

但在客户端，您的附加参数必须采用以下格式：

```
TheWeirdQueryString[0]=param1&TheWeirdQueryString[1]=param2&...&TheWeirdQueryString[n]=paramN 
```

所以 $('.additionalParams') 元素必须具有“id”和/或“name”属性，例如：TheWeirdQueryString[1]、TheWeirdQueryString[2] ... TheWeirdQueryString[N]

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:49:54.707

数据是一个对象

```
...
data: { 
    x :$('#form').serialize(), 
    y:'something else'
}
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:56:35.200

如果您想要键/值对字典，另一种解决方案：

```
public void TestMVC(MyObject obj, IDictionary<string, object> TheWeirdQueryString)
{
} 
```

客户：

```
function PostForm() {
    $.ajax({
        url: "/Home/TestMVC",
        type: "POST",
        dataType: "application/JSON",
        data: $('#form').serialize() + "&" + $('.additionalParams').serialize()
    });
}; 
```

$('.additionalParams').serialize() 格式：

```
TheWeirdQueryString[0].Key=param0&TheWeirdQueryString[0].Value=value0&TheWeirdQueryString[1].Key=param1&TheWeirdQueryString[1].Value=value1&...&TheWeirdQueryString[n].Key=paramN&TheWeirdQueryString[n].Value=valueN 
```

**更新：**

你需要这样的东西：

```
<input class="additionalParams" type="text" name="TheWeirdQueryString[0].Key" value="param0" />
<input class="additionalParams"type="text" name="TheWeirdQueryString[0].Value" value="value0" />
<!-- ... -->
<input class="additionalParams"type="text" name="TheWeirdQueryString[n].Key" value="paramN" />
<input class="additionalParams"type="text" name="TheWeirdQueryString[n].Value" value="valueN" /> 
```

# installation - 在 GINA 上使用 Wix 卸载会导致登录失败

> ID：1002182
> 
> 赞同：0
> 
> 时间：2009-06-16T15:18:42.083
> 
> 标签：installation, wix, winlogon, gina

问题：卸载替换 GINA 后，如果我使用 WIX 3.0 安装程序，我会在登录后立即注销。

我有一个 Windows XP 的替换登录进程 (GINA)。它由放置在系统目录 C:\windows\system32\NewGina.dll 中的单个文件和一个注册表项 (HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Winlogon\GinaDLL=NewGina.dll) 组成，我手动操作没有问题安装它，运行它，手动卸载它并正常登录。

我还可以在VS2008中使用微软安装包创建安装程序，安装、登录、卸载、登录仍然可以正常工作。

我遇到的问题是，当我使用 Wix 安装程序时，我安装、登录、卸载和登录，登录后我立即注销。立即注销后，我能够连接远程注册表并转储注册表。我尝试在注册表之前和之后进行比较，并尝试了进程监视器，希望能发现 Wix 安装程序在做什么，但操作和更改（大约 35,000）有点难以分析。注册表行（上面列出的）消失了，windows 应该恢复到原来的 msgina.dll

由于项目的其余部分使用 Wix 安装程序，我希望使用它。

关于如何让它工作并避免自动注销的任何想法？

谢谢

APB

## 我的 Wix 脚本看起来像

```
<Package InstallerVersion="200" Compressed="yes" />

<Condition Message="This application is only supported on Windows XP">
  <![CDATA[(VersionNT = 501)]]>
</Condition>

<InstallExecuteSequence>
  <ScheduleReboot After="InstallFinalize"/>
</InstallExecuteSequence>

<Media Id="1" Cabinet="NewGina.cab" EmbedCab="yes" />

<Directory Id="TARGETDIR" Name="SourceDir">
        <Directory Id="SystemFolder">
    <Component Id="NewGina" Guid="cdbdfbe9-8137-4305-98cb-a05618ea0ade" > 
      <File Source="..\NewGina\Release\NewGina.dll" Checksum="yes" />     
    </Component>
    <Component Id="RegistryEntries" Guid="cdbdfbe9-8137-4305-98cb-a05618ea0adf" >
      <RegistryKey Root="HKLM" Key="SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" Action="createAndRemoveOnUninstall">
        <RegistryValue Type="string" Name="GinaDLL" Value="NewGina.dll" />
      </RegistryKey>
    </Component>
  </Directory>
</Directory>

<Feature Id="NewGina" Title="NewGina" Level="1" >
  <ComponentRef Id="NewGina" />
  <ComponentRef Id="RegistryEntries" />
</Feature> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T20:00:49.347

This line is a little disturbing:

```
<RegistryKey Root="HKLM" Key="SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" Action="createAndRemoveOnUninstall"> 
```

If my memory serves correctly that says create the Winlogon key during install (probably a noop) then remove the entire Winlogon key during uninstall. In you dump can you see if that registry key exists any longer? If my memory is correct, it might be all gone.

The correct authoring in any case, would be to just remove the RegistryKey/@Action attribute. You just want the RegistryValue installed and uninstalled. No special actions necessary.

# php - 这是使用 PHP CURL 发出 API 请求的最佳方式吗？

> ID：1002185
> 
> 赞同：1
> 
> 时间：2009-06-16T15:19:11.753
> 
> 标签：php, http, api, curl, curl-multi

我有一个网站，它有一个可以通过 http 使用的简单 API。我希望利用 API 一次提交大约 1000-1500 次数据。这是他们的 API：[http ://api.jum.name/](http://api.jum.name/)

我已经构建了提交提交的 URL，但现在我想知道发出这些 1000-1500 API GET 请求的最佳方法是什么？这是我正在考虑的 PHP CURL 实现：

```
$add = 'http://www.mysite.com/3rdparty/API/api.php?fn=post&username=test&password=tester&url=http://google.com&category=21&title=story a&content=content text&tags=Season,news';
curl_setopt ($ch, CURLOPT_URL, "$add");
curl_setopt ($ch, CURLOPT_POST, 0);
curl_setopt ($ch, CURLOPT_COOKIEFILE, 'files/cookie.txt');
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 0);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, TRUE);
$postdata = curl_exec ($ch); 
```

每次提交时都要关闭 CURL 连接吗？我可以以更好的方式重写上述内容，以使这 1000-1500 份提交更快吗？

谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:34:12.083

如果您可以访问 php 5.2+，我强烈推荐 php 的 curl_multi。

这使您可以并行处理多个 curl 请求，在这种情况下肯定会派上用场。

相关文档：[http](http://us3.php.net/manual/en/ref.curl.php)
://us3.php.net/manual/en/ref.curl.php 使用示例：http: [//www.somacon.com/p537.php](http://www.somacon.com/p537.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:30:27.520

默认情况下，PHP 的 curl 对 curl_exec() 的多次调用重用一个连接。

因此，在这种情况下，您只需使用 curl_init 获得的 curl 句柄，如果 URL 在对 curl_exec() 的调用之间匹配，它将发送“Connection: keep-alive”标头并重用连接。

不要关闭连接也不要设置 CURLOPT_FORBID_REUSE

也见这里：

[使用 PHP Curl 库的持久/保持活动 HTTP？](https://stackoverflow.com/questions/972925/persistent-keepalive-http-with-the-php-curl-library)

# asp.net - 如何使用带有 TemplateFields 的 ObjectDataSource 在 GridView 上进行排序

> ID：1002196
> 
> 赞同：7
> 
> 时间：2009-06-16T15:20:33.560
> 
> 标签：asp.net, gridview, objectdatasource, templatefield

## 背景：

我正在使用 GridView 和 ObjectDataSource。我正在实现分页和排序。

在 ObjectDataSource 上：

```
 objectDataSource.TypeName = value;
        objectDataSource.SelectMethod = "Select";
        objectDataSource.SelectCountMethod = "SelectCount";
        objectDataSource.SortParameterName = "sortExpression";
        objectDataSource.EnablePaging = true; 
```

在 GridView 上：

```
 gridView.AllowPaging = true;
        gridView.AllowSorting = true;
        gridView.DataSource = objectDataSource; 
```

为了使分页和排序正常工作，我将“EnableSortingAndPagingCallbacks”设置为 True。之前，我收到“System.Web.HttpException：GridView 触发的事件排序未处理”。这解决了它。

如果我在我的 GridView 中只使用 BoundFields，这很好并且工作正常。

但是，如果我使用 TemplateFields，我会收到“NotSupportedException：TemplateField 不支持回调，因为某些控件无法在回调中正确更新。在 GridView 上关闭回调。”

这是有道理的。我只需要知道如何进行排序，而不使用 EnableSortingAndPagingCallbacks。

**如果 EnableSortingAndPagingCallbacks = True：**

*   寻呼工程
*   分拣作品
*   BoundFields 工作
*   模板字段***不起作用***

**如果 EnableSortingAndPagingCallbacks = False：**

*   寻呼工程
*   排序***不起作用***_
*   BoundFields 工作
*   模板字段工作

* * *

## **我的问题：**

如何让分页、排序和模板字段同时工作？

* * *

*关于实施的说明：*

使用带有 GridView 的 ObjectDataSource 需要实现一个名为 Select 的方法，该方法提供排序表达式、要返回的行数和起始行：

```
 public IEnumerable<CountyAndStateGridRow> Select(string sortExpression, int maximumRows, int startRowIndex)
    {
        string oql = "select County order by {" + sortExpression + "}" ;

        var counties = QueryProvider.ExecuteQuery(oql).Cast<County>();

        var page = counties.Skip(startRowIndex).Take(maximumRows);

        var rows = page.Select(
            county => new CountyAndStateGridRow
            {
                CountyName = county.Name,
                StateName = county.State.Name,
            });

        return rows;
    } 
```

具体的 SortExpression 在 aspx/ascx 中定义：

```
<Columns>
       <asp:BoundField HeaderText="County Name" DataField="CountyName" SortExpression="Name" />
       <asp:BoundField HeaderText="State Name" DataField="StateName" SortExpression="State.Name" />
</Columns> 
```

这*应该*在单击列时传入并调用 ObjectDataSource 上的 Select 方法，但如果 EnableSortingAndPagingCallbacks = true 似乎不起作用，而是我得到关于未定义排序事件的异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T13:29:01.470

属性 EnableSortingAndPagingCallbacks 告诉控件对数据进行客户端排序，以便控件显示为自动排序而无需页面回发。此方法不支持模板字段。为了使用 TemplateFields 并执行排序，您需要连接 GridView.Sorting 事件，并将 AllowSorting 属性设置为 true。完成后，单击列标题时应该触发该事件，并且可以从那里处理排序逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-25T14:16:43.903

将 SortExpression 值更改为 DataField 的值。将 AllowPaging 和 AllowSorting 设置为 true。将 EnableSortingAndPagingCallbacks 设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-06T09:32:41.273

为了使排序功能起作用：

```
 <asp:GridView GridView ID="GvCountryDetails" AllowPaging="True" 
OnPageIndexChanging="GvCountryDetails_PageIndexChanging" AllowSorting="True" 
onsorting="GvCountryDetails_Sorting"> 
```

在 .cs 文件中，您需要编写

```
protected void GvCountryDetails_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        GvCountryDetails.PageIndex = e.NewPageIndex;
        isPageIndexChanged = true;
        BindData();
    }

protected void GvCountryDetails_Sorting(object sender, GridViewSortEventArgs e)
    {
        sortExpression = e.SortExpression;
        isPageIndexChanged = false;
        BindData();
    }
    private void SortGridData()
    {
        string sSortdir;
        if (isPageIndexChanged == true)
        {
            sSortdir = ViewState["SortDirection"] as string;
        }
        else
        {
            sSortdir = GetSortDirection(sortExpression);
        }

        string sSortExp = sortExpression;

        if (sSortdir == "ASC")
        {
            lstCountryDetails = Sort<Country>(lstCountryDetails, sSortExp, SortDirection.Ascending);
        }
        else
        {
            lstCountryDetails = Sort<Country>(lstCountryDetails, sSortExp, SortDirection.Descending);
        }
    }

    private List<CountryBO> Sort<TKey>(List<CountryBO> list, string sortBy, SortDirection direction)
    {
        PropertyInfo property = list.GetType().GetGenericArguments()[0].GetProperty(sortBy);
        if (direction == SortDirection.Ascending)
        {
            return list.OrderBy(e => property.GetValue(e, null)).ToList<CountryBO>();
        }
        else
        {
            return list.OrderByDescending(e => property.GetValue(e, null)).ToList<Country>();
        }
    }

    private string GetSortDirection(string column)
    {
        string sortDirection = "ASC";
        string sortExpression = ViewState["SortExpression"] as string;
        if (sortExpression != null)
        {
            if (sortExpression == column)
            {
                string lastDirection = ViewState["SortDirection"] as string;
                if ((lastDirection != null) && (lastDirection == "ASC"))
                {
                    sortDirection = "DESC";
                }
            }
        }

        ViewState["SortDirection"] = sortDirection;
        ViewState["SortExpression"] = column;
        return sortDirection;
    } 
```

# ruby-on-rails - 从 lib/ 中的文件获取 rails 中的当前请求

> ID：1002200
> 
> 赞同：1
> 
> 时间：2009-06-16T15:21:15.183
> 
> 标签：ruby-on-rails, ruby, request

我已将所有用户身份验证代码放在一个位置，即 lib/auth.rb。它看起来像这样：

**lib/auth.rb**

```
module Admin

  def do_i_have_permission_to?(permission)
    # Code to check all of this goes here
  end

end 
```

我将此模块作为应用程序助手的一部分包含在内，因此这些功能在所有视图中都可用：

**application_helper.rb**

```
require 'auth'
module ApplicationHelper
  include Admin
  # other stuff here
end 
```

而且我还将它作为应用程序控制器的一部分包含在内，因此控制器同样可以调用函数：

**应用程序.rb**

```
require 'auth'
class ApplicationController < ActionController::Base
  include Admin
end 
```

到现在为止还挺好。

问题是我的应用程序不像普通的网络应用程序。具体来说，多个用户可以同时从同一台计算机登录系统（使用相同的浏览器）。我通过查看从该 IP 登录的所有人员来对操作进行身份验证，如果他们都能做到，则通过。

这意味着，如果管理员想要做某事，该管理员必须先将其他所有人注销，这很烦人。但是我们希望管理员所做的一切都得到管理员的批准。所以给我的建议是拥有它，以便管理员可以在他们通常无法访问的任何页面上提供用户名/密码组合（例如，“编辑用户”页面将具有这些额外的输入字段）并且身份验证例程将检查那个。这表示

```
Admin::do_i_have_permission_to?(permission) 
```

需要获取当前请求参数。我不能像在控制器中那样只使用 params[:foo]，因为 params 没有定义；同样 request.parameters[:foo] 也不起作用。我的搜索显示：

*   当前搜索参数在当前请求中，
*   当前请求在当前控制器中，
*   当前控制器在当前调度器中，并且
*   我不确定当前的调度程序是否保存在任何地方。

也就是说，经验告诉我，当我跳过这么多圈时，我很可能做错了。那么正确的方法是什么？我考虑过的选项是：

*   只需将当前在 auth.rb 中的所有功能移动到 ApplicationHelper 中（我认为）他们将可以访问请求等。有效，但把帮手弄得一团糟。
*   将所有功能移到其他地方，他们会看到这些方法（我不知道在哪里）
*   我只是缺少一些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T16:32:49.197

在典型的 Rails 应用程序中，身份验证信息存储在活动会话中，而不是参数中。因此，编写一个可以满足您需求的助手非常简单。

创建一个然后包含在 ApplicationHelper 中的模块似乎相当不正统。传统的方法是创建一个单独的帮助程序，在这种情况下可能称为 AuthenticationHelper。然后可以将其包含在任何所需的控制器中，或者如果您愿意，可以将其加载到 ApplicationController 中以使其普遍可用。

一般而言，Helper 不应包含其他 Helpers。最好将多个帮助程序简单地加载到给定的控制器中。

辅助方法可以完全访问在它们操作的控制器上下文中声明的任何实例变量。具体来说，这些只是实例变量（@name），而不是局部变量（name）。辅助方法也会针对特定视图执行。

此外，我不确定为什么用户会在同一步骤中提供凭据并执行操作，至少对于传统的基于 Web 的应用程序而言。通常该过程是登录然后单独执行操作。

但是，对于每个事务都是独立操作的 API，最直接的方法是提取处理身份验证的相关请求参数，建立一些控制器实例变量，然后继续执行给定的特定请求凭证施加的约束。

对于这类事情，我通常采用的方法是在 ApplicationController 本身中添加一个身份验证结构，该结构可以执行所需的检查。这些是受保护的方法。

虽然很容易将它们卷入一大堆，例如 can_edit_user？和can_create_group？这些很快就会失控。为通用的 can_perform 挂上钩子是一种更简单的设计吗？或 has_authority_to？传递操作和任何必需参数的方法。

例如，一个非常粗略的实现：

```
 class ApplicationController < ActionController::Base
  protected
    def has_authority_to?(operation, conditions = { })
      AuthenticationCheck.send(operation, conditions)
    rescue
      false
    end
  end

  module AuthenticationCheck
    def self.edit_user?(conditions)
      session_user == conditions[:user]
    end
  end

  class UserController
    # ...

    def edit
      @user = User.find(params[:id])

      unless (has_authority_to?(:edit_user, :user => @user))
        render(:partial => 'common/access_denied', :status => :forbidden)
      end
    rescue ActiveRecord::RecordNotFound
      render(:partial => 'users/not_found')
    end
  end 
```

显然，您希望将大量权限检查滚动到 before_filter 块中，以避免重复并提高一致性。

一个完整的框架示例可能会更有帮助，例如 Wristband 用户身份验证系统：

[http://github.com/theworkinggroup/wristband/tree/master](http://github.com/theworkinggroup/wristband/tree/master)

# php - php soap 客户端：wsdl 与非 wsdl - 哪个更快？

> ID：1002202
> 
> 赞同：3
> 
> 时间：2009-06-16T15:21:29.487
> 
> 标签：php, soap, wsdl, soap-client

我正在使用 PHP 5 和内置的 SoapClient。
这对于 PHP Soap 支持的开发者来说确实是一个问题。

SoapClient 为您提供 2 种选择：WSDL 模式，它在本地缓存 WSDL 文件，以及需要您构建自己的请求的非 WSDL。

使用 WSDL 显然更方便。但是，我想知道每次创建 SoapClient 实例时会进行多少处理。WSDL 是缓存的，但是每次创建 SoapClient 时它是否必须重新处理整个 WSDL？如果是这样，似乎走非 WSDL 路线可能更有效（在 CPU 方面）。

在我的情况下创建非 WSDL SoapClient 没有问题。我是不是该？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-04T12:10:46.117

他们需要足够的时间来构建缓存（所以很痛苦）。我想真正的问题是缓存什么时候到期（在脚本退出时？）以及您进行了多少次调用（每个脚本？）。

此外，听起来您正试图过早地优化某些东西。如果不是问题，请不要担心。你可以把时间花在无关紧要的事情上。

# jquery - 在jQuery中收集表单中的所有项目

> ID：1002211
> 
> 赞同：7
> 
> 时间：2009-06-16T15:22:51.200
> 
> 标签：jquery, forms, collections

如何收集 jQuery 中的所有复选框和下拉列表项进行保存？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-16T15:32:22.447

或者，对于最新版本的 jquery，您可以使用：

[http://docs.jquery.com/Ajax/serialize](http://docs.jquery.com/Ajax/serialize) - 到一个 URL 编码的字符串`person.name=john&person.age=20`

或者

[http://docs.jquery.com/Ajax/serializeArray](http://docs.jquery.com/Ajax/serializeArray) - 到 JSON

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:28:46.367

一种方法是使用 jQuery [Form](http://malsup.com/jquery/form/)插件，如下所示：

```
$('#myFormId').formSerialize(); 
```

来自[formSerialize API 文档](http://malsup.com/jquery/form/#api)：

```
Serializes the form into a query string. This method will return a string in the format: name1=value1&name2=value2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T15:46:28.843

$('#myFormId').formSerialize(); 是一个插件，也许没有必要。核心函数 serialize() 更好。

[http://docs.jquery.com/Ajax/serialize](http://docs.jquery.com/Ajax/serialize)

# sql - 这是在存储过程上使用嵌入式 SQL 的有效好处吗？

> ID：1002212
> 
> 赞同：2
> 
> 时间：2009-06-16T15:22:55.537
> 
> 标签：sql, performance, stored-procedures

这是我没有听说过的关于 SP 的论点。火焰喷射器，对向下滴答声要温柔，

由于每次访问数据库服务器都会产生开销，因此我建议将 SQL 放在 SP 中而不是嵌入式代码的一个可能原因是，您可以更隔离地进行更改而不会影响性能。

例如。假设您需要执行返回标量整数的查询 A。

然后，稍后，需求发生变化，您决定标量的结果 > x ，然后，只有这样，您才需要执行另一个查询。如果您在 SP 中执行了第一个查询，您可以轻松地检查第一个查询的结果并有条件地在同一个 SP 中执行第二个 SQL。

如果不执行单独的查询或不必要的查询，您将如何在嵌入式 SQL 中有效地执行此操作？

这是一个例子：

```
--This SP may return 1 or two queries. 

SELECT @CustCount = COUNT(*) FROM CUSTOMER 

IF @CustCount > 10 
   SELECT * FROM PRODUCT 
```

这/在嵌入式 SQL 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T15:27:45.793

[很有说服力的文章](http://sqlblog.com/blogs/paul_nielsen/archive/2009/05/09/why-use-stored-procedures.aspx)

SQL 和存储过程将在您的数据期间存在。

客户端语言来来去去，每次都必须重新实现嵌入式 SQL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:33:56.903

在您提供的示例中，节省的时间是通过网络发送单个标量值和单个后续查询。这在任何合理的情况下都是微不足道的。这并不是说使用 SP 可能没有其他有效的性能原因。只是这不是这样的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:27:05.997

我通常不会将业务逻辑放在 SP 中，我希望它们在数据库之外使用我选择的母语。我唯一同意 SP 更好的情况是当有大量不需要从数据库中出来的数据移动时。

因此，为了回答您的问题，我宁愿在我的代码中包含两个查询，也不愿将其嵌入到 SP 中，在我看来，我正在用一个小的性能损失换取更清晰的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:27:04.983

> 如果不执行单独的查询或不必要的查询，您将如何在嵌入式 SQL 中有效地执行此操作？

取决于您使用的数据库。在 SQL Server 中，这是一个简单的`CASE`语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:27:45.607

也许在该存储过程中包含 WHERE 子句：

```
WHERE (all your regular conditions)
AND   myScalar > myThreshold 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T15:27:52.360

SP的好处：

1.  性能（预编译）
2.  易于更改（无需编译应用程序）
3.  基于 SQL 集的特性使得非常容易完成非常困难的数据任务

缺点：

1.  严重依赖使用的数据库引擎
2.  使升级部署更加困难（您必须部署应用程序 + 脚本）

我的2美分...

关于您的示例，可以这样做：

```
select * from products where (select count(*) from customers>10) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T15:38:28.907

最近我更喜欢不使用 SP（除非出现超级复杂性，其中 proc 会更好......或者 CLR 会更好）。我一直在将存储库模式与 LINQ to SQL 一起使用，其中我的查询以强类型的 LINQ 表达式写入我的数据层。这里的关键是查询是强类型的，这意味着当我重构时，我正在重构直接从数据库表生成的类的属性（这使得从数据库中进行的更改一直非常简单和准确）。虽然我的 SQL 为我生成并发送到服务器，但我仍然可以选择坚持 DRY 原则，因为存储库模式允许我将事物分解为最小的组件。我确实有可能会访问服务器的问题，并且根据查询结果，我可能会发现我需要再次访问服务器。我不担心这个。如果我以后发现它成为一个问题，那么我可能会将该代码重构为更高效的代码。这里最重要的一点是没有一颗灵丹妙药。我倾向于开发新的应用程序，这使得这种开发方法对我来说是最有效的。

# svn - MKS 中的检查点和 subversion 中的标记之间是否存在显着差异

> ID：1002215
> 
> 赞同：1
> 
> 时间：2009-06-16T15:24:03.477
> 
> 标签：svn, tags, mks, mks-integrity

我觉得 MKS 中的检查点和颠覆中的标签具有相同的目的。

当我们在颠覆中创建标签时，它会在物理位置创建一个本地副本（它是指向主干线的廉价副本。它不会占用空间）。当我们在 MKS 中创建检查点时，内容会存储在物理位置吗？还是只是一个标签？

在 MKS 中创建检查点后，我们可以为此创建一个开发路径吗？这种类型的选项在颠覆标签中也可用吗？

MKS 中的检查点与 subversion 中的标记有何不同？

我们正计划从 MKS 转移到颠覆。请给详细的解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T23:33:47.263

从 Subversion 存储库的角度来看，标签和分支完全相同——使用`svn copy`命令创建的“廉价副本”。让他们与众不同的是你对他们的态度。如果您创建一个副本并且从不更改它，那么它就是一个标签。如果您创建一个副本并在其上执行开发，则使用您的术语，它是一个分支或“开发路径”。

来自 SVN 书：

> 但是等一下：这个标签创建过程不就是我们用来创建分支的过程吗？是的，事实上，它是。在 Subversion 中，标签和分支之间没有区别。两者都只是通过复制创建的普通目录。就像分支一样，复制的目录是“标签”的唯一原因是因为人类已经决定这样对待它：只要没有人提交到目录，它就永远是一个快照。如果人们开始致力于它，它就会变成一个分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-21T20:53:43.247

颠覆标签与 mks 标签相同。mks 检查点确实有一个标签，但不仅如此。虽然标签/标签可以应用于任何文件，但检查点应用于整个项目。检查点会增加项目文件 (.pj) 的修订版，因此就像检查该文件一样。您还需要它们来分支项目（开发路径）。我们通常使用检查点来声明产品版本/修订。

# jquery - 使用 Jquery 单击复选框列表中的项目后插入用户控件

> ID：1002218
> 
> 赞同：1
> 
> 时间：2009-06-16T15:24:16.127
> 
> 标签：jquery

使用 JQuery 单击复选框列表中的复选框后，如何显示用户控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:31:13.930

这应该接近您正在寻找的内容：

```
$('#myCheckbox').click(function () {
    if ($(this).is(':checked')) {
        $('#myControl').show();
    } else {
        $('#myControl').hide();
    }
}); 
```

这将在选中复选框时显示 id**为 myControl**的元素，并在取消选中后将其隐藏。

如果您喜欢使用三元运算符的缩短表达式（我不健康地痴迷），您可能需要考虑这一点：

```
$('#myCheckbox').click(function () {
    $(this).is(':checked') ? $('#myControl').show() : $('#myControl').hide();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:34:26.403

在某些情况下，最好将元素动态添加到 DOM，而不是显示现有的表单元素。然后你可以绑定一个[jQuery 实时事件](http://docs.jquery.com/Events/live)来提交这样的表单。

```
$(document).ready(function(){   
    $("#myCheckbox").click(function(){
        $(this).html('<input class="newinput" id="thisinput" type="text" name="thisinput" value="" >');
        var update = $('<input name="submit" type="submit" class="update" value="update">');
        $(this).next().html(update);
        return true;
    });

    $(".update").live("click", function(){
    var thisinput = $("input#thisinput").val();
    var url = encodeURI('index.php?thisinput='+thisinput);
    window.location = url;
    return false;
    });

}); 
```

在上面的示例中，我使用 .html() 来插入输入元素。这将覆盖您的复选框。您可能希望使用不同的 DOM 操作，例如 append、next 或其他。

[使用ajax 函数](http://docs.jquery.com/Ajax)提交表单的方式有很多种，如果元素已经存在但是是隐藏元素，那么您只需要一个[显示效果](http://docs.jquery.com/Effects/show)。请参阅本[教程关于 jQuery 效果](http://www.webdesignerwall.com/tutorials/jquery-tutorials-for-designers/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:30:43.493

你想在哪里显示控件？

首先决定你想在哪里展示它

然后决定要显示的控件

在那之后：

```
 $("#myCheckboxId").click(function(){ /* show the control */}); 
```

# mysql - 测试数据库中重复键的最佳方法

> ID：1002222
> 
> 赞同：1
> 
> 时间：2009-06-16T15:25:32.537
> 
> 标签：mysql, database, dao

这更像是一个正确性问题。假设我的数据库中有一个带有主键列的表。在我的 DAO 代码中，我有一个名为 insertRow(string key) 的函数，如果表中不存在该键，该函数将返回 true 并使用该键插入一个新行。否则，如果已经存在具有该键的行，则返回 false。让 insertRow 首先检查密钥是否存在更好/更糟，还是继续执行插入并捕获重复的密钥错误？或者节省单个 select 语句太微不足道，甚至不用担心？

所以在 sudo 代码中：

```
boolean insertRow(String key){
    //potentially a select + insert
    if(select count(*) from mytable where key = "somekey" == 0){
       insert into mytable values("somekey")
       return true;
    }
    return false;
} 
```

或者

```
 boolean insertRow(String key){
    try{
       //always just 1 insert
       insert into mytable values("somekey")
       return true;
    } catch (DuplicateKeyException ex){}
    return false;
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T15:29:39.003

插入行，捕获重复键错误。我个人的选择

我认为这可能会表现得更好，这取决于抛出异常的成本与两次访问数据库的成本。

只有通过测试这两种情况你才能确定

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:29:41.297

在我看来，这是使用异常的绝佳案例（因为重复项是异常的），除非您在大多数情况下指望那里已经成为一行（即，您正在执行“插入，但更新如果存在”逻辑。）

如果代码的目的是更新，那么您应该使用 select 或`INSERT ... ON DUPLICATE KEY UPDATE`子句（如果您的数据库引擎支持）。或者，创建一个为您处理此逻辑的存储过程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T16:28:05.237

尝试插入，然后捕获错误。

否则，您*仍然*可能在两个活动 SPID 之间存在并发问题（假设系统上同时存在两个 Web 用户），在这种情况下，您无论如何都必须捕获错误：

```
User1: Check for key "newkey"? Not in database.
User2: Check for key "newkey"? Not in database.
User1: Insert key "newkey". Success.
User2: Insert key "newkey". Duplicate Key Error. 
```

您可以通过使用显式事务或设置事务隔离级别来缓解这种情况，但使用第二种技术更容易，除非您确定只有一个应用程序线程始终针对数据库运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T15:29:02.047

第二个，因为第一个选项击中数据库的两倍，而第二个选项只击中一次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:29:06.023

简短的回答是您需要自己测试它。我的直觉是，做一个小的选择来检查是否存在会表现得更好，但你需要自己验证一下，看看哪个表现更好。

一般来说，我不喜欢将我的错误检查完全留给我正在做的任何事情的异常引擎。换句话说，如果我可以检查我正在做的事情是否有效，而不仅仅是抛出异常，那通常就是我所做的。

但是，我建议使用`EXISTS`查询而不是`count(*)`

```
if(exists (select 1 from mytable where key = "somekey"))
    return false
else
    insert the row 
```

说了这么多（从抽象的、与引擎无关的角度来看），我很确定 MySQL 有一些关键字，只有当主键不存在时，才能将行插入表中。这可能是您最好的选择，假设您可以使用 MySQL 特定的关键字。

另一种选择是将逻辑完全放在 SQL 语句中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T15:29:33.823

mysql中的另外两个选项是使用

```
insert ignore into.... 
```

和

```
insert into .... on duplicate key update field=value 
```

包含`on duplicate key update field=field`

见：[http ://dev.mysql.com/doc/refman/5.0/en/insert.html](http://dev.mysql.com/doc/refman/5.0/en/insert.html)

编辑：您可以测试affected_rows 是否插入有效果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T15:40:07.297

现在我已经在网上找到了 Martin Fowler 的书，一个不错的方法是使用[密钥表](http://books.google.co.uk/books?id=FyWZt5DdvFkC&pg=PT249&lpg=PT249&dq=%22Key+table%22+Fowler&source=bl&ots=eEAuZzZxdx&sig=7JZJnRfsW166s93FzV5Cyg7YBNk&hl=en&ei=K703Srm4MYXH-Abm--26DQ&sa=X&oi=book_result&ct=result&resnum=1)- 有关更多信息，请参见第 222 页。

# asp.net - ASP.NET + jQuery + 动态创建的超链接控件

> ID：1002230
> 
> 赞同：0
> 
> 时间：2009-06-16T15:27:17.510
> 
> 标签：asp.net, jquery

我有一个使用 jQuery 的 ASP.NET 应用程序。我的 ASP.NET 应用程序根据数据库中的某些值动态生成一些 HyperLink 元素。当用户单击这些 HyperLink 元素之一时，我想显示一个 jQuery 对话框，允许用户编辑 HyperLink 的文本。我有这部分工作。

当用户单击“保存”按钮时，我需要读取 HyperLink 元素的值并将它们保存回数据库。目前，我得到了 HyperLink 元素的初始值。但是，我无法获得任何修改后的值。如何获取用户提供的值？我在这里提供了我的 .aspx 和 .aspx.cs 代码：

测试

报告：

```
 <div id="recommendDialog" title="Number">
        <table border="0" cellpadding="0" cellspacing="0">
            <tr><td>Number</td></tr>
            <tr><td><input id="optionName" type="text" /></td></tr>
        </table>
    </div>

    <asp:Button ID="saveButton" runat="server" Text="Save" OnClick="saveButton_Click" />
</div>
</form>    

<script type="text/javascript">
    var editingID = null;

    $("#recommendDialog").dialog({
        autoOpen: false,
        height: 200,
        modal: true,
        buttons: {
            Cancel: function() {
                $(this).dialog('close');
            },

            'OK': function() {
                var newValue = $("#optionName").val();
                if (editingID != null) {
                    $(editingID).attr("name", newValue);
                    $(editingID).html(newValue);
                }
                $(this).dialog('close');
            }
        },
        close: function() {

        }
    });

    function update_Click(link) {
        editingID = "#" + link.id;
        $("#optionName").val(link.name);
        $('#recommendDialog').dialog('open');            
    }
</script> 
```

这是我的代码隐藏：

公共部分类_默认：System.Web.UI.Page {受保护的覆盖无效OnInit（EventArgs e）{base.OnInit（e）; 添加超链接（）；}

```
protected void Page_Load(object sender, EventArgs e)
{}

protected void saveButton_Click(object sender, EventArgs e)
{
    foreach (TableCell cell in reportTable.Rows[0].Cells)
    {
        HyperLink h = (HyperLink)(cell.Controls[0]);
        string newValue = h.Attributes["name"];

        // Save value to database here. newValue does not show 
        // changed values.
        Console.WriteLine(newValue); 
    }
}

private void AddHyperlinks()
{
    TableRow row = new TableRow();
    for (int i = 1; i < 11; i++)
    {
        HyperLink hyperlink = new HyperLink();
        hyperlink.NavigateUrl = "#";
        hyperlink.Text = i.ToString();
        hyperlink.Attributes.Add("id", "h" + i);
        hyperlink.Attributes.Add("name", i.ToString());
        hyperlink.Attributes.Add("onclick", "update_Click(this);");
        AddLinkButtonToRow(hyperlink, row);
    }
    reportTable.Rows.Add(row);
}

private void AddLinkButtonToRow(HyperLink linkButton, TableRow row)
{
    TableCell cell = new TableCell();
    cell.Controls.Add(linkButton);
    row.Cells.Add(cell);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T05:32:54.717

你试图做的事情是不可能的。每次创建页面时都创建链接。尽管您在 JavaScript 中更改了这些链接的名称，但这些值不会发回给您。
在 上`Sumbit`，只有表单元素被发送回服务器（`<input>`例如 s），而不是`<a>`元素，因此您的服务器不“知道”所做的更改。

其次，即使您将 s 更改`<a>`为`<input>`s，您仍然有一个问题：您将无法按`reportTable.Rows[0].Cells`预期找到这些值。通常 asp.net 会正确填充这些值，即使对于动态生成的控件也是如此，但不是在这里 - 因为您已经更改了它们的名称！Asp.net 无法重新绑定这些值。

那你该怎么办？一种选择是为每个单元格添加一个隐藏字段。
在 上`AddLinkButtonToRow`，添加以下内容：

```
HtmlInputHidden hidden = new HtmlInputHidden();
hidden.ID = "hidden" + linkButton.ID;
hidden.Name = hidden.ID; //so it will be posted!
hidden.Style["display"] = "none"; //better to have a CssClass 
```

使用您似乎知道的 jQuery，更改这些输入字段的**值**，而不是它们的名称（类似于`$(editingID).parent().find(":hidden")`）。

接下来，您可能看不到控件上的值，但您可以在`Request.Form["hiddenh1"]`...处找到它们`Request.Form["hiddenh11"]`- 所有输入字段的名称都将被发布，这次您知道它们的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T05:29:13.037

我不确定“ReportTable”和它的表格单元在哪里或是什么，但我猜你的问题是你正在使用 jQuery 操作客户端上某些标签的值，并期望它们被发布回服务器?

这行不通。该页面使用 ViewState 中 HyperLink 控件的已知值呈现。由于标签不是输入类型，它们不会在回发时将值发回服务器，并且 ViewState 将始终使用其原始值重新初始化它们。任何操作都必须在服务器端完成。

我建议按照 ScottE 的建议进行操作，并使用 jquery ajax 进行更新。

# .net - ASP.NET 开发服务器崩溃

> ID：1002231
> 
> 赞同：2
> 
> 时间：2009-06-16T15:27:25.840
> 
> 标签：.net, visual-studio

我在尝试通过 Visual Studio 2008 中的 webdev 调试 asp .net 应用程序时遇到了崩溃。通常，解决此问题的常用方法是缩小可能导致崩溃的代码更改的范围。这通常很耗时。幸运的是，这种情况只会在蓝月亮中发生一次。

我想知道是否有更快的方法来解决这类崩溃问题。如果做不到这一点，导致 webdev 崩溃的常见原因是什么？

更新：

*   我目前的情况似乎是由堆栈溢出引起的。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:30:25.240

你能得到一个被抛出的异常消息吗？如果没有，我建议您下载并注入[ELMAH](http://code.google.com/p/elmah/)（一个不错的调试工具）到您的应用程序中，以查看崩溃时发生的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:59:19.077

您也许可以使用 ADPlus 找出 VS Web 服务器崩溃的原因：

> [如何使用 ADPlus 解决“挂起”和“崩溃”问题 (MS KB286350)](http://support.microsoft.com/kb/286350)

Tess Ferrandez 的网站有很多关于使用 ADPlus 和 WinDBG 解决这些棘手问题的好东西：

> [如果它坏了，你应该修复它（Tess Ferrandez，ASP.NET Escalation Engineer (Microsoft)）](http://blogs.msdn.com/tess/)

# c# - 在 WPF 中使用数据绑定刷新 UI

> ID：1002232
> 
> 赞同：3
> 
> 时间：2009-06-16T15:27:31.317
> 
> 标签：c#, wpf, data-binding

我有一个 3 层深的树视图，

```
-主要的
 ->:SUB1
   >:SUB2
   >:SUB2
 -X:SUB1
   X:SUB2
 SUB1
 SUB1

```

其中，> 和 X 表示表示该特定项目状态的图形（由后端确定）。

我正在使用 Observable Dictionary 绑定到这棵树（并且它有一个 ICollectionChanged 事件）。结构是这样的：

```
 ObservableDictionary<string,CustomClass> mainitems;

public class CustomClass{
    ObservableDictionary<string, InnerClass> sub1item;
    // Bunch of properties and methods in this class
    // INotify not implemented
}

public class InnerClass{
    // Bunch of properties and methods in this class
    // INotify not implemented
    public SomeEnum Status{
        get{ return this.status; }
    }
} 

```

上面提到的图形是使用自定义转换器绑定的，该转换器将状态枚举转换为路径以便可以绑定（即。<img source="{Binding Path=something, Converter={StaticResource someconverter}, Mode=OneWay " /> )。

**问题：**

我的问题是，当我用新状态更新 CustomClass 的 sub1item 字典时，它不会在 UI 中更新它。我认为实现 INotify 的东西可能会起作用，但我不知道我需要在哪里更新它以及如何更新它。

**编辑：** 我的树视图的 XAML 模板如下：

```
 <TreeView Name="tvInstance" ItemsSource="{Binding}" TreeViewItem.Selected="tviSelected" IsTextSearchEnabled="True">
    <TreeView.ItemContainerStyle>
        <Style>
            <Setter Property="TreeViewItem.IsExpanded" Value="{Binding Path=Value.Expanded, Mode=TwoWay}" />
        </Style>
    </TreeView.ItemContainerStyle>
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding Path=Value.CustomClass}" ItemContainerStyle="{x:Null}">
                <StackPanel Orientation="Horizontal">
                <Label Content="{Binding Path=Key}"/>
            </StackPanel>
            <HierarchicalDataTemplate.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Path=Value.AnotherClass}">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{Binding Path=Value.Status, Converter={StaticResource convertstatus} }"
                            Width="10" Height="10"/>
                        <Label Content="{Binding Path=Key}" />
                    </StackPanel>
                    <HierarchicalDataTemplate.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Image Source="{Binding Path=Value, Converter={StaticResource convertstatus} }"
                            Width="10" Height="10"/>
                                <Label Content="{Binding Path=Key}" />
                            </StackPanel>
                        </DataTemplate>
                    </HierarchicalDataTemplate.ItemTemplate>
                </HierarchicalDataTemplate>
            </HierarchicalDataTemplate.ItemTemplate>
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 

```

编辑：在我的主类、CustomClass 和 InnerClass 中添加所有 INotifyProperty 事件后，它仍然不起作用。我正在使用 Dr. WPF 版本的 ObservableDictionary（并且使用字典对我的应用程序至关重要，因为我需要进行大量查找）。帮助！

# 结语

此页面中的答案是正确的，因为需要在我希望在 UI 中更新的属性上实现 INotifyPropertyChanged。

我发现绑定字典太麻烦了，所以我同时保留了 ObservableCollection 和字典。我使用字典进行查找，使用集合进行绑定（因为两者都使用对对象的相同引用，所以使用集合和唯一的 O(n) 操作很容易删除）。

关于在 UI 中的更新，请参阅此页面上的其他帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:45:12.717

这可能有点长，这是我最好的猜测：

```
public class CustomClass : INotifyPropertyChanged
{
  public CustomClass()
  {
    sub1item = new ObservableDictionary<string, InnerClass>();
    // This next line may not be necessary... Changes might propogate up.
    sub1item.CollectionChanged += () => NotifyPropertyChange("Sub1Item");
  }

  private ObservableDictionary<string, InnerClass> sub1item;
  public ObservableDictionary<string, InnerClass> Sub1Item
  {
    get { return sub1item; }
    private set { sub1item = value; NotifyPropertyChange("Sub1Item"); }
  }

  public event PropertyChangedEventHandler PropertyChanged;

  private void NotifyPropertyChanged(String info)
  {
    if (PropertyChanged != null)
    {
      PropertyChanged(this, new PropertyChangedEventArgs(info));
    }
  }
}

public class InnerClass : INotifyPropertyChanged
{
  public SomeEnum Status
  {
    get { return this.status; }
    private set { this.status = value; NotifyPropertyChange("Status"); }
  }

  public event PropertyChangedEventHandler PropertyChanged;

  private void NotifyPropertyChanged(String info)
  {
    if (PropertyChanged != null)
    {
      PropertyChanged(this, new PropertyChangedEventArgs(info));
    }
  }
} 
```

只需确保通过调用 Status = something 来更新您的状态，而不是直接通过 this.status

**编辑：**如果您只想更新获得更新状态的单个对象，我不确定这会不会。我怀疑这将表明 Sub1Item 已更改，但 mainitems 可能不知道单个对象。这取决于您的实施。

如果您为具有与 Sub1Item 绑定的 CustomClass 创建了 DataTemplate，那么您的绑定将仅针对更新后的状态正确更新

```
<DataTemplate DataType="{x:Type myClrNamespace:InnerClass}">
    <Grid>
        <TextBlock Text={Binding Path=Status}/>
    </Grid>
</DataTemplate>
...
<ListBox x:Name="listStatus"/> 
```

然后在某个地方的 C# 中，您可以：`listStatus = mainlist[0].Sub1Item;`在看到您的 TreeView ItemTemplate 示例之后，我不再确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T04:22:29.280

可观察的集合实现`INofityCollectionChanged`，WPF 使用它来刷新视图项的集合。

但是，要更新状态，您需要实施数据`INotifyPropertyChanged`。

*   您希望出现在视图中的每个类都必须实现它，因此 WPF 将知道其属性何时更改以及哪些属性已更改。

实现很简单...

```
// Should implement INotifyPropertyChanged if the dictionary itself
// can be changed and not only its items
public class CustomClass {
    ObservableDictionary sub1item;
    // Bunch of properties and methods in this class
    // INotify not implemented
}

public class InnerClass : INotifyProperyChanged {
    // Bunch of properties and methods in this class
    // INotify not implemented
    public SomeEnum Status{
        get{ return this.status; }
    }

    public event PropertyChangedEventHandler PropertyChanged;

protected void NotifyPropertyChanged(string propertyName)
{
    if(PropertyChanged != null)
    {
        PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
}

// where ever this.status is changed directly,
// call NotifyPropertyChanged("Status")
// (at end of that method)
//
// if this.status is changed from outside class (if public),
// then add a public method NotifyStatusChanged() which calls
// NotifyPropertyChanged("Status")
//
// If Status property has a set{} then if new value != this.status,
// call NotifyPropertyChanged("Status") at end of setter

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:10:48.830

你需要使用一个事件，让你的类实现 INotifyPropertyChanged，它看起来像这样：

```
public class InnerClass: INotifyPropertyChanged
{
     private string _propertyName;

     //Implemented from INotifyPropertyChanged
     public event PropertyChangedEventHandler PropertyChanged;

     public string PropertyName
     {
        get { return _propertyName; }
        set 
        { 
              _propertyName = value;
              OnPropertyChanged("Name or Property Data"); 
        }
     }

     //Just using string as an example, send whatever data you'd like
     protected void PropertyChanged(string name)
     {
        //Check to make sure the event is wired.
        if(PropertyChanged != null)
        {
              //Fire event
              PropertyChanged(this, name);
        }
     }
} 
```

基本上，让这些事件为您的子项目触发并传递给您的 CustomClass 对象。然后，如果需要，让 CustomClass 处理这些事件，并触发另一个事件到您的主对象，告诉它更新 UI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-26T14:22:41.933

“任务”类型的工作示例

公共类任务：INotifyPropertyChanged

```
{

    //Implemented from INotifyPropertyChanged
    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    } 
```

私有字符串文本；

```
 public string Text
    {
        get { return text; }
        set { 
            text = value;
            NotifyPropertyChanged("Text");

            }
    } 
```

}

另一方面，值得记住的是，当数据绑定到类型集合时，您需要使用 ObservableCollection 而不是 List 来获取动态更新的 ItemSource。列表不通知。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-19T14:43:59.190

[ObservableDictionary(Of TKey, TValue)](http://observabledic.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=36134) - VB.NET

一般功能列表：

*   ObservableDictionary(TKey, TValue)
*   AddRange 只收到一次通知。
*   通用 EventArgs(TKey, TValue)
*   NotifyDictionaryChanging(Of TKey, TValue) - CancelEventArgs 的子类，允许取消操作。

# windows - 命令提示符下的命令可见性不使用 System32

> ID：1002234
> 
> 赞同：0
> 
> 时间：2009-06-16T15:27:40.083
> 
> 标签：windows

假设我有一个 foo.exe 文件，我想从 Windows 命令提示符使用它。我将转到包含 foo.exe 的文件夹并运行它。现在，如果我想从命令提示符的任何位置全局访问 foo.exe，我会将 foo.exe 放在 System32 文件夹中。

这个过程使 System32 成为垃圾场。我想知道是否有任何其他方法可以全局访问 .exe 或 bat 文件，而不必将它们全部转储到 System32 文件夹中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:30:31.887

更改您的 PATH 环境变量。即“设置路径=%path%;[newdir]”

其中 [newdir] 是您在运行命令时要搜索的新目录。

[PATH 环境变量](http://vlaurie.com/computers2/Articles/environment.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:35:06.263

您可以以编程方式执行此操作 ( [StackOverFlow](https://stackoverflow.com/questions/531998/is-there-a-way-to-set-the-environment-path-programatically-in-c-on-windows) ) 或按照这些说明 [如何在 Windows 2000/Windows XP 中设置路径](http://www.computerhope.com/issues/ch000549.htm)，[另一种](http://vlaurie.com/computers2/Articles/environment.htm)。

# sql - 按计数分组

> ID：1002248
> 
> 赞同：1
> 
> 时间：2009-06-16T15:29:09.533
> 
> 标签：sql, sql-server

假设我的 MsSql server 2005 服务器中有一个这样的表

```
Apples
 + Id
 + Brand
 + HasWorms 
```

现在我想了解每个品牌中含有蠕虫的苹果数量。
实际上更好的是列出所有带有标志的苹果品牌，无论它们是否未受破坏。

所以如果我有数据

```
ID| Brand        | HasWorms
---------------------------
1 | Granny Smith | 1
2 | Granny Smith | 0
3 | Granny Smith | 1
4 | Jonagold     | 0
5 | Jonagold     | 0
6 | Gala         | 1
7 | Gala         | 1 
```

我想结束

```
Brand        | IsUnspoiled
--------------------------
Granny Smith | 0
Jonagold     | 1
Gala         | 0 
```

我想我应该先

```
select brand, numberOfSpoiles = 
    case
        when count([someMagic]) > 0 then 1
        else 0
     end
from apples
group by brand 
```

我不能使用 having 子句，因为没有有效条目的品牌将从我的列表中消失（我不会看到条目 Gala）。
然后我认为某种子查询应该这样做，但是我无法将外部（分组）查询的苹果 ID 链接到内部（计数）查询......

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:31:41.090

```
select brand,  case when sum(hasworms)>0 then 0 else 1 end IsUnSpoiled
from apples
group by brand 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:43:50.160

SQL server 版本，我确实被宠坏了，而不是没被宠坏，这样我可以使用 SIGN 函数并使代码更短

表 + 数据（DML + DDL）

```
create table Apples(id int,brand varchar(20),HasWorms bit)

insert Apples values(1,'Granny Smith',1)
insert Apples values(2,'Granny Smith',0)
insert Apples values(3,'Granny Smith',1)
insert Apples values(4,'Jonagold',0)
insert Apples values(5,'Jonagold',0)
insert Apples values(6,'Gala',1)
insert Apples values(7,'Gala',1) 
```

询问

```
select brand, IsSpoiled = sign(sum(convert(int,hasworms)))
from apples
group by brand 
```

输出

```
brand   IsSpoiled
---------------------- 
Gala    1
Granny Smith    1
Jonagold    0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:32:07.860

```
SELECT  brand,
        COALESCE(
        (
        SELECT  TOP 1 0
        FROM    apples ai
        WHERE   ai.brand = ao.brand
                AND hasWorms = 1
        ), 1) AS isUnspoiled
FROM    (
        SELECT  DISTINCT brand
        FROM    apples
        ) ao 
```

如果你有一个索引`(brand, hasWorms)`，这个查询将非常快，因为它不计算聚合，而是在每个品牌中搜索第一个变质的苹果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T15:43:52.530

```
SELECT  Brand, 
        1-MAX(HasWorms) AS IsUnspoiled
FROM    apples
GROUP BY Brand 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:40:04.723

```
SELECT CASE WHEN SUM(HasWorms) > 0 THEN 0 ELSE 1 END AS IsUnspoiled, Brand 
FROM apples 
GROUP BY Brand 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T15:48:11.227

我还没有测试过这个，也许我错过了一些东西。但这不可行吗？

```
SELECT Brand, SUM(CONVERT(int, HasWorms)) AS SpoiledCount
FROM Apples
GROUP BY Brand
ORDER BY SpoiledCount DESC 
```

我假设 HasWorms 是一个位字段，因此是 CONVERT 语句。这应该返回一个品牌列表，其中包含每个品牌的变质苹果数量。您应该在顶部看到最差的（最被宠坏的），在底部看到最好的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T15:56:28.420

有很多方法可以给这只猫剥皮。根据您的 RDBMS，不同的查询将为您提供最佳结果。在我们的 Oracle 机器上，此查询的执行速度比列出的所有其他查询都快，假设您在 Apples 表中有 Brand 索引（Brand 上的索引，HasWorms 甚至更快，但这可能不太可能；取决于您的数据分布，仅 HasWorms 上的索引可能是所有索引中最快的）。它还假设您有一个表“BrandTable”，其中只有品牌：

```
SELECT Brand
     , 1 IsSpoiled
  FROM BrandTable b
 WHERE EXISTS
       ( SELECT 1
           FROM Apples a
          WHERE a.brand = b.brand
            AND a.HasWorms = 1
       )
UNION
SELECT Brand
     , 0
  FROM BrandTable b
 WHERE NOT EXISTS
       ( SELECT 1
           FROM Apples a
          WHERE a.brand = b.brand
            AND a.HasWorms = 1
       )
ORDER BY 1; 
```

# javascript - 从 javascript onclick 发出 ajax 请求

> ID：1002249
> 
> 赞同：1
> 
> 时间：2009-06-16T15:29:18.893
> 
> 标签：javascript, ruby-on-rails, ajax, prototypejs

我习惯于使用 helper 方法 link_to_remote 和朋友来创建链接或按钮，这些链接或按钮将在后台发送 Ajax 请求并更新网页的一些数据。

我有一些哪些背景图像是按钮。我希望他们将 Ajax 请求发送到我的 rails 服务器。我猜想一个 javascript onClick + 发送 Ajax 请求应该可以发挥作用，但我不知道 Prototype 在 Rails 辅助方法下是如何工作的。

我希望这不是一个太蹩脚的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:33:17.077

```
$("my_button").observe('click', function(){
    new Ajax.Request(url, {
                             method: 'get',
                             parameters: { "key": "value" },
                             onSuccess: function(res){
                                // handle the result
                             }
                         });
} 
```

就是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:44:53.607

元素上的方法`observe` 也是，`$()`假设您使用的是 id。如果你有一组用类而不是 id 标记的按钮，你可以使用`$$()`它接受一个 css 选择器并返回一个元素数组。

您可以从中获取结果并对其进行迭代，为每个按钮添加点击行为。

```
$$(".bg_button").each(function(button){
    button.observe('click', function(){
        new Ajax.Request(url, {
                                 method: 'get',
                                 parameters: { key: 'value' },
                                 onSuccess: function(res){
                                    // handle the result
                                 }
                             });
    });
}); 
```

要了解有关原型如何工作的更多信息，请查看[他们的 api 文档](http://www.prototypejs.org/api)。我觉得他们挺好的。

# .net - Lucene.Net 最佳实践

> ID：1002255
> 
> 赞同：34
> 
> 时间：2009-06-16T15:30:07.737
> 
> 标签：.net, indexing, lucene, lucene.net, full-text-indexing

使用 Lucene.Net 的最佳实践是什么？或者我在哪里可以找到一个好的 lucene.net 使用示例？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-16T15:43:42.343

如果你打算使用 Lucene，我会买一本从头到尾的好书。Lucene 的学习曲线非常陡峭（在我看来）。重要的不仅是知道如何*搜索*您的内容，还包括对其进行*索引*。进行基本搜索很容易，但是创建一个包含数百万条数据记录的索引并且仍然能够对其进行闪电般的快速搜索是可能的，但非常困难。没有教程可以教你。

我推荐Michael McCandless、Erik Hatcher 和 Otis Gospodnetić 的[Lucene in Action, Second Edition 。](http://www.manning.com/hatcher3/)虽然它是为 Lucene 而不是 Lucene.NET 编写的，但这应该不是问题，因为术语和 api 基本相同。

但是，如果您只是想快速尝试一下，您可以阅读[此站点](http://www.lucenetutorial.com/)。这个名字说明了一切 ：-）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-16T15:50:50.510

当数据量很大并且需要超快的读取响应时间时，我们经常使用 Lucene.NET。我们通常将我们需要搜索的数据以及允许我们将结果映射回具有剩余详细信息的数据库表的键中粘贴。然后，这允许我们搜索用户（在我们的例子中）检查他们过去的参与。这不仅是用户名搜索，而且是迭代各种详细信息的搜索，试图查找是否存在该用户的任何其他实例（尽管形式不同）。例如，我们查找用户 ID（来自一个系统）、他们来自另一个系统的 ID、可能来自供应商系统的 ID、flash cookie GUID、站点 cookie GUID 等。当我们找到一个标识符时，我们为其他用户实例查找该标识符的其他实例。这使我们能够对进入多个系统之一的用户进行重复数据删除（因为他们每 24 小时只允许他们参与任何系统一次）。在 SQL 中，这个算法（我对此含糊不清）将永远持续下去！在 Lucene.NET 中，它只需不到一秒钟。Lucene 比 SQL Server 有更多的搜索可能性。它最糟糕的事情是写入或更新您的索引。这通常作为一项工作......一次完成。但是，如果您需要写入实时更新它的索引，您需要编写一些巧妙的代码以确保它以锁定的方式写入（考虑使用单例排队），否则您的代码将重叠并爆炸！NET 只需不到一秒钟的时间。Lucene 比 SQL Server 有更多的搜索可能性。它最糟糕的事情是写入或更新您的索引。这通常作为一项工作......一次完成。但是，如果您需要写入实时更新它的索引，您需要编写一些巧妙的代码以确保它以锁定的方式写入（考虑使用单例排队），否则您的代码将重叠并爆炸！NET 只需不到一秒钟的时间。Lucene 比 SQL Server 有更多的搜索可能性。它最糟糕的事情是写入或更新您的索引。这通常作为一项工作......一次完成。但是，如果您需要写入实时更新它的索引，您需要编写一些巧妙的代码以确保它以锁定的方式写入（考虑使用单例排队），否则您的代码将重叠并爆炸！

我在我的书（[ASP.NET 社交网络）中介绍了 Lucene.NET 的用法，您可以](https://rads.stackoverflow.com/amzn/click/com/1847194788)[在这里](http://www.google.com/#hl=en&q=lucene.net+tutorial&aq=0&oq=lucene.net+&aqi=g10&fp=JJ2lHziMUzc)找到很多帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T14:11:08.720

Lucene.NET 的问题在于它没有像标准 (java) Lucene 这样的活跃社区 - 所以它就像总是有效地运行旧版本的 Lucene。虽然我们更喜欢 .NET，但出于这个原因，我们决定使用 Java 版本的 Lucene。如果你也使用 Solr，它很容易集成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-24T15:26:07.263

Simon Green 有一个很好的三部分系列，讲述了他如何设置 Lucene.Net 以使用他的 NHibernate 实现。[第一部分介绍该系列](http://blogs.intesoft.net/post/2008/03/NHibernateSearch-using-Lucene-NET-Full-Text-Index-Part1.aspx)。[第二部分](http://blogs.intesoft.net/post/2008/03/30/NHibernateSearch-using-Lucene-NET-Full-Text-Index-Part2.aspx)和第三[部分](http://blogs.intesoft.net/post/2008/04/26/NHibernateSearch-using-LuceneNET-Full-Text-Index-(Part-3).aspx)讨论了技术细节。

我发现 Lucene.Net 代码示例非常有用，即使我的项目没有使用 NHibernate。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-24T07:13:51.750

'Lucene in Action' 是学习如何索引和如何搜索的最佳书籍。它甚至涵盖了高级搜索技术和编写自定义分析器。尽管这本书是针对 Java 的……我已经使用这本书在 .net 中实现了搜索和索引。

# unit-testing - 嘲讽的目的

> ID：1002257
> 
> 赞同：7
> 
> 时间：2009-06-16T15:30:14.930
> 
> 标签：unit-testing, tdd, mocking, moq, testdrivendesign

嘲讽的目的是什么？

我一直在关注一些使用 NUnit 进行测试和 Moq 进行模拟的 ASP.NET MVC 教程。不过，我对它的嘲笑部分有点不清楚。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-16T15:46:45.163

模拟的目的是**将被测试的类**与其他类隔离开来。

这在上课时很有帮助：

*   连接到外部资源（文件系统、数据库、网络...）
*   设置成本高，或尚不可用（正在开发的硬件）
*   减慢单元测试的执行速度
*   具有不确定的行为
*   有（或者是）一个用户界面

它还使测试错误条件变得更容易，因为您构建模拟对象以便它返回和错误，抛出异常......

mock 可以记录它是如何被调用的（函数调用顺序、参数），这可以通过测试来验证。编辑：例如：您正在测试的方法发送一条消息，例如 IPC。mock对象的方法可以记录它被调用了多少次，他收到的参数（即要发送的消息）。然后测试可以询问模拟对象并断言发送的消息数量，消息的内容......同样，模拟对象可以记录在日志字符串中调用的方法，测试可以检索该字符串并断言在上面。

**不要滥用模拟对象**：测试行为而不是实现，否则单元测试将与代码过于紧密耦合，并且脆弱（重构时中断）。

模拟可以手动编码，也可以由模拟[框架](http://en.wikipedia.org/wiki/List_of_mock_object_frameworks)生成。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-16T15:39:20.763

模拟允许您将被测类与其依赖项隔离开来。通常，您为被测类的每个依赖项创建一个模拟，并设置模拟以返回预期值。然后，您将模拟提供给您的测试类，而不是您的测试类所依赖的类的真实副本。然后，您可以使用模拟框架检查是否对模拟对象进行了预期的调用，以确保您的测试类正常运行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T15:55:17.250

它旨在从组集合中取笑单个实例。在不规则的对象聚会中使用了很多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-16T15:58:18.297

虽然模拟通常被理解为允许隔离被测类，但这不是模拟的重点（存根对此更好）。相反，我们需要看看当一个对象被告知做三件事之一时会发生什么。

1.  直接输出 - 方法调用的结果
2.  内部更改 - 在方法调用期间对类的更改
3.  间接输出 - 被测代码调用不同的类

基于状态的测试完全是关于#1 和#2。#1 通过查看该方法给您的结果。#2 通过访问对象的内部状态。

这给我们留下了#3，我们可以采取两种途径。第一个是使用 Mock，第二个是使用 Test Spy。主要区别在于，在 Mock 上，您在执行被测代码之前创建期望值，然后让 mock 对其进行验证，而在 Test Spy 中，您执行被测代码，然后询问 Test Spy 是否发生了某些操作。

所以总结一下......当你考虑测试一个类的功能时，如果你需要测试间接输出（也就是对另一个类的调用），这就是 Mocking 发挥作用的地方。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-16T15:39:08.343

我也是嘲笑的新手，但我会尝试一下。根据我的经验，模拟有两个主要好处：

*   您可以在实际编写实现之前开始使用对象。您可以定义一个接口并使用模拟在单元测试甚至代码中使用该接口。
*   模拟允许您在单元测试中隔离被测对象。使用模拟对象，您可以完全控制与被测对象交互的任何对象，从而从测试中删除外部依赖项。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-16T15:47:13.227

“模拟”在测试和 TDD 圈子中是一个严重超载的术语。请参阅 Martin Fowler 的文章[Mocks Aren't Stubs](http://www.martinfowler.com/articles/mocksArentStubs.html)。一个“正确的”模拟知道它应该接收什么值，并在它没有得到预期的值时让你知道；这允许您进行交互测试而不是状态测试 - 您验证被测类是否以正确的顺序将正确的消息传递给其协作者。交互测试与传统的状态测试有很大不同，而且很难理解。请记住，交互测试是模拟的重点，这可能会使它们更容易理解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-23T00:56:18.857

另一个答案：

*   存根 = 假对象能够在没有整个真实上下文的情况下运行您的测试

*   Mock = 假对象来记录你的组件的交互并验证这些交互

您可以在一个测试中拥有多个存根，但只有一个 mock，因为如果您有多个 mock，那么您肯定会测试多个功能（并且它违背了 test-one-thing 原则的目的）。

超越基础，Mocks 比传统的测试状态验证更多的是行为验证，传统的状态验证是在对组件进行操作后检查组件的状态（Arrange、Act、Assert with Mocks，它更像是 Arrange、Act、Verify）：

状态验证 Assert.AreEqual(valueExpected,mycomponent.Property); 行为验证：myMock.WasCalled(MyMethod);

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-04-04T11:53:29.147

伟大的实时模拟示例[Bert F](https://stackoverflow.com/users/11296/bert-f)

# 单元测试

想象一下这个系统的单元测试：

```
cook <- waiter <- customer 
```

通常很容易设想测试一个低级组件，例如`cook`：

```
cook <- test driver 
```

测试司机只需点不同的菜，并验证厨师为每个订单返回正确的菜。

更难测试一个中间组件，比如服务员，它利用了其他组件的行为。一个天真的测试人员可能会像测试厨师组件一样测试服务员组件：

```
cook <- waiter <- test driver 
```

试驾员会点不同的菜，并确保服务员返回正确的菜。不幸的是，这意味着对服务员组件的测试可能依赖于厨师组件的正确行为。如果 cook 组件具有任何不利于测试的特性，例如不确定性行为（菜单包括厨师作为一道菜的惊喜）、大量依赖项（厨师不会在没有他的全部员工的情况下做饭）或大量资源（有些菜肴需要昂贵的食材或需要一个小时才能烹饪）。

由于这是一个服务员测试，理想情况下，我们只想测试服务员，而不是厨师。具体来说，我们要确保服务员正确地将客户的订单传达给厨师，并将厨师的食物正确地交付给客户。

[单元测试意味着独立地测试单元，因此更好的方法是使用Fowler 所说的测试替身（假人、存根、假货、模拟）](http://martinfowler.com/articles/mocksArentStubs.html#TheDifferenceBetweenMocksAndStubs)来隔离被测组件（服务员） 。

```
 -----------------------
   |                       |
   v                       |
test cook <- waiter <- test driver 
```

在这里，测试厨师与测试驾驶员“勾结”。理想情况下，被测系统的设计使得测试厨师可以很容易地被替换（[注入](http://en.wikipedia.org/wiki/Dependency_injection)）以与服务员一起工作，而无需更改生产代码（例如，无需更改服务员代码）。

# 模拟对象

现在，测试厨师（测试替身）可以通过不同的方式实现：

*   假厨师 - 使用冷冻晚餐和微波炉假装厨师的人，
*   存根厨师 - 无论您点什么，热狗供应商都会给您热狗，或者
*   模拟厨师 - 一名卧底警察在执行脚本后假装自己是一名厨师进行刺痛行动。

[有关 fakes vs stubs vs mocks vs dummies 的更多细节，](http://martinfowler.com/articles/mocksArentStubs.html#TheDifferenceBetweenMocksAndStubs)请参阅Fowler 的文章，但现在，让我们专注于模拟厨师。

```
 -----------------------
   |                       |
   v                       |
mock cook <- waiter <- test driver 
```

对服务员组件进行单元测试的很大一部分集中在服务员与厨师组件的交互方式上。基于模拟的方法侧重于完全指定正确的交互是什么，并检测何时出错。

模拟对象预先知道在测试期间应该发生什么（例如，将调用它的哪些方法调用等），并且模拟对象知道它应该如何反应（例如，要提供什么返回值）。模拟将表明真正发生的事情是否与应该发生的事情不同。自定义模拟对象可以针对每个测试用例的预期行为进行编码，但是模拟框架努力允许在测试用例中直接清楚、轻松地指示这种行为规范。

围绕基于模拟的测试的对话可能如下所示：

> **试驾员**模拟**厨师**：*期待一份热狗订单并给他这个假热狗作为回应*
> 
> **测试司机**（冒充顾客）给**服务员**：*我想要一个热狗，请*服务员
> **模拟****厨师**：*1 个热狗，请*
> **模拟厨师**给**服务员**：*订购：准备好 1 个热狗（给服务员假热狗）*
> **服务员**来**测试司机**：*这是你的热狗（给测试司机假热狗）*
> 
> **测试驱动程序**：测试成功！

但是由于我们的服务员是新来的，所以可能会发生这种情况：

> **试驾员**模拟**厨师**：*期待一份热狗订单并给他这个假热狗作为回应*
> 
> **测试司机**（冒充顾客）对**服务员**：*我想要一个热狗，请*服务员
> **模拟****厨师**：*1 个汉堡包，请*
> **模拟厨师**停止测试：*我被告知期待热狗订单！*
> 
> **测试驱动程序**注意到问题：测试失败！- 服务员改变了订单

或者

> **试驾员**模拟**厨师**：*期待一份热狗订单并给他这个假热狗作为回应*
> 
> **测试司机**（冒充顾客）给**服务员**：*我想要一个热狗，请*服务员
> **模拟****厨师**：*1 个热狗，请*
> **模拟厨师**给**服务员**：*订购：准备好 1 个热狗（给服务员假热狗）*
> **服务员**来**测试司机**:*这是你的炸薯条（给其他订单的炸薯条给测试司机）*
> 
> **试驾员**注意到意料之外的炸薯条：测试失败！服务员回错菜了

如果没有基于存根的对比示例，可能很难清楚地看到模拟对象和存根之间的区别，但是这个答案已经太长了:-)

另请注意，这是一个非常简单的示例，并且模拟框架允许对组件的预期行为进行一些非常复杂的规范，以支持全面的测试。有大量关于模拟对象和模拟框架的材料以获取更多信息。

# image - 在 MediaWiki 中导出和导入图像

> ID：1002258
> 
> 赞同：13
> 
> 时间：2009-06-16T15:30:20.530
> 
> 标签：image, import, export, mediawiki

如何从 MediaWiki 导出和导入图像？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-01-07T18:14:12.103

# 终端解决方案

MediaWiki 管理员在服务器端可以使用[*维护脚本*](https://www.mediawiki.org/wiki/Manual:Maintenance_scripts)[框架执行](https://www.mediawiki.org/wiki/Manual:Maintenance_scripts)[维护任务](https://www.mediawiki.org/wiki/Manual:Maintenance_scripts)*。新的 Mediawiki 版本在下面描述的任务中运行所有标准脚本，但旧版本有一些错误或没有所有现代脚本：通过 . 检查*版本号*`grep wgVersion includes/DefaultSettings.php`。*

 *注意：所有引用的（下面）脚本也有`--help`选项，例如
`php maintenance/importImages.php --help`

### 原图文件夹

用户通过Special:Upload页面上传文件；管理员可以通过扩展白名单配置允许的文件类型。上传后，文件将存储在文件系统的文件夹中，缩略图存储在专用的缩略图目录中。

Mediawiki 的`images`文件夹可以用`zip -r ~/Mediafiles.zip images`命令压缩，但这个压缩包不太好：

*   有很多有害文件：“已删除文件”和“旧文件”（不是*当前*文件），文件名为`20160627184943!MyFig.png`.，缩略图为`MyFig.png/120px-MyFig.jpg`.

*   对于[数据交换](https://en.wikipedia.org/wiki/Electronic_data_interchange)或长期[保存](https://en.wikipedia.org/wiki/Digital_preservation)的钱包，它是无效的......**丑陋的`images/?/??/*`文件夹格式**不适合，像往常一样“只有一个文件夹中的所有图像文件”。

### 图像导出/导入

对于在 MediaWiki 服务器终端的一个文件夹中“导出和导入”**所有当前图像**，有一个逐步的单一过程。

**步骤 1：使用***dumpUploads*生成图像转储（在需要保存时使用`--local`或`--shared`选项），它会创建一个包含所有正在使用的图像文件名的*txt*列表。

```
mkdir /tmp/workingBackupMediaFiles
php maintenance/dumpUploads.php \
   | sed 's~mwstore://local-backend/local-public~./images~' \
   | xargs cp -t /tmp/workingBackupMediaFiles
zip -r ~/Mediafiles.zip /tmp/workingBackupMediaFiles
rm -r /tmp/workingBackupMediaFiles 
```

`Mediafiles.zip`该命令会在您的用户根目录 ( `~/`)中生成映像备份文件夹的标准 zip 文件。

注意：如果您不担心*丑陋的文件夹结构*，更直接的方法是

```
 php maintenance/dumpUploads.php \
   | sed 's~mwstore://local-backend/local-public~./images~' \
   | zip ~/Mediafiles.zip -@ 
```

根据 Mediawiki 版本，该`--base=./`选项可以正常工作，您可以删除`sed`管道的命令。

**第 2 步：**需要备份？安装图像的副本？...您只需要`Mediafiles.zip`，并且[安装了 Mediawiki](http://www.mediawiki.org/wiki/Installation)，没有内容...如果 Wiki 有内容，请检查文件名冲突 (!) 的问题。另一个问题是文件格式和权限的配置，在新 Wiki 中必须相同或更广泛，请参阅[手册：配置文件上传](https://www.mediawiki.org/wiki/Manual:Configuring_file_uploads)。

**第 3 步：**使用维护工具恢复转储（**到新的 Wiki**）。假设您使用步骤 1 导出并保存在 zip 文件中，

```
 unzip ~/Mediafiles.zip -d /tmp/workingBackupMediaFiles
 php maintenance/importImages.php  /tmp/workingBackupMediaFiles
 rm -r /tmp/workingBackupMediaFiles 
 php maintenance/update.php
 php maintenance/rebuildall.php 
```

就这些。检查并浏览您的新 Wiki 的*Special:NewFiles*。

* * *

### 完全导出或保存

用于导出旧 MediaWiki 的“所有图像和所有文章”，以进行完整备份或[内容保存](https://en.wikipedia.org/wiki/Digital_preservation)。在每一步添加一些程序：

**第 1 步： ...见上面第 1 步...并且，****从旧 Wiki**生成文本内容转储

 **`php maintenance/dumpBackup.php --full | gzip > ~/dumpContent.xml.gz`

注意：代替`--full`您可以使用该 `--current`选项。

**第 2 步：** ......你需要`dumpContent.xml.zip`和`Mediafiles.zip`......来自旧的 Wiki。假设您的`~`文件夹中有两个 zip 文件。

**第 3 步：****在您的新 Wiki 中**运行

 **```
 unzip ~/Mediafiles.zip -d /tmp/workingBackupMediaFiles
 gunzip -c  ~/dumpContent.xml.gz 
   | php maintenance/importDump.php  --no-updates \
   --image-base-path=/tmp/workingBackupMediaFiles
 rm -r /tmp/workingBackupMediaFiles 
 php maintenance/update.php
 php maintenance/rebuildall.php 
```

就这些。还要检查*Special:AllPages*的新 Wiki。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T16:26:14.630

没有像导出页面那样自动导出图像的方法，您必须右键单击它们，然后选择“保存图像”。要获取 Image 页面的历史记录，请使用[Special:Export](http://meta.wikimedia.org/wiki/Help:Export)页面。

要导入图像，请使用 wiki 上的[Special:Upload](http://meta.wikimedia.org/wiki/Help:Upload)页面。如果你有很多，你可以使用[Import Images 脚本。](http://www.mediawiki.org/wiki/Manual:ImportImages.php)注意：您通常必须在 sysop 组中才能上传图像。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-29T03:49:31.030

***- 全部导出：***

您可以使用 [API] 从 MediaWiki 网络获取所有页面和所有图像，即使您不是网络的所有者（当然当所有者没有禁用此功能时）：

**步骤 1**：使用 API 获取[所有页面标题](http://www.mediawiki.org/wiki/API:Allpages)和[所有图像 url](http://www.mediawiki.org/wiki/API:Allimages)。您可以编写一些代码来自动执行此操作。

**第 2 步**：接下来，您使用 [Special:Export] 导出所有带有您获得的标题的页面，并使用`wget`来获取您拥有链接的所有图像（像这样`wget -i img-list.txt`）。

***- 全部导入：***

**第 1 步**：使用 [Special:Import] 导入页面

**第 2 步**：使用 [Manual:ImportImages.php] 导入图像。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T21:54:38.503

有一些海量上传工具可用。

**Commonist** - www.djini.de/software/commonist/

两者都在桌面上运行，并且可以配置为上传到您的本地 wiki（默认情况下，它们是为 Wikipedia 和 Wikimedia commons 配置的）。如果您害怕编辑 .jar 文件的内容，我建议您从 Commonplace 开始。

Mediawiki 本身存在另一个有用的扩展。

**MultiUpload** - [http://www.mediawiki.org/wiki/Extension:MultiUpload](http://www.mediawiki.org/wiki/Extension:MultiUpload)

此扩展程序允许您将图像放在文件夹中并一次加载它们。如有必要，它支持每个文件的注释，并在完成后清理文件夹。不利的一面是，它需要在服务器端打开一个共享文件夹。

**常见的**-commons.wikimedia.org/wiki/Commons:Tools/Commonplace****

 **曾经可用，但自[2010 年 1 月 13 日起已弃用](https://secure.wikimedia.org/wikipedia/commons/wiki/Commons:Tools/Commonplace)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-12T16:27:19.317

希望这会有所帮助：[http ://www.mediawiki.org/wiki/Manual:ImportImages.php](http://www.mediawiki.org/wiki/Manual:ImportImages.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-18T06:25:06.907

作为[MediaWiki-Japi](http://mediawiki-japi.bitplan.com/index.php/Main_Page)的提交者，我想指出：

对于将包含图像的页面从一个 wiki 推送到另一个[MediaWiki-Japi](https://github.com/WolfgangFahl/Mediawiki-Japi)的用例，现在具有命令行模式，请参阅 [问题 49 - 启用带有页面传输选项的命令行界面](https://github.com/WolfgangFahl/Mediawiki-Japi/issues/49)

否则，您可以将[MediaWiki-Api](https://www.mediawiki.org/wiki/API:Main_page)与您选择的语言一起使用，并使用您在[PushPages.java中找到的功能](https://github.com/WolfgangFahl/Mediawiki-Japi/blob/master/src/main/java/com/bitplan/mediawiki/japi/PushPages.java)

例如

*   [下载](https://github.com/WolfgangFahl/Mediawiki-Japi/blob/master/src/main/java/com/bitplan/mediawiki/japi/PushPages.java#L259)
*   [上传](https://github.com/WolfgangFahl/Mediawiki-Japi/blob/master/src/main/java/com/bitplan/mediawiki/japi/PushPages.java#L246)*******

# c# - C# 中的位移混淆

> ID：1002266
> 
> 赞同：1
> 
> 时间：2009-06-16T15:31:19.343
> 
> 标签：c#, bit-shift

我有一些像这样的旧代码：

```
private int ParseByte(byte theByte)
{
        byte[] bytes = new byte[1];
        bytes[0] = theByte;
        BitArray bits = new BitArray(bytes);

        if (bits[0])
            return 1;
        else
            return 0;
} 
```

它很长，我想我可以像这样修剪它：

```
private int ParseByte(byte theByte)
{
         return theByte >> 7;
} 
```

但是，我没有得到与第一个函数相同的值。该字节包含 00000000 或 10000000。我在这里缺少什么？我是否使用了不正确的运算符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T15:39:45.613

问题是，在第一个函数中， bits[0] 返回最低有效位，但第二个函数返回最高有效位。要修改第二个函数以获取最低有效位：

```
private int ParseByte(byte theByte)
{
    return theByte & 00000001;
} 
```

要修改第一个函数以返回最高有效位，您应该使用 bits[7]——而不是 bits[0]。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:43:10.800

第一个片段的等效函数是：

```
return theByte & 1 == 1 
```

在第二个片段中，您是最重要的位，而在第一个片段中是最不重要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:43:23.843

你想返回int还是string？无论如何-您可以使用模数：

```
return theByte % 2 == 0 ? "0" : "1" 
```

好的，你编辑了......并且想要返回 int

对您的移位操作说一句话：您必须使用 << 而不是 >>。但这会返回（当您转换为 byte 而不是 int 时）0 或 128 而不是 0 或 1。因此您可以将第二个解决方案重写为：

```
return (byte)(theByte << 7) == 128 ? 1 : 0; 
```

但其他答案包含比这更好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:34:42.783

也许第一个函数应该检查 bits[7] ？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:38:28.627

你的二进制数中有一个额外的零（每个都有 9 位数字）。我假设这只是一个错字。

你确定你的订单正确吗？二进制传统上是从右到左书写的，而不是像大多数其他编号系统那样从左到右书写。如果您显示的二进制数是属性格式的（这意味着这`10000000`实际上是 number`128`而不是 number `1`），那么您的第一个代码片段应该不起作用，而第二个应该起作用。如果你倒着写（意思`10000000`是`1`，不是`128`），那么你甚至不需要移位。只需将其与 1 ( `theByte & 1`) 相加。

事实上，无论采用哪种方法，按位 AND（`&`运算符）似乎更合适。鉴于您的第一个功能有效而第二个无效，我假设您只是将数字倒写并需要与 1 进行 AND 运算，如上所述。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T15:38:46.847

根据[微软网站](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.copyto.aspx)上的一位用户的说法， BitArray 在内部以大端顺序将位存储到 Int32 中。这可能会导致问题。有关解决方案和更多信息，您可以访问该链接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T15:43:20.053

第一个函数不起作用，因为它试图返回一个字符串而不是一个 int。

但你可能想要的是：

```
 private static int ParseByte(byte theByte)
    {
        return theByte & 1;
    } 
```

但是，您可能还想要这个：

```
 private static string ParseByteB(byte theByte)
    {
        return (theByte & 1).ToString();
    } 
```

# c# - 如何在 C# 中执行 Table SP

> ID：1002269
> 
> 赞同：2
> 
> 时间：2009-06-16T15:31:59.247
> 
> 标签：c#, sql, user-defined-types

我查看了 SQLTeam 网站，但现在遇到了一个新问题，因为我有一个 IDENTITY 列，而他们的示例没有。

我有 SQL Server 2008 和 VS 2008。我正在尝试使用 C# 和表 UDT 执行 InsertPIF SP，但出现异常。我查看了一个带有 Table UDT 的 SQLTeam 网站示例，但他们的示例没有像我这样的标识列。

但是，他们的示例表没有像我这样的标识列。我想做的应该很简单。我已经尝试了许多不同的变体，但本质上是：

```
ALTER PROCEDURE [dbo].[InsertPIF] @InputFileParam parseInputFile READONLY
AS
INSERT dbo.ParentTable SELECT strRow FROM @InputFileParam
GO 
```

在哪里

```
CREATE TABLE [dbo].[ParentTable](
    [ParentID] [int] IDENTITY(1,1) NOT NULL,
    [strInput] [varchar](8000) NULL,
PRIMARY KEY NONCLUSTERED 
(...) 
```

并输入：

```
CREATE TYPE [dbo].[parseInputFile] AS TABLE(
    [NumCols] [int] IDENTITY(1,1) NOT NULL,
    [strRow] [varchar](500) NOT NULL,
    PRIMARY KEY CLUSTERED 
(...) 
```

我想要做的是执行上面的 SP 将新记录插入到 ParentTable 中。例子：

```
INSERT INTO ParentTable(strInput) VALUES ('A3|BB|C|DDD')
INSERT INTO ParentTable(strInput) VALUES ('A4|GOB|BLDY|GOOK')
INSERT INTO ParentTable(strInput) VALUES ('A5|Hello|My|Darling') 
```

这是 AppendData 部分之前的更多 C# 代码：

```
DataTable dt = new DataTable();
String[] header = myStringArray[0].Split('|');

DataRow dr = dt.NewRow();
DataColumn dc = new DataColumn();
dc.DataType = typeof(Int32);
dc.ColumnName = “NumCols”;
dc.AutoIncrement=true;
dt.Columns.Add(dc);

DataColumn dc2 = new DataColumn();
dc2.DataType = typeof(string);
dc2.ColumnName = “strRow”;
dt.Columns.Add(dc2);
dr["NumCols"] = 1;
dr["strRow"] = "AA|BBB|CC|DD|E";
dt.Rows.Add(dr);

...
                SqlConnection conn = new SqlConnection(connString);
                SqlCommand cmd = conn.CreateCommand();
                cmd.CommandText = "dbo.InsertPIF";
                cmd.CommandType = CommandType.StoredProcedure;
                cmd.Connection = conn;
                SqlParameter param = cmd.Parameters.AddWithValue("@InputFileParam", SqlDbType.Structured);

        param.Value = dt;
        conn.Open();
        RowsAffected = cmd.ExecuteNonQuery(); 
```

我将身份设置为打开`ParentTable`，但似乎我必须在每个会话中执行此操作，所以我不确定如何删除身份要求或使身份保持打开状态。例外：

插入到表变量上不允许的标识列。表值参数“@InputFileParam”的数据不符合参数的表类型。

如何执行此 SP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:59:36.783

好的，我实际上还没有与 TVP 合作过，所以我可能是错的——但从我的阅读和一般 SS 背景来看，我*认为*你的问题是：

您的永久表有一个标识列，因此 SS 想为您处理它。您*可以*设置身份插入，但这不是一个好主意....

要尝试的一件事是指定要在 SP 中插入的列：

```
ALTER PROCEDURE [dbo].[InsertPIF] @InputFileParam parseInputFile READONLY
AS
INSERT dbo.ParentTable (strInput) SELECT strRow FROM @InputFileParam
GO 
```

正如蒂姆·伦汀（Tim Lentine）所建议的（当我写这个答案时），另一件要考虑的事情是你是否真的进入了服务器。由于您已将 DataTable 中的 NumCols 列定义为 AutoIncrement，因此可能是您在 C# 代码中遇到了异常，位于：

```
...
dr["NumCols"] = 1;
... 
```

<编辑>

不知道点击提交时我在想什么...

如果是这种情况，请在创建 DataTable 时尝试省略 AutoIncrement。如果*列数据类型*一致，则在将 TVP 排列为与 SS 类型“相同”时，此属性应该无关紧要。

</编辑>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T17:22:32.790

我认为 Roland 走在正确的轨道上 - IDENTITY 列肯定是问题所在。由于您的最终目标表已经有一个 IDENTITY 列，它将自动为您填充，我建议不要在用户定义的表类型中指定相同的列（也不要在表类型上声明主键）：

```
CREATE TYPE [dbo].[parseInputFile] AS TABLE
    ([strRow] [varchar](500) NOT NULL) 
```

然后在您的 C# 代码中，只需设置一个带有单列的 DataTable：

```
DataTable dt = new DataTable();

DataColumn dc = new DataColumn();
dc.DataType = typeof(string);
dc.ColumnName = “strRow”;
dt.Columns.Add(dc); 
```

然后将您的列添加到您的数据表“dt”中 - 只有一个字符串“strRow”。

在您使用用户定义的表类型调用的存储过程中，只需插入您的字符串：

```
ALTER PROCEDURE [dbo].[InsertPIF] @InputFileParam parseInputFile READONLY
AS
  INSERT INTO dbo.ParentTable(strInput)
    SELECT strRow FROM @InputFileParam
GO 
```

应该这样做，我希望！（自己没有时间测试这个）

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:51:06.703

错误可能来自 parseInputFile 表吗？NumCols 被定义为一个标识字段，但在 C# 代码中，您将记录的值设置为 1。

# windows - 选择“打开方式...”选项时，操作系统如何知道如何处理文件？

> ID：1002270
> 
> 赞同：0
> 
> 时间：2009-06-16T15:32:00.450
> 
> 标签：windows, file, operating-system

说明：我不记得 Linux 和 OS X，但在 Windows 中，您可以右键单击一个文件并选择一个程序来打开它。但是操作系统如何确切地知道如何让程序打开它呢？它是否跟踪程序的“打开文件”对话框？开发人员是否必须为这些情况指定一个特殊的事件处理程序或其他东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:40:39.357

对于 Windows，答案在注册表中。如果您习惯阅读注册表，请在您的 Windows 机器上运行 regedit.exe。

在 HKEY_CLASSES_ROOT 下，您将看到所有文件类型、.doc、.txt 等的密钥列表。这些密钥中的每一个都包含一个名为“OpenWithList”或“OpenWithProgIds”的密钥。应用程序可能有一个注册的“ProgId”，也可以在 HKEY_CLASSES_ROOT 下找到，它可以将它的 ProgId 注册到它想要在 OpenWithProgIds 中处理的文件类型。否则它会在 OpenWithList 中注册自己。

回应对第一个答案的评论（因为我没有足够的代表发表评论）：

您正在考虑 DDE，这是一种几乎已被弃用的技​​术。Windows shell 以所选文件作为第一个参数来执行应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:36:13.967

Windows 资源管理器会根据以下键中的文件扩展名记住您之前的“打开方式...”选项：

```
HKCR\.ext\OpenWithList

```

下次您右键单击该文件时，它会在那里查找并构建您以前用于打开特定文件类型的程序列表。

假设它找到了一个名为“myapp.exe”的键。然后它在此处查找应用程序：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Applications\myapp.exe

```

获取安装应用程序的信息。它在这里：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\myapp.exe

```

按照存储在那里的 GUID 找出应用程序的显示名称。

为了增加乐趣，主要关联的应用程序也在列表中，`OpenWithProgIds`键中的所有内容和所有内容：

```
HKEY_CLASSES_ROOT\*\OpenWithList

```

以及他们各自的`HKEY_CURRENT_USER`同行。

然后将生成的应用程序列表设为唯一、排序和显示。选择后，文件将像您单击的任何其他文件一样启动 - 即：

```
C:\path\to\myapp.exe "C:\path\to\the\file.ext"

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:44:06.710

只是出于一些怀旧之情，相当出色的[Acorn 阿基米德](http://en.wikipedia.org/wiki/Acorn_Archimedes)有一个更好的系统，每种文​​件类型都有一个唯一的类型编号，以及随文件写入的制造商和应用程序代码（更像是 MAC 地址）。
这意味着您可以使用正确的应用程序打开所有名为 .bak 的不同文件 - 不像 Windows 的情况，新安装的应用程序会窃取该类型的每个现有文件的所有权。Autocad 在这方面尤其糟糕，注册了大约 20 种文件类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:36:18.210

[http://windowsxp.mvps.org/OpenWith.htm](http://windowsxp.mvps.org/OpenWith.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:37:51.450

文件关联存储在注册表中：HKEY_CLASSES_ROOT。

您可以使用 Windows 资源管理器以图形方式管理它们：(WinXP)

单击工具/选项/文件类型

或者使用控制面板中的“默认程序”小程序。（远景）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-16T15:54:18.390

操作系统运行指定的程序，将要打开的文件的路径作为参数发送。

例如，在 C# 中，如果您想知道操作系统希望您打开哪个文件，您需要执行以下操作：

```
class Program
{
    static void Main(string[] args)
    {
        if (args.Length == 1) //The OS wants me to open a file
            openSomeFileJustBecauseTheOSWantsIt(args[0]);
    }
} 
```

# asp.net-mvc - ASP.Net MVC 和 jQuery 表单插件上传文件

> ID：1002274
> 
> 赞同：4
> 
> 时间：2009-06-16T15:32:18.513
> 
> 标签：asp.net-mvc, jquery

有人可以给我一个如何使用 ASP.Net MVC 执行此操作的示例吗？我已经按照他们[网站](http://malsup.com/jquery/form/#code-samples)上文件上传选项卡上的示例进行操作，但我无法得到体面的回复。我的控制器认为它不是 AJAXRequest 并尝试执行 RedirectToAction 但这不会在发布后更改页面。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-08-21T00:23:52.127

[我在这里](http://aspzone.com/tech/jquery-file-upload-in-asp-net-mvc-without-using-flash/)写了一篇关于如何做到这一点的博客文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:41:33.143

试试这个我的朋友：[http ://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx](http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:42:36.450

上传不是 AJAX 请求，它明确指出您不能使用 XMLHttpRequest 对象进行文件上传，因此它使用 iframe 作为目标来完成。尝试像处理正常的非 AJAX 提交一样处理上传。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-06-18T14:26:05.460

答：不能使用 AJAX 或使用 iFrame

# java - 如何在 Java 中进行扩展

> ID：1002276
> 
> 赞同：3
> 
> 时间：2009-06-16T15:32:27.030
> 
> 标签：java, video-processing

我有 100 多个视频流频道可以同时处理。我需要捕捉视频，生成缩略图，并将它们作为 Web 服务提供。对于缩略图的生成，我可以使用 JMF 等（我注意到还有另一篇文章讨论了如何生成和访问：[从较大的图像文件中获得更好质量的缩略图](https://stackoverflow.com/questions/772715/better-quality-thumbnails-from-larger-image-files)）。但我担心的是：如何扩展？Java EE EJB 还是简单的 Java SE 线程？有什么缺点和优点？如何使用 EJB 进行水平扩展？

我对可扩展性问题不太熟悉，非常感谢您的友好建议。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T16:24:40.310

同意...线程应该有助于在单台机器上扩展。如果你想在不同的机器上进行扩展 - 使用 Terracotta。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:44:59.377

Java SE 线程可以帮助您在单台机器上扩展，但如果您需要在不同机器上水平扩展，EJB 将是一种方法。

如果是我，我可能会将其分配到一个单独的 Web 服务层，该层可以根据需要在尽可能多的机器上运行，然后在这些机器之间进行负载平衡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:58:59.303

我看不出在这种情况下使用 EJB 的理由。你必须问自己瓶颈在哪里。我的赌注是视频处理。我会分析您的应用程序并查看在等待时间片的时间多于处理时间之前可以处理多少线程。在某个点之后添加更多线程不会增加更多吞吐量。到那时，您就知道一台机器会做什么以及需要多少台机器才能维持一定的吞吐量。如何跨机器扩展是另一个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-02T22:04:25.017

留下正式的 J2EE 堆栈。

而是一个很好的消息队列，它将 JMS 与运行 Y 个线程的 X 个 JVM 作为消费者进行对话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T18:45:19.077

这是两个截然不同的问题。

捕获/处理听起来像是渲染农场的问题。这些都是水平缩放的。大多数解决方案都涉及作业队列，您甚至不需要在 Java 中执行此操作；只需找到您喜欢的简单解决方案即可。“render farm ffmpeg”或类似的东西应该在谷歌中产生结果。

您的“作为 Web 服务提供”部分有些不确定。如果您希望这些视频可以访问，您可能只需将它们放在 HTTP 服务器上 - 这些可以轻松进行负载平衡，因此可以水平扩展 - 存储速度或网络带宽可能是您的第一个瓶颈。

# wpf - XAML 中是否有类似 XPath 的语法可以从集合中获取项目？

> ID：1002292
> 
> 赞同：1
> 
> 时间：2009-06-16T15:36:19.817
> 
> 标签：wpf, xml, xaml, binding

我的 ViewModel 中有一个 Dictionary 对象，其中的键/值可以翻译视图上的单词。

可以将语言信息作为**XML 对象**获取，然后使用 XPath 挑选出翻译后的短语，如下所示：

```
<TextBlock DataContext="{TranslatorDictionaryXml}" Text="{Binding XPath=/terms/term[key='edit']/value[@lang='en-US']}"/> 
```

但是是否有类似的方法可以使用提供某种类似 XPath 语法的**非 XML 对象来执行此操作，例如**

伪代码：

```
<TextBlock DataContext="{CurrentLanguageTranslatorDictionary}" Text="{Binding path=Key['edit']}"/> 
```

我不想将集合绑定到 ListView 或任何其他集合元素，但想将一个 Translator 对象绑定到**单个 TextBlocks 和 TextBoxes 和 ToolTips**等，然后使用某种路径语法来获取特定项目的绑定集合。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:17:48.017

[是的，您可以两者都做， Binding](http://msdn.microsoft.com/en-us/library/system.windows.data.binding_members.aspx)上也有一个 XPath 属性。[这里](http://msdn.microsoft.com/en-us/library/ms749287.aspx)有一些很好的示例，以及整个[绑定操作](http://msdn.microsoft.com/en-us/library/ms752039.aspx)示例。您也[可以使用集合的索引器](http://sachabarber.net/?p=219)来执行此操作，但它不需要单引号或转义引号。

```
<TextBox Text="{Binding Path=Countries[US]}" />

public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();

        Countries = new Dictionary<string, string>();
        Countries.Add("US", "United States");
        Countries.Add("CA", "Canada");

        this.DataContext = this;
    }

    public Dictionary<string, string> Countries { get; set; }
} 
```

# ios - 一个 UIViewController，可以同时代表一个pickerview 和一个动画视图吗？

> ID：1002294
> 
> 赞同：1
> 
> 时间：2009-06-16T15:37:09.893
> 
> 标签：ios, objective-c, cocoa-touch, delegates

我有一个mainViewController，它也是mainView 中包含的pickerview 的代表。

我还有另一个包含封面流的视图。我想将封面流添加到我的主视图中，并将 mainViewController 设为委托。我不知道这是否可能。我使用以下方法没有成功：

```
@interface MainViewController : UIViewController <UIPickerViewDataSource,
                                UIPickerViewDelegate, FlowCoverViewDelegate> 
```

我不知道这只是语法问题还是我需要做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:49:48.217

我不完全理解什么是coverflow :) 但是要将 MainViewController 声明为委托，您需要使用以下内容：

```
@interface MainViewController: UIViewController<UIPickerViewDelegate, AnyOtherDelegate1, AnyOtherDelegate2, AnyOtherDelegate3> 
```

# javascript - 为什么 JavaScript CSS 类会破坏这个脚本？

> ID：1002295
> 
> 赞同：3
> 
> 时间：2009-06-16T15:37:10.610
> 
> 标签：javascript, css

这是脚本-

```
<script language=javascript>
function apply()
{
  document.form1.sub.disabled=true;
  if(document.form1.chk.checked==true)
  {
    document.form1.sub.disabled=false;
  }
  if(document.form1.chk.checked==false)
  {
    document.form1.sub.enabled=false;
  }
}
</script> 
```

如果我使用这个 html 它不起作用——

```
<input class="field checkbox" type="checkbox" name="chk" onClick="apply()" value="accept" /> 
```

然而，这也行不通——

```
<input class="field" type="checkbox" name="chk" onClick="apply()" value="accept" /> 
```

但这确实有效——

```
<input class="checkbox" type="checkbox" name="chk" onClick="apply()" value="accept" /> 
```

因此，如果类“字段”在那里，它会破坏 JS。我当然可以取出来，但我想知道为什么它不起作用？

谢谢！

**编辑** 对不起伙计们，这是整个页面。CSS只是控制元素的位置，据我所知它不应该干扰JS......？-

```
<?php
session_start();
if(!isset($_SESSION['referrer'])){
    //get the referrer
    if ($_SERVER['HTTP_REFERER']){
        $referrer = $_SERVER['HTTP_REFERER'];
    } else {
        $referrer = "unknown";
}
//save it in a session
$_SESSION[’referrer’] = $referrer; // store session data
}

//grab campaign var from url
$campaign = $_GET['campaign'];

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<title>Beerfest Packages Sweepstakes - Blue Ridge Country</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="scripts/wufoo.js"></script>
<link rel="stylesheet" href="css/structure.css" type="text/css" />
<link rel="stylesheet" href="css/form.css" type="text/css" />
<link rel="stylesheet" href="css/theme.css" type="text/css" />
<script language=javascript>
function apply()
{
  document.form1.sub.disabled=true;
  if(document.form1.chk.checked==true)
  {
    document.form1.sub.disabled=false;
  }
  if(document.form1.chk.checked==false)
  {
    document.form1.sub.enabled=false;
  }
}
</script>  
</head>

<body id="public">

<img id="top" src="images/top.png" alt="" />
<div id="container">

<h1><a href="">Wufoo</a></h1>

<form class="wufoo" action="insert.php" method="post" name="form1">

    <div class="info">
        <h2>Register to Win &amp; Subscribe to Blue Ridge Country</h2>
        <div>Now's your chance to not only register to win our free beerfest tickets and getaway, but also receive the #1 magazine in the Blue Ridge Mountains!</div>
    </div>

    <ul>

    <li class="section first">
        <h3>Your information</h3>
        <div>Whether you're registering to win or subscribing to the magazine (or both!) we need your info!</div>
    </li>

    <li>
    <label class="desc">Name <span class="req">*</span></label>
        <span>
        <input class="field text" size="8" value=""/>
        <label>First</label>
        </span>

        <span>
        <input class="field text" size="3" value=""/>
        <label>M.I.</label>
        </span>

        <span>
        <input class="field text" size="14" value=""/>
        <label>Last</label>
        </span>
    </li>
    <li>
    <label class="desc">Email <span class="req">*</span></label>
        <div>
        <input class="field text medium" type="text" name="email" maxlength="100" value="" /> 
        </div>
        <p class="instruct">Don't worry, we won't spam you, share or sell your email address!</p>
    </li>    
    <li>
    <label class="desc">Address <span class="req">*</span></label>
        <div>
        <input class="field text medium" type="text" maxlength="100" value="" /> 
        </div>
    </li>
    <li>
        <span>
        <input class="field text" size="15" value="" />
        <label>City</label>
        </span>

        <span>
        <input class="field text" size="2" value="" />
        <label>State</label>
        </span>

        <span>
        <input class="field text" size="5" maxlength="10" value="" />
        <label>Zip</label>
        </span>
    </li>

    <li>
    <label class="desc">Phone <span class="req">*</span></label>
        <span>
        <input class="field text" type="text" size="3" maxlength="3" value=""/> - 
        <label>Area</label>
        </span>

        <span>
        <input class="field text" type="text" size="8" maxlength="8" value=""/>
        <label>Phone</label>
        </span>
    </li>    

    <li class="section">
        <h3>Legal mumbo jumbo</h3>
        <div>Don't worry, you're almost done and this is the last bit we need from you!</div>
    </li>

    <li>
    <label class="desc">Official Rules <span class="req">*</span></label>
        <div>
        <textarea rows="10" cols="50" class="field textarea medium" readonly="readonly" style="font-size: 0.8em;">1\. To enter, complete an online request by submitting this completed form. Or, send a stamped, self-addressed envelope to: "Blue Ridge Country Beerfest Promotion," Leisure Publishing, PO Box 21535, Roanoke, VA 24018, requesting an entry form. Limited to one entry per household. Entries must be received by June 30, 2009\. 2\. Reservation procedures to come with notification of winning. Package not available during holidays and special events. Notification of prizes will be sent to winners at the email address on the entry form. The odds of winning will depend upon the number of entries. 3\. All prizes will be awarded to winners selected by random drawing from all valid entries received. Drawing will be conducted by Leisure Publishing Inc., an independent publisher, whose decisions are final on all matters relating to this sweepstakes. Winners will be notified by email to the address provided on the entry form. Only one prize to a family or household. Due to the nature of this competition, you must be 21 or older to win. Proof of age will be required prior to receiving free tickets to alcohol-related events. 4\. Sweepstakes is open to all residents of the U.S. and Canada except advertisers, their employees, their advertising and promotion agencies, and the families of each. Void wherever taxed, restricted or prohibited by law. Prizes are not transferable; may not be exchanged or substituted; cannot be redeemed for cash; must be taken in their entirety; no substitutions permitted. Taxes, if any, are the responsibility of the individual winners. 5\. Entry in sweepstakes constitutes permission to use winners’ names and photograph for advertising and publicity purposes, without further compensation to winners. For names of prize winners, send a stamped, self-addressed envelope to: "Blue Ridge Country Beerfest Promotion" — Winners, P.O. Box 21535, Roanoke, VA 24018.</textarea>
        </div>
    </li>

    <li class="section">
        <h3>Subscribe / Win!</h3>
        <div>While you don't have to subscribe to win, we hope you will!</div>
    </li>

    <li>
    <label class="desc">Sweepstakes Selection</label>
        <div class="col">
        <span><input id="choice1" name="mc" class="field radio" type="radio" value="Robots" checked="checked" />
        <label class="choice" for="choice1">Robots</label></span>

        <span><input id="choice2" name="mc" class="field radio" type="radio" value="Monkeys"/>
        <label class="choice" for="choice2">Monkeys</label></span>
        </div>
    </li>

    <li>
    <label class="desc">Official Rules</label>
        <div class="col">
        <span><input class="checkbox" type="checkbox" name="chk" onClick="apply()" value="accept" />
        <label class="choice">I accept the terms and conditions from the "Official Rules" above.</label></span>
        </div>
    </li>    

    <li class="buttons">
        <input id="saveForm" class="btTxt" type="submit" name="sub" value="Submit" disabled="disabled" />
    </li>
    </ul>

    <div style="display: none;">
        <input type="hidden" name="referrer" value="<?php echo $referrer; ?>" />
        <input type="hidden" name="campaignID" value="<?php echo $campaign; ?>" />
    </div>

</form>

</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:51:17.140

无需等待您的编辑，我几乎可以保证问题出在您页面上的其他一些 JS 代码中，这些代码正在将状态更改为您认为的其他内容。我根本无法看到这与 CSS 相关。我建议您检查 DOM 并浏览在 firebug 中执行的方法。

而且我还会打赌你的函数应该被重写：

```
function apply()
{
  with(document.form1) { sub.disabled = !chk.checked; }
} 
```

# subsonic - 带有 MS SQL 2008 的 SubSonic？

> ID：1002296
> 
> 赞同：3
> 
> 时间：2009-06-16T15:37:20.267
> 
> 标签：subsonic

我已经在 MS SQL 2005 中使用 subsonic 大约一年了。对于那些已经迁移到 SQL 2008 的人，亚音速是否与它兼容？您是否在使用 SQL 2008 的 SubSonic 时遇到了太多问题？只是想感受一下我此时是否应该升级到 SQL 2008。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T15:43:05.653

我自己没有使用过 SQL2008，但我知道 SubSonic 2.1 和 2.2 在处理新的仅限日期和仅限时间的数据类型（它将它们视为字符串）方面仍然存在错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T22:28:48.940

SubSonic 与 Sql Server 2008 配合得很好。如果您担心，可以下载源代码并添加对项目的引用，以便修复出现的任何错误。

如果你下载 2.2（它应该被命名为 2.1.1，因为它是一个小错误修复版本）你会注意到 Sql Server 2008 提供程序继承自 2005 提供程序，我相信它只覆盖了一个函数，这意味着有非常它们之间几乎没有什么不同，尽管如果遇到错误，您总是可以修复任何需要修复的东西（我在开发中没有遇到任何问题，我使用 SQL Server 2008）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T15:52:43.287

我在当前项目中使用（嗯，正在使用）SubSonic 和 MSSQL 2008 和 2005。MSSQL 2005 和 MSSQL 2008 都使用相同的代码库。我还没有遇到任何问题（也就是说，没有任何问题只发生在任一平台上）。

我相信 SubSonic 不支持 MSSQL 2008 独有的任何功能，但如果您是从 2005 迁移，这应该不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-22T12:10:23.327

Subsonic 不支持 MSSQL 2008 的所有新数据类型。例如，我遇到了地理问题

# c# - Silverlight问题的路径元素

> ID：1002315
> 
> 赞同：0
> 
> 时间：2009-06-16T15:40:31.743
> 
> 标签：c#, xaml, silverlight

假设我有以下 XAML 代码。我的困惑是：

1.  我不知道数据属性的确切含义，尤其是以字母 M/C 开头的项目。
2.  TransformGroup 没有特殊配置（全部使用默认设置）？为什么把 TransformGroup 放在这里？

```
<Path Height="2.75" 
    Width="2.75" 
    Data="M2.75,1.375 C2.75,2.1343915 2.1343915,2.75 1.375,2.75 C0.61560845,2.75 0,2.1343915 0,1.375 C0,0.61560845 0.61560845,0 1.375,0 C2.1343915,0 2.75,0.61560845 2.75,1.375 z" 
    Fill="#FF9F9B9B" 
    Stretch="Fill" 
    Stroke="#FF000000" 
    StrokeThickness="0" 
    Canvas.Top="7" 
    x:Name="p3">
    <Path.RenderTransform>
        <TransformGroup>
            <ScaleTransform/>
            <SkewTransform/>
            <RotateTransform/>
            <TranslateTransform/>
        </TransformGroup>
    </Path.RenderTransform>
</Path> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:49:33.270

1）M：移动，L：直线，C：曲线等。查看[本教程](http://www.aspfree.com/c/a/BrainDump/Silverlight-and-XAML-Basics/)。

2）那只是添加的，没有用。

我建议您将 XAML 加载到 XAML 编辑器中，您将看到这些操作。在没有所见即所得编辑器的情况下编写/理解 XAML 是一件很可怕的事情。

# jquery - 如何从 jQuery 选择中排除这些元素？

> ID：1002319
> 
> 赞同：7
> 
> 时间：2009-06-16T15:41:05.297
> 
> 标签：jquery, css-selectors

### 我的 jQuery：

```
$("ul.dropdown ul").slideDown("slow");
$("ul.dropdown ul ul").children().hide(); 
```

这会导致与第二个选择器匹配的选择器显示一小段时间。如何从第一组中排除第二组，只显示第一组？

* * *

### 我的 HTML：

```
 <ul class="dropdown">
        <li style="margin: 0px">
            <span id="header">
                <img src="back.gif" alt='background' style="border:none;" />                        
                <span style="position: absolute; top: 5px; left: 2px;">
                    <img src="button.gif" style="border:none;" />
                </span>                 
                <span style=" position: absolute; top: -5px; left: 70px;">
                    <p style="background-color: white; width: 200px; height: 20px; font-size: 1.2em; border: 2px solid blue">Menu</p>
                </span>
            </span>
            <ul class="sub_menu">
                 <li><a href="#">Artificial Turf</a></li>
                 <li><a href="#">blah</a></li>
                 <li id="1">
                    <a id="1.1" href="#">Batting Cages</a>
                    <ul id="2">
                        <li><a href="#">Indoor</a></li>
                        <li><a href="#">Outdoor</a></li>
                    </ul>
                 </li>
                 <li><a href="#">Benches &amp; Bleachers</a></li>
                 <li><a href="#">Communication Devices</a></li>
                 <li><a href="#">Dugouts</a></li>
                 <li><a href="#">Fencing &amp; Windscreen</a></li>
                 <li><a href="#">Floor Protectors</a></li>
                 <li><a href="#">Foul Poles</a></li>
                 <li><a href="#">Netting</a></li>
                 <li><a href="#">Outdoor Furniture &amp; Storage</a></li>
                 <li><a href="#">Outdoor Signs</a></li>
                 <li><a href="#">Padding</a></li>
                 <li><a href="#">Scoreboards</a></li>
                 <li><a href="#">Shade Structures</a></li>
                 <li><a href="#"> - VIEW ALL - </a></li>
            </ul>
        </li>
    </ul> 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-16T15:53:44.893

这正是['not' 方法](http://docs.jquery.com/Traversing/not#expr)的用途：

```
$('ul.dropdown ul').not('ul.dropdown ul ul').slideDown('slow'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T15:45:11.280

这可能会起作用：

```
$("ul.dropdown > li > ul").slideDown("slow"); 
```

">" 仅表示直接子级 ( [http://docs.jquery.com/Selectors/child#parentchild](http://docs.jquery.com/Selectors/child#parentchild) )。因此，只要您的层次结构是这样的（在您刚才的编辑之后，它似乎确实如此）：

```
<ul>
  <li>
    <ul>
.. 
```

它很可能会起作用。希望相关的变化是显而易见的......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:46:25.630

这可以工作。

```
$("ul.dropdown ul:not(ul > ul)").slideDown("slow");
$("ul.dropdown ul ul").children().hide(); 
```

# sql - 更好的 SQL 查询？

> ID：1002323
> 
> 赞同：3
> 
> 时间：2009-06-16T15:42:45.717
> 
> 标签：sql

数据库结构：

```
fid  
subid  
fieldname  
fieldval 
```

为了得到一个人的记录，我做了这样的事情：

```
$querystr = "
SELECT FN.sub_id, FN.`First Name` , LN.`Last Name` , DOB.`dob` , EMAIL.`email` , PHONE.`phone`  
FROM  
( SELECT sub_id, field_val AS 'First Name'
FROM $db->data
WHERE `field_name` = 'First Name'
)FN,   
(  SELECT sub_id, field_val AS 'Last Name'
FROM $db->data
WHERE `field_name` = 'Last Name'
)LN,  
( SELECT sub_id, field_val AS `Team`
FROM $db->data
WHERE `field_name` = 'Team'
)TEAM,  
( SELECT sub_id, field_val AS `dob`
FROM $db->data
WHERE `field_name` = 'DOB'
)DOB,  
( SELECT sub_id, field_val AS `email`
FROM $db->data
WHERE `field_name` = 'EMail'
)EMAIL,  
( SELECT sub_id, field_val AS `phone`
FROM $db->data
WHERE `field_name` = 'Telephone'
)PHONE  

WHERE FN.sub_id = LN.sub_id  
AND LN.sub_id = DOB.sub_id  
and DOB.sub_id = EMAIL.sub_id  
and EMAIL.sub_id = PHONE.sub_id  
ORDER BY LN.`Last Name`  
 "; 
```

关于如何简化这一点的任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T15:47:32.710

您可以使这些表的许多自连接`data`更加明确，这使查询更具可读性，但很可能不会影响速度。IE：

```
SELECT FN.sub_id, FN.field_val AS `First Name`, 
                  LN.field_val AS `Last Name`, 
                  DOB.field_val AS `dob`, 
                  EMAIL.field_val AS `email`, 
                  PHONE.field_val AS `phone`  
FROM  $db->data FN
JOIN  $db->data LN ON (LN.field_name = 'Last Name' AND LN.sub_id = FN.sub_id)
JOIN  $db->data TEAM ON (TEAM.field_name = 'Team' AND TEAM.sub_id = FN.sub_id)
JOIN  $db->data DOB ON (DOB.field_name = 'DOB' AND DOB.sub_id = FN.sub_id)
JOIN  $db->data EMAIL ON (EMAIL.field_name = 'EMail' AND EMAIL.sub_id = FN.sub_id)
JOIN  $db->data PHONE ON (PHONE.field_name = 'Telephone' AND PHONE.sub_id = FN.sub_id)
WHERE FN.field_name = 'First Name'
ORDER BY LN.field_val 
```

基本上，许多乏味的自联接是您为表的这种“灵活”组织作为属性名称和值的集合所付出的代价。

顺便说一句，如果某个 sub_id 的某些数据可能丢失，并且您仍希望在输出中看到该行（缺少的数据为 NULL），请使用 LEFT JOIN 而不是普通 JOIN 作为该字段的数据实例以上查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:51:37.517

如果可能的话，我会尝试更改您的数据库架构，并制作一个包含所有这些属性（名字、姓氏、团队等）的 Person 表；对于以后可能想要维护它的人来说，这将更加直接。这将使编写您的查询变得轻而易举。

当然，我不知道您可能有任何其他要求。我还假设你在说 SQL 的关系数据库上使用它，而不是其他一些数据库类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:55:19.543

```
SELECT FN.sub_id, FN.field_val as `First Name`, LN.field_val as `Last Name`, DOB.field_val as `dob`, EMAIL.field_val as `email`, PHONE.field_val as `phone`
FROM       $db->data FN
INNER JOIN $db->data LN    on LN.sub_id    = FN.sub_id
INNER JOIN $db->data DOB   on DOB.sub_id   = FN.sub_id
INNER JOIN $db->data EMAIL on EMAIL.sub_id = FN.sub_id
INNER JOIN $db->data PHONE on PHONE.sub_id = FN.sub_id
WHERE FN.field_name    = 'First Name'
AND   LN.field_name    = 'Last Name'
AND   DOB.field_name   = 'DOB'
AND   EMAIL.field_name = 'EMail'
AND   PHONE.field_name = 'Telephone'; 
```

（只是展示了 Alex Martelli 的好主意）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T15:57:16.283

使用实际的数据库模式。使用可以“容纳任何东西”的“通用”模式的方法绝对是一个糟糕的想法。令人惊讶的是，这种方法经常被“建筑师”一遍又一遍地“发现”或“设计”。

这通常被描述为[EAV（实体-属性-值）](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model)模式。您只需要四张桌子，然后您的痛苦就开始了：

```
* objects
* attributes
* object_attributes (objects is 1:M with object_attributes)
* links (links objects to objects, an association table) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:56:04.257

就像羊模拟器一样，我强烈建议您更新数据模型，其中每个字段实际上都是它自己的*列*。否则，如果您的 RDBMS 支持它，使用这样的子选择可能会更快，特别是如果您实际上在末尾使用 where 子句限制结果集：

```
select
    s.field_val as `First Name`,
    (select field_val from $db->data as i where field_name = 'Last Name' and i.sub_id = s.sub_id) as `Last Name`,
    (select field_val from $db->data as i where field_name = 'Team' and i.sub_id = s.sub_id) as `Team`,
    (select field_val from $db->data as i where field_name = 'DOB' and i.sub_id = s.sub_id) as `DOB`,
    (select field_val from $db->data as i where field_name = 'EMail' and i.sub_id = s.sub_id) as `E-Mail`,
    (select field_val from $db->data as i where field_name = 'Telephone' and i.sub_id = s.sub_id) as `Phone`,
from $db->data as s
order by `Last Name` 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T15:56:33.833

选项 1：更改您的数据库架构以在*不太动态*的Person 表中具有属性。

选项 2：您的代码仅在您拥有所有字段的数据时才有效。否则它不会返回一行给你。因此，不仅为了可读性，而且为了让它工作，你需要使用 LEFT JOIN。但我真的会选择选项1。

选项 3：您为什么不直接将 SQL 中的所有内容返回到您的代码（SELECT * from table），然后以您使用的更适合的编程语言将其转换为您的对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T16:26:13.477

对于这种数据，这是一个愚蠢的布局。

不过要回答你的问题：

以不同的别名将表连接到自身。

通过不同的字段名称过滤每个别名副本，并假装它们是不同的表。

如果您经常这样做，那么基于此查询创建一个视图可能会有所帮助，这样以后的查询就不必那么冗长了。

```
$querystr = "
  SELECT
    fname.sub_id
   ,fname.field_val as 'First Name'
   ,lname.field_val as 'Last Name'
   ,team.field_val as 'Team'
   ,dob.field_val as 'DOB'
   ,email.field_val as 'Email'
   ,phone.field_val as 'Phone'
  FROM  
    $db->data fname
   ,$db->data lname
   ,$db->data team
   ,$db->data dob
   ,$db->data email
   ,$db->data phone
  where fname.sub_id = lname.sub_id
    and fname.sub_id = team.sub_id
    and fname.sub_id = dob.sub_id
    and fname.sub_id = email.sub_id
    and fname.sub_id = phone.sub_id
    and fname.field_name = 'First Name'
    and lname.field_name = 'Last Name'
    and team.field_name = 'Team'
    and dob.field_name = 'DOB'
    and email.field_name = 'EMail'
    and phone.field_name = 'Telephone'  
  order by
    ln.field_val
"; 
```

# jquery - QUnit 单元测试：测试鼠标点击

> ID：1002324
> 
> 赞同：4
> 
> 时间：2009-06-16T15:42:57.977
> 
> 标签：jquery, qunit

我有以下 HTML 代码：

```
<div id="main">
  <form Id="search-form" action="/ViewRecord/AllRecord" method="post">
    <div>
        <fieldset>
            <legend>Search</legend>
           <p>
                <label for="username">Staff name</label>
                <input id="username" name="username" type="text" value="" />
                <label for="softype"> software type</label>

                <input type="submit" value="Search" />
            </p>
        </fieldset>
    </div>
  </form>
</div> 
```

以及以下 Javascript 代码（以 JQuery 作为库）：

```
$(function() {
$("#username").click(function() {
        $.getJSON("ViewRecord/GetSoftwareChoice", {},
    function(data) {
       // use data to manipulate other controls
    });
    });
}); 
```

现在，如何测试`$("#username").click`，以便对于给定的输入，它

1.  调用正确的 url（在这种情况下，它的`ViewRecord/GetSoftwareChoice`）
2.  并且，预期的输出（在这种情况下， `function(data)`）表现正确？

知道如何用[QUnit](http://docs.jquery.com/QUnit)做到这一点吗？

**编辑：我阅读了[QUnit 示例](http://docs.jquery.com/QUnit)，但它们似乎正在处理一个没有 AJAX 交互的简单场景。虽然[有 ASP.NET MVC 示例](http://www.bradygaster.com/post/Testing-ASPNET-MVC-with-QUnit-Part-1.aspx)，但我认为它们实际上是在测试服务器对 AJAX 调用的输出，即它仍在测试服务器响应，而不是 AJAX 响应。我想要的是如何测试客户端响应。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-15T05:55:50.600

您可以用函数调用替换您的匿名事件处理程序，然后在您的测试中您可以调用该函数。

所以而不是

```
$("#username").click(function() {
    $.getJSON("ViewRecord/GetSoftwareChoice", {}, function(data) {
    // use data to manipulate other controls
    });
}); 
```

你可以做类似的事情

```
function doSomething() {
    $.getJSON("ViewRecord/GetSoftwareChoice", {}, function(data) {
    // use data to manipulate other controls
    });
}

$("#username").click(doSomething); 
```

然后在你的 QUnit 测试中你可以调用

```
doSomething(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:48:14.270

1.  在您的测试中覆盖 $.getJSON 以断言传入的 url 是正确的。如果您经常需要这样做，您可以创建一个辅助函数来覆盖 getJSON 并声明 url。确保在断言之后调用默认实现。此外，在断言 url 之后， stop() 测试。

使用启动测试并调用回调的函数包装传入的回调。

开始测试。

触发点击#username。

编辑：

这可能会有所帮助： [QUnit with Ajax，QUnit 通过了失败的测试](https://stackoverflow.com/questions/941133/qunit-with-ajax-qunit-passes-the-failing-tests)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-03T07:28:41.207

您并不总是想进行真正的 ajax 调用。在这种情况下，mockjax 是一个很好的解决方案。您可以在测试中分配一个返回值。因此，您将能够在不需要实现或其他文件的情况下请求信息。

在你的情况下，它可能是这样的：

```
$.mockjax({
  url: '/ViewRecord/GetSoftwareChoice',
  responseTime: 750,
  responseText: {
    status: 'success',
    result: 'your data can be put here' //in that case it is data.result with value string
  }
}); 
```

您可以测试 ajax 调用的请求，可以测试点击，还可以测试其他行为。

附言。您用您的结果“覆盖”ajax 调用。PS2。Mockjax 可以在这里找到：[https ://github.com/appendto/jquery-mockjax](https://github.com/appendto/jquery-mockjax)

# html - GUI 样式示例

> ID：1002327
> 
> 赞同：3
> 
> 时间：2009-06-16T15:43:16.493
> 
> 标签：html, css

是否有任何网站展示了 Web 应用程序样式的良好示例？表单设计和布局样式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T15:51:10.823

看看这些文章：

*   [10 种有用的 Web 应用程序界面技术](http://www.smashingmagazine.com/2009/01/12/10-useful-web-application-interface-techniques/)
*   [改善用户界面设计的 10 种有用技术](http://www.smashingmagazine.com/2008/12/15/10-useful-techniques-to-improve-your-user-interface-designs/)

它们不仅提供了良好布局的示例，还解释*了为什么*布局良好，并提供了有关如何使您的 Web 应用程序易于使用的技巧和设计理念。

第一个链接更侧重于使您的布局更加用户友好的一般要点，而第二个链接则侧重于更具体的技术以改进您的设计。

[A List Apart](http://www.alistapart.com/)还有大量与设计和内容相关的精心编写的文章；[设计](http://www.alistapart.com/topics/design/)部分有很多与布局和设计相关的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:49:22.990

除了[http://www.w3schools.com/](http://www.w3schools.com/)上的许多教程和示例？

总有[http://www.csszengarden.com/](http://www.csszengarden.com/)展示了如何仅通过更改样式表来操作网页的内容。

您可以在以下位置找到大量表单设计示例：

[http://www.smashingmagazine.com/2008/04/17/web-form-design-modern-solutions-and-creative-ideas/](http://www.smashingmagazine.com/2008/04/17/web-form-design-modern-solutions-and-creative-ideas/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:46:38.297

取决于你想走的方向，但在[CSSMania](http://cssmania.com/)和[TemplateMonster](http://www.templatemonster.com/)上可以找到一些非常好的设计。

关于这一点的一个说明：同时获得良好的设计和可用性本身就是一门艺术:)（谷歌基本上没有任何特定的设计，并且拥有相当多的用户）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T06:05:14.993

Flickr 上有大量用于各种网页设计元素的设计模式：http: [//www.flickr.com/photos/factoryjoe/collections/72157600001823120/](http://www.flickr.com/photos/factoryjoe/collections/72157600001823120/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T06:10:48.587

该站点致力于用户体验，并有大量的界面示例展示：http: [//konigi.com/interface/tags](http://konigi.com/interface/tags)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T06:15:13.993

Smashing Magazine 有一些有用的链接......在之前的回复中已经提到了一些，所以我将添加一个我发现有用的链接......

[40 个关于用户界面设计模式的有用资源](http://www.smashingmagazine.com/2009/06/15/40-helpful-resources-on-user-interface-design-patterns/)

# ssas - 在事先不知道模型细节的情况下，能否构建 OLAP 立方体？

> ID：1002334
> 
> 赞同：1
> 
> 时间：2009-06-16T15:43:51.267
> 
> 标签：ssas, olap, cube, cubes

请原谅我这个毛骨悚然的问题 - 我对 OLAP 和多维数据集并不是很熟悉。说明一下我的情况...

我想建立一个数据库来存储问卷结果，每个问卷可能有几十个问题。在收集了几千份已完成的问卷后，我想分析结果，这听起来像是 OLAP 类型的东西（我对此知之甚少）的一个很好的候选者。我需要能够对“所有拥有狗的 20-30 岁男性受访者”进行查询——即结合“你多大了”、“你有没有狗”等的答案。

我还希望能够存储下个月以及下个月的调查结果等，并运行显示本月与上个月的查询等。到目前为止，一切都很好，我想。

这是我的问题的核心：虽然这个月我的问卷可能有关于性别、年龄和养狗的问题，但下个月的问卷可能会包括一个关于（比如）眼睛颜色的问题。它可能（或可能不会）也放弃一些问题。这在 OLAP 世界中是否可行，或者您在设计多维数据集时是否需要提前了解所有“维度”（如果我使用了正确的术语）？

此外，如果我正在运行多个不同但重叠的问题的调查，我可以将它们全部存储在同一个多维数据集中并跨调查运行查询吗？每个调查可能有几十个问题，其中几十个与其他调查重叠。OLAP 系统是否适合这种事情？我只是不知道它们有多严格，以及它们是否真的适合这种用法。

非常感谢任何帮助。

PS。在有人建议之前，我刚刚购买了 Kimball 的数据仓库工具包，但还没有机会阅读它。（我怀疑它可能不会直接回答这个问题）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-13T00:21:58.100

[这里](http://www.sqlbi.eu/Projects/Manytomanydimensionalmodeling/tabid/80/language/en-US/Default.aspx)有一份白皮书，其中有一节涵盖了建模调查数据。这可能是您正在寻找的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:52:17.657

我首先要说我也是 OLAP 新手，但我想我已经掌握了您想要实现的目标。

实际上，您的问题是您的维度之一，该问题的答案是事实表的一部分，即事实表具有答案并且具有与年龄、性别、地区（可能）、问题相关的维度。它可能感觉有点前后矛盾，但这是我正在接受的 OLAP。

您可能还需要另一个与问题相关的维度，将它们分组到问卷中，但这可能只是问题维度本身的一个值，即 Question { QuestionnaireID = 1, QuestionNumber = 4, QuestionText = "Do you own a dog?" }。

不知道这是否有帮助，但如果没有别的，希望能给你一些想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:20:18.750

另一个OLAP新手也在这里......

1) 我只有使用 Mondrian (Pentaho) 创建 OLAP 多维数据集的经验，它确实允许您修改多维数据集的模式，这只是一个 XML 文件，并重建它们（或用 Pentaho 讲，发布）。所以对于那个平台，无论如何，没有这样的要求提前知道你的所有维度

2) 我同意 Lazurus 关于创建问题维度的建议。并不要求您的每个“事实”都具有在所有维度中都存在的值，因此，如果您要查看“问题 n”的维度，那么我相信它应该只为您提供“问题n”是一个相关的维度。

# asp.net - ASP.NET AJAX 和 UserControls：处理客户端脚本

> ID：1002337
> 
> 赞同：1
> 
> 时间：2009-06-16T15:44:21.703
> 
> 标签：asp.net, jquery, ajax

我有一个用户控件，我想根据一些业务规则以编程方式多次将其包含在页面中。目前，该控件有一个必须在 ASP.NET AJAX`pageLoad`事件上调用的 JavaScript 函数。

我正在使用一种模式，其中母版页具有`pageLoad`调用`contentPageLoad`任何 ContentTemplate 上的函数（如果该函数存在）的函数。然后，保存有问题的 UserControl 的 ContentTemplate 将负责在此事件期间调用 UserControl 上的适当函数。

现在，JavaScript 在`.ascx`UserControl 中是内联的，但我觉得我需要使用该`Page.ClientScript`属性通过后面的代码注入它。我的问题是：如何确保我的函数名称不会被破坏，并确保为**每个**UserControl 调用适当的方法？

仅供参考：需要为每个 UserControl 执行的代码是一个 jQuery 块，它从标准 HTML 创建一个 Multi-Select 控件`<select>`。

**编辑：** `RegisterStartupScript`建议，但这在 DOM 完成加载之前运行。将函数包装在 jQuery Document.ready() 中似乎没有帮助。用户控件在内部运行`UpdatePanel`，所以我真的没有选择如何调用这个脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T16:04:14.600

一种解决方案是`ClientID`在 JS 函数定义中使用用户控件的 ：

```
function onLoadInitialize_<%=ClientID%>(){/*do things*/} 
```

然后使用`Page.ClientScript.RegisterStartupScript`它在客户端加载期间发生。请注意，[`page_load`每次异步回发都会发生](http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/)这种情况；如果您希望每次实际页面加载仅发生一次（不包括异步回发），请改用 init 事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T20:07:49.427

所以我最终对@DDaviesBrackett 的建议采取了混合方法。我正在注册一个函数`Page.ClientScript`，不是作为启动脚本，而是作为 ClientScriptBlock。该函数使用类而不是 ID（因此是`ClientID`s）来附加到每个控件。基本结构是：

```
if(!Page.ClientScript.IsClientScriptBlockRegistered(Page.GetType(),"scriptkey"))
{
    Page.ClientScript.RegisterClientScriptBlock(
        Page.GetType(),"scriptkey",script,true);
} 
```

使用以下脚本：

```
function bindMultiSelects() {
    $('.multiselectclass').multiSelect({
        oneOrMoreSelected: '*', 
        noneSelected: 'Select Item(s)'
    });
} 
```

（使用很棒的[jQuery MultiSelect 插件](http://abeautifulsite.net/notebook/62)）

同样，这是因为我的母版页创建了一个`page_load`方法，然后在内容上调用一个方法，然后调用`bindMultiSelects`. 仅供我自己参考，`page_load`and`contentPageLoad`函数都遵循我在[这里](http://encosia.com/2007/11/20/using-pageload-in-both-master-and-content-pages/)找到的“插件”模式：

```
if(typeof functionname=='function') {
    functionname()
} 
```

# asp.net-mvc - ASP.NET MVC，一个插件架构和 id 冲突

> ID：1002339
> 
> 赞同：4
> 
> 时间：2009-06-16T15:44:33.327
> 
> 标签：asp.net-mvc, plugins

因此，我一直在向即将开始开发新用户界面的朋友谈论 ASP.NET MVC。

他问我是否可以使用 ASP.NET MVC 解决以下问题：

**想象一个支持插件的网络应用程序。在当前的 ASP.NET WebForms 应用程序中，插件开发人员提供了一个用户控件和一些 JQuery。控件的 ID 是唯一的，这样 JQuery 可以始终选择正确的 DOM 元素，并且后面的代码可以处理正确的控件集合。**

我建议在 MVC 中，因为我们可以有任意数量的表单......每个插件都可以实现为 partialView。

每个 partialView 都将被其自己的表单包装，因此相关的 Controller Action 将只接收在 partialView 中定义的表单数据 - 所以从这个角度来看，我们不关心 DOM id 冲突。

但是，如果确实发生 ID 冲突，则 HTML 将无效，因此插件开发人员编写的 JQuery 可能会失败！

我不确定我们如何才能解决这个问题......

我不喜欢在添加插件时解析 partialView 冲突的想法，也不喜欢限制插件开发人员可以访问的 id 的想法。

也许可以在运行时为 id 增加一个前缀，并且可以为模型绑定器提供这个前缀？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:52:28.810

您可以将插件的内容包装在 DIV 或 FORM 元素中，并在页面上为其提供唯一 ID。然后只需使用 jQuery 仅选择此“父”DIV 或 FORM 元素内的元素。

您可能会在运行时自动生成一个 GUID 以用作唯一 ID，但这需要编写插件的人付出一些努力。虽然，您可能会以某种方式构建它以使其自动生成“父”DIV 和 ID，然后您可以在视图中将 ID 作为插件的属性访问。

只是一些想法，我还没有构建一个像这样的基于 ASP.NET MVC 插件的系统，但它似乎并不太难。

下面是一个使用自定义 ViewUserControl 基类的 PartialView 示例：

ViewUserControl1.ascx：

```
<%@ Control Language="C#" Inherits="MvcPluginPartialView.PluginViewUserControl" %>
<input class="txtText" type="text" value="<%=this.ID %>" />
<input class="txtButton" type="button" value="Show Alert" />
<script type="text/javascript">
    jQuery(function() {
        // This is the Unique ID of this Plugin on the Page
        var pluginID = "<%=this.ID %>";

        // Attach the OnClick event of the Button
        $("#" + pluginID + " .txtButton").click(function() {
            // Display the content of the TextBox in an Alert dialog.
            alert($("#" + pluginID + " .txtText").val());
        });
    });
</script> 
```

MvcPluginPartialView.PluginViewUserControl：

```
namespace MvcPluginPartialView
{
    public class PluginViewUserControl : ViewUserControl
    {
        public PluginViewUserControl()
        {
            this.ID = "p" + Guid.NewGuid().ToString().Replace("-", "");
        }

        public override void RenderView(ViewContext viewContext)
        {
            viewContext.HttpContext.Response.Cache.SetExpires(DateTime.Now);
            ViewUserControlContainerPage containerPage = new ViewUserControlContainerPage(this);
            //this.ID = Guid.NewGuid().ToString();
            RenderViewAndRestoreContentType(containerPage, viewContext);
        }

        internal static void RenderViewAndRestoreContentType(ViewPage containerPage, ViewContext viewContext)
        {
            string contentType = viewContext.HttpContext.Response.ContentType;
            containerPage.RenderView(viewContext);
            viewContext.HttpContext.Response.ContentType = contentType;
        }

        private sealed class ViewUserControlContainerPage : ViewPage
        {
            public ViewUserControlContainerPage(ViewUserControl userControl)
            {
                this.Controls.Add(userControl);
            }

            protected override void Render(System.Web.UI.HtmlTextWriter writer)
            {
                writer.Write("<div id='" + this.Controls[0].ID + "'>");

                base.Render(writer);

                writer.Write("</div>");
            }
        }
    } 
} 
```

然后要将视图放置在页面上，您可以像往常一样使用“Html.RenderPartial”方法，此外，您可以根据需要在页面上放置任意数量的视图，它们都会按预期工作。

```
<%Html.RenderPartial("ViewUserControl1"); %>
<%Html.RenderPartial("ViewUserControl1"); %>
<%Html.RenderPartial("ViewUserControl1"); %> 
```

# c# - 我的 XML 错误？

> ID：1002343
> 
> 赞同：1
> 
> 时间：2009-06-16T15:45:07.427
> 
> 标签：c#, xml-serialization

我有以下代码：

```
public class DeserializeAndCompare
{
    public static List<string> IntoXML()
    {
        List<string> PopList = new List<string>();

        XmlSerializer serializer = new XmlSerializer(PopList.GetType());
        string k = FileToolBox.position0;
        FileStream filestreamer = new FileStream(k.ToString(), FileMode.Open);
        PopList = (List<string>)serializer.Deserialize(filestreamer);
        filestreamer.Close();
        return PopList;

    }
} 
```

我一直遇到以下错误： PopList = (List)serializer.Deserialize(filestreamer);

错误：未处理 InvalidOperationException，XML 文档 (1,1) 中存在错误。

在这一行中： FileStream filestreamer = new FileStream(k, FileMode.open);

我正在尝试引用包含字符串的数组的第 0 个位置。我基本上是通过我的目录，找到任何带有 .xml 扩展名的文件并将文件名路径保存在一个数组中。
这是我的数组的代码：

```
public static class FileToolBox
{

    public static string position0;
    public static void FileSearch()
    {

        //string position0;

        //array holding XML file names
        string[] array1 = Directory.GetFiles(@"s:\project", "*.xml");

        Array.Sort(array1);
        Array.Reverse(array1);
        Console.WriteLine("Files:");
        foreach (string fileName in array1)
        {

            Console.WriteLine(fileName);

        }

        position0 = array1[0];

    }

    public static string Position0
    {
     get
        {
            return position0;
        }
        set
        {
            position0 = value;
        }

    }
    } 
```

我在这里错过了什么吗？我如何摆脱这个错误？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:50:02.227

您的 XML 文件格式不正确，使用 XML Spy、XML 记事本之类的工具或在 IE 中打开它，它会给您错误和它所在的行。您很可能在文件中的某处有无效字符，例如 &

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:48:14.363

该错误特别表明正在读取的 XML 文件格式不正确。您应该从发布您的 XML 开始。另外，尝试在 Firefox 中打开 XML，因为它也可能指出 XML 的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:48:53.490

您的 xml 文档格式不正确，您需要打开 xml 文件并对其进行分析。

网络上有多个 xml 验证器，但这里有一个来自[w3schools](http://www.w3schools.com/xml/xml_validator.asp)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T15:56:13.710

试一试：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Xml;
using System.Xml.Serialization;

namespace Util
{
    /// <summary>
    /// Not to be confused with System.Xml.Serialization.XmlSerializer, which this uses internally.
    /// 
    /// This will convert the public fields and properties of any object to and from an XML string, 
    /// unless they are marked with NonSerialized() and XmlIgnore() attributes.
    /// </summary>
    public class XMLSerializer
    {
        public static Byte[] GetByteArrayFromEncoding(Encoding encoding, string xmlString)
        {
            return encoding.GetBytes(xmlString);
        }

        public static String SerializeToXML<T>(T objectToSerialize)
        {
            return SerializeToXML(objectToSerialize, Encoding.UTF8);
        }

        public static String SerializeToXML<T>(T objectToSerialize, Encoding encoding)
        {
            StringBuilder sb = new StringBuilder();

            XmlWriterSettings settings =
                new XmlWriterSettings { Encoding = encoding, Indent = true };

            using (XmlWriter xmlWriter = XmlWriter.Create(sb, settings))
            {
                if (xmlWriter != null)
                {
                    new XmlSerializer(typeof (T)).Serialize(xmlWriter, objectToSerialize);
                }
            }

            return sb.ToString();
        }

        public static void DeserializeFromXML<T>(string xmlString, out T deserializedObject) where T : class
        {
            DeserializeFromXML(xmlString, new UTF8Encoding(), out deserializedObject);
        }

        public static void DeserializeFromXML<T>(string xmlString, Encoding encoding, out T deserializedObject) where T : class
        {
            XmlSerializer xs = new XmlSerializer(typeof(T));

            using (MemoryStream memoryStream = new MemoryStream(GetByteArrayFromEncoding(encoding, xmlString)))
            {
                deserializedObject = xs.Deserialize(memoryStream) as T;
            }
        }
    }
}

public static void Main()
{
    List<string> PopList = new List<string>{"asdfasdfasdflj", "asdflkjasdflkjasdf", "bljkzxcoiuv", "qweoiuslfj"};

    string xmlString = Util.XMLSerializer.SerializeToXML(PopList);

    XmlDocument xmlDoc = new XmlDocument();
    xmlDoc.LoadXml(xmlString);

    string fileName = @"C:\temp\test.xml";
    xmlDoc.Save(fileName);

    string xmlTextFromFile = File.ReadAllText(fileName);

    List<string> ListFromFile;

    Util.XMLSerializer.DeserializeFromXML(xmlTextFromFile, Encoding.Unicode, out ListFromFile);

    foreach(string s in ListFromFile)
    {
        Console.WriteLine(s);
    }
} 
```

检查输出 XML 文件并查看编码是什么，并将其与您尝试读取的编码进行比较。我之前遇到过这个问题，因为我使用 StringBuilder 输出 XML 字符串，它以 UTF-16 写入，但我试图以 UTF-8 格式读取。尝试使用 Encoding.Unicode 看看是否适合您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T16:07:18.300

您的代码仅适用于具有以下结构的 XML 文件...

```
<?xml version="1.0" encoding="utf-16"?>
<ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <string>Hello</string>
  <string>World</string>
</ArrayOfString> 
```

# c# - 如何使用 foreach 和 LINQ 构建 XDocument？

> ID：1002348
> 
> 赞同：14
> 
> 时间：2009-06-16T15:45:32.590
> 
> 标签：c#, xml, linq

我可以使用 XDocument 构建以下**工作正常**的文件：

```
XDocument xdoc = new XDocument
(
    new XDeclaration("1.0", "utf-8", null),
    new XElement(_pluralCamelNotation,
        new XElement(_singularCamelNotation,
            new XElement("id", "1"),
            new XElement("whenCreated", "2008-12-31")
        ),
        new XElement(_singularCamelNotation,
            new XElement("id", "2"),
            new XElement("whenCreated", "2008-12-31")
            )
        )
); 
```

**但是**，我需要通过**迭代这样的集合**来构建 XML 文件：

```
XDocument xdoc = new XDocument
(
    new XDeclaration("1.0", "utf-8", null));

foreach (DataType dataType in _dataTypes)
{
    XElement xelement = new XElement(_pluralCamelNotation,
        new XElement(_singularCamelNotation,
        new XElement("id", "1"),
        new XElement("whenCreated", "2008-12-31")
    ));
    xdoc.AddInterally(xelement); //PSEUDO-CODE
} 
```

有**Add**、**AddFirst**、**AddAfterSelf**、**AddBeforeSelf**，但我无法让它们在这种情况下工作。

**这样的 LINQ 迭代是否可行？**

# 回答：

我采用了带有根标签的 Jimmy 的代码建议，对其进行了一些修改，这正是我想要的：

```
var xdoc = new XDocument(
    new XDeclaration("1.0", "utf-8", null),
    new XElement(_pluralCamelNotation,
        _dataTypes.Select(datatype => new XElement(_singularCamelNotation,
            new XElement("id", "1"),
            new XElement("whenCreated", "2008-12-31")
        ))
    )
); 
```

[Marc Gravell在这个 StackOverflow 问题上](https://stackoverflow.com/questions/1032314/how-can-i-change-this-stringbuilder-to-xml-code-to-linq-to-xml/1032363#1032363)发布了一个更好的答案。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-16T15:55:43.757

你需要一个根元素。

```
var xdoc = new XDocument(
    new XDeclaration("1.0", "utf-8", null),
    new XElement("Root",
        _dataTypes.Select(datatype => new XElement(datatype._pluralCamelNotation,
            new XElement(datatype._singlarCamelNotation),
            new XElement("id", "1"),
            new XElement("whenCreated", "2008-12-31")
        ))
    )
); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:55:31.993

如果我没记错的话，你应该可以使用 XDocument.Add()：

```
XDocument xdoc = new XDocument
(
    new XDeclaration("1.0", "utf-8", null));

foreach (DataType dataType in _dataTypes)
{
    XElement xelement = new XElement(_pluralCamelNotation,
        new XElement(_singularCamelNotation,
        new XElement("id", "1"),
        new XElement("whenCreated", "2008-12-31")
    ));
    xdoc.Add(xelement);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-11T21:07:30.530

我知道这是非常古老的帖子，但我今天偶然发现了这个帖子，试图解决同样的问题。您必须将元素添加到文档的根：

```
xdoc.Root.Add(xelement); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T15:51:30.353

简单的[Add 方法](http://msdn.microsoft.com/en-us/library/bb354061.aspx)有什么问题？

# mysql - 在 MySQL 查询中一起使用 DISTINCT 和 COUNT

> ID：1002349
> 
> 赞同：132
> 
> 时间：2009-06-16T15:46:06.770
> 
> 标签：mysql, sql

这样的事情可能吗：

```
SELECT DISTINCT COUNT(productId) WHERE keyword='$keyword' 
```

我想要的是获取与关键字相关联的唯一产品 ID 的数量。同一产品可能与关键字关联两次或更多，但我希望每个产品 ID 只计算 1 次

* * *

## 回答 #1

> 赞同：291
> 
> 时间：2009-06-16T15:47:39.857

采用

```
SELECT COUNT(DISTINCT productId) from  table_name WHERE keyword='$keyword' 
```

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-06-16T15:49:53.957

我会做这样的事情：

```
Select count(*), productid
from products
where keyword = '$keyword'
group by productid 
```

这会给你一个像

```
count(*)    productid  
----------------------
 5           12345   
 3           93884   
 9           93493 
```

这使您可以查看每个不同的 productid ID 中有多少与关键字相关联。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-06-16T15:47:04.600

你很亲密:-)

```
select count(distinct productId) from table_name where keyword='$keyword' 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-09-18T12:33:34.880

仅供参考，这可能更快，

```
SELECT count(1) FROM (SELECT distinct productId WHERE keyword = '$keyword') temp 
```

比这个，

```
SELECT COUNT(DISTINCT productId) WHERE keyword='$keyword' 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-07-26T17:51:14.553

**所有这些工作花药到底是什么鬼**

太简单了

如果您想要每个关键字中有多少 productId 的列表，这里是代码

```
SELECT count(productId),  keyword  FROM `Table_name` GROUP BY keyword; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-03-17T05:51:19.153

# 选择不同的产品并显示每个产品的数量

有关此类问题的另一个答案，这是我根据产品名称获取产品计数的另一个答案，如下面的示例：

[表值](http://sqlfiddle.com/#!9/1e8ba9/1)

```
select * FROM Product 
```

![](../Images/89db69292eac2a2369e172bc482bb312.png)

[计数产品名称](http://sqlfiddle.com/#!9/1e8ba9/24)

```
SELECT DISTINCT(Product_Name),
(SELECT COUNT(Product_Name) 
from Product  WHERE Product_Name = Prod.Product_Name)  
as `Product_Count`
from Product as Prod 
```

![](../Images/cae2216516971556d8f415adb42bf2e2.png)

> 记录数：4；执行时间：2ms

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-06-16T15:48:46.563

组队不是更好吗？就像是：

```
SELECT COUNT(*) FROM t1 GROUP BY keywork; 
```

# php - php中类前面的“&”是什么意思？

> ID：1002350
> 
> 赞同：2
> 
> 时间：2009-06-16T15:46:16.207
> 
> 标签：php

我刚刚在 PHP 中继承了这段代码，它似乎对 googles api 进行了某种网络服务调用。我不是 PHP 方面的专家，我有一些语法问题与以下行特别相关 $soapClients = &APIlityClients::getClients();

我理解双“::”表示 APIlityClients 是一个静态类，但我不确定 APIlityClients 前面的“&”是什么意思。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T16:18:01.217

当您在 PHP 中的变量前面使用 & 符号时，您正在创建对该变量的引用。

```
$foo = 'bar';
$baz = &$foo;

echo $foo //bar
echo $baz //bar

$foo = 'foobazbar';
echo $foo //foobazbar
echo $baz //foobazbar 
```

在 PHP5 之前，当您从 PHP 中的类创建对象时，该对象将通过**value**传递给其他变量。该对象不是引用，这在大多数其他面向对象（Java、C# 等）语言中是标准的。

但是，通过实例化一个前面带有 & 的类，您可以创建对返回对象的引用，它的行为就像其他语言中的对象一样。这是 PHP5 之前的一种常用技术，用于实现类似 OOP 的效果和/或提高性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T15:47:31.883

这是 PHP 版本的获取对某物的引用而不是复制其值的版本。因此，在这种情况下，`&`将检索对返回值的引用，`APIlityClients::getClients()`而不是返回值本身的副本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T15:48:29.683

它的意思是“地址”——它指的是从 getClients() 调用返回的值，而不是 APllityClients 类本身。

基本上它是说将 $soapClients 分配给对从 getClients() 返回的任何内容的引用，而不是制作返回值的副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T15:47:57.670

& 表示[按引用而不是按值传递](http://us3.php.net/manual/en/language.references.pass.php)。它在 PHP5 中应用不多，因为类在该版本中默认通过引用传递，但在以前的版本中没有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:48:21.307

& 表示它是一个参考。引用用于允许多个变量指向同一个对象。

[这个页面](http://us3.php.net/manual/en/language.references.return.php)比我解释得更好

另请参阅[http://us3.php.net/manual/en/language.references.php](http://us3.php.net/manual/en/language.references.php)以获取有关 php 参考的更多信息

# actionscript-2 - 为什么我无法访问来自 Amazon S3 的 FLV 视频的位图数据？

> ID：1002360
> 
> 赞同：0
> 
> 时间：2009-06-16T15:47:14.583
> 
> 标签：actionscript-2, amazon-s3, cross-domain, flv, bitmapdata

我有一个视频播放器，它从服务器加载渐进式 flv 视频并对其应用反射。我通过创建一个 bitmapData 对象然后将视频绘制到它来做到这一点。在我们将内容从测试服务器移动到 Amazon S3 之前，这绝对可以正常工作。现在没有反射。

谁能解释为什么会发生这种情况，甚至提出解决方案？

ps 我使用的是 Flash 8 AS2。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T07:20:14.460

这很可能与 Flash 播放器的安全限制和域有关。如果您没有收到任何错误，请尝试安装播放器的调试版本，看看会发生什么。

还可以查看[使用 NetStream 处理 Crossdomain.xml 和 302 重定向以](http://jessewarden.com/2009/03/handling-crossdomainxml-and-302-redirects-using-netstream.html)获取背景信息。

高温高压

胡安

# iphone - iPhone上意外的单例类行为，我做错了吗？

> ID：1002364
> 
> 赞同：1
> 
> 时间：2009-06-16T15:47:48.547
> 
> 标签：iphone, objective-c, singleton

我正在实现一个单例类，如下所示：

```
static Singleton* _singletonInstance;

@implementation Singleton

+(void)initialize
{ 
    _singletonInstance = [[Singleton alloc] init]; 
}

+(Singleton*)instance
{
    return(_singletonInstance);
} 
```

仅在有人第一次调用实例时才调用初始化。然后我有一个方法，我可以调用它来设置一些实例变量。所以它最终看起来像这样。

```
_singleton = [Singleton instance];
[_singleton setupWithParams: blah]; 
```

当我在对象中获取此单例的实例时，它第一次运行良好；但是，在我解除分配并创建需要单例实例的对象的新副本后，当我尝试调用 setup 函数时出现 BAD ACCESS 错误。

只是为了测试东西，我在进行设置调用之前打印出实例的地址，并且两次它们都报告相同的地址，但是当我检查错误日志以查找 BAD ACCESS 调用时，它列出了一个完全不同的内存地址。

有谁知道为什么这个指向实例的指针在我打印它时看起来很好，但是当我调用它时，它似乎指向随机数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T16:06:02.357

指针值看起来是有效的，因为它曾经是，但很可能内存已被释放，这就是它指向的内容看起来像随机数据的原因。

您已经获得了`[[Singleton alloc] init]`上面的一个参考，但是还有`release`其他地方可能正在执行吗？我敢打赌，您的代码正在调用`instance`，然后`release`-ing 稍后，即使您的代码从未获得参考。无论如何，这对于单身人士来说是不必要的。只是猜测...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T15:51:47.890

你在某处释放你的 _singletonInstance 吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:31:32.613

我正在使用更复杂但非常稳定的 Singleton 模板版本（来自[Brandon "Quazie" Kwaselow 博客](http://blog.quazie.net/2009/04/sharedinstance-objective-cs-singleton-paradigm/)的描述）：

```
static SampleSingleton *sharedSampleSingletonDelegate = nil;

+ (SampleSingleton *)sharedInstance {
   @synchronized(self) {
      if (sharedSampleSingletonDelegate == nil) {
         [[self alloc] init]; // assignment not done here
      }
   }
   return sharedSampleSingletonDelegate;
}

+ (id)allocWithZone:(NSZone *)zone {
   @synchronized(self) {
      if (sharedSampleSingletonDelegate == nil) {
         sharedSampleSingletonDelegate = [super allocWithZone:zone];
         // assignment and return on first allocation
         return sharedSampleSingletonDelegate;
      }
   }
   // on subsequent allocation attempts return nil
   return nil;
 }

- (id)copyWithZone:(NSZone *)zone
{
   return self;
}

- (id)retain {
   return self;
}

- (unsigned)retainCount {
   return UINT_MAX;  // denotes an object that cannot be released
}

- (void)release {
   //do nothing
}

- (id)autorelease {
   return self;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T02:45:11.450

Valerii 的代码更适合实现单例，但问题几乎可以肯定是，调用 [Singleton 实例] 的代码在运行时就好像它拥有所有权，但实际上并没有使用保留获得所有权，然后才释放它。

在那里寻找你的错误，并阅读[内存管理规则](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)。

此外，在 Xcode 中，[启用 NSZombieEnabled](http://www.cocoadev.com/index.pl?NSZombieEnabled)，当您在对象被释放后尝试向其发送消息时，控制台会显示您。

# jquery - jQuery ajax (jsonp) 忽略超时并且不触发错误事件

> ID：1002367
> 
> 赞同：89
> 
> 时间：2009-06-16T15:48:08.293
> 
> 标签：jquery, ajax, error-handling, timeout, jsonp

为了添加一些基本的错误处理，我想重写一段代码，它使用 jQuery 的 $.getJSON 从 Flickr 中提取一些照片。这样做的原因是 $.getJSON 不提供错误处理或超时工作。

由于 $.getJSON 只是 $.ajax 的一个包装器，我决定重写它并让我大吃一惊，它完美地工作。

现在有趣的开始了。当我故意导致 404（通过更改 URL）或导致网络超时（通过不连接到互联网）时，根本不会触发错误事件。我不知道我做错了什么。非常感谢您的帮助。

这是代码：

```
$(document).ready(function(){

    // var jsonFeed = "http://api.flickr.com/services/feeds/photos_public.gne"; // correct URL
    var jsonFeed = "http://api.flickr.com/services/feeds/photos_public.gne_______"; // this should throw a 404

    $.ajax({
        url: jsonFeed,
        data: { "lang" : "en-us",
                "format" : "json",
                "tags" : "sunset"
        },
        dataType: "jsonp",
        jsonp: "jsoncallback",
        timeout: 5000,
        success: function(data, status){
            $.each(data.items, function(i,item){
                $("<img>").attr("src", (item.media.m).replace("_m.","_s."))
                          .attr("alt", item.title)
                          .appendTo("ul#flickr")
                          .wrap("<li><a href=\"" + item.link + "\"></a></li>");
                if (i == 9) return false;
            });
        },
        error: function(XHR, textStatus, errorThrown){
            alert("ERREUR: " + textStatus);
            alert("ERREUR: " + errorThrown);
        }
    });

}); 
```

我想补充一点，这个问题是在 jQuery 版本 1.4.2 时提出的

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2011-02-25T19:38:26.917

jQuery 1.5 及更高版本对 JSONP 请求的错误处理有更好的支持。但是，您需要使用`$.ajax`方法而不是`$.getJSON`. 对我来说，这有效：

```
var req = $.ajax({
    url : url,
    dataType : "jsonp",
    timeout : 10000
});

req.success(function() {
    console.log('Yes! Success!');
});

req.error(function() {
    console.log('Oh noes!');
}); 
```

当 10 秒后没有成功请求时，超时似乎可以解决问题并调用错误处理程序。

我也写了一篇关于这个主题的小[博文。](http://www.haykranen.nl/2011/02/25/jquery-1-5-and-jsonp-requests/)

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-06-16T17:10:38.747

这是 jQuery 中原生 jsonp 实现的一个已知限制。以下文字来自[IBM DeveloperWorks](http://www.ibm.com/developerworks/library/wa-aj-jsonp1/?ca=dgr-jw64JSONP-jQuery&S_TACT=105AGY46&S_CMP=grsitejw64)

> JSONP 是一种用于构建 mashup 的非常强大的技术，但不幸的是，它并不是解决所有跨域通信需求的万灵药。它有一些缺点，在投入开发资源之前必须认真考虑。首先，JSONP 调用没有错误处理。如果动态脚本插入有效，您会被调用；如果没有，什么都不会发生。它只是默默地失败。例如，您无法从服务器捕获 404 错误。您也不能取消或重新启动请求。但是，您可以在等待一段合理的时间后超时。（未来的 jQuery 版本可能会为 JSONP 请求提供中止功能。）

[但是， GoogleCode](http://code.google.com/p/jquery-jsonp/)上有一个 jsonp 插件可以提供对错误处理的支持。要开始，只需对您的代码进行以下更改。

您可以下载它，也可以只添加对插件的脚本引用。

```
<script type="text/javascript" 
     src="http://jquery-jsonp.googlecode.com/files/jquery.jsonp-1.0.4.min.js">
</script> 
```

然后修改你的ajax调用，如下所示：

```
$(function(){
    //var jsonFeed = "http://api.flickr.com/services/feeds/photos_public.gne"; // correct URL
    var jsonFeed = "http://api.flickr.com/services/feeds/photos_public.gne_______"; // this should throw a 404  
    $.jsonp({
        url: jsonFeed,
        data: { "lang" : "en-us",
                "format" : "json",
                "tags" : "sunset"
        },
        dataType: "jsonp",
        callbackParameter: "jsoncallback",
        timeout: 5000,
        success: function(data, status){
            $.each(data.items, function(i,item){
                $("<img>").attr("src", (item.media.m).replace("_m.","_s."))
                          .attr("alt", item.title)
                          .appendTo("ul#flickr")
                          .wrap("<li><a href=\"" + item.link + "\"></a></li>");
                if (i == 9) return false;
            });
        },
        error: function(XHR, textStatus, errorThrown){
            alert("ERREUR: " + textStatus);
            alert("ERREUR: " + errorThrown);
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-06-20T17:46:15.443

如果您被 jQuery 1.4 卡住，一个解决方案：

```
var timeout = 10000;
var id = setTimeout( errorCallback, timeout );
$.ajax({
    dataType: 'jsonp',
    success: function() {
        clearTimeout(id);
        ...
    }
}); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-01-13T06:34:29.060

这可能是 jQuery 的“已知”限制；但是，它似乎没有很好的记录。我今天花了大约 4 个小时试图了解为什么我的超时不起作用。

我切换到[jquery.jsonp](http://code.google.com/p/jquery-jsonp/)，它的工作就像一个魅力。谢谢你。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-07T20:45:36.560

似乎从 jQuery 1.5 开始解决。我已经尝试了上面的代码，我得到了回调。

我说“似乎是”是因为[jQuery.ajax()](http://api.jquery.com/jQuery.ajax/)的错误回调的文档仍然有以下注释：

> 注意：跨域脚本和 JSONP 请求不调用此处理程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-22T08:25:12.080

[Jose Basilio 的](https://stackoverflow.com/users/83667/jose-basilio) [回答](https://stackoverflow.com/a/1002797/665600)中提到的 jquery-jsonp jQuery 插件现在可以在[GitHub](https://github.com/jaubourg/jquery-jsonp)上找到。

不幸的是，文档有点简陋，所以我提供了一个简单的例子：

```
 $.jsonp({
        cache: false,
        url: "url",
        callbackParameter: "callback",
        data: { "key" : "value" },
        success: function (json, textStatus, xOptions) {
            // handle success - textStatus is "success"   
        },
        error: function (xOptions, textStatus) {
            // handle failure - textStatus is either "error" or "timeout"
        }
    }); 
```

**重要** 在调用 $.jsonp() 中包含回调参数，否则我发现回调函数永远不会被注入到服务调用的查询字符串中（当前为 jquery-jsonp 的 2.4.0 版）。

*我知道这个问题很老，但是使用 JSONP 处理错误的问题仍然没有“解决”。希望此更新将对其他人有所帮助，因为此问题在“jquery jsonp 错误处理”方面在 Google 中排名第一。*

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-18T20:01:50.930

听脚本的 onerror 事件怎么样？我遇到了这个问题，并通过修补创建脚本标记的 jquery 方法来解决它。这是一段有趣的代码：

```
// Attach handlers for all browsers
script.onload = script.onreadystatechange = function( _, isAbort ) {

    if ( isAbort || !script.readyState || /loaded|complete/.test( script.readyState ) ) {

        cleanup();

        // Callback if not abort
        if ( !isAbort ) {
            callback( 200, "success" );
        }
    }
};

/* ajax patch : */
script.onerror = function(){
    cleanup();

    // Sends an inappropriate error, still better than nothing
    callback(404, "not found");
};

function cleanup(){
    // Handle memory leak in IE
    script.onload = script.onreadystatechange = null;

    // Remove the script
    if ( head && script.parentNode ) {
        head.removeChild( script );
    }

    // Dereference the script
    script = undefined;
} 
```

你觉得这个解决方案怎么样？是否可能导致兼容性问题？

# html - 如何在以下排列中布局一些 div？

> ID：1002373
> 
> 赞同：3
> 
> 时间：2009-06-16T15:48:27.310
> 
> 标签：html, css

我的网页中心有一个主容器 div。这已经到位，并且其中包含各种元素。

但是，现在我试图在左侧放置一个大的内容 div（Div #1），它占据了 Main Container Div 的 70% 左右。我遇到的困难是让 CSS 正确排列 Div 的#1、#2、#3 和#4，如下图所示：

![替代文字](../Images/a570d1e32a3ec2a60783eeacd375fd2a.png)

在这种情况下，对于有关 Div #1 - #4 的 CSS，我应该怎么做？我应该将 div #1 向左浮动，并将其设置为百分比/固定宽度吗？并浮动 div #2 - 4 对吗？

对此的一些指导将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T15:50:46.877

我会说 2 个包装器 div“左”和“右”以正确的大小向左浮动。

将 div 1 放在左侧

将 div 2、3 和 4 放在右边。

这应该有效，如果不让我知道

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T16:00:54.477

这是一个工作示例，可能会对您有所帮助：

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">   
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">     
    <head>      
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />   
        <title>Floating</title>
    <style type="text/css">
      *{
       margin:0;
       padding:0; 
      }
      .content{
        padding:10px;
        margin-top:50px;
        width:770px;
        margin-left:auto;
        margin-right:auto;
        border:1px solid black;
      }
      .content h1{
        text-align:center; 
      }

      .content h2{
        text-align:center; 
      }

      .content .left{
        width:600px;
        float:left; 
        border:1px solid black;      
      }

      .content .right{
        width:150px;
        float:right;
      }

      .content .right div{        
        margin-bottom:10px; 

        border:1px solid black;
      }
      .content .clear{
        clear:both; 
      }
    </style>
  <body>
    <div class="content">
      <h1>Main Container Div</h1>
      <div class="left">
        <h2>Div #1</h2>
      </div>
      <div class="right"> 
        <div><p>Div #2</p></div>
        <div><p>Div #3</p></div>
        <div><p>Div #4</p></div>
        <div><p>Div #5</p></div>
      </div>
      <div class="clear">&nbsp;</div>
    </div>
    </body>
</html> 
```

# wpf - 为 WPF + Silverlight 项目配备人员

> ID：1002377
> 
> 赞同：3
> 
> 时间：2009-06-16T15:48:32.227
> 
> 标签：wpf, silverlight

如果为“Silverlight / WPF 业务应用程序”项目配备人员，您会包括一个平面设计师团队吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:55:19.357

我不知道我是否会包括平面设计师。我会寻找 UX（用户体验）设计师。

UX 设计师将具备图形设计师的技能，并了解用户界面设计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T01:00:49.840

为了为 Silverlight 项目配备人员，通常最好担任三个角色：

1.  用户体验
2.  有创造力的
3.  技术的

UX 通常是一个前端加载的活动，主要在分析和设计期间运行，其可交付成果输入到构建中。

创意在设计过程中被引入。Creative 有两个基本角色：视觉设计师和交互实施者。视觉设计师将在设计阶段大量使用，并将使用 Adob​​e Illustrator 或 Expression Design 等工具来构建视觉资产。可视化实施者将在构建阶段使用最多，他们将与技术团队并肩工作，将可视化资产集成到解决方案中。交互实施者将生活在 Expression Blend 中。

技术当然是在构建过程中使用最多的，但像往常一样，您应该在计划和分析期间让您的技术架构师参与进来，以帮助引导功能、用户体验和创意走向可行的解决方案。开发人员将使用 Visual Studio 和 Expression Blend。

根据您的团队的技能组合，您可能在实施者/开发者边界上有一些交叉个性。随着开发人员越来越精通 Expression Blend，我认为我们可以将此角色视为许多开发人员的第二或第三技能。

一般来说，如果您想获得一些更高级别的用户体验，那么引入 UX 和创意资源是一个好主意，但这不是必需的，我会特别说在您的情况下，这将是“很高兴拥有”。

Silverlight 是一个高度可行的开发平台，用于构建标准的业务线应用程序。Silverlight 不仅仅是华丽的图形。它是关于构建具有现代用户所期望的所有功能的 Web 应用程序，从而加快上市时间并降低维护成本。哦，如果你想用你所有的空闲时间添加一些 piz-azz ......你可以这样做。:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T05:54:37.600

这是我作为 JD 编写的，用于为 Silver light 项目配备人员。

用户体验设计师简介

*   能够可视化和创建用户体验，并使用 Expression Blend 将其转化为 UI 设计
*   非常了解 XAML 和 Silverlight 的功能
*   对创建和应用样式和模板有很好的理解
*   理想的候选人从 Silverlight 1.0 开始就一直在使用它，示例显示了了解 2.0 和 3.0 的增强功能的专业水平。

银光建筑师

*   能够通过为 Silverlight 特定项目部署所需的工具和框架（端到端）来指导团队
*   使用 Expression Blend 和 Visual Studio 进行 Silverlight 应用程序开发的经验
*   对 XAML 样式、触发器、可观察集合、数据绑定方法、模型视图视图模型 (MVVM) 模式、导航模式有很好的理解
*   Silverlight 中的 XML 和 LINQ
*   Silverlight 框架的所有方面，包括 DLR、隔离存储等
*   了解基本应用程序块，如复合应用程序块 (Prism) 非常了解将 RIA、WCF 服务和 ADO.NET 实体框架服务与 Silverlight 一起使用
*   .NET 3.0 和 3.5 框架内的优秀开发知识
*   必须了解软件开发的基础知识，包括最佳实践和 OOP 设计模式。了解跨浏览器前端开发问题很重要
*   关于 3rd 方 UI 库的知识
*   熟悉 Live Mesh 技术

Silverlight 开发人员

*   使用 Expression Blend 和 Visual Studio 进行 Silverlight 应用程序开发的经验
*   出色的 C# 和 XAML 技能
*   使用 MVVM 的经验
*   强大的 JavaScript 技能
*   .NET 3.0 和 3.5 框架内的开发工作知识

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T19:23:43.380

对我来说，这取决于您正在寻找的项目和 UI 的质量。对于很多内部项目，聘请全职图形设计师可能有点矫枉过正。如果您正在创建一个面向外部的网站/项目，那么您绝对应该带上具有用户设计经验的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T19:27:03.937

我认为当前的职位头衔是“交互设计师”——他们会说用户体验、可用性等方面的术语。换句话说，他们是“交互设计”方面的专家。你需要一个由他们组成的团队，而不是平面设计师。

关于迭代设计的必读维基百科文章：[这里](http://en.wikipedia.org/wiki/Interaction_design)

图形设计师很好，但除非您正在构建操作系统，否则您不需要他们的团队。只需几个即可在 Blend 或 Photoshop 中构建模型（并让您的开发人员使用 Visual Studio 将 Photoshop 图像转换为 XAML）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T15:55:59.577

当然——理论上，他们应该使用 Expression Blend Studio，但效果不是很好，所以你需要找一个可以在 VisualStudio 中工作的 UI 技术人员。但是，如果您正在构建 UI，请始终拥有 UI 人员 - 拥有专业外观的应用程序与拥有运行良好的应用程序同样重要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T15:58:15.490

在不为职位描述分心的情况下，我会回答一个巨大的“是”！让您的开发人员可以自由地专注于他们擅长的代码，*同时*获得看起来令人难以置信的应用程序。这是一个巨大的胜利。

# cocoa-touch - iPhone 在 TabBar 视图中使用模态视图

> ID：1002389
> 
> 赞同：0
> 
> 时间：2009-06-16T15:50:19.230
> 
> 标签：cocoa-touch, uitabbarcontroller, modal-dialog

在 TabBar 视图中使用模态视图

我总是收到以下错误：来自调试器的错误：上一帧与此帧相同（gdb 无法展开超过此帧）

我有一个使用 TabBar 的应用程序。从其中一个 TabViews 我需要以模态方式显示一个视图。我尝试：

```
if(self.gmailController == nil) {

    self.gmailController =
        [[GMailViewController alloc] initWithNibName:@"GMailView" bundle:nil];
}

[[self.navigationController] 
        presentModalViewController:gmailController animated:YES]; 
```

////////

```
And I have tried:

 [self.parentViewController 
        presentModalViewController:gmailController animated:YES];

    and 

 [self.tabBarController presentModalViewController:gmailController animated:YES];

    and 

 [self presentModalViewController:gmailController animated:YES];

 Thanks for reading! Any comments welcome.

 Mark 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-30T19:12:39.927

检查您的 NIB 文件中的所有连接。在更改 IBOutlet 变量的名称但忘记调整 NIB 后，我遇到了同样的错误。这破坏了 ViewController 和 NIB 之间的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:36:49.400

对不起。这个问题涉及我的错误。我在加载 nib 文件时遇到问题。一旦我修复了NIB，模态视图就会加载：

[self.tabBarController presentModalViewController:gmailController 动画：YES];

# mmc - 我可以为 Windows 2003 上的 MMC 3.0 管理单元提供本地化的 CHM 文件吗？

> ID：1002391
> 
> 赞同：1
> 
> 时间：2009-06-16T15:50:46.830
> 
> 标签：mmc, mmc3

我正在使用 C# 开发 MMC 3.0 管理单元。我希望我的管理单元根据当前语言自动本地化，即在西班牙语操作系统上，管理单元应该以西班牙语显示并且应该使用西班牙语帮助文件。

因为我的管理单元是一个 .NET 应用程序，所以 GUI 本地化没有问题。但是，我的 HTML 帮助 (CHM) 文件的本地化遇到了问题。我想将几个本地化的 CHM 文件部署到磁盘，并让 MMC 选择适当的 CHM 文件以在运行时显示。

目前，我的管理单元启动我的 CHM 文件的英文版本，该文件在 HKLM\Software\Microsoft\MMC\SnapIns\<snapin-guid> 下的“HelpTopic”和“LinkHelpTopics”注册表值中定义。我发现[一篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms692743(VS.85).aspx)建议我可以在 mui\<language-code> 目录中提供此 CHM 文件的本地化版本，例如（对于西班牙语）mui\3082\file.chm。

当我在 Windows 2008 上尝试此操作时，它可以工作 - 显示帮助文件的西班牙语版本。但是当我在 Windows 2003 上尝试时，我仍然得到英文帮助文件。

有谁知道这是否是 Windows 2003 上 MMC 3.0 的限制？如果是这样，实现我想做的最好的方法是什么？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-29T22:57:20.183

只是为了跟进这一点 - 我还没有找到任何证据表明这是可能的。还有[一篇文章](http://msdn.microsoft.com/en-us/library/dd277604(VS.85).aspx)描述了如何覆盖 MMC 的帮助系统并使用您自己的任意机制来显示帮助，但这需要用户下载修补程序，并且仅适用于 Windows 2008，因此对这个特定问题没有帮助。

最后我决定做的是安装一个单独的 CHM 文件并在注册表中引用它；但该 CHM 文件可能是英文版、西班牙文版等，具体取决于安装时用户的 Windows 区域设置。

# java - 当对话框为模态时，为什么单选按钮在 Mac 上的 java.awt.Dialog 中呈现不正确？

> ID：1002394
> 
> 赞同：0
> 
> 时间：2009-06-16T15:51:00.713
> 
> 标签：java, macos, awt

我正在 Mac 上测试我的 Java 应用程序，但遇到了一个非常奇怪的问题。*出现在模态*对话框中的复选框呈现不正确，但非模态对话框工作正常。

例如，假设我有一个带有 2 个单选按钮的窗口。当对话框打开时，第一个被选中。当我单击第二个按钮时，突然看起来两者都被选中了。单击对话框中的其他任何位置都会导致渲染自行修复，并且只会显示选定的按钮。

以下代码为我重现了这一点：

```
package mactest;

import java.awt.Checkbox;
import java.awt.CheckboxGroup;
import java.awt.Dialog;
import java.awt.FlowLayout;
import java.awt.Frame;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

public class Main {
  public static void main(String[] args) {
    boolean modal = false;
    if(args.length > 0) {
      modal = args[0].toLowerCase().equals("true");
    }

    TestDialog dlg = new TestDialog(new Frame(), modal);

    dlg.setVisible(true);
  }

  private static class TestDialog extends Dialog {
    private Checkbox cb1;
    private Checkbox cb2;

    private CheckboxGroup cbg;

    public TestDialog(Frame owner, boolean modal) {
      super(owner);

      cbg = new CheckboxGroup();

      cb1 = new Checkbox("One", true, cbg);
      cb2 = new Checkbox("Two", false, cbg);

      this.setLayout(new FlowLayout());
      this.add(cb1);
      this.add(cb2);

      this.setModal(modal);
      this.pack();

      this.addWindowListener(new WindowAdapter() {
        public void windowClosing(WindowEvent e) {
          TestDialog.this.setVisible(false);
          System.exit(0);
        }
      });
    }
  }
} 
```

如果我这样称呼它：

> java -cp MacTest.jar mactest.Main false

对话框不是模态的，一切正常。但是，如果我告诉它是模态的：

> java -cp MacTest.jar mactest.Main true

然后出现渲染问题。

我已经尝试了我能想到的所有技巧来尝试解决问题（无效、doLayout、请求焦点、在选择一个按钮时显式设置每个按钮的状态等）。但到目前为止，我唯一要做的就是完成这项工作是使对话框不是模态的。不幸的是，这不是我的应用程序中的一个选项。

万一这很重要，这是在运行 Java 1.5.0_16 的运行 OS X 10.5 的 MacBook 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T20:20:55.987

I found something that seems to fix it, though it's an ugly hack. I added item listeners to each of the Checkboxes. When those trigger I resize the window by 1 pixel, then do an invokeLater() on pack() (my dialogs aren't resizable). Here's the modified test code:

```
package mactest;

import java.awt.Checkbox;
import java.awt.CheckboxGroup;
import java.awt.Dialog;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.Frame;
import java.awt.Rectangle;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

public class Main {
  public static void main(String[] args) {
    boolean modal = false;
    boolean tweak = false;
    if(args.length > 0) {
      modal = args[0].toLowerCase().equals("true");
    }
    if(args.length > 1) {
      tweak = args[1].toLowerCase().equals("true");
    }

    TestDialog dlg = new TestDialog(new Frame(), modal, tweak);

    dlg.setVisible(true);
  }

  private static class TestDialog extends Dialog {
    private Checkbox cb1;
    private Checkbox cb2;

    private CheckboxGroup cbg;

    public TestDialog(Frame owner, boolean modal, boolean tweak) {
      super(owner);

      cbg = new CheckboxGroup();

      cb1 = new Checkbox("One", true, cbg);
      cb2 = new Checkbox("Two", false, cbg);

      this.setLayout(new FlowLayout());
      this.add(cb1);
      this.add(cb2);

      this.setModal(modal);
      this.pack();

      if(tweak) {
        cb1.addItemListener(new ItemListener() {
          public void itemStateChanged(ItemEvent e) {
            onSelection();
          }
        });
        cb2.addItemListener(new ItemListener() {
          public void itemStateChanged(ItemEvent e) {
            onSelection();
          }
        });
      }

      this.addWindowListener(new WindowAdapter() {
        public void windowClosing(WindowEvent e) {
          TestDialog.this.setVisible(false);
          System.exit(0);
        }
      });
    }

    private void onSelection() {
      Rectangle bounds = this.getBounds();
      this.setBounds(bounds.x, bounds.y, bounds.width + 1, bounds.height);
      EventQueue.invokeLater(new Runnable() {
        public void run() {
          TestDialog.this.pack();
        }
      });
    }
  }
} 
```

For resizable components you'd need to store the size pre-tweak and restore that instead of calling pack().

In windows I could see the dialog flicker every once in a while when I changed the selection, though on the mac it wasn't noticeable at all.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:20:14.927

你问的是复选框还是单选按钮？你提到两者。

要创建多重排除范围，您必须使用 ButtonGroup 类

# lightbox - Quicktime 嵌入的灯箱？

> ID：1002395
> 
> 赞同：2
> 
> 时间：2009-06-16T15:51:01.243
> 
> 标签：lightbox, quicktime

我有一个使用[Litebox](http://www.doknowevil.net/litebox/ "精简版")显示图像的网站。在嵌入了 QuickTime 的页面上，该框出现在影片下方。我怎样才能让盒子出现在顶部？我尝试设置 wmode=transparent 但是，虽然它适用于 Webkit 浏览器和 IE，但它在 Gecko 浏览器中失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T16:01:10.530

每当我在选择框上添加灯箱或渲染任何内容时，我都必须通过 display:none 隐藏选择框。这可以防止选择框呈现在我在 IE 6 中呈现的任何内容之上（也可能是 7 和 8，不确定）。

在这种情况下，您可能必须对 quicktime 嵌入做同样的事情。

# c# - 尝试从 C# 启动 QTP 时，为什么会收到 InteropServices.COMException？

> ID：1002396
> 
> 赞同：1
> 
> 时间：2009-06-16T15:51:05.097
> 
> 标签：c#, .net, com, qtp

[这个问题是我可以使用除 VBScript 以外的语言以编程方式执行 QTP 测试](https://stackoverflow.com/questions/895342/can-i-use-a-language-other-than-vbscript-to-programmatically-execute-qtp-tests)的问题的后续问题吗？. 我有一个 C# (.Net 2.0) 程序，它创建一个 QuickTest.Application 实例并启动 QuickTest Professional（10.0 版）。我所有的开发测试都运行良好。

今天早上，我尝试在没有开发环境（SharpDevelop 2.2.1）的测试机器上执行程序。当我双击 Windows 图标时，尝试执行程序时收到错误消息。控制台窗口闪得太快，看不到它是什么，所以我掉到命令提示符下并从那里执行程序。一切正常。在第二次尝试启动程序以及所有后续启动程序时，我收到一个`System.Runtime.InteropServices.COMException`似乎是由 COM 对象抛出一个`RPC_E_SERVERFAULT`. 有问题的功能是

```
virtual public QuickTest.Application LaunchQuickTestPro()
{
    QuickTest.Application qtpApp = new QuickTest.Application();
    qtpApp.Launch();
    qtpApp.Visible = false;
    return qtpApp;
} 
```

并且该`qtpApp.Launch();`行正在引发异常。

我完全不知道可能出了什么问题。它在开发机器上运行良好，并且在测试机器上运行良好。在尝试之间重新启动似乎没有好处。我对 C#、.NET 和 COM 还很陌生，所以希望这里有经验的人可能以前见过这个。我可能错过了一些简单的东西。

**更新**：我今天早上发现，在重新启动后，*Debug 版本在测试机器上运行良好*（没有开发环境），但*Release 版本却不行*。我将尝试重建和重新部署。任何人都对构建选项提出建议以检查发布版本？

**UPDATE2**：似乎两个版本（调试和发布）在重新启动后都能正常工作。如果我再次尝试启动，我会收到错误消息。我在下面添加了我的`Main()`方法和方法的一部分`ExitQTP()`。

*我想知道问题的一部分是否是我对`ref`应该如何使用的误解。*但是，每次在 IDE (SharpDevelop 2.2.1) 中运行时，代码都可以正常工作。

第一次运行后似乎确实没有正确清理某些东西，但我不知道是什么。查看任务监视器，QTP* 进程按照我的预期消失了。我认为可能有第三个过程导致了问题，但无法隔离是什么，

```
 //Program starts here
    [STAThread]
    public static void Main(string[] args)
    {      
        string configFileName = 
            ConfigurationManager.AppSettings.Get("TestPathsConfigFile");

        TextReader configFile = new StreamReader(configFileName);
        QTPLauncher launcher = new QTPLauncher();
        string testName = null; 
        try
        {
            Debug.WriteLine("Creating QuickTest.Application object...");
            QuickTest.Application qtpApp = launcher.LaunchQuickTestPro();
            Debug.WriteLine("Successfully created QuickTest.Application object...");

            while((testName = configFile.ReadLine()) != null)
            {
                if((testName != string.Empty) &&
                   (!(testName.TrimStart()).StartsWith(COMMENT_START)))
                {
                    Debug.WriteLine(testName);

                    launcher.ExecuteQTPTest(testName, ref qtpApp);

                }
            } 

            configFile.Close(); 

           ... //code unrelated to problem removed.

            configFile = null;
            launcher.ExitQTP(ref qtpApp);
        }
        catch(System.Runtime.InteropServices.COMException ce)
        {
            Console.Error.WriteLine(ce.StackTrace);
        }
    }

//Exits QTP
virtual public void ExitQTP(ref QuickTest.Application qtpApp)
{
    qtpApp.Quit();
    qtpApp = null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:59:39.797

我怀疑问题是您没有正确关闭（退出）您的 QT 应用程序实例（如果您检查任务管理器，您可能会看到它正在运行），因此后续运行无法正确初始化。

有一篇不错的博客文章，其中 Grant Holliday 自动化 QT 以在 Team Build 下运行。许多相同的原则将适用。

[http://ozgrant.com/2008/02/28/running-hp-quicktest-professional-ui-tests-with-team-build/](http://ozgrant.com/2008/02/28/running-hp-quicktest-professional-ui-tests-with-team-build/)

如果这不是问题，您将需要提供有关如何使用 QT 应用程序对象的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-27T07:32:53.553

使用以下内容：

```
Object oQTPapp;

oQTPapp = Server.CreateObject("QuickTest.Application");

Application qtpApp = (Application) oQTPapp; 
```

希望它能解决您的问题。

# vim - Vim/GVim 可以在编辑文件时显示同一项目中的其他文件吗？

> ID：1002404
> 
> 赞同：30
> 
> 时间：2009-06-16T15:52:25.083
> 
> 标签：vim, ide

当我在 Vim 中编辑文件时，我需要查看其他可用文件以在同一个项目中进行编辑。Vim 是否有任何项目管理功能（实际上是 GVim，如果它有任何区别的话），无论是原生的还是插件形式的？

我不是在寻找任何奢侈的东西，只是将我的文件保存在一个项目名称下的东西，以及某种缓冲区，它将显示哪些文件属于哪个项目。你知道我的意思，你在每个 IDE 中都能看到它。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-17T02:06:19.420

带书签的[NERDTree为我完成了这项工作。](http://www.vim.org/scripts/script.php?script_id=1658)它很受欢迎并且最近已经更新，而 Project 已经几年没有更新了。

命令

```
:Bookmark proj1 " to bookmark a directory
:NERDTree proj1 " opens NERDTree with bookmarked directory set as tree root 
```

甚至有方便的文件系统命令来创建/删除文件/目录等

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-16T16:11:13.930

我使用[Project](http://www.vim.org/scripts/script.php?script_id=69)插件已经有一段时间了。我对此相当满意。我确实对我的进行了一次修改，以便我可以在整个项目中生成标签。使用窗口内的“\C”命令将新项目添加到项目窗口相当容易。它会提示您输入某些参数，例如路径、目标目录、项目名称和要包含的文件类型，然后它将递归路径以查找所有文件，然后将它们显示在窗口中。一定要保存！

项目插件的缺点是它只跟踪文件而不跟踪每个项目相关的某些环境变量。如果您只有一个项目，这没什么大不了的。Project 插件可以通过添加更多来跟踪其窗口中的多个项目，但您不能真正在项目环境之间无缝“切换”。

这就是为什么我发现[SessionMan](http://www.vim.org/scripts/script.php?script_id=2010)对于项目会话管理是必不可少的。在不同代码项目之间来回跳转时会派上用场。我基本上给每个会话一个类似于我的项目名称的名称。在每个会话中，我将项目插件命令 (:Project YourProject)) 映射到可以在每个会话中检索项目的键。此外，它有助于在每个会话的基础上保存您的路径。这有助于全功能和标签导航的标签查找以及用于打开头文件的“gf”键组合。

这两个插件一起工作得很好。

有一个名为[MyProjects](http://www.vim.org/scripts/script.php?script_id=2556)的较新插件，但我最后一次尝试它时遇到了一些我不习惯的窗口和缓冲区问题。它也不适用于我的会话管理插件。它仍处于早期开发阶段。

编辑：我也刚刚在网上找到[了 exVIM](https://github.com/exdev/exvim)。它看起来很有趣，可能正合您的胃口。我可能不得不自己尝试一下。请注意，有多个安装选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T10:42:46.800

exVim 可以满足您的需求。它有一个项目窗口可以浏览特定的目录，还有一些有用的插件来简化开发。

这是链接： [http ://code.google.com/p/exvim/](http://code.google.com/p/exvim/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T16:04:16.630

[在这里](http://blog.dispatched.ch/2009/05/24/vim-as-python-ide/)找到了一个有趣的链接。它主要以 Python 为中心，但我认为它可以帮助您入门。

# javascript - jQuery coda 滑块效果导航停止

> ID：1002413
> 
> 赞同：2
> 
> 时间：2009-06-16T15:55:07.330
> 
> 标签：javascript, jquery, slider, coda-slider

我正在使用此处描述的 Coda Slider 效果：http: [//jqueryfordesigners.com/coda-slider-effect/](http://jqueryfordesigners.com/coda-slider-effect/) 。它工作得很好，但我需要再添加一个功能，但我不知道如何实现这一点：我希望导航在最后一个和第一个选项卡处停止。如果我在第一个/最后一个选项卡上，我希望左/右按钮消失或变为非活动状态。

任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T19:49:35.797

我认为在此代码的滚动选项部分中，您需要添加

**循环：'假'，**

serialScroll 上的文档说，如果 cycle 设置为 true，“第一个元素将在遍历最后一个元素后显示，反之亦然。” 设置为 false*应该*禁用此行为，而无需手动禁用您的按钮。

# javascript - 带有自动完成和分页功能的 Yui 数据表

> ID：1002421
> 
> 赞同：0
> 
> 时间：2009-06-16T15:55:38.953
> 
> 标签：javascript, yui, pagination, yui-datatable

我试图了解如何将服务器端分页用于动态数据（我看到示例：http: [//developer.yahoo.com/yui/examples/datatable/dt_dynamicdata.html](http://developer.yahoo.com/yui/examples/datatable/dt_dynamicdata.html)）。

我的问题是我无法自定义我的请求，当我尝试分页时，我的请求是：qct-list.htmlsort=geneid&dir=asc&startIndex=50&result=25

请求应采用以下形式：qct-list.html?name=cd4&symbol=cd4&start=0&limit=25 或 qct-list.html?name=cd4&symbol=cd4&start=25&limit=50 ...

这是我的代码的副本（部分）：

```
 var myColumnDefs = [
            {key:"geneid", label:"Gene", sortable:true},
            {key:"name", label:"Name", sortable:true},
            {key:"symbol", label:"Symbol", sortable:true},
            {key:"lastupdated", label:"Last Updated", formatter:"date", sortable:true},
            {key:"lastmodified", label:"Last Modified", formatter:"date", sortable:true}
        ];

        var myDataSource = new YAHOO.util.DataSource("qct-list.html");
        myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSON;
        myDataSource.connXhrMode = "queueRequests";
        myDataSource.responseSchema = {
            resultsList: "geneItemList",
            fields: ["col","qv","limit","start","geneid","name","symbol","lastupdated","lastmodified"],
            metaFields: {
                    totalRecords: "totalRecords" // Access to value in the server response
                }
        };

        var qctPaginator = new YAHOO.widget.Paginator({
            rowsPerPage: 25,
            totalRecords : YAHOO.widget.Paginator.VALUE_UNLIMITED,
            template: YAHOO.widget.Paginator.TEMPLATE_ROWS_PER_PAGE,
            rowsPerPageOptions: [25,50,75,100]
                        });

        var myRequestBuilder = function(ostate, oSelf) {
            oState = oState || {pagination:null};
            var name = Dom.get('dt_input_name').value;
            var symbol = Dom.get('dt_input_symbol').value;
            var start = (oState.pagination) ? oState.pagination.recordOffset : 0;
            var limit = (oState.pagination) ? oState.pagination.rowsPerPage : 25;
            return  "?name=" + name + "&symbol"+ symbol + "&start=" + start + "&limit=" + limit;
        }

        var oConfigs = {
            dynamicData: true, // Enables dynamic server-driven data
            selectionMode: "single",
            paginator: qctPaginator ,
            generateRequest : myRequestBuilder,
            paginationEventHandler : YAHOO.widget.DataTable.handleDataSourcePagination,
            initialRequest: "?name=&symbol=&start=0&limit="
        };

        var myGeneListTable = new YAHOO.widget.DataTable("geneListTable", myColumnDefs, myDataSource, oConfigs);

        myGeneListTable.handleDataReturnPayload = function(oRequest, oResponse, oPayload) {
            oPayload.totalRecords = oResponse.meta.totalRecords;
            return oPayload;
        } 
```

有人可以解释如何使用 DataTable 的分页以及如何个性化请求吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T14:52:35.330

我几乎设法使它成为我的分页。我的 RequestBuilder 现在工作正常，我收到了我需要的请求：qct-list.html?name=interferon&symbol=&start=25&limit=25

这里是新代码：

```
var myColumnDefs = [
 {key:"geneid", label:"Gene", sortable:true},
 {key:"name", label:"Name", sortable:true},
 {key:"symbol", label:"Symbol", sortable:true},
 {key:"lastupdated", label:"Last Updated", formatter:"date", sortable:true},
 {key:"lastmodified", label:"Last Modified", formatter:"date", sortable:true}
];

var myDataSource = new YAHOO.util.DataSource("qct-list.html");
 myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSON;
 myDataSource.connXhrMode = "queueRequests";
 myDataSource.responseSchema = {
 resultsList: "geneItemList",
 fields: ["col","qv","limit","start","geneid","name","symbol","lastupdated","lastmodified"],
 metaFields: {
                    totalRecords: "totalRecords" // Access to value in the server response
                }
};

var qctPaginator = new YAHOO.widget.Paginator({
    rowsPerPage: 25,
    rowsPerPageOptions: [25,50,75,100]
    });

var myRequestBuilder = function(oState,oSelf)
{
 oState = oState || {pagination:null, sortedBy:null};
 // var sort = (oState.sortedBy) ? oState.sortedBy.key : "geneid";
 // var dir = (oState.sortedBy && oState.sortedBy.dir === YAHOO.widget.DataTable.CLASS_DESC) ? "desc" : "asc";
    var start = (oState.pagination != null) ? oState.pagination.recordOffset : 0;
    var limit = (oState.pagination != null) ? oState.pagination.rowsPerPage : 25;
    var name = Dom.get('dt_input_name').value || "";
    var symbol = Dom.get('dt_input_symbol').value || "";

    return '?name='+ name + '&symbol=' + symbol + '&start='+ start + '&limit=' + limit;

}

var oConfigs = {
  initialRequest: "?name=interferon&symbol=&start=&limit=",
  dynamicData: true, // Enables dynamic server-driven data
  selectionMode: "single",
  paginator: qctPaginator,
  generateRequest : myRequestBuilder
};

var myGeneListTable = new YAHOO.widget.DataTable("geneListTable", myColumnDefs, myDataSource, oConfigs);

 myGeneListTable.handleDataReturnPayload = function(oRequest, oResponse, oPayload) {

    if (oPayload == undefined) {
        oPayload = {};  
    }
    oPayload.totalRecords = oResponse.meta.totalRecords;
    return oPayload;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T12:20:46.603

我认为您需要交换 oConfigs 和 myRequestBuilder 的声明，以便

```
var myRequestBuilder = ...

var oConfigs = ... 
```

# c# - 如何阻止自定义性能计数器实例名称自动转换为小写

> ID：1002427
> 
> 赞同：8
> 
> 时间：2009-06-16T15:56:10.950
> 
> 标签：c#, performance

我创建了一个多实例性能计数器，并将混合大小写的实例名称传递给它，但是当我通过代码和 perfmon 查看它们时，不知何故实例名称被转换为小写。有谁知道如何防止这种情况？在 google 上找到[了这个](http://bytes.com/groups/net/609743-performancecounter-multiple-instances)，觉得 Luke Zhang 从不跟进很好。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-27T01:13:34.980

我使用 Reflector 查看 System.dll 中 PerformanceCounter 的代码。在私有 Initialize 事件中是这个小块：

```
this.sharedCounter = new SharedPerformanceCounter(categoryName.ToLower(CultureInfo.InvariantCulture), this.counterName.ToLower(CultureInfo.InvariantCulture), this.instanceName.ToLower(CultureInfo.InvariantCulture), this.instanceLifetime); 
```

我认为这就是原因。

# java - 为什么 JSP/JSTL 除以 1000 有时会给出余数？

> ID：1002430
> 
> 赞同：2
> 
> 时间：2009-06-16T15:56:23.850
> 
> 标签：java, jsp, floating-point, jstl

当除以 1000 时，我有时会遇到一个错误，它不能“正确”地进行除法。例如，当将 90.55 除以 1000 而不是得到 0.09055 时，我得到 0.090549999999。

```
<c:out value="${bean.paPrice / 1000}" /> 
```

为什么会这样？这是浮点数学的结果吗？谷歌搜索似乎表明这可能是罪魁祸首，但我没有找到具体的答案。

为了解决这个问题，我可以将答案四舍五入到 5 位，但这似乎只是一个更深层次问题的补丁。

```
<fmt:formatNumber type="number" maxFractionDigits="5" value="${bean.paPrice / 1000}" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:58:59.000

这不是问题，它只是浮​​点二进制表示的自然结果。四舍五入你的价值观，不要担心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:58:43.087

为什么计算机数学不好？

[http://www.codinghorror.com/blog/archives/001266.html](http://www.codinghorror.com/blog/archives/001266.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:58:08.767

是的，这是一个常见的[浮点格式](http://en.wikipedia.org/wiki/Floating_point)问题。

# multithreading - 哪些脚本语言支持多核编程？

> ID：1002440
> 
> 赞同：11
> 
> 时间：2009-06-16T15:58:18.063
> 
> 标签：multithreading, multiprocessing, multicore, green-threads

我编写了一个小 Python 应用程序，在这里您可以看到任务管理器在典型运行期间的外观。 [（来源：][[weinzierl.name](http://weinzierl.name/temp/multicore-hires.png)][）][![](../Images/21870492608be27caf596e3a58b45345.png)](https://i.stack.imgur.com/CgklH.png)

虽然该应用程序完全是多线程的，但不出所料，它只使用一个 CPU 内核。尽管大多数现代脚本语言都支持多线程，但脚本**只能在一个 CPU 内核上运行**。

Ruby、Python、Lua、PHP 都只能在单核上运行。甚至据说对并发编程特别擅长的 Erlang 也受到了影响。

是否有一种脚本语言内置了对不限于单个内核的线程的支持？

**包起来**

答案并不完全符合我的预期，但[答案`TCL`很](https://stackoverflow.com/questions/1002440/which-scripting-languages-support-multi-core-programming/1002508#1002508)接近。我想补充一下`perl`，它（很像`TCL`）有基于解释器的线程。

[Jython、IronPython](https://stackoverflow.com/questions/1002440/which-scripting-languages-support-multi-core-programming/1002477#1002477)和[Groovy](https://stackoverflow.com/questions/1002440/which-scripting-languages-support-multi-core-programming/1002458#1002458)属于将一种经过验证的语言与另一种语言的经过验证的虚拟机相结合的范畴。感谢您在这个方向上的提示。

我选择[Aiden Bell 的](https://stackoverflow.com/questions/1002440/which-scripting-languages-support-multi-core-programming/1002460#1002460)答案作为*Accepted Answer*。他没有建议一种特定的语言，但他的评论对我来说是最有见地的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T16:13:00.343

您似乎使用了“脚本语言”的定义，这可能会引起一些人的注意，我不知道这对您的其他要求意味着什么。

无论如何，你考虑过TCL吗？我相信它会做你想做的事。

由于您在列表中包含了相当通用的语言，因此我不知道您可以接受多重的实现。如果不计其数的 Scheme 实现之一不适用于本机线程，我会感到惊讶，但在我脑海中，我只记得 MzScheme 曾经使用过，但我似乎记得支持已被删除。当然，一些常见的 LISP 实现可以很好地做到这一点。如果 Embeddable Common Lisp (ECL) 可以，它可能对你有用。我不使用它，所以我不确定它的线程支持状态是什么，这当然可能取决于平台。

**更新** 另外，如果我没记错的话，GHC Haskell 并没有完全按照你的要求做，但可能会有效地做你想做的事，因为我记得，它会在每个核心左右旋转一个本机线程，然后运行它跨越那些线程....

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T16:04:46.800

您可以在 Jython（在 JVM 上，正如 @Reginaldo 提到的 Groovy 一样）和 IronPython（在 .NET 上）等实现中使用 Python*语言*自由地多线程。对于 Python 语言的经典 CPython 实现，正如@Dan 的评论所提到的，`multiprocessing`（而不是`threading`）是自由使用尽可能多的可用内核的方式

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T16:00:56.097

由于[Groovy](http://groovy.codehaus.org/)基于 Java 虚拟机，因此您可以获得对真正线程的支持。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T16:01:07.597

**线程语法可能是静态的，但跨操作系统和虚拟机的实现可能会发生变化**

您的脚本语言可能在一个操作系统上使用真线程，而在另一个操作系统上使用假线程。

如果您有性能要求，则可能值得考虑确保脚本线程落入操作系统中最有益的层。用户空间线程会更快，但对于很大程度上阻塞线程活动，内核线程会更好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-10T22:49:53.790

.NET 4 上的 F# 对并行编程具有出色的支持和极好的性能，并且支持专门为脚本编写的 .fsx 文件。我使用 F# 编写所有脚本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-06-19T11:29:21.837

这个问题的答案已经被接受，但只是补充一点，除了 tcl，我所知道的支持多线程和线程安全编程的唯一其他解释脚本语言是[Qore](http://qore.org)。

Qore 自下而上设计为支持多线程；该语言的每个方面都是线程安全的；该语言旨在原生支持 SMP 可扩展性和多线程。例如，您可以使用`background`运算符来启动新线程或使用`ThreadPool`类来管理线程池。Qore 还将抛出具有常见线程错误的异常，以便程序员立即看到线程错误（如潜在的死锁或线程 API 的错误，如试图获取当前线程已持有的锁）。

Qore 还支持线程资源；例如，`DatasourcePool`分配被视为线程本地资源；如果您在结束线程之前忘记提交或回滚事务，则`DatasourcePool`该类的线程资源处理将自动回滚事务并抛出异常，并提供有关问题及其解决方式的用户友好信息。

也许它可能对您有用 - 这里是 Qore 功能的概述：[为什么使用 Qore？](https://github.com/qorelanguage/qore/wiki/Why-Use-Qore%3F).

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-16T16:28:13.210

[CSScript](http://www.csscript.net/)与[并行扩展](http://en.wikipedia.org/wiki/Parallel_FX_Library)相结合不应该是一个糟糕的选择。您用纯 C# 编写代码，然后将其作为脚本运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-09T08:07:23.720

它与线程机制无关。问题是（例如在 python 中）您必须获取解释器实例才能运行脚本。要获取解释器，您必须将其锁定，因为它将保持引用计数等，并且需要避免对这些对象的并发访问。Python 使用 pthread，它们是真正的线程，但是当您使用 python 对象时，只有一个线程正在运行，而其他线程正在等待。他们称之为 GIL（全局解释器锁），它是使进程内部无法实现真正​​并行的主要问题。

[https://wiki.python.org/moin/GlobalInterpreterLock](https://wiki.python.org/moin/GlobalInterpreterLock)

其他脚本语言可能有同样的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-22T02:56:07.760

Guile 支持我认为是硬件线程的 POSIX 线程。

# math - 高级形式逻辑/自动机理论教科书

> ID：1002450
> 
> 赞同：13
> 
> 时间：2009-06-16T15:59:41.730
> 
> 标签：math, computer-science, logic, automata

我知道这更像是一个数学/形式语言/自动机/计算机科学问题，而不是一个编程问题，但我希望我能得到一些关于除了命题和谓词微积分之外的形式逻辑的**易于理解的教科书**（不是难以理解的专着）的建议。我对**一元二阶逻辑**和**Büchi Automata**特别感兴趣。

目前，我只发现 了 Bakhadyr Khoussainov 和 Anil Nerode 的[自动机理论及其应用。](http://books.google.com/books?id=x8IqWNscScwC)[自动机、逻辑和无限游戏](http://books.google.com/books?id=USAsFHuDvHwC)作者：Erich Grädel、Thomas Wilke（编）。和[通信系统的形式模型：语言、自动机和一元二阶逻辑](http://books.google.com/books?id=n_yJB3-8F-YC)Benedikt Bollig ......在我头上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-23T09:09:34.643

所以这是我能得到的最好的课程：

**对于逻辑初学者：**

Peter J. Cameron，*集合、逻辑和类别*，Springer，Springer 本科数学系列，1999，[URL](http://www.maths.qmul.ac.uk/~pjc/slc/)。

James L. Hein，*离散结构、逻辑和可计算性*，Jones & Bartlett Publishers，2009 年（第 3 版）[URL](http://discretestructures.jbpub.com/)。

> 计算机科学家的逻辑。

**对于自动机和形式语言的初学者：**

Michael Sipser，*计算理论导论*，课程技术，2005 年（第 2 期），[URL](http://www-math.mit.edu/~sipser/book.html)。

**和**

Alan P. Parkes，*《语言、机器和逻辑导论》*，Springer，2002 年。

**和**

Peter Linz，*形式语言和自动机简介*，Jones & Bartlett Publishers，2000 (3 ed) [URL](http://www.jbpub.com/catalog/9780763737986/)。

**和**

John E. Hopcroft 和 Jeffrey D. Ullman，*自动机理论、语言和计算导论*，Addison Wesley，1979 年，（第 1 版），ISBN：0-201-02988-X；[网址](http://infolab.stanford.edu/~ullman/ialc.html)。

**中级逻辑（本科）：**

D. 艾宾浩斯，*数学逻辑*，施普林格，[URL](http://books.google.com/books?id=rAy-NliGEPMC&dq=Mathematical+Logic+By+H.+Ebbinghaus&source=gbs_navlinks_s)。

**或者**

艾略特·门德尔森，*数理逻辑导论*，[网址](http://books.google.com/books?id=ZO1p4QGspoYC&dq=Mathematical+Logic+By+H.+Ebbinghaus&source=gbs_navlinks_s)

**高级（研究生）：**

Wolfgang Thomas，*[语言、自动机和逻辑](http://www.cs.cornell.edu/courses/cs686/2003sp/Thomas/thomas.ps)*，1996 年。

Leoni Libkin，*有限模型理论的要素*，Springer，2004，[URL](http://books.google.com/books?id=n_yJB3-8F-YC&printsec=frontcover&source=gbs_navlinks_s)，[TOC](http://www.springer.com/cda/content/document/cda_downloaddocument/9783540212027-t1.pdf?SGWID=0-0-45-117471-p30739332)。

**用于研究**

Benedikt Bolli，*通信系统的形式模型*，Springer，2006，[URL](http://books.google.com/books?id=n_yJB3-8F-YC&printsec=frontcover&source=gbs_navlinks_s)。

格雷德尔，埃里希；托马斯，沃尔夫冈；Wilke, Thomas (Eds.)，*自动机、逻辑和无限游戏*，Springer，2002，[URL](http://www.springer.com/computer/book/978-3-540-00388-5)，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T18:15:46.987

您似乎有想要从书中获得的特定主题，所以我查看了亚马逊中一些书籍的索引。虽然我从未读过这本书，但Dexter C. Kozen[的《计算理论》可能会让你感兴趣。](https://rads.stackoverflow.com/amzn/click/com/1846282977)

```
Büchi automation, 155, 159, 161, 283, 298, 343
      determinization, 167-170

monadic second-order theory
    of n successors, 154
    of successor, 154-159 
```

涵盖的页面在[Lecture 25 Automata on Infinite Strings and S1S](http://www.springerlink.com/content/t51840471507366k/)中，第一页可通过链接进行预览。

[计算理论 http://ecx.images-amazon.com/images/I/51JKHJGWBRL._BO2,204,203,35,-76_AA240_SH20_OU01_.jpg](http://ecx.images-amazon.com/images/I/51JKHJGWBRL._BO2,204,203,35,-76_AA240_SH20_OU01_.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T02:23:38.527

我听说过有关 Michael Sipser 的[*《计算理论导论》的*](https://rads.stackoverflow.com/amzn/click/com/053494728X)好消息。我实际上就在我面前，虽然我还没有开始阅读它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T02:54:04.847

这可能不是您想要的，但我从 Blackburn 等人的[Modal Logic](http://www.mlbook.org/)中学到了很多东西，并且我从 Jurafsky 和 ​​Martin 的[Speech and Language Processing](http://www.cs.colorado.edu/~martin/slp.html)中学到了我所知道的自动机，尤其是。第 2 章。如果不出意外，两者都为进一步研究提供了极好的基础。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T10:59:44.300

[我记得在《模型检查原理》中](http://mitpress.mit.edu/catalog/item/default.asp?ttype=2&tid=11481)读过 Büchi Automata ，这似乎是一本不错的书。当然，重点是模型检查的应用，但无论如何，模型检查主要是逻辑。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T14:44:14.900

你会有点惊讶，但我认为你要找的书是 Abiteboul、Hull 和 Vianu 的《数据库基础》（也被称为“爱丽丝书”，因为爱丽丝被画在封面上，并且在与作者的章节介绍对话）。这不是一本关于 SQL 的书，而是关于数据库理论的书——逻辑及其在程序和函数中的实现——所以它在查询语言的复杂性和可计算性问题上花费了很多；作者努力保持友好和交流。

# mysql - MySQL：从 2 个不同的表中选择不同的表？

> ID：1002452
> 
> 赞同：9
> 
> 时间：2009-06-16T15:59:54.303
> 
> 标签：mysql

我有 2 个不同的表，每个表都有一个名为**product_type**的列。如何在两个表中获取 product_type 的 DISTINCT 值？澄清一下，如果两个表的 product_type 都是“钻石”，我只希望它返回一次。基本上，好像两个表都组合在一起，我从中选择了不同的 product_type。

谢谢！！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-16T16:02:42.590

对包含联合的子查询使用 distinct

```
select distinct product_type from (
    select product_type from table 1
    union 
    select product_type from table 2
) t 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-16T16:42:57.287

使用 distinct 和 union：

```
select distinct product_type from table1
union
select distinct product_type from table2 
```

合并结果时，联合将删除重复项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:01:41.077

请注意，UNION 子句返回字段的唯一值，当您希望它返回所有值时，您必须使用 UNION ALL...

```
select product_type from table_a
union
product_type from table_b 
```

# exception - Ajax:ModalPopup js 异常，BackgroundCssClass 为空

> ID：1002459
> 
> 赞同：2
> 
> 时间：2009-06-16T16:01:00.733
> 
> 标签：exception, ajaxcontroltoolkit, modalpopupextender, css

我使用了一个模态弹出扩展器，我按照工具包示例页面上的所有说明进行操作，除了我没有设置属性 BackgroundCssClass。

这就是发生的事情： ![替代文字](../Images/07d6e6d47f680e9ebea7e4bf4c92f687.png)

有没有一种方法可以让我在不设置 cssclass 道具的情况下变得粗鲁？我不需要任何样式。

如果答案是否定的，那么请向我展示一个如何使用 cssclass 设置它的示例（甚至是虚拟的）。

提前致谢。

这是代码：

```
<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<div>
    <div style="size: 100%; vertical-align: middle">
        <asp:LinkButton ID="lnkUpload" Text="Upload" ToolTip="Upload new file" runat="server" OnClick="lnkUpload_Click" />
        <cc1:ModalPopupExtender ID="lnkUpload_ModalPopupExtender" runat="server" Drag="true" PopupDragHandleControlID="pnlUploadTitle" DynamicServicePath="" PopupControlID="pnlUpload" Enabled="True" TargetControlID="lnkUpload" CancelControlID="btnCancel" />
    </div>
    <asp:Panel ID="pnlUploadTitle" runat="server" Visible="false">
        <center>
            Upload file
        </center>
    </asp:Panel>
    <asp:Panel ID="pnlUpload" runat="server" Visible="false">
        <center>
            <br />
            <asp:FileUpload ID="upFiles" runat="server" /><br />
            <br />
            <asp:Button ID="btnUpload" runat="server" Text="Upload" OnClick="btnUpload_Click" />
            &nbsp;<asp:Button ID="btnCancel" runat="server" Text="Cancel" />
            <br />
        </center>
    </asp:Panel>
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:22:19.280

您可以在实际的 HTML 标记中设置 ModalPopupExtender 的 backgroundCssClass。

来自 asp.net 模式弹出页面的示例：

```
<ajaxToolkit:ModalPopupExtender ID="MPE" runat="server"
TargetControlID="LinkButton1"
PopupControlID="Panel1"
**BackgroundCssClass="modalBackground"** 
DropShadow="true" 
OkControlID="OkButton" 
OnOkScript="onOk()"
CancelControlID="CancelButton" 
PopupDragHandleControlID="Panel3" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-13T10:12:32.587

我花了很长时间寻找类似问题的解决方案将您的 PopUpControlId 设置为控件的 ClientID。

它为我解决了这个问题。

另请阅读更多信息：[**Codeplex**](http://www.codeplex.com/workitem/13703?ProjectName=AjaxControlToolkit)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T18:03:49.267

哈哈，我记得 2 年前在 AJAX beta 中没有设置 BackgroundCssClass 属性导致模态弹出不是真正的模态，而只是弹出。我记得设置一个样式类解决了这个问题。好久没用AJAX了，如果还有类似的问题，那就好笑了。无论如何，在您的 ASPX 页面内或从它引用的 CSS 文件中创建样式表类，并为其设置属性值。也许，[这](http://www.dotnetcurry.com/ShowArticle.aspx?ID=285)也会有所帮助。

# gcc - GCC：使用 -pedantic 时是否可以禁用“枚举器列表末尾的逗号”警告？

> ID：1002462
> 
> 赞同：10
> 
> 时间：2009-06-16T16:01:11.933
> 
> 标签：gcc, enums

我正在编译 C++ 代码，我想启用 -pedantic 选项。
我正在使用 GCC 4.0，在 Mac OS X Leopard 上运行 Xcode。
例如，可以允许`long long`使用 -pedantic 时通常禁止的可变参数宏和类型（使用 -Wno-variadic-macros 和 -Wno-long-long）。但我找不到任何东西来禁用“*枚举器列表末尾的逗号*”警告。
可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T16:14:19.827

枚举数末尾的逗号在 C99 中有效，但在 C89 中无效，因此如果您的代码是有效的 C99，则以下内容将起作用

```
gcc -std=c99 -pedantic foo.c 
```

我相当确定它在 C++（根据 g++）中根本无效

编辑：在 HP-UX 上使用 GCC 4.2.1 对此进行了测试，并且没有错误/警告 foo.c

```
int main(int argc, char** argv) {
    enum { A, B, };
    return 0;
}

gcc -std=c99 -pedantic foo.c 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T12:36:48.923

在 C++ 中还不能禁用它，即使它在 C++11 中是合法的。所以将来，当 GCC 被纠正时， -std=c++11 应该禁用它。

-std=c99 仅适用于 C，而不适用于 C++（如问题所示）。

# sql-server-2008 - SSRS 2008 正确显示日期日期类型

> ID：1002469
> 
> 赞同：0
> 
> 时间：2009-06-16T16:02:42.730
> 
> 标签：sql-server-2008, datetime, reporting-services, ssrs-2008

我正在使用 SQL 2008 和 SSRS 2008：

```
CREATE TABLE [dbo].[DimDates](
    [pkDateID] [int] NOT NULL,
    [FullDate] [date] NULL,
    [DayNumberOfWeek] [tinyint] NULL,
    [DayNameOfWeek] [varchar](9) NULL,
    [IsLastDayOfMonth] [char](1) NULL,
    [MonthName] [varchar](9) NULL,
    [CalendarDay] [smallint] NULL,
    [CalendarWeek] [tinyint] NULL,
    [CalendarMonth] [tinyint] NULL,
    [CalendarQuarter] [tinyint] NULL,
    [CalendarYear] [smallint] NULL,
    [FiscalDay] [smallint] NULL,
    [FiscalWeek] [tinyint] NULL,
    [FiscalMonth] [tinyint] NULL,
    [FiscalQuarter] [tinyint] NULL,
    [FiscalYear] [smallint] NULL,
)
GO

CREATE PROCEDURE [dbo].[LookupWeek]
    @StartDateID int = NULL
AS
    IF @StartDateID IS NULL
        SELECT
            dd.pkDateID
            , dd.FullDate
        FROM
            dbo.DimDates dd
        WHERE
            dd.DayNumberOfWeek = 7
            AND dd.FullDate <= GETDATE()
        ORDER BY
            dd.pkDateID DESC
    ELSE
        SELECT
            dd.pkDateID
            , dd.FullDate
        FROM
            dbo.DimDates dd
        WHERE
            dd.DayNumberOfWeek = 7
            AND dd.pkDateID >= @StartDateID
            AND dd.FullDate <= GETDATE()
        ORDER BY
            dd.pkDateID DESC
RETURN 0
GO 
```

我们使用上面的 sp 来填充 SSRS 报告中的 @StartDate 和 @EndDate。在参数的下拉框中显示 FullDate 时会出现此问题，它不显示为日期，而是显示为日期时间并将 12:00:00 AM 添加到每一行。

任何想法为什么或如何阻止它？

谢谢，

——亚伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:05:18.563

因为它是一个日期时间对象，您要么需要对字段 ( `Split(field, " ")(0)`) 进行拆分，要么使用 DateFormat 并提供所需的格式字符串 ( `=FormatDateTime(today, dateformat.shortdate)`)

那是设计在报告中，而不是在 sql 中。

或者将文本框上的格式属性设置为“d”，表示日期时间短

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-23T11:59:54.173

我觉得这是一个错误。我也对此感到沮丧。在数据库中，该列明确定义为“DATE”，当您在 SSRS 中创建数据集时，它表示为“DATETIME”。这完全是公牛......他们为什么不能在自己的产品之间尊重自己的数据类型。我不想对数据库中由其类型定义的东西进行任何花哨的重新格式化。

我希望他们在 R2 中修复它，但是，梦想吧。:(

# java - 客户端 jar 中的 log4j.xml

> ID：1002471
> 
> 赞同：5
> 
> 时间：2009-06-16T16:03:08.173
> 
> 标签：java, client, log4j

我有一些 jar 文件将分发给使用 log4j 进行日志记录的客户端。我的问题是我应该在 jar 文件中包含一个 log4j.xml 配置，还是让客户在他们想要记录时提供一个？

我的感觉是将 log4j.xml 配置文件保留在**客户**端 jar 之外，因为 apache jar 文件都带有 log4j 日志记录，但没有 log4j.xml。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T16:12:22.510

是的，别说了。当您的 log4j 配置文件被忽略时，这是一件非常令人讨厌的事情，因为您的应用程序的 60 个第三方库之一包含它自己的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T16:29:28.233

在您的情况下，log4j 的好处是您的 jar 真的不必担心它。log4j 的基本用例是：

1.  获取当前类的记录器对象
2.  调用该记录器上的方法之一，例如`debug("some message");`

如果您要运送的 jar 将由更大的应用程序使用，那么理想情况下，您的代码将只执行上面列出的两个步骤。这样，您的代码将简单地从客户端应用程序中已配置的 log4j 实例中获取记录器对象。然后，您的生产代码就不必知道如何配置 log4j。

开发 jars 时需要查看的任何日志记录都可以通过在单元测试 setUp() 方法中配置 log4j 实例或类似的东西来完成，这些实例不会与发送到客户端的生产代码捆绑在一起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T18:29:43.063

我会在文档中放置一个您期望对您的客户有用的默认 log4j 配置。通过这种方式，感兴趣的人可以看到您有哪些日志记录选项（从用户的角度来看，通常某些类有更有趣的日志消息）。当我有一个使用 log4j 的第三方库并且它没有文档时，我觉得这很烦人，并且我的屏幕上有日志消息，我必须尝试弄清楚如何启用或抑制某些日志消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T16:11:10.013

如果您在应用程序中使用 log4j，那么您将其包含在您的项目中。如果不是，那你为什么要把它放在那里？如果客户端 A 想要 log4j 1.2 版，而客户端 B 想要 log4j 1.3 版怎么办。

让他们决定他们的项目需要什么，并担心您的项目需要什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T16:49:37.003

我会添加配置 xml 并加载它，并为用户显示不同的配置和选项。这将使他们或支持人员更容易启用附加日志记录。

# documentation - Rhino Commons 和 Rhino Mocks 参考文件？

> ID：1002472
> 
> 赞同：5
> 
> 时间：2009-06-16T16:03:45.897
> 
> 标签：documentation, rhino-mocks, rhino-commons

好的，只是我，还是似乎缺少（容易找到）Rhino Commons 和 Rhino Mocks 的参考文档？我的同事已经开始使用 Rhino Mocks 和 Rhino Commons（尤其是 NHibernate 的东西），我发现了一些教程式的例子，它们很好。但是当我看到他们在他们的代码中使用了一个类时——例如，让我们选择 Rhino.Commons.NHRepository 之类的东西——我很难在网络上找到某个地方告诉我什么是 Rhino.Commons。 NHRepository 是或它的作用。我喜欢通过查看真实示例来学习，但是使用这种方法，查看类的完整文档是非常方便的，而不仅仅是当前上下文。

同样，我看到`IaMockedRepository.Expect(...)`在一些代码中使用了它，但我花了很长时间才最终找到[解释](http://ayende.com/Blog/archive/2008/05/16/Rhino-Mocks--Arrange-Act-Assert-Syntax.aspx)Rhino Mocks 的 AAA 语法的页面，这让我很清楚。

我[在 Rhino Commons 上找到了 Ayende.com wiki](http://ayende.com/wiki/Rhino+Commons.ashx)，但这似乎有许多断开的链接。对我来说，Rhino 库似乎是一组很棒的库，在文档领域需要一些绝望的社区帮助（当然，众所周知，文档并不是大多数程序员的强项，不完整的文档太常见了） . 有谁知道这是否在工作中，在某个地方需要一些志愿者记录员，或者是否有一些很棒的参考文档在那里我以某种方式错过了 Rhino Mocks 和 Rhino Commons？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:16:59.300

AFAIK 官方文档是您提到的 wiki。这是一个开放的wiki，所以如果您发现任何损坏的链接，**请**修复它们！文档是为开源项目做贡献的好方法。因此，如果您发现缺少任何内容，请将其添加到 wiki，每个人都会受益。

这就是开源项目在每个人的贡献下成长的方式。

OTOH，我认为大多数人习惯于将项目的测试视为文档，也许这就是 wiki 可能过时/不完整的原因。

如果您对 Rhino Mocks 或 Rhino Commons 有更多疑问，请使用[Rhino google 群组](http://groups.google.com/group/rhino-tools-dev)（超过 330 名成员）或[Rhino.Mocks 群组](http://groups.google.com/group/RhinoMocks)（800 名成员）。

# sharepoint - Sharepoint 中的复杂表单设计

> ID：1002475
> 
> 赞同：2
> 
> 时间：2009-06-16T16:04:19.250
> 
> 标签：sharepoint, infopath

我正在尝试为具有以下两个特征的 WSS 3.0 构建一个表单：

1.  每个记录中有几个子记录，其中包含很少的特定字段。
2.  可以导出为 HTML 或可以在每个浏览器中查看的类似内容。

我意识到（除非我弄错了）我只能通过使用 InfoPath 和 RepeatingSection/RepeatingTable/etc 来实现 1。

至于 2，我看到 InfoPath 只能导出到 MHT/PDF/XLS，对我来说并不理想，因为目标是创建一个可以发布到网络的东西。

关于实现这一目标的更好方法的任何提示？

更正 2：我的意思是 InfoPath 表单应该在我们的 Intranet 中是可编辑的，但导出为我们网站的只读网页。所以我的意思是“出口”而不是“出版”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T07:29:46.080

> 至于 2，我看到 InfoPath 只能导出到 MHT/PDF/XLS，对我来说并不理想，因为目标是创建一个可以发布到网络的东西

不对，InfoPath 表单可以发布到 Web。通过 InfoPath 客户端将表单发布到 SharePoint 时，您可以选择一个选项，说明此表单应可在浏览器中进行编辑。但请注意，当您这样做时，InfoPath 的某些表单功能不可用。

还是你对“可以发布到网络”有不同的理解？对我来说，这意味着，在 InfoPath 表单附加到的库中创建一个新项目 --> 在浏览器中打开表单 --> 用户填写表单 --> 用户单击保存按钮 --> 信息路径文档被保存到库并关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T19:57:48.213

Perhaps creating a custom fieldtype is a possiblity. Create a fieldtype that has some kind of collection as value.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T08:17:46.747

只是一个想法：

如果 InfoPath（连同 MOSS）不是一个选项，那么如果您希望将数据输出到 SP 列表中，那么也许您可以通过自定义编辑表单来模仿它的行为。我正在考虑使用动态 html 控件（用于子记录）的自定义编辑表单，您可以通过根据树结构的需要将对象动态插入 DOM 来实现。然后，在表单提交时，列表中的事件处理程序将解析表单提交的数据并将其存储为您认为合适的数据（例如，在自定义字段中序列化的 xml 中）。

如果它不是列表的自定义编辑表单，那么可以将上述相同的功能存储在带有代码隐藏的站点页面中（注意自定义），并使用隐藏的 SP 列表作为您的数据存储。

至于导出部分，也许链接在该列表的 ECB 菜单中的应用程序页面会获得上述 xml 并很好地显示它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:32:27.193

一种方法是使用数据库作为表单的主要数据源，以便所有表单数据都保存在那里。然后，您可以构建一个网站，查询数据库中的所有信息。

另一种选择是获取 infopath 表单数据（保存为 xml 文件）并使用 XML 样式表将其发布到 Web 服务器上以定义其格式。您可以通过 ASP.net 中的 XML 控件来执行此操作。

这些解决方案可能比其他解决方案需要更多的肘部润滑脂，但我相信任何一种都可以。

# wpf - 将 XPS 转换为 PDF（反之亦然）的最佳方法？

> ID：1002476
> 
> 赞同：15
> 
> 时间：2009-06-16T16:04:42.620
> 
> 标签：wpf, xaml, pdf-generation, xps, xps-generation

我有从充当模板的 XAML 用户控件生成的 XPS 文档。我想使用基于 .NET 的 API 以编程方式将 XPS 文档转换为其他格式，主要是 PDF。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-10T15:24:53.893

您还可以使用 .NET 的 ABCpdf PDF 组件。版本 7 可以满足您的目的。见[http://www.websupergoo.com/abcpdf-12.htm](http://www.websupergoo.com/abcpdf-12.htm)。

它提供了与 NiXPS 不同的全功能试用版，并且几乎与 NiXPS 一样快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T17:09:10.417

我过去这样做的方法是将我的 XPS 文件打印到 PDF 打印机。我为此使用[了cutePDF](http://www.cutepdf.com/Products/CutePDF/writer.asp)。因此，当您选择打印时，您将打印到打印 PDF 版本的 cutePDF。

我不确定这是否能满足您的需求，但过去对我来说效果很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-04T12:12:48.860

如果你有 OneNote，你可以打印到 OneNote，然后至少在 OneNote 2013 中导出为 PDF。这似乎比安装另一个第三方工具要好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T02:55:52.447

经过大量搜索，我找到了这个 SDK：

[NiXPS](http://nixps.com/library.html)

它有点贵，但效果很好。再见啦！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-04T12:19:55.073

如果您想在自己的程序中执行此操作，CloudConvert 有一个由 MadScripter 在 .NET 框架上构建的免费开源 API。

[https://github.com/MadScripter/CloudConvert-.NET-Wrapper/](https://github.com/MadScripter/CloudConvert-.NET-Wrapper/)

# session - 使用 Mochiweb 处理用户会话

> ID：1002479
> 
> 赞同：2
> 
> 时间：2009-06-16T16:05:14.477
> 
> 标签：session, erlang

我有一个基于 PHP 的应用程序正在运行。用户登录，并执行一些操作。我设置了一个反向代理来单独转发某些请求以由 mochiweb 服务器处理 - 例如，任何带有 mysite.com/mochiweb 的请求 URL 都会被路由到 mochiweb 服务器。

现在，我的问题是如何使用 PHP 发出的会话信息来验证这个请求？我只希望通过 PHP 前端登录的用户能够访问 mochiweb 网络服务器的服务。不应直接提供任何杂散请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T20:48:43.653

您可以让 erlang 服务器向 php 服务器发送带有所述会话 cookie 的 http 请求，并让 php 服务器返回会话是否有效。例如，这是我通过 recaptcha 验证网站的方式

```
-module(ed_recaptcha).

-license("GPL3").

-export([verify/4]).

-define(RECAPTCHA_URL, "http://api-verify.recaptcha.net/verify").

verify(Private_Key, Remote_Ip, Challenge, Response) ->
    Body = list_to_binary(
             io_lib:format(
               "privatekey=~s&challenge=~s&response=~s&remoteip=~s",
               [Private_Key, Challenge, Response, Remote_Ip])),
    case http:request(post, {?RECAPTCHA_URL,
                             [], "application/x-www-form-urlencoded",
                             Body},
                      [{timeout, 30000}, {sync, false}],
                      []) of
        {ok, {_Status_line, _Headers, Response_Body}} ->
            verify_response(Response_Body)
    end.

verify_response("false\nincorrect-captcha-sol") ->
    {error, robot};
verify_response("false\ninvalid-request-cookie") ->
    {error, robot};
verify_response("true\nsuccess") ->
    {ok, not_robot}. 
```

# asp.net - 如何更改用户密码？

> ID：1002487
> 
> 赞同：1
> 
> 时间：2009-06-16T16:07:16.800
> 
> 标签：asp.net, silverlight

如果我使用 Silverlight Business Application，如何更改登录用户的用户密码（以及用户配置文件中的任何字段）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T18:44:51.787

Silverlight 中没有内置的密码更改机制。您需要为此实现自己的服务。

例如：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]
public class SecurityService : ISecurityService
{
    public bool ChangePassword(string oldPassword, string newPassword)
    {
        if(!HttpContext.Current.User.Identity.IsAuthenticated)
            return false;

        return Membership.Provider.ChangePassword(HttpContext.Current.User.Identity.Name, oldPassword, newPassword);
    }
    ...
} 
```

如果这回答了您的问题，请“将其标记为答案”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T05:00:40.627

所以，我只用一种方法创建了域服务：

```
[EnableClientAccess()] 
public class DomainChangePassword : DomainService 
{ 
 [ServiceOperation] 
 public bool UserChangePassword(string userName, string oldPassword, string newPassword) 
 { 
  if (Membership.ValidateUser(userName, oldPassword)) 
  { 
   MembershipUser memUser = Membership.GetUser(userName); 
   return memUser.ChangePassword(oldPassword, newPassword); 
  } 
  return false; 
 } 
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-09-08T04:08:50.337

尝试：

```
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]
public class SecurityService : ISecurityService
{
    public bool ChangePassword(string oldPassword, string newPassword)
    {
        if(!HttpContext.Current.User.Identity.IsAuthenticated)
            return false;

        return Membership.Provider.ChangePassword(HttpContext.Current.User.Identity.Name, oldPassword, newPassword);
    }
    ...
} 
```

# java - Android：响应式用户界面的最佳实践

> ID：1002492
> 
> 赞同：2
> 
> 时间：2009-06-16T16:08:24.447
> 
> 标签：java, android, messages

我对 Android 和 Java 很陌生。在我使用 C++ 之前，事件与消息一起发送。现在，我想为 Android 平台创建相同的用户体验，如果您对将事件绑定到用户控件的最佳方式提出任何建议或意见，我将不胜感激。

下面是一个来自 C++ 的示例：

```
ON_MESSAGE(WM_RECORD_START, &CMainFrame::OnRecordStart)//Method OnRecordStarts() executes on WM_RECORD_START_MESSAGE 
```

...

```
LRESULT CMainFrame::OnRecordStart(WPARAM wParam, LPARAM lParam)
{

        m_pNetworkCtrl->SetGeoLocationInfo();
        ...
} 
```

...

```
void CMainFrame::RecordStart()
{
    PostMessage(WM_RECORD_START);
} 
```

在上述情况下，该方法`RecordStart()`绑定到 a （按下`Button`a 时执行）并发布消息。当接收到消息时，执行该方法。`Button``WM_RECORD_START``WM_RECORD_START``OnRecordStart()`

如前所述，我想创建一个响应式用户界面，但不确定如果`OnRecordStart()`直接从以下位置调用该方法是否足够好`RecordStart()`：

```
void RecordStart()
{
    OnRecordStart();
} 
```

我真的很感激你的任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T17:48:33.800

您可以通过使用[Handler](http://developer.android.com/reference/android/os/Handler.html)将[Runnable](http://developer.android.com/reference/java/lang/Runnable.html)发布到消息队列中来模拟 Android 中的 MFC 样式行为。

这是一个简单的例子

```
class MyClass
{
    Handler m_myHandler;
    Runnable m_myRunnable;

    MyClass()
    {
        m_myHandler = new Handler();
        m_myRunnable = new RUnnable()
        {
            public void run()
            {
                // do your stuff here
            }
        };
    }

    public void onclickListener(...)
    {
        // push the runnable into the message queue
        m_myHandler.post(m_myRUnnable);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T18:45:20.293

您在这里有 2 个问题。

1.  如何绑定控件。我到处使用匿名内部类。输入有点冗长，但自动完成让它变得轻而易举。

2.  如何使 UI 响应。关键是不要在 UI 线程中做任何耗时的事情。如果花费的时间超过 0.1 秒，请在工作线程中完成工作，并在任务完成时通知 UI 进行更新。另一件事是确保您不会产生大量垃圾，因为 android GC 现在非常原始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-09T14:42:53.973

对于`Button`s 我通常扩展`Button`类并覆盖`onTouchEvent()`

```
public boolean onTouchEvent (MotionEvent event) 
{
   if (event.getAction() == MotionEvent.ACTION_DOWN) 
   {
      setPressed(true);
   }
   return super.onTouchEvent(event);
} 
```

# sql - 有没有办法使用 LINQ 进行 MDX 查询？

> ID：1002496
> 
> 赞同：7
> 
> 时间：2009-06-16T16:10:01.980
> 
> 标签：sql, database, linq, mdx, cubes

任何人都知道是否有 LINQ to MDX 的计划。

当前是否存在将 LINQ 与 MDX / CUBES 一起使用的方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T23:04:13.860

答案肯定是否定的。如果您喝了 Entity Framework koolaid，您会相信如果您现在开始使用 EF（而不是 linq2sql），您将在未来免费获得 OLAP/BI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T23:00:54.677

我认为他们必须在 LINQ 中添加多个新的运算符和方法，然后才能支持 MDX 的重要子集：

```
WITH SET c0 AS 'HIERARCHIZE({[Measures].[Internet Sales Amount], [Measures].[Internet Gross Profit], [Measures].[Reseller Gross Profit], [Measures].[Average Sales Amount], [Measures].[Gross Profit]})'
SET r0_1 AS 'HIERARCHIZE(Filter(Filter({[Customer].[Customer Geography].[All Customers], AddCalculatedMembers(DESCENDANTS([Customer].[Customer Geography].[All Customers], 1))}, NOT [Customer].[Customer Geography].currentmember.parent is [Customer].[Customer Geography].[All Customers] OR vba!ucase(left([Customer].[Customer Geography].currentmember.properties("CAPTION"),1)) = "u"), NOT [Customer].[Customer Geography].currentmember.level is [Customer].[Customer Geography].[Country] OR vba!ucase(left([Customer].[Customer Geography].currentmember.properties("CAPTION"),1)) = "u"))'
SELECT NON EMPTY {[c0]}
ON COLUMNS, NON EMPTY VISUALTOTALS(FILTER({[r0_1]}
,vba!ucase(right([Customer].[Customer Geography].currentmember.properties("CAPTION"),8)) = "SUBTOTAL" OR [Measures].[Internet Gross Profit] > 80000)
, "* SUBTOTAL") ON ROWS FROM [Adventure Works]
CELL PROPERTIES VALUE, FORMATTED_VALUE, FORMAT_STRING, FORE_COLOR, BACK_COLOR 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-15T14:43:30.763

是的，现在感谢 Matt Hallmark 的这个[块](https://www.nuget.org/packages/PercolatorAnalysisServices/)“PercolatorAnalysisServices”，您可以使用 linq 查询从多维数据集（分析服务）中获取数据，并且您还可以执行完整的 mdx 查询 incode，也可以查看本[教程](https://www.codeproject.com/Articles/860143/Introduction-to-Percolator-Analysis-Services-LINQ)， 很有帮助

# asp.net-mvc - 无法让 ASP.NET MVC 应用程序重定向到未经授权的用户的错误页面

> ID：1002501
> 
> 赞同：2
> 
> 时间：2009-06-16T16:11:18.597
> 
> 标签：asp.net-mvc, model-view-controller, error-handling, web-config

我在 ASP.NET MVC 应用程序的 web.config 中进行了以下设置：

```
<authentication mode="Windows" />
<authorization>
    <allow roles="MySecurityGroup"/>
    <deny users="*"/>
</authorization>
<customErrors mode="On" defaultRedirect="Error.aspx">
    <error statusCode="401" redirect="Help.aspx"/>
</customErrors> 
```

如果您在 MySecurityGroup 中，一切正常，但如果您不在，则不会重定向到 Error.aspx 或 Help.aspx。（请注意，Error.aspx 位于 Views\Shared 中，而 Help.aspx 位于 Views\Home 中。）您得到的只是默认错误：

> “/”应用程序中的服务器错误。
> 
> 访问被拒绝。
> 
> 说明：访问处理此请求所需的资源时出错。服务器可能未配置为访问请求的 URL。
> 
> 错误消息 401.2.：未经授权：由于服务器配置，登录失败。根据您提供的凭据和 Web 服务器上启用的身份验证方法，验证您是否有权查看此目录或页面。请与 Web 服务器的管理员联系以获得更多帮助。

我究竟做错了什么？

**更新：**现在我的 web.config 是这样设置的，但它仍然无法正常工作：

```
<system.web>
    <customErrors mode="On" defaultRedirect="Help.aspx">
    </customErrors>
</system.web>

<location path="">
    <system.web>
        <authorization>
            <allow roles="MySecurityGroup"/>
            <deny users="*"/>
        </authorization>
    </system.web>
</location>

<location path="Help">
    <system.web>
        <authorization>
            <allow users="*"/>
        </authorization>
    </system.web>
</location> 
```

请注意，我可以很好地导航到 MyApp/Help 并且被正确地禁止访问该站点的其余部分，但它永远不会自动重定向到帮助页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:18:08.797

您必须明确授予其他组对 Error.aspx 和/或 Help.aspx 的访问权限，这样他们才能真正访问这些页面。按照您现在的设置方式，只有 MySecurityGroup 用户可以访问这些页面。

你需要这样的东西：

```
<location path="Error.aspx">
 <system.web>
   <authorization>
    <allow users="*"/>
   </authorization>
 </system.web>
</location> 
```

Help.aspx 也是如此。或者，您可以在文件夹级别执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-10T03:41:32.840

您想要 mvc 或 asp.net 处理的错误和帮助页面吗？目前，您将页面视为 mvc 视图，但您有映射到 asp.net 管道的重定向 url。猜测移动错误并帮助进入站点的根目录，它应该可以工作

# c++ - C++的多重继承是如何实现的？

> ID：1002503
> 
> 赞同：22
> 
> 时间：2009-06-16T16:11:37.330
> 
> 标签：c++, inheritance, compiler-construction, multiple-inheritance, language-implementation

单继承很容易实现。例如，在 C 中，继承可以模拟为：

```
struct Base { int a; }
struct Descendant { Base parent; int b; } 
```

但是对于多重继承，编译器必须在新构造的类中安排多个父级。它是如何完成的？

我看到的问题是：父母应该安排在AB还是BA，或者甚至其他方式？然后，如果我进行演员表：

```
SecondBase * base = (SecondBase *) &object_with_base1_and_base2_parents; 
```

编译器必须考虑是否改变原始指针。虚拟机也需要类似的棘手事情。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-16T16:15:39.763

以下来自 C++ 创建者的论文描述了多重继承的可能实现：

[C++ 的多重继承](http://www-plan.cs.colorado.edu/diwan/class-papers/mi.pdf)- Bjarne Stroustrup

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T16:13:55.083

有[一篇相当古老的 MSDN 文章](http://www.openrce.org/articles/files/jangrayhood.pdf)介绍了它是如何在 VC++ 中实现的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-16T16:44:10.657

> 然后，如果我进行演员表：
> 
> ```
> SecondBase base = (SecondBase *) object_with_base1_and_base2_parents; 
> ```
> 
> 编译器必须考虑是否改变原始指针。与虚拟机类似的棘手事情。

使用非虚拟继承，这比你想象的要简单——在编译转换时，编译器知道派生类的确切布局（毕竟，编译器做了布局）。通常所发生的只是从派生类指针中添加/减去固定偏移量（对于基类之一可能为零）。

对于虚拟继承，它可能会更复杂一些——它可能涉及从 vtbl（或类似的）获取偏移量。

Stan Lippman 的书[“深入 C++ 对象模型”](https://rads.stackoverflow.com/amzn/click/com/0201834545)很好地描述了这些东西可能（并且通常确实如此）如何工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T16:16:20.403

父母按照指定的顺序排列：

```
class Derived : A, B {} // A comes first, then B

class Derived : B, A {} // B comes first, then A 
```

您的第二种情况以特定于编译器的方式处理。一种常见的方法是使用大于平台指针大小的指针来存储额外的数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T16:24:57.673

这是一个有趣的问题，实际上并不是 C++ 特定的。当您拥有一种具有多重分派和多重继承的语言（例如 CLOS）时，事情也会变得更加复杂。

人们已经注意到有不同的方法来解决这个问题。在这种情况下，您可能会发现阅读一些有关元对象协议 (MOP) 的有趣内容......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T16:14:20.203

它完全取决于编译器是如何完成的，但我相信它通常是通过 vtables 的层次结构完成的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T18:04:30.980

我进行了简单的实验：

```
class BaseA { int a; };
class BaseB { int b; };
class Descendant : public BaseA, BaseB {};
int main() {
        Descendant d;
        BaseB * b = (BaseB*) &d;
        Descendant *d2 = (Descendant *) b;
        printf("Descendant: %p, casted BaseB: %p, casted back Descendant: %p\n", &d, b, d2);
} 
```

输出是：

```
Descendant: 0xbfc0e3e0, casted BaseB: 0xbfc0e3e4, casted back Descendant: 0xbfc0e3e0 
```

很高兴意识到静态转换并不总是意味着“在不触及内容的情况下更改类型”。（好吧，当数据类型不匹配时，也会对内容产生干扰，但 IMO 情况不同）。

# php - 将提交的表单信息传递回输入字段？

> ID：1002509
> 
> 赞同：0
> 
> 时间：2009-06-16T16:13:12.370
> 
> 标签：php, html, cookies, session

我编写了一个简单的输入表单，将信息编译到数据库中，但我的必填字段有问题......

如果用户忘记填写必填字段，我会使用表单通过 post 方法处理数据我想让他回到原始表单并输入他/她以前的字段。

如何将信息传递回输入标签？没有任何疯狂的脚本，有没有一种简单的方法可以做到这一点？我从会话开始，但我意识到我不知道如何将会话中存储的信息放回输入字段，这样用户就不必重新输入他们的所有信息......此外，cookie 是否会更好地用于会话？

多谢你们，

亚瑟

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T16:23:37.097

当您发布表单时，所有这些变量都会提交到名为 $_POST['input_name'] 的全局数组中，并且可以在发布到的页面上使用。很多时候，如果我做得很快，我喜欢做的就是使这些输入字段的值与要发布的值相同。

例如，假设我们有一个想要的用户名字段，但表单由于某种原因没有验证并回发给自己；我们不希望他们再次输入：

```
<input type="text" name="username" value="<?php print $_POST['username']; ?>" /> 
```

当然，当他们第一次加载页面时，该值将为空，因此那里什么都没有，但如果由于某种原因它回发，“用户名”字段将已经包含输入的信息。

更好的是 java 脚本验证，因为表单不必回发，但这会很好地完成工作！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T16:28:37.313

由于用户将您的所有数据发布给您，因此这些值也可以在您的脚本中使用。所以你可以很容易地在文本字段的情况下使用它们，但是选择选项、复选框和单选按钮需要做更多的工作：

```
<input id="myid" name="myid" type="text" 
   <?php echo !empty($_POST['myid'] ? "value=\"{$_POST['myid']}\"" ?> /> 
```

对于单选按钮，选择选项和复选框，您必须检查值以查看它是否与您当前输出的条目对应并打印*selected="selected"*。

在验证方面，您还可以进行 JavaScript 验证，以便更快地向用户提供有关可能失败的反馈。只要记住在服务器端进行相同的验证，以防有人没有启用 JavaScript 或使用 JavaScript 提交它，从而绕过您的客户端验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:21:55.100

不确定这是否是最好的方法，但您可以重定向到“重新加载”页面并使用 POST 或 GET 中的值重新输入现有字段。因此，首先验证所需的字段，如果缺少，请重定向到此页面。然后 POST 或 GET 将包含用户填写的所有值（并且缺少的必填字段已经为空白），因此您只需循环并加载提供的信息。此外，如果他们提供了不正确的信息，您可以手动清除它，这也将允许您标记缺少的必填字段。

另一种选择是将您的验证放在 JS 中，以便您在提交之前知道数据是好的。但是，我不确定是否存在安全问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T16:33:30.010

我检查是否已设置帖子值，否则您可以显示默认值，然后在输入具有焦点时使用一些 jQuery 将其删除

```
<input type="text" name="first_name" id="first_name" value="<?php if(isset($_POST['myid'])) {   echo $_POST['myid'] } else { echo "Your Name" ?>"></input> 
```

这是 jQuery，它将在文本框获得焦点时删除默认的 Your Name。

```
$(document).ready(
function(){
    $.fn.clearDefault = function() {
        return this.focus(function() {
            if( this.value == this.defaultValue ) {
                this.value = "";
            }
        }).blur(function() {
            if( !this.value.length ) {
                this.value = this.defaultValue;
            }
        });
    };
    // clear default textbox entries
    $("#first_name"). clearDefault();
} 
```

);

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T16:23:46.330

[jQuery 验证插件](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-19T18:53:31.583

```
<input type="text" name="username" value="<?php isset($_POST['username']) ? echo $_POST['username'] : null; ?>" /> 
```

会正常工作

# ruby-on-rails - 获取 Rails 模型的验证

> ID：1002511
> 
> 赞同：3
> 
> 时间：2009-06-16T16:13:58.690
> 
> 标签：ruby-on-rails, validation, model

给定一个在 model_name.rb 文件中有验证的模型，我如何手动访问这些验证？我想制作我自己的表单验证系统，它可以与内置的 Rails 技巧一起工作，并且我希望尽可能保持一切干燥。我的主要问题是我需要在任何表单值进入数据库之前进行服务器端验证（我使用的是多步表单）。

基本上我想知道是否有类似的方法

```
User.validations.each do |v|
    puts v.constraint.to_s + " " + v.message
end 
```

有没有类似的东西？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:20:26.253

> 我的主要问题是我需要在任何表单值进入数据库之前进行服务器端验证（我使用的是多步表单）。

如果您的模型根据其类文件中的验证无效，则其数据将不会保存到数据库中（除非您传递`false`给该`save`方法以抑制验证）。

*   `valid?`您可以通过调用模型的/`invalid?`方法来询问模型在任何时候是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:48:01.433

ActiveRecord 对象在有效后暴露错误方法？被调用，它会为您提供有关违反哪些验证的消息。你可以检查有效吗？然后检查您所在的表格部分是否有任何字段无效。您可以对具有字段 field1 和 field2 的表单执行类似的操作。

```
unless x.valid?
  [:field1,:field2].each do |field|
    yes_there_was_an_error if x.errors[field]
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T17:12:51.427

最好的办法是使用状态机，并在表单的各个步骤之间将数据存储在数据库中。

例如，您可以这样做`validates_presence_of :username, :if => proc {|u| u.signup_step >= 2 }`，其中`signup_step`是数据库中的整数列。

所以，即使你说你不想将它存储在表单之间的数据库中，我认为你应该这样做。如果你这样做，你可以使用常规的验证和模型，而没有讨厌的黑客攻击。老实说，我怀疑这样做是个问题。

# c - system() 的非阻塞版本

> ID：1002513
> 
> 赞同：27
> 
> 时间：2009-06-16T16:14:13.930
> 
> 标签：c, linux, operating-system

我想从我的 c 程序中启动一个进程，但我不想等待该程序完成。我可以使用 system() 启动该过程，但总是等待。有谁知道一旦进程开始就会返回的“非阻塞”版本？

[编辑-附加要求] 当原进程执行完毕后，子进程需要继续运行。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-16T16:16:55.897

一种选择是在您的系统调用中，执行以下操作：

```
 system("ls -l &"); 
```

命令行参数末尾的 & 派生了您已启动的任务。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-16T16:16:00.030

为什么不使用`fork()`and `exec()`，而根本不调用`waitpid()`？

例如，您可以执行以下操作：

```
// ... your app code goes here ...
pid = fork();
if( pid < 0 )
    // error out here!
if( !pid && execvp( /* process name, args, etc. */ )
    // error in the child proc here!
// ...parent execution continues here... 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-16T16:24:49.233

[正常的方法是popen](http://linux.die.net/man/3/popen)，实际上你不应该再使用 system() 了。
这也允许您从衍生进程的标准输入/输出读取或写入

编辑：如果您需要读写，请参阅 popen2() -thansk quinmars

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-21T14:42:51.657

您可以使用[posix_spawnp](http://www.opengroup.org/onlinepubs/009695399/functions/posix_spawn.html) () 函数。它与 system() 非常相似，而不是 fork 和 exec* 组合，但不是阻塞的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T17:33:27.643

最后，这段代码似乎可以工作。上述答案的错误混搭：

```
pid = fork();

if (!pid)
{
    system("command here &");
}

exit(0); 
```

不太清楚*为什么*它有效，但它做了我所追求的，感谢大家的帮助

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2019-11-28T07:28:20.937

如果您正在寻找在特定时间后退出的命令，如何使用“超时”命令：

例如：system("timeout 5 your command here"); // 如果进程未完成，则在 5 秒内终止命令

# apache-flex - 在 FLEX 中动态改变 Datagrid 列的宽度

> ID：1002518
> 
> 赞同：3
> 
> 时间：2009-06-16T16:14:38.547
> 
> 标签：apache-flex, dynamic, datagridview, column-width

我们是否可以通过单击列的边框来动态更改数据网格列的宽度，以显示太长而无法显示且需要滚动的完整字符串？如果是这样，如何？

另外，我们如何确保列宽根据字符数/字符串长度动态变化；因为很多时候数据太长而无法显示。在显示到数据网格之前，我们可以设置列宽以考虑数据的长度吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-23T22:26:52.850

所以我遇到了类似的问题，这就是我发现的。如果你设置：

```
horizontalScrollPolicy="off" 
```

然后列宽将自动调整大小以适应 DataGrid 的宽度。您也可以手动设置列宽，只要将滚动设置为开或关且未设置为自动。我发现了一篇关于此的有趣文章，[http://junleashed.wordpress.com/2008/07/10/flex-datagridcolumn-width-management/](http://junleashed.wordpress.com/2008/07/10/flex-datagridcolumn-width-management/)。基本上，他手动管理列宽，然后计算滚动条是打开还是关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T22:47:06.593

这是我想出的，但是对于大型数据提供者来说可能效率不高：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
    creationComplete="onComplete();">

    <mx:Script>
        <![CDATA[
            // imports:
            import mx.events.FlexEvent;
            import mx.core.UIComponent;
            import mx.controls.dataGridClasses.DataGridColumn;
            import mx.controls.Text;
            import mx.utils.ObjectUtil;
            import mx.controls.Label;
            import mx.collections.ArrayCollection;
            // data provider:
            [Bindable] private var dp:ArrayCollection = new ArrayCollection();

            private function onComplete():void {
                // populate data provider here
                // to avoid calcMaxLengths execution when the app is created:
                dp = new ArrayCollection(
                    [
                        { col1: "Short", col2: "Other column 1" },
                        { col1: "Some long string", col2: "Other column 2" },
                        { col1: "Short", col2: "Other column 3" },
                        { col1: "Short", col2: "Other column 4" },
                        { col1: "The longest value in this column", col2: "Other column 5" },
                        { col1: "Short", col2: "Other column 6" },
                        { col1: "Short", col2: "Other column 7" }
                    ]
                );
            }

            // this is going to be executed whenever the data provider changes:
            [Bindable("dataChange")]
            private function calcMaxLengths(input:ArrayCollection):ArrayCollection {
                // if there are items in the DP:
                if ( input.length > 0 ) {
                    // and no SPECIAL child exists:
                    if ( getChildByName("$someTempUICToRemoveAfterFinished") == null ) {
                        // create new SPECIAL child
                        // this is required to call measureText
                        // if you use custom data grid item renderer
                        // then create instance of it instead of UIComponent:
                        var uic:UIComponent = new UIComponent();
                        // do not show and do not mess with the sizes:
                        uic.includeInLayout = false;
                        uic.visible = false;
                        // name it to leverage get getChildByName method:
                        uic.name = "$someTempUICToRemoveAfterFinished";
                        // add event listener:
                        uic.addEventListener(FlexEvent.CREATION_COMPLETE, onTempUICCreated);
                        // add to parent:
                        addChild(uic);
                    }
                }
                // return an input:
                return input;
            }

            // called when SPECIAL child is created:
            private function onTempUICCreated(event:FlexEvent):void {
                // keep the ref to the SPECIAL child:
                var renderer:UIComponent = UIComponent(event.target);
                // output - this will contain max size for each column:
                var maxLengths:Object = {};
                // temp variables:
                var key:String = "";
                var i:int=0;
                // for each item in the DP:
                for ( i=0; i<dp.length; i++ ) {
                    var o:Object = dp.getItemAt(i);
                    // for each key in the DP row:
                    for ( key in o ) {
                        // if the output doesn't have current key yet create it and set to 0:
                        if ( !maxLengths.hasOwnProperty(key) ) {
                            maxLengths[key] = 0;
                        }
                        // check if it's simple object (may cause unexpected issues for Boolean):
                        if ( ObjectUtil.isSimple(o[key]) ) {
                            // measure the text:
                            var cellMetrics:TextLineMetrics = renderer.measureText(o[key]+"");
                            // and if the width is greater than longest found up to now:
                            if ( cellMetrics.width > maxLengths[key] ) {
                                // set it as the longest one:
                                maxLengths[key] = cellMetrics.width;
                            }
                        }
                    }
                }

                // apply column sizes:
                for ( key in maxLengths ) {
                    for ( i=0; i<dg.columnCount; i++ ) {
                        // if the column actually exists:
                        if ( DataGridColumn(dg.columns[i]).dataField == key ) {
                            // set size + some constant margin
                            DataGridColumn(dg.columns[i]).width = Number(maxLengths[key]) + 12;
                        }
                    }
                }
                // cleanup:
                removeChild(getChildByName("$someTempUICToRemoveAfterFinished"));
            }

        ]]>
    </mx:Script>

    <mx:DataGrid id="dg" horizontalScrollPolicy="on" dataProvider="{calcMaxLengths(dp)}" width="400">
        <mx:columns>
            <mx:DataGridColumn dataField="col1" width="40" />
            <mx:DataGridColumn dataField="col2" width="100" />
        </mx:columns>
    </mx:DataGrid>

</mx:WindowedApplication> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-01T14:29:07.740

我最近遇到了同样的问题，我发现的唯一解决方案是使用自定义函数来优化 DataGrid 的列宽，如下[所示](http://www.experts-exchange.com/Web_Development/Web_Languages-Standards/Flex/Q_23978113.html)：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml">
<mx:Script>
<![CDATA[
import mx.core.UITextField;
import mx.controls.dataGridClasses.DataGridItemRenderer;

public function optimiseGridColumns(dg:DataGrid):void {
                        var dgCol:DataGridColumn;
                        var renderer:UITextField;
                        var tf:TextFormat;
                        var col:int;

                        if (dg.columnCount > 0 && dg.dataProvider != null) {
                        // initialize widths array
                               var widths:Array = new Array (dg.columnCount);
                                for (col = 0; col < widths.length; ++col) {
                                        widths[col] = -1;
                                }

                        // go through each data item in the grid, estimate
                        // the width of the text in pixels
                                for each (var item:Object in dg.dataProvider) {
                                        for (col = 0; col < widths.length; ++col) {
                                                renderer = new DataGridItemRenderer();
                                                // Must add to datagrid as child so that it inherits
                                                // properties essential for text width estimation,
                                                // such as font size
                                                dg.addChild(renderer);

                                                dgCol = dg.columns[col] as DataGridColumn;
                                                renderer.text = dgCol.itemToLabel(item);
                                                widths[col] = Math.max(renderer.measuredWidth + 10,widths[col]);

                                                // remove renderer from datagrid when we're done
                                                dg.removeChild(renderer);
                                        }
                                }

                                // go through headers in the grid, estimate the width of
                                // the text in pixels, assuming the text is bold
                                for (col = 0; col < widths.length; ++col) {
                                        // it's ok to reuse renderer, but I chose not
                                        // to for safety reasons. Optimize if needed.
                                        renderer = new DataGridItemRenderer();

                                        // Must add to datagrid as child so that it inherits
                                        // properties essential for text width estimation,
                                        // such as font size
                                        dg.addChild(renderer);

                                        dgCol = dg.columns[col] as DataGridColumn;
                                        renderer.text = dgCol.headerText;

                                        tf = renderer.getTextFormat();
                                        tf.bold = true;
                                        renderer.setTextFormat (tf);

                                        widths[col] = Math.max(renderer.measuredWidth + 25, widths[col]);

                                        // remove renderer from datagrid when we're done
                                        dg.removeChild(renderer);
                                }

                                // set width of columns to determined values
                                for (col = 0; col < widths.length; ++col)
                                {
                                        if (widths[col] != -1)
                                        {
                                                dg.columns[col].width = widths[col];
                                        }
                                }
                        }
                } 

]]>
</mx:Script>
    <mx:XMLList id="employees">
        <employee>
            <name>Christina Coenraets</name>
            <phone>555-219-2270</phone>
            <email>ccoenraets@fictitious.com</email>
            <active>true</active>
        </employee>
        <employee>
            <name>Joanne Wall</name>
            <phone>555-219-2012</phone>
            <email>jwall@fictitious.com</email>
            <active>true</active>
        </employee>
        <employee>
            <name>Maurice Smith</name>
            <phone>555-219-2012</phone>
            <email>maurice@fictitious.com</email>
            <active>false</active>
        </employee>
        <employee>
            <name>Mary Jones</name>
            <phone>555-219-2000</phone>
            <email>mjones@fictitious.com</email>
            <active>true</active>
        </employee>
    </mx:XMLList>
        <mx:DataGrid id="dg1" width="100%" height="100%" rowCount="5" dataProvider="{employees}" creationComplete="optimiseGridColumns(dg1)">
            <mx:columns>
                <mx:DataGridColumn dataField="name" headerText="Name"/>
                <mx:DataGridColumn dataField="phone" headerText="Phone"/>
                <mx:DataGridColumn dataField="email" headerText="Email"/>
            </mx:columns>
        </mx:DataGrid>

</mx:Application> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T18:54:05.880

对于 Gridview 控件，您可以向下钻取 SelectedRowStyle 属性并将 Wrap 设置为 True。

# photoshop - Photoshop px 与 OS px

> ID：1002519
> 
> 赞同：4
> 
> 时间：2009-06-16T16:15:20.933
> 
> 标签：photoshop, pixel

在将作为 photoshop 文件提供的网页设计转换为 html+css 时，我对字体大小感到困惑。如下图所示，Photoshop 中的 30 像素不等于其他 Windows 程序（Mac 或其他程序不同？）或浏览器中的 30 像素。这似乎不受以不同于默认 72 的分辨率创建 Photoshop 图像的影响，并且不受 pt 和 px 之间单位变化的影响。谁能提示如何将 Photoshop 设置为使用浏览器 px 单位？ [![替代文字](../Images/7c7655fe7d186747d62147544d23ed16.png)](https://i.stack.imgur.com/yiJmn.gif)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T17:26:22.830

绘制文档中的字体大小是指点，而不是像素。将Photoshop中的字体大小更改为30pt，它们应该是相同的大小。

一个点是 1/72 英寸，像素当量取决于显示器的 DPI。在 96 DPI 30pt * 1in/72pt * 96DPI（我的屏幕分辨率）为 40px。将像素转换为点向后工作，因此 30px * 1in/96px * 72pt/1in = 22.5pt。

因此，将绘制文本大小更改为 22.5，它们应该匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:17:04.663

将其设置为 96 dpi。

# combobox - tcl/tk 小部件组合框失去焦点

> ID：1002520
> 
> 赞同：0
> 
> 时间：2009-06-16T16:15:28.517
> 
> 标签：combobox, widget, tcl, tk

tcl/tk 小部件 iwidgets::combobox 有一个可怕的缺陷：当列表消失时，焦点会从 gui 上移开，因此除非您将鼠标移出 gui 并重新移入，否则您无法输入输入框。

这个问题在其他地方已经注意到了，但是我没有看到任何解决方案。
一个。有没有办法在退出命令（-command 选项）之前重新获得焦点？湾。是否有更好的组合框小部件可用？我已经尝试过 BWidgets 的 ComboBox，但无法让它发挥作用……我不想自己构建。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:08:15.923

从 Tcl/Tk 8.5 开始，核心语言中内置了一个组合框小部件，作为 Tile 小部件集的一部分。命令是`ttk::combobox`。您可以从 ActiveState 下载 Tcl/Tk 的预构建版本，网址为：

[http://www.activestate.com/activetcl/](http://www.activestate.com/activetcl/)

有关更多信息，请参阅此处的文档：

[http://docs.activestate.com/activetcl/8.5/tcl/TkCmd/ttk_combobox.htm](http://docs.activestate.com/activetcl/8.5/tcl/TkCmd/ttk_combobox.htm)

高温下，

埃里克·梅尔斯基

# uml - 实时 UML 编辑器

> ID：1002525
> 
> 赞同：0
> 
> 时间：2009-06-16T16:16:36.380
> 
> 标签：uml

是否有任何显示实时更新的 UML 工具？
我正在尝试在线进行设计会议，轮流参与的所有人都可以更改设计并添加自己的想法。
我更喜欢桌面解决方案，但在线工具也可以。
你会如何建议这样做？

编辑：我在谈论[这样](http://sourceforge.net/projects/rtumldesigner/)的事情，但保持不变。
一位联合开发人员告诉我，它运行得并不好，而且有很多问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T16:21:56.143

我知道[Sparx Enterprise Architect](http://www.sparxsystems.com)包括链接到模型的实时讨论论坛，因此可以讨论 UML 模型的各个部分。此外，虽然我自己没有这样做，但我知道模型文件是基于数据库的，并且可以由多个用户同时更新。这既可以是用于较低级别版本的 Jet 数据库，也可以是用于企业版本的企业级数据库。

我很确定它会立即更新，尽管我无法证明我已经看到它发生了：我一直是唯一的建模者！

# sharepoint - 如何在我的 SharePoint 网站中获得多个同名列表？

> ID：1002527
> 
> 赞同：2
> 
> 时间：2009-06-16T16:16:51.683
> 
> 标签：sharepoint, sharepoint-api

我有一个从自定义网站定义创建的 SharePoint 网站。站点定义具有以下功能：

1.  自定义内容类型。
2.  其 schema.xml 文件引用该内容类型的自定义列表模板。
3.  引用我上面的列表模板功能的列表实例功能。

在站点配置过程中，我按照上面的顺序通过 C# 代码激活了这些功能中的每一个（每个都在 SPWeb 级别）。我生成的网站看起来与我预期的一样，并且工作正常，但它有一个奇怪的工件，即我的网站的“所有网站内容”页面显示了我的自定义列表两次。

我的列表运行良好——它的物品接收器正确触发并且只触发一次。在[SharePoint Manager (SPM)](http://www.codeplex.com/spm)中，我还看到列表显示了两次，当我展开树查看属性时，它们在两个列表中看起来相同（甚至列表中的列表项）。我怀疑我可能在自欺欺人，而 SPM 可能只是两次查看同一个列表，而一些实际的流氓列表位于我网站的阴影中。

那么，这里可能出了什么问题？我怎么能创建多个同名列表？如何正确创建此列表？我怎样才能正确地清理现有网站中表现出这种行为的怪异之处？

* * *

**编辑：** 为了回应 Michael Stum 的问题，我创建了这个控制台应用程序来遍历站点列表并获取 ID：

```
using (SPSite site = new SPSite("http://myserver/projects/myproject"))
{
    using (SPWeb web = site.OpenWeb())
    {
        var lists = web.Lists;
        foreach (SPList list in lists)
        {
            Console.WriteLine(list.ID + ": " + list.Title);
        }
    }
} 
```

这段代码显示了我的列表两次——相同的标题，相同的 ID。

* * *

**另一个编辑：** 我查看了该网站的 SharePoint 内容数据库，并执行了以下查询：

```
SELECT * FROM AllLists where tp_webid = '<my SPWeb guid>' 
```

这表明我从上面的 C# 代码中检索到的只有一个带有标题和 GUID 的实际列表。那么，当我浏览我的网站时，是什么导致这些多个条目出现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-11-07T08:55:56.680

我已经多次遇到这个问题。这不是错误，很可能您的列表模板的 elements.xml 中有语义错误。

如果列表定义包含多个默认视图，则会出现您上面描述的症状。检查列表模板的 elements.xml 文件并确保其中没有多个 View-Element。

亲切的问候拉蒙

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T14:28:26.270

Groenewegen 是正确的。

在子网站上运行 Export-SPWeb 然后 Import-SPWeb 将其移动到新网站集后，我最终在网站上获得了两个公告列表。

为了解决这个问题，我为列表创建了一个新的默认视图 All List Items，选择了两个 All Items 视图中的一个并将其删除，问题就解决了。

公告列表在查看所有站点内容页面上显示了两次，并且在查看所有项目页面时数据显示了两次。

此外，在创建新的默认视图之前必须采取的中间步骤是打开列表或库并将“？contents=1”添加到 URL，以便您可以打开 Web 部件维护页面并“关闭”其中一个重复项。您必须这样做，因为如果存在多个 Web 部件，Web 部件功能区将不会显示在“公告”页面上，并且您需要功能区来访问视图下拉菜单并创建新视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T19:50:51.783

I suggest you put a call in to Microsoft, this sounds like a bug.

P.S. without seeing the actual solution that creates the list we can't determine what's happening, perhaps a feature got activated twice...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T09:33:50.057

今天我遇到了这个问题，在阅读了上述答案后，我想出了一个简单的解决方案。只需创建一个新的默认视图，文档库就会再次正常显示。

亲切的问候，

蒂门·格勒内韦根

附言

我通过将库从一个地方迁移到另一个地方“创建”了相同的两个库。在老地方，图书馆只展示过一次。如果我查看该库上的默认视图，则两个视图被选中为默认值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T19:12:53.850

您是否尝试过：

***list.RootFolder.Name***

（显示“内部”名称 - 网址的一部分）

**list.Title**显示显示名称（可以出现两次或多次）。

这也可能是您获得多个列表的原因。您可能使用相同的显示名称添加了它们，但使用了不同的“内部”名称？

# sql-server - 卸载 SQL Server 的命名实例是否需要重新启动或导致现有实例出现问题？

> ID：1002535
> 
> 赞同：1
> 
> 时间：2009-06-16T16:19:27.690
> 
> 标签：sql-server, sql-server-2005, windows-server-2003

我有一个安装了默认实例和 2 个 SQL Server 2005 标准命名实例的服务器。这是一个任务关键型生产服务器，在正常工作时间内无法重新启动。

卸载 SQL Server 2005 的两个命名实例是否需要重新启动或将服务器置于可能导致 SQL Server 2005 的默认实例出现问题的状态，直到重新启动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:23:45.397

是否有需要卸载命名实例的关键原因。你能忽略它们吗？

编辑：答案是肯定的，您可以通过添加/删除程序卸载

**不会发生重新启动**

一篇可能适用于您的情况的文章：

[http://support.microsoft.com/?kbid=915854](http://support.microsoft.com/?kbid=915854)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:45:52.200

这可能会在 serverfault.com 上得到更好的答案。

我不确定它对性能有多大帮助，如果 SQL 没有受到打击，它不会做太多。您可能可以通过卸载侥幸逃脱，但在手术中又会发生坏事。我从来没有杀死 SQL 服务器卸载实例，但我已经杀死了客户端工具。我会采取以下方法之一：

a) 首先，备份并删除所有数据库以回收磁盘空间。然后停止禁用命名实例的服务。二进制文件仍然存在，但它们不会太大并且会闲置。

b) 如果您可以采购硬件，则更好的长期计划是设置一个新的从头盒并在那里放置一个干净的 SQL 实例，然后将实时服务器移植过来。真的不会太痛苦。然后根据需要重新调整旧盒子的用途。

# sql - SQL Server 中的 sp_tableoption

> ID：1002536
> 
> 赞同：2
> 
> 时间：2009-06-16T16:19:42.697
> 
> 标签：sql, sql-server, bulkinsert

我想知道为 SQL Server 2005/2008 设置“批量加载表锁定”的 sp_tableoption 的优缺点？我的场景是，我有 3 个线程在数据库上工作，一个查询线程，一个批量插入线程和一个删除线程。

这是 sp_tableoption 的 MSDN 相关链接，

[http://msdn.microsoft.com/en-us/library/ms173530.aspx](http://msdn.microsoft.com/en-us/library/ms173530.aspx)

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:27:53.287

只需在 BULK INSERT 中执行

例子

将锁定表的批量插入

```
BULK INSERT Northwind.dbo.[ORDER Details]
   FROM 'f:\orders\lineitem.tbl'
   WITH
     (
        FIELDTERMINATOR = '|',
        ROWTERMINATOR = ':\n',
        FIRE_TRIGGERS,
        TABLOCK  --this is it
      ) 
```

该语句不会锁定表

```
BULK INSERT Northwind.dbo.[ORDER Details]
       FROM 'f:\orders\lineitem.tbl'
       WITH
         (
            FIELDTERMINATOR = '|',
            ROWTERMINATOR = ':\n',
            FIRE_TRIGGERS
          ) 
```

使用 -h（用于提示）开关和“TABLOCK”的带标签块的 BCP

```
bcp pubs..authors2 in authors.txt -c -t, -Sservername -Usa -Ppass -h "TABLOCK" 
```

您可以从 SSIS 或 DTS 中进行批量插入，然后到那里的表锁

例如在转换数据任务下的 DTS 中查看选项选项卡，检查使用快速加载和表锁定 SSIS 有类似的东西

# c - 如何将日期时间转换为 c 中的 unix 时间戳？

> ID：1002542
> 
> 赞同：24
> 
> 时间：2009-06-16T16:20:55.803
> 
> 标签：c, unix, datetime, timestamp

场景是：我使用 libexif 获得格式为“YYYY-MM-DD HH:MM:SS”的日期时间。为了最大限度地减少节省成本，我想将日期时间转换为仅花费 64 位或 32 位的 unix 时间戳等。c有什么明确的方法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-16T16:35:28.777

您可以尝试结合使用[strptime](http://linux.die.net/man/3/strptime)和[mktime](http://linux.die.net/man/3/ctime)

```
struct tm tm;
time_t epoch;
if ( strptime(timestamp, "%Y-%m-%d %H:%M:%S", &tm) != NULL )
  epoch = mktime(&tm);
else
  // badness 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T16:33:29.417

将日期/时间的每个部分转换为整数以填充 a `struct tm`，然后`time_t`使用[mktime](http://linux.die.net/man/3/ctime)将其转换为 a 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:38:35.730

这是我刚刚一起破解的 c/伪代码中的有线解决方案。祝你好运！

```
char * runner = NULL;
char *string_orig = "YYYY-MM-DD HH:MM:SS";
time_t time = 0;
struct tm tmp;

use strstr(string_orig, "-") and atoi foreach

  tmp->tm_year .. 
  tmp->tm_mon  .. 
  tmp->tm_mday ..  
  tmp->tm_hour  .. 
  tmp->tm_min  .. 
  tmp->tm_sec .. 

with *runner as help

time = mktime(&tm) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-11T16:02:51.387

那么sscanf呢？

```
struct tm tmVar;
char *strVar = "YYYY-MM-DD HH:MM:SS";
time_t timeVar;
if(sscanf(strVar, "%d-%d-%d %d:%d:%d", &tm.tm_year, /* the other fields */)==6)
    timeVar = mktime(&tmVar);
else
    // bad format 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-04T09:32:04.443

当 strptime 不可用时，这是一个现成的片段：

```
#include <stddef.h>
#include <time.h> 
#include <stdio.h> 

time_t string_to_seconds(const char *timestamp_str)
{
    struct tm tm;
    time_t seconds;
    int r;

    if (timestamp_str == NULL) {
        printf("null argument\n");
        return (time_t)-1;
    }
    r = sscanf(timestamp_str, "%d-%d-%d %d:%d:%d", &tm.tm_year, &tm.tm_mon, &tm.tm_mday, &tm.tm_hour, &tm.tm_min, &tm.tm_sec);
    if (r != 6) {
        printf("expected %d numbers scanned in %s\n", r, timestamp_str);
        return (time_t)-1;
    }

    tm.tm_year -= 1900;
    tm.tm_mon -= 1;
    tm.tm_isdst = 0;
    seconds = mktime(&tm);
    if (seconds == (time_t)-1) {
        printf("reading time from %s failed\n", timestamp_str);
    }

    return seconds;
} 
```

将 sscanf 中的字符串调整为您需要的字符串。要忽略时区并始终转换为 GMT/UTC 减去`timezone`（或`_timezone`）`seconds`（`timezone`全局在 time.h 中定义。DST 已`tm_isdst`被`tm`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-31T21:41:37.133

Linux支持该`getdate()`功能，我觉得比`strptime()`直接调用更实用。这是因为该`getdate()`功能会自动为您检查*多种*格式。它相当于调用`strptime()`各种格式，直到功能正常或所有格式都经过测试。

```
// setenv() should be called only once
setenv("DATEMSK", "/usr/share/myprog/datemsk.fmt", 0);

// convert a date
struct tm * t1(getdate("2018-03-31 14:35:46"));
if(t1 == nullptr) ...handle error...
time_t date1(timegm(t1));

// convert another date
struct tm * t2(getdate("03/31/2018 14:35:46"));
if(t2 == nullptr) ...handle error...
time_t date2(timegm(t2)); 
```

注意：除了忽略语言环境并使用 UTC 之外，`timegm()`与 类似。`mktime()`在大多数情况下，这是转换日期的正确方法。

datemsk.fmt 文件将至少包含以下两种格式以支持上述日期：

```
%Y-%b-%d %H:%M:%S
%b/%d/%Y %H:%M:%S 
```

支持的格式数量不受限制，尽管您可能不想拥有太多。如果格式太多，它会很慢。您还可以动态管理格式并`strptime()`循环调用。

Linux 还提供了一个`getdate_r()`线程安全的功能。

手册页： http: [//pubs.opengroup.org/onlinepubs/7908799/xsh/getdate.html](http://pubs.opengroup.org/onlinepubs/7908799/xsh/getdate.html)

# php - 如何从 Windows cmd shell 捕获输出？

> ID：1002543
> 
> 赞同：1
> 
> 时间：2009-06-16T16:21:29.967
> 
> 标签：php, c++, windows, perl

有什么办法，比如 Perl 或 PHP，我可以从另一个输出到 Windows cmd shell 的进程中获取输出？我有一个输出某些信息的游戏服务器，例如说“玩家在 43 秒内完成曲目”，我想抓住那条线并使用 Perl 或 PHP 向网络服务器发送请求以更新网页上的排名。有没有办法在 Perl 或 PHP 中获取该输出管道？或者我可以使用 C++ Windows API 来实现这一点吗？

让我在这里澄清一下：我想执行一个单独的 Perl 或 PHP 脚本，该脚本从 Windows cmd shell 获取输出，并且显示到 Windows cmd shell 的输出来自不同的进程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T16:57:45.153

您可以使用[IPC::Open3](http://perldoc.perl.org/IPC/Open3.html)从其他进程的标准输出中读取。请注意，进程间通信假定进程之间存在父/子关系。如果不是这种情况......我不知道附加到预先存在的进程的输出的机制。在这种情况下，您可能需要更改生产者以将数据写入您的应用程序可以读取的日志文件（或数据库）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T18:00:00.773

如果您只关心 STDOUT，您可以使用[IPC::Open2 中的 open2](http://perldoc.perl.org/IPC/Open2.html)：

```
#!/usr/bin/perl

use strict;
use warnings;

use IPC::Open2;

#if there are arguments pretend to be the server
#for this example
if (@ARGV) {
    local $| = 1;
    for my $i (1 .. 100) {
        print "pid $$ iter $i\n";
        sleep 1;
    }
    exit;
}        

#run perl with the current script as its argument,
#pass in an arg so that we trigger the behaviour 
#above
open2 my $out, my $in, $^X, $0, 1 
    or die "could not run '$^X $0 1': $!\n";

while (<$out>) {
    s/[\r\n]//g;
    print "pid $$ saw [$_]\n";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T20:03:57.847

你需要在 Perl 中启动你的服务器：

```
my $server_out = `server.exe`; # Note the backticks. 
```

现在 $server_out 包含 server.exe 的输出。但这里的诀窍是你必须等到 server.exe 退出才能得到输出。

尝试[IPC::Run](http://search.cpan.org/~adamk/IPC-Run-0.82/lib/IPC/Run.pm)（它不是核心模块）

```
use English;
use IPC::Run;
my ($stdout, $stderr);

IPC::Run::run([$cmd, $arg1, $arg2, $argN], \undef, \$stdout, $stderr);

while(<$stdout>) {
  print "Cmd said $_\n";
} 
```

注意：代码未经测试。

在这里找到信息[。](https://stackoverflow.com/questions/109124/run-external-process-from-perl-capture-stderr-stdout-and-the-process-exit-code)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T16:30:07.513

在 Perl 中捕获输出很简单：

```
$output = qx(command); 
```

或者

```
$output = `command`;  # backticks 
```

参考：[perldoc perlop](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T01:19:04.167

此代码将控制台应用程序的 STDOUT 重定向到字符串列表，例如，您可以在备忘录中使用该字符串列表。它是 Delphi 代码，但在 C++ 中，基本思想完全相同。

我使用它来运行隐藏的控制台应用程序，同时将输出重定向到我自己的应用程序，以显示在窗格中。一旦数据进入，它就会在 AStrings 中添加一个新行，因此您可以在其他应用程序完成之前访问它的输出。

```
procedure RunConsoleApp(const CommandLine: string; AStrings: TStrings);
type
  TCharBuffer = array[0..MaxInt div SizeOf(Char) - 1] of Char;
const
  MaxBufSize = 1024;
var
  I: Longword;
  SI: TStartupInfo;
  PI: TProcessInformation;
  SA: PSecurityAttributes;
  SD: PSECURITY_DESCRIPTOR;
  NewStdIn: THandle;
  NewStdOut: THandle;
  ReadStdOut: THandle;
  WriteStdIn: THandle;
  Buffer: ^TCharBuffer;
  BufferSize: Cardinal;
  Last: WideString;
  Str: WideString;
  ExitCode_: DWORD;
  Bread: DWORD;
  Avail: DWORD;
begin
  GetMem(SA, SizeOf(TSecurityAttributes));

  case Win32Platform of
    VER_PLATFORM_WIN32_NT:
      begin
        GetMem(SD, SizeOf(SECURITY_DESCRIPTOR));
        SysUtils.Win32Check(InitializeSecurityDescriptor(SD, SECURITY_DESCRIPTOR_REVISION));
        SysUtils.Win32Check(SetSecurityDescriptorDacl(SD, True, nil, False));
        SA.lpSecurityDescriptor := SD;
      end; {end VER_PLATFORM_WIN32_NT}
  else
    SA.lpSecurityDescriptor := nil;
  end; {end case}

  SA.nLength := SizeOf(SECURITY_ATTRIBUTES);
  SA.bInheritHandle := True;

  SysUtils.Win32Check(CreatePipe(NewStdIn, WriteStdIn, SA, 0));

  if not CreatePipe(ReadStdOut, NewStdOut, SA, 0) then
  begin
    CloseHandle(NewStdIn);
    CloseHandle(WriteStdIn);
    SysUtils.RaiseLastWin32Error;
  end; {end if}

  GetStartupInfo(SI);
  SI.dwFlags := STARTF_USESTDHANDLES or STARTF_USESHOWWINDOW;
  SI.wShowWindow := {SW_SHOWNORMAL} SW_HIDE;
  SI.hStdOutput := NewStdOut;
  SI.hStdError := NewStdOut;
  SI.hStdInput := NewStdIn;

  if not CreateProcess(nil, PChar(CommandLine), nil, nil, True, CREATE_NEW_CONSOLE, nil, nil, SI, PI) then
  begin
    CloseHandle(NewStdIn);
    CloseHandle(NewStdOut);
    CloseHandle(ReadStdOut);
    CloseHandle(WriteStdIn);
    SysUtils.RaiseLastWin32Error;
  end; {end if}

  Last := '';
  BufferSize := MaxBufSize;
  Buffer := AllocMem(BufferSize);

  try
    repeat
      SysUtils.Win32Check(GetExitCodeProcess(PI.hProcess, ExitCode_));
      PeekNamedPipe(ReadStdOut, Buffer, BufferSize, @Bread, @Avail, nil);

      if (Bread <> 0) then
      begin
        if (BufferSize < Avail) then
        begin
          BufferSize := Avail;
          ReallocMem(Buffer, BufferSize);
        end; {end if}
        FillChar(Buffer^, BufferSize, #0);
        Windows.ReadFile(ReadStdOut, Buffer^, BufferSize, Bread, nil);
        Str := Last;
        I := 0;

        while (I < Bread) do
        begin

          case Buffer^[I] of
            #0: inc(I);
            #7: begin
                  inc(I);
                  Windows.Beep(800, 50);
                  Str := Str + '^';
                end;
            #10:
              begin
                inc(I);
                AStrings.Add(Str);
                Str := '';
              end; {end #10}
            #13:
              begin
                inc(I);
                if (I < Bread) and (Buffer^[I] = #10) then
                  inc(I);
                AStrings.Add(Str);
                Str := '';
              end; {end #13}
          else
            begin
              Str := Str + Buffer^[I];
              inc(I);
            end; {end else}
          end; {end case}
        end; {end while}
        Last := Str;
      end; {end if}
      Sleep(1);
      Application.ProcessMessages;

    until (ExitCode_ <> STILL_ACTIVE);

    if Last <> '' then
      AStrings.Add(Last);

  finally
    FreeMem(Buffer);
  end; {end try/finally}

  CloseHandle(PI.hThread);
  CloseHandle(PI.hProcess);
  CloseHandle(NewStdIn);
  CloseHandle(NewStdOut);
  CloseHandle(ReadStdOut);
  CloseHandle(WriteStdIn);

end; {end procedure} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-01T16:18:50.513

这是一个PHP特定的解决方案，该项目允许PHP获取并与真实的cmd终端动态交互。在这里获取：[https ://github.com/merlinthemagic/MTS](https://github.com/merlinthemagic/MTS)

下载后，您只需使用以下代码：

```
//if you prefer Powershell, replace 'cmd' with 'powershell'
$shellObj    = \MTS\Factories::getDevices()->getLocalHost()->getShell('cmd');

$strCmd1   = 'some_app.exe -param "test"';
$return1   = $shellObj->exeCmd($strCmd1); 
```

return 会给你命令 return OR error from cmd，就像你坐在控制台上一样。

此外，您可以针对 $shellObj 发出您喜欢的任何命令，该环境在 PHP 脚本的整个生命周期中都得到维护。因此，无需将命令捆绑在脚本文件中，只需使用 exeCmd() 方法一一发出，这样您还可以处理返回和任何异常。

# c# - 如何在 XSD 中为 byte[] 类型建模？

> ID：1002546
> 
> 赞同：3
> 
> 时间：2009-06-16T16:22:06.113
> 
> 标签：c#, java, xml, xsd

我有以下对象 XSD 类型。Data 元素实际上应该由 byte[] 类型表示，但是，我不确定如何在 XSD 中对其进行建模。有人可以帮忙吗？

```
<xs:complexType name="Attachment">
    <xs:sequence>
        <xs:element name="Data" type="xs:string"/>
        <xs:element name="Guid" type="xs:string"/>  
        <xs:element name="Name" type="xs:string"/>  
        <xs:element name="MimeType" type="xs:string"/>  
    </xs:sequence>
</xs:complexType> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T16:25:41.120

它应该被序列化为 base-64 (xsd:base64Binary] [1](http://www.w3.org/TR/xmlschema-2/#base64Binary) ) 或 hex ( [xsd:hexBinary](http://www.w3.org/TR/xmlschema-2/#hexBinary) ) 类型。

大多数序列化工具包都有一个 API 方法来读取或写入该类型的字节。例如，在 .net 中，您可以使用 Convert.ToBase64String(buffer, 0, buffer.Length) 将数组转换为 XML。

# java - 与共享主键的 OneToOne 关系生成 n+1 个选择；任何解决方法？

> ID：1002547
> 
> 赞同：7
> 
> 时间：2009-06-16T16:22:12.993
> 
> 标签：java, hibernate, jpa

想象一下关系数据库中的 2 个表，例如 Person 和 Billing。这些实体之间定义了一个（非强制性的）OneToOne 关联，它们共享Person 主键（即PERSON_ID 定义在Person 和Billing 中，后者是外键）。

通过命名查询对 Person 进行选择时，例如：

```
from Person p where p.id = :id 
```

Hibernate/JPA 生成两个选择查询，一个在 Person 表上，另一个在 Billing 表上。

上面的示例非常简单，不会导致任何性能问题，因为查询只返回一个结果。现在，想象一下与其他实体（都共享主键）`Person`具有`n`OneToOne 关系（都是非强制性的）。`Person`

如果我错了，请纠正我，但是`select`在 Person 上运行查询并返回`r`行会导致`(n+1)*r`Hibernate 生成选择，即使关联是*惰性*的。

这种潜在的性能灾难是否有解决方法（除了根本不使用共享主键）？谢谢你的所有想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-08-21T18:36:09.833

> 想象一下关系数据库中的 2 个表，例如 Person 和 Billing。在这些实体之间定义了一个（非强制性）OneToOne 关联，

默认情况下，对于非强制性 OneToOne 而言，延迟获取在概念上是不可能的，Hibernate 必须访问数据库才能知道关联是否`null`存在。此旧 wiki 页面的更多详细信息：

> ### [关于延迟加载的一些解释（一对一）](https://community.jboss.org/wiki/Someexplanationsonlazyloadingone-to-one)
> 
> [...]
> 
> 现在考虑我们的 B 类与 C 具有一对一的关联
> 
> ```
> class B {
>     private C cee;
> 
>     public C getCee() {
>         return cee;
>     }
> 
>     public void setCee(C cee) {
>         this.cee = cee;
>     }
> }
> 
> class C {
>     // Not important really
> } 
> ```
> 
> 在加载 B 之后，您可以调用 `getCee()`以获取 C。但是看， `getCee()`是您的类的方法，Hibernate 无法控制它。Hibernate 不知道什么时候有人打电话`getCee()`。`cee`这意味着 Hibernate在从数据库加载 B 时必须将适当的值放入 " " 属性中。如果启用了代理 `C`，Hibernate 可以放置一个尚未加载的 C-proxy 对象，但当有人使用它时会加载它。这为 `one-to-one`.
> 
> 但是现在想象你的`B`对象可能有也可能没有关联`C` （`constrained="false"`）。 具体没有时​​应该 `getCee()`返回什么？空值。但是请记住，Hibernate 必须在设置的那一刻设置正确的“cee”值 （因为它不知道何时有人会调用）。代理在这里没有帮助，因为代理本身已经非空对象。`B``C``B``getCee()`
> 
> 所以简历：**如果您的 B->C 映射是强制性的 ( `constrained=true`)，Hibernate 将使用 C 代理，从而导致延迟初始化。但是如果你允许 B 没有 C，Hibernate 只需要在它加载 B 的那一刻检查 C 的存在。但是一个 SELECT 来检查存在是低效的，因为同一个 SELECT 可能不只是检查存在，而是加载整个对象。所以延迟加载消失了**。

所以，不可能......默认情况下。

> 这种潜在的性能灾难是否有解决方法（除了根本不使用共享主键）？谢谢你的所有想法。

问题不在于共享主键，有或没有共享主键，你会明白的，问题是可为**空**的OneToOne。

**第一个选项**：使用字节码检测（请参阅下面的文档参考）和*无代理*获取：

```
@OneToOne( fetch = FetchType.LAZY )
@org.hibernate.annotations.LazyToOne(org.hibernate.annotations.LazyToOneOption.NO_PROXY) 
```

**第二种选择**：使用假货`ManyToOne(fetch=FetchType.LAZY)`。这可能是最简单的解决方案（据我所知，是推荐的解决方案）。但是我并没有使用共享 PK 对此进行测试。

**第三个选项**：使用`join fetch`.

### 相关问题

*   [使 OneToOne 关系变得懒惰](https://stackoverflow.com/questions/1444227/making-a-onetoone-relation-lazy)

### 参考

*   休眠参考指南
    *   [19.1.3\. 单端关联代理](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/performance.html#performance-fetching-proxies)
    *   [19.1.7。使用惰性属性获取](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/performance.html#performance-fetching-lazyproperties)
*   旧休眠常见问题解答
    *   [如何将一对一的关系设置为懒惰？](http://web.archive.org/web/20071021233649/http://www.hibernate.org/117.html#A18)
*   休眠维基
    *   [关于延迟加载的一些解释（一对一）](https://community.jboss.org/wiki/Someexplanationsonlazyloadingone-to-one)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T18:37:28.370

这是 Hibernate 的常见性能问题（只需搜索“Hibernate n+1”）。有三个选项可以避免 n+1 查询：

*   批量大小
*   子选择
*   在查询中执行 LEFT JOIN

这些在[此处](https://www.hibernate.org/118.html#A23)和[此处的 Hibernate 常见问题解答中有所介绍](https://www.hibernate.org/117.html#A30)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T08:09:29.370

**远离hibernate的OneToOne映射**

这是非常破碎和危险的。您距离数据库损坏问题只有一个小错误。

[http://opensource.atlassian.com/projects/hibernate/browse/HHH-2128](http://opensource.atlassian.com/projects/hibernate/browse/HHH-2128)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T18:05:31.170

您可以尝试“盲猜优化”，这对“n+1 选择问题”很有用。像这样注释你的字段（或吸气剂）：

```
@org.hibernate.annotations.BatchSize(size = 10)
java.util.Set<Billing> bills =  new HashSet<Billing>(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T17:03:28.480

仅当您将关系指定为惰性关系或明确指示您希望 hibernate 运行单独的查询时，才会出现“n+1”问题。

Hibernate 可以通过对 Person 的选择进行外部连接来获取与 Billing 的关系，从而完全避免了 n+1 问题。我认为这是您的 hbm 文件中的 fetch="XXX" 指示。

查看[有关获取策略的简短入门](https://www.hibernate.org/315.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-05T07:43:45.227

使用 optional =true 和这样的一对一关系来避免 n+1 问题

```
@OneToOne(fetch = FetchType.LAZY, optional=true)
@PrimaryKeyJoinColumn 
```

# asp.net - 从标准 HTML 提交和无 JavaScript 提交 ASP.NET 表单

> ID：1002549
> 
> 赞同：0
> 
> 时间：2009-06-16T16:22:22.680
> 
> 标签：asp.net

您可以在不使用跨页回发、从非 ASP.NET 控件且不使用 Javascript 的情况下向 ASP.NET 中的不同页面提交表单吗？

*我在母版页中使用带有全局表单的 ASP.NET

*我的网站需要在没有 Javascript 的情况下工作，并且我想避免使用 URL 参数。

*我正在使用它将为我的应用程序中的特定记录打开一个新页面。

*我想使用输入按钮的名称来编辑 RecordId 并将其发布到使用 HTTP POST 而不是 URL 参数的新页面。

这可以做到吗！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T16:26:27.437

不确定我是否完全理解，所以如果我离题了，我很抱歉。

您也许可以添加一个复选框，其 ID 是 RecordID，然后当您执行 HTTP POST 时，您可以遍历复选框并查看哪个复选框被选中。不过，可能有更优雅的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:29:35.563

设置帖子页面和目标（打开新窗口）：

```
this.Form.Action = "YourNextPage.aspx";
this.Form.Target = "_blank"; 
```

然后，获取下一页中的值：

```
this.Request.Form[... 
```

# .net - .NET 框架版本中对 C++/CLI 的改进

> ID：1002550
> 
> 赞同：1
> 
> 时间：2009-06-16T16:22:25.817
> 
> 标签：.net, c++-cli

随着 .NET 框架的每个新版本，C# 都有实质性的特性和改进，在从 .NET1.0 升级到 .NET2.0 的过程中，托管 C++ 被 C++/CLI 取代，这是一个很大的改进。

自 .NET2.0 以来，C++/CLI 是否有任何改进？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:10:46.920

警告：[Visual Studio 2010 不再支持 Intellisense for C++/CLI](http://blogs.msdn.com/vcblog/archive/2009/05/27/rebuilding-intellisense.aspx#9644735)。

*“虽然 C++/CLI 缺乏 Intellisense 是不幸的，但我们希望它只代表你不需要像原生代码那样经常编辑的源代码的一小部分。”*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T17:00:30.393

VC++ 2008 并没有为 C++/CLI 添加太多东西。但是，2010 年将添加许多新功能。您可以[在此处查看 VC++ 2010 中的改进](http://msdn.microsoft.com/en-us/library/dd465215(VS.100).aspx)。

2010 beta 的一项重大改进是添加了[Lambda 表达式](http://msdn.microsoft.com/en-us/library/dd293608(VS.100).aspx)。

通过 && 引用 RValue 看起来很有希望（如果有时有点混乱），并且[auto 关键字](http://msdn.microsoft.com/en-us/library/6k3ybftz(VS.100).aspx)看起来会简化很多事情。它几乎是 C# 的 var 关键字的 C++ 版本，它真正简化了 .NET 集合的使用。

其他添加的是 decltype 和 static_assert，它们看起来都很有用。

# wpf - WPF 数据绑定性能

> ID：1002557
> 
> 赞同：2
> 
> 时间：2009-06-16T16:24:03.290
> 
> 标签：wpf, performance, mvvm

我正在使用 MVVM 构建一个 wpf 应用程序。我有使用延迟加载的视图模型，如下所示：

```
public class AssignmentsViewModel
{

    List<AssignmentViewModel> _Assignments;
    public List<AssignmentViewModel> Assignments
    {
        get
        {
            if (_Assignments == null)
                _Assignments = new List<AssignmentViewModel>(Data.GetAssignments());
            return _Assignments;
        }
        set { _Assignments = value; }
    }
}
public class AssignmentViewModel
{
    List<NoteViewModel> _Notes;
    public List<NoteViewModel> Notes
    {
        get
        {
            if (_Notes == null)
                _Notes = new List<NoteViewModel>(Data.GetNotes());
            return _Notes;
        }
        set { _Notes = value; }
    }
} 
```

该视图在 ListView 中具有 AssignmentViewModels，在带有数据模板的 ListBox 中具有注释。

当我显示具有 160 个项目的 AssignmentViewModel 之一时，加载需要 1000 毫秒。我认为这是因为 Notes 属性从具有 150 万行的数据库表中获取。我检查了它，只用了 60 毫秒来填充 Notes 列表。所以我猜这是将 160 个项目加载到列表框中的数据绑定。但这不应该是这样，因为 listBoxes 虚拟化了它们的内容（我窥探了它并验证了这些项目在虚拟化堆栈面板中）。

所以我很茫然，我不知道如何找出额外的 940 ms 是什么。

我能做些什么来追踪这个？性能是关键，我不知道如何改进它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T16:40:26.480

在不知道 UI 是什么样的情况下，UI 中的某些东西可能会减慢它的速度，就像大量使用 BitmapEffects 一样。

此外，您可能希望将列表切换到 ObservableCollection，因为[绑定到该列表可能比 List 快得多](http://msdn.microsoft.com/en-us/library/bb613546.aspx)。

还有一些很好的[性能分析](http://msdn.microsoft.com/en-us/library/aa969767.aspx)工具可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T16:39:55.573

我们可以看看你的 XAML 吗？

如果您的列表框位于堆栈面板（或类似控件）中，则列表框不会虚拟化其条目。

这将虚拟化：

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition Height="Auto" />
    <RowDefinition Height="*" />
  </Grid.RowDefinitions>

  <Label Grid.Row=0>Your label here</Label>
  <ListBox Grid.Row=1 Your properties here... />

</Grid> 
```

这不会：

```
<StackPanel>
  <Label>Your label here</Label>
  <ListBox Your properties here... />
</StackPanel> 
```

在堆栈面板内，列表框将呈现到其最大高度并依赖于堆栈面板进行滚动。（无虚拟化）

在网格内，列表框将呈现到网格行高并使用它自己的滚动查看器。（虚拟化）

您也可以只在列表框上设置 Height 或 MaxHeight 属性，而不是将其放在网格内，但如果您使用堆栈面板，我怀疑您想要某种自动调整大小。

请注意，您不能通过将堆栈面板放在网格内来作弊；您的列表框必须能够从某处获得最大高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:42:31.517

您是否尝试过没有延迟加载的性能测试？

此外，您的项目的数据模板/视图有多复杂？尝试使用简单的 TextBlock 表示运行测试，以确保它不是您的视图有多复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T17:02:15.510

我会再看一下 SQL 并确保您的集合正在填充。在您枚举结果之前，L2S 不会实际填充。

```
private IEnumerable<Thing> Method1()
{
    return _db.Things.Where(t => t.ID > 500);
}
private void Method2()
{
    var things = Method1(); // here, 'things' doesn't really contain anything
                            // even though you've already done the db fetch
    foreach (var thing in things) // 'things' gets populated here.
    {
        // do something
    }
} 
```

`.ToList()`例如：数据返回后立即调用。您将在数据层中看到更多活动，这些活动可能直到您的业务或 UI 层才发生。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T12:52:24.277

我想到了。我有一个需要文本换行的文本块，因为它有时很大。我在数据模板中明确设置了它的宽度（以便它可以换行），并且由于某种原因导致 ListBox 内的 VirtualizingStackPanel 实现了列表中的所有项目。我对其进行了重新设计以使其适合这样的网格..

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="3*" />
        <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Grid Grid.Column="0">
       ....
    </Grid>
    <ListBox Grid.Column="1" ItemsSource="{Binding}" ScrollViewer.HorizontalScrollBarVisibility="Disabled" >
       ...//DataTemplate
    </ListBox>
</Grid> 
```

这导致列表框快速加载。感谢您的回答，他们让我走上了正确的道路。

# c# - Gridview将文字字段分成多行

> ID：1002559
> 
> 赞同：0
> 
> 时间：2009-06-16T16:24:26.270
> 
> 标签：c#, asp.net

我有这个字段的gridview：

```
<asp:TemplateField HeaderText="Title">      
 <ItemTemplate>
   <asp:Literal ID="lblTitle" runat="server" Text='<%# Eval("Title") %>' />   
 </ItemTemplate>
</asp:TemplateField> 
```

如果标题太长，它会完全破坏网格视图。我怎样才能：

1.  使该列的宽度固定。
2.  如果内容太长，将其分成多行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T16:28:51.710

尝试设置 ItemStyle-Width

```
<asp:TemplateField HeaderText="Title" ItemStyle-Width="300px" ItemStyle-Wrap="true"></asp:TemplateField> 
```

您可能还需要使用样式来包装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T19:00:34.870

使用服务器控件属性：

```
<asp:TemplateField HeaderText="Title" 
                   ItemStyle-Width="300px"
                   HeaderStyle-Wrap="true"
                   ItemStyle-Wrap="true">
    <ItemTemplate>
       <asp:Literal ID="lblTitle" runat="server" Text='<%# Eval("Title") %>' />   
    </ItemTemplate>
</asp:TemplateField> 
```

这些服务器控件属性生成内联 css 样式。就个人而言，我会在您的样式表中创建适当的 css 类并分配给 HeaderStyle-CssClass 和 ItemStyle-CssClass 属性。

# sharepoint - Sharepoint 搜索属性权重

> ID：1002565
> 
> 赞同：6
> 
> 时间：2009-06-16T16:24:52.977
> 
> 标签：sharepoint, optimization, search, properties, weighting

我正在使用此处列出的代码：

[http://msdn.microsoft.com/en-us/library/ms553069.aspx](http://msdn.microsoft.com/en-us/library/ms553069.aspx)

在设置属性后添加了附加行作为对 .update() 的调用以保存更改，但即使权重为 10,000，我的属性的搜索结果仍位于底部，尤其是在标题下方。为了使权重传播，是否还需要做一些其他的事情？

我还尝试将标题、作者和文件名设置为 0，将属性（关键字）设置为 9999，并将属性的长度规范化设置为 0。结果略有变化，但使用与属性匹配的关键字进行搜索仍然不符合。

所有测试都在之后完全爬网完成，重置 IIS，并回收共享服务应用程序池。

我可以给你任何你可能要求的额外信息。

谢谢，斯特凡

更新 (6-19-09)：为此增加了 500 的赏金。在线提供的有关此功能的信息很少，显然一个好的答案将为互联网社区提供巨大的服务。它可能也可以为我节省一个星期:)

更新 2 (6-19-09)：架构本质上是这样的：OOB 共享点文档内容类型，添加了文本字段“关键字”。附加到 ows_keywords(Text) 的托管属性。

更新 3 (6-19-09)：Codeplex 的 Sharepoint Search Bench 对搜索有很大帮助。

更新 4 (6-19-09)：我已经找到了一个解决方案，该解决方案涉及创建许多（现在 5 个）具有相同爬网属性的更多托管属性。每个权重都设置为不寻常的值（例如 9999）。这些足以将关键字结果提升到顶部。虽然不太理想。仍在寻找解决方案。

更新 4 中的解决方案是我最终得到的。正如 Lars 评论的那样，搜索不是很灵活，尽管对属性权重进行了调整，但效果并不总是您所期望的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T07:11:32.943

更改属性的权重不需要重新抓取，只需重置搜索服务。

在网上找到了这个：

> 除了设置托管属性的权重之外，映射到托管属性的已爬网属性还必须启用“在搜索索引中包含此属性的值”复选框。

编辑：在这里找到它：[Larry Kuhn 的博客](http://sharepoint.microsoft.com/blogs/LKuhn/Lists/Categories/Category.aspx?Name=Search)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T09:09:28.773

您是否尝试过仅使用 0 到 1 范围内的权重？例如，将所有其他属性权重设置为 0.2，并将关键字设置为 0.8。在这些方面，我在使用 Lucene 时遇到了一些麻烦，而且与数量级有关。

此外，如果它从未在结果中添加该属性字段中的匹配项（尝试添加`xyzzy`关键字或其他内容并搜索它），那么它可能根本与权重无关，而是与是否考虑关键字进行搜索有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T15:30:35.760

当您搜索属性中存在的关键字时，该属性只会对排名分数产生积极影响。对于任何其他查询，权重都没有任何影响！例如，在搜索关键字“SharePoint Search”时，标题属性权重确保标题中包含这些关键字的文档的排名得分得到提升。但是标题中没有任何这些关键字的文档不会受到标题权重的提升。这适用于文本类型的所有托管属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T06:59:40.797

假设 .update() 调用是在 main() 结束时完成的，我是否正确？如果没有，请尝试，如果是，请确保程序正在运行。我还假设 strPropertyName 是您想要的。除此之外，我真的帮不了你。

# java - 完成期间对对象的引用

> ID：1002567
> 
> 赞同：21
> 
> 时间：2009-06-16T16:25:05.193
> 
> 标签：java, garbage-collection, finalizer

如果在 finalize 调用期间保存对当前对象的引用会发生什么？例如：

```
class foo {
    ...
    public void finalize() {
        bar.REFERENCE = this;
    }
} 
```

对象是否被垃圾收集？当您稍后尝试访问时会发生什么`bar.REFERENCE`？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-16T16:27:12.727

该对象没有被垃圾回收。这被称为“对象复活”。

您必须小心，一旦调用终结器，gc 就不会再次调用它，在.NET 等某些环境中，您可以重新注册终结器，但我不确定 java

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-16T16:53:02.223

如果您绝对必须复活对象，这篇[JavaWorld](http://www.javaworld.com/javaworld/jw-06-1998/jw-06-techniques.html)文章建议创建一个新实例而不是复活正在终结的实例，因为如果正在终结的实例再次符合收集条件，它将被简单地收集（终结器不会再次运行）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-16T16:30:46.780

这种东西`finalize()`是一般不鼓励使用的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T16:47:31.043

该`finalize()`方法可以在`foo`实例上显式调用，也可以由垃圾收集器在尝试回收该对象占用的存储空间时调用。

如果`bar`是有效实例，则将`REFERENCE`字段设置为`foo`实例。从垃圾收集器的角度来看，这增加了`foo`的引用计数。

如果在方法内部抛出异常`finalize()`（例如，`NullPointerException`由于`bar`being `null`），则终结过程简单地终止。

注意正如其他人指出的那样..您的示例绝对是要避免的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-16T20:16:14.400

因为 Java 是一种安全的语言和平台，所以不会释放内存。关联`PhantomReference`的 s 也不会在他们`ReferenceQueue`的 s 上排队。VM 只会调用`finalize`一次对象。JVM Spec 中有一个很好的状态图。

通常，如果您确实使用终结器，则应将声明保留为`@Override protected void finalize() throws Throwable`，以免干扰 API。最好使用受保护的终结器，如 Effective Java 1st Ed 中。

`ClassLoader`当普林斯顿大学的一个小组使用它从不受信任的代码构建自定义时，这个特殊的技巧成为头条新闻（无论如何是圣何塞水星） 。尽管规范已经略微收紧（`Object`构造函数必须在调用终结器之前正常执行 - 在 J2SE 5.0 中指定，在 Java SE 6 中实现），但这仍然是一个问题区域。如果您正在设计一个 API，请确保敏感类不能是子类，以免给自己带来很多麻烦。

# vb.net - 将 XLS 文件加载到 vb 2008 时的选项卡名称是什么？

> ID：1002568
> 
> 赞同：0
> 
> 时间：2009-06-16T16:25:13.693
> 
> 标签：vb.net, xls

我正在尝试使用 OleDbDataAdapter 函数将 Excel 97 单选项卡式电子表格加载到 SQL 服务器表中。从我找到的所有文档中，第一个参数应该是“select * from [sheet1$]”。仅当工作表中的选项卡名为 Sheet1 时，这对我来说才有效。如果我将 [] 括号中的内容更改为实际的选项卡名称，它也可以正常工作。

问题是正在加载的电子表格来自另一个系统，并且该系统在每次加载时都会更改选项卡名称。如何弄清楚选项卡名称是什么，以便我的用户不必打开电子表格并重命名选项卡？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:28:46.813

好的，首先，打开与 Excel 电子表格的 OleDB 连接。

然后，使用类似下面的东西（在 VB.NET 中显示）：

```
Imports System.Data
Imports System.Data.Odbc
Imports System.Data.OleDb

Dim DSN As String = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=MYEXCELFILE.XLS;Extended Properties=""Excel 8.0;HDR=YES;IMEX=1;MAXSCANROWS=12"""
Dim OleDbConn As New OleDbConnection(DSN)
OleDbConn.Open()
Dim tables As System.Data.DataTable = OleDbConn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, Nothing)
Dim tableName As String
Dim canBeImported As Boolean
For Each dr As System.Data.DataRow In tables.rows
    tableName = dr.Item("TABLE_NAME").ToString
    canBeImported = (tableName.IndexOfAny(New Char() {" ","[","]","'","""","`",";"}) < 0)
Next
OleDbConn.Close() 
```

这将遍历 Excel 文件中的所有表（表 = 工作表或命名范围）并获取每个表的名称。此外，它会过滤掉任何包含无法通过 ODBC 访问的字符的表（空格是最常见的问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:27:33.723

我过去曾对此进行过调查，我一直得出的结论是，我必须对给我电子表格的人强制执行选项卡名称，似乎没有可靠的方法来找到它们。

# css - 如何在 CSS 中选择单选按钮？

> ID：1002579
> 
> 赞同：46
> 
> 时间：2009-06-16T16:26:52.117
> 
> 标签：css

如何在 CSS 中选择单选按钮？我正在使用的 HTML 已生成，因此我无法向其添加类或其他属性。

我在互联网上找到了 input[type="radio"] ，但我不知道这是否是常规 CSS 并且大多数浏览器都支持。

还有其他方法可以选择单选按钮吗？

谢谢，

布雷特

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-06-16T16:30:28.170

`input[type="radio"]`是一个[属性选择器](http://www.css3.info/preview/attribute-selectors/)的例子。它是 CSS3 规范的一部分并且是完全合法的。唯一不支持它们的浏览器是 IE6。如果支持 IE6 对项目很重要，那么您应该考虑向相关单选按钮添加类。

[这是一篇文章](http://css-tricks.com/better-email-links-featuring-css-attribute-selectors/)，其中包含如何有效使用属性选择器的示例。查看[这篇文章](http://www.smashingmagazine.com/2009/06/15/take-your-design-to-the-next-level-with-css3/)了解更多关于 CSS3 好东西的信息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-16T16:31:53.910

属性选择器 (input[type="radio"]) 是正确的解决方案，除 IE6 之外的所有设备都广泛支持 :)

如果您无法修改 HTML 以注入类名支持（或访问 javascript 来完成此操作），那么您的选择是：

一个）。确保您的网站不依赖于此，并允许 IE6 优雅地降级。

乙）。没有它就活

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T16:36:07.963

您可以使用[jQuery](http://jquery.com/)来选择输入并动态添加一个类。

示例（来源：[http](http://docs.jquery.com/Attributes/addClass#class) ://docs.jquery.com/Attributes/addClass#class ）：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>

  <script>
  $(document).ready(function(){
    $("p:last").addClass("selected highlight");
  });
  </script>
  <style>
  p { margin: 8px; font-size:16px; }
  .selected { color:red; }
  .highlight { background:yellow; }
  </style>
</head>
<body>
  <p>Hello</p>
  <p>and</p>
  <p>Goodbye</p>
</body>
</html> 
```

[编辑]

jQuery 的替代方法是使用 [http://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

它修复了低于 7 的 ie 版本的大量问题，您最感兴趣的修复如下所示：

[http://ie7-js.googlecode.com/svn/test/attr-value.html](http://ie7-js.googlecode.com/svn/test/attr-value.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T16:33:02.647

你上面提到的那个是CSS定位它的正确方法。它被称为[属性选择器](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)。但是，IE6 及以下版本不支持它。可以通过为 IE6 添加条件行为脚本来模拟它们。（只需在 google 上搜索，文件结尾通常为 .htc）。

可能应该注意，.htc 文件通常会导致可怕的性能，并且应该只谨慎使用并进行彻底测试以确保性能影响是可以接受的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T16:32:48.230

您的解决方案是正确的，并且适用于除 IE6 之外的所有现代浏览器。对于 IE6，您必须找到选择它们的方法、修改 HTML 或使用 Javascript。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T16:36:21.567

您可以使用 jQuery 查找页面上的所有单选按钮，然后向其中添加一些 CSS 类。

# python - 让 distutils 安装预编译的库？

> ID：1002581
> 
> 赞同：9
> 
> 时间：2009-06-16T16:27:03.770
> 
> 标签：python, open-source, installation, compiled

我管理一个用 python 编写的开源项目（ [Remix ，源代码在那里可用）。](http://code.google.com/p/echo-nest-remix)我们要求用户运行 python setup.py install 来安装软件。最近我们添加了一个已编译的 C++ 包（SoundTouch 的一个端口——转到源代码中的 trunk/externals 以查看它。）我们希望安装基本 Remix 库的 setup.py 文件也安装 pysoundtouch14 库。

但是，我们不希望用户必须在他们的系统上安装 gcc 或 msvc 工具链。我们已经为常见平台（linux-i386、windows、mac 10.5 和 10.6）预编译了二进制文件，请转到 trunk/externals/pysoundtouch14/build 以查看它们。我希望没有安装 gcc 或 msvc 的用户可以运行 pysoundtouch14 的 setup.py，它会检测到我们预构建的二进制文件的存在并将它们复制到正确的位置（/Library/Python/2.5/site-packages ，例如。）但这不会发生。例如，在新的 10.5 系统上，setup.py 抱怨没有安装 gcc，即使它需要安装的 .so 已经构建在 build/ 文件夹中。

所以我有两个直接的问题：

*   如何让 setup.py 根据平台自动在正确的位置“安装”预构建的 .so 和 .pyd 文件，而不需要构建系统？
*   一个 setup.py（我们的主 setup.py 文件）如何同时运行另一个包含的包的 setup.py（pysoundtouch14 的 setup.py？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:24:01.437

考虑到多平台要求，您的第一个问题是一个棘手的问题。[如果只是 Windows，您可以使用安装后脚本选项来运行脚本来处理库，或者只使用NSIS](http://nsis.sourceforge.net/Main_Page)等非 Python 工具。除了 Almad 的建议，我不确定还能做什么。

对于第二个问题，您可能想查看[Paver](http://www.blueskyonmars.com/projects/paver/ "摊铺机")。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T21:55:44.170

不幸的是，我想说覆盖安装命令是要走的路。

这可以使用自定义分发命令轻松完成。例如，参见 [1] [http://svn.zope.org/Zope/branches/2.9/setup.py?rev=69978&view=auto](http://svn.zope.org/Zope/branches/2.9/setup.py?rev=69978&view=auto)

# c++ - 我可以在这里使用奇怪重复的模板模式（C++）吗？

> ID：1002587
> 
> 赞同：7
> 
> 时间：2009-06-16T16:27:36.830
> 
> 标签：c++, templates, metaprogramming, virtual, crtp

我有一个可以简化为这样的 C++ 应用程序：

```
class AbstractWidget {
 public:
  virtual ~AbstractWidget() {}
  virtual void foo() {}
  virtual void bar() {}
  // (other virtual methods)
};

class WidgetCollection {
 private:
  vector<AbstractWidget*> widgets;

 public:
  void addWidget(AbstractWidget* widget) {
    widgets.push_back(widget);
  }

  void fooAll() {
    for (unsigned int i = 0; i < widgets.size(); i++) {
      widgets[i]->foo();
    }
  }

  void barAll() {
    for (unsigned int i = 0; i < widgets.size(); i++) {
      widgets[i]->bar();
    }
  }

  // (other *All() methods)
}; 
```

我的应用程序对性能至关重要。集合中通常有数千个小部件。从（其中有几十个）派生的类`AbstractWidget`通常不会覆盖许多虚函数。那些被覆盖的通常具有非常快的实现。

鉴于此，我觉得我可以通过一些巧妙的元编程来优化我的系统。目标是利用函数内联并避免虚函数调用，同时保持代码的可管理性。我已经研究了奇怪重复出现的模板模式（请参阅[此处](http://bjacob.livejournal.com/5800.html)进行描述）。这似乎*几乎*可以满足我的要求，但并不完全。

有什么方法可以让 CRTP 在这里为我工作吗？或者，还有其他任何人能想到的聪明的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T17:05:43.960

模拟动态绑定（CRTP 还有其他用途）适用于*基类*认为自己是多态的，但*客户*实际上只关心一个特定的派生类。因此，例如，您可能有代表某个特定平台功能的接口的类，并且任何给定的平台都只需要一个实现。该模式的重点是将基类模板化，这样即使有多个派生类，基类也会在编译时知道哪个正在使用。

当您真正需要运行时多态性时，它对您没有帮助，例如当您有一个容器时`AbstractWidget*`，每个元素都可以是几个派生类之一，并且您必须遍历它们。在 CRTP（或任何模板代码）中，`base<derived1>`都是`base<derived2>`不相关的类。因此`derived1`和 也是如此`derived2`。除非它们有另一个公共基类，否则它们之间没有动态多态性，但是你又回到了从虚拟调用开始的地方。

您可以通过将向量替换为多个向量来获得一些加速：一个用于您知道的每个派生类，一个通用的用于稍后添加新派生类且不更新容器时。然后 addWidget 对小部件进行一些（缓慢的）`typeid`检查或虚拟调用，以将小部件添加到正确的容器中，并且当调用者知道运行时类时可能会有一些重载。小心不要意外地将 的子类添加`WidgetIKnowAbout`到`WidgetIKnowAbout*`向量中。`fooAll`并且`barAll`可以循环遍历每个容器，依次对非虚拟`fooImpl`和`barImpl`函数进行（快速）调用，然后将其内联。然后他们遍历希望小得多的`AbstractWidget*`向量，调用虚函数`foo`或`bar`函数。

这有点混乱而且不是纯 OO，但如果几乎所有小部件都属于容器知道的类，那么您可能会看到性能提升。

请注意，如果大多数小部件属于您的容器不可能知道的类（例如，因为它们位于不同的库中），那么您就不可能有内联（除非您的动态链接器可以内联。我的不能）。您可以通过弄乱成员函数指针来降低虚拟调用开销，但收益几乎可以肯定是可以忽略不计甚至是负数。虚拟调用的大部分开销都在调用本身，而不是虚拟查找，通过函数指针的调用不会被内联。

换个角度看：如果要内联代码，这意味着不同类型的实际机器代码必须不同。这意味着您需要多个循环，或者一个带有开关的循环，因为机器代码显然不能在每次通过循环时在 ROM 中更改，具体取决于从集合中拉出的某个指针的类型。

好吧，我猜这个对象可能包含一些 asm 代码，循环复制到 RAM 中，标记为可执行文件，然后跳转到。但这不是 C++ 成员函数。而且它不能便携。它甚至可能不会很快，复制和 icache 失效。这就是为什么存在虚拟呼叫...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T17:00:28.037

CRTP 或编译时多态性适用于您在编译时知道所有类型的情况。只要您`addWidget`用于在运行时收集小部件列表，`fooAll`并且`barAll`必须在运行时处理该同质小部件列表的成员，您就必须能够在运行时处理不同的类型。因此，对于您提出的问题，我认为您无法使用运行时多态性。

当然，一个标准的答案是在尝试避免它之前验证运行时多态性的性能是否存在问题......

如果您确实需要避免运行时多态性，那么以下解决方案之一可能会起作用。

**选项 1：使用小部件的编译时集合**

如果您的 WidgetCollection 的成员在编译时是已知的，那么您可以非常轻松地使用模板。

```
template<typename F>
void WidgetCollection(F functor)
{
  functor(widgetA);
  functor(widgetB);
  functor(widgetC);
}

// Make Foo a functor that's specialized as needed, then...

void FooAll()
{
  WidgetCollection(Foo);
} 
```

**选项 2：用自由函数替换运行时多态性**

```
class AbstractWidget {
 public:
  virtual AbstractWidget() {}
  // (other virtual methods)
};

class WidgetCollection {
 private:
  vector<AbstractWidget*> defaultFooableWidgets;
  vector<AbstractWidget*> customFooableWidgets1;
  vector<AbstractWidget*> customFooableWidgets2;      

 public:
  void addWidget(AbstractWidget* widget) {
    // decide which FooableWidgets list to push widget onto
  }

  void fooAll() {
    for (unsigned int i = 0; i < defaultFooableWidgets.size(); i++) {
      defaultFoo(defaultFooableWidgets[i]);
    }
    for (unsigned int i = 0; i < customFooableWidgets1.size(); i++) {
      customFoo1(customFooableWidgets1[i]);
    }
    for (unsigned int i = 0; i < customFooableWidgets2.size(); i++) {
      customFoo2(customFooableWidgets2[i]);
    }
  }
}; 
```

丑陋的，真的不是OO。模板可以通过减少列出每个特殊情况的需要来帮助解决此问题；尝试以下类似的方法（完全未经测试），但在这种情况下你又回到了没有内联的状态。

```
class AbstractWidget {
 public:
  virtual AbstractWidget() {}
};

class WidgetCollection {
 private:
  map<void(AbstractWidget*), vector<AbstractWidget*> > fooWidgets;

 public:
  template<typename T>
  void addWidget(T* widget) {
    fooWidgets[TemplateSpecializationFunctionGivingWhichFooToUse<widget>()].push_back(widget);
  }

  void fooAll() {
    for (map<void(AbstractWidget*), vector<AbstractWidget*> >::const_iterator i = fooWidgets.begin(); i != fooWidgets.end(); i++) {
      for (unsigned int j = 0; j < i->second.size(); j++) {
        (*i->first)(i->second[j]);
      }
    }
  }
}; 
```

**选项 3：消除 OO**

OO 很有用，因为它有助于管理复杂性，并且有助于在面对变化时保持稳定性。对于您所描述的情况 - 数千个小部件，其行为通常不会改变，并且其成员方法非常简单 - 您可能没有太多复杂性或需要管理的更改。如果是这种情况，那么您可能不需要 OO。

此解决方案与运行时多态性相同，只是它要求您维护“虚拟”方法和已知子类（不是 OO）的静态列表，并且它允许您将虚拟函数调用替换为内联函数的跳转表。

```
class AbstractWidget {
 public:
  enum WidgetType { CONCRETE_1, CONCRETE_2 };
  WidgetType type;
};

class WidgetCollection {
 private:
  vector<AbstractWidget*> mWidgets;

 public:
  void addWidget(AbstractWidget* widget) {
    widgets.push_back(widget);
  }

  void fooAll() {
    for (unsigned int i = 0; i < widgets.size(); i++) {
      switch(widgets[i]->type) {
        // insert handling (such as calls to inline free functions) here
      }
    }
  }
}; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T17:39:44.267

最简洁的答案是不。

长答案（或仍然短于其他一些答案:-)

您正在动态地尝试找出在运行时要执行的函数（即虚拟函数是什么）。如果您有一个向量（在编译时无法确定其成员），那么无论您尝试什么，您都无法弄清楚如何内联函数。

唯一需要注意的是，如果向量总是包含相同的元素（即，您可以计算出编译时间将在运行时执行什么）。然后您可以重新工作，但它需要除矢量以外的其他东西来保存元素（可能是一个所有元素作为成员的结构）。

另外，你真的认为虚拟调度是一个瓶颈吗？
我个人非常怀疑。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T16:56:13.563

您将在这里遇到的问题是`WidgetCollection::widgets`. 一个向量只能包含一种类型的项，并且使用 CRTP 要求每个项`AbstractWidget`都具有不同的类型，并由所需的派生类型进行模板化。也就是说，你`AbstractWidget`看起来像这样：

```
template< class Derived >
class AbstractWidget {
    ...
    void foo() {
        static_cast< Derived* >( this )->foo_impl();
    }        
    ...
} 
```

这意味着每个`AbstractWidget`具有不同`Derived`类型的都会构成不同的类型`AbstractWidget< Derived >`。将这些全部存储在一个向量中是行不通的。所以看起来，在这种情况下，虚拟功能是要走的路。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-16T16:57:38.023

如果您需要它们的向量，则不需要。STL 容器是完全同构的，这意味着如果您需要将一个小部件A 和一个小部件B 存储在同一个容器中，它们必须从一个共同的父级继承。而且，如果widgetA::bar() 做的事情与widgetB::bar() 不同，则必须使函数虚拟化。

所有的小部件都需要在同一个容器中吗？你可以做类似的事情

```
vector<widgetA> widget_a_collection;
vector<widgetB> widget_b_collection; 
```

然后这些功能就不需要是虚拟的了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T17:48:04.300

很可能，在您完成所有这些努力之后，您将看不到性能差异。

这绝对是**错误**的优化方式。您不会通过更改随机代码行来修复逻辑错误吗？不，这很愚蠢。在您首先找到哪些行实际上导致您的问题之前，您不会“修复”代码。那么为什么你会以不同的方式处理*性能*错误呢？

您需要分析您的应用程序并找出真正的瓶颈在哪里。然后加速该代码并重新运行分析器。重复直到性能错误（执行太慢）消失。

# c# - 不同的值成员，相同的控制

> ID：1002588
> 
> 赞同：1
> 
> 时间：2009-06-16T16:27:48.123
> 
> 标签：c#, .net, winforms, data-binding, devexpress

## 编辑 1

我相信我的问题源于以下几点。填充下拉部分的函数将显示成员设置为 CountyName。然后，当我按照建议尝试设置 SelectedText 或 EditValue 时，该函数仅返回它尝试与下拉列表 DisplayMember 中的内容匹配的 CountyID。我需要将其与 ValueMember 列表中的内容相匹配。

使用以下方法我让它工作，但它是一个 HACK，我非常感谢找到一个真正的解决方案。

```
lkuResidenceCounty.ItemIndex = Convert.ToInt32(row["ResidencyCountyID"].ToString()); 
```

* * *

## 原帖

我在成员表单上有一个查找框（DevExpress），我使用此代码从数据库中填写可能的值 -->

```
 lkuResidenceCounty.Properties.DataSource = ConnectBLL.BLL.Person.CountyList();
        lkuResidenceCounty.Properties.PopulateColumns();
        lkuResidenceCounty.Properties.DisplayMember = "CountyName";
        lkuResidenceCounty.Properties.ValueMember = "CountyID";
        lkuResidenceCounty.Properties.Columns[0].Visible = false;
        lkuResidenceCounty.Properties.Columns[2].Visible = false;
        lkuResidenceCounty.Properties.Columns[3].Visible = false; 
```

这可以正常工作，因为 CountyName 按预期显示。

但是，当我尝试使用以下内容为此字段加载现有成员的值时，这是从数据集中获取一行的函数的一部分 -->

```
lkuResidenceCounty.Properties.ValueMember = row["ResidencyCountyID"].ToString(); 
```

我得到一个空盒子。我已单步执行代码，并且正在为会员返回正确的 ID。

不幸的是，填充下拉选项的存储过程从维护表中提取，其中包含“CountyName”和“CountyID”列。所以这是正确的。不幸的是，加载特定人员当前县的存储过程从 Person Table 中提取，其中有一个名为“ResidencyCountyID”的列。之所以如此命名，是因为还有一个“ResponsibilityCountyID”列。

我需要一种让它们共存的方法，有什么解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:13:26.940

DisplayMember 和 ValueMember 用于使用可选值列表填充控件。要设置填充的 LookUpEdit 控件的选定值，请设置其[EditValue](http://www.devexpress.com/Help/?document=XtraEditors/clsDevExpressXtraEditorsLookUpEdittopic.htm&levelup=true)属性：

```
lkuResidenceCounty.EditValue = row["ResidencyCountyID"].ToString(); 
```

回应您的编辑：根据文档：

> 当前选定的行确定编辑器的编辑值和显示文本的值。BaseEdit.EditValue 的值是从 RepositoryItemLookUpEditBase.ValueMember 字段中获取的，而要在编辑框中显示的文本是从所选行的 RepositoryItemLookUpEditBase.DisplayMember 字段中获取的。
> 
> 当您更改 BaseEdit.EditValue 时，编辑器会定位并选择其 RepositoryItemLookUpEditBase.ValueMember 字段包含新值的行。更改编辑框中的文本以反映新选择的行。

我不使用这些控件，但在我看来它不应该像你描述的那样工作。我认为 ToString() 是问题所在，因为 EditValue 接受一个对象，因此它可能需要一个 int 作为值。尝试：

```
lkuResidenceCounty.EditValue = (int)row["ResidencyCountyID"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:36:23.627

ValueMember 属性告诉列表在设置 Value 属性时要从哪个字段中提取。将 ValueMember 设置为“CountyID”后，当列表为 Databound 时，它将所有列表项的值属性设置为其相关对象的 CountyID 字段。

因此，您不应该这样做：

```
lkuResidenceCounty.Properties.ValueMember = row["ResidencyCountyID"].ToString(); 
```

反而

```
lkuResidenceCounty.Properties.ValueMember = "CountyID"; 
```

非常好，只要您正确识别了您尝试数据绑定的字段。一旦列表获得数据绑定，您应该会看到您期望的结果。

但是，在查看您的代码之后，您似乎与您的领域不匹配。在一个地方您使用 ResidencyCountyID，而在另一个地方您使用 CountyID。这很可能是你困惑的根源。弄清楚实际的字段名称是什么，并确保将 ValueMember 设置为该名称。

**更新**

阅读您的评论后，您正在寻找的是 SelectedValue 属性。SelectedValue 属性告诉列表将所选值强制为您提供的任何输入。

基本上你有两件事在这里发生。ValueMember 告诉列表使用什么作为数据源中的值，SelectedValue 告诉列表当前选择的值应该是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T13:04:56.163

为什么需要相同的 LookUpEdit 才能拥有两个值成员？它是独立使用还是在网格中使用？如果是独立的，您可以根据当前行交换两个存储库编辑器。但是，ValueMember 是否有超过 2 个可能的值？这也会使事情复杂化。

更新

看着你的编辑，我想我明白发生了什么。那么，您不希望更改您的 ValueMember（指数据列），而是更改编辑器的值？如果是这样，那么您绝对应该使用 EditValue（而不是 SelectedText，我不认为它应该被设置），并将其分配给 row["value_field"]，如下所示：

```
lkuResidenceCounty.EditValue = row["ResidencyCountyID"]; 
```

当你这样做时会发生什么？

# c# - XAML 或 C# 代码隐藏

> ID：1002604
> 
> 赞同：51
> 
> 时间：2009-06-16T16:30:25.157
> 
> 标签：c#, wpf, xaml, code-behind

我不喜欢使用 XAML。我更喜欢用 C# 编写所有内容，但我认为我做错了。

在哪些情况下使用 XAML 更好，什么时候使用 C#？你的经验是什么？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-16T16:34:27.060

在 C# 中创建整个窗口可能是一堆乱七八糟的代码。WPF 的最佳之处在于 XAML 允许您将设计与逻辑分开，从而使代码更易于阅读。

当我需要创建动态控件时，我将使用 C#，但我倾向于将我的一般设计、静态故事板、样式、数据模板等保留在 XAML 中。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-16T16:42:44.370

在 WPF 中查看有关 MVVM 的[视频。](https://youtu.be/BRxnZahCPFQ)如果您想了解如何组织 WPF 应用程序与 XAML 中的内容、代码隐藏和其他抽象相比，这是一个很好的起点。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-06-19T09:54:46.530

您当然可以使用 XAML 走得太远。那些希望在 XAML 中定义其整个用户界面（包括逻辑、事件处理关系等）的人可能没有抓住重点。

XAML 的目的是提供一种通用格式来确定事物的*外观*。它应该只是描述如何布置东西，如何在视觉上给它们上色和样式。

试图用它来替代 C# 的其他方面确实没有什么意义，因为 C# 在编程特性方面具有永久的领先优势 - 重用（定义类型和函数）、引用变量、过程编程和甚至声明式或函数式样式。

就我个人而言，我真的很喜欢将 UI 与 Linq 表达式组合在一起！

我看到的一个示例达到了最终的荒谬性，他们使用工作流操作作为按钮的子级来提供`Click`处理程序，因此整个程序都在 XAML 中。这听起来很“酷”，但问题是它比等效的 C# 或 VB.NET 程序更丑陋和不可读，因此准备在 C# 中使用的所有内容都必须替换为更冗长、片状的等效程序。翻译成更丑陋的语法实际上并没有带来任何好处——它只是更丑陋的同一个程序。XML 对于通用编程语言的语法来说是一个很差的基础。从大于符号必须写成的事实开始`&gt;`！

在平行宇宙中，微软在完成 XAML 之前发布了 C# 3.0。XAML 团队采用 C# 3.0 对象/列表初始值设定项语法而不是 XML 作为他们的语法。而这整个辩论从未发生过。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-16T16:35:44.813

我的经验是，有些事情在 C# 中执行起来要快得多，而大多数事情在 XAML 中执行得更快。当需要 5 行 C# 代码来完成单行 XAML 代码可以做的事情时，我很容易选择哪个更好。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-20T03:08:29.493

***基本上，XAML 用于表达视觉设计，C# 用于表达逻辑。***

任何视觉设计都应该在 XAML 中完成，任何逻辑都应该在 C# 中实现。

- 这使得视觉设计可以让设计师继续使用，而不必担心逻辑的变化，甚至可以在运行时使用松散的 XAML 替换整个视觉设计。

- 这也意味着您可以在不“破坏”的情况下替换逻辑或视觉设计。

- 两者之间的连接应该通过数据绑定和命令绑定来完成。

**我使用的做法是：**

1\. 在单独的 C# 代码中定义模型（业务数据对象模型）。

2\. 在 XAML 中定义视图的常量部分（图形用户界面的常量部分，例如窗口、菜单等）（最好使用 Blend 而不是 VS）。
* 不要在这里定义样式（颜色、字体、...）。
* 不要在 XAML 代码隐藏中为按钮（在大多数情况下）编写事件处理程序，而是使用命令绑定。

3\. 使用位于单独文件中的 XAML“ResourceDictionary”定义模型在视图（用于查看/编辑数据对象的 GUI）中的呈现方式。

- 使用 blend 编写，然后使用 VS 将绑定添加到 XAML（Jetbrains 的 Resharper VS 插件将有助于绑定表达式）。

- 如果在设计时不知道对象类型，您可以使用“loose-XAML”并将 XAML 放在一个文件夹中，该文件夹可以在其中添加/编辑文件而无需重新编译。

4\. 在 C# 中创建模型和视图（控制器/视图模型）之间的连接：
* 根据需要创建视图（用于动态对象）
* 将视图绑定到模型（将视图的 DataSource 设置为模型中的相关对象）
* 实现命令
* 命令将视图绑定到自身内部的命令实现

5\. 在Application.xaml 删除 StartupUri="MainWindow.xaml" 并添加 Startup="ApplicaitonStartUp" 。
在 ApplicationStartUp() 事件处理程序中：
* 加载您拥有的任何松散 XAML
* 创建控制器
* 创建主窗口
* 创建模型
* 将控制器连接到模型和主窗口
* 显示主窗口
*（将模型、控制器和主窗口保存到此处的私有字段中，以确保它们都保持活动状态）

6\. 将样式（颜色、字体）添加到 ResourceDictionary 下的单独 XAML 文件中（为此使用混合或购买现成的 XAML主题/皮肤文件）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-16T16:49:20.810

想要用 C# 而不是 XAML 编写 UI 的冲动实际上只是表明您对 XAML 的适应程度。

对我来说，编写尽可能少的代码隐藏是个人目标。简单地说，后面的代码很难进行单元测试，但可以（并且通常会）包含未经测试的逻辑。XAML 是声明性的（如 HTML），不包含任何逻辑，因此无需进行单元测试。我将视图代码保存在 XAML 中，并将视图逻辑保存在非常容易测试的 ViewModel (MVVM) 中。

一旦您对 XAML 更加熟悉，您就会越多地意识到它相对于过程代码中的视图构造的好处……使用像 MVVM 这样的模式，您会更进一步，并意识到代码隐藏仅在极少数情况下有用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-19T09:42:48.240

要记住的最重要的事情是 XAML 用于演示。您的所有演示文稿都应该在 XAML 中。如果您有逻辑，则将其保留在您的 XAML 之外 - 在您的 C# 中。

想象一下，将您的 XAML 文件换成一个看起来完全不同的文件——但仍然使用相同的数据——这就是划分的地方。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-21T05:24:01.097

XAML 的优点之一是表示与逻辑的分离。这种分离不仅是理论上的，也是实际的。我的情况是，我的大部分用户界面现在都由设计师处理。这位设计师使用blend，不懂C#，对学习c#没有兴趣，坦白说应该不需要。这位设计师是一位真正的设计师，一位艺术家，他知道如何使用这些工具让事物看起来非常非常漂亮。基本上我的原理是这样的，我使用 XAML 的次数越多，我在 UI 上要做的工作就越少，因为他可以做到。这对我们来说效果很好。我通常将我的控件设计为不显眼，给它们一个基本的简洁外观，使用 DataContext 绑定我的对象（顺便说一句，DataTriggers 是减少代码的好方法）。结果，我会经常检查我的代码，第二天回来，同步它，

当然，至少花了 1/2 年才到那里，但现在这个模型似乎工作了，我们的 UI 看起来 Kick A##，我们的应用程序赢得了很高的评价，我在 UI 本身上做的很少，然后开始工作更酷的东西。长话短说，我认为背后的代码可能更加以开发人员为中心，而忘记了可以使用 WPF 受益、努力和谋生的整个其他群体，即设计师。

当然，有时仍然需要开发人员才能让 XAML/WPF 唱歌跳舞，有时我们需要教育设计人员正确的做事方式，但我认为它的投资是值得的。大型项目（也许简而言之不是这样）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-09-15T18:41:58.797

只要您正在开发一个具有一定复杂性的简单 UI，XAML、MXML 所有这些东西都可以工作。一旦你的 UI 变得复杂和丰富，自动数据绑定将带来更多的麻烦而不是它们的好处。XAML 的目的不是让编程变得容易，而是将 UI 与逻辑分开，以便 UI 的工具可以轻松..

没有数据绑定，没有事件处理程序.. 假设您永远不会再看到您的 XAML 并编写代码..

XAML 是演示文稿。数据绑定不是表示。它的表示逻辑。将所有表示逻辑放在代码后面（数据绑定和处理程序）。开发人员拥有背后的代码，设计人员拥有 XAML。如果您是开发人员并且您正在接触 XAML，那么将该部分移到代码后面。

我们也可以在没有 XAML 的情况下编写 WPF 应用程序..

感谢 Vinoth Kumar R（已经使用 Flex MXML 数据绑定进行了足够的测试）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-06-16T16:53:53.363

这不仅与您有关，还与您的团队有关，其中一些人可能是设计师。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-09-03T07:46:24.480

如前所述，XAML 和 C# 是一种将逻辑与设计分开的非常好的方法。

对于一个典型的程序员来说，使用 WPF 确实改变了编程方式，假设程序员来自 C++、VB、WinForms、ATL 和 MFC 背景，那么 UI 不像 XAML 那样自然地与逻辑分离和 C#。

要习惯这种编程方式需要一些时间，但是获得越来越多的经验它会变得非常有效。

在开始之前，学习 MVVM 模式并运行教程以了解该模式的优势以及了解它的好处是非常好的。

**基于 MVVM 模式的 WPF 和 C# 应用程序的好处：**

**1.用户体验和可用性** 将逻辑与UI分离，让专门的设计师负责UI设计和动画更加自然。这样，程序员可以专注于背后的逻辑和技术解决方案，而 UI 是由懂设计的人设计的。对于许多软件公司来说，这一直是一个问题，至少在业内，程序员实际上也是曾经设计 UI 的人，这导致了大量的支持、维护和有效的应用程序。

通过让具有可用性背景的人专注于使用而不是技术解决方案，它最终获得更多用户友好的应用程序的可能性更高。乔尔·斯波尔斯基（Joel Spolsky）撰写的关于此类示例的《程序员用户界面设计》真的很有趣。

通过对 XAML 应用程序使用 MVVM 模式，我们很有可能会看到更多用户友好的应用程序。

**2.维护** 维护，在软件开发中成本很高。一开始可以感觉到 MVVM 模式是一个很大的开销，但是随着功能的增加，应用程序越复杂和高级，它的好处就越大。您将看到维护这样的应用程序非常容易。有关概述，您可以查看此视频：

**3\. 能力的混合** 专门的设计师和专门的程序员在一个团队中工作以获得更好的结果是混合能力的一种非常好的方法。组织需要结合能力以提供最佳结果，而不是只雇用程序员。

**4\. 对设计感兴趣的程序员的机会** 最后，可以在 Windows 环境中实现精美的应用程序。如果您是一名对设计感兴趣的程序员，Microsoft Expression Blend 确实为您提供了学习和实现具有精美设计的精美实用应用程序的可能性。

尽管使用 XAML 和 C#、MVVM 可能存在风险，但它提供的巨大可能性和灵活性也可能是一个缺点。让程序员在这个新的简单 UI 环境中放松，应用程序最终可能会得到广泛的动画、颜色，以及这个新环境提供的一切。记住您是如何在 C++ 和 ATL 环境中添加 UI 控件的。

仍然有更多的好处，我希望你能获得一些灵感，使用 XAML 而不是 C# 作为 UI，当习惯它时，我相信你会喜欢它。

一个好的教程的链接： [教程 MVVM XAML C#](http://channel9.msdn.com/shows/Continuum/MVVM/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-16T16:33:54.017

我最初来自 Web 开发方面，目前正在学习 WPF/Silverlight。对我来说，XAML 模型对我来说比 WinForms 更有意义。我将 XAML 视为 HTML，将 .cs 文件视为代码隐藏。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-20T03:47:08.230

我喜欢干净的代码，我拥有的代码越少，它就越干净。代码可以用数百万种方式编写，XAML 更具限制性。XAML 擅长在适当的时候减少代码。如果我可以在 XAML 中添加一些东西，我会这样做。工具可以读取 XAML 并用它做一些事情。代码少得多。处理 XAML 的工具和框架将发展并变得更好，与现有 XAML 一起做更多更好的工作。不能这么说代码。XAML 发展得越多，我们就越能以声明方式定义我们的应用程序。

对我来说，使用 XAML 就像使用 LINQ。如果我可以写一个易于阅读的单行语句并让框架决定实现我想要的最佳方式，我感觉很好。我肯定会尽可能多地尝试使用我想要的声明，而不是硬编码我希望它如何完成。F# 是这种范式的另一个很好的例子。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-01-31T13:05:46.610

无论您在计算机编程中使用什么编程语言，所有逻辑都应该在代码中。即使在 ControlTemplate 中，XAML 也不应该取代它，尽管它很好，但单元测试和调试代码要容易得多。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-01-29T19:35:09.983

似乎还没有答案提到重要的一点： [https ://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh465340.aspx](https://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh465340.aspx)

> XAML 只是程序代码（只是更简单）

```
<Grid x:Name="ContentPanel" Margin="12,0,12,0">
    <Button Height="72" Width="160" Content="Click Me" />
</Grid> 
```

*“下面展示了如何用 C# 或 Visual Basic 编写的代码部分替换此 XAML。”*

```
// Initialize the button
Button myButton = new Button();
// Set its properties
myButton.Width = 160;
myButton.Height = 72;
myButton.Content = "Click Me";
// Attach it to the visual tree, specifically as a child of
// a Grid object (named 'ContentPanel') that already exists. In other words, position
// the button in the UI.
ContentPanel.Children.Add(myButton); 
```

例如，如果您使用 Windows 窗体，您可能还记得 Windows 窗体设计器会生成一个 .designer.cs 文件，其中包含与上面链接中的示例类似的代码。这种声明性代码在 XAML 中比 C# 更好地表示。

对于任何非玩具应用程序，您应该始终更喜欢 XAML 来定义 UI 并以 MVVM 方式将其连接到逻辑。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-16T16:40:18.570

有些东西在代码中更容易维护或调试。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-16T17:13:52.660

更不用说您将能够在 Xaml2009 中做更多现在必须在代码中完成的事情。

不幸的是，BAML 不会在 vs 2010 时间范围内完全支持 xaml 2009，因此您无法在 2010 时间范围内编译 xaml。并且将不得不等待更高版本的混合来完成完整的开发设计循环。（晚于 3 个）

道格拉斯

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-24T15:44:35.323

XAML 可以看作类似于用于结构和设计的 XHTML 和 CSS 或 XML 和 XSL 的组合。任何形式的逻辑都应该在 C# 中。**这种方式结构和设计与逻辑分离。**通过使用这种方法，您的代码也应该更干净。另一个积极的事情是，设计师和程序员之间的任务可以更容易地分开。

还有一件事……这是 MSDN 对 XAML 的定义：

> 可扩展应用程序标记语言 (XAML) 是一种用于声明式应用程序编程的标记语言。Windows Presentation Foundation (WPF) 实现了可扩展应用程序标记语言 (XAML) 加载程序，并为 Windows Presentation Foundation (WPF) 类型提供可扩展应用程序标记语言 (XAML) 语言支持，以便您可以在可扩展应用程序标记中创建应用程序 UI 的大部分语言 (XAML) 标记。此外，SDK 包括一个名为 XAMLPad 的可扩展应用程序标记语言 (XAML) 编辑工具。您可以使用此工具实时试验可扩展应用程序标记语言 (XAML)。

[链接到报价。](http://msdn.microsoft.com/en-us/library/ms747122.aspx)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-05-07T19:17:00.097

使用流利的风格在 C# 中编程 WPF 有助于降低代码大小和复杂性。有关在 WPF 中使用流利样式的示例，请参阅[此答案。](https://stackoverflow.com/a/10219862/268581)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-06T20:33:55.820

It's mostly preference I think. I use WPF, since it's easier to structure different screens and separate the C# code logic from the UI. Typically all my logic is structured in another C# library than my UI which is the startup project in WPF or Windows Forms

# objective-c - 关闭 modalViewController 会在 iphone 周围移动主视图按钮

> ID：1002613
> 
> 赞同：2
> 
> 时间：2009-06-16T16:32:25.377
> 
> 标签：objective-c, iphone, model-view-controller

在这两种情况下，我都使用`presentModalViewController`and`dismissModalViewController`动画设置`YES`。这工作正常。

模式视图关闭后，主视图上的所有内容都向下移动了 20 像素。

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T17:24:07.733

这个应用是全屏的吗？

我看到一些关于隐藏状态栏的应用程序的奇怪问题。您可以尝试在模式视图上重新隐藏 viewWillAppear 或 viewWillDisappear 中的状态栏。

```
[[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO]; 
```

# com - 我可以在 windbg 中显示 GUID 吗？

> ID：1002622
> 
> 赞同：8
> 
> 时间：2009-06-16T16:33:42.067
> 
> 标签：com, guid, windbg

我正在尝试调试一些 COM 组件，并希望在对 CoCreateInstance 的调用中跟踪 CLSID 和 IID。

我不确定如何在 windbg 中显示 GUID。任何指针。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T16:45:29.407

使用“显示类型”命令：

```
dt GUID [address-of-guid] 
```

有关详细信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/cc266712.aspx)。

如果它在局部变量中（您所在的堆栈帧的局部变量），请使用`dv /V`转储所有局部变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:53:58.590

我对COM一无所知，但如果这只是一个普通变量（即使它是一个全局变量），那么你总是可以这样做：

alt+2 调出监视窗口并在此处输入变量的名称，例如

blahblah.dll!guid

您将需要符号，可能也不需要处于源模式。这比 dv/dt 稍微好一点，因为您不必不断地输入它。我想你也可以输入地址。请注意，如果你不放 blahblah！然后它偶尔会导致 windbg 在搜索每个模块以查找称为 guid 的东西时停止几秒钟。

# c# - windows下自动SSH登录

> ID：1002627
> 
> 赞同：1
> 
> 时间：2009-06-16T16:34:38.370
> 
> 标签：c#, python, windows, ssh

我希望能够使用一些自定义参数执行 openssh，然后能够自动登录到服务器。我希望我的脚本在需要时输入密码，并在提示我将指纹添加到已知主机时注入“是”。

我发现 SharpSsh for C# 可以做到这一点，但我还需要使用 -D 参数并使用我在 SSH 中定义的 ProxyCommand，并且该库非常缺乏这种用法。

我发现的另一件事是 pexcept for Python 应该可以解决问题，但我找不到在哪里下载它，在官方页面上，我正从 sourceforge 重定向到一些损坏的链接。

任何帮助，将不胜感激，

账单。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T16:46:13.103

如果您使用[**OpenSSH**](http://www.openssh.com/)，然后有一个脚本以明文方式注入密码（意味着您存储的密码未加密），那么它就违背了安全 shell 的目的。

请强烈考虑使用可以轻松安全地自动化的[**公钥机制。**](http://www.ssh.com/support/documentation/online/ssh/adminguide/32/Public-Key_Authentication-2.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T18:42:31.903

我将支持使用公钥身份验证的建议。您可能需要考虑[Paramiko](http://www.lag.net/paramiko/) ，而不是使用 expect，它是 Python 的原生 SSH 客户端，可以大大简化通信过程，特别是如果您需要与远程服务器交互并且它支持诸如内置 SFTP 之类的东西 -在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T17:15:02.767

我将 pexpect 用于类似目的并且下载也可以吗？ [http://sourceforge.net/project/downloading.php?group_id=59762&filename=pexpect-2.3.tar.gz](http://sourceforge.net/project/downloading.php?group_id=59762&filename=pexpect-2.3.tar.gz)

这是我的 ssh 自动化脚本的一部分，您可以自定义它以供您使用，它可能不会开箱即用

```
import os
import getpass
import pexpect
import glob
import logging
import shutil
import time

class UpdateError(Exception): pass

g_password = None

def runSshCommand(cmd):
    global g_password

    ssh_newkey = 'Are you sure you want to continue connecting'
    # my ssh command line
    p=pexpect.spawn(cmd)

    i=p.expect([ssh_newkey,'password:',pexpect.EOF])
    if i==0:
        print "Saying yes to connection.."
        p.sendline('yes')
        i=p.expect([ssh_newkey,'password:',pexpect.EOF])

    if i==1:
        while True:
            if g_password is None:
                g_password = getpass.getpass("password:")
            p.sendline(g_password)
            i = p.expect(['password:',pexpect.EOF])
            if i==0:
                g_password = None
                print "Wrong password"
            else:
                break
    elif i==2:
        raise UpdateError("Got key or connection timeout")

    return p.before 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T20:46:55.773

有一些关于使用[Putty](http://www.chiark.greenend.org.uk/~sgtatham/putty/)和生成的 SSH 密钥身份验证的[优秀文档。](http://www.ualberta.ca/CNS/RESEARCH/LinuxClusters/pka-putty.html)这是实现目标的一种简单而安全的方法。 [Putty](http://www.chiark.greenend.org.uk/~sgtatham/putty/)有一组很棒的功能，适用于 Windows SSH 应用程序。如果您认为可以[免费获得它，那就更好了](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T14:18:57.433

`pexpect`无法在 Windows 上导入。因此，我使用`plink.exe`Python 子进程连接到 ssh 服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-04T11:28:46.800

另一种方式是使用openssh，建立可信密钥；如果服务器上的客户端和用户帐户都具有此密钥，则 openssh 不会请求密码。

我有一个脚本可以自动设置这个 - 它在 cygwin 下工作，

[http://mosermichael.github.io/cstuff/all/projects/2011/07/14/ssh-friends.html](http://mosermichael.github.io/cstuff/all/projects/2011/07/14/ssh-friends.html)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-16T16:38:02.893

我希望[Net::SSH::Expect](http://search.cpan.org/perldoc?Net::SSH::Expect) Perl 模块对你有所帮助。

# c# - 帮我修复这个 SQL 语句？

> ID：1002628
> 
> 赞同：1
> 
> 时间：2009-06-16T16:35:08.480
> 
> 标签：c#, sql-server

有人可以让我知道我的 SQL 语句有什么问题以及如何改进它吗？

```
da = new SqlDataAdapter("SELECT * FROM Guests"+" WHERE Students.name='" + 
   byNametextBox.Text + "'", MyConn); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T16:47:29.563

如果您只需要其中一个表中的列，则 EXISTS 谓词比 JOIN 更有效。另外-永远不要将字符串注入这样的 SQL 语句中-您只是在乞求 SQL 注入攻击或相关的崩溃错误（是的，我知道这是一个 Forms 应用程序，但同样如此。如果您正在搜索类似的名称“O'Leary”，你会崩溃）。

```
SqlCommand cmd = new SqlCommand("SELECT * FROM Guests WHERE EXISTS (SELECT Id FROM Students WHERE Guests.StudentId = Students.Id And Students.name= @name)", MyConn);
cmd.Parameters.Add("@name", SqlDbType.VarChar, 50).Value = byNametextBox.Text;
SqlDataAdapter adapt = new SqlDataAdapter(cmd); 
```

注意：有些人可能会争辩说“SELECT *”是不好的，你应该考虑指定单独的列名

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:56:27.497

您需要担心 SQL 注入。简而言之，SQL 注入是指用户能够将任意 SQL 语句放入您的查询中。要解决此问题，请使用存储过程或参数化 SQL 查询。参数化 SQL 查询的示例如下：

```
SqlConnection conn   = null;
SqlDataReader reader = null;
//Connection string goes here

string studentName = byNametextBox.Text;

SqlCommand cmd = new SqlCommand(
    "SELECT * FROM Guests "+" WHERE Students.name = @name", conn);

SqlParameter param  = new SqlParameter("@name", SqlDbType.NVarChar, 50);

param.Value = studentName;

cmd.Parameters.Add(param);
reader = cmd.ExecuteReader();
//Do stuff with reader here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:38:01.393

```
SqlDataAdapter("SELECT Guests.* FROM Guests,Students WHERE Guest.StudentId = Student.Id and  Students.name='" + byNametextBox.Text + "'", MyConn);` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T16:38:06.760

你需要一个内部连接。我认为它会是这样的：

```
SELECT Guests.* FROM Guests INNER JOIN Students ON Students.name = Guests.name WHERE Students.name = '" + byNametextBox.Text + "'" 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-16T16:47:13.900

试试看：

```
"SELECT g.*
FROM Guests g
INNER JOIN Students s ON g.StudentId = s.StudentId
WHERE Students.Name = '" + byNametextBox.Text + '"' 
```

假设与两个表相关的字段是 StudentId。

请注意，不同服务器之间的 SQL 是不一样的。该语句将在 Sql Server 上工作，我不知道在其他人。另外，请注意，您并没有保护自己免受 SQL 注入攻击。您应该使用参数执行查询，而不是按照您的方式连接字符串。

这是一个您应该自己知道的简单查询。你可以在谷歌上搜索教程，但[这里](http://www.w3schools.com/sql/default.asp)是一个通用的介绍。

# java - 如何在 iReport 中使用 SQL 查询同一项目的多个 SUM

> ID：1002639
> 
> 赞同：1
> 
> 时间：2009-06-16T16:37:48.710
> 
> 标签：java, sql, jasper-reports, ireport

*   我正在使用 iReport 创建 JasperReport，因此，我仅限于*一个 SQL 查询。

*   我有一个“统计”表，有一个“名称”（VARCHAR）、“计数”（INTEGER）和“日期时间”（DATETIME）列。

*   当最后一天的“名称”为“测试”时，获得“计数”列的总和很简单，上周和月份也是如此（见下文）

工作 SQL 语句：

```
 SELECT
  SUM(count)as 'today'
FROM
  statistics
WHERE
   name = "test"
  AND $P{oneDayAgo} <= datetime
  AND datetime <= $P{now} 
```

*   但是，由于我只有一个 SQL 语句可以使用，我需要以某种方式将它们组合起来。我尝试使用 UNION（如下所示），但这不起作用。

失败的 SQL 语句：

```
`SELECT
     SUM(count)as 'today'
FROM
     statistics
WHERE
     name = "test"
 AND $P{oneDayAgo} <= datetime
 AND datetime <= $P{now}
UNION
SELECT
     SUM(count)as 'thisWeek'
FROM
     statistics
WHERE
     name = "test"
 AND $P{oneWeekAgo} <= datetime
 AND datetime <= $P{now}
UNION
SELECT
     SUM(count)as 'thisMonth'
FROM
     statistics
WHERE
     name = "test"
 AND $P{oneMonthAgo} <= datetime
 AND datetime <= $P{now}` 
```

`(*) 只能为图表或交叉表添加额外的查询，这都不符合我的目的。`

 `* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T16:42:57.787

总和（如果 -condition- 然后计数 else 0 结束）

```
SELECT
  SUM(case when $P{oneDayAgo} <= datetime then count else 0 end) as 'today',
  SUM(case when $P{oneWeekAgo} <= datetime then count else 0 end) as 'thisweek',
  SUM(count) as 'thismonth'
FROM
  statistics
WHERE
   name = "test"
  AND $P{oneMonthAgo} <= datetime
  AND datetime <= $P{now} 
```

请注意，如果您需要平均值，请务必将 NULL 替换为 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:41:10.270

UNION 的查询应该产生相同的列（名称、类型）。将未使用的列设置为 NULL 或使用差异列：

```
SELECT
     SUM(count) as `total`,
     'today' as `when`
FROM
     statistics
WHERE
     name = "test"
 AND $P{oneDayAgo} <= datetime
 AND datetime <= $P{now}
UNION
SELECT
     SUM(count) as `total`,
     'thisWeek' as `when`
FROM
     statistics
WHERE
     name = "test"
 AND $P{oneWeekAgo} <= datetime
 AND datetime <= $P{now}
UNION
SELECT
     SUM(count) as `total`,
     'thisMonth' as `when`
FROM
     statistics
WHERE
     name = "test"
 AND $P{oneMonthAgo} <= datetime
 AND datetime <= $P{now} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:45:48.377

您有 2 个选项：

1）删除每个查询的“as”部分，然后它将作为1列没有名称

2）创建一个临时表并将这些行插入到一个临时表中，然后查询该临时表`

# soap - 带有 actionscript 2 的 SOAP 请求

> ID：1002643
> 
> 赞同：1
> 
> 时间：2009-06-16T16:38:09.913
> 
> 标签：soap, actionscript-2

我不确定如何使用 actionscript 2 发送 SOAP 请求，或者即使它支持它。我已经环顾了一段时间，但什么也没想到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T16:45:29.970

嗯，这是在第一个 google 结果页面上[Consuming a Web Service with Flash ActionScript 2.0](http://www.pixeltoys.net/2007/08/29/consuming-a-web-service-with-flash-actionscript.html)

[ActionScript 2.0 组件语言参考 > Web 服务类](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00002536.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T02:43:08.783

您需要使用 Actionscript 2 的[Web 服务类](http://livedocs.adobe.com/flash/9.0/main/00003698.html)。我个人对它们没有太多经验，并且只在一个简单的测试中使用过一次、很多年、很多年前。所以，我不能告诉你他们是否有任何好处。

# .net - 在 winforms 应用程序中使用 ASP.NET 成员资格提供程序是一个坏主意吗？

> ID：1002645
> 
> 赞同：3
> 
> 时间：2009-06-16T16:39:53.623
> 
> 标签：.net, winforms

谁能想到不在 winforms 应用程序中使用 ASP.NET 成员资格提供程序的原因？

有没有人有这样做的经验？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T16:55:21.553

在 WinForms 应用程序的客户端上使用 ASP.NET 成员资格提供程序是不安全的，因为恶意用户只需编辑应用程序配置文件就可以用他自己的选择替换提供程序。

您到底想实现什么，安全性重要吗？

# iphone - NSStream, UTF8String & NSString... 凌乱的转换

> ID：1002652
> 
> 赞同：1
> 
> 时间：2009-06-16T16:41:51.110
> 
> 标签：iphone, utf-8, nsstring, nsstream

我正在构建一个要通过 NSStream 发送到服务器的数据包。我正在尝试用“§”（ascii 代码 167）分隔两条数据。这是构建服务器的方式，所以我需要尽量保持在这些范围内......

```
unichar asciiChar = 167;  //yields @"§"
[self setSepString:[NSString stringWithCharacters:&asciiChar length:1]]; 

sendData=[NSString stringWithFormat:@"USER User%@Pass", sepString];

NSLog(sendData);

const uint8_t *rawString=(const uint8_t *)[sendData UTF8String];

[oStream write:rawString maxLength:[sendData length]]; 
```

* * *

**所以最终的结果应该是这样的......并且它在第一次构造 sendData 时是这样的：**

```
USER User§Pass 
```

* * *

**但是，当它在服务器端收到时，它看起来像这样：**

```
//not a direct copy and paste. The 'mystery character' may not be exact
USER UserÀ§Pas 
```

* * *

**...分隔符字符串的长度变为两个，并且最后一个字母从命令中被裁剪。我相信这是由 UTF8 转换引起的。**

任何人都可以为我阐明这一点吗？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T17:30:14.387

这个字符在 UTF-8 中的正确编码是两字节序列 0xC2 0xA7，这就是你得到的。（[Fileformat.info](http://www.fileformat.info/info/unicode/char/00a7/index.htm)对于这些东西是无价的。）这超出了 LATIN-1 集合，所以你几乎肯定想要使用 NSISOLatin1StringEncoding 而不是 NSUTF8StringEncoding 以获得单字节 167 编码。看`NSString -dataUsingEncoding:`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T17:22:02.243

你所拥有的和你想要传输的并不是真正的 UTF-8 字符串，而且它在技术上也不是 us-ascii，因为它只有 7 位。您想根据您正在使用的协议传输任意字节数组。字节数组的两个字段，用户名和密码，本身可能是 UTF-8 字符串，但使用`167`分隔符不能是 UTF-8 字符串。

以下是我看到的一些选项：

*   `uint8_t*`使用至少两个不同`NSString`的对象加上`167`代码构造字节数组。如果用户名或密码可能包含非 ASCII 字符，这将是必要的。
*   使用`NSString`方法`getBytes:maxLength:usedLength:encoding:options:range:remainingRange`并设置`encoding`为`NSASCIIStringEncoding`。如果您这样做，您必须在其他地方验证您的用户名和密码仅是 us-ascii。
*   使用`NSString`方法`getCString`。但是，这已被弃用，因为您无法指定所需的编码。

# objective-c - 在没有 Doxygen/编译器警告的情况下记录继承的 Obj-C 方法？

> ID：1002653
> 
> 赞同：7
> 
> 时间：2009-06-16T16:41:51.110
> 
> 标签：objective-c, cocoa, xcode, gcc, doxygen

**背景：**

我在 Objective-C 中创建复合字典数据结构的层次结构，并且从[NSMutableDictionary](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSMutableDictionary_Class)继承，因此这些类可以在需要 NSDictionary/NSMutableDictionary 的任何地方使用。（只是为了让人们不认为我在重新发明轮子，每个人都使用[CFMutableDictionaryRef](http://developer.apple.com/documentation/CoreFoundation/Reference/CFMutableDictionaryRef/)，加上一些以排序顺序、插入顺序等存储键的额外结构。）为了与 Apple 的文档保持一致，我重写了这些类中的所有其他方法都使用必要的[NSDictionary 原语](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/Reference/Reference.html#//apple_ref/doc/uid/20000140-SW3)和[NSMutableDictionary 原语。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSMutableDictionary_Class/Reference/Reference.html#//apple_ref/doc/uid/20000141-17091)

**目标：**

由于我努力尽可能完整地记录我的框架的 API，我希望[我的自定义子类](http://dysart.cs.byu.edu/CHDataStructures/interface_c_h_lockable_dictionary.html)（由 Doxygen 生成）的文档包括对 NS(Mutable)Dictionary 最常用方法的描述，因此用户不要必须查看另一个页面，以查看特定自定义字典继承的方法未更改。此外，有时文档必须反映由覆盖的原始方法引起的不同功能，尽管方法实现与 NS(Mutable)Dictionary 没有变化。

**问题：**

当仅记录被覆盖的方法时，我没有收到任何错误/警告。如果我添加记录继承方法的注释，Doxygen 会抱怨（并且不会生成所述文档），除非我将方法原型添加到头文件。如果我添加一个原型，编译器会发出一个执行完成的警告，因为它不包含声明方法的方法定义。显然，这是该方法存在于父类中的情况，但编译器在实现它时坚持不懈，因为原型本质上是在子类中重新声明的。

**问题：**

*   是否可以让 Xcode/gcc 抑制从父类继承的方法的“未找到‘X’的方法定义”警告？
*   是否可以强制 Doxygen 为不存在声明的方法创建文档？我尝试使用该`\fn`命令，但得到了相同的结果。
*   是否有可能让 Doxygen 认为我编写的文档实际上适用于 NSMutableDictionary，但它是否出现在我的所有自定义子类中？

*编辑：*

据我所知，第一个问题的答案是肯定的和否定的。从技术上讲，使用该[`-Wno-protocol`选项](http://gcc.gnu.org/onlinedocs/gcc-3.3.6/gcc/Objective_002dC-Dialect-Options.html)（或在 Xcode 构建设置中取消选中“不完整的 Objective-C 协议”警告）**确实**会导致 GCC 抑制关于似乎没有实现所有协议方法的类的编译时警告。然而，这掩盖了真正**没有**实现所有必要方法的类的问题。对于构建一个大量使用协议的框架，这真的不是一个选择。目前，GCC 似乎不知道从链接（非源）父类继承的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T09:34:37.140

据我所知，对你的三个问题的回答是：没有。

我想提请您注意 Apple 文档没有记录子类文档中的继承方法这一事实。

此外`NSDictionary`，`NSMutableDictionary`并不少见需要提醒他们最常用的方法。对我来说，现有文档的链接就足够了。

关于您对子类中这些常用方法的具体行为的看法，我只想在 *详细说明*一章中插入一个专门的部分。

无论如何，一种可能的解决方法是同时给出继承方法的声明和实现。但仅出于文档目的，这有点矫枉过正：

```
- (NSArray *) allValues
{
    return [super allValues];
} 
```

# advantage-database-server - 优势 8.1 与 7.1

> ID：1002654
> 
> 赞同：2
> 
> 时间：2009-06-16T16:42:07.663
> 
> 标签：advantage-database-server, server-administration

我正在将一些内部应用程序从 ADS 7.1 升级到 8.1。

不久前有人告诉我，函数的返回值`AVG()`以及一些除法计算发生了变化，但我找不到关于这些变化的任何文档。

有谁知道我在说什么或有一个解释细节的链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T14:31:53.013

帮助文件中的“升级到版本 8.1 的影响”主题有一小段关于更改，但没有详细说明。

基本上，从 8.1 版开始，Advantage 现在在整数除法方面遵循 SQL 标准。整数除法表达式的小数部分被截断，过去它们会导致浮点结果。

要解决此更改，如果您仍希望某些表达式产生浮点数据类型，则可能必须强制转换它们。例如：

这：

```
select int1 / int2 from mytable; 
```

需要改为：

```
select cast( int1 as sql_float ) / int2 from mytable; 
```

# flash - Flash 中多余的文本填充

> ID：1002657
> 
> 赞同：1
> 
> 时间：2009-06-16T16:42:34.683
> 
> 标签：flash, actionscript-3

Flash 中的 flash.text.TextField 似乎有一些内置的填充。特别是，我的问题是我需要将文本与其他一些图形元素左对齐，并且有可见的（大约 3px）偏移。flash.text.TextField 类（或任何其他相关的文本类）似乎没有可以更改它的属性。

我知道它可能不符合严格的编程问题，因为 Flash 也是一个问题（就像程序本身一样），但涉及到一些编程，老实说，Stackoveflow 是最好的提问场所。

**编辑：**我上面提到的 3px 是针对特定字体大小的。填充也取决于字体大小。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T16:54:02.630

根据[this page](http://livedocs.adobe.com/flex/2/langref/flash/text/TextLineMetrics.html)，这是一个固定的2px“装订线”，因此将Textfield向左平移2个像素就足够了。您也可以尝试使用`flash.text.TextField.getLineMetrics()`来获取有关其他填充的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:50:21.167

我相信这取决于使用的字体。通常在字体度量中设置了一些左侧边距，这就是您看到的偏移量。修复是将文本字段移动几个像素以抵消边距。

您可以在此处阅读更多关于字体[侧边栏的信息](http://www.myfirstfont.com/glossary.html)。

# xml - 导入 XML 崩溃 Excel

> ID：1002663
> 
> 赞同：4
> 
> 时间：2009-06-16T16:44:20.657
> 
> 标签：xml, excel, import, crash, spreadsheet

几个月来，我的所有电子表格都遇到了这个反复出现的问题。电子表格将正常工作并导入从我们网站获取的 xml 文件，然后突然之间，每次导入时它都会开始崩溃。唯一修复它的方法是获取所有内容（工作表、代码、参考）并将它们放入新的工作簿中。

这是它崩溃的线路。

```
ActiveWorkbook.XmlImport URL:=l_strXMLFileName, _
ImportMap:=Nothing, Destination:=Sheets("Imported Data").Range("$A$1") 
```

有人遇到过这个问题吗？如果是这样，有没有更好的方法来防止它崩溃？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T16:50:49.840

我在找到答案后发布了这个问题，只是因为这对我来说是一场灾难，并且困扰了我好几个月。希望这篇文章能防止其他人像我这么久以来那样拔头发。

修复非常简单。每次 excel 导入一个 xml 文件时，都会在该电子表格中存储一个 xmlmap。因此，如果您使用相同的电子表格并继续保存它，这些会随着时间的推移而累积。我找到的最佳解决方案是删除这些 xml 映射，或重复使用相同的映射（后者多次不是一个好选择）。

这是一些删除所有这些的代码（我只是在我的问题中包含的代码之前运行它）：

```
Dim XmlMap as XmlMap
    For Each XmlMap In ActiveWorkbook.XmlMaps
        XmlMap.Delete
    Next 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-16T16:48:04.087

输入 XML 是否有可能包含一些非法/未转义的字符？

# mysql - MySQL 有限的 TIMESTAMP 范围的解决方法？

> ID：1002665
> 
> 赞同：2
> 
> 时间：2009-06-16T16:45:09.080
> 
> 标签：mysql, timestamp

有谁知道在 MySQL TIMESTAMP 字段中存储 '1970-01-01 00:00:01' UTC 到 '2038-01-09 03:14:07' UTC 范围之外的值的解决方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T16:48:35.707

如果将列更改为使用 DATETIME 类型，则可以存储更广泛的值。

TIMESTAMP 类型的范围是 '1970-01-01 00:00:01' UTC 到 '2038-01-09 03:14:07' UTC。

DATETIME 类型的范围是“1000-01-01 00:00:00”到“9999-12-31 23:59:59”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:49:24.647

TIMESTAMP 不应用于文字日期/时间值，它用于 SQL Server 同步。

使用 SMALLDATETIME 或 DATETIME。

# linux - 体验构建和使用 Qt Embedded

> ID：1002667
> 
> 赞同：2
> 
> 时间：2009-06-16T16:45:29.347
> 
> 标签：linux, qt, embedded, makefile, compilation

我目前正在尝试在 ARM 架构的 Ubuntu 机器上为嵌入式 Linux 编译和构建 QT。到目前为止，我在尝试 MAKE 时遇到了很多错误。最大的一个是导致编译器错误的 2000 行 C++ 函数。其他人对此有何经验，您是如何解决的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T16:49:01.527

我的经验一直是有利的，因为：

您必须遵循 Qt 安装说明中的每一条说明，无一例外。每次我遇到编译错误，都是因为我试图快速完成，而不是阅读该特定平台的附加文档。

我会查看说明 - 可能需要先完成一些小事，这很可能会消除您的错误。

# asp.net - jQuery：设置每页的功能

> ID：1002675
> 
> 赞同：0
> 
> 时间：2009-06-16T16:46:21.700
> 
> 标签：asp.net, jquery

我目前有一个 jQuery 脚本页面，我将其包含在 MasterPage 上的 ScriptManager 中（我使用 ASP.NET）。我所有页面的所有自定义脚本都在此页面中。我知道有些人喜欢把它分成多页，但我更喜欢把它们都放在一个地方。无论如何，我`$(document).ready(function(){ //do stuff// });`在这个页面上有一个。我命名的所有其他函数然后放在 document.ready 函数中，即：

```
$(document).ready(function(){ 
    Function1(); //necessary for page1.aspx, page2.aspx but not 3 or 4
    Function2(); //etc., necessary for some but not other pages
});

function Function1() {
    // whatever, etc //
} 
```

我的问题围绕着这个效率。许多这些功能仅在某些页面上具有任何类型的应用程序，但不是全部。包含一些特定于页面的编码会更好吗，即确定我们在哪个页面上，然后如果我们在正确的页面上，继续执行该功能，还是无关紧要？我的印象是这无关紧要，但我想确定一下。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T17:00:25.137

我不能说这是否是一个明确的答案，但是在任何项目中，我可能会尝试显示和显示与该页面无关的尽可能少的编码。

因此，在 JQuery 的情况下，我只会通过执行服务器端检查来显示该页面所需的 javascript 代码。

但我想这真的取决于你使用的代码有多大，如果它是 jquery 中的一个小的单行脚本，那么我认为你不会真的输掉，但如果你有很多逻辑，那么我建议在需要它的每个页面上分解它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T17:02:04.980

根据特定页面功能的数量，它可能很重要。

如果您有少量额外数据，那么您不会看到任何明显的性能下降。但是，随着代码库的增长，维护该代码可能会变得一团糟。

此外，您会在每个页面请求中通过网络推送额外的位，因为流量增加可能会增加带宽的额外成本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T17:04:40.233

您可能会考虑将所有内容放入外部 .js 文件中。然后浏览器只需下载一次代码。

如果这些函数在不需要它们的页面上导致错误，您应该只将它们包含在需要它们的页面上。

否则，这取决于执行函数需要多长时间。如果它不是很长，我会说不要担心。通过添加一堆 if 语句来引入脆弱性是不值得的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T18:12:49.923

是的。这很重要。真正的问题是这些功能有多复杂。如果您认为检查是否需要函数的代码比运行代码更耗时，那么就没有必要了。

所以这就是你需要问自己（或测试）的问题：是否需要更长的时间来测试我是否需要该功能，或者只是运行它们？

# iis - XP Pro IIS 上的 localhost 子域？

> ID：1002676
> 
> 赞同：1
> 
> 时间：2009-06-16T16:46:27.457
> 
> 标签：iis, windows-xp, localhost

有没有办法为 test.localhost 之类的东西设置子域 udner Xp Pro IIS

可以通过 IIS 或 hosts 文件完成吗？需要在使用 pathign 回到根目录的站点上进行 tets，因此将站点置于 localhost/test 之类的虚拟目录中会导致问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:04:55.740

您可能很清楚，开箱即用的 IIS 5.1 仅支持一个网站。您可以使用该`adsutil.vbs`工具在 IIS 5.1 中创建第二个站点并将其配置为使用该站点。

下面的文章解释了这个过程：

> [IIS：在 Windows 2000 和 Windows XP Professional 上的 IIS 中创建多个网站](http://www.xoc.net/works/tips/multiple-iis-sites-professional.asp)

甚至还有一个 GUI 小部件可以让生活变得轻松：

> [http://www.firstserved.net/support/downloads](http://www.firstserved.net/support/downloads)

简而言之：

1.  使用上述方法之一创建第二个站点（将 IP 地址设置为您机器的主 IP 地址）
2.  将域的主机标头添加 `test.localhost`到新站点
3.  编辑 HOSTS 并添加一个条目以 `test.localhost`指向上面的 IP 地址

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T17:09:46.843

最简单的方法是将您已经拥有的单独站点的文档根目录切换到与目标站点不同的文件夹。然后你可以在完成后将其切换回来。

如果您在根目录下的虚拟目录中构建东西，这甚至不会影响任何正在进行的项目。

我似乎记得有一个工具可以为您完成此操作，但我忘记了它的名称和坐标。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-16T16:54:25.187

在 IIS 中创建一个新网站。主机头值应该是您的子域，例如“sub.localhost”，然后将域添加到您的主机文件中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-16T17:09:37.077

用记事本打开文件 c:\windows\system32\drivers\etc

并添加这一行：

```
 127.0.0.1 mysuper-site.com.net.blabla 
```

然后浏览到这个站点：[http://mysuper-site.com.net.blabla](http://mysuper-site.com.net.blabla)

# c# - 如何在 C# 中接收服务器推送数据？

> ID：1002677
> 
> 赞同：4
> 
> 时间：2009-06-16T16:46:27.770
> 
> 标签：c#, push

我正在写一个程序。我的程序通过 HTTP 协议从服务器接收数据。数据将由服务器推送到我的程序。我尝试使用 WebRequest，但只收到了一个会话数据。我怎样才能保持连接活跃，以连续接收来自服务器的数据，感谢任何帮助。

以下是SDK文档：

在 GUEST 或 ADMIN 的授权下，可以获得系列直播图像（服务器推送）。要获取图像，请将请求发送到“/liveimg.cgi?serverpush=1”，如图所示。2-1-1。
当摄像头收到客户端的上述请求后，如图所示发送返回。2-2。
每个 JPEG 数据由“--myboundary”分隔，“image/jpeg”在“--myboundary”之后作为“Content-Type”标头返回。对于“Content-Length”标头，它返回 --myboundary 数据中的字节数（不包括“--myboundary”、每个标头和 \r\n 作为分隔符）。在“Content-Length”标头和“\r\n”（分隔符）之后，将发送实际数据。
这种数据传输将一直持续到客户端停止连接（断开连接），或者出现一些网络错误。

国际化; 字符串 uri = @" [http://192.168.0.2/liveimg.cgi?serverpush=1](http://192.168.0.2/liveimg.cgi?serverpush=1) ";

```
 HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create(uri);
        req.Credentials = new NetworkCredential("admin", "admin");
        req.KeepAlive = true;

        string line = "";

        HttpWebResponse reply = (HttpWebResponse)req.GetResponse();
        Stream stream = reply.GetResponseStream();

        System.Diagnostics.Debug.WriteLine(reply.ContentType);

        StreamReader reader = new StreamReader(stream);
        do
        {
            line = reader.ReadLine();
            System.Diagnostics.Debug.WriteLine(line);

            System.Threading.Thread.Sleep(300);

        } while (line.Length>0); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T16:58:59.753

如果服务器支持，您可以长时间保持 HTTP 连接打开。（如前所述，这将大大限制您可以支持的同时用户数量。）

服务器将需要设置 Response.Buffer=false，并具有扩展的 ScriptTimeout（我假设您在服务器端使用 ASP.NET）。一旦你这样做了，你的页面可以根据需要继续发送 Response.Write 数据，直到它正在做的任何事情都完成。

您的客户端将需要在连接完成之前处理传入的响应，而不是阻止完整的响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-25T21:52:50.560

您可能想看看[StreamHub 推送服务器](http://www.stream-hub.com/)- 它是一个流行的 Comet 服务器，并有一个 .NET 客户端 SDK，它允许您接收 C#（或 VB/C++）中的实时推送更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:57:28.523

如果我对您的理解正确，您的服务器将通过在发出请求/响应的客户端之外向您的客户端发送数据来响应某些事件。这个对吗？如果是这样，除非您的客户端数量很少，否则我不建议尝试保持连接打开 - 可用的连接数量有限，因此保持它们打开可能会迅速导致异常。

可能最简单的解决方案是让客户端定期轮询新数据。这将允许您使用一个简单的服务器，并且您只需在客户端上编写一个线程，以每分钟或三十秒或任何您的最佳时间段请求任何更改或新工作。

如果您真的想让服务器主动通知客户端，而不需要它们轮询，那么您将不得不做一些除了简单的 Web 服务器之外的事情——您还必须编写和配置客户端以接受传入的请求。如果您的客户端在防火墙等后面运行，这可能会很困难。如果你走这条路，WCF 可能是你最好的选择，因为它允许你适当地配置服务器和客户端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-30T06:26:21.717

您需要从 IP cam 获取 cookie，并将该 cookie 包含在下一个 HttpWebRequest 的标头中。否则，它总是会尝试将您重定向到“index.html”。
这是你可以做到的...

BitmapObject 是一个用作 Jpeg 图像、当前日期和最终错误文本的容器的类。建立连接后，它将每 200 毫秒汇集一个图像。同样适用于通过“serverpush”获得的连续图像流。

```
public void Connect()
{
    try
    {
        request = (HttpWebRequest)WebRequest.Create("Http://192.168.0.2/index.html");

        request.Credentials = new NetworkCredential(UserName,Password);
        request.Method = "GET";
        response = (HttpWebResponse)request.GetResponse();
        WebHeaderCollection headers = response.Headers;
        Cookie = headers["Set-Cookie"];//get cookie

        GetImage(null);
    }
    catch (Exception ex)
    {
        BitmapObject bitmap = new BitmapObject(Properties.Resources.Off,DateTime.Now);
        bitmap.Error = ex.Message;
        onImageReady(bitmap);
    }
}

private Stream GetStream()
{
    Stream s = null;
    try
    {
        request = (HttpWebRequest)WebRequest.Create("http://192.168.0.2/liveimg.cgi");
        if (!Anonimous)
            request.Credentials = new NetworkCredential(UserName, Password);
        request.Method = "GET";
        request.KeepAlive = KeepAlive;

        request.Headers.Add(HttpRequestHeader.Cookie, Cookie);
        response = (HttpWebResponse)request.GetResponse();
        s = response.GetResponseStream();

    }
    catch (Exception ex)
    {
        BitmapObject bitmap = new BitmapObject(Properties.Resources.Off,DateTime.Now);
        bitmap.Error = ex.Message;
        onImageReady(bitmap);
    }
    return s;
}

public void GetImage(Object o)
{
    BitmapObject bitmap = null;
    stream = GetStream();
    DateTime CurrTime = DateTime.Now;
    try
    {
        bitmap = new BitmapObject(new Bitmap(stream),CurrTime);
        if (timer == null)//System.Threading.Timer
            timer = new Timer(new TimerCallback(GetImage), null, 200, 200);
    }
    catch (Exception ex)
    {
        bitmap = new BitmapObject(Properties.Resources.Off, CurrTime);
        bitmap.Error = ex.Message;
    }
    finally
    {
        stream.Flush();
        stream.Close();
    }
    onImageReady(bitmap);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T16:52:39.557

如果您使用的是标准 Web 服务器，它永远不会向您推送任何内容 - 您的客户端将不得不定期从中拉取。

要真正获得服务器推送数据，您必须自己构建这样的服务器。

# jquery - 如何让 jQuery 的 Uploadify 插件与 ASP.NET MVC 一起使用？

> ID：1002680
> 
> 赞同：35
> 
> 时间：2009-06-16T16:47:27.957
> 
> 标签：jquery, asp.net-mvc, uploadify

我正在尝试让 jQuery 插件[Uploadify](http://www.uploadify.com/)与 ASP.NET MVC 一起使用。

使用以下 JavaScript 片段，我的插件可以正常显示：

```
<script type="text/javascript">
    $(document).ready(function() {
        $('#fileUpload').fileUpload({
            'uploader': '/Content/Flash/uploader.swf',
            'script': '/Placement/Upload',
            'folder': '/uploads',
            'multi': 'true',
            'buttonText': 'Browse',
            'displayData': 'speed',
            'simUploadLimit': 2,
            'cancelImg': '/Content/Images/cancel.png'
        });
    });
</script> 
```

看起来一切都很好。如果您注意到，“脚本”属性设置为我的 /Placement/Upload，这是我的放置控制器和我的上传操作。

主要问题是，我很难让这个动作触发来接收文件。我已经在该操作上设置了一个断点，当我选择要上传的文件时，它没有被执行。

我已经尝试根据[这篇文章](http://donnyvblog.blogspot.com/2009/05/using-jquery-plugin-uploadify-with.html)更改方法签名：

```
public string Upload(HttpPostedFileBase FileData)
{
    /*
    *
    * Do something with the FileData
    *
    */
    return "Upload OK!";
} 
```

但这仍然没有触发。

谁能帮我正确编写并获取上传控制器操作的签名，以便它真正触发？然后我可以自己处理文件数据。我只需要一些帮助来触发方法操作。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-08-21T01:22:43.630

```
public string Upload(HttpPostedFileBase FileData) {} 
```

是正确的——uploadify 上传的文件将绑定到 FileData。无需进入 Request.Files 来检索文件——这使得模拟和测试变得更加困难。

如果您的操作根本没有触发（即尝试调试并查看方法中的断点是否被命中），那么您的问题很可能是“脚本”值 - 您是否在虚拟目录下运行？如果是这样，您需要将目录的名称放在前面。Uploadify 使用的是绝对路径。

即'脚本：'/virtual_directory/Placement/Upload'

现在 uploadify 正在发送到[http://localhost/Placement/Upload](http://localhost/Placement/Upload)。

还可以尝试使用路由调试器（[http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)）来检查您的路由映射到的位置。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-07-15T08:37:46.140

问题可能是您需要指定您要上传到的操作设置为发布...它不能将该操作用作获取操作。

所以这：

```
public string Upload(HttpPostedFileBase FileData)
{
   //do something
} 
```

应该是这样的：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Upload(HttpPostedFileBase FileData)
{
   //do something
} 
```

另外，请注意，如果您在站点的“登录”部分使用它，您应该在这里查看已知的上传和身份验证错误：http: [//geekswithblogs.net/apopovsky/archive/2009/ 05/06/working-around-flash-cookie-bug-in-asp.net-mvc.aspx](http://geekswithblogs.net/apopovsky/archive/2009/05/06/working-around-flash-cookie-bug-in-asp.net-mvc.aspx)

另外，顺便说一句，MVC 中有几种处理文件上传的方法（根据 Rory Fitzpatrick 的建议使用 Request.Files，以及在操作定义中将 HttpPostedFileBase 文件作为参数传递）。为了让 Uploadify 正常工作，这并不重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T17:01:56.587

这根本不是我必须实现文件上传的方式。我有一个没有参数的操作方法，它使用当前的 Request 对象潜入发布文件的集合。

我的实现中的一些示例代码：

```
[AcceptVerbs(HttpVerbs.Post)]
public ContentResult Upload() {
    if (Request.Files.Count > 0 && Request.Files[0].ContentLength > 0) {
        HttpPostedFileBase postedFile = Request.Files[0];
        // Do something with it
    }
} 
```

当然，为此编写测试变成了 PITA。您必须模拟几个对象才能使其工作，例如：

```
var mockHttpContext = mocks.StrictMock<HttpContextBase>();
var mockRequest = mocks.StrictMock<HttpRequestBase>();
var postedFile = mocks.StrictMock<HttpPostedFileBase>();

var postedFileKeyCollection = mocks.StrictMock<HttpFileCollectionBase>();

mockHttpContext.Expect(x => x.Request).Return(mockRequest).Repeat.Any();
mockRequest.Expect(x => x.Files).Return(postedFileKeyCollection).Repeat.Any();

postedFileKeyCollection.Expect(x => x[0]).Return(postedFile).Repeat.Any();
postedFileKeyCollection.Expect(x => x.Count).Return(1);

postedFile.Expect(f => f.ContentLength).Return(1024);
postedFile.Expect(f => f.InputStream).Return(null); 
```

在发布的文件中创建一个接口并只模拟它会更容易，并使用 IoC 将具体实现注入到您的控制器中。

我认为这主要是基于这篇文章：[Implementing HTTP File Upload with ASP.NET MVC including Tests and Mocks](http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-06T22:19:06.417

我对此的完整解决方案可能会解决您的问题。希望能帮助到你。

[http://zootfroot.blogspot.com/2010/12/mvc-file-upload-using-uploadify-with.html](http://zootfroot.blogspot.com/2010/12/mvc-file-upload-using-uploadify-with.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T17:04:45.943

阅读文档，看起来它正在发送一个文件数组。你有没有尝试过：

```
public string Upload( HttpPostedFileBase[] fileData ) 
```

默认模型绑定器也可能无法与 HttpPostedFileBase 一起使用，您需要使用 Rory 的机制或编写自己的模型绑定器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-06T21:48:40.747

这是我的简单 Razor 视图（布局大师有 Javascript 包）

```
@{
ViewBag.Title = "Upload Email CSV";
Layout = "~/Views/Shared/_Layout.cshtml";
}
<script type="text/javascript" src="@Url.Content("~/Scripts/Uploadify/jquery.uploadify.js")"></script>

<script type="text/javascript">

$(function () {
    var uploadUrl = "@Url.Content("~/UploadFile/UploadEmailCSV/")";
    var uploadSWF = "@Url.Content("~/Scripts/Uploadify/uploadify.swf")";
    var uploadifyButtonImage = "@Url.Content("~/Scripts/Uploadify/uploadify.swf")";

    $('#file_upload').uploadify({
        'fileSizeLimit': '0',
        'buttonImage': '/uploadify/browse-btn.png',
        'swf': uploadSWF,
        'uploader': uploadUrl,
        'onUploadSuccess': function(file, data, response) {
            alert('The file was saved to: ' + data);
        }
    });
});
</script>
<h2>Upload a comma separated list of email addresses</h2>
@using (Html.BeginForm("UploadEmailCSV", "UploadFile", FormMethod.Post, new { @class = "form-horizontal", @enctype = "multipart/form-data", @id = "frmUploadFiles" }))
{
    <input type="file" name="file_upload" id="file_upload" />
} 
```

这是控制器方法

```
public ActionResult UploadEmailCSV()
    {
        var uploadedFile = Request.Files["Filedata"];

        if (uploadedFile != null && uploadedFile.ContentLength > 0)
        {
            var filePath = Path.Combine(Server.MapPath("~/UploadedFiles"), string.Format("{0}_{1}{2}", Path.GetFileNameWithoutExtension(uploadedFile.FileName), DateTime.Now.Ticks, Path.GetExtension(uploadedFile.FileName)));
            uploadedFile.SaveAs(filePath);
            return Content(string.Format("{0}_{1}{2}", Path.GetFileNameWithoutExtension(uploadedFile.FileName), DateTime.Now.Ticks, Path.GetExtension(uploadedFile.FileName)));

        }
        return Content("Error Uploading file!");
    } 
```

就是这样！

# np-complete - “组合算法”和“线性算法”有什么区别？

> ID：1002697
> 
> 赞同：6
> 
> 时间：2009-06-16T16:51:21.743
> 
> 标签：np-complete, approximation

或者更确切地说，组合算法和线性算法的定义分别是什么？

说清楚是因为显然第一响应者误解了这个问题：我不是在寻找线性时间与非线性时间运行的算法的定义。线性算法在某种程度上与线性规划有关，线性规划是一种用于寻找或逼近线性优化问题的解决方案的技术。

由于 NP-hard 问题非常困难，因此整个领域都在试图找到近似解。例如，旅行商问题有几个近似解，它们在多项式时间内运行，并产生一个在最佳解的给定范围内的解。

这些近似算法中的一些称为线性算法，另一些称为组合算法；后者似乎是首选（为什么？）。这是我想了解的两个概念。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-09-25T16:22:08.723

问题是问题表述之一。

正如您所说的旅行销售员问题 (TSP) 是**NP-hard**正是因为它具有离散的问题公式（销售员在特定时间访问或不访问城市）。这种离散的公式产生了问题，它的算法是**组合**的。（请注意，并非所有组合问题都是 NP 难题；请考虑排序算法。）

然而，TSP 的线性规划 (LP) 松弛导致**线性**算法。这是因为问题已被重新表述，以便销售人员在一定比例的时间内访问一个城市。使用 LP 松弛的主要原因是因为松弛版本可以在**多项式**时间内求解。然而，LP松弛的解决方案不一定是原始问题的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:55:05.093

线性算法往往只处理一组数据——“取集合 a 中的所有数字，将它们加倍，然后将结果放入集合 b”。操作数等于集合 a 中的项目数

组合式适用于集合的组合 - “对于集合 a 中的每个数字，计算出该数字与集合 b 中每个数字的总和并打印到屏幕上”。操作数是集合 a 的大小和集合 b 的大小的乘积。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:59:00.160

组合算法随着输入的增长而“爆炸”。线性算法与其输入成比例增长，而组合算法则与指数（或更糟）或其输入成比例增长：例如，枚举通过图形的所有可能路径。

# sql - 我应该如何针对可以为空的 SQL 变量测试字段？

> ID：1002701
> 
> 赞同：3
> 
> 时间：2009-06-16T16:53:12.257
> 
> 标签：sql, sql-server, sql-server-2008, three-valued-logic

我有以下 SQL：

```
CREATE TABLE tbFoo(
    a varchar(50) NULL,
) 

CREATE NONCLUSTERED INDEX IX_tbFoo_a ON tbFoo
(
    a ASC
)
WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON)

insert into tbFoo select null
insert into tbFoo select 'test' 
```

以下两个查询工作正常并按预期使用我的索引：

```
select * from tbFoo where a='test'
select * from tbFoo where a is null 
```

现在，假设我想将比较值存储在一个变量中，如下所示：

```
declare @a varchar(50)
select @a = NULL 
```

如果@a 为空，则以下查询将不会返回预期结果，因为我应该使用“is”运算符而不是“=”

```
select * from tbFoo where a=@a 
```

以下将起作用，但如果@a 为空，则会进行表扫描（因为“测试”行会强制评估第二个括号）

```
select * from tbFoo where (a is null and @a is null) or (a=@a) 
```

最终，我想出了这个解决方案，它工作正常并使用我的索引：

```
select * from tbFoo where (a is null and @a is null) or (@a is not null and a=@a) 
```

我对情况的分析正确吗？

有没有更好的方法来处理这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:10:18.480

> 最终，我想出了这个解决方案，它工作正常并使用我的索引：

在 SQL Server 2008 中，您可以根据排除 NULL 的谓词定义筛选索引：

```
CREATE UNIQUE NONCLUSTERED INDEX IX_tbFoo_a 
ON tbFoo (a)
WHERE a IS NOT NULL; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T22:00:13.647

也许您的数据库引擎会自动优化您获得的内容，但在我看来，以下内容会更有效：

```
if @a IS NULL
    select * from tbFoo where a is null
else
    select * from tbFoo where a = @a 
```

我的理由是您`if @a IS NULL`只执行一次条件，而不是检查数据库中的每一行。尽管如此，一个高质量的数据库引擎应该能够将您的代码转换为与此相同类型的数据计划。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T17:05:49.640

没有什么永远“等于” NULL ......这有点像 NULL。

您的解决方案将正常工作。我对查询优化器如何处理较短的版本感到惊讶。我认为在使用表扫描测试相等性之前测试 NULL 是不费吹灰之力的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T18:05:38.390

另一种可能性是使用将 ansi nulls 设置为 off

```
set ansi_nulls off

declare @a varchar(50)
select @a = NULL

select * from tbFoo where a=@a

set ansi_nulls on 
```

请记住，您正在摆脱这里的默认行为

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T21:33:57.677

我家里没有实例可以玩，但我可以看到表扫描变得非常烦人。一种可能的替代方法是使用 UNION 代替 OR 运算符...

```
select * from tbFoo where (a is null and @a is null)
UNION ALL
select * from tbFoo where (a=@a and @a is not null) 
```

（我不确定“@a is not null”究竟会对性能产生什么影响，但我的直觉是包含它。它是一个常量表达式，应该允许优化器知道整个条件何时总是失败。我的技术总是玩，看看什么效果最好。）

我发现这个 UNION 技巧有两个属性：
- 它可以通过简化查询来显着提高性能
- 它使用多个连接来膨胀代码并导致主要的维护 问题

但是，生活只是一种平衡行为:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T21:46:02.347

只是 ISNULL 双方都像这样......

```
DECLARE @random VARCHAR(50)
SELECT  @random = 'text that never appears in your table'

SELECT * FROM @tbFoo WHERE ISNULL(a, @random) = ISNULL(@a, @random) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T22:10:33.423

你的分析是正确的——这就是为什么三值逻辑让生活变得困难。

@StriplingWarrior 的建议很好；它通过根据变量是否为空执行不同的 SQL 来解决问题。如果这是不可能的，那么重复使用主机变量的冗长解决方案是必要的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T17:15:10.910

这就是我所做的。它非常灵活。我假设@a 是存储过程的参数。'somethingweird' 可能是你永远不会在你的记录集 '~~~' 或其他任何东西中看到的东西。

```
set @a = isnull(@a,'somethingweird')
select * from tbFoo where isnull(a,'somethingweird')=@a 
```

# c# - 将 VB.NET 2005 项目转换为 C# 2008 项目

> ID：1002703
> 
> 赞同：4
> 
> 时间：2009-06-16T16:53:32.177
> 
> 标签：c#, .net, vb.net, visual-studio, visual-studio-2008

是否有将 VB.NET 2005 项目转换为 C# 2008 项目的工具。我正在尝试将我们的项目转换为 VS 2008，并且主要将某些项目中的所有 vb.NET 代码移植到 C# 3.0/3.5。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T17:03:57.957

我对 VB.net 项目也做出了类似的决定。解决方案是妥协，我决定使用双重 VB 和 C#。

将 VB.NET 2005 升级到 2008 很容易。

将 CSharp 和 VB 文件夹添加到 App_Code 和

```
<codeSubDirectories>
<add directoryName="CSharp" />
<add directoryName="VB" />
</codeSubDirectories> 
```

到 web.config 的编译部分

正如 Kev 所说，这并不像您期望的那样简单，而且您可能会遇到意想不到的问题，这使得使用双语言支持运行成为最佳解决方案

我知道这并不能直接回答问题，但它是另一种方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T19:22:18.360

您可以查看[SharpDevelop](http://community.sharpdevelop.net/blogs/mattward/articles/FeatureTourCodeConversion.aspx)。它是一个开源的 .NET 开发环境。SharpDevelop 内置了一些代码转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:55:18.260

看看这个。

[http://www.developerfusion.com/tools/convert/vb-to-csharp/](http://www.developerfusion.com/tools/convert/vb-to-csharp/)

尝试谷歌术语“convert vb.net project to c# project”，你会在那里找到几个选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T17:19:17.240

CodeProject 上有一个名为[GBVB (Goodbye VB)](http://www.codeproject.com/KB/cs/gbvb.aspx)的工具，它声称可以“完美地”将 VB.NET 代码转换为 C# 代码。然而，作者确实添加了一些警告，例如模棱两可的代码、可选参数等问题。

另一种方法是使用[Denis Bauer 的 Reflector.FileDisassembler](http://www.denisbauer.com/NETTools/FileDisassembler.aspx) .NET Reflector[插件](http://www.codeplex.com/reflectoraddins)并将已编译的程序集反汇编回 C#。

处理 .aspx/.asmx 页面及其代码隐藏文件可能是一种特殊情况，因为您需要手动更改`<%@ Page Codebehind="Default.aspx.cs" %>`指令以指向正确的源文件。

VB.NET 到 C# 的自动转换并不像最初看起来那样简单。我以前来过这里并放弃了一个相当大的项目，有很多关于特定边缘情况的摆弄，其中翻译要么无法编译，要么在运行时产生意外行为。我选择采用双语言解决方案，所有新代码都用 C# 编写，而旧的 VB.NET 代码随着时间的推移逐渐移植。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-23T08:12:35.353

嗨，这个代码答案不是

```
public student ()
        {}
        private string code;
            private string name;
        public string code()
        { 
        set (code=Value);
            Get return code;

        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T16:56:42.957

Telerik 有一个[转换器](http://converter.telerik.com/)，您可能想看看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T15:42:05.040

由于其他人提到了在线转换工具，我发现[www.carlosag.net](http://www.carlosag.net/Tools/CodeTranslator/)最适合我的代码。也许 b/c 我使用其他 3rd 方 API，但似乎很多其他在线转换器在遇到无法转换的行时就会出错。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-29T15:35:07.747

SharpDevelop 非常好，但在我的公司，我们发现 VBConversions 可以提供更完整的转换。虽然这是一个商业应用程序，但对于通过 SharpDevelop 节省的时间来说，这对我们来说是轻而易举的事。

作为一个具体的例子，我们发现 SharpDevelop 没有正确转换的一件事是 VB 索引，它使用了弯括号。它似乎无法区分索引和方法调用，因此没有将索引转换为方括号。VBConversions 很好地转换了它们。这件事让我们值得购买。

看起来[有形软件](http://www.tangiblesoftwaresolutions.com/)的产品与 VBConversions 非常相似，但我没有任何经验。[Jon Skeet 建议](https://stackoverflow.com/questions/355340/convert-vb-net-c-sharp-projects/355505#355505)了它，所以它一定很不错。

# php - 使用 Zend_Date 处理日期和时区

> ID：1002704
> 
> 赞同：6
> 
> 时间：2009-06-16T16:53:44.143
> 
> 标签：php, zend-framework, date

我有一个使用 Zend_Date 来显示日期的应用程序。Zend_Date 实例是使用来自 MySQL 的日期时间数据、用户输入和当前日期创建的。

我希望我的用户能够指定他们的时区，并且所有日期都以他们的本地时间显示。

目前我的代码是这样工作的：

```
$date = '2009-01-01 10:30:00';

$date = new Zend_Date($date, Zend_Date::ISO_8601);

echo $date->get(Zend_Date::TIME_MEDIUM); //10:30:00

$date->setTimezone('Australia/ACT');

echo $date->get(Zend_Date::TIME_MEDIUM); //21:30:00 
```

这可行，但需要在每个日期调用 setTimezone。有没有更简单的方法来管理时区？

我也一直在研究将 SET time_zone 与 MySQL 一起使用，以从 MySQL 返回调整后的数据。然后我只需要为时区调整 PHP 脚本中创建的日期。

如果有人有经验，我很想听听处理这个问题的最佳方法。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T18:16:05.630

我认为设置 PHP 时区应该为所有后续 Zend_Date 实例设置默认值。例如：

```
date_default_timezone_set('Europe/Vienna'); 
```

[Zend 框架参考指南中](http://framework.zend.com/manual/en/zend.date.html#zend.date.setdefaulttimezone)的Zend_Date 部分：

> 在 PHP 中，我们可以通过根据用户的期望设置默认时区来调整所有与日期和时间相关的函数以适用于特定用户。创建 Zend_Date 实例时，它们的时区将自动成为当前的默认时区！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-15T15:28:09.823

我认为你可以使用 Zend_Locale，阅读一些关于它的文档，很确定你可以让它工作。另一方面，如果您使用 Zend_Cache 和 Zend_Locale/Zend_Date，这将有助于大大提高速度。zend 框架文档中也有使用示例。

# windows-7 - 检测注册表虚拟化

> ID：1002709
> 
> 赞同：25
> 
> 时间：2009-06-16T16:54:08.323
> 
> 标签：windows-7, registry, c#-2.0, virtualization, uac

我有一组 C# (v2) 应用程序，我在 Win7（以及在较小程度上是 Vista）中的注册表虚拟化方面苦苦挣扎。

我有一个共享注册表配置区域，我的应用程序需要在 HKLM\Software\Company 中访问它... 在 Vista 之前，所有内容都只是根据需要写入和读取该位置。

代码适当地检测到写入该注册表项的失败并会适当地回退（改为写入 HKCU 并通知用户他们应用的设置只会影响当前用户）。

在 Vista 中，注册表虚拟化打破了这一切，因为我们用于 HKLM 写入的访问检查将“成功”静默“成功”并虚拟化到 HKCR\VirtualStore\Machine...。在这种情况下，用户会认为他们已经保存了机器范围的配置，但只是写入了虚拟存储。

可悲的是，即使尝试枚举 HKLM reg 键上的权限，也会显式返回结果，表明用户是否有权访问。

当我们添加 Vista 支持时，我们使用的解决方法是对 HKLM 执行探测写入...，然后检查 HKCR\VirtualStore\Machine... 以获得相同的值，并注意如果找到该值，则虚拟化已发生。

Win7 似乎（再次）打破了这一点，因为针对显式虚拟位置 (HKCR) 的查询现在显示来自 HKLM 位置的合并结果，即使写入未虚拟化也是如此。

有没有人有任何解决这个问题的建议？

约束： - 我需要一个无需提升即可工作的解决方案（当我没有管理员级别的权限时，我将回退到 HKCU 中的每个用户配置，但我需要能够可靠地检测到这种情况）。

*   它需要与 v2 C# 应用程序一起使用（我在 C++ 代码中看到的一个选项是嵌入一个清单，该清单会禁用 .exe 的虚拟化，但我无法在 C# V2 中做到这一点，请参阅[禁用文件夹虚拟化在 windows 中](https://stackoverflow.com/questions/873676/disable-folder-virtualization-in-windows)） .

*   它需要在没有“安装程序”的情况下工作（这排除了我们需要通过 REG FLAGS... 命令禁用注册表项上的虚拟化的能力）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-08-24T13:06:57.517

这是一个很好的问题，+1（为什么它是社区 wiki，它值得加分！）

通常，有一组规则（[正如您遇到的]会随着时间而变化）控制 UAC [以及隐含的 Registry] 虚拟化是否在起作用。

[MSDN 中 Registry Virtualization 规则集文档的](http://msdn.microsoft.com/en-us/library/bb530198.aspx#vistaregvirt%5Ftopic6)一些重要部分是：

1.  [正如 jeffamaphone 所说]如果清单设置了请求特权/请求执行级别，则将其关闭。您似乎没有排除添加清单，所以您能否说明为什么这对您不起作用？（你说“我在 C# V2 中无法做到这一点”——有一个 Add Item 选项来添加应用程序清单文件，这在 VS2005 中可用）
2.  如果 exe 运行 64 位，则默认关闭
3.  如果它不是交互式进程（例如服务，或托管在 IIS 中等），则关闭

如果您无法影响上述任何一项，这是理想的，因此您想检测 UAC 虚拟化是否适用于当前上下文，[请将此答案用于最初可能不认为相关的内容问题](http://www.tech-archive.net/Archive/DotNet/microsoft.public.dotnet.languages.csharp/2007-06/msg00139.html)。（显然，您仍然需要决定它是否适用于您正在操作的特定键，这是一个移动目标，您显然不想实现需要跟踪更改的代码，如果可以避免的话 - 但在大多数情况下应该比较清楚。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T17:07:27.377

根据[此](http://msdn.microsoft.com/en-us/library/bb530198.aspx#vistaregvirt_topic6)，您可以基于每个键启用/禁用虚拟化，但它会告诉您使用命令行工具。但是必须有一种方法可以以编程方式进行。

通过在清单中设置 requestedExecutionLevel 来完全关闭应用程序中的虚拟化可能是最简单的。您可以尝试highestAvailable，但这可能意味着您的应用程序始终以管理员身份运行。这似乎意味着将其设置为 asInvoker 将关闭虚拟化。另请[参阅](http://msdn.microsoft.com/en-us/library/bb756929.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T03:54:32.680

请注意，这`HKCR`是一个虚拟化商店本身，是`HKLM\Software\Classes`和的组合`HKCU\Software\Classes`。

最好的方法是甚至不让注册表虚拟化发生。首先检查用户是否在运行时被提升，然后您可以通知用户更改将仅应用于当前用户，甚至在他们开始进行更改之前。

通过首先检测您是否是高级管理员，您可以简单地避免在将要进行虚拟化时写入 HKLM。

例子：

```
private bool IsAdministrator
{
    get
    {
        WindowsIdentity wi = WindowsIdentity.GetCurrent();
        WindowsPrincipal wp = new WindowsPrincipal(wi);

        return wp.IsInRole(WindowsBuiltInRole.Administrator);
    }
} 
```

**注意：**我不在 C# 中编写代码，示例来自问题[如何检测我的进程是否正在运行 UAC 提升？](https://stackoverflow.com/questions/95912/how-can-i-detect-if-my-process-is-running-uac-elevated-or-not)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-21T10:59:06.503

我遇到了类似的问题，并且清单的引入解决了它。

当以标准用户身份运行时，我依靠注册表安全性来防止（Win32）应用程序在 HKLM/Software/Wow6432Node 中创建密钥，并且很惊讶地看到它无论如何都成功了，但是没有密钥存在并且它是而是在这个新的 VirtualStore 区域下创建。

当发现 PE 清单包含与安全相关的信息时，注册表虚拟化将关闭。为了不需要提升权限，我的清单包含以下节点：

```
<trustInfo xmlns:ms_asmv2="urn:schemas-microsoft-com:asm.v2">
   <security>
      <requestedPrivileges>
         <requestedExecutionLevel level="asInvoker">
         </requestedExecutionLevel>
      </requestedPrivileges>
   </security>
</trustInfo> 
```

为了使可执行文件与 Vista 和 XP 兼容，显然 TrustInfo 部分中的每个节点都必须包含命名空间：

```
<ms_asmv2:trustInfo xmlns:ms_asmv2="urn:schemas-microsoft-com:asm.v2">
   <ms_asmv2:security>
      <ms_asmv2:requestedPrivileges>
         <ms_asmv2:requestedExecutionLevel level="asInvoker">
         </ms_asmv2:requestedExecutionLevel>
      </ms_asmv2:requestedPrivileges>
   </ms_asmv2:security>
</ms_asmv2:trustInfo> 
```

一旦清单正确嵌入到我的 .exe 中（通过修改项目的适当属性，我进行了几次尝试），该程序终于如我所料地失败了。

对于托管代码，可以通过运行 mt.exe 工具将清单作为构建后步骤包含在内。例如，如[MSDN 文章中所述](http://msdn.microsoft.com/en-us/library/bb756929.aspx)

```
mt.exe –manifest YourFile.manifest –outputresource:YourApp.exe;#1 
```

我更喜欢使用清单方法，而不是使用 reg.exe 修改注册表节点的标志，如[本文所述](http://msdn.microsoft.com/en-us/library/windows/desktop/aa965884%28v=vs.85%29.aspx)，因为这使所有机器上的行为保持一致。

希望对您有所帮助（即使在阅读了原始帖子的日期之后，我很确定问题早就解决了！！）

阿尔贝托

# sharepoint - Sharepoint 弹出登录窗口

> ID：1002716
> 
> 赞同：11
> 
> 时间：2009-06-16T16:55:32.223
> 
> 标签：sharepoint, login, popup

登录到我的 sharepoint 网站后，每次从库中访问文档时都必须登录。有没有办法来解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-12-04T07:23:00.090

用户等级：

如果您的 SharePoint 网站在访问时总是提示输入用户名/密码，您可以将浏览器设置为不提示

1.  在 Internet Explorer 中，转到工具
2.  单击 Internet 选项
3.  将您的站点 URL 添加到 Internet Explorer 的“本地 Intranet 站点”部分。
4.  打开安全选项卡
5.  单击自定义级别按钮
6.  向下滚动到此屏幕并选择“使用当前用户名和密码自动登录”单选按钮
7.  单击确定。

管理员级别：

您可以在**管理中心>操作站点的****备用访问映射**部分中添加站点的内部区域 URL ，SharePoint 服务器始终不会提示输入用户名/密码，您可以享受。

 *** * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-02T07:30:41.223

使用 Windows Vista 或 Windows 7 时，办公工具（例如 Word）不会查看 Internet Explorer 的本地 Intranet 列表。但他们会查看以下注册表位置：

**HKEY__LOCAL__MACHINE\SYSTEM\CurrentControlSet\Services\WebClient\Parameters\AuthForwardServerList**

如果您的 sharepoint 站点位于 share.myserver.com，您可以将上述注册表项设置为***.myserver.com**（包括 *），以便所有以 myserver.com 结尾的地址都受到办公应用程序的信任。这将防止出现登录弹出框。

有关详细信息，请参阅[此 Microsoft 文章](http://support.microsoft.com/default.aspx/kb/943280)。它为我解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T17:04:01.950

在 Internet 选项中将 SharePoint 网站添加到受信任的网站或本地 Intranet。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T19:55:58.327

This is to do with the way Word does the request for a file It sends an anonymous request first. What solves this is setting the session cookie to be valid for a year.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T08:29:26.367

我每天都在经历这个。我的本地计算机与 SharePoint 服务器位于不同的域中，因此每次我使用不同的应用程序访问 SharePoint 时都必须登录。这包括 IE、Word、InfoPath 等...

我发现没有办法避免它，因为它只是使用 Windows 身份验证的一部分。保存密码会有所帮助，但仍会显示一个对话框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T05:43:23.793

您是否使用 AD 进行身份验证？您是从托管它的同一网络还是在不同的 N/W 上浏览该站点？

如果在相同的新作品“在 Internet 选项中将 SharePoint 站点添加到您的受信任站点或本地 Intranet”中，并在受信任站点安全自定义级别、用户身份验证部分中选择选项自动使用当前用户名和密码登录。

如果您正在从不同的 n/w 浏览，则很难获得它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T13:24:52.977

有很多事情可能会导致这种情况，您在 Q 中没有提供太多关于您的设置的详细信息来给您答案，但是......

我找到的用于解决此问题的最全面的文章是

[不需要的身份验证提示](http://blogs.msdn.com/danielmcpherson/archive/2006/02/16/533605.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-22T09:36:13.540

这个问题对我来说很熟悉，我以前使用过该问题的upvoted 解决方案。但是，最近我发现使用 Google Chrome 而不是 Internet Explorer 可以解决这个问题！

解决方案：使用 Chrome。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-09-13T15:14:32.083

切换到基本身份验证将解决此问题，但需要以明文形式传递凭据。**

# asp.net - 使用 Logging Application Block 写入调试信息

> ID：1002717
> 
> 赞同：1
> 
> 时间：2009-06-16T16:55:33.737
> 
> 标签：asp.net, logging, enterprise-library

我在我的 ASP.NET 应用程序中使用日志记录应用程序块 (LAB) 以及异常处理应用程序块来记录任何未处理的异常。我正在使用 Global.asax 中的 Application_Error 方法来捕获这些错误。我正在写一个滚动平面文件。这一切都很好。

当我在 web.config 的 appSettings 部分设置开关时，我还想使用 LAB 记录调试消息。但我不知道如何将这些调试消息发送到**不同**的日志文件。如果有人能查看我的代码和 web.config 中的部分并查看是否有任何问题，我将不胜感激。谢谢！

这是我当前尝试写入调试记录器的示例：

```
private void LogDebugInfo()
{
    using (new Tracer("Debugging"))
    {
        StringBuilder msg = new StringBuilder();
        msg.AppendLine("Querystring: " + Request.QueryString.ToString());

        foreach (string item in Request.Form)
        {
            msg.AppendLine("Form item name: " + item + " value: " + Request.Form[item]);
        }

        HttpFileCollection files = Request.Files;
        foreach (string f in files)
        {
            msg.AppendLine("Posted filename: " + files[f].FileName + " type: " + files[f].ContentType + " length: " + files[f].ContentLength);
        }

        LogEntry log = new LogEntry();
        log.Message = msg.ToString();
        Logger.Write(log);
    }
} 
```

以下是 web.config 中的相关部分：

```
<loggingConfiguration name="Logging Application Block" tracingEnabled="true"
  defaultCategory="Data Access" logWarningsWhenNoCategoriesMatch="true">
    <listeners>
        <add fileName="log\Data Access.log" rollSizeKB="0" timeStampPattern="yyyy-MM-dd"
          rollFileExistsBehavior="Increment" rollInterval="Day" formatter="Text Formatter"
          header="----------------------------------------" footer="----------------------------------------"
          listenerDataType="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.RollingFlatFileTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=3.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
          traceOutputOptions="None" type="Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.RollingFlatFileTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=3.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
          name="Data Access TraceListener" />
        <add fileName="log\Debugging.log" rollSizeKB="0" timeStampPattern="yyyy-MM-dd"
          rollFileExistsBehavior="Increment" rollInterval="Day" formatter="Text Formatter"
          header="----------------------------------------" footer="----------------------------------------"
          listenerDataType="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.RollingFlatFileTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=3.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
          traceOutputOptions="None" type="Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.RollingFlatFileTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=3.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
          name="Debugging TraceListener" />
        <add fileName="log\General Exceptions.log" rollSizeKB="0" timeStampPattern="yyyy-MM-dd"
          rollFileExistsBehavior="Increment" rollInterval="Day" formatter="Text Formatter"
          header="----------------------------------------" footer="----------------------------------------"
          listenerDataType="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.RollingFlatFileTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=3.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
          traceOutputOptions="None" type="Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.RollingFlatFileTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=3.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
          name="Log TraceListener" />
    </listeners>
    <formatters>
        <add template="Timestamp: {timestamp}&#xA;Message: {message}&#xA;Category: {category}&#xA;Priority: {priority}&#xA;EventId: {eventid}&#xA;Severity: {severity}&#xA;Title:{title}&#xA;Machine: {machine}&#xA;Application Domain: {appDomain}&#xA;Process Id: {processId}&#xA;Process Name: {processName}&#xA;Win32 Thread Id: {win32ThreadId}&#xA;Thread Name: {threadName}&#xA;Extended Properties: {dictionary({key} - {value}&#xA;)}"
          type="Microsoft.Practices.EnterpriseLibrary.Logging.Formatters.TextFormatter, Microsoft.Practices.EnterpriseLibrary.Logging, Version=3.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
          name="Text Formatter" />
    </formatters>
    <categorySources>
        <add switchValue="All" name="Data Access">
            <listeners>
                <add name="Log TraceListener" />
            </listeners>
        </add>
        <add switchValue="All" name="Debugging">
            <listeners>
                <add name="Debugging TraceListener" />
            </listeners>
        </add>
        <add switchValue="All" name="General">
            <listeners>
                <add name="Log TraceListener" />
            </listeners>
        </add>
    </categorySources>
    <specialSources>
        <allEvents switchValue="All" name="All Events" />
        <notProcessed switchValue="All" name="Unprocessed Category" />
        <errors switchValue="All" name="Logging Errors &amp; Warnings">
            <listeners>
                <add name="Log TraceListener" />
            </listeners>
        </errors>
    </specialSources>
</loggingConfiguration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T19:50:37.587

我发现删除`using (new Tracer("Debugging"))`并添加`log.Categories.Add("Debugging");`到上述方法会产生预期的结果。

# .net - LINQ CompiledQuery.Compile 和动态排序？

> ID：1002718
> 
> 赞同：0
> 
> 时间：2009-06-16T16:55:51.473
> 
> 标签：.net, sql, linq

这是一个非常简短的问题，我担心答案也很简短。

有没有办法做任何事情

```
Func<DataContext, string, bool, IEnumerable<X> fnMyQuery = CompiledQuery.Compile<DataContext, string, bool IList<X>(
     (db, sortColumn, sortDesc) => (
          (!sortDesc)?
              db.OrderBy(x => DynamicResolve(sortColumn))
          :
              db.OrderByDescending(x => DynamicReolve(sortColumn))
      )); 
```

换句话说，我想创建一个编译的查询，它可以接受一列和一个排序顺序，然后以所需的方式对我的结果进行排序——我可以在不编译查询的情况下弄清楚如何做到这一点——但是是否可以使用 LINQ to SQL 编译查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-03T13:41:54.083

我知道解决这个问题的唯一方法是编译两个查询。每个排序顺序一个，然后用一个委托给正确编译查询的助手包装它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T02:16:19.557

CompiledQuery.Compile 的重点是生成一个完全翻译并准备就绪的方法来评估查询。

完全翻译。

当然，没有什么能阻止您在数据库之外进行排序（源代码可能是已编译的查询）。

```
public IList<T> SortedResults<T>(IEnumerable<T> source,
  string sortColumn, bool sortDesc)
{
  List<T> results = source.ToList();
  if (!sortDesc)
  {
    results = Enumerable
      .OrderBy(results, x => DynamicResolve(sortColumn))
      .ToList();
  }
  else
  {
    results = Enumerable
      .OrderByDescending(results, x => DynamicResolve(sortColumn))
      .ToList();
  }
  return results;

} 
```

# visual-studio - VS 插件：在 Web 应用程序上添加上下文按钮

> ID：1002719
> 
> 赞同：0
> 
> 时间：2009-06-16T16:55:53.830
> 
> 标签：visual-studio

我正在使用 Visual Studio (2008) 加载项。我希望能够向所有 Web 应用程序上下文菜单添加一个按钮（这将基于来自 Web 部署工具的共享存档为网站设置 IIS）。

我已经能够在项目上下文菜单上添加上下文项：

```
public void OnConnection(object application, ext_ConnectMode connectMode, object addInInst, ref Array custom) 
```

{ applicationObject = (DTE2)application; addInInstance = (AddIn)addInInst;

```
if (connectMode == ext_ConnectMode.ext_cm_UISetup) {
    var contextGuids = new Object[] {};
    var iisSetupCommand = applicationObject.Commands.AddNamedCommand(
        addInInstance,
        CommandNameSetupIis,
        "Setup IIS",
        "Create the bindings in IIS for the website. Requires an IIS folder in the project root with the archive xml files for the website.",
        true,
        52,
        ref contextGuids,
        (int) vsCommandStatus.vsCommandStatusSupported + (int) vsCommandStatus.vsCommandStatusEnabled
        );

    var commandBars = (CommandBars) applicationObject.CommandBars;
    var projectMenu = commandBars["Project"];
    iisSetupCommand.AddControl(projectMenu, projectMenu.Controls.Count + 1);
} 
```

}

这行得通，但我无法走得更远。

问题1是单击时按钮消失。

问题 2 是我不知道如何只显示 Web 应用程序项目的按钮。

问题 3 是我需要编写代码来获取 iis 存档、当前项目目录路径和项目名称以创建 IIS 绑定，然后使用这些设置运行 Web 部署工具。

这个插件的东西很钝。我已经尽可能多地搜索并阅读了大多数（糟糕的）msdn 文档。我找到的最好的信息是：[http ://dotnetslackers.com/articles/vs_addin/Lessons_learned_from_Copy_to_Html_Add_in.aspx](http://dotnetslackers.com/articles/vs_addin/Lessons_learned_from_Copy_to_Html_Add_in.aspx)

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:24:27.030

问题1：覆盖QueryStatus并将状态设置为vsCommandStatus.vsCommandStatusSupported | vsCommandStatus.vsCommandStatusEnabled

问题2：我认为这是不可能的。可以获取项目类型，但只有在单击按钮后（QueryStatus 似乎仅在单击按钮后触发）。

问题 3：项目路径可通过 connect.ApplicationObject.ActiveSolutionProjects 获得。

# wpf - 使用 {DynamicResource {x:Static LocalizableTexts.OpenTextKey}}

> ID：1002721
> 
> 赞同：0
> 
> 时间：2009-06-16T16:56:26.887
> 
> 标签：wpf, mvvm, localization

我一直在尝试提出比 LocBaml 更好的本地化方法（这很糟糕）。我虽然可以使用 {DynamicResource {x:Static LocalizableTexts.OpenTextKey}} 之类的东西（动态资源，因为我的语言可以在运行时改变）。唯一的问题是？如何正确创建 LocalizableTexts.OpenTextKey ？是否有教程可以教我如何创建自定义 RessourceKeys 以及如何在运行时更新它们？

顺便说一句，我生活在 MVVM 世界中......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T18:52:09.627

我认为您的组件资源键之后。

首先在 XAML 资源字典中定义您的资源，例如：

```
<local:OpenText x:Key="{ComponentResourceKey TypeInTargetAssembly={x:Type local:LocalizableTexts}, ResourceId=OpenText}" /> 
```

然后创建一个静态访问器类：

```
public static class LocalizableTexts
{
     public static ComponentResourceKey OpenTextKey
     {
        get { return new ComponentResourceKey(typeof(LocalizableTexts), "OpenText"); }
     }
} 
```

最后确保在使用静态绑定时指明 xml 命名空间：

```
{DynamicResource {x:Static local:LocalizableTexts.OpenTextKey}} 
```

# mysql - MySQL：仅当不在另一张表中时才从一张表中选择电子邮件？

> ID：1002728
> 
> 赞同：8
> 
> 时间：2009-06-16T16:57:25.717
> 
> 标签：mysql

我将构建一个名为 donotemail 的表，其中将包含要求从我们的电子邮件列表中删除的人员的电子邮件地址。我有另一个名为 users 的表，其中包含一个电子邮件列。如何选择来自用户的所有电子邮件，但前提是电子邮件地址不在 donotemail 表中？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-16T17:03:29.597

尝试

```
SELECT Email.address
FROM Email LEFT OUTER JOIN DoNotMail on Email.address = DoNotMail.address
WHERE DoNotMail.address is null 
```

它避免了需要子查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T16:59:40.533

```
 select u.email from users u where u.email not in (select email from donotemail) 
```

或者

~~从用户中选择 u.email u inner join donotemail d on u.email != d.email~~

**编辑：加入不起作用**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T17:00:32.360

试试这个：

```
SELECT email
FROM users u
WHERE NOT EXISTS(
    SELECT 1 FROM no_mail_users nmu
    WHERE nmu.id = u.id
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T17:01:12.560

为什么不直接在您的电子邮件表中添加另一列，标记为“活动”，当设置为 1 时，它当前正在发送电子邮件，而当设置为 0 时，它不再发送电子邮件，那么您可以根据该开关进行选择和过滤？

干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T17:00:22.030

```
select email from users where email not in (select email from donotemail) 
```

# microsoft-dynamics - Dynamics GP 10 表名

> ID：1002738
> 
> 赞同：1
> 
> 时间：2009-06-16T16:59:02.813
> 
> 标签：microsoft-dynamics, dynamics-gp

GP 10 的表名是否与 GP 9 完全相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:23:45.423

答案是：在大多数情况下，是的。[这](http://www.box.net/shared/jc90kdsh2k)是主表参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-17T18:04:56.503

这里有一个很好的表格参考：http: [//dyndeveloper.com/dynModule.aspx](http://dyndeveloper.com/dynModule.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-13T17:35:55.450

此外，如果您可以使用 Microsoft Dynamics GP 访问 customersource，您还可以下载 SDK，该 SDK 将为您提供所有版本更改，以及您可以使用的实体关系映射，以及用于解决任何数据库问题。

# c# - 多处理器系统中 volatile 关键字的成本是多少？

> ID：1002739
> 
> 赞同：12
> 
> 时间：2009-06-16T16:59:04.793
> 
> 标签：c#, multithreading, volatile

我们遇到了性能问题，一个潜在的罪魁祸首是集中使用 volatile 单例。具体代码的形式是

```
class foo {
  static volatile instance;
  static object l = new object();

  public static foo Instance {
    if (instance == null)
      lock(l) {
        if (instance == null)
          instance = new foo();
      }

    return foo();
  }
} 
```

这是在一个 8 路盒子上运行的，我们看到上下文切换到每秒 500,000 次。典型的系统资源很好 - 25% cpu util、25% memory util、低 IO、无分页等。

使用 volatile 字段会导致内存屏障或任何类型的 cpu 缓存重新加载吗？或者它只是每次都在主内存之后，只针对那个字段？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T17:06:09.093

`lock`确实会引起内存屏障，因此如果您总是在锁中访问实例，则不需要易失性。

根据[这个网站](http://dotnet.org.za/markn/archive/2008/10/21/net-memory-model-bytecode-reordering.aspx)：

> C# volatile 关键字实现了获取和释放语义，这意味着读取时的读取内存屏障和写入时的写入内存屏障。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T17:39:44.220

volatile 不会做的一件事是导致上下文切换。如果您看到每秒 500,000 次上下文切换，则意味着您的线程正在阻塞某些东西，而 volatile*不是*罪魁祸首。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T17:37:24.423

可悲的是，单身人士几乎对所有事情都说不好:)

这不是我的专业领域，但据我所知，除了编译器/运行时不为优化目的重新排序读/写（对变量）之外， volatile 没有什么特别之处。

编辑：我的立场是正确的。volatile 不仅会引入内存屏障，而且发生的事情（顺便说一下，性能）很大程度上取决于所涉及的特定 CPU。请参阅[http://dotnetframeworkplanet.blogspot.com/2008/11/volatile-field-and-memory-barrier-look.html](http://dotnetframeworkplanet.blogspot.com/2008/11/volatile-field-and-memory-barrier-look.html)

这就是为什么你仍然需要锁。

可能/可能尚未回答的问题：

1.  你的单例实例实际上在做什么？也许实例代码需要重构......
2.  正在运行的进程的线程数是多少？如果线程数异常高，8 路盒将无济于事。
3.  如果高于预期，为什么？
4.  系统上还在运行什么？
5.  性能问题是否一致？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T17:42:28.507

在您的示例中， volatile 不应成为任何“减速”的主题。然而，lock() 可能涉及到内核的大量往返，尤其是在对锁有很多争用的情况下。

在这种情况下，真的不需要锁定你的单例，你可以这样做

```
class Foo {
  static Foo instance = new Foo();
  public static Foo FooInstance() {
    return instance ;
  }
} 
```

当然，如果在许多不同的线程中使用了“instance”，你仍然需要 lock() 任何改变 Foo 的东西，除非 Foo 的所有方法/属性都是只读的。例如

```
 class Foo {
      static Foo instance = new Foo();
      object l = new object();
      int doesntChange = 42;
      int canChange = 123;
      public static Foo FooInstance() {
        return instance ;
      }
      public void Update(int newVal) {
         lock(l) { // you'll get a lot of trouble without this lock if several threads accesses the same FOO. Atleast if they later on read that variable 
            canChange = newVal;
         }

      public int GetFixedVal() {
         return doesntChange; //no need for a lock. the doesntChange is effectivly read only
      }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T17:56:45.020

真的没有必要对单例使用 volatile ，因为您只设置了一次 - 并锁定了设置它的代码。有关更多信息，请参阅[Jon Skeet 关于单例的文章。](http://www.yoda.arachsys.com/csharp/singleton.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-29T18:27:28.710

简短的回答是，是的，它创建了一个内存屏障（刷新所有内容并进入主内存，而不仅仅是那个单个变量），但不，它不会成为上下文切换的原因。

此外，正如其他人所提到的，我不认为 volatile 在这里是必要的。

# wpf - 为什么我的应用程序的窗口在我运行时不显示？

> ID：1002752
> 
> 赞同：2
> 
> 时间：2009-06-16T17:01:19.877
> 
> 标签：wpf, visual-studio-2008, debugging, visual-sourcesafe

在没有警告（或明显原因）的情况下，VS 2008 决定像往常一样进行调试，但我的应用程序窗口从未出现在屏幕上。我整个上午都在从 VS 运行我的应用程序，但我看不出我可能会改变什么，这会使我的窗口在下午不再出现。通常，如果 XAML 中有错误或我的代码有问题，VS 会告诉我一个致命的异常错误并自动关闭调试会话。但是现在 VS 似乎没有意识到任何问题，因为我可以看到我的应用程序在输出框中运行。

我已将整个输出框复制并粘贴到这篇文章中。有关我正在运行的应用程序的所有信息都在这里。

请注意底部熟悉的行：“程序 '[328] UI.vshost.exe: Managed' has exited with code 0 (0x0).” 在我通过单击“停止”按钮手动关闭调试会话之前，该行不会出现。在那之前，该应用程序似乎正在运行，没有任何重大错误或问题。

我看到了一些可能的危险信号：首先，System.Deployment.dll 底部附近的第一次机会异常——我不知道这意味着什么，我怀疑它是否相关。

其次，在我的应用程序完成加载之前，有两个线程因未知原因退出。再说一次，我不认为这是不寻常的。我只是注意到了。

第三，我的应用程序加载“PresentationFramework.Classic.dll”。经典的？那有什么意思？而与什么相反？我的应用程序不应该使用 WPF 的“经典”版本吗？这对我来说似乎很奇怪......</p>

第四，它将我的应用程序命名为“UI.vshost.exe”。我的应用程序的可执行文件是“UI.exe”——我不记得在过去的任何版本的 VS 中都曾在可执行文件的文件名上看到过“vshost”。我已经确认“vshost”出现在发布模式和调试模式的输出窗口中。重新启动我的电脑没有任何效果。删除 bin 和 obj 文件夹并重建没有效果。我检查了项目文件夹中的“bin”目录。它包含两个可执行文件： UI.exe 和 UI.vshost.exe UI.exe 为 76KB UI.vshost.exe 为 14KB 双击文件并手动运行它们没有任何效果。没有窗口出现。

最后，在第八行（不考虑换行）UI.vshost.exe 声称自己基本上已经“加载”了，就像它是引用自身的 dll 或其他东西一样。再次，这引起了人们的注意。

此外，我正在使用 Visual Source Safe 进行源代码控制。我听说 VSS 从行业的角度来看有些不可靠，而且众所周知，它过去曾破坏过项目。这可能是罪魁祸首吗？

当然，我不是所有这些东西意味着什么的专家——否则我可能不需要在 StackOverflow 上发布它。

如果你看到我可能遗漏的任何东西，请告诉我……</p>

```
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089\mscorlib.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities\9.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Windows.Forms\2.0.0.0__b77a5c561934e089\System.Windows.Forms.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System\2.0.0.0__b77a5c561934e089\System.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Drawing\2.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.HostingProcess.Utilities.Sync\9.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.HostingProcess.Utilities.Sync.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\Microsoft.VisualStudio.Debugger.Runtime\9.0.0.0__b03f5f7f11d50a3a\Microsoft.VisualStudio.Debugger.Runtime.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Users\hamilton.hollberg\Documents\Visual Studio 2008\Projects\AllSparkAdminTool\AllSparkAdminTool\bin\Debug\UI.vshost.exe'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Core\3.5.0.0__b77a5c561934e089\System.Core.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Xml.Linq\3.5.0.0__b77a5c561934e089\System.Xml.Linq.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Data.DataSetExtensions\3.5.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_32\System.Data\2.0.0.0__b77a5c561934e089\System.Data.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Xml\2.0.0.0__b77a5c561934e089\System.Xml.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\UIAutomationProvider\3.0.0.0__31bf3856ad364e35\UIAutomationProvider.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\WindowsBase\3.0.0.0__31bf3856ad364e35\WindowsBase.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_32\PresentationCore\3.0.0.0__31bf3856ad364e35\PresentationCore.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\PresentationFramework\3.0.0.0__31bf3856ad364e35\PresentationFramework.dll'
The thread 0xbc0 has exited with code 0 (0x0).
The thread 0xd78 has exited with code 0 (0x0).
'UI.vshost.exe' (Managed): Loaded 'C:\Users\hamilton.hollberg\Documents\Visual Studio 2008\Projects\AllSparkAdminTool\AllSparkAdminTool\bin\Debug\UI.exe', Symbols loaded.
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Configuration\2.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll'
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\System.Deployment\2.0.0.0__b03f5f7f11d50a3a\System.Deployment.dll'
A first chance exception of type 'System.Deployment.Application.InvalidDeploymentException' occurred in System.Deployment.dll
'UI.vshost.exe' (Managed): Loaded 'C:\Windows\assembly\GAC_MSIL\PresentationFramework.Classic\3.0.0.0__31bf3856ad364e35\PresentationFramework.Classic.dll'
The program '[2704] UI.vshost.exe: Managed' has exited with code 0 (0x0). 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T18:53:24.337

```
public MainWindow()
{
    InitializeComponent();
} 
```

我已经确认在调用`InitializeComponent`. 这可能是一个绑定问题。在这一点上，我必须开始注释掉 XAML 行，直到找到源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T17:04:06.320

所有“vshost”都意味着您的应用程序是从 Visual Studio 中运行的。

如果您直接运行应用程序，则名称将不包含此名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T17:04:52.403

我知道这听起来很傻，但是您尝试过重新启动吗？我让 VS 2008 做了一些奇怪的事情，只是在重新启动后才能恢复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T17:38:50.600

好吧，这就是 MS 对[Deployment Exception](http://msdn.microsoft.com/en-us/library/system.deployment.application.invaliddeploymentexception.aspx "部署异常")的看法。听起来这可能是我的问题。我还想知道您是否不小心将配置从“调试”更改为“部署”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-29T19:39:12.143

我有同样的问题。就我而言，解决方案更简单。在搜索了互联网并尝试了一堆东西之后，解决方法是重新启动我的电脑。我看过其他有这个问题的人的帖子，重启对他们不起作用，但对我有用。

# algorithm - 按距离搜索地理编码信息

> ID：1002759
> 
> 赞同：3
> 
> 时间：2009-06-16T17:03:32.933
> 
> 标签：algorithm, search, geocoding

我有一个地址数据库，所有地址都经过地理编码。

在给定 lat、lng 的某个半径内查找我们数据库中所有地址的最佳方法是什么？

换句话说，用户输入 (lat, lng) 一个位置，我们从我们的数据库中返回在给定位置 10、20、50 等英里范围内的所有记录。

它不必非常精确。

我使用 MySQL DB 作为后端。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T17:43:48.317

MySQL 5 有可用的空间扩展 - 文档的入口页面在这里：

[http://dev.mysql.com/doc/refman/5.0/en/spatial-extensions.html](http://dev.mysql.com/doc/refman/5.0/en/spatial-extensions.html)

有很多关于如何完成您所要求的细节，具体取决于您的空间数据在数据库中的表示方式。

另一种选择是使用已经提到的 Haversine 公式创建一个计算距离的函数。它背后的数学可以在这里找到：

www.movable-type.co.uk/scripts/latlong.html

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T17:07:30.713

您没有提及您的数据库，但在 SQL Server 2008 中，当您使用地理数据类型时，它就像这样简单

这将找到距离邮政编码 10028 20 英里内的所有邮政编码

```
SELECT h.*
FROM zipcodes g
JOIN zipcodes h ON g.zipcode <> h.zipcode
AND g.zipcode = '10028'
AND h.zipcode <> '10028'
WHERE g.GeogCol1.STDistance(h.GeogCol1)<=(20 * 1609.344) 
```

另请参阅此处[SQL Server 2008 Proximity Search With The Geography Data Type](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-2008-proximity-search-with-th)

SQL Server 2000 版本在这里：S [QL Server 邮政编码纬度/经度接近距离搜索](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-zipcode-latitude-longitude-pr)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T17:06:20.543

这是一个典型的空间搜索问题。

1> 你在使用什么数据库，sql2008、oracle、ESRI 地理数据库和 postgis 是一些具有此功能的空间数据库引擎。2> 否则，如果你想实现这一点，你可能会寻找一些空间算法库。您可以自己编写代码，但我不会建议，因为计算几何是一个复杂的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T17:07:22.400

如果您使用的是支持空间类型的数据库，则可以直接构建查询，数据库将处理它。PostgreSQL、Oracle 和最新的 MS SQL 都支持这一点，其他一些也是如此。

如果不是，并且精度不是问题，您可以在框中进行搜索而不是按半径进行搜索，因为这会非常快。否则，事情会变得复杂，因为从经纬度 -> 距离的实际转换需要在投影空间中发生（因为距离在地球的不同区域发生变化），并且生活变得相当糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T17:06:52.713

我不记得我脑海中浮现的方程式，但Haversine公式是用来计算地球上两点之间的距离的。你可以谷歌这个方程，看看它是否能给你任何想法。抱歉，我知道这没有多大帮助，但也许它会给你一个开始的地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T18:07:11.960

如果它不必非常准确，并且我假设您的表中有一个 x 和 y 列，那么只需选择一个大边界矩形中的所有行，并使用 pythagorus（或 Haversine）来修剪结果角落。

例如。选择 * 从位置（x 在 xpos-10 英里和 xpos+10 英里之间）和（y 在 xpos -10 英里和 ypos+10 英里之间）。

记住毕达哥拉斯是 sqrt(x_dist^2 + y_dist^2)。

它快速简单，易于理解，不需要有趣的连接。

# database - 与关系数据库交互的设计模式？

> ID：1002766
> 
> 赞同：2
> 
> 时间：2009-06-16T17:04:53.103
> 
> 标签：database, language-agnostic, design-patterns

有谁知道与关系数据库交互的任何设计模式？例如，在您的方法中内联 SQL 更好，还是实例化一个您传递数据并构建 SQL 语句的 SQL 对象？您是否有一个静态方法来返回连接字符串，并且每个方法只是获取该字符串并连接到数据库，执行其操作，然后根据需要断开连接，或者您是否有其他负责连接、执行、断开连接等的结构?

换句话说，假设数据库已经存在，OO 应用程序与之交互的最佳方式是什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T17:32:10.903

我推荐Martin Fowler[的《企业应用程序架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)》一书，以全面回顾这些问题的最常见答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T17:13:12.050

您可以使用几种模式：

*   [存储库模式](https://web.archive.org/web/20110503184234/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/10/08/the-repository-pattern.aspx)
*   [活动记录模式](http://en.wikipedia.org/wiki/Active_record_pattern)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T17:12:55.670

我个人讨厌在没有 ORM 的情况下使用数据库。NHibernate 更可取，但 iBatis 也是现有数据库的一个选项（并不是说 NH 无法处理现有数据库）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T17:10:06.390

您通过谷歌搜索 DAL 识别的所有内容都描述了一种设计模式。仿佛站在森林中央，想看一棵树。有几十个，如果不是几千个。

[这是我正在阅读的一本书](http://www.springerlink.com/content/kg3216v2014r00u0/)的引述，以寻找资源。

> ...如果不讨论构建持久层的模式和最佳实践，就不可能讨论 ORM。话又说回来，要讨论 ORM 模式也不可能不提到业内大师，即 Martin Fowler、Eric Evans、Jimmy Nilsson、Erich Gamma、Richard Helm、Ralph Johnson 和 John Vlissides，其中后四位是众所周知的在行业中作为四人帮 (GoF)。本章的目的是解释和扩展这些大师创建的一些模式，并使用每个开发人员都能理解的语言提供具体示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T17:13:06.060

一般来说，面向对象应用程序与关系数据库交互的最佳方式是通过 ORM。虽然这本身不是一种设计模式，但它是一种具有特定使用模式的工具，所以它足够相似。对象关系映射 (ORM) 工具提供数据库和内存中的一组对象之间的映射；通常，这些工具提供了管理会话、连接和事务等事物的方法。运行良好的 ORM 的一个很好的例子是 Hibernate（.NET 上的 NHibernate）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T17:28:30.240

根据我的经验，最好根本没有 SQL 语句（大多数 ORM 都允许这样做），最好不要对连接细节（连接字符串等）有任何了解。如果您可以与任何主要的数据库供应商一起使用完全相同的代码，那就更好了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T17:33:36.130

如果您打算自己动手， [POEAA在这个问题上拥有丰富的知识。](https://rads.stackoverflow.com/amzn/click/com/0321127420)

# bash - 如何将所有杂乱无章的文件复制到一个目录中？（在 Linux 上）

> ID：1002768
> 
> 赞同：1
> 
> 时间：2009-06-16T17:05:14.117
> 
> 标签：bash, shell

我在一个复杂的文件夹结构中有数千个 mp3，它位于一个文件夹中。我想将所有 mp3 移动到没有子文件夹的单个目录中。我可以想到使用该`find`命令的多种方法，但一个问题是文件名重复。我不想替换文件，因为我经常有同一首歌的多个版本。自动重命名是最好的。我真的不在乎文件是如何重命名的。

有谁知道这样做的简单而安全的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T17:19:40.717

您可以在复制后更改`a/b/c.mp3`路径。`a - b - c.mp3`这是 Bash 中的一个解决方案：

```
find srcdir -name '*.mp3' -printf '%P\n' |
    读我的时候；做
        j="${i//\// - }"
        cp -v "srcdir/$i" "dstdir/$j"
    完毕

```

`${//}`在没有替换的外壳中：

```
find srcdir -name '*.mp3' -printf '%P\n' |
    sed -e 'p;s:/: - :g' |
    读我的时候；做
        读 j
        cp -v "srcdir/$i" "dstdir/$j"
    完毕

```

对于不同的方案，GNU`cp`可以`mv`进行编号备份而不是覆盖——参见手册页中的`-b`/ `--backup[=CONTROL]`。

```
find srcdir -name '*.mp3' -exec cp -v --backup=numbered {} dstdir/ \;

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T17:11:25.283

bash 像伪代码：

```
for i in `find . -name "*.mp3"`; do
    NEW_NAME = `basename $i`
    X=0
    while ! -f move_to_dir/$NEW_NAME
        NEW_NAME = $NEW_NAME + incr $X

    mv $i $NEW_NAME
done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T17:18:50.907

```
#!/bin/bash
NEW_DIR=/tmp/new/

IFS="
"; for a in `find . -type f `
    do
    echo "$a"
    new_name="`basename $a`"
    while test -e "$NEW_DIR/$new_name"
            do
            new_name="${new_name}_"
            done
    cp "$a" "$NEW_DIR/$new_name"
    done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T17:09:37.903

我倾向于在一个简单的脚本中执行此操作，而不是尝试适应单个命令行。

例如，在 python 中，通过目录执行 walk() 相对简单，将找到的每个 mp3 文件复制到具有自动递增数字的不同目录。

如果你想变得更漂亮，你可以有一个现有文件名的字典，然后简单地在重复项上附加一个数字。（字典的索引是文件名，值是到目前为止找到的文件数，这将成为您的后缀）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T17:10:04.863

```
find /path/to/mp3s -name *.mp3 -exec mv \{\} /path/to/target/dir \; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T17:11:22.367

冒着许多反对票的风险，可以在短时间内编写一个 perl 脚本来完成此操作。

伪代码：

```
while (-e filename)
     change filename to filename . "1"; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-16T17:39:07.463

在 python 中：要实际移动文件，请更改 debug=False

```
import os, re
from_dir="/from/dir"
to_dir = "/target/dir"
re_ext = "\.mp3"
debug = True

w = os.walk(from_dir)
n = w.next()
while n:
    d, arg, names = n
    names = filter(lambda fn: re.match(".*(%s)$"%re_ext, fn, re.I) , names)
    n = w.next()
    for fn in names:
        from_fn     = os.path.join(d,fn)
        target_fn   = os.path.join(to_dir, fn)
        file_exists = os.path.exists(target_fn)
        if not debug:
            if not file_exists:
                os.rename(from_fn, target_fn)
            else:
                print "DO NOT MOVE - FILE EXISTS ", from_fn
        else:
            print "MOVE ", from_fn, " TO " , target_fn 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-29T20:08:44.720

由于您不关心重复文件的命名方式，因此请在移动时使用“备份”选项：

```
find /path/to/mp3s -name *.mp3 -exec mv --backup=numbered {} /path/to/target/dir \; 
```

会给你：

*   歌曲.mp3
*   歌曲.mp3.~1~
*   歌曲.mp3.~2~

# sql-server - 如何将 App_Data 中的 mdf 与共享主机一起使用

> ID：1002779
> 
> 赞同：2
> 
> 时间：2009-06-16T17:07:15.457
> 
> 标签：sql-server, mdf, app-data, datadirectory

如果我创建一个使用 App_Data 中的 mdf 和连接字符串的网站：

> `Server=.\SQLExpress;AttachDbFilename=|DataDirectory|mydbfile.mdf;Database=dbname; Trusted_Connection=Yes;`

我需要做什么才能在共享托管环境中运行该站点？我是否需要将 mdf 的内容复制到主机的主 SQL Server 引擎？有没有办法使用我的主机的非 SQLExpress 引擎并且仍然将我的 mdf 保留在我的 App_Data 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:09:27.500

您的虚拟主机应该有这方面的文档。 [Gearhost.com](http://gearhost.com)是我的虚拟主机，他们确实如此。

如果您的虚拟主机没有这方面的文档，请给他们发送电子邮件，然后找到一个新的虚拟主机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T02:08:46.207

Mdf 文件仅适用于 SQL Server 引擎（Express 或完整版本）。您使用的提供程序需要提供对 SQL Server 引擎的访问权限。正如 Gortok 所说，很大程度上取决于提供者。有关详细信息，请参阅他们的文档。

# c# - 存储过程返回多个记录集

> ID：1002783
> 
> 赞同：1
> 
> 时间：2009-06-16T17:07:55.893
> 
> 标签：c#, web-applications, multiple-resultsets

我对 c# 很陌生。我有一个需要多个记录集的页面，以及一个返回它们的存储过程。我正在对主记录集使用中继器控件。如何到达下一个返回的记录集？

* * *

好的，所以数据源在 aspx 页面中。我会把它移到页面后面的代码来使用 NextResult 对吗？这是我现在的代码。如何将数据源移动到代码隐藏，实现数据读取器以便我可以使用 nextresult？

```
<asp:SqlDataSource ID="AssetMgtSearch" runat="server" 
                ConnectionString="<%$ ConnectionStrings:OperationConnectionString %>" 
                SelectCommand="spAssetMgtItemList" SelectCommandType="StoredProcedure">
            </asp:SqlDataSource>
            <div class="contentListFullHeight">
                <table cellspacing="0" cellpadding="0" border="0" class="contentList">
                    <tr>
                        <th>ShipmentID/</td>
                        <th>MaterialID/</td>
                        <th>ItemID/</td>
                    </tr>
                    <asp:Repeater ID="Repeater1" runat="server" DataSourceID="AssetMgtSearch">
                        <ItemTemplate> 
                            <tr>
                                <td colspan="3" style="border-top:solid thin blue">&nbsp;</td>
                            </tr>
                            <tr>
                                <td><%#Container.DataItem(0)%></td>
                                <td><%#Container.DataItem(1)%></td>
                                <td><%#Container.DataItem(2)%></td>
                            </tr>
                        </ItemTemplate>                           
                    </asp:Repeater>
                </table> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T17:12:13.330

在阅读器上调用 NextResult() 方法以移动到下一个结果。

不，您不能使用 SqlDataSource 执行此操作，您需要使用代码隐藏或将过程分解为单独的查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:19:05.387

谢谢大家的回答。NextResult() 工作得很好，前提是您从创建拖放控件开始进行了很多更改。他们来了。

1.  从 aspx 页面中删除数据源
2.  从 Repeater 控件中删除 DataSourceID 属性
3.  在您的代码隐藏中创建一个返回数据读取器对象的函数。例如 AstMgtDr()
4.  在您的页面加载中，为 Repeater 控件设置数据源和数据绑定属性

    `Repeater1.DataSource = AstMgtDr();`

    `Repeater1.DataBind();`

5.  在您的 aspx 页面顶部，添加一个页面级指令以使用“System.Data.Common”命名空间 `<%@ Import namespace="System.Data.Common" %>`

6.  要显示您的数据：

> 这是性能最好的方法，但它需要显式输入

```
`<%#((DbDataRecord)Container.DataItem).GetInt32(0)%>` 
```

> 这是另一种使用字段名称的方法 - 比以前的方法更昂贵，但比默认的 Eval 更快。

```
`<%# ((DbDataRecord)Container.DataItem)["ShipmentID"] %>` 
```

希望这可以节省其他人一些时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-04T21:51:22.400

这个问题已经看过很多次了，我只是想提交我自己的解决方案。
我知道最初的问题是 c#，但我支持遗留系统并且很容易转换代码。

这是今天给我的。我需要一种快速而简单的方法来显示来自返回 7 个不同数据集的存储过程的结果。

我通过用我的存储过程结果填充 System.Data.DataSet 来解决这个问题。然后动态创建 DataGrid，并将它们添加到 PlaceHolder。

HTML 代码：

```
<html>
  <body>
  <form id="form1" runat="server">
    <asp:PlaceHolder ID="phMetrics" runat="server"/>
  </form>
  </body>
</html> 
```

VB.NET 代码：

```
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    Dim ds As System.Data.DataSet = Me.GetMetrics()
    If ds IsNot Nothing Then
        For i As Integer = 0 To ds.Tables.Count - 1
            Dim _rpt As New System.Web.UI.WebControls.DataGrid()
            With _rpt
                .AutoGenerateColumns = True
                .Attributes.Add("name", "table_" & i + 1)
                .DataSource = ds.Tables(i)
                .DataBind()
            End With
            Me.phMetrics.Controls.Add(_rpt)
        Next
    End If
End Sub

Private Function GetMetrics() As System.Data.DataSet
    Dim dsMetrics As New System.Data.DataSet

    Using _sqlConn As New System.Data.SqlClient.SqlConnection(_sqlConnString)
        _sqlConn.Open()
        Dim _SqlCommand As New System.Data.SqlClient.SqlCommand("[dbo].[My_Stored_Procedure]", _sqlConn)
        With _SqlCommand
            .CommandType = System.Data.CommandType.StoredProcedure
            .Parameters.Add(New System.Data.SqlClient.SqlParameter("@ClientID", 101))
        End With
        Dim _sqlAdapter As New System.Data.SqlClient.SqlDataAdapter(_SqlCommand)
        With _sqlAdapter
            .Fill(dsMetrics)
            .Dispose()
        End With
        _sqlConn.Close()
        _sqlConn.Dispose()
    End Using

    Return dsMetrics
End Function 
```

# php - 如何从 VB 代码调用帖子到页面上的 iframe？

> ID：1002804
> 
> 赞同：0
> 
> 时间：2009-06-16T17:11:31.927
> 
> 标签：php, asp.net, vb.net, forms, httpwebrequest

我已经编写了将信息发布到页面的代码，但是我不知道如何使帖子以我放置在页面上的 iframe 为目标。（我没有测试过这段代码，所以我不确定这个帖子是否有效）

```
 Dim param1, param2, result, url As String
    Dim request As HttpWebRequest
    Dim paramStream() As Byte
    Dim requestResponse As WebResponse

    param1= "name=" + Server.UrlEncode("My Name")
    param2= "email=" + Server.UrlEncode("email@mail.com")
    paramStream = Encoding.ASCII.GetBytes(param1+ "&" + param2)
    url = "https://www.mysite.com/dosomething.php"

    request = WebRequest.Create(url)
    request.Method = "POST"
    request.ContentType = "application/x-www-form-urlencoded"
    request.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 6.0; sv-SE; rv:1.9.1b2) Gecko/20081201 Firefox/3.1b2"
    request.ContentLength = paramStream.Length

    Using stream = request.GetRequestStream()
        stream.Write(paramStream, 0, paramStream.Length)
    End Using

    requestResponse = request.GetResponse()

    Using sr = New StreamReader(requestResponse.GetResponseStream())
        result = sr.ReadToEnd()
    End Using 
```

那是我写的要发布到网站上的内容，但是我希望帖子能够影响我放置在页面上的 iframe。我知道当您编写 html 时，您可以在表单标签中指定一个目标

```
<form target="my_iframe" method="post" action="dosomething.php" /> 
```

但我不确定是否有一个类似于我可以从 VB 代码中指定的目标。

**请注意：**我正在尝试从 ASP.NET 页面发布到包含在 iframe 中的 PHP 页面。

我还没有测试过这甚至可以发布，如果您在我的代码中看到任何需要修复的内容，或者对如何以不同的方式执行此操作有任何建议，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-22T20:23:34.013

当您使用 HttpWebRequest 进行屏幕抓取时，您是在 HTTP 层工作，位于浏览器关注的 HTML 层之下。HTTP 不知道也不关心框架或任何其他分层的 HTML 元素。HTTP 只是将请求发送到 URL 并获取响应。因此，您只需将 POST 请求发送到 IFRAME 的 URL。通常该 URL 存在于 IFrame 中的事实对您的 VB 代码应该无关紧要。

# sharepoint - 共享点权限问题 - “拒绝访问”

> ID：1002812
> 
> 赞同：2
> 
> 时间：2009-06-16T17:13:15.610
> 
> 标签：sharepoint, permissions

我正在尝试在我的开发环境中复制生产问题，但遇到了权限问题，其中“贡献者”组中的用户收到拒绝访问错误。此外，如果我将此用户设置为网站集管理员，他仍然会收到相同的访问被拒绝错误。

为什么会这样？我该如何解决？

更新：当我在开发环境中从我的虚拟机内部登录时，我没有遇到问题。问题一定是我的开发环境是它自己的域。那么问题就变成了，如何从不在域中的机器登录？如果可能，我想避免扩展 Web 应用程序。

更新2：顺便说一句，当我使用的凭据是“系统帐户”时，我可以从我的主机操作系统登录网站。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T21:02:25.400

Troubleshooting Access Denied errors is something that plagues me daily... so I feel your pain.

I am assuming this user is trying to access some page in SharePoint. From my experience, if even one Web Part on the page is accessing something the user does not have access to, the entire Access Denied page is shown.

One way to troubleshoot access to the SITE (not the page) is by visiting the "All Site Content" page: /_layouts/viewlsts.aspx. If they can get to this page, then it is something wrong with the page and not the site.

Next I would try exporting and then DELETING (not closing) webparts from the page to determine which one is causing the problem. Since you have a dev environment, I assume you could do another restore if things get too mucked up.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T17:37:13.910

他们什么时候收到拒绝访问错误？打网站？

您确定要添加到组的用户与您登录的用户相同吗？有时，如果您有多个用户商店，您可以将不同的用户添加到组中：DOMAIN\joe.user、forms:joe.user、someotheraccountstore:joe.user 等。

# servlets - 如何从注册在 OSGi HttpService 中的 Servlet 获取 OSGi 服务引用？

> ID：1002813
> 
> 赞同：4
> 
> 时间：2009-06-16T17:13:19.883
> 
> 标签：servlets, dependency-injection, osgi, service-reference

在 OSGi 环境中运行的 HttpServlet（即在 OSGi [HttpService](http://www.osgi.org/javadoc/r4v41/org/osgi/service/http/HttpService.html)中注册）会想要调用一些 OSGi 服务来完成它的任务似乎很自然。问题是如何在 servlet 中获取对这些 OSGi 服务的引用。

一种方法是将依赖项注入到注册到 OSGi HttpService 的 HttpServlet 实例中，如下所示：

```
MyServlet servlet = new MyServlet();
servlet.setFooService(fooService);

httpService.registerServlet("/myservlet", servlet, initparams, context); 
```

我不确定这是否是一种有效的方法，因为在非 OSGi 环境中，servlet 生命周期由 Web 容器管理，因此不会为稍后创建的 servlet 实例注入服务引用。

[当使用PAX Web](http://wiki.ops4j.org/display/paxweb/Pax+Web)作为 OSGi HttpService 的实现时，还有另一种方法可以解决这个问题。PAX Web 将 OSGi BundleContext 作为特殊属性“osgi-bundlecontext”导出到 ServletContext。然后可以使用 BundleContext 来获取必要的服务引用：

```
public void init(ServletConfig servletConfig) throws ServletException {

    ServletContext context = servletConfig.getServletContext()
    BundleContext bundleContext = 
        (BundleContext) context.getAttribute("osgi-bundlecontext");

    ServiceReference serviceRef =
         bundleContext.getServiceReference("com.foo.FooService")
} 
```

然而，这种方法相当丑陋，并将您与 OSGi HttpService 的具体实现联系在一起。你知道这个问题的任何其他（可能更好的）解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T07:50:58.893

如果您对服务的依赖项使用 setter，如您所展示的，它也可以在 OSGi 之外工作。你只需要使用一些其他的依赖注入机制。如果没有，您可以提供一个使用 JNDI 查找或从 servlet 上下文初始化 servlet 的子类。

```
public class MyServlet_AdapterForMissingDI extends MyServlet{

    public void init(ServletConfig config){
        setFooService(getItFromSomewhere());
    }

} 
```

关键是如果你有可以注入的 DI 能力`setFooService`，你可以在 OSGi 和其他地方使用相同的 servlet，如果你不这样做（并且仍然想支持这种情况），你提供一个适配器。

在相关说明中，请查看 Felix SCR 来配置对象的依赖项，以及 Pax Web Extender Whiteboard，它负责将 servlet 与 HttpService 挂钩。

具体来说，在没有 SCR 和 Whiteboard 的情况下，您需要考虑 fooService 稍后变得不可用，或者 HttpService 在您的 servlet 之后启动的情况。在这些情况下，您的 servlet 将引用一个死服务，以防止捆绑包被垃圾收集，或者您的 servlet 不会注册到 HttpService。

**更新：**这是我用于我的一个 servlet 的 SCR 描述符。SCR 处理 servlet 实例化、生命周期、注册（通过白板）和依赖关系。servlet 中没有特定于 OSGi 的代码。甚至不再需要 BundleActivator（SCR 注册所有服务）：

```
<component name="oracle.statusServlet" >
<implementation class="mypackage.DataSourceStatusServlet"/>
<property name="service.description" value="Oracle DataSource status servlet" />
<property name="alias" value="/OracleDataSourceStatus" />
<property name="servlet-name" value="Oracle DataSource status servlet" />
<service>
    <provide interface="javax.servlet.Servlet" />
</service>
    <reference name="DATASOURCES" 
            interface="javax.sql.DataSource"
            cardinality="0..n" policy="dynamic" 
            bind="bindDataSource" unbind="unbindDataSource"/>

</component> 
```

servlet 的依赖项在`reference`标记中指定。SCR 将进行服务查找和绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-02T11:29:59.927

可能是一篇旧文章，您可能已经得到了答案。您是在启动 felix 还是自己启动任何 OSGi 容器。如果是这种情况，您可以将捆绑上下文设置为 servlet 上下文的属性。

PAX 使用 http 服务有什么问题。最终，线程管理和其他方面由运行此 http 服务的 servlet 容器负责。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-16T19:14:07.547

您可以将服务注入某个对象，然后由 servlet 查询。

# oracle - Oracle 'printf' 等价物

> ID：1002818
> 
> 赞同：13
> 
> 时间：2009-06-16T17:14:28.807
> 
> 标签：oracle, string, formatting, printf

以下是否有等效或替代方法？

```
SELECT mix_type || ' (' || mix_num || ')' as description
  FROM acid_batch
 WHERE mix_num < 10 
```

Oracle 是否有类似 printf 样式的格式？

```
SELECT printf("%s (%s)", mix_type, mix_num) as description,
  FROM acid_batch
 WHERE mix_num < 10 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-03-16T09:40:32.067

我能想到的最接近 Oracle 的 printf 标准近似值是[utl_lms.format_message](http://docs.oracle.com/cd/E11882_01/appdev.112/e40758/u_lms.htm#ARPLS71194)。但是，它不会在 SQL 语句中起作用，也就是说，这是可以的：

```
begin
  dbms_output.put_line(
    utl_lms.format_message('hello %s, the number is %d', 'world', 42)
  );
end;
/ 
```

但这给出了*ORA-00902: invalid datatype*错误：

```
select utl_lms.format_message('hello %s, the number is %d', 'world', 42)
  from dual 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-16T20:30:29.363

不，没有以这种方式应用格式化字符串的内置 Oracle 函数。尽管为这个特定示例编写自定义函数很容易，但编写基于 PL/SQL 的 printf 实现将是一项挑战。

如果您经常需要这样做，也许您可​​以编写一个 Oracle 函数来包装 Java 调用以获得更丰富的字符串处理环境。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T01:14:41.490

给你的另一个想法：我发现 REPLACE 对这种事情很有用，特别是当模板很复杂时：

```
SELECT REPLACE(REPLACE(
        '%mix_type% (%mix_num%)' /*template*/
       ,'%mix_type%', mix_type)
       ,'%mix_num%' , mix_num ) as description,
FROM   acid_batch
WHERE  mix_num < 10 
```

唯一的缺点是您需要添加与`REPLACE(`要替换的变量一样多的 's - 但至少每个变量只需要一个，无论它在模板中出现多少次。

*（注意：使用“%”作为分隔符没有特别的意义，这只是我的个人习惯——你可以选择不同的模式，例如`<mix_type>`或`[mix_type]`）*

对于这个特定的实例，它看起来有点矫枉过正，但在某些情况下，它可以让事情变得更容易，例如：

```
template := 'bla bla %a% %b% %a%';
output := REPLACE(REPLACE(template
    ,'%a%', some_complex_expression)
    ,'%b%', b); 
```

将上述内容与以下内容进行比较：

```
output := 'bla bla ' || some_complex_expression || ' ' || b || ' ' || some_complex_expression; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-29T15:49:45.360

我为 Oracle SQL / PLSQL制作了一个名为[ora_te（在 GitHub 上）的简单模板引擎。](https://github.com/blza/ora_te)借助它，您可以通过以下方式实现目标：

模板字符串多次解析的无效实现：

```
with acid_batch as (
  select rownum as mix_type, rownum + 2 as mix_num 
  from all_objects
  where rownum < 10
)
--
SELECT pk_te.substitute('$1 ($2)', ty_p( mix_type, mix_num ) ) as description
FROM acid_batch
WHERE mix_num < 10; 
```

一次编译（解析）的有效实现：

```
with acid_batch as (
  select rownum as mix_type, rownum + 2 as mix_num 
  from all_objects
  where rownum < 10
),
--
o as ( 
  select ty_te.compile_numbered( '$1 ($2)' ) te from dual
)
SELECT pk_te.substitute( o.te, ty_p( mix_type, mix_num ) ) as description
FROM acid_batch, o
WHERE mix_num < 10; 
```

顺便说一句，它还支持命名占位符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T20:15:11.627

您可以在选择中解决它。

```
SELECT mix_type || '(' ||  mix_num || ')' as description,
FROM acid_batch
WHERE mix_num < 10 
```

你还应该看看函数

**[to_char](http://www.praetoriate.com/t_high_perform_conversion_functions.htm)**

**[迄今为止](http://infolab.stanford.edu/~ullman/fcdb/oracle/or-time.html)**

**[to_number](http://www.praetoriate.com/t_high_perform_conversion_functions.htm)**

因为它们为您提供了关于您希望如何表示事物的更精细的粒度。

# xcode - Xcode Mark 类似于 emacs

> ID：1002821
> 
> 赞同：6
> 
> 时间：2009-06-16T17:15:10.333
> 
> 标签：xcode

是否可以在 Xcode 中为类似于 emacs 中的“标记”功能的行添加书签？还有我可以用来跳转到行号的快捷方式吗？我的源代码变得冗长且难以浏览。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-16T17:22:53.960

是的; 如果您将文本插入符号放在要添加书签的行上并选择`Edit > Add to Bookmarks`（或 ⌘D），则可以将该行添加到项目中的书签中。然后，您可以从窗格`Bookmarks`中的项目访问这些书签。`Groups & Files`

要转到某一行，请`Edit > Go to Line...`从菜单（或 ⌘L）中选择，然后输入要导航到的行号。

我还建议您使用该`#pragma mark`指令来帮助您在源文件中导航。它采用以下格式：

```
#pragma mark <Label> 
```

并将显示在源文件顶部的功能弹出菜单中；它通过将常用函数组合在一起，提高代码的整体结构和可读性，使浏览代码变得更加容易。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-17T17:35:11.323

您还可以使用“标记”键序列、control-@ 或 control-space，然后您可以使用 Delete to Mark (control-W)、Select to Mark (control-X control-M) 和 Swap With Mark (control -X 控制-X)。Mac OS X 中的所有 Cocoa 文本视图都支持这些类似 emacs 的键绑定，您可以在 Xcode > Preferences > Key Bindings > Text Key Bindings 中自定义 Xcode 的键绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T17:30:39.080

您可以为文件中的单个行添加书签：在您的 .emacs 文件中

```
(global-set-key "\C-cb" 'bookmark-map) 
```

设置它，所以：

control-c bm 设置书签（您可以随意命名。）

control-c bj 跳转到书签（它询问您想要哪个书签）

还：

```
(global-set-key [f1]  'goto-line) 
```

设置 F1 以询问行号并跳转到该文件

# php - 我应该如何过滤 MySQL 中的日期？

> ID：1002823
> 
> 赞同：2
> 
> 时间：2009-06-16T17:15:55.590
> 
> 标签：php, mysql, datetime

我正在创建一组按年和月指定的“存档”页面。在我的表中，我有一个`datetime`名为`posted`. 我想选择特定月份中的所有行。

我想到了两种解决方案：

(1) 使用字符串匹配：

```
SELECT ... WHERE posted LIKE '2009-06%' 
```

(2)使用一些MySQL提取函数：

```
SELECT ... WHERE YEAR(posted)=2009 AND MONTH(posted)=6 
```

其中哪一个会更快，还有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T17:17:45.057

```
SELECT   *
WHERE    posted >= '2009-06-01'
         AND posted < '2009-07-01' 
```

`posted`与您的两个查询不同，这将有效地使用 上的索引。

请注意，如果您保留`posted`为`VARCHAR`，则以下查询：

```
SELECT ... WHERE posted LIKE '2009-06%' 
```

也会使用索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T17:17:52.937

忽略对此设计的保留，标准语法将是“BETWEEN first-date AND last-date”，或者（如果您使用的粒度小于日期），“posted >= first-date AND posted < last-date + 1 ”。

# language-agnostic - 您对存储库模式的理解是什么？

> ID：1002828
> 
> 赞同：1
> 
> 时间：2009-06-16T17:16:59.177
> 
> 标签：language-agnostic, design-patterns, repository-pattern

我正在赶上几个月前完成的一个项目的技术文档，而我即将完成的一个项目。我使用存储库来抽象出两者中的数据访问层，并在工作中在我们的 wiki 上编写模式的简短摘要。

正是在写这篇总结的时候，我意识到我第二次采取了一种稍微不同的方法。

一种方法是使用`InsertOnSubmit`与工作单元相结合的显式方法，并使用 UoW 跟踪更改进行隐式更新。另一个有一种`Save`插入新条目并更新现有条目的方法（没有 UoW）。

您通常倾向于哪种方法？考虑通常的 CRUD 场景，每个场景的责任应该在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:35:27.343

我认为存储库是否使用工作单元、缓存或任何其他相关概念应该留给实现。我更喜欢界面类似于与手头的域模型对齐的数据存储。所以客户存储库看起来像这样：

```
interface ICustomerRepository
{
    Customer Load(int id);
    IEnumerable<Customer> Search(CustomerQuery q);
    void Save(Customer c);
    void Delete(Customer c);
} 
```

这可以通过 NHibernate 或带有 NHibernate.Linq 的 NHibernate 或直接 SQL 库，甚至是 XML 或平面文件存储来轻松实现。如果可能的话，我喜欢将事务的概念保留在存储库之外，或者在更全局的范围内，以便多个存储库的操作可以成为单个事务的一部分。

# windows - 你如何有一个被调用的 bat 文件而不是杀死它正在调用的 bat 文件？

> ID：1002830
> 
> 赞同：3
> 
> 时间：2009-06-16T17:17:01.563
> 
> 标签：windows, batch-file

我在 Windows 2003 系统上，需要编写在 WebSphere Application Server 中删除和创建配置文件的脚本。这需要我调用 manageprofiles.bat 两次，一次是删除现有的配置文件，一次是创建一个新的配置文件。

在我的批处理文件中，我有以下内容：

```
cd "C:\Program Files\IBM\WebSphere\AppServer\bin"
manageprofiles.bat -delete -profileName AppSrv01
rmdir /s /q ..\profiles\AppSrv01
manageprofiles.bat -create -templatePath ..\profileTemplates\default -profileName AppSrv01 -profilePath ..\profiles\AppSrv01 
```

manageprofiles.bat 文件以：

```
set RC=%ERRORLEVEL%
@endlocal & exit /b %RC% 
```

当在我的批处理文件的第二行中删除配置文件时出错（这种情况经常发生），manageprofiles.bat 会吐出一条错误消息并导致我的批处理文件终止。我不希望这种情况发生，因为我将在下一个命令中删除配置文件的其余部分。阅读 exit 的文档让我相信 manageprofiles.bat 中的 exit 命令中的 /b 应该只导致 manageprofiles.bat 终止而不影响我的 bat 文件。

我不想以任何方式接触 manageprofiles.bat 文件，因为我的更改可能会通过更新恢复并再次破坏我的脚本。我可以在批处理文件中做些什么来解决这个问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T17:22:35.160

将两次出现的“manageprofiles.bat”更改为“call manageprofiles.bat”。如果没有“调用”，执行将转移到 manageprofiles.bat 文件但不会返回。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T17:22:05.473

是否使用

```
 call manageprofiles.bat 
```

有什么不同吗？

# java - 如何在 .NET 应用程序中托管 Java Swing 组件

> ID：1002832
> 
> 赞同：2
> 
> 时间：2009-06-16T17:17:19.783
> 
> 标签：java, .net, swing

我有一些 Java 用户界面控件，我想在我的 .NET 应用程序中托管，因为我负担不起重写它们的费用。我怎样才能做到这一点？我需要将它们包装在 COM 中吗？我怎么做？我希望该组件与其他用 .NET 编写的组件一起放在一个表单上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T17:28:04.217

如果您使用的是 VS2005，您是否考虑过在 J# 中编译上述 Java 组件？

我从未尝试过 J#，但我似乎记得 Microsoft 声称它将 Swing 调用转换为等效的 WinForms。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T17:29:14.030

从概念上讲，我发现几乎不可能相信有可能做到这一点。

但是，您可以尝试将现有组件迁移到 J#。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T17:31:19.207

有一种名为[JNBridge](http://www.jnbridge.com/pnews.htm)的产品声称可以做到这一点——我以前从未听说过。

另请参阅，[this previous post](https://stackoverflow.com/questions/441275/how-to-embed-a-java-control-on-a-c-winforms-control)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T17:25:08.307

没有办法强制实现这种高水平的集成。您不能让 .NET 表单承载 Java 组件。即使是 COM 包装也不能让您获得在表单中承载组件所需的集成级别。

# applescript - 如何使用 AppleScript 在 iTunes 中设置播放列表的曲目？

> ID：1002835
> 
> 赞同：2
> 
> 时间：2009-06-16T17:17:35.977
> 
> 标签：applescript, itunes

我正在尝试使用 AppleScript设置*用户播放列表的曲目。*我不希望添加曲目，我希望它们替换当前曲目。在我这样做之前，我需要通过它们的持久 ID 查找轨道，这工作正常，但是设置轨道的语句不起作用。下面的代码片段：

```
 set fixed indexing to true
        set myPlaylist to the first item of (every user playlist whose persistent ID is "5C768EFF306E3366")

        set tracksPIDs to {"66EB935073027EDD", "B6807694FEDD76B4"}
        set resolvedTracks to {}

        --resolve the tracks
        repeat with trackPID in tracksPIDs
            set myTrack to the first item of (every track whose persistent ID is equal to trackPID)
            set end of resolvedTracks to myTrack
        end repeat

        set (the tracks of my myPlaylist) to duplicate of (resolvedTracks) 
```

另外，如何从播放列表中删除所有曲目（即设置为空列表）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-18T05:46:18.383

要执行您想要的操作，您需要执行两个步骤，首先从播放列表中删除现有曲目，然后添加您想要在播放列表中的曲目。第一步看起来像：

```
delete every track of myPlaylist 
```

然后添加看起来像：

```
duplicate resolvedTracks to myPlaylist 
```

# c# - 如何通过部分标题名称设置前景窗口>

> ID：1002836
> 
> 赞同：1
> 
> 时间：2009-06-16T17:17:43.823
> 
> 标签：c#, windows

我想将另一个应用程序带到前台，但是，我只有窗口的部分名称。回到过去，我会连接到 EnumWindows API 并寻找我需要的东西。

有没有办法在 C# 中做得更好？一个例子会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:24:39.323

这应该做的工作：

```
[DllImport("user32.dll", EntryPoint="SystemParametersInfo")]  
public static extern bool SystemParametersInfo(uint uiAction, uint uiParam, uint pvParam, uint fWinIni);  

[DllImport("user32.dll", EntryPoint="SetForegroundWindow")]  
public static extern bool SetForegroundWindow(IntPtr hWnd);  

[DllImport("User32.dll", EntryPoint="ShowWindowAsync")]  
private static extern bool ShowWindowAsync(IntPtr hWnd, int cmdShow);  
private const int WS_SHOWNORMAL = 1;  
private const int SW_SHOWMAXIMIZED = 3;

[DllImport("user32.dll")] 
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool GetWindowPlacement(IntPtr hWnd, ref WINDOWPLACEMENT lpwndpl);

private struct WINDOWPLACEMENT
{
  public int length;
  public int flags;
  public int showCmd;
  public System.Drawing.Point ptMinPosition;
  public System.Drawing.Point ptMaxPosition;
  public System.Drawing.Rectangle rcNormalPosition;
}

Process[] processes = Process.GetProcesses();  
foreach(Process p in processes){              
 if(p.MainWindowTitle.Contains("nice_title")){
  WINDOWPLACEMENT wp = new WINDOWPLACEMENT();
  placement.length = Marshal.SizeOf(placement);
  GetWindowPlacement(p.MainWindowHandle, ref placement);

  int proposedPlacement = wp.showCmd;

  if (wp.showCmd == SW_SHOWMINIMIZED)
    proposedPlacement = SW_SHOWMAXIMIZED;

  SystemParametersInfo( (uint) 0x2001, 0, 0, 0x0002 | 0x0001);  
  ShowWindowAsync(p.MainWindowHandle, proposedPlacement);  
  SetForegroundWindow(p.MainWindowHandle);  
  SystemParametersInfo( (uint) 0x2001, 200000, 200000, 0x0002 | 0x0001);    

 }                                             
} 
```

# iphone - iPhone 上的音频

> ID：1002838
> 
> 赞同：10
> 
> 时间：2009-06-16T17:17:47.023
> 
> 标签：iphone, audio

我正在寻找创建一个模拟物理仪器的应用程序。我有音频样本，但我希望能够动态增加音高/频率，这样我就不必从太多文件中加载。

知道哪个音频 API 能够做到这一点吗？我认为是 OpenAL 或音频队列服务，但不确定哪个合适。任何指向指南/示例代码的链接也非常感谢。

提前致谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-16T21:43:44.147

2009 年我沿着这条路走下去，尝试了 Audio Toolkit、Audio Queue Services、openAL，最后选择了 RemoteIO AudioUnit。

Audio Toolbox 适用于基本的触发音效，但无法更改频率或循环采样。

音频队列服务可以循环采样，但我能找到调整采样播放频率的唯一方法是从文件中重新读取数据——非常痛苦。另外，该框架非常繁琐——我只会在尝试从 Internet 上传输某些内容时使用它。

OpenAL 是天赐之物——在我接触到 Apple 不再提供的“CrashLanding”iPhone 示例应用程序后，不到一个小时就启动并运行了它。我发现 OpenAL 非常适合游戏甚至乐器——可以预先加载样本，调整频率很容易，循环也没有问题。对我来说，最重要的是，开始和停止**循环样本**几乎每次都会导致令人讨厌的“流行”。此外，内置的 3d 位置音频混音器对我来说有点过于 CPU 密集型。

如果您的仪器不使用循环样本，我建议先尝试 OpenAL 路线 - 学习曲线不那么令人生畏。尝试追踪“SoundEngine.h”、“CrashLanding”或“TouchFighter”，或查看以下链接：

[http://benbritten.com/blog/2008/11/06/openal-sound-on-the-iphone/](http://benbritten.com/blog/2008/11/06/openal-sound-on-the-iphone/)

由于循环样本对我来说是必需的，所以我最终选择了 AudioUnits（在 iPhone 上，如果你想做输入或输出，它被称为“RemoteIO”）。实现起来非常困难 - 与音频队列服务非常相似，因为您实现的核心将位于“缓冲区回调”中，每秒被调用多次以使用原始 SInt16 值填充出站音频缓冲区。

最终，我的乐器在多音符复音、循环采样、无爆音和最小延迟方面表现出色。

不幸的是，RemoteIO 没有很好的文档记录。Michael Tyson 是该领域最早详细撰写 RemoteIO 的人之一，他的帖子（和评论）对我非常有用：

[http://michael.tyson.id.au/2008/11/04/using-remoteio-audio-unit/](http://michael.tyson.id.au/2008/11/04/using-remoteio-audio-unit/)

祝你好运！

多年后编辑：我已经开源了上面提到的 RemoteIO/AudioUnits 代码：[https](https://github.com/glenn-barnett/hexaphone/blob/master/Classes/Instrument.m) ://github.com/glenn-barnett/hexaphone/blob/master/Classes/Instrument.m - 为混乱道歉，我希望有时间清理一下代码和注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T21:00:29.180

Try creating an Audio Unit. I'm doing something similar an AU worked well for me. Initially I used an audio queue as it was simpler (higher level?) and synchronous, however it was lacking in responsiveness, so I dumped it for the Audio Unit.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T20:41:16.707

听起来，有点像你在创建播放 MIDI 文件的波表合成方法。您可能能够找到一个您可以使用的 iPhone MIDI 合成器，然后使用您的音频样本来构建波表集。任何时候您想要播放音调，您只需将 MIDI 事件与您加载的波表集一起发送到 iPhone MIDI 合成器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T06:13:37.770

现在的另一个选择是 AUSampler。 [http://developer.apple.com/library/mac/#technotes/tn2283/_index.html](http://developer.apple.com/library/mac/#technotes/tn2283/_index.html)

# wpf - WPF为多个类创建通用“选择器工具”

> ID：1002839
> 
> 赞同：4
> 
> 时间：2009-06-16T17:17:49.190
> 
> 标签：wpf, list

如果你把它减少到一个类，问题就很简单了。给定下图，我想创建一个简单的双面控件，它根据布尔值将一个列表中的项目放入另一个列表中。

编辑：您当然可以单击两个列表中的项目，然后该项目切换到另一个列表。此外，还会调用回调，以防我需要更新一些数据库内容......

我制作了一张漂亮的照片来让你有点兴奋，因为我被困住了......

世界并不像这个例子那么简单：**你将如何为各种课程解决这个问题。**

想象一下带有“IsFast”的“Car”类。或者像“水果”这样带有“ILikeIt”的类。我不想每次都重新编程 WPF 控件，我需要一些方法来绑定......（哦，我想我刚刚有了一个想法）......但是，是否有任何好的做法来允许泛型类（比如T）只要它们实现某些属性..还是包装类？

我不知道，你会如何解决它。与 OnClick 函数的简单绑定似乎还不够……不确定……而且，顺便说一句，“**编写 3 个控件”是一个合适的答案**。如果它更简单，请告诉我。

[替代文字 http://img31.imageshack.us/img31/96/listexample.png](http://img31.imageshack.us/img31/96/listexample.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T18:15:26.083

*我*该怎么做？

*   创建一个称为`PickList`子类的控件，`ItemsControl`并包括用于拾取单个项目、拾取所有项目、取消拾取所有项目等的命令
*   创建一个`PickListItem`具有`IsPicked`属性的类
*   定义控件模板`PickList`以包含两个`ListBox`es 和一堆按钮，用于选择一个等等。该模板将包含几个`CollectionViewSource`s 以将那些被挑选的项目（在右边）与那些没有被挑选的项目（在左边）分开

然后，您可以像使用任何其他控件一样使用此控件`ItemsControl`，并将其重用于您可能拥有的任何数据类型：

```
<PickList ItemsSource="{Binding People}">
    <PickList.ItemContainerStyle>
        <Style TargetType="{x:Type PickListItem}">
            <Setter Property="IsPicked" Value="{Binding IsRich}"/>
        </Style>
    </PickList.ItemContainerStyle>
</PickList> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T18:22:32.013

我*想*我明白你在追求什么，这应该让你开始。

我假设您的用户控件有两个列表视图，一个用于名为“TrueList”的*真实*项目，另一个用于名为“FalseList”的 *虚假*项目。

从 ItemsCollection 扩展您的用户控件，并将每个列表视图的 ItemsSource 属性绑定到父用户控件的 ItemsSource。

将*TrueFilter*和*FalseFilter*属性添加到您的用户控件：

```
 Predicate<object> trueFilter;
   public Predicate<object> TrueFilter
   {
        get
        {
             return trueFilter;
        }
        set 
        {
             if (trueFilter!= null && this.TrueList.Items != null)
                 this.TrueList.Items.Filter -= trueFilter;

             trueFilter = value;

             if (trueFilter!= null && this.TrueList.Items != null)
                 this.TrueList.Items.Filter += trueFilter;
        }
    }

   Predicate<object> falseFilter;
   public Predicate<object> FalseFilter
   {
        get
        {
             return falseFilter;
        }
        set 
        {
             if (falseFilter!= null && this.FalseList.Items != null)
                 this.FalseList.Items.Filter -= falseFilter;

             filter = value;

             if (falseFilter!= null && this.FalseList.Items != null)
                 this.FalseList.Items.Filter += falseFilter;
        }
    } 
```

然后创建一个“IToggle”（或其他更有意义的名称）接口：

```
public interface IToggle
{
   Predicate<object> TrueFilter { get; }
   Predicate<object> FalseFilter { get; }
} 
```

然后，为每个自定义类扩展 ObservableCollection，实现“IToggle”接口：

```
public class Cars : ObservableCollection<Car>, IToggle
{
    Predicate<object> trueFilter;
    public Predicate<object> TrueFilter
    {
        get
        {
            if (trueFilter == null)
               trueFilter = new Predicate<object>(this.TrueFilterPredicate);
            return trueFilter;
        }
    }

    private bool TrueFilterPredicate(object value)
    {
       Car car = (Car)value;
       return car.IsFast;
    }

    Predicate<object> falseFilter;
    public Predicate<object> FalseFilter
    {
        get
        {
            if (falseFilter == null)
               falseFilter = new Predicate<object>(this.FalseFilterPredicate);
            return falseFilter;
        }
    }

    private bool FalseFilterPredicate(object value)
    {
       Car car = (Car)value;
       return !car.IsFast;
    } 
```

接下来，覆盖用户控件上的 ItemsSource 属性：

```
public new IEnumerable ItemsSource
{
   get { return base.ItemsSource; }
   set
   {
        if (value != null && !(value is IToggle))
           throw new Exception("You may only bind this control to collections that implement IToggle.");

        base.ItemsSource = value;

        this.TrueFilter = base.ItemsSource == null ? null : (base.ItemsSource as IToggle).TrueFilter;
        this.FalseFilter = base.ItemsSource == null ? null : (base.ItemsSource as IToggle).FalseFilter;
   }
} 
```

最后，在您的事件回调中调用 TrueList.Items.Refresh() 和 FalseList.Items.Refresh() 以在您将项目从 true 切换为 false 时刷新项目视图，反之亦然。

这个解决方案仍然需要为每个自定义类（true 和 false 过滤器）编写一些实现代码，但它应该将额外的代码保持在最低限度。

或者，如果您为每个自定义类提供一个通用接口，这将是一个更简单的解决方案，例如：

```
public interface Valid
{
   bool IsValid { get; set; }
} 
```

然后，您可以使用一组过滤器（或样式设置器，或带有转换器的数据绑定）来处理“有效”接口。您可以使用“Car.IsValid”和“Fruit.IsValid”来代替“Car.IsFast”和“Fruit.ILikeIt”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T17:41:01.457

做一个用户控件。添加一个 SourceList 部门。财产。为您的回调添加一个委托属性，为您的“在列表中”过滤器添加一个委托属性

使用两个 ListBox 控件（一个左和一个右），使用[CollectionViewSource](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource_methods.aspx)设置两个列表的来源，使用过滤器委托来确定成员资格。

# python - pygtk 仅在一个 pixbuf 中加载图像流

> ID：1002841
> 
> 赞同：2
> 
> 时间：2009-06-16T17:18:09.283
> 
> 标签：python, pygtk

我正在尝试嵌入一个只能在缓冲区中给我一个 bmp 图像的图表抽屉库。

我正在加载这个图像，并且必须在新创建的 pixbuf 上显式调用 delete，然后调用垃圾收集器。

绘图方法每 50ms 调用一次

调用垃圾收集器确实很消耗 CPU。

有没有办法让所有进程只有一个 pixbuf，因此不必调用 gc？

还是我做错了一切？

提前谢谢任何帮助

拉斐尔

代码：

```
 def draw(self, drawArea):

        #init bmp loader
        loader = gtk.gdk.PixbufLoader ('bmp')

        #get a bmp buffer
        chart = drawArea.outBMP2()

        #load this buffer
        loader.write(chart)
        loader.close()

        #get the newly created pixbuf        
        pixbuf = loader.get_pixbuf()

        #and load it in the gtk.Image
        self.img.set_from_pixbuf(pixbuf)

        del pixbuf
        gc.collect() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T03:36:32.827

您不需要调用垃圾收集器。Python 会自动进行垃圾收集。在您的方法结束时，`pixbuf`超出范围（您也不需要“ `del pixbuf`”）并将自动被垃圾收集。因此，对于初学者，请删除方法的最后两行。

如果消耗过多的 CPU，您可能还想减少调用“绘制”方法的频率。在大多数应用程序中，我认为用户可以每 200 毫秒而不是每 50 毫秒处理一次更新，如果每 50 毫秒意味着将出现 CPU 问题。

# c# - ASP.NET MVC 操作中的冗余消除

> ID：1002845
> 
> 赞同：0
> 
> 时间：2009-06-16T17:19:21.640
> 
> 标签：c#, asp.net-mvc, refactoring

这个动作是不是太多余了——有没有更好的方法来简化它？

```
[Authorize, AcceptVerbs(HttpVerbs.Post)]
public ActionResult ChangePassword(string oldPassword, string newPassword, string confirmPassword)
{
    var oldPasswordValidationResults = _validatorProvider.Validate<IStringLengthValidator>(oldPassword);
    oldPasswordValidationResults.Where(r => !r.Passed)
                                .Each(r => ModelState.AddModelError("OldPassword", "Please enter your old password."));

    var newPasswordValidationResults = _validatorProvider.Validate<IStringLengthValidator>(newPassword);
    newPasswordValidationResults.Where(r => !r.Passed)
                                .Each(r => ModelState.AddModelError("NewPassword", "Please enter a new password."));

    if (!ModelState.IsValid)
        return View();

    if (newPassword != confirmPassword)
        ModelState.AddModelError("ConfirmPassword", "The passwords do not match.");

    if (!ModelState.IsValid)
        return View();

    if (!_userMembershipService.ChangePassword(oldPassword, newPassword))
        ModelState.AddModelError("_FORM", "Unable to change your password.");

    if (!ModelState.IsValid)
        return View();

    return View("ChangePasswordSuccessful");
} 
```

在我看来，所有这些都带有代码气味……

```
if (!ModelState.IsValid)
    return View(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-12T13:13:47.193

这种变化似乎更好地保留了你的初衷：

```
if (newPassword != confirmPassword)
{
    ModelState.AddModelError("ConfirmPassword", "The passwords do not match.");
    return View();
}

if (!_userMembershipService.ChangePassword(oldPassword, newPassword))
{
    ModelState.AddModelError("_FORM", "Unable to change your password.");
    return View();
}

return View("ChangePasswordSuccessful"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T17:23:23.473

不，我会说你只需要最后一次 IsValid 检查。

当然，您可能希望保留倒数第二个，因为如果密码与旧密码相同，则更改密码可能会导致不必要的日志事件或诸如此类的事情，具体取决于底层成员资格框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T17:26:31.410

将所有基本验证（如字符串长度和类型）移至模型级别，这将减少大量代码，您可以查看[xval](http://xval.codeplex.com/)框架

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T17:33:40.590

是的，我只保留最后一次 IsValid 检查，所以：

```
[Authorize, AcceptVerbs(HttpVerbs.Post)]
public ActionResult ChangePassword(string oldPassword, string newPassword, string confirmPassword)
{
    var oldPasswordValidationResults = _validatorProvider.Validate<IStringLengthValidator>(oldPassword);
    oldPasswordValidationResults.Where(r => !r.Passed).Each(r => ModelState.AddModelError("OldPassword", "Please enter your old password."));

    var newPasswordValidationResults = _validatorProvider.Validate<IStringLengthValidator>(newPassword);
    newPasswordValidationResults.Where(r => !r.Passed).Each(r => ModelState.AddModelError("NewPassword", "Please enter a new password."));

    if (newPassword != confirmPassword)
        ModelState.AddModelError("ConfirmPassword", "The passwords do not match.");

    if (!_userMembershipService.ChangePassword(oldPassword, newPassword))
        ModelState.AddModelError("_FORM", "Unable to change your password.");

    if (!ModelState.IsValid)
        return View();

    return View("ChangePasswordSuccessful");
} 
```

虽然，@j-steen 对倒数第二次检查提出了一个很好的观点，可能会为您节省一些开销。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T08:47:29.713

嵌套`if`语句可能有助于简化代码：

```
[Authorize, AcceptVerbs(HttpVerbs.Post)]
public ActionResult ChangePassword(string oldPassword, string newPassword, string confirmPassword)
{
    var oldPasswordValidationResults = _validatorProvider.Validate<IStringLengthValidator>(oldPassword);
    oldPasswordValidationResults.Where(r => !r.Passed)
                                .Each(r => ModelState.AddModelError("OldPassword", "Please enter your old password."));

    var newPasswordValidationResults = _validatorProvider.Validate<IStringLengthValidator>(newPassword);
    newPasswordValidationResults.Where(r => !r.Passed)
                                .Each(r => ModelState.AddModelError("NewPassword", "Please enter a new password."));

    if (ModelState.IsValid) {
        if (newPassword == confirmPassword) {
            if (_userMembershipService.ChangePassword(oldPassword, newPassword)) {
                return View("ChangePasswordSuccessful");
            }
            else {
                ModelState.AddModelError("_FORM", "Unable to change your password.");
            }
        }
        else {
            ModelState.AddModelError("ConfirmPassword", "The passwords do not match.");
        }
    }

    return View();
} 
```

# java - 在 Eclipse 中快速修复 JSP？

> ID：1002849
> 
> 赞同：3
> 
> 时间：2009-06-16T17:19:45.040
> 
> 标签：java, eclipse, jsp, jakarta-ee, quickfix

我正在运行 Eclipse 3.4 java 企业版并用它编写 JSP 页面。它似乎不支持快速修复，例如 ArrayList ourList；出现错误，但没有快速修复选项来添加 import java.util.ArrayList 语句。有没有提高快速修复能力的方法，或者另一组为jsp提供快速修复的Eclipse插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:32:39.797

我尝试了 Ctrl+空格键，它自动为我添加了导入。也许这已经足够了？

[MyEclipse](http://www.myeclipseide.com/)是您可以尝试改进 JSP 编辑的东西。我认为带有 JSP 编辑的版本只需 30 美元左右。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-06T00:08:22.793

除了这个特殊问题（您可以通过使用集成了[WTP的](http://www.eclipse.org/webtools/)**Eclipse for Java EE**来解决）之外，这意味着您正在 JSP 文件中编写原始 Java 代码。这被认为是不好的做法。JSP 是一种视图技术，您应该使用标记库（例如[JSTL](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/)）控制流程和输出，并使用 EL 访问数据。原始 Java 代码实际上属于真正的 Java 类，如 Servlet、Filter、Javabean、DAO、Utility 等。保持 JSP 与 scriptlet 无关。如果您需要做一些使用 taglibs/EL 无法实现的事情，那么特定代码很可能属于 Java 类。

创建一个`ArrayList`应该在 Servlet 类中直接或间接（业务类）完成。使用`doGet()`预处理数据以进行显示，使用`doPost()`后处理提交后的数据。`ArrayList`在 JSP 中，您可以使用 JSTL[`c:forEach`](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/c/forEach.html)标记来迭代。

祝你好运。

# ruby-on-rails - has_many ：通过 find_or_initialize_by 突破

> ID：1002851
> 
> 赞同：2
> 
> 时间：2009-06-16T17:21:02.493
> 
> 标签：ruby-on-rails, has-many-through

我有一个模型 Feed，它拥有并属于许多 FilteredUser。在这种情况下，我通过 has_many :through 关系实现了它。

```
class Feed < ActiveRecord::Base
  has_many :denials, :dependent => :destroy
  has_many :filtered_users, :through => :denials 
```

如果它不存在，我想创建一个记录，如果它确实存在，我想找到该对象。当我尝试使用 find_or_initialize_by（或 find_or_create_by）时，会抛出异常说`undefined method 'feed_id=' for <FilteredUser..`

这是代码：

```
feed = Feed.find(params[:id])
user = feed.filtered_users.find_or_initialize_by_user_url(params[:user_url])
if params[:status] == "block"
  feed.filtered_users << user
else
  feed.filtered_users.delete(user)
end
feed.save 
```

有关如何解决此问题或如何 DRYly 解决此问题的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-08T23:19:28.137

首先，因为它是一个`has_many :through`关系，所以初始化无法知道应该与哪个`denial`new关联。`filtered_user`如果要使用`find_or_initialize_by`，则需要在特定`denial`的即与`feed`.

构建一个新的过滤用户并将其与特定的拒绝相关联。

其次，同意 ErsatzRyan 的观点，一般逻辑似乎有点不对劲。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T13:46:33.887

先检查 params[:status] 然后做你需要做的事情不是更容易吗？

```
feed = Feed.find(params[:id])
if params[:status] == 'block'
   feed.filtered_users.build(:user_url => params[:user_url])
else
   feed.filtered_users.find_by_user_url(params[:user_url]).delete
end
feed.save 
```

**警告这是空气编码未测试**

# asp.net-mvc - Html.ActionLink 发生了什么 在 ASP.NET MVC 中？

> ID：1002862
> 
> 赞同：1
> 
> 时间：2009-06-16T17:23:29.933
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我正在阅读所有关于将 Html.ActionLink 方法与 lambda 表达式一起使用的博客。我什至在这里看到了关于它的 ScottGu 演示：[http ://www.hanselman.com/silverlight/ScottGuAtAltNetConf/](http://www.hanselman.com/silverlight/ScottGuAtAltNetConf/)

这是一个博客：[http ://blog.wekeroad.com/blog/aspnet-mvc-preview-using-the-mvc-ui-helpers/](http://blog.wekeroad.com/blog/aspnet-mvc-preview-using-the-mvc-ui-helpers/)

这是关于它的 ScottGu 博客：[http ://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)

"也可以写成：

```
 <%= Html.ActionLink("Search Drinks", s => s.Results("Beverages", 2)) %> 
```

"

由于这是一种编写 URL 路由的强大方法——特别是因为它自动支持重构工具——为什么这明显缺失或很难找到？我查看了 Reflector 中的 System.Web.Mvc.Html.LinkExtensions，我看到了很多 ActionLink(this HtmlHelper...) 扩展方法，但没有一个是通用的。

有人有帮助吗？谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:38:11.380

它被移到 Futures 程序集 (Microsoft.Web.Mvc.dll) 中，因为据我了解，开发团队需要解决一些问题。

[http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T17:38:22.817

它应该包含在[ASP.NET MVC Futures](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=16775)中。

所以我想答案是它并没有完全进入第一个版本。

# c# - 为什么此代码调整 .NET 表单高度的大小会使表单太小？

> ID：1002866
> 
> 赞同：3
> 
> 时间：2009-06-16T17:24:32.990
> 
> 标签：c#, .net, winforms

我的意图是表单的大小足够大以显示整个“buttonOK”，但不会大很多。实际发生的是，调整大小的表单最终变小，甚至根本无法显示按钮。

```
public MyFormDlg()   
{
    InitializeComponent();
    this.Height = this.buttonOK.Bounds.Bottom + SomePadding; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T17:28:37.633

该`Height`属性包括窗口标题栏的高度，因此客户区（按钮边界相对的那个）比您预期的要小。

这有效：

```
this.ClientSize = new Size(this.ClientSize.Width,
                           this.buttonOK.Bounds.Bottom + SomePadding); 
```

我没有找到`ClientHeight`房产，这可以做得更简单吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T17:28:45.730

为什么不使用按钮的高度属性？

# jquery - 如何将表单字段中的值附加到新表单字段中

> ID：1002870
> 
> 赞同：0
> 
> 时间：2009-06-16T17:25:01.570
> 
> 标签：jquery, append

这是故事。

我有一个带有一些表单字段的表单。

**例子：**

*   姓名
*   电子邮件
*   信息

我想做的是当我单击提交表单时，让 JQuery 获取电子邮件字段值并将其附加到消息字段。

**我将值存储在这里：**

```
var email = $('#email').val(); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:29:04.637

```
$("#message").val ($("#message").val () + $('#email').val()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T17:29:17.867

这应该有效：

$("#message").val( $("#message").val() + $('#email').val() );

# c# - 从 WCF 检索数据以存储在 SQL Server CE (TableAdapter) 上

> ID：1002872
> 
> 赞同：1
> 
> 时间：2009-06-16T17:25:51.270
> 
> 标签：c#, wcf, sql-server-ce, tableadapter

我有一个使用 WCF 服务的 Compact Framework 2.0 应用程序。从服务中检索的数据将存储在 SQL Server 2005 CE 上。

SQL Server CE 数据库有自己的表。我使用 TableAdapter 访问 SQL Server CE 并使用 Insert 和 Select 语句来存储和检索数据。

有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-01T19:45:41.097

你可以考虑同步框架

[http://blogs.msdn.com/sync/archive/2009/06/04/announcing-sync-framework-2-0-ctp2.aspx](http://blogs.msdn.com/sync/archive/2009/06/04/announcing-sync-framework-2-0-ctp2.aspx)

# c# - 以下数据结构的更好替代方法是什么：字典 >

> ID：1002878
> 
> 赞同：1
> 
> 时间：2009-06-16T17:27:05.607
> 
> 标签：c#, data-structures

我有以下一组数据

```
<ids>
   <id1 attr1="value1" attr2="value2" />
   <id2 attr3="value3" attr4="value4" />
   <id3 attr2="value6" attr5="value7" />
</ids> 
```

基本上，它是一个 XML，可以有任何节点名称和任何属性名称和任何属性值。

解析 XML 后，我将属性数据存储在 Dictionary 中。然后我将相同的 Dictionary 存储为一个值，并将节点名称作为键。所以我的数据结构将是 Dictionary<string, Dictionary<string, string>> （让我们给它一个名为“dict”的变量名）所以如果我想在 id1 节点中获取 attr2 的值，我会这样做：

```
string value = dict["id1"]["attr2"];
// value will be value2 
```

我认为这是一个非常简单且可行的解决方案，可以满足我的需求，但我脑后似乎有一个声音告诉我，我错过了一个不同的数据结构或更简单的解决方案。大家怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T17:35:13.617

我认为您的解决方案是一个很好的解决方案。它将提供非常快速的查找，并与您的域完全匹配。

嵌套字典是您的主要问题吗？如果是这样，我建议您不要担心 - 使用集合的集合通常是一个非常有用的工具。

我唯一的抱怨是：如果您不经常使用它，您将把大量信息加载到可能不必要的数据结构中。如果这是一次性查找，则将其保留在 XML 中并使用 XPath 查询可能是比预先解析并将整个内容加载到内存中更优化的解决方案。但是，如果您经常查询这个，这是一个更优化的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T17:46:42.900

上课怎么样？

```
public class YourId
{
    public string Id { get; set; }
    public string Attribute1 { get; set; }
    public string Value { get; set; }
} 
```

然后你可以创建一个 List 并通过你的 xml 填充它......它很容易使用，你可以使用 linq ：

```
List<YourId> items = GetIdsFromXml();

var query = from i in items
            where i.Id == "id1"
            select i;

// or...

items.Where(i => i.Attribute == "blah").ToList();

// ect. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T17:33:27.317

那个 XML 看起来不太好。它根本不是语义 XML。语义 XML 将是：

```
<data>
    <item id="id1">
        <value name="attr1">value1</value>
        <!-- ... -->
    </item>
    <!-- ... -->
</data> 
```

我知道它更大，但这对你来说是 XML。我什至这么说的原因是，如果您还没有准备好使用语义 XML，那么您可能正在寻找另一种数据格式。XML 在本质上有点臃肿。如果您正在寻找一种紧凑的格式，请查看[JSON](http://json.org/)。

无论如何，使用语义 XML，我会推荐 XPath。查看 MSDN 文档并查看`SelectNodes`DOM 对象中的方法。

简短的例子：

```
XmlDocument doc = new XmlDocument();
doc.Load("data.xml");

// Get a single item.
XmlNode item = doc.SelectSingleNode("//item[@id=myid]"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T17:35:32.820

只是为了笑——如果您保留 XML DOM 并使用 XPath 查询找到您的属性怎么办？这样，如果您有重复的节点名称，您可以适应它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T17:31:57.927

只要所有节点都有唯一的名称，你应该没问题。请注意，它不适用于像这样的 XML：

```
<nodes>
     <node id="id1" attr1="value1" attr2="value2" />
     <node id="id2" attr3="value3" attr4="value4" />
     <node id="id3" attr2="value6" attr5="value7" />
</nodes> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T17:32:29.220

鉴于 XML 可以具有任何节点名称和任何属性名称，我认为您当前的解决方案是最佳的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T17:34:48.233

为什么不使用已经存在的东西？就像[C# 中的简单 XML 解析器](http://www.c-sharpcorner.com/UploadFile/shehperu/SimpleXMLParser11292005004801AM/SimpleXMLParser.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T17:44:30.937

如果您需要一种 XML 语法，请根据您的需要创建一个。如果您需要解析器，请使用 .Net 库中提供的众多优秀解析器之一。如果您需要将文档存储在内存中并访问它，请使用 DOM 和 XPath 来选择节点。如果您不需要任何这些，那么我建议您不要使用 XML，而是使用像 JSON 这样更简单的东西。

如果您需要将整个内容保存在内存中，而只是保存值，那么我建议使用 DataSet 并使用 XML 加载器加载它们。

# android - 如何从光标对象中获取 URL

> ID：1002884
> 
> 赞同：0
> 
> 时间：2009-06-16T17:28:52.720
> 
> 标签：android

我有一个指向联系人的光标。如何获取从该光标构建的 url？

我需要知道，因为从这里 [http://developer.android.com/guide/topics/providers/content-providers.html](http://developer.android.com/guide/topics/providers/content-providers.html)

我需要一个 url 以便我可以构建一个电话 uri，如下所示：

phoneUri = Uri.withAppendedPath(uri, People.Phones.CONTENT_DIRECTORY);

我可以查询该联系人的所有电话号码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T09:47:09.650

您可以使用以下查询检索某个联系人的所有号码：

```
/* the following line assumes that the contactCursor you described
 * has the People._ID column at index 0 in its projection. */
int contactId = contactCursor.getInt(0);

Cursor numberCursor = getContentResolver().query(Phones.CONTENT_URI,
  new String[] {Phones.NUMBER}, Phones.PERSON_ID + "=" + contactId, null, null);
while(cursor.moveToNext()) {
  String number = cursor.getString(0);
}
cursor.close();
```

# nerddinner - vs2008打不开NerdDinner项目

> ID：1002907
> 
> 赞同：4
> 
> 时间：2009-06-16T17:35:10.917
> 
> 标签：nerddinner

NerdDinner.csproj 不会在带有 .net 3.5 sp1 的 vs2008 sp1 中加载。我不是最新的这些工具或什么的吗？它抱怨此安装不支持此项目类型。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T17:37:40.570

您是否安装了 ASP.NET MVC 框架？如果没有，你需要它。NerdDinner 是 MVC 框架项目的一个示例，如果没有安装 ASP.NET MVC 框架，您将无法打开或运行它。

[您可以在http://www.asp.net](http://www.asp.net)或更具体地[http://www.asp.net/mvc](http://www.asp.net/mvc)找到相应的安装信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-01T03:22:44.993

在我的项目文件中，我不得不更改“ProjectTypeGuids”的值。我从我用我的 VS 2008 版本创建的另一个 MVC 项目中复制了它们。

这是给我答案的帖子：

[http://www.stuffthatjustworks.com/How+To+Fix+Xcsproj+Cannot+Be+Opened+The+Project+Type+Is+Not+Supported+By+This+Installation.aspx](http://www.stuffthatjustworks.com/How+To+Fix+Xcsproj+Cannot+Be+Opened+The+Project+Type+Is+Not+Supported+By+This+Installation.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-09T20:41:07.753

就我而言……这是框架的错误版本。

我刚刚从我制作的另一个 asp.net mvc 项目中复制了它。（那么您可能必须修复引用，这对于 resharper 来说是微不足道的 :-)）

# java - java p2p视频库？

> ID：1002908
> 
> 赞同：5
> 
> 时间：2009-06-16T17:35:12.710
> 
> 标签：java, web-services, web-applications

是否有任何此类库可用于商业或开源？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-25T21:26:46.900

只是想更新这个线程并注意我们已经在 Frozen Mountain 创建了这样一个库；它被称为[IceLink](http://www.frozenmountain.com/downloads#icelink)。服务器部分（STUN/TURN，用于 NAT 遍历和 IP 发现）在 Java 上可用（除了 .NET、Mac 等），并且有一个完整的 Java 库实现用于实际的 P2P 通信和音频/视频编码/解码/渲染。它也符合 WebRTC 标准，并且可以与 Chrome 等进行良好的通信。

我们也发布了 VP8 Java 包装器：[https ://jvp8.codeplex.com/](https://jvp8.codeplex.com/)

（免责声明：我在@FM 工作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T21:36:32.093

在谷歌搜索了一下以及根据我的经验之后，我什么都不知道。如果你真的找到了，我可能还会想知道它的保真度。也许您为此启动自己的开源项目是个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-21T02:29:41.053

到今天为止，还没有这样的开源库。

# xslt - XSL 到组项目

> ID：1002913
> 
> 赞同：0
> 
> 时间：2009-06-16T17:36:05.173
> 
> 标签：xslt, sitecore

我有一组 Sitecore 节点：

```
<item>
  <item>
    <item />    
  </item>
  <item /> <!-- (1) -->
  <item />
</item>
<item>
  <item />
  <item />
</item> 
```

我可以使用函数 sc:path(.) 获取这些路径，该函数为标记为 (1) 的点返回类似“/item/item”的内容。

我想要做的是根据它们的路径对项目进行分组。

所以我的输出会是这样的：

```
<ul>
  <li>in item
    <ul>
...
    </ul>
  </li>
  <li>in item/item
    <ul>
...
    </ul>
  </li>
</ul> 
```

我目前正在使用前面的轴，如以下代码所示：

```
<xsl:for-each select="exsl:node-set($processedResult)/item">
  <xsl:sort 
    select="substring-before(substring-after(sc:path(.),'/sitecore/media library/'),'.aspx')"
    data-type="text"
    order="ascending" />
  <xsl:variable 
    name="path" 
    select="search:GetFriendlyPath('/sitecore/media library/',sc:path(.))" />
    <!-- returns: item/item from /sitecore/media library/item/item/item.aspx -->                    
  <xsl:variable name="lastPath">
    <xsl:choose>
      <xsl:when test="sc:path(preceding)">
        <xsl:value-of 
          select="search:GetFriendlyPath('sitecore/media library',sc:path(preceding))" />
      </xsl:when>
      <xsl:otherwise>none</xsl:otherwise>
    </xsl:choose>
  </xsl:variable>               
  <xsl:if test="$path != $lastPath"> <!-- grouping test -->
    <li>
      <strong>in <xsl:value-of select="$path" /></strong>
    </li>
  </xsl:if>
  <li>
  <!-- render detail -->
  </li>
</xsl:for-each> 
```

...但是 sc:path(preceding) 什么也不返回。因此我的支票不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T18:25:18.813

我不确定你打算做什么

```
<xsl:when test="sc:path(preceding)"> 
```

这读作“将命名`<preceding>`为节点集的子节点提供给`sc:path()`函数”。

查看您的输入，没有具有该名称的子元素。

会不会是你的意思

```
<xsl:when test="sc:path(preceding-sibling::item[1])"> 
```

?

对 Sitecore 一无所知，我会试一试：

```
<xsl:for-each select="exsl:node-set($processedResult)/item">
  <xsl:sort select="
    substring-before(
      substring-after(sc:path(.), '/sitecore/media library/'),
      '.aspx'
    )"
    data-type="text"
    order="ascending"
  />
  <xsl:variable name="path" select="
    search:GetFriendlyPath(
      '/sitecore/media library/', sc:path(.)
    )
  " />
  <xsl:variable name="lastPath">
    <xsl:choose>
      <xsl:when test="preceding-sibling::item[1]">
        <xsl:value-of select="
          search:GetFriendlyPath(
            'sitecore/media library', sc:path(preceding-sibling::item[1])
          )"
        />
      </xsl:when>
      <xsl:otherwise>
        <xsl:text>none</xsl:text>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:variable>

  <!-- grouping test -->
  <xsl:if test="$path != $lastPath">
    <li>
      <strong>
        <xsl:text>in </xsl:text>
        <xsl:value-of select="$path" />
      </strong>
    </li>
  </xsl:if>

  <li>
    <!-- render detail -->
  </li>
</xsl:for-each> 
```

# file - 更改固件内的文件需要新的校验和

> ID：1002914
> 
> 赞同：0
> 
> 时间：2009-06-16T17:36:14.207
> 
> 标签：file, hex, editing, checksum, firmware

我有一个要更改的相框的固件文件。此更改的目的是使设备在启动期间显示自定义图像。

我已经设法用我自己的自定义文件切换现有的 JPEG 文件，但是无法用这个新的固件文件刷新设备。设备抱怨校验和无效，这似乎是正确的，因为我没有重新计算它。

有关如何继续进行此操作的任何提示？我试过在文件中查找校验和，但到目前为止我还没有成功。

[一个 zip 文件中的原始未更改和自定义更改固件](http://dump.no/files/842f3c44b91b/mp612.zip)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:55:00.250

这个问题没有一个通用的答案，答案取决于设备，以及它用于验证固件的校验和。

通常，校验和用于验证文件在传输过程中没有损坏。

校验和可能只是一个 CRC 或 MD5 或其他散列，附加到固件的末尾，或者它可能位于某处的标头中。

如果您不走运，则校验和与数字签名相结合，这将阻止您“更正”您所做更改的校验和。

如果你很幸运，那么有人将能够告诉你固件的格式以及校验和算法是什么。

# javascript - 什么是 Javascript 的“this”更好的名字？

> ID：1002923
> 
> 赞同：10
> 
> 时间：2009-06-16T17:38:49.150
> 
> 标签：javascript, syntax, this

我来自 Java 背景，具有基于类的继承模型，试图了解 Javascript 的基于原型的继承模型。让我失望的部分原因是，我牢牢记住了 Java 对“this”的含义——而 Javascript 的“this”是一个非常不同的野兽。我知道 Javascript 的“this”总是指函数的调用者，而不是定义函数的范围——我的意思是，我已经阅读了它并从表面上理解了它的含义。但我想更深入地了解，我认为给它取另一个名字会有所帮助。您如何看待 JS“这个”？每次遇到它时，您都会进行心理替代吗？如果是这样 - 你使用什么词或短语？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-16T17:49:47.373

`this`可能会`context`在 Javascript 中合理地重命名为。

它实际上是指当前范围的执行上下文，虽然该上下文*可以*是类的实例，但它当然不一定是 - 它可以是任何对象，并且可以在运行时修改.

证明无法保证 Javascript 中的“方法”在定义它的“类”的实例上运行：

```
function Cat(){

     this.texture = 'fluffy';

     this.greet = function(){
         alert("Pet me, I'm " + this.texture);
     }
 }

 var cat = new Cat();

 // Default to using the cat instance as the this pointer
 cat.greet(); // Alerts "Pet me, I'm fluffy"

 // Manually set the value of the this pointer!
 cat.greet.call({texture: 'scaly'});  // Alerts "Pet me, I'm scaly" 
```

需要注意的是，对象**的值`this`完全独立于包含函数的定义位置**。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-16T17:50:08.433

一种可能的替代名称是`owner`. 这将使您的想法转向所有者可以根据您正在执行的代码进行更改的方向。

这个例子来自[quirksmode](http://www.quirksmode.org/js/this.html)：

在 JavaScript`this`中，总是指我们正在执行的函数的“所有者”，或者更确切地说，指的是函数作为方法的对象。当我们在页面中定义我们忠实的函数 doSomething() 时，它的所有者就是页面，或者更确切地说，是 JavaScript 的窗口对象（或全局对象）。但是，onclick 属性归其所属的 HTML 元素所有。

在下面的代码中，

```
function doSomething() {
   this.style.color = '#cc0000';
} 
```

和

```
element.onclick = doSomething; 
```

,`owner`指向执行时包含该方法的对象。

```
------------ window --------------------------------------
|                                          / \           |
|                                           |            |
|                                          this          |
|   ----------------                        |            |
|   | HTML element | <-- this         -----------------  |
|   ----------------      |           | doSomething() |  |
|               |         |           -----------------  |
|          --------------------                          |
|          | onclick property |                          |
|          --------------------                          |
|                                                        |
---------------------------------------------------------- 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-16T17:40:38.290

我认为 JavaScript比你想象`this`的更接近 Java 。`this`在 OOP 上下文中，`this`表示“此实例”。我认为 JavaScript 的`this`关键字可能令人困惑的是，它*可能*具有不同的含义，具体取决于上下文。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T17:44:20.373

`this`不是函数的调用者（尽管它可能是）或定义函数的范围（尽管它可能是） - 它是函数的*context*。

@Andrew Hare 所指的转换含义可能更接近您困惑的根源；由于 JS 的原型继承机制，`function`关键字可能意味着，取决于它的使用方式，它`class`比 Java 的方法定义更接近 Java。

假设在浏览器中执行：

```
var q = this.document; //this is window

var o = new (function pseudoconstructor(){
    this.property = "something else" //the new keyword changed 'this' to mean 'the object I'm about to return'
})(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T17:43:24.963

“JavaScript this”怎么样？它会让你直接与你正在做的事情联系在一起，并提醒你当前正在使用的“this”概念是 JavaScript 概念。

最终，我希望您不再将其称为“JavaScript this”，而是将其称为“this”，充分了解在您工作的上下文中这意味着什么。我希望这可能是您想要的无论如何，要到达。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T17:58:10.667

我吸收了新颖的语法，并带有一些易于输入的心理模型，例如：

```
$(document).ready(function() {

  function baffle() {
    alert(this.b);
  }

  function what() {
    this.b = "Hello";
    baffle();
  }

  function huh() {
    this.b = "World";
    baffle();
  }

  what();
  huh();

  }
); 
```

这很糟糕地翻译成草率的、想象中的 C++ 为：

```
template <class This>
function baffle() {
  alert(This.b);
}

function what() {
  b = "Hello";
  baffle<what>();
}

function huh() {
  b = "World";
  baffle<huh>();
}

what();
huh(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T18:43:24.400

我认为`this`出于历史原因是最合适的。在 JavaScript中并没有一个千篇一律的短语`this`，因为它不仅可以自动分配给非常不同的引用，例如，`this`在过程函数的上下文或`this`对象的上下文中，而且`this`可以也由脚本编写者使用`Function.apply`和分配`Function.call`。

但是， 的含义`this`只能调整，因为 JavaScript 和 DOM 以一些非常奇怪的方式工作。例如， 的主要用途`Function.apply`是在事件调用中保留元素引用的上下文。您将在 Prototye 的`Function.bind()`方法中看到这一点。

`this`是执行函数的上下文的占位符，很难得到比这更具体的内容。然而，大多数使用`this`使它成为语义上合适的关键字。在 的情况下`bind()`，即使我们使用方法来任意更改`this`函数内的含义，也应该使用它来`this`比没有它时更合适。许多业余 JavaScript 程序员对`this`事件处理程序的奇怪行为感到厌烦，并`Function.apply`习惯于纠正这种“错误”。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-16T19:21:52.540

自我参照逻辑（self 或 this）避免了悖论，从而有利于在 self（this）以外的地方工作。自我（this）是否应将所有内容保持为一，它也可以保持静态，没有实例，而是使用类方法（静态）。为了避免悖论，避免自我引用，逻辑保持所有真理可证明，反之亦然，所有可证明为真。

# java - 自定义日志记录以在运行时收集消息

> ID：1002926
> 
> 赞同：9
> 
> 时间：2009-06-16T17:39:12.550
> 
> 标签：java, log4j

有没有办法在运行时创建一个 log4j 记录器，将日志消息收集到缓冲区中？

我目前有一个记录许多事件的类。对于需要监视记录事件的远程应用程序，我只想交换一个记录到缓冲区然后检索缓冲区的记录器，而不是重构类。例如给出类似的东西：

```
Class Foo{
   Logger log = ....;

   public void doSomething(){ 
      log.debug(...
      .. actual code
      log.debug(...
   }
} 
```

//我想从一些外部代码中做些什么：

```
String showFooLog(){
   Foo f = new Foo();
   f.log=new Logger(... 
   f.doSomething();
   return f.log.contents();
} 
```

## 这可能吗？

编辑：找到了一个更短的解决方案，从 Jared 的帖子中指出（尽管它仍然不是线程安全的）。谢谢您的帮助。

```
 Logger l = Logger.getLogger( ...  );
 StringWriter writer = new StringWriter();
 WriterAppender appender = new WriterAppender( new HTMLLayout(), writer );
 l.addAppender( appender );
    ... run code here
  writer.flush();
 l.removeAppender( appender );
 return writer.toString() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T17:47:10.917

这绝对是可能的——尽管您可能需要创建自己的 Appender。不过，这真的很容易做到。这是一个粗略的例子（需要考虑线程安全......这不是线程安全的......而且我不确定我是否喜欢静态......但这应该足以推动你在正确的方向）：

```
public class BufferAppender extends org.apache.log4j.AppenderSkeleton {
    private static Map<String, StringBuffer> buffers = new HashMap<String, StringBuffer>();

    @Override
    protected void append(LoggingEvent evt) {
        String toAppend = this.layout.format(evt);
        StringBuffer sb = getBuffer(evt.getLoggerName());
        buffer.append(toAppend);
    }

    public static String getBufferContents(String loggerName) {
            StringBuffer sb = buffers.get(sb);
            if(sb == null) {
               return null;
            } else {
               return sb.toString();
            }
    }

    public static void clearBuffer(String loggerName) {
            createBuffer(loggerName);
    }

    private static StringBuffer getBuffer(String loggerName) {
       StringBuffer sb = buffers.get(loggerName);
       if(sb == null) {
            sb = createBuffer(loggerName);
       }
       return sb;
    }

    private static StringBuffer createBuffer(String loggerName) {
       StringBuffer sb = new StringBuffer();
       buffers.put(loggerName, sb);
       return sb;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T17:49:05.797

您可以继承 org.apache.log4j.WriterAppender 并为其提供一个 ByteArrayOutputStream 来存储任何消息。请参阅 WriterAppender 的其他子类以获取灵感。然后，您可以将该对象的实例提供给您的记录器，以便通过 addAppender 进行附加。

# cocoa - 如何将 NSURLRequest 与非静态内容一起使用？

> ID：1002929
> 
> 赞同：0
> 
> 时间：2009-06-16T17:39:53.063
> 
> 标签：cocoa

我关注了[由 HTTP 数据驱动的 A Cocoa 应用程序](http://cocoawithlove.com/2008/09/cocoa-application-driven-by-http-data.html)博客文章，并且已经能够成功地使用以下 URL 来获取要在我的示例应用程序中使用的 HTML：

[http://www.argos.co.uk/static/Home.htm](http://www.argos.co.uk/static/Home.htm)

但是，当我在示例应用程序中使用以下 URL 时，我无法获取 HTML 内容并且应用程序会退出：

[http://www.argos.co.uk/webapp/wcs/stores/servlet/CheckPriceAndStockCmd?langId=-1&POSTCODE=BT635TE&jspStoreDir=argos&storeId=10001&partNum=340%2F9251&ddkey=CheckPriceAndStockCmd](http://www.argos.co.uk/webapp/wcs/stores/servlet/CheckPriceAndStockCmd?langId=-1&POSTCODE=BT635TE&jspStoreDir=argos&storeId=10001&partNum=340%2F9251&ddkey=CheckPriceAndStockCmd)

如何从第二个 URL 加载生成的内容以便解析它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T20:28:45.763

该博客的代码中没有任何内容，也没有 URL 本身表明第二个 URL 将是一个问题。如果您的应用程序刚刚退出，这通常表明存在某种错误的内存访问。需要检查的一些事项：

*   您是否为第二个请求重新使用相同的连接类？如果是这样，请确保`NSMutableData`您存储结果的位置仍然有效，并且尚未释放或取消分配。

*   确保在实例化`NSURL`和`NSURLRequest`启动之前已经成功创建了 and `NSURLConnection`...`nil`

*   插入一些断点以查看连接`NSURLConnection`在爆炸之前通过委托回调方法的距离。

如果您正在运行 XCode 调试配置文件，您应该在应用程序退出时在调试器中获得一个堆栈跟踪...伙计们。

# javascript - DOM对象的jQuery xy文档坐标

> ID：1002934
> 
> 赞同：51
> 
> 时间：2009-06-16T17:41:06.777
> 
> 标签：javascript, jquery, user-interface, location

我需要获取 DOM 元素的 X、Y 坐标（相对于文档的顶部/左侧）。我找不到任何可以给我这些的插件或 jQuery 属性或方法。我可以获取 DOM 元素的顶部和左侧，但这可以相对于其当前容器/父级或文档。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-06-16T17:43:09.113

~~你可以使用[Dimensions](http://plugins.jquery.com/project/dimensions)插件~~[已弃用...包含在jQuery 1.3.2+中]

> **offset()**
> 获取第一个匹配元素的当前偏移量，以像素为单位，相对于**文档**。
> 
> **position()**
> 获取元素相对于其**偏移父**元素的顶部和左侧位置。

知道了这一点，那就很容易了……（以我的小[svg 项目](https://stackoverflow.com/questions/536676)作为[示例页面](https://github.com/balexandre/Draggable-Line-to-Droppable/blob/master/index.htm)）

```
var x = $("#wrapper2").offset().left;
var y = $("#wrapper2").offset().top;

console.log('x: ' + x + ' y: ' + y); 
```

输出：

```
x: 53 y: 177 
```

希望它对您正在寻找的内容有所帮助。

**这是 offset() 和 position() 的图像**

使用[X 射线](https://addons.mozilla.org/en-US/firefox/addon/1802)

![替代文字](../Images/4e7bfbb2ceae836fda104a2d84b9fbf1.png)

使用[Web Developer](https://addons.mozilla.org/en-US/firefox/addon/60)工具栏

![替代文字](../Images/29b87f509d685ee5466c114023086c80.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-01-25T05:35:48.577

我的解决方案是一个带有“解决方法”的插件 :+D 。但是有效！

```
jQuery.fn.getPos = function(){
        var o = this[0];
        var left = 0, top = 0, parentNode = null, offsetParent = null;
        offsetParent = o.offsetParent;
        var original = o;
        var el = o;
        while (el.parentNode != null) {
            el = el.parentNode;
            if (el.offsetParent != null) {
                var considerScroll = true;
                if (window.opera) {
                    if (el == original.parentNode || el.nodeName == "TR") {
                        considerScroll = false;
                    }
                }
                if (considerScroll) {
                    if (el.scrollTop && el.scrollTop > 0) {
                        top -= el.scrollTop;
                    }
                    if (el.scrollLeft && el.scrollLeft > 0) {
                        left -= el.scrollLeft;
                    }
                }
            }            
            if (el == offsetParent) {
                left += o.offsetLeft;
                if (el.clientLeft && el.nodeName != "TABLE") {
                    left += el.clientLeft;
                }
                top += o.offsetTop;
                if (el.clientTop && el.nodeName != "TABLE") {
                    top += el.clientTop;
                }
                o = el;
                if (o.offsetParent == null) {
                    if (o.offsetLeft) {
                        left += o.offsetLeft;
                    }
                    if (o.offsetTop) {
                        top += o.offsetTop;
                    }
                }
                offsetParent = o.offsetParent;
            }
        }
        return {
            left: left,
            top: top
        };
    }; 
```

用法：

```
var p = $("#wrapper2").getPos();
alert("top:"+p.top+"; left:"+p.left); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T18:05:14.180

[偏移](http://docs.jquery.com/CSS/offset)功能将为您做到这一点。

这是他们给出的例子：

```
var p = $("p:last");
var offset = p.offset();
p.html( "left: " + offset.left + ", top: " + offset.top ); 
```

# php - 如果 PHP 会话在请求中间超时，$_SESSION 数组会发生什么？

> ID：1002935
> 
> 赞同：3
> 
> 时间：2009-06-16T17:41:43.873
> 
> 标签：php, session, session-timeout

我一直想知道，如果 PHP 会话在执行脚本期间超时，那么 $_SESSION 数组的内容是否仍然可用，直到脚本执行结束？例如：

```
session_start();

if(! isset($_SESSION['name'])) {
    echo 'Name is not set';
    exit;
}

// imagine there is a bunch of code here and that the session times out while
// this code is being executed

echo 'Name is ', $_SESSION['name']; // will this line throw an error? 
```

将会话变量复制到本地范围是否可行，以便稍后在脚本中读取它们而不必继续检查会话超时？就像是：

```
session_start();

if(isset($_SESSION['name'])) {
    $name = $_SESSION['name'];
} else {
    echo 'Name is not set';
    exit;
}

// bunch of code here

echo 'Name is ', $name; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T17:47:31.883

不要担心这些事情。会话不会发生任何事情。它由您的脚本初始化`sessioni_start()`并将`$_SESSION` 始终在您的脚本中可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T17:56:58.843

每次打开会话时都会重置默认的三小时会话生命周期（请参阅 参考资料[`session_cache_expire`](http://us.php.net/manual/en/function.session-cache-expire.php)），因此会话在请求中间超时的唯一方法是处理请求需要三个小时。默认情况下，PHP 请求仅在 30 秒后超时，因此在请求期间没有会话过期的危险。此外，`$_SESSION`变量不会在请求中间突然改变。它在会话开始时填充，就是这样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T18:00:42.033

变量在初始请求时被复制到 $_SESSION 全局变量中，因此它与将其复制到局部变量具有相同的效果。

但是，为了清楚起见，将其复制到局部变量是有意义的。特别是如果您计划多次使用该变量。可能很难阅读到处都有 $_SESSION['variable'] 的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T17:52:56.260

您需要了解的是会话是如何工作的。使用 $_SESSION 超级全局访问脚本的客户端只知道属于他们的会话的密钥（存储在 Cookie/URL 中）。这意味着会话数据本身与客户端无关。如果您有要使用的会话数据的密钥，则可以使用它。旧版本的 PHP 存在一些安全漏洞，因为会话存储在易于访问的位置（我不记得细节）。

基本上，如果您在 PHP 脚本中有会话 ID，则您可以访问该会话，除非机器上的内存已刷新/硬盘驱动器损坏（即计算机重新启动/设备故障）。

希望这会有所帮助，否则请访问 php.net 并深入了解会话如何工作的详细信息。

# c# - C# 正则表达式拆分为 Java 模式拆分

> ID：1002937
> 
> 赞同：1
> 
> 时间：2009-06-16T17:42:09.737
> 
> 标签：c#, java, regex, split

我必须将一些 C# 代码移植到 Java，并且在转换字符串拆分命令时遇到了一些问题。

虽然实际的正则表达式仍然正确，但在 C# 中拆分时，正则表达式标记是结果字符串 [] 的一部分，但在 Java 中，正则表达式标记被删除。

保留拆分令牌的最简单方法是什么？

这是一个按我想要的方式工作的 C# 代码示例：

```
using System;

using System.Text.RegularExpressions;

class Program
{
    static void Main()
    {
        String[] values = Regex.Split("5+10", @"([\+\-\*\(\)\^\\/])");

        foreach (String value in values)
            Console.WriteLine(value);
    }
}

Produces:
5
+
10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T17:52:36.760

这是因为您正在捕获拆分令牌。C# 将此作为您希望将令牌本身保留为结果数组的成员的提示。Java 不支持这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T18:00:19.010

我不知道 C# 是如何做到的，但要在 Java 中完成它，你必须近似它。看看[这段代码](http://snippets.dzone.com/posts/show/6453)是怎么做的：

```
public String[] split(String text) {
    if (text == null) {
        text = "";
    }

    int last_match = 0;
    LinkedList<String> splitted = new LinkedList<String>();

    Matcher m = this.pattern.matcher(text);

    // Iterate trough each match
    while (m.find()) {
        // Text since last match
        splitted.add(text.substring(last_match,m.start()));

        // The delimiter itself
        if (this.keep_delimiters) {
            splitted.add(m.group());
        }

        last_match = m.end();
    }
    // Trailing text
    splitted.add(text.substring(last_match));

    return splitted.toArray(new String[splitted.size()]);
} 
```

# xcode - Emacs 与 XCode 对话

> ID：1002940
> 
> 赞同：8
> 
> 时间：2009-06-16T17:42:49.673
> 
> 标签：xcode, debugging, emacs, applescript, elisp

我在我的 mac 上使用 emacs 在 Xcode 中编程。它在大多数情况下都非常有效。我在 xcode 中双击一个文件，它会在现有的 emacs 窗口中将其拉出。我编译，并得到语法错误，双击，它们出现在活动的 emacs 窗口中。伟大的。

这就是 XCode 与 emacs 的对话。有谁知道让emacs与XCode对话的方法？例如，我希望能够在 emacs 中设置断点并让 gdb 的 XCode 版本确认它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T17:57:43.583

通过将 AppleScript 嵌入 elisp 中，您实际上可以使用 AppleScript 在 Emacs 中的 XCode 中设置断点。

[此页面包含您需要的代码](http://han9kin.doesntexist.com/tag/Breakpoint)。是韩文的，但其实韩文看不懂的不多。第一个代码块只是一个用于开发断点代码的直接 AppleScript 示例。第二块是你想要的。它将第一个示例嵌入到您可以添加到 .emacs 文件中的 elisp 片段中。

其他通信可以使用相同的技巧完成。只需弄清楚如何在 AppleScript 中执行您想要的操作，然后将该 AppleScript 嵌入 Emacs 中的 elisp 中。

顺便说一句，[这里是 do-applescript 的文档](http://www.gnu.org/software/emacs/manual/html_node/emacs/Mac-Functions.html)，这是Mac 上可用的 lisp 函数，可让您调用 AppleScript。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-16T17:46:28.563

听起来像是一个新插件的工作！

# security - 分布式或去中心化声誉/信任的算法

> ID：1002952
> 
> 赞同：12
> 
> 时间：2009-06-16T17:45:36.550
> 
> 标签：security, cryptography, p2p, trust

有谁知道一种算法，用于计算您在分散系统中“信任”另一个用户（他们的声誉）的程度。

像这样的网站使用一个集中的权威来跟踪声誉点，但是当你不能信任一个权威来公正地维护这个列表，或者基础设施不存在时，你怎么能对你的同行的声誉进行排名呢？

我在想象类似于[PageRank](http://en.wikipedia.org/wiki/PageRank)的东西——我信任我的朋友 Alice，她信任她的朋友 Bob，因此我对 Bob 有一些传递性信任。如果我的另一个朋友 Carol 也信任 Bob，那么我对 Bob 的信任就会增加。

是否有某种方法可以在全球范围内进行计算，或者每个用户都必须跟踪自己的网络？

我在想你可以只“声明”你信任谁，这会给每个人一组相应的传入信任链接，但我觉得这很容易通过创建许多只创建声誉点的僵尸用户来游戏，比如链接农场搜索结果。这可能是问题的核心：如果 Google 仍然存在人们生成虚假 PageRank 分数的问题，那么这可能不是一个容易解决的问题 :)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-16T17:51:34.123

看一下[EigenTrust](http://en.wikipedia.org/wiki/EigenTrust)算法：

[P2P 网络中用于声誉管理的 EigenTrust 算法](http://www.stanford.edu/~sdkamvar/papers/eigentrust.pdf)- SD Kamvar、MT Schlosser 和 H. Garcia-Molina

该算法为网络中的每个对等点分配一个全局信任值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T17:51:40.380

网站[Advogato](http://www.advogato.org/)实现了分布式信任度量。源代码可用。这是[常见问题解答](http://www.advogato.org/faq.html)和[信任度量的描述](http://www.advogato.org/trust-metric.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T17:54:12.857

*这可能不是一个容易解决的问题*

你说对了。这是一个非常活跃的研究领域，尤其是在 P2P 环境中。在谷歌上快速搜索信任 p2p 网络会发现很多关于它的论文。

[尤其是这个](http://www.mathcs.emory.edu/~lxiong/research/pub/xiong02building.pdf)提出了一个很好的考虑事项列表，（并提供了一种算法）。

克服再入和进入障碍 - 你如何防止坏人使用新昵称并重新加入网络？

创建评分激励机制——大型 P2P 网络对其他用户进行评分的激励机制是什么？

单个授权服务器管理用户之间的信任/声誉通常要简单得多。你必须想出一个很好的理由，说明你希望它去中心化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T17:56:46.317

我认为每个用户跟踪和服务自己的信任上行链路的系统可能会在这种情况下工作。例如; 假设用户 A 信任用户 B，并给他们 5 分信任（满分 10 分）。假设我不知道是否信任用户 A 或用户 B；如果用户 A 做了一些让我信任他们的事情，我可以将他们标记为受信任，他们可以告诉我他们信任谁；然后我会得到用户 A 对用户 B 的排名，我可以根据需要调整信任；如果我对用户 A 高度信任，我可能会给用户 B 5 分（完全基于用户 A 对他们的评分）；如果我稍微信任用户 A，我可能会给用户 B 评分 1（总比不信任好，但不像用户 A 认为的那样受信任）。通过这种方式，用户通过值得信赖的事物来确定信任的第一顺序（upvoting 他们的帖子，等），然后可以从他们明确信任的那些用户那里获得“关联”信任；正在发生“二阶”网络效应。我要特别说的是，当用户从某人那里获得其他用户的信任信息时，他们应该只向那些被他们从中获取信任信息的用户授予“显式信任”的用户授予“隐式信任”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T17:56:47.297

也许是“[评估认证链信任度的代数](http://persons.unik.no/josang/papers/Jos1999-NDSS.pdf)”。

然而，信任是一个*人类*难题，最多可以用论文中提到的算法来近似。

进一步推荐阅读：

*   [信任网络](http://en.wikipedia.org/wiki/Web_of_trust)（例如[CAcert.org](http://en.wikipedia.org/wiki/CAcert.org)）
*   [密钥签署方](http://en.wikipedia.org/wiki/Key_signing_party)
*   [关于信任信任的思考](http://cm.bell-labs.com/who/ken/trust.html)

# python - 大型 Sqlite 数据库搜索

> ID：1002953
> 
> 赞同：2
> 
> 时间：2009-06-16T17:46:18.657
> 
> 标签：python, sql, database, search, performance

如何实现高效的大型 Sqlite 数据库搜索（超过 90000 个条目）？

我正在使用 Python 和 SQLObject ORM：

```
 import re
    ...

    def search1():
        cr = re.compile(ur'foo')
        for item in Item.select():
            if cr.search(item.name) or cr.search(item.skim):
                print item.name 
```

此功能运行时间超过 30 秒。我应该如何让它运行得更快？

**UPD**：测试：

```
 for item in Item.select():
        pass 
```

... 与我的初始函数（0:00:33.093141 到 0:00:33.322414）花费的时间几乎相同。所以正则表达式没有时间。

一个 Sqlite3 shell 查询：

```
 select '' from item where name like '%foo%'; 
```

运行大约一秒钟。所以主要的时间消耗是由于ORM从db中检索数据效率低下造成的。我猜 SQLObject 在这里抓取整行，而 Sqlite 只涉及必要的字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:50:45.077

最好的方法是重新编写逻辑以在数据库中而不是在 python 程序中进行选择。

而不是做 Item.select()，你应该重写它来做 Item.select("""name LIKE ....

如果你这样做，并确保你已经索引了 name 和 skim 列，它会很快返回。90000 个条目并不是一个大型数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T18:35:45.987

30 秒获取 90,000 行可能并没有那么糟糕。

您是否对执行以下操作所需的时间进行了基准测试？

```
 for item in Item.select():
        pass 
```

只是看看时间是DB时间，网络时间还是应用程序时间？

如果您的 SQLite 数据库在物理上非常大，那么您可能正在查看——简单地说——大量的物理 I/O 来读取所有数据库内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T17:57:03.413

如果您真的需要使用正则表达式，那么您实际上无法做任何事情来极大地加快速度。

最好的办法是编写一个 sqlite 函数，在 db 引擎中为您执行比较，而不是 Python。

您还可以切换到支持 SIMILAR 的数据库服务器，例如 postgresql。

[http://www.postgresql.org/docs/8.3/static/functions-matching.html](http://www.postgresql.org/docs/8.3/static/functions-matching.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T04:47:57.840

鉴于您的示例并扩展 Reed 的答案，您的代码可能类似于以下内容：

```
import re
import sqlalchemy.sql.expression as expr

...

def search1():
    searchStr = ur'foo'
    whereClause = expr.or_(itemsTable.c.nameColumn.contains(searchStr), itemsTable.c.skimColumn.contains(searchStr))
    for item in Items.select().where(whereClause):
        print item.name 
```

这转化为

```
SELECT * FROM items WHERE name LIKE '%foo%' or skim LIKE '%foo%' 
```

这将使数据库为您完成所有过滤工作，而不是获取所有 90000 条记录并可能对每条记录执行两个正则表达式操作。

[您可以在此处找到有关 .contains() 方法的一些信息](http://www.sqlalchemy.org/docs/05/reference/sqlalchemy/schema.html?highlight=contains#sqlalchemy.schema.Column.contains)。

以及[此处的 SQLAlchemy SQL 表达式语言教程](http://www.sqlalchemy.org/docs/05/sqlexpression.html)。

当然，上面的示例假定您的 itemsTable 及其具有的列（nameColumn 和skimColumn）的变量名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T09:40:09.280

我肯定会接受 Reed 的建议，将过滤器传递给 SQL（尽管忘记索引部分）。

我不认为只选择指定的字段或所有字段会有所不同（除非您确实有很多大字段）。我敢打赌 SQLObject 创建/实例化 80K 对象并将它们放入 Session/UnitOfWork 进行跟踪。这肯定需要一些时间。

此外，如果您的会话中不需要对象，则必须有一种方法可以使用自定义查询创建来选择您需要的字段，这样就不会`Item`创建对象，而只会创建元组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-26T08:11:01.907

最初通过 Python 执行正则表达式被考虑用于 y_serial，但为了支持 SQLite 的 GLOB（它快得多）而放弃了。GLOB 类似于 LIKE，只是它的语法更传统： * 而不是 %, ? 代替 _ 。

有关详细信息，请参阅[http://yserial.sourceforge.net/](http://yserial.sourceforge.net/)上的尾注。

# sql-server-2005 - 在 SSIS 2005 脚本任务上设置超时

> ID：1002959
> 
> 赞同：0
> 
> 时间：2009-06-16T17:47:39.683
> 
> 标签：sql-server-2005, ssis

我在 ssis 2005 中使用脚本任务，这需要一些时间，并且出现“操作已超时”超时问题。更改超时时间的设置在哪里？我似乎无法在任务的属性中找到它，并且我不希望对超时进行全局更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T17:59:13.003

超时的问题可能出在数据库中。您应该在 SSIS 包中的连接管理器中定义一个新的超时

# ruby-on-rails - 如何在表单中编辑 Rails 序列化字段？

> ID：1002963
> 
> 赞同：57
> 
> 时间：2009-06-16T17:48:33.443
> 
> 标签：ruby-on-rails, forms, serialization

我的 Rails 项目中有一个数据模型，它有一个序列化字段：

```
class Widget < ActiveRecord::Base
  serialize :options
end 
```

选项字段可以有可变数据信息。例如，这里是来自夹具文件的一条记录的选项字段：

```
 options:
    query_id: 2 
    axis_y: 'percent'
    axis_x: 'text'
    units: '%'
    css_class: 'occupancy'
    dom_hook: '#average-occupancy-by-day'
    table_scale: 1 
```

我的问题是让用户在标准表单视图中编辑此信息的正确方法是什么？

如果您只是为选项字段使用一个简单的文本区域字段，您只会得到一个 yaml 转储表示，并且该数据将作为字符串发送回。

在 Rails 中编辑这样的序列化哈希字段的最佳/正确方法是什么？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-06-16T21:17:26.853

如果您事先知道选项键是什么，您可以为它们声明特殊的 getter 和 setter，如下所示：

```
class Widget < ActiveRecord::Base
  serialize :options

  def self.serialized_attr_accessor(*args)
    args.each do |method_name|
      eval "
        def #{method_name}
          (self.options || {})[:#{method_name}]
        end
        def #{method_name}=(value)
          self.options ||= {}
          self.options[:#{method_name}] = value
        end
        attr_accessible :#{method_name}
      "
    end
  end

  serialized_attr_accessor :query_id, :axis_y, :axis_x, :units
end 
```

这样做的好处是它将选项数组的组件公开为属性，这允许您像这样使用 Rails 表单助手：

```
#haml
- form_for @widget do |f|
  = f.text_field :axis_y
  = f.text_field :axis_x
  = f.text_field :unit 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-05-21T07:21:24.717

好吧，我有同样的问题，并尽量不要过度设计它。问题是，尽管您可以将序列化哈希传递给 fields_for，但函数的字段会认为它是一个选项哈希（而不是您的对象），并将表单对象设置为 nil。这意味着，尽管您可以编辑这些值，但它们在编辑后不会出现。这可能是 Rails 的错误或意外行为，将来可能会修复。

然而，就目前而言，让它工作起来很容易（尽管我花了整个上午才弄清楚）。

您可以将模型保持原样，并且在视图中您需要将对象的字段作为开放结构提供。这将正确设置记录对象（因此 f2.object 将返回您的选项），其次它允许 text_field 构建器从您的对象/参数中访问值。

由于我包含了“|| {}”，因此它也适用于新/创建表单。

```
= form_for @widget do |f|
  = f.fields_for :options, OpenStruct.new(f.object.options || {}) do |f2|
    = f2.text_field :axis_y
    = f2.text_field :axis_x
    = f2.text_field :unit 
```

祝你有美好的一天

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-01-26T20:46:35.067

emh 快到了。我认为 Rails 会将值返回到表单字段，但事实并非如此。因此，您可以手动将其放入每个字段的 ":value =>" 参数中。它看起来并不光滑，但它确实有效。

这是从上到下的：

```
class Widget < ActiveRecord::Base
    serialize :options, Hash
end

<%= form_for :widget, @widget, :url => {:action => "update"}, :html => {:method => :put} do |f| %>
<%= f.error_messages %>
    <%= f.fields_for :options do |o| %>
        <%= o.text_field :axis_x, :size => 10, :value => @widget.options["axis_x"] %>
        <%= o.text_field :axis_y, :size => 10, :value => @widget.options["axis_y"] %>
    <% end %>
<% end %> 
```

您在“fields_for”中添加的任何字段都将显示在序列化哈希中。您可以随意添加或删除字段。它们将作为属性传递给“选项”哈希并存储为 YAML。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-08-31T17:05:11.260

我一直在努力解决一个非常相似的问题。我在这里找到的解决方案对我很有帮助。谢谢@austinfromboston、@Christian-Butske、@sbzoom 和其他所有人。但是，我认为这些答案可能有点过时了。以下是使用 Rails 5 和 ruby​​ 2.3 对我有用的方法：

在表格中：

```
<%= f.label :options %>
<%= f.fields_for :options do |o| %>
  <%= o.label :axis_y %>
  <%= o.text_field :axis_y %>
  <%= o.label :axis_x %>
  <%= o.text_field :axis_x %>
  ...
<% end %> 
```

然后在控制器中我必须像这样更新强参数：

```
def widget_params
    params.require(:widget).permit(:any, :regular, :parameters, :options => [:axis_y, :axis_x, ...])
end 
```

序列化的散列参数出现在参数列表的末尾似乎很重要。否则，Rails 会期望下一个参数也是一个序列化的散列。

在视图中，我使用了一些简单的 if/then 逻辑，仅在哈希不为空时显示哈希，然后仅显示值不为零的键/值对。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-11-23T14:15:41.380

我遇到了同样的问题，经过一些研究，我找到了一个使用 Rails 的解决方案[`store_accessor`](https://apidock.com/rails/ActiveRecord/Store/ClassMethods/store_accessor)，可以将序列化列的键作为属性访问。

有了这个，我们可以访问序列化列的“嵌套”属性……</p>

```
# post.rb
class Post < ApplicationRecord
  serialize :options
  store_accessor :options, :value1, :value2, :value3
end

# set / get values
post = Post.new
post.value1 = "foo"
post.value1
#=> "foo"
post.options['value1']
#=> "foo"

# strong parameters in posts_controller.rb
params.require(:post).permit(:value1, :value2, :value3)

# form.html.erb
<%= form_with model: @post, local: true do |f| %>
  <%= f.label :value1 %>
  <%= f.text_field :value1 %>
  # …
<% end %> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-07T05:34:42.507

不需要setter/getter，我只是在模型中定义：

```
serialize :content_hash, Hash 
```

然后在视图中，我这样做（使用 simple_form，但与 vanilla Rails 类似）：

```
 = f.simple_fields_for :content_hash do |chf|
    - @model_instance.content_hash.each_pair do |k,v|
      =chf.input k.to_sym, :as => :string, :input_html => {:value => v} 
```

我的最后一个问题是如何让用户添加新的键/值对。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-20T22:21:29.347

我会建议一些简单的东西，因为一直以来，当用户保存表单时，你会得到字符串。因此，您可以在过滤和解析这些数据之前使用例如：

```
before_save do
  widget.options = YAML.parse(widget.options).to_ruby
end 
```

当然，如果这是正确的 YAML，您应该添加验证。但它应该有效。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-01-26T06:50:47.740

我正在尝试做类似的事情，但我发现了这种作品：

```
<%= form_for @search do |f| %>
    <%= f.fields_for :params, @search.params do |p| %>
        <%= p.select "property_id", [[ "All", 0 ]] + PropertyType.all.collect { |pt| [ pt.value, pt.id ] } %>

        <%= p.text_field :min_square_footage, :size => 10, :placeholder => "Min" %>
        <%= p.text_field :max_square_footage, :size => 10, :placeholder => "Max" %>
    <% end %>
<% end %> 
```

除了在呈现表单时不填充表单字段。提交表单后，值就可以通过了，我可以这样做：

```
@search = Search.new(params[:search]) 
```

所以它的“一半”工作......

# visual-studio-2008 - 是否可以在 Visual Studio TestMethod 执行期间显示进度？

> ID：1002966
> 
> 赞同：7
> 
> 时间：2009-06-16T17:48:49.730
> 
> 标签：visual-studio-2008, unit-testing

有没有办法可以在 Visual Studio 2008 中显示单个 TestMethod 的进度？

在一组单元测试中，我有一个运行很长时间的 TestMethod - 通常需要 30 到 60 分钟。我已经使用 [Timeout] 属性设置了超时，没有问题。但我希望能够获得测试进度的视觉指示。

我知道测试结果窗口提供了所有测试方法的可视化进度更新。我想要的是单个方法的视觉进度更新。在 WinForms 应用程序中，我会弹出一个 ProgressBar 控件。在控制台应用程序中，我会定位光标并显示状态消息。但这是一个单元测试。我可以写入 TestContext，但在测试完成之前，该窗口是不可见的。

* * *

**编辑**：我知道有办法做到这一点；这一切都只是软件，所以总有办法。但是什么是简单实用的方法呢？

一种方法是创建一个 TestMethodProgressMonitor.exe 应用程序，该应用程序从命名管道读取，并根据通过管道传递的消息更新进度条。TestMethod 可以shellExec 执行TestMethodProgressMonitor.exe，然后写入命名管道。完成后，可能有一个众所周知的关闭命令，TestMethod 将它发送到 TestMethodProgressMonitor.exe 应用程序。

另一种选择是将 TestMethodProgressMonitor.exe 构建为 COM 服务器，并且 TestMethod 可以使用 COM (DCOM) 来更新应用程序内的托管进度条。

另一种选择是使用 user32.dll SendMessage() 方法将 WM_COPYDATA 消息发送到监视器应用程序。有时这样做是为了远程控制应用程序。

这些是一些可能性。在我开始构建其中一个之前，我想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T18:22:15.760

我只是用一个带有进度条的窗口启动一个 GUI 线程。

这是一个片段，可以帮助您入门。它只是在另一个线程（而不是另一个进程）中弹出 MyProgressWindow。

```
[ClassInitialize()]
static public void MyClassInitialize(TestContext testContext)
{
    start_app_in_gui_thread();
}

static Thread t;

private static void start_app_in_gui_thread()
{
    t = new Thread(() => {
        var w = new MyProgressWindow();
        var app = new App();
        app.ShutdownMode = ShutdownMode.OnMainWindowClose;
        app.Run(w);
    });
    t.SetApartmentState(ApartmentState.STA);
    t.Start();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T18:25:28.657

对于我长期运行的测试，我使用 Trace API 来附加跟踪侦听器（DbgView 或自定义的东西）。

无需跳过任何障碍即可轻松查看正在发生的事情。

这不会给您带来进度条体验（尽管您可以很容易地编写一个）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-30T11:18:36.417

我遇到了同样的要求，但任何新文件或可执行文件对我来说都太过分了：我正在编写单元测试，而不是应用程序。以下代码将进度写入调试输出窗口：

```
 [TestMethod]
    public void ProgressTest()
    {
        int nLastWritten = -1, nTotal = 10000;

        for (int i = 0; i < nTotal; i++)
        {
            int nProgress = 100 * i / nTotal;
            if (nProgress > nLastWritten)
            {
                System.Diagnostics.Trace.WriteLine("Progress: " + nProgress + "%");
                nLastWritten = nProgress;
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T03:12:34.950

不确定这是最简单的方法，但这就是我所做的。我破解了一个 WM_COPYDATA 发送和接收的类。它是一个收发器。这允许一个 Windows 应用程序以相当低的延迟与同一台机器上的另一个应用程序进行通信。我把它打包成一个组件。

然后我构建了一个 winforms 应用程序 (UnitTestProgressMonitor.exe)，它创建了其中一个收发器，并根据它接收到的消息更新其 UI。消息只是字符串。这就是他们所做的：

*   bar 3 - UI 创建并显示 3 个进度条
*   pb 0 max 100 - 将进度条 #0 的最大值设置为 100
*   pb 0 value 28 - 将进度条 #0 的值设置为 28
*   停止 - 退出。

然后，在 [TestMethod] 中，我 shellexec 执行 UnitTestProgressMonitor.exe，然后创建一个收发器并发送应用程序消息。

测试代码将“bars 3”发送到进度监视器应用程序，告诉它创建 3 个进度条。第一个跟踪测试中的 7 个步骤。第二个进度条衡量 zip 文件的进度；文件中的每个条目都是沿着条形的一个步骤。第三条是单个条目的进度。其中一些是数 GB 的文件，因此压缩它们可能需要一段时间。在测试执行期间，测试会在适当的时间发送“pb 0 步骤”或其他任何内容。这些消息会导致进度条更新。在测试结束时，测试代码向监控应用程序发送“停止”。对此，进度监视器应用程序会消失。测试结束。

[单元测试进度监视器 http://www.freeimagehosting.net/uploads/45b4979b92.jpg](http://www.freeimagehosting.net/uploads/45b4979b92.jpg)

# opengl - 多重采样时如何在 OpenGL 纹理中解析深度值？

> ID：1002971
> 
> 赞同：3
> 
> 时间：2009-06-16T17:50:33.457
> 
> 标签：opengl, multisampling

我正在使用 FBO 将我的场景渲染为深度纹理 ( `GL_DEPTH_COMPONENT`)。当我在我的应用程序中启用多重采样时，这些样本被解析为单个纹素，但是它们是如何组合的呢？是存储到纹理的最近样本的深度，还是样本的平均值？这种行为是否依赖于供应商？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:54:44.150

请参阅[多样本规范文档](http://www.opengl.org/registry/specs/ARB/multisample.txt)：

“如果深度测试通过，所有多采样缓冲区深度样本值都设置为片段最中心样本的深度值的深度，并且所有多采样缓冲区颜色样本值都设置为传入片段的颜色值。”

# css - 如何在不影响设计的 CSS 中使用 Internet Explorer 中的超大字体？

> ID：1002974
> 
> 赞同：2
> 
> 时间：2009-06-16T17:51:19.477
> 
> 标签：css, internet-explorer

我需要与我的设计相匹配的字体大小是 85pt，非常大。在 IE6 和 IE7 中，我的设计受到了影响，因为包含这些元素的 div 变得比平时大，结果，这些元素下的元素被推得更深，有点破坏了设计。我为这些元素定义了高度，当我减小字体大小时，元素开始缩小到正确的大小。我添加了 line-height: 0; 到元素，这适用于所有现代浏览器。

不幸的是，我正在进行的设计无法公开展示，但我希望能够深入了解其他可能的技术，我可以尝试让设计正确渲染。父元素的高度为 144px，其中包括上下 10px 的 padding 和上下 1px 的边框。

不幸的是，我可以添加的内容不多，但如果被问到，我会提供我能提供的任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T19:44:55.057

line-height:0 是一个很好的开始。但是，我有点担心父元素上的 10px 填充。每当您将填充与 IE 混合使用时，您就会开始失去对宽度和高度的控制。

我首先删除父元素上的 padding-top 并将其转换为实际子元素上的 margin-top:10px 。如果这仍然给您带来麻烦，请删除边距并尝试位置：相对于顶部：10px 的孩子。

最后，尝试向父元素添加一个溢出：隐藏，以强制它在字体大小变大时不让步。

所有这一切都取决于您的子元素实际上是什么。如果将其转换为内联元素（如 span、em 或 strong），它可能有助于缓解一些渲染问题，具体取决于您的预定义样式。

另一件要考虑的事情 - 你在使用花车吗？有时您会遇到 IE 和浮点数的双浮点问题。“IE double float”的快速谷歌会告诉你原因。

这有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T17:55:58.923

将字体大小转换为像素并使用 px 而不是 pt。确保填充、边距和边框为 0。验证 HTML 中除了单词之间没有空格。空白最终会显示为换行符或空格，使元素比预期的要大。也不要将 line-height 设置为 0，将其设置为 auto 或与 font-size 相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T18:05:36.640

谢谢大家的意见。最初我需要对相关元素进行绝对定位，而父元素具有相对定位。但是，将它与 line-height: 0 一起使用会导致文本在 IE6 和 7 中消失；在试图弄清楚文本最初的位置后，我删除了绝对定位并决定在 IE6 和 7 中让文本左对齐，结果影响了其他元素的位置。我重新审视了原始的绝对定位，并为元素添加了边框以显示其位置。这样做表明它完全符合我的定义：行高为 0px 的元素，因此顶部和底部边框彼此相邻。对于 IE6 和 7，我定义了 line-height: 100%; 我的文字几乎在我需要的地方。

再次感谢大家的帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T17:59:34.547

阅读您的帖子时，我的第一个想法是调整行高，但既然您已经这样做了，我不确定还能做多少。从您的总结中，我了解到无法修改设计以考虑大字体。

另一个回答者建议使用像素大小，但我建议使用 em，因为它们是百分比尺寸，并且在浏览器、屏幕和分辨率之间会更加一致。

line-height 可以保留为 0（或将其设置为父元素的高度），但如果文本的高度超过 line-height，您可能会看到文本漂浮在其他元素上。

有什么可能的方式可以使用图像代替文本？这确实是让所有浏览器看起来一致的唯一万无一失的方法。

# asp.net - 为 DNN 页面放置代码

> ID：1002979
> 
> 赞同：2
> 
> 时间：2009-06-16T17:53:21.750
> 
> 标签：asp.net, vb.net, dotnetnuke, code-behind

我很难找到可以为我的 dnn 页面放置代码的位置。

例如：

MyPage.ascx 已经有

```
<%@ Control language="vb" CodeBehind="~/admin/Skins/skin.vb" AutoEventWireup="false" Explicit="True" Inherits="DotNetNuke.UI.Skins.Skin" %> 
```

它需要它才能被投射到皮肤上。

但是，我希望能够添加一个在 Page_Load 上执行的 VB 函数，所以我制作了自己的代码隐藏文件。但是我无法取出当前控件（一个引用 skin.vb）放入我自己的控件中，并且您不能拥有多个控件。

我也尝试将代码嵌入标签中，但我需要做一些导入，这给了我一个错误，说它们必须在文件的开头声明等等......

有人知道如何为 DNN 页面正确添加代码隐藏吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T12:20:05.043

为了使皮肤尽可能独立，我通常在皮肤的 ascx 文件中添加一个脚本块，在皮肤中的所有 HTML 下方（所以它有点不碍事），如下所示：

```
<script runat="server">
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) Handles Me.Load

        If Not Page.IsPostBack Then

            ' first page load logic here

        End If

        ' other page load logic here

    End Sub

    Private Function DoStuff(ByVal input As String) As Integer

        ' custom function logic

    End Function
</script> 
```

如果我的代码需要任何额外的命名空间，我将它们放在皮肤的 ascx 文件的顶部的`import`语句中，如下所示：

```
<%@ import namespace="System.Data" %>
<%@ import namespace="System.Collections.Generic" %>
<%@ import namespace="MyCustomLibrary" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T18:30:35.217

您应该能够添加一个代码隐藏文件，该文件本身继承自`Skin`.

但是，我建议将您的皮肤包含在 .ascx 文件本身中（DNN 皮肤包含代码非常少见）。要添加 Imports，您可以使用[`@ Import`](http://msdn.microsoft.com/en-us/library/eb44kack.aspx)页面中的指令，而不是`Imports`VB 中的语句。

# iis - 在 IIS 上创建新网站：应用程序与虚拟目录。有什么不同？

> ID：1002981
> 
> 赞同：32
> 
> 时间：2009-06-16T17:54:39.783
> 
> 标签：iis

在 IIS 上创建新网站时，您可以在“应用程序”和“虚拟目录”之间进行选择。这两个选项有什么区别？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-16T18:02:16.370

虚拟目录只是指向网页存储位置的指针。

应用程序在 IIS 中为您的网页保留内存。如果您尝试运行 ASP 页面并计划使用会话变量等，那么您必须使用应用程序。应用程序可以使用虚拟目录，也可以只存在于默认网站目录 (inetpub/wwwroot/) 中

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-16T18:02:29.053

有一些区别，这里是最大的：

*   在 IIS 6 及更高版本中，您可以为应用程序分配特定的“保护”级别。（例如保护级别、应用程序池等）。您不能使用虚拟目录执行此操作
*   如果您使用的是 ASP.NET，则为您的应用程序搜索主“Web.config”文件将在您的应用程序级别停止。对于工作目录，它实际上也会检查您的父层次结构的设置。

在我看来，这是两个最大的区别，尽管还有其他一些小区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-13T20:58:37.590

从 Web 开发人员的角度来看：

虚拟目录是用于 HTML 内容的 IIS 5（Windows 2000 和更早版本）容器。还可以配置虚拟目录以允许解释 Active Server Pages (ASP) 脚本和/或执行通用网关接口 (CGI) 应用程序。虚拟目录不能承载 ASP.Net Web 应用程序。

IIS 6（Windows XP / Windows Server 2003 及更高版本）引入了“应用程序”容器类型。它允许托管 ASP.Net Web 应用程序。

# database-design - 在应用程序之间共享用户/客户端/组数据

> ID：1002984
> 
> 赞同：0
> 
> 时间：2009-06-16T17:55:03.447
> 
> 标签：database-design

该场景是两个产品共享相同的用户/客户端/组信息但没有其他公共数据，最佳实践是拥有一个数据库还是两个数据库，其中用户/客户端/组信息定期从一个同步到另一个?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T18:44:59.950

我至少会从共享数据库设计和您为访问数据库而编写的代码开始。

是否要共享实际表取决于产品的部署？您是否要在两个产品的用户群基本相同和/或两个产品由同一个人管理的情况下部署产品，或者它们是否具有不相交的用户群并且维护用户管理由不同的人负责？

编辑：我想你已经在评论中回答了你自己的问题：共享用户表，相同的用户为什么要存储他们的数据两次？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T18:19:49.507

除非您期望用户数据会出现差异，否则我认为没有充分的理由将其存储两次。在[规范化数据库](http://www.bkent.net/Doc/simple5.htm)中，您学习的第一件事是摆脱重复数据。

有两个地方来维护用户数据似乎是多余的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T18:24:34.740

这就是身份验证完全属于数据库之外的 LDAP 服务器的原因。

# sharepoint - SharePoint 中的性能数据分析

> ID：1002986
> 
> 赞同：2
> 
> 时间：2009-06-16T17:55:35.523
> 
> 标签：sharepoint, analysis

市场上是否有任何工具可以有效分析 SharePoint 列表中的数据？我有一个客户希望分析和报告存储在 SharePoint 中的员工绩效数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:24:07.703

[SSRS 能给你带来什么有用的东西](http://www.sharepointblogs.com/dwise/archive/2007/11/28/connecting-sql-reporting-services-to-a-sharepoint-list-redux.aspx)吗？

您只需要报告数据，还是需要复杂的汇总？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:02:59.827

Nintex 报告 SharePoint 本身（并且实际上非常便宜）。报告问题的方式可能是关于共享点列表中的员工数据，因此 SSRS 确实更有意义。

您还可以查看 MOSS Enterprise 附带的一些 BI 功能，例如 KPI Web 部件、记分卡、报告、Excel 服务和仪表板。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T13:20:14.343

除了 SSRS，您还应该考虑使用 Excel 或 Access 来运行报告：-

[在 Excel 中分析 SharePoint 数据](http://technet.microsoft.com/en-us/magazine/2009.02.bookbi.aspx#id0060016) （查找标题为 SharePoint 到 Excel 和数据同步的部分）

[如何将 SharePoint Server 2007 列表与 Microsoft Access 2007 链接](http://sharepoint.microsoft.com/_layouts/error.aspx?aspxerrorpath=/blogs/GetThePoint/Lists/Posts/Post.aspx)

页面当前 borked，缓存版本[http://209.85.229.132/search?q=cache:YnuTwWha77UJ:sharepoint.microsoft.com/blogs/GetThePoint/Lists/Posts/Post.aspx%3FID%3D68+connecting+access+to+分享点+列表&cd=5&hl=en&ct=clnk](http://209.85.229.132/search?q=cache:YnuTwWha77UJ:sharepoint.microsoft.com/blogs/GetThePoint/Lists/Posts/Post.aspx%3FID%3D68+connecting+access+to+sharepoint+lists&cd=5&hl=en&ct=clnk)

请记住，您还可以以 XML 的形式访问列表数据，因此也可以使用任何可以调用[SharePoints Web 服务](http://www.csharphelp.com/archives4/archive602.html)之一并操作生成的 XML 的第 3 方 BI/报告工具 - 这里必须有数百个竞争者。

使用的最佳工具取决于许多因素，例如您可能熟悉的内容、所需分析的复杂性、是否需要静态或动态报告（向下钻取等）。BI 和报告工具是一个*巨大*的领域！

最后，如果您需要相当简单的 PivotTable/crosstab 类型的功能，那么这个[CrossTab Web 部件](http://www.pentalogic.net/crosstab-for-sharepoint.aspx)可能是合适的（*免责声明 - 它由我的公司出售*）

# sql-server - SQL Server - 使用 UNPIVOT 包含 NULL

> ID：1002989
> 
> 赞同：33
> 
> 时间：2009-06-16T17:56:24.537
> 
> 标签：sql-server, tsql, null, unpivot

`UNPIVOT`不会返回`NULL`s，但我需要它们进行比较`query`。我试图避免使用`ISNULL`以下示例（因为在真正的 sql 中有超过 100 个字段）：

```
Select ID, theValue, column_name
From 
(select ID,
  ISNULL(CAST([TheColumnToCompare]  AS VarChar(1000)), '') as TheColumnToCompare
  from MyView
  where The_Date = '04/30/2009'
) MA
UNPIVOT
   (theValue FOR column_name IN 
   ([TheColumnToCompare])
) AS unpvt 
```

有什么选择吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-17T04:52:09.820

要保留 NULL，请使用 CROSS JOIN ... CASE：

```
select a.ID, b.column_name
, column_value = 
    case b.column_name
      when 'col1' then a.col1
      when 'col2' then a.col2
      when 'col3' then a.col3
      when 'col4' then a.col4
    end
from (
  select ID, col1, col2, col3, col4 
  from table1
  ) a
cross join (
  select 'col1' union all
  select 'col2' union all
  select 'col3' union all
  select 'col4'
  ) b (column_name) 
```

代替：

```
select ID, column_name, column_value
From (
  select ID, col1, col2, col3, col4
  from table1
  ) a
unpivot (
  column_value FOR column_name IN (
    col1, col2, col3, col4)
  ) b 
```

具有列模式的文本编辑器使此类查询更易于编写。UltraEdit 有，Emacs 也有。在 Emacs 中，它被称为矩形编辑。

您可能需要为 100 列编写脚本。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-16T19:57:53.953

这是一个真正的痛苦。您必须在 之前将它们切换出去`UNPIVOT`，因为没有生成用于`ISNULL()`操作的行 - 代码生成是您的朋友。

我也有这个问题`PIVOT`。缺失的行变成，如果缺失值与例如相同，则`NULL`必须将其一直包裹在行中。`ISNULL()``0.0`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-04-27T09:55:06.067

我遇到了同样的问题。使用`CROSS APPLY`（SQL Server 2005 及更高版本）而不是`Unpivot`解决问题。我根据这篇文章[An Alternative (Better?) Method to UNPIVOT](http://www.sqlservercentral.com/articles/CROSS+APPLY+VALUES+UNPIVOT/91234/)找到了解决方案， 并制作了以下示例来演示 CROSS APPLY 不会忽略 NULL 之类的`Unpivot`。

```
create table #Orders (OrderDate datetime, product nvarchar(100), ItemsCount float, GrossAmount float, employee nvarchar(100))

 insert into #Orders
 select getutcdate(),'Windows',10,10.32,'Me'
 union 
 select getutcdate(),'Office',31,21.23,'you'
 union 
 select getutcdate(),'Office',31,55.45,'me'
 union  
 select getutcdate(),'Windows',10,null,'You'

SELECT OrderDate, product,employee,Measure,MeasureType
 from #Orders orders
 CROSS APPLY (
    VALUES ('ItemsCount',ItemsCount),('GrossAmount',GrossAmount)
    ) 
    x(MeasureType, Measure) 

SELECT OrderDate, product,employee,Measure,MeasureType
from #Orders orders
UNPIVOT
   (Measure FOR MeasureType IN 
      (ItemsCount,GrossAmount)
)AS unpvt;

 drop table #Orders 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-10-14T09:55:48.387

或者，在 SQLServer 2008 中以更短的方式：

```
...
cross join 
(values('col1'), ('col2'), ('col3'), ('col4')) column_names(column_name) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-08T02:44:08.630

我发现左外部将 UNPIVOT 结果加入到完整的字段列表中，方便地从 INFORMATION_SCHEMA 中提取，在某些情况下可以实际解决这个问题。

```
-- test data
CREATE TABLE _t1(name varchar(20),object_id varchar(20),principal_id varchar(20),schema_id varchar(20),parent_object_id varchar(20),type varchar(20),type_desc varchar(20),create_date varchar(20),modify_date varchar(20),is_ms_shipped varchar(20),is_published varchar(20),is_schema_published varchar(20))
INSERT INTO _t1 SELECT 'blah1', 3, NULL, 4, 0, 'blah2', 'blah3', '20100402 16:59:23.267', NULL, 1, 0, 0 

-- example
select c.COLUMN_NAME, Value
from INFORMATION_SCHEMA.COLUMNS c
left join (
  select * from _t1
) q1
unpivot (Value for COLUMN_NAME in (name,object_id,principal_id,schema_id,parent_object_id,type,type_desc,create_date,modify_date,is_ms_shipped,is_published,is_schema_published)
) t on t.COLUMN_NAME = c.COLUMN_NAME
where c.TABLE_NAME = '_t1'
</pre> 
```

输出看起来像：

```
+----------------------------------+----------+
| COLUMN_NAME | 价值 |
+----------------------------------+----------+
| 姓名 | 废话1 |
| object_id | 3 |
| principal_id | 空 | <======
| schema_id | 4 |
| parent_object_id | 0 |
| 类型 | 废话2 |
| 类型描述 | 废话3 |
| 创建日期 | 20100402 16:59:23.26 |
| 修改日期 | 空 | <======
| is_ms_shipped | 1 |
| is_published | 0 |
| is_schema_published | 0 |
+----------------------------------+----------+

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-09T17:30:15.330

使用动态 SQL 和 COALESCE，我解决了这样的问题：

```
DECLARE @SQL NVARCHAR(MAX)
DECLARE @cols NVARCHAR(MAX)
DECLARE @dataCols NVARCHAR(MAX)

SELECT 
    @dataCols = COALESCE(@dataCols + ', ' + 'ISNULL(' + Name + ',0) ' + Name , 'ISNULL(' + Name + ',0) ' + Name )
FROM Metric WITH (NOLOCK)
ORDER BY ID

SELECT 
    @cols = COALESCE(@cols + ', ' + Name , Name )
FROM Metric WITH (NOLOCK)
ORDER BY ID

SET @SQL = 'SELECT ArchiveID, MetricDate, BoxID, GroupID, ID MetricID, MetricName, Value
            FROM 
               (SELECT ArchiveID, [Date] MetricDate, BoxID, GroupID,  ' + @dataCols + '
                FROM MetricData WITH (NOLOCK)
                INNER JOIN Archive WITH (NOLOCK)
                    ON ArchiveID = ID
                WHERE BoxID = ' + CONVERT(VARCHAR(40), @BoxID) + '
                AND GroupID = ' + CONVERT(VARCHAR(40), @GroupID) + ') p
            UNPIVOT
               (Value FOR MetricName IN 
                  (' + @cols + ')
            )AS unpvt
            INNER JOIN Metric WITH (NOLOCK)
                ON MetricName  = Name
            ORDER BY MetricID, MetricDate'

EXECUTE( @SQL ) 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-10-10T17:22:58.797

ISNULL 是答案的一半。使用 NULLIF 转换回 NULL。例如

```
DECLARE @temp TABLE(
    Foo varchar(50),
    Bar varchar(50) NULL
    );

INSERT INTO @temp( Foo,Bar )VALUES( 'licious',NULL );

SELECT * FROM @temp;

SELECT 
    Col,
    NULLIF( Val,'0Null' ) AS Val 
FROM(
    SELECT
        Foo,
        ISNULL( Bar,'0Null' ) AS Bar
    FROM
        @temp
    ) AS t
UNPIVOT(
    Val FOR Col IN(
        Foo,
        Bar 
        )
    ) up; 
```

这里我使用“0Null”作为我的中间值。你可以使用任何你喜欢的东西。但是，如果您选择诸如“Null”之类的真实世界的内容，则可能会与用户输入发生冲突。垃圾可以正常工作“！@#34())0”，但可能会让未来的编码人员更加困惑。我相信你明白了。

# .net - .NET 中的多重继承

> ID：1002996
> 
> 赞同：-2
> 
> 时间：2009-06-16T17:57:34.397
> 
> 标签：.net

你认为 .NET 有多重继承吗？为什么？

是的，我知道从定义上讲不是，但我有不止一个人争辩说，因为你可以继承多个接口而不是它。我知道这是一个非常主观的问题（因此是标签），但我希望对此有更多的看法。

**编辑**我不是在问你是否认为它应该有多重继承，我也不是说你继承接口。我想在我的问题中表达的是，我听到几个人的争论不是这样，我只是想就此获得更多意见。我完全期望 99% 的答案是“否”，但就像我说的那样，我想要更多的输入。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-16T17:59:31.567

“接口”不是继承的，而是指定您必须实现什么才能正确实现接口定义。继承意味着行为的可能变化——父类定义了一些东西，子类扩展了它。

.NET 允许您在父列表（冒号右侧）中拥有一个类，因此支持单一继承，但您可以随意实现任意数量的接口。

我也不同意“主观”标签，.NET 中允许单一继承的设计决策绝对没有主观性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T18:02:10.037

.NET（或至少 C#）的设计者决定不包含多重继承。要说它包含它，您必须更改多重继承的定义，此时您几乎可以说任何东西都包含多重继承。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T18:02:18.817

多个接口不是多重继承。接口不是继承的，它们是被实现的。

不同之处在于接口只提供一组公共的方法和属性，这些方法和属性定义了调用代码和实现类之间的契约。继承更多的是扩展现有类或更改后台实现。

# c++ - 哪些 Windows C++ IDE 支持新的 C++0X 标准？

> ID：1002998
> 
> 赞同：3
> 
> 时间：2009-06-16T17:57:43.303
> 
> 标签：c++, windows, ide, c++11

除了visual .net 2010（测试版太慢/笨拙）之外，还有哪些优秀的C++ IDE选项支持新标准c++0x（windows os友好）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:59:41.443

虽然不支持完整的 C++0x 标准，但 TR1 的大部分内容都包含在[Visual Studio 2008 的 SP1 更新中](http://www.microsoft.com/downloads/details.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E&displaylang=en)。SP1 更新包括去年发布的[功能包。](http://blogs.msdn.com/vcblog/archive/2008/04/07/visual-c-2008-feature-pack-released.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-29T19:47:25.833

现在，在提出问题两年后，VisualStudio 2010 支持以下核心语言功能。

1.  Lambda 函数
2.  右值引用（移动语义和完美转发）。
3.  类型推断 (`auto`和`decltype`)
4.  `nullptr`
5.  尾随返回类型规范`auto f() -> int`
6.  `static_assert`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T18:09:04.360

您的问题是支持 C++0x 规范的编译器很少。具体来说，g++ 还没有出现，在 g++ 出现之前不会有任何完全支持 C++0X 的 FOSS IDE。