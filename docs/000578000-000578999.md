# StackOverflow 问答 000578000-000578999

# java - JTextPane 不断抛出 BadLocation

> ID：578000
> 
> 赞同：1
> 
> 时间：2009-02-23T15:28:53.323
> 
> 标签：java, swing, syntax-highlighting, jtextpane

我有一个包含 JTextPane 的 JFrame。这个 JTextPane 的目的是在我键入单词时突出显示它们，类似于程序员的文本编辑器。为了实现这一点，我扩展了 JTextPane，实现了**KeyListener**接口，并将它设置为self的**关键侦听器。**做一些重要工作的方法是**keyReleased**。问题是，我可以突出显示我输入的第一个单词，但在那之后，我不断收到 BadLocation，即使**开头**和**结尾**都在文档限制内。我发布了一些我的代码片段：

```
 // this is my highlight method
private void highlight(int start,int end) throws BadLocationException {
      Document doc = getDocument();
      Color c = Color.red;
      String text = doc.getText(start,end);
      StyleContext sc = StyleContext.getDefaultStyleContext();
      AttributeSet aset = sc.addAttribute(SimpleAttributeSet.EMPTY, StyleConstants.Foreground, c);
      setCharacterAttributes(aset, true);
      setSelectionStart(start);
      setSelectionEnd(end);
      replaceSelection(text);
}

//this is my keyReleased method
public void keyReleased(KeyEvent arg0) {
        char character = arg0.getKeyChar();
        if(wordStarted) { // have I started typing a new word ?
            if(character == ' ') { // end word
                try {
                    int dot = getCaret().getDot();
                    highlight(wordStart, dot - 1);
                    setCaretPosition(dot);
                    wordStarted = false;
                } catch (BadLocationException ex) {
                    ex.printStackTrace();
                }
            }
        }
        else {
            if(Character.isLetter(character)) {
                wordStarted = true;
                wordStart = getCaret().getDot() -1;
            }
        }
    } 
```

我试图输入：**public static**但只有**public**是红色的。我什至添加了一些 println 语句进行调试，这是输出：

```
这是写public后输出的
启动参数：0
结束参数：6
文件长度：7
文档开始：0
文件结束：8
文字：公开

这是写静态后输出的
启动参数：7
结束参数：13
文件长度：14
文档开始：0
文件结束：15
文本：公共静态
javax.swing.text.BadLocationException：位置无效
        在 javax.swing.text.GapContent.getChars(GapContent.java:189)
        在 javax.swing.text.GapContent.getString(GapContent.java:167)
        在 javax.swing.text.AbstractDocument.getText(AbstractDocument.java:774)
        在 ifirst.visual.CodePanel.highlight(CodePanel.java:49)
        在 ifirst.visual.CodePanel.keyReleased(CodePanel.java:82)
        在 java.awt.Component.processKeyEvent(Component.java:6069)
        在 javax.swing.JComponent.processKeyEvent(JComponent.java:2810)
        在 java.awt.Component.processEvent(Component.java:5885)
        在 java.awt.Container.processEvent(Container.java:2105)
        在 java.awt.Component.dispatchEventImpl(Component.java:4469)
        在 java.awt.Container.dispatchEventImpl(Container.java:2163)
        在 java.awt.Component.dispatchEvent(Component.java:4295)
        在 java.awt.KeyboardFocusManager.redispatchEvent(KeyboardFocusManager.java:1881)
        在 java.awt.DefaultKeyboardFocusManager.dispatchKeyEvent（DefaultKeyboardFocusManager.java:742）
        在 java.awt.DefaultKeyboardFocusManager.preDispatchKeyEvent（DefaultKeyboardFocusManager.java:1007）
        在 java.awt.DefaultKeyboardFocusManager.typeAheadAssertions（DefaultKeyboardFocusManager.java:879）
        在 java.awt.DefaultKeyboardFocusManager.dispatchEvent（DefaultKeyboardFocusManager.java:706）
        在 java.awt.Component.dispatchEventImpl(Component.java:4339)
        在 java.awt.Container.dispatchEventImpl(Container.java:2163)
        在 java.awt.Window.dispatchEventImpl(Window.java:2478)
        在 java.awt.Component.dispatchEvent(Component.java:4295)
        在 java.awt.EventQueue.dispatchEvent(EventQueue.java:604)
        在 java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:275)
        在 java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:200)
        在 java.awt.EventDispatchThread.pumpEventsForHierarchy（EventDispatchThread.java:190）
        在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:185)
        在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:177)
        在 java.awt.EventDispatchThread.run(EventDispatchThread.java:138)

```

我正在编写此代码以了解 JTextPane。我对**JTextPane 之**类的东西不感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T15:54:51.360

正如您所发现的，[Document.getText()](http://java.sun.com/javase/6/docs/api/javax/swing/text/Document.html#getText(int,%20int))采用 start 和*length*，而不是 start 和*end*参数。我想我会为阅读您的问题但可能不会在评论中查看的其他人提供一个答案和指向 JavaDoc 的链接。

# java - 无法从 Groovy 调用 Web 服务

> ID：578003
> 
> 赞同：1
> 
> 时间：2009-02-23T15:29:30.983
> 
> 标签：java, web-services, soap, groovy

我正在浏览新的[Java Web Services: Up and Running](https://rads.stackoverflow.com/amzn/click/com/059652112X)一书中的第一个示例。我试图通过第 13 页上的 Java SOAP 客户端示例，但在 Groovy 中。

所以这是我的 Groovy shell 代码：

```
import javax.xml.namespace.QName
import javax.xml.ws.Service
import java.net.URL

url = new URL("http://someURL?wsdl")
qname = new QName("http://someURL", "SomeURLImplService")
service = Service.create(url, qname) 
```

但这失败并出现此错误：

```
ERROR groovy.lang.MissingMethodException: No signature of method: \
static javax.xml.ws.Service.create() is applicable for argument types: \
(java.net.URL, javax.xml.namespace.QName) values: {http://someURL?wsdl, \
{http://someURL}SomeURLImplService} 
```

我不明白这一点，因为 Groovy 告诉我这个带有该签名的方法确实存在：

```
groovy:000> Service.class.getMethods().each {println it}
public static javax.xml.ws.Service \
javax.xml.ws.Service.create(java.net.URL,javax.xml.namespace.QName)
... 
```

有人知道我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T14:35:40.543

我尝试不加修改地运行您的代码，它对我来说效果很好。您的问题可能与 Java 版本或类路径有关。javax.xml.ws (JAX-WS) 只是从 Java 6 开始的 Java SE 的一部分。如果您没有在 Java 6 中运行此测试，那可能是您的问题。这可能不是您的问题，因为如果您不是，我不希望您能够解决这些接口。

另一件事可能是类路径问题。可以将外部 JAX-WS 提供程序插入 Java 运行时。您的类路径中有 JAX-WS 提供者吗？也许它是一个更早的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T14:11:05.197

我再次尝试手动下载 Groovy（而不是使用 Ubuntu 附带的发行版）。现在它起作用了。去搞清楚。

# visual-c++ - C++ 模板：好的 VC2005SP1，gcc 退出？

> ID：578008
> 
> 赞同：1
> 
> 时间：2009-02-23T15:30:42.570
> 
> 标签：visual-c++, gcc, templates

我在这里很困惑，恳请您的帮助。VC2005SP1 吞下了这个（剥离的）代码，但 gcc 4.0.1 退出了……请指出明显的错误？蒂亚！

```
template<typename BCT, typename UIDT>
class Factory
{
public:
    template<typename CT>
    bool Register(UIDT UniqueID)
    {
        if (UniqueID > 10)
            return(false);

        CreateObject2<BCT, CT>;

        return(true);
    }
};

template <typename MC, typename MT>
class Manager : public Factory<MC, MT>
{
public:
    bool RegisterType(const MT Type, const std::string TypeName)
    {
        return Factory<MC, MT>::Register<MC>(Type); // gcc claims "expected primary-expression before '>' at this point
    }
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T15:32:47.917

VS很友善。

`return Factory<MC, MT>::template Register<MC>(Type);`应该在两个编译器下工作。

# svn - SVN：如何重新创建已创建但尚未提交的目录

> ID：578009
> 
> 赞同：3
> 
> 时间：2009-02-23T15:30:43.850
> 
> 标签：svn, directory, mkdir

这里有个小`SVN`问题：

我在本地创建一个目录：

```
$ svn mkdir output
A         output 
```

我不小心删除了它：

```
rm -rf output 
```

现在，我该如何重新创建它？我试过这个：

```
$ svn mkdir output
svn: 'output' is already under version control 
```

还有这个：

```
$ svn revert output
Reverted 'output' 
```

但它仍然不存在。

**更新：**人们建议`mkdir output`删除它后简单应该就足够了。但在我的 SVN 版本中，情况并非如此。`output/.svn`它忽略了我也删除了一个目录这一事实。只是`mkdir output`不会把那个带回来，当然。所以，不知何故，SVN 必须参与该`output` 目录的重新创建。（我使用的是 SVN 1.4.6。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T15:32:27.997

在 SVN 中正式删除它：

```
$  svn rm --force output
svn: 'output' does not exist 
```

然后再次创建它：

```
$ svn mkdir output 
A         output 
```

上面的输出`svn remove`有点误导。我认为删除失败了，它不会改变任何东西。

这不是 SVN 最直观的方法，但它是这样工作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T15:35:18.833

`mkdir output`应该就够了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:35:46.303

您也可以尝试使用重新创建目录`mkdir`。

`svn mkdir`创建目录并执行与 , 等效的操作`svn add`，但只需一步。

所以你遇到问题的原因是因为已经完成了“添加”。由于您没有提交，所以 revert 不会做任何事情，并且`svn mkdir`不会工作，因为 Subversion 已经列出了在下一次提交时添加的目录（因为您`rm`在 Subversion 之外）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T15:50:29.887

需要了解的是 SVN 维护的目录和本地文件系统维护的目录之间的区别。

在您的原始帖子中发出的四个命令执行以下操作

1.  告诉 SVN 您希望将名为“输出”的目录添加到 SVN 存储库 - 它通过将该信息添加到其“更改列表”来响应
2.  从本地文件系统中删除“输出” - SVN 不知道发生了这种情况
3.  告诉 SVN 您希望将一个名为“输出”的目录添加到 SVN 存储库 - 它会抱怨，因为“你已经告诉我了！​​”
4.  告诉 SVN，您已经改变了添加“输出”目录的想法——它通过从其“更改列表”中删除该信息来强制执行

如果您只是发布...

```
mkdir output 
```

...作为您的第三步，一切都会好起来的 - 使用文件系统删除了目录，因此应该使用文件系统恢复它。没有理由让 SVN 参与修复，正如您所发现的，尝试这样做只会使事情变得混乱。

高温高压

# c# - 在.Net中过滤DataGridView行

> ID：578010
> 
> 赞同：1
> 
> 时间：2009-02-23T15:30:50.060
> 
> 标签：c#, .net, datagridview, user-interface, filter

我有一个显示对象列表（不是数据集）的 DataGridView。有没有一种简单的方法来设置过滤器，所以 DGV 将只显示与过滤器匹配的行？

```
IList<T> log = ...;
dgv.DataSource = log; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T15:32:50.647

你有可用的 LINQ 吗？如果是这样，一种选择是：

```
dgv.DataSource = log.Where(x=>x.IsActive && x.Type == 3).ToList(); 
```

但是，新/删除的行不会更新原始列表（对现有行的编辑很好）。

如果不是 LINQ，您可以使用以下方法执行相同操作`List<T>.FindAll`：

```
dgv.DataSource = log.FindAll(delegate (SomeType x) {
    return x.IsActive && x.Type == 3;}); 
```

有`IBindingListView.SupportsFiltering`/`IBindingListView.Filter`对，但没有一个标准列表（包括`BindingList<T>`）实现此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T15:32:20.243

如果我无法`Log.Where(filter)`控制生成，这通常是我过滤绑定到 DGV 的列表中的项目的方式。

# ruby - 没有打开端口的 Ruby 网络服务器

> ID：578011
> 
> 赞同：1
> 
> 时间：2009-02-23T15:30:55.193
> 
> 标签：ruby

我正在寻找让基于 ruby​​ 的网络服务器通过管道而不是 TCP/IP 进行通信的可能性。所以我将通过管道发送 HTTP 请求，并且我想通过管道读取响应。它应该用作桌面应用程序的捆绑/内部网络服务器（RPC 或其他东西）。当我的应用程序的更多实例在同一台机器上运行时，我不想处理端口配置。

有任何想法吗？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T17:51:00.550

尝试一个`UNIXSocket` 您使用本地路径来指定套接字连接的位置，而不是端口，并且您可以轻松处理多个同时连接。

```
# server.rb
require 'socket'
File.delete( filename ) if File.exists? filename
server = UNIXServer.open( filename )
server.listen( queuesize )

puts "waiting on client connection"
while client= server.accept
  puts "got client connection #{client.inspect}"

  child_pid = fork do 
    puts "Asking the client what they want"
    client.puts "Welcome to your server, what can I get for you?"
    until client.eof?
      line = client.gets
      puts "The client wants #{line.chomp.inspect}"
    end
    client.close
  end

  puts "running server (#{child_pid})"
  client.close
  Process.detach(child_pid)
end

server.close

# client.rb
require 'socket'
puts "requesting server connection"
server = UNIXSocket.new( filename )
puts "got server connection #{server}"
line = server.gets
puts "The server said: #{line.chomp.inspect}"
%w{ a-pony a-puppy a-kitten a-million-dollars }.each do |item|
  server.puts item
end
server.close 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T16:05:17.573

管道用于单向通信，因此您无法在其上设置网络服务器。您可以尝试使用 unix 套接字。但真正最简单的解决方案是使用环回（127.0.0.1）。它经过高度优化，因此速度不会成为问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T15:34:10.427

不是你的问题的答案。但是，如果您最终不得不使用 TCP/IP HTTP 服务器，您应该确保它只监听 127.0.0.1。侦听本地主机地址应该非常快，因为它不会访问网络，并且还可以更安全地阻止人们从外部连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T19:58:59.353

Thin 支持 unix 套接字。

# c++ - 是否可以在 Windows 上静态链接 Qt::phonon？

> ID：578021
> 
> 赞同：0
> 
> 时间：2009-02-23T15:32:50.757
> 
> 标签：c++, qt, linker, phonon

由于依赖于 Windows 上的 DirectShow，是否可以在我的应用程序中使用静态 Qt？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T17:30:44.857

如果您静态链接 Qt 并希望分发您的应用程序，您很可能需要商业许可证。LGPL 许可证（免费使用 Qt）实际上要求您动态链接 Qt。

# mysql - 在多个数据库中更改表

> ID：578027
> 
> 赞同：1
> 
> 时间：2009-02-23T15:34:04.013
> 
> 标签：mysql

我有一组数据库，每个数据库都包含一个名为“数据”的表。我想在所有数据库中的表“数据”中添加一个新列。是否可以使用 sql 语句执行此操作？它可以在 MySQL 3.x 服务器上运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T15:51:04.830

据我所知，您必须对每个数据库的每个表执行“更改表”。

# algorithm - 是否有邻近图算法或数据结构？

> ID：578031
> 
> 赞同：2
> 
> 时间：2009-02-23T15:34:32.733
> 
> 标签：algorithm, data-structures, floating-point

在编写绘制科学数据图像的代码时，我一直遇到的问题如下：

给定一些浮点数据，将这些数据放入槽（一维情况）或网格（二维情况）中，以使每个数据位于槽或网格条目中，其值最接近基准值。

槽/网格值不是均匀分布的。

例如，将以下数据放入以下插槽：

数据：0.1、0.6、4.23、5.1、7.0

插槽：0.0、0.4、0.6、1.2、5.0、10.0

在实践中，数据远远多于插槽。因此，拥有一个将缓存中的插槽保持在一起的数据结构将是有益的。

更好的是像树或哈希表这样的东西，您可以在其中向树询问与键对应的值，但草率的比较会产生最接近的匹配。

这样的野兽存在吗？

（现在，我只有进行大量比较的循环。看起来我至少可以通过对插槽使用二进制搜索来做得更好，不过......）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T15:38:34.707

看看[kd 树](http://en.wikipedia.org/wiki/Kd-tree)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T15:46:39.850

对于 2D 情况，我会推荐大多数计算几何文本都涵盖的[Voronoi 图](http://en.wikipedia.org/wiki/Voronoi_diagram)

# php - 如何删除 CSV 文件中的第一行（列标题）？

> ID：578037
> 
> 赞同：4
> 
> 时间：2009-02-23T15:35:50.047
> 
> 标签：php, csv

我已经编写了一个脚本，它将上传一个 CSV 文件，然后将数据提取到一个已经制作好的表格中。我想让它第一行（列标题）不会被插入到表中，但其余的数据会被插入。

```
 $fp = fopen($_SESSION['filename'],"r");

while (($data = fgetcsv($fp, 1000, ",")) !== FALSE)

{
    $import="INSERT into csv_table(name,address,age) values('$data[0]','$data[1]','$data[2]')";

    mysql_query($import) or die(mysql_error());

}

fclose($fp); 
```

这是我用来从 csv 文件中提取数据的代码的一部分。

非常感谢您对此事的任何帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-23T15:38:26.967

只需将以下内容放在`while`循环之前即可读取第一行：

```
fgetcsv($fp, 1000, ","); 
```

此后`while`循环从第二行开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T15:38:27.123

深思熟虑。

在外部创建一个布尔标志，并在进入循环而不是导入时切换它，使用 if 语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:41:01.720

只需像这样进行空白阅读：

```
$fp = fopen($_SESSION['filename'],"r");
$headerLine = true;

while (($data = fgetcsv($fp, 1000, ",")) !== FALSE)

{
        if($headerLine) { $headerLine = false; }
        else {
                $import="INSERT into csv_table(name,address,age) values('$data[0]','$data[1]','$data[2]')";

                mysql_query($import) or die(mysql_error());
        }

}

fclose($fp); 
```

# php - PHP文件上传

> ID：578054
> 
> 赞同：0
> 
> 时间：2009-02-23T15:39:41.427
> 
> 标签：php, mysql, file, upload

我正在尝试使用 php 将文件上传到我的服务器，以将它们以二进制形式保存到我的 mysql 数据库中，但我无法让它工作，这是我正在使用的脚本，我相信它与“$_FILES”有关" 因为当我把它取出 "&& $_FILES['userfile']['size'] > 0" 时，脚本开始运行，但是下面使用 "$_FILES" 的变量没有定义。

```
if(isset($_POST['upload']) && $_FILES['userfile']['size'] >  0) {
$fileName = $_FILES['userfile']['name'];
$tmpName  = $_FILES['userfile']['tmp_name'];
$fileSize = $_FILES['userfile']['size'];
$fileType = $_FILES['userfile']['type'];

$fp      = fopen($tmpName, 'r');
$content = fread($fp, filesize($tmpName));
$content = addslashes($content);
fclose($fp);

if(!get_magic_quotes_gpc())
{
    $fileName = addslashes($fileName);
}

db_connect();
db_select();

$query = "INSERT INTO upload (name, size, type, content ) ".
"VALUES ('$fileName', '$fileSize', '$fileType', '$content')";

mysql_query($query) or die('Error, query failed');
db_disconnect();

echo "<br>File $fileName uploaded<br>";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T15:49:40.717

您最好使用[文件上传状态](http://docs.php.net/manual/en/features.file-upload.errors.php)来检查上传是否成功。

并且不要将该`addslashes`函数用于 MySQL 查询。改为使用[`mysql_real_escape_string`](http://docs.php.net/manual/en/function.mysql-real-escape-string.php)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T21:24:44.110

这是一个 2 折过程，首先是上传本身，然后是服务器上的操作。第一个验证是确保文件已上传。为此，您可以在行后使用

```
$fileName = $_FILES['userfile']['name']; 
```

采用：

```
if(is_uploaded_file($fileName)) {
  // Here goes all the file manipulation/storage/etc
} else {
  echo 'Error: File could not be uploaded.';
} 
```

尝试使用它，如果文件实际已上传，则可能重新发布。仅仅因为 $_FILES 有内容并不一定意味着文件已上传到服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T15:53:35.060

如果您使用表格上传文件，“表格”标签中是否有“enctype =“multipart/form-data”？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T15:43:26.830

我假设您发布的字段名为“userfile”？

此外，这与您的问题没有直接关系，但通常认为将文件存储在文件系统而不是 MySQL 中是一种更好的做法。文件系统旨在存储大块二进制数据，而数据库则不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T15:53:43.110

我从您的示例中假设您的输入名称是`upload`. `<input type="file" />`PHP 中的结果未排序，`$_POST`而是在`$_FILES`. 文档将`$_FILES['userfile']`其用作示例字段，但如果您的输入声明为`<input type="file" name="upload" />`，您应该简单地使用`$_FILES['upload']`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-07T13:09:05.910

尝试 make **print_r( $FILES )**并定义问题所在。也许表格不需要类型？

# time-management - 你能建议什么学习习惯？

> ID：578056
> 
> 赞同：5
> 
> 时间：2009-02-23T15:39:56.060
> 
> 标签：time-management

我们的职业往往需要深度学习；坐下来阅读，理解。我目前正在考试期间，我正在寻找更有效地学习的方法。

我不是在问要学什么，或者是否更喜欢博客而不是书籍等。我的问题比这更实际-

**当你需要学习时，你会做什么，我的意思是努力学习？**

我正在寻找答案，例如

*   我将我的时间分成 2.5 小时的间隔，并在它们之间休息一下，但从不在中间。
*   我在附近放了一罐水。
*   我在 6 点整起床，并在健身房锻炼开始新的一天。

***有什么好的学习习惯，或者希望你已经获得了？***

（我知道这与编程无关，但与程序员有关）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T15:44:35.080

我发现为学习做好准备的最佳方法是：

*   多运动多休息
*   均衡饮食，少糖和咖啡因
*   试着找一个有利于集中注意力的安静区域
*   试着实践你从书本上学到的东西——**理论是可以的，但实践会嵌入知识**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-23T15:47:38.677

“测试你是否知道某事的最好方法是尝试从头开始向其他人解释它。”

这一定是我得到的关于知道我是否真的知道某事的最佳想法之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T15:43:29.670

我每天或每周留出 x 次时间。否则我永远不会这样做。我尝试每隔一段时间设置一个不同的位置（家/咖啡店/在办公室呆到很晚），让乏味远离。我对我使用的音乐很小心，尽量确保它是放松的 有时即使音乐关闭，我也会戴上耳机，这样人们就不会和我说话了。我在每次休息前或每次训练时都会给自己设定具体的目标。我奖励自己

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T15:46:11.053

*   确保您周围安静舒适。
*   吃饱喝足
*   不只是阅读，而是做笔记，绘制思维导图等
*   不要只是阅读，而是尝试
*   根据所学内容制作报告、博客条目、演示文稿
*   从不同的来源学习相同的东西：不要只相信 A 人所说的话 寻找、阅读和理解 B 和 C 的意见，并理解差异。
*   不以为然
*   将知识应用到实际项目中

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T15:58:55.437

阅读 Andy Hunt 的[“Pragmatic Thinking and Learning”](https://rads.stackoverflow.com/amzn/click/com/1934356050) ——那里有很多好的建议。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T16:11:27.043

托尼·布赞（Tony Buzan）写了[《思维导图书》](http://www.amazon.com/s/ref=nb_ss_b?url=search-alias%3Dstripbooks&field-keywords=The+Mind+Map+Book&x=0&y=0)，描述了他记笔记的想法。他还有一些我觉得很有帮助的流程想法。最重要的是：学习新材料一个小时，然后休息一下（5-10 分钟），然后复习新材料。一个小时后再次复习新材料，然后是两个小时后，然后是第二天。您需要在一段时间内多次刷新您对材料的接触才能真正吸收它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T05:26:50.550

在阅读时，我确保在继续之前完全理解文本中的每个部分。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-16T16:14:44.167

设定一个时间，带走所有的干扰。在家/宿舍可能很粗糙，所以我会在大学期间使用图书馆。开始通常是最难的部分，所以不要为何时退出设定具体的时间限制。这很让人分心，你会看你的时钟，看看“你还有多久”。你不想处于那种心态。工作直到你觉得你的大脑开始失去焦点，无论是缺乏理解还是不得不反复重读简单的段落。休息一两分钟，然后重新集中注意力。当它停止工作时，是真正休息的时候了。

你是夜猫子还是早起的鸟儿？每个人都是不同的。一大早我的工作效率很高，而我的妻子几乎不能正常工作。我们都有差异，所以不要试图与你的本性抗争。

+1 其他人所说的话。制作备忘单/笔记是我学习习惯中非常重要的一部分，无论我是否可以在考试中使用它们。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T16:16:57.610

我发现最好在开始之前全神贯注于这项任务。如果你做一些士气低落的事情，你就不会做好。如果你以高昂的士气去完成一项任务，你会更快地理解事物，能够更好地将其应用到实际情况中，并且会有更深的理解。如果我没有完全专注，我什至不会打扰。我的时间有更好的事情要做，而不是半途而废，你可能也会这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-25T17:10:42.940

扩展我留下的评论，请参阅几年前电子设计的这篇文章：[http](http://electronicdesign.com/Articles/Index.cfm?AD=1&ArticleID=5859) ://electronicdesign.com/Articles/Index.cfm?AD=1&ArticleID=5859 。

如果你能教你学到的东西，你就知道了。

* * *

路易斯·[弗伦泽尔](http://electronicdesign.com/Authors/AuthorID/1010/1010.html)

所有的学习都是自学。教授、培训师和所有教师只是组织和展示要学习的材料。他们不教你。你学习它。你是真正通过听讲座、阅读、思考、解决问题和其他活动来吸收、理解和吸收知识的人。自学是一种自然的、人类的品质。虽然你们中的大多数人过去都使用过这种方法，但您可能希望在更正式的基础上使用它来加快和微调您的方法。这是一个建议的方法（相信我，你必须把它写下来）：

1.  清楚地确定你想学什么。把它写出来。

2.  为自己写一些学习目标。这些陈述清楚地表明了您想知道和能够做什么。例如，您应该写类似“当我完成这项学习任务后，我将能够设计和编程 FIR DSP 滤波器”。目标应该用“行为”术语来表达，也就是说，使用陈述一些可衡量结果的词语。

3.  确定一些初始资源。从当地书店的书籍开始，或访问 www.Amazon.com 或 www.barnesandnoble.com 上的 Barnes & Noble。大多数城市没有好的技术书店，在正规书店很难找到任何东西。如果您有一家好的技术书店或一家好的大学书店，请认为自己很幸运。计划购买多本书，通过多种解释、示例和观点为您提供更广泛的覆盖范围。不要忘记浏览你的杂志过刊。

4.  查看在线资源。进行一项或多项 Web 搜索，或访问相关的公司网站。您可能会遇到合适的教程、白皮书或应用说明，它们将为您提供所需的内容。大型半导体和设备制造商在他们的网站上有大量的东西，所以开始挖掘吧。另请查看表格和侧边栏中列出的专业协会和其他来源。

5.  留意有关此主题的任何会议或研讨会。通常，此类事件在您需要时永远不会发生，但您可能会很幸运。如果您找到了，请参加，因为它将为您自己的学习提供一个很大的开端。

6.  整理你的材料。布置它们，标记它们，然后根据您的目标制作大纲。看看你有什么和你缺乏什么，并列出要做的事情的初始清单。

7.  深入研究。每天留出一个小时或任何你可以阅读的材料。关闭收音机、CD 播放器和电视。养成找一些安静的时间阅读和学习的习惯。

8.  寻找人类导师。您可能正在与您正在尝试学习的主题的专家一起工作。选择他或她的大脑。询问此人是否会帮助您理解和学习。带这个人吃午饭或提供支付课程费用。大多数人会很乐意分享他们所知道的，如果你不太自豪地问的话。做到这一点的最好方法是尽可能多地自己学习。然后，在遇到难题或遇到困难时寻求专业的个人帮助。

9.  包括一些动手操作。您可以购买或组装任何硬件来帮助您学习它吗？也许有一些软件会有所帮助。买它或让你的雇主买它。

10.  写一篇论文或文章或教授您所学的内容。您必须了解它才能编写或教授它。没有比必须向他人解释更好的方式来为自己学习。

* * *

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-25T17:11:26.777

我通常发现在我进行时构建“备忘单”或其他形式的摘要很有用。

一方面，它迫使我重新解释信息并弄清楚什么是真正重要的。

另一方面，我正在为最后一分钟的修订或未来的知识更新构建一个有用的学习工具。

2.5 小时不休息似乎很多。尝试不同的时间段，看看什么效果最好（个人而言，3x（20 次工作 - 5 次休息）的序列效果很好）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-05-01T18:52:42.313

番茄时间管理技巧

[http://pomodorotechnique.com/get-started/](http://pomodorotechnique.com/get-started/) （观看“如何”标签）

和代码（程序员）

```
while(day) {
        for (int i = 0; i < 4; i++) {
            work(25);
            relax(i < 3 ? 5 : 15);
        }
} 
```

你应该实现方法

```
void work(int minutes);
void relax(int minutes); 
```

来自其他线程的可变日期更改

# iphone - 调整 UIWebView 大小时抗锯齿不起作用

> ID：578057
> 
> 赞同：4
> 
> 时间：2009-02-23T15:39:57.697
> 
> 标签：iphone, uiwebview, antialiasing

我想以 60% 的比例将 Web 视图添加到我的应用程序中（就像在 Safari 中浏览其他窗口视图中看到的那样）：

[![替代文字](https://i.stack.imgur.com/mbIxY.png)](https://i.stack.imgur.com/mbIxY.png)

注意内容看起来不错和别名！

如果我尝试将相同的 Web 视图添加到我的应用程序：

```
NSURL *url = [NSURL URLWithString:@"http://www.google.co.uk?q=hello"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];

UIWebView *webView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 320, 400)];
webView.delegate=self;
[webView loadRequest:request];  
[self.view addSubview:webView]; 
```

使用以下转换：

```
[webView setTransform:CGAffineTransformMakeScale(0.6, 0.6)]; 
```

[![替代文字](https://i.stack.imgur.com/w6LHC.png)](https://i.stack.imgur.com/w6LHC.png)

..规模真的很差质量，似乎没有抗锯齿。

有谁知道为什么会发生这种情况或对如何解决它有建议？

谢谢！缺口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T10:58:53.887

我想出了一个解决办法！

拍摄 webview 的快照，将其添加到 UIImageView 并调整其大小！

```
UIGraphicsBeginImageContext(webView.bounds.size);
[webView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

UIImageView * imageView = [[UIImageView alloc] initWithFrame:CGRectMake(webView.bounds.x, webView.bounds.y, webView.frame.size.width, webView.size.height)];
imageView.image = viewImage;
[self addSubview:imageView];
[imageView release];

webView.hidden = YES; 
```

似乎工作正常！

需要注意的一点.. 如果您想在 WebView 加载后立即执行此操作，则需要将操作推迟一段时间（我选择了 10 秒！）

像这样：

```
-(void)deferLoading
{
    webViewHasActuallyLoaded = YES;
    [self setNeedsLayout];
}

- (void)webViewDidFinishLoad:(UIWebView *)webView {
    [NSTimer scheduledTimerWithTimeInterval: 1.0/10.0 target:self selector:@selector(deferLoading) userInfo:nil repeats:NO];
} 
```

为上面的建议干杯！缺口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T20:54:40.997

为什么不把 web 视图变小呢？它应该以较小的尺寸呈现高质量的内容。

如果您需要动画大小的变化，您可以设置`minificationFilter`web 视图的图层以获得合理的质量：

```
[[webView layer] setMinificationFilter:kCAFilterLinear]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-21T21:56:09.960

在你的 UIViewController 覆盖

*   (void)placeViewItems: (UIInterfaceOrientation)interfaceOrientation

并使您的 UIWebView 的 frame.origin.x 和 frame.origin.y 整数值。看看这是否是您正在寻找的结果。

# code-readability - 研究最优码宽？

> ID：578059
> 
> 赞同：156
> 
> 时间：2009-02-23T15:40:32.127
> 
> 标签：code-readability

如果您在您选择的 IDE 中启用“查看右边距”，它可能会默认为 80 个字符。我倾向于将其更改为 120，除了这是我几年前所在公司的标准之外，没有其他公司告诉我这样做不同。

我的问题是，是否有任何研究实际上表明 80 个字符是代码可读性的最佳最大宽度，或者这个值只是“它一直都是这样”并且没有人真正知道为什么会这样？而且，一行代码的宽度是否应该成为您的编码标准的一部分？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2009-02-23T15:47:02.703

实际上，80 列的东西[早在](https://dave.autonoma.ca/blog/2019/06/06/web-of-knowledge/)DOS 之前。它来自卡片打孔器，它是 80 列设备。

为了回答 OP 的问题，一项“研究”已经进行了大约 600 年——印刷书籍。这些已经发展了几个世纪，最重要的是可读性，到我们现在的位置，文本的平均行长约为 60 个字符。因此，为了可读性，请选择更窄的边距。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2009-02-23T16:38:29.460

请怜悯那些必须在以后维护您的软件并遵守 80 个字符限制的程序员。

喜欢 80 的理由：

*   在笔记本电脑上使用更大的字体可读

*   留出空间将两个版本并排放置以进行比较

*   在 IDE 中为导航视图留出空间

*   打印时没有任意断行（也适用于电子邮件、网页……）

*   将复杂性限制在一行

*   限制缩进，这反过来又限制了方法/函数的复杂性

是的，它应该是编码标准的一部分。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-02-23T15:53:25.667

我没有学习，但我会谈谈我的经历。

我发现在处理文本时**水平滚动很乏味。**我查看代码将在其中使用的环境，并根据该上下文设置宽度标准。

例如，当我在 XWindows 上的 Emacs 中工作时，始终有 2 个 Emacs 窗口**并排**运行非常好。这将它们限制为 80 个字符，所以这是我的最大行长。

有一次，我在 1920x1200 屏幕上的 Visual Studio 中工作。我会保持它最大化，所有工具窗口都停靠在一侧。两个编辑器窗口留有足够的空间，大约 100 个字符。

我还发现最长的行来自**具有长参数列表的方法调用**。这有时是一种**代码异味**：也许该方法应该被**重构**。

如果您和您的合作程序员拥有高分辨率的屏幕和敏锐的视力，请务必使用小字体和长行。相反，您可能需要短线。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2010-03-19T16:20:47.800

除非公司另有说明，否则我通常使用 120-150。但是，它也取决于代码的类型：

*   我（几乎）从不在一行上使用多个语句
*   仅当看起来相似的线条可以对齐且不中断时，我才使用长线条 (>12)。
*   我总是使用足够的空格/括号等
*   我更喜欢较长的变量名称而不是较短的名称

直到几年前，我限制在 100 个，但现在通常使用宽屏，甚至可以在笔记本电脑上看到 120 个高分辨率显示器（我几乎不使用）。

将屏幕比作一本书并不是很好，因为一本书有更多的垂直空间，而屏幕有更多的水平空间。我总是尽量保持函数最大值。一个可见的屏幕长。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-08-05T05:45:57.020

也许 80 个字符也是避免这些不良 getter 链的好点：

```
object.getFoo().getBar().getFooBar().get ... 
```

如果将其限制为 80 个字符，也许有人会本地化这些变量并进行空值检查等，但也许大多数程序员会让它们换行。我不知道

除此之外，正如starblue所说，80个字符很棒。这应该明确地进入编码标准。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-09-29T18:06:12.610

忽略硬件限制，以及我们阅读代码与自然语言的方式的任何差异，我认为将行限制在 80 个字符左右的三个主要原因。

1.  人的眼球是圆的，不是很窄很宽，[大部分分辨率都在中间](https://www.ncbi.nlm.nih.gov/books/NBK10848/)。一次阅读数小时时，根据需要使用一个滚动条以短弧扫视会更舒服。我不知道针对代码易读性的正式研究，但根据我自己的观察，显示器距离 2 英尺，文本大小为 10pt 等宽字体，100 个字符约占我水平字段的 1/3视力，或大约 60 度（[在我们所有眼睛的分辨率所在的 30 度左右之外](http://www.edmundoptics.com/resources/application-notes/imaging/understanding-focal-length-and-field-of-view/)）。
2.  大多数人在工作中使用大型显示器，这样他们就可以看到多个东西而无需来回点击，而不是让他们可以看到一件非常大的东西。
3.  较短的行包含较少的复杂性，这有望迫使开发人员将他们的代码分解成更易于消化的单元。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-23T15:54:26.507

我清楚地记得在某处（我认为是在[敏捷文档](https://rads.stackoverflow.com/amzn/click/com/0470856173)中）读到，为了获得最佳可读性，文档的宽度应该大约是两个字母或 60-70 个字符。我认为旧终端的线宽部分来自旧的印刷规则。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-23T15:55:09.440

如果您要打印代码，右边距选项旨在向您显示页面的宽度，并且之前发布过说它设置为 80，因为这是在 GUI 之前一直到打孔之前的历史行长牌。

我最近在某个博客上看到了一个建议（不记得是哪个博客了），以增加 IDE 字体大小以提高代码质量，其背后的逻辑是，如果屏幕上适合的代码越少，你就会写出更短的行和喊话功能。

在我看来，较短的行使阅读代码和调试变得更容易，所以我尽量保持行短，如果你必须设置一个限制来让自己写出更好的代码，然后选择适合你的——如果你更有效率的话更长的行可以随意增加页面大小和代码只在宽屏幕上。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-05-20T18:58:50.540

正如有些人在其他答案中指出的那样，限制 80 个字符的原因部分是历史性的（打孔卡、小屏幕、打印机等），部分是生物性的（为了跟踪你所在的行，能够看到整个线无需转头）。

也就是说，请记住，我们仍然是人类，我们构建工具来解决我们自己的局限性。我建议你忽略关于字符限制的整个争论，只写有意义的东西，不管它们的长度如何，并使用可以帮助你正确跟踪行的 IDE 或文本编辑器。在制表符与空格的辩论中使用相同的缩进参数，以及缩进的宽度我建议您使用缩进标记（最常见的是制表符）并让人们配置自己的 IDE 或文本编辑器来显示它们因为他们觉得最舒服。

坚持每行固定数量的字符总是会让除了目标受众之外的所有人都变得更糟。也就是说，如果你永远不会分享代码，永远；那么真的没有理由开始这个讨论。如果您想共享代码，您可能应该让人们自己决定他们想要什么，而不是将您（或其他人）的理想强加给他们。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-23T19:38:45.267

据我所知，80 个字符用作编码标准，以保持与命令行编辑器的兼容性（默认终端宽度通常为 80 个字符）。对于现代 IDE 和大屏幕分辨率，80 个字符可能不是“最佳”，但对于许多开发人员来说，在终端中保持可读性是必不可少的。出于这个原因，80 字符宽度不太可能很快被替换为代码宽度的事实标准。为了回答您的最后一个问题，是的，代码宽度以及任何其他会影响代码可读性的特征都应该在您的编码标准中得到解决。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-19T05:33:51.107

这里有一个研究供你参考：

我教编程 30 多年，在此期间，我积累了 1823 个 C 源代码和各种例程，从随机小游戏到神经网络、编译器、教育软件、自动生成的 lex/yacc 源代码等。

根据帕累托原则，这些程序中有 80% 的行数小于 159 列。因此，要削减较低的 20% 和较高的 20%，我们有：

*   1823 源代码
*   其中 80% 小于 159 列
*   其中 80% 大于 64 列

现在这是一个给你自由的范围。您不想仅仅为了它而将代码限制为 80 列，因为有时您需要嵌套循环、函数或一些在更大的行中易于理解的缩进，并且如果您强行扭曲您的逻辑要适合任意列宽，您没有使用最佳逻辑。

另一方面，有时线条的大小表明您的逻辑可能会更好，而线条可能会更小；特别是如果您不在代码的嵌套部分中并且您已经超过了 160 列的限制。

根据我自己的经验和可读性，我建议您编写代码的**目标是 80 列，但最多允许 120 列边距，并且永远不要超过 160 列的限制。**

此外，我们应该考虑存在的较早的阅读体验：**书籍**。书籍的排版是为了方便读者的眼球运动，根据该领域的专业人士的说法，最好的列大小是**每行 60 个字符左右，不少于 40 个，不超过 90 个。**

由于编码并不完全是阅读一本书，我们可以达到上限，我们应该保持在**每行 80 到 90 个字符**之间。

除非您正在编写将在特定屏幕尺寸和旧显示器上运行的低级代码，否则我建议您遵循**gopher**标准，即**每行 67 个字符**。

* * *

好奇心：

*   1823 源代码中最大的一行是一行1020 列的*五行*
*   不是单行的最大代码行是一个文字冒险游戏，有 883 行。当然这是一个很好的做法，因为如果你不限制换行，文本会更好地显示在你的屏幕上，在你实际拥有的列中换行。
*   最小的代码行（非零）是 14 个字符长。
*   我用来检查文件大小的命令是：`find . -type f -name "*.c" -exec wc -L {} \; | sort -n | less -N`

# list - 什么是 Haskell 的 Stream Fusion

> ID：578063
> 
> 赞同：71
> 
> 时间：2009-02-23T15:42:00.970
> 
> 标签：list, optimization, compiler-construction, haskell

什么是 Haskell 的 Stream Fusion 以及如何使用它？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-02-24T01:59:46.897

洛根指出的论文很棒，但有点难。（只要问我的学生。）关于“流融合如何工作”的内容也很多，而“流融合是什么以及如何使用它”只有一小部分。

流融合解决的问题是编写的功能代码通常会分配中间列表，例如，要创建一个无限的节点编号列表，您可以编写

```
nodenames = map ("n"++) $ map show [1..] 
```

天真的代码会分配一​​个无限的整数列表`[1, 2, 3, ...]`、一个无限的字符串列表`["1", "2", "3", ...]`，并最终分配一个无限的名称列表`["n1", "n2", "n3", ...]`。这分配太多了。

流融合所做的是将定义`nodenames`转换为使用递归函数的定义，该函数仅分配结果所需的内容。一般来说，消除中间列表的分配被称为*森林砍伐*。

要使用流融合，您需要编写*非递归列表函数，这些函数使用*[GHC 票证 915](https://ghc.haskell.org/trac/ghc/ticket/915)（`map`、等）中描述的流融合库中的函数`foldr`，而不是显式递归。该库包含所有 Prelude 函数的新版本，这些函数已被重写以利用流融合。显然，这些东西将在下一个 GHC 版本 (6.12) 中使用，但不在当前的稳定版本 (6.10) 中。如果您想使用库 Porges 在他的回答中有一个很好的简单解释。

如果您真的想解释流融合的工作原理，请发布另一个问题——但这要困难得多。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-09T14:28:23.197

据我所知，与 Norman 所说的相反，流融合目前*没有*在 GHC 的基础中实现（即，你不能只使用 Prelude 函数）。如需更多信息，请参阅[GHC 票 915](https://ghc.haskell.org/trac/ghc/ticket/915)。

要使用流融合，您需要安装流融合库，导入 Data.List.Stream（您也可以导入 Control.Monad.Stream）并且只使用该模块中的函数而不是 Prelude 函数。这意味着导入 Prelude 隐藏所有默认列表函数，而不使用 [x..y] 构造或列表推导。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-10-16T20:34:12.150

当 6.12 中的 GHC 默认使用这些新函数时，它们是否也会以非递归方式实现 [x..y] 和列表推导，这不是正确的吗？因为它们不是正确的行的唯一原因是它们是*内部*的并且不是真正用 Haskell 编写的，而是更像关键字，为了速度和/或因为您将无法重新定义该语法。

# mysql - mysql - 选择包含给定 id 的分页块

> ID：578066
> 
> 赞同：0
> 
> 时间：2009-02-23T15:43:16.193
> 
> 标签：mysql, database

...在确定分页块之前。

我知道您可以在多个语句中执行此操作，但必须有更好的方法。

我的结果按日期排序返回，我想返回包含给定 id 的分页块。因此，例如，我可以选择给定 id 的日期，然后选择日期小于或大于日期的一大块结果。那会奏效。但是是否有一些本地 mysql 方法可以在一个语句中执行此类操作？如果结果按日期排序，那么期望我们可以要求存在给定 id 的 X 结果似乎是合理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T16:07:30.893

我相信这**不是**一个简单的陈述就能做到的。但是有一个解决方案是使用存储过程并定义自己的由更多语句组成的函数。

不幸的是，对于 SELECT ... LIMIT x,y 您只能使用整数，x 和 y 不能是表达式，因此您不能通过分页标准来限制结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T17:04:53.920

```
SELECT *
FROM
  (
  SELECT @r := COUNT(*),
         @up := @r,
         @down := @r
  FROM items
  WHERE (timestamp, id) < (SELECT timestamp, id FROM items WHERE id = @id)
  ) i,
  (
  SELECT id, timestamp, st, c
  FROM (
    SELECT @down := CASE WHEN (@down % 50) <> 0 THEN @down := @down - 1 ELSE @down END AS c,
           @stop := CASE WHEN (@down % 50) <> 0 THEN 0 ELSE 1 END AS st,
           id, timestamp
    FROM  items
    WHERE (timestamp, id) <= (SELECT timestamp, id FROM items WHERE id = @id)
    ORDER BY
      timestamp DESC, id DESC
    LIMIT 50
    ) down
  UNION ALL
  SELECT id, timestamp, st, c
  FROM (
    SELECT @up := CASE WHEN (@up % 50) <> 0 THEN @up := @up + 1 ELSE @up END AS c,
           @stop := CASE WHEN (@up % 50) <> 0 THEN 0 ELSE 1 END AS st,
           id, timestamp
    FROM  items
    WHERE (timestamp, id) > (SELECT timestamp, id FROM items WHERE id = @id)
    ORDER BY
      timestamp, id
    LIMIT 50
    ) up
  ) r
WHERE NOT st
ORDER BY timestamp, id 
```

# java - linux 机器上 apache-tomcat 的推荐/标准安装路径是什么

> ID：578073
> 
> 赞同：12
> 
> 时间：2009-02-23T15:43:54.350
> 
> 标签：java, linux, tomcat

您好，我正在寻找在 RedHat linux 上安装 Apache-Tomcat，如果有安装它的标准位置，我很感兴趣。在其他工作中，我看到过安装在

/opt/apache-tomcat-[版本]/

但我希望它可以在 /usr 下找到。最佳答案将有一个权威网站的链接。

非常感谢，

大卫。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-23T15:49:27.533

我不知道是否有“官方”地方这样的东西，但一个合理的做法是做你所做的事情并通过 /usr/local/tomcat 或类似的软链接引用 tomcat，这将允许您通过简单地在 opt 中安装新版本并更改软链接来升级版本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-23T15:55:24.633

这取决于你问谁，但我是这样看的：

/opt 通常用于第三方附加软件。/usr/ 通常用于“系统”软件。用户编译的应用程序进入 /usr/local。

我把tomcat放在/opt/apache-tomcat-VERSION中。然后我将它作为 /opt/tomcat 的符号链接。

[Linux 标准库](http://www.linuxfoundation.org/en/LSB)可能有更多关于此事的信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-26T20:30:32.880

有一个适用于 Tomcat 6 的 Red Hat RPM 包 - 只需“yum install tomcat6”，它会将所有内容放在适合您的位置，并通过以专用用户身份运行 Tomcat 来修复安全性（更不用说通过以下方式处理更新和补丁了）将 Tomcat 放入 RPM 存储库）。

大多数可执行文件、配置和 webapp 目录都使用这种方法在 /var/lib/tomcat6 下结束。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-22T19:13:10.760

其他人提到了[http://www.pathname.com/fhs/pub/fhs-2.3.html](http://www.pathname.com/fhs/pub/fhs-2.3.html)，这是很好的信息。不幸的是，除了尖刻的评论外，他们没有提供任何随附的信息。

根据该文档，/opt 是安装软件所在的位置，所以我推荐 /opt/tomcat，并将*CATALINA_HOME*设置为该目录。

它还说 /var 是可变数据所在的位置，所以我将它放在 /var/tomcat 中并将*CATALINA_BASE*设置为该目录。

我会添加一点背景。如果您不设置*CATALINA_BASE*，那么它将默认与*CATALINA_HOME*相同。但是，*CATALINA_HOME*应该是纯粹的安装，并且应该设置为只读。您应该为实际的 Web 目录和日志等可变内容使用不同的位置。然后，当您需要更改版本时，就像更改*CATALINA_HOME*一样简单。此外，您可以更轻松地运行多个 Tomcat 实例，而无需同一安装的多个副本。

此外，不要忘记创建 CATALINA_BASE/bin/setenv.sh（或 Windows 的 .bat）文件，而不是编辑 CATALINA_HOME/bin/catalina.sh（或 Windows 的 .bat）。

是的，这比任何人要求的信息都多，但希望有人会发现它有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-11T04:28:29.723

好吧，这里有一个简单的答案，太糟糕了，这些高点没有人列出它：

[http://www.pathname.com/fhs/pub/fhs-2.3.html](http://www.pathname.com/fhs/pub/fhs-2.3.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T15:58:46.123

我很确定这没关系。

就像大多数表现良好的 Java 应用程序寻找*JAVA_HOME*环境变量来定位首选 Java 安装一样，一旦您在受影响用户的 .bashrc 或 .profile 中设置了*CATALINA_HOME*，需要定位 Tomcat 的软件应该能够找到它.

# c# - 关于配置文件中的键的应用程序需要多少钱？

> ID：578077
> 
> 赞同：0
> 
> 时间：2009-02-23T15:44:28.513
> 
> 标签：c#, asp.net, web-config, app-config

我正在查看我们的一个遗留应用程序（ASP.NET 1.1/2.0 Web 应用程序）并且有一个工具来计算所有键/值对。似乎在遗留应用程序的 11 个配置文件（应用程序、Web、数据和一堆自定义配置文件）中，我找到了 1172 个键。我假设某些键不再使用，我想说服经理进行清理。当我提到总数时，我感到有些震惊，但他们认为没有理由回去进行清理，因为他们想要证明网站确实因此变慢了。所以我的问题是，它更慢（所有这些都需要加载到内存中）？有文件吗？任何人对一个配置文件和一般应用程序的“可接受”键的数量有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T16:13:39.567

如果这些键/值对存储在`AppSettings`值中，它们将被缓存，因此它们不会导致任何性能下降。

只要您的密钥不是多余的并且实际上在应用程序中被引用，就没有理由摆脱它们。

# ruby-on-rails - 如何在 Ruby on Rails 中实现无向图？

> ID：578084
> 
> 赞同：6
> 
> 时间：2009-02-23T15:46:00.193
> 
> 标签：ruby-on-rails, ruby, algorithm

我需要在 Ruby on Rails 中实现一个无向图 G = (V,E) 并考虑构建一个*Vertex*和一个*Edge*模型，其中*Vertex has_many Edges*。

由于一条边恰好连接了两个顶点，您将如何在 Rails 中执行此操作？

您是否知道任何有助于实现这样的图表的 gem 或库（不感兴趣重新发明轮子 ;-)）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T17:10:54.547

不知道在 ActiveRecord 之上提供图形逻辑的任何现有库。

您可能必须实现自己的 Vertex、Edge ActiveRecord 支持的模型（请参阅Rails 安装目录`vertex.rb`并在其中），例如`edge.rb``rails/activerecord/test/fixtures`

```
### From Rails: ###

# This class models an edge in a directed graph.
class Edge < ActiveRecord::Base
  belongs_to :source, :class_name => 'Vertex', :foreign_key => 'source_id'
  belongs_to :sink,   :class_name => 'Vertex', :foreign_key => 'sink_id'
end

# This class models a vertex in a directed graph.
class Vertex < ActiveRecord::Base
  has_many :sink_edges, :class_name => 'Edge', :foreign_key => 'source_id'
  has_many :sinks, :through => :sink_edges

  has_and_belongs_to_many :sources,
    :class_name => 'Vertex', :join_table => 'edges',
    :foreign_key => 'sink_id', :association_foreign_key => 'source_id'
end 
```

为了使上述行为表现为有*向*图，请考虑在插入边时插入互补边。另请注意，`has_and_belongs_to_many`现在不鼓励使用 of，您可以`has_many :sources ... :through => :edges`改用。任何强制执行都可以通过验证（即顶点自身没有边）和/或数据库约束（唯一性约束/索引 on `[source_id,sink_id]`in`edges`确保顶点 V1 ---> V2 不通过多个有向边连接）来完成, 并且顶点 V1 <--- V2 也没有被多个有向边连接。）

此时，您有两个选择，具体取决于您的图表有多大以及您希望在任何给定时间点遍历多少：

1.  `ActiveRecord`使用关系（例如`vertex1.edges.first.sink.edges`...）在上述模型之上编写应用程序所需的最少图形逻辑；这*将*导致对数据库进行大量往返
2.  进口`RGL`；从DB中选择所有顶点和边到RGL中，并使用RGL进行图遍历，例如

.

```
 edges = Edge.find(:all)
    dg = RGL::AdjacencyGraph.new(edges.inject([]) { |adj,edge|
      adj << edge.source_id << edge.sink_id
    })
    # have fun with dg
    # e.g. isolate a subset of vertex id's using dg, then
    # load additional info from the DB for those vertices:
    vertices = Vertex.find(vertex_ids) 
```

以上将您的 SQL 语句总数（在只读操作中）减少到 2，但如果图表 ( `Edge.find(:all)`) 很大，可能会给您的数据库或内存带来压力——此时您可能会想到进一步的方法来限制您实际需要的数据量，例如只关心`red`顶点的连接：

```
 Edge.find(:all,
              :joins => :sources, # or sinks; indifferent since symmetric
              :conditions => [ 'vertices.red = ?', true ]
    ) 
```

# sql-server - 您是否推荐使用 Sql Server 来存储和索引文件（pdf、office 等）？

> ID：578087
> 
> 赞同：0
> 
> 时间：2009-02-23T15:46:47.400
> 
> 标签：sql-server, lucene, storage

> **可能重复：**
> [Lucene.Net 和 SQL Server](https://stackoverflow.com/questions/37059/lucene-net-and-sql-server)

我需要存储和索引文件，例如 PDF 和办公文件。目前我正在使用 Sql Server 2k8 使用带有 IFilters 的全文搜索来执行此任务。我的问题是：这是“最好”的方式吗？例如，我应该切换到 Lucene 进行索引吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T16:15:07.770

这个问题并不新鲜。阅读[这个](https://stackoverflow.com/questions/37059/lucenenet-and-sql-server)和[这个](https://stackoverflow.com/questions/120965/which-search-technology-to-use-with-aspnet)线程。根据我的经验，我建议使用 Lucene。设置起来有点困难，但效果很好。
你也可以看看[Sphinx](http://www.sphinxsearch.com/)。它看起来非常好，并有积极的答复。

# c# - 什么是 API 使用？

> ID：578089
> 
> 赞同：2
> 
> 时间：2009-02-23T15:46:59.630
> 
> 标签：c#, .net, asp.net, sql-server

我不确定我是否得到了 API 使用的正确定义。我有一段代码用于从 c# 应用程序将 BulkInsert 插入 SQL。它说该片段显示了 API 的使用情况。我该如何翻译？

```
private void WriteToDatabase()
{
    // get your connection string
    string connString = "";
    // connect to SQL
    using (SqlConnection connection = 
            new SqlConnection(connString))
    {
        // make sure to enable triggers
        // more on triggers in next post
        SqlBulkCopy bulkCopy = 
            new SqlBulkCopy
            (
            connection, 
            SqlBulkCopyOptions.TableLock | 
            SqlBulkCopyOptions.FireTriggers | 
            SqlBulkCopyOptions.UseInternalTransaction,
            null
            );

        // set the destination table name
        bulkCopy.DestinationTableName = this.tableName;
        connection.Open();

        // write the data in the "dataTable"
        bulkCopy.WriteToServer(dataTable);
        connection.Close();
    }
    // reset
    this.dataTable.Clear();
    this.recordCount = 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T15:53:36.837

[应用程序编程接口 (API) 是由库和/或操作系统服务提供的一组例程、数据结构、对象类和/或协议，以支持应用程序的构建](http://en.wikipedia.org/wiki/API)

简单来说，API 由您可以从外部看到并与之交互的程序集的各个部分组成。Microsoft.NET 框架有很多你不能使用的东西，因为它们不是框架 API 的一部分。这些类、方法、接口等被标记为内部的或私有的，供 MS 使用。

您所看到的只是从库外部人员的角度使用此代码的一个示例。换句话说，您可以自己编写此代码，作为 API 的使用者。它没有详细说明使用 API 的所有可能方式，但它为您提供了提示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T15:50:14.037

你的意思是像“系统集成”这样的东西，你正在编写连接到某个 API 的代码？如果没有，您可能需要根据上下文详细说明。

编辑：在我看来，您只是通过给它一个简单的案例来测试 API。这是使用 API，我可以看到一些情况，其中一个人想要找到使用特定 API 调用的所有实例，例如，如果一个人正在更改 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:50:51.337

API 仅代表应用程序编程接口。一个 API 可以被许多不同的库公开。问题本身相当模糊，也许您可​​以发布代码片段并让我们知道 API 应该用于哪个库，我们可以帮助您识别 API 调用的代码部分。

编辑：下面的行显示了对 API 进行的特定调用。

就你的翻译方式而言，我仍然不确定你的意思。

```
 SqlBulkCopy bulkCopy = 
        new SqlBulkCopy
        (
        connection, 
        SqlBulkCopyOptions.TableLock | 
        SqlBulkCopyOptions.FireTriggers | 
        SqlBulkCopyOptions.UseInternalTransaction,
        null
        );

    // set the destination table name
    bulkCopy.DestinationTableName = this.tableName;

    // write the data in the "dataTable"
    bulkCopy.WriteToServer(dataTable); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T15:50:54.567

我假设它是一个简单的片段，它记录了一个方法或一组方法被访问的次数，可能还有时间。本质上，分析特定边界上的调用。

API 只是 2 位代码进行对话的机制。这可能是托管接口等调用、非托管（互操作）调用、Web 请求等。任何允许您使用特定功能的东西。够模糊吗？

（编辑：问题不断变化！！）在“从 c# 应用程序批量插入 SQL”的情况下，我认为它突出了`SqlBulkCopy`来自 .NET 调用者的和/或 TSQL 批量插入的使用。例如，`SqlBulkCopy`每批行都有事件......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-03T05:15:36.900

API 只不过是类，它是支持您快速开发项目的方法。例子。.Net 和 Java 中的 Collections 和 Genrics 提供了一组预定义的类，如 Stack、ArrayList、HashTable、Queue 等，以帮助您进行项目开发。

# http - 我缺少哪个重写规则（IIS 上的 ISAPI）？

> ID：578094
> 
> 赞同：1
> 
> 时间：2009-02-23T15:47:25.060
> 
> 标签：http, iis, mod-rewrite, webserver, isapi

我有以下规则：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.example\.com$
RewriteRule ^blog/?$ http://blog.example.com/ [P]
RewriteRule ^(blog/.*)$ http://blog.example.com/$1 [p]

RewriteCond %{HTTP_HOST} ^example.com$ 
RewriteRule ^(.*)?$ http://www.example.com/$1 [L,R=301] 
```

我想要实现的，它可以达到我预期的 90%，是对[http://www.example.com/blog](http://www.example.com/blog)的任何点击都将代理到[http://blog.example.com](http://blog.example.com)。我在这里遇到的问题是，如果我访问[http://blog.example.com/some/dir/foo.php](http://blog.example.com/some/dir/foo.php)它工作正常。但是，如果我去[http://www.example.com/blog/some/dir/foo.php](http://www.example.com/blog/some/dir/foo.php)，它就不起作用。

我缺少什么规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-23T15:54:11.050

尝试用这条规则替换前两条规则：

```
RewriteCond %{HTTP_HOST} ^www\.example\.com$
RewriteRule ^blog/(.*) http://blog.example.com/$1 [P] 
```

# javascript - 如何使用 JavaScript 从另一台服务器获取数据？

> ID：578095
> 
> 赞同：23
> 
> 时间：2009-02-23T15:47:32.873
> 
> 标签：javascript, cross-domain

如何使用用户浏览器中的 JavaScript 向其他服务器发出请求（即从任何所需的服务器获取页面）？对于像 XMLHttpRequest 这样的方法，有一些限制可以防止这种情况发生，有没有办法绕过它们或其他方法？

这是一个普遍的问题，具体我想检查一系列随机网站，看看它们是否包含某个元素，所以我需要一个网站的 HTML 内容，而不需要下载任何额外的文件；所有这些都在一个 JavaScript 文件中，*在服务器上没有任何转发或代理机制*。

（注意：一种方法是使用 Greasemonkey 及其 GM_xmlhttpRequest。）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-23T15:50:01.120

你应该看看[jQuery](http://www.jquery.com)。它具有丰富的[AJAX 功能](http://docs.jquery.com/Ajax)基础，可以让您完成所有这些工作。您可以加载外部页面，并使用直观[的类似 CSS 的选择器](http://docs.jquery.com/Selectors)解析其 HTML 内容。

使用示例`$.get();`

```
$.get("anotherPage.html", {}, function(results){
  alert(results); // will show the HTML from anotherPage.html
  alert($(results).find("div.scores").html()); // show "scores" div in results
}); 
```

对于外部域，我不得不编写一个充当中间人的本地 PHP 脚本。jQuery 将调用本地 PHP 脚本，传入另一个服务器的 URL 作为参数，本地 PHP 脚本将收集数据，jQuery 将从本地 PHP 脚本中读取数据。

```
$.get("middleman.php", {"site":"http://www.google.com"}, function(results){
  alert(results); // middleman gives Google's HTML to jQuery
}); 
```

给*middleman.php*一些类似的东西

```
<?php

  // Do not use as-is, this is only an example.
  // $_GET["site"] set by jQuery as "http://www.google.com"
  print file_get_contents($_GET["site"]);

?> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-29T21:48:50.320

> 2018 年更新：

只有满足以下4个条件才能跨域访问

*   在响应头有`Access-Control-Allow-Origin: *`

演示

```
$.ajax({
  url: 'https://api.myjson.com/bins/bq6eu',
  success: function(response){
    console.log(response.string);
  },
  error: function(response){
    console.log('server error');
  }
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
```

*   使用服务器作为目标的桥接器或代理

演示：

```
$.ajax({
  url: 'https://cors-anywhere.herokuapp.com/http://whatismyip.akamai.com/',
  success: function(response){
    console.log('server IP: ' + response);
  },
  error: function(response){
    console.log('bridge server error');
  }
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
```

*   使用浏览器插件启用`Allow-Control-Allow-Origin: *`
*   禁用浏览器网络安全

铬合金

```
chrome.exe --args --disable-web-security 
```

火狐

```
about:config -> security.fileuri.strict_origin_policy -> false 
```

结尾

* * *

> 菜鸟旧答案 2011

$.get(); 可以从*jsbin.com*获取数据，但我不知道为什么它不能从 google.com 等其他网站获取数据

```
$.get('http://jsbin.com/ufotu5', {},
  function(results){  alert(results); 
}); 
```

演示： http: [//jsfiddle.net/Xj234/](http://jsfiddle.net/Xj234/) 使用 firefox、chrome 和 safari 进行测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T15:51:38.417

编写一个代理脚本，沿着来自您的域的 http 请求转发，这将绕过 XMLHttpRequest 限制。

如果您使用 PHP，只需使用 cURL 请求并读取页面，然后只需将 html 吐出，就好像它来自您的域一样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-08T07:02:06.163

这相当容易......如果你知道几乎没有人分享的“秘密”技巧......

它叫雅虎QQ...

因此，为了重新获得“用户的权力”（并回到方便的口头禅：“从不接受不”），只需使用[http://query.yahooapis.com/](http://query.yahooapis.com/)（而不是 php?代理服务器端脚本）。
jQuery 不是严格需要的。

**示例 1：**
使用类似 SQL 的命令：

```
select * from html 
where url="http://stackoverflow.com" 
and xpath='//div/h3/a' 
```

以下链接将抓取 SO 以获取最新问题（绕过跨域安全公牛$#!7）： http://query.yahooapis.com/v1/public/yql?q=select%20title%20from%20html%
[20where %20url%3D%22http%3A%2F%2Fstackoverflow.com%22%20and%0A%20%20%20%20%20%20xpath%3D%27%2F%2Fdiv%2Fh3%2Fa%27%0A%20 %20%20%20&format=json&callback=cbfunc](http://query.yahooapis.com/v1/public/yql?q=select%20title%20from%20html%20where%20url%3D%22http%3A%2F%2Fstackoverflow.com%22%20and%0A%20%20%20%20%20%20xpath%3D%27%2F%2Fdiv%2Fh3%2Fa%27%0A%20%20%20%20&format=json&callback=cbfunc)

如您所见，这将返回一个 JSON 数组（也可以选择 xml）并调用回调函数：`cbfunc`。

事实上，作为“奖励”，每次您不需要从“标签汤”中正则表达式数据时， 您还可以[保存一只小猫。](https://stackoverflow.com/a/1732454/588079)

你听到你内心的疯狂小科学家开始咯咯地笑了吗？

然后查看[此答案](https://stackoverflow.com/a/12080097/588079)以获取更多信息（不要忘记更多示例的评论）。

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T17:34:50.667

您还可以使用 iframe 来模拟 ajax 请求。这为您节省了为前端问题编写后端解决方案的麻烦。这是一个例子：

```
function setUploadEvent(typeComponet){
       var eventType = "";
       var iframe = document.getElementById("iframeId");
       try{
           /* for Mozilla / Opera9 */
           if (/(?!.*?compatible|.*?webkit)^mozilla|opera/i.test(navigator.userAgent)) {
                eventType = "onload";
           }else{
           /* IE  */
                eventType = "onreadystatechange";
           }

           iframe[eventType] = function(){
                var doc = iframe.contentDocument || iframe.contentWindow.document;
                var response = doc.body.innerHTML; /* or what ever content you are looking for */
             }
           }
       catch(e){
           alert("Error loading content")}
       } 
```

这应该够了吧。请注意，浏览器检测线不是最干净的，您绝对应该使用所有最常见的 JS 框架（Prototype、JQuery 等）中提供的检测线

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T15:51:10.400

您需要在服务器上编写一个代理来执行此操作。所有请求都将发送到您的服务器，然后您的服务器将加载 html 并将其发送回客户端。并且没有好的方法可以仅通过 javascript 来实现。
jQuery 包含使用 XmlHttpRequest 加载 JSON 数据或外部脚本的功能，但此功能不能用于 html 页面。你也可以查看[这个 jQuery 邮件列表线程](http://groups.google.com/group/jquery-en/browse_thread/thread/130a8df99afdf9c4/82d6431c96cd14f5)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-20T17:11:28.750

<script language="JavaScript" type="text/javascript" src="http://www.example.com/hello.js"></script>

您可以将数据以数组、JSON 或类似的形式添加到 hello.js 中。示例： var daysInMonth = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);

从另一台服务器获取 JavaScript 并不简单.. :-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-08T05:16:27.000

非常感谢，这真是一个好技巧。我是这样做的：

测试.html

```
<!DOCTYPE html>
<html>
<head>
<script>
function loadXMLDoc()
{
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("myDiv").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","sp.php",true);
xmlhttp.send();
}
</script>
</head>
<body>

<h2>Using the XMLHttpRequest object</h2>
<div id="myDiv"></div>
<button type="button" onclick="loadXMLDoc()">Change Content</button>

</body>
</html> 
```

sp.php

```
<?php
  print file_get_contents("http://your.url.com/you-can-use-cross-domain");
?> 
```

# iphone - 如何将数据添加到 iPhone 上的 TableView？

> ID：578097
> 
> 赞同：0
> 
> 时间：2009-02-23T15:48:17.443
> 
> 标签：iphone, arrays, uitableview

我为tableView 的listData 定义了一个数组。

```
NSArray *array = [[NSArray alloc] initWithObjects:@"Sleep", @"Bashful", @"Happy", nil];
self.listData = array;

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:SimpleTableIdentifier];
cell.text = [listData objectAtIndex:row];
```

现在我想向 tableview 添加更多数据。如何将另一个数据连接到它，所以当我单击一个按钮时，数组将为@“A”、“B”、“C”、“D”、nil？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T17:08:39.480

最简单的方法是使用带有 insertObjetcAtIndex 或 addObject 的 NSMutableArray：

```
NSMutableArray *array = [[NSMutableArray alloc] initWithObjects:@"Sleep", @"Bashful", @"Happy", nil];
[array insertObject:@"XYZ" atIndex:3];
[array addObject:@"ABC"]; 
```

# shell - Shell脚本日期时间函数？

> ID：578114
> 
> 赞同：1
> 
> 时间：2009-02-23T15:51:37.140
> 
> 标签：shell, date, scripting, ksh

我正在运行以下脚本：

```
#!/bin/ksh
./clear_old
./rooms_xls.pl 2/23/09
cd doors
./doors_xls.pl 2/23/09 
```

如何根据系统/服务器时间将日期设为今天的日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T15:58:18.870

这应该可以正常工作（并且几乎符合您的格式）：

```
#!/bin/ksh
./clear_old
./rooms_xls.pl `date +%D`
cd doors
./doors_xls.pl `date +%D` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T15:54:47.770

`$(date)`

作品

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T15:58:37.653

在 date 命令中使用反引号：

```
./rooms_xls.pl `date +%m/%d/%Y` 
```

# java - 使用 wsdl2js 生成客户端代码？

> ID：578116
> 
> 赞同：1
> 
> 时间：2009-02-23T15:51:45.877
> 
> 标签：java, soap, wsdl, wsdl2java

我正在尝试使用 wsdl2js 为 WSDL 文件生成 SOAP 请求的客户端处理程序，但遇到了一些问题。如果我使用：

```
>wsdl2js -p [projectName] [wsdlFile] 
```

它只生成一个 javascript 文件，这不是我需要的。

如果我使用

> wsdl2js -client [wsdlFile]

就像他们演示的那样，我得到一个“意外选项：-client”

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T21:03:48.110

wsdl2js 中没有 -client 选项。这就是为什么你得到最后提到的错误。

从调用生成的 javascript 文件

```
>wsdl2js -p soap http://link.to/webservice?wsdlfile 
```

将生成您需要的存根，以便与引用的 Web 服务进行通信

# string - Unicode 感知字符串(1) 程序

> ID：578121
> 
> 赞同：8
> 
> 时间：2009-02-23T15:52:17.107
> 
> 标签：string, unicode

有人有 unicode 感知字符串程序的代码示例吗？编程语言无关紧要。我想要的东西本质上与 unix 命令“字符串”做同样的事情，但它也适用于 unicode 文本（UTF-16 或 UTF-8），拉动英语字符和标点符号的运行。（我只关心英文字符，而不关心任何其他字母）。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T16:02:16.507

您只是想使用它，还是出于某种原因坚持使用代码？

在我的 Debian 系统上，命令似乎`strings`可以立即执行此操作。请参阅手册页中的摘录：

```
 --encoding=encoding
       Select the character encoding of the strings that are to be found.  Possible values for encoding are: s = single-7-bit-byte characters (ASCII, ISO  8859,
       etc.,  default),  S  = single-8-bit-byte characters, b = 16-bit bigendian, l = 16-bit littleendian, B = 32-bit bigendian, L = 32-bit littleendian. Useful
       for finding wide character strings. 
```

编辑：好的。我不知道 C#，所以这可能有点麻烦，但基本上，您需要搜索交替的零和英文字符的序列。

```
byte b;
int i=0;
while(!endOfInput()) {
  b=getNextByte();
LoopBegin:
  if(!isEnglish(b)) {
    if(i>0) // report successful match of length i
    i=0;
    continue;
  }
  if(endOfInput()) break;
  if((b=getNextByte())!=0)
    goto LoopBegin;
  i++; // found another character
} 
```

这应该适用于小端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-18T12:17:56.543

我遇到了类似的问题并尝试了“ `strings -e ...`”，但我刚刚找到了修复宽度字符编码的选项。（UTF-8 编码是可变宽度）。

记住 ascii 之外的默认字符需要额外的`strings`选项。这包括几乎所有非英语语言字符串。

然而“ `-e S`”（单个 8 位字符）输出包括 UTF-8 字符。

我写了一个非常简单的（有意见的）Perl 脚本，它将“ `strings -e S ... | iconv ...`”应用于输入文件。

我相信很容易针对特定限制进行调整。用法：`utf8strings [options] file*`

```
#!/usr/bin/perl -s

our ($all,$windows,$enc);   ## use -all ignore the "3 letters word" restriction
use strict;
use utf8::all;

$enc = "ms-ansi" if     $windows;  ##
$enc = "utf8"    unless $enc    ;  ## defaul encoding=utf8
my $iconv = "iconv -c -f $enc -t utf8 |";

for (@ARGV){ s/(.*)/strings -e S '$1'| $iconv/;}

my $word=qr/[a-zçáéíóúâêôàèìòùüãõ]{3}/i;   # adapt this to your case

while(<>){
   # next if /regular expressions for common garbage/; 
   print    if ($all or /$word/);
} 
```

在某些情况下，这种方法会产生一些额外的垃圾。

# linux - 我可以告诉 Linux 不要换出特定进程的内存吗？

> ID：578137
> 
> 赞同：47
> 
> 时间：2009-02-23T15:54:44.590
> 
> 标签：linux, swap

有没有办法告诉 Linux 它不应该将特定进程的内存交换到磁盘？

它是一个 Java 应用程序，所以理想情况下我希望有一种方法可以从命令行执行此操作。

我知道您可以将 global swappiness 设置为 0，但这明智吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-23T16:21:30.453

你可以通过 Linux 下的[mlockall(2)](http://man7.org/linux/man-pages/man2/mlock.2.html)系统调用来做到这一点；这将适用于整个过程，但请阅读您需要通过的参数。

你真的需要把整个事情都拉到核心吗？如果它是一个 java 应用程序，您可能会将整个 JVM 锁定在内核中。我不知道执行此操作的命令行方法，但是您可以编写一个简单的程序来调用`fork`，调用`mlockall`，然后`exec`。

[您还可以查看madvise(2)](http://man7.org/linux/man-pages/man2/madvise.2.html)中的访问模式通知之一是否满足您的需求。如果它适用于您，向 VM 子系统建议更好的分页策略可能会更好。

请注意，很久以前现在在 SunOS 下，有一种类似于 madvise 的机制，称为[vadvise(2)](http://modman.unixdev.net/?sektion=2&page=vadvise&manpath=SunOS-4.1.3)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-10T10:35:32.113

如果您希望更改进程的交换性，请将其添加到 cgroup 并设置该 cgroup 的值：

[https://unix.stackexchange.com/questions/10214/per-process-swapiness-for-linux#10227](https://unix.stackexchange.com/questions/10214/per-process-swapiness-for-linux#10227)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T15:58:56.357

您可以通过[mlock](http://linux.die.net/man/2/mlock)系列系统调用来做到这一点。但是，我不确定您是否可以针对不同的流程执行此操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T16:56:07.000

作为超级用户，您可以将其“优化”到最高优先级 -20，并希望这足以防止它被换出。通常是这样。正数降低调度优先级。普通用户不能向上友好（负数）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-15T11:41:22.233

存在一类应用程序，您永远不希望它们交换。一个这样的类是数据库。数据库将使用内存作为其磁盘区域的缓存和缓冲区，并且将它们放入交换绝对没有任何意义。特定的内存可能会保存一些一周内不需要的相关数据，直到有一天客户要求它。如果没有缓存/交换，数据库将简单地在磁盘上找到相关记录，这将是相当快的；但是通过交换，您的服务可能突然需要很长时间才能响应。

`mysqld`包括使用操作系统/系统调用的代码`memlock`。在 Linux 上，至少从 2.6.9 开始，此系统调用将适用于具有`CAP_IPC_LOCK`能力[[1]](http://www.tutorialspoint.com/unix_system_calls/mlock.htm)的非 root 进程。使用`memlock()`时，进程必须仍然在`LimitMEMLOCK`限制范围内工作。[[2]](http://www.tutorialspoint.com/unix_system_calls/setrlimit.htm)。（少数）好处之一`systemd`是您可以授予`mysqld`进程这些功能，而无需特殊程序。If 还可以按照您的预期设置 rlimits `ulimit`。这是一个`override`用于`mysqld`执行必要步骤的文件，其中包括您可能需要的一些其他步骤，例如数据库：

```
[Service]
# Prevent mysql from swapping
CapabilityBoundingSet=CAP_IPC_LOCK

# Let mysqld lock all memory to core (don't swap)
LimitMEMLOCK=-1 

# do not kills this process if low on memory
OOMScoreAdjust=-900 

# Use higher io scheduling
IOSchedulingClass=realtime    

Type=simple    
ExecStart=
ExecStart=/usr/sbin/mysqld --memlock $MYSQLD_OPTS 
```

**注意**标准社区mysql目前附带`Type=forking` 并添加`--daemonize`选项到服务就`ExecStart`行了。这本质上不如上述方法稳定。

**更新**我对这个解决方案不是 100% 满意。经过几天的运行，我注意到这个过程仍然有大量的交换！检查`/proc/XXXX/smaps`，我注意到以下几点：

*   交换的最大贡献者来自堆栈段！**437 MB**和波动。这带来了明显的性能问题。它还表示基于堆栈的内存泄漏。
*   **锁定页面**为零。这表明`memlock`MySQL（或 Linux）中的选项已损坏。在这种情况下，这并不重要，因为 MySQL 不能 memlock 堆栈。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T17:11:45.497

除非在极不寻常的情况下，问这个问题意味着你做错了（tm）。

说真的，如果 Linux 想要交换并且您试图将进程保留在内存中，那么您对操作系统提出了不合理的要求。如果您的应用程序如此重要，那么 1) 购买更多内存，2) 从机器中删除其他应用程序/守护程序，或将机器专用于您的应用程序，和/或 3) 投资一个非常快速的磁盘子系统。这些步骤对于重要的应用程序是合理的。如果你不能证明它们是合理的，那么你可能也不能证明连接内存和饿死其他进程是合理的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T17:34:27.423

你为什么要这样做？
如果您试图提高此应用程序的性能，那么您可能走错了路。操作系统将换出一个进程以增加磁盘缓存的内存 - 即使有可用的 RAM，内核也最清楚（实际上编写调度程序的 samrt 人最清楚）。
如果您有一个需要响应的进程（它在不使用时被换出并且您需要它快速重新启动），那么将其设置为高优先级、mlock 或使用实时内核可能会有所帮助。

# forms - CRUD Web 表单设计的最佳示例

> ID：578146
> 
> 赞同：55
> 
> 时间：2009-02-23T15:56:02.230
> 
> 标签：forms

我正在寻找改进我们的 CRUD 网络表单，并希望有任何好的 UI 设计示例。

我们有很多数据库表，用户的编辑需求很少——国家代码、税码、产品价格等等——这些目前都使用简单的 CRUD 格式，但它是由开发人员设计的，看起来很平淡，并且很可能会有更好的可用性，当然还有更好的设计。

我们的流程是：

查找屏幕 - 还有一个添加新按钮。输入与搜索相关的任何参数的值，然后按 FIND 按钮。匹配的记录显示在带有 EDIT 链接的网格中。相应的编辑表单允许克隆、删除和保存。

在适当的情况下，编辑表单可以显示子记录。

对于非常复杂的记录/关系，编辑表单被记录卡取代，记录卡显示包括厨房水槽在内的所有内容！并且适当的记录/子记录具有编辑链接。

它的功能，但没有启发性。

在 80:20 的基础上，代码都是机械生成的，因此为新的隐喻重新生成代码应该不会太难。

我喜欢[Magento 电子商务管理](http://demo-admin.magentocommerce.com/index.php/admin/)页面中的很多 UI，但我会对您可以推荐的任何其他示例感兴趣

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-11-13T19:50:31.980

以下是一些 UI 模式的示例：

[输入控件](http://patternry.com/p=input-controls/)

[堆叠标签](http://patternry.com/p=vertical-module-tabs/)

[内联输入加法器](http://uipatternfactory.com/p=inline-input-adder/)

[一页向导](http://patternry.com/p=one-page-wizard/)

[覆盖](http://uipatternfactory.com/p=overlay/)

一般来说，每个部分都会解释模式、如何使用以及为什么使用，并提供一些图形作为真实世界的示例。

作为附加资源，您还可以访问[ThemeForest 的管理模板站点](http://themeforest.net/category/site-templates/admin-templates)并浏览他们的许多产品，并获取设计和样式都非常好的管理页面的图片和实时导览。我个人已经将其中一些模板用于数据繁重的网站。

希望这些对你有所帮助。

**2018 年 7 月 25 日更新：**虽然很难保持九年前的链接正常工作，但托管 UI 示例的网站现在似乎已经消失了。阅读[Patternry](http://patternry.com/post/169689695497/farewell-from-patternry)的告别以获取更多信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-20T19:31:06.050

值得一看的链接：

[http://www.smashingmagazine.com/2008/04/17/web-form-design-modern-solutions-and-creative-ideas/](http://www.smashingmagazine.com/2008/04/17/web-form-design-modern-solutions-and-creative-ideas/)

[http://somerandomdude.com/articles/design/form-design/](http://somerandomdude.com/articles/design/form-design/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T16:01:59.547

您可以使用 .Net 3.5 创建的动态数据网站非常方便。良好的清洁动态 CRUD 能力，但非常可定制。路由可以在需要时默认生成页面和自定义页面（如果您选择创建它们）。

[动态数据网站](http://www.asp.net/learn/3.5-SP1/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-19T02:26:36.207

这些家伙有很好的例子-

[http://wufoo.com/gallery/](http://wufoo.com/gallery/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-09-19T02:50:20.973

对我来说，[Django 管理界面](http://djangobook.com/django-admin-site/)是 CRUD 界面的一个很好的例子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-19T02:21:57.643

我刚刚偶然发现了这个

在那里你会发现几个非常棒的模板！！！

[http://www.webappers.com/2009/09/18/20-professional-web-admin-templates-on-themeforest/](http://www.webappers.com/2009/09/18/20-professional-web-admin-templates-on-themeforest/)

# .net - 如何强制从哪里加载程序集？

> ID：578152
> 
> 赞同：3
> 
> 时间：2009-02-23T15:57:26.983
> 
> 标签：.net, deployment, assemblies, assembly-resolution

我开发了一个控制台实用程序，可以对服务器应用程序执行一些操作。由于我正在使用的服务器应用程序的性质，我需要在服务器上执行此实用程序。

问题是该实用程序引用了以前部署到服务器 GAC 的通用 DLL。自通用 DLL 部署以来，它已经更新，我的实用程序依赖于这些更新。由于公司有关部署的政策，我无法更新 GAC 中的 DLL。

默认情况下，我的实用程序将使用 GAC 中过时的 DLL。有没有办法强制它使用更新的 DLL（例如，通过在文件系统上指定路径）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T16:01:12.950

更新的DLL没有新的版本号吗？我希望如果您强制引用使用正确的版本号，它应该选择本地版本号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T16:01:54.227

不幸的是，GAC 倾向于打一张王牌——但如果您更改了版本，那么 GAC 解析应该会失败（只要您在 IDE 中将“特定版本”设置为 true），允许它加载本地版本吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T16:01:10.300

Assembly 类有一些方法可以从特定位置加载程序集。

`Assembly.LoadFrom`有一些重载

编辑：有一种方法可以通过配置文件指定在哪里查找特定的程序集版本。我记不清了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-08T22:00:56.873

正如 foson 建议的那样，在控制台的配置文件中使用代码库。示例如下所示（适当更改 publicKeyToken、名称、版本和 href）。

```
<runtime> 
 <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"> 
  <dependentAssembly> 
     <assemblyIdentity name="myCommonDll" publicKeyToken="32ab4ba45e0a69a1" culture="neutral" />
     <codeBase version="2.0.0.0" href="file://C:\Users\djpiter\Documents/myCommon.dll"/>
  </dependentAssembly> 
 </assemblyBinding> 
</runtime> 
```

因此，这将是强制 CLR 将调用从 GAC 重定向到您的公共 DLL 到位于 href 位置的版本的最简单方法。您更新的通用 dll 应该像 GAC 中的一样具有强名称，具有相同的名称、文化、publickeytoken 但新版本。因此，唯一的变化是在控制台的配置文件中。您无需更改控制台源代码中的引用。您可以简单地继续使用现有的控制台应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T16:00:31.300

您可能想查看[AppDomain.AssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)事件。

编辑：仅当常规程序集解析失败时才会触发该事件，因此它不符合您的需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T16:09:35.223

[`<codebase>`](http://msdn.microsoft.com/en-us/library/efs781xb.aspx)尝试在 app.config 中使用元素

# javascript - 以编程方式创建 s和问题出现

> ID：578154
> 
> 赞同：0
> 
> 时间：2009-02-23T15:58:04.707
> 
> 标签：javascript, jquery, html

我是 javascript 新手，并编写了一段代码（粘贴在下面）。我正在尝试构建一个战舰小游戏。想想那个有一个网格的游戏，你可以在其中放置你的船只，如果它会击中任何对手的船只，就开始盲目地点击对手的网格。问题是我需要使用 DIV 的 ID 调用函数作为参数传递。当像下面这样以编程方式创建 DIV 时，什么会起作用。这个？: --///<.DIV id='whatever' onclick='javascript:function(this.ID)' /> .. 我在某处看到了这样的东西 .. 这在 html 中：S

js代码为：（有两个网格，用参数-who-...表示网格的大小也是参数化的）

```
function createPlayGround(rows, who)
{
    $('#container').hide();
        var grid = document.getElementById("Grid" + who);
        var sqnum = rows * rows;

        var innercode = '<table cellpadding="0" cellspacing="0" border="0">';
             innercode += '<tr>';
                for (i=1;i<=sqnum;i++)
                {
                    var rowno = Math.ceil(i / rows);
                    var colno = Math.ceil(i - ((rowno-1)*rows));
                    innercode += '<td><div id="' + who + '-' + i +'" class="GridBox'+ who +'" onmouseover="javascript:BlinkTarget(' + i + ',' + who +');" onclick="javascript:SelectTarget('+ i + ',' + who +');" >'+ letters[colno - 1] + rowno +'</div></td>';
                        if (i % rows == 0)
                        {
                           innercode += '</tr><tr>';
                        }
                }
            innercode += '</tr></table>';
            grid.innerHTML = innercode;
        $('#container').fadeIn('slow');
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T16:09:16.643

听起来您真正想要的是获取刚刚单击的 div 元素。如果您只想返回被点击的 div，您所要做的就是使用“this”：

```
<div id="whatever" onclick="function(this)"></div> 
```

如果您实际上对点击 div 的 id 更感兴趣，您可以这样做：

```
<div id="whatever" onclick="function(this.id)"></div> 
```

但是，听起来您只需要 id，以便您可以使用 getElementById 获取 div，第一个代码片段将帮助您跳过该步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T21:01:08.253

您可以使用 jQuery 创建它并添加事件侦听器，而不是从字符串创建内部 html，如下所示：

```
$("<div></div>")
  .click(function(e) {
    selectTarget(i, who);
  })
  .appendTo(container); 
```

# windows-installer - 使用 Inno Setup 有条件地安装 x64 驱动程序

> ID：578162
> 
> 赞同：2
> 
> 时间：2009-02-23T15:59:26.480
> 
> 标签：windows-installer, inno-setup, bootstrapping

我正在尝试使用 Inno Setup 引导具有所有必需先决条件的 WiX 生成的 .msi 文件。

在大多数情况下，这工作得很好，但我找不到任何信息来有条件地安装和运行基于 x86/x64 的先决条件安装程序，就像在 Windows Installer 中一样。

有人对此有任何运气吗？我试图避免仅仅因为一个驱动程序就拥有一个单独的 x64 安装程序。我正在引导的应用程序在 x86 中运行，并依赖 WOW 来支持 x64。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T16:02:42.010

查看 $(InnoSetup)/Examples 中的“64BitThreeArch.iss”示例，它安装三个不同的可执行文件之一，具体取决于安装运行的体系结构。您可以对所有脚本部分使用类似的检查。

# java - Ubuntu 8.04 中以下 jdk 路径的等价物是什么？

> ID：578165
> 
> 赞同：2
> 
> 时间：2009-02-23T16:00:57.677
> 
> 标签：java, ubuntu, openjdk, ubuntu-8.04

我必须设置以下两个变量：

```
export LD_LIBRARY_PATH=/usr/java/jdk1.6.0/jre/lib/i386/:/usr/java/jdk1.6.0/jre/lib/i386/client/:./
export JAVA_HOME=/usr/java/jdk1.6.0/ 
```

既然以上是通过 SunJDK 安装的 JDK 版本，那么`openjdk-6-jdk`包的等效路径可能是什么？

我的 OpenJDK 安装在：

```
/usr/lib/jvm/java-6-openjdk 
```

但是，我找不到文件夹`i386/`。我应该指向哪条路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T16:13:04.543

尽管确实如此，但该`open-jdk`软件包本身并未与`.so`Hardy 上的任何共享对象/库（文件）一起分发`open-jre`。

通常您不需要`LD_LIBRARY_PATH`手动设置，因为二进制文件应该自动在其众所周知的位置`java`查找任何标准库。`open-jre`但是，如果您遇到库依赖问题（请参阅`ldd`下面如何使用命令来识别此类未满足的依赖关系），您*可能*`LD_LIBRARY_PATH`需要指向`/usr/lib/jvm/java-6-openjdk/jre/lib/amd64/`（IIRC Slicehost 的架构是 AMD 64 位）或`/usr/lib/jvm/java-6-openjdk/jre/lib/i386/`.

也导出`JAVA_HOME`为`/usr/lib/jvm/java-6-openjdk`

您可以通过运行来确认`java`满足所有共享对象/库依赖项：

```
ldd $JAVA_HOME/bin/java 
```

有关作为 and 一部分分发的文件的完整列表`open-jdk`，`open-jre`请参阅[open-jdk (amd64) 文件列表](http://packages.ubuntu.com/hardy/amd64/openjdk-6-jdk/filelist)和[open-jre (amd64) 文件列表](http://packages.ubuntu.com/hardy/amd64/openjdk-6-jre/filelist)，或运行：

```
dpkg -L openjdk-6-jdk
dpkg -L openjdk-6-jre 
```

...在您的系统上。

# mysql - MySQL 导入/导出版本不兼容

> ID：578177
> 
> 赞同：0
> 
> 时间：2009-02-23T16:03:25.927
> 
> 标签：mysql, sql, mysql-error-1193

我从我自己的服务器（版本 5.0.67）上的 mysql 数据库中进行了转储，并尝试将其导入到我的其他数据库（版本 5.0.54）。但是，我收到错误：

```
ERROR 1193 (00000) at line 23: Unknown system variable 'character_set_client' 
```

我认为它指的是这一部分：

```
SET @saved_cs_client     = @@character_set_client;
SET character_set_client = utf8; 
```

我已尝试删除上述所有行，但这使错误变得更糟：

```
ERROR 1064 (00000) at line 23: You have an error in your SQL syntax.  Check the manual that corresponds to your MySQL server version for the right syntax to use near 'DEFAULT CHARSET=latin1 COMMENT='InnoDB free: 10240 kB; (`member 
```

任何帮助将不胜感激。

## 更新

我像这样使用了兼容性选项，但是在导入时我仍然遇到同样的错误！？跆拳道

```
mysqldump -u root -p dbname --compatible=mysql40  > mrdb.sql 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T16:48:13.213

如果您`mysqldump`用于进行数据转储，那么`--compatibility`您可以将其设置为某个较早版本的选项。5.0.54 有点问题，所以当你有机会的时候升级那个野兽。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T16:10:46.750

如果你安装了 phpMyAdmin，你可以用它来导出数据库。当您单击“导出”时，您将看到一个“兼容模式”选项，您可以在其中选择 MySQL 4 和 3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-16T04:26:07.737

变量的顺序可能不是错误的吗？只是一个猜测。

```
SET character_set_client = utf8;
SET @saved_cs_client     = @@character_set_client; 
```

# asp.net - 使用 LINQ 的 gridview 中的问题

> ID：578184
> 
> 赞同：0
> 
> 时间：2009-02-23T16:07:03.747
> 
> 标签：asp.net, linq, gridview

当我尝试使用 LINQ 在 gridview 中显示结果时，我收到此错误消息。“DataSource 和 DataSourceID 均在 'GridView1' 上定义。删除一个定义。” 我不知道该怎么办？这是我的代码

```
protected void SelectBtn_Click(object sender, EventArgs e)
{
    ShowEmployee();
}
private void ShowEmployee()
{
    DataClassesDataContext db = new DataClassesDataContext();
    var name = from E in db.Employees
               orderby E.Age ascending
               select E;
    GridView1.DataSource = name;
    GridView1.DataBind();        
}
protected void InsertBtn_Click(object sender, EventArgs e)
{
    int id = Convert.ToInt32(TxtId.Text);
    string name = TxtName.Text;
    string address = TxtAddress.Text;
    int age = Convert.ToInt32(TxtAge.Text);
    DataClassesDataContext db = new DataClassesDataContext();
    try
    {
        Employee emp = new Employee { EmployeeId = id, Name = name, Address = address, Age = age };
        db.Employees.InsertOnSubmit(emp);
        db.SubmitChanges();
        LblMessage.Text = "Employee has been added successfully";
        TxtId.Text = "";
        TxtName.Text = "";
        TxtAddress.Text = "";
        TxtAge.Text = "";
        ShowEmployee();
    }
    catch (Exception ee)
    {
        LblMessage.Text = ee.Message.ToString();
    }       
}
protected void UpdateBtn_Click(object sender, EventArgs e)
{
    string name=TxtName.Text;
    string address=TxtAddress.Text;
    DataClassesDataContext db = new DataClassesDataContext();
    Employee emp = db.Employees.FirstOrDefault(E => E.Name.StartsWith(name));
    emp.Address = address;
    db.SubmitChanges();
    ShowEmployee();
}
protected void DeleteBtn_Click(object sender, EventArgs e)
{
    DataClassesDataContext db = new DataClassesDataContext();
    Employee emp = db.Employees.Single(E => E.Address.StartsWith("Delhi"));
    db.Employees.DeleteOnSubmit(emp);
    db.SubmitChanges();
    ShowEmployee();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T17:02:46.390

您将 GridView1 标记中的 DataSourceID 属性设置为“LinqDataSource1”。这将网格绑定到在 GridView 之后声明的 LinqDataSource。然后在 ShowEmployee() 中，您在代码中设置 DataSource 属性，该属性将网格绑定到该方法中的查询。你不能两者都做。如果您打算在代码中绑定，请删除标记中的 DataSourceID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-13T15:34:37.277

如果要使用 C# 代码初始化数据集，请在网格的设计时清除 DataSourceID 属性。我更喜欢这种方法。在其他情况下，不要在运行时初始化数据集。

# php - 文件上传可以在 PHP 中超时吗？

> ID：578190
> 
> 赞同：40
> 
> 时间：2009-02-23T16:09:29.453
> 
> 标签：php, upload

嗨，我对 PHP 很陌生，我已经为要上传到我的服务器的非常大的 csv 文件创建了一个表单。有人向我提到，由于上传文件太大，浏览器会超时，这是真的吗？如果是这样，可以预防吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-02-23T16:17:10.837

您需要以下 php.ini 设置的正确值：

1.  [max_input_time](http://www.php.net/manual/en/info.configuration.php#ini.max-input-time)（**不是**max_execution_time！）
2.  [上传最大文件大小](http://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize)
3.  [post_max_size](http://www.php.net/manual/en/ini.core.php#ini.post-max-size)

有可能

4.  [内存限制](http://www.php.net/manual/en/ini.core.php#ini.memory-limit)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-23T16:19:25.730

如果它们的值太小，有一些配置指令可能会导致大型上传失败：

PHP

*   **[`max_input_time`](http://docs.php.net/manual/en/info.configuration.php#ini.max-input-time)**   允许脚本解析输入数据（如 POST、GET 和文件上传）的最长时间（以秒为单位）
*   **[`upload_max_filesize`](http://docs.php.net/manual/en/ini.core.php#ini.upload-max-filesize)**   上传文件的最大大小。
*   **[`post_max_size`](http://docs.php.net/manual/en/ini.core.php#ini.post-max-size)**   允许的帖子数据的最大大小。

阿帕奇

*   **[`TimeOut`](http://httpd.apache.org/docs/2.2/mod/core.html#timeout)**   服务器在请求失败之前等待某些事件的时间
*   **[`LimitRequestBody`](http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestbody)**   限制从客户端发送的 HTTP 请求正文的总大小

可能还有更多。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-23T16:24:18.323

解决 php 中对大文件上传处理不当的一个好方法是使用像[JUpload](http://jupload.sourceforge.net/)这样的上传器，它会在发送文件之前将文件分成块。这也有利于您的用户在上传时获得适当的进度反馈，并且他们可以一次上传多个文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-13T16:01:07.573

我可以使用以下设置解决此问题，您可以使用不同的值，但您明白了：

对于我的服务器，我将这些行放在脚本目录内的“.user.ini”文件中，您的服务器可能会寻找不同的文件，如果您在服务器上执行 phpinfo('user_ini.filename') 它将吐出您需要将值放入的文件

```
max_execution_time = 1800
max_input_time = -1
post_max_size = 100M
upload_max_filesize = 100M
memory_limit = 256M 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-23T16:20:48.630

上传非常大的文件时，您必须更改 4 个配置变量：

*   `upload_max_filesize`
*   `post_max_size`
*   `memory_limit`
*   `time_limit`

使用 set_time_limit() 可以在运行时增加时间限制。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-23T16:13:19.537

默认情况下，允许脚本运行 30 秒。您可以使用[set_time_limit() 函数](http://us2.php.net/set_time_limit)来改变它。此外，如果您的用户需要上传大文件，您需要更改 php.ini 文件中的 post_max_size 和/或 upload_max_filesize 值。

此外，如果您只想全局扩展超时限制，您可以在 php.ini 中更改 max-execution-time。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T16:12:23.657

是的，它是真实的。文件上传是通过 POST 请求完成的，请求通常会超时。您应该能够重新配置您的环境以获得更长的请求超时。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-23T16:17:19.823

不仅仅是超时会导致问题。可以上传的文件的最大大小有一些限制。这些限制可以在 php.ini 文件中更改：

post_max_size
upload_max_filesize memory_limit

查看[http://uk.php.net/ini.core](http://uk.php.net/ini.core)了解详情。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-29T14:29:54.540

我的回答与您的原始问题没有直接关系，但是如果您的 PHP 脚本前面有反向代理负载均衡器，负载均衡器可能会超时或阻止大量上传。如果您支持文件上传，请务必检查负载均衡器的配置。就像 PHP 一样，大多数负载均衡器的默认上传设置都非常小。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-25T19:46:37.450

如果更改上述任何参数似乎没有任何区别，则可能是某处的 html 表单包含名称 MAX_FILE_SIZE 作为隐藏字段。

`<input type="hidden" name="MAX_FILE_SIZE" value="10000000">`

在上面的例子中，任何超过 10MB 的文件都不会被上传。

# ocaml - 有关于 OCaml Sdl 的文档吗？

> ID：578192
> 
> 赞同：3
> 
> 时间：2009-02-23T16:10:09.013
> 
> 标签：ocaml, sdl

我正在为此使用 OCaml SDL 开发一个小游戏。我没有找到任何关于它的文档，所以我有三个问题：

1.  我想在windows下使用OCaml SDL，所以任何人都可以帮助我如何编译它，（我已经放弃并在虚拟PC上安装了linux）
2.  有没有关于如何使用 OCaml SDL 的文档？
3.  我正在使用一个 800x600 的窗口，我想在里面表示一些图形，例如那个像素表示背景，另一个表示岩石等等，那个（800x600）窗口的最佳表示是什么？作为一般情况，我使用的是 800 * 600 单元格的数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T20:02:10.390

> 1 - 我想在windows下使用ocaml sdl，所以任何人都可以帮助我如何编译它，（我已经放弃并在虚拟PC上安装了linux）

你能让 SDL 在 windows 下工作并用它编译 C 程序吗？如果是这样，那么您应该开始阅读[手册中有关使用 c 程序编译 ocaml 的章节。](http://caml.inria.fr/pub/docs/manual-ocaml/manual032.html#toc128)

> 2 - 有没有关于如何使用 OCAML SDL 的文档？

包中有文档。我想这不是最好的，因为在 ocaml 中真的没有一个包有像样的文档——我可以夸大其词，不是吗？

为了解决这个问题，您需要探索 SDL 中需要哪些函数，然后在 ocamlSDL 的源目录中的 MLI 文件中找到相应的函数。应该不会太糟糕。看起来它很有条理。我不得不用其他包来做这个。程序员有一些标准的命名约定，然后你真的只需要知道函数签名就可以了。

我会尽可能努力地假装您只是直接调用 SDL 来开展您的业务——在大多数情况下，这应该是那么容易。

> 3 - 我正在使用一个 800x600 的窗口，我想在里面表示一些图形，例如那个像素表示背景，另一个表示岩石等等，那个（800x600）窗口的最佳表示是什么？作为一般情况下，我使用 800 * 600 单元格的数组，我知道这是最丑陋的表示，但请提供任何建议

ocaml 中的 Hashtbl 非常有效——ocaml 实际上将它们用于变量范围。此外，任何散列冲突都会产生一个元素列表，这对于多层数据来说可能是很好的。

除此之外，您可能想要使用精灵。但我认为你应该先搞定基础，然后再实现精灵——抱歉冒昧，这是我的实现方法。

***编辑：***

根据您的评论和您当前的经验，我想提出最后的建议......不要使用 ocamlSDL。对于您所做的事情没有任何理由，尤其是刚刚学习语言的人-这是我收集到的，如果我错了，请纠正我。我的建议是使用内置于 ocaml 中的*独立于机器的*[图形](http://caml.inria.fr/pub/docs/manual-ocaml/libref/Graphics.html)模块！它具有完成这个简单游戏所需的所有功能。该模块非常简单，您应该能够直接进行设置。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-01T21:36:38.653

与 nlucaroni 大肆暗示的相反，ocamlsdl 的[文档](http://ocamlsdl.sourceforge.net/resources.html)实际上非常好。

ocamldoc 生成的文档甚至对大多数功能都有描述，您很可能不必查看 SDL 的 C 文档。

我提到的页面也有在 Windows 上编译的说明，尽管我从未尝试过遵循它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T17:29:52.043

例如这里是模块draw的接口，我们可以在屏幕上绘制像素：

val draw_player: int -> int -> unit

val draw_missile: int -> int -> unit

val draw_text_center: int -> int -> string -> unit

键入运动场

val empty_playfield: int -> int -> playfield

类型像素 = 背景 | 污垢 | 岩石

val set_playfield_pixel：playfield -> int -> int -> pixel -> unit

val draw_playfield: 运动场 -> 单位

val 更新：单位 -> 单位

这些是我们用来设计游戏的功能！！！好可怜哈！无论如何，要在 Windows 中使用该模块（它本身使用 ocamlsdl）我应该先编译它，我的问题是，绘制一个每像素 800x600 像素的屏幕是个好主意吗？并表示该屏幕，例如说像素（xy）表示背景或游戏的另一部分，什么是最好的表示？800x600的数组，我对此感到不舒服，表演和......你知道的！

# c# - System.Windows.Forms.TextBox 中的水印

> ID：578193
> 
> 赞同：14
> 
> 时间：2009-02-23T16:10:12.210
> 
> 标签：c#, .net, windows, .net-2.0, watermark

`System.Windows.Forms.TextBox`使用 C# 在 .Net 2.0 中实现水印功能的最佳方法是什么？

* * *

编辑：

使用来自 CodeProject 的现成组件非常容易。它还具有 The Code Project Open License (CPOL)。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-09-03T19:48:12.900

最近我需要一个水印文本框，首先出现在我脑海中的是文本框的 OnLeave 和 OnEnter 事件，但首先我用谷歌搜索了它，我首先得到了两个链接，其中一个是 CodeProject 中使用 System.Drawing 命名空间的链接，另一个是使用 System.Drawing 命名空间的链接一个在这里使用 SendMessage() 在这里[http://vidmar.net/weblog/archive/2008/11/05/watermarked-textbox-in-windows-forms-on-.net.aspx](http://vidmar.net/weblog/archive/2008/11/05/watermarked-textbox-in-windows-forms-on-.net.aspx)。

我相信 SendMessage 更容易，而且它也没有闪烁。虽然我用过。

我希望它对你有帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-23T16:39:23.437

它并不像人们想象的那么简单。您需要使用 System.Drawing 命名空间并覆盖 OnPaint 事件。

以下是一些已经做过的人的链接。

[链接](http://www.codeproject.com/KB/miscctrl/WaterMark.aspx)和[链接](http://www.c-sharpcorner.com/UploadFile/scottlysle/WatermarkCS05072007024947AM/WatermarkCS.aspx)

# python - 使用 wxPython 创建可滚动区域的最简单方法？

> ID：578200
> 
> 赞同：0
> 
> 时间：2009-02-23T16:12:36.293
> 
> 标签：python, scroll, wxwidgets, scrolledwindow

好的，所以我想在窗口中显示一系列窗口并让整个窗口可滚动。我一直在寻找[wxWidgets 文档](http://docs.wxwidgets.org/stable/wx_wxscrolledwindow.html#wxscrolledwindow)和来自 t'internet 上各种来源的大量示例。其中大多数似乎暗示 wx.ScrolledWindow 应该可以工作，如果我只是将一组嵌套的sizer（？）传递给它：

> 最自动和最新的方法是简单地让 sizer 确定滚动区域。现在，当您使用 wxWindow::SetSizer 将内部 sizer 设置到 wxScrolledWindow 时，这是默认设置。滚动区域将设置为 sizer 请求的大小，滚动条将根据需要和 wxScrolledWindow::SetScrollRate 设置的滚动增量分配给每个方向。

...但是我看到的所有示例似乎都使用列出的旧方法来实现滚动。我有一些基本的工作，但是一旦你开始滚动你就会失去子窗口：

```
import wx

class MyCustomWindow(wx.Window):
    def __init__(self, parent):
        wx.Window.__init__(self, parent)
        self.Bind(wx.EVT_PAINT, self.OnPaint)
        self.SetSize((50,50))

    def OnPaint(self, event):
        dc = wx.BufferedPaintDC(self)
        dc.SetPen(wx.Pen('blue', 2))
        dc.SetBrush(wx.Brush('blue'))
        (width, height)=self.GetSizeTuple()
        dc.DrawRoundedRectangle(0, 0,width, height, 8)

class TestFrame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self, None, -1)

        self.Bind(wx.EVT_SIZE, self.OnSize)

        self.scrolling_window = wx.ScrolledWindow( self )
        self.scrolling_window.SetScrollRate(1,1)
        self.scrolling_window.EnableScrolling(True,True)
        self.sizer_container = wx.BoxSizer( wx.VERTICAL )
        self.sizer = wx.BoxSizer( wx.HORIZONTAL )
        self.sizer_container.Add(self.sizer,1,wx.CENTER,wx.EXPAND)
        self.child_windows = []
        for i in range(0,50):
            wind = MyCustomWindow(self.scrolling_window)
            self.sizer.Add(wind, 0, wx.CENTER|wx.ALL, 5)
            self.child_windows.append(wind)

        self.scrolling_window.SetSizer(self.sizer_container)

    def OnSize(self, event):
        self.scrolling_window.SetSize(self.GetClientSize())

if __name__=='__main__':
    app = wx.PySimpleApp()
    f = TestFrame()
    f.Show()
    app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T00:32:25.780

哎呀..原来我正在严重地创建我的子窗口：

```
wind = MyCustomWindow(self) 
```

应该：

```
wind = MyCustomWindow(self.scrolling_window) 
```

..这意味着子窗口正在等待重新绘制顶级窗口（框架）而不是监听滚动窗口。改变这一切让一切都很好:)

# c - C中的“注册”关键字？

> ID：578202
> 
> 赞同：299
> 
> 时间：2009-02-23T16:12:43.297
> 
> 标签：c, memory, keyword

C语言中关键字的作用是什么`register`？我读过它用于优化，但在任何标准中都没有明确定义。它仍然相关吗？如果是，你什么时候使用它？

* * *

## 回答 #1

> 赞同：370
> 
> 时间：2009-02-23T16:14:35.633

这是对编译器的一个提示，即该变量将被大量使用，并且您建议尽可能将其保存在处理器寄存器中。

大多数现代编译器会自动执行此操作，并且比我们人类更擅长挑选它们。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-02-23T18:01:44.237

我很惊讶没有人提到你不能获取寄存器变量的地址，即使编译器决定将变量保存在内存中而不是寄存器中。

所以使用`register`你什么都不会（无论如何编译器会自己决定将变量放在哪里）并失去`&`运算符 - 没有理由使用它。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-02-23T16:14:15.323

它告诉编译器尝试使用 CPU 寄存器而不是 RAM 来存储变量。寄存器位于 CPU 中，访问速度比 RAM 快得多。但这只是对编译器的建议，可能不会贯彻执行。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-12-16T23:03:31.373

我知道这个问题是关于 C 的，但是 C++ 的同一个问题作为这个问题的完全重复而被关闭。因此，这个答案可能不适用于 C。

* * *

C++11 标准的最新草案[N3485](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2012/n3485.pdf)在 7.1.1/3 中这样说：

> 说明`register`符是对实现的提示，即如此声明的变量将被大量使用。[*注意：*提示可以被忽略，并且在大多数实现中，如果获取变量的地址，它将被忽略。这种用法已被弃用... —*尾注*]

在 C++ 中（但**不是**在 C 中），标准并未声明您不能获取声明的变量的地址`register`；但是，由于在整个生命周期中存储在 CPU 寄存器中的变量没有与之关联的内存位置，因此尝试获取其地址将是无效的，并且编译器将忽略`register`关键字以允许获取地址。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-02-23T16:14:25.680

至少 15 年以来它一直没有相关性，因为优化人员对此做出了比你更好的决策。即使它是相关的，它在具有大量寄存器的 CPU 架构（如 SPARC 或 M68000）上比在 Intel 上更有意义，因为它缺乏寄存器，其中大部分由编译器保留用于自己的目的。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2015-03-29T22:16:20.757

> 我读过它用于优化，但在任何标准中都没有明确定义。

事实上，它*是*由 C 标准明确定义的。引用[N1570 草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)第 6.7.1 节第 6 段（其他版本有相同的措辞）：

> 使用存储类说明符为对象声明标识符**`register`**建议尽可能快地访问该对象。此类建议的有效程度由实施定义。

一元运算`&`符不能应用于用 定义的对象`register`，`register`也不能在外部声明中使用。

还有一些其他（相当模糊的）特定于`register`-qualified 对象的规则：

*   ~~`register`定义具有未定义行为的数组对象。~~
    **更正：**用 定义数组对象是合法的`register`，但你不能对这样的对象做任何有用的事情（索引到数组需要获取其初始元素的地址）。
*   说明`_Alignas`符（C11 中的新）可能不适用于此类对象。
*   如果传递给`va_start`宏的参数名称是`register`-qualified，则行为未定义。

可能还有其他几个；如果您有兴趣，请下载标准草案并搜索“注册”。

顾名思义，*原意*是`register`要求将一个对象存放在一个CPU寄存器中。但是随着优化编译器的改进，这变得不那么有用了。C 标准的现代版本不涉及 CPU 寄存器，因为它们不再（不需要）假设存在这样的事情（有些架构不使用寄存器）。普遍的看法是，应用于`register`对象声明更有可能使生成的代码*恶化*，因为它会干扰编译器自己的寄存器分配。可能仍然存在一些有用的情况（例如，如果您确实知道变量被访问的频率，并且您的知识比现代优化编译器所能计算的要好）。

的主要有形效果`register`是它可以防止任何尝试获取对象地址的尝试。这作为优化提示并不是特别有用，因为它只能应用于局部变量，并且优化编译器可以自己看到这样的对象的地址没有被占用。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-12-17T00:36:12.327

实际上，寄存器告诉编译器该变量不与程序中的其他任何东西（甚至不是字符）混为一谈。

现代编译器可以在各种情况下利用这一点，并且可以在复杂代码中为编译器提供相当多的帮助——在简单代码中，编译器可以自己解决这个问题。

否则，它没有任何作用，也不用于寄存器分配。只要您的编译器足够现代，指定它通常不会导致性能下降。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2017-05-09T05:35:21.567

讲故事的时间！

C作为一种语言，是计算机的抽象。它允许你做一些事情，就计算机所做的而言，即操作内存、做数学、打印等等。

但是C只是一个抽象。最终，它从*您*那里提取的是汇编语言。汇编是 CPU 读取的语言，如果你使用它，你就按照 CPU 来做事。CPU有什么作用？基本上，它从内存中读取，进行数学运算，然后写入内存。CPU 不仅仅对内存中的数字进行数学运算。首先，您必须将一个数字从内存移动到 CPU 内部称为*寄存器的内存*. 一旦你完成了对该号码的任何操作，你可以将它移回正常的系统内存。为什么要使用系统内存？寄存器数量有限。在现代处理器中，您只能获得大约 100 个字节，而较旧的流行处理器则更加有限（6502 有 3 个 8 位寄存器供您免费使用）。因此，您的平均数学运算如下所示：

```
load first number from memory
load second number from memory
add the two
store answer into memory 
```

其中很多是......不是数学。这些加载和存储操作可能会占用您一半的处理时间。C 作为计算机的抽象，让程序员不必担心使用和处理寄存器，并且由于计算机之间的数量和类型不同，C 将寄存器分配的责任完全交给了编译器。除了一个例外。

当你声明一个变量`register`，你是在告诉编译器“哟，我打算让这个变量被大量使用和/或短暂存在。如果我是你，我会尝试将它保存在寄存器中。” 当 C 标准说编译器实际上不需要做任何事情时，那是因为 C 标准不知道您正在为哪台计算机编译，它可能就像上面的 6502 一样，需要所有 3 个寄存器才能运行，并且没有备用寄存器来保存您的号码。但是，当它说您不能获取地址时，那是因为寄存器没有地址。它们是处理器的手。由于编译器不必为您提供地址，并且由于它根本没有地址，因此现在对编译器开放了一些优化。比如说，它可以将号码始终保存在寄存器中。它没有 不必担心它在计算机内存中的存储位置（无需再次取回）。它甚至可以把它变成另一个变量，把它交给另一个处理器，给它一个改变的位置，等等。

tl; dr：做大量数学运算的短期变量。不要一次声明太多。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-23T16:21:30.827

您正在弄乱编译器复杂的图形着色算法。这用于寄存器分配。嗯，大部分。它作为对编译器的提示——这是真的。但不要完全忽略，因为您不允许获取寄存器变量的地址（请记住，编译器现在取决于您的怜悯，将尝试采取不同的行动）。这在某种程度上告诉你不要使用它。

这个关键字被使用了很久很久。当只有很少的寄存器可以用食指计算它们时。

但是，正如我所说，弃用并不意味着您不能使用它。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-06-28T10:49:48.753

只是一个小演示（没有任何实际目的）用于比较：当删除`register`每个变量之前的关键字时，这段代码在我的 i7 (GCC) 上需要 3.41 秒，*相同* `register`的代码在 0.7 秒内完成。

```
#include <stdio.h>

int main(int argc, char** argv) {

     register int numIterations = 20000;    

     register int i=0;
     unsigned long val=0;

    for (i; i<numIterations+1; i++)
    {
        register int j=0;
        for (j;j<i;j++) 
        {
            val=j+i;
        }
    }
    printf("%d", val);
    return 0;
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-04-29T11:34:27.937

我已经使用以下代码在 QNX 6.5.0 下测试了 register 关键字：

```
#include <stdlib.h>
#include <stdio.h>
#include <inttypes.h>
#include <sys/neutrino.h>
#include <sys/syspage.h>

int main(int argc, char *argv[]) {
    uint64_t cps, cycle1, cycle2, ncycles;
    double sec;
    register int a=0, b = 1, c = 3, i;

    cycle1 = ClockCycles();

    for(i = 0; i < 100000000; i++)
        a = ((a + b + c) * c) / 2;

    cycle2 = ClockCycles();
    ncycles = cycle2 - cycle1;
    printf("%lld cycles elapsed\n", ncycles);

    cps = SYSPAGE_ENTRY(qtime) -> cycles_per_sec;
    printf("This system has %lld cycles per second\n", cps);
    sec = (double)ncycles/cps;
    printf("The cycles in seconds is %f\n", sec);

    return EXIT_SUCCESS;
} 
```

我得到以下结果：

-> 807679611 个周期已过

-> 这个系统每秒有 3300830000 个循环

-> 以秒为单位的周期约为 0.244600

现在没有注册int：

```
int a=0, b = 1, c = 3, i; 
```

我有：

-> 1421694077 个周期已过

-> 这个系统每秒有 3300830000 个循环

-> 以秒为单位的周期约为 0.430700

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-11-08T13:55:29.717

七十年代，在 C 语言最开始的时候，就引入了 register 关键字，以便程序员给编译器提示，告诉它这个变量会经常使用，明智的做法是将其值保存在处理器的内部寄存器之一中。

如今，优化器比程序员更有效地确定更有可能保存到寄存器中的变量，并且优化器并不总是考虑程序员的提示。

很多人错误地建议不要使用 register 关键字。

让我们看看为什么！

register 关键字有一个相关的副作用：您不能引用（获取地址）寄存器类型变量。

建议其他人不要使用寄存器的人错误地将此作为附加论点。

但是，知道不能获取寄存器变量的地址这一简单事实允许编译器（及其优化器）知道该变量的值不能通过指针间接修改。

当在指令流的某个点，一个寄存器变量的值被分配到处理器的寄存器中，并且该寄存器没有被使用，因为获取另一个变量的值，编译器知道它不需要重新加载该寄存器中变量的值。这允许避免昂贵的无用内存访问。

做你自己的测试，你会在最内部的循环中获得显着的性能改进。

[c_register_side_effect_performance_boost](http://www.codotips.com/?lang=english&c_register_side_effect_performance_boost)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-23T16:16:31.027

寄存器会通知编译器，编码器认为该变量将被写入/读取到足以证明其存储在可供变量使用的少数寄存器之一中是合理的。从寄存器读取/写入通常更快，并且可能需要更小的操作码集。

如今，这不是很有用，因为大多数编译器的优化器在确定是否应将寄存器用于该变量以及使用多长时间方面都比您更好。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-04-10T14:05:02.693

gcc 9.3 asm 输出，不使用优化标志（此答案中的所有内容均指不带优化标志的标准编译）：

```
#include <stdio.h>
int main(void) {
  int i = 3;
  i++;
  printf("%d", i);
  return 0;
} 
```

```
.LC0:
        .string "%d"
main:
        push    rbp
        mov     rbp, rsp
        sub     rsp, 16
        mov     DWORD PTR [rbp-4], 3
        add     DWORD PTR [rbp-4], 1
        mov     eax, DWORD PTR [rbp-4]
        mov     esi, eax
        mov     edi, OFFSET FLAT:.LC0
        mov     eax, 0
        call    printf
        mov     eax, 0
        leave 
        ret 
```

```
#include <stdio.h>
int main(void) {
  register int i = 3;
  i++;
  printf("%d", i);
  return 0;
} 
```

```
.LC0:
        .string "%d"
main:
        push    rbp
        mov     rbp, rsp
        push    rbx
        sub     rsp, 8
        mov     ebx, 3
        add     ebx, 1
        mov     esi, ebx
        mov     edi, OFFSET FLAT:.LC0
        mov     eax, 0
        call    printf
        add     rsp, 8
        pop     rbx
        pop     rbp
        ret 
```

这强制`ebx`用于计算，这意味着它需要被推入堆栈并在函数结束时恢复，因为它是被调用者保存的。`register`产生更多的代码行和 1 次内存写入和 1 次内存读取（尽管实际上，如果在 中完成计算，这可能已经优化为 0 R/W `esi`，这就是使用 C++ 发生的情况[`const register`](https://stackoverflow.com/questions/3207018/register-keyword-in-c/61150733#61150733)）。不使用`register`会导致 2 次写入和 1 次读取（尽管读取时会发生存储到加载转发）。这是因为该值必须存在并直接在堆栈上更新，因此可以通过地址（指针）读取正确的值。`register`没有这个要求，不能指向。`const`并且`register`基本上`volatile`与使用相反`volatile`将覆盖文件和块范围的 const 优化以及块范围的`register`优化。`const register`并且`register`将产生相同的输出，因为 const 在块范围内对 C 没有任何作用，因此仅`register`适用于优化。

在铿锵声，`register`被忽略，但`const`优化仍然发生。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-23T16:17:12.617

在受支持的 C 编译器上，它会尝试优化代码，以便将变量的值保存在实际的处理器寄存器中。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-02-25T16:49:19.220

`register`启用全局寄存器分配优化（/Oe 编译器标志）时，Microsoft 的 Visual C++ 编译器会忽略该关键字。

请参阅MSDN 上的[注册关键字](http://msdn.microsoft.com/en-us/library/482s4fy9.aspx)。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-06-14T11:08:17.593

Register 关键字告诉编译器将特定变量存储在 CPU 寄存器中，以便可以快速访问它。从程序员的角度来看，寄存器关键字用于程序中大量使用的变量，以便编译器可以加速代码。虽然这取决于编译器是将变量保存在 CPU 寄存器还是主存储器中。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-06-14T11:30:46.030

寄存器指示编译器通过将该特定变量存储在寄存器中然后存储在内存中来优化此代码。这是对编译器的请求，编译器可能会也可能不会考虑这个请求。如果您的某些变量被非常频繁地访问，您可以使用此工具。例如：循环。

另一件事是，如果您将变量声明为寄存器，那么您将无法获取其地址，因为它未存储在内存中。它在 CPU 寄存器中分配。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-02-01T02:21:52.163

register 关键字是对编译器的请求，将指定的变量存储在处理器的寄存器而不是内存中，作为提高速度的一种方式，主要是因为它将被大量使用。编译器可能会忽略该请求。

# java - 生成两个bean中字段差异的通用算法？

> ID：578209
> 
> 赞同：10
> 
> 时间：2009-02-23T16:14:02.233
> 
> 标签：java, algorithm, diff, javabeans

假设您有两个相同 bean 类型的实例，并且您希望显示两个实例之间发生变化的摘要 - 例如，您有一个 bean 代表应用程序中的用户设置，并且您希望能够显示用户提交的新设置（实例#1）与已经为用户存储的设置（实例#2）的更改列表。

对于这样的任务，是否有一种常用的算法或设计模式，也许可以抽象出来并重新用于不同类型的 bean？（我很难为这类问题想一个好名字来知道谷歌要做什么）。我检查了 commons-beanutils 并没有弹出任何内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T16:31:37.167

如果您在谈论比较值，我会考虑使用反射并逐个字段地比较它们。

像这样的东西：

```
 Field[] oldFields = oldInstance.class.getDeclaredFields();
    Field[] newFields = newInstance.class.getDeclaredFields();
    StringBuilder changes = new StringBuilder();

    Arrays.sort(oldFields);
    Arrays.sort(newFields);

    int i = 0;
    for(Field f : oldFields)
    {
       if(!f.equals(newFields[i]))
       {
          changes.append(f.getName()).append(" has changed.\n");
       }
       i++;
    } 
```

此代码尚未经过测试。您可能需要获取字段中的值并比较它们，而不是仅仅将字段相互比较，但它应该在理论上有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T16:47:50.000

反射不会在下一次调用中保持字段的顺序：它对数组进行更安全的排序。

```
/*
*declarations of variables
*/

Arrays.sort(oldFields);//natural order - choice 1
Arrays.sort(newFields, new Ordinator());//custom Comparator - choice 2

/*
*logic of comparations between elements
*/ 
```

[在选项 2 中，您可以使用扩展 Comparator](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Comparator.html)的内部类 Ordinator 来决定排序逻辑（如何对元素进行排序）。

PS 代码是草稿

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T18:04:42.967

我们用 bean utils 做了一些类似的事情，而且效果很好。需要考虑的事项：您是否深入了解字段对象 - 如果一个人包含地址并且地址更改，您是说地址更改还是 address.postalCode 更改（我们这样做）？您是否从 diff 中返回列表属性名称、旧值、新值（我们这样做）？您想如何处理日期 - 如果您只关心日期部分，那么您的比较应该忽略时间？你怎么说忽略哪些字段？

这并不是真正的复制和粘贴答案，而是更多在我们编写不同之处时并不立即显而易见的事情列表。

至于实现，我们只有一个静态 util 方法，它接受两个 bean 和一个要比较的属性列表，然后将属性映射返回到包含旧值和新值的 Pair。然后每个bean都有一个`diff(Object o)`方法，根据需要调用静态util方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-15T05:23:03.050

这些库应该会有所帮助。

[https://code.google.com/p/beandiff/](https://code.google.com/p/beandiff/) - 基于注释的 bean 差异库。阿帕奇许可证 2.0

[https://github.com/SQiShER/java-object-diff/](https://github.com/SQiShER/java-object-diff/) - bean 因访问者模式而异。阿帕奇许可证 2.0

我们需要生成 json 格式的 bean 之间的差异以用于审计目的。我们最终使用[beandiff](https://code.google.com/p/beandiff/)库来实现它。

** 编辑 ** 这看起来像是一个较新的选项。我还没有使用它。

[http://beandiff.org/](http://beandiff.org/)

希望能帮助到你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T18:45:09.047

楼上的好答案。

如果您的数据在结构上发生变化，即整个字段集合可能相关或不依赖于其他字段，您可能需要考虑[差异执行](https://stackoverflow.com/questions/371898/how-does-differential-execution-work)。

基本上，您对字段有一个循环，并且在反序列化先前值的同时序列化当前字段值，并在进行时比较它们。

如果有条件测试使字段块相关或不相关，则序列化/反序列化条件测试的真或假值，并使用它来决定是否序列化和/或反序列化受影响的字段。它很好地重现。

只是一个建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T00:23:58.350

使用反射和标准数据结构的解决方案。

```
 Field[] declaredFields = ClassOne.class.getDeclaredFields();
    Field[] declaredFields2 = ClassTwo.class.getDeclaredFields();
    ArrayList<String> one = new ArrayList<String>();
    ArrayList<String> two = new ArrayList<String>();
    for (Field field : declaredFields)
    {
        one.add(field.getName());
    }

    for (Field field : declaredFields2)
    {
        two.add(field.getName());
    }

    List<String> preone = (List<String>)one.clone();

    one.removeAll(two);
    two.removeAll(preone);
    Collections.sort(one);
    Collections.sort(two);

    System.out.println("fields only in One : " + one);
    System.out.println("fields only in Two : " + two); 
```

# asp.net - 项目符号从项目符号列表中消失

> ID：578211
> 
> 赞同：0
> 
> 时间：2009-02-23T16:14:25.650
> 
> 标签：asp.net, css

我正在尝试`<ul>`在 LiteralControl 中输出项目符号列表 ( )，但更高的功率不喜欢项目符号。当我检查一个`<li>`元素时，它继承`list-style-type: none`了 extJS 样式的样式。但是，当我在`ul`标签中包含正确的样式时，使用以下代码，列表会以空样式属性呈现，例如`style=""`. 如果我将样式放在列表中的单个列表项中，也会发生同样的情况。

```
sb.AppendFormat("<br />{0}<ul style=\"list-style-type: disk\">", Environment.NewLine); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T16:16:53.927

你有没有尝试过

```
list-style-type: disc 
```

反而？（`disk`应该是`disc`）

# c++ - Visual Studio C++ 编译器中的错误？

> ID：578217
> 
> 赞同：2
> 
> 时间：2009-02-23T16:15:47.767
> 
> 标签：c++, visual-studio, visual-c++, standards-compliance

此代码在 MS Visual Studio 中的行为很奇怪：

```
char *s = "hello";
s[0] = 'a';
printf(s); 
```

在启用优化的发布版本中，它会忽略 s[0] = 'a' 并打印“hello”。如果没有优化或调试版本，它会因访问冲突而崩溃。
这种行为是否符合 C++ 标准？在我看来，编译器应该只允许对字符串文字的常量引用，即

```
const char *s = "hello"; 
```

**编辑**：我知道它为什么这样工作，我不明白为什么允许我对只读内存进行非常量引用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-23T16:20:46.397

不，这不是编译器中的错误。当你写：

```
char* s = "hello"; 
```

字符串常量`"hello"`将放置在只读部分中，如果您尝试修改它，应该会生成异常。（操作系统异常，而不是 C++ 异常）。

要使其可写，您必须使用数组：

```
char s[] = { 'h', 'e', 'l', 'l', 'o', 0 }; 
```

或者，如果你真的需要一个指针，让它指向一个数组：

```
char _s[] = { 'h', 'e', 'l', 'l', 'o', 0 };
char* s = _s; 
```

我可以理解您关于只允许使用字符串文字初始化 const 指针的观点，但我认为这会破坏*很多*现有代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-23T16:28:56.393

首先允许此代码（而不是要求声明为 type `char const*`）的原因是向后兼容旧的 C 代码。

不过，大多数处于严格模式的现代编译器都会对上述代码发出**警告！**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T16:19:24.000

我认为 C++ 编译器可以按照标准在只读内存页中分配字符串文字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T16:20:59.923

这是行不通的，因为 *s 指向一个字符串常量的内存地址，你不能改变它。

实际上，我有点惊讶您在使用优化编译时没有遇到访问冲突。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T16:28:28.797

```
char *s = "foo"; 
```

是一匹狡猾的小马。它并没有告诉您这确实是一个只读字符串，而实际上它是。之所以如此，是因为您可以让您的同事编写另一个字符串，例如：

```
char *t = "foo"; 
```

现在，编译器在其最有用的情况下只会保留一份副本，而更改一份将意味着**大量**工作，只是为了让您和您的朋友满意。因此，它不会尝试这样做。这是您应该在标准中找到的内容。你猜怎么着，你在做什么调用UB。

也就是说，如果你按照自己的方式行事，就会破坏许多标准委员会的穷人负担不起的遗留代码。所以，你来了。

请记住，`const`我们对无忧无虑的使用感到内疚不是一天产生的。Bjarne 做了很多反省，很多其他人也这样做了，不管是否把它放进去。事实上，他有一个很好的主意，即拥有只读和只写变量……但我会把这个故事留到另一天。

最后，还有我们需要照顾的好朋友 C。所以 ...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T16:25:07.887

正如其他人所说，您不能修改字符串文字。我还想知道为什么您的代码中没有编译器警告。编译器可以肯定地确定您正在尝试写入只读内存。

# .net - 对多个 XML 配置文件进行序列化/反序列化

> ID：578218
> 
> 赞同：1
> 
> 时间：2009-02-23T16:16:11.497
> 
> 标签：.net, configuration, serialization, xml-serialization

我在 .NET 中有一组自定义 XML 配置管理类。

我的应用程序中有两个配置范围：

**User**：无论她登录的帐户如何，该设置都适用于用户。存储在用户目录中的 XML 配置文件中。

**用户/帐户：**该设置适用于登录到特定帐户的用户。存储在用户目录中特定帐户子目录下的 XML 配置文件中。

这两个 XML 文档具有相同的结构，并且可以手动修改。当应用程序启动时，我从用户的配置文件中读取 XML 配置，并从 User/Account 目录中读取 XML 配置。然后我将这两个 XML 文档合并到一个 XDocument 中，然后将 XML 反序列化为在 XDocument 的部分之后建模的对象。如果存在用户/帐户级别设置，它应该覆盖用户级别设置。例子：

**用户档案：**

```
<FileSettings>
  <DownloadPath>C:\downloads</DownloadPath>
  <UploadPath>C:\uploads</UploadPath>
</FileSettings> 
```

**账户 XYZ 的用户/账户文件：**

```
<FileSettings>
  <DownloadPath>C:\newlocation\xyz\mystuff</DownloadPath>
</FileSettings> 
```

**合并后的结果：**

```
<FileSettings>
  <DownloadPath>C:\newlocation\xyz\mystuff</DownloadPath>
  <UploadPath>C:\uploads</UploadPath>
</FileSettings> 
```

在上面的示例中，将从该部分实例化具有 2 个属性的 FileSettings 对象 - DownloadPath 和 UploadPath。

**这是我的问题：**我不知道 DownloadPath 和 UploadPath 来自哪个配置文件（即范围）。结果，当对象需要再次序列化时，它不知道哪些属性放在哪个文件中。

**问题：**在逐个属性的基础上存储“源”的最佳方法是什么，以便我可以确保将设置写入读取它的同一配置文件？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T16:28:23.243

合并后，是否可以附加每个属性的值源？

```
<FileSettings>
  <DownloadPath>C:\newlocation\xyz\mystuff</DownloadPath>
  <UploadPath>C:\uploads</UploadPath>
  <DownloadPathSrc>xyz</DownloadPathSrc>
  <DownloadPathSrc>user</DownloadPathSrc>
</FileSettings> 
```

如果是这样，两个 src 属性可以反序列化到您的 FileSettings 对象中，在再次序列化到文件之前，您可以为每个源创建一个全新的 FileSetting 对象而不设置 *src 属性，默认情况下不会序列化空字符串通过 XmlSerializer。使用 src 属性，您可以知道要将对象序列化到哪个文件。

编辑，如果你想添加**src**作为元素的属性。这实际上也是我最初的想法，但是，您需要为每个属性创建类。例如 FileSetting 类中的属性 DownloadPath

```
[XmlType()]
public class DownloadPath
{ 
  [XmlAttribute]
  public string Src;   
  [XmlText]
  public string Text;
}
// serialize to
<DownloadPath Src="...">text</DownloadPath> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T17:00:20.033

我希望像这样向 XML 添加一些属性：

```
<FileSettings>
   <DownloadPath src="Account">C:\newlocation\xyz\mystuff</DownloadPath>
   <UploadPath src="User">C:\uploads</UploadPath>
</FileSettings> 
```

更容易实现内容的分离层。

# c# - 在 log4j/log4net 中捕获标准输出

> ID：578230
> 
> 赞同：4
> 
> 时间：2009-02-23T16:17:23.660
> 
> 标签：c#, java, logging, stdout

我有一个用 Java 写入标准输出的库。我想使用 log4j 在日志中捕获此输出。（我没有编写这个库，所以我无法控制库中的代码）。

是否有捷径可寻？System.setOut 是正确的方法吗？我将什么传递给 System.setOut？

另外，您将如何在 .NET/C# 中执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T16:45:23.157

一种解决方案是子类化`OutputStream`. 您只需执行`write( int b )`. 然后在构造函数中创建`PrintStream`一个`OutputStream`。

它可能看起来像：

```
public class L4JOS extends OutputStream {
  logger = Logger.getLogger( "std.out" );
  private int lineEnd = (int)'\n';
  private ByteArrayOutputStream baos = new ByteArrayOutputStream();

  public void write( int b ) throws IOException {
    baos.write( b );
    if ( b == lineEnd ) {
      logger.info( baos.toString() );
      baos.reset();
    }
  }

} 
```

如果它是多线程的，那么你有更多的工作。并确保 appender 不会转到 System.out。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T16:47:06.523

您可以实现自己的 OutputStream，它只将输出的任何内容记录到 log4j，然后将用户 System.setOut 记录到该 OutputStream 的实例。

请注意，在 log4j 在标准输出上输出内容的情况下，这可能会导致无限循环。

因此，您可能应该进行一些过滤以确定要传递给 log4j 的内容以及传递给原始 stdout 流的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T16:20:29.410

你为什么想这么做。您不应该直接写入 sysout，如果要输出到 sysout，则应该写入 log4j 并配置控制台附加程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T16:21:14.370

您应该能够将 GUI 应用程序[电锯](http://logging.apache.org/chainsaw/index.html)连接到标准输出并获得所需的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T19:06:39.300

我不想使用 setOut() 因为它是一个全局变量。你会遇到“远距离行动”：你只想为这个库截取标准输出，而不是践踏任何可能需要使用标准输出的东西。

如果可能，请在单独的进程空间中运行调用库函数的代码；然后您可以编写一个线程，从该进程读取标准输出并发送到记录器。

```
new Thread() {
  public void run() {
    ProcessBuilder pb = new ProcessBuilder(command);
    Process p = pb.start();
    BufferedReader in = new BufferedReader(p.getInputStream());
    String line;
    while ((line = in.readLine()) != null) {
      log.info(line);
      // or you could parse line and try to dynamically pick a log level
    }
  }
} 
```

您需要一种很好的方法来将被调用进程的输出返回给调用者，但如果它像返回一个值一样简单，那么应该很容易将它作为 stdout 的最后一行或一行返回一个特殊的信号代码，什么的。

# c# - 在 LINQ 中进行字符串比较的问题

> ID：578231
> 
> 赞同：25
> 
> 时间：2009-02-23T16:17:27.873
> 
> 标签：c#, .net, sql, linq

我无法让 LINQ 将某些内容转换为我需要的查询。在 T-SQL 中，我们对 CHAR(6) 列的三列进行 <= 和 >= 比较。LINQ 不允许我这样做，因为

> 运算符“<=”不能应用于“字符串”到“字符串”类型的操作数。

我有以下 T-SQL 查询..

```
SELECT * 
FROM [ZIPMASTER] zm
WHERE zm.CORP = 12 
AND '85546 ' BETWEEN zm.ZIPBEG AND zm.ZIPEND 
```

上面的 LINQ 不是很友好，因为不支持`BETWEEN`. 因此，我简化为以下内容：

```
SELECT *
FROM [ZIPMASTER] zm
WHERE zm.CORP = 12
AND zm.ZIPBEG <= '85546 '
AND zm.ZIPEND >= '85546 ' 
```

我用它来创建以下 LINQ 查询：

```
var zipLinqQuery =
    from z in db.ZIPMASTERs
    where z.CORP == 12
    && z.ZIPBEG <= "85546 "
    && z.ZIPEND >= "85546 "
    select z;
List<ZIPMASTER> zips = zipLinqQuery.ToList<ZIPMASTER>(); 
```

C# - LINQ 不太喜欢这个查询。我尝试转换为整数，然后进行比较，但是，在某些情况下，邮政编码可能包含一个字母。例如，以下表达式在 T-SQL 中的计算结果为 true：

```
WHERE '85546B' BETWEEN '85546A' AND '85546D' 
```

我不确切知道它为什么在 T-SQL 中起作用，但我的猜测是它通过将数组中的每个字符转换为数字 ASCII 值来单独比较它。

无论如何，非常感谢您能提供的任何帮助。提前致谢。

CJAM

**解决方案（由 Jon Skeet 发布）：**

看来 string.CompareTo() 实际上确实生成了所需的 T-SQL。以下示例：

```
var zipLinqQuery =
    from z in db.ZIPMASTERs
    where z.CORP == listItem.CORP
    && z.ZIPBEG.CompareTo(listItem.ZIPCODE) <= 0
    && z.ZIPEND.CompareTo(listItem.ZIPCODE) >= 0
    select z; 
```

生成以下 T-SQL：

```
DECLARE @p0 INT, @p1 CHAR(6), @p2 CHAR(6)
SET @p0 = 12
SET @p1 = '85546 '
SET @p2 = '85546 '

SELECT [t0].[CORP], [t0].[ZIPEND], [t0].[ZIPBEG], [t0].[CITY], [t0].[STATE], [t0].[CYCLE]
FROM [dbo].[ZIPMASTER] AS [t0]
WHERE ([t0].[CORP] = @p0) AND ([t0].[ZIPBEG] <= @p1) AND ([t0].[ZIPEND] >= @p2) 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-23T16:19:44.450

尝试：

```
var zipLinqQuery =
    from z in db.ZIPMASTERs
    where z.CORP == 12
    && z.ZIPBEG.CompareTo("85546 ") <= 0
    && z.ZIPEND.CompareTo("85546 ") >= 0
    select z; 
```

我不*知道*String.CompareTo 在 LINQ to SQL 中有效，但这是首先要尝试的。

（通常你应该使用 StringComparer 来指定正确的比较类型，但我怀疑在这种情况下 CompareTo 是更好的选择。）

# ssis - SSIS 模糊查找，每个查找错误有多个输出

> ID：578235
> 
> 赞同：1
> 
> 时间：2009-02-23T16:18:03.143
> 
> 标签：ssis, fuzzy-search

我有一个非常简单的 SSIS 包，包含 3 个组件：

1.  OLE DB 源
2.  模糊查找
3.  OLE DB 目标

在模糊查找组件中，我在高级选项卡中将“每次查找输出的最大匹配数”从 1 更改为 2。

当我在更改后运行包时，我收到以下错误消息：

[OLE DB 目标 [57]] 错误：SSIS 错误代码 DTS_E_OLEDBERROR。发生 OLE DB 错误。错误代码：0x80004005。OLE DB 记录可用。来源：“Microsoft SQL Native Client”Hresult：0x80004005 描述：“链接服务器 '(null)' 的 OLE DB 提供程序 'STREAM' 返回了列 '[!BulkInsert]._Confidence' 的无效数据。”

将数字改回 1 再次起作用。OLE DB 源有大约 45000 行，查找有大约 580000 行。

我不知道如何进一步解决这个问题，所以任何帮助表示赞赏！

谢谢丹尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T12:09:41.737

我解决了这个问题：

置信度列的数据类型必须是“float”而不是“real”。

丹尼尔

# asp.net - asp.net 调整不可调整大小

> ID：578238
> 
> 赞同：0
> 
> 时间：2009-02-23T16:19:14.280
> 
> 标签：asp.net, charts, resize, size

我正在使用 asp.net 图表控件，并且大部分时间都喜欢它。但是，我希望我的图表与它们所包含的面板一起调整大小。我不能将图表的宽度设置为 100%，我必须给它们一个确切的大小。我不想拉伸和扭曲渲染的图表图像。有没有人有我如何做到这一点的例子，或者你能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T18:50:59.547

如果您不想拉伸生成的图表，您可以通过 ajax 加载它并在 ajax 请求中传递当前图像容器的大小（例如 www.site.com/generateCoolChart?height=200&width=300 ）。但是容器的大小可能会在用户更改浏览器大小后更改，因此您的图表可能会变得比容器大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T19:53:11.893

对于尺寸要求，我会考虑使用 flash 或 silverlight 或基于 javascript 的图表，如[amCharts](http://www.amcharts.com)或其他。我的意思是任何不生成静态图像的东西。这些是在客户端上生成的，因此它们可以轻松地用于专用空间。

# delphi - Delphi 2009 中的 TShellListView 在哪里？

> ID：578241
> 
> 赞同：5
> 
> 时间：2009-02-23T16:19:32.640
> 
> 标签：delphi, delphi-2009

我们最近搬到了 Delphi 2009。我找不到 TShellListView 和 TShellTreeView 控件。我需要安装一些额外的东西吗？

从网上搜索，似乎它们是随 Delphi 2009 一起提供的，但由于某种原因，它们尚未安装。

有没有人遇到过类似的问题？

[在这里](https://forums.codegear.com/thread.jspa?messageID=21861&tstart=0#21861)回答

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-23T17:41:24.690

看起来这个包默认没有安装。

导航到 Delphi 演示（它们在我机器上的“c:\Users\Public\Documents\RAD Studio\6.0\Demos”中；`6.0`如果您没有运行 Delphi 2009，则应替换为适当的版本）并打开子文件夹 DelphiWin32\ VCLWin32\ShellControls。

打开并编译 vclshlctrls.dproj。

打开并编译 dclshlctrls.dproj。

当最后一个项目仍然打开时，右键单击项目管理器窗口（视图，项目管理器）中的 dclshlctrls120.bpl 项，然后从弹出菜单中选择安装。您应该会看到一个对话框，通知您新组件。其中之一是 TShellListView。

> 信息
> 
> 包 C:\Users\Public\Documents\RAD Studio\6.0\Bpl\dclshlctrls120.bpl 已安装。以下新组件已注册：TShellChangeNotifier、TShellComboBox、TShellListView、TShellTreeView。

新包现在也应该在 Component, Install Packages 窗口（“Shell Control Property and Component Editors”）中可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-04T21:07:22.257

我把这个答案放在我的问题中，但为了更容易找到，我也会把这个答案放在这里，这是为我解决这个难题的最后一点。

* * *

看来 codegear 已将演示安装到文档和设置的 allusers 部分

```
 C:\Documents and Settings\All Users\Documents\RAD Studio\6.0\Demos\DelphiWin32\VCLWin32\ShellControls 
```

[在这里](https://forums.codegear.com/thread.jspa?messageID=21861&tstart=0#21861)回答

# c++ - 如何在不引起循环依赖的情况下传递然后调用泛型回调函数

> ID：578259
> 
> 赞同：0
> 
> 时间：2009-02-23T16:22:03.760
> 
> 标签：c++, boost, callback

无法创造性地缩短标题:)

我一直在使用以下解决方案的变体，但是我一直想知道是否有更好/更清洁的方法来实现它。我正在寻找非增强解决方案。不过，我们可以看看 boost 和 C++0x 的实现，因为它很快就会相关。

```
//Notice the use of template template parameter
template <template <typename> class Callback>   
class A {
   Callback <A> m_func;
   public:
     A (Callback <A>  func):  m_func (func) {}
     void call () { m_func(*this);}

};

template <typename T>
struct MYCallback
{
   void operator () (const T&t) {}

};

void Test()
{
   typedef A<MYCallback> AType;

   MYCallback<AType> callback;
   AType a (callback);
   a.call ();

} 
```

另一种更简洁的方法是使用 tr1::function，它会随着新的标准化而失效：

```
#include <tr1/functional>

class A {
   std::tr1::function <void (const A&)>  m_func;
   public:
     template <class Callback>
     A (Callback func) :  m_func (func) {}

     void call () { m_func(*this);}

};

template <class T>
struct My_callback
{
   void operator () (const T&t) {}

};

void Test ()
{
   My_callback <A> c;
   A a (c);
   a.call ();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T16:59:58.613

我始终相信 void* 是您想要优雅的朋友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T17:01:33.850

一种方法是使用派生类：

```
template <class Callback>   
class A {
   Callback m_func;
   public:
     A (Callback  func):  m_func (func){}
     void call () { m_func(*this);}

};

template <typename T>
struct MYCallback
{
   void operator () (const T&t) {}

};

struct AConcrete : public A<MYCallback<AConcrete> >
{
  template <class T>
  AConcrete(T t): A<MYCallback<AConcrete> > (t) {}
};

void Test()
{

   MYCallback<AConcrete> callback;
   AConcrete a (callback);
   a.call ();

} 
```

PS：递归对于 C++ 模板来说很困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T18:52:21.853

如果您只是在寻找清理建议，我建议将“My_c​​allback”设为普通类，而不是类模板。在这种情况下，它显然不需要成为模板。相反，如果 My_callback 只处理 A 实例，则将其应用运算符模板化或直接填写 A：

```
#include <tr1/functional>

class A {
   std::tr1::function <void (const A&)>  m_func;
   public:
     template <class Callback>
     A (Callback func) :  m_func (func) {}

     void call () { m_func(*this);}

};

struct My_callback
{
   template <class T>
   void operator () (const T&t) {}
};

int main ()
{
   My_callback c;
   A a (c);
   a.call ();
} 
```

否则，它看起来还不错。您能否更具体地说明您希望如何清理或简化它？

# python - Python 2.5 到 Python 2.2 转换器

> ID：578262
> 
> 赞同：1
> 
> 时间：2009-02-23T16:24:09.493
> 
> 标签：python, pys60

我正在为 S60 第二版设备开发 PyS60 应用程序。我在 Python 2.5 中编写了我的应用程序逻辑。

是否有任何工具可以自动将 Python 2.5 转换为 Python 2.2，或者我需要手动进行吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T19:23:54.227

适用于 S60 的最新 Python [1.9.0](http://discussion.forum.nokia.com/forum/showthread.php?t=154215)实际上包括 Python 2.5.1。所以也许你不需要转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T16:42:25.597

我不知道有什么工具可以自动从 2.5 升级到 2.2。但是不久前有一个由[RADLogic](http://www.radlogic.com.au/downloads.htm)进行了 2.3 到 2.2 的操作。

根据您的代码使用了多少最近的功能，手动转换它可能很简单。

不久前我不得不反向移植一些代码，实际上只需要定义 True 和 False（如果它们尚未定义），为 , 等编写一些简单的替换`sum()`，`enumerate()`并获取旧版本的模块，`datetime`例如`logging`但在 2.2 标准库中。

# sql - ora-00939 报告服务中的错误，SSRS

> ID：578272
> 
> 赞同：0
> 
> 时间：2009-02-23T16:27:15.260
> 
> 标签：sql, oracle, reporting-services

我有一个 SSRS 报告，Oracle 是我的后端，并且正在使用以下查询来获取我的第二个参数的数据集。

```
select distinct  X
from  v_stf_sec_user_staffing_center usc
where usc.center_group_id in  (
 select distinct center_group_id from  V_T_STAFFING_CENTER_GROUP scg
where  INSTR(','||REPLACE(:PI_REGION_LIST,' ')||',', ','||scg.group_abbreviation||',') > 0)
and usc.nt_user_name=:PI_NT_USER_NAME 
```

这`PI_REGION_LIST`是一个字符串类型的多值参数。并且`PI_NT_USER_NAME`是默认的字符串值参数

当我尝试在数据选项卡中手动执行时，此查询工作正常，也在 Oracle 工具中。但是，当我在 SSRS 中运行报告并为参数选择 3 个以上的值时，`PI_REGION_LIST`报告会在此数据集上引发错误

> ora-00939 错误，函数的参数太多。

我无法在这里找出错误。

请帮我出一个主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-09T22:46:04.633

[REPLACE](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions134.htm#i78608)函数接受三个字符串参数，最后一个是可选的。

[MS 文档](http://msdn.microsoft.com/en-us/library/aa337292.aspx)说多值参数具有以下限制“查询必须使用 IN 子句来指定参数” 。

如果您实际上不需要执行 REPLACE 来消除空格，则应该可以执行类似的操作

```
WHERE scg.group_abbreviation in (:PI_REGION_LIST) 
```

# c# - C#中的MAC地址

> ID：578273
> 
> 赞同：3
> 
> 时间：2009-02-23T16:27:20.767
> 
> 标签：c#, networking, mac-address

```
public static NDIS_802_3_ADDRESS StrToByteArray(string str)
{
    ASCIIEncoding encoding = new ASCIIEncoding();
    byte[] m = encoding.GetBytes(str);
    NDIS_802_3_ADDRESS mac = new NDIS_802_3_ADDRESS(m);
    return mac;
} 
```

您使用这些方法将字符串更改为 mac 地址，但是无论输入字符串如何，其输出都是固定值 30-30-2D-32-31-2D。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T16:38:06.060

它可能会返回您的网络接口卡的 MAC 地址。

如果您在 Windows 上，请从命令行运行 ipconfig /all。这是否与您返回的值相匹配？

我不太确定这种方法首先应该做什么。你作为输入字符串传入了什么，你期望这个方法做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T16:32:14.093

问题是 NDIS_802_3_ADDRESS 对它接收到的字节数组做了什么？你从哪里得到的？它是一个自定义类/结构，所以你应该告诉我们你从哪里得到它或者它应该做什么。

# ruby - 红宝石表达式

> ID：578274
> 
> 赞同：1
> 
> 时间：2009-02-23T16:27:38.190
> 
> 标签：ruby, regex

```
(?:) 
```

这是一个有效的 ruby​​ 正则表达式，谁能告诉我它是什么意思？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T17:59:30.373

就像其他人所说的那样，它被用作正则表达式的非捕获语法，但是，它也是正则表达式之外的有效 ruby​​ 语法。

在 ruby`?:`​​ 中是冒号字符的整数值：

```
% irb
irb> ?:
=> 58
irb ":"[0]
=> 58 
```

添加括号不会改变值：`(?:) == ?:`

添加`? :`空格`( bool ? truish : falsy )`（

```
if bool then 
  truish 
else 
  falsy 
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T16:31:37.323

它不会在[反向引用](http://www.regular-expressions.info/brackets.html#usebackrefinregex)（即\1）中捕获匹配字符串的部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T16:32:43.157

这是一个空的、[非捕获组](http://www.regular-expressions.info/refadv.html)。在这种情况下它没有任何意义，可以删除。

# c# - 使用 Microsoft EnterpriseLibrary 验证时的堆栈溢出

> ID：578279
> 
> 赞同：1
> 
> 时间：2009-02-23T16:28:35.863
> 
> 标签：c#, .net, validation, enterprise-library, validation-application-bl

我有两节课：

```
[HasSelfValidation]
class Country : DomainObject
{
    [NotNullValidator]
    [StringLengthValidator(2, 10)]
    public string Name { get; set; }

    [ObjectCollectionValidator(typeof(Region))]
    public List<Region> Regions { get; set; }
} 
```

和

```
[HasSelfValidation]
class Region : DomainObject
{
    [NotNullValidator]
    [ObjectValidator]
    public Country Country { get; set; }

    [NotNullValidator]
    [StringLengthValidator(2, 20)]
    public string Name { get; set; }
} 
```

DomainObject 有方法的地方：

```
public virtual ValidationResults Validate()
{
    Validator validator = 
        ValidationFactory.CreateValidator(this.GetType());
    ValidationResults results = new ValidationResults();
    validator.Validate(this, results);
    return results;
} 
```

我正在使用 Microsoft Enterprise Library 4.1 - 2008 年 10 月/.NET 3.5 SP1/Vista。

如果我调用`Validate`一个新创建的 Country 对象，其中的区域列表为 null，我会收到 StackOverflow 异常。如果我删除 Country.Regions 属性的 [ObjectCollectionValidator(typeof(Region))]，一切正常。我猜链接国家 - 地区 - 国家是失败的原因。但是，我不想删除 Regions 集合的验证；从区域中删除 [ObjectValidator] 对我来说都不是一个选项。我可以做些什么来维护所有这些验证属性，没有 StackOverflow 异常？

谢谢，

卢西安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-29T21:02:07.053

前几天我遇到了同样的问题，并且能够通过实现一个自定义验证器类来解决它，该类的功能与 ObjectValidator 的功能非常相似，只是它将被评估的属性的评估延迟到实际的 DoValidate 方法，并且如果属性为空，则不会继续构建验证器。

```
using System;
using Microsoft.Practices.EnterpriseLibrary.Common.Configuration;
using Microsoft.Practices.EnterpriseLibrary.Validation.Configuration;
using Microsoft.Practices.EnterpriseLibrary.Validation.Properties;

namespace Microsoft.Practices.EnterpriseLibrary.Validation.Validators
{
    /// <summary>
    /// Performs validation on objects by applying the validation rules specified for a supplied type at RUNTIME.
    /// This validator can be used to get past StackOverflowExceptions that can be thrown as a result of the design
    /// of the ObjectValidator attribute
    /// </summary>
    /// <seealso cref="ValidationFactory"/>
    public class RuntimeObjectValidator : Validator
    {
        private Type targetType;
        private string targetRuleset;

        /// <summary>
        /// <para>Initializes a new instance of the <see cref="RuntimeObjectValidator"/> for a target type.</para>
        /// </summary>
        /// <param name="targetType">The target type</param>
        /// <remarks>
        /// The default ruleset for <paramref name="targetType"/> will be used.
        /// </remarks>
        /// <exception cref="ArgumentNullException">when <paramref name="targetType"/> is <see langword="null"/>.</exception>
        public RuntimeObjectValidator(Type targetType)
            : this(targetType, string.Empty)
        { }

        /// <summary>
        /// <para>Initializes a new instance of the <see cref="RuntimeObjectValidator"/> for a target type
        /// using the supplied ruleset.</para>
        /// </summary>
        /// <param name="targetType">The target type</param>
        /// <param name="targetRuleset">The ruleset to use.</param>
        /// <exception cref="ArgumentNullException">when <paramref name="targetType"/> is <see langword="null"/>.</exception>
        /// <exception cref="ArgumentNullException">when <paramref name="targetRuleset"/> is <see langword="null"/>.</exception>
        public RuntimeObjectValidator(Type targetType, string targetRuleset)
            : base(null, null)
        {
            if (targetType == null)
            {
                throw new ArgumentNullException("targetType");
            }
            if (targetRuleset == null)
            {
                throw new ArgumentNullException("targetRuleset");
            }

            this.targetType = targetType;
            this.targetRuleset = targetRuleset;
        }

        /// <summary>
        /// Validates by applying the validation rules for the target type specified for the receiver.
        /// </summary>
        /// <param name="objectToValidate">The object to validate.</param>
        /// <param name="currentTarget">The object on the behalf of which the validation is performed.</param>
        /// <param name="key">The key that identifies the source of <paramref name="objectToValidate"/>.</param>
        /// <param name="validationResults">The validation results to which the outcome of the validation should be stored.</param>
        /// <remarks>
        /// If <paramref name="objectToValidate"/> is <see langword="null"/> validation is ignored.
        /// <para/>
        /// A referece to an instance of a type not compatible with the configured target type
        /// causes a validation failure.
        /// </remarks>
        protected internal override void DoValidate(object objectToValidate,
            object currentTarget,
            string key,
            ValidationResults validationResults)
        {
            if (objectToValidate != null)
            {
                if (this.targetType.IsAssignableFrom(objectToValidate.GetType()))
                {
                    validationResults.AddAllResults(
                        ValidationFactory.CreateValidator(objectToValidate.GetType()).Validate(objectToValidate));
                }
                else
                {
                    // unlikely
                    this.LogValidationResult(validationResults, Resources.ObjectValidatorInvalidTargetType, currentTarget, key);
                }
            }
        }

        /// <summary>
        /// Gets the message template to use when logging results no message is supplied.
        /// </summary>
        protected override string DefaultMessageTemplate
        {
            get { return null; }
        }

        #region test only properties

        internal Type TargetType
        {
            get { return this.targetType; }
        }

        internal string TargetRuleset
        {
            get { return this.targetRuleset; }
        }

        #endregion
    }
} 
```

当然，您还需要创建一个 RuntimeObjectValidatorAttribute 类，以便您可以这样做：

```
public class AClassThatReferencesItself
    {
        private AClassThatReferencesItself _other;

        private string myString;

        [NotNullValidator]
        public string MyString
        {
            get { return myString; }
            set { myString = value; }
        }

        [RuntimeObjectValidator]
        [NotNullValidator]
        public AClassThatReferencesItself Other
        {
            get { return _other; }
            set { _other = value; }
        }

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T18:41:06.107

此错误位于 codeplex 上 EntLib[的问题跟踪器中。](http://www.codeplex.com/entlib/WorkItem/View.aspx?WorkItemId=8593)而且我不确定它是否可以轻松修复。而且我没有找到任何好的解决方法:(。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-28T09:41:40.813

诀窍实际上是*不*使用任何`ObjectValidator`和`ObjectCollectionValidator`属性。您可以自行验证所有对象。这并不总是可行的，但在 O/RM 场景的上下文中尤其有效，其中 O/RM 框架知道哪些实体是新的或已更改的。

看一下这个例子，在使用实体框架将更改提交到数据库之前触发验证：

```
public partial class NorthwindEntities
{
    partial void OnContextCreated()
    {
        // Adding validation support when saving.
        this.SavingChanges += (sender, e) =>
        {
            // Throws an exception when invalid.
            EntityValidator.Validate(
                this.GetChangedEntities());
        }
    }

    private IEnumerable<object> GetChangedEntities()
    {
        const EntityState AddedAndModified =
            EntityState.Added | EntityState.Modified;

        var entries = this.ObjectStateManager
            .GetObjectStateEntries(AddedAndModified);

        return
            from entry in entries
            where entry.Entity != null
            select entry.Entity;
    }
} 
```

代码挂钩到`ObjectContext`'`SavingChanges`事件。

这`EntityValidator`是一个自定义类，允许使用验证应用程序块验证一组对象。当验证失败时，它会抛出一个`ValidationException`包装`ValidationResults`集合的自定义。

```
static class EntityValidator
{
    public static void Validate(IEnumerable<object> entities)
    {
        ValidationResults[] invalidResults = (
            from entity in entities
            let type = entity.GetType()
            let validator = ValidationFactory.CreateValidator(type)
            let results = validator.Validate(entity)
            where !results.IsValid
            select results).ToArray();

        // Throw an exception when there are invalid results.
        if (invalidResults.Length > 0)
        {
            throw new ValidationException(invalidResults);
        }
    }
} 
```

更多信息[在这里](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=46)。

我希望这有帮助。

# css - 如果图像设置了 CSS 以隐藏可见性，它会加载吗？

> ID：578283
> 
> 赞同：12
> 
> 时间：2009-02-23T16:29:47.563
> 
> 标签：css, image

如果图像设置了 CSS 以隐藏可见性，它会加载吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-23T16:31:23.003

是的，它仍然会被加载并保存在 DOM 中。那你就可以用JS快速展示了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T16:44:08.807

是的 - 我已经使用它来预加载将使用 Javascript 显示的图像。

您可以**通过实验验证这一点**：

*   创建两个相对较大的图像，a.jpg 和 b.jpg*   将图像放在页面上，来源为 a.jpg*   编写一些 javascript 以在单击链接时将图像的源更改为 b.jpg（例如，b.jpg 的缩略图）*   加载页面。请注意，当您单击链接时，您必须等待 b.jpg 加载。*   现在编辑页面，使 b.jpg 首先包含在页面中，但 CSS 属性为`visibility: hidden`*   **使用Ctrl+F5**重新加载页面。完成后，再次单击链接。*   请注意，b.jpg 现在加载速度要快得多。那是因为它是预加载的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T20:12:20.563

这完全取决于浏览器及其环境（例如，手机等内存不足的情况）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T01:55:30.587

不同的浏览器可能会有不同的行为。

# enums - Common Lisp 等价于 C 枚举

> ID：578290
> 
> 赞同：21
> 
> 时间：2009-02-23T16:31:26.437
> 
> 标签：enums, lisp, common-lisp

我最近正在尝试学习一些 Lisp（Common Lisp），我想知道是否有一种方法可以像在 C 中通过枚举那样为常数命名。

我不需要枚举的完整功能集。最后，我只想拥有快速*且*可读的代码。

我尝试过全局变量和小函数，但这总是伴随着性能下降。只需将数字插入代码总是更快。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-23T16:45:58.757

在 Lisp 中进行枚举的常规方法是使用符号。符号被嵌入（替换为指向符号表中它们的条目的指针），因此它们与整数一样快，并且与其他语言中的枚举常量一样可读。

所以你可以在 C 语言的哪个地方写：

```
枚举{
   苹果，
   橙，
   香蕉，
};

```

在 Lisp 中，您可以直接使用`'apple`,`'orange`和`'banana`。

如果你需要一个枚举*类型*，那么你可以定义一个[`deftype`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/mac_deftype.html)：

```
(deftype fruit () '(成员苹果橙香蕉))
```

然后您可以使用 ,等中的类型`fruit`，`declare``typep``typecase`~~并且您可以编写专门针对该类型的通用函数~~.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-25T14:44:05.680

例如，您要命名字体大小：

```
(defconstant +large+ 3)
(defconstant +medium+ 2)
(defconstant +small+ 1) 
```

您可以编写一个宏来缩短它。

上述常量定义通常仅在需要将这些数字传递给某些外部非 Lisp 代码时才编写。

否则只会使用关键字符号：:large、:medium 和 :small。

你可以用 EQ 和所有使用相等测试的东西来测试它们。

```
(let ((size :medium))
  (ecase size
    (:small ...)
    (:medium ...)
    (:large ...))) 
```

你也可以为它写方法：

```
(defmethod draw-string (message x y (size (eql :large))) ...) 
```

如前所述，您可以定义一个集合类型：

```
(deftype size () '(member :small :medium :large)) 
```

然后您可以检查是否有以下内容：

```
(let ((my-size :medium))
  (check-type my-size size)) 
```

如果 my-size 不是 :small、:medium 或 :large 之一，则上面会发出错误信号。

您还可以使用 defclass 形式的类型：

```
(defclass vehicle ()
   ((width :type size :initarg :width))) 
```

现在您将在此处创建对象：

```
(make-instance 'vehicle :width :large) 
```

某些 Common Lisp 实现会检查您何时将插槽设置​​为某个非法值。

如果您现在创建类车辆的对象，插槽将是 :large、:medium 或 :small 之一。如果您在调试器、检查器或其他工具中查看对象，您将看到符号名称，而不是 1、2 或 3（或您通常使用的任何值）。

这是 Lisp 风格的一部分：尽可能使用符号名。仅在外部函数的接口代码中使用具有数字值的符号（例如调用使用枚举的外部 C 代码）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-23T16:38:59.957

枚举对于 Lisp 来说是多余的，原因是所有符号都是它们自己的标识，所以你可以只使用它们，例如：

```
[dsm@localhost:~]$ clisp -q
[1]> (setf x 'some) ;'
SOME
[2]> (eq x 'some) ;'
T
[3]> 
```

# c++ - VS/MFC 是否仍在使用诸如“afx_msg”装饰器之类的东西？

> ID：578293
> 
> 赞同：8
> 
> 时间：2009-02-23T16:31:53.877
> 
> 标签：c++, visual-studio, mfc

我正在开发一个 MFC 程序，该程序早在 VC6 时代就开始了。当时有一个类向导，它使用一堆装饰器和注释中的标记来解析类文件。

例如，它会在它维护的消息处理程序前面插入 afx_msg。**它会用//{{AFX_MSG_MAP(TheApp)**和**/}}AFX_MSG_MAP**注释标记一段代码，以帮助它找到它想要处理的消息映射部分。

AFAIK，这不再需要了。除此之外，类向导还有很多缺点，我们不得不对这些托管块进行大量手动编辑，而且我们从来没有经常使用它。

还有其他理由继续使用 afx_msg 及其同类产品吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-23T19:31:52.867

afx_msg 仍然存在，但一直是纯粹的信息。正如你所说的装饰师。它一直被#defined 为空字符串。

自 VS2003 起不再需要 {{ 和 }} 标记：VS 现在足够聪明，可以将东西放在正确的位置，而不必依赖这些标记。您会注意到 VS2003+ 在它创建的项目中不再包含这些行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T16:51:10.023

AFAIK，不再使用 afx_msg。另一个标记用于帮助 CW 找出放置东西的位置，其中一些可能仍会使用（例如：.cpp 文件中的消息映射位置）。头文件中的那些可能更安全地删除，但我不会随意将它们取出。

您可以做的一件事是：在您当前的 VS 版本中启动一个新的虚拟 MFC 项目，添加一个窗口类和一些处理程序，并观察当前创建的符号。未放入的任何东西都可能不再使用，而仍然插入的任何东西都可能仍以某种形式使用）。

PS：MS很清楚当前CW编辑的问题，我听说它们将在VS2010中得到很大程度的解决……我们拭目以待。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T16:58:54.293

AFAIK 这些不再需要了。VS2008 中的类向导将不再生成注释，也不会使用以前版本生成的现有注释。类向导仍然会生成 afx_msg 装饰器，但是它们没有被使用。

我在处理 VC6 时代的代码时的一般规则是删除所有注释，但保留 afx_msg 装饰器。我发现装饰器在阅读代码时很有用，可以指出方法是消息处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T18:45:53.773

在 VS2008 中，afx_msg 是一个空的#define。我已经从从 VC6 升级到 2005 的应用程序中删除了所有其他插入类向导的 deck。当然，我也根本不使用类向导。

# wpf - 带有 WebBrowser 的 WPF 中的模型视图 ViewModel

> ID：578295
> 
> 赞同：4
> 
> 时间：2009-02-23T16:32:10.270
> 
> 标签：wpf, mvvm, browser

我使用 MVVM 模式在 WPF 中编写应用程序，其中我仅限于绑定到属性和命令 exclusivley

但是，我想使用 WebBrowser 控件，它只能将内容的 html 字符串作为 mthod 的参数，而不是属性。

我打算创建一个从 Webbrowser 派生的具有所需属性的新控件，但控件类是密封的。我尝试创建一个包装器控件，但是我遇到了各种依赖属性问题，这些问题似乎比我能解决的麻烦更多。

有什么方法可以将参数（字符串）推送到带有 MVVM 的方法中，而无需使用代码隐藏文件中的代码（这是一个很大的禁忌）。

谢谢

院长

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-10-02T18:28:23.177

为什么代码隐藏文件中的任何代码**都不**行？我相信这是 MVVM 社区中最常见的误解之一。

**MVVM 不是消除背后代码的模式**。就是将视图部分（外观、动画等）与逻辑部分（工作流程）分开。此外，您可以对逻辑部分进行单元测试。

我知道你必须在后面编写代码的足够多的场景，因为数据绑定并不是解决所有问题的方法。可以在此处找到使用代码隐藏并仍然实现 MVVM 分离的示例应用程序：

[**WPF 应用程序框架 (WAF)**](http://waf.codeplex.com)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-08T10:38:17.270

我使用了这里找到的解决方案

[数据绑定 WPF 中 WebBrowser 的 Source 属性](https://stackoverflow.com/a/265648/285795)

高温高压

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-23T16:56:03.553

我不完全确定我理解这个问题（您想在 WebBrowser 上调用一个方法，但需要一个 html 字符串来执行此操作？）。

MVVM 并不是要避免像瘟疫那样的代码隐藏，而是将代码隐藏文件降级为严格的 UI 任务。

如果您将 UI 设置为包含一个典型的地址栏 + 转到按钮，您将需要使用按钮的 Click 处理程序将字符串传递给浏览器。或者，该字符串可以是 ViewModel 的一个属性，您可以通过将其绑定到 WebBrowser 的 Tag 属性来轻松收集它。

您的 UI 将大致如下所示：

```
<TextBox x:Name="addressBar" /> <!-- If you use the address bar -->
<Button Content="Go" Click="NavigateButton_Click" />
<WebBrowser x:Name="browser" Tag="{Binding URL}" />  <!-- If you bind to a VM property --> 
```

您的代码隐藏可能如下所示：

```
void NavigateButton_Click(object sender, RoutedEventArgs e)
{
   browser.Navigate(new Uri(addressBar.Text)); // Address Bar
   browser.Navigate(new Uri(browser.Tag.ToString()); // Tag Binding
} 
```

# formatting - 如何在 MS-DOS 脚本中打印换行符？

> ID：578302
> 
> 赞同：7
> 
> 时间：2009-02-23T16:33:40.533
> 
> 标签：formatting, batch-file, newline, dos

我想在 MS-DOS 中打印程序的输出，所以我写了一个 .bat 文件，上面写着：

```
cls
ruby foo.rb 
```

但是输出 - 出现在我的命令提示符上 - 看起来像这样：

```
c:\workspace>ruby foo.rb
foo output
c:\workspace> 
```

我想使用 MS-DOS 在输出中插入换行符，因为我不想用与代码应该做什么无关的任何东西污染我的 Ruby 代码。

MS-DOS 中唯一看起来像我想要的命令是“类型”和“打印”，但它们都是用于打印文件的。

我尝试创建一个带有两个空行的文本文件并使用“type”命令输出它，但它看起来很乱。

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-23T16:37:13.893

`echo.`将产生一条新线。

所以你的脚本应该是这样的：

```
@ECHO OFF
cls
echo.
ruby foo.rb 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-16T12:38:50.813

即使这里有 4 个使用相同技巧的答案`ECHO.`，这也不是最好的解决方案！

有两个缺点。

1.  它的
    `ECHO.`速度比*普通* `echo`命令慢约 10 倍，这是因为`ECHO.`会强制访问磁盘

2.  它可能会失败
    如果存在具有名称`ECHO`（没有扩展名）`ECHO.`的文件，那么每个命令将导致*找不到文件*错误，而不是回显一个空行。

但是你能做什么呢？
对于一个简单的空行，有很多工作方式。

```
echo+
echo=
echo;
echo,
echo:
echo( 
```

但有时您需要一种安全的方式来回显变量的内容，即使变量为空或包含奇怪的内容，例如`/?`or `\\..\..\windows\system32\calc.exe`。

`ECHO<character>%variable%`

```
echo=/?
echo;/?
echo,/?
echo:\\..\..\windows\system32\calc.exe 
```

然后大多数命令将失败，仅`ECHO(`适用于任何情况。
它看起来有点奇怪，但它可以工作，并且不需要右括号也不会造成任何麻烦。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T16:42:52.227

怎么样：

```
@echo off
cls
echo.
ruby foo.rb
echo. 
```

再见

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-23T16:35:55.690

试试这个

```
echo. 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T16:36:09.997

使用后跟句点的 echo 命令在 MS-DOS 批处理文件中显示新行：

```
echo. 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-03T17:53:00.557

我同意杰布。"echo(" 肯定更快，并且不会调用文件访问。只需尝试一下，您就会知道。这是您可能想尝试的一个小测试。

创建一个名为“echo”的文件，并在同一目录下创建一个 test.bat 或 test.cmd 文件，脚本中包含以下内容：

```
@echo off
echo %time%
echo.
echo Hello, World
echo.
echo.
echo What time is it?
echo.
echo It's Miller Time!
echo.
echo.
echo CHEERS!
echo.
echo %time% 
```

运行新创建的批处理文件。你得到了什么？当同一目录中存在文件“echo”时出现一堆错误消息。

现在，删除“echo”文件。

在我的系统上，使用“回声”从开始到结束大约需要 0.05 秒。方法由于文件访问发生。

现在，替换所有“回声”。在上面的测试文件中使用“echo(”并再次运行它。

使用“echo(”语句从开始到结束大约需要 0.01 秒。

最终测试，在同一目录中重新引入一个名为“echo”的文件并最后一次运行批处理。

没有错误信息。

量子点

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T16:40:18.753

我不清楚你在这里想要什么，但也许这会有所帮助。

如果要将输出发送到其他地方，请使用 dos 输出“管道”。

```
ruby foo.rb > out.txt 
```

将 ruby​​ 命令的输出输出到 out.txt 文件。

如果要控制输出，请使用 ECHO。

```
@ECHO OFF/ON //turns off/on command output
ECHO "Blah" //writes "Blah" to the console.
ECHO. //writes a blank line to the console. 
```

# pdf - 将 Photoshop 文档另存为 .pdf 会导致图像模糊/像素化

> ID：578303
> 
> 赞同：3
> 
> 时间：2009-02-23T16:34:26.910
> 
> 标签：pdf, pdf-generation, photoshop

我正在使用 Photoshop CS2 设计一份传单，该传单旨在通过电子邮件以 .pdf 格式分发。我的文档是 72 dpi，我认为这是非打印使用的合适默认值。

文档中有一个图像，一个徽标，当我将文档另存为 .pdf 时，这在 Acrobat 阅读器中总是出现像素化。在 Photoshop 中看起来不错。我已经尝试了几乎所有选项和“另存为”选项的组合，没有任何区别。

我尝试了图像的 tiff 和 jpg 版本，但无济于事。我还注意到，如果我在另存为时选择不压缩，则生成的文件大小是巨大的 - 10+ megs，即使图像只有 10k！并且图像仍然是像素化的。

有什么建议么？

谢谢理查德。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-12-20T18:23:32.600

我意识到这个问题已经有几年的历史了，但我想我会为遇到这个问题的其他人提供一个可能的解决方案。它并不完美，但它产生的结果比我迄今为止尝试过的任何其他方法都要好。

*注意：这是假设您正在处理 72ppi Photoshop 文档（我使用的是 CS5）。*

1.  首先确保您安装了 PDF 打印机。

2.  然后在 Photoshop 中转到*文件 > 打印*并选择上述打印机。

3.  单击*“打印设置...”*并从默认设置框中选择*“高质量打印” 。*（或单击右侧的*“编辑”*并确保您的图像质量设置为最高）。

4.  仍在打印设置对话框中，转到*“Adobe PDF 页面大小：”*并单击*“添加..”*

5.  将您的新纸张尺寸命名为“doc”（或您真正想要的任何名称）。

6.  然后对于大小，将文档宽度除以 109 (ppi)，将高度除以 109（再次为 ppi），然后在各自的位置输入结果值（确保选择了英寸）。

7.  单击*“添加/修改”*关闭对话框。*确保从“Adobe PDF 页面大小”*下拉列表中选择了新的纸张大小，然后点击*“确定”。*

8.  在*“Scaled Print Size”*框中，将比例更改为 66%（这应该使打印分辨率为 109 PPI）。

9.  单击*“打印”*，保存您的文档，希望您的 PDF 看起来更好！

作为旁注，您可以尝试使用 110ppi，计算您的大小并将比例更改为 65% 以匹配。但根据我的经验，无论出于何种原因，109 效果更好。

如果您想知道这有什么帮助，Adobe Reader/Acrobat 默认倾向于以 110ppi 显示 PDF，因此通过创建 PDF 来反映这一点（是的，它是 1ppi 关闭）它看起来 100% 为 100%。

同样，这对我有用，希望你有同样的运气。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T11:10:24.110

对于传单和海报设计等发布任务，Photoshop 确实不是最佳选择。如果您有足够的财力，则留在 Adob​​e 家族中，您可以查看 InDesign 的页面布局和 Illustrator 的图形和徽标矢量图。

在免费和开源方面，考虑线条图的[Inkscape和页面布局的](http://www.inkscape.org/)[Scribus](http://www.scribus.net/)。

Scribus 在许多方面都比任何 Adob​​e 工具更能生成高质量的 PDF 文档。这是一个大型而复杂的工具，真正用于高端出版，但它可以完成工作。

当 Photoshop 将您的页面图像转换为 PDF 页面的位图图像层时，您对看起来像素化的东西的问题几乎可以肯定是用于图像压缩的设置的结果。由于您遇到的各种问题，我自己从未对这种方法感到满意。

制作用于打印的 PDF 时，您需要调整所有图形元素的大小，以便在纸上布置，图像中的可用像素至少与纸上的像素一样多。在 300 dpi 时，一张 2x3 英寸的照片必须至少为 600x900 像素。根据许多其他因素，将图像大小调整为实际打印分辨率的*整数倍*以获得最佳效果可能很重要。根据您的打印提供商，您可能还需要确保您的插图仅在预期的打印过程中使用色域内的颜色...

为屏幕使用生成 PDF 时，通常假定屏幕为 72 或 96 dpi。两者都不是完全正确的，但对于普通用户来说，两者都足够接近真实。另请注意，在屏幕上使用的文档几乎肯定应该在 SRGB 色彩空间中准备，该色彩空间基于普通未校准的 RGB 显示器上可用的颜色。避免使用诸如 Adob​​eRGB 之类的小众色彩空间的诱惑，因为它们只会在极少数了解色彩工作流程并拥有校准显示器的用户看来是正确的。顺便说一句，你已经校准了你的显示器，对吧？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T20:37:02.880

如果它是徽标，则应嵌入它的矢量版本，以便无论如何都能正确缩放。这根本不是 Photoshop 工作，创建 PDF 传单也不是 Photoshop 工作。

但根据经验，无论预期的媒体如何，使用至少两倍所需的 dpi - 特别是如果您使用不可缩放的图形元素。此外，您注意到的 72 dpi 的想法根本不正确 - 搜索 72 dpi 的神话或事实可能会给出一些[有用的结果](http://josh.st/blog/2005/07/27/computer-screen-dpi-myth-and-other-misconceptions)，至少试图解释它的奇怪之处......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T20:14:19.957

无论您的实际显示器大小或分辨率如何，Windows 都认为正常的 Windows 显示为 96 DPI。我不知道 Mac 是什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-21T00:20:57.767

在Word 2010（2007应该可以）右击图片/图片，选择“编辑图片”，弹出窗口会提示：“这是导入的图片，不是组。你想把它转换成微软的吗？”办公室绘图对象？” 单击是。然后再次右键单击图像，这次选择：格式化图片。单击预设下拉菜单，然后选择最清晰/最清晰的图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T20:04:54.283

好的，我已经解决了这个问题。

在 Acrobat Reader 中以 100% 的显示缩放比例显示时，图像看起来像素化了。我假设 100% 只是意味着如果 doc 是 1,000 像素宽，它将在屏幕上呈现 1,000 像素。然而，这种情况并非如此。我不明白 100% 到底是什么意思，但是在 100% 时，它会以更大的尺寸渲染，比如 1,300 像素。因此，图像在被拉伸时被像素化。如果我将缩放降低到 ~70%，那么它会很好地呈现。

我猜 Acrobat 正在尝试以“英寸”而不是像素来呈现文档。我的文档是 A4 = 8.5 英寸宽，我认为 Acrobat 正在以我的屏幕分辨率渲染一个 8.5 英寸的文档，使用标尺仔细测量的分辨率是 110 dpi。

无论如何，因此解决方案是 a) 缩小到 70%，或者，我想大多数人会认为 100% 是最佳缩放，b) 以 110 dpi 或更高的分辨率重新制作文档以适应如今，无论典型的决议是什么。

# c++ - 您将如何缩短它以使 action1 和 action2 在代码中只出现一次？

> ID：578304
> 
> 赞同：1
> 
> 时间：2009-02-23T16:34:54.523
> 
> 标签：c++, c

```
if (x() > 10)
{
    if (y > 5)
        action1(p1, p2, p3, p4);
    else
        action2(p1, p2);
}
else
{
    if (z > 2)
        action1(p1, p2, p3, p4);
    else
        action2(p1, p2);
} 
```

我的真实项目，action1 和 action2 实际上是 2-3 行代码，而被调用的函数总共需要 6-8 个参数，因此将它们写为单个函数似乎不正确。

更新：我忘了提到这一点，现在我看到很多答案都不起作用。x() 是昂贵的操作并且有副作用，所以它不应该被调用两次。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-23T16:40:08.037

```
if (should_do_action1(x(), y, z))
    action1(p1, p2, p3, p4);
else
    action2(p1, p2); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-23T16:38:52.610

```
if ((x > 10 && y > 5) || (x <= 10 && z > 2))
   action1(p1, p2, p3, p4);
else
   action2(p1, p2); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-23T16:38:04.080

你总是可以这样做：

```
if ((x > 10) ? (y >5) : (z > 2)) action1
else action2 
```

为了完整起见，任何`if p then q else r`陈述都可以在逻辑上表示为`(!p && r) || q`。因此，我们可以将原始陈述表达为：

```
a = x > 10
b = y > 5
c = z > 2
(!a && (!c && action2) || ((!b && action2) || action1)) 
```

您可以扩展为：

```
(!a && !c && action2) || 
(!a &&  c && action1) || 
( a && !b && action2) || 
( a &&  b && action1) 
```

如果您将 action1 收集到一侧，您将获得：

```
( a &&  b && action1) ||
(!a &&  c && action1) || 

( a && !b && action2) || 
(!a && !c && action2) 
```

它实际上扩展到：

```
( a &&  b &&  c && action1) ||
( a &&  b && !c && action1) ||
(!a &&  b &&  c && action1) || 
(!a && !b &&  c && action1) || 

( a && !b &&  c && action2) || 
( a && !b && !c && action2) || 
(!a &&  b && !c && action2) ||
(!a && !b && !c && action2) 
```

从中我们可以看到我们可以将其简化为：

```
( a &&  b &&  c && action1) ||
( a &&  b && !c && action1) ||
(!a &&  b &&  c && action1) || 
(!a && !b &&  c && action1) || 
action2 
```

由于通向 action2 的所有路径都是通向 action1 的任何路径的否定，我们可以进一步将其简化为：

```
( a &&  b && action1) ||
(!a &&  c && action1) || 
action2 
```

其本身可以简化为：

```
((( a &&  b &&) || (!a &&  c)) && action1) || 
action2 
```

然后可以写成：

```
if ((a && b) || (!a && c)) action1
else action2 
```

变成： if ((x > 10 && y > 5) || (!(x > 10) && z > 2)) action1 else action2

无论如何，这就是我们得到的。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-23T16:51:11.973

```
bool condition_satisfied = (x() > 10 ? y > 5 : z > 2);
if (condition_satisfied)
    action1(p1, p2, p3, p4);
else
    action2(p1, p2); 
```

或者，或者，Roger Lipscombe 的[回答](https://stackoverflow.com/questions/578304/how-would-you-shorten-this-so-that-action1-and-action2-only-show-up-once-in-code/578326#578326)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-23T16:38:16.980

我喜欢原始的，详细的版本。但前提是它遵循代码所描述的系统的内部逻辑。否则，也许它应该是“相反的”：

```
int xRes = x();
if (y > 5) 
{
    if (xRes > 10)
        action1(p1, p2, p3, p4);
    else
        action2(p1, p2);
}
else if (z > 2)
{
    if (xRes > 10)
        action1(p1, p2, p3, p4);
    else
        action2(p1, p2);
}
else
{
    action2(p1, p2);
} 
```

无论如何，如果您对最短的解决方案感兴趣，可以是：

```
((x>10 && y>5) || (x<=10 && z>2)) ? action1(p1, p2, p3, p4) : action2(p1, p2); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-23T16:41:07.393

我想不出一种更清楚或更简单的方式来表达它。它可以更短，但它会使它更难理解。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-23T16:40:58.393

```
//Yeah, I know this is wrong. Explanation below.
if ((x() > 10 && y > 5) || (x() <= 10 && z > 2))
    action1(p1, p2, p3, p4);
else
    action2(p1, p2); 
```

[编辑] 更改代码，因为我的条件逻辑错误。

但就个人而言，为了便于阅读，我更喜欢你更详细的版本。

[edit2] 正如评论所注意到的，我似乎很难完全正确地做到这一点。我会注意到，这是因为我的处理方式几乎就是问题最初的陈述方式。我更喜欢冗长而不是布尔运算符字符串，因为在我看来，它使操作的逻辑更容易可视化。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-23T17:10:38.993

因为 x() 很昂贵，所以缓存结果。然后结合action1的前提条件：

```
int x = x();
if ((x>10 && y>5) || (x<=10 && z>2))
{
    action1(p1,p2,p3,p4);
}
else 
{
    action2(p1,p2);
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-23T16:40:56.757

如果您只想使用 1 个 if 语句来执行此操作，我认为应该是：

```
if ((x > 10) && (y > 5)) || ((x <= 10) && (z > 2))
    action1(p1, p2, p3, p4);
else
    action2(p1, p2); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-23T16:44:06.170

您知道，在看到这里的一些回复后，我不得不说您的原始版本更具可读性，当然也更易于理解。我要做的唯一更改是在*else*行添加一点注释，说明 else 情况适用于 x <= 10。

我不认为出于任何原因缩短代码真的是个大问题。我知道，如果您是老派编码员，您希望一切都尽可能简洁，但我们都有 100+Gb 驱动器和编译器无论如何都会将这些替代方案中的任何一个都折叠为相同的代码，所以为什么不选择可读性? 我的 2 美分 :)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-23T17:11:40.317

```
var valX= x();
if ((valX > 10  && y>5) || (valX<=10 && z>2))
{

        action1(p1, p2, p3, p4);
}
else
{  
        action2(p1, p2);  
} 
```

# java - 使用内存中的字节数组（没有物理文件）创建 Java File 对象（或等效对象）

> ID：578305
> 
> 赞同：8
> 
> 时间：2009-02-23T16:35:24.523
> 
> 标签：java, spring, file, memory, io

我想`File`在内存中创建一个 Java 对象（不创建物理文件）并用字节数组填充其内容。

这可以做到吗？

这个想法是将它传递给 Spring `InputStreamSource`。我正在尝试下面的方法，但它返回说“字节数组不包含文件名。”。

```
MimeMessage message = mailSender.createMimeMessage();
MimeMessageHelper helper = new MimeMessageHelper(message);      
helper.setFrom("no-reply@example.com", "xyz");
helper.setTo(email);
helper.setText(body,true);
helper.setSubject(subject);
helper.addInline("cImage",
        new InputStreamResource(new ByteArrayInputStream(imageByteArr)));

mailSender.send(message); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T16:41:07.690

您可以粘贴完整的堆栈跟踪吗？没有“内存中”文件之类的东西。使用 ByteArrayInputStream 就足够了。

* * *

您需要实现 Resource#getFilename()。尝试以下操作：

```
helper.addInline("cImage", new ByteArrayResource(imageByteArr){
            @Override
            public String getFilename() {
                return fileName;
            }
        }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T16:40:00.127

也许您需要使用[InputStreamResource 的其他构造函数](http://static.springframework.org/spring/docs/1.1.5/api/org/springframework/core/io/InputStreamResource.html#InputStreamResource(java.io.InputStream,%20java.lang.String))？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T16:47:28.440

您是否尝试过将您提供的资源更改为 addInline()？如果您希望资源在内存中，我会尝试使用 org.springframework.core.io.ByteArrayResource。

更新：我认为您可能需要使用 addInline() 方法的 DataSource 版本，然后使用字节数组绑定数据源对象将数据提供给帮助程序类。我会尝试以下方法：

```
MimeMessage message = mailSender.createMimeMessage();
MimeMessageHelper helper = new MimeMessageHelper(message);              
helper.setFrom("no-reply@example.com", "xyz");
helper.setTo(email);
helper.setText(body,true);
helper.setSubject(subject);

// use javax.mail.util.ByteArrayDataSource
ByteArrayDataSource imgDS = new ByteArrayDataSource( imageByteArr, "image/png");
helper.addInline("cImage", imgDS);

mailSender.send(message); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T17:27:28.283

也许值得尝试不同的方法重载：

```
addInline(String contentId, 
          InputStreamSource inputStreamSource, 
          String contentType) 
```

IE：

```
addInline("cImage", 
          new InputStreamSource () 
          {  
             final private InputStream src = 
                                     new ByteArrayInputStream(imageByteArr);
             public InputStream getInputStream() {return src;}
          },
          "image/jpeg"); // or whatever image type you use 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T19:53:09.537

正确创建 MimeMessageHelper 对象以支持附件和内联资源非常重要。

示例： MimeMessageHelper helper = new MimeMessageHelper(message, true, "UTF-8");

在此示例中，由于 multipart 设置为 true，因此将使用 MULTIPART_MODE_MIXED_RELATED，并支持附件和内联资源。

# oracle - 从预言机钱包中读取私钥

> ID：578310
> 
> 赞同：1
> 
> 时间：2009-02-23T16:36:43.753
> 
> 标签：oracle, pki

我们使用 Oracle 钱包来编写 Oracle 版本的脚本。

使用 mkstore，我可以向 Oracle 钱包添加或删除私钥。

无论是使用 Java 还是 C#，我都想读取 Oracle 钱包中的私钥。

有人可以分享示例代码如何做到这一点。

这篇文章解释了如何使用 Java 打开钱包，但它不读取私钥。 [http://blog.mikesidoti.com/2007/04/opening-oracles-wallet.html](http://blog.mikesidoti.com/2007/04/opening-oracles-wallet.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T00:18:33.850

钱包的目的不是防止任何东西读取私钥吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T09:05:32.613

你可以试试这个：openssl pkcs12 -nocerts -out priv.key -in wallet\ewallet.p12

我在这篇博文中找到了它：[链接](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDIQFjAA&url=http://ilmarkerm.blogspot.com/2012/05/extracting-private-key-from-oracle.html&ei=eEbIUPOVJoPQtAbRqoCoDg&usg=AFQjCNFsKtHrHCvlguWqgwyuAxwN-De0AQ&sig2=9Fn342v16U2swBsiDzCrmQ&cad=rja)

# security - 安全证书问题

> ID：578313
> 
> 赞同：3
> 
> 时间：2009-02-23T16:37:40.773
> 
> 标签：security, iis

我最近为我帮助维护的网站安装了安全证书。当我在工作和网络服务器所在的网络上时，我可以很好地导航到安全页面 (https)。当我尝试从网络外部（例如从家里）访问相同的页面时，出现错误。这是我网站上的示例页面：[https ://www.acpe.org/MyACPE/Activity/MyActivity.aspx](https://www.acpe.org/MyACPE/Activity/MyActivity.aspx)

我以为它可能是我们的梭子鱼防火墙，但我们完全关闭了它，问题仍然存在。[我在 Verisign](https://knowledge.verisign.com/support/ssl-certificates-support/index?page=certchecker)检查了证书，它说没问题：

我不知所措。我会很感激任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T16:46:28.787

Verisign 的[OCSP](http://en.wikipedia.org/wiki/Ocsp)响应者说您的证书已被吊销。

您用于测试的某些环境可能没有启用 OCSP。您可以通过在当前失败的浏览器中禁用 OCSP 检查来测试这一点。之后它应该开始工作。

如果您的证书被吊销，您应该获得另一个证书。

* * *

威瑞信已为 www.acpe.org 颁发了多个证书。仍然有效的有序列号`27583686efafc6484ac19d7ce82be271`。当前`www.acpe.org`配置为使用的已撤销，并且序列号为`21ee7e042a53142a9f5075fc2dbff37a`. 我无法让 OpenSSL 的`ocsp`工具正常工作，所以我看不到给出的“原因”代码，但从那里的信息来看，证书所有者于 2 月 10 日要求更换。确保您正确安装了*新*证书。

通过输入通用名称“www.acpe.org”，您可以通过 Verisign 的证书[存储库工具查看此状态信息。](https://securitycenter.verisign.com/celp/enroll/outsideSearch?application_locale=VRSN_US&originator=VeriSign:CELP)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T16:45:51.783

证书似乎在 2004 年过期。这是我使用 Netscape 4.5.1 获得的信息：

此证书属于：Class 3 Public Primary Certification Authority VeriSign, Inc. US

```
 This Certificate was issued by:
                             Class 3 Public Primary Certification
                             Authority
                             VeriSign, Inc.
                             US 
```

序列号：00:E4:9E:FD:F3:3A:E8:0E:CF:A5:11:3E:19:A4:24:02:32 此证书有效期为 1996 年 1 月 28 日星期日至 1 月 7 日星期三, 2004 证书指纹：78:2A:02:DF:DB:2E:14:D5:A7:5F:0A:DF:B6:8E:9C:5

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T16:57:27.340

据我所知，证书已被吊销。你确定你安装了一个有效的证书？

# iis - 如何安全地将所有 IIS 设置从一台服务器导出到另一台服务器？

> ID：578341
> 
> 赞同：5
> 
> 时间：2009-02-23T16:43:25.953
> 
> 标签：iis, configuration, sysadmin, metabase

我正在尝试构建一个虚拟机来克隆我们的 webapp 生产实例中使用的服务器之一，以便我们可以对其进行部署测试。

我已经完成了所有必要的文件，安装了 IIS，启动并运行了数据库。在我看来，剩下的就是将所有 IIS 设置从生产环境复制到虚拟机。过去，我在类似的情况下只是简单地备份元数据库，找到文件，将其移动到新机器，然后恢复。然而，这是一个更困难的场景，当我尝试这样做时，目标机器告诉我元数据库文件具有“无效签名”。

谷歌搜索了一段时间，我发现对此的建议是使用 iiscnfg.vbs /export 但是，此页面上的 msdn 页面[建议](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/73f66ff1-be38-4850-8965-739004acd641.mspx?mfr=true)使用[iiscnfg.vbs /copy](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/81f04967-f02f-4845-9795-bad2fe1a1687.mspx?mfr=true)（尽管链接指向自身）。

因此，按照所有复制步骤，我得到以下输出：

```
C:\WINDOWS\system32>cscript.exe iiscnfg.vbs /copy /ts 208.10.202.61 /tu wmydomain\admin /tp mypassword
Microsoft (R) Windows Script Host Version 5.6
Copyright (C) Microsoft Corporation 1996-2001\. All rights reserved.

Backing up server 127.0.0.1
Backup complete.
Mapping local drive E: to admin share on server 127.0.0.1
Mapping local drive F: to admin share on server 208.10.202.61 
```

看起来不错，除了在目标计算机上似乎没有任何改变。是什么赋予了？还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T17:15:42.913

您可以使用[Web 部署工具](http://learn.iis.net/page.aspx/445/synchronize-iis-60/)在本地和远程 IIS 服务器之间同步网站。（它也可以从 IIS 6 转到 IIS 7）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-28T02:57:32.577

有许多实用程序允许您从正在运行的服务器创建虚拟机。例如，这里是来自 VMWare ( [http://www.vmware.com/products/converter/](http://www.vmware.com/products/converter/) ) 的那个。我发现虚拟化物理机的最简单方法。

如果要在同一网络/域上运行，则需要更改机器的 sid。如果我没记错的话，该应用程序将为您完成。绝对值得一试。

# jquery-ui - 在 Jquery-UI 选项卡中按名称切换到选定的选项卡

> ID：578348
> 
> 赞同：52
> 
> 时间：2009-02-23T16:45:23.327
> 
> 标签：jquery-ui, tabs

如果我有三个标签：

```
<div id="tabs">
    <ul>
        <li><a href="#sample-tab-1"><span>One</span></a></li>
        <li><a href="#sample-tab-2"><span>Two</span></a></li>
        <li><a href="#sample-tab-3"><span>Three</span></a></li>
    </ul>
</div> 
```

我想用它的名字换成#sample-tab-2。我知道如果我知道它的数字，我可以切换到一个选项卡，但如果我遇到了，我不会知道。

注释：JQuery 1.3.1 / JQuery-UI 1.6rc6

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2011-01-10T11:04:01.277

我无法得到以前的答案。我执行以下操作以按名称获取选项卡的索引：

```
var index = $('#tabs a[href="#simple-tab-2"]').parent().index();
$('#tabs').tabs('select', index); 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-04-08T16:17:38.107

似乎使用 id 和索引一样有效，例如，只需这样做就可以开箱即用......

```
$("#tabs").tabs("select", "#sample-tab-1"); 
```

这在[官方文档](http://jqueryui.com/demos/tabs/#method-select)中有很好的记录：

> "选择一个选项卡，就像它被点击一样。第二个参数是要选择的选项卡的从零开始的索引**或选项卡关联的面板的 id 选择器（选项卡的 href 片段标识符，例如哈希，指向面板的 ID）。** ”

我认为这是在提出这个问题之后添加的，可能是在大多数答案之后

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-02-14T16:42:49.070

```
$('#tabs').tabs('select', index); 
```

jquery ui 1.10.0 不支持方法“选择”。[http://api.jqueryui.com/tabs/](http://api.jqueryui.com/tabs/)

我使用此代码，并且工作正常：

```
 $('#tabs').tabs({ active: index }); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-23T16:52:49.177

您可以使用以下脚本按名称获取选项卡的索引：

```
var index = $('#tabs ul').index($('#simple-tab-2'));
$('#tabs ul').tabs('select', index); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-04-21T20:24:34.377

只有这段代码真正有效！

```
$('#tabs').tabs();
$('#tabs').tabs('select', '#sample-tab-2'); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-12-09T15:58:12.677

使用这个功能：

```
function uiTabs(i){
    $("#tabs").tabs("option", "selected", i);
} 
```

并使用以下代码在选项卡之间切换：

```
<a onclick="uiTabs(0)">Tab 1</a>
<a onclick="uiTabs(1)">Tab 2</a>
<a onclick="uiTabs(2)">Tab 3</a> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-05-01T03:31:19.993

获取选项卡的从零开始的索引的唯一实用方法是逐步检查构成选项卡集的每个元素（LI>A s）并匹配它们的内部文本。它可能可以以更清洁的方式完成，但这就是我的做法。

```
$('#tabs ul li a').each(function(i) {
    if (this.text == 'Two') {$('#reqTab').val(i)}
});

$("#tabs").tabs({
    selected: $('#reqTab').val()
}); 
```

你可以看到我在页面中使用了一个隐藏的 <input id="reqTab"> 字段来确保变量从一个函数移动到另一个函数。

注意：有一点小问题——在标签集被激活后选择标签似乎不像 jQuery UI 1.8 中所宣传的那样工作，这就是为什么我使用第一次通过时识别的索引来初始化标签集选择所需的选项卡。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-01-19T11:01:58.797

以下作品对我有用

`$($("#tabs")[0]).tabs({selected: 1});`

希望这可以帮助！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-03-26T17:24:01.790

试试这个：“选择”/“活动”选项卡

```
<article id="gtabs">
    <ul>
        <li><a href="#syscfg" id="tab-sys-cfg" class="tabtext">tab One</a></li>
        <li><a href="#ebsconf" id="tab-ebs-trans" class="tabtext">tab Two</a></li>
        <li><a href="#genconfig" id="tab-general-filter-config" class="tabtext">tab Three</a></li>
    </ul> 
```

```
var index = $('#gtabs a[href="#general-filter-config"]').parent().index(); 
```

// `'select' 在 jquery ui 版本 1.10.0 中不支持

```
$('#gtabs').tabs('select', index); 
```

替代解决方案：使用“活动”：

```
$('#gtabs').tabs({ active: index }); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-06T15:46:11.107

如果您正在更改 href，您可以为链接分配一个 id，`<a href="#sample-tab-1" id="tab1"><span>One</span></a>`以便您可以通过它的 id 找到选项卡索引。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-10-24T19:53:41.520

@bduke 的答案实际上只需稍作调整即可。

```
var index = $("#tabs>div").index($("#simple-tab-2"));
$("#tabs").tabs("select", index); 
```

以上假设类似于：

```
<div id="tabs">
  <ul>
    <li><a href="#simple-tab-0">Tab 0</a></li>
    <li><a href="#simple-tab-1">Tab 1</a></li>
    <li><a href="#simple-tab-2">Tab 2</a></li>
    <li><a href="#simple-tab-3">Tab 3</a></li>
  </ul>
  <div id="simple-tab-0"></div>
  <div id="simple-tab-1"></div>
  <div id="simple-tab-2"></div>
  <div id="simple-tab-3"></div>
</div> 
```

jQueryUI 现在支持使用选项卡的 ID/HREF 选择器调用“select”，但是在构建选项卡时，“selected”选项仍然只支持数字索引。

我投票给了 bdukes 让我走上正轨。谢谢！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-03-23T16:26:30.893

这是按名称获取所选选项卡的示例代码。我希望这可以帮助您找到 ypur 解决方案：

```
<html>
<head>
<script type="text/javascript"><!-- Don't forget jquery and jquery ui .js files--></script>
<script type="text/javascript">
   $(document).ready(function(){
     $('#tabs').show();

     // shows the index and tab title selected
     $('#button-id').button().click(function(){
         var selTab = $('#tabs .ui-tabs-selected');
         alert('tab-selected: '+selTab.index()+'-'+ selTab.text());
     });
  });
</script>
</head>
<body>
   <div id="tabs">
      <ul id="tablist">
            <li><a href='forms/form1.html' title="form_1"><span>Form 1</span></a></li>
            <li><a href='forms/form2' title="form_2"><span>Form 2</span></a></li>
      </ul>
   </div>
    <button id="button-id">ClickMe</button>
</body>
</html> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-08-03T16:22:41.153

```
$('#tabs a[href="#sample-tab-1"]').click(); 
```

或者，您可以为链接分配一个 ID

```
<a href="#sample-tab-1" id="tab1">span>One</span></a> 
```

所以你可以找到它的id。

```
$('#tab1').click(); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-08-21T11:03:26.597

将特定选项卡索引设置为活动：

```
$(this).tabs({ active: # }); /* Where # is the tab index. The index count starts at 0 */ 
```

将最后一个选项卡设置为活动

```
$(this).tabs({ active: -1 }); 
```

按 ID 设置特定选项卡：

```
$(this).tabs({ active: $('a[href="#tab-101"]').parent().index() }); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-09-26T22:09:32.447

我很难得到任何答案，因为它们是基于旧版本的 JQuery UI。我们使用的是 1.11.4（[CDN 参考](https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js)）。

这是我的小提琴与工作代码： http: [//jsfiddle.net/6b0p02um/](http://jsfiddle.net/6b0p02um/) 我最终将来自四个或五个不同线程的位拼接在一起以使我的工作：

```
 $("#tabs").tabs(); 

    //selects the tab index of the <li> relative to the div it is contained within
    $(".btn_tab3").click(function () {
        $( "#tabs" ).tabs( "option", "active", 2 );
    });         

    //selects the tab by id of the <li>
    $(".btn_tab3_id").click(function () {
      function selectTab(tabName) {
          $("#tabs").tabs("option", "active", $(tabName + "").index());
      }

      selectTab("#li_ui_id_3");
    }); 
```

# c# - Visual Studio：上下文切换死锁

> ID：578357
> 
> 赞同：198
> 
> 时间：2009-02-23T16:47:33.650
> 
> 标签：c#, sql-server, visual-studio

我收到一条我无法解决的错误消息。它源自 Visual Studio 或调试器。我不确定最终的错误情况是在 VS、调试器、我的程序还是数据库中。

这是一个 Windows 应用程序。不是网络应用程序。

来自 VS 的第一条消息是一个弹出框，上面写着：“没有为任何调用堆栈帧加载符号。源代码无法显示。” 当它被点击时，我得到：“ **ContextSwitchDeadlock was detected** ”，以及下面复制的一条长消息。

错误出现在向下扫描 DataTable 的循环中。对于每一行，它使用表中的键 (HIC #) 值作为 SqlCommand 的参数。该命令用于创建返回一行的 SqlDataReader。比较数据。如果检测到错误，则将一行添加到第二个 DataTable。

该错误似乎与程序运行所需的时间（即 60 秒后）有关，而不是发现了多少错误。我不认为这是一个内存问题。循环内没有声明任何变量。创建的唯一对象是 SqlDataReaders，它们位于 Using 结构中。添加 System.GC.Collect() 没有效果。

db 是同一台笔记本电脑上的 SqlServer 站点。

表单上没有花哨的小玩意或小工具。

我不知道这个过程中有什么与我之前做过的几十次有很大不同的地方。我以前见过这个错误，但从来没有一致的基础。

任何想法，任何人？

**完整的错误文本：** CLR 在 60 秒内无法从 COM 上下文 0x1a0b88 转换到 COM 上下文 0x1a0cf8。拥有目标上下文/单元的线程很可能要么进行非泵送等待，要么处理非常长时间运行的操作而不泵送 Windows 消息。这种情况通常会对性能产生负面影响，甚至可能导致应用程序变得无响应或内存使用量随着时间的推移不断累积。为避免此问题，所有单线程单元 (STA) 线程都应使用泵送等待原语（例如 CoWaitForMultipleHandles）并在长时间运行的操作期间定期泵送消息。

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2009-02-23T17:07:18.953

这`ContextSwitchDeadlock`并不一定意味着您的代码有问题，只是有潜力。如果您进入`Debug > Exceptions`菜单并展开`Managed Debugging Assistants`，您会发现`ContextSwitchDeadlock`已启用。

如果你禁用它，当项目需要很长时间来处理时，VS 将不再警告你。在某些情况下，您可能有效地进行了长时间运行的操作。如果您正在调试并且在处理过程中停止在线，这也很有帮助 - 在您有机会深入研究问题之前，您不希望它抱怨。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2019-03-07T16:43:05.997

在 Visual Studio 2017 中，通过以下方式取消选中 ContextSwitchDeadlock 选项：

调试 > Windows > 异常设置

[![在此处输入图像描述](https://i.stack.imgur.com/IJ0UY.png)](https://i.stack.imgur.com/IJ0UY.png)

在异常设置窗口中：取消选中 ContextSwitchDeadlock 选项

[![在此处输入图像描述](https://i.stack.imgur.com/nlo0W.png)](https://i.stack.imgur.com/nlo0W.png)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-04T22:41:06.893

正如 Pedro 所说，如果您单步执行代码，则调试器会阻止消息泵。

但是，如果您在 UI 线程上执行长时间运行的操作，则调用 Application.DoEvents() 显式泵送消息队列，然后将控制权返回给您当前的方法。

但是，如果您这样做，我建议您查看您的设计，以便您可以在 UI 线程之外执行处理，从而使您的 UI 保持美观和活泼。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-23T17:02:53.443

听起来您正在应用程序的主 UI 线程上执行此操作。UI 线程负责在到达时发送 Windows 消息，但由于您的消息在数据库调用中被阻塞，因此无法执行此操作。这可能会导致系统范围的消息出现问题。

您应该考虑为长时间运行的操作生成一个后台线程，并在它发生时为用户设置某种“我很忙”对话框。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-04T22:38:20.300

如果您不想禁用此异常，您需要做的就是让您的应用程序至少每 60 秒发送一次消息。它将防止发生此异常。尝试不时调用 System.Threading.Thread.CurrentThread.Join(10)。您还可以执行其他调用来让消息激增。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-07-21T09:12:11.460

上述解决方案在某些情况下很好，但在另一种情况下，当您进行单元测试并且当您的解决方案未设置为调试时尝试从测试资源管理器中“调试选定的测试”时会发生这种情况。

在这种情况下，您需要将解决方案从 Release 或任何设置为 Debug 在这种情况下更改。如果这是问题所在，那么更改“ContextSwitchDeadlock”不会真正帮助您。

我自己错过了这个，因为错误消息太讨厌了，我没有检查明显的东西是调试设置！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-07-07T09:34:36.187

在 Visual Studio 2017 西班牙语版本中。

> “Depurar” -> “Ventanas” -> “Configuración de Excepciones”

并搜索“ContextSwitchDeadlock”。然后，取消选中它。或捷径

> Ctrl+D,E

最好的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-06T07:14:54.740

您可以通过取消选中 contextswitchdeadlock 来解决这个问题

Debug->Exceptions ... -> 展开 MDA 节点 -> 取消选中 -> contextswitchdeadlock

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-04-01T22:02:33.583

也有这个问题，我的解决方法是在我的线程中添加“等待”：

```
Await Task.WhenAll(taskList.ToArray())
Await Task.Run(myAction) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-10T20:22:26.090

我收到此错误并将查询切换为异步（等待（...）.ToListAsync（））。现在一切都好。

# java - javadoc：@version 和 @since

> ID：578363
> 
> 赞同：54
> 
> 时间：2009-02-23T16:49:16.440
> 
> 标签：java, documentation, javadoc

是否有理由将两者都包括在内`@version`并`@since`作为课程的一部分？

它们似乎是相互排斥的。

另外，是什么意思，`%I%`以及`%G%` 如何设置/使用它们？

```
 @version %I%, %G% 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-23T16:55:22.353

`@version`标签应该是当前版本的发行版或相关文件。,语法是源代码管理软件将用文件的当前版本和文件签出日期替换的宏`%I%`。`%G%`

该`@since`标记应该用于定义您添加了方法、类等的哪个版本。这是您对其他开发人员的提示，他们应该只在针对特定版本的包运行时才期望该方法。如果您将代码作为供其他人使用的库提供，我会考虑文档中这些非常重要的部分。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-08-27T10:00:05.480

在 Oracle 的一篇文章[How to Write Doc Comments for the Javadoc Tool](http://www.oracle.com/technetwork/java/javase/documentation/index-137868.html)中有很好的解释。

# `@version`

> …仅限类和接口。
> 
> 在 Java Software，我们使用@version 表示 SCCS 版本。有关详细信息，请参阅“man sccs-get”。共识似乎如下：
> 
> 每次编辑和删除文件时，%I% 都会增加
> 
> %G% 是日期 mm/dd/yy
> 
> 创建文件时，%I% 设置为 1.1。当您编辑和删除它时，它会增加到 1.2。
> 
> 如果某些开发人员觉得 %G% 太混乱，他们会省略日期（并且一直这样做）——例如，3/4/96，%G% 将在 3 月 4 日生成，将由美国以外的人解释州意味着 4 月 3 日。一些开发人员仅在他们想要更精细的分辨率时才包含时间 %U%（由于一天内多次签入）。
> 
> 最清晰的数字日期格式是将日期格式化为第一个年份，例如 yyyy-mm-dd，如 ISO 8601 和其他地方（例如[http://www.cl.cam.ac.uk/~ mgk25/iso-time.html](http://www.cl.cam.ac.uk/~mgk25/iso-time.html)），但这种增强需要来自 SCCS。

# `@since`

> 指定将 Java 名称添加到 API 规范时的产品版本（如果与实现不同）。例如，如果将包、类、接口或成员添加到 Java 2 Platform, Standard Edition, API Specification 1.2 版，请使用：

```
/**
 * @since 1.2
 */ 
```

> Javadoc 标准 doclet 显示一个“Since”子标题，其中字符串参数作为其文本。此子标题仅出现在生成的文本中与源文档注释中 @since 标记出现的位置相对应的位置（Javadoc 工具不会将其沿层次结构扩展）。
> 
> （约定曾经是“@since JDK1.2”，但因为这是 Java 平台的规范，而不是特定于 Oracle JDK 或 SDK，所以我们删除了“JDK”。）
> 
> 当一个包被引入时，在它的包描述和它的每个类中指定一个@since 标签。（在技术上不需要为每个类添加@since 标签，但这是我们的惯例，因为这样可以提高源代码的可见性。）在没有覆盖标签的情况下，@since 标签的值适用于每个包的类和成员。
> 
> 引入类（或接口）时，在其类描述中指定一个@since 标签，在成员中不指定@since 标签。仅将@since 标记添加到在比类更高版本中添加的成员。这最大限度地减少了@since 标签的数量。
> 
> 如果成员在以后的版本中从 protected 更改为 public，@since 标记不会更改，即使它现在可供任何调用者使用，而不仅仅是子类。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-23T16:54:16.067

我看不出它们是如何相互排斥的。一个用于定义版本，另一个用于描述方法何时存在。例如：

```
/**
 * Does Whatever
 * @version 1.2.3
 * @since 1.2.0
 *
 */
public void myMethod() {
    // .......
} 
```

关于你提到的字符，它们似乎是专有的，无论如何我都不知道它们是什么意思。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-13T02:59:26.630

`@version`将记录每次编辑。[1.3.21]

`@since`意思是因为哪个发行版本会支持这个接口等等。[1.3] Yuval Adam 很有趣，但这不是标准，java doc 的目的是每个人都能理解。

# c# - 如何仅更新已更改的字段？

> ID：578368
> 
> 赞同：3
> 
> 时间：2009-02-23T16:50:56.730
> 
> 标签：c#, dataset

我有一个数据集，我在数据表中创建一个新行并填写 1 或 2 个字段。他们可能不是每次都一样。

当我执行 dataset.update() 时，所有字段似乎都被写回了。我的数据库后端设置了未触发的默认值。

有没有办法让数据集只插入我手动更改的值，从而允许数据库“填写其他字段的默认值”？

我还需要让数据集生成插入语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T17:42:08.417

您将无法让设计器生成插入语句（或让数据适配器在运行时生成它）并有选择地选择要设置的字段。

虽然 DataSet 确实具有更改监控，但它是在行级别，而不是列级别。因此，您必须在进行更改时跟踪设置了哪些列。

如果要更改的列是一致的，那么我将在设计器中手动制作查询以仅插入这些值。

否则，您将不得不自行监控哪些列发生了变化。如果数据库中的表没有允许空值的列，您可以允许 DataSet 中的列具有空值，并将其设置为默认值。然后，如果该列没有空值，您就知道它已被更改。

如果它确实允许空值，那么您将必须在 DataSet 外部存储一个标志，指示是否为该列设置了该值（当列更改时您将这样做）。

注意：当我说 DataSets 没有更改监控时，我的意思是对 DataSet/DataTable 上的 GetChanges 的调用不会告诉您更改了哪一列，只是更改了哪些行。对 GetChanges 的调用是 DataAdapter 将用来确定要发送到服务器的内容，但它不知道要发送哪些列，因此将它们全部发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T17:01:24.257

尝试使用类型化数据集或 adapter.FillSchema 方法。

**更新 1**虽然这将发送额外的值，但它会在执行插入时有效地使用数据库默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T18:17:43.527

您可以通过整理手动设置默认值

Column.DefaultValue = 默认值；

要生成插入语句，您可以使用 CommandBuilder 类

新的 SqlCeCommandBuilder(dAdapter);

# user-interface - 隐藏行标签

> ID：578371
> 
> 赞同：18
> 
> 时间：2009-02-23T16:51:28.680
> 
> 标签：user-interface, qt4, pyqt

我正在使用 Qt4 创建一个表，使用`QTableWidget`该类。

问题是：我想隐藏行标签（即数字）。我只关心列。我想得到这个：

[![替代文字](https://i.stack.imgur.com/D7z9R.png)](https://i.stack.imgur.com/D7z9R.png)
[（来源：[ldc.usb.ve](http://www.ldc.usb.ve/docs/qt/images/windowsxp-tableview.png)）]

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-23T17:30:16.620

我想知道同样的事情。但是，在您问之前，我懒得找到解决方案。（谢谢！！）。无论如何，这是对我有用的代码：

```
 table = QtGui.QTableWidget()
    table.verticalHeader().setVisible(False) 
```

这些实际上是**QTableView 的**方法。由于您使用**QTableWidget**，它是**QTableView**的子级，所以一切正常。

我不确定这是否是最好的方法，但**QHeaderView**文档推荐这种方法。引用 PyQt4 文档-

> **外观**
> 
> QTableWidget 和 QTableView 创建默认标题。如果希望标题可见，可以使用 setVisible()。
> **注意**：每个标头都为每个部分本身呈现数据，并且不依赖于委托。因此，调用标头的 setItemDelegate() 函数将不起作用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-06T12:19:31.653

您还可以将数据放在 QTableView 对象中，并使用**hide()**函数隐藏垂直行标题。这是示例代码，

```
 QTableView *empview = new QTableView();
 empview->verticalHeader()->hide(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-22T11:23:00.637

现在你可以使用[方法](http://doc.qt.io/qt-5/qtreeview.html#headerHidden-prop)：

```
setHeaderHidden(true); 
```

继承自**QTreeView**。它是在 Qt4.4 中引入的。

# python - 查找斐波那契数列的 Python 程序。更多 Pythonic 方式

> ID：578379
> 
> 赞同：6
> 
> 时间：2009-02-23T16:53:23.123
> 
> 标签：python

Python 中还有另一个线程讨论斐波那契系列。这是为了将代码调整为更 Pythonic。[如何在 Python 中编写斐波那契数列](https://stackoverflow.com/questions/494594/how-to-write-the-fibonacci-sequence-in-python)

我爱上了我为解决 Project Euler Q2 而编写的这个程序。我正在使用 Python 进行新的编码，每次我这样做时都会很高兴 Pythonic 方式！你能建议一个更好的 Pythonic 方法来做到这一点吗？

[欧拉计划 Q2](http://projecteuler.net/index.php?section=problems&id=2)。求斐波那契数列中不超过四百万的所有偶数项之和。

```
fib=[]
def fibo(a=-1,b=1,upto=4000000):
    if a+b>=upto:
        return
    else:
        a,b=b,a+b
        fib.append(b)
        fibo(a,b)

fibo()
even=[i for i in fib if not i%2]
print sum(even) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-23T17:02:01.433

使用生成器是一种在保留内存的同时生成长序列的 Pythonic 方式：

```
def fibonacci():
  a, b = 0, 1
  while True:
    yield a
    a, b = b, a + b

import itertools
upto_4000000 = itertools.takewhile(lambda x: x <= 4000000, fibonacci())
print(sum(x for x in upto_4000000 if x % 2 == 0)) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-23T17:02:33.177

首先，我将 fibo() 作为生成器：

```
def fibo(a=-1,b=1,upto=4000000):
    while a+b<upto:
        a,b = b,a+b
        yield b 
```

然后我也会选择均匀度作为生成器而不是列表理解。

```
print sum(i for i in fibo() if not i%2) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T16:56:56.607

一方面，我建议在计算它们时对这些术语求和，而不是将它们存储在一个数组中，然后再对数组求和，因为除了将它们相加之外，你不需要对各个术语做任何事情。（这在任何语言中都是很好的计算意义）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T17:00:56.660

我将进行以下更改：

*   使用迭代而不是递归
*   只保留一个运行总计，而不是保留所有斐波那契数字的列表，然后在后验中找到偶数的总和

除此之外，它是*相当*Pythonic 的。

```
def even_fib_sum(limit):
    a,b,sum = 0,1,0
    while a <= limit:
        if a%2 == 0:
            sum += a
        a,b = b,a+b
    return sum

print(even_fib_sum(4000000)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T17:19:28.537

我会像[@constantin' 的答案](https://stackoverflow.com/questions/578379/python-program-to-find-fibonacci-series-more-pythonic-way/578424#578424)那样使用斐波那契生成器，但是生成器表达式可以用一个普通的`for`循环代替：

```
def fibonacci(a=0, b=1):
    while True:
        yield a
        a, b = b, a + b

sum_ = 0
for f in fibonacci():
    if f > 4000000:
       break
    if f % 2 == 0:
       sum_ += f

print sum_ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-19T00:37:09.807

这是另一种直接方法它依赖于一些属性：

1.  每个斐波那契数可以直接计算为 floor( pow( phi, n ) + 0.5 )（参见[http://en.wikipedia.org/wiki/Fibonacci_number](http://en.wikipedia.org/wiki/Fibonacci_number)中的四舍五入计算）。相反，小于 i 的最大斐波那契数的索引由 floor( log(i*sqrt(5)) / log(phi) ) 给出
2.  前 N 个斐波那契数的总和是第 N+2 个斐波那契数减 1（参见同一维基百科页面上的第二个身份）
3.  偶数斐波那契数是每三个数。（看序列mod 2，结果很简单）
4.  偶数斐波那契数之和是奇数斐波那契数之和的一半，直到序列中的同一点。

由此可见第4点：

```
Sum of first 3N fibonacci numbers
   =(F(1) + F(2))+ F(3) +(F(4) + F(5))+ F(6) + ... +(F(3N-2) + F(3N-1))+ F(3N) 
   =     F(3)    + F(3) +     F(6)    + F(6) + ... +       F(3N)       + F(3N)
   = 2( F(3) + F(6) + ... + F(3N) )
   = 2 ( Sum of odd fibonacci numbers up to F(3N) ) 
```

所以转换我们的最大值 4000000 计算出低于它的最高斐波那契数的指数。

```
int n = floor(log(4000000*sqrt(5))/log(phi));  // ( = 33) 
```

33 可以被 3 整除，所以它是一个偶数斐波那契数，如果不是，我们需要像这样调整 n。

```
n = (n/3)*3; 
```

到此为止的所有斐波那契数的总和，如果由下式给出

```
sum = floor( pow( phi, n+2 ) + 0.5 ) - 1; // ( = 9227464 ) 
```

所有偶数的总和是这个的一半：

```
sum_even = sum/2; // ( = 4613732 ) 
```

这样做的好处是它是一个 O(1)（或 O(log(N))，如果你包括 pow/log 的成本）算法，并且适用于双精度数。所以我们可以计算非常大的值的总和。

注意：我从这个问题的封闭副本中编辑并移动了这个答案。[斐波那契低于 400 万](https://stackoverflow.com/questions/3270863)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-25T21:00:26.753

至少在 Python 3 中，如果你给`sum`函数一个生成器，它会懒惰地评估它，所以不需要重新发明轮子。

这就是@Constantin 所做的并且是正确的。

通过比较使用生成器的内存使用情况进行测试：

`sum(range(9999999))`

与不这样做相比：

`sum(list(range(9999999)))`

带有生成器的那个也不会导致更高数字的内存异常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-01T03:10:48.583

```
print ("Fibonacci Series\n")

a  = input ("Enter a nth Term: ")

b = 0 

x = 0

y = 1

print x,("\n"), y

while b <=a-2:

  b = b+1

  z = x + y

  print z

  x = y

  y = z 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-28T13:49:48.663

```
def main():
    a = 1
    b = 2
    num = 2

    while b < 4000000:
        a, b = b, a+b
        num += b if b % 2 == 0 else 0

    print num

if __name__ == '__main__':
    main() 
```

# url - 多重排序的 URL 查询字符串约定

> ID：578380
> 
> 赞同：22
> 
> 时间：2009-02-23T16:53:44.807
> 
> 标签：url, format, query-string

我有一个支持项目集合上的多个排序字段的 RESTful Web 应用程序。将这些排序字段编码到 URL 的查询字符串中是否有通用约定？我正在考虑如下模式：

```
http://myapp.com/books?sort=author:asc,datepublished:desc&count=12 
```

这将按作者然后按出版日期对书籍集进行排序。

基本上，我需要一种方便的方法让我的查询字符串中的名称-值对拥有自己的名称-值对。我也需要对过滤器参数执行与上述示例类似的操作。

Rails 或 ASP.NET MVC 是否有这种模式？是否有其他框架已经建立了处理这个问题的方法？我宁愿使用熟悉的格式，也不愿自己动手。

我也更喜欢使用尽可能少的 URL 百分比编码的格式。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-15T14:59:09.540

在使用标准 SQL 排序语法之前，我已经这样做了。有许多解析函数和技术。

```
http://myapp.com/books?sort=author asc,datepublished desc&count=12 
```

这将被编码为

```
http://myapp.com/books?sort=author+asc,datepublished+desc&count=12 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-26T17:03:59.200

对于 REST，我更喜欢更直观的语法：

`http://myapp.com/books?sort=+author,-datepublished&count=12`

更详细（没有“+”号）：

`http://myapp.com/books?sort=author,-datepublished&count=12`

容易记住...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T10:55:36.567

像这样一个完全兼容 PHP 的版本怎么样：

```
http://myapp.com/books?sort[0][name]=author&sort[0][dir]=asc&sort[1][name]=datepublished&sort[1][dir]=desc&count=12 
```

有点长，但更方便，正如我所说，与 PHP 兼容。ASP.NET 也可能已经实现了对这种格式的支持。

这将直接创建一个数组*sort*，其中 sort 的每个元素都有一个*name*和*dir*属性。

# sql - 从存储过程结果初始化变量

> ID：578381
> 
> 赞同：0
> 
> 时间：2009-02-23T16:53:49.783
> 
> 标签：sql, variables, initialization

我在 SQL 方面还很陌生，我有一个问题。

我正在使用基于纬度/经度查找帐户的报告服务创建查找。我的问题是如何从存储过程中获取结果以初始化以下 sp 中的变量？

例子：--
这个sp会出去根据邮编获取minlat、maxlat、minlong、maxlong。

```
EXEC SERVER.DATABASE.dbo.GetLatLongApprox @Zip 
```

--然后我声明我将在报告服务中使用的变量

```
DECLARE @MaxLat AS float
DECLARE @MinLat AS float
DECLARE @MaxLong AS float
DECLARE @MinLong AS float 
```

--现在我想根据第一个存储过程的结果动态设置值。

```
SET @MaxLat = ?
SET @MinLat = ?
SET @MaxLong = ?
SET @MinLong = ? 
```

这将全部驻留在我将在报告服务中使用的一个存储过程中。希望这是有道理的。再说一次，我是绿色的，还没有完全让 sql 说话。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T16:59:31.967

在 Books On Line 中查找 OUTPUT 参数

这是一个例子

```
CREATE PROCEDURE TestProc
       @employeeID INT,
       @managerID INT OUTPUT
    AS
    BEGIN
       SELECT @managerID =2

    END
    Go

    declare @employeeID int, @managerID int
    select @employeeID = 1

    exec TestProc @employeeID,@managerID output

    select  @employeeID,@managerID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T16:58:01.393

我认为您可以在其中使用 OUTPUT 参数。

EXEC SERVER.DATABASE.dbo.GetLatLongApprox @Zip，@MaxLong 输出，...，@MinLong 输出

选择 @MaxLong 作为 N'@MaxLong' ... 选择 @MinLong 作为 N'@MinLong'

那是你要找的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T17:01:05.553

要完成这项工作，您必须使用输出参数。像这样：

```
CREATE PROCEDURE XPTO_Procedure

@intInput int,
@intOutput int OUTPUT

AS
set @intOutput = @intInput + 1 

go

Call it like this:

declare @intResult int
exec _4P_test 3 ,@intResult OUT
select @intResult 
```

这很好很容易：D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T17:05:52.997

在您的存储过程中

```
EXEC dbo.GetLatLongApprox @Zip 
```

您只需要根据返回的结果集设置变量，即

```
SELECT
@MinLat = min_lat,
@MaxLat = max_lat,
@MinLong = min_long,
@MaxLong = max_long
FROM
my_resultset

EXEC dbo.MyReportingServiceStoredProcedure @MinLat, @MaxLat, @MinLong, @MaxLong 
```

然后将这些作为参数传递到报告服务存储过程中，如果我正确理解您并且您在一个存储过程中执行所有这些操作。

# c# - 子父表：我应该把方法放在 2 类中？

> ID：578392
> 
> 赞同：2
> 
> 时间：2009-02-23T16:56:33.987
> 
> 标签：c#, sql, oop

我有两个具有父子关系的表，但仍然混淆如何将其从表映射到类中。封装方法而不使用业务对象/值对象的简单类。表格是类别和产品。

当网络表单列出某个类别的产品时，我应该采取什么方法？

创建**Category 对象**并调用**GetProductsByGroup(int groupId)**

或者

创建**Product 对象**并调用**GetProductsByGroup(int groupId)**

哪个类应该拥有该方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T17:07:59.920

他们都没有。

**为什么？**

*类别：*一个类别本身就有意义，它不应该知道任何产品的存在。

*产品：*一个产品有一个类别，但对同一类别中的其他产品一无所知。

**那么在哪里？**

在提供根据规范检索产品（可以称为产品存储库）的方法的服务中。

例子：

```
public static class ProductRepository
{
    public static Collection<Product> GetProductsByGroup(int groupID)
    {
         ...
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T17:00:02.483

该方法的主要关系是什么 - 产品。因此，我将它放在 Products 类中，因为它将处理与产品相关的所有内容。同样，Category 类可能有多种处理、查询和修改类别的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T17:01:47.110

这几乎取决于您，但我会做出以下区分：

如果该方法在 Product 类上，请将其设为静态方法。

如果该方法在 Category 类上，请不要将其设为静态。

如果它是您要经常访问的东西，您可以考虑将其设置为您的 Category 对象上的属性，以便延迟加载该类别的 Products。即，当您第一次访问该属性时，它会从数据库中检索 Products 并将它们存储在您的 Category 对象中；随后的调用只需返回该列表，而无需再次访问数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T17:02:14.257

简短的回答：两者都不是。您需要一个集合类。

通常，一个类将代表表中的**一行**，而一个集合将代表该表或其子集。

如果您不想使用业务或数据层对象（顺便说一句，这将是合适的），那么任何一个类都可以在实践中拥有该方法，但作为*静态方法*。不过，生产类拥有它可能更有意义，因为它应该返回一个*产品集合*

# regex - 什么是最终的邮政编码和 zip 正则表达式？

> ID：578406
> 
> 赞同：229
> 
> 时间：2009-02-23T16:58:17.963
> 
> 标签：regex, zipcode, postal-code

我正在寻找最终的邮政编码和邮政编码正则表达式。我正在寻找可以覆盖世界大部分（希望是所有）的东西。

* * *

## 回答 #1

> 赞同：312
> 
> 时间：2011-08-25T04:43:41.840

unicode CLDR 包含每个国家/地区的邮政编码正则表达式。（总共 158 个正则表达式！）

*   `core.zip`从[http://unicode.org/Public/cldr/26.0.1/](http://unicode.org/Public/cldr/26.0.1/)下载
*   解压core.zip
*   从解压出来的内容看一下`common/supplemental/postalCodeData.xml`（直接内容：[common/supplemental/postalCodeData.xml](https://github.com/unicode-org/cldr/blob/release-26-0-1/common/supplemental/postalCodeData.xml)）

谷歌还有一个网络服务，其中包含每个国家/地区的地址格式信息，包括邮政编码，在这里 - [http://i18napis.appspot.com/address](http://i18napis.appspot.com/address) （我通过[http://unicode.org/review/pri180/](http://unicode.org/review/pri180/)找到了该链接）

**编辑**

[这是postalCodeData.xml](https://github.com/unicode-org/cldr/blob/release-26-0-1/common/supplemental/postalCodeData.xml)正则表达式的副本：

```
"GB", "GIR[ ]?0AA|((AB|AL|B|BA|BB|BD|BH|BL|BN|BR|BS|BT|CA|CB|CF|CH|CM|CO|CR|CT|CV|CW|DA|DD|DE|DG|DH|DL|DN|DT|DY|E|EC|EH|EN|EX|FK|FY|G|GL|GY|GU|HA|HD|HG|HP|HR|HS|HU|HX|IG|IM|IP|IV|JE|KA|KT|KW|KY|L|LA|LD|LE|LL|LN|LS|LU|M|ME|MK|ML|N|NE|NG|NN|NP|NR|NW|OL|OX|PA|PE|PH|PL|PO|PR|RG|RH|RM|S|SA|SE|SG|SK|SL|SM|SN|SO|SP|SR|SS|ST|SW|SY|TA|TD|TF|TN|TQ|TR|TS|TW|UB|W|WA|WC|WD|WF|WN|WR|WS|WV|YO|ZE)(\d[\dA-Z]?[ ]?\d[ABD-HJLN-UW-Z]{2}))|BFPO[ ]?\d{1,4}"
"JE", "JE\d[\dA-Z]?[ ]?\d[ABD-HJLN-UW-Z]{2}"
"GG", "GY\d[\dA-Z]?[ ]?\d[ABD-HJLN-UW-Z]{2}"
"IM", "IM\d[\dA-Z]?[ ]?\d[ABD-HJLN-UW-Z]{2}"
"US", "\d{5}([ \-]\d{4})?"
"CA", "[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJ-NPRSTV-Z][ ]?\d[ABCEGHJ-NPRSTV-Z]\d"
"DE", "\d{5}"
"JP", "\d{3}-\d{4}"
"FR", "\d{2}[ ]?\d{3}"
"AU", "\d{4}"
"IT", "\d{5}"
"CH", "\d{4}"
"AT", "\d{4}"
"ES", "\d{5}"
"NL", "\d{4}[ ]?[A-Z]{2}"
"BE", "\d{4}"
"DK", "\d{4}"
"SE", "\d{3}[ ]?\d{2}"
"NO", "\d{4}"
"BR", "\d{5}[\-]?\d{3}"
"PT", "\d{4}([\-]\d{3})?"
"FI", "\d{5}"
"AX", "22\d{3}"
"KR", "\d{3}[\-]\d{3}"
"CN", "\d{6}"
"TW", "\d{3}(\d{2})?"
"SG", "\d{6}"
"DZ", "\d{5}"
"AD", "AD\d{3}"
"AR", "([A-HJ-NP-Z])?\d{4}([A-Z]{3})?"
"AM", "(37)?\d{4}"
"AZ", "\d{4}"
"BH", "((1[0-2]|[2-9])\d{2})?"
"BD", "\d{4}"
"BB", "(BB\d{5})?"
"BY", "\d{6}"
"BM", "[A-Z]{2}[ ]?[A-Z0-9]{2}"
"BA", "\d{5}"
"IO", "BBND 1ZZ"
"BN", "[A-Z]{2}[ ]?\d{4}"
"BG", "\d{4}"
"KH", "\d{5}"
"CV", "\d{4}"
"CL", "\d{7}"
"CR", "\d{4,5}|\d{3}-\d{4}"
"HR", "\d{5}"
"CY", "\d{4}"
"CZ", "\d{3}[ ]?\d{2}"
"DO", "\d{5}"
"EC", "([A-Z]\d{4}[A-Z]|(?:[A-Z]{2})?\d{6})?"
"EG", "\d{5}"
"EE", "\d{5}"
"FO", "\d{3}"
"GE", "\d{4}"
"GR", "\d{3}[ ]?\d{2}"
"GL", "39\d{2}"
"GT", "\d{5}"
"HT", "\d{4}"
"HN", "(?:\d{5})?"
"HU", "\d{4}"
"IS", "\d{3}"
"IN", "\d{6}"
"ID", "\d{5}"
"IL", "\d{5}"
"JO", "\d{5}"
"KZ", "\d{6}"
"KE", "\d{5}"
"KW", "\d{5}"
"LA", "\d{5}"
"LV", "\d{4}"
"LB", "(\d{4}([ ]?\d{4})?)?"
"LI", "(948[5-9])|(949[0-7])"
"LT", "\d{5}"
"LU", "\d{4}"
"MK", "\d{4}"
"MY", "\d{5}"
"MV", "\d{5}"
"MT", "[A-Z]{3}[ ]?\d{2,4}"
"MU", "(\d{3}[A-Z]{2}\d{3})?"
"MX", "\d{5}"
"MD", "\d{4}"
"MC", "980\d{2}"
"MA", "\d{5}"
"NP", "\d{5}"
"NZ", "\d{4}"
"NI", "((\d{4}-)?\d{3}-\d{3}(-\d{1})?)?"
"NG", "(\d{6})?"
"OM", "(PC )?\d{3}"
"PK", "\d{5}"
"PY", "\d{4}"
"PH", "\d{4}"
"PL", "\d{2}-\d{3}"
"PR", "00[679]\d{2}([ \-]\d{4})?"
"RO", "\d{6}"
"RU", "\d{6}"
"SM", "4789\d"
"SA", "\d{5}"
"SN", "\d{5}"
"SK", "\d{3}[ ]?\d{2}"
"SI", "\d{4}"
"ZA", "\d{4}"
"LK", "\d{5}"
"TJ", "\d{6}"
"TH", "\d{5}"
"TN", "\d{4}"
"TR", "\d{5}"
"TM", "\d{6}"
"UA", "\d{5}"
"UY", "\d{5}"
"UZ", "\d{6}"
"VA", "00120"
"VE", "\d{4}"
"ZM", "\d{5}"
"AS", "96799"
"CC", "6799"
"CK", "\d{4}"
"RS", "\d{6}"
"ME", "8\d{4}"
"CS", "\d{5}"
"YU", "\d{5}"
"CX", "6798"
"ET", "\d{4}"
"FK", "FIQQ 1ZZ"
"NF", "2899"
"FM", "(9694[1-4])([ \-]\d{4})?"
"GF", "9[78]3\d{2}"
"GN", "\d{3}"
"GP", "9[78][01]\d{2}"
"GS", "SIQQ 1ZZ"
"GU", "969[123]\d([ \-]\d{4})?"
"GW", "\d{4}"
"HM", "\d{4}"
"IQ", "\d{5}"
"KG", "\d{6}"
"LR", "\d{4}"
"LS", "\d{3}"
"MG", "\d{3}"
"MH", "969[67]\d([ \-]\d{4})?"
"MN", "\d{6}"
"MP", "9695[012]([ \-]\d{4})?"
"MQ", "9[78]2\d{2}"
"NC", "988\d{2}"
"NE", "\d{4}"
"VI", "008(([0-4]\d)|(5[01]))([ \-]\d{4})?"
"PF", "987\d{2}"
"PG", "\d{3}"
"PM", "9[78]5\d{2}"
"PN", "PCRN 1ZZ"
"PW", "96940"
"RE", "9[78]4\d{2}"
"SH", "(ASCN|STHL) 1ZZ"
"SJ", "\d{4}"
"SO", "\d{5}"
"SZ", "[HLMS]\d{3}"
"TC", "TKCA 1ZZ"
"WF", "986\d{2}"
"XK", "\d{5}"
"YT", "976\d{2}" 
```

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-02-23T17:10:33.300

空无一人。

世界各地的邮政编码不遵循共同的模式。在某些国家/地区，它们由数字组成，在其他国家/地区，它们可以是数字和字母的组合，有些可以包含空格，有些可以包含点，字符的数量可以从两个到至少六个不等......

你可以做的（理论上）是为世界上每个国家创建一个单独的正则表达式，不推荐 IMO。但是您仍然会缺少验证部分：邮政编码`12345`可能存在，但`12346`不存在，也可能`12344`不存在。你如何用正则表达式检查？

你不能。

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2012-05-10T07:15:18.397

使用这些正则表达式

```
$ZIPREG=array(
    "US"=>"^\d{5}([\-]?\d{4})?$",
    "UK"=>"^(GIR|[A-Z]\d[A-Z\d]??|[A-Z]{2}\d[A-Z\d]??)[ ]??(\d[A-Z]{2})$",
    "DE"=>"\b((?:0[1-46-9]\d{3})|(?:[1-357-9]\d{4})|(?:[4][0-24-9]\d{3})|(?:[6][013-9]\d{3}))\b",
    "CA"=>"^([ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ])\ {0,1}(\d[ABCEGHJKLMNPRSTVWXYZ]\d)$",
    "FR"=>"^(F-)?((2[A|B])|[0-9]{2})[0-9]{3}$",
    "IT"=>"^(V-|I-)?[0-9]{5}$",
    "AU"=>"^(0[289][0-9]{2})|([1345689][0-9]{3})|(2[0-8][0-9]{2})|(290[0-9])|(291[0-4])|(7[0-4][0-9]{2})|(7[8-9][0-9]{2})$",
    "NL"=>"^[1-9][0-9]{3}\s?([a-zA-Z]{2})?$",
    "ES"=>"^([1-9]{2}|[0-9][1-9]|[1-9][0-9])[0-9]{3}$",
    "DK"=>"^([D|d][K|k]( |-))?[1-9]{1}[0-9]{3}$",
    "SE"=>"^(s-|S-){0,1}[0-9]{3}\s?[0-9]{2}$",
    "BE"=>"^[1-9]{1}[0-9]{3}$",
    "IN"=>"^\d{6}$"
); 
```

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2013-11-07T19:00:16.463

1.  每个邮政编码系统仅使用 AZ 和/或 0-9，有时使用空格/破折号

2.  并非每个国家/地区都使用邮政编码（例如都柏林以外的爱尔兰），但我们将在这里忽略它。

3.  最短的邮政编码格式是塞拉利昂`NN`

4.  最长的是美属萨摩亚`NNNNN-NNNNNN`

5.  您应该允许一个空格或破折号。

6.  不应以空格或破折号开头或结尾

这应该涵盖以上内容：

```
(?i)^[a-z0-9][a-z0-9\- ]{0,10}[a-z0-9]$ 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-02-23T18:02:27.090

试图用一个正则表达式覆盖整个世界是不可能的，当然也不可行或不推荐。

不要自吹自擂，但我已经写了一些非常详尽的正则表达式，您可能会发现它们很有帮助。

*   [加拿大邮政编码](http://snipplr.com/view/7893/validate-canadian-postal-code/)

    ```
    Basic validation:
    ^[ABCEGHJ-NPRSTVXY]{1}[0-9]{1}[ABCEGHJ-NPRSTV-Z]{1}[ ]?[0-9]{1}[ABCEGHJ-NPRSTV-Z]{1}[0-9]{1}$

    Extended validation:
    ^(A(0[ABCEGHJ-NPR]|1[ABCEGHK-NSV-Y]|2[ABHNV]|5[A]|8[A])|B(0[CEHJ-NPRSTVW]|1[ABCEGHJ-NPRSTV-Y]|2[ABCEGHJNRSTV-Z]|3[ABEGHJ-NPRSTVZ]|4[ABCEGHNPRV]|5[A]|6[L]|9[A])|C(0[AB]|1[ABCEN])|E(1[ABCEGHJNVWX]|2[AEGHJ-NPRSV]|3[ABCELNVYZ]|4[ABCEGHJ-NPRSTV-Z]|5[ABCEGHJ-NPRSTV]|6[ABCEGHJKL]|7[ABCEGHJ-NP]|8[ABCEGJ-NPRST]|9[ABCEGH])|G(0[ACEGHJ-NPRSTV-Z]|1[ABCEGHJ-NPRSTV-Y]|2[ABCEGJ-N]|3[ABCEGHJ-NZ]|4[ARSTVWXZ]|5[ABCHJLMNRTVXYZ]|6[ABCEGHJKLPRSTVWXZ]|7[ABGHJKNPSTXYZ]|8[ABCEGHJ-NPTVWYZ]|9[ABCHNPRTX])|H(0[HM]|1[ABCEGHJ-NPRSTV-Z]|2[ABCEGHJ-NPRSTV-Z]|3[ABCEGHJ-NPRSTV-Z]|4[ABCEGHJ-NPRSTV-Z]|5[AB]|7[ABCEGHJ-NPRSTV-Y]|8[NPRSTYZ]|9[ABCEGHJKPRSWX])|J(0[ABCEGHJ-NPRSTV-Z]|1[ACEGHJ-NRSTXZ]|2[ABCEGHJ-NRSTWXY]|3[ABEGHLMNPRTVXYZ]|4[BGHJ-NPRSTV-Z]|5[ABCJ-MRTV-Z]|6[AEJKNRSTVWYXZ]|7[ABCEGHJ-NPRTV-Z]|8[ABCEGHLMNPRTVXYZ]|9[ABEHJLNTVXYZ])|K(0[ABCEGHJ-M]|1[ABCEGHJ-NPRSTV-Z]|2[ABCEGHJ-MPRSTVW]|4[ABCKMPR]|6[AHJKTV]|7[ACGHK-NPRSV]|8[ABHNPRV]|9[AHJKLV])|L(0[[ABCEGHJ-NPRS]]|1[ABCEGHJ-NPRSTV-Z]|2[AEGHJMNPRSTVW]|3[BCKMPRSTVXYZ]|4[ABCEGHJ-NPRSTV-Z]|5[ABCEGHJ-NPRSTVW]|6[ABCEGHJ-MPRSTV-Z]|7[ABCEGJ-NPRST]|8[EGHJ-NPRSTVW]|9[ABCGHK-NPRSTVWYZ])|M(1[BCEGHJ-NPRSTVWX]|2[HJ-NPR]|3[ABCHJ-N]|4[ABCEGHJ-NPRSTV-Y]|5[ABCEGHJ-NPRSTVWX]|6[ABCEGHJ-NPRS]|7[AY]|8[V-Z]|9[ABCLMNPRVW])|N(0[ABCEGHJ-NPR]|1[ACEGHKLMPRST]|2[ABCEGHJ-NPRTVZ]|3[ABCEHLPRSTVWY]|4[BGKLNSTVWXZ]|5[ACHLPRV-Z]|6[ABCEGHJ-NP]|7[AGLMSTVWX]|8[AHMNPRSTV-Y]|9[ABCEGHJKVY])|P(0[ABCEGHJ-NPRSTV-Y]|1[ABCHLP]|2[ABN]|3[ABCEGLNPY]|4[NPR]|5[AEN]|6[ABC]|7[ABCEGJKL]|8[NT]|9[AN])|R(0[ABCEGHJ-M]|1[ABN]|2[CEGHJ-NPRV-Y]|3[ABCEGHJ-NPRSTV-Y]|4[AHJKL]|5[AGH]|6[MW]|7[ABCN]|8[AN]|9[A])|S(0[ACEGHJ-NP]|2[V]|3[N]|4[AHLNPRSTV-Z]|6[HJKVWX]|7[HJ-NPRSTVW]|9[AHVX])|T(0[ABCEGHJ-MPV]|1[ABCGHJ-MPRSV-Y]|2[ABCEGHJ-NPRSTV-Z]|3[ABCEGHJ-NPRZ]|4[ABCEGHJLNPRSTVX]|5[ABCEGHJ-NPRSTV-Z]|6[ABCEGHJ-NPRSTVWX]|7[AENPSVXYZ]|8[ABCEGHLNRSVWX]|9[ACEGHJKMNSVWX])|V(0[ABCEGHJ-NPRSTVWX]|1[ABCEGHJ-NPRSTV-Z]|2[ABCEGHJ-NPRSTV-Z]|3[ABCEGHJ-NRSTV-Y]|4[ABCEGK-NPRSTVWXZ]|5[ABCEGHJ-NPRSTV-Z]|6[ABCEGHJ-NPRSTV-Z]|7[ABCEGHJ-NPRSTV-Y]|8[ABCGJ-NPRSTV-Z]|9[ABCEGHJ-NPRSTV-Z])|X(0[ABCGX]|1[A])|Y(0[AB]|1[A]))[ ]?[0-9]{1}[ABCEGHJ-NPRSTV-Z]{1}[0-9]{1}$ 
    ```

*   [美国邮政编码](http://snipplr.com/view/7787/validate-us-zip-code/)

    ```
    ^[0-9]{5}(-[0-9]{4})?$ 
    ```

*   [英国邮政编码](http://snipplr.com/view/7990/validate-uk-postcode/)

    ```
    ^([A-PR-UWYZ]([0-9]{1,2}|([A-HK-Y][0-9]|[A-HK-Y][0-9]([0-9]|[ABEHMNPRV-Y]))|[0-9][A-HJKS-UW])\ [0-9][ABD-HJLNP-UW-Z]{2}|(GIR\ 0AA)|(SAN\ TA1)|(BFPO\ (C\/O\ )?[0-9]{1,4})|((ASCN|BBND|[BFS]IQQ|PCRN|STHL|TDCU|TKCA)\ 1ZZ))$ 
    ```

如果不将某些东西实际邮寄到某个地址并让该人在收到邮件时通知您，就不可能保证准确性，但我们可以通过消除我们知道的不良案例来缩小范围。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-23T17:40:38.203

我们使用以下内容：

**加拿大**

```
([A-Z]{1}[0-9]{1}){3}   //We raise to upper first 
```

**美国**

```
[0-9]{5}                //-or-
[0-9]{5}-[0-9]{4}       //10 digit zip 
```

**其他**

> 按原样接受

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-23T17:12:28.270

根据您的应用程序，您可能希望为大多数访问者来源的国家/地区实施正则表达式匹配，而对其余国家/地区不进行验证（接受任何内容）。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-07-25T16:45:11.260

请注意，正如接受的答案所述，这是一个相当困难的问题。我想这并没有阻止[geonames.org](http://www.geonames.org/)上的人们。他们有一个[国家信息文件文件](http://download.geonames.org/export/dump/countryInfo.txt)，它不完全适合这个答案 - 限制显然是 30000 个字符。有大约 150 个国家/地区的正则表达式。

我在这里提取了与这个问题相关的位：

```
AD ^(?:AD)*(\d{3})$
AM ^(\d{6})$
AR ^([A-Z]\d{4}[A-Z]{3})$
AT ^(\d{4})$
AU ^(\d{4})$
AX ^(?:FI)*(\d{5})$
AZ ^(?:AZ)*(\d{4})$
BA ^(\d{5})$
BB ^(?:BB)*(\d{5})$
BD ^(\d{4})$
BE ^(\d{4})$
BG ^(\d{4})$
BH ^(\d{3}\d?)$
BM ^([A-Z]{2}\d{2})$
BN ^([A-Z]{2}\d{4})$
BR ^(\d{8})$
BY ^(\d{6})$
CA ^([ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]) ?(\d[ABCEGHJKLMNPRSTVWXYZ]\d)$
CH ^(\d{4})$
CL ^(\d{7})$
CN ^(\d{6})$
CR ^(\d{4})$
CU ^(?:CP)*(\d{5})$
CV ^(\d{4})$
CX ^(\d{4})$
CY ^(\d{4})$
CZ ^(\d{5})$
DE ^(\d{5})$
DK ^(\d{4})$
DO ^(\d{5})$
DZ ^(\d{5})$
EC ^([a-zA-Z]\d{4}[a-zA-Z])$
EE ^(\d{5})$
EG ^(\d{5})$
ES ^(\d{5})$
ET ^(\d{4})$
FI ^(?:FI)*(\d{5})$
FM ^(\d{5})$
FO ^(?:FO)*(\d{3})$
FR ^(\d{5})$
GB ^(([A-Z]\d{2}[A-Z]{2})|([A-Z]\d{3}[A-Z]{2})|([A-Z]{2}\d{2}[A-Z]{2})|([A-Z]{2}\d{3}[A-Z]{2})|([A-Z]\d[A-Z]\d[A-Z]{2})|([A-Z]{2}\d[A-Z]\d[A-Z]{2})|(GIR0AA))$
GE ^(\d{4})$
GF ^((97|98)3\d{2})$
GG ^(([A-Z]\d{2}[A-Z]{2})|([A-Z]\d{3}[A-Z]{2})|([A-Z]{2}\d{2}[A-Z]{2})|([A-Z]{2}\d{3}[A-Z]{2})|([A-Z]\d[A-Z]\d[A-Z]{2})|([A-Z]{2}\d[A-Z]\d[A-Z]{2})|(GIR0AA))$
GL ^(\d{4})$
GP ^((97|98)\d{3})$
GR ^(\d{5})$
GT ^(\d{5})$
GU ^(969\d{2})$
GW ^(\d{4})$
HN ^([A-Z]{2}\d{4})$
HR ^(?:HR)*(\d{5})$
HT ^(?:HT)*(\d{4})$
HU ^(\d{4})$
ID ^(\d{5})$
IL ^(\d{5})$
IM ^(([A-Z]\d{2}[A-Z]{2})|([A-Z]\d{3}[A-Z]{2})|([A-Z]{2}\d{2}[A-Z]{2})|([A-Z]{2}\d{3}[A-Z]{2})|([A-Z]\d[A-Z]\d[A-Z]{2})|([A-Z]{2}\d[A-Z]\d[A-Z]{2})|(GIR0AA))$
IN ^(\d{6})$
IQ ^(\d{5})$
IR ^(\d{10})$
IS ^(\d{3})$
IT ^(\d{5})$
JE ^(([A-Z]\d{2}[A-Z]{2})|([A-Z]\d{3}[A-Z]{2})|([A-Z]{2}\d{2}[A-Z]{2})|([A-Z]{2}\d{3}[A-Z]{2})|([A-Z]\d[A-Z]\d[A-Z]{2})|([A-Z]{2}\d[A-Z]\d[A-Z]{2})|(GIR0AA))$
JO ^(\d{5})$
JP ^(\d{7})$
KE ^(\d{5})$
KG ^(\d{6})$
KH ^(\d{5})$
KP ^(\d{6})$
KR ^(?:SEOUL)*(\d{6})$
KW ^(\d{5})$
KZ ^(\d{6})$
LA ^(\d{5})$
LB ^(\d{4}(\d{4})?)$
LI ^(\d{4})$
LK ^(\d{5})$
LR ^(\d{4})$
LS ^(\d{3})$
LT ^(?:LT)*(\d{5})$
LU ^(\d{4})$
LV ^(?:LV)*(\d{4})$
MA ^(\d{5})$
MC ^(\d{5})$
MD ^(?:MD)*(\d{4})$
ME ^(\d{5})$
MG ^(\d{3})$
MK ^(\d{4})$
MM ^(\d{5})$
MN ^(\d{6})$
MQ ^(\d{5})$
MT ^([A-Z]{3}\d{2}\d?)$
MV ^(\d{5})$
MX ^(\d{5})$
MY ^(\d{5})$
MZ ^(\d{4})$
NC ^(\d{5})$
NE ^(\d{4})$
NF ^(\d{4})$
NG ^(\d{6})$
NI ^(\d{7})$
NL ^(\d{4}[A-Z]{2})$
NO ^(\d{4})$
NP ^(\d{5})$
NZ ^(\d{4})$
OM ^(\d{3})$
PF ^((97|98)7\d{2})$
PG ^(\d{3})$
PH ^(\d{4})$
PK ^(\d{5})$
PL ^(\d{5})$
PM ^(97500)$
PR ^(\d{9})$
PT ^(\d{7})$
PW ^(96940)$
PY ^(\d{4})$
RE ^((97|98)(4|7|8)\d{2})$
RO ^(\d{6})$
RS ^(\d{6})$
RU ^(\d{6})$
SA ^(\d{5})$
SD ^(\d{5})$
SE ^(?:SE)*(\d{5})$
SG ^(\d{6})$
SH ^(STHL1ZZ)$
SI ^(?:SI)*(\d{4})$
SK ^(\d{5})$
SM ^(4789\d)$
SN ^(\d{5})$
SO ^([A-Z]{2}\d{5})$
SV ^(?:CP)*(\d{4})$
SZ ^([A-Z]\d{3})$
TC ^(TKCA 1ZZ)$
TH ^(\d{5})$
TJ ^(\d{6})$
TM ^(\d{6})$
TN ^(\d{4})$
TR ^(\d{5})$
TW ^(\d{5})$
UA ^(\d{5})$
US ^\d{5}(-\d{4})?$
UY ^(\d{5})$
UZ ^(\d{6})$
VA ^(\d{5})$
VE ^(\d{4})$
VI ^\d{5}(-\d{4})?$
VN ^(\d{6})$
WF ^(986\d{2})$
YT ^(\d{5})$
ZA ^(\d{4})$
ZM ^(\d{5})$
CS ^(\d{5})$ 
```

希望我没有犯任何错误，我的 regex-fu 很弱。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-05-11T22:47:57.353

```
.* 
```

Big Jump 忘记了换行符、空格和控制字符。

国际邮政编码是一种停滞不前的问题。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-10-23T14:36:09.667

如果有人仍然对如何验证邮政编码感兴趣，我找到了一个解决方案：

使用`Google Geocoding API`我们可以检查具有**国家代码**和**邮政编码**本身的邮政编码的有效性。

例如，我住在乌克兰，所以我可以这样检查： [https ://maps.googleapis.com/maps/api/geocode/json?components=postal_code:80380|country:UA](https://maps.googleapis.com/maps/api/geocode/json?components=postal_code:80380%7Ccountry:UA)

或使用 JS API：[https ://developers.google.com/maps/documentation/javascript/geocoding#ComponentFiltering](https://developers.google.com/maps/documentation/javascript/geocoding#ComponentFiltering)

乌克兰的有效 ZIP在哪里`80380`，实际上每个 (#####) 都是有效的。

`ZERO_RESULTS`如果没有找到，Google 会返回状态。或者`OK`，如果两者都正确，则为结果。

希望这会有所帮助。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-03-07T23:04:11.357

正如其他人所指出的，一个正则表达式来统治它们是不可能的。但是，您可以使用[万国邮政联盟](http://www.upu.int/en/activities/addressing/postal-addressing-systems-in-member-countries.html)（一个鲜为人知的联合国机构）提供的地址格式信息为尽可能多的国家/地区制作正则表达式。

例如，以下是一些国家/地区的地址格式规则，包括邮政编码（PDF 格式）：

*   [加拿大](http://www.upu.int/fileadmin/documentsFiles/activities/addressingUnit/canEn.pdf)
*   [日本](http://www.upu.int/fileadmin/documentsFiles/activities/addressingUnit/jpnEn.pdf)
*   [瑞士](http://www.upu.int/fileadmin/documentsFiles/activities/addressingUnit/cheEn.pdf)
*   [俄罗斯联邦](http://www.upu.int/fileadmin/documentsFiles/activities/addressingUnit/rusEn.pdf)
*   [美国](http://www.upu.int/fileadmin/documentsFiles/activities/addressingUnit/usaEn.pdf)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-23T17:06:55.820

鉴于每个国家/地区都有如此多的边缘案例（例如，伦敦地址可能使用与英国其他地区略有不同的格式），我认为除了可能之外没有最终的正则表达式：

```
[0-9a-zA-Z]+ 
```

最好采用相当广泛的模式（不如上述广泛），或者用自己的特定模式对待每个国家/地区！

**更新：** 但是，可以根据许多较小的区域特定规则动态构建正则表达式 - 但不确定性能！

[在RegExLib](http://regexlib.com)站点上可以找到许多特定于国家/地区的模式。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-23T19:08:44.327

问题将是您可能没有很好的方法来跟上地球另一端国家不断变化的邮政编码要求，并且您没有共同的语言。除非您有足够大的预算来跟踪这一点，否则您几乎肯定最好将验证地址的责任交给 google 或 yahoo。

两家公司都通过可编程 API 提供地址查找功能。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-23T17:18:04.280

你为什么要这样做，你为什么在乎？正如汤姆·里特（Tom Ritter）指出的那样，您是否有邮政编码都无关紧要，更不用说它是否有效，除非您实际上要向该地址发送某些东西。即使您希望*有一天您会向他们发送一些东西，这并不意味着您**今天*需要一个邮政编码。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-23T17:20:46.097

正如其他地方所指出的那样，世界各地的变化是巨大的。即使与模式匹配的东西并不意味着它存在。

然后，当然，有很多地方没有使用邮政编码（例如 much 或 Ireland）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-11T20:35:44.857

拥有准确的邮政编码还有其他原因。进行跨境旅行的旅行社（当然，欧元区除外）需要提前将这些信息提供给当局。通常，此信息由可能熟悉或不熟悉此类事物的代理输入。任何可以减少错误的方法都是好主意™

但是，编写一个涵盖世界上所有邮政编码的正则表达式将是疯狂的。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-05-11T22:13:48.073

有人在询问格式化邮寄地址列表，我认为这就是他正在寻找的......

Frank 的邮政地址强制指南：http: [//www.columbia.edu/~fdc/postal/](http://www.columbia.edu/~fdc/postal/) 然而，对于街道层面的问题并没有多大帮助。

我的工作使用了几个工具来帮助解决这个问题： - Lexis-Nexis 服务，包括 NCOA 查找（您将“免费”获得地址标准化） - “Melissa Data” [http://www.melissadata.com](http://www.melissadata.com)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-11-13T15:38:10.333

这是一个非常简单的正则表达式，用于验证美国邮政编码（不是邮政编码加四）：

```
(?!([089])\1{4})\d{5} 
```

似乎所有五位数字都是有效的邮政编码，除了`00000`, `88888`& `99999`。

我已经用[http://regexpal.com/测试了这个 RegEx](http://regexpal.com/)

SP

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-06-07T09:05:18.017

如果`Zip Code`允许字符和数字（字母数字），则将在匹配的地方使用下面的正则表达式，5 或 9 或 10 个字母数字字符和一个连字符 ( `-`)：

```
^([0-9A-Za-z]{5}|[0-9A-Za-z]{9}|(([0-9a-zA-Z]{5}-){1}[0-9a-zA-Z]{4}))$ 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-01-28T07:07:56.680

我知道这是一个老问题，但我偶然发现了同样的问题。我有来自 100 多个国家/地区的发票，并试图让正确的债权人通过邮编（如果所有其他检查都失败）。所以我所做的是编写一个简短的 Python 脚本，它从字符串创建一个模式：

```
class RegexPatternBuilder:
    """
    Builds a regex pattern out of a given string(i.e. --> HM452 AX2155 : [A-Z]{2}\d{3}\s{1}[A-Z]{2}\d{4})
    """
    __is_alpha_count = 0
    __is_numeric_count = 0
    __is_whitespace_count = 0
    __pattern = ""

    # Count: wich character of the string we're locking at right now
    __count = 0

    # Countrys like  Andora starts theire ZIP with the country abbreviation :AD500
    # So check at first if the ZIP starts with the abbreviation and if so, add it to the pattern and increase the count.
    def __init__(self, zip_string, country):
        self.__zip_string = zip_string
        self.__country = country
        if self.__zip_string.startswith(country):
            self.__pattern = f'({self.__country})'
            self.__count += len(self.__country)

    def build_regex(self):
        # Last step ;
        # Add the current alpha_numeric pattern with count
        if len(self.__zip_string) == self.__count:
            if self.__is_alpha_count:
                self.__pattern += f"[A-Z]{{{self.__is_alpha_count}}}"
            if self.__is_numeric_count:
                self.__pattern += f"\d{{{self.__is_numeric_count}}}"
            return f'{self.__pattern}\\b'

        # Case: Whitespace
        # Check if there is a crossing from numeric / alphanumeric to whitespace,
        # if so --> add the alpha_numeric regex to the whole pattern with the
        # count as the number of viable appeaerances.
        # Since there is max 1 whitespace in a ZIP, add the whitespace regex immediately.
        # Every other case is similar to that.
        if self.__zip_string[self.__count].isspace():
            if self.__is_numeric_count:
                self.__pattern += f"\d{{{self.__is_numeric_count}}}"
            if self.__is_alpha_count:
                self.__pattern += f"[A-Z]{{{self.__is_alpha_count}}}"
            self.__pattern += "\s{1}"
            self.__is_whitespace_count += 1
            self.__is_alpha_count = 0
            self.__is_numeric_count = 0

        # Case: Is Alphanumeric
        if self.__zip_string[self.__count].isalpha():
            if self.__is_numeric_count:
                self.__pattern += f"[0-9]{{{self.__is_numeric_count}}}"
            self.__is_whitespace_count = 0
            self.__is_alpha_count += 1
            self.__is_numeric_count = 0

        # Case: Is Numeric
        if self.__zip_string[self.__count].isnumeric():
            if self.__is_alpha_count:
                self.__pattern += f"[A-Z]{{{self.__is_alpha_count}}}"
            self.__is_whitespace_count = 0
            self.__is_alpha_count = 0
            self.__is_numeric_count += 1

        # Case: Special Character (i.e. - )
        # No escaping or count for this so far, because it shouldn't be needed for our zip purposes
        if not self.__zip_string[self.__count].isalpha() \
                and not self.__zip_string[self.__count].isnumeric() \
                and not self.__zip_string[self.__count].isspace():
            self.__pattern += f'{self.__zip_string[self.__count]}{{1}}'
        self.__count += 1
        return self.build_regex() 
```

有了这个，我为我们历史上所有的拉链（按国家）创建了所有不同的可能正则表达式，并将它们写回数据库表（即最后是这样的： `COUNTRY:RE PATTERN:(\d{5})\b`[这可能是哪个国家；D]）

也许它可以帮助某人。

# sql-server - 查询获取 MsSQL 表唯一索引和主键

> ID：578418
> 
> 赞同：1
> 
> 时间：2009-02-23T17:01:01.230
> 
> 标签：sql-server, indexing

```
SELECT sysobjects.xtype, syscolumns.name, sysindexkeys.indid, sysobjects.type
FROM
    syscolumns
LEFT JOIN sysobjects ON syscolumns.id = sysobjects.id
LEFT JOIN sysindexkeys ON (
     syscolumns.id = sysindexkeys.id AND syscolumns.colid = sysindexkeys.colid
)
WHERE sysobjects.name = '{$table}'
AND sysindexkeys.indid IS NOT NULL
ORDER BY sysindexkeys.indid, sysindexkeys.keyno 
```

我实际上正在使用以下查询来检索列名和 keyno。

问题是我的表有 3 个字段：

```
user_id
config_name
config_value 
```

在 user_id 和 config_name 上有一个主键。

我希望得到收藏：

```
[
  ['name' => 'user_id', 'keyno' => 1],
  ['name' => 'config_name', 'keyno' => 1]
] 
```

但我得到：

```
[
  ['name' => 'user_id', 'keyno' => 1],
  ['name' => 'config_name', 'keyno' => 2]
] 
```

我究竟做错了什么？

**编辑：** 我使用两个索引表得到相同的怪人结果

表：project_image_id project_id project_image_src

project_image_id 上的 PK 和 project_id 上的唯一索引和 project_image_src

预期的：

```
[
  ['name' => 'project_image_id', 'keyno' => 1],
  ['name' => 'project_id', 'keyno' => 2]
  ['name' => 'project_image_src', 'keyno' => 2]
] 
```

但我得到：

```
[
  ['name' => 'project_image_id', 'keyno' => 1],
  ['name' => 'project_id', 'keyno' => 1]
  ['name' => 'project_image_src', 'keyno' => 2]
] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T17:12:00.597

这对我来说似乎是正确的，您的索引有 2 列，user_id 的位置为 1，config_name 的位置为 2

来自 BOL keyno：索引中列的位置

为什么你认为他们都是1？

在这里，您需要重新连接到 sysobject 表，但在索引上而不是表本身

```
SELECT s2.xtype, syscolumns.name, sysindexkeys.indid, sysobjects.type
FROM
    syscolumns
LEFT JOIN sysobjects ON syscolumns.id = sysobjects.id
LEFT JOIN sysindexkeys ON (
     syscolumns.id = sysindexkeys.id AND syscolumns.colid = sysindexkeys.colid
)
join sysobjects s2 on s2.parent_obj = sysindexkeys.id
WHERE sysobjects.name = '{$table}'
and s2.type = 'K'
AND sysindexkeys.indid IS NOT NULL
ORDER BY sysindexkeys.indid, sysindexkeys.keyno 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-26T18:37:47.703

有几个不错的主键解决方案，但它们并不能完全满足要求。还询问如何确定列是否为唯一索引。

**选项1：**

为了确定唯一索引，以下系统函数用于告诉您表“TableName”中特定索引“IndexName”的状态：

```
SELECT INDEXPROPERTY(OBJECT_ID('TableName'),'IndexName','IsUnique') 
```

**选项 2：**

但是，上面的问题源于想知道 COLUMN 是否是唯一索引。这意味着您需要所有索引的列表，其中相关列是索引中的唯一列。因此，可以使用这样的组合：

```
-- Note: If a "1" appears in the select below, the index (and by extension, the column) is a unique index.

SELECT si.name, INDEXPROPERTY(x.TableID,si.name,'IsUnique') [IsUnique]
FROM sysindexes si
JOIN (SELECT OBJECT_ID('TableName') [TableID]) x  -- HERE IS YOUR TABLE NAME
  ON si.id = x.TableID
-- This restricts the selection to your column.
JOIN (
    SELECT id, indid 
    FROM sysindexkeys
    WHERE colid IN (
        -- For 2005 and up: SELECT COLUMNPROPERTY(OBJECT_ID('TableName'), 'ColumnName', 'ColumnId')
        SELECT colid
        FROM syscolumns
        WHERE name IN ('ColumnName')              -- HERE IS YOUR COLUMN NAME
    )
) y
  ON si.indid = y.indid
 AND x.TableID = y.id
WHERE si.status <> 0
  -- This eliminates occurrences of the column found in indexes with multiple columns.
  AND si.indid NOT IN (
    SELECT indid
    FROM sysindexkeys
    WHERE id = x.TableID
    GROUP BY indid
    HAVING COUNT(*) > 1
) 
```

**选项 3：**

使用 index_name、index_description、index_keys 创建一个表 (IndexTable)，并插入来自以下命令的结果：

```
sp_helpindex 'TableName' 
```

然后，从此结果中查询（或使用类似的查询）：

```
SELECT *
FROM IndexTable
WHERE index_description LIKE '%unique%'
  AND index_keys = 'ColumnName' 
```

希望这会有所帮助，或者如果您有更简洁的解决方案，请发布。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-25T06:18:47.103

试试这个查询：

```
SELECT A.TABLE_NAME, A.CONSTRAINT_NAME, B.COLUMN_NAME
    FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS A, 
         INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE B
    WHERE CONSTRAINT_TYPE = 'PRIMARY KEY' AND
          A.CONSTRAINT_NAME = B.CONSTRAINT_NAME AND
          A.TABLE_NAME='{$tableName}'
    ORDER BY A.TABLE_NAME 
```

替换`{$tableName}`为您的表名，您将获得特定表的所有主键，无论该表是具有单个主键还是多个主键。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-04T14:04:12.647

```
select sc.name 
  from sys.indexes si 
          join sys.tables st 
             on si.object_id = st.object_id
          join sys.index_columns sic 
             on sic.object_id = si.object_id and 
                sic.index_id = si.index_id
          join sys.columns sc 
             on sic.object_id = sc.object_id and 
                sic.column_id = sc.column_id
  where st.name = @table_name and 
        si.is_primary_key = 1
  order by sic.index_column_id 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T17:13:11.670

问题是您得到“索引中列的位置”。这样，它不存在具有相同位置的两列。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T17:02:30.677

```
SELECT sysobjects.name , syscolumns.name, systypes.name, syscolumns.length ,
       syscolumns.xprec , syscolumns.xscale ,

( 
SELECT 'PK'
  FROM syscolumns C
 WHERE C.name = syscolumns.name AND C.id IN (SELECT O.id
                  FROM sysobjects O
                 WHERE O.name = sysobjects.name)
   AND C.colid IN (SELECT SIK.colid 
                   FROM sysindexkeys SIK 
                   JOIN sysobjects SO ON SIK.id= SO.id  
                  WHERE SIK.indid = 1
                    AND SO.[name] = sysobjects.name)
)
FROM 
    sysobjects , syscolumns 
       , systypes  
    WHERE 
    sysobjects.xtype='U' 
    AND sysobjects.id = syscolumns.id AND syscolumns.xtype=systypes.xtype
    AND sysobjects.name LIKE ?
 ORDER BY sysobjects.name  , syscolumns.COLORDER 
```

# iphone - 刷新导航栏视图控制器

> ID：578422
> 
> 赞同：0
> 
> 时间：2009-02-23T17:01:33.867
> 
> 标签：iphone

在我的默认导航栏的根视图（各种聊天室）上，我有一个标题栏，带有一个 rightBarButton“撰写”，它会弹出一个`UITextView`键盘来输入新的聊天消息。点击“发送”后，消息将发送回服务器以将其存储在数据库中，效果很好。

当我关闭`UITextView`并重新加载根视图时，我会：

```
[newMessageEntry resignFirstResponder];
[self loadView]; 
```

这确实成功显示了聊天消息，但我不确定如何自动刷新它，以便它获取您刚刚提交的消息。我认为`self loadView`并没有真正用所有代码加载视图，因为在该视图的`viewDidLoad`方法中，我启动代码以从服务器加载消息并显示它们，但该代码没有运行。

我说得有道理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T18:04:29.097

从另一个论坛的帮助中，希望这可以帮助这里的一些人：

我需要使用

```
 [self.view setNeedsDisplay];
[self loadView]; 
```

setNeedsDisplay 将该视图设置为在加载时用数据刷新。

# java - 在不同区域的机器之间通过 RMI 发送日期

> ID：578430
> 
> 赞同：0
> 
> 时间：2009-02-23T17:03:41.367
> 
> 标签：java, rmi

我在通过 RMI 与不同时区的机器之间发送 java.util.Date 对象时遇到问题。

例如，德国的客户将向英国的服务器发送一个日期对象。

1.  用户输入日期字符串，例如 20090220。
2.  德国的客户端应用程序使用 SimpleDateFormat("yyyyMMdd") 将其转换为日期：Fri Feb 20 00:00:00 CET 2009
3.  英国服务器通过 RMI 接收日期为：Thu Feb 19 23:00:00 GMT 2009
4.  服务器将日期存储到英国 Oracle 数据库的日期列中

解决这个错误日期问题的最佳方法是什么？我可以发送日期字符串并让服务器将其转换为日期，但我想减少服务器必须做的工作量。

这是一个显示日期序列化的独立测试程序：

```
import java.io.BufferedInputStream;
import java.io.BufferedOutputStream;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;

public class SerializationTest {

    public static void main(String[] args) throws Exception {

        final String yyyyMMdd = "20090220";
        final Date date = new SimpleDateFormat("yyyyMMdd").parse(yyyyMMdd);

        if (args.length != 1) {
            System.out.println("Usage SerializationTest S|D");
        }

        boolean serialise = false;
        if (args[0].equals("S")) {
            serialise = true;
        }
        else if (args[0].equals("D")) {
            serialise = false;
        }

        String filename = "date.ser";
        if (serialise) {
            // write the object to file
            FileOutputStream fos = new FileOutputStream(filename);
            BufferedOutputStream bos = new BufferedOutputStream(fos);
            ObjectOutputStream outputStream = new ObjectOutputStream(bos);
            outputStream.writeObject(date);
            outputStream.flush();
            outputStream.close();

            System.out.println("Serialised: " + date);
        }
        else {
            FileInputStream fis = new FileInputStream(filename);
            BufferedInputStream bis = new BufferedInputStream(fis);
            ObjectInputStream inputStream = new ObjectInputStream(bis);
            Date outDate = (Date) inputStream.readObject();
            inputStream.close();

            // print the object
            System.out.println(outDate);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T17:11:48.070

我看不出你的问题是什么，这些日期对我来说看起来是正确的——它们只是被格式化为使用的语言环境。如果您希望用户输入的日期为 GMT 格式，请在 SimpleDateFormat 构造函数中指定区域设置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T17:15:35.160

查看 getTime() 和 setTime()。他们应该做你正在寻找的东西。与其通过网络将其作为特定于位置的字符串发送，不如在客户端上使用 getTime() 将其作为纪元以来的毫秒数发送，然后在客户端上构建一个新的 Date 并使用 setTime() 和服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T17:33:05.053

看看 java.util.Calendar 特别是 getTime() 方法。

这样，您将以毫秒为单位发送时间，而不是可以以不同方式解释的字符串。

# java - 访问 JAX-WS 调度响应的内容

> ID：578431
> 
> 赞同：2
> 
> 时间：2009-02-23T17:04:21.037
> 
> 标签：java, web-services, jax-ws

我正在尝试使用 JAX-WS 访问 Web 服务：

```
Dispatch<Source> sourceDispatch = null;
sourceDispatch = service.createDispatch(portQName, Source.class, Service.Mode.PAYLOAD);
Source result = sourceDispatch.invoke(new StreamSource(new StringReader(req)));
System.out.println(sourceToXMLString(result)); 
```

在哪里：

```
private static String sourceToXMLString(Source result) {
    String xmlResult = null;
    try {
        TransformerFactory factory = TransformerFactory.newInstance();
        Transformer transformer = factory.newTransformer();
        transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
        transformer.setOutputProperty(OutputKeys.METHOD, "xml");
        //transformer.setOutputProperty(OutputKeys.ENCODING, "utf-8");
        OutputStream out = new ByteArrayOutputStream();
        StreamResult streamResult = new StreamResult();
        streamResult.setOutputStream(out);
        transformer.transform(result, streamResult);
        xmlResult = streamResult.getOutputStream().toString();
    } catch (TransformerException e) {
        e.printStackTrace();
    }
    return xmlResult;
} 
```

访问响应内容的正确方法是什么，例如。**获取响应中特定元素的内容**？

所有可用的示例都只打印完整的 XML 响应 :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T01:29:08.863

尝试将 Transformer#transform() 与 DOMResult 一起使用，然后使用生成的节点。

```
private static void sourceToXML(Source result) {
    Node rootNode= null;
    try {
        TransformerFactory factory = TransformerFactory.newInstance();
        Transformer transformer = factory.newTransformer();
        DOMResult domResult = new DOMResult();
        transformer.transform(result, domResult );
        rootNode = domResult.getNode()
    } catch (TransformerException e) {
        e.printStackTrace();
    }
    // Process rootNode here
} 
```

# java - 使用 JPA 和 Hibernate 时如何解决 LazyInitializationException

> ID：578433
> 
> 赞同：52
> 
> 时间：2009-02-23T17:04:56.370
> 
> 标签：java, hibernate, jpa, orm, lazy-initialization

我正在为想要使用延迟初始化的客户开发一个项目。在使用默认延迟加载模式映射类时，它们总是会出现“延迟初始化异常”。

```
@JoinTable(name = "join_profilo_funzionalita", joinColumns = {@JoinColumn(name =    "profilo_id", referencedColumnName = "profilo_id")}, inverseJoinColumns = {@JoinColumn(name = "funzionalita_id", referencedColumnName = "funzionalita_id")})
//@ManyToMany(fetch=FetchType.EAGER) - no exceptions if uncommented
@ManyToMany 
private Collection<Funzionalita> funzionalitaIdCollection; 
```

是否有使用 JPA 类的标准模式来避免此错误？

欢迎提供片段，非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-08-11T09:10:05.043

Hibernate 4.1.6 finally solves this issue: [https://hibernate.atlassian.net/browse/HHH-7457](https://hibernate.atlassian.net/browse/HHH-7457)

You need to set the hibernate-property hibernate.enable_lazy_load_no_trans=true

Here's how to do it in Spring:

```
<bean id="entityManagerFactory"
      class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="myDataSource"/>
    <property name="packagesToScan" value="com.mycompany.somepackage"/>
    <property name="jpaVendorAdapter" ref="hibernateVendorAdapter"/>
    <property name="jpaDialect" ref="jpaDialect"/>
    <property name="jpaProperties">
        <props>
            <prop key="hibernate.enable_lazy_load_no_trans">true</prop>
        </props>
    </property>
</bean> 
```

Voila; Now you don't have to worry about LazyInitializationException while navigating your domain-model outside of a hibernate-session (persistence-context in "JPA-speak")

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-10T11:45:14.033

有很多方法可以预取属性，所以它们在会话关闭后就在那里：

1.  调用适当的吸气剂。将字段提取到 bean 后，会话关闭后它就在那里。
2.  您可以在 EJBQL 查询中初始化字段，查找`JOIN FETCH`关键字。
3.  如果您使用的是支持它的 Hibernate 版本，请启用 AvailableSettings.ENABLE_LAZY_LOAD_NO_TRANS。

当您尝试这些解决方案时，可能会出现几个问题：

1.  getter 的调用可能会被 JIT 编译器优化掉（有时这需要一段时间）。
2.  您尝试连接的实体`JOIN FETCH`可能通过涉及列表的多个“多”关系链接。在这种情况下，生成的查询返回不明确的结果，Hibernate 将拒绝在单个查询中获取您的数据。
3.  已经有一个[与 AvailableSettings.ENABLE_LAZY_LOAD_NO_TRANS 相关的有趣错误](https://hibernate.onjira.com/browse/HHH-7524)。而且还会有更多，因为正如冬眠者所说：*注意：这可能发生在事务之外并且不安全。谨慎使用。*你主要是靠自己。

最好的方法是先尝试`JOIN FETCH`。如果这不起作用，请尝试 getter 方法。如果 JIT 编译器在运行时搞砸了，请将结果分配给`public static volatile Object`.

或者停止使用休眠...

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-09-06T21:20:58.960

请注意，您不应该使用`hibernate.enable_lazy_load_no_trans`预 Hibernate 4.1.7，因为它会泄漏连接。见[https://hibernate.onjira.com/browse/HHH-7524](https://hibernate.onjira.com/browse/HHH-7524)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-23T02:53:57.740

LazyInitializationException 意味着您在休眠会话关闭后或对象与会话分离后调用集合。

您需要将对象重新附加到休眠会话，更改调用集合的位置，或者将会话关闭的边界移动到更高层。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-09-27T11:13:03.993

[解决 LazyInitializationException 的最佳方法](https://vladmihalcea.com/the-best-way-to-handle-the-lazyinitializationexception/)是在实体查询中使用 JOIN FETCH 指令。

[FetchType.EAGER 加载](https://vladmihalcea.com/eager-fetching-is-a-code-smell/)对性能不利。此外，还有一些反模式，例如：

*   [在视图中打开会话](https://vladmihalcea.com/the-open-session-in-view-anti-pattern/)
*   [`hibernate.enable_lazy_load_no_trans`](https://vladmihalcea.com/the-hibernate-enable_lazy_load_no_trans-anti-pattern/)

你永远不应该使用它，因为它们要么需要为 UI 渲染打开数据库连接（在视图中打开会话），要么对于在初始持久性上下文 ( `hibernate.enable_lazy_load_no_trans`) 之外获取的每个惰性关联都需要一个数据库连接。

有时，您甚至不需要实体，而 DTO 投影甚至更好。仅在需要修改实体时才应获取实体。对于只读事务，[DTO 预测更好](https://vladmihalcea.com/the-best-way-to-map-a-projection-query-to-a-dto-with-jpa-and-hibernate/)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-23T18:19:48.577

OpenSessionInView 是处理这个问题的一种模式。这里的一些信息：

[http://www.hibernate.org/43.html](http://www.hibernate.org/43.html)

在实施此模式并了解其含义时，您需要保持谨慎。每次您在视图中导航一个惰性关联时，它都会触发另一个 SQL 查询来加载数据。如果您的用例使得这些 SQL 查询的数量和大小很小，那么这可能无关紧要。确保至少调整日志记录设置，以便您可以看到 Hibernate 在后台“神奇地”执行哪种查询以加载数据。

还要考虑您正在编写的应用程序类型。如果您不处理远程处理（没有 Web 服务，没有基于 AJAX 的 Web 客户端），那么 OSIV 可能会很好地工作。但是，如果远程序列化程序开始遍历整个对象图，它可能会触发大量的 SQL 查询并削弱您的数据库和应用程序服务器。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-11-02T12:39:14.683

当您使用集合并且想要使用延迟加载对其进行初始化时，请在会话关闭之前使用该集合。如果会话关闭，如果你想使用，那么你会得到lazyinitializeException，因为默认情况下会尝试惰性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-26T21:33:15.057

Oracle Java 教程指出“企业 bean 支持事务，即管理共享对象并发访问的机制”。因此，为了处理 Lazy Fetch 问题，我创建了一个无状态 Java 会话 Bean，然后在从该方法返回之前获取我需要的所有子类。这避免了延迟获取异常。Oracle 也将此称为“会话外观”核心 J2EE 模式。这种模式似乎比提到的其他一些做法更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-17T19:07:27.000

我正在开发一个项目，旨在解决使用 ModelMapper 将实体映射到 DTO 时常见的 JPA 问题。这个问题已经在项目中解决了。项目链接：[JPA 模型映射器](https://github.com/vmf/modelmapper-jpa)

> “将实体声明为延迟加载对性能至关重要，因此我们不需要每次需要一些数据时都获取所有相关实体。但是这种技术会导致一些问题。最常见的是 LazyInitializationException，有时可能会很烦人. 大多数时候，我们只想要一个未加载实体的空对象，而不是一个在访问时抛出异常的对象......”

资料来源：[JPA 模型映射器](https://github.com/vmf/modelmapper-jpa)

因此，在项目中，我们通过为所有未加载的实体设置 null 来处理 LazyInitializationException。下面的例子展示了它是如何工作的。

**为所有未加载的实体重新映射实体设置 null：**

```
TypedQuery<SystemEntity> query =
        em.createQuery("select s from SystemEntity s where s.id = 1",  SystemEntity.class);

SystemEntity system = query.getSingleResult();
return new JpaModelMapper(em).mapEntity(system, SystemEntity.class); 
```

**对于所有未加载的实体，将实体重新映射到 DTO 设置 null：**

```
TypedQuery<SystemEntity> query =
        em.createQuery("select s from SystemEntity s where s.id = 1",  SystemEntity.class);

SystemEntity system = query.getSingleResult();
return new JpaModelMapper(em).mapEntity(system, SystemDTO.class); 
```

有关更多信息，请参阅[JPA 模型映射器](https://github.com/vmf/modelmapper-jpa)

# linux - linux g++编译器重定向stderr和stdout创建空文件

> ID：578438
> 
> 赞同：6
> 
> 时间：2009-02-23T17:07:06.583
> 
> 标签：linux, shell, g++

我正在将 g++ 编译器输出（stderr 和 stdout）重定向到 linux 上的文件。但它正在创建一个空文件。

我在其他一些帖子中读到 stdout 在每一行之后都没有刷新。没关系，但是 stderr 呢？在我的情况下，运行多个屏幕时出现编译错误。所以，我对标准错误输出感兴趣。没有创建标准输出输出。

```
 g++ -c -I ~/cplusplus/boost_1_37_0/boost_1_37_0/ -I 
~/cplusplus/niVxWorksDeliver/TEES/ Algorithms.cpp 2> output 
```

上面的命令创建了一个名为“output”的空文件。以下命令报告无效的空命令。

```
 g++ -c -I ~/cplusplus/boost_1_37_0/boost_1_37_0/ -I    
~/cplusplus/niVxWorksDeliver/TEES/ Algorithms.cpp &> output
Invalid null command. 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-23T18:29:12.750

您的一条评论表明您没有使用 bash。您正在使用 csh 或 tcsh。在这种情况下，您可以像这样重定向所有输出（包括标准错误）：

```
g++ -c Algorithms.cpp >& 输出

```

对于更多的 csh 重定向语法，我有[一个有用的链接](http://tomecat.com/jeffy/tttt/cshredir.html)书签。请注意，csh 重定向语法不如 bash 语法流畅。在 bash 中比在 csh 中可以做的更多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T17:11:27.947

你可以试试这个：

sh/bash/zsh 版本：

```
g++ -c -I ~/cplusplus/boost_1_37_0/boost_1_37_0/ \
       -I ~/cplusplus/niVxWorksDeliver/TEES/ \
       Algorithms.cpp > output 2>&1 
```

csh 或 tcsh 版本：

```
g++ -c -I ~/cplusplus/boost_1_37_0/boost_1_37_0/ \
       -I ~/cplusplus/niVxWorksDeliver/TEES/ \
       Algorithms.cpp >& output 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T17:09:18.763

“没有消息就是好消息”——你的命令是否会产生任何输出？当没有错误时，g++ 不会打印任何东西！

# .net - 您将如何在对象中表示此 XML？

> ID：578441
> 
> 赞同：1
> 
> 时间：2009-02-23T17:07:24.337
> 
> 标签：.net, xml, xml-serialization

```
<FileTransferSettings>
  <UploadPath src="user">C:\uploads</UploadPath>
  <DownloadPath src="app">C:\downloads</DownloadPath>
</FileTransferSettings> 
```

我想将此 XML 反序列化为具有 2 个属性的 FileTransferSettings 对象 - UploadPath 和 DownloadPath。但我也想以`src`我的代码可以查询它的方式保留每个属性的属性。

我认为创建关联的 UploadPathSrc 和 DownloadPathSrc 属性有点尴尬和麻烦。

在 .NET 中是否有另一种表示方式？对我来说，该`src`属性似乎应该被视为元数据。对此有最佳做法吗？

（有关我*为什么*要这样做的背景 - 请参阅我[之前的问题](https://stackoverflow.com/questions/578218/serialize-deserialize-to-from-multiple-xml-config-files)）。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T17:22:44.300

为了正确序列化和反序列化 XML，您需要使用 XML 序列化属性装饰类

```
[XmlRoot("FileTransferSettings")]
public class FileTransferSettings
{
   [XmlElement("DownloadPath")]
   public DownloadPath DownloadPath { get; set; }
   // ...
}

[XmlType("DownloadPath")]
public class DownloadPath
{ 
  [XmlAttribute]
  public string Src; // or use enum etc
  [XmlText]
  public string Text;
}

// the serialized XML looks like
<FileTransferSettings>
   <DownloadPath Src="...">text</DownloadPath>
   ....
</FileTransferSettings> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T17:08:43.850

您可以创建第二个类 FileTransferPath，它有一个字符串值“Path”和一个枚举值“Source”

```
class FileTransferSettings
{
   public FileTransferPath UploadPath { get; set; }
   public FileTransferPath DownloadPath { get; set; }
   // ...
}

class FileTransferPath
{
   public string Path { get; set; }
   public FileTransferSource Source { get; set}

   public enum FileTransferSource
   {
     None,
     User,
     Application,
     // ...
   }
} 
```

然后你可以使用类似的代码

```
 obj.UploadPath.Path;
   obj.UploadPath.Source; 
```

您可以为类属性选择更好的名称；我不知道我喜欢Path的重复。 `obj.Upload.Path`或者更好的东西。

请注意，您无法使用 XmlSerialization 直接将其直接序列化/反序列化为您所拥有的格式；但它确实完成了你所需要的。（而且你仍然可以序列化为 XML，你只需要做更多的工作）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T17:17:15.547

扩展 Daniel L. 的总体思路。

```
public Class FileTransferPath
{
  public Enum SourceEnum { User, App }

  public SourceEnum Source { get; set; }  //Automatic properties in 3.5 Syntax
  public string FilePath { get; set; }
}

public Class FileTransferSettings
{
  public FileTransferPath UploadPath { get; set; }
  public FileTransferPath DownLoadPath { get; set; }
} 
```

# javascript - 带有 jQ uery 的 ASP.NET MVC AJAX

> ID：578443
> 
> 赞同：21
> 
> 时间：2009-02-23T17:08:10.730
> 
> 标签：javascript, jquery, asp.net-mvc, dom

我有一个网站，每个用户的页面都显示评论并允许其他用户添加评论。我想要它，所以添加评论表单在页面上，当用户添加评论时，它会被添加到数据库并使用 AJAX 显示在评论部分。我在 AJAX 和 LINQ to SQL 中使用 jQuery 来处理数据库逻辑。如何做到这一点，以便在将评论添加到数据库后，刷新和更新评论部分而不刷新页面？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-23T18:17:29.533

您需要利用 jQuery ajax 调用触发的“成功”（或“完成”）事件来触发后续的 AJAX 调用以刷新您的评论内容。这可能看起来像（有翼，未经测试）：

```
function UpdateComments(){
    resultHTML = jQuery.ajax({
        type: 'GET',
        url: 'Comments/List/UserID'
    }).responseText;

    $('#comments').html(resultHTML);
}

function PostComment(targetUserID, commenterUserID, comment)
jQuery.ajax({
        type: 'POST',
        contentType: 'application/json; charset=utf-8',
        data: $.toJSON({review: comment, id:targetUserID, commenter:commenterUserID}),
        dataType: 'json',
        url: 'Comments/Add',
        success: function(result){
            // Only update comments if the post was successful:
            resultJson = $.evalJSON(result);
            if(resultJson['success'] == true){
                UpdateComments();                    
            }
        }
    }); 
```

**编辑**JSON 代码将使用 jquery 插件 jquery-json ( [http://code.google.com/p/jquery-json/](http://code.google.com/p/jquery-json/) )

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-23T18:33:45.440

作为对 Matt 的回应，另一种提交表单数据的方法是，您可以在 jQuery.ajax 函数的“数据”字段中调用 $('#form').serialize()，而不是 JSON。这将消除对插件的需要。

另外，我不是这个主题的专家，仍然尝试自己学习，但是当您可以将来自 ASP.NET MVC 的响应插入页面时，是否有必要同时拥有 POST 和 GET 请求？这将导致一个请求。不过，这种方法可能有正当理由。我想我的应该是这样的：

```
 // The Controller Action should return a PartialView as response,
    // so just a user control that contains the comments. 
function PostComment(targetUserID, commenterUserID, comment)
jQuery.ajax({
    type: 'POST',
    data: $('#commentForm').serialize(),
    url: 'Comments/Add',
    success: function(result){ 
        $('#comments').html(result);

        }
    }
    }); 
```

# sql - 所有这些 SQL 连接在逻辑上是等价的吗？

> ID：578450
> 
> 赞同：5
> 
> 时间：2009-02-23T17:08:53.380
> 
> 标签：sql, join

我只是想知道以下所有联接是否在逻辑上是等效的，如果不是，为什么不呢？

```
SELECT t1.x, t2.y from t1, t2 where t1.a=t2.a and t1.b=t2.b and t1.c = t2.c;

SELECT t1.x, t2.y from t1 join t2 on t1.a=t2.a where t1.b=t2.b and t1.c = t2.c;

SELECT t1.x, t2.y from t1 join t2 on t1.a=t2.a and t1.b=t2.b where t1.c = t2.c;

SELECT t1.x, t2.y from t1 join t2 on t1.a=t2.a and t1.b=t2.b and t1.c = t2.c; 
```

我想我真正的问题是：将“where”与“on”结合起来是否与仅将多个条件与“on”相结合？

我使用 MySQL，以防万一。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T17:12:07.290

它们在逻辑上是等价的，并且应该产生相同的结果。然而，最后一个是首选，因为它更正确地说明了查询的语义——即“连接表 t1 和 t2”。

WHERE 子句应该用于“过滤”连接的结果——例如

```
... WHERE t2.some_col > 10 
```

此外，正如康斯坦丁在另一个答案中所说，如果联接是外部联接，则 4 个查询会有所不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T17:19:29.720

对于 INNER JOIN 它没有逻辑上的区别，优化器应该产生相同的计划。但是对于 OUTER 连接，是否将条件放在 WHERE 或 FROM ... JOIN 子句中变得很重要。这是因为 FROM 和 ON 子句在 WHERE 子句之前处理： [ANSI SQL 逻辑查询处理 http://www.sqlmag.com/Files/09/94378/Figure_01.jpg](http://www.sqlmag.com/Files/09/94378/Figure_01.jpg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T18:04:21.970

是的，正如其他人所说，所有这些查询的结果都是相同的。

FWIW，当您对两个表中相同的列名进行等连接时，您也可以使用这种速记语法：

```
SELECT t1.x, t2.y from t1 join t2 using (a, b, c); 
```

至于优化，*应该*同样优化。也就是说，RDBMS 应该足够聪明，可以分析`WHERE`相同的语法并执行连接，而不是生成中间巨大的交叉连接结果并对其应用过滤条件。这是一种常见的查询类型，给定的 RDBMS 实现识别和优化它也很常见。

在 MySQL 的情况下，join 和 where （某种）一起评估。尝试使用[`EXPLAIN`](http://dev.mysql.com/doc/refman/5.1/en/using-explain.html)来分析您的查询。如果“ `type`”列指示“ `eq_ref`”，则表示它正在使用索引连接。这是关于优化的最佳连接类型。如果 " `type`" 是 " `ref`" 也很好。

无论您将条件放在`JOIN...ON`子句还是`WHERE`子句中，您都可以获得这些连接优化类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T18:41:08.433

它们在逻辑上是等价的。但是，在哪里定义连接条件会影响在应用 where 子句的临时表中使用了多少记录。那是，

如果表 t1、t2 和 t3 各有 10 条记录，则语句，

```
SELECT t1.x, t2.y from t1, t2 where t1.a=t2.a and t1.b=t2.b and t1.c = t2.c; 
```

产生 1000 条记录的三个表记录的排列，然后应用 where 子句。

为了

```
SELECT t1.x, t2.y from t1 join t2 on t1.a=t2.a and t1.b=t2.b and t1.c = t2.c; 
```

在应用任何 where 子句（本例中没有）之前，临时表中只有 10 条记录。使用大表时，第二种方法要快得多。

# ms-access - 在 Access VBA 中禁止写入冲突消息

> ID：578452
> 
> 赞同：7
> 
> 时间：2009-02-23T17:09:11.633
> 
> 标签：ms-access

我的问题。

我编写了一个存储过程来计算通过 Ms Access 前端（到 MSSQL2000 db）上的表单呈现的字段数量。

一旦我调用**Me.Form.Requery**来获取更改的值。我可以收到我引起写入冲突的恼人消息。

> 自您开始编辑此记录以来，其他用户已更改此记录。如果您保存记录，您将覆盖其他用户所做的更改。将更改复制到剪贴板将让您查看其他用户输入的值，然后如果您决定进行更改，则将更改粘贴回。

我知道是我更改了数据，所以我想抑制消息或阻止消息发生。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-24T01:58:02.983

（我想我应该把我的评论放在一个帖子中，因为我实际上是在回答这个问题）

您收到写入冲突消息的原因是您通过表单和存储过程编辑记录创建了写入冲突。为避免该错误，只需在执行存储过程之前将记录保存在表单中即可。从上面发布的代码片段中，它应该是：

```
Me.Dirty = False
cmd.Execute , , adCmdStoredProc 
```

这是一个常见的 Access 错误，它是由尝试通过绑定表单和直接 SQL 更新来编辑数据引起的。在通过 SQL 更新同一条记录之前，您需要保存表单的编辑缓冲区。

换句话说，您应该感谢正在发生错误消息，因为否则，您将丢失其中一项更改。

不过，我质疑设计。如果您在绑定表单中打开了记录，则对表单中加载的数据进行编辑，而不是运行 SQL 来更新它。我不确定为什么您需要一个存储过程来更改您已经在表单中编辑的记录——这对我来说听起来像是一个设计错误（即使解决方案非常简单）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-16T01:03:10.100

我有一个链接到后端 SQL 数据库的访问表单。链接到子表单的表上的触发器会更新表单中的字段。如果在更改子表单中的值后在表单中编辑同一记录，则会收到错误消息“写入冲突此记录已更改....”。

触发器更新的字段不能直接在表单上更改，因此选择“保存记录”总是可以的，但我不知道如何自动选择“保存记录”。

正如其他人所说，避免错误的方法是在编辑记录之前重新查询表单，但这会使用户体验不太流畅。

我终于找到了解决方法：

在表单的类模块中输入：

Private Sub Form_Error(DataErr As Integer, Response As Integer)

```
If DataErr = 7787 Then
Response = acDataErrContinue
Me.Recordset.MovePrevious
Me.Recordset.MoveNext
End If 
```

结束子

我花了很长时间寻找解决方案 - 我希望它可以帮助别人

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-26T11:37:22.873

我有一个类似的问题。

例子：

假设记录有一个字段`aForm!text = "Hello"`。

如果用户单击一个按钮，VBA 代码在哪里执行

```
aForm!text = "Hello World!" 
```

当我关闭记录时，我收到错误消息“此记录已更改...”

解决方案：

如果你刷新表单`aForm.Refresh`，`aForm.Requery`你可以避免写冲突。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-07T15:33:02.560

如果这些答案都不起作用，那么试试这个。在您遇到错误的表单中，插入此代码。

```
Private Sub Form_Deactivate()
     DoCmd.RunCommand acCmdSaveRecord
End Sub 
```

基本上，错误是两个表单编辑相同的信息。因此，您必须在离开任一表格后告诉 Access 进行保存。

来源： https: [//support.microsoft.com/en-ca/kb/304181](https://support.microsoft.com/en-ca/kb/304181)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-11T06:55:35.727

我有同样的问题。我通过代码从主表单（主表）中的从属表单（从属表）更改了字段，并且在关闭表单之前我总是收到警告：“记录已被另一个用户更改......”
**错误状态：**
错误从属形式的语法（字段更新后的操作）是：

```
Private Sub Value1_AfterUpdate()
    Me.Parent.Controls("Result").Value = 123.52 
End Sub 
```

然后在检测到父表单后，另一个“用户”更改了它的字段。

**解决方案：**
强制主窗体从自身更改值。使用主窗体作为类：
1) 定义值的私有变量，应从从窗体更改
2) 定义公共 let 并在主窗体中获取属性 - 即“公共属性让 letResult(ByVal myVal as double) ... "
3) 在主窗体中定义公共过程 Write_Values，它从私有值中设置主窗体字段中的值（从公共属性 let ... 获得的值）

4) 在从属表单中定义语法，该语法将值发送到主表单中的 let 属性。
5) 最后从从属窗体调用主窗体中的公共过程Write_Values

## 示例代码主表单：

```
Private myResult As Double
Public Property Let letResult(ByVal myval As Double)
    myResult = myval
End Property
Public Sub Write_Values()
    Me.Result.Value = myResult
    DoCmd.RunCommand acCmdSaveRecord
    Me.Dirty = False
End Sub 
```

* * *

**示例代码从形式：**

```
Private Sub Value1_AfterUpdate()
    Me.Parent.letResult = 123.52
    Me.Parent.Write_Values
End Sub 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-09T00:20:45.177

我遇到了同样的问题，两种不同形式的两个控件链接到后端链接表中的同一字段。我通过仅将一个控制字段链接到表来解决它，并且当其中一个被更新时，另一个将信息写入第二个其他控件中。

有用。你可能会问，为什么我需要两种形式的两个控制字段？一个注册数据，另一个在输入所有数据后使用它进行计算。这使用户无法访问进行计算的表单。当然，我可以通过使用一行 VBA 代码注册数据的表单访问计算数据，以供在计算表单中参考。我希望它有所帮助。它对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T17:33:35.647

我发现解决此问题的方法是重置记录源

```
Me.RecordSource = ""
cmd.Execute , , adCmdStoredProc
Me.RecordSource = "SELECT SourceFields FROM SomeTable " 
```

但这似乎很老套。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T20:23:47.827

当您执行类似这样的存储过程时会发生什么：

```
db.Execute "<SP_NAME>", dbSeeChanges 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-19T22:31:34.993

检查您尝试更新的表上是否有触发器。如果是这样，请确保它在执行时不会在文本窗口中返回任何内容。

我遇到了同样的问题并且无法解决它，直到我在触发器的开头添加了“SET NOCOUNT ON”。

触发器没有在外部更新任何内容，因为它是“插入后，删除”触发器，但我的问题已经解决。

# sql - SQL Server 中有用的系统存储过程

> ID：578454
> 
> 赞同：31
> 
> 时间：2009-02-23T17:09:22.570
> 
> 标签：sql, sql-server, sql-server-2005, stored-procedures

我最近发现我可以使用`sp_help`来获取表定义，并从那时起就迷上了它。在我发现之前，我不得不在 SQL Management Studio 中打开对象资源管理器，手动搜索表名，右键单击表并选择设计。那是很大的努力！

你们都使用了哪些其他系统存储过程，你不能没有？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-23T17:11:43.657

`Alt`+`F1`是一个很好的[快捷](http://www.kodyaz.com/articles/sql-query-window-short-cuts.aspx)键`sp_help`。

`sp_helptext`是获取存储过程文本的另一个好东西。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-23T17:16:06.937

所有这些无证的

```
xp_getnetname 

xp_fileexist 

xp_dirtree 

xp_subdirs 

sp_who2

xp_getfiledetails 

xp_fixeddrives 

Sp_tempdbspace 

xp_enumdsn 

xp_enumerrorlogs

sp_MSforeachtable 

sp_MSforeachDB 
```

请参阅此处：[未记录的存储过程](http://wiki.lessthandot.com/index.php/SQL_Server_Programming_Hacks_-_100%2B_List#Undocumented_but_handy)

现在从 SQl Server 2005 开始，所有的动态管理视图都像[sys.dm_db_index_usage_stats](http://wiki.lessthandot.com/index.php/Use_the_sys.dm_db_index_usage_stats_dmv_to_check_if_indexes_are_being_used)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-04T19:55:13.297

sp_helpindex [table] - 显示索引信息（与 sp_help 相同的信息）

sp_helpconstraint [table] - 显示主键/外键/默认值和其他约束 *

sp_depends [obj] - 显示对象的依赖关系，例如：

sp_depends [table] - 显示哪些存储的过程、视图、触发器、UDF 影响此表

sp_depends [sproc] - 显示此存储过程影响/使用的表等

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-23T17:27:22.027

您可以使用`sp_spaceused`来确定一个表或整个数据库的大小。如果您传递表名，它会返回用于该表的空间，当不带参数调用时，它会给出数据库的空间。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T17:10:52.567

[`sp_who/sp_who2`](http://dotnetyuppie.com/2008/01/03/simple-sql-performance-monitoring-with-sp_who-and-sp_who2/)- 让您知道谁在服务器上做什么。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-23T17:13:26.333

*   [sp_who](http://msdn.microsoft.com/en-us/library/aa260384(SQL.80).aspx)
*   [sp_who2](http://www.devx.com/tips/Tip/14208)
*   [sp_helptext](http://msdn.microsoft.com/en-us/library/ms176112.aspx)

*   [有用的系统存储过程列表](http://doc.ddart.net/mssql/sql70/sp_00.htm)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-27T09:07:43.223

```
sp_catalogs 
sp_column_privileges
sp_column_privileges_ex
sp_columns
sp_columns_ex
sp_databases
sp_cursor
sp_cursorclose
sp_cursorexecute
sp_cursorfetch
sp_cursoroption
sp_cursoropen
sp_cursorprepare
sp_cursorprepexec
sp_cursorunprepare
sp_execute
sp_datatype_info
sp_fkeys
sp_foreignkeys
sp_indexes
sp_pkeys
sp_primarykeys
sp_prepare
sp_prepexec
sp_prepexecrpc
sp_unprepare
sp_server_info
sp_special_columns
sp_sproc_columns
sp_statistics
sp_table_privileges
sp_table_privileges_ex
sp_tables
sp_tables_ex 
```

也检查这个链接

[http://msdn.microsoft.com/en-us/library/ms176007.aspx](http://msdn.microsoft.com/en-us/library/ms176007.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-23T19:01:35.920

Select * From sysobjects where xtype='U' order by Name

给出数据库中所有用户定义表的列表。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-23T23:51:51.353

[sp_rename](http://msdn.microsoft.com/en-us/library/ms188351.aspx)

用于重命名数据库对象（表、列、索引等）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-04T20:01:28.710

master.dbo.xp_cmdshell

我无法列出我没有 RDP 访问框但拥有足够权限的 SQL 登录以在其上运行 shell 命令的次数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-28T11:51:41.063

在查询编辑器中突出显示任何 proc 或其他系统对象名称，然后按 shift-f1 以获得该词的帮助。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-06-08T05:19:33.193

我知道这是一个相当古老的话题，但它在搜索引擎中的排名仍然很高。

这些是我最喜欢的存储过程，我希望你也觉得它们有用。几乎所有这些都可以通过一个简单的命令来实现，但是这些存储过程执行一些有用的检查和验证。

```
[sys].[sp_revokelogin]
[sys].[sp_password]
[sys].[sp_MSchangeobjectowner]
[sys].[sp_addlogin]
[sys].[sp_addrole]
[sys].[sp_adduser]
[sys].[sp_denylogin]
[sys].[sp_droplogin]
[sys].[sp_droprole]
[sys].[sp_droprolemember]
[sys].[sp_dropuser] 
```

# spring - 如何通过脚本和 EL 集成 jBPM 和 Spring

> ID：578455
> 
> 赞同：1
> 
> 时间：2009-02-23T17:09:29.043
> 
> 标签：spring, integration, el, separation-of-concerns, jbpm

我正在使用/期待以下技术堆栈：

*   JSF
*   接缝
*   jBPM
*   春天

当然，我希望 Seam 可以直接访问 Spring bean，并且可以正常工作。我现在想进入 jBPM 并开发一个概念验证流程定义，该流程定义访问 Spring bean 以执行操作和做出决策。

为了促进关注点分离并确保进程可以在类路径中没有 Seam 的情况下运行，我想要一个不允许访问所有 Seam 托管组件的解决方案。

我知道 Seam 使用定制的 EL 解析器，但除此之外，我从哪里开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T18:35:42.413

可以对 VariableResolver 进行子类型化并在 jbpm.cfg.xml 文件中指定子类型。这可以允许 #{myBean} 解析为您的 bean。

```
<jbpm-configuration>

    <bean name="jbpm.variable.resolver" class="com.your.jbpm.VariableResolver" singleton="true" >
        <field name="backingVariableResolver"><ref bean="jbpm.variable.backingResolver" /></field>
    </bean>
    <bean  name="jbpm.variable.backingResolver" class="org.jbpm.jpdl.el.impl.JbpmVariableResolver" singleton="true" />

</jbpm-configuration> 
```

但是对于从脚本和操作进行访问，方法是将[瞬态变量](http://docs.jboss.org/jbpm/v3/userguide/context.html#transientvariables)注入流程实例，请记住，您可能需要通过子类型脚本和调整关联的休眠映射文件来解决错误[JBPM-304](https://jira.jboss.org/jira/browse/JBPM-304)。这种注入必须在每个流程实例的每个信号之前重复。

这些技术可用于确保您可以访问您想要访问的 bean，但并不真正为您提供自定义 EL。这将需要对 JbpmExpressionEvaluator 类进行一些严重的黑客攻击。

# .net - Visual Studio 2008 中的错误编译程序

> ID：578469
> 
> 赞同：1
> 
> 时间：2009-02-23T17:11:48.180
> 
> 标签：.net, visual-studio-2008, vsto, visual-studio-2008-sp1, compiler-errors

所以我以前从未见过这个问题，也不知道从哪里开始解决这个问题。

```
Cannot register assembly "obj\Debug\MyProject.Vsto.dll".
Loading this assembly would produce a different grant set from other instances. 
(Exception from HRESULT: 0x80131401) 
```

我从哪里开始解决这个问题？

我应该提到这是一个带有 VS2008 SP1 的 VS2008 环境，这个解决方案是：
1\. VSTO Excel 2007 项目 (C#)
2\. 数据访问/服务层 DLL (C#)
3\. #2 (C#) 的 MbUnit 测试项目

**更新：** 我应该补充一点，这几个月都可以正常工作。上周左右我唯一改变的是我已经开始通过 Team Foundation Server (TFS) 编写代码。

**更新2：** 删除`.suo`文件工作了一段时间。现在我又遇到了同样的错误....嗯。猜猜我会关闭项目`.suo`再次删除。

**更新 3：** VS2008 将允许我编译一次解决方案。第二次尝试时，我得到了错误。如果我退出，删除`.suo`文件，然后重新打开，我可以再次编译一次。对原因有什么想法吗？这是VS2008 SP1的东西吗？

对于赏金，我正在寻找永久解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T02:28:04.080

仅供参考...看起来像 CLR HRESULT（中间的 13 表示）。根据这篇博文：[很多 HRESULT 代码......](http://blogs.msdn.com/eldar/archive/2007/04/03/a-lot-of-hresult-codes.aspx)具体的 HRESULT 是 SECURITY_E_INCOMPATIBLE_SHARE 0x80131401 -2146233343

很可能一些错误的进程在程序集上持有一个打开的句柄并阻止编译器放置一个新的句柄。鉴于更新＃3，该进程可能是 devenv.exe ......这对缩小范围没有帮助，但是它可能是一些后台进程，它与 VS 一起关闭（例如调试器托管进程）。

假设文件中有东西……要调试这种类型的东西，第一步是从 SysInternals 工具集中打开[procexp.exe](http://technet.microsoft.com/en-us/sysinternals/default.aspx)。在其中，您可以使用 Find 来确定哪个进程具有打开文件的句柄。当您遇到此问题时，我希望它会在 devenv.exe 中显示一个打开的句柄。

在 procexp 中，您可以执行非常危险的操作，即关闭句柄。之后在不关闭的情况下再次尝试这些步骤。如果问题没有重现，那么您知道您关闭的手柄是问题的原因。如果其他任何事情都发生得很好......那个“高度危险”的步骤可能是原因。

如果您知道哪个进程具有打开的句柄，那么您需要查看是否可以防止它触及句柄的明显泄漏。我会检查项目设置......包括任何复制文件的调试设置。如果有一个名为 VSHosting 进程的调试器设置...将其关闭。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T18:24:56.537

我做了一些谷歌搜索，并[在 MSDN 论坛上发现了这篇文章，](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/214c997b-5618-4f4e-bdca-2ae7357bf988/)这可能（或可能不会）证明对您有用。

它提到了一些应该安装的 Windows 更新补丁（如果您使用的是 Vista）以及一个解决方法（如果您使用的是 XP）。虽然帖子指的是 Silverlight 的问题......错误是一样的，所以也许？

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T19:07:04.360

我还没有看到确切的错误，但如果有另一个从不同位置加载的 DLL 副本，可能会发生类似的错误。

我会搜索一下周围是否有该 DLL 的任何其他副本

```
dir MyProject.*.dll /s 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T21:32:34.017

所以它创建了 dll 但之后不喜欢使用它？如果是这种情况，您是否尝试在 Reflector 中打开 dll 以查看第一次和第二次编译之间可能存在哪些差异？

另一个想法 - 您是否在第一次成功构建后尝试过清理/重建？您是否在每次编译时更新版本号？我想知道是否引用了一个过时的文件，但在第一次编译后更新了。此时参考与预期不匹配。

另一个随机想法 - .suo 文件通常包含与您的个人计算机相关的信息。与编译相关的内容不应保存在该文件中 - 它应该转到 .sln 。.suo 是根本原因似乎很奇怪......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T13:50:59.757

似乎您开发了一个 ms - office 扩展程序。然后你应该安装最新的**COM Shim Wizard**。VS2008 的下载地址[*在这里*](http://www.microsoft.com/downloads/details.aspx?FamilyID=3e43bf08-5008-4bb6-aa85-93c1d902470e&displaylang=en)。

托管办公室扩展应相互隔离。[*MSDN 上的这篇文章*](http://msdn.microsoft.com/en-us/library/aa159894.aspx#odc_office_com_shim_wizards_howwizardworks)解释了原因和方法。

我假设您的 .dll 不是孤立的，因此您会得到“安全共享错误”：

> **隔离。**如果您不使用标准 COM shim（例如 Visual Studio Tools for Office 加载程序）或提供您自己的自定义 COM shim，您的扩展 DLL 将与所有其他未填充的扩展一起加载到默认应用程序域中。在同一应用程序域中运行的所有 DLL 都容易受到由同一应用程序域中的任何其他 DLL 造成的潜在损害。此外，任何在主机应用程序中崩溃的未填充插件都会禁用该应用程序的所有其他未填充插件。

开发办公室扩展一开始看起来很简单，但后来......

托马斯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T21:05:59.417

我看过这个[线程](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/214c997b-5618-4f4e-bdca-2ae7357bf988/)，它似乎突出了一些类似的问题。

如何排除故障？我会说首先检查您的应用程序是否可以生成这种错误消息。然后检查您的软件所依赖的库或系统是否有问题（然后寻求支持或社区支持）。

祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T16:25:16.093

这有点超出我的范围，但我确实找到了以下[链接，这表明您遇到了](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=95157).net 2.0 的已知缺陷。

我从微软建议的解决方法中复制了以下内容：

> 当在同一进程中的两个应用程序域之间按值封送对象时会出现该问题，其中实例的类型是通用的，通用模板类型在 mscorlib 中定义，其一个或多个实例化类型未在 mscorlib 中定义，并且多域加载器优化已在一个域中启用，但在另一个域中未启用。
> 
> 不幸的是，这个错误被发现得太晚了，并没有成为 V2.0 产品的标准。但是有一些解决方法：
> 
> 此错误特定于进程内跨应用程序域远程处理通道的优化版本，因此可以通过关闭进程的此优化来避免。这可以通过在将执行测试的命令窗口中设置以下环境变量来实现：
> 
> ```
> set complus_UseNewCrossDomainRemoting=0 
> ```
> 
> 或者通过将 HKEY_CURRENT_USER\Software\Microsoft.NETFramework\UseNewCrossDomainRemoting 注册表值（一个 DWORD）设置为 0（或 HKEY_LOCAL_MACHINE 中的版本）。
> 
> 这些有点重量级，但也有可能欺骗优化路径，从而避免只传输有问题的对象的特定调用。为此，在调用中添加一个虚拟输出参数（由于各种技术原因，优化路径尚未实现输出参数）。
> 
> 您还可以避免使用 mscorlib 定义的泛型类型。在呈现的重现案例中，这很简单，因为您只需子类型 List：
> 
> ```
> [Serializable]
> public class MyList<T> : List<T>
> {
> } 
> ```
> 
> （只需用 MyList 替换 List 的所有用途）。
> 
> 最后，如果两个应用程序域都使用多域优化，则不应出现该问题。在您已经运行它之后，您无法设置默认域的加载器优化，但您可以在外部设置它（我相信通过非托管托管 API 或配置文件，尽管我不是这方面的专家，抱歉）或通过在您的代码中创建一个新域（使用多域选项）并将控制权转移给它（通过调用该域中的 MBRO 对象）。

抱歉，如果您已经在搜索中找到了这篇文章，但我没有看到它在这里作为解决方案提供。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-04T17:17:56.437

你不会弄乱系统时间吧？这样做会弄乱你的程序集。

# c++ - Boost 的最佳组件是什么？

> ID：578479
> 
> 赞同：30
> 
> 时间：2009-02-23T17:14:10.233
> 
> 标签：c++, boost, utility

我一直在浏览 Boost 库的修订版 1.38.0，试图确定那里是否有足够的珠宝来证明谈判我公司的外部软件审批流程是合理的。在编写测试程序和阅读文档的过程中，我得出了几个结论

*   当然，并不是 Boost 中的所有东西都可以在我的工程组中使用
*   更重要的是，其中一些库似乎比其他库更精致

事实上，一些图书馆对我来说似乎有点像玩具。

有许多相当容易访问的库在经过很短的调查后就可以使用，例如*boost::variant*（我真的很喜欢*访问者*组件以及如果访问者缺少一个变体类型之一）。我会使用*boost::shared_ptr*，除了我们的组已经有一组智能指针类型。

所以基于 Stack Overflow 用户的广泛经验，Boost 库

*   有高品质吗？
*   不仅仅是玩具？
*   有没有什么入门门槛高但值得学习的？

[请注意，这与Boost](https://stackoverflow.com/questions/569198/boost-considered-harmful)中提出的问题有些不同，认为有害吗？

PS - 是否删除了答案之一（来自 litb）？我在这里看不到它，只有我的用户页面上的摘录...

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-23T18:17:13.280

我经常使用（它让我的生活更简单）：

*   智能指针（`shared_ptr`, `scoped_ptr`, `weak_ptr`, interprocess `unique_ptr`）：

    *   `scoped_ptr`基本 RAII（无共享所有权和所有权转让），免费。
    *   `shared_ptr`对于更复杂的操作 - 当需要共享所有权时。不过也有一些成本。
    *   `unique_ptr`- boost 正在积极开展工作，将各种方法（目前在 Boost 中）`unique_ptr`与移动仿真结合起来。
    *   它们非常易于使用（仅标题），易于学习且经过很好的测试（好吧，也许除了`unique_ptr`）
*   Boost Thread - 积极开发（线程现在是可移动的）库，用于处理线程。隐藏给定平台上线程实现的复杂性。

*   Boost MPL 和 Fusion——这些更难解释。很长一段时间我都没有使用编译时的能力，但是经过一些阅读和学习后，我发现我的一些代码可以很好地简化。不过，请注意编译时间...

*   提升亚西欧

    *   与第一印象相反（至少在一段时间前），它不仅仅是网络库。它提供了几乎可以用于任何事情的异步 I/O 模型。
*   Boost Format（强大的输出格式，但很重）

*   Boost Spirit2x（Karma 和 Qi 用于根据给定语法解析和生成输出）。非常强大，无需借助外部工具即可创建解析器。然而编译时间可能是个问题。版本 2x 也正在积极开发中，文档相当稀缺（但精神开发邮件列表非常有帮助）

*   Boost Bind、Function 和 Lambda 让您的生活更轻松和 Boost Phoenix - 只是为了试验

*   lexical_cast（类似的东西可能很快就会诞生为 boost::string）

*   Regex/Xpressive - 正则表达式

*   类型特征和概念检查 - 再次让您的生活更轻松

*   数学：

    *   各种随机数发生器
    *   各种统计分布
    *   ublas - 用于在 C++ 中以类似方式使用 LAPACK/BLAS 绑定
    *   一些数学函数，通常在 C++ 中不可用
    *   一些用于控制数字类型之间转换的工具
    *   区间算术
*   Boost Iterator（用于迭代器的专用适配器和用于创建您自己的外观）

*   Boost 单元测试框架

还有一些我在 Boost 中几乎没有接触过的部分。可能我也忘了提到几个明显的。

记住使用正确的工具（锤子）解决正确的问题（钉子）。请记住保持解决方案简单。记住接收功能的成本（例如`shared_ptr`，`boost::format`运行时开销或 MPL/Fusion/Spirit/Phoenix 编译时间成本和可执行文件大小）。但实验和学习——这就是乐趣所在。

在说服管理层使用新图书馆时，您不必从所有图书馆开始。从简单的事情开始（可能是那些具有长期稳定的 Boost 历史、广泛的编译器支持、计划包含在 TR2/C++1x 中等）和显示好处的简单示例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-23T17:24:55.620

在设计跨平台（例如 *nix 和 win32）多线程应用程序时，我发现它是无可争议的必备品（. ）`boost`，**仅此一项**就足以在至少一个实例中作为我雇主项目的一部分采用。`boost::thread``boost::interprocess``boost`

其余的（容器、通用编程和元编程、内存）作为免费赠品紧随其后。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-23T17:22:04.473

我经常使用`boost::filesystem`. 它完成了简单文件管理所需的一切

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-23T17:23:08.980

我想说有价值的图书馆是：

*   元编程 (MPL, `enable_if`, `type/function_traits`)
*   预处理器 - 如果您需要它，它可能会派上用场
*   变体，可选 - 正如您已经注意到的
*   数学 - 四元数，额外的数学函数（尽管它们可能对你没有用）
*   lambda：虽然语法很复杂，但很容易上瘾
*   运算符/迭代器：在构建自己的类型时它们非常方便

也许是 Python（从未尝试过，但有些例如 KDE 程序使用它）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-23T17:23:04.470

如果您正在使用共享内存等做事，那么[提升进程间绝对是值得的。](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-23T17:18:00.147

如果您使用 STL，Boost::lambda 会有所帮助。它使您能够就地创建谓词，如下所示：

```
for_each(a.begin(), a.end(), std::cout << _1 << ' '); 
```

此代码输出容器中用空格分隔的所有元素。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-23T17:18:16.183

C++0x 标准库的许多新增内容最初是作为 Boost 库的一部分创建的。

它们并不完美（任何软件），但使用的工程过程非常强大（远远超过大多数免费软件）。如果您确实需要帮助，您会在邮件列表中找到很多。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-23T17:24:49.410

我个人认为你应该看看隐藏平台特定内容的库，如线程、ipc、内存映射文件、文件系统、异步 IO 等。

这些可以在多平台项目中为您节省大量时间和麻烦，并且往往专注于公开功能而不是花哨的 C++ 功能的练习。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-23T17:28:25.067

如果您需要解析比简单的键/值对更复杂的文本文件，我强烈推荐[Boost::spirit](http://www.boost.org/doc/libs/1_38_0/libs/spirit/index.html)。它有很高的学习曲线，但是一旦你弄清楚了，它就可以让你轻松地将 EBNF 语法嵌入到代码中。它比编写自己的解析器要健壮得多。我还发现自己创建的文件格式更便于文件编写者而不是解析代码的编写者。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-23T17:36:20.943

我发现 boost.thread 和 boost.asio 对于编写客户端/服务器应用程序是必不可少的。智能指针库使编写使用异常处理的代码变得容易而不会泄漏内存。

附带说明一下，最近发布了一组 PDF 文件，其中记录了一些更常见的 boost 库。[您可以从SourceForge](http://sourceforge.net/project/showfiles.php?group_id=7586&package_id=159715&release_id=662905)下载它们。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-24T07:19:25.600

我已阅读其他答案，我*需要*添加 Boost.Graph (BGL) 及其朋友 Boost.Property_map。这两个字面上改变了我的日常工作。

It is extremely well designed, but most people are put off at first because there is quite a high price to pay before actually understanding the purpose of all concepts. But once you get a grip on this library, it becomes hard to go without !

# visual-studio-2008 - 嵌套的 Linq 崩溃智能感知

> ID：578481
> 
> 赞同：2
> 
> 时间：2009-02-23T17:15:41.913
> 
> 标签：visual-studio-2008, linq, intellisense

目前我正在使用 Visual Studio 2008 (SP1) 并开发一些使用嵌套 LINQ 语句的代码。然而，随着每个级别的嵌套，智能感知性能会大大下降到无法使用的程度。

有没有其他人经历过类似的事情或找到了解决这个问题的方法？

为任何帮助干杯托尼

* * *

**更新** 我们使用 resharper，我已经将智能感知改回 Visual Studio，同样的事情发生了。

我没有确切的代码，但大致如下：

```
var a = list1.Sum(x => x.list2.Sum(y => y.list3.Sum())) 
```

任何更深的嵌套，它通常都会引发不稳定。

我还没有完全关闭 reshaprer，但我会在早上尝试。

感谢你目前的帮助

* * *

**更新 2** 我已经在没有 resharper 的 VS 副本上测试了代码，它工作正常.....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T17:25:28.600

你在使用 Devepress 的 CodeRush 吗？尝试将其关闭或[此](http://www.devexpress.com/Support/Center/p/B90896.aspx)解决方案（尽管针对不同的问题）似乎为我解决了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T17:30:44.920

没见过。它可能与 Resharper 或 CodeRush 等 Visual Studio 插件有关；我们已经看到这些插件会降低 IDE 性能。

# cocoa - 在 NSTextField 中禁用 Option-Enter 换行符？

> ID：578483
> 
> 赞同：2
> 
> 时间：2009-02-23T17:15:55.970
> 
> 标签：cocoa, nstextfield, nstextview, fieldeditor

我想禁止在我的 NSTextField 中输入换行符，默认情况下可以通过键入 Option-Enter（或 Option-Return）来实现。

虽然我发现[一些](http://developer.apple.com/qa/qa2006/qa1454.html) [页面](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/TextEditing/Tasks/FieldEditor.html)解释了如何在*不使用 Option 修饰符的情况下**允许*换行符，但我找不到任何可以完全*禁用*换行符的内容。

 **如何才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T03:22:20.833

您可以创建 NSFormatter 的子类并实现 isPartialStringValid:... 方法来阻止换行符。

```
- (BOOL)isPartialStringValid:(NSString **)partialStringPtr 
       proposedSelectedRange:(NSRangePointer)proposedSelRangePtr 
              originalString:(NSString *)origString 
       originalSelectedRange:(NSRange)origSelRange 
            errorDescription:(NSString **)error
{
    // the user may have:
    // -- deleted the left most character
    // -- deleted the last character and we have an empty string
    // both cases are valid
    if (proposedSelRangePtr->location == 0)
        return YES;

    unichar theChar = [*partialStringPtr characterAtIndex:proposedSelRangePtr->location - 1];

    if ([[NSCharacterSet newlineCharacterSet] characterIsMember:theChar]) {
        *error = nil;
        NSBeep();
        return NO;
    }

    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T11:43:16.360

请问您为什么要禁用此功能？这是操作系统的一个非常标准的部分。请记住，用户可能会从其他地方粘贴一些包含换行符的字符串，然后他们将根据需要进行编辑。保持这个特性完好无损，但是当需要将视图中的值复制到模型时，使用 NSFormatter 删除换行后的所有内容可能会更好吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-12T07:48:18.703

在使用 Control、Option + Enter (Return) 的情况下，我执行以下代码以防止出现换行问题。

```
- (BOOL)control:(NSControl *)control textView:(NSTextView *)textView doCommandBySelector:(SEL)commandSelector
{
    if ((commandSelector == @selector(insertNewlineIgnoringFieldEditor:)) || (commandSelector == @selector(insertLineBreak:)))
    {
        return YES;
    }

    return NO;
} 
```

# apache-flex - 从外部 AS 访问 MXML 中定义的元素

> ID：578485
> 
> 赞同：2
> 
> 时间：2009-02-23T17:16:23.847
> 
> 标签：apache-flex, mxml, external, textinput

我有一个带有表单的 MXML，其中有两个 TextInput。我讨厌在 MXML 文件中包含任何代码（我来自 JavaScript 格式），所以我使用

```
mx:Script source="external.as" 
```

标记以包含任何 MXML 文件中使用的任何代码。问题是，如果我在文件中有此代码`external.as`：

```
private function populateFromForm():void{
   var vo:ValidObject= new ValidObject();
   vo.market = marketInput.text;
   vo.segment = segmentInput.text;
   vo.priceLow = priceLowInput.text;
   vo.priceHigh = priceHighInput.text;
} 
```

其中 marketInput、segmentInput、priceLowInput 和 priceHighInput 是 MXML 文件中定义的 TextInput。当我尝试编译时，我得到一个**1120: Access to undefined property XXXXX**

我尝试在函数之前添加以下行：

```
public var marketInput:TextInput;
public var segmentInput:TextInput;
public var priceLowInput:TextInput;
public var priceHighInput:TextInput; 
```

但相反，我得到一个**1151：内部命名空间中的定义 XXXX 存在冲突，**这非常有意义。

有没有办法做到这一点，而不必将所有输入引用作为函数的参数传递给函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T17:26:53.900

您需要创建对 TextInputs 父容器实例的引用，然后使用该引用来访问 TextInputs 及其属性。我认为我们需要对您的文件结构进行一些澄清。您如何创建父容器的实例？我想这是你需要做的：

MyForm.mxml：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:TextInput id="marketInput" />
    <mx:TextInput id="segmentInput" />
    <mx:TextInput id="priceLowInput" />
    <mx:TextInput id="priceHighInput" />
</mx:VBox> 
```

SaveVOContainer.as:

```
package
{
    public class SaveVoContainer extends Container
    {
        private var myForm:MyForm = new MyForm();

        public function SaveVOContainer
        {
            this.addChild(myForm);
        }

        private function populateFromForm():void{
           var vo:ValidObject= new ValidObject();
           vo.market = myForm.marketInput.text;
           vo.segment = myForm.segmentInput.text;
           vo.priceLow = myForm.priceLowInput.text;
           vo.priceHigh = myForm.priceHighInput.text;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T18:03:11.567

在 Flex 中执行“代码隐藏”是很痛苦的。没有部分类的概念或 Javascript 中原型继承的灵活性。谷歌为许多资源提供“flex 中的代码隐藏”。

我认为你最好习惯在 mxml 中嵌入代码的想法。使用脚本标签尽可能避免内联代码。如果您必须在 MXML 中编写大量代码，也许您可​​能希望将代码重构为多个自定义组件。如果它们可重复使用，则加分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-22T20:22:16.973

在 Flex 中执行代码隐藏的规范方法是通过继承。这是来自文档的一个很好的解释：[http](http://learn.adobe.com/wiki/display/Flex/Code+Behind) ://learn.adobe.com/wiki/display/Flex/Code+Behind 。简而言之：

1.  声明一个 ActionScript 类以用作您的基类。
2.  将基类设置为 MXML 文件中的根容器。
3.  对于在 MXML 文件中声明的任何控件，您必须使用完全相同的名称将它们重新声明为基类的公共成员（正如您在上面为带有源标记的脚本块所做的那样，只有它有效:-)

因此，您的 ActionScript 文件：

```
package mypackage
{
    import mx.controls.TextInput;

    public class myClass extends WindowedApplication
    {
        public var marketInput:TextInput;

        private function populateFromForm():void{
            /* As above */
        }
    }
} 
```

以及对应的 MXML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<custom:myClass xmlns:custom="mypackage.*"
        xmlns:fx="http://ns.adobe.com/mxml/2009"
        xmlns:s="library://ns.adobe.com/flex/spark" 
        xmlns:mx="library://ns.adobe.com/flex/mx">
    <mx:TextInput id="marketInput"/>
</custom:myClass> 
```

等等其他 TextInput 控件。现在你的 populateFromForm 函数应该可以工作了。

不得不两次重新声明相同的实体有点令人发指，但这并不完全是早期受访者所说的伤害袋子（尽管这可能在 Flex 4 中进行了更改以使其不那么痛苦）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-27T15:03:38.277

*   在 .AS 中导入它：

    `import mx.core.Application;`

*   在 .AS 中使用：

    `mx.core.Application.application.component.property = value;` `mx.core.Application.application.myText.text = 'test';`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T17:22:47.030

您的 mxml 文件中是否有指向 ActionScript 文件的脚本标记？

```
 <mx:Script source='includes/foo.as' /> 

```

# ssas - SSAS MOLAP 聚合不起作用

> ID：578494
> 
> 赞同：0
> 
> 时间：2009-02-23T17:20:00.687
> 
> 标签：ssas

当我们从 Visual Studio 为 MOLAP 多维数据集运行聚合向导时，不会创建聚合。图表保持平坦。我们尝试了所有我们能想到的不同场景和设置，但没有运气。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T12:01:15.147

检查事项：

1.  你的维度有自然的层次结构吗？（最佳聚合所需）
2.  你有这些层次结构的正确属性关系吗？（此外，需要优化聚合和性能）
3.  您是否有可聚合的非父子维度？（只有关键属性会在这些中聚合）
4.  您的多维数据集中有任何数据吗？（向导需要数据才能工作）
5.  你有分区吗？（不能为高于分区拆分的级别创建聚合，例如，您不能在每月分区上进行一年聚合）
6.  确保至少某些维度属性的 AttributeHierarchyOptimizedState 设置为 FullyOptimized
7.  检查 AggregationUsage 多维数据集维度属性属性

另请阅读：

*   [什么是自然层次结构以及为什么它们是一件好事](http://sqljunkies.com/WebLog/mosha/archive/2006/11/09/natural_hierarchy.aspx)
*   [影响聚合候选](http://www.sqlskills.com/BLOGS/LIZ/post/Influencing-Aggregation-Candidates.aspx)者（这比这里有更多的细节）

# c# - 动态创建对象

> ID：578495
> 
> 赞同：50
> 
> 时间：2009-02-23T17:20:38.297
> 
> 标签：c#, .net, dynamic

我的数据库中有一个表，用于管理跨应用程序的关系。它的本质是非常基本的 - parentType，parentId，childType，childId ... 都是整数。我之前已经完成了这个设置，但是当我尝试链接 6 个不同的表时，我使用了 switch/case 设置。现在我有 30 个表正在尝试执行此操作，并且我希望能够执行此操作而不必在我的 switch 命令中编写 30 个 case 条目。

有没有一种方法可以使用字符串引用 .Net 类？我知道这是无效的（因为我已经尝试了几种变体）：

```
Type t = Type.GetType("WebCore.Models.Page");
object page = new t(); 
```

我知道如何获取对象的类型，但是如何动态使用它来创建新对象？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-02-23T17:22:26.423

此链接应该有帮助：
[https ://docs.microsoft.com/en-us/dotnet/api/system.activator.createinstance](https://docs.microsoft.com/en-us/dotnet/api/system.activator.createinstance)

Activator.CreateInstance 将创建指定类型的实例。

您可以将其包装在这样的通用方法中：

```
public T GetInstance<T>(string type)
{
    return (T)Activator.CreateInstance(Type.GetType(type));
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-23T17:28:27.017

如果调用者知道该类型，则有一种比使用 Activator.CreateInstance 更好、更快的方法：您可以对指定它具有默认无参数构造函数的方法使用泛型约束。

这样做是类型安全的，不需要反射。

```
T CreateType<T>() where T : new()
{
   return new T();
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-06-04T15:23:24.743

```
public static T GetInstance<T>(params object[] args)
{
     return (T)Activator.CreateInstance(typeof(T), args);
} 
```

我会使用**Activator.CreateInstance()**而不是强制转换，因为 Activator 有一个泛型构造函数。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-23T17:22:29.557

你想用[`Activator.CreateInstance`](http://msdn.microsoft.com/en-us/library/d133hta4.aspx).

这是它如何工作的示例：

```
using System;
using System.Runtime.Remoting;

class Program
{
    static void Main()
    {
        ObjectHandle o = Activator.CreateInstance("mscorlib.dll", "System.Int32");

        Int32 i = (Int32)o.Unwrap();
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T17:38:47.770

假设您有以下类型：

```
public class Counter<T>
{
  public T Value { get; set; }
} 
```

并具有该类型的程序集限定名称，您可以按以下方式构造它：

```
string typeName = typeof(Counter<>).AssemblyQualifiedName;
Type t = Type.GetType(typeName);

Counter<int> counter = 
  (Counter<int>)Activator.CreateInstance(
    t.MakeGenericType(typeof(int)));

counter.Value++;
Console.WriteLine(counter.Value); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-19T13:04:17.500

这是我编写的一个函数，它使用反射克隆 T 类型的记录。这是一个非常简单的实现，我没有处理复杂的类型等。

```
 public static T Clone<T>(T original)
    {
        T newObject = (T)Activator.CreateInstance(original.GetType());

        foreach (var prop in original.GetType().GetProperties())
        {
            prop.SetValue(newObject, prop.GetValue(original));
        }

        return newObject;
    } 
```

我希望这可以帮助某人。

阿萨夫

# web-applications - 为 Web 应用程序生成可用性报告的好方法是什么？

> ID：578499
> 
> 赞同：1
> 
> 时间：2009-02-23T17:22:04.503
> 
> 标签：web-applications, reporting

我管理着许多 Web 应用程序，并被要求根据任何停机时间的长度和时间生成有关其可用性的统计信息。有谁知道可用于促进这一点的任何工具和/或服务？

这些应用程序都是 java servlet 应用程序，后端有一个 oracle 数据库。除经过身份验证的用户外，通常禁止访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-17T11:39:43.237

该组织已经与[AlertSite](https://www.alertsite.com/web_site_monitoring_suite.shtml)签订了合同，我们现在已将其扩展到涵盖额外的 web 应用程序。对于基本的可用性监控和报告来说，这似乎是合理的。它以预定义的时间间隔从多个不同的位置向应用程序发送请求，如果没有从登录页面收到正确的回复，它会立即发送通知。我已经对其进行了设置，以便它每天通过电子邮件发送一份报告，详细说明前一天的正常运行时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T17:48:21.680

不确定它是否适用于您的特定情况，但我使用[nagios](http://www.nagios.org/)。

# php - 下载文件问题

> ID：578507
> 
> 赞同：1
> 
> 时间：2009-02-23T17:23:10.727
> 
> 标签：php, download

我编写了一个脚本来强制从站点下载 mp3 文件。该代码运行良好，但问题是它无法下载大文件。我尝试使用 9.21mb 的文件并正确下载，但每当我尝试使用代码下载 25mb 的文件时，它只会给我一个找不到服务器页面或网站无法显示该页面。所以我现在知道下载大文件有问题。下面是下载文件的代码片段。

```
header("Pragma: public");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false);             
header("Content-type: application/force-download");
header("Content-Disposition: attachment; filename=\"".$dname.".mp3\";" );
header("Content-Transfer-Encoding: binary");
header("Content-Length: ".filesize($secretfile));
$downloaded=readfile($secretfile); 
```

显示的错误是：HTTP 500 Internal Server Error

非常感谢你们抽出宝贵的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T17:32:10.300

它可能是内存限制，但通常 PHP 会输出一个错误，说明已达到内存限制。

此外，在所有这些之前，如果启用了输出压缩，您应该禁用它：

```
if(ini_get('zlib.output_compression')) {
    ini_set('zlib.output_compression', 'Off');
} 
```

如果启用了输出压缩，有时 IE 可能会搞砸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T17:30:41.940

查看您的 PHP 配置以了解内存限制和超时

在 php.ini 中：

```
memory_limit = 32M
max_execution_time = 300 
```

请注意，如果您想要非常长的执行时间，您还需要更改您的 Web 服务器超时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T17:35:46.217

> 我只是给了我一个找不到服务器页面或网站无法显示该页面

这是 Internet Explorer 显示的错误吗？您是否收到任何服务器端错误？你检查过你的服务器日志吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T18:00:00.077

试试这个：

```
// empty output buffer
while (ob_get_level()) {
    ob_end_clean();
}
if (ini_get('output_buffering')) {
    ini_get('output_buffering', false);
}

// function to encode quoted-string tokens
function rfc2822_quoteString($string) {
    return '"'.preg_replace('/[^\x00-\x0C\x0E-\x21\x23-\x5B\x5D-\x7F]/', '\\\$0', $string).'"';
}

// HTTP headers
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.rfc2822_quoteString($dname.'.mp3'));
header('Content-Length: '.filesize($secretfile));

// send file
readfile($secretfile);
exit; 
```

# wpf - 在 WPF 画布上选择一个对象？

> ID：578510
> 
> 赞同：0
> 
> 时间：2009-02-23T17:24:24.997
> 
> 标签：wpf, select, canvas

我有一个 WPF 画布，上面有一些椭圆对象（显示为圆圈）。每个圆圈都来自一个集合类实例，它实际上是一个自定义孔模式类。每个图案都有一定数量的圆圈，然后使用下面的代码对集合进行迭代，将每个圆圈添加到画布中。

因此，画布上填充了一堆圆圈，每个圆圈都属于某个模式实例。你可以在这里看到截图：http: [//twitpic.com/1f2ci/full](http://twitpic.com/1f2ci/full)

现在我想添加在画布上单击一个圆圈的功能，并能够确定它所属的集合，这样我就可以对该圆圈所属的选定图案做更多的工作。

```
public void DrawHoles()
{
   // Iterate over each HolePattern in the HolePatterns collection... 
   foreach (HolePattern HolePattern in HolePatterns)
    {
        // Now iterate over each Hole in the HoleList of the current HolePattern...
        // This code adds the HoleEntity, HoleDecorator, and HoleLabel to the canvas
        foreach (Hole Hole in HolePattern.HoleList)
        {

            Hole.CanvasX = SketchX0 + (Hole.AbsX * _ZoomScale);
            Hole.CanvasY = SketchY0 - (Hole.AbsY * _ZoomScale);
            canvas1.Children.Add(Hole.HoleEntity);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T22:33:29.153

它们都有`FrameworkElements`一个`Tag`对象类型的属性，可用于保存任意信息。您可以将 分配`HolePattern`给该`Tag`属性并在以后轻松使用它来获取关联的集合。

IE：

```
...
Hole.HoleEntity.Tag = HolePattern as object;
canvas1.Children.Add(Hole.HoleEntity); 
```

稍后在点击事件中：

```
event(object sender,....)
{
   Ellipse e = sender as Ellipse;
   HolePattern hp = e.Tag as HolePattern;
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:11:41.457

所以你可能已经阅读了我的回复，我说我已经成功了。它确实工作得很好，（除了它需要非常精确的鼠标），但我想问这个：为每个添加到画布的椭圆添加事件处理程序真的很聪明吗？现在我不知道这可能是什么样的内存沼泽，或者它可能是 WPF 和 Windows 处理的小菜一碟。

在实际情况下，我猜即使在具有多个图案的屏幕上也不会超过 30-50 个孔，但仍然； *五十个*事件处理程序？只是看起来很吓人。实际上，每个“洞”都由两个同心圆和一个文本标签在视觉上表示（参见此处的屏幕显示：http: [//twitpic.com/1f2ci/full](http://twitpic.com/1f2ci/full)），我知道用户希望能够点击这些元素中的任何一个来选择一个孔。这意味着每个洞都有 3 个元素的事件处理程序。现在我们可以谈论 100 个或更多的事件处理程序。

似乎应该有一个解决方案，您可以在 Canvas 上只有一个事件处理程序并读取鼠标下的元素引用，然后处理它以获得该元素的 .Tag 属性，依此类推。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T20:18:58.707

我想我会发布我的最终和更完善的解决方案，以防它帮助其他人。

```
void canvas1_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    int ClickMargin = 2;// Adjust here as desired. Span is in both directions of selected point.
    var ClickMarginPointList = new Collection<Point>();
    Point ClickedPoint = e.GetPosition(canvas1);
    Point ClickMarginPoint=new Point();
    for (int x = -1 * ClickMargin; x <= ClickMargin; x++)
    {
        for (int y = -1 * ClickMargin; y <= ClickMargin; y++)
        {
            ClickMarginPoint.X = ClickedPoint.X + x;
            ClickMarginPoint.Y = ClickedPoint.Y + y;
            ClickMarginPointList.Add(ClickMarginPoint);
        }
    }

    foreach (Point p in ClickMarginPointList)
    {
        HitTestResult SelectedCanvasItem = System.Windows.Media.VisualTreeHelper.HitTest(canvas1, p);
        if (SelectedCanvasItem.VisualHit.GetType().BaseType == typeof(Shape))
        {
            var SelectedShapeTag = SelectedCanvasItem.VisualHit.GetValue(Shape.TagProperty);
            if (SelectedShapeTag!=null &&  SelectedShapeTag.GetType().BaseType == typeof(Hole))
            {
                Hole SelectedHole = (Hole)SelectedShapeTag;
                SetActivePattern(SelectedHole.ParentPattern);
                SelectedHole.ParentPattern.CurrentHole = SelectedHole;
                return; //Get out, we're done.
            }
        }
    }
} 
```

# matlab - 如何在MATLAB中获取变量的类型

> ID：578519
> 
> 赞同：195
> 
> 时间：2009-02-23T17:27:57.593
> 
> 标签：matlab, variables, types

MATLAB 是否具有指示变量类型的函数/运算符（类似于`typeof`JavaScript 中的运算符）？

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2009-02-23T17:36:42.130

使用[`class`](https://www.mathworks.com/help/matlab/ref/class.html)功能：

```
>> b = 2
b =
     2
>> a = 'Hi'
a =
Hi
>> class(b)
ans =
double
>> class(a)
ans =
char 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-02-23T17:33:41.933

[class()](https://www.mathworks.com/help/matlab/ref/class.html)函数等价于`typeof()`.

您还可以使用[isa()](https://www.mathworks.com/help/matlab/ref/isa.html)检查变量是否属于特定类型。如果您想更具体，可以使用[ischar()](https://www.mathworks.com/help/matlab/ref/ischar.html)、[isfloat()](https://www.mathworks.com/help/matlab/ref/isfloat.html)、[iscell()](https://www.mathworks.com/help/matlab/ref/iscell.html)等。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-03-11T21:11:27.797

另一个相关的功能是[`whos`](http://www.mathworks.com/help/matlab/ref/whos.html)。它将列出给定工作区中变量的各种信息（维度、字节大小、类型）。

```
>> a = [0 0 7];
>> whos a
  Name      Size            Bytes  Class     Attributes

  a         1x3                24  double              

>> b = 'James Bond';
>> whos b
  Name      Size            Bytes  Class    Attributes

  b         1x10               20  char 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-03-11T20:57:01.203

[使用isa](https://www.mathworks.com/help/matlab/ref/isa.html)函数时要小心。如果您的对象是指定的类型*或其*子类之一，这将是正确的。您必须将[strcmp](https://www.mathworks.com/help/matlab/ref/strcmp.html)与`class`函数一起使用来测试对象是否专门为该类型而不是子类。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-10-23T10:38:10.223

由于没有人提到它，MATLAB 也有这个[`metaclass`](https://www.mathworks.com/help/matlab/ref/metaclass.html)函数，它返回一个对象，其中包含有关传入实体的各种信息。这些[`meta.class`](https://www.mathworks.com/help/matlab/ref/meta.class.html)对象可用于继承测试（通过常见的比较运算符）。

例如：

```
>> metaclass(magic(1))

ans = 

  class with properties:

                     Name: 'double'
              Description: ''
      DetailedDescription: ''
                   Hidden: 0
                   Sealed: 0
                 Abstract: 0
              Enumeration: 0
          ConstructOnLoad: 0
         HandleCompatible: 0
          InferiorClasses: {0×1 cell}
        ContainingPackage: [0×0 meta.package]
     RestrictsSubclassing: 0
             PropertyList: [0×1 meta.property]
               MethodList: [272×1 meta.method]
                EventList: [0×1 meta.event]
    EnumerationMemberList: [0×1 meta.EnumeratedValue]
           SuperclassList: [0×1 meta.class]

>> ?containers.Map <= ?handle

ans =

  logical

   1 
```

我们可以看到`class(someObj)`相当于`Name`的结果的字段`metaclass(someObj)`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-10T09:04:19.517

# MATLAB - 检查变量的类型

> **class()**与 Javascript 的**typeof**运算符完全一样。
> 
> 要获取有关变量的更多详细信息，您可以使用**whos**命令或**whos()**函数。

**这是在MATLAB R2017a**的命令行窗口上执行的示例代码。

```
>> % Define a number
>> num = 67

num =

    67

>> % Get type of variable num
>> class(num)

ans =

    'double'

>> % Define character vector
>> myName = 'Rishikesh Agrawani'

myName =

    'Rishikesh Agrwani'

>> % Check type of myName
>> class(myName)

ans =

    'char'

>> % Define a cell array
>> cellArr = {'This ', 'is ', 'a ', 'big chance to learn ', 'MATLAB.'}; % Cell array
>> 
>> class(cellArr)

ans =

    'cell'

>> % Get more details including type
>> whos num
  Name      Size            Bytes  Class     Attributes

  num       1x1                 8  double              

>> whos myName
  Name        Size            Bytes  Class    Attributes

  myName      1x17               34  char               

>> whos cellArr
  Name         Size            Bytes  Class    Attributes

  cellArr      1x5               634  cell               

>> % Another way to use whos i.e using whos(char_vector)
>> whos('cellArr')
  Name         Size            Bytes  Class    Attributes

  cellArr      1x5               634  cell               

>> whos('num')
  Name      Size            Bytes  Class     Attributes

  num       1x1                 8  double              

>> whos('myName')
  Name        Size            Bytes  Class    Attributes

  myName      1x17               34  char               

>> 
```

# scheduling - GNU make 中的互斥作业调度？

> ID：578521
> 
> 赞同：5
> 
> 时间：2009-02-23T17:28:01.043
> 
> 标签：scheduling, parallel-processing, gnu-make

使用 GNU make，是否可以在使用“--jobs”选项时创建一组永远不会同时安排的目标？

### 背景：

为了使这更具体一点，请考虑以下形式的生成文件

```
p1: ...deps... # no parallelization conflicts (can run at the same time as p*, e*)
        ...rules...

p2: ...deps... # no parallelization conflicts (can run at the same time as p*, e*)
        ...rules...

p3: ...deps... # no parallelization conflicts (can run at the same time as p*, e*)
        ...rules...

e1: ...deps... # cannot run at same time as any other e*
        ...rules...

e2: ...deps... # cannot run at same time as any other e*
        ...rules...

e3: ...deps... # cannot run at same time as any other e*
        ...rules... 
```

我需要做的主要事情是确保 e1、e2 和 e3 永远不会同时被处理，因为它们在资源有限的嵌入式设备上做一些工作。如果其中多个同时执行，它们会崩溃。p1、p2 和 p3 可以与任何东西并行执行，包括任何 e* 作业。

请注意，实际的 makefile 有几千个目标，其依赖关系树大约有 10 级深，所以我希望有一种方法可以做到这一点，（a）不需要连续运行 make 并且（b）保留的好处在生成文件中编码依赖树。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T17:38:55.337

您的一种选择是使用“flock”在排他锁下运行“e”规则。有关详细信息，请参见 manflock(1)。例如，而不是

```
e2: deps
    my_cmd foo bar 
```

你可以有

```
e2: deps
    flock .embedded-device-lock -c my_cmd foo bar 
```

然后发生的事情是所有“e”目标都由 make 并行启动（可能），但实际命令将串行执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T17:48:38.340

这不是一个完美的解决方案，但您可以使用仅订购的先决条件对 e* 目标施加特定的顺序：

```
e1: ...deps...
    ...commands...
e2: ...deps... | e1
    ...commands...
e3: ...deps... | e2 e1
    ...commands... 
```

管道符号“|”之后的先决条件 仅订购：如果 e1 或 e2 已更改，它们不会强制更新 e3，但它们确实要求 e1 和 e2 的所有命令在启动 e3 的命令之前完成运行。

这样做的缺点是它为这些互斥的先决条件强加了特定`make`的顺序，而不是让选择顺序，但实际上您可能可以手动找出合理的顺序。

# .net - 具有非实体返回类型的实体模型中的函数导入

> ID：578536
> 
> 赞同：8
> 
> 时间：2009-02-23T17:32:34.493
> 
> 标签：.net, visual-studio, entity-framework, .net-3.5, ado.net

我的实体数据模型中有一个存储过程，并将其添加到函数导入中。

问题是......当且仅当我将返回指定为实体类型时，Visual Studio 才会在模型的代码隐藏中生成函数代码。 **标量和空返回类型不起作用。当我选择它们时，Visual Studio 不会生成函数代码。**

有什么我遗漏的东西，还是这是一个错误？
任何变通办法？

* * *

使用 Visual Studio 2008 v9.0.30729.1 SP（服务包 1）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T17:56:33.470

这与其说是一个错误，不如说是缺少一个功能。实体框架现在不支持返回标量值的存储过程。我相信这应该在 .NET 4.0 中改变。同时，您可以使用通过[CreateDbCommand](http://msdn.microsoft.com/en-us/library/system.data.common.dbconnection.createdbcommand.aspx)获得的存储连接来执行这样的存储过程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T16:27:42.543

由于现在唯一可行的是将返回类型映射到实体，因此一种解决方法是创建一个与返回数据对应的视图并为该视图创建一个实体。这仅在 SP 执行 SELECT 以返回结果集而不是返回值时才有效。我让它与示例应用程序一起使用，如下所示：SP：

```
ALTER PROCEDURE [dbo].[DoSomething]
    @param1 varchar(50),
    @param2 varchar(50)
AS
BEGIN
    DECLARE @ID INT
    SET NOCOUNT ON;
    INSERT tmp_header (fname, lname) VALUES (@param1, @param2) 
    SET @ID = SCOPE_IDENTITY()
    SELECT @ID AS 'id'
END 
```

看法：

```
CREATE VIEW [dbo].[View_1]
AS
SELECT   0 as  id 
```

创建函数导入，将返回类型设置为 View_1 并构建模型。

在代码中：

```
 class Program
    {
      static void Main(string[] args)
      {
        using (PS_RADSTESTEntities ctx = new PS_RADSTESTEntities())
        {
          EntityConnection ec = ctx.Connection as EntityConnection;
          ec.Open();
          DbTransaction txn = ec.BeginTransaction();
          ObjectResult<View_1> result = ctx.DoSomething("Toby", "Kraft");
          View_1 row = result.Single();
          int id = row.id;
// do some other interesting things ...
          ctx.SaveChanges();
          txn.Commit();
        }
      }
    } 
```

确保在视图和 SP 之间将列名设置为完全相同。托比

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-06T15:08:29.333

我有类似的问题并使用这篇文章解决了它：

[http://blogs.msdn.com/bindeshv/archive/2008/11/21/using-stored-procedures-that-return-non-entity-type.aspx](http://blogs.msdn.com/bindeshv/archive/2008/11/21/using-stored-procedures-that-return-non-entity-type.aspx)

# java - 如何在java中等待并关闭命令提示符

> ID：578537
> 
> 赞同：3
> 
> 时间：2009-02-23T17:32:36.677
> 
> 标签：java, process, batch-file

我正在使用以下代码来执行批处理文件：

```
java.lang.Runtime rt = java.lang.Runtime.getRuntime();
Process pr = rt.exec("MyBatch.bat"); 
```

我的批处理文件需要一些时间来执行。我希望我的 servlet 进程等到批处理文件执行完成。我想在执行批处理文件后关闭命令提示符。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T17:36:37.387

用于[`Process.waitFor()`](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Process.html#waitFor())让您的线程等待批处理文件的执行完成。

```
java.lang.Runtime rt = java.lang.Runtime.getRuntime();
Process pr = rt.exec("MyBatch.bat");
pr.waitFor(); 
```

如果您需要访问控制台的输出和/或输入，您可能还想查看 using[`ProcessBuilder`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ProcessBuilder.html)而不是。`Runtime.getRuntime().exec()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T17:36:31.037

最直接的方法是使用您创建的流程对象的 .waitFor() 方法：`pr.waitFor();`

这是一个阻塞调用，这意味着在此调用返回之前不会执行任何其他代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T17:49:16.763

正如其他人所说，您可以使用 Process.waitFor()。但是，在执行此操作之前，您**必须**启动另一个线程，该线程不断读取进程的输出和错误流的内容；否则，如果出现导致大量输出的错误，您的应用程序将挂起。

或者，您可以让批处理文件将输出和错误重定向到文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T08:24:03.940

您可以从您的流程中跟踪 InputStreamReader。并跟踪 bat 文件中的行。

当你是 EOF 然后从命令行退出

请参阅示例或完整源代码。 [点击这里](http://yuvadeveloper.blogspot.com/2009/03/closing-command-prompt-from-java_18.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T17:35:20.760

查看[Process](http://java.sun.com/javase/6/docs/api/java/lang/Process.html)类的文档。

# asp.net-mvc - 如何避免 ASP.Net（或 IIS？）解码我的 URL 编码密文（导致 404）而不是将其传递给 Approve 脚本？

> ID：578548
> 
> 赞同：1
> 
> 时间：2009-02-23T17:34:09.390
> 
> 标签：asp.net-mvc, visual-studio-2008, url, urlencode

我正在 ASP.Net MVC 中开发一个 Web 应用程序，其中用户使用 sql 成员资格提供程序注册成员资格。当他们注册时，他们被放入系统但未被批准。然后，代码会向用户发送一封批准电子邮件，其中包含给定的电子邮件。

```
BfEncrypt refid = new BfEncrypt();
refid.Encrypt(user.ReferenceID);
string code = HttpContext.Current.Server.UrlEncode(refid.CipherText);
    ...
Body += "<a href=\"http://localhost:1091/approve/" + code + "\">Approval Link</a>\n\r\n\r"; 
```

但是当用户点击链接时，他们会收到以下错误：

> 说明：HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除、名称已更改或暂时不可用。请查看以下 URL 并确保其拼写正确。
> 
> 请求的 URL：/Approve/k/9IHrY43os=

问题是，如果我在发送链接之前对链接进行 url 编码，为什么它会在尝试调用操作之前进行解码？当我收到错误时，我浏览器中的 url 实际上是 ' [http://localhost:1091/Approve/k%2f9IHrY43os%3d '。](http://localhost:1091/Approve/k%2f9IHrY43os%3d)我的路由设置正确，但它没有考虑 url 中加密字符串中的额外“/”（因为它不应该在那里。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T17:55:03.957

您可以将其编码为 base64 而不是使用 URLEncode。

# html - 为什么我的 position:absolute 元素总是显示在 position:relative 项下？

> ID：578554
> 
> 赞同：4
> 
> 时间：2009-02-23T17:35:07.017
> 
> 标签：html, css, xhtml

一切都在问题中，但这是一个简单的例子

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1" />
    <title>TEST</title>
</head>
<body style="margin:0;padding:0">

<div style="background-color:#eeeeee;margin:auto;height:500px;width:500px">
    <div style="position:relative">
        <span style="position:absolute;display:block;height:250px;width:250px;background:green;z-layer:2"><br /><br />Should be on top</span>
    </div>
    <span style="position:relative;display:block;width:500px;background:blue;z-layer:1">Actually on top</span>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-23T17:35:52.287

代替“z-layer”使用“z-index”

绝对跨度也在没有 z-index 的相对 div 中

这是正确的html：

```
<div style="background-color:#eeeeee;margin:auto;height:500px;width:500px">
    <div style="position:relative;z-index:2">
        <span style="position:absolute;display:block;height:250px;width:250px;background:green"><br /><br />Should be on top</span>
    </div>
    <span style="position:relative;display:block;width:500px;background:blue;z-index:1">Actually on top</span>
</div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T17:38:47.957

发生这种情况是因为当您“绝对”定位一个元素时，它会从文档对象模型中的文档流中删除，因此保留在文档流中的元素出现在已删除元素的“上方”。为了跨浏览器的兼容性，请将您的 z-index 调整放在绝对定位元素的父元素上。

# linux - 为 Fedora Linux 服务器进行自动全新安装的最佳方法？

> ID：578564
> 
> 赞同：2
> 
> 时间：2009-02-23T17:36:26.280
> 
> 标签：linux, automation, installation, fedora

我有一个 Fedora 10 64 位服务器，我想在其中设置一个夜间全新安装。该服务器是我们客户硬件的精确克隆，用于运行验收测试。

我本来希望使用虚拟机进行设置，但由于我们在虚拟机上使用不同的视频和网络驱动程序时遇到了问题，所以禁止这样做。

以下是我需要自动化的基本步骤：

1.  重新安装基本 Fedora 10
2.  更新到最新的软件包
3.  安装额外的软件包（其中一些来自 rpmfusion 存储库和我们自己的私有存储库，因此需要将这些的 repo 文件添加到配置中）
4.  恢复文件系统表以包含 NAS 挂载
5.  恢复用户和主目录。

我已经研究过使用[Kickstart](http://www.redhat.com/docs/manuals/linux/RHL-9-Manual/custom-guide/ch-kickstart2.html)进行安装，但它似乎只能通过回答您通常在安装过程中以交互方式回答的所有问题来满足上述第一步。有谁知道我可以使用的更合适的工具？

编辑：看起来[重新旋转](http://www.linuxformat.co.uk/modules.php?op=modload&name=News&file=article&sid=723)在这里也可能非常有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T18:00:17.440

你可以看看类似的东西

雾 - [http://www.fogproject.org/](http://www.fogproject.org/)

clonezilla - [http://clonezilla.org/](http://clonezilla.org/)

基本上，这两个应用程序用于将备份映像自动、无人值守地部署到机器上。它们往往用于大型企业，但可以用于您想要实现的目标。

我只使用了 clonzilla，但雾显然可以在 pxe 引导安装后运行脚本。您可以在完成上述所有步骤后克隆设备，然后通过每晚重新启动来推送映像，您可以为此使用 clonezilla 或雾，或者您可以使用带有脚本的雾来应用安装干净映像后的机会服务器

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T06:04:14.127

[Kickstart 可以使用 %post 部分做更多事情](http://www.redhat.com/docs/manuals/linux/RHL-9-Manual/custom-guide/s1-kickstart2-postinstallconfig.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T06:11:49.537

只是想详细说明@BenBruscella 的 %post 帖子。Kickstart 有一个部分，您可以在其中包含或调用任何安装后脚本以在主要安装内容完成后启动。有了这个，您可以轻松地进行软件包更新和安装。

# javascript - JQuery 星级评分插件 - 投票提交后禁用

> ID：578573
> 
> 赞同：5
> 
> 时间：2009-02-23T17:38:43.793
> 
> 标签：javascript, jquery, ajax, jquery-plugins

[我正在使用来自http://www.fyneworks.com/jquery/star-rating/](http://www.fyneworks.com/jquery/star-rating/)的 JQuery 星级插件 (v2.61) 。一切顺利，但我想在用户投票时禁用星星。

目前我的用户选择他们的评级并单击鼠标。这将通过 AJAX 调用更新我的数据库。星级评分器更改以显示用户的选择，其中星星显示为红色。但是，如果用户将鼠标悬停在星星上，它们仍然处于活动状态，并且可以再次提交投票。我正在停止这个重复的投票服务器端，但从可用性的角度来看，我希望在用户点击后禁用星星。

（我想我可以使用 JQuery 重新加载 div 或其他内容以显示星星的只读版本，但我希望有一些更优雅和更简单的解决方案）。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T21:02:09.233

为什么不允许用户*更新*他们的评分？也许他们的第一次评级很仓促，他们想更改它，或者他们只是点击了错误的星号。

当然，您需要某种方法来识别每个用户，并在某个地方存储每个用户对每个项目的评分。

（我实际上不知道该怎么做，但从可用性的角度来看，这似乎比确保你第一次做对更好的方法，因为你以后不能改变它。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-17T21:40:52.037

该问题已在最新版本的插件中得到解决。现在在回调中，您可以简单地执行以下操作：

```
this.rating('disable'); 
```

耶！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T18:43:03.780

这可能类似于您的“重新加载 div”解决方案，但我认为最好的解决方案可能是在完成 AJAX 请求后简单地禁用输入项。如果您使用的是 jQuery.ajax，您可以指定在请求完成后运行的回调函数。

```
jQuery.ajax({
    type: "POST",
    url: ...
    data: ...
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
        jQuery('.star').attr('disabled', true);
    },
    error: function(XMLHttpRequest, textStatus, errorThrown) {
        displayError();
    }
}); 
```

从他们的网站：

> 使用 disabled 属性将控件仅用于显示目的

```
<input name="star3" type="radio" class="star" disabled="disabled"/> 
<input name="star3" type="radio" class="star" disabled="disabled"/> 
<input name="star3" type="radio" class="star" disabled="disabled" checked="checked"/> 
<input name="star3" type="radio" class="star" disabled="disabled"/> 
<input name="star3" type="radio" class="star" disabled="disabled"/> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-21T15:19:46.547

我是该插件的作者，我刚刚（实际上只是）发布了一个新版本（3.1），应该可以解决您在这里讨论的问题。

@planetjones，请注意 this.rating('disable'); 与 this.rating('readOnly'); 不一样 this.rating('readOnly') 将阻止控件更改当前选择，而 this.rating('disable') 将阻止完全提交值。

@svinto，用于删除单选框的插件，但现在它隐藏了它们。为了恢复，您所要做的就是 1\. 删除星星 2\. 显示单选框 3\. 从单选框中删除插件的数据 - $().data('rating') 和 $().data( 'rating.star') 4\. 从单选框中取消绑定'change'事件

顺便说一句，更新将在这里公布：http: [//twitter.com/fyneworks](http://twitter.com/fyneworks)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T17:54:41.977

您真正想要的是将元素还原为单选按钮，然后添加只读，然后使它们再次看起来不错。恢复似乎是不可能的，但您可以取消绑定所有发布到服务器的事件。$("...").unbind();

# asp.net - 我应该在 Global.asax 还是在我的 404 错误页面上执行 301 重定向

> ID：578586
> 
> 赞同：2
> 
> 时间：2009-02-23T17:43:11.257
> 
> 标签：asp.net

我即将用一个全新的网站替换当前的电子商务网站。以前，产品的 URL 是这样的：www.example.com/ProductDetails.aspx?ProductID=123

现在是这样的：www.example.com/en-us/product/123/The-greatest-product-in-the-world

我的问题是：301 永久重定向应该在 Global.asax 的 Application_BeginRequest 事件中还是在我的 404 错误页面的 Page_Load 中完成？加载404时制作301还为时不晚吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T17:50:02.207

您需要在浏览器（或机器人）收到 404 错误之前执行此操作。这样，您可以确保搜索引擎机器人正确地重新索引您的产品页面以及与之相关的任何页面排名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T17:46:37.813

您应该将它放在 Application_BeginRequest 事件中并检查请求的 URL。

您也可以将它放在 Application_Error 事件中并检查 404，但我认为这会占用更多资源并且会更慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T20:09:27.567

我已经在 404 页面中完成了，但这是一个 hack——你可以更改响应代码。Application_BeginRequest 更有意义。您想要重定向，以便您的旧链接将从搜索索引中过期。

# security - 自动更新 - 什么是“足够的”安全性？

> ID：578588
> 
> 赞同：6
> 
> 时间：2009-02-23T17:44:32.080
> 
> 标签：security, deployment, auto-update

有几个问题（[C#](https://stackoverflow.com/questions/205830/c-windows-automatic-software-updates)、[Java](https://stackoverflow.com/questions/305461/automatic-updates-of-java-desktop-application)）涵盖了如何实现自动更新。最初提供自动更新似乎很容易，而且似乎没有充分的理由不为大多数软件提供自动更新。

但是，似乎没有一个涵盖自动更新的安全方面。

*   现在自动更新有多安全？
*   它们应该有多安全？
*   他们能有多安全？

我的主要问题是，无论出于何种意图和目的，互联网都是一个狂野的西部，人们无法对他们收到的任何数据做出任何假设。通过 Internet 进行自动更新似乎存在固有风险。

公司计算机被感染，欺骗 DNS（只有一小部分获胜），并使其他公司计算机相信通用应用程序的更新服务器在其他地方，他们下载“新”应用程序并被感染。

**作为开发人员，存在哪些可能的攻击，我应该采取哪些措施来保护我的客户免受滥用？**

-亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T17:59:12.527

通过正确使用密码学，您的更新可以非常安全。使用 SSL 保护您从中分发更新的站点。使用 GPG/PGP 或其他方式签署所有更新，让您的客户在应用更新之前验证签名。采取措施确保您的服务器和密钥非常安全。

*足够*，是非常主观的。对于网络游戏来说足够了，对于我们的核导弹的安全系统来说可能完全不够。如果有人设法破坏了您的安全，您必须确定可能会造成多大的潜在损害。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T17:49:48.383

最明显的攻击是攻击者通过他的“邪恶”更新服务器提供更改的二进制文件。因此，您应该确保可以使用数字签名验证下载的数据是否来自您。

为了确保安全，显然您应该避免分发签名密钥。因此，您可以实现[RSA 消息签名的一些变体](http://en.wikipedia.org/wiki/RSA#Signing_messages)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T18:05:48.737

通过 SSL 连接到您的更新服务器就足够了，只要您的客户端在获得无效证书时将拒绝连接，并且您的服务器需要协商合理的连接安全级别（并且客户端也支持）。

然而实际上，您所做的几乎任何事情都至少与您的用户首次安装您的软件的路径一样安全。如果您的用户最初通过纯 http 下载您的安装程序，那么开始保护更新内容为时已晚。

即使他们通过 https 或数字签名获得您的初始软件，这在某种程度上也是如此 - 因为大多数用户很容易被说服点击他们看到的几乎所有安全警告上的确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T18:12:49.420

*似乎没有充分的理由不为大多数软件提供自动更新。*

有充分的理由不强制更新。

1.  错误修复可能会破坏代码
2.  用户可能不想冒险破坏依赖旧功能的生产系统

# c# - Castle Windsor：我的瞬态组件会被垃圾回收吗？

> ID：578593
> 
> 赞同：6
> 
> 时间：2009-02-23T17:45:50.280
> 
> 标签：c#, .net, castle-windsor, transient

使用 Castle Windsor，我有一个配置了短暂生活方式的组件：

```
<component id="publish.mapping.default"
                   service="IMyService, MyAssembly"
                   type="MyServiceImplementation, Myassembly" 
                   lifestyle="transient" /> 
```

这将像这样使用：

```
var service = container.Resolve<IMyService>(componentId);
// service usage ....
// service goes out of scope ... 
```

我的问题是，服务实例在超出范围后会被垃圾收集，还是 Castle Windsor 会保留引用？我发现[了这个类似的问题](https://stackoverflow.com/questions/132940/why-does-castle-windsor-hold-onto-transient-objects)，这意味着后者可能是这种情况-但是在检查了那里发布的链接之后，我不确定讨论是关于保持引用，还是关于确保对象在实现 IDisposable 时被释放. 我的对象不需要被处置。

如果 Castle Windsor 保留该实例，是否有任何简单的方法可以防止这种情况（可能通过配置）？

**编辑**
看来，我需要设置发布跟踪政策。这可以在 xml 配置文件中配置，还是需要在代码中设置？是否可以按组件设置发布跟踪策略？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T18:09:42.207

默认情况下，容器包含对您的对象（甚至是临时对象）的引用。

然而，正如@Bittercoder 在[温莎城堡为什么会保留瞬态物体？](https://stackoverflow.com/questions/132940/why-does-castle-windsor-hold-onto-transient-objects)，您可以[更改发布跟踪策略](https://github.com/castleproject/Windsor/blob/aa9b8b353ee2e533d586495eec254e216f800c09/docs/release-policy.md)。似乎选择

`LifecycledComponentsReleasePolicy`：

```
var policy = container.Kernel.ReleasePolicy;
container.Kernel.ReleasePolicy = LifecycledComponentsReleasePolicy; 
```

但自从提出问题以来，这似乎已成为默认策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T17:40:20.793

需要注意的一件事是，这似乎已在 Castle Trunk 中修复。在 r5475 中，Hammett 将 MicroKernel 中的默认发布策略更改为 LifecycledComponentsReleasePolicy。

# internet-explorer - 我应该为 Internet Explorer 8 开发吗？

> ID：578605
> 
> 赞同：4
> 
> 时间：2009-02-23T17:49:35.310
> 
> 标签：internet-explorer, internet-explorer-8

我想将它安装在我的开发机器上以备不时之需。但我担心介于两者之间的项目不会是正确的，并且应用程序测试起来会很麻烦。我正在使用 VWD 2008 Express。也不确定是否使用 RC1。

谢谢。

编辑：

这是针对我知道只有 IE 的 Intranet。再次感谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-23T17:56:29.523

您**永远不应该****为**浏览器开发，但您应该**使用**它进行测试。Internet Explorer 8 处于候选发布状态，这意味着最终版本将始终如一地呈现（除非出现任何明显错误）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T17:55:50.710

是的，我认为您应该开始将 IE 8 包含到您的测试中，因为与以前的渲染引擎有一些显着差异。

但是，我建议您在虚拟机上安装任何正在开发的浏览器（或不属于您的核心测试的浏览器）。

另一方面，您还应该将 Chrome 纳入您的测试，因为它正在获得大量采用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T17:53:13.663

您可以使用虚拟机来完成此操作。您可以使用 VirtualPC 或 VMWare 或其他任何东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T17:56:36.230

这取决于您想要接触的受众。

如果您的受众是早期采用者类型，并且可能使用 IE8，那么是的 - 您应该在开发时牢记这一点。

您可能还想同时为其他浏览器进行开发——同样，这取决于您的受众的期望。

测试很麻烦的事实不应该是这里的决定因素。根据您的市场需求做出决定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T17:55:39.713

您需要选择要开发的浏览器，并为每个目标都配备虚拟机（或使用在各种机器上返回图像的服务）。

MSIE 8 也不例外 - 您必须有一个测试平台。

至于它是否属于您的开发机器本身应该取决于其他因素，例如它是否可以帮助您更好地开发，不会干扰您的其他工作/软件，以及您是否希望它成为您的“默认”目标 - 即，您希望大多数客户使用的东西。

-亚当

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T04:15:11.860

不幸的是，现在还没有办法同时安装 IE7 和 IE8——人们试图开发像旧的 MultipleIE 应用程序这样的技巧，但据我所知，他们还没有走得太远。

如果您必须有能力和时间在单独的（可能是虚拟的）机器上安装和测试 IE8，那么我认为您现在应该开始使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T05:10:17.640

不幸的是，在我看来，目前状态下的 IE8 存在太多错误，无法在这一点上认真探索互操作问题。您比我更了解您的受众。至少建议您通过尝试解决 IE8 的许多渲染怪癖中的任何一个，在您继续进行时，保持创建更多问题的潜力。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-27T10:13:28.730

如果是其他浏览器，我会说：这取决于。

您必须记住，许多新系统很快将与 IE 8 捆绑在一起。此外，IE 8 升级将通过 Windows 更新提供。

鉴于 IE 7 取代 IE 6 成为最流行版本的速度（大约 14 个月内），您应该将 IE 8 纳入您的路线图，如果不是立即添加到开发人员系统和测试计划中的话。

# sql-server - 在 MS SQL Server 中将日期存储为整数是否有任何性能优势

> ID：578607
> 
> 赞同：3
> 
> 时间：2009-02-23T17:49:54.373
> 
> 标签：sql-server, sql-server-2005

无论是在空间还是查询速度和字段比较方面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T17:54:07.873

日期时间列已作为 8 字节二进制值存储在 SQL Server 中——日期部分为 4 个字节，时间部分为 4 个字节。您看到的任何其他表示只是使它们更具人类可读性的视图。

如果您知道您不需要完整的值范围（例如，假设您不关心时间部分并且不使用 2008 年），那么使用整数可能会做得更好。但我真的怀疑你会注意到除了最大和最繁忙的表之外的所有性能差异。

与往常一样，您需要进行概要分析才能确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T17:57:48.287

使用整数，您还需要有代码来确保它确实是一个日期，而不是 20090230 被插入如果您在 SQl 服务器 2008 上，您可以使用仅使用 3 个字节的 DATE 数据类型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T17:57:56.960

MS SQL 2008 可以分别存储具有列类型的日期和时间。为什么要麻烦使用int。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T18:04:57.163

将日期存储为整数将是一件坏事，因为您总是必须将数据重新创建为日期才能进行日期数学运算或日期比较。这会对性能产生负面影响。此外，将日期存储为整数将需要编写触发器以确保不会将非日期添加到字段中。如果您不这样做，您将遇到日期完整性问题，因为您的字段中存储了无效日期，例如 2302009。

# delphi - Delphi 2009 应用程序使用 Vista 的大图标

> ID：578612
> 
> 赞同：5
> 
> 时间：2009-02-23T17:51:08.850
> 
> 标签：delphi, windows-vista, delphi-2009

我想在我的 Delphi 2009 应用程序中使用 Vista 大图标功能，但我只能在我的应用程序中嵌入普通的 32x32 图标。如何使应用程序具有多种尺寸的图标？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T20:28:08.457

去下载[IcoFX](http://icofx.ro/)。它是免费的，可以处理多种尺寸/颜色深度和适当的 alpha 混合。使用它来创建您的 ICO 文件，然后将 ICO 添加到您的项目中。无法详细介绍 2009 年加载 ICO 的步骤，因为我一直在使用 Delphi 7...

如果有什么安慰的话，Visual Studio 也花了很长时间才接近像样的图标编辑。

嘿，谁记得 Borland 资源研讨会？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T19:59:04.393

我会使用一个图标编辑器，例如[AWIcons](http://www.awicons.com/iconeditor/)，它允许您创建一个包含许多不同格式的图标。然后，Windows 将根据当前视图和颜色深度决定使用哪个图标。

一旦您创建了具有多种不同嵌入格式的 SINGLE 图标，只需像链接 32x32 图标一样链接它。它在 IDE 中可能看起来很有趣，但是当您运行该程序时，它看起来会正确。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T14:37:45.443

获取大量图标，或制作自己的图标。我使用[Icon Experience](http://www.iconexperience.com)中的图标库- 您付费，但所有 16x16 到 256 x 256 的图标尺寸均以 ICO 和 PNG 格式提供。然后我使用[Icon Sushi](http://www.towofu.net/soft/e-aicon.php)来处理我自己的图标。Delphi 7 和 2009 在处理大图标时都有限制，所以我已经开始使用 PNG 组件库来使用 PNG 图标。这为您提供了一个 TPNGImageList，它仅适用于 Vista 缓存和其他问题使得使用 TImageList 仅适用于 16x16 和 32x32 尺寸的情况。我还将 PNGComponents 移植到 D2009，它可以正常工作。布赖恩

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T07:10:04.910

> 我只能在我的应用程序中嵌入普通的 32x32 图标

根据我的经验，Delphi 2009 允许您使用任何图标。我也使用过超大的 Vista 图标，而且效果很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-30T23:55:56.563

**解决方案：**

有一种**更好更简单**的方法可以在 Delphi 7 应用程序中添加高分辨率图标。它不涉及破解您的 exe 文件： [http ://thesunstroke.blogspot.com/2010/10/how-to-add-high-resolution-icons-to.html](http://thesunstroke.blogspot.com/2010/10/how-to-add-high-resolution-icons-to.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T23:13:18.380

如果您想要一些免费软件来创建图标，那么您可以使用[GIMP](http://gimp.org/downloads/)。我的第一个视频教程是使用 GIMP 创建图标 - 可[在此处](http://codegearguru.com/index.php?option=com_content&task=view&id=12&Itemid=27)获得。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-12T18:48:35.910

将项目配置为使用 Microsoft 资源编译器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-21T22:30:53.583

完成项目构建后，在构建后步骤中使用资源编辑器添加项目所需的所有图标，如下所述：[http ://www.heaventools.com/rtconsole-sample-script-guide.htm](http://www.heaventools.com/rtconsole-sample-script-guide.htm)

# c# - 如何打印支票？

> ID：578616
> 
> 赞同：4
> 
> 时间：2009-02-23T17:53:26.457
> 
> 标签：c#, .net, printing

我需要编写一个 .NET 库来打印支票。没什么特别的：你传入数据，打印出来的支票就出来了。最好的方法是什么？

约束：支票的格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T17:56:54.343

很多人为此使用报告生成器。这有点矫枉过正，但水晶报告肯定会完成这项工作。

除此之外，这是一个关于格式化打印输出的基本问题。这是你的意图吗？

* * *

查看 printdocument 类，您可以自己执行此操作：

[http://msdn.microsoft.com/en-us/magazine/cc188767.aspx](http://msdn.microsoft.com/en-us/magazine/cc188767.aspx)

* * *

如果您要远程打印支票（即，您需要在网站上提供用户可以打印的支票），那么使用 PDF 是完成此操作的最简单和最确定的方法，但要注意安全隐患。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T18:04:58.660

哇......这让我回来了！在过去的打印机中，点阵并检查连续进纸的位置。我想现在的支票是预先印好的单张纸，并用激光/喷墨打印。那时我们只需将纯 ascii 写入打印机并发送打印机特定的控制/转义序列以满足任何特定的格式需求（选择字体大小、行距和页面大小）。

现在我想尝试生成 PDF，然后提交该文件进行打印。用纯文本文件也可以做到这一点......尽管这已经非常接近老派了。Adam 的报告生成器建议也是一个不错的主意。

通常，使用支票打印，要获得正确的格式，需要进行大量的试验和错误。在普通纸上打印并握住它并将预先打印的支票放在窗口上是一种检查位置的简单方法，而不会烧毁大量支票。

不过要注意的一件事是，是否需要跟踪预印在支票上的控制编号（又称支票编号）。审计师有时会要求这样做，这也是防止欺诈的合理措施（对每张预印支票进行会计处理并不是一个糟糕的主意）。为此，您需要处理重印，并将个别支票/支票标记为“已损坏”。您还需要一个手动流程来收集和存储损坏的支票（供审计员使用）。总的来说，要做到这一点是一个巨大的痛苦，而且可能需要比你想象的更多的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T17:57:28.523

除非您*真的*有野心，否则您订购预印支票并查看支票模板。填空你就在那里。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-02-23T17:58:50.297

由于格式相当固定，但您可以创建一个包含格式的 Word 文档，然后以编程方式插入正确的信息并打印出来

**编辑**

哇，很反MS吧？您可以使用 Words 的全部功能来直观地设置检查的格式，并且有一些库可以在 .net 中修改 Word 文档，所以我不明白为什么这不是一个巧妙的解决方案

# python - 如何在 Python 中通过 ref 传递值？

> ID：578635
> 
> 赞同：3
> 
> 时间：2009-02-23T17:58:20.983
> 
> 标签：python, variables, pass-by-reference

基本上我使用的是应用程序的 C++ API，但没有关于它的 python 访问的参考。一个变量由 ref 传递，如下所示：

```
GetPoint ( Point  &p, Object obj ) 
```

那么我怎样才能翻译成 Python 呢？是否有通过 ref 符号？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T18:00:41.370

Python 中没有按引用传递的符号。

只需修改传入点，您的修改将从调用函数中可见。

```
>>> def change(obj):
...     obj.x = 10
...
>>> class Point(object): x,y = 0,0
...
>>> p = Point()
>>> p.x
0
>>> change(p)
>>> p.x
10 
```

...

> 所以我应该像这样传递它：GetPoint（p，obj）？

是的，尽管[Iraimbilanja](https://stackoverflow.com/questions/578635/how-to-pass-values-by-ref-in-python/578651#578651)有一个很好的观点。绑定可能已更改调用以返回该点，而不是使用 out 参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T18:02:48.913

您的 Python 绑定可能已将该签名转换为：

```
Point GetPoint(Object obj) 
```

甚至：

```
Point Object::GetPoint() 
```

因此，请查看绑定的文档或来源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T18:01:43.380

我很确定 Python 会将引用的值传递给变量。[这篇文章](http://rg03.wordpress.com/2007/04/21/semantics-of-python-variable-names-from-a-c-perspective/)可能比我解释得更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T18:02:10.540

在 Python 中，对象总是作为引用传递。所以包裹在对象中会产生类似的效果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T18:04:21.767

python 中没有按符号引用 - 正确的做法取决于您的 API。要问自己的问题是谁拥有从 C++ 传递给 python 的对象。有时，最简单的方法是将对象复制到 python 对象中，但这可能并不总是最好的做法。

您可能对 boost.python 感兴趣[http://www.boost.org/doc/libs/1_38_0/libs/python/doc/index.html](http://www.boost.org/doc/libs/1_38_0/libs/python/doc/index.html)

# iphone - 在操作表完全关闭之前呈现模态视图

> ID：578638
> 
> 赞同：0
> 
> 时间：2009-02-23T17:59:09.127
> 
> 标签：iphone, objective-c, cocoa-touch

有没有办法在完全关闭操作表之前呈现模态视图控制器视图？我正在尝试在这里执行此操作，但似乎回调必须在模态视图出现之前完成：

```
- (void)actionSheet:(UIActionSheet *)actionSheet didDismissWithButtonIndex:(NSInteger)buttonIndex
{   
    if (0 == buttonIndex) {     // clicked 'Are you sure?' button
        [self splashScreen:YES];
... 
```

然后我基本上是这样做的：

[[AppDelegate tabBarController] presentModalViewController:self.TMX_splashViewController 动画：YES];

我的问题是我想回答“你确定吗？” 操作表中的按钮，然后在我做一些工作（进行批量上传）时在我的模态视图控制器中显示进度指示器。但似乎行动表妨碍了;)

解决方案：我在展示模态视图控制器之前稍作延迟。不确定我是否完全理解这一点，但似乎存在某种竞争条件，其中工作代码块会“领先于”模态表示代码。在稍作延迟后，它似乎起作用了。嗯，这很奇怪！

```
[self splashScreen:YES];                
NSTimer *timer;
timer = [NSTimer scheduledTimerWithTimeInterval:0.75
        target: self selector:@selector(waitForSplashTimer:) userInfo: nil repeats: NO]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T19:37:15.270

你也可以使用 -performSelector:withObject:afterDelay:，它的代码少一点，而且更容易阅读：

```
[self performSelector: @selector(waitForSplashTimer:) withObject: nil afterDelay: 0.75]; 
```

# vb.net - Appbase 在运行时被设置为空

> ID：578641
> 
> 赞同：1
> 
> 时间：2009-02-23T17:59:46.940
> 
> 标签：vb.net, visual-studio-2005

在大约 20 个用户安装中，我很难重现错误。这是一个 .net Windows 应用程序，在 XP 上运行的 VB.Net 中的 2005。打开一个窗口后，我们得到一个错误：

```
无法加载文件或程序集“Infragistics2.Win.UltraWinChart.v8.2，
 版本=8.2.20082.1000，文化=中性，PublicKeyToken=7dd5c3163f2cd0cb' 或其之一
依赖关系。未找到元素。（HRESULT 异常：0x80070490） *****ClearTrac *****
   在 ClearTrac.ucNav.InitializeComponent()
   在 ClearTrac.ucNav..ctor()
   在 ClearTrac.frmPortfolio.InitializeComponent() ...
```

ReportViewer dll 和其他几个基础设施 dll 也会发生这种情况。我打开了 Bind Logging，第一次绑定没问题，但是当我收到错误消息时，Appbase 已设置为空白：

```
*** 装配活页夹日志条目（2/20/2009 @ 3:41:10 PM）***

操作失败。
绑定结果：hr = 0x80070490。未找到元素。

程序集管理器从以下位置加载：c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorwks.dll
在可执行文件 C:\Documents and Settings\rdelaney\Local Settings\Apps\2.0\ZZ09GJK6.2VY\GPRTP6CM.GOX\clea..tion_8055aae51715540e_0001.0004_0a540274bbdc609c\ClearTrac.exe 下运行
--- 详细的错误日志如下。

=== 预绑定状态信息 ===
日志：用户 = CAM\rdelaney
日志：DisplayName = Microsoft.ReportViewer.WinForms，版本 = 8.0.0.0，文化 = 中性，PublicKeyToken = b03f5f7f11d50a3a
 （完全指定）
日志：应用程序库 =
日志：初始 PrivatePath = NULL
日志：动态基础 = NULL
日志：缓存基础 = NULL
日志：AppName = ClearTrac.exe`
调用程序集：ClearTrac，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null。
===
LOG：此绑定在默认加载上下文中开始。
日志：使用应用程序配置文件：C:\Documents and Settings\rdelaney\Local Settings\Apps\2.0\ZZ09GJK6.2VY\GPRTP6CM.GOX\clea..tion_8055aae51715540e_0001.0004_0a540274bbdc609c\ClearTrac.exe.config
LOG：使用来自 c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config 的机器配置文件。
ERR：预下载检查期间发生不可恢复的错误（hr = 0x80070490）。

```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T21:42:23.633

我们发现此错误仅在安装了 SP1 或 SP2 的 .net Framework 下发生。安装了裸 .net 框架 2.0 后，它不会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T18:07:11.557

您应该检查有问题的计算机上的 Microsoft.ReportViewer.WinForms 是否在 GAC 或应用程序目录中。

如果不是，您应该在有问题的计算机上安装 Microsoft Report Viewer Redistributable。

[http://www.microsoft.com/downloads/details.aspx?FamilyID=cc96c246-61e5-4d9e-bb5f-416d75a1b9ef&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=cc96c246-61e5-4d9e-bb5f-416d75a1b9ef&displaylang=en)

# c# - 在 Returns() 中组装值时访问 Expect() 的原始参数

> ID：578653
> 
> 赞同：21
> 
> 时间：2009-02-23T18:03:13.780
> 
> 标签：c#, moq

在组装 Returns 对象时，是否可以访问用于调用模拟期望的参数？

这是所涉及对象的存根，鉴于此，我正在尝试模拟一个集合：

```
Class CollectionValue {
    public Id { get; set; }
}
Class Collection {
    private List<CollectionValue> AllValues { get; set; }
    public List<CollectionValue> GetById(List<int> ids) {
        return AllValues.Where(v => ids.Contains(v.Id));
    }
} 
```

给定一个将用于模拟对象的 CollectionValues 测试列表，如何设置一个期望来处理该 CollectionValues 列表中所有可能的 ID 排列，包括组合现有 ID 和不存在 ID 的调用? 我的问题来自于希望在一次通话中设置所有可能的期望；如果无法访问原始参数，我可以很容易地设置我想要在每次给定调用中测试的确切期望。

这就是我希望做的，在哪里“？？？” 表示可以方便地访问用于调用 GetById 的参数（限定 It.IsAny 限制的参数）：

```
CollectionMock.Expect(c => c.GetById(It.IsAny<List<int>>())).Returns(???); 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-06-02T19:49:15.923

从起订量[快速入门](https://github.com/Moq/moq4/wiki/Quickstart)指南：

```
// access invocation arguments when returning a value
mock.Setup(x => x.Execute(It.IsAny<string>()))
                .Returns((string s) => s.ToLower()); 
```

因此，这表明您可以填写您的 ??? 作为

```
CollectionMock.Expect(c => c.GetById(It.IsAny<List<int>>()))
              .Returns((List<int> l) => //Do some stuff with l
                      ); 
```

# c++ - 静态常量类成员

> ID：578654
> 
> 赞同：0
> 
> 时间：2009-02-23T18:04:17.007
> 
> 标签：c++

考虑以下代码段：

```
struct Foo
{
    static const T value = 123; //Where T is some POD-type
};

const T Foo::value; //Is this required? 
```

在这种情况下，标准是否要求我们在翻译单元中显式声明**值？**看来我有相互矛盾的信息；boost 和 STL 中的 numeric_limits 之类的东西似乎就像在我的代码片段中一样。

OTOH，我记得在某处（尽管很久以前）读到您仍然需要在翻译单元中提供声明。

如果是这种情况，那么模板专业化呢？每个专业都需要声明吗？

感谢您对“正确方法”的评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T18:09:47.807

*如果您使用*value 变量，您也必须在翻译单元中提供*定义。*这意味着，例如，如果您读取它的值。

 *重要的是，如果您违反该规则，编译器不需要给出警告或错误。该标准规定违规“无需诊断”。

在下一个 C++ 标准版本中，规则发生了变化。用作常量表达式时*不*使用变量。简单地在类中直接初始化变量的地方读取*值*意味着那时仍然不需要定义。

请参阅标准的`use`in 部分`3.2 One Definition Rule`的定义和静态数据成员定义的要求`9.4.2, paragraph 4 and 5`（在 C++98 标准中。出现在下一个标准的 n2800 草案的第 3 和第 4 段中）。

**更正：** c++03 的规则已更改：如果变量出现在需要整数常量表达式的位置，则不需要定义（引用 2003 更新的非官方修订列表），请参阅[此语言缺陷报告](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#48)的解决方案：

> 一个表达式可能会被计算，除非它出现在需要整数常量表达式的地方（见 5.19），是 sizeof 运算符（5.3.3）的操作数，或者是 typeid 运算符的操作数并且表达式没有指定左值多态类类型（5.2.8）...

请注意，即便如此，许多用途是在不需要积分常数的情况*下*。一种情况是在数组维度或模板元编程中。所以严格来说（见[这个报告](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#454)），只有 c++1x 解决方案提供真正的保证，在明显的情况下，也像`"s == string::npos"`不需要整数常量的情况下*不需要*静态成员的定义，因为下一个标准有不同的， 3.2 更好的措辞。然而，这是相当理论的东西，因为大多数（全部？）编译器无论如何都不会抱怨。感谢评论区的小哥告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T18:14:38.997

从我的 n2798 副本中补充 litb 所说的内容：

> **9.4.2**
> 
> [...]
> 
> 2 在其类定义中声明的静态数据成员不是定义，并且
> 可能是除 cv 限定的 void 之外的不完整类型。静态
> 数据成员的定义应出现在包含该成员的类定义的命名空间范围内。在命名空间范围的定义中，静态数据成员的名称应使用 :: 运算符由其类名限定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T18:34:14.580

如果您不以某种方式使用**静态整数常量成员**（例如，获取此类成员的地址），则不必为它们提供定义。请参阅 Stroustrup 的*C++ 编程语言*，第 10.4.6.2 节。

Edit: Oops, I just re-read the question, and the question was for some type T. In general you would need to provide a definition, I agree. But if you used something from the int family, you wouldn't necessarily have to (with the caveat above).

# php - 处理进入数据库的大文本字符串的最佳方法是什么？

> ID：578662
> 
> 赞同：1
> 
> 时间：2009-02-23T18:05:40.873
> 
> 标签：php, database, formatting, string

过去我已经构建了许多解决方案，人们通过网络表单输入数据，应用验证检查，在某些情况下使用正则表达式，所有内容都存储在数据库中。然后，此数据用于驱动其他页面上的输出。

我在这里有一个特殊情况，用户想要复制/粘贴大量文本（具有各种标题、链接等的多个段落）——在它进入数据库之前处理这个问题的最佳方法是什么？当它需要回来时输出？

到目前为止，我想出的最好的方法是将这些字段的所有输出粘贴在 PRE 标记中，并使用正则表达式在适当的地方添加链接。我有一个数据库，其中包含一个特殊关键字列表，这些关键字需要加粗或应用其他样式，效果很好。所以我可以*使用*这些方法完成这项工作，但在我看来，可能有一种更优雅的方式来做这件事。

*   尼古拉斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T18:39:39.340

有很多方法可以格式化输出的文本。您可以简单地使用`pre`您提到的标签（如果您担心包装，CSS[`white-space`](http://www.w3.org/TR/CSS21/text.html#white-space-prop)属性也支持该`pre-wrap`值，但浏览器对此的支持目前充其量是粗略的）。

还有大量的标记语言可以用于更高级的格式化选项（其中一些在[此处](http://en.wikipedia.org/wiki/List_of_lightweight_markup_languages)列出）。Stack Overflow 本身使用[Markdown](http://daringfireball.net/projects/markdown/)，我个人非常喜欢使用它。

但是，由于数据是从另一个来源粘贴的，标记语言可能会干扰文本的格式 - 在这种情况下，您可以推出自己的解决方案，也许使用正则表达式和函数，如[`htmlentities`](http://php.net/htmlentities)and [`nl2br`](http://php.net/nl2br)。

无论您决定如何，我都建议您将输入以其原始形式存储在数据库中，以便您可以随时追溯修改您的格式化例程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T19:38:04.410

如果您期待大量的格式化，您可能应该使用 WYSIWYG 编辑器。这些编辑器生成类似单词的工具栏，这些工具栏生成（希望）有效的 (x)html 标记，可以直接存储到数据库中的文本字段中。这里有几个例子：

[FCKeditor](http://www.fckeditor.net/) - 大量的选项/工具

[Tinymce](http://tinymce.moxiecode.com/) - 一个不错的选择。

[Markdown](http://daringfireball.net/projects/markdown/) - stackoverflow.com 使用什么

FCKeditor 和 Tinymce 都经过了彻底的测试，并被证明是可靠的。我没有任何降价经验，但它似乎很可靠。

我一直讨厌像 [code]、[link] 等“论坛”格式的标签。Stackoverflow 和其他人已经证明，提供一个开放的 wysisyg 编辑器是安全、可靠且非常易于使用的。只需获取它给您的输出，通过某种转义函数运行它以检查任何类型的注入、xss 等，然后存储在文本字段中。

# php - PHP PDO 缓冲查询问题

> ID：578665
> 
> 赞同：7
> 
> 时间：2009-02-23T18:06:36.300
> 
> 标签：php, mysql, pdo

我在使用 PHP 数据对象函数时遇到了一些严重问题。我正在尝试使用缓冲查询遍历一个相当大的结果集（~60k 行，~1gig）以避免获取整个结果集。

无论我做什么，脚本都挂在 PDO::query() 上 - 似乎查询正在无缓冲运行（为什么结果集大小的变化会“解决”问题？）。这是我重现问题的代码：

```
<?php
$Database = new PDO(
    'mysql:host=localhost;port=3306;dbname=mydatabase',
    'root',
    '',
    array(
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
        PDO::MYSQL_ATTR_USE_BUFFERED_QUERY => true
    )
);

$rQuery = $Database->query('SELECT id FROM mytable');

// This is never reached because the result set is too large
echo 'Made it through.';

foreach($rQuery as $aRow) {
    print_r($aRow);
}
?> 
```

如果我用一些合理的数量限制查询，它工作正常：

```
$rQuery = $Database->query('SELECT id FROM mytable LIMIT 10'); 
```

我尝试过使用 PDO::MYSQL_ATTR_MAX_BUFFER_SIZE 并使用 PDO::prepare() 和 PDO::execute() （尽管上述查询中没有参数），但都无济于事。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T18:39:10.327

如果我理解这一点，缓冲查询涉及告诉 PHP 您想在开始处理之前等待整个结果集。在 PDO 之前，这是默认设置，[`mysql_unbuffered_query`](http://us.php.net/manual/en/function.mysql-unbuffered-query.php)如果您想立即处理结果，则必须调用。

为什么这在 PDO MySQL 驱动程序页面上没有解释，我不知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T18:35:09.960

您可以尝试将其拆分为不足以引起问题的块：

```
<?php    
$id = 0;
$rQuery = $Database->query('SELECT id FROM mytable ORDER BY id ASC LIMIT 100');

do {
    stuff($rQuery);
    $id += 100;
} while ( $rQuery = $Database->query(
            'SELECT id FROM mytable ORDER BY id ASC LIMIT 100 OFFSET '.$id
          )
        );
?> 
```

......无论如何，你明白了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-23T19:47:19.287

或者，也许您可​​以尝试使用 mysql 函数：

```
while ($row = mysql_fetch_row($query)) {
...
} 
```

这肯定会更快，因为该 foreach 语句给人的印象是使用`fetchAll()`每一`fetch()`行

# algorithm - 如何输出代码本身？

> ID：578670
> 
> 赞同：0
> 
> 时间：2009-02-23T18:09:20.473
> 
> 标签：algorithm, quine

有多少种方法可以让代码自己输出？

例如，编写下面的代码，

```
public class Test
{
   public static void main(String[] args)
   {
      // some code
   }
} 
```

输出自己

```
public class Test
{
   public static void main(String[] args)
   {
      // some code
   }
} 
```

（接受任何编程语言）

编辑这个问题已在历史帖子中得到解答，搜索“quine”或查看[https://stackoverflow.com/search?q=quine](https://stackoverflow.com/search?q=quine)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-23T18:11:27.223

这被称为编程 quine，并已在 SO 上进行了广泛讨论：

[https://stackoverflow.com/search?q=quine](https://stackoverflow.com/search?q=quine)

另见

[http://en.wikipedia.org/wiki/Quine_(计算)](http://en.wikipedia.org/wiki/Quine_(computing))

[http://www.nyx.net/~gthompso/quine.htm](http://www.nyx.net/~gthompso/quine.htm)

[http://www.madore.org/~david/computers/quine.html](http://www.madore.org/~david/computers/quine.html)

-亚当

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T18:10:59.550

查查[奎因斯](http://en.wikipedia.org/wiki/Quine_(computing))。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T18:11:53.213

您想阅读有关 quines 的信息。见[这里](http://en.wikipedia.org/wiki/Quine_(computing))。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T18:12:59.233

[http://en.wikipedia.org/wiki/Quine_(计算)](http://en.wikipedia.org/wiki/Quine_(computing))

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T18:12:32.697

[http://en.wikipedia.org/wiki/Quine_(计算)](http://en.wikipedia.org/wiki/Quine_(computing))

[http://www.nyx.net/~gthompso/quine.htm](http://www.nyx.net/~gthompso/quine.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T18:15:48.040

这个问题不是[已经问了](https://stackoverflow.com/questions/105725/how-to-write-a-self-reproducing-code-prints-the-source-on-exec)吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T18:19:42.370

有无数种方法可以做到这一点。您所要做的就是找到一种方法，然后添加评论......

# visual-studio - 在 Visual Studio 2008 中分配鼠标按钮

> ID：578675
> 
> 赞同：10
> 
> 时间：2009-02-23T18:10:33.983
> 
> 标签：visual-studio, visual-studio-2008, mouse, button

有谁知道如何将额外的鼠标按钮绑定到 Visual Studio 2008 中的命令？曾经有一个“powertoy”可以让你为 Visual Studio 2003 做到这一点，但我找不到 2008 年的等价物。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T23:30:10.220

虽然 AutoHotKey 很有趣，但它并没有真正做我想做的事情，即在特定于应用程序的上下文中将按钮映射到键。

我最终找到了这个加载项： http: [//www.codeproject.com/KB/macros/MouseNavi.aspx](http://www.codeproject.com/KB/macros/MouseNavi.aspx)

我刚刚修改并放入 Visual Studio 的 AddIns 目录。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T19:06:36.453

[自动热键](http://www.autohotkey.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T16:55:01.387

对于仍在寻找适用于任何版本的 Visual Studio（就像我一样）的解决方案的人，我找到了[X-Mouse Button Control](http://www.highrez.co.uk/downloads/XMouseButtonControl.htm)。

您可以将您的命令映射到您喜欢的任何键盘快捷键，然后使用 X-Mouse Button Control 将这些击键仅发送到 devenv.exe。

首先，您必须为 devenv.exe 添加应用程序配置文件。然后，要映射击键，只需在所需鼠标按钮旁边的下拉框中选择“模拟键”。按照提示设置击键，一切就绪。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T18:50:31.750

[MSDN](http://code.msdn.microsoft.com/VSMouseBindings)

# eclipse - 从 Eclipse 3.3 升级到 3.4（或未来版本）的最佳方式是什么

> ID：578676
> 
> 赞同：11
> 
> 时间：2009-02-23T18:10:38.303
> 
> 标签：eclipse, process

过去，我在从 Eclipse 版本升级到另一个版本时遇到问题。我想知道 StackOverflow 上的 Eclipse 用户是如何处理从一个版本到另一个版本的 Eclipse 升级的。

*   使用 Distro 是解决方案吗？
*   停留在过去的发布点，直到您被迫前进，这是个好主意吗？

最近我刚刚从头开始重新加载；重命名我的根 Eclipse 目录并下载最新版本，以及更新周期。使用此方法后，我只丢失了工作区（没有丢失代码）。

提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-23T18:20:13.227

我通常只是将旧的重命名为 eclipse3.3 之类的东西，然后在同一个地方安装新的。由于很多插件通常会因新版本而中断，根据我的经验，我发现这样做然后重新安装我的插件是最简单的解决方案。工作空间本身很少有任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-14T06:07:13.080

从 Eclipse 3.5 开始，应该可以就地更新到新的主要版本……但前提是更新将为您提供干净/有效的安装。

要使其工作，您需要的关键是为新的 Eclipse 版本添加更新站点。我见过的最全面的更新列表位于[http://ekkescorner.wordpress.com/eclipse/update-sites/](http://ekkescorner.wordpress.com/eclipse/update-sites/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-20T23:24:10.960

阅读这个日食[常见](http://wiki.eclipse.org/FAQ_How_do_I_upgrade_Eclipse%3F)问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T18:20:04.020

我总是使用内置的更新系统。转到帮助 -> 软件更新

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-14T09:56:35.707

我[按需使用 Yoxos](http://eclipsesource.com/en/yoxos/yoxos-ondemand/)。我发现以这种方式升级更容易。它允许您选择所需的插件，然后自动解决依赖关系。这样我就可以快速构建一个新的 Eclipse 版本，其中包含旧版本的所有功能，而且麻烦更少。

# python - 替代 'for i in xrange(len(x))'

> ID：578677
> 
> 赞同：9
> 
> 时间：2009-02-23T18:10:52.530
> 
> 标签：python, for-loop, anti-patterns

所以我在[另一篇文章](https://stackoverflow.com/questions/576988/python-specific-antipatterns)中看到了下面的“坏”片段，但我看到的唯一选择涉及修补 Python。

```
for i in xrange(len(something)):
  workwith = something[i]
  # do things with workwith... 
```

我该怎么做才能避免这种“反模式”？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-23T18:14:59.790

如果您需要知道循环体中的索引：

```
for index, workwith in enumerate(something):
    print "element", index, "is", workwith 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-23T18:12:36.207

见[Pythonic](http://docs.python.org/glossary.html#term-pythonic)

```
for workwith in something:
    # do things with workwith 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-24T16:54:18.167

As there are [two](https://stackoverflow.com/questions/578677/alternative-to-for-i-in-xrangelenx/578694#578694) [answers](https://stackoverflow.com/questions/578677/alternative-to-for-i-in-xrangelenx/578685#578685) to question that are perfectly valid (with an assumption each) and author of the question didn't inform us about the destiny of index, the valid answer should read:

> If you [do not need index](https://stackoverflow.com/questions/578677/alternative-to-for-i-in-xrangelenx/578685#578685) at all:
> 
> ```
> for workwith in something:
>     print "element", workwith 
> ```
> 
> If you [need index](https://stackoverflow.com/questions/578677/alternative-to-for-i-in-xrangelenx/578694#578694):
> 
> ```
> for index, workwith in enumerate(something):
>     print "element", index, "is", workwith 
> ```

If my answer is not appropriate, comment please, and I'll delete it :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T18:13:05.113

例如：

```
[workwith(i) for i in something] 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-23T18:14:03.147

是什么`x`？如果它是一个序列或迭代器或字符串，那么

```
for i in x:
    workwith = i 
```

会正常工作。

# c# - 可以使用 PHP 进行表单身份验证票证解密吗？

> ID：578679
> 
> 赞同：3
> 
> 时间：2009-02-23T18:11:06.040
> 
> 标签：c#, .net, php, authentication, encryption

我是一名 PHP 开发人员，对 .NET 几乎一无所知。工作中的 .NET 人员要求我将用于解密身份验证票证的 .NET 代码翻译成 PHP，以便 PHP 代码可以为我的应用程序运行设置适当的会话变量。这甚至可能吗？我盯着代码，这让我很困惑。如果有人能告诉我这不是浪费时间，我会继续尝试，因为我什至不知道。谢谢你的帮助！

附加信息：我什至可以先用 PHP 抢票吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-12T17:41:19.170

首先，打开您的 machine.config 并添加一个 machinekey 条目。根据从 aspnet 2.0 的机器密钥生成器中随机生成的密钥设置解密密钥和验证密钥。

请务必使用默认值，即。AES 和 SHA1。现在您有了 AES 解密密钥，请将其存储在某个地方，因为您将在 php 端需要它。在您的 dot net 应用程序中，进入 web.config 并获取表单身份验证 cookie 名称，通常类似于 .ASPXAUTH

现在转到 PHP 端。下载并设置一个 AES 加密库，比如这个，[http ://phpseclib.sourceforge.net/documentation/](http://phpseclib.sourceforge.net/documentation/)

然后在 PHP 中你可以做这样的事情（这使用 phpsec 库）：

```
set_include_path(get_include_path() . PATH_SEPARATOR . 'phpseclib');
include('Crypt/AES.php');

$authCookie = $_COOKIE['_ASPXAUTH'];

echo $authCookie;

$aes = new Crypt_AES();

$aes->setKey('BCDCBE123654F3E365C24E0498346EB95226A307857B9BDE8EBA6198ACF7F03C');

echo $aes->decrypt($authCookie); 
```

现在最终出来的将首先是 pm + SHA1 哈希 + auth 票证的字节表示。您必须将序列化的字节转换为字符串以使其可读。其他人可以照亮最后一步吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T18:17:50.377

正如 Gumbo 所说，您需要考虑所涉及的算法。asp.net 身份验证票证使用：

1.  创建序列化表单身份验证票证。创建票的字节数组表示。
2.  签署表单身份验证票。字节数组的消息验证码 (MAC) 值是使用 machineKey 元素的 validation 和 validationKey 属性指定的算法和密钥计算的。默认情况下，使用 SHA1 算法。
3.  加密表单身份验证票。已创建的第二个字节数组使用 FormsAuthentication 类的 Encrypt 方法进行加密。Encrypt 方法在内部使用 machineKey 元素上的解密和解密密钥属性指定的算法和密钥。ASP.NET 1.1 版默认使用 3DES 算法。ASP.NET 2.0 版默认使用 Rinjdael (AES) 算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T18:18:28.907

来自[微软知识库](http://support.microsoft.com/kb/910443)

> 表单身份验证票证用于告诉 ASP.NET 应用程序您是谁。因此，ticket 是 Forms Authentication 安全性的构建块。
> 
> 使用服务器的 Machine.config 文件的配置元素对票证进行加密和签名。ASP.NET 2.0 使用decryptionKey 和元素的新decryption 属性来加密表单身份验证票证。解密属性允许您指定要使用的加密算法。ASP.NET 1.1 和 1.0 使用 3DES 加密，这是不可配置的。篡改票证价值是由未能在服务器上解密票证确定的。结果，用户将被重定向到登录页面。
> 
> 如果应用程序部署在 Web 场中，则必须确保每台服务器上的配置文件共享标签中的validationKey 和decryptionKey 属性的相同值，它们分别用于票证的散列和解密。您必须这样做，因为您无法保证哪个服务器将处理连续的请求。有关 FormsAuthenticationTicket 加密和 Web 场部署注意事项的详细信息，请访问以下 MSDN 网站：

因此，您可以指定要遵循的加密/解密算法和密钥。您可以在 PHP 中使用相同的解密逻辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T18:13:11.790

如果您知道解密算法，您肯定可以在 PHP 中实现它。

# sql - 将行中的 SQL 总和提取到列中？

> ID：578688
> 
> 赞同：2
> 
> 时间：2009-02-23T18:13:02.383
> 
> 标签：sql, mysql

我通过查找主要记录然后在线程中循环以汇总相关事务来完成非常缓慢的搜索。我试图让它在一个单一的声明中工作，已经接近但仍然有交替借记和贷记的记录。

**我不知道如何将借方和贷方行拉到列中，以便每个日期和作业密钥都有一行结果**。

```
SELECT j.dtmInvoicedOn, j.strJobKey, c.strCustName, strTransType, 
     SUM(r.dblTransactionAmount) AS SUM_dblTotalCharge 
     FROM tbljobs AS j
     INNER JOIN tblreceivledger AS r ON j.strJobKey = r.strJobKey 
     INNER JOIN tblcustomers AS c ON j.intCustomerID = c.intCustomerID 
     WHERE c.strCustomerName = 'Acme Runners Inc'
     GROUP BY j.strJobKey, c.strCustName, strTransType
     ORDER BY dtmInvoicedOn, strJobKey; 
```

产生这样的输出，借方和贷方金额几乎交替

```
+----------------+---------------+------------------+--------------------+--------------------+
| dtmInvoicedOn  | strJobKey     | strCustomerName  | strTransactionType | SUM_dblTotalCharge |
+----------------+---------------+------------------+--------------------+--------------------+
| 2008-07-03     | 270876-1      | Acme Runners Inc | credit             |           -5531.52 | 
| 2008-07-11     | 270880-1      | Acme Runners Inc | debit              |            5058.54 | 
| 2008-07-11     | 270880-1      | Acme Runners Inc | credit             |           -5058.54 | 
| 2008-07-18     | 271468-1      | Acme Runners Inc | debit              |            5290.17 | 
| 2008-07-18     | 271468-1      | Acme Runners Inc | credit             |           -5290.17 | 
| 2008-11-07     | 286049-1      | Acme Runners Inc | debit              |            5230.44 | 
| 2008-11-14     | 286051-1      | Acme Runners Inc | debit              |            5375.14 | 
| 2008-11-21     | 286107-1      | Acme Runners Inc | debit              |            5572.33 | 
| 2008-11-28     | 286112-1      | Acme Runners Inc | debit              |            5123.42 | 
```

所以我希望它看起来像：

```
+----------------+---------------+------------------+----------+----------+
| dtmInvoicedOn  | strJobKey     | strCustomerName  |   credit |    debit |
+----------------+---------------+------------------+----------+----------+
| 2008-07-03     | 270876-1      | Acme Runners Inc | -5531.52 |        0 |
| 2008-07-11     | 270880-1      | Acme Runners Inc | -5058.54 |  5058.54 | 
| 2008-07-18     | 271468-1      | Acme Runners Inc | -5290.17 |  5290.17 | 
| 2008-11-07     | 286049-1      | Acme Runners Inc |        0 |  5230.44 | 
| 2008-11-14     | 286051-1      | Acme Runners Inc |        0 |  5375.14 | 
| 2008-11-21     | 286107-1      | Acme Runners Inc |        0 |  5572.33 | 
| 2008-11-28     | 286112-1      | Acme Runners Inc          0 |  5123.42 | 
```

请注意，服务器当前正在运行 mysql，但稍后将迁移到 postgres 和 sqlite。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T18:19:47.750

这应该做的工作：

```
SELECT j.dtmInvoicedOn, j.strJobKey, c.strCustName, strTransType, 
     SUM(CASE WHEN strTransType='credit' THEN r.dblTransactionAmount ELSE 0 END) AS SUM_CREDIT,
     SUM(CASE WHEN strTransType='debit' THEN r.dblTransactionAmount ELSE 0 END) AS SUM_DEBIT
FROM tbljobs AS j
     INNER JOIN tblreceivledger AS r ON j.strJobKey = r.strJobKey 
     INNER JOIN tblcustomers AS c ON j.intCustomerID = c.intCustomerID 
WHERE c.strCustomerName = 'Acme Runners Inc'
GROUP BY j.strJobKey, c.strCustName
ORDER BY dtmInvoicedOn, strJobKey; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T18:20:20.667

您想要摆脱交易类型并拥有两个总计取决于借方或贷方的字段。

```
SELECT j.dtmInvoicedOn
, j.strJobKey
, c.strCustName
, Sum(Case When strTransactionType = 'credit' then r.dblTransactionAmount else 0 end) as credit
, Sum(Case When strTransactionType = 'debit' then r.dblTransactionAmount else 0 end) as debit   
FROM tbljobs AS j     
INNER JOIN tblreceivledger AS r ON j.strJobKey = r.strJobKey      
INNER JOIN tblcustomers AS c ON j.intCustomerID = c.intCustomerID      
WHERE c.strCustomerName = 'Acme Runners Inc'     
GROUP BY j.dtmInvoicedOn
, j.strJobKey
, c.strCustName
ORDER BY dtmInvoicedOn, strJobKey; 
```

# graphics - 权威图像库引擎/插件指南

> ID：578691
> 
> 赞同：1
> 
> 时间：2009-02-23T18:13:40.590
> 
> 标签：graphics, image-gallery

我想获得所有风​​格的图片库引擎的一个很好的列表：独立，Wordpress 或 Rails 的插件，AJAX，没有 AJAX，使用简单的文件夹或服务器上的数据库。

如果可能，请说明运行每个项目需要什么（例如 MySQL 和 Django）。谢谢！

[我不久前问了一个[类似的问题](https://stackoverflow.com/questions/203193/good-image-gallery-engines)，但回答有限。希望有更多的用户和少量的赏金，这将获得更多的动力。编辑 - 两天内不能附加赏金。抓紧。]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T15:35:30.433

这些是我目前记得的，它们都很容易集成，并且不需要太多实现即可使用。他们都有一个很好的和吸引人的设计。希望能帮助到你。

*   [Cooliris](http://www.cooliris.com/)：在闪存上运行，使用 RSS 提要显示图像

*   [FancyBox](http://fancy.klade.lv/) : Jquery 插件，你只需要在 < img src... 周围创建一个 <a ref...

*   [LightBox](http://leandrovieira.com/projects/jquery/lightbox/) : jQuery 插件，也很容易使用。

*   [Photo Slider](http://opiefoto.com/articles/photoslider) : jQuery 插件，下面的一些缩略图可以用来滑动图片

*   [SimpleViewer](http://www.airtightinteractive.com/simpleviewer/)：不错的设计，显示缩略图和图像

*   [HighSlide JS](http://highslide.com/)：Javascript 查看器

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T18:09:06.307

我最喜欢[画廊](http://gallery.menalto.com)，是我见过的最好的。它需要 PHP 和[数据库](http://gallery.menalto.com/requirements)）。它可以插入 WordPress 和[其他 CMSish 的东西](http://gallery.menalto.com/features)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T10:27:15.030

看看[SourceForge](http://tinyurl.com/sf-results)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T13:15:37.237

如果您正在寻找画廊应用程序，我推荐开源项目“ [Gallery2](http://gallery.menalto.com/) ”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T13:24:52.317

[Lytebox](http://www.dolem.com/lytebox/)易于使用且非常好用。它是 LightBox 的增强版。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T15:52:24.940

[这](http://www.silverlight-blog.it/ontheroad/photogallery/index.html)是一个使用 Silverlight 的漂亮照片库。[Slide.Show](http://www.codeplex.com/SlideShow)是另一个漂亮的 Silverlight 画廊。[DotNetNuke](http://www.dotnetnuke.com)有许多可用的[图库模块](http://www.snowcovered.com/snowcovered2/Default.aspx?tabid=295&search=gallery)，还有一个官方模块。[Codeplex](http://www.codeplex.com/site/search?ProjectSearchText=gallery)上也有很多可用的。

# c# - 实现 NHibernate DetachedCriteria-like

> ID：578695
> 
> 赞同：1
> 
> 时间：2009-02-23T18:15:16.450
> 
> 标签：c#, nhibernate, icriteria

我想写像 DetachedCriteria 这样的东西，但我根本不想使用 ISession 或 Nhibernate ......

我需要的只是ICriterion 和Expression 的实现。

在编写了这样的标准之后 - >我想生成一个 Xml 查询或 AD-Query 甚至可能是关于集合的查询（类似于 Linq2Objects）

你有这样的样品吗？有人写过这样的代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T18:54:49.710

Ayende 对此有一个实现。

[http://ayende.com/Blog/archive/2006/12/07/ComplexSearchingQueryingWithNHibernate.aspx](http://ayende.com/Blog/archive/2006/12/07/ComplexSearchingQueryingWithNHibernate.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-23T18:20:10.497

您为什么不查看 NHibernate 的源代码以实现 Icriterion 和 Expression。毕竟是一个开源项目。

# javascript - javascript 在各种浏览器中随机实现的可信度如何？

> ID：578700
> 
> 赞同：20
> 
> 时间：2009-02-23T18:17:16.087
> 
> 标签：javascript, math, random

我想对 javascript 和加密做一些实验，我很好奇随机函数的实现是多么不可预测。有人做过硬测试吗？

显然，浏览器有能力产生强随机性（对于 ssl）。问题是它们是否让 javascript 获得相同的强度。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-23T18:20:19.980

通常，随机函数在密码学上并不强，因为您需要确保您使用的是密码学伪随机数生成器。

通用随机函数通常不使用加密强的生成方法，因为它们比简单的方法花费更长的时间（例如，Yarrow 比 Mersenne Twister 更复杂）并且需要仔细管理熵池，这并不能保证 Mozilla、cstdlib、等想给你。

如果您需要访问加密的强随机数生成器，我会考虑访问底层 SSL 实现（给定的浏览器可能允许也可能不允许访问）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-08-29T09:56:09.810

最近的浏览器公开[`window.crypto.getRandomValues()`](https://developer.mozilla.org/en-US/docs/Web/API/window.crypto.getRandomValues)了加密强度很高的浏览器。

还有一些 JS 库可以实现强大的 RNG，但如果没有`getRandomValues()`它，收集熵就非常困难。虽然可能需要很长时间，但[可以通过鼠标和键盘完成。](https://www.clipperz.com/security_privacy/crypto_algorithms/#prng)

`Math.random()`2008 年在大多数浏览器中都很弱 - [Amit Klein 的论文](https://dl.packetstormsecurity.net/papers/general/Temporary_User_Tracking_in_Major_Browsers.pdf)详细介绍了 - 遗憾的是今天几乎一样弱。

**更新：似乎几乎所有浏览器在 2015-2016 年都切换到[XorShift128+](https://en.wikipedia.org/wiki/Xorshift#xorshift.2B)** — LFSR 的一个快速变体，调整到良好的统计特性，但在密码学上也很弱：[https](https://lwn.net/Articles/666407/) : //lwn.net/Articles/666407/，https [://security。 stackexchange.com/questions/84906/predicting-math-random-numbers](https://security.stackexchange.com/questions/84906/predicting-math-random-numbers)。以下详细信息已过时。

*   Firefox 使用了非常弱的“我们自己的自制 LFSR”算法；自 2006 年以来，他们一直在讨论切换到更强大的算法和熵源（[错误 322529](https://bugzilla.mozilla.org/show_bug.cgi?id=322529)）。更新：2015 年他们切换到 XorShift128+。

    在 2013 年 5 月，他们至少将种子从当前时间切换到良好的熵源（[错误 868860](https://bugzilla.mozilla.org/show_bug.cgi?id=868860)），同时消除（？）交叉表泄漏。

*   [Webkit自 2009 年以来](https://trac.webkit.org/changeset/50789)使用弱快速算法 ( [GameRand](http://www.redditmirror.cc/cache/websites/mjolnirstudios.com_7yjlc/mjolnirstudios.com/IanBullard/files/79ffbca75a75720f066d491e9ea935a0-10.html) ) ， 但[自 2010 年以来](https://bugs.webkit.org/show_bug.cgi?id=36673#c4)（在每种情况下）都使用从强操作系统源初始化的强 RNG 的种子。 （我认为这是 Safari 使用的，但我可能对各种 WebKit 端口感到困惑......）

*   Chrome 不使用 WebKit 的随机，在 V8 中使用它自己的，[一个弱线性的东西](https://code.google.com/p/v8/codesearch#v8/trunk/src/v8.cc&q=random_base&sq=package:v8&l=149)。
    没有一致意见 Math.random() 是否应该很强大（[错误 246054](https://code.google.com/p/chromium/issues/detail?id=246054)）。

    不知道是怎么播种的。V8 有 SetEntropySource() 钩子，但显然它只是[为单元测试引入的](https://code.google.com/p/chromium/issues/detail?id=90224)，而不是由 Chrome 调用的。如果未调用，`random()`则用于播种。

    [状态在 2011 年](https://code.google.com/p/v8/issues/detail?id=864)变成了每个上下文，但这对于弱播种不是很有用。

*   Opera 在 2009 年 1 月宣布它已[修复，](http://www.opera.com/security/advisory/928)并[在此处](https://github.com/cryptocat/cryptocat/issues/190)表示他们的 Math.random() 在密码学上很强大。

*   没有找到关于 IE 现在做什么的文档。他们在 2008 年的线性 PRNG 很弱（见论文）。他们确实告诉阿米特他们会在服务包中修复它，所以在某个地方可能会有一个建议......

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-23T18:31:23.697

我熟悉的每个 JavaScript 引擎**都不**使用加密强度高的 RNG。

如果您在浏览器中需要一个好的熵源（最好不要经常需要它），我建议您捕获鼠标移动数据并通过加密强大的哈希算法运行它。诸如[Entropy Gathering Daemon](http://egd.sourceforge.net/)（与 gpg 一起使用）之类的现有程序可用作如何实现此类系统的参考。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T19:46:05.110

我发现一个有趣的数据点是[mozilla](https://developer.mozilla.org/en/JavaScript_crypto)有一个尚未完全实现的 javascript 加密对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T20:30:57.903

通常，您不能依赖 javascript 中的伪随机数生成来获得远程加密安全。您可能会考虑使用熵收集系统来实现自己的 PNRG，或者可能使用诸如[hotbits](http://www.fourmilab.ch/hotbits/)之类的外部随机数源。

# keyboard-shortcuts - 是否有键盘快捷键可以访问 Gnome 中的桌面菜单，或者如何创建它们？

> ID：578702
> 
> 赞同：5
> 
> 时间：2009-02-23T18:17:35.150
> 
> 标签：keyboard-shortcuts, desktop, gnome

我想通过键盘而不是鼠标访问应用程序、系统等的桌面菜单。

编辑：++`Ctrl`只允许我在我打开的窗口中进行选择。没有选择桌面菜单的选项。++没有任何反应。（我查看了 gnome 桌面快捷方式的各个页面）。`Alt``Tab``Ctrl``Alt``Esc`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T18:41:03.923

默认情况下，在我的 Gnome-under-Ubuntu 安装中：

*   `Alt`+`F1`弹出应用程序菜单打开（然后四个箭头键导航）。
*   `Alt`+`F2`弹出运行应用程序对话框。

我已经绑定`Alt`+`F3`打开一个终端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T18:24:01.237

[http://www.novell.com/coolsolutions/tip/2289.html](http://www.novell.com/coolsolutions/tip/2289.html)

[http://en.wikipedia.org/wiki/Table_of_keyboard_shortcuts](http://en.wikipedia.org/wiki/Table_of_keyboard_shortcuts)

# opengl - XNA, 直接 X , OpenGL

> ID：578705
> 
> 赞同：12
> 
> 时间：2009-02-23T18:18:05.897
> 
> 标签：opengl, directx, xna

很久以前就想给游戏编程了，一直没搞定，最后还是决定先给。我决定尝试创建一个简单的 2D 平台游戏。我快速玩过 XNA，我很喜欢它。我正在寻找的是 XNA、directx、OpenGL 之间的比较。主要是他们之间的优势和劣势。在过去的 4 年里，我一直是一名 .net 开发人员，这就是我的主要知识。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-23T18:32:41.200

如果您想做 Direct X，请向 Win32 和 COM 打个招呼，成为您最好的新伙伴。您将在早期花费大量时间来学习 win32 API 的来龙去脉。DirectX with Win32 为您提供声音、游戏输入和图形显示所需的所有功能。您还将使用 C 或 C++ 编写代码，并且您将学习所有有关内存管理和 C 思维方式的知识——这不是您应该考虑轻易放弃的东西。学习和使用 C 作为主要项目的语言可能非常有启发性，并使您感谢现代编程语言的特性和设计元素。您实际上并没有被迫在这里使用 C 或 C++ 进行开发；Direct X 有各种 .NET 包装器和其他语言包装器，但如果您有 .NET 经验，不妨使用为 .NET 制作的框架：XNA。

XNA 是一套更新的、基于 .NET 的工具。它提供了许多与直接使用 Win32 和 DirectX 相同的功能（声音、输入等），但在托管平台上本机。对于大多数游戏（尤其是刚开始的游戏），您可以通过 XNA 游戏获得出色的帧速率（即使本机应用程序可以为您提供更多），并且非常适合学习游戏开发的来龙去脉——您可以真的不会出错。您需要的大多数基本数据结构（四叉树/八进制树、模型-视图-控制器架构、事件处理、程序结构）您仍然需要自己学习和实现，并且在 .NET 中进行最当然比 C 和 C++ 更容易。作为一个不错的附带奖励，如果您有 Xbox 360、XNA 社区游戏[可以通过一些工作通过 Xbox Live 市场发布。](http://creators.xna.com/en-US/) 基本上，作为 .NET 开发人员，您在这里可能会感觉最舒服。

OpenGL 是一个用于绘制多边形的跨平台库。它具有与 Direct X 不同的框架和 API，并且不提供任何操作系统交互工具。有一些包可以让你用许多不同的语言在 OGL 中编程。然而，正如其他人所说，这可能与使用 Win32 和 DirectX 编写一样多。对于图形以外的其他功能（键盘、鼠标、操纵杆、音频），您可以考虑使用像[SDL](http://www.libsdl.org/)这样的框架，其中一些缺少的 DirectX 功能。图书馆周围有一个相当不错的社区，如果你走这条路，可以给你指点和提示。

更多关于这方面的想法可以在几乎相同的文章中找到，这里是：[学习 direct-x、C Open GL 或 XNA 的建议游戏平台](https://stackoverflow.com/questions/19642/suggested-gaming-platform-to-learn-direct-x-c-open-gl-or-xna)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T18:45:17.610

XNA 将是为 360 或 Windows 平台启动和运行游戏的最简单/最快的方法。它将允许您以您已经熟悉的方式（C#.NET）继续开发，并且它将为您提供一个相当大的框架，该框架将自动处理常用的东西。但是，这种轻松带来了一些限制，因为您将仅限于上述平台，并且由于它是一个大型框架，因此会有很多开销在很大程度上未使用，从而导致性能下降，但是使用简单的 2D 平台游戏，这可能不会成为问题。

DirectX 也会限制您在平台上的使用，并且在学习和开发方面会变得更加复杂。您也很可能在这里使用 C 或 C++ 进行编程。优势在于性能，因为您正在处理所有事情，您将控制所有事情并能够根据您的需要优化所有内容。我认为对于第一场比赛，你会从 XNA 开始，在你“超越”​​XNA 之后转向 DirectX 会好得多。特别是为了创建一个简单的 2D 平台游戏。

OpenGL 将允许您的游戏在大多数平台上运行，但会像 DirectX 一样复杂（如果不是更复杂的话）（尽管我应该提到 OpenGL 的图形引擎，它们像[OGRE](http://www.ogre3d.org/)一样使用起来非常简单。您还将使用 C 进行开发/C++ for OpenGL. 我认为 XNA 会是更好的选择，直到你觉得你已经准备好进行下一步了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T18:38:13.480

如您所说，如果您的经验主要是使用 .NET，那么 XNA 的进入门槛将是最短的，尽管您不会获得与使用其他选项一样好的性能。然而，正如您所说，您正计划制作 2D 平台游戏（假设这里的含义是“非硬件密集型”），那么 XNA 将绰绰有余，并且可能是您项目的最合适的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T18:45:12.433

DirectX 并不意味着您必须使用本机代码，那里有几个托管包装器。性能损失在原生 DirectX 的 1-3% 范围内，但考虑到您将节省数小时和数小时的开发时间，并且可能永远不需要最后的 2%，管理是要走的路。

请参阅此示例：[SlimDX](http://slimdx.mdxinfo.com/wiki/index.php?title=Main_Page) - C# 中 DirectX 的完全托管包装器

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T18:51:45.507

一种选择是在 .NET 中编写引擎，但使用 C++/CLI 实现渲染器。我正在为我的一个项目做这个。XNA、OpenGL 和 DX 对于我想要的来说都太低级了。我不想编写渲染器，我想使用现有的渲染器。Ogre3D 包装器 Mogre 看起来完全是一团糟（不确定是 Mogre、Ogre3D 还是两者的设计），而且大多数其他包装器已经过时了。相反，我使用 C++/CLI 和[Irrlicht](http://irrlicht.sourceforge.net/)来实现渲染器，这似乎比 Ogre3D 更快且设计得更好。

你可以考虑做这样的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-06T14:06:54.100

我开始使用 DirectX，但现在转向 XNA，主要是因为我希望能够更多地关注实际的游戏玩法，而不是游戏背后的技术。当然，您仍然需要进行一些引擎编码，但是拥有一个框架来提供专门为游戏编程制作的现成功能会大有帮助。

# shell - yacc，只应用一次规则

> ID：578719
> 
> 赞同：1
> 
> 时间：2009-02-23T18:22:11.677
> 
> 标签：shell, yacc

我正在尝试使用 yacc 和 lex 编写 shell，但我的 I/O 重定向器遇到了一些问题。目前，我可以按任何顺序很好地使用 < 和 > 运算符，但我的问题是我可以重定向两次而没有错误，例如“ls > log > log2”

我的规则代码如下，谁能给我一些关于如何解决这个问题的提示？谢谢！

```
 io_mod:
    iomodifier_opt io_mod
    |
    ;

 iomodifier_opt:
    GREAT WORD {
        printf("   Yacc: insert output \"%s\"\n", $2);
        Command::_currentCommand._outFile = $2;
    }
    |
    LESS WORD {
       printf("   Yacc: insert input \"%s\"\n", $2);
       Command::_currentCommand._inputFile = $2;
    }
    | /* can be empty */
    ; 
```

编辑：在与我的 TA 交谈后，我了解到我实际上不需要为我的命令只使用 1 个修饰符，而且我实际上可以拥有相同 I/O 重定向的多个副本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T19:04:35.880

有两种方法：

(1) 修改语法，使每一种修饰语只能有一个：

```
io_mod_opt：out_mod in_mod | in_mod out_mod | in_mod | out_mod | ;

```

（2）修改子句处理程序，统计修饰符，多于一个则报错：

```
大字{
    如果（已经有输出文件（））{
        error("输出文件太多：\"%s\"\n", $2)
    } 别的 {
        /* 记录输出文件 */
    }
}

```

选项 (2) 似乎可能导致更好的错误消息和更简单的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T03:54:51.743

还有第三种方法——不要担心。Bash（在 Cygwin 下）不会产生以下错误：

```
ls > x > y 
```

它先创建 x，然后创建 y，最后写入 y。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-23T20:20:57.023

我意识到这可能只是一个学习 lexx 和 yacc 的练习，但除此之外，第一个问题是问*为什么*要使用 lexx 和 yacc？任何常用的 shell 命令语言都有一个非常简单的语法。您从使用 LALR 生成器中获得了什么？

好吧，我的意思是，除了复杂性、难以生成好的错误消息和代码量之外。

# apache-flex - 使用字符串动态访问自定义方法

> ID：578723
> 
> 赞同：0
> 
> 时间：2009-02-23T18:24:26.617
> 
> 标签：apache-flex, string, flex3, variables

我正在创建一个在“一天”结束时具有连续数字的二维列表，用作 DataGrid 的 dataProvider 我一直通过命令
dg1.selectedItem.day1
dg1.selectedItem.day2
dg1.selectedItem.day3访问它们
ETC...

有什么方法可以获取字符串 ("day"+i) 并将其转换为（它是什么？变量名？），这样我就可以按照以下方式做一些事情：

```
for(var i:Number=1; i<numFields; i++)
{
  dg1.selectedIndex = i-1;
  dg1.selectedItem.(mysteryFunction("day"+i)) = 42;
} 
```

如果有一个我可以用于神秘函数的函数，或者使用什么数据类型，任何信息都会非常有帮助，

这就是我一直在使用的（太乏味了）：

> ```
> <mx:XMLList id="sched">
>   <field>
>       <day1></day1>
>       <day2></day2>
>       <day3></day3>
>   </field>
>   <field>
>       <day1></day1>
>       <day2></day2>
>       <day3></day3>
>   </field>
> 
>   ...
> </mx:XMLList> 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T19:42:02.530

您正在寻找的“神秘功能”就像用括号索引一样简单：

```
for(var i:Number=1; i<numFields; i++)
{
    dg1.selectedIndex = i-1;
    dg1.selectedItem["day"+i] = 42;
} 
```

令人惊讶的是，它被称为属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T18:38:50.653

使用[`Array`](http://livedocs.adobe.com/flex/3/langref/Array.html)或者如果你要绑定它（我有点赌注）使用[`ArrayCollection`](http://livedocs.adobe.com/flex/3/langref/mx/collections/ArrayCollection.html)而不是单独命名这些变量。

如果成员是由某个程序生成的，您最好将所有这些都放在我上面提到的集合类之一中，然后开始处理。从长远来看，它让生活更轻松。

[E4X](http://livedocs.adobe.com/flex/3/html/help.html?content=13_Working_with_XML_03.html)是处理 XML 时要走的路。Mozilla 的家伙对这项技术有一个可以说是更好的[解释](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Processing_XML_with_E4X)。因此，如果您的 XML 存储在一个变量中：

```
var tree:XML = <field>
    <day1></day1>
    <day2></day2>
    <day3></day3> 
```

你可以简单地做：

```
tree.day1 = 42; 
```

你为什么要这个`mysteryFunction()`？`dataProvider`对象只是某种类型的集合。你已经**知道**类型了，对吧？读[这个](http://livedocs.adobe.com/flex/3/html/help.html?content=about_dataproviders_2.html)。

反正也没有这种神秘的功能。但是请注意，字符串与数字的连接会将数字转换为字符串。尝试

```
trace("str " + 42); 
```

# delphi - 何时调用 TGraphicControl.Paint？

> ID：578725
> 
> 赞同：-1
> 
> 时间：2009-02-23T18:25:10.983
> 
> 标签：delphi, image, sdl, vcl

我正在尝试编写一个自定义的 TGraphicControl 后代，它允许用户在 VCL 表单上嵌入[SDL](http://www.libsdl.org)渲染表面。这将提供一种在表单中显示 SDL 动画的简单方法。

显然，使用 Paint 方法重绘了 TGraphicControl。这多久被调用一次？是仅在发生某些事情使控件无效时，还是有其他事情调用它？它如何与自己绘制的东西相互作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T19:22:50.377

当下面的窗口控件重绘自身时，将调用非窗口控件（即 TGraphicControl）的 Paint 方法。当处理窗口控件的 WM_PAINT 消息时会发生这种情况。

当窗口控件的整个区域或部分区域已失效时，或者当另一个 Z 顺序较高的窗口关闭或移动时，窗口控件将被重绘，因此该窗口被暴露并需要重绘。

使一个 TGraphicControl 无效会计算窗口化父控件的对应部分，并使这部分无效。

如果您需要一个 TGraphicControl 来重绘自己，那么您需要在它或其父控件上调用 Invalidate。没有其他方法可以导致重绘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T23:36:16.040

> **问题 1：**多久调用一次？

查看答案 Mghie：每当父窗口控件处理 WM_PAINT 消息时

> **问题2：**是只有当某些事情发生时才使控件无效，还是有其他事情调用它？

查看答案 Mghie：仅当它无效时

> **问题 3：**它如何与自己绘制的东西相互作用？

您必须将自己的绘图例程放在 TGraphicControl 后代的 Paint 方法中 - 使用覆盖指令。在 Paint 方法中绘图不会发送另一个 WM-PAINT 消息。在 Paint 方法中，您可以在画布上绘图而无需进入 WM-PAINT 消息循环。使您的绘图代码尽可能快，因为可能会有相当多的 WM-PAINT 消息飞来飞去。如果您的绘图程序花费大量时间，您的应用程序将显得迟缓/无响应。

# c# - C#：将对象呈现为 XML

> ID：578729
> 
> 赞同：6
> 
> 时间：2009-02-23T18:27:03.037
> 
> 标签：c#, xml, serialization

我正在寻找一种将对象树转换为 XML 的方法。写起来会很有趣，但我相信有人已经写过了。这是我的愿望清单：

*   它不应该关心构造函数
*   它应该理想地处理循环引用（不要太在意如何）
*   它不应该需要更改对象 - 例如，没有自定义属性
*   它不应该关心或需要已知类型（例如，XmlInclude）
*   XML 应该非常简单 - 它需要操作团队成员可以阅读
*   如果一个属性不能被序列化，它应该只是抑制错误并继续
*   可以处理列表和字典

我不需要重建对象模型，所以只写解决方案很好（可能是预期的）。

我认为折扣：

*   XmlSerializer - 需要无参数构造函数，没有循环引用支持
*   DataContractSerializer - 需要属性（选择加入）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T21:43:02.067

罗伯特罗斯尼的帖子让我觉得这可能比我想象的要少。所以这是一个非常粗略的尝试。它处理以下内容：

*   如果无法读取属性，则将异常打印为值
*   循环引用和多次出现。它将一个 ID 与每个元素相关联；如果一个元素出现两次，它只是指向 ref ID。Ref ID 对于对象图是唯一的（我可能应该使用 GUID，但这适合我的目的）。
*   派生类型没有问题
*   它不需要属性或特定的构造函数或其他废话
*   它可以处理只读属性

这是一个输出示例（在我的测试对象中，订单上的“货币”产品引发异常）。

```
<Customer Ref="1">
  <FirstName>Paul</FirstName>
  <LastName>Stovell</LastName>
  <FullName>Paul Stovell</FullName>
  <Orders>
    <Order Ref="2">
      <SKU>Apples</SKU>
      <Price>27.30</Price>
      <Currency>Something bad happened</Currency>
      <Customer Ref="1" />
    </Order>
    <Order Ref="3">
      <SKU>Pears</SKU>
      <Price>17.85</Price>
      <Currency>Something bad happened</Currency>
      <Customer Ref="1" />
    </Order>
    <Order Ref="2" />
  </Orders>
</Customer> 
```

这是示例对象模型和用法：

```
static void Main(string[] args)
{
    var customer = new Customer();
    customer.FirstName = "Paul";
    customer.LastName = "Stovell";
    customer.Orders.Add(new Order(customer) { Price = 27.30M, SKU = "Apples"});
    customer.Orders.Add(new Order(customer) { Price = 17.85M, SKU = "Pears"});
    customer.Orders.Add(customer.Orders[0]);

    var output = new StringWriter();
    var writer = new XmlTextWriter(output);
    writer.Formatting = Formatting.Indented;
    WriteComplexObject("Customer", customer, writer);
    Console.WriteLine(output.ToString());
    Console.ReadKey();
}

class Customer
{
    private readonly List<Order> _orders = new List<Order>();

    public Customer()
    {
    }

    public string FirstName { get; set; }
    public string LastName { get; set; }

    public string FullName
    {
        // Read-only property test
        get { return FirstName + " " + LastName; }
    }

    public List<Order> Orders
    {
        // Collections test
        get { return _orders; }
    }
}

class Order
{
    private readonly Customer _customer;

    public Order(Customer customer)
    {
        _customer = customer;
    }

    public string SKU { get; set; }
    public decimal Price { get; set; }
    public string Currency
    {
        // A proprty that, for some reason, can't be read
        get
        {
            throw new Exception("Something bad happened");
        }
    }

    public Customer Customer
    {
        get { return _customer; }
    }
} 
```

这是实现：

```
public static void WriteObject(string name, object target, XmlWriter writer)
{
    WriteObject(name, target, writer, new List<object>(), 0, 10, -1);
}

private static void WriteObject(string name, object target, XmlWriter writer, List<object> recurringObjects, int depth, int maxDepth, int maxListLength)
{
    var formatted = TryToFormatPropertyValueAsString(target);
    if (formatted != null)
    {
        WriteSimpleProperty(name, formatted, writer);
    }
    else if (target is IEnumerable)
    {
        WriteCollectionProperty(name, (IEnumerable)target, writer, depth, maxDepth, recurringObjects, maxListLength);
    }
    else
    {
        WriteComplexObject(name, target, writer, recurringObjects, depth, maxDepth, maxListLength);
    }
}

private static void WriteComplexObject(string name, object target, XmlWriter writer, List<object> recurringObjects, int depth, int maxDepth, int maxListLength)
{
    if (target == null || depth >= maxDepth) return;
    if (recurringObjects.Contains(target))
    {
        writer.WriteStartElement(name);
        writer.WriteAttributeString("Ref", (recurringObjects.IndexOf(target) + 1).ToString());
        writer.WriteEndElement();
        return;
    }
    recurringObjects.Add(target);

    writer.WriteStartElement(name);
    writer.WriteAttributeString("Ref", (recurringObjects.IndexOf(target) + 1).ToString());
    foreach (var property in target.GetType().GetProperties())
    {
        var propertyValue = ReadPropertyValue(target, property);
        WriteObject(property.Name, propertyValue, writer, recurringObjects, depth + 1, maxDepth, maxListLength);
    }
    writer.WriteEndElement();
}

private static object ReadPropertyValue(object target, PropertyInfo property)
{
    try { return property.GetValue(target, null); }
    catch (Exception ex) { return ReadExceptionMessage(ex); }
}

private static string ReadExceptionMessage(Exception ex)
{
    if (ex is TargetInvocationException && ex.InnerException != null)
        return ReadExceptionMessage(ex.InnerException);
    return ex.Message;
}

private static string TryToFormatPropertyValueAsString(object propertyValue)
{
    var formattedPropertyValue = null as string;
    if (propertyValue == null)
    {
        formattedPropertyValue = string.Empty;
    }
    else if (propertyValue is string || propertyValue is IFormattable || propertyValue.GetType().IsPrimitive)
    {
        formattedPropertyValue = propertyValue.ToString();
    }
    return formattedPropertyValue;
}

private static void WriteSimpleProperty(string name, string formattedPropertyValue, XmlWriter writer)
{
    writer.WriteStartElement(name);
    writer.WriteValue(formattedPropertyValue);
    writer.WriteEndElement();
}

private static void WriteCollectionProperty(string name, IEnumerable collection, XmlWriter writer, int depth, int maxDepth, List<object> recurringObjects, int maxListLength)
{
    writer.WriteStartElement(name);
    var enumerator = null as IEnumerator;
    try
    {
        enumerator = collection.GetEnumerator();
        for (var i = 0; enumerator.MoveNext() && (i < maxListLength || maxListLength == -1); i++)
        {
            if (enumerator.Current == null) continue;
            WriteComplexObject(enumerator.Current.GetType().Name, enumerator.Current, writer, recurringObjects, depth + 1, maxDepth, maxListLength);
        }
    }
    catch (Exception ex)
    {
        writer.WriteElementString(ex.GetType().Name, ReadExceptionMessage(ex));
    }
    finally
    {
        var disposable = enumerator as IDisposable;
        if (disposable != null)
        {
            disposable.Dispose();
        }
        writer.WriteEndElement();
    }
} 
```

我仍然很想知道是否有更多经过验证的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T20:34:14.947

使用反射来编写这似乎很简单：给定一个对象实例，使用其类名创建一个 XML 元素，然后遍历其所有属性。

为每个属性创建一个具有其名称的元素：

*   如果是值类型，则将其文本设置为其值的 XML Schema 文本；
*   如果它实现了`IEnumerable`，遍历它并为每个项目创建一个元素；
*   如果它是任何其他引用类型，请将元素的内容设置为属性的 XML 表示。

使用包含您已序列化的每个对象的哈希码的 HashSet 跟踪循环/多个引用；如果你在 HashSet 中找到了一个对象的哈希码，那么你已经序列化了它。（如果发生这种情况，我不知道您想在 XML 中添加什么。）

但是不，我没有任何代码可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T18:34:22.210

我怀疑你会发现任何在所有课程中都特别有效的东西。正如您所指出的，XmlSerializer 是微软迄今为止在通用方面所做的最大努力。

另一方面是[可视化工具](http://msdn.microsoft.com/en-us/magazine/cc163974.aspx)，它们是特定类所独有的。我认为还没有很多快乐的媒介。

# .net - 为什么空引用异常不能命名具有空引用的对象？

> ID：578734
> 
> 赞同：16
> 
> 时间：2009-02-23T18:30:26.820
> 
> 标签：.net, exception, compiler-construction, theory

在我看来，我的很多调试时间都花在了追踪复杂语句中的空引用异常上。例如：

```
For Each game As IHomeGame in _GamesToOpen.GetIterator() 
```

为什么，当我得到 NullReferenceException 时，我可以得到堆栈跟踪中的行号，而不是等于 null 的对象的名称。换句话说，为什么：

```
Object reference not set to an instance of an object. 
```

代替

```
_GamesToOpen is not set to an instance of an object. 
```

或者

```
Anonymous object returned by _GamesToOpen.GetIterator() is null. 
```

或者

```
game was set to null. 
```

这是严格的设计选择，旨在保护代码的匿名性，还是编译器设计中有令人信服的理由不将此信息包含在调试时异常中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-23T18:34:21.383

异常是运行时的东西，变量是编译时的东西。

实际上，您示例中的变量是*一个表达式*。表达式并不总是简单的变量。在运行时，将评估表达式并在结果对象上调用方法。如果该表达式的值为`null`，则运行时将抛出`NullReferenceException`. 假设如下：

```
Dim a as New MyObject
Dim b as String = MyObject.GetNullValue().ToString() 
```

`GetNullValue()`如果方法返回，运行时应该返回什么错误消息`null`？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T19:23:00.487

对于像 Java 这样编译为由 VM 解释的字节码的语言，假设您有一个`X`带有 field的类`x`，并且它的值`null`用于某个参考。如果你写

```
x.foo() 
```

字节码可能如下所示：

```
push Xref           >> top of stack is ref to instance of X with X.x = null
getField x          >> pops Xref, pushes 'null' on the stack
invokeMethod foo    >> pops 'null' -> runtime exception 
```

关键是需要堆栈上的非空引用才能对其进行操作的操作，例如示例中的invokeMethod，不能也不知道该空引用来自何处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T18:36:26.290

一种简单的方法来捕获这个以进行调试，以便在使用对象之前放置 Assert 语句，检查 null 并输出有意义的消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T18:37:40.173

在发布版本中，变量名称从符号中删除，代码甚至可能被优化为没有变量的特定内存位置，而只是将引用保留在其中一个寄存器中（取决于变量使用的范围）。因此，可能无法从参考位置中扣除变量的名称。

在调试版本中，有更多关于变量的信息。但是，无论构建风格如何，异常对象都需要以相同的方式工作。因此，它以任何方式访问它可以访问的最少信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T18:46:51.913

有几件事...

1）当您自己制定例外时，请记住这一点（如果您为此感到恼火，那么如果您为其他事情这样做，其他人也会对您感到恼火）。鉴于异常路径根本不应该是典型路径，因此花费时间使异常具有有用信息是非常值得的。

2）作为一般的编程实践者，采用这种风格，你会遇到更少的问题（是的，你的代码行数会更长，但你会节省很多时间）：

a) 从不做 ab().c()；做 x = ab(); xc(); （在单独的行上）您可以看到 a 为 null 或者 ab() 的返回为 null。

b) 永远不要将方法调用的返回值作为参数传递 - 始终传递变量。一个（富（））；应该是 x = foo(); 斧头）; 这一个更适合调试并能够看到值。

我不知道为什么像 .net 和 Java 这样的环境不提供运行时版本，该版本确实包含有关此类异常的更多信息，例如超出范围的数组上的索引是什么，变量的名称何时它是空的，等等......

# asp.net - 在 asp.net ajax 回发后平滑滚动到页面顶部

> ID：578745
> 
> 赞同：4
> 
> 时间：2009-02-23T18:33:37.407
> 
> 标签：asp.net, javascript

我在长页面的顶部有一个错误消息区域。在 asp.net 中进行 ajax 回发后（使用更新面板），有时我需要显示一条错误消息，它会显示在视口之外，用户可能不会注意到它。

我希望返回（相同）页面平滑滚动到页面顶部，而不是突然跳转。在我看来，这是一种更好的用户体验。

我正在寻找 c# + Javascript 代码来做这个效果或至少 JS 平滑滚动效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T18:40:17.203

您可以只使用 jQuery 和 scrollTo：[http ://demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

或者只是自己编写动画：

$('body').animate({ scrollTop: 0 }, 1000);

# c# - 为什么 Assembly.GetManifestResourceStream() 中的文本以三个垃圾字符开头？

> ID：578752
> 
> 赞同：9
> 
> 时间：2009-02-23T18:36:02.610
> 
> 标签：c#, visual-studio-2008, encoding, resources

我有一个 SQL 文件作为嵌入式资源添加到我的 VS.NET 2008 项目中。每当我使用以下代码读取文件内容时，返回的字符串总是以三个垃圾字符开头，然后是我期望的文本。我认为这与我正在使用的 Encoding.Default 有关，但这只是一个猜测。为什么这个文字一直出现？我应该剪掉前三个字符还是有更明智的方法？

```
public string GetUpdateRestoreSchemaScript()
{
    var type = GetType();
    var a = Assembly.GetAssembly(type);
    var script = "UpdateRestoreSchema.sql";
    var resourceName = String.Concat(type.Namespace, ".", script);
    using(Stream stream = a.GetManifestResourceStream(resourceName))
    {
        byte[] buffer = new byte[stream.Length];
        stream.Read(buffer, 0, buffer.Length);
        // UPDATE: Should be Encoding.UTF8
        return Encoding.Default.GetString(buffer);
    }
} 
```

**更新：** 我现在知道，如果我简单地更改最后一行以返回 UTF-8 编码字符串，我的代码将按预期工作。这个嵌入文件总是如此，但它总是如此吗？有没有办法测试任何缓冲区以确定其编码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T18:39:47.767

可能该文件采用 utf-8 编码，并且 Encoding.Default 是 ASCII。为什么不使用特定的编码？

编辑以回答评论：

为了猜测文件编码，您可以在流的开头查找[BOM 。](http://en.wikipedia.org/wiki/Byte-order_mark)如果存在，它会有所帮助，如果不存在，那么您只能猜测或询问用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-31T22:42:27.893

如果您尝试从程序集中加载 xml，您实际上需要检查并跳过字节顺序标记字节（让我发疯）：

```
....
byte[] data;
using (var stream = assembly.GetManifestResourceStream(filename))
{
    var length = stream.Length;
    data = new byte[length];
    stream.Read(data, 0, (int) length);
}
if (!HasUtf8ByteOrderMark(data))
{
    throw new InvalidOperationException("Expected UTF8 byte order mark EF BB BF");
}
return Encoding.UTF8.GetChars(data.Skip(3).ToArray()); 
```

和

```
static bool HasUtf8ByteOrderMark(byte[] data)
{
    var bom = new byte[] { 0xEF, 0xBB, 0xBF };
    return data[0] == bom[0] && data[1] == bom[1] && data[2] == bom[2];
} 
```

[更多信息在这里](http://www.siao2.com/2005/01/20/357028.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-01-07T23:53:19.653

我在net.core中遇到了同样的问题你可以让streamreader做编码

```
 using (var stream = = a.GetManifestResourceStream(resourceName))
    using (var reader = new StreamReader(stream))
       return reader.ReadToEnd(); 
```

# c++ - 强制整数初始化为 0 msvc++

> ID：578753
> 
> 赞同：1
> 
> 时间：2009-02-23T18:36:19.473
> 
> 标签：c++, visual-c++

是否有任何编译器设置或其他方式强制将 int 初始化为 0？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T18:38:50.730

> 是否有任何编译器设置或其他方式强制将 int 初始化为 0？

不幸的是，语言没有办法，如果编译器提供这样的设置，它就会违反标准，因此不应该使用。

请问你为什么需要这个？显式初始化还不够吗？或者您想在我使用未初始化的内存时收到警告吗？后者可以使用`valgrind`'s memory profiler 来实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T18:40:55.517

静态总是初始化为默认值（对于 an`int`是 0）。但你不想要它们，是吗？

# php - 有没有办法一步完成？

> ID：578759
> 
> 赞同：2
> 
> 时间：2009-02-23T18:38:13.510
> 
> 标签：php, arrays

$clients = $CLIENT->find($options); $client = $clients[0];

编辑：我意识到我应该更清楚。$CLIENT->find 总是返回一个对象数组，但我想要一行代码将数组（只有一个对象）变成一个对象。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T18:45:42.557

```
$client = array_shift($CLIENT->find($options)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T18:42:30.770

```
$client = reset($CLIENT->find($options)); 
```

**编辑：**这是一个不太模糊的，你应该使用它来代替：

```
list($client) = $CLIENT->find($options); 
```

但它们并不相同。第一个也适用于需要单个标量的地方（在函数的参数列表中），但第二个不会（`list()`返回 void）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T18:40:52.380

除非`($CLIENT->find($options))[0]`有效（IIRC 我不认为它在 PHP 中有效，但不要相信我的话），我认为你不能浓缩这一点。不过，我真的不认为值得担心——如果你需要一个单语句表达式，只需编写一个函数。

```
function fozzyle($options) {
    $clients = $CLIENT->find($options);
    return $clients[0];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T18:40:52.567

$client = $CLIENT->find($options)[0];

不工作？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T19:05:19.280

您是否考虑过[方法链接](http://www.talkphp.com/advanced-php-programming/1163-php5-method-chaining.html)？

这将允许您只用一行代码做很多事情。另请注意，这对于更大和更长期的 OO 解决方案会更好。如果您只需要一个快速而肮脏的解决方案，也许只是一个返回数组中第一项的自定义函数。

**帮助：**如果有人可以找到更好的方法链接参考，请更新。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T19:10:19.033

$client = array_shift($CLIENT->find($options));

$client 将是您的对象，如果 find() 没有返回任何内容，则为 NULL。

# c# - 计算有多少种方法可以将三个数字相加使它们等于 1000

> ID：578766
> 
> 赞同：10
> 
> 时间：2009-02-23T18:39:26.283
> 
> 标签：c#

我需要创建一个程序来计算可以将三个数字相加以使它们等于 1000 的方式。

我认为这段代码应该可以工作，但它没有写出任何东西。我究竟做错了什么？任何提示或解决方案？

```
using System;

namespace ConsoleApp02
{
    class Program
    {
        public static void Main(string[] args)
        {
            for(int a = 0; a < 1000; a++)
            {
                for(int b = 0; b < 1000; b++)
                {
                    for(int c = 0; c < 1000; c++)
                    {
                        for(int puls = a + b + c; puls < 1000; puls++)
                        {
                            if(puls == 1000)
                            {
                                Console.WriteLine("{0} + {1} + {2} = 1000", a, b, c);
                            }
                        }
                    }
                }
            }
            Console.ReadKey(true);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-23T18:41:34.250

您最里面的循环（迭代`puls`变量）实际上没有任何意义，并且由于它的条件（`puls < 1000`）`Console.WriteLine`永远不会运行。

也许您应该测试 A + B + C 是否为 1000，而不是。

此外，您会发现由于循环的界限（取决于问题陈述），您可能会丢失几个特定的​​数字组合。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T18:52:23.257

在单独的说明中，这个特定的实现虽然可以工作（通过其他答案建议的修改），但对性能的影响很大，因为您的算法的复杂性是 O(n^3)。换句话说，你正在经历十亿次最里面的检查。

这是一个提示，您可以如何将其优化到至少 O(n^2) 或仅一百万次迭代：对于由两个外部 for 循环生成的每一对**a**和**b ，** **c**只有一个值将导致 1000。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T19:43:17.113

问题没有指定不允许负数。答案是无限的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T19:09:49.487

如果您作为计算机科学专业的学生获得此作业，您可能希望使用[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)来解决此问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T18:43:54.010

您不需要内部循环。

```
if (a+b+c == 1000)
   write 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T18:45:45.457

在最后的内部循环中，“int puls = a + b + c; puls < 1000; puls++”你确保 puls 永远不会 = 1000，如果 puls 不小于 1000，它就会退出循环。这就是为什么你没有得到*任何*价值。但也要重新考虑你的逻辑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T18:44:23.527

一旦最里面的循环达到 1000，它就会跳出 for 循环，甚至在“if”语句中都不会检查它是否为 1000。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T18:45:02.790

该代码将不返回任何答案。

内部 for 循环添加 a + b + c 并将结果放入 puls 中。但是，您在 puls 达到 1000 之前停止循环，然后在 for 语句中进行测试以查看 puls 是否等于 1000。因此，您不会得到答案。

只需在内部循环中针对 1000 测试脉冲。为什么？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T18:45:14.757

您可以用 if (a+b+c == 1000) {...} 的测试来替换最里面的 for 循环。然后您可以添加优化，例如 - 一旦通过组合找到总和，就无需继续内部循环。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-23T18:47:29.463

代码不涵盖以下情况

*   1000 + 0 + 0
*   0 + 10000 + 0
*   0 + 0 + 10000

最里面的循环应该是**if**而不是**for**。

如果循环或 if 子句中只有一条语句，则不需要 {}。

编辑：删除代码答案

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-17T15:15:07.827

尝试这个：

```
{
    for(a=0;a<=500;a++)
    { 
        for (b=a;b<=500;b++)
        {
            c=1000-(a+b);
            count 
```

# c# - 放大 PictureBox (Windows Mobile)

> ID：578767
> 
> 赞同：0
> 
> 时间：2009-02-23T18:39:35.067
> 
> 标签：c#, windows-mobile, picturebox

我正在为 Windows Mobile 开发一个应用程序。我想放大 PictureBox 的图像。

我怎样才能做到这一点？

我认为这更复杂，因为我正在为**Windows Mobile**做。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T18:55:14.047

几乎所有与 Windows Mobile 有关的问题都可以通过 OpenNetCF 得到解答。虽然我还没有尝试过，但 OpenNetCF 有一个带有 Scale() 方法的图片框控件。也许这就是你要找的。

如果您使用[ImageViewer 控件](http://www.opennetcf.com/library/sdf/html/20054273-86a5-4125-478c-2480f1f23e12.htm)，您将获得放大/缩小。

# c# - 将 VB dll 添加到 C# 项目时出现问题

> ID：578772
> 
> 赞同：0
> 
> 时间：2009-02-23T18:40:14.317
> 
> 标签：c#, vb.net, .net-3.5, reference

我正在编译和导入[这个多列组合框类](http://www.codeproject.com/KB/cpp/multicolumncombo.aspx)。我能够顺利运行它附带的演示程序。但是，当我编译它以进行发布并将 /obj/Release/CodeSamples.dll 作为引用包含在我的 C# 项目中时，这些示例将不再起作用。具体来说，选择一个项目不起作用。我可以正确添加和显示项目，但是当我单击一个项目时，在 VB 项目中它显示第一列的值，在 C# 项目中，它不显示任何内容。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T16:08:54.943

一旦代码被编译成 dll，它是 VB.net 还是 C# 就不再重要了。它们都被编译成 IL。您的问题可能出在您自己的代码上。也不要在 obj 目录下添加对 dll 的引用。而是选择 bin 目录下的那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T19:03:30.917

我不熟悉这个特定的控件，但是您是否使用了示例 VB 代码片段，将其移植到 C# 以便在您的 C# 应用程序中使用该控件？我认为 VB 数组是基于 1 的，而 C# 数组是基于 0 的，所以在访问控件的 C# 代码中可能存在 1-off 问题。

只是一个猜测。

# java - 构造用于拖放 java 对象数组的 DataFlavor

> ID：578786
> 
> 赞同：1
> 
> 时间：2009-02-23T18:42:35.403
> 
> 标签：java, swing, drag-and-drop

我想在同一个 JVM 中的两个组件之间实现拖放。我正在传递一个不可序列化的对象数组，因此我试图找到要传入的 javaJVMLocalObjectMimeType 的正确咒语。但是，我不断收到非法参数异常。

例如，如果我有 ExampleClass

附加类参数有效：

```
 new DataFlavor(DataFlavor.javaJVMLocalObjectMimeType+";class="+ExampleClass.class.getName()); 
```

但使用数组类型失败：

```
 new DataFlavor(DataFlavor.javaJVMLocalObjectMimeType+";class="+ExampleClass[].class.getName()); 
```

抛出：

> `java.lang.IllegalArgumentException: failed to parse:application/x-java-jvm-local-objectref;class=[LExampleClass`

啊！摇摆中的拖放是一团糟！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T19:35:49.907

试试这个：

```
new DataFlavor(DataFlavor.javaJVMLocalObjectMimeType +
               ";class=\""+ExampleClass.class.getName() + "\""); 
```

由于数组的名称（例如“[Ljava.lang.Object;”）具有特殊字符，因此您必须引用“class”参数。

# c++ - 班次操作

> ID：578791
> 
> 赞同：0
> 
> 时间：2009-02-23T18:43:38.847
> 
> 标签：c++, stl, bit-manipulation

我看到了其中一位 stackoverflower 同事发布的以下内容，这让我有些目瞪口呆。

有人会在以下代码片段中解释移位操作：

```
std::vector<bool> a;
a.push_back(true);
a.push_back(false);
//...
for (auto it = a.begin(); it != a.end();) // see 0x for meaning of auto
{
    unsigned b = 0;
    for (int i = 0; i < 8*sizeof(b); ++i)
    {
        b |= (*it & 1) << (8*sizeof(b) - 1 - i);
        ++it;
    }
    // flush 'b'
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T18:49:12.687

8 * sizeof(b) 是可以存储在“b”中的位数（这是一个无符号整数，即通常为 32 或 64 位）。

代码所做的是它将向量'a'中的布尔值打包成'b'中的位。

如果 *it 处的布尔值为 TRUE，则“*it & 1”评估为 1，否则为 0。然后该位左移 32 位减去 1 减去索引“i”，即从零左移到 31 位。这意味着现在“a”的第一个元素将控制“b”上的最高有效位（左移 31），第二个元素将控制“b”上的第二个最高有效位（左移 30）等。请注意，在 C移位是算术的，即无论字节或位顺序如何，x << 1 始终为 x * 2。

例如，如果您的向量具有第一个和第 30 个元素集，则“b”应该在一天结束时包含二进制数 10000000 00000000 00000000 00000100。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T18:55:23.563

antti.huima 的回答对我来说是正确的。

但是，程序中可能存在错误。外部循环从 a.begin 到 a.end，但是内部循环递增“it”，无论这是否导致“it”超过 a.end。

如果您传递一个“奇数”大小的向量，比如 33 个条目，则结果可能不正确。

如果向量的大小得到保证，这可能不是错误（但也许应该测试长度是否有效）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T18:57:03.450

那里发生了什么：

```
(*it & 1) 
```

这应该是 0 或 1，具体取决于布尔值是真还是假；但是请注意，布尔值始终为 0 或 1，因此这可能只是 (unsigned)*it

```
<< (8*sizeof(b) - 1 - i) 
```

这是一个移位，它将位从最右边的位置移动到左边的第*i*个位置。我们正在移动一个最多设置一个位的数字，所以这将设置第*i*个最左边的位或不设置。其余位为零。

```
b |= ... 
```

`b`这将设置在 RHS 中的那些位。

```
i++; 
```

转到下一个输入数字。注意保持在输入范围内。

这意味着整个事物将在 中设置位`b`，对应于为真的向量元素。

# c++ - boost.asio 如何发现我的服务器应用程序正在侦听哪个端口？

> ID：578794
> 
> 赞同：5
> 
> 时间：2009-02-23T18:44:32.653
> 
> 标签：c++, boost, boost-asio

当客户端应用程序连接到服务器时，boost.asio 不使用基本概念对我来说有点奇怪 - 使用 IP 地址和端口。可能是我在 Boost 中有点菜鸟——我接受这一点——但无论如何我不明白。
所以，我有这样的代码让客户端连接到本地主机上的服务器：

```
 boost::asio::io_service io_service;
        tcp::resolver resolver(io_service);
        tcp::resolver::query query("localhost", "daytime"); 
        tcp::resolver::iterator endpoint_iterator = resolver.resolve(query); 
        tcp::resolver::iterator end;

        tcp::socket socket(io_service);
        boost::system::error_code error = boost::asio::error::host_not_found;
        while(error && endpoint_iterator != end) {
            socket.close();
            socket.connect(*endpoint_iterator++, error);
        } 
```

Windows 在其 WinSock 2.0 中使用两个参数——IP 和端口——来识别服务器。
所以，问题是 - Asio 究竟是如何找出服务器在哪个端口上监听连接的？它会扫描所有端口吗？而且，如果确实如此，如果两台服务器同时监听不同的端口会发生什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-30T00:27:42.373

尝试，

```
tcp::resolver::query query("localhost", boost::lexical_cast<string>(port));//assuming port is an int 
```

要回答您的问题，请记住您在端口 13 上启动服务器。这恰好是运行 Linux 日间服务的端口[(http://www.sorgonet.com/linux/linuxdaemons/)](http://www.sorgonet.com/linux/linuxdaemons/)。因此，他们随后能够使用 query("localhost","daytime") 而不是指定端口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T18:49:50.160

你告诉它你想在日间服务使用的端口上连接到 localhost。它将在服务文件中查找相应的端口号（通常是 Windows 下的 C:\WINDOWS\system32\drivers\etc\services，我相信 Unix 下的 /etc/services）。您也可以在那里使用明确的端口号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-03T13:23:50.460

在 localhost 上的端口 13 上打开 netcat 侦听，它将接受演示的连接。连接时输入一些 blabla，您将在演示程序中看到运行 netcat 的输出，运行：nc -l -p 13

视窗？没有网猫？安装cygwin，添加netcat

# java - 二维数组是否比 Java 中的一维数组使用更多资源？

> ID：578798
> 
> 赞同：1
> 
> 时间：2009-02-23T18:45:05.803
> 
> 标签：java, arrays, resources, cpu

例如，一个完整的 int[50][8] 会比 8 个完整的 int[50] 数组使用更多的资源（RAM 和 CPU）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T18:52:48.450

在第一种情况下，您有一个数组对象指向 50 个包含 8 个 int 的数组对象。所以第一个数组对象中有 1 + 50 个数组对象 + 50 个指针。

在第二种情况下，您有一个数组对象指向 8 个包含 50 个 int 的数组对象。所以第一个数组对象中有 1 + 8 个数组对象 + 8 个指针。持有 int 是一种洗涤。

没有一个好的方法来评估 CPU 使用率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T19:02:24.200

这里似乎有三件事可以比较。

*   `new int[50][8]`
*   `new int[8][50]`
*   `new int[400]`

现在，我对此感到困惑，但要记住的方法是考虑`new int[50][]`哪个是有效的。

`new int[50][8]`由 50 个大小为 8 的数组（51 个对象）组成的数组也是如此。`new int[8][50]`是一个由 8 个大小为 50 的数组（9 个对象）组成的数组。9 个对象的开销将低于 51个。`new int[400]`只是一个对象。

但是，在这种大小下，它可能不会对您的程序性能产生任何可衡量的差异。您可能希望将数组封装在一个对象中，这将允许您更改实现并为客户端代码提供更自然的接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T19:09:02.843

一个额外的使用点（来自我现在找不到的参考资料，但相当常识） -

本文的作者正在测试将稀疏数组压缩为多维数组的各种方法。他们注意到的一件事是，迭代的速度会有所不同——

这个想法是，如果你有 int[i][j] 这样做会更快

```
for (i) { 
     for (j) 
```

比做

```
for (j) { 
     for (i) 
```

因为在第一个实例中，您正在遍历连续存储的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T19:07:09.743

您可以通过使用 int[] myInt = int[400] 数组来调整少量内存，并使用 myInt[x+y*50] 手动访问位置 (x,y) 处的 int，这将为您节省 50 32-一点点记忆。以这种方式访问​​它可能会（谁知道热点编译器对此做了什么..）需要多一条指令来进行乘法运算。

这种微优化很可能不会使您的应用程序性能更好，并且会降低可读性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T19:10:53.760

我建议为此使用非常大的数组编写一个小型性能测试，以查看实际差异。实际上，我认为这不会有丝毫不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T20:56:59.667

int[50][8] 是 50 个长度为 8 的数组 int[8][50] 是 8 个长度为 50 的数组 int[400] 是一个数组 400。每个数组有大约 16 个字节的开销。

但是，对于您在这里的尺寸，这并不重要。无论哪种方式，您都不会节省太多。

# python - AuiNotebook，事件发生在哪里

> ID：578800
> 
> 赞同：1
> 
> 时间：2009-02-23T18:45:11.387
> 
> 标签：python, wxpython, wxwidgets

如何找出事件发生在哪个 AuiNotebook 页面？

编辑：对此感到抱歉。这是一个代码示例。如何从单击鼠标的女巫中找到笔记本页面？

```
#!/usr/bin/python

#12_aui_notebook1.py

import wx
import wx.lib.inspection

class MyFrame(wx.Frame):
    def __init__(self, *args, **kwds):
        wx.Frame.__init__(self, *args, **kwds)

        self.nb = wx.aui.AuiNotebook(self)

        self.new_panel('Pane 1')
        self.new_panel('Pane 2')
        self.new_panel('Pane 3')

    def new_panel(self, nm):
        pnl = wx.Panel(self)
        self.nb.AddPage(pnl, nm)
        self.sizer = wx.BoxSizer()
        self.sizer.Add(self.nb, 1, wx.EXPAND)
        self.SetSizer(self.sizer)

        pnl.Bind(wx.EVT_LEFT_DOWN, self.click)

    def click(self, event):
        print 'Mouse click'
            #How can I find out from witch page this click came from?

class MyApp(wx.App):
    def OnInit(self):
        frame = MyFrame(None, -1, '12_aui_notebook1.py')
        frame.Show()
        self.SetTopWindow(frame)
        return 1

if __name__ == "__main__":
    app = MyApp(0)
#    wx.lib.inspection.InspectionTool().Show()
    app.MainLoop() 
```

欧尔扬·彼得森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T05:02:36.020

对于鼠标单击，您可以假设当前选定的页面是获得点击的页面。我在您的代码中添加了几行。看评论

```
def new_panel(self, nm):
    pnl = wx.Panel(self)
    # just to debug, I added a string attribute to the panel
    # don't you love dynamic languages? :)
    pnl.identifierTag = nm   
    self.nb.AddPage(pnl, nm)
    self.sizer = wx.BoxSizer()
    self.sizer.Add(self.nb, 1, wx.EXPAND)
    self.SetSizer(self.sizer)

    pnl.Bind(wx.EVT_LEFT_DOWN, self.click)

def click(self, event):
    print 'Mouse click'
    # get the current selected page
    page = self.nb.GetPage(self.nb.GetSelection())
    # notice that it is the panel that you created in new_panel
    print page.identifierTag 
```

# mouse - X11（linux桌面）下如何设置鼠标位置？

> ID：578804
> 
> 赞同：4
> 
> 时间：2009-02-23T18:45:32.930
> 
> 标签：mouse, x11

我想知道如何在X11下设置鼠标光标位置？有没有可能，如果，我必须在哪里寻找合适的功能？X 窗口系统、KDE/Gnome/...？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-23T18:49:50.283

听起来您正在使用 X，所以您可能想要的是[`XWarpPointer`](http://tronche.com/gui/x/xlib/input/XWarpPointer.html). 要在整个屏幕上给出绝对位置，请使用根窗口作为目标窗口。

（您可以使用快速而肮脏的 X 函数列表`ls /usr/share/man/man3/ | grep '^X'`）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-08-06T21:20:11.620

我知道这个问题很老了，但我刚刚发现了 xdotool ，它看起来很棒：

[http://www.semicomplete.com/projects/xdotool/](http://www.semicomplete.com/projects/xdotool/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-22T09:45:45.580

尝试使用 xte 命令（xautomation 包的一部分）。详情[在这里](http://www.linuxjournal.com/article/6415)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T18:55:45.917

如果您在 xterm 中执行此操作，则 Xterm 可以理解 ANSI 控制代码。[这里](http://en.wikipedia.org/wiki/ANSI_escape_code)有这些代码的列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-22T18:41:42.617

要从 shell 脚本执行，请使用[xwit](http://www.slack.com/sw/xwit-man.html)命令行工具。

# python - 需要帮助理解 Python 中的函数传递

> ID：578812
> 
> 赞同：4
> 
> 时间：2009-02-23T18:47:43.237
> 
> 标签：python

我正在尝试通过解决我提出的一些问题来自学 Python，并且我需要一些帮助来理解如何传递函数。

假设我正在尝试根据今天和昨天的温度来预测明天的温度，并且我编写了以下函数：

```
def predict_temp(temp_today, temp_yest, k1, k2):
    return k1*temp_today + k2*temp_yest 
```

而且我还编写了一个误差函数来将预测温度列表与实际温度进行比较，并返回平均绝对误差：

```
def mean_abs_error(predictions, expected):
    return sum([abs(x - y) for (x,y) in zip(predictions,expected)]) / float(len(predictions)) 
```

现在，如果我有过去某个时间间隔的每日温度列表，我可以看到我的预测函数将如何**处理特定的 k1 和 k2 参数**，如下所示：

```
>>> past_temps = [41, 35, 37, 42, 48, 30, 39, 42, 33]
>>> pred_temps = [predict_temp(past_temps[i-1],past_temps[i-2],0.5,0.5) for i in xrange(2,len(past_temps))]
>>> print pred_temps
[38.0, 36.0, 39.5, 45.0, 39.0, 34.5, 40.5]
>>> print mean_abs_error(pred_temps, past_temps[2:])
6.5 
```

**但是如何设计一个函数来最小化我的 predict_temp 函数的参数 k1 和 k2 给定一个误差函数和我的 past_temps 数据？**

具体来说，我想编写一个函数 minimize(args*) ，它接受一个预测函数、一个误差函数、一些训练数据，并使用一些搜索/优化方法（例如梯度下降）来估计和返回 k1 的值和k2 在给定数据的情况下最小化我的错误？

我不是在问如何实现优化方法。假设我能做到。相反，我只想知道**如何将我的预测和误差函数**（以及我的数据）传递给我的最小化函数，以及**如何告诉我的最小化函数它应该优化参数 k1 和 k2**，以便我的最小化函数可以自动搜索 k1 和 k2 的一堆不同设置，每次将我的预测函数与这些参数一起应用于数据和计算错误（就像我在上面手动为 k1=0.5 和 k2=0.5 所做的那样），然后返回最佳结果。

我希望能够传递这些函数，这样我就可以轻松地交换不同的预测和误差函数（不同之处不仅仅是参数设置）。每个预测函数可能有不同数量的自由参数。

我的最小化功能应该是这样的，但我不知道如何进行：

```
def minimize(prediction_function, which_args_to_optimize, error_function, data):
    # 1: guess initial parameters
    # 2: apply prediction function with current parameters to data to compute predictions
    # 3: use error function to compute error between predictions and data
    # 4: if stopping criterion is met, return parameters
    # 5: update parameters
    # 6: GOTO 2 
```

编辑：就这么简单？？这不好玩。我要回到Java。

更严肃地说，我想我也对如何使用不同数量的参数进行调整的不同预测函数感到困惑。如果我只是将所有自由参数作为一个元组，我可以保持函数的形式相同，以便于传递和使用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-23T18:59:04.037

这是一个如何将函数传递给另一个函数的示例。 `apply_func_to`将一个函数`f`和一个数字`num`作为参数和`return f(num)`.

```
def my_func(x):
    return x*x

def apply_func_to(f, num):
    return f(num)

>>>apply_func_to(my_func, 2)
4 
```

如果你想聪明一点，你可以使用 lambda（也可以使用匿名函数）。这些允许您“即时”传递函数，而无需单独定义它们

```
>>>apply_func_to(lambda x:x*x, 3)
9 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T18:55:35.387

在 Python 中传递函数很简单，只需将函数的名称用作包含函数本身的变量即可。

```
def predict(...):
    ...

minimize(predict, ..., mean_abs_error, ...) 
```

至于问题的其余部分：我建议看看[SciPy 将其](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.leastsq.html#scipy.optimize.leastsq)作为模型实现的方式。基本上，它们具有`leastsq`最小化残差平方和的函数（我假设您知道最小二乘最小化是什么;-)。您传递给`leastsq`的是一个计算残差的函数、参数的初始猜测以及传递给残差计算函数（闭包）的任意参数，其中包括数据：

```
# params will be an array of your k's, i.e. [k1, k2]
def residuals(params, measurements, times):
    return predict(params, times) - measurements

leastsq(residuals, initial_parameters, args = (measurements, times)) 
```

请注意，SciPy 实际上并不关心您如何得出残差。该`measurements`数组只是原封不动地传递给您的`residuals`函数。

如果您想了解更多信息，我可以查找我最近做的一个示例 - 当然，您也可以在网上找到示例，但根据我的经验，它们并不那么清楚。我编写的特定代码将与您的场景很好地相关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T20:10:19.873

正如[David](https://stackoverflow.com/questions/578812/need-help-understanding-function-passing-in-python/578855#578855)和[Il-Bhima](https://stackoverflow.com/questions/578812/need-help-understanding-function-passing-in-python/578869#578869)所指出的，函数可以像任何其他类型的对象一样传递给其他函数。当您传入一个函数时，您只需像通常那样调用它。人们有时会通过说函数是Python中的*第一类来提及这种能力。*在更详细的层面上，您应该将 Python 中的函数视为一种*可调用对象*。Python 中另一种重要的可调用对象是类对象。在这种情况下，调用类对象会创建该对象的实例。这个概念在[这里](http://docs.python.org/reference/expressions.html#id9)详细讨论。

通常，您可能希望利用 Python 的位置和/或关键字参数功能，如此处[所述](http://docs.python.org/tutorial/controlflow.html#more-on-defining-functions)。这将允许您编写一个通用最小化器，该最小化器可以最小化采用不同参数集的预测函数。我写了一个例子——它比我想要的更复杂（使用生成器！）但它适用于具有任意参数的预测函数。我已经掩盖了一些细节，但这应该可以帮助您入门：

```
def predict(data, k1=None, k2=None):
    """Make the prediction."""
    pass

def expected(data):
    """Expected results from data."""
    pass

def mean_abs_err(pred, exp):
    """Compute mean absolute error."""
    pass

def gen_args(pred_args, args_to_opt):
    """Update prediction function parameters.

    pred_args : a dict to update 
    args_to_opt : a dict of arguments/iterables to apply to pred_args

    This is a generator that updates a number of variables 
    over a given numerical range.  Equivalent to itertools.product.

    """

    base_args = pred_args.copy() #don't modify input

    argnames = args_to_opt.keys()
    argvals = args_to_opt.values()
    result = [[]]
    # Generate the results
    for argv in argvals:
        result = [x+[y] for x in result for y in argv]
    for prod in result:
        base_args.update(zip(argnames, prod))
        yield base_args

def minimize(pred_fn, pred_args, args_to_opt, err_fn, data):
    """Minimize pred_fn(data) over a set of parameters.

    pred_fn : function used to make predictions
    pred_args : dict of keyword arguments to pass to pred_fn
    args_to_opt : a dict of arguments/iterables to apply to pred_args
    err_fn : function used to compute error
    data : data to use in the optimization

    Returns a tuple (error, parameters) of the best set of input parameters.
    """
    results = []
    for new_args in gen_args(pred_args, args_to_opt):
        pred = pred_fn(data, **new_args) # Unpack dictionary
        err = err_fn(pred, expected(data))
        results.append((err, new_args))
    return sorted(results)[0]

const_args = {k1: 1}
opt_args = {k2: range(10)}
data = [] # Whatever data you like.
minimize(predict, const_args, opt_args, mean_abs_err, data) 
```

# c# - RichTextBox 颜色选定的行

> ID：578813
> 
> 赞同：9
> 
> 时间：2009-02-23T18:47:53.987
> 
> 标签：c#, .net, winforms, richtextbox

我是 Windows 窗体的新手。我正在使用 VS 2008、C# 编写 RichTextBox。当我写到 RichTextBox 时，我希望能够用不同的颜色为每一行着色。有人能指点我的样品吗？谢谢

```
foreach (string file in myfiles)
{
  // As I process my files
  // richTextBox1.Text += "My processing results";
  if(file == "somefileName")
  {
    // Color above entered line or enter new colored line
  }

} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-23T18:54:48.960

`SelectionColor`在追加之前设置，例如：

```
 int line = 0;
    foreach (string file in myfiles)
    {
        // Whatever method you want to choose a color, here
        // I'm just alternating between red and blue
        richTextBox1.SelectionColor = 
            line % 2 == 0 ? Color.Red : Color.Blue;

        // AppendText is better than rtb.Text += ...
        richTextBox1.AppendText(file + "\r\n");
        line++;
    } 
```

# regex - 如何使用RegExp删除大字符串中的一小部分字符串

> ID：578821
> 
> 赞同：0
> 
> 时间：2009-02-23T18:49:28.880
> 
> 标签：regex

嘿伙计们，我还不知道 RegExp。我对此有所了解，但我不是经验丰富的用户。

假设我在网站上运行 RegExp 匹配，匹配是：

```
Data: Informations
Data: Liberty 
```

然后我只想提取 Informations 和 Liberty，我不想要 Data: 部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T18:52:13.057

如果不了解更多关于潜在匹配的信息，就不能绝对确定，但这至少应该是一个很好的起点：

```
Data: (.*)$ 
```

这会将“数据：”之后的所有内容返回到行尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T18:54:12.130

1.  `Data:`总是出现在一行的开头？
2.  `:`下一个单词之间可以有多个空格吗？
3.  你知道群吗？
4.  你想要什么：惰性匹配与贪婪匹配？

如果是这样，您可以使用（使用延迟匹配）：

```
^Data:\s+(.*?)$ 
```

使用字符类：

```
^Data:\s+(\w+)$ 
```

如果你知道它永远是一个词。试试这个[网站](http://gskinner.com/RegExr/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T18:52:14.100

搜索正则表达式，如

```
Data: (.*) 
```

然后使用“第一个子匹配”，通常用“$1”或“\1”来表示，具体取决于您使用的语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T21:03:57.410

正则表达式引擎支持通常所说的“捕获组”。如果用 () 包围模式或模式的一部分，则将捕获与正则表达式的该部分匹配的字符串部分。

您用于进行匹配的命令将确定如何获取这些捕获的值。它们可能存储在特殊变量中（例如：$1、$2），或者您可以指定嵌入在正则表达式中的变量的名称或作为正则表达式命令的参数。具体如何取决于您使用的语言。

因此，请阅读您选择的语言的正则表达式命令，并查找术语“捕获组”或可能只是“组”。

# wpf - 为什么我的 WPF 文本框“有点”只读？

> ID：578826
> 
> 赞同：27
> 
> 时间：2009-02-23T18:50:28.723
> 
> 标签：wpf, .net-3.5

我在 WPF 中有一个文本框，它是列表框数据模板的一部分。在那个文本框中，我可以删除、退格、空格键，但我不能输入新单词、字母或数字。我可以从记事本粘贴。

我在这里想念什么？

```
 <ListBox Grid.Column="1"
         ItemsSource="{Binding Details}"
         VirtualizingStackPanel.VirtualizationMode="Recycling"
         HorizontalContentAlignment="Stretch" >
            <ListBox.Resources>
                <DataTemplate DataType="{x:Type Entities:RADetailEntry}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <ComboBox Grid.Column="0" />
                        <TextBox Grid.Column="1" IsReadOnly="False" IsEnabled="True" 
                                 Text="{Binding Path=Description, Mode=TwoWay}" TextWrapping="Wrap"
                                 HorizontalAlignment="Stretch" VerticalAlignment="Stretch" TextAlignment="Left"  />
                    </Grid>
                </DataTemplate>
            </ListBox.Resources>
        </ListBox> 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-12T17:05:58.197

我遇到了与此非常相似的问题。经过一番研究，我发现 MSDN 中列出了一个类似的问题：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/c68d5f3c-c8cc-427d-82e3-6135d075a304/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/c68d5f3c-c8cc-427d-82e3-6135d075a304/)

根据帖子的答案，问题与 WPF 和 WinForms 有两种截然不同的处理文本输入的方式有关。幸运的是，上面列出的帖子提供了以下解决方案：

启动窗口时，使用 ElementHost.EnableModelessKeyboardInterop(window1)。请注意，这是一个静态方法 - 您不必实例化 ElementHost 类。

例如，

```
Window window1 = new Window();
ElementHost.EnableModelessKeyboardInterop(window1);
window1.Show(); 
```

这为我解决了这个问题。希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T10:59:07.197

我也发现了相同的行为，但在混合 wpf 和 win 表单时没有。

我制作了一个自定义组合框，它可以在自己/在一个小测试项目中正常工作，但是当放置在应用程序中时，当它被点击时它没有正确获得键盘焦点。

点击被触发，但随后他们的文本框立即失去焦点。同样，您可以粘贴内容但不能正常输入。

事实证明（很好的一个 Snoop（[http://snoopwpf.codeplex.com/](http://snoopwpf.codeplex.com/)）），其中包含大量组合框的滚动查看器正在窃取键盘焦点。

将事件标记为已处理阻止了这种情况的发生并使其按预期工作：

```
 private void ClickOnStack(object sender, MouseButtonEventArgs e)
    {
        //do other stuff with click
        _textBox.Focus();

        //note this is key to stop things like scrollviewers nicking focus 
        e.Handled = true;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T20:16:23.383

我创建了一个简单的测试应用程序，我可以在 ListBox 的 TextBoxes 中输入新文本：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:WpfApplication1"
    Title="Window1" Height="300" Width="300">
    <ListBox ItemsSource="{Binding Details}"
        HorizontalAlignment="Stretch"
        VirtualizingStackPanel.VirtualizationMode="Recycling">
        <ListBox.Resources>
            <DataTemplate DataType="{x:Type app:Data}">
                <StackPanel Orientation="Horizontal">
                    <ComboBox />
                    <TextBox SpellCheck.IsEnabled="True" TextWrapping="Wrap"
                        HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                        Text="{Binding Path=Text, Mode=TwoWay}" />
                </StackPanel>
            </DataTemplate>
        </ListBox.Resources>
    </ListBox>
</Window> 
```

我可以看到两者之间的唯一区别是`ItemTemplate`你的 ListBox 上设置了一个，而我的没有一个。XAML 有什么用`rADetailEntryLayout`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-13T09:49:26.960

显然需要将带有 x:Name="PART_ContentHost" 的 ScrollViewer 元素添加到 Border 元素，请参阅以下注释：http: [//msdn.microsoft.com/en-us/library/ms752068.aspx](http://msdn.microsoft.com/en-us/library/ms752068.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-04T13:44:38.767

首先，您是否注意到您的 Item 上没有设置 ItemTemplate？第二，为什么要在资源中声明 DataTemplate？你愿意在 ItemTemplate 上使用多种类型吗？如果是这样，您将需要一个 DataTemplateSelector，它将返回指定类型的特定 DataTemplate，否则，如果您只需要将模板添加到此特定项目，请将 ListBox.Resources 替换为 ListBox.ItemTemplate 并从 dataTemplate 中删除键，编译它，然后就可以了。

这是正常工作的方式：

```
<ListBox Grid.Column="1" ItemsSource="{Binding Path=Details}" VirtualizingStackPanel.VirtualizationMode="Recycling" HorizontalContentAlignment="Stretch" >
        <!-- Remove this <ListBox.Resources> -->
        <!-- Add this -->
        <ListBox.ItemTemplate>
            <!-- Remove this <DataTemplate DataType="{x:Type Entities:RADetailEntry}"> -->
            <!-- Add this -->
            <DataTemplate>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox Grid.Column="0" />
                    <TextBox Grid.Column="1" IsReadOnly="False" IsEnabled="True" 
                        Text="{Binding Path=Description, Mode=TwoWay}" TextWrapping="Wrap"
                        HorizontalAlignment="Stretch" VerticalAlignment="Stretch" TextAlignment="Left"
                        />
                </Grid>
            </DataTemplate>
        <!-- Remove this </ListBox.Resources> -->
        <!-- Add this -->
        </ListBox.ItemTemplate>
    </ListBox> 
```

希望这仍然有用，因为问题已经发布了很长时间......

# .net - 从触发器中调用 Web 服务的最佳做法是什么（SQL Server）

> ID：578835
> 
> 赞同：2
> 
> 时间：2009-02-23T18:52:11.480
> 
> 标签：.net, sql-server, web-services

当表中的特定列发生更改时，我需要调用 Web 服务。我可以决定在插入/更新/删除中更改了哪一列，但我不确定我应该如何调用 web 服务。

网络服务是异地的，我们对它有一点控制（我们可以要求更改并获得相当快速的响应），但该服务正在进行中，我们的代码也是如此。

SQL Server 版本是 2005。

**更新**：这个应用程序中的大部分业务逻辑都在 SQL 层中。我没有办法改变它，抱怨它不是很好地利用我的时间。就是这样。希望有一个业务逻辑层，但它部分位于 pres 层，部分位于 SQL 层。表中的触发器是最中心的地方。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-23T18:54:03.567

不。Web 服务的开销与数据库的执行处理周期不兼容。将其从数据库中取出并（最好）使其异步 - 请参阅下面各种答案中对“队列/监视器”的引用。

也可能是[重复问题](https://stackoverflow.com/questions/490987/timeout-when-accessing-webservice-from-sql-clr)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T18:57:17.753

让触发器在表中插入一行，其中包含 Web 服务所需的任何数据，然后让外部进程监视该表并在出现新行时调用 Web 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T18:57:57.377

CLR 函数可以发出 Web 服务请求并处理响应。但这是您的情况，您可能希望创建一个 CLR 函数并在 SQL 对象中的某处调用该函数。

我建议在高层而不是数据库级别进行 Web 服务调用。例如，修改该列的代码中的数据访问层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T19:01:39.287

大多数商店关闭 SQL 框上的 80 端口

此外，触发器应该是平均的和精简的，并尽可能快地返回，你不想从触发器调用外部的东西

将触发器内的数据转储到另一个表中，然后编写另一个进程来检查该表，然后执行 Web 服务调用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T19:08:29.723

我只想重申已经说过的话。我曾在已经实施的情况下工作过，这是一场噩梦。

您最终将得到一个非常无响应的数据库，因为在触发器执行对 Web 服务的调用时行将被锁定。因此，如果 Web 服务很慢或网络延迟很高，您将长时间运行事务锁定行并降低数据库的并发性。

我看到此实现的站点已更改为与 moose 描述的相同，并且随着数据库并发性的显着增加，整个应用程序获得了巨大的提升。

# c# - 专门针对 C# 开发人员的 VS2005 提示和技巧

> ID：578847
> 
> 赞同：0
> 
> 时间：2009-02-23T18:53:23.270
> 
> 标签：c#, visual-studio, visual-studio-2008, visual-studio-2005

让我们摆脱重复指控。

我看到了这个问题的几个变体，特别是[link](https://stackoverflow.com/questions/15779/what-are-the-best-unknown-features-of-visual-studio-net-2005)。但是，它没有解决特定于 C# 开发人员的问题。我想从在 Visual Studio 2005 下使用 C# 的人那里收集一个最常用/最强大/很酷的技巧列表 - VS 中的提示（也可以提及 2008 年）。以下是我用作指南的链接：

[msdn](http://msdn.microsoft.com/en-us/library/bb245788(VS.80).aspx) <-- 我们来自 Microsoft 的人员有一两个提示要分享

[Kirill 的 Visual Studio 技巧](http://blogs.msdn.com/kirillosenkov/archive/2008/10/21/kirill-s-visual-studio-tips.aspx) <-- 这个博客也有几个很好的链接

*还鼓励调试技巧*

感谢您分享您的技巧并提高我的工作效率:)

**我的一些武器库：**

*   `Ctrl`+ `-`, `Ctrl`+ `+`, 在你最近去过的地方前后导航

*   `Ctrl`+ `Shift`+ `V`，它将循环浏览您的剪贴板历史记录

*   `F12`转到变量的定义。

*   `Ctrl`+ `K`, `Ctrl`+`C`以 // 开头的文本块注释

*   `Ctrl`- `K`, `Ctrl`-`U`取消注释以 // 开头的文本块

*   `Ctrl`+`/`进入查找框。

*   `Ctrl`+`I`用于增量搜索，`F3`迭代

*   在调试模式下选择一个表达式/变量并键入`Ctrl`+ `D`, `Ctrl`+`Q`以打开快速监视窗口。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T18:56:59.533

这是我上周刚刚找到的一个网站 [http://scottcate.com/tricks/](http://scottcate.com/tricks/)

我的第一条建议是去购买 Resharper！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T19:10:07.613

我最喜欢的片段之一是用于枚举的片段。

假设您有以下代码：

```
private void DoSomethingForToday(DayOfWeek today)
{
   //in here you want to do something different depending on which day it is, so you need a switch/case
   //you type switch, hit tab twice, you'll get this:

            switch (switch_on) //switch_on will be highlighted, replace it with "today" and hit enter. It will automatically fill in all the possible enum values with case statements.
            {
                default:
            }    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T18:57:11.687

“片段”的 tab 键

例如，键入“try”，然后按两次 Tab 键。

结果是：

```
try 
{           

}
catch (Exception)
{

    throw;
} 
```

然后你可以扩展它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T19:47:11.363

CTRL + ALT + P 附加一个进程，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T19:21:53.437

Ctrl-W, Ctrl-A -> 专注于即时窗口（窗口本身未充分利用 IMO）。
of (filename) 在即时窗口中打开文件。您可以在解决方案中的所有文件中获得很好的路径/名称完成。
Ctrl-W, Ctrl-S -> 专注于解决方案资源管理器。
在调试模式下选择一个表达式/变量并键入 Ctrl-D,Ctrl-Q 以打开快速监视窗口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-23T19:45:23.350

[请参阅StackOverFlow](https://stackoverflow.com/questions/9033/hidden-features-of-c)此处。

不要让 url 欺骗你：“友好”的 url 会去掉 # 符号。这是 StackOverflow 上投票率最高的第三个问题，顺便说一句，所以它不像是完全隐藏的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T15:02:38.630

你看过[这个博客](http://blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx)……以及由此而来的[《Microsoft Visual Studio Tips》一书吗？](https://rads.stackoverflow.com/amzn/click/com/0735626405)

# mysql - SQL查询：从表中删除除最新N之外的所有记录？

> ID：578867
> 
> 赞同：97
> 
> 时间：2009-02-23T18:58:38.983
> 
> 标签：mysql, sql, sql-delete

是否可以构建单个 mysql 查询（不带变量）以从表中删除所有记录，除了最新的 N（按 id desc 排序）？

像这样的东西，只是它不起作用:)

```
delete from table order by id ASC limit ((select count(*) from table ) - N) 
```

谢谢。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2009-02-23T19:13:34.907

您不能以这种方式删除记录，主要问题是您不能使用子查询来指定 LIMIT 子句的值。

这有效（在 MySQL 5.0.67 中测试）：

```
DELETE FROM `table`
WHERE id NOT IN (
  SELECT id
  FROM (
    SELECT id
    FROM `table`
    ORDER BY id DESC
    LIMIT 42 -- keep this many records
  ) foo
); 
```

中间子查询*是*必需的。没有它，我们会遇到两个错误：

1.  **SQL 错误 (1093)：您无法在 FROM 子句中指定要更新的目标表“表”** - MySQL 不允许您在直接子查询中引用要删除的表。
2.  **SQL 错误 (1235)：此版本的 MySQL 尚不支持“LIMIT & IN/ALL/ANY/SOME 子查询”** - 您不能在 NOT IN 运算符的直接子查询中使用 LIMIT 子句。

幸运的是，使用中间子查询可以让我们绕过这两个限制。

* * *

Nicole 指出这个查询可以针对某些用例（例如这个）进行显着优化。我建议您也阅读[该答案](https://stackoverflow.com/a/8303440/69713)，看看它是否适合您的答案。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2011-11-28T22:41:29.353

我知道我正在复活一个相当老的问题，但我最近遇到了这个问题，但需要一些可以**很好地扩展到大量的**东西。没有任何现有的性能数据，并且由于这个问题引起了相当多的关注，我想我会发布我发现的内容。

实际有效的解决方案是[Alex Barrett 的双子查询/`NOT IN`](https://stackoverflow.com/a/578926/143295)方法（类似于[Bill Karwin 的](https://stackoverflow.com/a/578905/143295)）和[Quassnoi 的`LEFT JOIN`](https://stackoverflow.com/a/578884/143295)方法。

**不幸的是，上述两种方法都会创建非常大的中间临时表，并且随着未**删除的记录数量变大，性能会迅速下降。

我决定使用 Alex Barrett 的双子查询（谢谢！），但使用`<=`而不是`NOT IN`：

```
DELETE FROM `test_sandbox`
  WHERE id <= (
    SELECT id
    FROM (
      SELECT id
      FROM `test_sandbox`
      ORDER BY id DESC
      LIMIT 1 OFFSET 42 -- keep this many records
    ) foo
  ); 
```

它用于`OFFSET`获取第**N**条记录的 id 并删除该记录和所有以前的记录。

由于排序已经是这个问题的一个假设 ( `ORDER BY id DESC`)，`<=`因此非常适合。

它要快得多，因为子查询生成的临时表只包含一条记录而不是**N**条记录。

## 测试用例

我在两个测试用例中测试了上面的三种工作方法和新方法。

两个测试用例都使用 10000 个现有行，而第一个测试保留 9000 个（删除最旧的 1000 个），第二个测试保留 50 个（删除最旧的 9950 个）。

```
+-----------+------------------------+----------------------+
|           | 10000 TOTAL, KEEP 9000 | 10000 TOTAL, KEEP 50 |
+-----------+------------------------+----------------------+
| NOT IN    |         3.2542 seconds |       0.1629 seconds |
| NOT IN v2 |         4.5863 seconds |       0.1650 seconds |
| <=,OFFSET |         0.0204 seconds |       0.1076 seconds |
+-----------+------------------------+----------------------+ 
```

有趣的是，该`<=`方法在整体上看到了更好的性能，但实际上你保留的越多，性能就会越好，而不是越差。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-23T19:08:00.193

不幸的是，对于其他人给出的所有答案，您不能在同一个查询中使用给定的表`DELETE`。`SELECT`

```
DELETE FROM mytable WHERE id NOT IN (SELECT MAX(id) FROM mytable);

ERROR 1093 (HY000): You can't specify target table 'mytable' for update 
in FROM clause 
```

MySQL 也不支持`LIMIT`子查询。这些是 MySQL 的限制。

```
DELETE FROM mytable WHERE id NOT IN 
  (SELECT id FROM mytable ORDER BY id DESC LIMIT 1);

ERROR 1235 (42000): This version of MySQL doesn't yet support 
'LIMIT & IN/ALL/ANY/SOME subquery' 
```

我能想到的最佳答案是分两个阶段进行：

```
SELECT id FROM mytable ORDER BY id DESC LIMIT n; 
```

收集 id 并将它们制成逗号分隔的字符串：

```
DELETE FROM mytable WHERE id NOT IN ( ...comma-separated string... ); 
```

（通常将逗号分隔的列表插入 SQL 语句会带来一些 SQL 注入风险，但在这种情况下，这些值不是来自不受信任的来源，它们被认为是来自数据库本身的整数值。）

**注意：**虽然这并不能在*单个*查询中完成工作，但有时更简单、即刻完成的解决方案是最有效的。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-23T19:03:08.113

```
DELETE  i1.*
FROM    items i1
LEFT JOIN
        (
        SELECT  id
        FROM    items ii
        ORDER BY
                id DESC
        LIMIT 20
        ) i2
ON      i1.id = i2.id
WHERE   i2.id IS NULL 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-23T19:03:39.970

如果你的 id 是增量的，那么使用类似的东西

```
delete from table where id < (select max(id) from table)-N 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-10-02T08:12:08.353

**要删除除 te last *N*之外的所有记录，您可以使用下面报告的查询。**

这是一个单一的查询，但有许多语句，因此它实际上不是原始问题中预期的*单一查询。*

由于 MySQL 中的错误，您还需要一个变量和一个内置的（在查询中）准备好的语句。

希望无论如何它可能有用...

*nnn是要***保留**的行，而*theTable*是您正在处理的表。

我假设您有一个名为*id的自动递增记录*

```
SELECT @ROWS_TO_DELETE := COUNT(*) - nnn FROM `theTable`;
SELECT @ROWS_TO_DELETE := IF(@ROWS_TO_DELETE<0,0,@ROWS_TO_DELETE);
PREPARE STMT FROM "DELETE FROM `theTable` ORDER BY `id` ASC LIMIT ?";
EXECUTE STMT USING @ROWS_TO_DELETE; 
```

这种方法的好处是**性能**：我已经在本地数据库上测试了大约 13,000 条记录的查询，保留了最后 1,000 条。它在 0.08 秒内运行。

已接受答案中的脚本...

```
DELETE FROM `table`
WHERE id NOT IN (
  SELECT id
  FROM (
    SELECT id
    FROM `table`
    ORDER BY id DESC
    LIMIT 42 -- keep this many records
  ) foo
); 
```

耗时 0.55 秒。大约7倍。

测试环境：2011 年末 i7 MacBookPro 上的 mySQL 5.5.25，带 SSD

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-23T19:02:46.867

```
DELETE FROM table WHERE ID NOT IN
(SELECT MAX(ID) ID FROM table) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-05-14T06:44:00.793

试试下面的查询：

```
DELETE FROM tablename WHERE id < (SELECT * FROM (SELECT (MAX(id)-10) FROM tablename ) AS a) 
```

内部子查询将返回前 10 个值，外部查询将删除除前 10 个之外的所有记录。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T19:05:02.290

```
DELETE FROM table WHERE id NOT IN (
    SELECT id FROM table ORDER BY id, desc LIMIT 0, 10
) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-23T20:18:47.200

这也应该有效：

```
DELETE FROM [table] 
INNER JOIN (
    SELECT [id] 
    FROM (
        SELECT [id] 
        FROM [table] 
        ORDER BY [id] DESC
        LIMIT N
    ) AS Temp
) AS Temp2 ON [table].[id] = [Temp2].[id] 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-08-03T11:28:35.107

关于什么 ：

```
SELECT * FROM table del 
         LEFT JOIN table keep
         ON del.id < keep.id
         GROUP BY del.* HAVING count(*) > N; 
```

它返回之前超过 N 行的行。可能有用吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-02-14T10:28:53.373

在许多情况下，为这个任务使用 id 不是一个选项。例如 - 带有 twitter 状态的表。这是具有指定时间戳字段的变体。

```
delete from table 
where access_time >= 
(
    select access_time from  
    (
        select access_time from table 
            order by access_time limit 150000,1
    ) foo    
) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-04-02T13:00:56.227

只是想为使用 Microsoft SQL Server 而不是 MySQL 的任何人加入这个组合。MSSQL 不支持关键字“限制”，因此您需要使用替代方法。此代码在 SQL 2008 中有效，并且基于此 SO 帖子。[https://stackoverflow.com/a/1104447/993856](https://stackoverflow.com/a/1104447/993856)

```
-- Keep the last 10 most recent passwords for this user.
DECLARE @UserID int; SET @UserID = 1004
DECLARE @ThresholdID int -- Position of 10th password.
SELECT  @ThresholdID = UserPasswordHistoryID FROM
        (
            SELECT ROW_NUMBER()
            OVER (ORDER BY UserPasswordHistoryID DESC) AS RowNum, UserPasswordHistoryID
            FROM UserPasswordHistory
            WHERE UserID = @UserID
        ) sub
WHERE   (RowNum = 10) -- Keep this many records.

DELETE  UserPasswordHistory
WHERE   (UserID = @UserID)
        AND (UserPasswordHistoryID < @ThresholdID) 
```

诚然，这并不优雅。如果您能够针对 Microsoft SQL 进行优化，请分享您的解决方案。谢谢！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-06-23T12:40:52.430

如果您还需要删除基于其他列的记录，那么这里是一个解决方案：

```
DELETE
FROM articles
WHERE id IN
    (SELECT id
     FROM
       (SELECT id
        FROM articles
        WHERE user_id = :userId
        ORDER BY created_at DESC LIMIT 500, 10000000) abc)
  AND user_id = :userId 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-02-23T19:40:46.480

为什么不

```
DELETE FROM table ORDER BY id DESC LIMIT 1, 123456789 
```

只需删除除第一行以外的所有行（顺序为 DESC！），使用非常大的数字作为第二个 LIMIT 参数。[看这里](http://dev.mysql.com/doc/refman/5.0/en/select.html#id1645996)

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2013-02-19T05:45:42.783

很长一段时间后回答这个问题......遇到了同样的情况，而不是使用提到的答案，我来到了下面 -

```
DELETE FROM table_name order by ID limit 10 
```

这将删除前 10 条记录并保留最新记录。

# c# - .net 反汇编器/反编译器

> ID：578883
> 
> 赞同：26
> 
> 时间：2009-02-23T19:03:00.673
> 
> 标签：c#, .net, cil

我正在寻找反汇编器或更好的.net 反编译器。情况是我的一位前辈编写的程序集的源代码丢失了，我想看看它在做什么。

我知道 ildasm 附带 Visual Studio 安装，因此我可以获取 MSIL，但我希望有一个足够聪明的程序可以返回 C# 代码（或最佳近似值）。

有什么工具可以解决这个问题吗？

（如果没有，我想这将是我坐下来开始学习 MSIL 的好借口）

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2011-05-13T04:46:42.467

既然 Red Gate 已经开始为 .NET Reflector 工具收费，您可能想看看这些免费的替代品...

[Telerik JustDecompile](http://www.telerik.com/products/decompiling.aspx)

[JetBrains dotPeek](http://www.jetbrains.com/decompiler/)

[（开源）ILSpy](http://wiki.sharpdevelop.net/ilspy.ashx)

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-02-23T19:05:15.207

你看过反光板吗？

[http://www.red-gate.com/products/reflector/](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-23T19:18:08.843

反射器是要走的路，但如果由于某种原因你不能使用它，微软会在框架中附带一个名为 ILDasm 的反汇编程序。

MSIL 知识的一个很好的来源是Serge Lidin所著的[Expert .NET 2.0 IL Assembler一书。](https://rads.stackoverflow.com/amzn/click/com/1590596463)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T19:04:47.080

[.NET Reflector](http://www.red-gate.com/products/reflector/)是用于此目的的常用工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T19:05:23.350

[反射器。](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-05T18:57:06.147

行，

我尝试了一个项目。间谍

Telerik JustDecompile

.NET 反射器演示

都可以创建 Visual C# 项目。生成的代码没有为 JustDecompile 和 Reflector 编译。在一个案例中，ILSpy 编写了一个编译代码（只需要设置引用） IlSpy 的错误看起来不像其他错误那样复杂。如果足够了解 C#，则可以修复所有生成的代码。

可以使用一个有趣的方向来使用 JustDecompile 和 Ilspy 反编译代码并合并正确的代码，因为这些反编译器（以及第三个）似乎会犯不同的错误。

# c# - 从 ASP.NET 启动外部进程

> ID：578890
> 
> 赞同：6
> 
> 时间：2009-02-23T19:04:46.503
> 
> 标签：c#, .net, asp.net

我需要从我的 Web 应用程序启动一个外部进程。这意味着使用*System.Diagnostics.ProcessStartInfo*调用并执行控制台应用程序 (exe)。但是我需要以某种方式***确保***在执行过程中没有出现任何问题，**并知道应用程序何时完成**其工作。

**捕获所有可能的错误并找出它何时完成的最佳方法是什么？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T06:17:28.617

Process 类并不难。不过，之前的海报是正确的 - 您需要关注权限。

```
private string RunProcess(string cmd)
{
  System.Diagnostics.Process p; 
  p= new System.Diagnostics.Process();
  if (cmd== null || cmd=="") {
    return "no command given.";
  }
  string[] args= cmd.Split(new char[]{' '});
  if (args== null || args.Length==0 || args[0].Length==0) {
    return "no command provided.";
  }
  p.StartInfo.FileName= args[0];

  if (args.Length>1) {
    int startPoint= cmd.IndexOf(' ');
    string s= cmd.Substring(startPoint, cmd.Length-startPoint);
    p.StartInfo.Arguments= s; 
  }
  p.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
  p.StartInfo.RedirectStandardOutput = true;
  p.StartInfo.UseShellExecute = false;

  p.Start();

  // must have the readToEnd BEFORE the WaitForExit(), to avoid a deadlock condition
  string output= p.StandardOutput.ReadToEnd();
  p.WaitForExit();

  return output; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T19:12:25.813

我当然希望你能控制外部应用程序的代码，否则你会很头疼。要做的最重要的事情是确保该应用程序无法挂起而不终止。

然后，您可以使用 WaitForExit()、ExitCode、StandardError、StandardOut 来“捕获所有可能的错误并找出它何时完成”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-23T19:13:48.510

您最好捕获控制台应用程序的所有输出并将其存储在可以在状态页面上显示的位置，而不是等待应用程序完成。

正如上面其他人所说，否则你会经历痛苦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-01T03:45:20.097

希望这个答案有帮助

[https://stackoverflow.com/a/14107672/1060656](https://stackoverflow.com/a/14107672/1060656)

这是一个代码片段，希望这有帮助

[http://ss64.com/nt/cmd.html](http://ss64.com/nt/cmd.html)获取 cmd.exe 帮助

```
private int CallShell(string exeCommand, string Parameters)
        {
            //http://ss64.com/nt/cmd.html
            /*
            This function will actually take the shell string and envoke the appropriate process
             passing it the arguments to do the work
            */

            // Initialize the process and its StartInfo properties.
            System.Diagnostics.Process ProcessEXE = new System.Diagnostics.Process();

            logger.DebugFormat("About to Start Process - {0} {1}",exeCommand, Parameters);
            try
            {

                ProcessEXE.StartInfo.FileName = exeCommand;

                // Set UseShellExecute to false for redirection.
                //  false if the process should be created directly from the executable file
                ProcessEXE.StartInfo.UseShellExecute = false;
                ProcessEXE.StartInfo.WorkingDirectory = System.Environment.CurrentDirectory;

                //EnableRaisingEvents property indicates whether the component should be notified when the operating system has shut down a process

                ProcessEXE.StartInfo.Arguments = Parameters;

                ProcessEXE.StartInfo.RedirectStandardOutput = true;
                ProcessEXE.StartInfo.RedirectStandardError = true;
                ProcessEXE.EnableRaisingEvents = true;
                ProcessEXE.StartInfo.CreateNoWindow = true;

                ProcessEXE.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(ProcessEXE_OutputDataReceived);
                ProcessEXE.ErrorDataReceived += new System.Diagnostics.DataReceivedEventHandler(ProcessEXE_OutputDataReceived);

                logger.DebugFormat("Process Started.");
                ProcessEXE.Start();

                // Start the asynchronous read of the sort output stream.
                ProcessEXE.BeginErrorReadLine();
                ProcessEXE.BeginOutputReadLine();

                //The WaitForExit overload is used to make the current thread wait until the associated process terminates
                logger.DebugFormat("Process Waiting for exit.");
                ProcessEXE.WaitForExit();

                if (ProcessEXE.ExitCode == 0)
                {
                    logger.Debug(string.Format("Shell Process exited with exit code {0}", ProcessEXE.ExitCode));
                }
                else
                {
                // throw error here if required - check the return error code
                    logger.Warn(string.Format("Shell Process exited with exit code {0}", ProcessEXE.ExitCode));
                }
            }
            catch (Exception ex)
            {
                throw new Exception(string.Format("Method:{0}", ex.TargetSite), ex);
            }

            return ProcessEXE.ExitCode;
        }

void ProcessEXE_OutputDataReceived(object sender, System.Diagnostics.DataReceivedEventArgs e)
        {
            try
            {
                StringBuilder sb = new StringBuilder(string.Empty);
                if (e == null) return;

                if (e.Data == null)
                {
                    //No processing
                }
                else
                {
                   // your logic to detect error msg out from output - if at all required
                }

                if (sb.ToString().ToUpper().IndexOf("ERROR") > 0)
                {
                    string smessage = "Error text found in  output.";

                // do your error response action here .

                }
            }
            catch (Exception exp)
            {
                logger.ErrorFormat("Error in ProcessEXE_OutputDataReceived Message:{0}", exp.Message);
                logger.ErrorFormat("Error in ProcessEXE_OutputDataReceived Data Received:{0}", e.Data);

            // either throw error msg or kill the process 
            }
            finally
            {
                // Not throwing the exception
            }
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T19:08:30.270

你会遇到这个问题。ASP.NET 网页在严格的安全环境下运行，甚至可能无法启动外部进程。

另外... ASP.NET 将“一时兴起”回收（停止/重新启动其所有进程）。这意味着在任何时候网页都可能中止执行。

您是否考虑过使用作业/任务调度程序？SQL Server 自带的（非 express 版）非常好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T19:13:07.967

您无法从外部程序中捕获任何错误。您最多可以将其输出重定向到您自己的流，并希望它在失败/成功时会写一些东西。您还可以使用 Process.ExitCode 检查进程退出代码。

您可以使用 Process.Exited 事件或 Process.HasExited 属性测试流程是否完成。

另外您应该注意，默认情况下，Asp.Net 代码在 NETWORK SERVICE 进程（iis6 及更高版本）下运行，因此它的权限有限，登录用户将无法看到它的 UI。

@rbobby：您可以在 Asp.Net 代码中启动外部进程，但它将继承 Asp.Net 代码的安全上下文。

# java - 如何从代码完成中隐藏所有 java.lang.Object 方法？

> ID：578897
> 
> 赞同：8
> 
> 时间：2009-02-23T19:05:31.743
> 
> 标签：java, syntax, syntactic-sugar

我想为现有的类库创建一些简单的包装类。为了使语法易于阅读并且易于猜测（通过代码完成），我想删除**java.lang.Object**的方法。

问题是java中的所有非原子事物都继承自Object，因此具有这些方法。我已经尝试通过枚举和接口创建包装语法，但没有成功；因为**枚举**和**接口**也是**java.lang.Objects**。

java.lang.Object 有九种我不想在我的接口的代码完成中看到的方法。这是我要删除的内容（红色）和我要保留的内容（绿色）：

[替代文本 http://ju.venile.de/upload/java-lang-object-methods.png](http://ju.venile.de/upload/java-lang-object-methods.png)

下面是一些示例代码，用于围绕现有类创建漂亮的包装器（Builder 模式）：

```
public interface IMySyntax{
  public IMySyntax myMethod1();
  public IMySyntax myMethod2();
}

public class MyBuilder implements IMySyntax{
  public static IMySyntax build(){ return (IMySyntax) new MyBuilder() }
  public IMySyntax myMethod1(){ /* do something */ return (IMySyntax) this }
  public IMySyntax myMethod2(){ /* do something */ return (IMySyntax) this }     
} 
```

新包装器代码的用法应如下所示：

```
MyBuilder.build()
         .myMethod1()
         .myMethod2(); 
```

将构建器的所有`this`语句转换为接口将降低方法的可见性，例如，如果构建器实现了多个接口。不幸的是，所有 java.lang.Object 方法都将保留。

如果这种方法隐藏在 Java 中是可能的（也许使用注释？），我可以创建一个很好的库，它与 IDE 无关（到处都有很好的代码完成）。如果没有，那么至少 Eclipse IDE（可能是插件？）可能有一个技巧，可以提供 java.lang.Object 方法隐藏。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-23T19:17:48.627

对于 Eclipse 3.4，至少您可以执行以下操作：

1) 转到 Preferences -> Java -> Appearance -> Type Filters 2) 单击 Add，然后输入`java.lang.Object`

现在在代码辅助中，直接继承的方法`java.lang.Object`将消失

# vb.net - OOP - 具有主列表和对象组合的实体的对象

> ID：578898
> 
> 赞同：0
> 
> 时间：2009-02-23T19:06:16.470
> 
> 标签：vb.net, oop, theory

我正在努力思考如何为以下业务对象正确实现 OOP 设计：

1.  在数据库中有一个“主列表”（例如分类）
2.  是作为属性（即对象组合）的另一个对象的一部分，但具有附加属性

这就是我坚持理论的地方。假设我有一个分类对象，它继承自抽象类 BusinessObject 并定义了 CRUD 函数 (MustOverride)。这会给我：

```
Public MustInherit Class BusinessObject
    Public Sub New()

    End Sub

    Public MustOverride Function Create() As Boolean
    Public MustOverride Sub Read(ByVal id As Integer)
    Public MustOverride Function Update() As Boolean
    Public MustOverride Function Delete() As Boolean
End Class

Public Class Classification
    Inherits BusinessObject

    <Fields, properties, etc. for ID, Name (or Description), and 
     IsActive. DB table has only these 3 fields.>

    Public Sub New()
        MyBase.New()
    End Sub

    Public Overrides Function Create() As Boolean
        Dal.Classifications.Create(Me)
    End Function

    Public Overrides Function Delete() As Boolean
        Dal.Classifications.Delete(Me)
    End Function

    Public Overloads Overrides Sub Read(ByVal id As Integer)
        Dal.Classifications.Read(Me)
    End Sub

    Public Overrides Function Update() As Boolean
        Dal.Classifications.Update(Me)
    End Function
End Class 
```

这将允许我在系统管理员可以管理系统中的分类主列表的表单上使用分类对象。这里没有问题。

现在，我希望客户对象具有分类类型（对象组合）的属性，但有一个警告 - 当分类对象成为客户对象的属性时，它需要一个附加字段级别。级别是根据业务分类的逻辑部分 - 分类具有应用程序用户输入的数字级别。所以我创建了一个继承自分类的类 CustomerClassification：

```
Public Class CustomerClassification
    Inherits Classification

    Private _level As Integer

    Public Property Level() As Integer
        Get
            Return _level
        End Get
        Set(ByVal value As Integer)
            _level = value
        End Set
    End Property

    Public Sub New()
        MyBase.New()
    End Sub
End Class 
```

Customer 对象将由 CustomerClassification 组成：

```
Public Class Customer
    Inherits BusinessObject

    Public Property Classification() As CustomerClassification
    ........ etc
End Class 
```

现在，我的设计问题是 Create、Read、Update 和 Delete 函数仍然暴露在 CustomerClassification 对象中：

```
Dim c as New Customer
c.CustomerClassification.Update() ' <-- Not desirable! 
```

我可以在这里实现什么样的其他设计？很明显我设计的方式错误，但我没有看到一个简单的替代模式。我不想通过不继承分类并重复所有字段和属性代码来重复 CustomerClassification 类中的代码，但我也不想将 CRUD 函数发布到 CustomerClassification 级别。在查看整体课程设计时我缺少什么？

**编辑：将****分类级别**保存到数据库将由客户对象处理，因为数据库是旧的，并且级别的字段是在客户表中定义的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T19:24:45.113

如果我正确理解您的问题，您的客户类不需要聚合实际分类类的实例。它需要有一个单独的类的实例，它指定了分类的级别和类型，由 ID 或枚举值表示。分类类应仅在管理员维护分类 ID/枚举列表的场景中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T19:22:20.393

因此，如果我理解正确，您希望该`Update()`功能仅适用于`Customer`班级。

如果您的`Classification`和`Customer`类部署在同一个程序集中，您可以将`Update()`函数标记为`friend`. 这将使该程序集之外的类无法访问它。

# visual-studio - 从 Jamfile 构建 Visual Studio 项目？

> ID：578901
> 
> 赞同：2
> 
> 时间：2009-02-23T19:06:37.653
> 
> 标签：visual-studio, export, visual-studio-project, jam

任何人都知道从基于 Jamfiles 的构建中创建 Visual Studio 项目的方法吗？

我会选择一个 jamfile -> XML-or-some-other-intermediate-format exporter tool，所以我可以自己编写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T01:13:54.523

这个果酱分发有一个工具可以做到这一点：

[http://redmine.jamplex.org/](http://redmine.jamplex.org/)

看这里：

[http://redmine.jamplex.org/git/jamplus/docs/html/jamtoworkspace.html](http://redmine.jamplex.org/git/jamplus/docs/html/jamtoworkspace.html)

我自己还没有使用过它，所以恐怕我不能说它的效果如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T18:11:08.470

您也可以考虑[CMake](http://www.cmake.org/)。CMake 文件与 Jamfiles 一样[易于编写](http://www.cmake.org/cmake/help/examples.html)，并且 CMake 可以自动为 Visual Studio、Xcode 和 Unix Makefiles 生成项目。我曾经在我所有的 Linux 项目中使用 Jam，但是一旦我发现了 CMake，我就再也没有回去过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T09:25:49.893

JamPlus 有一个内置的工作空间生成器，它可以读取项目的 Jamfiles 并导出一个 IDE 工作空间。 [http://jamplus.org/git/jamplus/docs/html/jamtoworkspace.html](http://jamplus.org/git/jamplus/docs/html/jamtoworkspace.html)

# java - 同步静态方法在 Java 中是如何工作的，我可以用它来加载 Hibernate 实体吗？

> ID：578904
> 
> 赞同：185
> 
> 时间：2009-02-23T19:07:16.793
> 
> 标签：java, multithreading, hibernate, concurrency, synchronization

如果我有一个带有静态方法的 util 类，它将调用 Hibernate 函数来完成基本数据访问。我想知道制作该方法`synchronized`是否是确保线程安全的正确方法。

我希望这可以防止信息访问同一个数据库实例。但是，我现在确定以下代码是否阻止`getObjectById`在特定类调用时为所有类调用。

```
public class Utils {
     public static synchronized Object getObjectById (Class objclass, Long id) {
           // call hibernate class
         Session session = new Configuration().configure().buildSessionFactory().openSession();
         Object obj = session.load(objclass, id);
         session.close();
         return obj;
     }

     // other static methods
} 
```

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2009-02-24T16:43:46.680

为了更普遍地解决这个问题......

请记住，在方法上使用同步实际上只是简写（假设类是 SomeClass）：

```
synchronized static void foo() {
    ...
} 
```

是相同的

```
static void foo() {
    synchronized(SomeClass.class) {
        ...
    }
} 
```

和

```
synchronized void foo() {
    ...
} 
```

是相同的

```
void foo() {
    synchronized(this) {
        ...
    }
} 
```

您可以使用任何对象作为锁。如果要锁定静态方法的子集，可以

```
class SomeClass {
    private static final Object LOCK_1 = new Object() {};
    private static final Object LOCK_2 = new Object() {};
    static void foo() {
        synchronized(LOCK_1) {...}
    }
    static void fee() {
        synchronized(LOCK_1) {...}
    }
    static void fie() {
        synchronized(LOCK_2) {...}
    }
    static void fo() {
        synchronized(LOCK_2) {...}
    }
} 
```

（对于非静态方法，您可能希望将锁设为非静态字段）

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2009-02-23T20:35:50.107

通过在静态方法锁上使用同步，您将[同步类方法和属性](https://stackoverflow.com/questions/437620/java-synchronized-methods-lock-on-object-or-class/437627#437627)（而不是实例方法和属性）

所以你的假设是正确的。

> *我想知道使方法同步是否是确保线程安全的正确方法。*

并不真地。您应该让您的 RDBMS 代替它来完成这项工作。他们擅长这种东西。

通过同步对数据库的访问，你唯一能得到的就是让你的应用程序变得非常慢。此外，在您发布的代码中，您每次都在构建一个会话工厂，这样，您的应用程序将花费更多时间访问数据库而不是执行实际工作。

想象以下场景：

客户端 A 和 B 尝试将不同的信息插入到表 T 的记录 X 中。

使用您的方法，您得到的唯一一件事就是确保一个接一个地被调用，当这种情况无论如何都会在数据库中发生时，因为 RDBMS 将阻止他们同时插入来自 A 的一半信息和来自 B 的一半信息. 结果将相同，但仅慢 5 倍（或更多）。

可能最好看一下 Hibernate 文档中的[“事务和并发”](http://www.hibernate.org/hib_docs/v3/reference/en-US/html/transactions.html)一章。大多数时候，你试图解决的问题已经解决了，而且是一种更好的方法。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-23T19:12:12.837

静态方法使用类作为锁定对象，例如 Utils.class。所以是的，没关系。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-04-19T12:36:51.757

`static synchronized`意味着锁定类的`Class`对象，而 as `synchronized`意味着锁定该类的对象本身。这意味着，如果您在（执行的）线程中访问非静态同步方法，您仍然可以使用另一个线程访问静态同步方法。

因此，在任何时间点通过多个线程访问两种相同类型的方法（两个静态或两个非静态方法）是不可能的。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-23T19:19:23.083

为什么要强制在任何时候只有一个线程可以访问数据库？

*实现任何必要的锁定*是数据库驱动程序的工作*`Connection`，假设一次只由一个线程使用！*

 *最有可能的是，您的数据库完全能够处理多个并行访问

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-23T19:12:39.340

如果和你数据库中的数据有关，为什么不利用数据库隔离锁来实现呢？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-23T19:13:01.913

要回答您的问题，是的：您的`synchronized`方法一次不能由多个线程执行。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-03-26T08:08:24.340

## `synchronized`Java 关键字的工作原理

将`synchronized`关键字添加到静态方法时，该方法一次只能由单个线程调用。

在您的情况下，每个方法调用都将：

*   创建一个新的`SessionFactory`
*   创建一个新的`Session`
*   获取实体
*   将实体返回给调用者

但是，这些是您的要求：

*   我希望这可以防止访问同一数据库实例的信息。
*   防止`getObjectById`在被特定类调用时被所有类调用

因此，即使该`getObjectById`方法是线程安全的，实现也是错误的。

## `SessionFactory`最佳实践

它`SessionFactory`是线程安全的，创建它是一个非常昂贵的对象，因为它需要解析实体类并构建内部实体元模型表示。

因此，您不应该`SessionFactory`在每个`getObjectById`方法调用上都创建。

相反，您应该为它创建一个单例实例。

```
private static final SessionFactory sessionFactory = new Configuration()
    .configure()
    .buildSessionFactory(); 
```

## 应`Session`始终关闭

您没有`Session`在一个`finally`块中关闭，如果在加载实体时抛出异常，这可能会泄漏数据库资源。

根据方法，如果在数据库中找不到实体，[`Session.load`JavaDoc](https://docs.jboss.org/hibernate/orm/5.4/javadocs/org/hibernate/Session.html#load-java.lang.Class-java.io.Serializable-)可能会抛出一个。`HibernateException`

> 您不应使用此方法来确定实例是否存在（`get()`改为使用）。仅使用它来检索您假设存在的实例，其中不存在将是实际错误。

这就是为什么您需要使用`finally`块来关闭`Session`，如下所示：

```
public static synchronized Object getObjectById (Class objclass, Long id) {    
     Session session = null;
     try {
         session = sessionFactory.openSession();
         return session.load(objclass, id);
     } finally {
         if(session != null) {
             session.close(); 
         }
     }
 } 
```

## 防止多线程访问

在您的情况下，您希望确保只有一个线程可以访问该特定实体。

但是该`synchronized`关键字只阻止两个线程`getObjectById`同时调用。如果两个线程一个接一个地调用这个方法，你仍然会有两个线程使用这个实体。

所以，如果你想锁定一个给定的数据库对象，使其他线程不能修改它，那么你需要使用数据库锁。

该`synchronized`关键字仅在单个 JVM 中有效。如果您有多个 Web 节点，这不会阻止跨多个 JVM 的多线程访问。

您需要做的是使用[`LockModeType.PESSIMISTIC_READ`或`LockModeType.PESSIMISTIC_WRITE`](https://vladmihalcea.com/hibernate-locking-patterns-how-do-pessimistic_read-and-pessimistic_write-work/)同时将更改应用于数据库，如下所示：

```
Session session = null;
EntityTransaction tx = null;

try {
    session = sessionFactory.openSession();

    tx = session.getTransaction();
    tx.begin();

    Post post = session.find(
        Post.class, 
        id, 
        LockModeType.LockModeType.PESSIMISTIC_READ
    );

    post.setTitle("High-Performance Java Perisstence");

    tx.commit();
} catch(Exception e) {
    LOGGER.error("Post entity could not be changed", e);
    if(tx != null) {
        tx.rollback(); 
    }
} finally {
    if(session != null) {
        session.close(); 
    }
} 
```

所以，这就是我所做的：

*   我创建了一个新的`EntityTransaction`并开始了一个新的数据库事务
*   `Post`我在锁定关联的数据库记录的同时加载了实体
*   我更改了`Post`实体并提交了交易
*   在`Exception`被抛出的情况下，我回滚了事务

# asp.net-mvc - 在 ASP.NET MVC 中使用 VS 2008 Web 部署项目

> ID：578918
> 
> 赞同：6
> 
> 时间：2009-02-23T19:11:23.353
> 
> 标签：asp.net-mvc, web-deployment-project

有没有人有一个使用 ASP.NET MVC 的 Web 部署项目？当我打开“已部署”项目时，缺少 MVC 所需的许多文件，并且很难将项目中所有丢失的文件发布到服务器。

或者...有没有比 Web 部署项目更好的方法来修改 MVC 应用程序的 Web.Config？我有差异（SMTP 和连接字符串）需要在上传之前更新，Web 部署项目似乎是正确的方法。

一如既往的感谢！

**更新：**我至少缺少 global.asax、global.asax.cs 和 default.aspx.cs。

**更新 2：**一旦我发布，我就会收到此错误。`Could not load type 'AppNamespace._Default'.`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T11:40:49.527

我还没有使用我的 mvc 应用程序设置部署项目，但我一直在使用 Scott Hanselman 概述的这种技术，并且效果很好。

[管理多个配置文件环境](http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T20:02:26.623

您列出的 3 个特定文件都被编译成由您的 ASP.NET MVC Web 项目生成的二进制文件。打开你的 .csproj，你会看到：

```
<Compile Include="Global.asax.cs">
  <DependentUpon>Global.asax</DependentUpon>
</Compile>
<Compile Include="Default.aspx.cs">
  <DependentUpon>Default.aspx</DependentUpon>
  <SubType>ASPXCodeBehind</SubType>
</Compile> 
```

在 Reflector 等工具中打开二进制文件，您将看到这些类。因此，您不需要部署它们。

MVC .csproj 中的这些 MSBuild 步骤使Web 部署项目所做的*部分*工作（即为站点编译单个二进制文件）变得多余。

至于令牌替换，您可以保留您的部署项目，也可以将相关的 MSBuilds 步骤从 .wdproj 文件复制到 .csproj 文件中。这不是我做过的事情，但我很快就会尝试自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:30:50.203

我发现它对我有用。

当您说缺少文件时，您是在谈论 System.Web.Mvc 文件等吗？您需要确保在您的 Web 应用程序中将这些引用设置为在本地复制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T13:24:31.530

我已经使用 Web 部署项目成功部署到 IIS6。我首先在部署到 Server 2003 时遇到了问题，但就我而言，这确实是舞台环境的问题。我首先部署到本地 IIS 以检查它是构建问题还是环境问题。我没有使用配置 - 替换。

这是我的构建脚本：

```
C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe "D:\Projekte\NiceProjectName\source\NiceProjectName_Build\NiceProjectName_Build.wdproj" /t:Build /p:Configuration=Release 
```

这是我的 wdp：

```
<Project ToolsVersion="3.5" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>9.0.21022</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{E5E14CEB-0BCD-4203-9A5A-34ABA9C717EA}</ProjectGuid>
    <SourceWebPhysicalPath>..\NiceProjectName</SourceWebPhysicalPath>
    <SourceWebProject>{3E632DB6-6DB3-4BD0-8CCA-12DE67165B48}|NiceProjectName\NiceProjectName.csproj</SourceWebProject>
    <SourceWebVirtualPath>/NiceProjectName.csproj</SourceWebVirtualPath>
    <TargetFrameworkVersion>v3.5</TargetFrameworkVersion>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <OutputPath>.\Debug</OutputPath>
    <EnableUpdateable>true</EnableUpdateable>
    <UseMerge>true</UseMerge>
    <SingleAssemblyName>NiceProjectName_Build</SingleAssemblyName>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugSymbols>false</DebugSymbols>
    <OutputPath>..\..\deploy</OutputPath>
    <EnableUpdateable>false</EnableUpdateable>
    <UseMerge>true</UseMerge>
    <SingleAssemblyName>NiceProjectName</SingleAssemblyName>
  </PropertyGroup>
  <ItemGroup>
  </ItemGroup>
  <Import Project="$(MSBuildExtensionsPath)\Microsoft\WebDeployment\v9.0\Microsoft.WebDeployment.targets" />
</Project> 
```

# c# - 在代码块中使用 return 关键字

> ID：578920
> 
> 赞同：1
> 
> 时间：2009-02-23T19:12:21.820
> 
> 标签：c#, function, return

说的有什么区别：

```
if (abc == "a")
{
// do something here...
return;
} 
```

和上面一样，但是没有 return 关键字？

我是 C# 编码器，我知道 return 关键字后跟一个类型或变量会返回该项目，但在上面的上下文中，return 似乎只是退出代码块，但它是否会对代码进行任何功能或性能更改?

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-23T19:14:02.207

“return”从*函数*中退出，而不仅仅是封闭的代码块。因此，如果您的代码块在函数的上下文中，就像这样（我不知道 C#，所以我使用的是 Java 语法）：

```
int thisIsAFunction(int a) {
    if (abc == "a")
    {
        // do something here...
        return 1;
    }
    // do something else here...
} 
```

如果`abc == "a"`那么“在这里做其他事情”将不会运行。但是如果你删除了`if`块内的 return 语句，那么它就会运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T19:14:18.603

`return`语句立即退出函数，因此它可能具有性能优势，因为函数中的以下代码根本不会执行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T19:15:29.303

[MSDN](http://msdn.microsoft.com/en-us/library/1h3swy84.aspx)

return 语句终止它出现的方法的执行，并将控制权返回给调用方法。它还可以返回一个可选值。如果方法是 void 类型，return 语句可以省略。

例子

```
//this would do nothing
public void method()
{
   return;
}

 //this would return true
 //notice the return type of bool this means
 //the method expects a true\false value
public bool method2()
{
   return true;
}

public void test()
{
    if(method2())
        method()
} 
```

现在，如果您运行**测试**，method2 将始终返回 true，而 method1 将结束其处理

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T19:17:58.470

该`return`语句确实退出了当前方法，而不仅仅是代码块（for/while/if/etc）。因此，它适用于以下情况：

```
public void MyMethod(object myObject)
{
    if (myObject == null)
    {
        return;  // exits method.
    }

    // do something with myObject
} 
```

附加信息：我要指出的是，许多人更喜欢在方法中有一个退出点，但是，在某些情况下，执行类似于此处示例的操作可能会很有用。我总是会尝试找到限制方法中返回或退出点数量的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T19:14:52.533

在您的情况下，不 - 但是如果您在“if”语句之后有其他代码，您只想在您的语句为假时运行（例如 if `abc != "a"`），那么`return`允许您绕过它并退出函数/方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T19:17:21.717

在循环或 case 语句中，您可以使用`break`来实现此结果。不过，这通常不适用于 if 语句或代码块。

是的，return 退出了封闭函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T19:15:08.273

执行return语句会使执行跳出方法。如果没有返回，它只会继续下一条语句。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T19:16:23.700

是的，在这种情况下，您的方法没有返回类型。例如

```
public void Foo
{
 if (abc == "a")
 {
  // do something here...
  return;
 }
 // some other code
} 
```

也就是说如果 abd = "a"，则退出该方法，这样一些其他代码就不会被执行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T19:24:56.877

它可以是一种更简洁的代码编写方式。我通常在方法开始处或附近的保护子句中执行此操作。如果您有错误情况，只需“返回”该方法即可。它节省了将其余工作包装在 else 块中的操作。看似微不足道，但它有助于降低代码复杂度。

# asp.net - ASP:LinkBut ton 和 Eval

> ID：578938
> 
> 赞同：5
> 
> 时间：2009-02-23T19:16:32.793
> 
> 标签：asp.net, gridview, linkbutton, templatefield

我在 GridView 的 TemplateField 内的 ItemTemplate 内使用 ASP:LinkBut​​ton。对于链接按钮的命令参数，我想从 gridview 绑定的数据源传递行的 ID，所以我正在做这样的事情：

```
<asp:LinkButton ID="viewLogButton" CommandName="viewLog" CommandArgument="<%#Eval("ID")%>" Text="View Log" runat="server"/> 
```

不幸的是，生成的 HTML 是这样的：

```
<asp:LinkButton ID="viewLogButton" CommandName="viewLog" CommandArgument="3" Text="View Log" runat="server"/> 
```

似乎它*正在*正确解析 Eval() ，但这以某种方式导致它*不*解析 LinkBut​​ton 标记而只是将其作为文字文本转储出来。有人知道吗：

a) 为什么会发生这种情况，b) 这个问题有什么好的解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T19:22:14.277

虽然它可能不会导致它，但我通常这样定义它：

```
CommandArgument='<%#Eval("ID")%>' 
```

请发布 GridView 的其余标记，因为它不应该这样做。

# c++ - 我需要 CharToOem 的平台无关版本。Boost有吗？

> ID：578950
> 
> 赞同：0
> 
> 时间：2009-02-23T19:19:37.950
> 
> 标签：c++, boost

我需要在我的客户端-服务器应用程序中转换字符串以支持多语言消息传递。
我可以在boost中找到它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T08:06:56.937

对于独立于平台的代码页转换，您可以使用[libiconv](http://www.gnu.org/software/libiconv/)库。无论如何，为什么还要费心使用代码页呢？使用统一码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T19:33:56.153

这样的不存在，因为“oem 字符集”是特定于操作系统的，因此不能独立于平台。

# vb.net - System.DirectoryServices 在多线程时与我的处理器挂钩 - 我可以减轻负担吗？

> ID：578952
> 
> 赞同：1
> 
> 时间：2009-02-23T19:20:11.163
> 
> 标签：vb.net, optimization, active-directory, directoryservices

我的应用程序获取当前登录的用户并使用 DirectoryServices.DirectorySearcher 来提取一些关于他们的额外详细信息（我们存储在一些自定义 AD 字段中的一些属性，以及他们的电子邮件地址）。这很好用，虽然我一直觉得它有点慢——我的单线程代码每秒只能向 AD 发出大约 2-3 个请求。

当我将此代码移至 Web 服务器时，真正的问题出现了。有多个同时用户，每秒请求的数量会大大增加，并且 LSASS.EXE 进程挂在我的服务器上。我检查了域控制器，它们都很好——瓶颈显然在应用程序端。我怀疑让我慢下来的是 NTLM/Kerberos 挑战/响应，同时请求的数量甚至与多核处理器挂钩。

我们的网络政策不允许从 AD 进行匿名读取，因此没有选择。此外，我已经尝试了“AuthenticationTypes”的每个成员（在示例中，我使用的是 .FastBind），但它们似乎都具有大致相同的吞吐率和相同的处理器负载。

**有人知道我如何解决这个限制并降低对处理器的要求吗？**

这是我正在使用的代码 - 非常简单：

```
Dim sPath As String = "LDAP://" & stringUserDN
Dim entry As New DirectoryEntry(sPath)
entry.AuthenticationType = AuthenticationTypes.FastBind

For Each stringADNumber As String In entry.Properties(_ADPROP_EMPLOYEENUMBER)
    'return first item
    Return Convert.ToInt32(stringADNumber)
Next

Return String.Empty 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T20:45:04.250

我没有大量在 AD 中查找项目的经验。但是，一个建议是您可能希望在 HttpContext 中检查请求。发出请求的当前用户有一些基本信息，例如组、SID 和令牌信息。我不相信默认情况下有一个电子邮件地址字段，但您也许可以使用该`User.Name`属性`+ "@your.domain"`来建立一个电子邮件地址。

为了显示此数据，您需要 IIS 要求对请求进行身份验证。匿名用户不会填充此数据。此数据的访问器是`HttpContext.Current.Request.LogonUserIdentity`，或者，在您的页面背后的代码中，您可以`this.Request.LogonUserIdentity`简称为。

希望这会有所帮助。祝你好运。

# c# - 在 C# 中动态创建的用户控件

> ID：578954
> 
> 赞同：2
> 
> 时间：2009-02-23T19:21:18.150
> 
> 标签：c#, .net, winforms, dynamic-controls

我在一个 C# winforms 项目中工作，我有一个用户控件，它在从工具条菜单中选择时加载。我有一个字典查找设置在用户控件的表单加载时发生以获取其他功能。另外，当我关闭用户控件时，我只是在使用“.Hide();” 方法。我注意到，当我第一次加载用户控件时一切都很好，但是当我关闭它并选择第二次再次打开它时，它会创建一个新的对象实例，从而放弃我的字典查找。因此，我编写了一些代码试图解决这个问题。

我需要做的是以某种方式说如果用户控件的实例已经存在，则不要创建该对象的新实例。相反，只需使用户控件再次可见。因此，我编写了代码以尝试实现此目的。当我第一次选择该项目时，一切都很好。当我隐藏用户控件并尝试再次重新打开它时，没有任何反应。

以下是我为此目的编写的代码，它发生在从工具条菜单中选择项目时：

```
 if (Controls.ContainsKey("CheckAvailUserControl"))
       {
           Controls["CheckAvailUserControl"].Dock = DockStyle.Fill;
           Controls["CheckAvailUserControl"].Visible = true;
           Controls["CheckAvailUserControl"].Show();
           Controls["CheckAvailUserControl"].Refresh();
       }

       else
       {
          UserControl checkAvailUserControlLoad = new CheckAvailUserControl();
          Controls.Add(checkAvailUserControlLoad);
          checkAvailUserControlLoad.Dock = DockStyle.Fill;
          checkAvailUserControlLoad.Visible = true;
          checkAvailUserControlLoad.Show();
       } 
```

当我在调试器中跟踪我的代码时，它实际上是碰到了上述 if/else 语句的正确部分。我第二次尝试加载它时，它只是没有在屏幕上显示用户控件。

问题是：如何在关闭用户控件后正确加载它，然后再次从工具条菜单中选择它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-23T19:25:17.983

我认为 Controls.ContainsKey(...) 总是返回 false，因为您在创建控件时从未为控件分配名称。

如果，当你创建控件时，你说

```
//...
checkAvailUserControlLoad.Name = "Something"
//...
Controls.Add(checkAvailUserControlLoad); 
```

然后

```
Controls.ContainsKey("Something") 
```

将返回 true，您将能够通过使用重新使用控件`Controls["Something"]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-03T22:12:30.480

干得好：

```
private void button_Click(object sender, EventArgs e)
{
    // pass in the containing panel
    LoadControl<MyControls.MyControl>(panelContainer);
}

void LoadControl<T>(Panel panel) where T : Control, new()
{
    T _Control = GetControl<T>(panel);
    if (_Control == null)
    {
        _Control = new T();
        _Control.Dock = DockStyle.Fill;
        panel.Controls.Add(_Control);
    }
    _Control.BringToFront();
}

T GetControl<T>(Panel panel) where T : Control
{
    Type _Type = typeof(T);
    String _Name = _Type.ToString();
    if (!panel.Controls.ContainsKey(_Name))
        return null;
    T _Control = panel.Controls[_Name] as T;
    return _Control;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T19:38:36.453

这可能可行，但我认为这有点倒退：您将新代码扔到一个可以通过移动旧代码来解决的问题上。

相反，请考虑事件在您的表单中是如何工作的。我敢打赌，如果您将创建代码移动到稍微不同的事件，或者检测到稍后触发事件的时间并忽略这些，您可以以更好的方式解决问题。

# .net - 在 .NET 项目中管理 2 个具有共享类依赖项的 Web 引用

> ID：578955
> 
> 赞同：0
> 
> 时间：2009-02-23T19:21:24.140
> 
> 标签：.net, web-services

我有一个包含 2 个 asmx 文件的 Web 服务项目。我们称它们为 internal.asmx & external.asmx 在实践中，它们有不同的客户端：

在外部，客户端将调用 externalWS.PersistOrder(Order order)，在内部，我们处理订单 internalWS ProcessOrder(Order order)。因此，Order 类是这些 Web 服务之间的共享依赖项。

我正在编写一个测试应用程序，它在这两个 Web 服务上调用不同的 Web 方法。

我遇到了问题，因为 Web 服务使用相同的类。为了同时使用这两种网络方法，我在我的测试项目中添加了 2 个网络引用。但是，依赖类有 2 个副本，具有不同的命名空间。作为短期修复，我正在编辑 VS 创建的类。

一定有更好的方法！在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T19:42:19.160

我不确定如何（以及是否）可以修改 VS Web 参考向导的行为。

但是，您可以从命令行使用 wsdl.exe 或 svcutil.exe（取决于您是否需要 System.Web 或 WCF 样式的客户端代理到您的服务），并为共享类型指定适当的选项。

对于 wsdl.exe，您想要的命令行选项是`/sharetypes`，虽然我已经很多年没有碰过它，所以我不记得确切的使用细节。

对于 svcutil.exe，您需要的命令行选项是 /reference:。您可以在可以引用的程序集中拥有共享类。如果您可以获取的共享类的唯一定义位于两个服务的 WSDL 中，您可能需要使用 svcutil.exe 生成客户端代理，将其修剪为仅包含共享类并从中构建参考程序集对于这两个服务的实际客户端代理。

这种方法的缺点是，如果其中一项服务的 WSDL 发生变化，您需要再次运行该工具。这可以通过在项目中的 BeforeBuild 目标中添加一个自定义任务来缓解，该任务始终针对这两个服务运行该工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T19:23:37.097

AutoMapper：对象-对象映射器

[http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/01/22/automapper-the-object-object-mapper.aspx](http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/01/22/automapper-the-object-object-mapper.aspx)

# database - 在 Oracle 中，是否可以将列“插入”到表中？

> ID：578957
> 
> 赞同：10
> 
> 时间：2009-02-23T19:21:55.370
> 
> 标签：database, oracle

向现有表添加列时，Oracle 始终将该列放在表的末尾。是否可以告诉 Oracle 它应该出现在表中的哪个位置？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-23T19:28:22.733

表中列的位置应该不重要（除非需要考虑“页面大小”，或者 Oracle 用于实际存储数据的任何内容）。对消费者来说更重要的是如何调用结果，即 Select 语句。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-23T19:28:51.110

将 YOUR_ORIGINAL_TABLE 重命名为 YOUR_NEW_TABLE；

create table YOUR_ORIGINAL_TABLE nologging /* or unrecoverable */ as select Column1, Column2, NEW_COLUMN, Column3 from YOUR_NEW_TABLE;

删除表 YOUR_NEW_TABLE；

从 YOUR_ORIGINAL_TABLE 中选择 *；<<<<< 现在您将在表格中间看到新列。

但你为什么要这样做？这似乎不合逻辑。如果列顺序很重要，您永远不应该假设列顺序并且只使用命名列列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-23T19:56:47.440

为什么列的顺序很重要？你总是可以在你的选择语句中改变它吗？

在表的末尾添加新列是有好处的。如果有代码天真地执行“SELECT *”然后按顺序解析字段，您将不会通过在末尾添加新列来破坏旧代码。如果您在表格中间添加新列，则旧代码可能会被破坏。

在一份工作中，我有一个 DBA，他对“永远不要做 'SELECT *'”非常敏感。他坚持你总是写出具体的领域。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T19:26:47.713

我通常做的是：

1.  重命名旧表。
2.  以正确的顺序创建包含列的新表。
3.  为该新表创建约束。
4.  填充数据：从重命名的表中插入 new_table 选择 *。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-23T19:27:12.643

我认为如果不将数据保存到临时表、删除表并重新创建它，就无法做到这一点。另一方面，列在哪里并不重要。只要您在 select 语句中指定要检索的列，您就可以根据需要对它们进行排序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-23T22:08:38.060

请记住，在表格下，表格记录中的所有数据都粘在一起。将一列添加到表的末尾[如果它可以为空或（在以后的版本中）默认不为空] 仅意味着更改表的元数据。在中间添加一列需要重写该表中的每条记录，以便为该列添加适当的值（或标记）。在某些情况下，这可能意味着记录在块上占用了更多空间，并且需要迁移一些记录。简而言之，对于任何实际大小的表来说，这都是大量的 IO 工作。

您始终可以在具有优先顺序的列的表上创建一个视图，并在 DML 语句中使用该视图，就像您使用表一样

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T19:26:38.247

我不这么认为——SQL Server 也不允许这些。我总是必须使用的方法是：

1.  创建看起来正确的新表（包括附加列
2.  开始交易
3.  从旧表中选择所有数据到新表中
4.  丢弃旧表
5.  重命名新表
6.  提交事务。

不完全漂亮，但可以完成工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T19:27:54.047

不，它不可能通过“ALTER TABLE”语句。但是，您可以创建一个与当前表具有相同定义的新表，尽管名称不同，并且列的顺序按照您想要的方式正确。将数据复制到新表中。放下旧桌子。重命名新表以匹配旧表名。

[Tom Kyte 在 AskTom链接文本](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:6700238804926)上有一篇关于此的文章

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-05-25T18:03:36.433

1）好的，所以你不能直接这样做。我们不需要一个又一个帖子说同样的话，不是吗？

2）好的，所以表中列的顺序在技术上并不重要。但这不是重点，最初的问题只是问您是否可以完成。不要以为你知道其他人的要求。也许他们有一个包含 100 列的表，当前正在使用“SELECT * ...”在一些可怕的被破解的查询中查询，他们只是不想尝试解开，更不用说用 100 个列名替换“*”了。或者，也许他们只是对事物的顺序感到厌烦，并且喜欢在使用 SQL Developer 浏览模式时将相关字段彼此相邻。也许他们正在与不知道查看 100 列列表的末尾的非技术人员打交道，而从逻辑上讲，它应该在开头附近的某个地方。

没有什么比问一个诚实的问题并得到一个回答说：“你不应该那样做”更令人恼火的了。这是我的工作，不是你的！请不要告诉我如何做我的工作。可以的话就帮忙吧。谢谢！

好的...对不起咆哮。现在...在 www.orafaq.com 它建议了这种解决方法。

首先假设您已经运行：

创建表 tab1 ( col1 NUMBER );

现在假设您要添加一个名为“col2”的列，但您希望它们在执行“SELECT * FROM tbl1;”时排序为“col2”、“col1”

建议运行：

ALTER TABLE tab1 添加（col2 日期）；将 tab1 重命名为 tab1_old；创建表 tab1 AS SELECT 0 AS col1, col1 AS col2 FROM tab1_old;

我发现这是令人难以置信的误导。首先，你用零填充“col1”，所以，如果你有任何数据，那么你会因为这样做而丢失它。其次，它实际上将“col1”重命名为“col2”并且没有提及这一点。所以，这是我的例子，希望它更清楚一点：

假设您有一个使用以下语句创建的表：

CREATE TABLE 用户 (first_name varchar(25), last_name varchar(25));

现在假设您想在 first_name 和 last_name 之间插入 middle_name。这是一种方法：

ALTER TABLE users ADD middle_name varchar(25); 将用户重命名为 users_tmp；CREATE TABLE users AS SELECT first_name, middle_name, last_name FROM users_tmp; /* 为了更好的衡量... */ DROP TABLE testusers_tmp;

请注意，middle_name 将默认为 NULL（由 ALTER TABLE 语句暗示）。您也可以在 CREATE TABLE 语句中设置不同的默认值，如下所示：

CREATE TABLE users AS SELECT first_name, 'some default value' AS middle_name, last_name FROM users_tmp;

如果您要添加默认为 sysdate 的日期字段，但您希望所有现有记录都具有其他（例如更早的）日期值，则此技巧可能会派上用场。

# c# - 如何编写单元测试来确定对象是否可以被垃圾回收？

> ID：578967
> 
> 赞同：39
> 
> 时间：2009-02-23T19:24:05.567
> 
> 标签：c#, .net, unit-testing, garbage-collection

关于[我之前的问题](https://stackoverflow.com/questions/578593/castle-windsor-will-my-transient-component-be-garbage-collected)，我需要检查将由 Castle Windsor 实例化的组件是否可以在我的代码完成使用后被垃圾收集。我已经尝试了上一个问题的答案中的建议，但它似乎没有按预期工作，至少对于我的代码而言。所以我想写一个单元测试来测试一个特定的对象实例在我的一些代码运行后是否可以被垃圾回收。

这有可能以可靠的方式做到吗？

**编辑**

我目前根据 Paul Stovell 的回答进行了以下测试，该测试成功：

```
 [TestMethod]
    public void ReleaseTest()
    {
        WindsorContainer container = new WindsorContainer();
        container.Kernel.ReleasePolicy = new NoTrackingReleasePolicy();
        container.AddComponentWithLifestyle<ReleaseTester>(LifestyleType.Transient);
        Assert.AreEqual(0, ReleaseTester.refCount);
        var weakRef = new WeakReference(container.Resolve<ReleaseTester>());
        Assert.AreEqual(1, ReleaseTester.refCount);
        GC.Collect();
        GC.WaitForPendingFinalizers();
        Assert.AreEqual(0, ReleaseTester.refCount, "Component not released");
    }

    private class ReleaseTester
    {
        public static int refCount = 0;

        public ReleaseTester()
        {
            refCount++;
        }

        ~ReleaseTester()
        {
            refCount--;
        }
    } 
```

我是否正确假设，基于上面的测试，我可以得出结论温莎在使用 NoTrackingReleasePolicy 时不会泄漏内存？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-02-23T19:31:08.890

这是我通常做的：

```
[Test]
public void MyTest() 
{
    WeakReference reference;
    new Action(() => 
    {
        var service = new Service();
        // Do things with service that might cause a memory leak...

        reference = new WeakReference(service, true);
    })();

    // Service should have gone out of scope about now, 
    // so the garbage collector can clean it up
    GC.Collect();
    GC.WaitForPendingFinalizers();

    Assert.IsNull(reference.Target);
} 
```

注意：在生产应用程序中您应该调用 GC.Collect() 的情况非常非常少。但是测试泄漏是合适的例子之一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T19:28:57.350

也许你可以持有一个[弱引用](http://msdn.microsoft.com/en-us/library/system.weakreference_members.aspx)，然后在测试完成后检查它是否不再存在（即！IsAlive）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-10-28T09:16:04.810

使用[dotMemory Unit](https://www.jetbrains.com/dotmemory/unit/)框架（免费）

```
[TestMethod]
public void ReleaseTest()
{
    // arrange
    WindsorContainer container = new WindsorContainer();
    container.Kernel.ReleasePolicy = new NoTrackingReleasePolicy();
    container.AddComponentWithLifestyle<ReleaseTester>(LifestyleType.Transient);
    var target = container.Resolve<ReleaseTester>()

    // act
    target = null;

    // assert        
    dotMemory.Check(memory =>
      Assert.AreEqual(
        0, 
        memory.GetObjects(where => where.Type.Is<ReleaseTester>().ObjectsCount, 
        "Component not released");
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-03-22T17:24:50.347

基于[Paul 的回答](https://stackoverflow.com/a/579001/590790)，我创建了一个更可重用的 Assert 方法。由于`string`'s 是按值复制的，因此我为它们添加了显式检查。它们可以由垃圾收集器收集。

```
public static void IsGarbageCollected<TObject>( ref TObject @object )
    where TObject : class
{
    Action<TObject> emptyAction = o => { };
    IsGarbageCollected( ref @object, emptyAction );
}

public static void IsGarbageCollected<TObject>(
    ref TObject @object,
    Action<TObject> useObject )
    where TObject : class
{
    if ( typeof( TObject ) == typeof( string ) )
    {
        // Strings are copied by value, and don't leak anyhow.
        return;
    }

    int generation = GC.GetGeneration( @object );
    useObject( @object );
    WeakReference reference = new WeakReference( @object, true );
    @object = null;

    // The object should have gone out of scope about now, 
    // so the garbage collector can clean it up.
    GC.Collect( generation, GCCollectionMode.Forced );
    GC.WaitForPendingFinalizers();

    Assert.IsNull( reference.Target );
} 
```

以下单元测试显示该功能在一些常见情况下工作。

```
[TestMethod]
public void IsGarbageCollectedTest()
{
    // Empty object without any references which are held.
    object empty = new object();
    AssertHelper.IsGarbageCollected( ref empty );

    // Strings are copied by value, but are collectable!
    string @string = "";
    AssertHelper.IsGarbageCollected( ref @string );

    // Keep reference around.
    object hookedEvent = new object();
    #pragma warning disable 168
    object referenceCopy = hookedEvent;
    #pragma warning restore 168
    AssertHelper.ThrowsException<AssertFailedException>(
        () => AssertHelper.IsGarbageCollected( ref hookedEvent ) );
    GC.KeepAlive( referenceCopy );

    // Still attached as event.
    Publisher publisher = new Publisher();
    Subscriber subscriber = new Subscriber( publisher );
    AssertHelper.ThrowsException<AssertFailedException>(
        () => AssertHelper.IsGarbageCollected( ref subscriber ) );
    GC.KeepAlive( publisher );
} 
```

由于使用配置时的差异（我假设编译器优化），如果不调用`Release`其中一些单元测试将失败。`GC.KeepAlive()`

完整的源代码（包括一些使用的辅助方法）[可以在我的库中找到](https://github.com/Whathecode/Framework-Class-Library-Extension/blob/master/Whathecode.Microsoft.VisualStudio.QualityTools.Unit/AssertHelper.cs)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T21:01:17.097

这不是一个答案，但是您可能想尝试在**调试**和**发布**模式下运行您的代码（为了比较起见）。

根据我的经验，JIT 代码的**调试**版本更容易调试，因此可能会看到引用保持更长时间（我相信函数范围）但是，在**发布**模式下 JIT 代码可能会在对象超出时快速准备好收集范围以及是否发生集合。

***也没有回答您的问题：:-)*** 我很想看到您在互操作模式（托管和本机）下使用 Visual Studio 调试此代码，然后在显示消息框或其他内容后中断。然后你可以打开 Debug->Windows-Immediate 然后输入

```
load sos
(Change to thread 0)
!dso
!do <object>
!gcroot <object> (and look for any roots) 
```

（或者您可以使用 Windbg，就像其他人在以前的帖子中发布的那样）

谢谢，亚伦

# java - 公开 WCF 服务以便可以从 Java/CXF 轻松使用它的最佳方法是什么？

> ID：578970
> 
> 赞同：8
> 
> 时间：2009-02-23T19:24:46.440
> 
> 标签：java, wcf, cxf

我们编写了一个 WCF 服务，供 Java 商店使用，该商店使用 CXF 生成适配器。我们对 Java 不是很熟悉，但是已经使用 basicHttpBinding、SSL 和基本身份验证公开了该服务。集成测试表明 .NET 客户端可以很好地使用该服务。但是，Java 商店在使用该服务时遇到了问题。具体来说，他们得到以下 JAXB 错误： 两个声明导致 ObjectFactory 类中的冲突。这通常是由于 CXF 尝试创建适配器类时 2 个操作具有相同的名称和命名空间而导致的。

我们找不到任何会导致任何类型冲突的类型或操作名称。我们已确保所有自定义类型都指定了名称空间，并且 tempuri.org 未在 WSDL 中的任何位置指定。Java 商店怀疑错误是因为生成的 WSDL 包含 <xsd:import 元素。

所以，我的问题：

*   有没有比 CXF 更好的方式让 Java 商店使用 WCF 服务？Project Tango 看起来很有趣，但我不知道如何告诉他们考虑使用它。CXF 是 Java 中的事实标准吗？
*   BasicHttpBinding/SSL/Basic Auth 是 MS 推荐的互操作方案，但客户端似乎仍然存在互操作问题。我们是否应该考虑其他绑定或设置以使其更易于使用？
*   有没有办法将 WCF 配置为始终输出没有模式导入的单个 WDSL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T20:48:21.200

“两个声明导致 ObjectFactory 类中的冲突”错误消息通常与导入无关。这是一条 JAXB 错误消息，通常是由于有多个元素或类似元素导致生成的字段名称相同。例如，如果您有以下元素：

<element name="Foo" .../> 和 <element name="foo" .../>

这可能会导致该错误。另一个是使用连字符和下划线之类的东西，通常会被消除+封顶： <element name="doFoo" .../> 和 <element name="do_foo" .../>

在 2.1.4 中，您可以尝试使用 -autoNameResolution 标志运行 wsdl2java。有时会对此有所帮助，但并非总是如此。不幸的是，在这些情况下，JAXB 提供的信息几乎毫无价值，而且很多时候查找冲突类型只是反复试验。:-(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T08:35:37.710

我深入研究 Java 和 WCF 互操作性。正如其他人所说，如果您使用基于文件的 WSDL，则需要扁平化您的 WSDL。但是，我使用 Netbeans 6.5，如果您指向像[http://myservice/?wsdl](http://myservice/?wsdl)这样的真实网址，Netbeans 可以轻松应对 WCF 生成的默认 wsdl。在现实生活中，您需要考虑的其他事情是服务版本控制、可选数据成员（在 java 中并不顺利，所以我建议让所有数据成员 IsRequired=true）、订单等。

真正困难的是安全。我必须使相互证书身份验证工作，它仍然有一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T20:23:17.813

您的 java 客户端与 WCF 组件通信的唯一方法将是一种 HTTP 方法 - 正如 MS 推荐的那样，basicHttpBinding、ws* 等。Java 无法通过 TCP 或 namedPipes 或 MSMQ 等与 WCF 对话。

我会从一个超级简单的 WCF 组件开始 - 用一个方法来吐出一个字符串。使用 Java 实现这一点，然后逐步提高。确保您公开的所有内容都使用基本类型或定义明确的 [DataContract] 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T20:40:12.220

我用 Axis2 客户端开发了 WCF。我成功使用的身份验证方法是 BasicHttpBinding/SSL/Basic（传输）和带有用户名（和 MTOM）的 WS-Security。

SUN 和 Microsoft 使用 Metro 实现来测试互操作： [http ://weblogs.java.net/blog/haroldcarr/archive/2007/11/metro_web_servi.html](http://weblogs.java.net/blog/haroldcarr/archive/2007/11/metro_web_servi.html)

抱歉，不知道 WCF 为架构定义生成的导入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T08:04:32.200

xsd:import 的问题很常见。一些工具包或运行时无法应对。为了解决这个问题，您可以展平由 WCF 生成的 WSDL。检查[这篇文章](http://blogs.msdn.com/dotnetinterop/archive/2008/09/23/flatten-your-wsdl-with-this-custom-servicehost-for-wcf.aspx)。

关于 CXF 是否是正确的 Java 堆栈——我从未听说过？我已经成功使用了 AXIS 以及 JAX-WS。两者都非常简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-19T16:21:54.963

这是一个 Jaxb 问题。我遇到了同样的问题，但在 wsdl2java 客户端生成中使用了 xmlbeans 选项。老实说，就消费者而言，我似乎更喜欢 xmlbeans 对象而不是 jaxb。

# asp.net - 将现有的 asp.net 应用程序（大型）转换为 web 标准

> ID：578974
> 
> 赞同：0
> 
> 时间：2009-02-23T19:26:24.970
> 
> 标签：asp.net, web-standards

我有一个非常大的 ASP.NET 项目，我需要使用 Web 标准来完善它——该应用程序有两个部分：1.）允许用户“构建”站点的管理部分 2.）构成用户的前端网站（许多 Web 控件、母版页、用户控件等……其中大部分只是代码）

我想知道人们对使这个项目利用网络标准的建议是什么？我应该更多地研究 MVC 吗？我还没有对 MVC 做任何事情，但它似乎默认支持友好的 URL。

有没有人用现有的大型 ASP.NET 应用程序/站点完成此操作？

提前致谢 ：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T19:31:02.807

您所说的网络标准是什么意思？有效的html/css？没有故事的布局？有效的JavaScript？

我建议你只是在不同的浏览器中测试它并修复你发现的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T19:31:47.063

您可以选择两条路线。

1）撕掉它并重新开始 2）修改你所拥有的并逐渐改变它“一次一页”

我知道这是一个简单而明显的答案，但说实话，两者都做了，它们都是可行的。

一个现代的 ASP.NET web applciation*可以*是标准兼容的，可以有一些很好的 url 重写一些 url，并且可以将内容与设计分开。您只需要在采取行动之前进行思考，确保使用 .NET 2.0 或 .NET 3.5 控件并检查输出以确保获得良好的标记。

将旧的 Web 应用程序转换为 MVC 可以在不了解应用程序本身的情况下得到真正的回答。它可能非常适合它并且很容易，它可能是一个痛苦的世界。

一如既往地使用最好的工具来完成这项工作。

# delphi - 如何从图像中获取摘要信息？

> ID：578975
> 
> 赞同：2
> 
> 时间：2009-02-23T19:26:25.890
> 
> 标签：delphi, winapi, image

如何在 Delphi 中获取文件图像的摘要信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-23T20:30:36.017

您必须为每种文件类型使用解析器。简单的解决方案是使用[GraphicEx](http://www.soft-gems.net/index.php?option=com_content&task=view&id=13&Itemid=33)之类的东西，并将每个支持的图像加载到一个临时对象中，提取你想要的信息然后处理它。

对于 EXIF 信息（现代相机附加的信息），您可能需要使用不同的组件。我知道有一些组件可以让您访问这种特殊格式，但是并非所有图像类型都支持此数据，并且通常在 JPEG 文件中看到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T08:23:06.790

你什么都不需要。

它包含在 Windows (Win32 COM) 中

请参阅[Win32 api 组](http://news://nntp.aioe.org/comp.os.ms-windows.programmer.win32)（经典问题...）

# user-interface - 最自然的 GUI 工具包

> ID：578976
> 
> 赞同：4
> 
> 时间：2009-02-23T19:26:29.510
> 
> 标签：user-interface, testing

在Stack Overflow 播客的[第 41](https://blog.stackoverflow.com/2009/02/podcast-41/)集中，Jeff 和 Joel 讨论了导致可用性差的 GUI 意识形态。您见过哪些 GUI 工具包对使用它们的程序员产生了最有益的影响？您认为哪种级别的分离（用户界面和实现之间）对可测试性和可用性最有效？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T19:57:13.290

*您见过哪些 GUI 工具包对使用它们的程序员产生了最有益的影响？*

我自己的，基于计算机科学经验和我开发的行业的特定需求而开发的。简而言之，没有灵丹妙药，只有您必须使用经验和判断的工具。适用于我的 CAD/CAM 软件的东西不适用于 Web 开发人员的网站，也不适用于办公软件的开发人员等等。

*您认为哪种级别的分离（用户界面和实现之间）对可测试性和可用性最有效？*

对于在计算机桌面上运行的传统应用程序，我建议使用[Passive View](http://www.martinfowler.com/eaaDev/PassiveScreen.html)的变体。负责创建和管理表单的类是一个将事件传递给 UI 对象的瘦壳。UI_Object 通过接口与表单交互。在术语中，UI 对象实现了一个 UI_View 接口并将其自身注册到位于对象层次结构中较低的视图控制器。

UI_Object 然后执行实现修改模型的命令模式的对象。命令对象可以通过视图控件公开的接口与各种视图交互。

这样做是允许您撕掉表单类并将它们替换为实现表单接口的存根类。存根类用于自动化测试，尤其是集成测试。

这些接口精确地定义了 Form、UI_Object、Commands 和视图之间的交互。它们可以设计为与语言无关，因此它们可以使平台之间的移植更容易。

我对网络编程并不精通，但有一些相关的模式可以完成同样的事情。

我还必须警告说，被动视图可能是矫枉过正。您可能不想将它用于简单的设置对话框（例如设置串行端口参数的对话框）。这是对维护和编码的便利性是否值得增加测试时间的判断。如果对话框仅由单个命令调用以修改某些设置参数，那么在命令本身中定义它是一个很好的选择。

# automation - 软件自动化工具

> ID：578978
> 
> 赞同：-1
> 
> 时间：2009-02-23T19:26:42.253
> 
> 标签：automation

在我的公司，我们必须填写每日考勤卡，我想将其自动化。我想使用某种工具来编写这样的东西：

```
Launch Firefox
go to www.example.com/timecard
Wait for page load complete
In UserName box: put username
In Password box: put password 
Press enter

Wait for page load complete

if login failed
   email me@example.com that unable to automatically do timecard, please check password
   return;

Get today's date

if today is Saturday or Sunday
  close firefox
  return;

find the timecard column that matches today's date
find the row with the right charge number
put in 8.0 hours
click "Save" link
close firefox
return; 
```

如果软件解决方案也能在每天的特定时间自行执行，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-23T19:54:16.323

由于您要询问 UI 自动化，您可能需要查看[AutoHotKey](http://www.autohotkey.com/)。

它是一种宏语言，您可以将代码编译成可执行二进制文件 (.exe)。

但是，通过发送必要的 HTTP 请求，可以在没有浏览器的情况下更好地发送 Web 请求。这种方法更轻量级、更灵活并且可能也更易于维护。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-23T19:35:01.610

查看 Firefox 的[Chickenfoot](http://groups.csail.mit.edu/uid/chickenfoot/)扩展。我相信它可以帮助你很长的路要走。

> Chickenfoot 是一个 Firefox 扩展，它在浏览器的侧边栏中放置了一个编程环境，因此您可以编写脚本来操作网页和自动浏览网页。

它还提供基本的记录功能，然后您可以微调与网页的交互。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T19:34:28.493

为了做出决策，您可能必须编写一些代码。

[iMacros for firefox](https://addons.mozilla.org/en-US/firefox/addon/3863)具有录制/播放功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T19:37:31.527

我自己没有使用过它，但我听说过[Selenium](http://seleniumhq.org/)的好消息。这是一个 Web UI 测试工具，可以用多种不同的语言编写脚本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T19:38:50.087

如果您需要自动化的所有内容都与浏览器有关，那么您可以尝试[Selenium Remote Control](http://seleniumhq.org/)，它提供了不同语言的库。

对于浏览器自动化，javascript 中有几个实验性库（您应该搜索网络应用程序测试工具，因为这些是目前您最好的选择）

./亚历克斯

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T20:17:05.877

我会尝试用[twill](http://twill.idyll.org/)来完成这个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-23T19:40:28.900

如果您所说的“某种工具”是指允许您自动化 FireFox 所做工作的编程语言或环境之类的东西？如果是这样，我建议学习如何编写 FireFox 扩展。扩展是用 Javascript 编写的。请参阅[https://developer.mozilla.org/en/Extensions](https://developer.mozilla.org/en/Extensions)

--
bmb

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T19:41:05.917

您可以在简单的 .net 控制台程序上使用 selenium 或 watin。然后在窗口上配置一个任务以在一天中的给定时间调用它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-23T20:07:12.547

如果您使用的是 Linux，您可以使用某种 bash 脚本轻松完成此操作。看看 CURL 库。[http://curl.haxx.se/](http://curl.haxx.se/)。然后，您可以安排脚本使用 cron 运行。

这就是我喜欢Linux的原因，上面做起来很简单。我是 windows 我想你可以使用 windows shell。我认为 curl 库在 Windows 上运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-23T20:10:24.520

Selenium (www.openqa.org) 工具将为您工作。安装 Selenium IDE 并记录宏。“代码”是简单的 JavaScript/HTML。

Selenium RC 为来自各种语言和工具的自动化测试提供了非常强大的解决方案。

# php - 有没有办法解码 html 电子邮件？

> ID：578982
> 
> 赞同：1
> 
> 时间：2009-02-23T19:27:22.253
> 
> 标签：php, email, class, decode

我正在编写支持软件，我想突出显示 HTML 支持会很棒。

看着 Outlooks “HTML” 我想爬到胎位哭！

是否有一个 php 类来解读 HTML 电子邮件以支持基本 HTML？我不想在框架中显示电子邮件，因为我想处理数据并对其进行分析。我也不想支持像更改字体这样愚蠢的事情，因为它是一个 web 应用程序，我希望我的 web 应用程序说出字体是什么，而不是让一些嬉皮士以漫画 sans 和黄色发送支持团队的电子邮件。我想支持粗体、斜体、下划线、拉伸和列表（[http://dl.getdropbox.com/u/5910/Jing/2009-02-23_2100.png](http://dl.getdropbox.com/u/5910/Jing/2009-02-23_2100.png)）。

我也不太清楚富文本和 html 之间的区别，因为我一直认为富文本只允许我想要的功能，但我似乎能够在富文本中做所有我可以在 Html 中做的事情。

另外我应该补充一下，我正在使用 Zend 框架，因为 Zend_Mail 很棒

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-23T19:54:11.690

您可以通过[htmltidy](http://www.php.net/tidy)对其进行管道传输，然后使用 HtmlPurifier 之类的内容对其进行进一步过滤[，](http://htmlpurifier.org/)但当然您可能会删除对理解内容至关重要的内容。这就是视觉格式的问题，比如 html。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T19:54:45.400

您可以使用 PHP 的[strip_tags()](http://us3.php.net/strip-tags)函数，它是可选的“allowable_tags”参数。这将允许您删除所有不是`<em> <b> <strong> <u>`等的标签。

关于 RTF 与 HTML，我的理解是，当 Outlook 和 Exchange 与不符合 RTF 的系统通信时，它们会将 RTF 转换为 HTML。我不确定这是否总是正确的，或者该功能是否一致，但这可能解释了为什么发送的 RTF 消息似乎是 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T19:37:09.483

我很确定你必须编写自己的类......在我见过的 PHP 文档中没有真正的类......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T19:42:48.550

从 Outlook 邮件中提取 HTML 一开始可能看起来很吓人，但它只是 HTML 标签 - 只是其中的一大堆！

因此，如果您只是定位到“<”然后找到下一个“>”，那么您就有了一个标签。如果它不是你想要的东西，比如“</strong>”，就把它扔掉，然后重复 Simple as that。

（我在拼写和语法检查器中完全做到了这一点，它不仅从 Outlook 中提取纯文本并检查它 - 然后它可以将所有用户的更改推回 HTML 而不破坏任何标签。但后者*并不*容易！ ;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T19:43:45.880

或者，您可以使用附加到电子邮件的纯文本变体。如果没有纯文本变体，您可以使用 html 的剥离版本。我认为使用这些步骤你会得到一个很好的结果：

1.  删除换行符
2.  转入换`</p>`行`<br/>`
3.  剥离所有 html 标签

# python - Python包导入错误

> ID：578983
> 
> 赞同：3
> 
> 时间：2009-02-23T19:27:23.877
> 
> 标签：python, package, python-import

我正在尝试打包我的模块，但我似乎无法让它工作。

我的目录树如下所示：

```
snappy/
    __init__.py
    main/
        __init__.py
        main.py
        config.py
        ...
    ... 
```

我正在使用的代码是

```
from snappy.main.config import * 
```

我收到错误：

```
ImportError: No module named snappy.main.config 
```

任何想法出了什么问题？这是在 Ubuntu 8.10 上使用 Python 2.5。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-23T19:29:12.420

是`snappy`in的父目录`sys.path`吗？如果不是，那是我能想到的唯一会导致您的错误的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T19:31:05.100

这取决于使用导入的脚本所在的位置和系统 PYTHONPATH。基本上，要使导入工作，您应该在 snappy 的父目录中运行脚本（具有导入的脚本），或者您的脚本应该更改 sys.path 以包含它。

./亚历克斯

# java - 不满意的链接：SolarisParallel using rxtx to replace java comm api in Windows XP

> ID：578986
> 
> 赞同：0
> 
> 时间：2009-02-23T19:28:02.937
> 
> 标签：java, serial-port, rxtx

我正在尝试使用 rxtx 2.0 jars 和 dll 在 windows xp 中使用 java comm api，我将 RXTXcomm.jar 复制到 jre\ext 和 rxtxSerial.dll 和 rxtxParallel.dll 到 jre\bin

当我运行程序时，出现以下错误：

加载 SolarisSerial 时出错：java.lang.UnsatisfiedLinkError: no SolarisSerialParallel in java.library.path 捕获 java.lang.UnsatisfiedLinkError: com.sun.comm.SolarisDriver.readRegistrySerial(Ljava/util/Vector;Ljava/lang/String;)加载驱动程序 com.sun.comm.SolarisDriver

为什么它试图加载solaris驱动程序？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T04:56:05.030

看起来您的属性文件可能配置不正确。

找到 Javax.comm.properties 并搜索：

驱动程序=com.sun.commSolarisDriver

如果找到它，请将其注释掉并将其放置在：

驱动程序=gnu.io.RXTXCommDriver

这是[基于 RXTXComm 的 install-japanese.html 文件，由谷歌翻译](http://tinyurl.com/bw8yog)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T01:14:29.563

对于 Windows，我建议使用“Windows Java Serial Com Port Driver”而不是 rxtx。您可以从[http://www.engidea.com/blog/informatica/winjcom/winjcom.html](http://www.engidea.com/blog/informatica/winjcom/winjcom.html)下载它。 我发现它更容易安装和使用，而且更无错误。我无法将 RXTX 与 USB 串行设备一起使用，因为拔下 USB 端口时 RXTX 会崩溃。winjcom 为我解决了这些问题，等等。-斯托什

# c# - Silverlight 2 - 使用 WCF 添加数据库记录

> ID：578999
> 
> 赞同：2
> 
> 时间：2009-02-23T19:31:03.790
> 
> 标签：c#, database, wcf, silverlight

我正在创建一个简单的 Silverlight 2 应用程序 - 留言簿。我使用 MSSQL 作为数据源，我已经设法加载数据，但我不知道如何向数据库添加新行（消息）。

我爬了所有的互联网，但没有找到任何可行的解决方案。SCMEssages 表有四列 - MessageID、MessageDate、MessageAuthor 和 MessageText。现在我在 Service1 类（实现 IService1 接口）中有以下代码（虽然不起作用）：

```
 public void SaveMessage(SCMessage message)
    {
        DataClasses1DataContext db=new DataClasses1DataContext();
        db.GetTable<SCMessage>().Attach(message);
        db.SubmitChanges();
    } 
```

在主类中，我只是调用此方法：

```
 private void SendBtn_Click(object sender, RoutedEventArgs e)
    {
        SCMessage sm = new SCMessage
                           {
                               MessageAuthor = NameTB.Text,
                               MessageDate = DateTime.Now,
                               MessageText = TextTB.Text
                           };
        newMessages.Add(sm);

        ServiceReference1.Service1Client client = new Service1Client();
        client.SaveMessageAsync(sm);
    } 
```

有人可以帮助我吗？感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-23T21:08:30.777

我不确定我是否完全理解上下文（比如你控制你的 WCF 服务和/或你的数据库）。但是您是否考虑过 ADO.Net 数据服务？（也称为[astoria](http://michaelsync.net/2008/01/29/adonet-data-service-in-plain-english)）（[http://msdn.microsoft.com/en-us/library/cc668792.aspx）](http://msdn.microsoft.com/en-us/library/cc668792.aspx)

然后你不需要为它创建一个 web 服务，它已经为你创建好了。

基本上，这是一种从 Silverlight 中访问数据的简单方法，甚至可以从 Silverlight 中进行查询。

博客中已经有一些文档，例如：快速入门在这里： http: [//michaelsync.net/2008/01/15/sumption-adonet-data-service-astoria-from-silverlight](http://michaelsync.net/2008/01/15/consuming-adonet-data-service-astoria-from-silverlight) 如何更新数据可以在这里可以看到：http: [//michaelsync.net/2008/02/10/crud-operations-in-siverlight-using-adonet-data-service](http://michaelsync.net/2008/02/10/crud-operations-in-siverlight-using-adonet-data-service)

一个完整的工作示例在这里：[http ://www.silverlightdata.com/](http://www.silverlightdata.com/)

请注意，在网络上的许多示例中，silverlight 代理是使用命令行生成的，但是不再需要，您可以直接在 VS 中使用“添加服务引用”到您的项目并将其指向您的 ado .net 数据服务

希望这个对你有帮助？

吉普克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T20:58:40.303

SCMessage 是数据类的名称 - 我从模板“Linq to SQL Classes”(.dbml) 创建了一个文件，并将 SCMessages 表拖放到设计器中。它用 [DataContract] 属性装饰，我将它的 DataContext 的序列化模式属性设置为单向。所以 SCMessage 类的内容是自动生成的，但这里至少是其中的一部分：

```
[Table(Name="dbo.SCMessages")]
[DataContract()]
public partial class SCMessage : INotifyPropertyChanging, INotifyPropertyChanged
{

    private static PropertyChangingEventArgs emptyChangingEventArgs = new PropertyChangingEventArgs(String.Empty);

    private int _MessageID;

    private string _MessageAuthor;

    private string _MessageText;

    private System.DateTime _MessageDate;

#region Extensibility Method Definitions
partial void OnLoaded();
partial void OnValidate(System.Data.Linq.ChangeAction action);
partial void OnCreated();
partial void OnMessageIDChanging(int value);
partial void OnMessageIDChanged();
partial void OnMessageAuthorChanging(string value);
partial void OnMessageAuthorChanged();
partial void OnMessageTextChanging(string value);
partial void OnMessageTextChanged();
partial void OnMessageDateChanging(System.DateTime value);
partial void OnMessageDateChanged();
#endregion

    public SCMessage()
    {
        this.Initialize();
    }

    [Column(Storage="_MessageID", AutoSync=AutoSync.OnInsert, DbType="Int NOT NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)]
    [DataMember(Order=1)]
    public int MessageID
    {
        get
        {
            return this._MessageID;
        }
        set
        {
            if ((this._MessageID != value))
            {
                this.OnMessageIDChanging(value);
                this.SendPropertyChanging();
                this._MessageID = value;
                this.SendPropertyChanged("MessageID");
                this.OnMessageIDChanged();
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T22:27:41.797

这是 Astoria 的一个小问题——它对我不起作用。我按照 Michael Sync 的教程进行了一些修改，例如使用 DataServiceQuery，因为 WebDataQuery 在 Astoria 的最终版本中不存在，等等。我最终得到了两个代码片段 - 第一个几乎与 Michael 中的相同副本Sync 的文章和第二篇文章是使用 LINQ 查询而不是 CreateQuery 方法（我认为这两种方法都会导致相同的结果）。以下是片段：

```
SilverchatDBEntities entity =
                new SilverchatDBEntities(new Uri("http://localhost:65373/WebDataService1.svc", UriKind.Absolute));
            entity.MergeOption = MergeOption.OverwriteChanges;
            DataServiceQuery<SCMessages> messages = entity.CreateQuery<SCMessages>("SCMessages");

            messages.BeginExecute(
                result =>
                    {
                        var mess = messages.EndExecute(result);
                        foreach (var mes in mess)
                        {
                            MessagesLB.Items.Add(mes.MessageAuthor);
                        }
                    },
                null); 
```

这不会做任何事情——它不会抛出任何异常，也不会加载任何 SCMessages。第二个片段如下：

```
 SilverchatDBEntities entity =
            new SilverchatDBEntities(new Uri("http://localhost:65373/WebDataService1.svc", UriKind.Absolute));
        var query = (DataServiceQuery<SCMessages>) from m in entity.SCMessages select m;
        query.BeginExecute(new AsyncCallback(result =>
                                                 {
                                                     try
                                                     {
                                                         var mes = query.EndExecute(result);

                                                         foreach (var r in mes)
                                                         {
                                                             MessagesLB.Items.Add(string.Format("{0}; {1} - {2}",
                                                                                                r.MessageDate.
                                                                                                    ToString(
                                                                                                    "d/M hh:mm",
                                                                                                    CultureInfo.
                                                                                                        InvariantCulture),
                                                                                                r.MessageAuthor,
                                                                                                r.MessageText));
                                                         }
                                                     }
                                                     catch (Exception ex)
                                                     {
                                                         MessageBox.Show(ex.Message);
                                                     }
                                                 }), null); 
```

这会在“foreach”循环中引发异常-“对象引用未设置为对象的实例”。我不知道问题可能是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T20:17:58.420

贞洁，

我还没有看到任何明显的错误。所以理论上它应该可以工作（我目前几乎每天都在处理这类查询。有几个问题：1.你能用 fiddler2 来看看发生了什么。（如果你不知道 fiddler 是什么，那么谷歌： -) 如果之后您在 localhost 上使用 fiddler，请在浏览器的 url 中添加一个“.”（如 http:\localhost.:1234\mywebsitehostingsilverlight.aspx），-> 阻止其他 google 搜索）2 . 你有第二个抛出异常的堆栈跟踪。3.您是否尝试在回调中放置断点（第一个示例）以查看是否调用它以及调用它的结果是什么

希望这些问题对解决问题有所帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T20:20:02.687

SCMessage 是用 [DataContract] 属性修饰还是 [Serializable]？请向我们提供 SCMessage 的定义。*****