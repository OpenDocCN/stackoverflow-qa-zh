# StackOverflow 问答 10677000-10677999

# git - “Merge remote-tracking branch 'xxx/master'”是否会为 Pull Request 带来麻烦？

> ID：10677002
> 
> 赞同：3
> 
> 时间：2012-05-20T20:38:15.750
> 
> 标签：git, github, git-merge, git-pull, git-commit

[我已经分叉](https://github.com/C-Duv/AlerteLeboncoin)了一个 Github 存储库，之后在该存储库上进行了多次提交。

我希望这些更正成为我的分叉存储库的一部分，我可能已经将它们合并（但不记得如何合并），现在我有一个名为[*Merge remote-tracking branch 'blount/master'*](https://github.com/C-Duv/AlerteLeboncoin/commit/ec93dec3786a255f52ddfc1407220dd2d1222ff0)的提交。

这对我将来提出的拉取请求有问题吗？或者当所有者接受我的拉取请求时，他们会不会发生任何事情？

我找到了[*为什么我将“远程跟踪分支 'origin/develop' 合并到开发中”？*](https://stackoverflow.com/questions/6406762/why-am-i-merging-remote-tracking-branch-origin-develop-into-develop)stackoverflow 问题说明了如何避免这种情况，但如果现有的*合并提交*是一个问题，则不是。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T02:06:58.927

这通常取决于 a) 拉取请求是否可以自动合并 b)（更重要的是）测试是否通过。

您可以创建一个`upstream`指向原始存储库的远程，然后合并`upstream master`到`origin master`它会是最新的。

您应该首先执行此操作以抢先解决任何合并冲突或意外损坏。

# ios - 使用 MFMailComposer 发送 CSV 文件

> ID：10677004
> 
> 赞同：3
> 
> 时间：2012-05-20T20:38:44.697
> 
> 标签：ios, xcode, mfmailcomposeviewcontroller

我想使用带有 .csv 扩展名的 NSString（已经制作）创建一个文件，然后使用 UIMessage 框架通过电子邮件发送它。所以有人可以告诉我创建文件的代码（带有.csv扩展名和NSString的内容）然后如何将它附加到MFMailComposeViewController。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-20T21:09:18.007

这是将 CSV 文件附加到 MFMailComposeViewController 的方式：

```
 MFMailComposeViewController *mailer = [[MFMailComposeViewController alloc] init];
    mailer.mailComposeDelegate = self;
    [mailer setSubject:@"CSV File"];        
    [mailer addAttachmentData:[NSData dataWithContentsOfFile:@"PathToFile.csv"]
                     mimeType:@"text/csv" 
                     fileName:@"FileName.csv"];
    [self presentModalViewController:mailer animated:YES];

    // Note: PathToFile.csv is the actual path of the file on your iOS device's 
    // file system. FileName.csv is what it should be displayed as in the email. 
```

至于如何生成 CSV 文件本身，[https: //github.com/davedelong/CHCSVParser 上的](https://github.com/davedelong/CHCSVParser)**CHCSVWriter**类 将为您提供帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-05T01:59:12.717

这是您创建新 csv、将其保存到文件并将其全部附加到一个的部分。你知道，如果你喜欢那种事情

```
NSString *emailTitle = @"My Email Title";
NSString *messageBody = @"Email Body";

MFMailComposeViewController *mc = [[MFMailComposeViewController alloc] init];
mc.mailComposeDelegate = self;
[mc setSubject:emailTitle];
[mc setMessageBody:messageBody isHTML:NO];
[mc setToRecipients:@[]];

NSMutableString *csv = [NSMutableString stringWithString:@""];

//add your content to the csv
[csv appendFormat:@"MY DATA YADA YADA"];

NSString* filePath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString* fileName = @"MyCSVFileName.csv";
NSString* fileAtPath = [filePath stringByAppendingPathComponent:fileName];

if (![[NSFileManager defaultManager] fileExistsAtPath:fileAtPath]) {
    [[NSFileManager defaultManager] createFileAtPath:fileAtPath contents:nil attributes:nil];
}

BOOL res = [[csv dataUsingEncoding:NSUTF8StringEncoding] writeToFile:fileAtPath atomically:NO];

if (!res) {
    [[[UIAlertView alloc] initWithTitle:@"Error Creating CSV" message:@"Check your permissions to make sure this app can create files so you may email the app data" delegate:nil cancelButtonTitle:@"Okay" otherButtonTitles: nil] show];
}else{
    NSLog(@"Data saved! File path = %@", fileName);
    [mc addAttachmentData:[NSData dataWithContentsOfFile:fileAtPath]
                     mimeType:@"text/csv"
                     fileName:@"MyCSVFileName.csv"];
    [self presentViewController:mc animated:YES completion:nil];
} 
```

# ios - 在 iOS 上，如果我们为 UIViewController 的视图使用 Interface Builder，我们如何为它实现一个 drawRect？

> ID：10677012
> 
> 赞同：0
> 
> 时间：2012-05-20T20:39:52.153
> 
> 标签：ios, uiview, interface-builder

如果我们使用 Interface Builder 来编辑视图中的内容，那么我们如何`drawRect`向那个`UIView`对象添加一个呢？（可能我们想要一个子类的新类`FooView`——`UIView`但是`.xib`内容将如何放置在这个视图上？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T20:49:38.223

在 xib 中向视图控制器的视图添加“内容”只涉及添加子视图 - 这些不受`drawRect:`.

也就是说，要将自定义类设置为`view`视图控制器的主要属性，只需在 xib 中选择视图，转到身份检查器，然后将类从 UIView 更改为您的自定义类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T20:50:24.980

一开始我想指出我已经用 UIButton 做了这样的事情（子类化），[因为](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIButton_Class/UIButton/UIButton.html) UIButton 是从 UIView 继承的，所以 UIView 也必须是可能的。

（在子类化 UIView 之后）在视图控制器上创建子类的实例，并将此实例作为子视图添加到 ViewController。此时，您可以调用您在子类中声明的特定 drawRect: 方法

# c - 如何计算目录中特定类型文件的数量

> ID：10677013
> 
> 赞同：0
> 
> 时间：2012-05-20T20:40:07.350
> 
> 标签：c, file-io

我正在尝试找出一种方法来计算目录中特定文件的数量，例如我有一个目录

```
hi-austin.txt goodbye-austin.txt cya-austin.txt hey-austin.txt 
```

我想计算符合这个规范的文件的数量，*-austin.txt，通常我会为此使用 bash 函数 find，但我正在寻找一个 C 替代方案，我对我如何应该这样做，任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T20:49:34.543

你可以使用：

*   [`opendir()`](http://linux.die.net/man/3/opendir)并[`readdir()`](http://linux.die.net/man/3/readdir)访问当前目录中的文件名
*   检查文件名是否以特定字符串结尾：

    ```
    int ends_with(const char* const a_str,
                  const char* const a_search_str)
    {
        const size_t str_len    = strlen(a_str);
        const size_t search_len = strlen(a_search_str);

        return str_len > search_len &&
               0 == strcmp(a_search_str, &a_str[str_len - search_len]);
    } 
    ```

# java - 如何在 SparseDoubleMatrix2D（Java Colt 库）中找到最大值？甚至在一维矩阵中

> ID：10677014
> 
> 赞同：0
> 
> 时间：2012-05-20T20:40:13.963
> 
> 标签：java, matrix, max, sparse-matrix, colt

在概述网站[http://acs.lbl.gov/software/colt/api/index.html](http://acs.lbl.gov/software/colt/api/index.html)上，据说可以通过 Columnwise Data Analysis 找到（一列的）最大值。但是我搜索了很长时间，找不到方法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-03T05:20:12.153

不完全是您想要的，但可能会帮助其他人寻找类似的东西：

在并行 colt 中，有用于查找最大值和最小值的直接方法，以及 location: 方法`getMaxLocation()`，`getMinLocation()`并且存在于类`cern.colt.matrix.tdouble.DoubleMatrix1D`和`cern.colt.matrix.tdouble.DoubleMatrix2D`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T20:57:08.150

它是 cern.jet.stat.Descriptive.max(DoubleArrayList)。您必须使用`new DoubleArrayList(doubleMatrix2D.viewColumn(iColumn).toArray())`.

# javascript - select() iframe 中的文本区域

> ID：10677015
> 
> 赞同：0
> 
> 时间：2012-05-20T20:40:13.830
> 
> 标签：javascript, html, iframe, textarea

我在 iframe 中有一个文本区域。我想在 JavaScript 中选择带有 onclick 事件的 textarea 文本。

例子：

```
I have an iframe.

The inner content of the iframe is this:
<textarea id="textarea" disabled onclick="selectthis()">
"content of textarea"
</textarea> 
```

我想选择文本以便用户可以复制它：

```
I put this at the head of my page:

function selectthis() {
   document.getElementById('textarea').select();
} 
```

但是当我点击 textarea 时，它没有被选中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T20:46:32.037

你需要这个：

```
document.getElementById('textarea').select(); 
```

函数在 Javascript 中区分大小写，因此请确保正确大写所有内容（我`e`将`getElementById`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T20:47:14.347

## 　 　　　　　　　　你`getElementById`打错了。

* * *

更改`getelementById`为`getElementById`。JavaScript 区分大小写。

![在此处输入图像描述](../Images/6fc9132708b3705f9bf5ea5397285f06.png) [http://jsfiddle.net/DerekL/ArGhg/](http://jsfiddle.net/DerekL/ArGhg/)

**加，**

```
<textarea id="textarea" onclick="selectthis">  <!--Nope-->
<textarea id="textarea" onclick="selectthis();">  <!--Yup!--> 
```

* * *

## 更新

我看到你在那里做了什么。您不能选择*禁用* `<textarea>`的文本。
见[http://jsfiddle.net/DerekL/ArGhg/2/](http://jsfiddle.net/DerekL/ArGhg/2/)

根据 Francisc 的评论，使用`readonly`将解决问题。
见[http://jsfiddle.net/DerekL/ArGhg/3/](http://jsfiddle.net/DerekL/ArGhg/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T20:47:16.050

该函数`selectthis`可能会生成一个 ecception，因为它找不到任何具有`textarea`as id 的元素。问题是您使用`document.getElementById`（我修正了错字），但 textarea 不属于`document`. 您必须访问 iframe 自己的文档对象，通常是这样的：

```
var iframe = document.getElementsByTagName("iframe")[0];
var ifrDoc = iframe.contentDocument;
var textarea = ifrDoc.getElementById("textarea");
textarea.select(); 
```

注意：在 IE8 中你必须指定一个 doctype，而在早期版本中你可以使用它`iframe.contentWindow.document`。

# python - NLTK 中的实际字数

> ID：10677020
> 
> 赞同：9
> 
> 时间：2012-05-20T20:40:46.973
> 
> 标签：python, nlp, nltk

NLTK 书中有几个字数统计示例，但实际上它们不是字数统计，而是令牌计数。例如，第 1 章，计数词汇说以下给出了字数：

```
text = nltk.Text(tokens)
len(text) 
```

然而，它没有——它给出了一个单词和标点符号的数量。你怎么能得到一个真正的字数（忽略标点符号）？

同样，如何获得一个单词的平均字符数？显而易见的答案是：

```
word_average_length =(len(string_of_text)/len(text)) 
```

但是，这将被关闭，因为：

1.  len(string_of_text) 是字符数，包括空格
2.  len(text) 是一个记号计数，不包括空格但包括标点符号，它们不是单词。

我在这里错过了什么吗？这一定是一个非常常见的 NLP 任务……

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-09-05T13:19:47.253

使用 nltk 进行标记化

```
from nltk.tokenize import RegexpTokenizer
tokenizer = RegexpTokenizer(r'\w+')
text = "This is my text. It icludes commas, question marks? and other stuff. Also U.S.."
tokens = tokenizer.tokenize(text) 
```

退货

```
['This', 'is', 'my', 'text', 'It', 'icludes', 'commas', 'question', 'marks', 'and', 'other', 'stuff', 'Also', 'U', 'S'] 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-20T20:46:05.293

## 删除标点符号

使用正则表达式过滤掉标点符号

```
import re
from collections import Counter

>>> text = ['this', 'is', 'a', 'sentence', '.']
>>> nonPunct = re.compile('.*[A-Za-z0-9].*')  # must contain a letter or digit
>>> filtered = [w for w in text if nonPunct.match(w)]
>>> counts = Counter(filtered)
>>> counts
Counter({'this': 1, 'a': 1, 'is': 1, 'sentence': 1}) 
```

## 平均字符数

将每个单词的长度相加。除以字数。

```
>>> float(sum(map(len, filtered))) / len(filtered)
3.75 
```

或者你可以利用你已经做过的计数来防止一些重新计算。这将单词的长度乘以我们看到它的次数，然后将所有这些相加。

```
>>> float(sum(len(w)*c for w,c in counts.iteritems())) / len(filtered)
3.75 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-01T06:35:35.540

## 删除标点符号（没有正则表达式）

[使用与dhg](https://stackoverflow.com/users/247985/dhg)相同的解决方案，但测试给定的标记是字母数字，而不是使用正则表达式模式。

```
from collections import Counter

>>> text = ['this', 'is', 'a', 'sentence', '.']
>>> filtered = [w for w in text if w.isalnum()]
>>> counts = Counter(filtered)
>>> counts
Counter({'this': 1, 'a': 1, 'is': 1, 'sentence': 1}) 
```

好处：

*   在 bool(nonPunct.match("à")) 是`"À".isalnum()`（至少在法语中“à”不是标点符号 ）时，对非英语语言效果更好。`True``False`
*   不需要使用`re`包。

# ios - 在 iBook 中打开名称中带有空格的 PDF

> ID：10677021
> 
> 赞同：0
> 
> 时间：2012-05-20T20:40:48.567
> 
> 标签：ios, ipad

我已经在我的 PDF 查看器中实现了已经讨论过的第 n 次在 iBook 中打开的功能。当 PDF 文件不包含空格（example1.pdf、example2.pdf）时效果很好。当 PDF 的名称中有一些空格（例如 1.pdf）时，单击在 iBook 中打开按钮不会执行任何操作。

```
NSString *fileURL = [(Documents *)(self.detailItem) url];
NSArray *subStrings = [fileURL componentsSeparatedByString:@"/"];
NSString *filePath = [[self documentsDirectory] stringByAppendingPathComponent:[subStrings lastObject]];
docIntController = [UIDocumentInteractionController interactionControllerWithURL:[NSURL fileURLWithPath:filePath]];
docIntController.delegate = self;
docIntController.UTI = @"com.adobe.pdf";

[docIntController presentOptionsMenuFromBarButtonItem:sender animated:YES]; 
```

欢迎任何建议。谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:11:44.843

由于 filePath 字符串旨在成为 URL，因此您可能需要[`NSString -stringByAddingPercentEscapesUsingEncoding:`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/uid/TP40003744)在调用之前运行它`fileURLWithPath:`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T21:05:37.430

尝试用引号将您发送到 iBooks 的完整路径括起来。例如，使用“example 1.pdf”而不是 example1.pdf。

# c++ - 如何每秒发送最大数量的 udp 数据包

> ID：10677024
> 
> 赞同：-1
> 
> 时间：2012-05-20T20:41:12.387
> 
> 标签：c++, visual-studio-2010, udp

我在 Windows Server 2008 r2 上的 Visual Studio 2010 for c++ 中有一个应用程序

伪代码如下

创建多播套接字

while ( 仍然要传输的数据 == true ) { sendto ( 多播套接字，数据 ) }

但我只能达到大约 60k 消息/秒，其中每个数据包的大小约为 50 字节。

谁能建议如何每秒发送更多的消息？我想我可以尝试绑定 2 个或更多 NIC，我应该尝试使用线程安全消息队列和线程池，其中每个线程只是尝试从队列中拉出一个元素并发送到（多播套接字，数据）；?

这里有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T21:03:19.217

让它更快的唯一方法是绕过网络层，并使用原始套接字。

# ruby - 用 Ruby 读取 nmap 输出（基本问题）

> ID：10677030
> 
> 赞同：0
> 
> 时间：2012-05-20T20:42:08.113
> 
> 标签：ruby, network-programming, nmap

我想构建一个定期使用 nmap 进行 ping 扫描的东西，以检测主机出现和断开网络。有没有一种简单的方法可以读取 Ruby 的 nmap 输出？我的偏好是避免使用 3rd 方库。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:58:25.330

尝试解析 Nmap 的文本输出是错误的方法。格式在过去已经改变了很多次，而且将来肯定会改变。正确的方法是解析 Nmap 的 XML 输出，由`-oX`参数生成。已经有一些为此设计的 Ruby 库（Chris Gates[在他的博客中](http://carnal0wnage.attackresearch.com/2010/01/ruby-nmap-xml-and-databases.html)介绍了这种方法），或者您可以从 XML 解析器库开始并自行开发。[Nokogiri](http://nokokiri.org/)是一个非常好的 Ruby 中的 XML 解析库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T20:48:53.330

你可以尝试这样的事情：

```
require 'open3'
stdin, stdout, stderr = Open3.popen3('nmap -sP 192.168.1.0/24') 
```

然后你可以解析 stdout 和 stderr 并使用标准 Ruby 获得任何你想要的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:02:23.027

已经了解到，只需在命令周围使用反引号，我就可以将输出捕获为变量：

test = `nmap -sP 192.168.1.0/24` p 'test:' puts test.split("\n")

似乎工作完美。然而，正如 bonsaiviking 所指出的，研究 nmap 的 XML 功能是明智的。

# twitter-bootstrap - Bootstrap 布局 - 移除响应性

> ID：10677036
> 
> 赞同：4
> 
> 时间：2012-05-20T20:43:23.163
> 
> 标签：twitter-bootstrap, responsive-design

我正在尝试创建一个固定布局并主要将 Bootstrap 用于 Javascript 插件。但是当我尝试将大小调整到 1000 像素以下时，布局会中断。

> [http://mink7.com/projects/test/index.html](http://mink7.com/projects/test/index.html)

![在此处输入图像描述](../Images/9f547fca2d9b5f9a9772b05dfd60a5d8.png)

![在此处输入图像描述](../Images/dba0e7132b77317d7b462ea8710a0c84.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T20:49:25.357

您包含的 Bootstrap CSS 我相信其中包含响应式元素。如果您查看 Bootstraps 网站，它们的源代码中包含这两个版本。

```
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet"> 
```

最简单的方法是只包含`boostrap.css`文件而不是`bootstrap-responsive.css`

# smartcard - 智能卡上的 ElGamal

> ID：10677039
> 
> 赞同：1
> 
> 时间：2012-05-20T20:43:50.030
> 
> 标签：smartcard, javacard, elgamal

我想知道智能卡/Javacard 是否能够执行 ElGamal 加密？它是否在任何地方实现，即是否有可用于此类目的的 API？

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T00:23:24.747

NXP 的 SmartMX 系列支持 ElGamal，它在他们的公共数据表中。我不认为我在任何 Java Card 实现中都提到过，它不在标准中，所以如果存在，它必须在供应商提供的库中。

可能任何具有蒙哥马利乘数的智能卡都能够相对有效地支持 ElGamal。然后*有人*需要创建一个库（具有侧通道保护、认证等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-11T15:35:40.553

这当然没有经过认证，并且对于侧信道攻击也不安全，但如果它用于原型设计或侧信道攻击不在威胁模型中，[这](https://github.com/OpenCryptoProject/Myst/blob/master/MPCApplet/src/mpc/MPCCryptoOps.java "这里")是我们的实现。

# php - PHP 间隔计时

> ID：10677048
> 
> 赞同：0
> 
> 时间：2012-05-20T20:44:52.123
> 
> 标签：php, scripting, time, intervals

我有一个问题，我正在运行一个脚本，并且 PHP 行复制到 $num_newlines 等于的任何数字。这是我目前正在使用的：

```
for ($i=1; $i<=($num_newlines - 1); $i++) {
$tweetcpitems->post('statuses/update', array('status' => wordFilter("The item $array[$i]    has been released on Club Penguin.")));
} 
```

我想要做的是有 90 秒的间隔，但是有很多重复。所以我不会在 10 秒内发 50 次推文。我想做的是在每条推文之间添加 90 秒的间隔，请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T20:51:36.547

使用`sleep()`功能：

```
for ($i = 1; $i <= $num_newlines - 1; $i ++) {
    $tweetcpitems->post('statuses/update', array('status' => wordFilter('The item ' . $array[$i] . ' has been released on Club Penguin.')));
    sleep(90);
} 
```

此片段在每条推文之后休眠，也在最后一条之后休眠。为防止在最后一条推文后不必要的睡眠，请使用以下命令：

```
for ($i = 1; $i <= $num_newlines - 1; $i ++) {
    $tweetcpitems->post('statuses/update', array('status' => wordFilter('The item ' . $array[$i] . ' has been released on Club Penguin.')));

    if ($i <= $num_newlines - 1) {
        sleep(90);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:01:01.450

两种选择：

1.  如果您可以设置[CRON 作业](http://en.wikipedia.org/wiki/Cron)- 创建要发布的消息[队列](http://en.wikipedia.org/wiki/Queue_%28data_structure%29)（在数据库或文件中）并让脚本每 90 秒运行一次，该脚本从队列中取出一条消息并发送它。

2.  在发送消息之间使用[`sleep`](http://php.net/manual/en/function.sleep.php)函数。请注意，您可能需要增加[时间限制](http://www.php.net/manual/en/function.set-time-limit.php)（来自注释：*在 Linux 下，睡眠时间被忽略，但在 Windows 下，它计为执行时间*）。

# android - android日历库保存错误的日期

> ID：10677052
> 
> 赞同：0
> 
> 时间：2012-05-20T20:45:13.787
> 
> 标签：android, calendar

我正在使用日历库从我的应用程序中保存日期。我正在使用 sqlite3，只能将整数和字符串保存到我的数据库中。日历转换为 long ，当转换回来时显示正确的日期。但是要将其保存在我的数据库中，我必须将其转换为 int。当我将 int 转换回 long 并使用 setTimeInMillis() 时，我的日期会发生变化。我知道当您从 long 转换为 int 时，您会失去精度。有解决办法吗？有人告诉我，我必须使用日历库来完成我正在做的事情。下面是给我带来问题的代码，任何想法。已经做了谷歌搜索，没有任何运气

```
 long timing=0;
    timing =dateAndTime.getTimeInMillis();
    testDate.setTimeInMillis(timing);
    int dates=  (int) timing;
    timing=dates;
    testDate.setTimeInMillis(timing); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T20:51:28.210

这并不是说你失去了精确度。long 比整数包含更多字节，因此您将丢失 int 无法保存的任何数据。您最好将 long 转换为 String 并将其存储为 ( `Long.toString(l)`)。当您想将其从数据库中取出时，只需将 String 解析为 long ( `Long.parseLong(s)`)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T20:53:39.520

为了让您了解 int 的限制程度，您可以在 int 中存储的最长时间（以毫秒为单位）为 49 天。long 拥有足够的信息来计算 5.8 亿年的毫秒数。

# asp.net - 如何在注销时清除 MVC 3 路由参数

> ID：10677065
> 
> 赞同：0
> 
> 时间：2012-05-20T20:46:48.767
> 
> 标签：asp.net, asp.net-mvc-3, routes, logout

我有一个使用 razor 的 ASP.net MVC 3 应用程序，当使用默认 AccountController 注销当前用户时，我发现了一个安全问题。单击注销（_LogoutPartial 视图）后，我被重定向到登录页面。很好，但是当我在浏览器上单击返回时，它允许我返回 Web 应用程序并且不要求我登录。

带参数的路由如下：

```
routes.MapRoute(
                "Person", // Route name
                "Person/{profileName}/{action}/{id}", // URL with parameters
                new { controller = "Person", action = "Index", id = UrlParameter.Optional } // defaults
            );
//example http://localhost:1946/Person/JoeBlack/ListTeamMembers 
```

似乎 {profileName} 在会话中仍然处于活动状态（？）并允许调用控制器。但是控制器操作 {ListTeamMembers} 具有 [Authorize()] 属性，所以我不确定它是如何让用户进入的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T06:30:24.170

当您按下浏览器上的后退按钮时，将从浏览器的缓存中检索最后一页。服务器永远不会被击中。用户不再经过身份验证。这意味着如果他尝试执行某些操作并发送 HTTP 请求，他将被重定向到登录页面。防止这种情况发生的方法是从客户端浏览器缓存中排除所有经过身份验证的页面。您可以为此作业使用[自定义 NoCache 操作过滤器。](https://stackoverflow.com/a/1705113/29407)

# c# - C#：如何将文本和二进制数据的组合写入文件？

> ID：10677066
> 
> 赞同：1
> 
> 时间：2012-05-20T20:47:02.753
> 
> 标签：c#

我的人需要我输出一个包含文本字符串（每个字符存储为 2 位十六进制值）和 ushorts（每个 16 位 ushort 存储为 4 位十六进制值）组合的文件。

我试图用 来做到这一点`StreamWriter`，但每个数字都被逐位写入文件......因此，例如，值 257 被写为 32 35 37。我需要将其写为 01 01。

也许我可以使用`StreamWriter`和`BinaryWriter`写入同一个文件？我一直无法弄清楚这一点......

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T20:48:47.647

`BinaryWriter`并且`.WriteChars(...)`和`.WriteUInt##(...);`

# linux - 如何跟踪文件中模式的倒数第二次出现

> ID：10677069
> 
> 赞同：0
> 
> 时间：2012-05-20T20:47:09.843
> 
> 标签：linux, bash, shell, tail

我知道使用 `tail -1`我可以获取文件中特定模式的最后一次出现。但是如何追尾呢？我试过`tail-2`了，这给了我倒数第二个和最后一个。

我正在使用 bash

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T20:53:32.157

您可以链接头/尾：

```
tail -3|head -2 
```

其中，假设您有这样的文件：

```
a
b
c
d
e 
```

会有尾产

```
c
d
e 
```

然后抓头

```
c
d 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T21:30:47.753

```
sed -n 'x;$p' inputfile 
```

这会将当前行交换到保持空间，并将前一行交换到模式空间。在最后一行，打印模式空间的内容（恰好是倒数第二行。

# javascript - phonegap 动态 javascript 按钮

> ID：10677071
> 
> 赞同：0
> 
> 时间：2012-05-20T20:47:13.937
> 
> 标签：javascript, cordova

学习如何使用 Phonegap 创建 Android 应用程序 我仍在尝试 HTML 和 JavaScript 的基础知识。试图添加一个按钮，我一定是做错了什么……

这是我的身体元素：

```
<div data-role="page">
    <div data-role="header">
        <h1>My Title</h1>
    </div>
    <div data-role="content" id="divContent">   
        <p id="content"></p>
    </div>
</div> 
```

首先，我有一些基本的功能。我有一个数据库查询（它有效），结果应该产生一些文本和一个按钮：

```
if(results.rows.item(0).c == 0){
    document.getElementById("content").innerHTML=
        "You don't have any service items ....etc";
    var btn = document.createElement("newItem");
    btn.setAttribute("type", "button");
    btn.setAttribute("value", "AAARGH!");
    btn.setAttribute("name", "btnNew");
    document.getElementById("divContent").appendChild(btn);
} 
```

文本显示，按钮没有，我不明白为什么。根据我的阅读，这是使用 JavaScript 创建按钮的方法。

完整的源代码在这里：[http ://code.google.com/p/easy-service/source/browse/trunk/EasyService-Common/app/app.html](http://code.google.com/p/easy-service/source/browse/trunk/EasyService-Common/app/app.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T20:52:07.633

您需要`button`像这样创建节点：

```
var btn = document.createElement("input"); 
```

您传入的参数是元素的类型——在这种情况下，我们需要一个`input`元素。

# c++ - 嵌套模板类中的模板函数

> ID：10677076
> 
> 赞同：0
> 
> 时间：2012-05-20T20:47:36.463
> 
> 标签：c++, templates, inner-classes

我一直在处理的一些代码中遇到问题。这是我可以创建的最简化的版本：

```
template <class A>
class Outer {
public:
    template <class B>
    class Inner {
    public:
        template <class C>
        void foo(Outer<C>::Inner<C> innerC) { }
    };

    Inner<A> inner;
};

class X {};
class Y {};

int main() {
    Outer<X> outerX;
    Outer<Y> outerY;
    outerX.foo<Y>(outerY.inner);
} 
```

错误是：

```
error: expected primary-expression before ">" token 
```

并在编译时在声明 . 时触发`void foo`。导致这种情况发生的我的代码有什么不正确的地方？

换句话说，我想要做的是让嵌套类能够接受具有任何模板类型的嵌套类 - 但当然嵌套类的模板类型取决于外部类的模板类型，所以我使用`::`语法，但是这给出了一个错误。

我知道我在这里尝试做的可能不是一个好习惯，但这个问题的目的是更好地理解模板语法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T20:51:15.743

没有从`1`到的转换`Inner<C>`。这是您减少的测试用例中的错误，还是应该是：

```
template <class C>
void foo(C innerC) { } 
```

**更新：**修复代码后，可以看出问题是缺少`template`before `Inner<C>`。否则编译器将假定这`Inner`是一个值。

```
template <class C>
void foo(Outer<C>::template Inner<C> innerC) { } 
```

# c# - C#正则表达式用newLine在两个字符串之间查找字符串

> ID：10677077
> 
> 赞同：5
> 
> 时间：2012-05-20T20:47:45.917
> 
> 标签：c#, .net, regex, string

这是我的正则表达式：`Regex r = new Regex("start(.*?)end", RegexOptions.Multiline);`

这意味着我想得到 和 之间的`"start"`东西`"end"`。但问题是 start 和 end 之间是一个新行，或者`\n`正则表达式不返回任何内容。

那么如何让正则表达式找到`\n`呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T20:50:03.830

该`Multiline`选项的名称具有误导性，正确的选项之一也是如此 - `Singleline`：

```
Regex r = new Regex("start(.*?)end", RegexOptions.Singleline); 
```

来自 MSDN，[RegexOptions 枚举](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions.aspx)：

> Singleline - 指定单行模式。更改点 (.) 的含义，使其匹配每个字符（而不是除 \n 之外的每个字符）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T20:49:56.120

包括 RegexOptions.SingleLine 这意味着`.`匹配所有内容，包括`\n`

```
Regex r = new Regex("start(.*?)end", RegexOptions.Multiline | RegexOptions.SingleLine); 
```

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions.aspx 。](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T20:52:25.607

使用**Singleline**而不是*Multiline*：

```
Regex r = new Regex("start(.*?)end", RegexOptions.Singleline); 
```

顺便说一句，[RegexBuddy](http://www.regexbuddy.com/)是您无价的朋友（不，我与作者没有任何联系，除了是一个快乐的用户）。

# jquery - jquery 在.removeClass().addClass() 之后不识别新类？

> ID：10677078
> 
> 赞同：1
> 
> 时间：2012-05-20T20:47:48.010
> 
> 标签：jquery, addclass, removeclass

也许我这样做不正确/效率低下，但这对我不起作用：

```
$(document).ready(function(){

    $('li.taglink').click(function(){
        alert('clicked tag');
        $userClicked = $(this).html();
        $('#holder').children('div').each(function () { 
            $('li.taglinkcurrent').removeClass('taglinkcurrent').addClass('taglink');                                       
            $x = $(this).attr("tags");
            ele = $x.split(',');
            for (var i = 0; i < ele.length; i++) 
            {
            if ($userClicked == ele[i]) {$(this).show(495); break;} 
                                    else {$(this).hide(495);}   
            }
        });
        $(this).removeClass('taglink').addClass('taglinkcurrent');
    });

    $('li.taglinkcurrent').click(function(){
        alert('clicked current');
        $('li.taglinkcurrent').removeClass('taglinkcurrent').addClass('taglink');                               
        $('li.taglink').show(495);
    });

}); 
```

该页面包含具有“标签”属性的 div，其中包含多个标签。我还有一个无序列表，每个 li 元素都包含单独的标签。当用户单击其中一个 li 元素时，它会显示所有具有该标签的 div，并隐藏其他所有内容。如果用户单击相同的 li 元素，它会再次显示所有内容。我添加了警报以测试发生了什么，每次单击链接时都会弹出“单击的链接”，即使 li 将其类切换为 .taglinkcurrent。关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T20:55:10.720

当您第一次运行代码时，您将绑定到该`click()`事件，因此`"taglink"`该类是唯一起作用的类。

要根据对 dom 的更改来更改函数，请改用以下`on()`方法：

[http://api.jquery.com/on/](http://api.jquery.com/on/)

```
$(document).on("click", "li.taglink", function() { 
  // ... 
}); 
```

但是，该方法有很多警告`on()`- 有关更多详细信息，请参阅上面的文档。

编辑：从 v1.7 开始，将“live”更改为“on”，这是首选方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T20:59:25.577

我想该事件归因于加载时的每个 li，并且后续的类更改不会解除该事件的绑定。但是我认为您可以通过这种方式轻松解决此问题：

```
$('li').click(function() {
    if ( $(this).hasClass("taglink") ) {
        alert("clicked tag");
        ...
    } else if ( $(this).hasClass("taglinkcurrent") ) {
        alert('clicked current');
        ...
    }
}); 
```

# c# - C# 和 Internet Explorer 自动化，访问缓存

> ID：10677088
> 
> 赞同：1
> 
> 时间：2012-05-20T20:49:19.863
> 
> 标签：c#, internet-explorer

我在 C# 中有一个 Internet Explorer 自动化脚本，它工作正常，但我想访问验证码图像，验证码链接每次访问时都会返回一个刷新的图像，并且由于浏览器已经访问过它，再次访问它会搞砸，所以我尝试使用以下代码在磁盘上的浏览器缓存中查找图像

```
tempDir = Environment.GetFolderPath(Environment.SpecialFolder.InternetCache).ToString();
System.Console.WriteLine(tempDir);
supstra = element.innerHTML.ToString().Substring(element.innerHTML.ToString().IndexOf("/sorry/image?id="), element.innerHTML.ToString().Length - element.innerHTML.ToString().IndexOf("/sorry/image?id="));
Console.WriteLine("http://www.goolge.com/sorry/image?id=" + element.innerHTML.ToString().Substring(element.innerHTML.ToString().IndexOf("/sorry/image?id="), supstra.IndexOf("&amp;hl=")));
captchas = client.Decode(tempDir + "\\" + element.innerHTML.ToString().Substring(element.innerHTML.ToString().IndexOf("/sorry/image?id=") + 7, supstra.IndexOf("&amp;hl=")).Replace("amp;", "") + "=en", 0); 
```

然而，缓存目录中的图像不是图像，而是命令或具有名称的东西`image?id=....`

它所做的就是重新访问并获得新的形象。我要做的似乎是以某种方式访问​​浏览器显示的图像，这可能只在内存中，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:55:25.037

请参阅此处有关[Accessing IE cache in C# 的](http://social.msdn.microsoft.com/Forums/pl/ieextensiondevelopment/thread/622dd0b5-c100-4330-bdc7-db78a7757d72)线程。

具体来说，从问题：

> 由于 Internet Explorer 已经在显示网页，因此网页中的图像必须已经存储在本地缓存中的某个位置

答案（强调我的）：

> 您想使用[GetUrlCacheEntryInfo()](http://msdn.microsoft.com/en-us/library/aa384185%28VS.85%29.aspx)。
> 
> 从函数返回时使用 INTERNET_CACHE_ENTRY_INFO 结构的 lpszLocalFileName。
> 
> 此外，你的一个前提是有缺陷的。 **有时 IE 仅具有图像的内存表示，并且磁盘上的项目已被删除**。例如，如果设置了 no-cache 指令，就会出现这种情况。或者用户已清除缓存但未从页面导航。或者清道夫已将其删除但用户尚未导航。可能还有 5 到 7 个其他场景。

过去，当我不得不做类似的事情时，我会强制 Web 浏览器（在这种情况下为 IE）使用[Fiddler2 之](http://www.fiddler2.com/fiddler2/)类的东西作为代理。在 Fiddler2 中，我可以截获特定 URL 的图像请求，并使用 C# 将它们保存到已知位置的磁盘中。然后自动化程序可以从那里抓取它们。

# python - create_logout_url 行为怪异

> ID：10677095
> 
> 赞同：0
> 
> 时间：2012-05-20T20:50:05.857
> 
> 标签：python, google-app-engine

我正在尝试`create_logout_url`在一个简单的 appengine 站点中创建一种管理菜单，但它目前的行为非常奇怪。看看下面的代码：

```
menu = []

logout_link = "<a href='%s'>Log out</a>" % users.create_logout_url('/blog')
menu.append(logout_link)

new_entry = ''
if users.is_current_user_admin():
new_entry = "<a href='%(newpost)s'>New entry</a>" % {'newpost': self.uri_for('blog_entry')}
menu.append(new_entry)
return ','.join(menu) 
```

预期的输出应该是这样的：

```
<a href='/_ah/login?continue=http%3A//localhost%3A8080/blog&action=Logout'>Log out</a>,<a href='/blog/newpost'>New entry</a> 
```

但实际上是：

```
<a href="<a href='/_ah/login?continue=http%3A//localhost%3A8080/blog&action=Logout'>Log out</a>,<a href='/blog/newpost'>New entry</a>">Log out</a> 
```

有任何想法吗？

## 更新

我正在尝试在我的基本处理程序中使用上面的代码（其中包含许多可以在任何地方重用的代码，比如这个管理菜单和模板函数），如果它有帮助或重要的话。

`logout_link`将-part更改为：

```
logout_link = users.create_logout_url('/blog') 
```

结果如下：

```
<a href="/_ah/login?continue=http%3A//localhost%3A8080/blog&action=Logout,<a href='/blog/newpost'>New entry</a>">Log out</a> 
```

（我之前已经尝试过，但是没有用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:47:55.563

Monotux，您能否向我们提供有关您的代码的更多详细信息。您说您正在使用其他一些菜单和模板功能。

提供的代码段生成正确的代码：

```
<a href='/_ah/login?continue=http%3A//localhost%3A8080/blog&action=Logout'>Log out</a>,<a href='/blog/newpost'>New entry</a> 
```

鉴于您看到的两个输出：

```
<a href="<a href='/_ah/login?continue=http%3A//localhost%3A8080/blog&action=Logout'>Log out</a>,<a href='/blog/newpost'>New entry</a>">Log out</a>
<a href="/_ah/login?continue=http%3A//localhost%3A8080/blog&action=Logout,<a href='/blog/newpost'>New entry</a>">Log out</a> 
```

两者都是形式

```
<a href='...'>Log out</a> 
```

我认为您正在将片段的响应嵌入到其他代码中。

# c++ - 如何从成员对象的函数访问对象中的变量

> ID：10677103
> 
> 赞同：0
> 
> 时间：2012-05-20T20:51:12.127
> 
> 标签：c++

好的，我有课：

```
class class1
{
public:
     class2 object2;
     int a;
}; 
```

在哪里：

```
class class2
{
public:
    void function2();
}; 
```

基本上，我需要 object2 中的 function2 才能访问“a”。我该怎么做呢？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T20:54:08.863

```
 class class2
 {
  public:
        void Function2(class1& c1)
        {
          c1.a;
        }
  } 
```

简单的。

# ios - 克隆 CVPixelBuffer - 如何？

> ID：10677107
> 
> 赞同：3
> 
> 时间：2012-05-20T20:51:23.710
> 
> 标签：ios, ios5, core-video

假设我有一些与变量关联的像素缓冲区：

CVPixelBufferRef a;

我想**克隆**该缓冲区及其所有内容，并将克隆的缓冲区分配给另一个变量。最正确和最快速的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T16:03:01.177

到目前为止，我没有找到比 memcpy() 更好的解决方案。希望它复制所有需要的数据。

# android - Android - 如果想要保存输入的数据，如何在返回键上提醒用户？

> ID：10677115
> 
> 赞同：1
> 
> 时间：2012-05-20T20:52:18.333
> 
> 标签：android, android-alertdialog, android-lifecycle

在用户输入数据中，UI/UX 屏幕有“保存”、“取消”按钮。如果用户输入一些数据，但点击返回键，我需要显示（AlertDialog）他是否要保存数据。怎么办？

我认为这应该通过以下方式完成：@override onDestroy() ？但无法（有点）保持/暂停 onDestroy() 并显示 AlertDialog ！

这将类似于“Microsoft Word”所做的事情，但在 Android 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:02:22.207

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_BACK) {
        if(needsSave){
            .
            .
            .
            return true;
        }
    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-21T08:36:21.107

有一种专门用于此目的的方法，当用户按下设备上的后退按钮时会调用该方法。

```
 @Override
public void onBackPressed() {
    //super.onBackPressed();
   ..call the dialog builder here..
} 
```

当用户按下正面或负面按钮时，您可以使用 super.onBackPressed() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-26T08:21:03.717

如果你有片段，你可以通过监听器，然后你可以在用户按下后退按钮时收听，你会收到通知。

创建接口。

```
interface IOnBackPressed {
    fun onBackPressed(): Boolean
} 
```

在您的活动中。

```
class MyActivity : AppCompatActivity() {

     override fun onBackPressed() {
        val fragment =
            this.supportFragmentManager.findFragmentById(R.id.main_container)
        (fragment as? IOnBackPressed)?.onBackPressed()?.not()?.let {
            super.onBackPressed()
        }
    }

} 
```

在你的片段中。

```
class YourFragmentName : Fragment(), IOnBackPressed {

    override fun onBackPressed(): Boolean {
            //Create Your Dialog.
           //Dialog.Positive.clicked return true
          //Dialog.Negate.clicked return false
    }
} 
```

# c++ - 读取数字列表并排序 C++

> ID：10677119
> 
> 赞同：3
> 
> 时间：2012-05-20T20:52:31.383
> 
> 标签：c++, arrays, sorting

我正在尝试从文件中读取数字列表并通过将它们读入数组然后对数组的内容进行排序来对它们进行排序。但我越来越

```
error:incompatible types in assignment of 'std::basic_ostream<char, std::char_traits<char> >' to 'int [1]' 
```

我对编程相当陌生，这是我第一次使用 C++ 谁能告诉我如何将数字列表写入数组以便我可以对它们进行排序？这是我所拥有的：

```
#include <fstream>
#include <iostream>
#include <iomanip>
#define ANYSIZE_ARRAY 1
using std::cout;
using std::endl;

int main()
{
  const char* filename = "test.txt";
  std::ifstream inputFile(filename);
  int numbers[ANYSIZE_ARRAY];
  int i, key;

  // Make sure the file exists
  if(!inputFile)
  {
    cout << endl << "The File is corrupt or does not exist. " << filename;
    return 1;
  }

  long n = 0;
  while(!inputFile.eof())
  {
    inputFile >> n;
    numbers = cout << std::setw(10) << n;
  }

  for(int j=1;j<5;j++)
    {
        i=j-1;
        key=numbers[j];
        while(i>=0 && numbers[i]>key)
        {
                    numbers[i+1]=numbers[i];
                    i--;
        }
        numbers[i+1]=key;
    }

    //Display sorted array
    cout<<endl<<"Sorted Array\t";
     for(i=0;i<5;i++)
       cout<<numbers[i]<<"\t";
    cout<<endl;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T21:21:08.740

导致错误的行是：

```
numbers = cout << std::setw(10) << n; 
```

我不太确定你想在这里做什么，看起来你只是想打印它，在这种情况下`numbers =`不需要。

读取所有数据的循环结构也存在问题。这条线：`while (!inputFile.eof())`不是惯用的 C++，*也不会*做你希望的事。[有关该问题的讨论，请参见此处](https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong)（以及[此处](http://www.parashift.com/c++-faq-lite/input-output.html#faq-15.5)）。

作为参考，您可以使用更少的工作轻松完成此操作`std::sort`

```
#include <iterator>
#include <algorithm>
#include <vector>
#include <fstream>
#include <iostream>

int main() {
  std::ifstream in("test.txt");
  // Skip checking it

  std::vector<int> numbers;

  // Read all the ints from in:
  std::copy(std::istream_iterator<int>(in), std::istream_iterator<int>(),
            std::back_inserter(numbers));

  // Sort the vector:
  std::sort(numbers.begin(), numbers.end());

  // Print the vector with tab separators: 
  std::copy(numbers.begin(), numbers.end(), 
            std::ostream_iterator<int>(std::cout, "\t"));
  std::cout << std::endl;
} 
```

该程序还使用 a`std::vector`而不是数组来抽象“我的数组应该有多大？” 问题（您的示例看起来可能存在问题）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T21:14:33.120

以下是您需要执行的操作才能使您的程序正常工作：

*   更改`ANYSIZE_ARRAY`为**5**
*   在您阅读数字的地方，将其替换为`while`：

    ```
    long n = 0;
    i=0;
    while(!inputFile.eof())
    {
            inputFile >> n;
            cout << std::setw(10) << n;
            numbers[i]=n;
            i++;
    } 
    ```

这样，您将创建一个可以容纳 5 个数字的数组，并将这些数字读入该数组。我使用 5 是因为我看到您在排序算法中使用了相同的数字，所以我假设您只需读取 5 个数字。这是一件坏事，因为您的程序只能处理 5 个数字。

如果您需要它处理可变数量的数字，您可以使用 a[`std::vector<long>`](http://www.cplusplus.com/reference/stl/vector/)来存储数字。您可以创建一个向量，然后使用`push_back()`向它添加数字。向量将自动调整大小，并且将包含您输入的任意数量的数字。然后，您可以将`5`代码中的 s 替换为向量的`size()`方法。

您收到原始错误是因为此行没有意义：

```
numbers = cout << std::setw(10) << n; 
```

C++ 将这一行视为您试图将数字打印到标准输出流（在我们的例子中是控制台，屏幕），然后将该流分配给“数字”数组。您不能将输出流分配给整数数组（因此错误无法从 ostream 转换为 int[1]）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-20T21:25:02.663

首先，您不应该将 outstream 变量分配给 int。其次，n 是 long 类型， numbers 是整数数组。存在类型不安全。第三，您应该预先分配数组大小。第四，您可以直接在 STL 函数中使用 sort() 进行排序。

试试下面的代码：

```
#include <fstream>
#include <iostream>
#include <iomanip>
#include <algorithm>
using namespace std;

#define ANYSIZE_ARRAY 5

int main()
{
const char* filename = "test.txt";
std::ifstream inputFile(filename);
int numbers[ANYSIZE_ARRAY];
int i, key;

// Make sure the file exists
if(!inputFile)
{
    cout << endl << "The File is corrupt or does not exist. " << filename;
    return 1;
}

int n = 0;
i = 0;
while(!inputFile.eof())
{
    inputFile >> n;
    cout << std::setw(10) << n;
    numbers[i++] = n;
}

sort(numbers, numbers + ANYSIZE_ARRAY);

//Display sorted array
cout<<endl<<"Sorted Array\t";
for(i=0; i<ANYSIZE_ARRAY; i++)
    cout<<numbers[i]<<"\t";

cout<<endl;
} 
```

# android - 从坐标获取位置

> ID：10677120
> 
> 赞同：7
> 
> 时间：2012-05-20T20:52:47.593
> 
> 标签：android, android-location

我已经给出了纬度和经度的坐标，我想用它们制作一个位置对象。没有一个构造函数需要双打来制作一个位置，所以我尝试这样：

```
 Location l = null;
 l.setLatitude(lat);
 l.setLongitude(lon); 
```

但它崩溃了。有什么不同的想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-20T21:03:30.210

只需使用 new Location("reverseGeocoded"); 创建一个新位置 像这样

```
GeoPoint newCurrent = new GeoPoint(59529200, 18071400);
        Location current = new Location("reverseGeocoded");
        current.setLatitude(newCurrent.getLatitudeE6() / 1e6);
        current.setLongitude(newCurrent.getLongitudeE6() / 1e6);
        current.setAccuracy(3333);
        current.setBearing(333); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-20T21:02:58.460

这会崩溃，因为您不能在不存在的对象上调用方法。

我想你在谈论android.location.Location？

这通常是由Android的各种定位服务返回的。你想用它做什么？

你想反向地理编码吗？就像找到那个地理坐标的地址一样？

还是您想将其用作“假”位置并将其提供给其他应用程序？

顺便说一句，有两个构造函数。一个采用定位服务的名称，另一个是复制构造函数并采用现有的位置。

所以你可以像这样创建一个位置：

```
Location l = new Location("network"); 
```

但我不认为这会导致你想要的东西。

这是文档的链接：

[https://developer.android.com/reference/android/location/Location.html#Location%28java.lang.String%29](https://developer.android.com/reference/android/location/Location.html#Location%28java.lang.String%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:05:10.293

```
Location l = new Location("any string"); 
l.setLatitude(lat);
l.setLongitude(lon); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T06:09:42.193

试试这个：

```
public double lat;  
public double lon;  

public void onLocationChanged(Location loc)  
{  
lat=loc.getLatitude();  
lon=loc.getLongitude();  
Toast.makeText(getBaseContext(),"Latitude:" + lat +Longitude"+lon,Toast.LENGTH_LONG).show();    
} 
```

# java - Java 设计：处理许多类使用的数据对象

> ID：10677123
> 
> 赞同：4
> 
> 时间：2012-05-20T20:53:16.250
> 
> 标签：java, data-objects

首先，简要介绍一下引发此问题的库：

我有一个库，它在提供的串行端口上连续侦听，读取字节块并将它们传递给以某种有意义的方式进行处理（细节对问题并不重要）。为了使库更具可重用性，处理这些字节被抽象到一个接口（FrameProcessor）。库本身中存在一些默认实现来处理无论应用程序使用它总是会发生的处理。但是，支持添加自定义处理器来执行应用程序特别关心的事情。

除了传递给这些处理器的字节之外，还有一个数据对象 (ReceiverData)，其中包含大多数（但不保证是全部）处理器可能会感兴趣的信息。它完全由库本身维护（即，应用程序不负责设置/维护 ReceiverData 的任何实例。他们不必关心数据是如何可用的，只要它可用就可以了）。

现在，ReceiverData 正在作为参数传递给每个处理器：

```
public interface FrameProcessor {

    public boolean process(byte[] frame, ReceiverData receiverData);
} 
```

但是，我真的不喜欢这种方法，因为它需要将数据传递给可能不一定关心它的东西。此外，对于关心 ReceiverData 的处理器，他们必须在他们进行的任何其他方法调用中传递对象引用（前提是这些方法调用需要访问该数据）。

我考虑过将 FrameProcessor 更改为抽象类，然后为受保护的 ReceiverData 成员定义一个设置器。但这似乎也有点粗俗——必须遍历所有 FrameProcessors 的列表并设置 ReceiverData 实例。

我还考虑过某种静态线程上下文对象（由于库支持一次侦听多个端口，因此必须线程化）。本质上，您将拥有以下内容：

```
public class ThreadedContext {

    private static Map<Long, ReceiverData> receiverData;

    static {
        receiverData = new HashMap<Long, ReceiverData>();
    }

    public static ReceiverData get() {
        return receiverData.get(Thread.currentThread().getId());
    }

    public static void put(ReceiverData data) {
        receiverData.put(Thread.currentThread().getId(), data);
    }
} 
```

这样，当库中的每个线程启动时，它只需将其 ReceiverData 的引用添加到 ThreadedContext，然后处理器可以根据需要使用该引用，而无需传递它。

这当然是一个迂腐的问题，因为我已经有了一个可以正常工作的解决方案。它只是困扰我。想法？更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:08:22.440

我最喜欢你目前的方法。它本质上是线程安全的（因为无状态）。它允许多个线程使用同一个处理器。它易于理解和使用。例如，它非常类似于 servlet 的工作方式：请求和响应对象被传递给 servlet，即使它们并不关心它们。而且它也很容易进行单元测试，因为您不必设置线程本地上下文来测试处理器。您只需传递一个 ReceiverData（真实的或虚假的），就是这样。

您可以将两者混合在一个参数中，而不是传递一个字节数组和一个 ReceiverData。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:17:23.957

`byte[]`将和封装`ReceiverData`到一个新类中并将其传递给帧处理器。这不仅意味着他们可以将相同的单个对象传递给他们自己的方法，而且还可以在必要时允许未来的扩展。

```
public class Frame {
    private byte[] rawBytes;
    private ReceiverData receiverData;

    public ReceiverData getReceiverData() { return receiverData; }
    public byte[] getRawBytes() { return frame; }
}

public interface FrameProcessor {
    public boolean process(Frame frame);
} 
```

虽然这看起来有点矫枉过正并且需要处理器进行不必要的方法调用，但您可能会发现您不想提供对原始字节数组的访问。也许您想改用 a`ByteChannel`并提供只读访问权限。这取决于您的库以及它的使用方式，但您可能会发现您可以在内部提供`Frame`比简单字节数组更好的 API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T22:47:16.780

正如OP所述，问题`process(byte[] frame, ReceiverData data)`在于实现`ReceiverData`可能会或可能不会使用它。因此，`process()`依赖`ReceiverData`. 相反，`FrameProcessor`实现应该使用可以按需为当前帧`Provider`提供实例的。`ReceiverData`

下面的例子说明了这一点。为了清楚起见，我使用了依赖注入，但您也可以在构造函数中传递这些对象。将`FrameContext`使用`ThreadLocal<T>`s，就像 OP 中建议的那样。有关实施提示，请参阅[此链接](http://code.google.com/p/google-guice/wiki/CustomScopes)。DIY`Provider<T>`实现可能`FrameContext`直接依赖于。

如果您想走这条路，请考虑使用 DI 框架，例如[Google Guice](http://code.google.com/p/google-guice/)或[CDI](http://seamframework.org/Weld)。使用自定义范围时，Guice 可能更容易。

```
public class MyProcessor implements FrameProcessor {

    @Inject
    private Provider<ReceiverData> dataProvider;

    public boolean process(byte[] frame) {
        ...
        ReceiverData data = dataProvider.get();
        ...
    }
}

public class Main {

    @Inject
    private FrameContext context;

    public void receiveFrame(byte[] frame, ... ) {

        context.begin();
        ...
        context.setReceiverData(...); // receiver data is thread-local
        ...

        for (FrameProcessor processor : processors)
            processor.process(frame);

        context.end();
    }
} 
```

这种方法非常可扩展；未来需要的对象可以添加到上下文/范围对象中，并将相应的提供者注入处理器：

```
public class MyProcessor ... {

    @Inject private Provider<FrameMetaData>;
    @Inject private Provider<FrameSource>;
    ...
} 
```

正如您从这个示例中看到的，这种方法还可以让您避免将来您将“子对象”添加到`ReceiverData`的情况，从而导致厨房水槽对象情况（例如，、、`ReceiverData.metaData`... `ReceiverData.frameSource`）。

**注意：**理想情况下，您将处理生命周期等于单帧的对象。然后，您可以在构造函数中声明（并注入！）用于处理单个帧的依赖项，并为每个帧创建一个新的处理器。但我假设您正在处理大量帧，因此出于性能原因想要坚持使用当前方法。

# c++ - Windows 上的 C++：获取分配内存的函数？

> ID：10677124
> 
> 赞同：3
> 
> 时间：2012-05-20T20:53:27.863
> 
> 标签：c++, windows, memory-leaks

我在 C++ 中编码，在 Windows 7 上使用 Visual Studio 2008。

我的应用程序有内存泄漏，我可以通过系统监视器看到它。

我需要在代码中发现它。

它是否存在返回分配给调用进程的内存量的函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T22:07:21.790

有*一个*特定于 MSVC 的 memleak 检测解决方案

```
// enable memory leaks detection
#if !defined(NDEBUG)
HANDLE hLogFile = CreateFile( "log.txt", GENERIC_WRITE, FILE_SHARE_WRITE,
                              NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL );
#endif

_CrtSetReportMode( _CRT_ASSERT, _CRTDBG_MODE_FILE | _CRTDBG_MODE_WNDW  | _CRTDBG_MODE_DEBUG );
_CrtSetReportMode( _CRT_WARN, _CRTDBG_MODE_FILE   | _CRTDBG_MODE_DEBUG );
_CrtSetReportMode( _CRT_ERROR, _CRTDBG_MODE_FILE  | _CRTDBG_MODE_WNDW  | _CRTDBG_MODE_DEBUG );

_CrtSetReportFile( _CRT_ASSERT, hLogFile );
_CrtSetReportFile( _CRT_WARN,   hLogFile );
_CrtSetReportFile( _CRT_ERROR,  hLogFile );

int tmpDbgFlag = _CrtSetDbgFlag( _CRTDBG_REPORT_FLAG );
tmpDbgFlag |= _CRTDBG_ALLOC_MEM_DF;
tmpDbgFlag |= _CRTDBG_DELAY_FREE_MEM_DF;
tmpDbgFlag |= _CRTDBG_LEAK_CHECK_DF;
_CrtSetDbgFlag( tmpDbgFlag );

if ( BlockIndex > 0 )
{
    _CrtSetBreakAlloc( BlockIndex );
} 
```

这个令人毛骨悚然的代码启用了所有未分配块的文件协议。当然，它与 MSVCRT 的 debug 版本有很深的联系

# android - android模拟器中的传感器？

> ID：10677128
> 
> 赞同：6
> 
> 时间：2012-05-20T20:53:42.110
> 
> 标签：android, android-emulator, emulation

我想使用加速度传感器创建一个应用程序。但我不知道如何在模拟器中测试它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T20:59:53.503

我不认为 Android 模拟器默认情况下很好地支持加速度传感器。

但是，您可以从 Google 下载[SensorSimulator](http://code.google.com/p/openintents/wiki/SensorSimulator)，它可以让您使用鼠标为 Android 模拟器提供模拟传感器数据。只需按照网站上的说明进行操作即可。

**更新（2016 年 4 月 5 日）：**

正如 Maks 所指出的，OpenIntents SensorSimulator 已移至此处：http: [//github.com/openintents/sensorsimulator](http://github.com/openintents/sensorsimulator)

此外，现在支持一些硬件仿真：[http ://tools.android.com/tips/hardware-emulation](http://tools.android.com/tips/hardware-emulation)

# java - Java - 通过通道传输大文件 - NIO

> ID：10677130
> 
> 赞同：6
> 
> 时间：2012-05-20T20:53:46.797
> 
> 标签：java, nio

我必须使用 NIO 通过 ServerSocket 传输约 100MB 的数据，但我无法弄清楚如何做到这一点，而不会在任何地方传输中断/保持传输状态。

我的第一个想法是发送文件的大小，显然我无法发送那个大文件的大小，因为它甚至无法立即放入 RAM。然后我想，为什么不直接转移直到什么都没有收到，但那就是问题来了。

即使我一直在写服务器端数据

```
 FileChannel fc = new FileInputStream(f).getChannel();
        ByteBuffer buffer = ByteBuffer.allocate(1024);
        while(fc.read(buffer) > 0) {
            buffer.flip();
            while(channel.write(buffer) > 0);
            buffer.clear();
        } 
```

但是因为文件传输必须中断一些时间不断读取数据并且在没有可用数据时中断是个坏主意。

我不知道我怎么可能告诉客户端是否还有可用的数据，而不必将每个数据片作为带有操作码等的新数据包发送，或者甚至有可能吗？

我也想知道是否有比下面更好的方法来发送整个缓冲区

```
while(channel.write(buffer) > 0); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:11:28.053

也许你正在寻找这个：

```
channel.transferFrom(0, fc.size(), fc); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T00:41:32.873

通过缓冲区复制通道的正确方法如下：

```
while (in.read(buffer) >= 0 || buffer.position() > 0)
{
  buffer.flip();
  out.write(buffer);
  buffer.compact();
} 
```

这会处理所有极端情况，包括读取长度！= 写入长度以及在输入末尾留下数据。

NB 用于阻塞模式。如果您处于非阻塞模式，则`select()`如果 read() 或 write() 返回零，则应返回循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T22:05:40.437

如果您不能依赖套接字保持打开状态，则无法在您的协议中构建恢复并继续机制。至于告诉客户端需要多少字节，您可以在不将文件读入内存的情况下使用[`File.length`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#length%28%29).

# sql - 在 Sql Server Management Studio 中保存带有标题的结果

> ID：10677133
> 
> 赞同：200
> 
> 时间：2012-05-20T20:54:18.197
> 
> 标签：sql, sql-server-2008, excel, ssms, export-to-excel

我正在使用 SQL Server Management Studio。

我希望将查询结果保存到 excel 文件中。

我选择“另存为”，然后保存到可以在 excel 中打开的 CSV 文件。一切都很好，除了我缺少列标题，有什么想法可以导出它们吗？

* * *

## 回答 #1

> 赞同：303
> 
> 时间：2012-05-20T20:57:23.410

`Tools`> `Options`> `Query Results`> `SQL Server`> `Results to Text (or Grid if you want)`>`Include columns headers in the result set`

更改此选项后，您可能需要关闭并重新打开 SSMS。

**在 SQL 编辑器工具栏上，您可以选择保存到文件而无需重新启动 SSMS**

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-05-20T21:29:37.637

尝试导出向导。在此示例中，我选择了整个表，但您也可以轻松地指定查询：

![在此处输入图像描述](../Images/78ac50d0d08a2e750ba8a3ec3843f08e.png)

![在此处输入图像描述](../Images/456b95fd7e2960011140de6af0019fa4.png)

![在此处输入图像描述](../Images/ac46ccf1ac198f088f42801d927d551f.png)

![在此处输入图像描述](../Images/d1eb9351bdcb5d31fb4edb9a7f56e525.png)

（您也可以在此处指定查询）

![在此处输入图像描述](../Images/c0f29786c1c9c5bcd6790b88d0b76ba2.png)

![在此处输入图像描述](../Images/5d3a85b8f4b9e848ec0836089fb719ca.png)

![在此处输入图像描述](../Images/63899553df8bc2c679f3863e781d3cb9.png)

![在此处输入图像描述](../Images/1f84da81482e4e6fead0c5b7d6b2074d.png)

![在此处输入图像描述](../Images/629d35afb6af6825114fbd125624a08e.png)

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2012-05-20T21:56:48.653

另一种可能性是使用剪贴板将结果直接复制并粘贴到 Excel 中。请注意常规类型的 Excel 列，因为它们有时会产生不可预测的结果，具体取决于您的数据。`CTL-A`结果网格中的任意位置，然后右键单击：

![在此处输入图像描述](../Images/f1dcf98bf13804a0b9afe2fae7bed04d.png)

如果您在使用 Excel 的常规格式进行不需要的转换时遇到问题，请在粘贴之前选择 Excel 中的空白列并将格式更改为“文本”。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-06-02T22:47:24.310

至少在 SQL Server 2012 中，您可以在查询窗口中右键单击并选择查询选项。从那里您可以为网格和/或文本选择包含标题，并让另存为以您想要的方式工作，而无需重新启动 SSMS。

您仍然需要在菜单栏中的工具->选项中对其进行更改，以使新的查询窗口默认使用这些设置。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-11-16T18:24:01.127

Visual Studio 中也存在同样的问题，以下是解决方法：

去：

```
Tools > Options > SQL Server Tools > Transact-SQL Editor > Query Results > Results To Grid 
```

现在单击复选框为真：“复制或保存结果时包括列标题”

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-09-04T19:11:17.070

通过单击左上角选择您的结果，右键单击并选择“使用标题复制”。粘贴到excel中。完毕！

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-03-18T09:35:03.623

如果您想为将来在 SQL Server Management Studio (SSMS) 中打开的所有查询会话永久设置此选项，建议在 @Diego 接受的答案中更改的设置可能会很好。通常情况*并非*如此。此外，更改此设置需要重新启动 SQL Server Management Studio (SSMS) 应用程序。如果您有许多未保存的打开查询会话窗口并且您正在进行一些调试，这又是一种“不太好”的体验。

**SQL Server 提供了一个非常灵活的选项，可以在每个会话的基础上进行更改，非常快速、方便和方便**。我正在使用查询选项窗口详细说明以下步骤：

1.  在查询编辑器窗口中单击鼠标右键 > 单击`Query Options...`上下文菜单底部的 ，如下所示：

[![在此处输入图像描述](../Images/4c8618430014d1fdecfdcdf731943b10.png)](https://i.stack.imgur.com/yU24y.png)

2.  在左侧导航窗格中选择`Results`> 。`Grid`选中`Include column headers when copying or saving the results`右窗格中的复选框，如下所示：

[![在此处输入图像描述](../Images/00dc05fe62dd08af79e17d9cea9d1be7.png)](https://i.stack.imgur.com/KzQPv.png)

就是这样。您当前的会话将立即生效您的设置，而无需重新启动 SSMS。此外，此设置不会传播到任何未来的会话。**在每个会话的基础上有效地更改此设置的噪音要小得多。**

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-08-27T11:07:16.340

在寻找一种方法来使 SSMS 在导出结果时正确转义 CSV 分隔符时到达这里。

你猜怎么了？- 这其实是一个选项，*默认是不勾选的*。因此，默认情况下，您会得到损坏的 CSV 文件（甚至可能没有意识到，尤其是如果您的导出很大并且您的数据通常没有逗号） - 您必须进入并单击一个复选框，以便您的 CSV 导出正确！

对我来说，这似乎是一个极其愚蠢的设计选择，也是对微软总体软件方法的恰当比喻（“默认情况下被破坏，需要毫无意义的仪式化操作才能使琐碎的功能发挥作用”）。

但是，如果有人可以给我一个有效的现实生活理由来支持这个选项的存在（即它有用的实际场景），我很乐意向受访者选择的慈善机构捐赠 100 美元。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-09-07T00:21:48.397

在 SQL Server 2014 Management Studio 中，设置位于：

工具 > 选项 > 查询结果 > SQL Server > 结果到文本 > 在结果集中包含列标题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-03T16:35:51.950

我也面临同样的问题。当我在查询窗口中使用右键单击并选择查询选项时。但标题行不会显示在输出 CSV 文件中。

然后我注销服务器，再次登录并运行脚本。然后它起作用了。

# javascript - 对一个端口上只有一个应用程序的节点应用程序使用代理服务器（例如 node-http-proxy）有什么意义？

> ID：10677135
> 
> 赞同：6
> 
> 时间：2012-05-20T20:54:56.500
> 
> 标签：javascript, node.js, proxy, node-http-proxy, nodejitsu

我正在探索使用[node-http-proxy](https://github.com/nodejitsu/node-http-proxy)代理服务器，以便我可以让端口 80 上的代理服务器将请求转发到端口 8000 上的应用服务器。但是，我有点困惑为什么这是一个好主意，以及这种设置究竟会在安全方面提供什么保护。

note-http-proxy 文档讨论了很多关于将其用作将请求转发到具有多个端口或 IP 地址的应用程序的方法。这显然会非常有用，特别是对于基本的循环负载均衡器策略。但是，我们在一个端口上只有一个应用程序，所以我们没有必要这样做。

如果我们应该使用这个代理服务器有一个重要的安全原因，那么我很想知道它可以防止哪些类型的攻击。此外，我们使用的是 socket.io，所以如果代理可以帮助 websocket 服务器扩展，我也想了解这一点。我们很难弄清楚如何在没有的情况下运行我们的应用程序`sudo`（因为低于 1024 的所有端口都需要 root 访问权限），所以如果此时确实没有充分的理由使用代理服务器，我们就放弃了。如果有人知道如何在没有 root 访问权限的情况下在端口 80 上使用代理服务器运行此应用程序，那也将非常有帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T11:51:28.663

运行反向代理的原因是：

*   您打开的 IP 端口有限，需要运行许多 Node 服务，每个服务都需要自己的端口
*   您的后端服务不支持 HTTPS，但您需要它（例如 Derby）
*   向请求中添加一些后端无法轻松完成的其他功能，例如添加基本身份验证或某种形式的常见日志记录/审计
*   强制对多个后端服务中常见的传出响应进行添加或更改
*   提供负载均衡服务

除非您的需求非常简单，否则最好使用[HAproxy](http://haproxy.1wt.eu/)等专用代理，因为 node-http-proxy 相当简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:47:47.237

好吧，如果您只运行一个服务器实例，那么就没有真正的理由。node-http-proxy 文档提到在多个应用程序中使用单个 SSL 证书，这是很有可能的。您还可以跨多个 HTTP 和 Web 套接字服务器进行负载平衡（例如，运行 10 个 socket.io 服务器来获取实时数据，但只运行 1 个 HTTP 服务器来提供资产和 REST API）。当然，在一个实例中，这些不会提供任何好处。

如果您想在没有 sudo 的情况下运行节点服务器，也许您可​​以尝试设置 IP 表端口转发从端口 80 到高于 1024 的端口。请参阅[我可以以低权限运行 Node.JS 吗？](https://stackoverflow.com/questions/8312171/can-i-run-node-js-with-low-privileges)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-21T08:03:42.173

我们主要使用 http-proxy 在单个 IP 后面拥有多个后端服务器，但我们也使用它来将 https 转发到 http。它增强了我们的应用程序。

安全方面，您可能对 http-proxy 的质量比对您的应用程序更有信心。nodejitsu 构建的代理已准备好投入生产，攻击者应该更难在 http-proxy 而不是您自己的应用程序上获得特权（例如读取私钥文件）（当然这取决于您的安全开发技能和您的信任在开源 http-proxy 项目中）。

# asp.net - 如何使用元标记从搜索引擎中隐藏页面？

> ID：10677138
> 
> 赞同：0
> 
> 时间：2012-05-20T20:56:08.427
> 
> 标签：asp.net, html, meta-tags

我想使用元标记从搜索引擎中隐藏一个页面。是否有相同的元标记？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T20:59:01.137

采用

```
<meta name="robots" content="noindex"> 
```

以防止所有机器人索引页面。

此外，您可以通过按名称引用特定机器人来定义规则：

```
<meta name="googlebot" content="noindex"> 
```

请参阅[谷歌网站管理员页面。](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=93710)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T21:44:56.480

您可以使用 META 标签，尽管它可能不是您的最佳选择。对于您的所有选择，我能想到的最佳资源是：[http ://www.robotstxt.org/](http://www.robotstxt.org/)

# sqlite - 在 Qt 中使用 sqlalchemy 的原因

> ID：10677141
> 
> 赞同：4
> 
> 时间：2012-05-20T20:56:40.703
> 
> 标签：sqlite, qt, sqlalchemy, pyside

这真的是一个“原谅我的无知”的问题，如果它不符合要求，请道歉。

我想开发一个相当简单的数据库应用程序。它将基于桌面和轻量级，所以我很高兴 SQLite 就足够了。我还决定使用 Qt 和 pyside。

浏览大量的教程，我不断遇到 sqlalchemy 和 exlixir（和 Camelot）。我基本上只是想知道在 Qt 中使用 sqlalchemy（和长生不老药）相对于基本 QSql 有什么优势？如果我不使用这样的东西，我会错过什么。

我知道这是基本的，但在我开始自学过程之前，我只想在脑海中弄清楚这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T07:45:59.090

基本上，您在这里有 3 个选项。

## [QtSql](http://doc.qt-project.org/qtsql.html)

QtSql 是 Qt 中用于处理 SQL 数据库的单独模块。

优点：

*   与 Qt 集成可能更容易

缺点：

*   很难学
*   为 C++ 制作，需要一些冗余代码
*   需要在您的项目中再添加一个 Qt 模块
*   文档看起来很糟糕

## [sqlite3](http://docs.python.org/library/sqlite3.html)模块

这是 Python 标准库中的一个模块，用于处理 SQLite 数据库。

优点：

*   非常容易使用
*   代码相当简洁
*   没有外部依赖

缺点：

*   您必须编写 SQL 查询

## [SQLAlchemy](http://www.sqlalchemy.org/) ORM

SQLAlchemy 使用类似于使用普通类的数据库。

优点：

*   对象关系映射器：公开面向对象的接口并为您进行 SQL 查询
*   设置好表信息后，使用数据库是一种纯粹的乐趣

缺点：

*   陡峭的学习曲线

* * *

这是我的结论：
如果您对编写 SQL 查询感到满意并且不必对数据库做很多工作，请使用 sqlite3。如果你不介意花一些时间来学习一些很棒的东西，那就去 SQLAlchemy。

关于你提到的其他项目：
Elixir 似乎已经死了，而 SQLAlchemy 现在已经内置了它的功能，可能更好。
Camelot 很奇怪......我不会使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T04:00:01.187

我处于类似的情况......在 PyQt 学习曲线的早期，希望从事一些与数据库相关的项目。我遇到了一些听起来与您相同的线程......他们谈论 sqlalchemy、elixir 或 Project Camelot 以及 PyQt4。不过，就明确的好处而言，它们似乎都没有真正深入细节。显然，它假设好处对读者来说本质上是显而易见的；）在大多数情况下......我收集到的是，一旦你的项目达到一定程度的复杂性，你很可能或多或少无论如何，使用适用的 Qt4 对象编写了一些用于数据库处理的基本抽象，并且您将提前使用 sqlalchemy/elixir 而不是“自己动手”。

这是我在不久的将来做出的决定：我计划使用 PyQt 提供的 DB 东西完成前几个基本项目。在我对此感到满意之后，我可能会返回并使用 sqlalchemy、elixir 等进行返工。

# c# - 操作数“==”不能应用于类型（结构）的操作数

> ID：10677142
> 
> 赞同：1
> 
> 时间：2012-05-20T20:56:49.610
> 
> 标签：c#, struct, equals-operator, operands

```
public class Human
{
    public setGender Gender { get; set; }

    public void setHeight(Human Person)
    {
        if (Person.Gender == setGender.Male) // <-- This is where the error is.
        {

        }
    }
}

public struct setGender
{
    public static setGender Male { get; set; }
    public static setGender Female { get; set; }
} 
```

当我输入前面的代码时，我收到这个错误消息，

> 操作数“==”不能应用于“Life.setGender”和“Life.setGender”类型的操作数

（顺便说一下，命名空间是“Life”。这就是为什么它是 'Life.setGender'）

我曾试图查找它，但我仍然不知道那是什么意思。有人可以帮我解决错误。

我正在使用 C#。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-20T21:11:43.347

我很确定您真正想要的是：

```
public enum Gender 
{
    Male, Female
}

public class Human
{
    public Gender Gender { get; set; }

    public void setHeight(Human person)
    {
        if (person.Gender == Gender.Male)
        {

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T21:12:26.087

您必须覆盖`==`运算符。检查 MSDN 上的此链接：http: [//msdn.microsoft.com/en-us/library/dd183755.aspx](http://msdn.microsoft.com/en-us/library/dd183755.aspx)

但是，我看不到此代码可以完成什么。在这种情况下，枚举适合使用，而不是结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:11:21.757

您正在尝试访问该类的实例属性。`Person.Gender == Gender.Male`在这种情况下，您可能需要。

另请注意，您的命名有点偏离。在 C# 类型中使用`PascalCase`，属性和方法也是如此。字段和本地人使用`camelCase`.

# asp.net - 在更快的服务器上恢复数据库后，数据库性能变慢

> ID：10677143
> 
> 赞同：0
> 
> 时间：2012-05-20T20:57:05.047
> 
> 标签：asp.net, sql-server, performance

我们有一个在 Windows Server 2008 R2、IIS7、SQL Server 2008 R2 和 ASP.NET 上运行的网站。我们想升级到更快的服务器以加快我们的数据库查询。

我们已经从旧的 SQL Server 备份了我们的网站数据，并在我们的新服务器上恢复了它。出于某种原因，与旧服务器相比，新服务器上的数据库性能要慢得多。尽管如此，与旧服务器相比，新服务器的 RAM 增加了 4 倍，SSD 速度提高了 30%，CPU 速度提高了 2 倍。两台服务器的 Windows、IIS、.NET 和 SQL Server 版本完全相同。

问题是明显更快的服务器如何导致更慢的数据库性能？任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T21:16:26.330

您是否为索引配置了索引和表空间。SQL。服务器将需要一些时间来根据使用模式生成索引。您可以通过多次运行相同的查询来测试这一点。它应该加快相同的请求。我会假设速度是通过 SQL 优化达到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:44:08.500

磁盘 IO 通常是数据库中最大的瓶颈。将 db 文件和日志文件存储在同一个物理磁盘上会减慢速度。您还可以将临时数据库移动到其自己的物理驱动器/阵列。在服务器上运行 perfmon 查看平均磁盘队列长度，如果它高于 n+1 其中 n 是物理磁盘的数量，那么你有一个瓶颈

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T10:51:55.673

我们发现了问题...服务器上的“电源设置”设置为“平衡”。我们已将其设置为“高性能”，现在数据库速度更快

带来不便敬请谅解

# xcode - xcode 4 + phonegap + sencha touch ... 构建时不更新 JS？

> ID：10677158
> 
> 赞同：1
> 
> 时间：2012-05-20T20:58:38.330
> 
> 标签：xcode, cordova, sencha-touch, sencha-touch-2

[我有一个与xcode 4 + phonegap](https://stackoverflow.com/questions/6486139/xcode-4-phonegap-not-update-js-upon-build/7101636#7101636)类似的问题……在构建时不更新 JS？但包含 Sencha Touch。

问题是可以识别 html 更改，但在模拟器中运行应用程序时看不到对 javascript 文件的更改。这是上面列出的帖子中提出的建议的快速列表，其中没有一个对我有用：

*   更新并保存 .plist
*   触摸 www
*   清理项目（Command+Shift+K）
*   清理构建文件夹（Command+Shift+Option+K）

从 ios 模拟器中删除应用程序并重新启动是可行的，但这很快就会变得很麻烦。Sencha Touch 使用本地存储来处理自己的缓存。尽管它们使您能够在 app.json 中定义缓存策略，但我还没有找到可行的配置。

这是我正在使用的版本。

*   XCode - 4.3.2
*   PhoneGap - 1.6.1
*   Sencha Touch - 2.0.1 最终版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T12:41:07.793

如果我正确理解您的问题，我认为这与 HTML5 应用程序缓存有关。在这里花点时间研究一下 HTML5 应用程序缓存是如何工作[的](http://www.html5rocks.com/en/tutorials/appcache/beginner/)。

您的更改没有被反映的原因可能是因为 app.cache 文件中的哈希值没有被更改...对于您希望更改的 js 文件，请将注释中的哈希值更改为您想要的任何内容...这将确保浏览器不会从缓存中读取 HTML 和 JS 文件，而是下载新的更新版本...

当您在浏览器中重新加载页面时，打开控制台，您会了解更新过程......

希望能帮助到你...

# jquery-ui - 通过 Ajax 加载页面时 JQuery Mobile 不显示进度条

> ID：10677175
> 
> 赞同：1
> 
> 时间：2012-05-20T21:00:24.833
> 
> 标签：jquery-ui, jquery-mobile

我正在使用 JQuery Mobile 构建一个应用程序，其中我显示了一个进度条，以根据已完成的步骤向用户指示他们的进度。

对于进度条，我使用的是易于实现的 JQuery UI

```
<script>
   $(document).ready(function(){     

        var currentStep = $("#formNumber").val(); //get the the current step from form  
    var totalSteps = 8;
    var formProgress = 0;

        // determine overall form progress after step is completed  
    if (currentStep >1) {         
        formProgress = (currentStep-1)/totalSteps*100;
        }   

    // Set progress value
    $("#progressbar").progressbar({value: formProgress});
    $('#percentage').text(formProgress);

   });// End function

</script> 
```

但是，由于 JQuery Mobile 中的页面是通过 Ajax 加载的，因此不会显示进度条。我猜这是因为“#progressbar” div 是空的。

如果页面在没有 Ajax 的情况下加载，它将显示进度条。任何人都知道我可以通过允许进度条显示页面何时通过 Ajax 加载来解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:33:42.627

[绑定到 pageinit 没有 dom 准备好](http://jquerymobile.com/demos/1.1.0/docs/api/events.html)，或者在这种情况下我绑定到 pageshow。在 JQM ajax 应用程序中，dom 就绪只在第一页上发生一次。因此，任何带入 dom 的新内容都不会从您编写的代码中受益。当第二页被带入dom时也是如此。第一页没有去任何它只是隐藏的地方。因此，在每个页面中使用相同的 id 会导致问题。习惯于使用类。如果您需要从当前页面中选择某些内容，请使用 .ui-page-active 类来帮助您选择适当的元素。

类似的东西`$('.ui-page-active .formNumber')`会为您选择正确的输入。所以这是我根据你给我的信息修改的第一步。

> 索引.html

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>Step 1</title>
        <link type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/start/jquery-ui.css" rel="stylesheet" />
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
        <script type="text/javascript">
            function getProgress(){
                var currentStep = $(".ui-page-active .formNumber").val(); //get the the current step from form  
                var totalSteps = 4;
                var formProgress = 0;

                // determine overall form progress after step is completed  
                if (currentStep >1) {         
                    formProgress = (currentStep-1)/totalSteps*100;
                }
                $(".ui-page-active .progressbar").progressbar({value: formProgress});
            }

            $(document).on('pageshow',function(){
                getProgress();
            });
        </script>
    </head>
    <body>
        <div data-role="page" id="step1">

            <div data-role="header">
                <h1>Step 1</h1>
            </div><!-- /header -->

            <div data-role="content">
                <input type="hidden" class="formNumber" value="1" />
                <div class="progressbar"></div>
                <a href="step2.html" data-role="button">Step 2</a>        
            </div><!-- /content -->

        </div>

    </body>
</html> 
```

> step2.html

```
<div data-role="page" id="step2">

    <div data-role="header">
        <h1>Step 2</h1>
    </div><!-- /header -->

    <div data-role="content">
        <input type="hidden" class="formNumber" value="2" />
        <div class="progressbar"></div>
        <a href="step3.html" data-role="button">Step 3</a>        
    </div><!-- /content -->

</div> 
```

> step3.html

```
<div data-role="page" id="step3">

    <div data-role="header">
        <h1>Step 3</h1>
    </div><!-- /header -->

    <div data-role="content">
        <input type="hidden" class="formNumber" value="3" />
        <div class="progressbar"></div>         
        <a href="step4.html" data-role="button">Step 4</a>        
    </div><!-- /content -->

</div> 
```

......等等等等

如果您有兴趣，我制作了一个样品供您查看。[http://starwebservices.net/so/](http://starwebservices.net/so/)

# c# - 如何枚举给定根对象的所有可达对象？

> ID：10677176
> 
> 赞同：2
> 
> 时间：2012-05-20T21:00:34.117
> 
> 标签：c#, reflection, reference

我想实现一个接收根对象并返回一个列表的方法，该列表包含对从根对象开始可以到达的所有对象的引用。它的签名是这样的：

```
static List<object> EnumerateObjectsInRange(object root); 
```

我正在考虑使用[GetProperties()](http://msdn.microsoft.com/en-us/library/aky14axb.aspx)检索一组[PropertyInfo](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)对象，然后使用[GetValue()](http://msdn.microsoft.com/en-us/library/b05d59ty.aspx)获取这些属性的值，最后为每个值再次调用[GetProperties()](http://msdn.microsoft.com/en-us/library/aky14axb.aspx)并重复此过程，直到访问了整个对象图，但我不确定这是否是最好的方法。

有什么建议么？

**编辑：**

我可以想到*reachable*的两个定义：

1.  根对象的所有者将能够访问所有对象（公共可用对象）。
2.  根对象所属的对象图引用的所有公共和私有对象。

第一个定义足以满足我的目的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:48:03.433

您肯定需要字段，而不是属性。*对象通过字段而不是*通过属性使其他对象保持活动状态。您不需要特殊情况列表，因为它们包含一个内部数组，您可以使用 GetFields 找到该数组。但是，您需要特殊情况的数组。

顺便说一句，我已经实现了这个算法，发现它有效且有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:07:49.663

以防万一有人觉得它有用，我正在分享我从**usr**和**Henk 的**答案中编写的递归方法，它解决了我的问题：

```
static void EnumerateObjectsInRange(object root, HashSet<object> hashset)
{
    if (root == null || hashset.Contains(root))
    {
        return;
    }

    hashset.Add(root);
    FieldInfo[] fields = root.GetType().GetFields(BindingFlags.Static
                                                | BindingFlags.Instance
                                                | BindingFlags.Public
                                                | BindingFlags.NonPublic);

    foreach (FieldInfo field in fields)
    {
        object obj = field.GetValue(root);

        if (obj == null)
        {
            continue;
        }

        if (obj.GetType().IsSubclassOf(typeof(Array)))
        {
            foreach (object member in (Array)obj)
            {
                EnumerateObjectsInRange(member, hashset);
            }
        }

        EnumerateObjectsInRange(obj, hashset);
    }
} 
```

这个方法仍然需要一些重构（并且它不检查 HashSet 是否为空），但它完成了工作。

要调用它，请提供根对象和将存储访问对象的空 HashSet。

# asp.net-mvc - 使用 MVC 在数据表末尾添加自动行

> ID：10677181
> 
> 赞同：0
> 
> 时间：2012-05-20T21:02:04.533
> 
> 标签：asp.net-mvc, datatable

一旦用户在当前数据表的最后一个单元格中点击输入，我需要在数据表的末尾添加一个自动行。我是 MVC 的新手，对我们如何使用 MVC 平台做到这一点不太了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T04:55:27.253

您可以通过 javascript 或 jquery 来完成，即

```
function addRow(tableID) {

            var table = document.getElementById(tableID);

            var rowCount = table.rows.length;
            var row = table.insertRow(rowCount);

            var cell1 = row.insertCell(0);
            var element1 = document.createElement("input");
            element1.type = "checkbox";
            cell1.appendChild(element1);

            var cell2 = row.insertCell(1);
            cell2.innerHTML = rowCount + 1;

            var cell3 = row.insertCell(2);
            var element2 = document.createElement("input");
            element2.type = "text";
            cell3.appendChild(element2);

        } 
```

每当您创建新行时，请在最后一个单元格的单击事件上附加此功能，对于演示，您可以访问以下链接

[http://viralpatel.net/blogs/2009/03/dynamically-add-remove-rows-in-html-table-using-javascript.html](http://viralpatel.net/blogs/2009/03/dynamically-add-remove-rows-in-html-table-using-javascript.html)

# java - 为什么这个gif没有动画？

> ID：10677184
> 
> 赞同：2
> 
> 时间：2012-05-20T21:02:29.523
> 
> 标签：java, swing, animation

我正在为[Java Helper Library](https://github.com/kentcdodds/Java-Helper)编写一个方法来显示一个“无窗口”摆动组件（图像），它可以用作显示进度轮或其他东西的一种方式。不久前我[问过如何做到这一点](https://stackoverflow.com/questions/10018695/swing-windowless-component)，并收到了我正在使用的一个很好的答案。它工作得很好，除了**[动画 gif](http://c96265.r65.cf3.rackcdn.com/indicator_medium.gif)不是动画的。**（我没有使用图像本身，因为在您阅读此内容的整个过程中看到它可能会让您感到恶心......）它没有动画，因为它没有移动。它似乎暂停或什么的。另一个问题的答案说动画 gif 可以正常工作。答案是错的还是我执行错了？：

```
public static void main(String[] args) throws IOException, InterruptedException {
  Image image = SwingHelper.resizeImageFromResourceBy(TestClass.class, progressImageLocation, 32, true); //This just gets the image in the right size I want it.
  JWindow window = SwingHelper.getProgressWheelWindow(new ImageIcon(image), .9f, 600, 400);
  window.setVisible(true);
  Thread.sleep(3000); //Just so the image only shows up for a short period of time.
  window.setVisible(false);
  SwingHelper.centerAndPack(window); //A method to center and pack the window
}

/**
* Returns a window with a partially opaque progress Icon
*
* @param icon the icon to set in the progress window
* @param opacity a float value from 0-1
* @param x the x location of the window
* @param y the y location of the window
* @return a jWindow of the progress wheel
*/
public static JWindow getProgressWheelWindow(final Icon icon, final Float opacity, final int x, final int y) {
  JWindow jWindow = new JWindow() {

    {
      setOpacity(opacity);
      setLocation(x, y);
      setSize(icon.getIconWidth(), icon.getIconHeight());
      add(new JLabel(icon));
      pack();
    }
  };

  return jWindow;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:24:35.547

```
SwingHelper.resizeImageFromResourceBy(
    TestClass.class, progressImageLocation, 32, true); 
    //This just gets the image in the right size I want it. 
```

我对 SSCCE 的最佳猜测是辅助方法返回原始图像的**静态**（调整大小）版本。

请注意，通过在标签中使用 HTML，动画 GIF*可以*“即时”调整大小，但效果并不理想。最好设计合适尺寸的图像。

# php - 在 php 的 foreach() 中使用 try()

> ID：10677187
> 
> 赞同：-4
> 
> 时间：2012-05-20T21:02:34.077
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

我尝试在 php 中的 foreach 中使用 try() 用于 facebook 应用程序我的应用程序获得用户权限而不是在他的 3 个朋友墙上发布但问题是如果其中一个用户朋友不可发布而不是我的应用程序停止并出现以下错误是我的代码和错误请看

```
 foreach ($friends_list_array["data"] as $value) {
                                                        try
                                                                {
         // compile the post for for user
        $WallPost = array(
        'access_token' => $atoken,
            'message' => $value["name"] . ' .. message here  ',
            'link' => 'link_here');  

        // post to user wall
        $response = $facebook->api('/' . $value["id"] . '/feed','POST',$WallPost);

        echo ' posted on ' . $value["name"];

                                                                    }
    } 
```

一切正常（除了不可张贴的墙问题）没有`try()` 下面的显示错误是错误

**解析错误：语法错误，意外的 '}'，期待 T_CATCH 在**

谁能解决这个谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:15:12.003

看[这里](http://php.net/manual/en/language.exceptions.php/)

> 每一次尝试必须至少有一个对应的catch块

这就是您问题的答案（错误本身就说明了这一点，`expecting T_CATCH`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:18:08.080

如果您不需要 catch，请不要用任何逻辑填充它，工作示例：

```
foreach ($friends_list_array["data"] as $value) {
 try{
  // do stuff...
 }
 catch(Exception $e){
  // do nothing
 }
} 
```

# jquery - jQuery触发新添加的html代码

> ID：10677194
> 
> 赞同：2
> 
> 时间：2012-05-20T21:03:00.427
> 
> 标签：jquery, html, jquery-ui, autocomplete

示例我有 2 个 html 输入

```
<div class="wrap">        
   <input class="autocomplete" name="auto_1" />
   <input class="autocomplete" name="auto_2" />
</div> 
```

并且正在使用 jQuery UI 自动完成并在文档准备好时`auto_1`触发`auto_2``$(function(){})`

然后如果我们点击我网站上的一个按钮，就会有另一个按钮。按功能添加`$('.wrap').append('<input class="autocomplete" name="auto_3" />')`

现在总共将有 3 个输入

```
<div class="wrap">        
   <input class="autocomplete" name="auto_1" />
   <input class="autocomplete" name="auto_2" />
   <input class="autocomplete" name="auto_3" />
</div> 
```

但是自动完成功能没有运行，`auto_3`因为它是新添加的。

如何让它运行/使用自动完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:09:36.183

我认为问题不在于单击新输入，而在于新输入的自动完成。当您添加新元素时

```
$('.wrap').append('<input class="autocomplete" name="auto_3" />') 
```

您必须将自动完成附加到这个新字段，所以

```
$('input[name="auto_3"]').autocomplete(); 
```

或者使用 livequery 插件进行自动完成：[https ://stackoverflow.com/a/4551313/657584](https://stackoverflow.com/a/4551313/657584)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:04:55.980

使用`.on()`：[http ://api.jquery.com/on](http://api.jquery.com/on)

```
$('.wrap').on('click', '.autocomplete', function(){
    // your code here
    // $(this).autocomplete(); // or whatever.
}); 
```

使用`.on()`您将单击处理程序委托给将添加到 DOM 的现有和未来元素的方法，类似于（新）弃用（来自 jQ 1.7）`.live()`

从文档：

```
$("a.offsite").live("click", function(){ alert("Goodbye!"); });   // jQuery 1.3+
$(document).delegate("a.offsite", "click", function(){ alert("Goodbye!"); });  // jQuery 1.4.3+
$(document).on("click", "a.offsite", function(){ alert("Goodbye!"); }); // jQuery 1.7+ 
```

# ios - 对于 iOS 和 Xcode，我们可以为 UIImageView 对象创建一个 Action 吗？

> ID：10677198
> 
> 赞同：3
> 
> 时间：2012-05-20T21:03:39.460
> 
> 标签：ios, xcode, interface-builder

我们很容易为 a 创建一个 Action `UIButton`，我们只需`Ctrl`将 Interface Builder 中画布上的按钮拖到`@implementation`我们的代码部分（在 Assistant Editor 中）。

但是 a`UIImageView`呢？我想说，如果用户点击这张图片（这实际上是一个好看的图标），然后做一些事情，但是如何添加 Action，因为`Ctrl`拖动没有做任何事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T03:25:26.210

```
UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] 
                                     initWithTarget:self 
                                     action:@selector(actionHandleTapOnImageView)];
[singleTap setNumberOfTapsRequired:1];
originalImageView.userInteractionEnabled = YES;
[originalImageView addGestureRecognizer:singleTap];
[singleTap release];

-(void)actionHandleTapOnImageView
{
NSLog(@"actionHandleTapOnImageView");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T21:14:46.350

您需要在 UIImageView 的父 UIViewController 中处理 touchesBegan 消息。

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {    
    UITouch *touch = [touches anyObject];
    if ([touch view] == myImageView) {
        [self handleTapOnImageView];  // <-- Handle it!
    }
} 
```

此外，请确保 UIImageView 的“用户交互已启用”属性为 true。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:36:56.933

或者，您实际上可以使用 UIButton 并像设置 UIImageView 一样设置其图像。无需在 UIImageView 上手动编写手势处理程序。

# c++ - C++ ofstream 不会改变 mtime

> ID：10677200
> 
> 赞同：3
> 
> 时间：2012-05-20T21:04:14.593
> 
> 标签：c++, touch, fstream, ofstream

基本上我想做与系统调用 touch 相同的事情（如果文件不存在则创建文件，如果存在则更新其修改时间戳）。

```
std::string file = ...;
std::ofstream(file.c_str(), std::ios::app); 
```

如果文件不存在，这将创建文件。但它不会改变修改时间。

```
std::string file = ...;
std::ofstream(file.c_str(), std::ios::out); 
```

如果文件不存在，这将创建它，如果存在，它将更新修改时间，但如果文件存在，它也会截断文件。

那么如何触摸文件呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-03T14:04:07.497

Kerrek SB 已经发布了解决方案，但不幸的是在[评论](https://stackoverflow.com/questions/10677200/c-ofstream-doesnt-change-mtime#comment-13854978)而不是答案中（我宁愿接受他的回答）。

我在[utime(2)](http://man7.org/linux/man-pages/man2/utime.2.html)上取得了成功：

```
#include <utime.h>
...
std::string path = "/path/to/my/file";
bool success = !utime(path.c_str(), 0); 
```

David Schwartz[提到](https://stackoverflow.com/questions/10677200/c-ofstream-doesnt-change-mtime#comment-13855059) [了 utimensat](http://man7.org/linux/man-pages/man2/utimensat.2.html)的纳秒精度。

# javascript - 将可用按钮添加到 .AppendTo - Jquery

> ID：10677206
> 
> 赞同：0
> 
> 时间：2012-05-20T21:05:43.187
> 
> 标签：javascript, jquery, web

基本上我已经创建了一个覆盖并将其作为“加载屏幕”加载到 appendTo 中。

最近，我需要在叠加层中添加一个停止按钮，这不是问题，但是 jquery .click 函数没有拾取按钮单击，我尝试保留现有按钮，因此它可能会注册，但是可悲的是没有。

（我也尝试过为按钮使用 ID。

下面是一些测试代码来演示这个问题。

```
$(document).ready(function(){
    $("#addButton").click( function () {
        $overlay = $("<div id='overlay'><div id='contain'><h3 style='color:#FFF'>Processing, just a moment</h3> <div id='stop'><button type='button' class='btn btn-primary' id='stop1' >Stop</button></div><div class='bar' style='width: 80%; padding-top:50%'></div></div></div");
        $overlay.appendTo(document.body);
        $("#stop").click( function() {
            alert("working");
        });
    }); 
```

编辑：

只是为了澄清一下，这是我最初想要的，但是由于“过度更改”，上面的示例将在我的场景中工作，这是最初的问题，只是为了清楚起见。

```
 $(document).ready(function(){
        $("#addButton").click( function () {
            $overlay = $("<div id='overlay'><div id='contain'><h3 style='color:#FFF'>Processing, just a moment</h3> <div id='stop'><button type='button' class='btn btn-primary' id='stop1' >Stop</button></div><div class='bar' style='width: 80%; padding-top:50%'></div></div></div");
            $overlay.appendTo(document.body);

        });

$("#stop").click( function() {
                alert("working");
            });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:52:00.030

是的，你也可以这样做。请参阅该[方法的](http://api.jquery.com/on/)[文档`on()`](http://api.jquery.com/on/)。

```
$(document).ready(function(){
    $("#addButton").click( function () {
        $overlay = $("<div id='overlay'><div id='contain'><h3 style='color:#FFF'>Processing, just a moment</h3> <div id='stop'><button type='button' class='btn btn-primary' id='stop1' >Stop</button></div><div class='bar' style='width: 80%; padding-top:50%'></div></div></div");
        $overlay.appendTo(document.body);
    });

    $(document).on("click", "#stop", function() {
        alert("working");
    });
}); 
```

这只会向文档添加一个单击侦听器，每次单击事件从`#stop`元素冒泡时都会触发该侦听器。`stop`然而，这通常只对许多元素需要，所以当有多个这样的按钮时，你最好使用一个类“ ”。

然而，我想您将需要在第一个示例中使用的闭包来执行正确的点击操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:52:08.740

```
$(document).ready(function(){
    $("#addButton").on('click', function() {
        $overlay = $("<div id='overlay'><div id='contain'><h3 style='color:#FFF'>Processing, just a moment</h3> <div id='stop'><button type='button' class='btn btn-primary' id='stop1' >Stop</button></div><div class='bar' style='width: 80%; padding-top:50%'></div></div></div");
        $overlay.appendTo(document.body);
    });

    $(document).on('click', '#stop', function() {
        alert("working");
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T21:57:30.480

使用`.live()`以便任何新创建的内容仍将获得该`click`事件。
[http://jsfiddle.net/DerekL/2GCfD/](http://jsfiddle.net/DerekL/2GCfD/)

![在此处输入图像描述](../Images/b1d9139617f47447261ebffedd533459.png)

> 它现在正在工作。

# c++ - 使用我的 cnt 变量的链接器错误无法解析外部符号

> ID：10677211
> 
> 赞同：1
> 
> 时间：2012-05-20T21:06:41.693
> 
> 标签：c++, static, linker

我有一个静态变量的链接问题。这是我第一次尝试使用静态变量。我正在创建一个向量，并希望 cnt 变量在所有 Student 对象中都是静态的。

我四处寻找试图弄清楚这一点。我读过其他人有这个问题，他们没有声明静态变量，他们需要专门为静态变量创建一个新对象。

我认为在构造函数中声明并设置了 sCnt 变量。在类中实现静态成员变量的正确方法是什么？

学生.h

```
#pragma once
#include <iostream>

using namespace std;

class Student
{
public:
    Student();
    Student(string ID);
    virtual ~Student(void);
    void cntReset();
    int getCnt() const;
    int getID() const;
    bool operator< (const Student& s) const;
    bool operator== (const Student& s) const;

protected:
    int id;
    static int sCnt;

private:
}; 
```

学生.cpp

```
#include "Student.h"

Student::Student()
{
    id = 0;
    sCnt = 0;
}

Student::Student(string ID)
{
    id = atoi(ID.c_str());
    sCnt = 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:08:12.273

您需要定义它，恰好一次。将以下内容添加到 cpp 文件中：

```
int Student::sCnt = 0; // Note the ' = 0' is optional as statics are
                       // are zero-initialised. 
```

Assuming it is supposed to count the number of `Student` instances don't set it to `0` in the `Student` constructors, increment it and decrement in the `Student` destructor.

# php - php json解码与排序依据

> ID：10677212
> 
> 赞同：0
> 
> 时间：2012-05-20T21:07:00.457
> 
> 标签：php, sorting, json

```
function mySort($a, $b) {
 if (strtolower($a->n) == strtolower($b->n)) return 0;
 return (strtolower($a->n) < strtolower($b->n)) ? -1 : 1;
} 
```

这适用于像这样的一些 json 数据

```
$txt = '[{"n":"1"},{"n":"2"},{"n":"3"},{"n":"4"},{"n":"5"},{"n":"6"},{"n":"7"},{"n":"8"},{"n":"9"},{"n":"10"},{"n":"11"}]
$j = json_decode($txt);
usort($j, 'mySort');
foreach ($j as $k=>$v) {
    echo $v->n.'<br />';//1 2 3 4 5 6 7 8 9 10 11
} 
```

但是当一些数据是这样的：

```
$txt = '[{"n":"a 1"},{"n":"a 2"},{"n":"a 3"},{"n":"a 4"},{"n":"a 5"},{"n":"a 6"},{"n":"a 7"},{"n":"a 8"},{"n":"a 9"},{"n":"a 10"},{"n":"a 11"}]';
$j = json_decode($txt);
usort($j, 'mySort');
foreach ($j as $k=>$v) {
    echo $v->n.'<br />';//a 1  a 10  a 11  a 2  a 3  a 4  a 5  a 6  a 7  a 8  a 9
} 
```

我需要一种

```
a 1  a 2  a 3  a 4  a 5  a 6  a 7  a 8  a 9  a 10  a 11 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:19:29.513

甚至更简单，使用[strnatcmp](http://www.php.net/manual/en/function.strnatcmp.php)。它执行自然排序并以对人类来说似乎很自然的方式比较元素。

例子：

```
function mySort($a, $b) {
  return strnatcmp($a->n, $b->n);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:09:27.307

```
function mySort2($a, $b) {
    list ($k, $n) = explode (' ', $a->n);
    list ($l, $m) = explode (' ', $b->n);
    if (strtolower($n) == strtolower($m)) return 0;
    return (strtolower($n) < strtolower($m)) ? -1 : 1;
}
$txt = '[{"n":"a 1"},{"n":"a 2"},{"n":"a 3"},{"n":"a 4"},{"n":"a 5"},{"n":"a 6"},{"n":"a 7"},{"n":"a 8"},{"n":"a 9"},{"n":"a 10"},{"n":"a 11"}]';
$j = json_decode($txt);
usort($j, 'mySort2');
foreach ($j as $k=>$v) {
    echo $v->n.'<br />';//a 1  a 10  a 11  a 2  a 3  a 4  a 5  a 6  a 7  a 8  a 9
} 
```

# jax-rs - 使用@PathParam 发送身份验证数据是否合适

> ID：10677229
> 
> 赞同：1
> 
> 时间：2012-05-20T21:09:31.303
> 
> 标签：jax-rs, restful-authentication

我想知道使用@Pathparam 将参数传递给登录方法是否合适。我想在客户端中使用返回的布尔值，但到目前为止，我既不能获得 TRUE 也不能获得 FALSE，只能获得一堆 XML 标记。

```
@POST
@GET
@Path("{username}/{password}")
@Produces("text/plain")
@Consumes({"application/xml", "application/json"})
public boolean login(@PathParam("usrName")String usrName, @PathParam("pwd")String pwd){
    List<User> users= super.findAll();

    for(User u : users){
        if(u.getUserName().equals(usrName) && u.getPassword().equals(pwd)){
            return true;
        }
    }        
   return false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T11:50:34.857

当您考虑安全性而不是`do not use PathParam or QueryParam`注释时

用于`@FormParam`将值传递给服务器并`POST request`用于此

在你的代码中，我看到 GET 和 POST 两种方法都不能用于这种类型的操作

用于身份验证数据`Strictly use POST`。

# xcode - CalEvent startdate 和 enddate 与 iCal 和我的应用程序的差异

> ID：10677232
> 
> 赞同：1
> 
> 时间：2012-05-20T21:10:07.750
> 
> 标签：xcode, cocoa, nsdate, icalendar, calendar-store

如果我在 ICal 上创建一个新活动并将其设置为全天活动 - 我的应用程序显示它会持续 2 天。

我使用 nslog 输出 startdate 和 enddate，对于 2012 年 8 月 5 日的事件，我的应用程序说事件于 2012 年 9 月 5 日晚上 21 点（晚上 9 点）结束。

是什么导致了这种情况，以及将我的应用程序中的开始/结束日期转换为 iCal 上显示的相同值的最佳方法是什么。问题只存在于全天事件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T13:17:18.613

好的.. 在这里我做了一些功能，以便其他遇到同样问题的人可以很容易地得到一些帮助。

```
- (NSDate *)changeDayBy:(NSDate *)current:(NSUInteger) change
{
    NSDateComponents *components = [[[NSDateComponents alloc] init] autorelease];
    [components setDay: change];
    return [[NSCalendar currentCalendar] dateByAddingComponents:components toDate:current options:0];
}

- (BOOL) endDateNeedsAFix:(CalEvent *)event
    {
        if ( !event.isAllDay )
            return NO;

        NSDateComponents *comps1 = [[NSCalendar currentCalendar] components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:event.startDate] ;
        NSDateComponents *comps2 = [[NSCalendar currentCalendar] components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:event.endDate];

        return [[[NSCalendar currentCalendar] dateFromComponents: comps2] timeIntervalSinceDate: [[NSCalendar currentCalendar] dateFromComponents: comps1]] / ( 60*60*24) > 0 ? YES : NO;

    }

    - (NSDate*) endDateFixed:(CalEvent *)event
    {
        if ( !event.isAllDay )
            return event.endDate;

        NSDateComponents *comps1 = [[NSCalendar currentCalendar] components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:event.startDate];
        NSDateComponents *comps2 = [[NSCalendar currentCalendar] components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:event.endDate];

        if ( [[[NSCalendar currentCalendar] dateFromComponents: comps2] timeIntervalSinceDate: [[NSCalendar currentCalendar] dateFromComponents: comps1]] / ( 60*60*24) > 0 )
            return [self changeDayBy:event.endDate :-1];

        return event.endDate;
    } 
```

函数 endDateNeedsAFix 报告选定的 calEvent* 事件是否需要修复。如果应用程序有某种事件编辑器，其中显示固定结束日期，这将很有帮助，在保存更改之前，检查是否需要修复，然后使用 changeDayBy 将 +1 添加到日期。

endDateFixed 从事件的 endDate 返回 NSDate - 如果没有必要，保持不变 - 但如果需要 - 它将被修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T12:09:46.260

据此：[icalbuddy来源](http://hasseg.org/gitweb?p=icalBuddy.git;a=blob;f=icalBuddyPrettyPrint.m;h=d2803db101d759ba2b1db1dc3273e4974453399d;hb=HEAD)

```
if ([event isAllDay])
  {
      // all-day events technically span from <start day> at 00:00 to <end day+1> at 00:00 even though
      // we want them displayed as only spanning from <start day> to <end day>
      NSDate *endDateMinusOneDay = dateByAddingDays([event endDate], -1);
      NSInteger daysDiff = getDayDiff([event startDate], endDateMinusOneDay);

      if (daysDiff > 0)
      {
          elements.value = M_ATTR_STR((
              strConcat(
                  dateStr([event startDate], ONLY_DATE),
                  @" - ",
                  dateStr(endDateMinusOneDay, ONLY_DATE),
                  nil
                  )
              ));
      } 
```

它应该是那样的，我需要处理它。时间问题（21.00 / 9.00 pm）只是时区的差异，即使 - 这不重要。

# mysql - 带有 JOINED 表的 SUM 函数

> ID：10677234
> 
> 赞同：1
> 
> 时间：2012-05-20T21:10:21.087
> 
> 标签：mysql, sql

我试图确定客户使用 SQL 花费的总金额。我有两个表，客户和订单。Orders 对于每个单独的订单都有一个“Total_Payment_Received”。对于客户表上的给定 CustomerID，我想要的是要输出的所有“Total_Payment_Received”的总和。我不需要查看所有单独的订单，只需查看他们与我们完成的业务总量即可。

感谢您的任何建议！

例子：

```
SELECT Customers.CustomerID, Customers.Company_Name
      ,SUM(Orders.Total_Payment_Received)
  FROM Customers
  JOIN Orders ON Customers.CustomerID = Order.CustomerID
  WHERE Customers.LastModified BETWEEN '01/01/11 00:00:01' AND '05/15/11 11:59:59'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:24:36.807

*   您需要按客户分组。我想客户是由 (Primary Key) 识别的`CustomerID`，所以使用：`GROUP BY Customers.CustomerID`

*   对于日期，最好使用标准化的 ISO 格式`'20110515'`或`'2011-05-15'`格式，因此没有歧义。当你使用类似的东西时`'01/05/11'`，它是`01-May-2011`or`Jan-05-2011`还是`2001-May-11`or 甚至不是很清楚`1901-May-11`。我想您正在使用该`Month/Day/Year`格式，但我可能是错的。

*   它也更易于使用`<=`，`<`而不是`BETWEEN`用于日期范围检查：

    ```
    SELECT Customers.CustomerID
         , Customers.Company_Name
         , SUM(Orders.Total_Payment_Received) AS Total_Amount_of_Business
    FROM Customers
        JOIN Orders 
            ON Customers.CustomerID = Order.CustomerID
    WHERE Customers.LastModified >= '2011-01-01' 
      AND Customers.LastModified < '2011-05-16' 
    GROUP BY Customers.CustomerID ; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T21:17:31.417

一种可能的方法是：您需要使用与此类似的子查询。

```
SELECT 
    CustomerID, 
    (SELECT SUM(Total_Payment_Received) Total FROM Orders WHERE Orders.CustomerId=Customers.CustomerId) Total 
FROM Customers 
```

# xml - 使用自定义标记语言过滤 XML 数据

> ID：10677235
> 
> 赞同：3
> 
> 时间：2012-05-20T21:10:39.613
> 
> 标签：xml, xslt, xpath, xml-parsing

我正在尝试编写一个可以帮助过滤来自另一个 XML 文档的数据的文档。例如

```
<document>
    <filter>
        <what>
            <include>
                <marital_staus/>
                <ms>single</ms> <!--nog = no of groups-->
                <include>
                    <memberofgroups/>
                    <gn>Football club</gn> <!--user is a member of this club-->
                </include>
            </include>
        </what>
    </filter>

    <users>
            <user>
                <name>
                    <first>abc</first>
                    <last>xyz</last>
                </name>
                <dob>12/02/1987</dob>
                <marital_status>married</marital_status>
                <groups>
                    <member_of_group>Chess Club</member_of_group>
                    <member_of_group>Football club</member_of_group>
                </groups>
            </user>

            <user>
                <name>
                    <first>aaa</first>
                    <last>bbb</last>
                </name>
                <dob>14/03/1987</dob>
                <marital_status>single</marital_status>
                <groups>
                    <member_of_group>Chess Club</member_of_group>
                    <member_of_group>Football club</member_of_group>
                </groups>
            </user>

             <user>
                <name>
                    <first>fff</first>
                    <last>nnn</last>
                </name>
                <dob>12/6/1983</dob>
                <marital_status>single</marital_status>
                <groups>
                    <member_of_group>Chess Club</member_of_group>
                    <member_of_group>Cultural Association</member_of_group>
                </groups>
            </user>
     </users>
</document> 
```

我希望这段代码首先选择是 Football club 成员的用户，然后从这些用户中选择单身用户。但我不知道如何为此编写样式表。我写了这个：

```
<xsl:template name="temp">
        <xsl:param name="a1"/>
        <xsl:param name="pro"/>
        <xsl:choose>
            <xsl:when test="$pro = 'marital_status'">
                <xsl:for-each select="/document/users/user">
                    <xsl:if test="marital_status=$a1">
                        <xsl:value-of select="."/>
                    </xsl:if>                
                </xsl:for-each>
            </xsl:when>
            <xsl:when test="$pro = 'memberofgroups'">
            <xsl:for-each select="/document/users/user">
                <xsl:for-each select="./groups/member_of_group">
                    <xsl:if test=".=$a1">
                        <xsl:value-of select="."/>
                    </xsl:if>
                </xsl:for-each>
            </xsl:for-each>
        </xsl:when>
        </xsl:choose>
    </xsl:template>
<xsl:template match="include">
        <xsl:call-template name="temp">
            <xsl:with-param name="a1">
                <xsl:apply-templates select="*[2]"/>
            </xsl:with-param>
        </xsl:call-template>
    </xsl:template> 
```

在调用模板时，我传递了我认为的正确值。

问题是我得到了所有单身用户，以及属于该特定组的所有用户。但是，我想要同时也是足球俱乐部成员的单身用户。我不希望样式表被硬编码，因为我还想根据其他元素进行过滤。

我不知道如何将过滤后的元素保存到可以用作下一个 XPath 表达式的输入的东西中。或者我在编写过滤文档的约束时犯了一些错误。或者还有其他更合适的方式来编写过滤文档吗？我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:31:22.923

利用：

```
 /*/*/user
     [*[name() = name(/*/filter/*/include/*[1])]
     =
      /*/filter/*/include/*[2]
     and
      groups/*[name() = name(/*/filter/*/include/include/*[1])]
     =
      /*/filter/*/include/include/*[2]
     ] 
```

**基于 XSLT 的验证：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
     <xsl:copy-of select=
      "/*/*/user
         [*[name() = name(/*/filter/*/include/*[1])]
         =
          /*/filter/*/include/*[2]
         and
          groups/*[name() = name(/*/filter/*/include/include/*[1])]
         =
          /*/filter/*/include/include/*[2]
         ]
"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当对提供的 XML 文档应用此转换时**（已更正了一些拼写错误）：

```
<document>
    <filter>
        <what>
            <include>
                <marital_status/>
                <ms>single</ms>
                <!--nog = no of groups-->
                <include>
                    <member_of_group/>
                    <gn>Football club</gn>
                    <!--user is a member of this club-->
                </include>
            </include>
        </what>
    </filter>
    <users>
        <user>
            <name>
                <first>abc</first>
                <last>xyz</last>
            </name>
            <dob>12/02/1987</dob>
            <marital_status>married</marital_status>
            <groups>
                <member_of_group>Chess Club</member_of_group>
                <member_of_group>Football club</member_of_group>
            </groups>
        </user>
        <user>
            <name>
                <first>aaa</first>
                <last>bbb</last>
            </name>
            <dob>14/03/1987</dob>
            <marital_status>single</marital_status>
            <groups>
                <member_of_group>Chess Club</member_of_group>
                <member_of_group>Football club</member_of_group>
            </groups>
        </user>
        <user>
            <name>
                <first>fff</first>
                <last>nnn</last>
            </name>
            <dob>12/6/1983</dob>
            <marital_status>single</marital_status>
            <groups>
                <member_of_group>Chess Club</member_of_group>
                <member_of_group>Cultural Association</member_of_group>
            </groups>
        </user>
    </users>
</document> 
```

**对上面的 XPath 表达式求值，并将选定的节点（在本例中只是一个节点）复制到输出**：

```
<user>
   <name>
      <first>aaa</first>
      <last>bbb</last>
   </name>
   <dob>14/03/1987</dob>
   <marital_status>single</marital_status>
   <groups>
      <member_of_group>Chess Club</member_of_group>
      <member_of_group>Football club</member_of_group>
   </groups>
</user> 
```

# javascript - 为什么这些 javascript 变量共享范围？

> ID：10677236
> 
> 赞同：0
> 
> 时间：2012-05-20T21:10:53.077
> 
> 标签：javascript, scope

由于涉及两个单独的函数，即即使变量都使用它，变量也不应该在不同的范围内`_GetFoo`吗`_CountBar`？`bar`如果您复制粘贴它然后运行它，它将显示两个警报的问题。

```
<script type="text/javascript">
 var example = function () {

    var Foo = [];

    function _BuildFoo(size) {
        for (var buildSize = 0; buildSize < size; buildSize++) {
            Foo.push(buildSize);
        }
    }

    function _GetFoo(index) {
        for (bar in Foo) {
            //do Foo bar
        }
    }

    function _CountBar() {
        for (bar in Foo) {
         alert(bar); //bar = 0
         _GetFoo(1);
         alert(bar); //bar is incremented from _GetFoo function and is now 19
         break;
        }
    }

    return {
        _CountBar: _CountBar,
        _BuildFoo: _BuildFoo
    }
}

var foobar = new example();
foobar._BuildFoo(20);
foobar._CountBar();
</script> 
```

为什么要共享范围`_GetFoo`？`_CountBar`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:12:58.770

没有关键字`var`,`bar`成为全局变量。你需要：

```
for (var bar in Foo) { 
```

或者，

```
var bar;
for (bar in Foo) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:12:58.083

他们都共享`example`，因为他们都在一个函数中。

此外，`bar`没有声明，JavaScript 将假定它是`global`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T21:18:29.420

不， bar 未在函数范围内声明为局部变量。

但还有更糟糕的事情：永远不要对数组使用 for-in-loops！

```
var foo = [];
for (var i=0; i<foo.length; i++)
    // do something with foo[i] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T21:20:44.500

只是为了扩展其他答案，有两种方法可以避免通过函数创建全局变量：

*   使用`var`关键字，例如`var foo`
*   在函数参数中创建变量，例如`function myFunc(foo)`

# c++ - 对于指向同一基类的其他类的指针，C++11 非静态数据成员统一初始化失败

> ID：10677237
> 
> 赞同：5
> 
> 时间：2012-05-20T21:10:53.303
> 
> 标签：c++, c++11

我是一个老 C-dude，试图通过将我的旧状态机框架从 C 移植到 C++11 来了解 C++11。我的想法是为状态机本身创建一个类，然后为其中的状态嵌套类。状态可以是分层的，即超状态和子状态。框架需要知道一个状态的超状态，为此我`state *superstate`在嵌套状态类中有一个指针 ( )。

我的问题是我打算通过直接在机器类中使用构造函数来设置超状态指针，这应该可以在 C++11 中使用非静态数据成员初始化，通过使用统一初始化。`substateB3{superstateA}`但是由于某种原因，当设置为另一种类型的状态/类时，它无法编译 ( )。但是，如果我稍后为此目的使用特定函数 ( `set_superstate`) 来设置它，它就可以正常工作，它与构造函数具有相同的参数！有趣的是，如果我将超状态设置为相同类型的状态/类（`substateB2{substateB1}`），则接受构造函数。

我正在使用 gcc 4.7.0（以获得对非静态数据成员初始化程序的支持），这是我的代码：

```
// My state-machine framework (simplified)
struct machine {
  struct state {
    state()                  : superstate(nullptr) { }     // No superstate => toplevel state!
    state(state &superstate) : superstate(&superstate) { }
    state *superstate;
    void set_superstate(state &superstate) { this->superstate = &superstate; } // Non-ctor way to set superstate
  };
};

// An example of a specific state-machine using my framework
struct Machine : machine {
  struct SuperstateA : state {
  } superstateA;

  struct SubstateB : state {
  } substateB1,              // Compiles OK; gets its superstate set in Machine's ctor below
    substateB2{substateB1},  // Compiles OK; but not correct superstate
    substateB3{superstateA}; // gcc 4.7.0 error: could not convert ‘{((Machine*)this)->Machine::superstateA}’ from ‘&lt;brace-enclosed initializer list>’ to ‘Machine::SubstateB’

  Machine()  { substateB1.set_superstate(superstateA); } // Compiles OK;
} myMachine; 
```

非常感谢任何提示或指导，谢谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T23:04:45.393

剥离一层继承：

```
struct m {
    struct state { state *s;
        state() : s(0) {};
        state(state &s) : s(&s) {}
        set(state &s) { this->s = &s; }
    };

    struct s1 : state {} A;   // calls s1(), the default constructor
    struct s2 : state {}    B     // calls s2(), ditto
    ,                       C{B}  // calls s2(const s2&), the default copy constructor
    ,                       D{A}; // calls s2(const s1&)

    m() { B.set(A); } // The m() body runs after all the members are constructed.
} M; 
```

您收到构造错误是因为您的子状态没有声明构造函数，因此它们获得了编译器提供的默认值，并且没有来自同级或基类引用（编译器不提供`s2(s1&)`or `s2(state&)`）。

你得到了错误的超状态，`C`因为`C{B}`调用了默认的复制构造函数`s2(s2&)`，它在`m()`的主体之前运行。

这就是你想要的：

```
struct m {
    struct state { state *s; state() : s(0) {} state(state &s) : s(&s) {} };
    struct s1 : state {} A; // default-constructs, fine
    struct s2 : state {
        s2(state &s) : state(s) {}
        s2(s2&s)     : state(s) {}
    }            B     // default-constructs
    ,            C{B}  // calls s2(s2&), invokes state(state&)
    ,            D{A}; // calls s2(state&)
    ;
    m() : B(A) {};
} M; 
```

当 M 的构造函数运行时，首先是它的基类（没有基类），然后它的成员使用指定的初始化按声明顺序构造。只有一个: `B(A)`，所以其余的都是默认的。在构造完所有基和成员之后，对象构造函数的主体就会运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T22:39:22.730

```
 struct SuperstateA : state {
  } superstateA;

  struct SubstateB : state {
  } substateB1, 
    substateB3{superstateA}; 
```

和之间没有任何关系`SuperstateA`，`SubstateB`这将允许在它们之间进行投射或切片。即使`SuperstateA`是基类（通常与“超级”相关联），`SubstateB`仍然会有更多成员（作为子类），并且不可能从不同类型的对象中全部初始化它们。

这不是编译器中的错误，也不是 C++ 的任意限制。根本不可能执行这种初始化。需要有一个“is-a”的关系。

另一方面，`superstateA`and`substateB1`都可以转换为`state &`（或者它们的指针可以转换为`state *`），因此提供`SubstateB::SubstateB( state & )`会很好地修补所有漏洞。

# php - 在 MySQL 表行中求和值的有效方法

> ID：10677242
> 
> 赞同：1
> 
> 时间：2012-05-20T21:11:31.437
> 
> 标签：php, mysql

我有一个看起来像这样的 MySQL 表：

```
+--------------------------------------+
|   id   |    product_id   |   qty     |
+--------------------------------------+
|    1   |        0        |    1      |
|    2   |        1        |    3      |
|    3   |        0        |    2      |
|    4   |        2        |    18     |
+--------------------------------------+ 
```

我想获取表中每种产品的总数。因此，例如，对于上表，这是我想要的结果：

0 -> 3
1 -> 3
2 -> 18

我认为最简单的方法是遍历 MySQL 结果并将每个产品的数量添加到数组中，在数组中与 product_id 对应的位置。IE：

```
$qtyArray = array();

while($row = mysql_fetch_array($result, MYSQL_ASSOC)) 
{
    $qtyArray[$row[product_id]] += $row[qty];
} 
```

我有两个问题：

1.  上述工作可以吗？
2.  有没有更好的方法来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-20T21:16:40.403

MySQL 为您执行此操作：

```
SELECT product_id, sum(qty)
FROM tablename
GROUP BY product_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:18:10.777

至于第一个问题。它会起作用，但会发出通知“未定义的偏移量”

还要记住，数组索引必须是一个字符串，所以

```
$qtyArray[$row['product_id']] += $row['qty']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:18:37.393

如前所述 - 你最好使用组查询，因为这样更有效。

然而：

```
$qtyArray[$row[product_id]] += $row[qty]; 
```

除非已经设置了变量，否则这将触发通知。那是因为它相当于：

```
$qtyArray[$row[product_id]] = 
    $qtyArray[$row[product_id]] + // First time around this won't exist
    $row[qty]; 
```

如果（在其他情况下）您需要做类似的事情 - 如果有任何疑问，请检查数组键是否存在。

# ruby-on-rails - Rails 关系建模 - 快速 q。- “我这样做对吗？”

> ID：10677243
> 
> 赞同：1
> 
> 时间：2012-05-20T21:11:33.903
> 
> 标签：ruby-on-rails, rails-activerecord, data-modeling, modeling

我正在开发一个寻宝游戏应用程序，我只想知道我是否正确建模。有一个用户可以继续进行的狩猎列表。这些搜寻是可以自定义的模板（例如添加/删除某些任务）。

当用户选择去打猎时，我称之为“旅行”。我已经阅读了关于 Associates 的 Rails 指南，我认为我应该将旅行模型设置为用户和狩猎之间的连接表。这就是我的想法。

```
 class Users 
      has_many :trips
      has_many :hunts, :through => :trips

    class Hunts
      has_one :trip
      has_many :users, :through => : trips

    class Trip
      belongs_to :users
      belongs_to :hunts 
```

然后我设置 Trip 表的迁移将如下所示。

```
 def change
      trip_name
      user_id
      hunt_id
    end 
```

我有两个问题。

1.  这看起来对吗？
2.  有没有更聪明（或更优雅）的方法来做到这一点？

更新：这就是我最终做的事情。

```
 class Users 
      has_many :trips
      has_many :hunts, :through => trips

    class Hunts
      has_one :trip
      has_many :users, :through => trips

    class Trip
      belongs_to :hunts
      belongs_to :users 
```

进而

```
 def change
      create_table :trips do |t|
        t.string :trip_name
        t.references :user
        t.references :hunt
      end
      add_index :trips, :hunt_id
      add_index :trips, :user_id
      add_index :trips, [:hunt_id, :user_id], :unique => true
    end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:29:26.223

我看到一些小问题：

1.  模型习惯上是单一的：改变`Users`，`Hunts`除非你有一个不寻常的情况。
2.  `Hunt`大概是吧`has_many :trips`？
3.  您的迁移非常稀少。该`change`方法通常看起来像这样：

.

```
def change
  create_table :trips do |t|
    t.string :trip_name
    t.references :user
    t.references :hunt
  end
end 
```

从结构上讲，你所拥有的对我来说是有意义的。

旁白：我组织了有时被称为寻宝游戏的[冒险](http://events.chromatin.ca)活动，我很高兴我不是唯一一个做这些事情的程序员！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:34:52.993

您正在使关联变得复杂。因为 Hunts : Trip = 1 : 1，你不需要它们都与用户相关联，例如

```
class Users 
  has_many :hunts
  has_many :trips, :through => hunts

class Hunts
  has_one :trip
  has_many :users

class Trip
  belongs_to :hunt  # belongs to singular word. :) 
```

然后，创建一个表“users_hunts”，如下所示：

```
# users_hunts table, has 3 columns:
id
user_id
hunt_id 
```

和trips表看起来像：

```
# trip table , has 1 extra column: 
id 
hunt_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:40:27.170

我会去

```
class Users 
  has_many :trips
  has_many :hunts, :through => trips

class Hunts
  has_one :trip
  has_many :users, :through => trips

class Trip
  belongs_to :hunts
  belongs_to :users 
```

即使您还不需要这两种方式的关系，它也更容易理解（恕我直言）并且它是为未来而设置的，允许用户进行多次狩猎和狩猎以获得许多用户，这似乎非常可行。

# android - 如何让两个手机应用程序通信

> ID：10677247
> 
> 赞同：2
> 
> 时间：2012-05-20T21:12:15.890
> 
> 标签：android, iphone, location, status

我是电话开发的新手，出现了这个问题：

假设我有两个（或更多）人站在一个房间里，每个人都使用相同型号的手机。如果他们正在运行我的应用程序，这些应用程序/电话将如何相互通信和更新。例如，如果每部手机都在向应用程序的其他用户传输位置信息。android 是否有内置客户端/服务器功能？

如果这有点宽泛，我很抱歉，但正如我所说，我对此并不陌生，只是想了解正在发生的事情。

该应用程序本身是一个“派对”应用程序，房间里的人能够更新他们的状态，然后将其广播给房间里的其他人。

感谢您的回复。我认为我们将改变模型，但最好有一些关于在哪里看/研究什么的想法。谢谢。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T19:17:51.103

你想看看GameKit。有对等协议和客户端/服务器协议。它们很容易实现，并且有示例代码。查看以下信息：http: [//developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/GameKit_Guide/GameKitConcepts/GameKitConcepts.html](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/GameKit_Guide/GameKitConcepts/GameKitConcepts.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T21:15:43.557

**考虑到手机在同一个房间里，即使有不同的型号，甚至在 iOS 和 Android 之间，**蓝牙也可以工作。****

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T21:48:53.900

您可以研究发布/订阅中心的概念。当然，这不是两个设备之间的直接通信，因为它们之间有一个消息代理。

现在只想到其中两个：Redis.io 和 Pubsub.io（也有一个叫做 pubsubhububub 或类似的东西）

但是，选择通信媒介是一个完全不同的问题，这实际上高度依赖于您的应用程序及其上下文。BT、WiFi、GSM、NFC等都不错！它们各有优缺点，你应该为你的应用选择最好的。**

# javascript - 如何获取在 Javascript 中添加的 ASP 列表框控件的值

> ID：10677248
> 
> 赞同：0
> 
> 时间：2012-05-20T21:12:17.967
> 
> 标签：javascript, asp.net

我有一个 asp.net lisbox 控件，我正在使用此代码从客户端 javascript 添加数据；

```
function selectCompany() {
   var str = document.getElementById('<%= txtFollowing.ClientID %>').value;
   var lbRef = document.getElementById('<%= lbCompanies.ClientID %>');
   var option = document.createElement("option");
   option.text = str;
   option.value = str;
   lbRef.options.add(option);
} 
```

项目添加没有问题，但是在后面的代码中，当我想获取列表框中项目的值时，它总是为空，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T21:20:25.527

因为您将项目动态添加到控件中，所以它不是视图状态树的一部分；您将需要使用 Request.Form 集合访问这些项目

```
Request.Form("Your_Listbox_ID") 
```

如果您不知道“Your_Listbox_ID”，请设置断点并在 Request.Form 上进行快速观察，快速查看其键名。

或者，您可以考虑将隐藏字段添加到页面并将选定值（或所有值）写入隐藏字段并从代码隐藏中读取隐藏字段。

# mysql - 用于字典、邮政编码等的数据库

> ID：10677250
> 
> 赞同：4
> 
> 时间：2012-05-20T21:12:31.750
> 
> 标签：mysql, database, open-source

我在哪里可以找到/获取诸如字典、州列表、邮政编码、城市等的数据库？最好是开源或免费的，并且适用于 MySQL，但使用 PHP 从另一个 db 或 XML 转换为 MySQL 将是一个有趣的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:12:57.780

网上有很多地方可以找到有趣的数据：[世界银行](http://data.worldbank.org/)发布了大量数据，您可以免费下载和使用。您还可以通过服务[DBpedia](http://dbpedia.org/About)从维基百科中提取一些结构化数据。如果您想使用来自企业或政府机构的更具体的数据（您的政府去年花了多少钱？犯罪活动在哪里？）请查看[数据中心的](http://thedatahub.org/)开放知识基础数据存储库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T21:27:50.373

尝试[自由基](http://www.freebase.com/)。

也可通过 Amazon EC2“公共数据集”功能获得。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:34:34.800

我们经常使用[http://www.geonames.org/](http://www.geonames.org/)的数据 论坛上有一个很好的教程来学习如何将日期导入 MySQL 数据库：http: [//forum.geonames.org/gforum/posts/列表/732.page](http://forum.geonames.org/gforum/posts/list/732.page)

他们也有一个网络服务：[http ://www.geonames.org/export/web-services.html](http://www.geonames.org/export/web-services.html)

如果数据集不够，还有很多开放的 API：

[http://www.programmableweb.com/apitag/?q=zip%20codes](http://www.programmableweb.com/apitag/?q=zip%20codes)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T01:57:28.160

就个人而言，我喜欢[http://snipplr.com](http://snipplr.com)。只需搜索`mysql countries`（用您想要的任何完整的 mysql 格式的数据库替换国家/地区），您就很有可能找到所需的内容。

我在那里找不到字典，所以我建议对[http://www.ibiblio.org/webster/](http://www.ibiblio.org/webster/)的数据库进行 XML 到 SQL 的转换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-27T02:00:57.140

[http://www.data.gov/](http://www.data.gov/)上有很多好东西，尽管其中大部分可能需要转换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T21:38:16.993

获取此类信息的最简单和最准确的方法是从[http://www.openstreetmap.org/中提取它](http://www.openstreetmap.org/)

# java - 如何在android中注册SmsManager

> ID：10677251
> 
> 赞同：0
> 
> 时间：2012-05-20T21:12:43.637
> 
> 标签：java, android, sms

我想写一个发送消息的应用程序。
我如何告诉 Android 操作系统，当用户要求发送消息 (sms) 时，给他我的应用程序作为替代？
我知道 viber 和 whatsapp 会做这样的事情。我没有找到文档。可能我错过了一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:27:45.810

您是否已将 SMS 发送到意图过滤器添加到清单中？

```
 <intent-filter>
    <category android:name="android.intent.category.DEFAULT"/>
    <action android:name="android.intent.action.SENDTO"/>
    <data android:scheme="smsto"/>
    <data android:scheme="sms"/>
 </intent-filter> 
```

# ruby - 安装未发布的 gem 会导致“没有要加载的文件”

> ID：10677256
> 
> 赞同：0
> 
> 时间：2012-05-20T21:13:30.953
> 
> 标签：ruby, rubygems, bundler, irb

我正在构建一个本地宝石，我希望能够测试并在撬动中使用它。我正在通过`bundle gem blah`.

*   `gem list`显示宝石。
*   `gem contents blah`确认它安装在我的 GEMPATH 中的某个位置。
*   `gem "blah", :path => "path/to/gem"`使其在 rails 控制台中可用。

但是当我简单地尝试并要求它时，它的内部`require "file"`代码似乎不起作用。我开始了一个具有以下结构的示例 gem：

```
├── Gemfile
├── LICENSE
├── README.md
├── Rakefile
├── blah.gemspec
├── lib
│   ├── blah
│   │   ├── ugh.rb
│   │   └── version.rb
│   └── blah.rb
└── pkg
    └── blah-0.0.1.gem 
```

/lib/blah.rb 以以下开头：

```
require "blah/version"
require "blah/ugh" 
```

当我尝试在 pry、IRB 或 via 中加载它时`ruby -rubygems -e 'require "blah"'`，我得到：

```
~/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:55:in `require': cannot load such file -- blah/ugh (LoadError) 
```

任何想法可能导致这种差异？我觉得我正在按照 Bundler 和其他 gem 建立的做法按顺序做事，但也许我在某个地方出错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:01:36.497

请尝试在直接运行 ruby​​ 时指定加载路径。这可确保您在 gem 中相对需要的所有文件也能找到。

因此，当在 rails 根目录中调用 ruby​​ 时，它应该是

`ruby -rubygems -Ilib -e 'require "blah"'`

或在撬的情况下

`pry -I lib ...`

希望有帮助。

# ruby - Ruby：检查别名之前是否定义了方法

> ID：10677259
> 
> 赞同：5
> 
> 时间：2012-05-20T21:14:20.070
> 
> 标签：ruby

```
类测试

  def my_print
    p“打印一些东西”
  结尾
结尾

类测试

  别名方法 :old_print, :my_print
  def my_print
    old_print
    p“再打印一些”
  结尾
结尾

```

我原来的测试类在顶部。然后我决定添加更多内容，但我决定使用别名。

但这假设 my_print 已经定义。是否有一种简短的方法来检查我正在使用别名的方法是否已经定义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:18:44.397

关于什么

```
if Test.method_defined? :my_print
    alias_method :old_print, :my_print
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T21:21:38.950

由于“my_print”不是类方法，而是实例方法，您应该：

```
if Mod.instance_methods.include? "my_print"
  alias_method :old_print, :my_print
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-26T00:35:48.707

`if method(:my_print) alias_method :old_print, :my_print end`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-11T17:12:23.797

## 使用`defined?`方法。

您可以使用该`defined?`方法查看是否已在当前上下文/范围内定义了方法：

```
alias_method( :old_print, :my_print ) if defined?( my_print ) 
```

# symfony - Symfony2 和 Doctrine2 - 记录更改的历史

> ID：10677261
> 
> 赞同：3
> 
> 时间：2012-05-20T21:14:35.460
> 
> 标签：symfony, doctrine-orm

我需要保留 Profile 更改的数据库历史记录。除了配置文件数据，我必须保存时间戳和 user_id。查询创建新的历史记录很简单：

```
INSERT INTO history_profile 
SELECT NULL, CURRENT_TIMESTAMP(), p.* FROM profile p WHERE p.profile_id=? 
```

这个查询放在哪里？我不能使用触发器。我有几个想法：

1.  在控制器中调用提交表单

    ```
    $em = $this->getEntityManager();
    $conn = $em->getConnection();
    if (!is_null($profile->getProfileId()))
    {
        $conn->executeQuery('INSERT INTO history_profile SELECT NULL, CURRENT_TIMESTAMP(), p.* FROM profile p WHERE p.profile_id=?', array($profile->getProfileId()));
    }
    $em->persist($profile);
    $em->flush(); 
    ```

    但是即使配置文件没有更新，每次提交都会执行此查询。

2.  在实体中，作为 preUpdate 的事件监听器

    ```
    class Profile {
        /**
         * @ORM\preUpdate
         * @ORM\prePersist
         */
        public function onPrePersist()
        {
        }
    } 
    ```

    但我不知道如何获取教义的连接对象

**编辑 - EntityAudit 试用**

这个捆绑包看起来很有希望，但我无法配置它。我正确安装了它，当我添加到 config.yml 时：

```
simple_things_entity_audit:
    audited_entities:
        - AldenXyzBundle\Entity\Profile 
```

然后查看查询

```
php ./app/console doctrine:schema:update --dump-sql 
```

但只有 SQL 用于创建表修订：

```
CREATE TABLE revisions (id INT AUTO_INCREMENT NOT NULL, 
timestamp DATETIME NOT NULL, username VARCHAR(255) NOT NULL, 
PRIMARY KEY(id)) ENGINE = InnoDB 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T10:52:19.183

您可以使用[EntityAudit](https://github.com/simplethings/EntityAudit#entityaudit-extension-for-doctrine2)包对您的实体进行版本控制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:45:36.330

Doctrine2 有一个日期时间字段类型。看看[学说的日期时间示例](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/cookbook/working-with-datetime.html)。但是，如果可能，您可能需要考虑让数据库通过其时间戳机制或触发器来处理 createdOn 和/或 modifiedOn。此外，sql 不应进入您的实体。如果您需要自定义 sql，它应该放在您的自定义实体存储库中。

我不确定您是在寻找“createdOn”时间戳还是“updatedOn”时间戳，或者两者兼而有之。[Doctrine 的版本控制](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/transactions-and-concurrency.html)（第 9.2.1 节）可以被认为并用作“updatedOn”日期时间字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:07:37.347

最后我没有使用这个捆绑包。在带有数据的 POST 表单和刷新 EntityManager 之后的控制器中，我添加了直接在数据库中复制记录的功能（在途中添加一些修订信息）。但是我使用了带有不同表的想法来获取捆绑包中的修订信息。

# java - 复选框 itext - 如何

> ID：10677267
> 
> 赞同：2
> 
> 时间：2012-05-20T21:15:14.807
> 
> 标签：java, itext

我用 iText 制作了一个 pdf，目前我将一个布尔字段显示为文本，说明真假。现在我正在考虑将此可视化更改为复选框。假 -> 未选中/真 -> 选中。如果可以的话当然可以。

我试图用谷歌搜索它，但我得到了使用 itext 等的活动复选框的结果。我只需要在我创建的 pdf 文档中可视化一个布尔字段

目前我只是使用：

```
...
Phrase validation = new Phrase();
        validation.add(new Chunk(" Approved =  "
                + documentName.getApproved(), BOLD));
...

document.add(validation); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T11:30:52.700

看看这个例子：[填写交互式表格](http://itextpdf.com/examples/iia.php?id=154)。

它显示了如何创建表单并填写一些字段，其中包括一些复选框。

* * *

**编辑**：

然后您可以展平表单，使这些复选框不再具有交互性：[Form flattening](http://itextpdf.com/examples/iia.php?id=122)

另一种方法是根据布尔值插入一个符号。如果布尔值为假，则插入一个[空框](http://www.fileformat.info/info/unicode/char/2610/index.htm)，如果为真，则插入一个[标记/勾选/选中的框](http://www.fileformat.info/info/unicode/char/2611/index.htm)。

# objective-c - 在 Xcode 上显示图像

> ID：10677270
> 
> 赞同：0
> 
> 时间：2012-05-20T21:15:32.823
> 
> 标签：objective-c, xcode

我是xcode的初学者，我想制作一个有一些按钮的项目，当我触摸按钮时，一个方法会显示图像，但它不起作用。

```
- (IBAction)button01:(id)sender 
{
    CGRect frame;

    frame.origin.x = 0;
    frame.origin.y = 0;
    frame.size = CGSizeMake(580, 325);

    UIImage *image = [UIImage imageNamed:@"lightBox.png"];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    imageView.frame = frame;
} 
```

有人可以帮助我吗？！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:20:45.223

尝试这样做：

```
- (IBAction)button01:(id)sender 
{
    CGRect frame;

    frame.origin.x = 0;
    frame.origin.y = 0;
    frame.size = CGSizeMake(580, 325);

    UIImage *image = [UIImage imageNamed:@"lightBox.png"];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:background];
    [self.view addSubview:imageView];
    bgView.frame = frame;
} 
```

我将它添加为子视图，所以它会出现。

# javascript - MVC 模式中的“样式化”代码在哪里？

> ID：10677271
> 
> 赞同：0
> 
> 时间：2012-05-20T21:15:42.230
> 
> 标签：javascript, model-view-controller

**B2：**

请不要使用下面的片段来设置样式以响应用户操作而改变 -> 即模糊、焦点、按键。

它是自包含的……只需给它一个元素 id 数组，它就会设置样式以在某些事件上更改。

我应该将它放在模型、视图或控制器中的哪个模块？

```
function styleTwitter1( pair_array )
{
    var i;
    var input;
    var label;
    for ( i = 0; i < pair_array.length; i+=2 ) 
    {
        input = document.getElementById( pair_array[ i ] );
        label = document.getElementById( pair_array[ i + 1 ] );
        label.style.fontSize = window.getComputedStyle( label, null ).getPropertyValue("font-size");
        closureBuster( input, label );
    }
    function closureBuster( input, label )
    {
        input.addEventListener( "keypress", function()
        { 
            label.style.opacity = 0; 
        }, false );
        input.addEventListener( "focus", function()
        { 
            if( input.value === '' )
            {
                label.style.opacity = 0.2; 
                input.style.border = '1px solid #888888'; 
            }
        } , false );
        input.addEventListener( "blur", function()
        {
            if( input.value === '' )
            {
                label.style.opacity = 1;
                new EffectsFont( label ).fade( 'up', 150 );
                input.style.border = '1px solid #dddddd'; 
            }   
        } , false );
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:01:04.680

在 MVC 中，**视图**：

> [观察状态并生成输出给用户](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

因此，用户看到的所有内容（渲染、样式、...）并与之交互，都应该转到视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T04:44:46.747

**视图**向用户显示所有输出，因此与可见性相关的任何内容都将在视图中处理。因此，为了获得最佳性能和结果，您应该遵循以下步骤

> 将您的 java 脚本函数放在一个单独的 js 文件中，在要调用所需函数并将元素数组作为参数传递的每个页面（块中）的顶部写一个 $(document).ready() 函数

这样，您的代码将整洁、可重用和可读

# mysql - 替换 MySQL 中多个表和字段中的文本

> ID：10677274
> 
> 赞同：1
> 
> 时间：2012-05-20T21:15:57.090
> 
> 标签：mysql, replace, field

我正在尝试替换多个表和字段中的特定文本字符串。我有代码可以为一张表中的一个字段执行此操作，但我不想重复我的工作（因为我有很多要替换的字符串）。

这是我在一张表中的一个字段的代码：

```
UPDATE `phpbb3`.`phpbb_posts`
SET `post_subject` = REPLACE(`post_subject`,'string-to-be-replaced','replacement-string')
WHERE ( `post_subject` LIKE '%string-to-be-replaced%' )
ORDER BY `phpbb_posts`.`post_time` DESC 
```

如何编写命令来替换 phpbb_posts.post_subject 字段和 phpbb_topics.topic_title 字段中的文本？

（我是否需要 WHERE 或 ORDER，因为 phpMyAdmin 无论如何都不会显示 UPDATE 的结果？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:30:19.923

您不能在一个语句中更新多个表，但是，您可以使用 a`transaction`来确保将两个`UPDATE`语句一起处理。您还可以对它们进行批处理以避免往返。

```
BEGIN TRANSACTION
UPDATE phpbb_posts
SET post_subject = REPLACE(`post_subject`,'string-to-be-replaced','replacement-string')
WHERE ( `post_subject` LIKE '%string-to-be-replaced%' )
ORDER BY `phpbb_posts`.`post_time` DESC

UPDATE phpbb_topics
SET .topic_title = <something>
WHERE <column> = <something>

COMMIT 
```

# jquery - 使用 jquery 调用 JAX-RS

> ID：10677275
> 
> 赞同：0
> 
> 时间：2012-05-20T21:15:58.307
> 
> 标签：jquery, json, jax-rs

我正在使用 JAX-RS 构建 Restufl Web 应用程序，我在使用使用 json 对象的 post 方法调用 Web 服务时遇到问题。我必须使用 jquery 调用 web 服务，
这是方法

```
 @POST
@Path("/client")
@Consumes(MediaType.APPLICATION_JSON) 
public Response showClient(Client c){
     String name = c.getAdresseCl() + ""+ c.getEmailCl();
    ResponseBuilder builder = Response.ok(name);
    builder.header("Access-Control-Allow-Origin", "*");
    builder.header("Access-Control-Max-Age", "3600");
    builder.header("Access-Control-Allow-Methods", "GET");
    builder.header(
            "Access-Control-Allow-Headers",
            "X-Requested-With,Host,User-Agent,Accept,Accept-Language,Accept-Encoding,Accept-Charset,Keep-Alive,Connection,Referer,Origin");
    return builder.build();
} 
```

使用 jquery 进行客户端调用：

```
 var data={'adressCl':'myAdress','emailCl':'example@domain.com'};
$.ajax({
"type":"post",
"dataType":"json",
"data":data,
"url":"http://localhost:9080/FournisseurWeb/jaxrs/clients/client",
"success":function(res){
console.log(res);
}
});/*
$.post("http://localhost:9080/FournisseurWeb/jaxrs/clients/client",data,function(res){
console.log(res);
});*/ 
```

我收到此错误：“NetworkError: 415 Unsupported Media Type please help! and thx提前

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T18:29:28.743

从[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/) `contentType`字段描述看起来 .ajax() 默认发送的是 application/x-www-form-urlencoded，而不是 json，因此您需要正确设置：application /json

我从来没有检查过，但我总是使用“type”：“POST”而不是“type”：“post”，也许这就是问题所在。

# html - httpd.ini 或 html 中的重定向代码

> ID：10677276
> 
> 赞同：0
> 
> 时间：2012-05-20T21:16:03.313
> 
> 标签：html

我在 Windows 服务器上。我正在尝试创建一个 html 文件（必须命名为“notfound.html”），该文件将允许我为我的两个域拥有一个自定义的 404 页面。我的托管公司说我可以使用 HTTPD.INI 将浏览器重定向到正确的页面。我不知道httpd.ini。有人可以帮忙吗？

简单地说：它将涉及两个域（例如）mydomain.com 和 myotherdomain.com。

我需要将访问者重定向到两个域的自定义 404 页面。mydomain.com 是主域。myotherdomain.com 是 mydomain.com 所在根目录下的子域。

这可以用 httpd.ini 完成吗？如果有怎么办？？我希望将输入错误网页的访问者重定向到每个域的自定义 404 页面。我知道我需要在各自的目录中有单独的“notfound.html”文件。我不知道如何用 httpd.ini 做到这一点。

有什么建议么？谢谢 ！！！！瘦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T21:36:46.167

您可以将此行放在 httpd 文件的末尾：

```
ErrorDocument 404 /notfound.html 
```

编辑：我在手机上，所以我不能做任何研究。而且您只是说您在 Windows 服务器上，而不是使用 IIS、Apache 或任何其他服务器软件。我的回答仅适用于您使用 apache 的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:01:09.517

```
# Helicon ISAPI_Rewrite configuration file
# Version 3.1.0.69

RewriteEngine On
RewriteCompatibility2 On
RepeatLimit 32
RewriteBase

#  Block external access to the httpd.ini and httpd.parse.errors files
RewriteRule ^/httpd(?:\.ini|\.parse\.errors).*$ / [NC,F,O]
#  Block external access to the Helper ISAPI Extension
RewriteRule ^.*\.isrwhlp$ / [NC,F,O]

RewriteRule ^/(?!(?:manager|assets)/)(.*)\.html(?:\?(.*))?$ /index.php?q=$1?2&$2: [NC,L,U] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T22:04:54.993

上面的代码适用于 IIS 6。可能需要修改最后一行

```
/index.php? 
```

如果您使用 IIS 管理器、cPanel 或 Plesk，您可以创建这些，而无需通过 GUI 手动添加文件。

# html - 你如何摆脱页面底部的开放空间？

> ID：10677278
> 
> 赞同：0
> 
> 时间：2012-05-20T21:16:10.647
> 
> 标签：html, css, spacing

我一直在做一个小项目，但遇到了一个问题。当我在浏览器中查看我的网站时，所有内容的底部都有一个非常大的开放空间。谁能帮我找出问题所在？我一直试图找到它几个小时。

这是代码：

```
<html>
<head>
<title>Media Mash - Home</title>
<style type="text/css">
* {
font-family:neuropol;
color:rgb(255,255,255);
}
body {
background-color:rgb(52,126,153);
}
.text1 {
font-size:20;
color:rgb(0,0,0);
}
.text2 {
font-size:35;
text-decoration:none;
margin-left:4%;
margin-right:4%;
}
.parent {
min-width:1255px;
}
.topBar {
background-color:rgb(161,35,35);
display:inline-block;
width:1247px;
text-align:center;
height:40px;
}
.leftBar {
top:8px;
background-color:rgb(161,35,35);
position:relative;
display:inline-block;
width:250px;
text-align:center;
height:581px
}
.main {
background-color:rgb(161,35,35);
position:relative;
display:inline-block;
left:258px;
bottom:573px;
width:989px;
height:581px;
}
.imageLeft {
background-color:rgb(104,22,22);
position:relative;
display:inline-block;
}
.imageRight {
background-color:rgb(104,22,22);
position:relative;
display:inline-block;
}
.textLeft {
background-color:rgb(104,22,22);
position:relative;
display:inline-block;
}
.textRight {
background-color:rgb(104,22,22);
position:relative;
display:inline-block;
}
.copyright {
background-color:rgb(161,35,35);
position:relative;
display:inline-block;
height:32px;
bottom:565px;
width:1247px;
text-align:center;
}
</style>
</head>
<body>
<div class="parent">
    <div class="topBar">
        <a class="text2" href="placeholder.html">Media Mash</a>
        <a class="text2" href="placeholder.html">Film</a>
        <a class="text2" href="placeholder.html">Music</a>
        <a class="text2" href="placeholder.html">Games</a>
        <a class="text2" href="placeholder.html">Books</a>
    </div>
    <br/>
    <div class="leftBar">
        <a class="text1">
            Media Mash is a website dedicated to helping you realise what favourite films, songs, games and books are.
            <br/>
            <br/>
            We do so in a fun image versus image format, which allows you to pick out your favourites.
            <br/>
            <br/>
            Have a go and create your top 10 lists today!
        </a>
    </div>
    <br/>
    <div class="main">
        <div class="imageLeft">
            <img src="images\The Avengers MM.jpg"/>
        </div>
        <div class="imageRight">
            <img src="images\Star Wars V The Empire Strikes Back MM.jpg"/>
        </div>
        <br/>
        <div class="textLeft">
            <a class="text1">The Avengers</a>
        </div>
        <div class="textRight">
            <a class="text1">Star Wars V: The Empire Strikes Back</a>
        </div>
    </div>
    <br/>
    <div class="copyright">
        <a class="text1">Copyrighted intellectual property of Thomas Crowther ©</a>
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:26:09.687

正如您的代码所代表的那样，浏览器首先渲染页面，其中包含彼此下方的框，然后将框移动到另一个框的右侧。这就是相对定位的含义。

你*想要*做的是，而不是使用相对定位，使用`float:left`(on `.leftBar`) 和`float:right`(on `.rightBar)。浏览器将首先呈现元素。

我建议您阅读 CSS 中的“盒子模型”，并查看适用于 Firefox 的 Firebug。

# google-maps - Google Maps API v3 客户端平铺？

> ID：10677296
> 
> 赞同：0
> 
> 时间：2012-05-20T21:18:45.560
> 
> 标签：google-maps, google-maps-api-3, client-side

我正在使用带有自定义 6000x6000 像素地图图像的 Google Maps API v3，最初大约 6MB 的磁盘空间。在我使用一个程序创建与谷歌地图兼容的图块后，我得到了大约 5,300 个图块，总共大约 120MB 的磁盘空间。在线查看地图非常慢，因为每次都必须从服务器下载这些图块。有没有办法让客户端下载原始的 6MB 6000x6000 地图 PNG，然后根据需要在客户端创建切片？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T21:47:27.480

您需要制作自己的平铺程序。Google 使用 az morton 曲线来细分地图。z morton 曲线非常简单，它只是一些位移。但是您需要客户端权限才能下载文件？所以不行。

# redirect - 登录 IE 后 FOSUserBundle 奇怪的重定向（到 favicon）

> ID：10677302
> 
> 赞同：0
> 
> 时间：2012-05-20T21:19:38.407
> 
> 标签：redirect, login, symfony, fosuserbundle

我有一个奇怪的重定向。期望的行为是：当我输入 URL [http://xyz.localhost](http://xyz.localhost)时，有一个登录表单，成功登录后我被重定向到主页。在 Firefox 中一切正常，但在 IE 和 Iron（即 Chrome）中失败 - 将我重定向到[http://xyz.localhost/favicon.ico](http://xyz.localhost/favicon.ico)，当然还有路由错误。

我在 head 部分的 base.html.twig 中删除了 favicon 定义，但 Iron 中的结果相同，但现在 IE 运行良好。

我[在这里](http://pastebin.com/43attPpq)粘贴了 dev.log 文件的内容 - 仅在按下提交按钮后的部分。

我在缓存中搜索了“favicon”这个词，并在编译的树枝模板中找到了它：

```
/* WebProfilerBundle:Profiler:base.html.twig */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:15:38.420

如果它丢失，请尝试上传 favicon，看看会发生什么；]

# java - 使布局适用于所有 SDK<11？

> ID：10677303
> 
> 赞同：2
> 
> 时间：2012-05-20T21:19:44.903
> 
> 标签：java, android, layout

我正在使用一些无法在 SDK < 11 中使用的布局文件（默认文件夹）。我发现我可以创建一个文件夹“layout-v10”等，并在那里放置特殊的布局文件。

我现在想让这些文件与 API 7 兼容。并且同样被所有 API 7-10 使用。我是否必须为每个 api 布局创建一个新的单个文件夹？或者我如何将低于特定于替代布局的每个 api 匹配？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:22:25.997

不完全是，但您可以匹配特定版本**以上的每个 API。**例如，您可以有一个`layout-v7`文件夹和一个`layout-v11`文件夹。API 7 到 10 将使用第一个文件夹中的资源，API 11 及更高版本来自后一个文件夹。API 7 之前的版本将使用默认`layout`文件夹中的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:23:17.377

反转逻辑：将pre-11的布局放入res/layout，将11+版本的布局放入res/layout-v11。

# git - 为什么我的 git submodule 命令不能与 Bitbucket 一起使用？

> ID：10677305
> 
> 赞同：1
> 
> 时间：2012-05-20T21:20:01.073
> 
> 标签：git, git-submodules, bitbucket

我正在尝试添加一个子模块

[https://bitbucket.org/hski/issuestats-public/wiki/Home](https://bitbucket.org/hski/issuestats-public/wiki/Home)

使用以下命令

```
git submodule add git@bitbucket.org:hski/issuestats-public.git issuestats 
```

我收到以下错误消息

```
fatal: Not a git repository (or any of the parent directories): .git 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:25:20.740

错误消息是指您的工作副本 - 而不是远程。

```
cd /no/git/here
git submodule add foo bar
fatal: Not a git repository (or any of the parent directories): .git 
```

您需要将子模块添加*到*git repo

```
cd /my/repos/project-x
git submodule add foo bar
# will work or give a more specific error 
```

如果您只想获取代码以便使用它，则需要克隆存储库：

```
git clone https://bitbucket.org/hski/issuestats-public.git issuestats 
```

# php - 从混合数组中获取所有可能的结果

> ID：10677306
> 
> 赞同：5
> 
> 时间：2012-05-20T21:20:05.940
> 
> 标签：php

我在网上到处找这个，但无法完全找到。（我的 PHP 和数学技能让我对此感到失望......）我有一个数组，其中包含例如三个字符串（也可能更多！）（例如：“a”、“b”、“c”）。现在我想做一个返回所有可能性的函数。我到处寻找，发现了一些不错的函数，它们以所有可能的方式移动了数组，但它们并没有一个一个地删除一个值。所以他们有：

> abc acb bac bca 出租车 cba

这很好，但我需要一个将其提升到新水平的函数：

> abc acb bac bca cab cba ac ca ab ba bc ba abc

这不管有多少值（比如说最大 10）。我整个晚上都在为此苦苦挣扎，有人可以让我摆脱痛苦并为我解开这个谜语吗？或者给点建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:31:32.597

看起来您要的是“电源组”。幂集包括空集，我不会包括在内。

```
require_once 'Math/Combinatorics.php';
$set = range('a', 'c');
$permutationSizes = range(1, count($set));
$combinatorics = new Math_Combinatorics;
$result = array();
foreach ($permutationSizes as $permutationSize) {
    $result = array_merge($result, $combinatorics->permutations($set, $permutationSize));
}
print_r($result); 
```

[http://pear.php.net/package/Math_Combinatorics](http://pear.php.net/package/Math_Combinatorics)

我想从技术上讲这不是一个电源组，因为我假设在比较组时顺序很重要。反正...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T05:53:02.157

与往常一样，以自己的方式解决问题更有趣。您可以更轻松地修改代码以满足您的特殊需求，因为您知道自己在做什么:) 请参阅下面的测试脚本：

```
<?

$a = array("a", "b", "c");

function getAll($prefix, $remaining)
{
    echo $prefix."\n";

    if (count($remaining) == 0) return;
    if (count($remaining) == 1)
    {                                                                
        echo $prefix.$remaining[0]."\n";
        return;                                                      
    }                                                                

    for ($i = 0; $i < count($remaining); $i++)                       
    {                                                                
        $t = $remaining;                                             
        unset($t[$i]);                                               
        $t = array_values($t);                                       
        getAll($prefix.$remaining[$i], $t);              
    }                                                                                                       
}                                                        
echo "<pre>\n";                                          
getAll('', $a);                                          
echo "</pre>\n";                                         

?> 
```

我只是回显了预期的输出，你可以添加一个结果数组，但那是你的部分:)

输出：

```
[] //empty value is included, but blank lines won't show up here, so I wrote []
a
ab
abc
ac
acb
b
ba
bac
bc
bca
c
ca
cab
cb
cba 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T21:54:58.677

[O'Reilly 的PHP Cookbook 第 4.26 节](http://docstore.mik.ua/orelly/webprog/pcook/ch04_26.htm)有一个用于排列的示例函数。它只创建固定大小的排列，但可以在循环中使用以处理您需要的任何大小。

### 代码

```
function pc_next_permutation($p, $size) {
    // slide down the array looking for where we're smaller than the next guy
    for ($i = $size - 1; $p[$i] >= $p[$i+1]; --$i) { }

    // if this doesn't occur, we've finished our permutations
    // the array is reversed: (1, 2, 3, 4) => (4, 3, 2, 1)
    if ($i == -1) { return false; }

    // slide down the array looking for a bigger number than what we found before
    for ($j = $size; $p[$j] <= $p[$i]; --$j) { }

    // swap them
    $tmp = $p[$i]; $p[$i] = $p[$j]; $p[$j] = $tmp;

    // now reverse the elements in between by swapping the ends
    for (++$i, $j = $size; $i < $j; ++$i, --$j) {
         $tmp = $p[$i]; $p[$i] = $p[$j]; $p[$j] = $tmp;
    }
    return $p;
}

$set = explode(' ', 'a b c');

// $all will contain the final output
$all = $set;
while(count($set) > 1) {
    $perms = array();
    $size = count($set) - 1;
    $perm = range(0, $size);
    $j = 0;

    do { 
         foreach ($perm as $i) { $perms[$j][] = $set[$i]; }
    } while ($perm = pc_next_permutation($perm, $size) and ++$j);

    foreach ($perms as $p) {
         $all[] = implode(' ', $p);
    }
    array_pop($set);    
}

// display results
foreach($all as $each) {
    echo $each . "\n";
} 
```

### 输出

```
a
b
c
a b c
a c b
b a c
b c a
c a b
c b a
a b
b a 
```

[活生生的例子](http://codepad.org/2W0GqFTN)

# jquery-mobile - 当我使用 jQuery Mobile 按下后退按钮时，如何显示加载图像？

> ID：10677311
> 
> 赞同：0
> 
> 时间：2012-05-20T21:20:45.427
> 
> 标签：jquery-mobile

当我在我的 jQuery Mobile 应用程序中按下一个链接时，jqm（作为一个了不起的库）会自动显示一个漂亮的小漩涡图像，在将我带到该页面之前的最短时间内表示“正在加载”。

但是，我的各个页面上的后退按钮没有内置该功能。如何手动添加它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:14:36.367

有时不需要加载消息。如果页面被缓存并且可以直接切换到它，那么为什么要显示加载消息。如果您绝对想要一个，那么有两种 JQM 方法可以为您做到这一点。

1.  $.mobile.showPageLoadingMsg() 名称表示显示加载消息或图标。
2.  $.mobile.hidePageLoadingMsg() 将再次隐藏它。

这是一个小例子。

html

```
<div data-role="header">
    <a class="customBackBtn">Back</a>
    <h1>My Title</h1>
</div><!-- /header --> 
```

js

```
$(document).on('click','.customBackBtn',function(){

    $.mobile.showPageLoadingMsg();

    setTimeout(function(){
        $.mobile.hidePageLoadingMsg();
        history.back();
    }, 1000);

});​​​​​​​​​​​​​​​​​​​​ 
```

[工作jsfiddle示例](http://jsfiddle.net/codaniel/Zq32c/2/)

# javascript - javascript：使用 ajax 更改 onClick 属性不会触发新事件？

> ID：10677314
> 
> 赞同：0
> 
> 时间：2012-05-20T21:21:14.163
> 
> 标签：javascript, ajax, jquery, javascript-events

刚刚尝试了以下方法，发现这不起作用？

（使用 jQuery）：

```
function bookmark_add() {

        $.ajax({
          type: "POST",
          url: "load.php",
          data: data,
          success: function(msg) {
              var msg_array=msg.split("-");
              var success=msg_array[0];
              var bookmark_id=msg_array[1];

              if(success==1) {
                  $('.btn_bookmark').html('Remove Bookmark');
                   $('.a_bookmark').attr("onClick","bookmark_remove("+bookmark_id+"), return false;");
                  }
              }
        });
    } 
```

此功能工作正常。元素的属性`<a>`正在正确更改。但是，新事件（该函数`bookmark_remove`没有被触发。所以我假设我的方法由于一些基本的误解而不起作用，可能吗？

谁能告诉我这个假设是正确的并给出任何暗示为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:24:16.210

我不能立即告诉你为什么它不起作用（可能是几件事；`onClick`一件事应该是小写的——混合大小写的版本只在 HTML*标记*中是可以的[不是 XHTML，而是 HTML]，不是一次你重新与 DOM 交互，这是区分大小写的），但完全没有理由这样做。反而：

```
$('.a_bookmark').click(function() {
    bookmark_remove(bookmark_id);
    return false;
}); 
```

如果锚点预先配备了现有的`onclick`处理程序，您可以像这样清除它：

```
$('.a_bookmark').attr("onclick", ""); 
```

所以把它放在一起：

```
$('.a_bookmark').attr("onclick", "").click(function() {
    bookmark_remove(bookmark_id);
    return false;
}); 
```

* * *

显然人们不明白我在哪里这样做，所以这是你的完整`ajax`电话，上面推荐的更改：

```
 $.ajax({
      type: "POST",
      url: "load.php",
      data: data,
      success: function(msg) {
          var msg_array=msg.split("-");
          var success=msg_array[0];
          var bookmark_id=msg_array[1];

          if(success==1) {
              $('.btn_bookmark').html('Remove Bookmark');
              $('.a_bookmark').attr("onclick", "").click(function() {
                  bookmark_remove(bookmark_id);
                  return false;
              });
          }
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T21:24:40.300

```
"bookmark_remove("+bookmark_id+"), return false;" 
```

逗号是错误的。它应该是一个分号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:25:09.150

由于您使用的是 jQuery，而不是：

```
$('.a_bookmark').attr("onClick","bookmark_remove("+bookmark_id+"), return false;"); 
```

我建议你使用这种形式：

```
$('.a_bookmark').click(function(){
    bookmark_remove(bookmark_id);
    return false;
}) 
```

使用更少的引号标记更具可读性，对吗？

# python - OpenCV 和 Python 的书籍？

> ID：10677317
> 
> 赞同：14
> 
> 时间：2012-05-20T21:21:47.557
> 
> 标签：python, opencv

有谁知道是否有任何关于 OpenCV 和 Python 的书籍？

我有 OReilly 学习 OpenCV 的书，但它适用于**C**，所以我正在寻找书籍/pdfs/在线教程，特别是 Python 和 OpenCV。

我看过[http://www.neuroforge.co.uk/index.php/getting-started-with-python-a-opencv](http://www.neuroforge.co.uk/index.php/getting-started-with-python-a-opencv)很有帮助，但我更喜欢有一本书。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-20T22:25:59.017

**更新（2013 年 10 月 11 日）**

现在 opencv 网站上提供了有关 OpenCV-Python 的官方教程。它几乎涵盖了 OpenCV-Python API 的大部分重要功能。`This tutorial is using OpenCV 3.x version`. *（所以有些教程可能与 OpenCV 2.x 不兼容）*

访问：[http ://docs.opencv.org/trunk/doc/py_tutorials/py_tutorials.html](http://docs.opencv.org/trunk/doc/py_tutorials/py_tutorials.html)

* * *

**第一个答案（2012 年 5 月 20 日）**

关于 OpenCV 和 Python 的教程不多。官方的只是opencv附带的文档和示例。但即使是一些样本对于初学者来说也很难理解。

如果您专门搜索书籍，那么到目前为止还没有关于此主题的专门书籍。但是我看过一本书，其中只有一章关于这个主题。“用 Python 编程计算机视觉”就是那本书。你可以在这里得到那本书的草稿：http: [//programmingcomputervision.com/](http://programmingcomputervision.com/)

由于缺乏针对 opencv 的 Python 教程，我也感到了这种困难。所以我不得不阅读其他语言书籍，然后将代码转换为python。你也可以做到这一点，这不是一项艰巨的任务。

这就是我在这个主题上写博客的原因。您可以访问它（如果您还没有访问过）：[www.opencvpython.blogspot.com。](http://opencvpython.blogspot.in/2011/04/welcome-to-opencv-python.html)

由于我很忙，现在没有太多文章。但在两个月内，我将上传更多文章。你可以在那里有一些关于你需要什么教程的建议。我会发布它们，如果我知道的话。

其他教程，散布在互联网上的不同主题：

1) [https://github.com/abidrahmank/OpenCV2-Python](https://github.com/abidrahmank/OpenCV2-Python)：包含一些使用新`cv2`界面的示例。还包含一些从官方 OpenCV 教程转换为 Python 的 C++ 代码。所以你使用官方解释和 Python 代码

2) [https://github.com/abidrahmank/OpenCV-Python](https://github.com/abidrahmank/OpenCV-Python)：包含一些颜色跟踪、轮廓等示例。使用旧`cv`界面

3) [https://github.com/jessicaaustin/robotics-projects/tree/master/opencv-tutorial](https://github.com/jessicaaustin/robotics-projects/tree/master/opencv-tutorial) - 包含阈值、轮廓等代码。

4) [http://pythonimage.blogspot.in](http://pythonimage.blogspot.in) - 一般是 python 图像处理，也包含一些 OpenCV。

以上是少数，剩下的你可以通过谷歌搜索找到。但是所有的教程都会减少。我建议您查看其他语言网站和书籍并将它们转换为 Python。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T09:47:25.473

请注意，/samples/python 下的源代码中有许多且很快会增长的 Python 示例

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-20T21:34:26.600

所以这是我找到的一个教程，但是我不能完全确定这是你要找的，因为我从未使用过 OpenCV： http: [//www.neuroforge.co.uk/index.php/getting-started-与-python-a-opencv](http://www.neuroforge.co.uk/index.php/getting-started-with-python-a-opencv)。这是一个参考站点： http: [//opencv.willowgarage.com/documentation/python/index.html](http://opencv.willowgarage.com/documentation/python/index.html)。干杯:)

# c4 - C4Shape 对象中的手势是如何处理的？

> ID：10677318
> 
> 赞同：4
> 
> 时间：2012-05-20T21:21:58.343
> 
> 标签：c4

我正在尝试稍微扩展 C4，并试图弄清楚手势和动画如何在 C4Shape 对象上工作。我查看了源代码，看起来它们都是基于 CAShapeLayers 的，手势识别器不能直接附加到它上面。有人可以解释这在 C4 中是如何工作的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:46:52.937

对，C4 中的所有可见对象都基于一个子类 CALayer。例如，C4Shapes 是 C4ShapeLayers 的子类，而 C4Movies 是 C4PlayerLayer 的子类（AVPlayerLayer 的子类，它已经是 CALayer 的子类），并且图像被绘制为基本 CALayer 的内容。

但是，这些层中的每一层都包含在 UIControl (UIView) 的子类中，因此它们都可以单独注册触摸并且它们都可以附加手势识别器。

例如，C4Shape 的层次结构是：

> UIView > UIControl > C4Control（以 C4ShapeLayer 作为其主层）。

对于一部电影：

> UIView > UIControl > C4Control（以 C4PlayerLayer 作为其主层）。

等等

因此，所有可见对象都具有以下内容：

> UIView > UIControl > C4Control

... 带有 C4Control 对象的自定义层。

# ajax - ASP .NET MVC 3 - 如何提交嵌套在 html 表单中的 ajax 表单

> ID：10677322
> 
> 赞同：8
> 
> 时间：2012-05-20T21:22:31.997
> 
> 标签：ajax, asp.net-mvc-3, form-submit, nested-forms

我有一个 ASP .NET MVC 3 项目，并且我的“创建”视图之一存在问题。

我有使用 ajax 表单实现的级联下拉字段。

该视图粗略地说 - 像这样：

```
@using (Html.BeginForm(...))
{
    @Html.MyDropDown1

    using (Ajax.BeginForm(...))
    {
        @Ajax.MyDropdown2
        <input type="submit" value="Select" />
    }

    using (Ajax.BeginForm(...))
    {
        @Ajax.MyDropdown3
        <input type="submit" value="Select" />
    }

    <!-- other form fields -->

    <input type="submit" value="Create" />
} 
```

问题是 ajax 表单内的提交按钮实际上是提交外部 html 表单。

有什么方法可以指定我要提交的表单的名称吗？

我考虑将我的 ajax 表单放在我的 html 表单之上，这样就不会有任何嵌套 - 但我需要在我的 html 帖子中下拉所选项目的值。

谢谢，皮特

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-20T22:14:31.757

正如评论中指出的那样，您不能拥有嵌套表单。删除所有`using (Ajax.BeginForm(...))`位，并通过 jQuery（或其他）处理您的 ajax 调用。

# scala - 在语句中混合 Scala Option 和常规变量

> ID：10677323
> 
> 赞同：3
> 
> 时间：2012-05-20T21:22:47.733
> 
> 标签：scala, option, dsl, implicits

我想编写透明地混合 Scala 选项和常规变量的条件语句。例如：

```
var o1 = Some(1)
var o2: Option[Int] = None

var x = 2

val test1 = x < 3 && o1<5  //=> should be true or Some(true)
val test2 = x < 3 && o2<5  //=> should be false or None
val test3 = x < 3 || o2<5  //=> should be true (o2 not evaluated) 
```

我当然可以写

```
 test1 = x < 3 && o1.exists (_<5) 
```

但我更喜欢更简洁的语法。

有什么提示吗？我应该用运算符扩展“选项”，还是使用隐式、范畴论或其他？

编辑：更正声明。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:31:21.157

使用隐式当然很容易：

```
implicit def enrichOptionInt(self: Option[Int]) = new {
  def <(i: Int) = self.exists(_ < i)
}

val test1 = x < 3 && o1 < 5  // True 
```

或者，如果您希望它适用于任何类型的数字：

```
class EnrichedOptionNumeric[N: Numeric](self: Option[N]) {
  def <(n: N) = self.exists(v => implicitly[Numeric[N]].lt(v, n))
}
implicit def enrichOptionNumeric[N: Numeric](self: Option[N]) = new EnrichedOptionNumeric(self)

val oD = Some(2.0)
val test1 = x < 3 && o1 < 5    // true
val testD = x < 3 && oD < 5.0  // true 
```

**编辑**以在评论中回答问题：

如果您想支持相等，那么不幸的是，您不能使用该运算符，`==`因为该运算符已经为`Option`. 如果已经为类定义了方法（或运算符），则永远不会触发隐式，因为 Scala 仅在无法识别被调用的方法时才查找隐式。

但是，您*可以*简单地定义一个不同的符号来表示“选项等于”。例如，您可以使用`===`. 为此，您只需将以下行添加到上述定义中`EnrichedOptionNumeric`：

```
def ===(n: N) = self.exists(v => implicitly[Numeric[N]].equiv(v, n)) 
```

然后你可以这样做：

```
val testE = x < 3 && o1 === 1 // true 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-20T21:35:09.673

映射 from `Option[Int]`to怎么样`Option[Boolean]`？

```
x < 3 && (o1 map {_ < 5} getOrElse false)
x < 3 && (o2 map {_ < 5} getOrElse false)
x < 3 || (o2 map {_ < 5} getOrElse false) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T04:16:37.443

如果您有 Ordering[A] 但语义与您想要的不同（None 是最小值），Scala 实际上可以为 Option[A] 进行 Ordering。

此外，为了进行比较，两个值必须属于同一类型，因此您需要一种将 Ints 提升为 Option 的方法。为此，我添加了一个 opt 方法。

这是一个内部排序的例子：

```
import scala.math.Ordering.Implicits.infixOrderingOps
//This allows you to use method/operator syntax on anything with an Ordering

implicit def mkOption[A](a: A) = new { def opt: Option[A] = Some(a) }

var o1 = Some(1)
var o2: Option[Int] = None

var x = 2

val test1 = x < 3 && o1<5.opt  //=> true
val test2 = x < 3 && o2<5.opt  //=> true
val test3 = x < 3 || o2<5.opt  //=> true
None > 0.opt //=> false
None < 0.opt //=> true 
```

为了更接近你的语义，我们可以定义一个新的排序

```
implicit def mkOptionOrdering[A: Ordering] = new Ordering[Option[A]] {
    def compare(a: Option[A], b: Option[A]): Int = {
      if (a.isEmpty || b.isEmpty) 0 
      else implicitly[Ordering[A]].compare(a.get, b.get)
    }
  } 
```

现在您的测试将按照您的预期进行，另外 2 个额外的测试也将是错误的，但是这些语义相当奇怪，比较不相等的东西返回 0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-20T22:37:26.283

想想在这个问题的上下文中是否有比使用`Option`. 也许可以说没有限制，`Double`带有值的 a`Infinity`会起作用，或者`Int`带有a `Integer.MAX_VALUE`。然后`Option`完全从问题中删除。如果你不能，那么你可以使用

```
var o1 = Some (1)
var o2 = Option[Int] = None

var x = 2

val test1 = x < 3 && o1.getOrElse(Integer.MAX_VALUE)<5  //=> should be true or Some(true)
val test2 = x < 3 && o2.getOrElse(Integer.MAX_VALUE)<5  //=> should be false or None
val test3 = x < 3 || o2.getOrElse(Integer.MAX_VALUE)<5  //=> should be true (o2 not evaluated) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-21T07:08:26.247

Tomasz Nurkiewicz 的答案可以用一些[Scalaz](http://code.google.com/p/scalaz/)糖更简洁，并`Monoid`使用`Boolean`.

幺半群的“零”值是`false`，因此`o getOrElse false`变成`~o`，使用`~`scalaz 中定义的一元运算符。（这里我使用的是 scalaz 6.0.4）

```
def p: Int => Boolean = _ < 3
def q: Int => Boolean = _ < 5
import scalaz._, Scalaz._

scala> val test1 = p(x) && ~(o1 map q)
test1: Boolean = true

scala> val test2 = p(x) && ~(o2 map q)
test2: Boolean = false

scala> val test3 = p(x) || ~(o2 map q)
test3: Boolean = true 
```

# c++ - 可以在 OSx 中使 QDialog 抖动

> ID：10677324
> 
> 赞同：0
> 
> 时间：2012-05-20T21:22:49.247
> 
> 标签：c++, macos, qt

由于 Qt 在 OSX 下使用 Cocoa，如果用户输入错误的密码，是否可以使模态 QDialog 抖动？我找不到任何关于它的信息，但在 mac 上实现真的很好。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T05:27:44.670

我不知道这样做的内置方法，但您可以自己实现摇动，如下所示：

头文件.h

```
#include <QtGui>

class ShakyDialog : public QDialog
{
    Q_OBJECT

public slots:
    void shake()
    {
        static int numTimesCalled = 0;
        numTimesCalled++;

        if (numTimesCalled == 9) {
            numTimesCalled = 0;
            return;
        }

        vacillate();
        QTimer::singleShot(40, this, SLOT(shake()));
    }

private:
    void vacillate()
    {
        QPoint offset(10, 0);

        move(((shakeSwitch) ? pos() + offset : pos() - offset));
        shakeSwitch = !shakeSwitch;
    }

    bool shakeSwitch;
}; 
```

主文件

```
#include "header.h"

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    ShakyDialog dialog;
    QHBoxLayout layout(&dialog);
    QPushButton button("Push me.");
    layout.addWidget(&button);

    QObject::connect(&button, SIGNAL(clicked()), &dialog, SLOT(shake()));

    dialog.show();
    return app.exec();
} 
```

# javascript - 如何在 Javascript 数组中进行赋值

> ID：10677325
> 
> 赞同：0
> 
> 时间：2012-05-20T21:22:55.877
> 
> 标签：javascript, arrays

```
var events = [
    {id: 100,url: "mc.jsp?id=" + id},
    {id: 200,url: "mc2.jsp?id=" + id},
    {id: 300,url: "mc2.jsp?id=" + id}
] 
```

运行时，url 等于`mc.jsp?id=undefined`，那么如何将 id (100) 分配给 url 以获取 的值`mc.jsp?id=100`？并将第二个 url 设为`mc2.jsp=200`第三个`mc2.jsp？id=300` ，这样我就无法在数组之外进行分配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:25:37.640

您不能在构造上访问对象文字中的其他属性。你得到一个，`undefined`因为你没有变量`id`。您将需要使用：

```
var id = 100;
var events = [{"id":id, "url":"mc.jsp?id=" + id}]; 
```

或者：

```
var event = {id: 100};
event.url = "mc.jsp?id=" + event.id
var events = [event]; 
```

但你可以定义一个吸气剂：

```
var events = [{id: 100, get url() { return "mc.jsp?id="+this.id; } }]; 
```

这是非常复杂且难以理解的。也许最好做这样的事情：

```
function MyEvent(id, mc) {
    this.id = id;
    this.mc = mc;
}
MyEvent.prototype.getUrl = function() {
    return "mc"+this.mc+".jsp?id="+this.id;
};

var events = [new MyEvent(100, ""), new MyEvent(200, "2"), ...]; 
```

但是，应该没有这样的问题。如果您对数字进行硬编码，为什么不对网址进行硬编码？如果您不想要冗余，请不要将 id 存储两次并在每次需要时附加它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T21:26:01.203

您无法添加`id`，因为它是属性的名称，而不是变量。你可以做：

```
var ids = [100,200,300];
var events = [];
for(var i = 0; i < ids.length;i++){
    events[i] = {id: ids[i],url: "mc.jsp?id=" + ids[i]};
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T21:26:12.060

```
 var id = 100, events = [{id: id, url: "mc.jsp?id=" + id}]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T21:54:15.353

你可以试试类似的东西。

```
var event = {
 'id': 100,
 'url': 'mc.jsp?id=' + event.id
}

var events = [];
events.push(event); 
```

# php - 如何使用 preg_replace 获得替换的文本？

> ID：10677327
> 
> 赞同：4
> 
> 时间：2012-05-20T21:23:42.810
> 
> 标签：php, string, preg-replace, bit.ly

我在 PHP 中使用**preg_replace**函数，并试图用 bit.ly 缩短链接替换用户提交的 url：

```
$comment = preg_replace( '/(http|ftp)+(s)?:(\/\/)((\w|\.)+)(\/)?(\S+)?/i', '', $strText ); 
```

这将仅显示评论并“清除”网址。问题是如何从文本中获取 URL 并在以后附加它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:27:18.917

[preg_replace_callback()](http://php.net/manual/en/function.preg-replace-callback.php)

来自 php.net 的示例：

```
<?php
// this text was used in 2002
// we want to get this up to date for 2003
$text = "April fools day is 04/01/2002\n";
$text.= "Last christmas was 12/24/2001\n";
// the callback function
function next_year($matches)
{
  // as usual: $matches[0] is the complete match
  // $matches[1] the match for the first subpattern
  // enclosed in '(...)' and so on
  return $matches[1].($matches[2]+1);
}
echo preg_replace_callback(
            "|(\d{2}/\d{2}/)(\d{4})|",
            "next_year",
            $text);

?> 
```

定义一个替换 URL 的回调函数。它将接收匹配项作为参数，并在您内部根据这些匹配项形成一个替换字符串。

# javascript - jqgrid - 添加，编辑，删除不起作用

> ID：10677329
> 
> 赞同：0
> 
> 时间：2012-05-20T21:24:06.177
> 
> 标签：javascript, jqgrid

我无法添加、编辑、删除、搜索

甚至我把 editrules:{required:true} 也不起作用。

（萤火虫中的错误显示“isEmtpy 不起作用”）

* * *

这是我的代码...

索引.html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>jqgrid</title> 

    <!-- installation files of jqgrid -->
    <link rel="stylesheet" type="text/css" media="screen" href="themes/redmond/jquery-ui-1.8.16.custom.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="themes/ui.jqgrid.css" />
    <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="js/i18n/grid.locale-en.js" type="text/javascript"></script>
    <script src="js/jquery.jqGrid.min.js" type="text/javascript"></script>
    <!-- installation files of jqgrid -->

<script type="text/javascript"> 

function mypricecheck(value, colname) {
if (value < 0 || value >20) 
   return [false,"Please enter value between 0 and 20"];
else 
   return [true,""];
}

    jQuery().ready(function (){

        jQuery("#list1").jqGrid({
            url:'server.php?q=1',
            datatype: 'xml',
            //colNames:['ProductCode','ProductCategoryID', 'ProductBrandID', 'ProductDescription','ProductOriginal','ProductCompatible','ProductDealerPrice'],
            colModel:[
                {name: "ProductCode", index: "ProductCode", label: "รหัสสินค้า", width: 50, editable:true, key: true  , edittype: 'text', editoptions: { dataInit: function (el) { $(el).css('text-transform', 'uppercase'); }} },
                {name: "ProductCategoryID", index: "ProductCategoryID", label: "หมวดหมู่", width: 60, editable: true, edittype: 'select', editoptions:{value:{Toner:'Toner',Inkjet:'Inkjet',Ribbon:'Ribbon','Fax Film':'Fax Film'}} },
                {name: "ProductBrandID", index: "ProductBrandID", label: "แบรนด์", width: 50, editable: true, edittype: 'select', editoptions:{dataUrl: "optbrand.php"} },
                {name: "ProductDescription", index: "ProductDescription", label: "คำอธิบาย", width: 120, editable: true},
                {name: "ProductOriginal", index: "ProductOriginal", label: "รุ่นออริจินัล", width: 140, editable: true},
                {name: "ProductCompatible", index: "ProductCompatible", label: "เหมาะสำหรับรุ่น", width: 200, editable: true},
                {name: "ProductDealerPrice", index: "ProductDealerPrice", label: "ราคาเดลเลอร์", width: 40, editable: true, editrules:{number:true},sorttype:'number',formatter:'number'}
            ],
            rowNum:10,
            autowidth: true,
            rowList:[10,20,30],
            pager: jQuery('#pager1'),
            sortname: 'ProductCategoryID',
            viewrecords: true,
            sortorder: "asc",
            caption: 'ฐานข้อมูลสินค้า',
            rownumbers:true, 
            height:'auto',
            editurl:'server.php',
        });

        jQuery("#list1").jqGrid('navGrid','#pager1',{edit:true,add:true,del:true,view:true,search:true,refresh:true});
    });
</script>

</head>
<body>
<table id="list1"></table>
<div id="pager1"></div>
</body>
</html> 
```

服务器.php

```
<?php
include "jq-config.php";
$page = $_GET['page']; // get the requested page
$limit = $_GET['rows']; // get how many rows we want to have into the grid
if($limit < 0) $limit = 10;
$sidx = $_GET['sidx']; // get index row - i.e. user click to sort
$sord = $_GET['sord']; // get the direction
if(!$sidx) $sidx =1;
// connect to the database
$db = mysql_connect($dbhost, $dbuser, $dbpassword)
or die("Connection Error: " . mysql_error());

mysql_select_db($database) or die("Error conecting to db.");
$result = mysql_query("SELECT COUNT(*) AS count FROM tb_product");
$row = mysql_fetch_array($result,MYSQL_ASSOC);
$count = $row['count'];

if( $count >0 ) {
    $total_pages = ceil($count/$limit);
} else {
    $total_pages = 0;
}
if ($page > $total_pages) $page=$total_pages;
$start = $limit*$page - $limit; // do not put $limit*($page - 1)
if($start <0)
{
    $start = 0;
}
$SQL = "SELECT * FROM tb_product ORDER BY $sidx $sord LIMIT $start , $limit";
$result = mysql_query( $SQL ) or die("Couldnt execute query.".mysql_error());

if ( stristr($_SERVER["HTTP_ACCEPT"],"application/xhtml+xml") ) {
header("Content-type: application/xhtml+xml;charset=utf-8"); } else {
header("Content-type: text/xml;charset=utf-8");
}
$et = ">";

echo "<?xml version='1.0' encoding='utf-8'?$et\n";
echo "<rows>";
echo "<page>".$page."</page>";
echo "<total>".$total_pages."</total>";
echo "<records>".$count."</records>";
// be sure to put text data in CDATA
while($row = mysql_fetch_array($result,MYSQL_ASSOC)) {
    echo "<row id='". $row[ProductCode]."'>";
    echo "<cell>". $row[ProductCode]."</cell>";

    $tmp = $row['ProductCategoryID'];
    $sql1 = "SELECT ProductCategoryName FROM tb_productcategory WHERE ProductCategoryID = '$tmp' ";
    $result1 = mysql_query($sql1) or die (mysql_error());
    list($ProductCategoryName) = mysql_fetch_row($result1);
    $tmp = $row['ProductBrandID'];
    $sql1 = "SELECT ProductBrandName FROM tb_productbrand WHERE ProductBrandID = '$tmp' ";
    $result1 = mysql_query($sql1) or die (mysql_error());
    list($ProductBrandName) = mysql_fetch_row($result1);

    echo "<cell><![CDATA[". $ProductCategoryName."]]></cell>";
    echo "<cell><![CDATA[". $ProductBrandName."]]></cell>";
    //echo "<cell>". $row[ProductCategoryID]."</cell>";
    //echo "<cell>". $row[ProductBrandID]."</cell>";
    echo "<cell><![CDATA[". $row[ProductDescription]."]]></cell>";
    echo "<cell><![CDATA[". $row[ProductOriginal]."]]></cell>";
    echo "<cell><![CDATA[". $row[ProductCompatible]."]]></cell>";
    echo "<cell>". $row[ProductDealerPrice]."</cell>";
    echo "</row>";
}
echo "</rows>";     

?> 
```

请帮忙，

谢谢，

星期一

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:58:02.710

这是 jqGrid 4.3.2 版本的第二个版本中的已知错误。您可以在[答案](http://www.trirand.com/blog/?page_id=393/bugs/jqgrid-4-3-2-bug-when-field-is-requried/#p26481)和[此处](http://www.trirand.com/blog/?page_id=393/bugs/this-isempty-is-not-a-function-bug-in-4-3-2/)阅读详细信息。这个问题现在已经在github上jqGrid的代码中修复了。因此，您可以`jquery.jqGrid.src.js`从[此处下载固定版本，也可以从](http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.3.2_/js/jquery.jqGrid.src-this.js)[github](https://github.com/tonytomov/jqGrid)下载最新版本的 jqGrid 。在最后一种情况下，您必须遵循描述如何使用 jqGrid 模块而不是一个或文件[的说明。](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ahow_to_install#development_installation)`jquery.jqGrid.src.js``jquery.jqGrid.min.js`

# java - Servlet.service() 抛出 NullPointerException

> ID：10677335
> 
> 赞同：1
> 
> 时间：2012-05-20T21:24:41.153
> 
> 标签：java, jsp, servlets, nullpointerexception

老实说，我很困惑为什么会抛出这个特殊的异常。如果我将 servlet 直接连接到另一个 JSP，它就可以正常工作。这是我得到的错误的堆栈跟踪

```
17:13:51,190 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/ProjectServlet].[jsp]] (http-localhost-127.0.0.1-8080-2) Servlet.service() for servlet jsp threw exception: java.lang.NullPointerException
    at org.apache.jsp.createProfile_jsp._jspService(createProfile_jsp.java:74)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) [jbossweb-7.0.13.Final.jar:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369) [jbossweb-7.0.13.Final.jar:]
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:326) [jbossweb-7.0.13.Final.jar:]
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:253) [jbossweb-7.0.13.Final.jar:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:840) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:622) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:560) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:488) [jbossweb-7.0.13.Final.jar:]
    at ecollaborator.Servlet.CreateAccountServlet.gotoPage(CreateAccountServlet.java:55) [classes:]
    at ecollaborator.Servlet.CreateAccountServlet.doPost(CreateAccountServlet.java:45) [classes:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:754) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.jpa.interceptor.WebNonTxEmCloserValve.invoke(WebNonTxEmCloserValve.java:50) [jboss-as-jpa-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0] 
```

现在，我有一个页面提示用户创建一个帐户，JSP 看起来像这样。它被称为 createAccount.jsp

```
 <%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>

<% String type = (String) request.getParameter("type");%>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<b><font size="6"><center>E-Collaborator</center></font></b>
</head>
<body>
<form name='createAccount' action="CreateAccountServlet" method="post">
    <table>
        <tr>
            <td>Create Account<td>
        </tr>
        <tr>
            <td>Username:</td><td><input type="text" name="username" /></td>
        </tr>
        <tr>
            <td>Password:</td><td><input type="password" name="password" /></td>
        </tr>
        <tr>
            <td>Type:</td>
            <td>
                <select id="acctype" name="acctype">
                <option></option>
                <option>Collaborator</option>
                <option>Consumer</option>
                <option>ServiceProvider</option>
                </select> 
            </td>
        </tr>
    </table>
    <input type="submit" value="Submit"/>
    <input type = "hidden" name="createAccount" value="true">
</form>
</body>
</html> 
```

它被转发到这个 Servlet，在 dispatcher.forward 命令的 gotoPage 方法中抛出错误。

```
package ecollaborator.Servlet;

import java.io.IOException;

import javax.ejb.EJB;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import ecollaborator.Entity.*;
import ecollaborator.Session.*;

@WebServlet("/CreateAccountServlet")
public class CreateAccountServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    @EJB
    private Admin admin;

    public CreateAccountServlet() {
        super();
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
        boolean isForwarded = false;

        String createAccount = request.getParameter("createAccount");
        if(createAccount != null && createAccount.equals("true"))
        {

            String username = (String)request.getParameter("username");
            String password = (String)request.getParameter("password");
            String type = (String)request.getParameter("acctype");

            User u = new User(username,password,type);
            admin.createAccount(u);

            if(!isForwarded)
            {
                request.setAttribute("type", type);
                isForwarded = gotoPage("/createProfile.jsp", request, response);
            }
        }

    }

    private boolean gotoPage(String address, HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException
        {
                RequestDispatcher dispatcher = getServletContext().getRequestDispatcher(address);
                dispatcher.forward(request, response);
                return true;
        }

} 
```

如何修复此代码，以避免遇到此错误？我的其他 servlet 使用相同的 gotoPage 函数并转发到 JSP 就好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:45:50.953

尝试在jsp中将**getParameter**替换为**getAttribute**

```
<% String type = (String) request.getAttribute("type");%> 
```

并删除行：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%> 
```

并检查

getParameter 和 getAttribute 是不同的方法

[http://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/1.6/api/javax/servlet/ServletRequest.html](http://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/1.6/api/javax/servlet/ServletRequest.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-03-25T03:17:11.113

在 viewpage.jsp jst 上检查迭代器引用 itr 是否已与具有迭代器方法的 ArrayList 对象关联 与 itr = al.iterator(); 一样

# unix - UNIX：使用 awk 命令过滤列表？

> ID：10677337
> 
> 赞同：1
> 
> 时间：2012-05-20T21:24:53.997
> 
> 标签：unix, permissions, awk

我想知道我正在使用的命令中的语法错误是什么。

在当前目录中，我使用命令`ls -l`检索目录中的文件权限。

我将如何进行查询以查看用户可读、可写和可执行的文件，然后使用 awk 打印过滤列表？

我知道我感兴趣的是第二个、第三个和第四个。

例如，

```
-rw-r----- .. .. .. .. 
```

或者

```
drw-r----- .. .. .. .. 
```

我有一个 awk 命令如下：

```
ls -l | awk '{if{$1 == /.rwx....../}print "line"}' 
```

我已经尝试了很多东西，但仍然存在语法错误。

任何帮助是极大的赞赏！提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:28:03.160

用于检查字符串是否与正则表达式匹配的运算符是`~`，不是`==`。此外，`()`围绕`if`语句中的条件使用：

```
ls -l | awk '{ if ($1 ~ /.rwx....../) print "line" }' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T04:59:12.267

我同意丹尼斯的观点；最好避免管道`ls`，如果你要做某事，你也可以正确地使用`stat`：

`stat -c '%A %N' * | awk '/^-rwx/ { print $2 }' | sed "s%^.\(.*\).$%\1%"`

或者只是在 awk 中：

`stat -c '%A %N' * | awk '/^-rwx/ { print substr ($2, 2, length ($2) - 2) }'`

**编辑：**

以上失败，文件包含空格（对不起）。这考虑了空格和换行符：

`stat -c '%A %N' * | awk '/^-rwx/ {print substr($0, 13, length($0) - 13) }'`

# asp.net-mvc - Telerik MVC Grid Master Detail Cascading Dropdowns

> ID：10677341
> 
> 赞同：5
> 
> 时间：2012-05-20T21:25:05.800
> 
> 标签：asp.net-mvc, telerik, telerik-grid, telerik-mvc

我在两个级别上使用主细节 Telerik MVC Grid。

*   第一级包含客户下拉列表和一些杂项数据。
*   第二级包含与第一级客户相关联的汽车下拉列表和一些杂项数据。

我现在使用外键列来显示汽车和客户的下拉列表。客户如何在第一级过滤第二个下拉列表？

代码：

```
@(Html.Telerik().Grid<Models.ClientsModel>()
        .Name("Grid")
        .ToolBar(commands => commands.Insert().ButtonType(GridButtonType.ImageAndText))
        .DataKeys(keys => keys.Add(c => c.ClientLineID))
        .Columns(columns =>
        {
            columns.ForeignKey(o => o.ClientID, (System.Collections.IEnumerable)ViewBag.Client, "ClientID", "Name")
                                                   .Width(330)
                                                   .Title("Client");
            columns.Command(commands =>
                {
                    commands.Edit().ButtonType(GridButtonType.ImageAndText);
                    commands.Delete().ButtonType(GridButtonType.ImageAndText);
                }).Width(250);
        })
        .DetailView(car => car.ClientTemplate(

            Html.Telerik().Grid<Delta.Models.CarModel>()
                        .Name("Car_<#= ClientID #>")
                        .DataKeys(keys => keys.Add(c => c.LineID))
                        .ToolBar(commands => commands.Insert().ButtonType(GridButtonType.ImageAndText))
                        .DataBinding(dataBinding =>
                        {
                            dataBinding.Ajax()
                                .Select("_CarLineIndex", "Client", new { id = "<#= ClientID #>" })
                                .Insert("_CarLineCreate", "Client", new { id = "<#= ClientID #>" })
                                .Update("_CarLineUpdate", "Client")
                                .Delete("_CarLineDelete", "Client");
                        })
                        .Columns(columns =>
                                {
                                    columns.ForeignKey(o => o.CarID, (System.Collections.IEnumerable)ViewBag.Cars,
                                    "CarID", "No")
                                                   .Width(500)
                                                   .Title("Car");
                                    columns.Command(commands =>
                                    {
                                        commands.Edit().ButtonType(GridButtonType.ImageAndText);
                                        commands.Delete().ButtonType(GridButtonType.ImageAndText);
                                    }).Width(200);
                                })
                        .Editable(editing => editing => editing.Mode(GridEditMode.InLine))
                        .Scrollable(c => c.Height("auto"))
                        .Resizable(resizing => resizing.Columns(true))
                        .Reorderable(reorder => reorder.Columns(true))
                        .KeyboardNavigation()
                        .Footer(false)
                        .ToHtmlString()
            ))
        .DataBinding(dataBinding =>
        {
            dataBinding.Ajax()
                .Select("_ClientIndex", "Client")
                .Insert("_ClientCreate", "Client")
                .Update("_ClientUpdate", "Client")
                .Delete("_ClientDelete", "Client");
        })
        .Scrollable(c => c.Height("auto"))
        .Editable(editing => editing.Mode(GridEditMode.InLine))
        .Pageable(o => o.PageSize(50))
        .Filterable()
        .KeyboardNavigation()
        .Groupable()) 
```

我在想代码可能涉及`OnDetailViewExpand`事件中的一些 javascript，但我不知道是什么。我现在唯一的解决方案是将网格拆分为单独的视图并在那里构建级联组合框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:49:13.900

不幸的是，我无法对帖子发表评论，以澄清有关您的问题的一些事实。我将在我的回答中做出一些假设，以便我们可以弄清楚问题的确切性质。您有两个模型类，每个网格 ClientsModel 和 CarModel 一个。您正在使用 ClientsModel（第一）网格中的字段过滤 CarModel（第二）网格。

您的选择绑定中不仅限于一个(<= ClientID =>) 参数。您可以像使用 ClientID 一样使用 ClientsModel 类中的其他字段。

示例代码：

```
dataBinding.Ajax().Select("_CarLineIndex", "Client", new { id = "<#= ClientID #>", city = "<#= City #>" }) 
```

这是一个带有模拟数据的工作示例，说明了上述方法：

客户端类

```
public class Client
{
    public int ClientId { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string City { get; set; }
} 
```

车类

```
public class Car
{
    public string Make { get; set; }
    public string Model { get; set; }
    public int Year { get; set; }
    public string Color { get; set; }
} 
```

家庭控制器

```
[GridAction]
public ActionResult _Index()
{
    Client c1 = new Client() { ClientId = 1, City = "Boston", FirstName = "Ted", LastName = "Boder" };
    Client c2 = new Client() { ClientId = 2, City = "New York", FirstName = "Chris", LastName = "Tobb" };
    Client[] clients = {c1, c2};
    return View(new GridModel(clients));
}

[GridAction]
public ActionResult _Cars(int ClientId, string City)
{
    Car c1 = new Car() { Color = "Yellow", Make = "Ford", Model = "Mustang", Year = 2012 };
    Car c2 = new Car() { Color = "Black", Make = "Toyota", Model = "Camry", Year = 2010 };
    Car[] cars = { c1, c2 };
    return View(new GridModel(cars));
} 
```

看法

```
@(Html.Telerik().Grid<Client>()
    .Name("Clients")
    .Columns(columns =>
    {
        columns.Bound(o => o.FirstName);
        columns.Bound(o => o.LastName);
        columns.Bound(o => o.City);
    })
    .DetailView(clientDetailView => clientDetailView.ClientTemplate(
         Html.Telerik().Grid<Car>()
         .Name("ClientDetails_<#= ClientId #>")
         .Columns(columns =>
         {
             columns.Bound(c => c.Make);
             columns.Bound(c => c.Model);
             columns.Bound(c => c.Year);
             columns.Bound(c => c.Color);
          })
          .DataBinding(db2 => db2.Ajax().Select("_Cars", "Home", new { ClientID = "<#= ClientId #>", City = "<#= City #>" }))
          .Pageable()
          .Sortable()
          .ToHtmlString()
    ))
    .DataBinding(db1 => db1.Ajax().Select("_Index", "Home"))
    .Pageable()
    .Sortable()
    .Filterable()
) 
```

从示例中可以看出，在绑定网格时，我还传递了 City 参数和 ClientId。

如果我错过了什么，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:58:01.370

您是正确的，您需要使用 javascript 来执行此操作，并且能够按客户过滤汽车是一个问题。Telerik 允许您使用“e.data”参数为其大多数控件添加其他参数。因此，例如，如果您想根据选择状态过滤城市列表，则 CSHTML 将如下所示：

```
<td valign="top">
        @(Html.Telerik().DropDownListFor(m => m.State)
        .Name("State")
        .ClientEvents(events => events.OnChange("State_Change"))
        .BindTo(new SelectList(Model.GetStates()))
         .HtmlAttributes(new { style = string.Format("width:{0}px", 160) })
     )
 </td>

 <td valign="top">
     @(Html.Telerik().AutoCompleteFor(m => m.City)
         .Name("City")
         .Encode(false)
         .ClientEvents(events => {
             events.OnDataBinding("City_AutoComplete");
     })
     .DataBinding(a => a.Ajax().Select("CityList", "Location"))
     .AutoFill(true)
     .HighlightFirstMatch(true)
     .HtmlAttributes(new { style = string.Format("height: 17px; width:{0}px", 250) })
     )
 </td> 
```

javascript 看起来像这样：

```
function City_AutoComplete(e) {
    //pass state as an additional parameter here to filter
    //this would be your customer for cars list
    e.data = $.extend({}, e.data, { state: $("#State").val() });
}

function State_Change(e) {
    //reset when the parent list selection changes
    $('#City').data('tAutoComplete').text('');
    $('#City').data('tAutoComplete').value('');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T12:11:55.720

Nothing to complex, create client event onEdit, you can found sample on telerik demo, than after once created client write down dropedown selection change event code that will filter data for you car dropdown. to do this I would suggest you to call ajax and insert HTml for dropdown. If you have still doubt than let me know I will explain it in detail. If you you really find this answer best or appropriate please vote it.. it will help...

# python - 将浮点数转换为逗号分隔的字符串

> ID：10677350
> 
> 赞同：13
> 
> 时间：2012-05-20T21:26:15.167
> 
> 标签：python

我如何将浮点数转换为它的“会计表格”——

```
100028282.23 --> 100,028,282.23
100028282 --> 100,028,282.00 
```

有没有这样做的python方法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-20T21:32:22.373

作为[beerbajay](https://stackoverflow.com/a/10677386/577088)出色答案的替代方法，简单的字符串格式在 2.7+ 中有效，无需导入：

```
>>> '{0:,.2f}'.format(24322.34)
'24,322.34' 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-20T21:30:36.763

您可以使用该[`locale.format()`](http://docs.python.org/library/locale.html#locale.format)功能来执行此操作：

```
>>> import locale
>>> locale.setlocale(locale.LC_ALL, 'en_US.utf8')
'en_US.utf8'
>>> locale.format("%.2f", 100028282.23, grouping=True)
'100,028,282.23' 
```

请注意，您必须给出精度：`%.2f`

或者，您可以使用[`locale.currency()`](http://docs.python.org/library/locale.html#locale.currency)以下[`LC_MONETARY`](http://docs.python.org/library/locale.html#locale.LC_MONETARY)设置的功能：

```
>>> locale.currency(100028282.23)
'$100028282.23' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-20T21:40:41.180

对于货币应用，*decimal*模块是浮点运算的不错选择。要使用逗号显示十进制浮点数，请参阅[*moneyfmt*](http://docs.python.org/library/decimal.html#recipes)配方：

```
def moneyfmt(value, places=2, curr='', sep=',', dp='.',
             pos='', neg='-', trailneg=''):
    """Convert Decimal to a money formatted string.

    places:  required number of places after the decimal point
    curr:    optional currency symbol before the sign (may be blank)
    sep:     optional grouping separator (comma, period, space, or blank)
    dp:      decimal point indicator (comma or period)
             only specify as blank when places is zero
    pos:     optional sign for positive numbers: '+', space or blank
    neg:     optional sign for negative numbers: '-', '(', space or blank
    trailneg:optional trailing minus indicator:  '-', ')', space or blank

    >>> d = Decimal('-1234567.8901')
    >>> moneyfmt(d, curr='$')
    '-$1,234,567.89'
    >>> moneyfmt(d, places=0, sep='.', dp='', neg='', trailneg='-')
    '1.234.568-'
    >>> moneyfmt(d, curr='$', neg='(', trailneg=')')
    '($1,234,567.89)'
    >>> moneyfmt(Decimal(123456789), sep=' ')
    '123 456 789.00'
    >>> moneyfmt(Decimal('-0.02'), neg='<', trailneg='>')
    '<0.02>'

    """
    q = Decimal(10) ** -places      # 2 places --> '0.01'
    sign, digits, exp = value.quantize(q).as_tuple()
    result = []
    digits = map(str, digits)
    build, next = result.append, digits.pop
    if sign:
        build(trailneg)
    for i in range(places):
        build(next() if digits else '0')
    build(dp)
    if not digits:
        build('0')
    i = 0
    while digits:
        build(next())
        i += 1
        if i == 3 and digits:
            i = 0
            build(sep)
    build(curr)
    build(neg if sign else pos)
    return ''.join(reversed(result)) 
```

# android - Android图像不切换

> ID：10677351
> 
> 赞同：0
> 
> 时间：2012-05-20T21:26:56.953
> 
> 标签：android, menu, imageswitcher

我正在研究一段可以使用 Menu inflater 切换图像的代码，我已经研究过代码，但是一旦我单击按钮，它就会给我强制关闭错误。这是我的代码：

```
@Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // TODO Auto-generated method stub
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.menu, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        // TODO Auto-generated method stub
        switch (item.getItemId()) {
        case R.id.cameraa:
            Toast.makeText(this, "Start Camera!", Toast.LENGTH_LONG).show();
            break;

        case R.id.gallery:
         Toast.makeText(this, "this is gallery!", Toast.LENGTH_LONG).show();
        break;

    public boolean onOptionsItemSelected(MenuItem item) {
        // TODO Auto-generated method stub
        switch (item.getItemId()) {

    case R.id.ghost_gallery:
            switcher.showNext();
break
            }
            return true;
        } 
```

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
 <ViewSwitcher
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" >

        <FrameLayout
            android:id="@+id/frame"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

        <ImageView
            android:id="@+id/imageView"
            android:layout_width="fill_parent"
            android:layout_height="match_parent"
            android:scaleType="matrix"
            android:src="@drawable/banana" />
        </FrameLayout>

        <FrameLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

        <ImageView
            android:id="@+id/imageView"
            android:layout_width="fill_parent"
            android:layout_height="match_parent"
            android:scaleType="matrix"
            android:src="@drawable/apple" />
        </FrameLayout>
    </ViewSwitcher> 
```

这是我的日志

```
05-21 03:19:35.733: E/AndroidRuntime(758): FATAL EXCEPTION: main
05-21 03:19:35.733: E/AndroidRuntime(758): java.lang.NullPointerException
05-21 03:19:35.733: E/AndroidRuntime(758):  at org.example.touch.Touch.nextView(Touch.java:188)
05-21 03:19:35.733: E/AndroidRuntime(758):  at org.example.touch.Touch.onOptionsItemSelected(Touch.java:180)
05-21 03:19:35.733: E/AndroidRuntime(758):  at android.app.Activity.onMenuItemSelected(Activity.java:2195)
05-21 03:19:35.733: E/AndroidRuntime(758):  at com.android.internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:730)
05-21 03:19:35.733: E/AndroidRuntime(758):  at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:143)
05-21 03:19:35.733: E/AndroidRuntime(758):  at com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:855)
05-21 03:19:35.733: E/AndroidRuntime(758):  at com.android.internal.view.menu.IconMenuView.invokeItem(IconMenuView.java:532)
05-21 03:19:35.733: E/AndroidRuntime(758):  at com.android.internal.view.menu.IconMenuItemView.performClick(IconMenuItemView.java:122)
05-21 03:19:35.733: E/AndroidRuntime(758):  at android.view.View$PerformClick.run(View.java:8816)
05-21 03:19:35.733: E/AndroidRuntime(758):  at android.os.Handler.handleCallback(Handler.java:587)
05-21 03:19:35.733: E/AndroidRuntime(758):  at android.os.Handler.dispatchMessage(Handler.java:92)
05-21 03:19:35.733: E/AndroidRuntime(758):  at android.os.Looper.loop(Looper.java:123)
05-21 03:19:35.733: E/AndroidRuntime(758):  at android.app.ActivityThread.main(ActivityThread.java:4627)
05-21 03:19:35.733: E/AndroidRuntime(758):  at java.lang.reflect.Method.invokeNative(Native Method)
05-21 03:19:35.733: E/AndroidRuntime(758):  at java.lang.reflect.Method.invoke(Method.java:521)
05-21 03:19:35.733: E/AndroidRuntime(758):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-21 03:19:35.733: E/AndroidRuntime(758):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-21 03:19:35.733: E/AndroidRuntime(758):  at dalvik.system.NativeStart.main(Native Method) 
```

请就此事帮助我....最好的问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:37:48.203

嗯，这很简单：`switcher`是`null`. 这是意料之中的，因为它甚至在布局中都没有 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:39:46.883

您是否在 onCreate() 中初始化切换器？

你需要在布局中给它一个 id：

```
android:id="@+id/switcher_view" 
```

在任何方法之外声明 ViewSwitcher 作为切换器：

```
private ViewSwitcher switcher; 
```

然后像这样初始化它（在 onCreate() 中）：

```
switcher = (ViewSwitcher) findViewById(R.id.switcher_view); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T21:41:23.997

你没有给你`ViewSwitcher`的身份证。而且您还需要`findViewById`在其他代码中使用它来引用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T23:51:40.270

我用了

```
private void showImage() {

        Toast.makeText(Touch.this, " User don't  ", Toast.LENGTH_SHORT);
        ImageView imgView = (ImageView) findViewById(R.id.imageView);
        imgView.setImageResource(mImageIds[image_index]);

    }

    @Override
    public void onClick(View v) {

        switch (v.getId()) {

        case (R.id.previous_btn):

            image_index--;

            if (image_index == -1) {
                image_index = MAX_IMAGE_COUNT - 1;
            }

            showImage();
            break;
}} 
```

这对我来说效果很好......

# php - 为什么 Facebook PHP SDK logouturl 实际上没有将用户注销？

> ID：10677353
> 
> 赞同：0
> 
> 时间：2012-05-20T21:27:08.600
> 
> 标签：php, facebook, facebook-graph-api

我正在使用 Facebook PHP sdk，在用户登录后，我使用 $facebook->getLogoutUrl() 显示注销 URL 的链接。

但是当用户单击该链接时，它似乎转到 Facebook 并重定向回我的主 index.php，此时用户似乎仍然已登录，因为 $facebook->getUser(); 返回一个有效的用户。

我如何真正完全注销用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:36:50.013

getLogoutUrl 方法返回一个 URL，当用户单击该 URL 时，会将其从 Facebook 会话中注销，然后将它们重定向回您的应用程序。

理想情况下，在用户注销后，用户将被重定向回应用程序但 `$facebook->getUser();`返回 0。

**[这](https://developers.facebook.com/docs/reference/php/facebook-getLogoutUrl/)**应该可以帮助你。

**编辑：**

最好的方法是使用类似下面的东西

```
$logoutParams = array(
'next'  =>  'http://your-site/your-application/after_logout.php'
); 
```

并销毁会话`session_destroy();`

# android - 在我的应用程序中实现类似 Vlingo 应用程序的用户界面？

> ID：10677356
> 
> 赞同：0
> 
> 时间：2012-05-20T21:27:10.533
> 
> 标签：android, xml, android-layout

我想设计一个 UI，我将在其中显示大量文本内容，然后显示一个按钮。用户可以向下滚动文本内容，但按钮应始终保持在屏幕底部可见。android 市场上可用的 Vlingo 应用程序使用类似的 UI，如下图所示：

![在此处输入图像描述](../Images/7ed4bc59a3954d1c2192d42c8e07e52f.png) ![在此处输入图像描述](../Images/5e891097ac2d78bcde5c6d2b9195892b.png)

我曾尝试将文本内容放在 scrollView 和 scrollView 之外的按钮中，但这样做按钮会切断屏幕。这是我尝试过的 XML 布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="wrap_content">
<ScrollView
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/background" >

    <RelativeLayout
        android:id="@+id/relativeLayout1"
        android:layout_width="match_parent"
        android:layout_height="300dp" >

        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="@string/message"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />           
        <TextView
            android:id="@+id/txtMsg1"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_below="@+id/txtMsgHd"
            android:text="@string/main_ex_msg1" />

    </RelativeLayout>
    </ScrollView>
    <RelativeLayout
        android:id="@+id/relativeLayout2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <Button
            android:id="@+id/btnSpeak"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:text="@string/speak_now" />

        </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:43:53.120

我会考虑使用列表视图来执行此操作，而不是使用具有大量文本视图等的滚动，但是为了回答问题，如果您要做的只是使滚动视图不重叠或向下推按钮我会做如下的事情

注意：必须删除任何资源引用，所以有点乱，但你应该明白

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
<ScrollView
android:layout_width="match_parent"
android:layout_height="match_parent" android:layout_above="@+id/btnSpeak">
        <LinearLayout android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="vertical">
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg A"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />       
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg B"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />           
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg C"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />    
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg D"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />     
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg E"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />    
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg F"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />   
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg A"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />       
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg B"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />           
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg C"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />    
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg D"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />     
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg E"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />    
        <TextView
            android:id="@+id/txtMsgHd"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="20dp"
            android:text="Msg F"
            android:layout_marginRight="10dp"                                
            android:textAppearance="?android:attr/textAppearanceLarge" />                           
        <TextView
            android:id="@+id/txtMsg1"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_below="@+id/txtMsgHd"
            android:text="Msg 1" />
        </LinearLayout>
</ScrollView>

<Button
        android:id="@+id/btnSpeak"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:text="Speak Now" />

</RelativeLayout> 
```

# python - python 检查.getargspect

> ID：10677358
> 
> 赞同：0
> 
> 时间：2012-05-20T21:27:16.867
> 
> 标签：python, module, inspect

导入一个模块，然后通过模块的命名空间查找任何函数（您可以假设任何具有**call** () 方法的对象都是一个函数）并打印函数的名称及其参数，就像它可能出现在def 语句。

我的问题是在我遍历模块并获得所有函数后，我无法将函数名称传递给 inspect.getfullargspec() 因为它是一个字符串。如何使字符串可调用？

```
import inspect
from smtplib import SMTP
from pprint import pprint
def func(x):     
    for item in inspect.getmembers(x):
         lst = inspect.getmembers(x, inspect.isfunction)
         for items in lst:
              func_names = items[0] #names of functions               
              f = r"%s.%s" % (x.__name__, func_names)
              arg = inspect.getargspec(f)
              print(f)

if __name__ == '__main__':
     func(SMTP) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:58:24.130

你在这方面有一些错误。不过，快速的答案是您不想让字符串可调用，您只需要知道它`inspect.getmembers`返回一个`('func_name', <function object>)`对列表，并`inspect.getargspec`期望一个函数对象。

所以你可以让你的 for 循环看起来像这样：

```
for name, fun in lst:
    long_name = r"%s.%s" % (x.__name__, name)
    argspec = inspect.getargspec(fun)
    print(long_name) 
```

作为一个单独的问题，您的变量名称大多是非描述性的，有时是不正确的。例如，您所调用`func_names`的始终是*一个*名称，而变量`lst`命名为 更有用`members`，`item`应该是`member`。命名一个函数`func`通常不是好的做法，特别是当该函数需要其中的多个变量时，更合适的是，命名为`func`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-25T18:41:01.287

lst 这里是一个函数名和函数对象的元组，你真的不需要做所有的字符串操作。下面的简单方法将完成这项工作：

```
def func(module):
    for lst in inspect.getmembers(module, inspect.isfunction):
        if inspect.isfunction(lst[1]):# Doing an additional check, may not be actually required
            print(lst[0]+inspect.formatargspec(*inspect.getfullargspec(lst[1]))) 
```

# c# - 奇怪的修剪问题

> ID：10677359
> 
> 赞同：1
> 
> 时间：2012-05-20T21:27:17.183
> 
> 标签：c#, .net, winforms, io

我这里有一个奇怪的修剪问题。我有一个大约 500、000 行单词的 txt 文件。但是每一行都以 1), 2), 3)... 等开头。但这里的问题是 1) 和单词之间不只有一个空格，通常有多个空格，有时甚至在1），就像，就在行的开头。

我不确定如何才能删除在实际单词之前开始的所有内容。但我 100% 确定在第一个单词之前*总是有一个空格。*

我怎么能这样修剪呢？

任何帮助表示赞赏。

谢谢！

*例子：*

文本文件.txt：

```
1) Awesome stuff here 
2) wow 
3) ldfjg ldfk gjldfkg jldfk gjldfkg this line is to be kept too 
4   ) and this too! this is great content 
5 ) gotta love content 
6) content is ok..
   7     ) this is a little odd. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:32:33.387

最简单的函数是 TrimStart ：

```
 string cleaned = line.TrimStart(' ',')','1','2','3','4','5','6','7','8','9','0'); 
```

它与您的所有样品相匹配，并且易于适应。

# ios - 核心动画 iOS 4 与 iOS 5

> ID：10677365
> 
> 赞同：1
> 
> 时间：2012-05-20T21:28:04.290
> 
> 标签：ios, ios4, core-animation, calayer, changelog

这些天我一直在不停地发布 Core Animation 问题，这个 API 非常令人困惑。

我有一些代码可以使用以下方法为图层的锚点设置动画：

```
 animation.fromValue     = fromValue;
        animation.toValue       = offsetToValue;
        animation.duration      = [duration doubleValue];
        animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
        //update the model
        [subLayer setValue:offsetToValue forKeyPath:keyPath];

        [subLayer addAnimation:animation forKey:keyPath]; 
```

这在 iOS 5（真实设备和模拟器）和 Mac 10.7 上按预期动画。但是，在 iOS 4.3（iPad 模拟器，没有 iOS 4 iPad）上运行此代码时，不会执行锚点动画。锚点在没有任何动画的情况下发生变化。

我对此感到困惑，我完全不知道如何解决这个问题！我尝试搜索更改日志、已知问题等。但运气不好。

请指教我现在该怎么办？

**编辑：**

忘了提一下，使用此代码为变换和位置设置动画适用于 iOS4 和 iOS5（！！）

**编辑：**

抱歉，我意识到我的问题是含蓄的。我有一个必须支持 iOS4.0+ 的 iOS 应用程序。如果我只支持 iOS5，我什至不会关心这个问题。

# ios - Cocos2d .isTouchEnabled 不调用单点触控方法

> ID：10677366
> 
> 赞同：0
> 
> 时间：2012-05-20T21:28:07.193
> 
> 标签：ios, cocos2d-iphone

在 Cocos2d 中，当通过 using 启用触摸时`self.isTouchEnabled`，我可以使用这样的方法：

```
-(void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
```

但是，由于某种原因，这个不起作用：

```
-(void)ccTouchEnded:(UITouch *)touch withEvent:(UIEvent *)event 
```

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:11:37.923

我没有看到你的代码所以我不知道但你注册了吗

```
 CCTouchDispatcher 
```

如何注册 ：

```
 [[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:self priority:0 swallowsTouches:YES]; 
```

如何注销/删除以节省内存：

```
[[CCTouchDispatcher sharedDispatcher] removeDelegate:self]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:13:46.390

阅读有关触摸事件的文档。一切都在那里解释， [http://www.cocos2d-iphone.org/wiki/doku.php/tips:touchdelegates](http://www.cocos2d-iphone.org/wiki/doku.php/tips:touchdelegates)

# javascript - 将 var 设置为单击的按钮值并使用 var

> ID：10677374
> 
> 赞同：1
> 
> 时间：2012-05-20T21:29:29.987
> 
> 标签：javascript, jquery

我将 var x 的值设置为单击按钮的值。然后我想使用 var x 作为我的 jquery 动画代码中的值。

```
var x = $('input').click(function() {
    $(this).val();
});

$("li").click(function() {
    $(this)
        .stop()
        .animate(
            {height:'150px'},
            {queue:false, duration:600, easing: x }
        );
});

$("li").mouseout(function() {  
    $(this)
        .stop()
        .animate(
            {height:'50px'},
            {queue:false, duration:600, easing: x });
});​ 
```

我究竟做错了什么 ？演示：http: [//jsfiddle.net/EnigmaMaster/z9dXA/7/](http://jsfiddle.net/EnigmaMaster/z9dXA/7/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:33:32.643

## *[演示 jsFiddle](http://jsfiddle.net/3AA6s/2/)*

```
var x = '';    // define your var (make it re-usable inside functions)

$('input').click(function() {
   x = $(this).val();   // set your var'x' value for use.
});

$("li").click(function() {   
    $(this).stop().animate({height:150},{queue:false, duration:600, easing: x });
});

$("li").mouseout(function(){  
    $(this).stop().animate({height:50},{queue:false, duration:600, easing: x });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T21:32:47.130

点击是异步的。像这样做：

```
var x;
$('input').click(function() {
    x = $(this).val();
}); 
```

见小提琴：http: [//jsfiddle.net/z9dXA/8/](http://jsfiddle.net/z9dXA/8/)

这仅在顺便说一下 li 之前单击输入时才有效，否则 x 将没有值。也许提供一个默认值，例如：

```
var x = 'swing';
$('input').click(function() {
    x = $(this).val();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:36:15.090

您当前设置`x`为等于返回的 jQuery 对象`$("input")`。该方法设置了一个*稍后*`.click()`将调用的单击处理程序（当单击发生时），因此它不会在单击时返回值 - 它返回相同的 jQuery 对象，以便您可以将多个 jQuery 方法链接在一起. 这就是你展示的原因。*`$("input")``alert(y)``[object Object]`*

 *尝试将第一位更改为：

```
var x = "linear";  // give x a default value

$('input').click(function() {
    x = $(this).val();  // store the type of easing to be used
}); 
```

然后你实际上不需要`y`变量，你可以直接使用`x`：

```
$("li").click(function() {
    $(this).stop().animate({ height: '150px' }, {
        queue: false,
        duration: 600,
        easing: x
    });
});

$("li").mouseout(function() {
    $(this).stop().animate({ height: '50px'}, {
        queue: false,
        duration: 600,
        easing: x
    });
});​ 
```

更新演示：http: [//jsfiddle.net/z9dXA/9/](http://jsfiddle.net/z9dXA/9/)*

# 3d - 在搅拌机中或从 .obj / .3ds 文件创建 .ase (ASCII EXPORT) 文件

> ID：10677380
> 
> 赞同：0
> 
> 时间：2012-05-20T21:29:51.267
> 
> 标签：3d, blender, .obj, 3ds

我有一个解析 .ase 文件的代码，但我找到的所有模型都是 .obg/.blender/.3ds 格式。

我找不到将它们相互翻译的方法，怎么可能呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:38:36.657

我不特别处理 .ase 文件，但我从不同的对象格式做了很多翻译。我在 Blender 上取得了最大的成功。快速的谷歌搜索会产生一个用于导入/导出 .ase 文件的插件。我还没有测试过它，但我想这是一个很好的起点。将 .obj/.3ds/etc 导入搅拌机后，您可以导出为 .ase 格式。

[http://www.katsbits.com/smforum/index.php?topic=147.0](http://www.katsbits.com/smforum/index.php?topic=147.0)

# css - 如何在-webkit-transform上添加颜色？

> ID：10677381
> 
> 赞同：0
> 
> 时间：2012-05-20T21:29:52.247
> 
> 标签：css, sencha-touch, sencha-touch-2, sencha-architect

我正在尝试添加颜色或背景颜色，`-webkit-transform:rotate(45deg) skew(5deg);`但我没有尝试。请帮我。

我有 Sencha Touch 的代码：

```
.x-checkmark-base,.x-item-selected .x-list-selected:before,.x-item-selected .x-list-selected:after,.x-field .x-input-radio:after,.x-field .x-input-checkbox:after,.x-field .x-input-radio:checked:after,.x-field .x-input-checkbox:checked:after {
    content:"";
    position:absolute;
    width:0.75em;
    height:1.25em;
    top:50%;
    left:auto;
    **-webkit-transform:rotate(45deg) skew(5deg);**
    -webkit-transform-origin:50% 50%;
    right:1.1em;
    border:.35em solid;
    border-top:none;
    border-left:none;
    margin-top:-0.75em;
    **background: green;**
} 
```

**如何更改复选框/收音机的颜色？**

下一张图片显示

![在此处输入图像描述](../Images/ef1d1f2db5b75e443d391b682d561f0c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T11:25:49.830

使用边框颜色而不是背景。

```
border-color: green; 
```

# graph - 使用 Hadoop/MapReduce 查找连接的组件

> ID：10677388
> 
> 赞同：10
> 
> 时间：2012-05-20T21:30:50.547
> 
> 标签：graph, hadoop, mapreduce, social-networking, graph-algorithm

我需要为庞大的数据集找到连接的组件。（图是无向的）

一个明显的选择是 MapReduce。但我是 MapReduce 的新手，我很安静，没有时间去学习它并自己编写代码。

我只是想知道是否有任何现有的 API，因为它是社交网络分析中非常常见的问题？

或者至少如果有人知道任何可靠的（经过试验和测试的）来源，我至少可以自己开始实施？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T07:57:18.457

我为自己写了一篇博客：

[http://codingwiththomas.blogspot.de/2011/04/graph-exploration-with-hadoop-mapreduce.html](http://codingwiththomas.blogspot.de/2011/04/graph-exploration-with-hadoop-mapreduce.html)

但是 MapReduce 不太适合这些 Graph 分析的东西。最好使用 BSP（批量同步并行），Apache Hama 在 Hadoop HDFS 之上提供了一个很好的图形 API。

我在这里用 MapReduce 编写了一个连接组件算法：（Mindist search）

[https://github.com/thomasjungblut/tjungblut-graph/tree/master/src/de/jungblut/graph/mapreduce](https://github.com/thomasjungblut/tjungblut-graph/tree/master/src/de/jungblut/graph/mapreduce)

也可以在这里找到 Apache Hama 的 BSP 版本：

[https://github.com/thomasjungblut/tjungblut-graph/blob/master/src/de/jungblut/graph/bsp/MindistSearch.java](https://github.com/thomasjungblut/tjungblut-graph/blob/master/src/de/jungblut/graph/bsp/MindistSearch.java)

实现并不像在 MapReduce 中那么困难，而且速度至少快 10 倍。如果您有兴趣，请查看 TRUNK 中的最新版本并访问我们的邮件列表。

[http://hama.apache.org/](http://hama.apache.org/)

[http://apache.org/hama/mail-lists.html](http://apache.org/hama/mail-lists.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T00:15:57.690

我真的不知道是否有可用的 API 具有查找强连接组件的方法。但是，我实现了 BFS 算法来查找图中从源节点到所有其他节点的距离（该图是一个有 6500 万个节点的有向图）。

这个想法是在一次迭代中探索每个节点的邻居（距离为 1），并将 reduce 的输出反馈给 map，直到距离收敛。map 发出与每个节点可能的最短距离，并 reduce 更新与列表距离最短的节点。

我建议检查[一下](http://www.johnandcailin.com/blog/cailin/breadth-first-graph-search-using-iterative-map-reduce-algorithm)。此外，[这可能会有所帮助](http://blog.piccolboni.info/2010/07/map-reduce-algorithm-for-connected.html)。这两个链接将为您提供有关 map reduce 范式中图算法的基本概念（如果您还不熟悉）。本质上，您需要扭曲算法以使用 DFS 而不是 BFS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-08T21:25:49.383

您可能想查看卡内基梅隆大学的[Pegasus 项目。](http://www.cs.cmu.edu/%7Epegasus/index.htm)它们使用 MapReduce 提供了高效且优雅的实现。他们还提供二进制文件、示例和非常详细的文档。

该实现本身基于 U Kang 在 2009 年提出的广义迭代矩阵向量乘法 (GIM-V)。

> [PEGASUS: A Peta-Scale Graph Mining System](http://www.cs.cmu.edu/%7Eukang/papers/PegasusICDM2009.pdf) - 实施和观察 U Kang、Charalampos E. Tsourakakis、Christos Faloutsos 在 IEEE 国际数据挖掘会议 (ICDM 2009)

编辑：官方实现实际上仅限于 21 亿个节点（节点 ID 存储为整数）。我正在 github ( [https://github.com/placeiq/pegasus](https://github.com/placeiq/pegasus) ) 上创建一个 fork 来分享我的补丁和其他增强功能（例如 Snappy 压缩）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-04T19:53:40.203

这是一个有点老的问题，但这里有一些你想检查的东西。我们在 Spark 平台上使用 map-reduce 实现了连接组件。

[https://github.com/kwartile/connected-component](https://github.com/kwartile/connected-component)

# xml - XML 数据表示与关系模型的优缺点

> ID：10677389
> 
> 赞同：0
> 
> 时间：2012-05-20T21:30:59.503
> 
> 标签：xml, database, relational-database

嗨，我正在准备考试，我被这个困住了

与关系模型相比，XML 数据表示的优缺点是什么？

也许那是允许一个层次结构很容易地表示。

它更具人类可读性

所需的字段和表格数量之多令人难以置信，几乎所有都是可选的。例如，并非所有小说都有恶棍，但恶棍属性或标签很容易添加到 xml 文档中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:41:03.357

XML 的优势是： 层次结构 可读格式 开源解析器和查看器 无需行结构即可轻松表示数据

关系表的强度：SQL - 复杂的查询，XML 是不可比拟的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T08:10:35.563

关系结构针对数据库存储和查询进行了优化；XML 模型针对数据交换进行了优化。

关系模型针对结构化数据进行了优化；XML 模型针对文本进行了优化。

# c++ - 如何制作此构造函数的深层副本？

> ID：10677394
> 
> 赞同：3
> 
> 时间：2012-05-20T21:31:40.537
> 
> 标签：c++, copy-constructor

我制作了这个构造函数，我需要对其进行深层复制。我真的不明白深拷贝的含义。我知道它会生成具有自己动态内存的对象的独立副本，但我不明白对此有何需求。我也不确定如何实际实现深拷贝。有什么建议么？

这是我需要对其进行深度复制的构造函数： 任何人都可以提供一些语法帮助，例如骨架吗？

```
template<class t_type>
inline ALIST<t_type>::ALIST()
{
  t_type value;
  capacity=10;  
  DB = new t_type[capacity];
  count=capacity;

  cout<<"Enter value: ";
  cin.clear();
  cin>>value;

  for(int i=0; i<capacity; i++)
  {
    DB[i]=value;
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:35:02.390

[什么是复制和交换成语？](https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom)

使用深层副本，以便您可以复制对象拥有的所有信息，然后在不更改原始文件的情况下更改副本。广义上讲，浅拷贝只会复制指针本身，但仍然指向相同的信息。如果您不小心，这可能会导致数据发生意外更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T21:39:26.260

仔细阅读 Stroustrup 的[演示](http://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CFgQFjAA&url=http://www.stroustrup.com/Programming/18_arrays.ppt&ei=JmO5T8f2E4_rrQfptMH3Bw&usg=AFQjCNF0yUlrhFKqy2DNHNldVLco1o9WnQ)幻灯片 #14 和 #15

> 深拷贝：复制指针及其指向的内容，这样两个指针现在都指向一个不同的对象
> 
> *   什么向量，字符串等做什么
> *   需要容器类的复制构造函数和复制赋值

基本上，这归结为：*正确*、*有效*和*安全地*管理您的指针。您可能还想查看[复制和交换](http://en.wikibooks.org/wiki/More_C++_Idioms/Copy-and-swap)习语和 Sutter 的 GOTW 文章，内容涉及[**异常安全类设计**](http://www.gotw.ca/gotw/059.htm)、[异常安全](http://www.gotw.ca/gotw/082.htm)和[异常安全函数调用](http://herbsutter.com/gotw/_102/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:51:01.160

可以从游戏中给出一个例子。假设您有一个策略游戏，敌方士兵具有个人属性，例如盔甲、生命值等。假设游戏从文本文件中读取这些属性，并在每次创建敌方士兵时分配这些属性。而不是一次又一次地从文本文件中读取所有信息或将文本文件保存在内存中，这通常比它的对象形式大，有一个原型对象池，它们是在加载阶段从同一个文本文件创建的，可能是更好的解决方案。当需要一个敌方士兵时，您可以通过将原型对象传递给新对象的构造函数或以工厂模式从原型对象创建它。在构造函数（或工厂类）中，您肯定需要深拷贝并小心，

# c# - 如何处理路径太长/重复的解压缩 ZipFile

> ID：10677405
> 
> 赞同：10
> 
> 时间：2012-05-20T21:33:30.420
> 
> 标签：c#, zipfile, dotnetzip

在 Windows 中解压缩文件时，我偶尔会遇到路径问题

1.  对于 Windows 来说太长了（但在创建文件的原始操作系统中还可以）。
2.  由于不区分大小写而“重复”

使用 DotNetZip 时，`ZipFile.Read(path)`只要读取存在这些问题之一的 zip 文件，调用就会出错。这意味着我什至无法尝试将其过滤掉。

```
using (ZipFile zip = ZipFile.Read(path))
{
    ...
} 
```

处理读取此类文件的最佳方法是什么？

*更新：*

此处的示例 zip： [https ://github.com/MonoReports/MonoReports/zipball/master](https://github.com/MonoReports/MonoReports/zipball/master)

重复： [https](https://github.com/MonoReports/MonoReports/tree/master/src/MonoReports.Model/DataSourceType.cs) ://github.com/MonoReports/MonoReports/tree/master/src/MonoReports.Model/DataSourceType.cs https://github.com/MonoReports/MonoReports/tree/master/src/MonoReports.Model/DatasourceType 。CS

以下是有关异常的更多详细信息：

> Ionic.Zip.ZipException：无法将其读取为 ZipFile
> ---> System.ArgumentException：已添加具有相同键的 > 项。
> 在 System.ThrowHelper.ThrowArgumentException(ExceptionResource 资源)
> 在 System.Collections.Generic.Dictionary 2.Add(TKey key, TValue value) 在 Ionic.Zip.ZipFile.ReadCentralDirectory(ZipFile zf) 在 Ionic.Zip.ZipFile.ReadIntoInstance(ZipFile zf) `2.Insert(TKey key, TValue value, Boolean add)
> at System.Collections.Generic.Dictionary`

**解析度：**

根据@Cheeso 的建议，我可以从流中读取所有内容，避免重复和路径问题：

```
//using (ZipFile zip = ZipFile.Read(path))
using (ZipInputStream stream = new ZipInputStream(path))
{
    ZipEntry e;
    while( (e = stream.GetNextEntry()) != null )
    //foreach( ZipEntry e in zip)
    {
        if (e.FileName.ToLower().EndsWith(".cs") ||
            e.FileName.ToLower().EndsWith(".xaml"))
        {
            //var ms = new MemoryStream();
            //e.Extract(ms);
            var sr = new StreamReader(stream);
            {
                //ms.Position = 0;
                CodeFiles.Add(new CodeFile() { Content = sr.ReadToEnd(), FileName = e.FileName });
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-02-05T02:28:38.207

对于这个`PathTooLongException`问题，我发现你不能使用[DotNetZip](http://dotnetzip.codeplex.com/)。相反，我所做的是调用[7-zip 的命令行版本](http://www.7-zip.org/a/7za920.zip)；这很有效。

```
public static void Extract(string zipPath, string extractPath)
{
    try
    {
        ProcessStartInfo processStartInfo = new ProcessStartInfo
        {
            WindowStyle = ProcessWindowStyle.Hidden,
            FileName = Path.GetFullPath(@"7za.exe"),
            Arguments = "x \"" + zipPath + "\" -o\"" + extractPath + "\""
        };
        Process process = Process.Start(processStartInfo);
        process.WaitForExit();
        if (process.ExitCode != 0) 
        {
            Console.WriteLine("Error extracting {0}.", extractPath);
        }
    }
    catch (Exception e)
    {
        Console.WriteLine("Error extracting {0}: {1}", extractPath, e.Message);
        throw;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T00:32:12.290

阅读它`ZipInputStream`。

该类`ZipFile`使用文件名作为索引来保存一个集合。重复的文件名会破坏该模型。

但是您可以使用`ZipInputStream`来读取您的`ZipFile`. 在这种情况下，没有集合或索引。

# java - 如何判断一个对象在java中外部扩展了什么

> ID：10677406
> 
> 赞同：1
> 
> 时间：2012-05-20T21:33:31.517
> 
> 标签：java, inheritance, object, extend

您好，我需要知道是否有办法找出对象在 Java 中扩展的内容。

```
public void function(Obj obj)
{
    // ... 
```

有没有办法找出 obj 扩展了什么？或者如果它扩展了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:38:20.980

我假设你的意思是你想找出这个对象是哪个类的实例。在这种情况下，您可以简单地使用`Object.getClass()`. 如果您需要查找对象类的超类，您也`Class.getSuperclass()`可以随意使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T21:38:51.203

# 寻找超类：

```
YourClass.class.getSuperclass() 
```

或（当有 的实例时`YourClass`）：

```
yourClass.getClass().getSuperclass() 
```

# 查找给定类/对象实现了哪些接口

```
YourClass.class.getInterfaces() 
```

或（同上）：

```
yourClass.getClass().getInterfaces() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:34:12.733

Object 是 Java 中所有类的绝对“超类”。对象不扩展任何其他类。

# facebook - 我们可以通过在代码中提供电子邮件和密码来获取 Facebook 访问令牌吗？

> ID：10677409
> 
> 赞同：1
> 
> 时间：2012-05-20T21:33:44.367
> 
> 标签：facebook, oauth-2.0, access-token, facebook-authentication

我想从这张专辑中获取照片网址：

[https://graph.facebook.com/175758929145317/photos](https://graph.facebook.com/175758929145317/photos)

如果您在不提供访问令牌的情况下访问它，那么您将获得空数据：

```
{
   "data": [

   ]
} 
```

但是，如果您首先在此处生成访问令牌：

[http://developers.facebook.com/tools/explorer?method=GET&path=175758929145317%2Fphotos](http://developers.facebook.com/tools/explorer?method=GET&path=175758929145317%2Fphotos)

然后你像这样将它附加到 url，你可以得到数据：

[https://graph.facebook.com/175758929145317/photos?access_token=your_access_token](https://graph.facebook.com/175758929145317/photos?access_token=your_access_token)

但是，此访问令牌不能永远使用，它会过期。

我想从[https://graph.facebook.com/175758929145317/photos](https://graph.facebook.com/175758929145317/photos)动态获取照片网址并在网页上显示图像，查看此网页的人不需要拥有 facebook 帐户。

因此，每次查看网页时，我都在考虑是否可以简单地使用我的 facebook 帐户登录（通过硬编码电子邮件和密码），然后获取新的访问令牌，以便我可以获得照片 url。

这可能吗？或者我的问题有更好的解决方案吗？（我不能要求专辑所有者将他的专辑更改为公开）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:16:41.293

这是不可能的，您无法使用硬编码（或存储的）登录名/密码在 FB 中进行身份验证 - 根据[Facebook 政策](https://developers.facebook.com/policy/)：

> **一、特点和功能**
> 
> ...
> 
> 3 - 您不得包含代理、请求或收集 Facebook 用户名或密码的功能。

你可以做什么：

1.  为自己获取（然后扩展）令牌（参见本文档中的场景 4：[https](https://developers.facebook.com/roadmap/offline-access-removal/) ://developers.facebook.com/roadmap/offline-access-removal/ ）。该扩展令牌应该可以使用 60 天，然后您[可以再次扩展它](https://stackoverflow.com/questions/10654960/whats-the-purpose-of-renewable-access-tokens/10658009#10658009)。

2.  尝试使用 APPLICATION 令牌获取这些照片 - 如果它有效，那么令牌永远是好的： [https ://developers.facebook.com/docs/authentication/applications/](https://developers.facebook.com/docs/authentication/applications/)

# symfony - 如何在 Symfony2 中测试基于子域的路由

> ID：10677422
> 
> 赞同：6
> 
> 时间：2012-05-20T21:35:49.503
> 
> 标签：symfony, phpunit, functional-testing

我有一个使用子域路由到代理的应用程序：

```
foo.domain.dev -> Agency:showAction(foo)
bar.domain.dev -> Agency:showAction(bar)
domain.dev     -> Agency:indexAction() 
```

这些每个对应于一个代理实体和控制器。

我有一个监听器，它监听 onDomainParse 事件并将子域写入请求属性。

```
/**
* Listens for on domainParse event
* Writes to request attributes
*/
class SubdomainListener {
   public function onDomainParse(Event $event)
   {
       $request = $event->getRequest();
       $session = $request->getSession();
       // Split the host name into tokens
       $tokens = $this->tokenizeHost($request->getHost());

       if (isset($tokens['subdomain'])){
           $request->attributes->set('_subdomain',$tokens['subdomain']);
       }

   }
   //...
 } 
```

然后我在控制器中使用它来重新路由到显示操作：

```
class AgencyController extends Controller
{

    /**
     * Lists all Agency entities.
     *
     */
    public function indexAction()
    {
        // We reroute to show action here.
        $subdomain = $this->getRequest()
                        ->attributes
                        ->get('_subdomain');
        if ($subdomain)
            return $this->showAction($subdomain);

        $em = $this->getDoctrine()->getEntityManager();

        $agencies = $em->getRepository('NordRvisnCoreBundle:Agency')->findAll();

        return $this->render('NordRvisnCoreBundle:Agency:index.html.twig', array(
            'agencies' => $agencies
        ));
    }
    // ...

} 
```

**我的问题是：**

使用 WebTestCase 进行测试时如何伪造这个？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-20T21:50:19.447

通过覆盖请求的 HTTP 标头来访问子域并测试正确的页面：

*未经测试，可能包含错误*

```
class AgencyControllerTest extends WebTestCase
{
    public function testShowFoo()
    {
        $client = static::createClient();

        $crawler = $client->request('GET', '/', array(), array(), array(
            'HTTP_HOST'       => 'foo.domain.dev',
            'HTTP_USER_AGENT' => 'Symfony/2.0',
        ));

        $this->assertGreaterThan(0, $crawler->filter('html:contains("Text of foo domain")')->count());
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-10-23T09:13:40.230

基于基于主机路由的 Symfony 文档，[测试您的控制器](http://symfony.com/doc/current/components/routing/hostname_pattern.html#testing-your-controllers)：

```
$crawler = $client->request(
    'GET',
    '/',
    array(),
    array(),
    array('HTTP_HOST' => 'foo.domain.dev')
); 
```

如果您不想用数组参数填充所有请求，这可能会更好：

```
$client->setServerParameter('HTTP_HOST', 'foo.domain.dev');
$crawler = $client->request('GET', '/');

...

$crawler2 = $client->request('GET', /foo'); // still sends the HTTP_HOST 
```

`setServerParameters()`如果您有一些参数要更改，客户端上还有一个方法。

# html - 如何将多个 CSS 径向渐变应用于单个元素

> ID：10677429
> 
> 赞同：6
> 
> 时间：2012-05-20T21:36:25.693
> 
> 标签：html, css, radial-gradients

我将以下样式应用于我的`div`元素：

```
background-image: -moz-radial-gradient(50% -10%, ellipse closest-corner, rgba(5, 5, 5, 0.7), rgba(0, 0, 0, 0) 100%); 
```

这具有预期的效果（仅在顶部的内部阴影`div`）。我想在底部应用相同的效果`div`。以下行做得很好，但它似乎覆盖了第一行，所以我只能得到一个或另一个。

```
background-image: -moz-radial-gradient(50% 110%, ellipse closest-corner, rgba(5, 5, 5, 0.7), rgba(0, 0, 0, 0) 100%); 
```

有人可以告诉我如何为每个元素设置多个径向渐变背景吗？我注意到 webkit 可以很容易地做到这一点，但我正在寻找一个跨浏览器实现/替代方案。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:41:40.977

只需用逗号分隔每个。

像这样的东西：

```
background-image: url(),url(), url(); 
```

当然，您可以放置​​渐变而不是 url。

并且所有现代浏览器都支持此功能（意味着 IE 不支持）。

为了使其在 IE 中可用，您可以使用[pie.htc](http://css3pie.com)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-20T21:49:31.160

您只需一个接一个地列出它们 - 就像这样：

```
background: radial-gradient(top left, 
            rgb(205, 230, 235) 34%, 
            transparent 34%), 
        radial-gradient(center, 
            rgb(205, 230, 235) 34%, 
            transparent 34%); 
```

[您可以在http://dabblet.com/gist/2759668](http://dabblet.com/gist/2759668)看到它的工作原理

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-08-13T11:06:32.410

最好的方法是在`background`属性中列出它们。但请记住，属性的顺序非常重要。

```
background:
    radial-gradient(circle at top left, transparent 15px, #58a 0) top left,
    radial-gradient(circle at top right, transparent 15px, #58a 0) top right,
    radial-gradient(circle at bottom right, transparent 15px, #58a 0) bottom right,
    radial-gradient(circle at bottom left, transparent 15px, #58a 0) bottom left;
background-size: 50% 50%;
background-repeat: no-repeat; 
```

background 然后 -size 和 -repeat，否则它将不起作用。我花了大约 30 分钟才拿到它。希望它对某人有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-30T11:20:02.253

您必须将径向渐变的值设置为透明才能让其他背景通过：

```
 background-image: radial-gradient(closest-corner at 40% 70%,#FFFFFF 0%, rgb(171,171,171),50%,transparent),
                     radial-gradient(closest-corner circle at 80% 20%, #FFFFFF 0%, rgb(171,171,171),20%,transparent),
                     radial-gradient(closest-corner circle at 10% 10%, #FFFFFF 0%,rgb(171,171,171) 25%); 
```

# c - 合作工具组：C语言编码

> ID：10677433
> 
> 赞同：1
> 
> 时间：2012-05-20T21:37:11.207
> 
> 标签：c, codepad

是否有任何工具，类似于键盘，用 C 语言编写代码，我可以与小组共享我的代码，我的小组可以在实时编辑中进行更改和同时查看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-09T00:01:02.273

很抱歉复活了一个老问题，但我想我应该分享这个。

我通常使用**Collab.Center** **( [http://collab.center](http://collab.center) )**。我比其他人更喜欢它的一些功能是：

*   在线、实时协作编码
*   支持多种语言（我认为是 40 多种）（例如：C、C++、Java、HTML/CSS/JS、PHP 等）
*   文本和视频（网络摄像头）聊天（需要登录）
*   语法高亮、自动关闭括号、匹配括号等。
*   能够管理您的所有文档（需要登录）
*   私人文件（需要登录）

如果您还没有找到替代方案，我认为这对您和您的团队来说会很棒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T21:40:41.197

如果您打算将其用于代码审查以外的任何事情，我无法告诉您这将使您的工作更加困难。但是，它被称为实时协作编辑器。有很多。不久前我在 linux 上使用过一个，我不记得它的名字了，但与此同时，让维基百科让你开始......

[http://en.wikipedia.org/wiki/Collaborative_real-time_editor](http://en.wikipedia.org/wiki/Collaborative_real-time_editor)

编辑：

我在 Linux 上使用的运行良好的工具叫做[*Gobby*](http://gobby.0x539.de/trac/)。

这个问题中还有很多其他[关于协作编码的实时工具](https://stackoverflow.com/questions/8028358/real-time-tool-for-collaborative-coding)

# ruby-on-rails - 是否可以在 erb 模板中要求一个类？

> ID：10677435
> 
> 赞同：6
> 
> 时间：2012-05-20T21:37:41.603
> 
> 标签：ruby-on-rails, templates, erb, require

我有一个需要使用的 erb 模板：

> CGI.unescapeHTML(someEscapedHTML)

所以我需要'cgi'，但是以下失败：

```
<% require 'cgi' %> 
```

出现错误：

> 不能复制 NilClass

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:42:17.710

我个人*永远不会*在视图中添加 require 语句，因为 1）它很丑 2）如果另一个视图需要那个 require 怎么办？

一个更好的地方是在`config/application.rb`底部，或者在`config/initializers`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T21:45:05.357

首先，请不要在 ERB 中使用 gems 或库。然后 Rails 本身已经需要 CGI。

如果您想防止 Rails 3 自动转义，请考虑使用

`<%= data.html_safe %>`

反而。

# php - php 无法检查 PDO 结果是否为空，使用 empty() 返回 FATAL ERROR

> ID：10677438
> 
> 赞同：14
> 
> 时间：2012-05-20T21:38:06.453
> 
> 标签：php, pdo, fatal-error

我想检查我准备好的查询是否返回空，而不必进入循环。这是我尝试使用的代码：

```
if(empty($pQuery1->fetch(PDO::FETCH_ASSOC))){} 
```

当我尝试这个时，我得到了错误：

`Fatal error: Can't use method return value in write context`

无论我使用`PDO->fetchALL`还是`PDO->fetch`收到相同的错误。我应该做一些不同的事情吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-20T21:40:02.757

您需要将结果分配给一个变量，然后调用`empty()`该变量。这只是`empty()`功能的一个令人讨厌的限制。看到[这个](https://stackoverflow.com/questions/1075534/cant-use-method-return-value-in-write-context)问题。

```
$results = $pQuery1->fetch(PDO::FETCH_ASSOC);
if (empty($results)){} 
```

# sql-server-2008 - 如何在 Microsoft Server Management Studio 中设置数据库的编码？

> ID：10677441
> 
> 赞同：0
> 
> 时间：2012-05-20T21:38:23.577
> 
> 标签：sql-server-2008

如何在 Microsoft Server Management Studio 中设置数据库的编码？

我需要将 utf8 设置为我的数据库，但在数据库设置中找不到选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:43:08.530

它取自这里[如何设置数据库默认编码？](https://stackoverflow.com/questions/1680073/how-do-i-set-database-default-encoding)

假设通过编码您的意思是排序规则，您可以更改新数据库的默认值，例如：

```
alter database model collate SQL_Latin1_General_CP1_CI_AS 
```

更改现有数据库的排序规则：

```
alter database YourDbName collate SQL_Latin1_General_CP1_CI_AS 
```

可用排序规则列表由系统函数返回：

```
select * from fn_helpcollations() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T08:47:59.710

您不能将 UTF8 编码设置为 SQL Server 数据库。

您可以使用 char/varchar 数据类型来保存字符 - 一个字符 = 一个字节 - 但这也意味着您只能保存有限的字符（请参阅排序规则）。

您可以使用 nchar/nvarchar 数据类型来保存字符 - 一个字符 = 两个字节（它的 UCS-2。用于排序、搜索……参见排序规则）。

最后在 varbinary 列中，您可以存储 UTF8 或任何您需要的内容:)。

# php - while循环后结果为空

> ID：10677446
> 
> 赞同：-4
> 
> 时间：2012-05-20T21:39:20.020
> 
> 标签：php, mysql

为什么这是不可能的？有什么办法可以让resolut不为空吗？

```
$sqlAllInfo = "SELECT item1, item2 FROM example";
$resAllInfo = mysql_query($sqlAllInfo);

while($rowAllInfo = mysql_fetch_assoc($resAllInfo)){

    echo $rowAllInfo['item1'];

}

$rowAllInfo = mysql_fetch_assoc($resAllInfo);

echo $rowAllinfo['item2']; 
```

谢谢你的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:49:38.277

这一行：

```
while($rowAllInfo = mysql_fetch_assoc($resAllInfo)){ 
```

分配一个新值`rowAllInfo`，然后检查它是否仍然是“真”-ish（因为 PHP 可以是“真”;-)）

现在，在获取最后一行之后，`mysql_fetch_assoc()`将返回 false，然后将其分配给 $rowAllInfo。由于 $rowAllInfo 现在为“假”，循环将不再执行，但是 - 看 - 为时已晚！您的变量已经具有`false`分配给它的值。

即使在那之后，你`mysql_fetch_assoc()`再次打电话。但是，由于您已经获取了循环中的所有行，因此不再剩下行，并且再次`$rowAllInfo`设置为“false”。

所以，无论你想做什么——这可能不是你的方式。实现我理解您正在尝试做的事情的常见方法如下：

```
$allRows = array();
while( $row = mysql_fetch_assoc($res) ) {
    $allRows[] = $row;
}

// show the array we just created...
echo print_r( $arrRows, 1 ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T21:43:09.370

不，在您的 while 循环之后结果将始终为空，因为 while 循环从结果资源中提取所有值..
当仍有信息要提取时，while 循环将继续循环，并在它为空或出现错误时完成如果您要获取最后一个条目，则会发生

$rowAllInfo 仍然包含最后一个条目；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-20T21:43:27.700

您正在使用 循环遍历结果集，`while` **直到没有更多结果为止**。返回`while`时循环退出，因为没有更多结果。再次调用仍然意味着没有更多结果。`mysql_fetch_assoc``false``mysql_fetch_assoc`

# colors - 是否可以使用 rgY 颜色空间？

> ID：10677452
> 
> 赞同：1
> 
> 时间：2012-05-20T21:40:22.670
> 
> 标签：colors, rgb, color-space

是否可以采用 rgY 颜色空间：

```
r = R / (R + G + B)
g = G / (R + G + B)
Y = R * 0.299 + G * 0.587 + B * 0.114
(unnecessary) b = 1 - r - g 
```

并将其转换回RGB？如果是这样，它会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T13:35:12.633

（这个答案中没有阶乘。语法类似于 Wolfram-Alpha 纯文本输出标准，例外是空格放置在 != [not equals] 符号之前和之后，并使用 'if [conditional] then' 语句。 )

*   如果 r = 0 和 473 g+114 != 0 和 Y != 0 那么
    *   R = 0 且 G = (1000 g Y)/(473 g+114) 且 B = -(1000 (g-1) Y)/(473 g+114)
*   如果 Y = 0 且 g = 1/473 (-185 r-114) 且 r != 0 那么
    *   G = -((185 r+114) R)/(473 r) 和 B = ((587-288 r) R)/(473 r) 和 R!=0
*   如果 Y = 0 且 r = 0 且 g = -114/473 则
    *   R = 0 且 B = -(587 G)/114 且 G!=0
*   如果 473 g+185 r+114 != 0 和 r != 0 和 r Y != 0
    *   R = (1000 r Y)/(473 g+185 r+114) 和 G = (1000 g Y)/(473 g+185 r+114) 和 B = -(1000 Y (g+r-1)) /（473克+185转+114）

# python - 是否有与 wx.FutureCall 等效的 PyQT（在窗口初始化和绘制后调用函数）？

> ID：10677462
> 
> 赞同：7
> 
> 时间：2012-05-20T21:41:50.177
> 
> 标签：python, qt, qt4, pyqt

我试图在打开主窗口后延迟设置变量。我试过 showEvent() 但这不起作用。我知道在 wxPython 中有 wx.FutureCall 方法可以在这种情况下使用：

```
class MyFrame(wx.Frame): 

 def __init__(..frame init parms.., ..your init parms..): 
   wx.Frame.__init__(..frame init parms..) 
   self.Show() 
   wx.FutureCall(500,self.OnLoad)   #1/2 seconds from now to call OnLoad() 

 def OnLoad(self, ..your init parms..): 
   ..your init code.. 
   self.Refresh() 
```

我的问题是：在我的 PyQT 主窗口进行初始化并最终显示后，如何延迟执行某些操作？我怎样才能做到这一点：

```
class MyWindow(QtGui.QMainWindow):
  def __init__(self,parent=None):

    QtGui.QWidget.__init__(self,parent)

    ... init stuff here...

    self.FutureCall(500,self.OnLoad)

  def OnLoad(self,event):
    ... my stuff here... 
```

提前致谢！-保罗

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-20T21:57:09.033

我不知道为什么`showEvent`不适合你。对我来说，它按预期工作。它在显示窗口后触发。

对于延迟通话，您可以使用`QTimer.singleShot`：

```
class MyWindow(QtGui.QMainWindow):
  def __init__(self, parent=None):

    QtGui.QWidget.__init__(self, parent)

    ... init stuff here...

    QtCore.QTimer.singleShot(500, self.OnLoad)

  def OnLoad(self):
    ... my stuff here... 
```

# node.js - 使用 process.on 侦听消息时停止 node.js 进程退出

> ID：10677463
> 
> 赞同：2
> 
> 时间：2012-05-20T21:41:57.983
> 
> 标签：node.js, messaging

以下简单的脚本立即退出：

```
process.on('message', function () { }); 
```

在侦听消息时保持 node.js 进程运行的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T04:09:20.720

您总是可以这样做`process.stdin.resume();`，这将使您的进程保持打开状态，直到在标准输入上收到 EOF 或您明确退出（标准输入流最初会暂停以防止这种情况发生，除非您真的想要它）。

# php - PHP Header() 重定向在重定向到新 URI 之前简要显示旧 URI

> ID：10677464
> 
> 赞同：0
> 
> 时间：2012-05-20T21:42:13.750
> 
> 标签：php, redirect, http-headers

现在，我正在使用自定义 PHP 解决方案来强制将 WWW 附加到我的脚本 URL，因为我使用 WordPress 的 .htaccess 规则来“清理” index.php。强制 WWW .htaccess 规则与 WordPress 的 index.php 清理规则不兼容。

使用我的脚本，您可以浏览到“http://scripturl.com/whatever”——然后我的脚本有一个请求 URI“/whatever”的案例，然后为该视图执行一些操作（或编译相应的模板）。

在调用任何开关之前，我添加了一系列检查，以确保来自 REQUEST 的 HTTP 主机与来自我脚本中定义的变量的 HTTP 主机匹配。这会强制添加“www”。

我的问题 - 是（似乎只使用 IE 时） - 当我输入一个 url 时，说“http://myscript.com/whatever”，我的脚本将 url 转换为“http://www.myscript.com/whatever "，正如预期的那样，然后将标头重定向到新的 URL。但是，如果我将 URI 请求从“whatever”更改为“somethingelse”，页面会按预期转到“http://www.myscript.com/somethingelse”，但在短时间内，“whatever”会在 url 中闪烁在脚本重定向到“http://www.myscript.com/somethingelse”之前。

澄清：从请求“www.myscript.com/sam”开始。请求负载。将 /sam 更改为 /bob -> 页面更改为“www.myscript.com/bob”，但在 /bob 加载之前，“/sam”会在 url 栏中短暂闪烁。

它只是感觉不“干净”。我觉得我的代码可能会进行额外的标题跳转或其他操作。我将其与 wordpress 进行了对比，转到“www.wordpressurl.com/valid-page”，然后将 URI 更改为“www.wordpressurl.com/another-valid-page” - 我*没有*看到“/valid-页面”在尝试访问“/another-valid-page”时在 URL 栏中闪烁，反之亦然。

这是我的代码：

```
// Requested URL built from url in address bar
$requested_url  = is_ssl() ? 'https://' : 'http://';
$requested_url .= $_SERVER['HTTP_HOST'];
$requested_url .= $_SERVER['REQUEST_URI'];

// Correct url built from predefined variable
$correct_url = is_ssl() ? 'https://' : 'http://';

// "Correct" script url
$user_home = @parse_url('http://www.myscript.com');

if ( !empty($user_home['host']) )
  $correct_url .= $user_home['host'];
else {
  die('malformed url');
}

$correct_url .= $_SERVER['REQUEST_URI'];

// If URL in address bar is not proper, perform redirect (preserve URI)
if ($correct_url != $requested_url) {
  hc_redirect($correct_url, 301);
}

// Get page from request, handle accordingly
$page = $_SERVER['REQUEST_URI'];
switch ($page) {
  /* Index */
  case '/':
    echo "Index queried <br />";

    break;
    ... 
```

为什么在加载新 URI（来自重定向）之前旧 URI 在导航栏中闪烁？就像我说的，这似乎只发生在 IE 中 - 但 WordPress 没有这种相同的行为（在 IE 或任何其他浏览器中），所以我知道我的代码肯定有问题，这是一个“额外的步骤”，没有发生我的知识。我对 PHP 有点陌生。

有什么想法吗？

编辑：hc_redirect 和其他使用的函数：[http ://pastebin.com/fVNEckEg](http://pastebin.com/fVNEckEg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:51:27.137

重定向后，您的脚本继续输出数据，浏览器等待数据，然后才重定向。如果您在发送重定向标头后不需要继续执行脚本，请停止执行脚本。例如：

```
// If URL in address bar is not proper, perform redirect (preserve URI)
if ($correct_url != $requested_url) {
    hc_redirect($correct_url, 301);
    die();
} 
```

# c# - C# HttpWebRequest 无效的 URI

> ID：10677470
> 
> 赞同：-1
> 
> 时间：2012-05-20T21:42:30.300
> 
> 标签：c#, youtube, httpwebrequest

运行此代码时出现以下错误：“HttpWebRequest URI 无效，URI 为空”

```
CookieContainer cookieContainer = new CookieContainer();
HttpWebRequest PreRequest = (HttpWebRequest)WebRequest.Create("https://www.google.com/accounts/ServiceLogin?utm_source=/places&utm_medium=van&utm_campaign=en&continue=http://www.google.com/local/add/businessCenter%3Fservice%3Dlbc%26gl%3DUS%26hl%3Den-US&service=lbc&hl=en-US&gl=US");
PreRequest.CookieContainer = cookieContainer;
PreRequest.AllowAutoRedirect = true;
HttpWebResponse PreResponse = (HttpWebResponse)PreRequest.GetResponse();
Stream PreResponseStream = PreResponse.GetResponseStream();
PreResponse.Cookies = PreRequest.CookieContainer.GetCookies(PreRequest.RequestUri);
Encoding PreEnc = System.Text.Encoding.UTF8;
StreamReader PreResponseStreamReader = new StreamReader(PreResponse.GetResponseStream(), PreEnc, true);
String PreMyHTML = PreResponseStreamReader.ReadToEnd();

String Pattern = "name=\"GALX\"[\\s]*value=\"([a-zA-Z0-9-_\\.]*)\"";
Match MyMatch = Regex.Match(PreMyHTML, Pattern);
String GALX = MyMatch.Groups[1].ToString();

HttpWebRequest Request = (HttpWebRequest)WebRequest.Create("https://www.google.com/accounts/ServiceLoginAuth?service=lbc&ltmpl=sso&continue=http%3A%2F%2Fwww.google.com%2Flocal%2Fadd%2FbusinessCenter%3Fservice%3Dlbc%26gl%3DUS%26hl%3Den-US&service=lbc&uilel=3&ltmpl=sso&hl=en_US&ltmpl=sso&GALX=" + GALX + "&Email=" + user + "&Passwd=YOURACCOUNTPASSWORD&rmShown=1&signIn=Sign+in&asts=");
Request.CookieContainer = cookieContainer;
Request.Method = "POST";
Request.Referer = "https://www.google.com/accounts/ServiceLogin?utm_source=/places&utm_medium=van&utm_campaign=en&continue=http://www.google.com/local/add/businessCenter%3Fservice%3Dlbc%26gl%3DUS%26hl%3Den-US&service=lbc&hl=en-US&gl=US";
Request.MaximumAutomaticRedirections = 50;
Request.AllowAutoRedirect = true;
Request.KeepAlive = true;
Request.ContentLength = 0;

// Get the response
HttpWebResponse Response = (HttpWebResponse)Request.GetResponse();

Stream ResponseStream = Response.GetResponseStream();
Response.Cookies = Request.CookieContainer.GetCookies(Request.RequestUri);

// Read the response from the stream
Encoding Enc = System.Text.Encoding.UTF8;
StreamReader ResponseStreamReader = new StreamReader(Response.GetResponseStream(), Enc, true);

String MyHTML = ResponseStreamReader.ReadToEnd();
//textBox2.Text = MyHTML;

String Pattern2 = "location\\.replace\\(\"(http:\\/\\/www\\.youtube\\.com\\/signin[a-zA-Z0-9\\\\\\?\\%_-]*)\"\\)";
Match MyMatch2 = Regex.Match(MyHTML, Pattern2);
String YTRedirect = MyMatch2.Groups[1].ToString();
String Temp = YTRedirect.Replace("\\x3d", "=");
String Temp2 = Temp.Replace("\\x26", "&");
YTRedirect = Temp2;

HttpWebRequest PosterRequest = (HttpWebRequest)WebRequest.Create(YTRedirect);
PosterRequest.CookieContainer = cookieContainer;
PosterRequest.Method = "GET";
HttpWebResponse PosterResponse = (HttpWebResponse)PosterRequest.GetResponse();
Stream PosterResponseStream = PosterResponse.GetResponseStream();
PosterResponse.Cookies = PosterRequest.CookieContainer.GetCookies(PosterRequest.RequestUri);
Encoding PosterEnc = System.Text.Encoding.UTF8;
StreamReader PosterResponseStreamReader = new StreamReader(PosterResponse.GetResponseStream(), PosterEnc, true);
String PosterMyHTML = PosterResponseStreamReader.ReadToEnd();

HttpWebRequest PostestRequest = (HttpWebRequest)WebRequest.Create(textBox4.Text);
PostestRequest.CookieContainer = cookieContainer;
PostestRequest.Method = "GET";
HttpWebResponse PostestResponse = (HttpWebResponse)PostestRequest.GetResponse();
Stream PostestResponseStream = PostestResponse.GetResponseStream();
PostestResponse.Cookies = PostestRequest.CookieContainer.GetCookies(PostestRequest.RequestUri);
Encoding PostestEnc = System.Text.Encoding.UTF8;
StreamReader PostestResponseStreamReader = new StreamReader(PostestResponse.GetResponseStream(), PostestEnc, true);
String PostestMyHTML = PostestResponseStreamReader.ReadToEnd(); 
```

我正在尝试登录并观看视频，看到点赞或发表评论的方式也会很有趣，感谢帮助！

编辑：错误发生在 HttpWebRequest PosterRequest = (HttpWebRequest)WebRequest.Create(YTRedirect);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T22:06:39.577

从该代码中很难分辨，但也许请仔细检查以下内容中包含的内容`textBox4.Text`：

`HttpWebRequest PostestRequest = (HttpWebRequest)WebRequest.Create(textBox4.Text);`

只是在没有堆栈痕迹的情况下在黑暗中拍摄。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:13:42.790

我还没有阅读任何代码，但是从它的声音来看，请确保在 url 之前包含“http://”。

# c# - 如何使用 geonames API 获取城市名称？

> ID：10677471
> 
> 赞同：1
> 
> 时间：2012-05-20T21:42:31.470
> 
> 标签：c#, xml, windows-phone-7, geonames

如何使用他们的 API 搜索地名并获取城市名称和坐标？链接到他们的[API](http://www.geonames.org/export/geonames-search.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T02:48:40.080

当然，这完全取决于您要执行的实际搜索。假设您要查找英国所有以 . 开头的位置`Lon`。将执行此搜索的 URL（例如，实际搜索可能会发生很大变化）是：

```
http://api.geonames.org/search?name_startsWith=lon&country=GB&maxRows=10&username=demo 
```

您可以在浏览器中弹出它并查看结果：

```
<geonames style="MEDIUM">
<totalResultsCount>334</totalResultsCount>
<geoname>
    <toponymName>London</toponymName>
    <name>London</name>
    <lat>51.50853</lat>
    <lng>-0.12574</lng>
    <geonameId>2643743</geonameId>
    <countryCode>GB</countryCode>
    <countryName>United Kingdom</countryName>
    <fcl>P</fcl>
    <fcode>PPLC</fcode>
</geoname>
<geoname>
    <toponymName>Lone</toponymName>
    <name>Lone</name>
    <lat>58.33333</lat>
    <lng>-4.88333</lng>
    <geonameId>2643732</geonameId>
    <countryCode>GB</countryCode>
    <countryName>United Kingdom</countryName>
    <fcl>P</fcl>
    <fcode>PPL</fcode>
</geoname>
<!-- and so on ... -->
</geonames> 
```

请注意，您需要每个`lat`和`lng`下的元素`geoname`。使用 LINQ to XML（包括`System.Linq`并`System.Linq.Xml`在您的命名空间声明中）：

```
var xml = XElement.Load("http://api.geonames.org/search?name_startsWith=lon&country=GB&maxRows=10&username=demo");

var locations = xml.Descendants("geoname").Select(g => new { 
                    Name = g.Element("name").Value, 
                    Lat = g.Element("lat").Value, 
                    Long = g.Element("lng").Value
                });

foreach (var location in locations)
{
    Console.WriteLine("{0}: {1}, {2}", location.Name, location.Lat, location.Long);
} 
```

当然，您可以选择以不同的方式使用这些值，并且您可能希望将其解析`Lat`为`Long`双精度值。

# ios - UITextField 目标/操作与委托方法

> ID：10677474
> 
> 赞同：2
> 
> 时间：2012-05-20T21:43:22.193
> 
> 标签：ios, delegates, uitextfield, target-action, rubymotion

我曾经使用 XCode 开发我的应用程序并使用它；我可以在 IB/Storyboard 中创建一个链接来合成这些方法：

```
- (void)addTarget:(id)target action:(SEL)action forControlEvents: (UIControlEvents)controlEvents 
```

什么时候

但是，不，我是以编程方式完成的（在 ruby​​motion 中，虽然不一定相关）并查看 UITextField 的文档，我发现了一些委托方法，我实现如下：

```
def textFieldShouldReturn(text_field)
  text_field.resignFirstResponder
end

def textFieldShouldEndEditing(text_field)
  # this is for validations; don't set a first responder here
  true
end

def textFieldDidEndEditing(text_field)
  text_field == @email_field ? @password_field.becomeFirstResponder : delegate.validate_login_info
end 
```

但是使用这个，我发现我无法像以前使用 addTarget 方法那样通过输入字段（我有两个；电子邮件和密码）。

这两种方法有什么区别？前者是否在幕后实现了后者？我不明白为什么一个会允许我通过标签，而另一个不会。我只是在幕后实现了与目标/动作方法不同的委托方法吗？

反馈赞赏，pachun

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:46:33.753

这与目标/动作无关。我假设您的意思是在 Interface Builder 中，您将从 HUD 中拖动`UITextField`并`File's Owner`选择委托。

执行上述操作会产生分配 textField 的委托的效果，您需要在这样的代码中执行此操作

```
@email_field.delegate    = self
@password_field.delegate = self 
```

以上假设创建`UITextField`'s 的类将充当它们的代表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:48:50.113

在这种情况下，我不知道委派和目标/动作之间是否有任何区别，但是使用委派这种方式有效：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    if (textField == self.firstTextField)
    {
        [self.secondTextField becomeFirstResponder];
    }
    else if (textField == self.secondTextField)
    {
        [textField resignFirstResponder];
        // proceed with login
    }
    return YES;
}

- (BOOL)textFieldShouldEndEditing:(UITextField *)textField
{
    // Validation
    return YES;
} 
```

问候

# c - 如何以编程方式在 gtk 文本缓冲区中选择文本（主要选择）

> ID：10677476
> 
> 赞同：2
> 
> 时间：2012-05-20T21:43:36.433
> 
> 标签：c, gtk, gtksourceview

我正在使用 gtk+-2.0 & gtksourceview-2.0 编写文本编辑器。我无法找到一种以编程方式选择文本块并将其添加到操作系统（linux）主选择剪贴板的方法。就像我用鼠标突出显示一个文本块或按住 shift 键并用箭头键选择文本一样。

我在“gtk_text_buffer_get_selection_bound()”下的 devhelp 中找到了语句：

缓冲区中当前选定的文本是“selection_bound”和“insert”标记之间的区域。

**编辑：** gtk_text_buffer_select_range()，设置这两个标记的位置。

以下代码块（使用文本迭代器开始和结束指定的区域）复制到主选择剪贴板（根据需要）：

```
 gtk_text_buffer_select_range (tbuffer, &start, &end); 
            GtkClipboard *cb = gtk_clipboard_get(GDK_SELECTION_PRIMARY);
            gtk_text_buffer_copy_clipboard (tbuffer,cb); 
```

谢谢你的想法！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:43:52.293

也许您应该尝试[gtk_editable_copy_clipboard ()](http://developer.gnome.org/gtk/stable/GtkEditable.html#gtk-editable-copy-clipboard)。该文档说“将当前选定内容的内容复制到可编辑内容中并将其放在剪贴板上”。然后使用[gtk_editable_paste_clipboard()](http://developer.gnome.org/gtk/stable/GtkEditable.html#gtk-editable-paste-clipboard)进行粘贴，它“将剪贴板的内容粘贴到可编辑中光标的当前位置”。

# sql - 如何打开/编辑 .sdb 文件

> ID：10677478
> 
> 赞同：2
> 
> 时间：2012-05-20T21:43:49.870
> 
> 标签：sql, database, sqlite

我有一个需要打开的 .sdb 数据库文件。它是 Song Pro (http://creationsoftware.com/) 背后的数据库。

谷歌似乎认为 openoffice 可能能够打开这个，因为它可能来自 star office。但我无法说服文件在 Base 3.2 中打开，并且没有可靠的说明，因为大多数谷歌结果都是扩展定义类型。

最初，我可以在数据库浏览器中执行此操作，以查看数据库的布局方式。但假设它持有正确的数据，我将希望以编程方式执行此操作。

非常感谢任何帮助。

谢谢乔娜

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T21:52:03.773

这个[页面](http://openlp.org/forums/general-stuff/general-discussion/songpro-migration)说 SongPro .sdb 文件是一个 MSAccess 数据库，您只需将其重命名为 .mdb 并使用 MS Access 打开它。还有一个脚本链接，有人为转换数据库的内容而编写。

# php - php - 如何解析来自网站的 api 调用返回的 XML？

> ID：10677482
> 
> 赞同：-1
> 
> 时间：2012-05-20T21:44:33.643
> 
> 标签：php, api, redirect

我目前正在开发一个网站，该网站需要对社交插件网站进行 API 调用以获取用户令牌。使用用户令牌，我可以调用网站的登录窗口并让用户使用他/她的登录凭据登录，以允许我的应用程序获取所需的数据。

当 1) 我对网站进行 API 调用时，2) 它返回带有 XML 格式的用户令牌的 URL，如下所示：

1)

```
<a href="<?php echo "http://xxxxx.net/api/get_auth_url.xml?akey=$myAppKey" ?>" target="_blank">Login</a> 
```

2)

```
<?xml version="1.0" encoding="UTF-8"?>
-<auth_token> <url>http://xxxxx.net/api/start_auth?token=7x1x81xfxxxxx5bxxxx3dx45trsda</url> <token>7x1x81xfxxxxx5bxxxx3dx45trsda</token> </auth_token> 
```

但是，我对 PHP 比较陌生，不确定处理返回的 XML 并将网站重定向到“http://xxxxx.net/api/start_auth?token=7x1x81xfxxxxx5bxxxx3dx45trsda”的正确方法是什么。重定向后，我可以让用户登录并获取我需要的信息。

我曾尝试使用 curl 方法，如下所示，但我不熟悉解析 curl_exe() 的结果并使用解析后的值重定向站点。我还不能让它工作，但我认为应该有更多的 php 原生方式来处理返回的 XML 并使用序列化的 XML 对象来重定向网站。

```
<?php $ch = curl_init(); ?>
<?php curl_setopt($ch, CURLOPT_URL, "http://xxxxx.net/api/get_auth_url.xml?akey=$myAppKey"); ?>
<?php curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); ?>
<?php $store = curl_exec($ch); ?>
<?php curl_close($ch); ?> 
```

任何反馈将不胜感激。WL

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:00:39.130

一旦你得到你的 XML 字符串，我会给[SimpleXMLElement](http://de3.php.net/manual/en/class.simplexmlelement.php)`curl_exec()`一个镜头（顺便说一下，我也会使用它）......

```
$authTokenXml = new SimpleXMLElement( $store );
$authUrl = $authTokenXml->url 
```

现在您可以`$authUrl`以任何您喜欢的方式使用，例如发送一个 http 重定向标头：

```
header('Location: ' . $authUrl); 
```

或使用另一个 CURL。

希望有帮助！

（顺便说一句。你不需要`<?php`每行中的 -Tags。它实际上启动了一个 php 块）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:00:11.867

从[SimpleXML 文档开始](http://php.net/manual/en/book.simplexml.php)

# php - str_replace 用于 utf8 字符串

> ID：10677483
> 
> 赞同：1
> 
> 时间：2012-05-20T21:44:39.053
> 
> 标签：php, string

`str = "asd€aaa";`

`$str = str_replace("€","",$str);`

出于某种原因没有更换欧元符号。

我已`mb_internal_encoding("UTF-8");`在文件顶部设置（以 UTF-8 保存）。

该字符串源自 MySQL 数据库，因此我也设置了以下内容：

```
mysql_set_charset('utf8',$conn);
mysql_query("SET NAMES 'utf8'");
mysql_query("SET CHARACTER SET utf8");
mysql_query("SET COLLATION_CONNECTION = 'utf8_unicode_ci'"); 
```

我错过了什么吗？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T21:47:20.830

这意味着来自数据库的字符串和搜索字符串的编码不同，因此不会被识别为相同的字符。确保*您的源代码文件*也以 UTF-8 格式保存。

# c - 在 C 中实现哈希表

> ID：10677484
> 
> 赞同：0
> 
> 时间：2012-05-20T21:44:44.217
> 
> 标签：c, pointers, linked-list, hashtable

我无法在 C 中实现一个简单的列表，问题是通过指针连接项目。
以下代码是哈希表的片段，它应该将具有相同索引的项目存储在列表中以避免冲突。

```
typedef struct dictEntry {
    void *key;
    void *value;
    struct dictEntry *next;
} dictEntry;

typedef struct dict {
    dictEntry **table;
    unsigned long size;
    unsigned long used;
} dict;

void dictAdd(dict *d, void *key, void *value) {
    int index = hash(key) & d->size;
    dictEntry *entry;

    entry = malloc(sizeof(entry));

    entry->key   = key;
    entry->value = value;
    entry->next  = 0;

    if (d->table[index]) {
        /* this is does not work */
        dictEntry *next;
        next = d->table[index];

        while (next) {
            next = next->next;
        }

        next = entry;
    } else {
        d->table[index] = entry;
        d->used++;
    }
} 
```

我的想法是遍历列表中的每个元素 ( `next->next`) 并将指针分配给`entry`最后一个元素 ( `next = entry;`)。
经过几天的重写和移动部分代码，我似乎仍然找不到解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:51:04.547

您应该首先尝试实现链表。

这是我将如何实现添加到末尾的方法（我已经修改了您的代码，您只需覆盖临时的“下一个”变量而不修改列表本身）：

```
if (d->table[index]) {
    /* this should work*/
    dictEntry *next;
    dictEntry *prev = NULL;
    next = d->table[index];

    while (next) {
        prev = next;
        next = next->next;
    }

    // yes, add new entry as the "next" pointer to the "last" item
    prev->next = entry;
} else { 
```

……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:16:55.080

```
entry = malloc(sizeof(entry)); 
```

应该：

```
entry = malloc(sizeof *entry); 
```

dictAdd 也过于复杂。在这种情况下，使用指针对指针会有所帮助：

```
void dictAdd(dict *d, void *key, void *value) {
    unsigned index;
    dictEntry **pp;

    index = hash(key) % d->size;
    if (!d->table[index]) d->used++;

    for (pp = &d->table[index]; *pp; pp = &(*pp)->next) {;}

    *pp = malloc(sizeof **pp);
     /* Omitted : handle ((*pp) == NULL) malloc failure here */
    (*pp)->key   = key;
    (*pp)->value = value;
    (*pp)->next  = NULL;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T21:51:18.640

看看你的while循环。你会一直`next`走到零，但你真的想要下一个指针为零的最后一个条目。修复它，它应该更接近。

# objective-c - 是否可以在 NSCache 中缓存 CGRect？

> ID：10677485
> 
> 赞同：0
> 
> 时间：2012-05-20T21:44:53.323
> 
> 标签：objective-c, ios

所以我有这个方法：

```
 rect = CGRectFromString([self.indexToRectMap objectForKey:key]); 
```

它被一遍又一遍地反复调用。所以我想知道是否有办法缓存这个或替代调用这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:54:53.670

您可以将矩形保存在 a 中`NSValue`，然后将其放入缓存中。已经实现了[方便](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/NSValue_UIKit_Additions/Reference/Reference.html)的存储和检索`CGRect`s的方法`NSValue`，所以应该很容易实现。

# c - sendto() 失败，断开 telnet 连接并阻止程序

> ID：10677490
> 
> 赞同：1
> 
> 时间：2012-05-20T21:45:11.143
> 
> 标签：c, udp, telnet, blocking, errno

我已经被这个问题困扰了好几天，我真的不知道这是从哪里来的。

我正在做一个通过 UDP 通信的程序。我正在使用该`sendto()`方法在程序之间进行通信。此外，还有一个用户打开和使用的 UI TCP 套接字，通过 telnet 管理程序。telnet 部分 100% 与程序的其他功能一起工作。

问题是，当我使用该`sendto()`方法时，程序完全阻塞并且 Telnet 连接断开（通信已被主机切断，它说）。我的问题是，当程序阻塞时，我无法弄清楚为什么`sendto()`会失败，因为它不会执行后面的内容。即使有类似的东西：

```
if(sendto(...)<0)
{
    perror("Sendto error :");
} 
```

没有任何反应，我无法获得任何信息`errno`。telnet 连接中断的事实对我来说似乎很奇怪，因为它位于一个非常不同的端口上，因此不应该像这样中断。我试图将我的 UDP 套接字设置为非阻塞，但它仍然不起作用。这是代码的非工作部分：

```
struct sockaddr_in address;

hp = gethostbyname(myaddr);

address.sin_family = AF_INET;
address.sin_port = htons(udp_port);

memcpy(&(address.sin_addr.s_addr), hp->h_addr, hp->h_length);

sendto(fd, buffer, buffer_size, 0, (struct sockaddr *)&address, sizeof(address));

close(fd); 
```

提前感谢您的帮助，如果您需要更具体的信息，请询问我。

# callback - 如何让 Meteor.Call 返回模板的值？

> ID：10677491
> 
> 赞同：42
> 
> 时间：2012-05-20T21:45:16.350
> 
> 标签：callback, meteor

我试图[理解这篇关于这个概念的帖子](https://stackoverflow.com/questions/10379445/how-to-get-the-result-of-a-meteor-call-function-in-a-template)，但是，我没有得到它。我有以下简单的设置：

```
/server/test.js
Meteor.methods({ 
  abc: function() {
    var result = {};
    result.foo = "Hello ";
    result.bar = "World!";
    return result;
  }
});

/client/myapp.js
var q = Meteor.call('abc');
console.log(q); 
```

此结构返回到控制台`undefined`。

如果我将`myapp.js`文件更改为：

```
Meteor.call('abc', function(err, data) {
  !err ? console.log(data) : console.log(err);
} 
```

我在控制台中收到了`Object`。

理想情况下，这是我想要做的，但它不起作用，在控制台中说明：`Cannot read property 'greeting' of undefined`

```
/client/myapp.js
var q = Meteor.call('abc');

Template.hello.greeting = function() {
   return q.foo;
} 
```

将非常感谢将数据从服务器对象传递到模板中的任何帮助。我还在学习 JavaScript 和 Meteor。

谢谢！

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-05-20T21:58:34.083

从[文档](http://docs.meteor.com/#meteor_call)[中`Meteor.call`](http://docs.meteor.com/#meteor_call)：

> 在客户端，如果你不传递回调并且你不在存根中，调用将返回 undefined，你将无法获取方法的返回值。那是因为客户端没有纤程，所以实际上没有任何方法可以阻止方法的远程执行。

所以，你会想要这样做：

```
Meteor.call('abc', function(err, data) {
  if (err)
    console.log(err);

  Session.set('q', data);
});

Template.hello.greeting = function() {
  return Session.get('q').foo;
}; 
```

一旦数据可用，这将响应式更新模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-02T20:50:32.393

发生这种情况是因为`Npm.require`具有异步行为。这就是你必须为`Meteor.call`.

但是有一个解决方案，只要使用`install(mrt add npm)`，你就会得到一个以此命名的函数`Meteor.sync(//...)`，你可以同时做这两种游戏：同步和异步在你的`Meteor.call()`.

参考：[http ://www.sitepoint.com/create-a-meteor-app-using-npm-module/](http://www.sitepoint.com/create-a-meteor-app-using-npm-module/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-24T13:13:01.097

[您可以通过使用反应变量](http://docs.meteor.com/#/full/reactivevar)来获取 Meteor 方法的返回值以在模板中使用。查看[Meteorpad 上的工作演示](http://meteorpad.com/pad/SgZcFbpXXSRDLqRD2/MethodTest)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-21T00:30:08.253

我去了一个贫民区解决方案。但是，它对我有用，这对我来说很重要。下面是我的代码，我认为它在概念上解决了 OP 的问题。

在客户端的 main.js 中：

```
Meteor.setInterval(function() {
    confirmLogin();

}, 5000); 
```

这将每五秒运行一次 confirmLogin() 函数。

confirmLogin 函数（在客户端的 main.js 中）：

```
function confirmLogin() {
    Meteor.call('loggedIn', function (error, result) {
        Session.set("loggedIn", result);
    });

} 
```

loggedIn 方法（在服务器的 main.js 中）：

```
loggedIn: function () {
    var toReturn = false;
    var userDetails = Meteor.user();
    if (typeof userDetails["services"] !== "undefined") {
        if (typeof userDetails["services"]["facebook"] != "undefined") {
            toReturn = true;
        }
    }

    return toReturn;
}, 
```

相关助手：

```
loggedIn: function () {
    return Session.get("loggedIn");
} 
```

# pinvoke - 来自 .NET 的 WinAPI SendMessage

> ID：10677492
> 
> 赞同：1
> 
> 时间：2012-05-20T21:45:16.663
> 
> 标签：pinvoke, sendmessage

我有一个winapi代码示例：

```
struct CommunicationInfo {
    long internalMsg;
    const TCHAR * srcModuleName;
    void * info; 
  }; 
```

...

```
const TCHAR* szText = _T("Hello from my plugin!\n(test message)");
    CommunicationInfo ci = { 0x0401, cszMyPlugin, (void *) szText };
    ::SendMessage( hNppWnd, 0x111, (WPARAM) _T("NppExec.dll"), (LPARAM) &ci ); 
```

我想从.net打同样的电话，我写了这样的包装：

```
[StructLayout(LayoutKind.Sequential)]
    public struct CommunicationInfo
    {
        public Int64 internalMsg;
        [MarshalAs(UnmanagedType.LPWStr)]
        public StringBuilder srcModuleName;
        [MarshalAs(UnmanagedType.LPWStr)]
        public StringBuilder data;
    }; 
```

...

```
[DllImport("user32")]
public static extern IntPtr SendMessage(IntPtr hWnd, 
    NppMsg Msg, IntPtr wParam, 
    [MarshalAs(UnmanagedType.Struct)] CommunicationInfo communicationInfo); 
```

...

```
SendMessage(hNppWnd, 0x111, 
    Marshal.StringToHGlobalUni("NppExec.dll"), 
    new CommunicationInfo 
    { 
        data = new StringBuilder("test test"),
        internalMsg = 0x0401,
        srcModuleName = new StringBuilder("ModuleName")
    }); 
```

但是这段代码不起作用。我在哪里犯了错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T21:55:30.350

我相信，CommunicationInfo 结构中的“long”字段在 WinAPI 中是 32 位的。所以尝试在 C# 中将“internalMsg”定义为 System.Int32

可以肯定的是，尝试在 C/C++ 中调用 printf("%d\n", sizeof(CommunicationInfo)) 以了解实际大小。如果在 32 位系统上为 (4 + 4 + 4)，则 C# 结构也必须为 12 字节大小。

“char*”指针也必须是指向非托管内存的指针，所以 StringBuilder 不会这样做。

为编组样本[编组带有字符串的结构时，](https://stackoverflow.com/questions/1223690/pinvoke-error-when-marshalling-struct-with-a-string-in-it)请参阅此PInvoke 错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T10:45:09.723

正如 Viktor 指出的那样，C/C++`long`大小为 32 位，因此需要与 C# 匹配`int`。最重要的是，没有正确处理结构的传递。另外调用`StringToHGlobalUni`泄漏，因为你从来没有调用`FreeHGlobal`.

我可能会处理这样的编组：

```
[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Unicode)]
public struct CommunicationInfo
{
    public int internalMsg;
    public string srcModuleName;
    public string data;
};
....
[DllImport("user32")]
public static extern IntPtr SendMessage(
    IntPtr hWnd, 
    uint Msg, 
    [MarshalAs(UnmanagedType.LPWStr)] string wParam, 
    ref CommunicationInfo communicationInfo
);
....
CommunicationInfo communicationInfo = new CommunicationInfo 
{ 
    internalMsg = 0x0401,
    srcModuleName = "ModuleName",
    data = "test test"
};
SendMessage(hNppWnd, 0x111, "NppExec.dll", ref communicationInfo); 
```

# zeromq - 如何在 ZeroMQ 中监控/管理队列？

> ID：10677493
> 
> 赞同：16
> 
> 时间：2012-05-20T21:45:38.587
> 
> 标签：zeromq

首先，我是 ZeroMQ 和消息队列系统的新手，所以我正在尝试做的事情可能会通过不同的方法来解决。我正在设计一个消息系统，它执行以下操作：

*   多个客户端连接到代理并发送需要处理的项目的 ID。客户端立即断开连接，不等待响应。

*   代理将项目发送给工作人员，每个工作人员一个项目，以执行一些处理。每个返回都返回一个处理完成的信号。

我有一个基本的系统设置，可以正确处理请求/回复，但我也希望能够执行以下操作：

*   查询代理以查看有多少进程实际在工作人员上运行，以及有多少只是在等待运行。

*   让代理确保每个 id 只有一个进程在运行 - 如果重复的 id 到达并且该项目当前没有被工作人员处理，请不要将其添加到队列中。

我正在使用带有经纪人/经销商套接字的投票设置。我使用的代码与[Ian Barber 的这个示例](https://github.com/ianbarber/ZeroMQ-Talk/tree/master/queue)非常相似。

我的第一个倾向（虽然我不确定如何在 zmq 中实现它）是让代理跟踪已收到的 id，以及那些正在由工作人员积极处理的 id。似乎代理会立即将请求转发给工作人员，无论它们是否可用于实际运行处理。然后工作人员将 id 排队并按顺序处理它们。这并不理想，因为我希望能够集中监控和控制系统中发生的事情以实现可靠性。

无论如何，这种设置的任何提示、提示或示例将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-21T14:52:59.653

在我看来，ZeroMQ 最适合用于无代理的设计，该库就是为此设计的。如果您想监控队列中的项目数、吞吐量或其他任何内容，您将不得不自己将其构建到应用程序/设备/生产者中。由于您是消息传递的新手，因此很快就会失控。鉴于此，我建议研究 RabbitMQ（或类似的代理），它将为您提供开箱即用的这些服务。如果您确实采用了 RabbitMQ（或者更确切地说，AMQP），我建议您在上面描述的场景中使用扇出交换。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-18T10:46:27.780

ZeroMQ 的 Python 库似乎带有处理此问题的模式：http: [//zeromq.github.com/pyzmq/devices.html#monitoredqueue](http://zeromq.github.com/pyzmq/devices.html#monitoredqueue)

# c# - HTTPHandler 在 IIS 7.5 上失败，使用 system.webserver

> ID：10677497
> 
> 赞同：0
> 
> 时间：2012-05-20T21:45:51.847
> 
> 标签：c#, asp.net, .net, c#-4.0

当我尝试访问任何 .asmx 以及我的自定义 http 处理程序时，我收到以下错误。我也已经将其移至 system.webserver .. 有什么想法吗？

```
HTTP Error 500.19 - Internal Server Error

The requested page cannot be accessed because the related configuration data for the page is invalid.
    <add name="UrlRoutingModule-4.0" type="System.Web.Routing.UrlRoutingModule" preCondition="managedHandler" /> 
```

网络配置：

```
<?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <configSections>
    <section name="microsoft.web.services3" type="Microsoft.Web.Services3.Configuration.WebServicesConfiguration, Microsoft.Web.Services3, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
  </configSections>
  <connectionStrings>
  </connectionStrings>
  <system.web>
    <customErrors mode="Off"></customErrors>
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Speech, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      </assemblies>
    </compilation>
    <httpRuntime maxRequestLength="2147483647"/>
    <webServices>
      <protocols>
        <add name="HttpGet"/>
        <add name="HttpPost"/>
      </protocols>
    </webServices>
  </system.web>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <handlers>
      <add name="SpartHandler" verb="*" path="*.sparta" type="SpartaMessage_WebServices.IHTTPTransfer, SpartaMessage_WebServices" resourceType="Unspecified"/>
    </handlers>
  </system.webServer>
  <system.net>
  </system.net>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T09:08:14.137

不要将处理程序放在 system.webServer 中，而是将 httpHandlers 放在 system.web 中：

```
 <system.web>
    ...
    <httpHandlers>
      <add name="SpartHandler" verb="*" path="*.sparta" type="SpartaMessage_WebServices.IHTTPTransfer, SpartaMessage_WebServices" resourceType="Unspecified" />
    </httpHandlers>
  </system.web> 
```

# php - 从 MYSQL 获取数据并显示在 JSON 文件中

> ID：10677500
> 
> 赞同：2
> 
> 时间：2012-05-20T21:46:41.190
> 
> 标签：php, mysql, ios, json

我正在构建一个从我的 MYSQL 数据库中获取数据的 iOS 应用程序，所以要做这样的事情我需要使用 JSON（我知道其他方法，但我需要专门使用 JSON）。问题是，我如何从我的 mysql 数据库中获取数据并将其写入 JSON 格式的文件（最好使用 PHP）。

任何链接、教程或源代码将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T21:52:38.927

将您的数据库行检索到一个数组中，并`json_encode()`使用适当的标头将输出写入输出缓冲区：

```
// Modify the fetch call for the MySQL API you're using:
// This is MySQLi...
$results = array();
while ($row = result->fetch_assoc()) {
  // All results onto a single array
  $results[] = $row;
}

// Supply header for JSON mime type
header("Content-type: application/json");
// Supply the Content-Disposition header if you want the browser
// to treat the file as a download and prompt to save it.
// Leave this out if that isn't what you want (I suspect it isn't)
header('Content-Disposition: attachment; filename="file.json"');
// Depending on how you want the JSON to look, you may wish to use
// JSON_FORCE_OBJECT
echo json_encode($results, JSON_FORCE_OBJECT); 
```

从浏览器的角度来看，它正在接收一个 JSON 文件，尽管 PHP 正在为它提供服务。

如果您确实需要*保存*JSON 文件而不仅仅是输出它，请使用`file_put_contents()`

```
file_put_contents('file.json', json_encode($results, JSON_FORCE_OBJECT));
// Read it back out with 
echo file_get_contents('file.json');
// Or more simply 
file('file.json'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-20T21:51:41.513

只需使用[json_encode](http://php.net/manual/en/function.json-encode.php)

```
... code that builds an array from any source you like
header('Content-type: application/json');
echo json_encode($anArray);
die; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:53:41.817

1.  从mysql获取数据并编码为json`json_encode()`

2.  `fopen()`使用and写入文件`fwrite()`

# c++ - 如何使用 OpenCv 叠加图像？

> ID：10677502
> 
> 赞同：5
> 
> 时间：2012-05-20T21:46:54.093
> 
> 标签：c++, c, opencv, android-ndk

如何叠加两个图像？本质上，我有一个没有 alpha 通道的背景，而不是一个或多个具有 alpha 通道的图像，需要相互叠加。

我尝试了以下代码，但叠加结果很糟糕：

```
// create our out image
Mat merged (info.width, info.height, CV_8UC4);

// get layers
Mat layer1Image = imread(layer1Path);
Mat layer2Image = imread(layer2Path);

addWeighted(layer1Image, 0.5, layer2Image, 0.5, 0.0, merged); 
```

我也尝试过使用合并，但我在某处读到它不支持 alpha 通道？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T06:38:54.853

我不知道执行此操作的 OpenCV 函数。但是你可以自己实现它。它类似于`addWeighted`功能。但不是固定权重，而是`0.5`从叠加图像的 alpha 通道计算权重。

```
 Mat img = imread("bg.bmp");
    Mat dst(img);
    Mat ov = imread("ov.tiff", -1);

    for(int y=0;y<img.rows;y++)
    for(int x=0;x<img.cols;x++)
    {
            //int alpha = ov.at<Vec4b>(y,x)[3];
            int alpha = 256 * (x+y)/(img.rows+img.cols);
            dst.at<Vec3b>(y,x)[0] = (1-alpha/256.0) * img.at<Vec3b>(y,x)[0] + (alpha * ov.at<Vec3b>(y,x)[0] / 256);
            dst.at<Vec3b>(y,x)[1] = (1-alpha/256.0) * img.at<Vec3b>(y,x)[1] + (alpha * ov.at<Vec3b>(y,x)[1] / 256);
            dst.at<Vec3b>(y,x)[2] = (1-alpha/256.0) * img.at<Vec3b>(y,x)[2] + (alpha * ov.at<Vec3b>(y,x)[2] / 256);
    }

    imwrite("bg_ov.bmp",dst); 
```

请注意，我无法读取带有 alpha 通道的文件，因为显然 OpenCV 不支持这一点。这就是为什么我从坐标计算一个 alpha 值以获得某种渐变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T21:54:58.203

合并的通道数很可能与输入不同。你可以更换

```
Mat merged (info.width, info.height, CV_8UC4); 
```

有了这个：

```
Mat merged; 
```

这样，您将让该`addWeighted`方法使用正确的参数创建目标矩阵。

# jquery-mobile - 页面特定的脚本未使用 jquery mobile 加载

> ID：10677503
> 
> 赞同：1
> 
> 时间：2012-05-20T21:47:02.067
> 
> 标签：jquery-mobile, cordova

我正在使用 jquery mobile 和 phonegap 创建一个 android 应用程序。我遵循了简短指南“Phonegap 编程的 20 个秘诀”，该指南建议使用从 index.html 上加载的自定义脚本到名为`onPageLoad()`其中 Page 是目标页面的 html 文件名称的函数的回调。

但是，我被卡住了，因为我在 data-role="page" div 中包含的带有脚本标签的 javascript 没有加载。

[https://stackoverflow.com/a/8838639/153382](https://stackoverflow.com/a/8838639/153382)指向说这应该可以工作的 jQuery 移动指南。我已经阅读了指南，它不起作用。怎么办？

jquery mobile 有什么改变使它不再起作用吗？

**更新** 一些测试表明内联脚本运行，但我试图从文件加载的脚本没有评估脚本 src 属性。

也试过了`<script type="text/javascript">$.getScript("js/lookup.js");</script>`。它也没有工作。

**代码**

common.js 包含在 index.html 之后`<div data-role="page">...</div>`：

```
<script type="text/javascript" charset="utf-8" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.1.0.min.js"></script>
<script type="text/javascript" charset="utf-8" src="js/common.js"></script> 
```

common.js相关内容：

```
function executeCallback() {
    if (isPhoneGapReady) {
        // get name of current html page
        var pages = currentUrl.split("/");
        var currentPage = pages[pages.length - 1].
            slice(0, pages[pages.length - 1].indexOf(".html"));

        // captalize the first letter and execute the function
        currentPage = currentPage.charAt(0).toUpperCase() +
            currentPage.slice(1);

        if (typeof window['on' + currentPage + 'Load'] ==
            typeof(Function)) {
            window['on' + currentPage + 'Load']();
        }
        alert('on' + currentPage + 'Load: ' + typeof window['on' + currentPage + 'Load']);
            // says onLookupLoad: undefined
    }
}

$(document).bind("pageload", function(event, data) {
    init(data.url);
});

window.onload = init; 
```

`init(url)`调用`onDeviceReady()`哪个调用`executeCallback()`

lookup.html 在里面包含以下行`<div data-role="page">`：

```
<script type="text/javascript" charset="utf-8" src="js/lookup.js"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T13:50:00.037

似乎问题在于 Eclipse 没有生成新的 apk。我猜这是因为 assets 目录发生了变化，但 src 目录没有。如果我删除 bin 文件夹中的 apk 并运行模拟器，我的代码将按设计工作。

# haxe - 如何有一个类型化的随机访问只读数组结构

> ID：10677504
> 
> 赞同：1
> 
> 时间：2012-05-20T21:47:20.163
> 
> 标签：haxe

仍然在使用 Haxe 并正在寻找方法来拥有一个类似数组的只读集合，我可以在编译时为其指定一个类型

因此，理想情况下，我需要以下内容：

```
var collection:Collection<ItemType>;

var item:ItemType = collection[3];//or
var other:ItemType = collection.getAt(3);

//also, it would be good if it was iterable
for (item in collection)
{
//stuff
} 
```

所以，就像一个数组，但只读。有人能给我一些指点吗，拜托。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T11:37:12.000

好吧，您不能像这样拥有只读数组访问权限，但是您可以使用方法来做到这一点：

```
class ReadonlyArray<T> {
    var source:Array<T>;
    public function new(source) this.source = source
    inline function get(index) return source[index]
    inline function iterator() return index.iterator()
} 
```

开销应该几乎不明显。

# qml - 子元素可以均匀填充Grid吗？

> ID：10677509
> 
> 赞同：3
> 
> 时间：2012-05-20T21:47:51.130
> 
> 标签：qml

我想知道是否可以在 qml 中创建一个元素网格，它完全均匀地填充网格/父级的宽度和高度：

```
Grid {
    columns: 2
    Repeater {
        model: 4
        Rectangle {
            width: /* ??? */
            height: / * ??? */
        }
    }
} 
```

我认为必须在这里设置绝对值。使用`anchors.fill: parent`将不起作用，以及类似`width: parent.width / 2`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T06:11:46.570

我认为您忘记设置父级的（`Grid`元素）锚点。此外，您始终可以通过它的 id 引用元素。

```
Grid {
    anchors.fill: parent
    columns: 2
    rows: 3
    Repeater {
        model: 6
        Rectangle {
            width: parent.width / parent.columns
            height: parent.height / parent.rows
        }
    }
} 
```

# python - SQLAlchemy ORM：修改查询返回的列

> ID：10677514
> 
> 赞同：8
> 
> 时间：2012-05-20T21:49:05.327
> 
> 标签：python, orm, sqlalchemy

如果我有一个 SQLAlchemy ORM 查询：

```
admin_users = Session.query(User).filter_by(is_admin=True) 
```

是否可以修改该查询返回的列？

例如，这样我就可以只选择`User.id`列，并在子查询中使用它：

```
admin_email_addresses = Session.query(EmailAddress)\
    .filter(EmailAddress.user_id.in_(admin_users.select_columns(User.id)) 
```

注意：该`.values()`方法不起作用，因为它执行查询并返回一个可迭代的结果（因此，例如，`EmailAddress.user_id.in_(admin_users.values(User.id))`将执行两个查询，而不是一个）。

我知道我可以将第一个查询修改为`Session.query(User.id)`，但我特别想知道如何修改查询返回的列。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-21T13:44:43.800

`values()`我感觉到你在这件事上的痛苦。在 0.6.5 中，我添加了`with_entities()`这就像`values()`except 不迭代：

```
q = q.with_entities(User.id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T06:57:57.343

假设您`Address.user_id`定义了 a `ForeignKey`，与运算符相比，下面的查询将更有效地完成这项工作`IN`：

```
admin_email_addresses = session.query(EmailAddress).\
    join(User).filter(User.is_admin==True) 
```

如果您没有 ForeignKey（尽管您应该），您可以明确指定`join`条件：

```
admin_email_addresses = session.query(EmailAddress).\
    join(User, User.id==EmailAddress.user_id).filter(User.is_admin==True) 
```

但是如果你真的想用`in_`操作符来做，你可以去（注意`subquery`）：

```
subq = session.query(User.id).filter(User.is_admin==True).subquery()
admin_email_addresses = session.query(EmailAddress).\
       filter(EmailAddress.user_id.in_(subq)) 
```

# php - Codeignter 的图像处理（使用 GD 库）不会调整某些 JPEG 图像的大小

> ID：10677515
> 
> 赞同：0
> 
> 时间：2012-05-20T21:49:28.813
> 
> 标签：php, image, codeigniter, image-processing, file-upload

我有一个上传图片 jpg/gif/etc 的上传表单，我用它为我用于我的网站的画廊上传一些图片（图片格式为 Jpg），但不幸的是它不适用于某些图片（它使一切变黑，并在左上角（0, 0）显示调整大小的图像）。
我尝试在线调整图像大小并且它没有问题，所以我认为问题不在于图像本身，它在库/配置中。

我的上传和调整图像处理程序代码：

```
 function upload() {
        //check if admin is logged in.
        if ($this->session->userdata('is_logged') == 1) {
            //loading the configuration for the upload library.
            $config = array();
            $config['upload_path'] = './uploads/';
            $config['allowed_types'] = 'gif|jpg|png';
            $config['max_size'] = '7000';
            $config['max_width'] = '6000';
            $config['max_height'] = '5000';

            $this->load->library('upload', $config);

            if (!$this->upload->do_upload()) {
                $data['redirect_msg'] = $this->upload->display_errors() . '<br /> go back to ' . anchor('admin/', 'main page');
                $this->load->view('redirect', $data);
            } else {
                //getting the image's information, in order to resize it.
                $upload_data = $this->upload->data();
                $image_path = $upload_data['full_path'];

                /* loading the configuration for the image manuiplation library. */
                $config['image_library'] = 'gd';
                $config['source_image'] = $image_path;
                $config['width'] = '800';
                $config['height'] = '600';
                $config['maintain_ratio'] = FALSE; //tried setting it to TRUE aswell.
                //loading the library
                $this->load->library('image_lib', $config);
                //starting the resize proccess.
                $this->image_lib->resize();
                //checking if the is an error in the resizing proccess.
                if (!$this->image_lib->resize()) {
                    /* displaying the errors */
                    $data['redirect_msg'] = $this->image_lib->display_errors();
                    $this->load->view('redirect', $data);
                } else {
                    /* show positive message. */
                    $data['redirect_msg'] = 'Upload successful!<br />redirecting to ' . anchor('admin/', 'homepage') . ' in 3 seconds';
                    $this->load->view('redirect', $data);
                    //saving the image name to a database table, so we can retrieve it when needed(for the slideshow).
                    $this->db_model->save_image($upload_data['orig_name']);
                    //doing the redirect.
                    header('refresh:3;url=' . site_url('admin/'));
                }
            }
        } else { //if not logged in, show negative message.
            $data['redirect_msg'] = 'you are not logged in. < br/> login ' . anchor('admin/', 'here');
            $this->load->view('redirect', $data);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T22:12:08.640

您正在调整该图像的大小两次：

```
//starting the resize proccess.
$this->image_lib->resize();
    //checking if the is an error in the resizing proccess.
    if (!$this->image_lib->resize()) { 
```

只做一次：

```
//starting the resize proccess.            
//checking if the is an error in the resizing proccess.
            if (!$this->image_lib->resize()) { 
```

# javascript - 从 Firefox 的上下文菜单中获取 menuitem

> ID：10677517
> 
> 赞同：0
> 
> 时间：2012-05-20T21:49:38.447
> 
> 标签：javascript, firefox-addon, contextmenu, xul

我编写了一个 Firefox 扩展，它将一个菜单项附加到上下文菜单上，现在我想隐藏该项目，除非单击的上下文在文本上。
由于某种原因，永远不会触发 oncontextmenu 事件（“打开的上下文”未显示在屏幕上）。
我已经尝试将其更改为但仍然没有发出警报，有人知道我在这里可能做错了什么吗？谢谢！

```
<?xml version="1.0"?>
<overlay xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">  
    <script>
    function contextClicked(){
        alert('context opened')
        var saveToFileItem = document.getElementById("saveToFile");
    }
    </script>

    <menupopup id="contentAreaContextMenu" oncontextmenu="contextClicked();">
        <script type="application/javascript" src="chrome://ffext/content/overlay.js"/>
        <menuitem id="saveToFile" label="Save to File" oncommand="ffext.run();"/>
    </menupopup>
</overlay> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T06:35:53.493

不要这样做 - 使用`onfoo`事件属性只能有一个事件处理程序。如果你成功了，你可能会覆盖 Firefox 定义的默认上下文菜单处理程序。您应该[`addEventListener`](https://developer.mozilla.org/en/DOM/element.addEventListener)改用它允许为同一事件添加多个事件侦听器。当然，您使用了错误的事件。该`contextmenu`事件在用户单击的元素上触发，而不是在上下文菜单上触发。在本例中，XUL 通过打开上下文菜单来处理此事件`contentAreaContextMenu`。然后上下文菜单获取[它自己的事件](https://developer.mozilla.org/en/XUL/PopupGuide/PopupEvents)- 即`popupshowing`和`popupshown`。上下文菜单初始化代码通常附加到`popupshowing`事件中。

因此，您应该将与此类似的代码放入您的`overlay.js`文件中：

```
// Do not try to do anything before the window loads
window.addEventListener("load", function()
{
   function contextClicked(event)
   {
     alert('context opened')
     var saveToFileItem = document.getElementById("saveToFile");
   }

   // Add contextClicked as event listener to the context menu
   var contextMenu = document.getElementById("contentAreaContextMenu");
   contextMenu.addEventListener("popupshowing", contextClicked, false);
}, false); 
```

请注意，此代码`contextClicked`在函数内部定义 - 这是我通常推荐的一种方法。如果您在全局范围内定义事物，您可能会遇到与现有 Firefox 代码或其他扩展的名称冲突——它们都在同一个命名空间中运行它们的代码。通过在匿名函数中声明变量和函数，您可以完全避免这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:53:22.847

尝试使用[popupshowing](https://developer.mozilla.org/en/XUL/PopupGuide/PopupEvents#The_popupshowing_event)事件。

# function - 检查第 N 个斐波那契数是否为 NthFib - 算术错误失败

> ID：10677519
> 
> 赞同：0
> 
> 时间：2012-05-20T21:49:45.263
> 
> 标签：function, math, prolog, fibonacci, arithmetic-expressions

这是我的谓词，它应该检查斐波那`N`^契数是否是`NthFib`。

我得到算术不是函数错误。

```
K - current iteration
N - Nth number
Tmp - previous Fibonacci number
Ans - current Fibonacci number 
```

斐波那契数列：1、1、2、3、5、8、13、21 等（前两个之和 = 当前）

```
fib(N, NthFib) :-
    fib(1, N, 1, 0, NthFib).

fib(K, N, Ans, Tmp, NthFib) :-
    % true if Ans is NthFib, false otherwise
    ( K > N -> Ans is NthFib
    ; K =< N -> fib( K + 1, N, Ans + Tmp, Ans, NthFib)
    ). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T07:37:18.490

首先，将您的原始代码重写为

```
fib(N, NthFib) :- fib(1, N, 1, 0, NthFib).

fib(K, N, Ans, Tmp, NthFib) :- 
  K > N -> Ans = NthFib;       % use = instead of is here
  K =< N -> fib((K+1), N, (Ans+Tmp), Ans, NthFib). 
```

现在，

```
?- fib(7,X).

X = 1+0+1+ (1+0)+ (1+0+1)+ (1+0+1+ (1+0))+ (1+0+1+ (1+0)+ (1+0+1))+ 
       (1+0+1+ (1+0)+ (1+0+1)+ (1+0+1+ (1+0))) 

Yes
?- fib(7,X), Z is X.

X = 1+0+1+ (1+0)+ (1+0+1)+ (1+0+1+ (1+0))+ (1+0+1+ (1+0)+ (1+0+1))+ 
       (1+0+1+ (1+0)+ (1+0+1)+ (1+0+1+ (1+0)))
Z = 21 
```

看，在 Prolog 中数据是符号的，并且 using`is`将算术表达式强制转换为算术值（在假设它是有意义的算术表达式的情况下*评估表达式）。*

要检查 20 是否是第 7 个斐波那契数，我们可以使用算术比较运算符来评估其参数，

```
?- fib(7,X), X =:= 20.

No 
```

这意味着您的代码只需要重写为

```
fib(N, NthFib) :- fib(1, N, 1, 0, NthFib).

fib(K, N, Ans, Tmp, NthFib) :- 
  K > N -> NthFib is Ans ;       % exchange the order of operands
  K =< N -> fib((K+1), N, (Ans+Tmp), Ans, NthFib). 
```

现在它可以按您的预期工作：

```
?- fib(7,21).

Yes
?- fib(7,20).

No 
```

但它不能有效地工作，将所有这些长表达式作为符号数据携带。我们只需要真正的数字，所以正如您在其他答案中显示的那样，`is`用于实现这一目标。您拥有的每个符号子表达式，将其从其封闭表达式中取出，并命名它，使用`is`而不是`=`.

BTW 21 确实是该序列的第 8 个成员。更正您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:28:41.987

如果`K`是统一的`1`，`K + 1`是统一的`1 + 1`，不是`2`的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-21T10:29:50.303

我重写了一个算法，现在更简单高效：

```
fib(0, 0).
fib(1, 1).
fib(N, F) :-
    N > 0,
    X is N - 2,
    Y is N - 1,
    fib(X, A),
    fib(Y, B),
    F is A + B. 
```

# python - 如何使用正则表达式获取特定的易嵌套块内容

> ID：10677522
> 
> 赞同：1
> 
> 时间：2012-05-20T21:50:41.760
> 
> 标签：python, regex, mediawiki-templates

我想从维基百科中提取信息框块。下面是一个示例输入文件：

```
{{some text}}
some other text
{{Infobox President
birth|d/m/y
other_inner_text:{{may contain curly bracket}}
other text}}
some other text
or even another infobox
{{Infobox Cabinet
same structure
{{text}}also can contain {{}}
}}
can be some other text... 
```

我希望解析结果返回两个 Infobox 块：

```
{{Infobox President
birth|d/m/y
other_inner_text:{{may contain curly bracket}}
other text
}} 
```

和

```
{{Infobox Cabinet
same structure
{{text}}also can contain {{}}
}} 
```

任何人都知道如何在 python 中使用正则表达式来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:18:55.600

为了匹配嵌套结构，一些正则表达式方言提供递归模式，如`(?R)`. 这个`(?R)`东西基本上是说“这个表达式匹配的东西”。

标准 python`re`不支持这一点，但最终将替换的较新的[正则表达式](http://pypi.python.org/pypi/regex)`re`模块支持。这是一个完整的例子。

```
text = """
{{some text}}
some other text
{{Infobox President
birth|d/m/y
other_inner_text:{{may contain {curly} bracket}}
other text}}
some other text
or even another infobox
{{Infobox Cabinet
same structure
{{text}}also can contain {{}}
}}
can be some other text...
"""

import regex

rx = r"""
{{                    # open
(                     # this match
    (?:               # contains...
        [^{}]         # no brackets
        |             # or
        }[^}]         # single close bracket
        |             # or
        {[^{]         # single open bracket
        |             # or
        (?R)          # the whole expression once again <-- recursion!
    )*                # zero or more times
)                     # end of match
}}                    # close
"""

rx = regex.compile(rx, regex.X | regex.S)

for p in rx.findall(text):
    print 'FOUND: (((', p, ')))' 
```

结果：

```
FOUND: ((( some text )))
FOUND: ((( Infobox President
birth|d/m/y
other_inner_text:{{may contain {curly} bracket}}
other text )))
FOUND: ((( Infobox Cabinet
same structure
{{text}}also can contain {{}}
))) 
```

有关递归正则表达式的详细说明，请参阅[此博客条目](http://www.catonmat.net/blog/recursive-regular-expressions)。

![在此处输入图像描述](../Images/9f8e532e87a3b3c0c6a104787931bf83.png)

（忍不住偷了这个）。

* * *

也就是说，使用基于解析器的解决方案可能会更好。例如，请参阅[使用 pyparsing 解析嵌套表达式](http://pyparsing.wikispaces.com/file/view/nested.py)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:58:48.793

它不是 python，但[这个答案](https://stackoverflow.com/a/10214209/1048572)可能会对你有所帮助。它甚至包括一个（不是快速但肮脏的）正则表达式，可以处理一级嵌套模板。

一般的答案是**否定**的，正则表达式无法解析嵌套结构。有关如何从 mediawiki api 获取分析树的链接，请参阅链接的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T22:19:13.327

正则表达式

```
{{Infobox(?:(?!}}|{{).)*(?:{{(?:(?!}}|{{).)*}}(?:(?!}}|{{).)*)*.*?}} 
```

还有我对 Perl 的尝试，但我并不流利

```
while ($subject =~ m/\{\{Infobox(?:(?!\}\}|\{\{).)*(?:\{\{(?:(?!\}\}|\{\{).)*\}\}(?:(?!\}\}|\{\{).)*)*.*?\}\}/sg) {
    # matched text = $&
} 
```

只要它们是平衡的，它将适用于无限对的“{{ some text }}”。它不支持该对的嵌套文本，但不是必需的。

请注意，如果仅在 1 次解决方案中未使用替代解决方案，则最好寻找替代解决方案。维护这样的正则表达式是残酷的。

# css - 倒置弯曲标签的 CSS

> ID：10677526
> 
> 赞同：3
> 
> 时间：2012-05-20T21:51:25.523
> 
> 标签：css, tabs, css-shapes

我一直纠结于如何为设计机构提供的这些倒置弯曲选项卡编写 CSS 代码。

![在此处输入图像描述](../Images/1c70b353b4620a7c2b0c482265198550.png)

见这里： http: [//max-guedy.com/images/tab.png](http://max-guedy.com/images/tab.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:08:08.213

**编辑**添加了`hover state`.

我创建了一个演示，我将如何做到这一点：

## *[jsBin 演示](http://jsbin.com/otoqij/edit#javascript,html,live)*

*   我们将棕色设置为整个 ul 元素
*   曲线的 25x52 精灵图像 .png ：（将在悬停时更改背景位置） [http://img401.imageshack.us/img401/258/bg2d.png](http://img401.imageshack.us/img401/258/bg2d.png)我们将设置为`li`元素但没有背景颜色。
*   这里最重要的是为`li`元素设置更高的 z-index，在`hover`
*   注意设置`a`元素左填充和相应的 -left 边距，以允许锚点“隐藏”在前一个元素图像下方。

完成后，您可以拥有越来越宽的链接，您的模板就可以完成工作！

这个CSS：

```
 ul#nav{
    height:26px;
    background:#A15049;
    border-bottom:1px solid #fff;
  }
  ul#nav li{
    position:relative;
    background:transparent url(http://img401.imageshack.us/img401/258/bg2d.png) no-repeat right top;
    height:26px;
    display:inline;
    float:left;
    padding:0 25px 0 5px;
    z-index:1;
  }
  ul#nav li a{
    padding-left:24px;
    margin-left:-24px;
    height:26px;
    display:block;
    color:#fff;
  }

  ul#nav li:hover{
    z-index:0;
    background: url(http://img401.imageshack.us/img401/258/bg2d.png) no-repeat right -26px;
  }
  ul#nav li:hover a{
    background:#CE392C;
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T22:11:12.017

用 CSS 实现这种事情几乎是可能的。

非常困难，但可能。

默认情况下，`border-radius`当然只会给你常规的圆角。

您可以通过调整半径值将它们拉伸成一些有趣的形状。这将为您提供一些实现目标的方法。

但这里真正的技巧是使用 CSS`:before`和`:after`伪选择器来创建额外的样式元素，以获取选项卡的圆形部分，您需要在其中添加更多`border-radius`.

此处描述了该技术：http: [//css-tricks.com/better-tabs-with-round-out-borders/](http://css-tricks.com/better-tabs-with-round-out-borders/) ...尽管是一个相当简单的垂直形标签。但它很好地解释了如何实现转向效果，如果你想在 CSS 中做到这一点，这对你来说至关重要。

还要记住，这些都不适用于旧版本的 IE。IE8 支持`:before`and `:after`，但不支持`border-radius`。虽然存在像 CSS3Pie 这样的黑客来解决这个问题，但我不建议将它们用于此类事情。它很可能会破裂。

如果上述所有内容听起来很棘手并且不值得，我倾向于同意。我想您会发现在这种情况下，一些简单的图像会更适合您的选项卡。如果你想聪明一点，你也可以尝试 SVG 来绘制它们，但这也会在旧版本的 IE 中出现问题。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T21:59:51.063

使用图像更容易。

但是如果你坚持使用CSS，我会说你需要使用很多`border-radius`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-20T22:50:17.353

这是一个有趣的挑战。

我的第一个想法是对选项卡应用倾斜变换，将边框半径应用到右上角，并使用伪元素处理圆形下部。

不幸的是，这看起来很难看[http://dabblet.com/gist/2759785](http://dabblet.com/gist/2759785)

尽管如此，我还是觉得必须有更好的方法来使用纯 CSS 来做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-20T22:06:38.890

我会说这是可能的，但是花费的时间是不值得的，特别是因为它在 IE < 9 中不起作用......

我过去在[css-tricks有一个很好的教程](http://css-tricks.com/better-tabs-with-round-out-borders/)

但是，正如其他人指出的那样，我建议使用图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-24T23:05:10.790

真的不需要太多的 CSS 来实现这一点。当然，您必须玩弄半径才能获得所需的倾斜度。

**HTML**

```
<div role="tablist">
    <a href="#" role="tab" aria-controls="active-tab1" aria-selected="true">active tab</a>
    <a href="#" role="tab" aria-controls="active-tab2">inactive tab</a>
    <a href="#" role="tab" aria-controls="active-tab3">inactive tab</a>
</div>

<div class="pane">
    <section id="active-tab1" role="tabpanel">
        <p>Show whatever</p>
        <p>You Want</p>
        <ul>
            <li>inside</li>
            <li>This</li>
            <li>Section</li>
        </ul>
    </section>
    <section id="active-tab2" role="tabpanel">
    </section>
    <section id="active-tab3" role="tabpanel">
    </section>
</div> 
```

**CSS**

```
[role=tablist]{padding:15px 15px 0;margin-left:88px;}

[role=tab]{
    color:#222;
    display:inline-block;
    padding-left:15px;
    padding-right:15px;
    text-decoration:none;
    line-height:44px;
    position:relative;
    min-width:150px;
    text-align:center;
    border-radius:15px 15px 0 0}
[role=tab]:hover{background-color:#ecf0f1;color:#222;}
[role=tab][aria-selected=true]{
    background-color:#3498db;
    color:white; }
[role=tab]:before,
[role=tab]:after{
    content:'';
    border-bottom:10px solid #3498db;
    position:absolute;
    bottom:-10px;
    width:44px;
    height:22px;
    z-index:1; }
[role=tab][aria-selected=true]:before{
    left:-44px;
    border-right:10px solid #3498db;
    border-bottom-right-radius:25px;
}
[role=tab][aria-selected=true]:after {
    right:-44px;
    border-left:10px solid #3498db;
    border-bottom-left-radius:25px;
}

.pane{
    background-color:#3498db;
    padding:25px;
    margin-left:5px;
    margin-right:5px;
    color:white;
    border-radius:15px;
} 
```

而且你甚至可以在大约 10 分钟内瘦下来。

[http://jsfiddle.net/darcher/819yz9Ly/](http://jsfiddle.net/darcher/819yz9Ly/)

# list - scala 列表类型不匹配

> ID：10677527
> 
> 赞同：1
> 
> 时间：2012-05-20T21:51:36.223
> 
> 标签：list, scala, type-inference

所以我有这样的元组列表：

```
val rooms = List(("Hi", "mom"),("hi", "dad"))
val foo = rooms.map(arg =>{
                  var fields = List
                    ( new JField("greeting",arg._1),
                      new JField("recipient",arg._2))
                      new JObject(fields)}) 
```

这片土地上有很多幸福，但是当我像这样更改房间列表时：

```
case class Room(greeting:String, recipient:String)
val rooms = List(Room("Hi", "mom"),Room("hi", "dad"))
val foo = rooms.map(arg =>{
                  var fields = List
                    ( new JField("greeting",arg.greeting),
                      new JField("recipient",arg.recipient))
                      new JObject(fields)}) 
```

我得到：

```
[error] <file>: type mismatch;
[error]  found   : scala.collection.immutable.List.type (with underlying type object List)
[error]  required: List[blueeyes.json.JsonAST.JValue]
[error]                       new JArray(fields) 
```

所以现在列表似乎是 Object 而不是 JField ，这是为什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:55:55.563

如果您不将其与其分离，它会`List`起作用`(`：

```
var fields = List(
  new JField("greeting", arg.greeting),
  new JField("recipient", arg.recipient)) 
```

基本上，它是这样解析的：

```
var fields = List                         // assign the List companion object

(new JField("greeting", arg.greeting),    // construct a tuple with two items
  new JField("recipient", arg.recipient)) //   ...but don't use or assign it

new JObject(fields)                       // Make JObject containing the type 
```

错误的出现是因为`JObject`构造函数需要 a`JValue`但您传递的是它`fields`的 type `List.type`。

# google-maps - 将动态内容添加到 Google 地图标记

> ID：10677529
> 
> 赞同：1
> 
> 时间：2012-05-20T21:51:46.020
> 
> 标签：google-maps, google-maps-markers

我正在尝试使用自定义图标标记创建谷歌地图。我需要能够将动态文本添加到实际标记中。换句话说，无论如何要添加一个div？我需要将 xml 中的价格添加到实际标记中。我希望这是有道理的。任何帮助将不胜感激，或者如果有人能指出我正确的方向。谢谢！

我的查询：

```
function addMarker() {
    for (var i = 0; i < markers.length; i++) {
        // obtain the attribues of each marker
        var lat = parseFloat(markers[i][0]);
        var lng = parseFloat(markers[i][1]);
        var trailhead_name = markers[i][2];

        var myLatlng = new google.maps.LatLng(lat, lng);

        var contentString = "<html><body><div class='mapPopup'><div class='mapPopIn'>" + trailhead_name + "</div></div></body></html>";
        var image = 'images/map-marker.png';
        var marker = new google.maps.Marker({
            position: myLatlng,
            map: map,
            title: "Click for more information",
            icon: image
        }); 
```

我要修改的实际地图是：http: [//travellinginmexico.com/hotels_map.php?c=cancun](http://travellinginmexico.com/hotels_map.php?c=cancun)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:45:31.087

有两个选项，[InfoBox](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/examples/infobox-basic.html)和[MarkerWithLabel](http://google-maps-utility-library-v3.googlecode.com/svn-history/r131/trunk/markerwithlabel/examples/basic.html)。我喜欢 MarkerWithlabel，因为它更轻且更易于使用。缺点是我不知道如何在创建后替换 Markerwithlabel 的文本。您可以使用 InfoBox 执行此操作，因为您实际上需要创建一个 div。

我将给出一个来自 Javascript 的静态数据示例，您可以将其替换为 XML 中的数据。您还需要设置 MarkerWithLabel 的样式以适合您的图标。例如 labelStyle:top 将改变垂直偏移量。

[http://jsfiddle.net/RAH6G/](http://jsfiddle.net/RAH6G/)单击“不是真正的 ajax”按钮。

```
 function createMarker(position, label) {
   return new MarkerWithLabel({
   position: position,
   draggable: false,
   map: map,
   labelText: label,
   labelClass: "labels", // the CSS class for the label
   labelStyle: {top: "0px", left: "-21px", opacity: 0.75},
   labelVisible: true
   });
 }

 var readData = function() { // create markers
  pos = [
  new google.maps.LatLng(40, -85),
  new google.maps.LatLng(42, -92),
  new google.maps.LatLng(36, -100),
  new google.maps.LatLng(39, -112)
  ];

  label = ["$200", "99pts.", "US$30", "US$999"];
  for (var i = 0; i < pos.length; i++) {
    createMarker(pos[i], label[i]);
  }     
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T02:52:35.903

我知道这是一个较旧的线程，但我遇到了一个非常相似的问题（尝试更新使用 MarkerWithLabel 创建的标记的标签内容），我花了一段时间才找到解决方案。

用 MarkerWithLabel 创建一个标记：

```
marker = new MarkerWithLabel({
  position: googlemapslatlng,
  icon: url-to-icon,
  map: map,
  title: "Marker Title",
  labelContent: content,
  labelClass: marker_shade
}); 
```

然后您可以使用以下方法更新标签：

```
marker.labelClass = marker_shade_updated;
marker.labelContent = marker_content_updated;
marker.label.setStyles(); // Force the marker label to redraw 
```

希望这可以帮助。

# cocoa - Cocoa：卸载请求失败时的通知？

> ID：10677530
> 
> 赞同：0
> 
> 时间：2012-05-20T21:51:48.643
> 
> 标签：cocoa, notifications, mount

有没有办法知道卸载请求是否失败？当驱动器不使用时，我称`unmountAndEjectDeviceAtPath`它运行良好。

但是当它在使用时，什么都不会发生。我首先认为 NSWorkspaceWillUnmountNotification 会被解雇，但没有。

任何想法 ？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T00:34:48.320

你是在检查返回值`-unmountAndEjectDeviceAtPath:`吗？

无论如何，该文档指出“[t]he `unmountAndEjectDeviceAtURL:error:`[method] 更可取，因为它将提供更详细的错误信息。” 所以，我建议你使用它。

# core-data - CoreData：获取具有给定属性和给定关系的对象？

> ID：10677539
> 
> 赞同：0
> 
> 时间：2012-05-20T21:53:13.347
> 
> 标签：core-data, ios5, nsfetchrequest

我有一个看起来有点像这样的 CoreData 模型：

```
Object A:
  Results -- A one to many relationship to an indeterminate number of Object B's.

Object B:
  Object Name -- A string.  (potentially not unique)
  Parent -- A singular relationship with Object A. 
```

如果我知道给定的对象 A 和我正在寻找的对象名称字符串，我正在努力编写一个将返回 ObjectB 的 NSPredicate。我尝试了以下方法，但总是收到此错误：

“'NSInvalidArgumentException'，原因：'无法解析格式字符串......”

```
request.predicate = [NSPredicate predicateWithFormat:@"NameString == %@, SELF IN %@", NameString, ObjectA.results];

request.predicate = [NSPredicate predicateWithFormat:@"(NameString == %@) IN %@", NameString, ObjectA.results]; 
```

等等...

这似乎应该是一件简单而明显的事情，但我是 Core Data 的新手，我很难找到一个展示这一点的例子。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T09:33:59.027

您需要使用 %K。

你的谓词中可能需要这样的东西

```
 NSString enitity=@"ObjectA";
 NSString attribute=@"results";
 request.predicate = [NSPredicate predicateWithFormat:@"NameString == %@, SELF IN %K.%K", NameString, enitity,attributes]; 
```

[看这里。](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html)

# python - python中不同形状数组的元素乘法

> ID：10677542
> 
> 赞同：9
> 
> 时间：2012-05-20T21:53:55.810
> 
> 标签：python, arrays, numpy, multiplication

假设我有两个数组，`a`并且`b`

```
 a.shape = (5,2,3)
  b.shape = (2,3) 
```

然后`c = a * b`会给我一个`c`形状数组`(5,2,3)`。`c[i,j,k] = a[i,j,k]*b[j,k]`

现在的情况是，

```
 a.shape = (5,2,3)
  b.shape = (2,3,8) 
```

我想有`c`一个形状。`(5,2,3,8)``c[i,j,k,l] = a[i,j,k]*b[j,k,l]`

如何有效地做到这一点？我的`a`和`b`实际上相当大。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-20T22:37:00.830

这应该有效：

```
a[..., numpy.newaxis] * b[numpy.newaxis, ...] 
```

用法：

```
In : a = numpy.random.randn(5,2,3)

In : b = numpy.random.randn(2,3,8)

In : c = a[..., numpy.newaxis]*b[numpy.newaxis, ...]

In : c.shape
Out: (5, 2, 3, 8) 
```

参考：[numpy 中的数组广播](http://docs.scipy.org/doc/numpy-1.10.1/user/basics.broadcasting.html)

*编辑*：更新的参考 URL

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-20T22:32:40.707

我认为以下应该有效：

```
import numpy as np
a = np.random.normal(size=(5,2,3))
b = np.random.normal(size=(2,3,8))
c = np.einsum('ijk,jkl->ijkl',a,b) 
```

和：

```
In [5]: c.shape
Out[5]: (5, 2, 3, 8)

In [6]: a[0,0,1]*b[0,1,2]
Out[6]: -0.041308376453821738

In [7]: c[0,0,1,2]
Out[7]: -0.041308376453821738 
```

`np.einsum`使用起来可能有点棘手，但对于这些类型的索引问题非常强大：

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.einsum.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.einsum.html)

另请注意，这需要 numpy >= v1.6.0

我不确定您的特定问题的效率，但如果它的性能不如需要，一定要考虑使用带有显式 for 循环的 Cython，并可能使用并行化它`prange`

**更新**

```
In [18]: %timeit np.einsum('ijk,jkl->ijkl',a,b)
100000 loops, best of 3: 4.78 us per loop

In [19]: %timeit a[..., np.newaxis]*b[np.newaxis, ...]
100000 loops, best of 3: 12.2 us per loop

In [20]: a = np.random.normal(size=(50,20,30))
In [21]: b = np.random.normal(size=(20,30,80))

In [22]: %timeit np.einsum('ijk,jkl->ijkl',a,b)
100 loops, best of 3: 16.6 ms per loop

In [23]: %timeit a[..., np.newaxis]*b[np.newaxis, ...]
100 loops, best of 3: 16.6 ms per loop

In [2]: a = np.random.normal(size=(500,20,30))
In [3]: b = np.random.normal(size=(20,30,800))

In [4]: %timeit np.einsum('ijk,jkl->ijkl',a,b)
1 loops, best of 3: 3.31 s per loop

In [5]: %timeit a[..., np.newaxis]*b[np.newaxis, ...]
1 loops, best of 3: 2.6 s per loop 
```

# ruby - Ruby正则表达式将snake_casing转换为PascalCasing？

> ID：10677546
> 
> 赞同：3
> 
> 时间：2012-05-20T21:54:27.783
> 
> 标签：ruby, regex, pascalcasing

我创建了一个使用以下功能的 Web 框架：

```
def to_class(text)
    text.capitalize
    text.gsub(/(_|-)/, '')
end 
```

将目录名称转换为项目的`snake_cased`类名称。`hyphen-cased``PascalCased`

问题是，该函数只删除了`_`and `-`，并且没有大写下一个字母。使用`.capitalize`, 或`.upcase`有没有办法让你的`snake/hyphen_/-cased`名字变成正确的`PascalCased`类名？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T22:11:04.373

```
gsub(/(?:^|[_-])([a-z])?/) { $1.upcase unless $1.nil? } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-20T22:15:31.647

这会将 _ 大小写的字符串拆分为一个数组；将每个成员大写并将数组粘合回字符串：

```
def to_pascal_case(str)
  str.split(/-|_/).map(&:capitalize).join
end

p to_pascal_case("snake_cased") #=>"SnakeCased" 
```

您的代码不起作用有几个原因：

*   capitalize 方法的结果对象被丢弃 - 你应该做类似的事情`text.capitalize!`or `text = text.capitalize`。
*   但是该`capitalize`方法只是`upcase`字符串的第一个字母，而不是每个单词的第一个字母。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-20T22:05:35.517

Rails 有一个类似的方法叫做[camelize](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-camelize)。它基本上将字符串的每个部分都大写`[a-z0-9]`并删除其他所有部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-20T22:04:30.967

您可能可以将其缩小到更小的尺寸，但是：

```
txt = 'foo-bar_baz'
txt.gsub(/(?:^|[-_])([a-z])/) { |m| m.upcase }.gsub(/[-_]/, '') # FooBarBaz 
```

# c - 控制大小以适应窗口大小

> ID：10677549
> 
> 赞同：0
> 
> 时间：2012-05-20T21:54:47.900
> 
> 标签：c, winapi

我在表单上有一个文本框，我想将其设置为与窗口的高度/宽度相匹配。有没有办法在C中做到这一点？需要明确的是，这是 C 而不是 C-Sharp (C#)。我正在使用 DevC++

我必须创建文本框的代码：

```
HWND hwndText = CreateWindow(
    TEXT("edit"),
    TEXT(""),
    WS_VISIBLE | WS_CHILD | WS_BORDER | WS_HSCROLL | WS_VSCROLL| ES_MULTILINE | ES_AUTOHSCROLL,
    0,0,
    630,470, //Height & Width
    hwnd,
    (HMENU)ID_MYTEXT,
    hInstance,
    NULL
); 
```

完整来源：

```
#include <windows.h>

const char g_szClassName[] = "myWindowClass";

LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    switch(msg)
    {
        case WM_CLOSE:
            DestroyWindow(hwnd);
        break;
        case WM_DESTROY:
            PostQuitMessage(0);
        break;
        default:
            return DefWindowProc(hwnd, msg, wParam, lParam);
    }
    return 0;
}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance,
    LPSTR lpCmdLine, int nCmdShow)
{
    WNDCLASSEX wc;
    HWND hwnd;
    HMENU ID_MYTEXT;
    MSG Msg;

    wc.cbSize        = sizeof(WNDCLASSEX);
    wc.style         = 0;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hInstance;
    wc.hIcon         = LoadIcon(NULL, IDI_APPLICATION);
    wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);
    wc.lpszMenuName  = NULL;
    wc.lpszClassName = g_szClassName;
    wc.hIconSm       = LoadIcon(NULL, IDI_APPLICATION);

    if(!RegisterClassEx(&wc))
    {
        MessageBox(NULL, "Window Registration Failed!", "Error!",
            MB_ICONEXCLAMATION | MB_OK);
        return 0;
    }

    hwnd = CreateWindowEx(
        WS_EX_CLIENTEDGE,
        g_szClassName,
        "Title",
        WS_OVERLAPPEDWINDOW,
        CW_USEDEFAULT, CW_USEDEFAULT, 640, 480,
        NULL, NULL, hInstance, NULL
    );

    HWND hwndText = CreateWindow(
        TEXT("edit"),
        TEXT(""),
        WS_VISIBLE | WS_CHILD | WS_BORDER | WS_HSCROLL | WS_VSCROLL| ES_MULTILINE | ES_AUTOHSCROLL,
        0,0,
        630,470,
        hwnd,
        (HMENU)ID_MYTEXT,
        hInstance,
        NULL
    );

    if(hwnd == NULL)
    {
        MessageBox(NULL, "Window Creation Failed!", "Error!",
            MB_ICONEXCLAMATION | MB_OK);
        return 0;
    }

    ShowWindow(hwnd, nCmdShow);
    UpdateWindow(hwnd);

    SendMessage(hwndText, WM_SETTEXT, 0, (LPARAM)"");

    while(GetMessage(&Msg, NULL, 0, 0) > 0)
    {
        TranslateMessage(&Msg);
        DispatchMessage(&Msg);
    }
    return Msg.wParam;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:00:19.823

如果这就是您希望窗口中的全部内容，那么为什么不删除 WS_CHILD 样式并让按钮成为整个窗口呢？

另一种选择是处理[WM_SIZE 消息](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632646%28v=vs.85%29.aspx)并在那里调整您的子按钮窗口的大小。

第一个示例的最短版本如下所示：

```
#include "stdafx.h"

BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)
{
   HWND hWnd;

   hWnd = CreateWindow(_T("BUTTON"), L"testButton", WS_OVERLAPPEDWINDOW,
      CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, hInstance, NULL);

   if (!hWnd)
   {
      return FALSE;
   }

   ShowWindow(hWnd, nCmdShow);
   UpdateWindow(hWnd);

   return TRUE;
}

int APIENTRY _tWinMain(_In_ HINSTANCE hInstance,
                     _In_opt_ HINSTANCE hPrevInstance,
                     _In_ LPTSTR    lpCmdLine,
                     _In_ int       nCmdShow)
{
    UNREFERENCED_PARAMETER(hPrevInstance);
    UNREFERENCED_PARAMETER(lpCmdLine);

    // TODO: Place code here.
    MSG msg;

    // Perform application initialization:
    if (!InitInstance (hInstance, nCmdShow))
    {
        return FALSE;
    }

    // Main message loop:
    while (GetMessage(&msg, NULL, 0, 0))
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }

    return (int) msg.wParam;
} 
```

# c# - 在英国和美国显示日期时间

> ID：10677553
> 
> 赞同：3
> 
> 时间：2012-05-20T21:54:58.243
> 
> 标签：c#, datetime

**更新**

我想根据其当前的文化，使用通用方式以 24 小时格式**显示英国或美国的日期时间值。**

代码如下（不是实际代码，仅用于问题）：

```
 var dt = new DateTime(2011, 4, 15, 17, 50, 40);        
    Console.WriteLine(dt.ToString("d", new CultureInfo("en-us")) + " "
        + dt.ToString("H:mm:ss", new CultureInfo("en-us")));
    Console.WriteLine(dt.ToString("G", new CultureInfo("en-gb"))); 
```

结果如下：

**4** /15/2011 17:50:40
15/04/2011 17:50:40

它显示正常。

有没有更好的方法来显示时间而不使用“H:mm:ss”。请注意，美国的 G 显示 PM，这不是我想要的。

美国的月份是 4，而不是 04，有没有办法在**04**中显示它。.

**更新**

以下是我想要的，理想情况下使用通用方式：

美国：2011 年 4 月 15 日 17:50:40
英国：2011 年 4 月 15 日 17:50:40

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:09:08.313

尝试这个。

```
DateTime dt = new DateTime(2011, 4, 15, 17, 50, 40);        
Console.WriteLine(dt.ToString("MM/dd/yyy H:mm:ss"));// US format
Console.WriteLine(dt.ToString("dd/MM/yyy H:mm:ss"));// UK format 
```

来自 MSDN 的[自定义日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/zdtaw1bw.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:08:26.783

您可以像这样编写自己的自定义显示，

```
DateTime dt = DateTime.Now;
Console.WriteLine(dt.ToString(@"MM/dd/yy HH\:mm\:ss"));
Console.ReadLine();
// Displays 05/20/12 17:08:37 
```

[http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T22:20:33.990

你可以为我们做这样的事情：

```
CultureInfo ci = new CultureInfo("en-us", true);
ci.DateTimeFormat.ShortDatePattern = "MM/dd/yyyy";
ci.DateTimeFormat.LongTimePattern = "HH:mm:ss";
ci.DateTimeFormat.AMDesignator = "";
ci.DateTimeFormat.PMDesignator = ""; 
```

现在您可以像这样设置当前线程文化：

```
Thread.CurrentThread.CurrentCulture = ci;
Thread.CurrentThread.CurrentUICulture = ci; 
```

并像这样显示日期：

```
Console.WriteLine(dt.ToString("G")); 
```

或者，您可以将区域性作为参数传递给 ToString 方法，如下所示：

```
Console.WriteLine(dt.ToString("G", ci)); 
```

如果你更喜欢第二种方法，你可以将上面的代码包装在一个静态方法中，这样你就可以这样调用它：

```
Console.WriteLine(dt.ToString("G", Cultures.EnUs)); 
```

# asp.net - Asp.net 中的特殊 Javascript 函数？

> ID：10677558
> 
> 赞同：1
> 
> 时间：2012-05-20T21:56:04.503
> 
> 标签：asp.net

```
///<reference name="MicrosoftAjax.js"/>
Type.registerNamespace("AmpUI.Form");

AmpUI.Form.FBuilder = function (element) {
    AmpUI.Form.FBuilder.initializeBase(this, [element]);
    this._questions = null;
    this._formID = null;
    this._submitted = null;
    this._facID = null;
    this._formType = null;
    this._autoSaveID = null;
    this._typeName = null;
    this._enableAutoSave = true;
    this._autoSaveInterval = 30000;
    this._template = null;
    this._btnsave = null;
    this._btnsubmit = null;
    this._btnsavebottom = null;
    this._btnsubmitbottom = null;
    this._saveDelegate = null;
    this._submitDelegate = null;
    this._isautosave = null;
    this._saveCallback = null;
    this._submitCallback = null;
};

//define proto
AmpUI.Form.FBuilder.prototype = {
    initialize: function () {
        AmpUI.Form.FBuilder.callBaseMethod(this, "initialize");

        //wire up save/submit events
        if (this._submitted) {
            this.GetResponses(this);
        }
        else {

            //register the dependencies
            Array.forEach(this.get_qrefs(), function (e, i, a) {
                e.registerDepedency(a);
            });
            //start autosave
            if (this._enableAutoSave && !this._submitted) {
                this._autoSaveID = setInterval("$find('" + this._element.id + "').SaveForm(true);", this._autoSaveInterval);
            }
            if (this._saveDelegate === null) {
                this._saveDelegate = Function.createDelegate(this, this.Save);
            }
            Sys.UI.DomEvent.addHandler($get(this._btnsave), 'click', this._saveDelegate);
            Sys.UI.DomEvent.addHandler($get(this._btnsavebottom), 'click', this._saveDelegate);

            if (this._submitDelegate === null) {
                this._submitDelegate = Function.createDelegate(this, this.SubmitForm);
            }
            Sys.UI.DomEvent.addHandler($get(this._btnsubmit), 'click', this._submitDelegate);
            Sys.UI.DomEvent.addHandler($get(this._btnsubmitbottom), 'click', this._submitDelegate);
        }
        this._template = "<div class='form_question'><span>{2}</span><div class='form_answer'>{3}</div></div>";
    },
    dispose: function () {
        //init
        AmpUI.Form.FBuilder.callBaseMethod(this, "dispose");
    },
    SaveForm: function (is_auto) {
        this._isautosave = is_auto;
        var questions = this.get_json();
        var sa = new ampWeb.FormService();
        sa.SaveFormQuestions(Sys.Serialization.JavaScriptSerializer.serialize(this.get_json()), false, this._typeName, this.onSuccess, this.onFail, this);
    },
    Save: function () {
        this.SaveForm(false);
    },
    SubmitForm: function () {
        var useValidation = true;
        var valid = false;
        try {
            valid = Page_ClientValidate();
        }
        catch (e) {
            useValidation = false;
        }
        if (valid || !useValidation) {
            //stop autosave
            clearInterval(this._autoSaveID);
            autosaveEnabled = false;
            var sa = new ampWeb.FormService();
            sa.SaveFormQuestions(Sys.Serialization.JavaScriptSerializer.serialize(this.get_json()), true, this._typeName, this.onSubmitComplete, this.onFail, this);
        } else {
            $('#' + me._element.id + ' .fbuilder-result').html('Invalid responses were found.  Please make all required corrections before submitting.');
        }
    },
    onSuccess: function (s, me) {
        $('#' + me._element.id + ' .fbuilder-result').fadeOut();
        if (me._isautosave) {
            var now = new Date();
            $('#' + me._element.id + ' .fbuilder-result').html('Last autosave:' + now.format('hh:mm tt'));
        } else {
            $('#' + me._element.id + ' .fbuilder-result').html('Form has been saved.');
            me._save();
            if (me._saveCallback)
                me._saveCallback.call(me);
        }
        $('#' + me._element.id + ' .fbuilder-result').fadeIn();
    },
    onFail: function (r, me) {
        $('#' + me._element.id + ' .fbuilder-result').html(r.get_message());
        //var s = new ampWeb.FormService();
        //s.ReportAjaxError(r.get_message());
    },
    onSubmitComplete: function (r, me) {
        $('#' + me._element.id + ' .fbuilder-result').html('Your responses have been submitted.');
        $('#' + me._element.id).fadeOut('fast', function () {
            $('#' + me._element.id).html('<h1>Thank you for submitting.</h1>');
            clearInterval(me._autoSaveID);
            me._submitted = true;
            me.GetResponses(me);
            if (me._submitCallback)
                me._submitCallback.call(me);
        });
    },
    GetResponses: function (me) {
        var sa = new ampWeb.FormService();
        sa.GetFormResponses(me._formID, me.WriteToForm, me.onFail, me);
    },
    WriteToForm: function (answers, me) {
        var ar = Sys.Serialization.JavaScriptSerializer.deserialize(answers);
        //recreate if missing
        if ($('#' + me._element.id + ' #submitted').length == 0) { $('#' + me._element.id).append("<div id='submitted'/>"); }
        Array.forEach(ar, function (a) {
            $('#' + me._element.id + ' #submitted').append(String.format(me._template, null, null, a.question, a.response));
        });
        $('#' + me._element.id).fadeIn('fast');
        me._submit();
    },
    resetInterval: function () {
        if (this._enableAutoSave) {
            clearInterval(this._autoSaveID);
            this._autoSaveID = this._autoSaveID = setInterval("$find('" + this._element.id + "').SaveForm(true);", 30000);
        }
    },
    get_questions: function () {
        return Sys.Serialization.JavaScriptSerializer.serialize(this._questions);
    },
    set_questions: function (q) {
        this._questions = Sys.Serialization.JavaScriptSerializer.deserialize(q);
    },
    get_qrefs: function () {
        var a = new Array();
        Array.forEach(this._questions, function (i) {
            a.push($find(i));
        });
        return a;
    },
    get_json: function () {
        var a = new Array();
        Array.forEach(this._questions, function (i) {
            a.push($find(i));
        });
        var b = new Array();
        Array.forEach(a, function (i) {
            b.push(i.get_json());
        });
        return b;
    },
    get_formID: function () {
        return this._formID;
    },
    set_formID: function (value) {
        this._formID = value;
    },
    get_submitted: function () {
        return this._submitted;
    },
    set_submitted: function (value) {
        this._submitted = value;
    },
    set_facID: function (value) {
        this._facID = value;
    },
    get_facID: function () {
        return this._facID;
    },
    set_formType: function (value) {
        this._formType = value;
    },
    get_formType: function () {
        return this._formType;
    },
    set_typeName: function (value) {
        this._typeName = value;
    },
    get_typeName: function () {
        return this._typeName;
    },
    set_enableAutoSave: function (value) {
        this._enableAutoSave = value;
    },
    get_enableAutoSave: function () {
        return this._enableAutoSave;
    },
    set_autoSaveInterval: function (value) {
        if (!isNaN(value))
            this._autoSaveInterval = value;
    },
    get_autoSaveInterval: function () {
        return this._autoSaveInterval;
    },
    set_template: function (value) {
        this._template = value;
    },
    get_template: function () {
        return this._template;
    },
    set_btnsave: function (v) {
        this._btnsave = v;
    },
    get_btnsave: function () {
        return this._btnsave;
    },
    get_btnsubmit: function () {
        return this._btnsubmit;
    },
    set_btnsubmit: function (v) {
        this._btnsubmit = v;
    },
    set_btnsave: function (v) {
        this._btnsave = v;
    },
    get_btnsavebottom: function () {
        return this._btnsavebottom;
    },
    get_btnsubmitbottom: function () {
        return this._btnsubmitbottom;
    },
    set_btnsubmitbottom: function (v) {
        this._btnsubmitbottom = v;
    },
    set_btnsavebottom: function (v) {
        this._btnsavebottom = v;
    },
    get_saveCallback: function () {
        return this._saveCallback;
    },
    set_saveCallback: function (f) {
        var fn = window[f];
        if (fn && typeof (fn) === 'function')
            this._saveCallback = fn;
    },
    get_submitCallback: function (f) {
        return this._submitCallback;
    },
    set_submitCallback: function (f) {
        var fn = window[f];
        if (fn && typeof (fn) === 'function')
            this._submitCallback = fn;
    },
    add_save: function (handler) {
        this.get_events().addHandler("save", handler);
    },
    remove_save: function (handler) {
        this.get_events().removeHandler("save", handler);
    },
    _save: function () {
        var handler = this.get_events().getHandler("save");
        if (handler) handler(this, Sys.EventArgs.Empty);
    },
    add_submit: function (handler) {
        this.get_events().addHandler("submit", handler);
    },
    remove_submit: function (handler) {
        this.get_events().removeHandler("submit", handler);
    },
    _submit: function () {
        var handler = this.get_events().getHandler("submit");
        if (handler) handler(this, Sys.EventArgs.Empty);
    }
}
//register in the namespace
AmpUI.Form.FBuilder.registerClass("AmpUI.Form.FBuilder", Sys.UI.Control);
if (typeof (Sys) !== "undefined") Sys.Application.notifyScriptLoaded(); 
```

很特别吗？例如，我从不理解 Javascript 函数中的 addHandlder 和 removeHandler 以及什么是 registerNamespace 和什么是 Sys.Application.notifyScriptLoaded();？

很特别吗？例如，我从不理解 Javascript 函数中的 addHandlder 和 removeHandler 以及什么是 registerNamespace 和什么是 Sys.Application.notifyScriptLoaded();？

# c - 使用 fread 时的垃圾数据

> ID：10677560
> 
> 赞同：1
> 
> 时间：2012-05-20T21:56:23.397
> 
> 标签：c, arrays, string, file-io

我正在尝试使用 fread 从文本文件中获取数据行。我的程序做的第一件事是打开文本文件，并确定每行开头的字节偏移量。

第 1 行的字节偏移量为 0，并注视在`offset[1]`. 第 2 行的字节偏移量可能是 45 个字节，这将存储在 中`offset[2]`，依此类推。的字节偏移量`EOF`存储在`array[lastline + 1]`

在一个循环中，我试图使用这些语句来打印我想要的内容：

```
fseek(fptr, ptr[line], SEEK_SET);
fread(str, sizeof(char),  (  (ptr[line + 1] - ptr[line]) - 2) / sizeof(char) , fptr);
printf("%03ld %03ld %s\n", line, ptr[line + 1 ] - ptr[line], str); 
```

我的 fread 语句`((ptr[line + 1] - ptr[line]) - 2) / sizeof(char)`用于打印元素的数量。我在这里有几个担忧。

1.  我正在使用 -2 来尝试解释换行符和回车符。我的教授说由于换行符和回车符，我有两个额外的字节/行。我应该尝试以这种方式照顾他们吗？它会使我的程序不那么便携吗？
2.  我的程序将根据用户请求打印一系列行或单行。当我打印多行时，第二行的输出确实被破坏了。

    打印第 2 到 4 行 ... LINE: 2 002 005 123 003 011 123456789¼ü|♥ 004 007 123456789¼ü|♥</p>

第一列是行号，第二列是该行的字节长度，而不是字节偏移量。当我只打印一行时，它有时会被破坏，但并非总是如此。

```
Printing line 1...
001 008 123456☻ 
```

我在想我要么没有正确使用 fread，要么我正在做一些非常奇怪的事情，我从文本文件中读取并在打印之前将其存储到临时字符串中。似乎是什么问题？

编辑：

好的，所以我使用 fread 的循环已经将返回值分配给了某个变量。直到现在我都不知道该怎么处理它。按照评论中的建议，我正在使用

```
count = fread(stuff);
str[count] = '\0'; 
```

这似乎已经解决了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T21:59:02.333

我认为您可能忘记了空终止符

`char s[] = "ABC"; // {'A', 'B', 'C', '\0'}`

`s[3] = '\0';`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T21:59:26.360

在`str[something] = 0`使用`str`. 如果您正在处理一个文本文件，它肯定不会包含 0 终止符。

这可能是返回的字符数`fread`。

* * *

旁注：`sizeof(char)`看起来很荒谬，因为它的定义是 1。

# android - 程序没有在模拟器中运行

> ID：10677562
> 
> 赞同：-3
> 
> 时间：2012-05-20T21:56:44.677
> 
> 标签：android, eclipse, avd

我正在运行一个 android 应用程序，它只是弹出一个窗口说“你好”。当我在模拟器中运行它时，它显示“不幸的是，HelloAndroid 已停止。” 我的代码有错误吗？

```
package com.example.helloandroid;

import java.awt.Color;

import javax.swing.JFrame;
import javax.swing.JLabel;

public class HelloAndroid {

  public static void main(String[] args) {
    JFrame window = new JFrame();
    window.setVisible(true);
    window.setSize(200, 300);

    JLabel text = new JLabel();
    text.setText("Hello");
    text.setForeground(Color.RED);
    window.add(text);
  }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T05:57:35.773

Android 不支持 Swing/(IIRC) awt 或完整的桌面 Java API。对不起。

# java - 使用 Jsoup 解析 html 并删除特定样式的 span

> ID：10677565
> 
> 赞同：4
> 
> 时间：2012-05-20T21:57:06.093
> 
> 标签：java, android, html, jsoup

我正在为朋友写一个应用程序，但我遇到了问题，网站上有这些

```
<span style="display:none">&amp;0000000000000217000000</span> 
```

我们甚至不知道它们是什么，但我需要删除它们，因为我的应用程序正在输出它们的价值。

有什么方法可以检查它是否在元素中并将其删除？我有一个 for-each 循环解析但是我不知道如何有效地删除这个元素。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T15:55:34.290

如果您想完全基于样式属性删除这些跨度，请尝试以下代码：

```
String html = "<span style=\"display:none\">&amp;0000000000000217000000</span>";
html += "<span style=\"display:none\">&amp;1111111111111111111111111</span>";
html += "<p>Test paragraph should not be removed</p>";

Document doc = Jsoup.parse(html);

doc.select("span[style*=display:none]").remove();

System.out.println(doc); 
```

这是输出：

```
<html>
 <head></head>
 <body>
  <p>Test paragraph should not be removed</p>
 </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T11:05:35.173

试试这个：

```
//Assuming you have all the data in a Document called doc:
String cleanData = doc.select("query").text(); 
```

文本（）; 方法将清除所有 html 标签并用人类可读的内容替换所有编码。哦，是的，然后是方法 ownText(); 这也可能有帮助。我不能说哪个最适合您的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T01:05:36.630

您可以使用 JSOUP 访问元素的 innerHTML，删除转义字符，并替换 innerHTML：

```
Elements elements = doc.select('span');
for(Element e : elements) {
    e.html( e.html().replaceAll("&amp;","") );
} 
```

在上面的示例中，使用包含违规字符的所有元素的选择器获取所有元素的集合。之后，将 替换`&amp;`为空字符串或您想要的任何字符。

此外，您应该知道这`&amp;`是`&`字符的转义码。如果没有转义`&`字符，您可能会遇到 HTML 验证问题。就您而言，如果没有其他信息，我假设您只是真的想消除它们。如果没有，这将帮助您入门。祝你好运！

如果您需要删除尾随数字：

```
// eliminate ampersand and all trailing numbers
e.html( e.html().replaceAll("&amp;[0-9]*","") ); 
```

有关正则表达式的更多信息，请参阅[Regex Pattern 上的 Javadocs](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#sum)。

# nginx - 在一个 aws ec2 实例上托管两个网站

> ID：10677568
> 
> 赞同：2
> 
> 时间：2012-05-20T21:57:36.343
> 
> 标签：nginx, amazon-web-services, hosting

我有一个当前在 aws 实例上运行的网站，现在我想在同一实例中托管另一个网站。我正在运行 nginx 作为服务器。您知道是否可以在该实例上托管两个网站？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:03:54.403

是的。您需要查看[Server Blocks](http://wiki.nginx.org/ServerBlockExample)，它大致相当于 Apache 中的 VirtualHosts。另请参阅[基本 Nginx 配置](http://library.linode.com/web-servers/nginx/configuration/basic)。

# macos - 为什么我的 Node.js 服务器不回复数据？

> ID：10677569
> 
> 赞同：0
> 
> 时间：2012-05-20T21:57:47.460
> 
> 标签：macos, node.js

我在[这里](http://nodeguide.com/beginner.html)做教程。到目前为止，我已经完成了所有工作：

```
var http = require('http');

var server = http.createServer(function(req, res) {
  res.writeHead(200);
  res.end('Hello Http'); 
});

server.listen(8080); 
```

当我使用`node hello_http.js`它运行上面的内容时，它没有按预期退出，但是当我`localhost:8080`在浏览器中查看时，什么也没有，当`curl`我得到这个时：

> curl：（52）来自服务器的空回复

我应该如何寻找问题？我应该补充的一件事是，几周前我在玩 Cherrypy，当我在浏览器中访问 localhost 时，我看到了 Cherrypy favicon。Cherrypy 是否以某种方式干扰了这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:07:45.910

将端口从 8080 更改为 3000。8080 是通用端口，因此您很可能是正确的，其他服务器正在使用它。

# jquery - Rails，当用户选择组合框值时更改数据库值

> ID：10677579
> 
> 赞同：0
> 
> 时间：2012-05-20T21:58:35.167
> 
> 标签：jquery, ruby-on-rails-3, coffeescript

我在 Rails 3.2 中有一个数据表的脚手架。当我查看表单时，我有一个用户可以更改的组合框，该值将立即存储在数据库中，而无需进入编辑模式并在那里更改并按保存。

我已经使用咖啡脚本捕获了更改的值：

```
$(document).ready ->
  $("#change_department").change ->
    $ajax
      url: "/Locations/" + # need to set id and new value here
      success: (data) ->
        alert data # will need to write a confirmation below the combobox 
```

我头疼的是我应该调用什么控制器操作以及我应该如何准备数据。我正在考虑创建一个新的控制器操作，在其中我将传入模型的 id 和组合框中的新值，在控制器中我会找到模型并传入更改后的值。这可能应该是一个在 url 中有两个参数的 get 方法（我不确定如何使用 post 来做到这一点）。这是一个好的方法还是有人会建议替代方法？

我如何在上面的咖啡脚本代码中获取 id 和更改的值？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T01:16:21.913

1）更新数据时，使用PUT请求。这就是 Rails 的基本 RESTful 风格（`GET`→ `show`、`POST`→ `create`、`PUT`→ `update`、`DELETE`→destroy）。所以基本上，要调用的操作是`LocationsController#update`（根据您发布的代码判断）。无需新动作

2）将整个更新路径`data-`放在元素上的一个属性中。当您说“组合框”时，我假设您的意思是“下拉菜单”，在这种情况下，它将类似于`<select id="change_department" name="location[department]" data-uri="/Locations/23"> ...`

```
$("#change_department").change ->
  url  = $(this).data("uri")
  data = {}
  data[@name] = @value
  $.ajax
    method: "put"
    url:    url
    data:   data
    success: ... 
```

在控制器端，更新操作可以保持不变。

# c - 开关和默认值：对于 C

> ID：10677584
> 
> 赞同：2
> 
> 时间：2012-05-20T21:59:50.587
> 
> 标签：c, switch-statement, default-value

对不起，如果这听起来像一个非常基本的问题，这是我第一次来这里！

我在为 C 编码时遇到了一些困难，特别是使用开关和该开关的默认值。这是一些示例代码：

```
#include<stdio.h>

int key;
main()
{
while((key=getchar())!=EOF)
{
printf("you pressed %c \n",key);
    switch(key){
case'0':
case'1':
case'2':
case'3':
   printf("it's a numeral\n");
   break;
default:
   printf("it's not a numeral\n");
  } 
 }
} 
```

实际代码要长一些，这纯粹是一个例子。

所以代码编译它并执行它，但我得到：

“你按 1，它是一个数字，你按 ，它不是一个数字。”

我的代码似乎“失败”并在不提及任何一个的情况下重复自身。如果有人可以提供帮助，那就太好了，因为这是教科书中的一个例子，我完全被困住了！

最亲切的问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:03:12.670

您需要吃掉换行符，当您点击时将其放入读取缓冲区`return`。

在切换之后或之前发出另一个呼叫以`getchar`解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:16:54.680

您需要考虑输入 Enter 键，它会在 *nix 系统上生成一个 '\n'。我不确定在 Windows 系统上按 Enter 键有什么作用。

这是您修改后的原始代码以吃回车键。

```
#include<stdio.h>

int key = 0;
main()
{
    while((key=getchar())!=EOF)
    {
        if('\n' == key)
        {
            /* Be silent on linefeeds */
            continue;
        }

        printf("you pressed %c \n",key);
            switch(key){
        case'0':
        case'1':
        case'2':
        case'3':
           printf("it's a numeral\n");
           break;

        default:
           printf("it's not a numeral\n");
      } 
     }
} 
```

您可能`getchar()`出于特定原因使用，但我在 C 语言中的经验通常涉及阅读整行，而 RTL 函数之类`scanf`的会为您吃掉行终止符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T22:03:47.873

这是一个想法...紧接在`printf()`, 之前插入逻辑以忽略空格和所有控制字符...

```
if(key <= ' ')
  continue;
printf(...) ... 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-20T22:16:29.787

我不知道这是否是问题，但你有三个案例没有休息。所以你按下“1”键，程序就没有什么可做的了，所以进入下一个案例，这是正确的，这是默认的。虽然你在一个 int 变量中取了一个 char ？？？

在您的示例中，采用这样的 if 子句是一种更好的方法：

```
#include<stdio.h>

char key;
main()
{
while((key=getchar())!=EOF)
{
printf("you pressed %c \n",key);
   if(key == '0' || key == '1' || key == '2' || key == '3'){
      printf("it's a numeral\n");
   }
   else {
      printf("it's not a numeral\n");
   }
} 
```

代码未经测试。;-)

大型程序中最好的方法是使用正则表达式。

我希望，这个答案是有帮助的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-20T22:27:19.530

*   问题可能是由于输入缓冲区未刷新。当在 switch case 中匹配“1”时，缓冲区中会保留一个换行符。
*   尝试这个，

    ```
     fflush(stdin)
    ```

# ruby-on-rails - 使用 rails 编辑单个表单域

> ID：10677589
> 
> 赞同：1
> 
> 时间：2012-05-20T22:00:41.107
> 
> 标签：ruby-on-rails

我的视图中有一个表单域，与我的初始表单不同。我希望使用该应用程序的人能够编辑单个字段而不必拉出整个表单。我的代码如下

```
 <%= form_for :user, :url => {:controller => 'users', :action => 'update' } do |f| %>
          <%= f.text_field :barcode %>
          <%= submit_tag 'Register' %>
     <% end %> 
```

尝试将更改提交到指定的表单字段时，我相信我在 create 方法上收到错误。它将我重定向到具有正确 id 的用户控制器，但给了我以下错误。

```
 Unknown action
 The action '1' could not be found for UsersController 
```

我曾尝试将方法从更新更改为创建，但是它会弹出空白表单，我只想能够编辑指定的字段而不必重新创建表单并得到错误。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T22:06:54.763

您没有将用户对象传递给表单。也尝试使用路由生成的路径助手：

```
 <%= form_for @user, :url => user_path(@user) do |f| %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:15:38.670

```
 <%= form_for(@user), :url => url_for(:controller => 'users', :action => 'update') do |f| %>
     <%= f.text_field :barcode %>
     <%= f.submit, 'Register' %>
 <% end %> 
```

它现在应该可以工作...

# wordpress - BuddyPress：订阅者无法更改密码

> ID：10677593
> 
> 赞同：0
> 
> 时间：2012-05-20T22:01:24.813
> 
> 标签：wordpress, buddypress

我正在处理一个影响我的 BuddyPress 网站的突然（非常乏味）的错误：订阅者不能再更改他们的密码了！！！简而言之，管理员可以照常更改密码，但订阅者总是会收到以下错误消息：“您当前的密码无效。”。

有没有人有同样的问题？我该如何解决？是偶然的 BuddyPress 错误吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T18:25:09.760

最后我发现了错误：BuddyPress 的最后一个版本也需要用户当前密码，但我的主题文件不是最新的。

# bash - 仅打印与 bash 脚本的多个字符串不同的行

> ID：10677594
> 
> 赞同：0
> 
> 时间：2012-05-20T22:01:32.807
> 
> 标签：bash

我有以下输入：

```
/ > blablabla
title 1 
-------
title 2
-------
...
-------
title n
/ > 
```

现在我只需要阅读包含标题的行，所以我必须删除 ------ 和 / >。我设法排除了所有-----：

```
if [ "$LINE" != "-------" ] 
```

但问题是删除这两行：

```
/ >blablabla
/ > 
```

（blablabla 可能会改变）。我想排除所有以“/ >”开头的字符串但是我尝试了几种方法都没有成功。

和：

```
if [[ $LINE!=/* ]] 
```

我没有成功。获得该结果的正确方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T22:08:51.057

要仅迭代标题，您可以尝试以下操作：

```
grep -vE '^(/ >|---)' your_file.txt |while read line; do 
  # process the titles
  echo $line
done 
```

这将排除您不关心的两种类型的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T01:32:06.080

```
pattern='^/ > |^-------'
while read -r line
do
    if [[ ! $line =~ $pattern ]]
    then
        printf '%s\n' "$line"
    fi
done < inputfile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T22:10:49.170

```
while read line; do
  case $line in
    '/ >'*|---*)
      continue;;
  esac
  echo "$line"
done << \EOF
/ >blablabla
title 1 
-------
title 2
-------
...
-------
title n
/ > 
EOF 
```

# java - Java 声明的类型参数只有字符串

> ID：10677596
> 
> 赞同：2
> 
> 时间：2012-05-20T22:01:57.200
> 
> 标签：java, generics

我有一个类，它应该根据定义仅使用 String 参数工作。

所以我考虑使用

```
class MyClass<T extends String> 
```

但随后编译器发出警告，字符串是最终的，我无法扩展它

然后尝试了

```
class MyClass<String> 
```

并收到警告，因为参数 String 隐藏了类 String。

我需要做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:10:25.230

感谢启发性的评论：“你真的需要泛型”吗？

我查看了我的代码并发现了问题。我想使用类型参数，因为我正在实现一个接口

```
interface MyInterface<T> 
```

出于某种原因，我认为我需要实现类中的类型参数，例如：

```
class MyClass<String> implements MyInterface<T> 
```

但这没有意义。我需要做的是：

```
class MyClass implements MyInterface<String> 
```

解决了 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T22:20:25.463

在我看来，您根本不需要泛型。如果您不需要，您不应该过度复杂化您的代码。如果您的类应该只使用字符串参数，则只需省略*通用*部分。

所以，而不是：

```
class MyClass<T extends String> {
  T myMethod() {
    //...
  }
  //...
} 
```

做就是了：

```
class MyClass {
  String myMethod() {
    //...
  }
  //...
} 
```

# php - 无法使用变量访问数组中的值来指定索引

> ID：10677599
> 
> 赞同：2
> 
> 时间：2012-05-20T22:02:18.713
> 
> 标签：php

我有以下代码：

```
$id = $_GET['id'];

echo '<br>' . 'id: ' . $id . '<br><br>';

echo '<pre>';
            print_r($itemQtys);
echo '</pre>';

echo '<br>' . 'itemqtys[id]: ' . $itemQtys[$id] . '<br>';

echo '<br>' . 'id: ' . $id . '<br>'; 
```

输出是：

> 编号：5
> 
> 数组
> （
> [5] => 12
> ）
> 
> itemqtys[id]:
> 
> 编号：5

如您所见，当我尝试使用 $id 变量作为键访问数组中的值时，没有返回任何值。但是，当我这样做时：

```
echo '<br>' . 'itemqtys[5]: ' . $itemQtys[5] . '<br>'; 
```

结果是：

> 项目数量 [5]: 12

为什么我不能使用变量来指定数组中的索引？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T22:06:18.680

调试时使用 var_dump() 检查值。注意 var dump 告诉你字符串的长度。调试时右键单击>查看html源代码。

我的猜测是 $id 是一个字符串并且有尾随空格字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:06:50.873

`$id`可能不包含您期望的内容，请先将其转换为整数。

将第一行更改为：

`$id = (int) $_GET['id']`;

`$_GET['id']`返回一个字符串，您必须`int`在将其用作数组索引之前将其转换为。

# matlab - 我无法关闭 MATLAB，并跳出错误消息

> ID：10677602
> 
> 赞同：2
> 
> 时间：2012-05-20T22:03:07.770
> 
> 标签：matlab

我最近无法关闭我的 MATLAB。我输入*exit*，但有一条错误消息：

> > 使用 feof 时出错 文件标识符无效。使用 fopen 生成有效的文件标识符。
> > 
> > 〜feof（fid）时preserve_history（第12行）出错
> > 
> > 完成错误（第 3 行）preserve_history；

谁能告诉我我的 MATLAB 出了什么问题？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T23:02:53.383

当您尝试退出时，您有一个[`finish`脚本会自动运行，并且其中有一个错误。](http://www.mathworks.co.uk/help/techdoc/ref/finish.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T15:11:06.120

有用`quit force`吗？
它应该绕过finish.m

# ruby-on-rails-3 - Rails：在任何来源中都找不到 bcrypt-ruby-3.0.1

> ID：10677604
> 
> 赞同：2
> 
> 时间：2012-05-20T22:03:13.957
> 
> 标签：ruby-on-rails-3

我阅读了无数关于 ruby​​ 中缺少 gems 的 stackoverflow 文章，但我仍然无法解决问题。情况如下：

```
nicolamac:Proj a$ rails new MyGreatApp
[...]
nicolamac:Proj a$ cd MyGreatApp/
[...]
nicolamac:MyGreatApp a$ bundle install
[...]
Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed. 
```

但如果我这样做：

```
nicolamac:MyGreatApp nicolagreco$ rails generate devise:install 
```

我明白了

```
Could not find bcrypt-ruby-3.0.1 in any of the sources 
```

我怎么解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T08:15:49.927

尝试通过添加到您的 Gemfile 来安装它：

```
gem "bcrypt-ruby" 
```

然后运行

```
bundle install 
```

# grails - Grails OSGi 插件安装错误

> ID：10677607
> 
> 赞同：0
> 
> 时间：2012-05-20T22:03:36.980
> 
> 标签：grails, osgi, grails-plugin

我正在尝试将 Grails OSGi 插件安装到新的 Grails 2.0.3 应用程序中。

```
> grails create-app sandbox
| Created Grails Application at /home/pocon64/sandbox

> cd sandbox

> grails install-plugin osgi
| Plugin installed.

> grails run-war
| Loading Grails 2.0.3
| Error WARNING: Dependencies cannot be resolved for plugin [osgi] due to error: Cannot cast object '{}' with class 'groovy.util.ConfigObject' to class 'org.apache.ivy.plugins.resolver.ResolverSettings' due to: groovy.lang.GroovyRuntimeException: Could not find matching constructor for: org.apache.ivy.plugins.resolver.ResolverSettings(groovy.util.ConfigObject) (NOTE: Stack trace has been filtered. Use --verbose to see entire trace.)
org.codehaus.groovy.runtime.typehandling.GroovyCastException: Cannot cast object '{}' with class 'groovy.util.ConfigObject' to class 'org.apache.ivy.plugins.resolver.ResolverSettings' due to: groovy.lang.GroovyRuntimeException: Could not find matching constructor for: org.apache.ivy.plugins.resolver.ResolverSettings(groovy.util.ConfigObject)
    at dependencies$_run_closure1_closure4.doCall(dependencies.groovy:45)
    at dependencies$_run_closure1_closure4.doCall(dependencies.groovy)
    at java_util_concurrent_Callable$call.call(Unknown Source)
    at java_util_concurrent_Callable$call.call(Unknown Source)
    at dependencies$_run_closure1.doCall(dependencies.groovy:28)
    at dependencies$_run_closure1.doCall(dependencies.groovy)
    at grails.util.BuildSettings$_pluginDependencyHandler_closure11.doCall(BuildSettings.groovy:1278)
    at grails.util.BuildSettings$_pluginDependencyHandler_closure11.call(BuildSettings.groovy)
    at grails.util.BuildSettings.configureDependencyManager(BuildSettings.groovy:1219)
    at grails.util.BuildSettings$configureDependencyManager.callCurrent(Unknown Source)
    at grails.util.BuildSettings.postLoadConfig(BuildSettings.groovy:1102)
    at grails.util.BuildSettings.loadConfig(BuildSettings.groovy:999)
    at grails.util.BuildSettings$loadConfig$0.callCurrent(Unknown Source)
    at grails.util.BuildSettings.loadConfig(BuildSettings.groovy:982)
    at grails.util.BuildSettings$loadConfig.callCurrent(Unknown Source)
at grails.util.BuildSettings.loadConfig(BuildSettings.groovy:959)
| Error WARNING: Dependencies cannot be resolved for plugin [osgi] due to error: Cannot cast object '{}' with class 'groovy.util.ConfigObject' to class 'org.apache.ivy.plugins.resolver.ResolverSettings' due to: groovy.lang.GroovyRuntimeException: Could not find matching constructor for: org.apache.ivy.plugins.resolver.ResolverSettings(groovy.util.ConfigObject)
| Compiling 42 source files.
| Error Compilation error: startup failed:
Compile error during compilation with javac.
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:3: package org.osgi.framework does not exist
import org.osgi.framework.Bundle;
                         ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:4: package org.osgi.framework does not exist
import org.osgi.framework.BundleContext;
                         ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:8: package org.springframework.osgi.context does not exist
import org.springframework.osgi.context.ConfigurableOsgiBundleApplicationContext;
                                       ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:11: cannot find symbol
symbol: class ConfigurableOsgiBundleApplicationContext
    GrailsWebApplicationContext implements ConfigurableOsgiBundleApplicationContext {
                                           ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:13: cannot find symbol
symbol  : class BundleContext
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
    private BundleContext bundleContext = null;
            ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:54: cannot find symbol
symbol  : class Bundle
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
    public Bundle getBundle() {
           ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:64: cannot find symbol
symbol  : class BundleContext
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
    public BundleContext getBundleContext() {
           ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:71: cannot find symbol
symbol  : class BundleContext
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
    public void setBundleContext(BundleContext context) {
                                 ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:42: cannot find symbol
symbol  : class ConfigurableOsgiBundleApplicationContext
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
    if (parent instanceof ConfigurableOsgiBundleApplicationContext) {
                          ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:43: cannot find symbol
symbol  : class ConfigurableOsgiBundleApplicationContext
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
        ConfigurableOsgiBundleApplicationContext osgiParent = (ConfigurableOsgiBundleApplicationContext) parent;
        ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:43: cannot find symbol
symbol  : class ConfigurableOsgiBundleApplicationContext
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
        ConfigurableOsgiBundleApplicationContext osgiParent = (ConfigurableOsgiBundleApplicationContext) parent;
                                                               ^
/home/pocon64/.grails/2.0.3/projects/sandbox/plugins/osgi-0.2.1/src/java/org/codehaus/groovy/grails/commons/spring/GrailsOsgiWebApplicationContext.java:44: cannot find symbol
symbol  : class BundleContext
location: class org.codehaus.groovy.grails.commons.spring.GrailsOsgiWebApplicationContext
                    BundleContext context = osgiParent.getBundleContext();
                    ^
12 errors

1 error 
```

在我尝试建立战争之前，似乎一切都很好。我不明白缺少哪个依赖项，或者为什么？我可能遗漏了一些简单的东西，因为我对 Grails 很陌生，但我一生都无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T01:57:58.833

尝试在 BuildConfig.groovy 中取消注释以下内容：

```
mavenCentral() 
```

并重试。

# symfony1 - 带有扩展选项（Symfony）的 sfWidgetFormDoctrineChoice 中的滚动条？

> ID：10677612
> 
> 赞同：-1
> 
> 时间：2012-05-20T22:04:32.003
> 
> 标签：symfony1, scrollbar, symfony-1.4

是否可以在 sfWidgetFormDoctrineChoice 上有一个带有扩展 => true 的滚动条？提前致谢。我这样做了，但没有奏效：

```
... = new sfWidgetFormDoctrineChoice(array('multiple' => true, 'model' => 
'Something','expanded' => true),array('style' => 'height: 200px')); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T08:38:34.943

在您的模板中执行此操作：您可以将小部件放入具有固定高度的 div 中，并将溢出道具设置为自动：

```
<div style="height:200px;overflow:auto">
   <?php echo $form['myChoice']->render() ?>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:45:06.373

用css限制选择框的高度怎么样？

# javascript - JQuery Vertical Tabs - 创建指向选项卡的附加链接

> ID：10677613
> 
> 赞同：1
> 
> 时间：2012-05-20T22:04:39.680
> 
> 标签：javascript, jquery, jquery-ui-tabs

我正在将此脚本用于 jQuery 垂直选项卡。

[http://www.scriptbreaker.com/javascript/script/JQuery-vertical-tab-menu](http://www.scriptbreaker.com/javascript/script/JQuery-vertical-tab-menu)

```
<script language="JavaScript">
$(document).ready(function() {

$(".tabs .tab[id^=tab_menu]").hover(function() {
    var curMenu=$(this);
    $(".tabs .tab[id^=tab_menu]").removeClass("selected");
    curMenu.addClass("selected");

    var index=curMenu.attr("id").split("tab_menu_")[1];
    $(".curvedContainer .tabcontent").css("display","none");
    $(".curvedContainer #tab_content_"+index).css("display","block");
});
});
</script> 
```

这是选项卡（链接）的 HTML

```
<div class="tabscontainer">
 <div class="tabs">
     <div class="tab selected first" id="tab_menu_1">
         <div class="link">JavaScript</div>
         <div class="arrow"></div>
     </div>
     <div class="tab" id="tab_menu_2">
         <div class="link">CSS</div>
         <div class="arrow"></div>
     </div>
      <div class="tab last" id="tab_menu_3">
         <div class="link">JQuery</div>
         <div class="arrow"></div>
     </div>
</div> 
```

我正在尝试创建一个从选项卡内容到另一个选项卡的附加链接。

所以这样我可以链接到下一个选项卡或最后一个选项卡，保持与当前选项卡链接相同的功能（不刷新）

这是我关于 stackoverflow 的第一个问题，我已经进行了广泛的搜索。

我真的很感谢所有的帮助。这是一个很棒的社区。

更新：

好的，这是我的完整代码的编辑：

```
<script type="text/javascript">
$(document).ready(function() {

$(".tabs .tab[id^=tab_menu]").click(function() {
    var curMenu=$(this);
    $(".tabs .tab[id^=tab_menu]").removeClass("selected");
    curMenu.addClass("selected");

    var index=curMenu.attr("id").split("tab_menu_")[1];
    $(".curvedContainer .tabcontent").css("display","none");
    $(".curvedContainer #tab_content_"+index).css("display","block");

});

});
</script>

<div class="curvedContainer">       

<div class="tabcontent" id="tab_content_1" style="display:block">
<p>text</p> 
</div>

<div class="tabcontent" id="tab_content_2">
<p>text</p>
</div>

<div class="tabcontent" id="tab_content_3">
<p>text</p>
</div>

<div class="tabcontent" id="tab_content_4"><h2 class="wwd_title">
<p>text</p> 
</div>  

</div>

<div class="tabscontainer">

<div class="tabs">         
<div class="tab selected first" id="tab_menu_1">             
<div class="link">Onefish</div>       
</div>         
<div class="tab" id="tab_menu_2">             
<div class="link">Twofish</div>                   
</div>         
<div class="tab" id="tab_menu_3">             
<div class="link">Redfish</div>         
</div>          
<div class="tab last" id="tab_menu_4">             
<div class="link">Bluefish</div>                     
</div>    
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T02:42:37.943

为了使选项卡内容中的链接强制选项卡切换，有助于了解幕后发生的事情以使它们默认切换。

默认情况下，鼠标悬停事件会强制选项卡更改；因此，解决方案是通过将事件绑定到选项卡内容中的超链接来覆盖相关超链接的默认单击事件：

**将此代码包含在您在问题中显示的 JavaScript 代码之后，在 $(document).ready 内**：

```
$('.tabcontent').find('a').click(function() {
    event.preventDefault();
    $('.tabs #' + $(this).attr("rel")).mouseover();
}); 
```

event.preventDefault() 防止超链接尝试重定向到在 href 属性中输入的页面，而 rel 属性用作将超链接绑定到链接到的特定选项卡的一种方式。

rel 属性用于获取选项卡的 id 值，因此我们可以通过编程方式调用其 mouseover 事件并切换选项卡。

```
<div class="tabscontainer">
 <div class="tabs">
     <div class="tab selected first" id="tab_menu_1">
         <div class="link">JavaScript</div>
         <div class="arrow"></div>
     </div>
     <div class="tab" id="tab_menu_2">
         <div class="link">CSS</div>
         <div class="arrow"></div>
     </div>
      <div class="tab last" id="tab_menu_3">
         <div class="link">JQuery</div>
         <div class="arrow"></div>
     </div>          
</div>
    <div class="curvedContainer">
        <div class="tabcontent" id="tab_content_1" style="display:block">content for tab 1 <a href="#" rel="tab_menu_2"> tab2</a></div>
        <div class="tabcontent" id="tab_content_2">content for tab 2</div>
        <div class="tabcontent" id="tab_content_3">content for tab 3</div>
    </div> 
```

在选项卡的 HTML 内容中，只需像往常一样使用 href="#" 和 rel 属性包含超链接。rel 属性必须等于目标选项卡的 id，在本例中为 tab_menu_2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T07:08:32.043

**它根据您的要求工作**

只需添加

```
 <div class="tabs">
             <div class="tab selected first" id="tab_menu_1">
                 <div class="link">JavaScript</div>
                 <div class="arrow"></div>
             </div>
        </div> 
```

在任何选项卡中

转到此链接[http://jsfiddle.net/ipsjolly/ssR5f/](http://jsfiddle.net/ipsjolly/ssR5f/)

选项卡中有一个类似的选项`3rd`卡，我们可以通过它跳转到`1st`选项卡。

# css - jQuery Mobile 按钮半径 css

> ID：10677622
> 
> 赞同：0
> 
> 时间：2012-05-20T22:06:12.727
> 
> 标签：css, jquery-mobile

如何使按钮半径特定于主题...我正在使用 3 个主题，我需要以下全局按钮 css 代码仅适用于主题**B**

```
.ui-btn-corner-all {
    -moz-border-radius:                 .3em /*{global-radii-buttons}*/;
    -webkit-border-radius:              .3em /*{global-radii-buttons}*/;
    border-radius:                  .3em /*{global-radii-buttons}*/;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:18:54.760

请务必将以下内容放在 JQM 样式表之后。

```
[data-theme=b].ui-btn-corner-all {
    -moz-border-radius:             .3em;
    -webkit-border-radius:          .3em;
    border-radius:                  .3em;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-28T20:36:07.630

这项工作没有角落：

```
data-corners="false" 
```

# c# - 未正确访问全局数组

> ID：10677624
> 
> 赞同：0
> 
> 时间：2012-05-20T22:06:24.183
> 
> 标签：c#

以下是我当前的代码：

```
 namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        public int[] trialArray = new int[10];
        public int trialCounter = -1;

        private void button1_Click(object sender, EventArgs e)
        {
            bool button1Click = true;
            if (button1Click == true) 
            {
                ITIpanel.Visible = true;   

                for (int i = 0; i < trialArray.Length; i++) { trialArray[i] = -1; } // Set default value through array

                int counter = 0;

                Random rnd = new Random();

                while (counter < 10 / 2)
                {  // Red trials, fill half array

                    int index = rnd.Next(0, 10 - 1);

                    if (trialArray[index] == -1) { trialArray[index] = 1; ++counter; } //if unchanged value, change it

                }
                while (counter < 10)
                {
                    int index = rnd.Next(0, 10);

                    if (trialArray[index] == -1) { trialArray[index] = 2; ++counter; }
                }
            }
        }

        private void ITIpanel_Paint(object sender, PaintEventArgs e)
        {
            if (ITIpanel.Visible == true)
            {
                trialCounter += 1; 
                timer1.Enabled = true;
            }
        }

        private void timer1_Tick(object sender, EventArgs e)
        {

            ITIpanel.Visible = false;
            timer1.Enabled = false; 
            if (trialArray[trialCounter] == 1) { redstimPanel.Visible = true;  }

            else { bluestimPanel.Visible = true;}

            if (trialCounter == 9) { Application.Exit(); } 

        }
        public int counter = 0;
        public event EventHandler Clicked5TimesEvent;
        private void OnClicked5TimesEvent()
        { if (Clicked5TimesEvent != null) { Clicked5TimesEvent(this, EventArgs.Empty); } }

        private void bluestimPanel_MouseDown(object sender, EventArgs e)
        {
            //FR requirement
            counter++; if (counter % 5 == 0) { redstimPanel.Visible = false; ITIpanel.Visible = true; }
        }

        private void redstimPanel_MouseDown(object sender, EventArgs e)
        {
            //FR requirement
            counter++; if (counter % 5 == 0) { redstimPanel.Visible = false; ITIpanel.Visible = true; }
        }

    }
} 
```

如您所见，我正在尝试创建一个包含 10 个项目的全局数组。单击按钮上的 10 个项目应该被更改，其中一半包含值 1，另一半包含值 2。

然后，在计时器滴答声中，根据 中的值`trialCounter`确定要访问的数组部分，它应该显示`redstimPanel`或`bluestimPanel`。

因此，如果“trialCounter”等于 8，并且 TrialArray 中的 8 等于 1，则“redstimPanel”应该变为可见。或者，如果“TrialArray”中的 8 等于 2，则“bluestimPanel”应该变为可见。

然而，这并没有像我希望的那样工作。因此，我的代码显然存在一些问题。大家有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T22:19:09.580

您永远不会重置计数器，或者让第二个循环（设置 2s 的那个）成为完整的数组。

随机数也有错误，rnd.Next(a,b) a - 下限（包括），b - 上限（不包括）。所以应该是 rnd.Next(0,10); 所以你有机会填充最后一个数组位置。

```
while (counter < 10 / 2) { // Red trials, fill half array
    int index = rnd.Next(0, 10);

    if (trialArray[index] == -1) { trialArray[index] = 1; ++counter; } //if unchanged value, change it
}
//Counter on the first loop here is already 5 (it exited the previous loop)
//So allow it to get to 10, and populate the FULL array.
while (counter < 10) {
    int index = rnd.Next(0, 10);

    if (trialArray[index] == -1) { trialArray[index] = 2; ++counter; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:44:22.370

请允许我给你一些提示和一些关于你的代码的解释：

首先，您可能希望本地 button1Click 变量稍后知道按钮是否已被单击。为此，您应该将它放在该函数之外，否则它将永远不会被使用，并且每次单击按钮时都是如此，如下所示：

```
bool button1Click = false;
private void button1_Click(object sender, EventArgs e)
{                
    if (!button1Click)
    { 
```

1.  当您有条件时，您希望代码决定表达式是真还是假，您可以省略“== true”部分，因为它不会添加任何新内容。

2.  你有两个时间。您的想法是使用第一段代码运行计数器直到 5，然后从 5 到 10 运行第二段代码。现在让我试着解释一下到底发生了什么。计数器将持续到 5 个随机索引填充 1 秒。然后在 5 处，while 中的表达式将变为 false，并从循环中跳出。由于第二个 while 具有完全相同的表达式，因此它只是避免它并继续。许多解决方案之一是在这样的循环中有一个 if：

    while (counter < 10) { if (counter<5) { // 填充红色 } else { // 填充蓝色 } }

3.  填充数组中的值的方式。你有没有想过当同一个索引被生成多次时会发生什么？这意味着它将覆盖以前的值，而某些索引将保持 -1。

# c# - Ninject：将客户端的程序集作为构造函数参数传递，并使用属性从客户端指定所需的实现

> ID：10677636
> 
> 赞同：3
> 
> 时间：2012-05-20T22:08:13.040
> 
> 标签：c#, binding, dependency-injection, ninject, constructor-injection

一般来说，我是 Ninject 和 Dependency Injection 的新手，所以请原谅我的菜鸟。=)

我有几个`IConfig`接口实现，它们扫描一个程序集及其依赖项以查找实现`IConfigOption`接口的类型。每个`IConfig`实现都从不同的来源检索它们的值。

这些实现将根程序集作为构造函数参数从哪里开始扫描，我试图提出一个注入这些值的绑定。到目前为止，我正在考虑以下内容：

```
Bind<IConfig>().To<Config>().WithConstructorArgument("rootAssembly", target); 
```

我的问题是，我似乎无法找到一种方法来获取对注入类的`target`程序集的引用。`Config`如果没有 DI，我会使用`Assembly.GetCallingAssembly()`，但在这种情况下，这会产生绑定所在的程序集，而不是所需的目标程序集。

另外，我需要一种**从将接收注入的类/成员**中指定预期实现的方法，例如，客户端类 A 请求使用的`Config`实现者，`RoleEnvironment`客户端类 B 请求使用的`Config`实现者`ConfigurationManager`。这是一个说明预期用途的示例：

```
public class Client
{
    [UseApplicationConfig]
    public IHelper WithAppConfig { get; set; }

    [UseRoleEnvironmentConfig]
    public IHelper WithRoleEnvironmentConfig { get; set; }
}

public class Helper : IHelper
{
    public Helper(IConfig config)
    {
    }
} 
```

我觉得要么我从错误的角度看这个，要么我错过了明显的东西，但我不确定我应该寻找什么。最好的方法是如何做到这一点？

非常感谢。

编辑：添加了预期用途的示例，并为清楚起见重新表述了问题的某些部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T19:15:23.030

如果您想获取有关对对象发出的请求的详细信息，请使用重载`WithConstructorArgument(string, Func<IContext, object>)`。您可以使用提供`IContext`的来查找程序集名称（使用调试器环顾四周，听起来您的布局可能非常复杂，所以我无法提供具体代码）。

作为如何使用它的示例：

```
//get the full name of the requested object
Bind<IFoo>()
    .To<Foo>()
    .WithConstructorArgument("bar",
                             c => c.Request.FullName); 
```

但是，在我看来，您从错误的角度看它。如果我正确地阅读了你的问题，听起来你有一个类可以扫描你的程序集，然后决定注入什么，而不是让 Ninject 为你做。我认为这是您不使用 DI 时的遗留问题？

我会看一下使用`WhenInjectedInto`方法或自定义属性的上下文绑定来将`IHelper`您想要的特定内容注入构造函数。见这里：[https ://github.com/ninject/ninject/wiki/Contextual-Binding](https://github.com/ninject/ninject/wiki/Contextual-Binding)

链接页面实际上有一个可能对您有用的类似操作的示例：

```
Bind<IWarrior>()
    .To<Samurai>()
    .When(request => request.Target.Type.Namespace.StartsWith("Samurais.Climbing")); 
```

我可能仍会使用`WhenInjectedInto`or 属性，因此您没有任何“魔术字符串”，以防您稍后重构命名空间。

# google-chrome - 可能的 SVG 路径 Chrome 错误

> ID：10677638
> 
> 赞同：3
> 
> 时间：2012-05-20T22:08:27.453
> 
> 标签：google-chrome, svg, raphael

我在 Chrome 中遇到路径元素可能存在的错误。我已经复制/粘贴了 RaphaelJS 在这里呈现的内容：http: [//petesaia.com/work/svg-chrome-bug/](http://petesaia.com/work/svg-chrome-bug/)

## 在 Safari 和 Firefox 中

[![](../Images/13d6f7c2edb30f23a91bbe518a5e100d.png)](https://i.stack.imgur.com/gWOG1.png)
[（来源：[petesaia.com](http://petesaia.com/work/svg-chrome-bug/safari.png)）]

## 在 Chrome (19.0.1084.46) 中

[![](../Images/2137f1fa48a50ac2368906c66219903e.png)](https://i.stack.imgur.com/r95a7.png)
[（来源：[petesaia.com](http://petesaia.com/work/svg-chrome-bug/chrome.png)）]

显然，这个文件中有很多点，这就是我限制每个路径元素 50 个点的原因。如您所见，右侧缺少 2 条路径，左侧缺少 2 条非常小的路径。我找到了一条未显示的路径并将其单独列出。你可以在这里看到：http: [//petesaia.com/work/svg-chrome-bug/singled.html](http://petesaia.com/work/svg-chrome-bug/singled.html)

您会注意到，即使选择了路径，它仍然不会显示。所以 Chrome 一定不喜欢这条路径的东西。

我还注意到*有时*它会正确显示，通常是在我打开和关闭 javascript 控制台时。它非常脆弱。我已经尝试过改变中风和体重，但也没有运气。

有没有人经历过这样的事情？

**新发现：**这些 x/y 值是破坏 single.html 示例的坐标：620.3536711111101,232.16932207146056 我知道这一点，因为当您将路径截断到该点时，它可以完美运行。但是，我仍然不知道他们为什么会破坏它。

谢谢，
皮特

PS：我确实计划简化形状，但这首先引起了我的注意。

# maven - maven站点转义html标签

> ID：10677641
> 
> 赞同：0
> 
> 时间：2012-05-20T22:08:45.333
> 
> 标签：maven

我正在尝试使用 maven-site-plugin 创建一个站点。它使用 about 链接中的描述内容。如何在描述中放置换行符。现在它在一行中显示所有内容。我试过 <
\n 他们都没有工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T07:04:32.403

来自[Maven 站点](http://maven.apache.org/ref/2.2.1/maven-model/maven.html#class_project)的元素描述`<description>`。

> 项目的详细描述，Maven 在需要描述项目时使用，例如在网站上。虽然可以将此元素指定为 CDATA 以启用在描述中使用 HTML 标记，但不鼓励允许纯文本表示。如果您需要修改生成网站的索引页面，您可以指定您自己的而不是调整此文本。

# android - 为什么当我上拉/下拉刷新列表时某些图像在 ListView 中消失

> ID：10677646
> 
> 赞同：1
> 
> 时间：2012-05-20T22:09:49.783
> 
> 标签：android

当我上拉/下拉刷新列表时，我在 ListView 中出现图像消失的问题。当我刷新列表（即上传接下来的 10 个主线）时，只有某些用户/用户的一些图像会消失。我使用下拉刷新列表视图（来自 Chris Banes）和 ImageLoader（来自 nostra13）。我认为存在优先级问题并试图操纵线程优先级，但事实并非如此。如我所见，其他地方存在问题。谁能解释一下问题出在哪里以及如何解决？

ListView 适配器：

```
public class TweetListAdapter extends ArrayAdapter<Tweet> {
    private final Context context;
    private final List<Tweet> tweets;
    public ImageManager imageManager;
    private DisplayImageOptions options;

    public TweetListAdapter(Context context, int textViewResourceId, List<Tweet> tweets) {
        super(context, textViewResourceId, tweets);

        this.context = context;
        this.tweets = tweets;
        options = new DisplayImageOptions.Builder()
        .showStubImage(R.drawable.ic_launcher)
        .showImageForEmptyUrl(R.drawable.ic_launcher)
        .cacheOnDisc()
        .build();
//      imageManager = new ImageManager(context.getApplicationContext());
    }

    public static class ViewHolder {
        public TextView username;
        public TextView message;
        public ImageView image;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        ViewHolder holder;
        if (v == null) {
            // Set up Layout inflater to make custom view
            LayoutInflater vi = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.customtweetlist, null);

            holder = new ViewHolder();
            holder.username = (TextView) v.findViewById(R.id.tvUsername);
            holder.message = (TextView) v.findViewById(R.id.tvText);
            holder.image = (ImageView) v.findViewById(R.id.ivImage);
            v.setTag(holder);
        } else
            holder = (ViewHolder) v.getTag();

        // Get tweet position and attach each tweet to different custom view
        // blocks
        final Tweet tweet = tweets.get(position);
        if (tweet != null) {
            holder.username.setText(tweet.getToUser());
            holder.message.setText(tweet.getText());
            holder.image.setTag(tweet.getProfileImageUrl());

            File cacheDir = new File(Environment.getExternalStorageDirectory(), "UniversalImageLoader/Cache");
            // ImageMnagaer is created for images caching
            //imageManager.displayImage(tweet.getProfileImageUrl(), context, holder.image);
            // Get singletone instance of ImageLoader
            ImageLoader imageLoader = ImageLoader.getInstance();

            ImageLoaderConfiguration config = new ImageLoaderConfiguration.Builder(context)
            .threadPriority(Thread.MIN_PRIORITY + 2)
            .discCache(new UnlimitedDiscCache(cacheDir)) // You can pass your own disc cache implementation
            .defaultDisplayImageOptions(DisplayImageOptions.createSimple())
            .build();
            // Initialize ImageLoader with configuration. Do it once.
            imageLoader.init(config);
            // Load and display image asynchronously
            imageLoader.displayImage(tweet.getProfileImageUrl(), holder.image, options);
        }
        return v;
    }
} 
```

# java - 在什么情况下方向键不会遍历组合框？

> ID：10677654
> 
> 赞同：1
> 
> 时间：2012-05-20T22:11:01.987
> 
> 标签：java, swing, jcombobox

我有一个简单的`JComboBox`

```
JComboBox comboBox = new JComboBox();
comboBox.setModel(new DefaultComboBoxModel(new String[] {"foo", "bar"})); 
```

在某些情况下，箭头键适用于弹出窗口中的列表遍历。但在某些情况下，箭头键不起作用（在这些情况下不会引发异常）。

我已经缩小了箭头键不起作用的情况。

我想知道是什么导致箭头键不起作用，这样我就可以限制我的焦点区域。很抱歉，我无法为这个问题提供 SSCCE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:47:00.960

我已经在我的自定义自动完成组合框中删除了箭头键的 ActionMap 扩展`JComboBox`

```
getActionMap().getParent().remove("selectNext"); 
```

当用户输入一些不在列表中的值并继续前进时，我没有重置操作键。这导致应用程序中的所有 JComboboxes 停止响应箭头键。

我最初保存了操作`selectNext`并在上述错误发生时重置操作以使代码正常工作

```
Action selectNextAction = getActionMap().getParent().get("selectNext");
//...
getActionMap().getParent().put("selectNext", selectNextAction); 
```

# ios - iCloud 因核心数据失败 - 部分更新 - 未记录的错误消息

> ID：10677661
> 
> 赞同：3
> 
> 时间：2012-05-20T22:11:59.717
> 
> 标签：ios, core-data, sync, icloud

我正在尝试通过 iCloud 在两台设备之间同步核心数据应用程序的数据。它基本上似乎工作，但它大多失败。数据不显示，或随机/部分显示。同步需要很长时间（有时：数小时）。

当然，我尝试了所有明显的补救措施，例如从设备中删除应用程序和数据等。

我收到以下消息（相关摘录）：

```
[_PFUbiquityRecordsImporter operation:failedWithError:](839): 
CoreData: Ubiquity:  Import operation encountered an error: 
Error Domain=NSCocoaErrorDomain 
Code=134060 "The operation couldn‚Äôt be completed. 
(Cocoa error 134060.)" UserInfo=0x1106a6a0 
{exception=Attempted to perform an operation without an open database} 
while trying to import the log file at the URL: 
<PFUbiquityTransactionLog: 0x11062710> 
```

紧接着

```
CoreData: Ubiquity: Error importing transaction log: 
<PFUbiquityTransactionLog: 0x110eb820> 
```

然后

```
-[_PFUbiquityRecordsImporter operation:failedWithError:](824): 
CoreData: Ubiquity:  Import operation encountered a corrupt log file, 
Error Domain=NSCocoaErrorDomain Code=134302 
"The operation couldn‚Äôt be completed. (Cocoa error 134302.)" 
UserInfo=0x12e0b0 {underlyingError=Error Domain=NSCocoaErrorDomain Code=19 
"The operation couldn‚Äôt be completed. (Cocoa error 19.)" UserInfo=0x1af070
{NSUnderlyingException=error during SQL execution : constraint failed,
NSFilePath=/var/mobile/Applications/
59087988-334C-40DC-9F6A-C7DA22F7B790/Documents/database.sqlite, 
NSSQLiteErrorDomain=19}, reason=Error encountered while importing 
transaction log at URL: <PFUbiquityTransactionLog: 0xe87b3f0> 
```

关于这个“没有打开的数据库”错误的任何线索？
“损坏的日志文件”怎么办？

# visual-studio-2010 - 在 VirtualPC 或 VirtualBox 等虚拟机中从 Visual Studio 运行和调试程序

> ID：10677665
> 
> 赞同：3
> 
> 时间：2012-05-20T22:12:29.387
> 
> 标签：visual-studio-2010, visual-studio, virtual-pc

我有要在干净的 Windows 安装上测试的程序。现在我在 VirtualBox 中有图像，我从共享文件夹启动程序，但这不舒服，我无法调试。

对于调试，我发现我可以使用[Remote Debugging Monitor](http://msdn.microsoft.com/en-us/library/xf8k2h6a.aspx)，但我仍然想自动化整个过程，尤其是在虚拟机上上传应用程序。

我认为 VirtualPC 会比 VirtualBox 更好，因为这个应用程序是由 Microsoft 创建的。不幸的是，我找不到如何连接它们的任何信息。

**编辑：** 经过研究：唯一的可能是将虚拟机视为远程计算机。没有更简单的方法。项目需要使用共享文件夹发布到 VM。在 Visual Studion 中配置新版本类型以进行远程调试后，所有触发器都会自动运行并正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:22:00.600

我会：

1.将程序放置在预定义的共享目录中，以便在重新部署后立即对虚拟机可见。

2.远程调试器调用可以自动化——所有参数，例如允许调试的用户，都可以在命令行上传递。

VirtualBox 非常适合这项任务，因为它允许您只用干净的磁盘映像替换磁盘映像，同时保持设置（包括共享目录）不变。我确信 VirtualPC 也允许这样的事情，但是仅仅因为它也是由 Microsoft 编写的而选择它似乎在这里并不是一个有效的考虑因素。

# xml - 如何为一个节点使用两个不同的分析字符串

> ID：10677667
> 
> 赞同：3
> 
> 时间：2012-05-20T22:12:48.903
> 
> 标签：xml, regex, xslt

在我的 XSLT 转换中，我需要使用两个分析字符串来处理一个节点。它们一个接一个地工作得很好，但我不知道如何将它们组合在一起。

XML 文档如下所示：

```
<article>
    <title>Article 1</title>
    <text><![CDATA[Lorem ipsum dolor sit amet, s consectetur adipiscing elit. Donec lorem diam, eleifend sed mollis id, condimentum in velit.

Sed sit amet erat ac mauris adipiscing elementum. Pellentesque eget quam augue, id faucibus magna.

Ut malesuada arcu eu elit sodales sodales. Morbi tristique porttitor tristique. Praesent eget vulputate dui. Cras ut tortor massa, at faucibus ligula.]]></text>
</article> 
```

这是我的 XSLT：

```
<xsl:template match="/">
    <html>
        <head>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
            <title>Page title</title>
        </head>
        <body>
            <xsl:for-each select="article">
                <h1><xsl:value-of select="./title"/></h1>

                <!-- This adds paragraphs tags instead of empty lines in the text -->
                <xsl:analyze-string select="./text" regex="&#xa;">
                    <xsl:non-matching-substring>
                        <p>
                            <xsl:value-of select="." disable-output-escaping="yes"/>
                        </p>
                    </xsl:non-matching-substring>
                </xsl:analyze-string> 

                <!-- This is Czech language specific. It looks for ' s ' (or other letter) and changes second space for &nbsp;. So after that it is ' s&nbsp;'. -->
                <xsl:analyze-string select="./text" regex="(\s[k/K/s/S/v/V/z/Z]\s)">
                    <xsl:matching-substring>
                        <xsl:text> </xsl:text>
                        <xsl:value-of select="replace(., ' ','')" disable-output-escaping="yes"/>
                        <xsl:text disable-output-escaping="yes"><![CDATA[&nbsp;]]></xsl:text>
                    </xsl:matching-substring>
                    <xsl:non-matching-substring>
                        <xsl:value-of select="." disable-output-escaping="yes"/>
                    </xsl:non-matching-substring>
                </xsl:analyze-string>
            </xsl:for-each>
        </body>
    </html>
</xsl:template> 
```

我需要在生成的文本上应用两个分析字符串，以便有`<p>`段落标签并添加`&nbsp;`到正确的位置。

我想要的输出如下所示：

```
<h1>Article 1</h1>    
<p>Lorem ipsum dolor sit amet, s&nbsp;consectetur adipiscing elit. Donec lorem diam, eleifend sed mollis id, condimentum in velit.</p>
<p>Sed sit amet erat ac mauris adipiscing elementum. Pellentesque eget quam augue, id faucibus magna.</p>
<p>Ut malesuada arcu eu elit sodales sodales. Morbi tristique porttitor tristique. Praesent eget vulputate dui. Cras ut tortor massa, at faucibus ligula.</p> 
```

知道怎么做吗？感谢您抽出宝贵的时间来帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:42:26.247

**这种转变**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes" encoding="ascii"/>

 <xsl:template match="/*/text">
  <xsl:analyze-string select=
   "replace(., '\ss\s', ' s&#xA0;')"
   regex="&#xA;">
    <xsl:non-matching-substring>
     <p><xsl:sequence select="."/></p>
    </xsl:non-matching-substring>
  </xsl:analyze-string>
 </xsl:template>

 <xsl:template match="title">
  <h1><xsl:value-of select="."/></h1>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<article>
  <title>Article 1</title>
<text><![CDATA[Lorem ipsum dolor sit amet, s consectetur adipiscing elit. Donec lorem diam, eleifend sed mollis id, condimentum in velit.
Sed sit amet erat ac mauris adipiscing elementum. Pellentesque eget quam augue, id faucibus magna.
Ut malesuada arcu eu elit sodales sodales. Morbi tristique porttitor tristique. Praesent eget vulputate dui. Cras ut tortor massa, at faucibus ligula.]]></text>
</article> 
```

**产生想要的正确结果：**

```
 <h1>Article 1</h1>
<p>Lorem ipsum dolor sit amet, s&#160;consectetur adipiscing elit. Donec lorem diam, eleifend sed mollis id, condimentum in velit.</p>
<p>Sed sit amet erat ac mauris adipiscing elementum. Pellentesque eget quam augue, id faucibus magna.</p>
<p>Ut malesuada arcu eu elit sodales sodales. Morbi tristique porttitor tristique. Praesent eget vulputate dui. Cras ut tortor massa, at faucibus ligula.</p> 
```

**注意**：不鼓励程序员使用 DOE，因为它不是 XSLT 2.0 的强制特性，并且不能保证任何 XSLT 2.0 处理器都可能支持 DOE。要使用的功能是**[字符映射](http://www.w3.org/TR/2007/REC-xslt20-20070123/#character-maps)**。

**那么整个变换就变成了**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"
  encoding="ascii" use-character-maps="nbsp"/>

 <xsl:character-map name="nbsp">
  <xsl:output-character
  character="&#xA0;" string="&amp;nbsp;"/>
 </xsl:character-map>

 <xsl:template match="/*/text">
  <xsl:analyze-string select=
   "replace(., '\ss\s', ' s&#xA0;')"
   regex="&#xA;">
    <xsl:non-matching-substring>
     <p><xsl:sequence select="."/></p>
    </xsl:non-matching-substring>
  </xsl:analyze-string>
 </xsl:template>

 <xsl:template match="title">
  <h1><xsl:value-of select="."/></h1>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于同一个 XML 文档（上图）时，它会产生想要的正确结果：**

```
 <h1>Article 1</h1>
<p>Lorem ipsum dolor sit amet, s&nbsp;consectetur adipiscing elit. Donec lorem diam, eleifend sed mollis id, condimentum in velit.</p>
<p>Sed sit amet erat ac mauris adipiscing elementum. Pellentesque eget quam augue, id faucibus magna.</p>
<p>Ut malesuada arcu eu elit sodales sodales. Morbi tristique porttitor tristique. Praesent eget vulputate dui. Cras ut tortor massa, at faucibus ligula.</p> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T06:45:13.603

这是我对 Dimitre 解决方案的调整：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="html" indent="yes" encoding="UTF-8"/>

 <xsl:template match="/*/text">
   <xsl:for-each select="tokenize( replace(., '\s([kKsSvVzZ])\s', ' $1&#xA0;'), '\n')">
     <p><xsl:value-of select="."/></p>
  </xsl:for-each>
 </xsl:template>

 <xsl:template match="title">
  <h1><xsl:value-of select="."/></h1>
 </xsl:template>
</xsl:stylesheet> 
```

**笔记**

1.  我不确定“字母 s/S/v/V/k/K/z/Z”是什么意思。这不是有效的正则表达式。你需要澄清。我猜你的意思是字符类 [sSvVkKzZ]
2.  虽然不清楚，但对捷克语的引用表明 UTF-8 可能是输出编码而不是 ASCII 的更好选择。
3.  虽然不清楚，但预期的输出标签建议更合适的序列化是 html。
4.  作为选择 html 序列化的附带好处，我们不再需要字符映射，从而使我们的解决方案更简单。我们可以利用内置的字符映射来进行 html 序列化。
5.  使用 fn:tokenise() 消除了对 xsl:analyze-string/xsl:non-matching-substring 节点的需要，可以说会导致更严格的解决方案。
6.  该解决方案已用 Saxon 进行了测试。
7.  变化是可能的。例如，您可以将 replace() 调用移到 xsl:value-of 内部，您可能认为它更具可读性。
8.  我的解决方案的缺点是它不适用于 disable-output-escaping="yes" 。但是我建议，如果你认为你需要这个，请再仔细看看为什么。任何 HTML 都需要 HTML 安全编码，除非它位于 CDATA 部分中。在启用禁用输出转义的情况下生成 HTML 的想法有些不对劲。也许我还没有完全理解这个问题。你能给出一个用例来澄清这一点吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T08:07:25.893

你没有说得很清楚，但我对这个问题的解释是你想使用第二个 xsl:analyze-string 来处理第一个的输出。您可以通过将第一个结果放入变量中来做到这一点，但我的建议是将每个 xsl:analyze-string 调用放入函数的主体中，并使用函数组合来组合它们。

```
<xsl:function name="f:one" as="xs:string">
  <xsl:param name="in" as="xs:string">
  <xsl:analyze-string select="in".../>
</xsl:function>

<xsl:function name="f:two" as="xs:string">
  <xsl:param name="in" as="xs:string">
  <xsl:analyze-string select="in".../>
</xsl:function>

... select="f:two(f:one(.))"... 
```

但是，在您的情况下，它更简单，因为第一个 xsl:analyze-string 可以使用对 replace() 的简单调用来完成。

# c# - 我什么时候应该防范null？

> ID：10677669
> 
> 赞同：10
> 
> 时间：2012-05-20T22:12:55.303
> 
> 标签：c#

我什么时候应该提防`null`争论？理想情况下，我会在任何地方都提防`null`，但这会变得非常臃肿和乏味。我还注意到人们并没有在`AsyncCallback`s 之类的东西中设置警卫。

为了避免用大量单一的代码惹恼其他人，是否有任何公认的标准来说明我应该在哪里防范`null`？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T22:28:19.417

我经常使用的一种方法是[空对象模式。](http://en.wikipedia.org/wiki/Null_Object_pattern) 例如，如果一个工厂类根据参数返回接口的不同实现，并且提供的参数未映射到任何实现，我将返回 NullObject，例如

```
 public interface IFoo{
         void Bar();
   }
   public class NullFoo{
       public void Bar(){
          //null behaviour 
       }
   }
   public class FooFactory{
        public IFoo CreateFoo(int i){
              switch(i){
                  case 1:
                  return new OneFoo();
                  break;
                  case 2:
                  return new TwoFoo();
                  break;
                  default:
                  return new NullFoo();
                  break;
              }
        } 
   } 
```

当我想得到一个`IFoo`from`CreateFoo`时，我不必检查返回的对象是否为空。

显然，这只是众多方法中的一种。没有“一刀切”，因为 null 可能意味着不同的东西。

防止空参数的另一种方法是使用[CodeContract 前置条件](http://msdn.microsoft.com/en-us/magazine/ee236408.aspx#id0070015)。例如

```
 public void Foo(Bar x){
      Contract.Requires<ArgumentNullException>( x != null, "x" );
      //access x
  } 
```

使用代码契约允许您对代码运行静态代码分析并捕获诸如`Foo(null)`. （[更多在这里](http://msdn.microsoft.com/en-us/magazine/hh335064.aspx)）

这样做的另一个原因是使用一种非常简单的通用扩展方法：

```
public static class Ex
{
    public static void EnsureNotNull<T>(this T t, string argName) where T:class
    {
        if(t == null)
        {
            throw new ArgumentNullException(argName);
        }
    }
} 
```

然后你可以像这样检查你的论点：

```
 public void Foo(Bar x, Bar y){
     x.EnsureNotNull("x");
     y.EnsureNotNull("y");
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-20T23:02:25.727

> 我什么时候应该防范空参数？

我假设您正在谈论传递给您编写的代码的公共方法或构造函数的空参数。请注意，当您调用任何可能返回 null 的外部依赖项时，您可能还必须“防范” null，除非您的代码可以优雅地处理这些情况。

您应该在向用户公开的任何**公共**方法（包括构造函数和属性设置器）中防止 null 值没有有用和明确的含义。如果空值对您的代码没有特殊意义（例如数组结尾、“未知”等），那么您不应接受该值，而应抛出一个`ArgumentNullException`。

这条规则也不是唯一的`null`。您应该始终检查传递给您的公共方法的参数。

例如，假设您正在编写某种 Web 服务方法，该方法确实采用用户 ID，并对用户执行某些操作（例如删除它们）。在您的方法对该用户执行任何其他操作之前，您应该验证它是一个有效的用户 ID。另一个示例是，如果您正在编写一个公共方法，该方法采用集合或数组的索引。您应该预先检查索引是否在允许的范围内 - 索引不大于集合或小于零。

> 我还注意到人们并没有在 AsyncCallbacks 之类的东西中设置警卫。

如果您知道传递给您的方法的参数会警惕地保留您的方法前置条件（因为如果不是，您会抛出异常），那么您可以在私有和内部方法或私有和内部方法中自由跳过这些检查类。

但正如您所指出的，您仍然必须小心不要相信来自您未编写的 API 的任何返回值，或传递给您的回调方法的任何值。将它们视为“脏”，并假设它们可以是空值或无效值。

> 这变得非常臃肿和乏味

为您的公共方法指定和跟踪前置条件并不臃肿——它是编译文档。这是您确保代码*正确的*方式。这是预先告知您的代码的用户他们做错了什么的方式。让它在你的方法中间失败（或者可能在一些模糊相关的类中的另一个方法中）使得调试你的问题变得更加困难。

现在这似乎没什么大不了的。但是，一旦您开始收到客户的投诉，`NullReferenceException`堆栈中的级别降低了 5 个，之后调用了 20 个方法，那么我认为您将开始看到好处:)

> 为了避免用大量单一的代码惹恼其他人，是否有任何公认的标准来说明我应该在哪里防范 null？

通常人们只是`if ... throw`在他们的方法的顶部编写代码。这是最惯用的语法，即使是初学者也很容易理解。[有点像Lisp](http://en.wikipedia.org/wiki/Lisp_(programming_language))中的括号，一旦你使用了那个模式，你就可以非常快速地浏览它，而不用考虑它。

您可以使用 Visual Studio [Code Snippets](http://msdn.microsoft.com/en-us/library/ms165392(v=vs.80).aspx)加快编写这些检查的速度。

您可以通过使用或构建一些支持断言语法的共享代码来稍微缩短此代码。代替`if ... throw`语法，你会写一行像`Assert.NotNull(arg1, "arg1");`. 如果您想要一些灵感，您可以查看[NUnit](http://www.nunit.org/)框架的[断言](http://www.nunit.org/index.php?p=assertions&r=2.6)和[约束](http://www.nunit.org/index.php?p=constraintModel&r=2.6)。

您可能还想查看[Code Contracts API](http://research.microsoft.com/en-us/projects/contracts/)。它设计用于检查前置条件、后置条件和不变量（它们是这些“保护条件”的正式名称）。它还可以将某些验证从运行时转移到编译时，因此您甚至可以在运行程序之前发现自己犯了错误。我还没有真正看过它，但它也可能会给你更简洁的语法。 *编辑：另请参阅[Pencho Ilchev 的回答](https://stackoverflow.com/a/10677760/232593)，了解使用部分 API 的简短示例*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T22:17:57.643

公共 API 的空值检查是必须的。如果开发人员立即知道由于 null 参数而出现错误，而不是尝试调试由于该 null 参数而导致的一些晦涩的其他异常，那么对于开发人员来说会更容易（也更安全）。

在内部，构造函数是检查空值的好地方，原因相同 - 在构造函数中捕获它比在类上调用方法时更容易。

有人认为到处检查是件好事，但我倾向于认为在实际阅读代码时，它会筛选更多代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-20T22:19:09.363

有时我会创建一个`Preconditions`包含静态方法的类，用于检查一些常用方法的先决条件，即`null`参数——例如：

```
public static <T> T checkNull(T arg) {
    if (arg == null)
        throw new IllegalArgumentException();
    return arg;
} 
```

这使您的代码更简洁。

至于您应该*在哪里*检查`null`，应该在它不是有效值的地方进行检查。

**编辑**

注意到这个问题被标记为 C#，但你明白了......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-20T22:19:30.417

如果您在谈论方法参数，您可以选择。您可以检查参数并 throw `ArgumentNullException`，或者您可以忽略检查并让其他东西`NullReferenceException`进一步抛出。在不检查参数的情况下运行的风险是，您的代码可能会在`NullReferenceException`抛出之前更改某些全局状态，从而使程序处于未知状态。

一般来说，最好检查你的方法抛出的参数和文档`ArgumentNullException`。是的，这需要更多的工作，并且在方法开始时通过这些检查可能会很烦人。你必须问问自己，你得到的更健壮的代码是否是一个很好的权衡。

有关此问题的详细讨论，请参阅[此链接](http://blogs.msdn.com/b/brada/archive/2004/07/11/180315.aspx)。

# iphone - UIToolBar 动画与视图转换不正确

> ID：10677673
> 
> 赞同：2
> 
> 时间：2012-05-20T22:13:41.867
> 
> 标签：iphone, ios, uitableview, animation, uitoolbar

我有一个`uitableview`内部，`uiview`它在导航视图中呈现（所以它有一个导航菜单）。在导航菜单下，我有一个 uitoolbar 在视图加载时出现，在从导航堆栈中弹出加载时消失。

我遇到的问题是，当我使用从右到左的正常动画转换将此视图动画到堆栈上时，tableview 不会这样做，它只是在视图完成滑入视图之前快速出现。然后，当您选择后退按钮并且视图开始从左到右进行动画处理时，它会在动画结束之前再次消失。

我想知道如何让这个工具栏与视图的其余部分一起动画，从右到左，从左到右等，而不是异常地出现在滑动效果上。

这就是我目前调用和关闭工具栏的方式。

```
- (void) viewWillAppear:(BOOL)animated 
{
    [self.navigationController setToolbarHidden:NO animated:NO];
    [self.navigationController.toolbar setFrame:CGRectMake(0, 60, 320, 30)];
    self.navigationController.toolbar.tintColor = [UIColor darkGrayColor];

    [SeriesTableView setFrame:CGRectMake(0, 30, self.view.frame.size.width, self.view.frame.size.height)];

    [super viewWillAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [self.navigationController setToolbarHidden:YES animated:NO];

    [super viewWillDisappear:animated];
} 
```

这几乎是标准的做事方式。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:46:59.517

导航控制器的工具栏属性已经在屏幕上，但从视图中隐藏。如果您希望工具栏使用特定视图打开和关闭动画，请将工具栏添加到该视图。然后工具栏将作为视图的一部分打开和关闭动画。

# android - Android/Java：从另一个类更改视图？

> ID：10677675
> 
> 赞同：0
> 
> 时间：2012-05-20T22:14:09.560
> 
> 标签：android, class, view

有两个班。MainActivity，我在其中设置视图，以及我想从中更新 MainActivity 中的视图的 ClassX。ClassX 是从 MainActivity 调用的 AsyncTask，如果相关的话。

我想要做的是更改名为 mainTextLog 的视图的文本。我已经声明了一个全局 TextView 变量，并在 onCreate() 方法中使用 findViewById() 将其设置为视图。

```
private TextView logger;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    logger = (TextView) findViewById(R.id.mainTextLog);

} 
```

到目前为止，我应该能够从 onCreate() 更改文本，而且我可以。但是因为我想从另一个类（ClassX）中改变它，所以我需要为它创建一个方法：

```
public void setLogText(String text) {
    logger.setText(text);
} 
```

但它不起作用。我尝试将记录器和 setLogText() 方法设为静态，但它仍然不起作用。该应用程序只是崩溃。

这可能很容易，但我没有想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:24:30.293

如果您使用的是 AsyncTask，则需要在[onProgressUpdate](http://developer.android.com/reference/android/os/AsyncTask.html#onProgressUpdate%28Progress...%29)或[onPostExecute](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)中设置值。

你真的应该阅读[AsyncTasks的文档](http://developer.android.com/reference/android/os/AsyncTask.html)

您**不能**从 doInBackground 方法更新 UI，因为它不在 UI 线程中运行并且会给您一个异常。

此外，您应该发布应用程序崩溃时遇到的异常，以便我们更好地了解问题所在。但我猜你正试图从错误的线程中更新文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:24:53.157

我在我正在开发的应用程序中做了很多工作，它是安卓平板电脑上的一种 MDI 类型的应用程序。

做你所要求的......

在 MainActivity 中有

```
public static void setText(String txt){
  ((TextView)findViewById(R.id.mainTextLog)).setText(txt);
} 
```

然后在孩子（或调用类）中调用它就像......

```
MainActivity.setText("myTextToShow"); 
```

就是这样...我使用的是android api level 12 ...如果我没记错的话，它也可以在api level 7中使用。

希望这可以帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T22:24:42.920

一种可能性是：当您调用`setLogText`另一个 X 类时。 MainActivity 可能不再存在，这会导致`logger`null 引用？

# c# - 一个命名空间在另一个命名空间中找不到类

> ID：10677687
> 
> 赞同：1
> 
> 时间：2012-05-20T22:16:53.083
> 
> 标签：c#, .net-4.0, reference, namespaces, partial-classes

我是 c# .Net 的新手。在我的解决方案中，两个命名空间不能互相看到。

我有项目 A，其中有部分类 c1 和一些方法。具有不同命名空间的项目 B 也有一个部分类 c1，项目 A 中的一些同名方法和其他一些方法。

我在项目 A 中添加了对项目 B 的引用，在项目 A 类中包含使用命名空间 B。

但是仍然在A中，我无法使用B中c1类中的内容，我只能从A本身中看到c1类的方法。我想在 A 的两个项目中使用 c1 的方法。

有人可以帮我吗？我正在使用 .Net 框架 4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T02:38:45.100

B 可能是另一个命名空间中的完整类，但仅定义为特定文件中的部分类。正如@tzerb 所提到的，您不能在两个不同的命名空间中有两个相同的部分类 - 由于命名空间不同，类名本身（完全限定）是不同的。

如果您只需要在 A 类中使用 B 类的方法（并可能覆盖它们），您可以使用继承：

```
class A: B
{
    // override methods from B
    // or call base.<method> when needed
} 
```

或遏制：

```
class A
{
    private B _b;

    // construct and use _b methods directly
} 
```

`A` *如果是 a* 则使用继承`B`，否则使用包含。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:19:59.670

部分类必须共享一个命名空间。称为 c1 的两个部分类是完全不同的类。

# cakephp - 模型消息的 Cakephp 2.0 本地化

> ID：10677690
> 
> 赞同：4
> 
> 时间：2012-05-20T22:16:57.890
> 
> 标签：cakephp, localization, model, internationalization

我正在尝试让 i18n 从 Cakephp 2.0 中的模型中提取字符串

文档指出“CakePHP 将自动假定您的 $validate 数组中的所有模型验证错误消息都旨在本地化。运行 i18n shell 时，这些字符串也将被提取。” [http://book.cakephp.org/2.0/en/core-libraries/internationalization-and-localization.html](http://book.cakephp.org/2.0/en/core-libraries/internationalization-and-localization.html) 但是当我运行 cake i18n 并提取数据时，我的模型中的消息没有被提取到我的 po 文件中。

有谁知道如何将消息字符串放入 po 文件中？

```
App::uses('AuthComponent', 'Controller/Component');
class User extends AppModel {
 public $validate = array(
        'username' => array(
            'required' => array(
                'rule' => array('notEmpty'),
                'message' => 'A Username is required',
                 'rule' => 'isUnique',
                'message' => 'This username has already been taken'
            )
);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-21T08:12:39.887

这就是您可以解决我遇到的问题的方法。

```
App::uses('AuthComponent', 'Controller/Component');
        class User extends AppModel {
         function __construct() {
                parent::__construct();
                $this->validate = array(
                'username' => array(
                    'required' => array(
                        'rule' => array('notEmpty'))
                        'message' => __('A Username is required', true)), 
                      'unique' => array(
                        'rule' => 'isUnique',
                        'message' => _('This username has already been taken', true)
                    )
        );}
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-28T04:30:20.303

实现这一目标的正确方法是：

```
class AppModel extends Model {

    public $validationDomain  = 'validation_errors';
.
.
.
} 
```

内部 cake 将调用：

```
__d('validation_errors', 'Username should be more fun bla bla'); 
```

[http://book.cakephp.org/2.0/en/console-and-shells/i18n-shell.html#model-validation-messages](http://book.cakephp.org/2.0/en/console-and-shells/i18n-shell.html#model-validation-messages)

[http://book.cakephp.org/2.0/en/core-libraries/internationalization-and-localization.html#translating-model-validation-errors](http://book.cakephp.org/2.0/en/core-libraries/internationalization-and-localization.html#translating-model-validation-errors)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-21T08:33:48.827

您的 $validate 结构有点混乱，您在所需键下有两个相同的数组键（规则、消息）。它应该是：

```
public $validate = array(
    'username' => array(
        'required' => array(
            'rule' => array('notEmpty'),
            'message' => __('A Username is required', true),
        ),
        'unique'=>array(
            'rule' => 'isUnique',
            'message' => __('This username has already been taken', true)
        )
    )
); 
```

# visual-studio-2010 - 如果未选择任何内容，则 Visual Studio 环绕当前行

> ID：10677694
> 
> 赞同：2
> 
> 时间：2012-05-20T22:17:29.843
> 
> 标签：visual-studio-2010, resharper

我`Surround With`在 Visual Studio 中使用该功能和一些自定义代码片段。如果当前没有选择，是否可以配置 Visual Studio（或自定义环绕片段）以将整行视为已选择？

当您使用`Ctrl`+ `C`、`Ctrl`+`V`等键盘快捷键时，会提供相同的功能。如果您没有选择文本，它会在整行上执行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:59:12.350

如果有人仍然想用 Visual Studio 的本机函数来回答这个问题，他们可以 - 但是在评论中向我指出 resharper 会自动执行此操作。这是我没有意识到的。似乎我将把我所有的 VisualStudio 环绕声片段转移到 Resharper 环绕声模板！

# c - 如何将数字打印到 char 数组中？

> ID：10677695
> 
> 赞同：1
> 
> 时间：2012-05-20T22:17:54.893
> 
> 标签：c

我正在用 allegro（在 Ubuntu 中）开发一个 pacman 游戏，但我无法显示分数。我找到了这段代码，但它不起作用。请问你能帮帮我吗？

```
char scoretxt[10];
printf(scoretxt,"score: %d",score);
textout_ex(buffer, font, scoretxt, TILE_SIZE*(MAP_WIDTH)*3/4, TILE_SIZE, makecol(255,255,255), makecol(0,0,0)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T22:22:23.133

您应该使用`snprintf`，而不是`printf`：

```
snprintf(scoretxt, 10, "score: %d", score); 
```

这里`10`是缓冲区的长度，`scoretxt`以确保`snprintf`不会写入分配的数组之外。

# android - 构建动态壁纸

> ID：10677698
> 
> 赞同：1
> 
> 时间：2012-05-20T22:18:09.360
> 
> 标签：android, animation, android-canvas, live-wallpaper

我被困住了。我正在尝试使用框架构建动态壁纸。我正在使用的代码不起作用。动态壁纸不会通过帧拍摄。它只显示最后一帧。我应该对这段代码做些什么来让它在它的框架中移动？数组方法，如果是这样，我将如何在此代码中设置图像数组？

```
import android.graphics.Bitmap;

import android.graphics.BitmapFactory;

import android.graphics.Canvas;

import android.service.wallpaper.WallpaperService;

import android.view.SurfaceHolder;

public class WallpaperSer extends WallpaperService {

    public void onCreate() 

    {
        super.onCreate();
    }

    public void onDestroy() 
    {
        super.onDestroy();
    }

    public Engine onCreateEngine() 
    {
        return new WallpaperSerEngine();
    }

    class WallpaperSerEngine extends Engine 
    {
        public Bitmap image1, image2, image3, image4, image5, image6, image7, image8, image9,image10,
        image11, image12, image13, image14, image15, image16, image17, image18, image19,image20;

        WallpaperSerEngine() 
        {       
                image1 = BitmapFactory.decodeResource(getResources(), R.drawable.and1);
                image2 = BitmapFactory.decodeResource(getResources(), R.drawable.and2);
                image3 = BitmapFactory.decodeResource(getResources(), R.drawable.and3); 
                image4 = BitmapFactory.decodeResource(getResources(), R.drawable.and4);
                image5 = BitmapFactory.decodeResource(getResources(), R.drawable.and5);
                image6 = BitmapFactory.decodeResource(getResources(), R.drawable.and6);
                image7 = BitmapFactory.decodeResource(getResources(), R.drawable.and7);
                image8 = BitmapFactory.decodeResource(getResources(), R.drawable.and8);
                image9 = BitmapFactory.decodeResource(getResources(), R.drawable.and9);
                image10 = BitmapFactory.decodeResource(getResources(), R.drawable.and10);
                image11 = BitmapFactory.decodeResource(getResources(), R.drawable.and11);
                image12 = BitmapFactory.decodeResource(getResources(), R.drawable.and12);
                image13 = BitmapFactory.decodeResource(getResources(), R.drawable.and13); 
                image14 = BitmapFactory.decodeResource(getResources(), R.drawable.and14);
                image15 = BitmapFactory.decodeResource(getResources(), R.drawable.and15);
                image16 = BitmapFactory.decodeResource(getResources(), R.drawable.and16);
                image17 = BitmapFactory.decodeResource(getResources(), R.drawable.and17);
                image18 = BitmapFactory.decodeResource(getResources(), R.drawable.and18);
                image19 = BitmapFactory.decodeResource(getResources(), R.drawable.and19);
                image20 = BitmapFactory.decodeResource(getResources(), R.drawable.and20);
        }

        public void onCreate(SurfaceHolder surfaceHolder) 
        {
            super.onCreate(surfaceHolder);
        }

        public void onOffsetsChanged(float xOffset, float yOffset, float xStep, float yStep, int xPixels, int yPixels) 
        {
            drawFrame();

        }

        void drawFrame() 
        {
            final SurfaceHolder holder = getSurfaceHolder();

            Canvas c = null;
            try 
            {
                c = holder.lockCanvas();
                if (c != null) 
                {              
                     c.drawBitmap(image1, 0, 0, null);
                     c.drawBitmap(image2, 0, 0, null);
                     c.drawBitmap(image3, 0, 0, null);
                     c.drawBitmap(image4, 0, 0, null);
                     c.drawBitmap(image5, 0, 0, null);
                     c.drawBitmap(image6, 0, 0, null);
                     c.drawBitmap(image7, 0, 0, null);
                     c.drawBitmap(image8, 0, 0, null);
                     c.drawBitmap(image9, 0, 0, null);
                     c.drawBitmap(image10, 0, 0, null);
                     c.drawBitmap(image11, 0, 0, null);
                     c.drawBitmap(image12, 0, 0, null);
                     c.drawBitmap(image13, 0, 0, null);
                     c.drawBitmap(image14, 0, 0, null);
                     c.drawBitmap(image15, 0, 0, null);
                     c.drawBitmap(image16, 0, 0, null);
                     c.drawBitmap(image17, 0, 0, null);
                     c.drawBitmap(image18, 0, 0, null);
                     c.drawBitmap(image19, 0, 0, null);
                     c.drawBitmap(image20, 0, 0, null);
                }
            } finally 
            {
                if (c != null) holder.unlockCanvasAndPost(c);
            }
        }
    }
} 
```

这是对我的代码的编辑。不是解决方案....

```
 import android.graphics.Bitmap;

 import android.graphics.BitmapFactory;

 import android.graphics.Canvas;

 import android.os.Handler;

 import android.service.wallpaper.WallpaperService;

 import android.view.SurfaceHolder;

 public class WallpaperSer extends WallpaperService {

int incrementer=0;
Bitmap bmps[]=new Bitmap[10];

public void onCreate() 
{
    super.onCreate();
}

public void onDestroy() 
{
    super.onDestroy();
}

public Engine onCreateEngine() 
{
    return new WallpaperSerEngine();
}

class WallpaperSerEngine extends Engine 
{

    int res[]={R.drawable.and1,R.drawable.and2,R.drawable.and3,R.drawable.and4,R.drawable.and5,R.drawable.and6,R.drawable.and7,R.drawable.and8,R.drawable.and9,R.drawable.and10};
    WallpaperSerEngine() 
    {  
          for(int i=0;i<=10;i++)
              {
                    bmps[i]= BitmapFactory.decodeResource(getResources(),res[i]);                     
               }
    }
}

    private final Handler handler = new Handler();
     private final Runnable drawRunner = new Runnable() {
            @Override
            public void run() {

                  drawFrame();
                  handler.removeCallbacks(drawRunner);

                  handler.postDelayed(drawRunner, 200);
            }

        };
        void drawFrame() 
        {
            final SurfaceHolder holder = getSurfaceHolder();

            Canvas c = null;
            try 
            {
                c = holder.lockCanvas();
                if (c != null) 
                {              

                     c.drawBitmap(bmps[incrementer], 0, 0, null);

                    incrementer=(incrementer==10)?0 : incrementer+1; 
                }
            } finally 
            {
                if (c != null) holder.unlockCanvasAndPost(c);
            }
        }

        private SurfaceHolder getSurfaceHolder() {
            // TODO Auto-generated method stub
            return null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T04:53:23.420

您必须注册一个处理程序并使用一些线程。

但首先像这样添加一个全局int，

整数增量=0；

请参阅您的修改后的代码。

**1）**在你的 `WallpaperSerEngine`类中，创建一个像这样的处理程序，

```
 private final Handler handler = new Handler(); 
```

**2）**类似地在类中添加一个**Runnable**`WallpaperSerEngine`并调用你的 `drawFrame()`，

```
 private final Runnable drawRunner = new Runnable() {
        @Override
        public void run() {

              drawFrame();              
        }

    }; 
```

**3）** 将以下行添加到您的 drawFrame() 的底部，以确保您的可运行文件在特定时间间隔内被调用以绘制帧，

```
 handler.removeCallbacks(drawRunner);

        handler.postDelayed(drawRunner, 200); //delay milliseconds 200\. Change it for your need. 
```

**4)**现在改变你的**drawFrame()**方法。你不能这样做。您必须使用一些位图数组。这很关键。Kindle 清楚地遵循以下步骤。

**5)**不要为每个位图声明变量，而是将其放入位图数组中。

```
Bitmap bmps[]=new Bitmap[10]; // assign its size based on your need. I just need 10 for demo. 
```

**6)**现在为您的 Drawable 资源声明一个 int 数组。

```
 int res[]={R.drawable.and1,R.drawable.and2,R.drawable.and3,R.drawable.and4,R.drawable.and5,R.drawable.and6,R.drawable.and7,R.drawable.and8,R.drawable.and9,R.drawable.and10}; 
```

**7）**现在改变你的`WallpaperSerEngine()`样子。

```
WallpaperSerEngine() 
        {  
              for(int i=0;i<=10;i++)
                  {
                        bmps[i]= BitmapFactory.decodeResource(getResources(),res[i]);                     
                   }
        } 
```

**8)现在终于在您的****drawFrame()**中进行了一些修改，

```
void drawFrame() 
        {
            final SurfaceHolder holder = getSurfaceHolder();

            Canvas c = null;
            try 
            {
                c = holder.lockCanvas();
                if (c != null) 
                {              

                     c.drawBitmap(bmps[incrementer], 0, 0, null);

                    incrementer=(incrementer==10)?0 : incrementer+1; 
                }
            } finally 
            {
                if (c != null) holder.unlockCanvasAndPost(c);
            }
        }
    } 
```

就是这样。你现在应该看到你的框架了。如果这有帮助，请接受它。

# mysql - 将表行与原始行的列标题连接成列

> ID：10677700
> 
> 赞同：2
> 
> 时间：2012-05-20T22:18:26.013
> 
> 标签：mysql, stored-procedures, dynamic-sql

我有三个简化的 MYSQL 表，包含以下列：

```
ModuleEntries (MDE_ID)
ModuleFields (MDF_ID, MDF_Label)
ModuleEntryFieldValues (MFV_ID, MFV_MDE_ID, MFV_MDF_ID, MFV_Value) 
```

正如您从简化的列列表中看到的那样，`ModuleEntryFieldValues`该表声明“对于一个条目，此字段具有此值”。

现在，我想在一个“平面”记录集中检索这些信息。我已经设法让事情正常进行，但并不完全符合我的要求。

在另一篇 SO 文章的帮助下，我设法通过使用游标使**动态、可变数量的列工作。**

```
 declare finish int default 0;
  declare fldid int;
  declare str varchar(10000) default 'SELECT *,';
  declare curs cursor for select MDF_ID from ModuleFields group by MDF_ID;
  declare continue handler for not found set finish = 1;
  open curs;
  my_loop:loop
    fetch curs into fldid;
    if finish = 1 then
      leave my_loop;
    end if;
    set str = concat(str, 'max(case when MFV_MDF_ID = ',fldid,' then MFV_Value else null end) as field_',fldid,',');
  end loop;
  close curs;
  set str = substr(str,1,char_length(str)-1);
  set @str = concat(str, ' from ModuleEntries LEFT join ModuleEntryFieldValues ON MDE_ID = MDF_MDE_ID GROUP BY MDE_ID');
  prepare stmt from @str;
  execute stmt;
  deallocate prepare stmt;
```

这段代码**没有**做的是允许我将列值`MDF_Label`作为行的实际列标题。现在，上面的代码给了我“field_1, field_2, ...”

是否可以连接这三个表，并`MDF_Label`为现在是连接表中列的行设置列标题？

**我要这个...**

```
ModuleEntries  |   ModuleFields         |   ModuleEntryFieldValues
-------------  |   ------------------   |   -----------------------------------
MDE_ID         |   MDF_ID - MDF_Label   |   MFV_MDE_ID - MFV_MDF_ID - MFV_Value
1              |   1      - Height      |   1          - 1          - 120cms
               |   2      - Width       |   1          - 2          - 30cms
               |   3      - Weight      | 
```

**进入这个**

```
Recordset
---------
MDE_ID - Height - Width - Weight
1      - 120cms - 30cms - null 
```

我希望我的问题足够清楚。如果没有，请发表评论，如果可以的话，我会在需要的地方提供更多信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T10:12:17.997

我只是使用[`GROUP_CONCAT()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_group-concat)而不是游标来生成准备好的语句：

```
SELECT CONCAT(
 ' SELECT MDE_ID,'

,  GROUP_CONCAT(
     't', MDF_ID, '.MFV_Value AS `', REPLACE(MDF_Label, '`', '``'), '`'
   )

,' FROM ModuleEntries '

, GROUP_CONCAT(
    'LEFT JOIN ModuleEntryFieldValues AS t', MDF_ID, '
       ON t', MDF_ID, '.MFV_MDE_ID = ModuleEntries.MDE_ID
      AND t', MDF_ID, '.MFV_MDF_ID = ', MDF_ID
  SEPARATOR ' ')

) INTO @qry FROM ModuleFields; 
```

保存空白编辑以使其更具可读性，然后您的示例数据`@qry`将包含：

```
SELECT MDE_ID,
       t1.MFV_Value AS `Height`,
       t2.MFV_Value AS `Width`,
       t3.MFV_Value AS `Weight`
FROM   ModuleEntries
  LEFT JOIN ModuleEntryFieldValues AS t1
         ON t1.MFV_MDE_ID = ModuleEntries.MDE_ID AND t1.MFV_MDF_ID = 1
  LEFT JOIN ModuleEntryFieldValues AS t2
         ON t2.MFV_MDE_ID = ModuleEntries.MDE_ID AND t2.MFV_MDF_ID = 2
  LEFT JOIN ModuleEntryFieldValues AS t3
         ON t3.MFV_MDE_ID = ModuleEntries.MDE_ID AND t3.MFV_MDF_ID = 3 
```

然后可以准备并执行该语句：

```
PREPARE stmt FROM @qry;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
SET @qry = NULL; 
```

这会产生以下结果：

```
MDE_ID 高度 宽度 重量
     1 120cms 30cms（空）

```

在[sqlfiddle](http://sqlfiddle.com/#!2/b840b/10)上查看。

# html - 可调整大小的导航栏

> ID：10677702
> 
> 赞同：0
> 
> 时间：2012-05-20T22:18:47.107
> 
> 标签：html, css, header, navigation

我对 html + css 很陌生。我目前正在尝试制作一个网站导航栏。我已经让它显示并且按钮可以在一定程度上工作，现在我唯一的问题是我希望图像可以使用浏览器窗口重新调整大小。

我使用的技术有 1 张图像，上面有正常的导航栏，鼠标悬停在下面的导航栏按钮上，所以通常图像显示上半部分，但当悬停在它上面时，会显示下半部分的某个部分。在我使用的编码中，引用每个按钮的位置和大小以及显示多少都是特定于像素的。

我想要这个导航栏做的是在一定程度上根据浏览器重新调整大小。因此，如果显示在较小的窗口中，图像将重新调整大小，反之亦然。我尝试将 px 更改为 %，但无济于事。有没有一种简单的方法来解决这个问题？

你可以在这里查看完整的网站：www.step-down.co.uk

```
ul#navbar li a {
display: block; float: left; height: 104px;
background-image: url(li1.png); text-indent: -9999px; position:relative; top:50px; right:10px; 
```

}

```
ul#navbar li a.news {
    width: 172px; background-position: 0px 0;
}

ul#navbar li a.newr {
    width: 338px; background-position: -172px 0;
}
ul#navbar li a.hype {
    width: 170px; background-position: -510px 0;
}

ul#navbar li a.reviews {
    width: 205px; background-position: -680px 0; 
}
ul#navbar li a.bands {
    width: 195px; background-position: -885px 0;
}

ul#navbar li a.contact {
    width: 214px; background-position: -1080px 0;
}

    ul#navbar li a.news:hover {
    background-position: 0px -114px;
}

    ul#navbar li a.newr:hover {
    background-position: -172px -114px;
}
    ul#navbar li a.hype:hover {
    background-position: -510px -114px;
}

    ul#navbar li a.reviews:hover {
    background-position: -680px -114px;
}
    ul#navbar li a.bands:hover {
    background-position: -885px -114px;
}
    ul#navbar li a.contact:hover {
    background-position: -1080px -114px
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T22:21:59.463

对于所有导航栏属性，使它们占整个屏幕的“%”，这样它们的大小将根据您的需要重新调整。

# jquery - jQuery UI 选项卡中的 Galleria？

> ID：10677711
> 
> 赞同：0
> 
> 时间：2012-05-20T22:19:28.233
> 
> 标签：jquery, user-interface, tabs, galleria

一切正常，但我在 Galleria 收到此错误：

```
 Fatal error: Could not extract a stage height from the CSS. Traced height: 0px. 
```

我已经设置了正确的宽度和高度，但我仍然有这个消息。

我该如何解决？谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T09:46:44.657

尝试添加：

```
Galleria.configure({ wait: true }); 
```

# sockets - 编写网络工具的最佳语言是什么

> ID：10677719
> 
> 赞同：0
> 
> 时间：2012-05-20T22:20:49.393
> 
> 标签：sockets, networking, ssh

您可以推荐什么语言（以及为什么）来制作网络工具：

*   网络分析器（数据包嗅探）
*   speedtest（发送流量，计算总速度并涉及 QoS 分析）
*   网络监视器（混杂模式网络监听器）
*   SSH 客户端（带有自己的扩展）

我正在考虑：Java、C# 或 C++（原因：面向对象，在语言本身中找到了一些标准函数，而无需导入现有的 api）

目的是学习在不使用 API 的情况下编写此类应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:24:19.927

我会为应用程序的敏感部分使用非托管语言。任何延迟和绝对性能都是问题的东西。对于其他一切，我会使用 Java 或托管的 .Net 语言。

# python - 日志记录与 print() + 日志记录最佳实践的优势

> ID：10677721
> 
> 赞同：7
> 
> 时间：2012-05-20T22:21:09.420
> 
> 标签：python, logging

我目前正在开发[pyftpdlib](http://code.google.com/p/pyftpdlib/)模块的 1.0.0 版本。这个新版本将引入一些向后不兼容的更改，因为某些 API 将不再接受字节，而是接受 unicode。当我这样做时，作为这个破坏的一部分，我正在考虑摆脱我的日志记录功能的可能性，这些功能目前使用打印语句，并使用日志记录模块。

截至目前，pyftpdlib 将日志记录委托给 3 个函数：

```
def log(s):
   """Log messages intended for the end user."""
   print s

def logline(s):
   """Log commands and responses passing through the command channel."""
   print s

def logerror(s):
   """Log traceback outputs occurring in case of errors."""
   print >> sys.stderr, s 
```

愿意自定义日志（例如将它们写入文件）的用户应该只覆盖这 3 个函数，如下所示：

```
>>> from pyftpdlib import ftpserver
>>>
>>> def log2file(s):
...        open('ftpd.log', 'a').write(s)
...
>>> ftpserver.log = ftpserver.logline = ftpserver.logerror = log2file 
```

现在我想知道：摆脱这种方法并改用日志模块有什么好处？从模块供应商的角度来看，我应该如何在模块中公开日志记录功能？我应该这样做：

```
import logging
logger = logging.getLogger("pyftpdlib") 
```

...并在我的文档中声明“记录器”是应该使用的对象，以防用户想要自定义日志的行为方式？故意设置预定义格式输出是否合法，如下所示：

```
FORMAT = '[%(asctime)] %(message)s'
logging.basicConfig(format=FORMAT)
logger = logging.getLogger('pyftpdlib') 
```

...？

你能想到一个第三方模块，我可以从日志功能作为公共 API 的一部分公开和整合的地方获取线索吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T08:09:01.807

库（ftp 服务器或客户端库）不应该初始化日志系统。所以可以实例化一个记录器对象并在文档中指向 logging.basicConfig （或者提供一个具有更高级输出的 basicConfig 函数，让用户在他的日志配置策略、普通 basicConfig 或库提供的配置中进行选择）

框架（例如 django）或服务器（ftp 服务器守护程序）应将日志系统初始化为合理的默认值，并允许自定义日志系统配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-21T08:46:50.030

通常库应该只创建一个[NullHandler](http://docs.python.org/library/logging.handlers.html#logging.NullHandler)处理程序，它只是一个什么都不做的处理程序。然后，使用您的库的最终用户或应用程序开发人员可以配置日志记录系统。有关详细信息，请参阅文档中的为[库配置日志记录](http://docs.python.org/howto/logging.html#configuring-logging-for-a-library)部分。`logging`特别是，请参阅开头的注释

> 强烈建议您不要添加除`NullHandler`库记录器之外的任何处理程序。

在您的情况下，我将根据日志记录文档简单地创建一个日志记录处理程序，

```
import logging
logging.getLogger('pyftpdlib').addHandler(logging.NullHandler()) 
```

**编辑**问题中概述的日志记录实现似乎完全合理。在您的文档中，只需提及`logger`并讨论或指向用户自定义库输出的`logging.setLevel`方法`logging.setFormatter`。`logging.basicConfig(format=FORMAT)`您可以考虑使用[`logging.config.fileConfig`](http://docs.python.org/dev/library/logging.config.html#logging.config.fileConfig)来管理输出设置并在文档中的某处记录配置文件，而不是使用它，再次将用户指向该文件中预期格式的日志记录模块文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T02:56:10.267

这是我用来制作可定制[记录器](http://www.pythonlogging.com/logging-to-console-and-file/)的资源。我没有做太多改变，我只是添加了一个 if 语句，并传入我是要登录到文件还是只是控制台。

检查[这个](https://stackoverflow.com/questions/384076/how-can-i-make-the-python-logging-output-to-be-colored)着色器。对输出进行着色非常好，因此 DEBUG 看起来与 WARN 不同，而 WARN 看起来与 INFO 不同。

Logging 模块捆绑了许多不错的功能，例如 SMTP 日志记录、文件轮换日志记录（因此您可以保存几个旧的日志文件，但每次出现问题时都不会创建 100 个）。

如果您想迁移到 Python 3，使用日志记录模块将无需更改打印语句。

日志记录很棒，具体取决于您在做什么，我之前只是轻轻地使用它来查看我在程序中的位置（如果您正在运行此功能，请以这种方式着色），但它比常规功能强大得多打印声明。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T07:02:33.250

您可以查看 Django（只需创建一个示例项目）并查看它如何初始化记录器子系统。

还有一个我前段时间写过的[上下文记录器助手——这个记录器自动获取模块/类/函数的名称，是从中初始化的。](https://stackoverflow.com/questions/2989398/logger-chain-in-python)这对于调试消息非常有用，您可以直接看到该模块吐出消息以及调用流程如何进行。

# ruby-on-rails - 从哈希数组中选择哈希 id

> ID：10677729
> 
> 赞同：2
> 
> 时间：2012-05-20T22:22:37.333
> 
> 标签：ruby-on-rails, ruby

假设我有一个包含多个哈希的数组

```
[#<Campaign id: 144> , #<Campaign id: 146>] 
```

为了简单起见，我删除了其他字段，但该对象确实有很多字段。我想要结束的是一组唯一的哈希 ID，例如：`[144, 146]`. 当然，有很多方法可以天真地做到这一点，但我想知道最好的方法是什么。我正在努力寻找为此目的而构建的功能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-20T22:28:43.310

```
your_array.map(&:id) 
```

或者

```
your_array.map{|i| i.id} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-20T22:26:17.680

您所拥有的似乎不是散列数组，而是某种其他类型的对象（`Campaign`）的数组。您应该能够通过`object_id`属性和`.map()`：

```
your_array.map(&:object_id) 
```

# date - 传递给 new Date() 的正确跨浏览器日期格式是什么

> ID：10677730
> 
> 赞同：2
> 
> 时间：2012-05-20T22:22:44.750
> 
> 标签：date, cross-browser, format

我确实用过

```
var elems = $("#D li").toArray();
elems.sort(function(a, b) {
    var adate = new Date($(a).find('div.dateDiv').text());
    var bdate = new Date($(b).find('div.dateDiv').text());
    return adate > bdate ? -1 : 1;
});
$("#D").html(elems);

<div id="D">
    <li>1<div class="dateDiv">2012-04-15 10:25:45</div><div>df</div></li> 
    <li>2 <div class="dateDiv">2012-04-10 19:41:08</div><div>df</div></li> 
    <li> 3 <div class="dateDiv">2012-04-20 07:00:10</div><div>ab</div></li> 
    <li>4 <div class="dateDiv">2012-04-12 16:45:50</div><div>a</div></li>

     <li>1<div class="dateDiv">2012-04-15 10:25:45</div></li>
   <li>2 <div class="dateDiv">2012-04-10 19:41:08</div></li>
  <li> 3 <div class="dateDiv">2012-04-20 07:00:10</div></li>
   <li>4 <div class="dateDiv">2012-04-12 16:45:50</div></li>

      <li>1<div class="dateDiv">2012-04-15 10:25:45</div></li>
   <li>2 <div class="dateDiv">2012-04-10 19:41:08</div></li>
  <li> 3 <div class="dateDiv">2012-04-20 07:00:10</div></li>
   <li>4 <div class="dateDiv">2012-04-12 16:45:50</div></li>

      <li>1<div class="dateDiv">2012-04-15 10:25:45</div></li>
   <li>2 <div class="dateDiv">2012-04-10 19:41:08</div></li>
  <li> 3 <div class="dateDiv">2012-04-20 07:00:10</div></li>
   <li>4 <div class="dateDiv">2012-04-12 16:45:50</div></li>
</div>​ 
```

我尝试了很多次 Firefox 浏览器或 IE 或 safari 的一些问题

它仅适用于 opera 和 chrome ，

传递给 new Date() 的正确跨浏览器日期格式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T12:47:24.967

如果您可以控制 HTML 中的日期格式，那么最好将其转换为时间戳。否则，您需要在 javascript 中创建一个函数以将其转换为正确的格式，无论是什么格式。

与其这样做，不如将其拆分为多个部分并将正确的参数传递给 new Date() —— 年、月、日、小时、分钟、秒。

[http://jsfiddle.net/katylava/xpjRa/2/](http://jsfiddle.net/katylava/xpjRa/2/)

```
function parseDate(date) {
    var date_time = date.split(' ');
    var ymd = date_time[0].split('-');
    var his = date_time[1].split(':');
    return new Date(ymd[0], ymd[1], ymd[2], his[0], his[1], his[2]);
}

var elems = $("#D li").toArray();
elems.sort(function(a, b) {
    var adate = parseDate($(a).find('div.dateDiv').text());
    var bdate = parseDate($(b).find('div.dateDiv').text());
    return adate > bdate ? -1 : 1;
}); 
```

# c++ - DLL 如何解析其 IAT？

> ID：10677731
> 
> 赞同：0
> 
> 时间：2012-05-20T22:22:59.843
> 
> 标签：c++, windows, winapi, dll, portable-executable

当我在我的进程中加载​​ dll 时，该 dll 如何解析它导入的函数的地址？我试图在 GetProcAddress 和 LdrGetProcedureAddress 上设置断点，但它没有在那里中断。

请有人解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T01:06:21.607

加载 DLL 时，加载程序将根据需要更新所有地址以反映加载 DLL 的基地址。

[http://msdn.microsoft.com/en-us/magazine/bb985014.aspx](http://msdn.microsoft.com/en-us/magazine/bb985014.aspx)：

> 创建 DLL 时，链接器假定 DLL 将加载到特定地址。某些代码和数据包含硬编码地址，仅当 DLL 在首选地址加载时才是正确的。但是，在运行时，操作系统可能不得不将 DLL 加载到不同的内存位置。
> 
> 为了处理操作系统必须移动 DLL 的情况，链接器将基址重定位添加到 DLL。基址重定位是需要修改的地址，以便它们包含 DLL 在内存中加载的正确地址。DLL 具有的基本重定位越多，操作系统需要越多的时间来处理它们并加载 DLL。基于正确的 DLL 在其首选地址加载，并且可以跳过处理基本重定位记录。

现在更常见的是 DLL 的基地址被随机化作为一种​​安全措施，上面的文章早于此。另见：

[搬迁（维基百科）](http://en.wikipedia.org/wiki/Relocation_%28computer_science%29)

[便携式可执行文件（维基百科）](http://en.wikipedia.org/wiki/Portable_Executable#Relocations)

# git - 将 git commit 消息添加到所有文件（即使未更改）

> ID：10677733
> 
> 赞同：3
> 
> 时间：2012-05-20T22:23:50.857
> 
> 标签：git, github

我想在特定时间更新 GitHub 中每个文件的提交消息。

每当我进行重大升级（将开发合并到稳定分支中）时，我想提交并将我的更改推送到 GitHub，以便所有文件，即使是那些没有更改的文件，都具有相同的提交消息。

**例子：**

*   开发经过测试并准备合并到 Master
*   开发并入master
*   提交消息“新版本：2.0”适用于所有文件（即使是未更改的文件）
*   主分支被推送到远程（GitHub）
*   GitHub 在每个文件/目录中显示相同的消息（“新版本：2.0”）

我*可以*遍历每个文件并在文件末尾添加一个换行符，但我觉得好像有一种方法可以从 git 或 github 本身执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T22:28:31.753

如果您想跟踪发布之类的时间点，请改用标签。不要像您建议的那样“破解”提交过程。然后，您将如何找到检查之间的真正差异？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-20T22:27:19.447

这根本不是 git 的工作方式，当您需要查看它时，在所有文件的历史记录中添加废话可能会适得其反。

您可能会发现[gitflow](http://nvie.com/posts/a-successful-git-branching-model/)是一本有用的读物​​。你不必使用它——但是对工作流的解释可能会帮助你理解如何更好地使用 git。

# zend-framework - Zend 框架中的验证器？

> ID：10677734
> 
> 赞同：1
> 
> 时间：2012-05-20T22:23:53.437
> 
> 标签：zend-framework, zend-form

我使用验证器来测试数据库中是否存在登录并且它可以工作，但是在为 Zend 表单添加装饰器后，验证器错误消息不再显示。

编码：

```
$this->setName("companyadd");

        $comp = new Zend_Validate_Db_NoRecordExists('company', 'name');
        $comp->setMessage("This company exists!!!!");

        $name = new Zend_Form_Element_Text('name');

        $name->addValidator($comp);
        $name->setAttrib('size', '45');
        $name->setLabel('Company Name')
                ->setAttrib('class', 'companyinputs');
        $submit = new Zend_Form_Element_Submit('submit');
        $this->addElements(array( $name, $submit));

        $this->setElementDecorators(
            array(
                'ViewHelper',
                array(array('data' => 'HtmlTag'), array('tag' => 'td', 'class' => 'element')),
                array('Label', array('tag' => 'td', 'class' => 'companylabel')),
                array(array('row' => 'HtmlTag'), array('tag' => 'tr', 'class' => 'signuptr'))
        ));
        $submit->setDecorators(
            array(
                'ViewHelper',
                array(array('data' => 'HtmlTag'), array('tag' => 'td', 'class' => 'element')),
                array(array('emptyrow' => 'HtmlTag'), array('tag' => 'td', 'class' => 'element', 'placement' => 'PREPEND')),
                array(array('row' => 'HtmlTag'), array('tag' => 'tr'))
        ));
        $this->setDecorators(
            array(
                'FormElements',
                array('HtmlTag', array('tag' => 'table', 'class' => 'signuptable')),
                'Form'
        )); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:25:55.023

您忘记向装饰器添加错误。

```
$this->setDecorators(array(
    // add this line
    'Errors',

    'FormElements',
     array('HtmlTag', array('tag' => 'table', 'class' => 'signuptable')),
     'Form'
)); 
```

# java - 方法 repaint() 不重绘，球重力动画

> ID：10677735
> 
> 赞同：2
> 
> 时间：2012-05-20T22:24:11.633
> 
> 标签：java, swing, repaint, gravity

问题是这个球在被拖动并退出点击后，应该根据给定的新 y 分量重新绘制。这是从重力最终计算出来的，并添加到速度，该速度被添加到循环中的现有 y 分量。

我已经调试了很多次，我就是不能把它打到头上。

它应该......移动到你拖动它的地方>>>当你放手它应该下降直到它撞到地面。

提前谢谢你。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class DragBallPanel extends JPanel implements MouseListener, MouseMotionListener
{
     private static final int BALL_DIAMETER = 40;
     private int screen_size_x = 300;
     private int screen_size_y = 300;
     private int ground_lvl = screen_size_y - 15;

     private int _ballX     = ground_lvl/2;
     private int _ballY     = ground_lvl - BALL_DIAMETER;
     private final double GRAVITY = -9.8;
     private double velocity;
     private static final double TERM_VEL = -100;

     private int _dragFromX = 0;
     private int _dragFromY = 0;

     private boolean _canDrag  = false;

     public DragBallPanel() throws InterruptedException
     {
        setPreferredSize(new Dimension(screen_size_x, screen_size_y));
        setBackground(Color.darkGray);
        setForeground(Color.darkGray);

        this.addMouseListener(this); 
        this.addMouseMotionListener(this);
    }

    public void paintComponent(Graphics g)
     {
        super.paintComponent(g);   // Required for background.
          g.setColor (Color.green);
          g.fillRect (0, 280, 400, 50 );
          g.setColor (Color.black);
        g.fillOval(_ballX, _ballY, BALL_DIAMETER, BALL_DIAMETER);

    }

    public void mousePressed(MouseEvent e)
    {
        int x = e.getX();
        int y = e.getY();

        if (x >= _ballX && x <= (_ballX + BALL_DIAMETER)
                && y >= _ballY && y <= (_ballY + BALL_DIAMETER))\
          {
            _canDrag = true;
            _dragFromX = x - _ballX;
            _dragFromY = y - _ballY;
        } else
          {
            _canDrag = false;
        }
    }

    //===== mouseDragged ======
    /** Set x,y  to mouse position and repaint. */
    public void mouseDragged(MouseEvent e)
    {
        if (_canDrag)
          {   // True only if button was pressed inside ball.
            //--- Ball pos from mouse and original click displacement
            _ballX = e.getX() - _dragFromX;
            _ballY = e.getY() - _dragFromY;

            //--- Don't move the ball off the screen sides
            _ballX = Math.max(_ballX, 0);
            _ballX = Math.min(_ballX, getWidth() - BALL_DIAMETER);

            //--- Don't move the ball off top or bottom
            _ballY = Math.max(_ballY, 0);
            _ballY = Math.min(_ballY, getHeight() - BALL_DIAMETER);

            this.repaint();
        }
    }

    public void mouseExited(MouseEvent e)
    {
          while(_ballY < ground_lvl)
          {
                 simulateGravity();
          }   
    }

     public void simulateGravity()
     {
         if(_canDrag)
         {
             try{
                 velocity = velocity + GRAVITY;

               if (velocity < TERM_VEL)
                 {
                    velocity = TERM_VEL;
                 }

                if (_ballY >= ground_lvl - BALL_DIAMETER)
                {
                   velocity = velocity/4; 
                } 
                _ballY += velocity;
                 Thread.sleep(400);
                 this.repaint();//**problem occurs here**

              }catch(InterruptedException ie)
              {
              }
         }
     }

    public void mouseMoved   (MouseEvent e){}
    public void mouseEntered (MouseEvent e){}
    public void mouseClicked (MouseEvent e){}
    public void mouseReleased(MouseEvent e){}
} 
```

主（）类

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.*;

public class DragDemo extends JApplet
{
    public static void main(String[] args) throws InterruptedException
    {
        JFrame window = new JFrame();
        window.setTitle("Drag Demo");
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
          //window.add(new DragBallPanel());
        window.setContentPane(new DragBallPanel());
          window.setResizable(false);
        window.pack();
        window.show();
    }

    public DragDemo() throws InterruptedException
    {
        new DragBallPanel();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T23:27:23.300

这个**SSCCE**开始显示代码中的问题。

1.  编译代码。
2.  运行。
3.  向上拖动球。
4.  释放球。
5.  将鼠标移出绘图区，查看..
6.  ***球往上***掉！

 *你似乎已经把 Y 值颠倒了。它们从屏幕顶部开始，然后向下。此外，代码在无限循环中阻塞了 EDT。要解决这个问题，请使用 Swing 运行动画`Timer`。

请阅读 SSCCE 上的文件并询问其中是否有您不理解的内容。我很适合解释。:)

* * *

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class DragBallPanel extends JPanel implements MouseListener, MouseMotionListener
{

    private static final int BALL_DIAMETER = 40; // Diameter of ball

    private int screen_size_x = 300;
    private int screen_size_y = 300;
    private int ground_lvl = screen_size_y - 15;

    private int _ballX     = ground_lvl/2;
    private int _ballY     = ground_lvl - BALL_DIAMETER;
    private final double GRAVITY = -9.8;
    private double velocity;
    private static final double TERM_VEL = 100;

    private int _dragFromX = 0;    // pressed this far inside ball's
    private int _dragFromY = 0;    // bounding box.

    /** true means mouse was pressed in ball and still in panel.*/
    private boolean _canDrag  = false;

    public DragBallPanel()
    {
        setPreferredSize(new Dimension(screen_size_x, screen_size_y));
        setBackground(Color.darkGray);
        setForeground(Color.darkGray);

        this.addMouseListener(this);
        this.addMouseMotionListener(this);
    }

    public void paintComponent(Graphics g)
     {
        super.paintComponent(g);   // Required for background.
          g.setColor (Color.green);
          g.fillRect (0, 280, 400, 50 );
          g.setColor (Color.black);
        g.fillOval(_ballX, _ballY, BALL_DIAMETER, BALL_DIAMETER);

    }

    public void mousePressed(MouseEvent e)
    {
        int x = e.getX();   // Save the x coord of the click
        int y = e.getY();   // Save the y coord of the click

        if (x >= _ballX && x <= (_ballX + BALL_DIAMETER)
                && y >= _ballY && y <= (_ballY + BALL_DIAMETER)) {
            _canDrag = true;
            _dragFromX = x - _ballX;  // how far from left
            _dragFromY = y - _ballY;  // how far from top
        } else {
            _canDrag = false;
        }
    }

    //========= mouseDragged =================
    /** Set x,y  to mouse position and repaint. */
    public void mouseDragged(MouseEvent e)
    {
        if (_canDrag) {   // True only if button was pressed inside ball.
            //--- Ball pos from mouse and original click displacement
            _ballX = e.getX() - _dragFromX;
            _ballY = e.getY() - _dragFromY;

            //--- Don't move the ball off the screen sides
            _ballX = Math.max(_ballX, 0);
            _ballX = Math.min(_ballX, getWidth() - BALL_DIAMETER);

            //--- Don't move the ball off top or bottom
            _ballY = Math.max(_ballY, 0);
            _ballY = Math.min(_ballY, getHeight() - BALL_DIAMETER);

            this.repaint(); // Repaint because position changed.
        }
    }

    //====================================================== method mouseExited
    /** Turn off dragging if mouse exits panel. */
    public void mouseExited(MouseEvent e)
     {
         System.out.println("Exited: " + e);
        //_canDrag = false;
        runGravity();
        /*  while(_ballY < ground_lvl)
          {
             simulateGravity();
          }*/
    }

    Timer timer;
    ActionListener animate;

    public void runGravity() {
        if (animate==null) {
            animate = new ActionListener() {
                public void actionPerformed(ActionEvent ae) {
                    System.out.println("Ground: " + (_ballY-ground_lvl));
                    if (_ballY > ground_lvl) {
                        timer.stop();
                    } else {
                        simulateGravity();
                    }
                }
            };
            timer = new Timer(100,animate);
        }
        timer.start();
    }

     public void simulateGravity()
     {
         System.out.println("_canDrag: " + _canDrag);
         if(_canDrag)
         {

             velocity = velocity + GRAVITY;

           if (velocity > TERM_VEL)
             {
                velocity = TERM_VEL;
             }

            if (_ballY >= ground_lvl - BALL_DIAMETER)
            {
                //We have hit the "ground", so bounce back up. Reverse
                //the speed and divide by 4 to make it slower on bouncing.
                //Just change 4 to 2 or something to make it faster.
               velocity = velocity/4;
            }
            _ballY += velocity;
             //this.revalidate();
             this.repaint();
         }
    }

    public void mouseMoved   (MouseEvent e){}
    public void mouseEntered (MouseEvent e){}
    public void mouseClicked (MouseEvent e){}
    public void mouseReleased(MouseEvent e){}

    public static void main(String[] args) {
        SwingUtilities.invokeLater( new Runnable() {
            public void run() {
                DragBallPanel dbp = new DragBallPanel();
                JOptionPane.showMessageDialog(null, dbp);
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:37:57.640

尝试`updateUI()`代替`repaint()`.

如果没有效果，请移除组件并重新添加。*

# conditional - Web 测试条件流

> ID：10677737
> 
> 赞同：0
> 
> 时间：2012-05-20T22:24:16.960
> 
> 标签：conditional, webtest, load-testing

我创建了一个 webtest，它是一系列 web 服务请求。我的数据源包含一个手机号码列表，这些手机号码可以是两种类型 - A 和 B。问题是数据源包含 A 和 B 的混合。当测试运行时，它从数据中加载一个手机号码源（XML 文件）。我想确定测试何时运行，手机号码的类型是什么（A 或 B）！因为根据这一点，我将向 Web 服务器发送适当的消息。

但是，我可以在运行测试之前创建一个包含键值对（手机号码、类型）的文本文件。但是添加一个读取整个文件然后找到手机号码类型的插件会太慢。是否可以在整个测试期间将这些映射存储在内存中？这样我就可以查询它们了？

谢谢

阿玛雷

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T20:33:17.920

不要使用 XML 文件作为数据源，而是使用新的文本文件作为数据源。

例如，如果您的数据源是`DataSource1`并且您的文件是`numbers.csv`，并且您有列`mobile number`，`type`那么在您的测试中您可以参考以下上下文参数：

*   `DataSource1.numbers#csv.mobile#number`

*   `DataSource1.numbers#csv.type`

使用一对字符串比较条件规则，根据`DataSource1.numbers#csv.type`.

# asp.net-mvc-4 - 在一个项目中混合 Web Api 和 ASP.Net MVC 页面

> ID：10677745
> 
> 赞同：50
> 
> 时间：2012-05-20T22:25:35.017
> 
> 标签：asp.net-mvc-4

如何在一个项目中混合使用 Web API 和 ASP.Net MVC 页面？

例如，我有模型用户。我希望在同一个项目中拥有一个 ApiController 来响应用于管理用户实体的所有 HTTP 动词，同时拥有一个控制器来根据请求的操作返回适当的强类型视图。

我不能命名两个控制器 UserController。解决这个问题的最佳方法是什么？我应该命名一个 UserApiController 和另一个 UserController 吗？还有其他建议吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-05-21T00:35:43.297

您可以将它们放在单独的名称空间中，例如 MyApp.Controllers.UsersController 和 MyApp.Controllers.WebAPI.UsersController。

这将让您在 MVC 和 WebAPI 中公开类似的 URI 路由，例如：

```
/users/1      << MVC view
/api/users/1  << Web API 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-02-19T17:17:47.900

我没有更改命名空间，我唯一要做的就是先注册 WebApi，然后再注册 MVC 路由

```
//First register WebApi router
GlobalConfiguration.Configure(WebApiConfig.Register);
//and register Default MVC Route after
RouteConfig.RegisterRoutes(RouteTable.Routes); 
```

一切都很好！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-07-09T16:02:25.107

WebApi 实现应作为单独的[区域](http://msdn.microsoft.com/en-us/library/ee671793%28v=vs.100%29.aspx)添加到 MVC 应用程序中。这是一个自然的契合。这样做会为您提供 Mike Wasson 推荐的单独命名空间，此外，它还为您提供了一种设置 /api 路由的自然方式。你得到一个单独的模型文件夹

此外，它与项目的其余部分非常明确地分开。如果将来的要求是您需要将 api 实现分离到一个单独的项目中，那么将 api 实现隔离到一个单独的区域会使分解它变得容易得多。

# android - Android ClassNotFoundException

> ID：10677749
> 
> 赞同：3
> 
> 时间：2012-05-20T22:26:04.997
> 
> 标签：android, manifest

我的应用程序有问题，昨天一切正常，但今天我更新了 sdk，现在当我尝试运行我的应用程序时，我遇到了这样的错误

```
 05-21 00:14:19.285: W/dalvikvm(7061): Unable to resolve superclass of Lcom/lpp/towndefence/MainMenuActivity; (122)
05-21 00:14:19.285: W/dalvikvm(7061): Link of class 'Lcom/lpp/towndefence/MainMenuActivity;' failed
05-21 00:14:19.285: D/AndroidRuntime(7061): Shutting down VM
05-21 00:14:19.285: W/dalvikvm(7061): threadid=1: thread exiting with uncaught exception (group=0x40018560)
05-21 00:14:19.345: E/AndroidRuntime(7061): FATAL EXCEPTION: main
05-21 00:14:19.345: E/AndroidRuntime(7061): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.lpp.towndefence/com.lpp.towndefence.MainMenuActivity}: java.lang.ClassNotFoundException: com.lpp.towndefence.MainMenuActivity in loader dalvik.system.PathClassLoader[/data/app/com.lpp.towndefence-1.apk]
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1679)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1783)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.app.ActivityThread.access$1500(ActivityThread.java:123)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:938)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.os.Looper.loop(Looper.java:130)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.app.ActivityThread.main(ActivityThread.java:3837)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at java.lang.reflect.Method.invokeNative(Native Method)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at java.lang.reflect.Method.invoke(Method.java:507)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at dalvik.system.NativeStart.main(Native Method)
05-21 00:14:19.345: E/AndroidRuntime(7061): Caused by: java.lang.ClassNotFoundException: com.lpp.towndefence.MainMenuActivity in loader dalvik.system.PathClassLoader[/data/app/com.lpp.towndefence-1.apk]
05-21 00:14:19.345: E/AndroidRuntime(7061):     at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
05-21 00:14:19.345: E/AndroidRuntime(7061):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1671)
05-21 00:14:19.345: E/AndroidRuntime(7061):     ... 11 more 
```

我的清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.lpp.towndefence"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="7"/>
    <uses-permission android:name="android.permission.WAKE_LOCK"/>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:label="@string/app_name"
            android:name=".MainMenuActivity" >
            <intent-filter >
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity 
            android:name=".TownDefenseActivity">
        </activity>
    </application>

</manifest> 
```

我清理了项目，修复了项目属性，但没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T17:31:41.797

就像@Barak 说的：jar 文件放在 libs 目录中。但请确保在“项目属性”->“java 构建路径”->“订购和导出”中也检查了库。

# git - 我正在尝试推送到 Heroku，但它说我的指纹不正确

> ID：10677752
> 
> 赞同：1
> 
> 时间：2012-05-20T22:27:01.367
> 
> 标签：git, heroku, ssh

！您的指纹 XX:XX:XX:XX:XX:XX:XX:XX:XX 无权访问应用程序

我已经将新密钥推送到服务器，但它不允许我访问服务器。我也有两个heroku 帐户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:26:19.880

我发现您可以从以下位置切换帐户：

[http://martyhaught.com/articles/2010/12/14/managing-multiple-heroku-accounts/](http://martyhaught.com/articles/2010/12/14/managing-multiple-heroku-accounts/)

这个插件很棒而且完美无缺（只需确保为每个 Heroku 帐户创建单独的 ssh 密钥）。

我希望这对其他人有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:43:47.920

如果您还没有 SSH 密钥，请生成一个 SSH 密钥，然后使用`heroku keys:add`.

有用的链接：[管理 Heroku 的 SSH 密钥](https://devcenter.heroku.com/articles/keys#adding_keys_to_heroku)。

# ssas - 在 MDX 中参数化非对称集？

> ID：10677758
> 
> 赞同：0
> 
> 时间：2012-05-20T22:28:03.330
> 
> 标签：ssas, mdx

我从 2005 年升级到 SQL Server 2008 R2，现在这个查询不再起作用（尽管我不排除我所做的事情是原因）。我已经简化了名称/查询来演示这个问题：

```
SELECT
  NON EMPTY
  {
        [BizDim].[County].[County]
      * [BizDim].[name].[name]
  }
  ON COLUMNS,
  {
        [Biz Line Type Dimension].[Line Number].[Line Number]
      * [Biz Line Type Dimension].[Display Name].[Display Name]
  }
  ON ROWS
  FROM [TPS Data View]
  Where (
    STRTOSET("{[BizDim].[County ID].&[16]}", CONSTRAINED)  
    ,STRTOSET("{([BizDim].[Corp].[Corp].ALLMEMBERS,[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].&[x]),([BizDim].[Corp].[Corp].&[x],[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].ALLMEMBERS)}")    
  ) 
```

本质上，这是一个逻辑或，如果列 Corp == 'x' OR HQ == 'x' 然后将其包含在结果中。这被称为非对称（原文如此）集。

上面给出了错误：Tuple 函数需要一个 3 参数的元组表达式。使用了元组集表达式。

我可以删除 STRTOSET 功能，它工作得很好：

```
 Where (
    STRTOSET("{[BizDim].[County ID].&[16]}", CONSTRAINED)  
    ,{([BizDim].[Corp].[Corp].ALLMEMBERS,[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].&[x]),([BizDim].[Corp].[Corp].&[x],[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].ALLMEMBERS)}    
  ) 
```

然而，这并不好，因为实际的查询是参数化的，所以它必须使用 STRTO* 函数：

```
 Where (
    STRTOSET(@Counties, CONSTRAINED)  
    ,STRTOSET(@BizTypes)  
  ) 
```

我试过 STRTOTUPLE 并得到同样的错误。

我可以动态地构建查询，但我宁愿避免承担这种风险，特别是考虑到它在使用参数之前运行良好。

所以问题是，如何让这个不对称集在 SQL Server 2008 R2 SSAS 中再次作为参数工作？

更新：请注意，这通过替换键将 ALLMEMBERS 消除了错误，但实际上并没有过滤任何内容，因此它仅在一般情况下显示我的语法似乎不错：

```
 Where (
    STRTOSET("{[BizDim].[County ID].&[16]}", CONSTRAINED)  
    ,{([BizDim].[Corp].[Corp].ALLMEMBERS,[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].ALLMEMBERS),([BizDim].[Corp].[Corp].ALLMEMBERS,[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].ALLMEMBERS)}    
  ) 
```

我确实设法以一种不那么动态的方式让它工作，但很烦人。基本上我的过滤器需要分成许多不同的参数，因为我需要为每个参数调用 STRTOSET：

```
 Where (
    STRTOSET("{[BizDim].[County ID].&[16]}", CONSTRAINED)  
    ,{
       STRTOSET("([BizDim].[Corp].[Corp].ALLMEMBERS,[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].&[x])")
      ,STRTOSET"([BizDim].[Corp].[Corp].&[x],[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].ALLMEMBERS)")
    }    
  ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:19:44.523

[评论后编辑]

```
 Where 
    STRTOSET("{[BizDim].[County ID].&[16]}", CONSTRAINED)  
    * STRTOSET("{([BizDim].[Corp].[Corp].ALLMEMBERS,[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].&[x]),([BizDim].[Corp].[Corp].&[x],[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].ALLMEMBERS)}") 
```

它们可能与 (x, y, z) 表示法有歧义，该表示法是元组或括号运算符；例如， ( {}, {} ) 是一个交叉连接。

也许您需要显式包装到 set ：

```
{ [BizDim].[HQ].[HQ].&[x] } 
```

或更换：

```
([BizDim].[Corp].[Corp].ALLMEMBERS,[BizDim].[Local].[Local].ALLMEMBERS,[BizDim].[HQ].[HQ].&[x]) 
```

使用显式交叉连接：

```
{ [BizDim].[Corp].[Corp].ALLMEMBERS * [BizDim].[Local].[Local].ALLMEMBERS * { [BizDim].[HQ].[HQ].&[x] } } 
```

希望有帮助。

# mysql - 最快的随机选择 WHERE X 列是 Y (NULL)

> ID：10677767
> 
> 赞同：2
> 
> 时间：2012-05-20T22:29:19.467
> 
> 标签：mysql, sql

目前我正在使用：

```
SELECT * 
FROM 
  table AS t1
  JOIN (
    SELECT (RAND() * (SELECT MAX(id) FROM table where column_x is null)) AS id
  ) AS t2 
WHERE 
  t1.id >= t2.id
  and column_x is null
ORDER BY t1.id ASC
LIMIT 1 
```

这通常非常快，但是当我将突出显示的 column_x 包含为 Y（null）条件时，它会变慢。

记录的列 X 为空时，最快的随机查询解决方案是什么？

ID 是 PK，X 列是 int(4)。表包含大约一百万条记录和超过 1 GB 的总大小，目前每 24 小时翻一番。

column_x 已编入索引。

列 ID 可能不连续。

在这种情况下使用的数据库引擎是 InnoDB。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:47:59.510

获得真正随机的记录可能会很慢。这个事实并没有太多的解决方法。如果您希望它是真正随机的，那么查询必须加载所有相关数据才能知道它必须从哪些记录中进行选择。

然而幸运的是，有更快的方法来做到这一点。它们不是完全随机的，但如果你乐于用一些纯粹的随机性来换取速度，那么它们对于大多数用途来说应该足够好。

考虑到这一点，获得“随机”记录的最快方法是向您的数据库添加一个额外的列，该列填充随机值。也许是主键的盐渍 MD5 散列？任何。在此列上添加适当的索引，然后只需将该列添加到`ORDER BY`查询中的子句中，您就会以随机顺序获取记录。

要获取单个随机记录，只需指定`LIMIT 1`并添加一个`WHERE random_field > $random_value`where 随机值，该值将是新字段范围内的值（例如，随机数的 MD5 散列）。

当然，这里的缺点是，尽管您的记录将按随机顺序排列，但它们将被卡在相同的随机顺序中。我确实说过这是用完美换取查询速度。您可以通过定期使用新值更新它们来解决此问题，但我想如果您需要保持新鲜，这对您来说可能是个问题。

另一个缺点是，如果您有存储限制并且您的数据库已经非常庞大，或者您是否有一个严格的 DBA 需要通过才能添加列，那么添加一个额外的列可能太多了。但同样，你必须权衡一些东西；如果你想要查询速度，你需要这个额外的列。

无论如何，我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:44:11.230

你跑过`explain`查询吗？输出是什么？

为什么不存储或缓存 : 的值`SELECT MAX(id) FROM table where column_x is null`并将其用作变量。您的查询将变为：

```
$rand = rand(0, $storedOrCachedMaxId);

SELECT * 
FROM 
  table AS t1
WHERE 
  t1.id >= $rand
  and column_x is null
ORDER BY t1.id ASC
LIMIT 1 
```

在数据库上更简单的查询可能会更容易。

知道如果您的数据包含相当大的漏洞 - 您*将不会*通过此类查询获得一致的随机结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-20T22:49:06.403

我认为您不需要加入，也不需要 order by，也不需要限制 1（前提是 id 是唯一的）。

```
SELECT *
FROM   myTable
WHERE  column_x IS NULL
   AND id = ROUND(RAND() * (SELECT MAX(Id) FROM myTable), 0) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T23:39:38.457

我是 MySQL 语法的新手，但进一步挖掘我认为动态查询可能会起作用。我们选择第 N 行，其中第 N 行是随机的：

```
SELECT @r := CAST(COUNT(1)*RAND() AS UNSIGNED) FROM table WHERE column_x is null;

PREPARE stmt FROM
'SELECT * 
FROM table
WHERE column_x is null
LIMIT 1 OFFSET ?';

EXECUTE stmt USING @r; 
```

# mysql - Rails 未连接到 MySQL

> ID：10677770
> 
> 赞同：0
> 
> 时间：2012-05-20T22:30:30.350
> 
> 标签：mysql, ruby-on-rails

我正在尝试让我的数据库与我的 SQL 数据库正确连接和交互。当我键入...

耙分贝：模式：转储

我明白了…………

```
simple_cms gregpfeffer$ rake db:schema:dump
dyld: lazy symbol binding failed: Symbol not found: _mysql_get_client_info
  Referenced from: /Library/Ruby/Gems/1.8/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle
  Expected in: flat namespace

dyld: Symbol not found: _mysql_get_client_info
  Referenced from: /Library/Ruby/Gems/1.8/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle
  Expected in: flat namespace

Trace/BPT trap: 5 
```

我编辑了我的 database.yml 现在阅读...

```
#   http://dev.mysql.com/doc/refman/5.0/en/old-client.html
development:
  adapter: mysql
  encoding: utf8
  reconnect: false
  database: simple_cms_development
  pool: 5
  username: simple_cms      
  password: XXXXXXXXXX
  socket: /tmp/mysql.sock 
```

知道这里发生了什么吗？我安装了 mySQL 和 mySQL2 gem，不确定是否有帮助。

非常感谢！格雷格·普费弗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:47:20.150

尝试使用 mysql2 作为适配器。看来您正在使用 mysql2 gem。

```
 adapter: mysql2 
```

# c# - 如何取消 RIA 服务加载操作

> ID：10677776
> 
> 赞同：5
> 
> 时间：2012-05-20T22:32:24.683
> 
> 标签：c#, .net, silverlight, wcf-ria-services

我在 Silverlight 项目中使用 RIA 服务。我在客户端使用 LoadOperation 类从服务器加载一些数据。

在加载该数据的过程中，请求可能会被对不同数据的更新请求所取代。这是基于对服务器进行的多个 LoadOperations，然后用户单击取消按钮。

如果我使用 LoadOperation 并在其上调用“取消”方法，操作似乎取消，但服务器端代码并​​未停止，使用 fiddler 我可以看到操作完成并返回 HTTP 状态代码 200。

当您调用“取消”时，它在服务器上做了什么，我希望它调用 ThreadAbortException 或类似的东西？这可以改进吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:39:44.957

因此，我查看了反编译的 RIA 服务源，似乎取消只是客户端。不会对服务器端进程进行任何更改。

基本上，当您运行时`operation.Cancel()`，它确保操作可以取消（`operation.CanCancel`），然后将其标记为已取消，并触发完成动作。

这意味着服务器端操作仍在继续，但响应客户端在完成时什么也不做

操作完成后，您需要检查`operation.IsCanceled`属性以查看该操作是否已取消。如果是这样，请忽略结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T07:01:52.217

据我了解，使用加载操作取消服务器端执行不可用。

您可以艰难地运行自己的取消执行：（取决于您使用的是 DomainService 基础还是 LinqToEntitiesDomainService 基础，执行会有所不同）

服务端

> 在您的服务方法中开始在新线程中加载将该线程对象放在会话中您的线程对象应该以一种可以取消 DbConnection 的方式...执行服务方法（调用）以取消当前正在执行的线程对象注册在会话中，并将其从会话中删除

客户端

> 在 LoadOperation 对象上调用取消并调用取消请求。

需要注意的是，您注释掉 OnSessionStart 并在 global.asax 中停止，以便每个用户以多线程方式执行 ria 服务，否则每个请求将等待前一个请求完成（这与 ria 服务线程有关，而不是我们的线程对象）

希望这有助于最好的问候

PS：我们还使用 RIA Services 和 EntityFramework 的悲观锁的类似解决方案，...

# prolog - Prolog 中回溯期间的状态传播

> ID：10677777
> 
> 赞同：1
> 
> 时间：2012-05-20T22:32:25.417
> 
> 标签：prolog, logic-programming, sicstus-prolog

假设我在 Prolog 中有一个简单的程序，它正在搜索某个状态空间：

```
search(State, State) :-
    is_solution(State).

search(State, Solution) :-
    generate(State, NewState),
    search(NewState, Solution). 
```

我知道：

*   `generate(State, NewState)``NewState`正在为任何给定的生产至少一个`State`
*   整个状态空间是有限的

我想修改`search`谓词以确保它始终能够在有限时间内进行检查。所以我写了类似的东西：

```
search(State, Solution) :-
    empty_memory(EmptyMem),
    add(State, EmptyMem, Memory),
    search(State, Memory, Solution).

search(State, _, State) :-
    is_solution(State).

search(State, Memory, Solution) :-
    generate(State, NewState),
    \+ exist(NewState, Memory),
    add(NewState, Memory, NewMemory),
    search(NewState, NewMemory, Solution). 
```

这是有效的，但它在回溯期间丢失了计算状态，所以现在我有一个空间大小最大高度的搜索树。

有没有办法在回溯期间传播状态而不会丢失任何计算信息？我想要一个带有 O(space_size) 节点的整个搜索树。可能吗？

**编辑：** 似乎我应该使用它`assert/[1,2]`来动态创建将用作全局内存的新子句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T06:15:38.667

在 SICStus Prolog 中，您可以使用黑板跨回溯存储信息：请参阅手册中的[Blackboard Primitives](https://www.sics.se/sicstus/docs/3.12.8/html/sicstus/Blackboard-Primitives.html#Blackboard-Primitives)。用于`bb_put(Key, Value)`在黑板上存储一些东西，也`bb_get(Key, Value)`可以用来取回它。请注意，黑板是按模块定义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T20:56:47.287

最干净的解决方案可能是使用支持 B-Prolog、Ciao、XSB 或 YAP 等表的 Prolog 编译器。在这种情况下，您只需将 generate/2 谓词声明为表格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T07:01:35.153

`assert`为什么不使用生成所有可能的状态，而不是使用`findall(N, generate(S,N),ALL)`。这将消除对回溯的需要，并将解释搜索空间树，然后可以在将访问过的状态作为附加参数传递的同时进行前序遍历。

# android - 如何在 Android 中正确打开/关闭 SQLite db

> ID：10677781
> 
> 赞同：10
> 
> 时间：2012-05-20T22:33:02.643
> 
> 标签：android, database, sqlite

我有一个运行正常且不会强制关闭或崩溃的应用程序。但是当我查看 LogCat 时，它偶尔会给我这样的信息：

```
05-20 15:24:55.338: E/SQLiteDatabase(12707): close() was never explicitly called on database '/data/data/com.---.--/databases/debt.db' 
05-20 15:24:55.338: E/SQLiteDatabase(12707): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here 
```

有点下...

```
05-20 15:24:55.338: E/System(12707): Uncaught exception thrown by finalizer
05-20 15:24:55.338: E/System(12707): java.lang.IllegalStateException: Don't have database lock! 
```

我不确定何时应该打开和关闭我的数据库？

我有一个主要活动，它只是一个闪屏。然后它进入一个使用数据库中的信息调用 ListView 的活动；因此，正是在*此*活动中首次打开数据库。

还有一个其他活动需要数据库，它使用 ListVeew 将其分支出来。我应该什么时候打开和关闭这个？Word似乎是我只需要打开一次，然后在应用程序“暂停”、“停止”或“销毁”时关闭。

如果是这种情况，我应该将 db.close() 方法放在哪里……在 onStop 等所在的启动画面主活动中？还是与打开数据库的活动相同的活动？或者..还有别的地方吗？

更新：

这是错误一直指向的代码行：

```
public void open() throws SQLException {
    database = dbHelper.getWritableDatabase();
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-20T23:25:29.183

如果您使用的是 DatabaseHelper 类的实例，并且在初始化 DBHelper 对象后，每次在数据库中工作时都应该在工作之前调用 open 方法，然后创建一个新游标，查询数据库，执行使用刚刚存储在游标中的信息，完成后关闭游标，然后关闭数据库。例如，如果您想获取数据库中的每个项目，您可以执行以下操作：

```
...    
DataBaseHelper db = new DataBaseHelper(this);
... 
db.open();
Cursor cursor = db.getAllItems(); 
maxCount = cursor.getCount(); 
Random gen = new Random();
row = gen.nextInt(maxCount); // Generate random between 0 and max
if (cursor.moveToPosition(row)) {
    String myString = cursor.getString(1);  //here I want the second column
    displayString(myString); //private method
}
cursor.close();
db.close(); 
```

`getAllItems`是我的公共方法，`DatabaseHelper`如果您想知道，它看起来像这样

```
public Cursor getAllItems() {
    return db.query(DATABASE_TABLE, 
        new String[] {
            KEY_ROWID, 
            KEY_NAME
        }, 
        null, 
        null, 
        null, 
        null, 
        null);
} 
```

这就是我访问我的数据库的方式，并且我没有遇到您遇到的任何错误，并且它运行良好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-11T05:58:48.243

我曾经使用上面提到的@Shikima 的方式，但是在具有许多后台服务、多线程等的复杂应用程序中，当您必须管理许多数据库实例并且除此之外，打开和关闭它们时，它会变得非常烦人。

为了克服这个问题，我使用了以下方法，它似乎工作正常。

### 1.

在[Application](http://developer.android.com/reference/android/app/Application.html)基类中声明并初始化**YourDBHelperClass的一个实例，如下所示：**

```
public class App extends Application {
  public static YourDBHelperClass db;

  @Override
  public void onCreate() {
    super.onCreate();
    db = new YourDBHelperClass(getApplicationContext());
    db.open();

  }
} 
```

### 2.

在您的活动中，或您想使用数据库的任何其他地方，初始化 YourDBHelperClass 对象，如下所示：

```
YourDBHelperClass db = App.db; 
```

然后您可以随心所欲地使用数据库，而不必担心每次都手动打开和关闭它。SQLiteOpenHelper在应用程序被销毁时负责[关闭](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-20T23:24:19.987

您可能没有正确处理您的数据库；您打开的数据库实例多于关闭的数据库实例。

您可以遵循许多设计模式来纠正此行为。您可能需要查阅[此答案](https://stackoverflow.com/a/9286006/844882)以获取更多信息。

# c++ - 向 std::map 添加元素时遇到问题

> ID：10677782
> 
> 赞同：1
> 
> 时间：2012-05-20T22:33:13.453
> 
> 标签：c++, stdmap

Foo.h：

```
class Foo
{
public:
    Foo(void);
    ~Foo(void);   

    void AddScreen(std::string name, ScreenBase &screenToAdd);

private:

    std::map<std::string, ScreenBase> m_screens;
}; 
```

Foo.cpp：

```
void Foo::AddScreen(string name, ScreenBase &screenToAdd)
{
    m_screens[name] = screenToAdd; 
} 
```

最后一行创建编译错误 C2784: 'bool std::operator <(const std::_Tree<_Traits> &,const std::_Tree<_Traits> &)' : 无法推断出 'const std:: 的模板参数

注释掉最后一行，编译成功。

我是 C++ 新手（来自托管语言），不知道为什么我不能用它填充地图。

任何见解都值得赞赏。谢谢。

```
ScreenBase.h :

    #pragma once
    class ScreenBase
    {
    public:
        ScreenBase();
        ~ScreenBase();

        virtual void Update(float tt, float dt);
        virtual void Render();
    }; 
```

ScreenBase.cpp：

```
#include "pch.h"
#include "ScreenBase.h"

ScreenBase::ScreenBase(void)
{
}
ScreenBase::~ScreenBase(void)
{
}
void ScreenBase::Update(float tt, float dt)
{

}
void ScreenBase::Render()
{

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:58:35.730

您忘记将以下行添加到 Foo.cpp

`#include <string>`

那应该解决它。

修复它的原因是因为在`std::string`那里定义了 2 个对象之间的“<”运算符。由于`std::map`是一个关联数组，它将使用您指定的特定排序函数（作为模板的第三个参数，例如`std::map<int, MyObj, MyIntCompareFunctor>`）对键进行排序，或者默认使用键类型的 < 运算符，在您的情况下为`std::string`。

PS 另外，通过引用传递字符串，而不是值：例如`void foo(const std::string& bar){};`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T22:45:16.183

要在 STL 容器中使用某些类（如 ScreenBase），该类必须符合某些规范（特征）。在这种情况下，ScreenBase 必须是可复制构造的，因此您至少需要

```
ScreenBase(const ScreenBase& src) { CopyFromOther(src); }

void CopyFromOther(const ScreenBase& src) {... do the stuff ... } 
```

复制构造函数。

还必须为 ScreenBase 定义“=”运算符。如果您已经有了复制构造函数并且它只是

```
ScreenBase& operator = (const ScreenBase& src) { CopyFromOther(src); return *this; } 
```

为了避免询问有关 STL 容器的所有可能问题，您还可以阅读 SGI 关于 STL 的文档。它描述了使用地图/哈希表和其他任何东西所需的一切。

[http://www.sgi.com/tech/stl/](http://www.sgi.com/tech/stl/)

* * *

您对“派生类的实例”的评论提供了另一种见解。然后尝试将指针存储到 ScreenBase。

所以使用这个：

```
std::map<std::string, ScreenBase*> m_screens; 
```

不会有警告，但当然需要额外的内存管理。

# php - Backbone.js 集合获取初始参数

> ID：10677783
> 
> 赞同：0
> 
> 时间：2012-05-20T22:33:27.370
> 
> 标签：php, json, collections, backbone.js

**有没有办法通过向fetch()**提供初始模型参数来获取集合。

**清除：**我有一个具有属性**name**（作为字符串）和**numbers(array)**的模型 Human 。我想在我的数据库中找到所有具有给定数字数组的人。（**示例：**我的数组中有 [123,342,4] ，对于每个数字，我想提取人名）。

我创建了一个 Human 集合，赋予模型是**human**。当我这样获取时，它不会引起任何问题；

```
humanCollection.fetch({
            success:function(model,response){
                console.log(model.toJSON().length);
                var arr=model.toJSON();
                for(var i=0;i<arr.length;i++)
                    console.log(arr[i].humanName+" ");
                console.log("Success");
            },
            error:function(model,response){
                console.log(response);
                console.log("Failure");
            }
        }); 
```

我正在考虑创建一个没有名称而只有数字的**虚拟人体对象，然后将数字传递给我的****php**，但是当我将参数放在开头时， **.fetch()**函数似乎不起作用。甚至下面的代码也不起作用；

```
 humanCollection.fetch({},{
                success:function(model,response){
                    console.log(model.toJSON().length);
                    var arr=model.toJSON();
                    for(var i=0;i<arr.length;i++)
                        console.log(arr[i].humanName+" ");
                    console.log("Success");
                },
                error:function(model,response){
                    console.log(response);
                    console.log("Failure");
                }
            }); 
```

可能是什么问题呢？为了检索具有给定数字的人类集合，我创建一个虚拟人体模型是否合乎逻辑。这是我能想到的传输特定所需 json 数据的唯一方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T10:32:53.310

我认为你在搞砸事情。

据我了解，这些*数字*是`Human.ids`您要获取的。

如果这是正确的，这些*数字*对于模型的一部分没有任何意义`Human`。我宁愿将它们移到`Collection`.

您必须准备集合以在*URL*中发送一个*过滤器*参数，该参数通知*服务器层*该集合想要获取的人类。*`fetch`*

 **此外，您还必须准备*服务器层*，以便能够使用您希望服务器响应的 Humans的*id来处理**过滤器*参数。

 *因此，在 Backbone Collection 中，我们可以使用如下方法的`data`选项`fetch()`：

```
humanCollection.fetch({ data: { ids: [123, 342, 4] } }); 
```

*服务器*将必须解析`ids`参数并仅返回请求的 Humans。

然后在您的收藏中**，您将只有您选择的人类**，您可以向他们询问*姓名*或其他任何内容。***

# node.js - 将 node.js 流保存到 mongodb - 如何正确连接？

> ID：10677784
> 
> 赞同：0
> 
> 时间：2012-05-20T22:33:54.733
> 
> 标签：node.js, mongodb, socket.io

我正在使用的脚本在这里：[https ://gist.github.com/2759751](https://gist.github.com/2759751)

我想修改一些代码以将来自 node.js 应用程序的流式解析消息存储到 mongodb 集合以供以后访问。到目前为止，我正在使用教程代码并且对正确使用 db.open() 机制感到困惑，如果我使用 db.open()，并且由于它是一个流，它抱怨它不能多次打开它。如果我删除它，它会说它找不到打开的连接。如何打开一次连接以允许存储流？

我用以下方法实例化 mongo：

```
mongo = require('mongodb'),
    db = new mongo.Db('wikis', new mongo.Server('localhost', 27017, {}), {}); 
```

流踢出这样的对象：

```
return {
    flag: flag,
    page: page,
    pageUrl: pageUrl,
    url: m[3],
    delta: delta,
    comment: m[6],
    wikipedia: wikipedia,
    wikipediaUrl: wikipediaUrl,
    wikipediaShort: config.wikipedias[msg[0]].short,
    wikipediaLong: config.wikipedias[msg[0]].long,
    user: user,
    userUrl: userUrl,
    unpatrolled: isUnpatrolled,
    anonymous: anonymous,
    robot: isRobot,
    namespace: namespace,
    minor: isMinor

} 
```

我想像这样存储部分流：

```
function saveRecs(msg){
//db.open(function(){

    db.collection('wikiCollection', function(err, collection){
        doc = {
            "page": msg.page,
            "url": msg.url,
            "user": msg.user
        };

        collection.insert(doc, function(){
            console.log('Got a record, boss!');
        }); 
    });
//});
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:00:40.700

db.open 接受这样的回调

```
dbOpenCallback(err, db){
  // Check if err is set to anything other wise you are good
}
//...
db.open(dbOpenCallback); 
```

一旦您建立了连接并且可以继续使用，只要 db 变量在范围内，您的 saveRecs 函数就可以调用。

# jquery - jquery button() 单击后退按钮时会导致白屏

> ID：10677786
> 
> 赞同：0
> 
> 时间：2012-05-20T22:34:12.147
> 
> 标签：jquery, android, crash, native

我正在通过 AJAX 更新带有一些按钮的列表。我的功能一般工作正常，但一段时间后会产生白屏。当我单击按钮并使用后退按钮并重复几次时，就会发生这种情况。当我使用 AJAX 刷新运行时提供的大约 10 个按钮时，单击几下后它会崩溃。当我刷新假设 20 个按钮时，它会在我第一次点击后退按钮时立即崩溃。应用程序崩溃时，LogCat 什么也没说。我尝试用 livequery 调用替换 button() 调用，该调用有效但一段时间后会产生相同的崩溃。

我正在开发一个原生应用程序。如果我将它作为 Firefox 中的网络应用程序进行尝试，它可以完美运行而不会崩溃。

我不确定我的问题是否与可用内存有关。我正在使用三星 Galaxy Ace 进行测试，它大约有。剩余 50 MB 内存和 1 GB SD 卡。

```
$(".warenkorb_class").click(function(e) {
      e.stopImmediatePropagation();
      e.preventDefault();
      $.post("http://mydomain/backend.php",{             
            action: "warenkorb", kunden_id: $local_kunden_id },
            function(data) {
        $.mobile.changePage("#warenkorb");
        $("#warenliste").html(data);
            $("#warenliste").listview("refresh");
            $(".warenliste_button_class").button();
        }, "html");
      }); 
```

我是android开发的新手，我已经为这个问题苦苦挣扎了几天，如果有人能帮助我，我会很高兴。

谢谢和问候， 弗洛里安

编辑：这是创建按钮代码的 backend.php 部分：

```
echo"<tr>";
echo utf8_encode("<td><a class='delete_button' href='#warenkorb' data-role='button' data-icon='delete' data-iconpos='notext' data-mini='true' data-inline='true' data-theme='b' id='1_$bestellungen_id'>Position löschen</a></td>");
echo utf8_encode("<td><a class='minus_button' href='#warenkorb' data-role='button' data-icon='minus' data-iconpos='notext' data-mini='true' data-inline='true' data-theme='b' id='2_$bestellungen_id'>eins weniger</a></td>");
echo"<td><a class='warenliste_button' href='#warenkorb' id='3_$bestellungen_id' data-mini='true'>$bestellungen_anzahl</a></td>";
echo utf8_encode("<td><a class='plus_button' href='#warenkorb' data-role='button' data-icon='plus' data-iconpos='notext' data-mini='true' data-inline='true' data-theme='b' id='4_$bestellungen_id'>eins mehr</a></td>");
echo utf8_encode("<td><a class='warenliste_button' href='#warenkorb' id='5_$bestellungen_id' data-mini='true' data-inline='true'>$produkte_bezeichnung</a></td>");
echo "</tr>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T13:18:25.583

我会看看优化您的代码，尝试删除类选择器并用 id 选择器替换它们，这在您的选择器中不可能更具体，即做 button.warenliste_button_class。

我会对其进行排序，因为崩溃可能是由于脚本在执行时内存不足。还检查 firebug/console 以检查并查看正在发生的事情，检查长时间运行的脚本，发布的大量数据等。

查看此链接以获取更多优化提示

[http://www.archer-group.com/2011/technology/jquery-javascript-optimization](http://www.archer-group.com/2011/technology/jquery-javascript-optimization)

如果没有更多信息，例如正在运行 jquery 的功能和数据，我没有更多建议。

# r - 在R软件中绘图，如何放大大PNG文件中的轴值

> ID：10677788
> 
> 赞同：1
> 
> 时间：2012-05-20T22:34:22.577
> 
> 标签：r

我使用以下代码绘制了值：

```
png(filename="q.png", width=3000, height=1600, units="px") 
```

但是 x 和 y 轴上的值似乎太小了。我想放大它们。我怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-20T22:46:34.673

我怀疑您在绘制图表时需要更改它，例如：

```
 par(mar=c(4,5,1,1))
 plot(rnorm(30), xlab= "Big font", ylab = "Big font", cex.lab = 2, cex.axis = 1.5) 
```

![例子：](../Images/e3104b51de130ff186601d9d96865b1e.png)

编辑 1：更改标题大小：

```
par(mar=c(5,5,4,1))
plot(rnorm(30), xlab= "Big font", ylab = "Big font", 
    cex.lab = 2, cex.axis = 1.5, cex.main=3, main="Big Font") 
```

![在此处输入图像描述](../Images/accef4ec380063557edf890ae3ba7da6.png)

编辑 2：阴影绘图区域。不确定这是否是最好的方法。可能有更简单、更优雅的方式来为绘图区域着色。

```
a = rnorm(30)
par(mar=c(5,5,4,1))
plot(a, xlab= "Big font", ylab = "Big font", type="n",
     cex.lab = 2, cex.axis = 1.5, cex.main=3, main="Big Font")
x <- par("usr")
rect(x[1], x[3], x[2], x[4], col = "grey")
points(a, pch=19) 
```

![在此处输入图像描述](../Images/7ae01b654c2c3e68c4cd1e50ef660629.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T22:47:27.357

您可以使用 'par' 设置文本放大率：

```
opar <- par(cex.axis = 1.5)
# plotting commands
par(opar) 
```

另外，分别用 cex.main、cex.lab 和 cex.sub 设置主文本、标签和副标题文本大小：

```
opar <- par(cex.axis = 1.5, cex.main = 1.5, cex.lab = 1.5, cex.sub = 1.5)
... 
```

单独设置 'cex' 也会放大绘制的符号，这可能合适，也可能不合适。

这些在 ?par

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T21:26:36.627

在 plot 命令中包含 cex.main、cex.sub、cex.lab。

[http://www.rseek.org/](http://www.rseek.org/)

在此链接中搜索 par。这是 r 软件所有命令的搜索目录

# vba - 为什么我在提供对象时收到 excel VBA 的“需要对象”错误？

> ID：10677791
> 
> 赞同：0
> 
> 时间：2012-05-20T22:34:57.707
> 
> 标签：vba, object, excel, required

我的主宏调用 4 个子宏，然后执行一行代码，然后生成“需要对象”错误。我不知道为什么，因为我正在提供一个对象（至少我认为我是）。

我的代码如下所示：

```
Sub main_macro()
    Call Mac1
    Call Mac2
    Call Mac3
    Call Mac4
    Range("B" & input1.Row).Value = Range("C" & scenario1.Row)     <-- this generates the error
End Sub

Sub Mac1()
   Dim input1 As Range
End Sub

Sub Mac2()
   Dim scenario1 As Range
End Sub

Sub Mac3()
   Set input1 = Range("A:A").Find("location1", LookIn:=xlValues, LookAt:=xlWhole)
End Sub

Sub Mac4()
   Set scenario1 = Range("A:A").Find("location2", LookIn:=xlValues, LookAt:=xlWhole)
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:49:26.780

这是你正在尝试的吗？

您的变量在过程中声明，其他人无法使用。因此你他们没有初始化。

```
Option Explicit

Sub main_macro()
    Dim input1 As Range, scenario1 As Range

    With Sheets("Sheet1") '<~~ Change this to the relevant Sheet
        Set input1 = .Range("A:A").Find("location1", LookIn:=xlValues, LookAt:=xlWhole)

        If input1 Is Nothing Then
            MsgBox "location1 not found"
            Exit Sub
        End If

        Set scenario1 = .Range("A:A").Find("location2", LookIn:=xlValues, LookAt:=xlWhole)

        If scenario1 Is Nothing Then
            MsgBox "location2 not found"
            Exit Sub
        End If

        .Range("B" & input1.Row).Value = Range("C" & scenario1.Row).Value
    End With
End Sub 
```

# android - 无法从安卓接收数据？

> ID：10677792
> 
> 赞同：1
> 
> 时间：2012-05-20T22:35:02.033
> 
> 标签：android, json, servlets

我的 servlet 没有从 android 客户端接收数据。日志中没有显示错误或警告。我的 android 屏幕显示类似 html 格式的 tomcat 错误报告。如何在 servlet 中从 android 检索数据。我的 servlet 返回 null。如何检查我的 servlet 是否接收数据？

```
public boolean PostData() 
{
try {
    String URL = "http://10.0.2.2:8080/myapp/StudentDetails"; 
    boolean isPosted;
    String name = getIntent().getExtras().getString("name");
    String classs = getIntent().getExtras().getString("classs");
    String age = getIntent().getExtras().getString("age");

    // creating default Client 
    HttpClient mClient = new DefaultHttpClient();
    // Connect URL 
    StringBuilder sb=new StringBuilder(URL);
    HttpPost mpost = new HttpPost(sb.toString());
    List<BasicNameValuePair> nameValuepairs = new ArrayList<BasicNameValuePair>(3);
    nameValuepairs.add(new BasicNameValuePair("name",name));
    nameValuepairs.add(new BasicNameValuePair("classs",classs));
    nameValuepairs.add(new BasicNameValuePair("age",age));
    mpost.setEntity(new UrlEncodedFormEntity(nameValuepairs));
    HttpResponse responce = mClient.execute(mpost);
    HttpEntity entity = responce.getEntity();
    BufferedReader buf = new BufferedReader(new  InputStreamReader(entity.getContent()));
    StringBuilder sb1 = new StringBuilder();
    String line = null;
    while ((line = buf.readLine()) != null) {
    sb1.append(line+"\n");
    }
    Toast.makeText(getApplicationContext(), sb1.toString()+"",1).show();
    TextView tv = (TextView) findViewById(R.id.textView1);
    tv.setText(sb1.toString());

    isPosted = true;
    } catch (UnsupportedEncodingException e) {
    Log.w(" error ", e.toString());
    } catch (Exception e) {
    Log.w(" error ", e.toString());
    }
    return false ;
    } 
```

**Servlet 编码**

```
 public class ClassDetails extends HttpServlet {

/**
 * 
 */
private static final long serialVersionUID = 1L;
public void doGet(HttpServletRequest request,
        HttpServletResponse response)
     throws ServletException, IOException
    {
    response.setContentType("text/html");
    PrintWriter out = response.getWriter();
    String title = "Database Result";
    String docType =  "<!doctype html public \"-//w3c//dtd html 4.0 "  +"transitional//en\">\n";
    out.println(docType + "<html>\n" + "<head><title>" + title + "</title> </head>\n" + "<body bgcolor=\"#f0f0f0\">\n" +  "<h1 align=\"center\">" + title + " </h1>\n");

   String name = request.getParameter("name");
   String classs = request.getParameter("classs");
   String age = request.getParameter("age");
   if(sldept !=null)
   {
       out.println(" First: " + name + "<br>");
       out.println(" Last: " + classs + "<br>");
       out.println(" Last: " + age + "<br>");

   }
   else
   {
       out.println("no value");

      }   
    }
      } 
```

# java - 排查拒绝合作的 Java 代码

> ID：10677793
> 
> 赞同：3
> 
> 时间：2012-05-20T22:35:25.460
> 
> 标签：java, string

名为“code”的字符串似乎无法读取。为什么会这样，我该如何解决？

我的代码（导致问题的代码段）：

```
String code;
for(int z = 0; z<x;z= z+0) // Repeat once for every character in the input string remaining
{
    for(int y=0;y<2;y++) //Repeat twice
    {
        c = (char)(r.nextInt(26) + 'a'); //Generate a random character (lowercase)
        ca = Character.toString(c);
        temp = code;
        code = temp + ca; //Add a random character to the encoded string
    } 
```

我的错误报告：

```
--------------------Configuration: <Default>--------------------
H:\Java\Compiler.java:66: variable code might not have been initialized
        temp = code;
               ^
1 error

Process completed. 
```

（我正在使用[JCreator](http://en.wikipedia.org/wiki/JCreator) 5.00，Java 7。）

（是的，错误报告看起来很愚蠢，但 Stack Overflow 将其读取为编码。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-20T22:38:36.303

`code`如果`x`为零，会有什么价值？答案是它根本没有价值（甚至没有`null`）。如果您愿意，可以将其初始化为空字符串：

```
String code = ""; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-20T22:52:26.417

Java 要求在使用其值之前对每个变量进行初始化。在此示例中，有一个相当明显的情况，即在分配变量*之前使用该变量。*Java 语言规范 (JLS) 不允许这样做。（如果是这样，程序的行为将是不可预测的，包括......可能...... JVM崩溃。）

在其他情况下，编译器会抱怨实际上所讨论的变量总是被初始化（或者看起来如此）。编译器不是“理解”你的代码，也不是试图推导出初始化的逻辑证明，而是遵循一个指定的过程来决定变量是否被*明确赋值*。这个过程本质上是保守的，它给出的答案要么是“它被初始化”，要么是“它可能没有被初始化”。因此编译错误消息的措辞。

这是一个编译器会抱怨的示例，即使变量在使用前被初始化是“明显的”：

```
boolean panic;
for (int i = 0; i < 10; i += 2) {
    if (i % 2 == 1 && panic) { // compilation error here
        System.out.println("Panic!!");
    }
} 
```

明确的分配规则（在 JLS 中指定）说`panic`在指示的点上没有明确地初始化。对于一个了解形式方法基础的人来说，证明`i % 2 == 1`永远是这样是一件简单的事情`false`。但是，编译器不能。（即使可以，鉴于 JLS 规则，代码仍然是错误的。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-20T22:39:19.500

您已经创建了一个引用，但您从未对其进行初始化。`code`通过将第一行更改为进行初始化

```
String code = "" 
```

**编辑：** Zavior 指出您可以从缓存中提取一个初始化的字符串，而不是为新字符串分配空间。

但是，为什么要将 temp 分配给 code，然后将 code 分配给 temp 以及其他内容？可以设置为`code = code + ca`。

# sql - SQL 表引用

> ID：10677795
> 
> 赞同：1
> 
> 时间：2012-05-20T22:35:45.130
> 
> 标签：sql

首先，我很抱歉标题不好，但 5 分钟后我想不出更好的东西。

请假设以下内容：有人和银行账户，我希望实现两个表来模拟它。一个人有一个 ID（主键）和一个名字。银行帐户还具有 ID（主键）、所有者（外键）和值。这是我的代码：

```
create table Person(
  ID integer primary key,
  name varchar(200) not null
);

create table Account(
  ID integer primary key,
  owner integer references Person(ID),
  value number not null
); 
```

现在，有没有办法让一个人“知道”哪些帐户与其相关联`select * from Account where owner = XY`？我问了我的老师，但甚至没有得到与 SQL 相关的答案。在互联网上，我找不到任何建议，所以我在这里问。请原谅我这个问题，但我已经习惯了面向对象的语言，其中 Person 类将包含一个 Enumerable 来存储所有帐户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:37:47.230

这就是**关系**数据库的工作方式，它们有带**关系**的表。

因为它是关系型的，所以您可以在一个查询中查询 a`Person`并获取与该人相关的所有`Account`s。为此，您需要执行`JOIN`.

### 代码示例

```
SELECT * FROM Person
JOIN Account ON (Person.ID = Account.owner)
WHERE Person.ID = XY; 
```

如果您想要一个**面向文档的**数据库，您可以使用 MongoDB 之类的东西，您可以在其中将一个`Account`直接嵌入到`Person`文档中。

# android - 将当前 TextView 内容绘制到 Bitmap

> ID：10677799
> 
> 赞同：5
> 
> 时间：2012-05-20T22:36:22.170
> 
> 标签：android, bitmap, scroll, textview

我在 ScrollView 中有一个 TextView：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/parentLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ScrollView
        android:id="@+id/textAreaScroller"
        android:layout_width="400px"
        android:layout_height="200px"
        android:layout_x="0px"
        android:layout_y="25px"
        android:fadeScrollbars="false"
        android:scrollbarSize="3px"
        android:scrollbarStyle="insideOverlay" >

        <TextView
            android:id="@+id/scrapbook"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:text="" />
    </ScrollView>

    <Button
        android:id="@+id/upBtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Up" />

    <Button
        android:id="@+id/downBtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Down" />

    <ImageView 
        android:id="@+id/imageView"
        android:layout_width="400px"
        android:layout_height="200px"    
        />

</LinearLayout> 
```

TextView 有很多文本，这就是可滚动的原因。我需要将 TextView 中的当前可见内容绘制到 Bitmap。出于测试目的，我在 ImageView 中显示此位图。我有以下代码：

```
public class TextviewToImageActivity extends Activity {

    private TextView textView;
    private ScrollView textAreaScroller;
    private ImageView imageView;

    private Handler mHandler;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mHandler = new Handler();

        imageView = (ImageView) findViewById(R.id.imageView);
        textAreaScroller = (ScrollView) findViewById(R.id.textAreaScroller);
        textView = (TextView) findViewById(R.id.scrapbook);

        textView.setOnTouchListener(new OnTouchListener() {

            public boolean onTouch(View v, MotionEvent event) {
                imageView.setImageBitmap(loadBitmapFromView(textAreaScroller));
                return false;
            }
        });

        Button upBtn = (Button) findViewById(R.id.upBtn);
        Button downBtn = (Button) findViewById(R.id.downBtn);

        upBtn.setOnTouchListener(new OnTouchListener() {

            public boolean onTouch(View v, MotionEvent event) {
                if (event.getAction() == MotionEvent.ACTION_DOWN) {
                    scheduleScroller(upScroller);
                    imageView.setImageBitmap(loadBitmapFromView(textView));
                } else if (event.getAction() == MotionEvent.ACTION_UP) {
                    mHandler.removeMessages(1);
                }
                return true;
            }
        });

        downBtn.setOnTouchListener(new OnTouchListener() {

            public boolean onTouch(View v, MotionEvent event) {
                if (event.getAction() == MotionEvent.ACTION_DOWN) {
                    scheduleScroller(downScroller);
                    imageView.setImageBitmap(loadBitmapFromView(textView));
                } else if (event.getAction() == MotionEvent.ACTION_UP) {
                    mHandler.removeMessages(1);
                }
                return true;
            }
        });

        loadDoc();
    }

    private Runnable downScroller = new Runnable() {
        public void run() {
            textAreaScroller.scrollBy(0, 10);
            scheduleScroller(downScroller);
        }
    };

    private Runnable upScroller = new Runnable() {
        public void run() {
            textAreaScroller.scrollBy(0, -10);
            scheduleScroller(upScroller);
        }
    };

    private void scheduleScroller(Runnable scrollerJob) {
        Message msg = Message.obtain(mHandler, scrollerJob);
        msg.what = 1;
        mHandler.sendMessageDelayed(msg, 10);
    }

    private static Bitmap loadBitmapFromView(View v) {
        Bitmap b = Bitmap.createBitmap(400, 200, Bitmap.Config.ARGB_8888);
        Canvas c = new Canvas(b);
        v.draw(c);
        return b;

    }

    private void loadDoc() {
        String s = "";

        for (int x = 0; x <= 100; x++) {
            s += "Line: " + String.valueOf(x) + "\n";
        }

        textView.setText(s);
        textView.setMovementMethod(new ScrollingMovementMethod());
    }
} 
```

问题是，一旦我滚动 TextView（触发 TouchEvent），Bitmap 就不会反映 TextView 的当前内容，而是总是只有 TextView 的开始内容（不管当前滚动位置是什么）。我更新了帖子以提供工作代码 - 也许它可以在某人的其他设备上工作。

**更新**

我还尝试通过覆盖`onDraw`我的自定义 TextView 来检查 WarrenFaith 的想法，但它仍然只绘制了 TextView 的开始内容：

```
public class MyTextView extends TextView {

    private Bitmap mBitmap;

    public MyTextView(Context context, AttributeSet attrs) {
        super(context, attrs);

    }
    public MyTextView(Context context) {
        super(context);
    }

    public MyTextView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public Bitmap getBitmap() {
        return mBitmap;
    }

    @Override
    protected void onDraw(Canvas canvas) {
        mBitmap = Bitmap.createBitmap(canvas.getWidth(), canvas.getHeight()
                 , Bitmap.Config.ARGB_8888);
        Canvas c = new Canvas(mBitmap);
        super.onDraw(canvas);
        super.onDraw(c);

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T20:31:33.237

尝试覆盖应该工作的`onDraw()`方法。`TextView`在那里，您可以根据 canvas 参数创建位图。详细信息可以在我的教程中找到：[如何从 SurfaceView 创建和保存屏幕截图](http://www.droidnova.com/how-to-create-and-save-a-screenshot-from-a-surfaceview,880.html)

**更新：**
我解决了你的问题：

活动（我更改了处理程序的用法并删除了一些方法。基本上我将代码缩小了一点）。

```
import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.text.method.ScrollingMovementMethod;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;
import android.widget.Button;
import android.widget.ImageView;

/**
 * @author WarrenFaith
 */
public class TextToImageActivity extends Activity {

    private MyTextView textView;
    private ImageView imageView;

    private boolean mRepeatDrawing = false;

    private Handler mHandler;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.textview);

        mHandler = new Handler();

        imageView = (ImageView) findViewById(R.id.imageView);
        textView = (MyTextView) findViewById(R.id.scrapbook);

        Button upBtn = (Button) findViewById(R.id.upBtn);
        Button downBtn = (Button) findViewById(R.id.downBtn);

        upBtn.setOnTouchListener(new OnTouchListener() {

            public boolean onTouch(View v, MotionEvent event) {
                if (event.getAction() == MotionEvent.ACTION_DOWN) {
                    mRepeatDrawing = true;
                    mHandler.post(upScroller);
                } else if (event.getAction() == MotionEvent.ACTION_UP) {
                    mRepeatDrawing = false;
                }
                return false;
            }
        });

        downBtn.setOnTouchListener(new OnTouchListener() {

            public boolean onTouch(View v, MotionEvent event) {
                if (event.getAction() == MotionEvent.ACTION_DOWN) {
                    mRepeatDrawing = true;
                    mHandler.post(downScroller);
                } else if (event.getAction() == MotionEvent.ACTION_UP) {
                    mRepeatDrawing = false;
                }
                return false;
            }
        });

        loadDoc();
    }

    private Runnable downScroller = new Runnable() {
        public void run() {
            textView.scrollBy(0, 10);
            imageView.setImageBitmap(textView.getBitmap());
            if (mRepeatDrawing) {
                mHandler.postDelayed(this, 10);
            }
        }
    };

    private Runnable upScroller = new Runnable() {
        public void run() {
            textView.scrollBy(0, -10);
            imageView.setImageBitmap(textView.getBitmap());
            if (mRepeatDrawing) {
                mHandler.postDelayed(this, 10);
            }
        }
    };

    private void loadDoc() {
        String s = "";

        for (int x = 0; x <= 100; x++) {
            s += "Line: " + String.valueOf(x) + "\n";
        }

        textView.setText(s);
        textView.setMovementMethod(new ScrollingMovementMethod());
    }
} 
```

自定义文本视图：重要：诀窍是获得滚动位置！

```
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.util.AttributeSet;
import android.widget.TextView;

/**
 * @author WarrenFaith
 */
public class MyTextView extends TextView {

    private Bitmap mBitmap;

    public MyTextView(Context context, AttributeSet attrs) {
        super(context, attrs);

    }

    public MyTextView(Context context) {
        super(context);
    }

    public MyTextView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public Bitmap getBitmap() {
        return mBitmap;
    }

    @Override
    protected void onDraw(Canvas canvas) {
        mBitmap = Bitmap.createBitmap(getWidth(), getHeight(), Bitmap.Config.ARGB_8888);
        Canvas c = new Canvas(mBitmap);
        c.translate(0, -getScrollY());
        super.onDraw(c);
        super.onDraw(canvas);
    }
} 
```

xml：（我删除了 ScrollView 并让 TextView 处理滚动）

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/parentLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <com.testproject.MyTextView
        android:id="@+id/scrapbook"
        android:layout_width="400px"
        android:layout_height="200px"
        android:scrollbars="vertical"
        android:scrollbarSize="3px"
        android:text=""
        android:background="#0000ff" />

    <Button
        android:id="@+id/upBtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Up" />

    <Button
        android:id="@+id/downBtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Down" />

    <ImageView
        android:id="@+id/imageView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

# algorithm - 查找最小函数

> ID：10677800
> 
> 赞同：5
> 
> 时间：2012-05-20T22:36:24.980
> 
> 标签：algorithm, optimization, geometry

好的，这是交易。我有一堆线性函数，a * x + b。

我的目标是回答以下问题/查询：*x = q 处的最小函数是什么？*

例如：如果我有函数 f(x) = 3*x + 2、g(x) = 5*x - 6 和 h(x) = 2*x + 1，我将回答例如：

*   对于 x = 4，函数 h

*   对于 x = 2，函数 g

*   对于 x = 1，函数 g

我的想法是这样的：

1.  按 x 的系数对函数进行降序排序。

2.  按升序对查询进行排序

3.  摆脱并行函数，保留具有最小常数项的函数（例如：如果我有 f(x) = 2*x + 4 和 g(x) = 2*x + 2，f(x) 将永远不会小于 g(x)，所以我不需要 f(x))。

4.  现在我在从-inf到某个实数的区间上，称之为w1，我知道在这个区间上，线性系数最高的函数是最小的

5.  通过找到最小的 x1 st f(x1) = g(x1) 来找到 w1，其中 f 是我当前的函数，g 以较小的线性系数遍历所有其他函数，w1 = x1

6.  只要我的查询在区间 (-inf, w1) 内就重复：输出当前函数，然后继续下一个查询。

7.  如果我仍然有需要回答的查询，让当前函数与我的实际当前函数在 x = w1 处相交，而不是 -inf put w1，重复相同的步骤。

但是，我的实现或想法还不够快。有什么我没有注意到的可以加快我的程序的吗？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T22:43:43.053

你能不能只解决它们的交点，并为域中的每个区间存储最大的函数？

编辑-详细说明，如果您要解决 x 的任何一对函数，则 x 表示这两个函数中的一个变得大于另一个的值。将会有可定义的区间，其中最小函数对于区间中的所有值都是相同的。

这是您的 3 个示例函数的图。 ![在此处输入图像描述](../Images/dd29e3c68a196fa026126207d9ebeaa9.png)

该图的间隔（具有相应的最小函数）将是

```
(-∞, 7/3]     => 5x - 6
(7/3, ∞]      => 2x + 1 
```

现在，在运行时，您只需执行*“q 属于什么区间” ，而不是**"What is the minimum function at x = q* " 。

 *而且，如果我没记错的话，如果你有 N 个线性函数，你*最多*可以存储 N-1 个区间。而且，如果您确实有很多功能需要分析，那么您可以使用专门的数据结构来存储和搜索区间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T23:16:57.067

如果我理解正确，您的解决方案是对您的所有函数进行一些预处理，以便将域`x`拆分为范围，并且在每个这样的范围中，您都知道什么是最小函数。

实际上有两个阶段：“准备”和“查询”（给定特定`x`的结果）。

你的瓶颈是什么？

自然地，为了使“查询”阶段更快，您应该将您的范围组织成一种排序数组，以便您可以`x`在对数时间内通过中值搜索（或类似）找到包含给定值的范围。如果这是您所做的，但仍然不够快 - 请考虑代码级优化，因为从算法的角度来看，这似乎是最佳解决方案。

如果您的瓶颈是“准备”阶段 - 这里有优化的机会。据我了解，您会发现所有函数对的交集（在摆脱并行函数之后）。这并不是真正必要的。

考虑以下。首先，您按系数对所有函数进行排序（较高的系数位于开头）。摆脱并行功能。接下来构建范围数组，同时遍历您的函数。

由于当前函数的系数最低（在那些已经分析过的函数中） - 当前函数将是最小的一个，`x`直到无穷大。所以它的范围应该是从一些`x0`到无穷大。找到那个`x0`。从数组中取出最后一个范围（属于先前处理的函数），并找到`x0`- 该函数与当前函数的交集。前一个范围缩小到`x0`. 如果该范围变得无效（范围开始大于`x0`） - 意味着该功能完全被遮挡。在这种情况下 - 删除该范围，然后重复该过程。

为了让事情更清楚，我将编写一个伪代码：

`rangeArr`是对数组`F,X`，而`F`是函数描述，`X`是函数范围的开始。函数范围的结束被认为是下一个范围的开始，最后一个函数范围的结束是+infinity。

```
for each F sorted by coefficient
{
    double x0;

    while (true)
    {
        if (rangeArr is empty)
        {
            x0 = -inf;
            break;
        }

        FPrev = rangeArr.back().F;
        xPrev = rangeArr.back().X;

        x0 = IntersectionOf(F, FPrev);

        if (x0 > xPrev)
            break;

        rangeArr.DeleteLastRange();
    }

    rangeArr.InsertRange(F, x0);
} 
```*

# asp.net-mvc - 为什么我的 MVC 中的 Ajax 表单没有显示验证错误？

> ID：10677801
> 
> 赞同：0
> 
> 时间：2012-05-20T22:36:27.073
> 
> 标签：asp.net-mvc, jquery-ui, jquery-dialog, jquery-validate

如果提交的数据为空/空时没有显示验证错误，会出现什么问题？应该显示一个错误。

在代码块`result.success == false`中，我应该重新加载视图还是告诉 jQuery 使我的模型无效？

从我`Post`在控制器中的操作中，我返回模型错误，因此我将它们放在客户端。

我现在该怎么办？

我正在使用带有最新 jQuery/UI 1.7.2/1.8.20 的 MVC 3.0：

```
<script type="text/javascript">

    $(document).ready(function () {

        // the div holds the html content
        var $dialog = $('<div></div>')
        .dialog({
            autoOpen: false,
            title: 'This is the dialogs title',
            height: 400,
            width: 400,
            modal: true,
            resizable: false,
            hide: "fade",
            show: "fade",
            open: function (event, ui) {
                $(this).load('@Url.Action("Create")');
            },
            buttons: {
                "Save": function () {
                    var form = $('form', this);               

                    $.ajax({
                        url: $(form).attr('action'),
                        type: 'POST',
                        data: form.serialize(),
                        dataType: 'json',
                        success: function (result) {
                           // debugger;
                            if (result.success) {
                                $dialog.dialog("close");
                                // Update UI
                            }
                            else {
                                // Reload the dialog to show model/validation errors 

                            } // else end
                        } // success end
                    }); // Ajax post end

                },
                "Close": function () {
                    $(this).dialog("close");
                }
            } // no comma
        });

        $('#CreateTemplate').click(function () {
            $dialog.dialog('open');
            // prevent the default action, e.g., following a link
            return false;
        });

    });
</script> 
```

我的表格是：

```
@using (Html.BeginForm("JsonCreate", "Template")) 
{  
    <p class="editor-label">@Html.LabelFor(model => model.Name)</p> 
    <p class="editor-field">@Html.EditorFor(model => model.Name)</p> 
    <p class="editor-field">@Html.ValidationMessageFor(model => model.Name)</p>     
} 
```

我的控制器是：

```
[HttpGet]
public ActionResult Create()
{          
    return PartialView();
}

[HttpPost]
public ActionResult JsonCreate(Template template)
{
    if (ModelState.IsValid)
    {
        _templateDataProvider.AddTemplate(template);
        // success == true should be asked on client side and then ???
        return Json(new { success = true });
    }

        // return the same view with model when errors exist
        return PartialView(template);
} 
```

工作版本是：

我在我的`$.ajax`请求中改变了这个：

```
// dataType: 'json', do not define the dataType let the jQuery infer the type !
data: form.serialize(),
success: function (result)
{
    debugger;
    if (result.success) {
        $dialog.dialog("close");
        // Update UI with Json data          
    }
    else {
        // Reload the dialog with the form to show model/validation errors 
        $dialog.html(result);
    }
} // success end 
```

Post 操作必须如下所示：

```
[HttpPost]
public ActionResult JsonCreate(Template template)
{
    if (!ModelState.IsValid) {
        return PartialView("Create", template);
        _templateDataProvider.AddTemplate(template);
        return Json(new { success = true });
    }
} 
```

返回作为表单的部分视图，`(success == false)`或者返回作为`success == true`.

仍然有人可以返回一个项目列表来更新客户端的 UI：

```
return Json(new { success = true, items = list}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:06:37.420

您必须确保返回的是 JSON 数据，而不是 html 或任何其他类型的数据。使用浏览器控制台了解有关您的 ajax 请求和响应的更多信息，以确保您得到正确的响应，正如您所期望的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T16:28:03.583

好吧，我看到的错误是——

你正在控制器中返回，你应该做一个

```
Response.Write(Json(new { success = true, items = list})); 
```

# jquery - jquery向下钻取版本2

> ID：10677803
> 
> 赞同：0
> 
> 时间：2012-05-20T22:36:44.553
> 
> 标签：jquery

鉴于我的 aspx 页面的以下 HTML 输出，其中显示了一个复选框列表；

```
 <div id="selectContainer" class="wrapper" >

    <div id="cbxArea" class="checkbox">

       <table id="ChartstoDisplay" style="border-color:DimGray;border-width:2px;border-style:Solid;width:300px;">

<tr>

    <td><input id="ChartstoDisplay_0" type="checkbox" name="ctl00$MainContent$ChartstoDisplay$ChartstoDisplay_0" value="Selected Year Cumulative P/L" /><label for="ChartstoDisplay_0">Selected Year Cumulative P/L</label></td>

</tr><tr>

    <td><input id="ChartstoDisplay_1" type="checkbox" name="ctl00$MainContent$ChartstoDisplay$ChartstoDisplay_1" value="Month by Month P/L for selected year" /><label for="ChartstoDisplay_1">Month by Month P/L for selected year</label></td>

</tr><tr>

    <td><input id="ChartstoDisplay_2" type="checkbox" name="ctl00$MainContent$ChartstoDisplay$ChartstoDisplay_2" value="All Commodities P/L for selected year" /><label for="ChartstoDisplay_2">All Commodities P/L for selected year</label></td>

</tr><tr>

    <td><input id="ChartstoDisplay_3" type="checkbox" name="ctl00$MainContent$ChartstoDisplay$ChartstoDisplay_3" value="Current Month&#39;s P/L by Commodity" /><label for="ChartstoDisplay_3">Current Month's P/L by Commodity</label></td>

</tr><tr>
</div>
</div> 
```

我试图在选择单个项目时更改它的类。我无法让我的 jquery 找到正确的对象来更改其类。这是我最新的迭代。

```
 $('#ChartstoDisplay').change(
          function () {
              $('#ChartstoDisplay').each(function () {
                 $(this).is(':checked').$('label').toggleclass("selected");
              });
          }); 
```

我也试过这种方式

```
 $('#ChartstoDisplay').change(
          function () {
              $('#ChartstoDisplay').each(function () {
                 $(this).is(':checked').$('label').attr.add('style',"color:darkgreen;");
              });
          }); 
```

这是完整的脚本

```
 //this script will change the style of the "Select All" checkbox and make visible the "Build Chart" button
  $(document).ready(function () {
      $('#ChartstoDisplayAll').change(
          function () {
              if ($('#ChartstoDisplayAll').is(':checked')) {
                  $(this).next().addClass("selected");
                  $('#buttons').addClass("buttonsshow").removeClass('buttonshide');
                  $("#cbxArea input[type=checkbox]").each(function () {
                      $(this).prop("checked", true);
                      $(this).siblings("label").toggleClass("selected");
                  });
              } else {
                  $('#buttons').addClass("buttonshide").removeClass('buttonsshow');
                  $(this).next().removeClass("selected");
                  $("#cbxArea input[type=checkbox]").each(function () {
                      $(this).prop("checked", false);
                      $(this).siblings("label").removeClass("selected");
                  });
              }
          });
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:01:56.577

试试这个

```
$("#cbxArea input[type=checkbox]").change(function(){
   $(this).siblings("label").toggleClass("selected");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:40:17.947

```
$('[id^="ChartstoDisplay_"]').on('change', function() {
  $(this).next('label')[$(this).prop('checked')?'addClass':'removeClass']("selected");
}); 
```

[小提琴](http://jsfiddle.net/PugWc/1/)

要遍历所有这些，请执行以下操作：

```
$('[id^="ChartstoDisplay_"]').on('change', function () {
    $('[id^="ChartstoDisplay_"]').each(function(i,e) {
        $(this).next('label')[$(this).prop('checked')?'addClass':'removeClass']("selected");
    });
});​ 
```

# c++ - 箭头-> 运算符重载如何在 C++ 内部工作？

> ID：10677804
> 
> 赞同：47
> 
> 时间：2012-05-20T22:36:56.523
> 
> 标签：c++, operator-overloading

我了解正常的运算符重载。编译器可以直接将它们转换为方法调用。我对 -> 运算符不是很清楚。我正在编写我的第一个自定义迭代器，我觉得需要 -> 运算符。我看了一下stl源代码并实现了我自己的：

```
MyClass* MyClassIterator::operator->() const
{
    //m_iterator is a map<int, MyClass>::iterator in my code.
    return &(m_iterator->second);
} 
```

然后我可以使用 MyClassIterator 的实例，例如：

```
myClassIterator->APublicMethodInMyClass(). 
```

看起来编译器在这里做了两个步骤。1\. 调用 ->() 方法获取一个临时的 MyClass* 变量。2\. 在临时变量上调用 APublicMethodInMyClass 使用它的 -> 操作符。

我的理解正确吗？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-05-21T02:35:03.443

The`operator->`在语言中具有特殊的语义，当重载时，它会将自身重新应用于结果。虽然其余运算符仅应用一次，`operator->`但编译器将根据需要应用多次以获取原始指针并再次访问该指针所引用的内存。

```
struct A { void foo(); };
struct B { A* operator->(); };
struct C { B operator->(); };
struct D { C operator->(); };
int main() {
   D d;
   d->foo();
} 
```

在前面的示例中，在表达式`d->foo()`中，编译器将获取对象`d`并将其应用于`operator->`它，这会产生一个类型为 的对象`C`，然后它将重新应用运算符以获取 的实例`B`，重新应用并获取`A*`，然后取消引用该对象并获取指向的数据。

```
d->foo();
// expands to:
// (*d.operator->().operator->().operator->()).foo();
//   D            C            B           A* 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-05-20T22:46:40.040

```
myClassIterator->APublicMethodInMyClass() 
```

只不过是以下内容：

```
myClassIterator.operator->()->APublicMethodInMyClass() 
```

对重载的第一次调用`operator->`会为您提供某种类型的指针，该指针具有可访问（来自您的调用站点）的成员函数，称为`APublicMethodInMyClass()`. resolve 遵循通常的函数查找规则`APublicMethodInMyClass()`，当然，这取决于它是否是虚拟的。

不一定有临时变量；*编译器*可能会也可能不会复制`&(m_iterator->second)`. 很可能，这将被优化掉。但是不会创建临时类型的对象`MyClass`。

通常的警告也适用于`m_iterator`——确保您的调用不会访问无效的迭代器（`vector`例如，如果您正在使用）。

# jquery - 悬停/翻转文本淡入效果

> ID：10677806
> 
> 赞同：0
> 
> 时间：2012-05-20T22:37:06.363
> 
> 标签：jquery, hover, fade, slide, caption

我正在寻找这种效果是如何产生的：

[http://www.thesartorialist.com/category/men/](http://www.thesartorialist.com/category/men/)

（当在该站点上将鼠标悬停在图像上时 - 链接/阳离子从您“输入”照片的一侧滑入）。

我想知道的是背景和链接栏是如何淡入的，然后它如何知道图像的哪一侧是您输入的那一侧？

我可以看到有用于夸大的 CSS，它带来了黑色渐变图像叠加，但不是很多。

提前谢谢了..

亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:54:34.907

对于滑入和滑出的栏，请考虑使用 -- [http://docs.jquery.com/UI/Effects/Slide](http://docs.jquery.com/UI/Effects/Slide)

为了得到它应该进入的那一面，你可以做一些原始的东西。也就是说，对于悬停在每个图像上，您可以从事件对象作为 event.pageX 获取鼠标位置，然后您可以始终找出图像的哪一侧位于该点，因为您有图像的宽度，和图像的 offsetLeft。

获得鼠标入口点后，通过使用 jquery 设置栏的 css 将栏带到那一侧，然后从所需方向将其滑入。

祝你好运。

# objective-c - CFDictionary objectForKey 消息发送到释放的实例

> ID：10677810
> 
> 赞同：1
> 
> 时间：2012-05-20T22:37:35.707
> 
> 标签：objective-c, ios, runtime-error

有谁知道为什么会发生这种情况？

[![在此处输入图像描述](../Images/ecbd25a2110f1c5d8333a4d97449afaf.png)](https://i.stack.imgur.com/dhd1i.png)

该错误清楚地表明它正在尝试访问已被释放的字典的 objectForKey。但是在堆栈跟踪中我没有看到任何字典。这怎么可能？

所以这里是代码：

```
-(CGSize)sizeConstrainedToSize:(CGSize)maxSize fitRange:(NSRange*)fitRange {
    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)self);
    CFRange fitCFRange = CFRangeMake(0,0);
    CGSize sz = CTFramesetterSuggestFrameSizeWithConstraints(framesetter,CFRangeMake(0,0),NULL,maxSize,&fitCFRange);
    if (framesetter) CFRelease(framesetter);
    if (fitRange) *fitRange = NSMakeRange(fitCFRange.location, fitCFRange.length);
    return CGSizeMake( floorf(sz.width+1) , floorf(sz.height+1) ); // take 1pt of margin for security
} 
```

更新：

原来这是 NSCache 上的一个问题：

```
@implementation NSCache (SharedCache)
+(NSCache*)sharedCache;
{
    static NSCache* sharedCache = nil;
    if (sharedCache == nil) {
        sharedCache = [[[self alloc] init] retain];
        [sharedCache setCountLimit:0];
    }
    return sharedCache;
} 
```

如果我删除了保留它会崩溃..

它基本上在这里崩溃：

```
CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)self); 
```

除了那个例外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:41:35.723

属性或成员变量之一是或包含已被释放的字典。您可能有代码在过度释放的属性字符串上设置属性字典。

最终，您突出显示的代码是识别过度释放的对象，而不是崩溃代码。您需要找到对象被过度释放的位置。我建议使用 Xcode 性能工具，特别是 Zombies 工具来识别此崩溃。它只是模拟器，所以这需要在模拟器中重现才能使用僵尸工具。

# entity-framework - 实体框架提交更改

> ID：10677814
> 
> 赞同：0
> 
> 时间：2012-05-20T22:38:15.910
> 
> 标签：entity-framework

我在表 A 上触发以在表 A 上插入新行期间更改表 B 上的列值。

由于当前的设计，我收到 RowVersion 错误。所以我正在考虑在 entity 上执行当前触发功能`SubmitChanges`。我相信`INotifyPropertyChanged`在属性更改时触发，在我的情况下将在表 A 属性更改时触发，这不是我想要的。我想对表 A 的行插入执行操作以更新表 B 上的值。

任何人都知道什么是更好的方法来处理它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T08:01:15.837

您可以覆盖`SaveChanges`，将所有实体插入表 A，并对表 B 中的实体执行更新。

```
public override int SaveChanges(SaveOptions options) 
{
    foreach(TableA a in ObjectStateManager.GetObjectStateEntries(EntityState.Added)
                                          .Where(e => !e.IsRelationship)
                                          .Select(e => e.Entity)
                                          .OfType<TableA>())
    {
        // Here you can get your TableB entity and do an update
        // If you don't have those entities already loaded you will load
        // them one by one so it will probably need some additional 
        // adjustments for better performance
    }

    return base.SaveChanges(options);
} 
```

# c# - ASP.NET MVC 3 中的服务器端图像上传验证 - 限制文件类型、大小和尺寸

> ID：10677824
> 
> 赞同：1
> 
> 时间：2012-05-20T22:41:01.603
> 
> 标签：c#, asp.net-mvc-3, validation, file-upload

我有一个简单的表格：

```
@using (Html.BeginForm(null, null, FormMethod.Post, new { enctype="multipart/form-data" }))
{
    <input type="file" name="image" />
    <br />
    <input type="submit" value="Upload" />
} 
```

我要发布到：

```
[HttpPost]
public ActionResult Upload(HttpPostedFileBase file)
{
    if (file.ContentLength > 0)
    {
        // All necessary validation logic here
    }

    return RedirectToAction("Index");
} 
```

我正在尝试将上传的文件限制为 jpeg、png 和 gif 格式。我无法限制上传图像的最小和最大宽度和高度以及图像文件大小。

我想我可以通过简单地将`if`语句更改为：

```
if (file.ContentLength > 0 && file.ContentLength < maxUploadSize) 
```

我知道如何检查上传文件的扩展名，但我更愿意检查它的 mime-type/header。

**问题**：

鉴于上面的示例代码，我如何正确验证上传的文件？我想确保该文件是：

*   JPEG、GIF 或 PNG 文件（检查文件扩展名和文件头）
*   不大于最大上传大小（文件大小）
*   预定义限制内的尺寸（宽度/高度）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T00:28:58.380

正如您所说，您应该只通过文件扩展名验证图像类型。由于请求标头可以伪造，因此不可靠。

要获得最大上传大小，您需要根据需要更新 web.config 或 machine.config - 应用程序级别或机器级别。

对于 IIS6：

```
<location path="upload">
  <system.web>
    <httpRuntime maxRequestLength="xxx" />
  </system.web>
</location> 
```

对于 IIS7： http: [//support.microsoft.com/kb/942074/](http://support.microsoft.com/kb/942074/)

至于验证尺寸，您必须读取图像并检查其`width`和属性，这是在内存中执行`height`此操作的构造函数[位图类。](http://msdn.microsoft.com/en-us/library/z7ha67kw)如果您想先将图像保存到文件中，请使用[这个](http://msdn.microsoft.com/en-us/library/0cbhe98f).

细则：增加此值可能会使您成为拒绝服务 (DOS) 攻击的受害者，如此处[所述](http://nullablecode.com/2011/02/maxrequestlength-packet-sizes-size-isnt-everything/)。

安防措施：

*   目前我能想到的一个解决方法是设置另一台服务器/机器来处理文件上传，这样你的主 Web 服务器就不会受到影响。
*   用于`<location path="my-upload-path">`将此设置应用于单个位置。
*   考虑使用[HttpHandler 或 HttpModule](https://stackoverflow.com/questions/10348554/large-file-upload-using-httphandler-or-httpmodule)来处理上传。

一旦我有比这更好的解决方案，我会更新我的答案。

# jquery - Pusher 不会做 jQuery 事件

> ID：10677829
> 
> 赞同：0
> 
> 时间：2012-05-20T22:42:17.843
> 
> 标签：jquery, pusher

嘿，所以我有这个代码：

```
var channel = pusher.subscribe('test_channel');
channel.bind('my_event', function(data) {
    alert(data);
    $("#element").html(data);
}); 
```

但是 jQuery html 事件不起作用。警报有效，但为什么 jQuery 不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T09:21:23.330

在以下情况下，您的代码将起作用：

*   你已经加载了 jquery 库
*   #element 对象存在于 DOM 中。
*   数据变量具有非空字符串值

# jquery - 如何创建一个 onclick 事件来关闭/打开页面上特定类的所有实例？

> ID：10677833
> 
> 赞同：1
> 
> 时间：2012-05-20T22:42:44.190
> 
> 标签：jquery, html, css

我知道这将涉及 Jquery，我不像我自己想的那样学习。我知道有一个切换功能，但不知道如何模拟它以供我自己使用。

这在css3中也可能吗？但我猜测 Jquery 会是一个更好的跨浏览器解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T22:48:34.433

假设您有一个带有特定的按钮或其他元素`id`：

```
$('#id').click(
    function(){
        $('.className').toggle();
    }); 
```

或者，更漂亮一点：

```
$('#id').click(
    function(){
        $('.className').fadeToggle();
        /* or:
        $('.className').slideToggle();
        */
    }); 
```

考虑到一些相当具体的标记约束和*较低*的跨浏览器兼容性要求，这在 CSS 中是可能的，尽管仅在 CSS3 中：

HTML：

```
​&lt;a href="#show">Show all</a>
    <div id="show">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <a href="#">hide</a>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

CSS：

```
div {
    height: 0;
}
div > a {
    opacity: 0;
}
div:target a {
    opacity: 1;
}

div > ​div {
    height: 0;
    width: 0;
    margin: 0 auto;
    border-width: 0;
    border-style: solid;
    border-color: #000;
    border-radius: 1em 0;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -o-transition: all 1s linear;
    transition: all 1s linear;
}

div:target > div​ {
    height: 200px;
    width: 200px;
    border-width: 2px;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -o-transition: all 1s linear;
    transition: all 1s linear;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/TQPuk/)。

当然，上述内容可以适用于特定类而不是*所有* `div`元素，这是使用通用兄弟组合器处理特定类的*一种*（尽管可能不是*唯一*`~`）方法：

HTML：

```
<a href="#show">Show all</a>
<a href="#firstOne">Show all '.one' elements</a>
<a href="#firstTwo">Show all '.two' elements</a>
<div id="show">
    <div></div>
    <div id="firstOne" class="one"></div>
    <div id="firstTwo" class="two"></div>
    <div></div>
    <div class="one"></div>
    <div></div>
    <div class="two"></div>
    <div class="one"></div>
    <a href="#">hide</a>
</div>​ 
```

CSS：

```
div {
    height: 0;
}
div > a {
    opacity: 0;
}
div:target a {
    opacity: 1;
}

div > div {
    height: 0;
    width: 0;
    margin: 0 auto;
    border-width: 0;
    border-style: solid;
    border-color: #000;
    border-radius: 1em 0;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -o-transition: all 1s linear;
    transition: all 1s linear;
}

div:target > div {
    height: 200px;
    width: 200px;
    border-width: 2px;
    background-color: #ccc;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -o-transition: all 1s linear;
    transition: all 1s linear;
}

div:target > .one,
.one {
    background-color: #ffa;
}

div:target > .two,
.two {
    background-color: #f90;
}

.one:target,
.one:target ~ .one {
    height: 200px;
    width: 200px;
    border-width: 2px;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -o-transition: all 1s linear;
    transition: all 1s linear;
}

.two:target,
.two:target ~ .two {
    height: 200px;
    width: 200px;
    border-width: 2px;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -ms-transition: all 1s linear;
    -o-transition: all 1s linear;
    transition: all 1s linear;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/TQPuk/1/)。

但请记住，CSS 选择只能选择*稍后*出现在 DOM 中的元素，因此要显示链接的*所有*`div`元素*必须*是 that的*第一个*元素，因此，简而言之，目标*必须*从字面上看，是。因此这个名字，真的，但似乎值得一提。`class="one"``target`**`class`*`#firstOne`***

 ***参考：

*   [`fadeToggle()`](http://api.jquery.com/fadeToggle/).
*   [W3 中的通用兄弟组合子和`:target`伪类](http://www.w3.org/TR/selectors/)。
*   [`slideToggle()`](http://api.jquery.com/slideToggle/).
*   [`toggle()`](http://api.jquery.com/toggle/).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T22:47:59.587

尝试 ：

```
$(button).click(function(){
    $('.yourclassname').toggle();
}); 
```

`jQuery.toggle`这是有关该功能的一些文档：http: [//api.jquery.com/toggle/](http://api.jquery.com/toggle/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T22:45:18.637

我不确定你会如何在 css3 中做到这一点，但在 jquery 中你使用类选择器（“.class”）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T22:48:02.437

```
$('.myclass').on('click', function() { $(this).slideToggle('fast'); }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-20T22:48:18.947

```
$(this).click(function(){

   $("element_to_delete").toggle();

}); 
```

如果你想隐藏/显示***

# php - PHP 票证 ID 生成

> ID：10677836
> 
> 赞同：0
> 
> 时间：2012-05-20T22:43:29.130
> 
> 标签：php, random, unique

我正在创建一个用于学习目的的票证系统，我想知道如何创建一个与此类似的简单的唯一票证 ID：`gD8f-jxS`

第一部分将有 4 个随机大小写字符

（允许使用字母和数字，然后它会有一个破折号，然后是 3 个任意大小写的随机字母或数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T23:01:47.727

```
public function generateCode(){

    $unique =   FALSE;
    $length =   7;
    $chrDb  =   array('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','0','1','2','3','4','5','6','7','8','9');

    while (!$unique){

          $str = '';
          for ($count = 0; $count < $length; $count++){

              $chr = $chrDb[rand(0,count($chrDb)-1)];

              if (rand(0,1) == 0){
                 $chr = strtolower($chr);
              }
              if (3 == $count){
                 $str .= '-';
              }
              $str .= $chr;
          }

          /* check if unique */
          //$existingCode = UNIQUE CHECK GOES HERE  
          if (!$existingCode){
             $unique = TRUE;
          }
    }
    return $str;
} 
```

# android - Android，在tabhost里面如何添加一个按钮和一个listview undernetath？

> ID：10677842
> 
> 赞同：2
> 
> 时间：2012-05-20T22:43:57.577
> 
> 标签：android, listview, button

我想创造这样的东西

|按钮|

第 1 项

第 2 项

第 3 项

. . .列表视图上的项目

我已经有一个带有 3 个选项卡的 tabhost，所以我不想更改我的 main.xml，因为该按钮将出现在每个选项卡上！我希望我的第一个选项卡显示一个日历（这个已经完成，我不确定它是否可以，但它已经完成），第二个选项卡将显示不同的内容，最后一个选项卡是按钮和下面的项目列表。

我没有粘贴任何代码，因为我所做的一切都来自 android 教程，所以我不想让别人给我一个已经写好的代码，只是为了指导我完成我必须阅读的内容以及在哪里寻找实现那！

提前致谢！

好吧，这就是我到目前为止所做的，这是我的主要课程

`公共类 HourPayActivity 扩展 TabActivity { public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); 设置内容视图（R.layout.main）；

```
 Resources res = getResources(); // Resource object to get Drawables
    TabHost tabHost = getTabHost();  // The activity TabHost
    TabHost.TabSpec spec;  // Resusable TabSpec for each tab
    Intent intent;  // Reusable Intent for each tab

    // Create an Intent to launch an //setContentView(R.layout.emptab); Activity for the tab (to be reused)
    intent = new Intent().setClass(this, MonthsActivity.class);

    // Initialize a TabSpec for each tab and add it to the TabHost
    spec = tabHost.newTabSpec("Months").setIndicator("",
                      res.getDrawable(R.drawable.ic_tab_months))
                  .setContent(intent);
    tabHost.addTab(spec);

    // Do the same for the other tabs
    intent = new Intent().setClass(this, EmployersActivity.class);
    spec = tabHost.newTabSpec("Employers").setIndicator("",
                      res.getDrawable(R.drawable.ic_tab_employers))
                  .setContent(intent);
    tabHost.addTab(spec);

    intent = new Intent().setClass(this, PaymentsActivity.class);
    spec = tabHost.newTabSpec("Payments").setIndicator("",
                      res.getDrawable(R.drawable.ic_tab_payments))
                  .setContent(intent);
    tabHost.addTab(spec);

    tabHost.setCurrentTab(0);
} 
```

} `

这是我要显示的标签内容

```
public class EmployersActivity extends Activity {
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ListView employersList = getListView();

    String[] employers = getResources().getStringArray(R.array.employers_list);
    setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item, employers));
    employersList.setAdapter(getListAdapter());       

    employersList.setTextFilterEnabled(true);

    employersList.setOnItemClickListener(new OnItemClickListener() {
        //@Override
        public void onItemClick(AdapterView<?> parent, View view,
            int position, long id) {
          // When clicked, show a toast with the TextView text
          Toast.makeText(getApplicationContext(), ((TextView) view).getText(),
              Toast.LENGTH_LONG).show();
        }
    });

    setContentView(employersList);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T06:40:59.497

你要做的是；您遵循 android 教程，如果我没记错的话，它会告诉您创建一个扩展 TabActivity 的类。

在此活动中，您可以通过以下方式加载意图

```
TabHost.TabSpec spec = tabHost.newTabSpec([title]);
....
Intent content = new Intent(this, activityToLoad.class);
spec.setContent(content);
tabHost.addTab(spec); 
```

它的作用是在选项卡中加载一个活动。这反过来意味着您可以像平常一样使用活动，您可以使用 setContentView(R.layout.yourlayout); 的自定义布局；在 onCreate() 方法中。您可以调用您的组件，将自定义列表适配器附加到您的列表等等。为 3 个选项卡创建 3 个不同的活动。根据个人知识，它是维护标签的最简单方法。

您在这些布局中放置的内容取决于您。但是您放入选项卡中的那些活动是您（可能）熟悉的“正常”活动。

解释你的观点：

```
 <LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:orientation="vertical"
 android:layout_width="match_parent"
 android:layout_height="match_parent">
    <Button 
     android:id="@+id/btnId"
     android:layout_width="match_parent"
     android:layout_height="wrap_content"
     android:text="@string/yourtext"
     />
    <ListView 
    android:id="@android:id/android:list"
    android:layout_height="fill_content" 
    android:layout_width="match_parent"
    />
</LinearLayout> 
```

这将在顶部放置一个按钮，在其下方放置一个列表视图。列表视图的 id 是 android:list 因为在我的活动中我扩展了 listActivity，它需要一个具有该 id 的列表视图。

# python - Twisted：等待所有延迟触发

> ID：10677843
> 
> 赞同：1
> 
> 时间：2012-05-20T22:43:59.827
> 
> 标签：python, twisted, trial

当我从我的测试方法调用 DoSomething() 方法时，我希望它阻止 Connect() 中的产量，但它没有，它返回一个未调用但已延迟。

```
Class Foo:
    @defer.inlineCallbacks
    def Connect(self):
        amqpConfig = AmqpConfig(self.config.getConfigFile())
        self.amqp = AmqpFactory(amqpConfig)

        try:
            # First Deferred
            d = self.amqp.connect()
            # Second Deferred
            d.addCallback(lambda ign: self.amqp.getChannelReadyDeferred()) 

            # Block until connecting and getting an AMQP channel
            yield d
        except Exception, e:
            self.log.error('Cannot connect to AMQP broker: %s', e)

    def DoSomething(self):
        c = self.Connect()
        # None of the deferreds were fired, c.called is False 
```

我怎样才能让它阻塞直到第二个（也是最后一个）延迟被调用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T18:43:57.883

Your call to `self.Connect()` in `DoSomething()` is *supposed* to return a not-yet-fired Deferred; that's how inlineCallbacks works. The code at the beginning of `Connect()` should have been called, but once it hit the first `yield` it just returned its Deferred to your caller. Later on, when the AMQP channel is acquired, that Deferred will fire.

If you want the `DoSomething()` call to... do something :) after the `c` Deferred fires, and you don't want to make `DoSomething()` into another inlineCallbacks method, then just use the Deferred in the normal way: `addCallback()` and friends. Example:

```
def DoSomething(self):
    c = self.Connect()
    c.addCallback(self.handle_getting_amqp_channel)
    c.addErrback(self.this_gets_called_if_something_went_wrong)
    return c 
```

For more information on how Twisted Deferreds work, see [http://twistedmatrix.com/documents/current/core/howto/defer.html](http://twistedmatrix.com/documents/current/core/howto/defer.html) . Hope this helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T07:13:04.497

代码似乎不太清楚（尤其是第 4 行缩进）。但是，如果我做对了**self.Connect()**调用**返回**一个**延迟**本身，所以你必须使用：

c =**产生**self.Connect()

为了防止它在后台运行并将**deferredResult**返回到**c**变量。

# entity-framework - EF Code first 数据库生成

> ID：10677846
> 
> 赞同：1
> 
> 时间：2012-05-20T22:44:23.303
> 
> 标签：entity-framework, poco, code-first

我有一个我一直在玩的 MVC3 网站，并且数据库非常丰富。我需要更改底层模型，但当然，标准方法会删除所有数据。拥有 CREATE SQL（这样我可以确保所有字段/关系都与模型一致）和计算的哈希（因此 EF 认为模型与数据库匹配）将允许我手动更改数据库。

有没有办法询问 DataContext（或其他对象）以： 1\. 获取用于生成数据模式的 SQL *；*和 2\. 获取 ERM 元数据哈希

我考虑过其他一些迁移选项，但只想探索这条途径。

编辑：这是 EF4.1，如果有任何相关性，它正在针对 SQL 2008 R2 运行。

谢谢安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:46:44.330

您可以使用 EF 迁移来做到这一点。您需要将项目升级到 EF 4.3。您将使用“Update-Database -Script”ps 命令。

这是 ASP.Net 团队博客的链接：http: [//blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough。 aspx](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)

Pluralsight 也有关于它的课程。他们也有免费试用。 [http://www.pluralsight-training.net/microsoft/Courses/TableOfContents?courseName=efmigrations](http://www.pluralsight-training.net/microsoft/Courses/TableOfContents?courseName=efmigrations)

# android - Android 理解堆大小

> ID：10677850
> 
> 赞同：30
> 
> 时间：2012-05-20T22:45:22.963
> 
> 标签：android, virtual-machine, heap-memory, dalvik, ddms

我对 Android 开发相当陌生，我似乎无法掌握 Java Out of Memory 异常。我知道这意味着我的应用程序已经超出了虚拟机预算，但是在谷歌搜索了很多次之后，我似乎仍然没有掌握这个概念。我担心我的应用程序使用了太多内存，因为我每个屏幕有六个按钮选择器，每个选择器有两个位图，根据属性选项卡，每个选择器大约 20 kb。在我的根 G2x 上，我将 VM 预算设置为 12mb，重新启动手机并运行我的应用程序，没有任何问题。我在每个 onDestroy() 上取消绑定可绘制对象，并暗示 GC 也在这里运行。在模拟器中使用该应用程序一段时间后，我在 DDMS 屏幕上单击“Cause GC”，结果为 ID=1，堆大小 6.133 MB，已分配 2.895MB，空闲 3.238 MB，使用百分比 47.20，# Objects 52,623。

这是我不明白发生了什么的地方，我的模拟器设置为 24MB 的 VM。那个号码在哪里？我遇到的实际问题是，如果我将模拟器设置为 16MB 的 VM，我的应用程序在第二个活动中崩溃并出现内存不足异常。为什么它不会在我的 VM 设置为 12 MB 的手机上或在我的旧 HTC Magic 手机上与 12 MB 的 VM 库存上崩溃？另外，我的应用程序是否占用了太多内存？我不知道那些 DDMS 数字是否好。

至于我的代码，我在 XML 布局中指定了每个图像。除了向它们添加侦听器之外，我不会以编程方式对它们做任何事情。我在这里找到了这段代码，并将其添加到我拥有的每个活动中......

```
@Override
protected void onDestroy() {
    super.onDestroy();

    unbindDrawables(findViewById(R.id.myRootLayout));
    System.gc();
}

private void unbindDrawables(View view) {
    if (view.getBackground() != null) {
        view.getBackground().setCallback(null);
    }
    if (view instanceof ViewGroup && !(view instanceof AdapterView)) {
        for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++) {
            unbindDrawables(((ViewGroup) view).getChildAt(i));
        }
        ((ViewGroup) view).removeAllViews();
    }
} 
```

否则我所做的就是添加`onClickListeners`到具有 PNG 背景的按钮。我想学习如何以编程方式指定按钮背景，但我需要选择器功能，如焦点、按下、非焦点但按下等，以使按钮背景根据用户交互而变化。我已经查看了有关此的文档，但它似乎势不可挡，这就是为什么我认为我将从管理堆的基础知识开始，然后逐步在代码中指定选择器。这可能没有意义，但是应用程序是否可以分配“健康”的内存分配量而不会接近内存不足异常？例如，如果一个应用程序分配了 6MB 应该没问题，但 8MB 会推送它，内存分配是否有这样的界限？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-05-21T03:22:10.013

当您在模拟器/设备上设置 VM 预算时，您所做的是告诉堆它允许的最大大小。在运行时，随着 Dalvik VM 向操作系统请求系统内存，堆的大小会动态增长。Dalvik VM 通常从分配一个相对较小的堆开始。然后在每次 GC 运行后，它会检查有多少可用的堆内存。如果空闲堆与总堆的比率太小，Dalvik VM 将向堆中添加更多内存（直到配置的最大堆大小）。

话虽如此，您在 DDMS 屏幕上看不到“24 mb”的原因是堆还没有增长到最大大小。这使 Android 能够充分利用手持设备上已经很少可用的内存。

至于为什么您的应用程序在模拟器上而不是您的手机上崩溃，这看起来确实很奇怪（您确定数字是正确的吗？）。但是，您应该记住，内存是动态管理的，并且总内存利用率是根据许多外部因素（执行垃圾收集的速度/频率等）确定的。

最后，由于我上面提到的原因，很难根据您上面提供的单行信息确定您的应用程序管理内存的能力。我们真的需要看看你的一些代码。`OutOfMemoryError`但是，s 绝对值得担心，所以我肯定会查看您的应用程序的内存使用情况。您可能会考虑的一件事是在运行时通过调用`inSampleSize`使用`BitmapFactory`该类对位图图像进行采样。这有助于减少加载可绘制位图所需的内存量。要么，要么您可以降低可绘制对象的分辨率（尽管每个 20 kb 对我来说听起来不错）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-01-22T15:25:55.163

即使您的应用程序没有达到“24mb”（因设备而异）堆限制，您仍然可能会发生崩溃，因为 Android 需要一段时间来为您的应用程序增加堆空间。

在我的情况下，我在很短的时间内创建并转储了几张图像。

我经常得到`OutOfMemoryError`.

看来 Android 的速度不足以为我的应用增加堆空间。

我相信我通过使用`largeHeap`清单文件中的设置解决了这个问题。启用该设置后，Android 每次增加堆时都会留下更多可用内存，从而最大限度地减少达到当前限制的机会。

我不使用 24mb 的限制，但这个`largeHeap`conf 非常方便。

您只需要`largeHeap="true"`在您的应用程序标签上设置`AndroidManifest.xml`

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:largeHeap="true"
    android:theme="@style/AppTheme" > 
```

不过，请确保在处理图像时要小心，就像@Alex Lockwood 建议的那样。

# django - django - ManyToManyField - 在一个模型中交叉字段

> ID：10677860
> 
> 赞同：2
> 
> 时间：2012-05-20T22:46:54.203
> 
> 标签：django, many-to-many

我正在尝试创建一个表示图形节点的模型。

```
class Node(models.model):
    ins = models.ManyToManyField("self", null=True, blank=True)
    outs = models.ManyToManyField("self", null=True, blank=True) 
```

现在假设我们有节点 a 和 b。如果我在 for b django 中添加 a （因为'对称'属性打开）将添加 b 作为 for a。

我不知道如何按照我设置 a -> b 的方式进行操作，它会自动设置 b <- a。

我想为关系建立一些中产阶级，但真的不知道它会如何运作。字面上怎么写。

我会看到它是这样的：

```
class Node(models.Model):
    ins = models.ManyToManyField("self", null=True, blank=True, through="Edge")
    outs = models.ManyToManyField("self", null=True, blank=True, through="Edge")

class Edge(models.Model):
    node1_ins = models.ForeignKey(Node)
    node2_outs = models.ForeignKey(Node) 
```

但当然，这个根本行不通。

知道如何解决这个问题吗？

在此先感谢，格雷格

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T00:05:44.277

您可能想尝试这样的事情：

```
from django.db import models

class Node(models.Model):
    outs = models.ManyToManyField("self", null=True, blank=True, 
        symmetrical=False, related_name="ins", through='Edge')

class Edge(models.Model):
    from_node = models.ForeignKey(Node, related_name='edges_down')
    to_node = models.ForeignKey(Node, related_name='edges_up') 
```

我发现管理多个 m2m 字段需要多个“直通”表，这变得很混乱。

```
n1 = Node.objects.create()
n2 = Node.objects.create()
edge = Edge.objects.create(from_node=n1, to_node=n2)

print n1.outs.all()
#[<Node: Node object>]
print n1.ins.all()
# []

print n2.outs.all()
# []
print n2.ins.all()
# [<Node: Node object>] 
```

使用此模式，您将设置从到到的关系。the`outs`将是明确的，并且 the`ins`将是一个关系。也许这会起作用？

Node 对象上的`edges_up`和`edges_down`关系还可以让您找到关系边缘。

```
n1.edges_down.all()
# [<Edge: Edge object>]

n2.edges_up.all()
# [<Edge: Edge object>] 
```

这里的名字可能不清楚。我有点喜欢“上游”和“下游”的概念

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:52:23.170

您可以将对称设置为 True。

[https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ManyToManyField.symmetrical](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ManyToManyField.symmetrical)

# python - 是否可以在降价中替换标记？

> ID：10677865
> 
> 赞同：2
> 
> 时间：2012-05-20T22:47:36.643
> 
> 标签：python, regex, coffeescript, markdown

我在 Python 中使用正则表达式从 CoffeeScript 文件中提取使用 Markdown 格式的注释。CS 使用### 作为多行注释的开始和结束标记。这与 markdown 格式冲突，因为 # 用于表示标头类。是否有可能让 Markdown 将 % 或 ^ 或其他字符解释为标题类标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T01:59:36.493

可以通过利用`markdown.extensions.Extension`类来覆盖 Python Markdown 的许多元素。经过一番挖掘和试验后，我通过编写一个扩展通用 BlockParser 的自定义标头解析器来实现这一点。

本质上它看起来像这样

```
class CustomHeaderParser( BlockParser )
    def run( params )
        # implementation

class CustomExtension( Extension )
    def extendMarkdown( self, md, md_globals )
        md.parser.blockprocessor.add( 'custom_header_parser', CustomHeaderParser(md.parser), '<hashheader' )
        md.registerExtension( self )

markdown_parser = markdown.Markdown( extensions=[ CaretHeaderExtension() ] )
markdown_parser.convert( markdown_text ) 
```

大约在研究到一半的时候，我还发现了另一种不太理想的解决方法。Markdown 可以理解 Settext 和 atx 两种类型的 header 样式。Setext 在文本下方的行中使用 ==== 和 ----- 来提供两个标题级别 h1 和 h2。

# user-interface - 包和接口的 Mathematica GUI 菜单

> ID：10677867
> 
> 赞同：1
> 
> 时间：2012-05-20T22:47:37.420
> 
> 标签：user-interface, interface, wolfram-mathematica

我有一些用 Wolfram Mathematica 编写的包和接口 (.nb)。我想把它们放在一个应用程序中，就像一些“菜单”会调用它们一样。在菜单等方面有帮助会很棒。我怎样才能组织这样的用户界面？？？

也许你们中的一些人有这样的经验，或者学到了一些例子！

非常感谢期待！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T12:55:13.353

您可以通过将如下代码添加到 Program Files\Wolfram Research\Mathematica\8.0\SystemFiles\FrontEnd\TextResources\Windows 中的 MenuSetup.tr 文件来添加菜单命令

不过先备份！

```
...
  MenuItem["&About Mathematica...", "AboutBoxDialog"]
  }],
  Menu["&Additions", 
  {
    Item["Package &One", KernelExecute[Get["MyPackages`PackageOne`"]], MenuEvaluator->Automatic],
    Delimiter,
    Item["Function &Two", KernelExecute[MyPackages`FunctionTwo[]], MenuEvaluator->Automatic]
  }]
}] 
```

在上面的示例中，您可以调用整个包文件 PackageOne.m 或仅调用一个函数。但是，要调用单个函数，您需要事先加载包，可能来自 init 文件。

您还可以使用[此处](https://mathematica.stackexchange.com/questions/5417/running-a-package-automatically-when-its-saved/5418#5418)`AddMenuCommands[]`所示的在每个会话的基础上修改菜单。

# solr - 是否可以在 solr 中提升 mlt 查询？

> ID：10677872
> 
> 赞同：3
> 
> 时间：2012-05-20T22:48:07.577
> 
> 标签：solr

具体来说，如果我正在使用 solr mlt 处理程序 ( [http://wiki.apache.org/solr/MoreLikeThisHandler](http://wiki.apache.org/solr/MoreLikeThisHandler) ) 和 stream.body 进行查询以提供源文档，有没有办法根据文档年龄来提升结果文档？

我已经知道如何使用 dismax ( [http://wiki.apache.org/solr/FunctionQuery#Date_Boosting](http://wiki.apache.org/solr/FunctionQuery#Date_Boosting) ) 为常规查询执行此操作，但我无法完全弄清楚为 mlt 处理程序执行此操作的魔法咒语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T18:32:04.713

看起来 mlt 处理程序是为处理以下两种情况之一而编写的：

1.  `q=[typical query goodness which can include date boosting]`
2.  `stream.body=[url]`

如果`q`存在，`stream.body`则被忽略，反之亦然，所以不幸的是，我认为您无法在不修补 MoreLikeThisHandler 的情况下在一次调用中执行您想要的操作。

* * *

但是：如果您急需这个，您可以通过两个查询来完成

1.  运行相同的 MLT 查询仅用于检索有趣的术语和提升（例如使用`mlt.interestingTerms=details&mlt.boost=true&rows=0`）
2.  使用 (1) 中的有趣术语和提升，使用您想要的日期提升功能运行标准 Solr 查询（非 MLT）。

# android - 如何让 Android 询问用户是否愿意将我的应用用作启动器？

> ID：10677875
> 
> 赞同：1
> 
> 时间：2012-05-20T22:48:35.857
> 
> 标签：android, launcher

我正在添加

```
<category android:name="android.intent.category.HOME" /> 
```

到清单中我的活动定义，但现在主页按钮默认弹出打开我的应用程序。我希望它询问用户他们是否想使用我的启动器或库存启动器。我需要在清单中添加什么以确保他们获得该选择？

这是其他人这样做的一个例子...... [http://blog.mycolorscreen.com/post/9328914812/customizing-your-android-without-rooting](http://blog.mycolorscreen.com/post/9328914812/customizing-your-android-without-rooting)

当有人点击主页按钮时，他们会提供主页切换器。我没有找到任何关于这意味着什么的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T22:59:19.930

这通常会自动发生。安装您的应用程序后，下次用户按 HOME 时，他们将获得一个选择器，询问用户是想要您的应用程序还是已经安装了另一个主屏幕。他们将继续获得此选择器，直到他们单击“将其设为默认”复选框并做出最终选择，之后他们将在未来的 HOME 印刷机上获得他们选择的活动。

我的猜测是，在某个地方，您选中了选择器上的复选框。您可以通过设置应用程序将其从默认设置中清除，或者直接卸载并重新安装。

# java - Java Graphics：从 Font 构造 FontMetrics，没有 Graphics2D

> ID：10677876
> 
> 赞同：2
> 
> 时间：2012-05-20T22:48:36.453
> 
> 标签：java, swing, fonts, awt, fontmetrics

## 已知

给定[`FontMetrics`](http://docs.oracle.com/javase/7/docs/api/java/awt/FontMetrics.html)

`FontMetrics`from有一个受保护的构造函数`Font`。

## 问题：

给定一个`Font`对象，有没有办法在`FontMetrics`不经过`Graphics2D.setFont`,的情况下构造一个对象`Graphics2D.getFontMetric()`？

## 语境

我正在使用类似 TeX 的渲染算法。我需要为 *.pfb 文件中的各种字符计算边界框等。我可以从 *.pfb 文件构造一个 Font 对象。我需要一个`FontMetrics`对象来获得上升、下降、宽度。对我来说，必须构造一个未使用的中间 Graphics 对象才能获得`FontMetrics`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T22:54:29.913

> 给定一个`Font`对象，有没有办法在`FontMetrics`不经过`Graphics2D.setFont`,的情况下构造一个对象`Graphics2D.getFontMetric()`？

查看[`BufferedImage.createGraphics()`](http://docs.oracle.com/javase/7/docs/api/java/awt/image/BufferedImage.html#createGraphics%28%29)或[`getGraphics()`](http://docs.oracle.com/javase/7/docs/api/java/awt/image/BufferedImage.html#getGraphics%28%29)获取获取`Graphics`实例的替代方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-08T09:59:17.720

或者完全不使用图形对象：

```
Font font = new Font("Helvetica",Font.PLAIN,12);
Canvas c = new Canvas();
FontMetrics fm = c.getFontMetrics(font); 
```

如果您现在调用`c.getGraphics()`它将返回 null。这（画布）也将在[无头模式下](http://www.oracle.com/technetwork/articles/javase/headless-136834.html)工作。

# debugging - 如何使用 heroku foreman 调试 node.js 应用程序？

> ID：10677879
> 
> 赞同：2
> 
> 时间：2012-05-20T22:48:58.180
> 
> 标签：debugging, node.js, heroku

我是 heroku 和 node.js 的新手。我有一个小型 node.js 应用程序，我可以使用 heroku 工具带中的 FOREMAN 在本地计算机上成功启动和运行它。不过，我不明白如何最好地调试应用程序。

我看到有一个用于 node.js 的 Eclipse 调试器以及 node-inspector 项目。但我似乎无法与 FORMAN 一起完成这些工作。

```
foreman start 
```

如果无法调试由工头启动的应用程序，那么工头的目的是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-03-16T07:52:52.740

只是一个补充，你的 Procfile 可能看起来像这样：

```
web: node web.js
webDebug: node --debug-brk=5858 web.js` 
```

因此，要开始调试您只需调用`foreman start webDebug`，您可以根据需要调用配置。

调试器将侦听端口 5858，您必须从[http://localhost:5100](http://localhost:5100)而不是[http://localhost:5000](http://localhost:5000)调用您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T01:46:51.310

Foreman 的目的是让您轻松运行可能由多个进程组成的复杂应用程序。查看[作者关于 Foreman 的博客文章](http://blog.daviddollar.org/2011/05/06/introducing-foreman.html)：

> 最近我注意到我的网络应用程序运行起来变得越来越复杂。我的应用程序不再包含单个 Web 进程；我通常有一种或多种类型的后台工作人员来运行不同类型的作业和一个时钟进程来处理调度。以这种方式拆分应用程序对于性能和可扩展性非常有用。然而，缺点是让应用程序及其所有部分运行变得更加复杂。
> 
> 工头试图使这更容易。使用工头，您可以使用 Procfile 声明运行应用程序所需的各种进程。

通过利用 Foreman，Heroku 实现了这一点，您基本上可以运行任何类型的进程——Rails 应用程序、Sinatra 应用程序、Node.js 应用程序或任何其他应用程序——只需指定如何启动它your `Procfile`，Foreman 读取并执行。

Foreman 还允许您使用 Upstart 和 Init 等工具将这个简单的 Procfile 导出到生产环境。它不提供任何调试功能（也不打算提供）。

# apache - 如何使静态站点看起来动态 - Apache中的.htaccess

> ID：10677880
> 
> 赞同：0
> 
> 时间：2012-05-20T22:49:05.703
> 
> 标签：apache, .htaccess, web

我有一个在 Apache 中运行的静态站点，我希望服务器将每个文件视为一个目录。我在 .htaccess 中设置了这个东西，它将摆脱所有 .html 扩展名。所以这就是我想要的：

前任。

[http://example.com/about](http://example.com/about)（目前）

至

[http://example.com/about/](http://example.com/about/)

无需将其更改为目录或使其动态化。有 .htaccess**黑客**吗？可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:51:58.167

您应该查看 mod_rewrite ，它可以让您使用正则表达式重写任何 url。

# java - 按钮单击时的 AsyncTask = 任务已取消或仍在运行？

> ID：10677889
> 
> 赞同：0
> 
> 时间：2012-05-20T22:50:37.510
> 
> 标签：java, android, android-asynctask

如果我有一个启动 AsyncTask 的按钮操作。如果我点击按钮 10 次怎么办？任务是否执行 10 次并在后台运行那么多？或者是否有任何先前的任务被取消并且只是重新启动了任务（这将是我想要的行为）？

```
public void myButtonClick(View v) {
   new MyAsyncTask().execute(params);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T22:59:12.080

每次单击按钮都会生成一个新的 your 实例`MyAsyncTask`，这意味着每个任务都会被创建并执行直到结束。

如果要停止以前启动的任务，则必须存储对上次启动任务的引用并取消它，如下所示：

```
public void myButtonClick(View v) {
    if (this.lastMyAsyncTask != null && this.lastMyAsyncTask.getStatus() != AsyncTask.Status.FINISHED){
        this.lastMyAsyncTask.cancel();
    }
    this.lastMyAsyncTask = new MyAsyncTask();
    this.lastMyAsyncTask.execute(params);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T00:44:14.323

如果你真的想让任务一次只执行一次，你应该创建一个单线程线程池：

```
 private ThreadPoolExecutor executor = 
        new ThreadPoolExecutor(1,1, 1, TimeUnit.SECONDS, 
             new SynchronousQueue(), new ThreadPoolExecutor.AbortPolicy());
    private Future<Void> lastSubmitted;
    private ReentrantLock submissionLock = new ReentrantLock();
    ...

    try {
      submissionLock.lock();
      Future<Void> future = 
        executor.submit(new MyAsyncTask()); // assuming this implements Callable<Void>
      lastSubmitted = future;
    }
    catch (RejectedExecutionException e) {
      lastSubmitted.cancel();
      Future<Void> future = 
        executor.submit(new MyAsyncTask()); // assuming this implements Callable<Void>
      lastSubmitted = future;

    }
    finally {
      submissionLock.unlock();
    } 
```

如果您按照上面的建议执行此操作，如果您尝试在已运行的任务中提交任务，则会收到 RejectedExecutionException。发生这种情况时，您可以取消最后一个提交，并安排新的执行。请记住，您的任务必须是可中断的（请注意 InputStream/OutputStream，因为它们不可中断，请改用 Channel 对象）。

需要锁定，以便您序列化提交尝试。如果另一个线程在 catch 块执行期间提交了一个任务，一个线程仍然可能得到 RejectedExecutionException。

# android - 解析 JSON 文件的“类型”

> ID：10677890
> 
> 赞同：1
> 
> 时间：2012-05-20T22:50:44.767
> 
> 标签：android, json

在我需要解析地点的类型之前一切顺利，文件的组织方式如下：

```
 "geometry" : {
        "location" : {
           "lat" : 45.7849210,
           "lng" : 11.8724490
        },
        "viewport" : {
           "northeast" : {
              "lat" : 45.81619110,
              "lng" : 11.89575470
           },
           "southwest" : {
              "lat" : 45.75432980,
              "lng" : 11.84532520
           }
        }
     },
     "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/geocode-71.png",
     "id" : "a454072e2ba71d4e2331e39099261f086cd11d1e",
     "name" : "Fonte",
     "reference" : "CnRtAAAAUaGSsbXRv05lApqXueEKjOAjtkpEDz07ioe3vPS9HqpOIJSTTQWYObc6o6GfEq-pzVUtKT03oRWNx6ld-rUfdat47e8W3NbSsLY1NldO9iQEUjQOM9kIIOix8xLAvqh5YHUNTAela4Mo8HGSJPPBhhIQ9j4Uy_WrQtFO7qxirA0UHRoUsmY0ngstG5BBiHQNLkLgxTpsDEY",
     "types" : [ "locality", "political" ],
     "vicinity" : "Fonte"
  }, 
```

由于可能会注意到 types 是一个字符串数组，因此我尝试了这种方法：

```
 JSONArray results = o.getJSONArray("results");
  JSONObject tempObject = results.getJSONObject(0);
  JSONArray typee = tempObject.getJSONArray("types");
  String a = typee.getJSONObject(0).toString(); 
```

但它不起作用。任何帮助将不胜感激。整个 JSON 可以在这里看到：[https ://maps.googleapis.com/maps/api/place/search/json?location=45.7909,11.8700&radius=500&key= AIzaSyC9Ob9_u-2mxCHeItDHytDLmZP-P1QCejw&sensor=true](https://maps.googleapis.com/maps/api/place/search/json?location=45.7909,11.8700&radius=500&key=AIzaSyC9Ob9_u-2mxCHeItDHytDLmZP-P1QCejw&sensor=true)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T22:59:59.923

```
JSONArray typee = tempObject.getJSONArray("types");
String a = typee.getString(0);
String b = typee.getString(1); 
```

以上将返回`locality`变量`a`和`political`变量`b`。用于`typee.length()`找出其中有多少元素，`JSONArray`如果`types`可能有可变数量的元素。

# c# - 如何为 ASP.NET AJAX Timer 控件设置随机间隔？

> ID：10677897
> 
> 赞同：1
> 
> 时间：2012-05-20T22:51:41.723
> 
> 标签：c#, asp.net

我想仅使用 aspx 将 Timer Interval 设置为 5000-10000 ms（没有后面的 C# 代码）。

以下示例引发错误消息：

```
Cannot create an object of type 'System.Int32' from its string representation '<%= Random.Next(5000,10000) %>' for the 'Interval' property. 
```

**如何更正间隔变量以获得随机间隔调用？**

```
<asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
<asp:Timer ID="Timer1" runat="server" Interval="<%= Random.Next(5000,10000) %>">
</asp:Timer>
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="Timer1" EventName="Tick" />
    </Triggers>
    <ContentTemplate>
        <%= DateTime.Now.ToString() %>
    </ContentTemplate>
</asp:UpdatePanel> 
```

我尝试了 Convert.ToInt32，但它不起作用。

甚至可能吗？

为了获得一些灵感，我设法用这种方式背后的一些 C# 代码解决了这个问题：

aspx：

```
<asp:Timer ID="Timer1" runat="server" Interval="5000" OnTick="Timer1_Tick"> 
```

C＃ ：

```
protected void Timer1_Tick(object sender, EventArgs e)
{
    Random random = new Random();
    Timer1.Interval = random.Next(5000, 10000);
} 
```

但同样，我想摆脱 C# 代码。

我希望它有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:36:23.153

该`<%= %>`标签将始终返回一个字符串，因为它等同于`Response.Write(" ")`.

您的替代方案是代码隐藏（提供一个很好的解释为什么您不想使用代码隐藏可能会引起潜在受访者的更多兴趣）。或者，改用`<%# %>`标签。虽然，这将要求控件是数据绑定的，这可能是一个比仅使用代码隐藏更不优雅的解决方案。

# git - 使用和设置 Git

> ID：10677901
> 
> 赞同：-2
> 
> 时间：2012-05-20T22:52:21.553
> 
> 标签：git, github, push

> **可能重复：**
> [无法将 master 推送到 Github](https://stackoverflow.com/questions/922210/unable-to-git-push-master-to-github)

我有另一个用户设置的 Github 帐户，该用户已经签入代码并创建了一个 repo。我刚刚下载、安装并添加了 SSH 密钥到 Git/Github。现在我需要做什么才能将我的代码提交给主人？

我从未使用过 Git，在线教程让我感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:12:09.763

首先，在存储库的根目录中执行以下操作： `git remote add origin <url of your repo>`

然后： `git push origin master`

如果您对命令行不满意，那么有许多 git GUI 可供选择以使其更容易： http: [//git-scm.com/downloads/guis](http://git-scm.com/downloads/guis)

# ios - 如何设计一个可滚动的菜单？

> ID：10677904
> 
> 赞同：0
> 
> 时间：2012-05-20T22:52:46.493
> 
> 标签：ios, cocos2d-iphone

我有一个带有 cocos2d-iphone 的 CCMenu。它垂直列出了许多项目。

我希望用户能够滑动手指进行滚动。

到目前为止，我所做的是检查用户何时触摸并移动它。这样我就可以计算出正确移动菜单所需的相对移动。它有效。

但是，如果触摸从*a*开始`CCMenuItemImage`，我的图层将不会收到`ccTouchesBegan`消息`ccTouchesMoved`，因此我无法执行此类计算。

我该怎么办？

# html - 转义 HTML 字符串

> ID：10677908
> 
> 赞同：13
> 
> 时间：2012-05-20T22:53:37.790
> 
> 标签：html, escaping

我继承了以下字符串（我对格式无能为力）：

```
 &lt;iframe \n  class=\"some_class\"\n  type=\"text/html\" \n  src=\"/embed/iframe_content.html?id=tsqA5D7_z10\" \n  width=\"960\" \n  height=\"593\" \n  marginwidth=\"0\" \n  marginheight=\"0\" \n  frameborder=\"0\"&gt;\n&lt;/iframe&gt; 
```

我在这样的 erb 模板中渲染它：

```
<%= the_string %> 
```

目前它呈现为如下文本：

```
&lt;iframe  class="some_class" type="text/html" src="/embed/iframe_content.html?id=tsqA5D7_z10" width="960" height="593"  marginwidth="0" marginheight="0" frameborder="0"&gt;&lt;/iframe&gt; 
```

我需要将它呈现为 HTML。

我尝试了以下方法：

1.  `<%= the_string.html_safe %>` # 渲染字符串不变
2.  `<%= CGI.unescapeHTML(the_string) %>`# 带有类型错误'can't dup NilClass'的错误
3.  `<%= CGI.unescapeHTML(the_string).html_safe %>`# 带有类型错误'can't dup NilClass'的错误
4.  `<%= raw the_string %>`# 渲染字符串不变

如何将此字符串呈现为 HTML？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-21T00:09:45.133

正如您似乎已经注意到的那样，您需要注意两件事：

1.  取消转义 HTML 实体
2.  在您的视图中打印原始 html

对于 2 号`<%= raw ... %>`应该可以正常工作。

数字 1`CGI.unescapeHTML`是正确的想法，但我认为它不能识别所有 HTML 实体，所以我建议查看[HTML Entites gem](http://htmlentities.rubyforge.org/)

您也可以尝试使用[simple_format](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format)辅助方法，但我认为您必须向它传递一些选项以允许`<iframe>`标记

我也强烈建议将您的`unescaping`逻辑转移到辅助方法中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-21T17:35:32.000

您正在转义的内容不能是字符串，这就是您收到带有类型错误的错误的原因`can't dup NilClass`

尝试做
`s = String.new your_obj.to_s`

现在做

`CGI.unescapeHTML(s)`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-21T01:34:51.300

最后我不得不使用 Matthew 建议的[HTMLEntities](http://htmlentities.rubyforge.org/) Gem；

1.  使用 RVM 安装 gem 并将其添加到我的 Gemfile

2.  在我的 application.rb 中需要它

3.  以下是我可以让它正确渲染的唯一方法。请注意围绕 the_string 的额外单引号。没有它们，尖括号不会呈现，尽管其他一切都会呈现。

    > ```
    > coder = HTMLEntities.new
    > raw coder.decode("'"+the_string+"'") 
    > ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-20T23:01:19.517

你可以试试这个：

```
<%= raw the_string %> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-20T23:30:16.447

第 3 版听起来很有价值。您不使用 the_string 的任何原因？

`<%= raw CGI.unescapeHTML(the_string) %>`

# symfony-1.4 - 具有复杂 AND/OR 凭据的 sfGuardPlugin

> ID：10677909
> 
> 赞同：0
> 
> 时间：2012-05-20T22:54:22.893
> 
> 标签：symfony-1.4, credentials, sfguard

我在 security.yml 中保护一个动作。如果用户具有凭据（A 和 B）或（A 和 C），我希望用户能够访问。查看相当[稀疏的文档](http://www.symfony-project.org/reference/1_4/en/08-Security#chapter_08_authorization)，我尝试了这些组合：

```
myaction:
  credentials: [[A, B], [A, C]]
  credentials: [[[A, B], [A, C]]]
  credentials: [A, [B, C]] 
```

它们都不起作用；`[A, B]`有效，但这只是成功的一半。有没有人有这样的工作？

我正在使用 Propel 1.4.2 和 sfActionCredentialsGetterPlugin。感谢您的输入。

**编辑：**

我在没有使用 sfActionCredentialsGetterPlugin 的情况下进行了测试，只是在模板中直接使用 php：

```
<?php $sf_user->addCredentials('A', 'C'); ?>
<?php var_dump($sf_user->getCredentials()->getRawValue()) ?><br><br><br>
<?php $cred_a = 'A'; ?>
<?php $cred_b = 'B'; ?>
<?php $cred_c = 'C'; ?>
<?php $cred_3 = array('B', 'C'); ?>
<?php $has_cred1 = $sf_user->hasCredential(array($cred_a, $cred_3)) ? 'true' : 'false' ?>
<?php $has_cred2 = $sf_user->hasCredential($cred_a, $cred_b) ? 'true' : 'false' ?>
<?php echo 'has cred1? '.$has_cred1 ?><br><br>
<?php echo 'has cred2? '.$has_cred2 ?><br><br> 
```

我哪儿也去不了。

这里有更多信息：[http ://www.symfony-project.org/gentle-introduction/1_4/en/06-Inside-the-Controller-Layer#chapter_06_sub_complex_credentials](http://www.symfony-project.org/gentle-introduction/1_4/en/06-Inside-the-Controller-Layer#chapter_06_sub_complex_credentials)

据此，我上面的第三次尝试`[A, [B, C]]`应该有效！

任何人？

**编辑2：**

我尝试了从文档中复制的简单 OR 组合：

```
// security.yml:
credentials: [[A, B]]
// template:
$sf_user->hasCredential(array('A', 'B'), false) 
```

再次，没有骰子。我发布了一个错误报告：http: [//trac.symfony-project.org/ticket/10036](http://trac.symfony-project.org/ticket/10036)

我将在此处发布我的临时解决方法作为答案。多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T14:24:47.723

恐怕您的代码示例有点过于独立了。您还可以提供如何设置和检查凭据的示例吗？问题可能出在那儿，而不是定义本身。（还有什么是您的安全过滤器`filters.yml`，以及“它们不起作用”到底是什么意思）

在第一个片段中，选项 2 和 3 将给出您期望的结果。因此，任何试图执行的用户`myaction`只有在他被 Authenticated 并且拥有凭据时才被允许这样做`A and (B or C)`。否则，他将被发送到默认登录或安全操作。

在测试代​​码中有一个错误导致错误的结果：

```
<?php $has_cred2 = $sf_user->hasCredential($cred_a, $cred_b) ? 'true' : 'false' ?> 
```

`hasCredential()`接受一个凭证或凭证数组作为第一个参数，一个布尔值作为第二个参数。您传递了两个字符串凭据。

每次你给出你所做的测试的例子时，都会给出你得到的结果是什么以及你期望的结果应该是什么的信息。这将有助于识别问题。

在第三个示例中，您编写了一个调用，`hasCredentials()`但我们不知道您为用户设置了哪些凭据，因此我们不知道在那里检查什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T12:44:01.120

[A,[B,C]] 变为 (A AND (B OR C))

所以如果你需要 ((A AND B) OR (A AND C))

即等于 [A,[B,c]]

**我需要 (A AND (B OR C OR D))**

**我做了 [A,[B,C,D]]**

**这对我有用。**

记住！！

每次添加新级别的方括号时，逻辑在 AND 和 OR 之间交换。因此，您可以创建非常复杂的凭证组合，例如：

**凭据：[[root，[供应商，[所有者，准所有者]]，帐户]]**

```
 # root OR (supplier AND (owner OR quasiowner)) OR accounts 
```

另外不要忘记刷新您的凭据并检查您是否被分配到 A 和 B 或 A 和 C

您可以在此处查看详细信息。 [http://symfony.com/legacy/doc/gentle-introduction/1_4/en/06-Inside-the-Controller-Layer#chapter_06_sub_complex_credentials](http://symfony.com/legacy/doc/gentle-introduction/1_4/en/06-Inside-the-Controller-Layer#chapter_06_sub_complex_credentials)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T20:28:48.657

我需要继续做其他事情，所以我在这里发布了解决这个问题的方法。

lib/Tools.class.php：

```
// check if the user has any of the given credentials
// (need this because sf OR credential combo doesn't work)
// superadmins always pass this check
// param credentials:   (string) single credential, or
//                      (array) flat array of string credentials
public static function hasAnyCredential($user, $credentials)
{
    if ( !is_array($credentials) )
    {
        return $user->hasCredential($credentials);
    }
    else
    {
        $test = false;
        foreach ($credentials as $credential)
        {
            $test = false;
            if ( $user->hasCredential($credential) ) $test = true;
            if ( $test ) break;
        }
    }
    return $test;
} 
```

应用程序/mymodule/actions/actions.class.php：

```
// check if user has permissions B or C
// security.yml only has credentials: [A]
protected function hasBcPermission(myUser $user)
{
    return Tools::hasAnyCredential($user, array('B', 'C'));
} 
```

此功能用于检查操作权限并在模板中隐藏不可访问的菜单。希望它可以帮助有同样问题的人。

我仍然很高兴收到任何人的**真实**答案！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T23:03:15.117

您是否遵循此处的**复杂凭证**教程：[http](http://www.symfony-project.org/jobeet/1_4/Propel/en/13) ://www.symfony-project.org/jobeet/1_4/Propel/en/13 ？

# c# - 无法使用 json.net 反序列化 json

> ID：10677913
> 
> 赞同：4
> 
> 时间：2012-05-20T22:54:49.867
> 
> 标签：c#, json, windows-phone-7, json.net

这是我第一次使用 json.net，我想不通。下面是我的代码。

```
// Constructor
    public MainPage()
    {
        InitializeComponent();
    }

    private void btnRefreshTweets_Click(object sender, RoutedEventArgs e)
    {
        string ServerURL = @"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StateCityHighway_USA/MapServer/1/query?text=e&geometry=&geometryType=esriGeometryPoint&inSR=&spatialRel=esriSpatialRelIntersects&relationParam=&objectIds=&where=&time=&returnCountOnly=false&returnIdsOnly=false&returnGeometry=false&maxAllowableOffset=&outSR=&outFields=&f=json";

        WebClient webClient = new WebClient();
        webClient.DownloadStringCompleted += new DownloadStringCompletedEventHandler(webClient_DownloadStringCompleted);
        webClient.DownloadStringAsync(new Uri(ServerURL));
    }

    void webClient_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        if (e.Error != null)
        {
            return;
        }
        List<Attributes> tweets = JsonConvert.DeserializeObject<List<Attributes>>(e.Result);
        this.lbTweets.ItemsSource = tweets;
    }

    public class Attributes
    {
        public string STATE_NAME { get; set; }
    } 
```

我无法反序列化 STATE_NAME 属性。我错过了什么？

我不断收到此错误

> “无法将 JSON 对象反序列化为类型 'System.Collections.Generic.List`1[WPJsonSample.MainPage+Attributes]'。第 1 行，位置 20。”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-20T23:33:05.680

这是您的类结构（我使用了[http://json2csharp.com/](http://json2csharp.com/)）

```
public class FieldAliases
{
    public string STATE_NAME { get; set; }
}

public class Field
{
    public string name { get; set; }
    public string type { get; set; }
    public string alias { get; set; }
    public int length { get; set; }
}

public class Attributes
{
    public string STATE_NAME { get; set; }
}

public class Feature
{
    public Attributes attributes { get; set; }
}

public class RootObject
{
    public string displayFieldName { get; set; }
    public FieldAliases fieldAliases { get; set; }
    public List<Field> fields { get; set; }
    public List<Feature> features { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T00:17:07.783

如果您尝试访问该端点，则不应手动提交查询，而应使用[ArcGIS WP7 SDK](http://resources.arcgis.com/content/login?destination=content/arcgis-api-windows-phone-24-download)（它是免费的！）。然后使用查询任务。

（如果您只需要解析 JSON 的帮助，请参见下文）

```
 QueryTask queryTask = new QueryTask("http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_StateCityHighway_USA/MapServer/1/");
    queryTask.ExecuteCompleted += QueryTask_ExecuteCompleted;
    queryTask.Failed += QueryTask_Failed;

    ESRI.ArcGIS.Client.Tasks.Query query = new ESRI.ArcGIS.Client.Tasks.Query();
    query.Text = "e";
    query.ReturnGeometry = false;

    queryTask.ExecuteAsync(query);

private void QueryTask_ExecuteCompleted(object sender, ESRI.ArcGIS.Client.Tasks.QueryEventArgs args)
{
    FeatureSet featureSet = args.FeatureSet
    // use the featureSet to do something. It contains everything you need
} 
```

如果出于某种原因不想使用 QueryTask，仍然可以使用 FeatureSet 的 FromJson 方法

```
void webClient_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
{
    var featureSet = ESRI.ArcGIS.Client.Tasks.FeatureSet.FromJson(e.Result);
    // Use it
} 
```

如果您需要有关 JSON 的帮助，这里有一些关键概念。

1) 花括号代表一个对象

2) 方括号代表一个数组。

3) 属性用逗号分隔

使用 JSON.NET 时，应将 JsonProperty 特性添加到属性。这样，即使 json 很烂，您也可以保持正确的名称

```
[JsonProperty("STATE_NAME")]
public string StateName { get; set; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-20T23:21:50.420

从该 url 返回的 JSON 是：

```
{
  "displayFieldName": "STATE_NAME",
  "fieldAliases": {
    "STATE_NAME": "STATE_NAME"
  },
  "fields": [
    {
      "name": "STATE_NAME",
      "type": "esriFieldTypeString",
      "alias": "STATE_NAME",
      "length": 25
    }
  ],
  "features": [
    {
      "attributes": {
        "STATE_NAME": "Maine"
      }
  }
} 
```

所以，我们可以在这里看到根是一个对象，而不是像`List<>`

您必须修复类结构以匹配 JSON，或使用 Linq 查询访问它（在 json.net 网站中有一些示例）。

# perl - 无法安装 Carp-1.25

> ID：10677915
> 
> 赞同：1
> 
> 时间：2012-05-20T22:55:45.810
> 
> 标签：perl, debugging, strawberry-perl, padre, carp

我已经为 Windows 安装了 Strawberry Perl，“DWIM Perl”来自：[http](http://dwimperl.com/) ://dwimperl.com/ 。我想用鲤鱼。所以我从 CPAN 下载了 Carp-1.25，对其进行了解压缩，然后运行了 nmake。

我得到：

```
Microsoft (R) Program Maintenance Utility Version 10.00.30319.01
Copyright (C) Microsoft Corporation.  All rights reserved.

to undefined at F:/Dwimperl/perl/lib/ExtUtils/Install.pm line 1208
NMAKE : fatal error U1077: 'F:\Dwimperl\perl\bin\perl.exe' : return code '0x2'
Stop. 
```

请注意，这不是 Windows nmake 问题，在 cygwin 中运行 make 时出现类似错误。

我的系统：MS Windows 7。

（顺便说一句，我一直在运行 ActiveState Perl，并且在那里，PPM 下载并安装 Carp 没有问题。我切换到 Strawberry/DWIM Perl 的原因是我想运行一个调试器，而 Padre 的ActiveState 的最新版本是 0.86，这是错误的。所以我安装了 DWIM Perl，因为我想使用 Padre 0.92）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T23:55:45.720

> 并运行 nmake。

为什么要使用 nmake？DWIMPerl( StrawberryPerl) 不知道与 nmake 一起提供，通常它们与**dmake**和 AFAIK 一起提供，他们的文档反映了这一点

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-21T00:27:24.467

`Carp`是一个核心模块，因此它包含在您的 Perl 安装中。只需尝试`use Carp`您的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T04:16:43.033

1.  Carp 随您的 Perl 发行版一起提供，它是一个核心模块。[corelist](http://perlpunks.de/corelist)（[离线版](http://perldoc.perl.org/corelist.html)）向您展示了各种 Perl 版本附带的标准模块。您会看到[Carp](http://perlpunks.de/corelist/version?module=Carp)与所有 Perl 版本早在 5 时一样。没有什么可下载的。只需使用`Carp`. 对许多人来说，关于 Perl 的难点之一是某些功能除了在模块中之外不存在，但这些模块无论如何都是 Perl 附带的。我见过很多人使用`system cp`或者`system find`因为他们没有意识到 Perl 带有一个模块来复制文件或在目录树中搜索文件。它在你必须的模块中`use`。

2.  尝试使用[cpan](http://perldoc.perl.org/cpan.html)命令下载您的模块。该`cpan`命令将搜索、下载、编译、测试和安装您需要的任何模块。人们使用 Strawberry Perl 而不是 ActivePerl 的原因之一是，从历史上看，该`cpan`命令在*Strawberry Perl*上比在*Active Perl*上运行得更好。

# css - 如何将显示切换效果转换为 CSS 3 过渡效果

> ID：10677921
> 
> 赞同：1
> 
> 时间：2012-05-20T22:57:46.850
> 
> 标签：css, css-transitions

**首先，我必须说我正在开发只能操纵其 CSS 的网站。** 所以，请不要建议我使用 javascript/html 解决方案。

这是我的问题，

您可以在这个[jsFiddle 演示](http://jsfiddle.net/tRTgE/1)中看到，有一个基本的切换显示方法，但它对默认 CSS 没有过渡效果。HTML 就是这样，我没有更改其 HTML 或 javascript 的权限，我只能玩 CSS。

我想为这个切换方法添加 CSS 3 过渡效果。

[正如吉姆杰弗斯对这个问题的回答](https://stackoverflow.com/a/3332179/603127)，过渡效果永远不会起作用

`display: block`< - > `display: none`

所以我总是需要保留元素显示块。

我试过这个，但它没有工作，

```
.infocontent {
    -webkit-transition: opacity 1s ease-out;
}
div[style='display: block; '].infocontent { 
   opacity: 1; height: auto !important;
}
div[style='display: none; '].infocontent {
   display:block !important;  opacity: 0; height: 0px; 
} 
```

为什么它不起作用？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:02:09.573

尝试在最大高度而不是高度上使用过渡。

# jsf - 如何一次声明多个 JSF 托管 bean

> ID：10677926
> 
> 赞同：1
> 
> 时间：2012-05-20T22:58:44.840
> 
> 标签：jsf, javabeans, managed-bean

我正在开发一个使用基于 SOAP 的 Web 服务的 JSF 2.0 应用程序。

我想在 JSF 页面中使用为 Web 服务生成的大部分客户端类 - 但客户端类不是托管 bean（也不是 CDI bean）......而且我不认为有很多客户端类可以向所有类添加`@ManagedBean`或`@Named`注释...

让我举个例子，这样事情可能会更清楚一点：

User 类是一个生成的客户端类——这个类只有两个属性（登录名和密码）。

我希望能够为 JSF 页面中给定用户的属性分配值：

```
<h:inputText value="#{user.name}"/>
<h:inputText value="#{user.password}"/> 
```

然后我想打电话给我`UserService`来验证用户：

```
<h:commandButton value="Login" action="#{userService.authenticate}"/> 
```

从 JSF 页面为 User 对象分配值的唯一方法（AFAIK）是将 User 对象设为托管 bean（或 CDI bean）。

由于有超过 100 个客户端类，我绝对不想在所有类上添加`@ManagedBean`或`@Named`注释（我同样不想在 faces-config.xml 中为每个类添加 message-bean 元素）。

即使注释所有类是一个可行的选项，该解决方案也会有一个缺点：服务合同 (WSDL) 可能随时更改，我将有义务重新生成客户端类......我会放弃带注释的类。

处理这种（类型）问题的最佳方法是什么？

我一直在寻找一种方法来在 faces-config.xml（下面的示例）中声明一个包的所有类，但我既找不到这样做的方法，也找不到可行的替代方案。

```
<managed-beans>
    <managed-beans-package>x.y.z.ws.client</managed-beans-package>
    <managed-beans-scope>none</managed-beans-scope>
</managed-beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:28:26.810

只需制作 的`User`a 属性即可`UserService`。这也更符合 JSF 的 MVC 思想。`UserService`是控制器，是`User`模型。

就这样，

```
@ManagedBean
@ViewScoped
public class UserService {

    private User user;

    // ... (don't forget to prepare user in (post)constructor if "new" user)
} 
```

和

```
<h:inputText value="#{userService.user.name}" />
<h:inputText value="#{userService.user.password}" /> 
```

# python - Django 帖子和回复

> ID：10677927
> 
> 赞同：4
> 
> 时间：2012-05-20T22:58:55.823
> 
> 标签：python, django, jquery

这不是一个技术问题，而是一个“我是否以正确的方式做这件事”的问题。

我定义了几个模型

```
class Style(models.Model):
    tag_xml = models.TextField()
    image = models.ImageField(upload_to="styles")
    user = models.ForeignKey(User)
    uploaded = models.DateField()

class StyleMatch(models.Model):
    style = models.ForeignKey(Style)
    item = models.ForeignKey(FashionItem) 
```

由于任务的性质，它们不能通过 html 表单填充，所以为了填充它们，我有一个带有 jquery 和许多事件函数和其他 javascript 好东西的 html 页面。单击保存按钮时，我调用 .ajax() 并传递所有收集的变量

```
var saveRequest= $.ajax({
url: "/save_style/",  
type: "POST",        
data: "selection="+s+"&user="+user+"&src="+image_src,
dataType: "text"    
}); 
```

然后我的 save_style 视图将值保存到模型中

```
def save_style(request):
if request.method == 'POST':
    selection = request.POST['selection'].rsplit("|")
    user = request.POST['user']
    src = request.POST['src']

    f = open(MEDIA_ROOT+src)
    image_file = File(f)

    u = User.objects.get(id=user)

    style = Style(tag_xml = "",
                  image = image_file,
                  user = u,
                  uploaded = date.today())
    style.save()

    for s in selection:
        if (s != ''):
            match = FashionItem.objects.get(id=s)
            styleMatch = StyleMatch(style = style,
                                    item = match)
            styleMatch.save()

    i = StyleMatch.objects.filter(style=style)
    items = FashionItem.objects.filter(id__in=i)

   return render_to_response('style_saved.html', dict(image=src, items=items, media_url = MEDIA_URL), context_instance=RequestContext(request)) 
```

这样做之后，我真的很想去一个成功页面并显示我刚刚添加到模型中的记录，但是如果我使用`render_to_response`并传回模型详细信息，我必须在 javascript 中重建整个页面，似乎更好地重定向到一个新模板，但如果我使用`HttpResponseRedirect`a) 我无法传回值，并且 b) 它似乎没有正确重定向（我认为因为帖子来自我的 javascript）。

所以最后我的问题

1.  我真的应该这样做吗？django 文档似乎并没有真正涵盖这些稍微复杂的领域，所以我有点不确定。
2.  我应该在上面使用 render_to_response 还是 HttpResponseRedirect ？或者可能是我不知道的第三种选择。

任何建议表示赞赏。

仅供参考，我知道上面的代码并不理想，即缺少验证、注释......等，它只是为了演示目的而提供的。不过，请随时指出任何严重的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T12:23:19.060

根据应用程序的性质，您可能不应该使用 JavaScript 构建整个页面。但是，由于我们已经在那里，我使用了以下解决方案，效果很好：

考虑创建一个模板“片段”，正如我所说的那样。它只是一小段 HTML，旨在成为通过 AJAX 传输的数据的封装。对此片段执行 render_to_response，将处理后的视图数据作为变量传递，然后通过 AJAX 检索此数据并使用 JavaScript 将指定 div 元素中的 HTML 替换为返回的数据。

上述解决方案存在一些缺陷，例如模板片段上的样式和事件处理程序附件，但它至少应该让您工作。在这方面只是一个提示，熟悉 jQuery 的 .on()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T05:28:58.100

> 传递所有收集的变量

为什么不`$(form).serialize()`呢？

> 将值保存到模型中

为什么不使用`django.forms.ModelForm`（或很少使用）？

> 似乎重定向不太正确

因为 AJAX 中的重定向是在 AJAX 调用中处理的，除非您以某种方式在 JS 中处理接收到的数据，否则不会影响打开的页面。

此外，您没有任何数据验证和|或错误报告，这很糟糕。实际上，`ModelForm`应该提供巨大的帮助。

# c# - word.sub-word.sub-sub-word

> ID：10677932
> 
> 赞同：0
> 
> 时间：2012-05-20T23:00:00.763
> 
> 标签：c#

我是编程新手，所以我不知道术语是什么，我很抱歉。我希望能够编写如下所示的内容：

```
Label Label1 = new Label();
Label1.Text = DateTime.Now.ToString("MM.dd.yyyy"); 
```

但是用我自己的对象：

```
Reciept ReciptForAirPlaneTicket = new Reciept();
ReciptForAirPlaneTicket.MOP = MOP.CreditCard.Visa("4111111111111111|0815");

Reciept ReciptForFood = new Reciept();
ReciptForFood.MOP = MOP.CreditCard.MasterCard("4222222222222222|0917");

Reciept ReciptForClothes = new Reciept();
ReciptForClothes.MOP = MOP.Cash;

Reciept ReciptForTools = new Reciept();
ReciptForTools.MOP = MOP.Check("12345"); 
```

我真的不是想偷懒，但我已经找了快一天了，我什至不知道要找什么。我想我至少需要创建一个类，还需要一个结构或称为枚举的东西，但我真的不知道。

我正在使用 C#。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:06:30.090

这对我来说似乎是一种不寻常的方法，但要获得确切的语法，您可以使用静态类 MOP 创建一种工厂模式。

```
public class MethodOfPayment
{
    public enum enumCardType { Visa, Mastercard };
    public enum enumPaymentType { CreditCard, Cash };

    public string Number { get; set; }
    public enumPaymentType PaymentType { get; set; }
    public enumCardType CardType { get; set; }
}

public static class MOP
{
    public static class CreditCard
    {
        public static MethodOfPayment Visa(string number)
        {
            return new MethodOfPayment() { 
                Number = number,
                PaymentType = MethodOfPayment.enumPaymentType.CreditCard,
                CardType = MethodOfPayment.enumCardType.Visa
            };
        }
    }
} 
```

对其他类型重复此操作，然后根据需要进行实例化。

```
ReciptForAirPlaneTicket.MOP = MOP.CreditCard.Visa("4111111111111111|0517"); 
```

# c# - 子对象的流畅 nhibernate 副本

> ID：10677934
> 
> 赞同：0
> 
> 时间：2012-05-20T23:00:29.657
> 
> 标签：c#, nhibernate, fluent-nhibernate

我目前有以下（简化的）类/数据库模式：

```
Entity          Prospect     Customer
 +- Id           +- Id        +- Id
 +- Address      +- Entity    +- Entity
 +- Name         +- ...       +- ...
 +- ...

ENTITY              PROSPECT           CUSTOMER
======              ==========         ========
ID - INT PK         ID - INT PK        ID - INT PK
ADDRESS - VARCHAR   ENTITY_ID - INT FK ENTITY_ID - INT FK
NAME - VARCHAR      ...
... 
```

以及以下流畅的映射：

```
PROSPECT_MAP:
Table("PROSPECT");
Id(x => x.Id).GeneratedBy.Increment();
References(x => x.Entity).Cascade.All().Fetch.Join().Column("ENTITY_ID");
...

CUSTOMER_MAP:
Table("CUSTOMER");
Id(x => x.Id).GeneratedBy.Increment();
References(x => x.Entity).Cascade.All().Fetch.Join().Column("ENTITY_ID");
... 
```

现在还有一堆东西附加到实体上（使用 entity_id 作为 FK）。在我的应用程序中，潜在客户可以成为客户。

因此，我想创建一个新客户，将其链接到前潜在客户使用的 entity_id（以便与该实体相关的所有信息现在都属于客户），然后从数据库中删除潜在客户（所以基本上只需删除来自潜在客户表的条目，而不是级联到其子组件，这些子组件现在由新创建的客户链接）

NHibernate 有可能吗？请注意，我需要 ProspectMap 中的 cascade.all，因为删除潜在客户及其组件应该仍然是应用程序中的一个选项。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T07:13:22.633

```
void UpgradeToCustomer(Prospect p)
{
    var customer = new Customer
    {
        Entity = p.Entity
    };

    p.Entity = null; // prevent cascading

    session.Delete(p);
    session.Save(customer);
} 
```

# zend-framework - 在 Zend Framework 中为模型设置 Application.ini

> ID：10677937
> 
> 赞同：0
> 
> 时间：2012-05-20T23:00:44.550
> 
> 标签：zend-framework, routes, zend-db, zend-db-table

我是 Zend 框架的新手。我一直在关注“ZendFramework - 初学者指南”一书。在第 4 章中，他们开始使用 Doctrine。问题是我想在数据库交互中使用 Zend 的内置功能。

我已经在网上搜索并观看了几个 tuts。好吧，我找不到合适的（对我来说）解决方案。

总之，每个人都在使用标准的 Zend 结构。我想集成我的模块。所以我有一个这样的文件结构：

```
application
   /modules
      /moduleName
          /controllers
          /models
          /views 
```

我在 application.ini 中为控制器和视图设置了路由，如下所示：

```
; /articles/* route
resources.router.routes.articles.route = /articles
resources.router.routes.articles.defaults.module = content
resources.router.routes.articles.defaults.controller = articles
resources.router.routes.articles.defaults.action = index 
```

现在我尝试加载我的模型，以便开始与 Mysql 中的表进行交互。

在我的控制器中，`ArticlesController.php`我创建了这个类`Content_ArticlesController`，在那里我有：

```
 public function indexAction()
  {

      $model = new Content_ArticlesModel();
      $this->view->modelHi = $model->there;
      $this->view->hello = 'Hello there';

  } 
```

您可能会猜到 Content_ArticlesModel 是我的扩展 Zend_Db_Table_Abstract 类的类。在那里我有一个公共函数 modelHi() 我想从我的控制器调用它来将数据从模型传递到视图。

有人可以帮助我以正确的方式做到这一点吗？我应该如何为我的模块正确加载模型？也许你可以根据一些例子链接一些关于使用数据库的好文章。

编辑：好的，我的控制器中有这个非常愚蠢的错误，但没关系。无论如何，问题是当 Zend 加载我的控制器时，它会显示：`Fatal error: Class 'Content_ArticlesModel' not found in S:\xampp\htdocs\testsite\application\modules\content\controllers\ArticlesController.php on line 12`

问题是我的 Zend 无法定位/不知道在哪里可以找到我试图从控制器访问的模块模型。

我想知道我应该如何让 Zend 看到和使用我的模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:58:01.937

为什么不在控制器中调用公共 modelHi() 方法

更新：如果您的模块名称是 'content' ，那么您的模型应该位于

```
application/modules/content/models/ArticlesModel.php 
```

然后执行以下操作

```
public function indexAction()
  {

      $model = new Content_Model_ArticlesModel(); //name of class
      $this->view->modelHi = $model->modelHi();
      $this->view->hello = 'Hello there';

  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T06:00:46.463

您应该在 application.ini 文件中为模型和视图进行配置

```
resources.modules = 

resources.view[] = 
```

你也应该在你的模块中创建引导文件

```
class Content_Bootstrap extends Zend_Application_Module_Bootstrap {
 } 
```

此外，您应该确保您的 modulel 文件夹的名称是小写字母“内容”..

完成这些配置后，您将能够在控制器中调用模型...

# c++ - C++ 游戏设计 - 什么库/API？

> ID：10677938
> 
> 赞同：1
> 
> 时间：2012-05-20T23:00:56.650
> 
> 标签：c++, api, 2d

我目前正在用 C++ 开发一个 rpg 类型的游戏。我过去开发过一些游戏，但使用了很多包容性的 API。对于这个游戏，我正在考虑更多地自己开发它。我仍然希望（主要）使用该库实现图形和动画功能。以下是游戏的分解图：

*   当不在战斗中时，它将是一个自上而下的基于瓷砖的游戏，角色可以自由走动，速度将由速度数据决定

*   一旦进入战斗，它将是一个回合制战斗系统，每边（不是完全最终的）3人团队

*   一些信息将在线存储并在游戏中使用，但不需要经常检查

我要问的是；最好的库或 API 最有可能用于此目的是什么？我已经搜索并找到了一些我认为可能适合我的需求，但没有一个很受欢迎。也许我正在寻找一些过于具体的东西，但任何帮助或建议将不胜感激。

PS 除了推荐，我们将不胜感激提供一个不错的教程或文档的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:07:46.207

总是有流行的[libsdl](http://www.libsdl.org/)。这个图书馆有很多在线教程，包括专门的

[http://www.sdltutorials.com/](http://www.sdltutorials.com/)

您可以随时使用尽可能多或尽可能少的库功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T07:47:57.227

你看过这个吗？

[http://irrlicht.sourceforge.net/](http://irrlicht.sourceforge.net/)

如果您查看论坛，人们已经为 AI、物理等编写了自己的兼容库，他们似乎很乐意分享。还有很多兼容的工具，比如[http://www.ambiera.com/coppercube/](http://www.ambiera.com/coppercube/) 和很多语言包装器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T08:40:09.597

作为对 Caustic 答案的补充，我建议研究[Ogre3D](http://www.ogre3d.org/)。与[Irrlicht](http://irrlicht.sourceforge.net/)一样，它主要是一个*渲染引擎*，大部分工作都由您自己完成。从个人经验来看，我不能推荐其中一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-27T08:27:43.990

我很抱歉发誓。我相信你应该使用 SFML，因为它是一个用于图形开发的全方位优秀库。

# php - PHP编写CSV，由于某种原因输出整个网页

> ID：10677942
> 
> 赞同：0
> 
> 时间：2012-05-20T23:02:05.913
> 
> 标签：php, csv, filesystems

```
function outputCSV($data) {
    $outstream = fopen("php://output", 'w');
    function __outputCSV(&$vals, $key, $filehandler){
        fputcsv($filehandler, $vals, ',', '"');
    }
    array_walk($data, '__outputCSV', $outstream);
    fclose($outstream);
}

function someFunctionInTheBigPHPFile() {
    header("Content-type: text/csv");
    header("Content-Disposition: attachment; filename=file.csv");
    header("Pragma: no-cache");
    header("Expires: 0");

    $mydata = array(
    array('data11', 'data12', 'data13'),
    array('data21', 'data22', 'data23'),
    array('data31', 'data32', 'data23'));

    outputCSV($mydata);
    exit;
} 
```

输出 CSV 确实包含数据数组。问题是，这个数组与网页的其余部分一起显示，即调用此函数之前的所有内容以及之后的所有内容，尽管这两个函数是唯一处理任何 fopen 和写入文件的函数。

如何阻止网页的其余部分干扰？我只想要CSV中的数据数组..

编辑：我设法通过添加 exit; 来切断阵列之后的所有内容；但我仍然遇到整个网站显示在阵列之前的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:04:10.593

输出 CSV 数据后停止执行。您可以使用`die()`或来执行此操作`exit()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T22:36:47.460

在 PHP 文件的开头，立即检查是否要打印 CSV（这可能通过 $_POST 或 $_GET 传递）。如果是这样，直接通过函数运行它并以 exit; 结束该函数。

这可以防止在创建 CSV 之前或之后发生任何事情。由于某种原因，页面上的所有代码都包含在新文件中，即使文件流的打开和关闭有时与页面内容的计算时间无关。

这实际上只给你留下了你想要的东西，而不是之前或之后的垃圾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T23:08:55.643

也许我误解了你，但是 someFunctionInTheBigPHPFile() 将文件打印到屏幕上。那么，你为什么要使用这个我你不想屏幕输出？

# algorithm - 普通算法的平均案例复杂度

> ID：10677948
> 
> 赞同：0
> 
> 时间：2012-05-20T23:03:10.607
> 
> 标签：algorithm, big-o, time-complexity, average

```
P(x,y,z){
    print x
    if(y!=x) print y
    if(z!=x && z!=y) print z
} 
```

这里的平凡算法，值`x`, `y`,`z`是从 中随机选择`{1,...r}`的`r >= 1`。我正在尝试确定该算法的平均案例复杂度，并根据打印语句的数量来测量复杂度。

这里最好的情况是 T(n) = 1 或 O(1)，`x=y=z`此时的概率为 1/3。当概率为 2/3 时，
这里最坏的情况仍然是 T(n) = 3 或仍然是 O(1) 。`x!=y!=z`

但是当涉及到从数学上推导平均情况时：
样本空间是 n 个可能的输入，样本空间的概率是 1/n 机会 那么，我如何计算平均情况复杂度？（这是我画一个空白的地方..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T12:48:18.710

您的算法有三种情况：

1.  所有三个数字都相等。这个概率是*1/r*，因为一旦你选择了*x ，对于**y*和对于*z*只有一个选择。本案例的费用为 1。
2.  *x != y*，但*x == z*或*y == z*。这个概率是 1/r * (1/(r - 1))* 1/2，因为一旦你选择了 x，你就只剩下 r -1 个选择给 y，而 z 只能是这两个选择之一. 成本 = 2。
3.  这三个数字都是不同的。三者不同的概率为 1/r * (1/(r - 1))*(1/(r - 2))。成本 = 3。

因此，平均情况可以计算为：

```
1/r  + 1/r * (1/(r - 1)) + 1/r * (1/(r - 1))*(1/(r - 2)) * 3 == O(1) 
```

**编辑：**上面的表达式是*O(1)*，因为整个表达式是由常量组成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:36:27.803

平均情况将介于最好和最坏情况之间；对于这个特殊问题，这就是您所需要的（至少就 big-O 而言）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T00:50:32.770

1）您至少可以对一般情况进行编程吗？编写（伪）代码并对其进行分析，这可能很明显。您实际上可能对其进行了次优编程，并且可能存在更好的解决方案。这是非常典型的，它是计算机科学数学领域解谜的一部分，例如，如果你只是想编写一个排序代码，你很难自己发现快速排序。

2）如果可以，然后运行蒙特卡罗模拟并绘制结果。即，对于 N = 1、5、10、20、...、100、1000 或任何实际样本，运行 10000 次试验并绘制平均时间。如果你很幸运 X = 样本量，Y = 平均值。在该样本量下运行 10000 次的时间将绘制出一条漂亮的线、抛物线或一些易于建模的曲线。

因此，我不确定您是否需要有关（1）查找或编码算法或（2）分析它的帮助，您可能需要修改您的问题以指定这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-19T09:50:57.697

```
P(x,y,z){
   1.print x
   2.if(y!=x)
   3\. print y
   4.if(z!=x && z!=y)
   5\.  print z
} 
```

第 1 行：花费恒定时间**c1** (c1:print x)

第 2 行：花费恒定时间**c2**（c2：条件测试）

第 3 行：花费恒定时间**c3** (c3 :print y)

第 3 行：花费恒定时间**c4**（c4：条件测试）

第 4 行：花费恒定时间**c5** (c5:print z)

**分析 ：**

除非您的函数 P(x,y,z) 不依赖于输入大小“r”，否则程序将花费恒定的时间来运行，因为**Time Taken :T(c1)+T(c2+c3)+T(c4 +c5)** ..总结函数 P(x,y,z) 的大 O 是**O(1)**，其中 1 是一个常数，表示自 T(c1),T(c2),.. 以来的恒定时间量T(c5) 都需要恒定的时间.. 并说如果函数 P(x,y,z) 从 1 迭代到 r.. 那么您的代码段的复杂性将会改变并且将根据输入大小即“r”

最佳情况：O(1)

平均情况：O(1)

最坏情况：O(1)

# java - DDL 生成和常规 persistence.xml 设置 (OpenJPA)

> ID：10677950
> 
> 赞同：8
> 
> 时间：2012-05-20T23:03:25.490
> 
> 标签：java, jpa, openjpa, openejb, apache-tomee

**概括**

我正在尝试运行 Java Web 应用程序 JPA 2.0 示例。[示例应用程序](http://docs.oracle.com/javaee/6/tutorial/doc/giqst.html)被编写为在 中运行，`Glassfish`使用`EclipseLink`JPA 提供程序。我想将它转换为作为 JPA 提供程序运行`TomEE`，`OpenJPA`但我无法提供任何详细的教程来启动和运行`OpenJPA`.

**问题**

我无法转换`persistence.xml`为使用`OpenJPA`而不是`EclipseLink`. 更具体地说，给定的`persistence.xml`没有指定：

*   `Entity`类。这些有必要吗？
*   所需的 JPA 提供程序。容器会默认为某些东西吗？
*   JDBC 驱动程序。如何指定“内存中”数据库（仅用于初始测试目的）？

还：

*   OpenJPA 中如何表示 DDL 生成属性？我无法在[OpenJPA 用户指南](http://openjpa.apache.org/builds/2.2.0/apache-openjpa/docs/manual.html)中找到它们。

**细节**

下面是 EclipseLink `persistence.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0"
    xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="order" transaction-type="JTA">
        <jta-data-source>jdbc/__default</jta-data-source>
        <properties>
            <property name="eclipselink.ddl-generation" value="drop-and-create-tables" />
            <property name="eclipselink.ddl-generation.output-mode"
                value="both" />
        </properties>
    </persistence-unit>
</persistence> 
```

我有以下`Entity`课程：

*   `order.entity.LineItem`
*   `order.entity.LineItemKey`
*   `order.entity.Order`
*   `order.entity.Part`
*   `order.entity.PartKey`
*   `order.entity.Vendor`
*   `order.entity.VendorPart`

**问题**

*   有谁知道 OpenJPA 的等效 persistence.xml 是什么样的？
*   或者，如果有人可以向我指出一个涵盖这些问题的 OpenJPA 教程，那也一样好

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-21T18:51:56.977

如果您添加`openjpa.jdbc.SynchronizeMappings`如下所示的属性，OpenJPA 将自动创建您的所有表、所有主键和所有外键，以完全匹配您的对象

```
<property name="openjpa.jdbc.SynchronizeMappings" value="buildSchema(ForeignKeys=true)"/> 
```

或者，您可以在 TomEE 中使用 EclipseLink，只需将 EclipseLink jar 添加到`<CATALINA_HOME>/lib/`

[有关Common PersistenceProvider 属性](http://openejb.apache.org/common-persistenceprovider-properties.html)，请参阅此处

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-10T16:30:12.953

### 外键约束

下一行不创建外键：

```
<property name="openjpa.jdbc.SynchronizeMappings" 
          value="buildSchema(ForeignKeys=true)"/> 
```

仅创建模式并删除数据库的内容。

但如果要创建外键，请使用以下行：

```
<property name="openjpa.jdbc.SynchronizeMappings" 
          value="buildSchema(foreignKeys=true,schemaAction='dropDB,add')"/>
<property name="openjpa.jdbc.SchemaFactory" 
          value="native(foreignKeys=true)" />
<property name="openjpa.jdbc.MappingDefaults" 
          value="ForeignKeyDeleteAction=restrict, JoinForeignKeyDeleteAction=restrict"/> 
```

### 查看生成的 SQL

换一种方式，如果你想查看 SQL 输出：

```
<property name="openjpa.Log" 
          value="DefaultLevel=TRACE,SQL=TRACE" /> 
```

[**注意**：为了在 TomEE 控制台中查看生成的输出，您需要使用以下命令更改文件中的日志`loggin.properties`级别`openjpa.level = FINEST`]

* * *

[在http://openjpa.apache.org/faq.html](http://openjpa.apache.org/faq.html)中查看更多信息

# java - 用java阻止c3p0中的其他连接

> ID：10677953
> 
> 赞同：0
> 
> 时间：2012-05-20T23:03:55.680
> 
> 标签：java, sql-server, c3p0

我正在使用 java、c3p0 用于连接池和 SQL Server 2005 用于数据库开发应用程序。我的问题是，当我们在数据库中进行事务时，有什么方法可以阻止其他连接吗？例如，如果我们向数据库插入一条记录，另一个试图在同一张表上插入记录的连接将等待第一个连接成功完成......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:09:21.187

您可以为那些需要它的事务设置连接的隔离级别；最严格的是 SERIALIZABLE。您不应该尝试“阻止”其他连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T02:36:57.920

你想锁定表。SQL Server 将自动执行此操作。但是，您可以使用查询选项来控制 . [http://msdn.microsoft.com/en-us/library/aa213039(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa213039(v=sql.80).aspx) 听起来你想要一个独占锁

排他锁

排他 (X) 锁可防止并发事务访问资源。没有其他事务可以读取或修改使用排他 (X) 锁锁定的数据。

# android - setResult 没有回调父活动

> ID：10677956
> 
> 赞同：0
> 
> 时间：2012-05-20T23:04:22.280
> 
> 标签：android, android-activity

尝试将 setResult 返回父活动时发生了一些奇怪的事情，onActivityResult 方法未执行并且我的应用程序在此处终止是父活动

```
@Override
    protected void onCreate(Bundle savedInstanceState) {

            super.onCreate(savedInstanceState);
            Log.d("MyAPP","Access Calendar");
            //Getting the token back from authorization process
            accessToken = getIntent().getExtras().getString("token");
            // Setting up Calendar API Service
            setupCalendarConnection();
            startActivityForResult(intent.setClass(this, CalendarTasks.class),REQUEST_CAL_TASK);

    }
 @Override
        protected void onActivityResult(int requestCode, int resultCode, Intent data) {

            Log.d("MyAPP", "result arrived");

            if(requestCode==REQUEST_CAL_TASK){
                switch (resultCode){
                    case CREATE_EVENT:
                        getUserCalendars();
                        break;
                    case QUICKADD_EVENT:
                        getUserCalendars();
                        startActivityForResult(intent.setClass(this, CalendarQuickAddActivity.class),REQUEST_CAL_ACT);
                        break;
                    case VIEW_EVENTS:
                        getUserCalendars();   
                        break;
                    case CREATE_CALENDAR:
                        getUserCalendars();
                        break;
                    case EDIT_CALENDAR:
                        getUserCalendars(); 
                        break;
                }
            }

            super.onActivityResult(requestCode, resultCode, data);
        } 
```

这是儿童活动

```
listView.setOnItemClickListener(new OnItemClickListener(){

            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

                listIndex=position;
                Log.d("MyAPP", ""+position);

                switch (listIndex){
                    case 0:
                        Log.d("MyAPP","case 0"+listIndex);
                        setResult(CREATE_EVENT);
                        finish();
                        break;
                    case 1:{

                        Log.d("MyAPP","case 1"+listIndex);
                        setResult(QUICKADD_EVENT);
                        finish();
                        break;
                    }
                    case 2:
                        Log.d("MyAPP","case 2"+listIndex);
                        setResult(VIEW_EVENTS);
                        finish();
                        break;
                    case 3:
                        Log.d("MyAPP","case 3"+listIndex);
                        setResult(CREATE_CALENDAR);
                        finish();
                        break;
                    case 4:
                        Log.d("MyAPP","case 4"+listIndex);
                        setResult(EDIT_CALENDAR);  
                        finish();
                        break;
                }

            }

        }); 
```

我正在检查案例 1，Log cat 打印出正确的日志，但在 onActivityResut 方法中没有打印该日志，这意味着它不会返回，我不知道这背后的原因。我移动了 switch 块来覆盖 finish() 方法，我遇到了同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T04:37:43.633

如果您使用的是 ActivityGroup 或 TabGroupActivity，那么您需要覆盖 handleActivityResult(requestCode, resultCode, data) 而不是 onActivityResult(requestCode, resultCode, data)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:47:31.583

线，

```
startActivityForResult(intent.setClass(this, CalendarQuickAddActivity.class), REQUEST_CAL_ACT); 
```

确保您的结果返回到`CalendarQuickAddActivity`. 这是你想要的吗？

另外，变量到底是什么`intent`？是全球性的吗？这有点令人困惑......您可能只想创建一个新`Intent`的 with`new Intent(this, CalendarQuickAddActivity.class)`以使您的代码更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-06T13:41:39.543

您需要调用 startActivityForResult 然后它才会返回

```
startActivityForResult(intent.setClass(this, CalendarQuickAddActivity.class), REQUEST_CAL_ACT); 
```

# ruby - 如何生成六种随机十六进制颜色并将它们放入 Ruby 数组中？

> ID：10677959
> 
> 赞同：1
> 
> 时间：2012-05-20T23:05:23.553
> 
> 标签：ruby, colors, hex, rmagick

我正在使用 RMagick 制作一个项目，该项目会根据大小和颜色生成随机横幅广告。

第一步是这样，但它不能正常工作。我正在使用所谓的三元语句来制作像“#ffffff、#f0f1cd、#123fff”等这样的字符串。

```
# Generate sixteen random colors
1.upto(16) { |i|
    (defined? colors) ? colors << ", #%06x" % (rand(0xffffff)) : colors = "#%06x" % (rand(0xffffff))
}
puts colors.split(',') 
```

期望的结果是不正确的。我希望它分成一个数组，如： ["#ffffff", "#f0f1cd", "#123fff"]

尽可能采用最优雅的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-20T23:09:46.347

你可以这样做会更容易：

```
colors = 3.times.map{"%06x" % (rand * 0x1000000)} 
```

注意：如果您使用的是 Ruby 1.9.3，则可以使用范围。

```
colors = 3.times.map{"%06x" % rand(0..0xffffff)} 
```

# javascript - 使用带有可变长度参数数组的 JavaScript 新关键字

> ID：10677962
> 
> 赞同：2
> 
> 时间：2012-05-20T23:05:53.350
> 
> 标签：javascript, inheritance

我正在构建一个允许对象被任何其他对象扩展的函数

```
Object.prototype.extend = function(constructor, args) {
    var proto = this;
    while(proto.__proto__.constructor !== Object) {
        proto = proto.__proto__
    }
    proto.__proto__ = new constructor(args)
    console.log(this); 
} 
```

该方法将像这样调用：

```
function ChildModelConstructor(1,2,3) {
    this.extend(ParentModel, arguments)
}
or
instanceOfChildModel.extend(ParentModel, [1,2,3]) 
```

问题是如果我这样调用 new ：

```
new constructor(args) 
```

父对象的构造函数接收参数，该参数是参数对象或数组。

我想要的是能够打电话

```
new constructor.apply(args) 
```

或类似的东西，我不想改变这个新的上下文，apply 是使用我知道的 args 对象或数组调用方法的唯一方法。

谢谢您的帮助 ：）

## 更新，我找到了更好的方法

这是我想出的一种更好的继承方法，它避免使用折旧的**原型**

与我发现的其他继承方案相比，这种方法有几个优点。最大的是它没有合并多个级别的原型链。许多方案将 childClass 的 proto 方法与父类实例变量混合在一起，或者更糟糕的是，将父类初始化的所有方法和属性直接放入 childClass 的主体中。

缺点是，它是单继承，并且不能更改单个实例的继承，因为原型属性属于构造函数。

```
Function.prototype.inherit = function(parentClass) {
    var newPrototype = Object.create(Object.create(parentClass.prototype));
    for(key in this.prototype){
        newPrototype[key] = this.prototype[key];
    }
    this.prototype = newPrototype;    
    this.prototype.constructor = this;
    this.prototype.parentClass = parentClass;
    this.prototype.initParent = function(args) {
        var proto = Object.getPrototypeOf(Object.getPrototypeOf(this))
        this.parentClass.apply(proto, args);
    }
    this.prototype.uber = function() {
        return Object.getPrototypeOf(Object.getPrototypeOf(this));
    }        
} 
```

你可以像这样设置继承：

```
function Model(n) {
    this.initParent(arguments)
    this.test = n*2;
}
Model.inherit(BaseClass); 
```

这里是 JSFiddle 中稍微详细一点的版本[http://jsfiddle.net/michaelghayes/2rHgK/](http://jsfiddle.net/michaelghayes/2rHgK/) ​​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:18:11.930

这是未经测试的，但我认为它会起作用。代替：

```
proto.__proto__ = new constructor(args) 
```

和：

```
proto.__proto__ = {};
proto.__proto__.prototype = constructor.prototype;
constructor.apply(proto.__proto__, args); 
```

请注意[`__proto__`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/Proto)已弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T21:19:18.317

最好不要将东西附加到对象原型上，而只是手动设置继承：

```
Model function() {
  //init parent first because of chromes hidden classes
  ParentClass.apply(this, [].slice.call(arguments))
  //new instance properties
  this.something = 'something'
}

Model.prototype = Object.create(ParentClass.prototype, {
  constructor: {value: Model}
})

//Prototype props
Model.prototype.whatever = function(){return 'whatever'} 
```

这也允许您在初始化父级之前修改 args，因为您的新类不应该被限制为使用与其父级完全相同的 args

# c# - 什么会导致在套接字发送或接收上阻塞的线程抛出异常？

> ID：10677963
> 
> 赞同：0
> 
> 时间：2012-05-20T23:06:00.743
> 
> 标签：c#, sockets, exception-handling

我想知道是否有人知道一篇关于当程序阻塞套接字发送/接收时可能会引发什么样的异常的好文章或博客文章，更重要的是，它们何时会或不会被抛出的详细信息。MSDN 只是在这种情况下才有用，而且对我来说，找到一篇文章比我自己尝试调用所有这些错误来了解它们更有教育意义。我的意思的一些例子：

ThreadInterruptedException - 仅在阻塞时抛出此异常。因此，如果您正在从套接字读取，我相当肯定它会在尝试阻塞并抛出此异常之前读取整个缓冲区。这是一个手动调用的异常，使用thread.interrupt；我只用它来处理行为不端的套接字，或关闭阻塞的只读线程以避免需要轮询。

SocketException - 通常抛出什么。如果套接字在另一个线程处于读/写过程中时关闭，则会引发此异常。如果在线程被阻塞等待新接收时网络连接丢失，是否会抛出此异常？

我对可能出错的更详细的细节感到好奇，因为我有一个伪异步套接字库，它有相当多的读写操作，有相当多的代码来处理重新连接之类的事情。我想知道任何被阻塞的线程可能出错的一切。

# javascript - 如何使用 mootools 确定损坏图像上的错误代码

> ID：10677964
> 
> 赞同：3
> 
> 时间：2012-05-20T23:06:09.370
> 
> 标签：javascript, ajax, image, events, mootools

我需要一个脚本，它可以根据提供的 HTTP 状态代码确定图像未加载的原因。

我知道图像和对象上的 onError 事件，但它没有传递错误代码。因此，如果图像的来源损坏或发生超时，则以相同的方式处理。

我想要的是有一个可以确定错误代码并采取相应措施的脚本。例如：

*   404 - 用预定义的图像替换图像
*   403 - 使用回调函数通知管理员
*   504 - 尝试重新加载
*   等等

我在 google 上进行了一些搜索，但除了 onError 事件之外，我还没有找到。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T09:07:43.873

the only thing i can think of is to go to a xhr request on fail, with Asset.image from more handling the loading:

```
new Asset.image('foo.jpg', {
    onload: function() {
        someel.adopt(this);
    },
    onerror: function() {
        new Request({
            url: this.get('src'),
            onComplete: function() {
                console.log(this.status); // 404
            }
        }).get();
    }

}); 
```

[http://jsfiddle.net/dimitar/2hwej/](http://jsfiddle.net/dimitar/2hwej/)

not exactly the greatest as it would mean 2 requests. to go around that, you can put your image loading into a xhr request to begin with and then use base64 data to output or something.

# .net - 在 Visual Studio 11 Beta 中开始开发

> ID：10677965
> 
> 赞同：0
> 
> 时间：2012-05-20T23:06:25.283
> 
> 标签：.net, asp.net-mvc, visual-studio, visual-studio-2012, beta

我正在考虑开始一个网络项目，我最终将在网上发布该项目。我想利用最新的技术，想知道我是否可以使用 VS 11 Beta 开始开发这个项目。如果我这样做了，我可以毫无问题地升级到 RTM 版本吗？我觉得它会帮助我学习 .Net 4.5 和 MVC 4 的新功能。我不想开始使用这个 beta 版本，但我意识到一旦 RTM 版本发布，它就不会工作或遇到问题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:10:21.790

没有人能告诉你，当 RTM 出现时，你现在所做的是否会 100% 正常工作。但我怀疑从现在到发布之间是否存在 MVC4 的重大突破性变化。

# php - 用 PHP 编写 JavaScript

> ID：10677966
> 
> 赞同：-1
> 
> 时间：2012-05-20T23:06:28.123
> 
> 标签：php, javascript

我正在尝试纠正一些 JavaScript 以使用 PHP 定义变量。该变量中有一个小 jQuery，应该由客户端呈现。我说“应该”，但真正的意思是我想要它。我应该怎么做才能使 o2 与 o1 相同（即隐藏 jQuery）？

谢谢！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" /> 
<title></title> 
<script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"></script> 
<script>
$(function() {
    var o1={"foo":{"bar": "abc/index.php?="+$("#id").val()}};
    console.log(o1);
<?php
$d='abc/index.php';
$json='{"foo":{"bar": "'.$d.'?id=\"+$(\"#id\").val()"}}';
//echo($json);
$json=json_decode($json);
//echo(print_r($json,1));
$json=json_encode($json);
//echo($json);

echo("var o2=".$json.";");
?>

console.log(o2);
});

</script>

</head>

<body>
<input type="hidden" id="id" value="123" />
</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T23:14:02.990

*未经测试，可能包含错误：*

```
<script>
$(function() {
    var o1={"foo":{"bar": "abc/index.php?="+$("#id").val()}};
    console.log(o1);

    <?php
    $d='abc/index.php';
    $json='{"foo":{"bar": "' . $d . '?="+$("#id").val()}}';

    echo("var o2=".$json.';');
    ?>

    console.log(o2);
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T23:47:09.913

我更喜欢使用 json_encode 制作 json，以避免在解析和验证 json 时出现意外问题。

json_encode 和 json_decode 仅适用于 UTF-8，如果另一个字符集具有特殊字符，它将导致一个空白字符串。

```
<script>
<?php

$d = "abc/index.php";
$json['foo']['bar'] = $d . '?id=$("#id").val()';

echo "var o2 = ".json_encode($json);

?>
console.log(o2);
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T23:48:51.070

你有这个：

```
<input type="hidden" id="id" value="123" /> 
```

所以我可以假设您是从数据库中获取该 ID 的，对吗？也许是这样的：

```
<input type="hidden" id="id" value="<?php echo $row[id];?>" /> 
```

如果是这种情况，请执行以下操作（我测试并工作）：

你不需要隐藏的输入来做到这一点。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" /> 
<title></title> 
<script src="http://code.jquery.com/jquery-latest.js" type="text/javascript"></script> 
<script>
$(function() {

    <?php
        //From your SQL query you obtained
        //$row['id'] = 123;
        $id = $row['id'];
    ?>

    var o1={"foo":{"bar": "abc/index.php?=" + <?php echo $id ?>}};
    console.log(o1);

    <?php
    $d='abc/index.php';
    $json='{"foo":{"bar": "'.$d.'?='.$id.'"}}';
    //echo($json);
    $json=json_decode($json);
    //echo(print_r($json,1));
    $json=json_encode($json);
    //echo($json);
    echo("var o2=".$json.';');
    ?>

    console.log(o2);
});
</script>
</head>
<body>
</body> 
</html> 
```

# java - 如何绕过 Twitter 3200 状态限制？

> ID：10677968
> 
> 赞同：0
> 
> 时间：2012-05-20T23:06:37.407
> 
> 标签：java, android, twitter, twitter4j

> **可能重复：**
> [查找用户的所有推文（不仅仅是前 3,200 条）](https://stackoverflow.com/questions/8471489/find-all-tweets-from-a-user-not-just-the-first-3-200)

我正在开发一个需要访问所有用户状态的应用程序。问题是，twitter 只允许检索 3200 个最近的状态。

我知道许多其他网络服务能够获取您所有的推文，我该如何解决这个问题？

[https://dev.twitter.com/docs/things-every-developer-should-know](https://dev.twitter.com/docs/things-every-developer-should-know)

之前有人问过一个类似的问题，[查找来自用户的所有推文（不仅仅是前 3,200 条）](https://stackoverflow.com/questions/8471489/find-all-tweets-from-a-user-not-just-the-first-3-200)，接受的答案是“在用户的推文计数达到 3200 之前开始保存它们”。但这不是一个选择，因为许多用户已经拥有超过 3200 条推文。

我已经阅读了很多关于这个问题的内容，但我没有看到任何解决方法，但显然有类似这里提到的网站[http://blog.tweetsmarter.com/twitter-search/10-ways-and-20- features-for-searching-old-tweets/](http://blog.tweetsmarter.com/twitter-search/10-ways-and-20-features-for-searching-old-tweets/)可以做到。

有任何想法吗？

# jsplumb - jsplumb - 滚动出视图时隐藏连接器

> ID：10677978
> 
> 赞同：2
> 
> 时间：2012-05-20T23:08:33.583
> 
> 标签：jsplumb

我们希望使用 jsplumb 在两个并行的、可滚动的列表中绘制项目之间的链接——比如说，在具有溢出=自动的 div 中。如果两个项目被链接，则滚动列表，以便其中一个滚动到视图之外，仍然绘制 div 外部的 jsplumb 链接部分。下面是一个示例页面（需要在同一目录中的 jquery js 文件和 jsplumb js 文件，根据显示的脚本包括）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Untitled Page</title>
    <script src="jquery-1.4.1.min.js" type="text/javascript"></script>
    <script src="jquery.jsPlumb-1.3.8-all-min.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(function () {

            $('#leftdiv').scroll(function () {
                jsPlumb.repaintEverything();
            });

            $('#rightdiv').scroll(function () {
                jsPlumb.repaintEverything();
            });

            jsPlumb.importDefaults({
                // default drag options
                DragOptions: { cursor: 'pointer', zIndex: 2000 },
                EndpointStyles: [{ fillStyle: '#225588' }, { fillStyle: '#558822'}],
                Endpoints: [["Dot", { radius: 2}], ["Dot", { radius: 2}]]
            });
            var allSourceEndpoints = [], allTargetEndpoints = [];
            var connectorPaintStyle = {
                lineWidth: 2,
                strokeStyle: "#deea18",
                joinstyle: "round"
            },
            // .. and this is the hover style. 
            connectorHoverStyle = {
                lineWidth: 2,
                strokeStyle: "#2e2aF8"
            };
            var sourceEndpoint = {
                endpoint: "Dot",
                paintStyle: { fillStyle: "#225588", radius: 2 },
                isSource: true,
                connector: ["Straight", { stub: 40}],
                connectorStyle: connectorPaintStyle,
                hoverPaintStyle: connectorHoverStyle,
                connectorHoverStyle: connectorHoverStyle,
                dragOptions: {}
            };
            var targetEndpoint = {
                endpoint: "Dot",
                paintStyle: { fillStyle: "#558822", radius: 2 },
                hoverPaintStyle: connectorHoverStyle,
                maxConnections: -1,
                dropOptions: { hoverClass: "hover", activeClass: "active" },
                isTarget: true
            };

            _addEndpoints = function (toId, sourceAnchors, targetAnchors) {
                if (sourceAnchors)
                    for (var i = 0; i < sourceAnchors.length; i++) {
                        var sourceUUID = toId + sourceAnchors[i];
                        allSourceEndpoints.push(jsPlumb.addEndpoint(toId, sourceEndpoint, { anchor: sourceAnchors[i], uuid: sourceUUID }));
                    }
                if (targetAnchors)
                    for (var j = 0; j < targetAnchors.length; j++) {
                        var targetUUID = toId + targetAnchors[j];
                        allTargetEndpoints.push(jsPlumb.addEndpoint(toId, targetEndpoint, { anchor: targetAnchors[j], uuid: targetUUID }));
                    }
            };

            _addEndpoints("plumbleft", ["RightMiddle"]);
            _addEndpoints("plumbright", null, ["LeftMiddle"]);

            jsPlumb.connect({ uuids: ["plumbleftRightMiddle", "plumbrightLeftMiddle"] });

        });

    </script>

</head>
<body>
    <div style="height: 100px">
    </div>
    <table >
        <tr >
            <td >
                <div id="leftdiv" style="height: 200px; overflow: auto; ">
                    Here's some longer text<br />
                    Here's some text<br />
                    Here's some text<br />
                    <span id="plumbleft">linked</span><br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                </div>
            </td>
            <td>
                <div id="rightdiv" style="height: 200px; overflow: auto">
                    Here's some longer text<br />
                    Here's some text<br />
                    Here's some text<br />
                    <span id="plumbright">linked</span><br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                    Here's some text<br />
                </div>
            </td>
        </tr>
    </table>

</body>
</html> 
```

我们尝试了各种 z-index 技巧来剪辑/隐藏不应显示的线条（或部分线条），但没有任何运气。谁能建议如何处理它，或建议另一种方法，使用 jsplumb 或其他方式？

提前感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:23:55.567

我从您的代码中创建了一个 jsFiddle：

[http://jsfiddle.net/sporritt/fpbqd/10/](http://jsfiddle.net/sporritt/fpbqd/10/)

..可以做你想做的事。但是您必须使该蒙版 div 绝对定位，这在您的最终 UI 中可能会变得棘手。反正。这可能有点hacky，但可以做到。

# java - int 和乘法符号在这里做什么？

> ID：10677980
> 
> 赞同：-1
> 
> 时间：2012-05-20T23:08:52.430
> 
> 标签：java, int, rectangles

谁能解释整数在矩形中心和矩形障碍物中的用途是什么？我已经明白 int 是正整数或负整数。另外，如果中心和障碍物需要它们，为什么我不需要 Rectangle left 和 Rectangle right 中的任何整数？我还是新手，所以如果有人认为我应该包含更多代码，请告诉我。

```
Rectangle left = new Rectangle(0,0,WIDTH/9,HEIGHT);
Rectangle right = new Rectangle((WIDTH/9)*8,0,WIDTH/9,HEIGHT);

Rectangle center = new Rectangle((int)((WIDTH/9)* 2.5),(int)((HEIGHT/9)*2.5),(int)  
((WIDTH/9)*5),(HEIGHT/9)*4);
Rectangle obstacle = new Rectangle(WIDTH/2,(int)((HEIGHT/9)*7),
WIDTH/10,HEIGHT/9); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T23:10:06.623

Java 是一种强类型语言，这意味着每个变量都有一个[数据类型](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)。但是，通过[多态性](http://en.wikipedia.org/wiki/Polymorphism_%28computer_science%29)，您可以使用来自一种数据类型的信息并将其作为不同的数据类型处理。Java 中的例子是[接口](http://docs.oracle.com/javase/tutorial/java/concepts/interface.html)和[子类](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)。您可以通过隐式或显式转换进行此转换。这就是这里显示的内容。

当您在另一个变量之前使用括号中的原始数据类型或对象名称时，它[会强制转换](http://www.roseindia.net/java/beginners/TypeCasting.shtml)为另一种兼容类型。

只要内部数据兼容，就可以将类型转换为其他类型。例如，如果这里讨论的对象是一个字符串：

```
if(s instanceof String) {
String t = (String)s;
} 
```

# jquery - GameQuery 碰撞检测无法正常工作

> ID：10677983
> 
> 赞同：0
> 
> 时间：2012-05-20T23:09:02.183
> 
> 标签：jquery, jquery-plugins, gamequery

下面是我的代码。碰撞实际上会记录并执行，但前提是您的船位于屏幕的右边缘并且其中一个怪物在您身后。这毫无意义，我快疯了。请帮忙。

演示：[http](http://cosmati.net/biebsattack/test2.html) ://cosmati.net/biebsattack/test2.html 它输出游戏区域下方的任何碰撞，包括导弹和敌人的坐标。另外，请随意大笑，这只是添加了一些风味和装饰的游戏查询教程。;) **编辑**：另外，我知道资产是巨大的。只是为了测试。抱歉加载时间。

```
 $.playground().registerCallback(function () {

            $(".playerMissiles").each(function () {
                //Test for collisions
                var collided = $(this).collision(".enemy,#enemies");
                if (collided.length > 0) {
                    var missilenum = $(this).attr("id");
                    var missilecoords = $(this).css("left") + ", " + $(this).css("top");
                    //An enemy has been hit!
                    collided.each(function () {
                        $("#lblCollisionLog").append(missilenum + " (" + missilecoords + ") collided with " + $(this).attr("id") + " (" + $(this).css("left") + ", " + $(this).css("top") + ") <br>");
                        if ($(this)[0].enemy.damage()) {
                            $(this).setAnimation(enemies[0]["explode"], function (node) { $(node).remove(); });
                            $(this).css("width", 99);
                            $(this).removeClass("enemy");
                        }
                    })
                    $(this).setAnimation(missile["playerexplode"], function (node) { $(node).remove(); });
                    $(this).css("width", 99);
                    $(this).css("height", 99);
                    $(this).css("top", parseInt($(this).css("top")) - 7);
                    $(this).removeClass("playerMissiles");
                }

            });
        }, 10); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T04:25:26.837

我刚刚发现这是因为我使用不推荐的更新 CSS 的方法 (selector.css("left",posx);) 而不是新方法 (selector.x) 来设置 x,y 坐标。

它现在工作正常。

# ajax - 通过 ajax 禁用验证器

> ID：10677984
> 
> 赞同：2
> 
> 时间：2012-05-20T23:09:17.720
> 
> 标签：ajax, jsf, validation

我有一个简单的请求范围实体/ pojo，它有一个枚举和一个字符串作为属性。

```
public Enum Type
{
    None,
    Email,
    Fax;
}

@ManagedBean(name = "testEntity")
@RequestScoped
public class TestEntity
{
    private Type type; //Default = None
    private String address;

    //getter and setter
} 
```

该枚举有一个“电子邮件”字段，用于标识具有相关地址的电子邮件地址。
在 JSF 中，我现在想要启用/禁用与 SelectOneMenu 中当前选择的类型有关的地址 InputText 字段的验证器。

```
<h:form id="formId">
    <p:selectOneMenu id="type" value="#{testEntity.type}>
        <p:ajax event="change" update=":formId:address"/>
        <f:selectItem itemLabel="E-mail" itemValue="Email"/>
        <f:selectItem itemLabel="Fax" itemValue="Fax"/>
    </p:selectOneMenu>
    <p:inputText id="address" value="#{testEntity.address}">
        <f:validator validatorId="emailValidator" disabled="#{testEntity.type != 'Email'}"/>
    </p:inputText>
    <!-- button to call bean method with testEntity as param -->
</h:form> 
```

它不起作用，**验证器永远不会处于活动状态**，但 ajax 调用正在工作，因为我可以在其他字段中看到更改值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T23:35:00.970

不幸的是，这是不可能的。`<f:xxx>`标签是在视图构建期间而不是在视图渲染期间运行的标记处理程序（不是 UI 组件）。因此，如果它在构建视图期间被禁用，它将始终被禁用，直到重新创建视图（例如，通过新请求或非空导航）。

您需要有一个“全局”验证器，它根据`type`属性进一步委托给所需的验证器。

例如

```
<p:inputText ... validator="#{testEntity.validateAddress}" /> 
```

和

```
public void validateAddress(FacesContext context, UIComponent component, Object value) throws ValidatorException {
    if (type == Email) {
        context.getApplication().createValidator("emailValidator").validate(context, component, value);
    }
} 
```

* * *

**更新** [OmniFaces](http://omnifaces.org)最近添加了一个新[`<o:validator>`](http://omnifaces.org/docs/vdldoc/current/o/validator.html)标签，它应该可以解决这个问题，如下所示：

```
<o:validator validatorId="emailValidator" disabled="#{testEntity.type != 'Email'}"/> 
```

[在此处](http://showcase.omnifaces.org/taghandlers/validator)查看展示示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T22:38:28.363

多亏了 BalusC 的帮助，也许有人对我如何解决它感兴趣。

将类型组件 clientId 传递给自定义转换器。

```
<f:attribute name="typeComponentId" value=":formId:type"/> 
```

验证器：

```
public class TestEntity implements Validator
{
    @Override
    public void validate(FacesContext context, UIComponent component, Object value) throws ValidatorException
    { 
        final String typeComponentId = (String)component.getAttributes().get("typeComponentId");

        final UIInput compType = (UIInput)context.getViewRoot().findComponent(typeComponentId);

        if(compType != null)
        {
            final Type type = (Type)compType.getValue();

            if(type == Type.Email)
                new EmailValidator().validate(context, component, value);
        }
    }
} 
```

**编辑：**

不能在 ui:repeat 组件（例如 p:datatable）中工作。

# azure-sql-database - SQL Azure 兼容级别

> ID：10677993
> 
> 赞同：7
> 
> 时间：2012-05-20T23:11:31.240
> 
> 标签：azure-sql-database, sql-server-2012

我以为 SQL Azure 是建立在 SQL Server 2012 之上的，但是新建数据库时的兼容级别是 100（SQL Server 2008 的兼容级别），而不是 110。

```
SELECT compatibility_level FROM sys.databases WHERE name = 'Test'; 
```

我尝试使用我知道的两种方法将其更改为 110：

```
ALTER DATABASE Test SET COMPATIBILITY_LEVEL = 110;
--> Incorrect syntax near 'SET'.

EXEC sp_dbcmptlevel 'Test', 110;
--> Could not find stored procedure 'sp_dbcmptlevel'. 
```

这对我来说是个问题的原因是因为 SQL 2008 不支持跨半球的地理形状，因此如果您缩小地图以查看世界并尝试存储地图的边界，它将失败。很傻对吧？

我认为这在 SQL Azure 中不会成为问题，因为它已在 SQL Server 2012 中修复，但是当我尝试创建一个跨半球的形状时，我收到以下错误：

> Microsoft.SqlServer.Types.GLArgumentException：24205：指定的输入不代表有效的地理实例，因为它超出了一个半球。每个地理实例必须适合单个半球。此错误的一个常见原因是多边形的环方向错误。要创建大于半球的地理实例，请升级 SQL Server 版本并将数据库兼容级别更改为至少 110。

所以它告诉我改变兼容性级别，就像它知道这已经被修复了，但我不知道如何在 SQL Azure 中做到这一点。有人有什么建议可以尝试吗？或者让我知道现在是否不可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T03:05:23.490

很难说当前的 SQL Azure 是基于 SQL Server 2008 还是 2012，但是 2011 年 11 月的更新从 SQL Server 2008 和 2012 中添加了许多新功能。有关数据库引擎版本的更多信息：

更新引擎版本：此版本将基础 SQL Azure 数据库引擎版本从 11.0.1477.26 更新到 11.0.1750.34，因为它在数据中心推出。

以下链接讨论了与 SQL Server 2008 和 SQL Server 2008 R2 相比，SQL Azure 支持和不支持的内容：

[http://msdn.microsoft.com/en-us/library/windowsazure/ff394115](http://msdn.microsoft.com/en-us/library/windowsazure/ff394115)

以下链接添加了有关从 SQL Server 2012 在 SQL Azure 中添加的新可编程性增强功能的更多信息：

[http://msdn.microsoft.com/en-us/library/windowsazure/hh987034.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh987034.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-28T15:59:08.753

更新：2015 年 8 月 Azure Sql Database V12 的默认兼容性级别为 120，使用 ALTER DATABASE SET COMPATIBILITY_LEVEL 语法可能会上升到 130 或下降。

# javascript - Opera 扩展中的注入顺序

> ID：10677996
> 
> 赞同：1
> 
> 时间：2012-05-20T23:12:07.597
> 
> 标签：javascript, browser, opera, opera-extension

假设我有一个在`includes`目录中有 3 个文件的扩展：

```
包括/all.js
包括/one.js
包括/两个.js

```

`two.js`取决于`one.js`并且他们都有“后卫评论”：

```
// ==用户脚本==
// @include http://*.example.com/*
// @include https://*.example.com/*
// ==/用户脚本==

```

`all.js`为每个页面加载。

**我的问题是**：Opera 在页面上以什么顺序处理这些 .js 文件`http://foobar.example.com/`？

有*传言*说这个顺序是按字母顺序排列的，但我找不到这个说法的确切来源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T10:00:13.847

当我们第一次提供用户 javascript 支持时，我注意到一些用户开始开发库并希望控制加载/执行顺序。他们中的一些人假设顺序是按字母顺序排列的（当时它是随机的，可能是文件创建时间等），并且会在他们的库文件名前加上**A-**以使它们首先运行。所以我告诉开发人员“让我们实现人们所期望的并按字母顺序运行脚本”。

这可能是我的错，这既没有记录也没有测试..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T23:19:37.160

> 有传言说这个顺序是按字母顺序排列的，但我找不到这个说法的确切来源。

在文档中找不到任何确认，但我的实验表明内容脚本实际上是按字母顺序加载的。

# git - 在 Windows 7 中使用 GitBash 进行提示

> ID：10677998
> 
> 赞同：3
> 
> 时间：2012-05-20T23:12:34.570
> 
> 标签：git, windows-7, ssh-keys

我已经从[这个 Google 代码页](http://code.google.com/p/msysgit/downloads/list)下载并安装了适用于 Windows 的 Git，并按照 [这个优秀的教程](http://help.github.com/win-set-up-git/)在我的 Windows 7 机器上安装 Git。我还正确地建立了我的 SSH 密钥并将它们链接到我的 Github 帐户。我可以使用 Gitbash 成功克隆存储库，它可以验证我的密钥设置是否正确。但是，当从开始菜单运行 Git Bash 时，我得到一个闪烁的光标并且看不到提示。

在此先感谢您的帮助。

PS关于stackoverflow的第一个问题:)抱歉有任何错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:04:18.737

刚刚从 github 团队发布的是[github for windows](https://github.com/blog/1127-github-for-windows)。我认为这会让你更接近让 git 和 windows 一起工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T07:43:16.327

为避免当前环境出现任何问题，请尝试解压缩 mysysgit 的可移植版本：

[PortableGit-1.7.10-preview20120409.7z](http://code.google.com/p/msysgit/downloads/detail?name=PortableGit-1.7.10-preview20120409.7z&can=2&q=)

并启动（或创建快捷方式）：

```
<path to git1.7.10>/git-bash.bat 
```