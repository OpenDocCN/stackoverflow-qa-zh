# StackOverflow 问答 12127000-12127999

# c# - Autofac - InstancePerHttpRequest 与 InstancePerLifetimeScope

> ID：12127000
> 
> 赞同：71
> 
> 时间：2012-08-26T01:29:06.983
> 
> 标签：c#, asp.net-mvc-3, dependency-injection, autofac

两个范围有什么区别？

我`Module`在每一层（存储库、服务、MVC 应用程序）中构建（s），但是为了让`InstancePerHttpRequest`你需要 Autofac.Mvc 程序集。

我应该在我的存储库和服务层中使用哪个范围？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2014-04-29T05:17:08.430

`InstancePerHttpRequest`并且`InstancePerApiRequest`基本上做同样的事情——你为每个离散的 Web 请求获得一个服务实例。我将使用`InstancePerHttpRequest`其余的答案，但请记住，这两者是可以互换的。

`InstancePerLifetimeScope`意味着将为每个需要您的服务的生命周期范围创建一个新的服务实例。每个 Web 请求都有自己的新生命周期范围，因此在实践中，这两个请求通常会做完全相同的事情。

唯一真正的区别在于，如果您注册了一项服务，`InstancePerHttpRequest`并且您从另一项注册为`SingleInstance`. 在这种情况下：

*   `SingleInstance`组件位于根**范围**内
*   该`InstancePerHttpRequest`组件位于名为“AutofacWebRequest”的范围内，它是根范围的*子范围*

Autofac 不允许从子范围解析 - 所以本质上，`SingleInstance`服务找不到`InstancePerHttpRequest`服务。

但是，如果在这种情况下您使用`InstancePerLifetimeScope`（而不是`InstancePerHttpRequest`），那么您的服务将很好地解决。

我写了一篇相当详尽的文章，其中包含可下载的代码，试图详细解释所有这些 -[请参阅此处](https://web.archive.org/web/20170111185216/http://decompile.it/blog/2014/03/13/webapi-autofac-lifetime-scopes/)。引用文章：

> 这里一个常见的误解是，在 WebAPI 应用程序中使用 InstancePerLifetimeScope 注册组件意味着您的组件位于 Web 请求的范围内——即“生命周期”是指“Web 请求的生命周期”。正如你在这里看到的，这是错误的。
> 
> **组件的生命周期由解析它的范围决定。**
> 
> 由于 SingletonResolvable 从根范围解析其令牌，因此该令牌实例位于根范围内，而不是 Web 请求的范围内。我之前说过，但我再说一遍：这个令牌将一直存在，直到整个应用程序被处理掉（例如，IIS 工作进程被回收）。任何从根范围请求 ScopeToken 的东西都将被引用到该令牌。

希望有所帮助 - 我很欣赏这个问题现在已经很老了，但它仍然非常相关！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-26T04:57:43.850

应用程序中唯一能够完全决定对象生命周期的地方是组合根。

在这种情况下，您会遇到冲突——您有一个通用模块，它不应该访问 MVC 集成提供的扩展方法——但您需要访问它才能正确管理生命周期。在这种情况下，如果您的模块可以提供合理的默认值，例如`InstancePerLifetimeScope`，那么这就是我在模块级别所做的。然后，您让组合根覆盖该行为。在这种情况下，组合根会将生命周期更改为`InstancePerHttpRequest`. 由于最后一次注册将覆盖之前的注册，因此您应该处于良好状态。

实际上，出于以下几个原因，我已经不再创建与包含给定层的程序集共存的模块：

1.  它引入了对 Autofac 的依赖，除了在我的组合根目录下我不想要它
2.  它表明模块知道应该如何管理它的生命周期，这通常不是真的。如果是这样，为什么不提供提供生命周期管理的工厂或其他类？

相反（在足够大的项目中），我在组合根级别创建模块，因为在这个级别我清楚地知道它们应该如何连接在一起。有时我会创建一个`Ioc`包含模块并充当默认组合根的程序集——但这通常在“真正的”组合根（例如，拉入程序集的控制台或 MVC 应用程序`Ioc`）处被覆盖。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-26T01:38:00.477

在 Autofac 中*，每个生命周期*范围是使用嵌套生命周期创建自定义范围的通用方法。

Using`InstancePerLifetimeScope`为您提供*每个请求*范围，这增加了单个请求的组件生命周期和`InstancePerLifetimeScrope`该组件的内部使用。

在您需要的任何地方使用`InstancePerLifetimeScope`，或者如果`Autofac.Integration.Mvc`在您的服务层中引用程序集是一个问题 - 在请求和使用的每个开始处手动创建嵌套范围`InstancePerLifetimeScope`。

# android - android - 如果原始类不是 Activity，如何根据意图切换屏幕？

> ID：12127003
> 
> 赞同：0
> 
> 时间：2012-08-26T01:30:09.633
> 
> 标签：android, android-intent, android-activity

通常如果我想切换屏幕，我会这样做：

```
Intent myIntent = new Intent(CurrActivity.this, NextActivity.class);
CurrActivity.this.startActivity(myIntent); 
```

但我有一种情况，我想在普通班上这样做。实际上它是一个抽象类。它被命名为 PurchaseObserver，它是 Android 计费设置的一部分。

是否可以从此类中更改屏幕？类似于我上面发布的意图代码的东西？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T01:41:37.550

当您实例化类时，`Context`在构造函数中传递 a 并使用它来启动 Activity 使用`startActivity(Intent)`

# ios - 在 IOS 中从 iPhone 中删除资产（图片或视频）

> ID：12127004
> 
> 赞同：9
> 
> 时间：2012-08-26T01:30:17.203
> 
> 标签：ios, tableview, assets, alassetslibrary

我正在开发一个 Iphone 应用程序，我可以使用 Assetslibrary 枚举资产并将它们加载到表格视图中。用户可以在应用程序中删除一行（图片/视频），但如何直接从我的应用程序更新 Iphone 相册？否则在刷新时，tableview 将重新加载之前删除的资产。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-06-23T09:46:45.303

在 ios8 中可以使用照片框架删除照片

请查看照片框架的文档

如需删除资产，请参阅 PHAssetChangeRequest

```
+ (void)deleteAssets:(id<NSFastEnumeration>)assets 
```

where是要删除`assets`的对象数组。`PHAsset`

+

要删除集合，请参阅 PHAssetCollectionChangeRequest

```
+ (void)deleteAssetCollections:(id<NSFastEnumeration>)assetCollections 
```

[https://developer.apple.com/documentation/photos/phassetchangerequest/1624062-deleteassets](https://developer.apple.com/documentation/photos/phassetchangerequest/1624062-deleteassets)
[https://developer.apple.com/documentation/photos/phassetcollectionchangerequest/1619453-deleteassetcollections](https://developer.apple.com/documentation/photos/phassetcollectionchangerequest/1619453-deleteassetcollections)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-01-19T08:54:38.203

正如 Ted 所说，这现在可以在 iOS 8 中使用 Photos 服务。其实挺干净的。您需要向照片库提交更改请求。这是一个例子。

```
[[PHPhotoLibrary sharedPhotoLibrary] performChanges:^{
    [PHAssetChangeRequest deleteAssets:arrayOfPHAssets];
} completionHandler:^(BOOL success, NSError *error) {
    NSLog(@"Finished deleting asset. %@", (success ? @"Success." : error));
}]; 
```

确保您已导入照片，并获得用户的授权。（您可能已经这样做了以显示图像）

PHAssetchangeRequest - deleteAssets [https://developer.apple.com/documentation/photos/phassetchangerequest/1624062-deleteaassets](https://developer.apple.com/documentation/photos/phassetchangerequest/1624062-deleteassets) PHPhotoLibrary 类 - authorizationStatus [https://developer.apple.com/documentation/photos/phphotolibrary/1620745-authorizationstatus](https://developer.apple.com/documentation/photos/phphotolibrary/1620745-authorizationstatus)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-23T11:21:03.513

它迟到了，但对其他用户来说会有所帮助。
我们知道只有照片应用程序可以删除图像。在这种情况下，我通过 alassets 从照片中检索所有图像，在自定义图库中查看它们，让用户可以选择从资产中选择多个图像以将它们保存在电话目录中。接下来我使用我的应用程序库而不是照片库。我已经在应用程序中提供了选项，可以随时在应用程序中将图像从照片导入应用程序库（这是图像的文档目录文件夹）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-03T19:02:27.737

在此处添加一个旧问题的答案，因为我们经常被要求将屏幕截图预防作为数据丢失预防 (DLP) 解决方案的一部分。您可以 (a) 注册屏幕截图通知并 (b) 要求用户在它发生时删除，但没有办法静默或秘密地执行此操作。这是一个完整的工作代码示例：

```
func applicationDidBecomeActive(application: UIApplication) {
    registerForScreenShotNotifications()
}

func registerForScreenShotNotifications() {
   NSNotificationCenter.defaultCenter().addObserverForName(UIApplicationUserDidTakeScreenshotNotification, object: nil, queue: NSOperationQueue.mainQueue()) { (notification) in
        print("Yep they took a screenshot \(notification)")

        let assetToDelete = self.getLastImage()
        if  let assetToDelete = assetToDelete
        {
            PHPhotoLibrary.sharedPhotoLibrary().performChanges({
                PHAssetChangeRequest.deleteAssets([assetToDelete])
                }, completionHandler: { (success, error) in
                    print("Success \(success) - Error \(error)")
            })

        }
    }
}

// NOTE : You should ask for permission to access photos before this
func getLastImage() -> PHAsset? {
    let fetchOptions = PHFetchOptions()
    fetchOptions.sortDescriptors = [ NSSortDescriptor(key: "creationDate", ascending: true) ]
    let fetchResult = PHAsset.fetchAssetsWithMediaType(.Image, options: fetchOptions)
    let newestAsset = fetchResult.lastObject

    return newestAsset as! PHAsset?
} 
```

结果是这样的：

[![ScreenShot Remover 示例代码结果](../Images/8d8ac5d156bc81de2e044b1797ffb2a4.png)](https://i.stack.imgur.com/Peiyw.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T02:41:55.613

[https://stackoverflow.com/a/11058934/300292](https://stackoverflow.com/a/11058934/300292)的可能重复。简单的答案：你不能。照片应用程序是唯一可以删除资产的地方。这可能是一件好事——你不希望任何任性的应用程序都能够删除你所有的照片，对吗？

# python - Google App Engine - 无法正确接收 GZIP HTML 文件

> ID：12127027
> 
> 赞同：0
> 
> 时间：2012-08-26T01:35:52.287
> 
> 标签：python, google-app-engine, gzip, urllib2, urlfetch

Python 和 Google App Engine 专家，

我想检索位于此链接的道明银行抵押贷款利率网站：

“http://tdbank.mortgagewebcenter.com/Default.asp”

今天晚上我通过教程学习了 Python 和 Google App Engine，但我一直被我认为可能是 GZIP 问题所困扰。

理想情况下，我希望有人修复我在下面粘贴的代码。或者提供正确的代码（如果这样更容易）以成功接收该网页并能够在 python/google 应用程序引擎中解析它。

尝试 1 - URLFETCH

```
import webapp2
import gzip

import StringIO

from google.appengine.api import users
from google.appengine.api import urlfetch
from BeautifulSoup import BeautifulSoup

class MainPage(webapp2.RequestHandler):
    def get(self):
        url = "http://tdbank.mortgagewebcenter.com/Default.asp"
        result = urlfetch.fetch(url=url,headers={'User-Agent': 'Mozilla/5.0',
                                                 'Accept': 'text/html',
                                                 'Accept-Language': 'en-us,en',
                                                 'Accept-Encoding': 'gzip',
                                                 'Connection': 'keep-alive'})
        f = StringIO.StringIO(result.content)
        c = gzip.GzipFile(fileobj=f)
        content = c.read()
        self.response.out.write(content)

app = webapp2.WSGIApplication([('/', MainPage)],
                              debug=True) 
```

尝试 2 - URLLIB2

```
import cgi
import webapp2
import gzip
import StringIO
import urllib2
import httplib

from BeautifulSoup import BeautifulSoup

class MainPage(webapp2.RequestHandler):
    def get(self):
        httplib.HTTPConnection.debuglevel = 1
        url = urllib2.Request('http://tdbank.mortgagewebcenter.com/Default.asp')
        url.add_header('Accept-encoding', 'gzip')
        url.add_header('User-Agent', 'Mozilla/5.0')
        opener = urllib2.build_opener()
        f = opener.open(url)
        compresseddata = f.read()
    compressedstream = StringIO.StringIO(compresseddata)
        c = gzip.GzipFile(fileobj=compressedstream)
        content = c.read()
        self.response.out.write(content)

app = webapp2.WSGIApplication([('/', MainPage)],
                              debug=True) 
```

YAML 文件：

```
application: fimrates
version: 2
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /.*
script: fimrates.app 
```

在这两种情况下，我的浏览器都会被重定向到

```
http://localhost:8080/Default.asp?bhjs=1&bhqs=1 
```

如果我将尝试读取的 URL 更改为另一个网页，例如 www.google.com，则输出会正确打印。

提前感谢您的帮助，我真的很感激。

-托德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T07:57:38.790

您发布的网址在 javascript 中进行了重定向。获得最终页面的唯一方法是模拟浏览器，这在 GAE 上是 IMO 不可能的。

我通过下载了 html `curl -L http://tdbank.mortgagewebcenter.com/Default.asp`，它给了我“不支持的浏览器”。这意味着该页面会在 javascript 中检查浏览器的类型。

[http://tinypic.com/r/aa7tqd/6](http://tinypic.com/r/aa7tqd/6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T22:42:41.457

在您的 fetch 命令中，尝试添加参数“follow_redirects=True”。

# git - git：如何在多台 PC 之间正确共享本地副本

> ID：12127029
> 
> 赞同：2
> 
> 时间：2012-08-26T01:36:02.880
> 
> 标签：git

我提取了一些公共存储库，在这里和那里进行了一些更改。我将它们提交到我的本地副本。我经常从远程拉取以从公共回购中获取更改。有时，我处理来自不同 PC 的本地副本，我需要在 PC 之间移动整个源代码，以便它们共享完全相同的更改。有几次我搞砸了复制并丢失了一些本地更改。所以我的问题是：如何在其中一台 PC 上设置某种本地 git 服务器，以便我仍然可以从该公共存储库中提取更改并将我的本地更改提交到我的本地 git 服务器，以便我能够同步我在多台 PC 之间的工作没有复制完整的源代码三？

我使用 Windows

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T01:42:38.057

请记住，git 存储库最终只是磁盘上的一组文件。

您可以将您的主要本地 git 存储库放在网络共享上，然后在同一 LAN 上的其他计算机上使用 repos 推送/拉取。

过去，这对我来说效果很好（服务器上的主要存储库，笔记本电脑上的其他存储库，台式机等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T01:42:17.667

您也可以在任何流行的 git 托管程序（GitHub、gitorious）上托管您的项目分支，并将它们添加为新的远程。然后将此存储库用作您的基础。

你还应该尝试让你的补丁回到主线。这完全可以保护您的痛苦并帮助他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T01:38:32.167

您可以在 Dropbox 中设置您的 git 存储库，这样所有更改都将在您拥有的所有计算机之间共享

# oauth - ie10 uri 重定向不起作用，Win8 RTM 桌面

> ID：12127032
> 
> 赞同：1
> 
> 时间：2012-08-26T01:36:47.630
> 
> 标签：oauth, windows-8, internet-explorer-10

不是（fka Metro）风格的 IE10，而是桌面版。我有一个访问 Dropbox 的应用程序。OAuth 适用于 IE9 和其他浏览器。但是，在 Win8RTM 上，在我登录 Dropbox 并批准我的应用程序访问后，IE10 不接受 URI 重定向。一旦我批准访问，Dropbox 会返回一个 URI 来打开我的应用并将新令牌传递给它。在 IE10 中，它失败：错误无法处理 https....

我将默认浏览器更改为最新的 Chrome，它运行良好。我什至将 Dropbox 添加到我的受信任站点列表中。在我的 Win7 测试盒上的 IE9 中运行良好。这是我的测试版的链接。只需解决此设置问题并为按钮制作图形并完成。

[https://dl.dropbox.com/u/17111851/SMARTLIST.ZIP](https://dl.dropbox.com/u/17111851/SMARTLIST.ZIP)

# java - java.lang.reflect.InvocationTargetExpection

> ID：12127033
> 
> 赞同：1
> 
> 时间：2012-08-26T01:37:05.267
> 
> 标签：java

我在现场运行 Java Applet 时遇到问题。Applet 本身可以从 jar 文件本地运行，并且在编译时没有错误或警告。我什至成功地签署了它，但是当我尝试从网站运行它时，我总是得到 java.lang.reflect.InvocationTargetExpection 。任何想法我做错了什么？下面是小程序源代码：

```
 import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import java.io.*; 
public class test {

    private static void createAndShowGUI()  {

        JFrame frame1 = new JFrame("JAVA");
        frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JButton button = new JButton(" Remote Desktop <<");
        //Add action listener to button
        button.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e)
             { 
                try   {
                Process p = Runtime.getRuntime().exec("C:\\Windows\\System32\\mstsc.exe"); //calls cmd.exe and prints hello world to console
                BufferedReader in = new BufferedReader( 
                new InputStreamReader(p.getInputStream())); 
                String line = null; 
                while ((line = in.readLine()) != null) { 
                System.out.println(line); 
                } 
                } catch (IOException l) { 
                l.printStackTrace(); 
                } 
             }

        });      

        frame1.getContentPane().add(button);
        frame1.pack();
        frame1.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI();
            }
        });
    }
} 
```

这里是来自 java 控制台的输出：

```
java.lang.UnsupportedClassVersionError: button : Unsupported major.minor version 51.0
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(Unknown Source)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Exception: java.lang.UnsupportedClassVersionError: button : Unsupported major.minor version 51.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T10:39:33.320

1.  您已经使用 JVM 版本 7 编译了您的代码，但是您正在使用旧版本的 JVM（例如 1.6）运行您的小程序。
2.  您创建了一个 Java 应用程序（使用 main 方法），而不是 Applett。要创建 Applett，您的类需要扩展`Applett`或`JApplet`.

# php - 加载导航链接时出现上一个/下一个导航问题

> ID：12127039
> 
> 赞同：0
> 
> 时间：2012-08-26T01:37:51.150
> 
> 标签：php, sql, navigation, request

我之前使用过这段代码没有任何问题，但是......现在我似乎无法在按下上一个/下一个导航时加载页面请求，如果你能看到我出错的地方是一个帮助。

```
<?php
include 'config.php';

$db = mysql_connect($host, $username, $password);
    mysql_select_db($db_name,$db);

        $sql = "SELECT u_id FROM users";
        $query = mysql_query($sql,$db);
        $total_results = mysql_num_rows($query);
        $limit = "5"; //limit of archived results per page.
        $total_pages = ceil($total_results / $limit); //total number of pages
if (empty($page))
    {
        $page = "1"; //default page if none is selected
    }
$offset = ($page - 1) * $limit; //starting number for displaying results out of DB

    $query = "SELECT * FROM users ORDER BY u_id LIMIT $offset, $limit";
    $result = mysql_query($query);
//This is the start of the normal results...

    while ($row = mysql_fetch_array($result))
        {
        ?>
<HR>
Username : <B><?echo $row['uname'] ?></B><BR>
user Message: <?echo $row['umess'] ?> 

<BR>

<?
        }
        mysql_close();

// This is the Previous/Next Navigation stuff having issue with

echo "<font face=Verdana size=1>";
echo "Pages:($total_pages)&nbsp;&nbsp;"; // total pages
if ($page != 1)
{
echo "<a href=?&page=1><< First</a>&nbsp;&nbsp;&nbsp;"; // First Page Link
$prevpage = $page - 1;
echo "&nbsp;<a href=?page=$prevpage><<</a>&nbsp;"; // Previous Page Link
}
        if ($page == $total_pages) 
            {
                $to = $total_pages;
            } 
        elseif ($page == $total_pages-1) 
            {
                $to = $page+1;
            } 
        elseif ($page == $total_pages-2) 
            {
                $to = $page+2;
            } 
        else 
            {
                $to = $page+3;
            }
        if ($page == 1 || $page == 2 || $page == 3) 
            {
                $from = 1;
            } 
        else 
            {
                $from = $page-3;
            }

for ($i = $from; $i <= $to; $i++)

    {
    if ($i == $total_results) $to=$total_results;
    if ($i != $page)
        {
        echo "<a href=?showold=yes&page=$i>$i</a>";
        }
    else
        {
        echo "<b><font face=Verdana size=2>[$i]</font></b>";
        }
    if ($i != $total_pages)
        echo "&nbsp;";
    }
if ($page != $total_pages)
{
$nextpage = $page + 1;
echo "&nbsp;<a href=?page=$nextpage>>></a>&nbsp;"; // Next Page Link
echo "&nbsp;&nbsp;&nbsp;<a href=?page=$total_pages>Last >></a>"; // Last Page Link
}
echo "</font>";

?> 
```

测试运行后，您可以看到第一页请求很好，直到您单击下一步或页码它会一直返回到第一页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T01:45:53.467

代替

```
if (empty($page))
{
    $page = "1"; //default page if none is selected
} 
```

尝试 ：

```
if (isset($_GET['page']))
{
$page = $_GET['page'];
}
else
{
$page = 1;
} 
```

# c# - 2 种类型的点击事件相同的代码 2 导致 winrt

> ID：12127043
> 
> 赞同：1
> 
> 时间：2012-08-26T01:38:11.353
> 
> 标签：c#, windows-8, microsoft-metro, windows-runtime, winrt-xaml

奇怪的行为！当我点击地铁应用程序上的按钮时，一切正常，但是当我点击进入（KB 上的按钮）时，唯一发生的事情就是一切都被清除了！

这失败了

```
private void TextBox_KeyDown_1(object sender, KeyRoutedEventArgs e)
    {
        if (e.Key == VirtualKey.Enter)
        {
            textBlock.Text = textBox1.Text;
           // textBox1.Text = "";
        }
    } 
```

这按预期工作

```
 private void Send_Click(object sender, RoutedEventArgs e)
    {

        textBlock.Text = textBox1.Text;
        textBox1.Text = "";
    } 
```

我究竟做错了什么 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:52:55.680

最好是在文本框上按 Enter 时，它实际上会模拟单击按钮，以确保两个操作实际上是相同的。

```
private void TextBox_KeyDown_1(object sender, KeyRoutedEventArgs e)
{
    if (e.Key == VirtualKey.Enter)
    {
        this.Send.PerformClick();
    }
}

private void Send_Click(object sender, RoutedEventArgs e)
{
    textBlock.Text = textBox1.Text;
    textBox1.Text = "";
} 
```

此外，正如克里斯所提到的，即使在这种情况下，您也不应该真正处理 KeyDown：您可以将表单的 AcceptButton 属性设置为发送按钮，这意味着当按下 Enter 时，按钮将被按下——即使没有专注。这类问题是使用 AcceptButton 属性的一个很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T22:32:45.300

我认为您正在尝试在用户按 Enter 时处理焦点。这是应用程序中的常见要求。至于你的奇怪行为，我无法解释。但我也不确定解释它与解决问题一样重要。因此，我可以向您展示处理输入和焦点的简单实现：

```
<StackPanel>
    <TextBlock FontSize="20" Foreground="White">One</TextBlock>
    <TextBox x:Name="T1" Width="1000" Height="100" KeyDown="T1_KeyDown_1" />
    <TextBlock FontSize="20" Foreground="White">Two</TextBlock>
    <TextBox x:Name="T2" Width="1000" Height="100" KeyDown="T2_KeyDown_1" />
</StackPanel> 
```

和

```
private void T1_KeyDown_1(object sender, KeyRoutedEventArgs e)
{
    if (e.Key == Windows.System.VirtualKey.Enter)
        T2.Focus(Windows.UI.Xaml.FocusState.Programmatic);
}

private void T2_KeyDown_1(object sender, KeyRoutedEventArgs e)
{
    if (e.Key == Windows.System.VirtualKey.Enter)
        T1.Focus(Windows.UI.Xaml.FocusState.Programmatic);
} 
```

结果是完美的焦点控制。

# asp.net-mvc-3 - ASP.Net MVC 架构 - 缺少一层？

> ID：12127047
> 
> 赞同：1
> 
> 时间：2012-08-26T01:39:01.183
> 
> 标签：asp.net-mvc-3, repository-pattern, unit-of-work, service-layer

我在这个 ASP.NET MVC 应用程序上使用 Entity Framework/Repository-UnitOfWork/Service 层方法，它工作得很好，但似乎为了保持控制器薄而缺少一个层。

让我们以一个用户认证场景为例：

1)`AuthenticationController`需要 a`IAuthenticationService`反过来需要 a`IUnitOfWork`和`IRepository<User>`（我使用的是通用存储库）。

2）在控制器中，我只想关注服务对用户的身份验证：

```
if (userService.AuthenticateUser(model.userName, model.password)) {
    FormsAuthentication.SetCookie(...);
    return RedirectToAction(...);
}

return View(model); 
```

有人会说这在控制器中逻辑太多了吧？因此，如果您愿意，我们似乎可能需要一个应用程序管理器：

```
if (appManager.AuthenticateUser(model.userName, model.password)) {
    // Here the app manager calls the service???
    return RedirectToAction(...);
} 
```

我试图让我的域服务与消费应用程序无关，以便我可以在 MVC、WinForms、控制台、WPF、WCF 等上使用它们。

我的服务层只返回域对象，我需要一个将它们转换为视图模型的地方，但我想把它排除在控制器之外。

对此的任何输入都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:17:30.173

通常，人们会使用 AutoMapper 之类的东西将您的域对象映射到 ViewModel。然后，您只有一个包装服务层的 Map 调用。几乎没有理由只为对象映射引入一个全新的层。

# php - 更新查询where子句mysql时的语法错误

> ID：12127049
> 
> 赞同：0
> 
> 时间：2012-08-26T01:41:20.740
> 
> 标签：php, mysql

```
if(isset($_POST['Update'])) {
$placename = $_POST['placename'];
$description = trim(addslashes($_POST['description']));
$hotel = $_POST['hotel'];
$transport = $_POST['transport'];
$map = $_POST['map'];
$sqlp = "UPDATE places SET placename = $placename, description = $description, hotel = $hotel, transport = $transport, map = $map WHERE place_id = ". $sPlace['place_id'];
connection();
if(mysql_query($sqlp)) {
    echo "Successfully Updated";
} else {
    echo mysql_error();
}
} 
```

错误消息如下 -

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 ' 附近使用的正确语法
> 
> `map`= 地图 WHERE place_id = 54' 在第 1 行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T01:49:53.857

您在该代码中的错误是您没有在变量周围添加引号，它应该是这样的：

```
$query = "UPDATE `table` SET `name`='".mysqli_real_escape_string($_POST['name'])."' WHERE `id`=1"; 
```

但是请尝试将 PDO 与事务一起使用，因为您将能够调试任何错误并且您不必担心 SQL 注入。

试试这个：（你会看到错误，如果不正常，它会回滚）

```
$db = new PDO('mysql:host=localhost;dbname=databaseName', 'username', 'password', array(PDO::ATTR_EMULATE_PREPARES => false));

$placename = $_POST['placename'];
$description = trim(addslashes($_POST['description']));
$hotel = $_POST['hotel'];
$transport = $_POST['transport'];
$map = $_POST['map'];

try {

    $db->beginTransaction();

    $stmt = $db->prepare("UPDATE `places` SET `placename`=:placename, `description`=:description, `hotel`=:hotel, `transport`=:transport, `map`=:map WHERE `place_id`=:place_id");
    $stmt->execute(array(':placename' => $placename, ':description' => $description, ':hotel' => $hotel, ':transport' => $transport, ':map' => $map, ':place_id' => $sPlace['place_id']));

    $db->commit();

} catch(PDOException $ex) {
    $db->rollBack();
    echo $ex->getMessage();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T01:44:53.540

> 您的 SQL 语法有错误...' **map = map** WHERE place_id = 54' at line 1

`map = map`<-- 无效。右侧应该是一个 sql 值（带引号的字符串、数字等）。也许`map = 'map'`（引用值）是预期的结果？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T01:51:52.730

您看到的问题已经出现，因为您的字符串文字都没有被引用，因此值中的逗号`$transport`被评估为 SQL`SET`子句之间的分隔符，因此会导致您看到的语法错误。

你应该引用你的字符串文字——或者更好的是，使用[参数化的语句](https://stackoverflow.com/a/60496/623041)，这样你的变量就不会被 SQL 评估（这避免了所有形式的 SQL 注入攻击）。

# matlab - Matlab 和山狮

> ID：12127051
> 
> 赞同：0
> 
> 时间：2012-08-26T01:41:46.530
> 
> 标签：matlab, osx-mountain-lion

我有 2012a 版的 Matlab，最近将我的 Mac OS 升级到了 Mountain Lion。

按照官方说明[http://www.mathworks.com/support/solutions/en/data/1-IXBVKD/](http://www.mathworks.com/support/solutions/en/data/1-IXBVKD/) Mac 现在安装了 XQuartz。

尽管如此，当我尝试通过单击图标或打开 xterm 窗口并键入 .../bin/matlab 来启动 matlab 时，我没有成功启动。

在这两种情况下，Matlab 图标都会在 Dock 上显示片刻，然后关闭。

有什么建议么？

================

（以下帖子是关于同一主题的，但问题的种类不同：

[山狮上的 Matlab 不工作 -](https://stackoverflow.com/questions/11781400/matlab-on-mountain-lion-not-working)

[让 Matlab 的 mex 在 Mountain Lion 上与 xcode 4.4 一起工作](https://stackoverflow.com/questions/11745881/getting-matlabs-mex-to-work-with-xcode-4-4-on-mountain-lion) ）

# xcode - 在 Xcode 4 中隐藏主面板？

> ID：12127056
> 
> 赞同：0
> 
> 时间：2012-08-26T01:43:21.597
> 
> 标签：xcode, xcode4, assistant

在 Xcode 4 中隐藏助手编辑器很容易，但您只能隐藏第二个面板。有没有办法让辅助编辑器成为主编辑器，并在一次击键中隐藏第二个面板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:55:53.477

不，您不能隐藏主编辑器。但是，您可以在 Xcode 的首选项中添加快捷方式来隐藏和显示助手编辑器。

![在此处输入图像描述](../Images/d0bb49ad486be5e7471176ab999b7ac2.png)

# winforms - 从 RichTextBox 中的文本中清除 SelectionBackColor

> ID：12127063
> 
> 赞同：0
> 
> 时间：2012-08-26T01:46:17.800
> 
> 标签：winforms, richtextbox, textselection, backcolor

> **可能重复：**
> [RichTextBox 语法实时高亮--禁用重绘](https://stackoverflow.com/questions/3282384/richtextbox-syntax-highlighting-in-real-time-disabling-the-repaint)

我正在使用 RichTextBox 控件来查找和更改某些单词的 SelectionBackColor 属性。单词不是固定的，所以基本上具有不同背景颜色的文本会有所不同。

在将其应用于新单词之前，我已经尝试了两种从先前文本中清除 BackColor 的方法：

*   选择所有文本并将 SelectionBackColor 设置为 Controls BackColor。
*   将文本保存为字符串，然后将其放回 RichTextBox 以清除其格式。

虽然这两种方法都有效，但当控件中有大量文本时会出现问题。对于第一种方法，所有文本都被选中（你可以注意到它几毫秒）变得更加清晰，这变得很烦人，因为这发生在 TextChanges 事件中，所以基本上每个被删除/添加的字母都会触发这个。至于第二种方法，它不像第一种那么明显，但由于文本被删除然后插入回来，滚动变得有点奇怪，因为即使在使用 .ScrollToCaret() 之后，滚动条也不完全是它之前的样子SelectionBackColor 清除。

感觉应该有更好的方法来清除现有的 SelectionBackColor 而不会出现所有这些问题。特别是在这种情况下，因为它必须在 TextChanged 事件中进行清理。

等待你的想法。提前致谢。

编辑：您可以在下面看到我在上面提到的第一个示例中使用的方法（全选）。

```
private void ClearSelection(RichTextBox rtb)
{
    if (rtb.Text.Length > 0)
    {
        int currentIndex = rtb.SelectionStart;
        rtb.SelectAll();
        rtb.SelectionBackColor = Color.White;
        rtb.SelectionLength = 0;
        rtb.SelectionStart = currentIndex;
    }
}

private void richTextBox1_TextChanged(object sender, EventArgs e)
{
    if (!_working)
    {
        ClearSelection(richTextBox1);
    }
} 
```

_working bool 只是为了确保在程序更改某些单词的颜色时不会触发该方法，以便仅在用户更改文本时触发该方法。

**Edit2：**对于那些感兴趣的人，[RichTextBox 中重置 RTF 的解决方案？](https://stackoverflow.com/questions/1268009/reset-rtf-in-richtextbox)似乎可以解决问题。我会避免被投票为重复的那个（出于某种奇怪的原因），因为它会产生更多的图形问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T12:26:56.737

Have you tried using double buffering? Maybe something like:

```
richTextBox1.SetStyle( ControlStyles.AllPaintingInWmPaint | ControlStyles.UserPaint | ControlStyles.DoubleBuffer,true); 
```

# exception - 为什么这种情况总是发生？Solr OutOfMemoryError 超出 GC 开销限制

> ID：12127064
> 
> 赞同：9
> 
> 时间：2012-08-26T01:46:30.287
> 
> 标签：exception, solr, jetty

我正在为我的 Solr 应用程序进行负载测试。该索引拥有超过 2 亿份文档。我使用默认的 Jetty 服务器并将最大 JVM 内存设置为 4GB。为了测试我的应用程序，我编写了 5000 个文本查询并将它们一一发送给 Solr。但是，大约 110 次查询后，Jetty 容器会引发异常。

为什么会这样？我该如何解决？

```
SEVERE: java.lang.OutOfMemoryError: GC overhead limit exceeded
    at org.apache.lucene.util.AttributeImpl.clone(AttributeImpl.java:196)
    at org.apache.lucene.util.AttributeSource$State.clone(AttributeSource.java:116)
    at org.apache.lucene.util.AttributeSource$State.clone(AttributeSource.java:119)
    at org.apache.lucene.util.AttributeSource.captureState(AttributeSource.java:349)
    at org.apache.solr.highlight.TokenOrderingFilter.incrementToken(DefaultSolrHighlighter.java:595)
    at org.apache.lucene.search.highlight.OffsetLimitTokenFilter.incrementToken(OffsetLimitTokenFilter.java:43)
    at org.apache.lucene.analysis.CachingTokenFilter.fillCache(CachingTokenFilter.java:78)
    at org.apache.lucene.analysis.CachingTokenFilter.incrementToken(CachingTokenFilter.java:50)
    at org.apache.lucene.search.highlight.Highlighter.getBestTextFragments(Highlighter.java:225)
    at org.apache.solr.highlight.DefaultSolrHighlighter.doHighlightingByHighlighter(DefaultSolrHighlighter.java:468)
    at org.apache.solr.highlight.DefaultSolrHighlighter.doHighlighting(DefaultSolrHighlighter.java:379)
    at org.apache.solr.handler.component.HighlightComponent.process(HighlightComponent.java:116)
    at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:194)
    at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
    at org.apache.solr.core.SolrCore.execute(SolrCore.java:1368)
    at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:356)
    at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:252)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
    at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)
    at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-17T01:17:51.030

显然 4Gb RAM 非常低，无法处理 200M 索引的负载测试。我们在平均文档大小为 1K 的 300M 文档上对 Solr 4.2 进行了性能测试。目标是找出最小的机器配置，我们可以在该配置上对非分面查询有稳定的响应时间 < 3 秒。对于 100 个并发查询，我们的结果显示最小的机器配置是 8 个 CPU 内核/15Gb RAM。当然，结果会因许多因素而异，但是您可以将此作为您的机器尺寸调整的经验法则。

# java - 将 ADB 添加到我的 Java PC 应用程序

> ID：12127066
> 
> 赞同：3
> 
> 时间：2012-08-26T01:47:02.157
> 
> 标签：java, android, adb

我开发了一个 Java 应用程序。该应用程序以编程方式连接到 Android 设备，以传输一些文件以连接 Android 设备。

在我的应用程序中，我添加了 adb PATH，以便它可以使用它来连接设备。

我想知道是否有可能将其打包在应用程序中？还是只是将 adb 复制到应用程序目录中？因为我希望谁曾经下载过这个应用程序，所以不需要下载 adb 或 Android sdk 来让应用程序工作

是否可以 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:09:59.350

在做了一些研究之后，您可以将一个 exe 打包到一个 jar 文件中，但您必须在每次运行应用程序时提取该 exe。[按照 TofuBear 的示例，](https://stackoverflow.com/questions/600146/run-exe-which-is-packaged-inside-jar)我能够将 adb 封装在一个 jar 文件中。您需要包含 AdbWinApi.dll（或等效的 linux 库）。

```
import java.io.BufferedReader;
import java.io.Closeable;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.URI;
import java.net.URISyntaxException;
import java.net.URL;
import java.security.CodeSource;
import java.security.ProtectionDomain;
import java.util.zip.ZipEntry;
import java.util.zip.ZipException;
import java.util.zip.ZipFile;

public class Sandbox
{
    public static void main(final String[] args)
        throws URISyntaxException,
               ZipException,
               IOException
    {
        final URI uri;
        final URI exe;

        uri = getJarURI();
        // Extract the adb application
        exe = getFile(uri, "adb.exe");
        // Extract the AdbWinApi dll file.
        getFile(uri, "AdbWinApi.dll");
        System.out.println(exe);
    }

    private static URI getJarURI()
        throws URISyntaxException
    {
        final ProtectionDomain domain;
        final CodeSource       source;
        final URL              url;
        final URI              uri;

        domain = Sandbox.class.getProtectionDomain();
        source = domain.getCodeSource();
        url    = source.getLocation();
        uri    = url.toURI();

        return (uri);
    }    

    private static URI getFile(final URI    where,
                               final String fileName)
        throws ZipException,
               IOException
    {
        final File location;
        final URI  fileURI;

        location = new File(where);

        // not in a JAR, just return the path on disk
        if(location.isDirectory())
        {
            fileURI = URI.create(where.toString() + fileName);
        }
        else
        {
            final ZipFile zipFile;

            zipFile = new ZipFile(location);

            try
            {
                fileURI = extract(zipFile, fileName);
            }
            finally
            {
                zipFile.close();
            }
        }

        return (fileURI);
    }

    private static URI extract(final ZipFile zipFile,
                           final String  fileName)
        throws IOException
    {
        final File         tempFile;
        final ZipEntry     entry;
        final InputStream  zipStream;
        OutputStream       fileStream;

        //tempFile = File.createTempFile(fileName,     Long.toString(System.currentTimeMillis()));
        tempFile = new File(System.getProperty("java.io.tmpdir") + File.separator + fileName);

        tempFile.deleteOnExit();
        entry    = zipFile.getEntry(fileName);

        if(entry == null)

        {
            throw new FileNotFoundException("cannot find file: " + fileName + " in archive: " + zipFile.getName());
        }

        zipStream  = zipFile.getInputStream(entry);
        fileStream = null;

        try
        {
            final byte[] buf;
            int          i;

            fileStream = new FileOutputStream(tempFile);
            buf        = new byte[1024];
            i          = 0;

            while((i = zipStream.read(buf)) != -1)
            {
                fileStream.write(buf, 0, i);
            }
        }
        finally
        {
            close(zipStream);
            close(fileStream);
        }

        return (tempFile.toURI());
    }

    private static void close(final Closeable stream)
    {
        if(stream != null)
        {
            try
            {
                stream.close();
            }
            catch(final IOException ex)
            {
                ex.printStackTrace();
            }
        }
    }
} 
```

我必须更改 TofuBear 示例中的文件创建，以便不会更改 exe 的文件名。它仍然在临时文件夹中创建，将在退出时被删除。我留下了原始代码作为评论。

**编辑：**似乎我对它的技术可能性非常着迷，以至于忘记了法律后果。[Chris Stratton 在此声明](https://stackoverflow.com/questions/11565689/android-adb-redistribution)SDK服务[条款](http://developer.android.com/sdk/terms.html)禁止重新分发 sdk 的任何部分。其中将包括 adb。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T04:12:08.113

[使用 Java 原生chimpchat](http://dtmilano.blogspot.com/2011/11/android-using-monkey-from-java.html)连接到设备应该更容易。

# php - CakePHP 中的自定义验证规则

> ID：12127067
> 
> 赞同：0
> 
> 时间：2012-08-26T01:47:32.857
> 
> 标签：php, mysql, cakephp

我正在尝试为选中复选框创建自定义验证规则，需要填写输入字段才能进入下一页。如果未选中，则不需要输入字段。

这是我在视图中的代码：

```
echo $this->Form->inputs(array(
    'legend'=>'Certifications',
    'rn_box'=>array(
        'type'=>'checkbox',
        'label'=>'RN',
        'value' => $results['Education']['rn_box']
        ),
    'rn_number'=>array(
        'label'=>'RN Number:',
        'value' => $results['Education']['rn_number']
        ), 
```

));

在我的模型中，我创建了一个函数：

```
public function rnCheck () {
if ($this->data['Education']['rn_box'] == '0') {
    return false;
}
    return true; 
```

}

```
public $validate = array(
    'rn_number' => array(
        'rnCheck'=>array(
            'rule'=>'rnCheck',
            'message'=>'Please Provide a Number'
            ),
        ), 
```

);

如果选中，复选框返回值 1，未选中返回值 0。rn_number 字段是我要验证的输入字段。我试过玩'required'、'allowEmpty'等，但没有运气。如果有人能直接指出我的正确方向，那就太好了，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T02:34:51.220

您可能只需在 rn_number 的函数回调中处理这一切。我还将调用函数和规则名称 rn_number 以避免任何混淆。

例如，将您的验证数组更改为：

```
public $validate = array(
    'rn_number' => array(
        'rn_number'=>array(
            'rule'=>'rn_number'
        ),
    ),
); 
```

然后您的自定义验证函数可能如下所示：

```
public function rn_number () {
    if ($this->data['Education']['rn_box'] == 1) {
            if($this->data['Education']['rn_number'] == '')
                  $errors[] = "Please enter your RN Number.";
    }

    if (!empty($errors))
        return implode("\n", $errors);

    return true;
} 
```

我在自定义验证函数中处理错误消息 - 而不是在 validate 数组中。如果这不起作用，请告诉我！

# objective-c - 带有接口和吉他质量的 Core Audio CAPlayThrough 示例

> ID：12127071
> 
> 赞同：2
> 
> 时间：2012-08-26T01:48:24.897
> 
> 标签：objective-c, audio, core-audio

我正在玩 Apple 提供的 CoreAudio CAPlayThrough 示例。我没有做任何花哨的事情，只是试图让我的吉他通过音频接口（m-audio fast track pro）到我的电脑，然后将接口返回到我的耳机。我要通过一些音频，但质量很糟糕。我将输入和输出的采样率设置为 48k。有什么我想念的吗？我怀疑这可能是比特率的问题，但我不知道如何改变它。关于可能导致此质量问题的任何猜测？

# php - 解析错误：语法错误，第 353 行中出现意外的 ')'

> ID：12127072
> 
> 赞同：0
> 
> 时间：2012-08-26T01:48:51.733
> 
> 标签：php

我有一些前段时间由我编写的代码，无论如何我把它挖出来使用，我收到以下错误。

下面是位于第 353 行的代码。

```
$db->Connect('localhost', '*****', '*****', '******');    
foreach($data)  {   

$db->Query("INSERT INTO main (company_name, web_address, address, telephone) VALUES    ('".$data['name']."', '".$data['url']."', '".$data['address']."', '".$data['phone']."')");
} echo "DONE"; 
```

第 353 行与 Foreach 有关，任何建议或建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T01:51:27.423

您的[`foreach`](http://php.net/manual/en/control-structures.foreach.php)陈述不完整，您需要以下内容：

```
foreach($dataset as $data)  { 
```

`$dataset`包含您要在数据库中插入的所有记录集的二维数组在哪里。

# cocos2d-iphone - 我可以为我的游戏使用开源代码吗？

> ID：12127073
> 
> 赞同：-5
> 
> 时间：2012-08-26T01:49:30.333
> 
> 标签：cocos2d-iphone

我相信 Ray Wenderlich 的教程是开源的，所以我可以将代码用于我的游戏吗？我仍然需要修改它才能使用我的游戏，但我不想遇到任何法律问题。我很确定我能做到，但只是想确定一下。有什么建议么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T01:55:55.210

阅读常见问题解答：[http ://www.raywenderlich.com/faq](http://www.raywenderlich.com/faq)

> **教程源代码的许可证是什么？**
> 
> 免费教程中源代码的许可证是 MIT 许可证，除非另有说明。不需要署名（但当然值得赞赏！）
> 
> 全文如下：
> 
> 版权所有 (c) 2010, 2011 Ray Wenderlich
> 
> 特此免费授予任何获得本软件副本的人以不受限制地处理本软件，包括但不限于使用、复制、修改、合并、发布、分发、再许可和/或出售的权利软件的副本，并允许向其提供软件的人这样做，但须符合以下条件：
> 
> 上述版权声明和本许可声明应包含在本软件的所有副本或大部分内容中。
> 
> 本软件按“原样”提供，不提供任何形式的明示或暗示保证，包括但不限于对适销性、特定用途适用性和非侵权性的保证。在任何情况下，作者或版权持有人均不对任何索赔、损害或其他责任承担任何责任，无论是在合同、侵权或其他方面，由本软件或本软件的使用或其他交易引起或与之相关。软件。

但这里不是你应该问这种问题的地方……

# css - 根据模板值动态设置 CSS 属性

> ID：12127076
> 
> 赞同：9
> 
> 时间：2012-08-26T01:51:00.483
> 
> 标签：css, meteor, handlebars.js

是否可以根据 handlebars.js 模板值动态设置输入字段的文本颜色？

我最初使用此模板创建我的 html：

```
<div class="board">
    <div class="header">
        <span class="name">Project</span>
        <span class="status">Status</span>
    </div>
    {{#each projects}}
    {{> project}}
    {{/each}}
</div> 
```

`projects`从数据库读取的对象在哪里。每个生成的 html（页面上呈现的内容而不是我的 html 中的内容）`project`看起来像这样：

```
<div class="project">
    <span class="name">FOO</span>
    <span class="status">OK</span>
</div>
<div class="project">
    <span class="name">BAR</span>
    <span class="status">NOTOK</span>
</div> 
```

我想用动态设置的 OK & NOTOK 文本的颜色来渲染这个 html。

我已经有一个车把辅助函数，它将根据每个选项成功返回正确的颜色代码，我可以使用以下方法调用它：

```
{{getStatusColor currentStatus}} 
```

我想做的是把这个函数调用直接放入css本身，有点像：

```
font-color: {{getStatusColor currentStatus}} 
```

但显然这行不通。这个功能确实感觉是正确的方法，但是我可以在哪里使用它来正确格式化页面上的文本？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-26T02:59:21.500

回答我自己的问题：需要扩展模板（从`{{> projects}}`）以允许条件渲染。

```
<div class="board">
    <div class="header">
        <span class="name">Project</span>
        <span class="status">Status</span>
    </div>
    {{#each projects}}
    <div class="project">
        <span class="name">{{name}}</span>
        <span class="status" style="color:{{getStatusColor status}}">{{status}}</span>
    </div>
    {{/each}}
</div> 
```

为了完整起见，辅助函数 getStatusColor 如下所示：

```
Handlebars.registerHelper('getStatusColor', function(status) {
    switch (status) {
        case "GOOD" : {
            return 'green';
        }
        break;
        case "BAD" : {
            return 'red';
        }
        break;
        default : {
        ...etc.;
    }
}); 
```

更新：为了诚实起见，我应该承认我完全错过了我的代码中已经有了这个扩展模板并且`{{> projects}}`指向了这一点。我应该`style="color:{{getStatusColor status}}"`直接将属性添加到引用的`project`模板中。因此，为了我和其他人的利益，最终的、有效的 HTML：

```
<template name="foo">
    <div class="board">
    <div class="header">
        <span class="name">Project</span>
        <span class="status">Status</span>
    </div>
    {{#each projects}}
    {{> project}}
    {{/each}}
    </div>
</template>

<template name="project">
    <div class="project {{selected}}">
        <span class="name">{{name}}</span>
        <span class="status"style="color:{{getStatusColor status}}">{{status}}</span>
    </div>
</template> 
```

# php - php - 如何在foreach中使用多个数组

> ID：12127081
> 
> 赞同：-1
> 
> 时间：2012-08-26T01:52:10.327
> 
> 标签：php

> **可能重复：**
> [添加三个变量的 foreach](https://stackoverflow.com/questions/7748115/foreach-with-three-variables-add)

我有以下代码我想在 foreach 中使用多个数组。请注意，我需要 $yourSiteContent[] 原样。

```
foreach ($pieces as $id and $pieces1 as $id_date) {
    $yourSiteContent[] = array('permalink' => $id, 'updated' => $id_date);
} 
```

如您所见，我有两个数组（$pieces 和 $pieces1），请检查一个循环并让我知道我在哪里做错了。

$pieces1 包含日期，$pieces 包含网址。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T01:57:36.447

假设 $pieces 和 $pieces1 具有相同的键，您可以执行以下操作：

```
for (array_keys($pieces) as $key) {
    $yourSiteContent[] = 
        array('permalink' => $pieces[$key], 'updated' => $pieces2[$key]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T01:54:04.223

您应该使用`for`循环和索引器，然后访问每个数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T02:07:47.027

为了保持 foreach 格式，您也可以这样做（假设 $pieces 和 $pieces1 具有相同的键）：

```
$yourSiteContent = array();
foreach ($pieces as $key=>$value) {
    $yourSiteContent[] = array('permalink'=>$value,
                               'updated'=>$pieces1[$key]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T02:44:39.813

您可以使用`array_combine()`将两个数组组合成一个数组，一个用于键，另一个用于值。

```
foreach (array_combine($pieces, $pieces1) as $id => $id_date) {
    $yourSiteContent[] = array('permalink' => $id, 'updated' => $id_date);
} 
```

有关详细信息，请参阅[array_combine()](http://www.php.net/manual/en/function.array-combine.php)。

# javascript - node-static 无法为当前文件夹上方的文件夹提供服务

> ID：12127084
> 
> 赞同：2
> 
> 时间：2012-08-26T01:53:59.350
> 
> 标签：javascript, node.js, node-static

我不知道这是对`node-static`我的代码的限制还是错误，但我似乎无法让它为当前目录之上或之外的文件提供服务。我当前的目录结构是这样的：

```
project
    public
        ...public stuff here...
    system
        core
           server.js 
```

`server.js`位于`core`目录中，将路径设为`public`as `../../public`- 但此代码不会运行。它返回一个 404。

```
staticServer = new (static.Server)('../../public');

webServer = http.createServer(function (request, response) {
    staticServer.serve(request,response);
})

webServer.listen(appServerConfig.port, appServerConfig.address); 
```

但是，如果我更改结构以使公用文件夹位于旁边`server.js`并相应地更改代码，则它可以工作：

```
project
    system
        core
           server.js
           public
               ...public stuff here...

staticServer = new (static.Server)('./public');

webServer = http.createServer(function (request, response) {
    staticServer.serve(request,response);
})

webServer.listen(appServerConfig.port, appServerConfig.address); 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T03:00:21.080

请注意，使用相对路径将解析相对于 node.js 进程的当前工作目录的那些路径，即运行时所在的目录`node server.js`。因此，按照编码，只要您在`core`启动节点时位于目录中，对我来说就可以了。你确定你总是从`core`目录启动节点吗？

如果您想独立于 cwd （更强大的恕我直言），请使用`__dirname`获取当前文件的绝对目录路径，然后添加到该文件的相对路径：`__dirname + '/../../public'`.

除此之外，考虑[fs.realpath](http://nodejs.org/docs/latest/api/all.html#all_fs_realpath_path_cache_callback)来解决这些问题。我不能说 node-static 是否特别有特殊的代码来防止这种情况，但我见过的大多数其他模块，比如 connect 的静态中间件，都会很高兴地为任意目录提供服务，而没有特殊限制。

# wordpress - 水平 wordpress 菜单中心的空格

> ID：12127088
> 
> 赞同：1
> 
> 时间：2012-08-26T01:55:21.810
> 
> 标签：wordpress, list, menu, placeholder

我正在寻找一个独特问题的解决方案。我为多站点构建开发的主题的“网络菜单”下方有一个 wp_menu。菜单中心有一个小环，上面有标志，我很好奇是否有办法让一个透明的列表项保持那个位置，并允许所有其他“合法”的列表项环绕它，所以要么向左要么向右。

我已经有一个过滤器，可以插入一个可以通过添加 css 自定义的列表项，我只是不知道如何使一个列表项特别保留圆圈存在的位置。

该网站是： [http ://www.mountainjackscreative.com/sandbox/edts/sample-page/](http://www.mountainjackscreative.com/sandbox/edts/sample-page/)

任何帮助，甚至只是想法都会很棒！

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:18:57.910

由于您使用的是 jQuery，因此您可以在菜单上进行一些数学运算。

**编辑：**把这个放在你的头标签结束之前

**LAST_EDIT：**这是 JS 小提琴[http://jsfiddle.net/BsnFW/14/](http://jsfiddle.net/BsnFW/14/)。最后一次尝试:)

```
$(document).ready(function() {

    menuBreakPoint = 200; //width in px after which you want to insert the space (experiment with this)
    menuWidth = 0;
    rightMenuStart = 600; //width in px from left of menu container div to the right

    $('.sub_site_menu li').each( function() {
        menuWidth += $(this).width();
    if (menuWidth >= menuBreakPoint) {
       $(this).css('margin-left', (rightMenuStart - menuWidth));
       return false; //break out of each loop
    }
    });

}); 
```

用这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T02:13:47.470

你能不把名单分成两份吗？一左一右浮动。提供适当的 ul 边距，以便徽标上不显示任何内容？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T23:53:20.967

我将使用 jquery 解决方案，因为它很可能会在所有浏览器中呈现最佳结果。但是我确实偶然发现了这个关于即将在 CSS3 中实现的功能的其他资源

包括一个强制与新的 CSS3“列”功能兼容的脚本。

[http://www.csscripting.com/css-multi-column/](http://www.csscripting.com/css-multi-column/)

# .net - 为什么 Windows Phone 7.1 SDK 安装 VS 2010 express？

> ID：12127092
> 
> 赞同：0
> 
> 时间：2012-08-26T01:56:38.110
> 
> 标签：.net, windows-phone-7, windows-phone-7.1

我正在尝试从安装 Windows Phone 7.1 SDK

[https://dev.windowsphone.com/en-us/downloadsdk](https://dev.windowsphone.com/en-us/downloadsdk)

我不明白为什么当我已经安装了带有 SP1 的 VS 2010 Ultimate 时，这个愚蠢的安装程序会尝试安装 VS 2010 express？有没有办法阻止它下载并不必要地安装它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:25:23.570

杰克，这并不愚蠢。它正在做它的工作:)。VS 2010 Express 是用于 Windows Phone 应用程序开发的专用 IDE。无论有没有其他 VS 版本（包括 VS Ultimate），它都可以工作。VS 2010 Express 包含 WP 应用程序开发所需的 SDK。

所以，没什么好担心的。继续下载和安装。

# javascript - 以一种形式处理具有相同名称和值的多个按钮

> ID：12127094
> 
> 赞同：-1
> 
> 时间：2012-08-26T01:57:09.457
> 
> 标签：javascript, forms, button

我在一个网站上有多个提交按钮。他们过去常常上下移动元素，我希望以一种完整的形式成为它们，以防用户更改同时一些其他值，以便保存所有内容。现在的问题是我需要被点击的按钮的元素 ID。

所以这是循环中的代码：

```
div class="form-order"><?php echo $elements[$z]['element_order']; ?> </div>
<input type="submit" name="edit_form_operation" value="&#9650;" class="button-primary" 
<?php if($elements[$z]['element_order'] == 1) echo 'disabled="disabled"'; ?> /><br />

<input type="submit" name="edit_form_operation" value="&#9660;" class="button-primary" 
<?php 
$highest_element = $fdb->get_element_highest_order($form[$i]['form_id']);
if($elements[$z]['element_order'] == $highest_element) echo 'disabled="disabled"'; ?> /> 
```

在 for 循环中单击该特定按钮时，他应该首先编写此代码，以便我知道必须移动哪个元素

```
echo '<input type="hidden" name="change_element_id" value="'.$elements[$z]['element_id'].'" >'; 
```

我也对这个问题的另一种解决方案持开放态度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T13:28:32.367

好的，我现在就这样解决了

在这里您处理输入：

```
// Select Operation
    if(isset($_POST['edit_form_operation_up'])) {
        echo "move up id ";
        $operation = array_keys($_POST['edit_form_operation_up']);
        echo $operation['0'];
    }
    else if(isset($_POST['edit_form_operation_down'])) {
         echo "move down id ";
         $operation = array_keys($_POST['edit_form_operation_down']);
         echo $operation['0'];
    } 
```

这是在无限元素的 for 循环中，输入具有相同的值和名称。

```
<?php $elements = $fdb->get_elements($form[$i]['form_id']); 
for($z = 0; $z < sizeof($elements); $z++) {
?>
<tr>
    <td><div class="form-order"><?php echo $elements[$z]['element_order']; ?> </div>
        <input type="submit" name="edit_form_operation_up[<?php echo $elements[$z]['element_id']; ?>]" value="&#9650;" class="button-primary" 
        <?php if($elements[$z]['element_order'] == 1) echo 'disabled="disabled"'; ?> /><br />
        <input type="submit" name="edit_form_operation_down[<?php echo $elements[$z]['element_id']; ?>]" value="&#9660;" class="button-primary" 
        <?php 
        $highest_element = $fdb->get_element_highest_order($form[$i]['form_id']);
        if($elements[$z]['element_order'] == $highest_element) echo 'disabled="disabled"'; ?> />
    </td>
    <td><?php echo $elements[$z]['element_id']; ?> </td>
    <td></td>
    <td></td>
</tr>
<?php } ?> 
```

如果有人发现这个话题并想找到一个好的解决方案。

问候

# c# - 如何仅获取文件名的一部分？

> ID：12127098
> 
> 赞同：-1
> 
> 时间：2012-08-26T01:57:37.900
> 
> 标签：c#

例如我有这个搜索文件的功能：

```
public void Search(string strExtension,
                            DirectoryInfo di,
                            List<FileSystemInfo> pResult)
        {
            try
            {

                foreach (FileInfo fi in di.GetFiles())
                {
                    if (InvokeRequired)
                    {
                        BeginInvoke(new Action(() => label2.Text = fi.Name));
                    }
                    if (fi.Name == "MessageLog.xsl")
                    {
                        foreach (FileInfo fii in di.GetFiles())
                        {
                        if (fii.Extension == strExtension)
                            pResult.Add(fii);
                        }
                        if (InvokeRequired)
                        {
                            BeginInvoke(new Action(() => label4.Text = pResult.Count.ToString() + Environment.NewLine));
                        }

                    }
                }

                    foreach (DirectoryInfo diChild in di.GetDirectories())
                        Search(strExtension, diChild, pResult);

            }
            catch (Exception e)
            {
            }
        } 
```

当搜索结束时，我使用这个小类：

```
public class MyItem
        {
            public FileSystemInfo fsi { get; set; }
            public override string ToString()
            {
                return this.fsi.Name;
            }
        } 
```

并在 backGroundWorker 完成事件中显示文件名：

```
private void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {

            for (int i = 0; i < this.fsi.Count; i++)
            {
                this.listBox1.Items.Add(new MyItem() { fsi = fsi[i] });
            }

        } 
```

listBox 中的结果例如是这样的：

```
danny125645.xml

yaron576567.xml 
```

这是没有目录的文件名。

无论如何都要解析文件名，所以它没有数字吗？例如：

```
danny.xml

yaron.xml 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:02:34.893

更新您的课程并更改：

```
public override string ToString()
{
    return Regex.Replace(this.fsi.Name, @"[\d]", string.Empty);
} 
```

# delphi - 如何通过 HTTP 从 RTSP 摄像头获取图像流？

> ID：12127104
> 
> 赞同：2
> 
> 时间：2012-08-26T02:00:40.113
> 
> 标签：delphi, http, delphi-xe2, rtsp, indy

我想知道是否可以使用 HTTP 协议从 RTSP 相机获取图像流？我目前正在使用 VLC Media ActiveX 插件连接并查看 RTSP 流，但我想消除 ActiveX 控件并转向更原始的图像采集级别。我记得在某处看到可以使用 HTTP 获取这些图像。我想使用 Indy`TIdHTTP`组件连接到相机并获取图像。我还假设这需要某种速度控制，例如请求之间的延迟。但是，据我了解，这些 RTSP 摄像机具有预定义的帧速率，应该遵循使用标准 RTSP 协议的帧速率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T02:11:40.200

许多相机将允许您使用如下所示的 URL 抓取屏幕截图：

```
http://user:password@camera/snapshot.jpg 
```

对于正确的流，您需要使用 RTSP（有 Delphi RTSP 客户端），如果您的设备支持[application/x-rtsp-tunnelled](https://developer.apple.com/quicktime/icefloe/dispatch028.html)内容类型或您的设备支持的其他流，则通过 HTTP 隧道。

# node.js - 如何编写 package.json 文件，以便使用“npm install”下载所有依赖项

> ID：12127114
> 
> 赞同：28
> 
> 时间：2012-08-26T02:05:21.690
> 
> 标签：node.js, npm

我使用 node 编写了一个简单的应用程序。这取决于 express、mongodb 和 mongoose（简单）。因此，我创建了一个名为的文件`package.json`并将其放入其中：

```
{
  "name": "booking-dojo",
  "description": "Booking dojo app",
  "version": "0.0.1",
  "private": true,
  "dependencies": {
    "express": "3.x",
    "mongodb": "*",
    "mongoose": "*"
  }
} 
```

然后我跑了`npm install`，期待 npm 安装这些模块*及其*依赖项。结果令人失望：

```
booking-dojo@0.0.1 /home/merc/Synced/Development/Bookings/app/server
├─┬ express@3.0.0rc3 
│ ├── commander@0.6.1 
│ ├─┬ connect@2.4.3 
│ │ ├── bytes@0.1.0 
│ │ ├── formidable@1.0.11 
│ │ ├── pause@0.0.1 
│ │ └── qs@0.4.2 
│ ├── cookie@0.0.4 
│ ├── crc@0.2.0 
│ ├── debug@0.7.0 
│ ├── fresh@0.1.0 
│ ├── methods@0.0.1 
│ ├── mkdirp@0.3.3 
│ ├── range-parser@0.0.4 
│ └─┬ send@0.0.3 
│   └── mime@1.2.6 
├─┬ mongodb@1.1.4 
│ └── bson@0.1.1 
└─┬ mongoose@3.0.3 
  ├── hooks@0.2.1 
  └── ms@0.1.0 
```

我对此感到困惑，因为我*知道*需要 （以及更多）和`express`需要。 如果我进入并运行，主树的结果会非常不同：`jade``mongoose``mongodb`
`node_modules/jade``npm install`

```
booking-dojo@0.0.1 /home/merc/Synced/Development/Bookings/app/server
├─┬ express@3.0.0rc3 
│ ├── commander@0.6.1 
│ ├─┬ connect@2.4.3 
│ │ ├── bytes@0.1.0 
│ │ ├── formidable@1.0.11 
│ │ ├── pause@0.0.1 
│ │ └── qs@0.4.2 
│ ├─┬ connect-redis@1.4.1 
│ │ └─┬ redis@0.7.2 
│ │   └── hiredis@0.1.14 
│ ├── cookie@0.0.4 
│ ├── crc@0.2.0 
│ ├── debug@0.7.0 
│ ├── ejs@0.8.2 
│ ├── fresh@0.1.0 
│ ├── github-flavored-markdown@1.0.1 
│ ├─┬ hjs@0.0.4 
│ │ └── hogan.js@2.0.0 
│ ├─┬ jade@0.27.2 
│ │ └── mkdirp@0.3.0 
│ ├── methods@0.0.1 
│ ├── mkdirp@0.3.3 
│ ├─┬ mocha@1.4.0
│ │ ├── diff@1.0.2 
│ │ ├── growl@1.5.1 
│ │ └─┬ jade@0.26.3 
│ │   └── mkdirp@0.3.0 
│ ├── range-parser@0.0.4 
│ ├─┬ send@0.0.3 
│ │ └── mime@1.2.6 
│ ├── should@1.1.0 
│ ├─┬ stylus@0.29.0 
│ │ └── cssom@0.2.5 
│ └─┬ supertest@0.0.1 
│   └─┬ superagent@0.5.0 
│     ├── emitter-component@0.0.1 
│     ├── formidable@1.0.9 
│     ├── mime@1.2.5 
│     └── qs@0.4.2 
├─┬ mongodb@1.1.4 
│ └── bson@0.1.1 
└─┬ mongoose@3.0.3 
  ├── hooks@0.2.1 
  └── ms@0.1.0 
```

所以，`express`成长*了*很多。看起来`npm install`只是加载了子模块的*一些依赖项。*

有人可以对此有所了解吗？为什么缺少一些依赖项？难道我做错了什么？（可能）

谢谢！

默克。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-26T02:51:47.073

您对至少 2 点感到困惑。

首先，express不依赖jade，通过阅读`node_modules/express/package.json`文件可以看出：

```
 "dependencies": {
    "connect": "2.4.2",
    "commander": "0.6.1",
    "range-parser": "0.0.4",
    "mkdirp": "0.3.3",
    "cookie": "0.0.4",
    "crc": "0.2.0",
    "fresh": "0.1.0",
    "methods": "0.0.1",
    "send": "0.0.3",
    "debug": "*"
  } 
```

但是，Express 确实可以*与*翡翠（*如果*可用）以及许多其他模板引擎一起使用。因此，将这个列表 jam 修复为 package.json 文件中的依赖项，你会没事的。

其次，npm 只安装 node 包，不安装第三方的东西，比如 mongodb。您需要使用其他方式（、、手动安装等）安装 mongodb 和任何其他不是 npm 模块的依赖`apt-get`项`yum`。

所以 npm 确实递归地安装依赖项，但只安装 npm 模块。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-28T14:18:24.057

布兰登在对另一个答案的评论中提供了答案：

“另外需要注意的是，如果一个包依赖于一个可以在依赖链中进一步解析的模块，它会。例如，由于你的 package.json 中有 mongodb，Mongoose 不需要安装它自己的mongodb. – Brandon Tilley 2天前

谢谢布兰登！（这就是答案……）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-26T12:08:21.247

使用此示例

```
{
  "name": "app",
  "version": "0.0.1",
  "main":"test.js",
  "author":"Test",
  "description": "For test ",
  "dependencies": {
    "express": "latest",
    "mongoose": "latest"
  }

}
```

# c# - 将 CName 映射到 Windows Azure

> ID：12127120
> 
> 赞同：0
> 
> 时间：2012-08-26T02:08:15.950
> 
> 标签：c#, windows, azure

我在 Windows Azure 上运行一个站点：

mysite.azurewebsites.net

我的网站是给我的名字。我将 cname 映射到我的 site.azurewebsites.net。当我在浏览器中输入我的 CNAME 时，我收到 404。是否有任何其他步骤可以将 CNAME 映射到我的站点？

我知道对于一个 IIS 站点，我需要设置一个主机名。我需要这样做吗？我在预览门户中看不到 CNAME 文本框。

这是我的网站 > 配置区域的图像：

![在此处输入图像描述](../Images/474bf82c3efd2d8aa61aa8231f684b69.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-26T05:03:37.140

“我在预览门户中看不到 CNAME 文本框。” 仔细看？它就在某个地方，您确实需要告诉 Windows Azure 您正在使用的主机名。

（抱歉，我现在无法登录并查找它的确切位置。）

# jquery - 关于 jquery 滚动的一些问题

> ID：12127121
> 
> 赞同：0
> 
> 时间：2012-08-26T02:08:18.493
> 
> 标签：jquery, html, css

这是小提琴： http: [//jsfiddle.net/mitchbregs/KkgkQ/3/](http://jsfiddle.net/mitchbregs/KkgkQ/3/) 这是全屏小提琴：http: [//jsfiddle.net/mitchbregs/KkgkQ/3/embedded/result/](http://jsfiddle.net/mitchbregs/KkgkQ/3/embedded/result/)

我不能在这里工作。当有人在左侧导航栏中选择某些内容时，我希望它滚动到必要的区域。此外，完成此操作后，我希望打开所选的 jQuery removeClass 并将其转回选项。如果您查看 html/css，您可以看到它。

我已经使用了所有这些方法：
方法 1：[http](http://www.mediacollege.com/internet/javascript/page/scroll.html)
://www.mediacollege.com/internet/javascript/page/scroll.html 方法 2：[http ://blog.freelancer-id.com/2009/03/26/ scroll-window-smoothly-in-jquery/](http://blog.freelancer-id.com/2009/03/26/scroll-window-smoothly-in-jquery/)
方法 3：[如何使用 JQuery $.scrollTo() 函数滚动窗口](https://stackoverflow.com/questions/832860/how-to-scroll-the-window-using-jquery-scrollto-function)

非常感谢所有回答的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:18:44.767

将 ID 添加到每个“页面中的部分”并绑定菜单上的点击：

```
$(document).ready(function(){
    $('.contacts').on('click', function(){ 
        $('html, body').animate({
            scrollTop: $('#scroll_contact').offset().top
        }, 1000);
        $('.list_options_selected').attr('class', 'list_options');
        $(this).children(":first").attr('class', 'list_options_selected');
    })
});​ 
```

这是[JSFiddle](http://jsfiddle.net/KkgkQ/6/embedded/result/)

# java - 防止一个方法在另一个方法之前被调用

> ID：12127125
> 
> 赞同：5
> 
> 时间：2012-08-26T02:08:56.893
> 
> 标签：java, c++, methods, call

这个问题有点宽泛和概念化。

我有一堂有各种方法的课。让我们称它们为`A`and `B`。如何确保将来使用此类的其他开发人员在第一次调用方法 A 之前不会调用方法 B 至少一次？

我在 C++ 中执行此操作，但一般而言，执行此操作的最佳方法是什么？我有一些天真的想法，例如使用布尔变量，但我也想听听其他一些想法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-26T02:13:53.767

保证这一点的一种方法？让方法 B 负责调用方法 A 一次。

其他任何东西都是脆弱的 API。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-26T02:14:33.167

有一个布尔变量来确定是否`A`已被调用。然后，当有人尝试在`B`未设置此布尔变量的情况下调用时，抛出 IllegalStateException。

或者您可以`B`简单地调用`A`，因为它似乎无法在不`A`首先调用的情况下执行。

否则，由于这两种方法都是公开的，因此实际上没有其他方法可以强制执行此操作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-26T02:21:05.733

使用布尔值是一个好的开始，并且投入访问工作正常。

然而，有时能够在编译时强制执行这一点很好。在这种情况下，您唯一真正的选择是使用一些技巧。

仅在您的类中公开 A，使其返回包含 B 的代理。

```
class MyClass {
  public:

    struct BProxy {
      public:
        MyClass * root;
        void B() { root->B(); }
      protected:
        BProxy( MyClass * self ) : root(self) {}; // Disable construction
        friend class MyClass; //So that MyClass can construct it
    };

    BProxy A() { ... return BProxy(this); }
    friend class BProxy; // So that BProxy can call B()
  protected
   void B() { ... }
};

int main() {
   MyClass m;
   BProxy bp = m.A(); 
   // m.B(); can't do this as it's private - will fail at compile time.
   bp.B(); // Can do this as we've got the proxy from our previous call to A.
} 
```

您还可以使用从实现（或提供虚拟）B() 的基类的受保护继承来实现类似的目的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-26T02:32:37.700

一种方法是稍微不同地重新设计您的课程。考虑一个在使用前需要初始化的简单数据库类。我是Java人，所以...

```
public class Database {
  public void init(String username, String password) // must call this first!
  public List<Object> runQuery(String sql) // ...
} 
```

所以我需要先调用init。我可以创建一个进行初始化并返回实际数据库对象的 DatabaseFactory。我们可以隐藏构造函数，以便只有 DatabaseFactory 可以创建数据库（在 Java 中是嵌套类，在 C++ 中可能是友元类？）。

```
public class DatabaseFactory {
   public Database init(String username, String password) // ...

   public class Database {
     private Database() {}
     public List<Object> runQuery(String sql) // ...
   }
} 
```

所以现在我必须通过工厂才能到达底层对象。

```
DatabaseFactory factory = new DatabaseFactory();
Database database = factory.init("username", "password"); // first init (call method A)
// now I can use database (or B in your case)
database.runQuery("select * from table"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-26T02:45:01.030

保证它的一种方法`A`是在类的构造函数中完成。如果构造函数失败（抛出），那么其他开发人员就没有什么可以做的错误`B`了。如果构造函数成功，则`A`至少完成一次，`B`有效的操作也是如此。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-26T07:00:18.173

我会将方法“A”作为构造函数来初始化对象。这必须调用一次才能使用由编译器强制执行的对象。稍后您可以在必须调用构造函数的情况下调用方法“B”。

# php - Moodle，使用moodle表单上传和存储文件

> ID：12127126
> 
> 赞同：3
> 
> 时间：2012-08-26T02:09:25.737
> 
> 标签：php, file-upload, moodle

我在使用moodle表单实现moodle上传机制时遇到了一些困难。我的目标是让用户/管理员上传图像，存储它们并稍后在一个块中访问。

目前，我有这个形式：

```
$mform->addElement('filemanager', 'attachments', 'Pic:', null, array('subdirs' => 0, 'maxfiles' => 1,'accepted_types' => '*' )); 
```

这要保存文件：

```
if ($draftitemid = file_get_submitted_draft_itemid('attachments')) {
file_save_draft_area_files($draftitemid, $context->id, 'mod_assignment', 'attachments', 0, array('subdirs' => false, 'maxfiles' => 1));
} 
```

我尝试像这样访问文件：

```
file_encode_url($CFG->wwwroot . '/pluginfile.php', '/' . $context->id . '/mod_assignment/attachments') 
```

我没有收到任何错误，但我也无法访问该文件。我正在使用moodle 2.0。

提前谢谢，保重

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T09:09:07.413

听起来您正在寻找编写自定义块，在这种情况下，您应该将**block_myblock**作为组件名称而不是**mod_assignment**。

每个提供文件服务的 Moodle 组件都需要在 lib.php 中定义自己的函数来处理文件请求。在您的情况下，该函数希望被称为`block_myblock_pluginfile()`.

一个很好的例子是`block_html_pluginfile()`可以在*moodle/blocks/html/lib.php*中找到它，它的功能与您想要的非常相似。

# emacs - 词法作用域有什么了不起的？

> ID：12127128
> 
> 赞同：3
> 
> 时间：2012-08-26T02:09:59.807
> 
> 标签：emacs, closures, elisp, emacs24

我不明白 Emacs 24 的新词法作用域功能为何如此出色的原因是我想不出没有它们就无法实现的任何新功能。例如，下面的闭包：

```
(setq lexical-binding t)
(defun f1 (num1)
  (lambda (num2)
    (setq num1 (* num1 num2))))

(fset 'f2 (f1 5))
  ==> (closure ((num1 . 5) t) (num2) (setq num1 (* num1 num2)))
(f2 5)
  ==> 25
(f2 2)
  ==> 50 
```

可以使用常规动态范围来实现，如下所示：

```
(defun f1 (num)
  (let ((tmpvar (make-symbol "num")))
    (set tmpvar num)
    `(lambda (num2)
       (set ',tmpvar (* (eval ,tmpvar) num2)))))

(fset 'f2 (f1 5))
  ==> (lambda (num2) (set (quote num) (+ (eval num) num2)))
(f2 5)
  ==> 25
(f2 2)
  ==> 50
(fset 'f3 (f1 9))
  ==> (lambda (num2) (set (quote num) (+ (eval num) num2)))
(f3 3)
  ==> 27
(f3 2)
  ==> 54
(f2 10)
  ==> 500 
```

好的，所以并不是所有的语言都有类似于 elisp 的 uninterned 符号的东西，所以我理解为什么词法作用域在他们的情况下如此出色。但是 elisp 呢？由于词法作用域，你能想到我现在（从 Emacs 24 开始）我以前不能做的任何事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T02:58:45.787

您不需要非实习符号，使用`cons`代替`make-symbol`，`car`代替`eval`，和`setcar`代替，`set`您的示例也可以正常工作（并且更有效）。

另请注意，从机器语言到更高级别语言的发展主要是基于使越来越多的事情*变得不可能*（或至少更难）。当然，那些从程序员那里拿走的设施很少被使用和/或被认为太危险。考虑使用未初始化的变量（在 C 中可能，但在 Java 和许多其他语言中是不可能的），或者跳到指令的中间。

至于您的示例代码的一些缺点：不仅可读性较差，而且编译器基本上无法知道您正在构建代码，因此不允许查看“`(lambda .. .)" 来编译它，扩展它的宏调用，给你关于可疑元素的警告，......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T04:04:14.080

在 Emacs 中一直有模拟词法绑定的变通方法，因此与其说是能够做新的事情。

手册说：

> 词法绑定为优化提供了更多机会，因此使用词法绑定的 Emacs Lisp 代码可能会在未来的 Emacs 版本中运行得更快。这样的代码对并发性也更加友好，我们希望在不久的将来将其添加到 Emacs 中。

我认为这是主要的好处。

与此相反的是，在编写 Emacs 时，出于充分的理由特意选择了动态绑定，这在今天仍然适用，因此词法绑定当然不应该被视为新的做事方式。

全局变量在编程中通常被认为是一个坏主意，但 Emacs 是一个不寻常的案例，它并不真正适用，因为它的大部分灵活性——使 Emacs 伟大的关键因素之一——直接来自动态绑定。如果没有动态绑定，就不可能像 Emacs 所允许的那样将应用程序弯曲到满足单个用户的要求。

在我看来，词法绑定应该谨慎使用，并且只用于其他用户无法找到理由重写的变量。默认情况下，变量应该是`defvar`'d 以便保留自定义行为的能力（即使以作者没有预料到的方式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:57:07.683

我认为面向对象编程的实现往往很适合词法范围。具有状态映射的对象直接映射到词法闭包。

我确信 common lisp 中的 CLOS 实现大量利用了词法范围。我很难想象该规范如何仅在动态范围内实现，但我确信这是可能的。

# python - 使用 Grid 调整窗口大小时调整 Tkinter 列表框的大小

> ID：12127130
> 
> 赞同：1
> 
> 时间：2012-08-26T02:11:05.533
> 
> 标签：python, tkinter

我正在使用 Grid 几何管理器开发一个 Tkinter 应用程序（这是我第一次使用 Grid，我喜欢它！:D），它包含一个滚动列表框，每当用户选择一个选项时就会显示选项。

它运作良好，但窗户又小又丑。当我最大化它时，其他一切都可以很好地调整大小（感谢 columnconfigure），但列表框保持相同的高度。有没有简单的方法来解决这个问题？

（我见过[这个问题](https://stackoverflow.com/questions/4318103/python-tkinter-resize-listbox-widget-when-window-resizes)，但它是针对 Pack 的，而不是针对 Grid 的）

提前致谢。

代码示例，因为有人要求：

```
self.tasklist = Listbox(self.frame, exportselection=0)
self.tasklist.grid(row=1, sticky=W+E+N+S)
yscroll = Scrollbar(self.frame, command=self.tasklist.yview, orient=VERTICAL)
yscroll.grid(row=1, column=1, sticky=N+S) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T03:28:08.733

没有看到更多的代码是不可能的。很可能您的列表框正在正确扩展，但您`self.frame`的不是。不过，我没有看到您对列表框所在的行和列给予任何重视，因此这可能是一个因素。

一种简单的调试方法是提供`self.frame`一种会突出的花哨颜色（红色、亮绿色等）。然后很容易看出列表框是否在框架内正确调整大小，以及框架是否在其父框架内正确调整大小。

# git - 由于存在目录，无法更新 github 中的子模块

> ID：12127134
> 
> 赞同：1
> 
> 时间：2012-08-26T02:12:22.583
> 
> 标签：git, vim, github, macvim

我正在使用子模块来控制我在 MacVim 中的插件。当我尝试使用`git update submodule` 它更新子模块时：

```
fatal: destination path 'bundle/ShowMark' already exists and is not an empty directory.
Clone of 'git://github.com/vim-scripts/ShowMarks.git' into submodule path 'bundle/ShowMark' failed 
```

我尝试了自己的解决方案：删除目录，然后`git update submodule` 它可以工作，但 MacVim 无法正常运行。MacVim 无法打开任何新/旧文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T09:31:23.513

MacVim 可能在打开文件时遇到问题，`bundle/ShowMark`因为 GitHub 上的实际存储库名称是`ShowMark**s**(.git)`.

如果该子模块注册为 in 可能会更好`bundle/ShowMarks`。
有关该步骤的更多信息，请参阅“[如何在 git 存储库中移动现有的 git 子模块？](https://stackoverflow.com/questions/4604486/how-do-i-move-an-existing-git-submodule-within-a-git-repository) ”。

# imagemagick - 将 TIFF Alpha 通道从未关联转换为关联

> ID：12127136
> 
> 赞同：0
> 
> 时间：2012-08-26T02:13:12.627
> 
> 标签：imagemagick, tiff, graphicsmagick, imagemagick-convert

对于我正在构建的动态成像应用程序，我必须获取由渲染包创建的图像并将其放置在 InDesign 文件中。因为它需要是具有透明度的 CMYK，所以 TIFF 是唯一可能使用的格式。我遇到的困难是渲染器正在生成一个带有不相关的 alpha 通道的图像，InDesign 似乎很难理解。

我正在与渲染器制造商合作，看看他们是否可以更改其输出格式，但同时我想找到一些自动化工作流程来将具有未关联 alpha 的 CMYK TIFF 转换为具有关联（预乘）alpha。

我尝试使用 GraphicsMagick 的命令行工具（它很容易编写脚本），但最接近的我可以简单地将 TIFF 标志写为预乘——它实际上并没有执行预乘。效果是一个有效的 alpha，但颜色褪色：

```
gm -convert <infile> -define tiff:alpha=associated <outfile> 
```

有人对如何实现这种转换有其他建议吗？我的主要要求是它需要在 Linux 服务器环境中实现自动化，最好是通过脚本或 PHP 库（因为它已经在工作流程的其他地方使用），但我在 PHP 位上很灵活。

* * *

**编辑：**

以下是两个文件（每个 42MB）供参考：

*   [具有未关联 alpha 的原始 TIFF](https://dl.dropbox.com/u/4829232/image.tif)
*   [来自 GM 的修改 TIFF，带有伪关联 alpha 和褪色](https://dl.dropbox.com/u/4829232/image-gm.tiff)

# c++ - 如何在 LLVM IR 中获取字符串文字的值？

> ID：12127137
> 
> 赞同：6
> 
> 时间：2012-08-26T02:13:15.470
> 
> 标签：c++, llvm, llvm-ir

我是 LLVM 新手。我正在尝试编写一个基本 Pass 来检查`printf`调用的参数，当它被赋予中间表示时。
如果格式字符串不是字符串文字，那么我当然无法检查它。但很多时候，确实如此。

我要检查的示例 IR 是：

```
@.str = private unnamed_addr constant [7 x i8] c"Hi %u\0A\00", align 1

define i32 @main() nounwind {
entry:
  %retval = alloca i32, align 4
  store i32 0, i32* %retval
  %call = call i32 (i8*, ...)* @printf(i8* getelementptr inbounds ([7 x i8]* @.str, i32 0, i32 0), i32 1)
  ret i32 0
}

declare i32 @printf(i8*, ...) 
```

我发现了预先存在的 Pass `ExternalFunctionsPassedConstants`，这似乎很相关：

```
struct ExternalFunctionsPassedConstants : public ModulePass {
  static char ID; // Pass ID, replacement for typeid
  ExternalFunctionsPassedConstants() : ModulePass(ID) {}
  virtual bool runOnModule(Module &M) {
    for (Module::iterator I = M.begin(), E = M.end(); I != E; ++I) {
      if (!I->isDeclaration()) continue;

      bool PrintedFn = false;
      for (Value::use_iterator UI = I->use_begin(), E = I->use_end();
           UI != E; ++UI) {
        Instruction *User = dyn_cast<Instruction>(*UI);
        if (!User) continue;

        CallSite CS(cast<Value>(User));
        if (!CS) continue;

        ... 
```

所以我添加了代码：

```
 if (I->getName() == "printf") {
          errs() << "printf() arg0 type: "
                 << CS.getArgument(0)->getType()->getTypeID() << "\n";
        } 
```

到目前为止，一切都很好——我看到类型 ID 是 14，这意味着它是一个`PointerTyID`.

但是现在，我如何获取作为参数传递的字符串文字的*内容*，以便我可以根据实际给出的数字验证预期参数的数量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T14:57:17.130

```
CS.getArgument(0) 
```

表示 GetElementPtrConstantExpr

```
i8* getelementptr inbounds ([7 x i8]* @.str, i32 0, i32 0) 
```

，它是一个用户对象。您想要的字符串（即@.str）是这个GetElementPtrConstantExpr 的第一个操作数。

因此，您可以通过

```
CS.getArgument(0).getOperand(0) 
```

但是，我还没有测试过这段代码。如果有任何错误，请告诉我。

# iphone - How to mask UITableViewCells underneath a UITableView Transparent Header

> ID：12127138
> 
> 赞同：31
> 
> 时间：2012-08-26T02:13:39.337
> 
> 标签：iphone, objective-c, ios

I want the header to mask the cells, but not the background.

I have a UITableView with transparent headers and cells similar to Apple's Notification Center (when you swipe down on the status bar on your iPhone). I can't figure out how to mask the cells so they don't show up underneath the header when it scrolls.

I've tried changing the contentInsets of the tableview, and I've tried changing the frame of the header View to a negative origin.

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-12-06T03:06:15.980

Try to make a subclass of `UITableviewCell` and add these methods

```
- (void)maskCellFromTop:(CGFloat)margin {
    self.layer.mask = [self visibilityMaskWithLocation:margin/self.frame.size.height];
    self.layer.masksToBounds = YES;
}

- (CAGradientLayer *)visibilityMaskWithLocation:(CGFloat)location {
    CAGradientLayer *mask = [CAGradientLayer layer];
    mask.frame = self.bounds;
    mask.colors = [NSArray arrayWithObjects:(id)[[UIColor colorWithWhite:1 alpha:0] CGColor], (id)[[UIColor colorWithWhite:1 alpha:1] CGColor], nil];
    mask.locations = [NSArray arrayWithObjects:[NSNumber numberWithFloat:location], [NSNumber numberWithFloat:location], nil];
    return mask;
} 
```

and add this delegate method in `UITableView`

```
#pragma mark - UIScrollViewDelegate

- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    for (iNotifyTableViewCell *cell in self.visibleCells) {
        CGFloat hiddenFrameHeight = scrollView.contentOffset.y + [iNotifyHeaderView height] - cell.frame.origin.y;
        if (hiddenFrameHeight >= 0 || hiddenFrameHeight <= cell.frame.size.height) {
            [cell maskCellFromTop:hiddenFrameHeight];
        }
    }
} 
```

*Note that `[iNotifyHeaderView height]` is the height of the `HeaderView`. and use `#import <QuartzCore/QuartzCore.h>` for the custom cell.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-07-17T09:54:10.447

A little edit on Alex Markman's answer, where you could skip creating a subclass for an UITableViewCell. Benefit of this approach is that you can use it for multiple different UITableViewCells.

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView {
    for (UITableViewCell *cell in self.tableView.visibleCells) {
        CGFloat hiddenFrameHeight = scrollView.contentOffset.y + self.navigationController.navigationBar.frame.size.height - cell.frame.origin.y;
        if (hiddenFrameHeight >= 0 || hiddenFrameHeight <= cell.frame.size.height) {
            [self maskCell:cell fromTopWithMargin:hiddenFrameHeight];
        }
    }
}

- (void)maskCell:(UITableViewCell *)cell fromTopWithMargin:(CGFloat)margin
{
    cell.layer.mask = [self visibilityMaskForCell:cell withLocation:margin/cell.frame.size.height];
    cell.layer.masksToBounds = YES;
}

- (CAGradientLayer *)visibilityMaskForCell:(UITableViewCell *)cell withLocation:(CGFloat)location
{
    CAGradientLayer *mask = [CAGradientLayer layer];
    mask.frame = cell.bounds;
    mask.colors = [NSArray arrayWithObjects:(id)[[UIColor colorWithWhite:1 alpha:0] CGColor], (id)[[UIColor colorWithWhite:1 alpha:1] CGColor], nil];
    mask.locations = [NSArray arrayWithObjects:[NSNumber numberWithFloat:location], [NSNumber numberWithFloat:location], nil];
    return mask;
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-02-08T12:29:10.200

@Alex Markman - your answer is great and was very usefull for me, but I found that when you're scrolling on retina devices, the cells do not scroll smoothly. I found that it is caused by layer's `locations` parameter during the rendering process:

`mask.locations = [NSArray arrayWithObjects:[NSNumber numberWithFloat:location];`

I slightly modified your code. Maybe someone will find it useful:

```
- (void)maskCellFromTop:(CGFloat)margin
{
    self.layer.mask = [self visibilityMaskFromLocation:margin];
    self.layer.masksToBounds = YES;
}

- (CAGradientLayer *)visibilityMaskFromLocation:(CGFloat)location
{
    CAGradientLayer *mask = [CAGradientLayer layer];
    mask.frame = CGRectMake(
                            self.bounds.origin.x,
                            location+self.bounds.origin.y,
                            self.bounds.size.width,
                            self.bounds.size.height-location);
    mask.colors = @[
                    (id)[[UIColor colorWithWhite:1 alpha:1] CGColor],
                    (id)[[UIColor colorWithWhite:1 alpha:1] CGColor]
                    ];
    return mask;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-10-18T11:42:31.073

Swift version

```
func scrollViewDidScroll(_ scrollView: UIScrollView) { 
    for cell in tableView.visibleCells {
        let hiddenFrameHeight = scrollView.contentOffset.y + navigationController!.navigationBar.frame.size.height - cell.frame.origin.y
        if (hiddenFrameHeight >= 0 || hiddenFrameHeight <= cell.frame.size.height) {
            maskCell(cell: cell, margin: Float(hiddenFrameHeight))
        }
    }
}

func maskCell(cell: UITableViewCell, margin: Float) {
    cell.layer.mask = visibilityMaskForCell(cell: cell, location: (margin / Float(cell.frame.size.height) ))
    cell.layer.masksToBounds = true
}

func visibilityMaskForCell(cell: UITableViewCell, location: Float) -> CAGradientLayer {
    let mask = CAGradientLayer()
    mask.frame = cell.bounds
    mask.colors = [UIColor(white: 1, alpha: 0).cgColor, UIColor(white: 1, alpha: 1).cgColor]
    mask.locations = [NSNumber(value: location), NSNumber(value: location)]
    return mask;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-03-18T12:48:56.057

Clean Swift 3 Version:

```
extension YourViewController: UIScrollViewDelegate {
    func scrollViewDidScroll(_ scrollView: UIScrollView) {
        for cell in tableView.visibleCells {
            let hiddenFrameHeight = scrollView.contentOffset.y + navigationController!.navigationBar.frame.size.height - cell.frame.origin.y
            if (hiddenFrameHeight >= 0 || hiddenFrameHeight <= cell.frame.size.height) {
                if let customCell = cell as? CustomCell {
                    customCell.maskCell(fromTop: hiddenFrameHeight)
                }
            }
        }
    }
}

class CustomCell: UITableViewCell {
    public func maskCell(fromTop margin: CGFloat) {
        layer.mask = visibilityMask(withLocation: margin / frame.size.height)
        layer.masksToBounds = true
    }

    private func visibilityMask(withLocation location: CGFloat) -> CAGradientLayer {
        let mask = CAGradientLayer()
        mask.frame = bounds
        mask.colors = [UIColor.white.withAlphaComponent(0).cgColor, UIColor.white.cgColor]
        let num = location as NSNumber
        mask.locations = [num, num]
        return mask
    }
} 
```

I just used this and it works like a charm. I want to thank everyone in the post! Up votes all around!

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-27T07:06:13.137

I have two possible solutions, no code - just the idea:

1.  not generic, should work with the settup/design apple uses at the Notification Center.

Make the Section-Header opaque, 'clone' the background-pattern of the table as background of the section-Header. Position the background-pattern depending on the section-header offset.

* * *

1.  genereic, but probably more performance problems. Should work fine with few cells.

Add a Alpha Mask to all cell-layers. Move the Alpha Mask depending on the cell-position.

* * *

(use scrollViewDidScroll delegate method to maintain the background-pattern / Alpha-Mask offset).

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-02T19:57:58.417

I ended up setting the height of the section header to its minimum, and overriding UITableView's layoutSubviews to place the header on the tableView's superview, adjusting the frame's origin upward by its height.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-22T11:15:31.797

The Swift 3 version didn't work for me because I added the UITableViewController as a subview. So I had to make some changes in the extension of the scrollview.

This should also work with UITableViewController that have been pushed from another ViewController (Note: not tested)

```
extension NavNotitionTableViewController {
override func scrollViewDidScroll(_ scrollView: UIScrollView) {
    for cell in tableView.visibleCells {

        let calculatedY = cell.frame.origin.y - scrollView.contentOffset.y;
        if let customCell = cell as? NavNotitionTableViewCell {

            if(calculatedY < 44 && calculatedY > 0){
                let hideAmount = 44 - calculatedY;

                if let customCell = cell as? NavNotitionTableViewCell {
                    customCell.maskCell(fromTop: hideAmount)
                }
            }else if (calculatedY > 0){
                //All other cells
                customCell.maskCell(fromTop: 0)
            }else if (calculatedY < 0){
                customCell.maskCell(fromTop: cell.frame.height);
            }
        }
    }
}
} 
```

In this example, I first get the frame Y origin of the cell and distract the scollViews contentOffsetY.

The height of my custom section is 44\. So I define the hideAmount value for the mask.

The Cell functions are untouched:

```
public func maskCell(fromTop margin: CGFloat) {
    layer.mask = visibilityMask(withLocation: margin / frame.size.height)
    layer.masksToBounds = true
}

private func visibilityMask(withLocation location: CGFloat) -> CAGradientLayer {
    let mask = CAGradientLayer()
    mask.frame = bounds
    mask.colors = [UIColor.white.withAlphaComponent(0).cgColor, UIColor.white.cgColor]
    let num = location as NSNumber
    mask.locations = [num, num]
    return mask
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-19T03:03:56.253

This wouldn't work if you wanted to show content behind your table view, but, since I'm only trying to create rounded headers with a plain solid colour background behind them, what solved it for me was mimicking transparency by setting the background colour of the header's background view to the background colour of the table view (or the first parent view with an opaque background).

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2014-03-04T13:34:45.010

Or, if all you need is for your UI to look nice, you could

## change your table view to not have floating section headers

In two quick and easy steps (iOS 6):

1.  Change your UITableView style to UITableViewStyleGrouped. (You can do this from Storyboard/NIB, or via code.)

2.  Next, set your tableview's background view to a empty view like so [in either a method such as *viewDidAppear* or even in the *cellForRow* method (though I would prefer the former)].

> ```
> yourTableView.backgroundView = [[UIView alloc] initWithFrame:listTableView.bounds]; 
> ```

Voila, now you have your table view - but without the floating section headers. Your section headers now scroll along with the cells and your messy UI problems are solved!

Do try this out and let me know how it goes. Happy coding :)

EDIT: for iOS 7, simply change the table view style to '*UITableViewStyleGrouped*' and change the view's tint color to 'clear color'.

# javascript - Javascript 匹配

> ID：12127147
> 
> 赞同：2
> 
> 时间：2012-08-26T02:16:12.307
> 
> 标签：javascript, jquery

如何摆脱输出中的逗号（，）？有没有更好的方法从字符串或句子中搜索 url。

```
alert("   http://www.cnn.com  df".match(/https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w/_\.]*(\?\S+)?)?)?/)); 
```

警报的输出是：

```
http://www.cnn.com,,,, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:21:50.910

发生这种情况是因为`alert`会将 的结果`match`（一个数组）转换为字符串。要获取数组的相关部分，请使用以下命令：

```
alert("   http://www.cnn.com  df".match(/https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w/_\.]*(\?\S+)?)?)?/)[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T02:23:51.673

您 (*) 在您的正则表达式中使返回值成为具有多个匹配结果的数组。你可以使用`?:`

```
alert("   http://www.cnn.com  df".match(/https?:\/\/(?:[-\w\.]+)+(?::\d+)?(?:\/(?:[\w/_\.]*(?:\?\S+)?)?)?/)); 
```

或获取返回数组的第一个值：

```
alert("   http://www.cnn.com  df".match(/https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w/_\.]*(\?\S+)?)?)?/)[0]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T02:39:30.167

在你的正则表达式末尾添加一个`g`modifire。

```
 alert(
"http://www.cnn.com df".match(/https?:\/\/([-\w\.]+)+(:\d+)?(\/([\w/_\.]*(\?\S+)?)?)?/g)
); 
```

# python - Python构造函数参数不是随机错误？

> ID：12127148
> 
> 赞同：4
> 
> 时间：2012-08-26T02:16:13.487
> 
> 标签：python, random

我最近刚刚发现了这个奇怪的 Python 'bug'，我想看看是否有人知道更多关于它的信息！

以python模块为例：

```
import random

class SaySomething:
    def __init__(self, value=random.randint(1, 3)):
        if value == 1: print 'one'
        elif value == 2: print 'two'
        elif value == 3: print 'three'

a = 0

while a < 10:
    SaySomething()
    a += 1 
```

由于某种原因，此代码将打印相同的数字 10 次！！！现在我不明白。似乎连续 10 次使用相同的值调用构造函数。但是如果你打印每个`SaySomething()`你会发现它们都有不同的指针地址，所以它们不是同一个对象。

现在如果你改变：

```
SaySomething() 
```

至

```
SaySomething(random.randint(1, 3)) 
```

它按预期运行，并做出了实际的随机选择。

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-26T02:20:20.693

问题是 Python 中的默认参数在创建函数时被评估一次。要解决此问题，请尝试：

```
 def __init__(self, value = None):
        if value is None:
             value = random.randint(1, 3)

        if value == 1: print 'one'
        elif value == 2: print 'two'
        elif value == 3: print 'three' 
```

这样，我们将随机化转移到函数本身，而不是在函数定义时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T02:18:39.850

在 python 中，默认参数被初始化一次。因此，您一遍又一遍地获得相同的值，因为这是初始化默认参数时的值。见[http://www.deadlybloodyserious.com/2008/05/default-argument-blunders/](http://www.deadlybloodyserious.com/2008/05/default-argument-blunders/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-26T02:22:42.283

这是因为当类被编译或解释时，变量的值`value`被设置为`random.randint(1, 3)`，并且在你向它传递一些其他值之前它不会改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-26T02:21:32.673

出于与 Python 构造函数相同的原因，[使用可选参数会做一些奇怪的事情](https://stackoverflow.com/questions/2899643/python-constructor-does-weird-things-with-optional-parameters)

可选参数的默认值是单个实例，因此只为所有实例计算一次。

要解决这个问题：

```
import random 
class saySomething: 
    def __init__(self, value = None):
        random_value = random.randint(1, 3) if value == None else value
        if random_value in [1, 2, 3] print ['one', 'two', 'three'][random_value - 1]

for a in xrange(10):
    saySomething() 
```

# r - 在多行的单列中查找最大日期

> ID：12127149
> 
> 赞同：13
> 
> 时间：2012-08-26T02:16:29.930
> 
> 标签：r

我有以下数据框：

```
id       <- c(1,1,2,3,3)
date     <- c("23-01-08","01-11-07","30-11-07","17-12-07","12-12-08")
df       <- data.frame(id,date)
df$date2 <- as.Date(as.character(df$date), format = "%d-%m-%y")

id     date      date2
1   23-01-08 2008-01-23
1   01-11-07 2007-11-01
2   30-11-07 2007-11-30
3   17-12-07 2007-12-17
3   12-12-08 2008-12-12 
```

现在我需要创建第四列并在其中插入每个交易的最大日期`id`。决赛桌应如下：

```
id     date      date2        max
1   23-01-08 2008-01-23 2008-01-23
1   01-11-07 2007-11-01   0
2   30-11-07 2007-11-30 2007-11-30 
3   17-12-07 2007-12-17   0
3   12-12-08 2008-12-12 2008-12-12 
```

如果您能帮我解决这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-26T02:23:37.373

```
id<-c(1,1,2,3,3)
date<-c("23-01-08","01-11-07","30-11-07","17-12-07","12-12-08")
df<-data.frame(id,date)
df$date2<-as.Date(as.character(df$date), format = "%d-%m-%y")
# aggregate can be used for this type of thing
d = aggregate(df$date2,by=list(df$id),max)
# And merge the result of aggregate 
# with the original data frame
df2 = merge(df,d,by.x=1,by.y=1)
df2

  id     date      date2          x
1  1 23-01-08 2008-01-23 2008-01-23
2  1 01-11-07 2007-11-01 2008-01-23
3  2 30-11-07 2007-11-30 2007-11-30
4  3 17-12-07 2007-12-17 2008-12-12
5  3 12-12-08 2008-12-12 2008-12-12 
```

编辑：由于您希望在日期与最大日期不匹配时最后一列为“空”，因此您可以尝试下一行。

```
df2[df2[,3]!=df2[,4],4]=NA

df2
  id     date      date2          x
1  1 23-01-08 2008-01-23 2008-01-23
2  1 01-11-07 2007-11-01       <NA>
3  2 30-11-07 2007-11-30 2007-11-30
4  3 17-12-07 2007-12-17       <NA>
5  3 12-12-08 2008-12-12 2008-12-12 
```

当然，清理 colnames 等总是很好的，但我把它留给你。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-26T06:37:30.657

另一种方法是使用`plyr`包：

```
library(plyr)
ddply(df, "id", summarize, max = max(date2))

#  id        max
#1  1 2008-01-23
#2  2 2007-11-30
#3  3 2008-12-12 
```

现在这不是您所追求的格式，因为它只显示`id`一次。不要害怕，我们可以使用`transform`代替`summarize`：

```
ddply(df, "id", transform, max = max(date2))

#  id     date      date2        max
#1  1 01-11-07 2007-11-01 2008-01-23
#2  1 23-01-08 2008-01-23 2008-01-23
#3  2 30-11-07 2007-11-30 2007-11-30
#4  3 12-12-08 2008-12-12 2008-12-12
#5  3 17-12-07 2007-12-17 2008-12-12 
```

正如@seandavi 的回答一样，这会重复`max`每个`id`. 如果您想将重复项更改为`NA`，则可以执行以下操作：

```
within(ddply(df, "id", transform, max = max(date2)), max[max != date2] <- NA) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-09-25T21:32:43.000

添加`dplyr`解决方案以防有人正在寻找：

```
library(dplyr)

df %>%
  group_by(id) %>%
  mutate(max = if_else(date2 == max(date2), date2, as.Date(NA))) 
```

**结果：**

```
# A tibble: 5 x 4
# Groups:   id [3]
     id     date      date2        max
  <dbl>   <fctr>     <date>     <date>
1     1 23-01-08 2008-01-23 2008-01-23
2     1 01-11-07 2007-11-01         NA
3     2 30-11-07 2007-11-30 2007-11-30
4     3 17-12-07 2007-12-17         NA
5     3 12-12-08 2008-12-12 2008-12-12 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-26T03:46:03.077

您不能使用 0 作为 Date 值，因此您需要放弃将其保留为 Date 或接受 NA 值：

```
# Date values:
df$maxdt <- ave(df$date2, df$id, 
                    FUN=function(x) ifelse( x == max(x), as.character(x), NA) ) 
str(ave(df$date2, df$id, FUN=function(x) ifelse( x == max(x), as.character(x), NA) ) )
# Date[1:5], format: "2008-01-23" NA "2007-11-30" NA "2008-12-12" 
```

机器做了一些奇怪的`ifelse`类型检查，使用`x`上面的第二个参数失败了，但仍然返回日期类向量。去搞清楚！下面是字符向量选项。

```
# Character values:
df$maxdt <- ave(as.character(df$date2), df$id, 
                   FUN=function(x) ifelse( x == max(x), x,  "0") )
ave(as.character(df$date2), df$id, FUN=function(x) ifelse( x == max(x), x,  "0") )
[1] "2008-01-23" "0"          "2007-11-30" "0"          "2008-12-12" 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-26T03:18:11.163

```
library(sqldf)
tables<- '(SELECT * FROM df
           )
           AS t1,
           (SELECT id,max(date2) date2 FROM df GROUP BY id
           )
           AS t2'

out<-fn$sqldf("SELECT t1.*,t2.date2 mdate FROM $tables WHERE  t1.id=t2.id")
out$mdate<-as.Date(out$mdate)
out$mdate[out$date2!=out$mdate]<-NA
#  id     date      date2      mdate
#1  1 01-11-07 2007-11-01       <NA>
#2  1 23-01-08 2008-01-23 2008-01-23
#3  2 30-11-07 2007-11-30 2007-11-30
#4  3 12-12-08 2008-12-12 2008-12-12
#5  3 17-12-07 2007-12-17       <NA> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-25T22:25:31.177

当我想查看列的最小/最大日期时，我发现这会有所帮助

最大：`head(df %>% distinct(date) %>% arrange(desc(date)))`
最小：`head(df %>% distinct(date) %>% arrange(date))`

最大值将按降序对日期列进行排序，以便您查看最大值。最小值将按升序排序，以便您查看最小值。

您需要为此使用该`dplyr`软件包。

# python - 在 Mac OS X 中移动光标（在 Python 和/或 R 中）

> ID：12127150
> 
> 赞同：1
> 
> 时间：2012-08-26T02:16:56.913
> 
> 标签：python, macos, r

有人可以帮我弄清楚如何使用 Python 或 R 脚本在 Mac OS X 中移动光标吗？该计划是读取实时信号并根据流式值向上或向下移动光标。感谢您的帮助...谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T01:23:52.887

好吧，R 允许您使用 C，所以它闻起来像作弊，但有效：

```
library(inline)
move.cursor <- cfunction(c(x="numeric",y="numeric"),
  "CGWarpMouseCursorPosition(CGPointMake(asReal(x),asReal(y)));
   return R_NilValue;",
  "#include <ApplicationServices/ApplicationServices.h>",,"C",
  libargs="-framework AppKit") 
```

然后只需调用以下命令即可移动光标`move.cursor`：

```
move.cursor(100, 100) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T04:55:59.517

此外，如果有人想做键盘事件，这就是它的完成方式。以下是输入数字的代码：

```
which.key <- 1
eval(parse(text = paste("c.key <- 'CGEventRef e = CGEventCreateKeyboardEvent(NULL, (CGKeyCode)", which.key+17, ", true); CGEventPost(kCGSessionEventTap, e); CFRelease(e); return R_NilValue;'", sep = "")))

KeyPress <- cfunction(
    body = c.key,
    includes = "#include <ApplicationServices/ApplicationServices.h>",
    language = "C",
    libargs = "-framework AppKit")

KeyPress() 
```

# ruby - 导轨不工作

> ID：12127153
> 
> 赞同：0
> 
> 时间：2012-08-26T02:17:57.323
> 
> 标签：ruby, ruby-on-rails-3

不久前我安装了导轨。现在，当我`rails new foo` 在终端做任何事情时，什么都没有发生。我有红宝石 1.9.2。当我做 gem list 时，我可以看到 rails (3.2.8)。但是，执行任何 rails 命令，包括`rails`它自己在内，什么都不做。

我也试过`sudo gem cleanup`和`sudo gem clean`。`sudo gem uninstall rails`然后 `sudo gem install rails`。这给了我

```
Fetching: rails-3.2.8.gem (100%)
Successfully installed rails-3.2.8
1 gem installed
Installing ri documentation for rails-3.2.8...
file 'lib' not found
Installing RDoc documentation for rails-3.2.8...
file 'lib' not found 
```

任何帮助，将不胜感激。

编辑：问题是我定义了一个名为 rails 的 shell 别名，它正在屏蔽 rails。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:22:23.520

做`gem install rails`- 不`sudo`

然后`rails new foo`

# php - 使用 simplexml_load_string 提取属性

> ID：12127164
> 
> 赞同：1
> 
> 时间：2012-08-26T02:20:12.597
> 
> 标签：php

我正在尝试将链接的 href 属性提取为字符串。

```
<a href="http://example.com" target="_blank" class="someclass">Read More</a> 
```

我正在使用以下内容来读取提取属性：

```
$link = simplexml_load_string($ad['meta_value']);
$order['logo'] = $logo['href']->asXML(); 
```

而不是得到`http://example.com`我得到`href="http://example.com"`。除了使用 str_replace() 之外，还有没有办法将属性提取为字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:37:06.880

视为`@attributes`对象并转换为字符串：

```
$link = simplexml_load_string($ad['meta_value']);
echo (string) $link->attributes()->href; 
```

# mysql - 在 Where 子句中使用多个名称/值对的 SQL 查询

> ID：12127171
> 
> 赞同：0
> 
> 时间：2012-08-26T02:21:57.883
> 
> 标签：mysql, sql, join

我有一个名为 `Properties`(pid, uid, pname, pvalue) 的表。pid 列是自动生成的。每个 uid（用户 id）可以有多个名称值对存储在 pname 和 pvalue 中。

作为输入，我有多个 pname 和 pvalue 的名称值对，它们形成了一个复杂的布尔表达式。

例如：让我们从一个名称值对开始。假设我想检索所有 'favorite_color' 为 'red' 的 uid。

我写了一个 SQL 查询：

```
SELECT * 
  FROM properties 
 WHERE ((pname = 'favorite_color') and (pvalue = 'red')) 
```

如果我必须检索类似的东西，查询很快就会变得复杂，获取所有 uid，其 'favorite_color' 是 'red' 或 'blue' 并且 'favorite_drink' 是 'juice' 或' 'milk' 并且 'favorite_hobby' 是 'music'或“艺术”等

我写了一个 SQL 查询：

```
SELECT * 
  FROM properties 
 WHERE (((pname = 'favorite_color') and (pvalue = 'red')) 
    OR ((pname = 'favorite_color') and (pvalue = 'blue'))) 
   AND (((pname = 'favorite_drink') and (pvalue = 'juice')) 
    OR ((pname = 'favorite_drink') and (pvalue = 'milk'))) 
   AND (((pname = 'favorite_hobby') and (pvalue = 'music')) 
    OR ((pname = 'favorite_hobby') and (pvalue = 'art'))) 
```

我得到了正确的表达式，但不幸的是它失败了，因为评估是在每一行上完成的。如果我想在 where 子句中添加更多名称值对怎么办？

问题：

1.  是否可以为此编写 SQL 查询？

2.  我的另一个想法是获取每个用户的所有 pname、pvalue 对，使用表达式语言和我的输入名称值 paris 构建动态表达式来评估它。我想到了 apache 的 JEXL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:22:58.543

要执行 AND，您需要根据 and-ed 条件执行尽可能多的自联接：

```
SELECT *
FROM Properties p1, Properties p2, Properties p3
WHERE p1.uid = p2.uid AND p1.uid = p3.uid
AND (p1.pname = 'favorite_color' AND p1.pvalue IN ('red', 'blue'))
AND (p2.pname = 'favorite_drink' AND p2.pvalue IN ('juice', 'milk'))
AND (p3.pname = 'favorite_hobby' AND p2.pvalue IN ('music', 'art')) 
```

编辑：

另一种可能性是对数据进行非规范化，然后使用`FIND_IN_SET()`or `RLIKE`：

```
SELECT uid, group_concat(concat(pname, '=', pvalue)) props
FROM Properties
GROUP BY uid
HAVING props RLIKE 'favorite_color=(red|blue)'
AND props RLIKE 'favorite_drink=(juice|milk)'
AND props RLIKE 'favorite_hobby=(music|art)' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:30:17.070

```
SELECT p1.*,p2.pname,p2.pvalue,p3.pname,p3.pvalue
FROM (
       (Select * 
        from Properties  
        where (pname = 'favorite_color' AND pvalue IN ('red', 'blue')) p1, 
       (Select * 
        from Properties  
        where (pname = 'favorite_drink' AND pvalue IN ('juice','milk')) p2, 
       (Select * 
        from Properties  
        where (pname = 'favorite_hobby' AND pvalue IN ('music', 'art')) p3, 
     )
WHERE p1.uid = p2.uid AND p1.uid = p3.uid 
```

# php - 网站的插入/删除查询设计

> ID：12127176
> 
> 赞同：0
> 
> 时间：2012-08-26T02:22:53.470
> 
> 标签：php

我想知道处理网站插入/删除请求的专业方法是什么？

现在，我`<input type = "hidden"/>`在每个表单上插入了两个，其中一个隐藏的值对应于它需要的函数，另一个是该函数的参数。因此，当表单提交时，我有一个 post.php 文件来处理所有插入/删除请求，这些请求只是通过`call_user_func()`PHP 调用隐藏的值。像这样：

```
<input name = "arg" value = "{$id}" type = "hidden"/>
<input name = "call" value = "delete_member" type = "hidden"/>

call_user_func($_POST['call'], $_POST['arg']); 
```

我怀疑这个解决方案的合理性，因为我发现隐藏部分实际上并没有隐藏在客户端的源代码中。

我的第一个解决方案基本上是有很多条件检查要调用哪个函数，但我真的很讨厌这个，所以我用这个解决方案改变了它。

我想知道有什么更好的方法可以做到这一点，或者专业人士是如何做到的？处理插入/删除查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:41:31.183

我认为这是从客户端调用操作的一种非常糟糕的方式。

一方面，这些数据被放入 HTML 中，客户端始终可以查看和编辑。因此，这意味着您无法信任从客户端收到的数据，因此您无法信任他们正在调用的函数。

再强调一点我之前的想法。你说你运行验证以确保它是一个函数等等，但是你有一个问题。闭包在这些函数上返回 true（因为它们是函数和方法并且它们存在）。因此，用户可以将匿名函数作为隐藏字段的值，并在服务器上实际运行他们想要的任何内容。

正如其他人所说，我建议研究 MVC。查看 Yii/CodeIgniter/Zend/Lithium/Kohana/etc 是如何做到这一点的以及它们是如何路由的。

我最喜欢的框架 Yii 如何为删除等操作进行路由的示例：

```
class UserController extends CController{
    public function actionDelete($id = null){
       if($id===null){ return false; }
    }
} 
```

然后表单/链接调用`/user/delete?id=2`使 index.php 路由到`userController`并使用`actionDelete`用户控制器内部的函数，运行它的代码。当然，这是一个非常简化的版本，阻止漏洞变得更加复杂。

您可能还希望查看 CSRF 验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T02:41:53.100

最常见的方法是只调用一个函数来处理一个表单，就像这个提交博客消息的例子一样：

**博客.php**

```
if(isset($_POST['submit'])) {
  save_message();
} else {
  display_form();
}

function display_form()
{
  ?>
  <form action="blog.php"> etc etc....
  <?php
}

function save_message()
{
  //security checks and inserts etc
  $_SESSION['message'] = 'Form saved succesfully';
  header('location: blog_overview.php');
} 
```

在我看来，这是一种实践，但您可能想要检查 Codeigniter 和 Kohana 等框架，因为上面的代码是功能性的（而且对我来说已经过时了）。阅读一些关于 OOP（面向对象编程）和 MVC（模型视图控制器）的教程。看起来工作量很大，但如果你真的想让它做对，那就值得花时间和精力。

# php - paypal沙箱支付成功，但我的脚本没有收到ipn post call

> ID：12127182
> 
> 赞同：0
> 
> 时间：2012-08-26T02:24:15.473
> 
> 标签：php, paypal

我正在使用贝宝沙箱进行开发，所有支付流程都可以顺利进行，没有任何错误。我在我的表单中设置了“notify_url”，并且此 url 可以通过即时付款通知 (IPN) 模拟器成功测试。

Paypal 沙箱告诉我付款成功完成，但我的 ipn 处理程序无法收到任何请求。

顺便说一句，我正在使用这个 ipn 库：[https ://github.com/Quixotix/PHP-PayPal-IPN](https://github.com/Quixotix/PHP-PayPal-IPN)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T09:57:18.487

你能确认你的 IPN 历史是/保持空白吗？

对我来说，Paypal 的沙盒 IPN 似乎又出现了问题。直到大约 2 周前，他们还有类似的问题： [https ://www.x.com/developers/paypal/forums/instant-payment-notifications-ipn-payment-data-transfer-pdt/ipn-failing-hasn-t-被改变的](https://www.x.com/developers/paypal/forums/instant-payment-notifications-ipn-payment-data-transfer-pdt/ipn-failing-hasn-t-been-changed)

我可以确认它再次工作，正如 x.com 上的线程所说，但大约 2 或 3 天（我猜）我不再收到任何 IPN，尽管付款本身处理得很好。

x.com 上已经有一个新线程可以解决我们的问题，但不幸的是，到目前为止还没有答案：[https ://www.x.com/developers/paypal/forums/instant-payment-notifications-ipn-payment -data-transfer-pdt/ipn-message-not-sent-url-提到-under-notify-_url-sandbox](https://www.x.com/developers/paypal/forums/instant-payment-notifications-ipn-payment-data-transfer-pdt/ipn-message-not-sent-url-mentioned-under-notify-_url-sandbox)

顺便说一句：我很确定这与 PHP 或您使用的库无关，因为我在使用 Ruby 时遇到了同样的问题，而在 x.com 上询问的人正在使用 Java。

# java - VAADIN -- 动态添加 TextField

> ID：12127183
> 
> 赞同：1
> 
> 时间：2012-08-26T02:24:22.157
> 
> 标签：java, vaadin

在 VAADIN 组件中，用户应该可以选择插入一个到 N 个问题的答案。

最初应该有一个文本字段用于第一个带有按钮的答案（“添加另一个答案”）

在 Button Push 应该为第二个答案添加一个新的文本字段，依此类推......

我的问题是，如何在按钮推送时实现新文本字段的动态加载？

我添加了一张我如何想象这个问题的图片。

![在此处输入图像描述](../Images/d45db3b9229c570e1525c5afdcdd3d27.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T09:17:38.907

只需向按钮添加一个单击侦听器，即可将文本字段添加到布局中。基本 Vaadin，没有技巧。

如果您的代码不起作用，请将其添加到您的问题中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-06T01:01:41.337

将 Textfield 置于其自己的垂直布局中，每当单击按钮时，将新的 Textfield 添加到垂直布局中。

当检索答案时，获取对垂直布局的引用并调用 getChildren()，这将返回垂直布局中的所有 TextField。

像这样的东西：

```
List<String> answers = verticalLaout.getChildren()
                                   .stream()
                                   .map(TextField::getValue)
                                   .collect(asList()); 
```

# java - Graphics.setXORMode(Color) 简单来说是做什么的？

> ID：12127187
> 
> 赞同：2
> 
> 时间：2012-08-26T02:25:20.533
> 
> 标签：java, xor

这是我读到的内容，但无法准确理解它的作用：

> 实现橡皮筋的一种方法是在 XOR 模式下绘制。通过为图形上下文调用 setXORMode() 方法并向其传递颜色（通常是背景颜色）来设置 XOR 模式。在这种模式下，像素不会直接写入屏幕。您正在绘制的颜色与当前显示的像素颜色以及您指定的第三种颜色通过异或运算将它们组合在一起，并将生成的像素颜色写入屏幕。第三种颜色通常设置为背景色，因此写入的像素颜色是以下操作的结果：
> 
> `resultant_Color = foreground_color^background_color^current_color`

我知道 XORing 是如何工作的，但不知道上面的段落是什么意思。请为我解释

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:13:34.963

它采用颜色并应用 XOR 掩码，就像常规 XOR 将位掩码一样，除了它在 RGB 颜色上，因此如果它覆盖具有相同值或相反值的颜色，它会产生您传入的颜色如果值不同，则为 RGB 和颜色以及低于其 RGB 的颜色。

只需编写一些代码并尝试一下，就会立即明白会发生什么。

# qt - 在这里使用什么正确的变量，它代表 .pro 文件中的 TARGET 字段

> ID：12127188
> 
> 赞同：3
> 
> 时间：2012-08-26T02:25:21.043
> 
> 标签：qt, qt-creator

我想添加一个自定义命令，它将作用于生成的二进制文件（*.pro 文件中的目标字段），

![在此处输入图像描述](../Images/3da295a9e00675de994525b78a79b05e.png)

但是我应该在这里使用什么，在`Command arguments`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T11:47:09.020

恐怕这是不可能的。QtCreator 只处理源和构建目录。QtCreator[文档](http://doc.qt.nokia.com/qtcreator-2.3/creator-build-settings.html#using-qt-creator-variables)说：

> 以下 Qt Creator 变量可用：
> 
> ```
>  %{buildDir}
>     %{sourceDir} 
> ```

请注意，目标甚至不必位于构建目录中。build 目录是运行 qmake 的地方，通常会导致目标被放在那里，因为在 .pro 文件中通常会指定`TARGET = projectName`.

进一步注意 QtCreator 构建步骤配置仅适用*于 QtCreator*。当其他人在没有 QtCreator 的情况下工作（他们应该只运行 qmake 和 make 来构建您的应用程序）需要您的自定义构建步骤时，不应使用此选项。

话虽如此，假设您要定义*构建后步骤*，您应该寻找一种解决方案来在 .pro 文件中定义此类（通过使用`$${TARGET}`变量），以便 qmake 在链接步骤之后将您的构建步骤放入 Makefile .

如果您想在链接后执行命令，假设调用自定义脚本（Windows 上的批处理脚本，否则为 bourne shell 脚本），将 TARGET 作为参数，将以下内容添加到您的 .pro 文件中：

```
win32 {
    poststep.commands = @myScript.bat $${TARGET}
}
!win32 {
    poststep.commands = @./myScript.sh $${TARGET}
}

QMAKE_EXTRA_TARGETS += poststep 
```

# java - Java Web 应用程序在一段时间后停止工作

> ID：12127192
> 
> 赞同：0
> 
> 时间：2012-08-26T02:27:22.750
> 
> 标签：java, jsp, netbeans, glassfish

当我运行使用 Netbeans 制作的 Java Web App 时，它运行完美，没有任何问题，一切似乎都正常，但如果我离开它，经过一段时间的空闲时间，如果想用它做任何事情（主要是从数据库加载行, jquery, ajax)，什么都没有发生，当我刷新页面时，我得到了这个错误。

![在此处输入图像描述](../Images/90a15f98d03d2bdcccd6c473af12d674.png)

很抱歉，我无法在此处发布日志，它太大了，每次粘贴时我的浏览器都会崩溃，而且当它工作时，Stackoverflow 有限制......所以我上传了它，这是链接。

[http://www.crocko.com/99F6AEF8373B425A885BD379686EF2C5/server.log_2012-08-11T05-03-18](http://www.crocko.com/99F6AEF8373B425A885BD379686EF2C5/server.log_2012-08-11T05-03-18)

```
StandardWrapperValve[JoinPart]: PWC1406: Servlet.service() for servlet JoinPart threw exception
java.lang.NumberFormatException: null
    at java.lang.Integer.parseInt(Integer.java:454)
    at java.lang.Integer.parseInt(Integer.java:527)
    at JoinPart.doGet(JoinPart.java:315)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770 
```

编辑：当前项目是包含 servlet 的先前项目的`JoinPart.java`副本，创建此副本后，我删除了此 servlet，因为我不再需要它，我不知道它是否仍然存在于该项目的某些痕迹中，如何我可以摆脱它吗？这个 servlet 已经被删除了，我检查了 javascript 文件，它们都没有包含这个 servlet 上的 ajax 请求，我应该创建一个全新的项目而不是复制，我怎样才能摆脱这个 servlet 的任何痕迹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:34:25.540

鉴于症状和非常少的信息，我猜您正在使用会话中的某些内容。离开它一段时间你超时。由于您在下一个请求时超时，您将获得一个新会话，并且它不再按照您期望的方式设置。你在会话中引用了一些东西，它是空的，你没有检查那种情况。堆栈跟踪应该告诉您在哪里引用该内容。

当然，这只是推测。当您提供更多信息时，您将获得更好的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T11:26:18.033

如果您打算从事完全不同的工作，切勿复制项目，始终创建新项目！

# jquery - 在 mvc 中为部分视图实现分页的最佳方法

> ID：12127196
> 
> 赞同：3
> 
> 时间：2012-08-26T02:30:05.800
> 
> 标签：jquery, ajax, asp.net-mvc, partial-views

为部分视图实现分页系统（上一个，下一个）的方法是什么？我的第一个想法是实现单独的部分视图，其中包含输入来决定页面是否可以上一个、下一个或完成。从那里控制器将决定从输入中路由什么。

实现这种场景的最佳实践方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T03:06:07.540

这是 MVC 上一个有趣的向导实现：http: [//afana.me/post/create-wizard-in-aspnet-mvc-3.aspx](http://afana.me/post/create-wizard-in-aspnet-mvc-3.aspx)

它不会为每个“页面”使用单独的部分，但您可能仍然喜欢该实现。

# c++ - 排序运算符在 C++ 中不起作用

> ID：12127197
> 
> 赞同：2
> 
> 时间：2012-08-26T02:31:24.673
> 
> 标签：c++, sorting, std-pair

我在使用排序运算符时遇到了问题，因为我只需要对对中的第一个元素进行排序。代码很简单，但不起作用：

运算符定义在：

```
struct sort_pred {
    bool operator()(const CromosomaIndex &left, const CromosomaIndex &right) { 
        return left.first < right.first;
    }
}; 
```

类型是

```
typedef std::pair<double,int> CromosomaIndex; 
```

我正在尝试像这样对数组进行排序：

```
CromosomaIndex nuevo[2];
nuevo[0].first = 0.01;
nuevo[0].second = 0;
nuevo[1].first = 0.009;
nuevo[1].second = 1;
int elements = sizeof(nuevo) / sizeof(nuevo[0]);
sort(nuevo, nuevo+ elements, sort_pred()); 
```

但问题是这是对第一个和第二个元素进行排序，我只想对第一个元素进行排序并保持第二个元素不变。有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T02:35:04.460

如果您希望结果取决于原始顺序，请使用[`std::stable_sort`](http://en.cppreference.com/w/cpp/algorithm/stable_sort).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T02:36:46.707

这种方法将配对作为一个单独的单元进行排序，这是预期要做的：分解配对的 a`first`和 the永远没有意义`second`。如果您只想对`first`项目进行排序并将其留`second`在原处，您最终会得到一组不同的对。

如果您想将 与`first`分开排序`second`，请将它们放在单独的数组中（更好的是，使用`vector`s）并对第一个向量进行排序。然后迭代两个向量，并制作一组新的对。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T03:58:18.773

我不确定您是否理解另一个问题的答案，但您确实希望根据`double`值对整对进行重新排序。原始索引 (the `int`) 必须附加到`double`原始向量中该位置的那个，以便您可以恢复该位置。请注意，如果您只对`double`中的进行排序`pair`，那么 的值`int`将是数组中的位置......根本不需要将其作为基准进行维护。

或者，您可以考虑类似（尽管略有不同）的解决方案。创建一个整数向量，该向量使用范围内的值进行初始化，`[0..N)`其中`N`是双精度向量的大小。然后使用比较器函子对索引向量进行排序，而不是查看`int`传入的值 ()，而是检查原始`double`向量中的值：

```
struct dereference_cmp {
   std::vector<double> const & d_data;
   dereference_cmp( std::vector<double> const & data ) : d_data(data) {}
   bool operator()( int lhs, int rhs ) const {
      return d_data[lhs] < d_data[rhs];
   }
};
std::vector<double> d = ...;
std::vector<int> ints;
ints.reserve( d.size() );
for ( int i = 0; i < d.size(); ++i ) ints.push_back(i);
std::sort( d.begin(), d.end(), dereference_cmp(d) ); 
```

在这种方法中，请注意，没有被重新排序的是`double`s，而是索引向量。完成后，索引向量将包含=>`sort`的向量中的位置。`double``i < j``d[ ints[i] ] <= d[ ints[j] ]`

请注意，在整个过程中，您要重新排序的是索引（在原始方法中能够重建未排序的向量，在这种方法中能够以排序顺序找到值），并且原始向量在那里只是为了提供排序的标准。

另请注意，仅对索引而不是具有值和索引的修改容器进行排序的唯一原因是，如果*移动*数据的成本很高（假设每个数据都是一个不能廉价移动的大对象，如一个包含数据数组（而非向量）的结构）。

# php - 如何获取先前查找的行的 MySQL 主键？

> ID：12127198
> 
> 赞同：0
> 
> 时间：2012-08-26T02:32:10.557
> 
> 标签：php, mysql, html, css, database

```
$query_check_domain_exists = "SELECT * FROM schools where domain ='$email_domain'";
$result_check_domain_exists = mysqli_query($d_schools, $query_check_domain_exists);
$school_ID_result = ? 
```

$school_ID_result 变量需要包含它刚刚查找的行的 school_ID（主键）（只有一个）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:43:04.817

添加[mysqli_fetch_assoc()](http://www.php.net/manual/en/mysqli-result.fetch-assoc.php)然后获取`school_ID`from 数组：

```
$query_check_domain_exists = "SELECT * FROM schools where domain ='$email_domain'";
$result_check_domain_exists = mysqli_query($d_schools, $query_check_domain_exists);
$row = mysqli_fetch_assoc($result);
$school_ID_result = $row['school_ID']; 
```

# java - 下载 JR 报告时出现 Java 堆空间内存错误

> ID：12127203
> 
> 赞同：0
> 
> 时间：2012-08-26T02:33:29.063
> 
> 标签：java, jasper-reports, out-of-memory, heap-memory

我正在从数据库中获取数据（表 911830 中的记录）并将其添加到*JR*报告中以获取 1000 条记录，其工作正常。当我超过或某个时间给出 Java 堆空间内存错误作为此问题的标题时，它与 Java 堆内存有关，但我将其增加 3Gb 作为（Xms3072m-Xmx3072m）。但仍然得到同样的错误

我的系统配置如下::

1.  64位没问题
2.  Redhat/ CentOS（最新版本）
3.  120GB RAID 配置
4.  2GB RAM 和 2CPU 机器

控制台错误::

```
Aug 26, 2012 7:11:14 AM org.apache.catalina.core.ApplicationDispatcher invoke
SEVERE: Servlet.service() for servlet `enter code here`jsp threw exception
java.lang.OutOfMemoryError: Java heap space
    at com.opensymphony.module.sitemesh.html.util.CharArray.grow(CharArray.java:267)
    at com.opensymphony.module.sitemesh.html.util.CharArray.append(CharArray.java:117)
    at com.opensymphony.module.sitemesh.html.tokenizer.Parser$ReusableToken.writeTo(Parser.java:343)
    at com.opensymphony.module.sitemesh.html.State.handleText(State.java:64)
    at com.opensymphony.module.sitemesh.html.HTMLProcessor$2.text(HTMLProcessor.java:103)
    at com.opensymphony.module.sitemesh.html.tokenizer.Parser.parsedText(Parser.java:295)
    at com.opensymphony.module.sitemesh.html.tokenizer.Parser.start(Parser.java:109)
    at com.opensymphony.module.sitemesh.html.tokenizer.TagTokenizer.start(TagTokenizer.java:33)
    at com.opensymphony.module.sitemesh.html.HTMLProcessor.process(HTMLProcessor.java:90)
    at com.opensymphony.module.sitemesh.parser.HTMLPageParser.parse(HTMLPageParser.java:52)
    at com.opensymphony.sitemesh.compatability.PageParser2ContentProcessor.build(PageParser2ContentProcessor.java:51)
    at com.opensymphony.sitemesh.webapp.ContentBufferingResponse.getContent(ContentBufferingResponse.java:54)
    at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:137)
    at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:143)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)
    at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)
    at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1063)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:801)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
Aug 26, 2012 7:11:14 AM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet action threw exception
java.lang.OutOfMemoryError: Java heap space
    at com.opensymphony.module.sitemesh.html.util.CharArray.grow(CharArray.java:267)
    at com.opensymphony.module.sitemesh.html.util.CharArray.append(CharArray.java:117)
    at com.opensymphony.module.sitemesh.html.tokenizer.Parser$ReusableToken.writeTo(Parser.java:343)
    at com.opensymphony.module.sitemesh.html.State.handleText(State.java:64)
    at com.opensymphony.module.sitemesh.html.HTMLProcessor$2.text(HTMLProcessor.java:103)
    at com.opensymphony.module.sitemesh.html.tokenizer.Parser.parsedText(Parser.java:295)
    at com.opensymphony.module.sitemesh.html.tokenizer.Parser.start(Parser.java:109)
    at com.opensymphony.module.sitemesh.html.tokenizer.TagTokenizer.start(TagTokenizer.java:33)
    at com.opensymphony.module.sitemesh.html.HTMLProcessor.process(HTMLProcessor.java:90)
    at com.opensymphony.module.sitemesh.parser.HTMLPageParser.parse(HTMLPageParser.java:52)
    at com.opensymphony.sitemesh.compatability.PageParser2ContentProcessor.build(PageParser2ContentProcessor.java:51)
    at com.opensymphony.sitemesh.webapp.ContentBufferingResponse.getContent(ContentBufferingResponse.java:54)
    at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:137)
    at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:143)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)
    at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)
    at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1063)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:801)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T05:25:34.227

您是否尝试过分析您的应用程序？

尝试进行内存转储并进行调查，也许您的内存中有太多相同类型的对象/一些非常大的对象会占用您所有的内存。

您可以考虑使用 JVisualVM 或您组织中可用的任何其他配置文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T13:22:28.310

可能比尝试对内存转储进行排序更容易尝试[Plumbr](http://plumbr.eu)。它在发现内存泄漏方面非常好。

# bash - 删除 ~/.bash_profile 后检索加载的 bash 配置文件

> ID：12127205
> 
> 赞同：6
> 
> 时间：2012-08-26T02:34:32.563
> 
> 标签：bash, shell

我正在使用一个程序，它删除了我的 .bash_profile，很遗憾我已经好几个月没有备份了。但是，我打开了一个我不会关闭的终端，该终端已加载文件。

有什么可能的方法可以从当前终端“导出”加载的 bash 别名等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T02:51:45.573

```
alias > my_aliases 
```

可以给你一些别名，但如果你有数百个，你可能想用`comm(1)`它来识别另一个文件中的别名。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-26T03:28:19.563

```
declare 
```

将转储当前 shell 中的所有变量和函数。（也会如此`set`。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-26T02:39:16.083

`env`您可以使用以下命令至少获得其中的一部分：

```
env >template_bash_profile 
```

然后从那开始工作。

# ant - Capistrano 使用 Ant 构建脚本

> ID：12127206
> 
> 赞同：0
> 
> 时间：2012-08-26T02:34:42.900
> 
> 标签：ant, capistrano

我有一个 PHP 应用程序，我已经使用 Capistrano 部署了一段时间。我想在本地压缩 js 和 css 并在部署到服务器之前执行其他清理任务。我目前`build_script`用来进行 Ant 调用：

```
set :build_script, "ant compress -q" 
```

我不确定这是否仅限于 Windows，但我的部分输出如下所示：

```
executing locally: ant compress -q

{$HOME}\AppData\Local\Temp\20120826020126>/*
'/*' is not recognized as an internal or external command,
operable program or batch file.

{$HOME}\AppData\Local\Temp\20120826020126>Licensed to the Apache Software Foundation (ASF) under one or more
'Licensed' is not recognized as an internal or external command,
operable program or batch file.

{$HOME}\AppData\Local\Temp\20120826020126>contributor license agreements.  See the NOTICE file distributed with
'contributor' is not recognized as an internal or external command,
operable program or batch file.

{$HOME}\AppData\Local\Temp\20120826020126>this work for additional information regarding copyright ownership.
'this' is not recognized as an internal or external command,
operable program or batch file.

{$HOME}\AppData\Local\Temp\20120826020126>The ASF licenses this file to You under the Apache License, Version 2.0
'The' is not recognized as an internal or external command,
operable program or batch file.
you was unexpected at this time. 
```

有什么方法可以抑制 Ant 的所有输出，或者至少让 Capistrano 不要将我的构建脚本的任何输出传递到命令行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T00:00:09.063

[我在SuperUser](https://superuser.com/questions/134214/dev-null-for-windows)和[StackOverflow](https://stackoverflow.com/questions/4507312/how-to-redirect-stderr-to-null-in-cmd-exe)上都找到了答案。

```
set :build_script, "ant compress -q > NUL" 
```

# javascript - JQuery脚本不能工作两次

> ID：12127208
> 
> 赞同：1
> 
> 时间：2012-08-26T02:34:57.703
> 
> 标签：javascript, jquery, html, numbers

我正在尝试在网站页面中创建测验。目的是每次您按下一步时，页面内都会打开一个新问题。但是，第二次调用脚本不起作用。

为此，我首先创建了一个名为“下一步”的链接。

```
<a href="addquiz.html" name="next" id="1">Next</a> 
```

这需要一个从 addquiz.html 打开 q1 的脚本

```
<script>
$("#1").click(function() {
$("#load").load("addquiz.html" + ' #q1');
event.preventDefault();
});
</script> 
```

在这个脚本中有一个提交按钮，它调用函数 goupone，它将链接的 id 增加 1（例如，从 1 到 2）

```
<div id="q1">
<h3>5 + 19 = ?</h3>
    <input type="text" width="6" name="" id="question-1-answers" value="" />
    <input type="submit" value="Check" onClick="goupone();" />
</div>

<script>
function goupone(){
var v=document.links[9].id;
vi=parseInt(v);
vi=vi+1;
document.links[9].id=vi;
}
</script> 
```

但是，当我再次单击下一步按钮时，什么也没有发生。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T02:38:31.967

由于您将`id`from更改`1`为，因此在单击锚点时将**不再触发**`2`初始单击处理程序。另一种方法是将事件处理程序绑定到其属性为：`$("#1").click()`**`a``name``next`**

 **```
<script>
$('a[name="next"]').click(function() {
  $("#load").load("addquiz.html" + ' #q1');
  event.preventDefault();
});
</script> 
```

或者创建一个类，例如`next`，将其添加到`a`，并将其用作选择器：

```
<a href="addquiz.html" name="next" id="1" class="next">Next</a>

<script>
$('a.next').click(function() {
  $("#load").load("addquiz.html" + ' #q1');
  event.preventDefault();
});
</script> 
```

但是，我会重构您的整个代码以简单地使用以下代码：

```
<a href="addquiz.html" name="next" id="nextAnchor" data-next-id="1">Next</a>

<script>
$("#nextAnchor").on('click', function() {
  $("#load").load("addquiz.html#q" + $(this).data("next-id"));
  event.preventDefault();
});
</script>

function goupone() {
  var $next = $("#nextAnchor");
  var currentId = parseInt($next.data("next-id"));
  var nextId = currentId + 1;
  $next.data("next-id", nextId);
} 
```

这是一个有效的**[演示](http://jsfiddle.net/pxkSh/)**。**

# php - PHP - 如果语句在 foreach 循环中无法正常工作

> ID：12127209
> 
> 赞同：1
> 
> 时间：2012-08-26T02:34:58.350
> 
> 标签：php, mysql, if-statement, foreach

嗨，我这里有这段代码：

```
public function length($args) {
    if (isset($this->length)) {
        foreach ($this->length as $k => $v) {
            if (strlen($args[$k])>=$v[0] && strlen($args[$k])<$v[1]) {
                return true;
            } else {
                array_push($this->form_errors, $v[2]);
                return false;
            }
        }
    } else { 
        return true;
    }
} 
```

我不确定为什么，但它没有按预期工作。foreach 循环仅循环通过 $args[$k] 之一，即使其中有 2 个。有人知道发生了什么吗？我正在匆忙写这个问题，所以如果我需要解释其他任何内容，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T02:39:24.930

`return`子句两边的两条语句在`if()`循环的第一次迭代时终止函数。strlen 的东西要么是真的，你返回真，要么它们是假的，你返回假。无论如何，循环结束。

如果您只是想跳到下一次迭代，`continue`请改用它，这将允许 foreach 继续进行。

# shell - KornShell (ksh) 脚本命令中的转义字符、文字引号和变量

> ID：12127211
> 
> 赞同：1
> 
> 时间：2012-08-26T02:35:09.873
> 
> 标签：shell, unix, scripting, ksh

全新的 KornShell (ksh)。我有一个绝对痛苦且希望很简单的问题。

我需要使用包含单引号和变量的字符串参数运行脚本。在 shell 中，它看起来像这样：

```
run_script -x '*082512*' 
```

这很好用。

但是，一旦我尝试在带有日期变量的脚本中运行它，我就无法生成那些单引号。我已经毫无问题地制作了“今天的日期”变量：

```
today=$(date "+%m%d%y") 
```

但是当我尝试运行脚本时会出现问题。我已经尝试了引号中引号的所有可能组合以及转义单引号等，但无济于事。

任何有关此问题的见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T15:00:33.907

在这里评论，因为格式更好。

你试过了吗

```
today=$(date "+%m%d%y")
run_script -x '*'"$today"'*' 
```

正如 Glenn Jackman 指出的那样，quote 仅在您输入命令的第一级 shell 调用中“看到”。

如果上述方法对您没有帮助，请考虑编辑您的问题以显示准确的用例、准确的错误消息或其他非预期行为。

祝你好运。

# java - 从数据库中填充 JTable

> ID：12127212
> 
> 赞同：0
> 
> 时间：2012-08-26T02:35:17.893
> 
> 标签：java, sql, database, jtable, type-2-dimension

我编写了这个简单的代码来填充`jTable1`，但它只填充`jTable1`了数据库中的最后一行。

```
String SQL = "select * from usernames";
ResultSet rs = stmt.executeQuery(SQL);
String[] columnNames = {"Full Name", "Email"}; 
String n = "",e = "";
while(rs.next()) { 
    n = rs.getString("Full_Name");
    e = rs.getString("Email");
    Object[][]data = {{n,e}}; 
    jTable1 = new JTable(data, columnNames);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T19:07:32.043

我通过这段代码解决了它

```
String n = "",e = "";      

DefaultTableModel model;
model = new DefaultTableModel(); 
jTable1 = new  JTable(model);

model.addColumn("Full Name");
model.addColumn("Email");

while(rs.next())  
{
    n = rs.getString("Full_Name");    
    e= rs.getString("Email");   
    model.addRow(new Object[]{n,e});
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T06:33:08.987

是的，它将始终是最后一行，因为在 while 循环中，您正在创建一个新的 JTable，而不是在现有的 JTable 中追加一行。所以这样做，

```
// Code
DefaultTableModel model = (DefaultTableModel) jTable1.getModel();
while(rs.next())
{ 
    n = rs.getString("Full_Name");
    e= rs.getString("Email");
    //Object[][]data={{n,e}};
    // This will add row from the DB as the last row in the JTable. 
    model.insertRow(jtable1.getRowCount(), new Object[] {n, e});
} 
```

# ruby-on-rails - Gmaps.map.replaceMarkers 的问题：Gmaps.map 未定义

> ID：12127217
> 
> 赞同：0
> 
> 时间：2012-08-26T02:37:24.477
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gmaps4rails

我正在尝试根据用户搜索表单动态更改 Gmaps4Rails 中的标记。我正在使用下面的代码。

我遇到的问题是 $('#locations_search').submit 中对 Gmaps.map.replaceMarkers 的调用给出了错误：Gmaps.map 未定义。

我使用 javascript 调试器进行了检查，确实，一旦我进入提交函数（我在那里有一个断点）， Gmaps.map 是未定义的。当 Gmaps.map.callback 的第一行中的断点停止时，对象 Gmaps.map 被定义。

可能我错过了一些东西。这里似乎是一些变量范围问题？

```
Gmaps.map.callback = function() {

  var firstMarker = Gmaps.map.markers[0];
  var map         = Gmaps.map.map;
  firstMarker.infowindow.open(map, firstMarker.serviceObject);

  $('#locations_search').submit(function () {
    var url = '/locations.json/?' + $(this).serialize();
    $.getJSON(url, function(data){
                Gmaps.map.replaceMarkers(data);
            });
    $.get(this.action, $(this).serialize(), null, 'script');
    return false;
  });
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:10:25.580

这只是脚本顺序的问题。

`Gmaps.map`当您调用其中一个`gmaps`或`gmaps4rails`助手时，会在您的视图中创建。

解决方案：

*   在调用 gem 的助手**后**添加脚本

*   将您的 js 代码包装在`<% content_for :scripts do %> code <% end %>`

* * *

在你看来：

```
<%= gmaps(...) %>
<% content_for :scripts do %>
<script type="text/javascript"> 
  Gmaps.map.callback = function() { ... }
</script>
<% end %> 
```

* * *

```
Gmaps.map.callback = function() {

  var namespace   = Gmaps.map;
  var firstMarker = namespace.markers[0];
  var map         = namespace.map;
  firstMarker.infowindow.open(map, firstMarker.serviceObject);

  $('#locations_search').submit(function () {
    var url = '/locations.json/?' + $(this).serialize();
    $.getJSON(url, function(data){
            namespace.replaceMarkers(data);
        });
    $.get(this.action, $(this).serialize(), null, 'script');
    return false;
  });
} 
```

# ruby - 为什么 /\b[^\b]*\b/.match(" hello world ") 不匹配 "hello"

> ID：12127225
> 
> 赞同：1
> 
> 时间：2012-08-26T02:39:14.927
> 
> 标签：ruby, regex

我正在学习 Ruby 1.9.3 中的正则表达式。

你能告诉我为什么吗

```
/\b[^\b]*\b/.match("    hello  world    ")  matched  => #<MatchData "hello  world"> 
```

不`[^\b]`工作？应该不会跨越一个字吧？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T02:41:54.673

你想要的是`/\b\w*\b/`（`\w`=字母数字字符）。`\b`不表示实际字符，而是向字符添加单词边界条件。

`[…]`表示一个字符集。由于`\b`是标志而不是字符，因此您不能将它们放入字符集中。

顺便说一句，要匹配单词，您实际上不需要任何`\b`s。一个简单的`/\w+/`就可以了。

有关[正确](http://www.regular-expressions.info/wordboundaries.html)使用`\b`.

# java - 在java中按mysql请求排序

> ID：12127229
> 
> 赞同：0
> 
> 时间：2012-08-26T02:39:33.400
> 
> 标签：java, mysql, jakarta-ee

请问这个查询有问题

`ResultSet rs = stmt.executeQuery("select * from user order by"+var);`

我可以得到 var 的 valor，但它不能被执行。var 变量我通过了

`<th><a href="ManageUser?action=order&var=nom">Nom</a></a> </th>`

在 DAO 我有。

```
public static ArrayList Order(String var) throws SQLException,ClassNotFoundException
     {
         ArrayList<User> list=new ArrayList<User>();
         Connection con = createDBConnection();
         Statement stmt = con.createStatement();
         ResultSet rs = stmt.executeQuery("select * from user order by nom");
         int i=0;
           while(rs.next())
            {
              User cb= new User();
              cb.setID(rs.getInt(1));
              cb.setNom(rs.getString(2));
              cb.setPrenom(rs.getString(3));
              cb.setEmail(rs.getString(4));
              cb.setStatut(rs.getString(5));
              cb.setPassword(rs.getString(6));
              cb.setDate(rs.getDate(7));
              list.add(cb);
              i++;
             }
          stmt.close();
          con.close();
          return list;
    } 
```

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T02:40:58.157

```
ResultSet rs = stmt.executeQuery("select * from user order by"+var);
                                                             ^---missing space 
```

没有那个空间，你会得到

```
... order bysomefield
           ^--- 
```

这是一个语法错误。

# android - 如何使用 ViewPager 切换到其他布局？

> ID：12127231
> 
> 赞同：0
> 
> 时间：2012-08-26T02:39:51.403
> 
> 标签：android, android-layout, android-fragments, android-viewpager, fragmentpageradapter

```
 public class SectionsPagerAdapter extends FragmentPagerAdapter {

    public SectionsPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int i) {
        Fragment fragment = new DummySectionFragment();
        Bundle args = new Bundle();
        args.putInt(DummySectionFragment.ARG_SECTION_NUMBER, i + 1);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public int getCount() {
        return 3;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        switch (position) {
            case 0: return getString(R.string.title_section1).toUpperCase();
            case 1: return getString(R.string.title_section2).toUpperCase();
            case 2: return getString(R.string.title_section3).toUpperCase();
        }
        return null;
    }
}

/**
 * A dummy fragment representing a section of the app, but that simply displays dummy text.
 */
public static class DummySectionFragment extends Fragment {
    public DummySectionFragment() {
    }

    public static final String ARG_SECTION_NUMBER = "section_number";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        TextView textView = new TextView(getActivity());
        textView.setGravity(Gravity.CENTER);
        Bundle args = getArguments();
        textView.setText(Integer.toString(args.getInt(ARG_SECTION_NUMBER)));
        return inflater.inflate(R.layout.fragment_content1, container, false);
    }
}
} 
```

上面的代码是 ViewPager SDK 中的模板，当我从一页滑动到一页时，它只放置文本 1 到 3。问题是当我滑动它时如何替换该文本并放置我自己的布局 xml，并且是否可以使用具有此功能的 WebView。例如：当活动加载时，它会转到 google.com，然后当我滑动到其他页面时，每次滑动时它都会更改 WebView 的 url？希望可以有人帮帮我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T21:18:11.927

您必须创建从 android.support.v4.app.Fragment 扩展的类，就像类 DummySectionFragment 一样。然后，在 getItem(int i) 方法中，您应该为每个索引实例化您想要的每个类，并且 getCount() 方法必须返回您正在实例化的 Fragment 的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T06:34:30.817

`viewpager.setCurrentItem(index)`哪里`index`是所需的片段索引。

# ruby-on-rails - omn iauth - 有什么理由我应该将 OAuth2 令牌存储在数据库中？

> ID：12127239
> 
> 赞同：2
> 
> 时间：2012-08-26T02:41:13.600
> 
> 标签：ruby-on-rails, facebook, ruby-on-rails-3, oauth-2.0, omniauth

所以，我刚刚开始使用omniauth，并让它与facebook一起工作。我已经对其进行了设置，以便在当前令牌过期时自动重定向回 facebook 以获取新令牌。基于此，我有什么理由应该将令牌存储到数据库中？我目前记录用户访问，但在记录令牌时并没有真正看到任何价值。希望有任何关于我为什么应该这样做的想法。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T03:53:11.280

取决于你的业务逻辑。例如，您是否需要稍后访问用户的 Facebook 详细信息，即使他已注销？或者，如果您正在排队任务（即在后台运行），您是否需要在几个小时后发布到他的墙上，而不是立即发布？

我能想到的另一个原因是。当用户需要通过您的应用与 Facebook 交互时，您是否要求您的应用始终通过 Facebook 获取新令牌？或者您想将这些令牌存储在您的应用程序中，这样用户就不需要一遍又一遍地经历相同的过程？

这完全取决于您尝试提供的用户体验类型。

# php - 我如何编写这样的输入语句。购买日期：MM/DD/YYYY

> ID：12127245
> 
> 赞同：-4
> 
> 时间：2012-08-26T02:42:04.493
> 
> 标签：php, mysql

我将此功能用作日历下拉菜单。我不确定如何编写php`<inputtype ="text" ...`

这是生成下拉列表的 php 函数。我如何写`<inputtype="text"`声明？

抱歉，我是 PHP 新手，我不知道该怎么做？

```
<?PHP 

    FUNCTION DateSelector($inName, $useDate=0) 
    { 
        /* create array so we can name months */ 
        $monthName = ARRAY(1=> "January", "February", "March", 
            "April", "May", "June", "July", "August", 
            "September", "October", "November", "December"); 

        /* if date invalid or not supplied, use current time */ 
        IF($useDate == 0) 
        { 
            $useDate = TIME(); 
        } 

        /* make month selector */ 
        ECHO "<SELECT NAME=" . $inName . "Month>\n"; 
        FOR($currentMonth = 1; $currentMonth <= 12; $currentMonth++) 
        { 
            ECHO "<OPTION VALUE=\""; 
            ECHO INTVAL($currentMonth); 
            ECHO "\""; 
            IF(INTVAL(DATE( "m", $useDate))==$currentMonth) 
            { 
                ECHO " SELECTED"; 
            } 
            ECHO ">" . $monthName[$currentMonth] . "\n"; 
        } 
        ECHO "</SELECT>"; 

        /* make day selector */ 
        ECHO "<SELECT NAME=" . $inName . "Day>\n"; 
        FOR($currentDay=1; $currentDay <= 31; $currentDay++) 
        { 
            ECHO "<OPTION VALUE=\"$currentDay\""; 
            IF(INTVAL(DATE( "d", $useDate))==$currentDay) 
            { 
                ECHO " SELECTED"; 
            } 
            ECHO ">$currentDay\n"; 
        } 
        ECHO "</SELECT>"; 

        /* make year selector */ 
        ECHO "<SELECT NAME=" . $inName . "Year>\n"; 
        $startYear = DATE( "Y", $useDate); 
        FOR($currentYear = $startYear - 5; $currentYear <= $startYear+5;$currentYear++) 
        { 
            ECHO "<OPTION VALUE=\"$currentYear\""; 
            IF(DATE( "Y", $useDate)==$currentYear) 
            { 
                ECHO " SELECTED"; 
            } 
            ECHO ">$currentYear\n"; 
        } 
        ECHO "</SELECT>"; 

    } 
?> 

<HTML> 
<BODY> 
<FORM> 
Choose a Date: <?PHP DateSelector( "Sample"); ?> 
</FORM> 
</BODY> 
</HTML> 
```

我的代码结束。

先感谢您 。对不起，我是 PHP 新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:28:49.533

假设发布所选日期（以 mysql 格式）将是：

```
$mysql_date=$_POST['SampleYear'].'-'.$_POST['SampleMonth'].'-'.$_POST['SampleDay']; 
```

'Sample' 是示例中 $inName 的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:29:22.580

无需为日期添加文本框。您可以通过连接发布的值来设置它们

```
$selected_date = $_POST['SampleYear'] . $_POST['SampleMonth'] . $_POST['SampleDay']; 
```

--

如果你觉得有必要`<input type="text" />`加上日期，你可以使用 jQuery

```
// in the head of your document
  //this checks for when elements of date are changed
$(function() {
$('#SampleMonth').change(function(){ setSelectedDate();});
$('#SampleDay').change(function(){ setSelectedDate();});
$('#SampleYear').change(function(){ setSelectedDate();});
}
  // this changes the text box to the values of the selects
Function setSelectedDate(){
var sel_month = $('#SampleMonth').val();
var sel_day = $('#SampleDay').val();
var sel_year = $('#SampleYear').val();
var new_sel_date = sel_year + "-" + sel_month + "-" + sel_day;
  // note that this puts the date as YYYY-MM-DD, which is the proper way to insert into mysql. It can be set as MM/DD/YYYY, but then you would have to change it again after posting.
$('#purchasedate').val(new_sel_date);
}

// inside the form tags
<input type="text" id="purchasedate" name="invoice_date" value="" readonly="true" /> 
```

然后您可以通过发布的值输入它

```
$selected_date = $_POST['purchasedate']; 
```

# ruby-on-rails - 无需指定文件输入即可保存多个回形针附件

> ID：12127247
> 
> 赞同：0
> 
> 时间：2012-08-26T02:42:36.737
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, paperclip, fields-for

我有一个用户模型，它具有资产模型的 has_many 关联（标准回形针设置）。在视图中，我使用 fields_for 助手为资产设置了许多文件字段。当最终用户未指定文件时，将不会保存资产记录。这就是我想要的。到现在为止还挺好。

然后我在 Asset 模型中添加了一个标题属性。我还在每个相应的文件字段中放置了一个文本字段。问题来了。当最终用户未指定文件或标题时，将保存资产记录。保存的记录有一个空字符串的标题，所有其他回形针属性为零。

问题是当没有文件分配给回形针属性时，如何防止保存资产记录？而且由于资产是可选的，我不希望生成任何错误反馈。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T20:08:07.573

你可以`validates_presence_of :caption`在你的资产模型中做一个，但这也需要字幕。如何检查链接到用户的所有资产上是否存在文件`before_validation`？可能是这样的？（可能需要一些调整）

```
class User < AR::Base
  has_many :assets, :dependent => :destroy

  before_validation :check_assets

  def check_assets
    self.assets.each do |asset|
      unless asset.attachment.file?
        if asset.new_record?
          self.assets.delete(asset)
        else
          asset.destroy
        end
      end
    end
  end
end 
```

# java - 涉及 Swing 的 EDT 的线程错误

> ID：12127248
> 
> 赞同：0
> 
> 时间：2012-08-26T02:42:51.400
> 
> 标签：java, multithreading, swing, error-handling, jbutton

正如您从我的代码中看到的那样，我在这里完全错过了一个完整的概念。我的目标是让用户输入：

Jbutton 文本字段：文本方向和助记符

我将该信息传递给我的 Button 类，该类检查错误并返回一个已定义的按钮。

然后根据用户规范使用所述按钮填充 JFrame。

BASIC，显然是一个课程问题，但我在这里无能为力。这是我第一次寻求帮助，所以请放轻松。

```
import javax.swing.JPanel;
import javax.swing.JFrame;
import javax.swing.JButton;

/**
 * This class will create a button using the Button class and with user input to define the instance
 * of the Button Class.
 * 
 */
public class CreateButton extends JPanel
{
    // instance variables 
    private static String userIn; // user input
    private static Button userButton; // button to be manipulated
    public static JButton createdButton; // finished button

    /**
     * Contructor for the CreateButton class.
     */
    public static void main (String [] args)
    {

            System.out.println("\nThis program will create a button with some input for you.");
            System.out.println("What would you like to call this button?");

            userIn = StringIn.get();

            userButton = new Button();
            userButton.buttonText(userIn);

            System.out.println("\nYou can orient your text on the button in the vertical and");
            System.out.println("horizontal axis. We will start with the vertical. Where would you like");
            System.out.println("the text, on the top, center, or bottom?");

            userIn = StringIn.get();

            String vertical = userIn;

            System.out.println("\nNext let's select the horizontal alignment. Would you like the text");
            System.out.println("aligned to the left, center, or right?");

            userIn = StringIn.get();

            String horizontal = userIn;

            userButton.textPosition(vertical,horizontal);

            System.out.println("\nFinally let's add a mnemonic or hotkey to the button. Pick a letter");
            System.out.println("from a-z on the keyboard and you can activate the button by pushing");
            System.out.println("ALT + your letter of choice. Please enter your letter:");

            userIn = StringIn.get();

            userButton.buttonMnemomic(userIn);

            System.out.println("\nGreat let's create and see this button.");

            javax.swing.SwingUtilities.invokeLater(new Runnable() 
            {
                public void run() 
                {
                   createAndShowGUI();
                }
            }); 

    }

     private static void createAndShowGUI() 
    {

        //Create and set up the window.
        JFrame frame = new JFrame("Create a Button");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //Create and set up the content pane.
        CreateButton newContentPane =  new CreateButton();
        newContentPane.setOpaque(true); //content panes must be opaque
        frame.setContentPane(newContentPane);

        //Display the window.
        frame.pack();
        frame.setVisible(true);

    }
} 
```

我的按钮错误检查器代码如下：

```
import javax.swing.AbstractButton;
import javax.swing.JButton;

/**
 * This class will demonstrate the use of a button.
 * 
 */
public class Button                        
{
    // instance variables 
    protected JButton myButton; // button to be created and manipulated
    private String myButtonText; // text on the button
    private String myButtonVerticalTextPosition; 
    private String myButtonHorizontalTextPosition;
    private String myButtonMnemonic; // hotkey for the button

    /**
     * Constructor for objects of class Button
     */
    public Button()
    {

    }

    /**
     *Set button text. String input.
     */
    public void buttonText(String textIn)
    {
        myButtonText = textIn;
    }

    /**
     *Set button text position. String input for vertical (top, center, bottom) and horizontal
     *(left, center, right).
     */
    public void textPosition(String verticalIn, String horizontalIn)
    {
        myButtonVerticalTextPosition = verticalIn;

        boolean validInput = false;

        do
        {
            if  ((myButtonVerticalTextPosition.compareToIgnoreCase("top") == 0)||  
                 (myButtonVerticalTextPosition.compareToIgnoreCase("centre") == 0) ||
                 (myButtonVerticalTextPosition.compareToIgnoreCase("center") == 0) ||
                 (myButtonVerticalTextPosition.compareToIgnoreCase("bottom") == 0))
            {

                validInput = true;
            } else
            {

               System.out.println("\nPlease enter top, center, or bottom for vertical position:");
               myButtonVerticalTextPosition = StringIn.get();
            } 
        } while (validInput == false);

        myButtonHorizontalTextPosition = horizontalIn;

        validInput = false;

        do
        {
            if  ((myButtonHorizontalTextPosition.compareToIgnoreCase("left") == 0) ||  
                 (myButtonHorizontalTextPosition.compareToIgnoreCase("centre") == 0) ||
                 (myButtonHorizontalTextPosition.compareToIgnoreCase("center") == 0) ||
                 (myButtonHorizontalTextPosition.compareToIgnoreCase("right") == 0))
            {

                validInput = true;
            } else 
            {

                System.out.println("\nPlease enter left, center, or right for horizontal position:");
                myButtonHorizontalTextPosition = StringIn.get();
            } 
        } while (validInput == false);
    }

    /**
     *Set button mnemomic. String input for mnemomic [a-z].
     */
    public void buttonMnemomic(String mnemomicIn)
    {
        myButtonMnemonic = mnemomicIn;
        boolean validInput = false;

        do
        {
            if  (myButtonMnemonic.length() > 1)
            {
                System.out.println("\nPlease enter a letter from a-z: ");
                myButtonMnemonic = StringIn.get();
            } else if (!myButtonMnemonic.matches("^[a-zA-Z]+$"))
            {
                System.out.println("\nPlease enter a letter from a-z: ");
                myButtonMnemonic = StringIn.get();
            } else if ((myButtonMnemonic.length() == 1) && 
                       (myButtonMnemonic.matches("^[a-zA-Z]+$")))
            {
                validInput = true;
            }
        } while (validInput == false);
    }

    /**
     *Create button. Void method to create the button to the variables provided.
     */
    public void createButton()
    {
        // create new button

        myButton = new JButton(myButtonText);

        // set text position

        switch (myButtonVerticalTextPosition)
        {
            case "top":
                myButton.setVerticalTextPosition(AbstractButton.TOP);
                break;
            case "centre":
                myButton.setVerticalTextPosition(AbstractButton.CENTER);
                break;
            case "center":
                myButton.setVerticalTextPosition(AbstractButton.CENTER);
                break;
            case "bottom":
                myButton.setVerticalTextPosition(AbstractButton.BOTTOM);
                break;
            default:
                System.err.format("%n%s is an invalid entry.", myButtonVerticalTextPosition);
                break;
        }

        switch (myButtonHorizontalTextPosition)
        {
            case "left":
                myButton.setHorizontalTextPosition(AbstractButton.LEADING);
                break;
            case "centre":
                myButton.setHorizontalTextPosition(AbstractButton.CENTER);
                break;
            case "center":
                myButton.setHorizontalTextPosition(AbstractButton.CENTER);
                break;
            case "right":
                myButton.setHorizontalTextPosition(AbstractButton.TRAILING);
                break;
            default:
                System.err.format("%n%s is an invalid entry.", myButtonVerticalTextPosition);
                break;
        }

        // set button mnemonic

        StringBuilder hotKey = new StringBuilder("KeyEvent.VK_");
        hotKey.append(myButtonMnemonic.toUpperCase());
        myButton.setMnemonic(hotKey.charAt(0));

        // set tool tip text

        myButton.setToolTipText("Push the button. You know you want to.");
    }

    /**
     *Returns a JButton for the button type.
     */
    public JButton returnButton()
    {
        return myButton;
    }
} 
```

这一切都适用于您添加“createdButton”的部分。如果我将其设为默认按钮，它会通过动作并放置默认按钮。

仅供参考，这是我的 StringIn 代码：

```
import java.util.Scanner;
import java.io.IOException;

/**
 * This class will allow the user to type in string from the console.
 * 
 */

public class StringIn 
{
    // instance variables 
    private static String userIn;

    public static String get() 
    {

        try (Scanner in = new Scanner(System.in))
        {
            userIn = new String(in.nextLine()); // Read the string from console.
        }
        return userIn;

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T08:16:31.123

对于 StringIn 类，只需执行以下操作：

```
 import java.util.Scanner;

    public class StringIn 
    {
        // instance variables 
        private static Scanner scanner = new Scanner(System.in);

        public static String get(){
            return scanner.nextLine();
        }
    } 
```

编辑2：

好的，所以我将您的代码复制到我的 IDE 中，我得到的错误是源自您的 StringIn 类的错误。（我实际上不记得了，但这并不重要。）

您的 StringIn 类应该类似于上面的示例。

对于您的 createAndShowGUI() 函数：

```
 private static void createAndShowGUI() 
    {

        //Create and set up the window.
        JFrame frame = new JFrame("Create a Button");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //Create and set up the content pane. ( Why were you even doing this? )

        frame.add(createdButton); //( To display the actual button you need to
        //add it to the frame)

        //Display the window.
        frame.pack();
        frame.setVisible(true);

    } 
```

就这样吧^

我无法让助记词相关的东西正常工作，我不想花太多时间在上面，所以我把它们删除了。方向的东西也不起作用。

把它放在 main(String args[]) 的底部

```
 createdButton = userButton.createButton(); // Make createButton() return Button; 
```

除了这部分之外，您的代码中的任何地方都不需要 JButton：

```
 public class Button extends JButton
    // And of course the import statement... 
```

您可以使用`Button.TOP`代替`AbstractButton.TOP`which 将为您摆脱导入语句。

# ruby-on-rails - 为什么带有绝对 url 的 link_to 在技术上被认为优于定位控制器操作？

> ID：12127252
> 
> 赞同：1
> 
> 时间：2012-08-26T02:44:10.510
> 
> 标签：ruby-on-rails

Rails 的新手，所以如果在某个地方讨论过这个问题，请把我联系起来：我进行了很好的搜索，但我能找到的只是人们试图弄清楚如何使用 link_to，而不是对此评论的任何讨论：

```
link_to "Profile", profile_path(@profile)
# => <a href="/profiles/1">Profile</a>

in place of the older more verbose, non-resource-oriented

link_to "Profile", :controller => "profiles", :action => "show", :id => @profile
# => <a href="/profiles/show/1">Profile</a> 
```

[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to)

我知道后者更冗长，因此不受欢迎，但推荐前者*似乎*是一件奇怪的事情。

如果我有一个动作说：/blah/add，我使用以下链接链接到它：

```
link_to "Link", link_add_path 
```

然后我链接到 mysite.com/link/add。这是一个**硬编码的 url**。

如果我更改此映射到的路由，我必须更改我的代码库中的每个 link_to 实例以指向新的绝对 url。这似乎很疯狂。

但是，如果我使用以下方法链接到它：

```
link_to "Link", :controller => "thing", :action => "add" 
```

然后动态确定url。如果我必须更改路径，我所做的就是编辑 config/routes.rb 并且不触及我的任何代码。这似乎是低得多的维护。

我很欣赏它比这稍微复杂一些，blah_path 变量实际上不是静态路由，实际上包含一些智能，例如应用程序基本 url，并阻止您链接到不存在的 url，但这似乎是倒退一步促进稍微不那么冗长的语法。

那么，这是怎么回事？

**您会出于什么技术原因选择前者而不是后者的 link_to 语法？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T03:22:30.670

“你做错了”：P

不过说真的：使用命名资源，这就是为什么这很酷：

示例：您的路线文件中有此内容：

```
 resources :user_orders 
```

而且您到处都在使用“user_orders_path”。然后您进行重构并决定（因为订单现在是通用的）您希望控制器被称为“订单”，但您不想破坏所有旧代码。你可以这样做：

```
 resources :user_orders, controller: "orders" 
```

您现有的链接将继续有效！（另外，您可以添加“订单”资源以将内容转移到新方案中）

还有一些简洁的东西，比如命名链接：

```
 match 'exit' => 'sessions#destroy', :as => :logout 
```

我还想补充一点，如果您需要使用旧的链接语法重构控制器 - 您仍然需要更改一堆控制器链接！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T03:16:28.457

> 然后我链接到 mysite.com/link/add。这是一个硬编码的网址。

**不，这不对。** `link_add_path`是 Rails 生成的一个**方法**，它指向你的`config/routes.rb`. 您可以通过运行看到这一点

```
rake routes | grep link_add 
```

> 如果我更改此映射到的路由，我必须更改我的代码库中的每个 link_to 实例以指向新的绝对 url。这似乎很疯狂。

**不，你没有。**举个例子

```
get "link/add", as: :link_add, controller: :links, action: :add 
```

如果我运行上述

```
rake routes | grep link_add 
```

我明白了

```
link_add GET    /link/add(.:format)    links#add 
```

但是，如果我将控制器的名称更改为`UrisController`怎么办？只需更改路线`config/routes.rb`

```
get "link/add", as: :link_add, controller: :uris, action: :add 
```

现在你有了

```
link_add GET    /link/add(.:format)    uris#add 
```

`link_to`' 不必更改，因为该方法`link_add_path` *仍然*映射到 my 中新修改的行，`config/routes.rb`因为路由名称相同。使用更明确的方式为 each 指定控制器/操作`link_to`，您必须遍历每个链接并手动更新它以反映新`controller: :uris`控制器。

**在 rails 指南中阅读有关[命名路线的信息。](http://guides.rubyonrails.org/routing.html#naming-routes)**

# asp.net-mvc - MVC 应用程序中的后退按钮功能

> ID：12127255
> 
> 赞同：2
> 
> 时间：2012-08-26T02:45:13.440
> 
> 标签：asp.net-mvc

我需要在 MY MVC2 应用程序中实现后退按钮功能（在应用程序中使用显式后退按钮，而不是通过浏览器后退按钮）。

我已经使用了建议使用 Request.UrlReferrer 的[ASP.net MVC 浏览了此处的“后退按钮功能”链接。](https://stackoverflow.com/questions/1325133/back-button-functionality-using-asp-net-mvc)并且只要我有 HTTP Get（因为它带有查询字符串），它就可以很好地工作。但是当上一页是没有查询字符串的 HTTP POST 时，我会遇到问题。

有没有人研究过这样的解决方案？

我们最初的想法是生成和存储像 Stack 这样的链接，并在用户单击“返回”按钮时一一弹出 url。但是，如果有更好的解决方案\设计模式可以帮助我实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T08:00:01.080

您可以将 returnurl 存储到 actionresult 路由值，并有一个用于反向链接的 html 助手。

帮手：

```
public static class HtmlHelpersExtensions
{
    public static MvcHtmlString BackLink(this HtmlHelper helper,string defaultAction)
    {
        string returnUrl = HttpContext.Current.Request["returnUrl"];
        // If there's return url param redirect to there
        if (!String.IsNullOrEmpty(returnUrl))
        {
            return new MvcHtmlString("<a href=" + returnUrl + " >Back</a>");
        }
        // if user just posted and there's no returnurl, redirect us to default
        else if (HttpContext.Current.Request.HttpMethod == "POST")
        {
            return helper.ActionLink("Back", defaultAction);
        }
        // we didn't post anything so we can safely go back to previous url
        return new MvcHtmlString("<a href=" + HttpContext.Current.Request.UrlReferrer.ToString() + " >Back</a>");
    }
} 
```

控制器：

```
 public ActionResult MyAction(string returnUrl)
    {
        return View(new MyModel());
    }
    [HttpPost]
    public ActionResult MyAction(MyModel mm, string returnUrl)
    {
        if (ModelState.IsValid)
        {
            // No returnurl, redirect us to somewhere
            if (string.IsNullOrEmpty(returnUrl))
                return RedirectToAction("Index");

            // redirect back
            return Redirect(returnUrl);
        }

        return View(mm);
    } 
```

用法：

```
@Html.ActionLink("MyAction", "MyAction", new { returnUrl = Request.RawUrl.ToString() }) 
```

MyAction.cshtml 中的反向链接

```
@Html.BackLink("Index") 
```

现在，帮助程序决定是使用 returnUrl 参数、默认操作还是通过 urlreferrer 带您返回。

# php - 有什么办法可以解决“死亡解析错误”吗？

> ID：12127257
> 
> 赞同：0
> 
> 时间：2012-08-26T02:46:19.663
> 
> 标签：php, exception-handling, error-handling, xdebug, parse-error

我很确定我不仅仅是一个注意到 PHP 上的简单解析错误的人，如果存在于非常嵌套的场景中（例如，一个引用另一个对象实例的对象实例，该对象实例引用另一个具有非常小的解析错误的对象实例，所有这些都是自动加载的）可以使 PHP 永远挂起，而不是像通常那样报告解析错误并停止执行——我已经看到很多次了，而且在非常不同的代码库中，总是使用正确的 error_reporting 设置集.

有什么办法吗？即，是否可以强制以某种方式显示解析错误报告？

作为记录，我 100% 确定这些挂起是由于 PHP 没有正确处理解析错误造成的，因为我已经多次调试过这种行为；我问的原因是因为当这些挂起发生时，基本上是一无所知，甚至无法判断 PHP 是否表现得好笑，或者代码中的某个地方确实存在故障循环——这需要时间来调试，时间可能如果您知道，PHP 报告了应有的解析错误，则可以保存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:00:38.847

正如评论中部分提到的，`error_reporting(E_ALL)`可以帮助显示所有错误。您可能还必须使用`ini_set`并使其`display_errors`具有`on`.

就个人而言，我认为您的问题不是很清楚，您应该改进格式并使其更易于理解。

**更新：**您运行代码的服务器/计算机似乎很慢。不应该真正发生“闲逛”。或者你能更详细地描述它吗？

此外，您可能会陷入无限或接近无限的循环。仔细检查您的代码，因为除非您发布所有代码，否则这是我们可以帮助您的限制。

**更新 2：**似乎您在尝试调用对象时可能输入了错误的对象名称。否则，可能是您没有正确声明您的对象。

很可能是其中之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:29:12.107

原来罪魁祸首是[xdebug.collect_params](http://xdebug.org/docs/stack_trace#collect_params)，文档非常正确地建议保持禁用状态。某些错误只是在调用堆栈跟踪的参数中生成大量数据，这些数据耗尽了 xdebug 并将 collect_params 设置为 4 并使 xdebug 和扩展 PHP 挂起，即使我有一个自定义异常处理程序，但实际上从未从 xdebug 检索堆栈跟踪，但显然 xdebug 无论如何都会收集这些数据。

这很难调试，因为：a) 复制并不简单 b) 使用 xdebug 进行分析没有帮助 c) 使用 xdebug + dbgp 单步执行代码也无济于事 d) 几乎没有留下任何痕迹（没有双关语）除了*偶尔*将错误记录到 php error_log 文件和 e) 使用自定义异常处理程序之外，怀疑 xdebug 并不明显，因为我没有在处理异常的过程中涉及它，或者我认为。

所以没有死亡的解析错误这样的事情，我学会了永远不要认为这不是我的错 :) 希望这个答案至少能在未来帮助其他人。

# css - 为什么只有某些 div 相互重叠？

> ID：12127258
> 
> 赞同：0
> 
> 时间：2012-08-26T02:46:56.250
> 
> 标签：css, xhtml

我遇到了一个问题，即只有某些部门在垂直方向上相互重叠。我的第二个灰色“pageBreak”安装在我的“subHeader”之上，而不管填充修复并试图保持在清除浮动的顶部。

我已经尝试过溢出、clearfix、老式的“clear: both;”，但我仍然遇到同样的问题。（我认为这是一个与浮点相关的问题。）我什至尝试（如您在代码中看到的）使用相对和绝对定位来让我的第二个“pageBreak”低于我的“subHeader”，因为它应该是，但没有定位值甚至移动第二个“pageBreak”。在这些引用的下方，我还有其他 div 潜入我的“subHeader”顶部。我宁愿不使用这些修复，因为出于显而易见的原因，我希望 CSS 尽可能动态。

我觉得代码很简洁，但我显然遗漏了一些相当明显的东西。任何帮助将不胜感激！

我已包含页面的 HTML 和 CSS 供您查看。

HTML：

```
<div class="container">
<div class="header">
    <div style="float:left">
        <img src="images/Logo.gif" alt="Company Logo" width="345px" height="117px">
    </div>
    <div style="float: right;">
        <h2>Company slogan.&#0153;</h2>
    </div>
    <div style="clear: both;"></div>
</div>

<div class="pageBreak">
</div>

<div class="subHeader">
    <div style="float: left; width: 400px; text-align: left;">
    </div>
    <div class="form" style="float: right; width: 300px;">
        <form id='login' action='login.php' method='post' accept-charset='UTF-8'>
            <input type='hidden' name='submitted' id='submitted' value='1'/>
            <div>
                <label style="float: left;" for='username' >School Email</label>
                <input style="float: right;" type='text' name='username' id='username'  maxlength="50" /></br></br>
            </div>
                <div style="clear: both;">
            <div>
                <label style="float: left;" for='password' >Password</label>
                <input style="float: right;" type='password' name='password' id='password' maxlength="50" />
            </div>
                <div style="clear: both;"></div>
                    <p style="font-size: 70%; text-align: right; line-height: 8px;"><a href="app-test/forgot-password.php">Forgot your password?</a></p>
                    <p style="font-size: 70%; text-align: right; line-height: 8px;"><a href="register.php">Want to register?</a></p>
            <div>
                <input type='submit' name='Submit' value='Log In' style="float: right;"/>
            </div>
        </form>
    </div>
    <div style="clear: both;"></div>
</div>

<div class="pageBreak" style="top: 400px;">
</div> 
```

CSS：

```
.container {
width: 1000px;
margin-left: auto;
margin-right: auto;
border-radius: 15px;
background-color: white;
box-shadow: 10px 10px 40px #888;
}

.pageBreak {
margin-left: auto;
margin-right: auto;
width: 900px;
border-top: rgb(238,238,238) 3px solid; 
}

.header {
padding-top: 30px;
padding-bottom: 30px;
padding-left: 50px;
padding-right: 50px;
}

.subHeader {
padding-top: 30px;
padding-bottom: 30px;
padding-left: 50px;
padding-right: 50px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:21:16.590

不知道这是否能解决问题，但它太大而无法发表评论......

您的 HTML 格式不正确，您缺少一些结束标签。这可能是最后一个标签的复制错误，但第一个标签看起来是真的。

请参阅下面的代码（我已经评论了需要更正的地方）：

```
<div class="container">
    <div class="header">
        <div style="float:left">
            <img src="images/Logo.gif" alt="Company Logo" width="345px" height="117px">
        </div>
        <div style="float: right;">
            <h2>Company slogan.&#0153;</h2>
        </div>
        <div style="clear: both;">
        </div>
    </div>
    <div class="pageBreak">
    </div>
    <div class="subHeader">
        <div style="float: left; width: 400px; text-align: left;">
        </div>
        <div class="form" style="float: right; width: 300px;">
            <form id='login' action='login.php' method='post' accept-charset='UTF-8'>
                <input type='hidden' name='submitted' id='submitted' value='1'/>
                <div>
                    <label style="float: left;" for='username'>School Email</label>
                    <input style="float: right;" type='text' name='username' id='username' maxlength="50"/></br></br>
                </div>
                <div style="clear: both;">
                    <div>
                        <label style="float: left;" for='password'>Password</label>
                        <input style="float: right;" type='password' name='password' id='password' maxlength="50"/>
                    </div>
                    <div style="clear: both;">
                    </div>
                    <p style="font-size: 70%; text-align: right; line-height: 8px;">
                        <a href="app-test/forgot-password.php">Forgot your password?</a>
                    </p>
                    <p style="font-size: 70%; text-align: right; line-height: 8px;">
                        <a href="register.php">Want to register?</a>
                    </p>
                    <div>
                        <input type='submit' name='Submit' value='Log In' style="float: right;"/>
                    </div>
                </div> <!-- HERE -->
            </form>
        </div>
        <div style="clear: both;">
        </div>
    </div>
    <div class="pageBreak" style="top: 400px;">
    </div>
</div> <!-- HERE --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:02:49.607

你有`line-height: 8px`你的代码。增加段落的行高并减少您的分区宽度并省略一些`float`属性。
见[jsfiddle](http://jsfiddle.net/dariushvb2010/dcdBt/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T12:29:21.660

下面的标记将解决您布局中的问题。

```
<!-- CONTAINER -->
<div class="container">

<!-- HEADER -->    
<div class="header">
        <div style="float:left"><img src="images/Logo.gif" alt="Company Logo" width="345px" height="117px"></div>
        <div style="float: right;"><h2>Company slogan.&#0153;</h2></div>
        <div style="clear: both;">&nbsp;</div>
</div>
<!-- / HEADER -->

<!-- 1ST PAGE BREAK -->
<div class="pageBreak">&nbsp;</div>
<!-- / 1ST PAGE BREAK -->

<!-- SUBHEADER -->
<div class="subHeader">

            <div class="form" style="float: right; width: 300px;">

                <!-- FORM -->
                <form id='login' action='login.php' method='post' accept-charset='UTF-8'>

                    <input type='hidden' name='submitted' id='submitted' value='1'/>

                    <div>
                        <label style="float: left;" for='username' >School Email</label>
                        <input style="float: right;" type='text' name='username' id='username'  maxlength="50" /></br></br>
                    </div>

                    <div style="clear: both;">&nbsp;</div>

                    <div>
                        <label style="float: left;" for='password' >Password</label>
                        <input style="float: right;" type='password' name='password' id='password' maxlength="50" />
                    </div>

                    <div style="clear: both;">&nbsp;</div>

                    <p style="font-size: 70%; text-align: right; line-height: 8px;"><a href="app-test/forgot-password.php">Forgot your password?</a></p>

                    <p style="font-size: 70%; text-align: right; line-height: 8px;"><a href="register.php">Want to register?</a></p>

                    <div><input type='submit' name='Submit' value='Log In' style="float: right;"/></div>

                </form>
                <!-- /FORM -->

            </div>

            <div style="clear: both;">&nbsp;</div>
</div>
<!-- / SUBHEADER -->

<!-- 2ND PAGE BREAK -->
<div class="pageBreak">&nbsp;</div>
<!-- / 2ND PAGE BREAK -->

</div>
<!-- / CONTAINER --> 
```

# c++ - OpenFileDialog->ShowDialog() 时注入的 dll 无法冻结；

> ID：12127261
> 
> 赞同：0
> 
> 时间：2012-08-26T02:48:18.170
> 
> 标签：c++, visual-studio-2010

我创建了一个项目 dll，其中包含`form1`和`mainDll.cpp`，当我在目标进程中注入 Dll 时，一切正常，所有函数，并且在`form1`中调用`mainDLL.cpp`，然后`form1`在目标进程的同一内存空间中打开，但是今天我试图`OpenFileDialog`在这种形式的按钮中加入一个。

```
button Code
{
    OpenFileDialog1->ShowDialog();
} 
```

问题是当我单击按钮时，由 Dll 加载的表单冻结，而不是目标进程，只有我注入的进程`FORM1`；

# arrays - 如何在 Perl 中检查两个数组是否包含相同的元素？

> ID：12127262
> 
> 赞同：8
> 
> 时间：2012-08-26T02:48:36.360
> 
> 标签：arrays, perl

所以我只需要一种简单的方法来判断两个数组在 perl 中是否相同。顺序无关紧要，所以我正在寻找这样的东西：

`my @a = (1, 2, 3);`

`my @b = (2, 3, 1);`

`my @c = (1, 2, 4);`

`&identical(@a, @b)`返回 1

`&identical(@a, @c)`返回 0

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T03:35:29.250

您可以在哈希中计算元素的计数。有一个 (element => count) 散列，并且每次第一个数组具有该元素时计数增加，并且每次另一个数组具有它时降低计数（反之亦然）。如果两个数组具有相同的元素，则散列中的每个值都将为 0。

```
sub have_same_elements {
    my ($arr1, $arr2) = @_;
    my %counts = ();
    $counts{$_} += 1 foreach (@$arr1);
    $counts{$_} -= 1 foreach (@$arr2);
    return !(grep { $_ != 0 } values %counts);
}

$a_and_b_same = have_same_elements(\@a, \@b);  # will be true
$a_and_c_same = have_same_elements(\@a, \@c);  # will be false 
```

（注意，这可能适用于也可能不适用于进行自己的字符串化的对象。哈希键不能是引用，因此 Perl 在您使用它们时会将引用字符串化。它的默认字符串化符将引用转换为类似的东西`ARRAY(0x12345678)`，这使得引用不同，除非它们' re to the same thingie.但是如果一个对象进行了自己的字符串化并且不为不同的引用返回不同的字符串，这可能会中断。就像你知道的那样。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-26T03:05:29.593

如果您正在使用`Perl 5.10`或更高版本（如果不是，您真的应该升级），您可以使用[智能匹配运算符](http://perldoc.perl.org/perlop.html#Smartmatch-Operator)：

```
use strict;
use warnings;

my @a = (1, 2, 3);
my @b = (2, 3, 1);
my @c = (1, 2, 4);

#sort each of them (numerically)
@a = sort { $a <=> $b } @a;
@b = sort { $a <=> $b } @b;
@c = sort { $a <=> $b } @c;

if ( @a ~~ @b ) {

    print "\@a and \@b are the same! (after sorting)\n";
}
else {

    print "nope\n";
}

if ( @a ~~ @c ) {

    print "\@a and \@c are the same! (after sorting)\n";
}
else {

    print "nope\n";
} 
```

你也可以滚动你自己的函数：

```
use strict;
use warnings;

my @a = (1, 2, 3);
my @b = (2, 3, 1);
my @c = (1, 2, 4);

print same_elements(\@a, \@b) . "\n";
print same_elements(\@a, \@c) . "\n";

#arguments are two array references
sub same_elements {

    my $array_ref_1 = shift;
    my $array_ref_2 = shift;
    my @arr1 = @$array_ref_1;
    my @arr2 = @$array_ref_2;

    #If they are not the same length, we are done.
    if( scalar(@arr1) != scalar(@arr2) ) {

       return 0;
    }

    #sort them!
    @arr1 = sort { $a <=> $b } @arr1;
    @arr2 = sort { $a <=> $b } @arr2;

    foreach my $i( 0 .. $#arr1 ) {

        if ( $arr1[$i] != $arr2[$i] ) {
            return 0;
        }
    }
    return 1;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-26T04:06:16.967

首先，您将不得不重新考虑您的功能。

```
 identical(@a, @b); 
```

不将两个数组传递给函数，而是传递一个数组，其中包含两个数组中的所有元素。好像你说：

```
identical(1, 2, 3, 2, 3, 1); 
```

为了使您的函数正常工作，您必须将[引用](http://perldoc.perl.org/perlref.html)传递给您的数组：

```
identical(\@a, \@b); 
```

我会说为您的子程序制作[原型](http://perldoc.perl.org/perlsub.html#Prototypes)，但这可能会给您带来[更多](https://stackoverflow.com/a/297265/368630)它会解决的问题。

如果顺序不重要，请在比较数组之前对数组进行排序。你甚至可以作弊...

```
sub identical {
   my $array_ref_1 = shift;
   my $array_fef_2 = shift;

   use Digest::SHA qw(sha1_hex);

   if ( ref( $array_ref_1 ) ne "ARRAY") or ( ref( $array_ref_2 ) ne "ARRAY") {
      return;   #Error, need two array references
  }

  # Dereference Arrays
  my @array_1 = @{$array_ref_1};
  my @array_2 = @{$array_ref_2};

  # Setup Arrays to be one big scalar
  my $scalar_1 = join "\n", sort @array_1;
  my $scalar_2 = join "\n", sort @array_2;

  my $checksum_1 = sha1_hex $scalar_1;
  my $checksum_2 = sha1_hex $scalar_2;

  if ($checksum_1 eq $checksum_2) {
     return 1;
  }
  else {
     return 0_but_true; 
```

几点注意事项：

*   我可以取消引用、加入、生成校验和，并在单个语句中进行比较。我分别做了它们，以便更清楚地说明我在做什么。以编程方式，它可能没有任何区别。Perl 无论如何都会优化整个事情。我总是追求清晰。
*   `0_but_true`返回一个 0，但同时返回一个真值。这样，您可以执行类似`if ( identical( \@A, \@B ) ) {`的操作来确保该功能正常工作。然后，您可以测试零或一。
*   一定要测试你的参数。我使用[ref](http://perldoc.perl.org/functions/ref.html)函数来做到这一点。
*   我*作弊了*。我首先将两个排序数组转换为标量。然后，我使用 sha1 校验和来验证它们是否相同。使用[sha1](http://perldoc.perl.org/Digest/SHA.html)函数的校验和应该是相当不错的。失败的可能性很小。

真正的问题是如果你有这样的多行数组：

```
 @a = ("this", "that", "the\nother");
 @b = ("this", "that\nthe", "other"); 
```

使用`join`我所做的方式会导致结果标量相等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-07T14:09:44.590

我想你可以这样写，对你正在处理的输入类型做出最少的假设（只需传递适当的比较子）：

```
use List::Util;
sub identical {
  my @this = @{ +shift };
  my @that = @{ +shift };
  my $cmp = shift // sub { shift eq shift };
  return '' unless @this == @that;
  for my $idx (List::Util::shuffle keys @this) {
    return '' unless $cmp->($this[$idx], $that[$idx]);
  }
  return 1;
} 
```

其行为如下：

```
0> identical([0..100], [0..100])
$res[0] = 1

1> identical([0..100], ['0.0', 1..100])
$res[1] = ''

2> identical([0..100], ['0.0', 1..100], sub {shift == shift})
$res[2] = 1

3> identical(['0.66666666666', 0..10], [2/3, 0..10], sub {shift == shift})
$res[3] = ''

4> identical(['0.66666666666', 0..10], [2/3, 0..10], sub {shift() - shift() < 1e-5})
$res[4] = 1

# if you need this to be true check out https://stackoverflow.com/a/12127428/13992
5> identical([0..100], [List::Util::shuffle(0..100)])
$res[5] = '' 
```

# html - 两个“看似”的 CSS 规则具有相同的特异性权重，但不会产生相同的结果

> ID：12127265
> 
> 赞同：1
> 
> 时间：2012-08-26T02:49:35.187
> 
> 标签：html, css, css-specificity

好的，我试图将 CSS 级联和特异性理解为一门“科学”，而不是总是将其留给“命中或失败”的方法。我希望有人能帮助我。

我有一个规则：

```
.bluebutton {margin: 0 10px 6px 0;} /* rule 1 */ 
```

我需要覆盖以更改特定实例中的边距。

所以我添加了一个`class`并`div`写道：

```
.aside-right .bluebutton a {margin:30px 0 0 100px;} /* rule 2 */ 
```

但是，规则 2 并没有覆盖规则 1。

所以我将规则 2 修改为：

```
.aside-right a.bluebutton {margin:30px 0 0 100px;} /* rule 3 */ 
```

它会覆盖“ `.bluebutton`”规则。/* 规则1 */

起初我写了这个 HTML

```
 <a class="blueButton aside-right" href="enrollNow.html"><span>Enroll Now</span></a> <!-- html-1 --> 
```

然后我修改并将按钮包含在 a 中`div`并写道：

```
<div class="aside-right"><a class="blueButton" href="enrollNow.html"><span>Enroll Now</span></a></div> <!-- html-2 --> 
```

html-2 适用于规则 3。

有人可以帮我理解为什么规则 3 会覆盖规则 1，而规则 2 不会覆盖规则 1？看起来规则 2 和 3 具有相同的权重（对我而言）。是因为规则 2以 a of和`anchor`的任何元素内的任何标签为目标，而规则 3 仅以a of 为目标吗？我希望我能清楚地解释我想要理解的内容。`class``.bluebutton``.aside``anchor``class``.bluebutton`

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T02:54:14.460

规则 2 不选择与规则 1 相同的元素。

`bluebutton`规则 1 选择任何具有类的元素

规则 2从 html 中的class 元素中选择没有后代`<a>`元素`bluebutton`的元素的后代元素`aside-right``bluebutton``<a>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T02:58:34.587

`.bluebutton a`并且`a.bluebutton`不等价。第一个查找在具有 class 的元素`a`内**的**`bluebutton`元素。第二个查找属于class的元素**的**`a`元素。**`bluebutton`**

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T03:01:21.133

**规则 1**
`.bluebutton`将针对任何具有 class 的元素`bluebutton`。

**规则 2**
`.aside-right .bluebutton a`将定位一个锚元素，该元素嵌套在带有 的元素`class="bluebutton"`内，嵌套在带有 的元素内`class="aside-right"`。示例结构：

```
<div class="aside-right">
    <div class="bluebutton">
        <a href="#">link</a>
    <div>
<div> 
```

**规则 3**
`.aside-right a.bluebutton`将针对任何`class="bluebutton"`嵌套在带有`class="aside-right"`. 示例结构：

```
<div class="aside-right">
    <a class="bluebutton" href="#">link</a>
<div> 
```**

# macos - 如何以编程方式拦截 OSX (10.8) 打印命令？

> ID：12127270
> 
> 赞同：3
> 
> 时间：2012-08-26T02:50:44.327
> 
> 标签：macos, printing, applescript

基本上，如果我希望能够处理打印作业初始化命令。就像在文档上按 Cmd+P 之类的。我希望能够访问正在打印的数据并以编程方式处理它，而不是通过 GUI。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T05:23:55.570

您可以在这里使用 OSX automator 来做您需要的事情。这取决于您想从打印的文档中得到什么。Automator 允许您创建打印插件，您可以从系统打印对话框中进行选择。我看到您已经提到您不想按原样使用“PDF”打印菜单，但也许可以通过打印插件中的额外自动化添加一些价值。该插件将创建打印文档的 .pdf，您可以对其应用一系列自动操作。

1.  开始 /Applications/Automator
2.  在“为您的文档选择类型：”下，选择“打印插件”
3.  然后设置处理打印文档所需的一系列操作。例如，您可能想要执行“提取 PDF 文本”或“PDF 到图像”。在搜索字段中输入“pdf”以查看所有可用的与 pdf 相关的操作。
4.  保存自动化工作流程。您只能为其命名，但不能将其保存为任意路径中的文件。
5.  您可以通过在任何给定应用程序中打开系统打印对话框，然后下拉左下角的“PDF”菜单来使用该插件。您应该会看到您的插件出现在那里。

# php - 在 PHP 中引用扩展类的对象

> ID：12127271
> 
> 赞同：0
> 
> 时间：2012-08-26T02:50:59.587
> 
> 标签：php, class, reference

我有 3 个类名：“ **ClassA** ”、“ **ClassB** ”、“ **ClassC** ”。

**ClassB**扩展**ClassA**。**ClassC.php**包括**ClassA.php**然后**是 ClassB.php**。

我在 ClassC 中有一个数组**$** **arrayA**：`var $arrayA;`

我该怎么做下面的事情？

_ 当我在**ClassA中****创建 ClassC**的实例时：**`$this->ClassC`**

 ******ClassA中的****$arrayA**为: `$this->ClassC->arrayA`,**

 ****arrayA**的值是通过**ClassC**的过程改变的，`$this->ClassC->arrayA`的值也改变了！

_作为**ClassA**`$this->ClassC->arrayA`中的对象调用。

 **_ 在 B 类中使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:05:51.543

如果我正确地遵循，答案的本质是对象不会在引用它们的每个上下文中“复制”，它们是“指向”的。

假设您有一个 Person 对象，并且该人有一个名为“hometown”的属性，它是 Town 的一个实例。在非常笼统的伪代码中：

```
Town->name = "Portland";
Person->hometown = Town;
Person->hometown->name = "Detroit";
echo Town->name;

// output is "Detroit" 
```******

# html - div 背景在 chrome 中无法正确显示

> ID：12127272
> 
> 赞同：0
> 
> 时间：2012-08-26T02:51:06.983
> 
> 标签：html, css, image, google-chrome, background

我正在使用浮动：左；和浮动：对；将两个 div 容器排成一行，左边一个包含输入栏，右边一个包含一个小背景图像（搜索按钮）。

它在 Opera 和 Firefox、MSIE 9.0+ 中显示良好，但是当我在 chrome 中查看它时，右侧容器的背景图像稍微偏离了位置（向下移动了几个像素）。

我将背景颜色设置为红色以突出显示问题： [screenshot](http://img31.imageshack.us/img31/7387/chromekk.jpg)

index.php 输出：

```
<div class="header_inner_right">
    <form id="search_bar" method="post" action="" onsubmit="return checkSearchQuery();">
            <div class="left">
                <input id="search_field" name="q" type="text" value="Search riddim, artist, tune, label and producer" 
                    onfocus="searchFieldValue_onFocus();" onblur="searchFieldValue_onBlur();">
            </div>
            <div class="right">
                <input id="search_button" src="images/search_button.gif" type="submit" value="">
            </div>
    </form>
</div> 
```

index_chrome.css（当 php 脚本检测到 chrome 浏览器时使用）：

```
@charset "ISO-8859-1";

#search_bar {
    width: 450px;
    height: 37px;
    background-color: red
}

#search_bar #search_field {
    border: 0px;
    width: 365px;
    height: 37px;
    padding-left: 20px;
    padding-right: 20px;
    background-image: url(../images/search_field.gif);
    background-repeat: no-repeat;
    font-weight: bold;
    color: #c0c0c0;
    background-color: #ffffff
}

#search_bar #search_button {
    cursor: pointer;
    border: 0px;
    outline: none;
    height: 37px;
    width: 45px;
    background-image: url(../images/search_button.gif);
    background-repeat: no-repeat
} 
```

如何修复它并调整放大镜背景图像的 y 位置，使其与左侧 div 的背景图像完美对齐并完全隐藏右侧 div 容器的红色背景？

编辑：http: [//jsfiddle.net/YcraM/](http://jsfiddle.net/YcraM/)

抱歉，忘记了 JSFiddle！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:23:14.760

这可能不是您想听到的答案，但几乎不可能让大多数输入元素在跨浏览器中看起来相同。我敦促您从`div`元素中设计提交按钮。例子：

```
<div class="left">
    <input id="search_field" name="q" type="text" value="Search riddim, artist, tune, label and producer" 
        onfocus="searchFieldValue_onFocus();" onblur="searchFieldValue_onBlur();">
</div>
<div class="right">
    <div id="search_button"></div>
</div> 
```

根据您的喜好使用 css 为 div 设置样式 - 请记住使用`:hover`和`:active`伪类。然后，例如使用 jQuery，使其功能如下：

```
$('#search_button').on('click', function(e) {
    $(e.currentTarget).closest('form').submit();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T03:30:53.980

我已经在 Chrome 21 和 FF 14 中对其进行了测试，似乎设置`line-height:0px;`解决了这个问题。

```
div.right {
    float: right;
    line-height:0px;
}    
div.left {
    float: left;
    line-height:0px;
} 
```

[http://jsfiddle.net/YcraM/3/](http://jsfiddle.net/YcraM/3/)

我没有在其他浏览器中测试过，如果这不是最好的解决方案，请原谅我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T03:42:02.457

您可以添加`float:right`（或离开）到`#search_bar #search_button`，也可以解决问题

# postgresql - 如何获取函数参数列表（这样我就可以删除一个函数）

> ID：12127274
> 
> 赞同：27
> 
> 时间：2012-08-26T02:51:20.813
> 
> 标签：postgresql, function, ddl, catalog

我想让 SQL 在 PostgreSQL 中删除一个函数。我编写`DROP FUNCTION`并从中获取函数名称`pg_proc`。那不是问题。但是，如果我留下空白参数，它将不会删除该函数。

我检查了手册并写了然后我必须用它的参数来识别函数来删除它，例如`DROP FUNCTION some_func(text,integer)`不仅仅是`DROP FUNCTION some_func`.

我在哪里可以找到参数？在`pg_proc`表中函数的行中没有参数。那么我怎样才能让 SQL 删除这个函数呢？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-26T04:57:10.600

Postgres 有一个专门的功能用于此目的。随 Postgres 8.4 引入。[手册：](https://www.postgresql.org/docs/current/functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE)

> **`pg_get_function_identity_arguments(func_oid)`**...获取参数列表以识别函数（没有默认值）...
> 
> `pg_get_function_identity_arguments`返回标识函数所需的参数列表，例如，它需要出现在 within 中的形式`ALTER FUNCTION`。这种形式省略了默认值。

使用它（和[`format()`](https://www.postgresql.org/docs/current/functions-string.html#FUNCTIONS-STRING-FORMAT)，在 Postgres 9.1 中引入），以下查询生成 DDL 语句以删除与您的搜索词匹配的函数：

```
SELECT format('DROP %s %I.%I(%s);'
            , CASE WHEN p.proisagg THEN 'AGGREGATE' ELSE 'FUNCTION' END
            , n.nspname
            , p.proname
            , pg_catalog.pg_get_function_identity_arguments(p.oid)
             ) AS stmt
FROM   pg_catalog.pg_proc p
JOIN   pg_catalog.pg_namespace n ON n.oid = p.pronamespace
WHERE  p.proname = 'dblink'                     -- function name
-- AND n.nspname = 'public'                     -- schema name (optional)
-- AND pg_catalog.pg_function_is_visible(p.oid) -- function visible to user
ORDER  BY 1; 
```

**Postgres 11**中的系统目录`pg_proc`发生了变化。被替换，添加了真正的存储过程。你需要适应。看：**`proisagg``prokind`**

 ***   [如何在 PostgreSQL 中删除我的所有函数？](https://dba.stackexchange.com/a/122777/3684)

回报：

```
 stmt
---------------------------------------------------
 DROP FUNCTION public.dblink(text);
 DROP FUNCTION public.dblink(text, boolean);
 DROP FUNCTION public.dblink(text, text);
 DROP FUNCTION public.dblink(text, text, boolean); 
```

在示例中找到四个匹配项，因为 dblink 使用了[重载函数](https://www.postgresql.org/docs/current/xfunc-overload.html)。
有选择地运行`DROP`语句！

***或者***，您可以使用方便的转换为[对象标识符类型**`regprocedure`**](https://www.postgresql.org/docs/current/datatype-oid.html#DATATYPE-OID-TABLE)，它返回一个完整的函数签名，包括参数类型：

```
-- SET LOCAL search_path = '';  -- optional, to get all names schema-qualified
SELECT format('DROP %s %s;'
            , CASE WHEN proisagg THEN 'AGGREGATE' ELSE 'FUNCTION' END
            , oid::regprocedure
             ) AS stmt
FROM   pg_catalog.pg_proc
WHERE  proname = 'dblink'   -- function name
ORDER  BY 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-12T03:48:21.623

使用 pgadminIII 并直接访问功能列表并右键单击它然后选择删除![在此处输入图像描述](../Images/9e9f08d617508ccc97962275a442bb0b.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-27T09:15:08.343

在 Postgres 10 中，您可以在不知道参数列表的情况下删除函数，只要它在其模式中是唯一的。

```
drop function if exists some_func; 
```

[请参阅文档](https://www.postgresql.org/docs/current/static/sql-dropfunction.html)。

当然，如果您重载了函数（或试图删除多个模式），您仍然需要上述答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-28T19:49:38.713

如果您正在使用旧版本的 postgres，其中 pg_get_function_identity_arguments(func_oid) 不存在，我创建自己的函数从函数中获取参数，您只需要传递函数的 oid，您需要部署下面的函数到您的 postgres 数据库。

```
CREATE OR REPLACE FUNCTION public.getFunctionParameter(functionOid oid)
  RETURNS text AS
$BODY$

declare
    t_paras text;
    paras oid[];
    res text :='(';
begin

select proargtypes into t_paras from pg_proc where oid=functionOid;
if t_paras is null or t_paras='' then
    return '()';
else
    paras:=string_to_array(t_paras,' ');
    for i in  array_lower(paras,1) .. array_upper(paras,1)
    loop
        raise notice 'para is %',paras[i];
        select format_type(paras[i]::oid,NULL) into t_paras;
        res:=res||t_paras||',';
    end loop;
    res:=substring(res from 1 for char_length(res)-1);
    res:=res||')';
    return res;
end if;

end 

    $BODY$
      LANGUAGE plpgsql ; 
```

下面的函数将列出函数名称和参数，如果你想在其他模式下获取函数，请更改模式名称，例如我使用 public

```
 SELECT n.nspname||'.'||p.proname||public.getFunctionParameter(p.oid)
FROM    pg_proc p JOIN   pg_namespace n ON n.oid = p.pronamespace
WHERE  n.nspname='public' 
```

你会得到如下结果

```
1 "public.getfunctionparameter(integer,text)"
2 "public.getfunctionparameter(oid)" 
```**

# ios - 在 popToRootViewController 之后未调用 viewWillAppear 方法

> ID：12127278
> 
> 赞同：1
> 
> 时间：2012-08-26T02:52:37.007
> 
> 标签：ios, viewwillappear, poptoviewcontroller

我有一个视图控制器，`UINavigationController`它在某些时候会推送（`navigationcontroller pushViewController: animated:`）第二个视图，然后再推送第三个视图，其中我有一个按钮，可以弹回根视图（`popToRootViewController: animated:`）。问题是视图弹回`viewWillApper`根视图后，根视图的方法没有被调用。我设置了一些断点来检查它，它只是没有通过它。我有一种方法可以重新加载放置在 中的根视图的某些内容，`viewWillApper`并且在`popToRootViewController: animated`. 知道发生了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-20T08:20:13.183

在 popToRootViewController 之后，我使用了委托方法来强制更新我的视图。我的 rootViewController 调用了一个网络上传类，完成后，我想重置 rootViewController 上的表单字段。

在网络上传类中，我创建了一个委托协议：

```
@protocol MyNetworkDelegate <NSObject>
@required
- (void) uploadCompleted;
@end

@interface MyNetworkUploader : NSObject{
    id <MyNetworkDelegate> _delegate;
}

@property (nonatomic,strong) id delegate;

//other properties here

+(id)sharedManager;
-(int)writeAssessments;

@end 
```

在 MyNetworkUploader.m 中：

```
-(int)writeAssessments{
   //code here to do the actual upload
   //.....

   //this is a non-view class so I use a global navigation controller
   //maybe not the best form but it works for me and I get the required
   //behaviour
   [globalNav popToRootViewControllerAnimated:NO];
   [[globalNav.view viewWithTag:1] removeFromSuperview];
   [_delegate uploadCompleted];
} 
```

然后，在我的 rootViewController 中：

```
//my upload is done within a completion block so I know when
//it's finished
typedef void(^myCompletion)(BOOL);

-(void) uploadAssessment:(myCompletion) compblock{
    //do the upload
    sharedManager=[MyNetwork sharedManager]; //create my instance
    sharedManager.delegate=self;  //set my rootViewController as the network class delegate
    int numWritten= [sharedManager writeAssessments]; 
    compblock(YES);
}

#pragma mark - protocol delegate
-(void)uploadCompleted{
    //this is a local method that clears the form
    [self clearTapped:nil];
} 
```

我并不是说这是最好的解决方案，但它对我来说是一种享受！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-26T04:47:54.667

使用 navController 推送时，假设 VC1 正在推送 VC2，并且您正在使用自定义演示样式来推送 VC2，根据您选择的样式，VC2 弹出时不会调用 VC1 的 viewWillAppear。这是根据其演示风格调用的时间列表。

**UIModalPresentationStyle, iPhone, iPad**

.fullScreen YES YES
.pageSheet YES NO
.formSheet YES NO
.currentContext YES YES
.custom NO NO NO
.overFullScreen NO NO
.overCurrentContext NO NO
.blurOverFullScreen 仅在 tvOS - N/A, N/A
.popover YES NO
.none CRASH CRASH

[在这里找到参考](https://medium.com/livefront/why-isnt-viewwillappear-getting-called-d02417b00396)

# extjs - 重新加载页面 ExtJS 4.1 后返回 Data Grid 中的选择

> ID：12127284
> 
> 赞同：1
> 
> 时间：2012-08-26T02:53:13.310
> 
> 标签：extjs, extjs4.1

> **可能重复：**
> [在 extjs 网格中刷新选定行后记住](https://stackoverflow.com/questions/9111084/remember-after-refresh-selected-row-in-extjs-grid)

我在 ExtJS 4.1 中有一个数据网格。当我单击任何单元格时（单元格值表现为另一个页面的 url），我将登陆具有新数据网格的不同页面。现在，当我单击浏览器上的后退按钮时，我需要返回到网格上的相同选择。

对此的任何帮助都将受到高度赞赏。

谢谢， 斯里

# ruby - Rails 加载错误的 Ruby 版本

> ID：12127287
> 
> 赞同：2
> 
> 时间：2012-08-26T02:54:16.027
> 
> 标签：ruby, ruby-on-rails-3

出于某种原因，Rails 正在加载一个旧版本的 Ruby，这有点奇怪（因为所有其他指标都不是这样）。

这是所有常用命令的版本输出：

```
# Ruby Version
# $ ruby -v
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]

# Rails Version
# $ rails -v
Rails 3.2.6

# Gem Console
# $ gem environment
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.23
  - RUBY VERSION: 1.9.3 (2012-04-20 patchlevel 194) [x86_64-linux]
  - INSTALLATION DIRECTORY: /usr/local/ruby/1.9.3-p194/lib/ruby/gems/1.9.1
  - RUBY EXECUTABLE: /usr/local/ruby/1.9.3-p194/bin/ruby
  - EXECUTABLE DIRECTORY: /usr/local/ruby/1.9.3-p194/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /usr/local/ruby/1.9.3-p194/lib/ruby/gems/1.9.1
     - /home/vagrant/.gem/ruby/1.9.1
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/    

# IRB
# $ irb
irb(main):001:0> RUBY_VERSION
=> "1.9.3"

# Rails Console
# $ rails console
Loading development environment (Rails 3.2.6)
irb(main):002:0> RUBY_VERSION
=> "1.8.7" 
```

请注意，只有 Rails 报告了错误的版本，而所有其他人都报告了 1.9.3。

我使用上面列出的 gem 环境安装了 Ruby，所以预计它的运行方式会有所不同......

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T03:37:38.240

如果您使用的是 RVM 或 rbenv，它们都有一个项目级别的点文件（.rbenv、.rvm），可以对此类内容造成严重破坏。先检查那里。

# vba - 从文档中提取超链接时返回 90 个空值的代码

> ID：12127292
> 
> 赞同：1
> 
> 时间：2012-08-26T02:56:06.040
> 
> 标签：vba, excel, ms-word

我对编码特别陌生，更不用说 VBA。在认真学习 VBA 一周后，我开始掌握它的窍门。目前，我正在尝试编写一个代码，将超链接（地址和名称）从 word 文档（最终是 word、excel 和 power point 文件）中提取出来，并将它们转储到我运行的 excel 文件中来自的代码。它还将文件路径和名称转储到列表顶部。我可以一次运行代码并从 1 个文件中提取链接，并且代码在最后填充的行结束后将其弹出。当我必须更新链接时，它将为我节省大量时间。

```
Sub ExtractWordLinks()
    'the following code gets and sets an open file command bar for word documents
    Dim Filter, Caption, SelectedFile As String
    Dim Finalrow As String
    Filter = "docx Files (*.docx),*.docx, doc Files (*.doc),*.doc, xlsm Files (*.xlsx),*.xlsx"
    Caption = "Please Select .doc, .docx, .xlsx files only, " & TheUser
    SelectedFile = Application.GetOpenFilename(Filter, , Caption)
    'check if value is blank if it is exit
    Finalrow = Cells(Rows.Count, 1).End(xlUp).Row
    If (Trim(SelectedFile) = "") Then
        Exit Sub
    Else
        'setting up the inital word application object
        Set wordapp = CreateObject("word.Application")
        'opening the document that is defined in the open file dialog
        wordapp.documents.Open (SelectedFile)
        'ability to change wether it needs to burn cycles updating the UI
        wordapp.Visible = False
        'declare excel sheet
        Dim xlsSheet As Excel.Worksheet
        'set active sheet
        Set xlsSheet = Application.ActiveSheet
        Dim i As Integer
        i = 1
        'MsgBox (wordapp.ActiveDocument.Hyperlinks.Count)
        For i = 1 To wordapp.ActiveDocument.Hyperlinks.Count
            'puts the title of the document in the formatted cells
            'xlsSheet.Cells(Finalrow + 1, 1).Value = wordapp.ActiveDocument.Path & "\" & wordapp.ActiveDocument.Name
            'formats the file name cell to be a bit easier to discern from the listing.
            Range(Cells(Finalrow + 1, 1), Cells(Finalrow + 1, 2)).Font.Bold = True
            Range(Cells(Finalrow + 1, 1), Cells(Finalrow + 1, 2)).Merge
            'save the links address.
            xlsSheet.Cells(Finalrow + i, 1).Value = wordapp.ActiveDocument.Hyperlinks(i).Address
            'save the links display text
            xlsSheet.Cells(Finalrow + i, 2).Value = wordapp.ActiveDocument.Hyperlinks(i).TextToDisplay
        Next
        wordapp.ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
        wordapp.Quit SaveChanges:=wdDoNotSaveChanges
    End If
End Sub 
```

我的问题是，当我在一个简单的示例文件上运行此代码时，它在单个页面中包含 3 个左右的超链接，它会返回我想要的所有内容，文件路径/名称在顶部，所有链接在正下方的页面（一列中的地址，另一列中显示的文本）。但是，当我在我正在为其编写此代码的文件之一上运行它时（一个包含约 30 个链接的 95+ 页 .docx 文件），它会在格式化部分打印出路径/文件，然后删除 90（每个 90 time) 在第二次打印出路径/文件之前的空白行，然后是文档中的所有链接。它完美地完成了它，除了莫名其妙的第二个路径/文件（即使我注释掉我输入的位）和 90 个空白条目。

任何人都可以解释发生了什么，或者我应该尝试找出一种方法来通过删除我自己的链接代码来绕过这个问题，并包括一个删除所有空行的位？

# node.js - 编写节点应用程序并在运行“node server.js”时遇到错误

> ID：12127293
> 
> 赞同：14
> 
> 时间：2012-08-26T02:56:35.673
> 
> 标签：node.js

我正在编写一个节点应用程序，我最近在我的 Mac Os X Lion 机器（运行 10.7.4）上从端口 3000 切换到端口 80，每当我运行 node server.js 时，我都会收到以下错误

```
events.js:66
    throw arguments[1]; // Unhandled 'error' event
                   ^
Error: listen EACCES
    at errnoException (net.js:768:11)
    at HTTPServer.Server._listen2 (net.js:891:19)
    at listen (net.js:935:10)
    at HTTPServer.Server.listen (net.js:984:5)
    at Object.<anonymous> (/Users/ajain/Documents/Projects/Time-Feed/server.js:127:5)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:492:10) 
```

关于我必须做些什么来解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-26T02:59:51.700

您需要拥有root权限才能监听低于1024的端口号。因此，您可以使用该`sudo`命令。

```
sudo node server.js 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-20T19:41:47.533

如果 sudo 没有帮助，只需将端口更改为 1234 或 2000 或 3000 之类的东西。

# java - 在 Android 应用上发出 POST 请求

> ID：12127296
> 
> 赞同：2
> 
> 时间：2012-08-26T02:58:05.090
> 
> 标签：java, android, eclipse

我知道以前有人问过这个问题，但我很挣扎。我几乎不知道任何 Java，但想要一个应用程序，这样我就可以在不打开我的网站的情况下执行我的 POST 请求。

所以我有这个布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:ems="10"
        android:inputType="textPersonName" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Name:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="20dp" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText1"
        android:layout_below="@+id/editText1"
        android:ems="10"
        android:inputType="textPostalAddress" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignTop="@+id/editText2"
        android:text="Address:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="20dp" />

    <EditText
        android:id="@+id/editText3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/editText2"
        android:ems="10"
        android:inputType="phone" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/editText2"
        android:text="Phone:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="20dp" />

    <EditText
        android:id="@+id/editText4"
        android:layout_width="wrap_content"
        android:layout_height="200dp"
        android:layout_alignLeft="@+id/editText3"
        android:layout_below="@+id/editText3"
        android:ems="10"
        android:inputType="textMultiLine" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignTop="@+id/editText4"
        android:text="Comments:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="15dp" />

    <Button
        android:id="@+id/button1"
        android:layout_width="300dp"
        android:layout_height="50dp"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/editText4"
        android:layout_toLeftOf="@+id/editText4"
        android:text="Done"
        android:onClick="goToWeb(???);" />

</RelativeLayout> 
```

这个Java：

```
package com.example.request;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

public class MainRequest extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main_request);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main_request, menu);
        return true;
    }

    public void goToWeb() {
        /* open webpage - how? */
    }
} 
```

我想`http://www.example.com`在他们单击完成时发出这个 POST 请求：

```
name: (content of @+id/editText1)
addr: (content of @+id/editText2)
phone: (content of @+id/editText3)
comment: (content of @+id/editText4) 
```

我希望手机的浏览器打开，并执行 POST 请求（如果有意义的话）

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:14:03.960

我觉得这是一个相关的问题，有一个很好的答案，你可能想考虑看看。希望这可以帮助。

[Java - 通过 POST 方法轻松发送 HTTP 参数](https://stackoverflow.com/questions/4205980/java-sending-http-parameters-via-post-method-easily)

编辑：实际上，我特别为 Android 找到了一个更好的：

[Android、Java：HTTP POST 请求](https://stackoverflow.com/questions/4543894/android-java-http-post-request)

好的，所以我猜您对如何从您创建的文本字段中获取文本也有点困惑。这是另一个可以帮助您的stackoverflow问题：

[获取编辑文本字段的值](https://stackoverflow.com/questions/4531396/get-value-of-a-edit-text-field)

您设置了一些edittext字段，因此您只需将它们存储在一个变量中（您可以通过使用`findViewById(R.id.idOfEditText)`并将其存储在一个变量中来获取该值。现在使用该变量，您只需要调用`.getText()`然后您就​​拥有了字符串并且可以做任何你需要做的事情（比如通过 POST 发送）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:52:42.247

试试这个类 MainRequest

```
package com.example.teststack;

import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.protocol.HTTP;
import org.apache.http.util.EntityUtils;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.webkit.WebView;
import android.widget.Button;
import android.widget.EditText;

public class MainRequest extends Activity {

    EditText textPersonName = null;
    EditText textPostalAddress = null;
    EditText phone = null;
    EditText textMultiLine = null;
    Button submit = null;
    String action = "http://www.omokoroacomputerhelp.com/";
    HttpPost httpRequest = null;
    List<NameValuePair> params = null;
    HttpResponse httpResponse = null;
    WebView webView = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main_request);
        textPersonName = (EditText) findViewById(R.id.personName);
        textPostalAddress = (EditText) findViewById(R.id.postalAddress);
        phone = (EditText) findViewById(R.id.phone);
        textMultiLine = (EditText) findViewById(R.id.multiLine);
        submit = (Button) findViewById(R.id.submit);
        submit.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                httpRequest = new HttpPost(action);
                params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("name", textPersonName
                        .getText().toString()));
                params.add(new BasicNameValuePair("phone", phone.getText()
                        .toString()));
                params.add(new BasicNameValuePair("addr", textPostalAddress
                        .getText().toString()));
                params.add(new BasicNameValuePair("comment", textMultiLine
                        .getText().toString()));
                try {
                    // send http request
                    httpRequest.setEntity(new UrlEncodedFormEntity(params,
                            HTTP.UTF_8));
                    // get http response
                    httpResponse = new DefaultHttpClient().execute(httpRequest);
                    //
                    Intent gotoIntent = new Intent(MainRequest.this,
                            Webpage.class);
                    gotoIntent.putExtra("source",
                            EntityUtils.toString(httpResponse.getEntity()));
                    startActivity(gotoIntent);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main_request, menu);
        return true;
    }

} 
```

和网页

```
package com.example.teststack;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.webkit.WebView;

public class Webpage extends Activity {
    WebView webView;

    final String mimeType = "text/html";

    final String encoding = "utf-8";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_webpage);
        Intent webPageIntent = getIntent();
        String htmlSource = webPageIntent.getStringExtra("source");
        webView = (WebView) findViewById(R.id.webview);
        webView.loadData(htmlSource, mimeType, encoding);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_webpage, menu);
        return true;
    }
} 
```

和 activity_main_request.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <EditText
        android:id="@+id/personName"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:ems="10"
        android:inputType="textPersonName" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Name:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="20dp" />

    <EditText
        android:id="@+id/postalAddress"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/personName"
        android:layout_below="@+id/personName"
        android:ems="10"
        android:inputType="textPostalAddress" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignTop="@+id/postalAddress"
        android:text="Address:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="20dp" />

    <EditText
        android:id="@+id/phone"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@+id/postalAddress"
        android:ems="10"
        android:inputType="phone" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/postalAddress"
        android:text="Phone:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="20dp" />

    <EditText
        android:id="@+id/multiLine"
        android:layout_width="wrap_content"
        android:layout_height="200dp"
        android:layout_alignLeft="@+id/phone"
        android:layout_below="@+id/phone"
        android:ems="10"
        android:inputType="textMultiLine" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignTop="@+id/multiLine"
        android:text="Comments:"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="15dp" />

    <Button
        android:id="@+id/submit"
        android:layout_width="300dp"
        android:layout_height="50dp"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/multiLine"
        android:layout_toLeftOf="@+id/multiLine"
        android:text="Done" />

</RelativeLayout> 
```

和activity_webpage.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

   <WebView  
        android:id="@+id/webview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        />

</RelativeLayout> 
```

和 AndroidManifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.teststack"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.INTERNET" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainRequest"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Webpage"
            android:label="@string/title_activity_webpage" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T05:09:25.653

尝试使用`NameValuePair`..我正在提供我在我的应用程序中使用的代码来执行 Http Post

```
public String postData(String url, String xmlQuery) {

        final String urlStr = url;
        final String xmlStr = xmlQuery;
        final StringBuilder sb  = new StringBuilder();

        Thread t1 = new Thread(new Runnable() {

            public void run() {

                HttpClient httpclient = MySSLSocketFactory.getNewHttpClient();

                HttpPost httppost = new HttpPost(urlStr);

                try {

                    List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(
                            1);
                    nameValuePairs.add(new BasicNameValuePair("xml", xmlStr));

                    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                    HttpResponse response = httpclient.execute(httppost);

                    Log.d("Vivek", response.toString());

                    HttpEntity entity = response.getEntity();
                    InputStream i = entity.getContent();

                    Log.d("Vivek", i.toString());
                    InputStreamReader isr = new InputStreamReader(i);

                    BufferedReader br = new BufferedReader(isr);

                    String s = null;

                    while ((s = br.readLine()) != null) {

                        Log.d("YumZing", s);
                        sb.append(s);
                    }

                    Log.d("Check Now",sb+"");

                } catch (ClientProtocolException e) {

                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }

        });

        t1.start();
        try {
            t1.join();
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        System.out.println("Getting from Post Data Method "+sb.toString());

        return sb.toString();
    } 
```

# vb.net - 一种在 VB.NET 中保存特定 My.Settings 变量的方法

> ID：12127297
> 
> 赞同：0
> 
> 时间：2012-08-26T02:58:28.230
> 
> 标签：vb.net, save, my.settings

在 My.Settings 我有很多变量，包括 36000 条记录 Datatable 和 Couple Large Array Lists，现在当我调用 My.Settings.Save() 时，它会保存所有需要花费大量时间的变量并保存没有的变量被改变了，有没有办法让它只保存一个特定的数据表或数组列表？

```
My.Setting.Save() 
'but what i want for example is something like
My.Settings.SomeDatatable.Save() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T09:52:00.060

What about saving your **dataTable not within your Settings**. You could make use of [**DataTable.WriteXml()**](http://msdn.microsoft.com/en-us/library/system.data.datatable.writexml.aspx). this would keep your settings much smaller and you can access them separately!

```
' save table
DataTable.WriteXml("yourFile.xml")

' load table
Dim newTable As New DataTable
newTable.ReadXml(fileName) 
```

But if there is no other possibility [**this solution**](https://stackoverflow.com/questions/3295348/save-datatable-as-user-setting) from [*SLaks*](https://stackoverflow.com/users/34397/slaks) will work too

```
' save table
Dim writer As New StringWriter()
table.WriteXml(writer)
My.MySettings.Default.TableXml = writer.ToString()

' load table
Dim reader As New StringReader(My.MySettings.Default.TableXml)
table.ReadXml(reader) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T09:38:51.370

这些设置存储在 XML 文件中。由于 XML 文件不以固定宽度的记录格式存储数据，因此无法在不重写整个内容的情况下更新 XML 文件中的单个节点。如果速度太慢，我建议：

*   将这些设置存储在多个 XML 文件中，这样您只需保存适用的文件，而无需保存其余文件
*   将设置存储在数据库中，可以单独保存每一行而无需重写整个文件

数据库将其数据存储在固定宽度的“页面”中，因此只需要重写修改过的页面，而不是整个文件。

# cakephp - cakephp 如何通过 (The Join Model) 将数据保存到 hasMany

> ID：12127300
> 
> 赞同：0
> 
> 时间：2012-08-26T02:58:43.747
> 
> 标签：cakephp

我有三张桌子

Job Employee EmployeesJob --------- -------- ---------- id id id name name job_id employee_id work_hours

关系是hasMany through (The Join Model[EmployeesJob]) 我想做的是当添加一个新Job时，管理员可以选择一个或多个员工，相关信息将存储在EmployeesJob和Job中。在工作/admin_add

```
echo $this->Form->input('EmployeesJob.employee_id',array('options'=>$employees, 'label'=>'Employee')); 
```

它显示所有员工，但管理员只能选择其中一个，也不会在EmployeesJob中插入新行，我的工作表有其他关联表（HABTM，属于），所以我不确定saveAssociated（$this- >request->data) 可以做所有的事情。

我需要帮助，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T04:11:06.423

对于员工的多项选择，您应该编写以下内容：

```
echo $this->Form->input('EmployeesJob.employee_id][',array('options'=>$employees, 'label'=>'Employee', 'multiple' => 'multiple')); 
```

要保存多条记录，您应该在控制器的代码中编写以下内容：

```
$this->Job->saveAssociated($this->request->data, array('deep' => true)); 
```

此链接也可以帮助您实现相同的目的：[CakePHP 保存外键问题](https://stackoverflow.com/questions/12102915/cakephp-saving-foreign-key-issue/12103920#12103920)

# javascript - 如何从 data.args 中获取新创建的节点的 id？

> ID：12127302
> 
> 赞同：1
> 
> 时间：2012-08-26T02:59:17.050
> 
> 标签：javascript, jquery, jstree

当用户单击“创建”按钮让他们填写表格时，我想显示一个花式框。这用于捕获附加数据并将其与 jsTree 中新创建的节点相关联。我需要获取新创建节点的 ID 并将其作为 GET 参数传递给 fancybox 调用。到目前为止，我似乎无法弄清楚如何获得 ID。

这是我到目前为止所拥有的：

```
 $("#demo").jstree({ 
        // List of active plugins
        "plugins" : ["themes", "json_data", "ui", "crrm", "cookies", "dnd", "search", "types", "hotkeys", "contextmenu", "unique"],

        .bind("create.jstree", function (e, data) {
            $.post(
                "server.php", 
                { 
                    "operation" : "create_node", 
                    "id" : data.rslt.parent.attr("id").replace("node_",""), 
                    "position" : data.rslt.position,
                    "title" : data.rslt.name,
                    "type" : data.rslt.obj.attr("rel")
                }, 
                function (r) {
                    if(r.status) {
                        $(data.rslt.obj).attr("id", "node_" + r.id);
                    }else{
                        $.jstree.rollback(data.rlbk);
                    }
                }
            );
        })

    $("#demo").bind("before.jstree", function (e, data) {
        if(data.func === "create") { 
            var id = data.args[0].attr("id").replace("node_","");
            showFancybox("edit_task.php?action=create&parent_id="+id);
        }
    })

    // Code for the menu buttons
    $(function () { 
        $("#mmenu input").click(function () {
            switch(this.id) {
                case "add_default":
                case "add_folder":
                    $("#demo").jstree("create", null, "last", { "attr" : { "rel" : this.id.toString().replace("add_", "") } });
                    break;
                case "search":
                    $("#demo").jstree("search", document.getElementById("search_text").value);
                    break;
                case "text": break;
                default:
                    $("#demo").jstree(this.id);
                    break;
            }
        });
    }); 
```

我现在拥有的代码在创建新节点之前找到了父 ID。我尝试等待几秒钟，然后尝试从数据库中读取最新条目，但这并不是很可靠并且比需要的要慢。创建新节点并将其添加到数据库后，如何从 jsTree 获取新节点的 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:09:49.570

这有效：

```
id = data.args[0].attr("id"); 
```

# android - 连接到 mysql 服务器的 Android 应用程序返回包含在 [] 、 {} 和双引号中的值

> ID：12127304
> 
> 赞同：0
> 
> 时间：2012-08-26T02:59:36.277
> 
> 标签：android, mysql, json, android-asynctask

我开发了一个连接到远程 mysql 数据库的小应用程序，以便从中返回信息。我基本上使用的是与 mysql 数据库位于同一服务器上的 php 文件；php 文件根据应用程序的用户响应返回数据。这是它的外观（凭据除外）：

```
<?php
mysql_connect("localhost" ,"my_user","my_password");
mysql_select_db('my_db'); 
$q=mysql_query("SELECT * FROM people WHERE birthyear>'".$_REQUEST['year']."'");
while($e=mysql_fetch_assoc($q))
        $output[]=$e;

print(json_encode($output));

mysql_close();
?> 
```

在 Android 端，代码如下所示：

```
package com.example.maltinololperson.asynctask;
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.TextView;
public class ReadWebpageAsyncTask extends Activity {
  private TextView textView;
  InputStream is = null;
  /** Called when the activity is first created. */
  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    textView = (TextView) findViewById(R.id.TextView01);
  }
  private class DownloadWebPageTask extends AsyncTask<String, Void, String> {
    @Override
    protected String doInBackground(String... urls) {
        String result = "";
        //the year data to send
        ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
        nameValuePairs.add(new BasicNameValuePair("year","1980"));
        //http post
        try{
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://www.example.org/getAllPeopleBornAfter.php");
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost); 
            HttpEntity entity = response.getEntity();
             is = entity.getContent();
        }catch(Exception e){
            Log.e("log_tag", "Error in http connection "+e.toString());
        }
        //convert response to string
        try{
            BufferedReader reader = new BufferedReader(new InputStreamReader(is,"UTF-8"),8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");

               // Log.i("log_tag","Line reads: " + line); 
            }
            is.close();
            result=sb.toString();
        }catch(Exception e){
            Log.e("log_tag", "Error converting result "+e.toString());
        }
        //parse json data
        try{
            JSONArray jArray = new JSONArray(result);
            for(int i=0;i<jArray.length();i++){
                JSONObject json_data = jArray.getJSONObject(i);
               // Log.i("log_tag","id: "+json_data.getInt("id")+
                  //  ", name: "+json_data.getString("name")+
                  //  ", sex: "+json_data.getInt("sex")+
                   // ", birthyear: "+json_data.getInt("birthyear")
                //);
            }
        }
        catch(JSONException e){
            Log.e("log_tag", "Error parsing data "+e.toString());
        }
      return result;
    }
    @Override
    protected void onPostExecute(String result) {
      textView.setText(result);
    }
  }
public void readWebpage(View view) {
    DownloadWebPageTask task = new DownloadWebPageTask();
task.execute();
 }
} 
```

一切正常，应用程序似乎完美地连接到服务器，但唯一的问题是返回的数据（在设备模拟上）采用以下形式：**[{"id":"1200","name": "John smith", "Sex":"m","birthyear":"1980"},{"id":"7110","name":"Batman":,....}]**，我想要看起来像这样：**id：1200，姓名：john smith，性别：m，birtheyear：1980**等等。由于我是 Android 开发和 JSON 的新手，我无法找到实现这一目标的方法，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:07:48.727

查看此[URL](http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)这正是您需要学习的内容。参考它，如果您有更多疑问，请告诉我。对于初学者来说，这是一个很棒的教程

# javascript - 使用 jquery 添加到表格内的表格的元素未发布

> ID：12127305
> 
> 赞同：1
> 
> 时间：2012-08-26T02:59:38.023
> 
> 标签：javascript, jquery, forms, post

我编写了以下代码来动态构建一个表，然后将其发送到服务器并通过电子邮件传递。但是，当用户发布它未发布的数据时，下拉字段中的任何项目。我做了很多研究，我认为这与 DOM 有关，但我不确定如何修复它。

```
<script type="text/javascript" src="http://code.jquery.com/jquery.js"></script>
      <script type="text/javascript">
      var row_counter = 1
      var sandwichOptions = { ''      : 'None',
                              'item1' : 'Item1',
                              'item2' : 'Item2',
                              'item3' : 'Item3',
                              'item4' : 'Item4'
                              };
          function createTable(tbody, rows, cols) {
              if (tbody == null || tbody.length < 1) return;
              if ($('#body') != null) {$('#body').empty()};
              for (var r = 1; r <= rows; r++) {
                  var trow = $("<tr>");
                  var sandwich = $('#sandwiches').clone();
                      sandwich.name = "sandwich"+r;
            //    var sandwich = $('<select></select>');
            //        //sandwich.attr("id","sandwich"+r);
            //        sandwich.name = "sandwich"+r;
            //        sandwich.append(new Option('Foo', 'foo', true, true));
            //        $.each(sandwichOptions, function(val, text) 
            //                           {sandwich.append(new Option(text, val, true, true))}); //, {value: "Item1", text: "Item1"}));
                  var salads = $('#salads').clone();
                      salads.name = "salads"+r;
                  var dessert = $('#dessert').clone();
                      dessert.name = "dessert"+r;
                  var name_input = document.createElement('input');
                      name_input.type = 'text';
                      name_input.name = "name_input"+r;
                  var special_request = document.createElement('input');
                      special_request.type = 'text';
                      special_request.name = "special_request"+r;
                  trow.append($("<td>").text(r));
                  trow.append($("<td>").append(name_input));
                  trow.append($("<td>").append(sandwich.show()));
                  trow.append($("<td>").append(salads.show()));
                  trow.append($("<td>").append(dessert.show()));
                  trow.append($("<td>").append(special_request));
                  trow.attr("id","row"+r);
                  tbody.append(trow)
              }
          }
           function add_row(tbody) {
                  var r = row_counter
                  var trow = $("<tr>");
                  var sandwich = $('#sandwiches').clone();
                      sandwich.name = "sandwich"+r;
                  var salads = $('#salads').clone();
                      salads.name = "salads"+r;
                  var dessert = $('#dessert').clone();
                      dessert.name = "dessert"+r;
                  var name_input = document.createElement('input');
                      name_input.type = 'text';
                      name_input.name = "name_input"+r;
                  var special_request = document.createElement('input');
                      special_request.type = 'text';
                      special_request.name = "special_request"+r;
                  trow.append($("<td>").text(r));
                  trow.append($("<td>").append(name_input));
                  trow.append($("<td>").append(sandwich.show()));
                  trow.append($("<td>").append(salads.show()));
                  trow.append($("<td>").append(dessert.show()));
                  trow.append($("<td>").append(special_request));
                  trow.attr("id","row"+r);
                  trow.appendTo(tbody);
              }
 $(document).ready(function() { 
    table = $('form #order_table');
    $('#refresh').click(function() {
    //you can simplify the code by making the addition or deletion of rows triggered
        var value = $('#CustNum').val();
        $('#refresh').val("Clear/Reset Form");
        createTable(table, value, 5);
        row_counter = value;
        table.show();
        $('#add_row').show();
        //$('#delete_row').show();
        $('#email').show();
        $('#send_button').show();
        $('#row_count').text(row_counter);
        });
    $('#add_row').click(function() {
        row_counter = parseInt(row_counter) + 1;
        add_row(table);                     
        $('#CustNum').val(row_counter);
        $('#row_count').text(row_counter);
        });
    $('#delete_row').click(function() {
    //if (row_counter == 1) return;
       $('#row'+row_counter).remove();
       row_counter = parseInt(row_counter) - 1;
       $('#CustNum').val(row_counter);
       $('#row_count').text(row_counter);

       });
    $(document).click(function() {
        if (parseInt(row_counter) > 1) {$('#delete_row').show()}
           else {$('#delete_row').hide()};
        });

    $('#CustEmail').focus(function() {
       if ($('#CustEmail').val() == 'email') {$('#CustEmail').val('')
                                                             .css('color','#000000')
                                                             .css('font-style','normal')
                                                };           
       }); 
    $('#CustEmail').blur(function() {
       if ($('#CustEmail').val() == '') {$('#CustEmail').val('email')
                                                        .css('color','#A0A0A0')
                                                        .css('font-style','italic')
                                                     };
       });
    }); 
```

```
<form id = "testxx"  method = "post">
     enter number of customers:  
     <input type="number" name = "CustNum" id = "CustNum" value=1 min=1>
     <input type="button" value="Generate Form" id="refresh">
     <input type="button" value="Add Row" id="add_row" style ="display: none;">
     <input type="button" value="Delete Row" id="delete_row" style ="display: none;">
<table id="order_table" style="display: none;" name = "test"> 
    <thead>
        <tr>
            <th>#</th>
            <th>Name</th>
            <th>Sandwich</th>           
            <th>Salad</th>
            <th>Dessert</th>
            <th>Special Requests<th>
          </tr>
     </thead>
     <tbody id = "body">
     </tbody>                 
</table> 
```

```
<select id="sandwiches" style="display: none;">
    <option>None</option>
    <option value = "Option1">Option1</option>
    <option value = "Option2">Option2</option>
    <option value = "Option3">Option3</option>
    <option value = "Option4">Option4</option>
</select>

<select id="salads" style="display: none;">
    <option>None</option>
    <option value = "Option1">Option1</option>
    <option value = "Option2">Option2</option>
    <option value = "Option3">Option3</option>
    <option value = "Option4">Option4</option>
</select>

<select id="dessert" style="display: none;">
    <option>None</option>
    <option value = "Option1">Option1</option>
    <option value = "Option2">Option2</option>
    <option value = "Option3">Option3</option>
    <option value = "Option4">Option4</option>
</select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T21:22:29.393

谢谢，我能够弄清楚。

我做了几件事来纠正。我将 select 语句放在表单标签内，我将 table var 更改为 table = $('#body') - tbody 的 id。我将命名代码从'X'.name ='Y'更改为jquery方法'X'.attr（'name'，'Y'）。

在所有这些更改之间，它终于起作用了。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:29:50.337

当元素被隐藏时，它不会与表单一起提交。
删除`display:none`您选择提交的。

# regex - flex 如何匹配行锚的开头？

> ID：12127310
> 
> 赞同：3
> 
> 时间：2012-08-26T03:00:47.133
> 
> 标签：regex, algorithm, flex-lexer, finite-automata, nfa

我一直想知道输入锚 ( `^`) 的开头是如何转换为 flex 中的 FSA 的。我知道行尾锚 ( `$`) 与要匹配`r/\n`的`r`表达式匹配。输入锚的开头如何匹配？我看到的唯一解决方案是使用开始条件。它如何在程序中实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T03:12:11.320

行尾标记`$`的不同之处`\n`在于它也匹配`EOF`，即使行尾标记`\n`或未`\r\n`在文件末尾找到。

我没有看 flex 的实现，但我会同时实现`^`并`$`使用布尔标志。该`^`标志最初会被设置，然后重置为`false`一行中的第一个字符之后，然后设置回`true`下一个行尾标记之后，依此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-10T16:26:01.980

如果您的扫描仪使用 ^anchor，那么每个开始条件都需要两个初始状态条目：

*   行首，和
*   除此以外。

Flex 这样做，并在输入指针后面窥视以确定要查阅的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-01T19:27:09.197

行锚的开头与模式匹配：

开始线^。

（插入符号后跟一个点）

示例（文本的编号行）：

```
%{
int ln = 1;
%}

beginningOfLine ^.
newline \n

%%
{beginningOfLine} { if (ln == 1) {
                        printf ("%d \t", ln);
                        printf (yytext);
                        ln++; 
                    }else{
                        printf (yytext);
                    }
                  }

{newline}         { printf ("\n");
                    printf ("%d \t", ln);
                    ln++; }

%% 
```

# vba - VBA：如果用户删除单元格，范围对象会发生什么？

> ID：12127311
> 
> 赞同：30
> 
> 时间：2012-08-26T03:00:56.103
> 
> 标签：vba, vba, excel

假设我在[vba](/questions/tagged/vba "显示标记为“vba”的问题")`r`中有一些带有一些类型变量的模块`Range`。假设，在某个时候，我在那里存储了一个 Range 对象（例如活动单元格）。现在我的问题是：`r`如果用户删除单元格（单元格，而不仅仅是它的值），值会怎样？

我试图在 VBA 中解决这个问题，但没有成功。结果很奇怪。`r`不是`Nothing`， 的值`r`被报告为 type `Range`，但是如果我尝试在调试器窗口中查看它的属性，每个属性的值都报告为“需要对象”。

我如何以编程方式确定变量`r`是否处于这种状态？

*我可以在不产生错误并捕获它的情况下执行此操作吗？*

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-26T04:24:39.497

好问题！我以前从未考虑过这一点，但我认为这个函数将识别一个已初始化的范围 - 不是 Nothing - 但现在处于“需要对象”状态，因为它的单元格已被删除：

```
Function RangeWasDeclaredAndEntirelyDeleted(r As Range) As Boolean
Dim TestAddress As String

If r Is Nothing Then
    Exit Function
End If
On Error Resume Next
TestAddress = r.Address
If Err.Number = 424 Then    'object required
    RangeWasDeclaredAndEntirelyDeleted = True
End If
End Function 
```

你可以测试是这样的：

```
Sub test()
Dim r As Range

Debug.Print RangeWasDeclaredAndEntirelyDeleted(r)
Set r = ActiveSheet.Range("A1")
Debug.Print RangeWasDeclaredAndEntirelyDeleted(r)
r.EntireRow.Delete
Debug.Print RangeWasDeclaredAndEntirelyDeleted(r)
End Sub 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-26T04:17:41.297

我相信，当您在 VBA 中使用 Set 关键字时，它会在后台创建一个指向您指定的工作表中工作表的 Range 对象的指针（每个单元格都是给定 Range 的 Worksheet 的 Cells 集合中的一个对象）。当您仍在内存中引用范围时删除范围时，范围变量指向的对象的内存已被释放。

但是，您的 Range 变量很可能仍然包含指向最近删除的 Range 对象的指针，这就是为什么它不是什么都不是，但是它所指向的任何东西都不再存在，这会在您再次尝试使用该变量时导致问题.

查看此代码以了解我的意思：

```
Public Sub test2()
    Dim r As Excel.Range
    Debug.Print ObjPtr(r)           ' 0

    Set r = ActiveSheet.Range("A1")
    Debug.Print ObjPtr(r)           ' some address

    r.Value = "Hello"

    r.Delete
    Debug.Print ObjPtr(r)           ' same address as before
End Sub 
```

查看这篇文章了解有关 ObjPtr() 的更多信息：http: [//support.microsoft.com/kb/199 ​​824](http://support.microsoft.com/kb/199824)

因此，虽然您拥有对象的有效地址，但不幸的是，该对象已被删除，因此不再存在。似乎“什么都没有”只是检查指针中的地址（我认为 VBA 认为该变量是“设置”）。

至于如何解决这个问题，不幸的是我目前没有看到一种干净的方法（如果有人确实找到了一种优雅的方法来处理这个问题，请发布它！）。您可以像这样使用 On Error Resume Next：

```
Public Sub test3()
    Dim r As Excel.Range
    Debug.Print ObjPtr(r)           ' 0

    Set r = ActiveSheet.Range("A1")
    Debug.Print ObjPtr(r)           ' some address

    r.Value = "Hello"

    r.Delete
    Debug.Print ObjPtr(r)           ' same address as before

    On Error Resume Next
    Debug.Print r.Value
    If (Err.Number <> 0) Then
        Debug.Print "We have a problem here..."; Err.Number; Err.Description
    End If
    On Error GoTo 0
End Sub 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-31T12:53:25.023

> 我如何以编程方式确定变量 r 是否处于这种状态？
> 
> *我可以在不产生错误并捕获它的情况下执行此操作吗？*

不。

据我所知，您无法可靠地测试这种情况：除非引发并捕获错误。

您的问题已在[其他地方引起注意和讨论](http://www.dailydoseofexcel.com/archives/2012/08/28/range-variables-and-deleted-cells/)：Excel/VBA 博客中的两个大人物（Dick Kusleika 和 Rob Bovey）已经对其进行了研究，您可能会在其中找到一些有用的信息。但答案是否定的。

总而言之，这是一个很好的问题，但答案相当令人担忧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-24T02:25:03.337

为了测试一个范围对象当前是否无效，我使用了这个函数：

```
Public Function InvalidRangeReference(r As Range) As Boolean    
    On Error Resume Next
    If r.Count = 0 Then
        InvalidRangeReference = Err
    End If    
End Function 
```

# java - 大量使用mysql的java代码

> ID：12127314
> 
> 赞同：0
> 
> 时间：2012-08-26T03:02:22.540
> 
> 标签：java, mysql

我目前正在运行一些对 mysql 数据库进行大量调用的 java 代码。这些调用淹没了数据库，在代码运行几个小时后，我得到了一个嵌套异常：

```
java.io.EOFException
    at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:1934)
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2380)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2909)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:798)
    at com.mysql.jdbc.MysqlIO.secureAuth411(MysqlIO.java:3700)
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1203)
    at com.mysql.jdbc.Connection.createNewIO(Connection.java:2572)

Last packet sent to the server was 8789 ms ago.
    at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:2592)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2909)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:798)
    at com.mysql.jdbc.MysqlIO.secureAuth411(MysqlIO.java:3700)
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1203)
    at com.mysql.jdbc.Connection.createNewIO(Connection.java:2572) 
```

不幸的是，我对这类问题没有太多经验，谁能推荐一些方法来确保我的所有查询都能得到处理？

我可以理解这是一个非常广泛的问题，但查询本身并不难，它更多的是我请求的查询数量的规模。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:38:21.140

我会在 OS/MySql/Web 服务器级别对此进行故障排除。换句话说，这本身不是“Java”问题。这可能更像是一个“系统性能/系统配置”问题。

建议：

1) 您没有指定您的操作系统、Web 服务器/应用程序服务器。这些是关键。

2) 运行基本性能检查（Linux 的 ps -eaf 和 iostat，Windows 的 Task Mgr/CPU/Memory/Networking stats）。特别注意“netstat”（Linux 和 Windows）。

3) 查看所有相关日志（Linux 的 /var/log/messages 等；Windows 的 EventVwr 等）

4) 检查您的操作系统、数据库和 Web 服务器配置设置。

5) 特别注意可能的“陈旧连接”和与数据库相关的“连接池”参数。

检查这些链接：

*   [由于以下原因导致通信链接失败：java.io.EOFException](https://stackoverflow.com/questions/4436997/communications-link-failure-due-to-java-io-eofexception) <= Set Tomcat "autoReconnect=true" ...如果您甚至*正在运行*Tomcat！

*   [http://wordpress.transentia.com.au/wordpress/2009/09/30/tweaking-the-grails-datasource-to-cope-with-mysqls-foibles/](http://wordpress.transentia.com.au/wordpress/2009/09/30/tweaking-the-grails-datasource-to-cope-with-mysqls-foibles/)

*   [http://sacharya.com/grails-dbcp-stale-connections/](http://sacharya.com/grails-dbcp-stale-connections/) <= 调整连接池参数

*   [http://communications-link-failure.blogspot.com/](http://communications-link-failure.blogspot.com/) <= 减少 mysql wait_timeout

# pandas - 熊猫子图 useoffset=False

> ID：12127315
> 
> 赞同：1
> 
> 时间：2012-08-26T03:02:41.237
> 
> 标签：pandas

如何告诉熊猫`DataFrame.plot(subplots=True...)` 不要在刻度标签上使用偏移量？

通常对于单个情节，我可以发出：

`matplotlib.pyplot.ticklabel_format(axis='y', useOffset=False)`

但它似乎不适用于 subplot 选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-27T07:09:19.763

使用选项 suplots=True 绘制数据框（此处为 df）会为数据框的每一列创建一个轴。需要在所有轴上进行迭代以设置 ticklabel_format。

```
In [59]: axes = df.plot(subplots=True)

In [60]: for axis in axes:
   ....:     axis.ticklabel_format(axis='y', useOffset=False) 
```

# java - _ 分隔字符串上的 JAVA RegEx

> ID：12127328
> 
> 赞同：2
> 
> 时间：2012-08-26T03:08:49.303
> 
> 标签：java, regex

好的，我需要一个正则表达式，它将第一个单词捕获到下划线字符，然后捕获可能具有下划线字符的下一个单词。所以，这里是一组和预期的结果：

```
gear_Armor_Blessed_Robes = "gear", "Armor" and "Blessed_Robes"
gear_Armor_Chain_Coif = "gear", "Armor" and "Chain_Coif"
gear_Armor_Chain_Hauberk = "gear", "Armor" and "Chain_Hauberk"
gear_Armor_Chain_Shirt = "gear", "Armor" and "Chain_Shirt"
gear_Armor_Chain_Leggings = "gear", "Armor" and "Chain_Leggings" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T03:12:49.557

无需为此使用正则表达式，只需使用`indexOf`and `substring`：

```
String s = "Armor_Blessed_Robes";
int idx = s.indexOf("_");
System.out.println(s.substring(0, idx)); // Armor
System.out.println(s.substring(idx + 1)); // Blessed_Robes 
```

使用正则表达式，您必须使用以下内容，这有点复杂且难以阅读：

```
Pattern p = Pattern.compile("([^_]+)_(.+)");
Matcher m = p.matcher(s);
if (m.find()) {
  String first = m.group(1);  // Armor
  String second = m.group(2); // Blessed_Robes
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T03:13:53.177

您可以沿 拆分`_`，将拆分数限制为 3：

```
assert Arrays.equals("gear_Armor_Blessed_Robes".split("_", 3),
    new String[] { "gear", "Armor", "Blessed_Robes" }); 
```

它应该为您提供`String[]`包含`String`问题中指定的 3 的 a 。

# c++ - 以buffer为参数的类函数，一头雾水

> ID：12127330
> 
> 赞同：1
> 
> 时间：2012-08-26T03:09:49.107
> 
> 标签：c++, class, function, char

我有一个需要为学校完成的练习，这让我感到困惑。我只需要提示正确的方向即可，因为这对我来说没有意义。

在 Employee 类中添加一个成员函数：

```
void Employee::format(char buffer[], int buffer_maxlength) 
```

成员函数应该用员工的姓名和薪水填充缓冲区。确保不要超出缓冲区。它可以保存 buffer_maxlength 个字符，不包括 '\0' 终止符。

我没有得到的是传递给函数的参数是什么。不应该传递名称，然后将其输入缓冲区吗？或者，函数不应该不接受任何参数并填充缓冲区吗？如果缓冲区是一个参数，我如何填充它？

这里很困惑。

还没有开始编码，因为我还不明白这个练习。

不需要任何人为我编写程序，只需要提示这里发生了什么。

谢谢。

编辑：这是我到目前为止的代码，它似乎有效。我不确定的一件事是缓冲区溢出。由于我无法调整缓冲区的大小，我是否应该将其设置为我知道现有数据不会超出的大小？这似乎效率低下，但不知道还能做什么。

```
#include "stdafx.h"
#include <iostream>
#include <sstream>
#include <string.h>
#pragma warning(disable : 4996) // had to include this for the strcpy function, not sure why

using namespace std;

/**
A basic employee class that is used in many examples
in the book "Computing Concepts with C++ Essentials"
*/
class Employee
{
public:
   /**
   Constructs an employee with empty name and no salary.
   */
Employee();
/**
  Constructs an employee with a given name and salary.
  @param employee_name the employee name
  @param initial_salary the initial salary
*/
Employee(string employee_name, double initial_salary);
/**
  Sets the salary of this employee.
  @param new_salary the new salary value
*/
void set_salary(double new_salary);
/**
  Gets the salary of this employee.
  @return the current salary
*/
double get_salary() const;
/**
  Gets the name of this employee.
  @return the employee name
*/
string get_name() const;

void format(char buffer[], int buffer_maxlength);

private:
   string name;
   double salary;
   char buffer;
};

Employee::Employee()
{  
   salary = 0;
}

Employee::Employee(string employee_name, double initial_salary)
{  
   name = employee_name;
   salary = initial_salary;
}

void Employee::set_salary(double new_salary)
{  
   salary = new_salary;
}

double Employee::get_salary() const
{  
   return salary;
}

string Employee::get_name() const
{  
   return name;
}

void Employee::format(char buffer[], int buffer_maxlength)
{   
string temp_name;
//string space = " ";
char terminator = '\0';
double input_salary = salary;   
string s;   
stringstream output_salary;   
output_salary << input_salary;   
s = output_salary.str();
temp_name = name.c_str() + s + terminator;
strcpy(buffer, temp_name.c_str());
cout << buffer << endl; 
}

int main()
{
const int BUFFER_SIZE = 100;
char input_buffer[BUFFER_SIZE];

string temp_string;
string space = " ";

Employee bob_buffer("Buffer, Bob", 100000);
bob_buffer.format(input_buffer, BUFFER_SIZE);   

system("pause");

return 0;
} 
```

编辑：使用 strncpy 而不是 strcpy 来防止溢出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:27:40.603

如果*姓名*和*薪水*是类成员，那么您已经可以在成员函数中访问它们：无需传递它们。`buffer`传递的参数是您使用函数填充的参数：您的`Employee`类的用户将调用函数，传入一个缓冲区以填充结果。

因此，您的任务是定义`Employee`类 API 的一部分，提供类内部的特定表示，并了解缓冲区边界/字符串处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T06:00:03.130

您的讲师要求的是可以按如下方式使用的功能：

1.  调用者分配它选择的任何大小的缓冲区。
2.  调用者调用`Employee::format`，同时传递缓冲区和缓冲区大小。
3.  `Employee::format`用员工姓名和薪水填充缓冲区，确保它不会写入缓冲区末尾。
4.  调用者现在有一个 Employee 的字符串表示形式，它可以用于它需要做的任何事情（打印到控制台、保存到文件、在 GUI 小部件中显示等）。

本质上，缓冲区参数是一个返回值。 `Employee::format`的唯一职责是将姓名和薪水写入缓冲区以供调用者使用。考虑到这一点，您可能需要进行以下更改：

*   您在 中有一个`buffer`成员`Employee`，看起来它可能已被添加以供`format`使用。这是不必要的，因为调用者负责分配缓冲区。此外，`buffer`参数 in`format`隐藏了同名的成员，因此该成员永远不会被使用。
*   `cout << buffer << endl;`末尾的行将`format`员工信息打印到控制台，但调用者可能不希望这样。 `format`应该只将员工信息写入缓冲区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T03:24:13.557

我猜您的老师要求您将姓名和薪水信息格式化到缓冲区中，并确保您的格式化文本不会超出缓冲区大小。

姓名和薪水必须是您的员工类的成员变量。

# java - Jackson 数据绑定与异构 Json 对象

> ID：12127334
> 
> 赞同：1
> 
> 时间：2012-08-26T03:10:53.540
> 
> 标签：java, json, jackson

我正在调用一个返回 json 对象的休息服务。我正在尝试使用 Jackson 和数据绑定来反序列化对我的 Java Beans 的响应。

示例 Json 是这样的：

```
{
    detail1: { property1:value1, property2:value2},
    detail2: { property1:value1, property2:value2},
    otherObject: {prop3:value1, prop4:[val1, val2, val3]}
} 
```

本质上，detail1 和detail2 具有相同的结构，因此可以由单个类类型表示，而OtherObject 是另一种类型。

目前，我的课程设置如下（这是我更喜欢的结构）：

```
class ServiceResponse {
    private Map<String, Detail> detailMap;
    private OtherObject otherObject;

    // getters and setters
}

class Detail {
    private String property1;
    private String property2;

    // getters and setters
}

class OtherObject {
    private String prop3;
    private List<String> prop4;

    // getters and setters
} 
```

然后，只需执行以下操作：

```
String response = <call service and get json response>
ObjectMapper mapper = new ObjectMapper();
mapper.readValue(response, ServiceResponse.class) 
```

问题是我在阅读有关如何正确配置映射和注释以获得我想要的结构的文档时迷失了方向。我希望 detail1、detail2 创建 Detail 类，并希望 otherObject 创建一个 OtherObject 类。

但是，我也希望detail类存储在一个map中，这样可以方便的区分和检索，而且以后的service中会返回detail3、detail4等（即map中的ServiceResponse 看起来像 `"{detail1:Detail object, detail2:Detail object, ...}`）。

这些类应该如何注释？或者，也许有更好的方法来构建我的类以适应这个 JSON 模型？感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T13:31:08.610

只需在 ServiceResponse 中的 2-args 方法上使用*@JsonAnySetter ，如下所示：*

```
@JsonAnySetter
public void anySet(String key, Detail value) {
    detailMap.put(key, value);
} 
```

请注意，@JsonAnySetter 只能拥有一个“属性”，因为它是未知属性的后备。请注意，JsonAnySetter 的 javadocs 是不正确的，因为它声明它应该应用于 1-arg 方法；你总是可以在 Jackson 中打开一个小错误；）

# c - 二叉搜索树插入不起作用

> ID：12127335
> 
> 赞同：0
> 
> 时间：2012-08-26T03:11:16.270
> 
> 标签：c, binary-tree, insertion

我正在关注一本书，Problem Solving & Program Design in C，来学习 C。在这本书中，他们给出了构建二叉搜索树的所有必要部分......但是，我的实现没有奏效。这是插入部分；

```
void
add_to_t(tree_node_t *oldTreep, // input/output - binary search tree
        tree_element_t ele)       // input - element to add
{
    oldTreep = tree_insert(oldTreep, ele);
}
tree_node_t * tree_insert(tree_node_t *oldTreep, tree_element_t ele)
{
    if(oldTreep == NULL){
        oldTreep = TYPED_ALLOC(tree_node_t);
        strcpy(oldTreep->element.name, ele.name);
        strcpy(oldTreep->element.sName, ele.sName);
        oldTreep->element.seatClass = ele.seatClass;
        oldTreep->leftp = NULL;
        oldTreep->rightp = NULL;
    }
    else if (strcmp(oldTreep->element.name, ele.name)==0){
        /* duplicate key - no insertion */
    }
    else if (strcmp(oldTreep->element.name, ele.name)>0){
        oldTreep->rightp = tree_insert(oldTreep->rightp, ele);
    }
    else
    {
        oldTreep->leftp = tree_insert(oldTreep->leftp, ele);
    }
    return(oldTreep);

} 
```

我的 scan_passenger 功能（我从这个函数调用的结果中传递 ele）；

```
void scan_passenger(tree_element_t *pass)
{
    char passName[10], passSname[10];
    int classNum;
    printf("\nEnter the Name of passenger to add the binary search tree> ");
    scanf("%s", passName);
    printf("Enter the Surname of passenger to add the binary search tree> ");
    scanf("%s", passSname);
    printf("Enter the class number of passenger to add the binary search tree> ");
    scanf("%d", &classNum);
    strcpy(pass->name, passName);
    strcpy(pass->sName, passSname);
    pass->seatClass = classNum;
} 
```

如果需要，还有我的 typdefs 和 headers；

```
#include "stdio.h"
#include "stdlib.h"
#include "string.h"
#define TYPED_ALLOC(type) (type *)malloc(sizeof (type))
typedef struct tree_element_s {
    char name[10];
    char sName[10];
    int seatClass;
}tree_element_t;

typedef struct tree_node_s {
    tree_element_t element;
    struct tree_node_s *leftp, *rightp;
}tree_node_t; 
```

我的问题是它不会创建二叉搜索树的根。当我尝试向堆中添加一个新元素时，它似乎创建了一个新节点。当我跟踪我的代码时，似乎这个函数的每个实例都返回 NULL。我想说每次当我调用 tree_insert 时，它首先是 if 语句（认为 root 是 NULL）......对不起我的英语不好。而且我在谈论编码术语时可能会犯一些错误（可能是因为我在缺席一年后从那本书中回到了学习C。所以我可能会将它们混合在一起）提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T03:29:52.950

在 add_to_t 中，您更新了 oldTreep，但由于它是一个局部变量，因此一旦您离开函数，新值就会丢失。

例如，您可以将 oldTreep 的新值返回给调用者，调用者使用返回值更新*他的*oldTreep

```
tree_node_t
add_to_t(tree_node_t *oldTreep, // input/output - binary search tree 
        tree_element_t ele)       // input - element to add 
{ 
    return tree_insert(oldTreep, ele); 
} 

...

myRootOfTheTree = add_to_t (myRootOfTheTree, element); 
```

另一种解决方案是在树中始终有一个虚拟元素。

# ruby - 在 Ruby 中重置单例实例

> ID：12127336
> 
> 赞同：21
> 
> 时间：2012-08-26T03:11:22.900
> 
> 标签：ruby, rspec, singleton, rspec2

如何在 Ruby 中重置单例对象？我知道一个人永远不想在*真正的*代码中这样做，但是单元测试呢？

这是我在 RSpec 测试中尝试做的事情 -

```
describe MySingleton, "#not_initialised" do
  it "raises an exception" do
    expect {MySingleton.get_something}.to raise_error(RuntimeError)
  end
end 
```

它失败了，因为我之前的一项测试初始化​​了单例对象。我已经尝试遵循[此](http://blog.ardes.com/2006/12/11/testing-singletons-with-ruby)链接中 Ian White 的建议，该建议基本上是猴子修补 Singleton 以提供 reset_instance 方法，但我得到了一个未定义的方法“reset_instance”异常。

```
require 'singleton'

class <<Singleton
  def included_with_reset(klass)
    included_without_reset(klass)
    class <<klass
      def reset_instance
        Singleton.send :__init__, self
        self
      end
    end
  end
  alias_method :included_without_reset, :included
  alias_method :included, :included_with_reset
end

describe MySingleton, "#not_initialised" do
  it "raises an exception" do
    MySingleton.reset_instance
    expect {MySingleton.get_something}.to raise_error(RuntimeError)
  end
end 
```

在 Ruby 中最惯用的方法是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-24T14:40:48.760

我想只需这样做就可以解决您的问题：

```
describe MySingleton, "#not_initialised" do
  it "raises an exception" do
    Singleton.__init__(MySingleton)
    expect {MySingleton.get_something}.to raise_error(RuntimeError)
  end
end 
```

甚至更好地添加到回调之前：

```
describe MySingleton, "#not_initialised" do
  before(:each) { Singleton.__init__(MySingleton) }
end 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-08-26T08:11:38.133

棘手的问题，单身人士很粗糙。部分原因是您正在展示（如何重置它），部分原因是他们做出的假设倾向于稍后咬您（例如大多数Rails）。

您可以做几件事，充其量它们都是“好的”。最好的解决方案是找到摆脱单例的方法。我知道，这是手动操作的，因为没有可以应用的公式或算法，并且它消除了很多便利，但如果你能做到，它通常是值得的。

如果你做不到，至少尝试注入单例而不是直接访问它。现在测试可能很难，但想象一下在运行时必须处理这样的问题。为此，您需要内置的基础设施来处理它。

这是我想到的六种方法。

* * *

**提供类的实例，但允许类被实例化**。这是最符合单例的传统呈现方式。基本上任何时候你想引用单例，你都会与单例实例交谈，但你可以针对其他实例进行测试。标准库中有一个模块[可以](http://rdoc.info/stdlib/singleton/frames)帮助解决这个问题，但它是`.new`私有的，所以如果你想使用它，你必须使用类似的东西`let(:config) { Configuration.send :new }`来测试它。

```
class Configuration
  def self.instance
    @instance ||= new
  end

  attr_writer :credentials_file

  def credentials_file
    @credentials_file || raise("credentials file not set")
  end
end

describe Config do
  let(:config) { Configuration.new }

  specify '.instance always refers to the same instance' do
    Configuration.instance.should be_a_kind_of Configuration
    Configuration.instance.should equal Configuration.instance
  end

  describe 'credentials_file' do  
    specify 'it can be set/reset' do
      config.credentials_file = 'abc'
      config.credentials_file.should == 'abc'
      config.credentials_file = 'def'
      config.credentials_file.should == 'def'
    end

    specify 'raises an error if accessed before being initialized' do
      expect { config.credentials_file }.to raise_error 'credentials file not set'
    end
  end
end 
```

然后在任何你想访问它的地方，使用`Configuration.instance`

* * *

使单例成为**其他类的实例**。然后您可以单独测试其他类，而无需显式测试您的单例。

```
class Counter
  attr_accessor :count

  def initialize
    @count = 0
  end

  def count!
    @count += 1
  end
end

describe Counter do
  let(:counter) { Counter.new }
  it 'starts at zero' do
    counter.count.should be_zero
  end

  it 'increments when counted' do
    counter.count!
    counter.count.should == 1
  end
end 
```

然后在您的应用程序某处：

```
MyCounter = Counter.new 
```

* * *

您可以确保永远不要编辑主类，然后将**其子类**化以进行测试：

```
class Configuration
  class << self
    attr_writer :credentials_file
  end

  def self.credentials_file
    @credentials_file || raise("credentials file not set")
  end
end

describe Config do
  let(:config) { Class.new Configuration }
  describe 'credentials_file' do  
    specify 'it can be set/reset' do
      config.credentials_file = 'abc'
      config.credentials_file.should == 'abc'
      config.credentials_file = 'def'
      config.credentials_file.should == 'def'
    end

    specify 'raises an error if accessed before being initialized' do
      expect { config.credentials_file }.to raise_error 'credentials file not set'
    end
  end
end 
```

然后在您的应用程序某处：

```
MyConfig = Class.new Configuration 
```

* * *

确保有办法**重置单例**。或者更一般地说，撤消您所做的任何事情。（例如，如果您可以使用单例注册某个对象，那么您需要能够取消注册它，例如，在 Rails 中，当您创建子类时`Railtie`，它会将其记录在一个数组中，但您可以[访问该数组并从中删除该项目它](https://twitter.com/josh_cheek/status/238313563347898368)）。

```
class Configuration
  def self.reset
    @credentials_file = nil
  end

  class << self
    attr_writer :credentials_file
  end

  def self.credentials_file
    @credentials_file || raise("credentials file not set")
  end
end

RSpec.configure do |config|
  config.before { Configuration.reset }
end

describe Config do
  describe 'credentials_file' do  
    specify 'it can be set/reset' do
      Configuration.credentials_file = 'abc'
      Configuration.credentials_file.should == 'abc'
      Configuration.credentials_file = 'def'
      Configuration.credentials_file.should == 'def'
    end

    specify 'raises an error if accessed before being initialized' do
      expect { Configuration.credentials_file }.to raise_error 'credentials file not set'
    end
  end
end 
```

* * *

**克隆类**而不是直接测试它。这是我提出的一个[要点](https://gist.github.com/1832754#gistcomment-83608)，基本上你编辑克隆而不是真正的类。

```
class Configuration  
  class << self
    attr_writer :credentials_file
  end

  def self.credentials_file
    @credentials_file || raise("credentials file not set")
  end
end

describe Config do
  let(:configuration) { Configuration.clone }

  describe 'credentials_file' do  
    specify 'it can be set/reset' do
      configuration.credentials_file = 'abc'
      configuration.credentials_file.should == 'abc'
      configuration.credentials_file = 'def'
      configuration.credentials_file.should == 'def'
    end

    specify 'raises an error if accessed before being initialized' do
      expect { configuration.credentials_file }.to raise_error 'credentials file not set'
    end
  end
end 
```

* * *

**在 modules 中**开发行为，然后将其扩展到单例。[这](https://gist.github.com/2246180)是一个稍微复杂的例子。如果您需要初始化对象上的一些变量，您可能必须查看[`self.included`](http://rdoc.info/stdlib/core/Module%3aincluded)and方法。[`self.extended`](http://rdoc.info/stdlib/core/Module%3aextended)

```
module ConfigurationBehaviour
  attr_writer :credentials_file
  def credentials_file
    @credentials_file || raise("credentials file not set")
  end
end

describe Config do
  let(:configuration) { Class.new { extend ConfigurationBehaviour } }

  describe 'credentials_file' do  
    specify 'it can be set/reset' do
      configuration.credentials_file = 'abc'
      configuration.credentials_file.should == 'abc'
      configuration.credentials_file = 'def'
      configuration.credentials_file.should == 'def'
    end

    specify 'raises an error if accessed before being initialized' do
      expect { configuration.credentials_file }.to raise_error 'credentials file not set'
    end
  end
end 
```

然后在您的应用程序某处：

```
class Configuration  
  extend ConfigurationBehaviour
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-21T15:25:59.083

从上面更长的答案中提取一个 TL;DR，对于像我这样的未来懒惰的访客 - 我发现这很干净和容易：

如果你以前有这个

```
let(:thing) { MyClass.instance } 
```

改为这样做

```
let(:thing) { MyClass.clone.instance } 
```

# mysql - 处理用户角色的有效方法

> ID：12127337
> 
> 赞同：0
> 
> 时间：2012-08-26T03:11:29.113
> 
> 标签：mysql, database, theory, roles

我正在开发一个用户角色很少的门户。我一直想知道处理它们的最佳方法是什么。我已经为用户和客户创建了单独的表格，但是客户会想要这个功能，因为用户和用户也可以很容易地成为客户。

我也不想做很多关节，所以我的想法是这样的：

我将拥有 4 个不同的用户角色（至少目前如此），如下所示：

```
user
client
reviewer
admin 
```

我将为每个角色分配“id”。同时，我将在 mysql 中保留这些角色的表。它会是这样的：

```
1 - admin
2 - reviewer
3 - client
4 - user 
```

该表将仅在创建用户时使用，以获取用户“权限”的代码。所以假设会有一个人是用户和审阅者。他的角色是24岁。

```
login  password  email role     created
----------------------------------------------------------
guy    password  guy@gmail.com  24 2012-12-08 23:12:30 
```

我认为这可以很好地工作，但仍然想问你们是否认为这是一个好的和有效的解决方案。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:15:45.600

另一种方法是有一个多对多的 USER_ROLE 表，对于你的例子来说，这个表将具有以下整体。

```
login role
guy   2
guy   4 
```

我通常更喜欢这种跟踪角色的方法。在这种情况下，对这个表的连接应该是快速而轻松的，特别是如果您转而使用 user_id 而不是登录名，并适当地建立索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-21T17:42:19.530

您要定义的是基于角色的访问控制系统（我建议查找相关资源）。RBAC 系统将有一个单独的用户表和另一个角色表。用户和角色之间会有多对多的关系。此外，您会将权限表连接到另一个多对多关系中的角色。附上的图片代表了如何实现这个系统：[RBAC SYSTEM IN MYSQL](https://i.stack.imgur.com/zodpy.png)

之前有人问过类似的问题：[How to design a hierarchy role based access control system](https://stackoverflow.com/questions/16139712/how-to-design-a-hierarchical-role-based-access-control-system)

# python - Python：如何引用实例名称？

> ID：12127339
> 
> 赞同：4
> 
> 时间：2012-08-26T03:11:43.347
> 
> 标签：python, class, instance

我正在使用以下代码收集实例：

```
class Hand():
    instances = []
    def __init__(self):
        Hand.instances.append(self)
        self.value = 5

    def do_something(self, a):
        self.value = self.value * a

class Foo():
    def __init__(self):
        pass

    def insty(self):
        self.hand1 = Hand()
        self.hand2 = Hand()

foo = Foo()
foo.insty()
print Hand.instances

for hand in Hand.instances:
    print "how do I print the instance name?" 
```

最后一行只是一种学习如何访问实例名称的方法，因此我可以按顺序在每个实例上调用“do_something”方法。

如何访问 Hand 的每个实例的实例名称？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T03:18:42.450

如果您的意思是如何`hand1`从分配给的实例中获取`self.hand1`，答案是您不能。当你这样做时`self.hand1 = Hand()`，你告诉 Foo 对象它有一个 Hand，但 Hand 对象不知道它已被分配给一个 Foo。你可以这样做：

```
h = Hand()
self.bob = h
self.larry = h 
```

现在那只手的“名字”应该是什么？您将同一只手分配给“bob”和“larry”，所以它不可能有一个唯一的名称。

如果你想为每只手起一个名字，你需要告诉这只手你想给它起什么名字。您必须修改您的 Hand 代码以允许您将名称传递给构造函数，然后使用`Hand("some name")`.

您当然可以通过为它们分配属性来给它们“命名”：

```
self.hand1 = Hand()
self.hand1.name = "hand 1" 
```

. . . 但这些名称在任何方面都不是特殊的或“自动的”。

底线是，如果您希望某物有名称，*您*需要决定如何处理该名称。您需要编写自己的代码来为其命名，并编写自己的代码来检索其名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T03:16:16.703

`foo = Foo()`表示变量`foo`只是指向返回的对象`Foo()`，这里没有名字的概念。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-12T19:15:56.787

我不知道这是否能解决你的问题。我需要获取实例名称才能进行清晰的错误报告。我所到之处，人们都说“变量没有名字！名字只是指向事物的指针！”

但事实证明，在 python 中获取实例名称非常简单。我是这样做的：

```
import gc
def instance_names(self):
    referrers = gc.get_referrers(self)
    result = []
    dict_of_things = {}
    for item in referrers:
        if isinstance(item, dict):
            dict_of_things = item
    for k, v in dict_of_things.items():
        if v == self:
            result.append(k)
    if not result:
        result = ['unnamed instance']
    return result 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T03:16:39.337

`foo.__dict__`将有“ `hand1`”和“ `hand2`”键（等等）。但你可能会以错误的方式解决这个问题。如果名称很重要，则应将它们用作`Foo`（或某处）的显式索引。

例如

```
class Foo():
    def __init__(self):
        self.hands = {}

    def insty(self):
        self.hands['hand1'] = Hand()
        self.hands['hand2'] = Hand() 
```

# ios - CCSprite 旋转类似于 Cocos2D 中的汽车转向

> ID：12127343
> 
> 赞同：0
> 
> 时间：2012-08-26T03:13:21.047
> 
> 标签：ios, cocos2d-iphone, rotation, ccsprite

有什么方法可以旋转 CCSprite 使其表现得像汽车转向？如果我松开 CCSprite 的触摸，它应该会像转向一样平滑地自动返回到原来的位置！我使用下面的代码，

```
-(void)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
    {

        UITouch *touch=[touches anyObject];
        //acquire the previous touch location
        CGPoint firstLocation = [touch previousLocationInView:[touch view]];
         location = [touch locationInView:[touch view]];

        CGPoint touchingPoint = [[CCDirector sharedDirector] convertToGL:location];
        CGPoint firstTouchingPoint = [[CCDirector sharedDirector] convertToGL:firstLocation];

        CGPoint firstVector = ccpSub(firstTouchingPoint, Steering.position);
        CGFloat firstRotateAngle = -ccpToAngle(firstVector);
        CGFloat previousTouch = CC_RADIANS_TO_DEGREES(firstRotateAngle);

        CGPoint vector = ccpSub(touchingPoint, Steering.position);
        CGFloat rotateAngle = -ccpToAngle(vector);
        CGFloat currentTouch = CC_RADIANS_TO_DEGREES(rotateAngle);
        dialrotation+=currentTouch-PreviousTouch;
        sprite.rotation=dialrotation;
        } 
```

这可以平滑地旋转我的 CCSprite，但我不知道如何像汽车转向一样回到原来的位置。在 Cocos2D 中有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T03:38:01.097

在`ccTouchesBegan`方法中将 sprite.rotation 的值存储在某处，在使用此存储值对您的精灵`ccTouchesEnded`运行操作中。`CCRotateTo`

# zend-framework - 如何找到导致标头种子不干净的错误

> ID：12127344
> 
> 赞同：0
> 
> 时间：2012-08-26T03:13:25.960
> 
> 标签：zend-framework, zend-session

我不知道在使用 Zend_Framwork 开发我的应用程序时是否遗漏了什么，但这是我的问题，当我在主机服务器上运行我的应用程序时，我看不到任何 cookie，但在我的 WAMP 服务器上一切正常......

我储存了会话，用户信息以供以后使用，所以在主机服务器上我无法登录..

我使用 Zend_Auth 和 Zend_Acl，这是我的引导程序

```
$modelLoader = new Zend_Application_Module_Autoloader ( array ('basePath' => APPLICATION_PATH, 'namespace' => '', 'resourceTypes' => array ('form' => array ('path' => 'forms/', 'namespace' => 'Form_' ) ) ) );

    $this->_acl = new Application_Plugin_Acl ();
    $this->_auth = Zend_Auth::getInstance (); 
```

我还使用 Zend_Auth getStorage()->write('...') 在会话中写入信息。而且我的 application.ini 上的会话与我没有任何关系

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:20:40.160

因此，它可以在 WAMP 上运行，但不能在主机服务器上运行。我想你的意思是说你的 VPS 或专用服务器或说任何云。

`Zend_Auth`用途`$_SESSION`，它有许多功能在其上运行。例如，$_SESSION['Zend_Auth']['storage'] 将为您提供有关`hasIdentity()`检查内容的信息。

所以，你应该做的是，把它粘贴到代码附近的某个地方并运行它，仅供你参考

```
echo '<pre>';
print_r($_SESSION); 
```

此外，您看不到 Cookie，因为它们是会话 cookie，在客户端计算机上有 1 个引用，其余都在服务器的文件系统（如果未配置）上。

希望有帮助。

问题？

# report - 如何在运行报表时解密字段值并在 Salesforce 标准报表中显示它们？

> ID：12127348
> 
> 赞同：0
> 
> 时间：2012-08-26T03:14:27.350
> 
> 标签：report, salesforce, encryption

我有以下情况：

我有一个对象，它的一个字段包含实际值的加密值。现在，在运行 Salesforce 标准报告时，我想解密它们并在报告输出中显示实际值。我不知道是否可以在单击“运行报告”按钮后调用函数来解密加密值，然后解密它们和在报告输出中显示它们。

可能吗？
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T04:03:29.790

不，我不这么认为——我能想到的唯一可能的方法是：

1.  安排报表以具有`View Encrypted Data`权限的用户身份运行。
2.  使用`Apex`/ `Visualforce`( `OutputText`) 来呈现报告。

# angularjs - 使用自定义角度指令制作像 SO 上的铭牌

> ID：12127352
> 
> 赞同：0
> 
> 时间：2012-08-26T03:15:41.607
> 
> 标签：angularjs, directive

我有一个视图部分“nameplate.jade”，它具有从用户对象绑定的几个属性。在另一个页面上，我想查看用户名牌上的用户列表。所以我想做的是以某种方式发送用户或用户。_id 我将从我所在的任何控制器获得并让它渲染铭牌，然后继续渲染下一个，第一个持续存在。

我如何将它用于一个铭牌

```
div(ng-controller="LoginCtrl")
    div(ng-show="logged_in()")
        a(href="/profile/{{ currentUser.handle }}")
            nameplate(user="{{currentUser}}") 
```

如果我想要铭牌列表，我将如何使用它

```
div(ng-repeat="participant in event.participants")
    nameplate(userid="participant.userid") 
```

* * *

`nameplate.jade`

```
.nameplate

    .imageColumn
        .image
            img(src="{{ user.avatar }}")

    .otherColumn
        .nameRow
            a(ng-href="/profile/{{ user.handle }}") {{ user.handle }} 
```

`nameplate directive`

```
.directive('nameplate', (User) ->
        restrict: 'E'
        replace: true
        scope:
            user: '@currentuser'
            userid: '@userid'
        templateUrl: '/partials/nameplate'
        link: (scope, elems, attrs) ->
            # I've tried a lot of things that didn't work here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:53:04.887

我正在使用`user: '@currentuser'` ，但我应该一直在使用`user: '&currentuser'`

关键在我的指令的范围哈希中

```
.directive('nameplate', () ->
        restrict: 'E'
        replace: true
        scope:
            user: '&currentuser'
        templateUrl: '/partials/nameplate'
        link: (scope, elems, attrs) ->
            scope.$watch scope.user, (_user) ->
                scope.user = _user
    ) 
```

我试图获取 {{currentUser}}，但它一直在隔离范围内执行，并且在父范围的 currentUser 更改时没有更新。所以使用 'scope.$watch' 来监听值的变化并使用`&`而不是`@`解决我的问题

来自[Angularjs 指令指南](http://docs.angularjs.org/guide/directive)

> 范围 - 如果设置为：{}（对象哈希）
> 
> *   & 或 &attr - 提供一种在父作用域的上下文中执行表达式的方法

* * *

**编辑**

为了详细说明 Andy 在下面的评论，您可以将指令语法简化为：

```
.directive('nameplate', () ->
        restrict: 'E'
        replace: true
        scope:
            user: '=currentuser'
        templateUrl: '/partials/nameplate'
    ) 
```

对于我的用例，我什至不需要指定链接功能

# android - Android全屏不工作：姜饼

> ID：12127354
> 
> 赞同：0
> 
> 时间：2012-08-26T03:15:54.120
> 
> 标签：android, android-2.3-gingerbread

我正在尝试进行全屏活动，但它似乎在 GingerBread 中不起作用，这是我的代码

```
 @SuppressLint("NewApi")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_eyes);
   if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWICH){
    ActionBar actionBar = getActionBar();
    actionBar.hide();

}

   if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.GINGERBREAD){
       requestWindowFeature(Window.FEATURE_NO_TITLE);
       getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
   } 
```

在姜饼中仍然有一个标题。

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T04:05:28.380

首先，您应该在清单中将活动设置为全屏。在所需的活动中，添加此代码

```
android:theme="@android:style/Theme.NoTitleBar.Fullscreen" 
```

你的 onCreate 应该是这样的

```
if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.GINGERBREAD){
    requestWindowFeature(Window.FEATURE_NO_TITLE); 
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
}

setContentView(R.layout.main);

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWICH){
    ActionBar actionBar = getActionBar();
    actionBar.hide();

} 
```

这可能会解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T04:30:20.583

请记住，您必须先打电话`requestWindowFeature`再打电话`setContentView`

试试这个通过java进行全屏活动：

```
getWindow().addFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

并在清单中

```
android:theme="@android:style/Theme.Translucent.NoTitleBar" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T03:30:37.617

`requestWindowFeature`必须在之前调用`super.onCreate`。像这样：

```
@SuppressLint("NewApi")
@Override
public void onCreate(Bundle savedInstanceState) {

    if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.GINGERBREAD){
        requestWindowFeature(Window.FEATURE_NO_TITLE);
    }

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_eyes);
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWICH){
        ActionBar actionBar = getActionBar();
        actionBar.hide();
    }

    if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.GINGERBREAD){
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    }
    // ... 
```

如果这不起作用，请将`getWindow().setFlags(...)`调用也移到顶部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-18T02:39:20.330

是不是`android:theme ="@android:style/Theme.NoTitleBar.Fullscreen"`既隐藏了标题栏又隐藏了通知区域？

它等于：

```
getWindow().addFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN);
requestWindowFeature(Window.FEATURE_NO_TITLE); 
```

我从[https://github.com/pocorall/scaloid-apidemos/blob/master/src/main/java/com/example/android/apis/graphics/CameraPreview.java了解到这一点](https://github.com/pocorall/scaloid-apidemos/blob/master/src/main/java/com/example/android/apis/graphics/CameraPreview.java)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T08:11:02.420

除非您有理由不在清单中设置它，否则请将此属性添加到清单中的标记中：

```
<application
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
    .....
> 
```

而且我相信您不需要`onCreate()`.

# css - 带有 repeat-y 的背景图像不覆盖整个高度

> ID：12127362
> 
> 赞同：0
> 
> 时间：2012-08-26T03:17:50.867
> 
> 标签：css, background-image

我有以下 HTML： 带有颜色全高的侧边栏在颜色页面的左侧之外，所以我有一个图像来覆盖页面的左侧并达到全高，但在 chrome 中它不覆盖带有repeat-y的页面的全高；

我的 CSS：（在 chrome 中不起作用）

```
body {
    background: #000 url(../images/bar_bg.jpg) repeat-y;
}

#container {
    height: 100%;
} 
```

我想实现这一点： ![在此处输入图像描述](../Images/ab5308dc377955c24029ba4283e5817f.png)

是否有另一种方法可以在没有图像或使用 CSS3 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:36:21.603

您的 html 和 body 没有覆盖整个视口，请使用...

```
html, body {
  height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T03:25:29.227

我必须对代码做一些工作，但这听起来需要将边距高度设置为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T16:44:24.010

解决了

```
html, body{
min-height:100%;
height:auto;
} 
```

# c - 为什么这个“函数'X'的隐式声明”？

> ID：12127364
> 
> 赞同：17
> 
> 时间：2012-08-26T03:18:20.823
> 
> 标签：c, function, compiler-warnings

我编写了一个简单的程序来查找 3 个数字的总和、平均值、最大和最小数。它允许用户输入三个（整数）数字并返回总和、平均值、最大值和最小值。它没有错误，但有警告。这是我的源代码：

主.c：

```
#include <stdio.h>

int main()
{
    int num1, num2, num3, sum, max, min, avg;

    printf("Enter Three \"Integer\" Numbers:");

    scanf("%i%i%i", &num1, &num2, &num3);

    sum = summation(&num1, &num2, &num3);
    avg = average(&sum);
    max = max_val(&num1, &num2, &num3);
    min = min_val(&num1, &num2, &num3);

    printf("Sum: %i Avg: %i MAX: %i MIN: %i", sum, avg, max, min);

    return 0;
}

int summation(int *n1, int *n2, int *n3)
{
    int s;
    s = *n1 + *n2 + *n3;

    return s;
}

int average(int *s)
{
    int a;
    a = *s / 3;

    return a;
}

int max_val(int *n1, int *n2, int *n3)
{
    int MAX;

    if (*n1 > *n2) MAX = *n1;
    else if (*n2 > *n3) MAX = *n2;
    else MAX = *n3;

    return MAX;
}

int min_val(int *n1, int *n2, int *n3)
{
    int MIN;

    if (*n1 < *n2) MIN = *n1;
    else if (*n2 < *n3) MIN = *n2;
    else MIN = *n3;

    return MIN;
} 
```

我认为不需要制作头文件，因为所有函数都是“int”类型。

当我编译这个

```
gcc main.c -o test 
```

它说

```
main.c: In function 'main':
main.c:34:5: warning: implicit declaration of function 'summation' [-Wimplicit-function-declaration] 
```

为什么这个警告？我在那个声明中找不到任何错误。那是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-26T03:19:50.343

`summation`并且您的其他函数是在使用*后*`main`定义的，因此编译器已经猜测了它的签名；换句话说，已经假定了一个*隐式声明。*

您应该在使用该函数之前声明它并消除警告。在 C99 规范中，这是一个错误。

*要么在之前* 移动函数体`main`，要么在 之前包含方法签名`main`，例如：

```
#include <stdio.h>

int summation(int *, int *, int *);

int main()
{
    // ... 
```

# javascript - BackboneJS - 监听嵌套模型的变化

> ID：12127367
> 
> 赞同：1
> 
> 时间：2012-08-26T03:18:50.980
> 
> 标签：javascript, backbone.js

**简短版本**：我有一个 Backbone 模型，它的属性之一是第二个 Backbone 模型。第一个模型中的一个函数改变了第二个模型的状态，但是我的视图，它正在监听第一个模型的变化，似乎没有得到第二个模型的状态，尽管有任何数量的日志记录表明不是这样（我一直 `this`在各个点登录以确认范围等）。我怎样才能解决这个问题？

**长版**：我有一个 Backbone 模型`Course`，它代表一门学术课程，还有一个模型`NameList`，它代表一个`Course`. 一个`Course`“有” `NameList`。A`NameList`由服务器上的单个文本文件支持。

我想在`Course`模型中调用一个函数，该函数`importNameList`创建一个新`NameList`模型并导致该`NameList`模型`fetch`及其来自后端的数据。由于我的观点`CourseView`是监听模型的变化`Course`，并且`Course`模型 has-a `NameList`，看起来这应该相应地更新视图。我的问题是它没有。

**我想做的事**

```
var course = new Course();
var courseView = new CourseView({model : course});
courseView.model.importNameList('students.txt'); // Will cause view to re-render 
```

**我必须做什么**

```
var course = new Course(); // same 
var courseView = new CourseView({model : course}); // same
courseView.model.importNameList('students.txt'); // same
courseView.render(); // Argh, manually calling this is ugly. 
```

这是我的带有日志记录语句的代码。模型扩展`Backbone.DeepModel`只是因为我认为它可以解决我的问题，但它没有。

**控制台输出**

```
[console] var course = new Course();
[console] var courseView = new CourseView({model : course});
[console] course.importNameList('students.txt');

          Course >>> importNameList
          NameList >>> initialize()
          NameList >>> fetch()
          GET http://localhost/files/students.txt 200 OK 16ms    
          CourseView >>> render() // Render starts before fetch completes
          CourseView <<< render() // Render finishes before fetch completes
          Course <<< importNameList
          NameList <<< fetch()

[console] courseView.render();

          CourseView >>> render()
          alice
          bob
          charlie
          dan
          erica
          fred
          george
          CourseView <<< render() 
```

**课程.js**

```
var Course = Backbone.DeepModel.extend({

    defaults : {
        nameList : new NameList()
    },

    initialize: function(options) {

        if (options && options.nameList) {
            this.set({nameList : options.nameList});
        }

    },

    importNameList : function(fileName) {

        console.log("Course >>> importNameList");
        var nameList = new NameList({fileName : fileName});
        this.set({nameList : nameList});
        console.log("Course <<< importNameList");
    }
}); 
```

**名称列表.js**

```
var NameList = Backbone.DeepModel.extend({

    defaults : {
        fileName : 'new.txt',
        names : []
    },

    initialize: function(options) {

        console.log("NameList >>> initialize()");
        var model = this;

        if (options && options.fileName) {
            model.set({fileName : options.fileName});
        }
        model.fetch();
    },

    fetch : function() {
        console.log("NameList >>> fetch()");
        var model = this;
        $.ajax({
            url : '/files/' + model.get('fileName'),
            success : function(response) {
                model.set({names : response.split('\n')});
                console.log("NameList <<< fetch()");
            }
        });
    }
}); 
```

**CourseView.js**

```
var CourseView = Backbone.View.extend({

    initialize : function(options) {

        var view = this;
        if (options && options.model) {
            view.model = options.model;
        } else {
            view.model = new Course();
        }

        view.model.on('change', function() {
            view.render();
        });

    },

    render : function() {

        console.log("CourseView >>> render()");
        var names = this.model.get('nameList').get('names');
        for (var i = 0; i < names.length; i++) {
            console.log(names[i]);
        }
        console.log("CourseView <<< render()");
        return this;
    }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T03:36:57.327

快速的答案是使用 jQuery 一个[`deferred`](http://api.jquery.com/category/deferred-object/)对象。[您可以在本文](http://lostechies.com/derickbailey/2012/02/07/rewriting-my-guaranteed-callbacks-code-with-jquery-deferred/)中找到更多关于将延迟与主干.js 结合使用的信息。

我会添加更具体的信息，但我不太清楚你为什么要覆盖 fetch，这似乎是灾难的根源。我会坚持使用主干的原始 fetch 方法，并将其从 NameList 的初始化程序中删除，而是从 Course.js 调用它，并使用从它返回的 deferred 来保证在 fetch 完成后运行之后的步骤。

**更新：**

这是您可以执行此操作的一种方法的草图。首先从 的方法中取出这一`model.fetch();`行，然后在 中调用它，使用它的返回值（一个延迟对象）作为 的返回值：`initialize``NameList``importNameList``importNameList`

```
var nameList = new NameList({fileName : fileName});
this.set({nameList : nameList});
return nameList.fetch() 
```

现在我们返回了一个 deferred from `importNameList`，我们可以使用它来保证在渲染之前获取是完整的：

```
this.deferred = courseView.model.importNameList('students.txt');
this.deferred.done(function() { courseView.render() }); 
```

我认为这应该做你想要的，虽然我还没有实际测试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T02:51:06.233

我最终做了以下事情。

**CourseView.js：**

```
// No changes. 
```

**在 Course.js 中：**

```
importNameList : function(name) {

    var model = this;
    var nameList = new NameList({fileName : fileName});
    // Set the attribute silently (without triggering a change event)
    model.set({nameList : nameList}, {silent: true});
    nameList.fetch({
        success : function() {
            model.change(); // Manually fire a change event when fetch completes.
        }
    });
} 
```

**在 NameList.js 中：**

```
fetch : function(options) {
    var model = this;
    $.ajax({
        url : '/files/' + model.get('fileName'),
        success : function(response) {
            model.set({lines : response.split('\n')});
            // Make the "success" callback.
            options.success();
        }
    });
} 
```

# import - 如何在 VS 2012 中将 localdb 导入 SSDT 项目

> ID：12127369
> 
> 赞同：1
> 
> 时间：2012-08-26T03:19:16.537
> 
> 标签：import, localdb, sql-server-data-tools

我正在使用 Visual Studio 2012 高级版。我有一个 MVC 4 互联网项目。我在 app_data 文件夹中添加了一个 localdb sql server 数据库文件。一切正常。

我添加了一个新的 SSDT 数据库项目。我尝试将 localdb 导入数据库项目，但无法正常工作。首先，它在我的网络配置中看不到数据库连接字符串。所以我点击创建新连接，然后点击高级设置。对于我输入的服务器 (LocalDB)\v11.0，然后我附加 db 文件并键入逻辑名称的文件名。我测试了连接，它通过了。

现在我点击开始，我得到一个对话框，告诉我“不支持服务器版本或数据库兼容级别”

是否可以将 localdb 数据库导入 SSDT 项目？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T14:55:21.770

您应该使用 localDB 数据库来创建项目，而不是创建 SSDT 项目然后导入。打开 SQL Server 对象资源管理器 (SSOX)，右键单击 localDB 中的数据库（您可能需要添加服务器 (LocalDB)/v11.0 ），然后创建新项目。

# php - MediaWiki + Graphviz + 图片地图 + 页面链接

> ID：12127371
> 
> 赞同：6
> 
> 时间：2012-08-26T03:19:38.170
> 
> 标签：php, xpath, mediawiki, graphviz

**背景**：在 WAMP 堆栈上使用 MediaWiki 1.19.1、Graphviz 2.28.0、Extension:GraphViz 0.9（Server 2008、Apache 2.4.2、MySQL 5.5.27、PHP 5.4.5）。对于使用 MediaWiki 中的 GraphViz 扩展从 Graphviz 图中呈现可点击图像的基本功能，一切都运行良好，并且符合预期。

**问题**：图像映射中的链接未添加到 MediaWiki 页面链接表中。我明白为什么不添加它们，但如果无法使用“这里有什么链接”功能来跟踪链接，这将成为一个问题。

**所需的解决方案**：在处理 GraphViz 扩展中的图表期间，我想使用生成的 .map 文件然后创建一个 wikilinks 列表以添加到页面上，以便被 MediaWiki 拾取并添加到 pagelinks 表中。

**详细信息**：此 GraphViz 扩展代码：

```
<graphviz border='frame' format='png'>
digraph example1 {
  // define nodes
  nodeHello [
    label="I say Hello", 
    URL="Hello"
  ]
  nodeWorld [
    label="You say World!",
    URL="World"
  ]
  // link nodes
  nodeHello -> nodeWorld!
}
</graphviz> 
```

生成此图像：

![你好世界graphviz图](../Images/428717634210a5cc755427f31bd7b29e.png)

并且此图像映射代码在服务器上相应的 .map 文件中：

```
<map id="example1" name="example1">
<area shape="poly" id="node1" href="Hello" title="I say Hello" alt="" coords="164,29,161,22,151,15,137,10,118,7,97,5,77,7,58,10,43,15,34,22,31,29,34,37,43,43,58,49,77,52,97,53,118,52,137,49,151,43,161,37"/>
<area shape="poly" id="node2" href="World" title="You say World!" alt="" coords="190,125,186,118,172,111,152,106,126,103,97,101,69,103,43,106,22,111,9,118,5,125,9,133,22,139,43,145,69,148,97,149,126,148,152,145,172,139,186,133"/>
</map> 
```

从该图像映射文件中，我希望能够提取 href 和标题来构建 wikilinks，如下所示：

```
[[Hello|I say Hello]]
[[World|You say World!]] 
```

我猜想，因为那个 .map 文件本质上是 XML，所以我可以使用 XPATH 来查询文件，但这只是一个猜测。PHP 不是我最擅长的领域，我不知道使用 XML/XPATH 选项的最佳方法，或者这是否是从文件中提取该信息的最佳方法。

一旦我从 .map 文件中获得了维基链接的集合/数组，我确信我可以破解 GraphViz.php 扩展文件，将其添加到页面的内容中，从而将其添加到页面链接表中。

**进展**：当我提交问题时，我有一点[解决问题的橡皮鸭问题。](http://www.codinghorror.com/blog/2012/03/rubber-duck-problem-solving.html)我意识到，由于我在图像映射中具有格式良好的数据，因此 XPATH 可能是要走的路。能够提取我需要的数据是相当微不足道的，特别是因为我发现地图文件内容仍然存储在本地字符串变量中。

```
$xml = new SimpleXMLElement( $map );
foreach($xml->area as $item) {
  $links .= "[[" . $item->attributes()->href . "|" . $item->attributes()->title . "]]";
} 
```

**最终解决方案**：请参阅下面我接受的答案。谢谢参观。感谢您提供的任何帮助或指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:04:19.927

我终于解决了所有问题，现在有了一个相当不错的解决方案来很好地渲染图形，提供链接列表，并在 wiki 中注册链接。我的解决方案不完全支持当前 GraphViz 扩展的所有功能，因为它是编写的，因为有我们不需要且我不想支持的功能。以下是此解决方案的假设/限制：

*   不支持MscGen：我们只需要Graphviz。
*   不支持 imageAttributes：我们想要控制格式和表示，看起来 imageAttributes 实现中存在不一致，这会导致进一步的支持问题。
*   不支持 wikilinks：虽然通过 wiki 和 Graphviz 扩展提供一致的链接使用会很好，但现实情况是 Graphviz 是一个完全不同的标记环境。虽然当前的扩展“支持”wikilinks，但实现有点薄弱，留下了混乱的地方。示例：Wikilinks 支持为链接提供可选描述，但 Graphviz 已经使用节点标签进行描述。因此，您最终会忽略 wikilink 描述并告诉用户“是的，我们支持 wikilinks 但不使用描述部分”因此，由于我们并没有真正正确使用 wikilinks，因此只需实现常规链接实现并尽量避免完全混乱。

这是输出的样子： ![Wiki Graphviz 增强功能](../Images/f1b5c88f0bd0f997a8747534dfa8c7c0.png)

以下是所做的更改

注释掉这一行：

```
// We don't want to support wikilinks so don't replace them
//$timelinesrc = rewriteWikiUrls( $timelinesrc ); // if we use wiki-links we transform them to real urls 
```

替换此代码块：

```
// clean up map-name
$map  = preg_replace( '#<ma(.*)>#', ' ', $map );
$map  = str_replace( '</map>', '', $map );
if ( $renderer == 'mscgen' ) {
    $mapbefore = $map;
    $map = preg_replace( '/(\w+)\s([_:%#/\w]+)\s(\d+,\d+)\s(\d+,\d+)/',
   '<area shape="$1" href="$2" title="$2" alt="$2" coords="$3,$4" />',
    $map );
}

/* Procduce html
 */
if ( $wgGraphVizSettings->imageFormatting )
{
    $txt = imageAtrributes( $args, $storagename, $map, $outputType, $wgUploadPath ); // if we want borders/position/...
} else {
    $txt  = '<map name="' . $storagename . '">' . $map . '</map>' .
         '<img src="' . $wgUploadPath . '/graphviz/' . $storagename . '.' . $outputType . '"' .
                   ' usemap="#' . $storagename . '" />';
} 
```

使用此代码：

```
$intHtml = '';
$extHtml = '';
$badHtml = '';

// Wrap the map/area info with top level nodes and load into xml object
$xmlObj = new SimpleXMLElement( $map );

// What does map look like before we start working with it?
wfDebugLog( 'graphviz', 'map before: ' . $map . "\n" );

// loop through each of the <area> nodes
foreach($xmlObj->area as $areaNode) {

    wfDebugLog( 'graphviz', "areaNode: " . $areaNode->asXML() . "\n" );

    // Get the data from the XML attributes
    $hrefValue = (string)$areaNode->attributes()->href;
    $textValue = (string)$areaNode->attributes()->title;

    wfDebugLog( 'graphviz', '$hrefValue before: ' . $hrefValue . "\n" );
    wfDebugLog( 'graphviz', '$textValue before: ' . $textValue . "\n" );

    // For the text fields, multiple spaces ("   ") in the Graphviz source (label)
    // turns into a regular space followed by encoded representations of
    // non-breaking spaces (" &#xA0;&#xA0;") in the .map file which then turns
    // into the following in the local variables: (" Â Â ").
    // The following two options appear to convert/decode the characters
    // appropriately. Leaving the lines commented out for now, as we have
    // not seen a graph in the wild with multiple spaces in the label -
    // just happened to stumble on the scenario.
    // See http://www.php.net/manual/en/simplexmlelement.asxml.php
    // and http://stackoverflow.com/questions/2050723/how-can-i-preg-replace-special-character-like-pret-a-porter
    //$textValue = iconv("UTF-8", "ASCII//TRANSLIT", $textValue);
    //$textValue = html_entity_decode($textValue, ENT_NOQUOTES, 'UTF-8');

    // Now we need to deal with the whitespace characters like tabs and newlines
    // and also deal with them correctly to replace multiple occurences.
    // Unfortunately, the \n and \t values in the variable aren't actually
    // tab or newline characters but literal characters '\' + 't' or '\' + 'n'.
    // So the normally recommended regex '/\s+/u' to replace the whitespace 
    // characters does not work.
    // See http://stackoverflow.com/questions/6579636/preg-replace-n-in-string
    $hrefValue = preg_replace("/( |\\\\n|\\\\t)+/", ' ', $hrefValue);
    $textValue = preg_replace("/( |\\\\n|\\\\t)+/", ' ', $textValue);

    // check to see if the url matches any of the
    // allowed protocols for external links
    if ( preg_match( '/^(?:' . wfUrlProtocols() . ')/', $hrefValue ) ) {
        // external link
        $parser->mOutput->addExternalLink( $hrefValue );
        $extHtml .= Linker::makeExternalLink( $hrefValue, $textValue ) . ', ';
    }
    else {
        $first = substr( $hrefValue, 0, 1 );
        if ( $first == '\\' || $first == '[' || $first == '/' ) {
            // potential UNC path, wikilink, absolute or relative path
            $hrefValue = '#InvalidLink';
            $badHtml .= Linker::makeExternalLink( $hrefValue, $textValue ) . ', ';
            $textValue = 'Invalid link. Check Graphviz source.';
        }
        else {
            $title = Title::newFromText( $hrefValue );
            if ( is_null( $title ) ) {
                // invalid link
                $hrefValue = '#InvalidLink';
                $badHtml .= Linker::makeExternalLink( $hrefValue, $textValue ) . ', ';
                $textValue = 'Invalid link. Check Graphviz source.';
            }
            else {
                // internal link
                $parser->mOutput->addLink( $title );
                $intHtml .= Linker::link( $title, $textValue ) . ', ';
                $hrefValue = $title->getFullURL();
            }
        }
    }

    $areaNode->attributes()->href = $hrefValue;
    $areaNode->attributes()->title = $textValue;

}

$map = $xmlObj->asXML();

// The contents of $map, which is now XML, gets embedded
// in the HTML sent to the browser so we need to strip
// the XML version tag and we also strip the <map> because
// it will get replaced with a new one with the correct name.
$map = str_replace( '<?xml version="1.0"?>', '', $map );
$map = preg_replace( '#<ma(.*)>#', ' ', $map );
$map = str_replace( '</map>', '', $map );

// Let's see what it looks like now that we are done with it.
wfDebugLog( 'graphviz', 'map after: ' . $map . "\n" );

$txt = '' .
    '<table style="background-color:#f9f9f9;border:1px solid #ddd;">' .
        '<tr>' .
            '<td style="border:1px solid #ddd;text-align:center;">' .
                '<map name="' . $storagename . '">' . $map . '</map>' .
                '<img src="' . $wgUploadPath . '/graphviz/' . $storagename . '.' . $outputType . '"' . ' usemap="#' . $storagename . '" />' .
            '</td>' .
        '</tr>' .
        '<tr>' .
            '<td style="font:10px verdana;">' .
                'This Graphviz diagram links to the following pages:' .
                '<br /><strong>Internal</strong>: ' . ( $intHtml != '' ?  rtrim( $intHtml, ' ,' ) : '<em>none</em>' ) .
                '<br /><strong>External</strong>: ' . ( $extHtml != '' ?  rtrim( $extHtml, ' ,' ) : '<em>none</em>' ) .
                ( $badHtml != '' ? '<br /><strong>Invalid</strong>: ' . rtrim($badHtml, ' ,') .
                '<br /><em>Tip: Do not use wikilinks ([]), UNC paths (\\) or relative links (/) when creating links in Graphviz diagrams.</em>' : '' ) .
            '</td>' .
        '</tr>' .
    '</table>'; 
```

可能的增强功能：

*   如果图表下方的链接列表经过排序和重复数据删除，那就太好了。

# php - 正则表达式在句点后添加空格，但当句点表示小数或字母缩写时不添加空格？

> ID：12127372
> 
> 赞同：2
> 
> 时间：2012-08-26T03:19:47.853
> 
> 标签：php, punctuation, abbreviation

以简单的方式使用 php 正则表达式，是否可以修改字符串以在单词后面的句点之后添加空格，但不能在前后跟数字（例如 1.00）的句点之后添加空格？我还需要它来忽略单字母缩写，例如 NY

```
String.Looks like this.With an amount of 1.00 and references N.Y. 
```

需要改成...

```
String. Looks like this. With an amount of 1.00 and references N.Y. 
```

这当然应该允许字符串中的多个实例......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T03:25:15.923

```
$text = preg_replace('/(\.)([[:alpha:]]{2,})/', '$1 $2', $text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T03:31:04.843

您可以使用此正则表达式：

```
/((?<=[A-Za-z0-9])\.(?=[A-Za-z]{2})|(?<=[A-Za-z]{2})\.(?=[A-Za-z0-9]))/ 
```

替换字符串是`'. '`.

请注意，上面的正则表达式在句号的一侧至少需要一个字母字符`.`，而在另一侧则需要字母数字字符。

测试字符串：

```
"String.Looks like this.With an amount of 1.00 and references N.Y.Mr.NoOne.30% replaced.no 50.Don't know." 
```

输出：

```
"String. Looks like this. With an amount of 1.00 and references N.Y. Mr. NoOne. 30% replaced. no 50\. Don't know." 
```

# c# - Microsoft Excel 2.0 版提供程序

> ID：12127375
> 
> 赞同：1
> 
> 时间：2012-08-26T03:20:22.670
> 
> 标签：c#, excel

FoxPro 中有这样的命令：

“复制到[路径] [条件] xls”将数据从 FoxPro DBF 导出到 Microsoft Excel。在这种情况下，excel 版本是 2.0。

问题：我想用 C# 读取这个导出的 excel 文件。所以我尝试使用这个提供程序：

```
Provider=Microsoft.ACE.OLEDB.12.0 
```

有了这个属性：

```
Extended Properties=Excel 8.0;HDR=Yes;IMEX=1; 
```

或者

```
Extended Properties=Excel 12.0;HDR=Yes;IMEX=1; 
```

但他们没有工作（我发现了这个错误）：

```
External table is not in the expected format. 
```

有没有办法在 C# 中读取 Microsoft Excel 2.0 文件？我需要一个提供程序来读取它，例如作为 DataTable 读取，我不使用 VSTO 读取它！

PS：Microsoft Excel 97（及更高版本）很容易正确显示此导出文件。我不知道为什么我无法使用 C# 和 Microsoft Excel Providers for C# 读取它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:45:35.780

Excel 2.0 是一种相当陈旧的文件格式，但您应该能够使用这样的通用 ODBC 连接字符串：

```
DRIVER={Microsoft Excel Driver (*.xls)};IMEX=1;MaxScanRows=16;DBQ=C:\MyExcelFile.xls;

// then use a query like
SELECT * FROM [Sheet1$] 
```

如果这不起作用，您可能会使用[CodePlex 上的 Excel Data Reader](http://exceldatareader.codeplex.com/)等托管库获得更大的成功。

也许发布代码副本和 Excel 文件的屏幕截图，因为有时很难排除故障。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T14:56:37.020

是否可以将您的 Foxpro 代码更改为：

```
COPY TO [yourpath\yourfile.csv] TYPE DELIMITED 
```

或者

```
COPY TO [yourpath\yourfile.xls] TYPE XL5 
```

您应该能够读取这些文件类型。

# c++ - RegisterWaitForSingleObject 未声明（首次使用此函数）

> ID：12127376
> 
> 赞同：0
> 
> 时间：2012-08-26T03:20:34.527
> 
> 标签：c++, boost-asio, dev-c++

好的，过去一周我一直在尝试在 Google 上找到解决方案并搜索多个编码站点，包括以下链接：

[http://boost.2283326.n4.nabble.com/boost-asio-UnregisterWaitEx-RegisterWaitForSingleObject-has-not-been-declared-td4633963.html](http://boost.2283326.n4.nabble.com/boost-asio-UnregisterWaitEx-RegisterWaitForSingleObject-has-not-been-declared-td4633963.html)

这就是我知道如何使用

```
-D_WIN32_WINNT=0x0601 -DWINVER=0x0601 
```

在编译行中。

我正在使用带有 Dev-C++ 的 Windows 7（64 位），每次编译 Boost:Asio 示例时都会出现以下错误：

```
Compiler: Default compiler
Building Makefile: "D:\Tutorials\Asio\Makefile.win"
Executing  make...
make.exe -f "D:\Tutorials\Asio\Makefile.win" all
g++.exe -c main.cpp -o main.o -I"D:/Programs/Dev-Cpp/lib/gcc/mingw32/3.4.2/include"  -I"D:/Programs/Dev-Cpp/include/c++/3.4.2/backward"  -I"D:/Programs/Dev-Cpp/include/c++/3.4.2/mingw32"  -I"D:/Programs/Dev-Cpp/include/c++/3.4.2"  -I"D:/Programs/Dev-Cpp/include"  -D_WIN32_WINNT=0x0601 -DWINVER=0x0601 -lboost_system-mgw44-mt-1_49  

In file included from D:/Programs/Dev-Cpp/include/boost/asio/detail/win_object_handle_service.hpp:180,
                 from D:/Programs/Dev-Cpp/include/boost/asio/windows/object_handle_service.hpp:24,
                 from D:/Programs/Dev-Cpp/include/boost/asio/windows/basic_object_handle.hpp:27,
                 from D:/Programs/Dev-Cpp/include/boost/asio.hpp:99,
                 from main.cpp:3:
D:/Programs/Dev-Cpp/include/boost/asio/detail/impl/win_object_handle_service.ipp: In member function `void boost::asio::detail::win_object_handle_service::register_wait_callback(boost::asio::detail::win_object_handle_service::implementation_type&, boost::asio::detail::scoped_lock<boost::asio::detail::win_mutex>&)':
D:/Programs/Dev-Cpp/include/boost/asio/detail/impl/win_object_handle_service.ipp:376: error: `RegisterWaitForSingleObject' undeclared (first use this function)
D:/Programs/Dev-Cpp/include/boost/asio/detail/impl/win_object_handle_service.ipp:376: error: (Each undeclared identifier is reported only once for each function it appears in.)

D:/Programs/Dev-Cpp/include/boost/asio/detail/impl/win_object_handle_service.ipp: In static member function `static void boost::asio::detail::win_object_handle_service::wait_callback(void*, BOOLEAN)':
D:/Programs/Dev-Cpp/include/boost/asio/detail/impl/win_object_handle_service.ipp:418: error: `RegisterWaitForSingleObject' undeclared (first use this function)

make.exe: *** [main.o] Error 1

Execution terminated 
```

我的代码如下：

```
#define _WIN32_WINNT 0x0601
#define __USE_W32_SOCKETS
#include <boost/asio.hpp>
#include <iostream>

int main()
{
    // Cre'ation du service principal et du re'solveur.
    boost::asio::io_service ios;
    boost::asio::ip::tcp::resolver resolver(ios);   // (1)              

    // Parame`trage du resolver sur Developpez.com
    boost::asio::ip::tcp::resolver::query query("www.developpez.com", "80"); // (2)

    // On re'cupe`re une "liste" d'ite'rateur
    boost::asio::ip::tcp::resolver::iterator iter = resolver.resolve(query); // (3)
    boost::asio::ip::tcp::resolver::iterator end; //Marqueur de fin
    while (iter != end) // On ite`re le long des endpoints
    {
        boost::asio::ip::tcp::endpoint endpoint = *iter++;
        std::cout << endpoint << std::endl; // on affiche (4)
    }

    return 0;
 } 
```

考虑到代码本身没有给出错误，这没关系。这只是我一直在使用的五个教程之一，这些教程给了我与 Boost:Asio 相同的、确切的错误。

已经给出了一些建议，例如在链接器中使用“-lwsock32”，在编译器中也使用“-lboost_system-mgw44-mt-1_49”，但这并没有做任何事情。按照建议添加“-D_WIN32_WINNT=0x0601 -DWINVER=0x0601”消除了一些错误，但这就是我所得到的。

我非常认真地在我的程序中实施 Boost:Asio，所以如果我能得到一个工作示例，我可以从各种资源中更好地理解它并按预期使用它。因此，请不要给我任何关于“把它留给专业人士”或“学习编程”的信息，因为我在其他论坛上一次又一次地看到有人就这个错误寻求帮助。即使我知道如何编程，但在使用我不熟悉的库时仍然会遇到这样的错误。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T03:40:22.757

添加

```
#include <windows.h> 
```

到你的文件顶部，就在你`#define`的 s. 看起来好像 Boost 正在使用一个没有包含 windows.h 的 win32 函数。

# php - 密码哈希、登录时更新 Salt 和哈希以及 PHPass

> ID：12127382
> 
> 赞同：1
> 
> 时间：2012-08-26T03:22:50.307
> 
> 标签：php, hash, passwords, salt, phpass

我记得读过一个方案，其中检查密码的过程是这样的：

1.  在数据库中给定（哈希，盐），
2.  带盐的哈希密码以检查哈希，
3.  *以旧哈希为 salt 的*哈希密码，
4.  在数据库中存储（新哈希，盐*又名旧哈希*）。

我找不到原始来源。无论如何，我不明白

1.  使用旧哈希作为盐有什么好处（而不是使用随机盐），

2.  该方案的总体优势是什么（使彩虹表攻击更加复杂？），以及

3.  如果有*优势*，人们将如何使用 PHPass 应用该方案，因为盐似乎是在“内部”PHPass 中管理的......

直觉上，我认为这个方案充其量不会做任何事情，或者在最坏的情况下*会恶化*安全性（由于对过去值的依赖），但密码安全性是我不相信我的直觉的一个领域。请赐教。

**编辑：**

我问的是在每张支票上重新散列密码。这些类似的问题确实回答了第一个问题——使用哈希作为盐是没有用的——但不是在每次检查时重新哈希是否有用：

*   [使用数据哈希作为盐](https://stackoverflow.com/questions/2029869/using-a-hash-of-data-as-a-salt)
*   [使用您正在散列的散列作为盐的散列？](https://stackoverflow.com/questions/1120381/using-a-hash-of-what-you-are-hashing-as-a-salt)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:56:41.170

我不是安全专家，但回答 #1 没有任何优势。它所做的只是使事情进一步复杂化。

只需使用一个好的随机生成的盐，就像你说的，PHPPass 在内部处理它，并且 PHPPass 被认为是一个非常好的工具，因为它已经被许多安全专家审查过。

# jsf - primefaces 3.3.1 数据表多项选择不起作用

> ID：12127386
> 
> 赞同：1
> 
> 时间：2012-08-26T03:23:29.883
> 
> 标签：jsf, datatable, primefaces

我在我的应用程序中使用prime faces数据表，我在数据表中有一个复选框列来选择某些行并将值发送到回bean但它总是传递空值，任何人都可以建议我的代码有什么问题

```
 <p:dataTable id="tblStatusSearch" var="item"
      selection="#{StatusAction.listBEeans}" 
        value="#{bondLocationStatusAction.listLocationEBeans}"
     rowKey="#{item.LocationId}">
         <p:column selectionMode="multiple"/> 
```

背豆：

```
private List<LocationEBean> listBEeans;

public List<LocationEBean> getListBEeans() {
    return listBEeans;
}

public void setListBEeans(List<LocationEBean> listBEeans) {
    this.listBEeans = listBEeans;
}
public void ReSend(){

  listBEeans=new ArrayList<LocationEBean>();
  System.out.println("listBEans:"+listBEeans);
  msgProcBusServ.reSendMsg(listBEeans); 
```

}

错误日志

```
INFO: java.lang.NullPointerException
java.lang.NullPointerException
    at java.lang.reflect.Array.newArray(Native Method)
    at java.lang.reflect.Array.newInstance(Array.java:52)
    at org.primefaces.component.datatable.DataHelper.decodeMultipleSelection(DataHelper.java:268)
    at org.primefaces.component.datatable.DataHelper.decodeSelection(DataHelper.java:240)
    at org.primefaces.component.datatable.DataTableRenderer.decode(DataTableRenderer.java:72)
    at javax.faces.component.UIComponentBase.decode(UIComponentBase.java:787)
    at javax.faces.component.UIData.processDecodes(UIData.java:1162)
    at org.primefaces.component.datatable.DataTable.processDecodes(DataTable.java:554)
    at com.sun.faces.context.PartialViewContextImpl$PhaseAwareVisitCallback.visit(PartialViewContextImpl.java:506)
    at com.sun.faces.component.visit.PartialVisitContext.invokeVisitCallback(PartialVisitContext.java:183)
    at javax.faces.component.UIData.visitTree(UIData.java:1411)
    at javax.faces.component.UIComponent.visitTree(UIComponent.java:1623)
    at javax.faces.component.UIForm.visitTree(UIForm.java:371)
    at javax.faces.component.UIComponent.visitTree(UIComponent.java:1623)
    at javax.faces.component.UIComponent.visitTree(UIComponent.java:1623)
    at com.sun.faces.context.PartialViewContextImpl.processComponents(PartialViewContextImpl.java:376)
    at com.sun.faces.context.PartialViewContextImpl.processPartial(PartialViewContextImpl.java:252)
    at javax.faces.context.PartialViewContextWrapper.processPartial(PartialViewContextWrapper.java:183)
    at javax.faces.context.PartialViewContextWrapper.processPartial(PartialViewContextWrapper.java:183)
    at org.openfaces.ajax.PartialViewContext.processPartial(PartialViewContext.java:131)
    at javax.faces.context.PartialViewContextWrapper.processPartial(PartialViewContextWrapper.java:183)
    at javax.faces.component.UIViewRoot.processDecodes(UIViewRoot.java:931)
    at com.sun.faces.lifecycle.ApplyRequestValuesPhase.execute(ApplyRequestValuesPhase.java:78)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.myfaces.webapp.filter.ExtensionsFilter.doFilter(ExtensionsFilter.java:349)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:66 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T08:15:57.347

INMO`selection`应该指向一个数组而不是数组列表

尝试制作`listBEean`这样的数组

```
private LocationEBean[] listBEeans; 
```

看看展示柜

[DataTable - 多行选择](http://www.primefaces.org/showcase/ui/datatableRowSelectionMultiple.jsf)

# mysql - 如何改进这个庞大的 SQL 查询？

> ID：12127388
> 
> 赞同：-1
> 
> 时间：2012-08-26T03:24:22.477
> 
> 标签：mysql, sql

我有一个很慢的大型 SQL 查询（对于 MySQL）。它是两个 select 语句的联合。我尝试了不同的方法，但任何细微的差异都会给我带来与原始结果不同的结果。任何改进它的帮助将不胜感激。谢谢。这是SQL：

```
 (SELECT  
            CONCAT(city_name,', ',region) value, 
            latitude,
            longitude,
            id,
            population,
    ( 3959 * acos( cos( radians($latitude) ) * cos( radians( latitude ) ) * cos( radians( longitude ) - radians($longitude) ) + sin( radians($latitude) ) * sin( radians( latitude ) ) ) ) 
    AS distance,
    CASE region
    WHEN '$region' THEN 1
    ELSE 0
    END AS region_match
    FROM `cities` 
    $where and foo_count > 5
    ORDER BY region_match desc, foo_count desc
    limit 0, 11)
    UNION
    (SELECT   
            CONCAT(city_name,', ',region) value, 
            latitude,
            longitude,
            id,
            population,
    ( 3959 * acos( cos( radians($latitude) ) * cos( radians( latitude ) ) * cos( radians( longitude ) - radians($longitude) ) + sin( radians($latitude) ) * sin( radians( latitude ) ) ) ) 
    AS distance,
    CASE region
    WHEN '$region' THEN 1
    ELSE 0
    END AS region_match
    FROM `cities` 
    $where
    ORDER BY region_match desc, population desc, distance asc
    limit 0, 11)
    limit  0, 11 
```

SQL 确实采用了一些插值（以美元符号 ($) 为前缀）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:45:46.667

以下*可能会*给出相同的结果（我不确定如何在 SQL 中调用最大/最小函数，但您应该知道——您需要两个从 foo_count 派生的字段，它们将您的第一部分的项目分开UNION 与第二部分的 UNION 并允许在第一部分中排序而不会干扰第二部分中的顺序）——当然，您稍后需要第二个查询来再次抛出附加字段：

```
SELECT   
            CONCAT(city_name,', ',region) value,  
            latitude, 
            longitude, 
            id, 
            population, 
    ( 3959 * acos( cos( radians($latitude) ) * cos( radians( latitude ) ) * cos( radians( longitude ) - radians($longitude) ) + sin( radians($latitude) ) * sin( radians( latitude ) ) ) )  
    AS distance,
    min ( 6, max (foo_count, 5)) AS group_discriminator,
    max ( 6, foo_count) AS rank_for_use_in_first_group,
    CASE region 
    WHEN '$region' THEN 1 
    ELSE 0 
    END AS region_match 
    FROM `cities`  
    $where
    ORDER BY group_discriminator desc, region_match desc, rank_for_use_in_first_group desc, population desc, distance asc
    limit 0, 11 
```

编辑：改进

# javascript - 使用javascript查找今天日期的第四个星期五

> ID：12127389
> 
> 赞同：2
> 
> 时间：2012-08-26T03:24:32.463
> 
> 标签：javascript, date

我一直在尝试制作一份用于工作的快速参考表，并一直以此作为开始尝试学习 JavaScript 的一种方式。我一直不知道如何在 dd/mm/yyyy 中显示当前日期的第四个星期五（或任何一天）的日期。如果有人能指出我正确的方向，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:35:41.623

这个想法是使用 setDate() 来添加日期。以下代码应将您设置在那里：

```
<html>
<script>

// You might want to make a function out of this, btw.

dayWeWant = 5; // Friday 
today = new Date();

// So you want the fourth friday, eh?

// remember friday is 5 for getDay

if (today.getDay() < dayWeWant)  {  nextFri =  7 - (today.getDay() -  dayWeWant) }  // days remaining
else  { nextFri = dayWeWant - today.getDay(); }

// If today IS friday, you want 4 instead of 3\. Of course,
// 3 can also be made into a "constant" variable, such as howManyWeeks or something

threeMore = nextFri + 3 * 7; // three more weeks

nextDate = new Date();

nextDate.setDate(today.getDate() + threeMore);

   alert (nextDate);

</script>
</html> 
```

代码被故意注释得很好，并且效率不高（并且常数不是很好 - 你可以将它们变成某些函数的参数） - 但可以做到这一点。从这里开始，可以进行一些小的优化（但不那么可读，IOHO）

希望这可以帮助，

TG

# java - 我怎样才能在java中做这个地图迭代？

> ID：12127392
> 
> 赞同：0
> 
> 时间：2012-08-26T03:25:32.777
> 
> 标签：java, map, iterator

我有一个 bean 说“orderHistory”，它有一个列表“order”，而 order 有一个“orderitem”列表。在 orderitem 列表中，我有 2 个道具“oreditemno”现在在我的迭代中，我得到了“orederitemno”并将其放入列表“orederitemnolist”

OrderHistory->Order->OrderItem->"orederitemno" 然后将它们放在单独的列表中... PFB 我正在使用的代码，

```
List<String> itemNos = new ArrayList<String>(); 
for (Order order : orderHistory.getOrders()) {  
    for (OrderItem item : order.getItems()) {
        itemNos.add(item.getItemNo());
    }
} 
```

现在我将此列表传递给一个方法，该方法返回一个带有项目代码的地图，

`Map itemCodeMap = Myutil.getItemCodes(itemNos);`

现在如何遍历这个映射并将每个 orderItem 的 itemcode 放在 OrderHistory bean 中？？？？我应该再次使用上述循环吗？任何建议如何做到这一点......

请注意，我在 OrderItem 类中为 itemcode 添加了一个 getter setter...如何针对遍历地图的每个订单项设置代码..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:33:05.257

> 现在如何遍历这个映射并将每个 orderItem 的 itemcode 放在 OrderHistory bean 中？？？？我应该再次使用上述循环吗？任何建议如何做到这一点......

是的，只需再次执行相同的循环，使用对方法名称的猜测：

```
List<String> itemNos = new ArrayList<String>(); 
for (Order order : orderHistory.getOrders()) {  
    for (OrderItem item : order.getItems()) {
        ItemCode code = (ItemCode)itemCodeMap.get(item.getItemNo());
        if(code!=null) {
            item.setItemCode(code);
        }
    }
} 
```

# c - 致命错误：libavcodec/avcodec.h 没有此类文件或目录编译终止

> ID：12127397
> 
> 赞同：7
> 
> 时间：2012-08-26T03:26:22.533
> 
> 标签：c, ffmpeg

我正在尝试使用 gcc 执行 tutorial01.c，并且我在同一个文件夹中拥有 gcc 和 tutorial01.c 以及 libavcodec 和 libavformat 及其相关文件，它给了我这个错误

> 致命错误：libavcodec/avcodec.h 没有此类文件或目录编译终止

当我 `gcc -o tutorial01 tutorial01.c -lavformat -lavcodec -lz`在 ubuntu 12.04 中运行终端时

代码是

```
#include  libavcodec/avcodec.h
#include libavformat/avformat.h
#include stdio.h

void SaveFrame(AVFrame *pFrame, int width, int height, int iFrame)
 {
  FILE *pFile;
  char szFilename[32];
  int  y;

  // Open file
  sprintf(szFilename, "frame%d.ppm", iFrame);
  pFile=fopen(szFilename, "wb");
  if(pFile==NULL)
    return;

  // Write header
  fprintf(pFile, "P6\n%d %d\n255\n", width, height);
  // Write pixel data
  for(y=0; y<height; y++)
    fwrite(pFrame->data[0]+y*pFrame->linesize[0], 1, width*3, pFile);

  // Close file
  fclose(pFile);
}

int main(int argc, char *argv[])
 {
  AVFormatContext *pFormatCtx;
  int             i, videoStream;
  AVCodecContext  *pCodecCtx;
  AVCodec         *pCodec;
  AVFrame         *pFrame; 
  AVFrame         *pFrameRGB;
  AVPacket        packet;
  int             frameFinished;
  int             numBytes;
  uint8_t         *buffer;

  if(argc < 2) 
  {
    printf("Please provide a movie file\n");
    return -1;
  }

  // Register all formats and codecs
  av_register_all();
  // Open video file
  if(av_open_input_file(&pFormatCtx, argv[1], NULL, 0, NULL)!=0)
    return -1; // Couldn't open file

  // Retrieve stream information
  if(av_find_stream_info(pFormatCtx)<0)
    return -1; // Couldn't find stream information

  // Dump information about file onto standard error
  dump_format(pFormatCtx, 0, argv[1], 0);
  // Find the first video stream
  videoStream=-1;
  for(i=0; i<pFormatCtx->nb_streams; i++)
    if(pFormatCtx->streams[i]->codec->codec_type==CODEC_TYPE_VIDEO)
    {
      videoStream=i;
      break;
    }
  if(videoStream==-1)
    return -1; // Didn't find a video stream

  // Get a pointer to the codec context for the video stream
  pCodecCtx=pFormatCtx->streams[videoStream]->codec;
  // Find the decoder for the video stream
  pCodec=avcodec_find_decoder(pCodecCtx->codec_id);
  if(pCodec==NULL) 
  {
    fprintf(stderr, "Unsupported codec!\n");
    return -1; // Codec not found
  }

  // Open codec
  if(avcodec_open(pCodecCtx, pCodec)<0)
    return -1; // Could not open codec

  // Allocate video frame
  pFrame=avcodec_alloc_frame();

  // Allocate an AVFrame structure
  pFrameRGB=avcodec_alloc_frame();

  if(pFrameRGB==NULL)
    return -1;

  // Determine required buffer size and allocate buffer              
 numBytes=avpicture_get_size(PIX_FMT_RGB24, pCodecCtx->width,
                  pCodecCtx->height);

  buffer=(uint8_t *)av_malloc(numBytes*sizeof(uint8_t));

  // Assign appropriate parts of buffer to image planes in pFrameRGB
  // Note that pFrameRGB is an AVFrame, but AVFrame is a superset
  // of AVPicture
  avpicture_fill((AVPicture *)pFrameRGB, buffer, PIX_FMT_RGB24,
         pCodecCtx->width, pCodecCtx->height);

  // Read frames and save first five frames to disk
  i=0;
  while(av_read_frame(pFormatCtx, &packet)>=0)
 {
    // Is this a packet from the video stream?
    if(packet.stream_index==videoStream) 
    {
      // Decode video frame
      avcodec_decode_video(pCodecCtx, pFrame, &frameFinished, 
               packet.data, packet.size);

      // Did we get a video frame?
      if(frameFinished) 
      {
        // Convert the image from its native format to RGB

    img_convert((AVPicture *)pFrameRGB, PIX_FMT_RGB24, 
                    (AVPicture*)pFrame, pCodecCtx->pix_fmt, pCodecCtx->width, 
                    pCodecCtx->height);

    // Save the frame to disk

    if(++i<=5)
  SaveFrame(pFrameRGB, pCodecCtx->width, pCodecCtx->height, 
            i);
      }
   }

    // Free the packet that was allocated by av_read_frame
    av_free_packet(&packet);
  }

  // Free the RGB image
  av_free(buffer);
  av_free(pFrameRGB);

  // Free the YUV frame
  av_free(pFrame);

 // Close the codec
  avcodec_close(pCodecCtx);

  // Close the video file
  av_close_input_file(pFormatCtx);

  return 0;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:31:10.143

您需要将 libavcodec 和 libavformat 包含文件的路径添加到命令行。找到 include/ 目录并添加

```
-Ipath/to/include 
```

对于每个相关的包含文件。

您还需要使用 -L 对库目录执行相同的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-23T12:50:45.047

由于路径错误而发生该错误

-L/home/yourpath/ffmpeg_build/lib/

-I/home/yourpath/ffmpeg_build/include/

ffmpeg_build - 将在哪里构建文件和安装库。

例子 ：

创建文件“execute.sh”

现在打开文件并粘贴以下代码：

```
g++ -Wno-format-zero-length -Wno-write-strings -L/home/yourpath/ffmpeg_build/lib/ -I/home/yourpath/ffmpeg_build/include/ -o output program.cpp -lavcodec -lavformat -lavutil -lavdevice -lswresample -lswscale -lm -lva -lpthread -lvorbis -lvpx -lopus -lz -lpostproc -ldl -lfdk-aac -lmp3lame -lvorbisenc -lvorbisfile -lx264 -ltheora -ltheoraenc -ltheoradec -ldl -lrt -lx265 -lbz2 
```

并输入： sh execute.sh 和二进制将以名称“输出”创建，然后输入 ./output 进行输出。

注意：以上对于 C++，对于 c 代码将 g++ 更改为 gcc

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-23T01:42:40.943

这取决于您如何安装 ffmpeg。通常，您可以通过 3 个步骤编译和安装：

1.  ./configure --prefix=/yourpath/ffmpeg
2.  制作
3.  进行安装

如果您没有配置“--prefix”参数，它将安装在您的默认路径。（在我的Ubuntu上，我发现ffmpeg已安装在“/usr/local/”）

正确安装 ffmpeg 后，您可以使用以下命令编译您的代码：

```
gcc testFfmpeg.c -I/yourpath/ffmpeg/include/ -L/yourpath/ffmpeg/lib/ 
```

或者

```
gcc testFfmpeg.c -I/usr/local/include/ -L/usr/local/lib/ 
```

# jstree - html_data 用于初始数据，json_data 用于 jstree 中的 AJAX 数据

> ID：12127401
> 
> 赞同：0
> 
> 时间：2012-08-26T03:27:54.387
> 
> 标签：jstree

我可以配置jstree使用html_data插件加载初始数据和json_data插件处理后续AJAX数据吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T22:22:07.473

如果您的第一个加载数据可能是静态的，那么您只需使用静态 json 加载第一棵树，然后使用 ajax 重新加载它。

# paperclip - Prettyphoto 和 Rails

> ID：12127406
> 
> 赞同：0
> 
> 时间：2012-08-26T03:28:39.133
> 
> 标签：paperclip, ruby-on-rails-3.2, prettyphoto

我正在尝试让 prettyphoto 在我的 rails 应用程序中工作。我想在回形针宝石上传的漂亮照片中显示图像。

我正在运行 rails 3.2.8、paperclip 3.1.4 和 hiq5/prettyphoto-rails gem。

这是我在身体末端的东西：

```
<script type="text/javascript" charset="utf-8">
    $(document).ready(function(){
        $("a[rel^='prettyPhoto']").prettyPhoto({
            animationSpeed: 'normal', /* fast/slow/normal */
            padding: 40, /* padding for each side of the picture */
            opacity: 0.35, /* Value betwee 0 and 1 */
            showTitle: false, /* true/false */
            allowresize: true, /* true/false */
            counter_separator_label: '/', /* The separator for the gallery counter 1 "of" 2 */
            theme: 'light_rounded' /* light_rounded / dark_rounded / light_square / dark_square */
        });
    });
</script> 
```

这是rails link_to：

```
<%= link_to image_tag(@client.price_plan.flier1.url(:small)), @client.price_plan.flier1.url(:medium), rel: "prettyPhoto" %> 
```

我认为问题可能是回形针与最后的字符串创建的链接？

例子：

```
http://localhost:3000/price_plans/flier1s/3/small_1180001_SF6w.jpg?1345698254 
```

Prettyphoto 是否需要从链接中剥离 ?1345698254 才能工作？

例子：

```
http://localhost:3000/price_plans/flier1s/3/small_1180001_SF6w.jpg 
```

如果是这样，我怎么能在回形针中做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T04:55:58.583

我终于回到了这个问题，并能够用当前版本解决它。这可能是一个错误，但我发现通过设置 rel: 'prettyPhoto' 不起作用，而 rel: "prettyPhoto" 确实起作用了？？？

最终链接如下所示：

```
<%= link_to "PrettyPhoto test", @client.price_plan.flier1.url(:medium), rel: "prettyPhoto", class: "prettyphoto" %> 
```

希望对其他人有所帮助....

# java - 将arraylist写入数据库java

> ID：12127407
> 
> 赞同：3
> 
> 时间：2012-08-26T03:28:55.360
> 
> 标签：java, database, jdbc, insert, arraylist

我有两个数组列表插入到数据库表的 2 列中，如下所示：

```
arraylist1: 123444, 324555, 6423643, 532326
arraylist2: jkfdsl, nkjfsdlj, jdslkfjdlkj, jfsldjfsk, fjdlskjfs 
```

我编写了以下代码来插入数组列表，但它不起作用。我会感谢你的帮助。

```
try {
// Prepare a statement to insert a record

String sql = "INSERT INTO soundsdata.splog (arraylist1, arraylist2) VALUES(?,?)";
pstmt = (PreparedStatement) con.prepareStatement(sql);

pstmt.setArray(1,sptospring);
pstmt.setString(2,eachList.toString());

// Insert the row
pstmt.executeUpdate();
}finally {
pstmt.close();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T04:08:29.103

您可以执行以下操作：

*假设您正在尝试创建一行，其中第一`column`行将包含第一行的内容，`ArrayList`以逗号分隔格式，第二`column`行将包含第二行的内容`ArrayList`*

```
StringBuilder buffer = new StringBuilder();
boolean processedFirst = false;
String firstParam = null, secondParam = null;

try{
    for(String record: arrayList1){
        if(processedFirst)
            buffer.append(",");
        buffer.append(record);
        processedFirst = true;
    }
    firstParam = buffer.toString();
}finally{
    buffer = null;
}
processedFirst = false;
buffer = new StringBuilder();
try{
    for(String record: arrayList2){
        if(processedFirst)
            buffer.append(",");
        buffer.append(record);
        processedFirst = true;
    }
    secondParam = buffer.toString();
}finally{
    buffer = null;
}
secondParam = buffer.toString();

String sql = "INSERT INTO soundsdata.splog (arraylist1, arraylist2) VALUES(?,?)";
try{
    psmt = (PreparedStatement) con.prepareStatement(sql);
    pstmt.setString(1,firstParam);
    pstmt.setString(2,secondParam);
    pstmt.executeUpdate();
}finally {
    pstmt.close();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T03:36:13.773

您不能将 ArrayList 存储在 varchar 列中。

您需要存储一个字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T03:46:04.943

```
PreparedStatement ps = connection.prepareStatement(query);            
for (Record record : arraylist1) {
    int index=1;                        
    ps.setString(index++,record.getItem());
    ps.setString(index++,record.getItem2());
    //
}
ps.executeBatch();
conn.commit(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T05:07:18.313

**插入多条记录：**

```
public String saveOrder(ArrayList<KIT0053MBean> insertList){     
    System.out.println("SaveOrder DAO  Method is calling " +insertList.size());
    Connection con=null;
    PreparedStatement ps2=null;
    try {
        con=open();
        con.setAutoCommit(false);
        con.getTransactionIsolation();
        ps2=con.prepareStatement(sql1);             
        Iterator<KIT0053MBean> it=insertList.iterator();            
        while(it.hasNext()){
            KIT0053MBean order=(KIT0053MBean)it.next();                 
            ps2.setString(1, model.getCustomerid());
            ps2.setString(2, model.getSerialid());                  
            ps2.addBatch();
        }               
        int i[]=ps2.executeBatch();
        System.out.println("###### insertion1### row   "+i.length);    
        con.commit();
        con.setAutoCommit(true);                
    } catch (Exception e) 
    {               
        System.out.println(e.getMessage());     
    }finally{
        close(con);         
        close(ps2);             
    }
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-01-14T11:24:46.723

String[] stringArray = lists.toArray(new String[lists.size()]);

```
 String string1 = stringArray[0];
            String string2 = stringArray[1];
            String string3 = stringArray[2];
            String string4 = stringArray[3];
            String string5 = stringArray[4]; 
```

// 然后写查询插入到数据库

插入表名值（string1 ......）

# java - android 从 PreferenceScreen 的图库中选择图像？

> ID：12127408
> 
> 赞同：6
> 
> 时间：2012-08-26T03:29:00.040
> 
> 标签：java, android

我如何从 android PreferenceScreen 菜单中的图库中选择图像？

我的 PreferenceScreen 菜单的 xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">
    <Preference
        android:key="select_image"
        android:title="select image">
</PreferenceScreen> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-26T07:16:31.653

我终于找到了答案

首先设置 setOnPreferenceClickListener

```
Preference prefereces=findPreference("test");
        prefereces.setOnPreferenceClickListener (new Preference.OnPreferenceClickListener(){
            public boolean onPreferenceClick(Preference preference){
                Intent intent = new Intent();
                intent.setType("image/*");
                intent.setAction(Intent.ACTION_GET_CONTENT);
                int PICK_IMAGE = 1;
                startActivityForResult(Intent.createChooser(intent, "Select Picture"), PICK_IMAGE);
                return true;
            }
        }); 
```

比把它放进 onActivityResult

```
protected void onActivityResult(int requestCode, int resultCode, Intent imageReturnedIntent) { 
        super.onActivityResult(requestCode, resultCode, imageReturnedIntent); 

            if(resultCode == RESULT_OK){  
                Uri selectedImage = imageReturnedIntent.getData();
                String[] filePathColumn = {MediaStore.Images.Media.DATA};

                Cursor cursor = getContentResolver().query(selectedImage, filePathColumn, null, null, null);
                cursor.moveToFirst();

                int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
                String filePath = cursor.getString(columnIndex);
                cursor.close();

                Log.d(LOG_TAG, "Data Recieved! " + filePath);

        } 
```

# google-maps-api-3 - 谷歌地图建筑风格

> ID：12127409
> 
> 赞同：2
> 
> 时间：2012-08-26T03:29:33.223
> 
> 标签：google-maps-api-3

有没有办法像openlayer一样在谷歌地图中设置建筑物的样式？ [http://workshops.opengeo.org/openlayers-intro/vector/style.html](http://workshops.opengeo.org/openlayers-intro/vector/style.html)

我一直在用其他元素设计谷歌地图，而不是标签，只显示道路和建筑物，我需要做的就是增强建筑物的颜色。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T15:15:13.977

您可以使用[“样式化地图”](https://developers.google.com/maps/documentation/javascript/styling)和样式“风景 -> 人造”

[Google Maps API v3 小组中的讨论](https://groups.google.com/group/google-maps-js-api-v3/browse_frm/thread/1d560dac6ff6b4bb)

# java - bindFormRequest() 在 Play 2.0.3 中遇到找不到符号错误

> ID：12127414
> 
> 赞同：3
> 
> 时间：2012-08-26T03:30:44.403
> 
> 标签：java, forms, heroku, playframework, playframework-2.0

我用 Play 框架创建了一个表单。但我得到了一个`error: cannot find symbol` 我查看了播放目录中的示例代码，仍然无法弄清楚。顺便问一下，我可以使用 Play 访问 heroku 中的 PostgresSQL 吗？这是以下代码：

这是 /controllers/Application.java 中的一段代码

```
 final static Form<Geo> geoForm = form(Geo.class);

    public static Result showDBpage(){

          //get problem here :-<
          Form<Geo> filledForm = geoForm.bindFormRequest(); 
          Geo loc = filledForm.get();
          return ok(database.render(loc));
        } 
```

这是配置/路由：

```
POST    /database   controllers.Application.showDBpage() 
```

视图/database.scala.html

```
@(loc: Geo)

@main("") {

    <p>This is Database pages</p>

    <p>@loc.longitute and @loc.latitute</p>

    <a href=@routes.Application.index>Back to form</a>
} 
```

模型/Geo.java：

```
package models;

import java.util.*;
import javax.validation.*;
import play.data.validation.Constraints.*;

public class Geo
  {
    @Required
    public String longitute;
    @Required
    public String latitute;

    public Geo()
    {

    }

    public Geo(String longitude,String latitute)
    {
        this.longitute = longitute;
        this.latitute = latitute;
        //this.length = length;
    }
  } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T08:54:32.043

没有方法~~bindFormRequest()~~但是`bindFromRequest()`- 您的代码中有错字。

检查 API [http://www.playframework.org/documentation/api/2.0.2/java/play/data/Form.html](http://www.playframework.org/documentation/api/2.0.2/java/play/data/Form.html)

# git - mingw和git有什么关系？

> ID：12127416
> 
> 赞同：2
> 
> 时间：2012-08-26T03:30:58.740
> 
> 标签：git, mingw

当我在 windows 上使用 git 时，我注意到命令窗口的标题是 MINGW32:xxx，我曾经在我的 windows 上安装了完整版的 MINGW，但它没有包含一些 git 的东西。那么git和mingw是什么关系，mingw究竟是什么？我知道mingw是windows版本的unix工具合集，为什么不包括git。或者 mingw 是某种支持 gcc 和 git 的环境？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:34:25.867

### 回答

**mingw**是用于 Windows 的不完整 *nix 环境。

**Git**是一个版本控制系统，在 *nix 环境下效果最好。它是由 Linus Torvalds 创建的，所以他真的不太关心它在 Windows 上的工作，而且 Windows 肯定是 Git 生态系统中的三等公民。

### 关系

他们唯一相关的是 mingw 用于编译 Git，因为它有 gcc 编译器，这是它在所有 *nix 系统上使用得最好的。必须像安装任何其他独立应用程序一样安装 Git。它只是倾向于包含在主要的 Linux 发行版中，因为它用于控制 Linux 源代码本身。

### Windows 上 Git 的工作流程建议

最好的 Windows git 系统是`msysgit`预先打包在一起的，如果您在安装时选择了正确的复选框，它就会运行良好。

也就是说，当我在工作中背负着 Windows 工作站时，我安装了 VirtualBox，然后是我首选的 Linux 发行版，并与 VirtualBox 共享我的 Windows 工作目录。然后我在我的 Linux 上使用 git，在 Windows 上使用我的 Windows 特定工具。到目前为止，比其他一半的解决方案要好。

# shell - 如何使用 putty 命令行知道目录及其所有子目录中的文件数？

> ID：12127420
> 
> 赞同：-1
> 
> 时间：2012-08-26T03:31:52.407
> 
> 标签：shell, command-line

我正在使用 Putty，我有一个文件夹，每个文件夹中有很多子文件夹和文件。我需要一个命令来了解整个文件夹的大小以及其中的所有内容，以及所有该文件夹的总文件数。

我知道这个命令

> du -h 文件夹名

但它列出了每个子文件夹的大小，然后给出了总文件夹的大小，但数字并不准确（即显示 7.8G 而不是确切的字节数），并且不显示总文件数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T03:43:31.777

您的朋友是“find”，以及计算行数的“wc”。

查找文件夹名称 -type f | wc -l

如果你想要文件大小，du -k 而不是 -h 会以 k 为单位显示大小。您还可以选择管道到 ls -l，并使用快速 awk 或 perl 脚本汇总字节数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T03:55:35.493

获取以千字节为单位的总大小：

```
du -sk foldername 
```

获取文件数：

```
find foldername -type f | wc -l 
```

# java - Java中使用GlassPane的内部透明选择窗口

> ID：12127422
> 
> 赞同：4
> 
> 时间：2012-08-26T03:34:03.767
> 
> 标签：java, swing, glasspane

我正在努力实现以下目标

[http://www.qksnap.com/i/3hunq/4ld0v/screenshot.png](http://www.qksnap.com/i/3hunq/4ld0v/screenshot.png)

我目前能够使用以下代码在半透明玻璃窗格背景上成功绘制矩形：

```
 protected void paintComponent(Graphics g) {
          Graphics2D g2 = (Graphics2D) g;
          g.setColor(Color.black); // black background
          g.fillRect(0, 0, frame.getWidth(), frame.getHeight());
          g2.setColor(Color.GREEN.darker());
          if (getRect() != null && isDrawing()) {
            g2.draw(getRect()); // draw our rectangle (simple Rectangle class)
          }
         g2.dispose();
} 
```

效果很好，但是，我希望矩形内的区域完全透明，而外部仍然很暗，就像上面的屏幕截图一样。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T04:21:06.113

正如安德鲁所建议的那样（在我完成我的例子时击败我）

```
protected void paintComponent(Graphics g) {
    super.paintComponent(g);

    Graphics2D g2 = (Graphics2D) g.create();
    g.setColor(Color.black); // black background

    Area area = new Area();
    // This is the area that will filled...
    area.add(new Area(new Rectangle2D.Float(0, 0, getWidth(), getHeight())));

    g2.setColor(Color.GREEN.darker());

    int width = getWidth() - 1;
    int height = getHeight() - 1;

    int openWidth = 200;
    int openHeight = 200;

    int x = (width - openWidth) / 2;
    int y = (height - openHeight) / 2;

    // This is the area that will be uneffected
    area.subtract(new Area(new Rectangle2D.Float(x, y, openWidth, openHeight)));

    // Set up a AlphaComposite
    g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, 0.5f));
    g2.fill(area);

    g2.dispose();
} 
```

![显示和隐藏](../Images/a6d887aba342bd34c1e1f43d755f37c1.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-26T04:16:38.703

> ..让矩形内的区域完全透明，而外面仍然很暗，就像上面的屏幕截图一样。

*   创建一个`Rectangle`( `componentRect`)，它是正在绘制的组件的大小。
*   创建该形状 ( ) 的 ( `Area`) 。`componentArea``new Area(componentRect)`
*   创建一个`Area`( `selectionArea`) 的`selectionRectangle`。
*   调用`componentArea.subtract(selectionArea)`以删除选定的部分。
*   称呼`Graphics.setClip(componentArea)`
*   涂上半透明的颜色。
*   （如果需要更多的绘画操作，请清除剪切区域）。

# php - 如何在 WAMP SERVER 2.2 中安装 Joomla？

> ID：12127425
> 
> 赞同：-1
> 
> 时间：2012-08-26T03:34:38.100
> 
> 标签：php, phpmyadmin

**您好** ，我在 WAMP Server 2.2 安装中使用 joomla 安装都是完整的，之后我在主页上运行 joomla 这种类型的错误如何删除.....请帮助我

注意：第 44 行 C:\wamp\www\joomlawebsite\components\com_banners\models\banners.php 中的数组到字符串转换

第 45 行 C:\wamp\www\joomlawebsite\components\com_banners\models\banners.php 中的数组到字符串转换

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:12:02.280

如果您使用的是 5.4 版本的 PHP，请尝试降级到 5.3（根据[此 Joomla 线程](http://forum.joomla.org/viewtopic.php?f=615&t=725046)应该可以解决问题。）

# vim - 如何聚焦特定窗口？

> ID：12127439
> 
> 赞同：1
> 
> 时间：2012-08-26T03:38:06.437
> 
> 标签：vim

我使用 NERDTree 插件，我想创建一个聚焦 NERDTree 窗口并进入搜索模式的映射（当然是为了轻松选择文件）。这里的困难部分是聚焦 NERDTree 窗口。我希望映射可以从任何窗口工作 - 甚至从 NERDTree 窗口本身。那么如何使用 vimscript 聚焦该窗口呢？

我发现 NERDTree 的缓冲区的名称为“NERD_tree_1”（如果只存在一个 NERDTree 缓冲区，但这对我来说已经足够了）。我可以以某种方式使用它来聚焦包含该缓冲区的窗口吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T03:43:47.307

使用`:NERDTreeFocus`命令。您可以将其绑定到一个键，例如：

```
noremap <F2> :NERDTreeFocus <BAR> call feedkeys('/') <CR> 
```

# maven-2 - 如何复制/克隆 maven2 存储库服务器

> ID：12127441
> 
> 赞同：2
> 
> 时间：2012-08-26T03:38:28.497
> 
> 标签：maven-2, sbt

我想创建一个本地 maven2 存储库，以便我们可以更快地下载依赖项。

我们使用 sbt

从[http://oss.sonatype.org/content/repositories/releases](http://oss.sonatype.org/content/repositories/releases)获取全部或部分依赖项并将其放入我们的服务器的最简单方法是什么

我正在考虑一个脚本来下载一些 jars 并将其放入 sftp 服务器并使用 sftp 解析器和 sbt [https://github.com/harrah/xsbt/wiki/Resolvers](https://github.com/harrah/xsbt/wiki/Resolvers)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T04:21:59.657

一种非常简单的方法是安装存储库管理器。一种流行的是 Sonatype Nexus（服务于[http://oss.sonatype.org](http://oss.sonatype.org)的应用程序）。存储库管理器安装在您的服务器上，并设置为代理在线 Maven 存储库。然后，您从存储库管理器下载您的依赖项，就好像它是实际的服务器一样。第一次下载依赖项时，它会像以前一样慢（代理将从 Internet 下载它），但在那之后，它将提供其缓存副本。[这个](https://stackoverflow.com/questions/3770125/how-do-i-get-sbt-to-use-a-local-maven-proxy-repository-nexus)问题有一些细节。

# django - 为 Django 应用设置元信息

> ID：12127445
> 
> 赞同：1
> 
> 时间：2012-08-26T03:39:26.700
> 
> 标签：django, django-apps

我的 Django 项目中安装了一些应用程序。我希望一些应用程序能够从其他一些应用程序中获取信息。因此，我希望为每个应用程序提供一些有关权限的基本元信息。

所以，如果我有三个应用程序：A1、A2 和 A3。

我想将 A1 设置为只读。将 A2 设置为读/写。将 A3 设置为无法读取或写入。

元描述主要是为了我自己的理智。这些应用程序不会与我没有编写的应用程序一起使用。

有没有办法在应用程序级别添加此类元数据？也许通过 Django 应用程序的未使用描述字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T04:43:08.520

不知道为什么你会需要这个，但通常你会将所有元信息放在`__init__.py`应用程序中。然后您可以从另一个应用程序访问它：

`myapp1/__init__.py`：

```
version = '0.1.0'
permissions = ['read', 'write'] 
```

`myapp2/utils.py`：

```
from django.conf import settings
import importlib

for app_name in settings.INSTALLED_APPS:
    app = importlib.import_module(app_name)
    if hasattr(app, 'permissions') and 'write' in app.permissions:
        do_something() 
```

# android - 有没有人在硬件/ril中测试过带有mock-ril的android电话？

> ID：12127452
> 
> 赞同：2
> 
> 时间：2012-08-26T03:43:03.247
> 
> 标签：android, testing, mocking, telephony, ril

mock-ril 的代码是随安卓代码一起发布的。它可以运行，但只提供基本功能，如sim卡状态和信号。我不知道谷歌是否使用此代码测试电话。我也在google中搜索了mock-ril，但没有找到有用的信息。以前有人用过吗？您如何看待电话测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T10:18:48.570

它基本上只是一个存根。您需要为您的特定设备使用 ril 二进制文件。如果您有根，您可以从您的设备中获取它们，或者您可以在线检查并查看 CyanogenMod 是否支持您的设备。

# javascript - 可以在网站中实现的在线视觉数学方程编辑器？

> ID：12127456
> 
> 赞同：0
> 
> 时间：2012-08-26T03:43:59.740
> 
> 标签：javascript, html, math, wysiwyg

我正在在线创建一个视觉数学方程编辑器，但我发现很难正确地制作它。

在我继续之前，我想确保没有我可以使用的网站可实现的编辑器（可以做分数、索引、surds 等的编辑器）。

那么，有吗？

**更新：**我只是在网上看，我看到了[Math/Graph TinyMCE](http://www.imathas.com/editordemo/demo.html)，但这仍然需要用户了解 LaTeX。我想要完全一样的东西，但他们实际上可以手动编辑分数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T06:15:16.567

*免责声明：我在这个工具上工作。*

[**Alfred 的方程式编辑器 (AlfredEq)**](http://sharemath.com/AlfredEq-README.html)完全符合您的要求。将它与[**MathJax**](http://www.mathjax.org)结合起来进行渲染。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T03:53:26.160

这将不可避免地引导您学习[MathML](http://www.w3.org/Math/)。

网上有很多关于它的信息，但我不是专家。

# iphone - 照片的默认缩放是如何设置的？

> ID：12127457
> 
> 赞同：0
> 
> 时间：2012-08-26T03:44:12.857
> 
> 标签：iphone, sdk

我正在使用 UIImageView 中的简单 UIImage 创建自定义背景页面。

我想要做的是能够以照片应用程序处理图像的方式来适应我的图像。

*   对于默认人像相机图片：看起来像 aspectToFill？
*   对于默认的风景相机图片：aspectToFit 整个页面（320,480）
*   其他自定义保存的图片：???

在这里，我想避免尽可能多的空白空间，而不会影响用户对图像的感知。

感谢您的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T06:27:04.687

如果要以正确的纵横比查看整个图像，则必须使用 aspectFit。

你假设它的 aspectFill 是纵向的。但这仅适用于以纵向查看的纵向图像（或以横向查看的横向图像）。

# boost - 提升库路径包括

> ID：12127458
> 
> 赞同：3
> 
> 时间：2012-08-26T03:45:19.893
> 
> 标签：boost, mingw

我安装了 boost v.1.51.0 并且目录“boost_1_51_0”位于“/home/user1/boost/”下。要安装，我只是将 tar 文件解压缩到“/home/user1/boost/”中。我在 MinGW 上使用 C++ 编译器。

现在，我正在尝试将库包含在代码中。到目前为止我试过

```
#include </home/user1/boost/boost_1_51_0/libs/unordered/test/objects/test.hpp>  
#include </home/user1/boost/boost_1_51_0/test.hpp>
#include </home/user1/boost/test.hpp>
#include <boost/test.hpp> 
```

和其他一些人一起。我什至尝试将“/home/user1/boost/”的 Windows 位置添加到路径中。

我错过了一些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T03:51:11.327

您需要使用命令行参数向编译器提供包含目录，例如`-I/home/user1/boost/boost_1_51_0`.

您可能还想将 boost 实际安装到系统目录；有关详细信息，请参见[http://www.boost.org/doc/libs/1_51_0/doc/html/bbv2/installation.html](http://www.boost.org/doc/libs/1_51_0/doc/html/bbv2/installation.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T03:51:44.663

使用文档中指定的包含`boost`内容（通常按照`<boost/test.hpp>`上面示例的行）。但是适当地设置你的`CPPPATH`/ `CXXFLAGS`（构建环境）。对于`MinGW`，您需要添加`-I/home/user1/boost/boost_1_51_0/`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-26T14:34:22.920

```
#include </home/user1/boost/boost_1_51_0/libs/unordered/test/objects/test.hpp> 
```

这是行不通的。可能会找到该文件，但随后它将尝试包含其他文件，例如`<boost/config.hpp>`在您的包含路径中找不到的文件。

```
#include </home/user1/boost/boost_1_51_0/test.hpp>
                                         ^^^^^^^^ 
```

这是行不通的，因为文件不在那个位置！如果你运行`ls /home/user1/boost/boost_1_51_0/test.hpp`你会得到一个错误，因为那个文件不存在。

```
#include </home/user1/boost/test.hpp>
                            ^^^^^^^^ 
```

这里同样的问题。

无论如何，将绝对路径放在`#include`指令中通常是一个坏主意，因此上述所有尝试都是错误的。相反，您应该包含该文件作为其预期使用：

```
#include <boost/test.hpp> 
```

为此，您需要告诉编译器在哪里查找，因此您设置包含路径`-I dir`，在您的情况下需要使用该路径，`-I /home/user1/boost/boost_1_51_0/`以便编译器`boost/test.hpp`在`/home/user1/boost/boost_1_51_0/`其中查找和查找`/home/user1/boost/boost_1_51_0/boost/test.hpp`，以及何时包含`boost/config.hpp`它会`/home/user1/boost/boost_1_51_0/boost/config.hpp`按预期找到。

但是，现在这会找到`/home/user1/boost/boost_1_51_0/boost.test.hpp`，但您似乎想要包含一个 Boost.Undordered 单元测试使用的标头...我不确定您为什么认为您想要那个。通常你只想在`boost`not under 下包含 Boost headers`libs`

# c++ - 将 Perl 正则表达式转换为等效的 ECMAScript 正则表达式

> ID：12127463
> 
> 赞同：5
> 
> 时间：2012-08-26T03:46:23.700
> 
> 标签：c++, regex, windows, linux, visual-studio-2010

现在我使用的是 VC++ 2010，但是`syntax_option_type`VC++ 2010 只包含以下选项：

```
static const flag_type icase = regex_constants::icase;
static const flag_type nosubs = regex_constants::nosubs;
static const flag_type optimize = regex_constants::optimize;
static const flag_type collate = regex_constants::collate;
static const flag_type ECMAScript = regex_constants::ECMAScript;
static const flag_type basic = regex_constants::basic;
static const flag_type extended = regex_constants::extended;
static const flag_type awk = regex_constants::awk;
static const flag_type grep = regex_constants::grep;
static const flag_type egrep = regex_constants::egrep; 
```

它不包含 perl_syntax_group（Boost 库有选项）。**但是，我不想使用 Boost Library。**

有很多用 Perl 编写的正则表达式，所以我想将现有的 Perl 正则表达式转换为`ECMAScript`（或 VC++ 2010 支持的任何一个）。转换后，我可以直接在 VC++ 2010 中使用等效的正则表达式，而无需使用第三方库。

一个例子：

```
const boost::tregex e(__T("\\A(\\d{3,4})[- ]?(\\d{4})[- ]?(\\d{4})[- ]?(\\d{4})\\z"));
const CString human_format = __T("$1-$2-$3-$4");
CString human_readable_card_number(const CString& s)
{
   return boost::regex_replace(s, e, human_format);
}
CString credit_card_number = "1234567887654321";
credit_card_number = human_readable_card_number(credit_card_number);
assert(credit_card_number == "1234-5678-8765-4321"); 
```

在上面的例子中，我想做的是转换和`e`样式表达式。`format``ECMAScript`

***是否有可能找到将所有 Perl 正则表达式转换为`ECMAScript`样式的通用方法？有一些工具可以做到这一点吗？***

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T03:59:00.577

对于您要转换的特定正则表达式，ECMA 正则表达式中的等效项是：

```
/^(\d{3,4})[- ]?(\d{4})[- ]?(\d{4})[- ]?(\d{4})$/ 
```

在这种情况下，`\A`（在 Perl 正则表达式中）与`^`（在 ECMA 正则表达式中）（匹配字符串的开头）具有相同的含义，并且`\Z`（在 Perl 正则表达式中）与（在 ECMA 正则表达式中）具有相同的含义`$`（匹配字符串的结尾） . 请注意，如果启用多行模式，ECMA 正则表达式中`^`和的含义将更改为匹配行的开头和结尾。`$`

ECMA regex 是 Perl regex 的子集，因此如果 regex 使用 Perl regex 中的专有功能，它很可能无法转换为 ECMA regex。即使对于相同的语法，两种正则表达式方言之间的语法可能意味着略有不同，因此检查文档并比较用法总是明智的。

我只会说 ECMA 正则表达式和 Perl 正则表达式之间的相似之处。什么不相似，但可以转换，我会尽我所能提及。

ECMA 正则表达式缺乏与 Unicode 一起使用的功能，这迫使您查找代码点并将它们指定为字符类。

根据[Perl 正则表达式的文档](http://perldoc.perl.org/perlre.html)：

*   修饰符：
    *   只有`i`, `g`,`m`在 ECMA 标准中，它们的行为与在 Perl 中相同。
    *   `s`dot-all 修饰符可以在 ECMA 正则表达式中通过使用 2 个互补字符类来模拟，例如`[\S\s]`，`[\D\d]`
    *   无论如何都不支持`x`和`p`标志。
    *   我不知道是否有任何方法可以模拟其余部分（前缀和后缀修饰符）。
*   元字符：
    *   `\`我对使用无法解决任何特殊含义的非元字符有点怀疑，但如果你不在不需要的地方逃跑应该没问题。`.`在 ECMA 中排除了更多字符。其余部分在 ECMA 正则表达式中的行为相同（甚至`m`标志对`^`and的影响`$`）。
*   量词：
    *   贪婪和懒惰的行为应该是相同的。ECMA 正则表达式中没有占有行为。
*   转义序列：
    *   ECMA 正则表达式中没有`\a`and `\e`。`\t`, `\n`, `\r`,`\f`是一样的。
    *   如果正则表达式有，请检查文档`\cX`- 存在差异。
    *   `\xhh`在 ECMA 正则表达式和 Perl 正则表达式中很常见（指定 2 个十六进制数字是最安全的 - 否则，您将不得不查看文档以了解该语言将如何处理少于 2 个十六进制数字的情况）。
    *   `\uhhhh`是 ECMA 正则表达式*的专有功能*，用于指定 Unicode 字符。Perl 有其他*专有的*方法来指定字符，例如`\x{}`, `\N{}`, `\o{}`, `\000`。
    *   `\l`, `\u`, `\L`,`\U`是Perl 正则表达式*独有的。*
    *   `\Q`并且`\E`可以通过手动转义引用的部分来模拟。
    *   Perl 正则表达式中的八进制转义（少于 3 个八进制数字）可能会令人困惑。仔细检查上下文，阅读文档，和/或测试正则表达式以确保您了解它在上下文中所做的事情，因为它可能是转义序列或反向引用。
*   字符类和其他特殊转义：
    *   `\w`, `\W`, `\s`, `\S`, `\d`,`\D`在 ECMA 正则表达式和 Perl 正则表达式中是等价的，如果假设是 US-ASCII 的话。如果涉及 Unicode，事情将一团糟。
    *   ECMA 正则表达式中没有 POSIX 字符类。使用上面`\w`的`\s`,`\d`或在字符类中指定自己。
    *   反向引用基本相同 - 但我不知道它是否允许 Perl 和 ECMA 正则表达式的反向引用超过 9。
    *   命名引用可以用反向引用来模拟。
    *   其余的（除了`[]`已经提到的转义序列）在 ECMA 正则表达式中不受支持。
*   断言：
    *   `\b`并且`\B`在两种语言中是等价的，关于它们是如何基于`\w`.
*   捕获组：分组`()`和反向引用是相同的。`$n`，在替换字符串中用于反向引用匹配的文本，是相同的。本节中的其余部分是 Perl 独有的功能。
*   引用元字符：（前几节中已经提到的内容）。
*   扩展模式：
    *   ECMA 正则表达式不支持修改正则表达式中的标志。根据标志是什么，您可能能够重写正则表达式（`s`标志是始终可以转换为 ECMA 正则表达式中的等效表达式的表达式）。
    *   Perl 和 ECMA 之间只有`(?:pattern)`(non-capturing group), `(?=pattern)`(positive look ahead), (negative look ahead) 是通用的。`(?!pattern)`
    *   ECMA 正则表达式中没有注释，所以`(?#text)`可以忽略。
    *   ECMA 正则表达式不支持后视。Perl 支持固定宽度的look-behind。在某些情况下，用 Perl 编写的正则表达式可以转换为 ECMA 正则表达式，方法是使后视图成为一个捕获组。
    *   如前所述，命名模式可以转换为正常的捕获组，并且可以通过编号的反向引用进行引用。
    *   其余的是 Perl 独有的特性。
*   特殊回溯控制动词：这是 Perl 独有的，我不知道这些是做什么的（以前从未接触过它们），更不用说转换了。最有可能的情况是它们无论如何都不能转换。

**结论**：

如果正则表达式利用 Perl 正则表达式的全部功能，或者在 Boost 库支持的级别（例如递归正则表达式），则无法将正则表达式转换为 ECMA 正则表达式。幸运的是，ECMA 正则表达式涵盖了最常用的功能，因此正则表达式很可能是可转换的。

**参考**：

[MDN 上的 ECMA RegExp 参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp)

# javascript - JS 代码让 IE9 和 Safari 冻结，在 Opera 中不起作用？

> ID：12127465
> 
> 赞同：0
> 
> 时间：2012-08-26T03:46:33.527
> 
> 标签：javascript, jquery, html, internet-explorer

我不知道为什么，但是这段代码使 IE9 和 Safari 崩溃，并且在 Opera 中根本不起作用。

```
$('#contentPage').on('DOMSubtreeModified', function(){
    if($(".iframey[date-current]").length){
    $(".iframey:not(.hidden)").prevUntil("iframe").addClass('smaller');
}}); 
```

我应该怎么做才能使这段代码在所有浏览器中都能正常工作？

- -编辑 - -

jsfiddle中的代码

[http://jsfiddle.net/rzP5S/](http://jsfiddle.net/rzP5S/)

chrome和firefox中的工作格栅

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:55:40.050

您正在修改 dom 修改事件处理程序中的 dom，您应该检查修改是否是由于处理程序中的代码造成的，以防止无限循环。

还

> 警告！DOMSubtreeModified 事件类型在本规范中定义以供参考和完整性，但本规范不推荐使用此事件类型。

[http://www.w3.org/TR/DOM-Level-3-Events/#event-type-DOMSubtreeModified](http://www.w3.org/TR/DOM-Level-3-Events/#event-type-DOMSubtreeModified)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T06:03:00.027

@Musa 所说的是正确的。有一个无限循环。你有什么理由需要处理它`DOMSubtreeModified`吗？您不能只在点击事件中完成工作吗？这似乎表现相同：

```
$(".onePost").live("click", function() {

    $(".onePost").removeClass('smaller');

    $("iframe")
        .addClass('hidden')
        .removeAttr('src')
        .removeAttr('date-current');

    $(this).nextAll("iframe:eq(0)")
        .removeClass('hidden')
        .removeAttr('style')
        .attr({src: $(this).data('href')})
        .attr('date-current', 'here');

    if($(".iframey[date-current]").length){
        $(".iframey:not(.hidden)").prevUntil(".iframey").addClass('smaller');
    }
}); 
```

[http://jsfiddle.net/rPPSj/](http://jsfiddle.net/rPPSj/)

# windows-phone-7 - 如何从 ShareStatusTask 更新磁贴

> ID：12127468
> 
> 赞同：1
> 
> 时间：2012-08-26T03:47:58.880
> 
> 标签：windows-phone-7

当用户完成使用我的应用程序中可用的 ShareStatusTask 选项时，我希望能够更新固定到开始屏幕的辅助磁贴。问题是用户也可以导航到我的 ShareStatusPage，其中也包含来自辅助磁贴的 ShareStatusTask，但我允许用户在我的 MainPage 中创建辅助磁贴。所以，当没有后台导航时，我不知道如何从 ShareStatusPage 更新 MainPage 中的磁贴实例？我如何能够声明一个全局变量，该变量将立即完成此操作，同时保持默认的后台导航（当从开始屏幕上的辅助磁贴访问 ShareStatusPage 时不会转到 MainPage）？我的最终目标是使用最新的状态更新文本（在调用 ShareStatusTask 之前由用户在我的 ShareStatusPage 中输入）简单地更新辅助磁贴的消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T07:53:43.913

在 viewModel 中保留一个 status 属性并在两个页面上引用它。因此，无论何时更改该属性值，都调用一个 updateTile 函数，该函数将更改您的辅助磁贴。您可以学习如何实现[MVVM 架构](http://msdn.microsoft.com/en-us/library/windowsphone/develop/gg521153%28v=vs.92%29.aspx)。我希望它有帮助

# objective-c - 保存 void*/指针的 Objective-C 数据类型是什么？

> ID：12127470
> 
> 赞同：0
> 
> 时间：2012-08-26T03:49:04.587
> 
> 标签：objective-c, pointers

我正在调用一个 C 方法，它返回一个指向资源的指针或“句柄”。我只需要保留 void* 以便稍后再次传递它。

在 .NET 中，我可能会使用 IntPtr。IntPtr 和只是一个 int 之间的唯一区别——除了使指针成为更强类型的变量——是 IntPtr 自动是平台的大小（32 位或 64 位）。我在 Objective-C 中寻找同样的东西。

是否有一些等效的方法可以在 Objective-C 中包装指针？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T03:54:31.203

你看过 NSValue 的`+ (NSValue *)valueWithPointer:(const void *)aPointer`吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-26T03:54:49.907

由于 Objective-C 是 C 的超集，您可以简单地使用`void *`.

# c - 加号 (++) 运算符应用于结构时的行为是什么？

> ID：12127471
> 
> 赞同：4
> 
> 时间：2012-08-26T03:49:51.057
> 
> 标签：c, struct, arduino

我正在尝试通过玩 Arduino Uno 来学习 C。我正在[github 上查看 Colorduino 库的代码](https://github.com/lincomatic/Colorduino)。我想知道`++`应用于结构时如何工作。

[Colorduino.h](https://github.com/lincomatic/Colorduino/blob/master/libraries/Colorduino/Colorduino.h)`PixelRGB`中定义了一个结构：

```
typedef struct pixelRGB {
  unsigned char r;
  unsigned char g;
  unsigned char b;
} PixelRGB; 
```

在[Colorduino.cpp](https://github.com/lincomatic/Colorduino/blob/master/libraries/Colorduino/Colorduino.cpp)中有一些代码将`++`运算符应用于`PixelRGB`指针。这是如何运作的？

```
for (unsigned char y=0;y<ColorduinoScreenWidth;y++) {
  for(unsigned char x=0;x<ColorduinoScreenHeight;x++) {
    p->r = R;
    p->g = G;
    p->b = B;
    p++;
  }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T03:55:25.323

请注意，此代码增加指向 的**指针**，`PixelRGB`而不是结构本身。因此，`++`当应用于指针时，结果只是将其值增加`sizeof(PixelRGB)`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-26T03:55:07.860

`p`是一个指针，而不是一个结构，所以它的工作原理就像指针算术对任何类型所做的那样。指针的值是一个地址。因此，例如，当您添加`n`一个指针时，它的值会发生变化并指向一个新地址`n * sizeof type`。所以...

```
char *p = malloc(SOME_NUMBER * sizeof char);
p++;     // p = p + sizeof char
p += 4;  // p = p + sizeof char * 4 
```

如果你有一个结构......

```
typedef struct {
    int a;
} foo;

/* ... */

foo *fp = malloc(SOME_NUMBER * sizeof foo);
fp++;    // fp = fp + sizeof foo;
fp += 4; // fp = fp + sizeof foo * 4; 
```

# python - 正则表达式替换中的Python转义字符串

> ID：12127472
> 
> 赞同：1
> 
> 时间：2012-08-26T03:50:44.370
> 
> 标签：python, regex, escaping

下面代码的输出：

```
rpl = 'This is a nicely escaped newline \\n'
my_string = 'I hope this apple is replaced with a nicely escaped string'
reg = re.compile('apple')
reg.sub( rpl, my_string ) 
```

..是：

```
'I hope this This is a nicely escaped newline \n is replaced with a nicely escaped string' 
```

..所以打印时：

> 我希望这是一个很好的转义换行符
> 
> 被一个很好的转义字符串替换

那么当python替换另一个字符串中的'apple'时，它是在对字符串进行转义吗？现在我刚刚完成

```
reg.sub( rpl.replace('\\','\\\\'), my_string ) 
```

这安全吗？有没有办法阻止 Python 这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T04:08:21.330

来自`help(re.sub)`[强调我的]：

> 子（模式，repl，字符串，计数=0，标志=0）
> 
> > 返回通过替换 repl 替换 string 中模式的最左侧非重叠出现而获得的字符串。 **repl 可以是字符串或可调用对象；如果是字符串，则处理其中的反斜杠转义。** 如果它是可调用的，它会传递匹配对象并且必须返回要使用的替换字符串。

解决这个问题的一种方法是传递一个`lambda`：

```
>>> reg.sub(rpl, my_string )
'I hope this This is a nicely escaped newline \n is replaced with a nicely escaped string'
>>> reg.sub(lambda x: rpl, my_string )
'I hope this This is a nicely escaped newline \\n is replaced with a nicely escaped string' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:14:58.803

用于 Python`re`模块的所有正则表达式模式都是未转义的，包括搜索和替换模式。这就是为什么`r`修饰符通常与 Python 中的正则表达式模式一起使用，因为它减少了编写可用模式所需的“回击”数量。

`r`修饰符出现在字符串常量之前，基本上使所有字符`\`（字符串分隔符之前的字符除外）逐字逐句。所以`r'\\' == '\\\\'`， 和`r'\n' == '\\n'`。

把你的例子写成

```
rpl = r'This is a nicely escaped newline \\n'
my_string = 'I hope this apple is replaced with a nicely escaped string'
reg = re.compile(r'apple')
reg.sub( rpl, my_string ) 
```

按预期工作。

# xml - 针对 DTD 的 XML 验证

> ID：12127474
> 
> 赞同：2
> 
> 时间：2012-08-26T03:51:20.553
> 
> 标签：xml, xml-validation, dtd

我有这个 XML 以及一个嵌入式 DTD：

```
<?xml version="1.0" ?>
<!DOCTYPE customers [
<!ELEMENT customers (name,age,roll,sex)>
<!ELEMENT name (#CDATA)>
<!ELEMENT age (#CDATA)>
<!ELEMENT roll (#CDATA)>
<!ELEMENT sex (#CDATA)>
]>
<customers>
<name>XYZ</name>
<age>19</age>
<roll>23</roll>
<sex>M</sex>
</customers> 
```

当我尝试验证 XML 时，它向我显示了一个错误。但是，如果我将#CDATA 更​​改为#PCDATA，则验证成功。

问题 1）我没有正确解释为什么会发生这种情况。两者之间的唯一区别是：#CDATA 不会解析，而#PCDATA 会解析。在这种情况下。两个验证都应该成功吧？请解释我哪里错了，因为这个验证的输出违背了我的概念。

问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T07:05:02.937

没有`#CDATA`可用于 XML DTD 的东西。这是一个未知的关键字。这就是你得到错误的原因。

`CDATA`是在 DTD 中声明*属性时使用的关键字。*您不能将元素声明为`CDATA`（或`#CDATA`）类型。

该字符串`CDATA`也可以在 CDATA 部分 ( `<![CDATA[ ... ]]>`) 中找到，它们是完全不同的东西。它们可以在 XML 文档中用于转义`&`原本会被解释为标记的字符（例如 ）。CDATA 部分未在 DTD 中声明；它们只是在需要时使用。

如果您有诸如`<name>L&T</name>`（未包含在 CDATA 部分中的标记），那么它将被解析器拒绝。`name`如何在 DTD 中声明元素并不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T05:06:31.553

CDATA 部分以:开头`<![CDATA[`和结尾。这旨在包括您的 XML 解析器应该跳过而不解释的任何内容：重要的换行符、特殊字符、文本字符串角色中的 XML 标记。它唯一不能直接包含的是.`]]>``<sex><![CDATA[M]]></sex>``]]>`

PCDATA 被*解析*为CDATA，对应于通常的纯文本。

所以 PCDATA 是你真正需要的。

# android - 如何从上到下逐渐向下显示 ImageView

> ID：12127476
> 
> 赞同：20
> 
> 时间：2012-08-26T03:52:23.587
> 
> 标签：android, android-imageview

有没有办法从上到下逐步显示 ImageView，如下所示：

![在此处输入图像描述](../Images/a3014bcccab053e1aef546fdc65d147f.png)

对不起，糟糕的动画。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-26T06:06:39.527

我对android动画不是很熟悉，但是一种（有点hackish）的方法是将图像包装在 a 中并为其值`ClipDrawable`设置动画。`level`例如：

```
<ImageView
        android:id="@+id/imageView1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:src="@drawable/clip_source" /> 
```

`clip_source`可绘制对象在哪里：

```
<?xml version="1.0" encoding="utf-8"?>
<clip xmlns:android="http://schemas.android.com/apk/res/android"
    android:clipOrientation="vertical"
    android:drawable="@drawable/your_own_drawable"
    android:gravity="bottom" /> 
```

然后在代码中您将拥有：

```
// a field in your class
private int mLevel = 0;

ImageView img = (ImageView) findViewById(R.id.imageView1);
mImageDrawable = (ClipDrawable) img.getDrawable();
mImageDrawable.setLevel(0);
mHandler.post(animateImage); 
```

是`animateImage`一个`Runnable`对象：

```
private Runnable animateImage = new Runnable() {

        @Override
        public void run() {
            doTheAnimation();
        }
    }; 
```

和`doTheAnimation`方法：

```
private void doTheAnimation() {
    mLevel += 1000;
    mImageDrawable.setLevel(mLevel);
    if (mLevel <= 10000) {
        mHandler.postDelayed(animateImage, 50);
    } else {
        mHandler.removeCallbacks(animateImage);
    }
} 
```

# linq - LINQ to SQL 与实体框架的关系

> ID：12127479
> 
> 赞同：0
> 
> 时间：2012-08-26T03:53:10.903
> 
> 标签：linq, entity-framework, orm

到目前为止我的理解是：

实体框架使使用 LINQ to SQL 变得更容易。它会自动为我们生成实体类型。

我刚开始学习LINQ。所以上面的说法很有可能是错误的。你能分享你的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T03:57:17.143

Entity Framework 和 Linq to Sql 之间没有关系。它们是两种完全不同的技术。

Entity Framework 比 Linq to SQL 更高级，需要更多知识才能上手。

微软不再更新 Linq to SQL，它们的前进方向是实体框架。但是仍然支持 Linq to SQL。

# eclipse - 在宏中检测 Eclipse (CDT) 环境

> ID：12127481
> 
> 赞同：0
> 
> 时间：2012-08-26T03:53:45.713
> 
> 标签：eclipse, macros, eclipse-cdt, stub

我正在为嵌入式目标进行编译，并且我的编译器理解一些非标准宏。我想为 Eclipse 定义一些“存根”宏（这样它就不会用虚假的警告来纠缠我）。

我想要类似的东西：

```
#ifdef ECLIPSE_ENVIRONMENT
void __WFI_STUB(void) {} 
#define __WFI __WFI_STUB
#endif 
```

所以在我的代码中（编译得很好），

```
__WFI(); 
```

Eclipse 不会因为一个未解决的函数而惊慌失措。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T03:55:46.680

啊。

```
#ifdef __CDT_PARSER__
// do stuff
#endif 
```

# windows-phone-7 - wp7布局不规则怎么办？

> ID：12127483
> 
> 赞同：1
> 
> 时间：2012-08-26T03:54:08.553
> 
> 标签：windows-phone-7, layout

见这张[图表](https://skydrive.live.com/#cid=F3570949E7DCDDD4&id=F3570949E7DCDDD4%21303)

## 规则：

## 车1车2

## 车3车4

如果新闻有图像，则使用 car1 和 car3 布局；没有图像，使用 car2 或 car3 布局。如果新闻有大图，那么它的高度等于 car1 高度 + car3 高度或 car2 高度+car4 高度

我的问题：如何使用列表框处理不规则布局`WP7`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T18:20:02.047

您的问题没有直接的答案。很快，你不能轻易做到。也就是说，标准库（例如 Grid 或 Stackpanel 之类的东西）没有“不规则”的布局管理器。也许那里有第 3 方图书馆，但我不知道。如果没有开箱即用的东西，您有 2 个选项：

*   使每个列表框项目成为 2x2 网格，然后在相邻单元格的行跨度增加到 2 时隐藏单元格内容的一些逻辑。反之亦然，当大图块变为较小的图块时，您必须更改行跨度并隐藏瓷砖再次可见。我正在考虑在此处折叠或使其可见作为一种效果。但是，您当然可以删除该图块并将其附加到列表的末尾。您希望列表的行为方式有很多选择。
*   您可以考虑在滚动查看器中使用 WrapPanel（来自 silverlight 工具包）来实现类似的效果。同样，您还必须在这里做一些工作来重新组织容器。

# ruby-on-rails - 这容易发生SQL注入吗？

> ID：12127496
> 
> 赞同：3
> 
> 时间：2012-08-26T03:56:42.030
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controller, sql-injection

在我的控制器操作中，我有以下内容：

```
def index
    @articles = (params[:mine] == "true") ? current_user.articles : Article.search(params[:search])
    @articles = @articles.sort! { |a,b| b.created_at <=> a.created_at }
    @articles = Kaminari.paginate_array(@articles).page(params[:page]).per(25)

    respond_to do |format|
      format.html
      format.json { render json: @articles }
    end
end 
```

在模型中：

```
 def self.search(search)
    if search.present?
      where("category LIKE ? OR article_type LIKE ?", "%#{search}%","%#{search}%")
    else
      find(:all)
    end
  end 
```

我知道如果您直接在查询中使用参数，则可以进行 SQL 注入。在这里，我将参数直接传递给 where 查询`Article.search(params[:search])`。这容易发生SQL注入吗？如果是，我怎样才能使它更安全？我也怀疑我是否正确编写了控制器代码。如果您对重构控制器代码有任何建议，请告诉我，我们将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T04:40:57.647

对于您的查询，您应该尝试使用提供的方法`ActiveRecord`或通过`Arel`自身（尽管您当前的方法很好）。这将确保您的 SQL 被正确转义。如果您现在不想详细介绍`Arel`，可以使用[squeel](https://github.com/ernie/squeel)或[meta_where 之](https://github.com/ernie/meta_where)类的 gem （对于较旧的导轨）。

我强烈推荐这些 gem 来满足您的大多数查询构建需求。任何更高级的内容，您都可以直接使用`Arel`.

我不记得了，如果您可以在没有 gem 帮助的情况下直接以基本语法执行`matches`( )。但是你绝对可以直接在.`LIKE``ActiveRecord.where``Arel`

```
articles = Article.arel_table
articles = articles[:category].matches("%#{search}%").
  or(articles[:article_type].matches("%#{search}%")) 
```

此时，您可以使用`to_a`on`articles`或 use`to_sql`并将其传递给您的`Article`模型`find_by_sql`。

```
Article.find_by_sql articles.to_sql 
```

[will_paginate](https://github.com/mislav/will_paginate/wiki/)有一个`paginate_by_sql`方法，我假设`kaminari`也会有一个（或者至少我认为它会）。

至于您的控制器代码，如果可能的话，我会将任何类型的排序选项传递给数据库（这也适用于您的分页）。

```
articles.sort('`articles`.created_at DESC') 
```

您现在使用的方法将获取“所有”[允许的]记录然后排序，然后返回您的`per_page`限制。在这种情况下，哪种方式完全违背了分页的目的。

至少，尝试将您当前的设置重构为：

```
@articles = (params[:mine] == "true") ? current_user.articles : Article.search(params[:search])
@articles = @articles.sort('`articles`.created_at DESC').page(params[:page]).per(25) 
```

只要您传递一个，`ActiveRelation`您就可以将其他东西绑定到这个，因为 Rails 将它的查询延迟加载到数据库的方式。

# c# - 从 C# 中的静态方法访问文本框？

> ID：12127498
> 
> 赞同：0
> 
> 时间：2012-08-26T03:57:30.490
> 
> 标签：c#, forms, static

我有 2 个课程：MyForm 和 Database

在 MyForm 中，我有一种方法可以更改标签文本以显示错误：

```
public void printError(string text){
    label1.Text = text;
} 
```

我的 Database 类也需要访问该方法，所以我将其设为静态：

```
public static void printError(MyForm form, string text){
    form.label1.Text = text;
} 
```

现在的问题是，**我如何从 Database 类中调用该方法**？

[我发现的这个问题](https://stackoverflow.com/questions/952023/in-c-sharp-net-how-does-one-access-a-control-from-a-static-method)说我需要像这样将 MyForm 传递给数据库的构造函数：

```
class MyForm : Form{
    Database db;
    public Form(){
        db = new Database(this);
    }
}

class Database{
    MyForm form;
    public Database(MyForm f){
        form = f;
    }
    ...
    //then I can access the printError like this
    MyForm.printError(form, "You got error");
} 
```

我试过了，它**冻结了表格**。还有其他解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T04:15:55.820

就像@Matthew Ferreira 和其他人所说的设计不是想法，但这里有一些东西可以让你开始。

```
class MyForm : Form
{
    public void SomeMethod()
    {
        var dataAccess = new Repository();

        dataAccess.ExecuteQuery();

        if (dataAccess.Exceptions.Any())
        {
            // display your error messages
            form.label1.Text = dataAccess.Exceptions.Select(x => x.ToString());
        }
    }
}

class Repository
{
    private readonly HashSet<Exception> _exceptions = new HashSet<Exception>();

    public IEnumerable<Exception> Exceptions
    {
        get { return _exceptions; }
    }

    public int ExecuteQuery()
    {
        var numberOfRecordsAffected = 0;

        try
        {
            // do something
        }
        catch (Exception ex)
        {
            // normall catching exceptions is a bad idea
            // and you should really catch the exception at the 
            // layer best equiped to deal with it
            _exceptions.Add(ex);
        }

        // but, for the purpose of this example we might want to add some logic to try the query on another database ????
        try
        {
            // do something
        }
        catch (Exception ex)
        {
            _exceptions.Add(ex);
        }

        return numberOfRecordsAffected;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T04:17:38.287

这是一个非常简单的示例，说明如何在您的数据层不知道您的 UI 的情况下实现此目的：

```
class MyForm : Form
{
    Database db;

    public Form()
    {
        db = new Database(this);
    }

    public void DoSomething()
    {
        var errors = db.Login("", "");
        if (errors.Any())
            label1.Text = errors.First(); // Or you can display all all of them
    }
}

class Database
{    
    public List<string> Login(string username, string password)
    {
        var errors = new List<string>();

        if (string.IsNullOrEmpty(username))
            errors.Add("Username is required");

        if (string.IsNullOrEmpty(password))
            errors.Add("Password is required");

        [...]

        return errors;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T04:21:45.820

您需要查找“关注点分离”。将您的 UI 代码与数据库访问层 (DAL) 混合在一起真的很糟糕。最好将 UI 绑定到通过 DAL 填充的业务对象。

要让 UI 知道错误，您可以简单地使用委托。

```
namespace OperationErrorDelegate
{
    public delegate void OperationErrorHandler(Exception ex);

    public class DAL
    {
        public event OperationErrorHandler ReportError;

        public void DoDALOperationThatCausesError()
        {
            try
            {
                int i = 1;
                int j = 0;
                int k = i/j;
            }
            catch (Exception ex)
            {
                ReportError(ex);
            }
        }
    }
} 
```

将此代码添加到表单中：

```
using System ;
using System.Windows.Forms;

namespace OperationErrorDelegate
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            DAL DAL = new DAL();
            DAL.ReportError += new OperationErrorHandler(DAL_OperationErrorProgress);
            DAL.DoDALOperationThatCausesError();
        }

    private void DAL_OperationErrorProgress(Exception ex)
    {
        label1.Text = ex.Message;
    }
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T04:42:16.343

假设 OP 的要求是在凭证错误时在标签中显示错误消息：

```
 private void btn_login_Click(object sender, EventArgs e)
    {
         MySqlConnection con = new MySqlConnection("server=localhost;uid=root;password=abc;database=mydb");
         MySqlCommand cmd = new MySqlCommand("select * from emp where name='" + textBox1.Text + "'and pwd='" + textBox2.Text + "'",con);
         con.Open();
         MySqlDataReader dr = cmd.ExecuteReader();

        if (dr.Read()) 
        {    //successful
            //navigate to next page or whatever you want
        }
        else
            Label1.Text("Invalid userid or password");
        con.Close();
    } 
```

如果需要`error message for wrong data type (the user input string but the database column is Integer)`，请在客户端使用验证。您不需要在后端执行此操作，因为这将是一个负担。您可以在其`button_click`本身中使用正则表达式。

# fonts - 在脚本中动态更改字体颜色

> ID：12127499
> 
> 赞同：0
> 
> 时间：2012-08-26T03:57:35.083
> 
> 标签：fonts

任何想法如何更改结果行中链接文本的字体颜色？未链接的文本从黑色变为白色，但突出显示的行中的链接文本保持黑色。也需要它变白。

```
var INTENDED_MONTH = 7 //August
// INTENDED_MONTH is zero-relative
now = new Date().getDate(),
rows = document.getElementById('scripture').rows;
if (new Date().getMonth() != INTENDED_MONTH) {
    // need a value here less than 1, or the box for the first of the month will be in Red
    now = 0.5
};
for (var i = 0, rl = rows.length; i < rl; i++) {
    var cells = rows[i].childNodes;
    for (j = 0, cl = cells.length; j < cl; j++) {
        if (cells[j].nodeName == 'TD'
  && cells[j].firstChild.nodeValue != ''
  && cells[j].firstChild.nodeValue == now) {
            rows[i].style.backgroundColor = 'red' // 'ffff99' // '#ffd700' // TODAY - red
            rows[i].style.color = 'white'
      $('html,body').delay(500).animate({scrollTop:rows[i].offsetTop}, 2000);
        }
    }
}​ 
```

# ios - 通过 avfoundation 偏移时间码

> ID：12127502
> 
> 赞同：1
> 
> 时间：2012-08-26T03:58:59.290
> 
> 标签：ios, cocoa, avfoundation

有什么方法可以使用 AVFoundation 以某种方式访问​​或构建 QuickTime 电影的“偏移时间码”（或开始时间码）？

我设法获取此信息的唯一方法是通过时间码 QTTrack 的 QTMedia 上的 TCGetCurrentTimeCode() 使用 QTKit 和 QuickTime。然而 Quicktime 不是 64 位的，如果可能的话，我宁愿使用 AVFoundation。

[aAVAsset track] 让我获得了 AVAssetTrack 的句柄，表示保存此信息的时间码轨道。我通过 formatdescription 探索了可用信息，但似乎没有任何帮助，而且我也找不到任何方法来访问时间码轨道的原始数据。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T23:50:26.140

我相信这可能是我最近遇到的一个问题的欺骗。我希望这能解决你的问题！

[如何在 64 位的 Objective-C 中获取 Quicktime-Movie 的开始时间码 (SMPTE)？](https://stackoverflow.com/questions/12083325/how-to-get-the-start-timecode-smpte-of-a-quicktime-movie-in-objective-c-in-64)

# html - HTML 中的特殊字符

> ID：12127506
> 
> 赞同：0
> 
> 时间：2012-08-26T04:00:07.500
> 
> 标签：html, ios, unicode, playing-cards, character-entities

我正在为 iOS 创建 html 页面，我需要在其中放置“♠、♥、♦ 和 ♣”。这些是卡片符号。

但由于这不是普通文本，iPhone 上的文本会以异常文本的形式出现。请建议我在我的 html 代码中使用这些符号的 html 代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T07:31:07.183

如果您将♠、♥、♦ 和♣ 等字符放入 HTML 文档中，则需要确保文档的声明编码与实际编码一致。通常，编码应为 UTF-8。请参阅 W3C 文档[在 HTML 中声明字符编码](http://www.w3.org/International/questions/qa-html-encoding-declarations)。

使用实体引用之类的可以`&spades;` *规避*问题，但*解决方案*是修复编码问题。如果现在或在下次编辑文档之后还有*其他特殊字符怎么办。*并且一个字符不需要比简单的大撇号 (') 更特殊来创建编码问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T04:04:15.907

您可以使用等效的 html 实体 ♥ `&hearts;`♠ `&spades;`♣ `&clubs;`♦`&diams;`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-26T04:05:27.633

```
&spades;    ♠   Spade card suit
&clubs;         ♣   Clubs card suit
&diams;         ♦   Diamonds card suit
&hearts;    ♥   Hearts card suit 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-26T04:05:36.560

您是否尝试过以下方法：

```
♠   &#9824;
♣   &#9827;
♥   &#9829;
♦   &#9830; 
```

[从此参考页面](http://www.w3schools.com/tags/ref_symbols.asp)获取代码。

# jquery - 防止父元素滚动

> ID：12127507
> 
> 赞同：0
> 
> 时间：2012-08-26T04:00:11.100
> 
> 标签：jquery, html, css, scroll

> **可能重复：**
> [防止父元素滚动？](https://stackoverflow.com/questions/5802467/prevent-scrolling-of-parent-element)

假设我有两个元素：

```
<div id="parent">
<div id="child">
Hello
</div>
</div> 
```

两个元素都有溢出-y：滚动。当我在里面滚动`#child`时，当我到达滚动的底部时，**滚动`#parent`启动**。这就是我试图阻止的。`#parent`当我的鼠标在元素中时，我不想滚动`#child`元素。

# c++ - 如何从具有指针的结构数组中删除元素？

> ID：12127511
> 
> 赞同：3
> 
> 时间：2012-08-26T04:01:13.483
> 
> 标签：c++, c, arrays, data-structures

这是我的结构，它有两个整数指针 aV 和 aT。

```
struct ADJP
{
    int *aV;
    int eV;
    int nV;
    int *aT;
    int nT;
};
ADJP *Umb = NULL; 
```

aV和aT的分配过程是这样的..

```
 for(int i=0; i<nb; i++)
    {
        Umb[i].aV = new int[N];
        for(int j=0; j<n; j++)
            Umb[i].aV[j] = pIn[i].aV[j];
} 
```

我想从 Umb 数组中删除一个特定元素。例如我想删除 Umb[5]，那么我该如何删除。我尝试过各种数学方法，但由于我认为分配的指针而出错。我尝试过使用 follow 方法，但它不适用于这种结构数组。它正在使用没有指针的结构数组。

```
int DeleteStructElement(int Index, ADJP *b, int N, int at)
{
    for(int i=Index; i<N-1; i++)
        memmove(&b[i], &b[i+1], (N-at-1)*sizeof*b);     // moving the terms of array
    N--;                                                // updating new size
    return N;
} 
```

知道如何从我的结构数组中删除一个元素吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T04:09:26.443

您将需要删除已删除元素中的数组以释放它们的内存：

```
delete[] b[Index].aV;
delete[] b[Index].aT; 
```

然后，您只需执行一次 memmove 即可删除该元素。

```
memmove(&b[Index], &b[Index+1], (N-Index-1) * sizeof(b[Index]) 
```

编辑：正如 Mahmoud 指出的，这不使用`at`参数 in `DeleteStructElement`; 我不确定您打算使用该参数做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T04:12:23.873

```
 int DeleteStructElement (int index, ADJP * b, int nb) {
      delete [] (b[index].aV);
      for (int i = index; i < nb - 1; ++i) {
         b[i] = b[i+1];
      }
      return nb - 1;
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T04:13:17.070

假设您真的在使用 C++，那么 in 中的析构函数`ADJP`将比`DeleteStructElement`.

但是如果你正在用`new`/做一些有趣的“C” `delete`（也许是 C++ 的一个严格的子集？），那么我建议`delete`从inside 调用`DeleteStructElement`。

> 但我认为由于分配的指针而出错

回答这个问题可能比其他问题重要得多。我假设这是一个运行时错误？使用调试器准确找出故障所在。

# iphone - 从超级视图中删除后保持图像在视图中

> ID：12127530
> 
> 赞同：1
> 
> 时间：2012-08-26T04:07:02.073
> 
> 标签：iphone, objective-c, ios, cocoa-touch, catiledlayer

我从 Apple 的 PhotoScroller 示例代码中提取了一些代码以使用`CATiledLayer`. 我有一张从互联网上加载的 8000x7000px 的图像，在瓷砖中。

这是我的应用程序中的一种地图功能。我还有两个几乎相同的图像，具有不同的叠加层（尝试仅添加叠加层而没有运气）。

我必须`UISegmentedControl`在三个选项之间切换，并且我希望 imageView 从所选图像中加载图像。因此，如果用户放大其中一个图像并选择另一个选项，则比例和坐标保持不变，并且 imageView 将所选图像加载到必要的平铺点中。

我已经部分管理了这一点。或者，我实际上已经做到了这一点，但是当我选择另一个选项时，调用该函数时整个屏幕变黑`[imageView removeFromSuperview];`。在几秒钟内变黑（取决于互联网速度）后，它会显示正确的瓷砖。

如果可能，我希望图层“淡入”到下一层。您可能知道，在使用 时`CATiledLayer`，第一层是低分辨率的整个图像，但在放大时，必要的图块“淡入”到具有较小图块的下一层。

我基本上需要给出`(TilingView*)imageView`一个“重新加载”命令，并希望它在最后一张图像上“淡出”。

我试图注释掉`[imageView removeFromSuperview];`，这实际上让我接近了我想要的。当我放大并选择另一个选项时，新图像实际上淡化了旧图像，但是，当我缩小时，旧图像明显停留在背景中（在新图像后面），没有任何反应。稍后我需要将其从 superView 中删除，但我无法再访问它，因为新图像已取代了 imageView 的位置。我知道人们可能想在这里查看代码，但我真的不知道要显示什么代码。而且记录得`CATiledLayer`太差了，我真的很难理解发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:38:24.587

我通过一些粗略的代码使它工作。可能还有其他更好的解决方案，但这是我目前知道的唯一一个。

问题是当我删除时`[imageView removeFromSuperview];`，它并没有卸载最后一张图像，因此让它永远存在于内存中。由于它不受缩放和滚动的影响，所以当我缩小时，它总是在后台。如果我要在选项之间切换多次，多张图片会在背景中叠加。

我只是创建了一个“ `helper`”，正如我所说的那样。一个 new `imageView`，它在切换选项时获取旧的内容`imageView`，而不是将其从超级视图中删除，因为当新图像尚未加载时，过早删除会导致黑屏。

我现在调用`[helper removeFromSuperview];`委托方法`scrollViewWillBeginZooming`和 in `scrollViewWillBeginDragging`。这导致在单击另一个选项和用户滚动或缩放之间的时间内，内存最多包含两个图像。

注意：如果用户在切换选项后立即滚动或缩放`UISegmentedControl`，它会变成黑色，因为新图像尚未加载。

# java - 如何从 httpservletrequest 获取多方

> ID：12127531
> 
> 赞同：5
> 
> 时间：2012-08-26T04:07:16.117
> 
> 标签：java, web-services, spring, apache, tomcat

我正在尝试从 java spring 控制器调用 web 服务。下面是代码

```
private void storeImages(MultipartHttpServletRequest multipartRequest) {
    DefaultHttpClient httpClient = new DefaultHttpClient();
    HttpPost postRequest = new HttpPost(
                    "http://localhost:8080/dream/storeimages.htm");
    MultipartFile multipartFile1 = multipartRequest.getFile("file1");
    MultipartEntity multipartEntity = new MultipartEntity(
                    HttpMultipartMode.BROWSER_COMPATIBLE);
    multipartEntity.addPart("file1",
                    new ByteArrayBody(multipartFile1.getBytes(),
                                    multipartFile1.getContentType(),
                                    multipartFile1.getOriginalFilename()));
    postRequest.setEntity(multipartEntity);
    HttpResponse response = httpClient.execute(postRequest);
    if (response.getStatusLine().getStatusCode() != 201) {
        throw new RuntimeException("Failed : HTTP error code : "
                        + response.getStatusLine().getStatusCode());
    }
} 
```

以上只是部分代码。我正在尝试确定如何在服务器端检索它。在服务器端，我有以下 Spring 控制器代码

```
@RequestMapping(value = "/storeimages.htm", method = RequestMethod.POST)
public ModelAndView postItem(HttpServletRequest request,
                HttpServletResponse response) {
    logger.info("Inside /secure/additem/postitem.htm");
    try {
        // How to get the MultipartEntity object here. More specifically i
        // want to get back the Byte array from it
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    return new ModelAndView("success");
} 
```

我执行了这段代码，我的控制权转移到了服务器端。但我被困在如何从多方对象中取回字节数组。

编辑要求：这是要求。用户从网站上传图像（已完成并正常工作） 表单提交后控件转到 Spring 控制器（已完成并正常工作） 在 Spring 控制器中，我使用 Multipart 来获取表单的内容。（这已经完成并且正在工作）现在我想调用一个 Web 服务，它将图像字节数组发送到图像服务器。（这需要完成）在图像服务器上，我想接收这个 Web 服务请求从 HTTPServlerRequest 获取所有字段，存储图像并返回（这个需要做）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T21:07:43.807

终于解决了。这对我有用。

客户端

```
private void storeImages(HashMap<String, MultipartFile> imageList) {
    try {
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost postRequest = new HttpPost("http://localhost:8080/dream/storeimages.htm");

        MultipartEntity multipartEntity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);

        Set set = imageList.entrySet(); 
        Iterator i = set.iterator(); 
        while(i.hasNext()) { 
            Map.Entry me = (Map.Entry)i.next(); 
            String fileName = (String)me.getKey();
            MultipartFile multipartFile = (MultipartFile)me.getValue();
            multipartEntity.addPart(fileName, new ByteArrayBody(multipartFile.getBytes(), 
                    multipartFile.getContentType(), multipartFile.getOriginalFilename()));
        } 
        postRequest.setEntity(multipartEntity);
        HttpResponse response = httpClient.execute(postRequest);

        if (response.getStatusLine().getStatusCode() != 200) {
            throw new RuntimeException("Failed : HTTP error code : "
                    + response.getStatusLine().getStatusCode());
        }

        BufferedReader br = new BufferedReader(new InputStreamReader((response.getEntity().getContent())));

        String output;
        while ((output = br.readLine()) != null) {
            logger.info("Webservices output - " + output);
        }
        httpClient.getConnectionManager().shutdown();
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

服务器端

```
@RequestMapping(value = "/storeimages.htm", method = RequestMethod.POST)
public void storeimages(HttpServletRequest request, HttpServletResponse response)
{
    logger.info("Inside /secure/additem/postitem.htm");
    try
    {
        //List<Part> formData = new ArrayList(request.getParts());
        //Part part = formData.get(0);
        //Part part = request.getPart("file1");
        //String parameterName = part.getName();
        //logger.info("STORC IMAGES - " + parameterName);
        MultipartHttpServletRequest multipartRequest = (MultipartHttpServletRequest) request;

        Set set = multipartRequest.getFileMap().entrySet(); 
        Iterator i = set.iterator(); 
        while(i.hasNext()) { 
            Map.Entry me = (Map.Entry)i.next(); 
            String fileName = (String)me.getKey();
            MultipartFile multipartFile = (MultipartFile)me.getValue();
            logger.info("Original fileName - " + multipartFile.getOriginalFilename());
            logger.info("fileName - " + fileName);
            writeToDisk(fileName, multipartFile);
        } 
    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
}

public void writeToDisk(String filename, MultipartFile multipartFile)
{
    try
    {
        String fullFileName = Configuration.getProperty("ImageDirectory") + filename;
        FileOutputStream fos = new FileOutputStream(fullFileName);
        fos.write(multipartFile.getBytes());
        fos.close();
    }
    catch (Exception ex)
    {
        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T05:01:48.797

在我的项目中，我们曾经使用com.oreilly.servlets 中的[MultipartParser](http://www.servlets.com/cos/javadoc/com/oreilly/servlet/multipart/MultipartParser.html)来处理`HttpServletRequests`对应的`multipart`请求，如下：

```
// Should be able to handle multipart requests upto 1GB size.
MultipartParser parser = new MultipartParser(aReq, 1024 * 1024 * 1024);
// If the content type is not multipart/form-data, this will be null.
if (parser != null) {
    Part part;
    while ((part = parser.readNextPart()) != null) {
        if (part instanceof FilePart) {
            // This is an attachment or an uploaded file.
        }
        else if (part instanceof ParamPart) {
            // This is request parameter from the query string
        }
    }
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-26T06:56:26.013

您可以使用 Springs Mutlipart 支持，而不是手动完成所有这些操作

控制器可以像这样工作（这个例子使用一个命令对象来存储额外的用户输入——（这是一个来自工作项目的例子））。

```
@RequestMapping(method = RequestMethod.POST)
public ModelAndView create(@Valid final DocumentCreateCommand documentCreateCommand,
        final BindingResult bindingResult) throws IOException {
    if (bindingResult.hasErrors()) {
      return new ModelAndView("documents/create", "documentCreateCommand", documentCreateCommand);            
    } else {            
        Document document = this.documentService.storeDocument(
               documentCreateCommand.getContent().getBytes(),
               StringUtils.getFilename(StringUtils.cleanPath(documentCreateCommand.getContent().getOriginalFilename())));
               //org.springframework.util.StringUtils

        return redirectToShow(document);
    }
}

@ScriptAssert(script = "_this.content.size>0", lang = "javascript", message = "{validation.Document.message.notDefined}")
public class DocumentCreateCommand {
    @NotNull private org.springframework.web.multipart.MultipartFile content;       
    Getter/Setter
} 
```

要启用 Spring Multipart 支持，您需要配置一些东西：

web.xml（在 CharacterEncodingFilter 之后和 HttpMethodFilter 之前添加 org.springframework.web.multipart.support.MultipartFilter）

```
 <filter>
    <filter-name>MultipartFilter</filter-name>
    <filter-class>org.springframework.web.multipart.support.MultipartFilter</filter-class>
    <!-- uses the bean: filterMultipartResolver -->
</filter>

<filter-mapping>
    <filter-name>MultipartFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

在您的应用程序的 CORE（不是 MVC Servlet）的 Spring 配置中添加这个

```
<!-- allows for integration of file upload functionality, used by an filter configured in the web.xml -->
<bean class="org.springframework.web.multipart.commons.CommonsMultipartResolver" id="filterMultipartResolver" name="filterMultipartResolver">
     <property name="maxUploadSize" value="100000000"/>
</bean> 
```

然后你还需要 commons fileupload 库，因为 Spring MultipartFile 只是某种 Addapter

```
<dependency>
     <groupId>commons-fileupload</groupId>
      <artifactId>commons-fileupload</artifactId>
      <version>1.2.1</version>
</dependency> 
```

有关更多详细信息：@参见[Spring 参考，第 15.8 章 Spring 的多部分（文件上传）支持](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-multipart)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-29T14:21:49.473

处理spring文件到控制器。您需要在您的 app-config.xml 中指明如下：

```
 <bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver"/> 
```

并将代码处理如下

```
 MultipartEntityBuilder paramsBuilder = MultipartEntityBuilder.create();
    Charset chars = Charset.forName("UTF-8");
    paramsBuilder.setCharset(chars);

    if (null != obj.getFile()){
    FileBody fb = new FileBody(obj.getFile());
    paramsBuilder.addPart("file", fb);
    } 
```

这对于红色多部分

```
private File getFile(MultipartFile file) {

    try {
        File fichero = new File(file.getOriginalFilename());
        fichero.createNewFile();
        FileOutputStream fos = new FileOutputStream(fichero);
        fos.write(file.getBytes());
        fos.close();
        return fichero;
    } catch (Exception e) {
        return null;
    }

} 
```

我希望这有帮助。

# parsing - 我想写一个编译器；你推荐什么程序集（x86）/后端？使用 BISON 还是不使用？

> ID：12127548
> 
> 赞同：2
> 
> 时间：2012-08-26T04:12:36.913
> 
> 标签：parsing, assembly, compiler-construction, code-generation, bison

我正在编写一个非常简单和小型的编译器（我自己，我没有做任何课程或任何事情）。我需要帮助来做一些决定。第一步（我相信），我需要了解汇编到代码生成（对吗？）。我正在为它寻找*更好*的汇编语言。在易于编码/理解良好的后端支持等方面更好。我已经阅读了[`HOWTO assembly by LPD`](http://tldp.org/HOWTO/Assembly-HOWTO/)有几个程序集的地方；但我真的对 AT&T 代码生成很感兴趣。事实上，我对生成 AT&T 代码的 GNU/Linux、GCC 和类似 GCC 的编译器很熟悉。

你还有其他建议吗？如果可能，请解释 AT&T 语法和后端（如果有）的优势。

对于一个以前从未编写过编译器的人来说，如果没有 BISON 或类似的东西就太复杂了？我想通过使用来做到这一点[`recursive descent parser`](http://en.wikipedia.org/wiki/Recursive_descent_parser)（例如，DMR 和 gcc 4.6>，而 TCC 确实如此）。另外，因为它是我的第一个编译器（对于非基本类和汇编），我认为在 BISON 的帮助下这样做是错误的。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T04:16:33.263

您是否考虑过将其写入 JVM？它存在于您的平台上，并且（我想？）将比原始机器 ASM 更容易使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T04:32:46.183

首先，AT&T 与英特尔*只是*语法问题。底层平台功能由硬件架构决定，而不是由语法决定。如果您希望编译器具有可移植性，则需要支持多种架构，但您使用的语法可以保持不变。如果您使用 AT&T 语法，您仍然需要为 x86 和 ARM 生成不同的代码。每种架构只有一种汇编语言。例如，这里先在 Intel 中添加两个数字，然后在 AT&T 中添加：

```
mov eax, 1
mov ebx, 2
add eax, ebx 
```

和：

```
movl $1, %eax
movl $2, %ebx
addl %ebx, %eax 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T04:27:49.573

[antlr](http://www.antlr.org/)是另一个值得研究的软件包，我发现它比 flex 和 bison 更容易使用。它还带有一个编辑器，使该过程更加容易。您可以使用它为多种语言生成解析器，flex 和 bison 是基于 c/c++ 的。使用 antlr 时，您还可以在一个文件中定义语法和解析规则，使用 flex 和 bison，您必须创建 .l 和 .y/.ypp 文件，当涉及到每个文件中的内容时，这会变得非常混乱。

我对汇编知之甚少，但是[Coursera](https://www.coursera.org/)上有一个关于编译器的免费课程，教授有关解析代码并将其编译为汇编的知识。一探究竟

# cocos2d-iphone - 在 cocos2d 上使用 RGBA5555？

> ID：12127549
> 
> 赞同：1
> 
> 时间：2012-08-26T04:12:40.750
> 
> 标签：cocos2d-iphone

如何在 cocos2d 上使用 RGBA5555 像素格式？

我像这样定义我的像素格式：

```
[CCTexture2D setDefaultAlphaPixelFormat:kTexture2DPixelFormat_RGBA4444]; 
```

我发现了这些：

```
// Available textures 
// kCCTexture2DPixelFormat_RGBA8888 - 32-bit texture with Alpha channel
// kCCTexture2DPixelFormat_RGB565 - 16-bit texture without Alpha channel
// kCCTexture2DPixelFormat_A8 - 8-bit textures used as masks
// kCCTexture2DPixelFormat_I8 - 8-bit intensity texture
// kCCTexture2DPixelFormat_AI88 - 16-bit textures used as masks
// kCCTexture2DPixelFormat_RGBA4444 - 16-bit textures: RGBA4444
// kCCTexture2DPixelFormat_RGB5A1 - 16-bit textures: RGB5A1
// kCCTexture2DPixelFormat_PVRTC4 - 4-bit PVRTC-compressed texture: PVRTC4
// kCCTexture2DPixelFormat_PVRTC2 - 2-bit PVRTC-compressed texture: PVRTC2 
```

但我似乎找不到 RGBA5555。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T18:31:37.523

没有 RGBA5555 格式。这相当于 5 位 = 20 位的 4 倍。这种纹理格式在任何地方都不存在。

如果您正在寻找 RGB5551，即每种 RGB 颜色 5 位和 alpha 1 位，那么您正在寻找 RGB5A1 格式。

# javascript - 是否可以从与相机无关的 three.js 场景中的某个点应用雾？

> ID：12127558
> 
> 赞同：5
> 
> 时间：2012-08-26T04:16:24.970
> 
> 标签：javascript, webgl, three.js, fog

例如，给定一个地形，上面有一个头像，头顶远处有一个摄像头：是否可以渲染雾，以便头像周围的地形消失在雾中时完全不被雾化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T00:39:59.350

当然，尽管据我所知，您必须制作自己的着色器，而不是使用 three.js 提供的着色器。可能有一种方法可以以这种方式自定义它们，但是如果有的话，我并不熟悉。

看看[这个关于做雾的答案](https://stackoverflow.com/questions/11694458/how-to-create-fog-using-open-gl-es-2-0-or-webgl)作为与相机的距离。正如那里所解释的那样，这个想法是将相机位置作为制服传递给着色器，然后在所有对象的顶点着色器中，找到从相机位置到要转换的顶点的距离。然后，您将该距离作为变量传递给片段着色器，您可以计算出每个像素的距离，您可以使用该距离在雾化颜色和对象的常规颜色之间进行混合。[您可以在 OpenGL ES 2.0 Programming guide 的这个示例](http://code.google.com/p/opengles-book-samples/source/browse/trunk/Windows/Chapter_10/RM_LinearFog/LinearFog.rfx#1020)中看到这一点。

将其更改为基于与角色的距离很简单：您只需将角色位置作为您正在计算距离而不是相机位置的制服传入（在该示例代码中，您将替换`u_eyePos`为类似的东西`u_characterPos`，也许将变化从 更改`v_eyeDist`为`v_characterDist`)。除了任何名称更改外，片段着色器可以完全相同。

所以，像这样的事情（警告：未测试。你将不得不解决这个问题，让 three.js 对使用它感到满意。不过，有很多这样的例子，比如[这个](https://github.com/mrdoob/three.js/blob/master/examples/webgl_custom_attributes.html)）：

顶点着色器：

```
uniform mat4 matViewProjection;
uniform mat4 matView;
uniform vec4 u_characterPos;

attribute vec4 rm_Vertex;
attribute vec2 rm_TexCoord0;

varying vec2 v_texCoord;
varying float v_characterDist;

void main() {
  // Transform vertex to view-space
  vec4 vViewPos = matView * rm_Vertex;

  // Compute the distance to character
  v_characterDist = length(vViewPos - u_characterPos);                  

  gl_Position = matViewProjection * rm_Vertex;
  v_texCoord    = rm_TexCoord0.xy;
} 
```

片段着色器：

```
precision mediump float;

uniform vec4 u_fogColor;
uniform float u_fogMaxDist;
uniform float u_fogMinDist;
uniform sampler2D baseMap;

varying vec2 v_texCoord;
varying float v_characterDist;

float computeLinearFogFactor() {
  float factor;

  // Compute linear fog equation
  factor = (u_fogMaxDist - v_characterDist) /
        (u_fogMaxDist - u_fogMinDist );

  // Clamp in the [0,1] range
  factor = clamp(factor, 0.0, 1.0);

  return factor;            
}

void main() {
  float fogFactor = computeLinearFogFactor();
  vec4 fogColor = fogFactor * u_fogColor;
  vec4 baseColor = texture2D(baseMap, v_texCoord);

  // Compute final color as a lerp with fog factor
  gl_FragColor = baseColor * fogFactor +
               fogColor * (1.0 - fogFactor); 
} 
```

# gsm - AT 命令 CMGS 返回 ERROR

> ID：12127562
> 
> 赞同：0
> 
> 时间：2012-08-26T04:16:43.617
> 
> 标签：gsm, modem, at-command

我正在使用 Prolink PSH300 HSUPA GSM 调制解调器连接到我的笔记本电脑并使用 tera term 来测试连接。

首先我输入 AT 它会回复我 OK

正常

AT+CMGF=1 正常

AT+CMGS="+6581XXXXXX" (然后我按回车返回错误) ERROR

有时它不会返回错误，而是挂在那里没有>返回。

有人可以建议我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T04:23:56.457

在您的端口初始化中，我建议您添加这两行 -

```
port.DiscardOutBuffer(); 
port.DiscardInBuffer(); 
```

这些将执行 PurgeComm 本机 WIN32 调用，这将重置硬件流控制线。

`DtrEnable/RtsEnable = true`在打开端口连接之前还要添加行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T19:18:00.533

场景：我的诺基亚手机通过蓝牙链接连接到电脑。命令：at (result ok), at+Cmgf=1(ok), but at+cmgs="mob.no">"hello"ctrl+z (result +cms error 500)。我通过对蓝牙调制解调器中的额外初始化设置进行小的更改来解决它。如何，我在这里解释。控制面板->电话和调制解调器->选择蓝牙调制解调器->单击属性。在打开的对话框窗口中转到高级选项卡并更改现有的额外初始化命令：从现有的任何内容到以下网站中提到的以下任何内容：cksaheb.blogspot.in/2011/03/extra-initialization-command-for- gprs.html。我发送短信的问题解决了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-01-13T17:32:04.283

我也有同样的问题。您必须检查天线连接。您的 GSM 网络无法正常工作。

# asp.net-mvc - NHibernate 是否有用于更新的内存实体

> ID：12127563
> 
> 赞同：0
> 
> 时间：2012-08-26T04:17:05.730
> 
> 标签：asp.net-mvc, nhibernate, fluent-nhibernate

我是 NHibernate 的新手。我们正在使用 Dapper 进行检索，并计划使用 NHibernate 进行 CRUD。

我试图通过一对多关系中的父列表对象删除子对象。

这在我使用 NHibernate 会话检索对象并删除该项目时有效。

```
var mercedes = Read("chevrolet"); //queries from nhibernate session
var model = mercedes.Models.Where(c => c.Id == 181).Single(); 
mercedes.Models.Remove(model); 
```

当我手动创建对象并附加汽车模型时，无法将其删除。

```
var mercedes = new Make() { Id = 77, Name = "chevrolet" };//manually created the object
mercedes.Models = GetAllModels(77);//I have it in-memory            
var model = mercedes.Models.Where(c => c.Id == 173).Single();
mercedes.Models.Remove(model); 
```

我想我在做一些奇怪的事情。但是我可以使用第二种方法添加/更新模型，所以我为什么不能删除它。请有任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:45:21.577

当您创建一个新的域对象时，它不会附加到 NHibernate 会话（例如，除非您正在创建一个新对象并调用 Save）。因此，从模型集合中删除实际上并没有做任何事情。

您的第二个示例似乎不是一个特别好的做法，但您*可以* [重新创建一个对象并将其附加到您的 NHibernate 会话](https://stackoverflow.com/a/4444753/486620) 使用`Session.Lock`（`Merge`或者`Update`根据您的首选行为相当正常）。

# nginx - nginx/starman/dancer web 栈的解释

> ID：12127566
> 
> 赞同：35
> 
> 时间：2012-08-26T04:17:40.723
> 
> 标签：nginx, dancer, plack, starman

我从事网络编程已经有一段时间了，对 LAMP 堆栈非常熟悉。我决定尝试使用 nginx/starman/dancer 堆栈，但我对如何从高层次理解所有部分如何相互关联感到有些困惑。设置堆栈似乎不像设置 LAMP 堆栈那么简单，但这可能是因为我不太了解这些部分之间的关​​系。

我了解 nginx 所扮演的角色——一个轻量级的网络服务器/代理——但我对 starman 与 pgsi、plack 和 dancer 的关系感到困惑。

我希望对这些部分如何相互关联以及为什么每个部分都是必要的（或不必要的）进行堆栈设置进行高级分解。谢谢！

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-26T22:51:10.257

我花了最后一天阅读各种组件，我认为我有足够的理解来回答我自己的问题。我的大部分答案都可以在网络上的各个地方找到，但希望将所有部分放在一个地方会有一些价值：

*   Nginx：要了解的第一个也是最明显的堆栈部分是 nginx。Nginx 是一个轻量级的网络服务器，可以替代无处不在的 Apache 网络服务器。Nginx 也可以充当代理服务器。它的使用量一直在迅速增长，目前服务于所有网络域的约[10%](http://www.readwriteweb.com/cloud/2012/02/nginx-continues-growth-adds-co.php)。nginx 的一个关键优势是它是异步的和事件驱动的，而不是创建一个进程线程来处理每个连接。从理论上讲，这意味着 nginx 能够处理大量连接而无需使用大量系统资源。
*   PSGI：[PSGI](https://stackoverflow.com/questions/6135552/psgi-what-is-it-and-whats-the-fuss-about)是一种协议（将其与特定*实现区分开来*协议，例如 Plack）。据我所知，创建 PSGI 的主要动机是，当首次创建 Apache 时，没有原生支持使用用 Perl 编写的脚本来处理请求。使用 mod_cgi 为 Apache 添加了执行此操作的能力。要测试您的 Perl 应用程序，您必须运行整个网络服务器，因为应用程序在网络服务器中运行。相比之下，PSGI 提供了一种协议，通过该协议，Web 服务器可以与用 Perl 等编写的服务器进行通信。这样做的好处之一是独立于 Web 服务器测试 Perl 服务器要容易得多。另一个好处是，一旦构建了应用程序服务器，就可以很容易地切换到不同的 PSGI 兼容网络服务器来测试哪个提供了最佳性能。
*   Plack：这是 PSGI 协议的一种特殊实现，它提供了 PSGI 兼容的网络服务器和 perl 应用程序服务器之间的粘合剂。Plack 相当于 Perl 的 Ruby 的 Rack。
*   Starman：基于 perl 的 Web 服务器，与 PSGI 协议兼容。我有一个困惑是为什么我想同时使用 Starman 和 Nginx，但幸运的是，这个问题在 Stackoverflow 上得到了[很好的回答。](https://stackoverflow.com/questions/2939393/why-use-nginx-with-catalyst-plack-starman)本质是让 nginx 提供静态文件而不需要 perl 进程来做这件事可能会更好，同时还允许 perl 应用程序服务器在更高的端口上运行。
*   [Dancer](http://perldancer.org/)：Perl 的 Web 应用程序框架。相当于 Ruby on Rails。或者更准确地说，相当于 Sinatra for Ruby（不同之处在于 Sinatra 是一个极简框架，而 Ruby on Rails 是一个更全面的 Web 框架）。作为一个处理 PHP 并且之前没有真正使用过 Web 框架的人，我对这与服务堆栈的关系感到有些困惑。Web 框架的重点是它们抽象出 Web 应用程序中非常频繁执行的常见任务，例如将数据库查询转换为 Web 应用程序中的对象/数据结构。

*   安装（在 ubuntu 上）：

```
    sudo apt-get 安装 nginx
    sudo apt-get install build-essential curl
    sudo cpan App::cpanminus
    sudo cpanm Starman
    sudo cpanm 任务::Plack
    sudo apt-get install libdancer-perl

```

*   让它运行：

```
光盘
舞者 -a mywebapp
sudo plackup -s Starman -p 5001 -E 部署 --workers=10 -a mywebapp/bin/app.pl

```

现在您将拥有一个 Starman 服务器，在端口 5001 上运行您的 Dancer 应用程序。要让 nginx 向服务器发送流量，您必须修改

```
/etc/nginx/nginx.conf
```

并将类似这样的规则添加到 http 部分：

```
        服务器 {
               server_name Permanentinvesting.com
               听 80；

                位置 /css/ {
                  别名/home/ubuntu/mywebapp/public/css/；
                  30天到期；
                  access_log 关闭；
                }

               地点 / {
                  proxy_pass http://localhost:5001;
                  proxy_set_header X-Real-IP $remote_addr;
                }

        }

```

第一个位置规则指定 nginx 应该处理 /css 目录中的静态内容，方法是从

```
/home/ubuntu/mywebapp/public/css/
```

. 第二个位置规则说，在端口 80 上的网络服务器的流量应该被发送到 Starman 服务器来处理。现在我们只需要启动 nginx：

```
sudo 服务 nginx 启动

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T18:25:21.730

到目前为止，您的答案是正确的，但最好通过以下方式设置 nginx：

```
server {
    listen 80;
    server_name foo.example.com;

    location / {
        # Serve static files directly:
        if (-f $request_filename) {
            expires 30d;
            break;
        }

        # Pass on other requests to Dancer app
        proxy_pass_header Server;
        proxy_pass http://localhost:5001/;
    }
} 
```

这使得 nginx 服务于所有静态文件（JavaScript 和图像），而不仅仅是 css。

这个例子取自 2011 Perl Dancer Advent :)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-20T03:12:22.557

来自 nginx wiki：
“IfIsEvil ... 指令 if 在位置上下文中使用时出现问题，在某些情况下，它并没有按照您的预期执行，而是完全不同。在某些情况下，它甚至会出现段错误。通常最好避免如果可能的话……”

更好的设置是：

```
server {
    listen 80;
    server_name foo.example.com;

    location / {  
    # Checks the existence of files and uses the first match
                try_files $uri $uri/ @dancer;
          } 

    location @dancer {
    # Pass on other requests to Dancer app
            proxy_pass_header Server;
            proxy_pass http://localhost:5001/;
        }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-18T13:22:30.073

更正来自[s.magri](https://stackoverflow.com/users/3758613/s-magri)的答案：

```
location @dancer {
  # Pass on other requests to Dancer app
  proxy_pass_header Server;
  proxy_pass http://localhost:5001;
} 
```

我必须删除最后一个 proxy_pass 指令中的斜杠。我的 nginx (1.10.3) 版本不会以斜杠开头。

# php - 代码在 Heroku 中不起作用

> ID：12127570
> 
> 赞同：1
> 
> 时间：2012-08-26T04:18:41.250
> 
> 标签：php, heroku

我一直在使用 php 编写代码来生成图像，这段代码在我的本地主机中工作，我托管在个人网站上，它也在那里工作。但是当我在 Heroku 中托管 php 代码时，它会导致 SERVER ERROR

[该网站在检索http://afternoon-river-7575.herokuapp.com/gen.php](http://afternoon-river-7575.herokuapp.com/gen.php)时遇到错误。它可能因维护而停机或配置不正确。

它会导致 HTTP 错误 500（内部服务器错误）；

问题是关于在heroku的文件系统中创建文件。

```
<?php

$im = imagecreatetruecolor(120, 20);
$text_color = imagecolorallocate($im, 233, 14, 91);
imagestring($im, 1, 5, 5,  'A Simple Text String', $text_color);

header('Content-Type: image/jpeg');

imagejpeg($im);

imagedestroy($im);
?> 
```

# ruby-on-rails - omn iauth-facebook、集成测试、rspec、capybara - 从哪里开始？

> ID：12127572
> 
> 赞同：0
> 
> 时间：2012-08-26T04:18:50.103
> 
> 标签：ruby-on-rails, facebook, ruby-on-rails-3, rspec

我为测试 api 的应用程序做了一些非常简单的集成测试。我想为我们的 facebook 登录添加集成测试。我很困惑如何做到这一点。似乎有两种选择。一种是尝试拨打 facebook 并实际登录。我不清楚我在 Firefox 中的 facebook 会话是否会被使用。另一种选择可能是将 facebook 调用模拟为其他内容，然后手动设置会话值。

我当前的用户当前通过以下方式设置：

### application_controller.rb

```
def current_user
  @current_user ||= User.find(session[:user_id]) if session[:user_id]
end 
```

这些技术中的任何一种都可能吗？这个比那个好吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:00:59.313

您应该首先阅读omniauth wiki 的[集成测试](https://github.com/intridea/omniauth/wiki/Integration-Testing)部分。基本上，该方法使用[webmock](https://github.com/bblimke/webmock) gem 来模拟来自您指定的任何提供者的响应。

我使用这种方法来模拟 twitter。在我的 config/omniauth.rb 我有：

```
if (ENV["RAILS_ENV"] == 'test' || ENV["RAILS_ENV"] == 'development')
  module OmniAuthHelpers
    def self.add_twitter_mock(uid, name, nickname)
      OmniAuth.config.add_mock(:twitter,
                               { :provider => 'twitter',
                                 :uid => uid,
                                 :info => { :name => name, :nickname => nickname})
end 
```

然后在我的步骤定义中（对于黄瓜），我有：

```
Given /^I am logged into Twitter as the following user:$/ do |table|
  add_twitter_mock(table.rows_hash[:uid],
                   table.rows_hash[:name],
                   table.rows_hash[:nickname])
end 
```

在我的功能中，例如：

```
Scenario: Valid login through Twitter
  Given I am logged into Twitter as the following user:
    | name     | John Doe      |
    | uid      | 12345         |
    | nickname | jdoe          |
  And I am on the homepage
  When I click on "Sign in through Twitter"
  ... 
```

在这种情况下，“通过 Twitter 登录”链接链接到“/auth/twitter”，然后它会向模拟的 Twitter API 发出请求。之后的一切都照常进行（然后我应该看到“jdoe”的链接等）

# javascript - ScrollTo...如何滚动到#上方的一定数量的像素？

> ID：12127575
> 
> 赞同：1
> 
> 时间：2012-08-26T04:19:21.433
> 
> 标签：javascript, jquery, scroll, position, scrollto

好的，我的问题是我有一个固定的导航栏，在屏幕顶部占据 115 像素的空间。当您滚动“到”某个部分时，固定条将覆盖该部分的一部分。我需要它做的是在它应该滚动到的部分上方滚动大约 130 像素（导航栏为 115 像素，还有一点额外的空间，所以看起来不会太拥挤）。

我[设置了一个快速而肮脏的 JSFiddle](http://jsfiddle.net/6DTLc/)，以便您了解这个想法。

我认为我应该在此使用 offset 或 over ，但它们似乎没有做任何事情：

```
$('#navigation a').click(function(){//$.scrollTo works EXACTLY the same way, but scrolls the whole screen
$.scrollTo( this.hash, 1500, {easing:'elasout'});
}); 
```

[如果它们可以帮助您，这](http://demos.flesler.com/jquery/scrollTo/)是我从中获取脚本和示例的地方。

我也很想消除附加到 URL 上的 #hash 链接，以免淹没回溯历史。由于导航栏是固定的，因此实际上不需要它们，您只需单击导航上的新链接即可访问网站的任何部分。但这不是主要问题。

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:43:54.227

快速示例！注意：不使用您示例中的插件 - 仅在 Firefox 和 Chrome 中测试

演示：http: [//jsfiddle.net/6DTLc/4/](http://jsfiddle.net/6DTLc/4/)

```
 $('ul#navigation').find('a').on('click', function(e) {
      var
      link_href =  $(this).attr('href'),   
      $linkElem =  $(link_href),
      $linkElem_scroll = $linkElem.get(0) && $linkElem.position().top-115;           

      $('html, body')
          .animate({scrollTop: $linkElem_scroll}, 'slow');         

        e.preventDefault();
    }); 
```

# image-processing - 将RGB转换为灰度+ B？

> ID：12127577
> 
> 赞同：2
> 
> 时间：2012-08-26T04:20:27.170
> 
> 标签：image-processing, rgb, formula

我正在尝试制作照片效果，您可以从红-绿-蓝通道三元组中减去一个或两个通道。例如，假设我不想在最终图像中出现任何绿色或红色。一种方法是简单地将绿色和红色分量归零。但是，使用这种方法，我会丢失许多对象的边缘、形状和阴影。我真正想要的是更多“带有蓝色提示的灰度”效果（特别是如果该蓝色可以代表图像中的原始蓝色）。我用什么公式来做这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:25:01.077

```
B = R*0.299 + G*0.587 + B*0.114
R = G = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:38:40.450

```
Blue = 0.299×Red + 0.587×Green + 0.114×Blue 
```

这个公式很流行，但它不正确。它不会给你带来好的结果。为了获得正确的结果，您可能需要使用以下公式：首先转换为线性色彩空间，然后使用不同的权重：

```
Blue = 0.2126×Red + 0.7152×Green + 0.0722×Blue 
```

正确的近似是：

```
Blue = (0.2126×Red^(2.2) + 0.7152×Green^(2.2) + 0.0722×Blue^(2.2))^(1/2.2)
Green=Red=0 
```

# jquery - JQuery 菜单不会滑动

> ID：12127581
> 
> 赞同：0
> 
> 时间：2012-08-26T04:21:33.067
> 
> 标签：jquery, html, css

所以我为滑动菜单编写了这段代码，只是我遇到了一个问题，它不是滑动的。我的 JQuery 有问题吗？

我尝试搜索这个答案，因为其他人似乎也有同样的问题，但我仍然找不到我写错的内容。

```
<html> <head> <meta charset="utf-8" />  
    <script type="text/javascript"
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script type="text/javascript"> 
    $(document).ready(function() {
        $("#tab").toggle(function() { 
            $('#menu').animate({ left: '0' }, 500px);
            $("#tab").html('-');
        }, function() {
            $('#menu').animate({ left: '-600' }, 500px);
            $("#tab").html('+');
        }); });     
    </script>   
    <style type="text/css">             
    #menu{
        position:absolute;
        top:50px;
        left:-100%;
        height:520px;
        width:100%;
        background-color:#000000;
        text-align:center;
        margin:0px;
        font-family:helvetica;
        color:#FFFFFF
        opacity:.9;  
    }       
    a{ 
            padding-right:60px; 
            text-decoration:none;
            margin:40px;
            color:#FFFFFF
    } 
    h1{
        font-size:20px;
        padding:40px;
        color:#FFFFFF
        text-margin:50px;
        } h2{
        font-size:60px;
        padding:70px;
        color:#FFFFFF 
    } 
    h3{
        font-size:15px;
        padding:50px;
        color:#FFFFFF 
    }               
    #tab{
        position:absolute;
        height:90px;
        width:90px;
        right:-80px;
        top:0px;
        background-color:#000000;
        font-family:helvetica;
        color:#FFFFFF;
        font-size:50px;
        cursor:pointer; 
    }           
    </style>    
</head> 
<body>  
    <div id="menu"><h1>     
        <a class="navItem" href="url">title</a>                 
        <a class="navItem" href="url">title</a>                         
        <a class="navItem" href="url">title</a>                         
        <a class="navItem" href="url">title</a>                         
        <a class="navItem" href="url">title</a></h1>            
        <h2>name</h2>               
        <h3>website title</h3>              
        <div id="tab"> +        
        </div>  
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:29:48.460

animate 函数中的第二个属性是以毫秒为单位的时间，没有附加任何单位。

将其更改为

```
$('#menu').animate({ left: '0' }, 500); 
```

**评论后编辑：** 要使其收回，您也需要修复收回代码

```
$('#menu').animate({ left: '-600' }, 500); 
```

至于重叠问题，设置z-index: 1；在#menu 和位置：相对；和z-index：0；在任何你想要它重叠的地方。只要这些元素在 HTML 嵌套方面处于同一级别。如果您遇到问题，请查看有关 z-index 的一些教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T15:33:04.827

这是修复：[http ://pastebin.com/raw.php?i=SUz4FkzL](http://pastebin.com/raw.php?i=SUz4FkzL)

我刚刚做了和瑞克一样的改变，所以你应该给他“接受”

# go - Go：按名称查找函数

> ID：12127585
> 
> 赞同：6
> 
> 时间：2012-08-26T04:22:25.920
> 
> 标签：go, reflection, casting, type-safety, go-reflect

我是键入安全的新手，不知道如何进行以下操作

```
package main

func test(){
    print("In Test")
}

func main(){
    a := "test"
    a()
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-26T10:42:08.053

如果你陈述你想要达到的目标，你可能会得到更好的答案，因为反思通常不是最好的方法。但如果函数是类型上的方法，则[反射会有所帮助（](http://golang.org/pkg/reflect/) [net/rpc](http://golang.org/pkg/net/rpc/)就是一个[例子](http://golang.org/src/pkg/net/rpc/server.go?s=6894:6948#L235)）。

```
package main

import (
    "fmt"
    "reflect"
)

type T struct {}

func (T) Add(x, y int) int {
    return x + y
}

func main() {
    t := reflect.ValueOf(T{})
    m := t.MethodByName("Add")
    args := []reflect.Value{reflect.ValueOf(1), reflect.ValueOf(2)}
    fmt.Println(m.Call(args)[0].Int())
} 
```

如果您想知道[godoc 之](http://golang.org/cmd/godoc/)类的工具是如何工作的，它们会解析源代码而不是使用反射。

编辑：[游乐场版本](http://play.golang.org/p/pTb-M5Od8b)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-26T04:25:49.080

无法从字符串解析函数。但是，您可以将函数分配给变量。

```
a := test
a() 
```

您还可以将函数（假设它们都具有相同的签名）放入映射中：

```
var func_map :=  map[string]func() {
    "test": test,
}
a := func_map["test"]
a() 
```

对 OP 的第一条评论的回应（太长，无法发表另一条评论）：

1.  函数不是“文字”。“字面”有不同的含义。
2.  其次，Go 的运行时反射没有将字符串映射到函数的查找表。即使这样做了，除非通过其他代码链接，否则函数不会链接到二进制文件中。仅在此方法中调用的代码不会在二进制文件中。
3.  第三，手动进行映射并不难。它提供编译时类型安全检查以及安全性。
4.  这不是你应该用*任何*语言做的事情。它就像 eval()，你真的不应该使用它，因为它可能非常危险并导致不可预知的事情发生。

*他们并不都有相同的签名*

如果他们没有相同的签名，你打算怎么称呼他们？您可以使用该`reflect`软件包，但这通常表明您做错了什么。

这不是一种动态语言，有些事情在 Go 中无法完成。虽然，无论如何，它们大多是你不应该在大多数语言中做的事情。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-26T07:30:58.040

没有办法通过名称动态查找函数，但我认为值得一提的原因。基本上，原因是编译器和/或链接器可以消除未使用的函数。

考虑一下，如果您能够通过名称获取函数，那么每个导入包中的每个函数（递归）都必须链接到最终的可执行文件中，即使它从未使用过，以防万一有人想通过以下方式查找它姓名。人们已经抱怨 Go 二进制文件的体积很大，但这会使它们变得更大。

# javascript - 突出显示jQuery中单词之间的空白

> ID：12127590
> 
> 赞同：0
> 
> 时间：2012-08-26T04:23:47.363
> 
> 标签：javascript, jquery

我是 jQuery 新手，所以我有 2 个问题。

1-如何在此功能中突出显示单词之间的空格？

2-如何突出显示`<abbr class="word p1">`标签？

**HTML 代码：**

```
<span id="4">
<abbr class="word p1" >&#xfb62;</abbr>
<abbr class="word p1" >&#xfb63;</abbr>
<abbr class="word p1" >&#xfb64;</abbr>
<abbr class="word p1" >&#xfb65;</abbr>
<abbr class="end p1" >&#xfb66;</abbr>
</span > 
```

**JavaScript 代码：**

```
$(function(){
    var time = 5;
    $("abbr", "#4").each(function(i,e) {
        $(e).delay(i*((time*1000)/$("abbr", "#4").length)).animate({'background-color': '#0f0'}, 500);
    });
});​ 
```

**CSS代码：**

```
span
{
    text-align:justify;
    float:right;
}

    @font-face {
        font-family: 'p1';
        src: url('http://c216429.r29.cf1.rackcdn.com/p1.eot?#iefix') format('embedded-           opentype'),
             url('http://c216429.r29.cf1.rackcdn.com/p1.woff')       format('woff'),
             url('http://c216429.r29.cf1.rackcdn.com/p1.ttf')        format('truetype'),
             url('http://c216429.r29.cf1.rackcdn.com/p1.svg#p1')    format('svg');
    }

    .p1 {
        font-family: 'p1';
    }​ 
```

**演示：http:** [//jsfiddle.net/eTyaV/](http://jsfiddle.net/eTyaV/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:48:31.487

根据我上面的评论，只需在标签中包含空格即可解决您的空间突出显示问题。

```
<span id="4">
    <abbr class="word p1" >&#xfb62; </abbr>
    <abbr class="word p1" >&#xfb63; </abbr>
    <abbr class="word p1" >&#xfb64; </abbr>
    <abbr class="word p1" >&#xfb65; </abbr>
    <abbr class="end p1" >&#xfb66;</abbr>
</span > 
```

至于第 2 点，您可以通过使用类似`if($(e).hasClass('word')) {}`.

```
$(function(){
    var time = 5;

    $("abbr").each(function(i,e) {

        if($(e).hasClass('word')) {  
            $(e).delay(i*((time*1000)/$("abbr").length)).animate({'background-color': '#0f0'}, 500);
        }
    });
});​ 
```

[http://jsfiddle.net/eTyaV/7/](http://jsfiddle.net/eTyaV/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T09:43:00.137

把空格放在里面`<abbr>`

.这将解决空白

```
<span id="4">
    <abbr class="word p1" >&#xfb62; </abbr>
    <abbr class="word p1" >&#xfb63; </abbr>
    <abbr class="word p1" >&#xfb64; </abbr>
    <abbr class="word p1" >&#xfb65; </abbr>
    <abbr class="end p1" >&#xfb66;</abbr>
</span > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T20:25:46.787

要仅突出显示`<abbr>`带有类的元素，`word p1`只需编写

```
$('abbr.word.p1').css({background:'0f0'}); 
```

# sql-server-2008 - 跨域使用 Windows 身份验证的 SSIS 包部署失败

> ID：12127592
> 
> 赞同：0
> 
> 时间：2012-08-26T04:24:15.017
> 
> 标签：sql-server-2008, ssis

尝试在我的本地 PC 上部署一个包并连接到我的客户端的 vpn。

我得到错误：

```
c:\Program Files\Microsoft SQL Server\110\DTS\Binn>dtutil /File c:\www\clients\SomeCompany\ssis\warehouse\Warehous
e_Update_Table1.dtsx /DestServer SomeServerName /Copy sql;Warehouse_Update_Table1
Microsoft (R) SQL Server SSIS Package Utilities
Version 10.50.1600.1 for 64-bit

Error (0xC0014014) while checking for the existence of package "Warehouse_Update_Table1" on SQL Server.
Could not save package "Warehouse_Update_Table1" because of error 0x80004005.
Description: Login failed. The login is from an untrusted domain and cannot be used with Windows authentication.
Source: Microsoft SQL Server Native Client 10.0

    c:\Program Files\Microsoft SQL Server\110\DTS\Binn>dtutil /File c:\www\clients\SomeCompany\ssis\warehouse\Warehouse_Update_Table1.dtsx /DestServer SomeServerName.SomeDomain.net /Copy s
    ;Warehouse_Update_TestTable1
    c:\Program Files\Microsoft SQL Server\110\DTS\Binn>dtutil /File c:\www\clients\SomeCompany\ssis\tmlwarehouse\Warehouse_Update_Table1.dtsx /DestServer/SomeServerName.SomeDomain.net /Copy sql;Warehouse_Update_Table1

(obviously I have real values for "SomeCompany" and SomeServerName.SomeDomain" 
```

有没有办法提升权限，比如你可以用 .exe 做什么来指定发件人的域或提升这个请求，所以这个东西可以工作？

不幸的是，我们使用 Windows auth 来调用它，因为这就是客户端蚂蚁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T06:07:25.433

看看将 runas 与 netonly 选项一起使用：

`runas.exe /netonly /user:DOMAIN\DOMAINUSERNAME Dtutil.exe`

它是“DTUtil.exe”

# extjs - 如何防止在树面板中创建 gridscroller？

> ID：12127594
> 
> 赞同：1
> 
> 时间：2012-08-26T04:24:17.063
> 
> 标签：extjs

我有以下代码在树商店内创建一个可扩展的树面板。我的问题是`autoscroll`true 和 scroll tr​​ue 我已经有了一个滚动条。

当我在树中展开一个文件夹时，会创建一个 gridscroll 并将其附加到主容器中，并并排创建两个滚动条。

如何捕获扩展文件夹并防止呈现网格滚动条？

我认为这是`setAutoScroll(false)`列上的方法，但我不知道如何设置它。

```
Ext.Loader.setConfig({
    enabled: true,
    disableCaching: false
});
Ext.require(['Ext.form.*', 'Ext.tree.*', 'Ext.grid.*', 'Ext.data.*', 'Ext.util.*', 'Ext.tip.QuickTipManager', 'Ext.ux.grid.FiltersFeature', 'Ext.ModelManager']);

Ext.onReady(function() {
    Ext.define('model1', {
        extend: 'Ext.data.Model',
        fields: [{
            name: 'text',
            type: 'string'
        }, {
            name: 'pathInfo',
            type: 'string'
        }]
    });

    storeAddTo = Ext.create('Ext.data.TreeStore', {
        model: 'model1',
        folderSort: true,
        root: {
            expanded: true,
            children: myJSONTextAddTo
        }
    });

    var treeConfigAddTo = {

        //title: 'Select an existing folder from the list',
        id: 'grid-foldersAddTo',
        width: 320,
        height: 330,
        store: storeAddTo, //
        rootVisible: false,
        useArrows: true,
        singleExpand: false,
        renderTo: 'grid-foldersAddTo',
        columns: [{
            xtype: 'treecolumn',
            text: 'Folders',
            flex: 1,
            sortable: false,
            dataIndex: 'text',
            filterable: false
        }],
        viewConfig: {
            autoScroll: true,
            scroll: true,
        }
    }

    treeAddTo = Ext.create('Ext.tree.Panel', treeConfigAddTo);

}); 
```

> 数据（myJSONTextAddTo）

```
[{
    text: "Cars",
    "pathInfo": "Cars",
    children: [{
        text: "Luxury",
        "pathInfo": "Cars\\Luxury\\Bentley",
        children: [{
            text: "Bentley",
            "pathInfo": "Cars\\Luxury\\Bentley",
            children: []
        }, {
            text: "Porsche",
            "pathInfo": "Cars\\Luxury\\Porsche",
            children: [{
                text: "Cars",
                "pathInfo": "Cars\\Luxury\\Porsche\\Cars\\Luxury\\Porsche",
                children: [{
                    text: "Luxury",
                    "pathInfo": "Cars\\Luxury\\Porsche\\Cars\\Luxury\\Porsche",
                    children: [{
                        text: "Porsche",
                        "pathInfo": "Cars\\Luxury\\Porsche\\Cars\\Luxury\\Porsche",
                        children: []
                    }]
                }]
            }]
        }]
    }, {
        text: "Dealers",
        "pathInfo": "Cars\\Dealers",
        children: []
    }, {
        text: "Ferrari",
        "pathInfo": "Cars\\Ferrari",
        children: []
    }, {
        text: "Sports",
        "pathInfo": "Cars\\Sports",
        children: [{
            text: "Chevy",
            "pathInfo": "Cars\\Sports\\Chevy",
            children: []
        }]
    }, {
        text: "mycar",
        "pathInfo": "Cars\\mycar",
        children: []
    }, {
        text: "test2",
        "pathInfo": "Cars\\test2",
        children: []
    }, {
        text: "test3",
        "pathInfo": "Cars\\test3",
        children: []
    }, {
        text: "test4",
        "pathInfo": "Cars\\test4",
        children: []
    }, {
        text: "test5",
        "pathInfo": "Cars\\test5",
        children: []
    }, {
        text: "test 6",
        "pathInfo": "Cars\\test 6",
        children: [{
            text: "Test 6.1",
            "pathInfo": "Cars\\test 6\\Test 6.1",
            children: []
        }]
    }]
}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T04:18:57.793

看看这个小提琴： http: [//jsfiddle.net/dbrin/Qc5XV/](http://jsfiddle.net/dbrin/Qc5XV/) 我删除了您拥有的视图配置并删除了高度约束以允许树生长。我希望这就是你所追求的。如果您想修复高度，请取消注释高度配置，树面板将在需要时自动滚动。这对我来说似乎是正确的。如果是这样，您可能在树周围有其他面板给您带来问题，请让我知道布局，我们可以进一步排除故障。希望这可以帮助。

# asp.net - 彼此下方的两个控件

> ID：12127602
> 
> 赞同：0
> 
> 时间：2012-08-26T04:25:53.200
> 
> 标签：asp.net, html, css

我想创建一个标签控件，并且我想在标签控件周围放置边框。我想在该边框内显示一个单选按钮，所以像这样

```
 <table>
                    <tr>
                        <td>
                            <asp:label ID="lblJCN" Text="JCN"  runat="server" ackColor="#808080" Width="100px"
                                                Height="30px" BorderWidth="1px" BorderColor="#333333"></asp:label>

                        </td>

                    </tr>
                    <tr>
                        <td>
                            <asp:RadioButton ID="rdbJCN" runat="server" Text="or" />

                        </td>
                    </tr>

                </table> 
```

我希望 Or 单选按钮位于标签控件 lblJCN 边框内。有可能这样做吗？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:55:41.747

如果我正确理解您的要求，要实现带有边框和单选按钮的标签，试试这个

```
<fieldset>
<legend><asp:label ID="lblJCN" Text="JCN"  runat="server" ackColor="#808080" width="100px"></asp:label></legend>
<asp:RadioButton ID="rdbJCN" runat="server" Text="or" />
</fieldset> 
```

# ruby - /usr/bin/env ruby _noexec_wrapper 失败，没有文件或目录

> ID：12127603
> 
> 赞同：13
> 
> 时间：2012-08-26T04:26:20.263
> 
> 标签：ruby, rvm, environment-variables, chef-infra

当我尝试将 chef-solr 作为服务启动时，它失败并出现以下错误

```
# service chef-solr start
Starting chef-solr: /usr/bin/env: ruby_noexec_wrapper: No such file or directory
                                                       [FAILED] 
```

但是当我从命令行手动运行它时，它运行成功

```
# chef-solr -d -c /etc/chef/solr.rb -L /var/log/chef/solr.log -P /var/run/chef/solr.pid
# echo $?
0
# ps -ef | grep chef
root      2691     1 12 04:19 ?        00:00:01 java -Xmx256M -Xms256M -Dsolr.data.dir=/var/lib/chef/solr/data -Dsolr.solr.home=/var/lib/chef/solr/home -jar /var/lib/chef/solr/jetty/start.jar 
```

这是我的 rvm 信息

```
# rvm info

ruby-1.9.3-p194:

  system:
    uname:       "Linux Console 2.6.32-220.el6.x86_64 #1 SMP Wed Nov 9 08:03:13 EST 2011 x86_64 x86_64 x86_64 GNU/Linux"
    bash:        "/bin/bash => GNU bash, version 4.1.2(1)-release (x86_64-redhat-linux-gnu)"
    zsh:         " => not installed"

  rvm:
    version:      "rvm 1.15.6 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]"
    updated:      "7 hours 1 minute 51 seconds ago"

  ruby:
    interpreter:  "ruby"
    version:      "1.9.3p194"
    date:         "2012-04-20"
    platform:     "x86_64-linux"
    patchlevel:   "2012-04-20 revision 35410"
    full_version: "ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]"

  homes:
    gem:          "/usr/local/rvm/gems/ruby-1.9.3-p194"
    ruby:         "/usr/local/rvm/rubies/ruby-1.9.3-p194"

  binaries:
    ruby:         "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/ruby"
    irb:          "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/irb"
    gem:          "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/gem"
    rake:         "/usr/local/rvm/gems/ruby-1.9.3-p194/bin/rake"

  environment:
    PATH:         "/usr/local/rvm/gems/ruby-1.9.3-p194/bin:/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin:/usr/local/rvm/rubies/ruby-1.9.3-p194/bin:/usr/local/rvm/bin:/usr/lib64/qt-3.3/bin:/usr/java/default/bin:/bin:/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/usr/sbin:/usr/bin:/root/bin"
    GEM_HOME:     "/usr/local/rvm/gems/ruby-1.9.3-p194"
    GEM_PATH:     "/usr/local/rvm/gems/ruby-1.9.3-p194:/usr/local/rvm/gems/ruby-1.9.3-p194@global"
    MY_RUBY_HOME: "/usr/local/rvm/rubies/ruby-1.9.3-p194"
    IRBRC:        "/usr/local/rvm/rubies/ruby-1.9.3-p194/.irbrc"
    RUBYOPT:      ""
    gemset:       "" 
```

下面是对应的环境变量

```
declare -x GEM_HOME="/usr/local/rvm/gems/ruby-1.9.3-p194"
declare -x GEM_PATH="/usr/local/rvm/gems/ruby-1.9.3-p194:/usr/local/rvm/gems/ruby-1.9.3-p194@global"
declare -x IRBRC="/usr/local/rvm/rubies/ruby-1.9.3-p194/.irbrc"
declare -x MY_RUBY_HOME="/usr/local/rvm/rubies/ruby-1.9.3-p194"
declare -x PATH="/usr/local/rvm/gems/ruby-1.9.3-p194/bin:/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin:/usr/local/rvm/rubies/ruby-1.9.3-p194/bin:/usr/local/rvm/bin:/usr/lib64/qt-3.3/bin:/usr/java/default/bin:/bin:/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/usr/sbin:/usr/bin:/root/bin"
declare -x RUBY_VERSION="ruby-1.9.3-p194" 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-26T05:03:36.237

确保所有变量都设置正确，尤其是`PATH`and `GEM_PATH`，您可以使用此代码为您设置环境：

```
source /usr/local/rvm/environments/ruby-1.9.3-p194 
```

`chef-solr`在运行之前将其添加到服务中

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-03T02:49:08.800

我的问题很相似，我的回答也是：

我的问题是

```
Permission denied - /usr/local/rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper 
```

ruby_noexec_wrapper`ruby-1.9.3-p194@global`不在列出的路径中

我的解决方案是

```
source /usr/local/rvm/environments/ruby-1.9.3-p194@global 
```

我赞成 mpapis，因为他的回答对于找到我的答案至关重要。随意支持他而不是我。只需添加一个额外的答案来尝试帮助有类似问题的任何人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-24T16:44:21.537

答案与厨师无关，但将来可能会有所帮助。

我有一个类似的问题，但是因为我正在按照教程在 RVM 中设置瘦。我通过使用 RVM 为瘦服务生成的包装器进行了修复

```
/home/thin/.rvm/bin/bootup_thin 
```

因此更改了初始化脚本中的行

```
DAEMON=/home/thin/.rvm/gems/ree-1.8.7-2012.02/bin/thin 
```

到

```
DAEMON=/home/thin/.rvm/bin/bootup_thin 
```

发布在 RVM 包装器[RVM 和瘦、root 与本地用户](https://stackoverflow.com/questions/3230404/rvm-and-thin-root-vs-local-user)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-30T18:11:04.307

我尝试了所有这些答案，都失败了。但我找到了解决这个问题的另一种方法，可能会有所帮助：

```
gem install rubygems-bundler 
```

您还可以从[noexec 库中找到答案](https://github.com/mpapis/rubygems-bundler)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-13T18:31:50.190

在我的 Mac 上安装 ruby​​ 2.0 后，我遇到了这个问题。部分原因是我安装了最新的 rvm

```
rvm get stable 
```

然后我开始收到这个错误。也许我在这之后跑了一些'gemset pristine'。

无论如何，对我来说，这行得通。警告！如果您按照我的方式进行操作，您的红宝石宝石将被完全移除并重建。也许你想要一个新的备份？但这就是锤子。

```
# WARNING!!! THIS RECIPE IS POTENTIALLY DESTRUCTIVE!
rvm remove ruby-1.9.3-p194 # this will remove the gemsets for this version as well
rvm install ruby-1.9.3-p194 # time for coffee
rvm use ruby-1.9.3-p194
rvm gemset create aura-rover-config # my gemset name
rvm use ruby-1.9.3-p194@aura-rover-config # do I need to do this?  Can't 'member
bundle
# now it all works 
```

有趣的是，我在安装的 gemsets 中做的所有小技巧，都被吹走了。进行备份

# javascript - 使用 jQuery 的通配符委托

> ID：12127610
> 
> 赞同：0
> 
> 时间：2012-08-26T04:27:10.437
> 
> 标签：javascript, jquery

我希望一个事件能够由具有适当上下文的任何元素触发。现在我正在这样做：

```
$(document.body).on('mycustomevent', '*', function(e) {
  e.stopPropagation()
  console.log('mycustomevent')
  console.log(this)
} 
```

这有什么问题吗？有没有更好的办法？

另一个相关问题是如何为未附加到文档的元素触发此事件？IE：

```
$('<div></div>').trigger('mycustomevent') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:38:47.937

对于第一部分，我会`$(document).on`改用。

对于第二部分，只需将事件处理程序附加到元素本身。

```
$('<div></div>').on('mycustomevent', function(e) {
    e.stopPropagation()
    console.log('mycustomevent')
    console.log(this)
}).trigger('mycustomevent') 
```

# c# - 更改下拉列表选定的值

> ID：12127612
> 
> 赞同：1
> 
> 时间：2012-08-26T04:28:28.410
> 
> 标签：c#, asp.net

我正在用另一个 DDL 填充 DDL，并且我从另一个页面获取值

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            DropDownList1.DataSource = ProfileMasterDAL.bindcountry();
            DropDownList1.DataBind();
            DropDownList1.Items.Insert(0, "--Select country--");

        }

        if(Session["uname"]!=null)
        {
              DropDownList1.SelectedValue = Session["country"].ToString();
           ProfileMasterBLL bll=new ProfileMasterBLL();
            foreach (var VARIABLE in ProfileMasterDAL.bindcountry())
            {
                if (VARIABLE.ToString().Contains(DropDownList1.SelectedItem.Text))
                {
                    var query = (ProfileMasterDAL.GetStatesByCountrys(DropDownList1.SelectedItem.Text));
                    DropDownList2.DataSource = query;
                    DropDownList2.DataBind();
                 }
            }

            TextBox8.Text = Session["email"].ToString();
            string pwd = Session["pwd"].ToString();
            TextBox9.Attributes.Add("value",pwd);
            TextBox10.Attributes.Add("value", pwd);

        }
    } 
```

但问题是每当我更改 DDL 值时，它就像在 page_load 中一样固定为会话值，所以我如何将值更改为 DDL 中的选定项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:18:42.537

如果已经正确理解了问题，您想根据 DropDownList1 的值更改 DropDownList2 的值，dropdownlist 的初始值来自另一个页面

```
 protected void Page_Load(object sender, EventArgs e)
     {
        if (!IsPostBack)
        {
            DropDownList1.DataSource = ProfileMasterDAL.bindcountry();
            DropDownList1.DataBind();
            DropDownList1.Items.Insert(0, "--Select country--");

            //get the selected country from another page
            string selectedCountry = Convert.ToString(Session["country"]);

            //set the selected value
            DropDownList1.Items.FindByValue(selectedCountry).Selected = true;

            //Bind Dropdonwlist2
             BindDropDownList(DropDownList1.SelectedItem.Text);

        }

        /*
         remaining code
         */
    } 
```

绑定 dropdonwList 2 代码

```
 /// <summary>
    /// Bind dropdownlist2 
    /// </summary>
    /// <param name="selectedCountry"></param>
    protected void BindDropDownList(string selectedCountry)
    {
        ProfileMasterBLL bll = new ProfileMasterBLL();
        foreach (var VARIABLE in ProfileMasterDAL.bindcountry())
        {
            if (VARIABLE.ToString().Contains(selectedCountry))
            {
                var query = (ProfileMasterDAL.GetStatesByCountrys(selectedCountry));
                DropDownList2.DataSource = query;
                DropDownList2.DataBind();
            }
        }

    } 
```

在 dropdonwlist1 的选定索引更改时，现在该值将更改

为 dropdownlist1 设置 autopostback true

```
DropDownList1.AutoPostBack = true;

    /// <summary>
    /// DropDownList1 Selcted Index change
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected  void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
    {
         BindDropDownList(DropDownList1.SelectedItem.Text);
    } 
```

希望这能解决你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:59:48.380

使用该[`OnSelectedIndexChanged`事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.onselectedindexchanged.aspx)并将下拉列表的[`AutoPostBack`属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.autopostback.aspx)设置为 true。

在`OnSelectedIndexChanged`事件处理程序中，添加代码以填充第二个下拉列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-10T09:29:29.130

```
 protected void Page_Load(object sender, EventArgs e)
     {
        if (!IsPostBack)
        {
            DropDownList1.DataSource = ProfileMasterDAL.bindcountry();
            DropDownList1.DataBind();
            DropDownList1.Items.Insert(0, "--Select country--");

            if(Session["uname"]!=null)
            {
                DropDownList1.SelectedValue = Session["country"].ToString();
                BindList()
            }

        }
        if(Session["uname"]!=null)
        {
            TextBox8.Text = Session["email"].ToString();
            string pwd = Session["pwd"].ToString();
            TextBox9.Attributes.Add("value",pwd);
            TextBox10.Attributes.Add("value", pwd);     
        }
     } 
```

add method for bind ddl2

```
private void BindList()
{
    ProfileMasterBLL bll=new ProfileMasterBLL();
    foreach (var VARIABLE in ProfileMasterDAL.bindcountry())
    {
      if (VARIABLE.ToString().Contains(DropDownList1.SelectedItem.Text))
      {
         var query = 
       ProfileMasterDAL.GetStatesByCountrys(DropDownList1.SelectedItem.Text));
                    DropDownList2.DataSource = query;
                    DropDownList2.DataBind();
      }
} 
```

set autopostback true for dropdownlist1 and add selectedIndexChanged

```
protected  void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
    {
         BindList();
    } 
```

# c# - 从 C# 中的哈希码中获取纯文本

> ID：12127613
> 
> 赞同：1
> 
> 时间：2012-08-26T04:28:38.197
> 
> 标签：c#, web-services, hash, md5

我有一些简单的代码，但我需要从我的哈希码中取回我的纯文本。

```
 private string Hash(string ToHash)
    {
        // First we need to convert the string into bytes,
        // which means using a text encoder.
        Encoder enc = System.Text.Encoding.ASCII.GetEncoder();

        // Create a buffer large enough to hold the string
        byte[] data = new byte[ToHash.Length];
        enc.GetBytes(ToHash.ToCharArray(), 0, ToHash.Length, data, 0, true);

        // This is one implementation of the abstract class MD5.
        MD5 md5 = new MD5CryptoServiceProvider();
        byte[] result = md5.ComputeHash(data);
        return BitConverter.ToString(result);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:10:33.457

您是否尝试将某人输入的密码与其密码的存储哈希值进行比较？如果是这样，那么您只需对他们输入的密码进行哈希处理，然后比较两个哈希值以查看它们是否匹配，而不是尝试对存储的密码进行哈希处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T04:35:21.723

据我所知，你不能取消散列一些东西。它完全违背了散列的想法。您确定您没有考虑“加密”吗？与对称或非对称密钥一样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T04:38:57.923

您不应该能够反转哈希 -[根据定义](http://en.wikipedia.org/wiki/Cryptographic_hash_function)，它是一种单向函数。您可能可以通过使用[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)或暴力猜测来猜测 md5 哈希的明文是什么，但它很昂贵，并不是您真正想要的。

# java - 创建使用 OSGI 框架的 jitsi 安装程序

> ID：12127615
> 
> 赞同：0
> 
> 时间：2012-08-26T04:28:53.273
> 
> 标签：java, windows-installer, osgi, jitsi

我在为 Jitsi 创建安装程序时遇到问题，当我从[这里](https://jitsi.org/index.php/Documentation/HowToBuildAnInstaller)阅读文章时，我没有得到任何确切的方法来制作安装程序。

我还尝试过构建 ant（它一直告诉我我没有 make.exe，我应该从哪里得到这个文件？？）

```
Buildfile: /Users/dejoong/workspace/eclipse-indigo/workspace/jitsi/build.xml
clean-install-windows:
    [mkdir] Created dir: /Users/dejoong/workspace/eclipse-indigo/workspace/jitsi/release/windows
    [mkdir] Created dir: /Users/dejoong/workspace/eclipse-indigo/workspace/jitsi/release/windows/tmp
build-installation-wix-base:
[propertyfile] Creating new property file: /Users/dejoong/workspace/eclipse-indigo/workspace/jitsi/release/windows/versionupdate.properties
    [mkdir] Created dir: /Users/dejoong/workspace/eclipse-indigo/workspace/jitsi/release/windows/tmp/light

BUILD FAILED
/Users/dejoong/workspace/eclipse-indigo/workspace/jitsi/resources/install/build.xml:403: Execute failed: java.io.IOException: Cannot run program "make.exe" (in directory "/Users/dejoong/workspace/eclipse-indigo/workspace/jitsi/src/native/windows/run"): error=2, No such file or directory 
```

任何人都可以帮忙吗？或任何有关如何使安装程序形成 OSGI 框架的文章？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-26T10:41:03.380

You need to download mingw with msys. After that, rename mingw-make.exe to make.exe, and then set it in the PATH.

msys has the commands required for the build, and Mingw has Make and Gcc for you to build.

# ios - 处理异步 NSURLConnection 接收数据时绘图暂停

> ID：12127616
> 
> 赞同：0
> 
> 时间：2012-08-26T04:28:59.867
> 
> 标签：ios, drawing, nsurlconnection, nsthread, nsurlconnectiondelegate

我正在从服务器加载数据并异步处理响应。使用 NSURLConnection。对委托的每次调用 connection:didReceiveData: 正在处理该块。

然而，就在接收到一大块数据之前，我请求一个文本视图滚动到新行，即[textView scrollRangeToVisible:]。

问题是，在收到所有数据之前，textView 通常不会滚动。这可能会持续一段时间，并使 UI 看起来挂起。

为了尝试解决它，我认为主线程被锁定处理数据，所以我应该把它分成更小的块。

所以我改用代码来分解连接中收到的数据：didReceiveData 以执行较小的操作，并使用

```
[self performSelectorOnMainThread:withObject:smallerChunk waitUntilDone:FALSE] 
```

想法是它将一堆事件放在运行循环上，并尽可能处理 scrollRangeToVisible 。

但是，这是行不通的。至少不可靠。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:53:42.233

“但是这不起作用。至少不可靠。” 是一个非常模糊的错误描述。但是，我建议您在后台线程中处理从连接接收到的数据，这样它就不会阻塞主线程。

例如，您可以创建一个串行调度队列：

```
dispatch_queue_t myQueue = dispatch_queue_create("myQueue", DISPATCH_QUEUE_SERIAL); 
```

并将`connection:didReceiveData:`数据处理提交到该队列：

```
dispatch_async(myQueue, ^{
    /* process data */
}); 
```

# ios - NSPredicate 'ALL 或 ANY 运算符的左侧必须是 NSArray 或 NSSet'

> ID：12127618
> 
> 赞同：5
> 
> 时间：2012-08-26T04:29:19.010
> 
> 标签：ios, xcode, core-data, nspredicate, nsfetchrequest

不完全确定为什么这现在不起作用，我认为它以前一直在起作用。有人看到这个 FetchRequest 构造有问题吗？

```
- (NSArray *)entriesForDate:(NSDate *)date {
    NSFetchRequest *request = [[NSFetchRequest alloc]initWithEntityName:@"Entry"];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY addedOn.unique like %@", [T3Utility identifierForDate:date]];
    request.predicate = predicate;

    NSError *error = nil;
    NSArray *matches = [self.database.managedObjectContext executeFetchRequest:request error:&error];

    return matches;
} 
```

再说一次，我 99% 确定这段代码直到最近都在工作，所以我想我的代码中可能还有其他事情发生。. .但是当我通过调试器运行它时，这就是挂起的地方。这是我的错误：

ALL 或 ANY 运算符的左侧必须是 NSArray 或 NSSet

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-26T07:29:50.007

似乎`addedOn`不是一对多的关系。确保在谓词中使用正确的属性/关系名称。另外，请注意，您不能在“ANY”谓词中使用一对一关系。

# android - 在所有 API 上使用的片段？

> ID：12127624
> 
> 赞同：0
> 
> 时间：2012-08-26T04:31:07.170
> 
> 标签：android, api

我对 Fragment 很陌生，我想制作可以在所有平台上运行的应用程序。要让片段适用于所有 API，我只需要导入“android-v4 兼容性包”，这适用于 API 11 之前的版本。但是导入它是否也适用于 API 11+？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:36:56.910

是的，但是您将受限于兼容性库的功能，该功能不如 API 11+ 中可用的本机 Fragment 实现

# c++ - C 函数参数中的数组语法与指针语法

> ID：12127625
> 
> 赞同：5
> 
> 时间：2012-08-26T04:31:54.330
> 
> 标签：c++, c, arrays, pointers, parameters

我了解数组如何衰减为指针。我知道，对于编译器，这是：

```
void foo(int *arg1); 
```

100% 相当于：

```
void foo(int arg1[]); 
```

一种风格应该优于另一种风格吗？我想保持一致，但我很难证明任何一个决定都是合理的。

虽然`int main(int argc, char *argv[])`和`int main(int argc, char **argv)`相同，但前者似乎更常见（如果我错了，请纠正我）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T04:31:54.330

我建议**不要**使用`[]`函数参数的语法。

支持使用的一个论点`[]`是，它以一种自记录的方式暗示着指针应该指向不止一个东西。例如：

```
void swap(int *x, int *y)
double average(int vals[], int n) 
```

但是为什么`char *`总是用于字符串而不是`char []`？我宁愿保持一致并始终使用`*`.

有些人喜欢`const`他们可能做的一切，包括按值传递的参数。使用时的语法`[]`（仅在 C99 中可用）不太直观，可能不太为人所知：

`const char *const *const words`对比`const char *const words[const]`

虽然我确实认为决赛`const`是矫枉过正，无论如何。

此外，数组*衰减*的方式并不完全直观。特别是，它[**不是**递归应用](http://c-faq.com/~scs/cgi-bin/faqcat.cgi?sec=aryptr#pass2dary)的（`char words[][]`不起作用）。尤其是当您开始使用更多的间接性时，`[]`语法只会引起混乱。IMO 最好始终使用指针语法，而不是假装将数组作为参数传递。

更多信息：[http](http://c-faq.com/~scs/cgi-bin/faqcat.cgi?sec=aryptr#aryptrparam) ://c-faq.com/~scs/cgi-bin/faqcat.cgi?sec=aryptr#aryptrparam 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T05:45:06.093

除了`char*`，我使用`Type array[N]`，其中 N 是某个数字或定义的常量，当传递的项目在概念上是一个数组（即，它包含 N>1 个元素），`Type * pointer`当传递的项目是指向一个对象的指针时。

`std::vector`如果数组的大小可变，我倾向于使用。C99 的可变大小数组概念在 C++ 中不可用。

# dns - 如何添加 A 记录以便无子域请求到达我的服务器

> ID：12127627
> 
> 赞同：0
> 
> 时间：2012-08-26T04:32:16.377
> 
> 标签：dns, subdomain

我有一个域`mydomain.com`，并且我已经设置了一个 A 记录`*.mydomain.com`，对任何子域的所有请求都将到达我的服务器，但[http://mydomain.com](http://mydomain.com)除外。如何设置我的记录，以便[http://mydoamin.com](http://mydoamin.com)请求到达我的服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:42:03.973

尝试将记录名称留空。只做类型 A 和值。

# c# - 树节点的反向级别

> ID：12127629
> 
> 赞同：1
> 
> 时间：2012-08-26T04:32:50.740
> 
> 标签：c#, treeview, treenode

在树节点中，级别将按升序增加我想编写一个函数，以便它反转树的级别我知道我应该得到树的深度，然后计算

`depth-selectednodeLevel`

所以它会导致树的级别按降序排列我不知道如何获得树的深度，该属性`LastNode`将给出节点的最后一个子节点，我不能将它用于深度，因为它会返回 lastNode只是为了那个级别而不是较低的级别。

例如通常的树节点级别如下

```
|0|
 |
|1|
 |
|2|
 |
|3| 
```

我想成功

```
 |3|
  |
 |2|
  |
 |1|
  |
 |0| 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T04:48:28.130

似乎您需要解决的问题就是找到树的深度，因此您可以使用简单的递归。

伪代码：

```
int GetDepth(Node node)
{
    return node.HasChilds ? node.Childs.Max(GetDepth) : node.Level;
} 
```

而在 C# 中，假设您使用 TreeNode 类来表示节点：

```
public int GetDepth(TreeNode node)
{
    return node.Nodes.Count == 0
        ? node.Level
        : node.Nodes.Cast<TreeNode>().Select(this.GetDepth).Max();
} 
```

用法：

```
var depth = GetDepth(myTree.Root); 
```

如果你没有每个节点的 Level 属性，你可以像这样添加一个参数：

```
public int GetDepth(TreeNode node, int depth)
{
    return node.Nodes.Count == 0
        ? depth
        : node.Nodes.Cast<TreeNode>()
              .Select(x => this.GetDepth(x, depth + 1)).Max();
} 
```

用法：

```
var depth = GetDepth(myTree.Root, 0); 
```

# python - Matplotlib：我们可以在同一张图表上绘制直方图和箱线图吗？

> ID：12127635
> 
> 赞同：2
> 
> 时间：2012-08-26T04:35:31.800
> 
> 标签：python, matplotlib, visualization, histogram, boxplot

我有一个关于绘制直方图和箱线图 Matplotlib 的问题。

我知道我可以单独绘制直方图和箱线图。我的问题是，是否可以将它们绘制在同一个图表上，例如本网站中显示的图表？[施普林格图片](http://www.springerimages.com/Images/RSS/1-10.1007_s10530-010-9707-x-1)

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-10-18T08:50:08.720

是的，我见过的最好的处理方法可以在[这里](https://python-graph-gallery.com/24-histogram-with-a-boxplot-on-top-seaborn/)找到。代码和图表的副本：

```
# Import library and dataset
import seaborn as sns
import matplotlib.pyplot as plt
df = sns.load_dataset('iris')

# Cut the window in 2 parts
f, (ax_box, ax_hist) = plt.subplots(2, sharex=True, gridspec_kw={"height_ratios": (.15, .85)})

# Add a graph in each part
sns.boxplot(df["sepal_length"], ax=ax_box)
sns.distplot(df["sepal_length"], ax=ax_hist)

# Remove x axis name for the boxplot
ax_box.set(xlabel='') 
```

[![在此处输入图像描述](../Images/2bfd9839e4a154e23d1946da7302da0e.png)](https://i.stack.imgur.com/LztGd.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T18:12:00.603

使用 matplotlib 有几种方法可以实现这一点。该`plt.subplots()`方法`AxesGrid1`和`gridspec`工具包都提供了非常优雅的解决方案，但可能需要时间来学习。

一种简单的蛮力方法是自己手动将轴对象添加到图形中。

```
import numpy as np
import matplotlib.pyplot as plt

# fake data
x = np.random.lognormal(mean=2.25, sigma=0.75, size=37)

# setup the figure and axes
fig = plt.figure(figsize=(6,4))
bpAx = fig.add_axes([0.2, 0.7, 0.7, 0.2])   # left, bottom, width, height:
                                            # (adjust as necessary)
histAx = fig.add_axes([0.2, 0.2, 0.7, 0.5]) # left specs should match and
                                            # bottom + height on this line should
                                            # equal bottom on bpAx line
# plot stuff
bp = bpAx.boxplot(x, notch=True, vert=False)
h = histAx.hist(x, bins=7)

# confirm that the axes line up 
xlims = np.array([bpAx.get_xlim(), histAx.get_xlim()])
for ax in [bpAx, histAx]:
    ax.set_xlim([xlims.min(), xlims.max()])

bpAx.set_xticklabels([])  # clear out overlapping xlabels
bpAx.set_yticks([])  # don't need that 1 tick mark
plt.show() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-19T15:37:57.407

这里有一个通用解决方案，作为一个包含 17 个 matplotlib 图形实用程序 + 用户指南的免费库：[https](https://www.mlbridgeresearch.com/products/free-article-2) ://www.mlbridgeresearch.com/products/free-article-2 。我厌倦了中断研究以编写实用软件，因此我积累了满足常见需求的库。该代码有据可查，并且运行良好。这是一个例子。

```
from sklearn.datasets import load_iris

import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

from statistics_utilities import histogram
from statistics_utilities import box_plot_basic

data = load_iris()
# iris, using the label column as a categorical
df = pd.DataFrame(data.data, columns=data.feature_names)
df['label'] = data.target

print(data.feature_names)

# setup the plot grid
plt.style.use('seaborn-darkgrid')
fig, ax = plt.subplots(1, 2)
ax = np.reshape(ax, (1, 2))

variable_name = 'sepal length (cm)'

# Place the histogram on the grid - pass the Axes.
# Plots a single histogram for a quantitative variable using seaborn's distplot().
# See also histogram_grid(), which plots a grid of histograms for a list of
# quantitative variables
hist_type = 'frequency'
# displays summary statistics in a custom legend, set legend=False to turn off.
ax[0, 0] = histogram(df, variable_name=variable_name, bins=20, kde=False, statistics='all',
                     hist_type=hist_type, title=None, ax=ax[0, 0])

# Place the box plot on the grid - pass the Axes
# Plots a single box_plot for a quantitative variable using matplotlib's boxplot().
# See also box_plot() and box_plot_groupby, which plots a quantitative variable
# by one or two categorical variables.
box_orientation = 'vertical'
box_width = .2
ax[0, 1] = box_plot_basic(df, variable_name=variable_name,
                          box_orientation=box_orientation, box_width=box_width, title=None,
                          ax=ax[0, 1])

# adjustments to plot size and spacing
fig.set_size_inches(13, 6)
fig.subplots_adjust(wspace=.55, left=0.035, right=.985, top=.925, bottom=.1)
fig.suptitle('iris dataset', fontsize=13)

plt.show()
plt.close() 
```

[![历史+框](../Images/d22f240fb9ba3a0e4211eee8e6f969c8.png)](https://i.stack.imgur.com/hFXb6.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-31T10:38:14.630

我正在寻找类似的东西，这对我有用。图片链接在这里[https://raw.githubusercontent.com/preetihemant/preetihemant.github.io/master/images/hist_boxplot.png](https://raw.githubusercontent.com/preetihemant/preetihemant.github.io/master/images/hist_boxplot.png)

```
plt.subplot(2,1,1)
plt.hist(data,histtype='bar',bins=[values]) 
plt.xlabel('x-label')
plt.ylabel('y-label')
plt.title('Graph title')

plt.subplot(2,1,2)
plt.boxplot(values)

plt.show() 
```

# spring - Spring Roo 错误：“客户端发送的请求在语法上不正确（）”

> ID：12127647
> 
> 赞同：0
> 
> 时间：2012-08-26T04:39:00.390
> 
> 标签：spring, hibernate, http, spring-roo, http-status-code-400

我正在尝试使用 Spring Roo 为我的数据库中的所有表生成 CRUD 操作。

我收到以下错误：

```
HTTP Status 400 - 
description The request sent by the client was syntactically incorrect (). 
```

使用Firebug，我可以看到生成的URL如下：

```
_users=1&mydb=4&_mydb=1&userId=2&jpost=testing&abuseCount=1&lastUpdatedTs=Aug+26%2C+2012 
```

错误是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T14:22:02.357

**我遇到了同样的错误，这就是导致它的原因**

我有一个表名 as`jpost`并且还有一个具有相同 name= 的列`jpost`。因此，当我发送`jpost=testing`（字符串）时，它会尝试将其转换为`jpost`实体类型，这会产生`ArgumantTypeMismatch`错误。我将列的名称更改为唯一的，它现在可以正常工作。

# iphone - 使用 Restkit 为 NSManagedObject 类创建实例

> ID：12127651
> 
> 赞同：2
> 
> 时间：2012-08-26T04:39:40.077
> 
> 标签：iphone, objective-c, xcode, core-data, restkit

我如何为使用核心数据模型创建的 NSmanagedObject 类创建一个实例。我有另一个类，它是 NSObject 的子类。我想为 NSManageObject 类创建一个对象。我怎样才能做到这一点。是否像我们为 NSobject 类创建实例的正常方式一样

ClassB.m //ClassB是NSObject类

```
ClassA *obj = [[ClassA alloc]init]; //ClassA is NSmanagedObject Class 
```

或者有什么办法吗？？？

我没有使用此代码（[Apple Docs](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/Articles/cdCreateMOs.html#//apple_ref/doc/uid/TP40001654-CJBDBHCB)）来创建实例

```
NSManagedObject *newEmployee = [[NSManagedObject alloc]

            initWithEntity:employeeEntity

            insertIntoManagedObjectContext:context]; 
```

我想知道，有没有办法使用restkit创建类似于上述代码的对象

注意：我使用 Restkit 来创建对象实例和映射。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T13:35:25.187

使用 Restkit，您可以在要创建的类上使用静态方法对象。在你的例子中

> `[ClassA object]`

会给你一个实例化的对象。

只要确保导入正确的标题：

> `#import <RestKit/CoreData.h>`

代替

> `#import <CoreData/CoreData.h>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T05:23:01.130

不，您不想通过 alloc/init 实例化 NSManagedObject。你应该使用`NSEntityDescription`'s `insertNewObjectForEntityForName:inManagedObjectContext:`。就像是：

```
ClassA *obj = [NSEntityDescription
    insertNewObjectForEntityForName:@"ClassA"
    inManagedObjectContext:context]; // ClassA is NSManagedObject Class 
```

为了拥有 a `NSManagedObjectContext`，您还需要 a`NSPersistentStoreCoordinator`和 an`NSManagedObjectModel`等。是的，这很复杂。 [这本书](https://rads.stackoverflow.com/amzn/click/com/0321670426)真的帮助我了解了 Core Data。我全心全意地推荐它。

请参阅[核心数据编程指南中有关创建和删除托管对象](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdCreateMOs.html)的部分。实际上，当您在那里时，我建议您阅读整个[核心数据编程指南](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreData/cdProgrammingGuide.html#//apple_ref/doc/uid/TP30001200-SW1)。Core Data 令人惊叹且功能强大，但也很复杂；你真的很想知道你在做什么。

**更新**：您使用 RestKit 的事实可能会改变我上面所说的。可能是 RestKit 有自己的 API 来处理 Core Data 的东西，我不确定。也许检查文档。

# java - 通过命令窗口执行 Java 程序

> ID：12127654
> 
> 赞同：-5
> 
> 时间：2012-08-26T04:41:00.923
> 
> 标签：java

我有一个查询，由于我主要使用 eclipse 来执行 java 类，但我想知道我是否不使用 eclipse 并且我想执行 java 程序，那么我还必须手动设置路径和类路径，我有我的jdk 在 C: 驱动器中的 java 文件夹内，我的程序位于名为 AA 的文件夹内，命名为 Temp.java ，请告知如何为此设置路径和类路径，以便从命令窗口本身执行 java 程序..！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T04:44:28.697

您可以设置安装 jdk bin 路径的环境路径，然后您可以从任何位置编译和运行 java 程序。

```
My compute->right click->system properties->advanced tab->select system variable path-> select edit->then add your jdk bin path. save the setting. 
```

**在 Windows 上设置路径**

```
Windows 7
Select Computer from the Start menu
Choose System Properties from the context menu
Click Advanced system settings > Advanced tab
Click on Environment Variables, under System Variables, find PATH, and click on it.
In the Edit windows, modify PATH by adding the location of the class to the value for PATH. If you do not have the item PATH, you may select to add a new variable and add PATH as the name and the location of the class as the value.
Reopen Command prompt window, and run your java code. 
```

[参考](http://www.java.com/en/download/help/path.xml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T04:45:49.593

您可以使用以下方法设置当前工作目录的路径：

```
path=%path%;c:\Java\jdk[followedbyversion]\bin 
```

这会临时设置路径，并且在系统重新启动时，您将不得不再次设置路径。

如果在 Windows 上工作，您可以使用环境变量永久设置路径。右键单击我的电脑 -> 属性 -> 高级系统设置 -> 环境变量 -> 然后添加一个用户环境变量，将其命名为路径并将路径设置为 jdk 的 bin。

# php - preg_replace 从字符串中删除电话号码

> ID：12127655
> 
> 赞同：-1
> 
> 时间：2012-08-26T04:41:10.250
> 
> 标签：php, regex, preg-replace, preg-match

我有一个网站，我需要阻止用户通过邮件向其他用户发送联系电话/电子邮件，

我在下面有点成功地使用它，但它并没有做我想做的事情，即..匹配所有场景

```
public function clean_email($text){
    $pattern = '/\w+[\w-\.]*(\@\w+((-\w+)|(\w*))\.[a-z]{2,3})/i';
    preg_match($pattern, $text, $matches);
    return (isset($matches[1])) ? str_replace($matches[1], 
            "[********]", $text) : $text;
}

public function clean_phone($text){
    $pattern = '/(\d{3}|\d{4})|(\d{3,+})/i';
    preg_match($pattern, $text, $matches);
    return (isset($matches[1])) ? str_replace($matches[1], 
               "[********]", $text) : $text;
} 
```

我正在考虑使用 preg_replace 来识别邮件文本中的电话号码，但是我知道电话号码可以用多种方式编写，如下所示，

```
0433 765 888
0433765888
+61433765888
+610433765888
+61 02 9876 0987
+61 0298760987
+610298760987 
```

是否可以编写一个单一的 preg_replace 模式来识别它们？

还需要对电子邮件地址做同样的事情，我也想在我们在电子邮件文本中找到的每个电子邮件地址中用 [censored] 替换它们。IE

```
mlanXXX@hotmail.com
mlanXXX AT hotmail.com 
```

运气好的话 ..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T05:01:39.133

我是一个广泛使用的 Firefox 单位转换扩展的作者，所以当人们想要在非对抗性环境中传达信息时，我对人们如何用人类语言编写东西有很多经验。也就是说，当他们没有受到积极试图审查他们的对手的阻碍时。我告诉你，即使在这种情况下，正则表达式也不可能**总是**弄清楚它们想要传达的内容。

为了提供这个答案，我需要很长的介绍：不，它不能完成。你能做的就是参加军备竞赛。也就是说，实现现在可以使用的任何简约正则表达式，然后持续监控用户的通信并根据他们提出的任何内容改进您的正则表达式以规避您。

但是请注意，您永远找不到令人满意的解决方案，因为很快您就会陷入烦人的误报中。以“我在 amazon.com 找到这双鞋”为例。您的代码会将其更改为“我发现这些 [审查]”。电话号码更糟糕，因为人们可以将选定的数字写成单词（“043three376five ...”），所以你最终不得不审查所有提到的任何数字。

这本质上是一个无法通过技术手段解决的社会问题。如果我是你，我会做的是实现几个明显的正则表达式（从而吸引 99% 的坦率用户），并通过社交规则执行规则。也就是说，通过驱逐试图规避它的人来执行 EULA。

# python - 简单的 Python 类继承问题

> ID：12127656
> 
> 赞同：2
> 
> 时间：2012-08-26T04:41:10.743
> 
> 标签：python, class

> **可能的重复：**
> [为什么属性引用在 Python 继承中会像这样？](https://stackoverflow.com/questions/206734/why-do-attribute-references-act-like-this-with-python-inheritance)
> [Python：派生类访问同一内存位置中基类的字典](https://stackoverflow.com/questions/12111816/python-derived-classes-access-dictionary-of-base-class-in-the-same-memory-locat)

让我们看代码：

```
class parent:
    book = {'one':1, 'two':2}

class child(parent):
    pass

first = child()
second = child()

print first.book
print second.book

second.book['one'] = 3

print first.book
print second.book 
```

当您运行此对象时，“首先”已编辑其字典！怎么回事？我认为“第一”和“第二”是“孩子”类的独立实例。这里发生了什么？为什么您在第二次编辑的内容首先会影响？

我可以通过在每个子类中重新创建书籍来“解决”这个问题，但这不是正确的方法，我想以它们应该被使用的方式利用类。

我究竟做错了什么？

顺便说一句，我的主要语言是 cpp，所以也许我将 cpp 与 python 或类似的愚蠢混淆了......

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T04:48:40.970

您将 book 声明为父类的静态变量。这意味着在加载模块时变量被初始化。

您希望在创建类时对其进行初始化，因此您需要**init**方法，该方法是在构造每个实例时自动调用的方法。

您还需要手动调用父**级 init**。

```
class parent:
    def __init__(self):
        self.book = {'one':1, 'two':2}

class child(parent):
    def __init__(self):
        parent.__init__(self)

first = child()
second = child()

print first.book
print second.book

second.book['one'] = 3

print first.book
print second.book 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T04:48:45.760

为了给类的每个实例它自己的字典和名字簿，你需要使用`self`符号。

```
class parent:
    def __init__(self):
        self.book = {'one':1, 'two':2}

class child(parent):
    pass

first = child()
second = child()

print first.book
print second.book

second.book['one'] = 3

print first.book
print second.book 
```

输出：

```
>>> 
{'two': 2, 'one': 1}
{'two': 2, 'one': 1}
{'two': 2, 'one': 1}
{'two': 2, 'one': 3}
>>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T04:45:21.330

Python 在处理类定义时初始化这些类范围变量，然后始终使用相同的对象。

如果您希望字典对每个实例都是唯一的，请在对象构造期间通过实现来分配它`__init__`。

# linux - 无显示模式下的 Matlab GA 绘图

> ID：12127659
> 
> 赞同：0
> 
> 时间：2012-08-26T04:42:30.457
> 
> 标签：linux, matlab, terminal, plot, save

我正在使用 matlab GA 和绘图选项“gaplotrange”。但我正在通过终端在 Linux 服务器上运行 matlab。因此，当我尝试保存 gaplot 时，我要么不断得到一个空图像（如果我使用 saveas）或错误（如果我使用 print，我收到一条消息说它在当前平台中不受支持）。

有没有其他方法可以在 nodisplay 模式下保存绘图？

这是我的一段代码

```
opts = gaoptimset('PopulationSize', 256, 'EliteCount',1,'CrossoverFraction',0.8, ...
 'Generation', 3, 'PenaltyFactor',80,'SelectionFcn',{@selectiontournament,4}, ...
 'CrossoverFcn', @crossoverscattered ,'Vectorized','off', 'UseParallel','always',...
 'OutputFcns',@pop_output,'MutationFcn',{@mutationuniform,0.002},'StallGenLimit',3,...
 'TolFun', 1e-4,'PlotFcns',@gaplotbestf);

f = figure('vis','off');

[x,fval, exitflag, output, population, scores] = ga(@plate_fitness,16,[],[],[],[],vlb,vub,[],opts);

hgsave(f,'matlabga_range','png'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T14:23:44.607

Matlab 有一个[发布在这里的解决方案](http://www.mathworks.com/support/solutions/en/data/1-1KY74I/index.html?product=ML&solution=1-1KY74I)

```
hgsave('filename')
hgsave(h,'filename') 
```

我对遗传算法工具箱没有太多经验，但快速浏览一下文档就可以看出这一点

> 要在从命令行调用 ga 时显示绘图，请将选项的 PlotFcns 字段设置为绘图函数的函数句柄。例如，要显示最佳适应度图，设置选项如下
> 
> 选项= gaoptimset（'PlotFcns'，@gaplotbestf）；

因此，如果您没有传递`'PlotFcns'`绘图函数的句柄，它看起来不会基于命令行交互生成绘图。添加它，看看它是否能解决你的问题，更多细节[在这里](http://www.mathworks.com/help/toolbox/gads/f6174dfi10.html)

**更新：**

原来问题在于 ga 方法的绘图正在创建自己的图形，因此需要保存在 上`gcf`，有关更多详细信息，请参阅下面的讨论。

# django - Django 'QuerySet' 对象没有使用 modelform 的属性'split'

> ID：12127662
> 
> 赞同：2
> 
> 时间：2012-08-26T04:43:30.393
> 
> 标签：django, django-forms, django-queryset

我无法让我的视图更新多对多字段。它在表单提交后返回。

```
Traceback:
File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/home/footbook/Ubuntu One/webapps/fb/poc/../poc/activity/views.py" in activity_save_page
  44\.             group_names = form.cleaned_data['groups'].split()

Exception Type: AttributeError at /activity_save/
Exception Value: 'QuerySet' object has no attribute 'split' 
```

这是文件。模型.py

```
class Group (models.Model):
    group_nm = models.CharField(max_length=64)
    group_desc = models.CharField(max_length=250)
    created = models.DateTimeField(auto_now_add=True)
    active_yn = models.BooleanField(default=True)
    def __unicode__(self):
        return self.group_nm

class Activity(models.Model):
    activity_nm = models.CharField(max_length=60)  
    activity_desc = models.CharField(max_length=250)
    startdt = models.DateField()
    enddt = models.DateField()
    crdt = models.DateTimeField(auto_now_add=True,editable=False)
    groups =  models.ManyToManyField(Group)
    upddt = models.DateTimeField(editable=False)
    def  save(self, *args, **kwargs):
        if not self.id:
            self.crdt = datetime.date.today()
        self.upddt = datetime.datetime.today()
        super(Activity, self).save(*args, **kwargs)
    def __unicode__(self):
        return self.name 
```

表格.py

```
def make_custom_datefield(f):
    formfield = f.formfield()
    if isinstance(f, models.DateField):
        formfield.widget.format = '%m/%d/%Y'
        formfield.widget.attrs.update({'class':'datePicker', 'readonly':'true'})
    return formfield

class ActivitySaveForm(forms.ModelForm):
    formfield_callback = make_custom_datefield
    def __init__(self, *args, **kwargs):
        super(ActivitySaveForm, self).__init__(*args, **kwargs)
        self.fields['activity_nm'].label = "Activity Name"
        self.fields['activity_desc'].label = "Describe It"
        self.fields['startdt'].label = "Start Date"
        self.fields['enddt'].label = "End Date"
        self.fields['groups'].label ="Group"
    class Meta:
        model = Activity 
```

视图.py

```
def activity_save_page(request):
    if request.method == 'POST':
        form = ActivitySaveForm(request.POST)
        if form.is_valid():
            act, created = Activity.objects.get_or_create(
                activity_nm = form.cleaned_data['activity_nm']
            )
            act.activity_desc = form.cleaned_data['activity_desc']
            if not created:
                act.group_set.clear()
            group_names = form.cleaned_data['groups'].split()
            for group_name in group_names:
                group, dummy = Group.objects.get_or_create(group_nm=group_name)
                act.group_set.add(group)
            act.save()
            return HttpResponseRedirect('/activity/')
    else:
        form = ActivitySaveForm()
    variables = RequestContext(request, {
        'form': form
    })
    return render_to_response('activity_save.html', variables) 
```

我认为如果我不使用模型表单它会起作用，但我需要它来实现[这个日期选择器。](https://stackoverflow.com/questions/660929/how-do-you-change-the-default-widget-for-all-django-date-fields-in-a-modelform "所以回答日期选择器问题。")由于它是一个多对多字段，我想在将它们输入数据库时​​将它们拆分，但我的查询集失败了。我试过用很多不同的方式改变它，但我被卡住了。我见过很多类似的问题，但它们要么有外键，要么没有模型形式。

谢谢。

编辑：activity_save.html

```
{% extends "base.html" %}
{% block title %}Save Activity{% endblock %}
{% block head %}Save Activty{% endblock %}
<input class="datePicker" readonly="true" type="text" id="id_startdt" />
<input class="datePicker" readonly="true" type="text" id="id_enddt" />
{% block content %}

<form action="{% url activity.views.activity_save_page act_id%}" method="post">{% csrf_token %}

{{ form.as_p }} 

<input type="submit" value="save it" />
</form>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T05:50:30.953

正如错误所描述的那样： a`QuerySet`没有`split`方法。你不能打电话`my_qs.split()`。

`form.cleaned_data['groups']`返回*清理后的*数据；它已经为您处理了字符串到 python 对象的形式转换，在 a 的情况下`ManyToManyField`最终由`QuerySet`python 中的 a 表示。

日期字段通过表单清理以相同的方式返回日期对象，IntegerField 为整数，CharFields 为字符串等。

如果您想要 的列表`group_names`，则需要显式地遍历 中的对象`QuerySet`并提取它们的`group_nm`属性。

```
 group_names = [x.group_nm for x in form.cleaned_data['groups']] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T05:57:17.300

我不确定您是否需要在您的视图中执行所有这些操作。您可以直接将表单保存在视图中，而无需手动创建对象和操作它们。

此外，您需要获取活动的 ID，以便您可以更新现有的活动实例。

更新`urls.py`以拥有这些网址`act_id`：

```
url(r'^activity_app/save/(?P<act_id>\d+)/$', 'activity_app.views.activity_save_page'),
url(r'^activity_app/save/$', 'activity_app.views.activity_save_page'), 
```

我会将视图更改为：

```
def activity_save_page(request, act_id=None):
    act_inst = None
    try:
        if act_id:
           act_inst = Activity.objects.get(id=act_id)
    except Exception:
        pass
    if request.method == 'POST':
        form = ActivitySaveForm(request.POST, instance=act_inst)
        if form.is_valid():
            return HttpResponseRedirect('/activity/')
    else:
        form = ActivitySaveForm(instance=act_inst)
    variables = RequestContext(request, {
        'form': form
        })
    return render_to_response('activity_save.html', variables) 
```

# android - ListView内的EditText显示随机值

> ID：12127666
> 
> 赞同：1
> 
> 时间：2012-08-26T04:44:12.720
> 
> 标签：android, listview, android-edittext

我在 ListView 中有 EditText 用于内联编辑。用户可以修改其值，然后将值存储在 SQLite 数据库中。

我正在使用自定义 DataAdapter 来填充 ListView。

列表视图中有 15 行。一次可见 4 行，使用滚动条查看其他行（向上/向下）

**问题**：第一次加载 ListView。用户在每个 EditText 中写入 EditText 1、2、3、4。滚动条向下移动，用户将数据一一输入到所有行中。当用户向上移动滚动条以查看前 4 行...**第 4 行显示错误数据而不是 4 它显示 14，这是用户输入的最后一个值**（或者我有一些其他随机值，例如 10/ 13/11 等）

在我的自定义 DataAdapter 类中，当 EditText 失去焦点时，我将用户输入存储到数据源中，如下所示：

```
public View getView(int position, View convertView, ViewGroup parent) {
//txtComments is an EditText 
holder.txtComments.setId(position);
holder.txtComments.setOnFocusChangeListener(new OnFocusChangeListener() {
    public void onFocusChange(View v, boolean hasFocus) {
    if (!hasFocus){
        final int position = v.getId();
        final EditText tempComments = (EditText) v;
             // items: the DataSource for the listView
        items.get(position).Comments = tempComments.getText().toString();
    }
    }
});
} 
```

![在此处输入图像描述](../Images/697cab4e1b1b939b5b57a4545874b605.png)

**编辑：**

我也尝试过 TEXTWATCHER，但它对我不起作用。

经过广泛的测试；我们发现这个问题是随机发生的，例如有时 ExitText11 会显示错误的值，而 ExitText4 会显示错误的值，或者它们都会显示错误的值，并且在向下移动滚动条时，这种行为会发生变化。

# php - 防止跨站点文件上传到我的服务器？

> ID：12127672
> 
> 赞同：0
> 
> 时间：2012-08-26T04:45:45.543
> 
> 标签：php, linux, apache, iptables

有没有办法将文件从其他网站上传到我的网站？

我有一个表单，它采用半大视频文件并在表单在客户端和服务器端提交后使用令牌进行身份验证。但是，由于我们可能有 300 人同时上传文件，我们不希望一些跨站点黑客尝试上传无论如何都不会通过的文件。

他们甚至尝试的问题是，当文件开始上传时，它会占用我们的内存资源（对吗？）和带宽。

我正在寻找的解决方案是有 apache 或 iptables 或将文件发送到的 php 脚本，一旦发现它不是来自网站的上传页面，就不允许上传。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T04:59:23.013

该解决方案将使用表单令牌来确保表单仅通过您的服务器提交。为此，请创建一个带有随机值的表单标记，将其放入会话以及隐藏的表单字段中。发布表单时，对照会话检查此隐藏字段的值。如果表单令牌存在并且匹配会话允许上传，否则不允许。

**您的上传表单页面**

**PHP代码：**

```
$token = md5 (uniqid (rand (), true));
$_SESSION[“token”] = $token; 
```

**HTML 代码：**

```
<form> 
 <input type="file" />
<input type=”hidden” name=”token” value=”&lt;?php echo $token;?>”&gt;
</form> 
```

**`$_SESSION["token"]`每次用户请求您的上传页面上传新文件时，**您的提交页面都会被覆盖。**所以你不必担心它的值会被重置。**

# asp.net - GridView 行样式和属性未呈现

> ID：12127677
> 
> 赞同：1
> 
> 时间：2012-08-26T04:47:29.940
> 
> 标签：asp.net

我正在尝试在 OnRowDataBound 事件中向我的 GridView 添加样式并添加行行为（更改光标并添加 onmouseover 和 onmouseout 以突出显示一行）。当我使用 HtmlTextWriter 在该方法中显示行的标记时，一切看起来都很好。但是，在浏览器端的页面源中，我的 <tr> 元素根本没有属性。如果我在页面的 OnPreRender 或 OnPreRender 完成事件中转储标记，我发现我的更改已经消失了。这里发生了什么？

我正在使用 VS2010 Professional 并针对 3.5 框架。

更新：我尝试了一些不同的方法来确定哪里出了问题。我对 GridView 和 GridViewRow 进行了子类化，以便我可以在一些方法调用之前确定我的设置何时被破坏。结果是在 GridView.RenderControls() 中删除了我的属性。我不明白这一点，因为有几十个例子（包括在这个网站上）使用这种技术添加 javascript 事件。我最终通过覆盖我的子类中的 RenderControl() 方法并使用它来调用 base.Render() 而不是 base.RenderControl() 取得了成功......奇怪但真实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:06:48.500

我最终通过子类化 GridView 并在我的子类中覆盖 RenderControl() 方法并使用它来调用 base.Render() 而不是 base.RenderControl() 来取得成功......奇怪但真实。

# ruby-on-rails-3 - HashWithIndifferentAccesswhile 在多对一关系的发布请求中

> ID：12127683
> 
> 赞同：0
> 
> 时间：2012-08-26T04:49:00.737
> 
> 标签：ruby-on-rails-3, activerecord, multi-model-forms

```
class Item < ActiveRecord::Base
  attr_accessible :name, :item_reviews
  has_many :item_reviews, :dependent => :destroy
  accepts_nested_attributes_for :item_reviews
end

class ItemReview < ActiveRecord::Base
  attr_accessible :price, :value_for_money
  belongs_to :item
end 
```

我正在使用多模型表单来发布新项目的请求（带有审查）。我在发布请求中使用以下参数：

```
{"utf8"=>"✓",
 "authenticity_token"=>"oZZ6T5bxWHnSiO2Tdz3eFUVCrRH3lzzxdBpuJjlWcho=",
 "item"=>{"name"=>"test",
 "item_reviews"=>[{"value_for_money"=>"1",
 "price"=>"25000"}]},
 "commit"=>"Submit"} 
```

但是保存时出现以下错误：

```
ItemReview(#89032230) expected, got ActiveSupport::HashWithIndifferentAccess(#77848120) 
```

我怀疑 item_reviews 中的数组是罪魁祸首，所以我做了以下事情：

```
params[:item][:item_reviews] =  params[:item][:item_reviews][0] 
```

但后来我开始收到以下错误：

```
ItemReview(#87446700) expected, got Array(#75744590) 
```

我该如何解决？

# c - 为什么 file_operations 中的 unlocked_ioctl 返回 long，而 sys/ioctl.h 中的 ioctl() 返回 int？

> ID：12127684
> 
> 赞同：2
> 
> 时间：2012-08-26T04:49:33.030
> 
> 标签：c, unix, linux-kernel, linux-device-driver, ioctl

struct file_operations 中的 unlocked_ioctl 的签名是

```
long (*unlocked_ioctl) (struct file *, unsigned int, unsigned long); 
```

而 man 2 ioctl 说 ioctl(2) 的签名是：

```
int ioctl(int d, int request, ...); 
```

我知道参数是如何在内核中被破坏的，但是为什么内核空间中的返回类型很长，而用户空间却是 int？当我想将负值作为错误返回时，这会产生一个问题：由于双补码编码，我返回的所有负值都会变成 -1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T04:56:02.313

如果您从函数返回负值`file_operations`，内核会将其解释为负值`errno`（即错误返回）。然后用户代码`-1`作为返回值，`errno`设置为原始返回值的否定。这与二进制补码无关。

例如，如果您`-ENOTTY`从中返回，用户程序会从和中`unlocked_ioctl`获得 -1 。`ioctl``errno = ENOTTY`

# html - 是否可以在一行中调用样式表的外部 div 内的内部 div？

> ID：12127685
> 
> 赞同：0
> 
> 时间：2012-08-26T04:49:34.263
> 
> 标签：html, css, wordpress

我正在使用 wordpress，并且我有一个想要样式的元素...它被称为...

```
<h2 class="widgettitle"> 
```

现在，我知道我能做到，

```
h2.wigettitle {
whatever:css;
} 
```

但是，我遇到的问题是我有多个具有相同标题的小部件，并且会影响所有小部件。

但是，这个 h2.widget 标题在另一个名为“headerarea”的 div 中。

所以，在我的文件中，它就像......

```
<div id=headerarea">
    <h2 class="widgettitle">
               whatever title
    </h2>
</div> 
```

那么是否可以让这个特定的元素做一些事情，比如#headerarea.h2.widgettitle 或者我的元素中的东西？

我尝试独立设置外部 div 的样式，但内部 div 仍在从其他地方获取样式，所以我需要覆盖所有这些样式。

希望这是有道理的...感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T04:54:06.153

使用`#headerarea h2.widgettitle`. 包括一个空间意味着看孩子们。如果包含 a`>`这意味着只查看直接子级。请注意，如果您的覆盖不起作用，请`!important`在末尾添加以确保它们将覆盖应用的任何其他样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T04:56:49.867

您可以使用子选择器或后代选择器来完成此操作。子选择器`>` `#headerarea > h2.widgettitle`选择具有类 widgettitle 的 h2 元素，该类是具有 id headerarea 的元素的子元素。后代选择器空间`#headerarea h2.widgettitle`选择具有类 widgettitle 的 h2 元素，该元素是具有 id headerarea 的元素的后代。

另见[http://www.w3.org/TR/css3-selectors/#selectors](http://www.w3.org/TR/css3-selectors/#selectors)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T04:54:30.973

```
#headerarea .widgettitle {
    /* Put your styles here */
} 
```

# c# - 如何在 CLI :: C++ 中使用委托 - 匿名委托？

> ID：12127688
> 
> 赞同：2
> 
> 时间：2012-08-26T04:50:10.610
> 
> 标签：c#, .net, mvvm, c++-cli

我有一个 C++/CLI 应用程序 - 我使用 MVVM 模式。
每隔一段时间，我希望它把它的事件发布到主 GUI。我已经在 GUI 和按钮事件之间建立了连接，所以如果引发按钮事件，我可以制作关闭对话框 - 但我正在努力将语法从 C# 转换为 C++：

```
 viewModel->OKButtonCommand += delegate
 {
         dialogResult = System::Windows::Forms::DialogResult::OK;
         dlg->Close();
 };

viewModel->CancelButtonCommand += delegate
{
         dialogResult = System::Windows::Forms::DialogResult::Cancel;
         dlg->Close();
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T07:28:54.027

C++/CLI 中没有匿名委托。您必须将委托转换为普通的类方法并以这种方式引用它。

# javascript - 在 Perl CGI 脚本中捕获 iframe 返回值

> ID：12127690
> 
> 赞同：1
> 
> 时间：2012-08-26T04:51:02.187
> 
> 标签：javascript, html, css, perl, cgi

我认为这是一个非常基本的问题。我正在尝试使用 Perl CGI 开发网页。我的表单中有一个文本编辑器（使用 iframe）。代码：

```
<iframe id="textEditor" style="width:500px; height:170px;background-color:white">
</iframe> 
```

我正在尝试使用 param 函数捕获我在 Perl CGI 代码中提交表单时在文本编辑器中编写的内容。但是失败了！！请帮帮我。

有与iframe相关的代码：

```
<iframe id="textEditor" style="width:500px; height:170px;background-color:white">
</iframe>
<script type="text/javascript">
<!--
textEditor.document.designMode="on";
textEditor.document.open();
textEditor.document.write(\'<head><style type="text/css">body{ font-family:arial; font-size:13px; }</style> </head>\');
textEditor.document.close();
function def()
{
   document.getElementById("fonts").selectedIndex=0;
   document.getElementById("size").selectedIndex=1;
   document.getElementById("color").selectedIndex=0;
}
function fontEdit(x,y)
{
   textEditor.document.execCommand(x,"",y);
   textEditor.focus();
}
-->
</script> 
```

我正在尝试使用 CGI param() 函数捕获在文本编辑器中写入的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T17:21:26.600

客户端只会传递来自 named或HTML 中元素内的元素的`<input>`数据。要从 中的 JavaScript 编辑器传回数据，您需要使用 JavaScript 设置输入元素的值。`<select>``<textarea>``<form>``<iframe>`

根据[本教程](http://www.evagoras.com/2011/02/02/web-based-content-editor-using-iframe/)，你会希望你的 HTML 看起来像

```
<form name="myForm" action=".../my-cgi-script.cgi" method="POST">
    <input name="editorData" type="hidden" value="">
    ... other input elements ...
    <iframe id="textEditor" ...></iframe>
</form> 
```

当按下提交按钮时，您将需要一些这样的 JavaScript 来运行。

```
document.myForm.editorData.value = textEditor.document.body.innerHTML;
document.myForm.submit(); 
```

在服务器端，该参数`editorData`将包含您的文本编辑器的内容。

# c - 为什么 memcpy 和 sprintf 在这个内核代码中不起作用？

> ID：12127695
> 
> 赞同：1
> 
> 时间：2012-08-26T04:52:38.230
> 
> 标签：c, linux-kernel, kernel

为什么内核代码中的`memcpy`和`sprintf`在以下代码中失败？

```
static inline void my_func(){
    char* src,dst;
    int a =9; int b=10;

    src = sprintf("a= %d b= %d",a,b); 
    dst = kmalloc(strlen(src)*sizeof(char) , GFP_KERNEL);
    memcpy(dst, src, strlen(src));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T05:17:38.807

sprintf 打印到一个 char 数组中。因此，正确的用法是，

```
char src [MAX_CHARS];
sprintf(src, "a = %d, b = %d", a, b); 
```

或者，您可以在调用 sprintf 之前使用`char *src`和分配内存。`src`

dest 的声明应该是，

```
char *src, *dest; 
```

另一个需要注意的问题是，在 中`memcpy(dst, src, strlen(src))`，strlen 返回不带终止空字符的字符串长度。因此，如果要复制整个字符串以及空字符，则必须将函数返回的值加 1 `strlen`。

```
dest = malloc( strlen(src) + 1 );
memcpy( dest, src, strlen(src) + 1 ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T04:57:26.597

您可以使用 kmalloc、kfree、ksnprintf -

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-09T16:28:22.677

除了您遇到的其他编码问题外，请使用 snprintf() 和 kmemdup()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T04:53:21.830

因为在内核编程中都不存在。

libc 函数对内核不可用，仅仅是因为它们会将内核与语言标准联系起来——而且其中一些函数对于内核使用来说是非常有效的。Arvind 提供了内核等价物。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T05:29:48.137

内核 C 库和 libc 都是不同的。避免在内核模块中使用 libc 函数。这里 sprintf 在 libc 下。

# php - 保存 PHP 文件 XAMPP 时如何删除错误消息？（苹果电脑）

> ID：12127700
> 
> 赞同：0
> 
> 时间：2012-08-26T04:53:29.050
> 
> 标签：php, macos, xampp

我一直在努力寻找答案。我正在为 mac 使用文本牧马人。当我尝试保存时出现错误。我将我的 XAMPP 放在我的应用程序文件夹中，我认为它在应用程序文件夹中，您无法进行任何更改。我需要知道如何保存它。顺便说一句，当我移动某些东西时，它会一直要求我进行身份验证。帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:31:43.893

这也发生在我之前。您很可能需要更改目录权限。转到“/Applications/XAMPP/”，然后更改`htdocs`目录的权限。[就是这样。](http://osxdaily.com/2011/02/21/change-file-permissions-mac/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T05:32:45.890

你只是没有权限保存它。如果您想这样做，请授予文本管理员权限。你可以在终端试试这个。

```
sudo open filename -a applicationname.app 
```

例如：

```
sudo open test.php -a Coda.app 
```

或者您可以尝试在终端中使用**chmod**更改文件夹的访问权限，例如：

```
chmod 774 foldername 
```

# perl - Perl：如何在已排序的文本文件中添加一行

> ID：12127702
> 
> 赞同：0
> 
> 时间：2012-08-26T04:53:53.967
> 
> 标签：perl, file

我想在 perl 中的文本文件中添加一行，其中包含排序形式的数据。我已经看到了一些示例，这些示例显示了如何在文件末尾附加数据，但是因为我希望数据采用排序格式。

请指导我如何做到这一点。

基本上从我到目前为止所尝试的：（我打开一个文件，grep它的内容以查看我要添加到文件中的行是否已经存在。如果确实存在，则退出，否则将其添加到文件中（这样数据保持排序格式）

```
open(my $FH, $file) or die "Failed to open file $file \n";
@file_data = <$FH>;
close($FH);
my $line = grep (/$string1/, @file_data);
if($line) {
   print "Found\n";
   exit(1);
}
else
{
  #add the line to the file
  print "Not found!\n";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T09:17:03.010

这是一种使用[Tie::File](http://search.cpan.org/perldoc?Tie%3a%3aFile)的方法，以便您可以轻松地将文件视为数组，并使用[List::BinarySearch](http://search.cpan.org/perldoc?List%3a%3aBinarySearch)的`bsearch_str_pos`函数快速找到插入点。找到插入点后，检查该点的元素是否等于插入字符串。如果不是，`splice`则将其放入数组中。如果相等，则不要将其拼接。并完成以`untie`使文件干净地关闭。

```
use strict;
use warnings;
use Tie::File;
use List::BinarySearch qw(bsearch_str_pos);

my $insert_string = 'Whatever!';
my $file          = 'something.txt';

my @array;
tie @array, 'Tie::File', $file or die $!;

my $idx = bsearch_str_pos $insert_string, @array;

splice @array, $idx, 0, $insert_string
    if $array[$idx] ne $insert_string;

untie @array; 
```

[List::BinarySearch](http://search.cpan.org/perldoc?List%3a%3aBinarySearch)中的`bsearch_str_pos`函数是对[Mastering Algorithms with Perl](http://shop.oreilly.com/product/9781565923980.do)中的二进制搜索实现的改编。它方便的特点是，如果没有找到搜索字符串，它会返回可以插入的索引点，同时保持排序顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T05:02:52.987

既然您无论如何都必须阅读文本文件的内容，那么另一种方法怎么样？

逐一阅读文件中的行，与您的目标字符串进行比较。如果您读取的行等于目标字符串，那么您无需执行任何操作。

否则，您最终会根据排序标准读取比当前行“更大”的行，或者您到达文件末尾。在前一种情况下，您只需在该位置插入字符串，然后复制其余行。在后一种情况下，您将字符串附加到末尾。

如果您不想那样做，您可以进行二进制搜索`@file_data`以找到添加行的位置，而无需检查所有条目，然后在将数组输出到文件之前将其插入到数组中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T09:37:07.870

这是一个简单的版本，它从标准输入（或命令行上指定的文件名）读取，如果在输入中找不到，则将“要附加的字符串”附加到输出。输出打印在标准输出上。

```
#! /usr/bin/perl 

$found = 0;
$append='string to append';

while(<>) {
    $found = 1 if (m/$append/o);
    print
}

print "$append\n" unless ($found);; 
```

修改它以就地编辑文件（使用 perl -i）并从命令行获取附加字符串将非常简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T12:15:45.107

在不使用任何模块的情况下插入一行的“简单”单行可能是：

```
perl -ni -le '$insert="lemon"; $eq=($insert cmp $_); if ($eq == 0){$found++}elsif($eq==-1 && !$found){print$insert} print' 
```

给予者 a`list.txt`的上下文是：

```
ananas
apple
banana
pear 
```

输出是：

```
ananas
apple
banana
lemon
pear 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T23:41:17.270

```
{
  local ($^I, @ARGV) = ("", $file); # Enable in-place editing of $file

  while (<>) {
    # If we found the line exactly, bail out without printing it twice
    last if $_ eq $insert;
    # If we found the place where the line should be, insert it
    if ($_ gt $insert) {
      print $insert;
      print;
      last;
    }
    print;
  }
  # We've passed the insertion point, now output the rest of the file
  print while <>;
} 
```

基本上与帕维尔的答案相同，除了增加了很多可读性。请注意，它`$insert`应该已经包含一个尾随换行符。

# c# - 我正在从 xml 文件中解析一些文本，我该如何解析名称？

> ID：12127706
> 
> 赞同：1
> 
> 时间：2012-08-26T04:55:28.040
> 
> 标签：c#

这是功能：

```
private void ParseAndDisplayXml(string filename)
        {
            XDocument document = XDocument.Load(filename);
            var list = document.Root.Elements("Message")
                .Select(
                e => new
                {
                    Date = e.Attribute("Date").Value.ToString(),
                    Time = e.Attribute("Time").Value.ToString(),
                    Text = e.Element("Text").Value.ToString(),
                    Name = e.Element("FriendlyName").Value.ToString()
                }
                );
 string result="";
            foreach (var item in list)
            {
               result += string.Format("Date--{0},Time--{1},Text--{2},Name--{3}", item.Date, item.Time, item.Text, item.Name + Environment.NewLine);

            }
            textBox1.Text = result;
        } 
```

我在这部分的 Name 变量上为空：

```
 {
                    Date = e.Attribute("Date").Value.ToString(),
                    Time = e.Attribute("Time").Value.ToString(),
                    Text = e.Element("Text").Value.ToString(),
                    Name = e.Element("FriendlyName").Value.ToString()
                } 
```

这是 xml 文件中的一些内容：

```
<?xml version="1.0"?>
<?xml-stylesheet type='text/xsl' href='MessageLog.xsl'?>
<Log FirstSessionID="1" LastSessionID="2"><Message Date="31/01/2012" Time="10:15:42" DateTime="2012-01-31T08:15:42.467Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">היי</Text></Message><Message Date="31/01/2012" Time="10:15:55" DateTime="2012-01-31T08:15:55.097Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">הייתה לי בעיה עם התוכנת ברקים אבל עכשיו הכל עובד.</Text></Message><Message Date="31/01/2012" Time="10:15:58" DateTime="2012-01-31T08:15:58.897Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">מה השלב הבא ?</Text></Message><Message Date="31/01/2012" Time="10:16:27" DateTime="2012-01-31T08:16:27.775Z" SessionID="1"><From><User FriendlyName="Chocolade"/></From><To><User FriendlyName="adilipman@yahoo.com"/></To><Text Style="font-family:Segoe UI; color:#000000; ">אמרת לי בזמנו לחשב ממוצע של 1000 ערכים ? הכוונה 1000 ערכים בפריים ? כי בפריים יש 256 מספרים לא ?</Text></Message><Message Date="31/01/2012" Time="10:17:03" DateTime="2012-01-31T08:17:03.405Z" SessionID="1"><From><User FriendlyName="adilipman@yahoo.com"/></From><To><User FriendlyName="Chocolade"/></To><Text Style="font-family:Segoe UI; color:#000000; ">לחשב ממוצע של 1000 הערכים הגבוהים ביותר בהיסטוגרמה</Text></Message><Message Date="31/01/2012" Time="10:17:10" DateTime="2012-01-31T08:17:10.405Z" SessionID="1"><From><User FriendlyName="adilipman@yahoo.com"/></From><To><User FriendlyName="Chocolade"/></To><Text Style="font-family:Segoe UI; color:#000000; ">ז"א בפריים</Text></Message><Message Date="31/01/2012" Time="10:17:14" DateTime="2012-01-31T08:17:14.135Z" SessionID="1"><From><User FriendlyName="adilipman@yahoo.com"/></From><To><User FriendlyName="Chocolade"/></To><Text Style="font-family:Segoe UI; color:#000000; ">לא בהיסטוגרמה</Text></Message><Message Date="31/01/2012" Time="10:17:20" DateTime="2012-01-31T08:17:20.142Z" SessionID="1"><From><User FriendlyName="adilipman@yahoo.com"/></From><To><User FriendlyName="Chocolade"/></To><Text Style="font-family:Segoe UI; color:#000000; ">בעזרת ההיסטוגרמה</Text></Message><Message Date="31/01/2012" Time="10:17:50" DateTime="2012-01-31T08:17:50.648Z" SessionID="1"><From><Us 
```

我想做的是它会告诉我：adilipman hello 然后：chocolade hi

现在我得到的是日期时间和文本，但我还想为每一行和文本添加名称，这样我就知道是谁说的了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:05:31.260

FrindlyName 不是元素用户的属性，我假设它来自 from 元素而不是 to 元素。

```
e.Element("From").Element("User").Attribute("FriendlyName").Value.ToString() 
```

# php - 使用 SimplePie 自定义排序顺序

> ID：12127709
> 
> 赞同：2
> 
> 时间：2012-08-26T04:56:09.107
> 
> 标签：php, sorting, simplepie

使用 SimplePie，我如何按随机顺序和标题（字母）对项目进行排序？根据此页面（[http://simplepie.org/wiki/tutorial/sorting_by_custom_criteria_instead_of_date](http://simplepie.org/wiki/tutorial/sorting_by_custom_criteria_instead_of_date)），文档说要扩展类并编写自己的方法。但是没有更多的例子，我似乎无法自己编写代码。

目前，我将所有提要项目放入数组中并对其进行排序。但是，SimplePie 的默认排序顺序是按日期。因此，如果某些 url 有较新的项目，假设其中 20 个是新的，并且如果我总共只获取 20 个项目，那么输出将被来自有限源 url 的项目占据，尽管我想以随机顺序显示项目拾取每个人都有几个。

我希望使用扩展类方法有更多工作示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T05:30:04.913

其实很简单。哈哈

```
class SimplePie_Title_Sort extends SimplePie
{
    public static function sort_items($a, $b)
    {
        return strcmp($a->get_title(),$b->get_title());
    }
}
class SimplePie_Random_Sort extends SimplePie
{
    public static function sort_items($a, $b)
    {
        return rand(-1, 1);
    }
} 
```

# node.js - sublime build - nodejs - 如何启动和停止节点应用程序

> ID：12127711
> 
> 赞同：4
> 
> 时间：2012-08-26T04:56:12.517
> 
> 标签：node.js, sublimetext2

所以我的节点构建是这样的

```
{
  "cmd": ["node", "$file"],
  "selector" : "source.js",
  "path" : "/usr/local/bin"
} 
```

它运行，但问题是一旦运行，它就永远不会停止。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-27T17:18:30.437

你可以使用像[node-dev](https://github.com/fgnass/node-dev)这样的重新加载器来处理这种事情。

替换`node`为`node-dev`( `npm install -g node-dev`) 就是这样，因此您的构建文件如下所示：

```
{
    "cmd": ["node-dev", "$file"],
    "selector" : "source.js",
    "path" : "/usr/local/bin"
} 
```

我个人使用 node-dev，但您也可以尝试[node-supervisor](https://github.com/isaacs/node-supervisor)或[node-nodemon](https://github.com/remy/nodemon)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-13T20:46:27.937

对于 Windows 用户，请使用“shell_cmd”而不是“cmd”

```
{
    "shell_cmd": "node ${file}"
} 
```

如果您需要停止/取消构建，请打开`"Tools | Cancel Build"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-18T05:11:17.907

一步一步把所有的答案放在一起：

1）安装节点开发包：

```
npm install -g node-dev 
```

2) 在你的 Sublime Text 上创建一个新的 Build

工具 > 构建系统 > 新构建系统...</p>

```
{
    "cmd": ["node-dev", "$file"],
    "selector" : "source.js",
    "path" : "/usr/local/bin"
} 
```

将文件保存为**NodeJS.sublime-build**。

3）打开您的项目，选择您的新节点构建系统，然后更改您的代码并保存。

# jquery - 计算每月的业务/活跃天数

> ID：12127719
> 
> 赞同：0
> 
> 时间：2012-08-26T04:57:57.397
> 
> 标签：jquery, jquery-plugins, fullcalendar

fullcalendar 中是否有任何方法可以计算一个月内的活动天数（没有假期和周末（星期日）的天数）？

例如：

一月份我们有31天，3个周末和5个假期，所以活跃天数是23天（31-（3+5）），我怎么计算那个活跃天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T08:07:51.250

实际上这与 fullcalendar 无关，但我认为这个脚本将帮助您从给定的月份和年份获取业务/活跃天数（不包括周末）。

```
function getActiveDays(month,year){
    var daysinmonth=Date.getDaysInMonth(year,month);
    var sundays=0;
    for(i=1;i<=daysinmonth;i++){
        var dayname = new Date(year,month,i).getDayName();
        if(dayname=="Sunday") {
            sundays++;
        };
    }
    activedays=daysinmonth-sundays;
    return activedays;
} 
```

上面的函数将从一个月中的几天中删除星期日。例如： `getActiveDays(7,2012)` 将返回 27 个活跃天数（从 2012 年 8 月开始）。

这个函数使用[date.js](http://code.google.com/p/datejs/)库

# ios - 来自 StoreKit 的 SIGSEGV 崩溃 - 无法复制

> ID：12127721
> 
> 赞同：1
> 
> 时间：2012-08-26T04:58:22.033
> 
> 标签：ios, crash, crash-reports, storekit, segmentation-fault

一个客户给我带来了一个现有的应用程序，我们刚刚发布了一个新版本，包括用于崩溃报告的 Crittercism。

自发布以来，我们收到了大量的崩溃报告，如下所示。我相信崩溃是由 SKProductRequest 的代表过早发布引起的，所以我不是在寻找崩溃发生原因的答案——这已经在 StackOverflow 的其他地方得到了回答。

我的问题是我无法复制错误。我尝试了许多设备和不同版本的 iOS。从 Crittercism 来看，崩溃主要发生在最新的设备上，以及一系列 iPhone、iPod 和 iPad - 所以它不是一种特定类型的设备，但我仍然无法让它发生。我已经下载了精简版，然后从那里购买了完整版——一切都很完美。

因此，我的问题是，有没有人知道如何在我的设备上实现它以便我可以修复它？！

```
libobjc.A.dylib 0x37393f78 objc_msgSend + 15
StoreKit 0x37bc3a4f -[SKProductsRequest handleFinishResponse:returningError:] + 142
StoreKit 0x37bc4dc7 -[SKRequest _requestFinishedNotification:] + 210
Foundation 0x319624ff __57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke_0 + 18
CoreFoundation 0x31027547 ___CFXNotificationPost_block_invoke_0 + 70
CoreFoundation 0x30fb3097 _CFXNotificationPost + 1406
Foundation 0x318d63eb -[NSNotificationCenter postNotificationName:object:userInfo:] + 66
AppSupport 0x314eeba3 -[CPDistributedNotificationCenter deliverNotification:userInfo:] + 62
AppSupport 0x314f010b _CPDNDeliverNotification + 290
AppSupport 0x314ee99b _XDeliverNotification + 170
AppSupport 0x314e3b11 migHelperRecievePortCallout + 172
CoreFoundation 0x3102f523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 38
CoreFoundation 0x3102f4c5 __CFRunLoopDoSource1 + 140
CoreFoundation 0x3102e313 __CFRunLoopRun + 1370
CoreFoundation 0x30fb14a5 CFRunLoopRunSpecific + 300
CoreFoundation 0x30fb136d CFRunLoopRunInMode + 104
GraphicsServices 0x3302b439 GSEventRunModal + 136
UIKit 0x30714cd5 UIApplicationMain + 1080
MyAppLite 0x000fc7c3 main (main.m:13) 
```

罪魁祸首肯定在某个地方，但我仍然无法让它在我的设备或模拟器中崩溃：

```
#import "InAppPurchaseViewController.h"

#define INDICATOR_Y 150.0f
#define INDICATOR_MOVE_Y 300.0f
#define PRODUCT_LABEL_Y 150.0f
#define PURCHASE_BUTTON_Y 190.0f
#define RESTORE_BUTTON_Y 240.0f

@interface InAppPurchaseViewController (Private)
- (void)updateUIToDefaultState;
@end

@implementation InAppPurchaseViewController

- (void) dealloc {
    [productLabel release];
    [purchaseButton release];
    [indicatorView release];
    [super dealloc];
}

#pragma mark -
#pragma mark UIViewController

- (void)viewDidLoad {
    [super viewDidLoad];

    self.title = @"...";
    self.view.backgroundColor = [UIColor blackColor];
    self.tableView.backgroundColor = [UIColor blackColor];
    self.tableView.separatorStyle = UITableViewCellSeparatorStyleNone;
    self.tableView.scrollEnabled = NO;
    self.tableView.indicatorStyle = UIScrollViewIndicatorStyleWhite;

    UIImageView *headerImageView = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"upgrade-header.png"]] autorelease];
    UIView *headerView = [[[UIView alloc] initWithFrame:CGRectMake(0.0, 0.0, self.view.bounds.size.width, headerImageView.image.size.height + 200.0)] autorelease];
    [headerView addSubview:headerImageView];

    indicatorView = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
    indicatorView.hidesWhenStopped = YES;
    [indicatorView startAnimating];
    [headerView addSubview:indicatorView];

    productLabel = [[UILabel alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 300.0f, 0.0f)];
    productLabel.text = @"...";
    productLabel.hidden = YES;
    productLabel.font = [UIFont systemFontOfSize:18.0f];
    productLabel.textColor = [UIColor whiteColor];
    productLabel.backgroundColor = [UIColor blackColor];
    [productLabel sizeToFit];
    [headerView addSubview:productLabel];

    purchaseButton = [[UIButton buttonWithType:UIButtonTypeCustom] retain];
    purchaseButton.titleLabel.font = [UIFont boldSystemFontOfSize:20.0f];
    UIImage *bgImage = [UIImage imageNamed:@"btn_purchase.png"];
    UIImage *buttonImage = [bgImage stretchableImageWithLeftCapWidth:(bgImage.size.width / 2.0f) - 1 topCapHeight:0.0f];
    [purchaseButton setBackgroundImage:buttonImage forState:UIControlStateNormal];
    [purchaseButton setTitle:@"Purchase" forState:UIControlStateNormal];
    [purchaseButton addTarget:self action:@selector(purchaseClicked:) forControlEvents:UIControlEventTouchUpInside];
    purchaseButton.frame = CGRectMake(0.0f, 0.0f, 300.0f, buttonImage.size.height);
    purchaseButton.hidden = YES;
    [self.view addSubview:purchaseButton];

    restoreButton = [[UIButton buttonWithType:UIButtonTypeCustom] retain];
    restoreButton.enabled = NO;
    restoreButton.titleLabel.font = [UIFont boldSystemFontOfSize:18.0f];
    [restoreButton setBackgroundImage:buttonImage forState:UIControlStateNormal];
    [restoreButton setTitle:@"Restore Purchases" forState:UIControlStateNormal];
    [restoreButton addTarget:self action:@selector(restoreClicked:) forControlEvents:UIControlEventTouchUpInside];
    restoreButton.frame = CGRectMake(0.0f, 0.0f, 300.0f, buttonImage.size.height);
    [self.view addSubview:restoreButton];

    headerImageView.center = headerView.center;
    headerImageView.frame = CGRectMake(headerImageView.frame.origin.x, 0.0f, headerImageView.frame.size.width, headerImageView.frame.size.height);

    indicatorView.center = headerView.center;
    indicatorView.frame = CGRectMake(indicatorView.frame.origin.x, INDICATOR_Y, indicatorView.frame.size.width, indicatorView.frame.size.height);

    productLabel.center = headerView.center;
    productLabel.frame = CGRectMake(productLabel.frame.origin.x, PRODUCT_LABEL_Y, productLabel.frame.size.width, productLabel.frame.size.height);

    purchaseButton.center = headerView.center;
    purchaseButton.frame = CGRectMake(purchaseButton.frame.origin.x, PURCHASE_BUTTON_Y, purchaseButton.frame.size.width, purchaseButton.frame.size.height);

    restoreButton.center = headerView.center;
    restoreButton.frame = CGRectMake(restoreButton.frame.origin.x, RESTORE_BUTTON_Y, restoreButton.frame.size.width, restoreButton.frame.size.height);

    self.tableView.tableHeaderView = headerView;

    [self performSelectorInBackground:@selector(retrieveProductDetails:) withObject:nil];
}

#pragma mark -
#pragma mark AppStoreServiceDelegate

- (void)productDetailsRequestSucceededWithResponse:(SKProductsResponse *)response {
    if (response.products.count == 1) {
        [self performSelectorOnMainThread:@selector(productDetailsRetrieved:) withObject:[response.products objectAtIndex:0] waitUntilDone:NO];    
    } else {
        NSString *message = @"Unable to retrieve product details: No valid product to purchase. Please contact support.";
        [self performSelectorOnMainThread:@selector(appStoreRequestFailed:) withObject:message waitUntilDone:NO];
    }
}

- (void)productDetailsRequestFailedWithError:(NSError *)error {
    NSString *message = [NSString stringWithFormat:@"Unable to retrieve product details: %@", [error localizedDescription]];
    [self performSelectorOnMainThread:@selector(appStoreRequestFailed:) withObject:message waitUntilDone:NO];
}

- (void)transactionSucceededForProductId:(NSString *)productId {
    [self performSelectorOnMainThread:@selector(purchaseCompleted:) withObject:productId waitUntilDone:NO];
}

- (void)transactionFailedWithReason:(NSString *)reason {
    NSString *message = [NSString stringWithFormat:@"Sorry, your purchase could not be completed: %@", reason];
    [self performSelectorOnMainThread:@selector(appStoreRequestFailed:) withObject:message waitUntilDone:NO];
}

- (void)transactionCancelled {
    [self performSelectorOnMainThread:@selector(updateUIToDefaultState) withObject:nil waitUntilDone:NO];
}

#pragma mark -
#pragma mark UIAlertViewDelegate (purchase failed)
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
    [self.navigationController popViewControllerAnimated:YES];
}

#pragma mark -
#pragma mark Private button callbacks

- (void)purchaseClicked:(UIButton *)clicked {
    clicked.enabled = NO;
    [indicatorView startAnimating];
    indicatorView.frame = CGRectMake(indicatorView.frame.origin.x, INDICATOR_MOVE_Y, indicatorView.frame.size.width, indicatorView.frame.size.height);
    [self performSelectorInBackground:@selector(purchaseProduct:) withObject:nil];
}

- (void)restoreClicked:(UIButton *)clicked {
    clicked.enabled = NO;
    [indicatorView startAnimating];
    indicatorView.frame = CGRectMake(indicatorView.frame.origin.x, INDICATOR_MOVE_Y, indicatorView.frame.size.width, indicatorView.frame.size.height);
    [self performSelectorInBackground:@selector(restoreProducts:) withObject:nil];
}

#pragma mark -
#pragma mark Private

- (void)showPurchaseDetailsWithName:(NSString *)productName price:(NSString *)price {
    self.title = productName;
    productLabel.text = [NSString stringWithFormat:@"%@, %@", productName, price];
    [productLabel sizeToFit];
    productLabel.center = self.tableView.tableHeaderView.center;
    [self updateUIToDefaultState];
}

- (void)productDetailsRetrieved:(SKProduct *)productDetails {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    [indicatorView stopAnimating];
    [self showPurchaseDetailsWithName:productDetails.localizedTitle price:[[AppStoreService sharedAppStoreService] formatPrice:productDetails]];
    [pool drain];
}

- (void)purchaseCompleted:(NSString *)productId  {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    [indicatorView stopAnimating];
    [[AppStoreService sharedAppStoreService] setPurchasedFullEdition:YES];
    [self.navigationController popViewControllerAnimated:YES];
    [pool drain];
}

- (void)purchaseProduct:(id)ignored {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    [[AppStoreService sharedAppStoreService] purchaseProducts:[NSSet setWithObject:[[AppStoreService sharedAppStoreService] inAppProductIdentifierForEdition]] notifyingDelegate:self];
    [pool drain];
}

- (void)restoreProducts:(id)ignored {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    [[AppStoreService sharedAppStoreService] retoreCompletedTransactionsNotifyingDelegate:self];
    [pool drain];
}

- (void)appStoreRequestFailed:(NSString *)reason {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    [[[[UIAlertView alloc] initWithTitle:@"Purchase Error" message:reason delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil] autorelease] show];
    [self updateUIToDefaultState];
    [pool drain];
}

- (void)retrieveProductDetails:(id)ignored {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    [[AppStoreService sharedAppStoreService] requestDetailsOfProducts:[NSSet setWithObject:[[AppStoreService sharedAppStoreService] inAppProductIdentifierForEdition]] notifyingDelegate:self];
    [pool drain];
}

- (void)updateUIToDefaultState {
    [indicatorView stopAnimating];
    productLabel.hidden = NO;
    purchaseButton.hidden = NO;
    restoreButton.enabled = YES;
    purchaseButton.enabled = YES;
}

@end 
```

这是 AppStoreService.m

```
//  AppStoreService.m
    #import "AppStoreService.h"
    #import "SynthesizeSingleton.h"
    #import "DataService.h"
    #import "ConfigService.h"

    #pragma mark -
    #pragma mark Private internal app store delegates

    @implementation AppStoreProductRequestDelegate

    @synthesize delegate = _delegate;

    - (void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse *)response {
        //NSLog(@"Got response... %@", response);
        [request release];
        if (self.delegate) {
            [self.delegate productDetailsRequestSucceededWithResponse:response];
        }
    }

    - (void)request:(SKRequest *)request didFailWithError:(NSError *)error {
        //NSLog(@"Got error... %@", error);
        [request release];
        if (self.delegate) {
            [self.delegate productDetailsRequestFailedWithError:error];
        }
    }

    @end

    @implementation AppStoreTransactionObserver

    @synthesize delegate = _delegate;

    - (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions {
        for (SKPaymentTransaction *transaction in transactions) {
            switch (transaction.transactionState) {
                case SKPaymentTransactionStatePurchased: { [self completeTransaction:transaction]; break; }
                case SKPaymentTransactionStateFailed: { [self failedTransaction:transaction]; break; }
                case SKPaymentTransactionStateRestored: {[self restoreTransaction:transaction]; break; }
                default: break;
            }
        }
    }

    - (void)paymentQueue:(SKPaymentQueue *)queue restoreCompletedTransactionsFailedWithError:(NSError *)error {
        if (self.delegate) {
            [self.delegate transactionFailedWithReason:[NSString stringWithFormat:@"Purchase failed: %@", [error localizedDescription]]];
        }
    }

    - (void)paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue {
        //NSLog(@"paymentQueueRestoreCompletedTransactionsFinished:");
    }

    - (void)failedTransaction:(SKPaymentTransaction *)transaction {
        //NSLog(@"failedTransaction: %@", transaction);
        if (self.delegate) {
            if (transaction.error.code == SKErrorPaymentCancelled) {
                [self.delegate transactionCancelled];
            } else {
                [self.delegate transactionFailedWithReason:[NSString stringWithFormat:@"Purchase failed: %@", [transaction.error localizedDescription]]];
            }
        }
        [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
    }

    - (void)restoreTransaction:(SKPaymentTransaction *)transaction {
        //NSLog(@"restoreTransaction: %@", transaction);
        if (self.delegate) {
            [self.delegate transactionSucceededForProductId:transaction.originalTransaction.payment.productIdentifier];
        }
        [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
    }

    - (void)completeTransaction:(SKPaymentTransaction *)transaction {
        //NSLog(@"completeTransaction: %@", transaction);
        if (self.delegate) {
            [self.delegate transactionSucceededForProductId:transaction.payment.productIdentifier];
        }
        [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
    }

    @end

    #pragma mark -
    #pragma mark AppStoreService

    @implementation AppStoreService

    SYNTHESIZE_SINGLETON_FOR_CLASS(AppStoreService);

    static NSString *kLPHasPurchasedFullEdition = @"kLPHasPurchasedFullEdition";

    - (AppStoreService *)init {
        if (self = [super init]) {
            productDetailsDelegate = [[AppStoreProductRequestDelegate alloc] init];
            appStoreObserver = [[AppStoreTransactionObserver alloc] init];
            [[SKPaymentQueue defaultQueue] addTransactionObserver:appStoreObserver];
        }
        return self;
    }

    - (void) dealloc {
        [[SKPaymentQueue defaultQueue] removeTransactionObserver:appStoreObserver];
        [productDetailsDelegate release];
        [appStoreObserver release];
        [super dealloc];
    }

    - (BOOL)hasPurchasedFullEdition {
        return [[NSUserDefaults standardUserDefaults] boolForKey:kLPHasPurchasedFullEdition];
    }

    - (void)setPurchasedFullEdition:(BOOL)purchased {
        //NSLog(@"Purchased? %d", purchased);
        [[NSUserDefaults standardUserDefaults] setBool:purchased forKey:kLPHasPurchasedFullEdition];
        [[ConfigService sharedConfigService] synchronizeConfig];
    }

    - (NSString *)inAppProductIdentifierForEdition {
        if ([[DataService sharedDataService] isLiteEdition]) {
            if ([DataService sharedDataService].isLanguageEdition) {
                // Note. Remove the "-" from language codes, e.g. Brazillian Portugese pt-br, as in-app purchase IDs cannot contain a hyphen.
                NSString *fixedCode = [[DataService sharedDataService].languageCode stringByReplacingOccurrencesOfString:@"-" withString:@""];
                return [NSString stringWithFormat:@"com.myBrokenApp.%@.AllCategories", fixedCode];
            } else {
                return @"com.myBrokenApp.AllCategories";
            }
        } else {
            @throw [NSException exceptionWithName:@"InvalidOperation" reason:@"An in app purchase product ID was requested for a non-lite version" userInfo:[NSDictionary dictionary]];
        }
    }

    - (NSString *)purchasedCategoryIdsWhereClause {
        // flirting & essentials for lite builds
        return ([DataService sharedDataService].isLiteEdition && ![self hasPurchasedFullEdition]) ? @"and c.category_id in (1,19)" : @" ";
    }

    - (NSString *)formatPrice:(SKProduct *)product {
        NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc] init];
        [numberFormatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
        [numberFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];
        [numberFormatter setLocale:product.priceLocale];
        NSString *currency = [numberFormatter stringFromNumber:product.price];
        [numberFormatter release];
        return currency;
    }

    - (void)requestDetailsOfProducts:(NSSet *)products notifyingDelegate:(id<AppStoreServiceDelegate>)delegate {
        //NSLog(@"Retrieving details of products: %@", products);
        SKProductsRequest *request = [[SKProductsRequest alloc] initWithProductIdentifiers:products];
        productDetailsDelegate.delegate = delegate;
        request.delegate = productDetailsDelegate;
        //NSLog(@"Starting request...");
        [request start];
    }

    - (void)purchaseProducts:(NSSet *)products notifyingDelegate:(id<AppStoreServiceDelegate>)delegate {
        //NSLog(@"Making in app purchase for products: %@", products);
        if ([SKPaymentQueue canMakePayments]) {
            appStoreObserver.delegate = delegate;
            for (NSString *productId in products) {
                [[SKPaymentQueue defaultQueue] addPayment:[SKPayment paymentWithProductIdentifier:productId]];
            }

        } else {
            [delegate transactionFailedWithReason:@"You are not permitted to make purchases."];
        }
    }

    - (void)retoreCompletedTransactionsNotifyingDelegate:(id<AppStoreServiceDelegate>)delegate {
        //NSLog(@"Restoring in-app purchases...");
        if ([SKPaymentQueue canMakePayments]) {
            appStoreObserver.delegate = delegate;
            [[SKPaymentQueue defaultQueue] restoreCompletedTransactions];
        } else {
            [delegate transactionFailedWithReason:@"You are not permitted to make purchases."];
        }
    }

    @end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T22:59:52.117

Whisk，你在这里发布了一些非常有问题的代码。一方面，您使用 SYNTHESIZE_SINGLETON_FOR_CLASS() 这意味着您的 AppStoreService dealloc 方法将永远不会被调用，因此您的应用程序中存在内存泄漏。此外，productsRequest 中对 [request release] 的调用看起来确实很奇怪。但是，您在使用 SKProductsRequest 时遇到的具体问题似乎与一个委托有关，该委托指向您在 SKProductsRequest 调用回调之前释放的对象之一。这表明当充当委托的对象调用其 dealloc 方法时，您需要将委托设置为 nil。至于如何重现该问题，这听起来很棘手，因为您在代码中设置了非常奇怪的对象生命周期。我建议您使用自动回归测试工具，但我不确定由于您使用单例，它甚至可以检查您的应用程序中的对象生命周期。看[单身人士有什么不好？](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-19T23:50:00.340

我认为您的理论“过早发布 SKProductRequest 的代表”可能是正确的。您是否尝试过在购买过程中退出/终止应用程序？（如果沙盒服务器速度太快（哈哈！那一天），请尝试在事务完成之前插入一些断点并手动终止应用程序。）当您的应用程序再次启动并最终向 StoreKit 注册一个对象作为事务时委托，它将从以前的运行中获得开放的事务，这发现了几个设计错误并帮助我们修复了围绕 StoreKit 事务完成的一类错误。

# mysql - 更新mysql数据库的最简单方法？

> ID：12127722
> 
> 赞同：-1
> 
> 时间：2012-08-26T04:58:48.907
> 
> 标签：mysql

用本地主机上的新数据库结构更新服务器上旧数据库结构的最简单方法是什么？两者都有相似的结构/表格，但我想更新旧的。

我的本地主机充满了错误数据，但我想用更新的结构更新服务器数据库。有没有一种更简单的方法，然后一张一张地浏览表格？有点像 git merge

编辑：更具体地说，如果我有一个结构表

表 - id、姓名、职务、电话、电子邮件（旧）

更新为

表格 - id、姓名、职务、电话、电子邮件、年龄、性别（新）

我的数据库中有多个这样的表，是否有一种合并功能可以更新旧数据库的结构以包含新的表字段？

（顺便说一句。我没有从代码中调用 mysql 语句。我想修改表结构本身，可能通过 phpmyadmin）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:25:54.063

阅读[ALTER TABLE](http://dev.mysql.com/doc/refman/5.1/en/alter-table.html)的 SQL 语法。例如：

```
ALTER TABLE table_name
  ADD COLUMN new_column1 VARCHAR(255),
  ADD COLUMN new_column2 INTEGER; 
```

[编辑] 提示：要查看需要更改/添加哪些列来同步新旧数据库，您可以将`mysqldump`新旧模式中的一个保存到不同的文件中，然后使用`diff`工具进行比较（注意：仅使用模式，而不是完整的数据转储）。当您对旧数据库进行增量更改时，两个模式转储看起来会越来越相似。当你得到完全一样的它们时，你就赢了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T05:02:41.870

编写执行必要更新的 SQL 代码 - 没有魔术按钮。这就是为什么您应该从一开始就获得数据库模式的原因，尽管这并不总是可能的。必须重新组织 100 亿行的图像以及所需的时间。

# regex - 用于匹配连续字符串的正则表达式

> ID：12127724
> 
> 赞同：2
> 
> 时间：2012-08-26T04:59:08.240
> 
> 标签：regex

如果我想匹配一组字符但仅在两组相同时才匹配，我应该使用哪种正则表达式？

例如，以下应该匹配

`Hello John, Goodbye John. Hello Amy, Goodbye Amy.`

但这些不应该匹配

`Hello John, Goodbye Amy. Hello Amy, Goodbye John.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T05:04:43.210

根据您的正则表达式引擎，您可以在正则表达式中使用反向引用来引用（和匹配）以前匹配的项目：

```
Hello (\w+), Goodbye \1. 
```

仅当“Goodbye”之后的文本与第一个匹配项（即“Hello”之后的单词）完全匹配时，才会产生匹配项。

示例用法（在 Python 中）：

```
>>> re.findall(r'Hello (\w+), Goodbye \1.', 'Hello John, Goodbye John. Hello Amy, Goodbye Amy. ')
['John', 'Amy']
>>> re.findall(r'Hello (\w+), Goodbye \1.', 'Hello John, Goodbye Amy. Hello Amy, Goodbye John. ')
[] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T05:11:10.457

使用反向引用是解决此问题的一种简单方法。这些是对表达式中先前带括号的元素的引用。

例如，仅当反向引用与“John”匹配时，以下内容才会匹配：

/你好（约翰），再见（1美元）/

$1 将确保第二个元素与第一个元素匹配。

更适用于您的问题，以下将允许任何单词字符（名称）：

/你好（\w+），再见（$1）/gi

干杯，G

# google-apps-script - 使用 htmlService / html 模板显示 GoogleScript UiApp

> ID：12127728
> 
> 赞同：1
> 
> 时间：2012-08-26T04:59:43.497
> 
> 标签：google-apps-script

我有一个 UiApp，它创建了一些将数据写入特定电子表格的表单元素。现在我想将 UiApp 小部件加载到 htmlService 模板中，但我不知道该怎么做。

我的 doGet 函数加载基本模板，doGetApp 构建 UiApp：

```
function doGet() {
  return HtmlService.createTemplateFromFile('base_template').evaluate();
}
function doGetApp() {
  // creates input forms for a spreadsheet (the following is just an example
  var app = UiApp.createApplication();
  var tabPanel = app.createDecoratedTabPanel();
  var flowPanel1 = app.createFlowPanel();
  var flowPanel2 = app.createFlowPanel();

  tabPanel.add(flowPanel1, "Create New Projects");
  tabPanel.add(flowPanel2, "Edit Projects");
  app.add(tabPanel);

  // return app; // <<<< original doGet function returned the app

  // testing different ways of returning the UiApp 
  return HtmlService.createHtmlOutput(app); // this displays the text "HtmlOutput"
} 
```

我的 base_html 模板现在非常简单：

```
<html >
<?!= getCSS("css_js"); ?>
  <body>
  <h1>Template Test</h1>
  <?!= doGetApp(); ?>
  </body>
</html> 
```

我对此尝试了一些变体，但结果通常是相同的：显示描述对象的文本输出，而不是显示 UiApp。（getCSS 函数工作正常）

目标是能够轻松加载我自己的一些 css/js 以及 UiApp，以便轻松地设置表单/结果内容的样式。我对此很陌生，所以我完全有可能以错误的方式处理这个问题。感谢任何指针。谢谢！

-格雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T03:21:11.940

现在，您要么使用 html 服务，要么使用 uiapp - 你不能将两者结合起来

# android - 相对于另一个 RelativeLayout 中的元素定位元素

> ID：12127730
> 
> 赞同：0
> 
> 时间：2012-08-26T05:00:26.570
> 
> 标签：android, android-layout

我有一个布局，其中包含一系列需要在表单中并排显示的标题和描述

```
Title:         Description
Another Title: Description that is long
               and goes on two lines
Short Title:   Description 3 
```

它需要像上面的例子一样有间距。如果我可以使用 2 个相对布局（一个用于标题，另一个用于描述），这将很容易，然后我可以设置标题布局的宽度以包装内容以获得间距。这个问题是我不能使用 android:layout_toRightOf="..." 在另一个相对布局中引用一个 id 。

如果有人可以帮助我找到解决方案，或者让我知道我是否以错误的方式看待这个问题，那么我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T06:43:01.000

您是否尝试过使用嵌套线性布局？这是大多数人使用它们的那种情况。您可以尝试使用表格，但是对于 LinearLayouts，我建议使用其中包含许多水平布局的垂直布局，左右 TextViews 的权重在各行之间设置相同，以便右侧的文本对齐.

# sql - 从 SQL Server 2008 表中选择最新记录

> ID：12127745
> 
> 赞同：0
> 
> 时间：2012-08-26T05:03:54.613
> 
> 标签：sql, sql-server

我有一张包含产品付款条款的表格。我想获得该产品的最新条款。在下面的查询中，它返回自我的应用程序投入生产以来的所有术语。我只需要该产品的最新术语。

```
SELECT
   dbo.FinishProduct.id,
   dbo.PaymentTerm.id,
   dbo.PaymentTerm.terms,
   dbo.PaymentTerm.type
FROM
   dbo.PaymentTerm
INNER JOIN
   dbo.FinishProduct ON (dbo.PaymentTerm.finishProductId = dbo.FinishProduct.id) 
WHERE
   finishproduct.id = 39 
```

我的`PaymentTerm`表有 PK`id`并且它有创建和更新的日期，如下所示：

```
id BIGINT NOT NULL IDENTITY,
created DATETIME,
lastUpdated DATETIME, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:19:13.890

您可以将 orderby 子句放在查询中的 lastUpdated 字段上，并相应地获取前 10 条或更多最新记录，如下所示

```
SELECT TOP 10  FP.id, PT.id, PT.terms, PT.type
  FROM dbo.PaymentTerm PT
  INNER JOIN dbo.FinishProduct FP ON PT.finishProductId = FP.id 
  WHERE FP.id=39
  ORDER BY lastUpdated desc 
```

或者，如果您需要将一天的所有记录返回到当前日期，请在这样的内置函数中使用 DateDiff

```
SELECT FP.id, PT.id, PT.terms, PT.type
  FROM dbo.PaymentTerm PT
  INNER JOIN dbo.FinishProduct FP ON PT.finishProductId = FP.id 
  WHERE FP.id=39 AND DateDiff(DAY,lastUpdated, GETDATE()) <= 1 
```

# iphone - 如何在 iOS iPhone 应用程序上以编程方式轻松回放 .m4a 文件

> ID：12127747
> 
> 赞同：2
> 
> 时间：2012-08-26T05:04:08.793
> 
> 标签：iphone, ios, audio, xcode4

如何连续播放多个 .m4a 文件？

目前，我的函数开始播放一个，使用 AudioServicesPlaySystemSound 等，使用 AudioServicesAddSystemSoundCompletion 选择回调，然后返回。声音完成后，回调让我的软件继续。

每当有背靠背的声音时，这就是很多编码。

我的软件可以开始播放 .m4a 并以某种方式等待它完成，等待它的回调设置标志吗？我可以使用 pthread 软件进行多任务暂停的等待循环吗？

到目前为止，这是我的代码...

// 播放声音文件后恢复game_state继续游戏。int game_state_after_sound；void play_sound_file_done (SystemSoundID ssID, void *calling_class) { printf("\n play_sound_file_done."); // 声音现在完成了，所以恢复 game_state 并从中断的地方继续 manage_game： game_state = game_state_after_sound; [(GeController* )calling_class manage_game]; }

```
// Plays sound_file_m4a and returns after playing has completed.
-(void) play_sound_file: (NSString *) sound_file_m4a
{
    printf("\n play_sound_file '%s' ", [sound_file_m4a UTF8String] );
    NSString *soundPath = [[NSBundle mainBundle] pathForResource:sound_file_m4a ofType:@"m4a"]; 
    SystemSoundID soundID; 

    AudioServicesCreateSystemSoundID((CFURLRef)[NSURL fileURLWithPath: soundPath], &soundID); 
    AudioServicesPlaySystemSound (soundID); 
    AudioServicesAddSystemSoundCompletion ( soundID, NULL, NULL, play_sound_file_done, (void*)self ); 

    game_state_after_sound = game_state;
    game_state =  DELAY_WHILE_PLAYING_SOUND;
} 
```

************************************ AVPlayer 正在进行中...

但这不会产生声音。

```
#import <AVFoundation/AVFfoundation.h> 

-(void) play_queued_sounds: (NSString *) sound_file_m4a
{
    printf("\n queue_sound_file: '%s' ", [sound_file_m4a UTF8String] );

    AVPlayerItem *sound_file = [[AVPlayerItem alloc] initWithURL:[NSURL URLWithString:[[NSBundle mainBundle] pathForResource:sound_file_m4a ofType:@"m4a"]]]; 
    AVQueuePlayer *player = [AVQueuePlayer queuePlayerWithItems:[NSArray arrayWithObjects:sound_file, nil]];  

    [player play]; 

    return;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T05:25:54.910

这可以很容易地在`AVQueuePlayer`. 您不必处理完成或任何事情，只需给它您要按顺序播放的 AVPlayerItems 并调用 play。这是一个例子：

```
#import <AVFoundation/AVFfoundation.h>

//AVPlayerItem *item1 = [[AVPlayerItem alloc] initWithURL:[NSURL URLWithString:[[NSBundle mainBundle] pathForResource:@"myFileName" ofType:@"m4a"]]]; 
```

**编辑：**改用这个

```
AVPlayerItem *item1 = [[AVPlayerItem alloc] initWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:[[NSString alloc] initWithFormat:@"2"] ofType:@"mp3"]]];

AVQueuePlayer *player = [AVQueuePlayer queuePlayerWithItems:[NSArray arrayWithObjects:item1, nil]];

[player play]; 
```

另外，这也可以通过用户 iPod 库中的项目使用来自委托方法的`MPMusicPlayerController`队列来实现`didPickMediaItems``MPMediaPickerController`

```
- (void)mediaPicker:(MPMediaPickerController *)mediaPicker didPickMediaItems:(MPMediaItemCollection *)mediaItemCollection
{
    MPMusicPlayerController *player = [MPMusicPlayerController applicationMusicPlayer];
    [player setQueueWithItemCollection:mediaItemCollection];
    [player play];
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-30T05:14:18.470

我无法让 AVQueuePlayer 解决方案正常工作。

伟大的解决方案：对于每个要播放的声音，启动一个等待然后锁定互斥锁的线程，然后执行 AudioServicesPlaySystemSound。只需为要播放的每个连续声音启动一个线程，并使用 pthread 互斥锁来延迟每个连续线程，直到 AudioServicesAddSystemSoundCompletion 函数解锁互斥锁。像冠军一样工作。

这是 21 世纪的嵌入式编程：解决问题！

# serialization - JSON.NET 自定义序列化以排除属性名称

> ID：12127749
> 
> 赞同：1
> 
> 时间：2012-08-26T05:04:41.820
> 
> 标签：serialization, json.net

我正在使用 Json.NET，并且我有以下代码。

```
public class Row
{
    [JsonProperty]
    public IDictionary<string, object> Cells { get; set; }
} 
```

行和单元格是动态生成的，我有 C# 动态/扩展功能来创建这些单元格。当 Json.NET 序列化动态实例时，它会生成我想要的正确 json 结构。但是，对于大型数据结构，它会对性能产生不利影响。例如，JsonSerializer 在序列化过程中非常广泛地调用 DynamicObject TryGetMember。因此我需要一个静态数据结构，这样序列化会快得多。synamic Expando 对象仍会创建动态属性，但我希望 Json.NET 序列化使用静态结构（基于动态结构创建），因此序列化会更快。

根据动态结构填充单元格字典，并通过调用 JsonConvert 生成序列化的 json 结构，如下所示。

```
 string serializeObject =  JsonConvert.SerializeObject(data, Formatting.Indented); 
```

//json输出：

```
 {

    "Data": [
              {
                "Cells": {
                     "column1": "20",
                     "column2": "20"
                     }
              },
              {
                "Cells": {
                    "column1": "20",
                    "column2": "20"
                    }
              }
      ]
} 
```

但是，我绑定到的 UI Grid 需要以下 json 结构

```
 "Data": [
               {
                     "column1": "20",
                     "column2": "20"                  
               },
               {                   
                    "column1": "20",
                    "column2": "20"                  
               }
           ] 
```

有没有办法可以删除“细胞”并产生上面的 Json 结构？

我查看了 JSON.NET 帮助文档，但找不到实现此目的的方法。还尝试覆盖 DynamicContractResolver 的 CreateProperty 方法以查看是否可以更改序列化行为，但我无法这样做

```
 public class DynamicContractResolver : DefaultContractResolver
 {       
    protected override JsonProperty CreateProperty(System.Reflection.MemberInfo member, MemberSerialization memberSerialization)
    {
        if (member.Name == "Cells")
        {
             //remove the name "Cells" from the serialized structure    
        }
        return base.CreateProperty(member, memberSerialization);
    }
 } 
```

或者这不是简单的支持？非常感谢任何建议或指示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T10:04:08.463

通过创建自定义转换器找到了解决此问题的方法。下面的代码产生了我需要的 Json 结果。

```
public class GridJsonConverter : JsonConverter
{
    public override bool CanConvert(Type objectType)
    {
        return true; //TODO: more logic check the type before the conversion..
    }

    public override void WriteJson(JsonWriter writer, 
       object value, JsonSerializer serializer)
    {
        var rows = (List<Row>)value;

        writer.WriteStartObject();
            writer.WritePropertyName("data");
                writer.WriteStartArray();

        foreach (var row in rows)
        {
            writer.WriteStartObject();
            var cells = row.Cells;

            foreach (var cell in cells)
            {
                writer.WritePropertyName(cell.Key);
                writer.WriteValue(cell.Value);    
            }

            writer.WriteEndObject();
        }

        writer.Flush();
    }

    public override object ReadJson(JsonReader reader, Type objectType, 
       object existingValue, JsonSerializer serializer)
    {
        throw new NotImplementedException();
    }
} 
```

//使用示例：

```
 string serializeObject = JsonConvert.SerializeObject
 (someData, Formatting.Indented,   new GridJsonConverter()); 
```

# php - PHP 输出 DataURI base64_encode

> ID：12127751
> 
> 赞同：2
> 
> 时间：2012-08-26T05:04:46.463
> 
> 标签：php, data-uri

我想拍摄本地图像，调整大小并输出 dataURI。为什么我的 base64_encode 代码不起作用？

```
<?php
// Create an image instance

$imagearray = array('pop3', 'aboutme', 'passions', 'lindahlstudios', 'blog');

foreach ($imagearray as $key) {
    echo $key;

    //load image
    $im = imagecreatefrompng($key.'button4.png');

    //set width of resize
    $width = 70;
    $ratio = $width / imagesx($im);
    $height = imagesy($im) * $ratio;

    echo ' resizeTo-'.$width.'x'.$height.'<br>';

    $new_image = imagecreatetruecolor($width, $height);
    imagecopyresampled($new_image, $im, 0, 0, 0, 0, $width, $height, imagesx($im), imagesy($im));

    //save image to file
    //imagepng($new_image, $key.'button4_'.$width.'.png');

    //print DataURI
    echo base64_encode($new_image);

    imagedestroy($new_image);
}
?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-26T05:14:42.570

`imagecreatetruecolor`返回一个图像资源，创建数据uri需要的是一个图像文件，数据uri格式也是[`data:[<MIME-type>][;charset=<encoding>][;base64],<data>`](http://en.wikipedia.org/wiki/Data_URI_scheme#Format)

```
echo 'data:image/png;base64,'.base64_encode(file_get_contents($new_image_file)); 
```

如果您不想保存要读取的文件，可以使用`imagepng`和输出缓冲

```
 ob_start();
 imagepng($new_image);
 echo 'data:image/png;base64,'.base64_encode(ob_get_clean()); 
```

# php - 在 HTML 表中显示 mySQL 行，而无需单独指定每一列

> ID：12127752
> 
> 赞同：1
> 
> 时间：2012-08-26T05:05:01.583
> 
> 标签：php, mysql, fetch

我正在创建一个表单，用户可以在其中查看和编辑他们的帐户信息，我想尽可能简化这一点，因为有很多表单字段。我在没有指定列名的情况下选择了所有客户的数据，但是我无法在 HTML 表中的正确位置显示而无需单独调用每个数据。

我在下面的代码中使用了 mysql_fetch_array，但是对于 300 多个字段，这样做会很麻烦。我知道 mysql_fetch_assoc 可以使用，但我还没有弄清楚如何在正确的位置打印。

**mysql_fetch_assoc** *（请原谅我的无知，但如果不使用 WHILE 和 FOREACH，我无法让它工作）*

```
while ($row = mysql_fetch_assoc($result)) {
foreach($row as $key=>$value){    
echo "$key: $value<br />\n ";            
}} 
```

**这可行，但需要单独指定每个字段**

```
<?php  
//Database connection and Open database
require_once('config.php');   
$result = mysql_query("SELECT customer_info.*, style.* FROM customer_info, style WHERE customer_info.user_id = style.user_id AND customer_info.user_id=$user_id ") or die(mysql_error());
$row = mysql_fetch_array($result );
?>

<table border="0" cellspacing="2" cellpadding="2">
<tr><td name="fname">First Name: <?php echo $row['fname']; ?></td>
<td name="lname">Last Name: <?php echo $row['lname']; ?></td>
<td name="email">Email: <?php echo $row['email']; ?></td>
<td name="colors_love">Colors Love: <?php echo $row['colors_love']; ?></td>
</tr></table> 
```

有没有办法从根本上扭转我使用 INSERT INTO 代码实现这一目标的方式？如果是这样，我假设这将简化我的下一个任务（允许用户编辑他们的信息）

```
$fieldlist=$vallist='';
foreach ($_POST as $key => $value) {
$fieldlist.=$key.',';
$vallist.='\''.($value).'\',';
}
$result = mysql_query('INSERT INTO taste ('.$fieldlist.') VALUES ('.$vallist.')'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T05:14:08.963

这种？

```
 <?php  
//Database connection and Open database
require_once('config.php');   
$result = mysql_query("SELECT customer_info.*, style.* FROM customer_info, style WHERE customer_info.user_id = style.user_id AND customer_info.user_id=$user_id ") or die(mysql_error());
$row = mysql_fetch_assoc($result );
?>

<table border="0" cellspacing="2" cellpadding="2">
    <tr><?php foreach($row as $field => $content): ?>
        <td><?php echo $field; ?>: <?php echo $content; ?></td>
    <?php endforeach; ?></tr>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T05:16:47.547

撇开使用库是一个糟糕的想法这一事实`mysql`，你实际上大部分时间都在那里：

```
<table>
    <?php while ($row = mysql_fetch_assoc($result)): ?>
    <tr>
        <?php foreach($row as $key=>$value) {   
            echo "<td>$key: $value</td>\n "; 
        } ?> 
    </tr>          
    <?php endwhile; ?>
</table> 
```

您显然希望将其清理为真实表单，因为回显 db 字段名称并不完全是用户友好的。

# android - NullPointerException 错误的原因是什么

> ID：12127753
> 
> 赞同：-1
> 
> 时间：2012-08-26T05:05:07.127
> 
> 标签：android, nullpointerexception

我正在写一个溺水的应用程序。目前我有下一个问题，当我单击“R.layout.activity_colors_prefs”中的“redBtn”时出现下一个错误。

```
 08-26 03:27:31.576: E/AndroidRuntime(706): FATAL EXCEPTION: main
    08-26 03:27:31.576: E/AndroidRuntime(706): java.lang.NullPointerException
    08-26 03:27:31.576: E/AndroidRuntime(706):  at com.example.drawview.ChooseColor$1.onClick(ChooseColor.java:43)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at android.view.View.performClick(View.java:4084)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at android.view.View$PerformClick.run(View.java:16966)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at android.os.Handler.handleCallback(Handler.java:615)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at android.os.Handler.dispatchMessage(Handler.java:92)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at android.os.Looper.loop(Looper.java:137)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at android.app.ActivityThread.main(ActivityThread.java:4745)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at java.lang.reflect.Method.invokeNative(Native Method)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at java.lang.reflect.Method.invoke(Method.java:511)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
    08-26 03:27:31.576: E/AndroidRuntime(706):  at dalvik.system.NativeStart.main(Native Method) 
```

根据调试模式，问题出在此命令中：

*   view_a.setdrawColor(Color.RED);

在下一节课

```
public class ChooseColor extends Activity  {
    //View
    private DrawingView view_a;

    //Button
    Button redBtn;
    public int colorPref= Color.BLACK;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_colors_prefs);
        redBtn = (Button) findViewById(R.id.redColr);
        redBtn.setOnClickListener(myButtonListener);
        view_a=(DrawingView) findViewById(R.id.drawingView);
    }

    public int getColorPref() {
        return colorPref;
    }

    private OnClickListener myButtonListener = new OnClickListener() {

        public void onClick(View v) {
            switch (v.getId()) {
            case R.id.redColr:
                Toast.makeText(getBaseContext(), "RED", Toast.LENGTH_SHORT).show();
                view_a.setdrawColor(Color.RED);     
                break;
            default:
                break;
            }

        }
    };

The method "setdrawColor" is the next:

public void setdrawColor(int color) 
{ 
   //create a copy of bitmap before changing the paint color 
     bitmap = Bitmap.createBitmap(bitmap); 
     canvas.setBitmap(bitmap); 
     paint.setColor(color); 
} 
```

“setdrawColor”位于其他活动中，称为“DrawingView”的活动。“DrawingView”负责绘制并扩展 View 而不会扩展 Activity。

你能告诉我有什么问题吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T05:09:56.463

在调用方法并报告结果之前执行此操作

```
if (view_a != null) {
  view_a.setdrawColor(Color.RED);
} else {
  Log.e("ChooseColor","view_a is null!");
} 
```

我在想 view_a 永远不会正确设置。你能证实这一点吗？

# java - 功能挂起？在 packet.setAddress()

> ID：12127755
> 
> 赞同：0
> 
> 时间：2012-08-26T05:05:37.297
> 
> 标签：java, datagram

好的，因此该程序旨在接收连接，验证它们，然后重新发送该验证代码。在任何人生气之前，这只是一个简单的小项目，并没有设计得过于复杂哈哈。但是由于一些非常奇怪的原因，该函数挂在**send.setAddess(packet.getAddress);上。**我知道这一点是因为我已经注释掉了处理数据报数据包“发送”的每一行代码，并发现它在该特定行上“挂起”（或不再在该方法中前进）。有什么想法吗？我在做一些毫无头绪的错误吗？我也在 linux 服务器上尝试过它，以确保它与我没有任何关系，并且发生了同样的废话。

```
 public static boolean authorize(String n, DatagramPacket packet) {
    DatagramPacket send = new DatagramPacket(new byte[4096], 4096);
    try {
      System.out.println("in auth");
      String[] t1 = n.split("%@");
      String name = t1[1];
      int k = genKey(name);
      clients.put(name, k);
      send.setAddress(packet.getAddress());
      System.out.println("set add");
      send.setPort(packet.getPort());
      System.out.println("set port");
      send.setData(("l-succeed%@" + Integer.toString(k)).getBytes());
      System.out.println("set data");
      main.dispathcer(send);
      System.out.println("called send");
      return true;
    } catch(Exception e) {
      send.setData("l-failed".getBytes());
      main.dispathcer(send);
      return false;
    }
  } 
```

编辑：客户端收到授权令牌需要 6 分钟。所以显然 setAddress() 有效，但花费的时间太长了......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:11:53.540

该过程可能会挂起，因为`packet`当您调用`.getAddress()`. 为了创建 InetAddress 对象，进行了一些 DNS 调用。在这些机器上，您是否能够对`packet`数据包来自的 IP 进行反向 DNS 查找？`/etc/hosts`尝试在您的文件中为此 IP 设置一个条目。

# c# - 我不断收到一个名为“TypeIntializationException 未处理”的错误，我不知道如何

> ID：12127756
> 
> 赞同：0
> 
> 时间：2012-08-26T05:06:11.103
> 
> 标签：c#

这是我的 program.cs 文件（这都是在 VS 2010 上用 C# 完成的）

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Windows.Forms;

    namespace GameLoop
    {
     static class Program
        {
            static FastLoop _fastLoop = new FastLoop(GameLoop);
            /// <summary>
            /// The main entry point for the application.
         /// </summary>
            [STAThread]
         static void Main()
         {
               Application.EnableVisualStyles();
             Application.SetCompatibleTextRenderingDefault(false);
                Application.Run(new Form1());
         }
         static void GameLoop(double elapsedTime)
          {
                //GameCode goes here
             //Get Input
             //Process
            //Render
                System.Console.WriteLine("loop");
         }
      }
    } 
```

这是我的 FastLoop.cs 文件（这都是在 C# 中的 VS 2010 上完成的）

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using System.Runtime.InteropServices;

    namespace GameLoop
    {
        [StructLayout(LayoutKind.Sequential)]
        public struct Message
        {
            public IntPtr hWnd;
            public Int32 msg;
            public IntPtr wParam;
            public IntPtr lParam;
            public uint time;
            public System.Drawing.Point p;
        }

        public class FastLoop
        {
            [System.Security.SuppressUnmanagedCodeSecurity]
            [DllImport("User32.dll", CharSet = CharSet.Auto)]
            public static extern bool PeekMessage(
                out Message msg,
                IntPtr hWnd,
                uint messageFilterMin,
                uint messageFilterMax,
                uint flags);

            PreciseTimer _timer = new PreciseTimer();
            public delegate void LoopCallback(double elapsedTime);
            LoopCallback _callback;

            public FastLoop(LoopCallback callback)
            {
                _callback = callback;
                Application.Idle += new EventHandler(OnApplicationEnterIdle);
            }
            void OnApplicationEnterIdle(object sender, EventArgs e)
            {
                while (IsAppStillIdle())
                {
                    _callback(_timer.GetElapsedTime());
                }
            }
            private bool IsAppStillIdle()
            {
                Message msg;
                return !PeekMessage(out msg, IntPtr.Zero, 0, 0, 0);

            }
        }
    } 
```

这是我的 PerciseTimer.cs 文件（这都是在 C# 中的 VS 2010 上完成的）

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Runtime.InteropServices;

    namespace GameLoop
    {
        public class PreciseTimer
        {
            [System.Security.SuppressUnmanagedCodeSecurity]
            [DllImport("kernal32")]
            private static extern bool QueryPerformanceFrequency(ref long PerformanceFrequency);

             [System.Security.SuppressUnmanagedCodeSecurity]
            [DllImport("kernal32")]
        private static extern bool QueryPerformanceCounter(ref long PerformanceCount);

            long _ticksPerSecond = 0;
            long _previousElapsedTime = 0;

            public PreciseTimer()
            {
                QueryPerformanceFrequency(ref _ticksPerSecond);
                GetElapsedTime();//get rid if first rubbish result
            }
            public double GetElapsedTime()
            {
                long time = 0;
                QueryPerformanceCounter (ref time);
                double elapsedTime = (double)(time -_previousElapsedTime)/(double)_ticksPerSecond;

                _previousElapsedTime = time;
                return elapsedTime;
        }
    }
    } 
```

这是我的 form1.cs 文件（这都是在 C# 中的 VS 2010 上完成的）

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;

    namespace GameLoop
    {
        public partial class Form1 : Form
        {
            bool _fullscreen = true;
            public Form1()
            {
                InitializeComponent();
                simpleOpenGlControl1.InitializeContexts();
                if (_fullscreen)
                {
                    FormBorderStyle = FormBorderStyle.None;
                    WindowState = FormWindowState.Maximized;

                }
            }

            private void Form1_Load(object sender, EventArgs e)
            {

            }

            private void simpleOpenGlControl1_Load(object sender, EventArgs e)
            {

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T15:31:13.550

发生 TypeInitializationException 是因为由于构造函数中发生的另一个异常或由于静态初始化的字段而无法初始化您的类型。

*   通常 TypeInitializationException 只是另一个实际导致问题的异常的包装器，因此检查内部异常通常会向您显示问题。

*   如果这不起作用，请尝试从构造函数中注释（或移动代码）以消除这种可能性。

*   将任何静态字段的初始化移动到函数中并显式调用它们。

# c++ - 将对象传递给期望 shared_ptr 的函数而不实际共享所有权

> ID：12127758
> 
> 赞同：7
> 
> 时间：2012-08-26T05:06:39.637
> 
> 标签：c++, memory-management, shared-ptr

首先，我确实意识到这与 shared_ptr 的目的完全矛盾。我正在处理一些库代码，其中 ParticleSystem 的实例期望在构造期间将 shared_ptr 传递给它们以设置用于每个粒子的纹理。问题是，我已经以我的纹理拥有具体所有权的方式构建了我的程序的其余部分（如果这是正确的术语）——TextureCache 拥有所有纹理。所以我需要一种方法来使用这个 ParticleSystem 类，而不允许它删除我的纹理。如果我只是简单地创建一个新实例，`ParticleSystem(std::shared_ptr<Texture>&myTexture)`那么它将尝试在纹理被破坏时破坏它（这是一个不需要且无效的操作，因为我的纹理甚至不是用`new`.

我在这个问题上看到的最干净的方法是这样的：

1.  在创建 ParticleSystem 的函数中创建一个包含纹理的 shared_ptr。
2.  然后使用placement new，在与我刚刚创建的shared_ptr 相同的内存位置重建shared_ptr。现在纹理的引用计数为 2。
3.  创建粒子系统。
4.  让 shared_ptr 超出范围。因为它是在堆栈上分配的，所以它的解构器将被调用，并且它只会将引用计数减 1。因此，对象的引用计数将始终比实际值大 1，因此它永远不会被自动销毁。

我相信这个解决方案是合理的，但它仍然令人难以置信的骇人听闻。有没有更好的方法来解决我的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-04-17T21:43:59.123

如果您想将非托管指针（您自己管理）传递给需要智能指针的代码，例如，您可以通过别名构造`shared_ptr`函数创建空但不为空来禁用«智能»指针功能：`shared_ptr`

```
Texture* unmanagedPointer = ...
shared_ptr<Texture> smartPointer(shared_ptr<Texture>(), unmanagedPointer); 
```

此解决方案比其他人建议的自定义删除器更有效且更短，因为没有进行控制块分配和引用计数。

一些额外的细节可以在这里找到：

[C++ 中的空 std::shared_ptr 和空 std::shared_ptr 有什么区别？](https://stackoverflow.com/questions/25920681/what-is-the-difference-between-an-empty-and-a-null-stdshared-ptr-in-c)

[如何使用 std::make_shared 避免大内存分配](https://stackoverflow.com/questions/24741061/how-to-avoid-big-memory-allocation-with-stdmake-shared/24741131#24741131)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T07:26:32.913

您可以`shared_ptr`使用[不执行任何操作的自定义删除器](http://www.boost.org/doc/libs/1_47_0/libs/smart_ptr/sp_techniques.html#static)创建。这将防止删除 this 拥有的纹理`shared_ptr`。

```
struct null_deleter
{
    void operator()(void const *) const
    {
    }
};

shared_ptr<Texture> CreateTexture(Texture* myTexture)
{
    shared_ptr<Texture> pTexture(myTexture, null_deleter());
    return pTexture;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T07:27:41.427

`shared_ptr`允许您提供自定义删除器。因此`shared_ptr`可以用于使用 malloc 分配的内存或您正在使用的任何内存分配方案，您甚至可以使用它来自动解锁互斥锁或关闭文件，但我离题了。您可以使用 null 删除器创建一个`shared_ptr`，当它的引用计数达到 0 时它不会做任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T05:27:51.343

`shared_ptr`按照 Vaughn Cato 的建议，将缓存存储在您的缓存中。为了在没有人使用时从缓存中删除纹理，只需检查是否返回`use_count`函数，这意味着缓存是唯一的所有者`shared_ptr``1`

# javascript - 如何将 Mustache 模板编译成 Javascript 函数？

> ID：12127761
> 
> 赞同：3
> 
> 时间：2012-08-26T05:07:29.803
> 
> 标签：javascript, mustache

我希望能够编译这样的 Mustache 模板（*test.mustache*）：

```
<b>This is a {{test}}</b> 
```

变成这样的函数：

```
function test(obj) {
    var s = '<b>This is a ' + obj.test + '</b>';
    return s;
}; 
```

同时希望保留所有 Mustache 功能完好无损。是否有任何库可以做到这一点，或者如果我想要预编译的模板，我必须自己编写吗？我计划将其用于客户端应用程序。

# java - 如何从在线数据库中抓取数据？

> ID：12127762
> 
> 赞同：0
> 
> 时间：2012-08-26T05:07:31.423
> 
> 标签：java, android

无论如何，有人可以帮助我吗？目前我正在做我的主要项目，也是android和java的初学者。我正在为我的项目做登录功能。我 从这里[参考。](http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/)但是，我现在面临的一个问题是我不知道如何从数据库中获取详细信息（姓名和电子邮件列）并显示这两个信息。是否有关于如何在用户登录后获取信息并将其显示出来的指南？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:46:13.843

**1.**尝试使用`SQLite`Android自带的DataBase。

**2.**它只是一个`file`没有**数据库**服务器。

**3.**这个DB可以**小到**250KB。

**有关快速简便的示例，请参见此处：**

[http://android-er.blogspot.in/2011/06/simple-example-using-androids-sqlite_02.html](http://android-er.blogspot.in/2011/06/simple-example-using-androids-sqlite_02.html)

**为了理解查询，请看这里：**

[http://mobile.tutsplus.com/tutorials/android/android-sqlite/](http://mobile.tutsplus.com/tutorials/android/android-sqlite/)

[http://www.vogella.com/articles/AndroidSQLite/article.html](http://www.vogella.com/articles/AndroidSQLite/article.html)

# opengl - 使用 imageStore 无法将纹理作为 GL_R32UI 写入

> ID：12127764
> 
> 赞同：5
> 
> 时间：2012-08-26T05:08:12.577
> 
> 标签：opengl, glsl, opengl-4

我有一个内部格式为 的 3D 纹理，`GL_R32UI`只要我假装它是浮点纹理，写入它就可以正常工作。

那就是如果我将它绑定为

```
layout(binding = 0) uniform image3D Voxels; 
```

并写给它

```
imageStore(Voxels, coord.xyz, vec4(1)); 
```

一切都按预期工作。但是尝试绑定它，同时将正确的类型指定为

```
layout(r32ui, binding = 0) uniform uimage3D Voxels; 
```

并写信给它

```
imageStore(Voxels, coord.zxy, uvec4(1)); 
```

似乎不起作用，也就是说，没有任何东西被写入纹理。我想正确地完成这项工作，以便我可以使用这些`imageAtomic`操作。有人知道会发生什么吗？

# ruby-on-rails - 在 Rails 应用程序上创建第一个 ruby 会引发错误

> ID：12127765
> 
> 赞同：0
> 
> 时间：2012-08-26T05:08:14.293
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我刚开始学习 Ruby on Rails 是在一本书之后。当我尝试从命令行创建我的第一个应用程序时，出现了一个致命错误。我在安装 ruby​​ 时遇到了一些问题，但现在一切都已安装。但是，我无法创建应用程序。这是我得到的错误：-

```
 ~/workspace/RoR/rails_projects $ rails new first_app
  create  
  create  README.rdoc
  create  Rakefile
  create  config.ru
  create  .gitignore
  create  Gemfile
  create  app
  create  app/assets/images/rails.png
  create  app/assets/javascripts/application.js
  create  app/assets/stylesheets/application.css
  create  app/controllers/application_controller.rb
  create  app/helpers/application_helper.rb
  create  app/mailers
  create  app/models
  create  app/views/layouts/application.html.erb
  create  app/mailers/.gitkeep
  create  app/models/.gitkeep
  create  config
  create  config/routes.rb
  create  config/application.rb
  create  config/environment.rb
  create  config/environments
  create  config/environments/development.rb
  create  config/environments/production.rb
  create  config/environments/test.rb
  create  config/initializers
  create  config/initializers/backtrace_silencers.rb
  create  config/initializers/inflections.rb
  create  config/initializers/mime_types.rb
  create  config/initializers/secret_token.rb
  create  config/initializers/session_store.rb
  create  config/initializers/wrap_parameters.rb
  create  config/locales
  create  config/locales/en.yml
  create  config/boot.rb
  create  config/database.yml
  create  db
  create  db/seeds.rb
  create  doc
  create  doc/README_FOR_APP
  create  lib
  create  lib/tasks
  create  lib/tasks/.gitkeep
  create  lib/assets
  create  lib/assets/.gitkeep
  create  log
  create  log/.gitkeep
  create  public
  create  public/404.html
  create  public/422.html
  create  public/500.html
  create  public/favicon.ico
  create  public/index.html
  create  public/robots.txt
  create  script
  create  script/rails
  create  test/fixtures
  create  test/fixtures/.gitkeep
  create  test/functional
  create  test/functional/.gitkeep
  create  test/integration
  create  test/integration/.gitkeep
  create  test/unit
  create  test/unit/.gitkeep
  create  test/performance/browsing_test.rb
  create  test/test_helper.rb
  create  tmp/cache
  create  tmp/cache/assets
  create  vendor/assets/javascripts
  create  vendor/assets/javascripts/.gitkeep
  create  vendor/assets/stylesheets
  create  vendor/assets/stylesheets/.gitkeep
  create  vendor/plugins
  create  vendor/plugins/.gitkeep
     run  bundle install
/usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': no such file to load -- openssl (LoadError)
    from /usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/lib/ruby/1.9.1/net/https.rb:92:in `<top (required)>'
    from /usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/vendor/net/http/persistent.rb:447:in `ssl'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/vendor/net/http/persistent.rb:216:in `connection_for'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/vendor/net/http/persistent.rb:358:in `request'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/fetcher.rb:145:in `fetch'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/fetcher.rb:173:in `fetch_dependency_remote_specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/fetcher.rb:132:in `fetch_remote_specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/fetcher.rb:70:in `specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/source.rb:234:in `block in remote_specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/source.rb:232:in `each'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/source.rb:232:in `remote_specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/source.rb:165:in `fetch_specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/source.rb:70:in `specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/definition.rb:205:in `block (2 levels) in index'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/definition.rb:202:in `each'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/definition.rb:202:in `block in index'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/index.rb:9:in `build'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/definition.rb:198:in `index'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/definition.rb:192:in `resolve'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/definition.rb:127:in `specs'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/definition.rb:122:in `resolve_remotely!'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/installer.rb:48:in `run'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/installer.rb:12:in `install'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/cli.rb:220:in `install'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/vendor/thor/task.rb:22:in `run'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/vendor/thor.rb:263:in `dispatch'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/lib/bundler/vendor/thor/base.rb:386:in `start'
    from /usr/share/ruby-rvm/gems/ruby-1.9.2-p180@rails3tutorial/gems/bundler-1.1.5/bin/bundle:13:in `<main>'
Fetching gem metadata from https://rubygems.org/.Unfortunately, a fatal error has occurred. Please see the Bundler 
troubleshooting documentation at http://bit.ly/bundler-issues. Thanks! 
```

这是我的安装位置 -

```
 ~/workspace/RoR/rails_projects $ which ruby
      /usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/bin/ruby

     ~/workspace/RoR/rails_projects $ which ruby
    /usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/bin/ruby

    ~/workspace/RoR/rails_projects $ which gem
    /usr/share/ruby-rvm/rubies/ruby-1.9.2-p180/bin/gem 
```

我正在使用 Linux Mint 12。有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:35:36.133

经过一番搜索，我发现[这篇文章](http://www.dinduks.com/rails-cannot-load-such-file-openssl/)解决了这个问题。基本上，该错误意味着 Ruby 没有使用 openssl 编译。

PS：要在 ubuntu-11.10/linux mint 12 上安装 Ruby 和 Rails，[这](http://rails.vandenabeele.com/blog/2011/11/26/installing-ruby-and-rails-with-rvm-on-ubuntu-11-dot-10/)是一篇好文章。

认为这对任何有同样问题的人都有帮助。

# java - JNI：UnsatisfiedLinkError：找不到依赖库

> ID：12127769
> 
> 赞同：2
> 
> 时间：2012-08-26T05:09:51.340
> 
> 标签：java, java-native-interface

我正在尝试编写一个简单的 Java 程序，该程序通过 JNI 调用 C 函数来打印“Hello World”。一切都编译没有错误，但是当我运行程序时，我得到一个“UnsatisfiedLinkError：找不到依赖库”。

根据 Dependency Walker 和 dumpbin，唯一的依赖项是“kernel32.dll”，位于 C:\Windows\System32 及其依赖项中，也在 System32 中。

打电话

```
 System.loadLibrary("Kernel32"); 
```

返回没有错误，但加载包含打印功能的 Hello.dll 仍然会引发错误。

有谁知道这可能是什么原因造成的？

编辑：

Dependency Walker 确实给出了两个警告/错误：

-错误：由于隐式依赖模块中缺少导出函数，至少一个模块具有未解析的导入。

-错误：发现具有不同 CPU 类型的模块。

编辑：

以下是更多细节：我正在运行 Windows 7 64 位，并使用 cl (Visual Studio 2010) 编译我的 .dll。

我的 Java 代码 Hello.java：

```
 public class Hello
    {
        public static native void hello();

        public static void main(String[] args)
        {
            hello();
        }

        static
        {
            // Extra dependencies load with no error
            System.loadLibrary("NTDLL");
            System.loadLibrary("KERNELBASE");
            System.loadLibrary("KERNEL32");
            System.loadLibrary("Hello"); // Throws UnsatisfiedLinkError
        }
    } 
```

我可以毫无错误地编译 java 文件，并使用 javah -jni 生成 C 头文件 Hello.h：

```
 /* DO NOT EDIT THIS FILE - it is machine generated */
    #include <jni.h>
    /* Header for class Hello */

    #ifndef _Included_Hello
    #define _Included_Hello
    #ifdef __cplusplus
    extern "C" {
    #endif
    /*
     * Class:     Hello
     * Method:    hello
     * Signature: ()V
     */
    JNIEXPORT void JNICALL Java_Hello_hello
      (JNIEnv *, jclass);

    #ifdef __cplusplus
    }
    #endif
    #endif 
```

我在 Hello.c 中实现了标头：

```
 #include <stdio.h>
    #include <jni.h>
    #include "Hello.h"
    #pragma comment(linker, "/EXPORT:Java_Hello_hello=_Java_Hello_hello@8")

    JNIEXPORT void JNICALL
    Java_Hello_hello(JNIEnv* env, jclass class)
    {
        printf("Hello World\n");
        return;
    } 
```

C 代码用 cl（虽然我也尝试过 tcc）编译成 Hello.dll，它与 java .class 存储在同一目录中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T18:49:30.270

看起来我的问题是 64 位系统和 java 安装以及 32 位 C 编译器的组合。

默认情况下，Visual C++`cl`编译器会生成 32 位应用程序，这会导致在被 64 位 java.lang.java 加载时出错。我使用 Windows SDK 7.1 64 位编译器编译了我的应用程序，它运行没有错误，并且删除了 Dependency Walker 中的警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T05:47:46.427

我试图让 JNI 为学校的最后一个项目工作，并在一个月的头疼后最终寻找替代方案。请改用[Java Native Access](https://github.com/twall/jna)。它允许您从 Windows (.dll) 和 Linux (.so) 上的任何共享库中调用任何 C 函数，它甚至还为一些 Win32 函数提供了方便的方法。将您的本机代码编译到共享库中，然后使用 JNA 动态链接到该库并调用您的函数。它说它比 JNI 慢得多，这是有道理的，因为一切都是动态加载的，但我没有注意到性能下降。

为了弄清楚 C 编译器如何修改你的函数名——`strlen`变成`_strlen@4`什么——我推荐[DLL Export Viewer](http://www.nirsoft.net/utils/dll_export_viewer.html)（下载链接在底部附近）。我不知道Linux是否有类似的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T18:05:02.417

您将需要

*   将您的 DLL 放入 windows\system32\ 文件夹
*   在命令行中指定 java.library.path

# coffeescript - 无法在 JQuery 侦听器中修改 Coffeescript 的全局变量

> ID：12127773
> 
> 赞同：0
> 
> 时间：2012-08-26T05:10:46.513
> 
> 标签：coffeescript, global-variables, jquery

今天我将我的一些javascript代码迁移到coffeescript中并陷入了一些非常愚蠢的事情，但即使我不知道如何让它工作。

我想在触发点击事件时更新全局变量的值，请查看下面的代码以了解我的猜测之一

这是代码

```
@activeObject = null

# Some other code

$ ->
  $('#header').click ->
    if !headerSelected  
      showMenu '#header-menu', event
    else
      @activeObject = "#header"
      showMenu '#menu-style-header', event 
```

不幸的是，即使触发了点击事件，变量也没有得到更新。

我想出了一个解决方法。我创建了一个函数来设置变量的值并调用它而不是赋值，这一次它起作用了。

我只是想知道为什么我不能以另一种方式做到这一点。对我来说，这是一个简单的操作，为此定义一个新函数似乎很愚蠢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:36:27.020

我认为混淆是关于使用的`@`，这基本上只是一个捷径。如果您编译您的代码并查看它生成的 CoffeeScript 编译器，那么混淆就会变得清晰

```
this.activeObject = null;

$(function() {
  return $('#header').click(function() {
    if (!headerSelected) {
      return showMenu('#header-menu', event);
    } else {
      this.activeObject = "#header";
      return showMenu('#menu-style-header', event);
    }
  });
}); 
```

如果 activeObject 是全局的，你应该引用它

> window.activeObject = null

和

> window.activeObject = "#header";

在这段代码的两次出现中，导致有人可能会在第二次出现时试图在没有窗口的情况下使用它，但这会导致一个新的局部变量被隐式定义。

通常从 CoffeeScript 开始时， 在选项卡上的[http://coffeescript.org/中尝试这样的小片段很有用](http://coffeescript.org/)`Try Now`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T08:11:04.280

您的问题是单击处理程序内部的`@`(AKA `this`) 与外部不同，因此：

```
@activeObject = null 
```

和这个：

```
@activeObject = "#header" 
```

指的是两个不同`activeObject`的s。您应该能够将所有内容绑定`=>`到正确的位置`this`：

```
$ =>
  $('#header').click =>
    #... 
```

或者更好（恕我直言），只需`window.activeObject`在两个地方直接引用，这样每个人都可以清楚地看到您指的是全局变量：

```
window.activeObject = null
$ ->
  $('#header').click ->
    if !headerSelected  
      showMenu '#header-menu', event
    else
      window.activeObject = "#header"
      showMenu '#menu-style-header', event 
```

或者，您可以完全停止使用全局变量，而改用数据属性：

```
$ ->
  $('#header').data 'activeObject', null
  $('#header').click ->
    if !headerSelected  
      showMenu '#header-menu', event
    else
      $(@).data 'activeObject', '#header'
      showMenu '#menu-style-header', event 
```

# ruby-on-rails - 未初始化的常量 Mysql2::Client::REMEMBER_OPTIONS

> ID：12127780
> 
> 赞同：1
> 
> 时间：2012-08-26T05:12:20.543
> 
> 标签：ruby-on-rails, mysql2, nameerror

我只是遇到一个`uninitialized constant`错误，我现在不知道。请保存我的一天。

我正在尝试同时使用 mongodb 和 mysql2。Mongodb 没问题。现在我想将 mysql2 gem 添加到我的项目中。

之后 `gem install mysql2 -- --srcdir=/usr/local/mysql/include --with-mysql-config=/usr/local/mysql/bin/mysql_config`并将 mysql2 添加到`Gemfile`.

当我重新启动服务器时，它给了我这个错误：

```
/usr/local/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11/lib/mysql2/client.rb:12:in `<class:Client>': uninitialized constant Mysql2::Client::REMEMBER_OPTIONS (NameError)
    from /usr/local/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11/lib/mysql2/client.rb:2:in `<module:Mysql2>'
    from /usr/local/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11/lib/mysql2/client.rb:1:in `<top (required)>'
    from /usr/local/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11/lib/mysql2.rb:10:in `require'
    from /usr/local/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11/lib/mysql2.rb:10:in `<top (required)>'
    from /usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `require'
    from /usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.0.18/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from /usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `each'
    from /usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.0.18/lib/bundler/runtime.rb:66:in `block in require'
    from /usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `each'
    from /usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.0.18/lib/bundler/runtime.rb:55:in `require'
    from /usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.0.18/lib/bundler.rb:120:in `require'
    from /Users/Liber/ktv/trunk/config/application.rb:11:in `<top (required)>'
    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:53:in `require'
    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:53:in `block in <top (required)>'
    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `tap'
    from /usr/local/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

我该如何解决这个人？谢谢你。

```
 <class:Client>': uninitialized constant Mysql2::Client::REMEMBER_OPTIONS (NameError) 
```

- - - - - - - - - - - - - -解决方案 - - - - - - - - - - - ------

只是

```
brew install mysql 
```

> 不要使用 DMG 文件安装 mysql

接着 ：

```
sudo gem install mysql2 --with-mysql-config=/usr/local/mysql/bin/mysql_config 
```

现在一切正常。

谢谢@BenjaminTan

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:16:01.443

您应该查看这个链接，它[很好地概述了如何在 Mountain Lion 上设置 MySQL](https://stackoverflow.com/questions/11693360/mysql2-gem-cant-build-native-extensions)。正如 OP 所提到的，主要方法是依赖`brew install`而不是 dmg 文件。

# iphone - CGImageRef 更改

> ID：12127785
> 
> 赞同：0
> 
> 时间：2012-08-26T05:14:08.127
> 
> 标签：iphone, ios, xcode, cocoa-touch, cgimageref

那里。如何从另一个 ViewController 更改 CGImageRef？

我有这个代码：

```
#import "ScratchableView.h"

@implementation ScratchableView

- (id)initWithFrame:(CGRect)frame {

    self = [super initWithFrame:frame];
    if (self) {

      //init with the scratchable gray image

           scratchable = [UIImage imageNamed:@"image.jpg"].CGImage;

            width = CGImageGetWidth(scratchable);
    height = CGImageGetHeight(scratchable);

    self.opaque = NO;
    CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceGray();

    CFMutableDataRef pixels = CFDataCreateMutable( NULL , width * height );
    alphaPixels = CGBitmapContextCreate( CFDataGetMutableBytePtr( pixels ) , width , height , 8 , width , colorspace , kCGImageAlphaNone );
    provider = CGDataProviderCreateWithCFData(pixels);

    CGContextSetFillColorWithColor(alphaPixels, [UIColor blackColor].CGColor);
    CGContextFillRect(alphaPixels, frame);

    CGContextSetStrokeColorWithColor(alphaPixels, [UIColor whiteColor].CGColor);
    CGContextSetLineWidth(alphaPixels, 30.0);
    CGContextSetLineCap(alphaPixels, kCGLineCapSquare);

    CGImageRef mask = CGImageMaskCreate(width, height, 8, 8, width, provider, nil, NO);
    scratched = CGImageCreateWithMask(scratchable, mask);

    CGImageRelease(mask);
    CGColorSpaceRelease(colorspace);

    }
    return self;
} 
```

现在从另一个视图控制器我想用 image2.jpg 更改 image.jpg。请帮帮我，我该怎么做？

我尝试使用应用程序委托，使用 nsstrings，但没有成功。我是初学者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T15:22:14.340

让一个对象影响另一个对象的两种常见方法是提供可以设置的公共属性，或者在您的类上提供方法 + 参数。在这两种情况下，想要进行更改的对象都需要某种方式来访问第二个对象。常见的方法是在 UINavigation viewControllers 数组中找到它，或者通过 tabBarController，通过 appDelegate，或者第二个类是单例，可以通过询问类对象的引用来找到它。

当你解决这个问题时，调用类会执行类似发送具有此签名的消息的操作：

```
- (BOOL)updateImage:(CGImageRef)theNewImage 
```

# c# - 你能传递一个类型并强制在 C# 中传递什么类型吗？

> ID：12127788
> 
> 赞同：3
> 
> 时间：2012-08-26T05:15:16.803
> 
> 标签：c#, types

我设置了一种将类型作为参数传递的方法

```
private void SomeMethod(System.Type type)
    {
        //some stuff
    } 
```

有没有办法强制类型，以便您只能传入从特定基类继承的类型？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-26T05:27:32.957

尝试使您的函数泛型，并通过泛型类型参数传递类型参数：

```
private void SomeMethod<T>() where T : U {
    Type type = typeof(T);
    // some stuff
} 
```

您可以使用[此处](http://msdn.microsoft.com/en-us/library/d5x73970%28v=vs.80%29.aspx)列出的任何类型约束。

如果它必须处理任意类型的对象（例如，当您无法控制谁调用该函数时），那么您可能只需要使用运行时断言：

```
private void SomeMethod(System.Type type)
{
    if(!typeof(U).IsAssignableFrom(type)) {
        throw new ArgumentException("type must extend U!");
} 
```

另请参阅有关[类型限制](https://stackoverflow.com/questions/2025859/type-restriction)的这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T05:21:03.967

有很多可能性...

基于实例：

```
private void SomeMethod(object list) // total generic 
```

变成

```
private void SomeMethod(IEnumerable<object> list) // enumerable-generic 
```

或者

```
private void SomeMethod(List<object> list) // explicit list 
```

或具有通用功能：

```
private void SomeMethod<T>() where T : MyType // << contraints
{
    var theType = typeof(T);
} 
```

称之为：

```
var xyz = SomeClass.SomeMethod<string>(); // for example 
```

有关约束的更多信息：http: [//msdn.microsoft.com/en-us/library/d5x73970 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/d5x73970(v=vs.80).aspx)

# php - PHP的执行时间根据互联网/连接延迟而变化？

> ID：12127792
> 
> 赞同：2
> 
> 时间：2012-08-26T05:16:23.487
> 
> 标签：php, apache, networking

我希望有人可以帮助我理解一些事情。如果我正在访问位于地球另一端的网站，PHP 会报告大约 300 毫秒的页面执行时间（通过使用 进行简单的数学运算`microtime(true)`）。如果我在服务器上本地访问同一个网站，PHP 会报告大约 20 毫秒的页面执行时间。似乎网络延迟是 PHP 执行时间的一个因素，这让我感到惊讶，因为我认为整个页面都是由 PHP 渲染并返回到 apache 以立即发送给客户端（因此，脚本执行时间将是相同的，不分产地）。

阿帕奇、PHP5 (mod_php)、CentOS 5。

我是否假设 PHP 在继续执行之前以某种方式等待输出发送到浏览器？我感觉这可能涉及一些输出缓冲因素，但我真的不确定。我通过 php.ini 打开了输出缓冲。

我的问题是：发生了什么，我的网络延迟如何影响 PHP 的执行？

我希望这是提出此类问题的合适场所。我尝试搜索 SO & google，但没有找到任何相关的东西。

**编辑**我不是在谈论测量网页从服务器传输到客户端所需的时间。当我从本地机器下载页面的 HTML 源代码时，我直截了当地谈论 PHP 如何计算它的执行速度更快。相同的服务器，相同的页面，一致的结果。我`curl http://example.com | grep milliseconds`在这两个位置都使用来查看服务器报告的 PHP 执行时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:28:20.560

两台不同的机器，甚至是两台完全相同的机器，具有不同的服务器软件或不同的配置，都会对您的执行时间产生巨大影响。任何事情都可能发生。可能会出现堵塞（我以前也遇到过），突然页面加载需要 10 秒。之后，您重新启动浏览器，清空缓存，再试一次，几乎是瞬间的。

因此，在所有华夫饼之后，我只想提到的是，它与连接速度无关，或者至少几乎没有。

# prolog - 使用 tell 函数在 Prolog 中保存答案

> ID：12127794
> 
> 赞同：1
> 
> 时间：2012-08-26T05:16:49.527
> 
> 标签：prolog

我正在做一个 Prolog 项目，下面是我的代码。

```
:- dynamic yes/1,no/1.
:- dynamic n_angle/1.

go :- hypothesize(Shape),
  write('Yes I know the shape you talking about is a '),
  write(Shape),
  write('!!!!'),
  undo.

hypothesize(circle)          :- circle,!.

circle :- not(verify(width)),
      verify(radius),
      not(verify(height)),
      verify(diameter_equal_2_radius).

ask(Question):-

write('Has the shape '),
write(Question),
write('?'),
read(Response),
nl,
((Response == yes ; Response == y)
  -> assert(yes(Question));
     assert(no(Question)), fail).

verify(S) :-
   (yes(S) ->  true ;
   (no(S)  ->  fail ;
   ask(S))).

save_file:- tell('D:ansSave.txt').

/* undo all yes/no assertions */
undo :- retract(yes(_)),fail.
undo :- retract(no(_)),fail.
undo :- retract(n_angle(_)),fail.
undo. 
```

结果会是这样。

？- 去。具有形状宽度？n。

有形状半径吗？y。

具有形状高度？n。

形状为 diameter_equal_2_radius?y。

是的，我知道你说的形状是圆形！！！！

真的。

我想将如上所示的结果保存到 txt 文件中。

但是当我尝试将 save_file 放入 ask 函数时

```
ask(Question):-
 save_file,
write('Has the shape '),
write(Question),
write('?'),
read(Response),
nl,
told,
((Response == yes ; Response == y)
  -> assert(yes(Question));
     assert(no(Question)), fail). 
```

每次都会覆盖结果。谁能告诉我如何解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:51:16.553

如果您不想覆盖以前的文件内容，请考虑使用`append/1`.

所以你的规则必须是：

```
save_file:- append('D:ansSave.txt'). 
```

# java - 如何创建一个从动态类名访问变量的方法？

> ID：12127796
> 
> 赞同：0
> 
> 时间：2012-08-26T05:17:23.247
> 
> 标签：java, object, dynamic

我有一个“扩展”类，用于处理设计为动态使用的通用函数——也就是说，我希望能够将它与许多不同的类和变量一起使用（有点像你如何使用数学类之类的东西）。但是我遇到了一个我似乎无法弄清楚的小问题（我查看了很多论坛和网站，但没有运气）。

这是我的扩展类中的函数：

```
public void setPlayerFriction(Object objectType, double hspeed, double vspeed){
    objectType obj = new objectType();

    if(obj.hspeed >= GameWindow.friction){
          obj.hspeed -= GameWindow.friction;
    }else if(obj.hspeed <= -GameWindow.friction){
          obj.hspeed += GameWindow.friction;
    }else{
          obj.hspeed = 0;
    }
    if(obj.vspeed >= GameWindow.friction){
          obj.vspeed -= GameWindow.friction;
    }else if(obj.vspeed <= -GameWindow.friction){
          obj.vspeed += GameWindow.friction;
    }else{
          obj.vspeed = 0;
    }
} 
```

该函数在我的 Player 类中的使用：

```
public void runPhysicsEngine(){
    Extensions ext = new Extensions();
    ext.setPlayerFriction(this,hspeed,vspeed);
} 
```

显然，做类似`obj.var -= GameWindow.friction;`, where`obj`和`var`are arguments 的方法并不是做我想做的事情的正确方法——它只是返回未解决的类型错误。那么正确的方法是什么？如何从动态类名访问变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T07:33:24.060

我认为用适当的方法`abstract`为你上一堂课可能会有所帮助。例如：`objectType``getter/setter`

```
public abstract class ParentObject {

    private double hSpeed;
    private double vSpeed;

    /** Getter/setter methods */

    public double gethSpeed() {
        return hSpeed;
    }
    public void sethSpeed(double hSpeed) {
        this.hSpeed = hSpeed;
    }
    public double getvSpeed() {
        return vSpeed;
    }
    public void setvSpeed(double vSpeed) {
        this.vSpeed = vSpeed;
    }
} 
```

然后，您可以对`ObjectType`此类`extend`进行具体实现`ParentObject`。你会改变你的`setPlayerFriction()`方法如下：

```
public void setPlayerFriction(ParentObject objectType, double hspeed, double vspeed){

    double hSpeed = objectType.gethSpeed();
    if(hSpeed >= GameWindow.friction){
          objectType.sethSpeed(hSpeed - GameWindow.friction);
    }else if(hSpeed <= -GameWindow.friction){
          objectType.sethSpeed(hSpeed + GameWindow.friction);
    }else{
          objectType.sethSpeed(0);
    }

    double vSpeed = getvSpeed();
    if(vSpeed >= GameWindow.friction){
          objectType.setvSpeed(vSpeed - GameWindow.friction);
    }else if(obj.vspeed <= -GameWindow.friction){
          objectType.setvSpeed(vSpeed + GameWindow.friction);
    }else{
          objectType.setvSpeed(0);
    }
} 
```

对于这种方法，您基本上会发送实际上扩展了您的`ParentObject`类的类的引用。例如：

```
public class ObjImpl extends ParentObject{
    //Concrete implementation
}

public class ObjImpl2 extends ParentObject{
    //Concrete implementation
}

public class TestClass{
    public void setPlayerFriction(ParentObject objectType, double hspeed, double vspeed){   
        double hSpeed = objectType.gethSpeed();
        if(hSpeed >= GameWindow.friction){
              objectType.sethSpeed(hSpeed - GameWindow.friction);
        }else if(hSpeed <= -GameWindow.friction){
              objectType.sethSpeed(hSpeed + GameWindow.friction);
        }else{
              objectType.sethSpeed(0);
        }

        double vSpeed = getvSpeed();
        if(vSpeed >= GameWindow.friction){
              objectType.setvSpeed(vSpeed - GameWindow.friction);
        }else if(obj.vspeed <= -GameWindow.friction){
              objectType.setvSpeed(vSpeed + GameWindow.friction);
        }else{
              objectType.setvSpeed(0);
        }
    }

    public static void main(String[] args) {
        ParentObject object1    = new ObjImpl();
        ParentObject object2    = new ObjImpl2();

        setPlayerFriction(object1, 1.0d, 2.0d);
        setPlayerFriction(object2, 2.25d, 2.0d);
    }
} 
```

# c# - C#浮点和十进制输入和数学

> ID：12127804
> 
> 赞同：2
> 
> 时间：2012-08-26T05:20:13.260
> 
> 标签：c#, math, floating-point, decimal, user-input

用户输入他们的年龄，我必须返回该年龄，然后以十进制值返回年龄数字的一半，并以美元金额显示输入的工资。

我得到的样本变量包括：

```
 float y; 
```

所以这里有一个我如何在我写的代码中使用它的例子：

```
 using System;

    public class Profile
    {
        static void Main(string[] args)
        {
            int x;
            float y = 2.0f;
            var result = x / y;

            Console.Write("Please enter your age:");
            x = Covert.ToInt32(Console.ReadLine());

            Console.WriteLine("Your age is {0}, and half your age is {1}."
            , x, result);

            Console.ReadKey();
        }
    } 
```

但是如果我输入一个数字，比如“18”，它会显示“你的年龄是 18 岁，你的一半年龄是 9 岁”。我无法让它给我“9.0”之类的东西。

我还看到我的应用程序应该用小数点和逗号来说明工资（例如 $250,000.00），但它只显示“$250000”。我使用的一个例子是：

```
 decimal z;

    Console.Write("Please enter your salary");
    z = Convert.ToDecimal(Console.ReadLine());

    Console.WriteLine("Your salary is {0}.", z);

    Console.ReadKey(); 
```

我只是不应该在结果中看到小数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T05:22:24.183

使用字符串格式选项：

```
Console.WriteLine("Your age is {0}, and half your age is {1:00.00}."
        , x, result); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T05:22:04.267

您需要在获得用户输入后执行数学运算。

# php - 根据数据库中的评分结果对 PHP 数组进行排序

> ID：12127805
> 
> 赞同：0
> 
> 时间：2012-08-26T05:20:54.447
> 
> 标签：php, arrays, sorting

我有一个数组，我只是想通过一个`score`包含我试图排序的值的键来排序。所需的结果将更改下面数组的顺序，以按以下顺序显示索引：`[0]`, `[2]`, `[1]`.

我正在遍历从数据库中提取的结果。我正在创建一个名为的键`score`，然后将该`$row2`数组推入一个单独的数组，因为如果我使用`mysql_data_seek`它，它就会摆脱该`score`键。

它还`score`在底部创建了一个不需要的键。

我怎样才能最好地清理它并确保结果按照需要从高到低排序？

```
$my_array = array();

while ($row2 = mysql_fetch_assoc($result2))
{
 //score determined here
 //$row2['score'] = ...more math, variable is numeric, not a string
 array_push($array_page,$row2);
} 
```

当前的不良结果...

```
Array
(
    [0] => Array
        (
            [score] => 7
        )
    [1] => Array
        (
            [score] => 2
        )
    [2] => Array
        (
            [score] => 4
        )
    [score] => 
) 
```

想要的结果...

```
Array
(
    [0] => Array
        (
            [score] => 7
        )
    [2] => Array
        (
            [score] => 4
        )
    [1] => Array
        (
            [score] => 2
        )
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:25:39.093

```
function scoreSort($a, $b){
  if($a['score'] == $b['score']) return 0;
  return $a['score'] > $b['score'] ? -1 : 1;
}
usort(&$myArray, 'scoreSort'); 
```

在 php>5.3 上，您可以使用 inline-functoins：

```
usort(&$myArray, function($a,$b){ /* ... */ }); 
```

# php - 如何使用 PHP 在另一个类中调用方法

> ID：12127812
> 
> 赞同：1
> 
> 时间：2012-08-26T05:22:47.897
> 
> 标签：php

我分别创建了两个 php 类。那些是 Student.php 和 Main.php 这是我的代码。

**这是我的 Student.php**

```
<?php

class Student {

private $name;
private $age;

function __construct( $name, $age) {
    $this->name = $name;
    $this->age = $age;
}

function setName($name){
    $this->name = $name;
}

function setAge($age){
    $this->age = $age;
}

function getName() {
    return $this->name;
}

function getAge() {
    $this->age;
}

function display1() {
    return "My name is ".$this->name." and age is ".$this->age;
}

}

?> 
```

**这是我的 Main.php**

```
<?php

class Main{

function show() {
    $obj =new Student("mssb", "24");
    echo "Print :".$obj->display1();
}

}

$ob = new Main();
$ob->show();

?> 
```

所以我的问题是，当我调用 taht show 方法时，它给出了**致命错误：“学生”类未发现**这里有什么问题。有必要进口吗？请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T05:27:02.660

PHPUnit[文档](http://www.phpunit.de/manual/current/en/writing-tests-for-phpunit.html)说以前说 include/require PHPUnit/Framework.php，如下：

```
require_once ('Student.php'); 
```

从 PHPUnit 3.5 开始，有一个内置的自动加载器类可以为您处理这个问题：

```
require_once 'PHPUnit/Autoload.php' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T05:27:12.650

添加

```
require_once('Student.php') 
```

在您的 Main.php 文件中（在顶部）或在包含任何其他文件之前...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-25T08:28:23.930

你可以使用 require_once('Student.php') 或者你可以使用 PHP5 的新特性**命名空间**。例如，假设您的 Student.php 在名为 student 的目录中。然后作为 Student.php 的第一行，你可以把

```
<?php    
namespace student;

class Student {
} 
```

然后在你的 Main.php

```
<?php    
use student\Student;

class Main {
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T06:31:22.353

值得一看 PSR。特别是[PSR-1](https://github.com/pmjones/fig-standards/blob/psr-1-style-guide/proposed/PSR-1-basic.md)

其中一项建议是

> 文件应该声明符号（类、函数、常量等）或引起副作用（例如生成输出、更改 .ini 设置等），但不应该两者都做

遵循本指南有望使您遇到的问题变得不那么常见。

例如，通常只有一个文件负责加载所有必要的类文件（最常见的是通过[自动加载](http://php.net/manual/en/language.oop5.autoload.php)）。

当脚本初始化时，它应该做的第一件事就是包含负责加载所有必要类的文件。

# system - 即使在关闭后cpu如何计算系统时间？

> ID：12127813
> 
> 赞同：0
> 
> 时间：2012-08-26T05:22:48.787
> 
> 标签：system, cpu, clock

当我们关闭我们的电脑时，即使之后我们再次打开它，它也会显示正确的系统时间。没有电源怎么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:26:49.653

[CMOS 电池](http://en.wikipedia.org/wiki/Nonvolatile_BIOS_memory#CMOS_battery)将保持时钟运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T05:24:51.090

主板内部有一块电池，用于保持正确的时间和一些设置。你可以[谷歌关于它的图片](https://www.google.ru/search?q=battery%20motherboard&tbm=isch)

# mysql - 动态创建表的数据库设计

> ID：12127814
> 
> 赞同：1
> 
> 时间：2012-08-26T05:22:49.847
> 
> 标签：mysql, sql, sql-server, oracle, postgresql

我需要在数据库中动态创建动态表。例如，在数据库中，我将有名为：

```
Table
Column
DataType
TextData
NumberData
DateTimedata
BitData 
```

在这里，我可以在名为 table 的表中添加一个表，然后我可以在 columns 表中将所有列添加到该表中，并将数据类型与每一列相关联。

基本上我想创建表而不实际在数据库中创建表。这甚至可能吗？如果是这样，您能指导我到正确的地方以便我进行研究吗？另外，我更喜欢 sql server 或任何免费的数据库软件。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-26T05:32:46.517

您所描述的是[实体属性值模型（EAV）](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)。这是设计数据模型的一种非常糟糕的方式。

虽然数据模型非常灵活，但是查询这样的数据模型是相当复杂的。`n`如果您想选择或过滤`n`不同的属性，您经常不得不自行加入一个表时间。这变得相当缓慢并且变得相当难以相对快速地优化。

另外，您通常最终会构建数据库或 ORM 将提供的许多功能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-26T05:30:08.623

我不确定您遇到的真正问题是什么，但您提出的解决方案是“数据库中的数据库”反模式，这让很多人感到畏缩。

根据您查询数据的方式，如果您要按照您的计划构建事物，您要么需要一堆分段查询，这些查询连接在中间件中（慢），要么需要一个庞大的整体查询（要么缓慢或造成大量索引膨胀），如果有可能的话。

如果您必须即时创建表，请了解您正在使用的特定数据库引擎的`CREATE TABLE` `ALTER TABLE`DDL`DROP TABLE`语句。更好的是，找到一个可以为您执行此操作的 ORM。如果您的真正问题是需要存储非结构化数据，请查看 MongoDB、Redis 或其他一些 NoSQL 变体。

我最后的建议是将你试图解决的*实际*问题写成一个单独的问题，你可能会学到更多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-26T05:28:45.760

对文档执行此操作可能会更容易。或许您应该查看一个 noSQL 解决方案，例如[mongoDB](http://www.mongodb.org/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-26T14:10:57.590

或者您仍然可以创建临时表，但使用 cronjob 并每隔 %% 小时创建一次临时表，并在查询完成后将其重命名为正确的名称。所以你的网站还在空中

您尝试存档的内容还不错，但您必须以正确的逻辑方式使用它。

*对不起，我的英语不好

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-26T13:31:23.540

我在 LedgerSMB 中做了类似的事情。虽然我们将 EAV 建模用于一些事情（需要灵活性并且我们正在执行的查询类型是直接的，例如菜单节点部分使用它），但一般来说，您希望尽可能远离这种情况尽可能。

更好的方法是执行除数据列之外的所有操作。然后你可以（震惊）创建表格。这为您提供了您添加的内容的目录，以便您的应用程序知道这一点（如果您必须检查，您可以从系统目录中区分！）但同时您可以获得实际的关系建模。

我们在 LedgerSMB 中所做的是让存储过程接受表名存在（'extends_' || 提供的名称）。如果是这样，将添加一个具有所需数据类型的列并将其写入应用程序目录。这为我们提供了扩展属性的关系建模。在加载时，应用程序加载应用程序目录并在适当的点写入查询以加载/保存数据。实际上，它工作得很好。

# android - Android ICS 4.0 NDK NewStringUTF 正在崩溃应用程序

> ID：12127817
> 
> 赞同：15
> 
> 时间：2012-08-26T05:24:06.263
> 
> 标签：android, android-ndk, java-native-interface, android-4.0-ice-cream-sandwich, android-ndk-r7

我在 JNI C/C++ 中有一个方法，它接受 jstring 并返回 jstring，如下所示，

```
 NATIVE_CALL(jstring, method)(JNIEnv * env, jobject obj, jstring filename)
  {

// Get jstring into C string format.
  const char* cs = env->GetStringUTFChars (filename, NULL);
  char *file_path = new char [strlen (cs) + 1]; // +1 for null terminator
  sprintf (file_path, "%s", cs);
  env->ReleaseStringUTFChars (filename, cs);

  reason_code = INTERNAL_FAILURE;
  char* info = start_module(file_path);  

  jstring jinfo ;

  if(info==NULL)
  {
      jinfo = env->NewStringUTF(NULL);
  }
  else
  {
      jinfo = env->NewStringUTF(info);

  }

  delete info;

  info = NULL;
  return jinfo;
  } 
```

该代码与之前的 android 4.0 版本（如 2.2、2.3 等）完美配合。使用 ICS 4.0 检查 JNI 默认情况下处于启用状态，因此应用程序崩溃并引发以下错误

```
 08-25 22:16:35.480: W/dalvikvm(24027): **JNI WARNING: input is not valid Modified UTF-8: illegal  continuation byte 0x40**
08-25 22:16:35.480: W/dalvikvm(24027):              
08-25 22:16:35.480: W/dalvikvm(24027): ==========
08-25 22:16:35.480: W/dalvikvm(24027): /tmp/create
08-25 22:16:35.480: W/dalvikvm(24027): ==========
08-25 22:16:35.480: W/dalvikvm(24027): databytes,indoorgames,drop
08-25 22:16:35.480: W/dalvikvm(24027): ==========���c_ag����ϋ@�ډ@�����@'
 08-25 22:16:35.480: W/dalvikvm(24027):              in Lincom/inter       /ndk/comNDK;.rootNDK:(Ljava/lang/String;)Ljava/lang/String; **(NewStringUTF)**
08-25 22:16:35.480: I/dalvikvm(24027): "main" prio=5 tid=1 NATIVE
08-25 22:16:35.480: I/dalvikvm(24027):   | group="main" sCount=0 dsCount=0 obj=0x40a4b460   self=0x1be1850
08-25 22:16:35.480: I/dalvikvm(24027):   | sysTid=24027 nice=0 sched=0/0 cgrp=default handle=1074255080
08-25 22:16:35.490: I/dalvikvm(24027):   | schedstat=( 49658000 26700000 48 ) utm=1 stm=3 core=1
08-25 22:16:35.490: I/dalvikvm(24027):   at comrootNDK(Native Method) 
```

我对我错在哪里一无所知。如果您在上面看到 NewStringUTF 正在向 c Char* bytes 添加一些垃圾值。

1.  关于为什么会发生这种情况的任何想法
2.  欢迎任何实现上述目标的替代解决方案

如果你们中的一个人能帮助我，我真的很感激。提前致谢

看我

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-10-23T06:55:20.790

此问题的原因与 NDK/JNI GetStringUTFChars() 函数（以及可能与 NewStringUTF 等相关函数[）中的一个已知 UTF-8 错误](http://mail.openjdk.java.net/pipermail/core-libs-dev/2012-June/010403.html)直接相关。这些 NDK 函数不能正确转换[补充 Unicode 字符](https://en.wikipedia.org/wiki/Plane_(Unicode)#Supplementary_Multilingual_Plane)（即，值为 U+10000 及以上的 Unicode 字符）。这会导致不正确的 UTF-8 和随后的崩溃。

我在处理包含表情符号字符的用户输入文本时遇到了崩溃（[请参阅相应的 Unicode 图表](http://www.unicode.org/charts/PDF/U1F600.pdf)）。表情符号字符位于补充 Unicode 字符范围内。

**问题分析**

1.  Java 客户端将包含补充 Unicode 字符的字符串传递给 JNI/NDK。
2.  JNI 使用 NDK 函数 GetStringUTFChars() 来提取 Java 字符串的内容。
3.  GetStringUTFChars() 将字符串数据返回为不正确且无效的 UTF-8。

[有一个已知的 NDK 错误](http://mail.openjdk.java.net/pipermail/core-libs-dev/2012-June/010403.html)，即 GetStringUTFChars() 错误地转换补充 Unicode 字符，从而产生错误和无效的 UTF-8 序列。

在我的例子中，生成的字符串是一个 JSON 缓冲区。当缓冲区被传递给 JSON 解析器时，解析器立即失败，因为提取的 UTF-8 的 UTF-8 字符之一具有无效的 UTF-8 前缀字节。

**可能的解决方法**

我使用的解决方案可以总结如下：

1.  目标是防止 GetStringUTFChars() 对补充 Unicode 字符执行不正确的 UTF-8 编码。
2.  这是通过 Java 客户端将请求字符串编码为 Base64 来完成的。
3.  Base64 编码的请求被传递给 JNI。
4.  JNI 调用 GetStringUTFChars()，它在不执行任何 UTF-8 编码的情况下提取 Base64 编码的字符串。
5.  然后，JNI 代码解码 Base-64 数据，生成原始 UTF-16（宽字符）请求字符串，包括补充 Unicode 字符。

通过这种方式，我们规避了从 Java 字符串中提取补充 Unicode 字符的问题。相反，我们在调用 GetStringUTFChars() 之前将数据转换为 Base-64 ASCII，使用 GetStringUTFChars() 提取 Base-64 ASCII 字符，然后将 Base-64 数据转换回宽字符。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-12-11T08:14:09.197

我就是这样做的。

1- 字符数组到 JByteArray。

2- JByteArray 到 JString。

3-将jstring返回到java端。

**JNI 代码；(.c) 格式**

```
jstring Java_com_x_y_z_methodName(JNIEnv *env, jobject thiz) {
    int size = 16;
    char r[] = {'P', 'K', 'd', 'h', 't', 'X', 'M', 'm', 'r', '1', '8', 'n', '2', 'L', '9', 'K'};
    jbyteArray array = (*env)->NewByteArray(env, size);
    (*env)->SetByteArrayRegion(env, array, 0, size, r);
    jstring strEncode = (*env)->NewStringUTF(env, "UTF-8");
    jclass cls = (*env)->FindClass(env, "java/lang/String");
    jmethodID ctor = (*env)->GetMethodID(env, cls, "<init>", "([BLjava/lang/String;)V");
    jstring object = (jstring) (*env)->NewObject(env, cls, ctor, array, strEncode);

    return object;
} 
```

**Java代码；**

```
native String methodName(); 
```

**其他方法不适合我；**

我也尝试过`return (*env)->NewStringUTF(env, r)`，但返回一些不在 char 数组中的字符，在字符串末尾带有**JNI WARNING: input is not valid Modified UTF-8:illegal continuation byte 0x40**的警告。

例子; PKdhtXMmr18n2L9K………………-DL

**编辑：**

**C++ 版本**

```
jstring clientStringFromStdString(JNIEnv *env,const std::string &str){
//    return env->NewStringUTF(str.c_str());
    jbyteArray array = env->NewByteArray(str.size());
    env->SetByteArrayRegion(array, 0, str.size(), (const jbyte*)str.c_str());
    jstring strEncode = env->NewStringUTF("UTF-8");
    jclass cls = env->FindClass("java/lang/String");
    jmethodID ctor = env->GetMethodID(cls, "<init>", "([BLjava/lang/String;)V");
    jstring object = (jstring) env->NewObject(cls, ctor, array, strEncode);
    return object;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-04T19:40:53.000

我通过返回字节数组而不是字符串解决了这个问题。在 Java 方面，我现在将 Byte 数组转换为 Strings 。工作正常！避免在 Android 4.0 及更高版本中使用 NewStringUTF()，因为 Google Android NDK 上已经报告了一个错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-04T05:30:51.710

我在更改文件 Application.mk 时遇到了这个问题

从这一行：

```
APP_STL := stlport_static 
```

至：

```
APP_STL := gnustl_static 
```

一旦我再次更改它，它就解决了这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-26T22:28:22.973

传递给 NewStringUTF() 的字符串必须是有效的 Modified [UTF-8](http://en.wikipedia.org/wiki/UTF-8)。您的 start_Inauthroot() 函数返回的字符串看起来像其他编码，或者只是返回无效字符串。在将字符串传递给 JNI 函数之前，您需要将其转换为 UTF-8。或者，您可以改用[字符集感知 String 构造函数](http://developer.android.com/reference/java/lang/String.html#String%28byte%5B%5D,%20int,%20int,%20java.lang.String%29)之一来构建 String 对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-27T16:27:54.457

从最后一天开始，我也遇到了同样的问题。一天后终于想出了一个解决方案..我希望这个回复可以拯救某人的一天..

问题是我在本机函数中调用了另一个函数，直接使用了返回的字符串，这导致了 android 旧版本的崩溃

所以首先我将另一个函数返回的字符串保存到一个变量中，然后使用它，问题就消失了：D

以下示例可能会清除您的概念

```
//older code with error
//here key_ is the string from java code

const char *key = env->GetStringUTFChars(key_, 0);
const char *keyx = getkey(key).c_str();
return env->NewStringUTF(keyx); 
```

这就是我解决这个错误的方法

```
//newer code which is working
//here key_ is the string from java code

const char *key = env->GetStringUTFChars(key_, 0);
string k = getkey(key);
const char *keyx = k.c_str();
return env->NewStringUTF(keyx); 
```

快乐编码：D

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-15T01:09:07.217

对我来说，解决方案是将内容放在 const char* 上：

```
const char* string = name_sin.c_str();
jstring utf8 = env_r->NewStringUTF(string); 
```

和功能：

```
jclass cls_Env = env_r->FindClass(CLASS_ACTIVITY_NAME); 
jmethodID mid = env_r->GetMethodID(cls_Env, "Delegate",
                                 "(Ljava/lang/String;)V");

//todo importante hacerlo asi, si pasas directamente c_str a veces da error de carater no UTF 8
const char* string = name_sin.c_str();
jstring utf8 = env_r->NewStringUTF(string);

env_r->CallVoidMethod(*object_r, mid, utf8);

env_r->DeleteLocalRef(utf8); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-22T13:55:17.810

在我看来，这不是一个错误。

**NewStringUTF 从经过修改的 UTF-8**编码的字符数组构造一个新的 java.lang.String 对象。

修改后的 UTF-8 不是标准的 UTF-8。请参阅[修改后的 UTF-8](https://en.wikipedia.org/wiki/UTF-8#Modified_UTF-8)

在大多数情况下，UTF-8 编码的字符串是有效的修改后的 UTF-8。因为修改后的 UTF-8 和 UTF-8 非常相似。但是，当涉及基本多语言平面之外的 Unicode 字符串时，它们是不兼容的。

**解决方案：** 将 UTF-8 字节传递给 Java 层和 new String(bytes, "UTF-8") 然后将 jstring 传递给 JNI。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-04T23:10:12.817

这在 C++ 中对我有用

```
extern "C" JNIEXPORT
jstring Java_com_example_ndktest_MainActivity_TalkToJNI(JNIEnv* env, jobject javaThis, jstring strFromJava)
{
    jboolean isCopy;
    const char* szHTML = env->GetStringUTFChars(strFromJava, &isCopy);

    std::string strMine;
    strMine = szHTML;
    strMine += " --- Hello from the JNI!!";

    env->ReleaseStringUTFChars(strFromJava, szHTML);
    return env->NewStringUTF(strMine.c_str());
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-04-24T13:28:34.647

`c`android **ndk**的工作方式如下

```
JNIEXPORT jstring JNICALL
Java_com_example_hellojni_HelloJni_stringFromJNI( JNIEnv* env,
                                                  jobject thiz,jstring str )
{

    jboolean isCopy;
    const char* szHTML = (*env)->GetStringUTFChars(env, str, &isCopy);
     return (*env)->NewStringUTF(env, szHTML);
} 
```

# c++ - 指针和 {l,r} 值引用的通用名称？

> ID：12127818
> 
> 赞同：0
> 
> 时间：2012-08-26T05:24:15.323
> 
> 标签：c++, types, c++11, standards

指针和 {l,r} 值引用是否属于表示应该如何访问类型的同一组类型修饰？如果是这样，这个组的名称是什么？例如，`{const, volatile, restrict}`都是*类型限定符*。我正在寻找这样的名称，它可以应用于各种指针和引用（并且希望在某处的标准中提到）。

感谢您的洞察力！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T10:49:13.357

根据 C++ 语法，当它们出现在 [dcl.decl]/4 中定义的*ptr-declarator中时，它们都被称为**ptr-operator*

 *```
*ptr 运算符：
    * 属性说明符序列[选择]cv限定符序列[选择]
    &属性说明符序列[选择]
    && 属性说明符序列[选择]
    嵌套名称说明符 * 属性说明符序列[选择]cv 限定符序列[选择]* 
```

但这只是语法中的正式名称，就您如何使用指针和引用而言，它们并不相似，我认为将它们组合在一起没有太大价值。指针是对象，可以复制、按值传递、重新分配等。而引用不能做任何这些事情，它们是完全不同的语言结构。试图将它们分组为“表示应如何访问类型”的东西是恕我直言的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T07:12:53.860

AFAIK C++ 标准没有命名包含指针和引用的“类型装饰器”组，但您可以将它们称为**类型构建器**。

其他语言中相应的内置类型构建器使用不同的语法。

现代 C++ 中的模板机制与 C++11 相结合`using`，让您可以定义自定义类型构建器，可以说理想情况下我们现在应该切换到那个，而不是“失败的实验”C 语法……

例如，

```
template< class Pointee >
using Ptr = Pointee*;

template< class Referent >
using Ref = Referent&;

int main()
{
    Ptr<int> p = new int( 42 );
    Ref<int> r = *p;
} 
```

但是，截至 2012 年 8 月，Visual C++ 尚不支持此语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T07:22:48.433

接受一种类型并返回另一种类型的东西通常称为*类型构造函数*。例如，类型构造函数`*`接受一个类型`T`并返回另一个类型`pointer to T`。*

# macos - npm 安装成功，但节点 web.js 出错 w：“错误：找不到模块”

> ID：12127819
> 
> 赞同：2
> 
> 时间：2012-08-26T05:24:28.397
> 
> 标签：macos, node.js, npm

我正在努力让节点在新的 Mac 上运行。[我在http://nodejs.org/](http://nodejs.org/)下载了安装

然后我 git 克隆了我的节点存储库，运行 npm install 和 npm update，然后运行 ​​node web.js，然后出现以下错误：

```
$ node web.js 

Error: Cannot find module '/Users/me/Sites/mysite-node/node_modules/pg/lib/native/../../build/default/binding'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/Users/me/Sites/mysite-node/node_modules/pg/lib/native/index.js:12:12)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:362:17) 
```

我是节点新手，有什么想法或建议去哪里看吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T04:15:48.817

您需要在您的机器上安装 postgresql 库。例如在 Fedora 下你会：

```
yum install postgresql.x86_64
yum install postgresql-server.x86_64 
```

如果您已经安装了 pg ，则需要重新构建它：

```
npm rebuild pg 
```

然后验证终端类型的一切是否正常：

```
node 
```

然后在节点 REPL 类型中：

```
var pg = require('pg').native 
```

你不应该得到一个错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T18:16:15.060

错误表明 pg 模块的 npm 安装未正确构建本机绑定。修改您的代码如下：

```
//var pg = require('pg').native;
var pg = require('pg'); 
```

# c - copy_from_user - 从用户空间复制双指针的困难

> ID：12127820
> 
> 赞同：1
> 
> 时间：2012-08-26T05:24:36.263
> 
> 标签：c, linux, linux-kernel

涉及的结构如下。结构节点 { int a; 诠释 b; }

```
struct ioctl_node {
    struct node **ptr;
    int         count; //Stores the no of pointers this ptr is pointing to.
}; 
```

在用户空间中，我用 .ioctl_node 填充了一个结构`count = 3`。And `ptr[0]`and`ptr[2]`指向两个 node 类型的结构体，而`ptr[1]`is `NULL`. 我希望将其传递给内核。我已发出 ioctl 调用以将此信息从用户空间传递到内核空间。

我在内核空间中做了以下事情。

```
struct ioctl_node k_node;

copy_from_user(&k_node, arg, sizeof(struct ioctl_node)) //arg is the source

//k_node.count is showing the right value what I have set in the user space.

struct node *tmp = NULL; 
```

然后我做了，`copy_from_user(&tmp, k_node.ptr, sizeof(struct node *)`这个电话也成功了。但是，我很难`**ptr`在内核空间中正确复制完整内容。任何人都可以帮忙，我怎么能做到这一点。我应该如何执行下一个 copy_from_user 来复制所有内容。我试过了，但它给出了复制错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T20:55:18.007

`copy_from_user`将一个连续字节块从用户空间复制到内核空间。您需要先复制`struct ioctl_node`，然后将指针复制到各个节点，然后`struct node`在循环中复制 '。确保分配正确的内存量。由于您事先知道节点的数量，因此您可以分配它们的数组。

```
struct node_data {
    size_t node_count;
    struct nodes *nodes;
};
struct node_data *read_nodes(struct ioctl_node_user_pointer *arg)
{
    struct node_data *nd = NULL;
    struct ioctl_node kin = {0};
    struct node *node_user_pointers = NULL;
    int i;
    int err;
    /* Step 1: retrieve the root node */
    nd = kmalloc(sizeof(*nd), GFP_KERNEL);
    if (!nd) {
        err = -ENOMEM;
        goto error;
    }
    if (copy_from_user(ioctl_node_user_pointer, &kin, sizeof(kin))) {
        err = -EFAULT;
        goto error;
    }
    if (kin->count < 0 || kin->count > ((size_t)-1)/sizeof(*nodes)) {
        err = -EINVAL;
        goto error;
    }
    nd->node_count = kin.count;
    /* Step 2: retrieve the pointers to individual nodes */
    node_user_pointers = kmalloc(sizeof(*node_user_pointers) * nd->node_count, GFP_KERNEL);
    if (node_user_pointers) {
        err = -ENOMEM;
        goto error;
    }
    if (copy_from_user(kin->nodes, node_user_pointers, sizeof(*node_user_pointers) * nd->node_count)) {
        err = -EFAULT;
        goto error;
    }
    /* Step 3: retrieve the nodes themselves */
    nd->nodes = kmalloc(sizeof(*nodes) * nd->node_count, GFP_KERNEL);
    if (!nd->nodes) {
        err = -ENOMEM;
        goto error;
    }
    for (i = 0; i < head.count; i++) {
        if (copy_from_user(node_user_pointers[i], nd->nodes + i, sizeof(nd->nodes[0]))) {
            err = -EFAULT;
            goto error;
        }
    }
    kfree(node_user_pointers);
    return nd;
error:
    if (nd) {
        kfree(nd->nodes);
        kfree(nd);
    }
    kfree(node_user_pointers);
    return ERR_PTR(err);
} 
```

# ruby-on-rails-3 - 验证 Rails 3 中的语法

> ID：12127824
> 
> 赞同：1
> 
> 时间：2012-08-26T05:25:46.617
> 
> 标签：ruby-on-rails-3, validation, syntax

这是我的模型：

```
class User < ActiveRecord::Base
  attr_accessible :email, :name

  validates :name, presence: true, length: { maximum: 50 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX },
                uniqueness: true
end 
```

Rails 教程示例的作者说“**在方法中传递哈希作为最终参数时，花括号是可选的**”，但这里的`presence`验证不是最终参数，但可以不使用花括号，并且是有效代码。电子邮件属性的`format`验证也有效。
任何人都可以解释我为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T06:19:46.093

`:name, :presence: true, length: { maximum: 50 }` *是*传递给的最后一个参数`validates`，所以你不需要花括号。

如果您在该哈希*之后传递参数，**则*需要大括号的情况是：

 *```
validates { :name, presence: true, length: { maximum: 50 } }, some_other_argument 
```

这是散列*之后*`some_other_argument`的一些假设论点。要正确处理此问题，您需要在散列周围使用花括号。*

# android - android中的gps示例包括跟踪功能

> ID：12127831
> 
> 赞同：0
> 
> 时间：2012-08-26T05:27:26.477
> 
> 标签：android, gps

我对 Android 开发非常陌生。

*   我有能力`R&D`做`GPS system.`
*   我从这里找到了一些样本。但这对我来说并不清楚。
*   任何人都可以帮我获取 GPS 的示例程序，包括`Google Map view`当前位置、`GPS`跟踪和路径的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:33:35.270

我使用我创建的以下库来跟踪 GPS 坐标，

```
import android.location.Location;
import android.location.LocationListener;
import android.os.Bundle;

public class LocListener implements LocationListener
{
    private static double lat =0.0;
    private static double lon = 0.0;
    private static double alt = 0.0; 
    private static double speed = 0.0;

    public static double getLat()
    {
        return lat;
    }

    public static double getLon() 
    {
        return lon;
    }

    public static double getAlt()
    {
        return alt;
    }

    public static double getSpeed()
    {
        return speed;
    }

    @Override
    public void onLocationChanged(Location location) 
    {
        lat = location.getLatitude();
        lon = location.getLongitude();
        alt = location.getAltitude();
        speed = location.getSpeed(); 
    }

    @Override
    public void onProviderDisabled(String provider) {}
    @Override
    public void onProviderEnabled(String provider) {}
    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {}
} 
```

使用以下方式，您可以从上述类中获取纬度、经度详细信息，

```
String latitude,longitude;

    latitude = String.valueOf( LocListener.getLat() ); 
    longitude = String.valueOf( LocListener.getLon() ); 
```

要获取 gps，您需要在 AndroidManifest.xml 中授予 gps 权限，如下所示，

```
<uses-permission android:name="android.permission.ACCESS_GPS"></uses-permission>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"></uses-permission> 
```

# android - 3x3 数字矩阵上可能的模式

> ID：12127833
> 
> 赞同：5
> 
> 时间：2012-08-26T05:27:39.627
> 
> 标签：android, design-patterns, floyd-warshall

> **可能重复：**
> [安卓锁密码组合](https://stackoverflow.com/questions/6979524/android-lock-password-combinations)

尊敬的先生，我遇到了一个问题，该问题要求在给定 3x3 矩阵的情况下找到所有可能的唯一模式，其中的数字为 1-9。这与android锁屏相同。你能帮我怎么找到它吗？？我在想我们可以为此使用弗洛伊德战争并在后续矩阵中的值发生变化时增加计数吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-26T06:15:54.693

Android 图案锁屏的组合不会是从 1 到 9。相反，它们将是 4-9，因为锁定模式需要至少四个输入，并且低于该值的任何内容都是无效的（至少 2.3 开始。我相信 2.2 及以下允许 3 点锁定）。以下是组合的细分：

```
Moves = 4, combinations = 1624
Moves = 5, combinations = 7152
Moves = 6, combinations = 26016
Moves = 7, combinations = 72912
Moves = 8, combinations = 140704
Moves = 9, combinations = 140704

Total possibilities: 1624 + 7152 + 26016 + 72912 + 140704 + 140704 = 389112 
```

可以在[此处](http://www.quora.com/How-many-combinations-does-Android-9-point-unlock-have/answer/Yoyo-Zhou)找到 Google 工程师给出的数学背后的完整细分。

# php - 使用当前目录名查询 MySQL 表

> ID：12127839
> 
> 赞同：0
> 
> 时间：2012-08-26T05:29:04.527
> 
> 标签：php, mysql

是否可以使用当前目录名称（与现有表条目匹配）查询数据库？我正在尝试创建一个模板页面，该页面将根据它所在的当前目录提取内容。

所以代码看起来和结果是这样的：

```
mysql_select_db($table);
$stud_query = "SELECT * from [table] WHERE name = [current url directory];
$result = mysql_fetch_assoc(mysql_query($stud_query)); 
```

因此，如果 url 是 mysite.com/stack/，则查询将返回结果，如下所示：

```
$stud_query = "SELECT * from [table] WHERE name ="stack"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T05:46:24.543

真的，您应该使用 mod_rewrite 并通过将 url 分解成碎片将完整的路由传递给 index 以进行处理/路由。

```
RewriteEngine On
Options -Indexes
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?route=$1 [L,QSA] 
```

例子：

```
<?php 
// http://example.com/controller/action/sub_action

if(isset($_GET['route'])){
    $url_parts = explode('/', $_GET['route']);
    $controller = (isset($url_parts[0]) ? $url_parts[0] : null);
    $action     = (isset($url_parts[1]) ? $url_parts[1] : null);
    $sub_action = (isset($url_parts[2]) ? $url_parts[2] : null);
}

//With this in mind think:
// http://example.com/user/lcherone
// http://example.com/user/logout
// http://example.com/admin/page/add
// Life just got a whole lot easier!!!
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T05:38:55.860

```
$curDir = array_shift(explode('/', substr($_SERVER['REQUEST_URI'],1)));
$stud_query = sprintf("SELECT * from %s WHERE name = '%s';", 'table', mysql_real_escape_string($curDir)); 
```

# c# - SymFromAddr 使用 C#

> ID：12127842
> 
> 赞同：2
> 
> 时间：2012-08-26T05:29:54.670
> 
> 标签：c#, .net, windows, pinvoke

我试图看看如何使用 C# 中的 SymFromAddr。这就是我所拥有的。问题是，`DbgHelp.SymFromAddr(processHandle, (ulong)threadAddress, ref displacement, ref symbolInfo)`返回错误 87。我做错了什么？*做了一个轻微的mod。SizeOfStruct 现在已被填充。但没有果实。

```
static void GetThreadList(int processId, IntPtr processHandle)
{
    Console.WriteLine(string.Format("Process Id: {0:X4}", processId));
    var threadCollection = Process.GetProcessById(processId).Threads.OfType<ProcessThread>();
    foreach (ProcessThread processThread in threadCollection)
    {
        ulong dwAddress = (ulong)ThreadStartAddress(processThread.Id, processHandle);
        Console.WriteLine("  Thread Id: {0:X4}, Start Address: {1:X16}",
                          processThread.Id, dwAddress);
    }
}

static IntPtr ThreadStartAddress(int threadId, IntPtr processHandle)
{
    var threadHandle = DbgHelp.OpenThread(DbgHelp.ThreadAccess.QueryInformation, false, threadId);
    if (threadHandle == IntPtr.Zero)
        throw new Win32Exception();

    IntPtr threadAddress = IntPtr.Zero;
    var buf = Marshal.AllocHGlobal(IntPtr.Size);
        try
        {
            var result = DbgHelp.NtQueryInformationThread(threadHandle,
                             DbgHelp.ThreadInfoClass.ThreadQuerySetWin32StartAddress,
                             buf, IntPtr.Size, IntPtr.Zero);
            if (0 != result)
                throw new Win32Exception(string.Format("NtQueryInformationThread failed; NTSTATUS = {0:X8}", result));
            threadAddress = Marshal.ReadIntPtr(buf);

            unsafe
            {
                ulong displacement = 0;
                uint symsetOptStatus = DbgHelp.SymSetOptions(DbgHelp.SymOpt.UNDNAME | DbgHelp.SymOpt.DEFERRED_LOADS); // Returns 6.
                if (!DbgHelp.SymInitialize(threadHandle, null, true))
                {
                    // SymInitialize failed with error C000000B.
                    Console.WriteLine("SymInitialize returned error : {0:X16}.\n", Marshal.GetLastWin32Error());
                }
                DbgHelp.SYMBOL_INFO symbolInfo = new DbgHelp.SYMBOL_INFO();
                //symbolInfo.SizeOfStruct = (uint)Marshal.SizeOf(symbolInfo);
                //symbolInfo.MaxNameLen = DbgHelp.MAX_SYM_NAME;
                //const int maxNameLen = 512;
                //int bufferSize = Marshal.SizeOf(typeof(DbgHelp.SYMBOL_INFO)) + (DbgHelp.MAX_SYM_NAME * 2);
                //var buffer = Marshal.AllocHGlobal(bufferSize);
                //DbgHelp.SYMBOL_INFO symbolInfo = (DbgHelp.SYMBOL_INFO)buffer;
                symbolInfo.SizeOfStruct = (uint)Marshal.SizeOf(typeof(DbgHelp.SYMBOL_INFO));
                symbolInfo.MaxNameLen = DbgHelp.MAX_SYM_NAME -1;

                if (DbgHelp.SymFromAddr(processHandle, (ulong)threadAddress, ref displacement, ref symbolInfo))
                {
                    // SymFromAddr returned success.
                    return threadAddress;
                }
                else
                {
                    // SymFromAddr failed with error 87.
                    Console.WriteLine("SymFromAddr returned error : {0}.\n", Marshal.GetLastWin32Error());
                    return threadAddress;
                }
            }
        }
        finally
        {
            DbgHelp.CloseHandle(threadHandle);
            Marshal.FreeHGlobal(buf);
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T19:03:20.397

尝试：

```
 const int maxNameLen = 512;
        int bufferSize = sizeof(SYMBOL_INFO) + maxNameLen*2;
        buffer = (byte*)Marshal.AllocHGlobal(bufferSize);
        symbolInfo = (SYMBOL_INFO*)buffer;
        symbolInfo->SizeOfStruct = (uint)sizeof(SYMBOL_INFO);
        symbolInfo->MaxNameLen   = maxNameLen - 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T07:33:46.377

我看到的唯一方法是编写一个非托管 C++ 包装器来读取符号信息。

# c# - 生成随机字符串

> ID：12127843
> 
> 赞同：6
> 
> 时间：2012-08-26T05:30:04.637
> 
> 标签：c#, .net, string, unicode, encoding

我正在尝试在 .NET 中生成一个随机字符串并转换为字节，但遇到了一点困难。我想要完整的可能字符集，我的理解是字符串可以包含任何字符。

我的代码目前如下：

```
var plainText = new StringBuilder();
for (int j = 0; j < stringLength; ++j)
{
    plainText.Append((char)_random.Next(char.MinValue, char.MaxValue));
}
byte[] x = Encoding.Unicode.GetBytes(plainText.ToString());
string result = Encoding.Unicode.GetString(x); 
```

理论上，`plainText`应该`result`是相同的。它们大多相同，但一些原始字符丢失了，似乎是 55000-57000 范围内的字符 - 它们被替换为字符 65533。

我假设问题出在我的编码上，但我认为 Unicode 可以正确处理这个问题。我尝试过 UTF8 和 UTF32，但它们给了我同样的问题。

有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-26T05:36:29.543

问题是 0xD800-0xDFFF (55296-57343) 范围内的字符（称为 Unicode 代理字符）本身无效。它们必须成对出现（首先是 0xD800-0xDBFF，其次是 0xDC00-0xDFFF）才能有效（在 UTF-16 编码方案中）。单独，它们将被视为无效字符并解码为 0xFFFD (65533)。C# 使用 UTF-16 来表示其字符串，这就是您看到该输出的原因。

您可以选择将它们过滤掉（例如，调用`_random.Next`直到获得非代理字符），或者在生成代理字符时生成合法代理对。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T05:37:45.040

这些是代理字符 55296-57343 (0xD800-0xDFFF)。您需要正确配对它们。UTF-16 中的一对代理字符描述了一个 unicode 代码点。

您似乎在假设 char 和 code-point 是同一事物的情况下进行操作。这不是真的，有 >2^16 个代码点。

我推荐阅读[UTF-16 维基百科文章](http://en.wikipedia.org/wiki/UTF-16)。

# php - 使用 php sdk 更新状态时遇到问题

> ID：12127859
> 
> 赞同：0
> 
> 时间：2012-08-26T05:35:28.517
> 
> 标签：php, image, facebook-graph-api

我使用以下代码来更新状态：

```
$parameters = array(
'message' => "Hey guys check this cool app",
'link' => "http://apps.facebook.com/xxxx",
'name' => "Invitation for xxxx",
'picture'=>"http://localhost:55/xxxx/logo.jpg",
'caption' => "Try xxxx!",
'access_token'=>$at //valid access token
);

try{
    $statusUpdate = $facebook->api('/me/feed', 'POST', $parameters);
}catch(FacebookApiException $e){} 
```

这有效，在状态更新后，我得到一个 id。但是当我去我的个人资料并检查状态更新时，这就是我所看到的： ![在此处输入图像描述](../Images/d9b82ddc633adc31ce0408a35fd7da9b.png)。问题是：（1）图像不显示，和（2）`My first app`如图所示。为什么会这样？我如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:57:19.260

1.  `http://localhost/...`永远不会用作图像位置，因为 Facebook 将无法检索它。而是将图像的可公开访问 URL 放在该字段中。

2.  在您发布的屏幕截图中，“我的第一个应用程序”部分是应用程序的名称，您可以在应用程序设置中更改它。它不能在每个帖子的基础上更改，您应用中的所有帖子都归因于您的应用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T05:39:46.333

就图像而言，再次检查图像的路径是否正确。如果它仍然不起作用，请尝试指定“https”而不是 http，看看会发生什么

# jquery - jquery 图像/描述替换与淡入淡出

> ID：12127865
> 
> 赞同：0
> 
> 时间：2012-08-26T05:36:35.797
> 
> 标签：jquery

我只是（为您，而不是我）尝试将图像褪色添加到 www.webdesignerwall.com 提供的以下代码中。

```
$(document).ready(function(){
     $("h2").append('<em></em>')
     $(".thumbs a").click(function(){
       var largePath = $(this).attr("href");
       var largeAlt = $(this).attr("title");
       $("#largeImg").attr({ src: largePath, alt: largeAlt });  
       $("h2 em").html(" (" + largeAlt + ")"); return false;
     });
}); 
```

到目前为止，我已经失去了很多睡眠/头发，试图将其他代码的褪色功能联系起来。从其他代码中，我无法找到像这个一样具有 .append 功能的任何东西。我知道这对你们中的大多数 Jquery/javascript 专业人士来说是孩子们的游戏。不幸的是，webdev 之神对我没有那么好。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:42:34.393

```
$(document).ready(function(){
     $("h2").append('<em></em>')
     $(".thumbs a").click(function(){
       var largePath = $(this).attr("href");
       var largeAlt = $(this).attr("title");
       $("h2 em").hide();
       $("#largeImg").load(function(){
            $(this).fadeIn();
            $("h2 em").html(" (" + largeAlt + ")").fadeIn();
       }).attr({ src: largePath, alt: largeAlt }).hide();  
        return false;
     });
}); 
```

# python - 错误：“MSVCP90.dll：没有这样的文件或目录”，即使安装了 Microsoft Visual C++ 2008 Redistributable Package

> ID：12127869
> 
> 赞同：19
> 
> 时间：2012-08-26T05:37:46.753
> 
> 标签：python, visual-c++, python-2.7, py2exe

我正在尝试通过执行从源代码构建一个包`python setup.py py2exe`

这是 setup.py 中的代码部分，我想是相关的：

```
if sys.platform == "win32": # For py2exe.
    import matplotlib
    sys.path.append("C:\\Program Files\\Microsoft Visual Studio 9.0\\VC\\redist\\x86\\Microsoft.VC90.CRT")
    base_path = ""
    data_files = [("Microsoft.VC90.CRT", glob.glob(r"C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\x86\Microsoft.VC90.CRT\*.*")), 
```

它显示的错误：

```
*** finding dlls needed ***
error: MSVCP90.dll: No such file or directory 
```

**但我已经安装了“Microsoft Visual C++ 2008 Redistributable Package”。**我在 64 位 Windows 8 上运行 32 位 python。我正在尝试构建 32 位二进制文​​件。

也没有这样的文件夹：“C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\”。这是我的计算机包含的内容：

![在此处输入图像描述](../Images/7f5fdb5190cf2accad5338225c24d916.png)

**编辑：**

在我的 C:\ 驱动器上搜索时，`msvcp90.dll`我发现它们安装在如下奇怪的路径中：

![在此处输入图像描述](../Images/ad2595c68763a08b2d23962fc711ad9d.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-28T06:16:00.713

我建议完全忽略依赖关系。作为选项添加`MSVCP90.dll`到给定列表中。用户必须安装 Microsoft Visual C++ 2008 可再发行组件。一个例子：`dll_excludes``py2exe`

```
setup(
    options = {
            "py2exe":{
            ...
            "dll_excludes": ["MSVCP90.dll", "HID.DLL", "w9xpopen.exe"],
            ...
        }
    },
    console = [{'script': 'program.py'}]
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T08:12:22.270

（新答案，因为另一个答案描述了另一种解决方案）

您可以从 WinSxS 目录中获取文件并将它们复制到该`C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\x86\Microsoft.VC90.CRT`目录（通常由 Visual Studio 创建，您没有）。复制它们以获得以下结构：

```
 +-Microsoft.VC90.CRT
  | |
  | +-Microsoft.VC90.CRT.manifest
  | +-msvcm90.dll
  | +-msvcp90.dll
  | +-msvcr90.dll 
```

然后，您应该能够运行安装程序（仍然不包括`msvcp90.dll`，如在另一个答案中），它应该成功地找到下面的文件`Microsoft.VC90.CRT`并将它们作为数据文件复制到您的包中。

有关更多信息，请参阅[py2exe 教程](http://www.py2exe.org/index.cgi/Tutorial#Step522)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T23:12:04.770

我认为这与目录中的空格有关。您应该尝试使用`.rstrip()`. 例如，把这个：

```
directory='C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\x86\Microsoft.VC90.CRT'
directory=directory.rstrip() 
```

然后，您可以像使用实际路径一样使用变量目录。

这应该使 python 能够识别它以前无法破译它的目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T00:21:25.167

我曾经在 Windows 上遇到过很多复杂问题，例如您面临的问题以及使用`pip install cython`.

经过两周的痛苦后，最适合我的解决方案是下载并运行[此处](http://www.develer.com/oss/GccWinBinaries)提供的非官方 MinGW GCC 二进制文件。您可能想尝试一下，看看它是否有帮助。

如果你这样做了，你可能想要卸载 MinGW（如果你已经拥有它）。我不知道这是否是绝对必要的，但我总是这样做以防万一。我确实将它与 Cygwin 并排安装，没有任何问题。

# wordpress - 更改 wordpress 主题名称

> ID：12127870
> 
> 赞同：0
> 
> 时间：2012-08-26T05:38:47.830
> 
> 标签：wordpress, wordpress-theming

我想更改当前活动主题的主题名称。如果我停用当前主题并更改 style.css 中的名称并再次激活它，这会不会有问题？我会丢失我的小部件或任何其他设置吗？我正在使用 wordpress 3.4。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T05:42:40.740

您可能会丢失小部件设置，因为您在重命名之前切换到的主题可能没有注册相同的侧边栏。这就是我所担心的一切。

# android - 在 Google Cloud Messaging (GCM) 中注册和启动服务的两种方式

> ID：12127874
> 
> 赞同：3
> 
> 时间：2012-08-26T05:39:36.193
> 
> 标签：android, google-cloud-messaging

我正在尝试使用 GCM 开发应用程序。我阅读了有关 GCM 的官方文档，但感觉有两种方法可以做到这一点。

## 1.关于为GCM注册安卓设备

似乎有两种方法可以将设备注册到 GCM。

“http://developer.android.com/guide/google/gcm/gs.html#android-app”说，

```
GCMRegistrar.checkDevice(this);
GCMRegistrar.checkManifest(this);
final String regId = GCMRegistrar.getRegistrationId(this);
if (regId.equals("")) {
  GCMRegistrar.register(this, SENDER_ID);
} else {
  Log.v(TAG, "Already registered");
} 
```

另一方面，“http://developer.android.com/guide/google/gcm/gcm.html#registering”说，

```
Intent registrationIntent = new Intent("com.google.android.c2dm.intent.REGISTER");
// sets the app name in the intent
registrationIntent.putExtra("app", PendingIntent.getBroadcast(this, 0, new Intent(), 0));
registrationIntent.putExtra("sender", senderID);
startService(registrationIntent); 
```

## 2.关于从GCM服务器获取响应并启动一个服务来处理它们

另外，我觉得有两种方法可以开始处理响应的意图。

“http://developer.android.com/guide/google/gcm/gs.html#android-app”这样的指示，

“创建 com.google.android.gcm.GCMBaseIntentService 的子类”

并实施

onRegistered（上下文上下文，字符串 regId）

onUnRegistered（上下文上下文，字符串 regId）

onMessage（上下文上下文，意图意图）

...ETC。

虽然描述了“http://developer.android.com/guide/google/gcm/gcm.html#registering”，

```
public class MyBroadcastReceiver extends BroadcastReceiver {                                                                                                                                                                                  
   @Override
   public final void onReceive(Context context, Intent intent) {
       MyIntentService.runIntentInService(context, intent);
       setResult(Activity.RESULT_OK, null, null);
   }   
}   

public class MyIntentService extends IntentService {                                                                                                                          

    private static PowerManager.WakeLock sWakeLock;
    private static final Object LOCK = MyIntentService.class;

    static void runIntentInService(Context context, Intent intent) {
        synchronized(LOCK) {
            if (sWakeLock == null) {
                PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
                sWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "my_wakelock");
            }
        }
        sWakeLock.acquire();
        intent.setClassName(context, MyIntentService.class.getName());
        context.startService(intent);
    }

    @Override
    public final void onHandleIntent(Intent intent) {
        try {
            String action = intent.getAction();
            if (action.equals("com.google.android.c2dm.intent.REGISTRATION")) {
                handleRegistration(intent);
            } else if (action.equals("com.google.android.c2dm.intent.RECEIVE")) {
                handleMessage(intent);
            }
        } finally {
            synchronized(LOCK) {
                sWakeLock.release();
            }
        }
    }
} 
```

是否有两种方法可以完成上述两个过程，并且我可以使用任何我想要的方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T11:52:52.613

> 似乎有两种方法可以将设备注册到 GCM。

只有真正的方法，这是你的第二种方法。`GCMRegistrar`在幕后使用第二种方法来实现第一种方法。

> 另外，我觉得有两种方法可以开始处理响应的意图。

只有一种真正的方法，那就是你的第二种方法。`GCMBaseIntentService`在幕后使用第二种方法来实现第一种方法——这就是为什么您需要`BroadcastReceiver`在清单中注册 GCM 提供的方法。

在其他条件相同的情况下，我推荐第一种方法，因为它更简单并且可以为您处理各种问题。但是，任何一种方式都有效。

# ruby-on-rails - Rails 查询连接和关联

> ID：12127878
> 
> 赞同：1
> 
> 时间：2012-08-26T05:41:11.793
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在为这所潜水学校构建一个应用程序，该学校在每所学校都有多个地点和多个课程。我正在努力做到这一点，以便用户可以在特定学校找到特定讲师教授的所有课程（哦，男孩）。架构如下：

```
 create_table "courses", :force => true do |t|
    t.string   "course_name"
    t.integer  "course_number"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
    t.integer  "teacher_id"
    t.integer  "school_id"
  end

  create_table "teachers", :force => true do |t|
    t.string   "fname"
    t.string   "lname"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
    t.integer  "school_id"
  end 
```

我建立了以下关系：

```
courses belong_to school
courses belong_to teacher

teacher belong_to school

school has_many courses
school has_many teachers 
```

我不知道如何做到这一点，但这是我的（愚蠢的）尝试：

```
#I need to match these queries where course.teacher_id is equal to teacher.id
teachers = Teacher.where('fname ILIKE ? OR lname ILIKE ?', params[:fname], params[:lname])
courses = Course.where('school_id = ?', params[:id])

#now to join the above queries
courses_offered_by_searched_teacher_at_specified_school = courses.joins(teachers) 
```

我希望你能够遵循我正在尝试做的事情。任何和所有的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T05:49:24.443

这就是你应该使用的方式[`joins`](http://guides.rubyonrails.org/active_record_querying.html#joining-tables)：

```
Course.joins(:teacher).where('(teachers.fname ILIKE ? OR teachers.lname ILIKE ?) AND courses.school_id = ?', params[:fname], params[:lname], params[:id]) 
```

# html - 创建类似于分数的元素的最佳方法？

> ID：12127881
> 
> 赞同：1
> 
> 时间：2012-08-26T05:42:05.817
> 
> 标签：html, css, fractions

我尝试了很多方法，包括以下方法：

```
<table style="border-collapse: collapse; width: auto; float: left; margin: 2px;">
  <tbody>
    <tr><td style="text-align: center;padding: 5px; border-bottom: 1px solid black;">3</td></tr>
    <tr><td style="text-align: center; padding: 5px;">5</td></tr>
  </tbody>
</table> 
```

和

```
<span class="fraction">
    <span>5</span>
    <span>3</span>
</span>
<style type="text/css">
.fraction{
    display:inline-block;
    vertical-align:middle;
}
.fraction>span{
    display:block;
}
.fraction>span:first-child{
    border-bottom:1px solid black;
}
</style> 
```

所以我想知道，有没有更好的方法使用更少的元素？（例如，第一个使用`table`, `tbody`, 2 `tr`s & 2 `td`s）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T12:25:36.707

**如果布局不必完全垂直：**

`<sup>1</sup>&frasl;<sub>10</sub>`

这将产生：¹ ⁄ [10]

**如果它必须是垂直的：**

您的解决方案是我认为最好的解决方案之一。

**如果你想有一个简单的方法来写分数：**

例如，您可以使用 Javascript 库[http://www.mathjax.org/](http://www.mathjax.org/)或[http://mathscribe.com/author/jqmath.html](http://mathscribe.com/author/jqmath.html)。

**如果你想看起来像维基百科：**

使用由 TeX 发行版生成的图像 :)

# android - Android 上的 Lambdaj 错误

> ID：12127883
> 
> 赞同：3
> 
> 时间：2012-08-26T05:42:17.543
> 
> 标签：android, lambdaj

我正在尝试在我的 android 应用程序中使用[lambdaj 2.4和依赖项。](http://code.google.com/p/lambdaj/)但是，当我尝试使用以下选择语句时：

```
List<MOExpectedIncidentData> list = select(listExpectedIncidentData,
    having(on(MOExpectedIncidentData.class).TRAVELWAY_ID,
        equalTo(travelWayId))); 
```

我得到以下异常：

```
java.lang.VerifyError: net.sf.cglib.core.ReflectUtils 
```

这是堆栈跟踪：

```
[ch.lambdaj.proxy.ProxyUtil.createEnhancer(ProxyUtil.java:89),ch.lambdaj.proxy.ProxyUtil.createProxy(ProxyUtil.java:49),ch.lambdaj.function.argument.ArgumentsFactory.createPlaceholder(ArgumentsFactory.java:68),ch.lambdaj.function.argument.ArgumentsFactory.registerNewArgument(ArgumentsFactory.java:58),ch.lambdaj.function.argument.ArgumentsFactory.createArgument(ArgumentsFactory.java:50),ch.lambdaj.function.argument.ArgumentsFactory.createArgument(ArgumentsFactory.java:39),ch.lambdaj.Lambda.on(Lambda.java:63),gov.mo.dot.timm.model.MODataManager.getAllIncidentCount(MODataManager.java:100),gov.mo.dot.timm.InterstateListActivity.handleDataParsed(InterstateListActivity.java:75),java.lang.reflect.Method.invokeNative(Native Method),java.lang.reflect.Method.invoke(Method.java:507),roboguice.event.eventListener.ObserverMethodListener.onEvent(ObserverMethodListener.java:32),roboguice.event.EventManager.fire(EventManager.java:130),gov.mo.dot.timm.model.MODataManager.getExpectedIncidentData(MODataManager.java:150),gov.mo.dot.timm.model.MODataManager.handleDataDownload(MODataManager.java:172),java.lang.reflect.Method.invokeNative(Native Method),java.lang.reflect.Method.invoke(Method.java:507),roboguice.event.eventListener.ObserverMethodListener.onEvent(ObserverMethodListener.java:32),roboguice.event.EventManager.fire(EventManager.java:130),gov.mo.dot.timm.tasks.DataDownloadTask.onSuccess(DataDownloadTask.java:70),gov.mo.dot.timm.tasks.DataDownloadTask.onSuccess(DataDownloadTask.java:29),roboguice.util.SafeAsyncTask$Task$2.call(SafeAsyncTask.java:210),roboguice.util.SafeAsyncTask$Task$6.run(SafeAsyncTask.java:275),android.os.Handler.handleCallback(Handler.java:587),android.os.Handler.dispatchMessage(Handler.java:92),android.os.Looper.loop(Looper.java:150),android.app.ActivityThread.main(ActivityThread.java:4263),java.lang.reflect.Method.invokeNative(Native Method),java.lang.reflect.Method.invoke(Method.java:507),com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839),com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597),dalvik.system.NativeStart.main(Native Method)] 
```

对此的任何想法都会非常有帮助。我已经花了很多时间来解决这个问题。

谢谢

阿普尔瓦

# google-closure - 为什么覆盖“goog.ui.Control.handleMouseOver()”不做任何事情？

> ID：12127885
> 
> 赞同：1
> 
> 时间：2012-08-26T05:42:31.383
> 
> 标签：google-closure, google-closure-library

`goog.ui.Button`当用户将鼠标悬停在按钮上时，我正在尝试将一个类添加到子类的实例中。

为此，我覆盖了`handleMouseOver`：

```
/**
 * Handles mouseover events.
 * @param {goog.events.BrowserEvent} e Mouse event to handle.
 * @override
 */
myapp.ui.Button.prototype.handleMouseOver = function(e) {
  goog.base(this, 'handleMouseOver', e);
  goog.dom.classes.add(this.getElement(), 'button-hover-state');
}; 
```

但是，当我将鼠标悬停在按钮上时，“按钮悬停状态”类不会添加到按钮中。为什么不？Chrome 控制台没有发出任何错误或警告。

我可以监听一个事件并做出响应而不是覆盖`handleMouseOver`，但是不应该覆盖这个函数来改变鼠标进入元素时会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T16:53:12.540

您的方法`myapp.ui.Button.prototype.handleMouseOver`不执行任何操作的原因是没有调度鼠标事件。

使用的默认渲染器`goog.ui.Button`是`goog.ui.NativeButtonRenderer`. 该方法`goog.ui.NativeButtonRenderer.prototype.createDom`调用`goog.ui.NativeButtonRenderer.prototype.setUpNativeButton_`，而后者又调用：

```
button.setHandleMouseEvents(false); 
```

您可以使用几种方法来启用鼠标事件。

# 使用默认按钮渲染器并覆盖`goog.ui.Component.prototype.render`

```
/**
 * Renders the button.
 *
 * @param {Element=} opt_parentElement Optional parent element to render the
 *    component into.
 * @override
 */
myapp.ui.Button.prototype.render = function(opt_parentElement) {
  goog.base(this, 'render', opt_parentElement);
  this.setHandleMouseEvents(true);
}; 
```

# 使用不同的默认渲染器，例如`goog.ui.ButtonRenderer`

```
/**
 * My custom button.
 *
 * @param {goog.ui.ControlContent} content Text caption or existing DOM
 *     structure to display as the button's caption.
 * @param {goog.ui.ButtonRenderer=} opt_renderer Renderer used to render or
 *     decorate the button; defaults to {@link goog.ui.NativeButtonRenderer}.
 * @param {goog.dom.DomHelper=} opt_domHelper Optional DOM hepler, used for
 *     document interaction.
 * @constructor
 */
myapp.ui.Button = function(content, opt_renderer, opt_domHelper) {
  goog.base(this, content,
      opt_renderer || goog.ui.ButtonRenderer.getInstance(), opt_domHelper);
};
goog.inherits(myapp.ui.Button, goog.ui.Button); 
```

使用时，当鼠标悬停在按钮上时`goog.ui.ButtonRenderer`，CSS 类会自动添加到按钮中，当鼠标离开按钮时，CSS 类会被移除。`goog-button-hover`

# apache - 使用 nutch 和 solr 在每个页面中获取特定标题

> ID：12127890
> 
> 赞同：0
> 
> 时间：2012-08-26T05:43:56.730
> 
> 标签：apache, solr, lucene, nutch, dismax

我安装了 solr 和 nutch，我的网页结构是每个页面的标题都是相同的；例如银行的东西；但在每个页面中都有一个 ID 为 TITLE 的标签，例如：

```
<div ID="TITLE"><h1>my page specific title</h1></div> 
```

我想向 solr 添加另一个字段，例如第二个标题，它可以获取我的页面特定标题并在其中搜索字词。（实际上，现在我的页面特定标题在内容字段中，我想在其他字段中使用它）

我怎样才能做到这一点？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T11:46:11.280

检查[Nutch 插件](https://issues.apache.org/jira/browse/NUTCH-978)，它应该允许您从网页中提取元素。

# c# - C#中需要帮助需要实现动图框

> ID：12127894
> 
> 赞同：0
> 
> 时间：2012-08-26T05:45:35.507
> 
> 标签：c#, multithreading

我需要这方面的帮助，

> 有 3 个图片框，红色应该向左增加它的宽度，绿色应该把它的高度增加到顶部蓝色的宽度向右
> 
> 同样，如果到达顶部边框/任何文本框，它应该给出错误/停止执行
> 
> 我将来需要添加更多图片框，如果其中两个发生碰撞，它应该会出错/停止执行。我设法将它们编码为上升，但无法使其他功能正常工作。请有人帮我解决这个问题。

或者

[https://www.box.com/s/d0d302c6c266f52e0abf](https://www.box.com/s/d0d302c6c266f52e0abf)

谢谢你。RR

我的代码如下，

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading;

namespace ThreadwithmovingPicbxmoving
{
    public partial class Form1 : Form
    {
        Thread t1;
        Thread t2;
        Thread t3;

        delegate void CTMethod(int val);
        delegate void CTFinish(string t);
        Queue<string> order = new Queue<string>();

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            int r = int.Parse(textBox1.Text);
            int y = int.Parse(textBox2.Text);
            int g = int.Parse(textBox3.Text);

            t1 = new Thread(new ParameterizedThreadStart(loopred));
            t2 = new Thread(new ParameterizedThreadStart(loopyel));
            t3 = new Thread(new ParameterizedThreadStart(loopGree));

            t1.Start(r);
            t2.Start(y);
            t3.Start(g);

        }
        private void updateRed(int val)
        {
            pictureBox1.Height = val;
            pictureBox1.Refresh();
        }

        private void updateyell(int val)
        {
            pictureBox2.Height = val;
            pictureBox2.Refresh();
        }
        private void updategree(int val)
        {
            pictureBox3.Height = val;
            pictureBox3.Refresh();

        }

        private void loopred(object o)
        {
            int c = (int)o;
            CTMethod ctred = new CTMethod(updateRed);
            if (c < 500)
            {
                for (int i = 0; i < c; i++)
                {
                    this.Invoke(ctred, i);
                    Thread.Sleep(20);
                }
            }

            else
            {
                MessageBox.Show("Enter a value less than 500 for Red Box!!!");
            }
            CTFinish CTFin = new CTFinish(Threadfinish);
            this.Invoke(CTFin, "Red");
        }

        private void loopyel(object o)
        {
            int c = (int)o;
            CTMethod ctyell = new CTMethod(updateyell);
            if (c < 500)
            {
                for (int i = 0; i < c; i++)
                {
                    this.Invoke(ctyell, i);
                    Thread.Sleep(20);
                }
            }
            else
            {
                MessageBox.Show("Enter a valure less than 500 for Yellow Box!!!");
            }
            CTFinish CTFin = new CTFinish(Threadfinish);
            this.Invoke(CTFin, "Yell");
        }

        private void loopGree(object o)
        {
            int c = (int)o;
            CTMethod ctgree = new CTMethod(updategree);
            if (c < 500)
            {
                for (int i = 0; i < c; i++)
                {
                    this.Invoke(ctgree, i);
                    Thread.Sleep(20);
                }
            }
            else
            {
                MessageBox.Show("Enter a valure less than 500 for Green Box!!!");
            }
            CTFinish CTfin = new CTFinish(Threadfinish);
            this.Invoke(CTfin, "Green");

        }

        private void Threadfinish(string t)
        {
            order.Enqueue(t);
            if (order.Count == 3)
            {

                MessageBox.Show("Threads finished in this order: \n" + "1." + order.Dequeue() + "\n" + "2." + order.Dequeue()
                    + "\n" + "3." + order.Dequeue() + "\n", "finished");

            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T11:02:14.247

试试看。三个图片框都很好

使用名称帮助创建新的寡妇应用程序，然后将 Form1.cs 代码替换为以下

运行。它还包括来自 TextBoxes 的值

```
using System;
using System.Drawing;
using System.Threading;
using System.Windows.Forms;
using System.Collections.Generic;

namespace help
{
public partial class Form1 : Form
{

    Thread t1;
    Thread t2;
    Thread t3;

    delegate void CTMethod(int val);
    delegate void CTFinish(string t);
    Queue<string> order = new Queue<string>();

    #region Variables of Designer File
    private System.Windows.Forms.PictureBox pictureBox1;
    private System.Windows.Forms.PictureBox pictureBox2;
    private System.Windows.Forms.PictureBox pictureBox3;
    private System.Windows.Forms.TextBox textBox1;
    private System.Windows.Forms.TextBox textBox2;
    private System.Windows.Forms.TextBox textBox3;
    private System.Windows.Forms.Button button1;
    #endregion

    public Form1()
    {
        #region Designer Code I have Cut and Pasted Here
        this.pictureBox1 = new System.Windows.Forms.PictureBox();
        this.pictureBox2 = new System.Windows.Forms.PictureBox();
        this.pictureBox3 = new System.Windows.Forms.PictureBox();
        this.textBox1 = new System.Windows.Forms.TextBox();
        this.textBox2 = new System.Windows.Forms.TextBox();
        this.textBox3 = new System.Windows.Forms.TextBox();
        this.button1 = new System.Windows.Forms.Button();
        ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).BeginInit();
        ((System.ComponentModel.ISupportInitialize)(this.pictureBox2)).BeginInit();
        ((System.ComponentModel.ISupportInitialize)(this.pictureBox3)).BeginInit();
        this.SuspendLayout();
        this.Controls.Add(this.button1);
        this.Controls.Add(this.textBox3);
        this.Controls.Add(this.textBox2);
        this.Controls.Add(this.textBox1);
        this.Controls.Add(this.pictureBox3);
        this.Controls.Add(this.pictureBox2);
        this.Controls.Add(this.pictureBox1);

        // 
        // pictureBox1
        // 
        this.pictureBox1.BackColor = System.Drawing.Color.Red;
        this.pictureBox1.Location = new System.Drawing.Point(161, 268);
        this.pictureBox1.Name = "pictureBox1";
        this.pictureBox1.Size = new System.Drawing.Size(100, 50);
        this.pictureBox1.TabIndex = 0;
        this.pictureBox1.TabStop = false;
        // 
        // pictureBox2
        // 
        this.pictureBox2.BackColor = System.Drawing.Color.Green;
        this.pictureBox2.Location = new System.Drawing.Point(383, 268);
        this.pictureBox2.Name = "pictureBox2";
        this.pictureBox2.Size = new System.Drawing.Size(100, 50);
        this.pictureBox2.TabIndex = 1;
        this.pictureBox2.TabStop = false;
        // 
        // pictureBox3
        // 
        this.pictureBox3.BackColor = System.Drawing.Color.Blue;
        this.pictureBox3.Location = new System.Drawing.Point(605, 268);
        this.pictureBox3.Name = "pictureBox3";
        this.pictureBox3.Size = new System.Drawing.Size(100, 50);
        this.pictureBox3.TabIndex = 2;
        this.pictureBox3.TabStop = false;
        // 
        // textBox1
        // 
        this.textBox1.Location = new System.Drawing.Point(161, 26);
        this.textBox1.Name = "textBox1";
        this.textBox1.Size = new System.Drawing.Size(100, 20);
        this.textBox1.TabIndex = 3;
        // 
        // textBox2
        // 
        this.textBox2.Location = new System.Drawing.Point(383, 25);
        this.textBox2.Name = "textBox2";
        this.textBox2.Size = new System.Drawing.Size(100, 20);
        this.textBox2.TabIndex = 4;
        // 
        // textBox3
        // 
        this.textBox3.Location = new System.Drawing.Point(605, 26);
        this.textBox3.Name = "textBox3";
        this.textBox3.Size = new System.Drawing.Size(100, 20);
        this.textBox3.TabIndex = 5;
        // 
        // button1
        // 
        this.button1.Location = new System.Drawing.Point(37, 23);
        this.button1.Name = "button1";
        this.button1.Size = new System.Drawing.Size(75, 23);
        this.button1.TabIndex = 6;
        this.button1.Text = "Go";
        this.button1.UseVisualStyleBackColor = true;
        this.button1.Click += new System.EventHandler(this.button1_Click);
        this.PerformLayout();
        #endregion

        InitializeComponent();

        textBox1.Text = "490";
        textBox2.Text = "490";
        textBox3.Text = "490";

        textBox1.Leave += new EventHandler(textBox1_Leave);
        textBox2.Leave += new EventHandler(textBox2_Leave);
        textBox3.Leave += new EventHandler(textBox3_Leave);
    }

    // To input Only Valid int values in TextBoxes
    #region TextBoxes Input Validation
    int t1Val = 490;
    int t2Val = 490;
    int t3Val = 490;
    void textBox1_Leave(object sender, EventArgs e)
    {
        try
        {
            int t1Val = Convert.ToInt32(textBox1.Text);
        }
        catch
        {
            textBox1.Focus();
        }
    }
    void textBox2_Leave(object sender, EventArgs e)
    {
        try
        {
            int t2Val = Convert.ToInt32(textBox2.Text);
        }
        catch
        {
            textBox2.Focus();
        }
    }
    void textBox3_Leave(object sender, EventArgs e)
    {
        try
        {
            int t3Val = Convert.ToInt32(textBox3.Text);
        }
        catch
        {
            textBox3.Focus();
        }
    }
    #endregion

    private void button1_Click(object sender, EventArgs e)
    {
        int r = t1Val;
        int y = t2Val;
        int g = t3Val;

        t1 = new Thread(new ParameterizedThreadStart(loopRed));
        t2 = new Thread(new ParameterizedThreadStart(loopGreen));
        t3 = new Thread(new ParameterizedThreadStart(loopBlue));

        // It will avoid proble if you exit app when threads are working
        t1.IsBackground = true;
        t2.IsBackground = true;
        t3.IsBackground = true;

        t1.Start(r);
        t2.Start(y);
        t3.Start(g);

    }
    private void updateRed(int val)
    {
        pictureBox1.Width++;
        pictureBox1.Left--;
        pictureBox1.Refresh();
    }

    private void updateGreen(int val)
    {
        pictureBox2.Height++;
        pictureBox2.Top--;
        pictureBox2.Refresh();
    }
    private void updateBlue(int val)
    {
        pictureBox3.Width++;
        pictureBox3.Refresh();
    }

    private void loopRed(object o)
    {
        int c = (int)o;
        CTMethod ctRed = new CTMethod(updateRed);
        if (c < 500)
        {
            for (int i = 0; i < c; i++)
            {
                if (pictureBox1.Left > 0)
                {
                    this.Invoke(ctRed, i);
                    Thread.Sleep(20);
                }
            }
        }

        else
        {
            MessageBox.Show("Enter a value less than 500 for Red Box!!!");
        }
        CTFinish CTFin = new CTFinish(Threadfinish);
        this.Invoke(CTFin, "Red");
    }

    private void loopGreen(object o)
    {
        int c = (int)o;
        CTMethod ctGreen = new CTMethod(updateGreen);
        if (c < 500)
        {
            for (int i = 0; i < c; i++)
            {                    
                if (pictureBox2.Top > 0 && pictureBox2.Top != textBox2.Top + textBox2.Height)
                {
                    this.Invoke(ctGreen, i);
                    Thread.Sleep(20);
                }
                else
                    break;
            }
        }
        else
        {
            MessageBox.Show("Enter a valure less than 500 for Green Box!!!");
        }
        CTFinish CTFin = new CTFinish(Threadfinish);
        this.Invoke(CTFin, "Green");
    }

    private void loopBlue(object o)
    {
        int c = (int)o;
        CTMethod ctBlue = new CTMethod(updateBlue);
        if (c < 500)
        {
            for (int i = 0; i < c; i++)
            {
                if (pictureBox3.Left + pictureBox3.Width < this.Width)
                {
                    this.Invoke(ctBlue, i);
                    Thread.Sleep(20);
                }
                else
                    break;
            }
        }
        else
        {
            MessageBox.Show("Enter a valure less than 500 for Blue Box!!!");
        }
        CTFinish CTfin = new CTFinish(Threadfinish);
        this.Invoke(CTfin, "Blue");

    }

    private void Threadfinish(string t)
    {
        order.Enqueue(t);
        if (order.Count == 3)
        {

            MessageBox.Show("Threads finished in this order: \n" + "1." + order.Dequeue() + "\n" + "2." + order.Dequeue()
                + "\n" + "3." + order.Dequeue() + "\n", "finished");

        }
    }

}
} 
```

# android - 使用白色背景色配置Android Activity全屏

> ID：12127896
> 
> 赞同：0
> 
> 时间：2012-08-26T05:45:50.260
> 
> 标签：android, android-theme

我对 Android 应用程序开发非常陌生。我希望我的第一个活动以白色背景全屏显示。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T05:46:35.953

在 Android Manifest 文件中将以下属性添加到您的 Activity

```
android:theme="@android:style/Theme.Light.NoTitleBar.Fullscreen" 
```

# django - 没有自定义表单的 Django 模型字段验证

> ID：12127900
> 
> 赞同：15
> 
> 时间：2012-08-26T05:46:30.747
> 
> 标签：django, django-models

我在我的模型中使用 django DateField。

```
class CalWeek(models.Model):
  start_monday = models.DateField(verbose_name="Start monday") 
```

我有一个特定于我的 modelField 的自定义验证方法：我想确保它实际上是星期一。我目前没有理由在管理员中使用自定义 ModelForm —— Django 生成的那个很好。创建一个自定义表单类，以便我可以利用 django Form 类提供的`clean_start_monday(self)`[1 个](https://docs.djangoproject.com/en/dev/ref/models/instances/#django.db.models.Model.clean)糖，这似乎需要做很多工作来添加一些字段验证。我意识到我可以[覆盖模型的 clean 方法](https://docs.djangoproject.com/en/dev/ref/models/instances/#django.db.models.Model.clean)并在那里提出一个`ValidationError`。然而，这并不理想：这些错误被归为非字段错误并最终出现在页面顶部，而不是出现在有问题的用户输入旁边——这不是理想的用户体验。

是否有一种简单的方法来验证特定模型字段并将错误消息显示在管理员字段旁边，而无需使用自定义表单类？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-26T05:59:13.637

您可以查看 Django Validators。

[https://docs.djangoproject.com/en/dev/ref/validators/](https://docs.djangoproject.com/en/dev/ref/validators/)

您可以将验证器放在类之前，然后在字段中设置验证器。

```
def validate_monday(date):
    if date.weekday() != 0:
        raise ValidationError("Please select a Monday.")

class CalWeek(models.Model):
    start_date = models.DateField(validators=[validate_monday]) 
```

# php - yii框架，union sql如何实现

> ID：12127908
> 
> 赞同：0
> 
> 时间：2012-08-26T05:48:17.690
> 
> 标签：php, yii

我正在尝试在 yii actionAdmin() 上做这样的事情

```
select * from car where carbrand = 'bmw' limit 1
union
select * from car where carbrand = 'mercedez' 
```

我在 CDbCriteria 上找不到与 union 有任何关系

还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T07:36:59.397

您可以尝试将标准与另一个标准合并 [http://www.yiiframework.com/doc/api/1.1/CDbCriteria#mergeWith-detail](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#mergeWith-detail) 或者您可以使用 DAO 和 CDbCommand [http://www.yiiframework.com/doc/api /1.1/CDbCommand#union-detail](http://www.yiiframework.com/doc/api/1.1/CDbCommand#union-detail)。

# jquery - 如何为 HTML 表格列提供方程式，类似于 Excel 电子表格？

> ID：12127913
> 
> 赞同：1
> 
> 时间：2012-08-26T05:49:43.407
> 
> 标签：jquery, html, excel, html-table

在此处查看站点和代码：http: [//jonathonmoore.com/sandbox/single.html](http://jonathonmoore.com/sandbox/single.html)

我正在创建一个网站，基本上可以让用户每两周、每月和每年查看一次他们的财务状况。我有一个有四列的大表：

![在此处输入图像描述](../Images/67c8009b93c6b3fa09ee74ce1a2b8e75.png)

现在，我通过给每个单元格一个唯一的 ID（#bwSalary、#monSalary、#annSalary 等）、进行数学运算并替换文本来强制表中的值。

这很乱。该页面的另一部分允许用户在表中添加和删除行，并输入他们的各种费用。我不能为每个人生成唯一的 ID。一定有更好的方法。

所以我的问题是，是否有办法使用 jQuery 为每一列分配一个方程——类似于你在 Excel 中可以做的事情。我的设想是计算每一行的年度贡献（可能使用唯一的 ID），然后 jQuery 将遍历每一行并通过仅获取年度列单元格中的值并将其除以填充双周和每月行12 或 26。有意义吗？

我知道有办法做到这一点，我只是不太了解 jQuery，无法知道如何找到我需要的正确单元格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:29:13.810

实现第二个表的一种简单方法是使用原始 JQuery 并通过仅以编程方式查找同一行中的其他输入框来避免硬编码 ID。这里有一些 Coffeescript 来说明：

```
# whenever the user finishes entering a value and clicks away
$('table input').on 'blur', ->
  # find all three input boxes in this row
  [biweekly, monthly, annual] = $(this).parents('tr').find('input')
  # update the first two in terms of the third
  $(biweekly).val($(annual).val() / 52 * 2)
  $(monthly).val($(annual).val() / 12) 
```

如果您的应用程序要变得更复杂（或者如果您只是感兴趣），您可能需要研究*响应式编程*系统，例如[tangle](http://worrydream.com/Tangle/)、[angular](http://www.angularjs.org/)、[ember](http://emberjs.com/)等。就像 Excel 一样，它们会让您*声明*值某事物的某种表达（即公式）是另一事物的某种表达（即公式），并且系统将确保每当某事物发生变化时，所有依赖绑定也随之更新。

# php - PHP定义一个类只允许被另一个类实例化

> ID：12127917
> 
> 赞同：2
> 
> 时间：2012-08-26T05:50:56.053
> 
> 标签：php, oop, inheritance

PHP中有没有办法让一个类只允许由另一个类实例化？例如：

```
<?php 
    class Graph {
        private $nodes;

        public function __construct() {
            $this->nodes = array();
        }

        public function add_node() {
            $this->nodes[] = new Node();
        }
    }

    class Node {
        public function __construct() {
        }
    }
?> 
```

在我的示例中，我想阻止`new Node()`直接调用。只能`Node`从`Graph`班级访问。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T05:57:07.297

不，你不能这样做。如果传递给它的参数不是图形，您可以使用“hack”，其中包括在 Node 构造函数中引发异常

```
class Node {
    public function __construct() {
        if(func_get_num_args() < 1 && !(func_get_args(0)instanceof Graph)){
           throw BadCallException('You can\'t call Node outside a Graph');
        } 
    }
} 
```

# asp.net-mvc-3 - 用于检索的 Dapper 和用于 CRUD 的 NHibernate 是否适用于 Web 应用程序

> ID：12127923
> 
> 赞同：3
> 
> 时间：2012-08-26T05:52:09.127
> 
> 标签：asp.net-mvc-3, nhibernate, dapper

我计划使用“Dapper”进行检索，使用“NHibernate”进行 CRUD 操作。那么，遵循这种方法是否是一个好的设计。我最近遇到的问题之一是 CRUD Screens。

假设我有编辑订单表格。我正在从 Dapper 检索实体（订单），并在更新它时需要将这些对象附加到 NHibernate 会话以执行 CRUD 操作。它不是直接需要的，我的意思是 object.delete()。

任何人都可以提供有关此设计的建议，是否有可能使其变得更好。它是使用 asp.net mvc 3 开发的 Web 应用程序。

* * *

## 关于回复的问题：

1.  操作上的会话过滤器是否意味着我们用于当前操作的内容。如果是这样，对于 GET 操作，应该是 [DapperSession] 而不是 [NHSession]？

    [NHSession] <<--------[DapperSession] 获取操作结果

    *   DapperSession.Get.Entity(1000)
    *   返回视图
2.  我仍在尝试了解您发布的 PRG 模式，如果我有任何疑问，我会发布。

3.  由于所有这些都发生在“编辑”操作中，明智的做法是也使用 NHibernate 获取对象。这以很少的开销成本摆脱了所有这些过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T09:46:28.743

乍一看，这似乎是一个合乎逻辑的选择，将 Dapper（或其他微型 ORM）用于 GET 并将 NHibernate 用于控制器上的任何 POST 操作方法。见伪代码）： -

```
[DapperSession]
GET ACTION RESULT
  - DapperSession.Get.Entity(1000)
  - Return view 
```

对于 post 方法

```
[NHSession, DapperSession]
POST ACTION RESULT
  If Model.State is valid
    - entity = NHSession.Get.Entity(1000)
    - update entity
    - redirect to ...
  end if

 - DapperSession.Get.Entity(1000)
 - return view 
```

如您所见，这并不是那么优雅，因为您可能需要对 POST 操作结果使用不同的操作过滤器。为了解决这个问题，您可以使用 Post Redirect Get (PRG) 模式，因此 GET 控制器使用 Dapper，而 POST 控制器只能访问 NHSessions。

有关如何设置此模式的详细信息，请参阅[SO 上接受的答案。](https://stackoverflow.com/questions/7940939/mvc3-model-validation-best-practice-redirect-after-post-state-change)

现在您的 GET 和 POST 操作结果将如下所示：-

```
[DapperSession, ImportModelStateFromTempData]
GET ACTION RESULT
  - DapperSession.Get.Entity(1000)
  - Return view 
```

对于 post 方法

```
[NHSession, ExportModelStateToTempData]
POST ACTION RESULT
  If Model.State is valid
    - entity = NHSession.Get.Entity(1000)
    - update entity
    - redirect to ...
  end if

 - return redirect to GET 
```

但是，正如您所看到的，我真正在做的只是用一个动作过滤器属性替换另一个动作过滤器属性。但是（这是一个很大的问题，但在我看来）你确实得到了使用 PRG 模式的好处！老实说，这可能并不能直接回答我们的问题，但这是一个很好的方法。

# python - 为什么这个 Python Borg / Singleton 模式有效

> ID：12127925
> 
> 赞同：2
> 
> 时间：2012-08-26T05:52:56.333
> 
> 标签：python, singleton

我只是在网上偶然发现这些有趣的代码被剪掉了：

[http://code.activestate.com/recipes/66531/](http://code.activestate.com/recipes/66531/)

```
class Borg:
    __shared_state = {}
    def __init__(self):
        self.__dict__ = self.__shared_state
    # and whatever else you want in your class -- that's all! 
```

我了解单例是什么，但我不明白特定的代码被剪断了。你能解释一下“__shared_state”是如何/在哪里改变的吗？

我在 ipython 中尝试过：

```
In [1]: class Borg:
   ...:         __shared_state = {}
   ...:     def __init__(self):
   ...:             self.__dict__ = self.__shared_state
   ...:     # and whatever else you want in your class -- that's all!
   ...: 
In [2]: b1 = Borg()
In [3]: b2 = Borg()
In [4]: b1.foo="123"
In [5]: b2.foo
Out[5]: '123'
In [6]: 
```

但不能完全理解这是怎么发生的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-26T05:58:00.887

因为~~类的~~实例`__dict__`被设置为等于`__share_state`字典。它们指向*同一个对象*。（`Classname.__dict__`包含所有类属性）

当你这样做时：

```
b1.foo = "123" 
```

您正在修改`dict`两者`b1.__dict__`并`Borg.__shared_state`参考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-26T06:03:15.903

该`__init__`方法在实例化任何对象后调用，将`__dict__`新创建的对象的属性替换为类属性`__shared_state`。

`a.__dict__`,都是同一个对象`b.__dict__`。`Borg._Borg__shared_state`请注意，`_Borg`当从类外部访问私有属性时，我们必须添加隐式前缀。

```
In [89]: a.__dict__ is b.__dict__ is Borg._Borg__shared_state
Out[89]: True 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-26T06:08:53.853

实例是单独的对象，但是通过将它们的`__dict__`属性设置为相同的值，实例具有*相同*的属性字典。Python 使用属性字典来存储对象上的所有属性，因此实际上这两个实例的行为方式相同，因为对其属性的每次更改都是对共享属性字典进行的。

However, the objects will still compare unequal if using `is` to test equality (shallow equality), since they are still distinct instances (much like individual Borg drones, which share their thoughts but are physically distinct).

# rest - REST：为什么 URI 作为数据容器？

> ID：12127926
> 
> 赞同：1
> 
> 时间：2012-08-26T05:53:26.197
> 
> 标签：rest, uri

我应该为应用程序制作 Web 服务，并认为我可以很好地实践良好的实践。我发现它使用的是 REST。但有一件事在其中毫无意义。

**为什么使用 URI 来传递任何变量？**

我们在上一个项目中所做的是仅使用 POST 并将任何内容作为原始 POST 数据（即 JSON）传递。这不是很 RESTful。但它有一些优点。这在客户端非常简单——我有一个通用函数，它将 URI 和数据作为参数，然后将其包装并发送。

现在，如果我使用正确的 REST，我将不得不将一些数据作为 URI 的一部分（例如，用户 ID）传递。我猜所有其他数据（用户名、电子邮件等）都必须像我们一样作为原始数据。这意味着我必须在某个时候将用户 ID 和其他数据分开。这还不错，但仍然 - 为什么？

**编辑** 这是一个更详细的例子：

假设您要访问 (GET) 和更新 (POST) 用户数据。您可能在*/user*下可以访问一个服务，但 RESTful 服务会接受用户 ID 作为 URI ( */user/1234* ) 的一部分。所有其他数据（姓名、电子邮件等）都将用于请求内容（可能是 JSON）。

我提出的是，将用户 ID 放在 URI 中似乎没用。如果您想更新用户数据 - 无论如何您都会将附加数据作为内容发送。如果您想访问它 - 您可以使用相同的通用方法来请求 Web 服务。

我知道 GET 会被浏览器缓存，但我相信如果您使用 AJAX（网络）或任何 HTTP 客户端库（其他平台），无论如何您都必须手动缓存它。

从可扩展性的角度来看 - 您始终可以添加更多服务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T06:07:04.063

您使用 URI 来识别要使用的资源（用户/文档/网页），并在请求中传递相关数据。

**它的优点是 Web 基础架构组件可以在不**知道您的内容是如何表示的情况下找出资源的位置。例如，您可以使用标准缓存和负载均衡器，它们只需要知道 URL 和标头（它们总是以相同的方式表示）是否使用 JSON、protobuf 或 WAV 音频与您的资源进行通信是无关紧要的。

例如，这将让您将不同的资源保存在完全不同的位置，如果您将其全部作为内容发送，您将无法将资源放置在完全不同的位置，例如**http://cloud.google .com/resource1**和**http://cloud.amazon.com/resource2**。

**所有这些都将允许您进行大规模扩展，如果您将其全部放在http://my.url.com/rest**上并将所有资源信息作为内容传递，您将无法做到这一点。

**回复：您的编辑**

在 URL 中传递**用户 ID**是识别单个资源（用户）的唯一方法。请记住，资源是用户，而不是“用户存储”。

例如，缓存**http://my.url/user**的缓存不会很好，因为它会为每个用户返回相同的缓存页面。如果缓存可以与**http://my.url/user/4711 一起使用**，它可以单独缓存每个用户。同样，负载均衡器可以知道用户 1-5000 由一台机器处理，5001-10000 由另一台机器处理，等等，并仅根据 URL 做出智能决策。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T00:42:58.037

将 RESTful Web 服务想象为数据库。要获取或修改特定对象，您需要通过提供其主键来识别它。您通过他的 ID 来识别用户，而不是他的姓名+昵称+电子邮件+母亲的娘家姓。标识一个对象或选择一组对象的信息转到 URL。修改对象的信息应该发布到相应的 URL。

# symfony - 如何设置我自己的参数和配置 symfony2

> ID：12127927
> 
> 赞同：1
> 
> 时间：2012-08-26T05:55:14.807
> 
> 标签：symfony, parameters

我想在我的 symfony 项目中使用我自己的 parametes.ini 文件。
有人知道吗？
我知道这个文件

```
#app/config/parameters.ini 
```

但我不想包括我自己的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:59:30.310

在你`app/config/config.yml`那里有几行：

```
imports:
    - { resource: parameters.yml }
    - { resource: security.yml } 
```

只需在此处添加您的文件。

```
imports:
    ...
    - { resource: your_custom_file.yml } 
```

您的自定义文件应位于`app/config`目录中。如果您想从 Bundle 中包含文件 - 您可以通过以下方式导入它：

```
imports:
    ...
    - { resource: "@YourBundle/Resources/config/your_custom_file.yml" } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T06:35:13.067

`parameters.ini`在 VCS 中应忽略该文件。相反，将其复制到`parameters.ini.dist`VCS 控件并将其置于 VCS 控件之下。`parameters.ini.dist`然后，在开发时，每个开发人员根据`parameters.ini`自己的需要复制和更改参数。

# macos - 基于视图的 NSBrowser？

> ID：12127928
> 
> 赞同：3
> 
> 时间：2012-08-26T05:55:44.570
> 
> 标签：macos, nstableview, nsoutlineview, appkit, nsbrowser

现在我们已经有了`NSTableView`并且`NSOutlineView`可以将常规`NSView`对象作为它们的单元格，那么`NSBrowser`呢？那就是我们可以使用常规`NSView`对象作为 NSBrowser 中的单元格吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T07:21:49.640

**简短的回答：**不，还没有

`NSOutlineView`是一个子类，`NSTableView`所以他们都得到了升级，以便能够`NSView`在 Mac OS X 10.7 中将对象用作单元格。这在文档的开头特别提到`NSTableView`：

> 表格视图显示在滚动视图中。从 OS X v 10.7 开始，行和列支持 NSView 实例（最常见的是 NSTableCellView 实例或子类）。或者，NSCell 子类实例可用于每个行和列项。

另一方面，对于 NSBrowser，它特别说：

> 这个类使用 NSBrowserCell 类来实现它的用户界面。

# android - ASyncTask 并从一个返回字符串数组值

> ID：12127931
> 
> 赞同：1
> 
> 时间：2012-08-26T05:56:05.923
> 
> 标签：android, arraylist, android-asynctask, return, arrays

您好我正在尝试创建一个 ASyncTask，它将在后台解析来自 XML 文件的数据，然后在 ListView 中显示该字符串数组数据。到目前为止，我不明白我做错了什么，或者如何将字符串数组值返回到我的 GUI。这是我到目前为止所拥有的代码，如果您需要其他任何内容，请告诉我。感谢您寻找并提供任何建议或地方以了解更多信息。

```
package com.lvlup.kikurself.scotttest;

import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import android.app.ListActivity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.Toast;
import java.io.IOException;
import org.xml.sax.SAXException;

//import com.lvlup.kikurself.scotttest.WikiParser.Cm;

public class scottPlayers extends ListActivity {

public class PlayerGet extends AsyncTask<Void, Void, Void>{

@Override
protected void onPostExecute(Void result){

WikiParser p = new WikiParser();
ArrayList<String> titles = new ArrayList<String>();

try {
    p.parseInto(new URL("http://scottlandminecraft.wikia.com/api.php?action=query&list=categorymembers&cmtitle=Category:Players&cmlimit=500&format=xml"), titles);

} catch (MalformedURLException e) {
} catch (IOException e) {
} catch (SAXException e) {}

    //String[] values = new String[50]; 
    //values = res;

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(scottPlayers.this, R.layout.main, titles);

    setListAdapter(adapter);

    //final ListView playersList = getListView();

    /*playersList.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View v, int position, long thisID)
    {
         Object o = (playersList.getItemAtPosition(position));
         String playerName_temp = (o.toString());

         Intent newIntent = new Intent(v.getContext(), playerDisp.class);
         newIntent.putExtra("tempN", playerName_temp);
         startActivity(newIntent);

    }
    });*/

}

 @Override
 protected void onPreExecute() {
  // TODO Auto-generated method stub
  Toast.makeText(scottPlayers.this,
    "onPreExecute \n: preload bitmap in AsyncTask",
    Toast.LENGTH_LONG).show();
 }

 @Override
 protected Void doInBackground(Void... params) {
  // TODO Auto-generated method stub

  return null;
 }

}

@Override
public void onCreate(Bundle icicle) {
 super.onCreate(icicle);

 setContentView(R.layout.main);

 new PlayerGet().execute();
}

    //get your data back again with: String fName = getIntent().getExtras().getInt("fname");

} 
```

编辑：我在查看其他示例后添加了新代码，这是我想出的，但现在当我在模拟器中运行它时，它只显示我的 Main.xml 的背景，列表不会填充，如果我导入这个在我运行 ICS 的手机上，它说出现错误并强制关闭......由于某种原因，我无法在模拟器中发生这种情况，并且模拟器的 LogCat 中没有错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T06:46:15.827

```
public class scottPlayers extends ListActivity {

    private ArrayAdapter<String> mAdapter;

    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);

        mAdapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_1, new ArrayList<String>());

        setListAdapter(mAdapter);

        new PlayerGet().execute();
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {
        Object o = l.getItemAtPosition(position);
        String playerName_temp = o.toString();

        Intent newIntent = new Intent(v.getContext(), playerDisp.class);
        newIntent.putExtra("tempN", playerName_temp);
        startActivity(newIntent);
    }

    private class PlayerGet extends AsyncTask<Void, Void, ArrayList<String>> {

        WikiParser p = new WikiParser();
        ArrayList<String> titles = new ArrayList<String>();

        @Override
        protected ArrayList<String> doInBackground(Void... urls) {
            try {
                p.parseInto(new URL("http://scottlandminecraft.wikia.com/api.php?action=query&list=categorymembers&cmtitle=Category:Players&cmlimit=500&format=xml"), titles);
            } catch (MalformedURLException e) {
            } catch (IOException e) {
            } catch (SAXException e) {}
            return titles;
        }

        @Override
        protected void onPostExecute(ArrayList<String> result) {
            for (String item : result) {
                mAdapter.add(item);
            }
        }
    }
} 
```

要更改的代码太多，请阅读[AsyncTask 文档](http://developer.android.com/reference/android/os/AsyncTask.html)。特别是[execute()](http://developer.android.com/reference/android/os/AsyncTask.html#execute%28Params...%29)和[onPostExecute()](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T06:31:30.560

在寻求帮助之前，请养成阅读文档的习惯。您需要的一切都[在这里](http://developer.android.com/reference/android/os/AsyncTask.html)。

具体来说，您需要在 PlayerGet 类中实现 onPostExecute。它将在后台任务完成时调用，并将 ArrayList 作为回调的参数返回给您。

还有一些有用的提示。始终遵循标准的 Java 命名约定。你的类名“scottPlayers”应该以大写字母开头。除非绝对必要，否则请尽量避免使用 Object。类型转换和类型检查将在以后为您节省一个痛苦的世界。

# javascript - JavaScript 代码的语法错误

> ID：12127932
> 
> 赞同：0
> 
> 时间：2012-08-26T05:56:11.157
> 
> 标签：javascript, javascript-events

```
document.getElementById("but").onclick = function(e) {
showDropDown(this, e);
};

function showDropDown(element, e) {
element.onclick = function() {};
if (e.stopPropagation) e.stopPropagation(); // W3C model
else e.cancelBubble = true; // IE model
document.getElementById("window").style.display = "inline-block";
document.onclick = function(e) {
    var ele = document.elementFromPoint(e.clientX, e.clientY);
    if (ele == element) {
        hideDropDown();
        return;
    }
    do {
        if (ele == document.getElementById("window")) return;
    } while (ele = ele.parentNode);
    hideDropDown(element);
};
}

function hideDropDown(element) {
document.onclick = function() {};
document.getElementById("window").style.display = "none";
element.onclick = function(e) {
    showDropDown(this, e);
};
}​

   <input id="but" type="button" value="pressMe" />
   <div id="window" style="display:none">popup</div>​ 
```

错误：[https ://www.dropbox.com/s/uzeiq6043rvueqf/Capture.PNG](https://www.dropbox.com/s/uzeiq6043rvueqf/Capture.PNG) [https://www.dropbox.com/s/w3rct18cumwva7m/bar3.png](https://www.dropbox.com/s/w3rct18cumwva7m/bar3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:01:03.743

您有错误，因为您的文档未加载。
将您的代码放入`window.onload`：

```
window.onload=function(){
  //code
} 
```

或者如果您使用的是 jquery：

```
$(document).ready(function(){
  //code
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T06:00:30.290

```
document.getElementById("but").onclick = function(e) {
    showDropDown(this, e);
};

function showDropDown(element, e) {
    element.onclick = function() {};
    if (e.stopPropagation) 
        e.stopPropagation(); // W3C model
    else 
        e.cancelBubble = true; // IE model
    document.getElementById("window").style.display = "inline-block";
    document.onclick = function(e) 
    {
        var ele = document.elementFromPoint(e.clientX, e.clientY);
        if (ele == element) {
            hideDropDown();
            return;
        }
        do {
            if (ele == document.getElementById("window")) return;
        } while ((ele = ele.parentNode) !== null);
        hideDropDown(element);
    };
}

function hideDropDown(element){
    document.onclick = function() {};
    document.getElementById("window").style.display = "none";
    element.onclick = function(e) {
        showDropDown(this, e);
    };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T06:07:40.663

您所做的是复制或编写此代码的位置，其中很可能存在错误。[众所周知， JSFiddle](http://www.jsfiddle.com)存在此类问题。您需要做的是在一个简单的编辑器（例如记事本或 TextEdit）中键入该部分代码（错误上方 1 行，错误下方 1 行），然后将其复制并替换您当前的代码。我知道它的这个错误，因为`Unexoected token ILLEGAL`它的一部分意味着放置在那里的隐藏字符显然不符合 JavaScript，因此它根本不是语法错误。

为我工作。

# wpf - 您可以在 ListBox 中的 ListBoxItems 之间插入项目吗？

> ID：12127934
> 
> 赞同：1
> 
> 时间：2012-08-26T05:56:32.277
> 
> 标签：wpf, listbox, controltemplate, listboxitem, separator

简单的问题。我们希望在水平样式列表框中的每个项目之间出现一个分隔线。想想 crumbtrail 中条目之间的箭头。但是，我们不希望该分隔符成为选择的一部分，因此它确实应该位于每个 ListBoxItem 之间。有可能这样做吗？

我能想到的唯一两种方法是将“分隔符”项插入数据中并以不同的方式对它们进行模板化，但这需要对项目集合进行处理，在数据绑定的情况下您可能无法做到这一点。

唯一的另一种方法是将实际 ListBoxItem 设置为在突出显示边框之外有一个分隔符，然后分别模板化列表中的最后一个。

谁能想到其他方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T15:49:16.237

有趣的问题！正如您所说，一种方法是模拟 ItemsSource 集合。如：

```
<ListBox.ItemsSource>
   <MultiBinding Converter="{StaticResource mockConverter}">
     <Binding Path="YourCustomList" />
   </MultiBinding>
</ListBox.ItemsSource> 
```

请注意，我只使用了一个绑定的多重绑定。我相信这是让转换器“重新运行”的正确方法。这样，当您修改“YourCustomList”中的项目时，它将重新触发转换器。

与此不同，它只会触发一次转换器（当 ItemsSource 第一次绑定时）

```
<ListBox ItemsSource="{Binding YourCUstomList, Converter={StaticResource mockCOnverter}}" /> 
```

^ 如果添加新项目将不起作用。（转换器仅在 YourCustomList 属性更改时重新运行）

MockConverter 会很简单，只需确保生成带有分隔符的列表即可。你需要一个新的分隔符类。这样您就可以轻松使用 DataTemplates(DataType)。接下来，您可能必须在 ItemContainerStyle 中设置一个新触发器，以便在 object=Seperator 时设置 IsEnabled=false。

这将是相对无痛的，我没有看到任何并发症。这有点难看，因为分隔符不应该是 ListBoxItems。

**也许这也可以工作。** 您可以使用自己的覆盖 ListBox ItemsPanelTemplate。在您自己的模板中，您可以做任何您想做的事情。也许添加分隔符。这样，您就不会接触 ItemsSource。

查看 StackPanel.cs 的代码。我现在无法为您提供代码，但想法是这样的；您从 StackPanel 继承，并覆盖 Measure() 和 Arrange()。使用这些函数，您可以计算 stackPanel 应该有多大，并提供应该绘制分隔符的位置（X，y）。请注意，分隔符必须是 StackPanel 的子项，并且它们需要 IsHitTestVisible=False（因此它们不会生成事件）。

后来的解决方案需要时间，但是如果您正在学习 WPF，那为什么不呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T15:20:42.267

DataTemplate 很好，我认为您在模拟项目集合时不会遇到问题。你为什么要你？

```
<DataTemplate>
    <StackPanel Orientation="Horizontal">
      <Seperator/>
      <TextBlock Text="{Binding .}"/>
    </StackPanel/>
</DataTemplate> 
```

我不会推荐您使用的最后一个选项。仅仅为了实现你想要的而将它分开是不正确的。

# java - Java 实现一个接口。带有附加功能

> ID：12127936
> 
> 赞同：0
> 
> 时间：2012-08-26T05:56:37.613
> 
> 标签：java, function, implements

您好，我在接口的实现中添加了两个新功能。

这是实现文件...

```
import au.edu.uow.Collection.Album;
import java.util.ArrayList;

public class CDAlbum implements Album {
    private String Title;
    private String Genre;
    private String Artist;
    private String MediaType;
    private ArrayList<String> trackList;

    public CDAlbum(String TempTitle, String TempGenre, String TempArtist, ArrayList<String> TempTracklist, String TempMediaType){
        //Set initail variable values
        Title = TempTitle;
        Genre = TempGenre;
        Artist = TempArtist;
        trackList = TempTracklist;
        MediaType = TempMediaType;
    }
    //Accessor Functions
    public String getMediaType(){
        //Return Media Type
        return MediaType;
    }
    public String getTitle(){
        //Return Title
        return Title;
    }
    public String getGenre(){
        //Return Genre
        return Genre;
    }
    public String getArtist(){
        //Return Artist
        return Artist;
    }
    public ArrayList<String> getTrackList(){
        //Return Tracklist
        return trackList;
    }
} 
```

底部的两个函数是添加的函数（getArtist（），getTrackList（））我遇到的问题是，当我尝试从类文件中调用这些函数时，它会给我以下错误。

```
./au/edu/uow/UserInterface/UserInterface.java:95: cannot find symbol
symbol  : method getArtist()
location: interface au.edu.uow.Collection.Album
            System.out.println(albumCollection.get(number).getArtist());
                                                          ^
./au/edu/uow/UserInterface/UserInterface.java:98: cannot find symbol
symbol  : method getTrackList()
location: interface au.edu.uow.Collection.Album
            ArrayList<String> trackList = albumCollection.get(number).getTrackList(); 
```

当我调用函数时

```
import au.edu.uow.Collection.Album;

System.out.println(albumCollection.get(number).getArtist());

//Access the track titles
ArrayList<String> trackList = albumCollection.get(number).getTrackList();
//Output collection
int arrayListSize = trackList.size();
for(int i = 0; i < arrayListSize; i++)
{
    System.out.println( i + ": " + trackList.get(i));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T06:01:53.557

Album 是 AlbumCollection.get(number) 的返回类型吗？如果是这样，那么您还需要将 getArtist 和 getTrackList 方法添加到您的界面中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T06:18:07.257

`Album`既不指定`getArtist`也不指定`getTrackList`：

```
public interface Album {
    /**
     * This method returns the media type of the album. 
     * @return the media type of the album, either CD or DVD
     * @see #getTitle()
     * @see #getGenre()
     */
     String getMediaType();

    /**
     * This method returns the title of the album. 
     * @return the title of the album
     * @see #getMediaType()
     * @see #getGenre()
     */
     String getTitle();

    /**
     * This method returns the genre of the album. 
     * @return the genre of the album
     * @see #getTitle()
     * @see #getMediaType()
     */
    String getGenre();

} 
```

......只有`CDAlbum`。

您可以通过检查来确定`Album`是 a`CDAlbum`还是 然后，如果它*是*一张 CD，您可以投射到并调用然后。`DVDAlbum``Album.getMediaType`*`CDAlbum``getArtist``getTrackList`*

 *```
for (final Album album : albumCollection) {
  final String type = album.getMediaType();
  System.out.print(type + " album: " + album.getTitle()
      + " (" + album.getGenre() + ") - ");
  if (type.equals("CD")) {
    final CDAlbum cd = (CDAlbum) album;
    System.out.println(cd.getArtist());
    int n = 0;
    for (final String track : cd.getTrackList()) {
      System.out.printf("#%2d - %s\n", ++n, track);
    }
  } else {
    final DVDAlbum dvd = (DVDAlbum) album;
    System.out.println(dvd.getDirector());
    System.out.println(dvd.getPlotOutline());
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-26T06:28:11.547

例如，创建一个超类并从中`MasterAlbums`扩展您的和。将方法&放在超类中。不要在子类中覆盖它。现在当您调用时，它将引用超类方法，您的艺术家和曲目列表将打印。`CDAlbum``DVDAlbum``getArtist()``getTrackList()``System.out.println(albumCollection.get(number).getArtist());`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T05:58:39.823

在接口中添加新方法时，必须在实现类中实现。

检查albumCollection.get(number) 的类型如果albumCollection.get(number) 返回Album 然后你可以调用getArtist()*

# ruby-on-rails - 访问下拉列表选择作为rails中的变量

> ID：12127937
> 
> 赞同：0
> 
> 时间：2012-08-26T05:56:42.917
> 
> 标签：ruby-on-rails, dropdownbox

我的视图中有下拉列表（使用 Select 标签创建）如何在我的 rails 代码中使用用户选择（例如将其传递给方法）以明确：

（这是关于获取某个 facebook 用户拥有的页面）

```
<select name="user_pages" >
<% @accounts.each do |account|%>
    <option value="<%=account['id']%>"><%=account['name']%> </option>
<%end%>     
</select> 
```

我有一个分享按钮，根据用户的选择调用一个方法

```
 <a href=" <%=share_on_page_path(:id=>@querk.id,:index=>@selected) %>" >
 <img alt="" src=<%="/images/fshare.png"%> /></a> 
```

如何将选择结果分配给@selected？或任何其他具有相同结果的事物

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T06:01:08.393

在控制器中，打印出`params`散列的内容。这将为您提供从表单传递的所有值的指示。

# android - 在 Facebook 上发布视频有困难

> ID：12127938
> 
> 赞同：0
> 
> 时间：2012-08-26T05:57:02.367
> 
> 标签：android, facebook

我正在制作一个应用程序，我想在 facebook 上发布视频。当我尝试这样做时，我收到了这个错误：

```
Facebook Error: (#100) Requires extended permission: video_upload or Requires extended permission: publish_actions 
```

这是代码：

```
mUploadButton.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                byte[] data = null;
                AssetFileDescriptor fileDesc = getResources().openRawResourceFd(
                R.raw.movie);
                String dataPath =  fileDesc.toString();
                String dataMsg = "Your video description here.";
                String dataName = "movie.mp4";
                Bundle param;
                AsyncFacebookRunner mAsyncRunner = new AsyncFacebookRunner(mFacebook);
                InputStream is ;
                try 
                {
                    is = fileDesc.createInputStream();

                //    is = new FileInputStream(dataPath);
                    if(is != null)
                    data = readBytes(is);
                    param = new Bundle();
                    param.putString("message", dataMsg);
                    param.putString("filename", dataName);
                    param.putByteArray("video", data);
                    mAsyncRunner.request("me/videos", param, "POST", new SampleRequestListener(), null);
                }
                catch (FileNotFoundException e) {
                   e.printStackTrace();
                }
                catch (IOException e) {
                   e.printStackTrace();
                }       
            }
        }); 
```

请告诉我问题是什么以及如何解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T06:07:18.650

问题包含在错误消息中。我认为这是一个相当明确的错误信息。

在您的应用程序的[身份验证](https://developers.facebook.com/docs/authentication/)流程中，您没有请求用户授予您`video_upload`或[权限](https://developers.facebook.com/docs/authentication/permissions/)`publish_actions`- 这三个中的任何一个都将允许视频上传，但第三个范围更广，会触发身份验证对话框上的第二个页面。`publish_stream`

检查您使用的任何 SDK，看看它是否有一个方便的包装器来在身份验证流中请求额外的权限。在常规 Oauth 流程中，您只需将所需权限列表作为`scope`参数添加到[Oauth 对话框中](https://developers.facebook.com/docs/reference/dialogs/oauth/)

# ruby-on-rails - Rails - 结合多个 has_many throughs

> ID：12127940
> 
> 赞同：3
> 
> 时间：2012-08-26T05:57:12.287
> 
> 标签：ruby-on-rails, activerecord, has-many-through, arel

我刚开始使用 Rails，有一个我自己无法解决的问题：

**用户.rb：**

```
has_many :bid_listings, through: :bids, source: :listing, uniq: true          
has_many :offer_listings, through: :offers, source: :listing, uniq: true 
```

这两个返回列表，以及使用列表模型中的方法/范围都可以完美地工作。但是，当我尝试组合这些时，我得到一个数组，我无法在其中应用列表模型的方法和范围。

我尝试了多种方法，但卡住了。请帮忙。

PS用户有很多出价，用户有很多出价，出价属于listing，offer属于listing

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T11:11:53.920

您在 Array 对象上调用实例方法，而不是在 ActiveRecord 对象上。因此，Array 类型的对象不知道搜索方法是什么。试试这个：

**编辑**

```
user = User.first
listings = Listing.joins(:bids).joins(:offers).where(:bids => {:user_id => user.id}, :offers => {:user_id => user.id})
listings.search('a') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T04:36:40.077

我遇到了类似的问题，我想出的最佳解决方案是：

```
def buying_listings
  Listing.find_by_sql(bid_listings.union(offer_listings).to_sql)
end 
```

这种方式仍应允许您继续确定范围，但效率较低，因为它会执行额外的查询。

# iphone - tableview 不会在手机上更新

> ID：12127944
> 
> 赞同：1
> 
> 时间：2012-08-26T05:57:40.750
> 
> 标签：iphone, xcode, tableview, updating

如果这是转发，我很抱歉，但我一直在网上搜索，似乎找不到任何有用的东西。我有一个锻炼列表，我显示在一个表格视图中，这些锻炼收集在捆绑包中的 plist 中。我还有一个单独的选项卡，允许用户构建自己的锻炼并将它们保存在文档文件夹 plist 文件中。一旦它们被保存，它们就会被添加到表格视图中。在模拟器中，everyuhting 工作正常。但是在实际设备上，除非我长时间关闭程序，从xcode重新加载程序或关闭手机，否则它不会更新。我尝试将 [[self tableview] reload] 添加到“viewDidLoad”、“viewWillappear”和“viewDidAppear”，但它们都不起作用。再一次，文件被保存，更新确实在模拟器中工作，但它没有 t 立即在手机中更新。有什么建议么？谢谢。

编辑：我知道这是一段很长的代码，但应该直截了当（希望大声笑）

```
#import "BIDWODList.h"
#import "BIDWODDetails.h"

#define kFileName   @"SavedDFWorkouts.plist"

@interface BIDWODList ()

@end

@implementation BIDWODList
@synthesize names;
@synthesize savedNames;
@synthesize keys;
@synthesize details;
@synthesize wodType;
@synthesize benchmarkGirls;
@synthesize theNewGirls;    
@synthesize heroes;
@synthesize savedDFGWorkouts;
@synthesize chosenWOD;
@synthesize chosenDetails;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSMutableArray *buildBenchmarkGirls = [[NSMutableArray alloc] init];
    NSMutableArray *buildTheNewGirls = [[NSMutableArray alloc] init];
    NSMutableArray *buildHeroes = [[NSMutableArray alloc] init];

    NSBundle *bundle = [NSBundle mainBundle];
    NSURL *plistURL = [bundle URLForResource:@"CrossfitWOD" withExtension:@"plist"];
    //put the contents of the plist into a NSDictionary, and then into names instance variable
    NSDictionary *dictionary = [NSDictionary dictionaryWithContentsOfURL:plistURL];
    self.names = dictionary;
    //take all the keys in the dictionary and make an array out of those key names
    self.keys = [self.names allKeys];

    for (NSString *nameCheck in keys){
        self.details = [names valueForKey:nameCheck];
        if ([[self.details valueForKey:@"Type"] isEqualToString:@"The Benchmark Girls"]) {
            [buildBenchmarkGirls addObject:nameCheck];
        }else if ([[self.details valueForKey:@"Type"] isEqualToString:@"The New Girls"]) {
            [buildTheNewGirls addObject:nameCheck];
        }else {
            [buildHeroes addObject:nameCheck];
        }
    }

    NSString *filePath = [self dataFilePath];
    NSMutableDictionary *savedWorkout = [[NSMutableDictionary         alloc]initWithContentsOfFile:filePath];
    self.savedNames = savedWorkout;
    self.savedDFGWorkouts = [[savedWorkout allKeys]     sortedArrayUsingSelector:@selector(compare:)];

    self.benchmarkGirls = [buildBenchmarkGirls sortedArrayUsingSelector:@selector(compare:)];
    self.theNewGirls = [buildTheNewGirls sortedArrayUsingSelector:@selector(compare:)];
    self.heroes = [buildHeroes sortedArrayUsingSelector:@selector(compare:)];
//[[self tableView] reloadData];  //reloads the data in case a DFG workout was saved

}

- (void)viewDidUnload
{
    [super viewDidUnload];
    self.names = nil;
    self.keys = nil;
    self.benchmarkGirls = nil;
    self.theNewGirls = nil;;
    self.heroes = nil;
    self.details = nil; 
```

}

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (NSString *)dataFilePath {
    NSArray *paths =NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
return [documentsDirectory stringByAppendingPathComponent:kFileName];
}

-(void)viewDidAppear:(BOOL)animated{
    [[self tableView] reloadData];
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 4;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    if (section == 0) {
        return [benchmarkGirls count];
    }else if (section == 1){
        return [theNewGirls count];
    }else if (section == 2){
        return [heroes count];
    }else{
        return [savedDFGWorkouts count];
    }

}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSUInteger section = [indexPath section];
    NSUInteger row = [indexPath row];

    static NSString *SectionsTableIdentifier = @"SectionsTableIdentifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:SectionsTableIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:SectionsTableIdentifier];
    }

    if (section == 0) {
        cell.textLabel.text = [benchmarkGirls objectAtIndex:row];
    }else if (section == 1) {
        cell.textLabel.text = [theNewGirls objectAtIndex:row];
    }else if (section == 2) {
        cell.textLabel.text = [heroes objectAtIndex:row];
    }else{
        cell.textLabel.text = [savedDFGWorkouts objectAtIndex:row];
    }
    return cell;
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
    if (section == 0) {
        return @" The Benchmark Girls";
    }else if (section == 1){
        return @"The New Girls";
    }else if (section ==2){
        return @"The Heroes";
    }else{
        return @"Saved DFG Workouts";
    }
}

#pragma mark - Table view delegate

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    BIDWODDetails *destination = segue.destinationViewController;

NSIndexPath *indexPath = [self.tableView indexPathForCell:sender];
NSUInteger section = [indexPath section];
NSUInteger row = [indexPath row];
if (section == 0) {
    self.chosenWOD = [self.benchmarkGirls objectAtIndex:row];
    self.chosenDetails = [names objectForKey:chosenWOD];
}else if (section == 1) {
    self.chosenWOD = [self.theNewGirls objectAtIndex:row];
    self.chosenDetails = [names objectForKey:chosenWOD];
}else if (section ==2) {
    self.chosenWOD = [self.heroes objectAtIndex:row];
    self.chosenDetails = [names objectForKey:chosenWOD];
}else {
    self.chosenWOD = [self.savedDFGWorkouts objectAtIndex:row];
    self.chosenDetails = [savedNames objectForKey:chosenWOD];
}//end if

//self.chosenDetails = [names objectForKey:chosenWOD];
//[destination setValue:chosenWOD forKey:@"chosenWOD"];
//[destination setValue:chosenDetails forKey:@"chosenDetails"];
destination.chosenWOD = self.chosenWOD;
destination.chosenDetails = self.chosenDetails;
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T06:05:53.237

模拟器和设备之间的不同行为通常与文件名中使用的不正确大小写有关 - 模拟器不区分大小写，而设备是。检查是否在引用 plist 文件的任何地方都使用了正确的大小写。

或者，在模拟器上，您可以直接写入应用程序包，但在设备上这是不可能的，您只能写入应用程序沙箱中的某些目录，通常是文档目录。您通常会在第一次运行时将 plist 复制到文档目录，然后使用该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T15:30:22.210

If I understand right your code you load plist file only in viewDidLoad, but most likely this function called only when you first time load your view. To make it work you should load plist in viewDidAppear. Something like this:

```
- (void)viewDidAppear {
  NSBundle *bundle = [NSBundle mainBundle];
  NSURL *plistURL = [bundle URLForResource:@"CrossfitWOD" withExtension:@"plist"];
//put the contents of the plist into a NSDictionary, and then into names instance variable
NSDictionary *dictionary = [NSDictionary dictionaryWithContentsOfURL:plistURL];
self.names = dictionary;
//take all the keys in the dictionary and make an array out of those key names
self.keys = [self.names allKeys];

for (NSString *nameCheck in keys){
    self.details = [names valueForKey:nameCheck];
    if ([[self.details valueForKey:@"Type"] isEqualToString:@"The Benchmark Girls"]) {
        [buildBenchmarkGirls addObject:nameCheck];
    }else if ([[self.details valueForKey:@"Type"] isEqualToString:@"The New Girls"]) {
        [buildTheNewGirls addObject:nameCheck];
    }else {
        [buildHeroes addObject:nameCheck];
    }
}

NSString *filePath = [self dataFilePath];
NSMutableDictionary *savedWorkout = [[NSMutableDictionary         alloc]initWithContentsOfFile:filePath];
self.savedNames = savedWorkout;
self.savedDFGWorkouts = [[savedWorkout allKeys]     sortedArrayUsingSelector:@selector(compare:)];

 [self.tableView reloadData];

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T22:58:33.010

If it works in the Simulator and does not on the phone, almost for sure the problem is a timing issue. Saving files on a real phone takes much longer than on the simulator.

You should do the following:

*   when you save a file, log it, and log the return code from the save. If the way you save does not provide a return code, use NSFileManager to verify the file is in fact where it should be and even the size of it. This takes time to do but you should do it.

*   when your table is asking for the number of this and that, log it, and lot what is returned. You may find that that this comes before the files are saved.

It takes time and effort, but if you start logging all relevant things, you can find it. I just spend 6 hours today tracking down a race condition I had thought could never happen, and it was only after looking at a huge trail of messages that I was able to see the problem.

Almost for sure you will see that either file is not saved, its not where you thought it was, or that the phone timing means some events happen later than they do in the Simulator.

# azure - 我可以在 Azure 表存储中使用私有后备变量吗？

> ID：12127949
> 
> 赞同：0
> 
> 时间：2012-08-26T05:59:38.020
> 
> 标签：azure, azure-storage, azure-table-storage

我的课堂上有以下代码：

```
 private int order;
    public int Order {
        get { return order; }
        set { order = value; }
        }
    } 
```

我通过尝试以下方法对其进行了测试，它工作正常。有人能告诉我这对我来说是合法的吗？在过去，我一直使用以下内容：

```
 public int Order { get; set; } 
```

除了手动方式需要更多输入之外，这与手动操作有什么区别吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T06:04:02.857

差别很小，在我看来，除非您需要对 get 或 set 上的私有成员进行一些操作，否则不需要。

# android - 在画布中调整位图大小和位置以使它们在不同设备中看起来相同的最佳方法？

> ID：12127951
> 
> 赞同：2
> 
> 时间：2012-08-26T06:00:22.983
> 
> 标签：android, canvas, surfaceview, tablet

我正在使用表面面板开发游戏。我已经对如何在多个设备的画布中正确缩放和定位可绘制对象进行了大量研究，我想出了一个在手机上运行良好但在平板电脑上尝试时存在一些缺陷的解决方案。我知道我可以为平板电脑使用不同的资源（我可能最终会这样做），但现在让我们假设我不想这样做，我想为市场上的每一部不同的手机使用相同的资源.

我拥有的所有资源都位于 hdpi 文件夹中，并且它们的大小适合 480x800 设备。

我的方法与[这里](https://stackoverflow.com/questions/11739730/is-canvas-in-android-proportional-on-different-devices)描述的类似，请看下面的解释，我想知道这个问题是否有更好的解决方案！

我有一个 Galaxy S2 用于测试我的应用程序。所以我的第一种方法是通过尝试找到所有内容的最佳位置来手动将所有内容直接插入画布中。以第一个字符位置为例：

```
draw_x = (float) (19);
draw_y = (float) (279);
canvas.drawBitmap(toDrawBitmap, draw_x, draw_y, null); 
```

当我第一次在不同的设备上测试它时，一切都是一团糟，超出了规模。所以四处挖掘，我想到了使用密度来扩展资源。

```
 // I am dividing by 1.5 because my initial positions are on a high density device
 // so when it goes for a medium density it should scale for 0.66 and a small density 
 // for 0.5 of my positions. 
 float scale = getResources().getDisplayMetrics().density /1.5;
 draw_x = (float) (19) * scale;
 draw_y = (float) (279) * scale;
 canvas.drawBitmap(toDrawBitmap, draw_x, draw_y, null); 
```

乍一看，这就像一个魅力。我的所有角色都处于正确的位置。但我注意到，如果与我正在使用的 Galaxy S2 相比，该设备的比例宽度/高度不同，问题就开始了。尽管一切都被正确定位，但图像的一部分被从屏幕上剪下来，画布被计算得比手机屏幕大。

Galaxy S2 为 480x800。我的背景也是 480x800。当我在模拟器中以 320x480 的小屏幕分辨率对其进行测试时，Android 并没有像我预期的那样正确缩放我的背景。它没有将它缩放到正确的分辨率，而是给了我一个比我的画布 320x533 更大的背景。

通过一些简单的数学计算，我们得出 320x533 / 480x800 = 0.66。因此，它没有正确缩放画布中的背景，而是使用设备的密度进行缩放。

所以我对这个问题的解决方法是我能想到的最简单的。我知道我的背景分辨率，我知道手机的分辨率，所以我可以计算出我需要的比例并强制调整大小。

```
 //Set the proportions for scaling in multiple devices
 public void setProportions(float screenWidth,float ScreenHeight,Bitmap background){

     this.heightProportion = ScreenHeight/background.getHeight();
     this.widthProportion = screenWidth/background.getWidth();

 }  

 public Bitmap scaleBitmaps(Bitmap bitmap) { 
         Bitmap out = Bitmap.createScaledBitmap(bitmap, (int) (bitmap.getWidth() * widthProportion), 
                    (int)  (bitmap.getHeight()*heightProportion), false);         
         return out;
     } 
```

这对于可绘制对象的大小来说效果很好，所以我只需要对位置做同样的事情，使用比例和这个新的比例，我可以使用固定大小的背景图像来计算

```
 public float convertX(float x){ 
     return x* scale * widthProportion;
 } 

 public float convertY(float y){ 
     return y* scale * heightProportion;
 } 

//calculate the positions applying the scale and the proportion
draw_x = convertX((float) (19));
draw_y = convertY((float) (279));
//draw the bitmap with the scaled position
canvas.drawBitmap(toDrawBitmap, draw_x, draw_y, null); 
```

长话短说，为了正确定位可绘制对象，我在设备中手动设置了所需的位置，计算了密度之间的比例以及背景图像尺寸和屏幕尺寸之间的比例。为了重新调整可绘制对象的大小，我只使用了比例，因为 android 会自动应用密度比例。

我在几款不同的手机和平板电脑上进行了测试，这种方法非常适用于手机。在平板电脑上，它在重新调整可绘制对象的大小时给了我一些小错误。

最后，我的问题是，这个解决方案有什么问题？无论大小如何，我都可以让它在每部手机上运行吗？或者有更好的解决方案吗？

请注意，这对 Canvas 是严格的。如果我在 XML 布局中使用相同的背景，则每部手机都会正确调整其大小。如果我不清楚或者我应该提供更多信息，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-16T05:44:08.943

在解决此问题之前，您首先要了解的是设备手机运行系统。虽然您建议手机将选择 hdpi 或其他版本，但这取决于每个手机运行的系统。

**A. 尺寸拟合问题**

问题是如何处理位图。尽管您使用任何数学公式重新缩放位图，但原始位图的大小对于每个不同的手机都会有不同的输出。要解决这个问题，您必须将位图的 inScaled 设置为 false。

**B. 位置拟合问题**

因此，您在拟合位图大小时遇到​​了问题，位图的位置将同步位置取决于您的手机屏幕尺寸。您应该定义背景对象并根据背景定位对象 x 和 y。例如，如果您想在手机屏幕中间放置一个物体，无论我们使用什么手机，代码都必须是`

> canvas.drawBitmap(toDrawBitmap, background.getwidth()/2, background.getheight()/2, null);

解决拟合位置问题。

让我知道发生了什么。

# javascript - 如何在javascript中播放另一个声音后播放声音文件

> ID：12127955
> 
> 赞同：3
> 
> 时间：2012-08-26T06:00:52.730
> 
> 标签：javascript

如何在另一个声音结束后播放声音文件？如果我这样做

```
first.play();
second.play(); 
```

两种声音同时播放。我想玩`first.play()`，当它结束时，开始`second.play()`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T06:02:58.120

```
first.addEventListener('ended', function(){
    second.play();
});
first.play(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-10T23:53:20.100

我会推荐一些东西：

```
// if using jQuery:
var audios = $('audio');

audios.each(function(idx){
    $(this).bind('ended', function(){
        var next = audios.get(idx+1);
        if(next){
            next.get(0).play();
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-07T07:05:21.903

您还可以使用带有超时的承诺：

```
const playPromise = first.play()

playPromise.then(() => {
    setTimeout(() => {second.play()}, first.duration * 1000)
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-25T21:22:43.433

我使用了[AudioScheduledSourceNode.onended](https://developer.mozilla.org/en-US/docs/Web/API/AudioScheduledSourceNode/onended)。

我使用了四种声音，并将这段代码放在一个函数中：

```
sound1.play();
sound1.onended = function () {
    sound2.play();
};
sound2.onended = function () {
    sound3.play();
};
sound3.onended = function () {
    sound4.play();
} 
```

这里是应用程序：[insultinator-toy.netlify.app](https://insultinator-toy.netlify.app/)

单击问号按钮。

*以及丑陋*的源代码的链接。[杰萨尔萨](https://github.com/jsahlsa/insultinator)

# css - 网站不会针对移动屏幕缩小

> ID：12127956
> 
> 赞同：2
> 
> 时间：2012-08-26T06:00:56.110
> 
> 标签：css, less, css-transitions

我正在为台式机、平板电脑和移动屏幕制作网页。为此，我使用 css 媒体查询。当我在桌面浏览器上测试我的网站时，当我缩小我的 web 浏览器时，它会在达到 css 中提到的最大宽度 740px 时改变它的布局。但问题是当我在我的手机上测试它时，它并没有改变它的布局以适应手机屏幕。

我正在使用 12 列布局系统并使用**[较少的 css](http://lesscss.org/)**。请帮助我为什么它不会更改其在手机上的布局以适应移动屏幕。

准确地说，这是我的 css 或更少的 css

```
html, body {
height: 100%;
//overflow: hidden;
}

body {
min-width: 360px;
background-color: #ffffff;

#page {
    width: 100%;
    height: 100%;
    overflow: auto;
}

.right {
    position: relative;
    right: 0;
}

// Extend column system (from defaults/layout.css)
.row {
    clear: both;

    > .container {
        max-width: 1024px;
        margin: 0 auto;
        padding: 0 2% 0 2%;

        .container {
            max-width: 100%;
            padding-left: 0;
            padding-right: 0;

            &.one {
                width: 8%;
            }
            &.two {
                width: 16%;
            }
            &.three {
                width: 25%;
            }
            &.four {
                width: 33%;
            }
            &.five {
                width: 41%;
            }
            &.six {
                width: 50%;
            }
            &.seven {
                width: 58%;
            }
            &.eight {
                width: 66%;
            }
            &.nine {
                width: 75%;
            }
            &.ten {
                width: 83%;
            }
            &.eleven {
                width: 91%;
            }
            &.twelve {
                width: 100%;
            }

        }
    }
}

}

/*Collapse columns*/
@media only screen and (max-width: 740px) {

.column, .column.one, .column.two, .column.three, .column.four, .column.five, .column.six, .column.eight, .column.nine, .column.ten, .column.eleven, .column.twelve,
.column.close-right, .column.one.close-right, .column.two.close-right, .column.three.close-right, .column.four.close-right, .column.five.close-right, .column.six.close-right, .column.eight.close-right, .column.nine.close-right, .column.ten.close-right, .column.eleven.close-right, .column.twelve.close-right {
    //width: auto;
    //float: none;
    //clear: both;
    margin-right: 0;
}

.column.third {
    display: none;
}

.column.second {
    width: 77%;
}

.column.first {
    //min-width: 180px;
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T06:06:27.043

尝试将其添加到 HTML 页面的顶部：

```
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head> 
```

这应该让移动浏览器知道您以设备/浏览器的大小呈现的页面，而不是伪造台式计算机的屏幕大小（从而混淆您的媒体查询）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T06:03:55.153

[http://www.allenpike.com/2010/choosing-a-viewport-for-ipad-sites/](http://www.allenpike.com/2010/choosing-a-viewport-for-ipad-sites/)

# asp.net - 遍历Vb.net中模型类的ArrayList

> ID：12127960
> 
> 赞同：0
> 
> 时间：2012-08-26T06:02:05.970
> 
> 标签：asp.net, asp.net-mvc, vb.net, view, arraylist

我有一个数组列表，其中包含模型类对象。这是我创建数组列表的方法。

```
Dim arr As New ArrayList
Dim citizenHelper As New CitizensHelper
While dr.Read
    Dim appointment As New Appointment
    appointment.AppointmentId = dr("appointment_id")
    appointment.DoctorNin = dr("doctor_nin")
    appointment.DoctorName = citizenHelper.getNameByNin(dr("doctor_nin"))
    appointment.PatientNin = dr("patient_nin")
    appointment.PatientName = citizenHelper.getNameByNin(dr("patient_nin"))
    appointment.BookingDate = dr("booking_date")
    If dr("cancelled") Is "1" Then
        appointment.Cancelled = True
    End If
    If dr("active") Is "1" Then
        appointment.Active = True
    End If
    arr.Add(appointment) 'I add to the array like this
End While
ViewData("row") = arr 
```

我想使用这个数组列表在视图页面上生成一个记录表。我尝试使用 for 循环，但我无法访问这样的模型值。所以请告诉我，我该如何解决这个问题？

我试着做这样的事情

```
<% For Each ap As ArrayList In ViewData("row")%>
    <tr>
        <td>
            ...... <!-- Now I want to show those value from a table here -->
        </td>
    </tr>
<% Next ap%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T06:06:20.320

第一个想法：

错字？`ViewData("row")`与`ViewData("rows")`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T06:06:45.343

你应该使用

```
<% For Each ap As Appointment In ViewData("rows") As ArrayList %>
<tr>
    <td>
        ...... <!-- Now I want to show those value from a table here -->
    </td>
</tr>
<% Next ap%> 
```

ViewData("rows") 包含 ArrayList，所以我们需要迭代这个集合，而 ArrayList 包含`Appointment`类型的数据。

# objective-c - 在 Cocoa 中的一系列图像之间制作动画的不同方式

> ID：12127962
> 
> 赞同：0
> 
> 时间：2012-08-26T06:02:42.840
> 
> 标签：objective-c, cocoa, core-animation

我有一系列图像 (PNG) 文件，其中大约 50 个。如果一个接一个地快速显示，它们会形成一个流畅的动画。

如何在 NSView 中在 Cocoa 中创建此动画？你会建议什么方法，你会怎么做？

这里的大多数答案似乎都建议使用 Core Animation，但我需要它位于接受鼠标事件和拖放的 NSView 中，所以我不确定这是否可行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T03:38:49.537

Core Animation 是显示流畅动画的最佳方式。

NSViewAnimation 也可以创建动画，但可能不如 Core Animation 流畅。

NSView 也可以添加 Core Animation 层。

[NSView setWantLayer:YES]

在你的问题中，你想接受鼠标事件。所以，我建议使用核心动画在 NSView 上显示动画，因为 NSView 只接受事件，然后让图层播放动画。

对不起我的英语不好，希望我表达清楚。:)

# html - 在 create-web-view 中，新窗口的 uri 在哪里？

> ID：12127970
> 
> 赞同：1
> 
> 时间：2012-08-26T06:04:31.690
> 
> 标签：html, webkit, gtk, signals, pygtk

根据[文档](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#WebKitWebView-create-web-view)，当 webkit 创建新窗口时会调用 create-new-window 信号。我一直在尝试覆盖它来处理`<a target='_blank'`PyGTK webkit 浏览器中的链接。在 WebView 的子类中，我有：

```
...

self.connect("create-web-view", self.newWin)

...

def newWin(view, frame, data):
    print view.get_property('uri')
    print frame.get_property('uri')
    print data.get_property('uri') 
```

单击新窗口链接时调用它，但由于某种原因，所有这些对象都显示相同的 url，终端打印出*当前*页面 url 3 次。如何找到应该传递到新窗口的 url？

感谢 ptomato，我找到了解决方案。将信号设置为此功能有效：

```
...
self.connect("new-window-policy-decision-requested", self.newWin) #requires webkit 1.1.4

...

def newWin(self, view, frame, request, nav_action, policy_decision):
    """
    Calls the default browser on external link requests.
    """
    functiontoviewurl(request.get_uri())
    # According to the documentation: http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#WebKitWebView-new-window-policy-decision-requested
    # call ignore on the policy decision, then return true (that is, we handled it).
    policy_decision.ignore()
    return True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T10:12:00.753

您无法通过捕获该信号来拦截新窗口的创建 - 到那时，浏览器已经决定它将创建一个新窗口。相反，连接到[`new-window-policy-decision-requested`](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#WebKitWebView-new-window-policy-decision-requested)并从`request`参数中获取 URI。

# php - 统计一次访问mysql错误图片主机点击劫持

> ID：12127973
> 
> 赞同：0
> 
> 时间：2012-08-26T06:04:51.453
> 
> 标签：php, mysql, image

嗨，我有一个网站，可以根据人们对我网站上托管的图像的看法向他们付费。问题是用户以这种方式[IMG]链接[IMG]在公告板上评论链接（不是指向图像的直接链接，而是指向查看器）设法点击劫持系统。因此，没有进入我的网站的人访问了用户。

添加对mysql表的访问的代码是这样的：

```
mysql_query("UPDATE images SET img_views = '$views++' WHERE id = '$id'"); 
```

你知道我该如何解决这个问题吗？例如 IF 条件？

我会非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T06:31:38.520

使用 php 页面来提供图像。在该 php 页面中检查引用 URI 是否与您的域匹配，然后提供该页面。您可以将图像放在 webroot 之外，以防止直接访问您的图像。

```
if(pathinfo($_SERVER['HTTP_REFERER'])['host']==$_SERVER['REMOTE_HOST'])
{
header("content-type:image:/png")
readfile("/location/to your/image/which/is/outside/webroot/image.png")
//Run update script for visit count
}
else
{
//send access denied header
} 
```

# ios - 如何在一个 uitableview 中为不同的单元格样式分配不同的标识符？

> ID：12127974
> 
> 赞同：2
> 
> 时间：2012-08-26T06:05:14.317
> 
> 标签：ios, uitableview, reuseidentifier

我是ios开发的新生，我想在一个uitableview的不同部分实现不同的单元格样式。我的表格视图有两个部分，每个部分有三行。

我知道不同的单元格应该有不同的重用标识符来检索重用单元格，但是当我编译我的应用程序时，控制台总是显示以下信息：

```
2012-08-26 14:04:45.571 Defferent Cell Styles[703:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:' 
```

任何帮助将不胜感激，我的代码如下：

```
@end

@implement LGViewController

@synthesize data = _data;
@synthesize list = _list;

- (void)viewDidLoad
{
    [super viewDidLoad];
    NSArray *dataArray = [[NSArray alloc] initWithObjects:@"fwfwf", @"ffgfg", @"sfsfsf", nil];
    NSArray *listArray = [[NSArray alloc] initWithObjects:@"fdff", @"ffdfsw", @"eergerg", nil];
    self.data = dataArray;
    self.list = listArray;
    self.navigationItem.title = @"Data";
}

#pragma mark - DataSource

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 2;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (section == 0) {
        return [_data count];
    }
    else if (section == 1){
        return [_list count];
    }
    return section;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *accessoryIdentifier = @"Cells";
    static NSString *switchIdenfier = @"Cells";
    static NSString *sliderIdentifier = @"Cells";

    UITableViewCell *cell;   
    if ((indexPath.section == 0 && indexPath.section == 1) && indexPath.row == 0)
    {
        cell = [tableView dequeueReusableCellWithIdentifier:accessoryIdentifier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:accessoryIdentifier];
        }
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
        cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    }
    else if ((indexPath.section == 0 && indexPath.section ==1) && indexPath.row == 1)
    {
        cell = [tableView dequeueReusableCellWithIdentifier:switchIdenfier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:switchIdenfier];
        }
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
        UISwitch *soundSwitch = [[UISwitch alloc] initWithFrame:CGRectZero];
        [soundSwitch addTarget:self action:@selector(showAlert) forControlEvents:UIControlEventValueChanged];
        [soundSwitch setOn:NO animated:NO];
        cell.accessoryView = soundSwitch;

    }
    else if ((indexPath.section ==0 && indexPath.section == 1) && indexPath.row == 2)
    {
        cell = [tableView dequeueReusableCellWithIdentifier:sliderIdentifier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:sliderIdentifier];
        }
        cell.selectionStyle = UITableViewCellSelectionStyleNone;
        UISlider *slider = [[UISlider alloc] initWithFrame:CGRectMake(0, 0, 60, 20)];
        cell.accessoryView = slider;

    }

    return cell;   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T06:08:46.683

您永远不会返回单元格，因为 indexPath.section 永远不能同时为 0 和 1：

```
else if ((indexPath.section ==0 && indexPath.section == 1) && indexPath.row == 2) 
```

应该

```
else if ((indexPath.section ==0 || indexPath.section == 1) && indexPath.row == 2) 
```

在所有情况下。`||`是 OR，`&&`是 AND。

虽然真的，你可以放弃对部分的检查，因为它总是 0 或 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T07:01:09.307

配置单元格的更好方法

```
 if (indexPath.section == 0) {
    switch (indexPath.row) {
        case 0:
            //configure you cell here..
            break;

        case 1:
            //configure you cell here..
            break;

        case 2:
            //configure you cell here..
            break;

        default:
            break;
    }
} else if (indexPath.section == 1) {
    switch (indexPath.row) {
        case 0:
            //configure you cell here..
            break;

        case 1:
            //configure you cell here..   
             break;

        case 2:
            //configure you cell here..                
            break;

        default:
            break;
    }
} else if (indexPath.section == 2) {
    switch (indexPath.row) {
        case 0:
        //configure you cell here..                
        break;

        case 1:
        //configure you cell here..                
        break;

        default:
            break;
    }
} 
}
return cell; 
```

# php - 关闭浏览器时如何执行php函数

> ID：12127976
> 
> 赞同：-1
> 
> 时间：2012-08-26T06:05:42.537
> 
> 标签：php, javascript, html

我知道这已经问过，但答案尚不清楚。

这是我想在关闭浏览器而不是窗口时从表中删除一列的任务。我希望在意外关机时处理该事件。

当我关闭浏览器时，是否有任何可能的方法来调用 php 函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T06:08:20.187

首先：您只能收听“窗口关闭”事件...

第二：您必须绑定到body-“unload”事件并将XHR（ajax-request）调用到php-site ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T06:15:55.800

尝试这个：

的JavaScript：

```
$(window).unload(function() {
  $.ajax({
    url:"/track.php",
    type:"POST",
    async:false, // so browser waits till xhr completed
    success:function() {
      alert("bye!");
    }

  });

}); 
```

在你的 php 脚本中，你可以做任何你想做的事情，比如跟踪 ip 并记录点击等......

# hadoop - 在 JSP 中显示 hbase 数据需要几分钟。请咨询

> ID：12127980
> 
> 赞同：-3
> 
> 时间：2012-08-26T06:06:12.860
> 
> 标签：hadoop

我正在使用 Hive 查询从 JSP 访问 HBase 数据。现在，由于 Hbase 可以存储像 TB 级数据这样的海量数据。如果数据量很大，hive 查询（转换为 map reduce 任务）将需要几分钟的时间。所以会JSP 页面等待说 10 分钟显示数据。应该是什么策略。这是正确的方法吗？如果不是这样，在 JSP 上显示大量 hbase 数据的最佳方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T08:20:09.080

Hive/任何 hadoop map-reduce 系统都是为离线批处理而设计的。从 JSP 提交 Hive 查询并等待任意时间以使数据准备好并显示在前端是绝对禁止的。如果集群超忙，您的作业甚至可能无法在指定时间内安排。

你到底想从前端的 Hbase 显示什么？

1.  如果它是表中的一组行并且您知道这些行是什么（意味着您有行键或者您的应用程序可以在运行时计算它），只需从中获取这些行并显示。

2.  如果您必须执行一些类似 SQL 的操作（连接/选择等），那么我想您确实意识到，HBase 是一个 No-SQL 系统，您应该在应用程序中执行这些操作，然后使用行键。

例如：如果您有 2 个 HBase 表，请说 Dept (dept Id 作为行键和一个字符串 column(employees)，其中包含逗号分隔的 empIds 列表) 和 Employee(emp Id 作为行键和列 Name、Age、Salary)。要找到部门中薪水最高的员工，您必须

a.从 Dept 表中获取行（使用部门 ID）

湾。迭代employees 列中的empId 列表。

C。在每次迭代中，从 Employee 表中获取行（通过 empId 行键）

并找到最大值

是的，HBase 可以处理 TB 的数据，但您几乎不必使用 JSP 在前端显示那么多数据。我猜，你很可能只对数据的一部分感兴趣，尽管支持 HBase 表要大得多

# wpf - 固定长度的菜单项

> ID：12127984
> 
> 赞同：1
> 
> 时间：2012-08-26T06:06:28.050
> 
> 标签：wpf, menu, menuitem

我有一个接收动态 ItemsSource 的菜单。项目的数量和长度会不时变化。

```
<Menu ItemsSource="{loc:CustomBinding CurrentMenuItems}" /> 
```

菜单的方向是水平的，有时这会导致菜单溢出。

菜单项模板：

```
<ControlTemplate TargetType="{x:Type MenuItem}">
    <TextBlock Text="{loc:CustomBinding Title}"                                
               MaxWidth="200"
               TextTrimming="CharacterEllipsis"/>   
</ControlTemplate> 
```

超过4项时，菜单溢出屏幕左侧外（抱歉不能从工作地点上传图片）。

1.  WPF 菜单是否有任何内置溢出选项？

2.  是否有一个选项可以控制菜单本身的菜单项溢出？`ItemsMaxLength`我可以绑定到计算字段的某些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T18:50:38.023

当最右边的菜单项无法在屏幕上显示时，我不清楚您想要发生什么。是吗？：

*   将它们包装到下一行
*   完全裁剪它们
*   部分裁剪它们
*   将它们放在溢出下拉列表中？
*   显示椭圆或其他“更多”指示器？

a的默认`ItemsPanel`模板`Menu`使用`WrapPanel`... 应该将它们包装到下一行（除非您为菜单设置了高度，或者您的菜单位于不允许其具有所需高度的容器中）。

我们可以更改用于更改项目布局方式的 ItemsPanel。

在下面的示例 XAML 中，我展示了 4 种显示菜单的方法。您可以在 Kaxaml 中使用它来查看不同的行为...将 Window 调整为较小的宽度，以查看当水平空间不足时会发生什么。

1.  原始菜单样式...包装不适合的菜单项
2.  完全裁剪不适合的菜单项的菜单
3.  部分裁剪不适合的菜单项的菜单
4.  使用工具栏的菜单...任何不适合进入溢出面板的项目
    （请注意，此示例并不完美...它不完全符合鼠标/键盘的标准菜单选择行为，因为它为每个项目使用单独的菜单......风格有点偏离......它显示了一个工具栏抓手......需要更多的工作）。

如果 4 最接近您想要的，那么您需要以某种方式将行为或工具栏与其溢出面板...与菜单的行为以及菜单项之间的跟踪/导航相结合。

您可以通过创造性地重新模板化菜单或工具栏或创建自己的自定义控件来实现这一点。

```
 <Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Name="Window"
    Title="MainWindow"
    Width="640" Height="480">
    <StackPanel Orientation="Vertical">
        <Menu>
            <MenuItem Header="_File">
                <MenuItem Header="_Exit"/>
            </MenuItem>
            <MenuItem Header="_Edit"/>
            <MenuItem Header="_Window"/>
        </Menu>
        <Menu>
            <Menu.ItemsPanel>
                <ItemsPanelTemplate>
                <ToolBarPanel IsItemsHost="True" Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </Menu.ItemsPanel>
            <MenuItem Header="_File">
                <MenuItem Header="_Exit"/>
            </MenuItem>
            <MenuItem Header="_Edit"/>
            <MenuItem Header="_Window"/>
        </Menu>
        <Menu>
            <Menu.ItemsPanel>
                <ItemsPanelTemplate>
                <StackPanel IsItemsHost="True" Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </Menu.ItemsPanel>
            <MenuItem Header="_File">
                <MenuItem Header="_Exit"/>
            </MenuItem>
            <MenuItem Header="_Edit"/>
            <MenuItem Header="_Window"/>
        </Menu>
        <ToolBar>
        <ToolBar.Resources>
        <Style x:Key="MenuItemStyle" TargetType="{x:Type MenuItem}">
  <Style.Triggers>
    <Trigger Property="Role" Value="TopLevelHeader">
      <Setter Property="Template"
              Value="{StaticResource {x:Static MenuItem.SubmenuHeaderTemplateKey}}"/>
    </Trigger>
  </Style.Triggers> 
</Style>
        </ToolBar.Resources>
          <Menu>
            <MenuItem Header="_File">
                <MenuItem Header="_Exit"/>
            </MenuItem>
          </Menu>
          <Menu>
            <MenuItem Header="_Edit"/>
          </Menu>
          <Menu>
            <MenuItem Header="_Window"/>
          </Menu>
        </ToolBar>
    </StackPanel>
</Window> 
```

# eclipse - 禁用 Eclipse 警告“项目必须由 EAR 或 WAR 引用才能使用类路径发布/导出依赖项......”？

> ID：12127991
> 
> 赞同：6
> 
> 时间：2012-08-26T06:07:21.717
> 
> 标签：eclipse, jakarta-ee

我有一个库用于几个不同的 Eclipse 项目（我保存在不同的工作区中），其中一些是 Java EE 项目（即动态 Web 项目），一些是纯 Java 项目。因此，它存在于多个工作空间中（引用共享的颠覆存储库以保持副本同步）。

为了为 Web 项目正确导出库的依赖项，我将它引用的 jar 文件添加到项目的部署程序集选项卡，路径为“ `../`”（使用部署程序集选项卡中的 Java 构建路径条目选项）。这对于 Web 项目非常有效，但是当我在没有 Web 项目的工作区中打开项目时，会收到以下警告：

```
Projects must be referenced by an EAR or a WAR to use classpath publish/export dependencies whose runtime path (../) maps into the parent component. 
```

有没有办法禁用这个警告，因为当我使用普通的 Java 项目时，发布/导出依赖项基本上是无关紧要的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-23T16:17:16.093

[按照https://www.eclipse.org/forums/index.php/t/172866/](https://www.eclipse.org/forums/index.php/t/172866/)上的说明，我能够消除该警告。

在**.classpath**文件中，替换：

```
<attribute name="org.eclipse.jst.component.dependency" value="../"/> 
```

和

```
<attribute name="org.eclipse.jst.component.dependency" value="/WEB-INF/lib"/> 
```

# php - 使用 PHP 获取 PDF 文件的高度和宽度

> ID：12127992
> 
> 赞同：2
> 
> 时间：2012-08-26T06:07:30.577
> 
> 标签：php, pdf, imagemagick, height, width

我有一个使用 Imagick PHP 的 PDF 文件的缩略图创建脚本。

它将创建 PDF 文件第一页的缩略图。

我能够在固定高度和宽度的情况下生成缩略图而没有任何问题

我必须获取 PDF 文件第一页的高度和宽度，并且必须相应地计算缩略图的高度和宽度。

如果我必须从图像创建缩略图，我可以在 PHP 中使用 getimagesize 函数，但是有没有类似的函数来获取 PDF 文件第一页的高度和宽度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-26T07:31:32.577

`[0]`您可以通过附加到文件名来访问 ImageMagick 可以读取的任何多页文件格式的第一页。

这意味着，您可以`identify`使用此命令要求打印 PDF 第一页的宽度和高度，将其转换为 PHP 语法应该没有问题

```
 identify  -format "width: %W  --  height: %H\n"  some.pdf[0] 
```

这将以以下格式打印*MediaBox第一页的值：*

```
 width: 345  --  height: 777 
```

这些值的单位是 PostScript 点（其中`72 pt == 1 inch`）。当然，您可以自由修改命令以满足您的需要，例如仅给出 2 个数值，或使用以下`WxH`格式：

```
 identify  -format "%W %H\n"  some.pdf[0]
 identify  -format "%Wx%H\n"  some.pdf[0] 
```

但是，请注意以下事实：

1.  PDF 还支持可选的*TrimBox*、*CropBox*、*ArtBox*和*BleedBox*设置。
2.  其中最重要的是*TrimBox*，因为：
3.  如果*TrimBox*与*MediaBox*不同（它需要相同或更小，并且不允许更大！），则要求 PDF 查看器和打印机驱动程序仅呈现该框内的页面部分。
4.  `identify`将仅返回 MediaBox 值，它不支持其他 Box。
5.  同样，`convert`将使用 PDF 页面的（可能更大的）MediaBox 大小来呈现图像（因此其结果看起来与您在 PDF 查看器中看到的不同）。
6.  幸运的是，带有与*MediaBox*值非常不同的*TrimBox*值的 PDF并不常见。
**   如果您需要访问所有 Box 的值设置，您应该使用不同的命令实用程序来提取相关信息：`pdfinfo -box -f 1 -l 1 some.pdf | grep -E '(Box:|rot:|size:)'`. （如果可能，请使用*Poppler*版本...）`pdfinfo`*

# c - 引用计数如何工作？

> ID：12127997
> 
> 赞同：2
> 
> 时间：2012-08-26T06:08:24.297
> 
> 标签：c, memory, pointers, memory-management, reference

引用计数结构如何工作？例如让我们看一下`SDL_Surface`：

```
typedef struct SDL_Surface
{
    ...
    int refcount;
} SDL_Surface;

s = SDL_CreateRGBSurface(...); // <-- what happens here?
SDL_FreeSurface(s); // <-- and here? 
```

如何在自己的代码中实现引用计数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-26T06:11:01.737

`SDL_CreateRGBSurface`将分配`SDL_Surface`（或合适的派生结构）的新实例，并增加引用计数（将其设置为 1）。

`SDL_FreeSurface`将减少引用计数，并检查它是否为零。如果是，则意味着没有其他对象正在使用该表面，它将被释放。

SDL 还保证每当对象在其他地方（例如在渲染器中）使用时，引用计数就会增加。因此，如果在调用时引用计数不为零`SDL_FreeSurface`，则必须有其他对象在使用它。另一个对象最终也会调用`SDL_FreeSurface`并永久释放表面。

引用计数允许您廉价地跟踪对象，而无需循环收集垃圾收集器的开销。然而，一个缺点是它不能处理循环（例如，对象 A 持有对 B 的引用，而 B 又持有对 B 的引用）；在这些情况下，即使所有其他外部引用都消失了，循环也会使所涉及的对象保持活动状态。

要实现引用计数，您只需向要引用计数的任何对象添加一个引用计数字段，并确保（在您的公共 API 和内部）对象的每次分配和释放都通过适当的引用计数维护接口（您必须定义）。最后，当一个对象或函数想要引用您的引用计数的对象时，它们必须首先通过增加引用计数（直接或通过某些接口）来获取引用。完成后，他们必须减少引用计数。