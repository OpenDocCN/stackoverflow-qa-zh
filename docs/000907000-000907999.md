# StackOverflow 问答 000907000-000907999

# javascript - 原型：Element.remove.bind(foo) 没有按预期工作

> ID：907000
> 
> 赞同：0
> 
> 时间：2009-05-25T14:45:28.000
> 
> 标签：javascript, prototypejs, bind

我有这个片段：

```
self.puff({duration: 0, queue: 'end',
        afterFinish: Element.remove.bindAsEventListener(self)
    }); 
```

自我是一个元素；当对它的所有影响完成后，它应该从文档中删除一个元素。

不幸的是，这不起作用，因为“element.parentNode is undefined”而失败。如果我替换`Element.remove.bindAsEventListener(self)`为`function() { self.remove(); }`then 它会。我试过只是 bind() 具有相同的结果。

问题是：为什么它不起作用，我应该如何使用 bind()？

在对元素的所有效果完成后显示更简单的删除元素的方法的奖励积分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T15:11:13.953

```
self.puff({duration: 0, queue: 'end',
    afterFinish: function () { self.remove(); }
}); 
```

这种放置方式有什么问题？你甚至自己建议。在任何情况下，您都不需要将其绑定为事件侦听器，因为它只是 bind 的 Prototype 语法糖版本，以确保函数的第一个参数始终是事件对象。由于 afterFinish 不是浏览器事件，因此没有必要。

最后，您绑定了不正确的函数。*您应该绑定self*的方法实例：

```
self.puff({duration: 0, queue: 'end',
    afterFinish: self.remove.bind(self)
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T15:05:48.457

为什么不简单地使用：

```
function(){ self.remove(); } 
```

这实际上更具可读性。

# git - 即使给出了公钥，Gitosis 也需要密码

> ID：907004
> 
> 赞同：20
> 
> 时间：2009-05-25T14:45:58.653
> 
> 标签：git, installation, gitosis

尝试在 Archlinux 上配置 gitosis 时遇到一些问题

[http://wiki.archlinux.org/index.php/Setting_Up_Git_ACL_Using_gitosis](http://wiki.archlinux.org/index.php/Setting_Up_Git_ACL_Using_gitosis)

我参考了这篇wiki文章并成功安装了gitosis。

> $ sudo pacman -U gitosis-git-20090525-1-i686.pkg.tar.gz
> $ sudo -H -u gitosis gitosis-init < /tmp/id_rsa.pub

并修改 /srv/gitosis/.ssh/authorized_keys 以包含我本地用户的 id_rsa.pub。

但是当我`git clone`以本地用户身份运行时，

> $ git clone gitosis@host:gitosis-admin.git

它说

> 在 /home/wyx/gitosis-admin/.git/ gitosis@10.132.140.73 中初始化空的 Git 存储库
> 密码：*****
> 致命：'gitosis-admin.git' 似乎不是
> 致命的 git 存储库：远端意外挂断

所以 git clone 操作失败。我想知道为什么它会尝试在我的本地用户目录（/home/wyx）中初始化一个空的 git 存储库？既然我已经在 .ssh/authorized_keys 中添加了本地用户的 id_rsa.pub，为什么还要输入密码呢？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-25T14:57:45.930

创建了一个空存储库，因为这正是 git 的工作方式：它必须先初始化一个存储库，然后才能开始将远程对象拉入其中。不幸的是，这意味着您必须在再次尝试克隆之前手动删除空仓库。

至于克隆失败的原因，看起来您对远程存储库路径使用了错误的语法；`git clone`不使用 scp 语法。实际上，如果您不指定克隆协议，我相信它假定使用 git 协议而不是 ssh，这可能就是它要求您输入密码的原因。试试这个：

```
$ git clone ssh://gitosis@host/~/gitosis-admin.git

```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-09-27T06:15:59.333

我也遇到了同样的问题“致命：'/gitosis-admin.git' 似乎不是一个有效的存储库。” 我搜索了很多问题并最终找到了解决方案。

实际上，gitosis 用户的默认地址是“/srv/gitosis”：就像我的设置有 ubuntu 服务器 10.04。

当我们编写“git clone gitosis@server.com:gitosis-admin.git”时，它会在 /srv/gitosis 中搜索 gitosis-admin.git 存储库。因此，当我进入 /srv/gitosis 内部时，我发现其中还有一个名为 repositories 的存储库，它由 gitosis-admin.git 存储库组成。

所以实际上默认情况下 gitosis-admin.git 不在默认位置。所以我必须修改命令路径，然后它工作正常。

我将存储库克隆到我的本地计算机上。我将命令用作：

“git clone gitosis@server.com:repositories/gitosis-admin.git”对我来说效果很好。

请参阅您的情况下的 gitosis-admin 目录，希望您能够解决您的问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-10-22T05:02:22.213

这就是为我解决问题的方法（在 Ubuntu 上）：

```
git clone gitosis@ns.home:/srv/gitosis/repositories/gitosis-admin.git 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-08-08T14:41:09.433

Gitosis 创建它自己的`authorized_keys`文件。如果您已经拥有该文件，请将其删除并允许 gitosis-init 重新创建它。完成后，不要弄乱文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-13T20:52:36.017

我在ubuntu上遇到了同样的问题，

它与`git clone ssh://git@serverName/absolutePath/gitosis-admin.git`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-01-03T17:37:32.927

我解决了一个类似的问题。这可能与您的情况不完全一样，但您可以尝试重新应用我所做的相同故障排除。

我意识到，当我为新用户推送密钥时，我得到了这个堆栈跟踪，这是 gitosis 的钩子无法处理新密钥的症状。

```
remote: Traceback (most recent call last):
remote:   File "/usr/local/bin/gitosis-run-hook", line 9, in <module>
remote:     load_entry_point('gitosis==0.2', 'console_scripts', 'gitosis-run-hook')()
remote:   File "/usr/local/lib/python2.7/dist-packages/gitosis-0.2-py2.7.egg/gitosis/app.py", line 24, in run
remote:     return app.main()
remote:   File "/usr/local/lib/python2.7/dist-packages/gitosis-0.2-py2.7.egg/gitosis/app.py", line 38, in main
remote:     self.handle_args(parser, cfg, options, args)
remote:   File "/usr/local/lib/python2.7/dist-packages/gitosis-0.2-py2.7.egg/gitosis/run_hook.py", line 81, in handle_args
remote:     post_update(cfg, git_dir)
remote:   File "/usr/local/lib/python2.7/dist-packages/gitosis-0.2-py2.7.egg/gitosis/run_hook.py", line 45, in post_update
remote:     config=cfg,
remote:   File "/usr/local/lib/python2.7/dist-packages/gitosis-0.2-py2.7.egg/gitosis/gitdaemon.py", line 95, in set_export_ok
remote:     for (dirpath, repo, name) in walk_repos(config):
remote:   File "/usr/local/lib/python2.7/dist-packages/gitosis-0.2-py2.7.egg/gitosis/gitdaemon.py", line 72, in walk_repos
remote:     assert ext == '.git'
remote: AssertionError 
```

该错误仅显示**ONCE**，因此我天真地将其视为暂时失败。

实际上，Gitosis 仅适用于我的密钥，但不适用于我试图支持的任何用户。在`~/.ssh/authorized_keys`我找不到我以为我刚刚添加的用户的公钥中。这就是为什么我的朋友每次尝试克隆时都被要求输入密码的原因。

我通过将这两行添加到 Gitosis 配置中添加了调试`gitosis.conf`

```
[gitosis]
loglevel=DEBUG 
```

我不得不继续在 gitosis.conf 文件中添加和删除用户，以便再次触发挂钩。我的调试日志显示

```
remote: DEBUG:gitosis.gitdaemon:Deny 'syncShare'
remote: DEBUG:gitosis.gitdaemon:Walking 'legacy.d', seeing ['buildtools', 'QA_Dashboard']
remote: DEBUG:gitosis.gitdaemon:Walking 'legacy.d/buildtools', seeing ['.git', 'conf', 'scripts'] 
remote: Traceback (most recent call last): 
etc ... 
```

啊哈！当钩子在存储库中执行“遍历”时，它找到了一个`.git`目录，`legacy.d/buildtools`而这正是`assert ext == '.git'`发生的地方。

我曾使用服务器存储来自其他存储库的简单克隆。注意，一个普通的克隆，而不是镜像或裸存储库。像每个克隆一样，它包含 .git 目录。

Gitosis 中的钩子不知道如何处理 .git 目录。它认为它是一个空名称的存储库并中止。一旦我消灭了那个克隆，一切都会恢复正常。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-15T18:13:48.453

通常不需要编辑authorized_keys。

我曾经遇到过授权问题，即使我之前放置了我的公钥，gitosis 服务器也会不断询问我的密码。当我尝试提交并将更改推送到 gitosis 时，我意识到 gitosis 给了我一个警告“WARNING:gitosis.ssh:Unsafe SSH username in keyfile:'myuser@myserver.pub'”。

更改密钥文件和密钥文件名称中的 user@host 部分解决了我的问题。不知何故gitosis不喜欢以前的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-18T18:29:13.950

我终于让它像这样工作了

```
git clone ssh://git@host:1337/home/git/repositories/gitosis-admin.git 
```

1337 端口 ssh 正在使用的位置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-22T21:59:28.437

同样的问题，就我而言，我在 .ssh/ 中有错误的授权密钥。我一定是在某个时候搞砸了...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-24T22:13:24.467

搬到新的 Ubuntu 机器并自己遇到这个问题后，我在这里看到了几个答案，这些答案让我朝着正确的方向前进，即为每个存储库使用**.git文件的绝对路径。**

尝试了一下，我注意到相对于 git 用户主目录的路径也有效，它缩短了如下内容：

```
git@host:/var/git/repositories/project.git 
```

向下

```
git@host:repositories/project.git 
```

再玩一点，我尝试将项目文件从存储库移动到 git 的主目录；现在只需要项目：

```
git@host:project.git 
```

这有点hacky，但我怀疑会造成任何伤害。很高兴知道发生了什么变化，因为我在另一个 Ubuntu（旧）上托管 gitosis 并且能够使用上面的最后一个符号将项目放在存储库目录中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-01-10T14:36:49.133

要更深入地了解身份验证问题，请收集详细的调试日志详细信息：通过使用

`ssh -vvv gitosis@gitosis_host`

直接手动连接技巧（最重要/一般来说，实际上使用最精确/直接的上下文引用；在这种情况下：实际的 ssh 机制而不是工具距离 - 因此必然不太精确 - git 处理！）。

# sql-server - 在线图书 ms-help:// 和 http://msdn.microsoft.com 之间是否存在映射关系

> ID：907005
> 
> 赞同：2
> 
> 时间：2009-05-25T14:46:25.953
> 
> 标签：sql-server, msdn

通常当我在 SQL Server BOL 中找到一篇文章时，我会看到该文章的地址为 ms-help://

但我不能将此“uri”转发给没有 Sql Server BOL 的同事 --- 所以问题是 ms-help:// 和[http://msdn.microsoft 之间是否存在一致的映射。 com](http://msdn.microsoft.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T14:54:34.860

老实说，我的回答是对所有事情都使用 msdn，除非您个人离线并且无法访问它。

如果您喜欢使用 MSHELP 应用程序，可以在设置中使其在线使用 msdn，而不是本地内容（如果您不费心安装本地文档，这是默认设置）。

这意味着您始终拥有 msdn 链接（即使在帮助应用程序中），因此可以与您的同事共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T18:32:26.690

MSDN 在线更改的速度与您的离线内容不同。IE。映射函数可能今天有效但明天无效。我做什么我只是在 msdn 中搜索主题标题（当然，使用 google 站点：msdn.microsoft.com，msdn 搜索只是蹩脚）并发布/邮寄链接。

# subsonic - 亚音速 3 状态

> ID：907006
> 
> 赞同：1
> 
> 时间：2009-05-25T14:46:26.530
> 
> 标签：subsonic, subsonic3

您能用几句话描述 Subsonic 3 项目的状态吗？当我们可以期待发布时，您会分享来源吗？发展情况如何，遇到了什么问题等等……

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T18:27:14.657

目前，当我使用 S3 构建我正在从事的项目时，我正在努力改进。我试图让它达到一个可敬的、坚实的点，这样你就不必一直告诉我关于愚蠢的错误。

例如 - 前几天我发现并消除了一个一直困扰着我的愚蠢的加入错误:)。

我需要确保工作体验是我想象的那样：尽可能接近 0 摩擦。我也在努力完善我们的文档，这样你就不必猜测了——你可以在这里看到：

[http://subsonicproject.com/docs](http://subsonicproject.com/docs)

我有一些很棒的人在帮助我，但我现在已经冻结了对我自己之外的核心内容的承诺，所以我们没有得到任何回归。

我知道人们想要使用它——我需要对其进行调整，所以人们将不得不稍等片刻。

# configuration - 配置虚拟主机的问题

> ID：907009
> 
> 赞同：1
> 
> 时间：2009-05-25T14:47:46.137
> 
> 标签：configuration, xampp, virtualhost

一些细节

*   XAMPP 1.7.1
*   在 vista 和 xp 上测试的操作系统

大家好。我在配置我的虚拟主机时遇到了一些问题。目前我有两个网站。

这是我的 vhost.conf 文件：

```
<VirtualHost *:80>
    ServerAdmin me@site.nl
    DocumentRoot c:/xampp/htdocs/site1/trunk/
    ServerName site1.local
</VirtualHost>

<VirtualHost *:80>
    ServerAdmin me@site.nl
    DocumentRoot c:/xampp/htdocs/site2/trunk/
    ServerName site2.local
</VirtualHost> 
```

当然，在我的主机文件中，我有

```
127.0.0.1 site1.local
127.0.0.1 site2.local 
```

我已经多次重新启动 apache 以及我的浏览器。

这是我的问题：

[http://site1.local](http://site1.local)有效。但是当我访问[http://site2.local](http://site2.local)时，我登陆的是 site1.local。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T14:54:55.313

尝试

```
<VirtualHost "site1.local">
    ServerAdmin spam@a1230912##ad#.nl
    DocumentRoot c:/xampp/htdocs/site1/trunk/
    ServerName site1.local
</VirtualHost>

<VirtualHost "site2.local">
    ServerAdmin spam@a1230912##ad#.nl
    DocumentRoot c:/xampp/htdocs/site2/trunk/
    ServerName site2.local
</VirtualHost> 
```

你总是得到 site1 因为 Apache 默认是第一个。

**编辑**

取消注释

```
#NameVirtualHost * 
```

到

```
NameVirtualHost * 
```

在你的 httpd.conf

我说（/etc/httpd/conf/httpd.conf）

```
126 # Listen: Allows you to bind Apache to specific IP addresses and/or
127 # ports, in addition to the default. See also the <VirtualHost>
128 # directive.
129 #
130 # Change this to Listen on specific IP addresses as shown below to 
131 # prevent Apache from glomming onto all bound IP addresses (0.0.0.0)
132 #
133 Listen 127.0.0.1:80
134 NameVirtualHost 127.0.0.1 
```

我的虚拟主机文件有

```
<VirtualHost "www.whatever.com">
        DocumentRoot /var/www/html/whatever/pub
        ErrorLog logs/error_log
        ServerName www.whatever.com
... 
```

# flash - 轮播组件 a-la searchme.com

> ID：907014
> 
> 赞同：0
> 
> 时间：2009-05-25T14:51:02.077
> 
> 标签：flash, user-interface

我正在寻找一个类似于 searchme.com 的开源 Flash 轮播组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T14:59:30.077

查看[MooFlow](http://www.outcut.de/MooFlow/example-ajax.html)。

还有[ImageFlow](http://imageflow.finnrudolph.de/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:34:11.807

我发现了这个： [http ://dougmccune.com/blog/2007/11/03/coverflow-flex-component/](http://dougmccune.com/blog/2007/11/03/coverflow-flex-component/)

使用 flash papervision 可以很好地做到这一点，它是一个用于动作脚本的 3d 库。

# asp.net - 如何汇总数据库表中的最后 15 行？

> ID：907023
> 
> 赞同：0
> 
> 时间：2009-05-25T14:53:01.977
> 
> 标签：asp.net, sql, sql-server, tsql, aggregate

我有一个销售表，其中包含以下列：

*   员工ID
*   数量
*   日期

现在我想`SUM`增加最后 15 行，所以我目前正在做：

```
SELECT TOP 15 SUM(amount) FROM Sales ORDER BY [Date] DESC 
```

但是我显然得到了 15 行，有没有一种方法可以总结它而不必在客户端循环和求和它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-25T14:54:46.577

```
SELECT
    SUM (Amount)
FROM
    (SELECT TOP 15 amount FROM Sales ORDER BY [Date] DESC) foo 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T14:56:03.000

```
SELECT Sum(amount )
FROM
(
   SELECT Top 15 amount FROM Sales ORDER BY [Date] Desc
) as bar 
```

# apache-flex - ax = 100 和有什么区别？ay = 100 和 a.move(100,100)？

> ID：907031
> 
> 赞同：0
> 
> 时间：2009-05-25T14:55:14.313
> 
> 标签：apache-flex, actionscript-3

使用和使用有什么区别

```
a.x = 100;
a.y = 100; 
```

和

```
a.move(100,100); 
```

在动作脚本 3 / Flex 中？

最好的问候，
阿尔乔姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T15:05:29.753

一般来说：调用方法可以传达您正在做的事情，而仅仅戳成员变量则不会。

正如 ChrisF 所说，戳移动到绝对坐标，而方法调用相对于当前位置移动也可能有所不同。我尝试查找参考，但没有找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T15:56:20.253

什么是一个？如果我们知道“a”是什么，那么它会更容易回答。ax 或 ay 通常会在其父对象（例如 Canvas）中指定对象（例如 Button）左上角的坐标。

如果 'a' 是一个按钮，那么设置 .x 和 .y 或设置 move(x, y) 将做同样的事情。

检查文档'将组件移动到其父级中的指定位置。调用该方法与设置组件的 x 和 y 属性完全相同。'

[http://livedocs.adobe.com/flex/3/langref/index.html](http://livedocs.adobe.com/flex/3/langref/index.html)，它在 UIComponent 下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T15:00:30.590

只是猜测（我不知道动作脚本），但我会认为

```
a.x = 100;
a.y = 100; 
```

将 a 设置为 (100, 100)，而

```
a.move(100,100); 
```

将 (100,100) 添加到 a 的当前值。但是，鉴于已接受的答案，它似乎也是如此。尽管以下建议仍然有效：

您是否尝试过后者以获取 (0, 0)、(100, 100)、(23, 42) 等的不同初始值并检查会发生什么？

如果您不确定某件事，请测试一下——您不会破坏任何东西，即使第一次出错也能教给您一些东西。

我快速搜索了一些文档，但无法找到任何东西。我认为您最好的选择是生成一些测试示例来探索每种方法的作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T00:31:45.527

实际上，ActionScript 属性可以由方法支持 - 所谓的 getter/setter 对。因此，当您设置属性 ax = 100 时，很可能正在执行代码来处理该属性更改的影响。（不知道 a 是什么类型，不可能确定——事实上，一般情况下*永远*不可能知道，你不应该假设你知道）

这里要注意一件事：调用*单个*方法（例如 a.move(x,y)*可能*与调用 ax = q 和 ay = r 后面的两个*单独*的setter 方法完全不同。这完全取决于你的类重新使用已经实现。出于这个原因，许多 Flex 框架类（全部？）使用 invalidateProperties() ... commitProperties() 模式来确保通过单个控制点协调所有属性更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T08:10:03.963

这是最好使用 move 的情况：

如果你`updateDisplayList()`在自定义组件中重写方法，你应该调用`move()`方法而不是设置`x`和`y`属性。不同的是，`move()`方法改变组件的位置，然后`move`在调用方法时调度事件，同时设置`x`和`y`properties 更改组件的位置并在下一次屏幕刷新时调度事件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T16:56:28.207

```
[WINDOWS_USER_PROFILE_PATH]\Local Settings\Application Data\Adobe\Flash[version]\en\Configuration\Classes 
```

总是看这里确切地知道。如果你的意思是 UIControl，那么看看`[PATH_ABOVE]\mx\core\UIObject.as`

你会看到不同之处：

```
function move(x:Number, y:Number, noEvent:Boolean):Void
{
    //trace("UIObject.move " + this + " -> (" + x + ", " + y + ")");
    var oldX:Number = _x;
    var oldY:Number = _y;

    _x = x;
    _y = y;

    if (noEvent != true)
    {
        dispatchEvent({type:"move", oldX:oldX, oldY:oldY});
    }
} 
```

因此，正确答案是：在分配新坐标后，此方法会调度由旧坐标提供的“移动”事件。就这样。

PS：如果您使用另一个 Flash 编译器 - 只需在您的机器上的某处找到它的类定义...

# .net - 如何在visualstudio2005中为vc++项目添加参考

> ID：907032
> 
> 赞同：0
> 
> 时间：2009-05-25T14:55:21.317
> 
> 标签：.net, visual-studio, visual-c++, visual-studio-2005

我创建了一个需要添加 .net 程序集引用的 vc++ 控制台应用程序。

但是当我作为项目右键单击->属性->通用属性->引用->添加引用时执行以下操作

然后我得到窗口

添加引用（标题）

选项卡式窗口项目名称和项目目录，并有空列表

我找不到 com 和 .net 程序集。如何解决这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T15:09:41.163

这可能会帮助您：

*   [如何：在 Visual Studio 中添加或删除引用](http://msdn.microsoft.com/en-us/library/wkze6zky(VS.80).aspx)

*   [将程序集添加到 Visual Studio 2005 中的“添加引用”对话框](http://blogs.msdn.com/astebner/archive/2005/11/28/497693.aspx)

*   [如何在 Visual Studio 2005 中添加 DLL 引用？](http://social.technet.microsoft.com/Forums/en-US/exchangesvrdevelopment/thread/3d63b671-a915-4e5e-a0b0-bd49328032d4)

*   更多[在这里](http://www.google.lt/search?hl=lt&rlz=1C1GGLS_enLT310LT311&ei=y7MaSrraJYTC-AbAlPXKDg&sa=X&oi=spell&resnum=0&ct=result&cd=1&q=visual+studio+2005+add+reference&spell=1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T13:35:14.963

因为你想在 C++ 中使用 .net 程序集，所以它是托管代码。所以首先在项目中

属性选择 oprion 公共语言运行时支持，然后将 mscorlib.dll 包含在

c++ 文件。现在转到项目属性->右键单击->添加引用->现在它将显示所有

.net 库为您服务。

# model-view-controller - MVC 哪里不好？

> ID：907033
> 
> 赞同：8
> 
> 时间：2009-05-25T14:55:30.583
> 
> 标签：model-view-controller, paradigms

我一直在阅读这里的几个问题和有关 MVC 的各种文章，并且可以看到它甚至可以如何应用于 GUI 事件密集型应用程序，例如绘图应用程序。

任何人都可以举出 MVC 可能是一件坏事并且不明智地使用它的情况吗？

编辑：我在这里专门谈论 GUI 应用程序！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-25T14:56:51.377

我在我的网络内核驱动程序中尝试了 MVC。补丁被拒绝。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-25T15:13:25.167

我认为你在看它有点倒退。重点不是看你可以在哪里应用 MVC 之类的模式，重点是学习模式并识别何时可以通过应用模式自然地解决你试图解决的问题。因此，如果您的问题空间可以自然地分为模型、视图和控制器，那么它是 MVC 的一个很好的候选者。如果您不能轻易看出您的设计中的哪些部分属于这三类，那么它可能不是合适的模式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-25T14:58:46.943

MVC 对 Web 应用程序很有意义。在 Web 应用程序中，你处理一些数据（在 SA 上：写问题、添加评论、更改用户信息），你有状态（登录用户），你没有很多不同的页面，但有很多不同的内容可以放入那些页面。一个问题页面与一百万个问题。

例如，对于制作 CMS，MVC 是无用的。你没有任何模型，没有控制器，只有一页带有装饰和菜单的文本。问题不再是处理数据 - 现在的问题是正确地提供文本内容。

Tho，CMS **Admin**可以很好地建立在 MVC 之上，这只是用户部分不会。

对于 Web 服务，您最好使用 REST，我相信它是一种独特的范式。

WebDAV 应用程序也不会从 MVC 中受益匪浅。

[Ruby 用于Web 编程的警告](http://www.cio.com/article/191000/You_Used_Ruby_to_Write_WHAT_)是Rails 更适合构建Web 应用程序。我见过许多项目尝试使用 Rails 创建 WebDAV 服务器或内容管理系统 CMS，但都失败了。虽然您可以在 Rails 中创建 CMS，但有更高效的技术可以完成这项任务，例如 Drupal 和 Django。事实上，我想说，如果您正在研究 Java Portal 开发工作，您应该评估 Drupal 和 Django 来代替该任务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T15:04:23.437

任何你想加入 3rd 方组件的地方都会使在 MVC 模式中工作变得困难。CMS 就是一个很好的例子。

您获得的每个组件都将具有其“自己的”控制器对象，并且您将无法共享模型的“控制”-> ui 传递。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T15:27:53.060

我不一定知道 MVC 对于 GUI 应用程序来说真的是个*坏*主意。但是有一些替代方案可以说更好（也可以说更糟，这取决于你问谁的意见）。最常见的是MVP。请参阅此处以获取解释： [关于 MVC 和 MVP 但不敢问的所有](http://haacked.com/archive/2008/06/16/everything-you-wanted-to-know-about-mvc-and-mvp-but.aspx)信息。

尽管我认为如果您正在使用框架或与未考虑 MVC 设计的软件进行交互，则使用 MVC 可能是一个坏主意。

换句话说，这很像比较编程语言。通常没有多少任务可以说一个比另一个更好。它通常归结为程序员的偏好、库的可用性和团队的经验。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T17:06:58.650

MVC 不应该用于性能至关重要的应用程序中。我不知道随着计算能力的提高这是否仍然适用，但一个例子是呼叫中心应用程序。如果您可以在每次呼叫输入和更新信息时节省 0.5 秒，那么这些节省会随着时间的推移而累积。要从应用程序中获得最后一点性能，您应该使用桌面应用程序而不是 Web 应用程序，并让它直接与数据库对话。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T15:05:19.347

什么时候是坏事？哪里有另一种更适合您的项目的代码结构。

有无数的项目 MVC 不“适合”，但我看不出它们的列表会有什么好处..

如果 MVC 适合，请使用它，如果不适合，请使用其他东西..

* * *

## 回答 #8

> 赞同：-7
> 
> 时间：2010-08-25T17:13:58.110

MVC 和 ORM 是个笑话……它们仅适用于您的应用程序不是数据库应用程序，或者您希望保持应用程序数据库不可知的情况。如果您使用的是支持存储过程的 RDBMS，那么这是唯一的方法。存储过程是经验丰富的应用程序开发人员的首选方法。MVC 和 ORM 仅由试图销售与这些技术相关的产品或服务的公司推广（例如，微软试图销售 VS）。不要再浪费时间学习 Java 和 C#，而是专注于真正重要的事情，Javascript 和 SQL。

# c++ - Win32 消息泵与 MFC 消息映射，哪个更快？C++

> ID：907040
> 
> 赞同：0
> 
> 时间：2009-05-25T14:57:07.320
> 
> 标签：c++, winapi, mfc

不是从易用性，而是从性能的角度。MFC 消息映射是否比典型的消息泵更快？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T15:06:23.277

MFC 包装了 Win32 消息传递，因此如果有的话，MFC 会稍微慢一些。也就是说，如果您正在处理 UI 小部件，则性能不是问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-25T15:10:27.760

它们不可能更快，因为它们只是普通 Windows 消息泵的包装。话虽如此，它们在反射消息和自定义控件的消息泵封装方面确实有很大帮助，而且开销可以忽略不计，因此从长远来看，如果您有一个复杂的 UI 项目，这可能是值得的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-25T20:49:45.133

我不得不不同意（到目前为止）其他 2 位受访者声称 MFC 消息泵的性能较低，仅仅是因为它包装了普通的旧 C 消息泵：MFC 使用的技术与包含巨大开关的简单窗口 proc 非常不同（消息） 陈述。

MFC 消息泵确实依赖于 Win32 消息循环（它必须）。但实现非常不同：基于钩子，由 MFC 在内部处理消息的分派，而不是依赖于 DispatchMessage() API。

MFC 使用映射将消息与处理程序匹配：O(log n)。从这个角度来看，在某些情况下，这可能比大型且*编译错误*的switch(message) 语句更快：O(n)。

此外，识别正确的窗口对象可能比 DispatchMessage() 更快，因为 Windows 不是开源的，我们无法确定。

然而这不太可能，特别是考虑到额外的代码，例如命令路由、空闲处理和 MFC 代码处理的各种极端情况……以及编译器足够聪明以有效地实现大型`switch()`语句的事实！

话虽如此，15 年多来，性能受到的影响并不显着。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-16T01:21:07.477

塞尔吉写道：

> MFC 消息泵确实依赖于 Win32 消息循环（它必须）。但实现非常不同：基于钩子，由 MFC 在内部处理消息的分派，而不是依赖于 DispatchMessage() API。

我不确定这是否正确。如果你查看*MFC* **thrdcore.cpp**文件，你会看到这个函数：

```
 BOOL AFXAPI AfxInternalPumpMessage()
  {
     _AFX_THREAD_STATE *pState = AfxGetThreadState();

     .......... snip ...........

     // process this message
     if (pState->m_msgCur.message != WM_KICKIDLE 
         && !AfxPreTranslateMessage(&(pState->m_msgCur)))
     {
        ::TranslateMessage(&(pState->m_msgCur));
        ::DispatchMessage(&(pState->m_msgCur));
     }
     return TRUE;
  } 
```

此函数由 MFC **PumpMessage**函数调用，您可以看到它使用 Win32 **DispatchMessage** API，就像任何其他 Win32 应用程序一样。

# flash - 是否可以在 Flash/ActionScript 中使用 UDP？

> ID：907041
> 
> 赞同：17
> 
> 时间：2009-05-25T14:57:08.957
> 
> 标签：flash, networking, udp

快速提问：是否有可能在 Flash/ActionScript 中创建 UDP 数据报套接字？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-02-28T00:11:20.490

这个问题很久以前就被问过了，后来答案变成了是。对于其他偶然发现这个问题的人：

[DatagramSocket](http://help.adobe.com/en_US/FlashPlatform/beta/reference/actionscript/3/flash/net/DatagramSocket.html)类启用 UDP 通信。例如：

```
var datagramSocket:DatagramSocket = new DatagramSocket();
datagramSocket.bind(3333, "127.0.0.1");
datagramSocket.addEventListener(DatagramSocketDataEvent.DATA, onUDPReceived);
datagramSocket.receive(); 
```

注意：DatagramSocket 仅适用于桌面版 AIR，不适用于设备或 Flash Player。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T16:02:54.277

是的。。

> FMS 和 Player 10 的下一个版本将引入一个新协议 RTMFP，它代表实时消息流协议。这是基于 Amicima 的 MFP 协议的低延迟、基于 UDP 的协议。Amicima 于 2006 年被 Adob​​e 收购。

请注意，作为“基于 UDP 的协议”，它不是原始 UDP 实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-11T23:46:25.150

**在撰写本文**时，答案是否定的。

BinarySocket 和 Xml Socket 都是基于 TCP/IP 的。正如 SpliFF 提到的，UDP 被添加到 Flash 10 中，主要用于 Flash Media Server 工具和 RTMFP。Adobe Stratus 是迄今为止该协议的一个示例。 [http://labs.adobe.com/technologies/stratus/](http://labs.adobe.com/technologies/stratus/)

然而，当前来自 Adob​​e 的 UDP 示例都是基于点对点的。UDP 在 P2P 中具有优势，但在更大规模的多用户或 DVE（分布式虚拟环境）中更是如此，因此希望它成为未来的重点。

如果你想为游戏使用 UDP，Unity3D 目前在网络播放器中支持 UDP。或者使用 Java 的 jMonkeyEngine 支持它。Torque 3D web based 即将推出也可能支持它。

**然而**，答案已经变成了肯定的；要了解这现在是如何实现的，请参阅 [eri​​csoco 的回答](https://stackoverflow.com/a/9474448/444991)，了解如何使用`DatagramSocket`来实现这一点。

# javascript - 可以分配给数组中的多个变量吗？

> ID：907042
> 
> 赞同：42
> 
> 时间：2009-05-25T14:57:10.300
> 
> 标签：javascript

这是从 JavaScript 中的数组分配给多个变量的标准方法吗？在 Firefox 和 Opera 中，您可以执行以下操作：

```
var [key, value] = "key:value".split(":");
alert(key + "=" + value); // will alert "key = value"; 
```

但它在 IE8 或 Google Chrome 中不起作用。

有谁知道在没有 tmp 变量的其他浏览器中执行此操作的好方法？

```
var tmp = "key:value".split(":");
var key=tmp[0], value=tmp[1]; 
```

这是即将到来的 JavaScript 版本中出现的东西，还是只是 FF 和 Opera 中的自定义实现？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-03-03T14:22:02.483

解构分配在 ECMAScript 2015（又名 ES6）中标准化。但并非所有浏览器都实现了解构（截至 2016 年 3 月），即使他们这样做了，用户也需要一段时间才能更新到支持的浏览器。请参阅规范中的[示例](http://wiki.ecmascript.org/doku.php?id=harmony:destructuring#examples)，了解您可以做的所有很棒的事情。这里有一些：

```
// Assign from array elements
var [key, value] = "key:value".split(":");
// key => 'key'
// value => 'value'

// Assign from object properties
var {name: a, age: b} = {name: 'Peter', age: 5};
// a => 'Peter'
// b => 5

// Swap
[a, b] = [b, a]
// a => 5
// b => 'Peter' 
```

由于此功能破坏了向后兼容性，因此您需要[转换](http://en.wikipedia.org/wiki/Transpile)代码以使其在所有浏览器中都能正常工作。许多现有的转译器支持解构。[Babel](http://babeljs.io/)是一个非常流行的转译器。请参阅[Kangax 的浏览器和转译器 ES6 支持表](http://kangax.github.io/compat-table/es6/)。

更多信息：

[ES6 浏览器支持的兼容性表](http://kangax.github.io/es5-compat-table/es6/#Destructuring)

[探索 ES6 - 解构章节](http://exploringjs.com/es6/ch_destructuring.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-25T17:41:18.897

如果你想知道接下来会发生什么，请阅读解构赋值部分。

[https://developer.mozilla.org/en/New_in_javascript_1.7](https://developer.mozilla.org/en/New_in_javascript_1.7)

您可以使用哪些语言功能始终取决于您的环境。

例如，为 Mobile Safari（或其他浏览器，如 Palm Pre、Android 等的 Web 堆栈）或 AIR 开发比为整个 Web 开发更可预测（即使是 IE6 也必须考虑在内） .

* * *

手头问题的跨浏览器解决方案是初始化一个数组，其中包含要以 window.variable 格式填充的变量列表，然后循环遍历。无法想象你为什么会这样做。似乎总会有更好的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-10-15T17:14:50.340

### 使用[解构赋值](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)，ES6 的一个特性：

```
var [x, y] = [1, 2];
console.log(x, y); // 1 2 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-18T18:24:46.243

我只是有完全相同的问题，作为自己的练习，我想出了以下内容：

```
var key, value;

(function(arr){
  key=arr[0]; 
  value=arr[1];
})("key:value".split(":"));

alert(key + "=" + value); 
```

对我来说看起来很难看，我宁愿使用 temp var （从技术上讲，我在这里使用了一个 temp 变量）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T15:12:55.900

我认为这不可能以跨浏览器的方式进行。我所知道的在某些情况下可能会有所帮助的最好的是：

```
// we'll pretend you don't need the key.
var value = "key:value".split(":")[1]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T15:11:56.823

我认为它应该是新规范的一部分。然后又是一篇长篇文章……：p

```
key = "key:value".split(":")[0];
value = "key:value".split(":")[1]; 
```

我能想到的唯一选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T15:26:45.093

我不知道你是如何使用它的，但如果我能够确定我自己的“key:value”字符串格式，我会很想使用 json 来将字符串评估为必要的对象：

```
var obj = eval("{'key':'key_str', 'value':'val_str'}");
alert(obj.key + "=" + ojb.value);  //alerts "key_str=value_str 
```

# apache-flex - flex 似乎没有与自定义 actionscript 对象绑定

> ID：907045
> 
> 赞同：3
> 
> 时间：2009-05-25T14:57:21.407
> 
> 标签：apache-flex, actionscript-3, binding

我有一个自定义的 actionscript 对象，定义为可绑定许多公共属性。

```
[Bindable]
public class MyObject extends Object {   

    public var mobileNumber:String;
... 
```

在我的 mxml 中，我有：

```
<mx:Script><![CDATA[
    import mx.binding.utils.BindingUtils;
    import org.test.MyObject;

    [Bindable]
    private var obj: MyObject = new MyObject();
]]></mx:Script>

<mx:Label text="Mobile Number" id="mobileNumberLabel"/>
<mx:TextInput id="mobileNumberText" text="{obj.mobileNumber}" />

<mx:LinkButton label="Load" id="loadButton" enabled="true" click="obj = obj.load();"/>
<mx:LinkButton label="Save" id="saveButton" enabled="true" click="obj.write();"/> 
```

我的问题是，当我在手机号码字段中输入新值然后单击保存按钮时，键入的值不会被注销......即：

```
 public function write():void {
        var bytes:ByteArray = new ByteArray();
        trace("write - mobile:" + this.mobileNumber);

        bytes.writeObject(this);
        EncryptedLocalStore.setItem(KEY, bytes);
    } 
```

我也尝试添加：

```
 private function init():void {
        BindingUtils.bindProperty(mobileNumberText, "text", obj, "mobileNumber");
    } 
```

但也没有运气。

我可能在这里遗漏了一些简单的东西，但不确定它是什么。希望你能帮忙，谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T00:13:03.100

tst's answer is correct - bindings are one-way. I'm guessing you already knew that though, since you *tried* to setup the reverse binding in your init() method.

However, there's two problems with your init() method.

First, it's not clear where you put that init() method, or what calls it.

Second, you got the method parameters backwards.

What I typically do in situations like this is either use the mxml tag as the first responder suggested, or if I'm in AS3 code, I do something like this:

```
private function onCreationComplete(event:Event):void
{
  BindingUtils.bindProperty(obj, "mobileNumber", mobileNumberText, ["text"]);
} 
```

Note a couple of points here:

1/ BindingUtils.bindProperty() is "left hand side = right hand side". Thus, it's kinda like writing

```
 obj.mobileNumber = mobileNumberText.text; 
```

Or, closer to what is "actually going on" inside the binding classes:

```
 obj["mobileNumber"] = mobileNumberText["text"]; 
```

2/ BindingUtils.bindProperty() actually wants an array as the last param. This is so that you can do "chained properties" logically like:

```
obj.mobileNumber = mobileNumbersGrid.selectedItem.text; 
```

which would be

```
BindingUtils.bindProperty(obj, "mobileNumber", mobileNumbersGrid,
    ["selectedItem", "text"]); 
```

3/ Best practice tip: if you're binding a property chain whose initial member is a property of yourself (this), then write it as:

```
BindingUtils.bindProperty(obj, "mobileNumber", this,
    ["mobileNumbersGrid", "selectedItem", "text"]); 
```

This neatly handles the case where your "right hand side object" this.mobileNumbersGrid instance itself is replaced with a new instance object.

4/ If you ever reassign obj ("the left hand side"), you need to create a new binding to the new obj instance. Typically, you do this by turning the local obj property into a getter/setter pair like this:

```
 public function get obj():MyObject
  {
    return _obj;
  }

  private var _obj:MyObject = new MyObject();

  public function set obj(value:MyObject):void
  {
    _obj = value;
    BindingUtils.bindProperty(_obj, "mobileNumber", mobileNumberText, ["text"]);
  } 
```

(Note: to be really careful, you'd stash the returned value from BindingUtils.bindProperty() which is a ChangeWatcher instance, and you'd unwatch() to prevent the old object from receiving property changes)

Hope this helps. Bindings are among the most powerful tools in the Flex framework, but can cause a lot of headaches when used poorly. In particular, be aware of memory leaks and "unexpected updates" when bindings are left "hanging around".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T16:42:14.750

This code:

```
<mx:TextInput id="mobileNumberText" text="{obj.mobileNumber}" /> 
```

makes a one-directional binding between obj.mobileNumber and mobileNumberText.text. What you need is an additional reverse binding - add the following line to your code and it will work:

```
<mx:Binding source="mobileNumberText.text" destination="obj.mobileNumber"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T16:01:53.967

您是否尝试实施`IEventDispatcher`或扩展`EventDispatcher`？

绑定通过调度工作`PropertyChangeEvents`，所以也许这就是问题所在？另外，我不确定绑定是否适用于变量，或者它们是否需要属性（getter/setter）。

You should try compiling with -keep-generated-actionscript and see if the resulting code makes any sense, i.e. dispatches any events, if the variable is accessed ...

# svn - 更改 SVN 版本的时间戳

> ID：907048
> 
> 赞同：3
> 
> 时间：2009-05-25T14:57:55.103
> 
> 标签：svn, timestamp

这种情况很可能是另一个线程中描述的情况（我不允许添加超链接，因为我是新用户）当然，我也已经尝试过该线程中建议的解决方案（即更改 svn:date 属性我的案例从 2003 年 1 月 1 日到 2009 年 5 月 16 日），并检查它是否真的发生了变化。（我所做的检查是：用 TortoiseSVN 打开属性对话框，发出`svnlook date`命令，甚至尝试`svn log -r {2009-05-01}:{2009-05-25}` 根据所有三个检查，最后一次修订的时间戳设置正确（即前两个检查返回了我拥有的时间戳刚刚设置，并且在指定的时间间隔内按预期转储了头部修订的日志。）

因此 svn:date 属性似乎设置正确，但是，当我告诉 TortoiseSVN 显示日志列表时，它仍然显示头部修订的条目，就好像它已使用旧时间戳 (2003-01-01 ）。我已经更新了工作副本，甚至再次检查了它，在此之前我手动更新了与头部修订相对应的文件的时间戳，但 TortoiseSVN 仍然显示旧日期。

在为这个问题苦苦挣扎了几个小时之后，我真的不知道该时间戳还能存储在哪里。（而且我几乎确信这整个问题不是 TortoiseSVN 错误，因为在这种情况下再次检查应该可以解决问题）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T15:03:47.727

TortoiseSVN 维护一个日志缓存。按**ctrl+F5**刷新缓存。

查看帮助文件（ **5.9\. 修订日志对话框**）以获取更多说明

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T13:21:23.900

谢谢，彼得成功了。我没有提到我什至尝试过杀死 TSVNCache 进程，所以我认为我已经摆脱了任何缓存的信息。好像有点太执着了……

（不确定这应该作为答案，但是我不能发表评论，因为我还没有 50 分......）

# php - Zend Studio PHP Explorer 不显示我的新项目

> ID：907051
> 
> 赞同：0
> 
> 时间：2009-05-25T14:58:50.483
> 
> 标签：php, zend-studio

我是 Zend Studio 的新手，也是 PHP 的新开发人员。

现在，我有一个简单的问题，我在 Zend Studio 中创建了一个项目，新建 -> PHP 项目，但是新创建的项目没有出现在 PHP 资源管理器迷你窗口中。

我将目录更改为 opt/lampp/htdocs/tutorial。那是错误，我想知道如何更改目录并仍然在 PHP 资源管理器中显示它。

谢谢！！:?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-03T11:25:01.983

您可以将现有项目导入新工作区：

文件->导入->现有项目到工作区

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-29T18:13:06.157

我意识到这是一个老问题，但我最近遇到了这个问题，所以想分享一下。

假设您有意或无意地选择了一个工作集，因此您只能看到属于该集的项目。

在 Zend Studio/Eclipse 中，单击 Explorer 窗格最右侧的向下三角形，如果未显示为灰色，请选择“Deselect Working Set”。这将删除您的工作集配置，并显示所有项目，而不考虑工作集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T07:07:15.180

在 New PHP Project 对话框中，您选择了哪个选项？“从现有源创建项目”或“在工作区中创建新项目”？转到窗口 -> 显示视图 -> 其他... -> 常规 -> 项目资源管理器。在这个新视图中，您仍然看不到该项目吗？每次创建新项目时都会发生这种情况吗？

约西·莱昂

# iphone - presentModalViewController:animated: 关闭后崩溃

> ID：907055
> 
> 赞同：0
> 
> 时间：2009-05-25T15:00:48.077
> 
> 标签：iphone, memory-management, uiviewcontroller, crash

我目前遇到`UIViewController`'s的问题`presentModalViewController:animated:`。

我使用以下代码来设置和显示模态视图控制器：

```
UINavigationController *navigationController = [[UINavigationController alloc] init];
AddSerialController *serialController = [[AddSerialController alloc] initWithNibName:@"AddSerial" bundle:nil];
[navigationController pushViewController:serialController animated:NO];

[self.parentViewController presentModalViewController:navigationController animated:YES];

[serialController release];
[navigationController release]; 
```

`dismissModalViewControllerAnimated:`应用程序（在 iPhone 模拟器中运行）一被调用就会崩溃。GDB 说它在`objc_msgSend`.

如果我注释掉最后一行代码（导航控制器的发布）一切正常，但我正在泄漏`UINavigationController`（如预期的那样）。

这到底是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T17:02:12.900

当你创建一个 UINavigationController 时，你应该给它一个根视图控制器：

> `AddSerialController *serialController = [[AddSerialController alloc] initWithNibName:@"AddSerial" bundle:nil];`
> 
> `UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:serialController];`
> 
> `[serialController release];`
> 
> `[self.parentViewController presentModalViewController:navigationController animated:YES];`
> 
> `[navigationController release];`

# sql-server - 如何验证 SQL Server 流量是否加密？

> ID：907057
> 
> 赞同：12
> 
> 时间：2009-05-25T15:01:07.437
> 
> 标签：sql-server, security

我需要证明我们在应用程序连接字符串中的加密设置是有效的。

验证从我们的网站到 SQL Server 的流量实际上是否已加密的最简单方法是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-25T15:03:18.027

您可以使用[Wireshark](http://www.wireshark.org/)之类的工具来查看通过网络传输的数据包

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-25T16:26:41.233

您检查DMV的`encrypt_option`列。[`sys.dm_exec_connections`](http://technet.microsoft.com/en-us/library/ms181509.aspx)这样，您不仅可以证明它是加密的，还可以在启动时在应用程序中进行验证。要强制执行加密，请遵循此[MSDN How To: Enable Encrypted Connections to the Database Engine](http://technet.microsoft.com/en-us/library/ms191192.aspx)中描述的方法。如果客户端或服务器强制加密并提供证书并且客户端接受服务器证书，则连接将被加密。要验证流量是否加密，您可以使用内置的 netmon.exe 工具（必须从广告/删除系统组件安装），下载改进的[Microsoft Network Monitor 3.2](http://www.microsoft.com/Downloads/details.aspx?FamilyID=f4db40af-1e08-4a21-a26b-ec2f4dc4190d&displaylang=en)或其他第三方工具。

作为替代方案，部署站点可以强制执行 IPSec 加密。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-25T15:49:48.100

我会在 db 连接字符串中将 Force Protocol Encryption 设置为 true，并将 Trust Server Certificate 设置为 true。如果服务器无法按要求为您提供加密连接，则它应该无法建立连接。有[一篇文章](https://blogs.msdn.com/sql_protocols/archive/2005/11/10/491563.aspx)介绍了使用 sql server 2005 及更高版本进行加密。

简单的测试是尝试加密和不加密的连接，并在分发不需要的连接类型时失败。然后由 DBA、IT 或您来配置服务器以满足您的要求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-16T14:52:09.940

Microsoft 本身还有另一个被低估的工具：“Microsoft Network Monitor”。基本上这与wireshark非常相似，除了一些特定的MS协议比wireshark本身具有更好的解析器和可视化支持，而且显然它只能在windows下运行;-)。

该工具已经很老了，看起来已经被废弃了（到目前为止还没有看到更新的版本），但仍然做得很好，并且用于定义新协议的语法非常简洁/有趣 - 所以这对于未来仍然具有很大的影响力。 ![mnm 3.4 关于对话框](https://i.stack.imgur.com/CQzpl.png)

分析示例 - 为 TDS 过滤记录 - 所以其他数据包大部分被丢弃：

![TDS (MSSQL) 的示例会话](https://i.stack.imgur.com/G41fq.png)

对于 sql server 连接也是如此。MNM 甚至可以可视化通过网络传输的结果集——非常简洁。尽管如此，上面提到的wireshark足以验证加密并在线路本身上应用证书。意味着它可以完全理解 TDS-Protocoll。

**处理 TLS**

还带有扩展名（所谓的专家）“NmDecrypt”和正确的证书（包括私钥） - 可以解密协议 - 对于使用 TDS 内部的 TLS 的 TDS 来说非常好 - 难怪 - 没有人真正实现过作为wireshark 的完全支持的协议；）

**工具链接：**

*   微软网络监视器：[http ://www.microsoft.com/en-us/download/details.aspx?id=4865](http://www.microsoft.com/en-us/download/details.aspx?id=4865)
*   NMDecrypt：[http ://nmdecrypt.codeplex.com/releases/view/85581](http://nmdecrypt.codeplex.com/releases/view/85581)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T11:23:57.553

为保证正在使用加密，您需要在服务器上[启用强制加密选项](https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine#ConfigureServerConnections)。

客户端加密不是强制性的。服务器端是强制性的。

SQL Server 服务启动时，如果无法读取证书或有其他障碍，它将停止。它不会接受未加密的连接。

为了回答，我第一次使用加密检查时使用了数据包嗅探器，然后我只是依赖于服务器端加密是强制性的并且 SQL 不会启动的事实。

[对于 SQL 2000，知识库文章 276553](http://support.microsoft.com/kb/276553/en-us)

> 请记住，如果在服务器上启用加密，则当前存在 SQL Server 限制。加密 **将**用于所有传入连接。如果您在客户端计算机上启用加密，则来自该客户端的所有传出连接都会**尝试**与任何 SQL Server 建立加密连接。

[SQL 2005 的 KB 搜索](http://support.microsoft.com/search/default.aspx?mode=r&query=sql+server+2005+encryption+connection&spid=global&catalog=LCID%3D2057&2057comm=1&res=20)

后期编辑：

使用旧版本的 MS JDBC 客户端：它无法处理服务器端加密...

# .net - 是否有任何框架或库可用于使用 .Net 远程记录错误？

> ID：907058
> 
> 赞同：1
> 
> 时间：2009-05-25T15:01:19.730
> 
> 标签：.net, logging, exception-handling

我希望我的所有 .Net 应用程序能够在连接可用时通过 Internet 记录未处理的异常。有没有人们为此目的使用的图书馆（最好是免费/开源的）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T15:03:51.580

Log4Net 会做到这一点，特别是通过使用像[SmtpAppender](http://logging.apache.org/log4net/release/sdk/log4net.Appender.SmtpAppender.html)这样的 Appender 。

[http://logging.apache.org/log4net/index.html](http://logging.apache.org/log4net/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T15:03:49.617

负载。 [log4net](http://logging.apache.org/log4net/index.html)可能有一些东西，如果没有，您可以轻松编写一个 log4net 插件，该插件称为 WCF 或 asmx Web 服务，可以在某处记录日志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T15:04:09.943

我相信 ELMAH 可以满足您的需求。

[http://code.google.com/p/elmah/](http://code.google.com/p/elmah/) [http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx](http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)

# database - 设计数据库元数据存储库时要遵循的任何准则？

> ID：907062
> 
> 赞同：0
> 
> 时间：2009-05-25T15:02:27.450
> 
> 标签：database, modeling

我想为内部数据库设计一个元数据存储库。存储库应该能够为诸如哪些表具有什么类型的数据以及表的关系是什么等问题提供简单的答案？我应该遵循任何行业标准指南吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T15:56:19.223

我最近读到 SQL 92 标准要求数据库有一个 INFORMATION_SCHEMA 元数据存储库，谷歌搜索了一下，我发现它支持你的两个示例问题。

# c# - 如何更改datagridview中第一行的可见性

> ID：907064
> 
> 赞同：2
> 
> 时间：2009-05-25T15:02:55.827
> 
> 标签：c#, datagridview, visibility

我正在使用 datagridview，它的数据源是一个 BindingList。但是当我尝试更改第一行的可见性时，我得到了 InvalidOperationException。如何更改第一行的可见值？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-07T12:55:00.570

我找到了怎么做。

您必须指定：

datagridview.CurrentCell = null;

设置前：

行.可见 = 假；

因为如果 currentCell 在要隐藏的行中，则会出现提到的问题。

问候

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-25T15:04:31.923

可能在 DataSource 或网格上应用过滤器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-25T17:05:35.673

在预渲染时，在 Web 域中，设置可见属性。

在 windows 域中，确保它不是标题行类型。你不能隐藏，AFAIK。否则，只需将其隐藏在 ondatabind 中。

# c++ - slist 优于向量的好处？

> ID：907087
> 
> 赞同：4
> 
> 时间：2009-05-25T15:08:06.767
> 
> 标签：c++, list, stl, vector

我需要的只是一个动态增长的数组。我不需要随机访问，我总是插入到最后并从头到尾阅读。

slist 似乎是第一选择，因为它提供了我需要的足够多的东西。但是，我不知道使用 slist 而不是 vector 可以获得什么好处。此外，我读过的一些关于 STL 的材料说，“向量通常是访问元素以及从序列末尾添加或删除元素的最有效的时间”。因此，我的问题是：就我的需要而言，slist 真的比 vector 更好吗？提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-25T15:14:20.810

对于初学者来说，`slist`是非标准的。

对于您的选择，链表将比向量慢，依靠它。造成这种情况的原因有两个：

1.  首先，缓存局部性；向量将它们的元素线性存储在 RAM 中，这有助于缓存和预取。
2.  其次，附加到链表涉及动态分配，这会增加大量开销。相比之下，向量大部分时间*不需要*分配内存。

但是，a`std::deque`可能会更快。[深入的性能分析](http://www.codeproject.com/KB/stl/vector_vs_deque.aspx)表明，尽管有相反的偏见，但由于其改进的（分块）内存分配策略，`std::deque`几乎总是优于`std::vector`性能（如果不需要随机访问）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T15:11:23.970

是的，如果你总是从头到尾阅读，[slist](http://www.sgi.com/tech/stl/Slist.html)（一个链表）听起来像是要走的路。可能的例外是，如果您将在最后同时插入大量元素。然后，如果您适当地使用储备，向量可能会更好。

当然，配置文件以确保它更适合*您的*应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T15:40:51.253

Matt Austern（“Generic Programming and the STL”的作者和一般的 C++ 大师）强烈主张将单链表包含在即将到来的 C++ 标准中；[在http://www.accu-usa.org/Slides/SinglyLinkedLists.ppt](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2543.htm)上查看他的演示文稿，在[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/](http://www.accu-usa.org/Slides/SinglyLinkedLists.ppt)上查看他的长篇文章[n2543.htm](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2543.htm)了解更多详细信息，包括对可能指导您选择此数据结构的权衡的讨论。（请注意，目前提议的名称是`forward_list`，尽管`slist`它是 SGI 的 STL 和其他流行库中的传统名称）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T17:25:15.490

我会第二次（或第三次......）认为`std::vector`或`std::deque`将完成这项工作的意见。我唯一要补充的是一些额外的因素，这些因素应该指导 和 之间的`std::vector<T>`决定`std::list<T>`。`T`这些与您计划使用的算法的特征和算法有很大关系。

首先是内存开销。`Std::list`是基于节点的容器，因此如果`T`是原始类型或相对较小的用户定义类型，则基于节点的链接的内存开销可能是不可忽略的 - 考虑`std::list<int>`可能至少`3 * sizeof(int)`为每个元素使用存储，而`std::vector`将仅使用`sizeof(int)`具有较小标头开销的存储。`Std::deque`与 类似，`std::vector`但开销很小，与 成线性关系`N`。

下一个问题是复制构建的成本。如果`T(T const&)`完全昂贵，那么请避开，`std::vector<T>`因为随着向量大小的增长，它会导致出现一堆副本。这是`std::deque<T>`一个明显的赢家，`std::list<T>`也是一个竞争者。

通常指导容器类型决策的最后一个问题是您的算法是否可以使用 和 的迭代器失效`std::vector`约束`std::deque`。如果您将大量操作容器元素（例如，排序、在中间插入或改组），那么您可能想要倾向于，`std::list`因为操作顺序只需要重置一些链接指针。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T15:14:55.757

我猜你的意思是 std::list 的“slist”。当您需要快速、随机访问一系列元素、保证连续内存和快速顺序读取（IOW，从头到尾）时，向量是很好的选择。当您需要在序列的开头或结尾快速（恒定时间）插入或删除项目时，列表很好，但不关心随机访问或顺序读取的性能。

差异的原因是 2 的实现方式。向量在内部实现为项目数组，当添加项目时达到其大小/容量时需要重新分配。列表被实现为双向链表，这可能导致顺序读取的缓存未命中。列表的随机访问还需要从列表中的第一个（或最后一个）项目开始扫描，直到找到您请求的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T17:48:46.683

Sounds like a good job for *std::deque* to me. It has the memory benefits of a vector like contiguous memory allocation for each "slab" (good for CPU caches), no overhead for each element like with std::list and it does not need to reallocate the whole set as std::vector does. Read more about [std::deque here](http://www.codeproject.com/KB/stl/vector_vs_deque.aspx)

# iphone - 将子视图添加到视图层次结构中

> ID：907091
> 
> 赞同：0
> 
> 时间：2009-05-25T15:09:14.253
> 
> 标签：iphone, cocoa-touch, uiview, uiviewcontroller, uiscrollview

我希望在用户单击按钮时出现一个视图。我的层次结构如下所示：

主窗口

```
-UIView
--ScrollView
---ScrollView.pages = UIViews
----UIView (from above assignment)
----TextView
----InfoButton 
```

pages 是 pageController 对象的 NSMutableArry。这些钩在笔尖上。这些笔尖是用户在滚动视图中浏览的页面。

InfoButton 点击​​的连接方式如下：

```
- (IBAction) infoButton_click:(id)sender{
topView topViewViewController *topView = [[topViewViewController alloc] initWithNibName:@"TopView" bundle:[NSBundle mainBundle]];
//[self.navigationController pushViewController: topViewView animated:YES]; 
//[self.view addSubview: topViewView.view];
[super.view addSubview: topViewView.view];
[topViewView release];
} 
```

InfoButton 位于 ScrollView 中的页面之一上。我已经注释掉了已经尝试过的不同代码。它都没有添加视图。没发生什么事。有没有办法让 TopView 作为层次结构中的顶视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T15:42:45.700

您的目标是将视图添加为子视图，还是使用导航控制器在新视图上滑动？我暂时假设后者。

```
- (IBAction)infoButton_click:(id)sender
{
    TopViewController *topViewController = [[TopViewController alloc] initWithNibName:@"TopView" bundle:nil];
    [self.navigationController pushViewController:topViewController animated:YES]; 
    [topViewController release];
 } 
```

如果您实际上有一个导航控制器，这是正确的。确保你确实做到了。当 Cocoa 中的“什么都没有发生”时，通常意味着某事是零。您应该检查调试器或`NSLog()`查看这些值是否为 nil。您的父母有可能（甚至很可能）有一个导航控制器，但您没有。

类应该总是有一个领先的资本。不要创建一个名为“view”的变量，它属于“UIViewController”类。这是通往苦难的必经之路。Objective-C 是一种动态语言，编译器对类型的检查有限。正确命名事物对于在 ObjC 中进行有效编程至关重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T20:48:17.350

根据您对先前答案的评论，您希望呈现模态视图。您可以通过创建一个新视图“ `modalView`”并调用`[topView presentModalViewController:modalView animated:YES]`.

在 iPhone OS 的未来版本中，如果它在 NDA 下，我当然无法评论，您可以通过在要呈现的视图控制器上设置属性来呈现具有翻转过渡的模态视图控制器，这可能会被称为`modalTransitionStyle`或类似的。

# java - 保持 i18n 资源同步

> ID：907098
> 
> 赞同：6
> 
> 时间：2009-05-25T15:10:40.960
> 
> 标签：java, properties, editor, internationalization

我正在寻找 i18n 属性文件的编辑器/比较器，它可以帮助我保持不同语言文件的同步。

基本上，它会比较一堆属性文件并显示特定语言中不存在哪些键。

属性看起来像

```
component.titlepage.title = hello world 
```

一个简单的差异是不可能的，因为右侧会因一种语言而异。

我们目前的基础设施：

*   Java 应用程序
*   使用 maven2 构建
*   系统不同组件的不同 i18n 属性文件。（每个组件每种语言 1 个属性文件）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T16:27:02.700

[Checkstyle](http://checkstyle.sourceforge.net/)工具，我通常在每次检入主分支后完成的每个持续集成构建中运行，它会告诉您任何给定的属性文件集是否具有不一致的属性集。当我第一次开始使用 Checkstyle 时，我确实发现我的一些属性文件缺少少量属性。

这对编辑器端没有帮助，但它*会*帮助您有效地识别任何差距。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T01:04:08.990

如果您使用的是 Eclipse，我发现 ResourceBundle Editor 插件非常方便。您可以同时编辑多个属性文件，当其中一个文件中缺少键时，您会收到警告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-25T06:33:00.990

还有许多 Web 应用程序允许您这样做（以及许多其他活动）。仅举几例：

*   [Amanuens](http://amanuens.com) (disclaimer: my company builds this product)
*   [Transifex](http://www.transifex.net)
*   [Get Localization](http://www.getlocalization.com)

# .net - ZedGraph (.NET) - 仅具有实际值的轴标签

> ID：907111
> 
> 赞同：1
> 
> 时间：2009-05-25T15:13:26.553
> 
> 标签：.net, winforms, controls, graph, zedgraph

使用[ZedGraph](http://zedgraph.org)控件，假设我正在绘制 Y 值为 13、34 和 55 的数据。

如何设置我的 Y 轴，以便显示的唯一文本标签（我猜网格线会同步）是 13、34 和 55 的那些？

我不希望在我的数据范围内有规则间隔的标签（比如 0、25、50、75 ......）。只需标记实际值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-23T13:28:04.067

我认为直接开箱即用是不可能的。

这是使用自定义 TextObj 标签创建的一些糟糕的半解决方案。

首先，您需要禁用旧的轴刻度：

```
zg1.MasterPane[0].YAxis.Scale.IsVisible = false;
zg1.MasterPane[0].YAxis.MajorTic.IsAllTics = false; 
```

然后，您需要创建自定义标签。如果 y_vals 是您的 Y 值数组：

```
foreach (double val in y_vals)
            {
                TextObj text = new TextObj(val.ToString(), zg1.MasterPane[0].XAxis.Scale.Min, val);
                text.Location.AlignH = AlignH.Right;
                text.FontSpec.Border.IsVisible = false;
                text.FontSpec.Fill.IsVisible = false;
                zg1.MasterPane[0].GraphObjList.Add(text); 
            } 
```

您可以使用 LineObj 以相同的方式创建自定义网格线。只需将其添加到 foreach 循环中：

```
LineObj line = new LineObj(zg1.MasterPane[0].XAxis.Scale.Min, val, zg1.MasterPane[0].XAxis.Scale.Max, val);
 line.Line.Style = System.Drawing.Drawing2D.DashStyle.Dash;
 line.Line.Width = 1f;
 zg1.MasterPane[0].GraphObjList.Add(line); 
```

# log4net - log4net：在数据库的一行中记录两条消息？

> ID：907120
> 
> 赞同：0
> 
> 时间：2009-05-25T15:16:25.177
> 
> 标签：log4net

我正在尝试将特定方法的输入和输出记录到数据库中。我想将这些信息放在单独的列中。我调查了 PatternLayout ，它似乎只满足一个 %message 参数，这意味着如果你这样做：

```
log.Debug("This is a message"); 
```

然后 log4net 将“这是一条消息”视为要记录的消息。我想做类似的事情：

```
log.Debug(request, response); 
```

这可以使用 log4net 吗？请记住，我的目标是将“请求”和“响应”放在**不同**的列中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T20:59:30.417

您的 PatternConverter 方式是朝着正确方向迈出的一步，尽管使用静态 Input 和 Output 属性使它有点不稳定（线程安全方面）。

这里的诀窍是要意识到 logger.Debug(...) 上的 message 参数是对象，并且您可以传入任何您喜欢的内容。

您可以定义自定义消息类型

```
public class InputOutput
{
    public string Input {get;set;}
    public string Output {get;set;}
} 
```

然后让您的转换器读取任一属性

```
public class InputPatternConverter : PatternConverter
{
    protected override void Convert(System.IO.TextWriter writer, object state)
    {
        var msg = ((LoggingEvent)state).MessageObject as InputOutput;
        if (msg != null)
            writer.Write(msg.Input);
    }
}

public class OutputPatternConverter : PatternConverter
{
    protected override void Convert(System.IO.TextWriter writer, object state)
    {
        var msg = ((LoggingEvent)state).MessageObject as InputOutput;
        if (msg != null)
            writer.Write(msg.Output);
    }
} 
```

然后伐木变得更干净

```
logger.Debug(new InputOutput { Input = ..., Output = ...}); 
```

你的配置是一样的。

一个提示是继承 PatternLayout 并在该类的构造函数中添加转换器。这样你也可以减少你的配置。这*不会*导致您丢失 %message 令牌，您的 %input 和 %output 令牌将与 PatternLayout 支持的所有令牌一起出现。所以你实际上可以有这样的模式：

```
"%date %message %newline%newline %input %newline%newline %output 
```

这是自定义模式布局的快速实现：

```
public class InputOutputPatternLayout : PatternLayout
{
    public InputOutputPatternLayout()
    {
        AddConverter("input", typeof(InputPatternConverter));
        AddConverter("output", typeof(OutputPatternConverter));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T18:01:25.533

我想出了一种使用自定义 PatternConverters 的方法

```
public class InputPatternConverter : PatternConverter
{
    private static string _input;

    public static string Input
    {
        get { return _input; }
        set { _input = value; }
    }

    protected override void Convert(System.IO.TextWriter writer, object state)
    {
        writer.Write(Input);
    }
}

public class OutputPatternConverter : PatternConverter
{
    private static string _output;

    public static string Output
    {
        get { return _output; }
        set { _output = value; }
    }

    protected override void Convert(System.IO.TextWriter writer, object state)
    {
        writer.Write(Output);
    }
} 
```

附加器规范：

```
<appender name="ADONetAppender" type="log4net.Appender.AdoNetAppender">
  <bufferSize value="1" />
  <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  <connectionString value="data source=servername;initial catalog=database;Integrated Security=SSPI;" />
  <commandText value="INSERT INTO RequestLog ([input], [output]) VALUES (@input, @output)" />
  <parameter>
    <parameterName value="@input" />
    <dbType value="String" />
    <size value="4000" />
    <layout type="log4net.Layout.PatternLayout">
      <converter>
        <name value="input" />
        <type value="InputPatternConverter, ApplicationName" />
      </converter>
      <conversionPattern value="%input" />
    </layout>
  </parameter>
  <parameter>
    <parameterName value="@output" />
    <dbType value="String" />
    <size value="4000" />
    <layout type="log4net.Layout.PatternLayout">
      <converter>
        <name value="output" />
        <type value="OutputPatternConverter, ApplicationName" />
      </converter>
      <conversionPattern value="%output" />
    </layout>
  </parameter>
</appender> 
```

调用它使用：

```
InputPatternConverter.Input = inputString;
OutputPatternConverter.Output = outputString;

XmlConfigurator.Configure();
ILog logger = LogManager.GetLogger(typeof(ApplicationClassName));
logger.Debug(""); 
```

# macos - 如何从 Mac OS X 交叉编译 PS3？

> ID：907132
> 
> 赞同：1
> 
> 时间：2009-05-25T15:21:21.077
> 
> 标签：macos, ps3

以前有没有人这样做过，如果是这样，你如何设置开发环境？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T15:37:20.647

您需要官方的 PS3 SDK，价格约为 10,000 美元。我敢肯定，它们包括所有说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T15:40:59.240

或者，PS3 确实支持 Linux（Fedora Core 8）；它不是世界上最新的发行版，但如果您想编写自己的针对 PS3 的代码，那么这是一个开始的地方。

# mercurial - Mercurial：从远程分支中删除变更集

> ID：907133
> 
> 赞同：22
> 
> 时间：2009-05-25T15:21:21.857
> 
> 标签：mercurial

有没有办法从远程变更集中删除，或者删除整个变更集？我不小心将`.war`文件推送到远程仓库，我想删除它。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-25T16:27:34.790

Mercurial 非常努力地保护您的数据安全，因此您通常不能更改历史记录。

话虽如此，Mercurial 有许多扩展，可以让你很容易地改变历史。wiki 上有一个[关于编辑历史的页面](https://www.mercurial-scm.org/wiki/EditingHistory)。该页面还解释了后果。

在您的具体情况下，您必须问自己其他人是否已经拉取了您的变更集？如果是这样，那么即使您将其删除，它仍然会存在于他们的克隆中，您最好接受这个错误。

如果您决定删除它，我建议您`hg clone`在没有它的情况下获取副本。这是安全的方法，因为它总是会留下备份。如果您推`[z]`送到远程存储库：

```
[x] --- [y] --- [z] 
```

现在想删除它，然后登录服务器并执行

```
hg clone -r y repo repo-without-z 
```

然后`repo-without-z`将包含所有更改，直到`[y]`- 即，`[z]`将被删除：

```
[x] --- [y] 
```

然后，您可以继续工作并推送新的变更集：

```
[x] --- [y] --- [w] 
```

如果我已经拉取了`[z]`变更集，现在拉取`[w]`，我将在存储库中看到两个头：

```
 [w]
           /
[x] --- [y] --- [z] 
```

这本身并不危险——但人们可能会感到惊讶。如果我`[z]`从我的克隆中删除，我最终会得到与你相同的存储库。但是，如上所述，如果您有很多用户，这可能是不切实际的。

您还可以使用[MQ 扩展](https://www.mercurial-scm.org/wiki/MqExtension)就地*剥离*变更集。这样你就不会做一个新的克隆。

最后，如果您确定推送是在服务器上完成的最后一个操作，那么`hg rollback`可以用来删除最后一个事务。但是，如果您是唯一可以推送到存储库的人，请不要这样做，否则您最终可能会回滚不同的事务。

如果存储库位于[Bitbucket](http://bitbucket.org/)上，则您无法登录服务器。但是 Bitbucket 最近在其 Web 界面中添加了条带功能。在“管理员”部分中查找“存储库管理”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-26T07:04:39.617

Bitbucket 确实在剥离时为您提供捆绑包（备份），这不**计入**您的配额。之所以会出现这种情况，只是因为我们没有使缓存键失效，指定您使用了多少空间。

这是我们系统中的一个错误，将予以修复。在那之前，请放心，变更集已被删除，并且备份是免费的 :-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T09:44:04.460

我使用 hg mqueue 扩展来编辑历史。似乎它奏效了。谢谢大家。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-14T04:01:57.923

我有一个类似的情况，我想使用 TortoiseHg 从“Dev”分支远程删除合并的分支“A”变更集：

1.  从分支 A 的父分支创建分支 AA；它的起源。
2.  将 A 合并到 AA（工作目录）并确保选中“放弃其他修订版的所有更改”选项。
3.  将 AA 合并到 Dev 分支（带有一条提交消息，表明分支 A 的更改已被删除）。

您会看到 Dev 中不再存在分支 A 的更改。

# winforms - 如何在 Windows Mobile 中设置 ListViewSubItem BackColor？

> ID：907134
> 
> 赞同：0
> 
> 时间：2009-05-25T15:22:01.997
> 
> 标签：winforms, windows-mobile, compact-framework, pinvoke

我想在 Windows Mobile 的 ListView 中更改 ListViewSubItem 的 BackgroundColor。我正在使用 Compact Framework ListView，它的 ListViewItems 只允许在整行上设置 BackColor，这是我不想要的。

我有两个问题：

1.  这可能吗？
2.  如果这是可能的，我*知道*我必须 P/Invoke 才能让它工作（因为 ListView.ListViewSubItem 只提供一个 Text 属性），或者发送正确的 Windows 消息。调用正确的函数或发送正确的消息是什么？

即使只是指向正确方向的指针也将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-09T15:50:18.040

Christian Helle[在这里展示了如何自定义绘制 CF ListViews](http://christian-helle.blogspot.com/2009/10/listview-custom-drawing-in-netcf.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T08:45:15.607

我的猜测是您需要自己绘制列表视图项；对主要项目使用默认绘画并为子项目执行您想要的操作，[MSDN example here](http://msdn.microsoft.com/en-us/library/aa446513.aspx#smartphoneuserinterface_topic9)或类似的东西。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-09-29T09:47:09.203

尝试启用owner-draw true ..并在drawingitem设置您自己的颜色..您将获得边界..绘制您自己的颜色

# iphone - 如何在 iPhone 上编写实时准确的音频音序器？

> ID：907137
> 
> 赞同：24
> 
> 时间：2009-05-25T15:22:35.180
> 
> 标签：iphone, audio, core-audio, timing, openal

我想在 iphone 上编写一个简单的音频音序器，但我无法获得准确的时间。最近几天我在 iphone 上尝试了所有可能的音频技术，从 AudioServicesPlaySystemSound 和 AVAudioPlayer 和 OpenAL 到 AudioQueues。

在我最后一次尝试中，我尝试了 CocosDenshion 声音引擎，它使用 openAL 并允许将声音加载到多个缓冲区中，然后在需要时播放它们。这是基本代码：

在里面：

```
int channelGroups[1];
channelGroups[0] = 8;
soundEngine = [[CDSoundEngine alloc] init:channelGroups channelGroupTotal:1];

int i=0;
for(NSString *soundName in [NSArray arrayWithObjects:@"base1", @"snare1", @"hihat1", @"dit", @"snare", nil])
{
    [soundEngine loadBuffer:i fileName:soundName fileType:@"wav"];
    i++;
}

[NSTimer scheduledTimerWithTimeInterval:0.14 target:self selector:@selector(drumLoop:) userInfo:nil repeats:YES]; 
```

在初始化中，我创建了声音引擎，将一些声音加载到不同的缓冲区，然后使用 NSTimer 建立音序器循环。

音频循环：

```
- (void)drumLoop:(NSTimer *)timer
{
for(int track=0; track<4; track++)
{
    unsigned char note=pattern[track][step];
    if(note)
        [soundEngine playSound:note-1 channelGroupId:0 pitch:1.0f pan:.5 gain:1.0 loop:NO];
}

if(++step>=16)
    step=0;

} 
```

就是这样，它可以正常工作，但是时间不稳定且不稳定。一旦发生其他事情（例如在视图中绘制），它就会不同步。

据我了解声音引擎和 openAL 缓冲区已加载（在 init 代码中），然后准备立即开始`alSourcePlay(source);`- 所以问题可能出在 NSTimer 上？

现在应用商店里有几十个音序器应用程序，它们都有准确的时间。即使在 180 bpm 的缩放和绘图完成时，Ig "idrum" 也具有完美的稳定节拍。所以必须有解决办法。

有人知道吗？

提前感谢您的帮助！

此致，

瓦尔基

* * *

感谢您的回答。它让我更进一步，但不幸的是没有达到目标。这是我所做的：

```
nextBeat=[[NSDate alloc] initWithTimeIntervalSinceNow:0.1];
[NSThread detachNewThreadSelector:@selector(drumLoop:) toTarget:self withObject:nil]; 
```

在初始化中，我存储下一个节拍的时间并创建一个新线程。

```
- (void)drumLoop:(id)info
{
    [NSThread setThreadPriority:1.0];

    while(1)
    {
        for(int track=0; track<4; track++)
        {
            unsigned char note=pattern[track][step];
            if(note)
                [soundEngine playSound:note-1 channelGroupId:0 pitch:1.0f pan:.5 gain:1.0 loop:NO];
        }

        if(++step>=16)
            step=0;     

        NSDate *newNextBeat=[[NSDate alloc] initWithTimeInterval:0.1 sinceDate:nextBeat];
        [nextBeat release];
        nextBeat=newNextBeat;
        [NSThread sleepUntilDate:nextBeat];
    }
} 
```

在序列循环中，我将线程优先级设置得尽可能高，然后进入无限循环。播放完声音后，我计算下一个节拍的下一个绝对时间，并让线程进入睡眠状态，直到此时。

这再次起作用，并且它比我在没有 NSThread 的情况下的尝试更稳定，但如果发生其他事情，它仍然不稳定，尤其是 GUI 的东西。

有没有办法在 iPhone 上使用 NSThread 获得实时响应？

此致，

瓦尔基

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-25T15:31:49.997

NSTimer 绝对不能保证它何时触发。它在 runloop 上安排自己的触发时间，当 runloop 到达计时器时，它会查看是否有任何计时器过期。如果是这样，它会运行它们的选择器。非常适合各种任务；对这个没用。

此处的第一步是您需要将音频处理移至其自己的线程并脱离 UI 线程。对于计时，您可以使用普通的 C 方法构建自己的计时引擎，但我会先查看 CAAnimation，尤其是 CAMediaTiming。

请记住，Cocoa 中有很多东西是设计为只在主线程上运行的。例如，不要在后台线程上做任何 UI 工作。一般来说，请仔细阅读文档以了解他们对线程安全的看法。但一般来说，如果线程之间没有太多的通信（在大多数情况下不应该有），线程在 Cocoa 中非常容易。看看 NSThread。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-07-26T05:54:07.273

我正在使用 remoteIO 输出做类似的事情。我不依赖 NSTimer。我使用渲染回调中提供的时间戳来计算我的所有时间。我不知道 iphone 的 hz 频率有多准确，但我确定它非常接近 44100hz，所以我只是根据当前的样本数来计算我应该何时加载下一个节拍。

可以在[此处](http://sites.google.com/site/iphoneappcoder/iphone-wav-file-playback)找到使用远程 io 的示例项目，查看渲染回调 inTimeStamp 参数。

编辑：这种方法的工作示例（在应用商店，可以在[这里](http://darktrain.net.au/tekkit)找到）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-06T17:00:25.913

我选择使用 RemoteIO AudioUnit 和使用 AudioFileServices API 填充摆动缓冲区（一个用于读取，一个用于写入，然后交换）的后台线程。然后在 AudioUnit 线程中处理和混合缓冲区。AudioUnit 线程在应该开始加载下一个摆动缓冲区时向 bgnd 线程发出信号。所有的处理都在 C 中并使用了 posix 线程 API。所有 UI 的东西都在 ObjC 中。

IMO，AudioUnit/AudioFileServices 方法提供了最大程度的灵活性和控制。

干杯，

本

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-15T05:15:10.430

您在这里得到了一些很好的答案，但我想我会提供一些代码来解决对我有用的问题。当我开始研究这个时，我实际上是在寻找游戏中的运行循环是如何工作的，并找到了一个很好的解决方案，它对我使用`mach_absolute_time`.

[您可以在此处](http://shiftedbits.org/2008/10/01/mach_absolute_time-on-the-iphone/)阅读有关它的作用的一些信息，但不足之处在于它以纳秒精度返回时间。但是，它返回的数字并不是时间，它会随着你拥有的 CPU 而变化，所以你必须先创建一个`mach_timebase_info_data_t`结构，然后用它来标准化时间。

```
// Gives a numerator and denominator that you can apply to mach_absolute_time to
// get the actual nanoseconds
mach_timebase_info_data_t info;
mach_timebase_info(&info);

uint64_t currentTime = mach_absolute_time();

currentTime *= info.numer;
currentTime /= info.denom; 
```

如果我们希望它每 16 个音符打勾，你可以这样做：

```
uint64_t interval = (1000 * 1000 * 1000) / 16;
uint64_t nextTime = currentTime + interval; 
```

此时，`currentTime`将包含一些纳秒数，并且您希望每次`interval`经过纳秒时它都会打勾，我们将其存储在`nextTime`. 然后，您可以设置一个 while 循环，如下所示：

```
while (_running) {
    if (currentTime >= nextTime) {
        // Do some work, play the sound files or whatever you like
        nextTime += interval;
    }

    currentTime = mach_absolute_time();
    currentTime *= info.numer;
    currentTime /= info.denom;
} 
```

这些`mach_timebase_info`东西有点令人困惑，但是一旦你把它放在那里，它就会很好用。它对我的应用程序来说非常高效。还值得注意的是，您不想在主线程上运行它，因此将其放到自己的线程中是明智的。你可以把上面所有的代码放在它自己的方法`run`中，然后用类似的东西开始它：

```
[NSThread detachNewThreadSelector:@selector(run) toTarget:self withObject:nil]; 
```

你在这里看到的所有代码都是我开源的一个项目的简化，你可以[在这里](https://github.com/pwightman/BBGroover/blob/master/BBGroover/Grooving/BBGroover.m)看到并自己运行它，如果有帮助的话。干杯。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-17T17:11:28.280

真正接近时间的最精确方法是计算音频样本并在经过一定数量的样本后执行您需要做的任何事情。无论如何，您的输出采样率是与声音相关的所有事物的基础，因此这是主时钟。

您不必检查每个样本，每隔几毫秒执行一次就足够了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-28T15:14:34.460

如果提前构建序列不是限制，则可以使用 AVMutableComposition 获得精确的时序。这将在 1 秒内均匀地播放 4 个声音：

```
// setup your composition

AVMutableComposition *composition = [[AVMutableComposition alloc] init];
NSDictionary *options = @{AVURLAssetPreferPreciseDurationAndTimingKey : @YES};

for (NSInteger i = 0; i < 4; i++)
{
  AVMutableCompositionTrack* track = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
  NSURL *url = [[NSBundle mainBundle] URLForResource:[NSString stringWithFormat:@"sound_file_%i", i] withExtension:@"caf"];
  AVURLAsset *asset = [AVURLAsset URLAssetWithURL:url options:options];
  AVAssetTrack *assetTrack = [asset tracksWithMediaType:AVMediaTypeAudio].firstObject;
  CMTimeRange timeRange = [assetTrack timeRange];

  Float64 t = i * 1.0;
  NSError *error;
  BOOL success = [track insertTimeRange:timeRange ofTrack:assetTrack atTime:CMTimeMake(t, 4) error:&error];
  NSAssert(success && !error, @"error creating composition");
}

AVPlayerItem* playerItem = [AVPlayerItem playerItemWithAsset:composition];
self.avPlayer = [[AVPlayer alloc] initWithPlayerItem:playerItem];

// later when you want to play 

[self.avPlayer seekToTime:kCMTimeZero];
[self.avPlayer play]; 
```

此解决方案的原始信用：http: [//forum.theamazingaudioengine.com/discussion/638#Item_5](http://forum.theamazingaudioengine.com/discussion/638#Item_5)

更多细节：[使用 AVMutableComposition 进行精确计时](https://stackoverflow.com/questions/25416789/precise-timing-with-avmutablecomposition)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-16T20:46:50.357

可以提高实时响应能力的另一件事是在激活音频会话之前将音频会话的 kAudioSessionProperty_PreferredHardwareIOBufferDuration 设置为几毫秒（例如 0.005 秒）。这将导致 RemoteIO 更频繁地请求更短的回调缓冲区（在实时线程上）。不要在这些实时音频回调中花费任何时间，否则您将终止应用程序的音频线程和所有音频。

与使用 NSTimer 相比，仅计算较短的 RemoteIO 回调缓冲区的准确度和延迟要低 10 倍左右。并且在音频回调缓冲区中计数样本以定位混音的开始将为您提供亚毫秒的相对时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-05T16:50:15.540

通过测量循环中“做一些工作”部分所用的时间并从 nextTime 中减去此持续时间，可以大大提高准确性：

```
while (loop == YES)
{
    timerInterval = adjustedTimerInterval ;

    startTime = CFAbsoluteTimeGetCurrent() ;

    if (delegate != nil)
    {
        [delegate timerFired] ; // do some work
    }

    endTime = CFAbsoluteTimeGetCurrent() ;

    diffTime = endTime - startTime ; // measure how long the call took. This result has to be subtracted from the interval!

    endTime = CFAbsoluteTimeGetCurrent() + timerInterval-diffTime ;

    while (CFAbsoluteTimeGetCurrent() < endTime)
    {
        // wait until the waiting interval has elapsed
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-26T05:59:55.840

我认为更好的时间管理方法是设置 bpm 设置（例如 120），然后取消设置。在编写/制作音乐/音乐应用程序时，分钟和秒的测量几乎没有用。

如果您查看任何排序应用程序，它们都按节拍而不是时间进行。另一方面，如果您查看波形编辑器，它会使用分钟和秒。

我不确定以任何方式以代码方式实现此代码的最佳方法，但我认为这种方法将为您省去很多麻烦。

# .net - 即使预期和实际相同，Assert.AreEqual 也会失败

> ID：907142
> 
> 赞同：1
> 
> 时间：2009-05-25T15:23:57.080
> 
> 标签：.net, unicode

我有以下测试，它似乎产生相同的字符串，但 Assert.AreEqual 失败。

```
[TestMethod]
public void Decompressed_test_should_equal_to_text_before_compression()
{
    TextCompressor compressor = new TextCompressor();
    Random r = new Random((int)DateTime.Now.Ticks);

    for (int i = 500; i < 1500; i++)
    {
        char[] testArray = new char[i];

        for (int j = 0; j < i; j++)
        {                    
            char randomChar = (char)(r.Next(256, 65536));
            testArray[j] = randomChar;
        }
        string testString = new String(testArray);
        string compressed = compressor.Compress(testString);
        string decompressed = compressor.Decompress(compressed);

        Assert.AreEqual(testString.Length, decompressed.Length);
        Assert.AreEqual(testString, decompressed, false, CultureInfo.InvariantCulture);
    }
} 
```

compressor.Compress 和compressor.Decompress 使用GZipStream 进行一些压缩和解压缩。

如果我尝试 (65, 90) 而不是 (256, 65536) 它会通过，所以我猜它与 unicode 有关。我尝试了 CurrentCulture 并且根本没有文化而不是 InvariantCulture ，但它仍然失败。但生成的字符串似乎是相同的：

Assert.AreEqual 失败。

预期的：

<☔鎷얚疉鎷얚跨꿌沩얫ວ֨ز얫座֨ز嵜浮䑹ﴰ霭斳薃픢萁⯬쫎ʛ萁⯬쫎ʛ躥躝躝躥☽☆๢뇌䆆☆퐟큀뇌丑멆큀뇌 㴝峳뿝嘼ᷨ㗬꺬櫣涷꠶浒滅က㷕䩉毎覛�⧹䮯嬇힚艐Ὑ쇕횻鸙蹻硐��䈜칠桐��䈜칠桐��䈆얈⸛㈵⺴섬 ⏠ﻪ폫ﺍ琖ퟰ乼�쩐鑈푷᫇﯎蕱늛�쭡�䙠ⲓᒇꪮ툅⃑ꦴ돻♹ᢋ马斯克熪뚭ЎЎጚ笕娯钮⡃㪿䓜俕ￕ⤩㥍蝳分鰽䠺ꭍ튘폻⥽ⳉ历⹼驿똮�⯴⋟Ḋ᛼룴꣜墭䐣앾郢�ᵸᮄ杗夺騑硼烑鄗峍튘폻⥽炬ಘ핲愢彽炁ಘム젥풼ಃ斗斗斗瀃碂밎崹䎐貇஛汫踖�뢸숥퍞르뗿䭯䖝䱅�䵱꽔븽䢴ꁅ⟼�蒠癸癸ꩽ靔䚝﹗⩏￸鍁Ꮨ䷇쁐쨒ʃ서䷇쁐쨒ʊ서䷇쁐쨒ʃ섩혨❶㮼뇄』㕾桠鯅蛰䠿豱䠿櫄픆车똅렬㈆ﹼἋ녴렬㎖랆Ἃ녴랆䝷핸⹝碎屑怀笠猔勋绉⹝碎碎屑怀猔勋牉퀪ꖋꖋⓋ⍙ಗ䤮ꌮ덿 ᆯ콧逼ﺯ븭碇쮢籍⁜왋壝骂暷샖଄ࣵ舻᜝䃴厫ᢉ涶欋옭螶溘欋옭螶䦗跠﨔膉痹邘⋫吪멚埣ꯕ扌옘犸畅몡ↇ꠫褴픧ၥ帻놤ਰ惘똞崩籴쫼鿋䬝获⺁峁踷锝副鰀唝⹀谲迟䩢푑팾��糔뭯዇ࣷ䷴䋾갩ⶶ㵻恬҅པᣄⲪ豩뛌꛵㥨몙〼△⏮큤�亃ꢡ웼ఐ칇뻻펂㢓吋䂃䨠䕱>。

实际的：

<☔鎷얚疉鎷얚跨꿌沩얫ວ֨ز얫座֨ز嵜浮䑹ﴰ霭斳薃픢萁⯬쫎ʛ萁⯬쫎ʛ躥躝躝躥☽☆๢뇌䆆☆퐟큀뇌丑멆큀뇌 㴝峳뿝嘼ᷨ㗬꺬櫣涷꠶浒滅က㷕䩉毎覛�⧹䮯嬇힚艐Ὑ쇕횻鸙蹻硐��䈜칠桐��䈜칠桐��䈆얈⸛㈵⺴섬 ⏠ﻪ폫ﺍ琖ퟰ乼�쩐鑈푷᫇﯎蕱늛�쭡�䙠ⲓᒇꪮ툅⃑ꦴ돻♹ᢋ马斯克熪뚭ЎЎጚ笕娯钮⡃㪿䓜俕ￕ⤩㥍蝳分鰽䠺ꭍ튘폻⥽ⳉ历⹼驿똮�⯴⋟Ḋ᛼룴꣜墭䐣앾郢�ᵸᮄ杗夺騑硼烑鄗峍튘폻⥽炬ಘ핲愢彽炁ಘム젥풼ಃ斗斗斗瀃碂밎崹䎐貇஛汫踖�뢸숥퍞르뗿䭯䖝䱅�䵱꽔븽䢴ꁅ⟼�蒠癸癸ꩽ靔䚝﹗⩏￸鍁Ꮨ䷇쁐쨒ʃ서䷇쁐쨒ʊ서䷇쁐쨒ʃ섩혨❶㮼뇄』㕾桠鯅蛰䠿豱䠿櫄픆车똅렬㈆ﹼἋ녴렬㎖랆Ἃ녴랆䝷핸⹝碎屑怀笠猔勋绉⹝碎碎屑怀猔勋牉퀪ꖋꖋⓋ⍙ಗ䤮ꌮ덿 ᆯ콧逼ﺯ븭碇쮢籍⁜왋壝骂暷샖଄ࣵ舻᜝䃴厫ᢉ涶欋옭螶溘欋옭螶䦗跠﨔膉痹邘⋫吪멚埣ꯕ扌옘犸畅몡ↇ꠫褴픧ၥ帻놤ਰ惘똞崩籴쫼鿋䬝获⺁峁踷锝副鰀唝⹀谲迟䩢푑팾��糔뭯዇ࣷ䷴䋾갩ⶶ㵻恬҅པᣄⲪ豩뛌꛵㥨몙〼△⏮큤�亃ꢡ웼ఐ칇뻻펂㢓吋䂃䨠䕱>。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T15:31:01.933

`(char)(r.Next(256, 65536))`会产生无效的字符组合，导致非法文本，所以不能用它来创建测试内容。即使演员阵容有效并且产生了有效字符，这种情况也可能发生。一个例子是 U+D800 到 U+DFFF 的代理，但可能还有其他的。

如果要从所有 Unicode 范围生成示例文本，则在创建它时必须了解 Unicode，而不仅仅是将随机转换为`char`. （我认为当您在问题中说当您为随机数提供更窄的范围时它起作用时，您会想到这一点。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T15:27:54.420

`byte`不使用`char`。

您的`Compress/Decompress`方法应该采用一个`byte[]`数组，并且无论调用它们什么都应该读取您的 Unicode 数据并在调用它们之前对其进行转换。

您知道 .NET 2.0 及更高版本包含[GZipStream](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)类吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T15:47:01.580

做了一些实验：

```
string testString = new String(testArray);
string anotherString = new String(testArray);
Assert.AreEqual(testString.Length, anotherString.Length);
Assert.AreEqual(testString, anotherString, false, CultureInfo.InvariantCulture); 
```

这是没有压缩的。它工作正常。

我建议您将测试更改为：

```
for (int i = 256; i < 65536; i++)
{
  string testString = new String((char)(i), 2);

  string compressed = compressor.Compress(testString);
  string decompressed = compressor.Decompress(compressed);

  Assert.AreEqual(testString.Length, decompressed.Length);
  Assert.AreEqual(testString, decompressed, false, CultureInfo.InvariantCulture);
} 
```

这一次只测试一个字符，你没有随机值（没有“有时有效”的问题），你会看到是否有某种字符不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-28T12:06:06.120

我对加密/解密有相同的测试。

使用二分法，我发现任何包含 U+55296 到 U+57343 范围内的 Unicode 字符的“代理代码点”的字符串都将使用 Assert.AreEqual 失败

所以你可以使用的最广泛的范围是：

```
char randomChar = (char)(r.Next(0, 55295)); 
```

和

```
char randomChar = (char)(r.Next(57344, 65535)); 
```

# php - 用于运行 PHP+Erlang 的 Web 服务器

> ID：907144
> 
> 赞同：4
> 
> 时间：2009-05-25T15:25:23.097
> 
> 标签：php, erlang, webserver

我希望在 Web 服务器上运行 PHP 和 Erlang。Apache 被排除在外，因为后端 Erlang 进程需要同时处理大约 3000 个请求。所以肯定是内存占用较小的东西，比如 lighttpd ......

你会推荐哪一个？为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T15:31:27.063

Erlang 有内置的网络服务器：

[http://yaws.hyber.org/](http://yaws.hyber.org/)

你可以使用哪个。它应该非常非常快。

如果你想将 Erlang 暴露在网络上，Yaws 是要走的路（只是学习 Erlang，所以这可能是不正确的）

**编辑**：

经过一番挖掘，我发现 Erlang 网络服务器（Yaws）可以运行 PHP 脚本。所以你的答案是一个 Erlang 网络服务器！

[http://yaws.hyber.org/cgi.yaws](http://yaws.hyber.org/cgi.yaws)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T23:05:33.080

如果没有更多信息，很难回答这个问题。你想用 erlang 和 php 做什么？php 是后端 erlang 进程的前端吗？或者 erlang 也会做一些前端？

我见过人们在 erlang 和 fastcgi 之前使用 nginx 做得很好。您可以通过 fastcgi 运行 php，并使用 nginx 进行转发。如果没有更多信息，很难说更多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-18T22:28:44.657

用你喜欢的任何东西（我希望是apache）运行你的php前端，并与你的erlang作为后端进行通信。

读：

[http://www.erlang-factory.com/upload/presentations/117/Todd-Lipcon-ErlangFactoryLondon2009-BuildingMulti-LanguageWebArchitecturesusingErlangandThrift.pdf](http://www.erlang-factory.com/upload/presentations/117/Todd-Lipcon-ErlangFactoryLondon2009-BuildingMulti-LanguageWebArchitecturesusingErlangandThrift.pdf)

基本上讲了如何运行一个 php 前端，因为它擅长字符串，模板设计者使用 erlang 后端“得到它”，因为它擅长并发等。然后他用 thrifty 将它们粘合在一起

最佳报价

> PHP 糟糕的地方就是 Erlang 擅长的地方！我反之亦然！

# c# - C#：获取 gtk#-buttons 数组中按下了哪个按钮？

> ID：907147
> 
> 赞同：1
> 
> 时间：2009-05-25T15:26:02.440
> 
> 标签：c#, arrays, events, button, gtk#

我有一个按钮数组，它们都应调用相同的方法，但将按钮的索引作为参数。

```
using System;
using Gtk;

public class Input : Gtk.Window {

    private Gtk.Button[] plus;

    public Input() : base(Gtk.WindowType.Toplevel) {

        plus = new Button[10]; 
```

[...]

```
 for (uint i = 0; i < 10; i++) {
            plus[i] = new Button();
            plus[i].Name = i.ToString();
            plus[i].ButtonPressEvent += AddButtonPressed;
        }
    } 
```

我尝试使用这种方法，但似乎它甚至没有被调用，因为没有输出：

```
 protected virtual void AddButtonPressed(object sender, System.EventArgs e) {
        Console.WriteLine("Button pressed");
        for (uint i = 0; i < plus.Length; i++) {
        if (sender.Equals(plus[i])) {
            uint index = i;
            i = (uint)plus.Length;
            Console.WriteLine(index);
        }
    } 
```

也许有人可以指出我正确的方向？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T17:09:03.547

快速回答：

```
[GLib.ConnectBefore]
protected virtual void AddButtonPressed(object sender, EventArgs e)     {
    Console.WriteLine("Button pressed");
    for (uint i = 0; i < plus.Length; i++) {
        if (sender.Equals(plus[i])) {
        uint index = i;
        i = (uint)plus.Length;
        Console.WriteLine(index);
        }
    }
} 
```

乱七八糟的解释：

这实际上是一个有趣的问题。花了一些时间寻找，但[GTK# 的常见问题解答](http://gtk-sharp.sourceforge.net/faq.html#3.3)（但我猜不经常链接到）说，

> “从 0.15 版开始，Gtk# 在将事件处理程序连接到信号时开始使用 CONNECT_AFTER 标志。这意味着事件处理程序在默认信号处理程序之后才会运行，这意味着小部件将在事件处理程序运行时更新。此更改的副作用是在默认处理程序返回 true 以停止信号传播的情况下，将不会发出 Gtk# 事件。例如在 Gtk.Button 中就是这种情况，其中按钮按下事件默认信号处理程序被覆盖以发出 Pressed 事件。
> 
> 虽然可能令人困惑，但这并不是一个真正的错误。当您使用 Gtk.Button 时，您将获得一个小部件，该小部件会发出 Pressed 事件以响应 Button1 的按下。如果您还希望您的 Button 更改颜色，或在 Button3 按下时弹出上下文菜单，那不是 Gtk.Button。实现这样一个小部件的正确方法是继承 Gtk.Button 并覆盖 OnButtonPressEvent 虚拟方法以实现您想要的新行为。”

如果不是因为“公众的强烈抗议”（很少是一个好的接口的标志），就没有办法避免这种情况，除了子类化，在 C# 中由于缺少匿名类有时很烦人。但幸运的是，您不是第一个遇到此问题的人。这就是 GLib.ConnectBefore 属性的用武之地。它基本上说，首先调用这个事件处理程序，这样事件就不会被 Gtk+ 吞噬。

然而，烦恼并没有就此结束。我最初打算建议应用一个经过验证的良好解决方案来将“额外”参数传递给事件处理程序。在这种情况下，这将允许您在不使用 equals 或字符串的情况下找到索引`Name`它基本上涉及创建一个包装委托，该委托“假装”为 ButtonPressEventHandler 但在内部将一个 int 传递给您的支持方法：

```
 Func<uint, ButtonPressEventHandler> indexWrapper = ((index) => ((s, e) => { AddButtonPressed_wrapped(s, e, index); }));   

    ...

    plus[i].ButtonPressEvent += indexWrapper(i);

    ...

    protected virtual void AddButtonPressed_wrapped(object sender, EventArgs e, uint index)
    {
      Console.WriteLine("Button pressed");
      Console.WriteLine("Index = {0}", index);
    } 
```

它编译并运行没有错误，但它有同样的问题，事件永远不会触发。我意识到您不能将属性直接放在委托/lambda 上。因此，即使支持方法没有`[GLib.ConnectBefore]`委托，它也会失败。

最后一点，您可以像在[此 API 示例](http://www.go-mono.com/docs/index.aspx?tlink=root:/classlib-gnome)中一样使用 Clicked 事件。我确认它按预期工作。人们会认为它只会在单击鼠标时触发，但实际上它也会在空格键上触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-11T07:15:41.107

```
for (uint i = 0; i < 10; i++) 
{
    plus[i] = new Button();
    plus[i].Data.Add("Index",i);
    plus[i].ButtonPressEvent += AddButtonPressed;
    Add(plus[i]);
} 
```

处理程序：

```
protected virtual void AddButtonPressed(object sender, System.EventArgs e) {
   Console.WriteLine("Button pressed");
   Gtk.Button button = sender as Gtk.Button;
   Console.WriteLine("Index: {0}", button.Data["Index"]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T15:33:52.270

我相当确定您需要将按钮实际添加到 GTK 窗口层次结构中，例如：

```
 for (uint i = 0; i < 10; i++) {
        plus[i] = new Button();
        plus[i].Name = i.ToString();
        plus[i].ButtonPressEvent += AddButtonPressed;
        Add(plus[i]);
    } 
```

应该与此类似，从未实际使用过 GTK <.<

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T16:00:55.993

使用 Tag 属性，如果 Gtk 按钮有一个。

```
for (uint i = 0; i < 10; i++) {
    plus[i] = new Button();
    plus[i].Name = i.ToString();
    plus[i].ButtonPressEvent += AddButtonPressed;
    plus[i].Tag = i;
    Add(plus[i]);
} 
```

处理程序：

```
protected virtual void AddButtonPressed(object sender, System.EventArgs e) {
   Console.WriteLine("Button pressed");
   Gtk.Button button = sender as Gtk.Button;
   Console.WriteLine("Index: {0}", button.Tag);
} 
```

# c# - C# 资源文件中的制表符

> ID：907150
> 
> 赞同：10
> 
> 时间：2009-05-25T15:27:52.220
> 
> 标签：c#, visual-studio, string

如何将 TAB (\t) 添加到字符串资源？

"\tText" 不起作用

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-25T15:39:49.413

您必须显式添加选项卡。最简单的方法可能是在记事本中输入您的字符串（显式设置选项卡而不是使用转义字符）并将文本复制并粘贴到资源编辑器中。

您将遇到与换行符类似的问题，添加它们的最简单方法是 - 再次 - 使用 shift-enter 组合键显式添加换行符。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-25T15:42:42.987

我知道您有两个选择：

1) 读取资源字符串后进行字符串替换： s = s.Replace("\\t","\t");

2) 在创建时通过在数字键盘上键入 Alt-012（我认为是选项卡）将转义序列直接输入到您的资源字符串中。

文章在[这里](http://www.devx.com/tips/Tip/31408)和[这里](http://www.devx.com/tips/Tip/34769)是一样的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-22T15:22:48.163

使用 Tab 的 Alt 代码 (Alt + 009) 使用 Shift + Return 添加换行符。

1）在VS中打开资源文件。2) 将光标放在您想要 Tab 字符的位置 3) 按住 Alt 键 4) 按数字键盘上的 0、0、9。5）放开alt键。

当您单击资源字符串时，您将看到选项卡从显示中删除，请放心，它们仍然存在。这可以通过打开 Resources.Designer.cs 并查看资源字符串的注释并突出显示插入选项卡的区域来验证。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-22T20:27:10.110

自上次修改此线程以来已经将近六年了，使用转义的建议仍然占据主导地位。值得一提的是，今天早些时候，我从 C# 字符串常量中复制了一些文本到资源字符串编辑器中，并且选项卡被空格替换。但是，由于代码希望看到实际的制表符，因此它抛出了 InvalidOperationException（我的代码，我的异常！）。我再次回到选项卡，遵循 DevX 文章“另一种在 .NET 资源文件中转义序列的方法”中的出色说明，在已接受答案的第二个引用中提到。

道德：不要指望 Windows 剪贴板忠实地复制您的文本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T15:40:29.677

您是否尝试过 XML 制表符？

抱歉，我的标签字符没有显示！一定是被浏览器吃掉了。

```
&#x9; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T19:14:36.247

\t 确实添加了一个 ascii 选项卡，但如果您在 html 页面中显示此选项卡，除了页面源代码之外，您将看不到该选项卡。HTML 不会将制表符或换行符呈现为不间断空格。显示时，它们都会减少到 1 个空格字符。不建议使用空格格式化 HTML，这就是带有 CSS 的 div 甚至 Table 的用途。如果您必须在 HTML 中添加额外的空格，请使用   反复，但它不会是正确的制表位，如果你复制和粘贴，会造成一场噩梦。

或者，您可以在只读文本区域中显示您的字符串数据。这将保留您的字符串格式。在不知道您要如何处理字符串或如何创建字符串的细节的情况下，这些是我能给您的最佳建议。

您也可以创建一个变量，但 \t 内联工作。

```
string TAB = char.ConvertFromUtf32(9).ToString(); 
```

# visual-studio-2008 - 如何使用 VS 2008 打开 VS 2005 解决方案？

> ID：907154
> 
> 赞同：0
> 
> 时间：2009-05-25T15:28:28.660
> 
> 标签：visual-studio-2008, visual-studio-2005

当我尝试在 2008 年打开之前使用 VS 2005 创建的解决方案时，我在 VS 中收到此错误消息：

* * *

## 微软视觉工作室

未安装项目“C:\myProject.csproj”的应用程序。

## 确保已安装项目类型 (.csproj) 的应用程序。

## 确定 帮助

如何让VS 2008开启2005解决方案？我错过了做某事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T15:31:34.210

正如错误消息已经表明的那样：您是否检查过 Visual Studio 的所有组件都已安装？重新运行安装程序并确保选择选项*Complete*。

可以在不支持 C# 项目的情况下安装 VS，所以这可能是这里缺少的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T15:32:44.503

VS 2008 应该能够毫无问题地打开 VS 2005 解决方案（应该会弹出一个将您的 VS 2005 解决方案转换为 VS 2008 解决方案的向导）。如果您想要解决您的问题，您可能需要提供更多信息（例如，这是 VS Professional 还是 Express？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T15:34:12.643

您需要下载并安装[Visual Studio 转换向导。](http://msdn.microsoft.com/en-us/library/60z6y467.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T19:13:44.690

这个**[问题](https://stackoverflow.com/questions/340138/why-is-visual-studio-not-able-to-open-csproj-files)**并在运行中运行它的答案中的命令后，一切正常

# c# - 如何确定方法是否以解耦方式在 UI 线程上执行？

> ID：907166
> 
> 赞同：6
> 
> 时间：2009-05-25T15:34:26.963
> 
> 标签：c#, .net, wpf, ui-thread

这是我遇到的问题：我需要确保在 UI 线程上实例化了一个对象。如果不是，它应该抛出异常。但是如何在方法内部检查它是否在 UI 线程上运行？注意：我不想将任何信息传递给对象的构造函数。

完美的候选者将是 DispatcherSynchronizationContext（SynchronizationContext 的 WPF 实现），它在内部保存对 Dispatcher 的引用，该引用引用了与其关联的线程，但不幸的是，该字段是私有的，因此我无法访问它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-25T16:16:58.443

小澄清，虽然通常只有 1 个 UI 线程，但可以有很多 UI 线程。WPF 和 WinForms 都是如此。

我发现实现这一目标的最佳方法是使用 SynchronizationContext。WPF 和 WinForms 都将在它们运行 UI 的任何线程上建立 SynchronizationContext。如果我没有绑定到任何特定的 UI 模型，这就是我使用的功能。

```
public bool IsPossiblyUIThread() {
  return SynchronizationContext.Current != null;
} 
```

请注意，它绝不是万无一失的。非 UI 组件可以建立 SynchronizationContext，这对于简单的工作线程将返回 true。因此，非权威名称。

一种*稍微*更可靠的方法如下。但它要求您至少引用 WPF 的一部分来实现。

```
public bool IsLikelyWpfUIThread() {
  var context = SynchronizationContext.Current;
  return context != null && context is DispatcherSynchronizationContext;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T16:18:33.857

如果您的代码在与 Dispatcher 相同的线程上运行，则[Dispatcher.CheckAccess()返回 true。](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.checkaccess.aspx)如果只有一个 Dispatcher/UIThread，它应该可以工作。

# php - 使用 PHP 和 Smarty 的动态内容

> ID：907167
> 
> 赞同：1
> 
> 时间：2009-05-25T15:34:35.263
> 
> 标签：php, localization, smarty

我正在使用 Smarty 并利用 config_load 各自的`{#VAR#}`变量来实现本地化。只要内容在模板中，它就可以很好地工作，但是一旦我必须在 TPL 文件中添加动态内容就会失败，即：

```
{if isset($var) }
    {foreach from=$var item=line}
        {$line}<br>
    {/foreach}
{/if} 
```

请注意，$var 中的每个条目通常都包含一个`{#VAR#}`条目——它们**没有被翻译**（用户将看到`{#VAR#}`）。

在这种情况下实施本地化的正确方法是什么？

* * *

**解决方案**

最后我只用以下代码替换`{$line}<br>`了上面的代码：

```
{eval var=$line} 
```

这对我有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-09T02:24:24.993

我见过的一个很好的方法是使用修饰符进行翻译。这允许您翻译动态内容。

所有的代码只是一个例子，不会工作，只是为了给你一个想法

让我们说

## 你的tpl

```
{"Hello word! How are you %s?"|translate:"Gabriel"}

{$myvar|translate:"Gabriel"} 
```

## 你的修饰符

```
function smarty_modifier_translate($content, $args) {
  $lang = Env::getLanguage();
  return vsprintf($lang->getTranslation($content), $args);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T19:28:44.047

您可能正在寻找类似 {eval} 的东西

查看[{eval}](http://www.smarty.net/manual/en/language.function.eval.php)文档。

根据你的情况，你可以试试这个：

# 例子.php

```
<?php
  (...)
  $var = array("{#OK#}", "{#CANCEL#}");
  $smarty->assign('var', $var);
  $smarty->display('example.tpl');
?> 
```

# 例子.config

```
OK = Okay
CANCEL = Nevermind 
```

# 例子.tpl

```
{config_load file='example.config'}

<h1>Template stuff</h1>

{if isset($var) }
  {foreach from=$var item=line}
    {eval var=$line}<br>
  {/foreach}
{/if} 
```

希望有帮助！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:38:24.200

您可能注意到 smarty 将您的模板解析为 php 代码并将其存储在 templates_c 目录中。它使这个库运行得非常快。您要完成的工作需要在每次执行循环代码时解析一个全新的模板。这会使您的应用程序非常缓慢。

我建议不要将消息存储在常量中，而是将其存储在模板中，例如。

```
{assign var='lang' value='en'}
{if isset($var) }
    {foreach from=$var item=line}
        {include file="$lang/$line.tpl"}<br>
    {/foreach}
{/if} 
```

# algorithm - 估计单词复杂度的算法

> ID：907168
> 
> 赞同：5
> 
> 时间：2009-05-25T15:34:43.487
> 
> 标签：algorithm

我需要为打字员估计单词的复杂性。例如，“suffer”比“people”容易，因为“o”和“p”比“e”和“r”更难。小指按下的任何键都比食指更难击中。并且从基本位置移动手指比不移动更难。并且使用 shift 键还可以增加硬度。

在这种情况下可以实施什么方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-25T15:40:44.310

我会查看[Carpalx 网站](http://mkweb.bcgsc.ca/carpalx/)。该网站详细介绍了他们如何为打字员评估不同的键盘布局，并且已经有一些开源软件可以为任何给定的键盘布局实现他们的算法。（请务必查看[打字努力](http://mkweb.bcgsc.ca/carpalx/?typing_effort)、[模型参数](http://mkweb.bcgsc.ca/carpalx/?model_parameters)和[键盘评估](http://mkweb.bcgsc.ca/carpalx/?keyboard_evaluation)部分。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T15:38:44.263

一个简单的方法：

根据手指位置对每个字母进行评分。为移位添加修饰符或乘数。也许为重复的字母添加减少？

听话，把分数加起来，你应该有一种方法。

测试，根据需要修改分数，重复直到你有一个有意义的分布。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T15:38:48.507

您可以将键盘的二维表示保存在数组中，作为一种连接图，键名和坐标作为节点，2个坐标指向您的手悬停的位置（围绕 F 和 J？），然后对于每个输入键，您计算从图表中的键到 2 个“悬停键”的距离，取最小值，添加移位（大写）惩罚并输出（可能加权）分数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T15:40:00.473

您可能想尝试一种非常基本的方法，为可能键入的每个键赋予一个值，然后简单地添加您要评估的单词的所有键的值...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T15:40:14.483

纯粹基于键之间的距离，使用键表计算距离，并将距离相加。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T16:44:58.707

作为基础，您可以给每个键一个难度等级，然后添加等级。

然后你可能想发现困难的手指模式。例如组合“sle”比“sfe”更难，因为前者是左右组合。由于左右手与大脑的每一半相连，因此大脑在左右手之间进行协调比在同一只手上协调手指要困难得多。在这样的组合中，按错误的顺序按键是很常见的。

单词的常见程度也会影响难度。更常见的单词被输入的频率更高，因此大脑会学习这些模式。此外，当一个单词包含一个常用单词时，它更容易输入，例如“hand”，因为它包含“and”。另一方面，只包含更常见单词的一部分的单词变得更难，因为大脑想要遵循更常见的模式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-25T17:06:41.833

打字难度是非常主观的——它类似于学习演奏乐器，所以一个人很难打字的单词对另一个人来说是小菜一碟。以一个从未坐在键盘前的人为例，让他们输入“Microsoft”这个词......他们会寻找和啄食，并且可能需要几秒钟才能输入。以你的普通程序员为例，他们每天输入这个词几十次，他们会在不到一秒钟的时间内把它弄掉。

另一方面，让第一个人输入“Microscope”这个词，他们可能会花费与输入“Microsoft”非常相似的时间，但程序员会到达“s”和要么在删除并用正确的字符替换字符之前完成单词“Microsoft”，否则当他们的手指不立即知道“显微镜”的模式时，他们会在点击“s”时明显变慢 - 事实上，我只需要输入 3 次，因为我的手指会自动为我完成图案，而无需我考虑。

因此，就单词的复杂性而言，它并不像计算与 home 键的距离那么简单，它归结为打字员的背景环境、他们通常的打字速度、他们对键盘的读写能力以及许多其他因素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T10:57:26.777

与其猜测，不如**测量它。**

拿出一个 100 个单词的列表，让几个人输入它们。测量每次击键之间的时间量。对于每一对字母，将用户从第一个字母移动到第二个字母所花费的总时间除以该字母对出现的次数得到平均值，这是对在两个字母之间移动难度的实际**直接估计**那两个键。

当然，会有一些字母对不会出现在您的单词中的任何位置（例如 ZQ）。但无论如何，这些字母对可能与您的工作无关，除非您需要对随机的字母序列进行评分。

您还需要以某种方式解释输入错误的字母。您可以直接丢弃这些字母，或者使用输入错误的字母来对该字母对添加某种惩罚（这反映了错误输入其中一个字母表明该字母对可能难以输入的事实）。

# java - Java：getMinutes 和 getHours

> ID：907170
> 
> 赞同：159
> 
> 时间：2009-05-25T15:35:02.970
> 
> 标签：java, date, time

你如何得到小时和分钟，`Date.getHours`并被`Date.getMinutes`弃用？我在 Google 搜索中找到的示例使用了已弃用的方法。

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2009-05-25T15:46:57.120

尝试使用[Joda Time](http://www.joda.org/joda-time/)而不是标准的 java.util.Date 类。Joda Time 库有更好的 API 来处理日期。

```
DateTime dt = new DateTime();  // current time
int month = dt.getMonth();     // gets the current month
int hours = dt.getHourOfDay(); // gets hour of day 
```

有关使用 Joda Time 库的利弊，请参阅此[问题。](https://stackoverflow.com/questions/589870/should-i-use-java-date-and-time-classes-or-go-with-a-3rd-party-library-like-joda)

Joda Time 也可能作为标准组件包含在 Java 的某些未来版本中，请参阅[JSR-310](http://jcp.org/en/jsr/detail?id=310)。

* * *

如果您必须使用传统的 java.util.Date 和 java.util.Calendar 类，请参阅它们的 JavaDoc 以获取帮助（[java.util.Calendar](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html)和[java.util.Date](http://java.sun.com/javase/6/docs/api/java/util/Date.html)）。

您可以使用像这样的传统类从给定的 Date 实例中获取字段。

```
Date date = new Date();   // given date
Calendar calendar = GregorianCalendar.getInstance(); // creates a new calendar instance
calendar.setTime(date);   // assigns calendar to given date 
calendar.get(Calendar.HOUR_OF_DAY); // gets hour in 24h format
calendar.get(Calendar.HOUR);        // gets hour in 12h format
calendar.get(Calendar.MONTH);       // gets month number, NOTE this is zero based! 
```

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-05-25T15:39:20.333

来自 Date.getHours 的 Javadoc

`As of JDK version 1.1, replaced by Calendar.get(Calendar.HOUR_OF_DAY)`

所以使用

```
Calendar rightNow = Calendar.getInstance();
int hour = rightNow.get(Calendar.HOUR_OF_DAY); 
```

和 getMinutes 的等价物。

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2015-03-26T02:33:44.293

# java.time

虽然我是[Joda-Time](http://www.joda.org/joda-time/)的粉丝，但[Java 8](http://en.wikipedia.org/wiki/Java_version_history#Java_SE_8_.28March_18.2C_2014.29)引入了[java.time](https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)包，这最终是一个值得的 Java 标准解决方案！阅读这篇文章[Java SE 8 Date and Time](http://www.oracle.com/technetwork/articles/java/jf14-date-time-2125367.html)，了解有关 java.time 的大量信息，不包括小时和分钟。

特别是看[`LocalDateTime`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDateTime.html)课。

小时和分钟：

```
LocalDateTime.now().getHour();
LocalDateTime.now().getMinute(); 
```

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-05-25T15:41:25.013

首先，导入 java.util.Calendar

```
Calendar now = Calendar.getInstance();
System.out.println(now.get(Calendar.HOUR_OF_DAY) + ":" + now.get(Calendar.MINUTE)); 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2019-03-20T20:50:55.233

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-25T15:41:37.057

试试日历。使用 getInstance 获取日历对象。然后使用 setTime 设置所需的日期。现在您可以使用 get(int field) 和适当的常量（例如 HOUR_OF_DAY 左右）来读取您需要的值。

[http://java.sun.com/javase/6/docs/api/java/util/Calendar.html](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-03-19T16:29:40.360

获取分钟和小时的另一种方法是使用 SimpleDateFormat。

```
SimpleDateFormat formatMinutes = new SimpleDateFormat("mm")
String getMinutes = formatMinutes.format(new Date())

SimpleDateFormat formatHours = new SimpleDateFormat("HH")
String getHours = formatHours.format(new Date()) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-01-13T11:58:42.193

```
int hr=Time.valueOf(LocalTime.now()).getHours();
int minutes=Time.valueOf(LocalTime.now()).getMinutes(); 
```

这些函数将以小时和分钟为单位返回 int 值。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-25T15:44:28.883

我建议看广告时间。 [http://www.joda.org/joda-time/](http://www.joda.org/joda-time/)

我害怕在我的繁重项目中添加另一个库，但它简单、快速、智能且令人敬畏。另外，在某种程度上，它与现有代码配合得很好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-06-06T12:31:44.203

```
public static LocalTime time() {
    LocalTime ldt = java.time.LocalTime.now();

    ldt = ldt.truncatedTo(ChronoUnit.MINUTES);
    System.out.println(ldt);
    return ldt;
} 
```

这对我有用

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-25T15:51:39.753

虽然我不建议这样做，但我认为值得指出的是，尽管 java.util.Date 上的许多方法已被弃用，但它们仍然有效。在琐碎的情况下，使用它们可能是可以的。此外，java.util.Calendar 非常慢，因此 getMonth 和 getYear on Date 可能会更快。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-08-20T09:35:14.930

*   从 Date 变量（**yourdate**）获取小时：

```
 Calendar calendar = Calendar.getInstance();
    calendar.setTime(yourdate);
    int hours = calendar.get(Calendar.HOUR_OF_DAY);
    int minutes = calendar.get(Calendar.MINUTE);
    int seconds = calendar.get(Calendar.SECOND); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-09-26T10:06:52.517

`import java.util.*`您可以使用日历和格式化程序类获取小时和分钟。`Calendar cal = Calendar.getInstance()`并`Formatter fmt=new Formatter()`设置显示小时和分钟的格式，`fmt.format("%tl:%M",cal,cal)`打印`System.out.println(fmt)` 输出显示如下`10:12`

# jquery - 使用treeTable jquery插件时防止浏览器超时

> ID：907175
> 
> 赞同：0
> 
> 时间：2009-05-25T15:37:26.760
> 
> 标签：jquery, internet-explorer, firefox

我正在使用 Ludo van den Boom 的 treeTable jquery 插件将表表示为可扩展的树。一旦我的数据集变大，Firefox 和 IE 都会在我的 $(document).ready 中执行对插件的调用时超时。

该插件的公共方法是：

```
$.fn.treeTable = function(opts) {
    options = $.extend({}, $.fn.treeTable.defaults, opts);

    return this.each(function() {
        $(this).addClass("treeTable").find("tbody tr").each(function() {
            // Initialize root nodes only whenever possible
            if (!options.expandable || $(this)[0].className.search("child-of-") == -1) {
                initialize($(this));
            }
        });
    });
}; 
```

它从以下位置调用：

```
$(document).ready(function() {
   $(".reportTable").treeTable();
}); 
```

其中reportTable 是一个相当大的表的类。初始化是一个递归调用。

可以对其进行修改以避免两个浏览器都给出超时吗？我已经看到使用 setTimeout 的参考（请参阅问题 #779379），但我不确定如何应用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T16:07:41.970

从 setTimeout 或 setInterval 调用的任何函数都在主循环之外运行，因此不会阻塞其他脚本。它很简单：

```
window.onload = function(){setTimeout("your_function()",0)} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T19:23:34.023

您正在使用的数据集有多大？树中有多少个节点？它有多少个根节点？

您可能想查看 treeTable 插件的 2.2.2 版本，它应该可以更快地初始化大树。这个版本可以在[插件的项目页面](http://plugins.jquery.com/project/treeTable)下载。

# eclipse - 比较/差异视图的 Eclipse 键盘快捷键？

> ID：907195
> 
> 赞同：31
> 
> 时间：2009-05-25T15:41:04.157
> 
> 标签：eclipse, diff, shortcut

当我在 Eclipse 中比较两个文件时（例如，使用“比较”-->“本地历史”），有哪些可用的键盘快捷键？

我希望能够转到下一个/上一个差异并复制左侧选定的差异，而无需单击微小的小按钮。

谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-25T19:09:43.323

要完成[Artem](https://stackoverflow.com/users/104014/artem-barger)的[回答](https://stackoverflow.com/a/907232/6309)，请在 之后`Preferences->General->Editors->Keys`搜索：

*   选择下一个更改
*   选择以前的更改
*   从左到右复制
*   从右向左复制

默认情况下， “”部分中的所有这些键`Compare`都没有分配快捷键，因此您可以添加您选择的快捷键。

![http://rubenlaguna.com/wp/wp-content/uploads/2007/08/comparebefore.png](https://i.stack.imgur.com/COoHY.png)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-05-05T17:48:20.017

按照@Artem 和@VonC 的指示设置您自己的密钥。
然而，在 Eclipse Galileo 中，路径是`Window > Preferences > General > Keys`.

对于您希望设置的每个命令：

1.  单击命令名称
    *提示：按“类别”排序以对所有“比较”命令进行分组。*

2.  单击“Binding”文本框
    然后，选择您希望使用的键，Eclipse 将为您记录它们。
    *提示：除了组合键之外，您还可以输入一系列键。*

3.  将“何时”下拉框设置为“在编辑器中比较”。
    *提示：此设置将限制您的热键仅在所选上下文中激活。*

* * *

直观的热键设置：（我的建议，不是来自标准）

*   从左到右复制所有`Ctrl+Shift+Left`，`Ctrl+Shift+Right`
*   从右到左复制所有`Ctrl+Shift+Right`，`Ctrl+Shift+Left`
*   从左到右复制 `Ctrl+Left`，`Ctrl+Right`
*   从右到左复制`Ctrl+Right`，`Ctrl+Left`
*   选择下一个更改`Ctrl+Down`
*   选择以前的更改`Ctrl+Up`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-09-02T07:43:05.270

使用eclipse，当你在一个窗口中并且你有一个按钮来做一个动作但是这个按钮没有一个工具提示来显示他的快捷方式时，去**`Navigate`**菜单。大多数时候，快捷方式显示在那里。

![在此处输入图像描述](https://i.stack.imgur.com/ZM3Ii.png)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-25T15:54:47.460

实际上，您可以定义任何您想要的捷径。首选项->常规->编辑器->键。编辑：出于某种原因，我看不到该选项出现在那里。o_o

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-18T13:34:32.623

有一个问题。键绑定编辑器中没有`Next Difference`和`Previous Difference`条目。比较窗口中的这两个按钮绑定到键绑定编辑器中`Next`的`Previous`条目。请参阅[Eclipse 比较编辑器中是否存在下一个差异和上一个差异的键绑定？](https://stackoverflow.com/q/10177460/95735)

我在[https://bugs.eclipse.org/bugs/show_bug.cgi?id=401129](https://bugs.eclipse.org/bugs/show_bug.cgi?id=401129)提出了一个可以投票的错误。

# binary-tree - 这是一棵完整的二叉树吗？

> ID：907210
> 
> 赞同：2
> 
> 时间：2009-05-25T15:47:56.573
> 
> 标签：binary-tree

这是有问题的二叉树。叶子是 a、b、c、d，边标记为 0 或 1。

```
 .
   / \
  a   .
     / \
    b   .
       / \
      c   d 
```

在我看来，它是一个完整的二叉树，因为每个节点要么是一个叶子节点，要么有两个子节点，但是我有这种感觉，我们被告知它不是一个完整的二叉树。如果不是，为什么不是？

如果一个节点有一个子节点是叶子，那不算作子节点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T15:51:52.360

您将完美二叉树与完整二叉树混淆了。完美二叉树是所有叶子节点都在同一层级的完全二叉树。所以是的，图片是一棵完整的二叉树。

叶子被定义为没有子节点的节点。
因此，完全二叉树是一个二叉树，其中每个节点有零个或两个子节点。

[维基百科](http://en.wikipedia.org/wiki/Binary_tree)对定义很有帮助。确保你检查出来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-16T13:48:26.123

是的，每个节点都有零个或两个孩子的树，它是二叉树。

# c# - 报告服务段落

> ID：907215
> 
> 赞同：0
> 
> 时间：2009-05-25T15:50:14.327
> 
> 标签：c#, reporting, service

如何将 paragraf 添加到 Microsoft Reporting 文本框？

当我放置空字符时，它们不会被渲染，我尝试使用 Functions Space、LSet... VbTab ....

例如

我想要

```
This is text 
```

但我明白了

这是文字

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T13:57:52.030

为此，请将以下内容放入 Report TextBox 的 Value 属性中：

```
="     Text here" 
```

这将处理空格。

# c# - 表达式与谓词问题

> ID：907216
> 
> 赞同：-2
> 
> 时间：2009-05-25T15:50:23.000
> 
> 标签：c#, .net-3.5, lambda, expression-trees

我遇到了一些挑战，我必须创建一个表达式树来表示用户的查询输入。由于我没有时间创建所有可能的用户输入案例，我认为表达式树可以帮助我解决这个问题。

在大多数情况下，它有。然而，我有点难过。我在下面的代码中尝试使用动态创建的表达式执行 List.Find。简而言之，表达式是这样的：

```
list.Find(m => m.ListOfStrings.Exists(s => s == "cookie")); 
```

其中 m 是

```
class MyClass
{
    public List<string> ListOfStrings { get; set; }
} 
```

我已经做到了创造

```
s => s == "cookie" 
```

有表情，没问题。我还为 Exists 声明了一个方法信息

```
var existsMethod = typeof(MyClass)
        .GetProperty("ListOfStrings")
        .PropertyType
        .GetMethod("Exists"); 
```

我唯一的问题是创建一个表达式来调用所述方法，将 lambda 作为参数，如下所示

```
var findLambda = Expression.Lambda(
    Expression.Call(
        Expression.Property(
            Expression.Parameter(typeof(MyClass), "m"),
            typeof(MyClass).GetProperty("ListOfStrings")),
        existsMethod,
        existsLambda),
    Expression.Parameter(
        typeof (MyClass),
        "m")); 
```

它给出了一个可以理解的例外

```
Expression of type 'System.Func`2[System.String,System.Boolean]' cannot be used for parameter of type 'System.Predicate`1[System.String]' of method 'Boolean Exists(System.Predicate`1[System.String])' 
```

我怎么能克服这个？

完整代码：

```
private class MyClass
{
    public List<string> ListOfStrings { get; set; }
}

public void SomeMethod()
{
    var myObject = new MyClass();
    myObject.ListOfStrings = new List<string>();
    myObject.ListOfStrings.Add("cookie");
    myObject.ListOfStrings.Add("biscuit");

    List<MyClass> list = new List<MyClass>();
    list.Add(myObject);

    var existsLambda = Expression.Lambda(
        Expression.Equal(
            Expression.Parameter(typeof(string), "s"),
            Expression.Constant("cookie")),
        Expression.Parameter(typeof(string), "s"));

    var existsMethod = typeof(MyClass).GetProperty("ListOfStrings").PropertyType.GetMethod("Exists");

    var findLambda = Expression.Lambda(
        Expression.Call(
            Expression.Property(
                Expression.Parameter(typeof(MyClass), "m"),
                typeof(MyClass).GetProperty("ListOfStrings")),
            existsMethod,
            existsLambda),
        Expression.Parameter(
            typeof (MyClass),
            "m"));

    list.Find((Predicate<MyClass>)findLambda.Compile());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T16:26:12.747

代表有不同的类型：

```
public delegate bool Predicate<T>(T obj);
public delegate TResult Func<T, TResult>(T arg); 
```

`Exists`方法（和）`Find`期望`Predicate<T>`。Lambda 表达式在运行时编译为`Func<T, TResult>`.

尝试以下操作：

```
var existsLambda = Expression.Lambda(typeof(Predicate<string>), 
                Expression.Equal(
                    Expression.Parameter(typeof(string), "s"),
                    Expression.Constant("cookie")),
                Expression.Parameter(typeof(string), "s")); 
```

您还可以使用通用[Lambda 函数](http://msdn.microsoft.com/en-us/library/bb340145.aspx)：

```
var existsLambda = Expression.Lambda<Predicate<string>>(Expression.Equal(
                    Expression.Parameter(typeof(string), "s"),
                    Expression.Constant("cookie")),
                Expression.Parameter(typeof(string), "s")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T16:19:44.743

如果您查看该消息，它会告诉您 Predicate 与 Func 不兼容。

现在，Predicate 被定义为：

```
public delegate bool Predicate<T>(
    T obj
) 
```

你有 Func 这样的：

```
public delegate TResult Func<T, Result>(
    T arg1
) 
```

放在一起，您正在尝试使这两个代表兼容：

```
public delegate bool MyClassPredicate ( MyClass obj )
public delegate bool StringFunc ( string arg1 ) 
```

IE。字符串！= MyClass。

我希望这是有道理的。

# javascript - 面向对象的 Javascript 最佳实践？

> ID：907225
> 
> 赞同：253
> 
> 时间：2009-05-25T15:52:51.517
> 
> 标签：javascript, oop

我发现自己正在用 Javascript 编写一个大项目。我记得最后一个是相当冒险的，因为 hacky JS 很快就会变得不可读，我希望这段代码是干净的。

好吧，我正在使用对象来构造一个库，但是在 JS 中有几种定义事物的方法，这意味着在范围、内存管理、命名空间等方面的重要后果。例如：

*   使用`var`与否；
*   在文件中定义事物，或以`(function(){...})()`jquery 风格定义；
*   使用`this`或不使用；
*   使用`function myname()`或`myname = function()`；
*   在对象主体中定义方法或使用“原型”；
*   等等

那么，在 JS 中使用 OO 进行编码时，真正的最佳实践是什么？

这里真的期待学术解释。热烈欢迎链接到书籍，只要它们涉及质量和稳健性。

编辑 ：

阅读了一些资料，但我仍然对上述问题的答案和任何最佳实践非常感兴趣。

* * *

## 回答 #1

> 赞同：289
> 
> 时间：2009-05-25T20:52:00.837

### 是否使用 `var`

您应该在语句中引入任何变量`var`，否则它会进入全局范围。

值得一提的是，在严格模式 ( `"use strict";`)中[未声明的变量赋值会抛出`ReferenceError`](http://hacks.mozilla.org/2011/01/ecmascript-5-strict-mode-in-firefox-4/)。

目前 JavaScript 没有块作用域。Crockford 学派教您[将 var 语句放在函数体的开头](http://javascript.crockford.com/code.html#variable%20declarations)，而 Dojo 的样式指南则指出[所有变量都应在尽可能小的范围内声明](http://docs.dojocampus.org/developer/styleguide)。（JavaScript 1.7 中引入的[`let`语句和定义](https://developer.mozilla.org/en/New_in_JavaScript_1.7#let_statement)不是 ECMAScript 标准的一部分。）

将经常使用的对象的属性绑定到局部变量是一种很好的做法，因为它比查找整个作用域链要快。（请参阅[优化 JavaScript 以获得极致性能和低内存消耗](http://codeutopia.net/blog/2009/04/30/optimizing-javascript-for-extreme-performance-and-low-memory-consumption/)。）

### 在文件或 `(function(){...})()` 中定义事物

如果您不需要访问代码之外的对象，您可以将整个代码包装在一个函数表达式中——这称为模块模式。它具有性能优势，并且还允许您的代码在较高级别上被缩小和模糊。您还可以确保它不会污染全局命名空间。[JavaScript 中的包装函数](http://peter.michaux.ca/articles/wrapping-functions-in-javascript)还允许您添加面向方面的行为。Ben Cherry 有[一篇关于模块模式的深入文章](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth)。

### 是否使用 `this`

如果你在 JavaScript 中使用伪经典继承，你几乎无法避免使用`this`. 您使用哪种继承模式是个人喜好问题。对于其他情况，请查看 Peter Michaux 关于[JavaScript Widgets without "this"](http://peter.michaux.ca/articles/javascript-widgets-without-this)的文章。

### 使用 `function myname()` 或 `myname = function();`

`function myname()`是一个函数声明，`myname = function();`是一个分配给变量的函数表达式`myname`。后一种形式表明函数是一等对象，你可以对它们做任何事情，就像对变量一样。它们之间的唯一区别是所有函数声明都被提升到范围的顶部，这在某些情况下可能很重要。否则他们是平等的。`function foo()`是一种速记形式。关于提升的更多细节可以在[JavaScript 范围和提升](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)文章中找到。

### 在对象主体中定义方法或使用“原型”

由你决定。JavaScript 有四种对象创建模式：伪经典、原型、功能和部分（[Crockford，2008](http://oreilly.com/catalog/9780596517748/)）。每个都有其优点和缺点，请参阅[Crockford 在他的视频谈话中](http://yuiblog.com/crockford/)或按照[Anon 的建议](https://stackoverflow.com/questions/907225/object-oriented-javascript-best-pratices/907275#907275)获取他的书*The Good Parts*。

### 构架

我建议你选择一些 JavaScript 框架，研究它们的约定和风格，并找到最适合你的实践和模式。例如，[Dojo Toolkit](http://docs.dojocampus.org/dojo/declare)提供了一个健壮的框架来编写甚至支持多重继承的面向对象的 JavaScript 代码。

### 模式

最后，还有一个专门[探讨常见 JavaScript 模式和反模式](http://www.jspatterns.com/category/patterns/object-creation/)的博客。另请查看问题*[JavaScript 是否有任何编码标准？](https://stackoverflow.com/questions/211795/are-there-any-coding-standards-for-javascript)*在堆栈溢出中。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-03T05:40:46.753

自从我提出这个问题以来，我将写下我阅读或应用的一些东西。所以阅读它的人不会感到沮丧，因为大多数答案都是 RTMF 的变相（即使我必须承认，建议的书是好的）。

## 变量用法

任何变量都应该已经在 J​​S 的更高范围内声明。因此，当您想要一个新变量时，请声明它以避免意外操作，例如在不注意的情况下操作全局变量。**因此，始终使用 var 关键字。**

在一个对象 make 中，var 变量 private。如果您只想声明一个公共变量，请使用`this.my_var = my_value`这样做。

## 声明方法

在 JS 中，它们有多种声明方法的方式。对于 OO 程序员来说，最自然而有效的方法是使用以下语法：

物体内部

```
this.methodName = function(param) {

/* bla */

}; 
```

有一个缺点：由于有趣的 JS 作用域，内部函数将无法访问“this”。Douglas Crockford 建议使用名为“that”的传统局部变量来绕过此限制。所以它变成

```
function MyObject() {

    var that = this;

    this.myMethod = function() {

        jQuery.doSomethingCrazy(that.callbackMethod);

    };

}; 
```

## 不要依赖自动结束行

如果您忘记了， JS 会尝试`;`在行尾自动添加。不要依赖这种行为，因为你会得到调试混乱的错误。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-25T20:13:59.993

首先应该阅读[基于原型的编程](http://en.wikipedia.org/wiki/Prototype-based_programming)，这样你就知道你正在处理什么样的野兽，然后看看[MDC 上的 JavaScript 样式指南和 MDC](https://developer.mozilla.org/En/Javascript_Style_Guide)上[的 JavaScript 页面](https://developer.mozilla.org/en/JavaScript)。我还发现最好使用工具来强制代码质量，即。[JavaScript Lint](http://www.JavaScriptLint.com/)或其他变体。

OO 的最佳实践听起来更像是您想要找到模式而不是专注于代码质量，因此请查看[Google 搜索：javascript 模式](http://www.google.com/search?client=safari&rls=en-us&q=javascript+patterns&ie=UTF-8&oe=UTF-8)和[jQuery 模式](http://www.mail-archive.com/jquery-en@googlegroups.com/msg24924.html)。

*   [加速你的 JavaScript](http://www.youtube.com/watch?v=mHtdZgou0qU&fmt=18)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-25T21:15:07.873

您可能想查看John Resig (jQuery)[编写的 JavaScript Ninja 的秘密。](http://jsninja.com)“这本书的目的是让一名中级 JavaScript 开发人员从头开始，为他提供创建跨浏览器 JavaScript 库所需的知识。”

该草案可通过出版商获得：http: [//www.manning.com/resig/](http://www.manning.com/resig/)

Douglas Crockford 在他的主页上也有一些不错的 JavaScript 文章： [http ://www.crockford.com/](http://www.crockford.com/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-03T05:53:00.587

我经常觉得自己是这里唯一一个在我的 javascript 中使用 MooTools 的人。

它代表面向**对象**的工具，**mootools** **。**

 ****我真的很喜欢他们在 javascript 中对 OOP 的看法。您也可以将他们的类实现与 jquery 一起使用，因此您不必放弃 jquery（尽管 mootools 也能做到这一切）。

无论如何，请仔细阅读第一个链接，看看您的想法，第二个链接是 mootools 文档。

[MooTools & 继承](http://jqueryvsmootools.com/#mooinheritance)

[MooTools 类](http://mootools.net/docs/core/Class/Class)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T16:21:44.493

这是一本涵盖大部分基础的书：

[面向对象的 Javascript 用于高质量的应用程序和库](https://rads.stackoverflow.com/amzn/click/com/1847194141)

# iphone - 同时流式传输和保存视频？

> ID：907230
> 
> 赞同：17
> 
> 时间：2009-05-25T15:54:19.520
> 
> 标签：iphone, video-streaming, mpmovieplayercontroller

我正在编写一个应用程序，其中一部分允许用户流式传输/播放视频。我想限制该功能，以便他们只能在有 WiFi 连接的情况下流式传输视频。然后我将保存视频，这样当他们只有 3G（或更小）连接时，他们无法流式传输视频，只能重播手机上保存的视频。

理想情况下，我想让 MPMoviePlayerController 流式传输/播放电影，然后访问电影数据并保存它。但是，MPMoviePlayerController api 似乎不支持访问电影数据。

我想避免并下载然后播放场景。有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-10-07T21:39:54.260

想到了两个解决方案。这两种解决方案都要求文件采用可以渐进式播放的格式，例如，您不需要整个文件就可以播放它（但这无论如何都是先决条件）。

1.  使用线程下载数据并将其附加到文件中，然后从另一个线程播放文件。现在，这要求您可以在 MPMoviePlayerController 中处理 EOF 事件并暂停播放，直到缓存文件被附加到，然后在同一点恢复。

到目前为止，我看到人们这样做是行不通的，因为 MPMoviePlayerController 无法处理 EOF 事件。（我自己还没有测试过）[ [MPMoviePlayerController 成功预加载后将视频缓存到磁盘](https://stackoverflow.com/questions/934303/caching-videos-to-disk-after-successful-preload-by-mpmovieplayercontroller])

2.  跳过文件播放并设置本地 HTTP 服务器并从中流式传输（在 localhost 上）。这也没有经过测试。这个想法是 MPMoviePlayerController 将更好地处理从 HTTP 流中丢失数据的事件，而不是直接读取文件。缺点可能是效率较低，但我认为这是 CPU 的小幅增加。我不知道网络接口是否会处理它，但我假设这不是问题。

我将此答案保留为 wiki，因为我没有可行的解决方案，但我也想要一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T12:07:49.977

有一种方法可以完成这项工作，但您必须编写自己的 HTTP Live Streaming 下载器。

基本上，您解析 .m3u8 文件（这是一个非常简单的标准，但对于备用流可能会变得棘手，并且流可能会简单地退出并需要新的播放列表才能继续），然后以 .ts 格式下载块到您的本地存储，例如 Documents 文件夹或 Caches 等。

然后您必须设置一个本地 HTTP 服务器以允许 MPMoviePlayerController 或 AVPlayer 通过 HTTP 访问文件（因为它们不会触及本地文件路径），包括指向本地文件的重新编码的播放列表文件，您必须从原始播放列表中创建自己。CocoaHTTPServer 非常适合这个。

一旦你完成了所有这些，它就会很好用。在将本地 HTTP URL 呈现给电影播放器​​之前，下载前一两个块时不可避免地会有一点延迟，但在那之后，您将获得无缝下载、录制和预览播放。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-29T14:20:57.293

iPhone 正在使用渐进式下载，因此不会保存在设备上。为此，您需要明确下载它，然后从本地文件夹播放视频。

# c# - 将 GD-Sharp 流转换为位图

> ID：907231
> 
> 赞同：0
> 
> 时间：2009-05-25T15:54:29.647
> 
> 标签：c#, bitmap, image-manipulation, gd

我目前正在尝试 GD-Sharp 并希望将图形转换为位图而不将其保存到图像文件中。

保存到流的 GD-Sharp 方法是

> bool GB.Save（流输出）；

使用流保存是

```
使用(FileStream fs = File.OpenWrite(@"stream1.jpg"))
{
 image.Save((System.IO.Stream)fs);
 fs.Close();
}

```

由于位图支持流，它如何将 GD-Sharp 转换为位图？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T17:29:33.287

您可以使用 MemoryStream，例如

```
gdsBitmap.Save(memStream);
memStream.Seek(0);
gdiBitmap = Bitmap.FromStream(memStream); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T22:51:15.403

我做了这样的事情。

```
MemoryStream memStream = new MemoryStream();
gdimg.Save(memStream);
位图 bmp2 = 新位图（memStream）；

```

# django - 多对多关系的管理内联表单中的图像和视频预览

> ID：907233
> 
> 赞同：4
> 
> 时间：2009-05-25T15:55:15.510
> 
> 标签：django, django-admin, django-forms

A 有 3 个模型：具有 ManyToManyField 关系的项目、图像和视频：

```
class Project(models.Model):
    images = models.ManyToManyField('Image', through='Project_Images')
    video = models.ManyToManyField('Video', through='Project_Video')

class Image(models.Model):
    original = models.ImageField()
    projects = models.ManyToManyField('Project', through='Project_Images')

class Video(models.Model):
    projects = models.ManyToManyField('Project', through='Project_Video') 
```

我使用链接到当前项目的图像和视频的内联表单配置项目的管理表单：

```
class ProjectAdmin(admin.ModelAdmin):
    inlines = [VideoInline, ImagesInline]

class ImagesInline(admin.TabularInline):    
    model = Project_Images
    raw_id_fields = ['project','image']

class VideoInline(admin.TabularInline):    
    model = Project_Video
    raw_id_fields = ['project','video'] 
```

但是带有简单选择字段和删除复选框的内联表对我来说非常痛苦，我想在这里显示图像或视频的预览（youtube）。[我在AdminImageWidget](http://www.djangosnippets.org/snippets/934/)的帮助下为图像解决了这个问题：

```
class ImageForm(forms.ModelForm):
    class Meta:
        model = Image

    preview = forms.ImageField(widget=AdminImageWidget())
    def __init__(self, *args, **kwargs):
        super(ImageForm, self).__init__(*args, **kwargs)
        try:
            image = Image.objects.get(id=self.instance.image_id)
            self.fields["preview"].initial = image.original
        except:
            pass

class ImagesInline(admin.TabularInline):
    .....
    form = ImageForm 
```

这是最好的方法吗？在我的情况下，我不需要文件上传输入，只需要内联表格中的图像预览。我还需要预览 youtube 视频，我应该编写自己的小部件来显示视频并将其应用于一些假字段吗？

对于不必要的假字段，通过小部件解决这个问题很奇怪。还是正常方式？

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T18:19:43.373

您应该创建一个类似于 AdminImageWidget 的小部件，但它只显示图像，而不是上传框。要应用该小部件，您不需要自定义 Form 类或假字段，只需在 ImageInline 上使用 formfield_overrides：

```
class ImageInline(admin.TabularInline):
    ...
    formfield_overrides = { models.ImageField: {'widget': YourPreviewWidget}} 
```

**编辑**：糟糕，没有完全处理 ManyToManyField 问题 - 您正在显示“通过”表的内联，而不是具有实际 ImageFields 的表。鉴于此，您现在所做的可能不是一个糟糕的解决方案。我能想到的替代方法是为 Select 编写一个专门的替换小部件，它知道如何为当前选定的 Image 对象显示选择框和预览图像。这样你就可以避免对假的额外字段的需要。

# architecture - 3-tiers pattern and large amounts of data

> ID：907240
> 
> 赞同：5
> 
> 时间：2009-05-25T15:56:57.353
> 
> 标签：architecture, n-tier-architecture, 3-tier

Here is my situation: I am trying to follow as hard as I can the 3-tier pattern (i.e. Presentation, Business and Data layer). When I need data from the DB, the Business layer calls the Data layer which returns the information. The Data layer never return a SqlDataReader or DataTable object, but often an enumeration of custom object known by the Data Access Layer. It works pretty well when the Data layer has to return a list with few objects.

I am now facing this problem, my application (the business layer) must process 500000 records. I could simply add another method to my Data layer and return an IEnumerable but this sound very bad to me. I don't want to load half-million records in memory.

My question is, considering the 3-tier model, how should I handle this case? If I had no 3-tiers pattern, I would simply use SqlDataReader in my business classes. Any suggestions?

**UPDATE**: The data will not be displayed, so this is not a paging issue (the presentation layer is not involved at all here). I simply have to analyze each record and then keep some of them.

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T16:02:59.630

I assume you're not displaying 500,000 records to the front end at once? You're probably doing some pagination, right? So, only return one page worth of data from the database at one time.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T17:40:04.593

您可以在 SqlReader 类之上构建抽象。这样您就不必直接传递 SqlReader，但您仍然可以一次处理一个对象。

想想迭代器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T16:03:46.510

Yes, your instinct is correct.

I'm betting that your UI client does not want to look at half a million records at once. Google doesn't return every hit in a single page; you won't, either.

You have a choice as to where and when your application processes those half a million records. You can chunk them into smaller units of work; you can process them asynchronously; you can write a stored procedure and process them in the database without bringing them all over to the middle tier.

The MVC pattern is wonderful, but it's not holy writ. Make the choices that work for your app.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T16:40:21.257

一张纸永远无法战胜现实。如果您的具体问题要求打破 3 层范式，那就去做吧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T17:02:07.283

在某些情况下，您必须打破 3 层界限。但在你这样做之前，你可以问自己：

1.  当您“分析每条记录并保留其中一些记录”时，这真的是业务逻辑的一部分吗？或者它是一个数据访问功能？这可能属于数据访问层。

2.  如果它*是*业务逻辑的一部分，您是否需要全部 500000 条记录才能决定是否“保留”任何单独的记录？可能是业务层应该一次处理一条记录。连续进行 500000 次数据库调用并不漂亮，但如果从概念的角度来看，这是应用程序应该做的事情，那么有一些方法可以缓解这种情况。

我不建议为了保持 3 层分开而做任何愚蠢的事情。但有时，当你认为你必须越界时，那是因为设计中有一些东西需要重新审视。

--
bmb

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-21T06:02:39.150

在数据库中进行过滤。无论如何都不需要带来超过 500000 条要过滤掉的记录。为什么将它们都带到中间层只是为了删除它们。使用后端的 SQL 引擎 (sproc) 尽早处理操作（数据）。最有效，类似于在发送到 IIS 之前检查表示层上的基本输入检查。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T16:21:20.250

This is not an uncommon problem and occurs frequently in situations where you need to consolidate large amounts of data and present summaries to the user (reports are a typical example). Your solution should be designed with these considerations in mind. It does not make sense to ignore the efficiencies offered by sql readers (or similar tools) when strict coherence to some particular architectural model makes your application inefficient. It is often possible to overcome some of these problems by adapting an architectural model to your needs. Generic architectural models are rarely applicable out of the box. They are guidelines that should be applied to your particular needs.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T04:46:00.827

如果我正确理解这一点，您想“分析”记录，然后保留其中一些并删除其余记录。那么在这种情况下，我认为最好在数据库本身（PL/SQL 或 T/SQL）内处理这个问题。像这样的需求应该是重中之重，而不是架构。由于您不只是显示分析，因此最好在程序本身中进行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-25T16:54:49.633

在数据库级别进行所需的任何分析都不会感到羞耻。如果您可以使用存储过程对您需要的东西进行切片和切块，或者与存储过程进行必要的关联，并将应用程序用于更复杂的操作，那么您应该没问题。

问题是，用户是否希望按下按钮并处理所有 500K 记录并看到结果？如果是这样，他们是否愿意坐下来观看旋转的 gif，或者在流程完成后收到某种类型的通知是否令人满意？如果处理 500K 是最重要的，您的数据模型是否需要更改以支持此过程？有[Hadoop](http://en.wikipedia.org/wiki/Hadoop)和[消息队列](http://en.wikipedia.org/wiki/MSMQ)等处理方法适合这种大容量，但是你需要到这个程度吗？您可能能够在将您的头发拉到性能上之前设定用户的期望。

# asp.net - ASP.NET insert from bll to mysql

> ID：907242
> 
> 赞同：0
> 
> 时间：2009-05-25T15:57:43.187
> 
> 标签：asp.net, mysql, insert, bll

I am trying to make an insert to an MySql database using a three layer solution (or what it might be called).

I have done this may times with an MS-sql database and it has worked very well.

But now when I am trying to make an insert I get the the ID can't be null. I thought the database took care of that. If I write an insert directly in the code and use the MySqlCommand and executeNonQuery it works great.

Is it not possible to use BLL and DAL with MySql?

Error message:

System.Data.NoNullAllowedException: Column 'GiftID' does not allow nulls. at System.Data.DataColumn.CheckNullable(DataRow row) at System.Data.DataColumn.CheckColumnConstraint(DataRow row, DataRowAction action) at System.Data.DataTable.RaiseRowChanging(DataRowChangeEventArgs args, DataRow eRow, DataRowAction eAction, Boolean fireEvent) at System.Data.DataTable.SetNewRecordWorker(DataRow row, Int32 proposedRecord, DataRowAction action, Boolean isInMerge, Int32 position, Boolean fireEvent, Exception& deferredException) at System.Data.DataTable.InsertRow(DataRow row, Int32 proposedID, Int32 pos, Boolean fireEvent) at System.Data.DataRowCollection.Add(DataRow row) at PayEx.payexusersDataTable.AddpayexusersRow(payexusersRow row) in c:\Users\IT\AppData\Local\Temp\Temporary ASP.NET Files\payex\45bd406a\10c84208\App_Code.cyqhjqo7.1.cs:line 444 at PayExBLL.AddPayExUser(String Firstname, String Lastname, String Company, String Address, String Zip, String City, String Phone, String Email, Byte ContactMe, UInt32 Amount, UInt32 TransactionNumber, Byte Anonymous, String Currency) in c:\Users\IT\Documents\Visual Studio 2008\WebSites\payex\App_Code\BLL\PayExBLL.cs:line 66 at _Default.btn_next3_Click(Object sender, EventArgs e) in c:\Users\IT\Documents\Visual Studio 2008\WebSites\payex\Default.aspx.cs:line 191

My code:

```
[System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Insert, true)]
public bool AddPayExUser(string Firstname, string Lastname, string Company, string Address, string Zip, string City, string Phone, string Email, byte ContactMe, uint Amount, uint TransactionNumber, byte Anonymous, string Currency)
{
    PayEx.payexusersDataTable puTable = new PayEx.payexusersDataTable();
    PayEx.payexusersRow puRow = puTable.NewpayexusersRow();

    puRow.Firstname = Firstname;
    puRow.Lastname  = Lastname;
    puRow.Company = Company;
    puRow.Address = Address;
    puRow.Zip = Zip;
    puRow.City = City;
    puRow.Phone = Phone;
    puRow.Email = Email;
    puRow.ContactMe = ContactMe;
    puRow.Amount = Amount;
    puRow.TransactionNumber = TransactionNumber;
    puRow.Anonymous = Anonymous;
    puRow.Currency = Currency;

    puTable.AddpayexusersRow(puRow);
    int rowsAffected = Adapter.Update(puTable);

    return rowsAffected == 1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T16:04:26.260

```
System.Data.NoNullAllowedException: Column 'GiftID' does not allow nulls. at 
```

From the looks of your code, you're forgetting to pass in a `GiftID` parameter to your function but it's expected (and can't be null) in your table row.

Hence the exception. Either set it in your code above, or define a default value on it in your MySQL database.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T16:04:53.140

EDIT: This comment assumes you're inserting into a table for which GiftId is the primary key, which seems unlikely. If so, Eoin Campbell's answer makes more sense!

Check if GiftId is an AUTO_INCREMENT column; that's MySQL's equivalent of identity.

You can recreate the column as identity like:

```
ALTER TABLE Gifts
         DROP COLUMN GiftId;

ALTER TABLE items
         ADD COLUMN GiftId INT NOT NULL AUTO_INCREMENT FIRST; 
```

# asp.net - MVC Ajax 未发布下拉列表值

> ID：907250
> 
> 赞同：0
> 
> 时间：2009-05-25T16:01:50.567
> 
> 标签：asp.net, asp.net-mvc

在视图中使用以下表单

```
<% using (Ajax.BeginForm("PatientSearch", new {}, new AjaxOptions()
           {
               HttpMethod = "POST",
               UpdateTargetId = "searchResults",
               OnBegin = "BeginRequest",
               OnSuccess = "SuccessRequest",
               OnFailure = "FailRequest"
           }))
           { %>
    <%=Html.DropDownList("patientType",(SelectList)ViewData["PatientTypeList"]) %>
    <%=Html.DropDownList("edCenterID",(SelectList)ViewData["EdCenterList"]) %><br />
    <input type="submit">
<%} %> 
```

生成以下 HTML

```
<select id="patientType" name="patientType">
  <option selected="selected">Referral</option>
  <option>Patient</option>
</select>
<select id="edCenterID" name="edCenterID">
  <option value="2">Barren River District Health Department</option>
  <option value="3">Madison County Health Department</option>
</select> 
```

我尝试用控制器中的代码捕获值

```
 public ActionResult PatientSearch(string patientType, int edCenterID)        {   
   //do something with values

} 
```

patientType 总是作为 "" 传递；但是，edCenterID 已发布并收到很好。

如果我将它从 Ajax.BeginForm 更改为 HTML.BeginForm，则一切正常。

我的 DropDownList 和我的控制器都有问题吗？

**从评论中添加**

@Eoin 向我指出，我的选择正在呈现没有值，这可能是问题所在。这带来了两个问题：
1\. 为什么它适用于标准帖子，而不适用于 Ajax 帖子。
2.如何让我的下拉列表包含一个值，该列表是一个简单的仅字符串列表（无键）。我在下面发布用于生成我的 SelectList 的代码

```
ViewData["PatientTypeList"]=new SelectList(new List<string>() 
        { "Referral", "Patient"}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T16:14:11.610

患者类型列表是否有 .Value

从表面上看，没有`value`为 PatientType DDL 渲染，`<option>`所以基本上每个选项都有一个 value="" 所以它实际上是回发正确的值。

问题在于首先呈现的是什么。

**编辑**

尝试

```
Dictionary<string, string> d = new Dictionary<string, string>();
d.Add("referral", "referral");
d.Add("patient", "patient");

ViewData["PatientTypeList"]=new SelectList(d, "Key", "Value"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-27T13:55:41.510

没有解决办法吗？似乎在 Ajax 表单提交中出现了问题。

这是一个很好的解决方法，照常编写方法，然后运行：

```
 function addDropDownValues() {
            $("select option").each(function(i) {
                if ($(this).text() == "Red") { $(this).attr('value', "Red"); }
                else if ($(this).text() == "Amber") { $(this).attr('value', "Amber"); }
                else if ($(this).text() == "Green") { $(this).attr('value', "Green"); }
                else if ($(this).text() == "Complete") { $(this).attr('value', "Complete"); }
             });
        } 
```

其中“红色”、“琥珀色”等......是您想要传递的值

这将为每个下拉列表附加一个值，产生：

```
<select name="status1" id="status1"><option value="Red">Red</option>
<option value="Amber">Amber</option>
<option selected="selected" value="Green">Green</option>
<option value="Complete">Complete</option>
</select> 
```

这适用于 Firefox 和 Internet Explorer。Internet Explorer 需要 value 项，而 firefox 不需要。

# jquery - jQuery - 将 div 定义为网格

> ID：907254
> 
> 赞同：0
> 
> 时间：2009-05-25T16:03:15.777
> 
> 标签：jquery, html, grid

无论如何在jQuery中给一个div“网格”选项？我不想在 div 本身上绘制网格。

这个想法是让较小的层以类似网格的方式捕捉到较大的 div 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T16:29:21.607

如果您要求在 div 中构建网格，那么您可以单独使用 CSS 完成此操作。有一个名为[960](http://960.gs/)的 CSS 模板，它以 12 像素或 16 像素的增量布置带有网格的页面，并负责对齐和间距。

这将帮助您实现“对齐”功能的目标，因为放置在列中的任何元素都将遵守容器 div 的规则。

在该站点上有一个网格生成器的链接，您可以[在其中使用网格系统的宽度](http://www.spry-soft.com/grids/)并预览结果。

警告：一旦你用 CSS Grid 布局你的页面，你就有可能放弃使用表格，因为 CSS 更容易操作，并且使用像 960 这样的系统，你有开箱即用的跨浏览器支持。这可能是件好事！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T16:08:25.307

如果你想*绘制*一个网格，那么你需要尽可能多的单元格，给它们一些边框，全部向左或向右浮动。只有这样才能将您的内容捕捉到其中。

但是如果你只想以类似网格的方式布局内容，那么你只需要为所有的 div 设置固定的宽度和高度，将它们向左浮动就可以了。

# jsf - JSF renderers - using templates

> ID：907259
> 
> 赞同：2
> 
> 时间：2009-05-25T16:04:55.603
> 
> 标签：jsf, templates, components, velocity, renderer

I was wondering if anyone has experience with using some kind of templating language for generating the html output in the component's renderer.

It seems to me that doing stuff like the following is difficult to maintain if your component rendering will suffer changes during its life.

```
 writer.write('\n');
 writer.startElement("script", null);
 writer.writeAttribute("type", "text/javascript", null);
 writer.writeAttribute("language", "Javascript", null);
 writer.write("var checkbox_off = \"" + CHECKBOX_OFF_IMAGE_PATH + "\";\n");
 writer.write("var checkbox_on = \"" + CHECKBOX_ON_IMAGE_PATH + "\";\n\n");
 writer.write("cache1 = new Image("
                    + CHECKBOX_IMAGE_WIDTH
                    + ","
                    + CHECKBOX_IMAGE_HEIGHT
                    + ");\n");
 writer.write("cache1.src=checkbox_off;\n");
... 
```

I have seen articles discussing the use of Velocity as the renderer templating language ([http://people.apache.org/~matzew/jsfvelocity.html](http://people.apache.org/~matzew/jsfvelocity.html)) but I was wordering how other JSF component developers have solved this problem and whether there is a more general consensus on how to handle this problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:42:13.180

尝试将 Facelets 与 JSF 一起使用。他们可以将整个渲染器代码移动到一个 html 文件中。您不需要在 Java 中执行此操作。如果您需要一些样品，那么我可以分享。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T16:43:54.187

我不确定在渲染器中使用模板是否有任何共识——当然，[JSF 规范](http://java.sun.com/javaee/javaserverfaces/reference/api/index.html)中没有任何内容。在 JSF 中使用模板的主要工作是在视图定义级别通过 Facelets，但这在编写渲染器时用处不大。

可能值得查看一些开源组件库构建过程，看看它们是否已经解决了这个问题。

# architecture - 如何设计可扩展的应用程序？

> ID：907260
> 
> 赞同：65
> 
> 时间：2009-05-25T16:05:43.170
> 
> 标签：architecture, scalability

您如何设计/架构可扩展的应用程序？任何可以帮助理解如何扩展应用程序的书籍或网站的建议？

谢谢

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-05-25T16:41:07.170

在过去的一年里，我不得不为我公司正在进行的一个项目快速解决这个问题，我发现这些资源非常有用：Todd Hoff 的[highscalability.com](http://www.highscalability.com)；[可扩展的互联网架构](https://rads.stackoverflow.com/amzn/click/com/067232699X)，作者 Theo Schlossnagle；和[构建可扩展的网站](https://rads.stackoverflow.com/amzn/click/com/0596102356)，作者 Cal Henderson。Highscalability.com 尤其会为您指出许多好的演示文稿、教程、书籍和论文，是一个很好的起点。所有的建议都是实用的，并且基于 Flickr、Twitter 和 Google 等网站的经验。

顺便说一句，可扩展性不是性能。一个完全可扩展的系统是一个具有固定边际成本来增加额外用户或容量的系统。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T17:37:48.517

*   我倾向于认为可扩展性与可维护性密切相关。而且似乎经常被忽视的是，人们只花很短的时间**开发**应用程序，其余时间都在**维护**它。

*   此外，扩展几乎肯定与数据有关（它比代码更敏捷——所以你喜欢拥有越来越多的数据），这就是为什么你的存储访问成本应该保持在`O(1)`和之间的原因`O(n)`。

*   对我来说，完美可扩展的应用程序是我可以从一个环境复制到另一个（类似）环境、配置一些值并运行它以扩展整个应用程序的执行范围的应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-25T17:58:41.563

这是关于 livejournal 以及他们如何随着时间的推移扩展其应用程序的好读物。

[danga.com/words/2004_mysqlcon/mysql-slides.pdf](http://www.danga.com/words/2004_mysqlcon/mysql-slides.pdf) [PDF]

它可能不是您正在寻找的那种东西，但它是关于扩展的更好的“这就是我们所做的以及为什么”概述之一。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-25T17:40:56.777

这里已经发布了一些很棒的答案。在一些书籍和链接中，您会发现一些常见的思维模式。

*   尽可能少写代码

*   尽可能重用代码

*   不要过度或抽象你的设计

*   将事物分解为可以在单独或多个系统上运行的模块化区域。繁重的处理应留给单独的系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T16:16:20.970

在你开始使用技术之前，你应该知道应用范围很冷。客户/业务部门对绩效的期望是什么，失败的关键领域是什么？Scott Hanselman 有一个关于这个主题 的精彩[播客。](http://www.hanselminutes.com/default.aspx?showID=132)

提供的一些花絮：除非必须，否则不要使用缓存；提供文件比从数据库中组装片段要快；知道如何处理偷看服务器时间；知道你的高峰会是什么。

同样，首先要了解使用范围，才能知道是否***应该***扩展。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-16T08:35:18.967

无论您做什么，您都无法从一开始就将系统设计为可扩展以满足您的所有需求。通常，一旦您的系统运行起来，您就会在最意想不到的地方发现瓶颈（即：本地网络带宽）。无论如何，我的建议也绝对是 highscalability.com :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T16:07:59.347

为此，我会推荐这本书：

[http://www.amazon.com/Scalable-Internet-Architectures-Developers-Library/dp/067232699X/ref=sr_1_1?ie=UTF8&s=books&qid=1243267630&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/067232699X)

尽管这主要是一本 PHP 书籍，但其思想对于任何 Web 堆栈都是相同的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-25T16:21:02.840

[这](http://www.codeplex.com/AppArchGuide)正是您所需要的！应用程序架构指南由 Microsoft 模式和实践团队创建，旨在帮助架构师...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-25T16:58:05.510

这是对该主题的一个很好的介绍：IBM developerWorks 提供了一些有趣的教程，介绍了如何将架构模式用于可扩展的应用程序：[here](http://www.ibm.com/developerworks/edu/ar-dw-ar-designpat1.html)和[here](http://www.ibm.com/developerworks/edu/ar-dw-ar-designpat2.html)。

# programming-languages - Explain concatenative languages to me like I'm an 8-year-old

> ID：907263
> 
> 赞同：29
> 
> 时间：2009-05-25T16:07:45.463
> 
> 标签：programming-languages, concatenative-language

I've read the [Wikipedia article on concatenative languages](http://en.wikipedia.org/wiki/Concatenative_programming_language), and I am now more confused than I was when I started. :-)

What is a concatenative language in stupid people terms?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-25T16:38:27.360

In normal programming languages, you have variables which can be defined freely and you call methods using these variables as arguments. These are simple to understand but somewhat limited. Often, it is hard to reuse an existing method because you simply can't map the existing variables into the parameters the method needs or the method A calls another method B and A would be perfect for you if you could only replace the call to B with a call to C.

Concatenative language use a fixed data structure to save values (usually a stack or a list). There are no variables. This means that many methods and functions have the same "API": They work on something which someone else left on the stack. Plus code itself is thought to be "data", i.e. it is common to write code which can modify itself or which accepts other code as a "parameter" (i.e. as an element on the stack).

These attributes make this languages perfect for chaining existing code to create something new. Reuse is built in. You can write a function which accepts a list and a piece of code and calls the code for each item in the list. This will now work on any kind of data as long it's behaves like a list: results from a database, a row of pixels from an image, characters in a string, etc.

The biggest problem is that you have no hint what's going on. There are only a couple of data types (list, string, number), so everything gets mapped to that. When you get a piece of data, you usually don't care what it is or where it comes from. But that makes it hard to follow data through the code to see what is happening to it.

I believe it takes a certain set of mind to use the languages successfully. They are not for everyone.

[EDIT] Forth has some penetration but not that much. You can find PostScript in any modern laser printer. So they are niche languages.

From a functional level, they are at par with LISP, C-like languages and SQL: All of them are [Turing Complete](http://en.wikipedia.org/wiki/Turing_complete), so you can compute anything. It's just a matter of how much code you have to write. Some things are more simple in LISP, some are more simple in C, some are more simple in query languages. The question which is "better" is futile unless you have a context.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-02T22:33:33.247

首先，我要反驳 Norman Ramsey 的断言，即没有理论。

**连接语言理论**

连接语言是一种函数式编程语言，其中默认操作（当两个术语并排时发生的情况）是函数组合而不是函数应用。它是如此简单。

因此，例如在 SKI Combinator Calculus（最简单的函数式语言之一）中，两个术语并排等效于将第一个术语应用于第二个术语。例如：`S K K`等价于`S(K)(K)`。

在连接语言`S K K`中相当于`S . K . K`在 Haskell 中。

**那么有什么大不了的**

纯连接语言具有一个有趣的特性，即术语的求值顺序无关紧要。在连接语言`(S K) K`中与`S (K K)`. 这不适用于 SKI 微积分或任何其他基于函数应用的函数式编程语言。

这一观察结果有趣的一个原因是，它揭示了在以函数组合而不是应用程序表示的代码评估中并行化的机会。

**现在对于现实世界**

支持高阶函数的基于堆栈的语言的语义可以使用串联演算来解释。您只需将每个术语（命令/表达式/子程序）映射为将函数作为输入并返回函数作为输出的函数。整个程序实际上是一个单栈转换函数。

现实情况是，现实世界中的事物总是被扭曲的（例如，FORTH 有一个全局字典，PostScript 在评估顺序很重要的地方做了奇怪的事情）。大多数实用的编程语言并不完全符合理论模型。

**最后的话**

我不认为一个典型的程序员或 8 岁的孩子应该担心什么是连接语言。我也没有发现它对鸽子洞编程语言特别有用，因为它是 X 型或 Y 型。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T21:45:00.917

在阅读了[http://concatenative.org/wiki/view/Concatenative%20language](http://concatenative.org/wiki/view/Concatenative%20language)并借鉴了我十几岁时摆弄 Forth 的记忆后，我相信串联编程的关键在于：

*   *根据特定数据堆栈上的值查看数据*
*   *和函数根据在同一数据堆栈上的弹出/推送值来操作东西*

从上面的网页中查看这些报价：

> 有两个术语被抛出，堆栈语言和连接语言。两者都定义了相似但不相等的语言类别。但在大多数情况下，它们是相同的。
> 
> 今天广泛使用的大多数语言都是应用语言：语言的核心结构是某种形式的函数调用，其中一个函数应用于一组参数，其中每个参数本身就是函数调用的结果，一个函数的名称变量或常数。在堆栈语言中，只需编写函数名即可进行函数调用；参数是隐式的，并且在调用时它们必须已经在堆栈上。函数调用的结果（如果有）然后在函数返回后留在堆栈中，以供下一个函数使用，依此类推。因为函数是通过简单地提及它们的名字来调用而没有任何额外的语法，所以 Forth 和 Factor 将函数称为“单词”，因为在语法中它们实际上只是单词。

这与将其功能直接应用于特定变量的应用语言形成对比。

示例：将两个数字相加。

*适用语言*：

```
int foo(int a, int b)
{
    return a + b;
}

var c = 4;
var d = 3;
var g = foo(c,d); 
```

*连接语言*（我编的，应该和 Forth 类似……；））

```
push 4
push 3
+
pop 
```

虽然我不认为连接语言 = 堆栈语言，但正如作者在上面指出的那样，它看起来很相似。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-02-22T14:55:24.847

我认为主要思想是 1\. 我们可以通过将其他程序简单地连接在一起来创建新程序。

此外，2\. 程序的任何随机块都是有效的函数（或子程序）。

旧的纯 RPN Forth 具有这些属性，不包括任何随机的非 RPN 语法。

在程序 1 2 + 3 * 中，子程序 + 3 * 需要 2 个 args，并给出 1 个结果。子程序 2 接受 0 个参数并返回 1 个结果。任何块都是一个函数，这很好！

您可以通过将两个或多个其他函数组合在一起来创建新函数，也可以选择使用一点胶水。如果类型匹配，它将工作得最好！

这些想法真的很好，我们重视简单。

它不限于 RPN Forth 风格的串行语言，也不限于命令式或函数式编程。这两个想法也适用于图形语言，其中程序单元可能是例如函数、过程、关系或过程。

在通信进程网络中，每个子网络都可以像一个进程一样工作。

在数学关系图中，每个子图都是有效的关系。

这些结构是“连接的”，我们可以以任何方式将它们分开（画圆），并以多种方式将它们连接在一起（画线）。

嗯，我就是这么看的。我确信我错过了串联阵营的许多其他好主意。虽然我热衷于图形编程，但我对这种关注连接并不陌生。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-20T03:42:20.273

我对串联编程的务实（和主观）定义（现在，您可以避免阅读其余部分）：

-> 以极端方式组合函数（使用反向波兰表示法 (RPN) 语法）：

```
( Forth code )
: fib
  dup 2 <= if
    drop 1
  else
    dup 1 - recurse
    swap 2 - recurse +
  then ; 
```

-> 一切都是函数，或者至少可以是函数：

```
( Forth code )
: 1 1 ; \ define a function 1 to push the literal number 1 on stack 
```

-> 参数通过函数隐式传递（好吧，这似乎是默认编程的定义），但是，在 Forth 中是这样的：

```
a b c 
```

可能在 Lisp 中：

```
(c a b)
(c (b a))
(c (b (a))) 
```

因此，很容易生成模棱两可的代码......您可以编写将 xt（执行令牌）推送到堆栈上的定义，并为“执行”定义一个小别名：

```
( Forth code )
: <- execute ; \ apply function 
```

所以，你会得到：

```
a b c <- \ Lisp: (c a b)
a b <- c <- \ Lisp: (c (b a))
a <- b <- c <- \ Lisp: (c (b (a))) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T16:09:48.927

You can't explain a language, just get one ([Factor](http://factorcode.org/), preferably) and try [some tutorials on it](http://docs.factorcode.org/content/article-cookbook.html). Tutorials are better than Stack Overflow answers.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T21:11:32.683

对于您的简单问题，这是一个主观和有争议的答案。

我查看了这篇文章和几个相关的网页。网页自称没有真正的理论，所以难怪人们很难想出一个精确且易于理解的定义。我想说，目前，将语言分类为“连接”或“非连接”是*没有用的。*

对我来说，这似乎是一个让[Manfred von Thun](https://en.wikipedia.org/wiki/Joy_(programming_language))有机会挂帽子的术语，但可能对其他程序员没有用处。

虽然 PostScript 和 Forth 值得研究，但我看不出 Manfred von Thun 的 Joy 编程语言有什么特别新的或有趣的东西。事实上，如果你阅读了 Chris Okasaki 的关于*[Haskell 中嵌入后缀语言的技术](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.121.1890&rep=rep1&type=pdf)*的论文，你可以在相对于 Joy 而言是完全主流的环境中尝试所有这些东西。

所以我的回答是**没有简单的解释**，因为没有成熟的理论支持连接语言的想法。（正如爱因斯坦和费曼所说，如果你不能向大学新生解释你的想法，你就不会真正理解它。）我会进一步说，尽管学习其中一些语言，如 Forth 和 PostScript，是一种很好地利用时间，试图弄清楚人们说“连接”时的确切含义可能是浪费你的时间。

# javascript - Highlighting effect to text and/or image similar to be synchronized with audio

> ID：907265
> 
> 赞同：0
> 
> 时间：2009-05-25T16:08:17.100
> 
> 标签：javascript, html, ajax, delphi, browser

I am looking how to approach following problem:

We have application that displays text with audio recorded material. We use Browser Control (Internet Explorer) in Delphi App to do this. We respond to events in Delphi code setting innerHTML for elements if we have to update the style ...

Now, request is to add option to dynamically move the cursor or dynamically highlight the words spoken from the paragraph. It doesn't need to match absolutely the exact word spoken so we will have to dynamically update the content of position of highlighted word based on some timer or something (because it is not text to speach).

What should be the most practical and easy approach to this kind of problem, all answers are greatly appreciated.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T18:07:35.007

假设您有一个文本文件，其中包含要显示的文本以及何时突出显示它的注释时间（一种字幕文件，例如标准提案 w3c 定时文本（[http://www.w3.org/AudioVideo/ TT/](http://www.w3.org/AudioVideo/TT/) ) 或 SUB - 多个媒体播放器使用的电影字幕文件格式。

您的程序必须首先读取并解析文本文件，并解码带注释的时间。将其插入到名为 Subtitles 的字符串列表中，其中项目也将保留与此类似的对象

```
type tSubtitle = class
  num : integer;
  prevTime, fromTime : tdatetime;
  toTime, nextTime: tdatetime;
  text: string;
end; 
```

您可能还想扩展对象以包含一些突出显示的属性。

然后你只需要显示那些与计时器同步的对象。

```
procedure TForm1.Timer1Timer(Sender: TObject);
var rt : TDateTime;
    done:boolean; 
    si,st,sb:integer; 
    s:string;
begin
  rt:=now-startTime;
  st:=0;
  sb:=subtitles.Count;  // binary search the subtitle for the current time
  repeat
     si:=(st+sb) div 2;
     s:=TSubtitle(subtitles.Objects[si-1]);
     done:= ((t>=s.prevTime) and (t<=s.nextTime));
     if not done then 
     begin
        if t>s.prevTime then st:=si 
        else if t<s.nextTime then sb:=si;
        if st=sb then done:=true;
     end;
  until done;
  // do what you want with s
end; 
```

# iphone - How do I detect a touch in the iPhone status bar?

> ID：907272
> 
> 赞同：2
> 
> 时间：2009-05-25T16:12:13.140
> 
> 标签：iphone, cocoa-touch, uitableview, statusbar

I have a UITableview that I would like to scroll to the top when the status bar is touched.

I expected to find a notification that I could listen to and then use tableview:scrollToRowAtIndexPath: for the scroll, but can find none.

Is there a way to do this?

[Update]

Finding some more on the net, I am suspicious that this is the simulator biting me. My UIScrollView is failing to scroll to the top in the simulator, but I have not tried on hardware. Also, I have one UIScrollView, but also UITextView, so I wonder if that is eating it.

I will see what I can do with scrollsToTop.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T16:15:26.553

[**This article**](http://cocoawithlove.com/2009/05/intercepting-status-bar-touches-on.html) on **cocoawithlove.com** is exactly what you want.

From that article:

> "The trickiest part of the sample application is detecting a touch in the status bar.
> 
> By implementing a custom setContentOffset:animated: method on a UITableView and setting a breakpoint in that method, you can see in the debugger stack that the UIApplication sendEvent: method is invoked for status bar touches, so that's where we'll begin."

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T16:32:39.547

It should be happening automatically unless you set the scrollsToTop property to NO.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-06T23:06:30.627

这可能是主要的矫枉过正，但您可以编写自己的状态栏。

您可以通过在应用程序 plist 中将“状态栏最初隐藏”设置为“是”来隐藏实际状态栏。然后在视图顶部创建您自己的自定义状态栏视图，高度为 20px，它可以是 UIButton，也可以是带有 UITapGestureRecognizer 的 UIView。

您可以通过以下方式检测电池电量/状态（充电和插入与否）：

```
UIDevice *myDevice = [UIDevice currentDevice];
[myDevice setBatteryMonitoringEnabled:YES];

float batteryLevel = [myDevice batteryLevel];
UIDeviceBatteryState batteryState = [myDevice batteryState]; 
```

您可以通过 [NSDate date] 获取时间；（然后使用 NSDateFormatter 格式化）。

获得信号强度[有点不确定](https://stackoverflow.com/questions/4484500/wifi-strength-in-iphone-app)，但可以通过一定程度的独创性粗略估计。

# javascript - JQuery - animate moving DOM element to new parent?

> ID：907279
> 
> 赞同：33
> 
> 时间：2009-05-25T16:14:30.830
> 
> 标签：javascript, jquery, dom, jquery-ui, animation

I have an image tag inside of a table cell, that I'd love to move to *another* table cell, and have that movement animated.

The code looks something like this...

```
<td id="cell1"><img src="arrow.png" alt="Arrow"/></td>
<td id="cell2"></td> 
```

I'd like to move "arrow.png" to "cell2", and have some kind of transition effect, preferably with JQuery.

Any ideas?

Thanks!

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-06-10T10:26:53.037

这实际上非常困难，因为您必须将其删除并添加到 DOM 中，但要保持其位置。我想你正在寻找这样的东西。基本上我们不会为`#cell1`或中的箭头设置动画`#cell2`。我们只是在 -tag 中创建一个新的`body`并为其设置动画。这样我们就不必担心表格单元格的位置，因为我们可以相对于文档进行定位。

```
var $old = $('#cell1 img');
//First we copy the arrow to the new table cell and get the offset to the document
var $new = $old.clone().appendTo('#cell2');
var newOffset = $new.offset();
//Get the old position relative to document
var oldOffset = $old.offset();
//we also clone old to the document for the animation
var $temp = $old.clone().appendTo('body');
//hide new and old and move $temp to position
//also big z-index, make sure to edit this to something that works with the page
$temp
  .css('position', 'absolute')
  .css('left', oldOffset.left)
  .css('top', oldOffset.top)
  .css('zIndex', 1000);
$new.hide();
$old.hide();
//animate the $temp to the position of the new img
$temp.animate( {'top': newOffset.top, 'left':newOffset.left}, 'slow', function(){
   //callback function, we remove $old and $temp and show $new
   $new.show();
   $old.remove();
   $temp.remove();
}); 
```

我认为这应该为您指明正确的方向。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2011-03-06T17:41:24.100

@Pim Jager 的回答非常好，但是如果您有对原始元素的对象引用，它们会中断，因为原始元素已被克隆替换

我想出了一个我认为稍微干净的解决方案，因为它只有一个克隆显示动画然后消失，将原件留在新位置。

```
function moveAnimate(element, newParent){
    //Allow passing in either a jQuery object or selector
    element = $(element);
    newParent= $(newParent);

    var oldOffset = element.offset();
    element.appendTo(newParent);
    var newOffset = element.offset();

    var temp = element.clone().appendTo('body');
    temp.css({
        'position': 'absolute',
        'left': oldOffset.left,
        'top': oldOffset.top,
        'z-index': 1000
    });
    element.hide();
    temp.animate({'top': newOffset.top, 'left': newOffset.left}, 'slow', function(){
       element.show();
       temp.remove();
    });
} 
```

要使用：`moveAnimate('#ElementToMove', '#newContainer')`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-25T12:15:02.057

我进一步扩展[了其他答案之一，](https://stackoverflow.com/a/5212193/58792)以便现在您可以将对象作为第三个参数传递，该参数在动画期间用作车辆。例如，如果你想将一些 <li> 从一个 <ul> 移动到另一个，你的 <ul> 可能有一个特定的类来为 <li> 提供样式。因此，在临时车辆 <ul> 中为您的 <li> 设置动画真的很方便，该车辆提供与动画的源或目标 <ul> 相同的样式：

```
//APPENDS AN ELEMENT IN AN ANIMATED FASHION
function animateAppendTo(el, where, float){
    var pos0 = el.offset();
    el.appendTo(where);
    var pos1 = el.offset();
    el.clone().appendTo(float ? float : 'body');
    float.css({
        'position': 'absolute',
        'left': pos0.left,
        'top': pos0.top,
        'zIndex': 1000
    });
    el.hide();
    float.animate(
        {'top': pos1.top,'left': pos1.left},
        'slow',
        function(){
           el.show();
           float.remove();
        });
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-25T16:58:44.447

您需要分两步执行此操作：(1) 动画 (2) 重新定位。

正如@Ballsacian 指出的那样，您可以使用 .animate() 处理动画。可以使用 .html() 完成重新归位 - 对于上面的示例，

```
var arrowMarkup = $('#cell1').html(); //grab the arrow
$('#cell1').html(""); //delete it from the first cell
$('#cell2').html(arrowMarkup); //add it to the second cell 
```

当然，您必须使代码复杂化才能集成动画。而且这种方式不会导致选择（我假设您正在选择表格行？）激活旧选择和新选择之间的行，因为箭头经过它们。实现起来会更加复杂。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-18T12:45:57.477

我正在尝试@Davy8 的功能，该功能非常好，但是当移动的元素在开始时从页面上折断然后在最后又返回时，我发现它非常不和谐。其他页面元素突然移动打断了原本流畅的动画，但这可能取决于您的页面布局。

所以这是@Davy8函数的修改版本，它也应该平滑地缩小和扩大父母之间的空间。

```
function moveAnimate(element, newParent,
                     slideAnimationSpeed/*=800*/, spacerAnimationSpeed/*=600*/)
{
    //Allow passing in either a jQuery object or selector
    element = $(element);
    newParent= $(newParent);
    slideAnimationSpeed=slideAnimationSpeed||800;
    spacerAnimationSpeed=spacerAnimationSpeed||600;

    var oldOffset = element.offset();
    var tempOutgoing=element.clone().insertAfter(element);
    tempOutgoing.hide(); //Don't take up space yet so 'newOffset' can be calculated correctly
    element.appendTo(newParent);
    var newOffset = element.offset();

    var tempMover = element.clone().appendTo('body');
    tempMover.css({
        'position': 'absolute',
        'left': oldOffset.left,
        'top': oldOffset.top,
        'z-index': 1000,
        'margin':0 //Necessary for animation alignment if the source element had margin
    });

    element.hide();
    element.show(spacerAnimationSpeed).css('visibility', 'hidden'); //Smoothly grow space at the target

    tempMover.animate({'top': newOffset.top, 'left': newOffset.left}, slideAnimationSpeed, function(){
       element.css('visibility', 'visible');
       tempMover.remove();
    });
    tempOutgoing.show().css('visibility', 'hidden');
    tempOutgoing.hide(spacerAnimationSpeed, function(){ tempOutgoing.remove() }); //smoothly shrink space at the source
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-09T13:57:36.073

如果动画不一定是移动的东西，那么这个使用 fadeIn 和 fadeOut 的问题给出了一个简单、干净的答案，没有克隆，并且仍然很好地传达了运动：

[用jQuery重新排序div位置？](https://stackoverflow.com/questions/7719567/re-ordering-div-positions-with-jquery)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-01T03:26:47.680

对于仍在查看此内容的任何人，我发现提供的示例并不完全符合我的要求，并且它们没有考虑到利润，所以这是我的版本：

```
jQuery.fn.extend({
    moveElement : function (newParent, speed, after) {
        var origEl   = $(this);
        var moveToEl = $(newParent);

        var oldOffset = origEl.offset();
        var temp      = origEl.clone().appendTo('body');

        temp.css({
            'position' : 'absolute',
            'left'     : parseInt(oldOffset.left) - parseInt(origEl.css('margin-left')),
            'margin'   : origEl.css('margin'),
            'top'      : oldOffset.top,
            'z-index'  : 1000,
            'height'   : moveToEl.innerHeight(),
            'width'    : moveToEl.innerWidth()
        });

        var blankEl = $('<div></div>').css({
            height   : moveToEl.innerHeight(),
            margin   : moveToEl.css('margin'),
            position : 'relative',
            width    : moveToEl.innerWidth()
        });

        if (after) {
            origEl.insertAfter(moveToEl);
            blankEl.insertAfter(newParent);
        }
        else {
            origEl.insertBefore(moveToEl);
            blankEl.insertBefore(newParent);
        }
        origEl.hide();

        var newOffset = blankEl.offset();

        temp.animate({
            'top'  : blankEl.offset().top - parseInt(moveToEl.css('margin-top')),
            'left' : newOffset.left - parseInt(moveToEl.css('margin-left'))
        }, speed, function () {
            blankEl.remove();
            origEl.show();
            temp.remove();
        });
    }
}); 
```

将一个元素移到另一个之前：`$('.elementToFind').moveElement('.targetElement', 1000);`

一个接一个地移动一个元素：`$('.elementToFind').moveElement('.targetElement', 1000, 'after');`

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-25T16:35:55.397

JQuery [http://docs.jquery.com/Downloading_jQuery](http://docs.jquery.com/Downloading_jQuery)
JQuery Effects [http://docs.jquery.com/Effects/animate#paramsoptions](http://docs.jquery.com/Effects/animate#paramsoptions)

Example

```
 $("#go1").click(function(){
      $("#block1").animate( { width:"90%" }, { queue:false, duration:3000 } )
         .animate( { fontSize:"24px" }, 1500 )
         .animate( { borderRightWidth:"15px" }, 1500);
    }); 
```

# java - 无法找到 NamespaceHandler 核心

> ID：907282
> 
> 赞同：3
> 
> 时间：2009-05-25T16:15:52.013
> 
> 标签：java, mule

```
org.mule.api.lifecycle.InitialisationException: Initialisation Failure: Configuration problem: Unable to locate NamespaceHandler for namespace [http://www.mulesource.org/schema/mule/core/2.1]
Offending resource: URL [file:/D:/School/EAD/CourseSVN/bart/EA3/conf/dare2date-config.xml] 
```

我知道你必须在 mule 的类路径中添加你需要的东西，但它怎么能不处理核心呢？

我的配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<mule
xmlns="http://www.mulesource.org/schema/mule/core/2.1"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:spring="http://www.springframework.org/schema/beans"
xmlns:http="http://www.mulesource.org/schema/mule/http/2.1"
xmlns:vm="http://www.mulesource.org/schema/mule/vm/2.1"
xmlns:stdio="http://www.mulesource.org/schema/mule/stdio/2.1"
xmlns:cxf="http://www.mulesource.org/schema/mule/cxf/2.1"
xmlns:mule-xml="http://www.mulesource.org/schema/mule/xml/2.1"
xmlns:jms="http://www.mulesource.org/schema/mule/jms/2.1" 
xmlns:smtps="http://www.mulesource.org/schema/mule/smtps/2.1"
xmlns:smtp="http://www.mulesource.org/schema/mule/smtp/2.1"

xsi:schemaLocation="
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
    http://www.mulesource.org/schema/mule/core/2.1 http://www.mulesource.org/schema/mule/core/2.1/mule.xsd
    http://www.mulesource.org/schema/mule/stdio/2.1 http://www.mulesource.org/schema/mule/stdio/2.1/mule-stdio.xsd
    http://www.mulesource.org/schema/mule/vm/2.1 http://www.mulesource.org/schema/mule/vm/2.1/mule-vm.xsd
    http://www.mulesource.org/schema/mule/stdio/2.1 http://www.mulesource.org/schema/mule/stdio/2.1/mule-stdio.xsd
    http://www.mulesource.org/schema/mule/core/2.1 http://www.mulesource.org/schema/mule/core/2.1/mule.xsd 
    http://www.mulesource.org/schema/mule/xml/2.1 http://www.mulesource.org/schema/mule/xml/2.1/mule-xml.xsd
    http://www.mulesource.org/schema/mule/jms/2.1 http://www.mulesource.org/schema/mule/jms/2.1/mule-jms.xsd        
    http://www.mulesource.org/schema/mule/smtp/2.1 http://www.mulesource.org/schema/mule/smtp/2.1/mule-smtp.xsd
    http://www.mulesource.org/schema/mule/smtps/2.1 http://www.mulesource.org/schema/mule/smtps/2.1/mule-smtps.xsd      
    http://www.mulesource.org/schema/mule/cxf/2.1 http://www.mulesource.org/schema/mule/cxf/2.1/mule-cxf.xsd
">

...etc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T09:14:26.860

解决方案很简单，我没有 2.1 版本（但 2.2 或其他版本）。

# sql - How do I get first unused ID in the table?

> ID：907284
> 
> 赞同：6
> 
> 时间：2009-05-25T16:16:08.707
> 
> 标签：sql, mysql

I have to write a query wherein i need to allocate a `ID` (unique key) for a particular record which is not being used / is not being generated / does not exist in database.

In short, I need to generate an `id` for a particular record and show it on print screen.

E. g.:

```
ID  Name

1   abc
2   def
5   ghi

```

So, the thing is that it should return `ID=3` as the next immediate which is not being generated yet, and after this generation of the `id`, I will store this data back to database table.

It's not an HW: I am doing a project, and I have a requirement where I need to write this query, so I need some help to achieve this.

So please guide me how to make this query, or how to achieve this.

Thanks.

I am not able to add comments,, so thats why i am writing my comments here.. I am using MySQL as the database..

My steps would be like this:-

1) Retrieve the id from the database table which is not being used..

2) As their are no. of users (website based project), so i want no concurrency to happen,, so if one ID is generated to one user, then it should lock the database, until the same user recieves the id and store the record for that id.. After that, the other user can retrieve the ID whichever is not existing.. (Major requirement)..

How can i achive all these things in MySQL,, Also i suppose Quassnoi's answer will be worth,, but its not working in MySQL.. so plz explain the bit about the query as it is new to me.. and will this query work in MySQL..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T16:22:29.237

I named your table `unused`.

```
SELECT  id
FROM    (
        SELECT  1 AS id
        ) q1
WHERE   NOT EXISTS
        (
        SELECT  1
        FROM    unused
        WHERE   id = 1
        )
UNION ALL
SELECT  *
FROM    (
        SELECT  id + 1
        FROM    unused t
        WHERE   NOT EXISTS
                (
                SELECT  1
                FROM    unused ti
                WHERE   ti.id = t.id + 1
                )
        ORDER BY
                id
        LIMIT 1
        ) q2
ORDER BY
        id
LIMIT 1 
```

This query consists of two parts.

The first part:

```
SELECT  *
FROM    (
        SELECT  1 AS id
        ) q
WHERE   NOT EXISTS
        (
        SELECT  1
        FROM    unused
        WHERE   id = 1
        ) 
```

selects a `1` is there is no entry in the table with this `id`.

The second part:

```
SELECT  *
FROM    (
        SELECT  id + 1
        FROM    unused t
        WHERE   NOT EXISTS
                (
                SELECT  1
                FROM    unused ti
                WHERE   ti.id = t.id + 1
                )
        ORDER BY
                id
        LIMIT 1
        ) q2 
```

selects a first `id` in the table for which there is no next `id`.

The resulting query selects the least of these two values.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T16:23:04.603

Depends on what you mean by "next id" and how it's generated.

If you're using a sequence or identity in the database to generate the id, it's possible that the "next id" is not 3 or 4 but 6 in the case you've presented. You have no way of knowing whether or not there were values with id of 3 or 4 that were subsequently deleted. Sequences and identities don't necessarily try to reclaim gaps; once they're gone you don't reuse them.

So the right thing to do is to create a sequence or identity column in your database that's automatically incremented when you do an INSERT, then SELECT the generated value.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-13T21:54:46.047

```
/*
This is a query script I wrote to illustrate my method, and it was created to solve a Real World problem where we have multiple machines at multiple stores creating transfer transactions in their own databases,
that are then synced to other databases on the store (this happens often, so getting the Nth free entry for the Nth machine should work) where the transferid is the PK and then those are synced daily to a MainFrame where the maximum size of the key (which is the TransactionID and StoreID) is limited.  
*/

--- table variable declarations
/* list of used transaction ids (this is just for testing, it will be the view or table you are reading the transaction ids from when implemented)*/

DECLARE @SampleTransferIDSourceTable TABLE(TransferID INT)     

/* Here we insert the used transaction numbers*/

DECLARE @WorkTable TABLE (WorkTableID INT IDENTITY (1,1), TransferID INT) 

/*this is the same table as above with an extra column to help us identify the blocks of unused row numbers (modifying a table variable is not a good idea)*/

DECLARE @WorkTable2 TABLE (WorkTableID INT , TransferID INT, diff int)  

--- Machine ID declared

DECLARE @MachineID INT

-- MachineID set

SET @MachineID = 5

-- put in some rows with different sized blocks of missing rows.
-- comment out the inserts after two to the bottom to see how it handles no gaps or make 
-- the @MachineID very large to do the same.
-- comment out early rows to test how it handles starting gaps.

INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 1 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 2 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 4 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 5 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 6 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 9 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 10 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 20 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 21 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 24 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 25 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 30 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 31 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 33 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 39 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 40 )
INSERT @SampleTransferIDSourceTable ( TransferID ) VALUES ( 50 )

-- copy the transaction ids into a table with an identiy item.
-- When implemented add where clause before the order by to limit to the local StoreID
-- Zero row added so that it will find gaps before the lowest used row.

INSERT @WorkTable (TransferID)

SELECT 0

INSERT @WorkTable (TransferID)

SELECT TransferID FROM @SampleTransferIDSourceTable ORDER BY TransferID   

-- copy that table to the new table with the diff column 

INSERT @WorkTable2

SELECT WorkTableID,TransferID,TransferID - WorkTableID 

  FROM @WorkTable              

--- gives us the (MachineID)th unused ID or the (MachineID)th id beyond the highest id used.

IF EXISTS (

SELECT Top 1

       GapStart.TransferID  + @MachineID - (GapStart.diff + 1)

  FROM @WorkTable2 GapStart

 INNER JOIN @WorkTable2 GapEnd

    ON GapStart.WorkTableID = GapEnd.WorkTableID - 1

   AND GapStart.diff < GapEnd.diff

   AND gapEnd.diff >= (@MachineID - 1)

 ORDER BY GapStart.TransferID

 )

SELECT Top 1

       GapStart.TransferID  + @MachineID - (GapStart.diff + 1)

  FROM @WorkTable2 GapStart

 INNER JOIN @WorkTable2 GapEnd

    ON GapStart.WorkTableID = GapEnd.WorkTableID - 1

   AND GapStart.diff < GapEnd.diff

   AND gapEnd.diff >= (@MachineID - 1)

 ORDER BY GapStart.TransferID

ELSE 

SELECT MAX(TransferID) + @MachineID FROM @SampleTransferIDSourceTable 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-13T23:32:02.250

正确的方法是使用标识列作为主键。不要试图查看已经插入的行，并选择一个未使用的值。Id 列应该包含一个足够大的数字，以使您的应用程序永远不会用完有效的新（更高）值。

在您的描述中，如果您跳过稍后尝试使用的值，那么您可能会赋予这些值一些含义。请重新考虑。您可能应该只将此字段用作另一个表中的查找（参考）值。

让数据库引擎为您的 ID 分配下一个更高的值。如果您有多个同时运行的进程，则需要使用 LAST_INSERT_ID() 函数来确定数据库为您的行生成的 ID。您可以在提交之前在同一事务中使用 LAST_INSERT_ID() 函数。

第二好的（但不好！）是使用索引字段的最大值加一。你必须做一个表锁来管理并发问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T17:05:08.433

你可以有一个公用事业表吗？如果是这样，我会创建一个像这样的表：

```
CREATE TABLE number_helper (
    n INT NOT NULL
   ,PRIMARY KEY(n)
); 
```

用所有正的 32 位整数填充它（假设您需要生成的 id 是一个正的 32 位整数）

然后你可以像这样选择：

```
SELECT MIN(h.n) as nextID
FROM my_table t
LEFT JOIN number_helper h ON h.n = t.ID
WHERE t.ID IS NULL 
```

还没有实际测试过，但它应该可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-28T20:33:01.653

应该在 MySql 下工作。

```
SELECT TOP 100
    T1.ID + 1 AS FREE_ID 
FROM TABLE1 T1
LEFT JOIN TABLE2 T2 ON T2.ID = T1.ID + 1
WHERE T2.ID IS NULL 
```

# java - 来自 XY 坐标图的 Java 字符串

> ID：907292
> 
> 赞同：1
> 
> 时间：2009-05-25T16:19:09.457
> 
> 标签：java, string, map, coordinates, coordinate-systems

我有一个地图，其中坐标定义如下：

```
class Coords {
        int x;
        int y;
        public boolean equals(Object o) {
            Coords c = (Coords)o;
            return c.x==x && c.y==y;
        }
        public Coords(int x, int y) {
            super();
            this.x = x;
            this.y = y;
        }
        public int hashCode() {
            return new Integer(x+"0"+y);
        }
    } 
```

（不是很好，我知道，请不要逗我。）我现在如何创建一个字符串，其中字符是从这个映射映射的，例如：

```
Map<Coords, Character> map = new HashMap<Coords, Character>();
map.put(new Coords(0,0),'H');
map.put(new Coords(1,0),'e');
map.put(new Coords(2,0),'l');
map.put(new Coords(3,0),'l');
map.put(new Coords(4,0),'o');
map.put(new Coords(6,0),'!');
map put(new Coords(6,1),'!');
somehowTransformToString(map); //Hello !
                               //      ! 
```

谢谢，
艾萨克·沃勒
（注意 - 这不是家庭作业）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T16:24:39.893

1.  创建一个比较器，它可以按 y 和 x 对坐标进行排序：

    ```
    int d = c1.y - c2.y;
    if (d == 0) d = c1.x - c2.y;
    return d; 
    ```

2.  创建一个排序的地图：

    ```
    TreeMap<Coords, Character> sortedMap = new TreeMap(comparator);
    sortedMap.putAll(map); // copy values from other map 
    ```

3.  按顺序打印地图的值：

    ```
    for (Character c: map.values()) System.out.print(c); 
    ```

4.  如果您需要换行符：

    ```
    int y = -1;
    for (Map.Entry<Coords, Character> e: map.entrySet()) {
        if (e.y != y) {
            if (y != -1) System.out.println();
            y = e.y;
        }
        System.out.print(c);
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T16:42:39.397

我建议您在 Coord 中添加一个 toString 方法或使用 Point 类。

```
Map<Point, Character> map = new HashMap<Point , Character>();
map.put(new Point(0,0),'H');
map.put(new Point(1,0),'e');
map.put(new Point(2,0),'l');
map.put(new Point(3,0),'l');
map.put(new Point(4,0),'o');
map.put(new Point(6,0),'!');
map put(new Point(6,1),'!');
String text = map.toString(); 
```

如果要布局字符，可以使用多维数组。

```
char[][] grid = new char[7][2];
grid[0][0] ='H';
grid[0][1] ='e';
grid[0][2] ='l';
grid[0][3] ='l';
grid[0][4] ='o';
grid[0][6] ='!';
grid[1][6] ='!';
for(char[] line: grid) System.out.println(new String(line)); 
```

# c++ - Problem with getting error description after SSL_CTX_new returned NULL

> ID：907302
> 
> 赞同：7
> 
> 时间：2009-05-25T16:23:12.733
> 
> 标签：c++, ssl, openssl, ssl-certificate

I am very new to SSL , Actually I would say I know nothing about it.

I am using the method "SSL_CTX_new" to create an SSL_CTX object. The method returns null.The documentation says I can check the error stack in order to get the cause for this.

So I have the function "int SSL_get_error(SSL *s,int ret_code)" which (as I understand) I have to use in order to get the error message. the documentation of the method says nothing about the first parameter of the function. It only says that the second ("ret") parameter should be equal to the return code from the failed operation which can be any of the following :

SSL_connect(), SSL_accept(), SSL_do_handshake(), SSL_read(), SSL_peek(), or SSL_write()

So now I am having two problems. The first is that I didn't use any of those functions but rather use SSL_CTX_new that doesn't return any kind of return code (it returns a pointer to SSX_CTX object) So i don't know what to put as the "ret" parameter. The second problem is that I don't know what does the first parameter mean and what should I put there , because the doc says nothing about it.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T04:17:47.933

根据[http://www.mail-archive.com/openssl-users@openssl.org/msg51543.html](http://www.mail-archive.com/openssl-users@openssl.org/msg51543.html)，您可能错过了对`SSL_library_init()`. 在 SSL_CTX_NEW(..) 调用之前添加它为我解决了 NULL 值问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-25T16:43:51.080

您需要一个有效的上下文来创建 SSL 对象。

由于您无法创建上下文，因此您无法使用 SSL_get_error。

尝试使用 ERR_print_errors 看看出了什么问题

```
#include "openssl/err.h"
...

SSL_CTX * ctx = SSL_CTX_new(....);
if(!ctx) {
    ERR_print_errors_fp(stderr);
    //throw or return an error 
} 
```

我刚刚阅读了 SSL 文档。如果您需要以编程方式获取错误代码/错误字符串，您应该使用 ERR_get_error 和 ERR_error_string 函数。

看看[这里](http://www.openssl.org/docs/crypto/ERR_get_error.html#)和[这里](http://www.openssl.org/docs/crypto/ERR_error_string.html#)

# search-engine - 网站如何突出显示您在搜索引擎中使用的搜索词？

> ID：907305
> 
> 赞同：11
> 
> 时间：2009-05-25T16:23:52.497
> 
> 标签：search-engine, highlight, keyword

我看到一些网站突出显示您使用的搜索引擎关键字，以访问该页面。（例如您在 Google 搜索列表中输入的关键字）

它如何知道您在搜索引擎中输入了哪些关键字？它是否检查引用者 HTTP 标头或其他内容？任何可用的脚本可以做到这一点？它可能是服务器端或 JavaScript，我不确定。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-25T16:44:03.373

这可以在服务器端或客户端完成。搜索关键字是通过查看 HTTP Referer (sic) 标头来确定的。在 JavaScript 中，您可以查看`document.referrer`.

一旦你有了推荐人，你检查它是否是你知道的搜索引擎结果页面，然后解析出搜索词。

例如，Google 的搜索结果中的 URL 如下所示：

```
http://www.google.com/search?hl=en&q=programming+questions 
```

查询参数是搜索查询，因此`q`您需要将其拉出并取消 URL 转义，结果是：

```
programming questions 
```

然后，您可以搜索页面上的术语并根据需要突出显示它们。如果您在此服务器端进行操作，您将在将 HTML 发送到客户端之前对其进行修改。如果您在客户端进行操作，您将操作 DOM。

现有的库可以为您执行此操作，例如[这个](http://www.kryogenix.org/code/browser/searchhi/).

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-08T08:10:49.070

意识到这可能为时已晚，无法产生任何影响......

拜托，我求求你——找出如何做到这一点，然后*永远*不要这样做。作为一名网络用户，当我遇到一个自动执行此操作的网站时，我发现它非常烦人（并且分散注意力）。大多数情况下，它只会突出显示页面上的所有其他单词。如果我需要帮助在页面中查找某个单词，我的浏览器内置了一个更合适的“查找”功能，我可以随意使用或不使用它，而不必重新加载整个页面才能让它运行当我不想要它时（这是*绝大多数*时间）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-30T00:06:23.803

基本上，你...

1.  检查`document.referrer`。
2.  有一个包含搜索词的 GET 参数的域列表。

    ```
    var searchEnginesToGetParam = {
        'google.com' : 'q',
        'bing.com' : 'q'
    } 
    ```

3.  提取适当的 GET 参数和`decodeURIComponent()`它。

4.  解析要突出显示术语的文本节点（请参阅[用 JavaScript 替换文本](http://blog.alexanderdickson.com/javascript-replacing-text)）。
5.  你完成了！

# haskell - Confusion about currying and point free style in Haskell

> ID：907306
> 
> 赞同：10
> 
> 时间：2009-05-25T16:24:23.917
> 
> 标签：haskell, currying, pointfree

I was trying to implement the function

```
every :: (a -> IO Bool) -> [a] -> IO Bool 
```

which was the topic for [this question](https://stackoverflow.com/questions/160170/language-showdown-lazy-aka-short-circuit-evaluation-for-and-and-or-applied-to). I tried to do this **without explicit recursion**. I came up with the following code

```
every f xs = liftM (all id) $ sequence $ map f xs 
```

My function didn't work since it wasn't lazy (which was required in the question), so no upvotes there :-).

However, I did not stop there. I tried to make the function **point-free** so that it would be shorter (and perhaps even cooler). Since the arguments `f` and `xs` are the last ones in the expression I just dropped them:

```
every = liftM (all id) $ sequence $ map 
```

But this did not work as expected, in fact it didn't work at all:

```
    [1 of 1] Compiling Main             ( stk.hs, interpreted )

    stk.hs:53:42:
        Couldn't match expected type `[m a]'
               against inferred type `(a1 -> b) -> [a1] -> [b]'
        In the second argument of `($)', namely `map'
        In the second argument of `($)', namely `sequence $ map'
        In the expression: liftM (all id) $ sequence $ map
    Failed, modules loaded: none.

```

Why is that? I was under the impression that it was possible to simply drop trailing function arguments, which basically is what currying is about.

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-25T17:15:49.277

$的定义是

```
f $ x = f x 
```

让我们把你的函数完全括起来：

```
every f xs = (liftM (all id)) (sequence ((map f) xs)) 
```

和你的咖喱版本：

```
every = (liftM (all id)) (sequence map) 
```

正如您所注意到的，这些并不相同。您只能在最后应用尾随函数参数时删除它们。例如，

```
f x = g c x 
```

实际上是

```
f x = (g c) x 
```

并且 (gc) 对 x 的应用是最后的，所以你可以写

```
f = g c 
```

应用程序运算符 $ 的一种模式是它经常成为组合运算符。无积分版本。这是因为

```
f $ g $ x 
```

相当于

```
(f . g) $ x 
```

例如，

```
every f xs = liftM (all id) $ sequence $ map f xs 
```

可以变成

```
every f xs = (liftM (all id) . sequence . map f) xs 
```

此时您可以删除 xs：

```
every f = liftM (all id) . sequence . map f 
```

消除参数 f 更加困难，因为它是在组合运算符之前应用的。让我们使用来自[http://www.haskell.org/haskellwiki/Pointfree](http://www.haskell.org/haskellwiki/Pointfree)的点的定义：

```
dot = ((.) . (.)) 
```

有了积分，这是

```
(f `dot` g) x = f . g x 
```

并且正是我们需要使每一个完全免费的点：

```
every = (liftM (all id) . sequence) `dot` map 
```

遗憾的是，由于 Haskell 类型系统的限制，这需要一个明确的类型签名：

```
every :: (Monad m) => (a -> m Bool) -> [a] -> m Bool 
```

# asp.net - Directory Structure within TreeView VB

> ID：907307
> 
> 赞同：2
> 
> 时间：2009-05-25T16:24:26.850
> 
> 标签：asp.net, treeview

Started to look at the Treeview control.

Is there anyway to tie the Tree View control into a Directory structure on the Web Server using Visual basic?

I have a lot of legacy files, which are updated and added often. Obviously I could code the structure in XML but this would be laborious and hard to train out to the end user.

I guess it would be a dynamic creation of an XML file perhaps?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T18:59:11.643

这是我不久前在学习使用 TreeView 时创建的一个基本示例。为了您的利益，我现在使用[在线转换器将代码转换为 VB.NET。](http://www.developerfusion.com/tools/convert/csharp-to-vb/)

它从虚拟目录的根开始递归地遍历目录树，并为遇到的每个子目录或文件创建节点。我认为这正是您所需要的。

对于视觉分离，我使用图标来区分文件和文件夹（folder.gif 和 file.gif）。如果需要，您可以删除该参数。

完整的 ASPX 如下（您可以将其粘贴到新页面中，它应该会运行）：

* * *

```
<%@ Page Language="VB" %>
<%@ Import Namespace="System.IO" %>

<script runat="server">
  Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs)
    If Not Page.IsPostBack Then
      Dim rootDir As New DirectoryInfo(Server.MapPath("~/"))

      ' Enter the RecurseNodes function to recursively walk the directory tree. 
      Dim RootNode As TreeNode = RecurseNodes(rootDir)

      ' Add this Node hierarchy to the TreeNode control. 
      Treeview1.Nodes.Add(RootNode)
    End If
  End Sub

  Private Function RecurseNodes(ByVal thisDir As DirectoryInfo) As TreeNode
    Dim thisDirNode As New TreeNode(thisDir.Name, Nothing, "Images/folder.gif")

    ' Get all the subdirectories in this Directory. 
    Dim subDirs As DirectoryInfo() = thisDir.GetDirectories()
    For Each subDir As DirectoryInfo In subDirs
      thisDirNode.ChildNodes.Add(RecurseNodes(subDir))
    Next

    ' Now get the files in this Directory. 
    Dim files As FileInfo() = thisDir.GetFiles()
    For Each file As FileInfo In files
      Dim thisFileNode As New TreeNode(file.Name, Nothing, "Images/file.gif")
      thisDirNode.ChildNodes.Add(thisFileNode)
    Next

    Return thisDirNode
  End Function
</script>

<html>
<head>
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
      <asp:treeview ID="Treeview1" runat="server"></asp:treeview>
    </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T17:14:05.800

自定义站点地图提供商是一个不错的选择。

4guys 上有一篇不错的文章，标题为“检查 ASP.NET 2.0 的站点导航 - 第 4 部分”

# objective-c - init 方法中的 [self release]、[self dealloc] 或 [super dealloc]？

> ID：907311
> 
> 赞同：12
> 
> 时间：2009-05-25T16:25:09.050
> 
> 标签：objective-c, cocoa

我刚刚阅读了有关如何在 init 方法中正确失败的信息，并且文档似乎彼此不同意。一个建议抛出异常，而另一些建议清理并返回 nil。目前这里的最佳做法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-25T17:06:29.413

我相信普遍接受的做法是在失败时返回 nil。但是您确实想释放 self 以避免泄漏：

```
-(id)init
{
  if (self = [super init]) {
    ...
    if (thingsWentWrong) {
      [self release];
      return nil;
    }
    ...
  }
  return self;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-25T18:06:22.733

`[self release]; return nil;`已经涵盖了正确的解决方案（异常和/或），我将解决不正确的解决方案。

不要`dealloc`直接发送。那`release`是工作。（如果您的代码曾经在 GC 下运行，`dealloc`则不适用，我只能推测调用它会导致什么问题。）

Double-不要使用`super`直接发送。那会跳过你自己的`dealloc`实现。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-25T17:15:50.573

*Cocoa 关于异常的理念是，它们应该只在程序员*错误的情况下被抛出，比如将非法参数传递给方法。如果出现其他问题，该方法应该只返回 NO 或 nil，并希望通过 NSError**“out”参数报告详细信息。

这包括 -init 方法。如果错误情况可能在成品中合法发生，则该方法应释放自身（以避免泄漏）并返回 nil。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T16:51:49.667

我一直使用的方法是清理并返回 nil。您在问题标题中提到的三种方法可能会导致调用层次结构中更高的段错误，而返回 nil 不会。我相信苹果文档自己说失败时返回零。你在哪里发现差异？

# html - Is the tag ever an undesirable alternative to the tag?

> ID：907313
> 
> 赞同：17
> 
> 时间：2009-05-25T16:25:28.193
> 
> 标签：html, paragraph

I see the `<p>` tag used a lot in the code of others but have never used it in my own work.

I'm wondering what advantage this gives over using a `<div>` tag?

1.  Are there any benefits I could get from incorporating the `<p>` tag into my pages?

2.  Is there any disadvantage in only using `<div>` tags without `<p>`?

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-25T16:27:53.370

DIV indicates a separate section on a page, which is not semantically connected to the others. With P tags you indicate that this piece of text is broken into paragraphs but it still stays a single entity.

ADDED: With "semantics" people usually refer to the possibility to extract information from HTML as to what various elements of a page represent and how they are related to each other, as opposed to treating the whole HTML as just a markup to be rendered. For example, when you do menus it is recommended that you use ULs (unordered list) for that purpose, because it will be possible to learn from the markup that all LIs (list items) contained within a particular list probably mean choice options of the same level. I know it is helpful for screen readers for impaired people that you try to make your markup as semantic-rich as possible.

If you're not concerned with this, then it is virtually no difference for the rendered result whether you use DIVs or Ps. You can style both with CSS to achieve the same look and feel.

Semantic HTML is still not "the absolute good" to be strived for. For many people semantics does not add any value as they wish just that their pages are rendered correctly. That's why the ever-lasting discussion on whether to use tables for markup (and add semantics where it does not belong) or stick to CSS is not going to end any soon.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-25T16:44:23.310

p 表示“段落”，div 表示“划分”。这很复杂。这是一种告诉搜索引擎、抓取工具、工具等这是一段文本的方式。

当您实际标记文本的“段落”时，div 是不可取的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-25T16:42:49.350

这两个标签有不同的用途。

*   **p**表示一个段落，通常用于组织内容（主要是文本和图像）
*   **另一方面，**div是画布上的一个矩形空间，通常用于布局目的。****

 **示例：您可以将导航面板放在一个 div 中，以便轻松地将其从页面的左侧移动到右侧，或者切换到 3 列布局。导航中的不同部分（首先是一般站点导航，下一个指向最新博客文章的特定热链接或其他）可以通过将它们放在不同的段落中来分开。

（我知道，不好的例子，因为导航更好地由无序列表表示，但是嘿）。

在直接回答您的问题时，它们为您提供了区分组织布局和组织内容的优势，其方式在 HTML 源代码中变得清晰。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-25T16:39:31.570

如果您正在标记内容以便可以使用 CSS 进行布局，您可能需要`<div>`; `<p>`应该用来表示一段文字，就是这样。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T00:02:18.927

> 我能从合并中获得什么好处吗
> 
> 标记到我的页面？

是的，只要您正确使用它——因为使用语义 HTML 总是有好处的。

造成这种情况的原因有很多，但对于需要快速解释的人来说，最主要的原因是 SEO。如果您使用语义 HTML，搜索引擎会更好地理解您的页面。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-25T17:10:03.187

除了它的语义（这很重要）之外，您还需要考虑验证问题。根据 HTML4 规范，您不能在 a 中嵌套其他块级元素（`<div>`、`<ul>`、 other`<p>`等）`<p>`而不会使您的 HTML 无效。

我见过很多解析器会选择过早关闭`<p>`以允许其他嵌套块元素开始的实例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-24T15:33:19.970

p 标签用于段落。p 标签通常包含关于进入它们的文本内容的附加 CSS 样式，并且可以在 css 文档的不同位置定义此样式。例如，ap 通常在其下方有一些额外的空间。如果您尝试使用 p 标签布置某些东西，您最终会得到不均匀的填充。

如果您想从程序化的角度更好地控制页面中的内容，最好使用 div。为所有布局问题坚持使用 div 也将允许您将 p 标签专门用于段落。

# sql - faster way to use sets in MySQL

> ID：907323
> 
> 赞同：1
> 
> 时间：2009-05-25T16:28:20.827
> 
> 标签：sql, mysql, optimization, performance, set

I have a MySQL 5.1 InnoDB table (`customers`) with the following structure:

```
int         record_id (PRIMARY KEY)
int         user_id (ALLOW NULL)
varchar[11] postcode (ALLOW NULL)
varchar[30] region (ALLOW NULL)
..
..
.. 
```

There are roughly 7 million rows in the table. Currently, the table is being queried like this:

```
SELECT * FROM customers WHERE user_id IN (32343, 45676, 12345, 98765, 66010, ... 
```

in the actual query, currently over 560 `user_id`s are in the `IN` clause. With several million records in the table, this query is *slow*!

There are secondary indexes on table, the first of which being on `user_id` itself, which I thought would help.

I know that `SELECT(*)` is A Bad Thing and this will be expanded to the full list of fields required. However, the fields not listed above are more `int`s and `double`s. There are another 50 of those being returned, but they *are* needed for the report.

I imagine there's a much better way to access the data for the `user_id`s, but I can't think how to do it. My initial reaction is to remove the `ALLOW NULL` on the `user_id` field, as I understand `NULL` handling slows down queries?

I'd be very grateful if you could point me in a more efficient direction than using the `IN ( )` method.

**EDIT** Ran EXPLAIN, which said:

```
select_type = SIMPLE 
table = customers 
type = range 
possible_keys = userid_idx 
key = userid_idx 
key_len = 5 
ref = (NULL) 
rows = 637640 
Extra = Using where 
```

does that help?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T16:37:42.960

First, check if there is an index on `USER_ID` *and make sure it's used*.

You can do it with running `EXPLAIN`.

Second, create a temporary table and use it in a `JOIN`:

```
CREATE TABLE temptable (user_id INT NOT NULL)

SELECT  *
FROM    temptable t
JOIN    customers c
ON      c.user_id = t.user_id 
```

Third, how may rows does your query return?

If it returns almost all rows, then it just will be slow, since it will have to pump all these millions over the connection channel, to begin with.

`NULL` will not slow your query down, since the `IN` condition only satisfies non-`NULL` values which are indexed.

**Update:**

The index is used, the plan is fine except that it returns more than half a million rows.

Do you really need to put all these `638,000` rows into the report?

Hope its not printed: bad for rainforests, global warming and stuff.

Speaking seriously, you seem to need either aggregation or pagination on your query.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T20:36:40.323

“选择*”并没有一些人想象的那么糟糕；如果基于行的数据库获取其中任何一个，它们将获取整行，因此在您不使用覆盖索引的情况下，“SELECT *”基本上不比“SELECT a,b,c”慢（注意：有当您有大型 BLOB 时，有时是一个例外，但这是一种极端情况）。

首先，您的数据库是否适合 RAM？如果没有，请获得更多 RAM。不，认真的。现在，假设您的数据库太大而无法合理地放入 ram (Say, > 32Gb) ，您应该尝试减少随机 I/O 的数量，因为它们可能是阻碍事情的原因。

从这里开始，我假设您正在运行适当的服务器级硬件，其中包含 RAID1（或 RAID10 等）中的 RAID 控制器和至少两个主轴。如果你不是，走开，得到那个。

您绝对可以考虑使用聚集索引。在 MySQL InnoDB 中，您只能对主键进行集群，这意味着如果其他东西当前是主键，您将不得不更改它。复合主键是可以的，如果你在一个标准上做很多查询（比如 user_id），让它成为主键的第一部分是一个明确的好处（你需要添加其他东西来使它独特的）。

或者，您可以让您的查询使用覆盖索引，在这种情况下，您不需要 user_id 作为主键（事实上，它一定不是）。仅当您需要的所有列都在以 user_id 开头的索引中时才会发生这种情况。

就查询效率而言，WHERE user_id IN（大 ID 列表）几乎可以肯定是 SQL 中最有效的方法。

但我最大的建议是：

*   心中有一个目标，弄清楚它是什么，当你达到它时，停下来。
*   不要相信任何人的话 - 试试看
*   确保您的性能测试系统与生产的硬件规格相同
*   确保您的性能测试系统具有与生产环境相同的数据大小和类型（相同的模式还不够好！）。
*   如果无法使用生产数据，请使用合成数据（复制生产数据可能在逻辑上很困难（记住您的数据库 >32Gb）；它也可能违反安全策略）。
*   如果您的查询是最佳的（可能已经如此），请尝试调整架构，然后调整数据库本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T16:41:27.543

他们每次都是相同的〜560 id吗？还是在不同的查询运行中有不同的约 500 个 ID？

您可以将您的 560 个用户 ID 插入一个单独的表（甚至是一个临时表），在该表上粘贴一个索引并将其内部连接到您的原始表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T16:41:29.477

这是您最重要的查询吗？这是一个事务表吗？

如果是这样，请尝试在 user_id 上创建聚集索引。您的查询可能很慢，因为它仍然必须进行随机磁盘读取以检索列（键查找），即使在找到匹配的记录之后（在 user_Id 索引上查找索引）。

如果您无法更改聚集索引，那么您可能需要考虑使用 ETL 过程（最简单的方法是将触发器插入到具有最佳索引的另一个表中）。这应该会产生更快的结果。

另请注意，如此大的查询可能需要一些时间来解析，所以如果可能的话，通过将查询的 id 放入临时表来帮助它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T16:39:08.920

您可以尝试在临时表中插入需要查询的 id，并内部连接两个表。我不知道这是否会有所帮助。

# python - A neat way of extending a class attribute in subclasses

> ID：907324
> 
> 赞同：16
> 
> 时间：2009-05-25T16:28:54.383
> 
> 标签：python

Let's say I have the following class

```
class Parent(object):
    Options = {
        'option1': 'value1',
        'option2': 'value2'
    } 
```

And a subclass called Child

```
class Child(Parent):
   Options = Parent.Options.copy()
   Options.update({
        'option2': 'value2',
        'option3': 'value3'
   }) 
```

I want to be able to override or add options in the child class. The solution I'm using works. But I'm sure there is a better way of doing it.

* * *

**EDIT**

I don't want to add options as class attributes because I have other class attributes that aren't options and I prefer to keep all options in one place. This is just a simple example, the actual code is more complicated than that.

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-25T17:25:19.517

语义上等同于您的代码，但可以说更整洁：

```
class Child(Parent):
   Options = dict(Parent.Options,
      option2='value2',
      option3='value3') 
```

请记住，“没有大括号的生活会更好”，并且通过显式调用，`dict`您通常可以避免大括号（以及在键周围的额外引号，它们是类似标识符的常量字符串）。

有关更多详细信息，请参阅[http://docs.python.org/library/stdtypes.html#dict](http://docs.python.org/library/stdtypes.html#dict) - 关键位是“如果在位置参数和关键字参数中都指定了键，则与关键字关联的值保留”，即关键字 args*覆盖*位置 arg 中的键值关联，就像该`update`方法允许您覆盖它们一样）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-25T17:05:43.720

一种方法是使用 dict 的关键字参数来指定其他键：

```
Parent.options = dict(
    option1='value1',
    option2='value2',
)

Child.options = dict(Parent.options,
    option2='value2a',
    option3='value3',
) 
```

如果你想变得更漂亮，那么使用描述符协议你可以创建一个代理对象来封装查找。（只需将 owner.__mro__ 从 owner 属性转到 __get__(self, instance, owner) 方法）。甚至更花哨，进入可能不是一个好主意的领域，元类/类装饰器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-25T17:26:22.777

在考虑了更多之后，感谢@SpliFF 的建议，这就是我想出的：

```
class Parent(object):
    class Options:
        option1 = 'value1'
        option2 = 'value2'

class Child(Parent):
    class Options(Parent.Options):
        option2 = 'value2'
        option3 = 'value3' 
```

不过，我仍然愿意接受更好的解决方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-25T16:38:01.837

Why not just use class attributes?

```
class Parent(object):
    option1 = 'value1'
    option2 = 'value2'

class Child(Parent):
    option2 = 'value2'
    option3 = 'value3' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-10T14:23:27.960

Here is a way using a metaclass

```
class OptionMeta(type):
    @property
    def options(self):
        result = {}
        for d in self.__mro__[::-1]:
            result.update(getattr(d,'_options',{})) 
        return result

class Parent(object):
    __metaclass__ = OptionMeta
    _options = dict(
        option1='value1',
        option2='value2',
        )

class Child(Parent):
    _options = dict(
        option2='value2a',
        option3='value3',
        )

print Parent.options
print Child.options 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-25T16:38:38.187

```
class ParentOptions:
  option1 = 'value1'
  option2 = 'value2'

class ChildOptions(ParentOptions):
  option2 = 'value2'
  option3 = 'value3'

class Parent(object):
  options = ParentOptions()

class Child(Parent):
  options = ChildOptions() 
```

# svn - 如何部署 Subversion 外部？

> ID：907329
> 
> 赞同：5
> 
> 时间：2009-05-25T16:35:39.423
> 
> 标签：svn, deployment, svn-externals, amazon-elastic-beanstalk, beanstalk-svn

我们正在使用 SVN 试水，并以 Beanstalk 作为主机。我们的设置如下所示：

*   存储库：**模块**

    *   模块 1
    *   模块 2
    *   模块 3
*   存储库：**网站 1**

    *   自定义网站代码
    *   svn:对模块 1 的外部引用
    *   svn:对模块 2 的外部引用
*   存储库：**网站 2**

    *   自定义网站代码
    *   svn:对模块 2 的外部引用
    *   svn:对模块 3 的外部引用

Beanstalk 具有内置的 FTP 部署工具。在我的理想世界中，Beanstalk 只会看到外部引用并将任何更改与网站更改一起部署到模块，但这不受支持，[也不会很快](https://beanstalk.tenderapp.com/discussions/questions/8-deployment-support-for-svnexternals)支持。

以包含对外部模块的更改的方式自动部署网站 1 和 2 的良好做法是什么？

其他 SVN 主机是否对部署外部有更好的支持？

如果可能的话，我想避免添加我们自己的构建/部署服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T17:24:45.133

如果部署使用导出，那么这可能是有道理的；我很确定最新版本的 SVN 也可以导出外部，但早期版本没有。也许您最好的选择是在您的部署服务器上执行有问题的存储库的检出并从那里更新？如果您使用分支和标记，您还可以创建指向您的 webroot 的符号链接，这些链接指向结帐中的不同版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T17:57:33.123

为什么不将 svn 存储库签出到本地机器，然后执行 svn 更新和提交，这将使 beanstalk 保持最新。然后通过 beanstalk 进行部署。你可以安排一个脚本每天 svn udpate。

# maven-2 - 使用maven2用jdk1.5编译项目

> ID：907340
> 
> 赞同：4
> 
> 时间：2009-05-25T16:39:25.953
> 
> 标签：maven-2, compiler-construction, maven-plugin, java

我设法使用 maven2 创建了我的项目结构。但是当我使用 mvn install 编译我的项目时，-source 1.3 不支持获取错误泛型

谷歌搜索使用 jdk1.5 构建我的项目并添加了构建标签

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.myProject</groupId>
  <artifactId>project</artifactId>
  <packaging>jar</packaging>
  <version>1.0-SNAPSHOT</version>
  <name>myapp</name>
  <url>http://maven.apache.org</url>
  <dependencies>
    <dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>3.8.1</version>
    <scope>test</scope>
    </dependency>
  </dependencies>
  <build>
   <plugins>
       <plugin>
           <groupId>com.myProject</groupId>
           <artifactId>project</artifactId>
           <configuration>
               <source>1.5</source>
               <target>1.5</target>
           </configuration>
       </plugin>
     <plugins>
  </build>
</project> 
```

但这不起作用。

有什么提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T16:49:34.817

将 maven-compiler-plugin 添加到您的构建中：

```
<build>
  <plugins>
    <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>2.0.2</version>
    <configuration>
        <source>1.5</source>
        <target>1.5</target>
    </configuration>
    </plugin>
  </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T03:46:00.990

有一种“更简单”的方法可以完成此操作，而无需在整个模块中粘贴相同的代码段。您可以设置一个反应器，然后从所有其他模块中引用它，如下所示：

```
 <parent>
    <groupId>com.foo.bar</groupId>
    <artifactId>reactor</artifactId>    
    <version>1.0-SNAPSHOT</version>
  </parent> 
```

在反应堆的 pom 文件中，您必须输入以下内容：

```
<packaging>pom</packaging> 
```

让 maven 知道这不是罐子/战争等。

希望能帮助到你

# .net - 确保数字在 .NET 中正确转换

> ID：907344
> 
> 赞同：2
> 
> 时间：2009-05-25T16:41:15.750
> 
> 标签：.net, casting, byte

我知道我可以通过做

```
float y = 4.5f; 
```

我想做同样的事情，除了一个字节。我该怎么做呢？我检查了 MSDN 文档，找不到与此相关的任何内容。还有，这个叫什么？

谢谢，

**[编辑]**

为清楚起见，我使用的代码是

```
byte myByte = a==b?1:0; 
```

我得到的错误是

> 无法将类型“int”隐式转换为“byte？”。存在显式转换（您是否缺少演员表？）

解决方案

```
byte myByte = (byte)(a==b?1:0); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-25T16:44:12.483

、`byte`和数据类型没有指定的`sbyte`后缀`short`。`ushort`但是，整数文字可以分配给这些数据类型的变量，并将被隐式转换，假设该值适合存储在变量中。只是为了记录，这里是 C# 中定义的文字：

```
uint: U or u
long: L or l
ulong: UL or ul
float: F or f
decimal: M or m 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T16:50:09.637

我只会使用演员表。

```
// Okay
Byte data = (Byte) 57;

// Error (but I don't know if it is a compiler error or a runtime error)
Byte data = (Byte) -17; 
```

或者引入一个常数。

```
// Okay
const Byte foo = 57;
Byte data = foo;

// Compiler Error
const Byte foo = -17;
Byte data = foo; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T16:51:32.850

根据[这篇文章](https://stackoverflow.com/questions/252817/vb-net-whats-the-suffix-type-character-for-byte-numeric-constants)，字节没有这样的后缀。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T16:52:40.743

定义字节时不需要后缀：

```
 byte b = 1; 
```

你只需要确保你的值在 0 到 255 之间。

MSDN 提到使用 F 作为“后缀”，强制使用 Literal Type。

有关更多信息，请参阅[C-sharp Online](http://en.csharp-online.net/CSharp_FAQ:_How_specify_a_CSharp_literal_type)上的以下文章

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T16:46:21.983

十六进制表示法：

字节 b = 0xff;

# python - Django Admin中的欧洲日期输入

> ID：907351
> 
> 赞同：8
> 
> 时间：2009-05-25T16:42:52.440
> 
> 标签：python, django, date, django-admin

Django 有一个 DATE_FORMAT 和一个 DATE_TIME_FORMAT 选项，允许我们在查看日期时选择使用哪种格式，但显然不允许我在 Django Admin 中编辑或添加时更改日期的输入格式。

管理员的默认值为：YYYY-MM-DD

但是使用起来会很棒：DD-MM-YYYY

这在任何情况下都集成在 i18n 中吗？这可以在没有自定义模型的情况下更改吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-01-14T05:03:44.030

[自从Django 票 6483](https://code.djangoproject.com/ticket/6483)关闭和 Django 1.2 发布以来，现在有一种官方方法可以做到这一点。

如果您已[`USE_L10N`](https://docs.djangoproject.com/en/1.3/ref/settings/#std%3asetting-USE_L10N)设置为`False`，您应该做的是[`DATE_INPUT_FORMATS`](https://docs.djangoproject.com/en/1.3//ref/settings/#date-input-formats)在[`DATETIME_INPUT_FORMATS`](https://docs.djangoproject.com/en/1.3//ref/settings/#datetime-input-formats)您的`settings.py`. 以下是我用于此的设置，基于转换默认值：

```
#dd/mm/yyyy and dd/mm/yy date & datetime input field settings
DATE_INPUT_FORMATS = ('%d-%m-%Y', '%d/%m/%Y', '%d/%m/%y', '%d %b %Y',
                      '%d %b, %Y', '%d %b %Y', '%d %b, %Y', '%d %B, %Y',
                      '%d %B %Y')
DATETIME_INPUT_FORMATS = ('%d/%m/%Y %H:%M:%S', '%d/%m/%Y %H:%M', '%d/%m/%Y',
                          '%d/%m/%y %H:%M:%S', '%d/%m/%y %H:%M', '%d/%m/%y',
                          '%Y-%m-%d %H:%M:%S', '%Y-%m-%d %H:%M', '%Y-%m-%d') 
```

如果您已`USE_L10N`设置为`True`，那么您将需要使用[`FORMAT_MODULE_PATH`](https://docs.djangoproject.com/en/1.3/ref/settings/#format-module-path)。

例如，my[`LANGUAGE_CODE`](https://docs.djangoproject.com/en/1.3/ref/settings/#language-code)设置为`en-au`，我的站点名为`golf`，my`FORMAT_MODULE_PATH`设置为`golf.formats`，所以我的目录结构如下所示：

```
golf/
    settings.py
    ...
    formats/
        __init__.py
        en/
            __init__.py
            formats.py 
```

并且`DATE_INPUT_FORMATS`and`DATETIME_INPUT_FORMATS`设置在`formats.py`而不是`settings.py`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-12-22T12:42:20.030

我修改了设置，使其禁用 l10n 并明确设置日期格式：

```
USE_L10N = False
DATE_FORMAT = 'd-m-Y'
DATETIME_FORMAT = 'd-m-Y H:i' 
```

您也可以设置 DATE_INPUT_FORMATS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T18:28:37.333

您现在必须自己执行此操作，但使用设置 DateField 的 input_formats 参数的自定义表单字段类非常容易。这应该这样做：

```
class MyDateField(forms.DateField):
  def __init__(self, *args, **kwargs):
    kwargs.setdefault('input_formats', ("%d-%m-%Y",))
    super(MyDateField, self).__init__(*args, **kwargs) 
```

请注意 input_formats 是一个列表，因此您可以指定多种可能性，它会在解析用户输入时按顺序尝试它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-17T08:59:25.687

基于这个想法，我创建了新的 db.fields 类 EuDateField：

mydbfields.py

```
from django import forms
from django.forms.fields import DEFAULT_DATE_INPUT_FORMATS
from django.db import models

class EuDateFormField(forms.DateField):
    def __init__(self, *args, **kwargs):
        kwargs.update({'input_formats': ("%d.%m.%Y",)+DEFAULT_DATE_INPUT_FORMATS})
        super(EuDateFormField, self).__init__(*args, **kwargs)

class EuDateField(models.DateField):
    def formfield(self, **kwargs):
        kwargs.update({'form_class': EuDateFormField})
        return super(EuDateField, self).formfield(**kwargs) 
```

请注意，它首先将我的格式（例如 31.12.2007）添加到现有的“标准”django 格式中。

用法：

```
from mydbfields import EuDateField
class Person(models.Model):
    ...
    birthday   = EuDateField("Birthday", null=True, blank=True, help_text="") 
```

在我的情况下，这在 admin 中表现良好，但很可能在 ModelForm 中也可以（还没有尝试过）。

我的 Django 版本是：

```
>>> import django
>>> django.get_version()
u'1.1 alpha 1 SVN-10105' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T06:19:51.453

据我了解，似乎[尚不支持](http://code.djangoproject.com/ticket/6483)此功能，所以是的，您现在必须做一些自定义工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-23T22:10:38.200

请注意不要将其写为字符串，而应将其写为元组。例如：

```
DATE_INPUT_FORMATS = ('%d.%m.%Y',) 
```

如果您只想在表单中使用一种有效的日期书写方式。

# java - Java中ClassCastException的解释

> ID：907360
> 
> 赞同：89
> 
> 时间：2009-05-25T16:45:01.563
> 
> 标签：java, casting, classcastexception

我阅读了一些关于“ClassCastException”的文章，但我无法很好地理解它的含义。什么是 ClassCastException？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-25T16:46:47.753

直接来自 API 规范[`ClassCastException`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassCastException.html)：

> 抛出以指示代码已尝试将对象强制转换为它不是实例的子类。

因此，例如，当尝试将 an 强制转换`Integer`为 a`String`时，`String`它不是 的子类`Integer`，因此 a`ClassCastException`将被抛出。

```
Object i = Integer.valueOf(42);
String s = (String)i;            // ClassCastException thrown here. 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2009-05-25T16:47:09.983

这真的很简单：如果你试图将 A 类的对象类型转换为 B 类的对象，并且它们不兼容，你会得到一个类转换异常。

让我们考虑一个类的集合。

```
class A {...}
class B extends A {...}
class C extends A {...} 
```

1.  您可以将这些东西中的任何一个转换为 Object，因为所有 Java 类都继承自 Object。
2.  您可以将 B 或 C 转换为 A，因为它们都是 A 的“种类”
3.  *只有当*真实对象是B 时，才能将对 A 对象的引用强制转换为 B。
4.  即使它们都是 A，您也不能将 B 转换为 C。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-25T16:49:47.687

如果您尝试向下转换一个类，则会发生异常，但实际上该类不是该类型。

考虑这个层次结构：

> 对象 -> 动物 -> 狗

你可能有一个方法叫做：

```
 public void manipulate(Object o) {
     Dog d = (Dog) o;
 } 
```

如果使用此代码调用：

```
 Animal a = new Animal();
 manipulate(a); 
```

它会编译得很好，但在运行时你会得到一个`ClassCastException`，因为 o 实际上是一个动物，而不是狗。

在更高版本的 Java 中，您确实会收到编译器警告，除非您这样做：

```
 Dog d;
 if(o instanceof Dog) {
     d = (Dog) o;
 } else {
     //what you need to do if not
 } 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-04-05T18:58:28.830

考虑一个例子，

```
class Animal {
    public void eat(String str) {
        System.out.println("Eating for grass");
    }
}

class Goat extends Animal {
    public void eat(String str) {
        System.out.println("blank");
    }
}

class Another extends Goat{
  public void eat(String str) {
        System.out.println("another");
  }
}

public class InheritanceSample {
    public static void main(String[] args) {
        Animal a = new Animal();
        Another t5 = (Another) new Goat();
    }
} 
```

在`Another t5 = (Another) new Goat()`：你会得到一个`ClassCastException`，因为你不能使用创建`Another`类的实例`Goat`。

**注意**：转换仅在类扩展父类并且子类被强制转换为其父类的情况下有效。

如何处理`ClassCastException`：

1.  尝试将一个类的对象转换为另一个类时要小心。确保新类型属于其父类之一。
2.  您可以通过使用泛型来防止 ClassCastException，因为泛型提供编译时检查并可用于开发类型安全的应用程序。

[注释的来源和其余部分](http://examples.javacodegeeks.com/java-basics/exceptions/java-lang-classcastexception-how-to-solve-class-cast-exception/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-25T16:47:18.317

你了解铸造的概念吗？强制转换是类型转换的过程，这在 Java 中很常见，因为它是一种静态类型的语言。一些例子：

将字符串`"1"`转换为`int`, via `Integer.parseInt("1")`-> 没问题

将字符串`"abc"`转换为`int`-> 引发`ClassCastException`

或者想一个带有`Animal.class`,`Dog.class`和的类图`Cat.class`

```
Animal a = new Dog();
Dog d = (Dog) a; // No problem, the type animal can be casted to a dog, because it's a dog.
Cat c = (Dog) a; // Will cause a compiler error for type mismatch; you can't cast a dog to a cat. 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-05T11:03:05.340

当您尝试将一种数据类型的对象转换为另一种数据类型时，Java 会引发类转换异常。

只要转换发生在兼容的数据类型之间，Java 就允许我们将一种类型的变量转换为另一种类型。

例如，您可以将字符串转换为对象，类似地，可以将包含字符串值的对象转换为字符串。

### 例子

让我们假设我们有一个包含许多 ArrayList 对象的 HashMap。

如果我们这样写代码：

```
String obj = (String) hmp.get(key); 
```

它会抛出一个类转换异常，因为哈希映射的 get 方法返回的值将是一个数组列表，但我们正试图将它转换为一个字符串。这将导致异常。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-25T16:48:43.447

您试图将一个对象视为不是一个类的实例。这大致类似于试图按下吉他上的制音踏板（钢琴有制音踏板，吉他没有）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-04-02T10:05:37.167

一旦您意识到 JVM 无法猜测未知数，您就可以更好地理解 ClassCastException 和强制转换。如果 B 是 A 的实例，它在堆上的类成员和方法比 A 多。JVM 无法猜测如何将 A 强制转换为 B，因为映射目标更大，并且 JVM 将不知道如何填充额外的成员。

但是如果 A 是 B 的一个实例，这是可能的，因为 A 是对 B 的完整实例的引用，所以映射将是一对一的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-11-16T17:09:08.580

我可以给你的 Java 中的 classcastException 一个很好的例子是在使用“Collection”时

```
List list = new ArrayList();
list.add("Java");
list.add(new Integer(5));

for(Object obj:list) {
    String str = (String)obj;
} 
```

上面的代码将在运行时为您提供 ClassCastException。因为您试图将 Integer 转换为 String，所以会引发异常。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-07-05T08:50:32.863

异常不是 RuntimeException -> ClassCastException 的子类

```
 final Object  exception = new Exception();
    final Exception data = (RuntimeException)exception ;
    System.out.println(data); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-12-17T18:13:28.597

Java ClassCastException 是当您尝试不正确地将类从一种类型转换为另一种时可能发生的异常。

```
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

public class ClassCastExceptionExample {

  public ClassCastExceptionExample() {

    List list = new ArrayList();
    list.add("one");
    list.add("two");
    Iterator it = list.iterator();
    while (it.hasNext()) {
        // intentionally throw a ClassCastException by trying to cast a String to an
        // Integer (technically this is casting an Object to an Integer, where the Object 
        // is really a reference to a String:
        Integer i = (Integer)it.next();
    }
  }
 public static void main(String[] args) {
  new ClassCastExceptionExample();
 }
} 
```

如果你尝试运行这个 Java 程序，你会看到它会抛出以下 ClassCastException：

```
Exception in thread "main" java.lang.ClassCastException: java.lang.String
at ClassCastExceptionExample  (ClassCastExceptionExample.java:15)
at ClassCastExceptionExample.main  (ClassCastExceptionExample.java:19) 
```

这里抛出异常的原因是，当我创建列表对象时，我存储在列表中的对象是字符串“one”，但后来当我尝试取出这个对象时，我故意犯了一个错误将其转换为整数。因为 String 不能直接转换为 Integer——Integer 不是 String 的类型——所以会抛出 ClassCastException。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-18T05:28:36.490

如果你想对对象进行排序，但如果类没有实现 Comparable 或 Comparator，那么你会得到 ClassCastException 例如

```
class Animal{
   int age;
   String type;

   public Animal(int age, String type){
      this.age = age;
      this.type = type;
   }
}
public class MainCls{
   public static void main(String[] args){
       Animal[] arr = {new Animal(2, "Her"), new Animal(3,"Car")};
       Arrays.sort(arr);
   }
} 
```

上面的 main 方法将在运行时类转换异常下面抛出

> 线程“主”java.lang.ClassCastException 中的异常：com.default.Animal 无法转换为 java.lang.Comparable

# php - 显示来自 blob mysql 的图像

> ID：907361
> 
> 赞同：1
> 
> 时间：2009-05-25T16:45:16.603
> 
> 标签：php, mysql

嗨，我的数据库中有一个图像表。这些与图像类型和名称等详细信息一起存储为 blob。

我在显示图像时遇到问题，我得到的只是一个带有红十字的白框。代码：

```
<?php

include '../connection.php';

$ID = $_GET['id'];

$query = "SELECT * FROM `images` WHERE `image_id` = '$ID'";

$result=mysql_query($query);
$row = mysql_fetch_array($result);

$image = $row['image'];
$image_type= $row['image_type'];   

header("Content-type: $image_type");
print $image; 

exit;

?> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T16:51:29.200

好吧，这是一个简短的答案。

```
<?php
include '../connection.php';
$id = (int)$_GET['id'];
$query = "SELECT * FROM `images` WHERE `image_id` = '$id'";

$result=mysql_query($query);
$row = mysql_fetch_array($result);

$image = $row['image'];
$image_type= $row['image_type'];
$size = $row['image_size'];
//alternative
/* list($image, $image_type, $size) = array(
                                       $row['image'],
                                       $row['image_type'],
                                       $row['image_size']
                                      );
*/
$ext = explode('/', $image_type);
$name = $id . '.' . $ext[1]; 

header("Content-type: $image_type");
header("Content-length: $size");
header("Content-Disposition: attachment; filename=$name");

print $image;     
exit; 
```

检查您的 blobtype 是否至少为 MEDIUMBLOB，它能够存储高达 16M 的数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T17:06:06.733

要调试它，我建议注释掉 Content-type 标题行，然后直接在浏览器中点击 url。这将允许您查看 PHP 可能发出的任何错误、警告或通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T16:50:46.657

这看起来可能会起作用，出了什么问题？

尝试明确指定字段：

```
 SELECT image, image_type FROM ... 
```

从数据库运行查询时会发生什么？

您是否像这样加载图像：

```
<img src="image.php?id=12"> 
```

还是您将 PHP 作为自己的页面加载？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T16:56:29.410

几件事要尝试

1.  也许有些事情失败了，它在 html 中返回错误消息，而不是预期的图像

2.  content_type 是正确存储在数据库中还是只是存储图像的文件扩展名

内容类型应该看起来像这样

```
image/gif 
image/jpeg 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T17:01:18.360

也许你可以试试

```
$row = mysql_fetch_assoc($result); 
```

代替

```
$row = mysql_fetch_array($result); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T17:41:23.140

您在评论中说该表最初显示“[BLOB - 64.0 KiB]”，但您随后将其更改为“MEDIUMBLOB”。这将扩大您可以存储的大小，但您现有的所有数据仍将被截断为 64KiB。

确保您使用的字段类型足够大以存储您要存储的数据（MEDIUMBLOB 中 16mb 或 LONGBLOB 中约 4gb，我很确定），然后重新插入所有数据。

除了提到的安全问题之外，除了数据库问题之外，我不明白为什么代码不应该工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-03T18:52:43.187

或者如果你不想创建一个单独的 php 文件，你可以内联它

```
<?php
// retrieve blob into $img
?><img src='data:image/png;base64,<?php echo base64_encode( $img );?>' alt='Image <?php echo $id;?>'> 
```

# list - Flex 3 - 如何默认选择列表中的项目？

> ID：907362
> 
> 赞同：1
> 
> 时间：2009-05-25T16:45:56.507
> 
> 标签：list, flex3, default

如何默认选择列表中的项目

默认选定的项目说索引 0

我试过这样的东西——

listid.selectedIndex = somevalueinmyprogram - 1; // 0

但是当我调试这个时，我得到
_selectedIndex = 0 selectedIndex = -1

和默认值没有选择为什么会这样？[我已经检查了 somevaluefrommyprogram 显然不等于 0]

帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T18:34:46.123

我发现如果你通过定义一个选定项的数组来设置 selectedItems，它比 selectedIndex 效果更好。

```
function setSelectedCategories():void{
   var selectedItems :Array = new Array();      
   for each (var selectedCategory:Category in entry.categories)      {
         for each (var category:Category in categories)         {       
              if (selectedCategory.categoryID == category.categoryID){
                     selectedItems .push(category);               
                     break; 
              }       
         }   
   }   

   categoriesList.selectedItems = selectedItems ;
} 
```

如果要使用包含要选择的索引的数组，或者使用 selectedIndices 有效。

```
for ( var i:int=0; i < userIpods.length; i++ ) {

     //j will represent the list item's index value

     for ( var j:int = 0; j < iPodAry.length; j++) {

         if ( userIpods[i] == iPodAry[j].id ) {

         selectedIpodIndices.push( j );
         break;

         } //end if

     } //end for ( var iPodObj:Object in iPodAry) {

} //end for ( var i:int in userIpods ) 

/*mark as selected those index values in the 
selectedIpodIndices array*/

iPodList.selectedIndices = selectedIpodIndices ; 
```

# asp.net - 由于 .NET 控制，Window.Opener 和 ID 引用问题

> ID：907363
> 
> 赞同：0
> 
> 时间：2009-05-25T16:45:57.070
> 
> 标签：asp.net, jquery, window.opener

我有一个 .aspx 页面，上面有一个链接，然后单击时会使用 .aspx 打开一个新窗口`window.open`。

我需要发回一个整数并将该数字放入一个文本框（这是一个 .NET 控件）。

当我调用`window.opener`弹出窗口时，我必须引用文本框的 ID。问题是，如果您将内容添加到控制树，ID 会不时更改。

如何从新窗口可靠地引用文本框的 ID？

我也安装了 jQuery，但不确定是否可以在新窗口中使用 jQuery？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T16:57:12.327

不要直接从弹出窗口访问元素，而是在弹出窗口可以调用的页面中放置一个函数。在函数中，您可以插入元素的实际 id：

```
function setTextbox(value) {
   document.getElementById('<%=TheTextBox.ClientID%>').value = value;
} 
```

在弹出窗口中：

```
window.opener.setTextbox("Hello world!"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T16:52:12.520

这应该工作

```
// original window script
var windowHandle = window.open(...);
windowHandle.top.otherWindowTextBox = document.getElementById('idOfTextBox); // or use jQuery 
```

现在在您的弹出窗口中，您可以在打开弹出窗口的页面上引用您的文本框。

```
// script in popup window.
top.otherWindowTextBox.value = someInteger; 
```

# java - 如何根据运行的 jar 的结果让我的 ant 任务通过或失败？

> ID：907364
> 
> 赞同：3
> 
> 时间：2009-05-25T16:46:09.860
> 
> 标签：java, ant

我正在运行 CrossCheck（无浏览器 js 单元测试）作为 ant 脚本的一部分。如果 CrossCheck 测试失败，我希望 ant 报告失败。这是 build.xml 中的相关信息

```
<target name="test" depends="concat">
    <java jar="src/test/lib/crosscheck.jar" fork="true">
        <arg value="src/test/webapp/js/"/>
    </java> 
```

还有一个 CrossCheck 失败消息的例子：

```
 [java] Running tests in environment: Mozilla 1.7 (Firefox 1.0)
 [java] org.mozilla.javascript.EcmaError: ReferenceError: "clusterNode" is not defined. (ResultXMLWrapperTest.js#22)
 [java]     at org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3229)
 [java]     at org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3219)
 [java]     at org.mozilla.javascript.ScriptRuntime.notFoundError(ScriptRuntime.java:3292)
 [java]     at org.mozilla.javascript.ScriptRuntime.nameOrFunction(ScriptRuntime.java:1636)
 [java]     at org.mozilla.javascript.ScriptRuntime.name(ScriptRuntime.java:1575)
 [java]     at org.mozilla.javascript.gen.c1._c1(ResultXMLWrapperTest.js:22)
 [java]     at org.mozilla.javascript.gen.c1.call(ResultXMLWrapperTest.js)
 [java]     at org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:340)
 [java]     at org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:2758)
 [java]     at org.mozilla.javascript.gen.c1.call(ResultXMLWrapperTest.js)
 [java]     at net.thefrontside.crosscheck.framework.AbstractScopeFactory$1.run(AbstractScopeFactory.java:108)
 [java]     at org.mozilla.javascript.Context.call(Context.java:515)
 [java]     at org.mozilla.javascript.Context.call(Context.java:450)
 [java]     at net.thefrontside.crosscheck.framework.AbstractScopeFactory.initTestScope(AbstractScopeFactory.java:94)
 [java]     at net.thefrontside.crosscheck.framework.DefaultScopeFactory.getTestScope(DefaultScopeFactory.java:68)
 [java]     at net.thefrontside.crosscheck.framework.TestCase$1.run(TestCase.java:119)
 [java]     at org.mozilla.javascript.Context.call(Context.java:528)
 [java]     at org.mozilla.javascript.Context.call(Context.java:450)
 [java]     at net.thefrontside.crosscheck.framework.TestCase.run(TestCase.java:117)
 [java]     at net.thefrontside.crosscheck.framework.TestSuite.run(TestSuite.java:95)
 [java]     at net.thefrontside.crosscheck.framework.Crosscheck.runAll(Crosscheck.java:116)
 [java]     at net.thefrontside.crosscheck.framework.ConsoleRunner.run(ConsoleRunner.java:140)
 [java]     at net.thefrontside.crosscheck.framework.ConsoleRunner.main(ConsoleRunner.java:300)
 [java] ReferenceError: "clusterNode" is not defined. (ResultXMLWrapperTest.js#22)
 [java] Java Result: 1 
```

ant 能否获得 CrossCheck 测试的结果（也许 Java Result: 1 被传回给 ant？）并以此为基础成功或失败？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-25T16:50:56.300

假设 CrossCheck 在错误时返回非零返回码，您可以将该`failonerror`属性添加到 java 任务：

```
<target name="test" depends="concat">
    <java jar="src/test/lib/crosscheck.jar" fork="true" failonerror="true">
        <arg value="src/test/webapp/js/"/>
    </java> 
```

请参阅有关 Ant [java 任务](http://ant.apache.org/manual/Tasks/java.html)的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T16:51:09.153

您可以使用“java”任务的“failonerror”属性。

> failonerror 如果命令以非 0 的返回码退出，则停止构建过程。默认为“false”（见注释）

[在此处](http://ant.apache.org/manual/Tasks/java.html)查看 Ant 手册。

# sql - 子查询的自连接

> ID：907366
> 
> 赞同：25
> 
> 时间：2009-05-25T16:46:32.387
> 
> 标签：sql, postgresql

我想知道，是否可以使用 PostgreSQL 将查询结果与自身连接起来？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-25T16:52:33.893

您可以使用 WITH：

```
WITH subquery AS(
    SELECT * FROM TheTable
) 
SELECT *
FROM subquery q1
JOIN subquery q2 on ... 
```

或者通过创建一个包含查询的 VIEW 并加入它：

```
SELECT *
FROM TheView v1
JOIN TheView v2 on ... 
```

或蛮力方法：键入子查询两次：

```
SELECT *
FROM (
    SELECT * FROM TheTable
) sub1
LEFT JOIN (
    SELECT * FROM TheTable
) sub2 ON ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T16:52:37.577

你的意思是，对同一张表的查询结果。如果是这样，那么是的，有可能......例如

```
--Bit of a contrived example but...
SELECT * 
FROM Table
INNER JOIN
(
    SELECT 
          UserID, Max(Login) as LastLogin
    FROM
          Table
    WHERE 
          UserGroup = 'SomeGroup'
    GROUP BY
          UserID

) foo
ON Table.UserID = Foo.UserID AND Table.Login = Foo.LastLogin 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T16:59:48.080

是的，只需给查询起别名：

```
SELECT  *
FROM    (
        SELECT  *
        FROM   table
        ) t1
JOIN    (
        SELECT  *
        FROM   table
        ) t2
ON      t1.column < t2.other_column 
```

# php - 如何在 actions.class.php 中创建变量，以便它们可以在 layout.php 中访问？

> ID：907374
> 
> 赞同：1
> 
> 时间：2009-05-25T16:49:53.757
> 
> 标签：php, symfony1

在 Symfony 1.2 中，如何在 actions.class.php 中创建变量，以便在 layout.php 中可以访问它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T16:59:14.837

我认为，默认情况下你不能，因为它应该违反 MVC 模式。

您最好将变量传递给您的视图，但不要使用全局（或某种）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T17:19:12.800

这个页面有一些关于它的信息：http: [//trac.symfony-project.org/wiki/Symfony11LayoutUpgrade](http://trac.symfony-project.org/wiki/Symfony11LayoutUpgrade)

看来您可以使用以下代码获得所需的效果：

```
$this->getResponse()->setSlot('title', 'insert your title here'); 
```

然后在布局文件中使用它：

```
<title><?php echo get_slot('title') ?></title> 
```

# iphone - 在 UITabBarController 和 UINavigationController 之间切换

> ID：907387
> 
> 赞同：0
> 
> 时间：2009-05-25T16:53:36.810
> 
> 标签：iphone, uitabbarcontroller

我的应用程序的主要功能由 UITabBarController 控制。但是，我需要加载一个具有 UINavigationController 的视图。当我返回我的 UITabBarController 使用

```
 self.tabBarController.selectedViewController = [self.tabBarController.viewControllers objectAtIndex:0]; 
```

我的 UITabBarController 不再响应点击。看起来视图没有焦点。

但是，如果我使用此代码切换回 UITabBarController：

```
[window addSubview:tabBarController.view] 
```

我的按钮会响应。我觉得“addSubview”效率较低，因为我从不从窗口中删除视图，因此它必须将视图的第二个副本添加到堆栈中。我对么？有没有办法使用第一种方法并使我的按钮响应？请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T17:18:53.457

听起来您可能错误地展示了导航控制器。您绝对不应该将视图直接添加到窗口中。您想使用

```
[myTabBarController presentModalViewController:myNavController animated:YES]; 
```

完成导航控制器后，您可以将其关闭

```
[myTabBarController dismissModalViewControllerAnimated:YES]; 
```

一切都应该工作。

顺便说一句，这都记录在 UIViewController 的文档和“iPhone OS 的视图控制器编程指南”文档中。

# java - 在不访问非默认构造函数的情况下使用引用初始化对象

> ID：907388
> 
> 赞同：0
> 
> 时间：2009-05-25T16:54:03.067
> 
> 标签：java, interface, constructor, initialization

假设我有一个名为“Controller”的接口。有几个类实现了这个接口，我不知道这些类（例如，类名位于 xml 文件中）。现在为了让这个控制器实现类工作，他们必须获得对其他对象（可能是数据对象）的一些引用。这是我的问题，即初始化此类对象（控制器对象）的最佳方法是什么？

我想到了几种解决方案，但我不确定这里最好的方法是什么。

**首先**：当从类名实例化对象时，我可以搜索“特殊”构造函数（通过反射），它具有控制器对象所需的对象引用。但从我在其他问题中读到的内容来看，这不太可能是一个好的解决方案，因为我会强制在类中存在一个特殊的构造函数。有时我读到反思通常是邪恶的，最好避免。

**第二**：我向控制器接口添加了一个特殊的 init(a,b,c) 方法，该方法需要在创建对象后直接调用。这将强制对对象进行一系列调用（首先是 init(..)，然后是 rest）以使其工作，这也可能很糟糕。顺便说一句，init() 方法在接口中通常是一件坏事吗？

**第三**：阅读[此](https://stackoverflow.com/questions/26903/how-can-you-require-a-constructor-with-no-parameters-for-types-implementing-an-in/26928#26928)评论后，我想到了以下内容：我没有实现控制器接口的类的类名（在 xml 文件中），而是拥有属于具体控制器类的工厂的类名。这个工厂将使用方法 createController(a,b,c) 实现一个接口，然后工厂将知道它必须实例化哪个类以及调用哪个构造函数来传递其他引用（如数据对象）。这样做的缺点是额外的类只是为了实例化控制器类，一般来说可能会有一点开销。

你认为最好的方法是什么？或者你能想出比这三种方式更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T17:04:07.077

在您提到的方法中，我会选择第二种（基于工厂的方法）。但是，由于您正在做的*是*依赖注入的一种形式，还请考虑 Guice，[http://code.google.com/p/google-guice/](http://code.google.com/p/google-guice/) - 它可能使您能够自动化大部分工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T17:40:31.100

您尝试做的与 Spring 所做的非常相似。在您的 xml 文件中，您的控制器节点将具有子节点来指定要设置的属性。您的控制器是通过调用默认构造函数来实现的。然后使用反射设置属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T17:25:51.217

在另一种语言中类似的东西中，我知道使用 init() 解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T18:46:21.810

另一种选择是使用 Unsafe.allocateInstance(Class) 创建实例而不调用构造函数。您可以使用反射设置字段。

这假设您的构造函数没有任何副作用。

# c# - 如何判断一个点是否属于某条线？

> ID：907390
> 
> 赞同：20
> 
> 时间：2009-05-25T16:54:56.043
> 
> 标签：c#, .net, algorithm, gdi+, line

如何判断一个点是否属于某条线？

如果可能的话，我们会赞赏示例。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-25T17:02:54.973

在最简单的形式中，只需将坐标插入直线方程并检查是否相等。

鉴于：

```
Point p (X=4, Y=5)
Line l (Slope=1, YIntersect=1) 
```

插入 X 和 Y：

```
 Y = Slope * X + YIntersect
=> 5 = 1 * 4 + 1
=> 5 = 5 
```

所以，是的，重点就在眼前。

如果您的线以 (X1,Y1),(X2,Y2) 形式表示，那么您可以计算斜率：

```
 Slope = (y1 - y2) / (x1-x2) 
```

然后用这个得到 Y-Intersect：

```
 YIntersect = - Slope * X1 + Y1; 
```

编辑：我修复了 Y 相交（一直是 X1 / Y1 ...）

你必须检查那`x1 - x2`不是`0`。如果是，那么检查该点是否在线是一个简单的问题，即检查您的点中的 Y 值是否等于`x1`或`x2`。此外，请检查该点的 X 是否不是“x1”或“x2”。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-12-06T10:37:50.860

我刚刚编写了一个函数来处理一些额外的要求，因为我在绘图应用程序中使用了这个检查：

*   模糊性 - 由于该功能用于通过单击来选择行，因此必须有一些错误空间。
*   这条线有一个 EndPoint 和一个 StartPoint，没有无限的线。
*   必须处理垂直和水平直线， (x2 - x1) == 0 导致在其他答案中除以零。

```
private const double SELECTION_FUZZINESS = 3;

internal override bool ContainsPoint(Point point)
{
    LineGeometry lineGeo = geometry as LineGeometry;
    Point leftPoint;
    Point rightPoint;

    // Normalize start/end to left right to make the offset calc simpler.
    if (lineGeo.StartPoint.X <= lineGeo.EndPoint.X)
    {
        leftPoint   = lineGeo.StartPoint;
        rightPoint  = lineGeo.EndPoint;
    }
    else
    {
        leftPoint   = lineGeo.EndPoint;
        rightPoint  = lineGeo.StartPoint;
    }

    // If point is out of bounds, no need to do further checks.                  
    if (point.X + SELECTION_FUZZINESS < leftPoint.X || rightPoint.X < point.X - SELECTION_FUZZINESS)
        return false;
    else if (point.Y + SELECTION_FUZZINESS < Math.Min(leftPoint.Y, rightPoint.Y) || Math.Max(leftPoint.Y, rightPoint.Y) < point.Y - SELECTION_FUZZINESS)
        return false;

    double deltaX = rightPoint.X - leftPoint.X;
    double deltaY = rightPoint.Y - leftPoint.Y;

    // If the line is straight, the earlier boundary check is enough to determine that the point is on the line.
    // Also prevents division by zero exceptions.
    if (deltaX == 0 || deltaY == 0) 
        return true;

    double slope        = deltaY / deltaX;
    double offset       = leftPoint.Y - leftPoint.X * slope;
    double calculatedY  = point.X * slope + offset;

    // Check calculated Y matches the points Y coord with some easing.
    bool lineContains = point.Y - SELECTION_FUZZINESS <= calculatedY && calculatedY <= point.Y + SELECTION_FUZZINESS;

    return lineContains;            
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-25T17:31:34.283

确定点 R = (rx, ry) 是否位于连接点 P = (px, py) 和 Q = (qx, qy) 的线上的最佳方法是检查矩阵的行列式是否

```
{{qx - px, qy - py}, {rx - px, ry - py}}, 
```

即 (qx - px) * (ry - py) - (qy - py) * (rx - px) 接近于 0。与发布的其他解决方案相比，此解决方案具有几个相关优势：首先，它不需要垂直线的特殊情况，第二，它不会除法（通常是一个缓慢的操作），第三，当线条几乎但不是完全垂直时，它不会触发不良的浮点行为。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-25T17:17:24.767

给定线上的两个点`L0`和`L1`要测试的点`P`。

```
 (L1 - L0) * (P - L0)
n = (P - L0) - --------------------- (L1 - L0)
               (L1 - L0) * (L1 - L0) 
```

向量的范数`n`是点`P`到通过`L0`和的线的距离`L1`。如果此距离为零或足够小（在舍入误差的情况下），则该点位于线上。

符号`*`代表点积。

**例子**

```
P = (5, 5)

L0 = (0, 10)
L1 = (20, -10)

L1 - L0 = (20, -20)
P  - L0 = (5, -5)

              (20, -20) * (5, -5)
n = (5, -5) - --------------------- (20, -20)
              (20, -20) * (20, -20)

              200
  = (5, -5) - --- (20, -20)
              800

  = (5, -5) - (5, -5)

  = (0, 0) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-25T18:07:51.933

我认为Patrick McDonald 先生给出了几乎正确的答案，这是对他答案的更正：

```
public bool IsOnLine(Point endPoint1, Point endPoint2, Point checkPoint)
{
    return (((double)checkPoint.Y - endPoint1.Y)) / ((double)(checkPoint.X - endPoint1.X))
        == ((double)(endPoint2.Y - endPoint1.Y)) / ((double)(endPoint2.X - endPoint1.X));
} 
```

当然还有很多其他的正确答案，尤其是 Mr.Josh，但我发现这是最好的答案。

谢谢大家。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-25T17:00:36.113

```
y = m * x + c 
```

这是一条线的方程。x & y 是坐标。每条线的特征在于它的斜率 (m) 以及它与 y 轴 (c) 相交的位置。

因此，给定一条线的 m & c，您可以通过检查等式是否适用于 x = x1 和 y = y1 来确定点 (x1, y1) 是否在线上

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-25T17:11:51.280

二维线通常使用两个变量 x 和 y 的方程来表示，这里是一个众所周知的方程

![y-y1 = (y1-y2)/(x1-x2) (x-x1)](https://upload.wikimedia.org/math/5/1/1/511eb44dc0bc2ef554bf676fc47452ee.png)

现在想象您的 GDI+ 线是从 (0,0) 到 (100, 100) 绘制的，然后 m=(0-100)/(0-100) = 1 的值因此您的线的等式是 y-0=1 *(x-0) => y=x

既然我们有一个关于这条线的方程，那么很容易测试一个点是否属于这条线。当您替换 x=x3 和 y=y3 时，如果给定点 (x3, y3) 满足直线方程，则它属于该直线。例如，点 (10, 10) 属于这条线，因为 10=10，但 (10,12) 不属于这条线，因为 12 != 10。

注意：对于垂直线，斜率 (m) 的值是无限的，但对于这种特殊情况，您可以直接使用垂直线的方程 x=c，其中 c = x1 = x2。

虽然我不得不说我不确定这是否是最有效的方法。当我手头有更多时间时，我会尝试找到更有效的方法。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-25T17:15:59.043

如果您有一条由其端点定义的线

```
PointF pt1, pt2; 
```

你有一点要检查

```
PointF checkPoint; 
```

那么你可以定义一个函数如下：

```
bool IsOnLine(PointF endPoint1, PointF endPoint2, PointF checkPoint) 
{
    return (checkPoint.Y - endPoint1.Y) / (endPoint2.Y - endPoint1.Y)
        == (checkPoint.X - endPoint1.X) / (endPoint2.X - endPoint1.X);
} 
```

并按如下方式调用它：

```
if (IsOnLine(pt1, pt2, checkPoint) {
    // Is on line
} 
```

不过，您将需要检查除以零。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-25T17:06:08.510

直线方程为：

```
y = mx + c 
```

所以一个点（a，b）在这条线上，如果它满足这个方程，即`b = ma + c`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-01T20:31:06.307

作为该方法的替代`slope/y-intercept`方法，我使用以下方法选择了这种方法`Math.Atan2`：

```
// as an extension method
public static bool Intersects(this Vector2 v, LineSegment s) {
    //  check from line segment start perspective
    var reference = Math.Atan2(s.Start.Y - s.End.Y, s.Start.X - s.End.X);
    var aTanTest = Math.Atan2(s.Start.Y - v.Y, s.Start.X - v.X);

    //  check from line segment end perspective
    if (reference == aTanTest) {
        reference = Math.Atan2(s.End.Y - s.Start.Y, s.End.X - s.Start.X);
        aTanTest = Math.Atan2(s.End.Y - v.Y, s.End.X - v.X);
    }

    return reference == aTanTest;
} 
```

第一次检查`reference`确定从线段起点到终点的 arcTan。然后从起点角度，我们确定arcTan到vector `v`。

如果这些值相等，我们从端点的角度进行检查。

简单并处理水平、垂直和介于两者之间的所有其他内容。

# ruby-on-rails - 有没有生成脚手架而不生成迁移的选项？

> ID：907391
> 
> 赞同：18
> 
> 时间：2009-05-25T16:55:05.140
> 
> 标签：ruby-on-rails, migration

在 Rails 中困扰我的一件事是脚手架会生成我并不总是需要的迁移。

有没有办法在没有相应迁移的情况下生成脚手架？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-25T16:58:52.077

使用`--skip-migration`参数。例如：

```
rails generate scaffold post title:string body:text --skip-migration 
```

# java - 从 @WebService 获取对 spring bean 的引用

> ID：907394
> 
> 赞同：1
> 
> 时间：2009-05-25T16:56:58.913
> 
> 标签：java, web-services, spring, cxf

我正在使用 CXF 从 wsdl 生成 Web 服务。生成的 web 服务有注释 @WebService 我如何从 web 服务中获取对 spring bean 的引用？我所有的 spring bean 都用 @Service 进行了注释，我可以在我的 web 应用程序中访问它们。我如何也从我的 Web 服务访问它们？

我尝试了以下方法：

```
public class TestWSImpl implements TestWSSoap{

    @Resource
    public WebServiceContext wsContext;

    @Override
    public String getTest() {

        ServletContext servletContext= (ServletContext) wsContext.getMessageContext().get(MessageContext.SERVLET_CONTEXT);

        ApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(servletContext);

        return "Test";
    }
} 
```

但是 getWebApplicationContext 方法返回 null

当我将 getWebApplicationContext 替换为 getRequiredWebApplicationContext 时，我收到一条错误消息：未找到 WebApplicationContext：未注册 ContextLoaderListener？

有人有想法吗？

谢谢阿隆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T17:07:21.737

如果您使用的是 JUnit 4.4 或更高版本，则可以使用 Spring 2.5 JUnit 注释注入它。这是一个例子。

[http://hamletdarcy.blogspot.com/2008/12/autowired-junit-tests-with-spring-25.html](http://hamletdarcy.blogspot.com/2008/12/autowired-junit-tests-with-spring-25.html)

当然，不用说，这种方法要求 Web 服务在测试开始时在 Web 上下文中运行。你这样做了吗？

您也可能更喜欢使用[SOAP UI 测试基于 WSDL 的服务。](http://www.soapui.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-02T08:31:24.077

那是很久以前。我正在查看我的代码，我看到我放置了以下应该启动 spring 的方法：

```
@PostConstruct
public void init(){
    JaxWsServerFactoryBean svrFactory = new JaxWsServerFactoryBean();
    svrFactory.setServiceClass(MyWebService.class);
    svrFactory.setAddress("http://address.com");
    svrFactory.setServiceBean(wsHandler);
    svrFactory.getInInterceptors().add(new LoggingInInterceptor());
    svrFactory.getOutInterceptors().add(new LoggingOutInterceptor());
    svrFactory.create(); 
```

}

请告诉我它是否解决了你的问题......

# delphi - 具有泛型的接口 - 设置为 NIL

> ID：907406
> 
> 赞同：13
> 
> 时间：2009-05-25T17:00:51.230
> 
> 标签：delphi, generics, delphi-2009

我试图在 Delphi 2009 的以下示例代码中实现 clear 。

```
interface
...
  TFoo<T : IInterface> = class(TObject)
    FField : T;
    procedure Clear;
  end;
...
implementation
...
procedure TFoo<T>.Clear;
begin
  // Line Below Results In
  //  E2010 Incompatible types: 'T' and 'Pointer' 
  FField := nil;
end;
... 
```

如果“T”不受限制，我可以理解编译时间错误。但是由于“T”必须是一个接口，我原以为这种语法会起作用。

是否可以将 FField 设置为 NIL，以便释放接口？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-25T17:04:20.493

而不是`nil`您必须使用`Default(T)`返回泛型参数类型的默认值的 new 。对于接口，它是`nil`

```
procedure TFoo<T>.Clear;
begin
  FField := Default(T);
end; 
```

# architecture - 客户端（桌面应用程序）提取数据......但我希望服务器（网络应用程序）推送数据

> ID：907408
> 
> 赞同：6
> 
> 时间：2009-05-25T17:01:26.253
> 
> 标签：architecture, .net-2.0, client-server, server-push

我有一个客户端-服务器应用程序——其中服务器本质上是一个 ASP .NET Web 应用程序，而分布式客户端是桌面应用程序。

客户端需要从服务器接收一些数据 - 当客户端有新数据时。现在，这样做的方式是 - 客户端每隔 x 分钟（比如 2 分钟）不断查询 Web 服务，并不断检查客户端是否有新数据。

理想情况下，它应该工作的方式是桌面应用程序应该在更新可用时接收更新，它不需要从服务器中提取；相反，服务器应该能够推送到客户端。

我该如何去做——考虑到解决方案的架构——Web 应用程序需要将数据推送到同一网络（LAN）中的桌面应用程序（客户端）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-25T17:20:08.167

您所描述的是“服务器推送”，现在通常称为“COMET”。在网络搜索中使用这些关键字应该会发现很多有用的信息。

最常见的技术称为“悬挂 GET”。客户端向特定 URL 发送 GET 请求，服务器接受连接但延迟发送响应，直到它有数据要发送。当客户端收到响应时，它会发送另一个 GET，以便准备好接收另一个消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T17:07:48.460

您可以使用 WCF 回调 - 这是一个 Web 服务，您可以在其中订阅来自客户端的通知，服务器将向订阅的客户端发送消息。我的博客上有一个[初学者指南。](http://idunno.org/archive/2008/05/29/wcf-callbacks-a-beginners-guide.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T17:17:01.133

您可能对[SO question](https://stackoverflow.com/questions/136012/comet-and-jquery)感兴趣。你所描述的听起来像一个彗星应用程序 - 服务器推送到客户端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-10T16:45:53.213

查看[WebSync](http://www.frozenmountain.com/websync)；它是 ASP.NET/IIS 的 Comet 解决方案，但也有一个完整的 .NET 客户端可用，它可以与胖客户端、Windows 服务等集成。所以听起来它应该非常适合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T17:04:33.740

如果您可以让套接字保持打开状态，则客户端可以连接到服务器，并且服务器可以在适当的时候将数据推送到套接字。没有理由启动连接的一侧必须始终是启动数据传输的一侧。

# drupal - Drupal：自定义 WorkFlow 模块的外观

> ID：907413
> 
> 赞同：0
> 
> 时间：2009-05-25T17:02:48.857
> 
> 标签：drupal, workflow

工作流模块向编辑节点屏幕添加了一个工作流框。此框包含此节点的可用状态列表以及以下额外选项：

> " 时间表：立即 状态变化时间表："

我不想用大量选项混淆用户，并希望删除最后两个（与日期相关）。我应该在哪里自定义编辑屏幕的外观并隐藏这些字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-12T21:13:01.813

您可以在“权限”页面上禁用工作流调度。在管理员/用户/权限上，取消选中“安排工作流程转换”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T17:13:49.500

该[`hook_form_alter`](http://api.drupal.org/api/function/hook_form_alter)钩子可用于修改任何 Drupal 表单的外观。

这里有一些伪代码可以帮助您入门。

```
<?php

function mymodule_form_alter(&$form, $form_state, $form_id) {
  if($form_id == 'id_of_the_form') {
    unset($form['field_you_want_to_hide']);
  }
} 
```

# java - Java中的自由绘图画布（带有形状）

> ID：907434
> 
> 赞同：2
> 
> 时间：2009-05-25T17:09:55.510
> 
> 标签：java, drawing, paint

我正在开发一个允许用户创建设计图的 GMF (RCP/EMF/GEF) 应用程序。作为该应用程序的一部分，我们必须允许用户创建自己的自定义形状以添加到图表中。我们正在考虑使用 SVG 作为形状的存储格式。

我正在寻找一个创建此类画布并允许我们将图像导出为 SVG 文件的 Java 库。它还应该能够导入 SVG 文件并允许操作。即使是 Eclipse 插件也可以，因为我猜我们应该能够在 RCP 应用程序中制作 Eclipse 插件，只要该插件是开源的。

我们将在应用程序中使用 Batik 进行 SVG 工作。许可说明：我们不想让我们的应用程序开源，因此具有 LGPL 等需要衍生作品开源的许可证的库对我们不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T17:26:20.263

试试[蜡染](http://xmlgraphics.apache.org/batik/)。 [GLIPS](http://glipssvgeditor.sourceforge.net/)是使用 Batik 完成类似事情的一个例子。

# sql - 我可以在 SQL 结果表中获取记录的位置吗？

> ID：907438
> 
> 赞同：10
> 
> 时间：2009-05-25T17:12:25.070
> 
> 标签：sql, sql-order-by

如果我做类似的事情

```
SELECT * FROM mytable ORDER BY mycolumn ASC; 
```

我按特定顺序得到一个结果表。

在给定 PK 的情况下，SQL 中有没有一种方法可以有效地找出结果表中的哪个位置将包含我的 PK 记录？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-25T17:17:58.153

您可以计算要排序的值的值低于您知道以下键值的记录的记录数：

```
select count(*)
from mytable
where mycolumn < (select mycolumn from mytable where key = 42) 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-25T17:14:35.083

在支持它的数据库上，您可以为此目的使用 ROW_NUMBER()：

```
SELECT RowNr
FROM (
    SELECT 
         ROW_NUMBER() OVER (ORDER BY mycolumn) AS RowNr,
         mycolumn
    FROM mytable
) sub
WHERE sub.mycolumn = 42 
```

该示例假设您正在寻找主键 42 :)

子查询是必要的，因为类似：

```
SELECT 
     ROW_NUMBER() OVER (ORDER BY mycolumn) AS RowNr
FROM mytable
WHERE sub.mycolumn = 42 
```

将始终返回 1；ROW_NUMBER() 在 WHERE 之后起作用，可以这么说。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T17:16:44.130

SQL 不能那样工作。它是基于集合的，这意味着“该结果表中的位置”对数据库没有意义。

当您将 ResultSet 映射到对象集合或迭代它时，您可以跟踪位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T18:48:40.103

不幸的是，您无法获得“表格中一行的位置”。

使用 ORDER BY 和 ROW_NUMBER 构造的变体（取决于使用的数据库引擎），您可以获得的最佳结果是执行查询的结果集中的行位置。

但是，该位置不会映射回表中的任何位置，除非 ORDER BY 位于一组聚集索引列上，但即便如此，该位置也可能在下一秒失效。

我想知道的是你打算用这个“职位”做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-14T21:52:45.383

## 这个答案适用于 MySQL

**==> 低于 8.0**

```
SET @row_number = 0; 
SELECT 
    (@row_number:=@row_number + 1) AS num, 
    myColumn.first, 
    myColumn.second
FROM
    myTable
ORDER BY myColumn.first, myColumn.second 
```

来源：[http ://www.mysqltutorial.org/mysql-row_number/](http://www.mysqltutorial.org/mysql-row_number/)

* * *

**==> 大于 8.0**

请参阅[MySQL ROW_NUMBER() 函数手册](https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_row-number)，因为我没有测试。但似乎这个功能是首选。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-25T17:15:27.767

如果不选择整个记录子集，您将无法判断这一点。如果你的 PK 是整数类型，你可以

```
select count(*) from mytable 
    where id <= 10 -- Record with ID 10
    order by mycolumn asc 
```

# ruby-on-rails - 在 Rails 控制器中测试 GET

> ID：907443
> 
> 赞同：0
> 
> 时间：2009-05-25T17:15:11.930
> 
> 标签：ruby-on-rails, ruby, rspec

我有一种感觉，我只是在语法上做错了什么，但谷歌“GET”非常困难，所以我希望这里的人可能知道这个问题的答案。

我正在尝试从 RSpec 测试中测试 Rails 控制器。我正在关注我在这里找到的一个例子 - [http://www.elevatedrails.com/articles/2007/09/10/testing-controllers-with-rspec/](http://www.elevatedrails.com/articles/2007/09/10/testing-controllers-with-rspec/)但我被困在我的方法的实际执行上米测试。

我正在做一个 GET 请求，上面的帖子是一个 POST。我传入了 2 个参数制造商和型号。

理想情况下，我的 URL 类似于[http://mysite.com/Products/index/Manufacturer/ModelName](http://mysite.com/Products/index/Manufacturer/ModelName)

我无法弄清楚其余部分中获取请求调用的语法。现在我有

```
get :index, :manufacturer=>@manufacturer, :modelName=>@modelName 
```

我回来了

> 'ProductController 中的 ArgumentError 找到一个有效的产品应该检索产品'的参数数量错误（0 代表 2）

有什么想法吗？

编辑：应该注意@manufacturer 和@modelName 在 before(:each) 中定义

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T01:18:16.993

因为我怀疑这是我对 Rails 编程的绿色。

我将控制器方法定义为

```
def index(manufacturer, modelName) 
```

当我真的需要使用参数哈希来访问属性时。然后我必须定义一个自定义路由，因为 id 是默认情况下预期传递给控制器​​方法的唯一参数。

一旦我这样做了，我将规范更改为阅读

```
get :index, {:manufacturer=>@manufacturer, :modelName=>@modelName} 
```

它奏效了。

感谢大家的评论。

# ruby-on-rails - 迁移格式 Add x to y 中是否存在（必要的）冗余？

> ID：907446
> 
> 赞同：1
> 
> 时间：2009-05-25T17:15:47.860
> 
> 标签：ruby-on-rails, migration, dry

要将电话列添加到门票表中，我可以编写：

```
ruby script/generate migration AddPhoneToTickets phone:string 
```

这里似乎有冗余。但是有必要吗？

我们不是在重复自己被要求在迁移名称（`AddPhoneToTickets`）和列定义（`phone:string`）中都指定“电话”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T17:23:25.773

您*不需要*将 Phone 放在迁移名称中。例如，如果您要添加一堆联系人字段，您可以轻松调用它`AddContactFieldsToTickets`并指定所有字段。实际上，将迁移的名称用于除表名之外的任何内容都不够具体。

# sharepoint - 预览 InfoPath 附件

> ID：907452
> 
> 赞同：0
> 
> 时间：2009-05-25T17:16:18.810
> 
> 标签：sharepoint, infopath

我有一份表格，Legal 将使用它来跟踪商标声明。他们希望能够将徽标附加到此以便于参考。创建文件附件很容易，但是有没有办法显示附件图像的预览？

该解决方案必须在启用浏览器的表单中可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T09:29:11.183

您可以在表单库中添加一个链接列（名为预览），该链接列指向 layouts 目录中的 .aspx 页面，您可以在其中读取表单 xml 并生成包含附件预览的文档预览。

通过这种方式，您可以处理不同的附件格式（例如使用 C# 代码）并绕过表单服务的有限功能。

您可以将“编辑此表单”按钮添加到重定向到原始表单服务 url 的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T22:55:41.230

附件以 base64 格式存储。您需要以某种方式将该数据发布到服务器，对其进行正确编码，然后以 jpg 格式将其发送回客户端。这有点工作，但我确信这是可行的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-25T20:02:14.370

大多数浏览器都支持 base64 解码，因此您可以非常轻松地直接指向 base64 数据。

您可能想在 Internet Explorer 中查看 base64：http: [//dean.edwards.name/weblog/2005/06/base64-sexy/](http://dean.edwards.name/weblog/2005/06/base64-sexy/)

# web-services - 在 restful 应用程序之上构建 wiki

> ID：907454
> 
> 赞同：0
> 
> 时间：2009-05-25T17:16:50.103
> 
> 标签：web-services, rest, integration, wiki

有人知道可以在 RESTful 应用程序之上构建的 wiki 引擎吗？我有一个开放的应用程序，它公开了一个文档资源，我希望 wiki 引擎使用 REST API 来保存文档，而不是将它们保存到数据库中。我也愿意接受可以轻松修改以支持此类功能的开源 wiki 引擎的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T05:43:16.290

由于 Wiki 最初是为在标准浏览器中工作而设计的，并且大多数浏览器不支持除 GET 和 POST 之外的任何内容，因此 REST 并不是一个在 wiki 世界中经常使用的概念。然而，如今，一些 wiki（例如 foswiki - TWiki 的社区分支）为您提供了一个 REST API（[http://foswiki.org/System/CommandAndCGIScripts#rest](http://foswiki.org/System/CommandAndCGIScripts#rest)）。

但是你需要相反的东西：一个带有可定制后端（存储）的 wiki，可以插入到 REST 存储服务之上。作为具有可插拔后端的 wiki，我只知道 pmwiki [http://www.pmwiki.org/wiki/PmWiki/PmWiki](http://www.pmwiki.org/wiki/PmWiki/PmWiki)和 foswiki（TWiki 的开放分支）[http://foswiki.org](http://foswiki.org)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:33:13.743

dokuwiki 不使用数据库。它是一个基于文件系统的wiki。我不知道它的内部代码结构，但你也许可以将它用作你的基础。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T17:24:44.773

好吧，这是一个谜题。一般来说，Wiki 或多或少是 RESTful 方法的典型示例。页面名称命名资源。您想要什么不在例如 Twiki 中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T17:51:25.117

虽然您可以尝试找到可以使用 REST 后端的 wiki，但最好自己编写一个小型 wiki。因为即使您的后端有 REST 接口，这并不意味着您可以在它前面放置一些其他应用程序。

# ms-word - 更改 word 2007 中的复选框（Activex 控件）

> ID：907457
> 
> 赞同：1
> 
> 时间：2009-05-25T17:17:30.867
> 
> 标签：ms-word, activex, controls

在 word 2007 中，我尝试使用默认的 activex 控件作为复选框。我想在有人选中它之后改变文本的颜色。

我知道如何使用 VBA 和复选框表单域来完成它，但是如何使用复选框（活动控件）来完成呢？

简而言之，有什么方法可以检索 ActiveX 控件复选框的属性或其他对象信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-14T08:12:54.730

我认为这个答案对于提问者来说为时已晚，我如何将它发送给以后将面临这个问题的人。

如果您知道如何在 VBA 中更改复选框颜色，那么您也可以在 Word 中进行更改。您所要做的就是插入一个复选框，您可以自己编写代码。这样做。

1.  点击MS WORD 07窗口左上角的word按钮，在MS Word中生成开发者标签；选择高级；选择热门；然后在打开的平底锅中，选中包含开发者选项卡的复选框。

2.  现在单击开发人员选项卡，找到控制组，然后从它们中单击旧工具下拉菜单。单击旧工具下拉菜单左下角的更多控件选项。将打开一个新窗口。

3.  向下滚动以找到选项 Micrsoft Forms 2.0 复选框。

4.  单击以选择它，您就完成了。在开始此过程之前，您将在光标闪烁的位置收到一个复选框。

5.  此复选框与 VB 中的复选框非常相似。现在，如果您知道 VBA 代码并想更改复选框的属性，例如颜色等。请查看开发人员选项卡中的控制组。单击设计模式。现在双击复选框并打开 VB 编码表格，您可以在其中进行编码。

6.  如果您不知道如何在 VB 中编写代码，您仍然可以在复选框中进行一些有用的更改。单击复选框，然后单击开发人员选项卡中设计模式下方的属性。

7.  您可以在此处更改属性。

# java - 开发环境 Java 6、Maven 2.x、Eclipse 3.4.x、JBoss 5 和 JBoss Seam

> ID：907459
> 
> 赞同：1
> 
> 时间：2009-05-25T17:18:39.697
> 
> 标签：java, maven-2, jboss, development-environment, eclipse-3.4

我必须组织一个开发环境，在其中我可以使用 JBoss Seam、IDE eclipse 3.4.x 运行 Maven 项目并部署到 JBoss 5。将在此环境中运行的项目基于 Java 6、EJB3 和 JSF1.2。环境必须支持热部署。

我曾经在使用 Sysdeo Plugin 的开发环境中工作，以使 Tomcat 运行我所有的应用程序——我很少使用 EJB（仅用于 MDB）。所以我更喜欢类似这样的环境。

我想知道你们使用什么样的架构（什么样的eclipse插件 - 如果它们工作正常，类似的东西）

* * *

我真的没有做对的是为什么我的 Maven2 项目将 SEAM 作为依赖项打包为 EAR 没有出现在我的服务器中（在 Eclipse Ganymede - 选项卡服务器中）让我进行部署（右键单击 - 选项添加和删除项目...）。我是否必须包含特定的项目性质才能使我的 Maven2 EAR 项目对我的 Eclipse Ganymede 中包含的 JBoss AS 可见？

* * *

Seam 似乎不适合 Maven2。我面临一些问题，使它们一起工作 - 一些依赖项似乎丢失了，我必须将一些额外的文件放在一些特殊的地方，比如 seam.properties 和 components.xml 有一些特殊的内容。我觉得被迫使用 seam-gen 和 Ant。太糟糕了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T21:07:07.500

不确定这是否对您有帮助，但我们运行以下

*   Eclipse 作为 IDE
*   用于源代码管理的 mercurial
*   merclipse mercurial eclipse 插件[http://goldenhammers.com/merclipse/](http://goldenhammers.com/merclipse/)
*   用于构建（和 m2eclipse）的 Maven
*   mylyn 与 bugzilla 进行问题跟踪
*   tomcat 作为应用服务器
*   哈德森持续集成[http://hudson-ci.org/](http://hudson-ci.org/)
*   代码审查的审查板[http://www.review-board.org/](http://www.review-board.org/)
*   用于代码质量指标的声纳[http://sonar.codehaus.org/](http://sonar.codehaus.org/)
*   proxmox VE 用于虚拟化[http://pve.proxmox.com/wiki/Main_Page](http://pve.proxmox.com/wiki/Main_Page)

大多数事情都在单独的虚拟机上运行，​​以将干扰降至最低。Proxmox VE 设置起来很容易（15 分钟就可以运行）。

Hudson 监控存储库并自动构建和测试每次推送。如果战争构建成功，它会自动（重新）部署（使用 hudson 插件）到 Tomcat 中并重新启动。

我不能足够推荐这些工具。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T18:32:22.133

我目前正在您要求的相同环境中工作，唯一的区别是我在 tomcat 6.0.18 上运行该应用程序。我更喜欢使用 tomcat，因为它运行起来非常快，而且我现在不使用 EJB。

Eclipse 插件：

*   行家：m2eclipse.codehaus.org
*   jboss 工具：www.jboss.org/tools
*   用于热部署的 Web 工具平台：www.eclipse.org/webtools/

我拿的是 Eclipse Java EE 版本，我不使用 seam-gen 来创建基本架构。

我这个环境没有太多问题，有时热部署不起作用，我必须手动清理文件。我遇到的唯一问题是将我的应用程序分成两个模块：eclipse 做得不好（在构建另一个模块时没有获取一个模块的最后一个包），我发现了“禁用工作区分辨率”选项，现在工作正常。

工作正常。希望它会适合你。

# delphi - 如何在 VirtualExplorerTreeview (VirtualShellTools) 中根据需要对数据进行排序

> ID：907461
> 
> 赞同：0
> 
> 时间：2009-05-25T17:18:57.153
> 
> 标签：delphi, components

对于知道 VirtualShellTools 的人来说，这可能是一个非常“愚蠢”的问题，但我才开始使用它，在演示代码中找不到我的答案。请注意，我也不熟悉 virtualtreeview。

我使用 VirtualExplorerTreeview 显示目录结构，与 VirtualExplorerListview 链接以显示所选目录中的某种类型的文件以及有关它们的特定信息

我已经能够将它们指向正确的位置，根据需要链接它们，过滤列表视图中的所有内容，并查看演示我对如何添加我自己的列并绘制它以显示我的自定义有一个很好的想法数据。

我的问题在于 Treeview：我想按我想要的顺序对显示的目录进行排序；具体来说，我希望“我的文档”和其他文件夹首先出现，然后是驱动器，然后是可移动媒体。查看 TNamespace 属性，我发现如何区分它们（目录和可移动属性），但我不知道如何实现我自己的排序/我需要什么事件。我尝试了 CompareNode 但这似乎没有被调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T19:28:39.680

如果您想自己做所有事情，请`toUserSort`在`TVirtualExplorerTree.TreeOptions.VETMiscOptions`属性中设置。这导致控件只使用`DoCompare`从虚拟树视图继承的方法，并且应该调用`OnCompareNodes`事件处理程序。

更好的方法是提供自定义`TShellSortHelper`. 创建该类的后代并覆盖您需要的任何方法。创建该类的实例并将其分配给树的`SortHelper`属性。（树获得助手的所有权；释放旧的，但不释放新的。）如果项目在该类不知道如何比较的列上排序，则处理树的`OnCustomColumnCompare`事件。

为了帮助您准确确定需要覆盖哪些方法或需要处理哪些事件，请设置断点`TCustomVirtualExplorerTree.DoCompare`并逐步查看在各种情况下调用的内容。

# silverlight - Silverlight 的依赖注入？

> ID：907464
> 
> 赞同：2
> 
> 时间：2009-05-25T17:19:38.523
> 
> 标签：silverlight, dependency-injection, structuremap

我通常使用 StructureMap.dll（来自 MvcContrib）在 .NET 中进行依赖注入。

是否有 Silverlight 的等价物，或者任何人使用的任何工具？很明显，我可以用手来做，而且并不难。但我想知道是否有像 StructureMap 这样形式化的东西，但对于 Silverlight。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T17:28:05.597

Ninject 可以。一些资源：

[http://jonas.follesoe.no/2008/07/24/youcard-re-visited-implementing-dependency-injection-in-silverlight/](http://jonas.follesoe.no/2008/07/24/youcard-re-visited-implementing-dependency-injection-in-silverlight/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-19T17:47:46.950

AutoFAC 也可以（根据我看到的基准测试，它比 NInject 更快）。

[http://code.google.com/p/autofac/downloads/list](http://code.google.com/p/autofac/downloads/list)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-26T06:49:22.953

不久前，我写了一篇[关于在 Silverlight 中使用 Ninject 和 MVVM 的教程](http://www.timmykokke.com/2010/12/dependency-injection-mvvm-ninject-and-silverlight/)。本教程解释了如何使用 Ninject。它描述了它的一些基本特性，比如以不同的方式设置绑定和使用构造函数注入。这些教程提供了有关在使用绑定时如何使用 ViewModelLocator 从 Ninject 解析对象的示例。

我个人最常使用 Ninject。

# c# - 绘制对象并处理它们的最佳方法是什么？

> ID：907466
> 
> 赞同：0
> 
> 时间：2009-05-25T17:20:26.417
> 
> 标签：c#, .net, graphics, gdi+

***你好，***

我想在我的 PictureBox 上绘图，然后处理我创建的那些绘图。

将他们的点存储在一个数组中并处理这个数组是一种好方法吗？

**或者更好的方法是让它们成为对象并处理这些对象？。**如果可以的话，你能不能让我先做那个？？

谢谢我真正的老师。

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T17:26:08.393

如果绘图的元素可能会改变，那么对象（形状）是最好的。但是点的集合也是一个对象。

主要的替代方法是分层方法，使用带有透明背景的单独位图来保存点。

# c++ - C++0x 初始化列表示例

> ID：907471
> 
> 赞同：8
> 
> 时间：2009-05-25T17:24:07.787
> 
> 标签：c++, c++11, initializer-list

我想看看这个现有代码示例如何能够利用 C++0x 初始化程序列表功能。

示例0：

```
#include <vector>
#include <string>
struct Ask {
    std::string prompt;
    Ask(std::string a_prompt):prompt(a_prompt){}
};
struct AskString : public Ask{
    int min;
    int max;
    AskString(std::string a_prompt, int a_min, int a_max):
        Ask(a_prompt), min(a_min), max(a_max){}
};
int main()
{
    std::vector<Ask*> ui;
    ui.push_back(new AskString("Enter your name: ", 3, 25));
    ui.push_back(new AskString("Enter your city: ", 2, 25));
    ui.push_back(new Ask("Enter your age: "));
} 
```

它会支持这样的事情吗：

示例 1：

```
std::vector<Ask*> ui ={
    AskString("Enter your name: ", 3, 25),
    AskString("Enter your city: ", 2, 25),
    Ask("Enter your age: ")
    }; 
```

还是必须有这样的文字？：

示例 2：

```
std::vector<Ask*> ui ={
    {"Enter your name: ", 3, 25},
    {"Enter your city: ", 2, 25},
    {"Enter your age: "}
    }; 
```

如果是这样，将如何处理 AskString 和 Ask 之间的差异？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-25T17:33:16.230

当您要求指针时，您的最后一个示例将不被允许，而是尝试提供本地临时对象。

```
std::vector<Ask*> ui ={
    new AskString{"Enter your name: ", 3, 25},
    new AskString{"Enter your city: ", 2, 25},
    new Ask{"Enter your age: "}
    }; 
```

这是允许的，并且不会有类型歧义。

那也是对的：

```
std::vector<Ask*> ui ={
        new AskString("Enter your name: ", 3, 25),
        new AskString("Enter your city: ", 2, 25),
        new Ask("Enter your age: ")
        }; 
```

你的例子更像是：

```
std::vector<Ask> ui ={  // not pointers
    {"Enter your name: "},
    {"Enter your city: "},
    {"Enter your age: "}
    };

std::vector<AskString> uiString ={  // not pointers
    {"Enter your name: ", 3, 25},
    {"Enter your city: ", 2, 25},
    {"Enter your age: ", 7, 42}
    }; 
```

并且在类型上也不会有歧义。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-25T17:33:00.893

C++ 初始化器列表是*同质*的，这意味着它必须具有所有相同的类型，因此示例 #2 不可用。如果您`new`在示例 1 中使用，它会起作用。

# javascript - 如何阻止父事件触发？

> ID：907484
> 
> 赞同：1
> 
> 时间：2009-05-25T17:28:30.073
> 
> 标签：javascript, html, function

如果我有...

```
<div id="parent" onmouseover="doSomething()">
    <div id="child" onmouseover="doSomethingElse()">
    </div>
</div> 
```

当我将鼠标悬停在孩子上时，我怎样才能做到 doSomething() 不执行？我只希望 doSomethingElse() 在我悬停在孩子上时执行，我只希望 doSomething() 在我悬停在父母上时执行。

每当我将鼠标悬停在孩子身上时，这两个功能都会执行。有任何想法吗？

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T17:33:15.683

```
function doSomethingElse(e) {
// your function body

e.stopPropagation() 

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T17:35:49.610

将属性值更改为

```
onmouseover="doSomethingElse(event)" 
```

并更改`doSomethingElse()`为

```
function doSomethingElse(e) {
    e.stopPropagation && e.stopPropagation();
    e.cancelBubble = true;
    // ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T17:36:02.810

我没有测试它，但应该有几种方法可以做到这一点。

请检查事件冒泡：在 IE 和 Firefox 中有所不同，但仍然：www.quirksmode.org/js/events_order.html

# greasemonkey - 如何编写用户脚本以便它们在 Opera 和 Greasemonkey 中都能工作

> ID：907486
> 
> 赞同：2
> 
> 时间：2009-05-25T17:29:08.263
> 
> 标签：greasemonkey, opera, userscripts

我现在正在研究用户脚本。我知道 Opera 与 Greasemonkey 脚本的许多方面兼容，但与其他方面不兼容。

Opera 需要[GM 功能仿真脚本](http://www.howtocreate.co.uk/operaStuff/userJavaScript.html)，一开始我有

```
if(window.opera) {
    var unsafeWindow = window;
} 
```

但除此之外，如果我希望我的脚本在两者中运行，我还应该记住哪些其他事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:19:12.560

我的[Endless Tweets](http://userscripts.org/scripts/show/24398)用户脚本同样适用于 Firefox、WebKit 和 Opera。

我正在使用[我自己编写的兼容性脚本](http://github.com/mislav/user-scripts/blob/master/toolkit/gm_functions.js)，它提供`GM_getValue`、`GM_setValue`、和.`GM_xmlhttpRequest``GM_addStyle``GM_log`

但是，我不喜欢使用“GM_”前缀，因为用户脚本是跨平台的，所以脚本有这个 API：

```
getValue()
setValue()
xhr()
addCSS()
log() 
```

[在编写用户脚本时检查工具包](http://github.com/mislav/user-scripts/blob/master/toolkit/toolkit.js)的其余部分以获得更多有用的功能。

# sql - 在 MySQL 中导入非英语维基百科 XML 转储？

> ID：907492
> 
> 赞同：0
> 
> 时间：2009-05-25T17:32:34.733
> 
> 标签：sql, xml, import, wikipedia

我正在寻找一个可以将 XML wikipedia DUMP 转换为 MySQL 兼容 SQL 的脚本。我为英文版找到了一个现成的 SQL 转储，但没有简单的方法可以导入其他语言。

谢谢，

皮耶罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T18:18:51.023

根据[维基百科自己关于该主题的页面（非常值得研究），可以在](http://en.wikipedia.org/wiki/Wikipedia_database)[此 mediawiki 页面](http://www.mediawiki.org/wiki/Manual:Importing_XML_dumps)上找到将 wikipedia xml 转储导入 mysql 的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T17:36:48.207

维基百科有一个 API

*   [http://fr.wikipedia.org/w/api.php](http://fr.wikipedia.org/w/api.php)
*   [http://de.wikipedia.org/w/api.php](http://de.wikipedia.org/w/api.php)
*   [http://es.wikipedia.org/w/api.php](http://es.wikipedia.org/w/api.php)
*   (...)

您可以使用此 API 来遍历文章并下载每个页面。

# html - 任何 Html 控件库 - jQuery/Prototype 的可视化对应物

> ID：907500
> 
> 赞同：0
> 
> 时间：2009-05-25T17:35:57.160
> 
> 标签：html, internet-explorer, firefox, controls, dimensions

jQuery 提供了一个浏览器中立的库来访问和操作 DOM。这很好。

但是，我正在寻找视觉方面的对应物 - 我需要构建像素测量界面，而不是浪费太多时间测试和纠正跨浏览器问题（在 IE 中具有疯狂边距的按钮，或在 FireFox 中使用错误的框模型. 许多 IE 和其他情况下将多个元素放在一条线上会导致对齐或浮动）。

基本上，我需要能够在纸上规划出具有精确像素尺寸的界面（例如，所有文本框的高度都应为 22 像素），然后轻松地将这些设计转换为 Html。在 WinForms 世界中，这通常是直截了当的。使用 html 就没有什么了，而且我发现在输入控件方面它是最糟糕的。

我可以使用哪些库或集合来使这种设计成为现实（除了将所有东西都转换为存在这种程度的控制的 Silverlight 之外）。需要启用 Javascript（以 AJAX 开头），因此库可以完全依赖它来进行控制。

我正在寻找具有精确像素控制的统一风格的一些组件

按钮
Textboxes
Dropdowns
ComboBoxes（可以直接编辑文本的下拉菜单）
Toggle Buttons

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T19:22:19.880

另请查看[ExtJS](http://www.extjs.com/)。我已经广泛使用了这个，我可以保证它有多好。最初它是Soviut 提到的[Yahoo UI Library (YUI) 的一个分支。](http://developer.yahoo.com/yui/)就个人而言，我认为它比原来的 YUI 更好，更实用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T19:31:26.383

替代方案包括**dojo**（纯 JS）和**GWT**（从 Java 生成的 JS）。有些人可能会争辩说，完全放弃 JS 并使用支持 Flash 的**Flex**是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T17:39:59.230

[JQuery UI](http://jqueryui.com/)是 JQuery 的一个很好的扩展，它允许丰富的控件，如对话框、拖放等。

[Yahoo Interface Library](http://developer.yahoo.com/yui/)是您可以使用的另一个工具集，它可能更接近您最初的要求。

# django - 如何直接从测试驱动程序调用自定义 Django manage.py 命令？

> ID：907506
> 
> 赞同：199
> 
> 时间：2009-05-25T17:39:05.703
> 
> 标签：django, unit-testing

我想为对数据库表执行后端操作的 Django manage.py 命令编写单元测试。如何直接从代码调用管理命令？

我不想从 tests.py 在操作系统的 shell 上执行命令，因为我无法使用使用 manage.py test 设置的测试环境（测试数据库、测试虚拟电子邮件发件箱等...）

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2009-05-25T19:04:02.023

测试此类事情的最佳方法 - 从命令本身提取所需的功能到独立函数或类。它有助于从“命令执行的东西”中抽象出来，并在没有额外要求的情况下编写测试。

但是，如果您由于某种原因无法解耦逻辑表单命令，您可以使用[call_command](https://docs.djangoproject.com/en/2.0/ref/django-admin/#running-management-commands-from-your-code)方法从任何代码中调用它，如下所示：

```
from django.core.management import call_command

call_command('my_command', 'foo', bar='baz') 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-08-01T20:42:07.033

您可以通过执行以下操作来运行您的任务，而不是使用 call_command 技巧：

```
from myapp.management.commands import my_management_task
cmd = my_management_task.Command()
opts = {} # kwargs for your command -- lets you override stuff for testing...
cmd.handle_noargs(**opts) 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-10-26T00:00:46.203

以下代码：

```
from django.core.management import call_command
call_command('collectstatic', verbosity=3, interactive=False)
call_command('migrate', 'myapp', verbosity=3, interactive=False) 
```

...等于在终端中键入的以下命令：

```
$ ./manage.py collectstatic --noinput -v 3
$ ./manage.py migrate myapp --noinput -v 3 
```

请参阅[django 文档中的运行管理命令](https://docs.djangoproject.com/en/1.7/ref/django-admin/#running-management-commands-from-your-code)。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-09-29T18:13:47.357

[call_command 上](https://docs.djangoproject.com/en/1.10/topics/testing/tools/#management-commands)的Django 文档没有提到`out`必须重定向到`sys.stdout`. 示例代码应为：

```
from django.core.management import call_command
from django.test import TestCase
from django.utils.six import StringIO
import sys

class ClosepollTest(TestCase):
    def test_command_output(self):
        out = StringIO()
        sys.stdout = out
        call_command('closepoll', stdout=out)
        self.assertIn('Expected output', out.getvalue()) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-21T17:36:58.917

基于 Nate 的回答，我有这个：

```
def make_test_wrapper_for(command_module):
    def _run_cmd_with(*args):
        """Run the possibly_add_alert command with the supplied arguments"""
        cmd = command_module.Command()
        (opts, args) = OptionParser(option_list=cmd.option_list).parse_args(list(args))
        cmd.handle(*args, **vars(opts))
    return _run_cmd_with 
```

用法：

```
from myapp.management import mycommand
cmd_runner = make_test_wrapper_for(mycommand)
cmd_runner("foo", "bar") 
```

这里的好处是，如果您使用了其他选项和 OptParse，这将为您解决问题。它不是很完美——它还没有管道输出——但它会使用测试数据库。然后，您可以测试数据库效果。

我确信使用 Micheal Foords 模拟模块并在测试期间重新连接标准输出将意味着您也可以从这种技术中获得更多 - 测试输出、退出条件等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-10-06T08:37:36.733

**使用灵活的参数和捕获的输出运行管理命令的高级方法**

```
argv = self.build_argv(short_dict=kwargs)
cmd = self.run_manage_command_raw(YourManageCommandClass, argv=argv) 
```

**将代码添加到您的基本测试类**

```
 @classmethod
    def build_argv(cls, *positional, short_names=None, long_names=None, short_dict=None, **long_dict):
        """
        Build argv list which can be provided for manage command "run_from_argv"
        1) positional will be passed first as is
        2) short_names with be passed after with one dash (-) prefix
        3) long_names with be passed after with one tow dashes (--) prefix
        4) short_dict with be passed after with one dash (-) prefix key and next item as value
        5) long_dict with be passed after with two dashes (--) prefix key and next item as value
        """
        argv = [__file__, None] + list(positional)[:]

        for name in short_names or []:
            argv.append(f'-{name}')

        for name in long_names or []:
            argv.append(f'--{name}')

        for name, value in (short_dict or {}).items():
            argv.append(f'-{name}')
            argv.append(str(value))

        for name, value in long_dict.items():
            argv.append(f'--{name}')
            argv.append(str(value))

        return argv

    @classmethod
    def run_manage_command_raw(cls, cmd_class, argv):
        """run any manage.py command as python object"""
        command = cmd_class(stdout=io.StringIO(), stderr=io.StringIO())

        with mock.patch('django.core.management.base.connections.close_all'):  
            # patch to prevent closing db connecction
            command.run_from_argv(argv)
        return command 
```

# iphone - 是否有用于 iPhone 开发的高级手势库？

> ID：907512
> 
> 赞同：8
> 
> 时间：2009-05-25T17:41:18.540
> 
> 标签：iphone, cocoa-touch, gesture

iPhone 平台有许多常见的手势习语。例如，有轻击、捏合和滑动，每种都有不同数量的手指。但是当你开发一个应用程序时，你需要根据关于触摸次数和位置的底层信息来实现这些东西。这似乎是图书馆的主要候选人。您将注册一个委托，设置一些参数，如多次点击间隔和滑动阈值，并获取 swipeStarted/Ended、pinchStarted/Ended、multiTap 等调用。这样的库是否存在？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T20:47:21.097

我已经建立了这样一个项目。它不是一个库，但它充满了用于捏/拉伸、点击和按住等的示例代码。

博客：

[http://6tringle.com/blog/2009/TouchSampleCode.html](http://6tringle.com/blog/2009/TouchSampleCode.html)

GitHub：

[http://github.com/kailoa/6tringle-touchsamplecode/tree/master](http://github.com/kailoa/6tringle-touchsamplecode/tree/master)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-02T18:31:01.977

`UIGestureRecognizer`. 不要自己滚。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T18:35:22.330

这是一个用于检测圆圈手势的方法，并提供了源代码。可能有助于调整它以检测其他特征。

[http://iphonedevelopment.blogspot.com/2009/04/detecting-circle-gesture.html](http://iphonedevelopment.blogspot.com/2009/04/detecting-circle-gesture.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-11T21:03:45.560

我分叉了 Kailoa 的非常好的示例，并尝试创建一个库。

[http://github.com/bentford/GestureDetect](http://github.com/bentford/GestureDetect)

我打算添加一个组合“捏缩放和拖动”手势，就像地图应用程序中的手势一样。一旦我得到它的工作，我会在github上发布。

# wpf - WPF DataContext 不使用 MVVM 模型刷新 DataGrid

> ID：907521
> 
> 赞同：3
> 
> 时间：2009-05-25T17:46:23.770
> 
> 标签：wpf, mvvm, datacontext

项目概况

我有一个视图绑定到包含 2 ObserverableCollection 的视图模型。viewmodel 构造函数填充第一个 ObserverableCollection 并收集视图数据上下文以通过名为 Sites 的公共属性绑定到它。

稍后在 LoadOrders 方法中填充 2ed ObserverableCollection，并更新公共属性 LoadFraudResults 以将其与 datacontext 绑定。

我正在使用 WCF 从数据库中提取数据，并且非常好地提取数据。

查看模型源

```
class ManageFraudOrderViewModel:ViewModelBase 
{
    #region Fields        
    private readonly ICollectionView collectionViewSites;
private readonly ICollectionView collectionView;
    private ObservableCollection<GeneralAdminService.Website> _sites;
    private ObservableCollection<FraudService.OrderQueue> _LoadFraudResults;

    #endregion 

    #region Properties
    public ObservableCollection<GeneralAdminService.Website> Sites 
    {
        get { return this._sites; }
    }
    public ObservableCollection<FraudService.OrderQueue> LoadFraudResults 
    {
        get { return this._LoadFraudResults;}
    }
    #endregion

    public ManageFraudOrderViewModel()
    {
        //Get values from wfc service model
        GeneralAdminService.GeneralAdminServiceClient generalAdminServiceClient = new GeneralAdminServiceClient();
        GeneralAdminService.Website[] websites = generalAdminServiceClient.GetWebsites();
        //Get values from wfc service model            

        if (websites.Length > 0)
        {
            _sites = new ObservableCollection<Wqn.Administration.UI.GeneralAdminService.Website>();
            foreach (GeneralAdminService.Website website in websites)
            {
                _sites.Add((Wqn.Administration.UI.GeneralAdminService.Website)website);
            }

    this.collectionViewSites= CollectionViewSource.GetDefaultView(this._sites);
        }
        generalAdminServiceClient.Close();
    }

    public void LoadOrders(Wqn.Administration.UI.FraudService.Website website)
    {
        //Get values from wfc service model            
        FraudServiceClient fraudServiceClient = new FraudServiceClient();
        FraudService.OrderQueue[] OrderQueue = fraudServiceClient.GetFraudOrders(website);
        //Get values from wfc service model            

        if (OrderQueue.Length > 0)
        {
            _LoadFraudResults = new ObservableCollection<Wqn.Administration.UI.FraudService.OrderQueue>();
            foreach (FraudService.OrderQueue orderQueue in OrderQueue)
            {
                _LoadFraudResults.Add(orderQueue);
            }
        }

    this.collectionViewSites= CollectionViewSource.GetDefaultView(this._LoadFraudResults);
        fraudServiceClient.Close();
    } 
```

}

* * *

查看源

公共部分类 OrderQueueControl : UserControl {

```
 private ManageFraudOrderViewModel manageFraudOrderViewModel ;
    private OrderQueue orderQueue;
    private ButtonAction ButtonAction;
    private DispatcherTimer dispatcherTimer;

    public OrderQueueControl()
    {

            LoadOrderQueueForm();
    }

    #region LoadOrderQueueForm
    private void LoadOrderQueueForm()
    {    
    //for binding the first observablecollection
        manageFraudOrderViewModel = new ManageFraudOrderViewModel();
        this.DataContext = manageFraudOrderViewModel;          
    }
    #endregion

    private void cmbWebsite_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        BindItemsSource();
    }

    #region BindItemsSource
    private void BindItemsSource()
    {
        using (OverrideCursor cursor = new OverrideCursor(Cursors.Wait))
        {

            if (!string.IsNullOrEmpty(Convert.ToString(cmbWebsite.SelectedItem)))
            {
                    Wqn.Administration.UI.FraudService.Website website = (Wqn.Administration.UI.FraudService.Website)Enum.Parse(typeof(Wqn.Administration.UI.FraudService.Website),cmbWebsite.SelectedItem.ToString());

        //for binding the second observablecollection*******
                    manageFraudOrderViewModel.LoadOrders(website);
                    this.DataContext = manageFraudOrderViewModel;
        //for binding the second observablecollection*******
            }            
        }
    }
    #endregion 
```

}

XAML

```
 ComboBox x:Name="cmbWebsite" ItemsSource="{Binding Sites}"  Margin="5" 
 Width="100" Height="25" SelectionChanged="cmbWebsite_SelectionChanged"
 DataGrid ItemsSource ={Binding Path = LoadFraudResults} 
```

问题领域：

当我调用 LoadOrderQueueForm 绑定第一个 observablecollection 和后来的 BindItemsSource 绑定 2ed observable 集合时，一切正常，第一次绑定没有问题。

但是，当我再次调用 BindItemsSource 以通过 cmbWebsite_SelectionChanged 根据更改的选定组合值重新填充 obseravablecollection 时，observalblecollection 将填充新值，并且 viewmodule 中的 LoadFraudResults 属性填充有新值；但是当我调用数据上下文重新绑定数据网格时，数据网格不会反映更改的值。

换句话说，当在视图的 BindItemsSource 方法中调用数据上下文时，数据网格不会更改。

```
 manageFraudOrderViewModel.LoadOrders(website);                    
 this.DataContext = manageFraudOrderViewModel; 
```

manageFraudOrderViewModel 值是正确的，但数据网格未反映更改的值。

请帮忙，因为我在过去 2 天里一直被这件事困住，而且截止日期快到了。

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-10T08:13:43.063

尝试使用 datagrid.Items.Refresh() ！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-16T15:32:04.630

是的，ilu2009 是正确的。

使用 MVVM 模式绑定到**DataGrid**并更改 DataGrid.ItemsSource 中的对象需要**DataGrid.ItemsSource.Refresh** **()**才能反映在 UI 上。

# linux - Linux - 与进程通信？重新加入流程？

> ID：907522
> 
> 赞同：1
> 
> 时间：2009-05-25T17:46:55.050
> 
> 标签：linux, ubuntu, console

问这个问题我觉得有点愚蠢，但我对 linux 比较陌生（在经验方面比时间方面更多），我一直想知道的一件事是我是否可以“重新加入”（我自己的术语）一个进程，而它是跑步。

例如，如果我将游戏服务器或 eggdrop IRC 机器人设置为在后台运行，是否可以使用命令来查看该进程的运行情况并查看它提供给控制台的所有输出？

我不是在谈论仅使用“top”命令查看进程，而是实际上链接到它，就好像我只是从命令行运行它一样。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T17:50:52.140

调试器*可以*“附加”到正在运行的进程，但您可能会更好地在其中运行程序[`screen`](http://www.gnu.org/software/screen/)（这使您可以以相当自然的方式分离和重新附加到终端）。

* * *

可能有一些好东西好东西：

*   [使用命令行在进程启动后重定向STDERR / STDOUT？](https://stackoverflow.com/questions/593724/redirect-stderr-stdout-of-a-process-after-its-been-started-using-command-line)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T17:57:03.127

你可以说得更详细点吗？您是否只是在谈论在当前会话中将进程置于后台，然后将其放回前台。

例如：

```
doLongTask &

# Later

fg %3 
```

本例中的 3 是本 doLongTask 实例的作业编号。您可以通过以下方式查看所有正在运行的作业：

```
jobs 
```

但请注意，这仍然只会让您看到正在输出到控制台的内容。IE 标准输出和标准错误，减去任何重定向。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T18:15:47.223

简单的答案是：

```
>> ./runmyserver
<press ctrl-z>
>> bg
>> ...do something else ...
>> fg 
```

您也可以在后台开始：

```
>> ./runmyserver & 
```

对于更复杂的事情，比如断开服务器与控制台会话的连接（因此当您注销时它仍在运行），您真的需要 screen. 也许乞求他们，这并不是真正的安全风险，而且它是一个有用的程序。

另请注意， ctrl-z 实际上会暂停您的服务器，直到`bg`有人正在玩它时可能会跳过一个节拍，最好尽快完成。

最后，许多游戏服务器都可以远程登录这种东西，这可以解决许多这些问题。在寻找替代方案之前，请确保您的游戏和主机不支持此功能。

编辑：重新阅读您的问题。听起来您至少可以使用重定向到文件来获得输出。但是，这不会让您添加更多输入：

```
./runmyserver > log.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T09:41:23.903

如果您提前知道要执行此操作，请使用 screen(1) 并在屏幕会话中在前台运行您的服务器。您将能够脱离屏幕会话并让进程继续运行。然后，您可以稍后重新附加您的屏幕会话并查看它此后所做的任何输出，直到回滚缓冲区的大小。

# iphone - 有没有办法在 UIScrollView 中实现最小减速速度？

> ID：907525
> 
> 赞同：0
> 
> 时间：2009-05-25T17:47:51.617
> 
> 标签：iphone, cocoa-touch, uikit, uiscrollview

我有一个 UIScrollView，其中包含一些动画的 UIImageViews。如果发生最小滚动速度，它真的看起来很酷。但是当用户慢慢滚动并抬起手指时，UIScrollView 减速非常慢。

问题是，在每次偏移更改时都不会调用 scrollViewDidScroll 方法。只要偏移量在变化，它就会被一种时间间隔调用。无论用户滚动多快，间隔始终相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T11:31:35.570

如果我们被允许谈论 iPhone OS 3.0，有人可能会告诉你 UIScrollView 可能有一个名为 decelerationRate 的新属性。但不幸的是，我们不允许谈论 iPhone OS 3.0 :(

# web-crawler - 网络爬取及其局限性

> ID：907527
> 
> 赞同：1
> 
> 时间：2009-05-25T17:49:14.280
> 
> 标签：web-crawler

假设我们在网络上放置了一个文件，如果您知道直接 URL，该文件可以公开评估。没有指向该文件的链接，并且服务器上的目录列表也已禁用。因此，虽然它可以公开访问，但除了输入该文件的确切 URL 外，无法访问该页面。任何类型的网络爬虫（好的或恶意的）能够通过爬取然后索引文件来定位该文件的可能性有多大。

对我来说，即使它可以公开访问，也需要运气或查找文件的特定知识。就像把金子埋在后院，让别人在没有地图的情况下找到它，或者知道那里埋着什么东西。

我只是看不到它会被发现的任何其他方式，但这就是我询问 stackoverflow 社区的原因。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T17:52:09.907

过去，据称此类隐藏位置是使用所有者/上传者使用的 Google 工具栏（可能还有其他此类浏览器插件）“找到”的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T17:53:38.513

通过默默无闻的安全永远不会奏效。你说，*你*不会链接到它，我相信你。但是没有什么能阻止您的用户有意或无意地链接到它。正如 ceejayoz 所说，现在有很多不同的地方可以发布链接。甚至还有“书签同步器”，人们可能认为它们是私有的，但实际上是对世界开放的。

所以使用真正的身份验证。如果你不这样做，你以后会后悔的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T17:51:48.067

链接可以出现在任何地方——有人可以在 Twitter 上链接到它，或者在 Facebook 上发布它，或者在博客上发表评论。它只需要一个。

如果重要的是它不会出现在任何地方，请将其放在密码后面。

如果它不是很重要，但您仍然不希望通过搜索引擎轻松访问它，请使用 robots.txt 文件来阻止表现良好的爬虫。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-01T18:49:48.230

购买/出售的点击流数据可能会导致未链接的内容发现：[http ://en.wikipedia.org/wiki/Clickstream](http://en.wikipedia.org/wiki/Clickstream)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T17:53:09.577

假设：

*   目录列表：已禁用。没有人
*   知道页面的存在。
*   您的文件不包含任何链接（然后您的浏览器可以将引用者发送到链接的站点）
*   您已正确设置 robots.txt
*   您相信所有人都不会将您的链接传播给其他任何人。
*   你很幸运

那么，您的页面可能不会被发现或被发现。

结论 ？

使用 .htaccess 文件保护您的数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T17:55:55.607

你是对的。网络爬虫隐喻地是蜘蛛——它们需要有一种方法来遍历网络（超链接）并到达您的页面。

要将您的假设页面放入搜索引擎的结果中，您必须手动将其 URL 提交给搜索引擎。有多种服务可将您的页面提交给这些搜索引擎。请参阅“向搜索引擎提交 URL”

此外，只有当搜索引擎确定您的页面在搜索引擎的专有排名系统中具有足够的元数据/业力时，您的页面才会出现。请参阅“SEO”和“元关键字”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-08-21T07:20:34.133

是的，你的权利网络爬虫访问 URL，它识别页面中的所有超链接并将它们添加到要访问的 URL 列表中，并称为爬虫边界，但这些超链接和 URL 有错误的链接。一旦用户单击错误链接并登陆恶意软件站点，他们通常会通过虚假的编解码器安装对话框进行宣传。如果这没有得到他们，该网站仍然会加载数十种其他策略来感染他们的计算机。从假工具栏、恐吓软件、流氓软件等等，这些网站应有尽有。他们遇到的一个站点甚至尝试安装 25 种不同的恶意软件。此类网站使人们容易受到安装垃圾邮件机器人、rootkit、密码 Steelers 和各种特洛伊木马等的攻击。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-25T17:52:47.563

你可以使用谷歌搜索API。对于与任何其他网页未链接的网页。我们对此一无所知。

# dns - 执行直接 DNS 查找的代码

> ID：907528
> 
> 赞同：2
> 
> 时间：2009-05-25T17:50:36.273
> 
> 标签：dns, network-protocols

我正在考虑进行一个实验，以不同的方式跟踪 DNS 值（比如它们多久改变一次等等）。为此，我需要能够直接向服务器发出 DNS 请求，以便 1）我知道它来自哪个服务器，2）我可以请求来自多个服务器的响应，以及 3）我可以避免本地操作系统运行缓存.

*有谁知道可以让我直接查询 DNS 服务器的库（按优先顺序排列的 C#、D、C、C++）？*如果做不到这一点，有没有人知道我可以从中实现这样一个系统的 DNS 协议的易于理解的描述？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T17:56:54.670

对于 C，我会选择[http://cr.yp.to/djbdns/blurb/library.html](http://cr.yp.to/djbdns/blurb/library.html)（如果您需要完全控制，即低级部分，即`dns_transmit*`和朋友） - 对于 C#，也许是[http:// /www.c-sharpcorner.com/UploadFile/ivxivx/DNSClient12122005234612PM/DNSClient.aspx](http://www.c-sharpcorner.com/UploadFile/ivxivx/DNSClient12122005234612PM/DNSClient.aspx)（现在无法测试那个，“也许”！）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T07:28:53.063

我只有 C 的经验，所以这是我的清单：

*   libresolv 是旧的、传统的和标准的方式。它在每个 Unix (type `man 3 resolver`) 上都可用，并且包括例程，例如 `res_query`可以或多或少地执行您想要的操作。要查询特定的名称服务器，您通常会更新全局变量`_res.nsaddr_list`（请注意，显然，它[不适用于 IPv6](https://stackoverflow.com/questions/388930/using-the-name-resolver-of-resolv-h-with-ipv6)）。

*   [ldns](http://www.nlnetlabs.nl/projects/ldns/)是现代而闪亮的解决方案。你有[很好的在线文档](http://www.nlnetlabs.nl/projects/ldns/doc/tutorial1_mx.html)。

*   一个非常常见但显然未维护的库是[adns](http://www.chiark.greenend.org.uk/~ian/adns/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T07:33:46.047

DNS 规范分布在**许多** [RFC](http://www.ietf.org/rfc.html)中（请参阅[漂亮的图表](http://blog.nominet.org.uk/tech/2010/05/24/436/)），我强烈建议**不要**从头开始实施存根解析器。有很多机会弄错。DNS 在过去几年中发展了很多。如果你既勇敢又疯狂，这里是最重要的 RFC：

*   RFC 1034，概念
*   RFC 1035，格式
*   RFC 2181，对规范的更新，以修复许多错误或歧义
*   RFC 2671，EDNS（今天强制）
*   RFC 3597，处理未知资源记录类型
*   和许多其他人......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T18:24:59.963

libdns（我认为它是绑定的一部分）。有一个 cygwin 端口可能对 Windows 环境有用。

[http://rpm2html.osmirror.nl/libdns.so.21.html](http://rpm2html.osmirror.nl/libdns.so.21.html)

# c++ - 是否有任何 API 用于获取 APACHE WebServer 的启动时间？

> ID：907529
> 
> 赞同：1
> 
> 时间：2009-05-25T17:50:46.010
> 
> 标签：c++, apache, apache2, webserver, diagnostics

我正在编写一个小应用程序来获取 Apache Webserver 的各种诊断参数，例如服务器启动时间、[Worker 模式](http://httpd.apache.org/docs/2.0/mod/worker.html)或[Prefork 模式](http://httpd.apache.org/docs/2.0/mod/prefork.html)、服务器版本等等。我发现很少有 API 可用于获取有关这些参数的信息。但是我没有找到用于 WebServer 启动时间的 API。有没有这样的API？如果没有 API，则有不同的方法，例如在 linux/unix 中使用“ps”命令获取开始时间，并在 windows 中使用类似的 API。我可以看到的其他方法是获取 APache WebServer 的时间在任何变量或文件中。请用您的宝贵意见和方法启发我。

TIA 阿尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T17:59:37.660

试试看一下 Apache 的[mod_status](http://httpd.apache.org/docs/2.0/mod/mod_status.html)

# c# - ClickOnce 从缓存中安装旧程序集

> ID：907532
> 
> 赞同：1
> 
> 时间：2009-05-25T17:51:16.727
> 
> 标签：c#, installation, clickonce

我正在使用 ClickOnce 安装我用 C# 编写的应用程序。一切正常，直到最后一次更新，之后我的应用程序的启动以错误消息结束：

> 无法加载文件或程序集 MyAssembly... HRESULT：0x80131040。

经过一番研究，我发现我的应用程序的 ClickOnce 缓存文件夹（C:\Documents and Settings..\Apps\2.0...）中有一个旧版本的 MyAssembly。但是，部署包中有一个实际版本。

我还在以该程序集命名的 ClickOnce 缓存中的独立目录中找到了这个旧版本的 MyAssembly（加上一些字符）。

在我看来，出于某种原因，ClickOnce 使用了缓存中的旧版本的 MyAssembly，而不是部署包中的新版本。

卸载/安装我的应用程序无济于事。

这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-27T05:34:38.997

我有同样的行为。它在另一个问题中提到了这个问题。从那时起，对于我们不同的应用程序来说，它已经发生了好几次。一件奇怪的事情是它在不同的计算机上表现不同。因此，一台计算机可能已使用新程序集进行了更新，而另一台计算机则复制了旧程序集。

*[.NET ClickOnce 部署和更新版本后调用的错误程序集](https://stackoverflow.com/questions/792447/net-clickonce-deployment-and-wrong-assemblies-called-after-updated-version)*

这似乎是 .NET Framework 3.5 SP1 中的一个错误。

请参阅 Microsoft 知识库文章 971052。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T07:36:24.930

确保已加载此旧程序集。您可以为此使用 DllProfiler。

# java - 如何使用 WindowsPhotoGallery 用 Ja va 显示 gif 图像？

> ID：907534
> 
> 赞同：0
> 
> 时间：2009-05-25T17:51:33.777
> 
> 标签：java, image, windowsphotogallery

我使用以下代码通过调用运行时命令在 Java 中显示 gif 图像，它打开 WindowsPhotoGallery，但不显示我的图像，而是在我的 PC 上显示一堆其他图片，我的问题是：如何通过将 gif 图像文件名正确地添加到它，因此它将与我的图像一起打开。

现在我像这样传递它：C:\Program Files\Windows Photo Gallery\WindowsPhotoGallery "C:/abc.gif"

# 哪个是不正确的，正确的方法是什么？

```
String Command,Program,File_Path="C:/abc.gif";
Process process=null;

Program="C:\\Program Files\\Windows Photo Gallery\\WindowsPhotoGallery ";          
Command=Program+"\""+File_Path+"\"";

try { process=Runtime.getRuntime().exec(Command); }
catch (Exception e) { e.printStackTrace(); } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T20:27:51.277

您可以使用[`Runtime.exec(String[] cmdArray)`](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#exec(java.lang.String[]))来传递命令及其参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T17:55:27.293

问题出在命令行字符串中。

例如：c:\document and setting\pic.gif = "\"c:\document and setting\pic.gif\""

# c# - 如何编写或生成 XML 文件

> ID：907539
> 
> 赞同：3
> 
> 时间：2009-05-25T17:52:10.780
> 
> 标签：c#, .net, xml

如何使用 C# 编写或生成 XML 文件以获得以下结果？

```
<?xml version="1.0" encoding="UTF-8"?>
<pages>
<page name="Page Name 1" url="/page-1/" />
<page name="Page Name 2" url="/page-2/" />
<page name="Page Name 3" url="/page-3/" />
<page name="Page Name 4" url="/page-4/" />
</pages> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-25T18:00:46.143

```
using System.Linq;
using System.Xml;
using System.Xml.Linq;

// ...

using (var writer = XmlWriter.Create("output.xml"))
     new XDocument(
        new XDeclaration("1.0", "UTF-8", null),
        new XElement("pages",
            Enumerable.Range(1, 4)
                .Select(i => new XElement("page",
                                  new XAttribute("name", "Page Name " + i),
                                  new XAttribute("url", "/page-" + i + "/"))))
     ).WriteTo(writer); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T18:03:03.830

一个相当直接的方式可能是这样的：

```
XmlWriterSettings settings = new XmlWriterSettings();
settings.Encoding = Encoding.UTF8;
settings.Indent = true;
using (XmlWriter writer = XmlWriter.Create(@"c:\path\file.xml", settings))
{

    writer.WriteStartElement("pages");

    for (int i = 1; i < 5; i++)
    {
        writer.WriteStartElement("page");
        writer.WriteAttributeString("name", "Page Name " + i.ToString());
        writer.WriteAttributeString("url", string.Format("/page-{0}/", i));
        writer.WriteEndElement(); // page
    }
    writer.WriteEndElement(); // pages
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-25T18:00:55.583

我猜是这样的：

```
System.Xml.XmlTextWriter writer = new System.Xml.XmlTextWriter(Server.MapPath("pages.xml"), System.Text.Encoding.UTF8);

        writer.WriteStartDocument();
        writer.WriteStartElement("pages");

        writer.WriteStartElement("page");
        writer.WriteAttributeString("name", "Page name 1");
        writer.WriteAttributeString("url", "Page url 1");
        writer.WriteEndElement();

        writer.WriteStartElement("page");
        writer.WriteAttributeString("name", "Page name 2 ");
        writer.WriteAttributeString("url", "Page url 2");
        writer.WriteEndElement();

        writer.WriteStartElement("page");
        writer.WriteAttributeString("name", "Page name 3");
        writer.WriteAttributeString("url", "Page url 3");
        writer.WriteEndElement();

        writer.WriteEndElement();
        writer.WriteEndDocument();
        writer.Close(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T18:02:32.490

如果您使用的是 .NET 框架 2.0，则应使用[XmlWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)类来编写 XML，否则您可以使用[XmlTextWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmltextwriter(VS.71).aspx)。

如果您使用的是 .NET 3+，则可以使用命名空间的[XDocument](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)类`System.Xml.Linq`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T23:05:55.623

```
using System.Xml;
//...
XmlDocument xmldoc = new XmlDocument();
XmlElement pages = xmldoc.CreateElement("pages");
XmlElement page = null;

for(int i = 1; i <= 4; i++)
{
    page = xmldoc.CreateElement("page");
    page.SetAttribute("name", "Page Name " + i);
    page.SetAttribute("url", "/page-" + i + "/");
    pages.AppendChild(page);
}

xmldoc.AppendChild(xmldoc.CreateXmlDeclaration("1.0", "UTF-8", null));
xmldoc.AppendChild(pages);
xmldoc.Save("output.xml"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T22:03:41.753

关于给出的答案的几点。对于这种大小的 XML 文档，XDocument 是一种非常低效的处理方式。至少，根据我对 XDocument 应该用于什么的理解。如果您在内存中处理大型文档并且您想使用 LINQ 查询它们，那么 XmlDocument/XDocument 是前进的方向。如果我错了，请纠正我并接受我的道歉。

其次，再次以我的理解，您的 XML 结构是错误的。如果我没有正确，请纠正我，但属性是描述元素值的元数据。它不能用作值本身。对于您的情况，您的结构应该类似于..

```
<pages>
    <page>
        <name href="url">Page Name 1</name>
    </page>
</pages> 
```

或者如果你想成为真正的肛门

```
<pages>
    <page>
        <name>Page Name 1
        <url>http://page/</url>
    </page>
</pages> 
```

我担心这个答案会引发可怕的元素与属性的争论（不应该存在，但总是存在。）

*编辑：这不是问题的直接答案；我觉得它更接近元评论（关于问题答案的评论）。如果它甚至相关，我不确定该放在哪里，但我认为值得一提。*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T15:02:56.860

您还可以查看 XML 数据绑定。这种方法会给你看起来更像这样的代码。

```
Pages pages = new Pages();
for(int i=1; i<=4;i++)
{
    Page p = new Page();
    p.name = "Page Name " + i;
    p.url = "/page-" + i + "/";
    pages.Pages.Add(p);
}
Console.Write(pages.ToXml()); 
```

看看“[仔细看看 XML 数据绑定](http://www.codeproject.com/KB/cpp/XML_Data_Binding.aspx)”

这里也是一个很好[的 xml 数据绑定工具列表](http://www.xmldatabinding.org/)

# model-view-controller - 平均价格 - 在视图中执行适当的逻辑还是在控制器中更好？

> ID：907541
> 
> 赞同：0
> 
> 时间：2009-05-25T17:52:18.313
> 
> 标签：model-view-controller

可以在视图中进行如下“平均价格”计算吗？

还是这对 MVC 不利，在控制器中执行此操作是否更好？

```
<p>Average price: <%= @seller.total_sales / @seller.num_sales %></p> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T17:53:34.507

两者都不。将其放入模型中。然后单元测试就变得容易了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T17:57:46.900

问你几件事：

这个平均价格是否会经常显示它是视图的一部分（它是否用于显示某些东西？）它是否需要复杂的东西来获取/计算/检索或其他什么？

如果您认为它只是对您的用户的提示，它只使用一次，那么您可以让它出现在您的视图中。

但是，如果您对此感到不满意，或者您需要对价格进行更复杂的数学运算，请将其作为您的模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T18:06:32.700

将您的业务逻辑放在模型中它所属的位置：

```
<p>Average price: <%= @seller.get_average_price () %></p> 
```

# django - 如何扩展 django 管理员选择？

> ID：907543
> 
> 赞同：1
> 
> 时间：2009-05-25T17:52:52.667
> 
> 标签：django, django-admin

当字段“search_fields”包含在 ModelAdmin 中时，Django 会在列表显示页面上创建一个搜索框。

我的一些内联模型引用了列表页面上的项目。如果搜索框术语与这些内联模型中的字段匹配，我希望结果包括列表中的所指对象。

示例：数据库有一个名称表和一个地址表。对于每个名称，可以有多个地址。每个地址引用一个名称。当我搜索名称列表时，我希望能够输入“Main Street”，搜索地址并显示这些地址引用的名称。

我想我必须覆盖与搜索框关联的搜索功能。如果这是正确的，那么该功能在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T19:09:50.653

我不确定我是否理解您的问题，但您可以通过在管理类中设置 search_fields 来搜索列表显示中的相关字段：

```
class MyAdmin(admin.ModelAdmin):
    search_fields = ('name', 'name__address') 
```

这在关系中使用与在普通 filter() 调用中相同的双下划线语法。

# javascript - 将文本框中的 URL 加载到 iframe 中

> ID：907547
> 
> 赞同：0
> 
> 时间：2009-05-25T17:54:08.950
> 
> 标签：javascript, html, url, input

如何通过 javascript 将文本框中的 URL 加载到 HTML 文件中的 iframe 中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-25T17:58:12.453

```
var oIFrame = document.getElementById("id_of_iframe");
oIFrame.src = document.getElementById("id_of_textbox").value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T21:15:48.590

或者使用 document.frames 如果它是您使用的唯一 iframe：

```
var myIframe = window.document.frames[0]; // lets grab the iframe object
if (myIframe != null){
  myIframe.src = document.getElementById("id_of_textbox").value; // set the value as source.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T21:20:35.633

只是通过jQuery添加我猜

```
$('iframe#guid').src( $('#textbox_id').val() ); 
```

带错误检查：

```
var iframe = $('#guid');
if(iframe.length > 0){
    iframe.attr('src', $('#textbox_id').val());
} 
```

# upload - 限制在 lighttpd 上测试的上传速度

> ID：907551
> 
> 赞同：1
> 
> 时间：2009-05-25T17:55:46.000
> 
> 标签：upload, lighttpd, stress-testing

我正在实施ubr上传。它使用 Perl 和 PHP 来上传带有进度条的文件。我正在运行一个 lighttpd 开发服务器，并希望对其进行全面测试。目前它只是立即传输文件，因为它实际上只是在我的计算机上移动文件。有没有办法让它看起来好像实际上传输得很慢，所以我可以看到进度条？

我尝试将以下内容添加到我的 lighttpd.conf 中。它可能会稍微减慢页面的加载速度，但上传仍然是即时的。

```
$HTTP["host"] == "localhost" {
        server.kbytes-per-second = 8
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T19:37:53.780

尝试使用查尔斯： http: [//www.charlesproxy.com/](http://www.charlesproxy.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T18:05:17.977

您可以尝试限制客户端计算机，而不是限制服务器端的内容。在 O'Reilly 上有一篇关于如何在 Mac 上限制带宽的好文章：

*   [探索 Mac OS X 防火墙](http://www.macdevcenter.com/pub/a/mac/2005/03/15/firewall.html)

`ipfw`是 BSD 的东西，但在 Linux 上你可以尝试使用 shaper 模块`shapecfg`：

*   [流量整形基础](http://www.newtonlug.org/handouts/040114%20-%20Traffic%20Shaping%20Basics.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T18:13:40.377

`$HTTP['host']`包含服务器的主机。您可以将配置变量放在配置文件中而无需主机检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T18:15:49.313

谢谢您的帮助！实际上，我是双启动的，只是在我的 apache 服务器上测试了我的确切脚本。当我在 apache 上传输一个 200mb 的文件时，它实际上会在文件传输时显示进度条。在我的 lighttpd 服务器上，页面“忙碌”，因为它在后台发布文件，然后栏弹出 100% 完成。

我认为脚本的工作方式是 CGI 发布文件，并且在这样做的同时，它不断将它写入的大小写入另一个文件。然后每秒调用一个 php 脚本，它打开这个文件并查看已经写入了多少。

似乎我的 lighttpd 服务器不允许 perl 和 php 同时工作。不过我可能错了。

在我的 Windows 服务器上，我实际上安装了 WAMP 和 perl。我的 lighttpd 将 fastcgi 用于 php，而将 mod_cgi 模块用于 perl 脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T18:20:56.337

啊，看起来其他人对 lighttpd 和 uber 上传器有问题...

（由于我是新手，无法链接到它）

现在的问题是 lighttpd 是否值得使用，因为我必须在我所有的 mod_rewrite 内容之上更改它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-14T14:00:29.610

您可以使用 Sloppy HTTP 代理限制浏览器带宽：[http ://www.dallaway.com/sloppy/](http://www.dallaway.com/sloppy/)

> Sloppy 故意减慢客户端和服务器之间的数据传输速度。
> 
> 示例用法：您可能在本地网络上构建网站，这很快。使用 Sloppy 是一种无需安装调制解调器即可获得工作“拨号体验”的方法。

# c# - 你如何最好地处理带有日期的测试？

> ID：907561
> 
> 赞同：0
> 
> 时间：2009-05-25T17:58:25.853
> 
> 标签：c#, unit-testing, datetime

我在我的 MVC 应用程序中使用带有过滤器的存储库模式。该项目显示了一个交易列表，我可以在其中指定一个日期期间来获取交易的子集，或者指定一个特定的日期来获取该日期的交易（包括年、年/月和年/月/日视图）。

我还具有根据我们正在查看的视图类型分页获取下一个和上一个事务的功能。例如，如果我们选择给定年/月的所有交易，那么我会根据此日期期间查找下一个上一个和下一个交易。

你将如何对这样的事情进行单元测试......这是我的模拟事务测试存储库。

```
公共类 TestTransactionsRepository : ITransactionsRepository
{
    私人 IList<Transaction> 数据库；

    公共 TestTransactionsRepository()
    {
        db = 新列表<事务>();

        诠释 i = 0;

        对于 (; i < 10; i++)
        {
            db.Add(CreateTransaction(i, 3));
        }

        对于 (; i < 25; i++)
        {
            db.Add(CreateTransaction(i, i));
        }

        对于 (; i < 80; i++)
        {
            db.Add(CreateTransaction(i, 5));
        }
    }

    私有交易 CreateTransaction(int id, int accountID)
    {
        返回新交易
        {
            身份证=身份证，
            帐户 ID = 帐户 ID，
            日期 = ??
        };
     }
}

```

这是一个示例测试场景。

```
[测试方法]
公共无效 TransactionsRepository_Get_With_Filter_Between_ThisDate_
And_ThatDate_Returns_xx_Transactions()
{
    IList<Transaction> 事务 = TransactionsRepository.Get()
                                        .Between(thisDate, thatDate)
                                        .ToList();

    Assert.AreEqual(xx, transactions.Count);
}

```

然后这是我的过滤方法

```
公共静态 IQueryable<Transaction> 之间（
这个 IQueryable<Transaction> qry, DateTime startDate, DateTime endDate)
{
    从 qry 中的 t 返回
           其中 t.Date >= startDate && t.Date <= endDate
           选择 t;
}

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T18:06:03.013

您需要一种`.Add`（或`CreateTransaction`）的变体形式，可以让您“注入”（假）日期，完全用于此类测试目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T18:12:44.403

[您可以使用“如何对机器特定行为进行单元测试？](https://stackoverflow.com/questions/865559/how-do-i-unit-test-for-machine-specific-behaviour) ”中描述的相同技术，以特定日期注入/使用/创建/测试。

# c# - 解析 HTML 文档：正则表达式还是 LINQ？

> ID：907563
> 
> 赞同：8
> 
> 时间：2009-05-25T17:58:35.713
> 
> 标签：c#, regex, linq, parsing, linq-to-xml

尝试解析 HTML 文档并提取一些元素（文本文件的任何链接）。

当前的策略是将 HTML 文档加载到字符串中。然后找到文本文件链接的所有实例。它可以是任何文件类型，但对于这个问题，它是一个文本文件。

最终目标是拥有一个`IEnumerable`字符串对象列表。这部分很简单，但解析数据是个问题。

```
<html>
<head><title>Blah</title>
</head>
<body>
<br/>
<div>Here is your first text file: <a href="http://myServer.com/blah.txt"></div>
<span>Here is your second text file: <a href="http://myServer.com/blarg2.txt"></span>
<div>Here is your third text file: <a href="http://myServer.com/bat.txt"></div>
<div>Here is your fourth text file: <a href="http://myServer.com/somefile.txt"></div>
<div>Thanks for visiting!</div>
</body>
</html> 
```

最初的方法是：

*   将字符串加载到 XML 文档中，并以 Linq-To-Xml 方式对其进行攻击。
*   创建一个正则表达式，以查找以 开头`href=`并以 结尾的字符串`.txt`

问题是：

*   那个正则表达式会是什么样子？我是一个正则表达式新手，这是我学习正则表达式的一部分。
*   您将使用哪种方法来提取标签列表？
*   这将是最高效的方式？
*   哪种方法最具可读性/可维护性？

* * *

**更新：** 感谢[Matthew](https://stackoverflow.com/questions/907563/parsing-html-document-regular-expression-or-linq/907571#907571)对 HTML Agility Pack 的建议。它工作得很好！XPath 建议也适用。我希望我可以将两个答案都标记为“答案”，但我显然不能。它们都是解决问题的有效方法。

[这是一个使用Jeff](https://stackoverflow.com/questions/907563/parsing-html-document-regular-expression-or-linq/907639#907639)建议的正则表达式的 C# 控制台应用程序 。它可以很好地读取字符串，并且不会包含任何不以 .txt 结尾的 href。对于给定的示例，它不会正确地将`.txt.snarg`文件包含在结果中（如 HTML 字符串函数中提供的那样）。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Text.RegularExpressions;
using System.IO;

namespace ParsePageLinks
{
    class Program
    {
        static void Main(string[] args)
        {
            GetAllLinksFromStringByRegex();
        }

        static List<string> GetAllLinksFromStringByRegex()
        {
            string myHtmlString = BuildHtmlString();
            string txtFileExp = "href=\"([^\\\"]*\\.txt)\"";

            List<string> foundTextFiles = new List<string>();

            MatchCollection textFileLinkMatches = Regex.Matches(myHtmlString, txtFileExp, RegexOptions.IgnoreCase);
            foreach (Match m in textFileLinkMatches)
            {
                foundTextFiles.Add( m.Groups[1].ToString()); // this is your captured group
            }

            return files;
        }

            static string BuildHtmlString()
            {
                return new StringReader(@"<html><head><title>Blah</title></head><body><br/>
<div>Here is your first text file: <a href=""http://myServer.com/blah.txt""></div>
<span>Here is your second text file: <a href=""http://myServer.com/blarg2.txt""></span>
<div>Here is your third text file: <a href=""http://myServer.com/bat.txt.snarg""></div>
<div>Here is your fourth text file: <a href=""http://myServer.com/somefile.txt""></div>
<div>Thanks for visiting!</div></body></html>").ReadToEnd();
            }       
        }
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-25T18:00:57.547

两者都不。将其加载到 (X/HT)MLDocument 中并使用 XPath，这是一种操作 XML 的标准方法并且非常强大。要查看的函数是[SelectNodes](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.selectnodes.aspx)和[SelectSingleNode](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.selectsinglenode.aspx)。

由于您显然使用的是 HTML（不是 XHTML），因此您应该使用[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)。大多数方法和属性与相关的 XML 类匹配。

使用 XPath 的示例实现：

```
 HtmlDocument doc = new HtmlDocument();
    doc.Load(new StringReader(@"<html>
<head><title>Blah</title>
</head>
<body>
<br/>
<div>Here is your first text file: <a href=""http://myServer.com/blah.txt""></div>
<span>Here is your second text file: <a href=""http://myServer.com/blarg2.txt""></span>
<div>Here is your third text file: <a href=""http://myServer.com/bat.txt""></div>
<div>Here is your fourth text file: <a href=""http://myServer.com/somefile.txt""></div>
<div>Thanks for visiting!</div>
</body>
</html>"));
        HtmlNode root = doc.DocumentNode;
        // 3 = ".txt".Length - 1\.  See http://stackoverflow.com/questions/402211/how-to-use-xpath-function-in-a-xpathexpression-instance-programatically
        HtmlNodeCollection links = root.SelectNodes("//a[@href['.txt' = substring(., string-length(.)- 3)]]");
    IList<string> fileStrings;
    if(links != null)
    {
        fileStrings = new List<string>(links.Count);
        foreach(HtmlNode link in links)
        fileStrings.Add(link.GetAttributeValue("href", null));
    }
    else
        fileStrings = new List<string>(0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T18:25:26.297

我会推荐正则表达式。为什么？

*   灵活（不区分大小写、易于添加新的文件扩展名、要检查的元素等）
*   写得快
*   跑得快

只要您可以编写正则表达式，正则表达式就不难阅读。

使用这个作为正则表达式：

> `href="([^"]*\.txt)"`

解释：

*   它在文件名周围有括号，这将产生一个“捕获的组”，您可以在找到每个匹配项后访问它。
*   它必须逃脱“。” 通过使用正则表达式转义字符，反斜杠。
*   它必须匹配任何字符，除了双引号：[^"] 直到找到
    ".txt"

它翻译成这样的转义字符串：

```
string txtExp = "href=\"([^\\\"]*\\.txt)\" 
```

然后你可以迭代你的匹配：

```
Matches txtMatches = Regex.Matches(input, exp, RegexOptions.IgnoreCase);
foreach(Match m in txtMatches) {
  string filename = m.Groups[1]; // this is your captured group
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T18:28:13.420

替代 Matthew Flaschen 的建议，[DOM](http://www.w3schools.com/HTMLDOM/default.asp) （例如，如果您患有 X?L 过敏爆发）

有时它的表现很差——我想是因为实现有时*很*有趣，而且没有一些（次要的）智能助手，原生 COM 接口有点笨拙，但我发现它是一种强大、稳定和直观/可探索的解析和探索方式操纵 HTML。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-01T19:52:06.697

REGEX 并不快，实际上它比 .NET 中的原生字符串解析要慢。不信你自己看。

上面的例子都没有比直接访问 DOM 更快。

```
HTMLDocument doc = wb.Document;
var links = doc.Links; 
```

# c# - 如何告诉 Fluent NHibernate 不要映射类属性

> ID：907576
> 
> 赞同：28
> 
> 时间：2009-05-25T18:03:30.553
> 
> 标签：c#, nhibernate, fluent-nhibernate

我有一个在流利的 nhibernate 中映射的类，但我希望映射忽略其中一个类属性。

使用下面的类和映射，我收到此错误：

***以下类型不能用作代理： iMasterengine.Data.Model.Calendar：方法 get_HasEvents 应该是虚拟的***

```
//my class
public class Calendar : IEntity {
    public virtual int Id { get; private set; }
    public virtual string Name { get; set; }
    public virtual string SiteId { get; set; }
    public virtual IList<CalendarEvent> Events { get; set; }
    //ignore this property
    public bool HasEvents { get { return Events.Count > 0; } }
}

//my mapping
public class CalendarMap : ClassMap<Calendar> {
    public CalendarMap() {
        Id(x => x.Id);
        Map(x => x.Name);
        Map(x => x.SiteId);
        HasMany(x => x.Events).Inverse();
        //what do I put here to tell nhibernate
        //to ignore my HasEvents property?
    }
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-05-07T10:58:38.033

您可以在课堂上进行`HasEvents` *虚拟*化：

```
public virtual bool HasEvents { get { return Events.Count > 0; } } 
```

您无需向映射添加任何内容。

如果您正在使用自动映射，您只需要告诉 fluent 输入属性，我认为您不是。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-25T21:58:42.217

```
map.IgnoreProperty(p => p.What); 
```

# static - specman 有静态变量吗？

> ID：907577
> 
> 赞同：1
> 
> 时间：2009-05-25T18:04:43.687
> 
> 标签：static, specman

我在继承的 specman 中有以下代码：

```
some_method() is {
    var a: bool;

    if (!a) {
        a = some_other_method();
    };
}; 
```

我的理解是，每次`some_method()`调用，都会重新生成，并且在分配之前检查它的值`a`是没有意义的。`a`但是，可能是我在这里遗漏了一些东西。例如，如果`a`是静态的，那么这段代码是有意义的，这让我想到了我的问题：

有没有办法让变量在 specman 中是静态的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T06:52:37.473

没有像 C 中那样的静态变量。方法中的变量`False`如果未初始化，则具有其默认值（在这种情况下），因此您应该`if (!a)`始终正确`True`。

如果是 struct 成员，情况会有所不同`a`，然后就像在其他 OO 语言中一样，它将在多个方法调用中保留该值，并且检查会更有意义：

```
struct some_struct_s {
    a : bool;
    some_method() is {
        if (!a) {
            a = some_other_method();
        };
    };
}; 
```

您也可以在交互式提示中检查这样的内容：

```
Specman> var a : bool;
Specman> print a
  a = FALSE 
```

那里的交互式帮助也很好，例如尝试：

```
Specman> help variable 
```

并选择条目（按数字）`sn_eref: variables : declaring`。在那里，您将找到与您的问题相关的所有信息。

干杯，丹尼尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-23T14:53:24.733

静态结构成员（事件、字段、方法）被添加到 Specman v15.2 中的语言中。静态字段无法生成、物理(%) 或在 when 子类型中使用。

```
struct some_struct_s {
    a : bool;
    some_method() is {
        if (!a) {
            a = some_other_method();
        };
    };
};

-- Change field 'a' for all instances
on xxx { some_struct_s::a = TRUE; }; 
```

以下是 teamspecman 博客的一些评论：[e 中的静态成员](http://cadence-fv.rssing.com/browser.php?indx=3180846&item=247)

# python - 使 Python 脚本可执行 chmod755？

> ID：907579
> 
> 赞同：4
> 
> 时间：2009-05-25T18:05:23.203
> 
> 标签：python, hosting

我的托管服务提供商说我的 python 脚本必须是可执行的（chmod755）。这是什么意思&我该怎么做？

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T18:08:55.067

类 Unix 系统具有“文件模式”，说明谁可以读/写/执行文件。755模式意味着所有者可以读/写/执行，其他人可以读/执行但不能写。要使您的 Python 脚本具有此模式，请键入

```
chmod 0755 script.py 
```

你还需要一个像

```
#!/usr/bin/python 
```

在文件的第一行告诉操作系统它是什么类型的脚本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T18:09:51.570

如果您可以通过 ssh 访问您的网络空间，请连接并发出

```
chmod 755 nameofyourscript.py 
```

如果您没有 ssh 访问权限而是通过 FTP 连接，请检查您的 FTP 应用程序以查看它是否支持设置权限。

至于755的含义：

*   第一个数字是用户设置（你自己）
*   第二个数字是组设置
*   第三位是系统的其余部分

通过添加权限值来构造数字。1 = 可执行，2 = 可写，4 = 可读。即 755 意味着您自己可以读取、写入和执行该文件，其他人可以读取和执行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T18:20:19.227

这意味着，某人（用户、组或每个人）有权执行（或读取或写入）脚本（或一般的文件）。

权限以不同的方式表示：

```
$ chmod +x file.py # makes it executable by anyone
$ chmod +w file.py # makes it writeabel by anyone
$ chmod +r file.py # makes it readably by anyone

$ chmod u+x file.py # makes it executable for the owner (user) of the file
$ chmod g+x file.py # makes it executable for the group (of the file)
$ chmod o+x file.py # makes it executable for the others (everybody) 
```

您可以以相同的方式取消权限，只需`+`将`-`

```
$ chmod o-x file.py # makes a file non-executable for the others (everybody)
$ ... 
```

八进制数以不同的方式表示相同。4是读，2写，1执行。

简单的数学：

```
read + execute = 5
read + write + execute = 7
execute + write = 3
... 
```

将所有内容打包在一个简短而甜蜜的命令中：

```
# 1st digit: user permissions
# 2nd digit: group permissions
# 3rd digit: 'other' permissions

# add the owner all perms., 
# the group and other only write and execution

$ chmod 755 file.py 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T18:06:57.893

在 shell（例如 bash）上，只需键入

```
chmod 755 file.py 
```

使其可执行。您可以使用

```
ls -l file.py 
```

验证是否设置了执行权限（“rwxr-xr-x”中的“x”）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T18:13:18.787

除了这里的其他很好的答案之外，您应该知道大多数 FTP 客户端都有一个`chmod`命令允许您设置服务器上文件的权限。如果权限正确获得，您可能不需要这个，但很有可能他们不需要。

# javascript - 快速点击导航菜单导致多个 div 淡入

> ID：907581
> 
> 赞同：0
> 
> 时间：2009-05-25T18:06:15.337
> 
> 标签：javascript, jquery, css, navigation

我遇到了一个脚本问题（我第一次尝试使用 jQuery）我写了一个使用导航菜单淡入 div 的脚本。如果用户快速单击导航菜单上的不同按钮，它会将两个 div 加载到彼此之上。

这是代码：

```
$(document).ready(function(){

            $("#about-button").css({
                opacity: 0.3
            });
            $("#contact-button").css({
                opacity: 0.3
            });
            $("#friends-button").css({
                opacity: 0.3
            });
            $("#gallery-button").css({
                opacity: 0.3
            });
        $("#container div.button").click(function(){
                $clicked = $(this);
                if($clicked.css("opacity") != "1" && $clicked.is(":not(animated)"))
                {
                    $clicked.animate({
                        opacity: 1,
                    }, 600 );
                    var idToLoad = $clicked.attr("id").split('-');
                    $("#content").find("div:visible").fadeOut("slow", function(){
                        $(this).parent().find("#"+idToLoad[0]).fadeIn("slow")
                    })
                }
                $clicked.siblings(".button").animate({
                    opacity: 0.3,
                }, 600 );
            });
        }); 
```

以下是 div 和按钮的样式：

```
#container{
    width: 996px;
    height: 1050px;
    background-image: url(images/bg.png);
    background-repeat: no-repeat;
    position: relative;
    background-position: center top;
    margin: 0px auto 0px auto;
}
#navbar {
    width: 150px;
    height: 300px;
    position: absolute;
    top: 250px;
    left: 100px;
    z-index: 2;
    visibility: visible;
}
#about {
    height: 400px;
    position: absolute;
    font-family: Arial, Helvetica, sans-serif;
    color: #fff;
    text-align: left;
    padding: 0px 0px 0px 30px;
    width: 650px;
    z-index: 3;
    left: 250px;
    top: 250px;
    display:none;
    overflow: auto;
}
#footer {
    top: 950px;
    height: 80px;
    position: absolute;
    color: #ffffff;
    padding: 10px;
    width: 988px;
    text-align: right;
}

#contact {
    height: 400px;
    position: absolute;
    font-family: Arial, Helvetica, sans-serif;
    color: #fff;
    text-align: left;
    padding: 0px 0px 0px 30px;
    width: 650px;
    z-index: 3;
    left: 250px;
    top: 250px;
    display:none;
}
#friends {
    height: 400px;
    position: absolute;
    font-family: Arial, Helvetica, sans-serif;
    color: #fff;
    text-align: left;
    padding: 0px 0px 0px 30px;
    width: 650px;
    z-index: 3;
    left: 250px;
    top: 250px;
    display:none
}
#gallery {
    height: 400px;
    position: absolute;
    font-family: Arial, Helvetica, sans-serif;
    color: #fff;
    text-align: left;
    padding: 0px 0px 0px 30px;
    width: 650px;
    z-index: 3;
    left: 250px;
    top: 250px;
    display:none;
}
#home {
    height: 400px;
    position: absolute;
    font-family: Arial, Helvetica, sans-serif;
    color: #fff;
    text-align: left;
    padding: 0px 0px 0px 30px;
    width: 650px;
    z-index: 3;
    left: 250px;
    top: 250px;
    display:block;
    overflow: auto;
    padding-right: 10px;
}
#home-button {
    opacity: 1.0;
}
#about-button {
    opacity: 0.5;
}
#contact-button {
    opacity: 0.5;
}
#friends-button {
    opacity: 0.5;
}
#gallery-button {
    opacity: 0.5;
}
.button{
    cursor: pointer;
}
#header{
    top: 150px;
    position: absolute;
    left: 115px;
    visibility: visible;
    height: 100px; 
```

HTML 标记应该是正确的，在任何内容区域内都没有子 div，并且我找不到其他冲突。

有没有一种方法可以禁用菜单上的点击，直到 div ：可见？如果有人对此或其他修复有答案，我真的很想看到它！这是该网站迄今为止发现的唯一错误。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T19:14:24.437

在没有看到全貌的情况下，我可以在以下行中看到选择器的语法错误：

```
if($clicked.css("opacity") != "1" && $clicked.is(":not(animated)")) 
```

“非动画”的选择器应包含“：”，如下所示：

```
if($clicked.css("opacity") != "1" && $clicked.is(":not(:animated)")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T22:16:23.757

听起来你的 click 函数的第一步应该是从所有 div 中解除 click 事件的绑定，最后一步应该是恢复监听器。

这样做的方法是将大部分代码放入它自己的函数中（你把它放在 $(document).ready(){} 之外）

像这样的东西

```
$(document).ready(function(){
   $("#container div.button").click(makeVisible);

});

function makeVisible() {
    $("#container div.button").unbind(click);
      ///your code to make the div visible
    $("#container div.button").click(makeVisible);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T02:33:11.193

由于动画需要排队，最好的方法是使用 stop() 方法使当前目标之外的所有其他动画 div 停止动画。[有关详细信息，请参阅http://docs.jquery.com/Effects/stop#clearQueuegotoEnd](http://docs.jquery.com/Effects/stop#clearQueuegotoEnd)上的文档。

# architecture - 什么是变更请求管理工具？

> ID：907612
> 
> 赞同：6
> 
> 时间：2009-05-25T18:14:24.807
> 
> 标签：architecture, change-management

谁能告诉我什么是变更请求管理工具以及向该工具提交变更请求时涉及什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-25T18:27:58.663

变更请求管理工具供用户请求对软件进行变更。

当软件开发过程开始时，开发团队和用户（或他们的部门）就软件的用途达成一致。这称为要求。一旦每个人都同意要求，最好是书面的，开发就开始了。

如果用户在开发过程中的任何时候发现他们需要更改需求，他们就会提出更改请求。这些请求被记录到变更请求管理工具中。开发团队审查请求并与用户就更改进行协商——需要多少额外的时间或金钱——直到他们达成协议。

部署软件后，用户可能会发现其他更改。他们在变更请求管理工具中记录他们的请求。开发团队会定期审查新的变更请求，并与用户就哪些请求将包含在软件的下一个版本中达成一致。

使用变更请求管理工具有助于管理“范围蔓延”。它有助于双方评估软件所需的额外工作，并使整个过程井井有条。

如果正确完成，将记录请求的更改、所做的更改以及当前正在进行的更改。软件改进将被优先考虑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T18:25:28.013

它与错误跟踪工具相似或相同。可能发生的事情包括：

*   某人查看请求（“某人”可能是产品经理、项目经理和/或开发团队负责人）并决定是否进一步考虑

*   如果请求没有立即被拒绝，那么它会被传递给某人（可能是架构师或开发团队负责人），他们将评估其可行性并说明实施它所需的工作量/时间表/资源

*   如果预期收益超过预期成本等，那么它将被批准并添加到开发计划中，并最终分配给可用的开发人员

*   当它经历这些不同的阶段并被不同的人考虑时，人们将添加他们的意见，和/或额外的细节和文档：例如，当它最终到达测试所请求更改的开发实现的 QA 人员时， QA 人员不仅会看到原始请求，还会看到来自项目经理、架构师、开发人员等的评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T19:09:41.973

它基本上是一个数据库，可以帮助您防止所有“待办事项”项目从桌面上掉下来。

并且作为一个附带好处，它提供了一种评估您的开发团队执行其流程的情况的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-22T23:24:50.013

您可以使用问题管理工具（错误跟踪器）作为变更请求工具

或者你可以去低保真并使用协议来代替（即只是一个写在word文档中的程序）

我与客户一起使用的是 SLA（服务级别协议）和变更请求协议的组合：[“维护块”-管理变更请求](http://pm4web.blogspot.com/2008/09/maintenance-blocks-dealing-with-client.html)

--LM

# c++ - 如何在 C++ 中定义特定于类的 << 运算符

> ID：907620
> 
> 赞同：1
> 
> 时间：2009-05-25T18:17:50.713
> 
> 标签：c++

给定一个类，例如：

```
class Person
{
private:
    char *name;

public:
    Person()
    {
        name = new char[20];
    }
    ~Person()
    {
        delete [] name;
    }
} 
```

我想使用如下语句打印以打印此实例中的名称：

```
cout << myPerson << endl; 
```

我需要做什么来`<<`为这个类定义输出运算符？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-25T18:21:34.603

在类中添加：

```
friend std::ostream& operator<< (std::ostream& out, const Person& P); 
```

然后定义 operator<< 是这样的：

```
std::ostream& operator<< (std::ostream& out, const Person& P) {
    out << P.name;
    return out;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-27T08:30:55.923

定义一个以 ostream 作为参数的成员函数 print()。然后让重载的 operator<< 调用这个成员函数。这样你就可以避免使用朋友。例子：

```
void YourClass::print(ostream& out) const
{
    //implement printing ...
}
ostream& operator<<(ostream& out, const YourClass& m)
{
    m.print(out);
    return out;
} 
```

# javascript - 这就是你在 jQuery 中定义函数的方式吗？

> ID：907634
> 
> 赞同：51
> 
> 时间：2009-05-25T18:22:54.243
> 
> 标签：javascript, jquery

这就是你在 jQuery 中定义函数的方式吗？

```
$(document).ready( function () {
    var MyBlah = function($blah) { alert($blah);  };
 }); 
```

现在调用我做的函数：

```
MyBlah('hello'); 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-05-25T18:38:54.553

首先，您的代码可以工作，这是在 JavaScript 中创建函数的有效方式（除了 jQuery），但是因为您在另一个函数（在这种情况下为匿名函数）中声明了一个函数，因此无法从全球范围。

这是一个例子：

```
$(document).ready( function () {

    var MyBlah = function($blah) { alert($blah);  };

    MyBlah("Hello this works") // Inside the anonymous function we are cool.

 });

MyBlah("Oops") //This throws a JavaScript error (MyBlah is not a function) 
```

这（有时）是一种可取的行为，因为我们**不会污染全局命名空间**，所以如果您的函数不需要从代码的其他部分调用，这就是要走的路。

在匿名函数之外声明它会将其置于全局命名空间中，并且可以从任何地方访问它。

最后，变量名开头的**$**不是必需的，有时当变量是 jQuery 对象本身的实例时用作 jQuery 约定（在这种情况下不一定）。

也许您需要的是创建一个[jQuery 插件](https://learn.jquery.com/plugins/basic-plugin-creation/)，这非常简单且有用，因为它允许您执行以下操作：

```
$('div#message').myBlah("hello") 
```

另见：[http ://www.re-cycledair.com/creating-jquery-plugins](http://www.re-cycledair.com/creating-jquery-plugins)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-25T18:25:21.680

不，您可以将函数编写为：

```
$(document).ready(function() {
    MyBlah("hello");
});

function MyBlah(blah) {
    alert(blah);
} 
```

这会调用`MyBlah`内容就绪的函数。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-25T18:25:55.890

不。

您定义函数的方式与在常规 javascript 中完全相同。

```
//document ready
$(function(){
    myBlah();
})

var myBlah = function(blah){
    alert(blah);
} 
```

另外：不需要$

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-04-09T11:37:42.950

您可以扩展 jQuery 原型并将您的函数用作 jQuery 方法。

```
(function($)
{
    $.fn.MyBlah = function(blah)
    {
        $(this).addClass(blah);
        console.log('blah class added');
    };
})(jQuery);

jQuery(document).ready(function($)
{
    $('#blahElementId').MyBlah('newClass');
}); 
```

有关在此处扩展 jQuery 原型的更多信息：http: [//api.jquery.com/jquery.fn.extend/](http://api.jquery.com/jquery.fn.extend/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-16T12:22:32.443

```
jQuery.fn.extend({
    zigzag: function () {
        var text = $(this).text();
        var zigzagText = '';
        var toggle = true; //lower/uppper toggle
            $.each(text, function(i, nome) {
                zigzagText += (toggle) ? nome.toUpperCase() : nome.toLowerCase();
                toggle = (toggle) ? false : true;
            });
    return zigzagText;
    }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-01T18:29:46.713

以下示例向您展示如何在 jQuery 中定义函数。你会看到一个按钮“点击这里”，当你点击它时，我们调用我们的函数“myFunction()”。

```
 $(document).ready(function(){
    $.myFunction = function(){ 
      alert('You have successfully defined the function!'); 
    }
    $(".btn").click(function(){
      $.myFunction();
    });
  }); 
```

你可以在这里看到一个例子：[How to define a function in jQuery?](https://stackhowto.com/how-to-define-a-function-in-jquery/)

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-05-25T18:25:28.077

这就是您定义在文档准备好时调用的匿名函数的方式。

# http-referer - HTTP_REFERER 在什么情况下不起作用？

> ID：907635
> 
> 赞同：2
> 
> 时间：2009-05-25T18:24:17.547
> 
> 标签：http-referer

我之前在 foo.php 中使用过引用来确定页面 iframe foo.php 是否属于特定 URL。（使用`$_SERVER['HTTP_REFERER']`）

事实证明，在大多数情况下，它都有效（大约 98% 的时间），但似乎有些用户到达了该页面并且`$_SERVER['HTTP_REFERER']`没有在 foo.php 中设置，因此破坏了代码。[**更新**：这些用户声称他们遵循通常的页面流程，并没有在浏览器上单独使用 foo.php 的 URL（他们让它成为 iframe），并且用户从未更改过他们的浏览器设置。]

我想知道它可能发生的原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T18:30:10.283

[HTTP/1.1 RFC](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.36)没有强制发送 HTTP 引用标头。在编写健壮的代码时，你不能对它的存在做出任何假设；完全符合的浏览器可能不包含它。

此外，RFC 建议*“如果 Request-URI 是从没有自己的 URI 的源（例如来自用户键盘的输入）获得的，则不得发送 Referer 字段”*和*“我们建议，但不要求, 为用户提供一个方便的切换界面来启用或禁用 From 和 Referer 信息的发送”*。

后者不是很常见（尽管某些浏览器具有满足要求的“私人”模式）。对于你的 2% 来说，更有可能的是人们将 URL 加入书签，它满足第一个条件（从没有 URI 的源获得的 URI），因此浏览器不发送引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T18:29:50.593

默认情况下不是 AFAIK，但很容易将其关闭（出于隐私考虑），例如在 Firefox 中通过 about:config，当然有些用户可能会使用分发给他们的浏览器（例如由他们的 IT 部门）并使用此类设置。因此，您应该尽量避免依赖 REFERER 来实现任何重要功能（当然，也因为它拼写错误；-)。

# c# - For Loop 运行两次

> ID：907636
> 
> 赞同：1
> 
> 时间：2009-05-25T18:24:25.300
> 
> 标签：c#, for-loop

有人能告诉我为什么这会处理所有文件然后再做一次吗？这让我疯狂。谢谢

```
 private void HP3BackgroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
        BackgroundWorker hp3worker = (BackgroundWorker) sender;

        DirectoryInfo hp3Files = new DirectoryInfo(fromPath + @"\hp3\");
        FileInfo[] hp3Filelist = hp3Files.GetFiles("*.*");
        int count = hp3Filelist.Length;

        UseWaitCursor = true;
        for (int i = 0; i < count; i++)
        {
            FileInfo file = hp3Filelist[i];
            try
            {
                File.Copy(fromPath + @"\hp3\" + file.Name, toPath + @"\hp3\" + file.Name, true);
                hp3worker.ReportProgress((int)((float) i / count * 100));
            }
            catch (Exception error)
            {
                MessageBox.Show("Error is " + error);
            }
        }
        UseWaitCursor = false;
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-25T18:28:13.513

检查您是否附加了`HP3BackgroundWorker_DoWork`两次事件处理程序？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T18:28:14.840

您确定该函数没有被调用两次吗？那个循环看起来不错。

# svn - 使用 CVS 时需要将项目主干转换为分支

> ID：907644
> 
> 赞同：1
> 
> 时间：2009-05-25T18:27:01.990
> 
> 标签：svn, cvs, cvs2svn

我正在使用 cvs2svn 将一个大型的多项目 CVS 存储库转换为 Subversion。它工作得非常好，但是有一些 CVS 项目确实应该是其他项目的分支。

使用选项文件，我可以指定项目“ShouldBeBranch”的主干应该放在“/OtherProject/branches/ShouldBeBranch”中，但我找不到避免为标签和分支创建 Subversion 目录的方法ShouldBeBranch 项目（它是空的，但仍然创建）。

目前我能看到的唯一选择是在转换完成后从 Subversion 中删除目录，但我想知道是否有人知道可以在转换过程中完成此操作的方法？我还查看了符号提示文件，但是有 270 个项目通过索引号指定项目看起来太难了！

非常感谢，大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T07:15:47.240

大概您的“ShouldBeBranch”项目本身具有分支和标签。你希望那些结局在哪里？

如果您只希望将“ShouldBeBranch”项目的主干包含在转换中：

*   从“ShouldBeBranch”项目中排除所有其他符号
*   将其 trunk_path 设置为另一个项目中的路径
*   在您的选项文件中将branchs_path 和tags_path 设置为None（这会阻止它们被创建）

因此，添加“ShouldBeBranch”项目的选项文件部分将包含如下行：

```
run_options.add_project(
    # ...
    trunk_path='OtherProject/branches/ShouldBeBranch',
    branches_path=None,
    tags_path=None,
    # ...
    symbol_strategy_rules=[
        ExcludeRegexpStrategyRule(r'.*'),
        ],
    ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T22:10:09.480

在导入后进行修复对我来说似乎是最好的事情。如果您将项目的项目\主干 svn 移动到分支\某处，Subversion 将只跟踪历史记录。

这篇[博文](http://blog.fredrikbostrom.net/2007/03/14/migrating-part-of-repository-in-svn)描述了一种使用转储/加载循环重命名路径的方法。这种方式会改变历史，因此当您回顾文件的历史时，它们似乎一直在分支\某物内。

如果您要回到旧版本，您会*希望*它位于 project\trunk 中。因此，我认为试图改变历史并不是一件好事。

# ruby-on-rails - 从原始表单数据创建模型对象 - 是否需要一对一的字段匹配？

> ID：907646
> 
> 赞同：1
> 
> 时间：2009-05-25T18:27:21.177
> 
> 标签：ruby-on-rails, webforms, model, controller

如果我在控制器中这样说：

```
@order = Order.new(params[:order]) 
```

这需要什么？

`params[:order]`是否需要在 Order 模型中的所有字段之间进行一对一的匹配？

或者可以有`params[:order]`比实例化订单所需的更多或更少的字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T18:53:28.877

确实可以有更少的字段。

确保您拥有任何验证所需的所有字段！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T19:02:30.340

params[:order] 本身应该是一个散列，其中每个键是模型字段的名称。要了解 Rails 如何将表单字段名称转换为 params 哈希，请使用 form_for 帮助器和查看源代码编写一个视图模板。

可以有更多或更少的字段，是的。额外的字段将被忽略。更少的字段不会被复制到实例对象中。您根本不需要任何东西来实例化 ActiveRecord 对象。（对象有效性和保存是另一回事——它们调用验证和 ActiveRecord 回调机制。）

# actionscript-3 - ActionScript 3 严格模式总结

> ID：907648
> 
> 赞同：1
> 
> 时间：2009-05-25T18:27:41.333
> 
> 标签：actionscript-3, strict

我在哪里可以获得 ActionScript 3.0 严格模式和标准模式之间差异的摘要？换句话说，在标准模式下我可以做什么但在严格模式下不能做的事情是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T08:15:18.257

该死的，我整晚都在努力回忆我在哪里看到了这些差异，今天早上我突然在淋浴时完全回忆起来了：p

[http://books.google.fr/books?id=gUHX2fcLKxYC&pg=PA135&lpg=PA135&dq=essential+actionscript+3.0+compiler+standard+strict&source=bl&ots=cuTT2kfUE-&sig=yIAPZCISoWSi6Hx1DIqH83BOljU&hl=fr&ei=MqQbStjNKIaQ&&resnum=resultX06&DAQN 1](http://books.google.fr/books?id=gUHX2fcLKxYC&pg=PA135&lpg=PA135&dq=essential+actionscript+3.0+compiler+standard+strict&source=bl&ots=cuTT2kfUE-&sig=yIAPZCISoWSi6Hx1DIqH83BOljU&hl=fr&ei=MqQbStjNKIaQjAfx06nuDA&sa=X&oi=book_result&ct=result&resnum=1)

# winforms - 如何将 DataGridView 与 List 绑定 或绑定列表

> ID：907650
> 
> 赞同：0
> 
> 时间：2009-05-25T18:28:01.003
> 
> 标签：winforms, data-binding, datagridview

我已经做了一千次了，它可以工作，但现在....不是:(

我在这里做错了什么，因为网格中没有显示任何内容吗？

```
namespace theGridIsNotWorking
{
using System;
using System.Collections.Generic;
using System.Windows.Forms;

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        var items = new List<Item>();

        items.Add(new Item(){ TheName = "first"});
        items.Add(new Item(){ TheName = "Second"});
        items.Add(new Item(){ TheName = "Third"});

        dataGridView1.DataSource = new List<Item>(items);
    }

    public class Item
    {
        public string TheName;
    }
}
} 
```

没什么壮观的......但真的很伤心。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-08T22:41:36.703

我认为问题在于 TheName 是一个成员变量，但您需要一个属性。为 Item 类尝试以下操作：

```
 public class Item
      {
         public string TheName;

         public string TheNameProperty
         {
            get
            {
               return TheName;
            }
         }

         public Item(string name)
         {
            TheName = name;
         }
      } 

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T18:49:44.797

尝试[BindingListView](http://blw.sourceforge.net/)。将 List<T> 绑定到 DGV 的最简单方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T18:33:53.003

```
BindingList<Notification>(notifications); 
```

不应该

```
BindingList<Notification>(activeNotifications); 
```

?

# java - 如何让 Eclipse 从我的类中显示 javadoc，而不在 jar 中包含源

> ID：907659
> 
> 赞同：1
> 
> 时间：2009-05-25T18:30:44.460
> 
> 标签：java, eclipse, javadoc

我正在构建 jar，我想在没有源的情况下打包它们，但我希望 javadoc 在 eclipse 中为开发人员提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T20:12:40.263

JAR 的用户可以在使用 JAR 的 Java 项目的 Java 构建路径属性中将 Javadoc 位置（归档中的 URL、文件或路径）与它相关联。
我不确定这在与二进制文件相同的 JAR 中使用 Javadoc 的效果如何（以前从未见过），但理论上它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T22:32:52.147

Apache Ant javadoc 任务将生成 API html。通常，您会将其作为 zip 文件与您的 jar 一起分发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T23:54:19.660

你的构建过程是什么？Maven 发布过程实际上生成了 3 个 jar，一个包含已编译的类，一个包含源代码，一个包含 javadocs。您应该能够自定义 POM 以防止分发源 jar，并且任何使用 Maven 管理依赖项的人如果声明对您的 jar 的依赖项（并在 eclipse maven 插件中打开 javadoc 下载），将自动获取 javadoc。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T18:42:16.887

Javadocs 是源代码的一部分，因为任何编译的类都不会包含任何注释——Javadocs*是*注释。

换句话说，你不能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T07:42:15.967

[JIDE 有一个工具](http://www.jidesoft.com/support/src_stub.htm)（售价 25 美元），它可以运行您的源代码并删除所有方法主体，留下 javadoc，并生成一个 zip 文件。然后，您可以将此 zip 作为源 zip 分发，并且您的 IDE 将能够读取 javadocs，但当然您的所有逻辑都已被删除，因此您可以保留您的封闭源代码。zip 文件中不包含任何私有成员和方法。

它还具有为智能感知保留方法参数名称的额外好处，因此以下方法

```
public void foo( String text, Integer index ) {
} 
```

自动完成时将显示**foo( String text, Integer index )**而不是**foo( String arg1, Integer arg2 )**，因此您可以提示参数应该是什么。

# python - 将所有使用的 Python 模块收集到一个文件夹中？

> ID：907660
> 
> 赞同：8
> 
> 时间：2009-05-25T18:31:23.477
> 
> 标签：python

我认为以前没有人问过这个问题——我有一个包含许多不同 .py 文件的文件夹。我制作的脚本只使用了一些——但有些调用了其他的，我不知道所有正在使用的脚本。是否有一个程序可以获取使该脚本运行到一个文件夹所需的一切？

干杯!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T19:00:04.480

```
# zipmod.py - make a zip archive consisting of Python modules and their dependencies as reported by modulefinder
# To use: cd to the directory containing your Python module tree and type
# $ python zipmod.py archive.zip mod1.py mod2.py ...
# Only modules in the current working directory and its subdirectories will be included.
# Written and tested on Mac OS X, but it should work on other platforms with minimal modifications.

import modulefinder
import os
import sys
import zipfile

def main(output, *mnames):
    mf = modulefinder.ModuleFinder()
    for mname in mnames:
        mf.run_script(mname)
    cwd = os.getcwd()
    zf = zipfile.ZipFile(output, 'w')
    for mod in mf.modules.itervalues():
        if not mod.__file__:
            continue
        modfile = os.path.abspath(mod.__file__)
        if os.path.commonprefix([cwd, modfile]) == cwd:
            zf.write(modfile, os.path.relpath(modfile))
    zf.close()

if __name__ == '__main__':
    main(*sys.argv[1:]) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-25T19:04:03.787

使用`modulefinder`标准库中的模块，参见例如[http://docs.python.org/library/modulefinder.html](http://docs.python.org/library/modulefinder.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T18:41:05.003

[冻结](http://wiki.python.org/moin/Freeze)与您描述的非常接近。它执行生成 C 文件以创建独立可执行文件的额外步骤，但您可以使用它生成的日志输出来获取脚本使用的模块列表。从那里将它们全部复制到要压缩的目录中（或其他）是一件简单的事情。

# objective-c - Objective C 内存管理混乱

> ID：907665
> 
> 赞同：1
> 
> 时间：2009-05-25T18:32:58.683
> 
> 标签：objective-c, memory-management

我正在阅读有关[内存管理](http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW1)的苹果文档，并遇到了一些我不明白的东西。基本上，我不明白为什么不需要通过“getter”方法保留实例变量。我写了这个小程序来看看会发生什么。我以为会有崩溃，但我显然错过了一些东西。

```
//  main.m
//  Test
//

#import <Foundation/Foundation.h>
#import "Test.h"

int main(int argc, char *argv[])
{
    NSAutoreleasePool *p = [[NSAutoreleasePool alloc] init];

    //Initialize the test object
    Test *t = [[Test alloc] init];

    //Set the value to 5
    [t setMyNum:[NSNumber numberWithInt:5]];

    //Save a temp number that points to the original number
    NSNumber *tempNum = [t myNum];

    //release old number and retain new
    [t setMyNum:[NSNumber numberWithInt:7]];

    //Shouldn't this crash because tempNum is pointing to a deallocated NSNumber???
    NSLog(@"the number is %@",tempNum);

    [p drain];
    return 0;
} 
```

tempNum 不指向已释放的对象吗？

感谢所有帮助。

编辑

这是 getter 和 setter 方法中的代码

```
#import "Test.h"

@implementation Test
- (void)setMyNum:(NSNumber *)newNum {
    [newNum retain];
    [myNum release];
    myNum = newNum;
}

-(NSNumber *)myNum {
    return myNum;
}
@end 
```

如您所见，我正在对旧对象调用释放。

编辑

这是建议的，我认为 tempNum 仍然存在的原因是因为它还没有从池中自动释放。但是即使将 [pool drain] 移动到 NSLog 消息之前的右侧，也没有崩溃？？？奇怪的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T18:38:19.297

由于您没有显式释放任何对象，因此在允许自动释放池耗尽之前不会释放任何内容。尝试`[p drain]`在最后一次`NSLog`通话之前插入。它应该使 NSLog 调用崩溃。

此外，如果您没有在 setMyNum: 方法中保留 NSNumber，您会发现如果`[p drain]`在分配 tempNum 之前添加它会崩溃。

为了澄清最初的问题，调用 getter 方法并不（也不应该）必然暗示调用者想要拥有（即保留）该变量。如果是这种情况，此代码将泄漏：

```
NSLog("Number is %@", [t myNum]); 
```

此外，似乎 NSNumber 有一个优化，即对于小数字，它们缓存 NSNumber 对象，保留一个额外的副本，并返回该版本。因此，对于小常量，`[NSNumber numberWithInt: N]`将返回一个具有 2 个引用计数的对象（可通过 获得`[theNumber retainCount]`）。为了明确地看到发生了什么，在程序中使用一个更大的常量，一个 NSNumber 将保留一个引用计数为 1 的“新鲜”对象（这也将被自动释放）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-29T06:09:51.393

```
#import "Test.h"

@implementation Test 

- (void)setMyNum:(NSNumber *)newNum
{      
    [newNum retain];
    [myNum release]; 
    myNum = newNum;
}

-(NSNumber *)myNum 
{      
    return myNum; 
} 

@end 
```

这里在`[myNum release]`释放 mynum 的 setter 方法中，但随后我们再次给出了一些新值，即 newnum，因此从 getter 方法中，临时编号获得了尚未释放的编号，`[p drain]`因此不会发生任何崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-29T06:14:38.570

```
#import "Test.h"

@implementation Test 

(void)setMyNum:(NSNumber *)newNum
{      

[newNum retain];
[myNum release]; 
myNum = newNum;

}

(NSNumber *)myNum 
{      

return myNum; 

} 

@end 
```

`[myNum release];`这是释放的 setter 方法`myNum`，但随后我们再次给出了一些新值，即`newNum`，因此从 getter 方法中，临时编号获取直到 未释放的编号，`[p drain];`因此不会发生任何崩溃。即使下面的代码不会崩溃，因为有自动释放池但没有自动释放方法。

```
[t setMyNum:[NSNumber numberWithInt:70]]; 
```

因此释放池不会释放该数字。

# javascript - 通过Javascript捕获右键单击，无需wmode

> ID：907668
> 
> 赞同：2
> 
> 时间：2009-05-25T18:34:49.243
> 
> 标签：javascript, localization, flash, swfobject, right-click

在使用除英语之外的任何其他语言时，Flash 播放器在 Firefox/Chrome 中使用除 wmode="window" 之外的任何内容时存在错误。此错误已报告但尚未修复

`http://bugs.adobe.com/jira/browse/FP-501`

这个问题可以在这里更好地看到 -

`http://www.5etdemi.com/blog/archives/2005/06/firefox-wmodetransparent-is-completely-screwy-and-breaks-textfields/`

现在我的问题 - 我试图在我的应用程序中使用 Uza 的右键单击解决方案（`http://www.uza.lt/blog/2007/08/solved-right-click-in-as3`），但我遇到了 wmode 的问题。事件捕获似乎不适用于 wmode="window"，我也需要多种语言才能在我的应用程序上工作。

有没有人确定的解决方案？或者有什么方法可以在不设置wmode的情况下捕获右键单击。

任何帮助将不胜感激。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-12T22:13:09.627

幸运的是，您经常想知道是否单击了右键。由于 W3C 和 Microsoft 碰巧在这一点上达成了一致，并将按钮的值设置为 2，因此您仍然可以检测到右键单击。

```
function doSomething(e) {
    var rightclick;
    if (!e) var e = window.event;
    if (e.which) rightclick = (e.which == 3);
    else if (e.button) rightclick = (e.button == 2);
    alert('Rightclick: ' + rightclick); // true or false
} 
```

[http://www.rgagnon.com/jsdetails/js-0061.html](http://www.rgagnon.com/jsdetails/js-0061.html)

[http://www.quirksmode.org/js/events_properties.html](http://www.quirksmode.org/js/events_properties.html)

[http://unixpapa.com/js/mouse.html](http://unixpapa.com/js/mouse.html) http://www.javascripter.net/faq/leftvsri.htm

# c# - Adobe Air 能否成为 Mac 和 iPhone 应用程序的最佳解决方案？

> ID：907671
> 
> 赞同：0
> 
> 时间：2009-05-25T18:36:44.807
> 
> 标签：c#, iphone, macos, air

对于我们的应用程序使用什么开发工具，我们正处于十字路口。我们不知道我们会选择 Adob​​e Air 还是使用 Objective-C 和 Cocoa 的传统道路。该软件在功能上类似于 www.riffmasterpro。Air 是这里最好的解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-25T18:42:28.230

嗯，首先，iPhone 不支持 Flash，所以没有适用于 iPhone 的 Air 平台（至少，我不知道——如果我错了，请纠正我）。

其次，Mac 上的原生 Objective-C 应用程序在与操作系统的结合方面总是会超过 Air 应用程序。TweetDeck 就是一个例子。这是一个了不起的应用程序，但它只是感觉不像一个 Mac 应用程序（没有有意义的菜单，没有咆哮集成等......）。Mac 用户通常对他们的应用程序的行为方式非常具体。

如果你想编写 Mac 应用程序（和 iPhone 应用程序），我建议你宁愿坚持使用 Objective-C。

如果您主要关心的是跨平台（iPhone 除外），那么 Air 是一个值得考虑的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T18:41:54.860

如果您正在寻找专门为 Mac/iPhone 平台构建应用程序，我建议您改用 Objective-C。Adobe AIR 的优势在于它可以跨平台安装和使用，几乎没有问题。

但是，这样做的缺点之一是性能永远不会像直接与操作系统相关的东西那么好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T18:51:18.040

使用中间框架的问题是你永远不会拥有硬件的潜力，在其他世界你将无法使用 Mac/Windows 可以通过硬件给你的任何功能，你将永远依附于框架会给你，希望你能做你需要的一切......

特别是在您的音乐应用程序中。

关于 Adob​​e Air 框架，最好同时涵盖 Linux、Mac 和 Windows 计算机，但您将无法在 iPhone 下运行它，因为不支持 Adob​​e Flash……Adobe 正在为iPhone，但我相信至少在不久的将来它不会支持 Air。

对于 iPhone，您可以构建一个 Web 应用程序或一个 SDK 应用程序，最后一个，如果您将使用 SDK 3.0，您会发现很多好东西可以使用它，但是您需要从 sctrath 开发一个完整的应用程序。

# iphone - 为 iPhone os 2.2.1 和 iPhone os 3.0 开发

> ID：907672
> 
> 赞同：2
> 
> 时间：2009-05-25T18:37:05.713
> 
> 标签：iphone, cocoa-touch

我作为注册iPhone开发者计划的开发者，收到了来自苹果的消息，要求所有应用程序都兼容iPhone os 3.0。据说他们不会处理与 iPhone os 3.0 不兼容的应用程序

问题是，如果我更改代码以使用 iPhone os 3.0，它将无法在 2.2.1 上运行。

例如 sdk 2.2.1 不支持以下在 sdk 3.0 中是必需的：

```
cell.textLabel.text = @"text"; 
```

在 2.2.1 中，我会改为：

```
cell.text = @"text"; 
```

这不是唯一的问题。

你如何处理这个问题？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T21:07:20.713

在不破坏任何 NDA 的情况下。可以这么说，因为目前商店中针对 2.0 / 2.2.1 构建的大多数应用程序也将在 3.0 下运行......你会明白，即使可能有最终会被弃用的 API，但这并不意味着刚刚被有效弃用。这仅意味着当您开始开发专门针对 3.0 的应用程序时，您应该停止使用它们。同时，您希望继续构建 2.2.1，就像您没有听说过 3.0 时一样。您只想在 3.0 上测试您的应用程序，但除非您做一些奇怪的事情，否则您应该没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T18:39:37.533

由于 NDA，无需详细介绍 OS 3.0；

你应该检查[**这个 SO question and answer**](https://stackoverflow.com/questions/845733/iphone-check-firmware-version)。它显示了如何区分操作系统。

编辑：我同意 François P.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T18:41:14.707

我可能只是将这些实例中的每一个包装在基于 [[UIDevice currentDevice] systemVersion] 的条件中，这将是“1.2”“2.0”或“3.0”形式的 NSString。

如果您的代码中有很多实例，请通过方法抽象或使用类别扩展有问题的类。

# c - 检查通过程序的 C 管道——边界情况

> ID：907674
> 
> 赞同：0
> 
> 时间：2009-05-25T18:38:23.790
> 
> 标签：c, sockets, buffering

我从套接字 A 接收并即时将其写入套接字 B（就像代理服务器可能一样）。我想检查并可能修改通过的数据。我的问题是如何处理边界情况，即我正在搜索的正则表达式将在两个连续的套接字 A 读取和套接字 B 写入迭代之间匹配。

```
char buffer[4096]
int socket_A, socket_B

/* Setting up the connection goes here */

for(;;) {

    recv(socket_A, buffer, 4096, 0);

    /* Inspect, and possibly modify buffer */

    send(socket_B, buffer, 4096, 0);

    /* Oops, the matches I was looking for were at the end of buffer,
     * and will be at the beginning of buffer next iteration :( */

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T19:21:19.303

您需要了解和/或说出您的正则表达式。

根据正则表达式，您可能需要比现在缓冲更多的缓冲。

最坏的情况可能是一个正则表达式，它说“找到所有东西，从开始直到第一次出现‘狗’这个词，然后用其他东西替换它”：如果你有这样的正则表达式，那么你需要缓冲（不转发）从开始到第一次出现“狗”这个词的所有内容：这可能永远不会发生，即可能是无限量的缓冲。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T18:50:40.117

我的建议：有两个缓冲区，并在它们之间轮换：

1.  接收缓冲区 1
2.  接收缓冲区 2
3.  过程。
4.  发送缓冲区 1
5.  接收缓冲区 1
6.  处理，但在缓冲区 1 之前使用缓冲区 2。
7.  发送缓冲区 2
8.  转到 2。

或类似的东西？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T18:52:33.280

假设您知道可能的正则表达式匹配的最大长度 M（或者可以使用任意值 - 或者只使用整个缓冲区），您可以通过不传递完整缓冲区但保留 M-1 个字节来处理它。在下一次迭代中，将新接收到的数据放在 M-1 个字节的末尾并应用正则表达式。

如果您知道传输数据的格式（例如 http），您应该能够解析内容以了解何时到达通信结束，并且应该发送您可能已缓存的尾随字节。如果您不知道格式，那么您需要在 recv 中实现超时，这样您就不会在通信结束时等待太久。太长是你必须自己决定的事情，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T18:53:27.927

从这个意义上说，您正在谈论（以及所有意义上的 TCP）套接字是流。根据您的问题，您在数据中有一些结构。因此，您必须执行类似于以下的操作：

1.  缓冲（保持）传入数据，直到达到边界。边界可能是行尾、记录尾或您知道正则表达式将匹配的任何其他方式。
2.  当“记录”准备好时，处理它并将结果放在输出缓冲区中。
3.  写入输出缓冲区中累积的任何内容。

这可以处理大多数情况。如果您遇到真正没有“记录”的罕见情况之一，那么您必须构建某种状态机（DFA）。我的意思是你必须能够积累数据，直到a）它不可能匹配你的正则表达式，或者b）它是一个完整的匹配。

**编辑：** 如果您匹配固定字符串而不是真正的正则表达式，那么您应该能够使用[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)算法，该算法实际上可以在亚线性时间内运行（通过跳过字符）。如果你做对了，当你移动输入时，你可以将以前看到的数据扔到输出缓冲区，从而显着减少延迟并提高吞吐量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T19:35:18.480

一种替代方法是对`poll(2)`非阻塞套接字使用 -like 策略。在读取事件时，从套接字获取缓冲区，将其推送到传入队列，调用将缓冲区组装成流的词法分析器/解析器/匹配器，然后将块推送到输出队列。在写入事件中，从输出队列中取出一个块（如果有），并将其写入套接字。这听起来有点复杂，但一旦你习惯了反向控制模型，它就不是真的了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T18:52:53.950

基本上，您的代码的问题在于，recv/send 循环在比您的修改更低的网络层上运行。你如何解决这个问题取决于你所做的修改，但它可能涉及缓冲数据，直到可以进行所有本地修改。

编辑：我不知道任何可以过滤这样的流的正则表达式库。这将有多难取决于您的正则表达式及其过滤的协议。

# css - CSS 打印：避免页面之间的 DIV 被切成两半？

> ID：907680
> 
> 赞同：241
> 
> 时间：2009-05-25T18:40:43.287
> 
> 标签：css, cocoa, printing, page-break

我正在为一个软件编写一个插件，它需要大量项目并将它们弹出到 Cocoa 中的 WebView 中的 HTML 中（它使用 WebKit 作为其渲染器，所以基本上你可以假设这个 HTML 文件正在打开苹果浏览器）。

它制作的 DIV 具有动态高度，但变化不大。它们通常在 200 像素左右。无论如何，每个文档大约有六百个这样的项目，我很难将它打印出来。除非我很幸运，否则每页的底部和顶部都有一个被切成两半的条目，这使得实际使用打印输出非常困难。

我已经尝试过 page-break-before、page-break-after、page-break-inside 以及这三者的组合，但均无济于事。我认为可能是 WebKit 没有正确呈现指令，或者可能是我对如何使用它们缺乏了解。无论如何，我需要帮助。打印时如何防止将 DIV 切成两半？

* * *

## 回答 #1

> 赞同：413
> 
> 时间：2009-05-25T18:52:46.523

使用[break-inside](https://developer.mozilla.org/en-US/docs/Web/CSS/break-inside)应该可以：

```
@media print {
  div {
    break-inside: avoid;
  }
} 
```

它适用于[所有主要浏览器](https://developer.mozilla.org/en-US/docs/Web/CSS/break-inside)：

*   铬 50+
*   边缘 12+
*   火狐 65+
*   歌剧 37+
*   野生动物园 10+

使用`page-break-inside: avoid;`instead 也应该有效，但[已](https://developer.mozilla.org/en-US/docs/Web/CSS/page-break-inside)被`break-inside: avoid`.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-04-21T13:08:01.023

`page-break-inside: avoid;`给我使用 wkhtmltopdf 带来了麻烦。

为避免文本中断，请添加`display: table;`到包含文本的 div 的 CSS。

我希望这也适用于你。谢谢约翰。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-09-01T19:48:38.243

只有部分解决方案：我可以让它为 IE 工作的唯一方法是将每个 div 包装在它自己的表中，并在表上设置 page-break-inside 以避免。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-03-20T15:57:41.460

在我的情况下，我设法通过将我选择的 div 设置为 page-break-inside:avoid 并将所有元素设置为 display:inline 来解决 webkit 中的分页问题。所以像这样：

```
@media print{
* {
    display:inline;
}
script, style { 
    display:none; 
}
div {
    page-break-inside:avoid;
}

} 
```

似乎 page-break-properties 只能应用于内联元素（在 webkit 中）。我试图仅将 display:inline 应用于我需要的特定元素，但这不起作用。唯一有效的是将内联应用于所有元素。我想这是把事情搞砸的大型容器 div 之一。

也许有人可以对此进行扩展。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-06-01T21:15:33.240

page-break-inside：避免；绝对不能在 webkit 中工作，事实上已经存在 5 年以上的已知问题[https://bugs.webkit.org/show_bug.cgi?id=5097](https://bugs.webkit.org/show_bug.cgi?id=5097)

就我的研究而言，没有已知的方法可以做到这一点（我正在研究我自己的黑客）

我可以给你的建议是，要在 FF 中完成此功能，请将您不想要的内容包装起来；不想在 DIV（或任何容器）中使用 overflow: auto 中断（只是注意不要导致奇怪的滚动条通过将容器尺寸过小来显示）。

可悲的是，FF 是我唯一能做到这一点的浏览器，而我更担心的是 webkit。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-25T18:55:04.083

page-break-after 的可能值为：`auto, always, avoid, left, right`

我相信你不能在绝对定位的元素上使用 thie page-break-after 属性。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-01-27T10:45:27.083

我有同样的问题，但还没有解决方案。*page-break-inside*不适用于浏览器，但 Opera。另一种方法可能是使用*page-break-after: Avoid;* 在 div 的所有子元素上保持在一起......但在我的测试中，避免属性不起作用，例如。在火狐...

在所有流行浏览器中起作用的是使用例如强制分页符。*分页后：总是*

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2020-06-08T17:46:21.713

`page-break-inside: avoid;`似乎并不*总是*有效。它似乎考虑到了容器元素的高度和位置。

例如，`inline-block`比页面高的元素将被剪裁。

我能够`page-break-inside: avoid;`通过识别容器元素`display: inline-block`并添加以下内容来恢复工作功能：

```
@media print {
    .container { display: block; } /* this is key */

    div, p, ..etc { page-break-inside: avoid; }
} 
```

希望这可以帮助那些抱怨“page-break-inside 不起作用”的人。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-09-16T16:03:01.543

我也必须处理 wkhtmltopdf 。

我使用 Bootstrap 3.3.7 作为框架，需要避免 .row 元素上的分页符。

我使用这些设置完成了这项工作：

```
.myContainer {
    display: grid;
    page-break-inside: avoid;
} 
```

无需包装@media print

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-05-19T16:50:48.293

我遇到的一个陷阱是父元素的“溢出”属性设置为“自动”。这会否定打印版本中具有 page-break-inside 属性的子 div 元素。否则，`page-break-inside: avoid`对我来说在 Chrome 上工作正常。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-05-15T12:12:24.877

```
@media print{
    /* use your css selector */    
    div{ 
        page-break-inside: avoid;
    }
} 
```

对于所有新浏览器，此解决方案都有效。见 caniuse.com/#search=page-break-inside

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-02-11T11:58:07.373

我在使用 Bootstrap 时遇到了这个问题，并且每行中有多个列。

我试图给`page-break-inside: avoid;`或`break-inside: avoid;`给`col-md-6`div 元素。那行不通。

[我从DOK](https://stackoverflow.com/a/907728/10801429)上面给出的答案中得到了一个提示，即浮动元素不能很好地与`page-break-inside: avoid;`.

相反，我必须给予`page-break-inside: avoid;`或`break-inside: avoid;`给予`<div class="row">`元素。我的打印页面中有多**行**。

也就是说，每一**行**只有**2 列**。而且它们总是水平安装，不会换行。

在另一个示例中，如果您希望每行有 4 列，则使用`col-md-3`.

# php - 使用array_multisort对多维数组进行排序，其中不知道数组的维度

> ID：907689
> 
> 赞同：2
> 
> 时间：2009-05-25T18:42:33.690
> 
> 标签：php, sorting, multidimensional-array

我有一个多维数组，它基本上由每年的一个子数组组成。因此，例如，如果我有三年的数据，它可能看起来像这样：

```
$data[0] = Array(0,1,2,3,4,5,6,7);
$data[1] = Array(6,5,4,3,6,7,8,9);
$data[2] = Array(1,4,2,5,7,3,1,4); 
```

现在我希望能够根据其中一年对这些数组进行排序。例如，我可能想根据第二年进行排序，在这种情况下，它们都将根据 $data[1] 的重新排序进行排序。

我可以使用 array_multisort 轻松做到这一点：

```
array_multisort($data[1],SORT_ASC,$data[0],$data[2]); 
```

很好，但我不知道会有多少年的数据。我想要某种方式来指定正确数量的参数，但我不知道如何在 php 中做到这一点，除非我只需要为每个可能的年数设置一个 if 语句，这似乎非常痛苦：

```
if ($num_years == 1)
{
    array_multisort($data[$which_year],SORT_ASC);
}
else if ($num_years == 2)
{
    array_multisort($data[$which_year],SORT_ASC,$data[0],$data[1]); // this does work, interestingly, in spite of the repetition...
} 
```

有人知道更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T18:52:41.780

您始终可以使用[call_user_func_array](http://us2.php.net/manual/en/function.call-user-func-array.php)，指定`array_multisort`为第一个参数并构建要传递给 array_multisort 的参数数组。就像是：

```
$params = array();
foreach($data as $year){
  $params[] = $year;
}
call_user_func_array('array_multisort', $params); 
```

# css - 制作三列布局，使用 yui-grids 固定侧边栏

> ID：907691
> 
> 赞同：1
> 
> 时间：2009-05-25T18:43:56.573
> 
> 标签：css, yui-grids

我一直试图做到这一点，但没有取得多大成功。

我怎样才能使用 yui-grids 制作像 yui-t1 这样的模板（左侧边栏为 160px 的模板），但右侧边栏也有相同宽度？

中心柱应该是液体...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-25T17:32:08.870

您可以调整和扩展此示例。这是 200px 固定/流体内容/布局预设列的 HTML：

```
<div id="bd">
    <div id="yui-main">
        <div class="yui-b yui-b1">
            <div class="yui-u-main">
                <div class="yui-u">
                    <p>Main column: fluid width</p>
                </div>
            </div>
            <div class="yui-u">
                <p>Left column: 200px fixed</b>
            </div>
        </div>
    </div>
    <div class="yui-b">
        <p>Third column: fixed width, follows template preset.</p>
    </div>
</div> 
```

CSS 很简单：

```
.yui-b1 .yui-u-main {
    float: left;
    width: 100%;
}
.yui-b1 .yui-u {
    float: left;
    /* Width of left column */
    width: 200px;
    margin-left: -100%;
}
.yui-b1 .yui-u-main .yui-u {
    float: none;
    width: auto;
    /* Width of left column + 13px margin (default YUI margin) */
    margin-left: 213px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T02:32:18.717

你可以试试这种[液体布局](http://matthewjamestaylor.com/blog/holy-grail-no-quirks-mode.htm)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-09T22:07:35.847

你选择了马修的答案，但他没有回答你的问题。尽管他可能已经解决了您的问题，但将来阅读此问题的人可能仍想知道答案。在我看来，这种事情会阻止一些人给出或制定答案，并会迫使其他人重复这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:55:20.447

您是否尝试过使用 YUI 网格布局[http://developer.yahoo.com/yui/examples/grids/grids-gb_source.html](http://developer.yahoo.com/yui/examples/grids/grids-gb_source.html)

但是然后在第二个 yui-u 上添加一个额外的类，`.main`或者`.last`在第三个 yui-u 上添加一个类。

您可以添加以下覆盖样式

```
.yui-gb .yui-u {
width: 19%;
}

.yui-gb .main {
  width: 59%;
} 
```

获得 3 个宽度为 19/59/19 的 cols

那对你有用吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T19:16:14.230

根据[这个页面](http://developer.yahoo.com/yui/examples/grids/grids-t4.html)，180px 宽的右侧边栏具有默认类 yui-t4。我假设你可以进入 CSS 并将这个像素值更改为 160。

# c++ - mexFunction 中的内存管理问题

> ID：907692
> 
> 赞同：1
> 
> 时间：2009-05-25T18:44:08.477
> 
> 标签：c++, matlab

我正在读取通过在 Matlab m 文件中调用以下行编写的二进制数据文件：

```
disp(sprintf('template = %d', fwrite(fid, template_1d, 'uint8')));
```

AFAIK，uint8 与 BYTE、unsigned char 和 unsigned short 类型的大小相同。因此，我在 Matlab 调用的 mexfunction 中实例化的 C++ 类中的文件读取方法中编写了以下代码：

```
template1D = (unsigned short*) malloc(Nimgs*sizeof(unsigned short));
printf("template1D = %d\n", fread(template1D, sizeof(unsigned short), Nimgs, dfile));

```

以下是我如何在类析构函数的帮助函数中释放此成员变量：

```
免费（（无效*）模板1D）；

```

在主 mexfunction 中，当我没有通过调用 mexMakeMemoryPersistent() 函数在 mex 函数完成后实例化类对象以保留在内存中时，template1D 被正确清除，而没有来自 Matlab 的分段错误消息。但是，如果我确实实例化了该类以保留在内存中，如下所示：

```
如果 (!dasani)
{
    dasani = 新的 NeedleUSsim；
    mexMakeMemoryPersistent((void*) dasani);
    mexAtExit(ExitFcn);
}

```

ExitFcn 为：

```
无效退出Fcn（）
{
    删除dasani；
}

```

然后当我在 free((void*) template1D); 行时，Matlab 给我一条关于分段错误的错误消息。我检查了内存大小，它们似乎是一致的。对于 malloc/calloc/free 函数，当我将 C++ 项目作为 Matlab mex 函数执行时，我使用的是 Matlab 的 mxMalloc/mxCalloc/mxFree 函数。

根据这个描述，你对我有什么进一步的建议来解决这个问题并确保将来不会发生这种情况（或者至少知道将来如何处理类似的问题）？

提前致谢。

----------------------------------------补充---------- ---------------------------------

以下代码块基本上显示了我的 mex 文件的 jists。mex 文件基本上是在 Matlab 中运行并从带有一些 Matlab 头文件的 C/C++ 代码编译的可执行文件。

```
无效退出Fcn（）
{
    删除dasani；
}

void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])
{
    needle_info 引脚；

    // 检查 i/o 的数量是否正确
    如果 (nrhs != NUM​​IN)
    {
        mexErrMsgTxt("输入参数的数量无效");
    }
    否则如果 (nlhs != NUM​​OUT)
    {
        mexErrMsgTxt("无效的输出参数个数");
    }

    // 检查输入是否不复杂
    如果（mxIsComplex（针））
    {
        mexErrMsgTxt("输入必须是非复数标量整数。");
    }

    // 检查针信息的尺寸是否有效
    int needlerows, needlecols;
    needlerows = mxGetM(NEEDLE);
    needlecols = mxGetN(NEEDLE);

```

```
if (needlerows < 1 || needlecols < 6) 
```

```
    {
        mexErrMsgTxt("针信息的尺寸无效");
    }

    浮动 *needlePoint, *yPoint ;

    // 获取当前针信息
    // 变量的顺序总是如下：
    // r, theta, l, rho, alpha, beta
    needlePoint = (float*) mxGetData(NEEDLE) ;
    pin.r =针点[0]；
    pin.theta = needlePoint[1];
    pin.l =针点[2]；
    pin.rho =针点[3]；
    pin.alpha =针点[4]；
    pin.beta = needlePoint[5];

    //// 读取文件输入
    **//如果（！dasani）
    //{
    // dasani = new NeedleUSsim;
    // mexMakeMemoryPersistent((void*) dasani);
    // mexAtExit(ExitFcn);
    //}
    dasani = 新的 NeedleUSsim；
    删除dasani；**

    // 现在发送一个无用的输出（如果在概念上不需要，请去掉它
    plhs[0] = mxCreateNumericMatrix(1,1,mxSINGLE_CLASS,mxREAL) ;
    yPoint = (float*) mxGetData(plhs[0]) ;
    *yPoint = 1;
}
```

如果用户从命令行或 m 文件脚本的任何位置调用“mexfunction”，则此代码将在构建/编译后运行。由“**”包围的片段（当我试图将片段加粗时）是我正在研究的问题。从第二次查看片段来看，我可能正在将内存分配给 dasani 指针的内存与 Matlab 内存不同（因为内存的范围仅限于 C++ mex 函数，而另一个内存空间的范围对Matlab 程序）。否则，我不确定为什么 Matlab 会抱怨这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T00:38:42.940

MEX API 支持 C 和 C++。因为 C 没有 try/catch 或析构函数，所以 C MEX 函数无法在发生错误时直接清理内存。因此，MATLAB 在内部列表上跟踪内存分配例程（mxMalloc、mxCalloc、mxRealloc、mxFree 和所有返回 mxArrays 的 mxCreate* 函数）的结果。如果在 MEX 函数执行期间发生错误（通过直接调用 mexErrMsgIdAndTxt 或使用 mexEvalString 之类的东西来调用出现错误的 MATLAB 代码），则 MATLAB 将自动释放任何基于 mx 分配的内存。但是，当 MEX 函数正常终止时，MATLAB 还将释放 MEX 函数分配的任何基于 mx 的内存。在析构函数出现之前，这对 MEX 作者来说是一种便利，尽管在现代 C++ 世界中它会变得非常烦人。

有时，就像这个问题一样，您不希望 MATLAB 自动释放内存。在这种情况下，您必须对 mxArrays 使用 mexMakeMemoryPersistent 或 mexMakeArrayPersistent。

如果它最初是使用 mxMalloc、mxCalloc 或 mxRealloc 分配的，则您应该只传递一个指向 mexMakeMemoryPersistent 的指针。所以这段代码

```
dasani = new NeedleUSsim;
mexMakeMemoryPersistent((void*) dasani); 
```

大写“B”不好，除非您重载了 NeedleUSsim::operator new() 以使用 mxMalloc，我不推荐这样做。但是，如果 dasani 的字段是使用 mxMalloc 等分配的，那么您*可能*希望将这些字段传递给 mexMakeMemoryPersistent。如果可能的话，我建议在 NeedleUSsim 构造函数中执行类似的操作，以使其靠近 mxMalloc 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T19:18:16.720

感觉就像是**mexMakeMemoryPersistent()**造成了所有这些麻烦。我猜你必须用它来指示matlab一旦完成就不要删除内存。但是matlab为什么要删除dasani指针呢？该指针是如何提供给 matlab 的，matlab 需要它做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T21:57:41.173

除了使 dasani 成为持久指针之外，我还需要使用 mxMalloc/mxCalloc 分配的内存使其成员变量也保持持久，例如：

```
如果 (!dasani)
{
    dasani = 新的 NeedleUSsim；
    mexMakeMemoryPersistent((void*) dasani->tplL);
    mexMakeMemoryPersistent((void*) dasani->tplR);
    mexMakeMemoryPersistent((void*) dasani->tplRho_deg);
    mexMakeMemoryPersistent((void*) dasani->tplAlpha_deg);
    mexMakeMemoryPersistent((void*) dasani->tplBeta_deg);
    mexMakeMemoryPersistent((void*) dasani->hashTb);
    mexMakeMemoryPersistent((void*) dasani->template1D);
    mexAtExit(ExitFcn);
}

```

使用如图所示的析构函数：

```
void NeedleUSsim::Deallocate()
{
    免费（（无效*）tplR）；免费（（无效*）tplL）；
    免费（（无效*）tplRho_deg）；免费（（无效*）tplAlpha_deg）；
    免费（（无效*）tplBeta_deg）；
    免费（（无效*）hashTb）；   
    免费（（无效*）模板1D）；
}

```

# django - 在 django 模型自定义 save() 方法中，你应该如何识别一个新对象？

> ID：907695
> 
> 赞同：210
> 
> 时间：2009-05-25T18:45:28.487
> 
> 标签：django, django-models

当我保存新记录（不更新现有记录）时，我想在 Django 模型对象的 save() 方法中触发一个特殊操作。

检查 (self.id != None) 是否有必要且足以保证自我记录是新的并且没有被更新？这可能会忽略任何特殊情况？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2016-02-26T08:59:16.303

检查的替代方法`self.pk`我们可以检查`self._state`模型

`self._state.adding is True`创造

`self._state.adding is False`更新

我从这个[页面得到它](https://docs.djangoproject.com/en/dev/ref/models/instances/#customizing-model-loading)

* * *

## 回答 #2

> 赞同：232
> 
> 时间：2009-05-25T18:49:03.630

**更新：**澄清`self._state`不是私有实例变量，而是以这种方式命名以避免冲突，检查`self._state.adding`现在是更好的检查方式。

* * *

```
self.pk is None: 
```

在新的 Model 对象中返回 True ，除非该对象具有 a`UUIDField`作为其`primary_key`.

您可能需要担心的极端情况是除了 id 之外的字段是否存在唯一性约束（例如，其他字段上的二级唯一索引）。在这种情况下，您手头可能仍有新记录，但无法保存。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-05-27T03:41:36.280

检查`self.id`假定这`id`是模型的主键。更通用的方法是使用[pk 快捷方式](http://docs.djangoproject.com/en/dev/topics/db/queries/#the-pk-lookup-shortcut)。

`is_new = self.pk is None`

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2009-06-02T17:45:36.967

检查**不足以**确定对象是否要在数据库中插入或更新`self.pk == None`。

 **Django O/RM 有一个特别讨厌的 hack，它基本上是检查 PK 位置是否有东西，如果有，则执行 UPDATE，否则执行 INSERT（如果 PK 为 None，则会优化为 INSERT）。

之所以必须这样做，是因为您可以在创建对象时设置 PK。虽然在主键有序列列的情况下并不常见，但这不适用于其他类型的主键字段。

如果你真的想知道你必须做 O/RM 所做的事情并在数据库中查找。

当然，您的代码中有一个特定的案例，它很可能会`self.pk == None`告诉您您需要知道的一切，但这*不是*一个通用的解决方案。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-06-01T05:59:59.813

您可以只连接到发送“已创建”kwargs 的 post_save 信号，如果为真，则您的对象已被插入。

[http://docs.djangoproject.com/en/stable/ref/signals/#post-save](http://docs.djangoproject.com/en/stable/ref/signals/#post-save)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-07-23T17:02:14.290

检查`self.id`和`force_insert`标志。

```
if not self.pk or kwargs.get('force_insert', False):
    self.created = True

# call save method.
super(self.__class__, self).save(*args, **kwargs)

#Do all your post save actions in the if block.
if getattr(self, 'created', False):
    # So something
    # Do something else 
```

这很方便，因为您新创建的对象（自我）具有它的`pk`价值

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-04-27T18:57:46.330

我很晚才进行这次对话，但是当 self.pk 具有与之关联的默认值时，我遇到了填充 self.pk 的问题。

我解决这个问题的方法是在模型中添加一个 date_created 字段

`date_created = models.DateTimeField(auto_now_add=True)`

从这里你可以去

`created = self.date_created is None`

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-03-23T15:29:18.047

对于即使您将 a`UUIDField`作为主键也有效的解决方案（正如其他人所指出的那样，`None`如果您只是 override `save`），您可以插入 Django 的[post_save](https://docs.djangoproject.com/en/1.10/ref/signals/#post-save)信号。将此添加到您的*models.py*：

```
from django.db.models.signals import post_save
from django.dispatch import receiver

@receiver(post_save, sender=MyModel)
def mymodel_saved(sender, instance, created, **kwargs):
    if created:
        # do extra work on your instance, e.g.
        # instance.generate_avatar()
        # instance.send_email_notification()
        pass 
```

此回调将阻止该`save`方法，因此您可以在通过网络发送回响应之前执行触发通知或进一步更新模型等操作，无论您是使用表单还是 Django REST 框架进行 AJAX 调用。当然，负责任地使用并将繁重的任务卸载到作业队列，而不是让您的用户等待:)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-12-04T22:51:00.347

而是使用**pk**而不是**id**：

```
if not self.pk:
  do_something() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-25T18:50:14.250

这是这样做的常用方法。

id 将在第一次保存到数据库时给出

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-04-05T21:26:25.077

```
> def save_model(self, request, obj, form, change):
>         if form.instance._state.adding:
>             form.instance.author = request.user
>             super().save_model(request, obj, form, change)
>         else:
>             obj.updated_by = request.user.username
> 
>             super().save_model(request, obj, form, change) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-08-19T21:11:11.390

这适用于上述所有情况吗？

```
if self.pk is not None and <ModelName>.objects.filter(pk=self.pk).exists():
... 
```

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2009-12-06T13:44:19.310

要知道您是更新还是插入对象（数据），`self.instance.fieldname`请在表单中使用。在您的表单中定义一个干净的函数并检查当前值条目是否与以前的值相同，如果不是，那么您正在更新它。

`self.instance`并`self.instance.fieldname`与新值进行比较

# c# - 如何使用 C# 中的线程一次从 Web 加载多个图像？

> ID：907697
> 
> 赞同：1
> 
> 时间：2009-05-25T18:46:11.047
> 
> 标签：c#, winforms, multithreading, asynchronous

我在 .NET 3.5 中有一个 Windows 窗体应用程序。有一个包含 20 个图片框的表格。还有一个包含 20 个图像 URL 的数组。目标是遍历 URL 数组并将图像从网络加载到图片框中。

我尝试使用标准的 foreach 循环并使用图片框 LoadAsync() 方法，但它不起作用。它将为前 6 个图片框加载图像，而为其他 14 个图片框加载失败。我相信原因与同时请求太多有关。但我不确定。

所以我想尝试一个手动的多线程代码，我会使用图片框的同步 Load() 方法，并允许最多 3 个线程同时从 web 加载图像。

关于如何实现这一点的任何想法？基本上我需要知道如何同时允许处理队列中的 3 个线程。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-25T19:59:23.160

[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)是一个很好的类，用于在 winforms 应用程序的后台线程上运行任务。这是我为您编写的一个小示例，用于演示其用法：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        // Declare a list of URLs and their respective picture boxes
        var items = new Dictionary<string, PictureBox> 
        { 
            { "http://www.google.com/logos/spring09.gif", new PictureBox() { Top = 0, Width = 300, Height = 80  } }, 
            { "http://www.google.com/logos/stpatricks_d4gwinner_eo09.gif", new PictureBox() { Top = 100, Width = 300, Height = 80 } },
            { "http://www.google.com/logos/schiaparelli09.gif", new PictureBox() { Top = 200, Width = 300, Height = 80 } },
            { "http://www.google.com/logos/drseuss09.gif", new PictureBox() { Top = 300, Width = 300, Height = 80 } },
            { "http://www.google.com/logos/valentines09.gif", new PictureBox() { Top = 400, Width = 300, Height = 80 } },
            { "http://www.google.com/logos/unix1234567890.gif", new PictureBox() { Top = 500, Width = 300, Height = 80 } },
            { "http://www.google.com/logos/charlesdarwin_09.gif", new PictureBox() { Top = 600, Width = 300, Height = 80 } },
        };

        foreach (var item in items)
        {
            var worker = new BackgroundWorker();
            worker.DoWork += (o, e) =>
            {
                // This function will be run on a background thread
                // spawned from the thread pool.
                using (var client = new WebClient())
                {
                    var pair = (KeyValuePair<string, PictureBox>)e.Argument;
                    e.Result = new KeyValuePair<PictureBox, byte[]>(pair.Value, client.DownloadData(pair.Key));
                }
            };
            worker.RunWorkerCompleted += (o, e) => 
            {
                // This function will be run on the main GUI thread
                var pair = (KeyValuePair<PictureBox, byte[]>)e.Result;
                using (var stream = new MemoryStream(pair.Value))
                {
                    pair.Key.Image = new Bitmap(stream);
                }
                Controls.Add(pair.Key);
            };
            worker.RunWorkerAsync(item);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T19:02:02.917

如果您希望使用具有多个线程的队列，我会查看 System.Collections 提供的[同步队列集合。](http://msdn.microsoft.com/en-us/library/system.collections.queue.synchronized.aspx)

此外，以下链接是对 C# 中线程的一个很好的介绍。涵盖什么是线程、何时使用（以及何时不使用）、如何启动和停止线程以及如何使您的基本操作线程安全等等：[C# 中的线程](http://www.albahari.com/threading/)

# ruby-on-rails - 我应该在删除操作中使用哪个：user.delete 或 user.destroy？

> ID：907702
> 
> 赞同：3
> 
> 时间：2009-05-25T18:48:59.603
> 
> 标签：ruby-on-rails, activerecord, model

我发现有一个 ActiveRecord 删除和销毁令人困惑。

在我的控制器中，我想在删除操作中删除用户。

结果将是由 User 模型表示的这个实例不再存在于数据库中。

我应该使用哪种方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T18:59:01.003

`delete`由于绕过回调而更快，但出于同样的原因，它的功能较少；`destroy`因此，这是一种更安全的方法，除非您明确知道在特定情况下不需要回调。

# iphone - 将子视图添加到 UiScrollView .. 顺利

> ID：907705
> 
> 赞同：2
> 
> 时间：2009-05-25T18:49:27.340
> 
> 标签：iphone, uiscrollview

我正在尝试实时动态地将子视图添加到 UiScorllView （以节省内存）。

这样做会导致滚动视图暂停一秒钟......解决这个问题的方法是什么？

任何提示表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T19:16:58.613

阅读如何`UITableView`解决这个问题。您在这里最大的性能打击是子视图的分配和初始绘制，但主要是分配。`UITableView`s 使用重用标识符和内存堆在滚动期间将其所有单元格保留在内存中，因此它可以仅重用已分配的单元格，而不是每次新单元格滚动到可视区域时重新分配新单元格。

也许您可以实现自己的子视图重用系统来节省所有分配时间。再次，详细阅读它是如何`UITableView`做到的，并以此为基础建立模型。不幸的是，真的没有比我能想到的更简单的解决方案了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T19:17:32.917

我建议任何可能挂起用户界面的操作都应该放在一个线程中。这样，添加子视图的过程将在后台完成，不干扰主线程。

您可以通过这样做，`NSThread`也可以实施`NSOperationQueue`.

NSThread 的声明很简单；

```
[NSThread detachNewThreadSelector:@selector(myFunction:) toTarget:myObject withObject:argumentObject]; 
```

其中“myFunction”应替换为函数名称，“myObject”应替换为对象（或简单地说明`self`，如果您希望当前类处理线程）和“argumentObject”应替换为您要传递的任何对象作为论据；这可能是`nil`

函数本身应该是这样的；

```
-(void)myFunction {
   NSAutoReleasePool *pool = [[NSAutoReleasePool alloc] init];
   // do your thing here...
   [pool release];
} 
```

每个线程都应该有一个自动释放池。

一个提示；如果您的子视图必须动画，请尝试声明一个`UIAnimation`块

# c# - 使用 C# 来利用 Windows 7 RC？

> ID：907707
> 
> 赞同：5
> 
> 时间：2009-05-25T18:50:03.267
> 
> 标签：c#, windows-7, jump-list

我想使用 C# 来利用 Windows 7 中的新功能（即 JumpList、Window Shake 等）。是否有任何网站/教程可以向我展示我想学习的内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T19:18:04.180

看看这个链接。好资料：

[http://windowsteamblog.com/blogs/developers/archive/2009/05/18/windows-7-managed-code-apis.aspx](http://windowsteamblog.com/blogs/developers/archive/2009/05/18/windows-7-managed-code-apis.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T18:52:42.110

[.NET 跳转列表](https://stackoverflow.com/questions/466726/net-jump-list)

[http://www.vcskicks.com/aero-shake.php](http://www.vcskicks.com/aero-shake.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-01T23:15:16.957

该库位于[http://code.msdn.microsoft.com/WindowsAPICodePack](http://code.msdn.microsoft.com/WindowsAPICodePack)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T22:56:28.603

我找到了有关如何使用 MSDN 中的 WindowsAPICodePack 执行 JumpList 的链接。

[点击这里观看视频](http://video.msn.com/video.aspx?mkt=en-us&vid=e93f69cc-1f30-4c19-b9ae-83ee8354eaf1)

# drupal - Drupal 6 - Views2 - 如何构建非节点视图

> ID：907709
> 
> 赞同：3
> 
> 时间：2009-05-25T18:50:24.967
> 
> 标签：drupal, drupal-6, drupal-views, views2

我需要在非节点的drupal中构建视图，实际上是drupal外部的对象。我正在调用的 api 将我传回一个 stdClass 对象。

任何人都有关于如何让 Views2 显示非节点对象的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T20:22:59.087

我对 Views 2 的理解是，它旨在处理存储在数据库中的信息。

如果您无权访问编写 API 所针对的数据库，请考虑将 API 返回的对象写入表中。最简单的事情可能是从对象创建节点。然后您可以使用 Views 2 访问它们。

这类似于 Acitivty Stream 模块 ( [http://drupal.org/project/activitystream](http://drupal.org/project/activitystream) ) 采用的方法。它根据各种 API 返回的数据创建节点。查看模块的代码以获取有关如何创建节点的示例：

[http://cvs.drupal.org/viewvc.py/drupal/contributions/modules/activitystream/activitystream.module?view=markup](http://cvs.drupal.org/viewvc.py/drupal/contributions/modules/activitystream/activitystream.module?view=markup)

另一方面，如果您有权访问源数据库，您可能会考虑将该数据库的表直接公开给视图。这是 CiviCRM v2.2.3 中包含的最新 Views 2 集成代码中采用的方法，您可以在此处查看：

[http://svn.civicrm.org/civicrm/trunk/drupal/modules/views/](http://svn.civicrm.org/civicrm/trunk/drupal/modules/views/)

CiviCRM 是一个 Drupal 模块，它将数据写入 Drupal 数据库之外的表中——而不是节点中。视图集成代码将这些表中的大部分暴露给 Drupal。

希望这可以帮助。

——安德鲁·B。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T01:24:02.597

根据 Views 3[路线图](http://www.angrydonuts.com/views-3-x-roadmap)，Views 最终将与非 SQL 数据源一起工作。与此同时，在这方面已经完成了一些非常初步的工作，使用[Flikr API 作为概念验证。](http://www.developmentseed.org/blog/2009/feb/05/extendr-flickr-and-views)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-09T07:11:57.907

在最新的 6.x-1.x-dev 分支中修复。除了节点之外，VBO 现在还支持用户和评论。一个特殊的 hook_object_info 可用于支持任何其他类型的对象。请尝试并告诉我！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T19:46:29.817

您必须向此处描述的视图公开自定义数据：

[http://www.darrenmothersele.com/drupal-blog/drupal-views2-handlers](http://www.darrenmothersele.com/drupal-blog/drupal-views2-handlers) [http://views-help.doc.logrus.com/help/views/api-tables](http://views-help.doc.logrus.com/help/views/api-tables)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-25T18:54:11.107

Views 专为使用节点 + CCK 而构建。如果要为自定义页面创建视图，则需要编写一些额外的模块 + 主题页面。

# .net - 如何在不重新编译的情况下更改 Web 服务 URL？

> ID：907715
> 
> 赞同：0
> 
> 时间：2009-05-25T18:51:56.510
> 
> 标签：.net, web-services, netsuite

我们有一个通过 Netsuite 的网络服务与 Netsuite 对话的网络应用程序。我们通过生成所有代理代码的 VS 2005 的添加 Web 引用向导设置 Web 服务。

Netsuite 具有允许测试的沙盒帐户（不同的 Web 参考 URL）。理想情况下，我们希望在实时服务和测试服务之间来回切换。我希望我可以更改一个 xml 文件以指向我想要的 Web 服务。配置文件包含

```
 <Netsuite.Properties.Settings>
        <setting name="Netsuite_com_netsuite_webservices_v21_NetSuiteService"
            serializeAs="String">
            <value>https://webservices.netsuite.com/services/NetSuitePort_2008_2</value>
        </setting>
    </Netsuite.Properties.Settings> 
```

但网络参考 URL 是[https://webservices.netsuite.com/wsdl/v2008_2_0/netsuite.wsdl](https://webservices.netsuite.com/wsdl/v2008_2_0/netsuite.wsdl)

有没有人试过这个并且知道怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T19:03:17.000

您可以将 WebService URL 放在 web.config（或 AppSettings.config）文件中，然后在运行时设置它。

```
wsProxy proxy = new wsProxy();
wsProxy.Url = ConfigurationManager.AppSettings.Get("WebserviceUrl");
wsProxy.DoSomething(); 
```

这将允许您在不重新编译应用程序的情况下更改 WebService URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T21:02:40.600

无法在 VS2005 中进行测试，但我知道在 2008 年部署 Web 应用程序时，它会将服务 URI 放在 Properties 目录中的 Settings.settings 文件中。您可以更改 URI 以指向那里的服务测试实例并重新启动应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-04T01:10:35.393

我经常使用 NetSuite 集成应用程序执行此操作，而无需重新编译。将配置文件中的服务值换成

[https://webservices.sandbox.netsuite.com/services/NetSuitePort_2008_2](https://webservices.sandbox.netsuite.com/services/NetSuitePort_2008_2)

如果您将此值用于生产：

h ttps://webservices.netsuite.com/services/NetSuitePort_2008_2

# asp.net-mvc - 从 HTMLHelper 或从 ASP.NET MVC 中的用户控件注入 Javascript 和 HTML

> ID：907725
> 
> 赞同：0
> 
> 时间：2009-05-25T18:54:12.887
> 
> 标签：asp.net-mvc

我一直在阅读这篇有趣的文章，这增加了我对 MVC [链接文本中最佳实践的日益困惑](http://weblogs.asp.net/rashid/archive/2009/05/20/asp-net-mvc-poll-result-jquery-ui-mvc-component-demo-and-more-feedback-required.aspx)

关于使用 HTMLHelper 注入 JavaScript 和 HTML 标签或将其置于用户控制中的 wither 存在非常激烈的争论。

你有什么建议？如果您建议将其放在用户控件中，您如何使其通用并在不同的视图中使用它并保持可测试性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T19:01:31.577

关于 javascript，我会说这些方法似乎都不适合我。[我是不显眼的 javascript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)的忠实粉丝，所以我总是喜欢在我的页面开头添加一个脚本标签，而不是在帮助程序或用户控件中编写一行 js。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T19:45:24.263

“将 Javascript 注入标记”对我来说是个坏主意。我更喜欢在每种具体情况下尽可能多地分离脚本和标记。我正在使用 HtmlHelpers 创建自定义 HTML 标记或一组逻辑组合的 HTML 标记。至于用户控件，我主要使用它来创建视图，可以为 AJAX 请求返回，同时可以包含在“普通页面”（​​非 AJAX 请求）中。

# asp.net-mvc - 您如何调试“路由表中没有路由与提供的值匹配。” 在 ASP.NET MVC 中

> ID：907729
> 
> 赞同：11
> 
> 时间：2009-05-25T18:55:28.797
> 
> 标签：asp.net-mvc

我似乎一直遇到这个错误：

> 路由表中没有路由与提供的值匹配。
> 
> 当前 Web 请求执行期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

堆栈跟踪只是一堆 MVC 垃圾。

显然我正在查询一条不存在的路线，但我如何发现它实际上试图查询的路线？我很想知道实际的 URL 和 HTTP 方法。我怎样才能发现这一点？

（我习惯了 Django，其中尝试的 URL 是异常的一部分，并且我更喜欢一种比查看我的页面源并找出它更有效的方法。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-25T18:57:32.613

有一个[不错的路由调试器](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-01-25T04:09:06.780

您可以使用[MvcContrib](http://www.codeplex.com/MVCContrib)的`RouteDebugger`实用程序类来更好地查看处理请求的路由。

您需要做的就是添加对 MvcContrib 的引用，并将此代码添加到`Global.asax`

> ```
> RegisterRoutes(RouteTable.Routes);
> RouteDebugger.RewriteRoutesForTesting(RouteTable.Routes); 
> ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-12T06:16:23.767

您可以使用 return Redirect("/Home/index") 而不是

```
return RedirectToAction("Home","index"); 
```

或者

我的解决方案是在路由值参数更改中传入区域：

```
return RedirectToAction("ActionName", "ControllerName"); 
```

到：

```
return RedirectToAction("ActionName", "ControllerName", new { area = "AreaName" }) 
```

# batch-file - 忽略 .bat 批处理脚本中的问号

> ID：907730
> 
> 赞同：0
> 
> 时间：2009-05-25T18:56:21.040
> 
> 标签：batch-file, scripting

问题是我需要将一个带有问号的参数传递给 .bat 批处理文件。如果我使用问号，则参数没有很好地传递。我该如何解决这个问题？

我在这条线上遇到了麻烦：

```
script.bat /n"output.owl" /r"http://www.address.com/blog/?feed=rss2" 
```

`=`符号也可能是一个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-03-14T01:12:04.250

我怀疑这里的问题是原始批处理文件使用 for 循环来处理命令行选项，而问号被用于文件名通配符扩展。

```
> type fortest.bat
@echo off
for %%a in (%*) do (
   echo arg is %%a
)
> fortest a b c/?d
arg is a
arg is b 
```

使用位置参数 %1 和 %2 可以避免在 for ... (%*) 循环中进行通配符扩展。如果需要处理未知数量的参数，移位运算符也避免了通配符扩展。

```
> type shifttest.bat
@echo off
:loop
    if "x%1" == "x" goto :eof
    echo arg is %1
    shift /1
    goto :loop
> shifttest a b c/?d
arg is a
arg is b
arg is c/?d 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:06:31.207

你总是可以为 ? 在您的批处理文件中并向用户显示适当的消息。

[这是一个](https://stackoverflow.com/questions/26551/how-to-pass-command-line-parameters-in-batch-file)已经被问到的对你有帮助的问题。

# upload - Watin 帮助 - VISTA 下的文件上传

> ID：907733
> 
> 赞同：0
> 
> 时间：2009-05-25T18:59:03.297
> 
> 标签：upload, file-upload, watin

我正在尝试使用 Watin 和 C# 上传文件。在 Windows XP 下，Watin 会打开 Filebrowse 窗口并正确选择文件，但在 Vista 下会弹出浏览器窗口但没有选择文件。你能帮忙让它在Vista下工作吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T09:27:13.073

您使用的是哪个 Watin 版本？我在 Vista 下上传也遇到了一些困难（使用 Watin rtw）。但自从使用 Watin beta 2.0（2009 年 3 月 30 日）上传作品后没有问题。因此，首先检查您是否拥有修复该错误的最新版本。如果这不是问题，你能给我们一些代码示例吗？

# php - 正则表达式搜索帮助

> ID：907735
> 
> 赞同：1
> 
> 时间：2009-05-25T18:59:39.973
> 
> 标签：php, regex, arrays

给定一个字符串，例如：

```
a:2:{i:0;s:1:"1";i:1;s:1:"2";} 
```

我想找到引号内的每个整数，并创建一个包含在字符串中找到的所有整数的数组。

最终结果应该是一个数组，如：

```
Array
(
    [0] => 1
    [1] => 2
) 
```

我猜你使用 preg_match() 但我没有使用正则表达式的经验:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-25T19:07:37.070

这个怎么样：

```
 $str = 'a:2:{i:0;s:1:"1";i:1;s:1:"2";}';
 print_r(array_values(unserialize($str))); 
```

不是正则表达式，相同的答案。

这是有效的，因为您拥有的字符串是一个序列化的 PHP 数组。使用正则表达式将是错误的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:09:41.497

正则表达式（在程序中）如下所示：

```
$str = 'a:2:{i:0;s:1:"1";i:1;s:1:"2";}';
preg_match_all('/"(\d+)"/', $str, $matches);
print_r($matches[1]); 
```

# java - Java正则表达式用于识别数字多于非数字的字符串

> ID：907745
> 
> 赞同：1
> 
> 时间：2009-05-25T19:04:25.627
> 
> 标签：java, regex

如何在 Java 中使用正则表达式（模式）识别包含比非数字更多数字的字符串？谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-25T19:06:13.390

这不是一种常规语言，因此它不能被普通正则表达式捕获。无论如何都有可能，但几乎可以肯定不使用正则表达式会更容易：

```
public static boolean moreDigitsThanNonDigits(String s) {
    int diff = 0;
    for(int i = 0; i < s.length(); ++i) {
        if(Character.isDigit(s.charAt(i))) ++diff;
        else --diff;
    }
    return diff > 0;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-25T19:10:22.103

您将无法编写执行此操作的正则表达式。但是您已经说过您正在使用 Java，为什么不混合一些代码呢？

```
public boolean moreDigitsThanNonDigits(String input) {
    String nonDigits = input.replace("[0-9]","");
    return input.length() > (nonDigits.length * 2);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-25T20:00:44.280

正则表达式在概念上不能执行这样的任务。它们等价于形式语言或（常规）自动机。它们没有内存（或堆栈）的概念，因此无法计算符号的出现次数。在表达性方面的下一个扩展是下推自动机（或堆栈机器），它对应于上下文无关文法。在为此任务编写这样的语法之前，使用上述方法`moreDigitsThanNonDigits`是合适的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-19T10:12:49.413

如前所述，所讨论的语言不是正则的，无法使用正则表达式检测到。

我将为您提供另一种使用正则表达式计算字符串中的位数和非位数的方法！

您可以使用该`String.replaceAll`方法删除输入字符串中的所有非数字。结果字符串的长度将是输入中的位数。

同样，您可以删除输入字符串中的所有数字，结果字符串的长度将是输入字符串中非数字的数量。

```
public static boolean test(String str) {
         int numDigits = str.replaceAll("\\D","").length();
         int numNonDigits = str.replaceAll("\\d","").length();

         return numDigits > numNonDigits;
} 
```

[**Ideone 链接**](http://www.ideone.com/VQRQR)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T19:09:27.520

我不确定使用正则表达式是否是最好的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T19:11:59.793

单独的正则表达式不能（因为它们不计算任何东西）；但是如果你想使用它们，那么只需使用两个替换：一个去掉所有数字，一个只保留它们。然后比较结果的字符串长度。

当然，我宁愿使用戴夫的回答。

# c# - 依赖注入和类继承

> ID：907746
> 
> 赞同：17
> 
> 时间：2009-05-25T19:05:44.827
> 
> 标签：c#, dependency-injection, castle-windsor

我觉得这是我应该已经知道的事情，但我今天只是没有在所有引擎上开火......

我有一个带有单个 ctor 的基类，它将接口的实现作为唯一的参数。我正在使用 DI 框架，并且我的组件注册都设置好了并且工作正常。

当我从这个基类继承时，除非我将值传递给基构造函数，否则我必须定义一个无参数的 ctor，它会绕过 DI。

所以现在我有：

```
public class MyObjectBase
{
    IMyRequiredInterface _InterfaceImpl;
    public MyObjectBase(IMyRequiredInterface interfaceImpl)
    {
        _InterfaceImpl = interfaceImpl;
    }
    ...
}

public class AnotherObject : MyObjectBase
{
    public AnotherObject()
    {
    }
    ...
} 
```

所以，走出大门，这失败了。实例化 AnotherObject 时出现错误，表明没有采用 0 个参数的基类 ctor。好的，我明白了。但现在我有一个选择：要么修改后代类 ctor 以采用类似的参数并将该值传递给基 ctor，要么在基类中连接一个 ctor 链，迫使我绕过 DI 并创建一个具体的实现所需的接口并将其作为无参数 ctor 声明的一部分传入。

目标是满足基类的要求，而后代类对此一无所知。

也许我做错了，但这让我很烦。有什么更好的处理方法的想法吗？我觉得我必须错过一些简单的东西......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-25T19:12:04.050

正确的做法是：

```
public class AnotherObject : MyObjectBase {
    public AnotherObject(IMyRequiredInterface interfaceImpl) : 
        base(interfaceImpl) {
    }
} 
```

您特别要求采用这种方法以外的方法。为什么？

> 目标是满足基类的要求，而后代类对此一无所知。

这通常是错误的做法。你为什么要这样做？

### 更新：

根据您后来的评论，您可能应该使用（并配置您的容器以使用）属性注入而不是构造函数注入。这将满足您的所有要求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T19:11:33.210

Err....继承的全部意义`MyObjectBase`在于，就行为而言，你得到了好的和坏的。如果你不能在`MyObjectBase`没有对象实现的情况下创建 a `IMyRequiredInterface`，那么你也不能在没有这样的对象的情况下创建子类。

那么，当有人不把那个交给你时，你会怎么做。你有默认吗？

子类实例化实现的东西`IMyRequiredInterface`并通过`super(...)`调用将其传递给超类构造函数是非常合理的。你能做到吗？（不过，我记得，在 Java 中你可能会对此有点犹豫，`super`在做任何其他事情之前必须先打电话......）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T19:11:44.270

这里有一种代码气味。如果您从具有无参数构造函数的类继承，则意味着此基类的作者打算在不提供必要依赖项的情况下使其无法正常运行。如果您从它继承并调用需要此依赖项的基本方法，则如果未提供该依赖项，您的代码可能会失败。所以如果你真的认为你应该完全重写这个行为你不必从这个基类继承，否则只需复制继承类中的构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T19:19:30.713

在不带参数的基类中提供一个受保护的构造函数怎么样？

```
 class MyBase
{
    readonly int _x;
    public MyBase(int x)
    {
        _x = x;
    }

    protected MyBase()
    {
        _x = 0;
    }
}

class MyChild : MyBase
{
    public MyChild()
    {

    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T19:52:23.627

大多数 DI 框架都具有使用属性将服务注入属性（Property Setter Injection）的功能，因此您可以尝试一下。

您可以子类化，但子类必须知道如何创建或获取接口实现（使用 ServiceLocator 或其他东西）。

从 DI 的角度来看，它没有任何事情要完成，因为该类只有一个空的构造函数（大多数使用具有最多参数的构造函数）并且没有属性告诉他做任何其他事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-11T15:37:53.780

我有同样的场景，我的基（具体）类和子类有依赖关系，我担心它们是否是不同的实例。

但是，Autofac（我也相信其他容器工具）具有 .InstancePerRequest() ，它将在每个 Http 请求中共享相同的实例。

builder.RegisterType().As().InstancePerRequest();

# .net - ReportViewer 与 CrystalReport .NET

> ID：907749
> 
> 赞同：1
> 
> 时间：2009-05-25T19:06:46.947
> 
> 标签：.net, crystal-reports, reportviewer

我正在寻找 CrystalReport 和 ReportViewer 之间的一些比较。优点和缺点，以及为什么我应该使用其中一个。

有没有人偶然发现过这样的文章？或者两者都有一些经验？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T19:12:47.340

您可以在[比较 SQL Server Reporting Services 与 Crystal Reports中找到一些很好的答案](https://stackoverflow.com/questions/168427/compare-sql-server-reporting-services-to-crystal-reports)

# opengl - 是否可以使用 OpenGL 点精灵来模拟广告牌精灵？

> ID：907756
> 
> 赞同：10
> 
> 时间：2009-05-25T19:10:11.637
> 
> 标签：opengl, point-sprites

我试图在 OpenGL 中设置点精灵，以像广告牌精灵那样随距离改变大小，但我无法获取这些值`GL_POINT_DISTANCE_ATTENUATION_ARB`来做任何有用的事情。是否存在与给定投影匹配的值的相关性？我想要做的甚至可能吗？

正在使用的渲染代码：

```
glPointParameterfARB  = (PFNGLPOINTPARAMETERFARBPROC)wglGetProcAddress("glPointParameterfARB");
glPointParameterfvARB = (PFNGLPOINTPARAMETERFVARBPROC)wglGetProcAddress("glPointParameterfvARB");

glClear(GL_COLOR_BUFFER_BIT|GL_DEPTH_BUFFER_BIT);
glLoadIdentity();
gluPerspective(100.0, 800.0/600.0, 0.1, 10.0);

float quadratic[] =  { 5.0f, 0.1f, 10.0f };
glPointParameterfvARB( GL_POINT_DISTANCE_ATTENUATION_ARB, quadratic );

float maxSize = 0.0f;
glGetFloatv( GL_POINT_SIZE_MAX_ARB, &maxSize );
if( maxSize > 100.0f )  maxSize = 100.0f;
glPointSize( maxSize );

glPointParameterfARB( GL_POINT_FADE_THRESHOLD_SIZE_ARB, 0.1f );
glPointParameterfARB( GL_POINT_SIZE_MIN_ARB, 0.1f );
glPointParameterfARB( GL_POINT_SIZE_MAX_ARB, maxSize );

glTexEnvf( GL_POINT_SPRITE_ARB, GL_COORD_REPLACE_ARB, GL_TRUE );

glEnable( GL_POINT_SPRITE_ARB );

glScalef(0.75,1,1);
glTranslatef(0.00,0.0,-1.0);
glScalef(0.5,0.5,0.5);
glRotatef(counter*0.1+0.5,1.0,1.0,0.0);

glBegin( GL_POINTS );

for( int i = 0; i < 100; ++i )
{
    glColor4f( i%10*0.1, i/10*0.1, 0.5, 1.0f );

    glVertex3f( i%10*0.2-1.0,i/10*0.2-1.0,
    ((i%10-5)*(i%10-5)+(i/10-5)*(i/10-5))*0.01 );
}

glEnd();

glDisable( GL_POINT_SPRITE_ARB ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-24T15:24:08.737

以下是我如何使我的穷人缩放点大小的方法：

```
void render() {
    glEnable(GL_VERTEX_PROGRAM_POINT_SIZE_ARB);
    glHint(GL_POINT_SMOOTH_HINT, GL_NICEST);
    glEnable(GL_POINT_SPRITE);
    glActiveTexture(GL_TEXTURE0);
    glTexEnvi(GL_POINT_SPRITE, GL_COORD_REPLACE, GL_TRUE);

    /* Activate shader program here */
    /* Send pointSize to shader program */

    glBegin(GL_POINTS);
        /* Render points here */
        glVertex3f(...);
    glEnd(GL_POINTS);
} 
```

顶点着色器：

```
uniform float pointSize;
void main() {
    gl_Position = ftransform();
    gl_PointSize = pointSize / gl_Position.w;
} 
```

您可以在片段着色器中做任何您想做的事情，但您必须自己计算颜色、光照和纹理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-31T07:10:34.453

除了 GLSL，通过距离衰减做你想做的事情非常简单。看到事物的投影尺寸如何随着透视投影中的距离二次减小，您只需要使用二次因子即可。

如果您想使用手动设置的点大小，例如距离眼睛 150 个单位，只需使用 1/(150^2) 作为二次因子（常数和线性因子为零 - 如果有的话，您可能希望使用一些小的数字（例如 0.01）作为常数因子，以避免潜在的除以零）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T11:06:07.523

以我的经验，点大小衰减不值得麻烦。您最好编写一个非常简单的 GLSL 顶点着色器，根据您自己执行的一些计算手动设置点大小。我花了大约半天的时间从头开始学习实现这一目标所需的所有 GLSL。

GLSL 代码可能就像这几行一样简单：

```
attribute float psize;

void main()
{   
    gl_FrontColor = gl_Color;
    gl_PointSize = psize;
    gl_Position = ftransform();
} 
```

`psize`用户选择的磅值参数在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-25T17:39:46.620

只需在 pmviewer.sourceforge.net 中查看代码使用点精灵，每个点都有自己的颜色和大小来模拟体积渲染：顶点着色器是：

**顶点着色器**

```
 // with ATI hardware, uniform variable MUST be used by output
    // variables. That's why win_height is used by gl_FrontColor
    attribute float a_hsml1;
    uniform float win_height;
    uniform vec4 cameralocin;
    void main()
    {
    vec4 position=gl_ModelViewMatrix*gl_Vertex;
    vec4 cameraloc=gl_ModelViewMatrix*cameralocin;
    float d=distance(vec3(cameraloc),vec3(position));
    float a_hsml=gl_Normal.x;
    float pointSize=win_height*a_hsml/d; // <- point diameter in
                                        //pixels (drops like sqrt(1/r^2))
    gl_PointSize=pointSize;
    gl_TexCoord[0]=gl_MultiTexCoord0;
    gl_Position=ftransform();
    gl_FrontColor=vec4(gl_Color.r,gl_Color.g,gl_Color.b,gl_Color.a);
    } 
```

**像素着色器**

```
uniform sampler2D splatTexture;
void main()
{
vec4 color = gl_Color * texture2D(splatTexture, gl_TexCoord[0].st);
gl_FragColor = color;\n"
} 
```

只是将粒子发送到 gpu：

```
 void PutOneArrayToGPU(unsigned int m_vbo, float *hArray, unsigned int num)
{
glBindBuffer(GL_ARRAY_BUFFER, m_vbo);
glBufferData(GL_ARRAY_BUFFER,  sizeof(float) * num, hArray, GL_STATIC_DRAW);
int size = 0;
glGetBufferParameteriv(GL_ARRAY_BUFFER, GL_BUFFER_SIZE, &size);
if ((unsigned)size != (sizeof(float) *num))
    {
    fprintf(stderr, "WARNING: Pixel Buffer Object allocation failed!\n");
    fprintf(stderr, "TurningOff the GPU accelerated rendering\n");
    flag_GpuRender=false;
    }
return flag_GpuRender;
} 
```

**然后渲染它们：**

```
 void DrawPointsByGPU()
    {
    glEnableClientState(GL_VERTEX_ARRAY);
    glBindBuffer(GL_ARRAY_BUFFER, m_vboPos);
    glVertexPointer(3, GL_FLOAT, 0, 0);

    glEnableClientState(GL_COLOR_ARRAY);
    glBindBuffer(GL_ARRAY_BUFFER, m_vboColor);
    glColorPointer(4, GL_FLOAT, 0, 0);

    glEnableClientState(GL_NORMAL_ARRAY);
    glBindBuffer(GL_ARRAY_BUFFER, m_vboHSML);
    glNormalPointer( GL_FLOAT, 3*sizeof(float), 0);

    glDrawArrays(GL_POINTS, 0, m_numParticles);

    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glDisableClientState(GL_NORMAL_ARRAY);
    glDisableClientState(GL_COLOR_ARRAY);
    glDisableClientState(GL_VERTEX_ARRAY);

    }; 
```

# jquery - Jquery 多个可排序列表

> ID：907769
> 
> 赞同：0
> 
> 时间：2009-05-25T19:14:36.057
> 
> 标签：jquery, ajax, jquery-ui-sortable, draggable, droppable

有人可以解释如何使用下面的代码。

这是屏幕截图

[替代文字 http://img196.imageshack.us/img196/9514/picture4omk.png](http://img196.imageshack.us/img196/9514/picture4omk.png)

这是我的 JS

```
$(document).ready(function(){ 

    $(function() {
        $("#sortable1, #sortable2").sortable(

            { connectWith: '.connectedSortable', 
            opacity: 0.6, 
            cursor: 'move', 
            update: function() {
            var order = $(this).sortable("serialize"); 
            $.post("home/updateBOX", order, function(theResponse){
                $("#contentRight").html(theResponse);
            });                                                              
        }                                 
        });
    });

}); 
```

这是我目前的看法

```
<div id="contentLeft">
    Category 1
    <ul id="sortable1" class="connectedSortable">
    <?php foreach($getcat1->result() as $box) :?>

            <li id="recordsArray_<?php echo $box->boxID ?>"><?php echo $box->boxID . ". " . $box->boxID . $box->boxText ?></li>
        <?php endforeach; ?>
    </ul>
    Category 2
    <ul id="sortable2" class="connectedSortable">
    <?php foreach($getcat2->result() as $box) :?>

        <li id="recordsArray_<?php echo $box->boxID ?>"><?php echo $box->boxID . ". " . $box->boxID . $box->boxText ?></li>
        <?php endforeach; ?>
    </ul>
</div> 
```

这是我当前的控制器

```
function index()
    {

        // Boxes
        $this->db->order_by('boxListingID','ASC');      
        $this->db->where('boxListingCat',1);
        $data['getcat1'] = $this->db->get('boxes');

        $this->db->order_by('boxListingID','ASC');
        $this->db->where('boxListingCat',2);
        $data['getcat2'] = $this->db->get('boxes');

        // Initialize
        $this->layout->set('nav', $this->class);
        $this->layout->load('layout','home/home_view',$data);
    }   

    function updateBOX()
    {
        if (empty($_POST))  { return false; }
        $updateRecordsArray = $_POST['recordsArray'];
        $listingCounter = 1;
        foreach ($updateRecordsArray as $listingCounter=>$recordIDValue) {
            $this->db->set('boxListingID',$listingCounter+1)->where('boxID',$recordIDValue)->update('boxes');
        }

    }
} 
```

请帮忙！

我一直在努力使以下代码正常工作，以便当您将 li 从一个 UL 拖到另一个 UL 时，它会检测到它在新 UL 中并保存该数据。我不知道从哪里开始

我将非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T19:34:29.823

在**[jQuery UI](http://jqueryui.com/home)**中使用**可拖放****插件**怎么样？

Draggable[插件](http://jqueryui.com/demos/draggable/)使选定的元素可以通过鼠标拖动。

[Droppable 插件](http://jqueryui.com/demos/droppable/)为可拖动对象提供了放置目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:36:42.280

[http://jsfiddle.net/Waw4V/2/](http://jsfiddle.net/Waw4V/2/)

如果您希望制作多个可排序的，最好通过将类附加到每种列表来完成。上面的链接使用 div，但您可以将其应用于列表。

假设您有一个问题列表：

```
<div id='questionList'>
    <div class='question'>
        <div>Question Details</div>
        <div class='answerForQuestion'>
            <div class='answer'>Answer 3
                <span>Details</span>
            </div>
            <div class='answer'>Answer 2</div>
            <div class='answer'>Answer 4</div>
        </div>
    </div>
    <div class='question'>
        <div>Question Details</div>
        <div class='answerForQuestion'>
            <div class='answer'>Answer 2</div>
            <div class='answer'>Answer 7</div>
            <div class='answer'>Answer 11</div>
        </div>
    </div>
</div> 
```

这是你在 jQuery 中所做的：

```
$('#questionList').sortable(); // this makes one each major category sortable
$('.answerForQuestion').sortable({  // this makes sub categories sortable
    connectWith: ['.answerForQuestion']
    change: // this fires everytime the item you drag is moved, put in your logic here, such as an ajax call to update your database
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T06:49:05.327

是的！Draggable 和 Droppable 应该可以解决问题...您可以使用 droppable 的**[drop()](http://docs.jquery.com/UI/Droppable#event-drop)**方法来更新两者的列表状态。

# jquery - 需要一个支持 $.live() 和分组的 jQuery Lightbox 插件

> ID：907771
> 
> 赞同：3
> 
> 时间：2009-05-25T19:15:56.930
> 
> 标签：jquery, jquery-plugins, lightbox

我正在通过 Ajax 引入我的所有图像，并且我正在为这个项目的前端寻找一个快速修复。我已经尝试了几个 jQuery 灯箱插件，但我似乎无法让它们在实时功能中执行（如果我错误地认为我需要这样做，请纠正我）。

目前正在尝试使用 Balupton 的 Lightbox 插件（由于我是新用户而无法链接），并且在尝试了所有示例均无济于事后，我已经尝试使用它（也无法正常工作）：

```
$('a.lightbox-gallery').live('click', function(){
    $(this).lightbox();
}); 
```

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T06:34:45.450

1）您可以破解灯箱插件以绑定实时事件 2）您可以在 ajax 完成后调用灯箱，仅在新元素上：

```
$.ajax({
    type: "POST",
    url: "url.php",
    cache: false,
    success: function(data){
        $(data).find('a[rel=lightbox]').lightbox(settings).end().appendTo('#ajaxTarget');
    }
}); 
```

因为`settings`您可以使用数组来避免两次写入相同的内容；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-04-07T00:51:09.080

你可以像这样使用colorbox和jquery的live函数

```
$('a[rel=gallery]').live('click', function() {
  url = this.href; // this is the url of the element event is triggered from
  $.colorbox({href: url});
  return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T19:55:15.897

您还可以查看 livequery jquery plugin not so bad plugin ;) [http://docs.jquery.com/Plugins/livequery](http://docs.jquery.com/Plugins/livequery) 您可以将该插件嵌入到您的 jquery 文件中并将其用作简单的 jquery 函数：

```
$('.ajax-loaded-element').livequery('click',function(){

//do somenthing

}); 
```

# javascript - 如何验证函数是否在 JavaScript 中定义？

> ID：907773
> 
> 赞同：1
> 
> 时间：2009-05-25T19:16:44.853
> 
> 标签：javascript

如何验证是否已经定义了函数？

这行得通吗？

```
if(window.opener.MyFunctionBlah) {  ...  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T19:20:08.730

```
if (typeof yourFunctionName === 'function') {
    yourFunctionName();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T19:19:32.897

是的。函数只是对象的属性，就像任何其他对象一样，因此您可以这样对待它们。如果该函数（或被`window.opener`调用的任何成员`MyFunctionBlah`）已定义且非空，则您在上面发布的条件将返回 true。

# javascript - 如何使用 javascript 或 vbscript 或 jquery 设置 ie 边距？

> ID：907779
> 
> 赞同：0
> 
> 时间：2009-05-25T19:18:59.963
> 
> 标签：javascript, jquery, internet-explorer, vbscript

我想打印发票，但也想用 javascript 或 vbscript 或其他任何东西设置边距和页面大小。有没有关于那个的教程？

你会分享一些关于ie8的东西以便轻松打印出来吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T19:23:40.220

获得可靠打印的最佳方式是在服务器端生成 PDF 并让客户端下载并打印它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:24:38.580

听起来您想要一个 CSS 打印样式表。请参阅“[权威指南](http://www.webcredible.co.uk/user-friendly-resources/css/print-stylesheet.shtml)”。PS JQuery 是一个 JavaScript 库，而不是一种编程语言（与某些人的看法相反）。

# visual-studio-2008 - 如何使 Visual Studio 2008“查找所有引用”正常工作？

> ID：907788
> 
> 赞同：3
> 
> 时间：2009-05-25T19:21:43.250
> 
> 标签：visual-studio-2008, ide

只是一件让我烦恼的事情。

当我右键单击方法名称时，会出现一个带有“**查找所有引用**”选项的上下文菜单。

它工作正常，*除非*你正在实现一个**Interface**。然后它列出了**所有**引用（也许这就是它被称为*Find All References*的原因？），独立于实现它的类。

例子：

```
interface IGetAThing<T>
{
    T Get();
}

public class ThingManager: IGetAThing<Thing>
{
    public Thing Get() {
        return new Thing();
    } 
}

public class ThingManagerReloaded: IGetAThing<Thingmabob>
{
    public Thingmabob Get() {
        return new Thingmabob();
    } 
} 
```

当我搜索方法*ThingManager->Get*的所有引用时，我得到一个列表，其中包含*ThingManagerReloaded->Get*的所有引用。

我想要的是将引用列表限制为仅一个类引用。右击*ThingManagerReloaded->Get*方法只显示*ThingManagerReloaded->Get*相关使用的列表，**不**包括*ThingManager->Get*

这在VS2008上可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T19:30:09.723

ReSharper 检测到这一点并询问您是否要从基本接口中查找该方法的用法。如果您拒绝，它会按照您在问题中的要求执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T19:26:42.570

resharper 和 coderush 等第三方工具为此类操作提供了更好的支持。如果您的解决方案足够小并且机器足够强大，那么您可能会大量使用这些工具。要直接回答您的问题，我认为开箱即用的 VS2008 不可能做到这一点。

（您可能会从使用过这些工具的人那里得到更好的答案。）

# .net - 我可以在 .NET CF 上使用什么来替代 HttpUtility.UrlEncode

> ID：907801
> 
> 赞同：5
> 
> 时间：2009-05-25T19:30:23.280
> 
> 标签：.net, compact-framework

我需要将 .NET 代码移至 Compact Framework。该代码使用 HttpUtility.UrlEncode 对查询参数进行编码，但 System.Web 在 CF 上不可用。我可以用什么代替？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-25T22:44:01.127

使用[Uri.EscapeDataString](http://msdn.microsoft.com/en-us/library/system.uri.escapedatastring.aspx)。它几乎等同，而且可能更好，并且包含在 NetCF 中。

[有关它们差异的更多信息](http://blog.nerdbank.net/2009/05/uriescapedatapath-and.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T19:47:49.080

您可以查看捆绑[单声道的实现](http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/System.Web/System.Web/HttpUtility.cs?revision=131599&view=markup)（可选简化）。不过，我不知道您必须引入多少依赖项。这可能可行，也可能不可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T22:38:47.020

你可能不得不自己动手，甚至更好地作弊。使用反射器，您将很快看到 UrlEncode 有许多重载方法，调用仅期望字符串参数的版本最终将字符串转换为字节数组并调用内部方法。

编辑：在侵犯版权的情况下删除代码片段...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-12T16:40:54.807

我`Uri.EscapeUriString`改用了因为`Uri.EscapeDataString`编码完整的字符串，而不仅仅是参数，例如

```
http://website.com/a/abc{d}d 
```

使用 EscapeDataString 它被转换为：

```
http%3A%2F%2Fwebsite.com%2Fa%2Fabc%7Bd%7Dd 
```

使用 Uri.EscapeUriString，它正确地变成了这样：

[http://website.com/a/abc%7Bd%7Dd](http://website.com/a/abc%7Bd%7Dd)

# php - 使用 WHERE 子句将数组传递给查询

> ID：907806
> 
> 赞同：331
> 
> 时间：2009-05-25T19:32:26.803
> 
> 标签：php, mysql, arrays

给定一个 id 数组，`$galleries = array(1,2,5)`我希望有一个 SQL 查询，该查询在其 WHERE 子句中使用数组的值，例如：

```
SELECT *
FROM galleries
WHERE id = /* values of array $galleries... eg. (1 || 2 || 5) */ 
```

如何生成此查询字符串以与 MySQL 一起使用？

* * *

## 回答 #1

> 赞同：353
> 
> 时间：2009-05-25T19:37:57.743

> **谨防！**这个答案包含一个严重的[SQL 注入](https://stackoverflow.com/questions/60174/how-can-i-prevent-sql-injection-in-php)漏洞。不要使用此处提供的代码示例，除非确保已清理任何外部输入。

```
$ids = join("','",$galleries);   
$sql = "SELECT * FROM galleries WHERE id IN ('$ids')"; 
```

* * *

## 回答 #2

> 赞同：313
> 
> 时间：2014-05-13T20:31:36.507

**使用 PDO：**^([1])

```
$in = join(',', array_fill(0, count($ids), '?'));
$select = <<<SQL
    SELECT *
    FROM galleries
    WHERE id IN ($in);
SQL;
$statement = $pdo->prepare($select);
$statement->execute($ids); 
```

**使用 MySQLi** ^([2])

```
$in = join(',', array_fill(0, count($ids), '?'));
$select = <<<SQL
    SELECT *
    FROM galleries
    WHERE id IN ($in);
SQL;
$statement = $mysqli->prepare($select);
$statement->bind_param(str_repeat('i', count($ids)), ...$ids);
$statement->execute();
$result = $statement->get_result(); 
```

* * *

解释：

### 使用 SQL`IN()`运算符检查给定列表中是否存在值。

一般来说，它看起来像这样：

```
expr IN (value,...) 
```

我们可以构建一个表达式来放置在`()`我们的数组中。注意括号内必须至少有一个值，否则 MySQL 将返回错误；这等同于确保我们的输入数组至少有一个值。为了帮助防止 SQL 注入攻击，首先`?`为每个输入项生成一个参数化查询。在这里，我假设包含您的 id 的数组被称为`$ids`：

```
$in = join(',', array_fill(0, count($ids), '?'));

$select = <<<SQL
    SELECT *
    FROM galleries
    WHERE id IN ($in);
SQL; 
```

给定一个包含三个项目的输入数组`$select`将如下所示：

```
SELECT *
FROM galleries
WHERE id IN (?, ?, ?) 
```

再次注意，`?`输入数组中的每个项目都有一个。然后我们将使用 PDO 或 MySQLi 来准备和执行上述查询。

### 将`IN()`运算符与字符串一起使用

由于绑定的参数，很容易在字符串和整数之间进行更改。对于 PDO，无需更改；对于 MySQLi ，如果您需要检查字符串，请更改`str_repeat('i',`为。`str_repeat('s',`

^(^([1]：)为简洁起见，我省略了一些错误检查。您需要检查每个数据库方法的常见错误（或将数据库驱动程序设置为抛出异常）。)

^(^([2]：)需要 PHP 5.6 或更高版本。为了简洁起见，我再次省略了一些错误检查。)

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2011-08-11T16:48:08.017

整数：

```
$query = "SELECT * FROM `$table` WHERE `$column` IN(".implode(',',$array).")"; 
```

字符串：

```
$query = "SELECT * FROM `$table` WHERE `$column` IN('".implode("','",$array)."')"; 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-05-25T19:38:46.913

假设您事先正确清理输入...

```
$matches = implode(',', $galleries); 
```

然后只需调整您的查询：

```
SELECT *
FROM galleries
WHERE id IN ( $matches ) 
```

根据您的数据集适当地引用值。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-05-25T19:36:41.613

采用：

```
select id from galleries where id in (1, 2, 5); 
```

一个简单的`for each`循环将起作用。

[Flavius/AvatarKava 的方式](https://stackoverflow.com/a/907821/1003940)更好，但要确保所有数组值都不包含逗号。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-04-11T17:48:55.327

作为[Flavius Stef 的回答](https://stackoverflow.com/questions/907806/passing-an-array-to-a-query-using-a-where-clause/907821#907821)，您可以使用`intval()`它来确保所有`id`都是 int 值：

```
$ids = join(',', array_map('intval', $galleries));  
$sql = "SELECT * FROM galleries WHERE id IN ($ids)"; 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-04-15T14:49:08.663

对于带有转义函数的[MySQLi ：](http://en.wikipedia.org/wiki/MySQLi)

```
$ids = array_map(function($a) use($mysqli) { 
    return is_string($a) ? "'".$mysqli->real_escape_string($a)."'" : $a;
  }, $ids);
$ids = join(',', $ids);  
$result = $mysqli->query("SELECT * FROM galleries WHERE id IN ($ids)"); 
```

对于带有准备好的语句的 PDO：

```
$qmarks = implode(',', array_fill(0, count($ids), '?'));
$sth = $dbh->prepare("SELECT * FROM galleries WHERE id IN ($qmarks)");
$sth->execute($ids); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-04-16T09:12:01.520

我们应该注意*[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)*漏洞和*空条件*。我将按以下方式处理两者。

对于纯数值数组，使用适当的类型转换，即`intval`或`floatval`或`doubleval`在每个元素上。[`mysqli_real_escape_string()`](http://php.net/manual/en/mysqli.real-escape-string.php)如果您愿意，也可以应用于数值的字符串类型。*MySQL 允许将数字和日期变体作为字符串*。

要在传递给查询之前适当地转义值，请创建一个类似于以下内容的函数：

```
function escape($string)
{
    // Assuming $db is a link identifier returned by mysqli_connect() or mysqli_init()
    return mysqli_real_escape_string($db, $string);
} 
```

这样的功能很可能已经在您的应用程序中可供您使用，或者您可能已经创建了一个。

清理字符串数组，如：

```
$values = array_map('escape', $gallaries); 
```

数值数组可以使用`intval`or`floatval`或`doubleval`适当的替代：

```
$values = array_map('intval', $gallaries); 
```

然后最后构建查询条件

```
$where  = count($values) ? "`id` = '" . implode("' OR `id` = '", $values) . "'" : 0; 
```

**或者**

```
$where  = count($values) ? "`id` IN ('" . implode("', '", $values) . "')" : 0; 
```

由于数组有时也可以为空，`$galleries = array();`因此我们应该注意`IN ()`不允许空列表。也可以`OR`改用，但问题依然存在。所以上面的检查, `count($values)`, 是为了保证一致。

并将其添加到最终查询中：

```
$query  = 'SELECT * FROM `galleries` WHERE ' . $where; 
```

> **提示**：如果您想在空数组的情况下显示所有记录（不过滤）而不是隐藏所有行，只需在三元的 false 部分将**0**替换为**1**。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-01-30T09:12:17.903

没有 PDO 的安全方式：

```
$ids = array_filter(array_unique(array_map('intval', (array)$ids)));

if ($ids) {
    $query = 'SELECT * FROM `galleries` WHERE `id` IN ('.implode(',', $ids).');';
} 
```

*   `(array)$ids`将`$ids`变量转换为数组
*   `array_map`将所有数组值转换为整数
*   `array_unique`删除重复值
*   `array_filter`删除零值
*   `implode`将所有值加入到 IN 选择中

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-04-13T15:41:31.753

更安全。

```
$galleries = array(1,2,5);
array_walk($galleries , 'intval');
$ids = implode(',', $galleries);
$sql = "SELECT * FROM galleries WHERE id IN ($ids)"; 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-05-17T19:03:03.777

Col. Shrapnel 的PHP 的[SafeMySQL](https://github.com/colshrapnel/safemysql)库在其参数化查询中提供了类型提示的占位符，并包括几个方便的占位符用于处理数组。占位符将`?a`数组扩展为以逗号分隔的转义字符串列表*。

例如：

```
$someArray = [1, 2, 5];
$galleries = $db->getAll("SELECT * FROM galleries WHERE id IN (?a)", $someArray); 
```

* 请注意，由于 MySQL 执行自动类型强制，SafeMySQL 将上面的 id 转换为字符串并不重要 - 你仍然会得到正确的结果。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-06-03T10:41:14.800

你可能有桌子`texts` `(T_ID (int), T_TEXT (text))`和桌子`test` `(id (int), var (varchar(255)))`

`insert into test values (1, '1,2,3') ;`下面将输出表格文本中的行，其中`T_ID IN (1,2,3)`：

```
SELECT * FROM `texts` WHERE (SELECT FIND_IN_SET( T_ID, ( SELECT var FROM test WHERE id =1 ) ) AS tm) >0 
```

通过这种方式，您可以管理简单的 n2m 数据库关系，而无需额外的表，并且只使用 SQL，而无需使用 PHP 或其他一些编程语言。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-04-15T12:57:49.613

如果我们正确过滤输入数组，我们可以使用这个“WHERE id IN”子句。像这样的东西：

```
$galleries = array();

foreach ($_REQUEST['gallery_id'] as $key => $val) {
    $galleries[$key] = filter_var($val, FILTER_SANITIZE_NUMBER_INT);
} 
```

像下面的例子：![在此处输入图像描述](https://i.stack.imgur.com/znjmR.png)

```
$galleryIds = implode(',', $galleries); 
```

即现在你应该安全地使用`$query = "SELECT * FROM galleries WHERE id IN ({$galleryIds})";`

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-08-19T10:45:30.203

再举个例子：

```
$galleryIds = [1, '2', 'Vitruvian Man'];
$ids = array_filter($galleryIds, function($n){return (is_numeric($n));});
$ids = implode(', ', $ids);

$sql = "SELECT * FROM galleries WHERE id IN ({$ids})";
// output: 'SELECT * FROM galleries WHERE id IN (1, 2)'

$statement = $pdo->prepare($sql);
$statement->execute(); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-04-14T05:28:35.643

除了使用 IN 查询之外，您还有两个选项可以这样做，因为在 IN 查询中存在 SQL 注入漏洞的风险。您可以使用**循环**来获取所需的确切数据，也可以使用带有**OR**大小写的查询

```
1\. SELECT *
      FROM galleries WHERE id=1 or id=2 or id=5;

2\. $ids = array(1, 2, 5);
   foreach ($ids as $id) {
      $data[] = SELECT *
                    FROM galleries WHERE id= $id;
   } 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-01-27T02:43:25.870

因为最初的问题与一个数字数组有关，而我使用的是一个字符串数组，所以我无法使给定的示例工作。

我发现每个字符串都需要用单引号封装起来才能使用该`IN()`函数。

这是我的解决方案

```
foreach($status as $status_a) {
        $status_sql[] = '\''.$status_a.'\'';
    }
    $status = implode(',',$status_sql);

$sql = mysql_query("SELECT * FROM table WHERE id IN ($status)"); 
```

如您所见，第一个函数将每个数组变量包装在`single quotes (\')`其中，然后将数组内爆。

注意：`$status`SQL 语句中没有单引号。

可能有更好的方法来添加引号，但这很有效。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-01-24T16:31:28.600

下面是我使用的方法，将 PDO 与命名占位符一起用于其他数据。为了克服 SQL 注入，我过滤数组以仅接受整数值并拒绝所有其他值。

```
$owner_id = 123;
$galleries = array(1,2,5,'abc');

$good_galleries = array_filter($chapter_arr, 'is_numeric');

$sql = "SELECT * FROM galleries WHERE owner=:OWNER_ID AND id IN ($good_galleries)";
$stmt = $dbh->prepare($sql);
$stmt->execute(array(
    "OWNER_ID" => $owner_id,
));

$data = $stmt->fetchAll(PDO::FETCH_ASSOC); 
```

# c++ - 在 IDE 外运行时程序崩溃

> ID：907812
> 
> 赞同：2
> 
> 时间：2009-05-25T19:34:35.503
> 
> 标签：c++, memory, crash

我目前正在处理 Windows XP 中的一个 C++ 程序，该程序处理大量数据。我们最大的输入文件导致程序意外终止，没有任何错误消息。有趣的是，当程序从我们的 IDE (Code::Blocks) 运行时，处理文件时没有任何此类问题。

随着数据的处理，它被放置在一个树结构中。在我们完成计算之后，数据被移动到 C++ STL 向量中，然后被发送到 OpenGL 中进行渲染。

我希望能够深入了解可能导致这次崩溃的原因。我已经查看了另一个帖子，因为我是新用户，所以我无法发布链接。帖子中的问题与我的非常相似，是由于数组索引越界造成的。但是，我很确定不会发生这种越界错误。

我想知道，在为向量分配空间时，数据集的大小是否会导致问题。我一直在测试程序的系统理论上应该有足够的内存来处理数据（2GB RAM，数据集占用大约 1GB）。当然，如果内存够用，STL 向量在达到其容量时只需将其分配的空间加倍。

谢谢，埃里克

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-25T19:39:06.383

代码在 IDE 中工作（可能在调试器中运行？）但不是独立的事实表明这可能是一个初始化问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T19:48:32.027

警告级别设置为最大值的编译器。

然后检查所有警告。我猜它是一个未初始化的变量（在调试模式下被初始化为 NULL/0）。

就我个人而言，我已经设置了我的模板，以便警告始终处于最大值，并且警告被标记为错误，这样编译就会失败。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T19:55:12.903

您可能会发现配置 O/S 以创建故障转储很有帮助（也许，我不知道，仍然使用一些名为“Dr Watson”的 Windows 系统软件），然后您可以在之后附加一个调试器该程序已崩溃（假设它*正在*崩溃）。

您还应该捕获程序可能会在没有崩溃转储的情况下半优雅退出的各种方式：`atexit`，`set_unexpected`，`set_terminate`也许还有其他方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T19:38:49.597

你的记忆模型是什么样的？您是否违反了索引限制（即 sizeof int）？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T22:39:14.693

As it turns out, our hardware is reaching its limit. The program was hitting the system's memory limit and failing miserably. We couldn't even see the error statements being produced until I hooked cerr into a file from the command line (thanks starko). Thanks for all the helpful suggestions!

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T21:47:25.500

听起来您的程序正在引发您没有捕获的异常。[boost 测试框架](http://www.boost.org/doc/libs/1_35_0/libs/test/doc/components/utf/index.html)有一些异常处理程序，可以快速定位异常位置。

树结构中是否存在可能溢出的索引？您是否在向量中使用超出向量当前大小的索引？

```
new vector...    
vector.push_back()
vector.push_back()
vector[0] = xyz
vector[1] = abc
vector[2] = slsk // Uh,oh, outside vector 
```

你最大的输入集有多大？你最终分配了 size*size 元素吗？如果是这样，您的最大输入集是否大于 65536 个元素（65536*65536 == MAX_INT）？

我同意 IDE 在独立时无法正常工作的最可能原因是因为调试器正在将内存擦除为 0 或在分配的内存周围使用内存保护。

如果其他任何事情都失败了，是否可以减少数据集的大小，直到找到确切的工作大小，以及一个稍微大一点的失败示例——这可能会提供信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T01:07:41.073

我建议尝试确定您的代码的哪一行导致崩溃。

由于这只发生在您的 IDE 之外，您可以使用它`OutputDebugString`来输出当前位置，并使用 DebugView。

实际上，在 IDE 内部和外部为调试而编译的程序的行为可能完全不同。当从 IDE 加载程序时，它们可以使用一组不同的运行时库。

Recently I was bitten by a timing bug in my code, somehow when debugging from the IDE the timing was always good an the bug was not observed, but in release mode bam the bug was there. This kinda of bug are really a PITA to debug.

# sql - 存储过程解析正确但不会执行。对象名称无效。消息 208

> ID：907819
> 
> 赞同：4
> 
> 时间：2009-05-25T19:37:29.663
> 
> 标签：sql, database, stored-procedures

我编写了一个存储过程，如下所示。它会毫无错误地解析，但是当我尝试执行它时，它会失败。错误消息显示：Msg 208，Level 16，State 6，Procedure aspnet_updateUser，Line 23 Invalid object name 'dbo.aspnet_updateUser'。

这是存储过程。

```
 USE [PMRS2]
GO
/****** Object:  StoredProcedure [dbo].[aspnet_updateUser]    Script Date: 05/25/2009 15:29:47 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Author,,Name>
-- Create date: <Create Date,,>
-- Description: <Description,,>
-- =============================================
ALTER PROCEDURE [dbo].[aspnet_updateUser]
    -- Add the parameters for the stored procedure here
    @UserName nvarchar(50),
    @Email nvarchar(50),
    @FName nvarchar(50),
    @LName nvarchar(50),
    @ActiveFlag bit,
    @GroupId int

AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    -- Insert statements for procedure here

UPDATE dbo.aspnet_Users 
    SET UserName = @UserName, LoweredUserName = LOWER(@UserName), Email = @Email, FName = @FName, LName = @LName, ActiveFlag = @ActiveFlag, GroupId = @GroupId
    WHERE LoweredUserName = LOWER(@UserName)
END 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-25T19:43:13.037

看起来它可能还不存在，将 Alter 换成 Create。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:44:07.510

为了避免这种情况在未来发生，做我们该做的，永远不要使用alter proc。相反，我们检查 proc 是否存在，如果存在则删除它，然后使用新代码创建它：

```
IF EXISTS (SELECT * FROM sysobjects WHERE type = 'P' AND name = 'myProc')
BEGIN
    DROP  Procedure  myProc
END
GO

CREATE PROCEDURE myProc 
(add the rest of the proc here) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-03T20:40:35.503

这是另一个解决方案

```
USE [PMRS2]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

IF OBJECT_ID ( 'dbo.YourProcedureName', 'P' ) IS NOT NULL   
    DROP PROCEDURE dbo.YourProcedureName;  
GO

CREATE PROCEDURE [dbo].[YourProcedureName] (
    @UserName varchar(50),
    @Password varchar(50))
AS
BEGIN
SET NOCOUNT ON;

    select ... (your query)
END 
```

# php - 如何强制用户登录才能查看任何页面？

> ID：907825
> 
> 赞同：1
> 
> 时间：2009-05-25T19:38:59.770
> 
> 标签：php, zend-framework, authentication

我目前正在使用 Zend Framework，并且我已经使用 Zend_Auth 编写了身份验证代码。我正在尝试找到一种方法来确保用户在查看任何内容之前先登录，但我不想在每个控制器的基础上进行。

我正在考虑一个插件，但我所有的书在这方面都很垃圾。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T19:41:56.080

```
Zend_Auth::getInstance()->hasIdentity() 
```

您可以使用它来确定用户是否已登录，如果没有，则使用重定向器重定向到登录页面。

然而，更简单的方法是使用[Redirector Zend Controller Action Helper](http://www.refreshinglyblue.com/2008/10/28/zend-framework-redirect-the-easy-way/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T19:48:49.577

插件是个好主意。我在这里回答了一个类似的问题：

[如何将我的 init 函数中的代码集中在所有控制器中？](https://stackoverflow.com/questions/866367/how-do-i-centralize-code-from-my-init-functions-in-all-controllers/866517#866517)

另请查看文档页面[Zend Controller Plugins](http://framework.zend.com/manual/en/zend.controller.plugins.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T20:06:09.573

查看[Zend___Acl](http://framework.zend.com/manual/en/zend.acl.html)，它可用于定义用户是否有权访问某些资源。资源几乎可以是任何东西，但在这种情况下，您可以使用 ACL 将控制器和操作定义为资源。然后为每个登录用户分配多个角色（我们将它们存储在数据库中）。在路由完成后，在插件中检查控制器和操作的请求。通过 Zend_Auth 收集用户的角色并根据 ACL 检查它们。如果 ACL 说用户有权访问资源，则什么也不做，否则您可以转发/重定向到错误控制器并打印错误。

```
// Pseudo-code. You need to define the ACL and roles somehow.
class AclPlugin extends Zend_Controller_Plugin {
    public function routeShutdown(Zend_Controller_Request_Abstract $request)
    {

        $controller = $request->getControllerName();
        $action = $request->getActionName();
        $roles = Zend_Auth::getInstance()->getRoles();
        $acl = new MyAcl();
        if($acl->hasAccess($roles, $controller, $action)) { return; }
        // None of the user's roles gave her access to the requested 
        // controller/action, so re-write the request to the error controller
        $request->setControllerName('error')
                ->setActionName('authorizationFailed')
                ->setParam('resource', array('controller' => $controller
                                             'action' => $action));
    }
}
class MyAcl extends Zend_Acl {
    public function hasAccess($roles, $controller, $action) {
        foreach($roles as $role) {
            if($acl->isAllowed($role, $controller, $action)) {
                return true; // Simplified. Here we say if one of the user roles can
                             // access a resource, that is good enough. 
                             // Might want to do something a bit more complicated.
            }
        }
        return false;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T02:17:28.400

如何设置一个扩展 Zend_Controller_Action 的全局控制器，然后让您的控制器从全局控制器扩展。然后你的全局控制器将 Zend_Auth::getInstance()->hasIdentity() 放在 init() 或 preDispatch 中？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T19:44:03.207

我最近在思考同一个主题（ZF 新手），并考虑在引导程序中进行身份验证检查（可能带有“绕过”控制器/操作的列表）。

# .net - 如何监视 winforms TextBox.SelectionStart 属性的更改？

> ID：907828
> 
> 赞同：3
> 
> 时间：2009-05-25T19:39:35.150
> 
> 标签：.net, winforms, textbox

我有一个多行文本框，我想在文本框下方的标签中显示用户当前的行号和列号。看起来我可以使用 SelectionStart 属性、GetLineFromCharIndex 方法和 GetFirstCharIndexOfCurrentLine 方法获取行号和列号。但是，每次文本框中的选择更改时，我都看不到任何被触发的事件。

我能看到的最好的方法是监视 KeyPress 和 MouseDown 事件并在每个事件之后检查 SelectionStart 属性。我想我可以使用计时器来观察变化，但这感觉很奇怪。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T20:06:53.130

为了更健壮，您可能必须添加一个计时器，并定期检查它；[从这里开始](http://bytes.com/groups/net-c/239322-textbox-selectionchanged-equivalent)，控件不会发布合适的 win32 消息 (EN_SELCHANGE) 来作为事件执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-25T16:21:16.543

要获取 SelectionChanged 事件，您还可以将 TextBox 转换为 RichTextBox。RichTextBoxes 的行为与 TextBoxes 略有不同，因此这可能不是一个理想的解决方案，但至少有一个[SelectionChanged 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.selectionchanged.aspx)。

# c# - 如何防止窗户被移动？

> ID：907830
> 
> 赞同：39
> 
> 时间：2009-05-25T19:41:21.887
> 
> 标签：c#, .net, winforms, user-interface

我将如何阻止表格被移动。我将表单边框样式设置为 FixedSingle 并希望保持这种方式，因为它在 vista 中看起来不错:)

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-05-25T19:55:54.117

看看这个[链接](http://vaibhavgaikwad.wordpress.com/2006/06/05/creating-a-immovable-windows-form-in-c/)。您可能对选项 #3 感兴趣。它将要求您包装一些本机代码，但应该可以工作。链接底部还有一条评论，显示了一种更简单的方法。取自评论（不能归功于它，但我会为您节省一些搜索）：

```
protected override void WndProc(ref Message message)
{
    const int WM_SYSCOMMAND = 0x0112;
    const int SC_MOVE = 0xF010;

    switch(message.Msg)
    {
        case WM_SYSCOMMAND:
           int command = message.WParam.ToInt32() & 0xfff0;
           if (command == SC_MOVE)
              return;
           break;
    }

    base.WndProc(ref message);
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-05-25T09:29:24.073

您可以将`FormBorderStyle`Form 的属性设置为 None

```
this.FormBorderStyle=System.Windows.Forms.FormBorderStyle.None 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-05-02T06:47:10.520

我发现这可以阻止表单移动（它在 c# 中）

```
protected override void WndProc(ref Message m)
        {
            const int WM_SYSCOMMAND = 0x0112;
            const int SC_MOVE = 0xF010;

            switch (m.Msg)
            {
                case WM_SYSCOMMAND:
                    int command = m.WParam.ToInt32() & 0xfff0;
                    if (command == SC_MOVE)
                        return;
                    break;
            }
            base.WndProc(ref m);
        } 
```

[在这里找到](http://bytes.com/topic/c-sharp/answers/227739-disable-user-moving-application-window)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-25T09:38:19.173

尝试覆盖 WndProc：

```
protected override void WndProc(ref Message m)
{
   const int WM_NCLBUTTONDOWN = 161;
   const int WM_SYSCOMMAND = 274;
   const int HTCAPTION = 2;
   const int SC_MOVE = 61456;

   if ((m.Msg == WM_SYSCOMMAND) && (m.WParam.ToInt32() == SC_MOVE))
   {
       return;
   }

   if ((m.Msg == WM_NCLBUTTONDOWN) && (m.WParam.ToInt32() == HTCAPTION))
   {
       return;
   }

   base.WndProc(ref m);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-25T19:47:00.393

它并不漂亮（当您尝试移动表单时会出现一些闪烁），但您可以使用 LocationChanged 属性将表单保留在您想要的位置：

```
private Point _desiredLocation;
// assign the _desiredLocation variable with the form location at some
// point in the code where you know that the form is in the "correct" position

private void Form_LocationChanged(object sender, EventArgs e)
{
    if (this.Location != _desiredLocation)
    {
        this.Location = _desiredLocation;
    }
} 
```

出于好奇；你为什么想做这个？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-25T19:47:34.557

在 Windows 中，WS_CAPTION 样式是允许用鼠标移动窗口的非客户区。所以做你想做的最简单的方法是从你的窗口中删除这个样式。

然而，如果你需要一个标题并且仍然实现你想要的，那么下一个样式将是捕获 WM_NCHITTEST 消息并检查 HTCAPTION。如果代码是 HTCAPTION，则返回 NTNOWHERE。这将阻止默认窗口过程执行默认的移动窗口事物。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-25T09:32:02.667

使您的表单不可移动不是一个好习惯。如果我是你，我会考虑的。
无论如何，您可以通过覆盖 WinProc 来禁用系统菜单中的 [Move] 菜单项来做到这一点。

```
[DllImport("user32.dll")]
private static extern Int32 EnableMenuItem ( System.IntPtr hMenu , Int32uIDEnableItem, Int32 uEnable);  
private const Int32 HTCAPTION = 0×00000002;  
private const Int32 MF_BYCOMMAND =0×00000000;  
private const Int32 MF_ENABLED =0×00000000;  
private const Int32 MF_GRAYED =0×00000001;  
private const Int32 MF_DISABLED =0×00000002; 
private const Int32 SC_MOVE = 0xF010; 
private const Int32 WM_NCLBUTTONDOWN = 0xA1;
private const Int32 WM_SYSCOMMAND = 0×112;
private const Int32 WM_INITMENUPOPUP = 0×117;

protected override void WndProc(ref System.Windows.Forms.Message m )
{
if (m.Msg == WM_INITMENUPOPUP)
{
    //handles popup of system menu
    if ((m.LParam.ToInt32() / 65536) != 0) // 'divide by 65536 to get hiword
    {
        Int32 AbleFlags = MF_ENABLED;
        if (!Moveable)
        {
            AbleFlags = MF_DISABLED | MF_GRAYED; // disable the move
        }
        EnableMenuItem(m.WParam, SC_MOVE, MF_BYCOMMAND | AbleFlags);
    }
}
if (!Moveable)
{
    if (m.Msg == WM_NCLBUTTONDOWN) //cancels the drag this is IMP
    {
        if (m.WParam.ToInt32() == HTCAPTION) return;
    }
    if (m.Msg == WM_SYSCOMMAND) // Cancels any clicks on move menu
    {
        if ((m.WParam.ToInt32() & 0xFFF0) == SC_MOVE) return;
    }
}
base.WndProc(ref m);
} 
```

此外，您可以处理`OnMove`表单的事件。但我认为这会导致一些闪烁：

```
private void Form1_Move(object sender, EventArgs e)
{
    this.Location = defaultLocation;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-08-03T08:49:36.703

1.  转到表单事件-> 位置已更改

编写以下代码

```
Location = new Point(this.Width,this.Height); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-05T18:28:23.657

只需将`FormBorderStyle`属性更改为`None`.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-11T19:32:13.793

将 Form 属性 StartPostion 更改为 Manual。然后，处理 LocationChanged 事件：

```
private void frmMain_LocationChanged(object sender, EventArgs e)
{
Location = new Point(0, 0);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-25T19:50:10.480

我会质疑您是否需要使表格不可移动。这听起来不太好。您当然可以在窗口关闭时保存窗口的位置，然后将窗口重新打开到该位置。这使用户可以控制窗口的位置。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-12-02T21:21:04.047

你可以试试：

```
this.Locked = true; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-05-02T06:33:58.373

您可以订阅该[`Form.Move`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.move.aspx)事件并从中重新定位。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-11-02T21:50:59.300

只需将 formlocation_changed 事件上的位置重置为原来的位置，即在移动之前将 Form.Location 设置为变量，当用户尝试移动它时，它将返回到您设置的变量位置。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-11-30T06:09:46.043

Private Sub MyFormLock() Me.Location = New Point(0, 0) End Sub

```
Private Sub SearchSDR_LocationChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.LocationChanged
    Call MyFormLock()
End Sub 
```

# objective-c - Objective-C 中消息发送的成本

> ID：907843
> 
> 赞同：5
> 
> 时间：2009-05-25T19:47:27.647
> 
> 标签：objective-c, iphone

我很想知道在各种情况下在 Objective-C 中发送消息的成本。特别是我想指导我对程序设计的选择，因此我不会试图通过避免消息发送来过早优化，因为它们会带来更好的设计。

我当前项目中的一个案例是我有一个带有实例变量的类：offsetX 和 offsetY。我经常想要绝对偏移量，目前我到处都有这行代码：-

```
int absOffset = ((offsetX < 0.0) ? -offsetX : offsetX) + 
                 ((offsetY < 0.0) ? -offsetY : offsetY); 
```

现在，如果这是 C++，我将创建一个返回 absOffset 值的内联函数。即使在 Java/C# 中，我也可以将这样的函数定义为 final/sealed，并且很确定它会被内联。

目标-C 将是：-

```
-(int)absOffset {
    return ((offsetX < 0.0) ? -offsetX : offsetX) + 
            ((offsetY < 0.0) ? -offsetY : offsetY);
} 
```

我会这样称呼它：-

```
int ao = [self absOffset]; 
```

现在，编译器可以内联吗？我假设它至少能够将其修复为直接函数调用，并避免（我假设）objective-c 因为它的类型系统而必须使用的动态消息分发。

另外，一般来说，Objective-C 中的消息发送成本是多少？通过“id”与指向具体类的指针调用时是否有所不同？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-25T20:01:18.367

[Objective C 消息非常快。](http://www.mikeash.com/?page=pyblog/performance-comparisons-of-common-operations-leopard-edition.html)速度与 C++ 虚拟方法调用相当，虽然没有那么快。避免消息传递*绝对*是过早的优化。你可能不想在内部循环中做很多事情，但是你选择的算法和其他因素将对你的代码有多快有更大的影响。如果速度太慢，请使用分析器并从那里开始。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-25T20:08:42.750

首先，我会为此使用 C 函数 fabs()。对于其他事情，为小帮助案例编写简单的内联 C 函数可以很好地工作。为了方便而不是谨慎的行为而使用方法可能是糟糕设计的标志。性能甚至还没有进入它。

接下来，编译器无法优化方法调用。它是一种动态语言，调用直到运行时才被解析。各种 Objective-C 技术可能会挫败编译器这样做的任何尝试。

在运行时调用“id”和类型指针上的方法之间没有区别——它们通过完全相同的机制。

最后，如果您在测量之前考虑性能特征，那么您已经过早地进行了优化。这并不是说这*永远*不合适，就像有些人可能会让你相信的那样，但它通常确实成立。在这种情况下，我认为，如果您将设计放在首位，无论如何您最终可能会获得足够体面的性能配置文件。如有必要，稍后进行测量和优化。

# iphone - “更改标签栏的代表”异常

> ID：907857
> 
> 赞同：6
> 
> 时间：2009-05-25T19:51:39.133
> 
> 标签：iphone, cocoa-touch

我有一个在 iPhone os 2.2.1 上完美运行的应用程序，但是当我尝试在 iPhone os 3.0 上运行它时，它崩溃了。

这是我从控制台得到的错误：

```
Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Changing the delegate of a tab bar managed by a tab bar controller is not allowed.' 
```

可能是因为我正在以编程方式更改某个视图控制器的视图。

这是代码：

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear: animated];

    self.view = current_controller.view;
    [current_controller viewWillAppear: NO];
    [current_controller viewDidAppear: NO];
} 
```

这部分代码可能会发生错误，如果是，我该如何解决？为什么还会发生？

提前谢谢你，伊利亚。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-19T11:14:01.840

在大多数情况下，您可以改用 UITabBarControllerDelegate。它具有与 UITabBarDelegate 类似的方法，并避免了此类异常。例如，而不是：

```
 - (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item {

    int index = [tabBar determinePositionInTabBar:item]; // custom method
    [tabBar doSomethingWithTabBar];
    [item doSomethingWithItem];
    [item doSomethingWithItemAndIndex:index];
} 
```

你可以写：

```
 - (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController {

    UITabBarItem *item = [tabBarController.tabBar selectedItem];
    int index = [tabBarController.tabBar determinePositionInTabBar:item]; // custom method
    [tabBarController.tabBar doSomethingWithTabBar];
    [item doSomethingWithItem];
    [item doSomethingWithItemAndIndex:index];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-22T02:34:22.300

上面的 Ernst 先生给人的印象是，他在 Ilya 的代码中看到了构成“从控制器下拉出视图”的内容。这会让你长时间盯着代码看，而这并不是真正的问题所在。[我在 Apple 开发者论坛http://discussions.apple.com/message.jspa?messageID=10259835#10259835](http://discussions.apple.com/message.jspa?messageID=10259835#10259835)上发布了这个问题有人告诉我“NSInternalInconsistencyException”是 .xib 文件的问题（在 Interface Builder 中）。使用此信息，我找到了以下解决方案。我认为我在这里给出的一些名字是通用的，并且会帮助其他试图解决这个问题的人。要查看该问题，xib 参考在 2.x 上编译和运行完美，在 3.x 上编译并在您尝试在 3.0 模拟器中运行应用程序时给出上述错误消息。我在标签栏中有一个代表。在 Interface Builder 中查看引用出口时，我将“多个”、“文件所有者”、“标签栏”和“标签栏控制器”作为引用出口。当我从引用插座中删除“标签栏”时，我的应用程序在 Simulator 3.0 中运行。它还在 2.x 上编译和运行，所以“标签栏” 2.x 不需要参考。...闪光戈登

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T19:16:40.170

很简单，你不能那样做。从 UIViewController 下拉出视图是导致崩溃的可靠方法。

查看 Apple 提供的标签栏教程，了解它是如何正确完成的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-16T18:38:00.757

我认为这是 Adam Ernst 所指的教程之一：

[http://developer.apple.com/IPhone/library/featuredarticles/ViewControllerPGforiPhoneOS/UsingToolbarControllers/UsingToolbarControllers.html#//apple_ref/doc/uid/TP40007457-CH6-SW1](http://developer.apple.com/IPhone/library/featuredarticles/ViewControllerPGforiPhoneOS/UsingToolbarControllers/UsingToolbarControllers.html#//apple_ref/doc/uid/TP40007457-CH6-SW1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-16T18:48:40.250

这是一个不平凡的问题。一定有人发布了一个从 ViewController 下删除视图的示例，因为很多人都这样做了。尽管人们都在谈论它有多“糟糕”，但它在 2.x 中仍然有效。即使是苹果文章也没有涉及架构问题。大多数人会编写一个 .h/.m 组合来处理每个子控制器视图。苹果的例子似乎只在控制 tabbarcontroller 的 .m 文件中运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-08T15:44:58.137

我为我找到了以下解决方案：

1.  子类 UITabBarController
2.  在 Interface Builder 中，将 UITabBar 的“自定义类 > 类”属性设置为新类
3.  将以下代码添加到您的课程中

    ```
    -(void)tabBar:(UITabBar *)tabBar willBeginCustomizingItems:(NSArray *)items{
        id modalViewCtrl = [[[self view] subviews] objectAtIndex:1];  
        if([modalViewCtrl isKindOfClass:NSClassFromString(@"UITabBarCustomizeView")] == YES)
            ((UINavigationBar*)[[modalViewCtrl subviews] objectAtIndex:0]).tintColor = [UIColor blackColor];
    } 
    ```

希望这可以帮助...

# python - 如何让 Django 的通用视图使用具有初始值的表单？

> ID：907858
> 
> 赞同：2
> 
> 时间：2009-05-25T19:51:55.420
> 
> 标签：python, django, forms

我知道如何从视图中为表单设置初始值。但是如何让通用视图为表单设置初始值呢？我可以为通用视图编写一个包装视图，但我仍然无法访问表单对象实例化。

我试图实现的具体目标是让用户使用 create_object 通用视图创建一个新对象。但是，我想将对象“用户”的一个字段设置为当前登录的用户，该用户只能作为 request.user 访问。如何初始化表单以具有此字段？

编辑：我遇到了__new__。这可以用一些默认参数调用它自己的构造函数吗？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-25T20:59:36.657

不幸的是，您无法通过 Django 的`create_object`通用视图来实现此行为；你必须自己写。然而，这相当简单。

首先，您必须创建一个新的表单类，如下所示：

```
from django import forms
class MyForm(forms.ModelForm):
    class Meta:
        model = MyModel  # model has a user field 
```

然后你就可以创建一个像这样的视图：

```
from django.shortcuts import render_to_response
from django.template import RequestContext
from django.http import HttpResponseRedirect
from django.contrib.auth.decorators import login_required

@login_required
def create_mymodel(request):
    if request.method == 'POST':
        # Get data from form
        form = MyForm(request.POST)
        # If the form is valid, create a new object and redirect to it.
        if form.is_valid():
            newObject = form.save()
            return HttpResponseRedirect(newObject.get_absolute_url())
    else:
        # Fill in the field with the current user by default
        form = MyForm(initial={'user': request.user})
    # Render our template
    return render_to_response('path/to/template.html',
        {'form': form},
        context_instance=RequestContext(request)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T18:42:41.347

您可以通过动态构造表单类并将其传递给通用视图来在通用视图包装器中执行此操作，但这种治疗方法可能比疾病更糟糕。只需写下你自己的观点，然后热切地等待[它](http://code.djangoproject.com/ticket/6735)落地。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-20T17:07:26.393

如果您想要通用视图的所有功能，那么您可以使用原始视图作为模板创建一个新的通用视图。

例如：

```
def create_object_with_initial(request, model=None, template_name=None,
    template_loader=loader, extra_context=None, post_save_redirect=None,
    login_required=False, context_processors=None, form_class=None, initial=None):

if extra_context is None: extra_context = {}
if login_required and not request.user.is_authenticated():
    return redirect_to_login(request.path)

model, form_class = get_model_and_form_class(model, form_class)
if request.method == 'POST':
    form = form_class(request.POST, request.FILES)
    if form.is_valid():
        new_object = form.save()

        msg = ugettext("The %(verbose_name)s was created successfully.") %\
                                {"verbose_name": model._meta.verbose_name}
        messages.success(request, msg, fail_silently=True)
        return redirect(post_save_redirect, new_object)
else:
    print "creating", form_class, " with initial data ", initial
    form = form_class(initial=initial)

# Create the template, context, response
if not template_name:
    template_name = "%s/%s_form.html" % (model._meta.app_label, model._meta.object_name.lower())
t = template_loader.get_template(template_name)
c = RequestContext(request, {
    'form': form,
}, context_processors)
apply_extra_context(extra_context, c)
return HttpResponse(t.render(c)) 
```

这是从 /site-packages/django/views/generic/create_update.py 复制的，只有第 3 行和第 21 行更改以合并初始数据。

然后按照您的预期使用它：

```
object_info = {
'model': YourModel,
'initial': {'data' : 'Initial Value'},
'template_name': 'template.html'
}

url(r'^path/$',
    login_required(create_object_with_initial),
    object_info,
    name='url_name'), 
```

那应该行得通。

# jquery - jQuery - 可排序的 div

> ID：907861
> 
> 赞同：0
> 
> 时间：2009-05-25T19:53:26.433
> 
> 标签：jquery, dynamic, html, jquery-ui-sortable

是否可以对 div 图层进行排序？示例仅显示正在排序的列表项。

我目前使用一个函数来控制动态创建的 div（基于 MySQL 结果）。这一功能将可移动层保持在一个 div 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T20:06:08.513

jQuery UI [Sortable](http://jqueryui.com/demos/sortable/)插件应该做你想做的。该示例使用 div，但它应该适用于任何类型的 DOM 元素。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-25T20:05:50.917

没关系，我找到了 portlet 演示，一切正常。

# domain-driven-design - 如何对对象间关系的子集进行建模

> ID：907863
> 
> 赞同：0
> 
> 时间：2009-05-25T19:54:37.507
> 
> 标签：domain-driven-design

我是使用域模型的新手，所以请原谅我问了一个基本问题。

如果域对象与另一个域对象具有一对多关系，但使用第一个对象的逻辑仅适用于该对象相关对象的子集，那么公开该子集的最佳方法是什么？

例如，假设一个 Person 与许多 Orders 相关，但一些外部逻辑只需要检查与 Person 关联的“Dispatched” Orders。Person 是否应该具有 DispatchedOrders 属性以及其他子集的其他属性（例如 CompletedOrders 等），还是这种设计不好？假设出于性能原因，我无法过滤内存中的对象，并且必须使用 SQL 仅拉回我感兴趣的子集。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T20:00:22.627

如果您使用 SQL 来查找您感兴趣的集合，那么您就处于一个完美的世界中。关系查询都是关于找到那种东西。找到完美的查询，然后只需弄清楚结果元组的类是什么，即每个结果元组的对象，并对其进行适当的处​​理。

在您的示例中，您需要一组“已调度订单”，每个订单都附有任何必要的人员信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T20:10:07.147

我认为您的想法是正确的- DispatchedOrders 会准确地告诉我您要返回给我的对象集合。正如 Curt 所说，您处于很好的位置，因为您可以使用 SQL / 存储过程来获取您的数据。

一个警告 - 确保域与业务流程相匹配，而不是您对该流程的理解的插值。那就是-为什么一个人优先于命令以及在构建其他对象时将其绘制到哪个角落。订单项是否也包含订单，这会导致对象膨胀吗？与客户的讨论应该有助于形成答案。

SubSonic 声名鹊起的 Rob Conery 对[这些类型的问题进行了很好的讨论](http://www.altnetpodcast.com/episodes/15-domain-driven-design)。值得一听。

# c - 用于 WIFSIGNALED、WIFSTOPPED、WIFCONTINUED 的 C 语言测试用例

> ID：907867
> 
> 赞同：5
> 
> 时间：2009-05-25T19:55:53.807
> 
> 标签：c, signals, waitpid

我正在使用 waitpid() 和 signal() 并且我正在寻找可靠的测试用例来返回 WIFSIGNALED(status) = WIFSTOPPED(status) = WIFCONTINUED (status) = true 但找不到任何...

请告诉我如何确保那些返回 true 以便我可以调试我的代码？

此外，关于我应该使用 signal() 捕获哪些信号来测试这些宏的一些提示会很有帮助......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T00:26:14.540

```
#include <errno.h>
#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/wait.h>
#include <unistd.h>

#define NELEMS(x) (sizeof (x) / sizeof (x)[0])

static void testsignaled(void) {
   kill(getpid(), SIGINT);
}

static void teststopped(void) {
   kill(getpid(), SIGSTOP);
}

static void testcontinued(void) {
   kill(getpid(), SIGSTOP);
   /* Busy-work to keep us from exiting before the parent waits.
    * This is a race.
    */
   alarm(1);
   while(1) {}
}

int main(void) {
   void (*test[])(void) = {testsignaled, teststopped, testcontinued};
   pid_t pid[NELEMS(test)];
   int i, status;
   for(i = 0; i < sizeof test / sizeof test[0]; ++i) {
      pid[i] = fork();
      if(0 == pid[i]) {
         test[i]();
         return 0;
      }
   }
   /* Pause to let the child processes to do their thing.
    * This is a race.
    */
   sleep(1);
   /* Observe the stoppage of the third process and continue it. */
   wait4(pid[2], &status, WUNTRACED, 0);
   kill(pid[2], SIGCONT);
   /* Wait for the child processes. */
   for(i = 0; i < NELEMS(test); ++i) {
      wait4(pid[i], &status, WCONTINUED | WUNTRACED, 0);
      printf("%d%s%s%s\n", i, WIFCONTINUED(status) ? " CONTINUED" : "", WIFSIGNALED(status) ? " SIGNALED" : "", WIFSTOPPED(status) ? " STOPPED" : "");
   }
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T23:57:40.463

处理 WIFSIGNALED 很容易。`kill()`子进程可以通过系统调用自杀。您还可以检查核心转储——一些信号会创建它们（SIGQUIT、IIRC）；有些信号没有（SIGINT）。

处理 WIFSTOPPED 可能更难。尝试的简单步骤是让孩子`kill()`再次通过系统调用向自己发送 SIGSTOP。实际上，我认为这应该有效。请注意，您可能需要检查 SIGTTIN 和 SIGTTOU 和 SIGTSTOP - 我相信他们算作 WIFSTOPPED。（也有可能 SIGSTOP 只有在由调试器发送到它通过非 POSIX 系统调用运行的进程时才能正常工作，`ptrace()`.）

处理 WIFCONTINUED 是我认为父母必须做的事情；在检测到进程已停止后，您的调用代码应通过向其发送 SIGCONT 信号（`kill()`再次）使其继续。孩子自己无法实现这一点；它已停止。同样，我不确定是否有额外的皱纹需要担心——可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T21:31:16.843

类似下面的框架将允许您检查`wait()`and`waitpid()`调用的结果。

```
pid_t pid = fork();

if (pid == 0) {
    /* child */
    sleep(200);
}
else {
    /* parent */
    kill(pid, SIGSTOP);

    /* do wait(), waitpid() stuff */
} 
```

您实际上不必捕获发送的信号（使用`signal()`或相关功能）。`signal()`安装一个覆盖特定信号默认行为的处理程序 - 因此，如果您想检查终止进程的信号，请选择具有该默认行为的信号 - “ `man -s7 signal`”将为您提供信号的默认行为的详细信息。

对于您提到的使用`SIGSTOP`for `WIFSTOPPED(status)`，`SIGCONT`for`WIFCONTINUED (status)`和`SIGINT`for的宏`WIFSIGNALED(status)`

如果您想要更灵活的测试，您可以使用 kill（请参阅“ `man kill`”）向您的进程发送信号。`kill -l`将列出所有可以发送的信号。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-25T20:30:06.640

在您的测试中，您可以 fork() 并向您的子进程发送特定信号？在这种情况下，您的子进程是测试用例吗？

**编辑**

我的回答是关于编写 C 测试。你分叉，获取你的子进程（安装了信号处理程序的进程）的 pid，然后你可以使用`kill(2)`. 这样就可以测试退出状态

# user-controls - 在 Web 表单页面中使用命名空间有什么好处？

> ID：907872
> 
> 赞同：0
> 
> 时间：2009-05-25T19:58:05.020
> 
> 标签：user-controls, webforms, namespaces

我了解在实际应用程序层中使用命名空间的优点，但是当涉及到前端时，我不太确定。

我的项目是一个网站（不是 WebApplication），当我尝试包含“命名空间”用户控件时，我遇到了各种问题（缺少参考）。尽管在 system.web - pages - controls - add 下的 web.config 中有明确的声明。

当涉及到实际视图时，webforms：当您创建一个新页面时，Visual Studio 从您选择创建文件的路径创建代码隐藏类名。所以大多数时候，我会说类名是唯一的。如果您四处移动页面，那么在另一个子文件夹下看到说 Start_DefaultPage 会变得很奇怪。

**总结一下：**是否建议将命名空间放入***Web 层***？优缺点都有什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T20:55:14.637

是的。将来，您可能决定包含（巧合地）使用相同类名的外部库，并且您不希望发生命名空间冲突，因为您很清楚可能会发生这种情况。此外，您可能在虚拟目录中拥有 Web 应用程序，该目录将继承父 web.config 中列出的属性。你也不想在那里搞乱命名空间冲突。一般来说，这只是一个很好的编程习惯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T00:34:35.880

您的问题是您正在使用网站“项目”。停止这样做，您将不再遇到这些问题。

网站是微软犯的一个错误。你没有必要把他们的错误变成你的错误。

# c# - WPF 基础：MVVM 的共享全局样式

> ID：907874
> 
> 赞同：8
> 
> 时间：2009-05-25T19:58:39.993
> 
> 标签：c#, wpf, xaml, mvvm

我正在尝试对我的 WPF 开发使用类似于 MVVM 的方法。

我在 ViewModel 命名空间下有我的逻辑视图模型类，并且我在 View 命名空间下有这些视图模型类的匹配样式。

现在我在 ResourceDictionary XAML 文件中有我的视图信息，作为 DataTemplates 和 Styles，它们都合并到 app.xaml 中的单个 App.Resources ResourceDictionary 中。

但是，我遇到了一种鸡/蛋问题。我希望有我在所有地方都使用的全局样式。例如，我想要我自己的名为 MonkeyText 的自定义文本样式，它可以在各处用于各种样式。我不能只在 app.xaml 文件中设置它，因为想要使用 MonkeyText 的资源字典包含在 app.xaml 文件中。

我想如果这是不可能的替代方法是使用 UserControls 而不是主要使用 DataTemplates 来建立我的视图？我担心使用 UserControls 会将 VM 和 V 部分紧密地联系在一起。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T01:36:55.147

正是出于这个原因，WPF 提供了 DynamicResources。StaticResources - 最类似于编程中的“传统”引用 - 正是您遇到的问题；需要在解析样式之前定义和加载它们。另一方面，DynamicResources 不需要在使用它们之前定义 - 实际上，您甚至可以动态创建它们。WPF 负责确保 DynamicResources 在实际加载后被引用它们的所有样式自动加载。

使用 DynamicResources 很简单。当您创建 MonkeyText 样式时，像往常一样创建它：

```
<Style TargetType="TextBlock" x:Key="MonkeyText">
    <Setter Property="TextAlignment" Value="Center"/>
    <!-- etc. -->
</Style> 
```

然后使用 DynamicResource 从其他地方引用它：

```
<TextBlock Text="Hello, World!" Style="{DynamicResource MonkeyText}"/> 
```

如果出于任何原因，WPF 无法解析您的 DynamicResource，它将*静默*失败而不会引发任何异常（当无法解析时，StaticResources 会引发异常）。但是，当发生这种情况时，它会打印一条调试消息 - 因此请留意 Visual Studio 中的“输出”窗口。

由于 DynamicResources 可以处理以任何顺序在任何点加载的资源，因此您可以按照自己喜欢的方式构建资源字典 - 因此将它们与您的其他 View 样式一起放入并通过 app.xaml 中的单个 App.Resources ResourceDictionary 合并它们会正常工作。

可以在 WPF 的 MSDN 文档中找到有关 DynamicResources 的更多详细信息。

# c# - 使用反射将属性动态转换为实际类型

> ID：907882
> 
> 赞同：29
> 
> 时间：2009-05-25T20:01:50.050
> 
> 标签：c#, entity-framework, reflection

我需要动态地将属性转换为其实际类型。我如何/我可以使用反射来做到这一点？

解释一下我正在研究的真实场景。我正在尝试在实体框架属性上调用“First”扩展方法。要在框架上下文对象上调用的特定属性作为字符串传递给方法（以及要检索的记录的 id）。所以我需要对象的实际类型才能调用 First 方法。

我不能在对象上使用“Where”方法，因为 lambda 或委托方法仍然需要对象的实际类型才能访问属性。

此外，由于该对象是由实体框架生成的，因此我无法将类型转换为接口并对其进行操作。

这是场景代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Reflection;

namespace NmSpc
{

    public class ClassA
    {
        public int IntProperty { get; set; }
    }

    public class ClassB
    {
        public ClassA MyProperty { get; set; }
    }

    public class ClassC
    {
        static void Main(string[] args)
        {
            ClassB tester = new ClassB();

            PropertyInfo propInfo = typeof(ClassB).GetProperty("MyProperty");
            //get a type unsafe reference to ClassB`s property
            Object property = propInfo.GetValue(tester, null);

            //get the type safe reference to the property
            ClassA typeSafeProperty = property as ClassA;

            //I need to cast the property to its actual type dynamically. How do I/Can I do this using reflection?
            //I will not know that "property" is of ClassA apart from at runtime
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-26T08:53:43.953

```
public object CastPropertyValue(PropertyInfo property, string value) { 
if (property == null || String.IsNullOrEmpty(value))
    return null;
if (property.PropertyType.IsEnum)
{
    Type enumType = property.PropertyType;
    if (Enum.IsDefined(enumType, value))
        return Enum.Parse(enumType, value);
}
if (property.PropertyType == typeof(bool))
    return value == "1" || value == "true" || value == "on" || value == "checked";
else if (property.PropertyType == typeof(Uri))
    return new Uri(Convert.ToString(value));
else
    return Convert.ChangeType(value, property.PropertyType);  } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-12-14T15:48:16.647

我有一些时间，所以我尝试使用 VS2010 解决我的问题，我认为我以前是对的，虽然动态键工作会“解决”我的问题。请参阅下面的代码。

```
using System.Reflection;

namespace TempTest
{
    public class ClassA
    {
        public int IntProperty { get; set; }
    }

    public class ClassB
    {
        public ClassB()
        {
            MyProperty = new ClassA { IntProperty = 4 };
        }
        public ClassA MyProperty { get; set; }
    }

    public class Program
    {
        static void Main(string[] args)
        {
            ClassB tester = new ClassB();

            PropertyInfo propInfo = typeof(ClassB).GetProperty("MyProperty");
            //get a type unsafe reference to ClassB`s property
            dynamic property = propInfo.GetValue(tester, null);

            //casted the property to its actual type dynamically
            int result = property.IntProperty; 
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-03-07T19:07:41.187

获得反射类型后，您可以使用`Convert.ChangeType()`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T20:14:06.797

拥有特定类型的变量实际上只在编译时有用，并且不会在运行时帮助您以这种方式使用它。尝试编写您将使用它的代码...您会发现它不断推动要求知道类型以在某个级别编译时间（可能在调用链的更远处，但您最终仍需要键入有用的具体类型）。

不过要记住一件事 - 如果您的类型是引用类型，那么该对象仍然是您创建的真正类型。将对象保存为您的类型与对象并没有什么好处。这就是反射的美妙之处（也是它起作用的部分原因）。确实没有理由尝试在运行时在强制转换中“更改”它的类型，因为它仍然是一个对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T14:21:04.680

虽然我应该发布现实世界问题的解决方案。

```
string objectType = "MyProperty";

using (MyEntitiesContext entitiesContext = new MyEntitiesContext())
{
try
{
    string queryString = @"SELECT VALUE " + objectType+  " FROM MyEntitiesContext." + objectType + " AS " + objectType + " WHERE " + objectType + ".id = @id";

    IQueryable<Object> query = entitiesContext.CreateQuery<Object>(queryString, new ObjectParameter("id", objectId));

    foreach (Object result in query)
    {
        return result;
    }
}
catch (EntitySqlException ex)
{
    Console.WriteLine(ex.ToString());
}
}

return null; 
```

我认为新的 CLR4 动态键可能是“不错”的解决方案。

感谢所有的回应。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-15T17:11:05.893

如何将根值设置为字符串，然后将其作为字符串携带，直到需要将其转换为目标类型？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-01T13:05:24.753

```
Type resultType = typeof(T);
IEnumerable<PropertyDescriptor> properties = TypeDescriptor.GetProperties(resultType).Cast<PropertyDescriptor>();

object instance = Activator.CreateInstance(resultType);

var objValue = "VALUE FOR HEADER";
var resultHeader = "HeaderName";
var prop = properties.Single(p => string.Equals(p.Name, resultHeader, StringComparison.InvariantCultureIgnoreCase));

var targetType = Nullable.GetUnderlyingType(prop.PropertyType) !=null Nullable.GetUnderlyingType(prop.PropertyType):prop.PropertyType;

objValue  = Convert.ChangeType(objValue , targetType);
prop.SetValue(instance, objValue ); 
```

//返回实例；

# php - 如何确保对 CakePHP 控制器/动作的 jQuery 自动完成调用中的路径正确解析？

> ID：907883
> 
> 赞同：0
> 
> 时间：2009-05-25T20:02:06.213
> 
> 标签：php, jquery, linux, cakephp

我在 /var/www/site 中有 CakePHP 堆栈

从控制器 AI 下的一个视图执行 jquery ajax 调用：

```
$("#searchstring").autocomplete("/items/getitemsforautocomplete", {  ... more code 
```

当调用被触发时，我可以从 firebug 中看到 cakephp 想要调用：

```
http://localhost/items/getitemsforautocomplete?q=me 
```

请注意，缺少“站点”，导致 404。

当我将其上传到我的网站时，它会以应有的方式工作。我应该如何正确配置它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T20:06:56.937

'/' 不是转到站点的根目录吗？如果您的 javascript 文件位于 /var/www/site/script 中，您可能需要执行以下操作：

```
$("#searchstring").autocomplete("../items/getitemsforautocomplete", {  ... more code } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T20:07:20.273

尝试在您的 JS 中使用 FULL_BASE_URL，例如：

```
$("#searchstring").autocomplete("<?= FULL_BASE_URL ?>/items/getitemsforautocomplete", { 
```

不是最优雅的方式，但它解决了我过去的一些头痛问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T20:09:20.767

这很可能是由于 jquery 的调用级别所致。[http://localhost/items/](http://localhost/items/) ...是正确的 URL 吗？

一个非常好的未使用的html标签是设置基本href。然后所有链接和 javascript 调用都是从这里进行的。

```
<base href="http://localhost/site/">

```

然后只需从脚本中删除前导 '/'

```
$("#searchstring").autocomplete("items/getitemsforautocomplete", { ... 更多代码

```

# iphone - 使用字符串的值来确定类的实例

> ID：907885
> 
> 赞同：3
> 
> 时间：2009-05-25T20:03:55.180
> 
> 标签：iphone, objective-c, xcode

我有一个类似于这个的 switch 语句：

```
 switch (number)
    {
        case 1:
            if (imageView1.hidden == NO)
            {
                imageView1.hidden = YES;                    

            } else 
            {
                imageView1.hidden = NO;
            }

            break;
        case 2:
            if (imageView2.hidden == NO)
            {
                imageView2.hidden = YES;

            } else 
            {
                imageView2.hidden = NO;
                            }

            break; 
```

等等等等。

我的问题是如何使用一个值为“imageView1”的字符串并使用它来访问我的 imageView 类的实例，而不是为每个 imageView 实例使用不同的大小写？我知道它类似于从字符串或类似的东西创建一个 NSPath，但我只是不确定在哪里看或它会被称为什么。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T21:38:46.797

如果这实际上是代码，我不同意那些关心设计的人。但是，我会假设您只是发布问题的一般化版本。而且由于这是Objective-C中的一个重要概念，所以我们应该讨论它。

您可以使用键值编码和例程按名称访问对象的属性`-valueWithKey:`。

```
NSString *nameOfView = @"imageView1";
[[self valueForKey:nameOfView] setHidden:YES]; 
```

这将按顺序查找一个名为 的方法`-imageView1`，一个名为 的 ivar `imageView1`，最后是一个名为 的 ivar `_imageView1`。这种技术在 Cocoa 中被大量使用，理解起来很重要。这是我们仔细命名事物的众多原因之一，也是我们制作访问器来为我们处理内存管理的另一个原因。在文档中搜索“键值合规性”以获取更多信息。

现在对于这种特定情况，我倾向于使用更像 JimG 的解决方案，使用 NSArray 视图，因此我可以遍历它们并根据它们的索引打开或关闭我想要的那些。但是我可以想象很多不合适的情况，而 KVC 可能是。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T20:29:49.713

为什么不将实例放在 NSArray 中并对其进行索引？

```
NSArray *views = [NSArray arrayWithObjects: imageView1, imageView2, nil];
NSImageView *iview = [views objectAtIndex: number]; 
```

此外，您可以考虑以下内容：

```
iview.hidden = ! iview.hidden; 
```

[编辑：缺少星号，哎呀]

# authentication - 可扩展的基于角色的身份验证

> ID：907887
> 
> 赞同：0
> 
> 时间：2009-05-25T20:04:39.250
> 
> 标签：authentication, scalable, role-based

我目前正在为许多用户对其具有不同访问权限的资源设计一个基于角色的身份验证系统。

一个角色可以是单个用户，也可以是一组角色（因此一个角色是一个角色树）。（见下图）

![另一张图在这里](https://yuml.me/diagram/scale:65/class/%5BAdministration%5D-%3E%5BSite1Admins%5D,%20%5BAdministration%5D-%3E%5BSite2Admins%5D,%20%5BSite1Admins%5D-%3E%5BSally%5D,%20%5BSite1Admins%5D-%3E%5BJoe%5D,%20%5BSite2Admins%5D-%3E%5BMike%5D,%20%5BSite2Admins%5D-%3E%5BMax%5D,%20%5BSite2Admins%5D-%3E%5BHarry%5D)

一个资源可以有多个身份验证属性（如读取、写入、删除），其中每一个都是允许访问操作的角色列表。（见下图）

![图片在这里](https://yuml.me/diagram/scale:65/class/%5BResource%5D+-%3E%5Bread%5D,%20%5Bread%5D-%3E%5BAdministrators%5D,%20%5Bread%5D-%3E%5BManagement%5D,%20%5Bread%5D-%3E%5BMarketing%5D,%20%5BResource%5D+-%3E%5Bwrite%5D,%20%5Bwrite%5D-%3E%5BAdministrators%5D,%20%5Bwrite%5D-%3E%5BManagement%5D,%20%5BResource%5D+-%3E%5Bdelete%5D,%20%5Bdelete%5D-%3E%5BAdministrators%5D)

问题是如果我想检查用户是否有权访问属性，我必须在最坏的情况下遍历 n 棵树（其中 n 是分配给属性的角色数）。

例如，要检查“Max”是否可以读取属性，我可能必须检查营销、管理和管理树是否包含“Max”。

* * *

您是否知道任何算法或替代方法可以删除相当昂贵的树搜索，同时保持角色系统或同样强大的东西。

完美的情况是对 n 个角色进行 O(log(n)) 之类的查找。

谢谢， 芬恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T20:24:20.083

您是否对此进行了测量并确定此遍历是性能瓶颈？

我从未见过具有如此多角色/级别的系统，以至于遍历这种结构的成本会成为一个问题。如果树真的那么大，我会更担心管理员很难理解谁有权做什么。

关于可伸缩性，我通常会使用 ASP.NET 缓存来缓存在资源和角色之间映射的完整树，并使用合适的缓存超时。并单独缓存从用户到角色的映射（例如在会话中或在 ASP.NET 缓存中使用特定于用户的键）。

与每次访问数据库相比，从缓存中访问信息通常会快得令人眼花缭乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T20:10:04.043

如果您将角色放在 SQL 数据库中，查找将按照您的描述执行。如果您有兴趣，我可以帮助您了解数据库结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T20:13:03.193

你需要扭转你的指针。

“Harry”是“Site2 Admins”的成员，拥有“Administrators”访问“Site2”的权限，因此他可以“删除”、“写入”和“读取该内容”。

为什么“管理”应该是“哈利”和“乔”之间的共同点，我不清楚。Harry 是一个站点的管理员，但只是另一个站点的用户，Joe 反之亦然。

# mysql - 将 mySQL 的 KEY 转换为 PgSQL？

> ID：907888
> 
> 赞同：2
> 
> 时间：2009-05-25T20:05:38.373
> 
> 标签：mysql, postgresql

我正在将一些 mySQL 代码转换为 pgSQL，我遇到了这个问题

mysql 代码：“KEY ug_main_grp_id (ug_main_grp_id)”

PgSQL 中的等价物是什么。首先，我认为我可以在 pgSQL 中使用 CREATE INDEX，但这真的不合适，因为 KEY 不是索引：P

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T20:06:16.547

`KEY` *是*一个索引，如果那是您要移植的确切语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-02T23:56:43.160

鉴于你的例子：`KEY ug_main_grp_id (ug_main_grp_id)`

你会在`CREATE TABLE`声明之后添加：

```
CREATE INDEX ug_main_grp_id ON TheTableName ( ug_main_grp_id ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-13T06:41:53.590

如果它们的键是唯一的，只需使用*UNIQUE*，如下所示：

```
mycolumn int NOT NULL UNIQUE 
```

但如果它不是唯一的，则需要使用*CREATE INDEX*命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T20:06:47.123

```
PRIMARY KEY (ug_main_grp_id) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-16T00:19:06.947

如果你有多个索引，你不必在 pgsql 中做任何特别的事情，它会自动找出哪些索引用于给定的查询。

# c++ - 关于现有代码的样式问题 (C/C++)

> ID：907901
> 
> 赞同：7
> 
> 时间：2009-05-25T20:07:32.130
> 
> 标签：c++, c, coding-style

我只是希望以下内容在您看来不像多余的 jabber :)
无论如何，就是这样：

```
for (p = fmt; *p; p++) {
    if (*p != '%') {
        putchar(*p);
        continue;
    }
    switch (*++p) {
        /* Some cases here */
        ...
    }
 } 
```

我想知道为什么作者（Kernighan / Ritchie）`continue`在`if`声明中使用了。
我认为仅仅是因为他认为这比`switch`在一个`else`语句下缩进整体更优雅，你怎么看？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-25T20:11:56.363

大概。人脑的堆栈空间有限，难以处理深度嵌套的结构。任何使我们期望解析的信息扁平化的东西都更容易理解。

同样，我通常更喜欢这个：

```
bool foo(int arg)
{
    if(!arg) {
        /* arg can't be 0 */
        return false; 
    }

    /* Do some work */
    return true;
 } 
```

对此：

```
 bool foo(int arg) 
 { 
     if(!arg) {
         /* arg can't be 0 */ 
         return false; 
     } else {
         /* Do some work */ 
         return true;
     } 
 } 
```

或者更糟的是，对此：

```
bool foo(int arg) 
{ 
    if(arg) {
        /* Do some work */ 
        return true;
    } else {
        /* arg can't be 0 */ 
        return false; 
    } 
} 
```

在最后一个示例中，完成工作的部分可能很长。当读者读到 else 子句时，他可能不记得他是如何到达那里的。

将救助条件放在接近开头有助于确保尝试调用您的函数的人将很好地了解函数期望的输入。

此外，正如其他人指出的那样， continue 清楚地表明，无需进一步阅读循环内的代码来确定在此情况下是否有任何更多处理，从而使代码更易于理解。同样，你强迫读者跟踪的东西越少越好。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-25T20:15:17.917

因为使用 continue 很明显，代码是为这个循环迭代完成的。如果使用了 else，您还必须检查 else 之后是否没有代码。

我认为尽快退出上下文通常是一个好习惯，因为这会导致代码更清晰。

* * *

例如：

```
if(arg1 == NULL)
  return;

if(arg2 == NULL)
  return;

//Do some stuff 
```

对比

```
if(arg1 != null)
{
  if(arg2 != null)
  {
    //Do some stuff
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T20:13:51.400

当它像这样放置时，它更容易阅读。

*我们是否通过循环完成了这个迭代？*是的？所以让我们**继续**下一次迭代。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-25T20:14:49.243

我认为他有足够的理由缩进 switch 下的代码，缩进整个函数的肉是相当浪费水平空间的。在编写代码时，我想 80 个字符宽度仍然很流行。

我认为这并不难理解，但我确实认为很高兴提及您不立即做的事情，然后是 GTFO。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T20:11:05.773

总是有很多方法可以编写这样的代码 -

将整个 switch 放在 else 语句中将是完全有效的。我想他们这样做的原因〜可能〜只是他们当时的想法：

“如果 p 处的值不等于 '%'，则放置然后继续。”

如果您在 else 下进行了切换，那么对于作者来说，在特定情况下您正在跳转到下一个迭代可能并不那么明显。

不过，这完全是个人风格选择。我不会太担心 - 只需以对您和您的团队最有意义的方式编写即可。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T20:13:24.800

我同意。但是您不能将其视为“单纯的理由”，这实际上是一个很好的理由，因为它降低了代码的整体复杂性。使其更短，更容易阅读和理解。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-25T20:14:06.763

如果你使用 an`else`那么里面的所有东西都`else`需要缩进：

```
if ()
{
  doA();
}
else
{
  doB();
  if ()
  {
    doC();
  }
  else
  {
    doD()
  }
} 
```

如果你使用`continue`那么你不需要缩进：

```
if ()
{
  doA()
  continue;
}
doB();
if ()
{
  doC();
  continue;
}
doD(); 
```

另外，`continue`意味着我可以停止考虑这种情况：例如，如果我看到`else`then 可能会`'%'`在循环的后面，即在`else`语句结束时对这种情况进行更多处理；而看到`continue`我立即知道`'%'`循环中的案例处理已完全完成。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-25T20:14:48.870

最可能的原因是后面`switch`的相当长 - 这看起来像`printf`格式解析。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-25T20:20:47.470

继续/中断循环的原因可能不止一个。所以它看起来接下来：

```
loop
{
   if (cond1)
   {
      if (cond2)
      {
         if (cond2)
         {
            more conditions...
         }
      }
   }
   else
   {
      the loop action 
   }
} 
```

恕我直言，它不像您的示例中的循环那么优雅和可读，例如：

```
loop
{
   if (cond1)
      continue;
   if (cond2)
      continue;
   if (cond2)
      continue;   
   if( more conditions...)
      continue;

  the loop action 
} 
```

而且您甚至不需要了解所有“if”的所有结构（它可能要复杂得多）来理解循环逻辑。

PS只是为了案例：我认为作者没有考虑如何编写这个循环，他们只是写了它:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-25T20:57:57.520

我坚持 Dijkstra 的教义：**goto 是有害**的。和 continue/break 是 goto 的小兄弟。

如果问题是你的代码缩进太多，解决方案不是在循环中放置一个 continue ，而是通过将代码分隔在不同的函数中或考虑一种更好的组织方式来降低复杂性。

例如，@Kamarey 片段会更清晰，如下所示：

```
loop
{
   if (!(cond1 ||
         cond2 ||
         cond2 || 
         ...))
   {
      the loop actions;
   }
} 
```

或@Ori Pessach 示例可以表示为：

```
bool foo(int arg)
{
    if(arg) {
        /*do some work*/
    }

    return arg != 0;
} 
```

简而言之，通常我找不到足够好的理由来使用非结构化编程结构（也许在非常有限的情况下进行一些清理代码......）

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-25T20:43:36.907

好吧，我写了大约 11 年的 C 程序，我必须阅读 5 次你的代码才能理解它！

Kernighan 和 Ritchie 在 60 年代很活跃。在那个时候，能够理解一段代码并不重要。能够编写适合 16 Ko 的代码是。

所以我并不感到惊讶。当你的老师是 K&R 时，C 是一门糟糕的语言。看看 realloc：今天谁会知道这样的代码？在 60 年代，它风靡一时，但现在至少令人震惊：o)

# jquery - 如何使用 JQuery 将数据放入 Rails

> ID：907910
> 
> 赞同：50
> 
> 时间：2009-05-25T20:10:19.550
> 
> 标签：jquery, ruby-on-rails, ajax, json

我正在尝试发送如下所示的 jquery ajax PUT 请求：

```
$.ajax({
          type: "PUT",
          url: '/admin/pages/1.json',
          data: { page : {...} },
          dataType: 'json',
          success: function(msg) {
            alert( "Data Saved: " + msg );
          }
}); 
```

但我收到以下错误：

```
The error occurred while evaluating nil.name
    /Library/Ruby/Gems/1.8/gems/activesupport-2.3.2/lib/active_support/xml_mini/rexml.rb:29:in `merge_element!'
    /Library/Ruby/Gems/1.8/gems/activesupport-2.3.2/lib/active_support/xml_mini/rexml.rb:18:in `parse'
    (__DELEGATION__):2:in `__send__'
    (__DELEGATION__):2:in `parse'
    /Library/Ruby/Gems/1.8/gems/activesupport-2.3.2/lib/active_support/core_ext/hash/conversions.rb:154:in `from_xml' ... ... 
```

就像 Rails 试图将参数解析为 XML，但我想使用 JSON！

我应该怎么做才能将 JSON 放到 Rails 中？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-25T20:31:57.150

并非所有浏览器都支持 PUT 和 DELETE，RubyOnRails 支持使用您的数据传递一个名为**_method**的额外参数，该参数将指示 RoR 将如何处理请求。

```
$.ajax({
          type: "POST",
          url: '/admin/pages/1.json',
          data: { _method:'PUT', page : {...} },
          dataType: 'json',
          success: function(msg) {
            alert( "Data Saved: " + msg );
          }
}); 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2010-10-27T17:50:03.143

jQuery 中的`dataType`参数不是您发送的内容，而是指定您期望**答案**的格式（是的，这是一个非常糟糕的名称）。如果您想以其他格式将数据发送到服务器，那么`application/x-www-form-urlencoded`您应该使用`contentType`param. 您还需要序列化您的`data`：

```
$.ajax({
      type: "PUT",
      url: '/admin/pages/1.json',
      data: JSON.stringify({...}),
      contentType: 'application/json', // format of request payload
      dataType: 'json', // format of the response
      success: function(msg) {
        alert( "Data Saved: " + msg );
      }
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-25T21:23:03.350

好的，实际上我的 JSON 数据没有页面键，我的错。所以这就是为什么它没有正确解析。但现在我得到“[object Object]”字符串作为页面键的值，而不是一个很好解析的 json 对象。

我应该在哪里看：JQuery 或 Rails？

编辑：

我已经使用此处找到的脚本解决了我对 json 对象进行字符串化的问题：www.json.org/js.html：

```
$.ajax({
      type: "PUT",
      url: '/admin/pages/1.json',
      data: { page : JSON.stringify( {...} ) },
      dataType: 'json',
      success: function(msg) {
        alert( "Data Saved: " + msg );
      }
}); 
```

在 Rails 端，必须需要 json gem。在控制器中：

```
 params[:page] = JSON.parse params[:page] if params[:page].is_a? String 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-27T11:50:14.183

```
var id = $('#route_id').val()
$.ajax({
    type: 'PUT',
    url:  '/routes/'+ id,
    data: $('#markerform').serializeArray(),
    dataType: "JSON",
    success: function(data) {
        console.log(data);
    }
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-07T13:00:36.767

我在使用 jQuery/rails 时遇到了类似的问题 [object Object]，但使用的是 HTML，而不是 JSON。也许这会有所帮助-

参数`[object Object]`

```
data: { lesson: { date: drop_date } } 
```

参数`lesson[date]`

```
data: { "lesson[date]": drop_date } 
```

希望这可以帮助 -

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-22T02:30:00.883

您可能只需要在 jQuery 上设置请求标头。

```
jQuery.ajaxSetup({ 
  'beforeSend': function(xhr) {
    xhr.setRequestHeader("Accept", "text/javascript");
  }
}) 
```

# svn - 有什么方法可以同步 GIT 和 Subversion 存储库？

> ID：907913
> 
> 赞同：31
> 
> 时间：2009-05-25T20:11:06.943
> 
> 标签：svn, git, version-control

我想同时使用 GIT 和 SVN 客户端访问存储库。我想象的一种方法是通过自动双向迁移：当用户推送到 GIT 存储库时，它也会在 SVN 存储库中被提交，反之亦然。

有什么工具可以帮助我做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-25T20:15:42.470

最好的方法是[`git svn`](http://git-scm.com/docs/git-svn)用作 Subversion 客户端。这提供了 Subversion 存储库和 Git 存储库之间的双向集成。一旦你有了一个 Git 存储库，你就可以将它推送到其他任何地方来发布它。

我经常这样做，在工作中有一个 Subversion 存储库，它是“主”存储库，我通常`git svn`用来访问它。有时，如果我正在做一些需要更具体的 Subversion 功能（如合并）的事情，我会使用常规`svn`客户端来代替存储库。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-12T15:38:19.650

有一个新的解决方案可以完全满足您的需求—— [SubGit](http://subgit.com)。它是并发安全的（我不能对基于 git-svn 的 bash 脚本说同样的话）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-28T08:30:55.180

我们的团队遇到了完全相同的问题，经过一些实验，我们设法提出了一个 git-Subversion 桥接器，可以同步我们团队 git 存储库和公司 Subversion 存储库之间的更改。我们的 git 使用对其他 Subversion 用户是透明的。

设置在[https://github.com/mrts/git-svn-bridge](https://github.com/mrts/git-svn-bridge)有更详细的描述。

我们已经在生产中使用这种设置一年多了。

我想设置的最大警告是 git 存储库仅跟踪 SVN 主干（或另一个分支），因此在合并到主干期间其他 git 分支将被压缩为一个提交。对我们来说这没有问题——我们使用短期任务分支，并认为它们是轻量级的、短暂的“工作单元”，可以在单个块中进入主线——并且分支历史保留在 git 中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-25T20:36:14.973

您可能会考虑[**使用 svn2git**](http://github.com/iteman/svn2git/tree/master)轻松将 svn 导入 git，然后将其镜像 ruby​​ 应用程序**[git2svn](http://repo.or.cz/w/git2svn.git)**。[这个问题](https://stackoverflow.com/questions/572893/cloning-a-non-standard-svn-repository-with-git-svn/572898#572898)
的更多细节。 正如其他答案中提到的，' ' 是强制性的，但是这些 ruby​​ 模块可以帮助您尊重“颠覆分支/目录”，而不是将它们作为 Git 中的实际目录。
`git svn`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-07-03T03:31:08.363

您可能还想查看此解决方案：[http](http://unethicalblogger.com/posts/2008/10/git_back_subversion_mostly_automagically_part_33) ://unethicalblogger.com/posts/2008/10/git_back_subversion_mostly_automagically_part_33 ，用于在 git 和 subversion 之间同步 repo，多个开发人员同时使用 git 和 subversion，以及代理他们之间做同步。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-07-03T23:36:01.783

我有一个裸 git 中央存储库 + SVN-git 桥 - 一个带有 git svn 的存储库，在分支“当前”中跟踪 SVN，并在分支“gitcentral”中跟踪 GIT 存储库

然后我在中央 git 存储库中使用更新后挂钩，如下所示：

```
#!/bin/bash

# Anything inserted into GIT - move it back to SVN

echo
echo '* Pushing data into SVN branch'
cd /home/git/BRIDGE
unset GIT_DIR

# current - svn branch locally and central git branch on project.git repos
# centralgit - unmodified centralgit branch
git fetch /home/git/repositories/project.git/ master:centralgit || (echo "Error while pulling data into bridge repository"; exit 1)
git checkout -b temp centralgit || exit 2
git rebase current || exit 3
git checkout current || exit 4
git reset --hard temp || exit 5
git svn dcommit || exit 6
git branch -D temp || exit 7

echo '* Pushed correctly data into SVN'
exit 0 
```

这主要是暂时的，但有效......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-25T20:16:03.110

当然，更简单的方法是将主存储库保留为 Subversion，但在本地使用 git-svn？

# sql - 选择并显示排名项目和用户的投票，例如 reddit、digg 等

> ID：907914
> 
> 赞同：1
> 
> 时间：2009-05-25T20:11:28.690
> 
> 标签：sql, mysql, database, performance, voting

从数据库中选择排名对象时（例如，用户投票的文章），最好的显示方式是：

*   项目的当前页面
*   用户对每个项目的评分（如果他们已投票）

粗略的架构：

```
articles: id, title, content, ...
user: id, username, ...
votes: id, user_id, article_id, vote_value 
```

是否更好/更理想：

1.  选择当前页面的项目
2.  选择用户的投票，将他们限制在带有“IN”子句的项目页面

或者

1.  选择当前页面的项目，然后从用户投票表中“加入”投票数据

或者，完全不同的东西？

理论上这是在高流量环境中，并使用像mysql这样的rdbms。fwiw，我看到这一点是“在做之前想清楚”而不是“过早的优化”。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T20:14:09.837

JOIN 会更快；它将节省到数据库的往返行程。

但是，在您真正获得一些流量之前，我根本不会担心这一点。很多人都反对[过早优化](http://www.acm.org/ubiquity/views/v7i24_fallacy.html)，我会随机引用一个：

> 以效率的名义（不一定实现）比任何其他单一原因（包括盲目愚蠢）犯下的计算罪更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T20:15:38.227

如果您需要订购选票，请使用以下命令：

```
SELECT  *
FROM    (
        SELECT  a.*, (
                SELECT  SUM(vote_value)
                FROM    votes v
                WHERE   v.article_id = a.id
                ) AS votes
        FROM    article a
        )
ORDER BY
        votes DESC
LIMIT 100, 110 
```

这将在单个查询中计算选票并分页。

如果您只想显示用户自己的投票，请使用`LEFT JOIN`：

```
SELECT  a.*, vote_value
FROM    articles a
LEFT JOIN
        votes v
ON      v.user_id = @current_user
        AND v.article_id = a.id
ORDER BY
        a.timestamp DESC
LIMIT 100, 110 
```

启用索引`(vote_user, vote_item)`将大大改善此查询。

请注意，您可以进行`(vote_user, vote_item)`投票`PRIMARY KEY`，这将进一步改进此查询。

# c# - 为什么数据库访问时间会发生变化？

> ID：907934
> 
> 赞同：-1
> 
> 时间：2009-05-25T20:14:55.843
> 
> 标签：c#, .net, sql-server, .net-3.5

对于我的一个应用程序，我正在运行 SQL Server 2005，并且在 localhost 上运行它。当我通过应用程序访问它时，如果我在本地主机上访问它，它需要 1-10 秒才能开始显示数据。但是，当我离开 localhost 并从网络上的另一台计算机访问它时，访问时间约为一秒。

为什么会这样，我该如何纠正这个问题，以便我可以在 localhost 上拥有相同的访问时间？

**连接字符串：**`Data Source=THESTUDIO\SQLEXPRESS;Initial Catalog=RentalEase;Integrated Security=True`

使用类型化数据集进行查询（大部分）

加载表单时，我发现 Visual Studio 多次使用相同的查询查询数据库。尽管据我了解，数据库会以查询的缓存版本进行响应。但是，我确实发现应用程序（来自 winform 的数据绑定功能）正在执行此查询：

```
exec sp_executesql N'UPDATE [tblTenant] SET [TenantStatusID] = @TenantStatusID, [PropertyID] = @PropertyID, [UnitID] = @UnitID, [TenantName] = @TenantName, [Sex] = @Sex, [BirthDate] = @BirthDate, [SSNO] = @SSNO, [CoTenant1] = @CoTenant1, [CoTenant1Sex] = @CoTenant1Sex, [CoTenant1BirthDate] = @CoTenant1BirthDate, [CoTenant1SSNO] = @CoTenant1SSNO, [CoTenant2] = @CoTenant2, [CoTenant2Sex] = @CoTenant2Sex, [CoTenant2BirthDate] = @CoTenant2BirthDate, [CoTenant2SSNO] = @CoTenant2SSNO, [CoTenant3] = @CoTenant3, [CoTenant3Sex] = @CoTenant3Sex, [CoTenant3BirthDate] = @CoTenant3BirthDate, [CoTenant3SSNO] = @CoTenant3SSNO, [CarColor] = @CarColor, [CarModel] = @CarModel, [CarYear] = @CarYear, [CarState] = @CarState, [CarPlateNumber] = @CarPlateNumber, [Memo] = @Memo, [Address1] = @Address1, [Address2] = @Address2, [Address3] = @Address3, [Address4] = @Address4, [Phone] = @Phone, [ReferBy] = @ReferBy, [BeginDate] = @BeginDate, [NoticeGiven] = @NoticeGiven, [LeaseMonth2Month] = @LeaseMonth2Month, [LeaseEnds] = @LeaseEnds, [DepositPaid] = @DepositPaid, [DepositRefundable] = @DepositRefundable, [RefundMemo] = @RefundMemo, [RentDueDay] = @RentDueDay, [Charge1] = @Charge1, [Charge1Amount] = @Charge1Amount, [Charge2] = @Charge2, [Charge2Amount] = @Charge2Amount, [Charge3] = @Charge3, [Charge3Amount] = @Charge3Amount, [Charge4] = @Charge4, [Charge4Amount] = @Charge4Amount WHERE (([ID] = @Original_ID) AND ([TenantStatusID] = @Original_TenantStatusID) AND ((@IsNull_PropertyID = 1 AND [PropertyID] IS NULL) OR ([PropertyID] = @Original_PropertyID)) AND ((@IsNull_UnitID = 1 AND [UnitID] IS NULL) OR ([UnitID] = @Original_UnitID)) AND ((@IsNull_TenantName = 1 AND [TenantName] IS NULL) OR ([TenantName] = @Original_TenantName)) AND ((@IsNull_Sex = 1 AND [Sex] IS NULL) OR ([Sex] = @Original_Sex)) AND ((@IsNull_BirthDate = 1 AND [BirthDate] IS NULL) OR ([BirthDate] = @Original_BirthDate)) AND ((@IsNull_SSNO = 1 AND [SSNO] IS NULL) OR ([SSNO] = @Original_SSNO)) AND ((@IsNull_CoTenant1 = 1 AND [CoTenant1] IS NULL) OR ([CoTenant1] = @Original_CoTenant1)) AND ((@IsNull_CoTenant1Sex = 1 AND [CoTenant1Sex] IS NULL) OR ([CoTenant1Sex] = @Original_CoTenant1Sex)) AND ((@IsNull_CoTenant1BirthDate = 1 AND [CoTenant1BirthDate] IS NULL) OR ([CoTenant1BirthDate] = @Original_CoTenant1BirthDate)) AND ((@IsNull_CoTenant1SSNO = 1 AND [CoTenant1SSNO] IS NULL) OR ([CoTenant1SSNO] = @Original_CoTenant1SSNO)) AND ((@IsNull_CoTenant2 = 1 AND [CoTenant2] IS NULL) OR ([CoTenant2] = @Original_CoTenant2)) AND ((@IsNull_CoTenant2Sex = 1 AND [CoTenant2Sex] IS NULL) OR ([CoTenant2Sex] = @Original_CoTenant2Sex)) AND ((@IsNull_CoTenant2BirthDate = 1 AND [CoTenant2BirthDate] IS NULL) OR ([CoTenant2BirthDate] = @Original_CoTenant2BirthDate)) AND ((@IsNull_CoTenant2SSNO = 1 AND [CoTenant2SSNO] IS NULL) OR ([CoTenant2SSNO] = @Original_CoTenant2SSNO)) AND ((@IsNull_CoTenant3 = 1 AND [CoTenant3] IS NULL) OR ([CoTenant3] = @Original_CoTenant3)) AND ((@IsNull_CoTenant3Sex = 1 AND [CoTenant3Sex] IS NULL) OR ([CoTenant3Sex] = @Original_CoTenant3Sex)) AND ((@IsNull_CoTenant3BirthDate = 1 AND [CoTenant3BirthDate] IS NULL) OR ([CoTenant3BirthDate] = @Original_CoTenant3BirthDate)) AND ((@IsNull_CoTenant3SSNO = 1 AND [CoTenant3SSNO] IS NULL) OR ([CoTenant3SSNO] = @Original_CoTenant3SSNO)) AND ((@IsNull_CarColor = 1 AND [CarColor] IS NULL) OR ([CarColor] = @Original_CarColor)) AND ((@IsNull_CarModel = 1 AND [CarModel] IS NULL) OR ([CarModel] = @Original_CarModel)) AND ((@IsNull_CarYear = 1 AND [CarYear] IS NULL) OR ([CarYear] = @Original_CarYear)) AND ((@IsNull_CarState = 1 AND [CarState] IS NULL) OR ([CarState] = @Original_CarState)) AND ((@IsNull_CarPlateNumber = 1 AND [CarPlateNumber] IS NULL) OR ([CarPlateNumber] = @Original_CarPlateNumber)) AND ((@IsNull_Address1 = 1 AND [Address1] IS NULL) OR ([Address1] = @Original_Address1)) AND ((@IsNull_Address2 = 1 AND [Address2] IS NULL) OR ([Address2] = @Original_Address2)) AND ((@IsNull_Address3 = 1 AND [Address3] IS NULL) OR ([Address3] = @Original_Address3)) AND ((@IsNull_Address4 = 1 AND [Address4] IS NULL) OR ([Address4] = @Original_Address4)) AND ((@IsNull_Phone = 1 AND [Phone] IS NULL) OR ([Phone] = @Original_Phone)) AND ((@IsNull_ReferBy = 1 AND [ReferBy] IS NULL) OR ([ReferBy] = @Original_ReferBy)) AND ((@IsNull_BeginDate = 1 AND [BeginDate] IS NULL) OR ([BeginDate] = @Original_BeginDate)) AND ((@IsNull_NoticeGiven = 1 AND [NoticeGiven] IS NULL) OR ([NoticeGiven] = @Original_NoticeGiven)) AND ((@IsNull_LeaseMonth2Month = 1 AND [LeaseMonth2Month] IS NULL) OR ([LeaseMonth2Month] = @Original_LeaseMonth2Month)) AND ((@IsNull_LeaseEnds = 1 AND [LeaseEnds] IS NULL) OR ([LeaseEnds] = @Original_LeaseEnds)) AND ((@IsNull_DepositPaid = 1 AND [DepositPaid] IS NULL) OR ([DepositPaid] = @Original_DepositPaid)) AND ((@IsNull_DepositRefundable = 1 AND [DepositRefundable] IS NULL) OR ([DepositRefundable] = @Original_DepositRefundable)) AND ((@IsNull_RentDueDay = 1 AND [RentDueDay] IS NULL) OR ([RentDueDay] = @Original_RentDueDay)) AND ((@IsNull_Charge1 = 1 AND [Charge1] IS NULL) OR ([Charge1] = @Original_Charge1)) AND ((@IsNull_Charge1Amount = 1 AND [Charge1Amount] IS NULL) OR ([Charge1Amount] = @Original_Charge1Amount)) AND ((@IsNull_Charge2 = 1 AND [Charge2] IS NULL) OR ([Charge2] = @Original_Charge2)) AND ((@IsNull_Charge2Amount = 1 AND [Charge2Amount] IS NULL) OR ([Charge2Amount] = @Original_Charge2Amount)) AND ((@IsNull_Charge3 = 1 AND [Charge3] IS NULL) OR ([Charge3] = @Original_Charge3)) AND ((@IsNull_Charge3Amount = 1 AND [Charge3Amount] IS NULL) OR ([Charge3Amount] = @Original_Charge3Amount)) AND ((@IsNull_Charge4 = 1 AND [Charge4] IS NULL) OR ([Charge4] = @Original_Charge4)) AND ((@IsNull_Charge4Amount = 1 AND [Charge4Amount] IS NULL) OR ([Charge4Amount] = @Original_Charge4Amount)));
SELECT ID, TenantStatusID, PropertyID, UnitID, TenantName, Sex, BirthDate, SSNO, CoTenant1, CoTenant1Sex, CoTenant1BirthDate, CoTenant1SSNO, CoTenant2, CoTenant2Sex, CoTenant2BirthDate, CoTenant2SSNO, CoTenant3, CoTenant3Sex, CoTenant3BirthDate, CoTenant3SSNO, CarColor, CarModel, CarYear, CarState, CarPlateNumber, Memo, Address1, Address2, Address3, Address4, Phone, ReferBy, BeginDate, NoticeGiven, LeaseMonth2Month, LeaseEnds, DepositPaid, DepositRefundable, RefundMemo, RentDueDay, Charge1, Charge1Amount, Charge2, Charge2Amount, Charge3, Charge3Amount, Charge4, Charge4Amount FROM tblTenant WHERE (ID = @ID)',N'@TenantStatusID int,@PropertyID int,@UnitID int,@TenantName nvarchar(4),@Sex nvarchar(1),@BirthDate datetime,@SSNO nvarchar(9),@CoTenant1 nvarchar(4000),@CoTenant1Sex nvarchar(4000),@CoTenant1BirthDate datetime,@CoTenant1SSNO nvarchar(4000),@CoTenant2 nvarchar(4000),@CoTenant2Sex nvarchar(4000),@CoTenant2BirthDate datetime,@CoTenant2SSNO nvarchar(4000),@CoTenant3 nvarchar(2),@CoTenant3Sex nvarchar(4000),@CoTenant3BirthDate datetime,@CoTenant3SSNO nvarchar(4000),@CarColor nvarchar(4000),@CarModel nvarchar(4000),@CarYear nvarchar(4000),@CarState nvarchar(4000),@CarPlateNumber nvarchar(7),@Memo nvarchar(4000),@Address1 nvarchar(10),@Address2 nvarchar(10),@Address3 nvarchar(10),@Address4 nvarchar(10),@Phone nvarchar(4000),@ReferBy nvarchar(9),@BeginDate datetime,@NoticeGiven datetime,@LeaseMonth2Month bit,@LeaseEnds datetime,@DepositPaid money,@DepositRefundable money,@RefundMemo nvarchar(4000),@RentDueDay nvarchar(4000),@Charge1 int,@Charge1Amount money,@Charge2 int,@Charge2Amount money,@Charge3 int,@Charge3Amount money,@Charge4 int,@Charge4Amount money,@Original_ID int,@Original_TenantStatusID int,@IsNull_PropertyID int,@Original_PropertyID int,@IsNull_UnitID int,@Original_UnitID int,@IsNull_TenantName int,@Original_TenantName nvarchar(4),@IsNull_Sex int,@Original_Sex nvarchar(1),@IsNull_BirthDate int,@Original_BirthDate datetime,@IsNull_SSNO int,@Original_SSNO nvarchar(9),@IsNull_CoTenant1 int,@Original_CoTenant1 nvarchar(4000),@IsNull_CoTenant1Sex int,@Original_CoTenant1Sex nvarchar(4000),@IsNull_CoTenant1BirthDate int,@Original_CoTenant1BirthDate datetime,@IsNull_CoTenant1SSNO int,@Original_CoTenant1SSNO nvarchar(4000),@IsNull_CoTenant2 int,@Original_CoTenant2 nvarchar(4000),@IsNull_CoTenant2Sex int,@Original_CoTenant2Sex nvarchar(4000),@IsNull_CoTenant2BirthDate int,@Original_CoTenant2BirthDate datetime,@IsNull_CoTenant2SSNO int,@Original_CoTenant2SSNO nvarchar(4000),@IsNull_CoTenant3 int,@Original_CoTenant3 nvarchar(2),@IsNull_CoTenant3Sex int,@Original_CoTenant3Sex nvarchar(4000),@IsNull_CoTenant3BirthDate int,@Original_CoTenant3BirthDate datetime,@IsNull_CoTenant3SSNO int,@Original_CoTenant3SSNO nvarchar(4000),@IsNull_CarColor int,@Original_CarColor nvarchar(4000),@IsNull_CarModel int,@Original_CarModel nvarchar(4000),@IsNull_CarYear int,@Original_CarYear nvarchar(4000),@IsNull_CarState int,@Original_CarState nvarchar(4000),@IsNull_CarPlateNumber int,@Original_CarPlateNumber nvarchar(7),@IsNull_Address1 int,@Original_Address1 nvarchar(10),@IsNull_Address2 int,@Original_Address2 nvarchar(10),@IsNull_Address3 int,@Original_Address3 nvarchar(10),@IsNull_Address4 int,@Original_Address4 nvarchar(10),@IsNull_Phone int,@Original_Phone nvarchar(4000),@IsNull_ReferBy int,@Original_ReferBy nvarchar(9),@IsNull_BeginDate int,@Original_BeginDate datetime,@IsNull_NoticeGiven int,@Original_NoticeGiven datetime,@IsNull_LeaseMonth2Month int,@Original_LeaseMonth2Month bit,@IsNull_LeaseEnds int,@Original_LeaseEnds datetime,@IsNull_DepositPaid int,@Original_DepositPaid money,@IsNull_DepositRefundable int,@Original_DepositRefundable money,@IsNull_RentDueDay int,@Original_RentDueDay nvarchar(4000),@IsNull_Charge1 int,@Original_Charge1 int,@IsNull_Charge1Amount int,@Original_Charge1Amount money,@IsNull_Charge2 int,@Original_Charge2 int,@IsNull_Charge2Amount int,@Original_Charge2Amount money,@IsNull_Charge3 int,@Original_Charge3 int,@IsNull_Charge3Amount int,@Original_Charge3Amount money,@IsNull_Charge4 int,@Original_Charge4 int,@IsNull_Charge4Amount int,@Original_Charge4Amount money,@ID int',@TenantStatusID=1,@PropertyID=111,@UnitID=2175,@TenantName=N'Judy',@Sex=N'1',@BirthDate='Apr 29 1980  3:26:06:000PM',@SSNO=N'333333333',@CoTenant1=NULL,@CoTenant1Sex=NULL,@CoTenant1BirthDate=NULL,@CoTenant1SSNO=NULL,@CoTenant2=NULL,@CoTenant2Sex=NULL,@CoTenant2BirthDate=NULL,@CoTenant2SSNO=NULL,@CoTenant3=N'51',@CoTenant3Sex=NULL,@CoTenant3BirthDate=NULL,@CoTenant3SSNO=NULL,@CarColor=NULL,@CarModel=NULL,@CarYear=NULL,@CarState=NULL,@CarPlateNumber=N'001122B',@Memo=NULL,@Address1=N'blah line1',@Address2=N'blah line2',@Address3=N'blah line3',@Address4=N'blah line4',@Phone=NULL,@ReferBy=N'McDonalds',@BeginDate='May  6 2009  4:54:28:000PM',@NoticeGiven='May  6 2009 11:58:45:000AM',@LeaseMonth2Month=1,@LeaseEnds='May 21 2009 10:06:25:000AM',@DepositPaid=50.0000,@DepositRefundable=0.0000,@RefundMemo=NULL,@RentDueDay=NULL,@Charge1=6,@Charge1Amount=50.0000,@Charge2=49,@Charge2Amount=50.0000,@Charge3=45,@Charge3Amount=5.0000,@Charge4=47,@Charge4Amount=7.0000,@Original_ID=10,@Original_TenantStatusID=1,@IsNull_PropertyID=0,@Original_PropertyID=111,@IsNull_UnitID=0,@Original_UnitID=2175,@IsNull_TenantName=0,@Original_TenantName=N'Judy',@IsNull_Sex=0,@Original_Sex=N'1',@IsNull_BirthDate=0,@Original_BirthDate='Apr 29 1980  3:26:06:000PM',@IsNull_SSNO=0,@Original_SSNO=N'333333333',@IsNull_CoTenant1=1,@Original_CoTenant1=NULL,@IsNull_CoTenant1Sex=1,@Original_CoTenant1Sex=NULL,@IsNull_CoTenant1BirthDate=1,@Original_CoTenant1BirthDate=NULL,@IsNull_CoTenant1SSNO=1,@Original_CoTenant1SSNO=NULL,@IsNull_CoTenant2=1,@Original_CoTenant2=NULL,@IsNull_CoTenant2Sex=1,@Original_CoTenant2Sex=NULL,@IsNull_CoTenant2BirthDate=1,@Original_CoTenant2BirthDate=NULL,@IsNull_CoTenant2SSNO=1,@Original_CoTenant2SSNO=NULL,@IsNull_CoTenant3=0,@Original_CoTenant3=N'51',@IsNull_CoTenant3Sex=1,@Original_CoTenant3Sex=NULL,@IsNull_CoTenant3BirthDate=1,@Original_CoTenant3BirthDate=NULL,@IsNull_CoTenant3SSNO=1,@Original_CoTenant3SSNO=NULL,@IsNull_CarColor=1,@Original_CarColor=NULL,@IsNull_CarModel=1,@Original_CarModel=NULL,@IsNull_CarYear=1,@Original_CarYear=NULL,@IsNull_CarState=1,@Original_CarState=NULL,@IsNull_CarPlateNumber=0,@Original_CarPlateNumber=N'001122B',@IsNull_Address1=0,@Original_Address1=N'blah line1',@IsNull_Address2=0,@Original_Address2=N'blah line2',@IsNull_Address3=0,@Original_Address3=N'blah line3',@IsNull_Address4=0,@Original_Address4=N'blah line4',@IsNull_Phone=1,@Original_Phone=NULL,@IsNull_ReferBy=0,@Original_ReferBy=N'McDonalds',@IsNull_BeginDate=0,@Original_BeginDate='May  6 2009  4:54:28:000PM',@IsNull_NoticeGiven=0,@Original_NoticeGiven='May  6 2009 11:58:45:000AM',@IsNull_LeaseMonth2Month=0,@Original_LeaseMonth2Month=1,@IsNull_LeaseEnds=0,@Original_LeaseEnds='May 21 2009 10:06:25:000AM',@IsNull_DepositPaid=0,@Original_DepositPaid=50.0000,@IsNull_DepositRefundable=0,@Original_DepositRefundable=0.0000,@IsNull_RentDueDay=1,@Original_RentDueDay=NULL,@IsNull_Charge1=0,@Original_Charge1=6,@IsNull_Charge1Amount=0,@Original_Charge1Amount=50.0000,@IsNull_Charge2=0,@Original_Charge2=49,@IsNull_Charge2Amount=0,@Original_Charge2Amount=50.0000,@IsNull_Charge3=0,@Original_Charge3=45,@IsNull_Charge3Amount=0,@Original_Charge3Amount=5.0000,@IsNull_Charge4=0,@Original_Charge4=47,@IsNull_Charge4Amount=0,@Original_Charge4Amount=7.0000,@ID=10 
```

大约需要整整一秒钟才能完成。我能做些什么呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T20:23:56.510

您可以将[Sql Profiler](http://msdn.microsoft.com/en-us/library/ms979207.aspx)附加到服务器以查看究竟发生了什么，以及 Sql 语句是否真的相同。

如果是，并且仍然存在差异，则可能其中一个应用程序正在使用不同的执行计划。清除缓存：

```
DBCC FREEPROCCACHE 
```

并检查它是否有所作为。

[此相关帖子](https://stackoverflow.com/questions/801909/why-is-some-sql-query-much-slower-when-used-with-sqlcommand)中的许多其他建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T20:35:55.957

我的猜测是 10 秒是启动本地计算机上的（不经常使用的）数据库所需的时间。我实际上并没有尝试解决这个问题，但我的第一个猜测是尝试禁用该数据库的“自动关闭”属性。

有关“自动关闭”属性的进一步描述，请参阅[标题为“为 .NET 企业服务器设计 SQL Server 2000 数据库”一书中的摘录](http://books.google.ca/books?id=oAD7HVhOBOAC&pg=PA166&lpg=PA166&dq=sql+%22auto+close%22&source=bl&ots=JbMgeJz-3E&sig=XU7UmzyxRfO91LSrBwn5sFSm074&hl=en&ei=0gAbSs2jDYOyNMHxzY8P&sa=X&oi=book_result&ct=result&resnum=1)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T20:29:30.120

您的本地计算机还在做什么？你怎么查询？如果延迟出现在数据库中，我会感到惊讶，除非其他加载的应用程序导致交换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T21:55:04.470

可能本地机器和远程机器有不同的客户端网络协议设置。例如。本地机器配置为先尝试共享内存，然后是 net-pipes，然后是 tcp，但服务器配置为不侦听共享内存（不寻常，但可能）。远程机器被配置为直接尝试 tcp，因此它们在第一次尝试时就中奖了。只是在黑暗中拍摄，没有更多信息可用。

您应该首先分析问题并确定 10 秒延迟发生在哪里：打开连接、运行查询、将结果返回给客户端等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T20:41:09.473

这可能取决于 SQL Server 尝试在本地计算机上使用的特定通信协议。

您需要发布 - 您的连接字符串 - 在您的服务器计算机上启用的协议（来自 SQL Server 配置管理器）。

# php - 是否可以像在 gmail 中一样在 php 中发出“哔”声

> ID：907942
> 
> 赞同：1
> 
> 时间：2009-05-25T20:18:33.073
> 
> 标签：php, html, audio

对于我正在制作的 IM 脚本，我希望计算机在每次有新消息时都像在 gmail 中一样发出哔哔声。php 或 html 中是否有脚本可以使计算机发出哔哔声？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-25T20:25:27.880

您需要做的就是加载一个发出声音的小 Flash 电影，您可以在需要时使用 Javascript 在页面中轻松切换它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-25T20:32:56.273

一些流行的 javascript 库具有用于播放声音的接口，这些接口内置或可作为插件使用，例如，请参阅[Scriptaculous](http://wiki.github.com/madrobby/scriptaculous/sound)和[jQuery](http://plugins.jquery.com/project/sound)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-22T18:32:32.643

**您可以使用 html 在后台播放哔声**

**只需复制和粘贴：**

```
echo "<audio src='http://freesoundeffect.net/sites/default/files/incorrect-answer--6-sound-effect-99679566.mp3' autoplay ></audio>"; 
```

> 此代码在后台播放哔声，您可以更改 .mp3 文件

# web-services - 如何接收“来自世界各地”的短信并保存在网站数据库中？

> ID：907943
> 
> 赞同：3
> 
> 时间：2009-05-25T20:18:35.540
> 
> 标签：web-services, web-applications, sms

几个月前，当我使用 twitter 时，我可以向 twitter 发送 SMS，当我回家查看我的 twitter 页面时，我看到我发送的 SMS 作为推文在网站上。“那很棒”

现在，我想在我的网站上做同样的事情，所以有人会将我的网站短信作为命令发送，我的网站会将此命令保存在数据库中以供将来处理。

我的问题，我不知道从哪里开始。

1- 当每个国家/地区有不同的移动公司时，用户将如何从世界各地发送信息，或者这不是问题？

2- 我的网站将如何接收和阅读这些短信？有服务吗？

3- 你知道有哪些文章可以为我简化这些任务吗？

如果有人以前做过类似的事情，请提出建议，任何信息都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T20:23:44.920

请联系您的消息传递提供商，他们将为他们支持的每个国家/地区提供解决方案。

在实践中，这些事情需要在每个国家的基础上达成一致（例如短代码等），但提供商会提供很多帮助。

根据您想要覆盖的国家/地区，一个提供商可能会这样做 - 如果您绝对需要每个国家/地区都有移动网络，那么您可能需要几个，在这种情况下集成更加复杂。

通常，当他们收到您公司的简码或简码前缀的消息时，他们会向您的服务器发送 HTTP POST 或 SMTP 电子邮件。但是存在的集成选项是每个提供商都同意的；没有真正的标准或事实上的标准。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T20:26:36.897

嗯，首先你需要一个短信网关。这是一项服务，您可以以不同的价格购买很多地方。您的站点可以根据网关主机以不同的方式与此网关通信。

现在，您可以将消息发送到您在 sms-server 上购买的号码，并将它们轮询（或推送，再次取决于您的 sms-provider）到您的站点。与任何其他短信“IRL”一样，您可以使用国家代码从全球发送非常昂贵的短信。如果你想保持这个价格更低，你需要租一个国际化的短信网关或者你需要在每个国家租一个...

.. 总之，对于您的小型“爱好型”项目来说，这样做并不是一个真正可行的选择:) 虽然租用 SMS 网关相当便宜，所以问题确实出在您的“多个国家”请求中..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T20:25:49.753

我创建了一个用于发送和接收 SMS 消息的 Web 服务。我们通过 VPN 连接到当地 GSM 运营商的 SMS 网关：他们为我们分配了一个公共号码以及向全球发送消息的选项。

我们是在全球范围内发送短信还是从任何人那里接收都没有关系 - 它只是工作:) 发送国际短信可能会更贵一些。

编辑：理论上有可能通过 sip 提供商（如 betamax /voipdiscount.com/）发送短信，但与传统服务相比，这并不是那么快速和可靠。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T21:25:26.857

我过去在[http://www.aspsms.com/上取得了一些成功](http://www.aspsms.com/)

这是一项付费服务​​（每条短信），请注意，在获得 API 密钥之前，您需要支付并**传真（是的，传真...）您的身份信息。**

# c# - 动态数据 Web 应用程序给我错误？

> ID：907947
> 
> 赞同：3
> 
> 时间：2009-05-25T20:20:26.707
> 
> 标签：c#, .net, asp.net, ado.net

我尝试使用动态数据 web 应用程序使用 Ado.net 实体框架但我的解决方案运行时没有错误但单击 gridview 项目创建我：

**“/”应用程序中的服务器错误。仅 LINQ to Entities 中的排序输入支持“跳过”方法。必须在方法“Skip”之前调用方法“OrderBy”。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-30T06:01:50.400

老问题，但昨天遇到了这个问题，所以我认为发布解决方案是有意义的：如果您在 Visual Studio 中为动态数据项目选择了错误的模板，则会发生此错误。有 2 个模板（实际上是 4 个，2 个用于网站，2 个用于 Web 项目）：

1.  动态数据网络应用
2.  动态数据*实体*Web 应用程序

将**1**与 linq-to-sql 一起使用，将**2**与实体框架一起使用。如果将第一个模板与 EF 一起使用，则会出现上述错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-07T18:50:01.030

谢谢。

1.  动态数据网络应用
2.  动态数据实体 Web 应用程序

将 1 与 linq-to-sql 一起使用，将 2 与实体框架一起使用。如果将第一个模板与 EF 一起使用，则会出现上述错误。

这是正确的做法。

# wpf - 在 XAML 中，如何将椭圆保持为圆形？

> ID：907951
> 
> 赞同：19
> 
> 时间：2009-05-25T20:22:01.053
> 
> 标签：wpf, triggers, properties, ellipse

恐怕我对 XAML 视而不见。我正在开发一个 MS Surface 应用程序，我在 ScatterViewItem 中有一个椭圆（最终用户可以调整大小的容器）。我想将椭圆保持为圆形（宽度 == 高度）并使其尽可能大（对于椭圆的宽度/高度属性，应采用 SVI 的宽度/高度的最低值）。

首选只有 XAML 的解决方案（使用属性触发器或类似的）。

一如既往地感谢您的帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-02T13:58:33.440

几分钟前我偶然发现了这个问题，并找到了比@Paul Betts 更好的解决方案（如果可以的话，我会评论他的答案，但我不能）

您可以简单地使用`<Ellipse Stretch="Uniform" />`来获得一个圆圈。

来源：[http ://forums.silverlight.net/t/160615.aspx](http://forums.silverlight.net/t/160615.aspx)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-25T21:11:28.177

一个简单`Viewbox`的伎俩吗？例如

```
<Viewbox xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    HorizontalAlignment="Center"
    VerticalAlignment="Center">
    <Canvas Width="100" Height="100">
        <Ellipse Fill="Red" Width="100" Height="100" />
    </Canvas>
</Viewbox> 
```

将`Viewbox`缩放其内容以填充 的区域，`Viewbox`默认情况下按比例缩放。指定的水平和垂直对齐方式在`Ellipse`无法拉伸到完整尺寸时保持居中（因为按比例缩放）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-26T06:31:56.093

```
<Ellipse x:Name="anEllipse" Width={Binding Path=ActualHeight ElementName=anEllipse} /> 
```

如果您也进行了相对绑定，您可能可以不命名它而侥幸逃脱。

# iphone - 在 iPhone 上播放背景音频

> ID：907965
> 
> 赞同：3
> 
> 时间：2009-05-25T20:28:16.783
> 
> 标签：iphone, audio

如何在我的应用程序运行时播放背景音频？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-01-15T00:26:48.970

好的。这是 iOS4 和 iOS5 上的背景声音解决方案（绝对适用于 iOS 5.0.1），我仅使用 AVPlayer 对其进行了测试。它也应该适用于 MPMusicPlayerController。

所需框架：

*   `AVFoundation.framework`
*   `AudioToolbox.framework`

在您的`Info.plist`, 作为键`UIBackgroundModes`，添加`audio`.

在`MyAppDelegate.h`：

*   参考`<AVFoundation/AVFoundation.h>`&`<AudioToolbox/AudioToolbox.h>`
*   实施协议`AVAudioSessionDelegate`：

    ```
    @interface MyAppDelegate : NSObject <UIApplicationDelegate, AVAudioSessionDelegate> 
    ```

*   定义一个方法`ensureAudio`：

    ```
    // Ensures the audio routes are setup correctly
    - (BOOL) ensureAudio; 
    ```

在`MyAppDelegate.m`：

*   实现`ensureAudio`方法：

    ```
    - (BOOL) ensureAudio
    {
        // Registers this class as the delegate of the audio session (to get background sound)
        [[AVAudioSession sharedInstance] setDelegate: self];  

        // Set category
        NSError *categoryError = nil;
        if (![[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:&categoryError]) {
            NSLog(@"Audio session category could not be set"); 
            return NO;
        }

        // Activate session
        NSError *activationError = nil;
        if (![[AVAudioSession sharedInstance] setActive: YES error: &activationError]) {
            NSLog(@"Audio session could not be activated");
            return NO;
        }

        // Allow the audio to mix with other apps (necessary for background sound)
        UInt32 doChangeDefaultRoute = 1;
        AudioSessionSetProperty(kAudioSessionProperty_OverrideCategoryMixWithOthers, sizeof(doChangeDefaultRoute), &doChangeDefaultRoute);

        return YES;
    } 
    ```

*   在`application:didFinishLaunchingWithOptions:`方法中，在分配根视图控制器之前，运行`[self ensureAudio]`：

    ```
    - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
    {
        // Configure audio session
        [self ensureAudio];

        // Add the navigation controller's view to the window and display.
        self.window.rootViewController = self.navigationController;
        [self.window makeKeyAndVisible];

        return YES;
    } 
    ```

*   实现这样的`AVAudioSessionDelegate`方法：

    ```
    #pragma mark - AVAudioSessionDelegate

    - (void) beginInterruption
    {

    }

    - (void) endInterruption
    {
        // Sometimes the audio session will be reset/stopped by an interruption
        [self ensureAudio];
    }

    - (void) inputIsAvailableChanged:(BOOL)isInputAvailable
    {

    } 
    ```

*   确保您的应用程序继续在后台运行。如果你愿意，你可以使用 ol' `[[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler]`，但我认为有更好的方法。

*   播放实际音频（注意我使用的是 ARC，这就是没有`release`呼叫的原因）：

    ```
    NSURL * file = [[NSBundle mainBundle] URLForResource:@"beep" withExtension:@"aif"];    
    AVURLAsset * asset = [[AVURLAsset alloc] initWithURL:file options:nil];
    AVPlayerItem * item = [[AVPlayerItem alloc] initWithAsset:asset];
    __block AVPlayer * player = [[AVPlayer alloc]initWithPlayerItem:item];
    __block id finishObserver = [[NSNotificationCenter defaultCenter] addObserverForName:AVPlayerItemDidPlayToEndTimeNotification 
                                                                          object:player.currentItem 
                                                                           queue:[NSOperationQueue mainQueue] 
                                                                      usingBlock:^(NSNotification *note) {
        [[NSNotificationCenter defaultCenter] removeObserver:finishObserver];

        // Reference the 'player' variable so ARC doesn't release it until it's
        // finished playing.
        player = nil;
    }];

    // Trigger asynchronous load
    [asset loadValuesAsynchronouslyForKeys:[NSArray arrayWithObject:@"tracks"] completionHandler:^{
        // Start playing the beep (watch out - we're not on the main thread here)!
        [player play];
     }]; 
    ```

*   它shooooooooooooould工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T14:57:41.183

如果您还使用您的应用程序进行录制 - 那么不要忘记将 setCategory 更改为 AVAudioSessionCategoryPlayAndRecord。在其他情况下，您将无法录制

```
[[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayAndRecord error:&setCategoryErr]; 
```

# python - 将所有使用的 Python 模块收集到一个文件夹中？

> ID：907972
> 
> 赞同：1
> 
> 时间：2009-05-25T20:31:01.363
> 
> 标签：python

> **可能重复：**
> [将所有使用的 Python 模块收集到一个文件夹中？](https://stackoverflow.com/questions/907660/gather-all-python-modules-used-into-one-folder)

我认为以前没有人问过这个问题——我有一个包含许多不同 .py 文件的文件夹。我制作的脚本只使用了一些——但有些调用了其他的，我不知道所有正在使用的脚本。是否有一个程序可以获取使该脚本运行到一个文件夹所需的一切？

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T20:44:43.943

由于 Python 不是静态链接语言，因此这项任务将是一项颇具挑战性的任务。特别是如果您的某些代码使用`eval(...)`或`exec(...)`.

如果您的脚本不是很大，我会将其移出，确保您的 python.exe 不会从该目录加载模块，并会运行脚本并添加缺少的模块，直到它工作为止。

我你有多个这样的脚本，那么这个手动工作并不是真正的方法。但是在这种情况下，在一个目录中还有很多不同的 .py 文件并不是一个好的部署技术，你应该考虑将它们打包成*可安装*的模块并安装到你的 python 站点包中。

您仍然可以使用[蛇食](http://furius.ca/snakefood/)包来查找我们的依赖项（已在[此处](https://stackoverflow.com/questions/508277/is-there-a-good-dependency-analysis-tool-for-python)讨论过）。同样，它不能 100% 准确，但应该让您轻松开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T21:18:16.697

您应该能够从所谓的*调用图中提取所需的信息*

参见例如

*   [http://pycallgraph.slowchop.com/](http://pycallgraph.slowchop.com/)或
*   [http://blog.prashanthellina.com/2007/11/14/generating-call-graphs-for-understanding-and-refactoring-python-code/](http://blog.prashanthellina.com/2007/11/14/generating-call-graphs-for-understanding-and-refactoring-python-code/)

此外，[py2exe](http://www.py2exe.org/)将 python 调用转换为可执行文件，并在此过程中收集所有使用的模块。我认为 py2exe 是跨平台的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T21:01:48.103

我会尝试 2½ 个解决方案，一个是精心设计的，一个是 1½ 个快速而简单的：

*   详细说明：自定义导入挂钩，记录所有导入
*   又快又脏，第一部分：`os.utime`*.py[co]? （`re`符号，不是`glob`）文件具有昨天的访问时间，然后运行程序并收集所有最近的访问时间。先决条件：一个标记访问时间的文件系统（通过它自己和它的挂载选项）。
*   又快又脏，b 部分：删除所有 *.py[co] 文件（相同的符号`glob`和`re`符号），运行程序，查看已创建的文件。先决条件：用户应具有对该文件夹的写入权限。

# jquery - 如何使用 jQuery 将 JSON 数据放入 Ruby on Rails？

> ID：907979
> 
> 赞同：15
> 
> 时间：2009-05-25T20:33:58.487
> 
> 标签：jquery, ruby-on-rails, ajax, json

我正在尝试发送如下所示的 jQuery Ajax PUT 请求：

```
$.ajax({
      type: "PUT",
      url: '/admin/pages/1.json',
      data: { page : {...} },
      dataType: 'json',
      success: function(msg) {
        alert( "Data Saved: " + msg );
      }
}); 
```

我的控制器大致如下所示：

```
 respond_to do |format|
         if @page.update_attributes params[:page]
           format.html{ ... }
           format.json{ render :json => {:saved => 'ok'}.to_json }
         else
           format.html{ ... }
           format.json{ render :json => {:saved => 'fail'}.to_json }
         end
       end 
```

但我收到以下错误。

评估 nil.name /Library/Ruby/Gems/1.8/gems/activesupport-2.3.2/lib/active_support/xml_mini/rexml.rb:29:in `merge_element!' /Library/Ruby/Gems/1.8/gems/activesupport-2.3.2/lib/active_support/xml_mini/rexml.rb:18:in`parse' ( **DELEGATION** ):2:in `__send__' (__DELEGATION__):2:in`parse' /时发生错误库/Ruby/Gems/1.8/gems/activesupport-2.3.2/lib/active_support/core_ext/hash/conversions.rb:154:in `from_xml' ... ...

就像 Ruby on Rails 试图将参数解析为 XML，但我想使用 JSON！

我应该怎么做才能将 JSON 放入 Ruby on Rails？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T20:40:15.990

设置 contentType 对我不起作用。我得到一个字符串而不是 params [:page] 的哈希值。

所以我这样解决了：

*使用在 JavaScript 中的 JSON 中*找到的脚本对 JSON 对象进行字符串化：

```
$.ajax({
    type: "PUT",
    url: '/admin/pages/1.json',
    data: { page : JSON.strigify( {...} ) },
    dataType: 'json',
    success: function(msg) {
        alert( "Data Saved: " + msg );
    }
}); 
```

在 Ruby on Rails 方面，必须需要 JSON gem。在控制器中：

```
 params[:page] = JSON.parse params[:page] if params[:page].is_a? String 
```

它一点也不漂亮，但它对我有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T13:41:25.977

您需要在选项中设置 contentType。contentType 是您要发送的内容。dataType 是您所期望的。您应该仔细阅读有关[ajax 的 options 参数的文档](http://docs.jquery.com/Ajax/jQuery.ajax#options)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T09:03:11.727

另外，请注意，但是 Ruby on Rails 2.3.2 中有一个错误阻止了它的工作。请参阅*[Ruby on Rails 2.3 JSON“放置”请求路由已损坏](https://rails.lighthouseapp.com/projects/8994/tickets/2448-rails-23-json-put-request-routing-is-broken)*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-02T18:49:08.437

如果你不想添加脚本，你可以做

```
$.parseJSON("some_jsonish_string") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T03:33:49.687

您需要在选项中设置`contentType`为`"application/json"`；`dataType`只是你所期望的。

此外，您需要`data`使用以下方法序列化您的字段`JSON.stringify`：

```
$.ajax({
    type: "PUT",
    url: '/admin/pages/1.json',
    data: JSON.stringify({ page :  {...} }),
    contentType: 'application/json',
    dataType: 'json',
    success: function(msg) {
        alert( "Data Saved: " + msg );
    }
}) 
```

# apache - 帮助动态 url 的 mod_rewrite 规则

> ID：907982
> 
> 赞同：1
> 
> 时间：2009-05-25T20:35:02.277
> 
> 标签：apache, mod-rewrite, dynamic-url

呃.. mod_rewrite 让我觉得自己很愚蠢。我只是还没想好。：/

我有这个网址：

`http://example.com/a/name/`

...我想在这里指出：

`http://example.com/a/index.php?id=name`

...作为参数`name`传递给的内容在哪里。`index.php``id`

我尝试过的任何结果都会导致 404 或 500 .. :(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T20:55:52.000

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T20:42:16.380

让你开始：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !index.php
RewriteRule ^/?a/([^/]+)/?$ /a/index.php?id=$1 [QSA,L] 
```

如果一个重写教程不适合您，请[尝试另一个](http://www.google.com/search?q=mod_rewrite+tutorial).

编辑：`index.php`根据 Gumbo 的建议排除

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T20:44:44.923

也许类似于

```
`RewriteEngine on
RewriteBase /a/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/?$ index.php?id=$1 [L,QSA]` 
```

`会成功的。`

 `* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T20:48:09.410

我建议你看看这个网址：

[http://www.dracos.co.uk/code/apache-rewrite-problem/](http://www.dracos.co.uk/code/apache-rewrite-problem/)

提出的解决方案将起作用，但 URL 中解释了一些警告，主要是关于 ? 和 # 在 URL 本身中。

# winforms - DataGridView 复制粘贴（带有样式、背景颜色等）

> ID：907986
> 
> 赞同：2
> 
> 时间：2009-05-25T20:36:39.887
> 
> 标签：winforms, excel, datagridview

我有一个带有 DataGridView 的 C# Windows 窗体应用程序。

复制和粘贴（在数据网格中选择数据后按 ctrl-c，在 Excel 中按 ctrl-v）几乎可以正常工作。

问题是样式（例如背景颜色）没有被粘贴到 Excel 中，只有单元格值。我是否需要更改我的 datagridview 某处的属性或实现自定义代码？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-07-14T08:44:51.677

我有同样的问题，并使用`Control.DrawToBitmap`添加位图到剪贴板。首先使用 DataObject，填充来自 DataGridView 的“标准”剪贴板内容，然后添加位图，然后将 DataObject 推送到剪贴板，用户可以使用“特殊粘贴”功能并在位图或纯文本之间进行选择. 就像是：

```
Dim data as New DataObject()  
Dim html As DataObject = DGV.GetClipboardContent()  
data.SetData(DataFormats.Html, html.GetData(DataFormats.Html))  
' create some rectangle, probably using DataGridView.Bounds  
Dim bitmap As New System.Drawing.Bitmap(rectangle.Width, rectangle.Height)  
DGV.DrawToBitmap(bitmap, rectangle)  
data.SetData(DataFormats.Bitmap, bitmap) 
```

也有可能创建一个 RTF 输出，但由于 RTF 代码非常复杂，因此需要做更多的工作。但是，可以找到一些代码示例。

我只是偶然发现了这个使用 Excel 和其他格式的 XML 输出的[示例。](http://www.vb-tips.com/dbpages.aspx?ID=ba70974c-2f8d-495e-8bb0-90c9cb748ae5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T09:45:49.183

AFAIK 影响剪贴板行为的唯一数据网格属性是“ClipBoardCopyMode”，这几乎是“是否使用标题”。除非我不在基地，否则如果您希望格式与它一起使用，您将不得不自己将其放入剪贴板。但老实说，作为用户，我不希望格式化。当我复制东西然后必须重新格式化它们以匹配我当前使用的格式时，它让我发疯。我宁愿粘贴数据，然后如果我想将其格式化为显示的格式，请执行此操作。如果您要自己滚动，我建议您使用 Excel 剪贴板格式，以便您的用户可以“PasteSpecial”值（如果他们愿意）。这可能会给你一些想法： http: [//www.codeguru.com/vb/gen/vb_misc/samples/article.php/c6393](http://www.codeguru.com/vb/gen/vb_misc/samples/article.php/c6393)

# javascript - 谷歌地图：为什么 MarkerCluster 不起作用？

> ID：907989
> 
> 赞同：0
> 
> 时间：2009-05-25T20:39:44.513
> 
> 标签：javascript, google-maps

一开始我想说：我找不到这个库的支持论坛，所以我想在这里试试。我希望在这里允许这样的问题，并且不需要删除指向我页面的链接。该链接仅用于查看其工作原理以及哪些部分不起作用。请不要删除它。

现在的问题:)

我想使用库“MarkerClusterer”（[谷歌代码页面](http://code.google.com/p/gmaps-utility-library/)）通过 API 将我的标记聚集在谷歌地图上。这里描述了它是如何工作的： [文档 -> 示例](http://gmaps-utility-library.googlecode.com/svn/trunk/markerclusterer/1.0/docs/examples.html)

不幸的是，它在我的网站上不起作用，我不知道为什么。请你帮助我好吗？我在我的代码中找不到错误：

[链接（仅作为演示）](http://www.twem.de/news_karte.php)

你能找出错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T06:45:19.220

我在 Firebug 中收到此错误：

```
GOverlay is not defined
ClusterMarker_.prototype = new GOverlay(); 
```

这可能是由于在 Google Maps 完成加载之前运行您的初始化函数引起的。尝试删除重复的标签：

```
<div class="clear"></div>
<body onload="initialize()" onunload="GUnload()">
48<div class="grid_12"> 
```

当您使用 MarkerCluser 时，我认为您不应该将每个标记添加到地图中。尝试删除此 pr 标记：

```
map.addOverlay(markierung1); 
```

# sqlite - Mac 网络上的 SQLite 中的“数据库已锁定”错误

> ID：907993
> 
> 赞同：2
> 
> 时间：2009-05-25T20:41:20.173
> 
> 标签：sqlite, file-locking

我使用 SQLite（实际上是 PySQLite）创建了一个简单的数据库。当我从本地机器（即windows机器驱动器上的程序和数据库文件）查询或写入数据库时​​，它工作正常。但是，当我将数据库文件复制到我的网络驱动器（时间胶囊）时，Windows 机器虽然可以看到这些文件并且对驱动器具有完全的读/写访问权限，但甚至给我一个“SQL 错误：数据库已锁定”执行简单选择时！

从 Mac 上通过网络查询可以正常工作。

没有花哨的多访问——只有一台机器打开了数据库。似乎是一些奇怪的 Mac 网络问题。在 Python 程序或 SQLite3 命令行中发生。我正在使用 SQLite 3.6.14.2。

有人看到这个问题吗？有什么办法解决吗？真的不想使用 MYSQL，因为这是一个简单的单用户程序，但我想在多台机器上使用它。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-11T07:47:45.923

我不知道它是否可以在 MAC 上完成，在 Debian 上我必须使用**nobrl**选项挂载 samba 目录。

来自 mount.cifs(8)：

```
 nobrl
      Do not send byte range lock requests to the server. This is
      necessary for certain applications that break with cifs
      style mandatory byte range locks (and most cifs servers do
      not yet support requesting advisory byte range locks). 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T14:49:01.540

阅读 sqlite 常见问题解答：[http ://www.sqlite.org/faq.html#q5](http://www.sqlite.org/faq.html#q5)

> “有很多 Windows 经验的人告诉我，网络文件的文件锁定非常有问题，而且不可靠。如果他们说的是真的，在两台或多台 Windows 机器之间共享 SQLite 数据库可能会导致意想不到的问题。”

所以它在 Windows 上不起作用，它不告诉 MAC。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T20:49:31.593

可能它无法通过网络锁定文件，我认为您使用 SMB 协议，因此该软件包带有错误。如果您想通过网络使用 SQLite，请参阅[SQLite Network](http://www.sqlite.org/cvstrac/wiki?p=SqliteNetwork)以获取替代方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T21:25:33.033

[我遇到了类似的问题](https://stackoverflow.com/questions/679162/why-does-windows-give-an-sqlite3-operationalerror-and-linux-does-not/680390#680390)，我通过安装更新​​的 sqlite 版本解决了它。从 Python 2.6 开始，这个问题也消失了，因为它使用了更新的 sqlite dll。

# c# - 过滤字符串

> ID：907995
> 
> 赞同：19
> 
> 时间：2009-05-25T20:42:17.910
> 
> 标签：c#, string, filtering

我想确保一个字符串只有这个范围内的字符

[az] && [AZ] && [0-9] && [-]

所以所有字母和数字加上连字符。我试过这个...

C# 应用程序：

```
 char[] filteredChars = { ',', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '_', '+', '=', '{', '}', '[', ']', ':', ';', '"', '\'', '?', '/', '.', '<', '>', '\\', '|' };
        string s = str.TrimStart(filteredChars); 
```

这个 TrimStart() 似乎只适用于没有其他字符的字母，如 $ % 等

我执行错了吗？有更好的方法吗？

我只是想避免遍历每个字符串的索引检查，因为会有很多字符串要做......

想法？

谢谢！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-25T20:46:24.967

这似乎是使用[正则表达式](http://www.regular-expresions.info)的完全正当理由。

```
bool stringIsValid = Regex.IsMatch(inputString, @"^[a-zA-Z0-9\-]*?$"); 
```

为了回应 miguel 的评论，您可以这样做以删除所有不需要的字符：

```
string cleanString = Regex.Replace(inputString, @"[^a-zA-Z0-9\-]", ""); 
```

请注意，插入符号 ( `^`) 现在放置*在*字符类中，因此将其取反（匹配任何不允许的字符）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-25T21:16:51.990

这是使用 LINQ 的一种有趣的方法——没有丑陋的循环，没有复杂的 RegEx：

```
private string GetGoodString(string input)
{
   var allowedChars = 
      Enumerable.Range('0', 10).Concat(
      Enumerable.Range('A', 26)).Concat(
      Enumerable.Range('a', 26)).Concat(
      Enumerable.Range('-', 1));

   var goodChars = input.Where(c => allowedChars.Contains(c));
   return new string(goodChars.ToArray());
} 
```

喂它“你好，世界？123！” 它将返回“Helloworld123”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-25T20:44:25.800

为什么不直接使用替换呢？Trimstart 只会删除列表中的前导字符...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-25T20:57:03.700

尝试以下

```
public bool isStringValid(string input) {
  if ( null == input ) { 
    throw new ArgumentNullException("input");
  }
  return System.Text.RegularExpressions.Regex.IsMatch(input, "^[A-Za-z0-9\-]*$");
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T20:56:15.230

我敢肯定，再花一点时间，您就可以想出更好的东西，但这会给您一个好主意：

```
public string NumberOrLetterOnly(string s)
{
    string rtn = s;
    for (int i = 0; i < s.Length; i++)
    {
        if (!char.IsLetterOrDigit(rtn[i]) && rtn[i] != '-')
        {
            rtn = rtn.Replace(rtn[i].ToString(), " ");
        }
    }
    return rtn.Replace(" ", "");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-01T15:25:15.957

我已经在 Linqpad 5 中测试了这两种解决方案。它们的好处是它们不仅可以用于整数，还可以用于带有数字小数分隔符的小数/浮点数，这取决于文化。例如，在挪威，我们使用逗号作为小数分隔符，而在美国，使用点。逗号在那里用作千位分隔符。无论如何，首先是 Linq 版本，然后是 Regex 版本。最简洁的一点是访问 Thread 的数字分隔符的静态属性，但您可以使用代码顶部的 static 对其进行压缩，或者更好 - 将此类功能放入 C# 扩展方法中，最好使用任意正则表达式模式进行重载。

```
string crappyNumber = @"40430dfkZZZdfldslkggh430FDFLDEFllll340-DIALNOWFORCHRISTSAKE.,CAKE-FORFIRSTDIAL920932903209032093294faøj##R#KKL##K";

string.Join("", crappyNumber.Where(c => char.IsDigit(c)|| c.ToString() == Thread.CurrentThread.CurrentCulture.NumberFormat.NumberDecimalSeparator)).Dump();

new String(crappyNumber.Where(c => new Regex($"[\\d]+{Thread.CurrentThread.CurrentUICulture.NumberFormat.NumberDecimalSeparator}\\d+").IsMatch(c.ToString())).ToArray()).Dump(); 
```

请注意上面的代码，Dump() 方法将结果转储到 Linqpad。您的代码当然会跳过最后一部分。另请注意，我们将其归结为单行，但它仍然有点冗长，可以按照建议放入 C# 扩展方法中。

此外，与 string.join 不同，newing 一个新的 String 对象语法更紧凑，更不容易出错。

我们得到了一个糟糕的数字作为输入，但最终我们设法得到了我们的数字！它在 C# 中具有文化意识！

# c# - 为 IEnumerable 中的方法编写匿名方法

> ID：907996
> 
> 赞同：0
> 
> 时间：2009-05-25T20:42:18.813
> 
> 标签：c#, linq

我有以下代码（调用返回 IEnumerable 的方法）：

```
 FibonacciWithLinq.Skip(delegate() {

                                          return 5;

    }
        ); 
```

skip 的参数采用 int（要跳过的项目数）。我可以有一个单独的函数来确定这个数字（它可能取决于某些因素）。但是，如果该方法将被 Skip() 方法使用，那么最好将其编写为 anon 方法。问题是，在上面的代码中，我收到了这个错误：

无法从用法中推断出类型参数。尝试明确指定类型参数。

但我看不出上面的代码有什么问题。我能做些什么？我很确定可以为上述场景编写一个匿名方法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T21:11:47.927

“值”和“没有参数返回值的函数”之间没有自动转换（我们称之为 a `Func<T>`），也没有相反方向的自动转换。

要将 a`Func<T>`转换为值 ，`T`您必须`()`在其后面加上。要将值转换为 a `Func<T>`，可以放在`() =>`它前面。

如果你想调用一些接受 a 的方法`Func<T>`，你不能直接给它传递一个值，所以你必须把那个值转换成 a `Func<T>`，然后你可以把它放在`() =>`它前面。

如果要调用某个接受值的方法，则不能直接将其传递 a `Func<T>`，因此必须通过将其`Func<T>`转换为值`()`。

有些语言会自动在这些东西之间进行转换，但 C# 不会。

在您的情况下，您有一个接受值的函数，并且您试图将其传递给函数，即使您已经有一个值，所以除了将值赋予函数之外，您不需要做任何特别的事情.

```
int val = 5;               // value
Func<int> f = () => val;   // convert value to function
int val2 = f();            // convert back to value 
```

“匿名方法”语法只是丑陋的旧方法。您尝试做的事情有两个问题（除了它是不必要的事实之外）。

`new Func<int>(...)`首先，您需要通过使用包装器显式声明委托类型来为编译器提供类型提示。

其次，您需要`()`在它之后添加才能获得价值。

```
FibonacciWithLinq.Skip(new Func<int>
                       (delegate() 
                       {
                           return 5;
                       })()); 
```

但这怎么强调都不过分——这完全没有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T20:53:02.037

如果你有一些东西可以决定要跳过多少，只需写：

```
FibonacciWithLinq.Skip(HowManyToSkip()) 
```

或者您是否希望它以不同的方式参数化，例如：

```
Func<int, IEnumerable<int>> skipper = x => FibonacciWithLine.Skip(x);
foreach (var i in skipper(5)) Console.WriteLine(i); 
```

您问题中的代码是传入一个方法而不是一个常量 int 值，这正是 Skip 想要的。也许您想跳过序列返回的值：如果是这样，Except() 扩展方法就是您想要的：

```
FibonacciWithLinq.Except(x => (x == 5 || x == 7)); 
```

请注意，lambda 语法只是以下简称：

```
FibonacciWithLinq.Except(delegate(int x) { return x==5||x==7; }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-25T20:54:45.170

如果您想跳过将函数作为参数，那么您需要编写一个扩展来执行此操作，然后您可以使用委托或 lambda 提供一个可以评估的函数以跳过您想要省略的元素。

```
public static class IEnumerableExtensions
{
    public static IEnumerable<T> Skip( this IEnumerable<T> source, Func<int> toSkip )
    {
         return source.Skip( toSkip() );
    }
}

FibonacciWithLinq.Skip( () => { return 5; } ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T20:45:10.697

除非我弄错了，否则正确的代码就是：

```
FibonacciWithLinq.Skip(5); 
```

编辑::*哦*，你想要间接只是为了间接。我假设 5 级间接就足够了，因为我们跳过了 5 个元素？如果您需要更多，请告诉我...

```
IEnumerable<int> FibannociSkip = new int[]{0, 1, 1, 2, 3, 5};
Func<Func<Func<Func<Func<int>>>>> f = ()=>(()=>(()=>(()=>(()=>5))));
foreach(var num in FibannociSkip.Skip(f()()()()()))
    Console.WriteLine(num); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T21:09:48.603

```
Func<int> f = () => 5;
FibonacciWithLinq.Skip(f()); 
```

# java - 两地之间的物理距离

> ID：907997
> 
> 赞同：9
> 
> 时间：2009-05-25T20:43:17.487
> 
> 标签：java, php, string, distance

我需要测量名称以字符串形式提供的两个地方之间的物理距离。由于有时名称的写法略有不同，我一直在寻找一个可以帮助我测量差异的库，然后将其与纬度和经度的测量相结合以选择正确的匹配项。首选语言：Java 或 PHP。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-25T20:45:11.117

看看[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)。这是一种衡量两个字符串彼此之间差异程度的方法。

希望我正确理解了您的问题；在与“纬度和经度”相同的句子中使用“距离”可能会造成混淆！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-25T20:59:10.263

虽然是用 c 编写的（使用 python 和 tcl 绑定），[但 libdistance](http://www.monkey.org/~jose/software/libdistance/)将是一个在字符串/数据上应用多个距离度量的工具。

指标包括：

*   盛开
*   达默劳
*   欧几里得
*   汉明
*   杰卡德
*   莱文斯坦
*   曼哈顿
*   明考斯基
*   needleman_wunsch

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T21:50:00.673

我冒昧地将我为计算 Levenshtein 距离而编写的一段 C# 代码翻译成 Java 代码。它只使用两个交替的一维数组，而不是一个大的锯齿状数组：

```
public static int getDifference(String a, String b)
{
    // Minimize the amount of storage needed:
    if (a.length() > b.length())
    {
        // Swap:
        String x = a;
        a = b;
        b = x;
    }

    // Store only two rows of the matrix, instead of a big one
    int[] mat1 = new int[a.length() + 1];
    int[] mat2 = new int[a.length() + 1];

    int i;
    int j;

    for (i = 1; i <= a.length(); i++)
        mat1[i] = i;

    mat2[0] = 1;

    for (j = 1; j <= b.length(); j++)
    {
        for (i = 1; i <= a.length(); i++)
        {
            int c = (a.charAt(i - 1) == b.charAt(j - 1) ? 0 : 1);

            mat2[i] =
                Math.min(mat1[i - 1] + c,
                Math.min(mat1[i] + 1, mat2[i - 1] + 1));
        }

        // Swap:
        int[] x = mat1;
        mat1 = mat2;
        mat2 = x;

        mat2[0] = mat1[0] + 1;
    }

    // It's row #1 because we swap rows at the end of each outer loop,
    // as we are to return the last number on the lowest row
    return mat1[a.length()];
} 
```

它没有经过严格的测试，但似乎可以正常工作。它基于我为大学练习制作的 Python 实现。希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-25T22:22:42.857

您可能会使用[语音算法](http://en.wikipedia.org/wiki/Phonetic_algorithm)找到一些拼写错误的名称，从而获得一些不错的结果。

此外，如果您使用更机械的编辑距离，您可能会使用考虑键盘几何形状的加权函数看到更好的结果（即物理上靠近的键比远离的键“更便宜”替换）。顺便说一句，这是一种专利方法，所以要小心不要写太流行的东西；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-25T21:01:04.127

我在 Java 中找到[了 SumMetrics](http://www.dcs.shef.ac.uk/~sam/simmetrics.html)，但没有使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T13:34:42.840

我会推荐[Levenshtein Distance](http://en.wikipedia.org/wiki/Levenshtein_distance)或[Jaccard Distance](http://en.wikipedia.org/wiki/Jaccard_distance)来比较文本。`********