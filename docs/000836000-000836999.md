# StackOverflow 问答 000836000-000836999

# javascript - javascript灯箱效果

> ID：836003
> 
> 赞同：2
> 
> 时间：2009-05-07T17:30:00.960
> 
> 标签：javascript, lightbox

我的 JavaScript 代码有问题。我从互联网上复制了“灯箱”的代码（只是没有黑色背景）。它在 Firefox、Safari 中有效，但由于某种原因在 IE 中无效。
您可以在我的作品集网站的第二页 svetlana-konetskaia.com/final 上看到这个问题。你能提出什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:16:56.467

当涉及到带有 href 和 onclick 的链接时，IE 是挑剔的。返回错误；不足以覆盖链接的默认操作，即导航离开页面。

添加

```
event.returnValue = false; 
```

到你的每一个链接之前都返回false；在 onclick 函数中。

像这样：

```
<div id="picture_1"><a href="images/surrealists_large.png" onClick="dv.showDV(surrealists); event.returnValue = false; return false"><img src="images/surrealists_small.png" /></a></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T18:16:37.113

当我尝试使用您的灯箱时，我收到与不存在的标准体变量相关的错误。这是在特定于 IE 的代码块中，但我不清楚您是否编写了代码，或者它是否是您复制的灯箱代码的一部分。

无论哪种方式，如果您想让您的灯箱工作，您需要弄清楚为什么您的代码期望该变量存在（更重要的是，为什么它不存在）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T17:29:01.427

如果您正在寻找 lightwindow 效果，只是没有停电......为什么不使用 lightwindow 之类的东西，它可以让您显示几乎任何媒体类型。

[http://www.stickmanlabs.com/lightwindow/](http://www.stickmanlabs.com/lightwindow/)

# java - Java 小程序网络连接

> ID：836007
> 
> 赞同：3
> 
> 时间：2009-05-07T17:31:04.247
> 
> 标签：java, applet

当我的小程序在网络浏览器中运行时，它被阻止进行任何外部网络连接。是否可以更改任何设置以允许它建立连接？

从桌面运行时它工作正常，但在浏览器中它会限制它。

谢谢

〜凯尔G

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T17:43:21.067

小程序可以连接回下载它们的服务器（“同源策略”）。从 6u10 他们还可以访问具有适当`crossdomain.xml`文件的站点（谷歌搜索）。

随机允许访问任何站点显然不利于安全。您可以签署您的代码并让插件允许用户删除安全性。但是，这需要您了解安全性才能安全地进行操作（大多数人不知道）。对于“不错的”安全对话框，您需要由受信任的证书颁发机构签名的证书。

另一种选择是让您的网络服务器机器在连接上转发。但是，要安全地做到这一点又很棘手。

# asp.net-mvc - 如何在带有 VB.NET 的 ASP.NET MVC 中添加 id HTML 属性

> ID：836015
> 
> 赞同：7
> 
> 时间：2009-05-07T17:32:33.620
> 
> 标签：asp.net-mvc, vb.net

我正在尝试使用 ASP.NET MVC 和 VB.NET 将 ID HTML 属性添加到表单

```
<%Html.BeginForm("Create", "Model", "", "", New With {.id = "CreateForm"})%> 
```

这给了我一个类型错误，因为 .id 需要一个整数，而不是字符串。如何向我的表单添加 ID 属性？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-07T17:53:03.413

我相信你需要这样的东西

```
<%  Html.BeginForm("Create", "Model", 
    FormMethod.Post, New With {.id = "CreateForm"})%> 
```

我认为它正在尝试将您的一个空字符串转换为 FormMethod 枚举，这将无法正确转换。

无论哪种方式，请检查此链接，它具有 BeginForm 方法的所有重载。

[Html.BeginForm](http://msdn.microsoft.com/en-us/library/dd460542.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T17:38:05.043

关闭：

```
<%Html.BeginForm("Create", "Model", "", "", new {id = "CreateForm"})%> 
```

# vb.net - VB.NET，通过宏调用带参数的可执行文件

> ID：836018
> 
> 赞同：0
> 
> 时间：2009-05-07T17:33:11.293
> 
> 标签：vb.net, macros, executable, parameters

我有一个使用宏的应用程序。

在这个宏中，我想像这样调用一个外部可执行文件：

```
SYSTEM( "C:\Programme\Transform.exe" , 
        "C:\Programme\Vectors.txt" , 
        "C:\Programme\Vectors_Compensate.txt", 
        "C:\Programme\Vectors_Final.txt" ) 
```

该可执行文件根据模板文件重建修改后的文件。最后，创建一个新文件。

Transform.exe 打开一个表单，询问路径 - 模板文件 - 修改文件 - 您要放置新重建文件的位置。

在此之后，您按开始。

当您调用该命令行时，我希望

```
SYSTEM( "C:\Programme\Transform.exe" , 
        "C:\Programme\Vectors.txt" , 
        "C:\Programme\Vectors_Compensate.txt", 
        "C:\Programme\Vectors_Final.txt" ) 
```

该参数将放在表单中的位置。

我怎样才能做到这一点 ？？？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T19:48:35.537

`enter code here`我找到了 ：

```
 Dim cmdLine As String
            Dim Parms() As String ' if the paramters are strings - declare this as necessary
            cmdLine = Command$()  ' Command$ would return "Parms1 Parms2 Parms3"

            Parms = Split(cmdLine, " ")

            'This section filled the form textbox.
            TextBoxTemplate.Text = Parms(0)
            TextBoxModify.Text = Parms(1)
            TextBoxFinal.Text = Parms(2) 
```

# flash - 使用 flash 或 java servlet 将麦克风数据从浏览器上传到服务器的教程？

> ID：836024
> 
> 赞同：2
> 
> 时间：2009-05-07T17:34:55.097
> 
> 标签：flash, http, servlets, microphone

有一个关于如何通过 HTTP 浏览器从客户端上的麦克风获取数据到服务器的问题，答案是“使用 flash 或者可能是 java ~~servlet~~ applet”。很好，但是怎么做？那里有示例代码或教程吗？可以用普通服务器完成还是我需要 adobe 媒体服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T06:50:08.627

我相信答案真的是“使用 flash 或者可能是 java applet”，而不是“java servlet”。对于您的问题，您必须实现两件事：

*   在用户浏览器中运行的客户端应用程序，它捕获音频，然后连接到远程服务器以上传文件。
*   接受上传文件的 Web 应用程序。

客户端应用程序必须在浏览器的插件技术中实现，因为不可能直接从浏览器录制音频。这可以通过 Flash 或 Java Applet 完成。这些不是唯一的选择，但它们是最常见的选择。

有关访问麦克风的 ActionScript 代码，请参阅此[链接](http://russellgreenspan.blogspot.com/2009/01/microphone-access-in-silverlight-via.html)。该 blogspot 还有趣地描述了您对 Silverlight 的选择。

对于 Java，这是一个录音[教程。](http://www.developer.com/java/other/article.php/2105421)您需要创建一个小程序，这并不难。一个棘手的问题是您可能需要“签名”您的小程序才能访问用户机器上的麦克风。

对于服务器端，您可以使用任何服务器技术，并且绝不需要 adobe 媒体服务器。例如 PHP、Java (Tomcat)、ASP.NET。文件上传部分你甚至可以只用一个 Apache Web 服务器来完成。您只需将其配置为允许文件上传。

**更新：**

我同意你的评论，即闪存将是最好的解决方案。您可以在网上找到许多使用 ActionScript 访问麦克风的示例。这是我很快发现的：

*   [麦克风对象](http://www.adobe.com/support/flash/action_scripts/actionscript_dictionary/actionscript_dictionary479.html)
*   [使用麦克风教程](http://www.kirupa.com/developer/actionscript/microphone.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T17:06:01.790

您将需要使用闪存媒体服务器。您可以从 adobe.com 下载它。它可免费用于 10 次并发使用。[您可以在http://www.flashcomguru.com/tutorials/](http://www.flashcomguru.com/tutorials/)找到教程，并且可以使用 www.influxis.com 来托管您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T01:18:28.360

我最近发布了一个可能适用于此处[的类似问题的答案。](https://stackoverflow.com/questions/651796/recording-audio-via-the-web-for-an-intranet-solution)

据我所知，[Flash 10 和对声音对象字节流的新访问可能是可能的](http://bkendall.biz/2009/05/recording-web-audio/)，但还没有人这样做。我自己不是 Flash 程序员，但如果您或其他任何人想尝试破解这个问题，我愿意帮助处理服务器组件。

# c# - 如何在运行时使用 C# 创建强类型数据集？

> ID：836025
> 
> 赞同：0
> 
> 时间：2009-05-07T17:34:56.157
> 
> 标签：c#, code-generation, strongly-typed-dataset

我需要在运行时为用户首选的目标数据库创建一个强类型数据集。Visual Studio 为创建类型化数据集提供了大量的设计时间支持。我需要在运行时自动化为目标数据库生成类型化数据集的过程。

它应该创造...

1.) XSD 文件。

2.) 代表数据库的类型化数据集

3.) 所有数据库表和表中列的类型化包装器。

4.) 每个表的 TableAdapters。

所以我需要在运行时生成相同的类型化数据集，这通常是在设计时使用 Visual Studio 的类型化数据集设计器创建的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T17:37:15.917

您可能可以使用`XSD.EXE`. 从您的程序中启动它...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T17:45:50.717

我倾向于同意 jcollum 的观点，在运行时使用类型化数据集可能是错误的方法。另一方面，如果您只想在运行时从数据库中获取结构化数据（也称为 DataTable），则可以使用反射从任意数据结果创建 TableAdapter。

```
var results = (from data in db.SomeTable select data).ToArray();
DataTable dt = ObjectArrayToDataTable(results);
// At this point you have a properly structure DataTable.

// Here is your XSD, if absolutely needed.
dt.WriteXMLSchema("c:\somepath\somefilename.xsd");

private static System.Data.DataTable ObjectArrayToDataTable(object[] data)
{
    System.Data.DataTable dt = new System.Data.DataTable();
    // if data is empty, return an empty table
    if (data.Length == 0) return dt;

    Type t = data[0].GetType();
    System.Reflection.PropertyInfo[] piList = t.GetProperties();

    foreach (System.Reflection.PropertyInfo p in piList)
    {
        dt.Columns.Add(new System.Data.DataColumn(p.Name, p.PropertyType));
    }

    object[] row = new object[piList.Length];

    foreach (object obj in data)
    {
        int i = 0;
        foreach (System.Reflection.PropertyInfo pi in piList)
        {
            row[i++] = pi.GetValue(obj, null);
        }
        dt.Rows.Add(row);
    }

    return dt;
} 
```

您可以应用相同的主体来创建结构化 DataSet 并轻松地为其创建 DataAdapter。

或者，也许我误读了您的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T17:37:33.653

鉴于我过去使用类型化数据集的经验——以及所有伴随的失败和问题——我强烈建议您使用 ORM 映射器进行调查。换句话说，远离类型化数据集。

# asp.net - 让 ASP.NET 页面按时间间隔运行的最佳方法？

> ID：836028
> 
> 赞同：2
> 
> 时间：2009-05-07T17:35:02.320
> 
> 标签：asp.net

我制作了这个应用程序，它需要从fogbugz 输入时间并将它们发布到basecamp，但是现在它必须手动运行。我需要让它每周或每晚运行一次，最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T17:38:00.237

创建[计划任务](http://technet.microsoft.com/en-us/appcompat/aa906020.aspx)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T17:39:22.997

IMO，最好的方法是编写一个执行计划任务的 Web 服务。并开发一个 Windows 服务，它将根据您的日程安排调用您的 Web 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T17:50:40.037

请求 ASP.NET 页面的客户端是什么，它对响应做了什么？最有可能的答案是没有客户，也没有太多回应。

抛开“那为什么它是一个 ASP.NET 页面”之类的响应。一些常见的方法是： -

1.  使用计划任务，但需要外部配置。
2.  不要使用 ASP.NET，而是创建一个服务来执行任务，但那是更多的外部配置

可以包含在 Web 应用程序中的一种方法是将一些虚拟对象添加到具有指定有效期的缓存中，不允许缓存自己的算法进行任意删除，并且在删除项目时设置回调方法。

一个简单但完全有缺陷的方法是在您希望执行操作时设置项目的到期时间。然而，更好的方法是使用更短的到期间隔，然后在每次到期时检查数据库记录，以查看操作是否需要执行和/或重新建立缓存中的项目。

您可能会使用指示其正在处理的标志以事务方式执行此数据库测试。这种方法将允许 Web Gardens 和 Farms 不会在尝试全部执行相同任务时相互绊倒。

在应用程序启动时，您还可以在第一次在缓存中建立项目之前检查数据库以查看任务是否需要执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T17:47:44.537

我将创建一个小的 Windows 服务，它只使用一个简单的 WebRequest 加载页面。另一种方法是在 global.asax 的 Application_Start 事件中创建一个后台线程。这种方法有很多链接，例如：

[在 IIS 中管理后台线程有哪些最佳实践？](https://stackoverflow.com/questions/655012/what-are-some-best-practices-for-managing-background-threads-in-iis)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T17:50:29.427

++ 关于 Canavar 和 gattaca 的评论，但我会避免后台线程问题。我听说有时这些线程可以被回收，并且由于您的应用程序没有重新启动，它们会变成虚无。我在这里可能是错的。无论哪种方式，写入 Windows 服务的内存和性能都比较稳定……除非您在一个不允许您安装服务的共享主机上。

# ruby-on-rails - 测试控制器时禁用渲染

> ID：836034
> 
> 赞同：2
> 
> 时间：2009-05-07T17:36:34.470
> 
> 标签：ruby-on-rails, tdd, rspec, shoulda

我正在使用 Test::Unit 和 shoulda 来测试控制器。

因为我只是在测试控制器，所以我不想渲染视图。

我正在存根一些对象，在渲染视图时会抛出一些错误，但测试不应该失败，因为控制器是正确的。

那么，有什么方法可以从我的测试中禁用模板/视图的呈现？

我听说 rSpec 就是这样工作的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T14:46:46.153

如果您使用的是 Mocha，这很容易。将此添加到您的个人测试或设置方法中：

```
@controller.expects(:render) 
```

如果你不是，那么，使用摩卡。

```
gem install mocha 
```

然后在你的 test_helper.rb

```
require 'mocha' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-18T16:24:18.963

你不应该在你的测试中看到任何视图。您可以发布失败的测试代码吗？控制器（功能）测试应该只检查调用您的操作时是否正在发生特定操作。即它应该检查它是否呈现正确的视图或重定向到不同的动作。您还可以检查闪光灯的设置或视图的其他变量。这是您要测试的类型吗？

这是一个使用从 shoulda 文档获取的 get 请求来测试 show 动作的好例子：

```
class UsersControllerTest < Test::Unit::TestCase
  context "on GET to :show" do
    setup { get :show, :id => 1 }

    should_assign_to :user
    should_respond_with :success
    should_render_template :show
    should_not_set_the_flash

    should "do something else really cool" do
      assert_equal 1, assigns(:user).id
    end
  end
end 
```

也许看看[rails guides](http://guides.rubyonrails.org/testing.html#functional-tests-for-your-controllers)，它也很不错。

# c++ - c++重载`-`

> ID：836035
> 
> 赞同：0
> 
> 时间：2009-05-07T17:36:36.230
> 
> 标签：c++, operator-overloading

我已经为我的类图将运算符重载为“-”。它的使用并不完全直观（糟糕的编码 - 我知道）但如果我这样做 graph3 = graph2-graph1 那么图 3 应该只接收图 2 和图 1 中的那些顶点。

所以，我已经编写了代码，当我运行调试器时，操作函数似乎创建了一个新的“图”来返回，并将适当的顶点添加到新图，然后调试器似乎退出了操作函数，但永远不会让它回到主。就好像它在等我输入什么一样。不会出现错误消息。

这是代码：

```
char stringy[100];
//cin>>stringy;
strcpy(stringy,"|12,34,25,2,3,2|(3->2),(2->1),(5->9),(2->1)|");
char* param= new char[sizeof(stringy)];
strcpy(param,stringy);
Graph graph1(param);

 char sstring[20] = "|33,34,11|(2->33)|";
Graph graph2(sstring);
cout<<graph2.outSumm()<<endl;

Graph graph3;
//until here everything works fine
graph3= graph1-graph2; //the debugger does this and then 

cout<<graph3.outSumm()<<endl; 
```

操作员功能：

```
Graph Graph::operator- (const Graph& g2) const
{
Graph created;

//goes through "this" list and if value exists in g2 copies it to created
for(int i=0;i<vertList.getSize();i++)
{
 if (g2.vertList.find(vertList.read(i))!=999)
 created.addVertex(vertList.read(i).getInt());
}

return created;
} 
```

我正在使用代码块。

复制构造函数：

```
Graph(const Graph& g2):      
maxVal(g2.maxVal),vertList(g2.vertList),edgeList(g2.edgeList){} ; 
```

赋值运算符：

```
void Graph::operator= (const Graph& g2)
{
 if (this==&g2)
 {
 cout<<"not the greatest idea"<<endl;
 return;
 }

 vertList.delete_List();
 edgeList.delete_List();
 maxVal=0;

addValues(g2.outSumm());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T17:48:38.357

听起来您的代码处于无限循环中。当程序似乎停止时，您是否尝试过中断调试器？

您是否在 Graph 类中定义了复制构造函数？您需要它才能使用局部`created`变量成功返回值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T17:40:45.130

与您的问题没有特别相关（尽管可能），您为什么不使用 std::string？如果你必须使用字符数组，为什么不：

```
char stringy[100] = "|12,34,25,2,3,2|(3->2),(2->1),(5->9),(2->1)|";
Graph graph1( stringy ); 
```

甚至：

```
Graph graph1( "|12,34,25,2,3,2|(3->2),(2->1),(5->9),(2->1)|" ); 
```

或者您是否将传递给类中构造函数的指针存储？如果是这样，那是个坏主意，我对使用 std::strings 的建议加倍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T18:21:37.370

而不是实现 operator-，而是实现 operator-=：

```
Graph& Graph::operator-=(const Graph& rhs)
{
    // remove nodes not in both Graphs

    return *this;
} 
```

然后就这样实现 operator- ：

```
Graph Graph::operator-(const Graph& rhs)
{
    Graph temp(*this);
    temp -= rhs;
    return temp;
} 
```

看看这是否有效。

# .net - .Net 1.0 和 2.0 混合应用程序

> ID：836038
> 
> 赞同：1
> 
> 时间：2009-05-07T17:37:01.237
> 
> 标签：.net, .net-2.0, clr, .net-1.1

我有一个带有 dll 的 .Net 应用程序，其中一些是用 .Net 1.1 编译的，有些是用 2.0 编译的。这样一个应用程序是如何工作的——一个应用程序不是只有一个运行时吗？如果有，那是哪一个？如果不是，如何在运行时之间传递对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T17:40:12.773

您说得对，应用程序中只使用了一个运行时。在您的情况下，整个应用程序需要使用 2.0 运行时：1.1 运行时无法理解 2.0 DLL，但 2.0 运行时确实知道 1.1 DLL。

# asp.net-mvc - 如果这样配置，asp.net RoleManager 是否真的在 cookie 中缓存用户的角色？

> ID：836043
> 
> 赞同：3
> 
> 时间：2009-05-07T17:37:58.397
> 
> 标签：asp.net-mvc, roleprovider

在我的 web.config 中，我将角色管理器配置如下：

```
<roleManager enabled="true" cacheRolesInCookie="true" cookieName=".ASPROLES" 
cookieTimeout="30" cookiePath="/" cookieRequireSSL="false" 
cookieSlidingExpiration="true" cookieProtection="All"> 
```

但是，在我们的自定义 RoleProvider 中，似乎总是调用 GetRolesForUser 方法，而不是像我预期的那样， RoleManager 从其 cookie 中提供角色。

我们正在使用类似的东西来获取用户的角色：

```
string[] myroles = Role.GetRolesForUser("myuser"); 
```

我在配置中或在使用 RoleManager 时是否缺少某些东西

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-11-22T13:12:00.583

`defaultProvider="yourRoleProviderName"`您的 web.config中缺少您。

您是否为任何用户或仅为当前用户调用以下方法？Cookie 缓存仅适用于当前用户角色。

```
Role.GetRolesForUser("myuser"); 
```

`IsInRole`在第一次调用or`GetRoles`方法后检查 .ASPROLES cookie 是否发送到浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T17:42:32.520

如果您将 to 中的值更改`cacheRolesInCookie`为`true`.

# session - 从 iframe 应用程序刷新 Facebook 会话

> ID：836046
> 
> 赞同：13
> 
> 时间：2009-05-07T17:38:05.213
> 
> 标签：session, iframe, facebook

我有一个完全外部的 Facebook iframe 应用程序。我的意思是，一旦用户访问画布 URL 以加载应用程序，iframe 应用程序中的所有链接都会转到我的服务器，并且画布页面永远不会刷新，除非用户导航到 Facebook 上的其他地方并返回（或是否刷新浏览器）。

在 Facebook 创建 iframe 的应用程序的初始加载中，我获得了所有常用参数，例如 fb_sig_user，它允许我基于 facebook 用户创建内部应用程序会话。这个应用程序会话（*不是*Facebook 会话，它是我自己的应用程序会话）是允许用户使用该应用程序所需的全部内容。

一个小时后问题来了。如果用户离开计算机或使用应用程序超过一个小时，Facebook 会话就会过期。有一些应用页面需要获取好友信息，一旦 FB 会话过期，这些页面就会中断，抛出诸如“错误：会话密钥无效或不再有效”之类的错误。

我的问题是是否有办法从 iframe 应用程序中刷新用户的 Facebook 会话，以防止它在一小时后过期。是否有任何 API 调用执行此操作？是否有一个 Facebook Connect 技巧来 ping 某些东西？有没有确定的方法让它保持活力？我还没有找到任何专门解决这个问题的例子。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-07T23:32:55.453

胜利是我的！

有一个几乎完全没有记录的 Facebook 功能处理 iframe 会话，我在研究中发现了一个[模糊的参考](http://wiki.developers.facebook.com/index.php/PHP_Sessions)。然而，这个页面并没有很好地解释它，只有在我的 iframe 中观看各种会话密钥几个小时后，我才能够弄清楚发生了什么。

`fb_whatever`以前，当初始 iframe 加载发生时，我的 iframe 应用程序正在接收通常的一轮参数。所以在我的应用程序中，我对每个请求都这样做：

```
if (isset($_REQUEST['fb_sig_session_key'])) {
    $_SESSION['fb_sig_session_key'] = $_REQUEST['fb_sig_session_key'];
}
if (! empty($_SESSION['fb_sig_session_key'])) $this->facebook->api_client->session_key = $_SESSION['fb_sig_session_key']; 
```

此代码将`fb_sig_session_key`在初始应用程序加载时收到，我会将其存储到本地`$_SESSION`以与 API 一起使用。将其存储在本地会话中是必要的，因为`fb_sig_session_key`除非您重新加载整个应用程序 iframe，否则永远不会再次传入。

因此，当此会话密钥在一个小时左右后过期时，就会出现问题。

在查看了[模糊的参考页面](http://wiki.developers.facebook.com/index.php/PHP_Sessions)后，我开始检查`$_REQUEST`我得到的所有变量。事实证明，即使在 iframe 应用程序内部的链接上，Facebook 也会修改请求以传递一些参数。出于某种原因，每个 iframe 请求都有一个**完全不同但也是有效的会话密钥！**

此参数以您的 Facebook 应用程序 api 密钥命名。因此，如果您的应用程序 API 密钥是“xyz123”，则 iframe 中的每个请求都会获得一个名为的参数`xyz123_session_key`（以及其他一些参数，例如`xyz123_expires`and `xyz123_user`）。

在观察了主会话（原始`fb_sig_session_key`）和这个 iframe-only 会话（`xyz123_session_key`）的相关到期时间之后，隧道尽头的灯出现 **了：iframe-only 会话密钥到期时间实际上偶尔会更新**。我还没有确定何时或如何（我假设它在某个时候是 Ajax ping），但尽管如此，它会刷新。

我等待原始`fb_sig_session_key`会话过期，果然我的应用程序中与朋友相关的页面开始出现错误。那时，我将本地存储的会话密钥切换到新的 iframe-only `xyz123_session_key`，问题就解决了。该会话与原始会话一样有效！

因此，我的最终代码修复是在本地存储会话密钥，如下所示：

```
$iframeSessionKeyName = $CONFIG['facebook']['apiKey'] . '_session_key';
if (isset($_REQUEST[$iframeSessionKeyName])) {
    $_SESSION['fb_sig_session_key'] = $_REQUEST[$iframeSessionKeyName];
}
else if (isset($_REQUEST['fb_sig_session_key'])) {
    $_SESSION['fb_sig_session_key'] = $_REQUEST['fb_sig_session_key'];
}
if (! empty($_SESSION['fb_sig_session_key'])) $this->facebook->api_client->session_key = $_SESSION['fb_sig_session_key']; 
```

这优先于“iframe-only”键。

**编辑：**我最初的假设是“仅 iframe”键是通过某种 Ajax 方法更新的，这是错误的，事实证明这些值是由 Facebook 设置到 cookie 中的。这会在使用这些 cookie 时导致一些跨域问题。设置[P3P cookie 策略](http://gathadams.com/2007/06/25/how-to-set-third-party-cookies-with-iframe-facebook-applications/)将在大多数浏览器（Safari 除外）中缓解这种情况。Safari 仍然没有很好的解决方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-28T10:46:45.437

就放

```
header('P3P: CP="CAO PSA OUR"'); 
```

在您的页面顶部，您不会在 iframe 中丢失会话。

我也注意到这个线程已经有 2 年半的历史了。我刚刚偶然发现正在使用谷歌。也许我的帖子会帮助遇到这个问题的其他人。

# dll - 跨dll分配可以吗？

> ID：836051
> 
> 赞同：0
> 
> 时间：2009-05-07T17:39:58.580
> 
> 标签：dll, allocation

如果我有一个使用至少两个 dll 的应用程序，在一个 dll 中分配资源并在另一个 dll 中释放它们通常是否安全？

我正在考虑在不同的 dll 中调用 fopen 和 fclose，但我也想知道它对其他资源（内存指针、句柄等）是安全的。

我认为只要所有东西都是用相同的开关编译的，它应该可以工作。

谢谢，科里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T18:41:49.430

对于所有非平凡的项目来说，这是一件***坏事(TM)。***这在一组非常严格的条件下工作，例如 dll 的版本、线程模型、在每个和许多其他人中使用的内存分配器。最后，bug 将很难追。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T17:42:07.997

只要您使用的是 C 运行时库的 DLL 版本（/MD 或 /MDd），那么是的，它是安全的。

如果您将 CRT 静态链接到 DLL（/MT 或 /MTd）中，那么不，这不安全。

# .net-2.0 - 如何用 .NET 替换 VB6 Com+ DLL

> ID：836055
> 
> 赞同：0
> 
> 时间：2009-05-07T17:40:40.463
> 
> 标签：.net-2.0, iis-6, com+

我们的 asp 经典应用程序中使用了 Com+ VB6 DLL。升级到 IIS 6.0 和 Windows Server 2003 后，它似乎给我们带来了问题。我们应该如何将其替换为 .NET (2.0) 功能？

*   网络服务？
*   .NET 中的 Com DLL？
*   其他选择？

假设重写 asp 经典页面是不可能的。

**编辑**：如果将其重写为 com 可访问的程序集，这不会留下与 Com+ 相同的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T17:44:07.493

这在很大程度上取决于 COM 组件正在做什么，但最简单的选择可能是 .NET 中的 COM 库。

这可能需要对调用客户端（asp 经典应用程序）进行最少的更改。如果您设置 API 以匹配您的 VB 6 COM api，它应该是一个替代品。

在某些情况下，迁移到 Web 服务或其他选项可能会更干净，但需要对您的应用程序进行更多更改。如果没有更多信息，就不可能确定这是否值得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T17:45:11.327

这实际上取决于如何使用 com dll。我假设您需要保留经典的 asp 应用程序，否则您将重写整个内容。

如果 com dll 正在使用站点的会话或 http 上下文，则您不需要 Web 服务。我会将 com 代码移至 .NET 库程序集，将其注册到互操作（tlbimport/tlbexport），并使用经典 asp 应用程序中的互操作程序集与新的 .NET 库进行通信。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-06T03:20:21.440

我假设您的 VB6 组件正在使用一些 COM+ 服务。如果是这样，那么我将在 .NET 中将 VB6 组件重写为 ServicedComponent，然后使用 Regsvcs.exe 将其注册到 COM+。

如果您的 VB6 组件正在访问数据库（或进行其他长时间的公寓调用），那么作为将 VB6 组件迁移到 .NET 的额外好处，当有许多并发时，您可能会看到性能问题的消除对您的组件的请求。[有关如何以及为何进行详细说明，请参阅文章从 MTS 移植到 COM+ 时保持应用程序性能](http://msdn.microsoft.com/en-us/library/ms809941.aspx#portingwinntapps_mtstocom_avoid_long_running_method_calls_from_a_single_threaded_apartment)中的避免从单线程单元 (STA) 调用长时间运行的方法部分。

# java - Ant：检查 jar 中是否存在类

> ID：836057
> 
> 赞同：1
> 
> 时间：2009-05-07T17:40:50.963
> 
> 标签：java, ant, jar

如何检查 jar 文件中是否存在特定类？我尝试了可用的任务，但它似乎不起作用

如果有办法，我可以在其中使用模式吗？

例如，我想检查`**/xyz/foo.class`foobar.jar 中是否存在类匹配模式

任何方向表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T21:07:20.750

如果你给它准确的类名，Available 任务应该可以工作。这是 Ant 手册中[可用](http://ant.apache.org/manual/Tasks/available.html)的示例：

```
...in project ...
<property name="jaxp.jar" value="./lib/jaxp11/jaxp.jar"/>
<path id="jaxp" location="${jaxp.jar}"/>
...in target ...
<available classname="javax.xml.transform.Transformer"
           classpathref="jaxp" property="jaxp11.present"/> 
```

除了编写自己的任务之外，我不知道任何基于模式进行搜索的方法。我想您可以使用[unjar](http://ant.apache.org/manual/Tasks/unzip.html)任务将模式提取到临时目录，然后检查文件是否存在。例如：

```
<property name="temp.dir" value="some_temp_directory"/>
<unjar src="foobar.jar" dest="${temp.dir}">
    <patternset>
        <include name="**/xyz/foo.class"/>
    </patternset>
    <mapper type="flatten"/>
</unjar>
<available property="foo.present" file="${temp.dir}/foo.class"/> 
```

# asp.net - 在特定时间使用 outputcache varybyparam="*" 使页面过期

> ID：836058
> 
> 赞同：0
> 
> 时间：2009-05-07T17:41:08.623
> 
> 标签：asp.net, caching

我有一个页面使用

目标是将其缓存长达 24 小时，但我希望它专门在午夜过期。有谁知道诀​​窍吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T17:53:35.253

您可以计算每次加载页面时到午夜的秒数，然后使用`Response.Cache.SetExpires`. 我从来没有做过，但我不明白为什么它不起作用。

显然，这是服务器上的午夜，您可能不知道客户端上的时间。

编辑。实际上，查看`SetExpires`它的定义需要 a`DateTime`而不是持续时间，因此您甚至不需要计算秒数，只需将它传递`DateTime`给下一个午夜将是什么。

# c# - 如何在 NHibernate 中映射一个可为空的枚举？

> ID：836062
> 
> 赞同：1
> 
> 时间：2009-05-07T17:41:47.000
> 
> 标签：c#, nhibernate, fluent-nhibernate

我无法使用 NHibernate 和 Fluent NHibernate 配置来持久化可为空的枚举。NHibernate 尝试保存枚举的字符串表示形式，但出现错误

```
System.Data.SqlClient.SqlException: Conversion failed when converting the 
nvarchar value 'VGS' to data type tinyint. 
```

该属性定义为

```
public virtual CostContributor? ReplacementContributor { get; private set; } 
```

并且映射是

```
Map(x => x.ReplacementContributor).CustomTypeIs(typeof(CostContributor?)); 
```

我已经尝试过 CustomTypeIs 和 CustomSqlTypeIs 的所有组合，包括替换 int? 还是字节？对于 CostContributor?，但没有任何效果。如果我将它设为不可为空的类型，它工作正常。

是否可以在 NHibernate 中映射一个可为空的枚举？或者这是 NHibernate 中的错误或不受支持的功能？

如果我无法完成这项工作，我将在我的枚举中添加一个未定义的值作为解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-28T05:21:50.907

这是一个[错误，它已被修复](http://code.google.com/p/fluent-nhibernate/issues/detail?id=168)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:13:01.353

不知道如何正确地做到这一点，但这是另一种解决方法：

添加一个名为 CostContributorEntity 的类。该类将只有属性：ID，类型为 CostContributor。除非您愿意，否则您不需要创建真正的表格。

在消费类中将 ReplacementContributor 更改为 CostContributorEntity 类型，并将其映射为**References** (x => x.ReplacementContributor);

使用 session.Load(CostContributor.Blahblah1) 创建您可以分配给 ReplacementContributor 的 CostContributorEntity 实例。

# sql - 如何编写一个从 SQL 数据库返回值的 Excel 函数？

> ID：836065
> 
> 赞同：3
> 
> 时间：2009-05-07T17:42:48.587
> 
> 标签：sql, excel, odbc

我想编写以下应在 Excel 工作表中使用的函数：

```
=GetRecField("Foo Record Key", "FooField1") 
```

...它将通过 ODBC 在内部连接到 SQL 数据库，在那里执行

```
SELECT FooField1 FROM MyTable WHERE KEY_FIELD='Foo Record Key'; 
```

并将返回结果值作为函数 GetRecField 的结果。上面的 SQL 被授予只返回一条记录（IOW KEY_FIELD 具有唯一约束）。

当然，上述函数可以在一个工作表中多次调用，所以请尽量避免盲注`QueryTables.Add`

TIA。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T18:38:50.090

您可以编写一个自定义函数来做到这一点

1.  打开 VBA 编辑器 (ALT-F11)
2.  打开工具 -> 参考，并确保选中“Microsoft ActiveX Data Objects 2.8 Library”和“Microsoft ActiveX Data Objects Recordset 2.8 Library”
3.  右键单击 VBAProject，然后选择插入 -> 模块
4.  打开模块。现在您可以创建自定义函数，例如：

```
    公共函数GetItem（字段为字符串，id为整​​数）为字符串
        设置 oConnection = New ADODB.Connection
        将 oRecordset 调暗为 ADOR.Recordset
        oConnection.Open "provider=sqloledb;data source=yourserver;" &_
            “Trusted_Connection=yes；初始目录=您的数据库；”
        设置 oRecordset = oConnection.Execute( & _
            从 id = " & id 的表中选择 " & field & ")
        如果 oRecordset.EOF 则
            GetItem =“不适用”
        别的
            GetItem = oRecordset(字段)
        万一
    结束功能

```

5.  您现在可以从单元格中调用该函数：

    =GetItem("字段名";2)

该模块是必需的，因为无法从电子表格内部调用非模块函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T17:50:33.203

为什么不在单独的工作表上使用 Excel 的内置数据库查询功能（数据菜单、导入外部数据、新数据库查询），然后用于`VLOOKUP`从该工作表中提取值？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-07T11:12:01.810

我通过将数据库连接保存在一张表中并使用对其他表中所需单元格的引用解决了 Excel 版本 1808（？）中的类似问题。

1.  数据 > 获取数据 > 从数据库 > 从 SQL Server 数据库
2.  输入服务器和数据库名称。
3.  打开高级选项并逐字输入查询，然后将其命名为“connection_name”。
4.  现在查询可用，打开 Data > Queries & Connections。
5.  右键单击连接，然后单击加载到...
6.  在未使用的工作表上选择未使用的位置并将其放在那里。
7.  在文件其他位置的目标单元格中​​，输入`=connection_name[[#All,][Column1]]`.

这当然似乎是间接的，因为我无法找到一种方法来引用连接，而它不会出现在某个地方的工作表中。但它对我有用，我无法在其他地方找到类似的说明，所以我认为它可能会提供信息。

# css - 错误标签的自动宽度

> ID：836071
> 
> 赞同：0
> 
> 时间：2009-05-07T17:43:42.423
> 
> 标签：css, label, positioning, css-tables

错误标签一直显示到表格的宽度。像这样：

[替代文字 http://img518.imageshack.us/img518/8864/width1.jpg](http://img518.imageshack.us/img518/8864/width1.jpg)

如何在标签文本之前显示它？这是CSS：

```
 label.error    { color: red; font-size:16px; font-family:Nyala; background-color: #FFFFCC; display:block; width:auto; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T01:28:58.280

这可以工作，无需添加任何额外的 div（尽管不可否认有一个额外的 span ( `.errorMsg`) 来包含错误消息：

使用 XHTML 1.0 严格的文档类型。

```
 <style>

        #container
            {width: 50%;
            margin: 0 auto;
            }

        label   {display: inline-block;
            width: 48%;
            text-align: right;
            }

        input   {display: inline-block;
            width: 50%;
            }
        .errorMsg
            {display: block;
            width: 51%;
            margin: 0 0 0.5em 49%;
            color: #f00;
            background-color: #ffa
            }

    </style>

...

    <div id="container">

        <form>

            <label for="input1">Label 1</label>
                <input type="text" id="input1" name="input1" />
                <span class="errorMsg">Error message</span>

            <label for="input1">Label 2</label>
                <input type="text" id="input2" name="input2" />
                <span class="errorMsg">Error message</span>

        </form>

    </div> 
```

值得注意的是，宽度`.errorMsg`是 51%，而不是 50%，以适应输入的边框（添加到 CSS 中定义的 50% 宽度。不过，这可能只是 Ubuntu 8.04 上的 FF3.x。我'还没有彻底测试过。恐怕根本没有。YM，一如既往，MV。

演示地点：[http://www.davidrhysthomas.co.uk/so/errorLabels.html](http://www.davidrhysthomas.co.uk/so/errorLabels.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T17:52:44.647

用 div 包裹字段，将 div 设置为所需的宽度，并设置输入和标签以填充 div。

要么将标签和输入的宽度设置为相同的像素。div 方法更灵活一些。

但请注意，“名称：”提示符是标签。错误应该是一个跨度或其他东西，它不是一个“标签”，至少不是 HTML 认为它的方式。

# ruby-on-rails - Rails 中变量的寿命

> ID：836075
> 
> 赞同：2
> 
> 时间：2009-05-07T17:44:41.423
> 
> 标签：ruby-on-rails, ruby

我有以下代码：

```
 def show
    @game = $site.new_game_of_type(params[:id])
    @game.start
  end

  def update_game_time
    render :partial => 'countdown', :layout => false
  end 
```

和倒计时部分：

```
<div id=countdown> <%= @game.running_time %></div> 
```

在 show.html.erb 我有：

```
Time: <div id="countdown"> </div>

<%= periodically_call_remote(:frequency => 0.5, 
   :update => 'countdown', :url => {:action => :update_game_time}) %> 
```

我想在 show 显示的页面中创建一个游戏，所以我会有很多 ajax 移动到那里，但用户不会点击任何地方。控制器的所有动作都将从 Javascript 调用。

我收到@game 为零的错误。即使在 update_game_time 方法中也为零，当用户在该页面中时，如何使 @game 变量保持有效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T22:43:34.527

如果您希望 @game 对象在请求之间持续存在，则需要将其存储在某个地方。有很多方法可以做到这一点（例如，您可以将其设为 ActiveRecord 对象并将其保存在数据库中），但在我看来，您想要使用会话。可以在[http://www.quarkruby.com/2007/10/21/sessions-and-cookies-in-ruby-on-rails](http://www.quarkruby.com/2007/10/21/sessions-and-cookies-in-ruby-on-rails)找到有关在 Rails 中使用会话所涉及的主要问题的一个很好的概述，但基本用法是：

```
def show
  @game = $site.new_game_of_type(params[:id])
  @game.start
  session[:game] = @game
end

def update_game_time
  @game = session[:game]
  render :partial => 'countdown', :layout => false
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T18:39:10.747

您应该在渲染之前将两行从`show`方法移到, 。`update_game_time`否则`@game`是未定义的，除了在渲染`show`动作时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T17:57:36.010

每 0.5 秒向服务器发出一次请求并不是一个好主意。
我的建议是加载`running_time`一次，然后使用 javascript 来增加/减少它。

也许您可以执行以下操作：

```
<div id=countdown><%= @game.running_time %></div> 
```

在视图中，然后在其上使用一些 javascript 来更新计时器：

```
window.onload = function() {
  var countdownDiv = document.getElementById('countdown');

  var timerValue = parseInt(countdownDiv.innerHTML); // assuming that your running_time is an int (seconds)

  var dateObj = new Date();

  dateObj.setTime( timerValue*1000 );
  countdownDiv.innerHTML = dateObj.getMinutes() + ":" + dateObj.getSeconds();

  var timer = setInterval("dispalyTimer()", 1000);

  dispalyTimer = function() {
    dateObj.setTime( ( (dateObj.getTime()/1000) + 1 )*1000 );
    countdownDiv.innerHTML = dateObj.getMinutes() + ":" + dateObj.getSeconds();
  }
} 
```

这只是一个基本的例子，但你明白了。无论如何，最好每半秒向服务器发出一次请求，因为计时器也可以在客户端很好地工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T17:51:47.193

您需要将变量传递到部分中，以便它在那里可见。

```
def update_game_time
 render :partial => 'countdown', :layout => false, :locals => { :game => @game }
end 
```

然后像这样在部分中访问它：

```
<div id=countdown> <%= game.running_time %></div> 
```

# mysql - 如何在数据库中搜索和替换字符串的所有实例？

> ID：836083
> 
> 赞同：26
> 
> 时间：2009-05-07T17:47:32.680
> 
> 标签：mysql, database, wordpress, replace

我有一个字符串包含在 wordpress 安装（服务器名称）中数千次，跨越多个列、记录和表。

我想用另一台服务器的位置来更新它——我们正在移动内容。

所以源代码类似于[http://my-server1/some/link/to/something](http://my-server1/some/link/to/something)，我想用[http://my-other-server/some/link/to/something](http://my-other-server/some/link/to/something)替换它。我基本上希望对[http://my-server1](http://my-server1)的每个实例重复这个过程。

在 MySQL 中是否有一种简单的方法可以做到这一点？一个工具？还是我很遗憾地不得不更新每条记录有问题？

谢谢，

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-07T17:48:49.743

一种粗略（但有效）的方法是将模式转储到文件中，仔细应用搜索和替换，然后重新导入。

事实上，我今天做到了:)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-19T16:31:28.720

Came across this in a google search, but this may help some people. If you know the tables and columns (you could find this using the wildcard search in phpMyAdmin),

> UPDATE **table_name** SET **column_name** = REPLACE(**column_name**, '**http://oldsite.com**','**http://newsite.com**');

Replace **bold** parts with your own.

If you had a large database you could apply this into a script that could loop through each table and column.

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-01-24T11:49:45.310

如果您愿意重新导入整个数据库，MySQL 转储方法将是最好的选择。对于不想这样做的任何人 - WordPress 核心安装实际上只包含 11 个表，其中很少有内容列，因此按列替换同样容易。假设您没有大量引用链接或字符串的插件表，这将是您的 SQL：

```
UPDATE wp_commentmeta SET meta_value = REPLACE(meta_value,'xcurrentx','xreplacementx');
UPDATE wp_comments SET comment_content = REPLACE(comment_content,'xcurrentx','xreplacementx');
UPDATE wp_links SET link_description = REPLACE(link_description,'xcurrentx','xreplacementx');
UPDATE wp_options SET option_value = REPLACE(option_value,'xcurrentx','xreplacementx');
UPDATE wp_postmeta SET meta_value = REPLACE(meta_value,'xcurrentx','xreplacementx');
UPDATE wp_posts SET post_content = REPLACE(post_content,'xcurrentx','xreplacementx');
UPDATE wp_posts SET post_title = REPLACE(post_title,'xcurrentx','xreplacementx');
UPDATE wp_posts SET post_excerpt = REPLACE(post_excerpt,'xcurrentx','xreplacementx');
UPDATE wp_term_taxonomy SET description = REPLACE(description,'xcurrentx','xreplacementx');
UPDATE wp_usermeta SET meta_value = REPLACE(meta_value,'xcurrentx','xreplacementx'); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-11-23T18:51:46.613

您的问题已在 2009 年发布，在那一年，另一个人开发了一个基本的 php 工具来在某个数据库的所有表中搜索字符串。或者，您还可以用不同的字符串替换所有出现的位置。

仍然在 5 年后（在撰写本文时），在我看来，对 Wordpress 安装使用此工具比使用 mysql 转储更有效且容易得多（尽管您可能希望在运行脚本以进行备份之前也创建一个转储）。

您可以在其作者[Eric Amundson的博客和](http://sewmyheadon.com/2009/mysql-search-replace-tool/)[MySQL Search & Replace](https://launchpad.net/mysql-search-replace)项目的启动板页面中找到更多信息

我不相信你在这么久之后仍然在寻找答案，但我决定也发布我的提示，希望它可以帮助其他人在未来突然出现在这里仍然寻找解决这个问题的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-20T09:46:34.220

除了 Brad Larson 的回答 - 设置变量，如：

```
SET @what_to_be_replaced = "what_to_be_replaced", @to_be_replaced_by = "to_be_replaced_by"; 
```

然后按如下方式使用它：

```
UPDATE wp_commentmeta SET meta_value = REPLACE(meta_value, @what_to_be_replaced, @to_be_replaced_by ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T15:18:00.963

还有一个名为[Search Regex](http://wordpress.org/extend/plugins/search-regex/)的 Wordpress 插件，它允许`grep`在数据库中运行搜索和替换。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-21T11:12:54.320

**MySQL 的 REPLACE 或在WordPress**中手动替换 s​​ql 文件或 db 中的字符串不是一个好方法。WordPress 使用序列化字段，如果您替换其中的某些字符串，这些字段可能会中断（这是我的情况）

我使用了非常适合我的[Better Search Replace插件](https://wordpress.org/plugins/better-search-replace/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-15T11:46:24.600

我最近不得不进行 wordpress 迁移，我不得不更改网站的域名（在帖子数据和其他地方出现了 1012 次网站名称）。我试过mysqldump的方法，用sed把旧的换成新的域名。重新导入后这个可怕的失败，正是因为 wordpress 记录中存在序列化数组数据（我的新域名比旧域名短 2 个字符）。真正有效的是 wp-CLI，一个用于管理任务的 wordpress 命令行界面。wp-cli 具有用于数据库字符串的内置搜索替换功能，该功能还负责处理序列化记录。它使用存储在 wp-config.php 中的凭据，因此直接针对 wordpress 数据库（如果您的 mariadb 实例还托管其他数据库）。它只是您下载并放在路径中的文件夹中的单个 php 文件。看[https://wp-cli.org/](https://wp-cli.org/)

# linux - 以编程方式确定 Linux 中的单个屏幕宽度/高度（w/Xinerama、TwinView 和/或 BigDesktop）

> ID：836086
> 
> 赞同：4
> 
> 时间：2009-05-07T17:48:10.260
> 
> 标签：linux, gnome, xorg, multiple-monitors

我正在开发一个小项目来在 GNOME 下的多个屏幕上显示多个壁纸（这显然不能由 GNOME 本身或其他任何东西完成）。我已经弄清楚了如何做它的主要部分（使用 ImageMagick 组件，对于好奇）；我正在尝试自动化配置系统。

为此，我需要一种方法来确定各个屏幕的尺寸。谁能给我一个提示在哪里寻找它？我认为 X 服务器本身有信息，但我不确定我的程序如何请求它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T18:51:27.767

~~看起来有一个`libXinerama`API 可以检索该信息。不过，我还没有找到任何关于它的详细信息。~~

可以在[此处](http://xorg.freedesktop.org/releases/X11R7.0/doc/PDF/xlib.pdf)找到一般 X.org 编程信息（PDF 文件）。`libXinerama`可以在[此处](http://manpages.ubuntu.com/manpages/jaunty/man3/Xinerama.3.html)找到有关由提供的功能的信息（联机帮助页的副本，其中没有很多信息）。

这是一个小的 C++ 程序，我从这些参考资料中提取出来，以检索连接到 Xinerama 的每个监视器的尺寸和偏移量。它也适用于 nVidia TwinView；我目前没有 ATI 卡在他们的 BigDesktop 系统上测试它，但我怀疑它也可以在它上面工作。

```
#include <cstdlib>
#include <iostream>

#include <X11/extensions/Xinerama.h>

using std::cout;
using std::endl;

int main(int argc, char *argv[]) {
    bool success=false;
    Display *d=XOpenDisplay(NULL);
    if (d) {
        int dummy1, dummy2;
        if (XineramaQueryExtension(d, &dummy1, &dummy2)) {
            if (XineramaIsActive(d)) {
                int heads=0;
                XineramaScreenInfo *p=XineramaQueryScreens(d, &heads);
                if (heads>0) {
                    for (int x=0; x<heads; ++x)
                        cout << "Head " << x+1 << " of " << heads << ": " <<
                            p[x].width << "x" << p[x].height << " at " <<
                            p[x].x_org << "," << p[x].y_org << endl;
                    success=true;
                } else cout << "XineramaQueryScreens says there aren't any" << endl;
                XFree(p);
            } else cout << "Xinerama not active" << endl;
        } else cout << "No Xinerama extension" << endl;
        XCloseDisplay(d);
    } else cout << "Can't open display" << endl;

    return (success ? EXIT_SUCCESS : EXIT_FAILURE);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-16T16:16:17.350

尝试类似的东西

```
GdkScreen *screen;
int num_monitors;
int i;

screen = gdk_screen_get_default ();
num_monitors = gdk_screen_get_n_monitors ();

for (i = 0; i < num_monitors; i++) {
    GdkRectangle rect;

    gdk_screen_get_monitor_geometry (screen, i, &rect);
    printf ("monitor %d: offsets (%d, %d), size (%d, %d)\n",
        i,
        rect.x, rect.y,
        rect.width, rect.height);
} 
```

这在内部使用 libXrandr API。Xinerama 或多或少已被弃用，但仍然有效；RANDR 是在 X 中处理多个监视器的新方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-06T22:04:47.777

这适用于 TwinView，我还没有测试过其他的：

```
#!/usr/bin/python
# Print some information about the X environment, the monitor setup, currently active window and cursor position
import gtk.gdk

screen = gtk.gdk.screen_get_default()
print "X default screen size: %d x %d" % (screen.get_width(), screen.get_height())
print "xid of root window: %d" % screen.get_root_window().xid

monitors = int(screen.get_n_monitors())
print "== %d monitors ==" % monitors
for m in range(0, monitors):
    print " - geometry of monitor %d: %s" % (m, screen.get_monitor_geometry(m))

window = screen.get_active_window()
win_x, win_y, win_w, win_h, win_bit_depth = window.get_geometry()
print "active window on monitor: %d" % screen.get_monitor_at_point((win_x+(win_w/2)),(win_y+(win_h/2)))
print "window geometry (x,y,w,h): %d, %d, %d, %d" % (win_x,win_y,win_w,win_h)

display = gtk.gdk.display_get_default()
pointer = display.get_pointer()
print "cursor position (x, y): %d, %d" % (pointer[1], pointer[2])
print "cursor on monitor: %d" % screen.get_monitor_at_point(pointer[1],pointer[2]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T01:56:03.987

我总是使用“xdpyinfo”命令来确定屏幕大小；运行命令，然后查看输出的第二页或第三页，看看它在哪里显示如下内容：

```
screen #0:
  dimensions:    1280x800 pixels (339x212 millimeters)
  resolution:    96x96 dots per inch
  depths (7):    24, 1, 4, 8, 15, 16, 32
  root window id:    0xac
  depth of root window:    24 planes
  ... 
```

您可以在外部运行此命令并通过文本处理获取尺寸，或者您可以快速下载 xdpyinfo 的代码并复制它为生成该行输出而进行的 C 调用。祝你好运！

# httpwebrequest - 带有查询和摘要 http 授权的 GET 请求

> ID：836093
> 
> 赞同：0
> 
> 时间：2009-05-07T17:49:10.507
> 
> 标签：httpwebrequest, get, digest-authorisation

我有需要使用的 java 服务（不能修改它）和使用摘要 HTTP 授权的 Web 服务器。我正在使用 HttpWebRequest 与服务器通信（使用 GET 方法）。提供了身份验证所需的 NetworkCredentials。但是调用 GetResponse() 会生成错误 400（错误请求）。

地址： http: [//info.server.com/someFolder/servlet.do ?cmd=get_info¶m=value](http://info.server.com/someFolder/servlet.do?cmd=get_info&param=value)

请求示例（不完整，仅相关内容）：

GET /someFolder/servlet.do?cmd=get_info¶m=value HTTP/1.1

主机：info.server.com

响应：需要 401 授权

第二个请求：

GET /someFolder/servlet.do?cmd=get_info¶m=value HTTP/1.1

主机：info.server.com

授权：Digest ... uri="/someFolder/servlet.do" ...（显然不是完整的标题）

第二个响应：400 Bad request

我已经用 Web 浏览器（IE、Firefox）尝试了这个请求并且它可以工作，但似乎浏览器将整个请求 uri 放在 Authorization 标头的 uri 部分中，而 HttpWebRequest 如上所述格式化标头。有谁知道如何强制 HttpWebRequest 将整个 uri 放入 Authorization 标头中？或者，也许这个问题还有另一种解决方案？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-24T11:11:52.427

我们遇到了同样的问题，并已将其追溯到 Authorization 标头中的 URL。看起来 HttpWebRequest 只发送主机名而不是完整的 URL。它省略了：

```
?cmd=get_info&param=value 
```

从网址。IE8 和 Chrome 都使用完整的 URL，包括参数。

我们已经能够通过摘要授权的自定义实现来解决这个问题。看到[这个答案](https://stackoverflow.com/questions/3109507/httpwebrequests-sends-parameterless-uri-in-authorization-header/3117042#3117042)。

# xml - 你如何解决一个URN？

> ID：836100
> 
> 赞同：4
> 
> 时间：2009-05-07T17:50:31.393
> 
> 标签：xml, xsd, urn

我有一个 XML 模式文件，它引用了一个基于 urn 的位置。是否有某种方法可以将其解析为 url，或者有某种方法可以实际读取它所引用的文件。

```
<xs:include schemaLocation="urn:oasis:names:tc:dita:xsd:tblDeclGrp.xsd:1.1"/> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-06-08T12:14:40.937

这个问题不是解释“URN解析”的好地方......我们可以想象从这个绿洲URN到*schemaLocation*文件名或URL的翻译（通过自动翻译器），但它对于URN来说有点异国情调.

[请参阅 http://www.w3.org/TR/xmlschema-1/#schema-repr](http://www.w3.org/TR/xmlschema-1/#schema-repr)上的*schemaLocation*的常用语义和值

* * *

#URN 分辨率

您可以[在 Wikipedia 中查看 URN 的真实示例，并在](http://en.wikipedia.org/wiki/Uniform_resource_name)[RFC-2169](https://www.rfc-editor.org/rfc/rfc2169)和[RFC-2483](https://www.rfc-editor.org/rfc/rfc2483)中查看术语“解析 URN”的完整语义。根据这些 RFC，您需要的是本地软件或执行**N2L的“URN 解析器”软件（网络服务）的 URL：给定一个**[*URN*](http://en.wikipedia.org/wiki/Web_service)，返回一个 URL。

 **## 广泛使用的 URN

2002 年*URN 解析*机制受到更多关注，两个新的 RTF [RFC-3404](https://www.rfc-editor.org/rfc/rfc3404)和[RFC-3405](https://www.rfc-editor.org/rfc/rfc3405)解决了 URN 的一个潜在问题，

> 如果 URN 解析合并为通用 URI 解析，则 URN 可能会因缺乏采用 URI 解析而受到影响。

> 解决方案是允许 URN 解析的快捷方式。(...) 通用 URI 解析首先将已知 URI 方案的规则插入“uri.arpa”。注册表。对于“URN:”URI 方案，“uri.arpa”中的规则之一。将用于“urn”URI 方案。该规则将简单地委托给“urn.arpa”。基于 URN 命名空间的其他 NAPTR 的区域。本质上，“URN:”的 URI 解析重写规则是 URN 解析应用程序的第一个众所周知的规则。

一些解析问题仍然存在：URN 喜欢[`urn:doi`](http://en.wikipedia.org/wiki/Digital_object_identifier)或[`urn:lex:br`](http://en.wikipedia.org/wiki/Lex_%28URN%29)具有如此使用且稳定的解析机制（分别在[dx.doi.org](http://dx.doi.org/)和[lexml.gov.br/urn](http://www.lexml.gov.br/urn)），但未在[IANA 的 assignments/urn-namespaces](http://www.iana.org/assignments/urn-namespaces/urn-namespaces.xml)注册；一个未使用、不稳定且不受控制的 URN，例如 `urn:oasis:names:tc:dita`已`urn:oasis`在 IANA 注册。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T18:01:12.350

...也许看看[RFC3121](http://www.ietf.org/rfc/rfc3121.txt) A URN Namespace for OASIS？

编辑：我永远记不起 URI 和 URN，但我的理解是它们只是名称空间，它们实际上不必对应于网络上存储文件的某个真实位置。他们只是划分了对部分命名空间的控制，因此`urn:oasis`处于 OASIS 的控制之下。除非您可以控制它，否则您不应该发明层次结构的该部分内的任何 URI / URN。

编辑 2：谷歌搜索在 oasis-open.org 中找到了一个名为[tblDeclGrp.xsd](http://docs.oasis-open.org/dita/v1.1/OS/schema/tblDeclGrp.xsd)的文件以及对其和其他模式的一些[评论](http://docs.oasis-open.org/dita/v1.1/OS/archspec/schemaorganization.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T17:58:57.440

在这种情况下，schemaLocation 就是位置。如果您在同一目录中有一个与此名称完全相同的文件，则应该解析它。它甚至包括 urn: 部分所以完整的字符串。在模式命名空间之后命名文件很方便。起初我必须承认令人困惑。

顺便提一句。urn 不是一个位置，它只是一个 URI。xs:include schemaLocation 的属性指的是一个位置，但属性类型是 anyURI，它包括 urn 模式

# sql - 触发器是否可以强制在 SQL Server 2000 中的用户之外的单独上下文中运行？

> ID：836101
> 
> 赞同：0
> 
> 时间：2009-05-07T17:50:32.047
> 
> 标签：sql, sql-server, tsql, sql-server-2000

假设我有一个 SQL Server 2000 表，任何名称都可以，与本主题无关。在这张表上，我有一个在更新或插入后运行的触发器。

用户能够插入和更新附加了触发器的表，但不能插入和更新触发器所针对的其他表。

如果用户修改了原始表中的数据，我会收到一个异常，抱怨用户无权修改触发器的目标表中的数据。

我认为这是由于触发器在用户上下文中运行的事实引起的。有没有办法让触发器在它自己的上下文中运行，或者我没有正确解释这个异常的原因？

**编辑：**我应该指出我使用的是 SQL Server 2000，所以使用 EXECUTE AS 将不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T17:59:30.030

[MSDN 资源](http://msdn.microsoft.com/en-us/library/ms189799.aspx)

> EXECUTE AS 指定执行触发器的安全上下文。使您能够控制 SQL Server 实例使用哪个用户帐户来验证触发器所引用的任何数据库对象的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T17:55:48.790

触发器通常使用进行初始更改的用户的权限进行操作。类似这样的解决方法是让触发器将数据写入临时表，然后让一个单独的进程（以更高级别用户身份登录）每隔一段时间检查临时表中的数据并将其移动到目标中桌子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T18:00:09.903

您使用的是哪个版本的 SQL Server？我只是能够在 SQL Server 2005 中毫无问题地做到这一点：

```
CREATE TABLE dbo.Test_Trigger_1
(
    my_string   VARCHAR(20) NOT NULL,
    CONSTRAINT PK_Test_Trigger_1 PRIMARY KEY CLUSTERED (my_string)
)
GO

CREATE TABLE dbo.Test_Trigger_2
(
    my_string   VARCHAR(20) NOT NULL,
    CONSTRAINT PK_Test_Trigger_2 PRIMARY KEY CLUSTERED (my_string)
)
GO
CREATE TRIGGER dbo.tri_Test_Trigger_1
ON dbo.Test_Trigger_1
FOR INSERT
AS
BEGIN
    INSERT INTO dbo.Test_Trigger_2
    (
        my_string
    )
    SELECT
        my_string
    FROM
        INSERTED
END
GO 
```

然后我创建了一个只能访问Test_Trigger_1的登录，我确认它无法访问Test_Trigger_2，我在Test_Trigger_1中插入了一行，在Test_Trigger_2中出现了一行。

# java - 异常处理标准建议

> ID：836104
> 
> 赞同：3
> 
> 时间：2009-05-07T17:50:43.687
> 
> 标签：java, exception, logging, jakarta-ee, exception-handling

在 j2ee 应用程序中，我计划标准化异常处理策略。不再吞咽异常，基本上将所有已检查的异常转换为未检查的异常（除了一些实际上**可以**从中恢复的异常。标准是所有异常都将被抛出回容器（例如：[http ://www.onjava.com /pub/a/onjava/2003/11/19/exceptions.html](http://www.onjava.com/pub/a/onjava/2003/11/19/exceptions.html) )。无法从中恢复诸如 SQLException 之类的异常，如果它发生在数据层深处，我将强制它向上返回。**但是**，电子邮件通知之类的小子例程将被包裹在 try catch 中，以防止发生异常而破坏整个应用程序流。（例如：为什么要阻止整个过程完成，因为用户没有收到他们不需要的电子邮件通知！）

对此有何建议？再次重申，我基本上将所有异常重新抛出到具有自己的错误页面的容器中，然后将其记录到 log4j 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T21:23:34.517

我认为电子邮件示例是检查异常的最佳防御。你有一些可能出错并且是暂时的，所以检查异常的存在让你思考它。如果一切都是运行时异常，那么您的应用程序会因为一些琐碎的原因而崩溃，没有人会考虑它。

无论如何，如果对于您的项目，一般的答案是将其放到顶部，那么包装在运行时异常中是完全有效的。有几点需要考虑：

坚持异常链。不这样做的唯一原因是，如果您正在序列化异常，那么一些包含不可序列化成员的异常可能会变得有趣。情况似乎并非如此，所以不要允许异常吞咽。如果必须，请使用 initCause。这是我们项目中的一个小辅助方法：

```
public static <T extends Throwable> T initCause(T newException, Throwable cause) {
    return (T) newException.initCause(cause);
} 
```

这有助于人们避免需要强制转换异常。

我更喜欢避免不必要的 RuntimeException 和 Error Throwable 链接，当方法上有许多不同的 Checked Exception 并且开发人员只是捕获 Exception 时不可避免地会发生这种情况，所以我推荐一个静态方法，它可以执行以下操作：

```
public static void throwRuntimeExceptionFromThrowable(Throwable e) {
    if (e == null) {
        return;
    } else if (e instanceof RuntimeException) {
        throw (RuntimeException) e;
    } else if (e instanceof Error) {
        throw (Error) e;
    } else {
        throw new RuntimeException(e.getMessage(), e);
    }
} 
```

有两种选择。一种是使其无效（就像这段代码一样），它的好处是调用者永远不会忘记抛出结果。缺点是如果你有这样的东西：

```
public Object someMethod() {
    try {
        return getTheObject();
    } catch (Exception e) {
        throwRuntimeExceptionFromThrowable(e);
    }
} 
```

编译器不会喜欢你。你必须在 catch 之后返回，并在 try 之前声明一个变量。

另一种选择是将异常作为 RuntimeException 返回（只需抛出错误）并让调用者进行抛出。编译器比较高兴，但是调用者可能忘记了这样做，并且在调用方法之前没有抛出异常，然后异常就被吞没了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:40:01.343

异常应该由与其相关的层处理。因为检查了异常并不意味着您可以处理它，或者您必须在应用程序的每一层处理它。正是在这一点上，您可能希望将它们变成运行时异常。因此，您有可以忽略的异常（记录它们）、无法恢复的异常以及可以恢复的异常。问题是相同的异常类型，例如SQLException，可以进入多个类别。IOException 也是另一个例子。无法恢复的编程错误应该是运行时异常，并且应该在容器附近捕获以用于记录目的或让您的应用程序“温和地”失败。访问 jdbc PreparedStatement 中的无效索引是一个编程错误。没有连接问题。所以在数据层，您设法做出区分，然后将不可恢复的异常转换为运行时异常并抛出它。有时这并不意味着重试连接会起作用。业务方法应该只处理与业务相关的异常，这就是为什么您不必在代码中的任何地方处理 NullPointerExceptions 或 ArrayIndexOutOfBoundsException 并且您不必将它们放在您的方法签名中。相同的逻辑适用于计算部门员工平均工资的数据源无关业务方法，它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。然后将不可恢复的异常转换为运行时异常并抛出它。有时这并不意味着重试连接会起作用。业务方法应该只处理与业务相关的异常，这就是为什么您不必在代码中的任何地方处理 NullPointerExceptions 或 ArrayIndexOutOfBoundsException 并且您不必将它们放在您的方法签名中。相同的逻辑适用于计算部门员工平均工资的数据源无关业务方法，它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。然后将不可恢复的异常转换为运行时异常并抛出它。有时这并不意味着重试连接会起作用。业务方法应该只处理与业务相关的异常，这就是为什么您不必在代码中的任何地方处理 NullPointerExceptions 或 ArrayIndexOutOfBoundsException 并且您不必将它们放在您的方法签名中。相同的逻辑适用于计算部门员工平均工资的数据源无关业务方法，它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。有时这并不意味着重试连接会起作用。业务方法应该只处理与业务相关的异常，这就是为什么您不必在代码中的任何地方处理 NullPointerExceptions 或 ArrayIndexOutOfBoundsException 并且您不必将它们放在您的方法签名中。相同的逻辑适用于计算部门员工平均工资的数据源无关业务方法，它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。有时这并不意味着重试连接会起作用。业务方法应该只处理与业务相关的异常，这就是为什么您不必在代码中的任何地方处理 NullPointerExceptions 或 ArrayIndexOutOfBoundsException 并且您不必将它们放在您的方法签名中。相同的逻辑适用于计算部门员工平均工资的数据源无关业务方法，它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。t 在您的代码中随处处理 NullPointerExceptions 或 ArrayIndexOutOfBoundsException，您不必将它们放在您的方法签名中。相同的逻辑适用于计算部门员工平均工资的数据源无关业务方法，它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。t 在您的代码中随处处理 NullPointerExceptions 或 ArrayIndexOutOfBoundsException，您不必将它们放在您的方法签名中。同样的逻辑适用于计算部门员工平均工资的数据源不可知业务方法，它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。它不应该抛出 SQLExceptions，但如果用户提供了错误的部门，它应该抛出诸如 InvalidDeptException 之类的东西。代码。抛出声明也是对代码进行自我记录，如果您抛出自己的运行时异常，请务必正确记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T05:15:14.320

一般来说，我建议您遵循这种`Fault Barrier`模式 - 这是对您计划遵循的方法的进一步阐述。在此处查看：[http](http://www.oracle.com/technology/pub/articles/dev2arch/2006/11/effective-exceptions.html) ://www.oracle.com/technology/pub/articles/dev2arch/2006/11/effective-exceptions.html （请参阅[旧评论](http://www.infoq.com/news/2007/01/effective-exceptions)）。

对于电子邮件，不确定您的具体情况。总的来说，这听起来像是 AOP 的完美案例。如果您在 JEE5 中，则`@Interceptor`可能需要自定义 - 由于运行时异常而导致的常见“非中断”逻辑可能会在那里编码，之后您可以将其绑定到多个 bean/方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T18:01:39.820

对于 DB Access 异常，我建议查看[Spring](http://static.springframework.org/spring/docs/2.5.x/reference/dao.html#dao-exceptions)如何处理它们。我发现这在实践中很容易使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T18:07:03.647

您从哪里得到永远无法从 SQLException（以及其他）中恢复的想法？在精心编写的代码中，您通常可以。首先，整个 SQLTransientException 层次结构是针对您可能能够从中恢复的异常（例如 SQLTransientConnectionException）。当异常实际上可以处理时，将异常视为不可恢复是一个常见的错误。

我认为您的减少损失政策关于电子邮件被关闭等小错误没有任何问题。当然，应该通知用户。

# java - 使用 MyEclipse 设置 JBoss5

> ID：836105
> 
> 赞同：1
> 
> 时间：2009-05-07T17:50:55.323
> 
> 标签：java, jboss, myeclipse

我一直在使用 Weblogic，因为我的公司使用它。现在我想尝试 JBoss 作为替代方案。我正在使用带有 MyEclipse 7.1 插件的 Eclipse。我使用 Java JDK 1.5.0.14 下载并解压缩了 JBoss 5.0.1GA。我使用 MyEclipse 界面设置服务器并收到以下错误（无法在其他地方在线找到解决方案）：

```
10:42:54,240 INFO  [TransactionManagerService] Initializing recovery manager
10:42:54,300 FATAL [arjLoggerI18N] [com.arjuna.ats.internal.arjuna.recovery.fail] RecoveryManagerImple: cannot bind to socket on address /127.0.0.1 and port 4,712
10:42:54,310 ERROR [AbstractKernelController] Error installing to Create: name=TransactionManager state=Configured
com.arjuna.ats.arjuna.exceptions.FatalError: Recovery manager already active (or recovery port and address are in use)!
    at com.arjuna.ats.internal.arjuna.recovery.RecoveryManagerImple.<init>(RecoveryManagerImple.java:146)
    at com.arjuna.ats.arjuna.recovery.RecoveryManager.<init>(RecoveryManager.java:372)
    at com.arjuna.ats.arjuna.recovery.RecoveryManager.manager(RecoveryManager.java:132)
    at com.arjuna.ats.arjuna.recovery.RecoveryManager.manager(RecoveryManager.java:113)
    at com.arjuna.ats.jbossatx.jta.TransactionManagerService.create(TransactionManagerService.java:207)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:585)
    at org.jboss.reflect.plugins.introspection.ReflectionUtils.invoke(ReflectionUtils.java:59)
    at org.jboss.reflect.plugins.introspection.ReflectMethodInfoImpl.invoke(ReflectMethodInfoImpl.java:150)
    at org.jboss.joinpoint.plugins.BasicMethodJoinPoint.dispatch(BasicMethodJoinPoint.java:66) 
```

.`............................`

任何想法这里有什么问题？

谢谢，

谭

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-09T14:22:45.973

我的第一个猜测是服务器正在尝试使用一个已经在使用的端口。

您是否安装了任何其他 Web 服务器？我知道有些服务会自动启动。

为了在 Windows 机器上检查这一点，我通常会重新启动，我启动的第一个程序是 Web 服务器，因此它会锁定它需要的任何端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-05T07:57:47.600

我有同样的问题。就我而言，是 Skype 导致了这个问题。当我关闭Skype时，服务器再次启动正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-23T12:37:53.563

**从任务管理器中关闭所有 java 处理文件并重新启动您的 IDE**

![在此处输入图像描述](https://i.stack.imgur.com/mPEAg.png)

# winforms - 我错过了什么... Windows 窗体与亚音速绑定

> ID：836106
> 
> 赞同：1
> 
> 时间：2009-05-07T17:51:32.327
> 
> 标签：winforms, data-binding, subsonic

我有一个带有列表框和几个文本框的表单，当用户从列表框中选择一个项目时，我需要适当的信息显示在 txt 框中并允许用户对其进行编辑。

这是我的表单加载事件：

```
Private prt As New DataAccess.Part

Private Sub Form_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        Dim lc As System.Web.UI.WebControls.ListItemCollection = DataAccess.Part.GetListItems()
        cboParts.DataSource = lc
        lstParts.DataSource = lc

        txtPartBefore.DataBindings.Add(New Binding("Text", prt, "PartNumBefore", True, DataSourceUpdateMode.OnPropertyChanged))
        txtPartAfter.DataBindings.Add(New Binding("Text", prt, "PartNumAfter", True, DataSourceUpdateMode.OnPropertyChanged))
        txtOperation.DataBindings.Add(New Binding("Text", prt, "Operation", True, DataSourceUpdateMode.OnPropertyChanged))
        txtNotes.DataBindings.Add(New Binding("Text", prt, "Notes", True, DataSourceUpdateMode.OnPropertyChanged))

End Sub 
```

以及列表框的 SelectedIndexChange：

```
Private Sub lstParts_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lstParts.SelectedIndexChanged

    Dim ctl As ListControl = DirectCast(sender, ListControl)

    prt = DataAccess.Part.FetchByID(ctl.SelectedValue.value)

End Sub 
```

我正在使用 VB.Net 2005，但如果需要，可以从 C# 转换您的建议；）

谢谢托尼·W

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T17:59:25.973

您实际上并没有将新的 Selected 值绑定到文本框。您所做的只是将您的引用 (prt) 更改为从原始绑定对象指向用户刚刚选择的不同对象。

你需要做这样的事情：

```
 Private Sub lstParts_SelectedIndexChanged(
        ByVal sender As System.Object, ByVal e As System.EventArgs) 
        Handles lstParts.SelectedIndexChanged

        Dim ctl As ListControl = DirectCast(sender, ListControl)

        prt = DataAccess.Part.FetchByID(ctl.SelectedValue.value)

        BindControls(prt)
    End Sub

    Sub BindControls(ByVal newPart as DataAccess.Part)
        txtPartBefore.DataBindings.Clear()
        txtPartAfter.DataBindings.Clear()
        txtOperation.DataBindings.Clear()
        txtNotes.DataBindings.Clear()

        txtPartBefore.DataBindings.Add(
            New Binding("Text", newPart, "PartNumBefore", True, 
            DataSourceUpdateMode.OnPropertyChanged))
        txtPartAfter.DataBindings.Add(
            New Binding("Text", newPart, "PartNumAfter", True, 
            DataSourceUpdateMode.OnPropertyChanged))
        txtOperation.DataBindings.Add(
            New Binding("Text", newPart, "Operation", True, 
            DataSourceUpdateMode.OnPropertyChanged))
        txtNotes.DataBindings.Add(
            New Binding("Text", newPart, "Notes", True, 
            DataSourceUpdateMode.OnPropertyChanged))
    End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T17:56:48.617

你的问题是你分配的事实`prt`。在创建绑定时，您的控件被绑定到任何参考`prt`点。当您稍后分配它时，控件不会指向它。

你应该做的是添加一个`BindingSource`组件，让它指向对象的类型`prt`，然后将你的控件绑定到`BindingSource`组件。当您需要检索时，将 的`DataSource`属性设置`BindingSource`为您检索的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T18:55:36.463

您将绑定到属性“Prt”：

```
public DataAccess.Part Prt { get { return prt; } set { prt = value; } } 
```

或者

```
Public Property Prt() As DataAccess.Part
Get
  Return prt
End Get
Set(ByVal Value As DataAccess.Part)
  prt = value
End Set
End Property 
```

# open-source - 如何在windows系统上编译kscope？

> ID：836114
> 
> 赞同：1
> 
> 时间：2009-05-07T17:53:32.463
> 
> 标签：open-source, cygwin, kde

kscope 是 unix 上一个非常好的 gui 工具，用于分析源代码，我在我的 linux 机器上使用了一段时间。Windows 上是否有任何 kscope 端口可用？我知道cygwin支持kde env。但我无法在上面编译 kde。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-18T13:14:42.050

可能是 1.9.x 版本更适合安装在 Windows 上，因为它是基于 Qt 的。（不需要 KDE）。

法鲁克

# coldfusion - 如何使用 cfexchangeconnection 访问辅助日历？

> ID：836118
> 
> 赞同：1
> 
> 时间：2009-05-07T17:53:55.487
> 
> 标签：coldfusion, calendar, exchange-server

我有一个定义了多个日历的 Exchange 帐户。是否可以使用 cfexchangeconnection 查询辅助日历？

这是我用来获取主日历的代码，但我在 CF8 中看不到任何与我的个人资料中的辅助日历“AltCal”对话的选项。

```
<cfexchangeConnection action="open" username="#theusername#" password="#pw#" server="#exchangeServerIP#" connection="theConnection" protocol="https" >

    <cfexchangecalendar action="get" name="qEvents" connection="theConnection">
        <cfexchangefilter name="maxrows" value="100">
        <cfexchangefilter name="StartTime" from="#CreateDate(2009,5,8)#" to="#CreateDate(2009,5,8)#">
        <cfexchangefilter name="allDayEvent" value="0">
    </cfexchangecalendar>
<cfexchangeConnection action="close" connection="theConnection"> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T14:20:25.797

我仔细查看了[CFML Reference](http://cfquickdocs.com/cf8/?getDoc=cfexchangecalendar)和[User Guide](http://livedocs.adobe.com/coldfusion/8/htmldocs/cfexchange_1.html)，看起来这是不受支持的。

我建议您[将此作为功能请求输入](http://www.adobe.com/go/wish)。我会投票给它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T20:54:36.930

在最坏的情况下，您应该能够通过 .NET/COM cfobject 调用访问您喜欢的内容。当然，做可能是一种互动性的练习。

这可能对你有用..

[http://msdn.microsoft.com/en-us/library/ms878​​108.aspx](http://msdn.microsoft.com/en-us/library/ms878108.aspx)

# asp.net - javascript 和 asp.net 网络用户控件

> ID：836121
> 
> 赞同：1
> 
> 时间：2009-05-07T17:54:16.627
> 
> 标签：asp.net, javascript, jquery, web-user-controls

我有一个 Web 用户控件，可以在客户端上生成以下 html。

我想使用 JavaScript 引用特定的 RadioButton 控件。

我不确定如何执行此操作，因为 RadioButton ID 是由 asp.net 生成的。

例如我给 RadioButton ID =`1_RadioButton`

asp.net 生成一个 ID =`ctl00_ContentPlaceHolder1_Material_1_RadioButton`

这个 javascript 代码如何找到单选按钮控件？

```
 <script type="text/javascript">
        $(document).ready(function() {
            if (document.getElementById("1_RadioButton").checked) {
                $("#1_other").hide();
            }
        });    
    </script> 
```

以下是 asp.net 为客户端生成的内容。

```
 <input id="ctl00_ContentPlaceHolder1_Material_1_RadioButton" type="radio" name="ctl00$ContentPlaceHolder1$Material$Academic" value="1_RadioButton" onclick="javascript:$('#1_other').show('fast');" />

    <label for="ctl00_ContentPlaceHolder1_Material_1_RadioButton">Yes</label>

    <input id="ctl00_ContentPlaceHolder1_Material_2_RadioButton" type="radio" name="ctl00$ContentPlaceHolder1$Material$Academic" value="2_RadioButton" checked="checked" onclick="javascript:$('#1_other').hide('fast');" />

    <label for="ctl00_ContentPlaceHolder1_Material_2_RadioButton">No</label>

    <input id="ctl00_ContentPlaceHolder1_Material_3_RadioButton" type="radio" name="ctl00$ContentPlaceHolder1$Material$Academic" value="3_RadioButton" onclick="javascript:$('#1_other').hide('fast');" />

    <label for="ctl00_ContentPlaceHolder1_Material_3_RadioButton">Uncertain</label>

    <div id='1_other'>
         <input name="ctl00$ContentPlaceHolder1$Material$4_TextBox" type="text" value="bbb chabng" id="ctl00_ContentPlaceHolder1_Material_4_TextBox" />
   </div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T17:58:54.837

如果该代码在 .aspx 文件中，请使用 <%= MyRadioButton.ClientID %> 代替它，ASP.NET 呈现引擎将为您正确呈现 ID。

**更新：**例如：

```
<script type="text/javascript">
    $(document).ready(function() {
        if ($get("<%= MyRadioButton.ClientID %>").checked) {
            $("#1_other").hide();
        }
    });    
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T17:59:24.507

```
var radioButton = document.getElementById("<%= 1_RadioButton.ClientID %>"); 
```

然后从那里去。注意 - 我对引号不肯定。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-07T18:08:24.203

我写了[一篇关于如何做到这一点](http://ralphwhitbeck.com/2009/01/31/SelectingAASPNETGeneratedIDWithJQuery.aspx)的博客文章：

> 假设您的页面上有一个标签控件：
> 
> 生成的 html 输出和该控件的 ID 可能如下所示：

```
<span id="ctl00_ContentPlaceHolder1_Label1"></span> 
```

> 不幸的是，生成的 ct100_ContentPlaceHolder1_Label1 的 ID 在构建之间并不总是相同的。所以尝试像这样选择它：
> 
> `$("#ct100_ContentPlaceHolder1_Label1").hide();`
> 
> 最终会中断，它不会隐藏标签控件。
> 
> 诀窍是在 jQuery 选择器中使用 ASP.NET。Label1.ClientID 每次都会返回生成的 ID。我们将 ASP.NET 和 jQuery 组合成一行，如下所示：
> 
> `$("#<%= Label1.ClientID %>").hide();`
> 
> 这将每次都获得Label控件的生成ID。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-14T08:44:17.417

非常简单，只需将`clientidmode`Web 控件的设置为静态 ( `clientidmode="static"`)，您就可以确定这`asp.net`将保持您`ID`在设计器 UI 中的外观。

# iphone - Objective-C/Cocoa：正确加载 UIViews

> ID：836125
> 
> 赞同：0
> 
> 时间：2009-05-07T17:55:15.657
> 
> 标签：iphone, objective-c, cocoa-touch

假设我在 Interface Builder 中创建了一个`UIView`, `MyView`，并且我已经将它连接（设置它的文件所有者）到我的`UIViewController`类，`MyViewController`.

现在，我想介绍一下观点。这只是另一个视图，所以我不想将其呈现为模态视图。

我该如何去展示它？我应该将它添加为我的窗口的子视图吗？如果是这样，相对于我的其他观点，它在哪里？我应该以某种方式将其作为视图呈现，并禁用其他视图吗？机制是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T03:36:51.500

这取决于您希望应用程序如何运行。

[您可以使用UIView addSubview](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instm/UIView/addSubview:)将 MyView 添加为当前视图的子视图，如果您要在 MyView 上有一个“完成”按钮或类似的东西来删除自己。

```
// show new view
MyViewController *myViewController = [[MyViewController alloc]init];
[self.view addSubview: myViewController.view]; 
```

或者，如果您希望用户能够导航回主视图（例如在邮件、便笺等中），最常见的方法是在您的窗口中添加一个 navigationController 并使用[pushViewController:animated:](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UINavigationController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006934-CH3-SW2)来呈现您的视图.

```
MyViewController *myViewController = [[MyViewController alloc]init];
[self.navigationController pushViewController:myViewController animated:YES]; 
```

在大多数情况下，我更喜欢 navigationController 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:21:52.923

请参阅[http://developer.apple.com/iPhone/library/featuredarticles/ViewControllerPGforiPhoneOS/PresentingModelViewControllers/PresentingModelViewControllers.html](http://developer.apple.com/iPhone/library/featuredarticles/ViewControllerPGforiPhoneOS/PresentingModelViewControllers/PresentingModelViewControllers.html)

# moss - 如何使用 VseWSS 1.3 创建新文件夹并将文件部署到 12 个配置单元？

> ID：836142
> 
> 赞同：1
> 
> 时间：2009-05-07T17:59:07.113
> 
> 标签：moss, wss

我使用 VSeWSS 1.3 创建了一个 Web 部件。它创建了一个 wsp 文件并安装了我的 Web 部件，一切正常。

我还想在 12 个配置单元的 LAYOUTS 目录中创建一个文件夹，并在其中放置几个​​文件。我该怎么做呢？我知道我可以手动将文件放在那里，但是当我使用 stsadm 安装我的解决方案时，我更愿意一口气完成所有工作。

是否有使用 VSeWSS 1.3 执行此操作的最佳实践指南？他们用这个新版本改变了很多东西，我想确保我不会搞砸任何事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T18:20:34.940

您可以在 webpart 项目中创建新的文件夹结构，例如：Templates/Layouts/CustomFolder 并将您的文件放在 CustomFolder 目录中并将它们包含在您的项目中。

当您转到 Visual Studio 中的 WSP 视图时，您可以在 manifest.xml 中看到您的文件已包含在部署中。

我现在已经在多个项目上成功地做到了这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T19:48:56.600

如果有人想知道，VSeWSS 1.3 用户指南非常有用。它安装到与工具本身相同的目录，默认在`C:\Program Files\Microsoft SharePoint Developer Tools 9.0\VSeWSS13.CHM`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-20T14:52:20.520

**[您可以在此处](http://mysharepointwork.blogspot.com/2010/01/deploy-files-to-12-hive-with-webpart.html)**查看带有屏幕截图的工作示例

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-06T04:58:26.397

上述内容的简单分步教程以及部署/撤回脚本位于[通过 SharePoint 解决方案将新文件添加到 12-Hive](http://simplesharepointsolutions.blogspot.com/2010/06/add-new-files-to-12-hive-through_2091.html)中。只需按照步骤操作，几分钟后您就可以将任何您想要的内容添加到 12-Hive！

# c# - C# 的 Gedcom 阅读器

> ID：836146
> 
> 赞同：9
> 
> 时间：2009-05-07T17:59:34.850
> 
> 标签：c#, genealogy, gedcom

有谁知道读.ged文件的好课

Gedcom 是一种用于存储家谱信息的文件格式。

我的目标是写一些东西，让我可以导入一个 ged 文件并为 graphviz 导出一个 .dot 文件，这样我就可以对家谱进行可视化表示

谢谢，如果你能帮忙

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T14:13:45.227

这是我迄今为止最好的尝试。

它似乎可以满足我的需要，尽管它显然不是完整的证明（然后我的家谱又相当大，这增加了一些复杂性）

请让我知道你是否认为我可以做得更优雅

```
struct INDI
        {
            public string ID;
            public string Name;
            public string Sex;
            public string BirthDay;
            public bool Dead;

        }
        struct FAM
        {
            public string FamID;
            public string type;
            public string IndiID;
        }
        List<INDI> Individuals = new List<INDI>();
        List<FAM> Family = new List<FAM>();
        private void button1_Click(object sender, EventArgs e)
        {
            string path = @"C:\mostrecent.ged";
            ParseGedcom(path);
        }

        private void ParseGedcom(string path)
        {
            //Open path to GED file
            StreamReader SR = new StreamReader(path);

            //Read entire block and then plit on 0 @ for individuals and familys (no other info is needed for this instance)
            string[] Holder = SR.ReadToEnd().Replace("0 @", "\u0646").Split('\u0646');

            //For each new cell in the holder array look for Individuals and familys
            foreach (string Node in Holder)
            {

                //Sub Split the string on the returns to get a true block of info
                string[] SubNode = Node.Replace("\r\n", "\r").Split('\r');
                //If a individual is found
                if (SubNode[0].Contains("INDI"))
                {
                    //Create new Structure
                    INDI I = new INDI();
                    //Add the ID number and remove extra formating
                    I.ID = SubNode[0].Replace("@", "").Replace(" INDI", "").Trim();
                    //Find the name remove extra formating for last name
                    I.Name = SubNode[FindIndexinArray(SubNode, "NAME")].Replace("1 NAME", "").Replace("/", "").Trim(); 
                    //Find Sex and remove extra formating
                    I.Sex = SubNode[FindIndexinArray(SubNode, "SEX")].Replace("1 SEX ", "").Trim();

                    //Deterine if there is a brithday -1 means no
                    if (FindIndexinArray(SubNode, "1 BIRT ") != -1)
                    {
                        // add birthday to Struct 
                        I.BirthDay = SubNode[FindIndexinArray(SubNode, "1 BIRT ") + 1].Replace("2 DATE ", "").Trim();
                    }

                    // deterimin if there is a death tag will return -1 if not found
                    if (FindIndexinArray(SubNode, "1 DEAT ") != -1)
                    {
                        //convert Y or N to true or false ( defaults to False so no need to change unless Y is found.
                        if (SubNode[FindIndexinArray(SubNode, "1 DEAT ")].Replace("1 DEAT ", "").Trim() == "Y")
                        {
                            //set death
                            I.Dead = true;
                        }
                    }
                    //add the Struct to the list for later use
                    Individuals.Add(I);
                }

                // Start Family section
                else if (SubNode[0].Contains("FAM"))
                {
                    //grab Fam id from node early on to keep from doing it over and over
                    string FamID = SubNode[0].Replace("@ FAM", "");

                    // Multiple children can exist for each family so this section had to be a bit more dynaimic

                    // Look at each line of node
                    foreach (string Line in SubNode)
                    {
                        // If node is HUSB
                        if (Line.Contains("1 HUSB "))
                        {

                            FAM F = new FAM();
                            F.FamID = FamID;
                            F.type = "PAR";
                            F.IndiID = Line.Replace("1 HUSB ", "").Replace("@","").Trim();
                            Family.Add(F);
                        }
                            //If node for Wife
                        else if (Line.Contains("1 WIFE "))
                        {
                            FAM F = new FAM();
                            F.FamID = FamID;
                            F.type = "PAR";
                            F.IndiID = Line.Replace("1 WIFE ", "").Replace("@", "").Trim();
                            Family.Add(F);
                        }
                            //if node for multi children
                        else if (Line.Contains("1 CHIL "))
                        {
                            FAM F = new FAM();
                             F.FamID = FamID;
                            F.type = "CHIL";
                            F.IndiID = Line.Replace("1 CHIL ", "").Replace("@", "");
                            Family.Add(F);
                        }
                    }
                }
            }
        }

        private int FindIndexinArray(string[] Arr, string search)
        {
            int Val = -1;
            for (int i = 0; i < Arr.Length; i++)
            {
                if (Arr[i].Contains(search))
                {
                    Val = i;
                }
            }
            return Val;
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T18:27:52.567

Codeplex 上有一个非常漂亮的：[FamilyShow](http://familyshow.codeplex.com/)（一个 WPF 展示）。它导入/导出 GEDCOM 5.5 并且有源代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-07T18:29:33.750

如果至少*没有*一个开始，我实际上会感到惊讶。我很容易找到[Gedcom.NET](http://www.ritter.demon.co.uk/Projects/gedcom.net.html) ( [sourceforge )](http://sourceforge.net/project/showfiles.php?group_id=202650)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T18:10:54.260

如果网络上有适用于这种格式的 C# 阅读器，我会感到相当惊讶，因为它是一种相当专业的格式。从好的方面来说，如果您需要创建自己的阅读器，这种格式看起来很容易阅读。如果您对实施有具体问题，我建议您沿着这条路走，然后再回到 SO。看看`System.IO.StreamReader`课堂；以这种方式逐行读取文件很简单，并且解析各个行也应该很简单。

祝你好运！

# java - 用 Spring 构建字符串？

> ID：836155
> 
> 赞同：2
> 
> 时间：2009-05-07T18:02:52.283
> 
> 标签：java, spring

我正在重新熟悉 Spring，并以前所未有的方式看待依赖注入和 IoC。

如果我想构建一个字符串，比如说一个文件名，并且我已经有一个包含该目录的 Spring bean，那么附加文件名的最佳方法是什么？

自己编写一个 bean 来做这件事似乎相当简单，但我认为 Spring 可能已经有能力通过它的 API 在某个地方做这件事。如果这是可能的，怎么做？

只是为了好玩，这里是相当简单的 bean 的实现......

```
public class MySimpleStringAppender {

    private final StringBuffer myString = new StringBuffer();

    public MySimpleStringAppender(List<String> myStrings) {
        for (String string : myStrings) {
            myString.append(string);
        }
    }

    public String getMySimpleString() {
        return myString.toString();
    }

} 
```

并配置...

```
<bean id="filename" class="MySimpleStringAppender">
    <constructor-arg ref="filenameStrings"/>
</bean>

<util:list id="filenameStrings">
    <ref bean="directory"/>
    <value>filename.txt</value>
</util:list>

<bean id="directory" class="java.lang.String">
    <constructor-arg value="C:/myDirectory/"/>
</bean> 
```

因此，虽然这不是很多工作或代码，但我认为会有一些可用的东西，所以我根本不需要写这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T18:17:44.993

不，从来没有见过这样的事情。您还可以通过将所有这些组合成一个来使您的 XML 更简单：

```
<bean id="filename" class="MySimpleStringAppender">
   <constructor-arg>
      <list>
         <value>C:/myDirectory</value>
         <value>filename.txt</value>
      </list>
   </constructor-arg> 
</bean> 
```

但你可能已经知道了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T18:23:32.437

也许将“c：/myDirectory”定义为属性并执行以下操作：

```
<bean id="filename" class="java.lang.String">
    <constructor-arg value="${dir}/filename.txt"/>
</bean> 
```

它会起作用吗？

# sas - 在 SAS 中，什么是捕捉语法错误的好技术/选项？

> ID：836157
> 
> 赞同：11
> 
> 时间：2009-05-07T18:03:13.140
> 
> 标签：sas

在增强的编辑器中，着色可能会给您一个提示。但是，在大型机上，我认为编辑器中没有任何东西可以帮助您。

我用

```
OPTIONS OBS=0 noreplace; 
```

obs=0 选项指定从输入数据集中读取 0 个观测值，并且 NOREPLACE 告诉 SAS 不要覆盖具有相同名称之一的现有 SAS 数据集。如果您正在创建一个新的数据集，它将使用所有属性创建，但有 0 个观察值。（如果需要，请务必将选项重置为 Options Obs=max replace ; 当没有发现更多语法错误时）。

我会对任何其他技术感兴趣。谢谢

关于选项的解释来自[这里。](http://www.listserv.uga.edu/cgi-bin/wa?A2=ind9704e&L=sas-l&P=56)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-07T18:37:45.460

我在运行语句中使用取消选项。它将检查数据步骤的语法，然后终止它而不实际执行它。它是类似于`noexec`proc sql 中的选项的数据步骤。

```
data something;
<stuff here>
run cancel; 
```

此[SUGI pdf中有更多详细信息](http://www2.sas.com/proceedings/sugi31/063-31.pdf)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-08-12T18:09:40.663

我在我的 PC 上使用 SAS 和增强的彩色编码编辑器在我的 PC 上编写我的所有代码。然后我使用 SAS/CONNECT 在大型机上处理它。如果数据集在 DASD 上，我使用 SAS/CONNECT 和 Enterprise Guide 直接在大型机上运行代码（没有 JCL！）如果涉及数据磁带，因此必须批量运行，我使用 SAS/CONNECT 和 SAS ftp 引擎将代码发送到大型机批处理队列。我使用 SAS 电子邮件引擎将我的输出和日志通过电子邮件发送给我。我把ODS三明治放在我的代码中，让大型机生成一个WORD文档用于输出。我使用 PROC 下载将输出下载到我的服务器，以便我可以在 WORD 中打开它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-08-12T18:37:51.417

该建议与语言无关。

I would argue that a preferable technique for catching syntax (and logic) errors is to perform a close read (or inspection) of your own code (which should catch the majority of syntax errors), followed by unit tests on small datasets (which will catch any remaining syntax errors, as well as many logic errors if your tests are well-designed).

I agree there's some worth to syntax checking in isolation, but to read and understand your code thoroughly enough before the first compile so that you *know* it will compile is a good ideal to strive for. Steve McConnell touches on this idea in Code Complete (see page 827 of the 2nd Edition).

P.S. You mentioned syntax highlighting in your original post; there are other editors (such as VIM) that will perform syntax highlighting on SAS files.

# html - CSS在标题内容后添加下划线

> ID：836159
> 
> 赞同：2
> 
> 时间：2009-05-07T18:04:03.030
> 
> 标签：html, css, cross-browser

**问题**

我正在开发一个以网站为主题的项目，但我不允许更改 HTML 或 JavaScript。我只能更新 CSS 样式表和添加/更新图像。

**要求**

*   我需要设置一个 h3 标签的样式，使其在内容之后有一个下划线/边框。
*   这个h3会在页面上多次使用，所以内容长度可以变化
*   解决方案需要跨浏览器（IE 6/7/8, FF 3, & Safari）

**示例代码**

```
<div class="a">
   <div class="b"><!-- etc --></div>
   <div class="c">
      <h3>Sample Text To Have Line Afterwards</h3>
      <ul><!-- etc --></ul>
      <p class="d"><!-- etc --></p>
   </div>
</div> 
```

**样本输出**

```
后面有一行的示例文本 ______________________________________

另一个例子 __________________________________________________________

还有另一个例子 __________________________________________________

```

**笔记**

*   我认为#sample:after { content: "__________"; } 选项不起作用，因为这只是其中一个标签的正确长度
*   我尝试了一个背景图像，但是如果我给它一个大宽度的背景图像，它会给我带来问题
*   使用 text-indent 没有看到给我想要的效果
*   我尝试了边框底部和文本装饰的组合：无，但这似乎也不起作用

***任何想法将不胜感激！***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T18:12:30.873

尝试将背景图像附加到重复下划线的 c 类，然后将背景颜色添加到 h3 以匹配容器的背景。我相信您必须将 h3 向左浮动才能使宽度折叠。那有意义吗？

```
.c {
    background: #ffffff url(underline.gif) left 20px repeat-x;
}
.c h3 {
    margin: 0;
    padding: 0 0 2px 0;
    float: left;
    font-size: 20px;
    background: #ffffff;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T18:25:30.403

如果类'c'总是h3的父级，这将起作用......

```
.c {
    position: relative;
    margin-top: 25px;
    border-top: 1px solid #000;
    padding: 0px;
}
h3 {
    font-size:20px;
    margin-top: 0px;
    position: absolute;
    top: -18px;
    background: #fff;
} 
```

它让容器拥有边框，然后使用绝对定位将 h3 移到它上面，背景颜色让它遮住它所覆盖的 c 边框部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T18:39:57.750

```
.c h3 { display: inline; background-color: white; margin: 0; padding: 0; line-height: 1em; }
.c ul { margin-top: -1px; border-top: 1px solid; padding-top: 1em; /* simulate margin with padding */ } 
```

[http://besh.dwich.cz/tmp/h3.html](http://besh.dwich.cz/tmp/h3.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T18:40:13.067

您可以在 UL 标签中填充内容吗？如果是这样，这可能会起作用：

```
h3 { display: inline; margin: 0; padding: 0 10px 0 0; float: left;}
ul { display: inline; border-bottom: 1px solid black; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T19:33:52.690

check source code of: [http://nonlinear.cc/lab/friends/elijahmanor.html](http://nonlinear.cc/lab/friends/elijahmanor.html)

then again i have NO IDEA how to control the end of the line.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T23:11:44.537

假设您正在使用动态内容，我建议的最好方法是接受优雅降级并使用 great_llama 和 Bohdan Ganicky 的组合

想象：

```
A long title that will wrap to two lines___________________ 
and leave you like this in great_llama's solution 
```

如果 ul 不是紧接在 ul 之前，则 Bohdan Ganicky 的解决方案根本不会出现任何内容。

解决方案：

```
.c h3 { display: inline; background-color: white; margin: 0; padding: 0; line-height: 1em; }
.c + * { margin-top: -1px; border-top: 1px solid; padding-top: 1em; /* simulate margin with padding */ } 
```

我们关心 IE6，但接受这是一种审美接触，IE6 用户不会受到影响。如果你不能让设计师接受这个并且你不能改变 HTML，那么做其他事情（在你找到另一份工作之前[；）](http://xkcd.com/541/)）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T18:17:40.500

```
 H3 {
    border: 1px solid red;
    border-width: 0 0 1px 0;
    text-indent: -60px;
 } 
```

您需要知道文本的宽度，但效果很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T18:18:16.537

到目前为止，我想象的唯一解决方案是制作一个 PNG 或 GIF 图像，高度为 1 像素，宽度非常大（取决于您的项目，可能是 1x2000 像素），然后执行以下操作：

```
h3#main-title { background: url(line.png) no-repeat bottom XYZem; } 
```

您为每个标题手动设置的 XYZ，以“em”为单位。但是如果不使用 JS 或添加额外的标记，我无法为这个解决方案找到 100% 的动态解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-07T18:26:02.073

这对我有用

```
 div.c
        {
        background-image:url(line.gif);background-repeat:repeat-x;width:100%;height:20px;
        }
        div.c h3
        {
        height:20px;background-color:white;display:inline;
        } 
```

你让 div 成为你的内容的宽度

然后将 h3 的背景设置为页面的背景。这将与整个 div 的背景图像重叠。您可能想要根据您的图像使用背景定位

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-07T18:34:55.403

这是一个更好的答案：

```
 .c {
    background: url('line.png') repeat-x 0 20px;
 }
 H3 {
    background-color: white;
    display: inline;
    position: relative;
    top: 1px;
 } 
```

使用一个 1px 高、几 px 宽的小图像作为下划线，并在 H3 上用背景颜色遮挡它。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-05-07T18:12:41.557

```
h3:after {
  content: '___________';
} 
```

# django - Django 验证错误数组

> ID：836160
> 
> 赞同：2
> 
> 时间：2009-05-07T18:05:00.203
> 
> 标签：django, django-forms, django-validation

我在用

```
rf['email'].errors 
```

正如文档中所说，我可以使用它来产生一系列错误。

```
[str(e) for e in rf['email'].errors]  #give me ["<django.utils.functional.__proxy__>"] 
```

如果 repr 或 str - 它给出 ul 或数组字符串。

所以它只有在我同时使用 repr 和 eval 时才有效。但我认为这是愚蠢的解决方案。

```
eval(`rf['email'].errors`) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T18:38:39.110

根据您想要的输出，您有几个选项。

选项一，使用 unicode 构造函数转换数据：

```
list_of_error_texts = [unicode(e) for e in rf['email'].errors] 
```

（Django 的代理对象实现了一个响应 unicode 的方法。）

选项二，将 ErrorList 作为文本获取。这会生成一个以换行符分隔的错误文本列表，每行前面都有一个星号：

```
print rf['email'].errors.as_text()
* My error one
* My error two 
```

选项三，使用 django 的 force_unicode 函数。这类似于`unicode`，但具有一些额外的安全功能：

```
from django.utils.encoding import force_unicode
list_of_error_texts = [force_unicode(e) for e in rf['email'].errors] 
```

# wpf - 自动大写WPF中的所有输入

> ID：836162
> 
> 赞同：31
> 
> 时间：2009-05-07T18:05:35.040
> 
> 标签：wpf, input, uppercase

有没有办法自动将整个 WPF 应用程序中的所有输入大写？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-05-07T18:14:40.523

`TextBox`您可以使用以下属性将所有输入设置为控件：

```
CharacterCasing="Upper" 
```

要应用于`TextBox`整个应用程序中的所有控件，请为所有控件创建样式`TextBox`：

```
<Style TargetType="{x:Type TextBox}">
    <Setter Property="CharacterCasing" Value="Upper"/>
</Style> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-20T21:45:29.903

如果您想将单个`TextBox`而不是所有`TextBox`es[的](https://stackoverflow.com/a/836197/2597913)输入大写，您可以使用以下命令：

```
<TextBox CharacterCasing="Upper"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T18:34:31.223

我建议创建一个自定义 Textbox 类并覆盖一个事件以自动将文本大写。首先，这取决于您是否希望在输入时或在输入完成后将文本大写。

例如输入完成后

```
public class AutoCapizalizeTextBox: TextBox
{
  public AutoCapitalizeTextBox()
  {
  }

  public AutoCapitlizeTextBox()
  {
  }

  protected override void OnLostFocus(EventArgs e)
  {
    this.Text = this.Text.ToUpper();

    base.OnLostFocus(e);
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-04T00:45:02.780

我不知道这是否有帮助，它将句子中的所有首字母大写。

[http://www.mardymonkey.co.uk/blog/auto-capitalise-a-text-control-in-wpf/](http://www.mardymonkey.co.uk/blog/auto-capitalise-a-text-control-in-wpf/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-02T04:57:09.777

也许您可以使用转换器。这是转换器的代码：

```
using System;
using System.Globalization;
using System.Windows.Data;
namespace SistemaContable.GUI.WPF.Converters
{
    public class CapitalizeFirstLetter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value != null)
            {
                string stringToTitleCase = culture.TextInfo.ToTitleCase(value.ToString());
                return stringToTitleCase;
            }
            else
            {
                return null;
            }
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            return value.ToString();
        }
    }
} 
```

您需要在“ResourceDictionary”或“App.xaml”中引用它：

```
<ResourceDictionary xmlns:converters="clr-namespace:SistemaContable.GUI.WPF.Converters">
    <converters:CapitalizeFirstLetter x:Key="CapitalizeFirstLetter"/>
</ResourceDictionary> 
```

你可以像这样使用它：

```
<TextBox x:Name="txtNombre" Text="{Binding Usuario.Nombre, Converter={StaticResource CapitalizeFirstLetter}, UpdateSourceTrigger=PropertyChanged}"/> 
```

# visual-studio - Visual Studio 和 LINQ：将 DBML 文件放在项目中的单独目录中

> ID：836165
> 
> 赞同：5
> 
> 时间：2009-05-07T18:06:12.150
> 
> 标签：visual-studio, linq-to-sql, dbml

我的策略是保持项目的布局干净。鉴于这是一个数据层项目，并且我将为每个相关实体都有一个类文件，我想我会将 .dbml 放到它自己的目录中。事实证明，在子目录中定位您的 .dbml 文件会将其变成某种较低级别的命名空间。

这是一个 C# 类库项目。

有什么提示可以关闭此功能并访问 LinqToSql dbml 数据上下文名称，而无需键入目录名称即可访问实际的 LinqToSql 类？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-07T18:34:34.673

结果你需要在 LinqToSql 设计画布上找到你的 DBML 的属性。

*   右键单击-> 属性找到上下文命名空间。
*   键入您希望 DataContext 类可用的命名空间。
*   在下方，找到实体命名空间。
*   照着做

Resharper 用户：您可以选择查看 DBML 子目录的属性，并在那里设置命名空间属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T18:19:12.137

如果您转到解决方案中的目录并查看该目录的属性，您将看到以下属性：Namespace provider = true

将此设置为假

然后，您可以更新命名空间以匹配 DBML 文件中的根命名空间。现在，每当您在其中添加新的 dbml 文件时，它都会保留基于根文件夹的命名空间。

# sql-server - 外键会自动创建索引吗？

> ID：836167
> 
> 赞同：426
> 
> 时间：2009-05-07T18:06:18.063
> 
> 标签：sql-server

有人告诉我，如果我将两个表作为外键，SQL Server 将在子表中创建类似于索引的东西。我很难相信这是真的，但找不到与此相关的太多内容。

我问这个问题的真正原因是因为我们在一个可能有 15 个相关表的表的删除语句中遇到了一些非常慢的响应时间。我问过我们的数据库人员，他说如果字段上有外键，那么它就像一个索引。您对此有何经验？我应该在所有外键字段上添加索引还是它们只是不必要的开销？

* * *

## 回答 #1

> 赞同：386
> 
> 时间：2009-05-07T18:10:23.857

外键是一个约束，是两个表之间的关系——与索引本身无关。

但众所周知的事实是，对属于任何外键关系的所有列进行索引是很有意义的，因为通过 FK 关系，您通常需要查找相关表并根据单个值或一系列值。

因此，对 FK 中涉及的任何列进行索引是很有意义的，但 FK 本身并不是索引。

查看 Kimberly Tripp 的优秀文章[“SQL Server 何时停止在外键列上放置索引？”](https://www.sqlskills.com/blogs/kimberly/when-did-sql-server-stop-putting-indexes-on-foreign-key-columns/) .

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-05-07T18:18:01.093

哇，答案都在地图上。所以[文档](http://doc.ddart.net/mssql/sql2000/html/createdb/cm_8_des_04_8ypg.htm)说：

FOREIGN KEY 约束是索引的候选者，因为：

*   使用相关表中的 FOREIGN KEY 约束检查对 PRIMARY KEY 约束的更改。

*   当来自相关表的数据通过将一个表的 FOREIGN KEY 约束中的列与另一表中的主键或唯一键列匹配来组合查询时，外键列通常用于连接条件。索引允许 Microsoft® SQL Server™ 2000 在外键表中快速查找相关数据。但是，创建此索引不是必需的。即使两个表之间没有定义 PRIMARY KEY 或 FOREIGN KEY 约束，也可以组合来自两个相关表的数据，但是两个表之间的外键关系表明这两个表已被优化为在使用键作为查询的查询中组合其标准。

所以看起来很清楚（尽管文档有点混乱）它实际上并没有创建索引。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-07T18:11:55.147

不，外键字段没有隐式索引，否则微软为什么会说[“在外键上创建索引通常很有用”](http://msdn.microsoft.com/en-us/library/ms175464.aspx)。您的同事可能会将引用表中的外键字段与被引用表中的主键混淆 - 主键*确实会*创建隐式索引。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-04-16T15:25:29.103

外键不创建索引。只有备用键约束（唯一）和主键约束创建索引。在 Oracle 和 SQL Server 中确实如此。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-07T18:14:20.617

SQL Server 会为主键自动创建索引，但不会为外键创建索引。为外键创建索引。这可能是值得的开销。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-07T18:23:09.113

假设您有一张名为 orders 的大桌子和一张名为 customers 的小桌子。从订单到客户有一个外键。现在如果你删除一个客户，Sql Server 必须检查没有孤单；如果有，则会引发错误。

要检查是否有任何订单，Sql Server 必须搜索大订单表。现在如果有索引，搜索会很快；如果没有，搜索会很慢。

所以在这种情况下，缓慢的删除可以用没有索引来解释。特别是如果 Sql Server 必须搜索 15 个没有索引的大表。

PS 如果外键有 ON DELETE CASCADE，Sql Server 仍然要搜索订单表，但随后要删除所有引用已删除客户的订单。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-07-07T13:24:50.370

在 PostgeSql 中，如果您点击 \d tablename，您可以自己检查索引

您将看到已在具有主键和唯一约束的列上自动创建 btree 索引，但不会在具有外键的列上创建。

我认为这至少回答了你的postgres问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-07T18:22:33.437

严格来说，外键与索引完全无关，是的。但是，正如我上面的发言者所指出的，创建一个来加速 FK 查找是有意义的。事实上，在 MySQL 中，如果您没有在 FK 声明中指定索引，引擎 (InnoDB) 会自动为您创建它。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-07T18:10:44.917

据我所知不是。外键只添加了一个约束，即子键中的值也可以在父列的某处表示。它并没有告诉数据库子键也需要被索引，只是受到约束。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2021-01-25T16:03:17.153

这取决于。如果您不自己创建索引，则会在 MySQL 上创建索引：

> MySQL 要求对外键列进行索引；如果创建具有外键约束但在给定列上没有索引的表，则会创建索引。

来源：[https ://dev.mysql.com/doc/refman/8.0/en/constraint-foreign-key.html](https://dev.mysql.com/doc/refman/8.0/en/constraint-foreign-key.html)

MySQL 5.6 也一样。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-09-02T14:32:02.947

我注意到指向 MSSQL 的 Entity Framework 6.1 确实会自动在外键上添加索引。

# c# - SQL Server 2000 中的 VARCHAR 排序规则与 VARBINARY 排序

> ID：836169
> 
> 赞同：0
> 
> 时间：2009-05-07T18:07:46.157
> 
> 标签：c#, sql-server, string, collation

我需要在 C# 中将来自一个或多个 SQL Server 2000 数据库的两个排序的字符串流在内存中合并到一个排序的流中。这些数据流可能很大，所以我不想将两个流都拉到内存中。相反，我需要在内存中的每个流中一次保留一个项目，并且在每个步骤中，比较每个流中的当前项目，将最小值推送到最终流中，然后从适当的源流中提取下一个项目。但是，要正确执行此操作，内存中的比较必须与数据库的排序规则相匹配（考虑流`[A,B,C]`和`[A,B,C]`：正确的合并序列是`[A,A,B,B,C,C]`，但如果您的内存中比较认为，您的内存中`C < B`合并将产生`A,A,B`它将查看 a`B`和 a`C`, 并将产生`C`, 导致错误排序的流。）

所以，我的问题是：有没有办法用`System.StringComparison`C# 中的枚举来模仿 SQL Server 2000 中的任何排序规则或反之亦然？我最接近的是使用`System.StringCompaison.Ordinal`转换为`VARBINARY`标准`VARBINARY`排序的数据库字符串的结果，这是可行的，但我宁愿只`"order by name collate X"`在我的 SQL 查询中添加一个子句，其中 X 是一些排序规则，其工作方式与`VARBINARY`排序，而不是将所有字符串在`VARBINARY`它们离开数据库时转换为字符串，然后在它们进入内存时转换为字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T18:15:32.910

看看[`StringComparer`](http://msdn.microsoft.com/en-us/library/system.stringcomparer.aspx)课堂。这提供了比使用`String.Compare`. 有三组静态实例（`CurrentCulture`、`InvariantCulture`、`Ordinal`）和每组的不区分大小写的版本。对于更专业的文化，您可以使用该`StringComparer.Create()`函数创建与特定文化相关的比较器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:16:55.293

使用 sql 2005，我知道 db 引擎不会调用 OS 来进行排序，排序规则是静态随 db 一起提供的（可能会随服务包更新，但不会随操作系统而改变）。所以我不认为你可以肯定地说一组给定的应用程序代码可以以相同的方式排序，除非你有与数据库服务器相同的代码，除非你使用二进制排序规则。

但是，如果您在数据库和客户端代码中使用二进制排序规则，您应该完全没有问题。

编辑 - 任何以 _BIN 结尾的排序规则都会给你二进制排序。排序规则名称的其余部分将确定用于存储 CHAR 数据的代码页，但不会影响排序。_BIN 表示严格的二进制排序。请参阅[http://msdn.microsoft.com/en-us/library/ms143515(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms143515(SQL.90).aspx)

# iphone - 有没有办法从 iPhone 通讯簿 API 中获取“我”卡？

> ID：836190
> 
> 赞同：24
> 
> 时间：2009-05-07T18:13:19.233
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, addressbook

所以我被这个难住了。

在 Mac OS X 中，有一种简单的方法可以从内置的地址簿 API 中获取“我”卡（Mac/帐户的所有者）。

有没有人找到一种方法来找出哪个联系人（如果存在）属于 iPhone 的所有者？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T11:48:49.077

您可以使用未记录的用户默认值：

```
[[NSUserDefaults standardUserDefaults] objectForKey:@"SBFormattedPhoneNumber"]; 
```

然后在地址簿中搜索具有该电话号码的卡。

请记住，由于用户默认值未记录在案，Apple 可能随时更改，您可能无法进入 App Store。

您可以采取的另一种方法是查看设备名称，尽管它要脆弱得多。如果用户没有从默认的“用户名的 iPhone”更改它并且他们使用他们的真实姓名作为 iPhone，您可以从中获取用户名。同样，无论如何都不是最好的解决方案，但它确实为您提供了其他尝试。

对于这个问题，普遍接受的答案是向 Apple 提交有关此功能的 Radar 并提示用户选择他们的卡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-05-16T13:02:28.867

联系人容器在 iOS 上有一个 me 标识符属性，可以使用`container.value(forKey: "meIdentifier")`

```
if let containers = try? CNContactStore().containers(matching: nil) {
  containers.forEach { container in
  if let meIdentifier = container.value(forKey: "meIdentifier") as? String {
    print("Contacts:", "meIdentifier", meIdentifier)
  }
} 
```

该标识符是旧地址簿框架中使用的遗留标识符。您仍然可以在 CNContact 中访问它：

```
let iOSLegacyIdentifier = contact.value(forKey: "iOSLegacyIdentifier") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T11:19:30.607

iPhone SDK 2.2.1 及更早版本中没有此类 API。请在以下网址提交请求： http: [//bugreport.apple.com](http://bugreport.apple.com)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T16:56:19.573

编辑：[过时的答案]

没有获取“我”卡的 API，因为没有“我”卡。iPhone 的联系人应用程序无法将卡片标记为“我”，而 API 反映了这一点。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2017-06-07T13:39:22.463

我想出了一个部分解决方案

您可以按如下方式获取设备名称

```
NSString *ownerName = [[UIDevice currentDevice] name]; 
```

在英语中，设备最初被称为，例如，“Joe Blogg 的 iPhone”

打出名字

```
 NSRange t = [ownerName rangeOfString:@"’s"];
    if (t.location != NSNotFound) {
        ownerName = [ownerName substringToIndex:t.location];
    } 
```

然后，您可以使用该名称并搜索联系人

CNContactStore *contactStore = [CNContactStore 新];

```
 NSPredicate *usersNamePredicate = [CNContact predicateForContactsMatchingName:usersName];

    NSArray * keysToFetch = @[[CNContactFormatter descriptorForRequiredKeysForStyle:CNContactFormatterStyleFullName],CNContactPhoneNumbersKey,CNContactEmailAddressesKey,CNContactSocialProfilesKey, ];

 NSArray * matchingContacts = [contactStore unifiedContactsMatchingPredicate:usersNamePredicate keysToFetch:keysToFetch error:nil]; 
```

当然，其他语言在设备名称字符串中有所不同，例如“iPhone Von Johann Schmidt”，因此需要对其他语言进行更多解析，并且仅当用户没有将 iTunes 中的设备名称更改为“Joes”之类的名称时才有效电话”，但它为您提供了一个起点

好吧...它为您提供了一系列匹配的项目:) 因此，如果与该阵列有多个联系人，您只需要使用运气并使用第一个或通过多张卡片工作并从每张卡片中获取您需要的东西.

我确实说过它是一个部分解决方案，即使它不适用于所有用户案例，您可能会发现它适用于您的许多用户并减少了一点摩擦

# python - 如何为 pylons 静态（公共）文件设置自定义响应标头？

> ID：836191
> 
> 赞同：3
> 
> 时间：2009-05-07T18:13:41.353
> 
> 标签：python, http-headers, pylons

如何将自定义标头添加到 pylons 从公共提供的文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:29:20.440

a) 让您的网络服务器从 /public 而非 paste 提供文件，并将其配置为传递一些特殊的标头。

b）添加一个特殊的路线并[自己提供文件ala](http://pythonpaste.org/modules/fileapp.html)

```
class FilesController(BaseController):
    def download(self, path)
        fapp = FileApp( path, headers=self.get_headers(path) )
        return fapp(request.environ, self.start_response) 
```

c）也许有一种方法可以覆盖标题，我只是不知道如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-17T00:26:30.083

在标准 Pylons 设置中，公共文件由 StaticUrlParser 提供。这通常在您的 config/middleware.py:make_app() 函数中设置

您需要像 Antonin ENFRUN 所描述的那样对 StaticUrlParser 进行子类化，尽管称它为 Controller 会令人困惑，因为它的用途不同。在 config/middleware.py 的顶部添加如下内容：

```
from paste.fileapp import FileApp
from paste.urlparser import StaticURLParser

class HeaderUrlParser(StaticURLParser):
    def make_app(self, filename):
        headers = # your headers here
        return FileApp(filename, headers, content_type='application/octetstream') 
```

然后将 config/middleware.py:make_app() 中的 StaticUrlParser 替换为 HeaderUrlParser

```
 static_app = StaticURLParser(config['pylons.paths']['static_files']) 
```

变成

```
 static_app = HeaderURLParser(config['pylons.paths']['static_files']) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-26T21:38:20.310

使用最新版本的路由，您可以使用“ [Magic path_info](http://routes.groovie.org/manual.html#magic-path-info) ”功能，并按照此处的文档编写您的控制器，以便它调用 paste.DirectoryApp。

在我的项目中，我想提供公共目录中的任何文件，包括子目录，并以此作为控制器结束，以便能够覆盖 content_type ：

```
import logging
from paste.fileapp import FileApp

from paste.urlparser import StaticURLParser
from pylons import config
from os.path import basename

class ForceDownloadController(StaticURLParser):

    def __init__(self, directory=None, root_directory=None, cache_max_age=None):
        if not directory:
            directory = config['pylons.paths']['static_files']
        StaticURLParser.__init__(self, directory, root_directory, cache_max_age)

    def make_app(self, filename):
        headers = [('Content-Disposition', 'filename=%s' % (basename(filename)))]
        return FileApp(filename, headers, content_type='application/octetstream') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T17:20:35.237

一种使用 FileApp 进行流式传输的更简单方法，基于 pylons [book](http://pylonsbook.com/en/1.1/the-web-server-gateway-interface-wsgi.html)。下面的代码假定您的路线提供`some_file_identifier`，但其他两个变量是“魔术”（参见代码后的解释）。

```
class MyFileController(BaseController):
  def serve(self, environ, start_response, some_file_identifier):
      path = self._convert_id_to_path(some_file_identifier)
      app = FileApp(path)
      return app(environ, start_response) 
```

如果您的方法签名中有这些名称的变量，Pylons 会自动为您提供 wsgi`environ`和变量。`start_response`否则，您不需要设置或删除标头，但如果您这样做，您可以使用[FileApp 内置的功能](http://pythonpaste.org/modules/fileapp.html)来实现这一点。

# asp.net - ASP.NET - 日历控件 - 使用自定义罢工取消日期

> ID：836194
> 
> 赞同：-1
> 
> 时间：2009-05-07T18:14:06.093
> 
> 标签：asp.net, calendar

我想在 ASP.NET 中用重叠的红色 x 在日历控件中删除今天之前的所有日期。我可以使用 DayRender 事件使用普通字体删除线来删除线。我可以添加一张图片，但它与日期相邻。我希望 x（图像）与日期重叠

这可能吗？如果是这样，请帮助我如何去做。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T18:17:58.800

使用 CSS，

1.  使表格单元格位置相对
2.  使图像位置绝对，顶部和左侧：0

**更新：** 日历控件与所有 ASP.NET 控件一样，输出 HTML。在这种情况下，它将输出一个 HTML 表格，其结构*如下*所示：

```
<table class="calendar_widget">
 <tr>
  <td>01</td>
  <td>02</td>
  <td>03</td>
  <td>04</td>
  <td>05</td>
  <td>06</td>
  <td>07</td>
 </tr>
 ....etc 
```

`<td>`或众所周知的表格单元格将包含您要插入的日期和图像。您可以使用 CSS 将特定样式应用于单元格和图像，以便它们以不同的方式呈现。

我的猜测是您日历的带有图像的 HTML 看起来像这样：

```
<td><img src="x.gif" />01</td> 
```

您可以使用 CSS 样式表来应用以下样式：

```
table.calendar_widget td { 
  position: relative; 
}

table.calendar_widget td img { 
  position: absolute;
  left: 0;
  top: 0;
} 
```

这就是 HTML 的基础知识——如果这没有帮助，我建议跟踪熟悉前端开发的人并获得他们的帮助。

# drupal - Drupal：如何在特定块中显示特定视图

> ID：836195
> 
> 赞同：2
> 
> 时间：2009-05-07T18:14:18.933
> 
> 标签：drupal, drupal-views, drupal-blocks

假设我创建了一个显示某种故事的视图。但我想在左侧栏中显示这个视图——不是指向视图的链接，而是视图本身。

如何将我的新视图与固定的块位置连接起来？我希望能够在页面的不同位置显示真实的视图数据。是否有可能，或者我仅限于中心区域和菜单中的视图链接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T18:50:59.500

使用 Drupal 6.x 的 Views 2.x 从视图创建块很简单。每个视图都有一组“默认”设置和一些显示设置。显示可以是页面、块、提要或创意模块创作的任何其他内容。

要从您的视图中创建一个块，您只需“添加显示”类型为“块”，覆盖您想要在块中更改的任何设置（IE - 显示更少的项目，只是一个节点标题，等等）。然后你就有了一个块，你可以像放置任何其他 Drupal 块一样放置它。

编辑：回答“你能把故事限制在被标记的故事”吗？肯定的事。您只需为分类术语添加过滤器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-28T14:35:38.520

让视图显示在块中很容易。创建视图并将视图分配为块位置后，您只需前往管理员中的块，您就会看到该视图。

只需选择块并保存它。简单的。

如果您的视图未显示，请检查您的过滤器以及视图字段是否正确。通常，如果他们没有显示，那就是简单的选择`content published = yes`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T18:22:52.313

您可以将视图创建为页面或块。由于您没有确切说明您正在使用哪个 Drupal/Views 版本，所以到目前为止我只能说，在您创建视图之后，您可以告诉它显示为块或页面。

然后转到块设置并将其设置为您想要的位置。

# firefox-addon - 是否有专门用于 Firefox 开发的 dojo 或 Jquery？

> ID：836198
> 
> 赞同：3
> 
> 时间：2009-05-07T18:14:44.657
> 
> 标签：firefox-addon, javascript

开始研究 Firefox 附加组件，这是使用 JavaScript 和 XUL 完成的，我发现自己非常想使用 Dojo 或其他类型的 JavaScript 库，但我找不到存在的。所以我正在考虑通过将 Dojo 移植到特定 fork 上的 Firefox 添加来启动一个库。摆脱跨浏览器的东西，使用数组理解和 Firefox 的 JavaScript 引擎中可用的其他好东西。我担心是否有足够的用户群会利用这一点，但更重要的是，我想我想知道是否已经有这样的东西了？谷歌一无所获。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T18:25:09.343

Mozilla 公司为此开发了一个 JavaScript 库：[FUEL](https://developer.mozilla.org/en/FUEL)。

它是由 jQuery 的创建者 John Resig 开发的。

要知道如何在 FF 扩展中使用 jQuery，请查看这个类似的[问题](https://stackoverflow.com/questions/491490/how-to-use-jquery-in-firefox-extension)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T18:19:38.360

至少，jQuery 在嵌入 Firefox 插件时运行良好。我不能引用你的名字，但我听说几个流行的插件已经在使用 jQuery。

这[是一篇](http://digitalmihailo.blogspot.com/2008/05/jquery-and-dynamic-html-in-xul.html)讨论在 XUL 中使用 jQuery 以及您可能需要跳过的一些问题的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T18:21:27.527

将 jQuery 嵌入到 firefox 扩展中是相当普遍的。

# .net - 如何在不耗尽所有系统内存的情况下使 .NET 进程耗尽内存

> ID：836199
> 
> 赞同：6
> 
> 时间：2009-05-07T18:15:06.060
> 
> 标签：.net, unit-testing, nunit, out-of-memory

问题很简单我有一个过程，对一些 xml 文件执行 ETL。我们开始得到非常大的 xml 文件，并且我开始得到 OutOfMemoryExceptions。

修复过程相对简单。但是，我想为我的 NUnit 套件进行单元测试，以确保该过程将继续能够处理非常大的文件。然而，实际上我的开发工作站内存不足会减慢我的机器速度，并且非常耗时。在版本控制中存储一个巨大的测试文件也是一个坏主意。如果我可以人为地将进程、线程或应用程序域限制为仅使用固定数量的 ram，比如说 128 兆，我可以进行更小的单元测试，不会让我的工作站屈服。

有什么建议么？我可以 P/Invoke 他们的一些非托管 API 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T18:41:58.850

您不能使用模拟框架进行内存分配并将其`OutOfMemoryException`作为测试之一抛出吗？

话虽如此，如果您真的内存不足，那么您的应用程序可以安全地做很多事情，但如果您至少可以优雅地失败，您的用户将不胜感激。

**一个例子：** 我在以前的工作中有一个案例，我们实时显示工厂的 3D 模型。模型变得如此之大，以至于当我们尝试加载纹理时，我们会摆脱内存故障。我们设法通过确保代码处理空指针来保持应用程序的活动和渲染，即使其余代码认为那里应该有纹理信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:06:43.703

嘲讽是最好的。实际上提出OOM是定义而不是单元测试。在处理内存时，您正在处理负载测试。如果您阅读了这封电子邮件底部的链接，您会发现真正的 OOM 在最好的情况下很难重现和调试。人为的 OOM 异常并不是异常的真正原因，因此没有比模拟测试更有趣。

坚持使用模拟进行单元测试进行验证。如果您仍然遇到 OOM，请在服务器上投入更多内存并让您的进程更频繁地回收/重新启动。

这是我上次与它们战斗时收集的关于 OutMemoryExceptions 的一些有趣的读物。摘要：当系统无法分配您请求的数量时，就会发生 OOM——这并不意味着您的内存不足。

*   [MSDN ManagedLeaks](http://msdn.microsoft.com/msdnmag/issues/07/01/ManagedLeaks/default.aspx)
*   [CLR 由内而外](http://msdn.microsoft.com/msdnmag/issues/06/11/CLRInsideOut/default.aspx#S6)
*   [MSDN 调试](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)
*   [AD Plus 上的 Bugslayer 专栏](http://msdn.microsoft.com/msdnmag/issues/05/03/Bugslayer)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T23:10:59.673

在进程中很容易导致内存不足异常。

只需创建一个循环，在足够小的块中分配内存，而不是在大对象堆上（但不要太多导致异常），然后您可以尝试打开一个较小的文件，这将导致打开文件无法分配足够的连续内存，并且在不需要大文件的情况下打开文件时会出现 OOM 异常。像这样的东西...

```
List<byte[]> items = new List<byte[]>();
for (int i = 0; i < 10000; i++)
{
     byte[] c = new byte[160000];
     items.Add(c);
}

byte[] next = new byte[1000000000]; 
```

如果你按原样运行上面的代码，你会在最后一行得到一个OOM异常。但是，如果您先注释掉循环，它将执行没有错误。您可能需要稍微调整循环以使其每次打开文件都失败，但您可以做到。只需在调用之前运行循环以在测试中打开文件，您将耗尽大量内存并且您的打开应该失败。

此外，如果您可以选择设置 /3GB 开关，您可能需要考虑它。它并不总是正确的答案，它也有与之相关的缺点，但它会将虚拟内存拆分从 2GB/2GB 更改为 1GB/3GB，从而允许您的进程访问更多虚拟地址空间。这将为您可以打开的文件大小提供更多喘息空间。同样，在将其作为解决方案之前，您应该阅读有关这样做的缺点，并确保如果它有助于您的情况，它是值得的。

[这](http://technet.microsoft.com/en-us/library/bb124810.aspx)是在服务器上启用它的方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T18:30:50.330

我不太明白你在这里的意思。假设您以某种方式创建了一个人为的小型“测试环境”，它无法分配这么大的内存块，因此它在较小的文件上抛出了 OutOfMemoryExceptions。你有什么收获？单元测试应该测试您是否可以在真实系统上处理更大的文件，对吗？

重要的事情大概是您可以在将要运行的任何系统上处理“尽可能大”的文件，并且除了在该系统上尝试该文件之外，没有真正的方法可以对其进行单元测试。

（一个更小、更不重要的事情可能是您是否`OutOfMemoryException`优雅地处理 s，但您实际上不需要用完内存来测试它；只需让您的方法偶尔抛出一个异常并观察它是否正确.)

# c# - ASP.NET 和 Javascript 错误

> ID：836202
> 
> 赞同：1
> 
> 时间：2009-05-07T18:16:08.103
> 
> 标签：c#, asp.net, javascript, html, vb.net

我正在将一个项目从 ASP.NET 1.1 升级到 ASP.NET 2.0。在我的 aspx 页面中，我有一个隐藏字段，如下所示：

```
<input type="hidden" name="__TabControlAction" /> 
```

我有以下javascript函数：

```
function __tabStripPostBack(key) {
var theform;

if (window.navigator.appName.toLowerCase().indexOf("netscape") > -1) {
 theform = document.forms["Form1"];
}
else {
    theform = document.Form1;
}
    theform.__TabControlAction.value='Click';
    theform.__TabControlKey.value=key;
    theform.submit();
} 
```

在 ASP.NET 1.1 中，此代码工作正常。但是，现在我升级到 ASP.NET 2.0，我得到“__TabControlAction 为空或不是对象”错误。无论出于何种原因，javascript似乎都找不到隐藏字段，即使它在那里。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T18:20:34.347

我认为表单的名称应该是“aspnetForm”，而不是“Form1”。您应该能够直接引用它，因为这段 javascript 被注入到带有 runat="server" 标记的每个表单上。

```
<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script> 
```

尝试将您的代码更改为：

```
function __tabStripPostBack(key) {
    theForm.__TabControlAction.value='Click';
    theForm.__TabControlKey.value=key;
    theForm.submit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:19:45.503

`theform`还是定义的？您可能需要在声明时尝试此操作`theform`：

```
 theform = document.forms['aspnetForm']; 
```

换句话说，检查您生成的 HTML 以查看标签的`name`和`id`属性是什么。`<form>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T02:56:27.947

与其通过表单引用它，不如给输入元素一个 id 并使用 document.getElementById('yournewid'); ?

# testing - 在哪里可以找到好的测试用例模板/示例？

> ID：836211
> 
> 赞同：6
> 
> 时间：2009-05-07T18:17:52.513
> 
> 标签：testing, project-management, requirements

我正在尝试建立比现在更正式的要求和测试程序，但是我找不到所涉及文档的任何好的参考示例。

目前，在特性冻结后，测试人员在部署前“点击应用程序”，但是没有正式的规范需要测试什么。

首先，我正在考虑一个文档，它指定需要测试的每个功能，就像这样（编造这个）：

1.  用户登记表
    1.  国家下拉菜单（国家/地区是否正确从服务器获取？）
    2.  密码验证（是否遵守所有密码规则，如果密码太弱，是否会通知用户？）
2.  感谢您的注册

...等等。这也可以作为客户在程序员开始编码之前作为需求的一部分签名的东西。功能列表完成后，我正在考虑将此列表作为电子表格中的第一列，其中还说明了该功能最后一次测试的时间，它是否有效，如果它不起作用，它是如何破坏的。这会给我一个文档测试人员可以在每个测试周期后填写，以便程序员有待办事项列表，其中包含哪些信息不起作用以及它何时中断。

其次，我正在为测试人员考虑测试用例，详细步骤如下：

1.  加载用户注册表。
2.  （功能 1.1）检查国家下拉菜单。
    1.  国家下拉列表中是否填充了国家？
    2.  国家名称是否本地化？
    3.  每种语言的排序顺序是否正确？
3.  （功能 1.2）输入此密码：“a”、“bob”、“password”、“password123”、“password123#”。只应接受最后一个密码。
4.  按“确定”。
5.  （功能 2）检查感谢信。
    1.  文本是否已本地化为每种支持的语言？

这将为测试人员提供具体的案例和清单，并列出需要注意的内容，并指出第一个文档中的功能。这也会给我一些东西来开始自动化测试过程（目前我们除了单元测试之外没有太多的测试自动化）。

我正在寻找一些其他人如何做到这一点的例子，而没有太多的文书工作。通常，测试人员应该能够在一两个小时内完成所有测试。我正在寻找一种简单的方法来让客户同意我们应该为下一个版本实现哪些功能，并让测试人员验证所有新功能都已实现并且所有现有功能都在工作，并将其报告给程序员。

这主要是内部测试材料，应该是几个 Word/Excel 文档。我试图将一个测试/错误修复周期保持在两天以内。我正在以其他方式（JIRA）跟踪编程时间、新功能的实现和客户票，这基本上是测试文档。这是我想到的生命周期：

1.  PM 列出功能。客户签字。（文档 1 已创建。）
2.  创建测试用例。（文件 2。）
3.  程序员实现功能。
4.  测试人员根据测试用例测试功能。（并通过文档 1 报告错误。）
5.  程序员修复错误。
6.  GOTO 4 直到所有错误都被修复。
7.  内部测试结束；产品展示给客户。

有没有人指出可以在哪里找到一些带有测试用例的示例文档？此外，欢迎有关我上面概述的过程的所有提示。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T05:07:08.483

我开发了我使用的两个文档。

一个是为您的更多“标准网站”（例如商业网络存在）：

[http://pm4web.blogspot.com/2008/07/quality-test-plan.html **_** _](http://pm4web.blogspot.com/2008/07/quality-test-plan.html)

我用于基于 Web 的应用程序的另一个：

[http://pm4web.blogspot.com/2008/07/writing-system-test-plan.html **_** _](http://pm4web.blogspot.com/2008/07/writing-system-test-plan.html)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T02:33:44.350

首先，我认为将需求文档与测试用例文档结合起来最有意义，因为两者的大部分信息都是相同的，并且在测试人员面前有需求，在用户和开发人员面前有测试用例强化了需求并提供他们不同的观点。这是文档布局的一个很好的起点：[http](http://www.volere.co.uk/template.htm#anchor326763) ://www.volere.co.uk/template.htm#anchor326763 - 如果添加：测试步骤、测试结果预期、边缘/绑定案例 - 你应该有一个非常可靠的需求规范和测试规范合二为一。

对于这些步骤，不要忘记包含一个评估步骤，您、测试人员、开发人员等在其中评估测试结果并更新下一轮的需求/测试文档（您经常会遇到无法解决的问题）已经考虑并应该从需求角度和测试角度添加到规范中）。

我还强烈建议您使用思维导图/工作分解结构来确保正确捕获所有需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T00:01:04.440

David Peterson 的[Concordion 网站](http://www.concordion.org/Technique.html)有一个非常好的页面，介绍了编写良好规范的技术（以及执行所述规范的框架）。他的建议简单明了。

您可能还想查看 Dan North关于行为驱动开发 (BDD)的[经典博客文章。](http://dannorth.net/introducing-bdd)很有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T17:25:43.713

在开始工作之前，您绝对需要一份详细的规范；否则您的开发人员不知道要写什么或何时完成。Joel Spolsky 写[了一篇](http://www.joelonsoftware.com/articles/fog0000000036.html)关于这个主题的好文章，并附有示例。不要指望规范在开发过程中保持不变：在计划中进行修订。

上面的米德建议将规范与测试结合起来。这被称为[测试驱动开发](http://en.wikipedia.org/wiki/Test-driven_development)，是一个非常好的主意。它以一种自然语言通常不会的方式将事情固定下来，并减少了工作量。

您还需要考虑单元测试和自动化。这是一个很大的节省时间和质量助推器。GUI 级别的测试可能难以自动化，但您应该使 GUI 层尽可能薄，并对下面的功能进行自动化测试。这可以在以后的开发中节省大量时间，因为您可以根据需要对整个应用程序进行彻底的测试。手动测试既昂贵又缓慢，因此有一种偷工减料的强烈诱惑：“我们只更改了 Foo 模块，因此我们只需要重复测试 7、8 和 9”。然后客户打电话抱怨 Bar 模块中的某些东西坏了，结果发现 Foo 对 Bar 有一个开发人员忽略的模糊的副作用。自动化测试会捕捉到这一点，因为自动化测试运行起来很便宜。看[这里](http://www.secondlifeinsider.com/2007/10/23/side-effects-anatomy-of-a-second-life-bug/)有关此类错误的真实故事。

如果您的应用程序大到需要它，则使用 TDD 指定模块，并将这些模块测试转换为自动化测试。

一个小时完成所有手动测试听起来有点乐观，除非它是一个非常简单的应用程序。不要忘记您必须测试所有错误案例以及主要路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T05:23:26.090

浏览旧的错误报告并从中构建您的测试用例。您可以测试特定的旧错误并进行更多概括。由于相同类型的错误往往会一次又一次地出现，这将为您提供一个测试套件，它更多地是关于捕捉真正的错误，而不是关于不可能（或非常昂贵）的全面覆盖任务。

利用 GUI 和 Web 自动化。 例如，[硒。](http://seleniumhq.org/)很多东西可以自动化，比你想象的要多得多。例如，您的用户注册场景很容易实现自动化。即使它们必须由人工检查，例如跨浏览器测试以确保事情看起来正确，也可以在 QA 工程师观看时记录和回放测试。开发人员甚至可以记录重现难以自动化的错误并将其传递给 QA 的步骤，而不是花费时间且经常有缺陷的任务来写下指令。将它们保存为项目的一部分。给他们关于测试意图的良好描述。将它们链接到一张票。如果 GUI 发生变化，导致测试不再工作，并且会发生这种情况，您可以重写测试以涵盖其意图。

我将放大 Paul Johnson 所说的关于使 GUI 层尽可能薄的内容。将表单（GUI 或 HTML 或格式）与功能（它的作用）分开并自动测试功能。具有生成国家列表的功能，彻底测试。然后是一个函数，它使用它来生成 HTML 或 AJAX 或其他什么，你只需要测试它看起来是否正确，因为执行实际工作的函数经过了很好的测试。用户登录。密码检查。电子邮件。这些都可以在没有 GUI 的情况下编写工作。这将大大减少必须完成的缓慢、昂贵、有缺陷的手动测试的数量。

# java - Java，二叉树删除方法

> ID：836212
> 
> 赞同：2
> 
> 时间：2009-05-07T18:17:54.197
> 
> 标签：java, tree, binary-tree

我正在尝试`remove(node cRoot, Object o)`为排序的二叉树编写一个函数。

这是我到目前为止所拥有的：

```
private boolean remove(Node cRoot, Object o) {
  if (cRoot == null) {
    return false;
  }
  else if (cRoot.item.equals(o)) { 
    //erase node fix tree
    return true;
  }
  else if (((Comparable)item).compareTo(cRoot.item)<=0){
    return remove(cRoot.lChild, o);
  }
  else { 
     return remove(cRoot.rChild,o);
  }
} 
```

它不能正常工作。要删除节点，您必须修复树以修复孔。这应该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T18:29:16.853

通常有两种方法可以在树上执行删除：

第一种方法：

删除节点，然后将其替换为任一子节点。然后，通过进行父子交换来重新排序树，直到树再次排序。

第二种方法：

遍历树以找到属于根*的下一个（最高或最低）值，如果它是叶节点，则将其与根交换，然后修剪掉要删除的值。如果它是内部节点，则必须在该节点上递归调用 remove。重复，直到叶节点被删除。

*我的意思是，如果您将 BST 转换为排序列表，那么您将需要选择根左侧或右侧的值作为新根。即右子树的最左边的孩子，或左子树的最右边的孩子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T18:28:43.237

从排序树中擦除节点的基本伪代码非常简单：

1.  擦除节点值
2.  找到最大值的子节点
3.  使其成为根节点
4.  如果它有孩子 - 递归转到 2

基本上你正在做的是在树上冒泡节点，每次每个节点中的最大子节点，所以最后你会留在一个排序的树上，并且在你去的完整路径的末尾只有一个节点丢失.

另请参阅[有关该主题的维基百科](http://en.wikipedia.org/wiki/Binary_search_tree#Deletion)，他们也有一些 C 示例代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T18:38:30.623

在简单的 case3 中，您可以使用下一个算法：

```
if(removed node had left child)
{
   place left child instead of removed node;
   most_right = most right leaf in the left subtree;
   move right child of removed node as right child of most_right;
}
else
{
   place right child instead of removed node
} 
```

在更复杂的情况下，您可能需要重新平衡您的树（参见 AVL 树，[http:](http://www.cmcrossroads.com/bradapp/ftp/src/libs/C++/AvlTrees.html) //www.cmcrossroads.com/bradapp/ftp/src/libs/C++/AvlTrees.html以获取 C++ 示例）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T18:06:47.127

1.  叶删除节点
2.  1-child 提升子树
3.  2-child case 将节点替换为
4.  按顺序继任者或前任者
5.  左大部分右子树或
6.  左子树的最右边

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-29T17:24:40.730

我在[Habrahabr](https://habrahabr.ru/post/65617/)上找到了这段代码。我刚刚添加了评论。

```
public void remove (T1 k){
    Node<T1,T2> x = root, y = null;
    // from while to if(x == null) - searching for key
    while(x != null){
        int cmp = k.compareTo(x.key);
        if(cmp == 0){
            break;  // quit cycle if key element is found
        } else {
            y = x;
            if(cmp < 0){
                x = x.left;
            } else {
                x = x.right;
            }
        }
    }
    if(x == null) return;   // if key is not found or tree is empty
    if(x.right == null){    // if element found has not right child
        if(y == null){      // if element found is root & has not right child
            root = x.left; 
        } else {            // if element found is not root & has not right child           
            if(x == y.left) y.left = x.left;    
            else y.right = x.left;              
        }
    } else {            // element found has right child, so search for most left of rights
        Node<T1,T2> mostLeft = x.right;
        y = null;
        while(mostLeft.left != null) {
            y = mostLeft;
            mostLeft = mostLeft.left;
        }
        if(y == null){  // if right child of element found has not left child
            x.right = mostLeft.right;
        } else {        // if right child of element found has left child
            y.left = mostLeft.right;
        }
        x.key = mostLeft.key;       
        x.value = mostLeft.value;   
    }
} 
```

# user-interface - 组织 GUI 代码

> ID：836218
> 
> 赞同：11
> 
> 时间：2009-05-07T18:18:32.620
> 
> 标签：user-interface, code-organization

我的问题有两个部分：

*   关于如何编写易于阅读、编写和维护的 GUI 代码，是否有人对网络上的某些文档有任何提示或参考？

    **例子。**

    我发现我的 GUI 表单变得越广泛，我最终会得到一长串相当短的事件处理程序方法。如果我尝试添加任何私有帮助方法，它们只会在洗牌中迷失，我必须不断地滚动页面以遵循单一的思路。

* * *

*   如何轻松管理整个应用程序的设置？

    **例子。**

    如果用户在下拉列表中选择了一个新项目，我可能需要在 GUI 上启用一些组件，更新应用程序配置文件，并将新值存储在本地变量中以备后用。我通常选择不为所有设置创建事件处理程序（见上文），并最终使用诸如“LoadGUISettings”和“SaveGUISettings”之类的方法，但是我最终在我的代码中调用了这些方法，并且它运行了很多代码只是为了更新很少（如果有的话）实际更改。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T18:37:46.927

从面向对象的角度来看，第一个问题的一些指导方针：

*   **把大班分成小班。** 该面板是否有一堆相当模块化的子面板？为每个子面板创建一个较小的类，然后让另一个更高级别的类将它们放在一起。
*   **减少重复。** 您是否有两棵共享功能的树？打造超一流！您所有的事件处理程序都在做类似的事情吗？创建一个他们都调用的方法！

* * *

第二个问题。我看到了两种方法：

*   **听众。** 如果许多组件应该响应一个组件中发生的更改，请让该组件触发一个事件。
*   **全局变量。**如果许多组件正在读取和写入相同的数据，请将其设为全局（但是您可以使用您选择的语言来执行此操作）。为了更有用，将这两种方法结合起来，让组件监听全局数据对象的变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T18:23:39.770

如果您使用的是 WPF，您可能需要阅读[WPF 的复合应用程序指南](http://msdn.microsoft.com/en-us/library/dd458807.aspx)。

它讨论了许多这些主题（以及许多其他主题）。该指南的主要目标是以灵活、可维护的方式制作大规模应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T18:37:02.077

你绝对应该看看[Jeremy Miller 的](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx)富客户端设计指南。它不完整，但我相信他正在写一本关于这个主题的书。

您应该查看的另一个博客是[Rich Newman 的](http://richnewman.wordpress.com/intro-to-cab-toc/). 他正在撰写有关如何构建富客户端的 MS 最佳实践指南 Composite Application Block。

你也可以阅读[这本书](http://www.amazon.co.uk/Programming-Microsoft-Composite-Application-Practices/dp/0735624143/ref=sr_1_1?ie=UTF8&s=books&qid=1241721386&sr=8-1)，它只是一本非常轻松的书，但会给你一些好主意。

# jquery - ASP.NET MVC 和 AjaxFileUpload

> ID：836224
> 
> 赞同：1
> 
> 时间：2009-05-07T18:19:59.123
> 
> 标签：jquery, asp.net-mvc, file-upload

好吧，这让我发疯了。我一直在尝试永远解决这个问题。我想使用[ajaxFileUpload](http://www.phpletter.com/Our-Projects/AjaxFileUpload/)执行异步上传。我让它将文件发布到我的控制器就好了，但是，当我尝试从中返回 JsonResult 时，我得到一个“将文件另存为”对话框。我已经尝试了一切来解决这个问题，我得到一个错误或“另存为”对话框。我假设它与发布文件时传入的内容类型有关。如果有人能提供帮助，我将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-05-03T14:04:21.053

我有同样的问题，我解决了

```
 public ContentResult UploadFile(FormCollection form, ...

  return Content("{success: false, ErrorMsg: 'someerror'}"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T20:33:48.710

如果您查看那里的代码，它实际上是创建一个新表单和 iframe，然后将表单发布到 iframe。响应被写回 iframe，然后代码将其拾取并返回。我假设如果您直接在浏览器中加载 JsonResult，它也会导致弹出相同的下载框。检查与 JsonResult 一起返回的标头，以了解为什么在作为页面加载时它认为是下载。也许您需要将 Content-Type 设置为 text/plain 或删除 Content-Disposition 标头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-08T19:23:15.757

在你的控制器中只包括这样的“text/x-json”：

```
 public JsonResult UploadFile(FormCollection form, ...

  return Json("{id: xxxx, text: 'bla bla bla'}", "text/x-json"); 
```

# ruby-on-rails - rails activeresource 消息

> ID：836228
> 
> 赞同：0
> 
> 时间：2009-05-07T18:20:55.283
> 
> 标签：ruby-on-rails, activeresource

我有一个关于活动资源的快速问题。如果我有一个用户资源，当我打电话时

```
User.find(1).put(:promote, :position => 'manager') 
```

根据 api 它转换为这个调用 /users/1/promote.xml?position=manager

我的问题是这个。activeresource 实际上在这里打了两个电话吗？find 执行 get，然后放置该对象，或者将 .put 附加到 .find 是否意味着它只进行一次调用。如果是这样，那么 .find 的唯一原因是提供 /users/:id/promote 的正确 url 格式？

我在文档中找不到可能指定它的地方，但正是 .find 让我觉得可能发生了两个服务调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T18:40:49.230

如果 ActiveResource 像 ActiveRecord 一样工作，我会说“是”。如果你做类似的事情

```
Foo.find(1).update_attributes(:name=>"Bar") 
```

ActiveRecord 首先进行选择以获取对象，然后向数据库发出更新调用以更改记录。我假设 ActiveResources 以类似的方式运行，它发出两个 Web 服务调用以获取对象，然后更新对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-01T06:09:19.540

将以下内容放入您的初始化程序中：

```
class ActiveResource::Connection
  #   Creates new Net::HTTP instance for communication with
  #   remote service and resources.
  def http
    http = Net::HTTP.new(@site.host, @site.port)
    http.use_ssl = @site.is_a?(URI::HTTPS)
    http.verify_mode = OpenSSL::SSL::VERIFY_NONE if http.use_ssl
    http.read_timeout = @timeout if @timeout
    #Here's the addition that allows you to see the output
    http.set_debug_output $stderr
    return http
  end
end 
```

搜索 '"http.set_debug_output $stderr" "ActiveResource"' 以找到此有用提示的原作者。

# java - 蚂蚁中的正确组合是什么？

> ID：836234
> 
> 赞同：0
> 
> 时间：2009-05-07T18:22:05.250
> 
> 标签：java, eclipse, ant, junit, build.xml

似乎当您组合这些 Fileset 属性时，如下所示：例如：

```
<fileset dir="src">
    <include name="gov/nasa/arc/mas/selenium/tests/*.java" />
    <excludesfile name="${test.suite}.exclude" />
</fileset> 
```

它具有预期的行为，即在 src 下包含所有 *.java 但排除在 excludefile 中指定的所有文件。

是否可以结合 include 和 excludesfile 或者您是否需要使用相应的包含文件？

遗憾的是这些事情没有记录在案，而且很难在谷歌上找到解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T18:28:53.330

实际上，我认为[Ant Manual对](http://ant.apache.org/manual/index.html)[这些类型的事情](http://ant.apache.org/manual/Types/fileset.html)非常清楚。

我不清楚的是你想要做什么。您想对“包含”和“排除”都使用外部文件吗？或者您是否希望其中一个覆盖另一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:29:24.700

它*已*记录在案并且应该可以工作：[http ://ant.apache.org/manual/Types/fileset.html](http://ant.apache.org/manual/Types/fileset.html)

请注意，在 excludes 文件中，“该文件的每一行都被视为一个排除模式。” 您的排除文件是什么样的？

# jquery - 简单的 JQuery 问题 - 如何为 title 属性添加值？

> ID：836242
> 
> 赞同：0
> 
> 时间：2009-05-07T18:23:56.023
> 
> 标签：jquery, attributes

愚蠢的提问时间 - 你如何更新控件的标题属性？显然这不起作用：

```
$("#valPageIndex").attr('title') = pageIndex; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T18:25:27.830

```
$("#valPageIndex").attr('title', pageIndex); 
```

基本上，`$("#valPageIndex").attr('title')`只是为了获取它的值，而`$("#valPageIndex").attr('title', value)`为了设置它。

这是官方文档：[http](http://docs.jquery.com/Attributes/attr) ://docs.jquery.com/Attributes/attr 。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T18:25:20.047

```
$("#valPageIndex").attr({'title': pageIndex}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T18:26:34.253

```
$("#valPageIndex").attr('title', pageIndex); 
```

[http://docs.jquery.com/Attributes/attr#keyvalue](http://docs.jquery.com/Attributes/attr#keyvalue)

一个常见的 jQuery 约定是拥有`.foo()`或`.foo('selector')`充当 getter`.foo(value)`或`.foo('selector', value)`充当 setter。

# c# - Silverlight 异步调用和匿名方法

> ID：836252
> 
> 赞同：0
> 
> 时间：2009-05-07T18:27:14.143
> 
> 标签：c#, silverlight, asynchronous, delegates

我知道关于这种事情有几个争论。无论如何，我有几种情况需要根据从 WCF 服务返回的枚举来填充 ComboBox 项。

为了保持代码干净，我开始使用这种方法。在对其进行了更多研究之后，我认为最初认为它的效果并不好......

我把它扔掉是为了获得有关您将如何执行此操作或您当前如何执行此操作的建议/建议/代码片段。

我可能被迫有一个单独的、非匿名的方法、过程。我讨厌这样做，但目前，不要看到它以另一种方式工作......

```
EventHandler<GetEnumerationsForTypeCompletedEventArgs> ev = delegate(object eventSender, GetEnumerationsForTypeCompletedEventArgs eventArgs)
{
    if (eventArgs.Error == null)
    {
        //comboBox.ItemsSource = eventArgs.Result;
        //populate combox for display purposes (for now)
        foreach (Enumeration e in eventArgs.Result)
        {
            ComboBoxItem cbi = new ComboBoxItem();
            cbi.Content = e.EnumerationValueDisplayed;
            comboBox.Items.Add(cbi);
        }
        // remove event so we don't keep adding new events each time we need an enumeration
        proxy.GetEnumerationsForTypeCompleted -= ev;
    }
};
proxy.GetEnumerationsForTypeCompleted += ev;
proxy.GetEnumerationsForTypeAsync(sEnumerationType); 
```

基本上在这个例子中，我们使用 ev 来保存匿名方法，这样我们就可以在方法中使用 ev 将它从调用的事件中删除。这可以防止此方法被多次调用。

我怀疑在此调用之前但在同一方法中声明的 ComboBox 本地 var 并不总是最初打算使用的 ComboBox，但还不能真正验证这一点。我可能会向它添加一个标签以进行一些测试并填充以进行验证。

对不起，如果这不清楚。如果需要，我可以详细说明。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-19T07:51:56.027

我这样做的方式是这样的：

```
var query = from t in GetFreshContext().Employee select t;
var dsQuery = (DataServiceQuery<Employee>)query;
dsQuery.BeginExecute(result =>
{
    ComboEmployees.ItemsSource = dsQuery.EndExecute(result).ToArray();
}, null);
ComboEmployees.DisplayMemberPath = "FullName"; 
```

我写了[一篇关于其他一些问题的博客文章和这个](http://blog.andrei.rinea.ro/post/2009/08/19/Using-ADONET-Data-Servics-in-Silverlight-3-and-eager-loading-parent-entities.aspx)。

# vba - 让 Outlook 2007 运行 VBA 脚本时出现问题

> ID：836254
> 
> 赞同：1
> 
> 时间：2009-05-07T18:27:48.027
> 
> 标签：vba, outlook, outlook-2007

我正在尝试让 Outlook 将每日电子邮件中的附件保存到一个文件夹中，在该文件夹中我可以让文件系统观察程序准备好解析和分析附件（它是数据完整性检查器的报告）。我已经设置了一个应该运行 VBA 脚本的规则，但据我所知它并没有运行。我已经在 VB6 中验证了代码实际上会将一些文本保存到文件中，因此如果 Outlook 实际运行 VBA 脚本，它应该能够执行相同的操作。但事实并非如此！谁能看到我做错了什么？

```
Dim WithEvents objInbox As Outlook.Items

Private Sub Application_Startup()
   Set objInbox = Session.GetDefaultFolder(olFolderInbox).Items
End Sub

Sub SnagAttachment(theItem As MailItem)
    On Error Resume Next
    Dim fnum As Integer
    fnum = FreeFile()
    Open "c:\temp\success.txt" For Output As #fnum
    Print #fnum, "Ran SnagAttachment Successfully"
    Close #fnum
End Sub 
```

请注意，当我使用规则向导并选择“运行脚本”时，Sub SagAttachment 被列为可以选择的脚本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-11-21T18:14:29.883

`On Error Resume Next`当你把它放在程序的顶部时，你怎么知道它是否有效？你永远不会发现。

以下是创建应作为规则一部分运行的脚本的规则：

[如何在 Outlook 中为规则向导创建脚本](http://support.microsoft.com/kb/306108)

另请注意[如何处理 Microsoft Outlook 中的传入消息中](http://www.outlookcode.com/article.aspx?id=62)的警告：

> “运行脚本”规则对于流量大的应用程序来说不是一个好的选择，因为如果有太多符合规则条件的项目到达，Outlook 可能会跳过应用该规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-28T17:56:58.407

为了使脚本正常工作，您需要更改 Outlook 中的安全设置。转到工具 > 宏 > 安全并将其更改为“所有宏的警告”。然后重新启动 Outlook。

希望这可以帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-20T21:52:54.757

尝试找出确切的问题：

1.  检查宏安全设置。最多，它必须设置为不高于“所有宏的警告”。
2.  尝试使用单个测试子创建一个新模块：

    ```
    子测试（项目为 Outlook.MailItem）
    MsgBox "测试"
    结束子

    ```

    然后设置一个新规则来处理运行此子的_所有_传入消息作为唯一操作，并暂时禁用所有其他规则。然后给自己发信息。如果结果没有弹出框，这可能表明 Outlook 安装错误。尝试重新安装它，或直接致电 MS 寻求支持。
3.  如果之前的测试成功，请尝试使用 `Scripting.FileSystemObject` 对象而不是 `Freefile()` 来创建和填充文件。这只是为了测试您是否在这里遇到了一些奇怪的错误。值得一试，对吧？
4.  确保您的规则条件设置正确。在某些情况下可能存在故障或拼写错误，只会丢弃您希望此脚本运行的所有消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-12T17:30:28.077

我遇到了同样的问题，在我看来，如果您的代码中有错误，脚本甚至都不会启动。这与标准 VBA 不同，其中调试器会弹出运行时错误。例如，我的函数末尾有一个标签，它后面缺少冒号。这导致脚本根本不运行（而不是运行到这一行然后失败）。我建议注释掉你所有的代码，并从一个 msgbox “hello world”开始。当您调试它以知道代码正在运行时，我会将其留在您的代码中，但您可能必须多次关闭消息框。反复添加代码行，直到您发现问题所在。

# iphone - 将对象添加到 NSMutableArray，从 XML 文件解析时顺序似乎很奇怪

> ID：836258
> 
> 赞同：0
> 
> 时间：2009-05-07T18:28:13.097
> 
> 标签：iphone, xml, nsmutablearray

我正在为两个元素解析 XML 文件：“title”和“noType”。解析完这些后，我将它们添加到一个名为 aMaster 的对象中，这是我自己的包含 NSString 变量的 Master 类的一个实例。

然后，我将这些实例添加到单例的 NSMutableArray 中，以便在程序的其他地方调用它们。问题是当我打电话给他们时，他们似乎不在同一个 NSMutableArray 索引上......每个索引都包含标题或 noType 元素，当它应该是两者时......谁能看到我可能是什么做错了吗？下面是解析器的代码。非常感谢！！

```
#import "XMLParser.h"
#import "Values.h"
#import "Listing.h"
#import "Master.h"

@implementation XMLParser

@synthesize sharedSingleton, aMaster;

- (XMLParser *) initXMLParser {

    [super init];
    sharedSingleton = [Values sharedValues];
    aMaster = [[Master init] alloc];
    return self;
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName 
  namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName 
    attributes:(NSDictionary *)attributeDict {

    aMaster = [[Master alloc] init];

        //Extract the attribute here.

    if ([elementName isEqualToString:@"intro"]) {
        aMaster.intro = [attributeDict objectForKey:@"enabled"];
    } else if ([elementName isEqualToString:@"item"]) {
        aMaster.item_type = [attributeDict objectForKey:@"type"];
        //NSLog(@"Did find item with type %@", [attributeDict objectForKey:@"type"]);

        //NSLog(@"Reading id value :%@", aMaster.item_type);
    } else {
        //NSLog(@"No known elements");
    }

    //NSLog(@"Processing Element: %@", elementName);    //HERE
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string { 

    if(!currentElementValue) 
        currentElementValue = [[NSMutableString alloc] initWithString:string];
    else {
        [currentElementValue appendString:string];//[tempString stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]]];
        CFStringTrimWhitespace((CFMutableStringRef)currentElementValue);
    }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName 
  namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {

    if ([elementName isEqualToString:@"item"]) {
        [sharedSingleton.master addObject:aMaster];
        NSLog(@"Added %@ and %@ to the shared singleton", aMaster.title, aMaster.noType);  //Only having one at a time added... don't know why
        [aMaster release];

        aMaster = nil;

    } else if ([elementName isEqualToString:@"title"]) {
        [aMaster setValue:currentElementValue forKey:@"title"];
    } else if ([elementName isEqualToString:@"noType"]) {
        [aMaster setValue:currentElementValue forKey:@"noType"]; 
        //NSLog(@"%@ should load into the singleton", aMaster.noType);
    }
    NSLog(@"delimiter");
    NSLog(@"%@ should load into the singleton", aMaster.title);
    NSLog(@"%@ should load into the singleton", aMaster.noType);

    [currentElementValue release];
    currentElementValue = nil;

}

- (void) dealloc {
    [aMaster release];
    [currentElementValue release];
    [super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T18:36:11.017

每次`didStartElement`调用时，您都将设置`aMaster`为`Master`该类的新实例。基于 的实现`didEndElement`，看起来你应该只在`item`找到新标签时创建一个新实例。这可能是数组中的每个条目都有一个值或另一个值的原因，因为为每个值创建了一个新实例。

# logging - 是否有适用于网络共享的尾巴？

> ID：836262
> 
> 赞同：5
> 
> 时间：2009-05-07T18:29:02.580
> 
> 标签：logging, utilities

我需要一个可以在 Windows 下工作并可以监视网络共享上的文件的 tail 实用程序。我尝试过的那些在本地运行良好，但在 SMB 上运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:14:00.180

[Win32 的 GNU 实用程序](http://unxutils.sourceforge.net/)有一个本机 tail.exe，我刚刚使用 SMB 路径进行了测试：

```
tail -f \\server\path\to\file 
```

它似乎工作正常。我`file`使用记事本更新，并在我的 cmd 窗口中报告了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:21:22.533

如果你想走那条路，Powershell 中的 Get-Content 也可以做同样的事情。

```
 Get-Content \\networkpc\SharedFolder\file.txt -Wait 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T09:55:18.763

这是我为此编写的一个实用程序：

它使用 FileSystemWatcher 在本地文件夹或网络共享中查找日志文件的更改（不必安装，只需提供 UNC 路径）并将新内容附加到控制台。

在github上：[https ://github.com/danbyrne84/multitail](https://github.com/danbyrne84/multitail)

[http://www.danielbyrne.net/projects/multitail](http://www.danielbyrne.net/projects/multitail)

希望这可以帮助

# stored-procedures - 从数据集到存储过程和现代 ORM

> ID：836274
> 
> 赞同：0
> 
> 时间：2009-05-07T18:32:10.497
> 
> 标签：stored-procedures, orm, strongly-typed-dataset

将现有的大型代码库从强类型数据集驱动的数据访问层迁移到由存储过程和/或更现代的 ORM 包驱动的 DAL 需要多少努力？是否有任何闪亮的工具可以自动化这个过程的一部分？

当前的代码库有超过 100 多个镜像 sql 数据库的数据集（但并不总是 100% 与数据库结构的变化保持同步）。目前的立场是，现在改变的时间/精力太多，但我质疑这会让我们每周偿还多少技术债务。更不用说数据集的 SQL 与优化的存储过程的后端性能。

那么，这样做合理吗？这样的事情会不会太像怪物，无法在合理的时间内解决并获得有价值的回报？我知道我可以将他们使用的类似 DAO 的类更改为接口（应该已经）并在一边开发它，同时仍然在生产中使用数据集，直到可以对整体的一小部分进行某种可行性测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T18:55:56.260

我会说，与存储的过程驱动的 DAL 层相比，转向像 LINQ to SQL 这样的 ORM 将花费更少的精力。我想到的几件事：

*   情况 1 - 如果您在 DAL 之外 [in UI, BLL] 使用您的类型化数据集，那么肯定会付出很大的努力，因为您需要对更改进行广泛的影响分析，并在几乎所有您拥有的地方进行更改使用您的类型化数据集。

*   情况 2 - 如果您仅在 DAL 和 UI 中使用类型化数据集，BLL 不关心 DAL 的内部实现并且忘记了类型化数据集，那么它的工作量将大大减少。您只需要在 DAL 层内进行更改。

*   如果您处于情况 2，那么我认为从类型化数据集转移到 ORM 映射器肯定是值得的。

*   如果您打算为 DAL 采用存储过程方法，那么您可以查看 www.mygenerationsoftware.com 来自动生成您的过程以减少一些工作量，但是与 ORM 映射器相比，工作量仍然会更高，另一个缺点可能是您最终会在数据库中获得无数简单的插入/更新过程。我们通常将 procs 主要用于级联 UPSERTS（更新+插入）或仅复杂的计算，并使用 LINQ to SQL 进行基本的插入、更新、删除。

希望这会有所帮助！

# c# - 并非所有代码路径都返回，但编译器将其视为所有路径都返回

> ID：836276
> 
> 赞同：4
> 
> 时间：2009-05-07T18:32:32.760
> 
> 标签：c#, compilation

**我想不出一个好的标题，但我的问题并不像看起来那么幼稚。**

考虑一下：

```
public static void ExitApp(string message)
{
    // Do stuff
    throw new Exception(...);
} 
```

或者

```
public static void ExitApp(string message)
{
    // Do stuff
    System.Environment.Exit(-1);
} 
```

这些方法都不会返回。但是当您在其他地方调用这些方法时：

```
public int DoStuff()
{
    // Do stuff
    if (foo == 0)
    {
        throw new Exception(...);
    }
    else if (foo == 1)
    {
        // Do other stuff
        return ...;
    }
    else
    {
        ExitApp("Something borked");
    }
} 
```

尝试编译它，您将在 DoStuff 中获得“并非所有代码路径都返回值”。**即使我知道**这很好，但为了满足编译器的要求，用 Exception 跟踪 ExitApp 的调用似乎很愚蠢。ExitApp() 中似乎没有任何事情可以表明它永远不会返回。

**如何向编译器表明 ExitApp 永远不会返回，因此 DoStuff 的 else 块也永远不会返回？** 这似乎是一个相当简单的错误，它的路径检查无法解决。

即使我只使用第一个 ExitApp（抛出异常）并且该方法返回一个 int 路径检查器也足够聪明，可以意识到它永远不会返回，因此它不会抱怨 int 类型。这编译文件：

```
public static int ExitApp(string message)
{
    // Do stuff
    throw new Exception(...);
} 
```

但是，鉴于它知道这个 ExitApp 永远不会返回一个 int 它不会将它外推到 DoStuff() 所以我倾向于相信我的问题没有解决方案。我唯一的选择是在调用 ExitApp 后抛出异常。

```
public int DoStuff()
{
    ...
    else
    {
        ExitApp("Something borked");
        throw new NotImplementedException("Should not reach this");
    }
} 
```

**编译器有这种行为的原因吗？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-07T18:35:41.317

我为此目的定义了一个异常：UnreachableException。这似乎是多余的，但它是一种简单的方式，可以说“嘿，读这个的人，这行永远不应该被执行！”。我通常将它用于某些 switch 语句的默认情况，但它也适用于这里。

只需在 ExitApp 行之后扔一个。

```
public void int DoStuff()
{
    // Do stuff
    if (foo == 0)
    {
        throw new Exception(...);
    }
    else if (foo == 1)
    {
        // Do other stuff
        return ...;
    }
    else
    {
        ExitApp("Something borked");
        throw new UnreachableException();
    }
} 
```

该语言不支持声明总是抛出的方法的实际原因只是：**不值得**。语言开发人员没有无限的时间来应用我们能想到的每一个特性。他们必须优先考虑。

我打赌这是你第一次遇到这种情况，看看：显式抛出异常可以解决这个问题。他们为什么要费心处理这样一个罕见的、容易绕过的案例？他们可能会花时间实现可选参数、动态参数或一堆其他更有用和更频繁使用的东西，而不是能够说函数总是抛出异常。

这并不是说它永远不会实施。这种类型的方法信息正是合约擅长指定的事物类型。所以也许它会包含在代码合同中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T18:34:45.157

C# 编译器不支持异常报告，就像 Java 编译器一样。因此，编译器不知道（在方法本身的上下文之外）该方法保证在每次调用时都会引发异常。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-07T19:09:21.157

我不打算重复之前已经说过的内容，但是如果您正在寻找一种编译器不会因此错误而打扰您的方法，您可以执行以下操作：

```
public int DoStuff()
{
    var result = 0; //put default result here
    // Do stuff
    if (foo == 0)
    {
        throw new Exception(...);
    }
    else if (foo == 1)
    {
        // Do other stuff
        result = ...;
    }
    else
    {
        ExitApp("Something borked");
    }
    return result;
} 
```

事实是编译器不够聪明，无法在您的情况下理解所有路径都返回值，因此最好在条件结构之外返回值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T18:36:29.987

对于第二种情况，System.Environment.Exit 是框架的一部分，而不是 C# 语言。C# 编译器不“知道”它是一个非返回函数。

这是不幸的。Visual C++ 支持 __declspec(noreturn)，但我不知道任何类似 C# 的构造。在这些情况下，我通常会添加一条评论说“无法访问的代码”和一个断言，然后将其返回或抛出以使编译器满意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T18:37:07.770

是的，一个很好的理由。

这意味着您可以对 ExitApp 的实现进行更改，而不会突然在您的应用程序中出现编译器错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T18:43:42.763

编译器没有一致的方法来推断您的 ExitApp() 方法将做什么。尽管它可以分析源代码并“猜测”它永远不会返回那里，但很容易出现源不可用且它不知道的情况。唯一合理且一致的方法是它不分析您的代码。

因此，您必须添加异常或虚拟返回值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T18:37:45.600

C# 选择不实现检查异常，因此尽管编译器可以选择进行静态分析并找出 ExitApp 或 MethodThrows 永远不会返回，但团队将精力花在了其他地方。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T18:39:16.377

编译器无法知道 的行为`System.Environment.Exit()`导致它不返回。

它在抱怨，因为它假设函数将返回并且执行将继续。

只需在调用后添加一个简单的`return -1;`语句。`Exit()`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-07T18:40:00.697

简单的答案是：编译器没那么聪明。它做出了基本假设，即某个方法中的任何方法调用（`DoStuff`在您的情况下）最终将*在一般情况下*完成（尽管有时可能会抛出一个假设） - 一般而言，这是一个非常公平的假设，尽管显然不是您指出的*所有*情况出去。话虽如此，但我不认为您必须在调用`ExitApp`. 以下任何一项都可以很好地完成工作，并且永远不*应该*被调用：

```
return 0;

// More than necessary, but potentially useful for spotting an undersirable case when your called method *does* return (undesirably in this situation).
throw new Exception("This should never happen because the previous call should never return"); 
```

# django - django-cms, django flatpages, tiny mce 不显示

> ID：836277
> 
> 赞同：1
> 
> 时间：2009-05-07T18:32:49.013
> 
> 标签：django, tinymce, django-flatpages

我已经实现了 django-cms 和 flatpages，但都无法在其中显示 tiny_mce。

网址.py

```
(r'^tinymce/', include('tinymce.urls')),

from django.conf import settings
if settings.DEBUG:
    urlpatterns += patterns('',
        (r'^site_media/(?P<path>.*)$', 'django.views.static.serve',
                {'document_root': settings.MEDIA_ROOT}),
        ) 
```

设置.py

```
TINYMCE_JS_URL = 'http://127.0.0.1:8000/site_media/js/tiny_mce/tiny_mce.js'
TINYMCE_JS_ROOT = 'http://127.0.0.1:8000/site_media/js/tinymce/'
TINYMCE_DEFAULT_CONFIG = {
   'plugins': "table,spellchecker,paste,searchreplace",
   'theme': "advanced",
    'cleanup_on_startup': True,
    'custom_undo_redo_levels': 10,
}

TINYMCE_SPELLCHECKER = False
TINYMCE_COMPRESSOR = False
TINYMCE_FILEBROWSER = True
CMS_USE_TINYMCE = True 
```

管理员.py

```
from django.contrib.flatpages.models import FlatPage
from django.contrib.flatpages.admin import FlatPageAdmin
#Flatpages
class FlatPageAdmin(FlatPageAdmin):
    class Media:
        js = ('http://127.0.0.1:8000/js/tiny_mce/tiny_mce.js',
              'http://127.0.0.1:8000/js/tiny_mce/textareas.js',)

# We have to unregister it, and then reregister
admin.site.unregister(FlatPage)
admin.site.register(FlatPage, FlatPageAdmin)
#django-cms
from myprograms.cms.models import Page
class PageOptions(admin.ModelAdmin):
    class Media:
        js = ('http://127.0.0.1:8000/site_media/js/tiny_mce/tiny_mce.js',
              'http://127.0.0.1:8000/site_media/js/tiny_mce/textareas.js')
#admin.site.register(Page, PageOptions) 
```

在 base.html 文件中

```
<script type="text/javascript" src="{{ MEDIA_URL }}js/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript" src="{% url tinymce-js "NAME" %}"></script> 
```

访问各种用户组、文档等时有很多不同的选项。我不确定什么是正确的语法。如果没有某种文本编辑器，CMS 对我没有多大帮助。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T15:52:52.017

首先请用斜线检查这一行，如：

`<script type="text/javascript" src="{{ MEDIA_URL }}/js/tiny_mce/tiny_mce.js"></script>`

还请检查错误日志中的 site_id。site_id 有类似的问题，因为我创建了具有不同 ID 的新站点。

最好的，Mykola Lys。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-08T09:05:42.510

如果您需要更多功能，那么简单的平面页面只需签出 django-blocks ( [http://code.google.com/p/django-blocks/](http://code.google.com/p/django-blocks/) )。拥有多语言菜单、平面页面，甚至还有一个简单的购物车！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-21T14:01:27.060

你读过[Django wiki 上的 TinyMCE 页面](http://code.djangoproject.com/wiki/AddWYSIWYGEditor)吗？此外 - 虽然它看起来可能不适用于您 -[浏览器阻止来自不同服务器/域的脚本的调用](https://stackoverflow.com/questions/572025/tiny-mce-popups-blank-in-django-admin/1158623#1158623)......

# sql - Linq To Sql 存储过程的并发性

> ID：836278
> 
> 赞同：2
> 
> 时间：2009-05-07T18:33:08.153
> 
> 标签：sql, linq, wcf, linq-to-sql, concurrency

我来自 asp.net 世界，我们将使用 objectdatasource，连接到数据访问层，并将其 ConflictDetection 属性设置为“CompareAllValues”。ObjectDataSource 上有一个 OldValuesParameterFormatString 用于标识旧值参数。

执行更新的 sql 过程将同时需要新参数和旧参数，就是这样……实现起来超级简单；ODS 为您处理旧值。

我已经转移到 Linq to SQL 和 WinForms。我已经创建了一个 WCF 服务，它是我们的业务层，并且我有一个将更新某些表的存储过程。在数据上下文设计器中，我看到我的类列上有一个更新检查属性。我不是直接从类中更新表，而是调用存储过程来进行更新。是否有某种方法可以保留原始值，可能来自数据上下文，类似于 objectdatasource 的方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T13:30:17.483

您是直接（通过 a `SqlCommand`）还是通过 LINQ to SQL 使用存储过程？LINQ to SQL 支持对所有数据库访问使用存储过程。您可能想查看[使用存储过程更新我们的数据库](http://weblogs.asp.net/scottgu/archive/2007/08/23/linq-to-sql-part-7-updating-our-database-using-stored-procedures.aspx)，这是[Scott Guthrie](http://weblogs.asp.net/scottgu/)关于 LINQ to SQL 的博客文章系列的第 7 部分。您可以通过 DBML 设计器或在使用`DataContext`部分类的代码中设置存储过程的使用。这个想法是您将新值和原始值（例如`Name`和`OriginalName`）发送到存储过程，以便它可以进行并发检查。

如果您直接使用存储过程而不是通过 LINQ to SQL，并且您只想获取对象的原始值，则可以通过`Table<T>.GetOriginalEntityState()`以下方式获取它们：

```
Order modifiedOrder = db.Orders.First();  // using first Order as example
modifiedOrder.Name = "new name";          // modifying the Order
Order originalOrder = db.Orders.GetOriginalEntityState(modifiedOrder); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T13:19:36.880

不是您可能正在寻找的答案，但由于您提到将 WCF 作为业务层与 LINQ2SQL 一起使用，我觉得我有义务指出这篇文章供您参考：

[http://www.sidarok.com/web/blog/content/2008/05/26/linq-to-sql-with-wcf-in-a-multi-tiered-action-part-1.html](http://www.sidarok.com/web/blog/content/2008/05/26/linq-to-sql-with-wcf-in-a-multi-tiered-action-part-1.html)

虽然本文将 ASP.NET 实现为主要表示层，但考虑到您的背景，它实际上可能会使文章更易于理解。

我个人处理了与您现在所做的相同类型的开发（客户端的 winforms，业务逻辑层的 WCF，数据访问的 LINQ2SQL），但当时完全是 WCF 和 LINQ2SQL 的初学者，我基本上被迫放弃原来的价值保留。本文最接近您的需求，但老实说，我还没有看到任何可以使用存储过程的东西。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-01T05:00:11.973

*   放弃存储过程并为您的表创建一个新的 DBML 文件。
*   把你的桌子拖进去然后砰！LinqToSql 将为您创建实体类，并提供更新方法（创建.. 等）。

LinqToSql 有许多并发方法。重载`Attach()`方法之一（用于更新）需要 2 个参数：原始实体和新实体。LinqToSql 将做过去常做的`ObjectDataSource`事情，并将旧值与新值进行比较并抛出并发异常（它甚至使处理并发异常变得更加容易。+10 ..但这不是你的问题）。

[使用此参考资料](http://msdn.microsoft.com/en-au/library/bb546187.aspx#Mtps_DropDownFilterText)，尤其是底部称为**With Complete Entities**的部分。它很有意义，并展示了如何使用不同的并发方法以及如何处理异常。

玩得开心。

# c# - 如何从多用户编辑中锁定 asp.net 页面？

> ID：836280
> 
> 赞同：3
> 
> 时间：2009-05-07T18:33:56.623
> 
> 标签：c#, asp.net

我有一个页面，其中包含经过身份验证的用户可以更改的一系列复选框。我需要使此页面一次只能由一个人编辑。因此，如果用户进入其中并编辑其中一个复选框，则其他人无法进入该页面并更改其他复选框。

我考虑了一个编辑页面链接和一个只读页面链接（禁用所有控件），然后如果用户在编辑模式下进入，则设置一个数据库标志，但我担心的是我不知道用户是否更改了某些内容，然后只是 x'd退出浏览器/应用程序，将其他所有人拒之门外。

这是公司的内部应用程序。有没有人做过这样的事情？

有什么想法或想法或建议吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T18:37:35.303

我们在较旧的 ASP 应用程序上具有此功能。用户将使用某种类型的主键加载数据。我们放入一个数据库条目来“锁定”该页面。如果他们正确地通过站点，它将在那时解锁资源。

打开此页面的其他用户将收到该页面已锁定并呈现只读版本的指示。

编写一个 unPageUnload AJAX 调用来重置浏览器关闭的锁定是相当简单的。我们认为这不是什么大问题，如果超过 4 小时，旧锁只需通过晚间进程清除。

我们的情况是页面与特定数据区域相关联。如果这是一个通用配置屏幕，我认为一个更动态的 AJAX 解决方案将更新推回并 ping 更改可能是有意义的。您必须决定是在收到第一次更新后禁用其他人的更改，还是对数据实施冲突检测。

某些类型的页面数据散列可能会使检测更改更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T18:36:30.597

你照你说的做，但是添加一个客户端计时器，它将 ping 服务器并告诉你他们仍然在那里。如果您在 x 分钟内没有收到 ping，您可以让新用户进入编辑模式，但可能会警告他们（或不警告他们）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T19:00:58.243

如何让所有用户编辑此页面以及您的脚本如何检查页面更新？就像 SO 所做的那样，当您输入答案时，上方会出现一条橙色消息，上面写着“已发布至少一个新答案”。您可以显示类似“自从您上次打开页面以来该页面已被修改”之类的内容。

ASP.NET AJAX 中有类似计时器的东西。您可以使用它与服务器对话以发送“IN EDIT”状态更新。你甚至可以走得更远。假设您每 15 秒异步发送一次“LOCKOUT REQUEST”请求，并且您希望收到来自服务器的“LOCKOUT GRANTED”响应。如果尚未收到响应，则禁用页面上的所有控件，直到下一个请求收到确认（之前的消息可能已在网络中丢失）。这样，如果一个用户关闭浏览器，另一个用户将不必等待几分钟或几小时，直到他们获得编辑权限。

本质上，您需要一个临界区概念的分布式实现。通过 HTTP 实现它是一个挑战。但这是一个非常有趣的挑战，不是吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-09T16:53:03.563

如果您试图阻止两个用户更新数据库记录并相互覆盖，那么检测到这一点可能比阻止它更容易。

对此的策略是在记录中包含一个“版本”字段，并在呈现页面时将其保存在隐藏字段中。

然后您只需将其作为更新的条件（即`UPDATE ... WHERE ID = myID AND VERSION = myversion`） - 如果您的更新返回 0 行，您知道其他人修改了数据，然后您可以决定要做什么 - 重新加载新数据，为用户提供机会比较它们等

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T18:52:28.607

扩展锁的替代品怎么样？

由于您似乎在处理相对少量的数据，因此将数据原始状态的编码版本放在隐藏的表单字段（或日期戳，尽管这不太可靠；值的散列会起作用）会更有礼貌对于大量数据）。在事务中，对照隐藏的表单值检查数据库的状态；如果自用户提交更改后原始记录已更改，则您拒绝更新。如果不是，请接受更新并提交事务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T19:10:59.233

另一种方法可能是使用包含锁定项目的映射或字典的应用程序变量。

因此，当一个用户点击编辑时，向 AppVariable Map 或 Dictionary 添加一个条目，并将 Key 设置为正在编辑的字段的主 ID。然后对于所有进一步的请求，当它们在记录之间发生更改时，请检查地图中的 ID，如果它正在被编辑，请关闭任何更新按钮。如果您想使用 AJAXy，请添加一个计时器和一个 UpdatePanel 并轮询以查看锁定何时释放，然后使用更新的数据刷新页面并再次启用更新按钮。

或者，作为一个稍微大一点的 UI，允许用户在等待锁释放（要删除的 Map 项）时进行编辑，然后在删除时将他们一直在处理的字段与更新的数据库值和允许他们覆盖/合并他们的更改。

唯一真正的缺点是，1）您需要为要锁定/解锁的每个表创建一个应用程序级字典或映射。2) 如果您进入 webfarm 环境，它会中断，您将不得不使用不同的系统。

那有意义吗？

# java - 在 Unix 上使用 Java 验证 SSH 凭证

> ID：836281
> 
> 赞同：1
> 
> 时间：2009-05-07T18:34:04.813
> 
> 标签：java, unix, authentication, ssh

我在 unix 机器上有一个文本文件，其中包含有人可能用来连接它的 SSH 用户名和密码。

如何使用 Java 验证用户名和密码是否有效？

我是否尝试使用 Runtime.exec() 通过 SSH 连接到同一台机器？

我可以 grep 为用户 /etc/passwd。但是，密码是隐藏的。

我会很感激任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T19:49:02.230

也许问题可以扩大到“验证来自 Java 的 UNIX 凭据”，因为所解释的机制并不是真正依赖于 ssh。

这是我在不使用网络堆栈开销的情况下作为更好的类似 Expect 的替代方案（例如使用[ProcessBuilder ）的镜头：](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)

`su -u username -c echo`

只需检查退出状态即可知道答案。（加分项：su 存在于所有 UNIX 操作系统上，它甚至可能位于 PATH 上，并且对于 LDAP 等其他外部身份验证系统也有效）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T19:05:11.730

如果您有 root 访问权限，那么您当然可以阅读**/etc/shadow**。我会说这是“正确”的做法。

除此之外，我认为您调用 ssh 的简单方式应该没问题，但我会使用**ssh 运行一个命令**，例如创建一些随机临时文件 - 然后，如果创建了文件（或执行了命令)，您假设用户名/密码是正确的。听起来很恶心，但你可以让它在紧急情况下工作。

哦，当然，frig 具有您实际以该用户身份登录的副作用。这可能是可取的，也可能是不可取的……！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:12:06.653

请记住，UNIX 身份验证除了 /etc/passwd 和 /etc/shadow 之外还有更多内容。例如，它们可能针对 Kerberos、LDAP、NIS 或任何其他数量的源进行身份验证。出于这个原因，我强烈建议您研究 Java 的 PAM 包装器。一个快速的谷歌出现了[http://jpam.sourceforge.net/](http://jpam.sourceforge.net/)但我没有这方面的经验。

当然 sshd*可能*被配置为根本不使用 PAM 或只允许某些用户等。如果你想完全遵循 sshd 的规则，那么这会改变事情，但听起来 PAM auth 更符合你的要求。

# .net - 在 .NET 中在给定时间触发代码的最简单方法

> ID：836286
> 
> 赞同：0
> 
> 时间：2009-05-07T18:34:50.973
> 
> 标签：.net, multithreading

我正在寻找一些美好而简单的东西。例如：

```
RunAfter(3, delegate() { z = 5; }); // run after 3 seconds
FnThatTakes5Seconds(); 
```

在我的情况下，我想测试一些线程代码并在另一个函数调用的中间发生一些事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T18:47:28.323

```
public static void RunAfter(int millisecondTimeout, 
    System.Threading.ThreadStart method) 
{ 
    System.Threading.Thread t = new System.Threading.Thread(() => 
    { 
        System.Threading.Thread.Sleep(millisecondTimeout); 

        method(); 
    }); 

    t.Start(); 
} 
```

然后你可以做

```
RunAfter(3000, () => z = 5;); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:39:47.157

我会使用只触发一次并立即启动的 System.Threading.Timer。

```
System.Threading.Timer _timer = new Timer(ProcessTimer, null, 3000, Timeout.Infinite); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T18:50:07.303

您还可以使用 WaitHandle 等待后台工作程序发生超时。

```
ManualResetEvent objResetEvent = new ManualResetEvent();
objResetEvent.WaitOne(timeout, ...); 
```

# javascript - js/jquery/html：从 iframe 中获取 div

> ID：836288
> 
> 赞同：1
> 
> 时间：2009-05-07T18:34:58.477
> 
> 标签：javascript, jquery, html

如何将 iframe 中的 div 抓取到 JS 变量中？不一定要使用 jQuery。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T18:42:09.617

```
document.getElementById('IframeId').contentWindow.document.getElementById('DivId'); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-07T18:49:16.993

在 jQuery 语法中，这将是`$('iframe').contents().find('div')`. （当然，替换您需要的任何特定 ids/classes/其他选择器）。Tracker1 的答案应该适用于标准 Javascript。

# xcode - 为什么 Xcode 有时会制作紫色，有时会变成黑色？

> ID：836292
> 
> 赞同：0
> 
> 时间：2009-05-07T18:35:51.610
> 
> 标签：xcode

例子：

```
scrollView.scrollEnabled = YES; //scrollEnabled appears black
scrollView.pagingEnabled = NO; //pagingEnabled appears purple 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T05:14:36.100

检查您的字体和颜色首选项。每种颜色指定一个不同的标识符类别。

[替代文字 http://idisk.mac.com/cdespinosa/Public/FontsAndColors.png](http://idisk.mac.com/cdespinosa/Public/FontsAndColors.png)

它们颜色不同的原因是，即使它们都是 UIScrollView 对象上的属性，pagingEnabled 标识符也被声明为 UIScrollView 结构中的无符号 int 位域成员。这导致它以其他实例变量和全局颜色绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:50:20.667

我注意到的是我有一个定义类变量的行列表，列表中的最后一行没有正确的颜色编码。

```
NSMutableArray *answers;     // purple
NSMutableArray *etymologies; // purple 
NSMutableArray *questions;   // black 
```

如果我更改顺序，最后一行总是黑色的。(Xcode 4.5.2)

# c# - 数据库迁移和视图

> ID：836296
> 
> 赞同：2
> 
> 时间：2009-05-07T18:36:13.890
> 
> 标签：c#, .net, sql, sql-server, migration

我正在使用 migrator.net 处理 SQL Server 的数据库迁移，到目前为止我很喜欢它。我遇到的唯一问题是如何最好地将更改迁移到视图。到目前为止，我一直将每个更新作为单独的脚本文件（它重新创建视图）进行管理。这让我可以在不复制代码的情况下返回到以前版本的视图。这种方法目前运行良好，但对视图进行微小更改似乎需要做很多工作。有没有其他人遇到过这种类型的问题？是否有任何库可以更强大地处理视图迁移？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T10:02:17.807

每当我必须更改视图时，我都会将更改编写为 DROP IF EXISTS 和 CREATE。这是我的偏好，虽然它似乎比其他方法更有效（ALTER 脚本也可以），但它允许版本控制，正如你所建议的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T08:32:16.443

视图作为文本块存储在 SQL Server 中，因此您可以参考它们。我不记得你会在哪里找到它们的表和列。但基本上这就是我理解的方式，我们没有命令来更新 proc 中的奇数行。

# concurrency - 寻找监视器诗句信号量的好类比/例子

> ID：836301
> 
> 赞同：3
> 
> 时间：2009-05-07T18:36:45.417
> 
> 标签：concurrency, synchronization, shared-memory, semaphore

监视器应该解决并发环境中的信号量问题。
我正在寻找一个使用监视器与信号量的好类比。

**请使用类比信息：**
4 个任务（TaskA、TaskB、TaskC、TaskD）
1 个变量*varX*

每个 Task 都想根据某个事件来操作*varX 。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T18:43:14.043

假设有一群病人想去看医生。

一个信号量的实现是他们都站在办公室的门外，一个病人一出来，他们都想挤过去，一个人设法进去，剩下的又要等待。

监控器的实现是，所有进来的病人都被送到候诊室，一些相似的顺序将被确定，当一个病人完成后，另一个病人将被送到医生那里。

它们基本上是一样的，监视器比信号量更结构化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T01:34:22.297

您还可以将监视器视为公共厕所。一旦有人进入关闭的厕所门，里面的人不希望其他人进入那个空间（即监视器）。所有其他人（线程）都必须在厕所前排队等待（wait()）。只有里面的人做完之后，才出来，下一个人才能进去。

一些等待的人可能有便秘问题。出于显而易见的原因，除非他们准备好正确使用厕所，否则他们不想进去或返回。这是他们想要等待（wait()）的地方，直到他们的胃向他们发出信号（signal()）他们准备好上厕所了。在这发生之前，他们让其他人通过。

*资料来源：www.mijnadres.net/published/Monitor%20Object%20Pattern.pdf*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T12:37:42.933

将资源争用与事件通知分开很重要。Monitor 和 Semaphore 用于限制对共享资源的访问。监视器基本上是一个计数为 1 的信号量。如果您的每个任务都想访问单个 varX，那么您需要使用监视器（或 1 的信号量）来保护它：

```
Monitor.Enter 
// do something with varX
Monitor.Exit 
```

或者

```
Semaphore.Acquire
// do something with varX
Semaphore.Release 
```

使用信号量，您显然可以将允许的并发参与者的数量设置为共享资源。

缺口。

# user-interface - 初学者GUI问题，组织不同的“视图”

> ID：836309
> 
> 赞同：0
> 
> 时间：2009-05-07T18:37:49.593
> 
> 标签：user-interface, language-agnostic

我之前为 CLI 和 Web 做过很多编程，但最近我开始涉足桌面 GUI 编程。

我发现的大多数 GUI 编程教程只是解释了您可以使用的不同控件，然后就不用说了。一些更好的也略过一些可用性问题。

但是，我的问题不在于 API 或理论，而在于我的代码。

您应该如何组织您的应用程序可能具有的不同视图（例如，IM 应用程序具有登录视图、联系人列表视图、对话视图等）。

这些应该是一个类的不同类或不同的方法吗？隐藏和显示的不同面板，还是完全不同的窗口？

我希望得到尽可能与语言无关的答案，但如果不可能，我正在考虑的语言/框架是 Java/Swing 或 C#/WPF。但是，如果有另一种语言/框架更适合学习，我会考虑使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T18:42:32.547

通常每个视图将是单独文件中的单独类。然后该类很可能会实现一些基类，例如 Window 或 Control。

至于组织，如果它是一个简单的应用程序，请将它们放在根目录或 UI 文件夹中。或者可能是 Window 文件夹和 Controls 文件夹。

如果它是一个具有多个视图的大型应用程序，则将它们分解为功能，即 IM 文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:44:55.613

我想说的是 Joshua 所说的，就使用隐藏和显示的不同面板而言，我已经处理过旧代码，重复使用是一场噩梦（8000 多行 Delphi 6！）所以坚持使用不同的窗口越多越好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T19:03:02.590

一般推荐的程序整体结构是模型-视图-控制器（[MVC](http://en.wikipedia.org/wiki/Model-view-controller)）类型的结构。所以，首先，不要让实际数据成为视图的一部分，它会进入模型。从这里开始，由于每个视图窗口中的唯一数据现在几乎完全只是布局信息以及对操作（单击、数据显示等）执行的操作，如果这些不同，它们可能应该是不同的类。如果有一些通用的功能可以被分解出来，你可以把它作为一个基类并从它继承，但最后，具有不同功能的窗口应该是不同的类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T19:05:04.537

如果您要使用主流 IDE 之一，它将为您处理其中的一些工作。每个表单的默认值将是不同的类。隐藏面板和选项卡式界面是不错的功能，但请帮自己一个忙，并了解将控件组嵌入表单的来龙去脉。一些框架允许您直接将一种形式嵌入到另一种形式中。其他人有可以嵌入的特殊容器。

这样做的目的是分解您的功能，这样您就不会遇到难以通过的臃肿表单类。

我还会花一些时间研究一些架构模式，以使您的业务逻辑与您的 UI 分开。查看此[链接](http://www.martinfowler.com/eaaDev/index.html)以获得良好的起点。

# visual-studio-2008 - 在 Visual Studio 2008 中更改字体大小和样式

> ID：836310
> 
> 赞同：27
> 
> 时间：2009-05-07T18:37:50.233
> 
> 标签：visual-studio-2008

在 Visual Studio 2008 中更改字体大小和字体类型的设置在哪里？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-07T18:40:49.260

使用菜单*工具*->*选项*-> 内部*环境*->*字体和颜色*：

![Visual Studio 中选项对话框的屏幕截图，由菜单命令工具/选项调用。](https://i.stack.imgur.com/hKRWW.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T18:41:15.950

它位于菜单*工具*/*选项*/*环境*/*字体和颜色*中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T02:17:05.713

您*可以**从*. _ _ *_* _`http://studiostyl.es/schemes`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T18:47:25.343

是的，您可以使用菜单*Tools* -> *Options* -> *Environment -> *Fonts And Colors*来做到这一点。此外，如果您对 Visual Studio 和其他东西的旧主题感到厌烦，您可以更改 Visual Studio 的主题。

我有[一个将为 Visual Studio 创建主题的网页](http://frickinsweet.com/tools/)，您只需将这些内容导入您的环境。

# ruby-on-rails - 在 Rails 中的 belongs_to 上有 has_one？

> ID：836317
> 
> 赞同：2
> 
> 时间：2009-05-07T18:39:26.610
> 
> 标签：ruby-on-rails, activerecord, associations

我正在建立一个 Rails 站点，但在关联方面遇到了麻烦。基本上我有以下几点：

```
class Publication < ActiveRecord::Base
  belongs_to :category
  has_one    :site, :through => :category
  named_scope :on_site,        lambda {|s| {:include => [:site], :conditions => ['sites.slug != ?', 's']}}
end
class Category
  belongs_to :site
  has_many   :publications
end
class Site
  has_many :categories
  has_many :publications, :through => :categories, :foreign_key => 'category_id'
end 
```

`Publication.first.site`制作第一个出版物的网站，`site.first.publications`也是如此。

问题在于`on_site`命名范围，它会产生以下错误，例如`Publication.on_site('s')`

```
Mysql::Error: Unknown column 'categories.category_id' in 'on clause': SELECT 
`publications`.`id` AS t0_r0, `publications`.`shoot_id` AS t0_r1, 
`publications`.`category_id` AS t0_r2, `publications`.`title` AS t0_r3, 
`publications`.`slug` AS t0_r4, `publications`.`publish_on` AS t0_r5, 
`publications`.`created_at` AS t0_r6, `publications`.`updated_at` AS t0_r7, 
`publications`.`description` AS t0_r8, `publications`.`media_base_path` AS t0_r9, 
`sites`.`id` AS t1_r0, `sites`.`name` AS t1_r1, `sites`.`created_at` AS t1_r2, 
`sites`.`updated_at` AS t1_r3, `sites`.`slug` AS t1_r4, `sites`.`description` AS t1_r5, 
`sites`.`dhd_merch_id` AS t1_r6, `sites`.`members_area_url` AS t1_r7 FROM `publications`
 LEFT OUTER JOIN `categories` ON (`publications`.`id` = `categories`.`category_id`)  
 LEFT OUTER JOIN `sites` ON (`sites`.`id` = `categories`.`site_id`) WHERE (sites.slug != 's') 
```

我需要那个加入是publications.category_id = categories.id，知道我有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T03:04:22.240

好吧，这是您当前实现的一个问题：

```
LEFT OUTER JOIN `categories` ON (`publications`.`id` = `categories`.`category_id`) 
```

该 SQL 片段由以下关联定义创建`Site`：

```
has_many :publications, :through => :categories, :foreign_key => 'category_id' 
```

`foreign_key`那里是不正确的。Rails 正在寻找一列`categories`被调用`category_id`，并期望该列的值与某个发布 ID 匹配。但是没有`foreign_key`可以设置的正确选项，因为`categories`表格看起来没有对`publications`表格的引用 - 它是相反的。

我不确定是否可以`has_many :through`通过中间`has_many`关联使 ActiveRecord 的关联工作。但我认为您可以使用嵌套关联功能来完成这项工作：

```
class Publication < ActiveRecord::Base
  belongs_to :category
  #has_one    :site, :through => :category
  named_scope :on_site,        lambda {|s| {:include => { :category => :site }, :conditions =>  ['sites.slug != ?', s]}}
end 
```

另一个问题是您`s`在条件数组中加上引号。它不应该用引号引起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:03:13.200

`:joins`好吧，如果有人感兴趣，我找到了使用范围选项的解决方案。我仍然想知道是否可以不使用`:joins`。

```
 named_scope :on_site,        lambda {|s| {:joins =>
   ['LEFT OUTER JOIN `categories` ON  (`publications`.`category_id` = `categories`.`id`) ',
   'LEFT OUTER JOIN `sites`      ON  (`sites`.`id` = `categories`.`site_id`)'],
   :conditions => ['sites.slug = ?', s]}} 
```

# javascript - 有没有像样的基于浏览器的 javascript 自编辑器？

> ID：836318
> 
> 赞同：7
> 
> 时间：2009-05-07T18:39:32.367
> 
> 标签：javascript, ide, editor

有没有像样的基于浏览器的 javascript 自编辑器？

很明显，可以用一个包含表单文本区域、一些按钮和回调的页面来制作一个快速的 js 编辑器。我想知道是否有人将其作为一个开始并随之而来。

要编辑的 javascript 可以在全局字符串中定义，也可以是服务的 .js

理想的编辑器会在浏览器窗口中显示一个漂亮的版本，并为编辑脚本提供某种开发环境。

据了解，用户编写的脚本仅存在于浏览器中，如果没有一些额外的服务器端功能，则无法保存。理想的包会讨论和探索这个......但我会接受任何让用户对 100-200 行脚本进行简单更改的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T18:48:41.580

我不确定您到底要什么，但是[jsbin 是否](http://jsbin.com)满足您的需求？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T19:10:56.783

听起来你想做的最困难的部分是解析 javascript，以便你可以用它做一些智能的事情。CodeMirror库可以帮助您开发一些放在页面上的东西[。](http://marijn.haverbeke.nl/codemirror/)

更新：

Etherpad 已经不在了，但[Ace](http://ace.ajax.org)真的很棒。它历史悠久，是[Cloud9 IDE使用的引擎](https://c9.io/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T18:53:00.790

有

*   [http://sourceforge.net/projects/codepress](http://sourceforge.net/projects/codepress)
*   [http://www.cdolivet.com/index.php?page=editArea&sess=4b049cee4477f0820c82231b09e80a91](http://www.cdolivet.com/index.php?page=editArea&sess=4b049cee4477f0820c82231b09e80a91)
*   [http://marijn.haverbeke.nl/codemirror/](http://marijn.haverbeke.nl/codemirror/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T21:02:26.097

还请查看[Bespin](https://bespin.mozilla.com/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-11T17:58:33.497

还有一些集成解决方案，除了基于浏览器的 JavaScript 代码在线编辑之外，还可以为您做其他事情，例如在浏览器中运行 JS 代码或为您托管它。

如果您对这些感兴趣，请尝试[Erbix.com](http://www.erbix.com/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-04T12:34:58.187

[代码运行](http://www.coderun.com/ide/)

# asp.net - 如何在asp中填充图像和文本：菜单控件

> ID：836319
> 
> 赞同：3
> 
> 时间：2009-05-07T18:39:32.413
> 
> 标签：asp.net, menu, menuitem

我有一个 asp:Menu 控件，其中有四个不同的菜单项。每个菜单项都有一个图形和一个文本描述。

```
<Items>
    <asp:MenuItem Text="New Authorization Form" Value="default.aspx" NavigateUrl="~/Default.aspx" ImageUrl="~/Images/TextPad.png"></asp:MenuItem>
    <asp:MenuItem Text="Manage My Forms" Value="myrequests.aspx" NavigateUrl="~/MyRequests.aspx" ImageUrl="~/Images/Pencil.png"></asp:MenuItem>
</Items> 
```

我的问题是图标和文本之间没有填充，看起来很丑！有谁知道我如何在菜单项的图像和文本之间强制进行一些填充？我已经查看了 asp:Menu 控件上的所有属性，但我无法为此找到一个，但我可能只是错过了它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T19:19:03.397

我想出了一个答案，但这并不是我所希望的。我在我的 css 中添加了 img 标签的样式，如下所示：

```
img
{
    padding-right: 5px;
} 
```

我仍然有点沮丧 asp:Menu 控件中没有允许您指定图像和菜单项文本之间的填充的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:45:29.077

您可以尝试创建一个皮肤，然后您可以添加一个 css 类并以您想要的任何方式对其进行样式设置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-19T20:43:04.757

Menu中的图像项是由类图标控制的，修改这个类的属性应该可以解决问题。我将 padding-right 设置为 5px 以空间图像和文本

# c# - Novell 集成身份验证 - 在网站上获取本地计算机用户名

> ID：836323
> 
> 赞同：1
> 
> 时间：2009-05-07T18:40:03.600
> 
> 标签：c#, .net, iis, authentication, novell

首先，我知道如何在 IIS7 中集成 Windows 身份验证。这非常适合查看登录计算机的 Active Directory 用户。

但是，需要获取 Novell 认证用户的用户名。我不想要密码或用户名以外的任何东西。

其他限制：

*   无法在用户计算机上安装任何东西
*   可以在网络服务器上安装东西
*   可以在 Web 服务器和 Novell 服务器之间建立信任
*   它会在一个匿名访问的公共网站上，我可以安排一个需要身份验证的部分，从而从那里获取用户。
*   该网站使用 C# .Net 2.0
*   如果该方法还可以提供密码，我可以使用它来完全验证 Novell 的用户。该部分（与 Novell 服务器 LDAP 通信）已经完成。
*   必须使用 IE6 和 IE7

（更新）在 Novell 网站上[，关于单点登录的唯一信息](http://www.novell.com/coolsolutions/appnote/14730.html)显示了如何在 Novell 上登录某人，并且在结论中说明了这一点：

> 一种将我们的凭据保存在全局变量中的方法（还有其他方法），这样用户就不必为每个表单进行身份验证（单点登录）。

（更新）同样来自 Novell，他们说有一个[SSO 解决方案](http://support.novell.com/techcenter/articles/ana20000202.html)。但是，内容可以追溯到 2000 年，[另外一个](http://support.novell.com/techcenter/articles/ana20020502.html)需要在 Novell 服务器上安装插件并为每位用户支付 49 美元。所以它不是一个有效的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T04:55:56.927

您说您无法在用户的计算机上安装任何东西，但您可能会发现已经有一个您可以使用的 ActiveX 控件，它可能作为 PC 上 Novell 客户端的一部分涉及。

我过去曾这样做过，使用 ActiveX 控件来识别登录用户，将其传递给网络服务器，然后使用 LDAP 加载完整的用户记录：

我过去使用过一个称为 NWDir1 的语法，使用以下语法（使用 ColdFusion 作为服务器端语言，但我相信你可以翻译）：

```
 <cfoutput>
    <object classid="CLSID:4F021AE3-9E98-11D0-A808-00C04FDCD94A"id="NWDir1" width=32 height=32></object>
    <script language="VBScript">
    Dim vbuser
    Sub Window_OnLoad()
     On Error Resume next
     vbuser = NWDir1.LoginName
     vbuser = StrReverse(vbuser)
     initInd = InStr(vbuser, Chr(92))
     if initInd <> 0 Then
      vbuser = Left(vbuser, initInd-1) 
      vbuser = StrReverse(vbuser)
     End if
     // REDIRECTION
     document.location.href = "index.cfm?userid=" + vbuser
     Exit sub
    End Sub 
    </script>
    <cfabort> 
   </cfoutput> 
```

这使用 vbscript 来控制提供 Novell 登录用户的 activex 客户端。然后将该值 (vbuser) 传递回 index.cfm 以进行处理。

这种技术显然很容易受到 url 黑客攻击，但我不知道在我们使用这种技术的 4 年多的时间里会发生这种情况。

我确定我最初是在 Novell 站点上找到的 - 尝试在该站点上搜索 NWDir1 或 classid。

我希望这有帮助

# jquery - 向所有表头添加一个类

> ID：836326
> 
> 赞同：1
> 
> 时间：2009-05-07T18:40:18.323
> 
> 标签：jquery

我在我的网页中使用 jQuery 和 tablesorter 插件。我的目标是使用其元数据内联插入功能将 tablesorter 标头禁用解析器添加到其类为空的每个标头。我概述了三个函数，第一个是使用空白类（“”）将禁用解析器添加到每个标题的类，第二个将对没有空白类开头的标题执行类切换操作，第三个一旦设置了所有标题，将调用实际的 tablesorter。

```
$(function(){
    //Code is supposed to add the disable parser to each header with a blank class
    $("th").each(function(){
        if ($(this).hasClass('')){$(this).addClass('{sorter: 'false'}');
    });
});

$(function() {
    //Code manipulates headers with non-blank classes
}); 

$(function() {
    //Call tablesorter on all tables once their headers are set.
    $("table").tablesorter({}); 
}); 
```

到目前为止，第二个和第三个功能按预期工作，尽管我最终计划进一步扩展第二个功能，一旦我可以解决第一个功能的问题。这导致了我的问题，那就是添加解析器的第一个函数似乎根本没有添加类，此外，由于它不能正常工作，它似乎阻止了第二个和第三个工作。如果我取消第一个功能，这些功能将起作用；我不确定我的语法是否错误，或者我是否可以以这种方式动态添加解析器。以下是 HTML 中的标头示例：

```
<th class=""><a rel = "Header" href="#" title="Sort title in decending order" class="">Title</a></th>
<th class=""><a rel = "Header" href="#" title="Sort instructor in descending order" class="">Instructor</a></th>
<th class="{sorter: 'usLongDate'}"><a rel = "Header" href="#" title="Sort column in decending order" class="">Date</a></th>
<th class="">Start/End</th>
<th class=""><a rel = "Header" href="#" title="Sort column in decending order" class="">Seats Available</a></th>
<th class=""><a rel = "Header" href="#" title="Sort column in decending order" class="">Enrolled</a></th>
<th class=""><a rel = "Header" href="#" title="Sort column in decending order" class="">Pre-Requisites</a></th>
<th class="">Workshop Actions</th> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T18:53:56.187

您的问题出在这一行：

```
if ($(this).hasClass('')){$(this).addClass('{sorter: 'false'}'); } 
```

您在里面的引号`{sorter:'false'}`正在关闭外部引号。尝试这个：

```
if ($(this).hasClass('')){$(this).addClass("{sorter: 'false'}"); } 
```

除此之外，添加具有该值的类对我来说看起来很奇怪，但如果您确定 tablesorter 知道不对列进行排序，那么它应该可以工作。您还可以[缩短选择器](http://docs.jquery.com/Selectors/attributeEquals#attributevalue)：

```
$("th[class='']").addClass("{sorter: 'false'}"); 
```

# c++ - 将 VS 2008 Win32 DLL 剥离为一个文件

> ID：836327
> 
> 赞同：0
> 
> 时间：2009-05-07T18:40:33.473
> 
> 标签：c++, visual-studio-2008, winapi

我有一个 VS 生成的 C++ Win32 DLL 项目。它有以下文件：

stdafx.h targetver.h myProject.h dllmain.cpp myProject.cpp stdafx.cpp

我可以删除 targetver.h，并将 dllmain.cpp 合并到 myProject.cpp 中。我还能做些什么来获得最简单的文件结构，最好是一个文件。我需要动态发出此代码文件并将其构建到 Win32 DLL 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T18:45:36.877

除了 Andy 所说的之外，您还可以将`myProject`头文件和实现文件与`dllmain.cpp`. 但是为什么不保留这些文件并在运行时创建 vsproj 文件呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:25:01.583

或者你可以创建一个空项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T20:33:36.133

如果你想要一个简约的文件结构，你可以自己创建文件。启动一个空项目，或删除所有文件。哎呀，只需创建一个文件夹，编写 main.cpp，然后[使用 cl 从命令行编译它](http://msdn.microsoft.com/en-us/library/ms235639.aspx)。

很少有 IDE 真正尝试像您尝试的那样最小化文件 - 但是当您创建项目时，您可以减少一点：stdafx.[h, cpp] 用于预编译头文件，您可以在创建项目时禁用它。

也就是说，我并没有真正看到最小化编译语言项目中源代码数量的价值——它不会对输出文件/dll的数量产生有意义的影响，并且正确使用，只使用更多文件有助于您的代码清晰。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T18:42:51.127

IIRC，`myProject.h`两者`myProject.cpp`都包含导出类的示例。您可以轻松删除这些。

`stdafx.cpp`并`stdafx.h`用于标准的预编译头文件。如果您关闭需要预编译标头的设置，则也不需要这些文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T20:57:47.760

您可以将生成的文件#include 到现有的多文件项目中。这样你就可以拥有一个复杂项目的外壳，并且只发出一些更小的东西，比如一个简单的函数。

例如：

```
#include <system_stuff>

void main()
{
   Go();
}

#include "generated_file_that_has_method_go.cpp"

void other_code()
{
} 
```

# apache-flex - Flex：Label.addChild() 不工作？

> ID：836330
> 
> 赞同：1
> 
> 时间：2009-05-07T18:40:51.507
> 
> 标签：apache-flex

我想制作一个上面有一个小标题的标签，例如，标签上写着**1,000 美元**，*零售价*或*我们的价格*高于它。我正在尝试将标题标签添加到主标签的显示列表中。我没有收到错误，但标题没有显示。我也考虑过 rawChildren 但显然 Label 没有 rawChildren 属性。

这是我的代码：

```
package
{
    import mx.controls.Label;

    public class PriceLabel extends StrikeThroughLabel //<-- exntension of label to add strike
    {
        private var _title:Label;

        public function PriceLabel()
        {
            super();
        }

        [Bindable]
        public function set title(s:String):void
        {
            if(_title == null)
            {
                _title = new Label();
                addChild(_title);
                this.alpha = .2;
            }
            _title.text = s;
        }
        public function get title():String
        {
            var s:String
            if(_title != null)
            {
                s = _title.text;
            }
            return s;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T23:39:01.693

如果将子组件添加到不是容器的 Flex 组件，则必须手动管理这些子组件的大小和位置。容器为你做了很多工作。

这是你应该做的：

1.  将您的子标签的创建移动到`createChildren()`函数的覆盖中。

2.  在函数的覆盖中设置`text`子标签的属性。`commitProperties()`您的`title`getter 和 setter 应该将值保存在一个`_title`变量中，以便稍后在`commitProperties()`. 这实际上对性能很重要。

3.  覆盖该`measure()`函数并更新`measuredWidth`并`measuredHeight`成为主标签及其子标签的最大宽度和高度值。

4.  覆盖`updateDisplayList()`并`setActualSize()`在子标签上使用以将其设置为所需的宽度和高度。

这似乎需要做很多工作，但就最佳实践而言，这就是您应该构建自定义组件的方式。Adobe 的 Flex 团队花费了大量时间来最大限度地提高性能，这就是为什么事情会分几个步骤发生。

这就是根据您的要求进行操作的方法。就个人而言，我会创建一个 UIComponent 的子类，其中有两个 Label 或 UITextFields 作为子类，每个子类都有自己的单独属性。

顺便说一句，该`rawChildren`属性仅适用于容器。它的存在是为了让您可以将“chrome”添加到不属于容器子布局算法的容器中。例如，Panel 具有不受垂直/水平/绝对布局选项影响的标题栏和边框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T18:51:44.740

为什么不创建一个包含两个标签作为其子级的自定义组件，而不是尝试在标签上抛出一个子级？这对我来说感觉更清晰，因为将子级添加到这样的内置组件似乎并不正确。

# bash - 在 Bash 中执行包含空格的命令

> ID：836334
> 
> 赞同：14
> 
> 时间：2009-05-07T18:41:39.180
> 
> 标签：bash, shell

我有一个名为的文件`cmd`，其中包含一个 Unix 命令列表，如下所示：

```
hostname
pwd
ls  /tmp
cat /etc/hostname
ls -la
ps -ef | grep java
cat cmd 
```

我有另一个在 cmd 中执行命令的脚本：

```
IFS=$'\n'
clear
for cmds in `cat cmd`
do
        if [  $cmds ] ; then
        $cmds;
        echo "****************************";
        fi
done 
```

问题是 cmd 中不带空格的命令运行良好，但脚本无法正确解释带空格的命令。以下是输出：

```
patrick-laptop
****************************
/home/patrick/bashFiles
****************************
./prog.sh: line 6: ls  /tmp: No such file or directory
****************************
./prog.sh: line 6: cat /etc/hostname: No such file or directory
****************************
./prog.sh: line 6: ls -la: command not found
****************************
./prog.sh: line 6: ps -ef | grep java: command not found
****************************
./prog.sh: line 6: cat cmd: command not found
**************************** 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-07T18:57:36.630

尝试将一行更改为，`eval $cmds`而不仅仅是`$cmds`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T00:24:36.063

你可以用命令替换你的脚本

```
sh cmd 
```

shell 的工作是读取命令并运行它们！如果您想要输出/进度指示器，请以详细模式运行 shell

```
sh -v cmd 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T16:55:32.067

我个人更喜欢这种方法 -如果我不必这样做，我不想修改[IFS 。](https://en.wikipedia.org/wiki/Internal_field_separator)如果要在命令中使用管道，则确实需要使用 eval。管道需要由 shell 而不是命令处理。我相信外壳会在扩展字符串之前解析出管道。

请注意，如果您的 cmd 文件包含需要输入的命令，则会出现问题。（但您始终可以为读取命令创建一个新的 fd 来读取。）

```
clear
while read cmds
do
        if [ -n "$cmds" ] ; then
        eval $cmds
        echo "****************************";
        fi
done < cmd 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T18:55:22.657

**编辑：**原来这在管道和重定向上失败了。谢谢，安多马尔。

您需要更改`IFS`回循环内部，以便 bash 知道在哪里拆分参数：

```
IFS=$'\n'
clear
for cmds in `cat cmd`
do
    if [ $cmds ] ; then
        IFS=$' \t\n' # the default
        $cmds;
        echo "****************************";
        IFS=$'\n'
    fi
done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-15T15:21:02.370

```
sed 'aecho "-----------"' cmd > cmd.sh; bash cmd.sh 
```

sed 'aXX' 将 XX 附加到每一行。这不适用于多行命令，例如：

```
for f in * 
do 
    something $f
fi 
```

但是对于大多数情况下的单行命令，它应该可以。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T18:45:39.327

编辑： Ben Blank 的评论指出我的旧答案是错误的，谢谢。

看起来您正在将命令作为单个字符串执行，因此 bash 将它们视为脚本/可执行文件名称。

避免这种情况的一种方法是在命令上调用 bash。改变：

```
 if [  $cmds ] ; then
    $cmds;
    echo "****************************";
    fi 
```

至

```
 if [  $cmds ] ; then
    bash -c $cmds
    echo "****************************";
    fi 
```

# loops - 如何在 Zsh 中制作管道循环？

> ID：836339
> 
> 赞同：0
> 
> 时间：2009-05-07T18:42:46.523
> 
> 标签：loops, pipe, zsh

Penz 说这个问题可以通过[线程](https://stackoverflow.com/questions/40244/how-to-make-a-pipe-loop-in-bash)中的 Multios 和 coproc 特性来解决。

但是，我不确定解决方案。

我知道你可以使用 multios 作为

```
ls -1 > file | less 
```

但我从来没有使用过你有两个输入。

**如何使用这些特性在 Zsh 中创建管道循环？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T20:12:10.833

我无法理解这些问题。

您是否尝试执行以下操作：

```
(ls -1 && file) | less 
```

其中 && 用于单行上的多个命令。

或者您是否尝试执行以下操作：

```
ls -1 | tee file | less 
```

tee 将输出放入文件和标准输出的位置。

# c++ - 在 C++ 中标记类/方法已过时或弃用

> ID：836342
> 
> 赞同：4
> 
> 时间：2009-05-07T18:43:06.337
> 
> 标签：c++, compiler-construction, attributes

有没有办法将 C++ 中的方法/类标记为过时？

在 c# 中，您可以编写：

```
[Obsolete("You shouldn't use this method anymore.")]
void foo() {} 
```

如果这很重要，我会使用 GNU 工具链/Eclipse CDT。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T12:34:06.783

最简单的方法是使用`#define DEPRECATED`. 在 GCC 上，它扩展为`__attribute__((deprecated))`，在 Visual C++ 上，它扩展为[`__declspec(deprecated)`](http://msdn.microsoft.com/en-us/library/044swk7y.aspx)，而在没有类似内容的编译器上，它扩展为空。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-07T18:46:54.330

仅使用依赖于编译器的编译指示：查找[文档](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)

```
 int old_fn () __attribute__ ((deprecated)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-22T06:18:43.670

c++14 标准（或更高版本）现在提供此功能：[https ://en.cppreference.com/w/cpp/language/attributes/deprecated](https://en.cppreference.com/w/cpp/language/attributes/deprecated)

```
[[deprecated]] void F();
[[deprecated("reason")]] void G();
class [[deprecated]] H { /*...*/ }; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T18:51:14.710

我不知道您使用的 C++ 版本，但 Microsoft 的 Visual C++ 有一个[已弃用的 pragma](http://msdn.microsoft.com/en-us/library/c8xdzzhh.aspx)。也许你的版本有类似的东西。

# sql - 是否可以 INSERT SELECT 一个聚合值的集合，然后根据您刚刚进行的插入的 @@IDENTITY 值更新另一个表？

> ID：836345
> 
> 赞同：0
> 
> 时间：2009-05-07T18:43:51.110
> 
> 标签：sql, sql-server, tsql

我将首先承认我的问题很可能是糟糕设计的结果，因为我在其他地方找不到任何关于此的信息。就是说，让我们变脏吧。

我有一个活动表和一个 ActivitySegments 表。活动表如下所示：

> 活动ID（身份）| 日期（日期时间） | 持续时间（日期时间） | 票号（数字） |

ActivitySegments 看起来像

> 段标识 (ident) | 票号（数字） | 活动ID（数字）| 开始日期 | 开始时间 | 结束日期 | 时间结束

这是内联网的时间跟踪功能。做事的“旧方式”只是使用活动表。他们希望能够通过启动/停止机制跟踪全天的各个工作部分，并将它们汇总到活动表中的记录中。用例是用户应该能够选择他们当天工作的任何/所有段，并将它们按ticketid分组并插入到活动表中。我有那个工作。我将一串对应于段标识的逗号分隔值发送到将它们放入临时表的存储过程。所以我有上面的两个表和一个带有一列相关段的临时表。难道他们都不能相处吗？

我需要的是获取这些通过的活动段 ID，按票号对它们进行分组，并对每张票的工作时间求和（我已经有了相应的 sql）。然后将此数据集插入到活动表中，但也获取新的活动 ID @@identity 并使用适当的值更新活动段表。

在程序编程中，我会循环插入，获取@@identity 并执行其他操作来确定哪些段ID 用于创建该activityid。我很确定我在想这一切都错了，但是截止日期临近，我已经盯着 SQL 管理工作室看了两天，浪费了几张纸，烧掉了太多的香烟。我在不久的将来看到了 Smarties 的 SQL，在那之前，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:15:10.753

试试这个方法：

```
declare @x table (tableID int not null primary key identity (1,1), datavalue varchar(10) null)
INSERT INTO @x values ('one')
INSERT INTO @x values ('aaaa')
INSERT INTO @x values ('cccc')

declare @y table (tableID int not null primary key               , datavalue varchar(10) null)

declare @count int ---------------FROM HERE, see comment
set @count=5;
WITH hier(cnt) AS
        (
        SELECT  1 AS cnt
        UNION ALL
        SELECT  cnt + 1
        FROM    hier
        WHERE    cnt < @count
        ) -----------------------To HERE, see comment
INSERT INTO @x
    (datavalue)
    OUTPUT INSERTED.tableID, INSERTED.datavalue
    INTO @y
SELECT
    'value='+CONVERT(varchar(5),h.cnt)
    FROM hier  h
    ORDER BY cnt DESC

select '@x',* from @x  --table you just inserted into
select '@y',* from @y  --captured data, including identity 
```

这是 SELECT 的输出

```
 tableID     datavalue
---- ----------- ----------
@x   1           one
@x   2           aaaa
@x   3           cccc
@x   4           value=5
@x   5           value=4
@x   6           value=3
@x   7           value=2
@x   8           value=1

(8 row(s) affected)

     tableID     datavalue
---- ----------- ----------
@y   4           value=5
@y   5           value=4
@y   6           value=3
@y   7           value=2
@y   8           value=1 
```

“FROM HERE” - “TO HERE” 只是创建要加入的表的一种奇特方式，您可以使用自己的表加入到那里...

使用@y 处理您的更新、更新并加入...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:55:02.703

实现（1）插入范围和（2）使用它们生成的标识值的情况可能很棘手。

一种方法是在生成 Id 的表上设置某种跟踪列。因此，例如将 TransactionGUID（唯一标识符）或其他东西添加到生成您要捕获的身份的表中。当您将行集插入此表时，您指定给定的 GUID，然后可以在插入完成后收集标识值集。

另一种常见的方法就是像你提到的那样迭代地进行。可能有更好的方法来构建您想要做的事情，但是如果您必须使用当前的方法（并且如果我正确理解您在做什么），那么添加 TransactionGUID 可能是最简单的解决方法。

# mysql - 自 MySQL 服务器启动以来的所有查询计数

> ID：836346
> 
> 赞同：1
> 
> 时间：2009-05-07T18:43:51.717
> 
> 标签：mysql

你如何知道自 MySQL 服务器启动以来已经执行了多少查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T18:48:01.177

如果您想在查询中执行此操作，而不是通过运行外部程序：

```
SHOW GLOBAL STATUS LIKE 'Questions'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T18:46:33.600

```
mysqladmin proc stat 
```

这应该为您提供问题计数（以及其他信息），即向服务器询问的查询数。

返回的信息的一个方便部分是慢查询计数。希望那是0。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T10:43:03.690

只是 mysqladmin 状态 -p

应该给你有用的信息和具体的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T18:47:25.267

在 MySQL 5.1.31 或更高版本中，您可以执行`show status`并签出名称为“查询”的行

[http://dev.mysql.com/doc/refman/5.1/en/server-status-variables.html#statvar_Queries](http://dev.mysql.com/doc/refman/5.1/en/server-status-variables.html#statvar_Queries)

如果您没有 5.1，请使用“问题”行。在 5.1 中，它不会在已保存过程中包含查询。

[http://dev.mysql.com/doc/refman/5.1/en/server-status-variables.html#statvar_Questions](http://dev.mysql.com/doc/refman/5.1/en/server-status-variables.html#statvar_Questions)

# task - MS Project Server 2007：以编程方式切换项目资源的任务警报

> ID：836348
> 
> 赞同：1
> 
> 时间：2009-05-07T18:44:39.610
> 
> 标签：task, project-server, project-server-2007, psi, project-web-access

我正在研究 SDK 文档，但是这个网站有很多眼睛和很好的答案，我想我会把这个放在那里以获得一些线索。

在 project Server 2007 中，您可以管理是否在向您分配新任务或修改现有任务时收到“任务警报”电子邮件。您可以通过个人设置下的 Web 应用程序手动或单独更改此设置。

例如，作为项目经理，我不能为整个团队切换它或从我这边管理它。因此，如果分配给任务的资源或利益相关者不希望每次更新计划时都收到电子邮件，我无法为他们处理。我必须让他们通过 Project Web Access 应用程序手动设置它。

那么，有没有人越过这座桥？如果有，你是如何通过 SDK 类或 PSI Web 服务切换任务警报的标志的？在我浏览文档之前，如果我能得到一些“看看……”那就太好了……谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T19:03:36.780

您可以在 SQL 表中更改它。这是项目服务器专家页面上的帖子。www.projectserverexperts.com/ProjectServerFAQKnowledgeBase/SetDefaultEmailSubscriptions.aspx

# redirect - 在新窗口中 302 后 IE8 停止

> ID：836350
> 
> 赞同：2
> 
> 时间：2009-05-07T18:45:12.633
> 
> 标签：redirect, internet-explorer-8, http-status-code-302

我客户的网站在新窗口中打开外部链接（target="_blank"）。这些链接还通过一个记录器路由，该记录器以 302 重定向响应到所需的页面。

例如，而不是

```
<a href="http://stackoverflow.com">...</a> 
```

我们有

```
<a href="/redirect?to=http://stackoverflow.com" target="_blank">...</a> 
```

Where`/redirect?to=$url`将 HTTP 302 返回到`$url`.

这适用于除 IE8 之外的所有浏览器。IE8 没有打开一个带有所需 URL 的新窗口，而是打开一个新窗口，并在进度条和空地址栏的情况下停止。如果我然后点击停止并重新加载，则会加载所需的 URL。

有没有人遇到过这个问题？是否有已知的解决方案可以保留我的客户所需的行为？也就是说，使用基于重定向的日志记录在新窗口中打开链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-18T16:14:12.240

在 Fiddler2 等网络流量调试器中观察您的流量，以了解网络上发生了什么。然后，您可以将 HTTP 响应的确切原始文本添加到您的问题中，以帮助复制您的结果。

此外，这种重定向是否跨越 IE 安全区域（例如 Internet、Intranet 等）？特别是，如果重定向从受保护模式区域跨越 (Vista+) 到非保护模式区域总是很有趣，因为这会通过 IE 中相当模糊的代码路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T13:38:50.350

我知道这只是一种解决方法，但是...如果浏览器是 IE8，请使用 JS 重定向？

# ruby-on-rails - 如何整合 Paperclip 和 Mimetype-fu

> ID：836351
> 
> 赞同：0
> 
> 时间：2009-05-07T18:45:19.187
> 
> 标签：ruby-on-rails, paperclip

首先，有一点背景，因为有很多交互正在进行：我通过 Fetcher 抓取电子邮件，并使用 MMS2R 处理它们以提取附件。这些附件通常是 PDF 文件或 MS Word 文档，因此您希望它们分别`content-type`是`application/pdf`和`application/msword`，但不幸的是，许多邮件程序似乎不这样做。

相反，附件是`application/x-pdf`和`application/x-doc`。我需要正确设置这些，以便 scribd-fu 正确地 iPaper 文档。现在，mimetype-fu 将设法找出正确的内容类型，但对于我的生活，我只能弄清楚如何正确设置回形针附件的内容类型。

这是代码片段：

```
mms.process do |media_type, files|
  # go through each file
  files.each do |filename|
    # if it's a format we support, create a record
    if media_type =~ /pdf/  # just pdfs for now, to reduce confusion
      File.open(filename) do |tempfile| 
        # Somewhere in here I'd like to change filename.content_type
        # to the proper type using mimetype-fu
        # except doing tempfile.content_type = whatever doesn't seem to work.

        thing = Thing.new
        thing.document = tempfile
        thing.save!
      end
    end
  end
end 
```

任何帮助将不胜感激，因为我一直在用头撞墙，尝试各种方式来尝试使其正常工作。我已经尝试过这些链接，要么没有成功，要么没有弄清楚需要做什么：

*   [http://gist.github.com/55009/](http://gist.github.com/55009/)
*   [http://railsforum.com/viewtopic.php?id=27448](http://railsforum.com/viewtopic.php?id=27448)
*   [http://github.com/dbackeus/paperclip/commit/a514bd03664fc6a764787f59c3169397336702b1](http://github.com/dbackeus/paperclip/commit/a514bd03664fc6a764787f59c3169397336702b1)

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T02:22:31.023

你能做到吗

```
thing.document_content_type = whatever 
```

或者你是在 document= 中做你的 scribd-fu 吗？

# asp.net-mvc - MVC Routing - 使用路由部分切换视图

> ID：836362
> 
> 赞同：1
> 
> 时间：2009-05-07T18:48:22.550
> 
> 标签：asp.net-mvc, routing, routes, asp.net-mvc-routing

我有一系列看起来像的 URL

```
/Catalog/Ajax/Update/{ViewToUpdate}?var1=a&var2=b&var3=c 
```

目前我已经设置了几条路线 - 每个 {ViewToUpdate} 一条，我想做的是将 {ViewToUpdate} 传递给我的 Action 处理程序，以便我可以压缩我的代码。代替：

```
public ActionResult AjaxUpdateNavigation(string var1, string var2, string var3) {} 
```

我想要：

```
public ActionResult AjaxUpdateNavigation(string ViewToUpdate, string var1, string var2, string var3) {} 
```

以下是我目前的路线：

```
routes.MapRoute(
"CatalogAjaxNavigation",
"Catalog/Ajax/Update/Navigation",
new { controller = "Catalog", action = "AjaxUpdateNavigation" }
); 
```

如何正确设置路由定义以处理 {ViewToUpdate} 字符串以及仍然传递查询字符串？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T19:05:00.467

这是我的路线：

```
 routes.MapRoute("TestThing", "test/{ViewToUpdate}", new {controller = "Home", action = "TestQSParams"}); 
```

这是我的行动：

```
 public ActionResult TestQSParams(string ViewToUpdate, string var1, string var2)
  {
      TestQSParamsModel m = new TestQSParamsModel {var1 = var1, var2 = var2, ViewToUpdate = ViewToUpdate};
      return View("TestQSParams", m);
  } 
```

这是我的模型：

```
public class TestQSParamsModel
  {
      public string ViewToUpdate { get; set; }
      public string var1 { get; set; }
      public string var2 { get; set; }
  } 
```

这是我的看法：

```
From QS:<br />
  <% foreach(string s in Request.QueryString) 
         Response.Write(string.Format("{0}={1}<br />", s, Request.QueryString[s])); %>
  <br />
  <br />
  From Model:<br />
  <asp:Literal ID="modelvars" runat="server"></asp:Literal> 
```

视图代码隐藏：

```
 protected void Page_Load(object sender, EventArgs e)
  {
      modelvars.Text = string.Format("{0}<br />{1}<br />{2}", Model.var1, Model.var2, Model.ViewToUpdate);
  } 
```

我的网址：

```
/test/ThisView?var0=douglas&var1=patrick&var2=caldwell 
```

最后，我的结果：

```
 From QS:   
  var0=douglas   
  var1=patrick   
  var2=caldwell

  From Model:
  patrick
  caldwell
  ThisView 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T11:45:44.910

```
routes.MapRoute(
"CatalogAjaxNavigation",
"Catalog/Ajax/Update/{ViewToUpdate}",
new { controller = "Catalog", action = "AjaxUpdateNavigation" , ViewToUpdate = (string)null }
);

public ActionResult AjaxUpdateNavigation(string ViewToUpdate, string var1, string var2, string var3) {} 
```

# iphone - 将 UIImageView 添加到 NSMutableDictionary

> ID：836367
> 
> 赞同：0
> 
> 时间：2009-05-07T18:49:39.923
> 
> 标签：iphone, uiimageview, nsdictionary

我正在尝试将 UIImageView(s) 的多个实例添加到 NSMutableDictionar(ies) 的 NSMutableArray 中。

我这样做是为了能够返回并拉出 UIImageView 参考，以更改这些图像的位置。

似乎，当我从字典中提取信息时，它只返回一个空指针......

关于我应该如何实现这一点的任何建议？可能有一种更简单的方法来存储 n 个图像的列表并能够在以后引用它们......

```
// (for i = 0 to 30)

UIImageView *newBall = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"ball.png"]];
newBall.center = CGPointMake (arc4random() % 280 + 20, arc4random() % 440 + 20);
[self.view addSubview:newBall];

NSMutableDictionary *dictBall = [[[NSMutableDictionary alloc] init] autorelease];
[dictBall setValue:newBall forKey:@"imgBall"];

// the dictionary is then added to the array

[newBall release];

// end for loop 
```

（我正在使用字典，因为我还存储了一个 dy/dx 值来表示运动变化率）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:05:34.413

上面的代码对我来说看起来不太好。

您每次通过循环创建一个新的 NSMutableDictionary *dictBall 。循环存在后是否有东西保留它？从你的代码看起来不像。这可能就是您的对象为零的原因。

将这条线移到 for 循环之外/之前，你应该没问题。

另外，您确定要将 UIViewImage 存储在字典中吗？为什么不只是一个 ID（基于标签）和坐标（CGPoint 或 CGRect）？这样，您可以使用标签通过标签找到 UIimageView 并将其移动到您想要的任何位置？更便宜的内存明智。

# winapi - 是否有 64 位版本的 Microsoft 公共控件 (MSCOMCTL.OCX)？

> ID：836368
> 
> 赞同：6
> 
> 时间：2009-05-07T18:49:50.470
> 
> 标签：winapi, 64-bit, activex

微软移植`MSCOMCTL.OCX`到 64 位了吗？

我没有安装它，我找不到它可以下载，也找不到任何说它不存在的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:21:12.173

这是一个 VB6 控件。VB6 在 64 位 Windows 上并不真正支持，事实上微软早在 2005 年就放弃了对它的所有支持，但它可能仍然有效。这是下载[链接](http://download.microsoft.com/download/vb60pro/install/6/win98me/en-us/vbrun60.exe)。有些人在安装它方面取得了一些成功。它需要进入 windows/syswow64 文件夹。祝你好运。

顺便说一句，它是一个 32 位控件，因此您将无法将其用于 64 位应用程序。

更新：

糟糕，给了错误的链接。那是 vb6 运行时。以下是常用[控件](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=25437d98-51d0-41c1-bb14-64662f5f62fe)。您必须手动提取和注册它们。使用任何 cab 文件提取器。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2009-05-07T19:37:55.473

OCX is COM bassed. But COM don't have 64-bit implementation.

# domain-driven-design - 什么属于聚合根

> ID：836379
> 
> 赞同：34
> 
> 时间：2009-05-07T18:52:00.607
> 
> 标签：domain-driven-design, aggregate, root, entities

这是一个实用的领域驱动设计问题：

从概念上讲，我认为我得到聚合根，直到我去定义一个。

我有一个 Employee 实体，它以聚合根的形式出现。在企业中，*一些*员工可能会记录与工作相关的违规行为：

员工-----*违规行为

由于并非所有员工都受此约束，我认为违规不会成为员工汇总的一部分，对吗？

因此，当我想与员工及其相关违规行为一起工作时，这是否是某些服务的两个单独的存储库交互？

最后，当我添加违规时，该方法是否适用于员工实体？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-08T00:01:45.073

在做了更多的研究之后，我想我已经找到了我的问题的答案。

Paul Stovell 对[DDD 留言板上](http://tech.groups.yahoo.com/group/domaindrivendesign/message/9836)的一个类似问题进行了略微编辑的回复。用“客户”代替“员工”，用“订单”代替“违规”，你就明白了。

> 仅仅因为客户引用订单并不一定意味着订单属于客户聚合根。客户的地址可能，但订单可以是独立的（例如，您可能有一个服务来处理所有新订单，无论客户是谁。在这种情况下，必须去 Customer->Orders 是没有意义的）。
> 
> 从领域的角度来看，您甚至可以质疑这些引用的有效性（客户引用了订单列表）。您实际上多久需要一次客户的*所有*订单？在某些系统中这是有意义的，但在其他系统中，一个客户可能会下很多订单。您可能需要某个日期范围内的客户订单，或尚未处理的客户订单，或尚未付款的订单，等等。您需要所有这些的情况可能相对不常见。但是，在处理订单时，您更有可能需要客户信息。所以在代码中，`Order.Customer.Name`是有用的，但`Customer.Orders[0].LineItem.SKU`- 可能不是那么有用。当然，这完全取决于您的业务领域。

换句话说，更新客户与更新订单无关。可以想象，在我的情况下，订单或违规行为可以独立于客户/员工来处理。

如果 Violations 具有详细信息行，则 Violation 和 Violation line 将成为同一聚合的一部分，因为更改违规行可能会影响 Violation。

编辑** 我的域中的皱纹是违规行为没有任何行为。它们基本上是发生的事件的记录。尚不确定其影响。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2010-04-01T06:59:22.950

Eric Evan 在他的书中指出，[领域驱动设计：解决软件核心的复杂性](http://domaindrivendesign.org/books/evans_2003)，

> AGGREGATE 是一组关联对象，我们将其视为一个单元**，用于数据更改**。

这里有两个重要的点：

1.  这些对象应该被视为一个“单元”。
2.  以“数据变更”为目的。

我相信在您的场景中，Employee 和 Violation 不一定是一个单元，而在 Order 和 OrderItem 的示例中，它们是一个单元的一部分。

对聚合边界建模时另一件重要的事情是聚合中是否有任何不变量。不变量是应该在“整个”聚合中有效的业务规则。例如，对于 Order 和 OrderItem 示例，您可能有一个不变量，指出订单的总成本应小于预定义的金额。在这种情况下，无论何时您想将 OrderItem 添加到 Order 中，都应强制执行此不变量以确保您的 Order 有效。但是，在您的问题中，我没有看到您的实体之间有任何不变量：员工和违规。

这么简短的回答：

我相信 Employee 和 Violation 分别属于 2 个单独的集合。这些实体中的每一个也是它们自己的聚合根。所以你需要 2 个存储库：EmployeeRepository 和 ViolationRepository。

我也相信你应该有一个从 Violation 到 Employee 的单向关联。这样，每个 Violation 对象都知道它属于谁。但是，如果您想获取特定员工的所有违规列表，则可以询问 ViolationRepository：

```
var list = repository.FindAllViolationsByEmployee(someEmployee); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-08T09:53:50.083

您说您有员工实体和违规行为，并且每个违规行为本身都没有任何行为。从我上面可以读到的内容，在我看来，您可能有两个聚合根：

*   员工
*   EmployeeViolations（称之为 EmployeeViolationCard 或 EmployeeViolationRecords）

EmployeeViolations 由相同的员工 ID 标识，它包含一系列违规对象。您可以通过这种方式将员工行为和违规行为分开，并且您不会在没有行为的情况下获得违规实体。

违规是实体还是值对象，您应该根据其属性来决定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-25T01:17:52.063

在这一点上，我大体上同意莫什的观点。但是，请记住从业务角度来看交易的概念。所以我实际上把“为了数据更改的目的”理解为“为了交易的目的”。

存储库是域模型的视图。在域环境中，这些“视图”真正支持或表示业务功能或能力——事务。举个例子，员工可能有一个或多个违规行为，如果是这样，是某个时间点交易的各个方面。考虑您的用例。

情景：“一名员工的行为违反了工作场所。” 这是发生的一种业务事件（即事务，或更大的、可能是分布式事务的一部分）。实际上可以从多个角度看到根受影响的域对象，这就是它令人困惑的原因。但要记住的是与业务交易相关的行为，因为您希望您的业务流程尽可能准确地对现实世界进行建模。就关系而言，就像在关系数据库中一样，您的概念域模型实际上应该已经表明了这一点（即关联性），通常可以从任一方向读取：

员工 <----commits a --------committed by ----> Violation

因此，对于这个用例，可以公平地说它是一个处理违规的事务，并且根（或“主要”实体）是一个违规。那将是您为特定业务活动或业务流程引用的聚合根。但这并不是说，对于不同的活动或流程，您不能拥有 Employee 聚合根，例如“新员工流程”。如果你小心，循环引用应该没有负面影响，或者能够以多种方式遍历你的域模型。但是，我会警告说，应该由您的业务域的控制器部分或您拥有的任何等效部分来考虑和处理对此的管理。

另外：从模式（即MVC）的角度考虑，存储库是一个视图，域对象是模型，因此还应该采用某种形式的控制器模式。通常，控制器声明存储库（聚合根的集合）的具体实现和访问。

在数据访问世界...

以 LINQ-To-SQL 为例，DataContext 将是公开 Customer 和 Order 实体视图的控制器。视图是一种非声明性的、面向框架的表类型（大致相当于存储库）。请注意，视图保留对其父控制器的引用，并且经常通过控制器来控制视图如何/何时实现。因此，控制器是您的提供者，负责映射、翻译、对象水合等。模型是您的数据 POCO。几乎是典型的 MVC 模式。

以 N/Hibernate 为例，ISession 将是通过 session.Enumerable(string query) 或 session.Get(object id) 或 session.CreateCriteria(typeof(Customer) 公开客户和订单实体视图的控制器）。列表（）

在业务逻辑世界...

```
Customer { /*...*/ }

Employee { /*...*/ }

Repository<T> : IRepository<T>
              , IEnumerable<T>
              //, IQueryable<T>, IQueryProvider //optional

{ /**/ }

BusinessController {
 Repository<Customer>  Customers { get{ /*...*/ }} //aggregate root
 Repository<Order> Orders { get{ /*...*/ }} // aggregate root
} 
```

简而言之，让您的业务流程和事务成为指南，让您的业务基础架构随着流程/活动的实施或重构而自然发展。此外，与传统的黑盒设计相比，更喜欢可组合性。当您使用面向服务或云计算时，您会很高兴自己做到了。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-15T13:47:02.210

我想知道结论会是什么？

“违规”成为一个根本实体。并且“违规”将由“员工”根实体引用。即违规存储库<->员工存储库

但是您对将违规作为根实体感到困惑，因为它没有任何行为。

但是，“行为”是作为根实体的标准吗？我不这么认为。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T10:26:31.593

在这里测试理解的略微正交的问题，回到 Order...OrderItem 示例，系统中可能有一个分析模块想要直接查看 OrderItems，即获取特定产品的所有 orderItems，或所有订单项目大于一些给定的值等，是否有很多这样的用例并将“聚合根”推向极端，我们可以说 OrderItem 本身就是一个不同的聚合根吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-21T08:46:10.900

这取决于。违规的任何更改/添加/删除是否会更改员工的任何部分 - 例如，您是否存储违规计数或过去 3 年内针对员工的违规计数？

# xml - 如何从 XPath 语句中找到字符串位置（索引）？

> ID：836382
> 
> 赞同：0
> 
> 时间：2009-05-07T18:52:36.610
> 
> 标签：xml, vb.net

[这个问题](https://stackoverflow.com/questions/226405/find-position-of-a-node-using-xpath)很接近，但它正在寻找序数位置。我正在寻找给定源字符串中的实际索引位置。

更好的解释：

我有以下字符串

```
"<a>
    <b>zyx</b>
    <b>wvu</b>
    <b>tsr</b>
    <b>qpo</b>
</a>" 
```

我正在将该**字符串**加载到 .NET XmlDocument 对象中。回车和线路费可能是这里的一个因素。

```
Dim xmlSearchText As New XmlDocument()
xmlSearchText.LoadXml(SearchTextBox.Text)

Dim selectedNode As XmlNode = xmlSearchText.SelectSingleNode(txtSearch.Text) 
```

以下 XPath 语句可用于查找第三个节点：

```
a/b[.='tsr'] 
```

但是，我需要它返回 23 的字符串索引，而不是 3 的序数位置。

可能的？不可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T19:19:10.010

这会给你想要的吗？

```
selectedNodenode = xmlSearchText.SelectSingleNode("a/b[.='tsr']");
selectedNode.ParentNode.OuterXml.IndexOf(selectedNode.OuterXml) 
```

不会给你来自根的索引，但它会给你来自父节点的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T20:30:43.957

使用 XPathDocument 代替 XmlDocument 可以让您访问带有行号和列位置的 IXmlLineInfo 接口。

```
XPathDocument document = new XPathDocument("file.xml");
XPathNavigator navigator = document.CreateNavigator();
XPathNavigator node = navigator.Select("a/b[.='tsr']");
IXmlLineInfo info = ((IXmlLineInfo)node);
Console.WriteLine("Found at ({0},{1})",info.LineNumber,info.LinePosition); 
```

如果您确实需要字符串中的字符索引，您可以通过计算字符串中的换行符并添加列来推断它。

# database-design - 如何在 RDBMS 中表示对象分类层次结构

> ID：836383
> 
> 赞同：1
> 
> 时间：2009-05-07T18:52:56.703
> 
> 标签：database-design, relational

我的数据，**如果**它由对象表示，它看起来像：

```
abstract class A{
   int a;
   int b;
   string c;
}

class B inherits A{
  string D;
}

class C inherits A{
  int e;
  int f;
} 
```

我的问题：我是为实体 B 和 C 创建一个单独的表，还是创建一个主表，并为每种实体类型执行不同的连接以获取数据。
在现实世界中，我将为所有实体拥有大约 15 个相似字段，每个实体大约有 1-3 个唯一字段。
我预计最多 100K 记录。

有什么见解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T18:59:18.840

你会发现关于这个话题的意见不乏。许多人提倡[具体的表继承](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)，其中（正如您在第一个选项中描述的那样）您在每个表中明确定义数据。

鉴于您的第二个陈述，我**不**推荐这种模式。我会考虑让“主”表代表您的父母和代表孩子的辅助表。您可能希望在主表中包含某种类型的标识符，以指示它是哪种类型的实体，但这可能是必要的，也可能不是必需的。至少，您需要类似...

```
tableA
(
    ID (primary),
    A,
    B,
    C
)

tableB
(
    ID (primary and foreign->table_A),
    D
)

tableC
(
    ID (primary and foreign->table_A),
    E,
    F
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T18:57:33.383

table_a 包含所有相似字段，table_B 和 table_c 包含唯一字段

```
table_A
   PKa
   a int
   b int
   c string

table_B
  PKb
  FKa
  D string

table_C
  PKc
  FKa
  e int
  f int 
```

# log4net - Log4net - 在 AdoNetAppender 和 RollingFileAppender 之间动态切换 appender

> ID：836385
> 
> 赞同：7
> 
> 时间：2009-05-07T18:53:14.143
> 
> 标签：log4net

我在我的 asp.net 应用程序中使用 AdoNetAppender（SQL 服务器），并希望在遇到 SQL 连接问题时使用 RollingFileAppender。有没有办法配置为仅在 AdoNetAppender 出现问题时才使用 RollingFileAppender？

谢谢

波尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T07:22:11.037

log4net 中没有对这种故障转移方案的内置支持，问题是在 log4net 架构中 appender 彼此完全隔离。

一个常见的设置是让两个 appender 并行记录，只是文件 appender 只保留，比如说，一周的数据。如果 AdoNetAppender 失败，您将始终拥有文件中的最新数据。

但是我在这里明确地看到了一个附加程序的情况，它可以有一个优先级列表的子附加程序，在失败的情况下进行一些简单的故障转移。这不应该太难[在 AppenderSkeleton](http://logging.apache.org/log4net/release/sdk/log4net.Appender.AppenderSkeleton.html)上实现任何一个构建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-02-14T23:08:50.890

[我已经实现了这样一个附加程序，并在此处](https://moaid.codes/post/writing-failover-appender-for-log4net/)和[此处](https://blog.oz-code.com/disaster-strikes-complete-guide-failover-appenders-log4net/)（镜像）发布了有关它的博客。代码可以在[这里](https://github.com/MoaidHathot/FailOverAppender)找到。

我扩展了[AppenderSkeleton](http://logging.apache.org/log4net/release/sdk/html/T_log4net_Appender_AppenderSkeleton.htm)并创建了一个名为[FailoverAppender](https://github.com/MoaidHathot/FailOverAppender/blob/master/FailOverAppender/MoreAppendersApp/FailoverAppender.cs)的新 Appender ，它有两个 AppenderSkeleton 类型的成员。

*   一个名为“PrimaryAppender”的默认附加程序 - 默认使用，直到它失败。
*   一个名为“FailoverAppender”的故障转移附加程序 - 仅在主服务器发生故障后使用。

PrimaryAppender 和 FailoverAppender 的实际类型是使用 log4net 的 xml 配置语法配置的（参见下面的示例）。

一个片段：

```
public class FailoverAppender : AppenderSkeleton
{
    private AppenderSkeleton _primaryAppender;
    private AppenderSkeleton _failOverAppender;
     ....
} 
```

在 Append 方法的实现中，我默认只将 LoggingEvents 发送[到](https://logging.apache.org/log4net/log4net-1.2.13/release/sdk/log4net.Core.LoggingEvent.html)PrimaryAppender 并用 try-catch 包围它。如果 PrimaryAppender 抛出（失败），我会发出一个标志并将 LoggingEvent 发送到 FailoverAppender。下一个 LoggingEvents 将直接且仅发送到 FailoverAppender。

```
protected override void Append(LoggingEvent loggingEvent)
{
    if (LogToFailOverAppender)
    {
        _failOverAppender?.DoAppend(loggingEvent);
    }
    else
    {
        try
        {
            _primaryAppender?.DoAppend(loggingEvent);
        }
        catch
        {
            ActivateFailOverMode();
            Append(loggingEvent);
        }
    }
} 
```

此外，我创建了一个自定义[ErrorHandler](https://logging.apache.org/log4net/log4net-1.2.11/release/sdk/log4net.Core.IErrorHandler.html)，它将传播内部附加程序异常以指示附加程序在内部发生故障，这将使 LoggingEvents 仅发送到 FailoverAppender。

```
class FailOverErrorHandler : IErrorHandler
{
    public FailOverAppender FailOverAppender { get; set; }

    public FailOverErrorHandler(FailOverAppender failOverAppender)
    {
        FailOverAppender = failOverAppender;
    }

    public void Error(string message, Exception e, ErrorCode errorCode)
        => FailOverAppender.ActivateFailOverMode();

    public void Error(string message, Exception e)
        => FailOverAppender.ActivateFailOverMode();

    public void Error(string message)
        => FailOverAppender.ActivateFailOverMode();
} 
```

配置示例：

```
<!--This custom appender handles failovers. If the first appender fails, it'll delegate the message to the back appender-->
<appender name="FailoverAppender" type="MoreAppenders.FailoverAppender">
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger - %message%newline"/>
    </layout>

    <!--This is a custom test appender that will always throw an exception -->
    <!--The first and the default appender that will be used.-->
    <PrimaryAppender type="MoreAppenders.ExceptionThrowerAppender" >
        <ThrowExceptionForCount value="1" />
        <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%date [%thread] %-5level %logger - %message%newline"/>
        </layout>        
    </PrimaryAppender>

    <!--This appender will be used only if the PrimaryAppender has failed-->
    <FailOverAppender type="log4net.Appender.RollingFileAppender">
        <file value="log.txt"/>
        <rollingStyle value="Size"/>
        <maxSizeRollBackups value="10"/>
        <maximumFileSize value="100mb"/>
        <appendToFile value="true"/>
        <staticLogFileName value="true"/>
        <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%date [%thread] %-5level %logger - %message%newline"/>
        </layout>
    </FailOverAppender>
</appender> 
```

# python - 如何判断 python 变量是字符串还是列表？

> ID：836387
> 
> 赞同：61
> 
> 时间：2009-05-07T18:53:26.657
> 
> 标签：python, list, duck-typing

我有一个将字符串列表作为参数的例程，但我想支持传入单个字符串并将其转换为一个字符串列表。例如：

```
def func( files ):
    for f in files:
        doSomethingWithFile( f )

func( ['file1','file2','file3'] )

func( 'file1' ) # should be treated like ['file1'] 
```

我的函数如何判断传入的是字符串还是列表？我知道有一个`type`功能，但有没有“更pythonic”的方式？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-07T18:57:40.530

```
isinstance(your_var, basestring) 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-07T18:58:29.903

好吧，检查类型没有什么不合时宜的。话虽如此，如果您愿意给调用者增加一点负担：

```
def func( *files ):
    for f in files:
         doSomethingWithFile( f )

func( *['file1','file2','file3'] ) #Is treated like func('file1','file2','file3')
func( 'file1' ) 
```

我认为这更像是pythonic，因为“显式优于隐式”。当输入已经是列表形式时，调用者至少可以识别。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-05-07T18:58:58.810

就个人而言，我不太喜欢这种行为——它会干扰鸭子打字。有人可能会争辩说，它不遵守“显式胜于隐式”的口头禅。为什么不使用可变参数语法：

```
def func( *files ):
    for f in files:
        doSomethingWithFile( f )

func( 'file1', 'file2', 'file3' )
func( 'file1' )
func( *listOfFiles ) 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-05-07T19:24:29.747

我会说最 Python 的方式是让用户总是传递一个列表，即使它只有一个项目。这很明显`func()`可以获取文件列表

```
def func(files):
    for cur_file in files:
        blah(cur_file)

func(['file1']) 
```

正如 Dave 所建议的，您可以使用该`func(*files)`语法，但我从不喜欢这个功能，而且它似乎更明确（“显式优于隐式”）只需要一个列表。它还将您的特殊情况（`func`使用单个文件调用）转换为默认情况，因为现在您必须使用额外的语法来`func`使用列表调用..

如果您确实想为作为字符串的参数创建特殊情况，请使用[`isinstance()`内置](http://docs.python.org/library/functions.html#isinstance)函数，并与`basestring`（两者都派生自）进行比较，例如：`str()``unicode()`

```
def func(files):
    if isinstance(files, basestring):
        doSomethingWithASingleFile(files)
    else:
        for f in files:
            doSomethingWithFile(f) 
```

真的，我建议只需要一个列表，即使只有一个文件（毕竟，它只需要两个额外的字符！）

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-07T23:42:28.300

```
if hasattr(f, 'lower'): print "I'm string like" 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-05-08T02:25:58.503

```
def func(files):
    for f in files if not isinstance(files, basestring) else [files]:
        doSomethingWithFile(f)

func(['file1', 'file2', 'file3'])

func('file1') 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-06-19T17:46:39.093

如果您对呼叫者有更多控制权，那么其他答案之一会更好。在我的情况下，我没有那么奢侈，所以我选择了以下解决方案（带有警告）：

```
def islistlike(v):
   """Return True if v is a non-string sequence and is iterable. Note that
   not all objects with getitem() have the iterable attribute"""
   if hasattr(v, '__iter__') and not isinstance(v, basestring):
       return True
   else:
       #This will happen for most atomic types like numbers and strings
       return False 
```

这种方法适用于您正在处理一组已知的满足上述标准的类似列表的类型的情况。不过，一些序列类型会被遗漏。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-08T01:24:14.203

Varargs 让我感到困惑，所以我在 Python 中对其进行了测试，以便自己解决。

首先，可变参数的 PEP 在[这里](http://www.python.org/dev/peps/pep-3102/)。

这是示例程序，基于 Dave 和 David Berger 的两个答案，然后是输出，只是为了澄清。

```
def func( *files ):
    print files
    for f in files:
        print( f )

if __name__ == '__main__':
    func( *['file1','file2','file3'] ) #Is treated like func('file1','file2','file3')
    func( 'onestring' )
    func( 'thing1','thing2','thing3' )
    func( ['stuff1','stuff2','stuff3'] ) 
```

以及由此产生的输出；

```
('file1', 'file2', 'file3')
file1
file2
file3
('onestring',)
onestring
('thing1', 'thing2', 'thing3')
thing1
thing2
thing3
(['stuff1', 'stuff2', 'stuff3'],)
['stuff1', 'stuff2', 'stuff3'] 
```

希望这对其他人有帮助。

# nhibernate - 我应该如何在 nhibernate 中查询持久对象的属性的子属性？

> ID：836388
> 
> 赞同：1
> 
> 时间：2009-05-07T18:53:38.293
> 
> 标签：nhibernate, properties, criteria, icriteria

我感觉很笨。

```
public class Uber
{
   public Foo Foo { get; set; }
   public Bar Bar { get; set; }
}

public class Foo
{
   public string Name { get; set; }
}

...

var ubercharged = session.CreateCriteria(typeof(Uber))
.Add(Expression.Eq("Foo.Name", "somename"))
.UniqueResult<Uber>();
return ubercharged; 
```

这会引发“无法解析属性”错误。

我究竟做错了什么？我想查询一个 Uber 对象，该对象的属性 Foo 的名称为“somename”。

使用流利的 nhibernate 更新了现实生活中的示例，存储库调用：

```
 public UserPersonalization GetUserPersonalization(string username)
    {
        ISession session = _sessionSource.GetSession();

        var personuser = session.CreateCriteria(typeof(UserPersonalization))
            .Add(Expression.Eq("User.Username", username))
            .UniqueResult<UserPersonalization>();
        return personuser;

    } 
```

类/映射：

```
public class User
{
    public virtual Guid UserId { get; set; }
    public virtual string Username { get; set; }
    public virtual string Email { get; set; }
    public virtual string PasswordHash { get; set; }
    public virtual string PasswordSalt { get; set; }
    public virtual bool IsLockedOut { get; set; }
    public virtual bool IsApproved { get; set; }

}

public class Person
{
    public virtual int PersonId { get; set; }
    public virtual string Name { get; set; }
    public virtual Company Company { get; set; }

}

public class UserPersonalization
{
    public virtual int UserPersonalizationId { get; set; }
    public virtual Person Person { get; set; }
    public virtual User User { get; set; }
}

public class UserMap : ClassMap<User>
{
    public UserMap()
    {
        Id(x => x.UserId).GeneratedBy.Guid().ColumnName("UserId");
        Map(x => x.Username);
        Map(x => x.PasswordHash);
        Map(x => x.PasswordSalt);
        Map(x => x.Email);
        Map(x => x.IsApproved);
        Map(x => x.IsLockedOut);
    }
}

public class UserPersonalizationMap : ClassMap<UserPersonalization>
{
    public UserPersonalizationMap()
    {
        WithTable("UserPersonalization");
        Id(x => x.UserPersonalizationId).ColumnName("UserPersonalizationId");
        References(x => x.Person).ColumnName("PersonId");
        References(x => x.User).ColumnName("UserId");
    }
}

public class PersonMap : ClassMap<Person>
{
    public PersonMap()
    {
        Id(x => x.PersonId).ColumnName("PersonId");
        Map(x => x.Name);
        References(x => x.Company).ColumnName("CompanyId");
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T19:30:35.897

尝试这个：

```
var ubercharged = session.CreateCriteria(typeof(Uber))
        .CreateCriteria("Foo")
            .Add(Restrictions.Eq("Name", "somename"))
            .UniqueResult<Uber>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:35:46.273

Can you sort using "ubercharged.AddOrder(Order.asc("Foo.Name")) syntax? This syntax should work in NHib 2.01\. If not, your maps are not working correctly.

Stuart's answer should work fine for you though.

# asp.net-mvc - 如何在 asp.net mvc 中使用表单身份验证？

> ID：836391
> 
> 赞同：1
> 
> 时间：2009-05-07T18:55:13.780
> 
> 标签：asp.net-mvc

我想在 asp.net mvc 应用程序中使用表单身份验证。我已经搜索了这个东西，但无法得到满意的答案，所以任何人都可以给我一个简短的想法。我是一个新手，正在玩asp.net mvc。

还请描述使用 asp.net mvc 可以进行多少次身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T19:03:56.117

见[官方 MVC 教程](http://www.asp.net/learn/mvc/tutorial-17-cs.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:58:03.570

你看过这个[帖子](http://weblogs.asp.net/fredriknormen/archive/2008/02/07/asp-net-mvc-framework-using-forms-authentication.aspx)吗。

# php - PHP MySQL 编码错误？

> ID：836397
> 
> 赞同：2
> 
> 时间：2009-05-07T18:56:10.457
> 
> 标签：php, mysql, encoding, utf-8

这是我的问题。我有一个名为引号的 mysql 表。在其中一行中，引号包含以下字符

```
‘ and ’ 
```

现在行排序规则是**utf8__unicode__ci**

当使用 MySQL Query Browser 和 PHPMyAdmin 检索行时，引号会按预期出现。当我使用 PHP 从数据库中检索它们并将它们显示在屏幕上时，它们会以框的形式出现

```
� and � 
```

我的 html 页面有 UTF-8 编码，所有的 UTF-8 编码选项都在 php 中设置：

```
/* Set UTF-8 settings */
mb_internal_encoding('UTF-8');
mb_regex_encoding('UTF-8');
mb_http_output('UTF-8');

/* Set ICONV ini settings */
ini_set('iconv.input_encoding', 'UTF-8');
ini_set('iconv.output_encoding', 'UTF-8');
ini_set('iconv.internal_encoding', 'UTF-8');

/* Set ICONV function settings */
iconv_set_encoding('input_encoding', 'UTF-8');
iconv_set_encoding('output_encoding', 'UTF-8');
iconv_set_encoding('internal_encoding', 'UTF-8'); 
```

在我看来，它应该工作。但它没有：S 任何人都可以对此有所了解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T19:00:38.027

您可能需要在 MySQL 连接上将 UTF-8 设置为所选字符集。如果您使用的是 mysqli PHP 驱动程序，这意味着如下：

```
$mysqli = new mysqli("localhost", "my_user", "my_password", "test");
$mysqli->set_charset("utf8"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T19:08:43.047

@Joakim，非常感谢您让我朝着正确的方向前进。我无法使用您的确切代码，因为我使用的是自定义数据库驱动程序，并且它使用旧的 mysql 命令而不是 mysqli 类工作。我尝试使用 mysql_set_charset() 但我的 php 版本不支持它（仍然是 php 5 tho）。

这是我使用的解决方案：

```
mysql_query("SET CHARACTER SET utf8", $this->connection);
mysql_query("SET NAMES utf8", $this->connection); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T18:59:09.573

您的整理对您没有帮助；它只是确定排序顺序。您需要将默认字符集设置为 utf-8，如下所示：

```
CREATE TABLE `foo` (
    `id` int not null auto_increment,
    `name` varchar(50)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 
```

您应该能够通过以下方式解决此问题：

```
ALTER TABLE `foo` DEFAULT CHARSET=utf8 
```

唯一的问题是，如果索引采用 utf-8 格式，有时您的索引会太长。

# c# - 充当服务器时，SslStream 是否使用 LocalCertificateSelectionCallback？

> ID：836398
> 
> 赞同：1
> 
> 时间：2009-05-07T18:56:49.877
> 
> 标签：c#, ssl, sslstream

如果我像这样创建一个 SslStream 实例：

```
secureStream = new SslStream(stream, true, tlsRemoteCallback, tlsLocalCallback); 
```

然后我使用 AuthenticateAsServer 或 BeginAuthenticateAsServer 方法之一，是否可以调用 LocalCertificateSelectionCallback (tlsLocalCallback)？如果是这样，怎么办？

我的印象是这是不可能的，因为 AuthenticateAsServer 方法需要一个 X509Certificate 参数。如果你传递 null，那么它会引发异常。但我想确定一下，因为我正在尝试编写一个套接字 API 供我团队中的其他开发人员使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T19:10:31.690

您是否尝试让 secureStream 选择它用来向客户端验证自己的证书？

我不认为这是可能的。做一些反射，我看到委托最终转到 System.Net.Security.SecureChannel 中的“m_CertSelectionDelegate”。对该变量的快速分析似乎表明它仅用于验证服务器证书或验证客户端为相互验证自身而提供的证书。

# php - 移动谷歌地图标记时触发php函数请求

> ID：836404
> 
> 赞同：0
> 
> 时间：2009-05-07T18:57:48.063
> 
> 标签：php, javascript, ajax, api, maps

放置标记后，我想调用一个以纬度和经度为输入的 php 函数（在另一个文件中），并将结果输出到页面上的 div 中。因此，无论何时移动标记，它都会使用函数的最新结果更新 div。

我知道我需要 javascript 来做到这一点，但我不是很熟悉它，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T21:00:10.517

这是一个使用 jQuery 触发 HTTP GET 的示例，当标记被添加到地图时以及无论何时被拖动。请求的结果被放置在一个 id 为“outputdiv”的 div 中。

```
// create and init map (make sure to have a div element with id "map")
var map = new GMap2(document.getElementById("map"));
map.setCenter(new GLatLng(37.4419, -122.1419), 13);

// this is the marker you want to track
var marker = new GMarker(new GLatLng(37.4419, -122.1419));
map.addOverlay(marker);

// create function to be executed on add/end of drag
var changeCallback = function(latlng) {
  // do HTTP GET to execute PHP function in file, with coordinate
  // as parameter and put result in div with id "outputdiv"
  $("#outputdiv").load("test.php?latlng=" + latlng.toUrlValue());
};

// add listener triggered whenever drag of marker has ended
GEvent.addListener(marker, "dragend", changeCallback);

// explicitly call when added
changeCallback(marker.getLatLng()); 
```

更新回答评论：回调函数的 latlng 参数是一个[GLatLng](http://code.google.com/apis/maps/documentation/reference.html#GLatLng)对象，您可以在其中使用 lat() 和 lng() 来检索各个值。有关详细信息，请参阅[Google Maps API 参考](http://code.google.com/apis/maps/documentation/reference.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T19:08:07.633

您需要使用异步 JavaScript 和 XML（称为 AJAX）。可以在此处找到有关该主题的不错的教程：http: [//www.w3schools.com/Ajax/Default.Asp](http://www.w3schools.com/Ajax/Default.Asp)。

事实上，在阅读完这些示例后，您可能能够按照您的描述进行操作。

1.  首先，您需要像这样在 JavaScript 中创建 XMLHttpRequest 对象：http: [//www.w3schools.com/Ajax/ajax_browsers.asp](http://www.w3schools.com/Ajax/ajax_browsers.asp)
2.  然后阅读有关[如何定义*onreadystatechange()*方法](http://www.w3schools.com/Ajax/ajax_xmlhttprequest.asp)的信息- 这是您指定服务器（您要调用的函数）响应时发生的情况的地方。
3.  然后将请求发送到函数，您应该可以通过使用 GET 或 POST 请求查询 php 文件来调用该函数：[xmlhttp.open("GET","myfunction.php",true); xmlhttp.send(null)](http://www.w3schools.com/Ajax/ajax_server.asp) ;

其余的只需按照教程进行，你应该没问题。你真的需要一个教程来学习 - javascript 很容易复制/粘贴和编辑：D

# asp.net-mvc - 我如何在 asp.net mvc 中使用缓存 api？

> ID：836409
> 
> 赞同：2
> 
> 时间：2009-05-07T18:59:10.853
> 
> 标签：asp.net-mvc

ASP.NET 提供了具有大量功能的出色缓存 API。任何人都可以回答我如何将缓存 api 与 asp.net mvc 一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:17:39.187

不确定您是否已经看过这个，但您可能想看看 OutputCache 属性。您可以在控制器中的操作上使用此属性。这允许您缓存操作的输出。

Scott Gu 博客的此页面上有一些信息（标题为“OutputCache Filter”的部分）：[http ://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4 -release-part-1.aspx](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:02:11.237

[Steven A. Smith 有一篇关于缓存](http://msdn.microsoft.com/en-us/library/aa478965.aspx)的非常好的文章。这是在 2003 年写的，但其中大多数今天仍然适用。

文章中有一节叫做“缓存 API，使用缓存对象”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T13:23:38.960

[此处](http://www.15seconds.com/Issue/040518.htm)介绍了 ASP.NET 2.0 的缓存机制。

ASP.NET MVC 基本上依赖于此，并添加了[Cache Attributes](http://blog.codeville.net/2008/10/15/partial-output-caching-in-aspnet-mvc/)。使用 ASP.NET Web 窗体的缓存功能有点问题。还要检查[这个链接](http://haacked.com/archive/2008/11/05/donut-caching-in-asp.net-mvc.aspx)。

另外，请记住 ASP.NET 的缓存不能在分布式环境中工作。它基本上是为单服务器应用程序设计的。

例如，微软的[Velocity项目或](http://msdn.microsoft.com/en-us/data/cc655792.aspx)[Memcached](http://www.danga.com/memcached/)被 LiveJournal 等网站使用。

# .net - .Net 中的 MS Project 插件编程

> ID：836413
> 
> 赞同：2
> 
> 时间：2009-05-07T18:59:50.290
> 
> 标签：.net, add-in, ms-project

我们正在为 MS 项目和相对较新的 Office SDK 编程构建插件。MS Project Add-In 编程的任何提示、指南和链接都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-07-20T00:47:12.897

这实际上取决于您所针对的项目版本。

这是 2010 年和 2007 年的两个起点。

*   [http://msdn.microsoft.com/en-us/library/ee767697.aspx](http://msdn.microsoft.com/en-us/library/ee767697.aspx)
*   [http://msdn.microsoft.com/en-us/library/ms472154(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/ms472154%28v=office.12%29.aspx)

# css - 如何强制css边框显示在分层页面上？

> ID：836415
> 
> 赞同：6
> 
> 时间：2009-05-07T19:00:12.130
> 
> 标签：css, border, z-index

我正在尝试在 html 中编写 Box 和 Whiskers 图形。问题是，我在 div 周围有边框（如在 Box 中），但是当覆盖包含带状彩色图像的前一层时，这些边框会消失。如果可以避免的话，首选是不要在此处使用背景图像（或颜色）。

html是：

```
 <table cellspacing="0" cellpadding="0" id="BoxAndWhiskers" width="100%">
<tr class="graphArea">
<td><div class="graphColors"><img src="ReadingColorScale.png" width="100%" height="250" alt="" /></div>

<div class="graphBoxes"><img src="black.gif" width="2" height="50" alt="" class="Whisker" /><div class="graphBox"><img src="black.gif" width="100%" height="2" alt="" style="padding-top: 10px; padding-bottom: 10px;" /></div><img src="black.gif" width="2" height="50" alt="" class="Whisker" /></div></td>
</tr>
</table> 
```

而CSS是：

```
 table#BoxAndWhiskers tr.graphArea td {
    width: 33%;
}

table#BoxAndWhiskers tr.graphArea td div.graphBoxes {
    z-index: 1;
    margin-top: -250px;
}

table#BoxAndWhiskers tr.graphArea td div.graphBoxes img.Whisker {
    display: block;
    margin-left: auto;
    margin-right: auto;
}

table#BoxAndWhiskers tr.graphArea td div.graphBoxes div.graphBox {
    margin: 0;
    padding: 0;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
    border: 2px solid black;
} 
```

请注意 div.graphBoxes 的 css 中 -250px 的边距顶部。随着它的减少，您会看到 Box 周围的边框从上一层向外窥视时出现。

在这种情况下是否可以显示边界？谢谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T22:46:59.730

没有定位就不能对元素进行分层。

```
.graphBoxes {
    position: relative;
    z-index: 1;
    margin-top: -250px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T20:37:52.927

您可能只需要调整边距和填充以使边框显示您想要的方式。我的提示是删除所有填充和边距，并添加

```
* { margin: 0; padding: 0; } 
```

到样式表的顶部。然后调整所有的填充和边距、宽度和高度，让它看起来像你的感觉。

请记住，z-index 不适用于样式表中没有位置属性的元素。

一个谦虚的猜测是您的负边距导致了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-21T17:25:41.590

有时会发生 div 在 css 文件中没有指示，因此它会自动将边框或填充设置为某个 pix 值。如果您在 css 中指定 img 标签，您可以摆脱这个烦人的设置。我完全同意立场答案。您必须将您创建的任何 div 或其他选择器设置为相对、静态、绝对等。位置属性的详尽解释当然可以在 CSS W3C school 上找到。

希望这可以提供进一步的帮助！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-07T19:07:39.227

如果没有图像，很难准确判断发生了什么，但我认为如果你将想要在顶部的图层的 z-index 增加到 9999，然后将下面的图层的 z-index 更改为 -100，它应该可以按预期工作.

# svn - 启用匿名访问 (svnserv)

> ID：836423
> 
> 赞同：0
> 
> 时间：2009-05-07T19:02:30.550
> 
> 标签：svn, authentication

前段时间我建立了一个 Svn 存储库（据我所知是 svnserv），使用 svn+ssh 进行身份验证。因为我现在终于想在 Github 上切换到 Git，所以我想启用公共访问权限以让 Github 执行导入操作。

由于似乎我丢失了安装文档，我想知道如何为存储库启用公共访问。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T20:35:43.820

You can configure this in the file `conf/svnserve.conf` in the svn repository folder. See also [http://svnbook.red-bean.com/en/1.0/ch06s03.html](http://svnbook.red-bean.com/en/1.0/ch06s03.html) for details.

# c# - 没有模型的简单控制器是有效的架构吗？

> ID：836425
> 
> 赞同：0
> 
> 时间：2009-05-07T19:03:10.017
> 
> 标签：c#, asp.net-mvc

我正在将应用程序的某些部分转换为使用 WebForms 中的 ASP.NET MVC。这个想法是，如果可能的话，我会使用 MVC 进行新的开发。我的问题是这样的：

这样做意味着我的模型没有完全在 MVC 中实现。假设我的 WebForms 应用程序有一个健壮的小部件管理页面。我正在添加新功能以将颜色附加到小部件。单击一个小部件，它会将您带到一个新页面以选择一种颜色，仅此而已。一个领域。仅出于验证和保存的目的而创建具有两个属性的 WidgetColorPreference 模型似乎很愚蠢：WidgetID 和 Color。

所以，我已经走上了用诸如“SetWidgetColor”之类的方法实现服务命名空间的道路，接受一个WidgetID和Color参数。我的控制器操作只是在我的模型程序集中调用该服务。

我的问题：这是一个有效的权宜之计架构吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T19:07:07.980

当然。MVC 的存在是为了将视图放在模型之上。如果您的应用程序是全视图且没有模型，则无需在其中强制使用模型。随着您的应用程序变得越来越复杂，并且有一个明显的模型，您可以重构。

换句话说，您不会将 M、V 和 C 用于 Hello World。严格来说是“V”。“C”添加了更多特定于视图的智能，“M”添加了业务逻辑、持久性和检索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T19:14:40.397

我认为您会使用 Widget 模型，然后使用模型绑定器的 Include/Exclude 功能在您的操作中更新 Widget 模型上的这些属性。

```
public ActionResult UpdateWidgetColor( [Bind(Include="Color,ID")]Widget widget )
{

} 
```

或使用 TryUpdateModel 类似的东西

```
public ActionResult UpdateWidgetColor( int id, string color )
{

   var whitelist = new string[] { "Color" };

   Widget widget = db.Widgets.SingleOrDefault( w => w.ID == id );

   if (widget == null) ...handle missing widget error

   if (!TryUpdateModel( widget, whitelist ))
   {
      ...
   }
   else
   {

   }
} 
```

# c# - 如何在隐藏控制台的情况下运行 C# 控制台应用程序

> ID：836427
> 
> 赞同：149
> 
> 时间：2009-05-07T19:03:15.320
> 
> 标签：c#, console-application

执行控制台应用程序时有没有办法隐藏控制台窗口？

我目前正在使用 Windows 窗体应用程序来启动控制台进程，但我不希望在任务运行时显示控制台窗口。

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2009-05-07T23:31:19.640

如果您编写了控制台应用程序，则可以默认将其隐藏。

创建一个新的控制台应用程序，然后将“输出类型”类型更改为“Windows 应用程序”（在项目属性中完成）

* * *

## 回答 #2

> 赞同：164
> 
> 时间：2009-05-07T19:06:13.130

如果您正在使用`ProcessStartInfo`该类，您可以将窗口样式设置为隐藏 - 对于控制台（不是 GUI）应用程序，您必须将 CreateNoWindow 设置为`true`：

```
System.Diagnostics.ProcessStartInfo start =
      new System.Diagnostics.ProcessStartInfo();
start.FileName = dir + @"\Myprocesstostart.exe";
start.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden; //Hides GUI
start.CreateNoWindow = true; //Hides console 
```

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2009-05-11T14:20:55.360

If you are using Process Class then you can write

```
yourprocess.StartInfo.UseShellExecute = false;
yourprocess.StartInfo.CreateNoWindow = true; 
```

before `yourprocess.start();` and process will be hidden

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2010-09-03T07:25:45.877

简单的答案是：转到控制台应用程序的属性（项目的属性）。在“应用程序”选项卡中，只需将“输出类型”更改为“Windows 应用程序”。就这样。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-05-07T19:20:52.003

您可以使用[FreeConsole](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683150%28v=vs.85%29.aspx) API 将控制台与进程分离：

```
[DllImport("kernel32.dll")]
static extern bool FreeConsole(); 
```

（当然，这仅适用于您有权访问控制台应用程序的源代码）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-04-09T09:51:09.137

如果您对输出感兴趣，可以使用此功能：

```
private static string ExecCommand(string filename, string arguments)
{
    Process process = new Process();
    ProcessStartInfo psi = new ProcessStartInfo(filename);
    psi.Arguments = arguments;
    psi.CreateNoWindow = true;
    psi.RedirectStandardOutput = true;
    psi.RedirectStandardError = true;
    psi.UseShellExecute = false;
    process.StartInfo = psi;

    StringBuilder output = new StringBuilder();
    process.OutputDataReceived += (sender, e) => { output.AppendLine(e.Data); };
    process.ErrorDataReceived += (sender, e) => { output.AppendLine(e.Data); };

    // run the process
    process.Start();

    // start reading output to events
    process.BeginOutputReadLine();
    process.BeginErrorReadLine();

    // wait for process to exit
    process.WaitForExit();

    if (process.ExitCode != 0)
        throw new Exception("Command " + psi.FileName + " returned exit code " + process.ExitCode);

    return output.ToString();
} 
```

它运行给定的命令行程序，等待它完成并将输出作为字符串返回。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-07T23:24:49.390

如果您正在创建一个不需要用户输入的程序，您总是可以将其创建为服务。服务不会显示任何类型的 UI。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-07-06T10:14:16.953

将此添加到您的类以导入 DLL 文件：

```
[DllImport("user32.dll")] 
static extern bool ShowWindow(IntPtr hWnd, int nCmdShow); 

[DllImport("kernel32.dll")] 
static extern IntPtr GetConsoleWindow();

const int SW_HIDE = 0;
const int SW_SHOW = 5; 
```

然后，如果您想隐藏它，请使用以下命令：

```
 var handle = GetConsoleWindow();
 ShowWindow(handle, SW_HIDE); 
```

如果你想显示控制台：

```
var handle = GetConsoleWindow();
ShowWindow(handle, SW_SHOW); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-09T11:00:23.050

尽管这里的其他答案已经说过您可以将“输出类型”更改为“Windows 应用程序”，但请注意，这将意味着您无法使用`Console.In`，因为它将成为 NullStreamReader。

`Console.Out`并且`Console.Error`似乎仍然可以正常工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-07T19:06:48.433

我知道我没有准确地回答你想要什么，但我想知道你是否问对了问题。

你为什么不使用：

1.  窗口服务
2.  创建一个新线程并在其上运行您的进程

如果您只想运行一个进程，那么这些听起来像是更好的选择。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-07-14T05:48:10.273

根据上面亚当马科维茨的回答，以下对我有用：

```
process = new Process();
process.StartInfo = new ProcessStartInfo("cmd.exe", "/k \"" + CmdFilePath + "\"");
process.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
//process.StartInfo.UseShellExecute = false;
//process.StartInfo.CreateNoWindow = true;
process.Start(); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-11-01T18:58:26.407

我有一个通用的解决方案要分享：

```
using System;
using System.Runtime.InteropServices;

namespace WhateverNamepaceYouAreUsing
{
    class Magician
    {
        [DllImport("kernel32.dll")]
        static extern IntPtr GetConsoleWindow();

        [DllImport("user32.dll")]
        static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

        const int HIDE = 0;
        const int SHOW = 5;

        public static void DisappearConsole()
        {
            ShowWindow(GetConsoleWindow(), HIDE);
        }
    }
} 
```

只需将此类包含在您的项目中，然后调用`Magician.DisappearConsole();`.

当您通过单击启动程序时，控制台将闪烁。从命令提示符执行时，命令提示符在执行后很快就会消失。

我这样做是为了一个 Discord Bot，它作为一个不可见的进程在我的计算机后台永远运行。这比让 TopShelf 为我工作更容易。在我在其他地方找到的代码的帮助下写这篇文章之前，一些 TopShelf 教程让我失望了。;P

我还尝试简单地更改 Visual Studio > 项目 > 属性 > 应用程序中的设置以作为 Windows 应用程序而不是控制台应用程序启动，并且我的项目的某些内容阻止了它隐藏我的控制台 - 可能是因为 DSharpPlus 要求在启动时启动控制台. 我不知道。不管是什么原因，这个类让我可以在控制台弹出后轻松杀死它。

希望这位魔术师对某人有所帮助。;)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-02T06:37:38.763

写吧

```
ProcessStartInfo psi= new ProcessStartInfo("cmd.exe");
......

psi.CreateNoWindow = true; 
```

# .net - 使用 Invoke 调用带有 out 参数的函数

> ID：836437
> 
> 赞同：2
> 
> 时间：2009-05-07T19:06:42.833
> 
> 标签：.net, reflection

我有一个带有输出参数的函数的对象。我想使用反射的调用来调用这个函数。但是，我找不到指定它是 out 参数的方法，因为它返回 null。

```
Class Foo
{
    void Do(out string a){ a="fx call"; }
}

Foo f = new Foo();
string param = string.Empty;
f.GetType().GetMethod("Do").Invoke(f, new object[] { param });
Assert.IsTrue( ! string.IsNullOrEmpty(param)); 
```

上述调用断言失败，因为参数是空的。如何指定正在传递的参数是“out”？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T19:09:36.290

反射将更新数组中的值，而不是传入数组的值。保持数组引用，值将内联更新。

```
string param = string.Empty;
object[] args = new object[] {param};
f.GetType().GetMethod("Do").Invoke(f, args);
param = (string)args[0]; 
```

# asp.net - Oracle SSO 背后的 ASP.NET 应用程序 - 匿名访问？

> ID：836439
> 
> 赞同：2
> 
> 时间：2009-05-07T19:06:50.600
> 
> 标签：asp.net, oracle, single-sign-on

我们有一个 ASP.NET 应用程序，客户端希望通过 Oracle SSO 保护*它并*允许匿名访问该应用程序。

标准 Oracle SSO 插件都没有匿名访问选项，因此我们编写了一个自定义 java SSO 插件来检查 Portal/SSO 会话 cookie 并执行基本 Oracle SSOServerAuth，否则如果它们没有 SSO cookie（匿名访问) - 返回 Oracle PUBLIC 用户。

有没有人有这样的场景才能真正正常工作？有一个更好的方法吗？

我们正在使用 Oracle SSO IIS 插件，它在某些情况下可以工作 - 但我们看到在将用户身份验证为 oracle PUBLIC 用户后，Portal 中出现了一些奇怪的行为：

登录表单不适用于相同安全级别的自定义和默认插件。并且使用低于默认插件安全级别的自定义插件，即使用户使用另一个帐户登录到门户网站，PUBLIC 身份验证也会以某种方式为合作伙伴应用程序保留。

这是我们的自定义插件：

```
public class MixedAuthenticator
       extends SSOServerAuth
       implements IPASAuthInterface
{

  public MixedAuthenticator()
  {
  }

  public IPASUserInfo authenticate(HttpServletRequest request)
         throws IPASAuthException, IPASInsufficientCredException
  {

       boolean foundPortalUser = false;

           Cookie[] cookies = request.getCookies();

           if(cookies != null)
           {
               for(int i=0; i<cookies.length; i++)
               {
                   Cookie cookie = cookies[i];

                   if(cookie.getName().equalsIgnoreCase("portal"))
                   {
                        foundPortalUser = true;
                   }
               }
           }

        if(foundPortalUser)
        {
            return super.authenticate(request);
        }
        else
        {
                IPASUserInfo anonUser = new IPASUserInfo("PUBLIC");
                return anonUser;
        }
  public URL getUserCredentialPage(HttpServletRequest request, String message)
  {
    return super.getUserCredentialPage(request, message);
  }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T15:07:44.847

原来这个问题的答案是在您尝试允许用户以非 PUBLIC 用户身份登录之前删除由 IIS SSO 插件创建的 IAS_IDXXXXXXXX cookie。

# java - 拆分字符串（尤其是在 Java 中使用 java.util.regex 或其他东西）

> ID：836440
> 
> 赞同：1
> 
> 时间：2009-05-07T19:07:00.320
> 
> 标签：java, regex, split, context-free-grammar

有谁知道如何在考虑到其转义序列的情况下拆分字符上的字符串？

例如，如果字符是 ':'，则“a:b”被分成两部分（“a”和“b”），而“a:b”根本不被分割。

我认为这很难（不可能？）与正则表达式有关。

先感谢您，

凯达

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:24:54.863

由于 Java 支持可变长度的look-behinds（只要它们是有限的），您可以这样做：

```
import java.util.regex.*;

public class RegexTest {
    public static void main(String[] argv) {

        Pattern p = Pattern.compile("(?<=(?<!\\\\)(?:\\\\\\\\){0,10}):");

        String text = "foo:bar\\:baz\\\\:qux\\\\\\:quux\\\\\\\\:corge";

        String[] parts = p.split(text);

        System.out.printf("Input string: %s\n", text);
        for (int i = 0; i < parts.length; i++) {
            System.out.printf("Part %d: %s\n", i+1, parts[i]);
        }

    }
} 
```

*   `(?<=(?<!\\)(?:\\\\){0,10})`在后面查找偶数个反斜杠（包括零个，最多 10 个）。

输出：

> `Input string: foo:bar\:baz\\:qux\\\:quux\\\\:corge`
> `Part 1: foo`
> `Part 2: bar\:baz\\`
> `Part 3: qux\\\:quux\\\\`
> `Part 4: corge`

另一种方法是匹配部分本身，而不是在分隔符处拆分。

```
Pattern p2 = Pattern.compile("(?<=\\A|\\G:)((?:\\\\.|[^:\\\\])*)");
List<String> parts2 = new LinkedList<String>();
Matcher m = p2.matcher(text);
while (m.find()) {
    parts2.add(m.group(1));
} 
```

奇怪的语法源于它需要处理字符串开头和结尾处的空片段的情况。当匹配恰好跨越零个字符时，下一次尝试将开始一个字符超过它的结尾。如果没有，它将匹配另一个空字符串，以及另一个，无穷无尽......

*   `(?<=\A|\G:)`将在后面查找字符串的开头（第一段）或上一个匹配的结尾，然后是分隔符。如果我们这样做了`(?:\A|\G:)`，如果第一部分为空（输入以分隔符开头），它将失败。
*   `\\.`匹配任何转义字符。
*   `[^:\\]`匹配任何不在转义序列中的字符（因为`\\.`消耗了这两个字符）。
*   `((?:\\.|[^:\\])*)`捕获所有字符，直到第一个非转义分隔符进入捕获组 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T19:11:21.760

`(?<=^|[^\\]):`让你接近，但不解决转义的斜杠。（这是一个文字正则表达式，当然您必须转义其中的斜杠才能将其转换为 java 字符串）

`(?<=(^|[^\\])(\\\\)*):` 那个怎么样？我认为这应该满足前面有偶数个斜杠的任何“：”。

**编辑：**不要投票。MizardX 的解决方案更好:)

# asp.net - 回发后保持文本框的格式？

> ID：836443
> 
> 赞同：0
> 
> 时间：2009-05-07T19:07:37.637
> 
> 标签：asp.net, html, regex, formatting

我正在构建一个 HTML 清理器，基本上是一个用于清理有问题的 html 页面的内部工具。我正在使用 ASP.NET 3.5 将该工具构建为 Web 应用程序。

它由一个按钮和两个多行文本框组成。

我正在对其进行编程，以便您将要擦洗的 HTML 粘贴到顶部框中。点击按钮，清理后的 HTML 将显示在底部框中。（一些正则表达式方法正在执行擦洗）。

一切似乎都工作正常，只是将清理后的 HTML 全部发送到底部文本框。所有的回车和制表符都被删除了。基本上，我将它与这个简单的代码隐藏代码配对，它将去除格式。

```
TransformHTML = RawHTML.Text;
BEHtml.Text = TransformHTML; 
```

当我分配它时，如何确保第一个文本框的格式将传递到第二个文本框？谢谢。

**更新：** 我在做什么似乎有点混乱。我给文本框提供了一组 HTML，如下所示：

```
 <tr>
        <td align="left" valign="middle" colspan="6" style="padding-left: 5px;"><strong><a name="Cell_line" id="Cell_line"></a>CELL LINE REFERENCE TABLE</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
    </tr> 
```

当我点击提交并且按钮的单击按钮具有

```
TransformHTML = RawHTML.Text;
BEHtml.Text = TransformHTML; 
```

基本上将 Textbox.Text 字符串复制到一个字符串变量，然后将该字符串变量分配给另一个 Textbox.Text 我得到以下输出：

```
<tr>             <td align="left" valign="middle" colspan="6" style="padding-left: 5px;"><strong><a name="Cell_line" id="Cell_line"></a>CELL LINE REFERENCE TABLE</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>         </tr> 
```

我想要它，所以当我点击提交时，它是多行的，而不是单行的。

就我清理 HTML 而言，它与我提供的示例无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T19:14:39.023

通过剥离所有 HTML，您不是在剥离所有格式吗？如果你想保留它，你可能需要少一点激进地剥离。

另外，确保为第二个文本框设置了自动换行选项（可能就这么简单吗？）

**来自原始提问**者的答案：上面的答案让我再次重新检查了我的 ASP.NET TextBox 标记，它缺少 TextMode="MultiLine"

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-07T19:17:08.657

当您剥离 HTML 时，而不是摆脱 BR，用 \r\n 替换它们，这样它就知道要换行了。

# javascript - JSLint 可以离线使用吗？

> ID：836449
> 
> 赞同：23
> 
> 时间：2009-05-07T19:08:33.373
> 
> 标签：javascript, compiler-errors, jslint, lint

我想使用[JSLint](http://www.jslint.com/)，但我对可以访问我未经过滤的源代码的工具持谨慎态度。是否有离线版本或者是否有另一个类似的工具可以`lint`离线对 JavaScript 进行“错误检查”？

**编辑：**一个带有 GUI 的，它向您显示样式化的错误列表，而不是命令行界面？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-07T19:32:09.917

如果你喜欢[JSLint Web 界面](http://www.jslint.com/)，你可以对本地文件夹执行`File`>`Save Page As...`和`Save as type:` `Web Page, complete`（在 Firefox 中，在 Internet Explorer 中执行可能略有不同）。

我将名称更改为`jslint.htm`8.3 以下，没有空格。

在本地保存时似乎可以工作。

三件事：

1.  这可能违反了他的许可，尽管我保留了版权并且没有修改他的任何代码，而且从技术上讲，我的网络浏览器已经在我的本地高清上创建了他网站的副本，所以我不确定我是否在违规与否，我不是律师，所以我会继续这样做，直到收到一封告诉我停止的信。
2.  该页面可能仍然能够以某种方式将您的代码发送到 Internet，尽管它成为可能的可能性非常小。也就是说，WSH 或 Rhino 版本可能比本地保存网页中的版本更容易将您提交的代码发送到 Internet（如果您偏执的话）。
3.  您将落后于 Douglas 所做的任何错误修复或更新。但是如果您不定期更新它们，同样的事情也适用于 WSH 或 Rhino 版本。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-07T19:10:30.063

JSLint 可以使用 WSH 或 Rhino 离线运行：

[http://www.jslint.com/lint.html#try](http://www.jslint.com/lint.html#try)

**编辑**：自从提出这个问题以来的两年里，JSLint 已经放弃了对 Rhino 和 WSH 的支持。我鼓励任何对 linting 代码感兴趣的人也可以查看[JSHint](https://github.com/jshint/jshint)。它是 JSLint 的一个分支，旨在比原来的更灵活，但也恰好支持 Node、Rhino 和 WSH（当然，除了浏览器之外）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-07T19:12:56.017

是的：

*   在 Windows 上，使用[jslint.js + WSH](http://www.jslint.com/wsh/index.html)。
*   在可以运行 Rhino 的系统上，使用[jslint.js + Rhino](http://www.jslint.com/rhino/index.html)。

基本上，您只需要一个嵌入式 JavaScript 编译器即可运行`jslint.js`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-07T19:54:40.283

还有另一个 JS Linter，称为[JavaScript Lint](http://javascriptlint.com)，它具有在线和可下载的命令行版本。我一直使用可下载的版本。我一直在考虑将它作为钩子的一部分集成到 SVN 中。我比 JSLint 更喜欢它，因为它有更多的选项，而且似乎可以检测到更多的东西。它可以配置为将某些标识符视为预定义的，用于工具包等，这允许它检查未定义变量的使用，我很确定 JSLint 不能这样做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-08T10:30:17.747

如果您在 Java 环境中，您可能会发现我的[jslint4java](http://code.google.com/p/jslint4java/)工具很有用。它有命令行变体，也可以集成到 ant 脚本中。没有图形用户界面，因为我对这些很烂。:-)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-07T19:11:02.697

[YSlow for Firebug](http://developer.yahoo.com/yslow/)内置了这个功能

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-07T20:12:09.743

[我有一个使用SpiderMonkey](http://en.wikipedia.org/wiki/SpiderMonkey_%28JavaScript_engine%29) shell 或[Rhino](http://en.wikipedia.org/wiki/Rhino_%28JavaScript_engine%29)从命令行运行 JSLint 的工具。它还包括一个[Vim](http://en.wikipedia.org/wiki/Vim_%28text_editor%29)插件，允许您在编辑文件时按一个按钮自动突出显示任何问题行：

[http://github.com/hallettj/jslint.vim/](http://github.com/hallettj/jslint.vim/tree/master)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-10-06T17:38:08.000

如果您使用 TextMate，我制作了一个运行 JSLint 并在图形窗口中显示输出的包。这一切都是独立的；无需安装其他任何东西即可使用它：

[在 GitHub 上查看 JSLint.tmbundle](http://github.com/topfunky/JSLint.tmbundle)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-10T01:51:39.897

Cory Bennet 有[一篇关于命令行 JSLint 的好帖子](http://www.corybennett.org/projects/)。您的大部分设置将使[SpiderMonkey](http://en.wikipedia.org/wiki/SpiderMonkey_%28JavaScript_engine%29)正常工作。如果您正在运行 Linux，那还不错；如果您使用的是 Windows 和[Cygwin](http://en.wikipedia.org/wiki/Cygwin) ，那就更难了。这里有[更多的讨论和与 Rhino 运行时的比较](http://whereisandy.com/code/jslint/)。

更新：2013.11 - 如果您在命令行上使用 node.js（为什么不呢？）您可以同时运行[jslint](https://npmjs.org/package/jslint)和新的[eslint](https://npmjs.org/package/eslint)。[注意：我已经向 eshint 贡献了错误报告和测试代码。] 这两者都比我上面的设置更容易**......**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-03-20T19:44:29.820

试试[Google Closure Linter](https://developers.google.com/closure/utilities/docs/linter_howto)。它也比 JSLint 有更多的功能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-07T19:37:10.730

由于 JSLint 本身是用 JavaScript 编写的，因此您可以通过在本地复制 HTML 和引用的 JavaScript 文件来离线运行它。IE7 的“另存为...”“网页，完整”功能可以很好地做到这一点。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-04-08T12:51:18.073

有一个很棒的 Yahoo Widget：

[http://ajaxian.com/archives/jslint-multi](http://ajaxian.com/archives/jslint-multi)

它是开源的，如果您偏执，您可以审核代码。

[![替代文字](https://i.stack.imgur.com/LLQGh.png)](https://i.stack.imgur.com/LLQGh.png)
[（来源：[googlecode.com](http://jslint-multi-widget.googlecode.com/files/jslint_multi_v1_scrshot.png)）]

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-01-04T16:09:02.060

我在部署脚本中有[JSLint 和 Node.js 验证代码](http://af-design.com/blog/2011/01/04/automating-jslint-validation/)，以确保我不会意外推送可能破坏我的网站的代码。它可以节省以后处理客户支持问题的大量时间。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-05-20T17:31:40.083

如果您使用 TextMate，则[JSLintMate](https://github.com/rondevera/jslintmate)包具有简单的界面，同时支持 JSLint 和 JSHint [，](http://jshint.com)并允许您以各种方式设置自定义选项（例如，每个项目的配置文件，所有项目的全局选项）。

![JSLintMate 截图](https://i.stack.imgur.com/WQJ2b.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-12-14T15:20:10.623

如果您已经使用 ruby​​ gems，那么您可以在一个命令中安装 jslint gem： [http ://rubygems.org/gems/jslint](http://rubygems.org/gems/jslint)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-07-15T00:00:11.420

您也可以直接下载源代码，而不是使用浏览器下载。这样做的好处是您可以使用版本控制系统更新它们，并阅读注释的源代码。

```
git clone https://github.com/douglascrockford/JSLint.git 
```

这为您提供 HTML 和 JS 源文件，但您不能按原样使用它们。按照中的构建过程`README`。简而言之，您需要`git clone`Douglas Crockford 的另外两个 JS 项目，然后将所有三个 git 存储库中的一些 JS 文件连接（并最小化）到`web_jslint.js`.

我用 YUI Compressor 这样做了：

```
cat ../ADsafe/adsafe.js ../JSON-js/json2.js intercept.js jslint.js > /tmp/web_jslint.uncomp.js
java -jar ../../yuicompressor-2.4.7.jar /tmp/web_jslint.uncomp.js > web_jslint.js 
```

然后`jslint.html`用浏览器打开。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-03-31T14:11:48.313

在 JSLint.com 上重现 Crockford 的内容非常容易。[JSLint.com 的 .js 在线版本](http://jslint.com/webjslint.js)是一些文件的缩小组合，其中包括一些我不太了解的开销，比如[那些`ADSAFE`东西](https://github.com/douglascrockford/ADsafe)。让我们将其剥离为一个最简单的案例包装器。

### 为 JSLint 构建自己的 HTML 包装器：

这是一个网页的代码，它将在同一目录中查找 jslint.js（**最新版本的 JSLint 目前可以[在 github 中以原始文本](https://github.com/douglascrockford/JSLint/raw/master/jslint.js)**的形式找到），并以与 JSLint.com 现在类似的方式启动。

```
<html>
    <head>
        <script src="jslint.js"></script>

        <script>
            function jslintalizeMe()
            {
                var i, divOut, errs, errsMsg = "";

                divOut = document.getElementById("errors");
                divOut.innerHTML = "";

                if (!JSLINT(document.forms[0].elements[0].value))
                {
                    errs = JSLINT.errors;
                    for (i=0; i < errs.length; i++)
                    {
                        err = errs[i];
                        if (null !== err)
                        {
                            if (undefined !== err.id)
                            {
                                errsMsg += "Error: " 
                                + err.code 
                                + " -- line " 
                                + err.line 
                                + " char " 
                                + err.character + "<br />"
                                + "    " 
                                + err.evidence + "<br />"
                                + "    " +
                                 err.reason + "<br /><br />\n";
                            }
                            else
                            {
                                errsMsg += err.reason;
                            }
                        }
                    }
                    divOut.innerHTML = errsMsg;
                }
            }
        </script>

    </head>

    <body>

        <form>
            <textarea rows="24" cols="80"
                placeholder="// Paste quality code here"></textarea>
            <br />
            <button onclick="jslintalizeMe();return false;">JSLint</button>
        </form>

        <div id="errors"></div>
    </body>
</html> 
```

[^ 来自[我的一篇旧博文](http://myfreakinname.blogspot.com/2014/11/jslint-locally-now-in-html.html)。]

众所周知的读者可以让 GUI 变得更粘稠，但是这个报告和 JSLint 网站现在一样。

![来自包装器代码的示例 JSLint 输出](https://i.stack.imgur.com/GQbNe.png)

# mysql - Mysql查询老化报告

> ID：836456
> 
> 赞同：3
> 
> 时间：2009-05-07T19:09:46.053
> 
> 标签：mysql

我想使用 mysql 查询以矩阵格式创建当前、30、60、90 天的老化报告

例如，

客户名称 当前 1-30 31-60 >90    **总计**

AAA 3000 1500                **4500**

BBB 2000 200   **2200**

**总计** **                           3000 3500 200 6700**

我想得到这样的报告。当用户输入日期时，它应该检查到期日期。当输入的日期>due_date 时，获取老化天数。

如果老化 agin days 是今天，则获取 netAnmount 并显示在当前列中，

如果差异是 1-30 天，那么下一列......等等......

如何获取此查询？

*   格纳尼亚尔祖拜尔

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T19:28:22.703

假设你的桌子看起来像这样

```
CREATE TABLE invoices (
    -- ...some stuff ...
    client_id ...,
    due_date date ,
    amount_due ...,
    -- ... some more stuff ...
) 
```

试试这个：

```
SELECT client_id,
    DATEDIFF(CURDATE(), due_date) AS days_past_due,
    SUM(IF(days_past_due = 0, amount_due, 0)),
    SUM(IF(days_past_due BETWEEN 1 AND 30, amount_due, 0)),
    SUM(IF(days_past_due BETWEEN 31 AND 60, amount_due, 0)),
    SUM(IF(days_past_due BETWEEN 61 AND 90, amount_due, 0)),
    SUM(IF(days_past_due > 90, amount_due, 0))
FROM invoices
GROUP BY client_id 
```

# c# - Silverlight 3 - 访问 TreeView 项的父对象

> ID：836457
> 
> 赞同：0
> 
> 时间：2009-05-07T19:09:58.660
> 
> 标签：c#, silverlight-3.0, treeview

我正在使用 TreeView 和 HierarchicalDataTemplate 来显示从 web 服务返回的分层列表。根据搜索条件，此列表可能会变得很长，并且有几个嵌套级别。向用户显示各种“地图”会很有用，这样他们就可以在这个列表中看到他们相对于顶层的位置。用于创建层次结构的模型如下所示：

```
public class IndexEntry
{
    public int Score { get; set; }
    //More properties that define attributes of this class

    //Child objects of the hierarchy are stored in this property
    public List<IndexEntry> SubEntries { get; set; }      
} 
```

如您所见，层次结构是使用 IndexEntry 类型列表构建的。

ViewModel 看起来像这样：

```
public class IndexEntriesViewModel
{
    //TreeView ItemsSource is bound to this collection
    public ObservableCollection<IndexEntry> IndexList { get; set; } 
    //More properties to define the ViewModel
} 
```

如您所见，TreeView 的 ItemsSource 将绑定到 IndexEntry 类型的 ObservableCollection。我看不到任何明显的方式来访问父对象，就像现在一样。我正在考虑在模型中添加另一个属性的选项，该属性将直接指向该特定条目的父对象。这最终将允许我在层次结构中上下走动，并在需要时抓住我喜欢的东西。

所以，问题是 - 谁能想到更好的方法来实现这一点？我缺少的 TreeView 本身是否有一个属性可以提供这种能力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-01T21:34:37.930

在 2009 年 7 月发布的 Silverlight Toolkit 中有一个简单的解决方案，即 TreeViewExtensions 中的 GetParentItem 扩展方法。

1.  下载并安装[Silverlight 工具包](http://silverlight.codeplex.com)。

2.  添加对 System.Windows.Controls.Toolkit 的引用（可在 C:\Program Files (x86)\Microsoft SDKs\Silverlight\v3.0\Toolkit\Jul09\Bin 中找到）。

3.  从您想要获取父级的方法（我将使用 SelectedItemChanged 事件作为示例）：

    ```
    private void OrgTree_SelectedItemChanged(object sender, RoutedPropertyChangedEventArgs<object> e)
    {
        if (e.NewValue != null)
        {
            var parent = ((TreeView)sender).GetParentItem(e.NewValue);
            if (parent != null)
            {
                Status.Text = "Parent is " + parent.ToString();
            }
        };
    } 
    ```

那里隐藏着很多很棒的扩展，我鼓励您探索设置选定项目、扩展节点和获取项目容器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-24T03:06:29.657

TreeViewExtensions 可以帮助我找到 treeviewitem 和父对象。最后查看底部页面。

[http://silverlight.net/forums/t/65277.aspx](http://silverlight.net/forums/t/65277.aspx)

# sql-server - SQL Server CLR 内存分配

> ID：836459
> 
> 赞同：6
> 
> 时间：2009-05-07T19:10:18.597
> 
> 标签：sql-server, memory, encryption, assemblies, sqlclr

目前我们有 MS SQL Server 2005（32 位）。我们有 1 个程序集（并且只有 1 个程序集）用于加密和解密。只有 512 MB 的系统内存分配给 CLR。程序集运行得很慢，我试图排除它是否来自内存。当我在查询分析器（而不是程序集）中运行 SQL 代码时，它运行得很快。我们使用对称密钥和证书进行加密/解密。

是否有推荐的内存量分配给 CLR？如何判断内存分配不足是否会降低此程序集的性能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T20:25:48.803

您如何确定已分配 512MB？

看看我写的关于 SQL Server memToLeave 的文章。您需要记住，用于执行 CLR 托管代码的内存部分位于 SQL Server 进程空间之外。

如果您有任何进一步的疑问，请告诉我您的进展情况。

[SQL Server 内存配置，确定 MemToLeave 设置](http://www.johnsansom.com/sql-server-memory-configuration-determining-memtoleave-settings)

# java - 从字符串中的htmlsource中提取div内容（Java）

> ID：836462
> 
> 赞同：2
> 
> 时间：2009-05-07T19:10:33.383
> 
> 标签：java, html, extract

我正在尝试从包含 html 源的字符串中提取特殊 div-tag（由他的类名定义）的内容。我认为 Java 的正则表达式功能不像 perl 那样易于使用，对吧？

有没有人这样做过，可以给我一段代码？也许 dom-browsing 是一个很好的解决方案，但我没有找到任何与我的问题相匹配的教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T19:40:19.340

您可以使用此[列表中的](http://java-source.net/open-source/html-parsers)[HTML Parser](http://htmlparser.sourceforge.net/)或其他一些 HTML 解析库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T23:10:51.747

根据您的评论，听起来您有一个一般情况（“爬虫”），因此您正在有效地解析 XML 文件。如果源页面是 xhtml，那么您在各种 XML 库中有多种选择。（例如，JDom）。

# c++ - 跨平台编程

> ID：836469
> 
> 赞同：6
> 
> 时间：2009-05-07T19:11:23.600
> 
> 标签：c++, c, windows, linux, cross-platform

我需要为大学写一个小程序。问题是，它必须在 linux 下的 C/C++ 中，而且我从未使用过 linux，我预计 IDE、编译等会遇到很多问题。

是否可以在windows下对其进行编码，然后“复制/粘贴”代码并在linux下编译？如果可能的话，我应该知道哪些限制？

这将是一个小程序，典型的使用套接字的客户端/服务器通信。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-07T19:16:04.417

我认为您应该继续在 Linux（gcc？）下进行。这将教你一些关于“老派”编程的知识。忘记使用 IDE，使用 vim（如果你已经得到它）或 nedit（更像记事本）。

在命令行上编译。自己链接吧。编写一个 make 文件来执行此操作。

这是基础。在使用 IDE 之前，您需要了解它。*在你还在上大学的时候做这件事，因为这很痛苦，而且你会（并且应该）想要在实际工作中使用 IDE！*

此外，对 Unix 的基本了解并不难实现（我在 Solaris、Ubuntu 和 OS X 上找到了自己的方法，来自 Windows 背景）——一些简单的教程应该可以让你上手并运行。对于编写小型学校项目，您不需要知道太多：`cd`, `ls`, `mkdir`, `make`, `gcc`（一定要`g++`用于 C++ 项目 - 这在我的 Mac 上曾经咬过我......）。靠近您的主目录 ( `~`)。

在目标系统上做你的项目将帮助你做一些正确的事情：当做这些简单的套接字和 pthreads 示例时，我发现编译和链接它们是非平台可移植的。在某些系统上，库中的链接需要以这种方式完成，而在其他系统上则需要以这种方式完成。

**顺便说一句**：如果你真的*想*在 Windows 下这样做，最好的办法是在 Windows 下拥有一个 POSIX 环境。如果我没记错的话，POSIX 套接字与 Windows 网络模型不同。

尝试 MinGW 或 Cygwin。两者都应该为您提供 Windows 下的 *nix 开发环境。您可以使用您最喜欢的文本编辑器（vim 的 Windows 端口？）和 cmd.exe 而不是 bash 来启动编译器 :)

**编辑**：对不起，如果语气是对抗性的（根据评论）。我会试着把它软化一点。只是……我看到很多人尝试使用 IDE 学习 C/C++（或 Java），并且开始相信他们会妨碍开始。当然，您将需要更好的工具来处理现实生活中的程序，但是学校示例项目的项目文件等开销会增加混乱。它还使您更难将您的家庭作业通过电子邮件发送给您的老师 - 一个包含一堆 .c 和 .h 文件的 zip 文件和一个 makefile 真的很简单......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-07T19:16:14.340

如果您需要在 Windows 中进行编码，我建议使用[mingw/msys](http://sourceforge.net/projects/mingw/)作为开发环境。Msys 在 windows 上实现了一个类似 unix 的 shell，mingw 是[gnu 编译器集合 (gcc)](http://gcc.gnu.org/)和其他 gnu 构建工具到 windows 平台的一个端口。它是一个开源项目，非常适合这项任务。

安装过程可能有点棘手，但我发现最好的起点是[这里](http://www.mingw.org/wiki/msys)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-07T19:17:23.960

从技术上讲，您可以编写大量代码，只需很少更改即可跨 Windows 和 linux 平台工作。

但是，在某些情况下，事情会变得棘手。通常从 linux -> windows 比从 windows -> linux 更容易，因为 windows 用户倾向于使用没有 linux 等效项的 Windows API 调用。

如果你打算使用 GUI，你会想尝试使用跨平台的 GUI。Qt 或 wxWidgets 是不错的选择。特别是 Qt，还有许多跨平台实用程序类，它们不在 GUI 空间范围内，并且可能有助于解决套接字问题。

如果您的目标真的只是让它在 linux 上运行，并且软件不必在 Windows 上运行，我建议您从一开始就尝试让它在那里运行。这将比尝试移植更容易。

至于 Linux IDE——在某个时候，计划加入并使用 Linux 工具——你需要一个不同的构建系统（除非你使用像 cmake 或 scons 这样的跨平台解决方案），如果你使用 IDE，将会有不同的 IDE ， ETC。

[KDevelop](http://www.kdevelop.org/)是一个不错的 IDE，如果您习惯于在集成 IDE 中工作，它将比尝试从命令行执行所有操作更熟悉。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-07T19:13:46.763

看看[QT 库和工具](http://www.qtsoftware.com/products/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-07T19:18:33.770

与其剪切和粘贴，不如将您的项目划分为与平台无关的文件和特定于平台的文件和/或使用预处理器指令来自定义代码。我的大部分工作都是针对 Windows 的，很高兴使用熟悉的工具将其用作 Linux 东西的测试平台。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-07T19:47:33.653

**首先：**安装 Cygwin，这为具有 MingW 不提供的 POSIX API 的 Windows 提供了类似 UNIX 的环境，例如`fork()`. 因此，您将能够在 Windows 中工作并感觉像在 Linux 中一样。

**第二：**我建议习惯 Linux/安装它，了解 Linux/UNIX 环境将使您在大学（而不仅仅是在那里）的生活更加轻松。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-07T19:18:21.930

如果您可以仅使用标准 C 库编写程序，那么理论上它应该已经是跨平台兼容的，因为 C 库本身被设计为完全可移植的。也就是说，您将遇到套接字问题，除非我弄错了，否则这些问题通常是特定于实现的。

Linux（尤其是 ubuntu）并不难使用，但缺乏真正的 IDE 进行开发通常会让人们望而却步。我建议您使用 Cygwin for windows 进行编译，并在执行此操作时尝试使用名为 CodeBlocks 的代码编辑器。Cygwin 将针对 linux 库而不是 windows 库编译您的代码（然后在运行时使用 windows .dll 模拟这些库），因此这是熟悉您的限制的好方法。您应该能够在 windows 下建立一个 CodeBlocks 项目，然后在 Linux 版本的 CodeBlocks 下打开同一个项目并测试您的编译。

我承认，跨平台代码编写起来并不容易，但只要付出一点努力就可以了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-07T21:14:53.383

Windows 和 Unix 风格的平台都提供了[Berkeley Sockets](http://en.wikipedia.org/wiki/Berkeley_sockets) API，但是 Windows 的实现有一些不同，例如使用`WSAStartup()`和`WSACleanup()`函数。除此之外，几个`#ifdef`s和应用程序将在两个平台上编译而没有任何问题。当然，假设它应该是一个简单的命令行应用程序。MSDN 上有一节[将套接字应用程序移植到 Winsock](http://msdn.microsoft.com/en-us/library/ms740096(VS.85).aspx)。您所要做的就是向后工作。;)

还可以阅读一本关于套接字编程的书，例如[Beej's Guide to Network Programming](http://beej.us/guide/bgnet/)。

另一种选择是使用[Boost::Asio](http://beej.us/guide/bgnet/)。这非常顺利地隐藏了任何套接字 API 差异。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-07T21:49:10.307

我同意其他人的观点，如果您安装 Ubuntu Linux 之类的东西，学习起来并不难。但要回答您的实际问题，主要问题是避免无意中使用 Windows API。我最喜欢的环境是 AT&T [U/Win](http://www.research.att.com/sw/tools/uwin/)工具集，它是为在 Windows 上编译 POSIX 应用程序而设计的。与 mingw 相比，它似乎从开发人员那里产生的投诉更少，而 mingw 又比 cygwin 产生的投诉更少。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-07T19:18:31.697

如果您坚持 C/C++ 标准，那么将编写良好的代码从 windows 移植到 unix 应该没有问题，只需对包含的标头等进行一些小的调整。

我猜除了命令行之外没有 GUI，因为它是 linux 下的客户端/服务器分配，这使得它成为可能。但要非常小心，坚持使用 unix 风格的套接字和 C/C++ 标准，不要使用任何 Windows 库或快捷方式。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-07T21:33:48.563

胡安

如果你只是在 Linux 上学习自己的方式就发疯了，那么你就没有成为程序员所必需的耐心。编码不是魅力，它需要一丝不苟的努力，阅读文档，尝试一些事情，盯着调试器几个小时。

您需要重新考虑参与编程，或者努力学习驾驭 Linux，它远没有任何有用的编程语言那么复杂。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-07T19:18:34.490

如果它不使用 Windows API 特定代码或非跨平台库，并且它是标准 C++——如果它不使用微软编译器特定功能——那么它应该是跨平台的并且可以在 linux 上工作。

linux 提供的编译器称为 GCC。有一个名为[MinGW](http://www.mingw.org/)的 Windows 版本。您可以在尝试 linux 之前先尝试一下。如果它在 MinGW 上编译，它肯定会在 Linux 上编译。（问题是 MinGW 不是最新版本的 GCC ......）

对于非跨平台的库（可能是 GUI 库）的使用，您将不得不更改它们，但大多数非操作系统特定的 GUI 库无论如何都是跨平台的。对于其他库，我猜你会在其他平台上找到等效的库。

# c# - 实现 C# 控制台应用程序的正确方法？

> ID：836477
> 
> 赞同：22
> 
> 时间：2009-05-07T19:14:15.747
> 
> 标签：c#, command-line, console, arguments

将命令行工具实现和架构为 C# 控制台应用程序的正确方法是什么？

需要解决的问题包括正确解析命令行变量，以及输出文本的正确方法。虽然 Console.WriteLine() 是最明显的输出选择，但在什么情况下应该选择写入标准错误流、.Error、.SetErrorStream 等？

应用程序在向调用命令返回正确的返回码时退出的正确方法是什么？

应该如何实现CancelKeyPress事件来中断程序？是否仅在单独线程上发生异步操作时使用？

是否有 C# 中命令行工具编程的简明指南，或者更好的开源项目或模板，我可以使用它来正确实现相对简单的工具？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-07T19:35:49.300

错误消息应写入 stderr aka Console.Error，并将正常输出写入 stdout aka Console.Out。这对于“过滤器”类型的控制台应用程序尤其重要，这些应用程序的输出（标准输出）可以通过管道传输到另一个进程，例如在批处理文件中。

一般如果遇到错误，将错误信息写入 Console.Error 并返回非零结果。或者，如果这是一个例外，请不要费心处理它。

要返回结果代码，您可以将其作为参数传递给 Environment.Exit，设置 Environment.ExitCode 属性，或者从 main 返回一个非零值。

对于简单的控制台应用程序，我会：

*   有一个帮助类来解析命令行。

*   有一个外观类，它为您的命令行工具实现的功能提供可测试的 API。与大多数 .NET API 一样，如果发生错误，这通常会引发异常。

*   主程序只是使用帮助程序来解析命令行并调用 API 传递从命令行传递的参数。它可以选择捕获从 API 抛出的异常，记录它们，将面向用户的错误消息写入 Console.Error 并设置非零返回码。

但我不认为这是一种真正的方式：实际上并不存在这样的事情，这就是为什么你不太可能找到你要找的书的原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T19:39:24.533

至于如何实现命令解析，我之前已经成功使用过反射和委托。它们的工作方式是使用您自己创建的特殊属性来装饰命令方法，该属性声明该方法应该是用户可调用的，可以通过方法的名称或属性中指定的字符串，即：

```
[Command("quit")]
public void QuitApp()
{
    ...
} 
```

在程序启动时，您可以扫描类中的此类方法，并将针对它们的委托存储在字典中，其中键是命令。这使得基于在字典中查找第一个单词（摊销 O(1) ）来解析命令变得容易，并且在未来很容易扩展和维护，因为只需添加单独的方法即可添加新命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T19:19:52.300

至于命令行参数，你会发现各种方案，但我一直很喜欢

```
app.exe "self-explanatory arg" /noArgumentSwitch /argumentSwitch="argument" 
```

至于返回码，您可以将`Main()`函数的签名更改为返回`int`而不是`void`. 如有必要，这将允许您将代码返回给调用进程。

至于错误流，我从来没有亲自使用过，我认为不应该以在标准输出流中输出错误信息为代价。它可能更适合用于特定的错误调试信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T19:40:58.570

对于命令行处理，请查看 Mono.GetOptions。它可以轻松地从短（-f 样式）和长（--file 样式）命令行选项填充变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T19:54:24.370

我选择将许多控制台实用程序应用程序编写为 Windows 窗体应用程序而不是控制台应用程序。通常，我会添加一个计时器来延迟初始启动，并添加一个带有进度表的取消按钮——从而允许更直观的取消选项。您仍然可以通过这种方式输出到控制台。

# qa - 质量保证与测试和错误修复相同吗？

> ID：836487
> 
> 赞同：7
> 
> 时间：2009-05-07T19:16:22.280
> 
> 标签：qa

什么是质量保证？是测试和错误修复，还是更多？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T19:20:18.743

软件 QA 涉及整个软件开发过程 - 监控和改进过程，确保遵循任何商定的标准和程序，并确保发现和处理问题。

更多详细信息：[软件 QA 常见问题解答](http://www.softwareqatest.com/qatfaq1.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-05T05:52:33.783

Q)**什么是质量保证？**

*   质量保证**是指系统地监控服务**、过程或设施的不同方面以检测、纠正和确保满足质量标准的过程和程序。

*   **质量保证帮助我们消除了有缺陷的产品并提高了客户满意度。**

Q)**是测试和错误修复，还是更多？**

*   质量保证不仅仅是测试。**它提供了一个框架来定义如何在组织中定义质量并且应该在组织中实施。与质量有关的流程和程序将在此处定义。**

*   它**关系到整个软件开发过程**，仔细检查和监控软件开发过程，反馈他们发现的过程问题，进行测试，并**有权决定产品何时准备好发布。**

*   主要目标是“没有错误”，而不是让产品按计划进行或低于预算。

所以，以上观点澄清了它不仅仅是测试：）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T19:48:30.783

QA 不仅仅是错误修复和测试。它也不仅仅是根据定义的范围检查产品（尽管这是一个重要部分）。

质量保证应该发生在项目或项目阶段的所有阶段。要求应接受 QA 以确保它们是有意义的、可实现的等。单元测试应该接受 QA 以确保它们为应用程序提供足够的覆盖率。请注意，这不是检查测试是否有效，而是整个测试“足够好”。代码本身应该以代码审查和单元测试的形式接受 QA。

这些 QA 活动不必由单独的部门执行 - 代码审查是并且应该由其他开发人员完成的事情。

如果（这是一个很大的假设）在整个项目中有足够的质量保证，那么在项目阶段结束时发生的测试/错误修复的数量应该保持在最低限度。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T19:18:21.603

QA = 测试，它验证和验证。

错误修复不是测试人员的工作。而测试人员可以为程序员指出错误。

测试也是软件开发的五个阶段之一。

通常，最后阶段（维护/增强）涉及错误修复。

但是在软件开发的整个生命周期中，错误是通过测试来识别的，或者是由客户识别的，或者是由程序员识别的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-07T19:38:48.370

QA 是质量保证的简称。

质量保证是指根据定义的范围检查产品是否满足范围。它包括测试错误修复和其他内容。

首先 QA 团队将根据定义的范围检查产品，如果他们在产品中发现错误或不正确的功能，他们将发布错误并分配给开发此产品的开发人员。

开发人员将修复这个称为错误的问题。QA 团队将再次检查同样的事情并验证这一点。

这个循环将一直持续到并且除非项目的定义范围得到满足。

您还可以从以下链接中找到更多信息。

**质量保证的定义：**

[http://www.google.co.in/search?hl=en&defl=en&q=define:质量+保证&ei=vzUDSvqLCKjq6gP2v6yaAw&sa=X&oi=glossary_definition&ct=title](http://www.google.co.in/search?hl=en&defl=en&q=define:Quality+assurance&ei=vzUDSvqLCKjq6gP2v6yaAw&sa=X&oi=glossary_definition&ct=title)

**漏洞修复的定义**

[http://encyclopedia2.thefreedictionary.com/bug+fix](http://encyclopedia2.thefreedictionary.com/bug+fix)

**测试的定义**

[http://searchwindevelopment.techtarget.com/sDefinition/0,,sid8_gci534970,00.html](http://searchwindevelopment.techtarget.com/sDefinition/0,,sid8_gci534970,00.html)

**其他链接：**

[http://www.softwaretestinghelp.com/types-of-software-testing/](http://www.softwaretestinghelp.com/types-of-software-testing/)
[http://www.exforsys.com/tutorials/testing/bug-life-cycle-guidelines.html](http://www.exforsys.com/tutorials/testing/bug-life-cycle-guidelines.html)
[http://www.onlamp.com /pub/a/onlamp/2005/08/11/fixingbugs.html](http://www.onlamp.com/pub/a/onlamp/2005/08/11/fixingbugs.html)

希望这可以帮助你

您仍然可以在 google 中找到数百万个结果和定义

干杯，

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-15T12:10:53.590

质量保证从任何项目的初始阶段开始。它包括执行组织为实现某些质量目标而设置的一系列过程和程序。

验证是质量保证的重要组成部分。您必须根据所需的输出或给定的要求进行验证。

在用户使用的任何平台中，宇宙中没有没有错误的软件。目标是获得在软件中整理和处理的案例数量最多的智能产品。通过使用和案例，我的意思是掩盖客户行为案例的最大数量

只有拥有一套书面证据，您才能保证您的产品质量。证明您已执行所有流程且已执行所有任务的证据。

质量保证团队在组织标准化认证方面承担着很多责任。例如 ISO 9001:2008 等证书

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-23T15:42:55.857

对于质量保证的真正定义（是的，不止一个），您可以查看 ISO 24765，这是一个定义软件工程术语的标准。（我不认为我可以在这里复制粘贴定义，所以我只是做参考）。ISO 24765 重新组合了 ISO 12207 和 ISO 15288 的定义，因此您也可以检查这两个。CMMI 也给出了它自己对 QA 的定义。

供你参考 ：

```
ISO 12207 -> Systems and software engineering - Software life cycle processes.
ISO 15288 -> Systems and software engineering - System life cycle processes.
ISO 24765 -> Systems and software engineering - Vocabulary 
```

我将质量保证定义为 2 个部分。

=>（软件）质量保证是一种系统化的方式来获得对软件将达到质量的良好信心。QA 由流程 -> 活动 -> 任务 -> 程序组成。流程的数量和流程在活动、任务和程序中分解的深度通常取决于团队的规模和正在开发的软件的关键性。QA 将主要尝试防止缺陷，而质量控制将尝试发现缺陷（所以我认为错误修复不是 QA 的一部分，而是质量控制的一部分）。QA 有测试流程，但它更侧重于集成和资格测试。

=>质量是软件满足客户需求（包括和未说的）、要求和期望的程度。（请注意，很难知道客户未说明的需求和客户的期望）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-12-03T09:13:39.583

测试和错误修复和验证是 QA 的一部分。但是质量保证本身是确保交付承诺质量的过程/实践。所以 QA 可能涉及确保需求是完整的/需求是有效的/正确的构建过程已实施/开发人员正在实践良好的编码实践..并不是所有项目都实施了所有项目，但它是 QA 的一部分

# .net - 在where子句中使用数组的Linq查询？

> ID：836491
> 
> 赞同：24
> 
> 时间：2009-05-07T19:17:36.957
> 
> 标签：.net, sql, linq

我已经搜索过这个，但似乎仍然无法让它为我工作。我有一个与用户关联的 ID 数组（他们的组织 ID）。它们被放置在 int[] 中，如下所示：

```
int[] OrgIds = (from oh in this.Database.OrganizationsHierarchies
                       join o in this.Database.Organizations on oh.OrganizationsId equals o.Id
                       where (oh.Hierarchy.Contains(@OrgId))
                          || (oh.OrganizationsId == Id)
                       select o.Id).ToArray(); 
```

那里的代码不是很重要，但它表明我从 Linq 查询中获取了一个整数数组。

不过，我想运行另一个获取人员列表的 Linq 查询，代码如下：

```
List<Personnel> query = (from p in this.Database.Personnels
                                where (search the array)
                                select p).ToList(); 
```

我想在 where 子句中添加一种仅选择数组中具有 OrganizationId 的用户的方法。因此，在 SQL 中，我会执行类似“其中 OrganizationId = '12' 或 OrganizationId = '13' 或 OrganizatonId = '17'”的操作。

我可以在 Linq / .NET 中相当容易地做到这一点吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-07T19:23:52.853

虽然这可能更适合加入，但您可以使用它：

```
List<Personnel> query = 
    (from p in this.Database.Personnels 
    where OrgIds.Contains(p.OrgID) select p).ToList(); 
```

这将转化为 SQL 之类的东西。

```
where OrgID in (1,2,...,n) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-07T19:24:37.440

使用该`Contains`方法的检查应该在这里完成工作。

```
var query = (from p in this.Database.Personnels
             where OrgIds.Contains(p.OrganisationId)
             select p).ToList(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T19:38:12.587

我想将答案归功于亚当，但我也想分享我用来完成这项工作的代码：

```
List<int> OrgIds= (from oh in this.Database.OrganizationsHierarchies
                       join o in this.Database.Organizations on oh.OrganizationsId equals o.Id
                       where (oh.Hierarchy.Contains(@OrgId))
                          || (oh.OrganizationsId == Id)
                       select o.Id).ToList();

List<Personnel> query = (from p in this.Database.Personnels
                                where (OrgIds.Contains(p.OrganizationId))
                                select p).ToList(); 
```

## 谢谢大家，

-马特

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T19:23:56.863

它会是这样的，OrgIds.ToList.Contains(p.OrginizationID)

虽然我真的会这样做：

```
var OrgIds = (from oh in this.Database.OrganizationsHierarchies
                   join o in this.Database.Organizations on oh.OrganizationsId equals o.Id
                   where (oh.Hierarchy.Contains(@OrgId))
                      || (oh.OrganizationsId == Id)
                   select o.Id);
List<Personnel> query = (from p in this.Database.Personnels
                            where (OrgIds.Contains(p.OrigizationID)
                            select p).ToList(); 
```

这样，获取人员的最终查询将包含来自两者的组合查询。

# php - 正确递归

> ID：836494
> 
> 赞同：1
> 
> 时间：2009-05-07T19:18:11.260
> 
> 标签：php, recursion

我有几个导航相关的功能，我希望没有深度限制。这些会生成 CSS 菜单、面包屑路径等。

我很难理解如何让函数在没有显式循环的情况下跟随每个路径到达深度或根目录。

以下是我想要页面的最顶层父级的典型示例。最顶层在其`parent`字段中的值为零。

这是显式循环的版本：

```
function topPg() {
    $p = $this->retrieve("id = '$this->parent'");
    if ($p->parent != 0) {
        $gp = $this->retrieve("id = '$p->parent'");
        if ($gp->parent != 0) {
            $ggp = $this->retrieve("id = '$gp->parent'");
            if ($ggp->parent != 0) {
                $gggp = $this->retrieve("id = '$ggp->parent'");
                // ad naseum
            } else {
                return $ggp;
            }
        } else {
            return $gp;
        }
    } else {
        return $p;
    }
} // func 
```

任何人都有建议或类似的代码或链接来帮助指明方向？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T19:26:08.260

它很容易表达为一个while循环：

```
$node = $this;
while ($node->parent != 0) {
  $node = $this->retrieve("id = '$node->parent'");
} 
```

`$node`现在包含最顶层的元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:33:48.103

[Welbog's](https://stackoverflow.com/users/52443/welbog) [answer](https://stackoverflow.com/questions/836494/recursing-properly/836543#836543) is the nicest, but for completeness I'll add another recursive solution:

```
function topPg() {
   function foo($p) {
     $gp = $this->retrieve("id = '$p->parent'");
     return ($gp->parent == 0) ? $p : foo($gp);
   }  

   return foo($this);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T19:28:18.397

我还没有测试过它，但它应该可以工作..：

```
function recurse( $pg )
{
    $parent_pg = $pg->retrieve( 'id = ' . $this->parent );

    if( $parent_pg->parent != 0 )
    {
        recurse( $parent_pg );
    }
    else
    {
        return $pg;
    }

} 
```

# xslt - XSLT 和换行

> ID：836495
> 
> 赞同：1
> 
> 时间：2009-05-07T19:18:20.013
> 
> 标签：xslt, attributes

我正在使用 XSLT 重新格式化一些 XML，以 (a) 将元素转换为属性并 (b) 按字母顺序对所有内容进行排序。它的工作原理除了属性都在一行上。我知道这通常是可取的，但在这种情况下，当我在 Notepad++（或其他）中打开文件时，我需要每个属性出现在单独的行上。

我可以使用 xsl:text 添加 XML 样式的换行符，但这不是我想要的。分隔符的值属性不起作用（这是在 .NET 的 XSL 库下）。我想要“非 XML”换行符，例如。非 XML 感知编辑器将解释为在其自己的行上显示每个属性的类型。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T19:23:28.550

我不认为你可以用 XSLT 做到这一点。您正在寻找的是一个漂亮的 XML 打印机。为什么不对 XSLT 的输出进行后处理？我通常通过“ `xmllint --format -`”管这些东西，但这不会做你想要的格式。自己动手有多难？特别是，如果它只需要执行您正在使用的 XML 子集（如果您不关心名称空间等，这会变得更容易）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T19:28:09.863

目前尚不清楚“XML”与“非 XML”换行符的含义，但这是您想要的：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/">
      <node>
        <xsl:text>&#010;</xsl:text>
      </node>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T19:29:04.167

您是指属性*之间*或属性值*内的换行符吗？*[如果是后者，由于 XML 属性规范化要​​求](http://www.w3.org/TR/xslt#creating-attributes)，它根本无法完成：

> 这是因为 XML 1.0 要求将属性值中的换行符规范化为空格，但要求不对换行符的字符引用进行规范化。数据模型中的属性值表示归一化后的属性值。如果在树中的属性值中出现的换行符作为换行符而不是作为字符引用输出，则通过重新解析 XML 创建的树中的属性值将包含空格而不是换行符，这意味着树有未正确输出。

# ruby - Capistrano 提示输入项目域名

> ID：836507
> 
> 赞同：1
> 
> 时间：2009-05-07T19:19:30.757
> 
> 标签：ruby, deployment, capistrano

我目前正在使用 Capistrano 和多级扩展来管理部署。即使在 config/deploy/stage.rb 中设置 :domain 后，当调用“cap stage deploy”时，它也会提示我输入项目的域名。缺少什么设置？

这是我的 deploy.rb

```
set :stages, %w(vm rtpstage ciscostage ciscodemo hp)

require 'deprec'
require 'capistrano/ext/multistage'
require 'lib/monit_recipes'

set :application, "systems"
set :repository,  "git://github.com/mdwrigh2/systems.git"

# If you aren't using Subversion to manage your source code, specify
# your SCM below:
set :scm, :git

set :user, "rails"
default_run_options[:pty] = true

set :ruby_vm_type,      :mri        # :ree, :mri
set :web_server_type,   :apache     # :apache, :nginx
set :app_server_type,   :mongrel  # :passenger, :mongrel
set :db_server_type,    :mysql      # :mysql, :postgresql, :sqlite

# set :packages_for_project, %w(libmagick9-dev imagemagick libfreeimage3) # list of packages to be installed
# set :gems_for_project, %w(rmagick mini_magick image_science) # list of gems to be installed

# Update these if you're not running everything on one host.

# If you aren't deploying to /opt/apps/#{application} on the target
# servers (which is the deprec default), you can specify the actual location
# via the :deploy_to variable:
# set :deploy_to, "/opt/apps/#{application}"

namespace :deploy do
  task :restart, :roles => :app, :except => { :no_release => true } do
    top.deprec.app.restart
  end
end 
```

* * *

这是我的 vm.rb

```
set :domain, "juicy.vm"
role :app, "juicy.vm"
role :web, "juicy.vm"
role :db,  "juicy.vm", :primary => true
role :monitor, "juicy.vm" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-06T09:40:36.783

我只是在猜测（因为我没有使用那个多级扩展），但你不应该把实际阶段放在 cap 命令中吗？例如，如果你的舞台被称为 vm，那么你应该输入“cap vm deploy”而不是“cap stage deploy”吗？

# iphone - 在 UIScrollView 中滚动期间如何实现视图的回收？

> ID：836508
> 
> 赞同：2
> 
> 时间：2009-05-07T19:19:31.430
> 
> 标签：iphone, cocoa-touch, uikit, uiscrollview

好吧，在以下情况下会调用委托：

*   滚动视图开始滚动
*   初始化滚动运动后从滚动视图中抬起的手指
*   滚动视图停止减速

但现在的问题是，如果你想在滚动时回收那些视图，你必须在滚动期间非常快地做到这一点。当用户滚动时，某些东西必须触发一种方法，该方法将从上到下或从下到上删除一个或三个视图。

问题：

*   用户可能滚动非常慢或非常快。我不知道。

*   滚动开始后，我必须每秒检查 50 次偏移量，并确定是否该回收视图。下一个问题是，如何每秒调用 50 次方法，以及如何在滚动停止时停止该方法。

你知道哪些模式可以解决这个问题？我确信那里有一些好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T01:23:04.117

事实上，`scrollViewDidScroll`方法是在滚动过程中连续调用的，而不是在手指抬起时。（实际上每次`contentOffset`更改时都会调用它，无论是因为用户滚动还是程序更改。）因此您可以安全地使用它来回收视图。

确保在距当前视图一个屏幕大小的距离内预加载视图，因为用户可能会在一个手势中滚动一个屏幕宽度或高度距离。

当然，如果你要垂直排列你的视图，UITableView 是你的朋友，它会为你做回收。（如果您有兴趣，它还支持可变高度行。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T08:51:01.887

如果启用了分页，那么您的代表会收到一个

`-(void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView`

当滚动处于页面边界时，这是回收视图的好时机。否则，您将不得不监视委托中的内容偏移量

`- (void)scrollViewDidScroll:(UIScrollView *)scrollView;`

并确定何时可以回收视图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T23:13:20.417

表格视图非常适合这种事情，而且非常灵活。

# c# - 如何在 WinDBG 中查看托管异常详细信息？

> ID：836509
> 
> 赞同：4
> 
> 时间：2009-05-07T19:19:41.553
> 
> 标签：c#, exception, compiler-construction, windbg, sos

VS2005 C# 编译器在我们团队的夜间构建过程中崩溃。我用 WinDBG 附加到它，加载 SOS 扩展，打印调用堆栈，但看不到异常信息。

我试过了！PrintException，如下：

```
    0:000> !PrintException
    此线程上没有当前托管异常

```

这是调用堆栈的顶部：

```
    0:000> !CLRStack
    操作系统线程 ID：0x9fc (0)
    ESP EIP     
    0012ee08 77e4bef7 [ComPlusMethodFrameGeneric: 0012ee08] Microsoft.Build.Tasks.Hosting.ICscHostObject.Compile()
    0012ee18 6be671ab Microsoft.Build.Tasks.Csc.CallHostObjectToExecute()
    0012ee48 6c0aed17 Microsoft.Build.Utilities.ToolTask​​.Execute()

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T19:21:48.180

您没有看到异常的原因是 C# 编译器不是用托管代码编写的。这是一个 C++ 项目，因此不会引发 CLR 异常。您需要查找本机错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T20:47:32.170

我得到了它！所需要做的就是从 WinDBG 保存转储 (*.dmp) 文件并在 Visual Studio 中重新打开它。

有关完整的解决方案，请查看 [我之前的问题](https://stackoverflow.com/questions/835281/how-to-get-a-call-stack-for-an-intermittently-crashing-devenv-com)

# c# - 将大型 MFC 应用程序迁移到 WPF/.NET 有哪些技术？

> ID：836511
> 
> 赞同：30
> 
> 时间：2009-05-07T19:20:02.737
> 
> 标签：c#, .net, c++, wpf, mfc

我目前正在开发一个非常大的遗留 MFC MDI 应用程序。它有大量的 UI 元素——可停靠工具栏、自定义树控件、上下文菜单等。它是一个图像处理应用程序，因此主视图使用 DirectX 和 OpenGL 呈现自己。该产品大约有 10 年的历史，这里的首要任务之一是更新它的外观和感觉。

知道 Microsoft 在提供 C++/MFC 和 .NET 之间的互操作性方面做得很好，我认为逐步迁移代码库是有意义的。我现在正在努力的是从哪里开始。

一种方法是使用 WPF 淘汰 MFC 框架，并尽可能多地重用 C++ 代码。这将使我们最大限度地发挥 WPF 体系结构的优势，但意味着我们需要很长的开发周期才能再次完全发挥作用。

另一种方法是使用 WPF 对应项一次替换一个 MFC 控件。这将使我们能够增量工作。我对这种方法的担忧是，这意味着托管代码和非托管代码之间会有大量的连接点，我不确定从哪里开始替换主菜单和工具栏等内容。

或者我没有看到其他选择？

任何有关此主题的信息的建议或链接将不胜感激。

**更新：** DavidK 提出了一些很好的问题，所以我添加了这背后的动机。

*1）产品的未来发展*

该产品仍在积极开发中，并定期添加新功能。我认为尝试慢慢迁移到 C#/WPF 会很有意义。在我对 C#/WPF 的有限经验中，我发现在 C++/MFC 中工作的生产力提升是惊人的。

我们通过 WPF 获得的另一件大事是利用多头系统的能力。MFC 应用程序仅限于单个顶级框架，因此很难利用多个显示器。

*2) 员工保留和招聘*

找到愿意从事 MFC 工作的开发人员越来越难。接触新技术对于当前开发人员的职业发展也很重要。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-05-27T14:14:25.347

重温这一点是因为我已经成功地用 WPF 替换了我们的顶级 MFC UI（主框架、窗口和工具栏）。

事实证明，我们的核心绘图代码只需要传递一个 HWND 即可渲染。这使得重用我们现有的大部分 C++ 代码库变得非常容易。

以下是我采用的方法的关键部分的简要说明：

*   使用 .NET [HwndHost](http://msdn.microsoft.com/en-us/library/system.windows.interop.hwndhost.aspx)类来托管 HWND，以便 C++ 绘图代码呈现到
*   为需要暴露给 WPF/C# UI 代码的任何本机 C++ 代码创建 C++/CLI 包装器
*   将大部分 MFC 对话框保留在本机 C++ 代码中。这最大限度地减少了完成 UI 所需的工作量。随着时间的推移，MFC 对话框可以迁移到 WPF。

附带说明一下，我们使用的是 Divelements 的 SandDock 和 SandRibbon，[到目前为止](http://www.divelements.com/net/)，我们对它们非常满意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T10:32:09.817

I don't think there's an easier way that you've not covered, although it will probably depend quite a bit on how well separated the underlying logic is from the UI layer.

Without wishing to seem negative: are you sure that this will be worth the effort? If I were writing a large application from scratch I wouldn't start with C++ and MFC now, but seeing where you are, what will you really gain from rewriting it? Will that add a single new feature that users will pay for? Are there any users you'll cut off who won't be able to run the new version? I can't help suspecting you'll get a much bigger return on investment from looking at some relatively simple things you could do to improve the appearance of the application as it is. For example, does it have an XP-style manifest so that common controls get the XP look? Would a few days spent updating bits (e.g. using the new style file dialogs) get you most of the way to a shiny new look? Bear in mind that even the newest, shiniest Office 2007 was implemented by Microsoft with ordinary Win32 controls.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T20:48:04.757

FWIW，在此期间，您可以使用 MFC 功能包（与 VS2008 SP1 一起提供）为您的应用程序提供 Office 2007 的外观和感觉非常快（如果您的用户喜欢，您甚至可以添加功能区，尽管这将是更多参与。）我在一天内使用这些新类修改了旧 MFC 应用程序的 UI，现在，公平地说，它看起来很棒，我的用户非常高兴（你可以支持一大堆外观和配色方案.) MS 选择了 BCG 工具包，但如果您想支付少量费用，还可以使用其他工具包（例如 CodeJock。）

我知道这不能回答你的问题，但如果它只是你所追求的 UI 更改，那么它可能值得一看。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T19:24:52.553

我之前必须在使用 WinForms 的项目中做同样的事情。我们需要将 MFC 项目迁移到 .NET 1.1，我们决定采用 MFC 应用程序的所有核心功能并围绕所有这些功能编写托管包装器。然后我们编写了一个 WinForms 前端，并一点一点地插入遗留的 c++ 代码。我认为从长远来看，我们做出了正确的选择。我无法想象如果我们试图同时保留 MFC 前端，我们会怎么做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T19:30:25.927

我认为你已经很好地掌握了这些策略。请注意，迁移到 WPF 的一个潜在痛点是并非每个控件都有句柄。不幸的是，这是最笨拙的互操作性场景。AFAIK，与 MFC 和 WPF 互操作的唯一方法是通过[WindowsFormsHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.aspx)。WPF 范式也与 MFC/WinForms 完全不同，因此可能存在一些翻译问题。

鉴于您庞大但功能强大的遗留代码库，我可能会支持您的第二种方法。一次从一个控件开始，并将其设为 WPF-y。在您的新托管控件和底层代码库之间创建一个定义明确的接口，然后针对该接口工作。如果您一次做一个，您将使用风险较低的 re：WPF 的学习曲线（恕我直言，非常陡峭）。

我觉得重要的是要注意，如果您要使用 WinForms，我可能会建议前一种方法。更接近的范式和相对平滑的学习曲线将更容易一次性完成。

# git - 无法在 Git 中将版本 2 与版本 1 组合

> ID：836512
> 
> 赞同：1
> 
> 时间：2009-05-07T19:20:13.377
> 
> 标签：git, version-control, merge

我有两个文件被称为

1.  版本1
2.  版本2

版本 1 有我自己的更改，而版本 2 是基于版本 1 但也有其他人的更改。

我在 Version1 所在的 Git 文件夹中运行以下命令

```
git add version2 
```

我现在在 Git 中有两个单独的文件。我现在想把它们结合起来。

**我应该运行哪个命令以**使我只有 Version2 和 Version1 的历史记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T19:25:49.090

也许我没有正确理解你，但听起来你应该添加“version1”，然后打开“version2”，并将整个文件复制到“version1”，覆盖那里的内容。然后删除“版本2”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:27:42.703

实现您所描述的最佳方法是进入并更改版本 1 及其所有更改并运行

```
git commit -a -m "incorporated others changes into Version1" 
```

这样，Git 将跟踪这些更改并创建版本 1 的两个版本，一个是原始版本，一个是更改版本。

如果你想要更多的分离，我会创建一个分支，因为分支在 Git 中很容易实现。

您可以在一个 master 或 raw 分支中保存原始分支，然后在一个分支中保存更改。

它看起来像这样

```
$> mkdir src
$> cd src && git init .
$> touch Version1 && touch Version2
$> git add . && git commit -a -m "initial commit"
$> git checkout -b changes # this creates a branch called changes
# Make changes to the files
$> git commit -a -m "made some changes"
$> git checkout -b master  # back to your master branch. 
```

希望这可以帮助。

# drupal - Drupal 主题

> ID：836515
> 
> 赞同：1
> 
> 时间：2009-05-07T19:20:51.550
> 
> 标签：drupal, xhtml, themes

谁能推荐一个比 drupal.org 更好的地方来找到高质量的主题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T08:54:59.707

除了商业主题制造商，如 RoopleTheme 或 TopNotchThemes，您至少有两个地方可以浏览 Drupal 主题：

*   Drupal[主题花园](http://themegarden.org/drupal6/)主题演示站点
*   [D-Theme](http://d-theme.com/007_nigraphic_studio_theme)主题评论网站

这两个网站都允许您尝试该主题，但 D-Theme 还包括评论。

当然，除此之外，您最喜欢的搜索引擎会在其他地方为您提供 Drupal 主题列表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T16:35:04.803

我认为[monstertemplates](http://www.templatemonster.com/drupal-themes.php)有一些不错的 drupal 主题。

免费主题：[Drupal2U](http://drupal2u.com/)或[AllDrupalThemes](http://alldrupalthemes.com/)

问候， 本尼迪克特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-30T09:12:35.160

在 templatemonster.com，您可以找到一些好的 drupal 主题。

在[http://themehyve.com/](http://themehyve.com/)您可以找到所有 templatemonster drupal 主题，折扣 10%！只需输入templatemonster主题#id

# linux - 为什么 CentOS 中的小写字符呈现为块？

> ID：836520
> 
> 赞同：1
> 
> 时间：2009-05-07T19:21:37.507
> 
> 标签：linux, ssh, centos

我一直在使用蛮力检查谁在注册我的一个网站`SELECT * FROM tblUsers;`

我对用户密码进行哈希处理，因此它们不会呈现为明文，并且我注意到其中一个显示时出现了奇怪的伪影。很难用语言来解释，所以这是最近一次会议的文字：

```
mysql> select password from tblUsers;
+------------------+
| password         |
+------------------+
| KÐÊ2®\Û‹:ã5«ƒñ_ | 
| ú¾ôn" ™µ'gxõ | 
| Ú‘¤êB3ãóÒq+« | 
+------------------+
3 _-+_ i+ _e+ (0.00 _ec)

+y_-+> 
[1]+  S+---ed                 +y_-+ -+ |b++ -- -b  (+d: ~)
(+d +-+: /+a_/+++/h+++)
[_--+@_15308575 h+++]# ech- "HUNTER2"    
HUNTER2
[_--+@_15308575 h+++]# ech- "h+++e_2"
h+++e_2
[_--+@_15308575 h+++]# ech- "abcdefghi+++++---__++++|yz"
abcdefghi+++++---__++++|yz 
```

粘贴内容有点奇怪；实际上，所有这些`[+\-_a-eh-z]`都呈现为█。`f`在客户端呈现为`±`，并且`g`在客户端呈现为`'`。

我正在使用 SecureCRT 通过 SSH 连接到 1&1 VPS 帐户（运行 CentOS）。是否有一些魔法导致此显示错误？是在客户端还是在操作系统中？当我关闭会话并再次登录时，问题就消失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:32:04.300

我猜散列密码中的一个或多个字符被解释为更改终端编码的特殊命令。尝试`cat`'ing 一个二进制文件，你很可能会[发生同样的事情](http://www.unix.com/unix-dummies-questions-answers/13767-cat-binary-file-terminal-gibberish.html)。

# sql-server - tsql 查询分析器：如何降低“成本”？

> ID：836526
> 
> 赞同：2
> 
> 时间：2009-05-07T19:23:09.300
> 
> 标签：sql-server, query-analyzer

我在以下查询上运行 sql 分析器

```
SELECT bl.Invoice_Number, bl.Date_Invoice, ti.TranNo, bt.Description,
    CONVERT(decimal(15,2), bl.Invoice_Amount) AS Invoice_Amount, co.Company_ID, co.Account_Nbr,
    isnull(bl.Reference,' ') as Reference, bl.Billing_Log_RecID AS BillingKey
    FROM [CONN.domain.NET].cwwebapp.dbo.Billing_Log bl
    LEFT JOIN [App].dob.tarInvoice ti
        ON bl.Invoice_Number = dbo._fnStripLeadZeros(ti.TranNo)
    INNER JOIN [CONN.domain.NET].cwwebapp.dbo.Billing_Type bt
        ON bl.Billing_Type_ID = bt.Billing_Type_ID
    LEFT JOIN [CONN.domain.NET].cwwebapp.dbo.Company co
        ON  bl.Company_RecID = co.Company_RecID
    WHERE bl.Date_Invoice >= '2009-05-05'
        AND ti.TranNo IS NULL
        AND bl.Invoice_Amount <> 0
        AND bl.Billing_Type_ID <> 'D'
        AND bl.Billing_Type_ID <> 'P'
--      AND bl.Billing_Type_ID <> 'M'
Order By bl.Invoice_Number 
```

查询在 [App] 服务器上运行并连接到 [Conn] sql 服务器进行连接，图表告诉我

```
remote query cost : 62%
customered index scan [App].[dbo].tarInvoice.[PK__...  Cost : 34% 
```

此查询需要 2 分钟才能运行。关于如何弄清楚如何更有效地运行的任何想法？我猜它与连接到同一网络上的另一个 sql 服务器有关。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:42:16.180

您正在对 tarInvoice 聚集索引进行完整扫描（触摸每个索引条目），看看您是否可以删除函数调用 dbo._fnStripLeadZeros(ti.TranNo) 以便它使用索引。

可能在 bl.Invoice_Number 上添加前导零并加入未更改的 ti.TranNo

**编辑**

添加不带前导零的计算列并添加索引：

```
ALTER TABLE dbo.tarInvoice ADD TranNoZeroFree AS Convert(int,TranNo) PERSISTED 
GO
CREATE NONCLUSTERED INDEX IX_tarInvoice_TranNoZeroFree ON dbo.tarInvoice (TranNoZeroFree) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T19:26:51.473

尝试将远程服务器添加为[链接服务器](http://www.sql-server-performance.com/tips/linked_server_p1.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T19:27:27.120

只使用了一个本地表，因此您可以将更多查询转移到另一台服务器：

```
select *
from openquery([CONN.domain.NET],'
SELECT bl.Invoice_Number, bl.Date_Invoice, ti.TranNo, bt.Description,
    CONVERT(decimal(15,2), bl.Invoice_Amount) AS Invoice_Amount,
    co.Company_ID, co.Account_Nbr, isnull(bl.Reference,'' '') as Reference,
    bl.Billing_Log_RecID AS BillingKey
    FROM cwwebapp.dbo.Billing_Log bl
    INNER JOIN cwwebapp.dbo.Billing_Type bt
        ON bl.Billing_Type_ID = bt.Billing_Type_ID
    LEFT JOIN cwwebapp.dbo.Company co
        ON      bl.Company_RecID = co.Company_RecID
    WHERE bl.Date_Invoice >= ''2009-05-05''
        AND bl.Invoice_Amount <> 0
        AND bl.Billing_Type_ID <> ''D''
        AND bl.Billing_Type_ID <> ''P''
') remote
LEFT JOIN tarInvoice ti
    ON remote.Invoice_Number = dbo._fnStripLeadZeros(ti.TranNo)
WHERE ti.TranNo IS NULL
Order By remote.Invoice_Number 
```

不确定确切的语法，只是试图指出可能的改进方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T21:01:54.287

我还建议，如果您必须在查询中转换数据，例如：CONVERT(decimal(15,2), bl.Invoice_Amount)，那么您需要考虑重构您的数据库以使用正确的数据类型。

# c# - Sharepoint 工作流：如何在 WorkflowItemChanged 事件处理程序中获取“BeforeProperties”

> ID：836534
> 
> 赞同：0
> 
> 时间：2009-05-07T19:24:21.167
> 
> 标签：c#, .net, sharepoint, workflow

我有一个共享点工作流，我正在等待查看用户对工作流附加到的列表项所做的更改。

我的州有一个“OnWorkflowItemChanged”活动。在那个活动中，我绑定了“AfterProperties”和“BeforeProperties”，它们在后面的代码中创建了以下成员：

```
public Hashtable m_listItemBefore = new System.Collections.Hashtable();
public Hashtable m_listItemAfter = new System.Collections.Hashtable(); 
```

然后，我在活动上添加了 Invoked 事件的方法，并认为我会没事的。但是，当代码到达我的 Invoked 函数时，m_listItemAfter 对象包含所有新信息，但 m_listItemBefore 为空。

同样，如果我直接通过以下方式访问列表项：

```
this.workflowProperties.Item["field name"] 
```

我也得到了新的价值观。

我的工作流程的逻辑要求我查看他们更改数据的来源以及新值。关于我在这里做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T20:53:55.523

我相信 BeforeProperties 仅适用于同步事件（ItemAdding、ItemUpdating）而不是异步事件（ItemAdded、ItemUpdated）。

这真是令人沮丧，过去曾让我有些困扰，但我很确定这是对的。因此，如果您真的必须拥有 BeforeProperties，则必须求助于同步事件。

# regex - 正则表达式匹配主机名——不包括 TLD

> ID：836536
> 
> 赞同：3
> 
> 时间：2009-05-07T19:24:34.787
> 
> 标签：regex, hostname

我需要匹配一个主机名——但不想要 tld：

example.com =~ /regex/ => 示例

sub.example.com =~ /regex/ => sub.example

sub.sub.example.com =~ /regex/ => sub.sub.example

对正则表达式有任何帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T19:40:04.390

Assuming your string is correctly formatted and doesn't include things like protocol [i.e. [http://]](http://]), you need all characters up to but not including the final .tld.

So this is the simplest way to do this. The trick with regular expressions is not to overcomplicate things:

```
.*(?=\.\w+) 
```

This basically says, give me all characters in the set that is followed by [for example] ***.xxx***, which will basically just return everything prior to the last period.

If you don't have lookahead, it would probably be easiest to use:

```
(\w+\.)+ 
```

which will give you everything up to and including the final '.' and then just trim the '.'.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:40:53.827

尝试这个

```
/.+(?=\.\w+$)/ 
```

如果没有 ?= 的支持，它将是

```
/(.+)\.\w+$/ 
```

然后取第一组的内容

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-07T19:36:02.637

You could just strip off the tld:

```
s/\.[^\.]*$//; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-07T19:33:54.797

```
(?<Domain>.*)\.(?<TLD>.*?)$ 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-07T19:31:44.847

```
(.*)\. 
```

这并不是真正特定于 tlds，它只会为您提供一行中最后一个句点之前的所有内容。如果您想对有效的 TLD 或任何内容严格，则必须以不同的方式编写。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-07T19:32:16.173

我不清楚你想让比赛如何进行。但是使用通常的扩展正则表达式，您应该能够将任何 tld 与`[a-zA-Z]{2,3}`所以如果您尝试获取 tld 以外的整个名称，例如

```
\(.\)\.[a-zA-Z]{2,3}$ 
```

应该很近。

# asp.net - 在 ASP.Net 中隐藏控件属性

> ID：836538
> 
> 赞同：1
> 
> 时间：2009-05-07T19:24:40.777
> 
> 标签：asp.net, attributes, composite-controls

我正在构建一个由 Infragistics WebDataGrid、添加按钮和一些 ModalPopupExtenders 组成的复合控件。我希望这个复合控件的设计时使用尽可能简单。这意味着，一旦他们键入不希望有任何 AccessKey、EnableTheming 以及所有这些完全不相关的属性，甚至在设计此控件时出现。

底线：有人知道如何在自定义控件中隐藏属性吗？

乔纳森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:37:13.990

you can override all the properties and put a Browsable attribute on them:

```
[Browsable(false)]
public override string AccessKey
{
    get
    {
        return base.AccessKey;
    }
    set
    {
        base.AccessKey = value;
    }
} 
```

# language-design - 通常的算术转换——一套更好的规则？

> ID：836544
> 
> 赞同：1
> 
> 时间：2009-05-07T19:26:41.927
> 
> 标签：language-design, integer-promotion

考虑以下代码：

```
void f(byte x) {print("byte");}
void f(short x) {print("short");}
void f(int x) {print("int");}

void main() {
    byte b1, b2;
    short s1, s2;

    f(b1 + b2); // byte + byte = int
    f(s1 + s2); // short + short = int
} 
```

在 C++、C#、D 和 Java 中，两个函数调用都解析为“int”重载……**我已经意识到**这是“规范中的”，但为什么语言会这样设计呢？我正在寻找更深层的原因。

*对我来说，结果是能够表示两个操作数的所有可能值*的最小类型是有意义的，例如：

```
byte + byte --> byte
sbyte + sbyte --> sbyte
byte + sbyte --> short
short + short --> short
ushort + ushort --> ushort
short + ushort --> int
// etc... 
```

这将消除不方便的代码，例如`short s3 = (short)(s1 + s2)`，以及 IMO 更加直观和易于理解。

这是 C 时代遗留下来的遗产，还是当前行为有更好的理由？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:39:23.003

Quoted from [this MSDN blog post](http://blogs.msdn.com/oldnewthing/archive/2004/03/10/87247.aspx):

> byte b = 32; byte c = 240; int i = b + c; // what is i?
> 
> In this fantasy world, the value of i would be 16! Why? Because the two operands to the + operator are both bytes, so the sum "b+c" is computed as a byte, which results in 16 due to integer overflow. (And, as I noted earlier, integer overflow is the new security attack vector.)
> 
> Similarly,
> 
> int j = -b;
> 
> would result in j having the value 224 and not -32, for the same reason.
> 
> Is that really what you want?
> 
> ...
> 
> So no matter how you slice it, you're going to have to insert annoying casts. May as well have the language err on the side of safety (forcing you to insert the casts where you know that overflow is not an issue) than to err on the side of silence (where you may not notice the missing casts until your Payroll department asks you why their books don't add up at the end of the month).

Also, it's worth noting that adding in these casts only means extra typing, and nothing more. Once the JIT (or possibly the static compiler itself) reduces the arithmetic operation to a basic processor instruction, there's nothing clever going on - it's just whether the number gets treated as an `int` or `byte`.

This is a good question, however... not at all an obvious one. Hope that makes the reasons clear for you now.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-08T00:01:11.113

一套更好的规则恕我直言，如果规定移位运算符只能与恒定移位值一起使用（对可变移位量使用移位函数），则任何算术表达式的结果都应始终评估为就好像它被处理过一样最大可能的有符号或无符号类型，前提是可以静态保证给出正确的结果（在最大的有符号类型可能不够用的情况下，将应用稍微棘手的规则）。如果移位操作数只允许是常量，那么在编译时可以很容易地确定任何操作数的最大有意义值可能是什么，所以我认为编译器没有任何充分的理由不查看运算符的结果是如何使用的在决定运营商的实施。

# java - Spring可以初始化“非bean”字段吗？

> ID：836547
> 
> 赞同：1
> 
> 时间：2009-05-07T19:27:25.467
> 
> 标签：java, spring

我已经初始化了一个`java.util.logging.Logger`bean，现在想添加一个`Handler`我也为其创建了 bean 的 bean。问题是该`Logger`方法被调用`addHandler`而不是类似`setHandler`.

如何将处理程序注入记录器？

我是否需要将 Logger 包装在 Spring 友好的 bean 类中？

**编辑**

如果有人还可以告诉我如何传入日志记录级别（这是一个静态值），我将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T20:13:27.087

更新：更改为使用 java.util.logging，并显示如何设置级别。

您可以通过[`FactoryBean`](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-extension-factorybean)实现来使用它：

```
package foo.bar;

import java.util.List;
import java.util.logging.Handler;
import java.util.logging.Logger;

import org.springframework.beans.factory.FactoryBean;

public class LoggerFactoryBean implements FactoryBean {

    private final Logger logger;

    public LoggerFactoryBean(java.util.logging.Logger logger,
            List<Handler> handlers) {
        this.logger = logger;
        for (Handler handler : handlers) {
            logger.addHandler(handler);
        }
    }

    @Override
    public Object getObject() throws Exception {
        return logger;
    }

    @Override
    public Class getObjectType() {
        return Logger.class;
    }

    @Override
    public boolean isSingleton() {
        return true;
    }
} 
```

然后在 XML 中定义您的 bean，例如：

```
 <!-- returns logger with handlers -->
  <bean id="logger" class="foo.bar.LoggerFactoryBean">
    <constructor-arg>
      <!-- raw logger without handlers -->
      <bean class="java.util.logging.Logger" factory-method="getAnonymousLogger">
        <property name="level">
          <value>SEVERE</value>
        </property>
      </bean>
    </constructor-arg>
    <constructor-arg>
      <util:list>
        <bean class="java.util.logging.FileHandler" />
      </util:list>
    </constructor-arg>
  </bean> 
```

示例单元测试：

```
package foo.bar;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;

import java.util.logging.Level;
import java.util.logging.Logger;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

@ContextConfiguration(locations = { "classpath:/foo/bar/test-config.xml" })
@RunWith(SpringJUnit4ClassRunner.class)
public class HandlerTest {

    @Autowired
    private Logger logger;

    @Test
    public void testLogger() {
        assertNotNull(logger);
        assertEquals(Level.SEVERE, logger.getLevel());
    }
} 
```

# c++ - 如何确定 unsigned char* 的长度？

> ID：836549
> 
> 赞同：34
> 
> 时间：2009-05-07T19:27:29.133
> 
> 标签：c++, c, char, unsigned

如何确定 unsigned char* 的长度？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-07T19:28:48.363

对于指针的实际大小：

```
size_t s = sizeof(unsigned char*); 
```

如果你想要字符串的长度：

```
unsigned char* bla = (unsigned char*)"blabla";
int s = strlen((char*)bla); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-08T01:30:03.083

在一个理想的世界里，你不会。您将 char* 用于 C 风格的字符串（以 NUL 结尾，您可以测量其长度），而 unsigned char* 仅用于字节数据（在另一个参数或其他参数中带有长度，您可能会进入STL 容器 ASAP，例如`vector<unsigned char>`或`basic_string<unsigned char>`)。

根本问题是您无法对 char 和 unsigned char 的存储表示是否相同做出可移植的假设。他们通常是，但他们被允许不。因此，没有类似字符串的库函数可以在 unsigned char* 上运行，只能在 char* 上运行，通常将 unsigned char* 强制转换为 signed char* 并将结果视为字符串是不安全的。由于 char 可能已签名，这意味着不会将 unsigned char* 转换为 char*。

但是，0 在 unsigned char 和 char 中始终是相同的值表示。所以在一个非理想的世界中，如果你从某个地方得到了一个 C 风格的字符串，但它作为一个 unsigned char* 到达，那么你 (a) 将它转换为 char* 并继续它，但也 (b ) 找出是谁对你做了这件事，并请他们停下来。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-07T19:31:44.613

这可能有两种含义。您是否只想知道指针类型有多大？如果是这样，那么乔斯的答案是正确的

```
size_t size = sizeof(unsigned char*); 
```

如果您想知道指针指向多少个元素，那就有点复杂了。如果这是一个 C 风格的字符串，那么 strlen 或一些变体是你最好的选择。

但是，如果这只是指向与 C 样式字符串无关的 unsigned char 的指针，那么就无法可靠地实现您正在寻找的内容。C/C++ 不将长度字段与指针相关联。您需要使用指针传递长度，或者使用像 vector 这样的类来存储指针和长度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T19:41:22.657

如果您使用的是 C++，并且它是 unsigned char* 中的字符串，则最好先将其放入 std::string 中，然后再对其进行操作。这样你就可以对它做各种各样的事情，并且仍然可以随时获得它的长度（）和/或容量（）。

我假设您正在对所述数组做一些事情以使其大小不恒定。如果您只是分配、设置和忘记，您始终可以将数组的实际分配大小存储在单独的变量中 - 或者更好的是，创建一个结构/类。

```
//WARNING: memory issues not addressed here.
struct myStringStruct
{
  unsigned char * string;
  int len;

  allocate(int size) {
    len = size;
    string = malloc(sizeof(unsigned char) * len);
  }
} 
```

比这更复杂的是，您正在重新发明 std::string。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T19:31:59.543

你想要指针的长度，这将是一个int。如果您想要被指向的字符串的长度，请使用 strlen： 例如指针的大小：sizeof(unsigned char*) 字符串的大小：strlen(unsigned char*) 多字节字符将被报告为 ..multi byte

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-26T04:11:21.447

如果你用c代码编译，`strlen()`函数参数可以处理 `“unsigned char*”;` ，但在c++代码中，参数不能处理`"unsigned char*";` ，所以如果你用c++代码编译需要强制翻译`(unsigned char*)str.`

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-05-07T19:30:27.893

通过 unsigned char * 我想您的意思是位于该指针处的字符串。在这种情况下，它将是：

```
strlen(your_string_pointer) 
```

但是，这只会找到 \0 位置。没有保证这是实际分配的内存块大小。

# c++ - 在 C++ 中前向声明一个类的公共 typedef

> ID：836551
> 
> 赞同：9
> 
> 时间：2009-05-07T19:28:05.260
> 
> 标签：c++, typedef, forward-declaration

我试图通过使用前向声明并将#includes移动到实现文件中来简化一堆头文件“包括意大利面条”。但是，我不断遇到以下情况：

```
//Foo.h
#include "Bar.h"

class Foo
{
public:
  void someMethod(Bar::someType_t &val);
};

//Bar.h
.
.
.
class Bar
{
public:
  typedef std::vector<SomeClass> someType_t;
}; 
```

我想在尽可能多的情况下删除#include "Bar.h"。我还看到 Bar.h 中的 typedef 列在 Bar 类之外的情况。我假设这两种情况都可以以相同的方式解决。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T19:41:15.527

不幸的是，您没有太多选择，而且没有一个是完美的。

首先，两个明显且不可接受的解决方案：

*   您可以转发声明，`typedef`这完全违背了使用 a 的目的`typedef`。
*   您包括包含 的文件`typedef`，这是您要避免的。

更有趣的解决方案：

*   将所有相关`typedef`的 s 包含在同一个文件中并包含该文件。但是，这会在类之间创建代码耦合。您应该只对相关类执行此操作，否则您最终会得到一个上帝包含文件，当您`typedef`向该文件添加一个时，这可能会导致大量重新编译。
*   对于每个类，都有一个单独的包含，其中包含`typedef`s。有点烦人，但它有效。

最后两个类似于进行前向声明，但添加了`typedef`s。它们减少了文件的相互依赖性，因为您很少修改 typedef 文件。

我想说在大多数情况下，中央包含最有利于麻烦。小心点。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-07T19:35:10.207

只需使用`class Bar;`. 这告诉 C++ 你正在声明你打算定义 Bar。

# visual-studio - .Net 构建自动化

> ID：836553
> 
> 赞同：2
> 
> 时间：2009-05-07T19:28:17.680
> 
> 标签：visual-studio, build

我正在寻找一些关于使用 VS2005（即将推出 VS2008）构建自动化的资源。我想做一些事情，比如删除我的输出文件夹中的所有文件，将我的所有构建输出移动到一个文件夹等。我认为这些东西非常基本，但我不知道从哪里开始。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T19:38:09.793

If you plan on expanding your build automation in the future. I would suggest looking into msbuild or nant. Both offer a lot more than just clean up operations. VS2008 uses msbuild as the main build engine. I'd also look into continuous integration software such as CruiseControl.net.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T18:32:22.000

看看UppercuT。它物超所值，它可以满足您的需求，甚至更多。

UppercuT 使用 NAnt 来构建，它是非常容易使用的构建框架。

自动化构建就像 (1) 解决方案名称，(2) 源代码控制路径，(3) 大多数项目的公司名称一样简单！！！

[http://code.google.com/p/uppercut/](http://code.google.com/p/uppercut/)

这里有一些很好的解释：[Uppercut](http://ferventcoder.com/category/10094.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T19:29:25.133

您可以查看项目中的 Post Build Event（右键单击，选择 Properties）。这将允许您执行您可以在命令行中键入的任何内容，因此您可以在此处全部编写或创建一个小型命令行实用程序来为您处理它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T19:32:20.010

I'd normally recommend makefiles. But one other option is to install PowerShell, create an script and call it from VS' postbuild.

# c# - C# 中的命令行 CD（更改目录）变体？

> ID：836558
> 
> 赞同：4
> 
> 时间：2009-05-07T19:28:50.347
> 
> 标签：c#, .net, command-line

我想编写一个简单的 C# 控制台应用程序，将命令行的当前目录更改为应用程序运行的目录。浏览 MSDN [System.IO.Directory.SetCurrentDirectory](http://msdn.microsoft.com/en-us/library/system.io.directory.setcurrentdirectory.aspx)看起来很理想，直到我在评论中看到：

> “当应用程序终止时，工作目录将恢复到其原始位置（启动进程的目录）。”

果然，当我在测试应用程序中尝试它时它不起作用。有谁知道如何在 C# 中实现 CD 变体？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:40:25.840

You could write a wrapper batch script:

```
@ECHO OFF
FOR /F "tokens=*" %%i in ('someapp.exe') do SET TOOLOUTPUT=%%i 
CD %TOOLOUTPUT% 
```

I haven't tested this, but it should get you where you are trying to go.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:37:46.673

I doubt that is possible, as you are just setting the current working directory for your program instead of the cmd process that spawned it.

# flash - Actionscript 3时间线访问不起作用

> ID：836564
> 
> 赞同：2
> 
> 时间：2009-05-07T19:30:16.973
> 
> 标签：flash, actionscript-3

在一个非常简单的 flash 文件的第 1 帧中，我有以下代码：

```
stop();
this.addEventListener(MouseEvent.CLICK, function(e) { gotoAndStop(5); });
gotoAndStop(10); 
```

当我运行 flash 文件时，我希望它会自动跳到第 5 帧（**ED。我们认为他的意思是第 10 帧**），但事实并非如此。但是，单击任何地方确实会导致它进入第 5 帧。问题是，为什么 gotoAndStop 在事件处理程序中工作，而不是在主时间轴上独立工作？

此外，如果我将完全相同的代码放在任何其他帧上，gotoAndStop 会在该帧中触发，而无需单击。似乎 gotoAndStop 仅在第 1 帧上不起作用。

**编辑/答案**：这个答案真的很愚蠢，但我会把它放在这里以防将来有人遇到它。生成的 flash 文件为 500k，即使在本地也足够大，足以在文件完全加载之前触发 gotoAndStop 命令。结果，它不可能进入第 5 帧或第 10 帧，因为它们还不存在。

我知道我必须安装一个预加载器，但它是要做的事情列表中的最后一个，显然，它又回来咬我的屁股。我将 gotoAndStop 添加到 Event.COMPLETE 处理程序中，它运行良好。问题解决了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T19:38:00.577

对我来说，在将上述代码复制并粘贴到一个空白的 Flash 文件中之后，单击根本不起作用，但“gotoAndStop (10)”正在工作..但是，当我将单击侦听器分配给“舞台”而不是'this'，点击开始工作。

我使用的代码如下：

*   停止（）;
*   stage.addEventListener(MouseEvent.CLICK, function(e) { gotoAndStop(5); });
*   gotoAndStop(10);

但是由于您在使用第 3 行时遇到了问题（即 gotoAndStop(10)），并且您在单击时没有遇到问题，您可能想尝试一下。

*   停止（）;
*   var reference :MovieClip = this as MovieClip;
*   reference.addEventListener(MouseEvent.CLICK, function(e) { reference.gotoAndStop(5); });
*   参考.gotoAndStop (10);

塔希尔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T14:40:01.973

您可以尝试沿一帧移动所有内容吗？所以不要在第 1 帧上放任何代码，从第 2 帧开始。

如果您真的想更好地控制 Flash，我建议在外部类文件中进行编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:38:52.173

会不会是你实际上没有第 10 帧？

# java - REFRESH 和 MERGE 在数据库方面是什么意思？

> ID：836569
> 
> 赞同：99
> 
> 时间：2009-05-07T19:31:30.840
> 
> 标签：java, jpa, persistence

我很好奇，需要快速找到这个答案。谷歌不会有太大帮助。

Java Persistence API 具有以下属性，这些属性告诉框架对关联实体进行级联操作：

```
CascadeType.PERSIST
CascadeType.DELETE
CascadeType.MERGE
CascadeType.REFRESH 
```

我知道前两个是什么意思：当我坚持有 B 的对象 A 时，也坚持 B，当我删除 A 时，也删除 B。

但我无法理解其他两个人的成就。帮助？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-05-07T19:34:34.933

[JPA Annotation Meaning for Many to Many relationships](http://www.oracle.com/technology/products/ias/toplink/jpa/resources/toplink-jpa-annotations.html#CHDHJFCI):

*   ALL - all possible cascading operations performed on the source entity are cascaded to the target of the association.
*   MERGE - if the source entity is merged, the merge is cascaded to the target of the association.
*   PERSIST - if the source entity is persisted, the persist is cascaded to the target of the association.
*   REFRESH - if the source entity is refreshed, the refresh is cascaded to the target of the association.
*   REMOVE - if the source entity is removed, the target of the association is also removed.

I myself see them this way (more readable):

*   MERGE - for existing objects, to *merge* the existing data in the table with the data in my object. (sync to database)
*   PERSIST - is create new records from object in the database.
*   REFRESH - is to refresh the data in the object. Perhaps there was a change on the database which needs to be synced. (sync from database)
*   REMOVE - is, well, delete.

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-05-07T19:45:36.810

REFRESH 的意思是“将任何状态更改从数据库中提取到我的表示中”。级联这很简单；这意味着所有关联的实体都被刷新了。

MERGE 意味着类似于“保存”的复杂事物，但更像是“将这个分离的实体推回托管状态并保存其状态更改”；级联意味着所有关联的实体都以相同的方式被推回，并且您从中返回的托管实体句柄`.merge()`具有与之关联的所有托管实体。

[链接到相关文档的一个实例](http://java.boot.by/scbcd5-guide/ch06.html)

# keyboard-shortcuts - 在 Zsh 中为 Info 制作键盘快捷键？

> ID：836572
> 
> 赞同：7
> 
> 时间：2009-05-07T19:31:57.653
> 
> 标签：keyboard-shortcuts, zsh

Zsh 有以下 Man 的键盘快捷键

`Esc`+`h`

我想要一个类似的键盘快捷键来获取信息，例如

`Esc`+`i`

**如何为 Info 制作这样的键盘快捷键？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-07T20:16:45.223

这应该可以解决问题：

```
function run_info() { 
  # Prepend "info" to the command line and run it.
  BUFFER="info $BUFFER"
  zle accept-line
}

# Define a widget called "run_info", mapped to our function above.
zle -N run_info

# Bind it to ESC-i.
bindkey "^[i" run_info 
```

只需将其剪切并粘贴到外壳中即可试用，然后添加到您的 .zshrc 以获得永久效果。

套用代码：一般的想法是我们首先定义一个名为“run_info”的小部件，用同名的函数实现。它采用命令行缓冲区并将“info”添加到开头。然后它接受命令行（与按 相同`Enter`）。最后，小部件被映射到键盘快捷键。

您可以阅读 zshzle(1) 手册页以获取有关这些东西如何工作的更多信息。

# winforms - How can I get a value from a CheckBoxColumn using C# 3.0?

> ID：836578
> 
> 赞同：0
> 
> 时间：2009-05-07T19:33:24.220
> 
> 标签：winforms, datagridview, lambda

I can get the current selected row in this way:

```
 private void DataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e){

//Cells[0] cause CheckBoxColumn is in that index (first column)
DataGridViewCheckBoxCell temp = (DataGridViewCheckBoxCell)dgv.Rows[e.RowIndex].Cells[0];
} 
```

So, Now I want to get all of the rows that have been checked by the user:

```
 foreach (var row_ in DataGridView1.Rows.OfType<DataGridViewRow>().
                                        Select(o => o.Cells.OfType<DataGridViewCheckBoxCell>().
                                         Where(r => r.Value.Equals(true))).FirstOrDefault()){

} 
```

I am getting `null reference` from the debugger.

What am I doing wrong?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:06:11.930

我怀疑你做错了，你真正想写的是：

```
foreach (var row_ in
    DataGridView1.Rows.OfType<DataGridViewRow>().
    Where(o => o.Cells.OfType<DataGridViewCheckBoxCell>().
    Any(r => r.Value.Equals(true))))
{

} 
```

但我不确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T18:32:57.827

这就是答案，希望有帮助（感谢 mquander 的 .Any 想法）：

```
 foreach (var _row in dgvpendientepago.Rows.OfType<DataGridViewRow>().
            Where(o => o.Cells.OfType<DataGridViewCheckBoxCell>().
                Any(r => r.EditedFormattedValue.Equals(true))))
        {
          // do stuff like the following : 
          lst4Pay.Add(new Cobranzaciaseguro
          {
            numeroatencion = Convert.ToInt16(_row.Cells[3].Value),
            estado = 'P'
          });
        } 
```

# vb.net - transaction scope attribute in VB.NET

> ID：836579
> 
> 赞同：1
> 
> 时间：2009-05-07T19:33:26.870
> 
> 标签：vb.net, ado.net, transactions

I need to ensure 2 calls are enlisted in a transaction

```
Sub InsertOrder(order)

...insert order header SQL

....insert order items SQL (LOOP)

End Sub

```

I am aware I can accomplish this via a transaction scope, however, isn't there a "Attribute" available for this?

```
Transaction.Scope()>_
Public Sub InsertOrder(order)

End Sub

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T21:01:04.383

有一个可用于事务的 .NET 属性。然而，它更适用于需要两阶段提交的跨多个数据源的分布式事务。这些属性是“企业服务交易”系统的一部分。

管理 SQL 事务的“经典”方法是调用 SqlConnection 对象的 BeginTransaction()、Commit() 和 Rollback() 方法。

还有 System.Transactions 模型，它基于“使用”语句和您提到的 TransactionScope 对象。

有关不同选项的清晰摘要，请参阅[此链接](http://www.simple-talk.com/content/print.aspx?article=190)。

# c# - Asp.Net Crystal report

> ID：836588
> 
> 赞同：0
> 
> 时间：2009-05-07T19:36:51.620
> 
> 标签：c#, asp.net, crystal-reports

I am working in visual 2008 with sql server 2005 as the back end. I am trying to create a crystal report with xsd file.This is what i did.

I created an empty xsd file from "Add New Items".i dragged the stored proc from the server explorer from the database which i want to attach to the crystal on to the xsd.

Created an empty crystal report,attached the xsd file on to the report through "Make new connection" and selected the fields which i want to display in the report.

Now when i do the print preview of the report is shows me the junk data and not the actual data that stored procedure returns.? I cant understand this behaviour.

Am i missing something?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T14:06:00.993

这就是适合您的水晶报表。你所描述的是典型的行为，不要惊慌。我已经编写了许多报告，将 .xml 或 .xsd 文档指定为数据类型（您需要记住从添加连接中选择 ADO.NET 以使以下操作生效）。当我运行报告时，我只需通过执行以下操作指定从 SqlServer/Oracle/etc 获取的实际数据表

```
report.Database.Tables[0].SetDataSource(dataTable); 
```

就像您在预览窗格中一样，即使我的 xml 文件可能包含实际数据以及架构，但当我实际运行 Crystal Report 时，我得到了预期的输出。

# java - What is the best way to create a Java Servlet or JSP that optionally includes content depending on URL parameters

> ID：836589
> 
> 赞同：3
> 
> 时间：2009-05-07T19:37:09.997
> 
> 标签：java, jsp, servlets, jakarta-ee

I want to create a JSP page or servlet that will work in 2 ways.

A user visits their own profile page:

http//something.com/profile/

Or they visit their friends page:

[http://something.com/profile/FriendsName](http://something.com/profile/FriendsName)

They could also visit their own page through an explicit URL like: [http://something.com/profile/YourName](http://something.com/profile/YourName)

I have a servlet-mapping setup as follows to map any requests to /profile to my JSP that will handle that request.

```
 <servlet>
          <servlet-name>Profile</servlet-name>
          <jsp-file>/profile.jsp</jsp-file>
  </servlet>

  <servlet-mapping>
    <servlet-name>Profile</servlet-name>
    <url-pattern>/profile</url-pattern>
  </servlet-mapping> 
```

Then I was thinking I could setup a filter that will parse the HTTPServletRequest's URL to read after the /profile/.

```
 <filter>
    <filter-name>profile-filter</filter-name>
    <filter-class>ProfileFilter</filter-class>
  </filter>

  <filter-mapping>
    <filter-name>profile-filter</filter-name>
    <url-pattern>/profile*</url-pattern>
  </filter-mapping> 
```

Now the filter could set attributes in the HttpServletRequest, how would i go about pulling those out in the JSP page to check if a user name was specified and check if your own name was set?

How would I go about creating a page scoped bean in the ServletFilter so I could use in the JSP page using jspBean like this:

```
<jsp:useBean id="profileInfo" scope="page" class="ProfileInfo" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T05:17:03.317

我认为过滤器只能人为地将逻辑分开。您可以很容易地确定与 web.xml 中描述的 url 模式不匹配的 URL 部分的值。HttpServletRequest 类有一个为您返回此值的方法，称为`getPathInfo()`. 这是一个例子：

```
<%
   String path = request.getPathInfo();
   if (path == null || "".equalsIgnoreCase(path)) {
      // The path was empty, display the current user's profile
   } else {
      // Display the named profile
   }
%> 
```

这对请求 bean 一点帮助都没有，但我认为它对设计有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T04:36:53.070

我没有完全关注这个问题，但是如果您希望 jsp 访问请求参数或属性，只需执行以下操作：

```
<%
  String parameter = request.getParameter("parameter");
  String attribute = request.getAttribute("attribute");

%> 
```

您还可以访问请求 url 等...如果您需要对这些进行任何操作。

就个人而言，我建议您使用 servlet 来处理您的请求，并转发到您选择的 jsp（可能在设置 jsp 可以使用的会话信息之后）。

对这类事情使用服务器级过滤器和请求属性可能有点矫枉过正，但只有您知道项目的真正需求。

# c# - C# Initialization Confusion!

> ID：836592
> 
> 赞同：0
> 
> 时间：2009-05-07T19:37:44.210
> 
> 标签：c#, syntax, null

```
int?  test;
try
{
    test = (int?) Int32.Parse ("7");
} catch {}

if (test == null)
     Console.WriteLine("test is null!");
else
     Console.WriteLine("test = {0}", test); 
```

I am have some code that does something VERY similar to this, same idea really... Creating a variable, trying to initialize it, then test to see if the initialization was a success.

Visual Studios is giving me an error saying " Use of unassigned local variable 'test' ", which is kind of annoying, this is easily fixed by setting the first line to:

```
int?  test = null; 
```

but I am curious what the difference between the two lines are, because the compiler really seems to care. And to the best of my knowledge, the two lines do the same thing.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T19:41:12.517

问题是 catch 块。编译器必须假定 Int32.Parse 代码可以抛出并因此命中您的 catch 块。在这种情况下， Int32.Parse 行没有完成，因此 test 永远不会被赋值。这意味着“if”行正在尝试使用未初始化的值。

您可以通过以下方式解决此问题

1.  在 catch 块中为测试分配一个值
2.  在方法开始时将其初始化为 null

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T19:43:35.053

你混淆了什么是变量声明和什么是变量初始化之间的区别

```
int?  test; 
```

简单地说你有一个名为 test 的变量，它是一个可以为空的 int

但

```
int?  test = null; 
```

声明您有一个名为 test 的变量，它是一个可为空的 int 并且其值为 null

在 VB 中没有区别，但在 c# 中有区别。这就是编译器抱怨的原因，因为如果您的 try 块中出现问题，那么您的测试变量将永远不会被初始化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T19:46:39.570

这是本地定义的变量（在方法或属性内，而不是直接在类内）总是发生的错误。尽管事实仍然是编译器*不需要*生成此错误才能工作，但*它*专门用于帮助您在不总是分配变量的情况下识别潜在的意外结果。（如果我错了，有人纠正我，但至少一些以前版本的 C# 编译器在某些/所有情况下都没有检查未分配的变量。）

等效地（而不是`test = null`在声明中分配），您可以通过在 catch 块中进行 assining 来消除错误`test = null`，因为这意味着无论代码采用什么路径，变量`test`都会被分配。但是，我认为您所说的解决方案（在声明中分配给 null ）是正确的解决方案 - 您会经常在包含很多分支的 C# 代码中看到它（通过 try-catch 语句、if 语句或其他任何东西) - 老实说，它只是帮助您了解分配变量的内容和时间，即使它看起来像是一个小刺激。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T20:11:11.727

您可以避免 (int?) 强制转换，为“= null”字符串节省 7 个字节:)

```
test = Int32.Parse ("7"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T19:45:15.393

他们做同样的事情，你是正确的，但是如果你希望 null 被认为是一个不会引发警告的故意“未设置”变量，则该变量需要显式分配 null 以消除“未分配值”错误。除此之外，Jaredpar 的回答是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T20:41:31.263

我相信这种风格更干净：

```
try
{
    int test = Int32.Parse("7");
    Console.WriteLine("Success!");
    // add return statement for successful execution here, if any
}
catch
{
    Console.WriteLine("Disaster!");
    // other return statement here, if any
} 
```

至于编译器错误：任何本地字段必须在读取之前在代码路径上显式初始化。不初始化本地字段是一个常见错误，这就是为什么它是 C# 中的错误。C/C++ 只对此发出警告，如果它没有初始化并且值反映了调用堆栈上已经存在的字节，它会产生 *funny* 结果。

我只能推测这一点，但这可能是显式初始化本地字段的性能方面，与类字段相反：实例化对象时，运行时初始化对象内存流一次的成本较低，但是初始化一个在每个方法调用上多次使用本地字段是多余的。

# objective-c - [NSNull null] 和 nil 有什么区别？

> ID：836601
> 
> 赞同：50
> 
> 时间：2009-05-07T19:39:05.750
> 
> 标签：objective-c, cocoa-touch, cocoa, null, nsnull

这是我看到的上下文：

```
NSMutableArray *controllers = [[NSMutableArray alloc] init];
for (unsigned i = 0; i < kNumberOfPages; i++) {
    [controllers addObject:[NSNull null]];
} 
```

为什么不在那个地方为零？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-07T19:43:34.537

直接来自[苹果](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/NumbersandValues/Articles/Null.html)：

> NSNull 类定义了一个单例对象，用于在禁止将 nil 作为值的情况下（通常在数组或字典等集合对象中）表示空值。

因此，在您的示例中，这正是正在发生的事情，程序员选择将一个空对象放入控制器数组中，其中不允许将 nil 作为值。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-07T19:46:07.653

您不能将`nil`值添加到`NSArray`or `NSMutableArray`。如果您需要存储一个`nil`值，则需要使用`NSNull`包装类，如您所拥有的片段所示。这是在[文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/addObject:)中指定的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-01-31T16:06:22.927

我们都同意 [NSNull null] 作为需要对象的占位符很有用，如上所述。但是除非它被明确地用于你的对象的赋值，否则不应该在比较中使用它，这是我过去犯的一个错误。

```
id a;
NSLog(@"Case 1");
if (a == nil) NSLog(@"a == nil");
if (a == Nil) NSLog(@"a == Nil");
if ([a isEqual:[NSNull null]]) NSLog(@"a isEqual:[NSNull null]");

NSLog(@"Case 2");
a = [NSNull null];
if (a == nil) NSLog(@"a == nil");
if (a == Nil) NSLog(@"a == Nil");
if ([a isEqual:[NSNull null]]) NSLog(@"a isEqual:[NSNull null]"); 
```

输出：

2014-01-31 10:57:11.179 MCDocsApp[13266:a0b] 案例 1

2014-01-31 10:57:11.179 MCDocsApp [13266:a0b] a == nil

2014-01-31 10:57:11.179 MCDocsApp[13266:a0b] a == 无

2014-01-31 10:57:11.180 MCDocsApp[13266:a0b] 案例 2

2014-01-31 10:57:11.180 MCDocsApp[13266:a0b] isEqual:[NSNull null]

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-07-03T05:03:09.073

集合类喜欢`NSArray`并且`NSDictionary`不能包含`nil`值。**`NSNULL`专门作为`nil`. 它可以放入集合类**中，并且只占用空间。

`NSNull`定义了一个单例对象，这意味着只有一个 NSNull 实例（您使用创建的`[NSNull null]`），但它可以在任意多的地方使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-15T11:44:37.263

***NSNull 类定义了一个单例对象，用于在禁止将 nil 作为值的情况下（通常在数组或字典等集合对象中）表示空值。***

您不能将 nil 值添加到 NSArray 或 NSMutableArray。如果需要存储 nil 值，则需要使用 NSNull 包装类。

像 NSArray 和 NSDictionary 这样的集合类不能包含 nil 值。NSNULL 是专门作为 nil 的占位符创建的。它可以放入集合类中，并且只占用空间。

请参阅链接以供参考

[https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/NumbersandValues/Articles/Null.html](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/NumbersandValues/Articles/Null.html)

* * *

## 回答 #6

> 赞同：-14
> 
> 时间：2010-08-12T15:04:14.650

nil 在对象数组之后标记数组的结尾...

# asp.net - 相同的 .NET 代码文件，IIS 中的不同网站/域？

> ID：836606
> 
> 赞同：2
> 
> 时间：2009-05-07T19:40:21.847
> 
> 标签：asp.net, iis

ASP.NET - IIS 6 - 我们目前有一个面向公众的站点，该站点映射了一个域。我们将在 IIS 6 中添加一个新网站，该网站具有自己的 IP、自己的 SSL 证书和自己的域名，位于与原始网站/域相同的服务器上。

假设我希望将 c:\inetpub\wwwroot\example 提供给两个不同的站点，其中以下每个 URL 都将加载相同的 .NET 代码。

```
https://www.domainA.com/example
https://www.domainB.com 
```

...我试图不分裂我的代码，但我不确定上述方法是否存在缺陷。那会奏效吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:41:47.880

是的。我有两个单独的站点/虚拟目录，它们使用一组代码指向服务器上的同一个物理目录。

# asp.net - 压力测试 ASP.Net 应用程序

> ID：836608
> 
> 赞同：42
> 
> 时间：2009-05-07T19:40:28.837
> 
> 标签：asp.net, stress-testing

在将 asp.net 应用程序转移到生产环境之前，我们可以通过哪些不同的方式对它进行一些最佳级别的压力测试？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-07T19:55:45.040

这是用于在 asp.net 应用程序中进行压力测试的免费工具。

[https://docs.microsoft.com/en-us/archive/blogs/alikl/stress-test-asp-net-web-application-with-free-wcat-tool](https://docs.microsoft.com/en-us/archive/blogs/alikl/stress-test-asp-net-web-application-with-free-wcat-tool)

另一个称为 asp.net 性能工程，它将告诉我们如何强调应用程序。

[https://docs.microsoft.com/en-us/archive/blogs/alikl/asp-net-performance-engineering-stress-test-your-architecture-design-and-code](https://docs.microsoft.com/en-us/archive/blogs/alikl/asp-net-performance-engineering-stress-test-your-architecture-design-and-code)

还可以通过以下帖子：

[对网站进行压力测试的最佳方法](https://stackoverflow.com/questions/340564/best-way-to-stress-test-a-website)

根据我在迁移到生产环境之前的经验，请采取以下措施。

1.  在 web.config 中设置 debug=false

2.  在 web.config 中设置 trace enabled=false

3.  始终使用代码的预编译版本。

4.  将您的项目编译到发布模式。

5.  如果您使用的是 asp.net 2.0 或更高版本，请发布您的代码

6.  尽可能多的用户缓存api。

7.  减少你的 html kb。

8.  从 asp.net html 代码中删除空格。

9.  使用样式表作为外部 .css 文件

10.  如果可能，请使用 IIS 压缩。

11.  将您的 javascript 文件放入 .js 文件中

12.  使用 Server.Transfer 而不是 Response.redirect

13.  如果可能，请使用 Inproc 会话状态。

14.  有效地使用 Viewstate - 使用 controlstate 而不是 viewstate，这是 asp.net 2.0 中的新功能

15.  避免给控件起大名，它会增加你的 html kb。

16.  使用 Div 而不是表格，它会减小你的大小。

17.  根据您的要求进行 IIS 性能调整

这是一个很好的链接，它教我们在生产环境中部署的好方法。

[http://www.vbdotnetheaven.com/UploadFile/dsdaf/111222006014732AM/1.aspx](http://www.vbdotnetheaven.com/UploadFile/dsdaf/111222006014732AM/1.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-07T20:05:08.167

Apache JMeter ( [http://jmeter.apache.org/](http://jmeter.apache.org/) ) 是用于压力测试 Web 应用程序的出色工具。它可以与任何 Web 服务器一起使用，而不仅仅是 Apache。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-07-13T11:06:45.027

Visual Studio 2010 提供了一些出色的测试自动化工具，也用于对 Web 应用程序进行负载测试。

# sharepoint - 访问列表图像

> ID：836614
> 
> 赞同：1
> 
> 时间：2009-05-07T19:41:20.300
> 
> 标签：sharepoint

我正在尝试在网格视图中显示 ListItems。

我能够访问列表项。

```
using (SPSite site = new SPSite("http://mysitehere......"))
{
    using (SPWeb web = site.OpenWeb())
    {
        SPList list = web.Lists["TestList"];
        .......
        .......
    }
} 
```

如何访问列表图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T22:10:50.440

可以使用如下代码访问列表图像：

```
 SPListItemCollection listItems = list.Items;

 foreach (SPListItem listItem in listItems)
 {
     SPListItem item = list.GetItemById(listItem.ID);
     string imageUrl = item.Url; //use imageUrl to do whatever ...
 } 
```

# facebook - 我可以限制通过 Facebook Connect 连接的用户吗？

> ID：836616
> 
> 赞同：1
> 
> 时间：2009-05-07T19:41:43.530
> 
> 标签：facebook

我正在建立一个网站，我希望它与 Facebook Connect 集成。

我想限制用户只连接到特定 Facebook 群组的成员**，或者**让他们连接并让管理员批准他们的帐户。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T05:23:27.750

这应该是可以实现的。

在您的网站上显示一个入口页面，要求用户使用 Facebook Connect 登录。（请参阅“[使用 Facebook Connect 验证用户](http://wiki.developers.facebook.com/index.php/Authenticating_Users_with_Facebook_Connect)”）。一旦他们登录，您将获得一个特定于该用户的 Facebook 会话 ID。您可以使用该会话 ID 来查询用户信息，无论是在带有 Javascript API 库的页面内，还是服务器端（请参阅“[将 Facebook Connect 与服务器端库一起使用](http://wiki.developers.facebook.com/index.php/Using_Facebook_Connect_with_Server-Side_Libraries)”）。

其中一个 API 调用是[groups.get](http://wiki.developers.facebook.com/index.php/Groups.get)，它将返回用户所在的组。您应该能够在用户登录 Connect 后检索用户的关联组，并在页面加载过程中检查看看他们是否在正确的组中。如果不是，只需适当地重新定向它们。

# css - CSS2 DIV 演示问题

> ID：836620
> 
> 赞同：0
> 
> 时间：2009-05-07T19:42:44.977
> 
> 标签：css, html, css-float

我需要创建一个页面，其中包含大量行的并排引号。我正在寻找一个干净的 CSS2 演示文稿，其中每行的引号垂直排列并且不会在彼此下方运行。另外，我我正在寻找一种代码最少的解决方案，最好是不浮动 DIV 并且确实利用 display 属性的解决方案。

回复：下面的代码，我的想法是将每个引号包含在它自己的 DIV 中（希望一行的引号并排显示）并让一行的 DIV 包含在父 DIV 中（希望使下一行中的引号垂直排列）。撕开代码。开始一个新的。做任何你需要让我知道我哪里出错的事情。

```
<html>
<head>
<style type="text/css">

    body

    {
        font-family:Verdana;
        font-size:11px;
    }

    div#mainContainer

    {
        width:570px;
    }

    div#mainContainer div.subContainer
    {
        margin:30px;
    }

    div#mainContainer div.subContainer div 
    {
        vertical-align:top;
        width:285px;
    }

    div#mainContainer div.subContainer div.contentLeft
    {
        float:left;
        margin-right:45px;
    }

    div#mainContainer div.subContainer div.contentRight
    {
        display:inline;
    }

</style> 
</head>
<body>
<div id="mainContainer">
    <h1>Title</h1>
    <div class="subContainer">
        <div class="contentLeft">
            "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut."
            <p>Bill, New York</p>
        </div>
        <div class="contentRight">
            "Labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation." 
            <p>Fred, Detroit</p>
        </div>
    </div>
    <div class="subContainer">
        <div class="contentLeft">
            "Ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint."
            <p>Sarah, Seattle</p>
        </div>
        <div class="contentRight">
            "Occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut."
            <p>Phil, Austin</p>
        </div>
    </div>
    <div class="subContainer">
        <div class="contentLeft">
            "Labore et dolore magna aliqua. Ut enim ad."
            <p>Jon, Petrolia</p>
        </div>
        <div class="contentRight">
            "Minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia."
            <p>Chris, Burlington</p>
        </div>
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T07:34:12.503

在不偏离您的原始元素的情况下（尽管您向内部元素添加语义含义的建议很好），我通过用以下替换您的元素获得了成功：

```
body
{
    font-family: Verdana;
    font-size: 11px;
}

div#mainContainer
{
    width: 645px;
}

div.subContainer
{
    margin: 30px;
}

div.subContainer div
{
    vertical-align: top;
    float: left;
    width: 285px;
}

div.contentLeft
{
    margin-right: 45px;
} 
```

请注意，您对宽度的计算太低了。我用 IE8 测试了这个，而不是 FF，但它应该可以工作。如果您使用的是 IE8，则内置了一个非常强大的新开发人员工具栏，其中包括一个布局窗格，可在元素的所有侧面显示有效的偏移、边距、边框和填充值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T20:14:47.363

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Title</title>
<style type="text/css">

    body {
        font-family:Verdana;
        font-size:11px;
    }

    #mainContainer {
        width: 600px;
    }

    .quoteBox {
        width: 300px; /* Half the width of the mainContainer to ensure there is always space to exactly TWO quotes on each row */
        float: left;
    }

    .clearer {
        height: 0;
        font-size: 0;
        clear: both; /* Clear the line to ensure no quotes end up partly below another one. Follow the pattern: Two quotes, clear, two quotes, clear etc... */
    }

    blockquote,cite { margin: 12px }

</style> 
</head>
<body>
<div id="mainContainer">
    <h1>Title</h1>
        <div class="quoteBox">
            <blockquote>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut."</blockquote>
            <cite>Bill, New York</cite>
        </div>

        <div class="quoteBox">
            <blockquote>"Labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation." </blockquote>
            <cite>Fred, Detroit</cite>
        </div>

        <div class="clearer">&nbsp;</div>   

        <div class="quoteBox">
            <blockquote>"Ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint."</blockquote>
            <cite>Sarah, Seattle</cite>
        </div>

        <div class="quoteBox">
            <blockquote>"Occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut."</blockquote>
            <cite>Phil, Austin</cite>
        </div>

        <div class="clearer">&nbsp;</div>   

        <div class="quoteBox">
            <blockquote>"Labore et dolore magna aliqua. Ut enim ad."</blockquote>
            <cite>Jon, Petrolia</cite>
        </div>

        <div class="quoteBox">
            <blockquote>"Minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia."</blockquote>
            <cite>Chris, Burlington</cite>
        </div>

</div>
</body>
</html> 
```

比如这样？稍微减少了多余的 DIV 元素的数量，并稍微清理了 CSS。看起来更干净，并且应该按照您描述问题的方式工作。

blockquote 和 cite-elements 用于向文档添加语义。

# c# - 我的 DAL 应该返回 DataTables 还是我......无论如何<>？

> ID：836621
> 
> 赞同：1
> 
> 时间：2009-05-07T19:43:05.240
> 
> 标签：c#, linq, linq-to-sql, n-tier-architecture

## 编辑 1

我很抱歉，但在阅读了 2 篇建议的文章后，我仍然不明白我应该使用什么。我知道由于各种原因不首选使用 IQueryable ，但这是否也消除了 IEnumerable ？DataTable 真的是我最好的选择吗？

简而言之，我猜，首选的返回类型是什么？

* * *

我有以下简单的 LINQ 查询，我想将其抽象为 DAL。var 的类型是什么，因此我的方法应该是什么类型？

```
 ConnectDBDataContext context = new ConnectDBDataContext();

        var lName = textEdit1.Text;

        var searchByPersonLName = from c in context.tblPersons
                                  where c.LastName == lName
                                  orderby c.LastName
                                  select new { c.FirstName,c.LastName,c.PersonID};

        dataGridView1.DataSource = searchByPersonLName; 
```

当我在 VS 中将鼠标悬停在它上面时，它会说`IQueryable<T>`，但是当我放入断点并运行它时，它*似乎*称自己为 IEnumerable。哪个是正确的，我应该如何声明我的方法？

像这样 -->

```
 public static DataTable SearchPerson(string SearhParam)
    {
        ConnectDBDataContext context = new ConnectDBDataContext();
        var persons = (from person in context.tblPersons
                       orderby person.LastName
                       select new { person.PersonID, person.LastName, person.FirstName, person.SSN });
        var filteredPersonsList = persons.Where(p => p.LastName == SearhParam).ToList();
        if (filteredPersonsList.Count == 0)
            filteredPersonsList = persons.Where(p => p.LastName.StartsWith(SearhParam)).ToList();

        var dataTable = filteredPersonsList.CopyLinqToDataTable();

        return dataTable;
    } 
```

如果我使用`IQueryable<T>`什么是`<T>`或者我怎么知道，我会返回什么？

谢谢！

供参考 CopyToDataTable() 如下。

```
public static DataTable CopyLinqToDataTable<T>(this IEnumerable<T> source)
    {
        return new ObjectShredder<T>().Shred(source, null, null);
    }

    public static DataTable CopyLinqToDataTable<T>(this IEnumerable<T> source,
                                                DataTable table, LoadOption? options)
    {
        return new ObjectShredder<T>().Shred(source, table, options);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:53:04.280

首先，IQueryable 实现了 IEnumerable，这就是为什么您可能会同时看到这两者。请参阅[此处了解更多详细信息](https://stackoverflow.com/questions/252785/what-is-the-difference-between-iqueryablet-and-ienumerablet)

一般来说，我会建议您的 DAL 尽可能返回您的实际对象。

我会[阅读此博客](http://weblogs.asp.net/fredriknormen/archive/2008/12/01/returning-iqueryable-lt-t-gt.aspx)以获取有关如何执行以及如何不执行您的建议的指南。简短的回答，不要返回 IQueryable。

编辑：示例：

```
 internal static File[] GetAllFilesByUserID(int userID)
    {
        var db = GetDataContext();
        return (from files in db.Files where files.OwnerUserID == userID select files).ToArray();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T21:57:01.253

他的意思是将您的数据映射到您希望 DAL 返回的对象。

在回答您的第一个问题时，“var”实际上只是变量的缩写，并且类型是分配中定义的任何类型。

```
var myvariable = string.empty; 
```

在此示例中，类型是字符串的类型。

```
var myreader = new StringReader(); 
```

而在此示例中，类型是 StringReader 的类型。

至于你关于“什么是”的第二个问题。T 是泛型类型。

例如，您的 dal 将返回实际对象的位置：

```
 public Product GetProduct(int ProductID)
    {
        var product = from p in db.MyTable
                      where p.productID == ProductID
                      select new product { name = p.name, pricepoint = p.pricepoint, qty = p.quantity };

        return product;
    } 
```

# list - 如何使用内置列表功能“过滤器”

> ID：836630
> 
> 赞同：1
> 
> 时间：2009-05-07T19:45:30.400
> 
> 标签：list, filter, scheme

请帮助我使用 DrScheme 内置功能“过滤器”。

“创建一个函数“hello”，它使用一个数字'Max'和一个数字列表'L'，生成一个小于'Max'的'L'中的数字列表。”

**编辑**取自格式化的评论

这就是我到目前为止所拥有的

```
(define (smaller? n Max) 
  (cond 
    [(> Max n) n] 
    [else empty])) 
(define (hello Max L) 
  (filter smaller? L)) 
```

我不知道如何在函数 hello 中实现 Max。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:00:44.940

使用您的`smaller?`定义，我会选择类似的东西

```
(define (hello Max L)
  (filter (lambda (n) (smaller? n Max)) L)) 
```

这使用了一个 lambda 函数，它是 hello 函数的 Max 参数的闭包。所以它“嵌入”`Max`在用于过滤的 lambda 函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:55:37.310

提示：您可以使用以下命令创建匿名函数`lambda`：

```
(lambda (x) (have-fun-with x)) 
```

*编辑：*另一个提示：`(> Max n)`已经返回一个布尔值，您不需要封闭`cond`结构。

# windows - 为什么我的进程只消耗 5% 的处理器功率？

> ID：836631
> 
> 赞同：2
> 
> 时间：2009-05-07T19:45:30.850
> 
> 标签：windows, multithreading, process, taskmanager

不确定这是否是这个问题的合适位置，但它似乎与线程和系统资源等有关。

为什么当我有 3 个不同的进程在运行时，我的任务管理器显示系统空闲进程正在使用 90% 以上的 CPU 功率！？！？

是因为 I/O 瓶颈吗？

例如，如果我进行 SVN 结账，清空回收站，同时浏览网页，为什么 System Idle 进程为 97%，而其他进程各在 1% 左右？他们似乎都没有真正走得很快。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T19:48:23.980

大多数进程正在等待磁盘或网络操作完成，或等待用户输入。

你可能认为你有一个快速的磁盘或网络连接，但与内存/cpu 相比，它就像走到最近的图书馆，在目录中查找一本书并在书架上找到它，而不是已经在你手中。

这就是为什么您要为高性能服务器上的 10,000 和 15,000 rpm scsi 驱动器（或 SAN 甚至更多）支付数千美元或美元的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T19:49:12.607

我不能肯定地说。但我想说 I/O 瓶颈将是其中很大一部分。事实上，我不认为您描述的任何任务都会占用大量 CPU。

现在，尝试将原始 AVI 文件重新编码为 DIVX 格式，同时在 Maya 中渲染 3D 动画，您的 CPU 应该很忙。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T19:47:17.510

这实际上取决于您的流程在做什么。如果他们是 IO 绑定的，那么他们很可能大部分时间都在等待。

如果它们是等待用户输入的 winforms 应用程序，那么它们就坐在那里，什么也不做，等待输入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T19:54:08.570

SVN 签出和回收站清空都是非常繁重的磁盘活动，对 CPU 的需求并不多，而且 Web 浏览在 CPU 使用率方面非常高（例如，在渲染页面时会出现高峰，但一旦完成，成本就会很低）。

如果你想看到你的 CPU 保持高利用率，做一些几乎完全基于 CPU/内存的事情，比如 Folding@Home。

# visual-studio - 什么是 Visual Studio 开发的最佳源代码控制产品？

> ID：836633
> 
> 赞同：18
> 
> 时间：2009-05-07T19:45:42.363
> 
> 标签：visual-studio, version-control

我在一家仍在使用 VSS 2005 进行源代码控制的 Visual Studio/.NET 商店工作。我们正在寻求升级到 VS Team Foundation Server 并使用它的源代码控制系统，但我很好奇这是否真的是最好的选择。StackOverflow 的创建者使用 Subversion，但评论说将代码分叉合并回主要产品是一种痛苦（在播客 #52 中讨论）。Joel 提到在 Fog Creek 使用 Mercurial。知道 Joel 有点像软件势利小人，他选择 Mercurial 而不是微软的任何产品，我想我会向 StackOverflow 的观众提出一个问题：哪个源代码控制产品最适合**Visual Studio**开发人员？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-07T20:03:01.060

我们从 VSS 切换到 SVN，很长一段时间只使用[TortoiseSVN](http://tortoisesvn.tigris.org)。最近我们开始使用 VS 的[VisualSVN](http://www.visualsvn.com)插件（不幸的是不是免费的）。

我必须说，在克服了 VS 中没有源代码控制集成的最初痛苦之后，我真的很喜欢我对所有源代码控制操作的控制水平。我强烈推荐这条路线。

如果您使用 Subversion 并且必须具有源代码控制集成，我强烈推荐 VisualSVN。

如果您想尝试 SVN，您可以安装非常免费（并且非常容易设置）[的 VisaulSVN Server](http://www.visualsvn.com/server/)产品，并在几分钟内让 SVN 在 Windows 服务器上运行。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-08T05:31:37.150

我的建议是[SourceGear Vault](http://www.sourcegear.com/vault/)。它与 Visual Source(un)Safe 足够接近，可以立即感到“舒适”，它坚如磐石（基于 SQL Server 构建，也可以解决您的备份问题），非常可靠，对分支和合并有很好的支持 - 所有周围的好东西。

对于最多 2 名开发人员的团队来说，它是免费的，对于更大的团队来说价格合理——比团队系统少得多（当然，它也只是一个源代码控制——而不是整个团队的开发系统）。我们将它与 Fogbugz 错误和问题跟踪器结合使用，该组合放弃了我们需要的所有功能，而且成本更低。

强烈推荐。

马克

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-07T19:54:34.387

您似乎想要进行 VS 集成，但我质疑这样做的原因。

一个好的源代码控制产品不仅具有 VS 集成的更多功能。

您可以让 subversion 与 VS 集成（[Ankh svn](http://ankhsvn.open.collab.net/)和[visualsvn](http://www.visualsvn.com/)），我还使用了稳定并与 VS 集成的[库](http://www.sourcegear.com/vault/)，但我将源代码控制用于除 vs 工作之外的其他事情。

所以我更喜欢在产品之外使用源代码控制。你应该试试看。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-07T20:08:06.163

我使用过 VSS、CVS、SVN 和 TFS。

VSS：跳过它。我已经失去了太多的变化，这些变化实际上已经消失了。

CVS：很好的解决方案。有一个功能 SVN 缺少合并的视觉效果。

SVN：很好的解决方案。如果需要，您可以获取要集成的插件。我只有一个抱怨：​​分支之间的合并可能会更好。但是，该产品是轰炸机并且非常实惠。

TFS：在我工作的地方，他们并没有做太多事情。他们只使用源代码控制。我很高兴使用它，尤其是搁架，但我无法将更改合并到分支。我会说这几乎就是VSS应该是的。有时，MS 过于努力地为您做一些您必须为自己做的事情。此外，用户界面也不直观。

所以，我会坚持使用 SVN。不过，新的开源标准似乎是 GIT（虽然无法评论）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-07T19:56:01.387

源代码控制**只是**VS Team Foundation Server 的一部分，它是一个完整的项目管理系统。

我同时使用了 SVN 和 TFS，它们都比 VSS 更稳定、更健壮。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-07T20:06:11.927

来自 VSS的*任何*系统都将是一种改进；-)

[Perforce](http://en.wikipedia.org/wiki/Perforce)可能是我用过的最好的主流工具。Rational Apex 甚至更好，但除非您正在编写 Ada，否则这些信息对您毫无用处。

[ClearCase](http://en.wikipedia.org/wiki/ClearCase)非常强大，但我发现它很难使用（诚然，我只使用了几周，所以我可能没有给它一个公平的试用）。

对于成本（免费）SVN 非常好。Tortoise shell 插件使它在 Windows 中非常容易使用。

编辑。

我看到我刚刚从这个古老的答案中得到了赞成:-) 这让我重新审视，我发现我需要更新我的答案。

我现在在工作中使用 TFS，我真的很喜欢它，它是一个大野兽，也许不适合家庭项目，但它是一个商业工具，如果你真的重视 VS 集成，值得一看。我确信 Perforce 和 Clear Case 仍然是很棒的产品，但我现在与这些产品脱节了。

对于较小的项目或在家中的个人工作，我现在使用 Git。虽然我并不特别关心 VS 集成，我只是从命令行使用它，但是在家里我在几个不同的环境之间切换，所以 VS 集成不是优先事项。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-07T20:07:02.047

我对 Ankhsvn 很幸运。我可以将它与 TortoiseSVN 互换使用，它在与 Visual Studio 和项目布局紧密集成方面做得很好。

[http://ankhsvn.open.collab.net/](http://ankhsvn.open.collab.net/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-07-03T09:00:07.387

我们在工作中使用[plasticscm](http://www.plasticscm.com/screenshots/gui27/visualstudio/int-vs03.jpg)，它鲜为人知，但很好地集成到 VS 中，您可以在内部拥有所有选项和图表。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-08T05:56:29.557

SVN 比 VSS 更好更快。我们在 2 年前从 VSS 切换到 SVN，因为 VSS 在纽约的服务器上，而 VSS 上的操作对于印度的开发人员来说似乎太慢了。SVN 更快，因为它适用于 WAN，而不是适用于 LAN 的 VSS。[参考这个链接](http://subversionee.blogspot.com/2007/08/get-wan-out-of-way.html)

您可以使用 Windows 资源管理器执行 SVN 操作，也可以使用 AnkhSVN 从 VS.Net IDE 执行 SVN 操作。

如果您发现稍后合并文件很麻烦，您可以更喜欢在编辑之前锁定文件。但是恕我直言，合并真的不那么痛苦，因为在继续合并之前，您可以看到您和您的同事代码之间的明显区别。

SVN 的优点可以在[这里](https://stackoverflow.com/questions/690766/vss-or-svn-for-a-net-project)找到堆栈溢出。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-08T06:08:15.440

+1 忘记 VS 集成。

许多最好的源代码控制工具都有很好的命令行界面。近一年来，我一直很高兴地将 Git 用于 VS 项目。缺点是 Git 需要一个 bash shell，而且它对 Windows 不是很友好。我愿意支付没有 VS 集成的“成本”，以获得所有让生活变得更轻松的高级功能。

我建议尝试一下[Mercurial](http://www.selenic.com/mercurial/)。

我必须补充一点，这个建议更适合个人选择的源代码控制。如果您正在为拥有大量开发人员的大公司寻找源代码控制标准，我会选择更“标准”的选择，例如 Team System、SVN 或 Vault。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-08T21:20:40.387

我更喜欢 TFSVC，因为它与 Team Foundation Server 中的所有其他服务集成在一起。但这取决于你想做什么。如果您想要 ALM 解决方案，这就是您要走的路。我能够设置签入策略、集成构建以及与工作项关联。我喜欢它进行分支和合并的方式。我可以让我的测试人员提交与 TFSVC 中的代码相关的错误工作项。我有可追溯性来查看谁在签入和破坏构建。我可以运行报告并很好地了解项目。一切都协同工作。

我希望这有帮助。

约翰

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-07T19:57:27.623

我们使用保险库，它很好。但是，如果您可以 b/c 它来自 Microsoft，请使用 Team System。他们知道如何处理自己的问题/错误/思维方式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-07T20:00:42.983

我投票支持 TFS。VSS 不仅仅是一种痛苦。我在 VS 之外使用过 SVN，我必须看到它与它一起工作。

使用产品之外的源代码控制？听起来比必要的工作更多。仅仅因为它与 VS 集成并不意味着你不能将它用于其他事情。如果我在 VS 中，我想呆在那里，而不必转到另一个客户端应用程序来获取我的源代码。我喜欢VS可以直接签出。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-08-20T08:10:48.887

这取决于您是在寻找免费的还是商业的版本控制系统。

**Subversion**
使用[Subversion](http://subversion.tigris.org/)，你有很棒的、免费的、开源的[ankhsvn](http://ankhsvn.open.collab.net/)插件，它将 Subversion 与 Visual Studio 集成。整合真是太棒了！

**Mercurial**
如果您需要分布式版本控制，请选择带有[VisualHG](http://visualhg.codeplex.com/)插件的[Mercurial 。](http://mercurial.selenic.com/)Mercurial，与 Git 的合同，是在原生 Windows 支持下开发的，而且 Visual Studio 集成要好得多。

**PlasticSCM**
我见过的最好的Visual Studio 集成有PlasticSCM，这是PlasticSCM 是windows-background 版本控制系统的简单结果。它真的很好用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-04-23T19:27:10.797

我不敢相信没有人提到过 Assembla！它对无限的存储库、无限的用户和 1GB 空间是免费的！

[www.assembla.com](http://www.assembla.com)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-08T15:04:35.130

我在工作中同时使用 Vault 和 TFS。我们使用了 VSS，其他人也遇到了问题，所以当时的负责人决定改用 Vault。我对 Vault 没有任何问题，但其他人在合并和分支方面有一些问题。

我开始使用 TFS 试用版，并且和 Vault 一样喜欢它。我还没有使用许多附加功能，例如错误和工作项跟踪，但计划使用。

由于您没有提到成本，而且公司已经在考虑迁移到 TFS，我认为这将满足您获得比 VSS 更好的产品的需求，并让您在未来成长为它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-07T20:00:24.497

也许您应该问问自己，什么 scm 最适合您的项目。

我喜欢 svn 因为它的自由和标准（也许有点大胆说）。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-02-13T23:57:02.137

我用过**Visual Source Safe** (2005)，我不推荐它。作为基于文件文件的解决方案会导致存储库更容易损坏的风险。我使用了**Source Off-Site**一个 SourceGear 产品，它可以通过 Internet 进行远程 VSS 签入和签出，它运行良好，但仍然存在构建在 VSS 和平面文件架构之上的缺点。

SourceGear 还制作了**Vault**，这是我的首选解决方案。它是一个基于 SQL Server 的存储库，因此不受 Windows 文件系统问题的影响。恢复和备份可以像任何其他 SQL Server 数据库一样进行配置，并且您可以恢复到某个时间点，而不仅仅是您上次备份的日期。

我还使用过**Source Anywhere**（2.2 版），与 VSS 和 Vault 相比，我发现它缺少一些功能。但它是一个 SQL Server 解决方案，它使备份更加可靠。

我有兴趣尝试**Subversion**，如果有使用 SQL Server 作为存储库的 Subversion 版本，我认为这将是一个合理的解决方案。如果您在其他操作系统上运行，Subversion 可能是您的最佳选择，但如果您在 Windows Server 上运行，我建议您使用 SQL Server 解决方案。

# storage - 存储签名的道德规范

> ID：836634
> 
> 赞同：3
> 
> 时间：2009-05-07T19:45:50.523
> 
> 标签：storage

我正在开发一款软件，该软件可以创建合同并通过 gif 捕获客户的签名并将其应用于合同（并输出 pdf）。现在，我们正在存储合同中的数据，但是当涉及到签名时，我不确定我是否应该这样做。

存储它： 优点：如果 pdf 文档丢失，我可以立即轻松地为任何需要它的人（我们或客户）重建文档。（与律师核实，只要没有数据发生或已经改变，从数据重建文件是合法且适用的）

缺点：虽然我永远不会对存储的签名做任何事情，但我不能确定，如果我离开公司，我的同事或替代者会尊重这一点。

不要存储它：优点：道德制高点，现在或将来任何人都没有选择使用该图像并对其进行任何操作。它让每个人都诚实。

缺点：如果 pdf 丢失，现在无法重建原始文档 - 这是一个很好的可能性。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T19:48:12.280

1.  与律师交谈。
2.  如果它的区域足够灰色，我会投票支持不要存储它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T19:51:12.943

在这种情况下，律师是最重要的谈话对象。但我仍然会说不要存储它。如有必要，我建议以您无法从中提取原始 GIF 的格式存储合同。例如为整个文档获取一个 png 文件，或者其他一些解决方案。

但是，如果您要存储嵌入签名的整个文档（并且不可提取），那么您可以重新发送签名，并且您没有理由存储未附加的 GIF。

最终，拥有未附加的 GIF 只是为被起诉提供了一个巨大的机会。

以这种方式存储它们也会使您面临与“将错误的 GIF 粘贴到合同中”相关的问题。

我想说的是，以一种不明确地将它们绑定到它们适用的 ONE 合同的方式拥有 gif 文件是非常危险的。

**编辑**

再次阅读您的帖子后，我会说存储 GIF 或 PDF 没有意义。您应该在已签署文件的某处有一份硬拷贝（如果您丢失了合同的硬拷贝，则存在严重的组织问题），之后，您不再需要*签署*的版本，您只需要知道条款的合同。因此，只要您可以重建阅读条款，那么我不明白为什么您需要再次使用文字签名。如果您需要证明他们签名，请返回硬拷贝。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T19:56:02.823

您是否需要保留签名以用于其他任何事情？如果不是，我只会将其存储到生成 PDF 所需的时间，因为没有理由保留它。

在新西兰，个人数据的收集受《隐私法》管辖，因此其要求之一是数据仅存储在收集数据所需的时间长度内。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T19:49:01.890

仍然可以从 PDF 中提取签名。因此，从安全角度来看，您是否存储原始 GIF 似乎并没有什么不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T20:09:15.413

想想这个怎么样：

如果它是电子签名，您可能根本无法/不允许存储它。您可以存储签名+文档（即初始文档的加密签名哈希）并使用公钥验证它，但要存储大量客户的私钥以便能够重新签署文档。

想象一下有人闯入数据库并窃取了那些私钥（gif 或 RSA/DSA 密钥）。那家商店对犯罪组织非常有用/有利可图。

你想暴露自己吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T19:49:40.357

我不知道，任何人都可以使用文档副本和扫描仪重新创建 GIF……不存储您将失去拥有它的好处，而没有添加任何真正的安全价值……

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T19:53:06.683

我会就一些文本在最终文件的签名附近获得法律建议。也许是这样的：

[约翰汉考克 http://rightzinger.com/LibraryofProgress/FoundingFathers/John_Hancock_signature.gif](http://rightzinger.com/LibraryofProgress/FoundingFathers/John_Hancock_signature.gif)

*（电子签名）*

# actionscript-3 - 我可以通过 Flash CS4 与 GPU 进行多少交互？

> ID：836635
> 
> 赞同：2
> 
> 时间：2009-05-07T19:45:55.000
> 
> 标签：actionscript-3, flash-cs4, flashplayer-10

你们中的许多人最可能知道 Flash CS4 与 GPU 集成。我的问题是，有没有一种方法可以让你的所有渲染都在 GPU 上执行，或者我不能获得那么多访问权限。

我问的原因是关于 Flash 3D，几乎所有现有引擎都是软件渲染器。但是，我想在这些现有引擎之一的基础上工作，并将其转换为尽可能多的硬件渲染器。感谢您的输入问候标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T05:21:19.453

首先，硬件加速的不是 Flash CS4，而是 Flash Player 10。

显然“播放器将所有光栅内容渲染（图形效果、过滤器、3D 对象、视频等）卸载到视频卡”。它会自动执行此操作。我认为你没有太多选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T07:53:06.360

Flash Player 10 的新 GPU 加速功能对于开发人员来说是无法访问的，它只是“在你的头上”完成的加速 blitting。

最接近硬件的是[Pixel Bender 过滤器](http://labs.adobe.com/technologies/pixelbender/)。它们基本上相当于 Flash 的像素着色器。但是，由于（afaik）跨平台一致性问题，这些在 Flash 播放器中运行时实际上*并没有*在 GPU 上运行（它们在其他 adobe 产品中可用，有些确实在 gpu 上运行）。

因此，就*真正的*硬件加速而言，选择非常少。

如果您需要获得所有性能，[Alchemy](http://labs.adobe.com/technologies/alchemy/)可能值得一试，这是一个允许将 c/c++ 代码交叉编译到 AVM2（运行 actionscript3 的虚拟机）的项目。这做了一些漂亮的技巧来提高性能（由于这些语言的非动态性质）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-06T12:44:32.530

等待明年上半年 Flash Player 11 作为测试版发布。这将是一个很棒的。

# c# - TextImageRelation 实现

> ID：836645
> 
> 赞同：0
> 
> 时间：2009-05-07T19:48:01.797
> 
> 标签：c#, button

有谁知道有关在按钮上实现 TextImageRelation 属性的任何信息？由于无需绘制前景就不可能绘制自定义背景，因此我至少需要了解算法的工作原理。

我找不到任何关于它的信息。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T06:56:51.393

Your question could use a few more details. I presume you are talking about writing your own implementation of a ToolStripButton? MSDN has a pretty thorough example of how to implement a ToolStripItem (which is the basis for ToolStripButton), including how the TextImageRelation property would be used. Look at the `ComputeImageAndTextLayout()` method in the example for specifics. I don't understand from your question how the custom background & foreground painting is a problem.

# eclipse - 从 NetBeans 迁移到 Eclipse

> ID：836647
> 
> 赞同：28
> 
> 时间：2009-05-07T19:48:16.460
> 
> 标签：eclipse, netbeans, migration

我的公司想要迁移到 Eclipse，我想知道除了 Ant 构建之外还有哪些选项可以将我们的项目从 Netbeans 迁移到 Eclipse。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-09-03T11:09:21.940

太... oooo .... 回答太晚了，但这有效

[http://www.coderanch.com/t/458555/vc/Export-Netbeans-Eclipse](http://www.coderanch.com/t/458555/vc/Export-Netbeans-Eclipse)

我正在寻找自己的答案并看到了这个问题:)

报价：

> > *这是关于“将项目从 NetBeans 导入 Eclipse”的小教程。*
> > 
> > *请试试这个：*
> 
> 第一部分 - NETBEANS
> 
> 1.  打开 NebBeans。
> 2.  创建一个名为“ToEclipse”的 java 项目。
> 3.  构建这个项目。
> 
> 然后，NetBeans 创建了几个文件夹。对我们来说重要的文件夹是（在我的电脑中）：
> 
> *   `c:\User\Almir\NetBeans\ToEclipse\dist`
> *   `c:\User\Almir\NetBeans\ToEclipse\src`
> 
> 第二部分 - 日食
> 
> 1.  转到日食。
> 2.  在 Eclipse 中创建一个名为“ToEclipse”的 java 项目。
> 
> 然后，Eclipse 创建了几个文件夹。对我们来说重要的文件夹是（在我的电脑中）：
> 
> *   `c:\Users\Almir\Eclipse\ToEclipse\bin`
> *   `c:\Users\Almir\Eclipse\ToEclipse\src`
> 
> 第 III 部分 - WINDOWS 浏览器
> 
> 1.  转到 Windows 资源管理器。
> 2.  在文件夹中复制文件“ToEclipse.jar” `c:\Users\Almir\Eclipse\ToEclipse\bin`。
> 3.  过去它`c:\Users\Almir\Eclipse\ToEclipse\bin`
> 4.  在文件夹中复制文件夹“toeclipse” `c:\User\Almir\NetBeans\ToEclipse\src`。将其粘贴到 b)`c:\Users\Almir\Eclipse\ToEclipse\src`文件夹中。
> 
> 第四部分 - 日食
> 
> 1.  转到日食。
> 2.  按`F5`刷新视图。
> 3.  验证您的项目是否存在（在 下`ToEclipse/src/toeclipse`）。
> 4.  说“哦！是的！它有效！”。
> 5.  运行项目。
> 6.  返回3）你想要多少次！
> 
> > *希望对你有帮助！*
> > 
> > *亲切的问候，Almir Campos 圣保罗，巴西。*

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-07-03T14:51:31.720

我找到了另一种更简单的方法，至少对我有用，因为由于缺少 javac，我在导入 Ant 构建脚本时遇到了问题。

假设您在***D:/blah/中有您的 Netbeans 项目（src、build、dist 等）***

![在此处输入图像描述](https://i.stack.imgur.com/stapz.png)

在 Eclipse 中，转到 File->New->Java Project

取消选中“使用默认位置”，而是使用 Netbeans 项目所在的路径 ( *D:/blah/* ) Eclipse 应该自动填充其他所有内容并链接到文件。

![在此处输入图像描述](https://i.stack.imgur.com/EdWR8.png)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-07T19:53:48.633

我最近从 Netbeans“迁移”到 Eclipse，发现它非常简单。之所以简单，是因为我们所有的项目都是独立于 IDE 的标准 ant 和 ivy 构建脚本，大多数现代 IDE 都可以理解。这样，我们都可以使用我们喜欢的 IDE（是的 - emacs 和 vi 也是），而且它们不是“迁移”问题。

我指出这一点的原因是，如果还不是这样，我建议您在迁移时采用相同的路径。只需创建一些标准的 ant（和 ivy）构建脚本。Eclipse 知道如何吸纳这些内容，并且不会有未来的迁移问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-25T17:09:56.237

根据我的个人经验，这很容易。我正在将一个 java 桌面应用程序从 netbeans 迁移到 eclipse。只需将我的项目复制到工作区中，在 eclipse 中将项目创建为新的 java 项目，并将项目的相同名称放在 netbeans 中（使用您的工作区作为位置）。它将识别项目结构（Eclipse Helios，Netbeans 6.8）

希望这可以帮助。如果你有另一种项目，我不知道它会变得多么困难。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-11-05T06:38:42.547

我刚刚将一个 Netbeans 7.0 JSF Web 项目迁移到 Eclipse。这比我想象的要容易。我所做的是：

1.  项目清单
2.  在 netbeans 中清理并构建我的 JSF 应用程序
3.  关闭 netbeans 并打开 Eclipse（我使用 galileo）
4.  创建一个新的动态 Web 应用程序。
5.  右键单击项目资源管理器中的新 Web 应用程序，然后转到导入然后到 .WAR 文件
6.  然后它询问我是否要将任何 jar 文件（库）作为项目导入，我不选择任何文件，只需单击完成。
7.  将我的 netbeans src(source) 文件夹 /src/java/ 复制到 Eclipse src 文件夹。例如 netbeansproject/medman/src/java/com 到 eclipseSpace/medman/src/
8.  接下来在 Eclipse 中设置您的服务器（我使用的是 tomcat 6.0）。

瞧！它完成了。

您也可以查看此链接。[http://www.coderanch.com/t/458555/vc/Export-Netbeans-Eclipse](http://www.coderanch.com/t/458555/vc/Export-Netbeans-Eclipse)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T21:31:03.343

在我公司，人们几乎都使用 eclipse 或 Netbeans。我自己将它们都用于各种任务。我们编写自己的 ant 脚本来构建和打包我们的源代码，因此人们使用什么 IDE 并不重要。我建议您创建自己的 ant 脚本来构建源代码，这样您就不必依赖 IDE 特定的构建脚本。

# ruby - ruby ERB模板调试，显示为ruby

> ID：836656
> 
> 赞同：1
> 
> 时间：2009-05-07T19:49:05.133
> 
> 标签：ruby, templates, erb

**问题：**不是从我的 ERB 模板获取转换后的输出，而是有一个参数、设置或 hack 我可以使用来输出在转换运行之前生成的原始 ruby​​ 代码吗？

**理由：**我无法找出 ERB 模板语法错误的问题，我想查看由 ERB 生成的普通 ruby​​ 代码。如果其他人有任何替代方法来调试和跟踪 ERB 中的特定问题，请加入。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T19:55:32.013

您可以通过 debug(@object) 获取有关您正在使用的对象的信息。这可能有助于准确了解您正在使用什么以及您可以使用它做什么。

# performance - 计算密集型程序的性能测试

> ID：836661
> 
> 赞同：2
> 
> 时间：2009-05-07T19:49:33.633
> 
> 标签：performance, math

有哪些好的技巧和/或技术可以优化和提高计算量大的程序的性能。我说的是复杂的图形计算或数学和模拟类型的编程，其中节省的每一秒都是有用的，而不是只有一定量的加速是有帮助的 IO 繁重的程序。

虽然在这里经常提到更改算法是最有效的方法，但我首先试图找出不同算法的有效性，所以我想尽可能地提高每种算法的效率。我正在解决的“问题”并不是众所周知的，因此网络上的算法很少（如果有的话），但我正在寻找有关如何进行以及寻找什么的任何好的建议。

我正在探索进化算法和针对特定相关问题组的更直接方法之间的有效性差异。我已经为这个问题写了三个进化算法，现在我写了一个蛮力技术，我试图尽可能快地做出来。

编辑：指定更多。我正在使用 C#，我的算法都围绕着计算和解决表达式的约束类型问题（使用表达式树）。我所说的表达式是指诸如 x^2 + 4 之类的东西或任何其他类似的东西，它们将被解析为表达式树。我的算法都创建和操作这些树以试图找到更好的近似值。但我想以一般方式提出这个问题，以防它对其他人有所帮助。

我正在尝试找出是否有可能编写一个有用的进化算法来查找可以很好地近似各种属性的表达式。两者都是因为我想知道一个好的近似值是什么，并看看进化的东西与传统方法相比如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T19:57:33.473

这与任何其他优化的过程几乎相同：配置文件、实验、基准测试、重复。

首先，您必须弄清楚代码的哪些部分占用了时间。然后尝试不同的方法来加速它们（尝试基于优点的方法比随机尝试更好）。基准测试以确定您是否确实加速了它们。如果你这样做了，用新方法替换旧方法。再次配置文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T20:06:07.603

如果有可能以其他方式做到这一点，我建议不要使用蛮力方法。但是，这里有一些指南可以帮助您加快代码速度。

您可以对代码应用很多很多不同的优化，但在您做任何事情之前，您应该分析以找出瓶颈所在。以下是一些分析器，它们可以让您很好地了解代码中的热点位置：

*   [教授](http://www.cs.utah.edu/dept/old/texinfo/as/gprof.html)
*   [性能监视器2](http://perfmon2.sourceforge.net/)
*   [O型材](http://oprofile.sourceforge.net/news/)
*   [高性能计算工具包](http://hpctoolkit.org/)

这些都使用采样来获取数据，因此使用代码运行它们的开销应该是最小的。只有 GProf 要求您重新编译代码。此外，最后三个可让您同时进行时间和[硬件性能计数器](http://en.wikipedia.org/wiki/Hardware_performance_counter)配置文件，因此一旦您进行时间（或 CPU 周期）配置文件，您可以放大较热的区域并找出它们运行缓慢的*原因*（缓存未命中、 FP指令计数*等*）。

除此之外，还需要考虑如何最好地重构代码，这取决于问题所在。可能是您刚刚得到了一个编译器没有很好地优化的循环，您可以内联或将内容移入/移出循环以帮助编译器退出。或者，如果您使用基本算术运算尽可能快地运行，您可能想尝试利用向量指令（SSE 等）。如果您的代码是并行的，您可能会遇到负载平衡问题，您可能需要重构您的代码，以便数据更好地分布在内核之间。

这些只是几个例子。性能优化很复杂，如果您一开始就采用蛮力方法，它可能对您的帮助还不够。

*[有关人们优化事物的方式的更多信息，在最近的Why do you program in assembly](https://stackoverflow.com/questions/791533/why-do-you-program-in-assembly)*中有一些很好的例子？问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T20:06:25.140

如果您的优化问题是（准）凸的或可以转换为这种形式，那么有比进化搜索更有效的算法。

如果您有大型矩​​阵，请注意您的线性代数例程。正确的算法可以将计算时间缩短一个数量级，尤其是在矩阵稀疏的情况下。

想想数据是如何加载到内存中的。即使您认为自己将大部分时间都花在了纯算术上，实际上您也花了大量时间在缓存级别等之间移动内容。在数据处于最快内存中时，尽可能多地处理数据。

尽量避免不必要的内存分配和解除分配。在这里，放弃纯粹的 OO 方法是有意义的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T20:29:28.420

这更像是在算法本身中找到漏洞的提示......

为了实现最佳性能，以牺牲其他一切为代价，简化最内部循环中的所有内容。

保持简单的一个例子是经典的弹跳球动画。您可以通过在物理书中查找定义并插入数字来实现重力，或者您可以这样做并节省宝贵的时钟周期：

```
initialize:
float y = 0; // y coordinate
float yi = 0; // incremental variable

loop:
y += yi;
yi += 0.001;

if (y > 10)
  yi = -yi; 
```

但是现在假设您必须在 N 体模拟中使用嵌套循环来执行此操作，其中每个粒子都被其他粒子吸引。当您处理数千个粒子时，这可能是一项处理器密集型任务。

您当然应该采用与简化最内层循环中的所有内容相同的方法。但更重要的是，在最简单的层面上，您还应该明智地使用数据类型。例如，在处理整数时，数学运算比浮点变量更快。另外，加法比乘法快，乘法比除法快。

因此，考虑到所有这些，您应该能够主要使用整数的加法和乘法来简化最内部的循环。然后你可能需要做的任何缩小都可以在之后完成。以 y 和 yi 为例，如果 yi 是您在内部循环中修改的整数，那么您可以在循环之后按比例缩小它，如下所示：

```
y += yi * 0.01; 
```

这些是非常基本的低级性能技巧，但是当我使用处理器密集型算法时，我会尽量记住它们。当然，如果您随后将这些想法应用到 GPU 上的并行处理中，那么您可以将您的算法提升到一个全新的水平。=)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T20:04:21.697

那么你如何做到这一点主要取决于你使用的语言。尽管如此，分析器中任何语言的密钥。分析您的代码。查看哪些功能/操作花费的时间最多，然后确定您是否可以使这些成本高昂的操作更有效率。

数值算法的标准瓶颈是内存使用（您是否按照元素存储在内存中的顺序访问矩阵）；通信开销等。它们可能与其他非数字程序略有不同。

此外，许多其他因素（例如预处理等）可能导致 SAME 算法在同一问题上的性能行为发生巨大差异。确保为您的实现确定最佳参数。

至于比较不同的算法，我建议阅读论文

“性能配置文件的基准优化软件”，Jorge Moré 和 Elizabeth D. Dolan，数学编程 91 (2002)，201-213。

它提供了一种很好、统一的方法来比较应用于同一问题集的不同算法。它真的应该在优化社区之外更广为人知（至少在我看来不是那么谦虚）。

祝你好运！

# iphone - iPhone - int 到 NSData？

> ID：836681
> 
> 赞同：20
> 
> 时间：2009-05-07T19:53:36.323
> 
> 标签：iphone, objective-c, nsdata

我正在制作一个 iPhone 应用程序，我想在其中保存应用程序的状态。这包括一个 int 属性，我将它自己保存到一个文件中。我已经写好并且可以工作了，但我知道我这样做的方式有点笨拙，将 int 转换为 String 然后 NSData。有人可以提出更好的方法吗？

```
int someInt = 1;
NSString *aString = [NSString stringWithFormat:@"%d",someInt];
NSData *someData = [aString dataUsingEncoding:NSUTF8StringEncoding];
[someData writeToFile:[documentsDirectory stringByAppendingString:@"someFile"] atomically:YES]; 
```

然后从磁盘读取它并将其放回 int -

```
NSData* someData = [NSData dataWithContentsOfFile:[documentsDirectory stringByAppendingString:@"someFile"]];
NSString *aString = [[NSString alloc] initWithData:someData encoding:NSUTF8StringEncoding];
int someInt = [aString intValue]; 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-07T19:58:13.397

来写：

```
int i = 1;
NSData *data = [NSData dataWithBytes: &i length: sizeof(i)];
[data writeToFile: [documentsDirectory stringByAppendingString: @"someFile"] atomically: YES] 
```

并回读：

```
NSData *data = [NSData dataWithContentsOfFile: [documentsDirectory stringByAppendingString: @"someFile"]];
int i;
[data getBytes: &i length: sizeof(i)]; 
```

但是，你真的应该使用`NSUserDefaults`这样的东西，在这种情况下你会这样做：

```
[[NSUserDefaults standardUserDefaults] setInteger: i forKey: @"someKey"] 
```

写，和

```
int i = [[NSUserDefaults standardUserDefaults] integerForKey: @"someKey"]; 
```

读书。

# jquery - JQuery - 将更改事件添加到下拉列表

> ID：836694
> 
> 赞同：17
> 
> 时间：2009-05-07T19:54:45.010
> 
> 标签：jquery

我的下拉菜单的底层 HTML 有可能发生变化，我试图使用`.live`选项而不是`.change`选项来设置它。它对我不起作用。

我目前拥有的是：

```
$("#ItemsPerPage").change(function(e) { return updatePaging(); }); 
```

不幸的是，如果我通过它更新此控件`$.ajax`会丢失事件定义。我尝试过但不起作用的是：

```
$("#ItemsPerPage").live("change", function(e) { return updatePaging(); }); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-07T20:17:14.707

与其`<select>`每次都重新绑定，不如只交换它的内容（`<option>`元素列表）。

所以像你一样使用它：

```
$("#ItemsPerPage").change(function(e) { return updatePaging(); }); 
```

但是当你更新它时，只需换掉它的内容（`newSelectElement`新`<select>`元素在哪里）：

```
function updateItemsPerPage( newSelectElement ) {
    $("#ItemsPerPage").empty().append( newSelectElement.childNodes );
} 
```

这样，绑定就不需要刷新，因为节点本身没有被交换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T20:38:56.043

要详细说明 samiz 的建议，您需要执行以下操作：

```
$(function() {
    bind_items_per_page();
});

function bind_items_per_page() {
    $("#ItemsPerPage").unbind('change').bind('change',function() { 
        updatePaging(); 
    });
}

function updatePaging() {
    $.post('/some/script',{foo:'bar',bar:'foo'},function(data) {
        /* what ever you need to do */
        // And assuming what ever you did above changed your select box...
        bind_items_per_page();
    });
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T20:01:14.777

live() 不支持更改事件。在每个重新分配事件定义的 AJAX 调用结束时运行一个函数怎么样？

# php - 我应该在哪里设置我的模型中的数据库对象？(MVC)

> ID：836699
> 
> 赞同：1
> 
> 时间：2009-05-07T19:55:48.720
> 
> 标签：php, model-view-controller, oop

我想知道用我的模型设置我的数据库对象的最佳位置在哪里。

我应该对它进行硬编码，因为我的模型应该是为一个项目设计的，所以我将它设置在我的构造函数中或我进行初始化的任何地方？或者我应该在实例化我的对象时将我的 db 对象传递给我的构造函数吗？

什么是最好的方法，我的意思是来自实验用户，并且高效，让我使用起来更加舒适？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T20:19:40.300

几件事：

1.  大多数使用数据库连接的 PHP 项目使用[单例模式](http://us2.php.net/singleton)表示该数据库，如果您不确定这是什么，请阅读它。

2.  通常，我在配置文件中定义我的数据库连接，该配置文件可以在环境（开发、阶段、生产）之间轻松更改。

3.  然后，我将使用上述单例模式和配置文件在引导文件中实例化我的数据库连接。

4.  我的模型通常会完全抽象数据库/表数据存储，对于每个模型我会做这样的事情：

引导程序.php

```
$config = load_config_data(ENVIRONMENT);

Db::setDefaultAdapter($config['database']); 
```

模型/表/User.php

```
class Table_User extends Db_Table 
{
  // Table name
  protected $_name = 'user';

  /* Do a bunch of database specific stuff */
} 
```

模型/用户.php

```
class User extends Model 
{
  public function updateUsername($userid, $username)
  {
    // Uses default adapter, Singleton pattern!
    $table = Db::loadTable('user');
    $table->update(
      array('username'=>$username),
      Db::quoteInto('userid = ?', $userid)
    );
  }
} 
```

这几乎是对[Zend Framework MVC中的](http://framework.zend.com/manual/en/zend.controller.html)[模型](http://framework.zend.com/manual/en/zend.db.table.html)的介绍，我会查看它以了解有关如何组织代码的一些想法（或者为自己省点麻烦并实际使用该[框架](http://framework.zend.com)。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:04:20.493

为了可测试性，您应该将其传递给构造函数，而不是对其进行硬编码。这有助于您编写单元测试，因为您可以模拟您的数据库对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:02:40.547

我不会对其进行硬编码，即使代码从未用于另一个项目，只是从测试数据库移动到实时数据库可能需要在模型类中定位和更改代码。这会更好地放在某种配置文件中。

就个人而言，我会在您用作引导程序的任何内容中定义 db 对象 - 然后让模型使用该单个对象。

# .net - 触发器集合成员必须是 EventTrigger 类型

> ID：836703
> 
> 赞同：32
> 
> 时间：2009-05-07T19:56:06.567
> 
> 标签：.net, wpf, datatrigger

我创建了一个 UserControl，类似于以下内容：

```
<UserControl>
    <StackPanel Orientation="Vertical">
        <StackPanel x:Name="Launch" Orientation="Horizontal" Visibility="Collapsed">
            <!-- Children here -->
        </StackPanel>
        <ToggleButton x:Name="ToggleLaunch" IsChecked="False" Content="Launch"/>
    </StackPanel>
</UserControl> 
```

我一直在尝试使用 DataTrigger 使“启动”StackPanel 在选中 ToggleButton 时变得可见，否则保持折叠状态。但是，在运行时，我收到一条错误消息，指出“对象初始化失败 (ISupportInitialize.EndInit)。触发器集合成员必须是 EventTrigger 类型”。我尝试将它添加到 UserControl 和 StackPanel 的触发器集合中，但没有成功。我的触发器 XAML 如下所示：

```
<DataTrigger Binding="{Binding ElementName=ToggleLaunch, Path=IsChecked}" Value="True">
    <Setter TargetName="Launch" Property="UIElement.Visibility" Value="Visible"/>
</DataTrigger> 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2014-09-20T17:39:31.900

来自[MSDN Docs](http://msdn.microsoft.com/en-us/library/system.windows.datatrigger.aspx)，根据 Richard C. McGuire 的（稍微转述的）回答：

> DataTriggers 可以与 XML 标签*Style*、*ControlTemplate*和*DataTemplate一起使用*

例如，如果您尝试向 a 添加触发器`TextBlock`，则会生成以下错误：

> *错误：触发器集合成员必须是 EventTrigger 类型*

为什么？A`Trigger`只能放在 a或中`Style`，而我们正试图将它直接放在 a中。`ControlTemplate``DataTemplate``TextBlock`

在这种情况下，修复很简单：**只需将触发器包装在 style**中，然后将此样式放在 中`TextBlock`，错误就会消失。

这是修复*之前生成错误的 XAML：*

```
<TextBlock x:Name="Hello" Text="{Binding Hello, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
  <TextBlock.Triggers>
      <DataTrigger Binding="{Binding Hello}" Value="GoGreen">
          <Setter Property="Foreground" Value="Green" />
      </DataTrigger>
  </TextBlock.Triggers>
</TextBlock> 
```

这是修复*后*的 XAML ：

```
<TextBlock x:Name="Hello" Text="{Binding Hello, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
    <TextBlock.Style>
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="Red" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding Hello}" Value="GoGreen">
                    <Setter Property="Foreground" Value="Green" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock> 
```

这是一个示例屏幕截图，显示如果我们输入`GoGreen`，文本变为绿色：

![在此处输入图像描述](https://i.stack.imgur.com/ilpq1.png)

...如果我们输入其他内容，则文本默认为红色：

![在此处输入图像描述](https://i.stack.imgur.com/fNaPW.png)

网络上有大量关于 WPF 触发器的免费材料，所有这些材料都很好地解释了这个概念，而[这个页面让我一分钱一分货](http://www.wpf-tutorial.com/styles/trigger-datatrigger-event-trigger/)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-07T20:10:33.460

设法弄清楚了。[根据MSDN Docs](http://msdn.microsoft.com/en-us/library/system.windows.datatrigger.aspx)，忘记了 DataTriggers 是为 Style、ControlTemplate 和 DataTemplate 设计的。

解决方案是使用 EventTrigger 作为错误消息指示。我的解决方案如下：

```
<EventTrigger RoutedEvent="ToggleButton.Checked">
    <BeginStoryboard>
        <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility"
                                           Storyboard.TargetName="LaunchButtons">
                <DiscreteObjectKeyFrame KeyTime="0:0:0"
                                        Value="{x:Static Visibility.Visible}" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
    </BeginStoryboard>
</EventTrigger>
<EventTrigger RoutedEvent="ToggleButton.Unchecked">
    <BeginStoryboard>
        <Storyboard>
            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility"
                                           Storyboard.TargetName="LaunchButtons">
                <DiscreteObjectKeyFrame KeyTime="0:0:0"
                                        Value="{x:Static Visibility.Collapsed}" />
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>
    </BeginStoryboard>
 </EventTrigger> 
```

如果其他人有其他解决方案，请推迟将其标记为答案。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T21:06:31.530

您还可以将堆栈面板中的 Visibility 绑定到 ToggleButton 中的 IsChecked 属性。您需要使用自定义 ValueConverter。这是我在网上找到的一个：

```
/// <summary>  
/// WPF/Silverlight ValueConverter : Convert boolean to XAML Visibility
/// </summary>  
[ValueConversion(typeof(bool), typeof(Visibility))]
public class VisibilityConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture) =>
        value != null && (bool)value ? Visibility.Visible : Visibility.Collapsed;

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture) =>
        (Visibility)value == Visibility.Visible;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-07-18T13:06:10.153

这可能已经过时了，但以下对我有用。它可能会帮助人们遇到以下问题：“触发器集合成员必须是 EventTrigger 类型”

```
<Control>
  <Control.Template>
    <ControlTemplate >

      <!-- Design -->
      <StackPanel>
        <CheckBox Name="CollapseControl" Content="Show" IsChecked="False" />
        <Label Name="CollapseTarget" Content="MyContent" Visibility="Collapsed" />
      </StackPanel>

      <!-- Triggers -->
      <ControlTemplate.Triggers >
        <Trigger SourceName="CollapseControl" Property="IsChecked" Value="True" >
          <Setter TargetName="CollapseTarget" Property="Visibility" Value="Visible" />
        </Trigger>
      </ControlTemplate.Triggers>

    </ControlTemplate>
  </Control.Template>
</Control> 
```

在 Control 对象中封装“您想要控制的内容”允许您使用 Control.Template 来使用您想要的任何触发器。这样，您可以直接在您想要的 XAML 中使用（数据）触发器，而无需定义静态样式或全新的 UserControl。

# java - 在java中打印正则表达式匹配

> ID：836704
> 
> 赞同：7
> 
> 时间：2009-05-07T19:56:50.387
> 
> 标签：java, regex

所以我有一个 IP 地址作为字符串。我有这个正则表达式`(\d{1-3})\.(\d{1-3})\.(\d{1-3})\.(\d{1-3})` 如何打印匹配组？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-07T20:04:59.527

```
import java.util.regex.*;
try {
    Pattern regex = Pattern.compile("(\\d\\{1-3\\})\\.(\\d\\{1-3\\})\\.(\\d\\{1-3\\})\\.(\\d\\{1-3\\})");
    Matcher regexMatcher = regex.matcher(subjectString);
    while (regexMatcher.find()) {
        for (int i = 1; i <= regexMatcher.groupCount(); i++) {
            // matched text: regexMatcher.group(i)
            // match start: regexMatcher.start(i)
            // match end: regexMatcher.end(i)
        }
    } 
} catch (PatternSyntaxException ex) {
    // Syntax error in the regular expression
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T20:04:28.950

[如果你使用 Pattern 和 Matcher 来做你的正则表达式，那么你可以使用group(int group)](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#group(int))方法询问每个组的 Matcher

所以：

```
Pattern p = Pattern.compile("(\\d{1-3}).(\\d{1-3}).(\\d{1-3}).(\\d{1-3})"); 
Matcher m = p.matcher("127.0.0.1"); 
if (m.matches()) {   
  System.out.print(m.group(1));  
  // m.group(0) is the entire matched item, not the first group.
  // etc... 
} 
```

# java - 为什么所有 java 方法都是隐式可覆盖的？

> ID：836705
> 
> 赞同：21
> 
> 时间：2009-05-07T19:56:51.200
> 
> 标签：java, c++, virtual-functions

在 C++ 中，我必须显式指定“虚拟”关键字以使成员函数“可覆盖”，因为当成员函数可覆盖时，会产生创建虚拟表和 vpointer 的开销（因此每个成员函数对于性能原因）。

当子类提供具有相同名称和签名的单独实现时，它还允许隐藏成员函数（如果未覆盖）。

C# 中也使用了相同的技术。我想知道为什么 Java 放弃了这种行为，并且默认情况下使每个方法都可以覆盖，并提供了在显式使用“final”关键字时禁用覆盖行为的能力。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-07T20:23:50.557

更好的问题可能是“为什么 C# 有非虚拟方法？” 或者至少，为什么默认情况下它们不是虚拟的，并且可以选择将它们标记为非虚拟？

在 C++ 中，有一个想法（正如 Brian 很好地指出的那样），如果你不想要它，你就不用付钱。问题是，如果你确实想要它，这通常意味着你最终会为此付出代价。在大多数 Java 实现中，它们是为大量虚拟调用而明确设计的；vtable 实现往往很快，几乎不比非虚拟调用贵，这意味着失去了非虚拟函数的主要优势。此外，JIT 编译器可以在运行时内联虚函数。因此，出于效率原因，实际上几乎没有理由*使用*非虚拟函数。

因此，它在很大程度上归结为最小意外原则。它告诉我们所有方法的行为方式都相同，不是一半是虚拟的，一半是非虚拟的。由于我们至少需要一些虚拟方法来实现这种多态性，所以让它们都是虚拟的是有意义的。此外，具有相同签名的两种方法只是要求在脚上开枪。

多态性还规定对象本身应该可以控制它所做的事情。它的行为不应该取决于客户认为它是 FooParent 还是 FooChild。

编辑：所以我被要求发表我的主张。下一段是我的推测，而不是事实陈述。

所有这一切的一个有趣的副作用是 Java 程序员倾向于大量使用接口。由于虚方法优化使接口的成本基本上不存在，它们允许您使用 List（例如）而不是 ArrayList，并在以后通过简单的一行更改将其切换为 LinkedList没有额外的罚款。

编辑：我还会提供一些资源。虽然不是原始来源，但它们确实来自 Sun，解释了 HotSpot 的一些工作原理。

[内联](http://java.sun.com/developer/technicalArticles/Networking/HotSpot/inlining.html)

[虚拟表](http://wikis.sun.com/display/HotSpotInternals/VirtualCalls)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-07T19:58:46.310

取自[这里](http://www.javacoffeebreak.com/articles/thinkinginjava/comparingc++andjava.html)(#34)

> Java 中没有 virtual 关键字，因为所有非静态方法总是使用动态绑定。在 Java 中，程序员不必决定是否使用动态绑定。C++ 中存在 virtual 的原因是，当您调整性能时，您可以将其关闭以稍微提高效率（或者，换句话说，“如果您不使用它，您就不会为此付费” )，这通常会导致混乱和令人不快的意外。final 关键字为效率调整提供了一些空间——它告诉编译器这个方法不能被覆盖，因此它可以被静态绑定（并且被内联，因此使用相当于 C++ 非虚拟调用）。这些优化取决于编译器。

可能有点圆。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-07T21:32:56.973

所以 Java 的基本原理可能是这样的：面向对象语言的全部意义在于可以扩展事物。所以就纯粹的设计而言，将可扩展性视为“特例”确实没有什么意义。

请记住，Java 具有在运行时编译的优势。因此，C++ 编译中的一些性能参数被忽略了。在 C++ 中，如果一个类*可能*被覆盖，那么编译器必须采取额外的步骤。在 Java 中，这并不神秘：在任何给定的时刻，**JVM 都知道某个特定的方法/类*是否已*被覆盖**，而这才是最重要的。

请注意，**final**关键字本质上是关于程序设计，而不是优化。JVM 不需要这些信息来查看类/方法是否已被覆盖！！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-08T03:31:02.043

如果问题是要问 java 和 C++/C# 之间更好的方法是什么，那么它已经在另一个线程中以相反的方向讨论过，并且网上有很多资源可用

[为什么 C# 默认将方法实现为非虚拟的？](https://stackoverflow.com/questions/814934/why-c-implements-methods-as-non-virtual-by-default)

[http://www.artima.com/intv/nonvirtual.html](http://www.artima.com/intv/nonvirtual.html)

最近引入的@Override 注释及其在新代码中的广泛采用表明了“为什么所有 java 方法都是隐式可覆盖的？”这个问题的确切答案。确实是因为设计师搞错了。（他们已经修好了）

哦 ！我会为此投反对票。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T20:39:04.403

Java 试图向更动态的语言定义靠拢，在这种定义中，一切都是对象，一切都是虚拟方法。它还希望避免模棱两可和难以理解的构造，它的设计者将其视为 C++ 中的一个缺陷，因此没有运算符重载，在这种情况下，不能在一个类层次结构上拥有两个公共方法签名，根据类型调用不同的方法引用它的变量。

C# 更关心子类的稳定性，并确保子类的行为可预测。C++ 关心性能。

三种不同的设计重点，导致不同的选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T08:01:03.487

我想说的是，与整个 VM 成本相比，虚拟方法的 Java 成本较低。与类似汇编的 C 背景相比，在 C++ 中，它的成本很高。由于 C 到 C++ 的迁移，没有人会决定默认通过指针调用所有方法。变化太大了。

# windows-vista - 在 Windows Vista Ultimate (SP1) 上安装 SQL Server 2008 Express/Developer 版本失败

> ID：836711
> 
> 赞同：0
> 
> 时间：2009-05-07T19:57:39.480
> 
> 标签：windows-vista, installation, sql-server-2008-express

我访问了几个论坛，尝试安装 SQL Server 2008 Express 时除了清除并重新安装操作系统之外的所有方法；每次都卸载失败的安装，清理注册表和安装文件夹，禁用 UAC，清理 WMI 存储库，在需要时重新启动等。

任何解决方案都将非常受欢迎。

我关注的链接之一... [http://mark.michaelis.net/Blog/SQLServer2008InstallNightmare.aspx](http://mark.michaelis.net/Blog/SQLServer2008InstallNightmare.aspx)

查看下面 ../Logs/Detail.txt 文件的摘录，毫不奇怪，Perfmon 工具也会使加载计数器崩溃。Perfmon 工具在安装之前和清理失败的 SQL 安装之后都可以工作。

///////////////////////////////////////// ///////////////////////

2009-05-07 11:50:01 Slp: PerfCounter 调用 lodctr: 'c:\Program Files\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\Binn\perf-MSSQL$SQLEXPRESSsqlctr.ini' 2009-05-07 11: 50:01 Slp：提示用户是否由于以下失败重试此操作：2009-05-07 11:50:01 Slp: ------------------ ---------------------- 2009-05-07 11:50:01 Slp：以下是一个异常堆栈，列出了从最外到最内的顺序 2009- 05-07 11:50:01 Slp：内部异常正在缩进 2009-05-07 11:50:01 Slp：2009-05-07 11:50:01 Slp：异常类型：Microsoft.SqlServer.Configuration.Sco。 ScoException 2009-05-07 11:50:01 Slp：消息：2009-05-07 11:50:01 Slp：系统找不到指定的文件。2009-05-07 11:50:01
2009-05-07 11:50:01 Slp：数据：2009-05-07 11:50:01 Slp：WatsonData = perf-MSSQL$SQLEXPRESS-sqlctr10.0.1600.22.dll@OpenSQLPerformanceData@CollectSQLPerformanceData@CloseSQLPerformanceData 2009-05 -07 11:50:01 Slp：DisableRetry = true 2009-05-07 11:50:01 Slp：内部异常类型：System.ComponentModel.Win32Exception 2009-05-07 11:50:01 Slp：消息：2009-05 -07 11:50:01 Slp：系统找不到指定的文件。2009-05-07 11:50:01
2009-05-07 11:50:01 Slp: Stack: 2009-05-07 11:50:01 Slp: 在 Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.LoadPerformanceCounter(String symbolInstallPath, String counterPrefixServiceName) 2009-05-07 11:50:01 Slp: 在 Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.RegisterPerformanceCounterCore(String libraryFileName, String openFunction, String collectionFunction, String closeFunction, String symbolInstallPath, String counterPrefixServiceName) 2009-05-07 11:50:01 Slp:在 Microsoft.SqlServer.Configuration.Sco.PerformanceCounter.RegisterPerformanceCounter(String libraryFileName, String openFunction, String collectionFunction, String closeFunction, String symbolInstallPath, String counterPrefixServiceName) 2009-05-07 11:50:01 Slp:-------------------------------------- 2009-05-07 12:02:40 Slp：用户已选择取消此操作

///////////////////////////////////////// ///////////////////////

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T20:10:46.157

没有太多答案，但我只是硬着头皮重新安装操作系统。至少你知道它会起作用。

# java - Java中的FOP图像缩放问题

> ID：836721
> 
> 赞同：0
> 
> 时间：2009-05-07T20:00:39.910
> 
> 标签：java, xsl-fo, apache-fop

好的，这是我的问题：

我们使用 FOP 来创建“漂亮”的报告输出。如果用户想要一个文件，我们使用 pdf 选项，用于预览的 AWT 和用于打印它们的 -print 选项。我们正在使用 FOP 0.25.x，我完全认识到它不是最新版本，但升级到 0.95 似乎是一项我不一定想承担的不平凡的任务。

无论如何，我们的一位用户注意到，在将身份证（通过 FOP -print 选项生成）打印到身份证打印机时，卡片上的图像（员工的照片）有一些损坏......像绿色和红色的点和线。我们还发现，如果我们向其中一台 HP 彩色激光打印机发送完全相同的打印请求，它的打印效果很好。更奇怪的是，如果我们使用 FOP 创建 ID 卡的 PDF，然后通过卡片打印机上的 acrobat reader 打印，打印效果很好。

我最终发现它与图像的缩放有关……我们将 600 像素高的图像缩小到 120 像素。如果我缩小图像的大小，即使只是将它们减半，腐败也会显着下降。同样，当我放大图像时，腐败增加了。

所以我的问题是：有人知道这里发生了什么吗？或者曾经遇到过这样的事情？

由于我不知道为什么会发生这种情况，因此我不知道如何解决根本原因，但我一直在尝试各种解决方法：

1) 使用 FOP 创建图像的 pdf，然后通过 Java 打印。这似乎是一个显而易见的答案，但一些谷歌搜索表明通过 Java 打印 PDF 并非易事。我在 java.net 上看到过 PDF Renderer 项目，但对于单个非常具体的应用程序来说似乎相当庞大。

2) 在将图像提供给 FOP 之前尝试调整图像大小。这似乎也很简单，但是我们的各种用户可以根据需要为这些身份证设置样式表，并且在其中使用“pt”和“in”大小似乎很常见......我不知道有什么好的方法将其映射到像素大小调整。

如果有人对根本原因、使这些变通方法起作用和/或其他想法有任何见解，那么您将欠我的债。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T21:41:36.300

最确定的解释：
图像损坏？这是一个错误。

为什么不使用 0.95？迟早你必须升级，Apache 联盟不会修复 0.25.x 版本中的错误。

您不能希望为将来可能出现的每个错误找到解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T18:38:40.387

我最终做了我在原始问题中提到的第二件事......即在将其提供给 FOP 之前调整它的大小。我发现我可以检索我正在打印的打印机的 dpi 并对其进行一些数学运算以获取像素大小。似乎在我的所有测试中都能完美运行......不是真正的解决方案，而是一个足够的解决方法。

# apache-flex - 如何将某些文件放在 Grails 服务器的根目录中？

> ID：836722
> 
> 赞同：0
> 
> 时间：2009-05-07T20:00:42.297
> 
> 标签：apache-flex, grails, configuration

我正在使用 grails 应用程序作为 Flex 前端的后端。为了能够轻松地开发和调试我的应用程序，我需要将 crossdomain.xml 文件放入服务器的根目录，即它必须可以通过[http://localhost:8080/crossdomain.xml](http://localhost:8080/crossdomain.xml)访问。类似的用例可能是 favicon.ico 或 robots.txt 的部署，但是这可以通过具有默认根 Web 应用程序的 tomcat 服务器在生产环境中完成。

但是，在我的情况下，我需要在运行 grails run-app 后让 crossdomain.xml 可用。我知道我可以将整个应用程序移动到根目录（[http://ca.rroll.net/2009/03/27/configuring-the-grails-root-application-context/](http://ca.rroll.net/2009/03/27/configuring-the-grails-root-application-context/)）但这也不是我想要的，因为 grails 应用程序仍应位于其默认应用程序上下文之下。

有人知道，我该怎么做？我是否必须以某种方式重新配置我的 grails 安装的码头 servlet 容器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T21:41:52.033

我想我找到了答案。我还没有尝试过，所以YMMV。

在[本文中](http://colinharrington.net/blog/2008/07/grails-jetty-and-crossdomainxml/)，Colin Harrington 讨论了通过部署一个额外的 Jetty 上下文来使 crossdomain.xml 文件在服务器的根目录中可用。

[他的技术是在这篇博客文章](http://www.jtict.com/blog/grails-jetty-multiple-contexts/)中首次提出的，作者还讨论了使用[静态资源插件](http://grails.org/Static+Resources+Plugin)作为另一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-19T00:46:36.810

我想出了一个用 Apache 和 mod_proxy 解决这个问题的方法。这允许您的 Grails 安装和 Grails 项目保持原始状态。无需对 Grails 内部进行黑客攻击，无需添加生产中可能不需要的插件。

**1.安装Apache httpd 2.2**

但是，这样做对您的操作系统最有意义。安装 Apache 2.2 很重要。我是在 Ubuntu 系统上执行此操作的，因此任何特定的命令和文件位置都适用于 Ubuntu。根据您的系统的需要进行修改。

安装 Apache 后，启动 httpd。

```
sudo /sbin/service httpd start 
```

使用 Web 浏览器测试它是否已正确安装。

**2.创建根目录**

在磁盘上选择一个保存静态文件的位置。这将是 httpd 的文档根目录。我将使用 /var/grails_root。

```
mkdir /var/grails_root
touch /var/grails_root/crossdomain.xml 
```

**3.在httpd.conf中创建一个VirtualHost**

在您喜欢的文本编辑器中打开 httpd.conf。

```
vim /etc/httpd/conf/httpd.conf 
```

选择您最喜欢的端口，并在该端口上创建一个虚拟主机。我将使用 9090，但任何端口都可以。

将这些行添加到 httpd.conf

```
Listen 9090
<VirtualHost *:9090>
    DocumentRoot "/var/grails_root"
    <Directory "/var/grails_root">
        Allow from all
    </Directory>
</VirtualHost> 
```

重启httpd

```
sudo /sbin/service httpd restart 
```

测试您现在是否能够访问文档根目录中的静态文件。如果没有，您将需要在继续下一步之前解决此问题。

**4\. 启用 mod_proxy 和 mod_proxy_http**

您需要加载这两个模块。mod_proxy 具有代理的基本功能，而 mod_proxy_xxx 模块具有特定于协议的信息。它们标配 httpd 2.2，因此您不需要安装任何额外的东西。

将这些行添加到 httpd.conf

```
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so 
```

现在修改您在上一步中设置的虚拟主机。（可以省略评论）

```
<VirtualHost *:9090>
    DocumentRoot "/var/grails_root"
    <Directory "/var/grails_root">
        Allow from all
    </Directory>
# New lines start here
    ProxyRequests Off
    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>
    ProxyPass /grailsApp http://your.grails.server:8080/grailsApp
# New lines end here
</VirtualHost> 
```

重启httpd

```
sudo /sbin/service httpd restart 
```

现在，您应该可以通过端口 9090 访问您的静态文件和 Grails 应用程序。

这一切都基于在这里找到的信息：http: [//docs.codehaus.org/display/JETTY/Configuring+mod_proxy](http://docs.codehaus.org/display/JETTY/Configuring+mod_proxy)

同一站点上提供了使用其他版本的 Apache 执行此操作的信息。

# jquery - 学习 jQuery 的最佳方法是什么？

> ID：836725
> 
> 赞同：30
> 
> 时间：2009-05-07T20:02:24.087
> 
> 标签：jquery

我是[ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)和[jQuery](http://en.wikipedia.org/wiki/JQuery)的新手。学习 jQuery 的最佳方法是什么？有没有好的链接、博客和截屏视频？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-07T20:39:19.647

我在[jQuery in Action](http://www.manning.com/bibeault/)上苦苦挣扎，因为我觉得它更像是一个参考手册，而不是一个教程。也许一年前它是最好的参考/教程，但现在有很多其他的选择。

另一方面，我真的很喜欢[Javascript: The Missing Manual](https://rads.stackoverflow.com/amzn/click/com/0596515898)这本书，因为我觉得它有更好的例子。不要让书名欺骗了你，在快速介绍了 JavaScript 之后，作者向你介绍了 jQuery，并在本书的其余部分使用了 jQuery。

[我还从Packt Publishing](http://www.packtpub.com/)购买了两本 PDF 书籍：

1)[学习 jQuery 1.3](http://www.packtpub.com/learning-jquery-1.3/book)

2) [jQuery UI 1.6：jQuery 的用户界面库](http://www.packtpub.com/user-interface-library-for-jquery/book)

两者都是最近的出版物并且写得很好。您经常可以从本地用户组或互联网上找到“折扣”折扣，以适用于可下载 PDF 书籍的购买价格。

如果您正在寻找一本同时涵盖 jQuery 和 jQuery UI 项目的书，那么这本 Wrox 书可能会很有用：[Beginning JavaScript and CSS Development with jQuery](https://rads.stackoverflow.com/amzn/click/com/0470227796)。一个快速的谷歌搜索显示你可以在线浏览本书的*一些*内容：[谷歌图书搜索 - 使用 jQuery 开始 JavaScript 开发 作者 Richard York](http://books.google.com/books?id=AHBPmBruZo8C)

我实际上建议从网上发布的示例中学习。有一堆在：

[Learning jQuery - 一个与上面列出的 Packt 书籍相关的网站](http://www.learningjquery.com/)

[Encosia - ASP.NET、AJAX 等](http://encosia.com/)

[Haacked 上的 ASP.NET 和 MVC jQuery 相关帖子](http://haacked.com/tags/jquery/default.aspx)

[Rick Strahl 的网络日志](http://www.west-wind.com/Weblog/ShowPosts.aspx?Category=jQuery)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-07T20:05:54.033

我总是在一个项目、一个截止日期和一个无情的客户中学习得最好。

《JQuery in Action》也是一本不错的书。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-07T20:31:38.713

建立一些东西。尝试构建一个计算器应用程序，使用可点击的 div 而不是按钮，并将数据存储在 html 内容而不是 javascript 变量中。这种练习会给你一个蹩脚的计算器，但在操作事物方面有很好的经验。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-07T20:38:11.070

最好的学习方式是开始构建一些东西。您可以使用您的任何个人项目并尝试在其上实现 jQuery。学习任何技术的另一个好方法是参加论坛。您来对地方了（StackOverFlow）！JQuery 有一个标签，您可以使用它来查看所有 JQuery 问题。尝试找到问题的解决方案。这将帮助您以及其他试图寻找答案的人！

还有一个 38 分钟的免费 JQuery 视频，您可能想开始观看。

[http://highoncoding.com/Videos/537_Extended_Screencast_on_JQuery_Whole_38_Minutes_.aspx](http://highoncoding.com/Videos/537_Extended_Screencast_on_JQuery_Whole_38_Minutes_.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-07T20:04:29.043

我建议先熟悉 JavaScript。来自 o'reilly 之类的书籍总是一个很好的资源。

至于 jQuery，他们的文档站点非常棒。[http://docs.jquery.com](http://docs.jquery.com)

祝你好运！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-07T20:44:44.687

jQuery 文档非常好。他们还有一个非常酷的 api，您可以使用它来轻松浏览文档[http://api.jquery.com](http://api.jquery.com)。

我是一名 ASP.NET 开发人员，我发现 Rich Strahl 的博客有一个非常好的介绍。[jQuery 简介（2 部分）](http://www.west-wind.com/Weblog/posts/558952.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-07T20:03:36.207

我在尝试在 Stackoverflow 中回答有关 JQuery 的问题时正在学习它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-07T20:06:00.273

我学到的一些方法

*   获取 JQuery in ACtion 书。

*   [docs.jquery.com](http://docs.jquery.com)上的教程也很不错

*   [nettuts](http://www.nettuts.com)和[粉碎杂志](http://www.smashingmagazine.com)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-07T20:04:37.827

[JQuery in action](http://www.manning.com/bibeault/)是关于这个主题的最好的书。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-07T20:46:36.617

Nettuts 有一些非常好的视频教程，是一个很好的起点。 [绝对初学者的jquery](http://nettuts.com/articles/web-roundups/jquery-for-absolute-beginners-video-series/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-12-21T19:57:31.380

我通过阅读一本名为[jQuery: Novice to Ninja](http://www.sitepoint.com/books/jquery1/)的书学习了 jQuery 。有一段时间，PDF 可以免费下载，所以我想“这到底是怎么回事”，但它实际上是一本非常好的书，并且非常易于阅读并且非常全面地检查了 jQuery 可以为您做什么。我推荐它！

凯尔

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-12-07T13:17:05.040

我个人认为最好从了解 JavaScript 开始。我将 Douglas Crockford 的 JavaScript: The Good Parts 推荐给任何刚起步的人，尤其是那些有其他语言经验的人。JS 的语法使该语言看起来似曾相识。一旦您对 JS 感到满意，那么您可能会知道如何最好地学习 jQuery（如果您可以阅读文档/示例，或者如果您需要阅读类似那些建议的更具指导性的书）。我从来没有“学习”过 jQuery。对我来说，它就像任何其他库一样，我阅读文档以供使用，但实际上我不想在不需要它时使用它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-07T20:05:38.197

我发现学习编程语言/框架的最佳方法是阅读文档并使用它们。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-07T20:08:27.550

我通过阅读 php 杂志的 4pages 文章学习了 jQuery。在简短的介绍之后，只需尝试 jQuery 文档的演示 - 这确实是最好的方法。不要把时间浪费在看书上，它会消耗很多时间，之后你还得自己去测试。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-07T20:52:43.233

通读此部分的每个部分：[http](http://api.jquery.com) ://api.jquery.com ，您将了解有关它的所有内容——但并非所有最佳实践……这些都是随着时间和经验而来的。你最好的办法是考虑你想做的事情，然后在使用 jQuery 的不同相关部分的同时去做。

我最初是使用[http://visualjquery.com/](http://visualjquery.com/)学习的，但自 1.2.6 以来一直没有更新（因为它现在是前面提到的 api.jquery.com）。如果不是因为这两个网站，我就不会成为今天的图书馆（谢谢 Remy Sharp！）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-08T01:58:08.477

学习 jQuery 的最好方法是边写边写。现在，我认为自己是 Javascript 和 jQuery 的新手，但我正在做一些个人项目，当我收到自己的服务器时，我将很快发布这些项目。这些项目很小并且与 jQuery 相关。

我开发插件，动画插件，动画页面的主体。我为图像开发幻灯片。但你知道吗，我认为 jQuery 真的让事情变得非常简单。尤其是动画。

恐怕一旦我在 jQuery 中编程太久，我会失去对 Javascript 的了解。

我还建议您在 Javascript 中模拟 Flash 设计。如果你去 Gamespot.com，你会发现他们的设计是闪光的。尝试使用 jQuery/Javascript 做类似的事情。

嘿，你有自己的学习方式。我通过看书来学习。一旦我读完这本书，我就会坐在我的电脑上，对我学到的所有东西进行编程。如果我忘记了什么，我会打开这本书并找到参考。我发现这是学习编程的最佳方式。但是你可能有不同的学习方式。也许您更喜欢同时阅读和编程。或者查看源代码并从中学习。

在你的投资组合中写一些博客。详细说明您是如何创建 jQuery 插件的。为 jQuery 做贡献。让人们使用你的插件。分享一些爱。

# apache-flex - Flex：如何在 Horizo ntalList 控件中隔开项目（使用自定义 ItemRenderer）

> ID：836730
> 
> 赞同：1
> 
> 时间：2009-05-07T20:02:46.957
> 
> 标签：apache-flex, actionscript-3, flex3

我有一个 Horizo​​ntalList 控件，它使用自定义 ItemRenderer 将每个项目表示为一个切换按钮。该列表允许拖放，我使用[这种方法](https://stackoverflow.com/questions/589840/flex-as3-drag-drop-custom-drop-feedback)将拖放反馈（线）旋转到垂直位置而不是水平位置，但是将按钮混合在一起，拖放反馈非常微妙。我想以某种方式隔开按钮，以便下降反馈更加明显。

我浏览了这些属性，没有什么特别突出的。有填充和边距属性，但它们的描述说它们影响列表控件本身，而不是项目。

下面是我的 ItemRenderer 的代码。我已经添加了填充，但这似乎并没有改变任何东西。如果我添加填充，这会影响按钮的内部，而不是它们之间的空间，并且按钮控件没有边距属性。

我想我可以将我的 ItemRenderer 建立在画布上以获得边距，但是我不会继承按钮的所有功能。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Button 
    xmlns:mx="http://www.adobe.com/2006/mxml" 
    creationComplete="go();"
    toggle="true"
>
    <mx:Script>
        <![CDATA[
            private var _val:int = -1;
            private function go():void {
                this.label = data.title;
                _val = data.index;
            }

            override protected function clickHandler(event:MouseEvent):void{
                //todo: bubble an event that causes all other
                //buttons in the list to un-toggle

                //now do the default clickHandler 
                super.clickHandler(event);
            }
        ]]>
    </mx:Script>
</mx:Button> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T22:35:06.090

将您的项目渲染器编写为容器（Canvas 或 HBox）并将 Button 元素放入其中怎么样？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T23:41:44.170

为您的按钮制作包含所需间距的自定义外观。您可能需要将其与填充样式相结合，以确保文本或图标不会超出皮肤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-28T10:07:25.493

这有点老套，但您也可以在实际的 Horizo​​ntalList 对象的 columnWidth 上撒谎。将其设置为大于实际 itemRenderer 宽度的值。

# c# - IMul tipleResults：当存储过程中的多个结果集不映射到类型时，如何处理它们？

> ID：836734
> 
> 赞同：1
> 
> 时间：2009-05-07T20:03:19.500
> 
> 标签：c#, linq

[这篇关于 SO 的帖子](https://stackoverflow.com/questions/776426/asp-net-mvc-and-linq-general-questions)回答了我关于如何构建返回多个结果的查询的大部分问题（非常感谢 Pure.Krome 的彻底回复）。但是，如果我正在使用返回的表，则在某种程度上取决于 proc 的行为方式。无法更改进程。返回的结果是一组根本不映射到类型的数据表（例如，第一个表是客户表和订单表的一部分的混搭，第二个表，如果存在，将是调试输出，那么可能会有第三个表等等）。

我是否必须将其作为数据集/数据适配器等执行？或者这可能与LINQ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:32:19.253

LINQ 是一个 ORM（尽管相当简单），其中“O”是（重要的）“对象”。如果您无法预测每个网格中返回的对象的布局，那么它就不适合 ORM。

就我个人而言，我不会从 LINQ 跳到`DataTable`（但也许我只是偏向于`DataTable`;-p）——我会使用[`SqlCommand.ExecuteReader`](http://msdn.microsoft.com/en-us/library/9kcbe65k.aspx)并做我自己的对象（等）映射。但也许只使用`DataSet`... YMMV 等可能会节省时间。

# sql - 使用 oracle SQL 查找日期范围内的星期几

> ID：836735
> 
> 赞同：3
> 
> 时间：2009-05-07T20:03:21.760
> 
> 标签：sql, oracle

假设如下表结构：

```
Event: 
  id: integer
  start_date: datetime
  end_date: datetime 
```

有没有办法查询一周中某一天的所有事件？例如，我想找到一个查询，该查询可以找到星期一的每个事件。弄清楚`start_date`or是否`end_date`在星期一，但我不确定如何找出两者之间的日期。

纯 SQL 是首选，因为这里存在对存储过程的偏见，我们从 Rails 上下文中调用它，据我所知，它也不处理存储过程。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T20:12:37.527

```
SELECT  *
FROM    event
WHERE   EXISTS
        (
        SELECT  1
        FROM    dual
        WHERE   MOD(start_date - TO_DATE(1, 'J') + level - 1, 7) = 6
        CONNECT BY
                level <= end_date - start_date + 1
        ) 
```

`start_date`子查询从to迭代所有天`end_date`，每天检查，如果是 a `Monday`，则返回`1`。

您可以轻松地将此查询扩展到更复杂的条件：检查事件是否在 上`ANY Monday OR Friday 13th`，例如：

```
SELECT  *
FROM    event
WHERE   EXISTS  (
        SELECT  1
        FROM    dual
        WHERE   MOD(start_date - TO_DATE(1, 'J') + level - 1, 7) = 6
                OR (MOD(start_date - TO_DATE(1, 'J') + level - 1, 7) = 3 AND TO_CHAR(start_date + level - 1, 'DD') = '13')
        CONNECT BY
                level <= end_date - start_date + 1
        ) 
```

请注意，我使用`MOD(start_date - TO_DATE(1, 'J') + level - 1, 7)`而不是`TO_CHAR('D')`. 这是因为`TO_CHAR('D')`受`NLS_TERRITORY`一周中某一天的影响且不应用于检查。

此查询不使用任何索引，并且始终执行全表扫描。但这在这种特定情况下不是问题，因为给定间隔很可能包含`Monday`.

即使间隔是`1`一整天，索引也会返回`14%`值，如果间隔更长，甚至更多。

由于`INDEX SCAN`在这种情况下效率低下，并且内部子查询非常快（它使用内存`FAST DUAL`访问方法），我认为这将是一种最佳方法，无论是效率还是可扩展性。

有关详细信息，请参阅我的博客中的条目：

*   [**检查活动日期**](http://explainextended.com/2009/05/07/checking-event-dates/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:47:22.607

这应该更简单：

```
select *
from event
where 2 between to_number(trim(to_char(start_date,'D')))
            and to_number(trim(to_char(end_date,'D')))
   or (end_date - start_date) > 6 
```

# c# - 在 .net 中以编程方式解压缩文件

> ID：836736
> 
> 赞同：250
> 
> 时间：2009-05-07T20:03:25.410
> 
> 标签：c#, unzip

我正在尝试以编程方式解压缩压缩文件。

我曾尝试`System.IO.Compression.GZipStream`在 .NET 中使用该类，但是当我的应用程序运行（实际上是单元测试）时，我得到了这个异常：

> System.IO.InvalidDataException：GZip 标头中的幻数不正确。确保您传递的是 GZip 流。

我现在意识到`.zip`文件与`.gz`文件不同，并且`GZip`与`Zip`.

但是，由于我可以通过手动双击压缩文件然后单击“提取所有文件”按钮来提取文件，因此我认为也应该有一种方法可以在代码中执行此操作。

因此，我尝试使用`Process.Start()`压缩文件的路径作为输入。这会导致我的应用程序打开一个窗口，显示压缩文件中的内容。这一切都很好，但是该应用程序将安装在一个没有周围的服务器上单击“提取所有文件”按钮。

那么，如何让我的应用程序提取压缩文件中的文件？

还是有其他方法可以做到这一点？我更喜欢用代码来做，不下载任何第三方库或应用程序；安全部门不太喜欢这个...

* * *

## 回答 #1

> 赞同：534
> 
> 时间：2013-01-31T20:58:31.630

使用**.NET 4.5**，您现在可以使用 .NET 框架解压缩文件：

```
using System;
using System.IO;

namespace ConsoleApplication
{
  class Program
  {
    static void Main(string[] args)
    {
      string startPath = @"c:\example\start";
      string zipPath = @"c:\example\result.zip";
      string extractPath = @"c:\example\extract";

      System.IO.Compression.ZipFile.CreateFromDirectory(startPath, zipPath);
      System.IO.Compression.ZipFile.ExtractToDirectory(zipPath, extractPath);
    }
  }
} 
```

上面的代码直接取自微软的文档： http: [//msdn.microsoft.com/en-us/library/ms404280 (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/ms404280(v=vs.110).aspx)

`ZipFile`包含在程序集中`System.IO.Compression.FileSystem`。（感谢 nateirvin ......见下面的评论）。您需要添加对框架程序集的 DLL 引用`System.IO.Compression.FileSystem.dll`

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2015-06-04T19:15:50.217

**对于 .Net 4.5+**

并不总是希望将未压缩的文件写入磁盘。作为 ASP.Net 开发人员，我将不得不摆弄权限来授予我的应用程序写入文件系统的权限。通过使用内存中的流，我可以回避所有这些并直接读取文件：

```
using (ZipArchive archive = new ZipArchive(postedZipStream))
{
    foreach (ZipArchiveEntry entry in archive.Entries)
    {
         var stream = entry.Open();
         //Do awesome stream stuff!!
    }
} 
```

或者，您仍然可以通过调用将解压缩文件写入磁盘`ExtractToFile()`：

```
using (ZipArchive archive = ZipFile.OpenRead(pathToZip))
{
    foreach (ZipArchiveEntry entry in archive.Entries)
    {
        entry.ExtractToFile(Path.Combine(destination, entry.FullName));
    }
} 
```

要使用`ZipArchive`该类，您需要添加对`System.IO.Compression`命名空间和`System.IO.Compression.FileSystem`.

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2009-05-07T21:02:31.667

我们已经在许多项目中成功使用了[SharpZipLib 。](http://www.icsharpcode.net/OpenSource/SharpZipLib/)我知道它是第三方工具，但包含源代码，如果您选择在这里重新发明轮子，可以提供一些见解。

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2012-09-14T18:34:22.837

免费，并且没有外部 DLL 文件。一切都在一个 CS 文件中。一个下载只是 CS 文件，另一个下载是一个非常容易理解的示例。今天刚试过，我不敢相信设置是多么简单。它在第一次尝试时有效，没有错误，没有任何东西。

[https://github.com/jaime-olivares/zipstorer](https://github.com/jaime-olivares/zipstorer)

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2009-05-07T20:05:58.557

[使用位于http://www.codeplex.com/DotNetZip](http://www.codeplex.com/DotNetZip)的 DotNetZip 库

> 用于操作 zip 文件的类库和工具集。使用 VB、C# 或任何 .NET 语言轻松创建、提取或更新 zip 文件...
> 
> DotNetZip 可以在带有完整 .NET Framework 的 PC 上运行，也可以在使用 .NET Compact Framework 的移动设备上运行。在 VB、C# 或任何 .NET 语言或任何脚本环境中创建和读取 zip 文件...
> 
> 如果您只需要一个更好的 DeflateStream 或 GZipStream 类来替换 .NET BCL 中内置的类，DotNetZip 也有。DotNetZip 的 DeflateStream 和 GZipStream 可用于独立程序集，基于 Zlib 的 .NET 端口。这些流支持压缩级别并提供比内置类更好的性能。还有一个 ZlibStream 来完成集合（RFC 1950、1951、1952）...

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-10-03T14:11:01.157

```
String ZipPath = @"c:\my\data.zip";
String extractPath = @"d:\\myunzips";
ZipFile.ExtractToDirectory(ZipPath, extractPath); 
```

要使用 ZipFile 类，您必须在项目中添加对 System.IO.Compression.FileSystem 程序集的引用

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-03-29T16:43:22.480

这会做到的`System.IO.Compression.ZipFile.ExtractToDirectory(ZipName, ExtractToPath)`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-07T20:06:35.183

标准 zip 文件通常使用 deflate 算法。

要在不使用第三方库的情况下提取文件，请使用 DeflateStream。您需要更多有关 zip 文件存档格式的信息，因为 Microsoft 仅提供压缩算法。

您也可以尝试使用 zipfldr.dll。它是 Microsoft 的压缩库（发送到菜单中的压缩文件夹）。它似乎是一个 com 库，但没有记录。你也许可以通过实验让它为你工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-09-13T19:44:55.313

我用它来压缩或解压缩多个文件。Regex 的东西不是必需的，但我用它来更改日期戳并删除不需要的下划线。如果需要，我使用 Compress >> zipPath 字符串中的空字符串为所有文件添加前缀。另外，我通常会根据我正在做的事情注释掉 Compress() 或 Decompress() 。

```
using System;
using System.IO.Compression;
using System.IO;
using System.Text.RegularExpressions;

namespace ZipAndUnzip
{
    class Program
    {
        static void Main(string[] args)
        {
            var directoryPath = new DirectoryInfo(@"C:\your_path\");

            Compress(directoryPath);
            Decompress(directoryPath);
        }

        public static void Compress(DirectoryInfo directoryPath)
        {
            foreach (DirectoryInfo directory in directoryPath.GetDirectories())
            {
                var path = directoryPath.FullName;
                var newArchiveName = Regex.Replace(directory.Name, "[0-9]{8}", "20130913");
                newArchiveName = Regex.Replace(newArchiveName, "[_]+", "_");
                string startPath = path + directory.Name;
                string zipPath = path + "" + newArchiveName + ".zip";

                ZipFile.CreateFromDirectory(startPath, zipPath);
            }

        }

        public static void Decompress(DirectoryInfo directoryPath)
        {
            foreach (FileInfo file in directoryPath.GetFiles())
            {
                var path = directoryPath.FullName;
                string zipPath = path + file.Name;
                string extractPath = Regex.Replace(path + file.Name, ".zip", "");

                ZipFile.ExtractToDirectory(zipPath, extractPath);
            }
        }

    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-05-12T14:30:03.557

您可以使用 DeflateStream 在 .NET 3.5 中完成所有操作。.NET 3.5 中缺少的是处理用于组织压缩文件的文件头部分的能力。PKWare 已发布此信息，您可以在创建所使用的结构后使用这些信息来处理 zip 文件。它不是特别繁重，并且在不使用 3rd 方代码的情况下构建工具是一种很好的做法。

这不是一个单一的答案，但如果你愿意并且能够自己花时间，它是完全可行的。我在几个小时内编写了一个类来完成这项工作，我从中得到的是仅使用 .NET 3.5 压缩和解压缩文件的能力。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-07T20:09:25.083

从[这里](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)：

> 写入扩展名为 .gz 的文件的压缩 GZipStream 对象可以使用许多常用压缩工具进行解压缩；但是，此类本身并不提供将文件添加到 .zip 档案或从 .zip 档案中提取文件的功能。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-07T22:51:30.477

我今天发现了[这个](https://github.com/yallie/unzip)（在 NuGet 上解压缩包），因为我在 DotNetZip 中遇到了一个严重的错误，我意识到过去两年在 DotNetZip 上并没有做太多的工作。

Unzip 包很精简，它为我完成了这项工作——它没有 DotNetZip 的错误。此外，它是一个相当小的文件，依赖于 Microsoft BCL 进行实际解压缩。我可以轻松地进行我需要的调整（以便能够在解压缩时跟踪进度）。我推荐它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-01-13T15:31:44.880

来自嵌入资源：

```
using (Stream _pluginZipResourceStream = Assembly.GetExecutingAssembly().GetManifestResourceStream(programName + "." + "filename.zip"))
{
    using (ZipArchive zip = new ZipArchive(_pluginZipResourceStream))
    {
        zip.ExtractToDirectory(Application.StartupPath);
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-09-07T10:06:28.923

到目前为止，我一直在使用 cmd 进程来提取 .iso 文件，将其从服务器复制到临时路径中，然后提取到 U 盘上。最近我发现这与小于 10Gb 的 .iso 完美配合。对于像 29Gb 这样的 iso，这种方法会以某种方式卡住。

```
 public void ExtractArchive()
    {
        try
        {

            try
            {
                Directory.Delete(copyISOLocation.OutputPath, true); 
            }
            catch (Exception e) when (e is IOException || e is UnauthorizedAccessException)
            {
            }

            Process cmd = new Process();
            cmd.StartInfo.FileName = "cmd.exe";
            cmd.StartInfo.RedirectStandardInput = true;
            cmd.StartInfo.RedirectStandardOutput = true;
            cmd.StartInfo.CreateNoWindow = true;
            cmd.StartInfo.UseShellExecute = false;
            cmd.StartInfo.WindowStyle = ProcessWindowStyle.Normal;

            //stackoverflow
            cmd.StartInfo.Arguments = "-R";

            cmd.Disposed += (sender, args) => {
                Console.WriteLine("CMD Process disposed");
            };
            cmd.Exited += (sender, args) => {
                Console.WriteLine("CMD Process exited");
            };
            cmd.ErrorDataReceived += (sender, args) => {
                Console.WriteLine("CMD Process error data received");
                Console.WriteLine(args.Data);
            };
            cmd.OutputDataReceived += (sender, args) => {
                Console.WriteLine("CMD Process Output data received");
                Console.WriteLine(args.Data);
            };

            //stackoverflow

            cmd.Start();

            cmd.StandardInput.WriteLine("C:");
            //Console.WriteLine(cmd.StandardOutput.Read());
            cmd.StandardInput.Flush();

            cmd.StandardInput.WriteLine("cd C:\\\"Program Files (x86)\"\\7-Zip\\");
            //Console.WriteLine(cmd.StandardOutput.ReadToEnd());
            cmd.StandardInput.Flush();

            cmd.StandardInput.WriteLine(string.Format("7z.exe x -o{0} {1}", copyISOLocation.OutputPath, copyISOLocation.TempIsoPath));
            //Console.WriteLine(cmd.StandardOutput.ReadToEnd());
            cmd.StandardInput.Flush();
            cmd.StandardInput.Close();
            cmd.WaitForExit();
            Console.WriteLine(cmd.StandardOutput.ReadToEnd());
            Console.WriteLine(cmd.StandardError.ReadToEnd()); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-08-08T12:24:59.457

您可以使用**Info-unzip**命令行cod。您只需要从Info-unzip官网下载unzip.exe。

```
 internal static void Unzip(string sorcefile)
    {
        try
        {
            AFolderFiles.AFolderFilesDelete.DeleteFolder(TempBackupFolder); // delete old folder   
            AFolderFiles.AFolderFilesCreate.CreateIfNotExist(TempBackupFolder); // delete old folder   
           //need to Command command also to export attributes to a excel file
            System.Diagnostics.Process process = new System.Diagnostics.Process();
            System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
            startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden; // window type
            startInfo.FileName = UnzipExe;
            startInfo.Arguments = sorcefile + " -d " + TempBackupFolder;
            process.StartInfo = startInfo;
            process.Start();
            //string result = process.StandardOutput.ReadToEnd();
            process.WaitForExit();
            process.Dispose();
            process.Close();
        }
        catch (Exception ex){ throw ex; }
    } 
```

# asp.net-mvc - ASP.NET MVC 和 Idisposable

> ID：836738
> 
> 赞同：-3
> 
> 时间：2009-05-07T20:03:47.750
> 
> 标签：asp.net-mvc

我如何将 IDisposable 接口与 asp.net mvc 一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T20:13:55.073

asp.net mvc 中的 IDisposable 与 .Net framework 其他地方的 IDisposable 相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-15T19:42:09.497

这并不是一些人可能认为的那么糟糕的问题。只是问的方式不对。考虑以下代码：

```
ActionResult UserList()
{
 using (var ctx = new DbCtx())
 {
   return View(ctx.Users)
 }
} 
```

不起作用，因为 ctx 在视图实际迭代数据之前很久就被处置，导致对象处置异常。

解决方案是在 Controller.Dispose 中处理 ctx。不明显的是，注入到我们的控制器中的大多数依赖项迟早都必须实现 IDisposable。

不过，这不是 mvc 特定的问题。

# ruby - 创建时出现ruby ssl soap错误

> ID：836739
> 
> 赞同：1
> 
> 时间：2009-05-07T20:03:57.000
> 
> 标签：ruby, soap, ssl

当我尝试创建一个肥皂对象时，我在第一次初始化类时遇到了错误。我无法设置 driver.options["protocol.http.ssl_config.verify_mode"] = OpenSSL::SSL::VERIFY_NONE 因为它已经出现故障。有任何想法吗？

> 需要'soap/wsdlDriver' => []
> 
> > wsdl = " [https://somesiteinhttps.com](https://somesiteinhttps.com) " driver = SOAP::WSDLDriverFactory.new(wsdl).create_rpc_driver at depth 0 - 20: 无法获取本地颁发者证书

OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed

```
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient/session.rb:247:in `connect'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient/session.rb:247:in `ssl_connect'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient/session.rb:639:in `connect'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient/timeout.rb:128:in `timeout'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient/session.rb:631:in `connect'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient/session.rb:522:in `query'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient/session.rb:147:in `query'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient.rb:942:in `do_get_block'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient.rb:758:in `do_request'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient.rb:837:in `protect_keep_alive_disconnected'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient.rb:757:in `do_request'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient.rb:822:in `follow_redirect'
from /usr/lib/ruby/gems/1.8/gems/httpclient-2.1.4/lib/httpclient.rb:514:in `get_content'
from /usr/lib/ruby/1.8/wsdl/xmlSchema/importer.rb:64:in `fetch'
from /usr/lib/ruby/1.8/wsdl/xmlSchema/importer.rb:30:in `import'
from /usr/lib/ruby/1.8/wsdl/importer.rb:18:in `import'
from /usr/lib/ruby/1.8/soap/wsdlDriver.rb:124:in `import'
from /usr/lib/ruby/1.8/soap/wsdlDriver.rb:28:in `initialize'
from (irb):15:in `new'
from (irb):15>> driver = SOAP::WSDLDriverFactory.new(wsdl) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-10T23:01:20.020

我升级到 httpclient 2.1.5.2 并且不再收到此错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T13:55:26.997

有点想通了。将 ruby​​ 降级到 1.8.5 而不是使用 1.8.7 并且相同的代码有效。

# delphi - 在 Delphi 5 中打开带空格的文件路径

> ID：836740
> 
> 赞同：0
> 
> 时间：2009-05-07T20:04:12.663
> 
> 标签：delphi

（使用德尔福 5）

我正在尝试使用以下代码打开日志文件：

```
// The result of this is:
// C:\Program Files\MyProgram\whatever\..\Blah\logs\mylog.log
fileName := ExtractFilePath(Application.ExeName) + '..\Blah\logs\mylog.log';

// The file exists check passes
if (FileExists(fileName)) then
begin
    logs := TStringList.Create();

    // An exception is thrown here: 'unable to open file'
    logs.LoadFromFile(fileName);
end; 
```

如果我将日志文件重新定位到 C:\mylog.log，则代码可以完美运行。我在想文件路径中的空格把事情搞砸了。有谁知道这是否是 Delphi 5 的正常行为？如果是，是否有逃逸空间或将路径转换为 ​​Windows 8.3 路径的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T20:25:39.710

我很确定 Delphi 5 可以处理文件名中的空格，但是自从我使用该特定版本以来已经很长时间了。文件当前是否被另一个进程打开？这也可能是权限问题。您可以尝试使用文件模式设置为“fmOpenRead 或 fmShareDenyNone”的 tFileStream 打开它，而不是将其加载到 tStringList 中。

```
fStm := tFileStream.Create( filename, fmOpenRead or fmShareDenyNone ); 
```

然后从流中加载您的 tStringlist：

```
Logs.LoadFromStream ( fStm ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T20:33:58.973

你确定它不是导致问题的“..\”而不是空格。你有没有试过看看它是否适用于

```
c:\My\Path\nospaces\ 
```

如果是这样并且您始终使用 ..\ 路径，则可以编写一个简单的函数来从应用程序路径中删除最后一个文件夹并创建一个完整正确的路径名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T20:47:26.850

奇怪的是，Delphi 5 会对此抛出错误。我知道 FileExists 在最后修改日期无效的文件上失败的问题（因为它在内部使用 FileAge），但这里正好相反。而不是使用“..\”我会考虑冒险当前路径，并从相对路径加载：`LoadFromFile('..\Something\Something.log');`特别是对于较小的应用程序，或者通过调用 ExtractFilePath 两次：`ExtractFilePath(ExtractFilePath(Application.ExeName))`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T20:31:07.653

我很确定 Delphi 一直在处理空间，所以我怀疑这是问题所在。

您没有显示完整路径。有可能真的很长吗？例如，我可以相信路径长度超过 255 个字符的问题。

将日志文件放在 Program Files 下也是一个坏主意。通常普通用户无权写入 Program Files 下的任何内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T20:31:18.323

Delphi 5 可以打开带有空格的文件——这当然不是问题。为了证明这一点，请尝试将其复制到 c:\my log.log - 它应该可以正常打开。

您收到的错误消息中是否有更多信息？最有可能的是其他人（可能是您自己的程序）仍在写入*日志*。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T07:29:09.083

空间不是问题。虽然这`'..'`可能是 Delphi 5 中的一个问题，但很可能该文件被写入它的进程锁定。如果您可以控制它，请确保它使用`fmShareDenyWrite`和不使用`fmShareExclusive`或`fmShareCompat`（这是默认设置）打开文件。

此外，您可以使用：

```
fileName := ExpandFileName(ExtractFilePath(Application.ExeName) + '..\Blah\logs\mylog.log'); 
```

从相对路径获取绝对路径。

此外，正如其他人所说，在 Program Files 中编写任何内容都不是一个好主意。普通用户（不是管理员或超级用户）没有权限在那里写（虽然在 Vista 中将被虚拟化，仍然不是一个好主意）。为用户（或所有用户）使用适当的应用程序数据文件夹。可以使用以下方法获取此文件夹：

```
SHGetFolderPath(0,folder,0,SHGFP_TYPE_CURRENT,@path[0]) 
```

`folder`要么`CSIDL_COMMON_APPDATA`要么`CSIDL_LOCAL_APPDATA`。_ 有关示例，请参阅[此 delphi.about.com 文章](http://delphi.about.com/od/kbwinshell/a/SHGetFolderPath.htm)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T11:14:58.267

简单的 ：

```
 // if log file = "C:\Program files\mylog.log"
// you'll get :
// »»»»» fileName = 'C:\Program files..\Blah\logs\mylog.log'
// if log file = "C:\mylog.log"
// you'll get :
// »»»»» fileName = 'C:..\Blah\logs\mylog.log' 
```

请尝试使用此代码，我很确定它会满足您的需求：

```
 fileName := IncludeTrailingPathDelimiter(ExtractFilePath(Application.ExeName))
  + '..\Blah\logs\mylog.log'; 
```

问候，

奥利维尔

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-06T19:33:50.227

Delphi 5 在打开带有空格的文件时从来没有遇到过问题，我仍在使用它，因为它非常稳定并且适用于较旧的 XP 应用程序。您需要仔细检查您的代码。

# asp.net - DevExpress - Xtra 报告：VB.NET 如何获取当前页码？

> ID：836742
> 
> 赞同：2
> 
> 时间：2009-05-07T20:04:21.040
> 
> 标签：asp.net, devexpress, xtrareport

我搜索过他们的网站。我只想在 vb 脚本中找到页码。我有一个报告标题，如果它在第 1 页上，那么我想要一个分页符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T01:47:29.360

这段代码应该可以解决问题。它是 Report Header 中标签的 PrintOnPage 事件处理程序。

```
Private Sub xrLabel1_PrintOnPage(ByVal sender As Object, ByVal e As DevExpress.XtraReports.UI.PrintOnPageEventArgs) Handles xrLabel1.PrintOnPage
   If e.PageIndex > 0 Then
      ReportHeader.PageBreak = DevExpress.XtraReports.UI.PageBreak.None
   Else
      ReportHeader.PageBreak = DevExpress.XtraReports.UI.PageBreak.AfterBand
   End If
End Sub 
```

请注意，PageIndex 值是零索引的。此外，页面索引仅在 PrintOnPageEventArgs 中可用（据我所知），因此这在 Before/AfterPrint 事件中不起作用。

请参阅[此知识库文章以供参考。](http://devexpress.com/Support/Center/KB/p/A2630.aspx)

# asp.net - 在 asp.net 中使用基于 flexbox jquery 的组合框

> ID：836751
> 
> 赞同：0
> 
> 时间：2009-05-07T20:05:08.027
> 
> 标签：asp.net, jquery, jquery-plugins, combobox

我有一个由存储过程填充的 asp:dropdownlist，我想用 flexbox 替换它。我看到弹性框需要一个基于 json 的内容。任何指针如何替换我的代码？

```
 <asp:DropDownList ID="StepDropDown" runat="server" AutoPostBack="True" DataSourceID="SteppingDataSource" DataTextField="Name" DataValueField="S_ID" OnSelectedIndexChanged="StepDropDown_SelectedIndexChanged" />

    <asp:SqlDataSource ID="SteppingDataSource" runat="server" ConnectionString="<%$ ConnectionStrings:PerfMonConnectionString %>" SelectCommand="GetSteppings" SelectCommandType="StoredProcedure" /> 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-07T18:28:55.743

替换不会是微不足道的。有两大障碍：(1) FlexBox 使用 AJAX 访问 Json 数据，而不是示例代码中显示的传统数据绑定 (2) 您需要将数据转换为 Json 格式。

[如果您对示例感兴趣，可以在此处](http://johnnycoder.com/blog/2008/12/16/httphandler-json-data/)找到一个示例，该示例演示了如何在 div 中呈现 FlexBox，与 HTTPHandler（而不是 .ASPX 文件）通信以接收数据，并且有一个非常基本的数据访问层写出 Json 数据。

更换是可行的（我已经做到了），但它不是灌篮。

# c# - 在 Windows 上使用 Mono

> ID：836767
> 
> 赞同：6
> 
> 时间：2009-05-07T20:08:18.097
> 
> 标签：c#, windows, mono

我知道这听起来很愚蠢，但是：

我发现[这个](http://do.davebsd.com/)应用程序是用 Mono 编写的，它是开源的。

在查看源代码时，我发现这两个“使用”指令阻止了我：

```
using Gdk;

using Mono.Unix; 
```

我猜它们是 Mono 特定的库。

那么，可以在 Windows 下运行 Mono 吗？（也许是 Visual Studio 速成版？）

[我正在努力学习 C#]

我看到该应用程序有一个 Windows 分支，但它是空的。

顺便说一句：Mono 是否首先考虑了跨平台？

**编辑**

我已经下载/安装并运行示例代码

```
using Mono.Unix;

class X { static void Main () { System.Console.Write("OK");} } 
```

我自己的问题的答案是：

```
x.cs(1,12): error CS0234: The type or namespace name `Unix' does not exist 
in the namespace `Mono'. Are you missing an assembly reference?
Compilation failed: 1 error(s), 0 warnings 
```

不，它不起作用:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T20:12:09.227

是的，您可以在 windows 下安装单声道。有一个实验性安装程序。

请参阅：[http ://mono-project.com/Mono:Windows](http://mono-project.com/Mono:Windows)

该页面还包含有关 gtk 库的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T20:14:04.403

[Windows 指南单声道](http://www.mono-project.com/Mono:Windows)

我不确定您是否能够使用 Mono.Unix 命名空间来使用代码，但通常如果您正在创建跨平台代码，则不必这样做。

[Gnome 做 linux 端口](https://code.launchpad.net/~do-windows)。然而，对于一个学习项目，我可能建议从实际上是跨平台的代码开始，或者现在在 Linux 上开发。解决跨平台问题和可能的不完整端口只会使学习过程复杂化。

所以，我想总结一下你最初的问题。是的，您可以在 Windows 上运行 Mono，但可以编写特定于平台的代码，您选择的示例应用程序确实做到了。我上面提供的链接是使该代码在 Windows 上工作的端口。如果不移植（更改平台特定代码），该程序将无法在 Windows 上编译。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T20:13:05.980

当然你可以在 windows 下运行 mono：

[http://www.go-mono.com/mono-downloads/download.html](http://www.go-mono.com/mono-downloads/download.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T20:16:42.993

Gdk 是一个用于低级窗口系统的跨平台库，代码使用.NET 绑定到 Gdk。它可用于 Windows（作为 Gtk# 包的一部分或在 Mono 安装程序中）。

Mono.Unix 是一个单声道库，提供对 unix 服务（系统调用、stdlib）的访问。我不认为 Mono.Unix 可用于 Windows，但 Mono.Posix 可能可用。

# java - 是否有用于解析 Excel 2007 文件的 Java 开源库？

> ID：836769
> 
> 赞同：5
> 
> 时间：2009-05-07T20:08:38.067
> 
> 标签：java, excel, open-source, excel-2007

是否有用于解析 Excel 2007 文件的 Java 开源库？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T20:11:54.360

[Apache POI](http://poi.apache.org/spreadsheet/index.html) 看起来很有希望。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T20:49:38.810

Apache POI 是该问题的纯 Java 答案。2007 格式支持目前处于测试阶段。

OpenXLS 可能已经支持它（如果 GPL 适合您）。同一产品的商业版本 (ExtenXLS) 确实支持它。

虽然严格来说不是问题的一部分，但我应该指出，任何对 Excel 文件访问权限的重写都会比原来的文件有一些不足，所以如果你需要的话， [Joel Spolsky](http://www.joelonsoftware.com/items/2008/02/19.html)的建议是一个很好的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T20:12:08.900

阿帕奇 POI

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-05T21:22:14.503

来自[http://poi.apache.org/apidocs/index.html](http://poi.apache.org/apidocs/index.html)

DDF - Dreadful Drawing Format 此包包含用于解码 Microsoft Office 绘图格式的类，也称为 escher，此后在 POI 中称为 Dreadful Drawing Format。

HPSF - 可怕的属性集格式

HSSF - 可怕的电子表格格式

我爱那些家伙。我们将尝试使用 POI 来读取 Excel 文件，我也会看看 JExcel 解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T21:05:13.953

[http://openxml4j.org/](http://openxml4j.org/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T22:34:19.900

不是兴趣点。Andy Khan 的[JExcel](http://jexcelapi.sourceforge.net/)正是您想要的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-20T00:03:39.067

前段时间我对poi和jexcel进行了评估，jexcel要好得多。尽管在您拥有非常大的数据文件的情况下，它们都使用大量内存。我的意思是，我无法弄清楚如何通过流构建 excel 文件，这样我就不必将整个文件加载到内存中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T14:08:27.480

我目前正在比较 JExcelApi 和 Apache POI。POI 支持 Beta 版的 Office 2007，看起来是最佳选择（在许多方面）

# visual-studio-2008 - 调试命令（跨步/进入）导致未处理的异常

> ID：836770
> 
> 赞同：6
> 
> 时间：2009-05-07T20:08:47.253
> 
> 标签：visual-studio-2008, crash, debugging

我在 64 位版本的 Vista 上使用 Visual Studio 2008。在我的程序在我的一个断点处停止后，如果我的应用程序没有抛出非法指令异常或访问冲突异常，我就无法跨过或进入当前行。如果我右键单击下一行并选择“Run to here”（相当于“Step over”），它工作正常。

附录：任何监视窗口中都没有任何内容。

另外，这里有一点我忘了提：如果我附加到这个过程中，一切都会很好。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-02-09T23:02:36.130

Mos，我想知道你是否解决了这个问题（因为我在 64 位 Win7 上也有 VS2005 和 VS2008）？

编辑：评论中建议“取消选中工具/选项/调试/本机/启用 RPC 调试”，这似乎是答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T20:15:56.253

您是在应用程序中还是在 Visual Studio 本身中遇到异常？

我将首先对整个解决方案进行清理，然后再次构建。有时，如果您的二进制文件不同步，您在调试时可能会出现奇怪的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T10:27:56.223

您的应用程序是多线程的吗？

如果是：

您是否确定您正在调试的线程会引发访问冲突？你冻结了所有其他线程吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T02:10:30.553

如果您在任何监视窗口中有任何函数调用，请将它们清除。

# oracle - Oracle 查询调优（重复表访问）

> ID：836771
> 
> 赞同：1
> 
> 时间：2009-05-07T20:08:48.423
> 
> 标签：oracle, performance

我正在尝试进一步调整此查询。该查询返回每个样本的三个不同测试的状态。但是，如果我希望进一步过滤返回的样本，我必须将条件放在两个 ' `SELECT ... FROM sample ...`' 查询中。

可以`sample`仅引用表一次重写此查询吗？

```
SELECT   sample_id,
         created_on,
         s_acid,
         s_ph,
         s_titr
  FROM 
      (SELECT sample_id, -- Rows w/ same sample_id to columns
              MAX (CASE WHEN tst_tmpl_id = 36 THEN status END) AS s_acid,
              MAX (CASE WHEN tst_tmpl_id = 43 THEN status END) AS s_ph,
              MAX (CASE WHEN tst_tmpl_id = 66 THEN status END) AS s_titr
         FROM (SELECT test_id, test_tmpl_id, sample_id FROM test)
         JOIN (SELECT sample_id      FROM sample WHERE sam_tmpl_id = 18)
              USING (sample_id)
         GROUP BY   sample_id
       )
        -- get other sample fields 
  JOIN (SELECT sample_id, created_on FROM sample WHERE sam_tmpl_id = 18)
       USING (sample_id) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T20:17:56.703

```
WITH q AS
        (
        SELECT  sample_id, created_on
        FROM    sample
        WHERE   sam_tmpl_id = 18
        )
SELECT  sample_id,
        created_on,
        s_acid,
        s_ph,
        s_titr
FROM    (
        SELECT  sample_id, -- Rows w/ same sample_id to columns
                MAX (CASE WHEN tst_tmpl_id = 36 THEN status END) AS s_acid,
                MAX (CASE WHEN tst_tmpl_id = 43 THEN status END) AS s_ph,
                MAX (CASE WHEN tst_tmpl_id = 66 THEN status END) AS s_titr
        FROM    (
                SELECT  test_id, test_tmpl_id, sample_id
                FROM    test
                )
        JOIN    q
        USING   (sample_id)
        GROUP BY
                sample_id
        )
JOIN    q
USING   (sample_id) 
```

# asp.net - 自定义服务器控件 - 基类和用法

> ID：836775
> 
> 赞同：1
> 
> 时间：2009-05-07T20:09:31.793
> 
> 标签：asp.net, custom-server-controls

我希望有人可以对创建服务器控件、控件基类和这些类的用法的主题有所了解。

这是我想要实现的一个例子。我想创建一个可以在 ASPX 标记中实例化的自定义面板控件，如下所示：

```
<acme:Panel ID="MyPanel" runtat="server" Scrolling="true">
  <Header>My Panel Header</Header>
  <Toolbars>
    <acme:Toolbar ID="Toolbar1" runat="server"/>
    <acme:Toolbar ID="Toolbar2" runat="server"/>
  </Toolbars>
  <Contents>
    <%-- Some Content for the Contents section --%>
  </Contents>
  <Footer>
    <%-- Some Content for the Footer section --%>
  </Footer>
</acme:Panel> 
```

它应该呈现以下 HTML：

```
<div id="MyPanel" class="panel scroll-contents">
  <div class="panel-header">
    <div class="panel-header-l"></div>
    <div class="panel-header-c">
      <div class="panel-header-wrapper">My Panel Header</div>
    </div>
    <div class="panel-header-r"></div>
  </div>
  <div class="panel-toolbars">
    // HTML of Toolbar control
  </div>
  <div class="panel-body">
    <div class="panel-body-t">
      <div class="panel-body-tl"></div>
      <div class="panel-body-tc"></div>
      <div class="panel-body-tr"></div>
    </div>
    <div class="panel-body-m">
      <div class="panel-body-ml"></div>
      <div class="panel-body-mc">
        <div class="panel-body-wrapper">
          // Contents
        </div>
      </div>
      <div class="panel-body-mr"></div>
    </div>
    <div class="panel-body-b">
      <div class="panel-body-bl"></div>
      <div class="panel-body-bc"></div>
      <div class="panel-body-br"></div>
    </div>
  </div>
  <div class="panel-footer">
    <div class="panel-footer-l"></div> 
    <div class="panel-footer-c">
      <div class="panel-footer-wrapper">
        // Footer contents
      </div>
    </div>
    <div class="panel-footer-r"></div>
  </div>
</div> 
```

开发人员应该能够省略除 Contents 部分之外的任何部分。不应呈现省略部分的 HTML。另外，用户应该能够在页面后面的代码中实例化/添加 Panel 控件，并向 Panel 控件的各个部分添加其他控件，如下所示：

```
ACME.Panel MyPanel = new ACME.Panel();
MyPlaceHolder.Controls.Add(MyPanel);

MyPanel.Header = "My Panel Header";

MyPanel.Toolbars.Controls.Add(new ACME.Toolbar());

MyPanel.Footer.Controls.Add(new Literal());

MyPanel.Contents.Controls.Add(new GridView()); 
```

我已阅读以下文章：通信部门对话：创作自定义 ASP.NET 服务器控件（哪个基类？）

由于我真的不希望开发人员更改控件的样式，因此 System.Web.UI.Control 基类就足够了，但我还需要应用 INamingContainer 接口。因此我的控制应该是这样的：

```
using System.Web;
using System.Web.UI;
using System.Web.UI.Design;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Security.Permissions;
namespace ACME
{
    [ToolboxData("&lt;{0}:Panel runat=server></{0}:Panel >")]
    [ParseChildren(true)]
    public class Panel : Control, INamingContainer
    {
        private string _header;
        private ITemplate _toolbars;
        private ITemplate _contents;
        private ITemplate _footerContents;
        public DialogBox()
        {
        }
        [Browsable(false),
        PersistenceMode(PersistenceMode.InnerProperty)]
        public virtual ITemplate Toolbars
        {
            get { return _toolbars; }
            set { _toolbars = value; }
        }
        [Browsable(false),
        PersistenceMode(PersistenceMode.InnerProperty)]
        public virtual ITemplate Contents
        {
            get { return _contents; }
            set { _contents= value; }
        }
        [Browsable(false),
        PersistenceMode(PersistenceMode.InnerProperty)]
        public virtual ITemplate Footer
        {
            get { return _footerContents; }
            set { _footerContents = value; }
        }
    }
} 
```

我已经阅读了很多教程，但它们要么没有涵盖我的预期实现，要么没有解释为什么采用某种方法。他们也让我很困惑，以至于我求助于 JavaScript 来动态呈现必要的 HTML。如果那里有任何控制大师，您能否解释一下您将如何完成这项任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T00:19:27.683

这将是一个很长的代码，需要遵循很多代码：

因为您有很多想要渲染的通用元素，所以我从一个 BaseControl 开始，它定义了一些通用方法来生成您所追求的所有 div。这继承自[System.Web.UI.Control](http://msdn.microsoft.com/en-us/library/system.web.ui.control.aspx) - 如文档所述：

> 这是您在开发自定义 ASP.NET 服务器控件时派生的主要类。**控件**没有任何用户界面 (UI) 特定功能。如果您正在创作一个没有 UI 的控件，或者组合了呈现自己的 UI 的其他控件，请从**Control**派生。

所以基本控制看起来像这样：

```
/// <summary>
/// Provides some common methods.
/// </summary>
public class BaseControl: Control
{
    protected Control[] TempControls;

    /// <summary>
    /// Clears the child controls explicitly, and stores them locally.
    /// </summary>
    protected void ClearControls()
    {
        if (HasControls())
        {
            TempControls = new Control[Controls.Count];
            Controls.CopyTo(TempControls, 0);
        }

        Controls.Clear();
    }
    /// <summary>
    /// Creates a new panel (HTML div) with the requested CSS 
    /// and containing any controls passed in.
    /// </summary>
    /// <param name="cssClass">The CSS class to be applied</param>
    /// <param name="controls">Any controls that should be added to the panel</param>
    protected Panel NewPanel(string cssClass, params Control[] controls)
    {
        // Create a new Panel, assign the CSS class.
        var panel = new Panel { CssClass = cssClass };

        // Loop through the controls adding them to the panel.
        foreach (var control in controls)
        {
            panel.Controls.Add(control);
        }

        return panel;
    }

    /// <summary>
    /// Creates a new row of panels (HTML div), based on the CSS class prefix.
    /// The center panel holds the controls passed in.
    /// </summary>
    /// <param name="cssClassPrefix"></param>
    /// <param name="controls"></param>
    protected Panel NewRow(string cssClassPrefix, params Control[] controls)
    {
        // Expaned for clarity, but could all be passed in on one call.
        var row = NewPanel(cssClassPrefix);
        row.Controls.Add(NewPanel(cssClassPrefix + "-l"));
        row.Controls.Add(NewPanel(cssClassPrefix + "-c", controls));
        row.Controls.Add(NewPanel(cssClassPrefix + "-r"));

        return row;
    }
} 
```

然后您需要创建一些控件来处理您的每个模板，我在这里创建了两个。

首先，将生成单行的控件 - 由页眉和页脚使用：

```
public class AcmeSimple : BaseControl, INamingContainer
{
    private string m_CssPrefix;

    public AcmeSimple(string cssPrefix)
    {
        m_CssPrefix = cssPrefix;
    }

    protected override void CreateChildControls()
    {

        ClearControls();

        Panel wrapper = NewPanel(m_CssPrefix + "-wrapper", TempControls);

        Panel simple = NewRow(m_CssPrefix, wrapper);

        Controls.Add(simple);

        base.CreateChildControls();
    }
} 
```

它创建一个新面板来保存控件，然后创建一个新的 div 行来保存包装器。

然后是一个稍微复杂的内容控件，其工作原理与标题相同：

```
public class AcmeContents: BaseControl, INamingContainer
{
    protected override void CreateChildControls()
    {
        ClearControls();

        Panel wrapper = NewPanel("panel-body-wrapper", TempControls);

        Panel contents = NewPanel("panel-body");
        contents.Controls.Add(NewRow("panel-body-t"));
        contents.Controls.Add(NewRow("panel-body-m", wrapper));
        contents.Controls.Add(NewRow("panel-body-b"));

        Controls.Add(contents);

        base.CreateChildControls();
    }
} 
```

所以这一行只创建了三行，其中中间的一行包含控件。

最后，您放置在页面上的实际控件：

```
[ParseChildren(true)]
[ToolboxData("<{0}:AcmeControl runat=server></{0}:AcmeControl>")]
public class AcmeControl: BaseControl, INamingContainer
{

    public bool Scrolling { get; set; }

    [TemplateContainer(typeof(AcmeSimple))]
    public ITemplate Header { get; set; }
    [TemplateContainer(typeof(AcmeContents))]
    public ITemplate Contents { get; set; }
    [TemplateContainer(typeof(AcmeSimple))]
    public ITemplate Footer { get; set; }

    protected override void CreateChildControls()
    {
        Controls.Clear();

        string cssClass = "panel";

        if (Scrolling)
        {
            cssClass += " scrollContents";
        }

        Panel panel = NewPanel(cssClass);
        panel.ID = ID;
        Controls.Add(panel);

        if (Header != null)
        {
            var header = new AcmeHeader("panel-header");
            Header.InstantiateIn(header);
            panel.Controls.Add(header);
        }

        if (Contents != null)
        {
            var contents = new AcmeContents();
            Contents.InstantiateIn(contents);
            panel.Controls.Add(contents);
        }
        else
        {
            // Possibly a little harsh, as it's a runtime exception.
            throw new ArgumentNullException("Contents", "You must supply a contents template.");
        }

        if (Footer != null)
        {
            var footer = new AcmeSimple("panel-footer");
            Footer.InstantiateIn(footer);
            panel.Controls.Add(footer);
        }
    }
} 
```

因此，我们将我们支持的模板定义为控件的属性，以及您想要的 Scrollable 属性。然后，在 CreateChildControls 中，我们开始使用我们在开始时创建的控件和 BaseControl 中的方法来构建控件的主体。

这进入这样的页面：

```
<cc1:AcmeControl ID="AcmeControl1" runat="server">
  <Header>
     <b>Here's a header</b>
  </Header>
  <Contents>
     <i>Here's some controls in the content.</i>
  </Contents>
</cc1:AcmeControl> 
```

并呈现如下：

```
<div id="AcmeControl1_AcmeControl1" class="panel">
    <div class="panel-header">
        <div class="panel-header-l">
        </div>
        <div class="panel-header-c">
            <div class="panel-header-wrapper">
                <b>Here's a header</b>
            </div>
        </div>
        <div class="panel-header-r">
        </div>
    </div>
    <div class="panel-body">
        <div class="panel-body-t">
            <div class="panel-body-t-l">
            </div>
            <div class="panel-body-t-c">
            </div>
            <div class="panel-body-t-r">
            </div>
        </div>
        <div class="panel-body-m">
            <div class="panel-body-m-l">
            </div>
            <div class="panel-body-m-c">
                <div class="panel-body-wrapper">
                    <i>Here's some controls in the content.</i>
                </div>
            </div>
            <div class="panel-body-m-r">
            </div>
        </div>
        <div class="panel-body-b">
            <div class="panel-body-b-l">
            </div>
            <div class="panel-body-b-c">
            </div>
            <div class="panel-body-b-r">
            </div>
        </div>
    </div>
</div> 
```

所以唯一的区别是内容样式是 tl 而不是 tl。

但是（这对您来说可能是一个大问题），模板控件并不是真正设计为从代码隐藏填充 - 您会注意到尝试编写：

```
AcmeControl1.Footer.Controls.Add([...]); 
```

不会编译。

但是，您可以调用：

```
AcmeControl1.Footer = Page.LoadTemplate([...]) 
```

**并传入ascx**文件的路径。

可以找到有关创建模板控件的进一步阅读：

*   [System.Web.UI.ITemplate](http://msdn.microsoft.com/en-us/library/system.web.ui.itemplate.aspx)
*   [如何：创建模板化 ASP.NET 用户控件](http://msdn.microsoft.com/en-us/library/36574bf6.aspx)
*   [如何：在 DataList Web 服务器控件中动态创建模板](http://msdn.microsoft.com/en-us/library/6d5z5yty.aspx)

我说会很长。

# php - 使用 PHP 获取用于嵌入式 swf 控件的 flv 文件

> ID：836776
> 
> 赞同：0
> 
> 时间：2009-05-07T20:09:46.363
> 
> 标签：php, flash, flv, protected

所以想做：从受保护的目录中获取一个 flv 文件，并将其作为参数提供给一个 swf 嵌入式播放器，使用 PHP。

这可能吗？

将文件内容发送到嵌入式播放器似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T20:37:05.500

好吧，由于播放器要求客户端从服务器获取播放器和 FLV，我怀疑这需要一个临时位置，用户可以通过 URL 访问 FLV。最明显的解决方案是创建一个在合理时间内超时的过期 URL，防止用户直接链接到 FLV。我不确定是否有办法在不将地址动态嵌入到闪存本身的文件中的情况下对其进行保护——基本上，您不能使用将 FLV 的 URL 作为参数的通用播放器，如果需要额外的保护。

**编辑：**这是使用 JW 播放器的潜在解决方案：[V4 中的代码 URL 用于防止盗窃者](http://www.longtailvideo.com/support/forum/Setup-Problems/11895/Code-URL-in-V4-for-protection-against-leechers)

这是我原始评论中的另一种可能的解决方案：[Flashcomguru.com: 'Streaming' flv video via PHP, take two](http://www.flashcomguru.com/index.cfm/2005/11/2/Streaming-flv-video-via-PHP-take-two)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:09:12.847

Flashcomguru 链接看起来很有希望，但不确定我是否理解这些内容。我不是 Flash 人，但我知道有人可以提供帮助。

我也不确定如何创建“创建过期 URL”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T18:38:02.147

不确定“使用 PHP 将其作为参数提供给 swf 嵌入式播放器”是什么意思，但看起来你想要做的是：

1.  将您的 flv 文件存储在服务器中 DocumentRoot 之外的某个位置。
2.  创建一个基于某些参数的 PHP 脚本，读取 flv 文件并提供它。我假设您计划在此 php 脚本中进行一些身份验证，以防止任何人仅调用您的 PHP 脚本并获取 flv，就好像它在 DocumentRoot 中一样
3.  创建一个 swf 剪辑，该剪辑将调用 PHP 脚本以将 flv 检索到客户端。

如果这是您想要的，那么 2 中读取和提供 flv 的脚本部分应该非常简单，使用来自 PHP API 的标准文件访问函数并在回显之前设置适当的内容类型标头。

# javascript - 如何检测浏览器的协议处理程序？

> ID：836777
> 
> 赞同：87
> 
> 时间：2009-05-07T20:10:19.717
> 
> 标签：javascript, browser, protocols, protocol-handler, moniker

我创建了一个自定义 URL 协议处理程序。

`http://`

`mailto://`

**`custom://`**

我已经注册了一个 WinForms 应用程序来做出相应的响应。这一切都很好。

但我希望能够优雅地处理用户尚未安装自定义 URL 协议处理程序的情况。

为了能够做到这一点，我需要能够检测浏览器的注册协议处理程序，我会假设来自 JavaScript。但我一直无法找到一种方法来轮询信息。我希望找到解决这个问题的方法。

感谢您可以分享的任何想法。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-07T20:41:49.157

这将是一种*非常***非常** ***老套***的方法......但这会奏效吗？

*   正常放链接...
*   但是附加一个 onclick 处理程序，它设置一个计时器并为窗口添加一个 onblur 处理程序
*   （理论上）如果浏览器处理链接（应用程序 X）将加载从窗口中窃取焦点......
*   如果 onblur 事件触发，请清除计时器...
*   否则在 3-5 秒内让你的超时触发......并通知用户“嗯，看起来你没有安装 Mega Uber Cool 应用程序......你想现在安装它吗？（好的）（取消）”

远非防弹......但它可能会有所帮助？

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-15T18:26:05.743

没有很好的跨浏览器方法可以做到这一点。在 Win8+ 上的 IE10+ 中，一个新的`msLaunchUri`api 使您能够启动一个协议，如下所示：

```
navigator.msLaunchUri('skype:123456', 
  function() 
  { 
    alert('success');
  }, 
  function()
  {
    alert('failed');
  } 
); 
```

如果未安装协议，将触发失败回调。否则，协议将启动并触发成功回调。

我在这里进一步讨论这个话题： [https ://web.archive.org/web/20180308105244/https://blogs.msdn.microsoft.com/ieinternals/2011/07/13/understanding-protocols/](https://web.archive.org/web/20180308105244/https://blogs.msdn.microsoft.com/ieinternals/2011/07/13/understanding-protocols/)

这个话题是最近（2021 年）感兴趣的；请参阅[https://github.com/fingerprintjs/external-protocol-flooding](https://github.com/fingerprintjs/external-protocol-flooding)进行讨论。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-04-25T18:25:06.180

HTML5 定义了[自定义方案和内容处理程序](http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#custom-handlers)（据我所知，Firefox 是目前唯一的[实现](https://developer.mozilla.org/en/Web-based_protocol_handlers)者），但不幸的是，目前无法检查处理程序是否已经存在——它已经被[提出](http://lists.whatwg.org/pipermail/whatwg-whatwg.org/2009-January/018101.html)，但没有后续行动。这似乎是有效使用自定义处理程序的关键特性，我们作为开发人员应该注意这个问题，以便实现它。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-11-06T15:56:14.830

似乎没有直接的方法通过 javascript 来检测是否存在已注册协议处理程序的已安装应用程序。

在 iTunes 模型中，Apple 为其服务器提供 url，然后提供运行一些 javascript 的页面：

[http://ax.itunes.apple.com/detection/itmsCheck.js](http://ax.itunes.apple.com/detection/itmsCheck.js)

因此，iTunes 安装程序显然为主要浏览器部署了插件，然后可以检测到它们的存在。

如果您的插件已安装，那么您可以合理地确定重定向到您的应用程序特定的 url 会成功。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-01-24T08:34:42.673

最简单的解决方案是在第一时间询问用户。

每个示例使用 Javascript 确认对话框：

```
You need this software to be able to read this link. Did you install it ?

if yes: create a cookie to not ask next time; return false and the link applies
if false: window.location.href = '/downloadpage/' 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-04-26T07:47:53.257

如果您可以控制您尝试运行的程序（代码），那么查看用户是否成功运行应用程序的一种方法是：

1.  在尝试打开自定义协议之前，向服务器脚本发出 AJAX 请求，该脚本将用户的意图保存在数据库中（例如，保存用户 ID 和他想要做什么）。

2.  尝试打开程序，并传递意图数据。

3.  让程序向服务器发出请求以删除数据库条目（使用意图数据查找正确的行）。

4.  让 javascript 轮询服务器一段时间以查看数据库条目是否消失。如果条目消失了，您将知道用户已成功打开应用程序，否则条目将保留（您可以稍后使用 cronjob 将其删除）。

这个方法我没试过，只是想。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-02-26T23:17:01.950

我终于得到了一个跨浏览器（Chrome 32、Firefox 27、IE 11、Safari 6）的解决方案，它结合了[这个](http://www.rajeshsegu.com/2012/09/browser-detect-custom-protocols/comment-page-1/)和一个超级简单的 Safari 扩展。在这个和[另一个问题](https://stackoverflow.com/questions/2872090/how-to-check-if-a-custom-protocol-supported)中以一种或另一种方式提到了这个解决方案的大部分。

这是脚本：

```
function launchCustomProtocol(elem, url, callback) {
    var iframe, myWindow, success = false;

    if (Browser.name === "Internet Explorer") {
        myWindow = window.open('', '', 'width=0,height=0');
        myWindow.document.write("<iframe src='" + url + "'></iframe>");

        setTimeout(function () {
            try {
                myWindow.location.href;
                success = true;
            } catch (ex) {
                console.log(ex);
            }

            if (success) {
                myWindow.setTimeout('window.close()', 100);
            } else {
                myWindow.close();
            }

            callback(success);
        }, 100);
    } else if (Browser.name === "Firefox") {
        try {
            iframe = $("<iframe />");
            iframe.css({"display": "none"});
            iframe.appendTo("body");
            iframe[0].contentWindow.location.href = url;

            success = true;
        } catch (ex) {
            success = false;
        }

        iframe.remove();

        callback(success);
    } else if (Browser.name === "Chrome") {
        elem.css({"outline": 0});
        elem.attr("tabindex", "1");
        elem.focus();

        elem.blur(function () {
            success = true;
            callback(true);  // true
        });

        location.href = url;

        setTimeout(function () {
            elem.off('blur');
            elem.removeAttr("tabindex");

            if (!success) {
                callback(false);  // false
            }
        }, 1000);
    } else if (Browser.name === "Safari") {
        if (myappinstalledflag) {
            location.href = url;
            success = true;
        } else {
            success = false;
        }

        callback(success);
    }
} 
```

Safari 扩展很容易实现。它由一行注入脚本组成：

myinject.js：

```
window.postMessage("myappinstalled", window.location.origin); 
```

然后在网页 JavaScript 中，需要先注册消息事件，如果收到消息则设置一个标志：

```
window.addEventListener('message', function (msg) {
    if (msg.data === "myappinstalled") {
        myappinstalledflag = true;
    }
}, false); 
```

这假设与自定义协议关联的应用程序将管理 Safari 扩展的安装。

在所有情况下，如果回调返回 false，您就知道通知用户应用程序（即，它的自定义协议）未安装。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-10T20:30:59.047

你可以尝试这样的事情：

```
function OpenCustomLink(link) {

    var w = window.open(link, 'xyz', 'status=0,toolbar=0,menubar=0,height=0,width=0,top=-10,left=-10');
    if(w == null) {            
        //Work Fine
    }
    else {
        w.close();
        if (confirm('You Need a Custom Program. Do you want to install?')) {
            window.location = 'SetupCustomProtocol.exe'; //URL for installer
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-09-28T06:12:09.603

你说你需要检测浏览器的协议处理程序——你真的吗？

如果你做了类似从 sourceforge 下载文件时发生的事情怎么办？假设您要打开 myapp://something。与其简单地创建指向它的链接，不如创建指向通过 HTTP 访问的另一个 HTML 页面的链接。然后，在该页面上，假设您正在尝试为他们打开应用程序。如果它不起作用，他们需要安装您的应用程序，他们可以通过单击您提供的链接来完成。如果它确实有效，那么你就准备好了。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-12-06T08:53:53.817

这是 Microsoft 支持为 IE 推荐的方法

[http://msdn.microsoft.com/en-us/library/ms537503%28VS.85%29.aspx#related_topics](http://msdn.microsoft.com/en-us/library/ms537503%28VS.85%29.aspx#related_topics)

“如果您对安装在用户计算机上的二进制文件有一定的控制权，那么在脚本中检查 UA 似乎是一种相关的方法：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\User Agent\Post Platform” --由 M$ 支持

每个网页都可以访问 userAgent 字符串，如果您删除自定义发布平台值，则使用 navigator.userAgent 在 javascript 中检测这一点非常简单。

幸运的是，其他主要浏览器，如 Firefox 和 Chrome（除了 Safari :( ），当单击带有自定义协议的链接并且该协议未安装在用户计算机上时，不会抛出“找不到页面”错误。IE 在这里非常无情, 任何在不可见框架中单击或捕获 javascript 错误的技巧都不起作用，并以丑陋的“网页无法显示”错误告终。我们在案例中使用的技巧是通过浏览器特定图像通知用户单击自定义协议链接将打开一个应用程序。如果他们没有找到打开的应用程序，他们可以单击“安装”页面。就 XD 而言，此 wprks 比 IE 的 ActiveX 方法更好。对于 FF 和 Chrome，请继续并在没有任何检测的情况下启动自定义协议。让用户告诉你他看到了什么。对于 Safari，：（还没有答案

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-01-29T20:20:50.267

我正在尝试做类似的事情，我刚刚发现了一个适用于 Firefox 的技巧。如果你将它与 IE 的技巧结合起来，你可以拥有一个在两种主要浏览器上都可以使用的工具（我不确定它是否适用于 Safari，我知道它在 Chrome 中不起作用）

```
if (navigator.appName=="Microsoft Internet Explorer" && document.getElementById("testprotocollink").protocolLong=="Unknown Protocol") {
    alert("No handler registered");
} else {
    try {
        window.location = "custom://stuff";
    } catch(err) {
        if (err.toString().search("NS_ERROR_UNKNOWN_PROTOCOL") != -1) {
            alert("No handler registered");
        }
    }
} 
```

为了使其工作，您还需要在页面上的某处有一个隐藏链接，如下所示：

```
<a id="testprotocollink" href="custom://testprotocol" style="display: none;">testprotocollink</a> 
```

这有点hacky，但它有效。不幸的是，Firefox 版本仍然会在您尝试访问具有未知协议的链接时弹出默认警报，但它会在警报解除后运行您的代码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-08T02:00:50.217

这不是一项微不足道的任务。一种选择可能是使用签名代码，您可以利用它来访问注册表和/或文件系统（请注意，这是一个[非常昂贵](http://www.thawte.com/code-signing/index.html?click=DoYouNeedTo-SecureCode)的选择）。代码签名也没有统一的 API 或规范，因此您需要为每个目标浏览器生成特定的代码。支持的噩梦。

另外，我知道游戏内容交付系统[Steam](http://steampowered.com)似乎也没有解决这个问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-03-27T21:48:22.687

这是另一个 hacky 答案，需要（希望是轻量）修改您的应用程序以在启动时“打电话回家”。

1.  用户单击链接，该链接尝试启动应用程序。链接中放置了一个唯一标识符，以便在应用程序启动时将其传递给应用程序。Web 应用程序显示了一个微调器或类似的东西。
2.  然后网页开始检查来自具有相同唯一 ID 的应用程序的“应用程序电话主页”事件。
3.  启动时，您的应用程序会使用唯一标识符向您的 Web 应用程序发送 HTTP 帖子，以表明存在。
4.  网页要么看到应用程序最终启动，要么继续使用“请下载”页面。

# c# - Reserve screen area in Windows 7

> ID：836786
> 
> 赞同：5
> 
> 时间：2009-05-07T20:11:27.623
> 
> 标签：c#, .net, windows-7, taskbar

Is it possible to reserve a screen area near an edge of the screen for your app in Windows 7? It would behave similar to the Windows taskbar (i.e. maximized windows would not overlap with it).

I'm writing a taskbar app with proper support for multiple monitors. The primary purpose is to show a taskbar on each screen containing only the apps on that screen. None of the existing solutions ([Ulltramon](http://www.realtimesoft.com/ultramon/), [DisplayFusion](http://www.binaryfortress.com/displayfusion/)) I know of work for Win 7, and none are open source.

C# code would be nice, but any hints are appreciated as well.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T20:23:19.967

I feel silly answering my own question, but thanks to Michael's hint, I found an appropriate [C# code sample](http://www.google.com/search?hl=en&q=SPI_SETWORKAREA+C%23&btnG=Google+Search&aq=f&oq=).

```
using System;
using System.Runtime.InteropServices;

public class WorkArea
{
  [System.Runtime.InteropServices.DllImport("user32.dll",  EntryPoint="SystemParametersInfoA")]
  private static extern Int32 SystemParametersInfo(Int32 uAction, Int32 uParam, IntPtr lpvParam, Int32 fuWinIni);

  private const Int32 SPI_SETWORKAREA = 47;
  public WorkArea(Int32 Left,Int32 Right,Int32 Top,Int32 Bottom)
  {
    _WorkArea.Left = Left;
    _WorkArea.Top = Top;
    _WorkArea.Bottom = Bottom;
    _WorkArea.Right = Right;
  }

  public struct RECT
  {
    public Int32 Left;
    public Int32 Right;
    public Int32 Top;
    public Int32 Bottom;
  }

  private RECT _WorkArea;
  public void SetWorkingArea()
  {
    IntPtr ptr = IntPtr.Zero;
    ptr = Marshal.AllocHGlobal(Marshal.SizeOf(_WorkArea));
    Marshal.StructureToPtr(_WorkArea,ptr,false);
    int i = SystemParametersInfo(SPI_SETWORKAREA,0,ptr,0);
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T20:15:23.463

I'm unsure of how to do this directly in C#, but in native code you can call SystemParametersInfo with SPI_SETWORKAREA. This is how apps like the taskbar, sidebar, and so on can prevent maximized windows from overlapping them.

[http://msdn.microsoft.com/en-us/library/ms724947.aspx](http://msdn.microsoft.com/en-us/library/ms724947.aspx) is the documentation for SystemParametersInfo.

[http://social.msdn.microsoft.com/forums/en-US/winforms/thread/9fe831e5-ccfb-4e8d-a129-68c301c83acb](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/9fe831e5-ccfb-4e8d-a129-68c301c83acb/)/ shows P/Invoke signatures for this method.

# ruby-on-rails - 图形边缘导轨

> ID：836800
> 
> 赞同：2
> 
> 时间：2009-05-07T20:13:30.003
> 
> 标签：ruby-on-rails, relational

我最近在尝试在 Rails 中建立双向关系时发现了这一点（[http://www.dweebd.com/sql/modeling-bidirectional-graph-edges-in-rails/](http://www.dweebd.com/sql/modeling-bidirectional-graph-edges-in-rails/)）

```
class Befriending < ActiveRecord::Base
  belongs_to :initiator, :class_name => :User
  belongs_to :recipient, :class_name => :User
  after_create do |b|
    BefriendingEdge.create!(:user => b.initiator, :befriending => b)
    BefriendingEdge.create!(:user => b.recipient, :befriending => b)
  end
end

class BefriendingEdge < ActiveRecord::Base
  belongs_to :user
  belongs_to :befriending
end

class User < ActiveRecord::Base
  has_many :befriending_edges
  has_many :friends, :through => :befriending_edges, :source => :user
  has_many :befriendings, :through => :befriending_edges, :source => :befriending
end 
```

但我只是不太明白它是如何工作的。谁能帮我解释一下。它看起来像一个双重的belongs_to。只是不太明白这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-29T14:17:10.213

1.  我是用户
2.  我有朋友
3.  我的朋友也是用户

使用图表（http://en.wikipedia.org/wiki/Graph_%28mathematics%29）对此进行建模的方法是

*   代表用户/朋友的节点
*   代表友谊链接的边

所以是的：用数据库术语来说，“用户属于用户”：我的朋友也是用户。但此外，友谊是双向的：如果我们是朋友，这意味着，我是你的朋友**，**你是我的朋友。

此外，使用单独的模型来存储边/关系允许您潜在地存储有关友谊的附加信息（例如，“自以来的朋友”）。

# java - 在 XStream 中是否有更好的方法来编组/解组列表's in JSON and Java I'm using XStream and JETTISON's Stax JSON serializer to send/receive messages to/from JSON javascripts 问问题 问问题 2009-05-07T20:14:27.850 14125 次 This question shows research effort; it is useful and clear 9 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I'm using XStream and JETTISON's Stax JSON serializer to send/receive messages to/from JSON javascripts clients and Java web applications. I want to be able to create a list of objects to send to the server and be properly marshalled into Java but the format that XStream and JSON expect it in is very non-intuitive and requires our javascript libraries to jump through hoops. [EDIT Update issues using GSON library] I attempted to use the GSON library but it cannot deserialize concrete objects when I only have it expect generic super classes (XStream and Jettison handles this because type information is baked into the serialization). GSON FAQ states Collection Limitation: Collections Limitations Can serialize collection of arbitrary objects but can not deserialize from it Because there is no way for the user to indicate the type of the resulting object While deserializing, Collection must be of a specific generic type Maybe I'm using bad java practices but how would I go about building a JSON to Java messaging framework that sent/received various concrete Message objects in JSON format? For example this fails: public static void main(String[] args) { Gson gson = new Gson(); MockMessage mock1 = new MockMessage(); MockMessage mock2 = new MockMessage(); MockMessageOther mock3 = new MockMessageOther(); List<MockMessage> messages = new ArrayList<MockMessage>(); messages.add(mock1); messages.add(mock2); messages.add(mock3); String jsonString = gson.toJson(messages); //JSON list format is non-intuitive single element array with class name fields System.out.println(jsonString); List gsonJSONUnmarshalledMessages = (List)gson.fromJson(jsonString, List.class); //This will print 3 messages unmarshalled System.out.println("XStream format JSON Number of messages unmarshalled: " + gsonJSONUnmarshalledMessages.size()); } [{"val":1},{"val":1},{"otherVal":1,"val":1}] Exception in thread "main" com.google.gson.JsonParseException: The JsonDeserializer com.google.gson.DefaultTypeAdapters$CollectionTypeAdapter@638bd7f1 failed to deserialized json object [{"val":1},{"val":1},{"otherVal":1,"val":1}] given the type interface java.util.List Here's an example, I want to send a list of 3 Message objects, 2 are of the same type and the 3rd is a different type. import java.util.ArrayList; import java.util.List; import com.thoughtworks.xstream.XStream; import com.thoughtworks.xstream.io.json.JettisonMappedXmlDriver; class MockMessage { int val = 1; } class MockMessageOther { int otherVal = 1; } public class TestJSONXStream { public static void main(String[] args) { JettisonMappedXmlDriver xmlDriver = new JettisonMappedXmlDriver(); XStream xstream = new XStream(xmlDriver); MockMessage mock1 = new MockMessage(); MockMessage mock2 = new MockMessage(); MockMessageOther mock3 = new MockMessageOther(); List messages = new ArrayList(); messages.add(mock1); messages.add(mock2); messages.add(mock3); String jsonString = xstream.toXML(messages); //JSON list format is non-intuitive single element array with class name fields System.out.println(jsonString); List xstreamJSONUnmarshalledMessages = (List)xstream.fromXML(jsonString); //This will print 3 messages unmarshalled System.out.println("XStream format JSON Number of messages unmarshalled: " + xstreamJSONUnmarshalledMessages.size()); //Attempt to deserialize a reasonable looking JSON string String jsonTest = "{"+ "\"list\" : ["+ "{"+ "\"MockMessage\" : {"+ "\"val\" : 1"+ "}"+ "}, {"+ "\"MockMessage\" : {"+ "\"val\" : 1"+ "}"+ "}, {"+ "\"MockMessageOther\" : {"+ "\"otherVal\" : 1"+ "}"+ "} ]"+ "};"; List unmarshalledMessages = (List)xstream.fromXML(jsonTest); //We expect 3 messages but XStream only deserializes one System.out.println("Normal format JSON Number of messages unmarshalled: " + unmarshalledMessages.size()); } } Intuitively I expect the XStream JSON to be serialized (and able to deserialize correctly) from the following format: { "list" : [ { "MockMessage" : { "val" : 1 } }, { "MockMessage" : { "val" : 1 } }, { "MockMessageOther" : { "otherVal" : 1 } } ] } Instead XStream creates a single element list with fields that are named the classnames and nested arrays of Objects of the same type. { "list" : [ { "MockMessage" : [ { "val" : 1 }, { "val" : 1 } ], "MockMessageOther" : { "otherVal" : 1 } } ] } The trouble may be caused by it using the XStream XML CollectionConverter? Does anyone have a suggestion for a good JSON Java object serialization that allows you to read/write arbitrary Java objects. I looked at the Jackson Java JSON Processor but when you were reading in objects from a stream you had to specify what type of object it was unlike XStream where it will read in any object (because the serialized XStream JSON contains class name information). I realize this is off-topic, but I'd like to present a solution in svenson JSON. Do you really need public fields in your domain classes? Apart from having to use properties, svenson can handle cases like this with a more simple JSON output with a discriminator property class Message { // .. your properties with getters and setters .. // special property "type" acts a signal for conversion } class MessageOther { ... } List list = new ArrayList(); list.add(new Message()); list.add(new MessageOther()); list.add(new Message()); String jsonDataSet = JSON.defaultJSON().forValue(list); would output JSON like [ {"type":"message", ... }, {"type":"message_other", ... }, {"type":"message", ... } ] which could be parsed again with code like this // configure reusable parse instance JSONParser parser = new JSONParser(); // type mapper to map to your types PropertyValueBasedTypeMapper mapper = new PropertyValueBasedTypeMapper(); mapper.setParsePathInfo("[]"); mapper.addFieldValueMapping("message", Message.class); mapper.addFieldValueMapping("message_other", MessageOther.class); parser.setTypeMapper(mapper); List list = parser.parse(List.class, jsonDataset); javaajaxjsonserializationxstream 4 3 回答 3 This answer is useful 6 I agree with other poster in that XStream is not a good fit -- it's an OXM (Object/Xml Mapper), and JSON is handled as a secondary output format using XML processing path. This is why a "convention" (of how to convert hierarchich xml model into object-graph model of json and vice versa) is needed; and your choice boils down to using whatever is least intrusive of sub-optimal choices. That works ok if XML is your primary data format, and you just need some rudimentary JSON(-like) support. To get good JSON-support, I would consider using a JSON processing library that does real OJM mapping (I assume Svenson does too, but additionally), such as: Jackson Google-gson Also: even if you do need to support both XML and JSON, you are IMO better off using separate libraries for these tasks -- objects (beans) to use on server-side need not be different, just serialization libs that convert to/from xml and json. 于 2009-05-11T18:50:09.007 回答 This answer is useful 0 A svenson type mapper based on the full class name would look something like this public class ClassNameBasedTypeMapper extends PropertyValueBasedTypeMapper { protected Class getTypeHintFromTypeProperty(String value) throws IllegalStateException { try { return Class.forName(value); } catch (ClassNotFoundException e) { throw new IllegalStateException(value + " is no valid class", e); } } } which is not an ideal implementation as it inherits the configuration of PropertyValueBasedTypeMapper without really needing. (should include a cleaner version in svenson) The setup is very much like above JSONParser parser = new JSONParser(); ClassNameBasedTypeMapper mapper = new ClassNameBasedTypeMapper(); mapper.setParsePathInfo("[]"); parser.setTypeMapper(mapper); List foos = parser .parse( List.class, "[{\"type\":\"package.Foo\"},{\"type\":\"package.Bar\"}]"); 于 2009-05-07T22:26:19.950 回答 This answer is useful 0 我意识到这是题外话，但我想在svenson JSON中提出一个解决方案。 您的域类中真的需要公共字段吗？除了必须使用属性之外，svenson 还可以使用带有鉴别器属性的更简单的 JSON 输出来处理此类情况 class Message { // .. your properties with getters and setters .. // special property "type" acts a signal for conversion } class MessageOther { ... } List list = new ArrayList(); list.add(new Message()); list.add(new MessageOther()); list.add(new Message()); String jsonDataSet = JSON.defaultJSON().forValue(list); 会像这样输出 JSON [ {"type":"message", ... }, {"type":"message_other", ... }, {"type":"message", ... } ] 可以用这样的代码再次解析 // configure reusable parse instance JSONParser parser = new JSONParser(); // type mapper to map to your types PropertyValueBasedTypeMapper mapper = new PropertyValueBasedTypeMapper(); mapper.setParsePathInfo("[]"); mapper.addFieldValueMapping("message", Message.class); mapper.addFieldValueMapping("message_other", MessageOther.class); parser.setTypeMapper(mapper); List list = parser.parse(List.class, jsonDataset); 于 2009-05-07T21:34:38.530 回答 Related 1 r - 在 R 中绘制史密斯圆图 1 java - 为什么代码没有读取 nextLine()？ 2 maven - 具有属性的 Maven checkstyle 插件 1 javascript - Phonegap 3.0 媒体 API - 损坏？ 2 css - Twitter Bootstrap V3 中的内容重叠 2 c# - 将表示整数的字节数组从 c# 发送到 java 客户端的问题 2 html - 为什么 dec < 255 的 HTML 实体名称不需要分号？ 0 php - 我需要一些有关 innerhtml 执行“echo so_shortcode”的帮助 8 python - numpy 数组：用列的平均值替换 nan 值 1 matlab - 读取 CSV 文件并使用 Surf 绘制时间序列数据 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：836805
> 
> 赞同：9
> 
> 时间：
> 
> 标签：java, ajax, json, serialization, xstream

I'm using [XStream](http://xstream.codehaus.org/json-tutorial.html) and JETTISON's Stax JSON serializer to send/receive messages to/from JSON javascripts clients and Java web applications.

I want to be able to create a list of objects to send to the server and be properly marshalled into Java but the format that XStream and JSON expect it in is very non-intuitive and requires our javascript libraries to jump through hoops.

[EDIT Update issues using [GSON](http://code.google.com/p/google-gson/) library] I attempted to use the [GSON library](http://code.google.com/p/google-gson/) but it cannot deserialize concrete objects when I only have it expect generic super classes (XStream and Jettison handles this because type information is baked into the serialization).

[GSON FAQ states Collection Limitation](https://sites.google.com/site/gson/gson-user-guide#TOC-Collections-Limitations):

> Collections Limitations
> 
> Can serialize collection of arbitrary objects but can not deserialize from it
> 
> Because there is no way for the user to indicate the type of the resulting object
> 
> While deserializing, Collection must be of a specific generic type

Maybe I'm using bad java practices but how would I go about building a JSON to Java messaging framework that sent/received various concrete Message objects in JSON format?

For example this fails:

```
public static void main(String[] args) {
    Gson gson = new Gson();

    MockMessage mock1 = new MockMessage();
    MockMessage mock2 = new MockMessage();
    MockMessageOther mock3 = new MockMessageOther();

    List<MockMessage> messages = new ArrayList<MockMessage>();
    messages.add(mock1);
    messages.add(mock2);
    messages.add(mock3);

    String jsonString = gson.toJson(messages);

    //JSON list format is non-intuitive single element array with class name fields
    System.out.println(jsonString);
    List gsonJSONUnmarshalledMessages = (List)gson.fromJson(jsonString, List.class);
    //This will print 3 messages unmarshalled
    System.out.println("XStream format JSON Number of messages unmarshalled: " + gsonJSONUnmarshalledMessages.size());
}

[{"val":1},{"val":1},{"otherVal":1,"val":1}]
Exception in thread "main" com.google.gson.JsonParseException: The JsonDeserializer com.google.gson.DefaultTypeAdapters$CollectionTypeAdapter@638bd7f1 failed to deserialized json object [{"val":1},{"val":1},{"otherVal":1,"val":1}] given the type interface java.util.List 
```

Here's an example, I want to send a list of 3 Message objects, 2 are of the same type and the 3rd is a different type.

```
import java.util.ArrayList;
import java.util.List;

import com.thoughtworks.xstream.XStream;
import com.thoughtworks.xstream.io.json.JettisonMappedXmlDriver;

class MockMessage {
    int val = 1;
}
class MockMessageOther {
    int otherVal = 1;
}

public class TestJSONXStream {

    public static void main(String[] args) {
        JettisonMappedXmlDriver xmlDriver = new JettisonMappedXmlDriver();        
        XStream xstream = new XStream(xmlDriver);

        MockMessage mock1 = new MockMessage();
        MockMessage mock2 = new MockMessage();
        MockMessageOther mock3 = new MockMessageOther();

        List messages = new ArrayList();
        messages.add(mock1);
        messages.add(mock2);
        messages.add(mock3);

        String jsonString = xstream.toXML(messages);

        //JSON list format is non-intuitive single element array with class name fields
        System.out.println(jsonString);
        List xstreamJSONUnmarshalledMessages = (List)xstream.fromXML(jsonString);
        //This will print 3 messages unmarshalled
        System.out.println("XStream format JSON Number of messages unmarshalled: " + xstreamJSONUnmarshalledMessages.size());

        //Attempt to deserialize a reasonable looking JSON string
        String jsonTest = 
              "{"+
                "\"list\" : ["+ 
                          "{"+
                          "\"MockMessage\" : {"+
                              "\"val\" : 1"+
                          "}"+
                      "}, {"+
                          "\"MockMessage\" : {"+
                              "\"val\" : 1"+
                          "}"+
                      "}, {"+
                          "\"MockMessageOther\" : {"+
                              "\"otherVal\" : 1"+
                          "}"+
                      "} ]"+
                  "};";

        List unmarshalledMessages = (List)xstream.fromXML(jsonTest);

        //We expect 3 messages but XStream only deserializes one
        System.out.println("Normal format JSON Number of messages unmarshalled: " + unmarshalledMessages.size());
    }

} 
```

Intuitively I expect the XStream JSON to be serialized (and able to deserialize correctly) from the following format:

```
{
    "list" : [ 
        {
        "MockMessage" : {
            "val" : 1
        }
    }, {
        "MockMessage" : {
            "val" : 1
        }
    }, {
        "MockMessageOther" : {
            "otherVal" : 1
        }
    } ]
} 
```

Instead XStream creates a single element list with fields that are named the classnames and nested arrays of Objects of the same type.

```
{
    "list" : [ {
        "MockMessage" : [ {
            "val" : 1
        }, {
            "val" : 1
        } ],
        "MockMessageOther" : {
            "otherVal" : 1
        }
    } ]
} 
```

The trouble may be caused by it using the XStream XML [CollectionConverter](http://xstream.codehaus.org/converters.html)?

Does anyone have a suggestion for a good JSON Java object serialization that allows you to read/write arbitrary Java objects. I looked at the [Jackson Java JSON Processor](http://jackson.codehaus.org/) but when you were reading in objects from a stream you had to specify what type of object it was unlike XStream where it will read in any object (because the serialized XStream JSON contains class name information).

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-11T18:50:09.007

I agree with other poster in that XStream is not a good fit -- it's an OXM (Object/Xml Mapper), and JSON is handled as a secondary output format using XML processing path. This is why a "convention" (of how to convert hierarchich xml model into object-graph model of json and vice versa) is needed; and your choice boils down to using whatever is least intrusive of sub-optimal choices. That works ok if XML is your primary data format, and you just need some rudimentary JSON(-like) support.

To get good JSON-support, I would consider using a JSON processing library that does real OJM mapping (I assume Svenson does too, but additionally), such as:

*   [Jackson](http://jackson.codehaus.org/Tutorial)
*   [Google-gson](http://code.google.com/p/google-gson/)

Also: even if you do need to support both XML and JSON, you are IMO better off using separate libraries for these tasks -- objects (beans) to use on server-side need not be different, just serialization libs that convert to/from xml and json.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:26:19.950

A svenson type mapper based on the full class name would look something like this

```
public class ClassNameBasedTypeMapper extends PropertyValueBasedTypeMapper
{
    protected Class getTypeHintFromTypeProperty(String value) throws IllegalStateException
    {
        try
        {
            return Class.forName(value);
        }
        catch (ClassNotFoundException e)
        {
            throw new IllegalStateException(value + " is no valid class", e);
        }
    }
} 
```

which is not an ideal implementation as it inherits the configuration of PropertyValueBasedTypeMapper without really needing. (should include a cleaner version in svenson)

The setup is very much like above

```
JSONParser parser = new JSONParser();
ClassNameBasedTypeMapper mapper = new ClassNameBasedTypeMapper();
mapper.setParsePathInfo("[]");
parser.setTypeMapper(mapper);

List foos = parser
    .parse( List.class, "[{\"type\":\"package.Foo\"},{\"type\":\"package.Bar\"}]"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T21:34:38.530

我意识到这是题外话，但我想在[svenson JSON](http://code.google.com/p/svenson/)中提出一个解决方案。

您的域类中真的需要公共字段吗？除了必须使用属性之外，svenson 还可以使用带有鉴别器属性的更简单的 JSON 输出来处理此类情况

```
class Message
{
   // .. your properties with getters and setters .. 
   // special property "type" acts a signal for conversion
}

class MessageOther
{
  ...
}

List list = new ArrayList();
list.add(new Message());
list.add(new MessageOther());
list.add(new Message());

String jsonDataSet = JSON.defaultJSON().forValue(list); 
```

会像这样输出 JSON

```
[
    {"type":"message", ... }, 
    {"type":"message_other", ... }, 
    {"type":"message", ... }
] 
```

可以用这样的代码再次解析

```
 // configure reusable parse instance
    JSONParser parser = new JSONParser();

    // type mapper to map to your types
    PropertyValueBasedTypeMapper mapper = new PropertyValueBasedTypeMapper();
    mapper.setParsePathInfo("[]");
    mapper.addFieldValueMapping("message", Message.class);
    mapper.addFieldValueMapping("message_other", MessageOther.class);
    parser.setTypeMapper(mapper);

    List list = parser.parse(List.class, jsonDataset); 
```

# c# - C# XMLDocument 到 DataTable？

> ID：836806
> 
> 赞同：13
> 
> 时间：2009-05-07T20:14:36.773
> 
> 标签：c#, .net, datatable, dataset, xmldocument

我假设我必须通过 DataSet 执行此操作，但它不喜欢我的语法。

我有一个名为“XmlDocument xmlAPDP”的 XMLDocument。

我希望它在一个名为“DataTable dtAPDP”的数据表中。

我还有一个名为“DataSet dsAPDP”的数据集。

-

如果我做 DataSet dsAPDP.ReadXML(xmlAPDP) 它不喜欢那样，因为 ReadXML 想要一个字符串，我假设一个文件名？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-07T20:51:01.427

无需破解：

```
xmlAPDP = new XmlDocument()
...
xmlReader = new XmlNodeReader(xmlAPDP)
dataSet = new DataSet()
...
dataSet.ReadXml(xmlReader) 
```

XmlDocument 是一个 XmlNode，XmlNodeReader 是一个 XmlReader，ReadXml 接受。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-11T17:34:23.493

ASP.net 示例：

```
private DataTable GetReportDataTable()
{
    //get mapped path to xml document
    string xmlDocString = Server.MapPath("CustomReports.xml");

    //read into dataset
    DataSet dataSet = new DataSet();
    dataSet.ReadXml(xmlDocString);

    //return single table inside of dataset
    return dataSet.Tables[0];
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T20:30:44.003

这样的事情怎么样？

```
dsAPDP.ReadXml(new MemoryStream(ASCIIEncoding.ASCII.GetBytes(xmlAPDP.OuterXml))) 
```

# asp.net - IIS 如何知道它是服务于网站还是 Web 应用程序项目？

> ID：836811
> 
> 赞同：12
> 
> 时间：2009-05-07T20:15:51.263
> 
> 标签：asp.net, iis, compilation

我知道网站项目会即时编译源代码，而 Web 应用程序项目会将源代码预编译成 DLL（很像 ASP.Net 1.x）。

但是在 IIS 中如何指定差异？

我知道 Visual Studio 知道——每个项目都有不同的项目，等等。但是运行实例（IIS + Framework）*必须*知道正在使用哪种编译模型，对吧？因为它怎么知道是否即时编译？

一个请求进来，命中一个 ASPX 文件......进程如何知道是否需要编译关联的 CS 文件（网站），或者是否在部署之前已经完成（Web 应用程序）？

我只是好奇这种差异是在哪里指定的。在 web.config 的某个地方？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-07T21:00:34.150

您会在这些项目类型中找到的 .aspx 文件存在细微差别。

如果您查看网站项目，您应该会看到类似这样的内容...

```
<%@ Page Language="C#" AutoEventWireup="true"  
CodeFile="Default.aspx.cs" Inherits="_Default" %> 
```

... Web 应用程序项目将具有类似这样的 .aspx 文件...

```
<%@ Page Language="C#" AutoEventWireup="true" 
CodeBehind="Default.aspx.cs" Inherits="WebApplication2._Default" %> 
```

请注意，第一个具有 CodeFile 属性，第二个具有 CodeBehind 属性。这就是区分的地方。

CodeBehind 属性不在运行时使用 - 它用于告诉 VS.NET 代码所在的位置，而 Inherits 属性告诉运行时在二进制文件中搜索哪个类。

CodeFile 属性是在运行时使用的，被 aspnet_compiler.exe 用来生成代码，然后像上面一样使用 Inherits 属性。

有关这些属性的更多信息，请查看此处...

[http://msdn.microsoft.com/en-us/library/ydy4x04a.aspx](http://msdn.microsoft.com/en-us/library/ydy4x04a.aspx)

但是要回答您的问题“IIS 是如何知道的？” 答案是“没有”。ASP.NET 知道。

您可以通过执行以下操作来证明是这种情况：

1.  创建一个新的 Web 应用程序。这将包括一个 Default.aspx 和一个 Default.aspx.cs。
2.  将以下代码添加到 Default.aspx.cs 中：

    ```
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write("hello");
    } 
    ```

3.  编译项目，运行它，看到文本“hello”出现在浏览器中。

4.  现在，将代码更改为如下所示，并保存 .cs 文件：

    ```
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Write("goodbye");
    } 
    ```

5.  不要编译。刷新您的浏览器。你仍然会看到“hello”，因为编译后的代码仍然使用这个字符串。

6.  现在，将 Default.aspx 中的属性从 CodeBehind 更改为 CodeFile。保存此文件。

7.  刷新您的浏览器。您会看到显示“再见”。

8.  将代码中的“再见”更改为“我相信！”。保存 .aspx.cs 但不要编译。

9.  刷新你的浏览器，看到“我相信！”，然后在房间里跳舞：-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T20:22:03.807

IIS 所做的只是将传入的请求传递给适当的处理程序。对于 ASP.NET 站点/应用程序，它是 aspnet_isapi.dll。然后处理程序从那里处理所有事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T20:20:46.227

一旦网站或网络应用程序被编译，网络服务器就没有区别了。IIS 中的 .NET 处理程序始终：

1.  编译 ASPX 页面。
2.  将构建的程序集 jit 到临时文件区域。
3.  运行请求

在站点完全编译成单个 dll 的情况下，仍然有单行 ASPX 文件告诉 IIS 中的 .NET 处理程序从哪里获取代码。或者，可以使用 web.conig 中的一些额外配置行完全删除 ASPX 页面。

但简短的答案是真的一旦编译它们是相同的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-07T20:17:49.120

我很确定框架可以处理这个问题并且它对 IIS 是透明的。

# c# - 使用 C# 自动化 Photoshop

> ID：836814
> 
> 赞同：3
> 
> 时间：2009-05-07T20:16:18.330
> 
> 标签：c#, photoshop

正在寻找一种使用 C# 代码将背景图层添加到现有 Photoshop 文件的方法？

有任何想法吗？

谢谢-c

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T20:19:50.440

Photoshop 有一个 COM 接口，这里有一个关于如何通过 C# 访问它的文档。

你想要做的细节需要更多地挖掘 Photoshop 的实际文档，但这[会让你开始。](http://www.pcpix.com/Photoshop/)

有关更多详细信息，请查看 Adob​​e[脚本指南和 SDK 信息](http://www.adobe.com/devnet/photoshop/)。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2020-08-21T19:26:23.140

如果您仍在寻找自动化 Photoshop 的方法，那么您今天应该不会有问题：

[https://helpx.adobe.com/photoshop/using/creating-actions.html](https://helpx.adobe.com/photoshop/using/creating-actions.html)

# php - 为什么即使 Firefox 显示它们存在 PHP XPath 也找不到表元素？

> ID：836819
> 
> 赞同：3
> 
> 时间：2009-05-07T20:17:03.070
> 
> 标签：php, dom, xpath

我试图在“网络抓取”期间拉出一个精确的表格。使用 cURL 将页面拉入 $html，成功。

使用 Firebug 获取所需表的确切 XPATH。

代码如下：

```
$dom = new DOMDocument($html);
$dom->loadHTML($html);

$xpath = new DOMXpath($dom);
$summary = $xpath->evaluate('/html/body/table[5]/tbody/tr/td[3]/table/tbody/tr[8]/td/table');
echo "Summary Length: " . $summary->length; 
```

执行时，$summary->length 始终为零。它不会拉那个表节点。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T20:26:15.433

Firefox 可能会将“虚拟”`tbody`元素插入到没有它们的表中；这些元素是否存在于原始文件中？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-21T07:58:28.637

只需删除“/ tbody”。从你从 Firefox 获得的 xpath：

> .//*[@id='data']/tbody/tr[1]/td[2]/span

创建这个：

> .//*[@id='data']/tr[1]/td[2]/span

芦荟

# sql - 当 Perl 的 DBI 在准备语句时遇到错误时，如何避免程序退出？

> ID：836827
> 
> 赞同：1
> 
> 时间：2009-05-07T20:20:10.847
> 
> 标签：sql, perl, informix, dbi

我正在制作一个脚本，该脚本通过一个包含数据库上所有其他表名的表。在解析每一行时，它会检查表是否为空

```
select count(*) cnt from $table_name 
```

架构中不再存在某些表，如果我这样做

```
select count(*) 
```

直接进入命令提示符，它返回错误：

> 206：指定的表（adm_rpt_rec）不在数据库中。

当我从 Perl 内部运行它时，它会将其附加到开头：

> DBD::Informix::db 准备失败：SQL：-

尝试准备此 SQL 语句时，如何避免程序退出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T20:24:59.167

一种选择是在构造 $dbh 时不使用 RaiseError => 1。另一种是将prepare包装在一个eval块中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T22:00:34.943

只需将可能失败的调用放在 eval 块中，如下所示：

```
for my $table (@tables) {
    my $count;
    eval {
        ($count) = $dbi->selectrow_array("select count(*) from $table");
        1; #this is here so the block returns true if it succeeds
    } or do {
        warn $@;
        next;
    }
    print "$table has $count rows\n";
} 
```

尽管在这种情况下，由于您使用的是 Informix，因此您有一个更好的选择：系统目录表。Informix 将此类元数据保存在一组系统目录表中。在这种情况下，您需要 systables：

```
my $sth = $dbh->prepare("select nrows from systables where tabname = ?");
for my $table (@tables) {
    $sth->execute($table);
    my ($count) = $sth->fetchrow_array;
    $sth->finish;
    unless (defined $count) {
        print "$table does not exist\n";
        next;
    }
    print "$table has $count rows\n";
} 
```

这比`count(*)`靠在桌子上更快更安全。系统目录表的完整文档可以在[IBM Informix Guide to SQL](http://www.ibm.com/software/data/informix/pubs/library/interim/ct1spna-pdf.html)中找到（警告这是一个 PDF）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T22:55:29.040

工作代码 - 假设您有一个“商店”数据库。

```
#!/bin/perl -w
use strict;
use DBI;
my $dbh = DBI->connect('dbi:Informix:stores','','',
                       {RaiseError=>0,PrintError=>1}) or die;
$dbh->do("create temp table tlist(tname varchar(128) not null) with no log");
$dbh->do("insert into tlist values('systables')");
$dbh->do("insert into tlist values('syzygy')");

my $sth = $dbh->prepare("select tname from tlist");
$sth->execute;
while (my($tabname) =  $sth->fetchrow_array)
{
    my $sql = "select count(*) cnt from $tabname";
    my $st2 = $dbh->prepare($sql);
    if ($st2)
    {
        $st2->execute;
        if (my($num) = $st2->fetchrow_array)
        {
            print "$tabname: $num\n";
        }
        else
        {
            print "$tabname: error - missing?\n";
        }
    }
}
$sth->finish;
$dbh->disconnect;
print "Done - finished under control.\n"; 
```

运行上述代码的输出。

```
systables: 72
DBD::Informix::db prepare failed: SQL: -206: The specified table (syzygy) is not in the database.
ISAM: -111: ISAM error:  no record found. at xx.pl line 14.
Done - finished under control. 
```

这打印了错误 ( `PrintError=>1`)，但继续。把 1 改成 0 就不会出现错误了。`$tabname`和的声明中的括号`$num`至关重要 - 数组上下文与标量上下文。

# jquery - 如何对作为 $(this) 子集的 jquery 对象进行子过滤

> ID：836828
> 
> 赞同：0
> 
> 时间：2009-05-07T20:20:15.400
> 
> 标签：jquery, css-selectors

我一遍又一遍地阅读了文档，但我不明白为什么这不起作用：

从函数内部，调用以下内容：

```
alert($(this).parent().parent().html()); 
```

返回如下所示的内容：

```
<div class="something1">
    <div class="whereThisStarted">stuff</div>
    </div>
<div class="something2">stuff</div>
<div class="somethingSpecial">stuff</div>
<div class="something4">stuff</div> 
```

我想得到“一些特别的东西”。在我看来，以下任何一项都应该有效，但它们都返回 null。

```
alert($(this).parent().parent().children(".somethingSpecial").html());
alert($(this).parent().parent().filter("div.somethingSpecial").html()); 
```

这有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T20:26:24.683

如果你真的必须按照你想要的方式而不是 TStamper 显示的方式来做，试试这个：

```
alert($(this).parent().parent().find("div.somethingSpecial").html()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T20:29:59.730

您可能想尝试最接近的功能 - 听起来它更像您正在尝试做的事情：

[jquery doc - 最接近（）](http://docs.jquery.com/Traversing/closest#expr)

此代码应该可以工作：

```
alert($(this).closest(".somethingSpecial").html()); 
```

或者如果您的 $(this) 在 'startHere' div 内：

```
alert($(this).parent().closest(".somethingSpecial").html()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:30:51.880

我不确定为什么 children("div.somethingSpecial") 单独不起作用，但我刚刚意识到这也有效：

```
alert($(this).parent().parent().children().filter("div.charactersLeft").html()); 
```

# database-design - 存储和查询树的最有效方法是什么？

> ID：836833
> 
> 赞同：11
> 
> 时间：2009-05-07T20:21:14.743
> 
> 标签：database-design

我需要分析 1 TB+ 的网络访问日志，特别是我需要分析与请求的 URL 和 URL 子集（子分支）相关的统计信息。如果可能的话，我希望查询对数据的小子集（例如 1000 万个请求）进行快速处理。

例如，给定一个请求以下 URL 的访问日志：

```
/ocp/about_us.html
/ocp/security/ed-209/patches/urgent.html
/ocp/security/rc/
/ocp/food/
/weyland-yutani/products/ 
```

我想做如下查询：

*   计算所有“低于”/ocp 的请求数。
*   同上，但只计算 /ocp/security 下子节点的请求
*   返回前 5 个最常请求的 URL。
*   同上，除了按任意深度分组，

例如，对于上面的最后一个查询，数据的深度 2 将返回：

```
2: /ocp/security/
1: /ocp/
1: /ocp/food/
1: /weyland-yutani/products/ 
```

我认为理想的方法可能是使用列 DB 并对 URL 进行标记，以便 URL 中的每个元素都有一个列。但是，如果可能的话，我真的很想找到一种方法来使用开源应用程序来做到这一点。HBase 是一种可能，但查询性能似乎太慢，无法用于实时查询（另外，我真的不想从事重新实现 SQL 的业务）

我知道有商业应用程序可以进行这种类型的分析，但出于各种原因，我想自己实现它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-07T20:35:02.323

在投入太多时间在关系数据库之上设计分层数据结构之前，请考虑阅读Bill Karwin出色的*SQL Anti-Patterns Strike Back演示文稿中的*[“朴素树”部分（从幻灯片 48 开始） 。](http://www.slideshare.net/billkarwin/sql-antipatterns-strike-back)Bill 概述了以下用于开发层次结构的方法：

 *1.  路径枚举（幻灯片 55）
2.  嵌套集（幻灯片 58）
3.  封闭表（幻灯片 68）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T20:39:09.910

树在数据库中通常不是很有效。我的意思是：如果您将树设计为真正递归的，并且项目指向它们的父节点，您将获得大量查询来查找所有子节点。

但是您可以根据需要优化树。

将 url 的任何部分放入列中并不是一个坏主意。您需要将深度限制为一定数量的子节点。您可以在任何列上都有索引，这使得它非常快。

对这种结构的查询非常简单：

```
Select count(*) From Hits where node1 = 'ocp' AND node2 = 'security'; 
```

进行访问统计：

```
SELECT node1, node2, count(*) as "number of hits"
FROM hits 
GROUP BY node1, node2
ORDER BY count(*) DESC 
```

你会得到

```
node1            node2        number of hits
'ocp'                        23345
'ocp'            'security'   1020
'ocp'            'food'        234
'weyland-yutani' 'products'     22 
```

您还可以按原样存储 url 并使用正则表达式进行过滤。这更灵活，但速度较慢，因为您没有索引。您只需要限制 url 的整个长度，而不是子节点的数量。

我认为您可以使用任何足以存储大量数据的数据库来执行此操作。比如MySql。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T09:02:27.240

Stephane Faroult所著[的 The Art of Sql](https://rads.stackoverflow.com/amzn/click/com/0596008945)书中有一章非常出色（第 7 章 - 处理分层数据），它解释并比较了使用关系数据库存储和查询树的 3 种方法。

如果你正在做一个严肃的、工业级的实施，那么学习本章将是值得的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T14:59:46.140

我认为存储此类数据的最有效方法是在部件爆炸（或层次结构）表中。

部件分解表由三列组成：标识、父级和描述。对于示例数据，该表如下所示：

```
Identity Parent Description
0        Null   ocp
1        0      about_us.html
2        0      security
3        2      ed-209
4        3      patches
5        4      urgent.html
6        2      rc
7        0      food
8        Null   weyland-yutani
9        8      products 
```

在填充 URL（爆炸）表时，填充一个记录每个 URL 的叶子的表。从示例数据：

```
 Leaf ID
-------
1
5
6
7
9 
```

我相信你可以从这两张表开始回答你所有的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T20:25:30.803

您可能想要检查 SQL Server 2008 中的 HIERARCHYID 数据类型或 Oracle 中的等效数据类型。

# actionscript-3 - Actionscript 3.0 子类化向量类的最佳选择 (Flash Player 10)

> ID：836835
> 
> 赞同：3
> 
> 时间：2009-05-07T20:21:29.143
> 
> 标签：actionscript-3, arrays, actionscript, vector

我想利用 FP10 的较新 Vector 类的所有优点，但它似乎被标记为 final。

我正在 Actionscript 中进行一些密集的数学处理，并反复处理数字数组。我以前一直在使用我自己的 Array 子类（我称之为`NumericArray`），并添加了 sum()、mean()、add()、multiply() 等函数。这非常有效，并且允许一些干净的 OO 代码. 但是，我通过分析发现大约 95% 的处理时间发生在这些对象的函数中。我需要这些阵列的更多性能。

我想使用 Vector，因为它提供了一些性能增强。我想专门使用一个`Vector.<Number>`. 不幸的是，我不能将 Vector 子类化，因为它被标记为 final。

模仿我以前对 Array 的子类所做的最好和最干净的方法是什么`Vector.<Number>`？

我考虑过传递`Vector.<Number>`变量而不是我的自定义类，并且只使用实用函数来操作，但这不是好的 OO 设计，使用起来会很痛苦，更不用说丑陋了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T20:57:18.683

如果添加附加功能不需要访问 Vector 的受保护属性/方法，则可以为 Vector 创建一个包装类。这些方面的东西？

```
import flash.utils.Proxy;
import flash.utils.flash_proxy;

use namespace flash_proxy;

public class NumericVector extends Proxy
{
     private var vector:Vector.<Number>;

     public function NumericVector(vector:Vector.<Number> = null)
     {
          if(vector == null)
          {
              this.vector = new Vector.<Number>();
          }
          else
          {
              this.vector = vector;
          }
     }

     override flash_proxy function nextName(index:int):String 
     {
         return vector[index - 1].toString();
     }

     override flash_proxy function nextNameIndex(index:int):int
     {
         // implementation
     }

     public function sum():Number
     {
         // do whatever you intend to do
     }

     ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T07:37:57.143

回避这个问题的一种方法可能是使用[as3ds](http://code.google.com/p/as3ds/)（actionscript 3 数据结构的缩写）。我不确定它们是否比使用 Vector 更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-15T22:41:27.570

这个页面怎么来的 [http://help.adobe.com/en_US/AS3LCR/Flash_10.0/Vector.html](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/Vector.html)

它说：“注意：要在 Vector 的子类中覆盖此方法，请使用 ...args 作为参数，如本例所示：”

??

这是否意味着您可以将 Vector 子类化？

詹姆士

# python - 如何以编程方式将两个 aac 文件合并为一个？

> ID：836842
> 
> 赞同：3
> 
> 时间：2009-05-07T20:24:36.017
> 
> 标签：python, windows, scripting, itunes, aac

我正在寻找`cat`aac 音乐文件（iTunes 使用的东西）。

用例：我岳父除了下载到他的 iPod 上的有声读物外，不会接触电脑。我教过他一些 iTunes (Windows) 基础知识，但他的图书馆一团糟。事实证明，iTunes 已针对收听库中的播客和随机歌曲进行了优化，而不是针对有声读物进行了优化。

我想编写一个脚本（最好是 python，但也可以使用其他东西）以理智的方式导入他的有声读物 cd，将每张 cd 的曲目组合成一个可收藏的 aac 文件（.m4b？），然后将其添加到 iTunes所以它出现在有声读物部分。

我已经弄清楚如何与 iTunes 对话（Windows 中有一个 COM 接口，请查找 iTunes SDK）。使用该界面，我可以使用 iTunes 将 CD 翻录为 aac 格式。这是我遇到问题的 aac 文件的实际串联。在网上找不到合适的东西...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-13T23:14:02.653

我创建了一个名为“Chapter and Verse”的免费软件程序，将 m4a (AAC) 文件连接成一个带有章节标记和元数据的 m4b 有声读物文件。

如果您已经使用 iTunes（您说您拥有）将 CD 翻录到 AAC，那么使用我的软件就可以轻松完成剩下的工作。我写它就是为了这个确切的原因和场景。您可以从[www.lodensoftware.com下载它](http://lodensoftware.com/)

在尝试使用 SlideShow Assembler、QT SDK 和一堆其他命令行工具后，我最终基于公开可用的 MP4v2 库构建了自己的应用程序。文件的连接和章节的添加是使用 MP4v2 库完成的。

制作适合 iPod 格式的有声读物有很多细微差别。信息很难找到。使用 Apple 文档和开放库也有其自身的挑战。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T21:40:24.663

与编程无关（嗯，有点。）

iTunes 已经具备作为单轨翻录的功能（例如有声读物）。请查看：[http ://www.ehow.com/how_2108906_merge-cd-single-track-itunes.html](http://www.ehow.com/how_2108906_merge-cd-single-track-itunes.html)

这解决了你眼前的问题，但我想人们可以继续讨论如何以编程方式完成它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T21:35:23.287

最强大的 Python 音频处理模块似乎是[Python Audio Tools](http://audiotools.sourceforge.net/index.html)。下载附带的 CLI 工具可能会做你想做的一切，甚至翻录，所以你甚至可以通过 shell 脚本来完成整个事情。该模块本身也非常强大，并具有一组方便的功能来处理音频文件。如果你想坚持用 python 编写所有东西，在学习了他们的 CLI 源代码之后，你可能会学到足够的东西来做你想做的事情。具体来说，他们有一个工具，可以在任何编解码器中执行音频文件 cat。（它们确实依赖于 FAAC/FAAD2 来获得 AAC 支持，但对于您会发现的每个库来说都是如此）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T21:02:27.920

我还没有看到用于 python 的 aac 编解码器库，但您可以使用 wav 文件作为中间格式。

您可以将曲目从 cd 中提取为 wav 文件，然后使用[wave 模块](http://docs.python.org/library/wave.html)将它们连接成一个大文件，然后可以通过 iTunes 将其转换为 aac。由于数据的大小，这可能会大大增加您的处理时间，但这会相当容易，并且您不需要任何外部库。

# linux - 如何以编程方式截取 Linux 中的应用程序的屏幕截图？

> ID：836853
> 
> 赞同：7
> 
> 时间：2009-05-07T20:28:13.590
> 
> 标签：linux, api, unix, screenshot, printscreen

如何以编程方式截取 Linux 中的应用程序的屏幕截图？我正在使用 C++。任何的想法？对于windows有很多资源，但我找不到linux的任何东西

有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T20:32:40.910

已经在这里回答了：

[在 wine (linux) 下运行的 windows 应用程序的屏幕截图](https://stackoverflow.com/questions/675471/screenshot-of-a-windows-application-running-under-wine-linux/675561)

编辑：如果你想用 C 来做，试试 Xlib。一些链接：

*   [http://tronche.com/gui/x/xlib/](http://tronche.com/gui/x/xlib/)
*   [http://www.roard.com/docs/cookbook/cbsu19.html](http://www.roard.com/docs/cookbook/cbsu19.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:44:19.540

如果您只想要一个屏幕录像机，请尝试使用[xvidcap](http://xvidcap.sourceforge.net/)。如果您想自己制作，请尝试查看来源。我不确定它是如何工作的。我的猜测是它以某种方式使用了 XShm 扩展。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-07T21:12:38.583

你不能用[http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php)做到这一点吗？

它通常在 linux repos 上，您可以做的不仅仅是用它截屏... [http://tips.webdesign10.com/how-to-take-a-screenshot-on-ubuntu-linux](http://tips.webdesign10.com/how-to-take-a-screenshot-on-ubuntu-linux)

# jquery - 滚动到 jQuery 中的上一个 div

> ID：836870
> 
> 赞同：1
> 
> 时间：2009-05-07T20:32:29.833
> 
> 标签：jquery, scroll, scrollto

我在网站上使用 jQuery 的 scrollTo 插件。我制作了一个垂直滚动 div，我可以通过单击按钮滚动到不同的 div。现在我需要制作一个后退按钮以返回上一个 div。

我想要的是相反的

```
this.next() 
```

我试过

```
this.prev() 
```

但它不起作用。

```
$('#tabs').click
(
    function()
    {
        $('#wrapper').scrollTo(this.prev(), 'medium')
    }
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T20:37:02.413

`this`是一个原始元素引用 - 您需要将其包装在 jQuery 对象中，然后才能使用 jQuery 方法，例如[`prev()`](http://docs.jquery.com/Traversing/prev)：`$(this).prev()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:38:18.620

尝试：

```
$('#tabs').click
(
    function()
    {
        $('#wrapper').scrollTo($(this).prev(), 'medium')
    }
); 
```

在事件中，**这**表示 DOM 元素，而不是 jQuery 对象。

# iphone - 为什么我不能更新临时 iPhone 应用程序？

> ID：836874
> 
> 赞同：2
> 
> 时间：2009-05-07T20:33:06.337
> 
> 标签：iphone, installation, adhoc

我有一个脚本可以很好地创建临时 iPhone 版本。我可以将应用程序和 mobileprovision 文件放到 iTunes（Mac 版）上，它可以毫无问题地安装到设备上。但是，如果我生成一个新版本并再次将文件放到 iTunes 上，我总是会在同步时收到可怕的“无法验证”错误。

解决此问题的唯一方法是从桌面和设备中删除应用程序和配置文件，同步，然后删除新副本并再次同步。我已经尝试了仅在设备或桌面上删除配置文件或应用程序的所有变体，除了清除两者之外没有什么可以解决它。

有谁知道这是否是临时应用程序安装过程中的错误，还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T11:54:32.580

您是否为每个构建更改版本？

我不记得收到错误信息了，但是我发现如果我不每次都更改版本信息，我无法拖放安装新版本。我需要先删除该应用程序。

不确定这是否会有所帮助，但这是我迄今为止唯一能想到的。

# c++ - 使用 Boost 创建具有向后兼容 ABI 的库

> ID：836875
> 
> 赞同：25
> 
> 时间：2009-05-07T20:33:08.990
> 
> 标签：c++, unix, boost, compatibility, abi

我正在研究某个 C++ 库（或更多框架）。我想让它向后兼容以前的版本，不仅保留 API 兼容性，还保留 ABI（就像 Qt 所做的出色工作一样）。

我使用了 Boost 的许多功能，在我看来，这使得向后兼容变得不可能，除非我强迫用户拥有完全相同（有时是旧的）版本的 Boost。

有没有办法（不重写 Boost 的 1/2）在其命名空间周围制作一些“前缀”/重命名它以防止它干扰用户版本的 Boost？

例如我的 libXYZ 使用 Boost 1.33 并且它有 class `boost::foo`. 在 1.35 版本`boost::foo`中升级并添加了新成员，因此，`boost::foo`从 1.33 和 1.35 开始不兼容 ABI。因此，libXYZ 的用户必须使用 Boost 1.33 或使用 Boost 1.35 重新编译 libXYZ（这可能已经以 XYZ 无法编译的方式破坏了某些 API）。

**注意：**我说的是带有 ELF 的 UNIX/Linux 操作系统，其中动态链接类似于静态链接，因此您不能链接两个不同版本的库，因为符号会干扰。

我可能想到的一种合适的解决方案是将 Boost 放在其他一些私有名称空间中。因此，libXYZ 将使用`::XYZ::boost::foo`而不是`::boost::foo`. 这将防止与用户可能使用的其他版本的 Boost 发生冲突。

因此，libXYZ 将继续与 Boost 1.33 一起工作，静态或动态链接到它与其他命名空间，假设它：

*   不会在外部公开 Boost API。
*   将保持公开 API 的稳定私有版本。

有没有办法用Boost做这样的事情？

**编辑：**最后我决定创建一个脚本，将源中的所有 boost 符号重命名为一些自定义符号。

基本原理：简化构建过程，独立于编译器可见性支持，而且它的可见性仅适用于动态库，对于静态这不起作用，所以我需要为每种类型的库单独构建和依赖。

该脚本在那里可用： http: [//art-blog.no-ip.info/files/rename.py](http://art-blog.no-ip.info/files/rename.py)

**编辑 2：** Boost BCP 的最新版本支持命名空间重命名。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-07T20:39:16.167

基本上，只要确保你的库的公共接口不会暴露 Boost。您可以随时在内部使用它。一般来说，让一个库的接口依赖于另一个库是不好的（除非它依赖于像 STL 这样的标准库）。Boost 几乎适合“标准”库类别，但它的 ABI 变化如此之大，以至于您的界面不应该使用它。

为确保您不会暴露 Boost 符号，您可以执行以下操作：

A. 编译`-fvisibility=hidden`并用 . 标记所有公共符号`__attribute__((visibility("default")))`。您可以使用宏来使这更容易：

```
#define ABI __attribute__((visibility("default"))) 
```

B. 做这样的事情：

```
#pragma GCC visibility push(hidden)
#include <boost/whatever.hpp>
#pragma GCC visibility pop 
```

您还应该将它包裹在您不想导出的所有其他内部符号上，或者用`__attribute__((visibility("hidden")))`. 同样，您可以使用宏来简化此操作：

```
#define INTERNAL __attribute__((visibility("hidden"))) 
```

在这些选项中，我更喜欢 A，因为它让您明确考虑导出哪些符号，因此您不会意外导出您不想要的东西。

[顺便说一句，您可以在 Ulrich Drepper 的How to Write Shared Libraries](http://people.redhat.com/drepper/dsohowto.pdf)中找到有关制作 DSO 的更多信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T00:42:13.853

通常，除了标准 C 绑定之外，您不能依赖 C++ 中的任何类型的 ABI。但是根据您做出多少假设，您可以在界面中使用越来越多的 C++。

我发现[这篇](http://aegisknight.org/cppinterface.html)很棒的文章介绍了如何让你的 API 变成稳定的 ABI。例如，永远不要在界面中传递标准 C++ 库（或 Boost）数据类型；即使对库进行了小错误修复，它也可能会收支平衡。

发布 ABI 兼容 API 时需要注意的一些问题示例如下：

*   [Windows 调试堆](http://msdn.microsoft.com/en-us/library/19f56tw3(VS.71).aspx)。您必须确保所有分配和解除分配都位于“模块”（即可执行文件或 DLL）的同一侧。
*   [脆弱的二进制接口](http://en.wikipedia.org/wiki/Fragile_binary_interface_problem)问题。即使系统的两端始终使用相同的编译器和库，您在 C++ 中也必须小心您在`.h`文件中发布的内容以及分配发生的位置。

如果您关注链接的文章，您将找到这些问题和其他问题的解决方案。

**编辑**：

我还发现[Microsoft 发表的一篇有趣的文章](http://msdn.microsoft.com/en-us/library/ms809983.aspx)描述了 COM 接口的工作原理，将 C++ 项目转化为 COM。我相信微软开发 COM 的主要原因之一是为了解决 C++ 的脆弱二进制接口问题，因此他们可以发布带有面向对象 API 的 DLL。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-07T23:12:13.113

考虑使用[abi-compliance-checker](http://lvc.github.io/abi-compliance-checker/)工具来维护稳定的 API/ABI 接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T20:46:03.420

你应该能够做这样的事情：

```
namespace XYZ
{
#include <boost/my_library.hpp>
} 
```

它应该将 boost 标头转储到命名空间 XYZ 中。但是请注意，这仅适用于仅标头库。

# delphi - Delphi 2007 - 如何避免拥有 \history 文件夹？

> ID：836877
> 
> 赞同：10
> 
> 时间：2009-05-07T20:33:28.740
> 
> 标签：delphi, delphi-2007

较新的 Delphi 版本（包括我正在使用的 Delphi 2007）具有内置文件历史功能，可让您从 IDE 中恢复到旧文件。这很好，但我已经有了源代码控制。是否可以禁用此功能？

我问是因为 IDE 会自动创建一个 \history 文件夹，其中包含所有文件的旧版本，这让我很恼火。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-10-14T08:09:06.267

工具\选项\编辑器选项\

取消选中“创建备份文件”

;)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T08:56:38.780

我相信你可以进入注册表：

```
D2007: HKEY_CURRENT_USER\Software\Borland\BDS\5.0\Known IDE Packages
D2009: HKEY_CURRENT_USER\Software\CodeGear\BDS\6.0\Known IDE Packages 
```

并删除相应的键：

```
$(BDS)\bin\historyide100.bpl
or
$(BDS)\bin\historyide120.bpl 
```

我确信这对我有用，我似乎记得这就是所需要的。不过我现在倾向于不打扰，只是把它留在里面。告诉 SVN 忽略历史文件夹。任何 Delphi 更新似乎也将其放回原处。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T20:39:23.873

我不相信你可以。如果你去

> 工具\选项\编辑器选项\文件备份限制

这是控制它备份多少文件的地方，最小值是 1，它仍然会创建历史文件夹。

也许您可以设置一个 MSBuild 事件来清除它或其他一些内务管理任务。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-07T21:30:57.090

IIRC Delphi Distiller 可以选择阻止它创建历史文件夹。不过，我目前的系统上实际上并没有它，所以我无法检查。但你可能想检查一下。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-08T06:58:39.907

[Andreas Hausladen](http://andy.jgknet.de/blog/?page_id=10)的 DDevExtension 具有删除 __history 目录的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-07T10:32:14.100

在 Delphi 10.3 中，这已移至工具 -> 选项 -> 用户界面 -> 编辑器 -> 创建备份文件

# facebook - Facebook 应用程序开发中的“陷阱”

> ID：836880
> 
> 赞同：0
> 
> 时间：2009-05-07T20:33:44.993
> 
> 标签：facebook

几周以来，我一直致力于 Facebook 开发，这一直是……具有挑战性的。不是来自“这是如何工作的？” 观点，但从“为什么这不起作用！” 一。

我很好奇人们在 Facebook 工作中看到了哪些“陷阱”、意外行为或直接错误，以及他们做了什么来弥补。

我目前的信天翁是（测试版）DataStore API；它非常不可靠。对 getObject 的调用可能会失败并返回部分值，因此使用值 {1, 2 3} 创建的字段 {foo, bar, val} 的对象可能会返回 {1, 0, 3}, {0, 0, 3}等。我还没有找到可以接受的解决方法。

亚军是无法`<fb:if-*>`在用户的个人资料页面上使用。我用一些真正扭曲的英语和`<fb:visible-to-owner>`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T20:56:46.093

我在创建桌面应用程序时遇到了几个问题，我最终[在 Facebook Wiki 上创建了一个特殊的桌面页面，](http://wiki.developers.facebook.com/index.php/Desktop_Application)以方便其他人使用。我发现的两个最大的“陷阱”是让应用程序在 Facebook 的用户设置页面上显示为“桌面应用程序”，以及让桌面应用程序除了桌面应用程序之外还让用户退出浏览器会话。答案在那个 wiki 页面上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T09:29:07.087

Facebook 不遵循当前的 OpenAuth 2.0 标准这一事实让我遇到了很多麻烦。他们很近，但还不够近。

但这部分是因为我想使用不太喜欢 Facebook 的 DotNetOpenAuth 库，或者相反，这里不确定：P

# svn - 如何在 TortoiseSVN 中浏览文件的差异？

> ID：836881
> 
> 赞同：1
> 
> 时间：2009-05-07T20:33:58.660
> 
> 标签：svn, tortoisesvn

我目前在 Windows 中使用[TortoiseSVN作为我的源代码控制。](http://en.wikipedia.org/wiki/TortoiseSVN)当我快速浏览不同的修订版时，如何查看单个文件的差异？还是有更好的工具？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T20:37:24.580

要查看文件的修订，您可以右键单击文件并选择

> TortoiseSVN -> 显示日志

然后，您可以从那里选择多个项目并选择比较修订

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T20:56:06.097

[我认为您可能真正喜欢的是一个名为svn-time-lapse-view](http://code.google.com/p/svn-time-lapse-view/)的开源工具。

它是一个 Java 可执行 jar 文件，可让您加载文件的所有修订，然后使用滑块滚动/循环通过滑块下方显示的差异来滚动/循环所有版本更改。

比打开日志并一遍又一遍地选择两个文件要快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T20:36:09.437

我想你可能想看看 Blame 工具。它将使用最后修改的修订号来注释每一行源代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T20:39:09.630

右键单击文件 > TurtoiseSVN > Diff 或 Diff with previous version。您还可以使用显示日志，然后右键单击该文件并使用任何“比较”选项。我个人使用[WinMerge](http://winmerge.org/)来合并和显示差异。

# java - Tomcat：实现 java.security.Principal

> ID：836889
> 
> 赞同：3
> 
> 时间：2009-05-07T20:36:27.530
> 
> 标签：java, tomcat, jakarta-ee, authentication

我正在尝试在 Tomcat 中创建一个自定义领域。我的问题是有一个 SessionAttributeListener 作为框架的一部分，它检查添加到会话中的任何对象是否是可序列化的，如果不是，它会导致问题......比如使会话无效。

因为 org.apache.catalina.realm.GenericPrincipal 不可序列化，所以我尝试编写自己的类来实现 Principal 和 Serializable。这似乎很好，除非然后尝试使用

```
request.isUserInRole("user") 
```

我对此以及用户应该拥有的任何其他角色都是**错误的。**如果我在 Valve 类中将 GenericPrincipal 换成 CustomPrincipal，它会返回 true。所以我的问题是：

1.  是什么导致错误返回？
2.  如何使用我自己的类而不是 GenericPrincipal？
3.  我什至可以这样做吗？

**编辑：** 为了清楚起见，我实际上已经实现了这一点，CustomPrincipal 中的代码与 GenericPrincipal 完全相同，除了它还实现了 Serializable。request.isUserInRole("user") 在我的 Valve 中返回 false 我有：

```
request.setUserPrincipal(new CustomPrincipal(args...)); 
```

但不是当我这样做

```
request.setUserPrincipal(new GenericPrincipal(args...)); 
```

当我使用该类时，对 request.getUserPrincipal() 的任何调用都将返回 CustomPrincipal。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T20:55:39.280

你需要给我们更多的背景信息。但是请注意，无论如何，Principal 都是抽象的；例如，KerberosPrincipal 实现了 Principal 和 Serializable，因此有*一些*方法可以做到这一点。

isUserInRole*所做*的是将请求包装到实现类，以查看用户（由 Pricipal 标识）是否真的处于该角色。所以我认为第一件事可能是调用 getUserPrincipal 并查看 servlet*认为*当前的 Principal 是什么。

# regex - 如何从 MAC 地址列表中删除冒号？

> ID：836890
> 
> 赞同：10
> 
> 时间：2009-05-07T20:36:31.620
> 
> 标签：regex

我很难尝试删除 MAC 地址列表中的冒号。

我的文件：

```
00:21:5A:28:62:BF
00:24:81:0A:04:44 
```

预期输出：

```
00215A2862BF
0024810A0444 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-07T20:38:52.860

给定您的标签，您希望在 shell 中完成此操作：

```
cat file | sed s/://g 
```

`cat`编辑：如果您从文件中读取，您实际上并不需要：

```
sed s/://g file 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-07T20:41:27.380

```
perl -pe "s/://g" yourfile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T20:38:11.553

```
echo "00:21:5A:28:62:BF" | sed -e 's/://g'
00215A2862BF 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T05:00:54.527

tr -d ':' <文件

可能也可以，尽管我没有方便的命令行来检查语法。

# iphone - UIScrollView 位移

> ID：836891
> 
> 赞同：1
> 
> 时间：2009-05-07T20:36:32.930
> 
> 标签：iphone, cocoa-touch

在我的 IB 中，我有一个导航控制器，其中包含一个视图控制器。

当我试图从另一个导航控制器加载这个视图控制器时，滚动视图被导航栏的大小移动到底部。除了滚动视图之外，我视图的所有其他元素都没有移动。

为什么会发生这种情况，我该如何解决？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T22:28:44.110

在 IB Inspector 面板的 Size 选项卡中，确保您的滚动视图将其自动调整大小行为设置为：

[![替代文字](https://i.stack.imgur.com/44W7j.png)](https://i.stack.imgur.com/44W7j.png)

同样，确保滚动视图的超级视图设置为具有相同的自动调整大小行为。

# .net - 将 Autoscroll 设置为 true 会使焦点在 .net 数据网格中丢失

> ID：836915
> 
> 赞同：0
> 
> 时间：2009-05-07T20:40:18.863
> 
> 标签：.net, datagrid

我在窗口中嵌入了一个巨大的数据网格控件，并将 Autoscroll 属性设置为 true。除了网格之外，控件还具有文本框。此网格适用于分辨率高于 1600 的监视器（因此在该分辨率下滚动条不可见）。但是 Autoscroll 属性设置为使用户也可以在较小的监视器中使用它。

工作就像单击单元格时一样，例如光标设置在位于网格最右侧的文本框中，因此在小型监视器中不可见。但是由于我上面描述的功能，每当我单击一个单元格时，网格就会失去焦点并且滚动条会移动到网格的右侧。

我不希望滚动条移动以专注于文本框。需要帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T08:48:21.500

“以防万一有人偶然发现这篇文章寻找一种方法来禁用滚动到焦点控件的 AutoScroll 行为，.NET 2.0 中提供了最干净的解决方案：现在 ScrollableControl 中有一个可覆盖的 ScrollToControl 方法。将调用替换为返回 DisplayRectangle.Location 的基类实现并解决了问题”

-- 这篇精彩博文的评论部分的宝石： http: [//seewinapp.blogspot.com/2005/09/is-your-autoscroll-too-auto.html](http://seewinapp.blogspot.com/2005/09/is-your-autoscroll-too-auto.html)

博文和评论回答了需求

# zend-framework - dojo.data 未定义过滤选择

> ID：836916
> 
> 赞同：0
> 
> 时间：2009-05-07T20:40:23.373
> 
> 标签：zend-framework, dojo, zend-form

在使用 Zend 框架表单时，我在使用 Dojo 过滤选择时遇到了一些问题，需要一些帮助来找出我错过了什么，因为这让我发疯。

我目前在**firebug**中遇到此错误：

*   dojo.data 未定义
*   dojo.data.ItemFileReadStore 不是构造函数

下面是我用来创建过滤器选择并将 json 数据提供给调用控制器的代码。

**Zend_Form 元素**（启用 Dojo）

```
$industry = new Zend_Dojo_Form_Element_FilteringSelect('industry');
    $industry->setAutocomplete(true)
    ->setStoreId('industrystore')
    ->setStoreType('dojo.data.ItemFileReadStore')
    ->setStoreParams(array('url' => $baseUrl.'/dojo/industry'))
    ->setAttrib("searchAttr", "title")
    ->setRequired(true)
    ->removeDecorator('DtDdWrapper')
    ->removeDecorator('label')
    ->removeDecorator('HtmlTag'); 
```

**道场控制器**

```
public function industryAction(){

    $db = Zend_Db::factory($this->config->database);

    $result = $db->fetchAll("SELECT * FROM industries");
    $data = new Zend_Dojo_Data('industryid', $result);
    $this->_helper->autoCompleteDojo($data);

    $db->closeConnection();
} 
```

烦人的事情是我在这个表单上的所有其他 Dojo 元素和其他表单运行良好，只是每当我执行过滤选择时，我遇到了这些问题，并且这个问题导致表单中的所有其他元素也失败。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T04:50:41.230

问题实际上在于 Zend Framework 如何在工具包完全加载之前初始化 dijit 和数据存储，在这种情况下，特别是将存储分配给 dijit 的方法。我也遇到了这个问题，并发现解决这些问题的最佳方法是将数据存储从控制器传递到视图中定义的 JavaScript 变量，或者使用特定的自动完成操作执行您所做的操作。根据您的示例，我将进行以下更改。

在您的表单中，我将简化元素：

```
$industry = new Zend_Dojo_Form_Element_FilteringSelect('industry');
    $industry->setAutocomplete(true)
    ->setRequired(true)
    ->removeDecorator('DtDdWrapper')
    ->removeDecorator('label')
    ->removeDecorator('HtmlTag'); 
```

在您看来，您希望将商店连接到您的 dijit 并确保您已加载 dojo.data.ItemFileReadStore 模块：

```
<?php $this->dojo()->onLoadCaptureStart()?>
    function(){
        dijit.byId('industry').store = new dojo.data.ItemFileReadStore({ url: '/controller/industry' });
    }
<?php 
    $this->dojo()->onLoadCaptureEnd();
    $this->dojo()->requireModule('dojo.data.ItemFileReadStore');
?> 
```

正如我提到的，我遇到了一个类似的问题，我[在这里](https://stackoverflow.com/questions/753533/populating-a-filteringselect-datastore-from-an-onchange-event)回答了。我发现的另一个问题是数据存储不喜欢处理 Zend_Dojo_Data 中标签声明的“名称”以外的任何标签声明。

# apache - .htaccess 和 seo 友好的网址

> ID：836917
> 
> 赞同：2
> 
> 时间：2009-05-07T20:40:33.513
> 
> 标签：apache, seo, url-routing

我们现在有一个电子商务网站，其中包含一系列品牌。品牌页面的网址如下：

1.  `http://www.<DOMAIN>.com/catalog/brand/view?id=2`

我们需要使用更友好（seo 友好）的 url，例如：

2.  `http://www.<DOMAIN>.com/<BRAND>`

但是这样它就可以解决上面的#1。

这是在根目录下的 .htaccess 文件中完成的吗？如果是这样，正确的方法是什么？

请记住 URL#1 是合法地址，但我们希望使用 URL#2 格式进行链接。这不是 301 类型的重定向吗？除非我误解了它或其他什么，否则这更“永久”，不是吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T20:52:51.080

您正在寻找的 apache 功能称为`mod_rewrite`. 您应该可以通过 Google 搜索并在此处找到很好的帮助资源。

基本思想是您将指定一个正则表达式匹配，然后指定一个替换模式。您可以将其设置为执行 301 重定向，但默认为不重定向用户，只需访问重写的 url。

这是一个例子：

```
RewriteEngine On
RewriteRule (.*) index.php 
```

RewriteRule 表示将任何匹配的 url(.*) 重写为 index.php。这对大多数文件不是特别有用。我相信你会有很多例子，因为这是一个常见的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T20:50:17.967

您可以通过在索引上添加 .htaccess 或在 httpd.conf 中进行配置来实现。

[在这里](http://www.webconfs.com/url-rewriting-tool.php)，您有一个可以帮助您的工具。你需要的是一个变形器

我希望这对您有所帮助..您需要进行一些修改...：P

```
define('SEO_HOST', "http://www.example.com");
define('SEO_ITEM_PATTERN', SEO_HOST . '/%s-prod-%s');
define('SEO_CATEGORY_PATTERN', SEO_HOST . '/%s-cat-%s');
define('SEO_COMBO_PATTERN', SEO_HOST . '/%s-combo-%s');

class Seo {
    function seems_utf8($Str) { # by bmorel at ssi dot fr
        $length = strlen($Str);
        for ($i=0; $i < $length; $i++) {
            if (ord($Str[$i]) < 0x80) continue; # 0bbbbbbb
            elseif ((ord($Str[$i]) & 0xE0) == 0xC0) $n=1; # 110bbbbb
            elseif ((ord($Str[$i]) & 0xF0) == 0xE0) $n=2; # 1110bbbb
            elseif ((ord($Str[$i]) & 0xF8) == 0xF0) $n=3; # 11110bbb
            elseif ((ord($Str[$i]) & 0xFC) == 0xF8) $n=4; # 111110bb
            elseif ((ord($Str[$i]) & 0xFE) == 0xFC) $n=5; # 1111110b
            else return false; # Does not match any model
            for ($j=0; $j<$n; $j++) { # n bytes matching 10bbbbbb follow ?
                if ((++$i == $length) || ((ord($Str[$i]) & 0xC0) != 0x80))
                    return false;
            }
        }
        return true;
    }

    function get_beauty_url_string($string) {
        if ( !preg_match('/[\x80-\xff]/', $string) )
            return self::replace_no_alpha_chars($string);

        if (self::seems_utf8($string)) {
            $chars = array(
                // Decompositions for Latin-1 Supplement
            chr(195).chr(128) => 'A', chr(195).chr(129) => 'A',
                chr(195).chr(130) => 'A', chr(195).chr(131) => 'A',
                chr(195).chr(132) => 'A', chr(195).chr(133) => 'A',
                chr(195).chr(135) => 'C', chr(195).chr(136) => 'E',
                chr(195).chr(137) => 'E', chr(195).chr(138) => 'E',
                chr(195).chr(139) => 'E', chr(195).chr(140) => 'I',
                chr(195).chr(141) => 'I', chr(195).chr(142) => 'I',
                chr(195).chr(143) => 'I', chr(195).chr(145) => 'N',
                chr(195).chr(146) => 'O', chr(195).chr(147) => 'O',
                chr(195).chr(148) => 'O', chr(195).chr(149) => 'O',
                chr(195).chr(150) => 'O', chr(195).chr(153) => 'U',
                chr(195).chr(154) => 'U', chr(195).chr(155) => 'U',
                chr(195).chr(156) => 'U', chr(195).chr(157) => 'Y',
                chr(195).chr(159) => 's', chr(195).chr(160) => 'a',
                chr(195).chr(161) => 'a', chr(195).chr(162) => 'a',
                chr(195).chr(163) => 'a', chr(195).chr(164) => 'a',
                chr(195).chr(165) => 'a', chr(195).chr(167) => 'c',
                chr(195).chr(168) => 'e', chr(195).chr(169) => 'e',
                chr(195).chr(170) => 'e', chr(195).chr(171) => 'e',
                chr(195).chr(172) => 'i', chr(195).chr(173) => 'i',
                chr(195).chr(174) => 'i', chr(195).chr(175) => 'i',
                chr(195).chr(177) => 'n', chr(195).chr(178) => 'o',
                chr(195).chr(179) => 'o', chr(195).chr(180) => 'o',
                chr(195).chr(181) => 'o', chr(195).chr(182) => 'o',
                chr(195).chr(182) => 'o', chr(195).chr(185) => 'u',
                chr(195).chr(186) => 'u', chr(195).chr(187) => 'u',
                chr(195).chr(188) => 'u', chr(195).chr(189) => 'y',
                chr(195).chr(191) => 'y',
                // Decompositions for Latin Extended-A
            chr(196).chr(128) => 'A', chr(196).chr(129) => 'a',
                chr(196).chr(130) => 'A', chr(196).chr(131) => 'a',
                chr(196).chr(132) => 'A', chr(196).chr(133) => 'a',
                chr(196).chr(134) => 'C', chr(196).chr(135) => 'c',
                chr(196).chr(136) => 'C', chr(196).chr(137) => 'c',
                chr(196).chr(138) => 'C', chr(196).chr(139) => 'c',
                chr(196).chr(140) => 'C', chr(196).chr(141) => 'c',
                chr(196).chr(142) => 'D', chr(196).chr(143) => 'd',
                chr(196).chr(144) => 'D', chr(196).chr(145) => 'd',
                chr(196).chr(146) => 'E', chr(196).chr(147) => 'e',
                chr(196).chr(148) => 'E', chr(196).chr(149) => 'e',
                chr(196).chr(150) => 'E', chr(196).chr(151) => 'e',
                chr(196).chr(152) => 'E', chr(196).chr(153) => 'e',
                chr(196).chr(154) => 'E', chr(196).chr(155) => 'e',
                chr(196).chr(156) => 'G', chr(196).chr(157) => 'g',
                chr(196).chr(158) => 'G', chr(196).chr(159) => 'g',
                chr(196).chr(160) => 'G', chr(196).chr(161) => 'g',
                chr(196).chr(162) => 'G', chr(196).chr(163) => 'g',
                chr(196).chr(164) => 'H', chr(196).chr(165) => 'h',
                chr(196).chr(166) => 'H', chr(196).chr(167) => 'h',
                chr(196).chr(168) => 'I', chr(196).chr(169) => 'i',
                chr(196).chr(170) => 'I', chr(196).chr(171) => 'i',
                chr(196).chr(172) => 'I', chr(196).chr(173) => 'i',
                chr(196).chr(174) => 'I', chr(196).chr(175) => 'i',
                chr(196).chr(176) => 'I', chr(196).chr(177) => 'i',
                chr(196).chr(178) => 'IJ',chr(196).chr(179) => 'ij',
                chr(196).chr(180) => 'J', chr(196).chr(181) => 'j',
                chr(196).chr(182) => 'K', chr(196).chr(183) => 'k',
                chr(196).chr(184) => 'k', chr(196).chr(185) => 'L',
                chr(196).chr(186) => 'l', chr(196).chr(187) => 'L',
                chr(196).chr(188) => 'l', chr(196).chr(189) => 'L',
                chr(196).chr(190) => 'l', chr(196).chr(191) => 'L',
                chr(197).chr(128) => 'l', chr(197).chr(129) => 'L',
                chr(197).chr(130) => 'l', chr(197).chr(131) => 'N',
                chr(197).chr(132) => 'n', chr(197).chr(133) => 'N',
                chr(197).chr(134) => 'n', chr(197).chr(135) => 'N',
                chr(197).chr(136) => 'n', chr(197).chr(137) => 'N',
                chr(197).chr(138) => 'n', chr(197).chr(139) => 'N',
                chr(197).chr(140) => 'O', chr(197).chr(141) => 'o',
                chr(197).chr(142) => 'O', chr(197).chr(143) => 'o',
                chr(197).chr(144) => 'O', chr(197).chr(145) => 'o',
                chr(197).chr(146) => 'OE',chr(197).chr(147) => 'oe',
                chr(197).chr(148) => 'R',chr(197).chr(149) => 'r',
                chr(197).chr(150) => 'R',chr(197).chr(151) => 'r',
                chr(197).chr(152) => 'R',chr(197).chr(153) => 'r',
                chr(197).chr(154) => 'S',chr(197).chr(155) => 's',
                chr(197).chr(156) => 'S',chr(197).chr(157) => 's',
                chr(197).chr(158) => 'S',chr(197).chr(159) => 's',
                chr(197).chr(160) => 'S', chr(197).chr(161) => 's',
                chr(197).chr(162) => 'T', chr(197).chr(163) => 't',
                chr(197).chr(164) => 'T', chr(197).chr(165) => 't',
                chr(197).chr(166) => 'T', chr(197).chr(167) => 't',
                chr(197).chr(168) => 'U', chr(197).chr(169) => 'u',
                chr(197).chr(170) => 'U', chr(197).chr(171) => 'u',
                chr(197).chr(172) => 'U', chr(197).chr(173) => 'u',
                chr(197).chr(174) => 'U', chr(197).chr(175) => 'u',
                chr(197).chr(176) => 'U', chr(197).chr(177) => 'u',
                chr(197).chr(178) => 'U', chr(197).chr(179) => 'u',
                chr(197).chr(180) => 'W', chr(197).chr(181) => 'w',
                chr(197).chr(182) => 'Y', chr(197).chr(183) => 'y',
                chr(197).chr(184) => 'Y', chr(197).chr(185) => 'Z',
                chr(197).chr(186) => 'z', chr(197).chr(187) => 'Z',
                chr(197).chr(188) => 'z', chr(197).chr(189) => 'Z',
                chr(197).chr(190) => 'z', chr(197).chr(191) => 's',
                // Euro Sign
            chr(226).chr(130).chr(172) => 'E',
                // GBP (Pound) Sign
            chr(194).chr(163) => '');

            $string = strtr($string, $chars);
        } else {
            // Assume ISO-8859-1 if not UTF-8
            $chars['in'] = chr(128).chr(131).chr(138).chr(142).chr(154).chr(158)
                .chr(159).chr(162).chr(165).chr(181).chr(192).chr(193).chr(194)
                .chr(195).chr(196).chr(197).chr(199).chr(200).chr(201).chr(202)
                .chr(203).chr(204).chr(205).chr(206).chr(207).chr(209).chr(210)
                .chr(211).chr(212).chr(213).chr(214).chr(216).chr(217).chr(218)
                .chr(219).chr(220).chr(221).chr(224).chr(225).chr(226).chr(227)
                .chr(228).chr(229).chr(231).chr(232).chr(233).chr(234).chr(235)
                .chr(236).chr(237).chr(238).chr(239).chr(241).chr(242).chr(243)
                .chr(244).chr(245).chr(246).chr(248).chr(249).chr(250).chr(251)
                .chr(252).chr(253).chr(255);

            $chars['out'] = "EfSZszYcYuAAAAAACEEEEIIIINOOOOOOUUUUYaaaaaaceeeeiiiinoooooouuuuyy";

            $string = strtr($string, $chars['in'], $chars['out']);
            $double_chars['in'] = array(chr(140), chr(156), chr(198), chr(208), chr(222), chr(223), chr(230), chr(240), chr(254));
            $double_chars['out'] = array('OE', 'oe', 'AE', 'DH', 'TH', 'ss', 'ae', 'dh', 'th');
            $string = str_replace($double_chars['in'], $double_chars['out'], $string);
        }

        return self::replace_no_alpha_chars($string);
    }

    function replace_no_alpha_chars($url) {
        $url = strtolower(ereg_replace("[^a-zA-Z0-9]","-",trim($url))); 
        // Saca los guiones repetidos 
        $url = strtolower(ereg_replace('-+','-',($url))); 

        // Saca el último guión en caso de que termine con uno 
        if ($url[strlen($url)-1] == '-') $url = substr($url, 0, strlen($url)-1); 

        return $url;
    }

    function get_item_url($title, $id, $category = '') {
        $beauty_category = $beauty_title = ''; 
        $beauty_title = self::get_beauty_url_string($title);
        if (strlen($category))
            $beauty_category = self::get_beauty_url_string($category);

        $url = sprintf(SEO_ITEM_PATTERN, (strlen($beauty_category) ? "{$beauty_category}/" : "") . $beauty_title, $id);

        return $url;
    }

    function get_category_url($title, $id) {
        $beauty_title = self::get_beauty_url_string($title);

        $url = sprintf(SEO_CATEGORY_PATTERN,$beauty_title, $id);

        return $url;
    }

    function get_combo_url($title, $id) {
        $beauty_title = self::get_beauty_url_string($title);

        $url = sprintf(SEO_COMBO_PATTERN,$beauty_title, $id);

        return $url;
    }
} 
```

你可以像这样使用它：

```
<a ref="<?= Seo::get_category_url("my super category",10)?>">My super category</a> 
```

你会得到：`http://www.example.com/my-super-category-cat-10`

当然还有我的 .htaccess：

```
RewriteRule ^(.*)-cat-([0-9]+)$ /simple/index.php?categoria_id=$2&estado=mostrar_categoria [L,QSA]
RewriteRule ^(.*)-combo-([0-9]+)$ /simple/index.php?producto_id=$2&estado=mostrar_combo [L,QSA]
RewriteRule ^(.*)-prod-([0-9]+)$ /simple/index.php?producto_id=$2&estado=mostrar_producto [L,QSA] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:51:27.387

除非您认为品牌名称可能会更改，否则您需要进行 2 次重写，一次作为重定向，一次在内部：

```
RewriteRule ^catalog/brand/view?id=2 /<BRAND> [R=301,L]
RewriteRule ^<BRAND> /catalog/brand/view?id=2 
```

这意味着浏览器/蜘蛛总是会看到漂亮的 URL，而您的应用程序会看到真实的 URL。

# linux - linux上的msemaphore？

> ID：836925
> 
> 赞同：2
> 
> 时间：2009-05-07T20:42:34.210
> 
> 标签：linux, multithreading, ipc, pthreads, aix

AIX（如果有人关心的话，还有HPUX）有一个很好的小特性，叫做msemaphores，它可以很容易地同步多个进程共享的内存映射文件的粒度片段（例如记录）。有人知道linux中有类似的东西吗？

为了清楚起见，msemaphore 函数通过[此处](http://www.fkf.mpg.de/edv/docs/aix/AIX_52/usr/share/man/info/en_US/a_doc_lib/libs/basetrf1/msem_init.htm)的相关链接进行描述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T02:39:51.887

这可以使用 POSIX 共享内存互斥锁来完成：

```
pthread_mutexattr_t attr;
int pshared = PTHREAD_PROCESS_SHARED;
pthread_mutexattr_init(&attr);
pthread_mutexattr_setpshared(&attr, &pshared);

pthread_mutex_init(&some_shared_mmap_structure.mutex, &attr);
pthread_mutexattr_destroy(&attr); 
```

现在，您可以使用普通的 pthread_mutex_lock() 等调用从映射了它的多个进程中解锁和锁定 &some_shared_mmap_structure.mutex。

实际上，您甚至可以按照以下方式实现 msem API：（未经测试）

```
struct msemaphore {
    pthread_mutex_t mut;
};

#define MSEM_LOCKED 1
#define MSEM_UNLOCKED 0
#define MSEM_IF_NOWAIT 1

msemaphore *msem_init(msemaphore *msem_p, int initialvalue) {
    pthread_mutex_attr_t attr;
    int pshared = PTHREAD_PROCESS_SHARED;

    assert((unsigned long)msem_p & 7 == 0); // check alignment

    pthread_mutexattr_init(&attr);
    pthread_mutexattr_setpshared(&attr, &pshared); // might fail, you should probably check
    pthread_mutex_init(&msem_p->mut, &attr); // never fails
    pthread_mutexattr_destroy(&attr);

    if (initialvalue)
        pthread_mutex_lock(&attr);

    return msem_p;
}

int msem_remove(msemaphore *msem) {
    return pthread_mutex_destroy(&msem->mut) ? -1 : 0;
}

int msem_lock(msemaphore *msem, int cond) {
    int ret;
    if (cond == MSEM_IF_NOWAIT)
        ret = pthread_mutex_trylock(&msem->mut);
    else
        ret = pthread_mutex_lock(&msem->mut);

    return ret ? -1 : 0;
}

int msem_unlock(msemaphore *msem, int cond) {
    // pthreads does not allow us to directly ascertain whether there are
    // waiters. However, a unlock/trylock with no contention is -very- fast
    // using linux's pthreads implementation, so just do that instead if
    // you care.
    //
    // nb, only fails if the mutex is not initialized
    return pthread_mutex_unlock(&msem->mut) ? -1 : 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T02:25:52.417

[如果POSIX 信号量](http://www.opengroup.org/onlinepubs/000095399/basedefs/semaphore.h.html)`sem_init(3)`的第二个参数" `pshared`" 为真，则可以将 POSIX 信号量放置在进程之间共享的内存中。这似乎与`msem`所做的相同。

```
#include <semaphore.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/mman.h>
#include <time.h>
#include <unistd.h>
int main() {
    void *shared;
    sem_t *sem;
    int counter, *data;
    pid_t pid;
    srand(time(NULL));
    shared = mmap(NULL, sysconf(_SC_PAGE_SIZE), PROT_READ | PROT_WRITE,
            MAP_ANONYMOUS | MAP_SHARED, -1, 0);
    sem_init(sem = shared, 1, 1);
    data = shared + sizeof(sem_t);
    counter = *data = 0;
    pid = fork();
    while (1) {
        sem_wait(sem);
        if (pid)
            printf("ping>%d %d\n", data[0] = rand(), data[1] = rand());
        else if (counter != data[0]) {
            printf("pong<%d", counter = data[0]);
            sleep(2);
            printf(" %d\n", data[1]);
        }
        sem_post(sem);
        if (pid) sleep(1);
    }
} 
```

这是一个非常愚蠢的测试，但它有效：

```
$ cc -o test -lrt test.c
$ ./test
ping>2098529942 315244699
pong<2098529942 315244699
pong<1195826161 424832009
ping>1195826161 424832009
pong<1858302907 1740879454
ping>1858302907 1740879454
ping>568318608 566229809
pong<568318608 566229809
ping>1469118213 999421338
pong<1469118213 999421338
ping>1247594672 1837310825
pong<1247594672 1837310825
ping>478016018 1861977274
pong<478016018 1861977274
ping>1022490459 935101133
pong<1022490459 935101133
... 
```

因为信号量是在两个进程之间共享的，所以尽管有s， `pong`s 也不会从 s 获得交错的数据。`ping``sleep`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:48:28.453

在 Linux 下，你或许可以用 SysV 共享内存来实现你想要的；快速谷歌搜索出现了[这个（相当旧的）指南](http://fscked.org/writings/SHM/shm.html)，可能会有所帮助。

# model-view-controller - 在 MVC 中，ORM 是否代表模型？

> ID：836929
> 
> 赞同：11
> 
> 时间：2009-05-07T20:43:38.980
> 
> 标签：model-view-controller, model

在 MVC 中，ORM 与模型相同还是只是模型的一种设计方式？换句话说，“模型”并不关心你如何获取数据，只要你得到它。或者，“模型”是否意味着我的代码中不再有一堆 SQL 语句，就像表单后面的代码一样？还有什么？

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-07T20:46:59.643

不，ORM 是将基于代码的模型映射到数据库的东西，反之亦然。

对于基本的 CRUD 应用程序，代码中的模型实际上只是代表数据库的[DTO](https://en.wikipedia.org/wiki/Data_transfer_object)，并且您正在加载、编辑和保存它们，这就是您使用它的方式。如果您确实有一个“正确的” [Domain Model](http://en.wikipedia.org/wiki/Domain_model)，那么它会更复杂一些，因为理想情况下您希望将 Domain Model 类的形状与数据库表的形状分离。

详细地说，您将在代码中创建模型来表示[域模型](http://en.wikipedia.org/wiki/Domain_model)（即问题域的各种元素），构建某种“纪念品”类，它们是纯 DTO，您可以将域模型类从/转换为. 然后配置一个 ORM（对象关系映射器）以将这些备忘录 DTO 映射到数据库。即生成 SQL 语句，它将根据您提供给它的模型对象更新数据库。

我可以理解一些困惑，因为有一些工具（[LINQ to SQL](http://msdn.microsoft.com/en-us/library/bb425822.aspx)就是其中之一）可以在设计器中为您实际生成模型类。这不是纯 ORM，如[NHibernate](https://www.hibernate.org/343.html)，您提供 ORM 普通旧对象和一些映射配置，它使用（通常与反射结合）自动为数据库生成 SQL 语句。您可能会使用 EF Code First 将域模型直接映射到数据库而侥幸，但我认为最终当您尝试更改其中一个或另一个时，它可能会变得混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T20:57:11.100

如果您想了解一个使用 ORM 的 MVC 在现实世界中的良好实现，请查看基于 MS ASP.NET MVC、Nhibernate 和存储库模式的[S#arp 架构。](http://www.codeplex.com/SharpArchitecture)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:51:27.213

模型应尽可能与后端数据存储技术解耦。我认为这是一篇很好的文章，讨论了数据访问层、DTO 等之间的关系。[http://msdn.microsoft.com/en-us/magazine/dd263098.aspx](http://msdn.microsoft.com/en-us/magazine/dd263098.aspx)

# asp.net - 模态弹出搜索窗口替换下拉控件 ASP.NET

> ID：836934
> 
> 赞同：3
> 
> 时间：2009-05-07T20:45:08.663
> 
> 标签：asp.net, search, popup, modal-dialog, lookup

我正在寻找在 ASP.NET 3.5 应用程序顶部弹出模式搜索窗口以查找字段值的最简单方法。我有一个屏幕供用户添加课程；用户需要能够通过在弹出窗口中搜索讲师来选择讲师。

所以 - 弹出窗口将有一个文本框和一个带有结果的网格视图；单击结果中的“选择”按钮将填充呼叫表单上的讲师字段。

实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:34:21.783

尝试在 UserControl 中使用 jQuery，其中包含类似[yensdesign](http://yensdesign.com/2008/09/how-to-create-a-stunning-and-smooth-popup-using-jquery/)的教程。

我用这种方法创建的 UserControl 为用户提供了设置网站首选项的选项。我发现使用这种方法控制模态窗口和调用窗口之间的交互比调用新的弹出浏览器窗口更容易。人们也不必担心弹出窗口阻止程序会妨碍您。

这有帮助还是您正在寻找更多详细信息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T00:05:27.840

一个非常简单的方法是将 javascript 添加到您的页面以弹出一个新的浏览器窗口对话框，如下所示：

```
function fnFieldSearch(searchURL)
{
    var wndSearch = window.open(searchURL,"SearchPopup","toolbar=yes,width=600,height=400,directories=no,status=yes,scrollbars=yes,resizable=yes,menubar=no");
    wndSearch.focus();
} 
```

在模态搜索页面上，使用 javascript 将搜索值发回：

```
window.opener.document.FormName.ControlName.value = 'whatever'; 
```

# c# - 我不喜欢这个...这是在欺骗语言吗？

> ID：836945
> 
> 赞同：13
> 
> 时间：2009-05-07T20:47:36.927
> 
> 标签：c#, syntax, short-circuiting

我已经看过几次类似的东西......我讨厌它。这基本上是“欺骗”语言吗？或者..你会认为这是“好的”，因为 IsNullOrEmpty 总是首先被评估？

（我们可以争论一个字符串在从函数中出来时是否应该为 NULL，但这并不是真正的问题。）

```
string someString;
someString = MagicFunction();

if (!string.IsNullOrEmpty(someString) && someString.Length > 3)
{
    // normal string, do whatever
}
else
{
   // On a NULL string, it drops to here, because first evaluation of IsNullOrEmpty fails
   // However, the Length function, if used by itself, would throw an exception.
} 
```

**编辑：** 再次感谢大家提醒我这种语言基础。虽然我知道它“为什么”起作用，但我不敢相信我不知道/不记得这个概念的名称。

（以防有人想要任何背景。我在对由 NULL 字符串和 .Length > x 异常生成的异常进行故障排除时遇到了这个问题......在代码的不同位置。所以当我看到上面的代码时，除了其他所有内容之外，我的挫败感从那里接管了。）

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-05-07T20:52:06.450

您正在利用一种称为短路的语言功能。这不是在欺骗语言，而是实际上完全按照设计使用的方式使用了功能。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-07T20:51:20.053

如果您问是否可以依赖“短路”关系运算符`&&`and `||`，那么是的，这完全没问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-07T20:49:33.507

这没有任何问题，因为您只是想确保不会出现空指针异常。

我认为这样做是合理的。

使用扩展，您可以使其更清洁，但基本概念仍然有效。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-07T20:54:55.070

这段代码完全有效，但我喜欢使用 Null Coalesce Operator 来避免空类型检查。

```
string someString = MagicFunction() ?? string.Empty;
if (someString.Length > 3)
{
    // normal string, do whatever
}
else
{
   // NULL strings will be converted to Length = 0 and will end up here.
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-07T20:51:08.057

这没有什么问题。

if(条件是从左到右评估的，所以像这样堆叠它们是完全可以的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-07T20:52:30.723

在我看来，这是有效的代码（虽然声明一个变量并在下一行分配它很烦人），但您可能应该意识到，您也可以在字符串长度为 < 的情况下输入 else 块3.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-07T20:53:12.513

这是完全有效的，以这种方式使用它没有任何问题。如果您遵循该语言的记录行为，那么一切都很好。在 C# 中，您使用的语法是条件逻辑运算符，可以在[MSDN上找到它们的文档](http://msdn.microsoft.com/en-us/library/aa691310%28VS.71%29.aspx)

对我来说，这与在同一语句中进行乘法和加法运算时不使用括号的情况相同，因为语言记录了乘法运算将首先执行。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-07T20:55:45.020

在我看来，这就像对逻辑短路的完全合理的使用——如果有的话，那就是在欺骗*语言*。我最近才从没有短路的 VB6 来**，**这真的让*我*很恼火。

需要注意的一个问题是，您可能需要在 else 子句中再次测试 Null，因为 - 正如所写的那样 - 您正在使用 Null 字符串和长度小于三个字符串。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-07T21:44:53.420

在大多数情况下，依靠短路是“正确的事情”。它导致代码更简洁，活动部件更少。这通常意味着更容易维护。在 C 和 C++ 中尤其如此。

我会认真重新考虑雇用不熟悉（也不知道如何使用）短路操作的人。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-07T20:54:01.373

我觉得没问题 :) 你只是确保你不访问 NULL 变量。实际上，我总是在对变量进行任何操作之前进行此类检查（另外，在索引集合等时） - 它更安全，是最佳实践，仅此而已..

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-07T20:56:19.183

这是有道理的，因为默认情况下 C# 会短路条件，所以我认为可以利用它来发挥自己的优势。在 VB 中，如果开发人员使用 AND 而不是 ANDALSO，可能会出现一些问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-07T21:00:15.617

我认为这与以下内容没有什么不同：

```
INT* pNumber = GetAddressOfNumber();

if ((pNUmber != NULL) && (*pNumber > 0))
{
  // valid number, do whatever
}
else
{
  // On a null pointer, it drops to here, because (pNumber != NULL) fails
  // However, (*pNumber > 0), if used by itself, would throw and exception when dereferencing NULL
} 
```

它只是利用了语言中的一个特性。我认为，自从 C 开始以这种方式执行布尔表达式（或者任何一种语言首先使用它）以来，这种习惯用法就已经很普遍了。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-07T21:01:09.720

如果它是您编译成程序集的 c 中的代码，那么不仅短路了正确的行为，而且**速度更快**。在机器语言中，if 语句的各个部分是一个接一个地计算的。不短路比较慢。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-07T21:34:04.647

编写代码对公司来说要花费很多美元。但是维护成本更高！

所以，我同意你的观点：很可能这行代码不会被必须在 2 年内阅读并更正它的人立即理解。

当然，他会被要求纠正一个关键的生产错误。他会到处搜索，可能不会注意到这一点。

我们应该总是为下一个人编码，他可能不如我们聪明。对我来说，这是唯一要记住的事情。

这意味着我们使用明显的语言特征并避免其他语言特征。

一切顺利，西尔万。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-08T08:58:00.773

有点跑题了，但是如果您像这样在 vb.net 中使用相同的示例

```
dim someString as string
someString = MagicFunction()
if not string.IsNullOrEmpty(someString) and someString.Length > 3 then
    ' normal string, do whatever
else
    ' do someting else
end if 
```

这会在一个空（无）字符串上爆炸，但在 VB.Net 中，您将其编码如下，在 C# 中做同样的事情

```
dim someString as string
someString = MagicFunction()
if not string.IsNullOrEmpty(someString) andalso someString.Length > 3 then
    ' normal string, do whatever
else
    ' do someting else
end if 
```

添加 andalso 使它的行为方式相同，而且它读起来更好。作为同时进行 vb 和 c' 开发的人，第二个 vb 显示登录名略有不同，因此更容易向某人解释存在差异等。

德鲁克斯

# linux - 基本而全面的组装教程（Linux）？

> ID：836946
> 
> 赞同：38
> 
> 时间：2009-05-07T20:47:37.613
> 
> 标签：linux, assembly, nasm

我想学习一些实用的汇编语言，刚刚在课堂上学习了基本概念。有没有值得推荐的好书或教程（nasm 等）？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-07T21:03:49.603

[PC 汇编语言](http://pacman128.github.io/pcasm/)是我最喜欢的汇编编程资源。它是现代的、免费的，并且涵盖了各种主题。它使用[NASM](http://en.wikipedia.org/wiki/Netwide_Assembler)，示例可用于 Linux（以及其他几个系统）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-12T11:06:45.783

[http://en.wikibooks.org/wiki/X86_Assembly](http://en.wikibooks.org/wiki/X86_Assembly)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-08T17:22:26.437

我同意 PC 汇编语言非常好。其他使用 GAS 的好方法是：

*   [从头开始编程。](http://savannah.nongnu.org/projects/pgubook/)
*   [专业汇编语言，Blum](https://rads.stackoverflow.com/amzn/click/com/0764579010)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-08T06:47:28.877

“学习汇编有什么意义？”

因为您可以了解 CPU 的工作原理并更好地了解系统。我想说理解汇编程序本身就是实用的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-09T17:34:06.790

*   [http://www.duntemann.com/assembly.html](http://www.duntemann.com/assembly.html)

我推荐 Jeff Duntemann 的 Assembly Language Step By Step，第三版。这是我对 asm 的第一次介绍，但它很好读，而且相当现代和最新。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-27T14:11:06.850

I would recommend the assembly tutorials page at [http://pickatutorial.com](http://pickatutorial.com)

I hope it helps.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T17:30:55.963

我推荐英特尔官方手册。您可以在英特尔网站上索取硬拷贝。

请参阅[http://en.wikipedia.org/wiki/X86_assembly_language#External_links](http://en.wikipedia.org/wiki/X86_assembly_language#External_links)

```
* Intel 64 and IA-32 Software Developer Manuals
* AMD64 Architecture Programmer's Manual Volume 1: Application Programming (PDF)
* AMD64 Architecture Programmer's Manual Volume 2: System Programming (PDF)
* AMD64 Architecture Programmer's Manual Volume 3: General-Purpose and System Instructions (PDF)
* AMD64 Architecture Programmer's Manual Volume 4: 128-Bit Media Instructions (PDF)
* AMD64 Architecture Programmer's Manual Volume 5: 64-Bit Media and x87 Floating-Point Instructions (PDF) 
```

我的私人朋友[Google](http://www.google.com)提供的一些资源：

*   函数调用约定：

> [http://unixwiz.net/techtips/win32-callconv-asm.html](http://unixwiz.net/techtips/win32-callconv-asm.html)
> 
> [http://www.delorie.com/djgpp/doc/ug/asm/calling.html](http://www.delorie.com/djgpp/doc/ug/asm/calling.html)

*   简要教程

> [http://www.csn.ul.ie/~darkstar/assembler/](http://www.csn.ul.ie/~darkstar/assembler/)

*   使用 SSE

> [http://www.neilkemp.us/v4/articles/sse_tutorial/sse_tutorial.html](http://www.neilkemp.us/v4/articles/sse_tutorial/sse_tutorial.html)

# wpf - WPF 到 WCF 权限问题

> ID：836961
> 
> 赞同：1
> 
> 时间：2009-05-07T20:51:03.720
> 
> 标签：wpf, wcf, security, permissions, service

我创建了一个希望连接到 WCF 服务的 WPF 浏览器应用程序。该服务与 WPF 应用程序位于同一解决方案中。它是 Visual Studio 使用称为 GetData (int) 的方法创建的默认服务

我正在尝试使用以下代码调用此服务：

```
var client = new Service1.Service1Client();
client.GetData(10); 
```

我在上面的行中收到以下错误 (client.GetData(10);)

```
{"Request for the permission of type 'System.Net.WebPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed."} 
```

请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T13:32:33.557

Scott Lanford 的这个解决方案对我有用：http:
[//www.codeexperiment.com/post/Debugging-XBAPWCF-Applications.aspx](http://www.codeexperiment.com/post/Debugging-XBAPWCF-Applications.aspx)

**Quote:**
此错误的可能原因有很多，但在这种情况下，这是因为 XBAP 项目的默认 Debug->Start Action 是“在 URL 中启动浏览器”，其中 URL 只是指向磁盘上的 .xbap 文件（例如C:\projects\myproject\bin\debug\myproject.xbap）。

要使部分信任的 XBAP 应用程序与 WCF 服务通信，它必须从与 WCF 服务相同的域和端口进行部署。解决此困境的方法是通过使用 PresentationHost.exe 启动 XBAP 应用程序并通过调试参数提供 XBAP URL（从“使用 URL 启动浏览器”值复制）和通过 debugSecurityZoneURL 提供 WCF 服务 URL 来伪造 XBAP URL范围。

例如，您的 XBAP 项目的调试选项应如下所示：

**开始操作 ->**启动外部程序 = *%windir%\system32\PresentationHost.exe*

**开始选项 ->**命令行参数 = *-debug "c:\projects\myproject\bin\debug\MyProject.xbap" -debugSecurityZoneUrl " [http://localhost:2022](http://localhost:2022) "*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T00:00:57.587

您需要在服务器上设置客户端访问策略。在浏览器中运行会带来很多安全限制。

我认为这篇文章应该为您提供所需的信息，[http://www.dotnetcurry.com/ShowArticle.aspx?ID=208&AspxAutoDetectCookieSupport=](http://www.dotnetcurry.com/ShowArticle.aspx?ID=208&AspxAutoDetectCookieSupport=1) 1 。

# iphone - 如何在使用 ASP.NET 平台开发的 Web 应用程序中模仿原生 iPhone 的外观和感觉？

> ID：836968
> 
> 赞同：1
> 
> 时间：2009-05-07T20:51:34.313
> 
> 标签：iphone, css, web-applications

我正计划开发一个针对 iPhone 的 Web 应用程序。我将使用 APT.NET 来开发应用程序。我可能会使用 ASP.NET MVC。

我正在研究如何在我的 Web 应用程序中模仿原生 iPhone 的外观和感觉。我正在寻找一种易于与 ASP.NET 平台一起使用的方法。

到目前为止，我找到了 iUI（code.google.com/p/iui/）。iUI 是一组 CSS 样式表和 javascript，用于模仿原生 iPhone 的外观和感觉。我还不确定与 ASP.NET 集成有多么容易，因为大多数示例都是静态 html。

在使用 ASP.NET 平台开发的 Web 应用程序中模仿原生 iPhone 外观和感觉的好方法是什么？

问候，

赛尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T12:48:05.940

我只是想让你知道我也找到了[http://iwebkit.net/](http://iwebkit.net/)。我会在接下来的几天里测试它。

如果您有其他建议，我将不胜感激。

谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:32:21.157

看看这些：

1.  [使用 ASP.NET MVC 震撼 iPhone](http://www.aaronlerch.com/blog/2008/06/08/rock-the-iphone-with-aspnet-mvc/)
2.  [使用 ASP.NET AJAX 创建 iPhone 应用程序](http://steveorr.net/articles/iPhone.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T12:53:19.547

您使用的服务器端平台与前端的外观和感觉无关，在任何平台上都是相同的技术。

我还使用 Django 后端成功地使用了 iUI 框架。前端完全由您提供的 HTML、CSS 和 JavaScript 决定，它们独立于服务器端代码。

与普通的 WebForms 相比，ASP.NET MVC 为您提供了对标记更多的控制，因此它应该是理想的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-19T22:10:22.200

我是OP。我正在用新答案更新这个问题：

*   [jquerymobile](http://jquerymobile.com/)

# vb.net - 使用 OleDb 更新 Excel 2007

> ID：836971
> 
> 赞同：0
> 
> 时间：2009-05-07T20:52:15.310
> 
> 标签：vb.net, excel, oledb

尝试对 Excel 2007 文件执行更新命令会出现错误： **操作必须使用可更新查询。** 我正在使用 System.Data.OleDb 和这样的连接字符串：

```
Dim strConn As String = "Provider=Microsoft.ACE.OLEDB.12.0;" & _
    "Data Source=""" & pathToFile & """;" & _
    "Extended Properties=""Excel 12.0;HDR=YES""" 
```

我尝试设置 ReadOnly=false 但这给出了**找不到可安装的 ISAM。**我也尝试过设置 Mode=ReadWrite 和 IMEX=1 似乎没有任何效果。我的更新命令是这样的：

```
 Dim cmd As OleDbCommand = con.CreateCommand()
    cmd.CommandText = "UPDATE [" + sheetName + "] SET [Quantity Error] = 'test' WHERE [Full Name] = 'Mr. Brown White'" 
```

其中 sheetName 是通过查询 excel 模式获得的。有可能做我想做的事吗？我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:42:39.067

您通常需要在工作表名称后加一个 $ 符号。尝试：

```
cmd.CommandText = "UPDATE [" + sheetName + "$] SET [Quantity Error] = 'test' WHERE [Full Name] = 'Mr. Brown White'" 
```

没有 $ 符号的名称被解释为命名范围而不是工作表名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:42:02.820

我相信这通常是一个权限问题。如果您在 Excel 中打开文件，您可以读取/写入文件吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-14T10:45:27.657

使用此连接字符串这将起作用

`Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + reportFile + ";Extended Properties=\"Excel 12.0 Xml;HDR=YES;\";`

除了检查 Excel 文件的权限外，还要验证连接字符串的扩展属性是否包含`IMEX=1`表达式。如果是，请将其删除。

# jquery - 使用 jQuery 更改 href 不再触发 a:visited 样式

> ID：836974
> 
> 赞同：4
> 
> 时间：2009-05-07T20:52:33.950
> 
> 标签：jquery, sharepoint, href, visited

我的 SharePoint 网站需要保留 CSS 中为链接定义的 a:visited 样式。我添加了以下代码，它将“&Source=/”附加到每个href。似乎通过jQuery更改href，浏览器只能“看到”原始href，因此永远不会触发`a:visited`样式，因为没有匹配......

```
$("table[class='ms-listviewtable'] td[class='ms-vb2'] a")
    .removeAttr("onclick")
    .attr('href', function () {
        return $(this).attr('href') + '&Source=/';
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T06:20:31.230

看起来 IE 不支持`:visited`动态更新链接的样式。我只测试过 IE8 但如果它在最新版本中不起作用，我不希望它在 IE 6/7 中起作用

IE 只支持最基本的场景，即访问者单击导航到不同页面的链接，然后单击返回按钮返回上一页。只有这样，链接才会显示其`:visited`样式。

它在 Firefox 3 中完美运行；即使`href`通过 javascript 更新链接的属性，链接的样式也会正确。

我创建了一个测试页面，允许您尝试各种链接和方法： http: [//jsbin.com/odoqo](http://jsbin.com/odoqo)（可通过[http://jsbin.com/odoqo/edit](http://jsbin.com/odoqo/edit)编辑）

**注意：**我只在 Firefox 3 和 IE 8 中使用过测试页面，它可能会在 IE 6/7 中中断

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:05:26.680

看看这个问题/答案：

[访问链接后，Firefox 会选择性地跳过状态更改或 a:visited 样式](https://stackoverflow.com/questions/779722/after-visiting-links-firefox-selectively-skips-state-change-or-avisited-styling/808698#808698)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T00:43:00.153

添加查询字符串参数会使浏览器将其视为一个完全不同的 URL，一个尚未访问过的 URL。浏览器无法知道 Source 参数不会更改链接的目标。

要查看的另一件事是您的样式有多具体-有时“table a”会覆盖“a：visited”，因此您还需要“table a：visited”。

# iphone - iPhone 应用程序有哪些使用/分析信息？

> ID：836979
> 
> 赞同：0
> 
> 时间：2009-05-07T20:53:09.677
> 
> 标签：iphone, analytics

如果您通过 iTunes 应用商店部署应用程序，您会从 Apple 获得哪些使用信息？您是否只获得下载/销售数量，这对于免费和付费应用程序有什么不同吗？您是否获得有关其使用频率、崩溃日志、人口统计信息等的任何信息？建立挂钩到您自己的服务器以跟踪此信息的唯一方法是这样的应用程序甚至会获得批准吗？

我看过像[这篇文章这样的文章，其中](http://itmanagement.earthweb.com/entdev/article.php/3805481/iPhone-App-Usage-Trends-Revealed.htm)包括以下引用：

> 只有大约 20% 的用户在首次下载免费应用后的第二天再次使用该应用，到 30 天后，使用该应用的用户不到 5%。

这是基于调查，还是来自 Apple 的数据？除了 Apple 展示顶级应用程序外，似乎没有太多公开可用的数据，但这只是基于下载量或评级，没有更深层次的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T06:41:16.953

这些信息大部分来自[Pinch Media](http://www.pinchmedia.com/)和[Admob](http://www.admob.com/)等公司。他们提供的库可以包含在您的应用程序中，这些库会通知他们的服务器您的应用程序中的事件（特别是启动以及您决定的其他事件）。

他们使用这些事件来提供有关 iPhone 应用程序的汇总信息。最近发表的几份报告引用了这些数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:01:46.940

如果您以某种方式将此类信息的报告编程到您的应用程序中，您只会收到使用信息。

下载次数（如果是非免费应用，则为销售）和最近的崩溃日志是您从 Apple 收到的唯一信息。你甚至没有收到关于谁购买了你的应用程序的个人信息，只有他们这样做了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:58:20.177

您不会从 Apple 获得使用统计数据，只会获得下载和销售统计数据。免费应用程序的报告略有不同（因为它们不会出现在财务报告中），但提供的信息基本相同。

但是，您可以通过让您的应用程序在每次访问应用程序时 ping 远程服务器来自行跟踪使用信息。您可以使用唯一的设备 ID 来跟踪特定用户。这将取决于 iPhone/iPod Touch 的互联网访问。

Apple 确实为您提供了下载次数以及它们来自哪些国家/地区。如果您想要更详细的使用统计信息，您将不得不去第三方解决方案，或者自己编写。

除非 Apple 在打开应用程序时秘密发送使用信息，否则我看不出任何人如何获得有关整个应用程序商店的汇总统计数据。当我上传一个应用程序时，它是二进制格式的，任何人都不太可能添加自己的代码来偷偷地这样做。

# internationalization - 特定于语言环境的静态文件是否有命名约定？

> ID：836983
> 
> 赞同：5
> 
> 时间：2009-05-07T20:53:50.703
> 
> 标签：internationalization, locale

我有一些将被本地化的静态资源（图像和 HTML 文件）。我见过的一种软件是 Apache，它将语言环境附加到名称中；例如，`test_en_US.html`或`test_de_CH.html`。我想知道这个命名方案是否被认为是标准的，或者每个项目是否都有不同的做法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-08T01:49:34.190

虽然没有用于命名本地化文件的记录标准，但我建议使用格式**filename[_language[ _country]]**其中

*   语言是[ISO-639](http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes) 2 字母语言代码
*   领土是[ISO-3166](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements) 2 字母国家代码

例如：

*   myFile.txt（非本地化文件）
*   myFile_en.txt（本地化为全球英语）
*   myFile_en_US.txt（本地化为美国英语）
*   myFile_en_GB.txt（本地化为英国英语）

为什么？这是操作系统、全球化工具（例如 Trados 和 WorldServer）和编程语言使用的最典型的格式。因此，除非您特别喜欢不同的格式，否则我认为没有理由偏离大多数其他人正在做的事情。它可能会为您节省一些集成方面的麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:06:31.080

虽然似乎没有关于文件名中放置它们的标准约定*，*但语言（例如“en”）和区域（例如“en-US”）的国际代码都非常常见且非常简单。我见过的变体，不包括“enUS”、“en_US”和“en-US”：

*   foo.enUS.ext
*   foo.ext_enUS
*   enUS.foo.ext
*   foo/enUS.ext
*   enUS/foo.ext
*   *…令​​人作呕*

我个人喜欢第一个和最后一个变体。前者用于按名称/资源对文件进行分组（适用于需要本地化的文件数量有限的情况），后者用于按区域设置对文件进行分组（更适合具有大量本地化文件的情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-07T14:57:39.623

您应该始终使用“事实上的”标准，即 unix/posix 方式与`gettext`. 你应该用`gettext`它来做你的本地化！

因此，一种也是唯一正确的方法是使用这样的本地化命名：

```
en
en_US
en_UK 
```

某些应用程序，尤其是 Java 开发人员有时会使用`en-US`（连字符而不是下划线），这是完全错误的！！！

gettext 标准是这个，只有这个：

```
locale
 |_en_US
    |_LC_MESSAGES
      |_appname.mo 
```

在哪里：

`locale`- 目录的名称，可能会有所不同，但强烈建议使用“locale”-name

`en_US`- 任何标准语言环境，如 *es_ES*、*es_PT*、...

`LC_MESSAGES`- 强制性的，不能更改！

appname.mo - msgfmt 编译的 appname.po 文件（appname 是你想要的）

# asp.net - ASP.NET URL 重写不适用于文件夹 URL

> ID：836986
> 
> 赞同：0
> 
> 时间：2009-05-07T20:54:29.750
> 
> 标签：asp.net, url-rewriting

我编写了一个自定义 URL 重写模块，以获取某些路径并将它们映射到数据库之外的目录。

我正在使用帖子底部链接中概述的技术。

我正在使用.NET 3.5。问题是它仅在原始 URL 末尾有页面名称时才有效，但如果页面名称被省略，那么它甚至不会调用我的处理程序。例如，URL

```
http://mysite.com/folder/index.aspx  works but 
http://mysite.com/folder/            does not. 
```

只有文件夹的那个根本不会进入我的处理程序类。您需要做些什么来使文件夹正常工作吗？

[http://www.simple-talk.com/dotnet/asp.net/a-complete-url-rewriting-solution-for-asp.net-2.0/](http://www.simple-talk.com/dotnet/asp.net/a-complete-url-rewriting-solution-for-asp.net-2.0/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:41:13.600

使用 .NET 重写时是一个已知问题。您需要正确配置通配符映射。这是一个很好的链接：

[http://devtalk.dk/2007/03/19/Wildcard+Mapping+And+URL+Rewriting+On+IIS7.aspx](http://devtalk.dk/2007/03/19/Wildcard+Mapping+And+URL+Rewriting+On+IIS7.aspx)

另一种选择是使用正则表达式由 IIS [ISAPI重写。](http://en.wikipedia.org/wiki/Internet_Server_Application_Programming_Interface)在我的公司，我们实际上两者都使用。

查看此链接以获取参考：

[http://www.kowitz.net/archive/2006/09/15/url-rewriting-using-ihttpmodule-vs-isapi-rewrite.aspx](http://www.kowitz.net/archive/2006/09/15/url-rewriting-using-ihttpmodule-vs-isapi-rewrite.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:07:09.407

我不知道如何解决它，但原因是因为 IIS 将它视为一个目录（它是）并且不知道如何将文件夹传递给 ASP.NET isapi 过滤器并触发 .净处理机。

您可以尝试使用 IIS7 并将处理程序插入实际的 IIS 管道中。或者查看您在标题“使用 RewriteModule”下方引用的文章的底部。

# .net - Microsoft ASP.NET 动态数据网站是我可以信任的用于制作网站管理区域的平台吗？

> ID：836987
> 
> 赞同：1
> 
> 时间：2009-05-07T20:54:52.697
> 
> 标签：.net, asp.net, web, dynamic-data

你以前用过动态网站吗？您认为这是为我们的网站创建快速管理区域的好方法吗？

定制容易吗？最终用户是否容易操作？

我正在考虑与客户一起使用它并且以前没有使用过，你能建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T21:19:07.180

是的，我用过。

从根本上说，如果您想做的是将表格维护为表格，那么它几乎是全面的。从一组 Linq 类（Linq to SQL 或 Linq to Entities）开始，您会立即获得一组最有用的编辑页面。

然后，您可以添加自定义字段处理、页面、排序顺序以及您想要的大多数内容。

定制很简单，可以随着时间的推移而开发——更重要的是，您可以更改数据库架构并保持您的定制完好无损。

不完美，但您只需很少的代码即可获得*大量功能。*

# python - 数据存储事务限制

> ID：836992
> 
> 赞同：3
> 
> 时间：2009-05-07T20:55:48.750
> 
> 标签：python, google-app-engine, transactions, google-cloud-datastore

在我的 google app 应用程序中，每当用户购买许多合同时，都会执行这些事件（为清楚起见进行了简化）：

*   user.cash 减少
*   user.contracts 增加了数字
*   contract.current_price 已更新。
*   market.no_of_transactions 增加 1。

在 rdms 中，这些将被放置在同一个事务中。我认为谷歌数据存储不允许多个模型的实体在同一个事务中。

解决这个问题的正确方法是什么？如何确保如果写入失败，则所有先前的写入都回滚？

编辑：我显然错过了实体组。现在，我将不胜感激有关如何使用它们的更多信息。需要澄清的另一点是谷歌说“仅在交易需要时使用实体组。对于实体之间的其他关系，请使用 ReferenceProperty 属性和键值，它们可以在查询中使用”。这是否意味着我必须同时定义参考属性（因为我需要查询它们）和父子关系（用于事务）？

编辑 2：最后，如果创建实体以在两个父级之间建立 n 对 n 关系，我如何为一个实体定义两个父级？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T09:15:20.220

经过一番研究，我发现在一些谷歌人的帮助下，在用户空间开发了一个分布式事务层，它提供了一个解决单一实体组限制的解决方案。但到目前为止，它还没有发布，仅在 java 中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-24T15:15:31.470

[让我从Datastore 文档](http://code.google.com/intl/de/appengine/docs/python/datastore/keysandentitygroups.html)中添加一个引用：

> 实体组的一个好的经验法则是，它们的大小应该与单个用户的数据价值差不多或更小。

您可以创建一个伪根实体并将所有内容放在此之下。然后，您执行事务中的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-25T21:08:12.420

shanyu，您提到了分布式事务层，它允许您在单个事务中跨任意多个实体组进行操作。它实际上 [已经发布了](http://code.google.com/p/tapioca-orm/)，只是没有大声宣传。它是由 daniel wilkerson 和 erick armbrust 设计和编写的，我也提供了一些咨询。丹在[这次谈话](http://www.google.com/events/io/2009/sessions)中描述了它。

nick johnson 还描述 [了如何跨实体组进行“转移”类型的操作](http://blog.notdot.net/2009/9/Distributed-Transactions-on-App-Engine)，类似于您所描述的。它不像木薯粉那样通用，但它更简单，重量更轻。

有一个相关的内置功能[transactional tasks](http://code.google.com/appengine/docs/python/taskqueue/overview.html#Tasks_Within_Transactions)允许您将任务添加到数据存储事务中的队列中，这样只有在事务成功提交时才会添加它。然后，该任务可以执行更多数据存储操作，包括不同实体组上的事务。它不如 dan 和 erick 的解决方案强大，但它确实为您提供了跨实体组的最终一致性保证，这对于许多用例来说已经足够了，而且没有额外的开销。

回答您的问题：1）您不需要同时使用参考属性和父/子关系（即实体组）。该准则仅意味着实体组限制数据存储写入吞吐量，因为写入是按实体组序列化的。如果您正在考虑将数据构建到实体组中仅用于祖先查询，您应该意识到这一点。

2) 一个实体不能有多个父级。如果要建模多对多关系，通常应该使用引用属性（即键）的 ListProperty。有关详细信息，请参阅[本文](http://code.google.com/appengine/articles/modeling.html)和[本次演讲](http://www.google.com/events/io/2009/sessions/BuildingScalableComplexApps.html)。***