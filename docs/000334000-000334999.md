# StackOverflow 问答 000334000-000334999

# .net - 编写开源库时应该遵循哪些 StyleCop 规则

> ID：334001
> 
> 赞同：5
> 
> 时间：2008-12-02T13:59:51.823
> 
> 标签：.net, open-source, stylecop

我目前正在为 COM 对象编写一个开源包装器。我刚刚安装了 StyleCop 并针对我的一些代码运行它，正如我所料，它引发了大量警告（其中一些我应该已经在做，例如将“this.”添加到所有本地方法调用和变量中）

我应该尝试减少多少这些警告？在编写开源库时，哪些是最好的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T14:21:55.680

StyleCop 的总体思路是：所有这些 :)

您关闭的选项越多，StyleCop 在强制执行单一代码格式方面的价值就越小。话虽如此，如果您不喜欢某些选项，那么某些选项总比没有好，请将 StyleCop 设置文件包含在您的代码中，其他处理它的人可以使用相同的设置。

如果您不熟悉 StyleCop，有些设置一开始可能看起来很奇怪，但使用它已经两年了，现在我保留了所有选项，我们的团队对结果非常满意。

我还要说，如果您提供的库或框架使用[FxCop](http://msdn.microsoft.com/en-us/library/bb429476(VS.80).aspx)可能比使用 StyleCop 更重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T14:21:28.987

大多数大型开源项目都有自己的风格指南。例如，这里是[Apache C 语言样式指南](http://httpd.apache.org/dev/styleguide.html)。

作为开始，我建议您搜索您感兴趣的操作系统项目的常见问题解答并从那里获取。

无论如何，我相信会有很多人会很快让你知道你是否在很大程度上违反了任何现有的风格规则！;-)

注意所有的警告，通常他们试图告诉你一些有用的东西。不要像实用程序员所说的那样完成“巧合编程”（[书摘）！](http://www.pragprog.com/the-pragmatic-programmer/extracts/coincidence)

编辑：我没有意识到这是您自己的新操作系统项目。我的错。无论如何，我会对一些类似的已经存在的操作系统项目有所了解，看看他们是否有任何风格指南。当然，请查看史蒂夫·麦康奈尔 (Steve McConnell) 的书 Code Complete（[亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0735619670)- 为漫游这些大厅的脚本 Kiddie 链接纳粹清理）。

我所说的警告和“巧合编程”仍然适用！（-：

HTH。

干杯，

抢

# .net - Crystal Reports 与 WinForms 问题

> ID：334004
> 
> 赞同：2
> 
> 时间：2008-12-02T14:01:22.087
> 
> 标签：.net, winforms, crystal-reports

我有一个 WinForms 应用程序（如果细节很重要，用 VB.NET 编写），它有一个用于跟踪应用程序利用率的嵌入式 Crystal Report（我们称之为 utr310.rpt）。我们的报告人员对已投入生产的报告进行了小幅调整，我正在尝试对其进行测试（我们将其称为新的 utr311.rpt），但出现以下错误：

```
System.Runtime.InteropServices.COMException (0x80043AE3): Invalid TLV record.
   at CRAXDRT.IApplication.OpenReport(String pFileName, Object OpenMethod)
   at WinFormsApp422.mCrystal.CrystalReportShowSingleParameter(String sReportName, Object objParam, Boolean& bPrint) in C:\2008-Projects\WinForms-applications\WinFormsApp422\code_Modules\mCrystal.vb:line 161 
```

我不能对这个错误做出正面或反面。大家有看到这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T14:15:20.857

有几个问题要问你？

1.  做了哪些改变？
2.  开发人员是否使用与 VB.NET 相同的版本来更改报告？
3.  可以用开发者水晶报表开发器和你在VB中的版本在该位置打开报表吗？
4.  报告文件大小是否大于零？
5.  路径是否正确？

# open-source - 如何阅读源代码学习如何使用大型系统？

> ID：334009
> 
> 赞同：9
> 
> 时间：2008-12-02T14:02:42.863
> 
> 标签：open-source

假设您想开始为具有数千个 LOC 的开源项目做出贡献。我对如何开始学习/破解新系统的方式/建议很感兴趣。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-02T14:18:50.210

有目的地学习。我认为如果你有一些目标，你会学得最好——修复这个或添加那个功能。开始寻找可能需要进行更改的地方。向后跟踪控制线程以找出如何在代码中到达该点。此外，“鸟瞰”代码——查看布局和结构。好的代码将具有描述性名称，告诉您希望每个类和方法适用。看看您是否可以识别实现模式并查看它们的使用位置/方式。不要在文档中放太多库存——文档可能很棒，但它们通常与代码的实际功能不同步。让代码本身成为最好的文档。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-02T14:17:52.660

如果您想要我认为对学习如何从代码中学习有用的书籍，我会查看 Diomidis Spinellis 的书籍[Code Reading: The Open Source Perspective](https://rads.stackoverflow.com/amzn/click/com/0201799405)和[Code Quality: The Open Source Perspective](https://rads.stackoverflow.com/amzn/click/com/0321166078)。

对于您的具体问题，我将从代码阅读开始。但这两本书都是好书。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-02T14:13:24.167

浏览代码，寻找你认为你知道发生了什么的地方。通读这些部分，看看你最初的想法是否成立，然后尝试修改它，看看你是否可以改变它来做其他事情。

我建议以项目路线图为指导，这样您就可以继续发现新功能和错误修复的位置，以便您可以以有意义的方式做出贡献。

此外，请阅读文档和可能存在的任何衍生文档（功能规范、需求规范等）。这可以进一步帮助您更快地学习代码绳索:)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-18T22:54:34.790

*   不要在小细节上花太多时间。
*   不要一开始就试图了解整个系统。
*   重点是试图理解一个相对“独立”的模块或组件，它是过去作为一个实体（特性）添加的。这通常在你的脑力可以应付的大小限制之内，因为它是由其他人作为一个模块一次完成的。
*   在将更多的组件或“片段”消化并组装在一起后，您对整个系统的理解会有所提高。
*   工具很有用：Doxygen + GraphViz，或者Visual Studio中的“Understand”、call and caller graph、“Find all”和“find all references”等软件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-02T14:20:33.327

我更喜欢在 IDE 调试器中逐行“单步执行”代码。尝试访问大型系统中的所有代码是不切实际的，但我首先调试应用程序的启动，然后转到其他看起来对应用程序感兴趣/重要的代码区域。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-02T14:21:43.590

我会针对源代码运行[doxygen](http://www.doxygen.nl/)，这样我就有了一个可浏览、可读、类级别的源代码视图。它非常适合帮助您通过庞大的代码库

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-03T14:14:40.420

谢谢您的回答。很多有用的信息。

我能想到的一些工具是：

*   grep
*   ctags
*   示波器
*   javadoc (Java)
*   氧气 (C,C++)
*   lxr（用于索引和呈现源代码存储库的软件工具集）

关于有用的工具还有什么建议吗？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-02T14:17:41.803

找一个你觉得舒服的小地方，然后改变它。忽略其余的；你会在需要时了解它。不要对尺寸感到不知所措；每个程序都从第一行开始，如果不是以独立的小部分组织起来，就不可能维护。所以总有适合你的利基市场。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-02T14:22:44.383

我建议找到**您**真正想要添加的功能。

我只真正看过一次别人的代码山，它变得容易多了，因为我想要添加的功能是我真正需要的东西。我认为这是大多数开源项目开始的原因。满足需要。

抢

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-02T14:55:16.487

1.  在您的开发盒上构建和运行代码。
2.  弄清楚系统是如何使用的，并熟悉使用的库。（例如，如果您看到调用某些 OpenGL 库的代码，请熟悉该库）阅读系统文档。
3.  然后我会找到一个将根据一些输入运行的代码点。因此，假设系统根据某些输入生成输出。我会找到启动该过程的方法。现在尝试通过它（可能会很痛苦）或者只是阅读代码并尝试对正在发生的事情进行高级概述。

我发现第 3 步通常会变得非常复杂，它为我提供了如何阅读代码和了解系统如何工作的方向。

添加功能可能是个好主意，但在大型系统中，甚至弄清楚该功能是什么都可能会很痛苦。不仅如此，您为学习系统而编写的任何功能最终很可能看起来都是垃圾，因为您不知道系统在哪里以及如何运行。您想要添加的功能当然可以引导您到达＃3 中的正确点，所以不要打折。

-s

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-12-06T13:12:52.980

Try to reverse engineer the class diagrams.say there is a functionality that gets from A to B.set break point at A, debug,step through and observe the communications,draw the links and the inheritance on your paper.you may also use a sequence diagram. This worked for me to understand specific functionality of a system.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-02T14:19:23.623

如果您熟悉该项目并且对您想要贡献的内容有所了解，请获取最新版本的代码并进行您想要进行的更改。不要试图一次消化整个代码。寻找正在使用的模式和约定，并尽可能地遵守它们。

# java - 等待字符串相等的正确方法

> ID：334038
> 
> 赞同：0
> 
> 时间：2008-12-02T14:12:14.357
> 
> 标签：java, while-loop, cpu-cycles

在 Swing 应用程序中，只有在用户输入正确答案后才能继续执行方法。正确答案存储在一个`String`用户答案由一个听众设置另一个`String`。所以，代码是

```
while (!correctAnswer.equals(currentAnswer)) {
     // wait for user to click the button with the correct answer typed into the textfield
}
// and then continue 
```

这种方法一切正常还是你会以某种方式重构它？它不会对CPU施加额外的惩罚吗？这是一个有点[类似的问题](https://stackoverflow.com/questions/244445/best-refactoring-for-the-dreaded-while-true-loop "可怕的 While (True) 循环的最佳重构")。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T14:42:20.130

正如其他人所建议的那样，您需要为按钮分配一个侦听器，按下按钮时将调用该侦听器。

这是一个不完整的示例，说明了如何使用[`ActionListener`](http://java.sun.com/javase/6/docs/api/java/awt/event/ActionListener.html)并实现其[`actionPerformed`](http://java.sun.com/javase/6/docs/api/java/awt/event/ActionListener.html#actionPerformed(java.awt.event.ActionEvent))在按下按钮时调用的方法：

```
...
final JTextField textField = new JTextField();
final JButton okButton = new JButton("OK");
okButton.addActionListner(new ActionListener() {
    public void actionPerformed(ActionEvent e)
    {
        if ("some text".equals(textField.getText()))
            System.out.println("Yes, text matches.");
        else
            System.out.println("No, text does not match.");
    }
});
... 
```

您可能只想[`ActionListener`](http://java.sun.com/javase/6/docs/api/java/awt/event/ActionListener.html)在按钮和文本字段所在的类中实现，因此您不需要将这两个对象声明为`final`. （我只是使用了一个匿名内部类来保持示例简短。）

有关更多信息，您可能需要查看[Java 教程](http://java.sun.com/docs/books/tutorial/index.html)中的[How to Write an Action Listener](http://java.sun.com/docs/books/tutorial/uiswing/events/actionlistener.html)。

此外，有关事件如何在 Java 中工作的一般信息，[课程：Java 教程中的编写事件侦听器](http://java.sun.com/docs/books/tutorial/uiswing/events/index.html)可能会很有用。

**编辑：**根据 Shiny 先生和 New 的评论的建议，将语句内部的表达式`if`从`textField.getText().equals("some text")`to更改`"some text".equals(textField.getText())`为防止`NullPointerException`if `textField`was 。`null`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T14:19:11.660

你是 UI 编程新手吗？我问的原因是你的答案是基于程序化的编码风格，这不是 UI 的意义所在。它往往是事件驱动的。

在这种情况下，解决方案非常简单：将事件侦听器 ( `ActionListener`) 添加到提交按钮并在那里检查结果。如果没问题，继续。如果没有，请说出来，让他们再试一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T14:18:29.710

我不认为我明白那里的逻辑，但它让我想起了旧的基本时代...... :-) 我不明白为什么应用程序会强制用户输入已知的东西（除非它是密码或其他东西） .

你写的打字是由一个听众观察到的。那么为什么不在那里进行测试呢？不要循环等待事件，让 Java 来做（和其他事情）。如有必要，将您的逻辑一分为二，当您检测到侦听器中给出了正确的输入时，请转到第二部分。

我希望这是有道理的... ;-）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-03T03:00:23.790

是的，正如每个人在这里所说的那样。

对于 gui 应用程序，处理用户输入的最佳方式是等待触发事件。

然后可以使用一种方法来验证输入，如果成功，您可以继续流程，这可能会转到另一个页面。

这是一个完整（但简单）的登录屏幕示例，它验证用户输入，如果成功则执行一些操作。

*此代码除了在完整的准备运行示例中*显示如何应用此概念外，没有其他价值 。

[简单的 gui http://img229.imageshack.us/img229/1532/simplenz0.png](http://img229.imageshack.us/img229/1532/simplenz0.png)

```
// * used for brevity. Preffer single class per import
import javax.swing.*;
import java.awt.event.*;
import java.awt.*;
import java.net.*;
import java.io.*;

public class MatchString{

    private final JTextField password;
    private final JFrame frame;

    public static void main( String [] args ){
        MatchString.show();
    }

    public static void show(){
        SwingUtilities.invokeLater( new Runnable(){
            public void run(){
                new MatchString();
            }
        });
    }

    private MatchString(){
        password = new JPasswordField( 20 );
        frame = new JFrame("Go to www.stackoverflow");
        init();
        frame.pack();
        frame.setVisible( true );
    }

    private void init(){

        frame.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );

        frame.add( new JPanel(){{
            add( new JLabel("Password:"));
            add( password );
        }});

        // This is the key of this question.
        // the password textfield is added an 
        // action listener
        // When the user press enter, the method 
        // validatePassword() is invoked.
        password.addActionListener( new ActionListener(){
            public void actionPerformed( ActionEvent e ) {
                validatePassword();
            }
        });
    }

    private void validatePassword(){            
        // If the two strings match
        // then continue with the flow
        // in this case, open SO site.    
        if ( "stackoverflow".equals(password.getText())) try {
            Desktop.getDesktop().browse( new URI("http://stackoverflow.com"));
            frame.dispose();
        } catch ( IOException ioe ){
            showError( ioe.getMessage() );
        } catch ( URISyntaxException use ){
            showError( use.getMessage() );
        } else {
            // If didn't match.. clear the text.
            password.setText("");
        }
    }
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T14:18:07.590

如果您的字符串以 GUI 速率来自人类用户，那么优化性能就没有什么意义了。人类每秒最多只能输入一到三个字符串，而这对机器来说不算什么。

在这种特殊情况下，您需要做一些事情来获得输入进行测试，我建议使用`[do-while](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/while.html)`循环。

# javascript - 图像和文本查询

> ID：334057
> 
> 赞同：0
> 
> 时间：2008-12-02T14:18:23.970
> 
> 标签：javascript, html, css

我在这里有一个非常简单的 html 页面：

[http://www.nomorepasting.com/getpaste.php?pasteid=22407](http://www.nomorepasting.com/getpaste.php?pasteid=22407)

我在页面上有 4 层。这样做的原因是它是一个更复杂的站点的框架，我已经简化了它来问我的问题。基本上，我希望能够单击第 2 层中的不同链接并更改第 1 层中的图像，但是我发现这样做的方式：

```
<script type="text/javascript"><!--

function sbox(boxName,xname) {

    theBox = document.getElementById(boxName);

theBox.className = xname;

}

//-->

</script> 
```

结果导致文本消失，这是我需要的，以及一种单击并用文本替换任何图像的方法。我找到了替代的 javascript 代码，但无法将其应用于我的 html 页面。

```
<script type="text/javascript">
function toggleImg(myid) {
  objtxt = document.getElementById(myid);
  objimg = document.getElementById(myid+'_img');

  if( objtxt.style.display == 'block' ) { // Show image, hide text
    objtxt.style.display = 'none';
    objimg.style.display = 'block';
  } else { // Hide image, show text
    objimg.style.display = 'none';
    objtxt.style.display = 'block';
  }

}
</script> 
```

在不改变我的页面设计的情况下，最简单的方法是什么？注意：我不想使用框架，我想了解这是如何完成的并为自己做。

我的另一个问题是图层是否应该替换表格：当可以使用 css 来代替时，使用表格总是不好吗？使用图层来制作行和列等价物是否很容易仅用于格式化文本数据，而不是网站的结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T14:30:39.140

表格用于表格数据（想想 Excel）。如果您有要显示的数据网格，请使用表格。当涉及到页面布局时，请使用 CSS 定位。

此外，强迫性的 DIV 使用并不是使用 CSS 的最佳方式。养成将所有内容都包含在 DIV 中的习惯是一种被称为“div 狂热”的做法，您可以通过 Google 搜索其不好的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T14:42:21.643

好吧，首先，在设置背景图像时，无论您将 Z-Index 设置多高，它都不会隐藏 DIV 中的文本。它只是行不通。一种解决方案可能是将内部文本包装在跨度中，并在您希望显示 div 的背景图像时隐藏跨度。但是，从你的问题来看，你不想改变你的 html 结构，但是，我相信你必须要得到你想要的东西。

示例代码：

```
<html>
    <head>
        <style type="text/css">
            .class1{color:#000;}
            .class2{color:#00f;}
            .class3{color:#0f0;}
            .class4{color:#f00; background-image:url('someimage.jpg');}
        </style>
    </head>
    <body>
        <script type="text/javascript">
            function sbox(divid, classname)
            {
                document.getElementById(divid).className=classname;
                if(document.getElementById(divid+"_text")!=null)
                    document.getElementById(divid+"_text").style.display="none";
            }
        </script>
        <div>
            <a href="#" onclick="sbox('div1','class2');return false;">Test Div1, Class2(blue)</a><br/>
            <a href="#" onclick="sbox('div1','class3'); return false;">Test Div1, Class3(green)</a><br/>
            <a href="#" onclick="sbox('div1','class4');return false;">Test Div1, Class4(red)</a>
        </div>
        <div id="div1" class="class1"><span id="div1_text">Blah blah blah</span></div>
    </body>
</html> 
```

我同意 TravisO，HTML 表格应该用于表格数据，而不是作为布局机制。当您拥有大量的表/行/等层次结构时，表中也存在一些 CSS 奇怪之处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T15:28:44.547

（回应 Joshxtothe4 的评论……我需要更多空间来回应）

不幸的是，将课程改回 class1 不会再次显示文本。如果在跨度中找到，我给出的代码将始终隐藏文本。您可以执行以下操作，并添加另一个 CSS 语句，如果使用 class4，则该语句将隐藏跨度。然后你不必在javascript中有那个代码。可能是更清洁的解决方案：

```
<html>
    <head>
        <style type="text/css">
                .class1{color:#000;}
                .class2{color:#00f;}
                .class3{color:#0f0;}
                .class4{color:#f00; background-image:url('someimage.jpg');}
        .class4 span { display: none;}
        </style>
    </head>
    <body>
        <script type="text/javascript">
                function sbox(divid, classname)
                {
                        document.getElementById(divid).className=classname;
                 }
        </script>
        <div>
        <a href="#" onclick="sbox('div1','class1');return false;">Reset</a><br/>
                <a href="#" onclick="sbox('div1','class2');return false;">Test Div1, Class2(blue)</a><br/>
                <a href="#" onclick="sbox('div1','class3'); return false;">Test Div1, Class3(green)</a><br/>
                <a href="#" onclick="sbox('div1','class4');return false;">Test Div1, Class4(red)</a>
        </div>
        <div id="div1" class="class1"><span id="div1_text">Blah blah blah</span></div>
    </body>
</html> 
```

就以图像为背景而言，这可能是您最好的选择。唯一的问题是设置背景图像不会隐藏前景文本。您总是不得不以某种方式隐藏该文本

# database-design - 敏捷开发和数据库更改

> ID：334059
> 
> 赞同：11
> 
> 时间：2008-12-02T14:18:42.613
> 
> 标签：database-design, agile

对于那些敏捷从业者...

在项目期间如何管理对数据库模式的更改？我的假设是，在敏捷项目中，所涉及的任何数据库的架构都会发生变化并被重构，就像代码库一样。

这个假设正确吗？如果是这样，您是否有任何特定的工具或流程可以用来帮助保持事情顺利进行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-02T14:21:35.680

[AgileData.org](http://www.agiledata.org/)是一个关于敏捷数据库开发的优秀资源——远远超过我塞进一个单一的回复。特别是，您可能对[敏捷数据最佳实践](http://www.agiledata.org/essays/bestPractices.html)感兴趣。如果您使用 SQL Server，您可能还对[Red Gate](http://www.red-gate.com/index3.htm)软件中的 SQL Compare 感兴趣。我们的 DBA 使用它来帮助我将现有应用程序的更改从 QA 迁移到生产。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T14:27:05.013

对于每次更新，我会：

*   部署前滚和回滚脚本，
*   部署“从头开始构建数据库”脚本，
*   部署数据迁移脚本，以及
*   强制执行一种机制，将代码锁定到数据库版本，即测试返回数据库当前版本的值，如果存在不匹配，系统会因不匹配而大声疾呼。

高温高压

干杯，

抢

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T14:25:50.290

在我们的敏捷设置中，有一个用于数据库更改的文件夹，以 .SQL 文件的形式完成。到目前为止，我们在每个版本中都进行了数据库更改，并且该文件以应用程序版本命名。更新站点时，安装脚本会自动应用所有更改文件。

我们还有一个参考数据库的完整模式转储，用于新安装，由我们的数据库管理工具创建。

我知道有一些工具可以帮助自动化这个过程，比如 Red Gate，但是手动创建 SQL 更改文件非常容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T14:20:43.980

理想情况下，您进行非破坏性更改，然后在发布完成后，您可以完全弃用架构的旧部分。这并不容易，需要纪律。这甚至并不总是可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T14:24:47.763

看看[Ruby on rails 迁移](http://wiki.rubyonrails.org/rails/pages/understandingmigrations)。如果你不使用 Rails 也没关系，因为这个想法已经被复制到其他框架。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T14:32:42.537

数据库结构很可能是代码的许多部分的依赖项，并且模式更改将产生级联效应。有点像在许多类扩展的类中更改接口。因此，请谨慎对待架构更改。

敏捷方法与其他方法没有什么不同，因为尽可能多地预先设计数据库对您有利，并且您应该寻求比代码更频繁地更改它。并不是说你永远无法改变它，但这样做代价高昂。

正如其他人所指出的，迁移是一种简单但有效的跟踪架构更改的工具。这个概念是 CREATE 和 ALTER 语句的脚本，用于从模式的一个修订版升级到下一个修订版，伴随着 ALTER 和 DROP 语句的脚本来降级相同的更改。Ruby on Rails 在此之上使用了一个数据库抽象层，以便更轻松地切换数据库品牌，但如果您只需要支持一个品牌，您可以简单地使用 SQL 文件。

有一本关于这个主题的备受推崇的书（虽然我还没有购买或阅读它），名为“[重构数据库：进化数据库设计](https://rads.stackoverflow.com/amzn/click/com/0321293533)”，作者是 Scott Ambler

# debugging - 在 VS 2005 中使用托管/非托管代码调试 dll 失败。为什么？

> ID：334077
> 
> 赞同：0
> 
> 时间：2008-12-02T14:21:55.430
> 
> 标签：debugging, visual-studio-2005, c++-cli

我想调试一段用 C++ 编写的代码。问题在于 dll 是混合的 - 它同时包含 C++ 和 CLI（托管 C++）。环境是VS 2005。

我的入口点是一个非常简单的可执行项目，用 C++ 编写，它只是启动混合 dll 中的代码。

问题是：

1.  如果我让两个项目的“调试类型”为自动，我的断点不会被命中。（稍后编辑：这是正常的，因为 Auto 是基于可执行项目的内容）。

2.  如果我将其设置为“混合”，则断点被命中，但非托管手表为空。例如，我看不到 std::string 的值。但是，我可以看到基本类型，例如 int 和 bool。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T06:17:07.507

另外，尝试将调试器设置为混合。这将允许调试托管和非托管代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T22:37:20.087

我可以通过在项目属性（在调试选项卡上）中将调试器类型设置为混合来在 VS2005 中以混合模式进行调试。有时这些事情会在重新启动和干净重建后消失。

如果这不起作用，您尝试在应用程序开始运行后附加到应用程序（调试|附加到进程）。您可以通过按“附加到：”部分旁边中间的“选择”按钮来选择调试模式。

你有来自微软的所有更新吗？可能有一个可以解决您的问题。

一般来说，混合模式调试似乎在 VS2008 中工作得更好。如果可以的话，我建议升级。有一个免费版本，但我认为它在某种程度上是有限的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T14:25:56.747

你确定你启用了所有的调试选项？我在尝试浏览 C++ 选项的迷宫时“忘记”某些内容时看到了这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T14:44:05.540

我面前没有我的 2005/2008 环境，但是我似乎记得有一个选项需要在项目设置中启用（我相信调试选项卡）才能进行非托管调试。启用此功能后，您应该不会有任何问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T19:40:06.490

您需要告诉 Visual Studio 调试的不仅仅是托管代码。转到工具 | 选项，选择调试 | 一般的。取消选中“仅启用我的代码（仅限托管）”旁边的框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-21T10:38:35.613

LanceSc 的建议确实很有帮助。
转到工具 | 选项，选择调试 | 一般的。
取消选中“仅启用我的代码（仅限托管）”旁边的框
这解决了 VS2008 中的问题。

# sqlite - 带有 SQLite 的 ExpressionEngine (CMS)

> ID：334085
> 
> 赞同：1
> 
> 时间：2008-12-02T14:23:52.977
> 
> 标签：sqlite, integration, expressionengine

有没有人破解了 ExpressionEngine (CMS) 来使用 SQLite？如果是这样，关于如何做到这一点的任何好的提示或指南？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T05:03:00.097

鉴于它是受版权保护的专有软件，在 F/OSS 许可下不可用（据我所知），与 MySQL 紧密相关（*不*支持其他数据库，您不能在严格模式下运行 MySQL，这意味着它们依赖于非标准扩展名）我不认为你会找到你正在寻找的东西。

即使有人为自己使用它，它看起来也非常像衍生作品（尽管我想你可以尝试声称它是模仿作品）并且分发它会侵犯版权。

你为什么不联系供应商并提出支付一些美元？或者寻找 F/OSS 替代方案？那里有（*咳嗽*）其中几个。

——马库斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T03:22:03.590

我不知道有任何经过修改以支持 SQLite 的 Expression Engine 1.6。但是，下一个版本（2.0）基于 CodeIgniter 框架，该框架具有支持许多数据库的 DAL。这是Ellis Labs 员工的[帖子，证实了这一点。](http://expressionengine.com/forums/viewthread/76104/#379737)

# flash - 闪动问题

> ID：334088
> 
> 赞同：0
> 
> 时间：2008-12-02T14:24:46.813
> 
> 标签：flash

我刚开始使用flash，我知道补间动画可以自动化简单的事情，但我想知道是否有更多的自动化方法？

比如这里鸟的动画：

[http://www.youtube.com/watch?v=As_-K8xGqLE](http://www.youtube.com/watch?v=As_-K8xGqLE)

但是浏览页面时，我基本上一直在复制图层并移动每个图层中的项目。有没有更好的方法来做到这一点，也许用脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T14:27:18.523

您提供的链接不需要任何 Flash 高级知识，但需要更多耐心。这家伙画的是画，他设置了框架但框架。1 帧 = 1 张图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T18:34:51.643

补间动画仅适用于*移动*对象。其他任何东西都必须是动画。您必须创建在现场行走的小鸟的 MovieClip，然后在播放 MovieClip 时使用补间动画将小鸟从 a 点移动到 b 点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-03T11:59:23.657

使用时间轴动画，您基本上需要一个图层来处理独立移动的每一件事。您可以通过制作包含对象的影片剪辑元件并将所有动画放入该影片剪辑中来简化此操作。然后您可以在主时间轴上对对象的整体运动进行动画处理。

使用动作脚本制作动画的另一种方法。基本上设置一个计时器以间隔触发，并在每个间隔计算动画的每个组件需要在哪里并移动它。不过这里有点太多了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-03T17:41:49.300

哦，伙计，你可以用基于脚本的动画做很多事情。您选择的答案将适用于您的示例，但您确实应该研究基于代码的动画可以为您做什么。查看这些网站以开始使用。

首先，查看用于 ActionScript 2.0 动画的[FuseKit 。](http://www.mosessupposes.com/Fuse/)您是基于补间序列的构建代码。

还有[GoASAP](http://www.goasap.org/)动画平台，它是 Fuse 的 AS3 演进。但它不是一个受限类，而是一个社区驱动的动画平台，目标是为跨多个平台（Flash/AS、SIlverlight/.NET、AfterEffects、3D/Maya 等）的动画提供框架

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-20T05:24:48.867

我已经使用了[FuseKit](http://www.mosessupposes.com/Fuse/)和[Tweenlite](http://blog.greensock.com/tweenlite/)。FuseKit 非常强大和灵活。您可以对非常复杂的动画进行排序。我发现我可以使用 TweenLite 制作大部分动画，所以我建议如果您刚开始使用 Flash，请尝试 Tweenlite。

# unit-testing - 从对象测试事件

> ID：334095
> 
> 赞同：2
> 
> 时间：2008-12-02T14:26:52.283
> 
> 标签：unit-testing, events, testing, tdd

我一直在尝试更多地了解 TDD。`Debug.Asserts`目前在控制台应用程序中有很多保持简单。

我想要完成的部分测试是确保从对象引发事件的次数正确，因为客户端代码将依赖于这些事件。

所以，我开始思考如何测试正在引发的事件，以及如何跟踪它们。所以我想出了一个**监视器**“模式”（如果你可以这样称呼它）。这基本上是一个类，它在其构造函数中采用被测类型的对象。

然后将事件连接到监视器，并创建委托，在引发事件时计数和记录。

然后我回到我的测试代码并执行以下操作：

```
 bool Test()
    {
        MyObject mo = new MyObject();
        MyMonitor mon = new MyMonitor(mo);

        // Do some tests that should cause the object to raise events..

        return mon.EventCount == expectedCount;
    } 
```

这很好用，当我故意破坏我的代码时，测试按预期失败，但**我想知道，这是不是太多的“自由形式”测试代码（即没有支持测试的代码）？**

* * *

**额外的想法**

*   你测试事件吗？
*   *你如何*测试事件？
*   您认为以上有任何漏洞/改进空间吗？

感谢所有输入！`^_^`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T14:35:56.243

您可以做的最简单的事情是为事件订阅一个匿名方法或一个 lambda，并增加一个在您的测试中本地的计数器。根本不需要使用额外的课程。

我发现这不会使您的代码非常易读，所以我做了同样的事情。我在几个项目中编写了监控对象。通常它们比您的显示器更通用。它们只是公开您可以订阅事件的公共方法，并计算它们被调用的次数。这样，您可以为不同的事件重用监视器对象。

像这样的东西：

```
MyObject subjectUnderTest = new MyObject();
EventMonitor monitor = new Monitor();
subjectUnderTest.Event += monitor.EventCatcher;

// testcode;

Assert.Equal( 1, monitor.EventsFired ); 
```

问题在于它并不是真正通用的。您只能测试 monitor.EventCatcher() 可以订阅的事件。我通常不使用参数做事件，所以没问题，我只有标准的 void EventCatcher(object sender, EventArgs arguments)。您可以通过为事件订阅正确类型的 lambda 并在 lambda 中调用 EventCatcher 来使其更通用。不过，这会使您的测试更难阅读。您还可以使用泛型使 EventCatcher 方法与泛型 EventHandler 一起工作。

您可能需要注意，最终您将希望能够准确存储以什么顺序和使用什么参数调用的事件。您的事件监视器很容易失控。

* * *

我发现了另一种方法，这可能对具有更复杂断言的测试有意义。

您无需创建自己的监视器，而是让您选择的模拟框架为您创建它，您只需为处理事件的类创建一个接口。像这样的东西：

```
public interface IEventHandlerStub
{
    event EventHandler<T> Event(object sender, T arguments);
} 
```

然后你可以在你的测试中模拟这个界面。Rhino Mocks 是这样做的：

```
var eventHandlerStub = MockRepository.GenerateStub<IEventHandlerStub>();
myObject.Event += eventHandlerStub.Event;

// Run your code

eventHandlerStub.AssertWasCalled(x => x.Event(null, null)); 
```

对于像这样的简单测试，它可能有点矫枉过正，但是如果您想断言有关参数的事情，例如，您可以使用您的模拟框架的灵活性。

*在另一个注意事项*。Rob 和我正在研究一个通用的事件测试监视器类，它可能会使其中的一些更容易。如果人们有兴趣使用这样的东西，我想听听你的意见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-22T19:20:21.867

我最近写了一系列关于发布同步和异步事件的对象的单元测试事件序列的博客文章。这些帖子描述了一种单元测试方法和框架，并提供了带有测试的完整源代码。

我描述了与您描述的概念类似的“事件监视器”的实现，并且该问题的一些先前回答者已经提到过。绝对是正确的方向，因为在没有某种监视器模式的情况下编写大量测试会导致大量杂乱的样板代码。

使用我的文章中描述的事件监视器，测试可以这样编写：

```
AsyncEventPublisher publisher = new AsyncEventPublisher();

Action test = () =>
{
    publisher.RaiseA();
    publisher.RaiseB();
    publisher.RaiseC();
};

var expectedSequence = new[] { "EventA", "EventB", "EventC" };

EventMonitor.Assert(test, publisher, expectedSequence, TimeoutMS); 
```

EventMonitor 完成所有繁重的工作，并将运行测试 (test) 并断言事件以预期的顺序 (expectedSequence) 引发。它还会在测试失败时打印出很好的诊断消息。与所讨论的一些方法不同的是，它不只是计数，它会断言已遵循指定的确切顺序。此外，您不需要挂钩任何事件。这一切都由事件监视器处理。因此，测试非常干净。

描述问题和方法的帖子中有很多细节，还有源代码：

[http://gojisoft.com/blog/2010/04/22/event-sequence-unit-testing-part-1/](http://gojisoft.com/blog/2010/04/22/event-sequence-unit-testing-part-1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T14:39:18.513

一个漏洞/改进空间是您的监视器只计算引发的事件数。理想情况下，可以指定应该引发哪些事件、发生多少次、以何种顺序，甚至可能指定每个事件引发时 (object sender, EventArgs e) 对应该是什么样子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T15:58:42.630

我通常使用 Mock 对象来测试事件——当我在 Java 中工作时，我使用 EasyMock（对于您选择的语言应该存在类似的东西）：

```
FooListener listener = createMock(FooListener.class);
expect(listener.someEvent());
replay(listener);
myObject.addListener(listener);
myObject.doSomethingThatFiresEvent();
verify(listener); 
```

你所做的对我来说听起来更像是一个存根——也就是说，监听器/观察者不知道它应该多久被调用一次，而只是计算调用次数，然后测试断言该计数。这也是一个合理的解决方案，您更喜欢哪一个主要取决于个人喜好 - 您的语言和可用工具可能会使哪种解决方案更容易。

看看[这篇关于这个话题的文章](http://geekswithblogs.net/optikal/archive/2006/08/12/87801.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T14:29:43.323

对我来说看起来不错 - 因为它有效;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T14:44:02.327

我做测试活动。我这样做的方法很简单。

```
private int counterEvent;

[Test]
public void abcTest()
{
    counterEvent = 0;
    //1- Initialize object to test
    //2- Set the event to test (abcTest_event for example)
    //Assert the object incremented (counterEvent for example)
}

private void abcTest_event(object sender)
{
    counterEvent++;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T14:44:59.830

在我的测试类中，我只是将事件处理程序挂钩到声明的对象的事件......或者我在这里遗漏了什么？

# java - 获取“Java 堆空间”和“内存不足”时的 Eclipse 内存设置

> ID：334102
> 
> 赞同：58
> 
> 时间：2008-12-02T14:28:07.303
> 
> 标签：java, apache-flex, eclipse, memory

当尝试在 Eclipse 中启动和运行 flex/java 项目时，我使用 Eclipse、Tomcat 和 JRE 不断收到“内存不足异常”和“Java 堆空间”。

在研究尝试调整内存设置时，我发现了三个可以调整这些设置的地方：

*   Eclipse.ini

*   Window > Preferences 下的 JRE 设置

*   Catalina.sh 或 Catalina.bat

在这些不同的地方设置 -xms 和 -xmx 有什么区别？是什么意思？

有什么方法可以验证这些内存设置是否已相应设置？

对于具有 2gb 内存的计算机，最佳 -xms 和 -xmx 设置是什么？

还有其他记忆技巧吗？

谢谢。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-02T14:33:48.823

-xms 是启动内存（在 VM 启动时），-xmx 是 VM 的最大内存

*   eclipse.ini : 运行 eclipse 的虚拟机的内存
*   jre设置：从eclipse运行的java程序的内存
*   catalina.sh : Tomcat 服务器的内存

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-02T15:08:02.123

首先，我建议您将问题范围缩小到哪个组件抛出“内存不足异常”。

这可能是：

1.  **Eclipse**本身（我对此表示怀疑）
2.  **您**在**Tomcat下的应用程序**

JVM参数`-xms`和`-xmx`代表堆的“起始内存”和“最大内存”。忘记“开始记忆”。现在这对您没有帮助，只有在您确定您的应用程序将快速消耗此数量的内存时，您才应该更改此参数。

在生产中，我认为您可以更改的唯一参数是`-xmx`Catalina.sh 或 Catalina.bat 文件下的参数。但是，如果您使用已配置的 Tomcat 调试环境直接从 Eclipse 测试您的 webapp，您可以简单地转到“调试配置”>“Apache Tomcat”>“参数”>“VM 参数”并在`-xmx`那里设置。

至于`-xmx`2gb 的最佳值，这在很大程度上取决于您的环境以及您的应用程序可能需要的请求数量。我会尝试从 500mb 到 1gb 的值。检查您的操作系统虚拟内存“区域”限制和 JVM 本身的限制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-12T12:46:10.730

在我们的案例中发现了 2 个问题。

1.  内存正在停止，我们必须将启动权限大小设置为更高的值。我猜它使用内存的速度更快，然后能够分配它。在我们的例子中。-XX:PermSize=256m -XX:MaxPermSize=256m

2.  我们正在使用 Clearcase，并且在 Eclipse 中使用了来自 Rational Clearcase SCM (7.0.0.2) 的插件。该插件是 Eclipse 崩溃的原因。目前我们不知道为什么，但对其他人来说可能会很好。被迫禁用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-03-24T22:16:15.683

Eclipse 中的 Tomcat 不使用 catalina.sh 或 bat。要为托管 Tomcat 设置内存，请使用服务器运行配置中的 VM 设置

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-03T13:07:21.133

当我尝试发布新版本或滥用“标记出现次数”和“与编辑器链接”功能时，我的 FLashBuilder 一直在崩溃。

[通过执行以下步骤http://www.redcodelabs.com/2012/03/eclipse-speed-up-flashbuilder/](http://www.redcodelabs.com/2012/03/eclipse-speed-up-flashbuilder/)，我显着提高了闪存性能

特别是通过将 FlashBuilder.ini 设置为以下配置

```
-vm
C:/jdk1.6.0_25/bin
-startup
plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar
–launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.100.v20110502
-product
org.eclipse.epp.package.jee.product
–launcher.defaultAction
openFile
–launcher.XXMaxPermSize
256M
-showsplash
org.eclipse.platform
–launcher.XXMaxPermSize
256m
–launcher.defaultAction
openFile
-vmargs
-server
-Dosgi.requiredJavaVersion=1.5
-Xmn128m
-Xms1024m
-Xmx1024m
-Xss2m
-XX:PermSize=128m
-XX:MaxPermSize=128m
-XX:+UseParallelGC 
```

我的硬件配置是intel i3 cpu，4gb DDR3，windows 7 64Bit。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T14:56:26.203

有几个不同的内存设置是有充分理由的。

eclipse内存设置是因为Eclipse是一个大型java程序。如果您要在几个项目中打开大量文件，那么您将希望为 Eclipse 提供更多内存。这只是“企业”系统上的问题，通常个人项目不会使用那么多文件句柄或接口。

JRE 设置是运行项目时允许 java 运行时的内存量。当您运行一些占用内存的应用程序时，这可能是您想要的。我已经运行了需要几场 ram 并且必须真正告诉 JRE 没问题的数学项目，JVM 一直假设我的程序处于某种泄漏的失控状态，但我是故意这样做的，并且不得不告诉 JVM特别是它被允许使用的东西。

那么Catalina的内存设置是针对应用服务器Tomcat的。该服务器需要每个应用程序和并发用户的内存。这与 JRE 编号混合在一起，因为您的项目可能是一个 Web 应用程序，而我不确定哪个需要内存。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-12T06:22:08.887

Eclipse 中的内存也有一些问题，但对我们来说，它的方式不是在实际运行时，而是在 Eclipse 进行刷新（手动或自动）时，或者如果尝试构建它，eclipse 崩溃并且是关闭。

在日志中有一些信息：

```
Heap
 def new generation   total 36352K, used 11534K [0x10040000, 0x127b0000, 0x14f00000)
  eden space 32320K,  29% used [0x10040000, 0x10994c30, 0x11fd0000)
  from space 4032K,  49% used [0x123c0000, 0x125aed80, 0x127b0000)
  to   space 4032K,   0% used [0x11fd0000, 0x11fd0000, 0x123c0000)
 tenured generation   total 483968K, used 125994K [0x14f00000, 0x327a0000, 0x50040000)
   the space 483968K,  26% used [0x14f00000, 0x1ca0ab38, 0x1ca0ac00, 0x327a0000)
 compacting perm gen  total 58112K, used 57928K [0x50040000, 0x53900000, 0x60040000)
   the space 58112K,  99% used [0x50040000, 0x538d2160, 0x538d2200, 0x53900000)
No shared spaces configured. 
```

即使我调整 eclipse.ini 以使用这些值，它似乎也没有应用。

```
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
1024M
-framework
plugins\org.eclipse.osgi_3.4.2.R34x_v20080826-1230.jar
-vmargs
-Dosgi.requiredJavaVersion=1.5
-XX:MaxPermSize=256m
-Xms512m
-Xmx1024m 
```

有谁以前见过这个问题？
还要补充一点，使用的项目很大。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-06-24T16:03:33.773

我有这些设置：

```
-vmargs
...
-Duser.name=...
-XX:PermSize=256m
-XX:MaxPermSize=256m
-Xmn128m
-Xms256m
-Xmx768m 
```

在我将 PermSize 设置为 MaxPermSize 之前，Eclipse 随机崩溃。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-02T16:02:54.697

如果您发现内存不足，请考虑这是否合理：您真的需要那么多内存吗？如果没有（即当您没有巨大的对象并且由于某种原因不需要创建数百万个对象时），那么您很可能存在内存泄漏。

在 Java 中，这意味着您在某处保留对某个对象的引用，即使您不再需要它。造成这种情况的常见原因是忘记在资源（文件、数据库连接、语句和结果集等）上调用 close()。

如果您怀疑内存泄漏，请使用分析器来查找哪个对象占用了所有可用内存。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-24T17:10:50.773

我们在尝试构建一个非常大的 Flex 项目时遇到了 Ant 的堆空间问题，该问题**无法**通过增加分配给 Ant 的内存或添加 fork=true 参数来解决。它最终成为 Flex 3.4.0 sdk 中的一个错误。在轮询开发人员的 sdk 版本并恢复到 3.3.0 后，我终于弄清楚了这一点。

对于好奇的人。

我将错误跟踪到一个接口文件，该文件有一个额外的访问器对添加了“get/set maskTrackSkin”。如果向接口添加了任何附加功能，则会发生堆空间错误，更糟糕的是，接口不在出现堆空间错误的项目中。希望这可以帮助某人。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-30T18:49:01.363

Adobe Flash Builder 4.6 Read Me.pdf 建议您编辑 Eclipse 实例的 eclipse.ini 文件，使其包含以下设置：

```
-vmargs -Xms256m -Xmx512m -XX:MaxPermSize=256m -XX:PermSize=64m 
```

# sql-server-2005 - 如何检查 Sql 服务器字符串是否为空或为空

> ID：334108
> 
> 赞同：255
> 
> 时间：2008-12-02T14:31:29.327
> 
> 标签：sql-server-2005

我想检查数据，但如果它为空或为空，请忽略它。目前查询如下...

```
Select              
Coalesce(listing.OfferText, company.OfferText, '') As Offer_Text,         
from tbl_directorylisting listing  
 Inner Join tbl_companymaster company            
  On listing.company_id= company.company_id 
```

但我想得到`company.OfferTex`t if`listing.Offertext`是一个空字符串，以及它是否为空。

性能最佳的解决方案是什么？

* * *

## 回答 #1

> 赞同：484
> 
> 时间：2010-07-13T08:19:31.547

我认为这：

```
SELECT 
  ISNULL(NULLIF(listing.Offer_Text, ''), company.Offer_Text) AS Offer_Text
FROM ... 
```

是最优雅的解决方案。

并用伪代码将其分解一下：

```
// a) NULLIF:
if (listing.Offer_Text == '')
  temp := null;
else
  temp := listing.Offer_Text; // may now be null or non-null, but not ''
// b) ISNULL:
if (temp is null)
  result := true;
else
  result := false; 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-12-02T14:34:55.170

```
SELECT
   CASE WHEN LEN(listing.OfferText) > 0 THEN listing.OfferText 
        ELSE COALESCE(Company.OfferText, '') END 
   AS Offer_Text,

... 
```

在此示例中，如果`listing.OfferText`为 NULL，则 LEN() 函数也应返回 NULL，但仍不 > 0。

**更新**

自从发布这篇文章以来的 5 1/2 年里，我学到了一些东西，现在做起来有很大不同：

```
COALESCE(NULLIF(listing.OfferText,''), Company.OfferText, '') 
```

这类似于接受的答案，但它也有一个后备，以防万一`Company.OfferText`也为空。其他当前使用的答案`NULLIF()`都没有这样做。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-12-02T14:36:58.240

```
Select              
CASE
    WHEN listing.OfferText is null or listing.OfferText = '' THEN company.OfferText
    ELSE COALESCE(Company.OfferText, '')
END As Offer_Text,         
from tbl_directorylisting listing  
 Inner Join tbl_companymaster company            
  On listing.company_id= company.company_id 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-24T13:35:41.857

这是另一个解决方案：

```
SELECT Isnull(Nullif(listing.offertext, ''), company.offertext) AS offer_text, 
FROM   tbl_directorylisting listing 
       INNER JOIN tbl_companymaster company 
         ON listing.company_id = company.company_id 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-12-02T14:38:24.053

您可以使用`ISNULL`并检查已知输出的答案：

```
SELECT case when ISNULL(col1, '') = '' then '' else col1 END AS COL1 FROM TEST 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2014-08-01T06:13:34.173

在 SQL Server 2012 中`IIF`，您可以使用它，例如

```
SELECT IIF(field IS NULL, 1, 0) AS IsNull 
```

与检查字段是否为空的方法相同。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-09-14T17:57:50.333

使用 LEN 函数检查空值或空值。您可以只使用 LEN(@SomeVarcharParm) > 0。如果值为 NULL、'' 或 ''，这将返回 false。这是因为 LEN(NULL) 返回 NULL 而 NULL > 0 返回 false。此外，LEN(' ') 返回 0。请自行查看运行：

```
SELECT 
 CASE WHEN NULL > 0 THEN 'NULL > 0 = true' ELSE 'NULL > 0 = false' END,
 CASE WHEN LEN(NULL) > 0 THEN 'LEN(NULL) = true' ELSE 'LEN(NULL) = false' END,
 CASE WHEN LEN('') > 0 THEN 'LEN('''') > 0 = true' ELSE 'LEN('''') > 0 = false' END,
 CASE WHEN LEN(' ') > 0 THEN 'LEN('' '') > 0 = true' ELSE 'LEN('' '') > 0 = false' END,
 CASE WHEN LEN(' test ') > 0 THEN 'LEN('' test '') > 0 = true' ELSE 'LEN('' test '') > 0 = false' END 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-08-28T18:02:19.773

我知道这是一个旧线程，但我刚刚看到上面的一个较早的帖子，这是不正确的。

如果您使用**LEN(...)**来确定该字段是**NULL 还是 EMPTY**，那么您需要按如下方式使用它：

```
...WHEN LEN(ISNULL(MyField, '')) < 1 THEN NewValue... 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-05-14T09:36:26.627

这个语法：

```
SELECT *
FROM tbl_directorylisting listing
WHERE (civilite_etudiant IS NULL) 
```

在 Microsoft SQL Server 2008 (SP3) 中为我工作

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-09-10T05:52:59.423

```
Select              
Coalesce(NullIf(listing.OfferText, ''), NullIf(company.OfferText, ''), '') As Offer_Text,         
from tbl_directorylisting listing  
 Inner Join tbl_companymaster company            
  On listing.company_id= company.company_id 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-01-26T22:11:06.923

这个 COALESCE 和 NULLIF 的简单组合应该可以解决问题：

```
SELECT             
  Coalesce(NULLIF(listing.OfferText, ''), company.OfferText) As Offer_Text
... 
```

*注意：如果您希望语句在两个值都为 NULL 时返回空字符串而不是 NULL，则添加另一个空字符串作为最后一个 COALESCE 参数。*

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-12-02T14:39:06.300

这是一个解决方案，但我不知道它是否是最好的......

```
Select              
Coalesce(Case When Len(listing.Offer_Text) = 0 Then Null Else listing.Offer_Text End, company.Offer_Text, '') As Offer_Text,         
from tbl_directorylisting listing  
 Inner Join tbl_companymaster company            
  On listing.company_id= company.company_id 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-01-15T23:09:40.890

```
SELECT              
    COALESCE(listing.OfferText, 'company.OfferText') AS Offer_Text,         
FROM 
    tbl_directorylisting listing  
    INNER JOIN tbl_companymaster company ON listing.company_id= company.company_id 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-12-10T12:53:44.273

要检查变量是否为空或为空，请使用以下命令：

```
IF LEN(ISNULL(@var, '')) = 0
    -- Is empty or NULL
ELSE
    -- Is not empty and is not NULL 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-07-28T11:02:33.607

防止SQL 结果中带有`Empty`或值的记录`Null`

我们可以简单地添加 `..... WHERE Column_name != '' or 'null'`

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-07-17T21:28:33.300

```
[Column_name] IS NULL OR LEN(RTRIM(LTRIM([Column_name]))) = 0 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-11-06T13:50:59.263

[Column_name] > ' ' 不包括 Null 和空字符串。单引号之间有一个空格。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-10-08T08:52:04.043

在处理`VARCHAR`/ `NVARCHAR`data 时，大多数其他示例将空格视为与 C# function 相同的空字符串`IsNullOrWhiteSpace`。

此版本尊重空白，并且与 C# 函数的工作方式相同`IsNullOrEmpty`：

```
IIF(ISNULL(DATALENGTH(val), 0) = 0, whenTrueValue, whenFalseValue) 
```

简单测试：

```
SELECT
    '"' + val + '"' AS [StrValue],
    IIF(ISNULL(DATALENGTH(val), 0) = 0, 'TRUE', 'FALSE') AS IsNullOrEmpty
FROM ( VALUES 
    (NULL), 
    (''), 
    (' '), 
    ('a'), 
    ('a ')
) S (val) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-10-30T00:43:05.103

这也适合空间。

```
(len(rtrim(ltrim(isnull(MyField,'')))) !=0 
```

# apache - 如何同时使用 apache mod_rewrite 和 alias？

> ID：334111
> 
> 赞同：16
> 
> 时间：2008-12-02T14:32:55.780
> 
> 标签：apache, mod-rewrite, alias

我在 webroot 之外有一个目录，用于存储从单独的管理系统上传的图像。图像以这种格式存储：

```
filepath/writable/images/00/00/23/65/filename-236581.jpg 
```

（其中 webroot 是文件路径/html）

...例如。这里，236 是图像在数据库中的 ID，文件系统被分成编号的目录，以防止在一个目录中使用 100 多个 inode。

我希望能够从前端网络服务器访问这些，如下所示：

```
http://(server)/filename-236581.jpg 
```

其中 filename 是一个 seo 优化的字符串，与实际文件的名称相同。

我可以让 mod-rewrite 重写 URL，使其包含额外编号的目录，我可以让 alias 将请求重定向到 writable/images 目录，但我不能同时做这两个。如果我将别名和 mod_rewrite 指令都放入，它会忽略别名，并且错误日志会抱怨它找不到文件路径/html/uploaded-images。

这是我到目前为止所拥有的：

```
RewriteRule ^(.*)\/([^\/]*)-([0-9])\.(gif|jpg|jpeg|png)$ /uploaded-images/00/00/00/00/$2-$3.$4 [L,NC] 
```

...等等，一直到：

```
RewriteRule ^(.*)\/([^\/]*)-([0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9])\.(gif|jpg|jpeg|png)$ /uploaded-images/$3$4/$5$6/$7$8/$9$10/$2-$3$4$5$6$7$8$9$10$11$12.$13 [L,NC]

alias /uploaded-images "filepath/writable/images" 
```

删除 [L] 没有任何区别。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-02T15:10:37.297

[L] 表示最后。

您真正需要使用的是 [PT] 标志，以指示重写规则的结果路径应该传递给下一个处理程序，在您的情况下是别名指令。

由于 [PT] 标签也暗示了 [L] 标签，因此您也不再需要 [L]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T14:41:34.580

RewriteRule 之后的 [L] 表示“最后一个”

老实说，我认为这只是意味着更多的 RewriteRule 行将被忽略，但可能值得一试。

# javascript - 如何跟踪基于 Web 的登录和注销？

> ID：334114
> 
> 赞同：2
> 
> 时间：2008-12-02T14:34:12.520
> 
> 标签：javascript, web-applications, login, tracking, logout

我正在修改一个基于成员的网站，其所有者希望能够跟踪数据库后端中所有用户在网站上花费的时间（登录/注销）。登录很容易；有一个入口点（登录表单），因此，一旦登录就可以在数据库中抛出。

但是，注销有点棘手，因为除非用户单击“注销”以明确让我们知道他们要离开解决方案，否则会变得更麻烦（以及用户*真正*单击注销的频率如何？）。一种可能性（仅就跟踪网站上的总时间而言）是在数据库中注册每个页面加载并将其与加载它的用户相关联；问题在于该站点是一个基于会员的视频交付站点（不是您想的那样！），他们的最后一次浏览量可能是 20 或 30 分钟的视频。我们还需要捕获在最后一页上花费的时间——而不仅仅是加载它的时间。

我想到了两种可能的解决方案，但都不是那么优雅。第一个是通过 javascript 捕获所有“卸载”事件并注册对“logout.php”的调用（假设 XMLHttpRequest 或任何在页面卸载后不会立即消失的东西）；问题在于内部链接也注册为卸载事件，因此单击任何链接都会将用户注销（您可以检查“卸载”处理程序中的标志，并让所有内部链接设置该标志 - 不难做到动态的，但有点笨拙）。另一种方法是设置一个间隔，每 60 秒左右对数据库执行一次 ping 操作，这让我们知道用户仍在网站上，然后在提取用户历史记录时进行一些数学运算以计算出该会话的总长度; 这似乎也有点骇人听闻。还，

似乎这个问题并没有那么不寻常，而且必须有更好的方法；是否有解决此问题的最佳实践方法？如果没有，您是否看到任何改进这些解决方案的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T14:40:04.037

网络不是为了准确跟踪注销事件而构建的。您只是不能保证在用户退出时从浏览器中得到通知，因此在正常情况下，您最好的希望是捕获会话超时事件，并且该事件可能要到用户放弃页面后 20 分钟才会触发.

现在您可以通过在每个页面上的计时器（可能每分钟一次或两次）中放置一个 ajax 请求来稍微改进这一点，以提供“心跳”，但这也有一些警告：您需要确保会话将最终仍然会超时，并且您仍然不能保证用户不会阻止这些请求，可能是通过禁用 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T14:38:31.137

我在 javascript 中使用计时器来 ping 服务器取得了很好的成功。在我的情况下，该网站需要 javascript，所以这不是问题。我还使用这种机制来执行检查，以防止单个帐户从两台不同的机器登录，因此有更多令人信服的理由进行此 hack。

卸载时要记住的一件事是您仍然不能保证卸载事件将始终被触发。例如，您将有人在笔记本电脑上关闭笔记本电脑，因此计时器方法可能会更准确一些。

# c# - 不同品牌的网站版本，资源文件？

> ID：334116
> 
> 赞同：2
> 
> 时间：2008-12-02T14:35:52.717
> 
> 标签：c#, asp.net, resources, branding

我有一个需要修改的 Web 应用程序，以便可以为不同的客户重新命名。我使用资源文件和#define 对应用程序的 Windows 版本做了同样的事情。我一直在阅读 aspx/C# 的资源文件，但似乎它们仅限于本地化。我想做一些事情，比如把所有东西都放在资源文件中，然后让 web 配置文件充当#define。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T14:38:44.897

根据您想要重新命名的内容（颜色、徽标等），您可以使用不同的 CSS 文件来执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T14:52:13.027

你当然可以用资源文件做你所说的事情。但是，在 .settings 文件中定义您需要的内容可能更容易，因为当您这样做时，可以在 web.config 文件中覆盖这些值。

如果您计划在资源文件中使用图像/其他二进制资源，.settings 不是完美的解决方案。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-12T03:38:55.883

我使用主题来根据某人的需求更改网站的“品牌”。 [http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)。

您可以创建许多主题，将它们放入应用程序中，然后在 web.config 中指定哪个主题是默认/活动的。

实施主题是你应该从一开始就真正做的事情，但你当然可以改造现有的应用程序，但是根据布局和内容的复杂性，工作量会有所不同。

我不确定有多少主题（如果有的话）可以嵌入到程序集/资源中。

# c# - 远程报告服务的 Windows 身份验证

> ID：334117
> 
> 赞同：0
> 
> 时间：2008-12-02T14:35:56.027
> 
> 标签：c#, windows, authentication, reporting-services, single-sign-on

我有一个 ASP.NET Web 应用程序，用于使用报表查看器显示 MS 报表。报告位于远程服务器上。我需要使用 Windows 身份验证来连接到报告服务，因为我需要根据谁登录到 Web 应用程序来显示报告。

我在网上搜索了解决方案，但找不到任何东西。

有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T15:09:34.693

我现在实际上面临着类似的问题。您需要为 DELEGATION 配置 Web 服务器。

问题是您的 Web 服务器可以使用他们的 Windows 凭据在本地对人员进行身份验证，但即使它模拟这些用户，他们的凭据默认情况下也不能在网络上使用。您必须配置 ActiveDirectory 以将 Web 服务器识别为有权在本地网络上模拟用户。

以下是一些帮助您入门的链接（我目前正在阅读这些链接，这就是我打开它们的原因！）：

[http://support.microsoft.com/kb/810572/](http://support.microsoft.com/kb/810572/)
[http://support.microsoft.com/kb/907272](http://support.microsoft.com/kb/907272)
[http://msdn.microsoft.com/en-us/library/ms998351.aspx](http://msdn.microsoft.com/en-us/library/ms998351.aspx)
[http:// msdn.microsoft.com/en-us/library/ms998355.aspx](http://msdn.microsoft.com/en-us/library/ms998355.aspx)

# c# - 弯引号与方引号，什么给出？

> ID：334119
> 
> 赞同：3
> 
> 时间：2008-12-02T14:35:58.117
> 
> 标签：c#, encoding, csv

毫无疑问，这里有人曾经遇到过一个有趣的问题。

我正在读取一个 CSV 文件，其中包含一些用引号括起来的值，我今天遇到了一个问题，我的应用程序无法读取文件，因为值是用 cury 引号而不是方引号括起来的。这是编码问题吗？我只是将引号替换为“。

有人可以解释为什么会发生这种情况以及我能做些什么吗？我正在使用 C#

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T14:41:27.997

我怀疑数据是从使用 Word 创建的文档中复制和粘贴的。

默认情况下，Word 2003 会将“直引号”转换为所谓的“智能引号”。您可以在键入时使用工具/自动更正选项/自动套用格式覆盖此行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T14:48:36.390

我认为您所指的弯引号实际上是“智能引号”，通常由 Microsoft Office 产品插入。IIRC，它们具有 Unicode 值，但如果您只处理 ASCII 或格式正确的 XML，它们会造成严重破坏。

# regex - 正则表达式匹配字母字符后跟 4 个字母数字

> ID：334123
> 
> 赞同：30
> 
> 时间：2008-12-02T14:37:05.587
> 
> 标签：regex

我需要以下模式的正则表达式：

*   总共 5 个字符（字母和数字，仅此而已）。

*   第一个字符必须是字母（`A`, `B`, 或`C`仅）

*   其余 4 个字符可以是数字或字母。

澄清：第一个字母只能是`A`, `B`, 或`C`.

例子：

*   `A1234`已验证
*   `D1234`是无效的

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-02T14:40:05.627

编辑：Grrr ...由于新的“澄清”而编辑了正则表达式:)

```
^[A-C][a-zA-Z0-9]{4}$ 
```

编辑：用英语解释上述正则表达式......

`^`并`$`表示“从头到尾”（这确保整个字符串必须完美匹配）

`[A-C]`表示“匹配`A`, `B`, 或`C`”

`[a-zA-Z0-9]{4}`表示“匹配 4 个小写字母、大写字母或数字”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-02T14:42:03.393

类似于以下内容：

```
[A-C][A-Za-z0-9]{4} 
```

如果您不熟悉正则表达式，我建议您查看[http://regexlib.com/CheatSheet.aspx](http://regexlib.com/CheatSheet.aspx)，并尝试自己做这些简单的正则表达式。

还有很多在线正则表达式测试应用程序，例如：[http](http://regexlib.com/RETester.aspx) ://regexlib.com/RETester.aspx ，它使您无需编写任何代码即可测试您的正则表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T14:49:40.523

你的意思是第一个字母必须是A，B或C？或者可以是任何字母吗？

如果它必须是 A、B 或 C（区分大小写），那么这将是正则表达式。

```
[A-C][a-zA-Z0-9]{4} 
```

否则，这里的其他答案就足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-30T16:14:46.550

这个答案是正确的，但我确实想补充一点，您可以使用以下内容将其缩短一点。

```
^[A-C]\w{4}$ 
```

\w 表示任何字母数字字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T14:53:00.577

如果这不是我们正在谈论的 Perl 正则表达式，则需要一些剪切和粘贴：

```
[ABC][a-zA-Z0-9][a-zA-Z0-9][a-zA-Z0-9][a-zA-Z0-9] 
```

我剪切并粘贴了“[a-zA-Z0-9]”四次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T19:26:08.920

```
/[ABC](?i:[a-z0-9]{4})/ 
```

# java - 将 Hibernate 实体重构为子类

> ID：334135
> 
> 赞同：6
> 
> 时间：2008-12-02T14:40:17.857
> 
> 标签：java, database, hibernate, refactoring

我有一个当前使用 Hibernate 映射为数据库表中的实体的类。这个类应该被重构为一个抽象类，其中包含其所有子类共有的一些字段。

我正在使用注释来映射休眠实体/关系类。

我想要关于如何进行这种重构的建议/变体。

此外，关于如何将存储在数据库中的数据（用于未来的抽象超类）移动到具体子类之一的一些建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-02T15:39:31.637

首先，我将创建超类并添加必要的注释。您必须在以下之间做出决定：

*   每类策略表
*   每个类层次结构策略的单个表
*   加入子类策略

我认为 Joined Subclass 将在这里工作。您添加注释：

```
@Entity
@Inheritance(strategy=InheritanceType.JOINED) 
```

到超级班。

其次，我将创建代表子类的表。请记住，这些只有子类独有的列，共享的列将保留在超类中。然后从超类表中选择属于每个子类的行并移动数据。

我不确定您是否正在寻找更具体的东西？本文[解释](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/#d0e1168)了 Hibernate 的继承。

# c++ - 如何在 Visual Studio 中使用有关头文件路径的 C++ 库的依赖项

> ID：334138
> 
> 赞同：2
> 
> 时间：2008-12-02T14:41:09.463
> 
> 标签：c++, visual-studio

我们有几个在应用程序中使用的 C++ 库，并且出现了很多依赖项。

* * *

示例问题：假设我们有一个使用**libB**和**libC的应用程序****AppA**。**libC**使用**libD**。每个库都是一个静态库项目，所有库都分组在一个解决方案中，并且依赖项提供给 Visual Studio，因此所有库和应用程序都链接在一起并以正确的顺序构建。

 ******现在我必须将**libB**、**libC**和**libD**的标头路径添加到**AppA** ，并将 libD的路径**添加**到**libC**作为**AdditionalIncludePath**。我认为如果每个库都可以*定义*它的一个包含路径并使用依赖机制将这些路径添加到依赖项目的包含路径中会更好。

有这样的机制吗？

我尝试使用属性表，但这意味着必须定义两次依赖项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T14:49:51.160

首先，如果 AppA 仅使用 LibC，您可能会遇到设计问题，但必须知道 LibD 的标头路径，即使它不直接使用它。如果要单独使用 LibC 和 LibD，它们应该构建为独立的单元，并且 LibC 应该保护其用户免受 LibD 依赖。
当然，如果 LibC 建立在 LibD 中定义的某些对象上，那将无法正常工作，但是 AppA kindof 直接使用 LibD。

您问题的实际答案：如果您的所有库都在一个解决方案中捆绑在一起，它们可能共享一个基本路径。即 LibB 在 Libraries/LibB 中，LibC 在 Libraries/LibC 中。如果您将基本路径添加到应用程序，然后确保不是来自当前项目/文件夹的每个包含都使用限定路径，那么您不必向解决方案构建添加这么多路径。例如，在 LibC 中，您将拥有：

```
// LibC File
#include "AFileFromLibC.h"
#include "LibD/AFileFromLibD.h"

//LibC Code goes here. 
```

# silverlight - Silverlight WCF 服务错误

> ID：334141
> 
> 赞同：0
> 
> 时间：2008-12-02T14:41:53.283
> 
> 标签：silverlight, wcf

什么会阻止一台机器在某些时候使用启用 Silverlight 的 WCF 服务，而另一台机器在同一个网络域上，在同一个代理/防火墙/等后面……可以吗？服务和应用在同一个域中。

当服务进入时，我正在写入事件日志，我什至看不到呼叫通过。

任何指针都非常感谢。

**更新：**使用 fiddler 后，如果我们有 fiddler 运行，它似乎可以工作，但如果我们不运行，则不会。我比以往任何时候都更加困惑！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T23:16:18.457

安装[Fiddler](http://www.fiddlertool.com/)看看发生了什么。没有其他好方法可以解决这个问题（有时甚至提琴手也无能为力）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-03T10:42:26.027

教训是永远不要相信你所说的。非工作机器上的代理确实不同。:o\

Fiddler 将自己放入[代理链](http://www.fiddler2.com/Fiddler/help/hookup.asp)中，这就是导致它在 fiddler 运行时工作的原因。

案件已解决。

# multithreading - 使用多线程和连接池时避免连接超时

> ID：334144
> 
> 赞同：3
> 
> 时间：2008-12-02T14:42:15.530
> 
> 标签：multithreading, ado.net, timeout, connection-pooling

我将只读数据库操作分成多个块，（每个块读取大量数据的子集，对其进行分析并将结果写入磁盘文件）。

每个块在新的 .net 线程（使用委托和 BeginInvoke）上执行 Select（到数据表中）

数据的子集比池中的可用连接多，所以当我用完连接时，在第一个释放之前，后续的连接请求排队...直到连接超时到期，然后我得到超时异常。

我该怎么做，A）当池中的连接都在使用时抑制超时连接异常，或者 B）在我什至请求另一个连接之前检测到它们都在使用，所以我可以等到一个可用时再询问?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T14:50:32.267

两种解决方案：

A) 将您的连接池配置为几天的超时。这将阻止待处理的任务，直到返回连接。缺点：当任务挂起时，这将不起作用。

B) 使用线程池和工作队列。线程池必须与连接池大小相同（即每个线程一个连接）。将所有工作放入队列中，并让任务从队列中获取工作项，直到队列为空。

解决方案 B 的伪代码：

```
public class Setup
    connPool = createConnectionPool(100);
    queue = createWorkQueue();
    putAllWorkItemsInQueue(queue);
    for (int i=0; i<connPool.size(); i++) {
        t = new WorkerThread(queue)
        list.add(t);
        t.start();
    }
    while (queue.size() != 0) {
        Thread.sleep(1000);
    }
    for (thread in list) {
        thread.interrupt();
    }

public class WorkerThread
    run() {
        while (true) {
            try {
                workUnit = queue.get(); // This blocks
                process(workUnit);
            } catch (InterruptedException e) {
                break;
            }
        }
    } 
```

# c++ - 复音播放

> ID：334148
> 
> 赞同：4
> 
> 时间：2008-12-02T14:42:44.013
> 
> 标签：c++, iphone, cocoa-touch, core-audio, openal

我需要具有以下功能的音频播放：良好的性能（用于游戏）、音高控制以及同时多次分层相同样本的能力（复音）。在 iphone sdk 上获得这个的快速方法是什么？

* * *

这是我到目前为止发现的：

没有可用的库或示例代码可以做到这一点，请告诉我错了。

SoundEngine.cpp（来自 CrashLanding 和 TouchFighter 代码示例）使用 OpenAL 并允许控制音高，但每次启动缓冲区时，如果正在播放相同的缓冲区，则其播放头会回到开始处。

使用 SoundEngine.cpp 获得复音的一种肮脏的解决方案是为同一个声音文件加载多个缓冲区，而不深入研究其实现（这对我来说是不可理解的）。假设我想要每个声音最多 4 个复音，然后我为同一个文件加载 4 个缓冲区。我只需要将它全部包装在一个经理类中。走这条路安全吗？和/或有没有办法将 SoundEngine.cpp 破解为复音？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T18:19:26.210

FMOD (www.fmod.org) 提供所有这些功能。在文档中查看他们的复音和音高偏移 DSP 效果的 virtualvoices 示例。

我只是一个客户，与他们没有任何关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T18:41:06.543

CrashLanding 的 SoundEngine 是一团糟，我会远离它。围绕 OpenAL 编写您想要的内容并不难，只需要几个小时的工作。您可以查看[Finch](http://github.com/zoul/Finch/)或[Cocos 2D 声音引擎](http://code.google.com/p/cocos2d-iphone/source/browse/trunk/experimental/sound-engine/)。

# .net - 计算今天之后的下一个周年纪念日

> ID：334149
> 
> 赞同：4
> 
> 时间：2008-12-02T14:42:46.980
> 
> 标签：.net, vb.net

计算某人生日的下一个周年纪念日的最快/最简洁的方法是什么。

例如，如果我知道一个人出生于 1990 年 1 月 31 日，而今天是 2000 年 2 月 10 日，那么他们的下一个周年纪念日就是 2001 年 1 月 31 日。

2 月 29 日应该滚到 3 月 1 日（例如，如果他们出生于 1990 年 2 月 29 日，他们的第一个生日将是 1991 年 3 月 1 日）。

编辑：哇 - 我认为这会更微不足道。我真的认为会有一些我可以使用的库函数。Anyhoo，感谢你们所有人，我有一个我*认为*可行的解决方案，它可以处理所有愚蠢的 2 月 29 日问题。虽然它不是很漂亮:-(

```
Function NextBirthDay2(ByVal dStartDate As Date, ByVal dNow As Date) As Date
    Dim oDate As Date
    Dim bFeb29thHack As Boolean = dStartDate.Month = 2 And dStartDate.Day = 29

    If bFeb29thHack Then
        oDate = New Date(dNow.Year, 3, 1)
    Else
        oDate = New Date(dNow.Year, dStartDate.Month, dStartDate.Day)
    End If

    If (oDate <= dNow) Then
        oDate = oDate.AddYears(1)
    End If

    If Date.IsLeapYear(oDate.Year) And bFeb29thHack Then
        oDate = oDate.AddDays(-1)
    End If
    Return oDate

End Function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T14:48:06.423

我没有在 VB.Net 中工作过，但我认为 C# 代码足够有意义：

```
private DateTime nextDate(DateTime currentDate, DateTime anniversaryDate)
{
    DateTime nextDate;
    try{
        nextDate = new DateTime(currentDate.Year, anniversaryDate.Month, anniversaryDate.Day);
    } catch (ArgumentOutOfRangeException)
    {
        //for 29 Feb case.
        nextDate = new DateTime(currentDate.Year, anniversaryDate.Month, anniversaryDate.Day-1).AddDays(1);
    }

    if (nextDate <= currentDate)
        nextDate = nextDate.AddYears(1);
    return nextDate;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T14:57:28.633

试试这个：

```
int bMon      = 3; // for March
int bDayOfMon = 26 // for March 26th

DateTime nextBirthDay = 
       (new DateTime(DateTime.Today.Year, bMon, bDayOfMon - 1 ))
        .AddDays(1).AddYears((DateTime.Today.Month > bMon || 
          (DateTime.Today.Month == bMon && 
           DateTime.Today.Day > bDayOfMon ))? 1: 0); 
```

if your birthdate is Feb 29th this will give you the next Feb 29th, or Mar 1, depending on whether next year is leap year or not...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T15:12:24.283

Edit: Changed my example so it handles birthdays on leapday.

```
Function NextBirthDay(ByVal BirthDate As Date) As Date

    If Not Date.IsLeapYear(Now.Year) And BirthDate.Month = 2 And BirthDate.Day = 29 Then BirthDate.AddDays(1)

    Dim TestDate As Date = New Date(Now.Year, BirthDate.Month, BirthDate.Day)

    If DateDiff(DateInterval.Day, TestDate, Now) > 0 Then

        TestDate.AddYears(1)
        REM now check if NEXT year are leapyear, if so and birthday was a leapday, change back to leapday
        If Date.IsLeapYear(TestDate.Year) AndAlso BirthDate.Month = 2 AndAlso BirthDate.Day = 29 Then
            Return New Date(TestDate.Year, 2, 29)
        Else
            Return TestDate
        End If

    Else

        Return TestDate

    End If

End Function 
```

Should work as expected now.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T15:17:55.487

Does it have to be .NET code ? The easiest way to implement this in SQL will be to use an Auxiliary calendar table. There are plenty of references in google about it for example [here](http://web.archive.org/web/20070611150639/http://sqlserver2000.databases.aspfaq.com/why-should-i-consider-using-an-auxiliary-calendar-table.html).

# vbscript - 如何根据 vbscript 自定义操作结果中止 InstallShield 设置？

> ID：334163
> 
> 赞同：3
> 
> 时间：2008-12-02T14:46:07.970
> 
> 标签：vbscript, windows-installer, installshield

我创建了一个 vbscript 自定义操作，它检查一些注册表项并在必要时更改它们。如果无法写入密钥或类似情况，则应中止设置。

为了实现这一点，我设置了一个属性，我试图将其用作执行序列中下一步的条件，但这不起作用。

我发现这是行不通的，因为自定义操作在执行时无法写入属性。

所以问题是：如何根据我的自定义操作所说的来实现中止安装？有没有一种方法可以将“中止安装请求”传递给安装程序或类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T15:40:51.010

如果您在[http://community.installshield.com](http://community.installshield.com)上搜索，您会发现 Robert Dickau 的一篇题为“Exiting an MSI Installation from a Custom Action”的文章。它位于以下链接：

[http://community.installshield.com/showthread.php?p=418197](http://community.installshield.com/showthread.php?p=418197)

这是他用作示例的代码片段：

```
Function ExitSetupFromVBS( )

Const IDABORT = 3

    ' ...do some work...

    ' abort the installation
    ExitSetupFromVBS = IDABORT

End Function 
```

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T15:35:00.820

您应该需要从函数中返回 3 表示失败，返回 0 或 1 表示成功。

这是一篇关于该主题的 msdn 文章：http: [//msdn.microsoft.com/en-us/library/aa371254 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa371254(VS.85).aspx)

确保将脚本放入函数中。

# memory - 我可以从 WinDbg 运行 .NET 垃圾收集吗？

> ID：334174
> 
> 赞同：17
> 
> 时间：2008-12-02T14:49:48.867
> 
> 标签：memory, garbage-collection, clr, windbg, sos

我正在研究为什么托管进程使用大量内存。有没有办法`GC.Collect(3)`从 WinDbg 运行，以便我可以专注于实际的内存分配？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T16:17:29.067

我认为没有任何方法可以从 WinDbg 运行 .NET 垃圾收集，但我也不认为有必要。

请参阅[Rico Mariani 的 Performance Tidbits - Tracking down managed memory leaks (how to find a GC leak)](http://blogs.msdn.com/ricom/archive/2004/12/10/279612.aspx)，了解有关找出堆上的内容的信息。

其他可能有用的链接：

*   [何时调用 GC.Collect()](http://blogs.msdn.com/ricom/archive/2004/11/29/271829.aspx)
*   [Scott Dorman - .NET 内存管理 - 资源](http://geekswithblogs.net/sdorman/archive/2008/09/14/.net-memory-management-ndash-resources.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T16:35:26.283

我不相信您可以从 WinDbg 触发 GC。

以下是一些我用来进行内存分配跟踪的有用工具：

*   [SOSEX](http://www.wintellect.com/cs/blogs/jrobbins/archive/2007/06/19/great-sosex-a-phenomenal-net-debugging-extension-to-see-the-hard-stuff-steve-johnson-is-my-hero.aspx) - WinDbg 的进一步扩展以补充 SOS，它添加了 !dumpgen 以转储来自特定世代的对象（非常适合找出 LOH 和 Gen 2 中的内容）和 !refs 命令，它将为父级引用提供目的。
*   [.Net Memory Profiler——](http://memprofiler.com/Default.aspx)这是一个交互式运行时非常有用的工具，但它还包含一个从转储文件加载的选项。这提供了一种相当直观的方式来跟踪内存使用情况。轻松值得 250 美元的价格，但他们也有 14 天的评估。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T16:46:36.637

WinDBG 首先是一个 Win32/内核调试器。因此，您可能想尝试其中一种托管调试器，例如[mDBG](http://msdn.microsoft.com/en-us/library/ms229861.aspx)。但我曾经为 MSFT 提供 .NET 调试支持，而且我从来不需要这样的东西来解决内存泄漏问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T22:05:59.627

嘿，罗杰，希望您的内存泄漏现在得到解决。:-)

我首先要确定它是“托管内存泄漏”。我的意思是，当您查看性能监视器计数器时，**.NET CLR Memory -> # Bytes in all heaps以与同一进程的****Process -> Private Bytes**计数器相同的速率增加。如果是，那么您可以使用上述技术。

如果不是，您可能会因为运行托管代码而出现本机泄漏。我看到的最常见的情况与在进程中加载​​而不是卸载的 .NET 程序集有关。这看起来像是 Perfmon 中的本机内存泄漏。

我建议您尝试在[DebugDiag](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1286)中运行泄漏规则并查看内存报告显示为泄漏调用堆栈的内容。

Here is another great resource on the subject: [I have a memory leak!!! What do i do? (defining the "where")](http://blogs.msdn.com/tess/archive/2005/11/25/i-have-a-memory-leak-what-do-i-do-defining-the-where.aspx)

Thanks, Aaron

# memory - .NET 应用程序的合理内存量是多少？

> ID：334179
> 
> 赞同：2
> 
> 时间：2008-12-02T14:51:07.413
> 
> 标签：memory, clr

我收到了一些投诉，称我们的一个托管应用程序使用了 20-25Mb 的 RAM。我通常会反驳说内存很便宜。克服它。

这对于 Windows 窗体应用程序是否合理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-02T14:55:06.750

20-25MB 不算什么。

无论如何，.Net 框架并不总是立即回收 RAM。随着时间的推移，我看到应用程序在“昂贵”的过程中达到了几百 MB RAM 的峰值，然后即使在“昂贵”的过程完成后也只是坐在那里。然而，这是一种误导。该应用程序未使用此 RAM。只是垃圾收集器还没有看到收集大量旧 RAM 的需要。如果操作系统需要该 RAM，请放心，它会被收集。应用程序最多只能使用几百 K 的想法不适用于*托管*环境——对于操作系统进程，是的。对于本机应用程序，也许。但不是托管代码。否则，您最终只会得到具有完整 GB 或更多 RAM 的系统，而这些 RAM 只是处于空闲状态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T14:54:47.267

这个问题就像问“你可以在一个房间里放多少苹果”......

首先我会反问“苹果有多大”......？

然后我会反击“房间有多大”......？

当你回答了这些问题后，就可以给出一个*粗略*的估计。尽管意识到即使是 .Net 上的“Hello World”应用程序（以及 Java 也是如此）也可以占用几 KB 到几百 TB（理论上）之间的任何内容，因为 GC 主要是构建以便它们分配得很好根据可用内存量，池中的内存量非常大。因此，在内存稀缺的计算机上，.Net WinForms 应用程序可能需要少量内存，而在具有大量可用内存的系统上，即使对于“Hello World”，它也可能需要（理论上） *TB ...*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-02T14:55:13.663

这很合理，是的。分配更多的内存比通过更频繁地 GC 来积极尝试降低堆大小要便宜。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T14:56:09.370

回击有一个潜在的正当理由：如果您的客户在终端服务环境中使用您的应用程序，并且十几个或更多用户共享 4GB 内存怎么办？将您的 20 - 25 MB 添加到 Outlook 的 30+、IE 的 20+、Word 的 25+ 和 Excel 的 25+，乘以终端用户的数量，希望您能看到他们*可能*来自哪里。

我认为，在这个时代，20 - 25 MB 是完全合理的。如果你是数百兆，那可能是另一回事。但这都是特定情况的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-02T15:55:02.310

RAM 究竟是什么意思？是工作集、私有工作集、虚拟内存等等等等？我刚刚启动了一个相当简单的 .Net 应用程序，它占用了 21MB 的工作集，即 21MB 的 RAM。但是它的私有工作集只有 4MB，所以即使我的应用程序没有加载，系统和共享库也会占用大约 17MB。

然后，我使用该应用程序做了一些相当消耗内存的工作，私人工作集达到了 28MB。然后我切换到另一个内存密集型应用程序，发现我的私人工作集现在是 8MB，尽管没有释放内存。

应用程序对 RAM 的使用非常难以衡量，更难确定任何内存使用是否“过多”（当然，除了一些令人发指的事情之外）。

除非您的客户使用经过深思熟虑的性能计数器测量来指示各种类型的内存使用情况，否则您实际上并不知道您的应用程序在他们的计算机上使用了多少内存。

您并没有真正的内存问题，您所拥有的是一个潜在的棘手的通信问题，具体取决于客户的技术知识。但是 RAM 很便宜听起来有点颠倒，可能不是你最好的方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-02T14:52:42.840

这取决于应用程序在做什么。20 - 25Mb 对我来说听起来并不多。

我刚刚创建了一个非常简单的 Windows 窗体应用程序，上面几乎没有，并且占用了 19 - 20Mb。我认为这可能是 .NET 表单应用程序占用的最小内存量。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-02T14:55:14.940

不，这太离谱了。你称自己为程序员？我的上帝，伙计。刚开始时，我可以在一张打孔卡上放置 15 个应用程序（顺便说一句，我必须用一把生锈的脚趾甲剪打孔）。它们都在十五个 CPU 周期内完成，实际上是从无到有地创建了内存。

你应该感到羞愧。马上辞职。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-02T14:57:29.820

你在做什么？用掉大约 20 本长篇小说的内存是否合理？这绝对是您的应用程序，而不仅仅是 .net 运行时开销？有问题的机器内存不足吗？它会降低性能吗？

那和一千零个其他问题是您需要回答的:) 我个人认为这是一个可笑的巨大内存量......但后来我在手机上工作，20mb 大约是我能逃脱的最多最大堆大小:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-03T00:53:46.217

如果您的用户正在使用任务管理器来检查您的应用程序的内存使用情况，那么他们很可能正在查看“**内存使用情况**”列。正如斯蒂芬马丁所说，这是一种误导，因为该列实际上显示了应用程序的完整工作集。这由以下部分组成：

*   **私有**工作集 - 仅对您的进程私有的驻留页面。
*   可**共享**工作集 - 可以与其他进程共享的常驻页面。
*   **共享**工作集 - 当前与其他进程共享的常驻页面。这是可共享工作集的子集。

如果是这种情况，您可以通过手动将应用程序的完整工作集减少为其私有/共享工作集来玩一些小把戏。这是通过使用 Win32 API 调用**SetProcessWorkingSetSize(GetCurrentProcess(), -1, -1)**来完成的。这是 Windows 在系统内存不足时无论如何都会做的事情，但是控制何时发生这种情况可以让您将 .NET 应用程序的完整工作集剥离到其私有/共享工作集。这个数字通常要小得多。

小了多少？将您的应用程序最小化到任务栏会做同样的事情，因此您可以在不更改任何代码的情况下进行检查。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-03T01:13:43.477

如果您的应用程序的内存占用一再引起人们的注意，您至少应该看看您是否真的需要这个数量，或者它是否只是累积的低效率。减少内存占用通常也会带来速度的提升，进而提高客户的满意度。通常，这种抱怨还可能暗示其他效率低下，从用户的角度来看似乎有些臃肿。

# asp.net - 有没有办法禁用/覆盖禁用 WebControls 的默认样式

> ID：334180
> 
> 赞同：0
> 
> 时间：2008-12-02T14:51:19.643
> 
> 标签：asp.net, themes, styles

自从我涉足网络开发以来，那个人就一直在唠叨我；有办法吗？我是否可以覆盖该样式并依靠其他方式通知我的用户该控件不能被取消？

我的问题是 RadioButton- 和 CheckBox-Lists 的标签变灰使它们不可读。

我总是可以用样式/主题的标签替换禁用的文本框，看起来像文本框，但这会更具侵入性......

[编辑]好的，对不起；这不是解决方案；文本框已经有“只读”选项，这意味着它们看起来像我想要的那样，即使在用户输入锁定时也是如此；问题在于 IList 控件（RadioButtonLists 和 CheckBoxLists。）

一如既往，感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T14:55:02.897

当然！听起来您正在寻找的是[CSS 属性选择器](http://css.maxdesign.com.au/selectutorial/selectors_attribute.htm)：

```
input[@disabled=true], input[@disabled] {
  .. insert your new style here ..
} 
```

希望有帮助！

# database - 在数据库中存储标签的最有效方法是什么？

> ID：334183
> 
> 赞同：147
> 
> 时间：2008-12-02T14:51:59.673
> 
> 标签：database, database-design, tags, data-modeling, tagging

我正在我的网站上实现一个标记系统，类似于一个 stackoverflow 使用，我的问题是 - 存储标签以便可以搜索和过滤它们的最有效方法是什么？

我的想法是这样的：

```
Table: Items
Columns: Item_ID, Title, Content

Table: Tags
Columns: Title, Item_ID 
```

这太慢了吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2008-12-02T15:05:32.533

一件物品会有很多标签。一个标签将属于许多项目。这对我来说意味着你很可能需要一个中间表来克服多对多的障碍。

就像是：

> 表：项目
> 列：Item_ID、Item_Title、内容

> 表：标签
> 列：Tag_ID、Tag_Title

> Table: Items_Tags
> Columns: Item_ID, Tag_ID

It might be that your web app is very very popular and need de-normalizing down the road, but it's pointless muddying the waters too early.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-03T11:38:58.720

Actually I believe de-normalising the tags table might be a better way forward, depending on scale.

This way, the tags table simply has tagid, itemid, tagname.

You'll get duplicate tagnames, but it makes adding/removing/editing tags for specific items MUCH more simple. You don't have to create a new tag, remove the allocation of the old one and re-allocate a new one, you just edit the tagname.

For displaying a list of tags, you simply use DISTINCT or GROUP BY, and of course you can count how many times a tag is used easily, too.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-17T23:51:35.930

If you don't mind using a bit of non-standard stuff, Postgres version 9.4 and up has an option of storing a record of type JSON text array.

Your schema would be:

```
Table: Items
Columns: Item_ID:int, Title:text, Content:text

Table: Tags
Columns: Item_ID:int, Tag_Title:text[] 
```

For more info, see this excellent post by Josh Berkus: [http://www.databasesoup.com/2015/01/tag-all-things.html](http://www.databasesoup.com/2015/01/tag-all-things.html)

There are more various options compared thoroughly for performance and the one suggested above is the best overall.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T14:58:40.130

根据您在问题中提供的数据，您无法真正谈论缓慢。而且我认为您甚至不应该在这个开发阶段过分担心性能。这称为[过早优化](http://c2.com/cgi/wiki?PrematureOptimization)。

但是，我建议您在 Tags 表中包含 Tag_ID 列。每个表都有一个 ID 列通常是一个好习惯。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T15:03:34.877

我建议使用中间第三个表来存储标签<=>项目关联，因为我们在标签和项目之间有多对多的关系，即一个项目可以与多个标签相关联，一个标签可以与多个项目相关联。HTH，阀门。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T15:04:52.457

如果空间将成为问题，请使用第三个表 Tags(Tag_Id, Title) 来存储标签的文本，然后将 Tags 表更改为 (Tag_Id, Item_Id)。这两个值也应该提供唯一的复合主键。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T15:06:42.280

Items should have an "ID" field, and Tags should have an "ID" field (Primary Key, Clustered).

Then make an intermediate table of ItemID/TagID and put the "[Perfect Index](http://www.singingeels.com/Articles/Understanding_SQL_Many_to_Many_Relationships.aspx)" on there.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-13T08:49:09.523

Tag Schema: Tag tables and attributes:

Tables:

```
tags (each row only keeps information about a particular tag)
taggings (each row keeps information about trigger and who will receive the trigger )
products_tags (each row keeps information about tag with particular product)
tag_status (each row keeps track of a tag status) 
```

Table: tags Attributes of tags table:

```
id(PK)
userId(FK users)(not null)(A tag only belongs to one user, but  a user can create multiple tags. So it is one to many relationships.)
genreId(FK products_geners)(not null)
name (string) (not null)
description (string)
status (int) (0=inactive, 1=pending, 2=active, there could be more flag)
rank(int)  (rank is the popularity of a particular tag), this field can be use for sorting among similar tags.)
type (int) (0=type1, 1=type2, 2=type3)
photo(string)
visibility (int) (0=public, 2=protected, 3 = private)(private means the tag only  visible to assigned users of a product, protected means a tag only visible to all friends and followers of the creator of the tag, public means search by public, such as all admin created tag)
createdAt(timestamp for the tag was created at)
updatedAt (timestamp for the tag last time updated)
deletedAt (default value null) (timestamp when tag was deleted, we need this field because we will delete tag permanently from audit table). 
```

Note: Keeping field no 10 will come handy later.

Table: taggings :

This table will be used for triggering such as broadcasting other users' feed or sending them notification. After a row inserted in this table, there will be a service who will read a row take associated action to remove the row.

Attributes of taggings table:

```
Id(PK)
tagId(a tagging row only belongs to a tag, but a tag can have multiple row).
taggableId (id of a user who will receive notification)
taggableType(int) (0=notification, 1=feed message)
taggerId(the person who triggered the broadcast)
taggerType(ad, product, news)
createdAt(timestamp for the tag was created at) 
```

Table: products_tags

From user perspective a user able to create a tag after instantiating an product, so bellow table will keep information about which products has which tags.

Attributes of Attributes of taggings table:

```
Id (PK)
productId(FK)
tagId(FK) 
```

Table: tag_status

When user will create a tag, a row will be created in this table with tagId and default status inactive/pending, admin will pull all tags from tags table where status=pending/inactive, after reviewing a tag if admin approved the tag then value of status in tag table will be approved and the row of tag_status will be removed. If admin is rejected then the value of the status field of tag_status table will be rejected and a trigger will be broadcasted and the receiver will send a notification to the associated user of that tag with a message that his tag is rejected .

```
id(PK)
senderId(Id of the user)
receiverId(Id of admin user)
createdAt(timestamp of created at)
updatedAt(timestamp of updated at)
deletedAt(timestamp of deletedAt) default value null
expiredAt (if a tag never gets approved it will expire after a certain time for removing its information from the database. If a rejected tag gets updated by user then expiredAt will reset to new future time)
status 
Message (string varchar(256)) (message for user) 
```

# .net - 如何使用 MSBuild 仅构建解决方案中包含的少数项目？

> ID：334189
> 
> 赞同：0
> 
> 时间：2008-12-02T14:53:13.883
> 
> 标签：.net, tfs, msbuild, tfsbuild

我正在尝试设置 TFS Team Build，并且是 MSBuild 的新手。我有一个包含几个项目（MyProject1、MyProject2、..）的解决方案。我发现设置团队构建时，我只能选择应该构建哪个解决方案，并且在执行构建时，所有项目的构建目标变得相同，并且所有项目的输出都放入构建服务器上的部署文件夹中。

有没有办法让我只构建解决方案的一个或少数几个项目而不构建整个项目，因为我只希望构建其中的一部分？

我可以只使用 MSBuild 构建解决方案文件，还是可以指定要构建的单个项目？

如果可能的话，谁能给我 msbuild 语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T17:31:01.727

您可以在您的解决方案中创建额外的解决方案配置，例如称为“构建”。在该配置中，仅构建您想要的项目。在 teambuild 项目文件中，使用该元素指定只应构建您的“构建”配置。

另一种选择是创建一个单独的解决方案，仅包含您要构建的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T15:18:50.633

在构建菜单中选择“批量构建”，这将允许您仅重新构建您选择的项目，并且它能够以不同的模式（如发布和调试）进行它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T19:38:35.477

您可以只构建一个项目；从命令行使用例如

msbuild.exe 一些.csproj

也可以看看

[http://msdn.microsoft.com/en-us/library/ms164311.aspx](http://msdn.microsoft.com/en-us/library/ms164311.aspx)

# sql - 为什么 SQL ANSI-92 标准没有比 ANSI-89 更好地采用？

> ID：334201
> 
> 赞同：110
> 
> 时间：2008-12-02T14:56:45.250
> 
> 标签：sql, join, ansi-sql, ansi-92

在我工作过的每一家公司，我发现人们仍在使用 ANSI-89 标准编写 SQL 查询：

```
select a.id, b.id, b.address_1
from person a, address b
where a.id = b.id 
```

而不是 ANSI-92 标准：

```
select a.id, b.id, b.address_1
from person a
inner join address b
on a.id = b.id 
```

对于像这样一个非常简单的查询，可读性没有太大差异，但是对于大型查询，我发现将我的连接条件分组并列出表可以更容易地查看我在连接中可能遇到的问题，并且让我将所有过滤保留在 WHERE 子句中。更不用说我觉得外连接比Oracle中的(+)语法直观多了。

当我尝试向人们宣传 ANSI-92 时，使用 ANSI-92 优于 ANSI-89 是否有任何具体的性能优势？我会自己尝试，但是我们这里的 Oracle 设置不允许我们使用 EXPLAIN PLAN - 不希望人们尝试优化他们的代码，对吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-12-02T15:05:27.293

根据 Peter Gulutzan 和 Trudy Pelzer 的“SQL Performance Tuning”，在他们测试的六个或八个 RDBMS 品牌中，SQL-89 与 SQL-92 样式连接的优化或性能没有差异。可以假设大多数 RDBMS 引擎在优化或执行查询之前将语法转换为内部表示，因此人类可读的语法没有区别。

我还尝试宣传 SQL-92 语法。在它被批准 16 年后，是时候人们开始使用它了！现在所有品牌的 SQL 数据库都支持它，所以没有理由继续使用非标准的`(+)`Oracle 语法或`*=`Microsoft/Sybase 语法。

至于为什么很难打破 SQL-89 习惯的开发者社区，我只能假设有一个庞大的“金字塔基础”程序员通过复制和粘贴来编写代码，使用书籍、杂志文章中的古老示例，或其他代码库，这些人不会抽象地学习新语法。有些人模式匹配，有些人死记硬背。

不过，我逐渐看到人们比以前更频繁地使用 SQL-92 语法。自 1994 年以来，我一直在线回答 SQL 问题。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-02T17:03:33.090

ANSI092 标准包含一些非常令人发指的语法。[自然连接](http://en.wikipedia.org/wiki/Join_(SQL)#Natural_join)是一个，而 USING 子句是另一个。恕我直言，向表中添加列不应破坏代码，但 NATURAL JOIN 会以最令人震惊的方式破坏。破解的“最佳”方法是编译错误。例如，如果您在某处选择 *，则添加一列**可以**编译失败。失败的下一个最佳方法是运行时错误。更糟糕的是，您的用户可能会看到它，但它仍然会给您一个很好的警告，表明您已经破坏了某些东西。如果您使用 ANSI92 并使用 NATURAL 连接编写查询，它不会在编译时中断，也不会在运行时中断，查询将突然开始产生错误的结果。这些类型的错误是阴险的。报告出错，可能财务披露不正确。

对于那些不熟悉自然连接的人。他们在两个表中存在的每个列名上连接两个表。当您有一个 4 列键并且您厌倦了键入它时，这真的很酷。当 Table1 有一个名为DESCRIPTION 的预先存在的列并且您向Table2 添加一个名为的新列时，问题就来了(1000) 自由形式的字段。

除了上述问题之外，USING 子句还可能导致完全的歧义。在另一个[SO 帖子](https://stackoverflow.com/q/228424/111424)中，有人展示了这个 ANSI-92 SQL 并请求帮助阅读它。

```
SELECT c.* 
FROM companies AS c 
JOIN users AS u USING(companyid) 
JOIN jobs AS j USING(userid) 
JOIN useraccounts AS us USING(userid) 
WHERE j.jobid = 123 
```

这是完全模棱两可的。我在 Companies 和 user 表中都放置了一个 UserID 列，没有任何投诉。如果公司中的 UserID 列是最后一个修改该行的人的 ID 怎么办？

**我是认真的，谁能解释为什么这种模棱两可是必要的？为什么它直接内置到标准中？**

我认为比尔是正确的，有大量的开发人员通过编码复制/粘贴到那里。事实上，我可以承认在 ANSI-92 方面我是其中的一员。我见过的每个示例都显示多个连接嵌套在括号中。老实说，这使得在 sql 中挑选表充其量是困难的。但随后一位 SQL92 布道者解释说，这实际上会强制执行连接顺序。耶稣……我见过的所有复制粘贴器现在实际上都在强制加入订单 - 95% 的工作最好留给优化人员，*尤其*是复制/粘贴。

托马拉克说得对，他说，

> 人们不会仅仅因为它在那里就切换到新语法

它必须给我一些东西，我看不出有什么好处。如果有上行空间，那么负面因素就是一只大到不容忽视的信天翁。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-02T15:17:18.577

想到几个原因：

*   人们这样做是出于习惯
*   人们很懒，更喜欢“旧式”连接，因为它们涉及的打字更少
*   初学者经常会遇到关于 SQL-92 连接语法的问题
*   人们不会仅仅因为它在那里就切换到新语法
*   人们没有意识到新的（如果你想这样称呼它）语法的好处，主要是它使您能够在执行外部联接*之前过滤表，而不是在您只有 WHERE 子句时过滤表之后。*

就我而言，我使用 SQL-92 语法进行所有连接，并尽可能转换代码。这是一种更清洁、更易读、更强大的方法。但是很难说服某人使用新样式，因为他们认为在不改变查询结果的情况下增加打字工作量会伤害他们。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-10-29T13:48:40.217

回应上面的 NATURAL JOIN 和 USING 帖子。

为什么你会看到需要使用这些 - 它们在 ANSI-89 中不可用，并且是为 ANSI-92 添加的，因为我只能将其视为快捷方式。

我永远不会把连接留给机会，并且总是会指定表/别名和 ID。

对我来说，唯一可行的方法是 ANSI-92。它更冗长，并且语法不被 ANSI-89 追随者喜欢，但它巧妙地将您的 JOINS 与您的 FILTERING 分开。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-02T23:14:10.893

首先让我说，在 SQL Server 中，外连接语法 (*=) 并不总是给出正确的结果。有时它会将其解释为交叉连接而不是外部连接。因此，有充分的理由停止使用它。并且该外连接语法是一个已弃用的功能，并且不会出现在 SQL Server 2008 之后的下一个 SQL Server 版本中。您仍然可以进行内连接，但究竟为什么会有人想要这样做呢？它们不清楚并且更难维护。您不容易知道什么是联接的一部分，什么是真正的 where 子句。

我认为您不应该使用旧语法的一个原因是，了解连接以及它们做什么和不做什么对于任何将编写 SQL 代码的人来说都是一个关键步骤。如果没有彻底了解连接，则不应编写任何 SQL 代码。如果您很好地理解它们，您可能会得出这样的结论：ANSI-92 语法更清晰且更易于维护。我从来没有遇到过不使用 ANSI-92 语法而不是旧语法的 SQL 专家。

我遇到或打过交道的大多数人都使用旧代码，真的不了解连接，因此在查询数据库时会遇到麻烦。这是我的个人经历，所以我并不是说它总是正确的。但作为一名数据专家，多年来我不得不修复太多这种垃圾，以至于我不相信它。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-01T11:36:53.023

我在学校学习过 ANSI-89，并在工业界工作了几年。然后我离开了 DBMS 的神话般的世界 8 年。但后来我回来了，这个新的 ANSI 92 东西正在被教授。我已经学习了 Join On 语法，现在我实际教 SQL，我推荐新的 JOIN ON 语法。

但我看到的缺点是相关子查询在 ANSI 92 连接的情况下似乎没有意义。当连接信息包含在 WHERE 中并且相关的子查询在 WHERE 中“连接”时，一切似乎都是正确且一致的。在 ANSI 92 中，表的连接条件不在 WHERE 中，而子查询中的“连接”是，语法似乎不一致。另一方面，试图“修复”这种不一致可能只会让情况变得更糟。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-02T15:19:08.077

我不确定答案.. 这是一场宗教战争（虽然程度低于 Mac-Pc 或其他人）

一个猜测是，直到最近，Oracle（可能还有其他供应商）还没有采用 ANSI-92 标准（我认为它是在 Oracle v9 或更高版本中），因此，对于在公司工作的 DBA/Db 开发人员来说仍在使用这些版本，（或者希望代码可以跨可能使用这些版本的服务器移植，他们必须坚持旧标准......

真的很遗憾，因为新的连接语法更具可读性，而旧语法会在几个有据可查的场景中产生错误（不正确）的结果。

*   具体来说，当在联接的“外部”一侧的表中的非联接相关列上存在条件过滤谓词时，外部联接。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-03-16T14:03:08.597

我有一个最初为 SQL Server 6.5 编写的查询，它不支持 SQL 92 连接语法，即

```
select foo.baz
from foo
  left outer join bar
  on foo.a = bar.a 
```

而是写成

```
select foo.baz
from foo, bar
where foo.a *= bar.a 
```

查询已经有一段时间了，相关数据的积累导致查询运行太慢，大约需要 90 秒才能完成。当这个问题出现时，我们已经升级到 SQL Server 7。

在处理了索引和其他复活节彩蛋之后，我将连接语法更改为符合 SQL 92。查询时间下降到 3 秒。

有充分的理由转换。

[从这里](https://stackoverflow.com/questions/700868/what-was-your-coolest-sql-optimization-on-a-slow-performing-query)转贴。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-02T17:31:04.457

惯性和实用性。

ANSI-92 SQL 类似于触摸打字。从某种理论上讲，它总有一天可能会让一切变得更好，但我现在可以用四根手指更快地打字。我需要倒退才能前进，但不能保证永远会有回报。

编写 SQL 大约占我工作的 10%。如果我需要 ANSI-92 SQL 来解决 ANSI-89 SQL 无法解决的问题，那么我会使用它。（事实上​​，我在 Access 中使用它。）如果一直使用它可以帮助我更快地解决现有问题，我会花时间吸收它。但是我可以在不考虑语法的情况下抽出 ANSI-89 SQL。我得到报酬是为了解决问题——思考 SQL 语法是浪费我的时间和雇主的钱。

总有一天，年轻的蚱蜢，你会为你使用 ANSI-92 SQL 语法辩护，反对年轻人抱怨你应该使用 SQL3（或其他）。然后你就会明白了。:-)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-12-08T19:00:51.447

以下是比较 SQL-89 和 SQL-92 的几点，并澄清了其他答案中的一些误解。

1.  `NATURAL JOINS`是一个可怕的想法。它们是隐含的，它们需要有关表的元信息。SQL-92 不需要使用它们，因此只需**忽略它们**。它们与本次讨论无关。
2.  `USING`是个好主意，它有两个效果：
    1.  它仅在 equijoin 的结果集上生成一列。
    2.  它强制执行一个健全和理智的约定。在 SQL-89 中，有人`id`在两个表上编写列。加入表后，这变得模棱两可，并且需要显式别名。此外，`id`连接上的 s 几乎可以肯定有不同的数据。如果您将 person 与 company 连接，您现在必须将一个别名`id`为`person_id`，一个别名`id`为`company_id`，否则连接将产生两个模棱两可的列。为表的代理键使用全局唯一标识符是标准奖励的惯例`USING`。
3.  SQL-89 语法是隐式的`CROSS JOIN`. A`CROSS JOIN`不会减少集合，它会隐式增长它。`FROM T1,T2`与 相同`FROM T1 CROSS JOIN T2`，这会产生笛卡尔连接，这通常不是您想要的。有选择性地减少删除到一个遥远的`WHERE`条件意味着你更有可能在设计过程中犯错误。
4.  SQL-89`,`和 SQL-92 显式`JOIN`具有不同的优先级。`JOIN`具有更高的优先级。更糟糕的是，[像 MySQL 这样的一些数据库在很长一段时间内都犯了这个错误。](https://pento.net/2009/04/03/join-and-comma-precedence/). 所以混合这两种风格是个坏主意，今天更流行的风格是 SQL-92 风格。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-02T15:26:10.463

我可以从普通开发人员的角度来回答，知道足够的 SQL 来理解这两种语法，但每次我需要它时仍然使用谷歌搜索插入的确切语法...... :-P（我不整天做 SQL ，只是不时修复一些问题。）

嗯，实际上，我发现第一种形式更直观，两个表之间没有明显的层次结构。我用可能是旧书学习 SQL 的事实，显示第一种形式，可能没有帮助...... ;-)我在谷歌的*sql 选择*搜索中
找到的第一个参考资料（它为我返回主要是法语答案...... ) 首先显示旧形式（然后解释第二个形式）。

 *只是对“为什么”问题给出一些提示...... ^_^ 我应该阅读一本关于该主题的优秀现代书籍（与数据库无关）。如果有人有建议...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-02T17:01:24.127

我不能代表所有学校，但在我的大学里，当我们在做我们课程的 SQL 模块时，他们没有教 ANSI-92，他们教的是 ANSI-89 - 那时在一个旧的 VAX 系统上！直到我开始在 Access 中挖掘，使用查询设计器构建了一些查询，然后深入研究 SQL 代码，我才接触过 ANSI-92。意识到我不知道它是如何完成连接的，也不知道我开始深入挖掘语法的含义，以便理解它。

鉴于在很多情况下可用的文档并不完全直观，并且人们倾向于坚持他们所知道的，并且在许多情况下，为了完成他们的工作，他们不会努力学习超过他们需要的东西，它是很容易看出为什么采用需要这么长时间。

当然，有些技术布道者喜欢修补和理解，而且往往是那些采用“更新”原则并试图转换其余部分的类型。

奇怪的是，在我看来，很多程序员从学校毕业就停止了进步；认为因为这是他们被教导的，所以这就是它的完成方式。直到你摘下眼罩，你才意识到学校只是为了教你基础知识，让你有足够的理解来自己学习其余的东西，而实际上你几乎没有触及到要知道的东西的表面；现在你的工作就是继续这条路。

当然，这只是我根据我的经验得出的看法。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-01-26T17:49:56.577

1) 编写 OUTER JOIN 的标准方法，与 *= 或 (+)=

2) 自然加入

3) 依赖于数据库引擎，ANSI-92 趋于更优。

4）手动优化：

假设我们有下一个语法（ANSI-89）：

```
(1)select * from TABLE_OFFICES to,BIG_TABLE_USERS btu
where to.iduser=tbu.iduser and to.idoffice=1 
```

它可以写成：

```
(2)select * from TABLE_OFFICES to
inner join BIG_TABLE_USERS btu on to.iduser=tbu.iduser
where to.idoffice=1 
```

但也作为：

```
(3)select * from TABLE_OFFICES to
inner join BIG_TABLE_USERS btu on to.iduser=tbu.iduser and to.idoffice=1 
```

它们 (1),(2),(3) 都返回相同的结果，但是它们的优化方式不同，这取决于数据库引擎，但它们中的大多数都这样做：

*   (1)它由数据库引擎决定优化。
*   (2) 它加入两个表，然后对每个办公室进行过滤。
*   (3) 它使用 idoffice 过滤 BIG_TABLE_USERS，然后加入两个表。

5）更长的查询不那么混乱。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-06-10T10:36:47.783

从我与老、年轻程序员、实习生和应届毕业生的实践经验来看，人们使用 ANSI-89 的原因：

*   他们从他们看到的现有代码（而不是书本）中学习 SQL，并从代码中学习 ANSI-89
*   ANSI-89，因为打字少
*   他们不考虑它并使用一种或另一种风格，甚至不知道两者中的哪一个被认为是新的或旧的，也不关心
*   代码也是与维护代码的下一个程序员的通信的想法不存在。他们认为他们与计算机交谈，而计算机不在乎。
*   “干净编码”的艺术是未知的
*   特别是编程语言和 SQL 知识太差，以至于他们将在其他地方找到的内容复制并粘贴在一起
*   个人喜好

我个人更喜欢 ANSI-92 并更改我在 ANSI-89 语法中看到的每个查询，有时只是为了更好地理解手头的 SQL 语句。但我意识到，与我一起工作的大多数人都没有足够的技能来为许多表编写连接。他们尽可能地编写代码，并在第一次遇到 SQL 语句时使用他们记住的内容。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-02T16:03:42.977

Oracle 根本没有很好地实现 ANSI-92。我遇到了几个问题，尤其是因为 Oracle Apps 中的数据表具有非常好的列。如果您的联接中的列数超过大约 1050 列（这在应用程序中很容易做到），那么您将得到这个完全没有逻辑意义的虚假错误：

```
ORA-01445: cannot select ROWID from a join view without a key-preserved table. 
```

重新编写查询以使用旧式连接语法使问题消失，这似乎将责任直接归咎于 ANSI-92 连接的实现。

在我遇到这个问题之前，我一直是 ASNI-92 的坚定推动者，因为它可以减少意外交叉连接的机会，这对于旧式语法来说太容易了。

然而，现在我发现坚持下去要困难得多。他们指出甲骨文的糟糕实施并说“我们会按照自己的方式做，谢谢。”

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2017-12-11T11:16:20.013

新的 SQL 标准继承了以前标准的所有内容，也就是“兼容性的枷锁”。所以“旧”/“逗号分隔”/“不合格”连接样式是完全有效的 SQL-92 语法。

现在，我认为 SQL-92`NATURAL JOIN`是您需要的唯一连接。例如，我认为它优于`inner join`因为它不会生成重复的列 -`SELECT`子句中没有更多的范围变量来消除列的歧义！但我不能指望改变每一个想法，所以我需要与将继续采用我个人认为是遗留连接样式的编码人员合作（他们甚至可能将范围变量称为“别名”！）。这是团队合作的本质，而不是在真空中运作。

对 SQL 语言的批评之一是可以使用许多语义等效的语法（一些使用关系代数，一些使用关系演算）获得相同的结果，其中选择“最佳”的只是个人风格. 所以我对“旧式”连接和`INNER`. 我是否会花时间重写它们`NATURAL`取决于上下文。

# asp.net - 我想要一个主用户控件（母版页，但用于用户控件）

> ID：334204
> 
> 赞同：5
> 
> 时间：2008-12-02T14:57:11.957
> 
> 标签：asp.net, user-controls, master-pages

ASP.NET 母版页 - 必不可少的东西。

但是，我的项目中有很多非常相似的 UserControls - 它可能是 AJAX ModalPopup 的标准布局，或者更多涉及的东西。

我希望我可以用一些 Master UserControls 摆脱我的一些重复代码（在 ascx 文件和代码隐藏中）。

有人对实现这一目标的方法有任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-23T22:09:38.833

这是一个古老的问题，但对于任何偶然发现此问题的人，我都有一个强大的解决方案。

在 app_code 中，创建一个文件并粘贴此代码：

```
namespace MasterControls
{
    // code written by alexander taylor on 2011-08-22\. http://www.alexsapps.com

    public abstract class ChildUserControl : UserControl
    {
        Control master;

        public abstract string MasterControlVirtualPath { get; }

        protected override void OnInit(EventArgs e)
        {
            master = LoadControl(MasterControlVirtualPath);
            Controls.Add(master);

            base.OnInit(e);
        }

        protected override void Render(HtmlTextWriter writer)
        {
            master.RenderControl(writer);
        }
    }
    public class ControlContentPlaceHolder : Control
    {
        protected override void Render(HtmlTextWriter writer)
        {
            ControlContent found = null;

            foreach (Control c in NamingContainer.NamingContainer.Controls)
            {
                ControlContent search;
                search = c as ControlContent;
                if (search != null && search.ControlContentPlaceHolderID.Equals(ID))
                {
                    found = search;
                    break;
                }
            }

            if (found != null)
            {                
                //write content of the ContentControl
                found.RenderControl(writer);
            }
            else
            {
                //use default content
                base.Render(writer);
            }
        }
    }
    public class ControlContent : Control
    {
        public string ControlContentPlaceHolderID { get; set; }
    }

} 
```

示例“主控”（相当于母版页）

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="MasterControl1.ascx.cs" Inherits="MasterControl1" %>
<%@ Register Namespace="MasterControls" TagPrefix="masterControls" %>

<p>content 1 below:<br />
<masterControls:ControlContentPlaceHolder ID="myContent1" runat="server">
    default content 1 here!
</masterControls:ControlContentPlaceHolder></p>

<p>content 2 below:<br />
<masterControls:ControlContentPlaceHolder ID="myContent2" runat="server">
    default content 2 here!
</masterControls:ControlContentPlaceHolder></p> 
```

示例“子控件”（相当于页面）

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="ChildControl1.ascx.cs" Inherits="Control1" %>
<%@ Register Namespace="MasterControls" TagPrefix="masterControls" %>

<masterControls:ControlContent ControlContentPlaceHolderID="myContent1" runat="server">
    custom content 1
</masterControls:ControlContent>

<masterControls:ControlContent ControlContentPlaceHolderID="myContent2" runat="server">
    custom content 2
</masterControls:ControlContent> 
```

在子控件后面的代码中

```
using MasterControls;

//you must inherit the ChildUserControl class!
public partial class Control1 : ChildUserControl
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    public override string MasterControlVirtualPath
    {
        //below, type the location to the master control
        //you wish to apply to this control
        get { return "~/MasterControl1.ascx"; }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-03T05:09:14.780

我可以建议您寻找的最接近的东西是[模板化自定义控件](http://msdn.microsoft.com/en-us/library/ms178657(VS.85).aspx)。不幸的是，如果这些东西是自定义控件，没有 ascx 文件，跨项目共享控件会容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-07T15:06:13.607

我设法使用以下代码使其工作：

```
public class MasterLoader : UserControl
{
    MasterUserControl _masterUserControl;

    protected override void CreateChildControls()
    {
        Controls.Clear();
        base.CreateChildControls();

        Controls.Add(MasterControl);
    }

    protected override void AddedControl(Control control, int index)
    {
        if (control is MasterUserControl)
            base.AddedControl(control, index);
        else
            MasterControl.ContentArea.Controls.Add(control);
    }

    private MasterUserControl MasterControl
    {
        get
        {
            if (_masterUserControl== null)
                _masterUserControl= (MasterUserControl)LoadControl("~/MasterUserControl.ascx");

            return _masterUserControl;
        }
    }
} 
```

子用户控件继承自 MasterLoader 类。主用户控件包括一个占位符控件，我将其公开为一个名为 ContentArea 的公共属性。

```
public partial class MasterUserControl: UserControl
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    public PlaceHolder ContentArea 
    {
        get
        {
            return phContent;
        }
    }
} 
```

事件绑定和视图状态按预期工作，无需对任何用户控件进行任何更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T15:00:26.397

遗产。您将基控件构建为基类，然后从它继承。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T15:04:36.700

您还可以将嵌套用户控件放置在“主”用户控件中的占位符控件上。使用接受 ascx 文件的虚拟路径的 Load 方法来加载适当的控件。

# windows - 注册表编辑器文件格式

> ID：334207
> 
> 赞同：12
> 
> 时间：2008-12-02T14:57:43.580
> 
> 标签：windows, registry, regedit

我想记录 regedit 实用程序的文件格式，以便可以将数据合并到注册表中。

从命令行，您可以（静默）合并批处理文件中的数据，如下所示：

```
regedit /s file.reg 
```

从子项导出如下：

```
regedit /e file.reg "HKEY_XX\key" 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-02T14:58:34.153

使用减号 (-) 删除键和值。

```
REGEDIT4
[-HKEY_CURRENT_USER\RemoveThisTree]
[HKEY_CURRENT_USER\RemoveValue]
"valueName"=- 
```

### 参考

*   此处提到要删除的减号：[MSKB310516：*如何使用 .reg 文件添加、修改或删除注册表子项和值*](https://support.microsoft.com/en-us/kb/310516)[（在此处](https://archive.is/PECXd)存档。）

*   减号删除，分号评论和这里提到的 IF/ENDIF：[MSDN: *Registry File (Compact 2013)*](https://msdn.microsoft.com/en-us/library/gg469889.aspx) (Archived [here](https://archive.is/n4sj6) .)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-02T15:02:43.787

记录 .reg 文件格式确实是[微软的工作](http://support.microsoft.com/kb/310516)。

# vba - 对于非软件人员，有没有推荐的 VBA 编程培训资源（例如 DVD、计算机）？

> ID：334214
> 
> 赞同：1
> 
> 时间：2008-12-02T14:59:17.053
> 
> 标签：vba

我被要求寻找培训资源，让工程师快速掌握 VBA 编程。

目标学员将具有一些系统工程经验，但几乎没有非系统编程经验。

我希望有一个基于计算机的培训课程或 DVD，我们可以购买并提供给工程师几天，让他们快速掌握基础知识。

不幸的是，我的 Google-fu 很难通过营销网站找到任何明显可信的信息。

任何关于好（或坏）资源的反馈将不胜感激。

* * *

**编辑：**工程师将在非 Office 产品中应用他们的新 VBA 技能。

虽然参考资料很有用，但我确实需要一些能够指导他们了解基础知识的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T15:04:06.530

VBA 的最佳培训程序是 Macro Recorder。选择您想了解的内容，然后在 GUI 中记录执行操作并查看生成的代码。

**编辑 [haren]：**我的首选答案是对此答案的评论（感谢 EBGreen！）：

> 确实没有任何出色的文档。有一些很好的示例网站。如果您想要结构化的教学，您最好寻找 VB6 教学材料，然后学习相对较少的差异。– EBGreen（12 月 2 日 15:18）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T15:19:00.230

在您获得优质的商业 DVD 或其他资源之前，您可以尝试 youtube 上提供的这些系列视频。

[Microsoft Excel 2007 VBA 培训课程和免费在线教程](http://in.youtube.com/watch?v=nDsAwG87Wa0)

您可以使用可用的 youtube 下载器之一来下载这些视频。您还可以在提供的推荐链接中找到其他有用的 VBA 视频。

希望您觉得这个有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-02T00:50:22.393

当心宏记录器，生成的一些代码是旧的并且不推荐使用。可从代码窗口获得的 VBA 帮助文件确实非常好，对象浏览器也非常有用。

# asp.net - 使用 sql 数据源在转发器的项目模板中绑定下拉列表

> ID：334218
> 
> 赞同：0
> 
> 时间：2008-12-02T15:00:18.363
> 
> 标签：asp.net

我们的页面存在一些性能问题，我想问一下。如果我有一个转发器，并且在转发器的 itemtemplate 中我有一个绑定到 sql 数据源的下拉列表，那么即使每次返回相同的结果，每个项目都会调用一次 selectcommand 吗？如果是这样，作为快速修复，是否将启用缓存设置为 true 并指定缓存持续时间以确保该查询在每个页面生命周期仅运行一次？我知道我应该使用对象数据源，但我现在想尝试快速解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T15:59:55.420

是的，据我所知，如果您没有将缓存设置为 true，它将为每个数据绑定调用执行查询。

就个人而言，您最好查询结果，然后在 ItemDataBound 事件中手动绑定它，而不是使用 SQL 数据源，但是，如果您当前关心的是通过当前配置缓存来解决问题，那么应该会有很大帮助！

**更新**

添加以下内容以回复评论。

Page_Load 首先在命令链中执行，您可以声明一个页面级变量来保存数据表，然后在项目数据绑定事件中您可以将其用于绑定，如果它是 CS，则类似这样。这只是一个部分示例....只是为了传达这个想法。

```
partial class MyPage
{
    private DataTable _ddlData;

    protected void Page_Load(object sender, EventArgs e)
    {
        //Logic to fill _ddlData and then bind the repeater goes here
    }

    protected void Grid_ItemDataBound() //I forgot the proper parameters here
    {
        //Properly check for e.item.itemtype = Item or Alt item
        DropDownList oList = (DropDownList)e.item.findcontrol("ddlItems"); //lookup for your item
        oList.DataSource = _ddlData;
        oList.DataBind();
    }
} 
```

# c# - 如何在c#中设置我想用作应用程序图标的ico？

> ID：334231
> 
> 赞同：3
> 
> 时间：2008-12-02T15:02:52.930
> 
> 标签：c#, icons

我在属性中设置的图标在任务栏和应用程序窗口中可见，但资源管理器中的应用程序图标不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T15:10:30.450

可能是您设置的应用程序图标具有不同图标大小的不同图像，这就是您在资源管理器中看到差异的原因吗？

要对此进行测试，请在 Visual Studio 中打开您的图标。列出了不同的分辨率（在我的屏幕左侧）。如果您不想创建所有分辨率，只需删除您不想要的分辨率，Windows 将尝试为您调整图标大小，尽管它们在另一个分辨率下会显得块状。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T15:13:12.190

好的。想我明白了：

您一直在设置 Frame 的 Icon 属性，而不是应用程序。由于框架在任务栏上有自己的条目，因此您会在那里看到正确的图标。

要为您的可执行文件获取正确的图标，请转到解决方案中的可执行项目，然后转到其属性。您将在图标的应用程序选项卡上看到一个设置（在资源下）。现在，当您在资源管理器中转到 .exe 时，它​​将具有正确的图标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T15:05:43.640

如果您使用的是 Visual Studio，这可以在应用程序属性中设置（我相信是项目菜单）。这是您设置资源、目标 .net 等的同一个地方。

# c# - 在没有全局挂钩或轮询 GetActiveWindow 的情况下获取活动窗口？

> ID：334243
> 
> 赞同：1
> 
> 时间：2008-12-02T15:04:58.510
> 
> 标签：c#, c++, windows, winapi

如何在不轮询 GetActiveWindow 或使用全局挂钩的情况下获得有关当前活动窗口是什么以及何时更改的通知？

我不喜欢轮询，而且我正在使用 C# 并且全局挂钩不起作用（大多数情况下）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T15:55:38.923

我从来没有找到一种干净的方式来获得通知。我将[GetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms633505.aspx)与计时器一起使用。:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T15:13:23.377

你不能，但你可能想尝试一下别人已经创造的东西，比如这个[产品](http://www.vbaccelerator.com/home/Vb/Code/Libraries/Hooks/vbAccelerator_Hook_Library/article.asp)。

# c# - 为什么我的 UserProperties 集合是空的？

> ID：334253
> 
> 赞同：1
> 
> 时间：2008-12-02T15:07:14.700
> 
> 标签：c#, visual-studio-2005, interop, outlook, primary-interop-assembly

我正在使用 Outlook 2003 PIA 和 VS 2005 来访问公用文件夹中的项目。尽管项目具有多个用户定义的`item.UserProperties`字段，但集合总是返回空。

如果我使用 在代码中添加属性`UserProperties.Add`，它会与项目一起正确保存，然后在下次访问项目时在 UserProperties 中可用。但是，使用`MFCMapi`访问该项目时，我看不出这个新属性与现有用户定义的属性之间没有区别。

有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T16:29:02.983

如何使用 webdav 在公共文件夹中创建项目？如果它们是使用 webdav 创建的，则无法使用 item.UserProperties 方法访问它们，因为 Outlook 使用的 blob 值未正确填充。

[检查此链接以获取详细信息。](http://www.pcreview.co.uk/forums/thread-3396626.php "在这里检查")

我正在使用自定义 .Net Extended Mapi Wrapper 来读取此属性。

但是您始终可以使用兑换，或者如果您使用的是 Outlook 2007，您可以直接访问它们。

# c# - 如何使用 XmlDocument/XmlDeclaration 添加自定义 XmlDeclaration？

> ID：334256
> 
> 赞同：8
> 
> 时间：2008-12-02T15:08:23.790
> 
> 标签：c#, .net, xml, xmldocument

我想在 c# .net 2 或 3 中使用 XmlDocument/XmlDeclaration 类时创建自定义 XmlDeclaration。

这是我想要的输出（它是第 3 方应用程序的预期输出）：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<?MyCustomNameHere attribute1="val1" attribute2="val2" ?>
[ ...more xml... ] 
```

使用 XmlDocument/XmlDeclaration 类，看来我只能使用一组定义的参数创建一个 XmlDeclaration：

```
XmlDocument doc = new XmlDocument();
XmlDeclaration declaration = doc.CreateXmlDeclaration("1.0", "ISO-8859-1", null);
doc.AppendChild(declaration); 
```

除了 XmlDocument/XmlDeclaration 之外，是否还有其他类我应该查看以创建自定义 XmlDeclaration？或者 XmlDocument/XmlDeclaration 类本身有没有办法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-02T15:19:29.197

您要创建的不是 XML 声明，而是“处理指令”。您应该使用[XmlProcessingInstruction](http://msdn.microsoft.com/en-us/library/system.xml.xmlprocessinginstruction.aspx)类，而不是[XmlDeclaration](http://msdn.microsoft.com/en-us/library/system.xml.xmldeclaration.aspx)类，例如：

```
XmlDocument doc = new XmlDocument();
XmlDeclaration declaration = doc.CreateXmlDeclaration("1.0", "ISO-8859-1", null);
doc.AppendChild(declaration);
XmlProcessingInstruction pi = doc.CreateProcessingInstruction("MyCustomNameHere", "attribute1=\"val1\" attribute2=\"val2\"");
doc.AppendChild(pi); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T15:26:04.160

您可能希望附加使用*XmlDocument的***CreateProcessingInstruction**方法创建的**XmlProcessingInstruction**。

 ***例子：

```
XmlDocument document        = new XmlDocument();
XmlDeclaration declaration  = document.CreateXmlDeclaration("1.0", "ISO-8859-1", "no");

string data = String.Format(null, "attribute1=\"{0}\" attribute2=\"{1}\"", "val1", "val2");
XmlProcessingInstruction pi = document.CreateProcessingInstruction("MyCustomNameHere", data);

document.AppendChild(declaration);
document.AppendChild(pi); 
```

# c# - RSA 加密：将代码从 js 移动到 C#

> ID：334259
> 
> 赞同：3
> 
> 时间：2008-12-02T15:10:07.297
> 
> 标签：c#, javascript, teamcity, rsa

我正在开发一个登录到 teamcity 的用户代理，我正在尝试将密码加密从 js 移动到 c#。

[这是javascript](http://teamcity.jetbrains.com/res/-4045289697674020822.js)

名为 rsa.js 和 encrypt.js 的部分很重要。他们使用

```
rsa.setPublic(publicKey,"10001"); 
```

据我所知，指数看起来像一个十六进制数 x10001，它是 65537 base10

[这是teamcity的演示站点](http://teamcity.jetbrains.com/login.html)

**注意以下账号不属于teamcity的demo站点**

此测试验证加密文本是否等于使用公钥加密的明文。

```
[Test]
public void should_be_able_to_encode_a_string() {
    string public_key = "00b46e5cd2f8671ebf2705fd9553137da082b2dd3dbfa06f254cdfeb260fb21bc2c37a882de2924d7dd4c61eb81368216dfea7df718488b000afe7120f3bbbe5b276ac7f2dd52bd28445a9be065bd19dab1f177e0acc035be4c6ccd623c1de7724356f9d6e0b703d01583ebc4467d8454a97928b5c6d0ba3f09f2f8131cc7095d9";
    string expected = "1ae1d5b745776f72172b5753665f5df65fc4baec5dd4ea17d43e11d07f10425b3e3164b0c2ba611c72559dc2b00149f4ff5a9649b1d050ca6a5e2ec5d96b787212874ab5790922528a9d7523ab4fe3a002e8f3b66cab6e935ad900805cf1a98dc6fcb5293c7f808917fd9015ba3fea1d59e533f2bdd10471732cccd87eda71b1";
    string data = "scott.cowan";
    string actual = new EncryptionHelper().Encrypt(public_key, data);
    Assert.AreEqual(expected,actual);
} 
```

到目前为止，实现看起来像

```
public string Encrypt(string public_key, string data)
{
    rsa = new RSACryptoServiceProvider(); 
    rsa.FromXmlString(String.Format("<RSAKeyValue>{0}</RSAKeyValue>",public_key));
    byte[] plainbytes = System.Text.Encoding.UTF8.GetBytes(data);
    byte[] cipherbytes = rsa.Encrypt(plainbytes,false);
    return Convert.ToBase64String(cipherbytes);
} 
```

但这抱怨

```
System.Security.Cryptography.CryptographicException
Message: Input string does not contain a valid encoding of the 'RSA' 'Modulus' parameter. 
```

谢谢您的任何帮助，这将是一个非常快乐的圣诞节

**编辑：看起来我的测试有缺陷，因为每次播种时间都会生成不同的 encryptedPassword**

**答：我打开了访客访问，绕过了这个问题，但我仍然想解决它**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T20:23:35.637

You RSAKeyValue XML is malformed, the correct format is here [http://www.w3.org/TR/xmldsig-core/#sec-RSAKeyValue](http://www.w3.org/TR/xmldsig-core/#sec-RSAKeyValue)

your function should probably look like (assuming that public_key and exponent are octet strings...)

```
public string Encrypt(string public_key,string exponent, string data)
{
    RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(); 
    rsa.FromXmlString(String.Format("<RSAKeyValue><Modulus>{0}</Modulus><Exponent>{1}</Exponent></RSAKeyValue>",public_key,exponent));
    byte[] plainbytes = System.Text.Encoding.UTF8.GetBytes(data);
    byte[] cipherbytes = rsa.Encrypt(plainbytes,false);
    return Convert.ToBase64String(cipherbytes);
} 
```

In your case your exponent is 10001.

since in your case it looks like you do not have octet strings

```
public string Encrypt(string public_keyHex,uint exp,string data)
{
    byte[] bytes = new byte[public_keyHex.Length / 2];
    for (int i = 0; i < public_keyHex.Length-1; i+=2)
    {
        bytes[i / 2] = byte.Parse(public_keyHex.Substring(i, 2),System.Globalization.NumberStyles.HexNumber);
    }
    string public_key=Convert.ToBase64String(bytes);
    return Encrypt(public_key,Convert.ToBase64String(BitConverter.GetBytes(exp)),data);
} 
```

I hope that helps, I haven't tested it yet. i will when i get home today.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-05T01:05:32.780

由于加密使用 PKCS#1 随机填充，因此生成的“encryptedPassword”*必须*始终不同。这里的关键字是“随机填充”;-)

# windows-mobile - WM6模拟器可以有存储卡吗？

> ID：334272
> 
> 赞同：4
> 
> 时间：2008-12-02T15:12:28.447
> 
> 标签：windows-mobile, emulation

目前，我们正在通过 Visual Studio 2008 使用 WM6 Professional 模拟器进行 Windows Mobile 开发。我的问题是，你能得到模拟器图像来模拟存储卡吗？我们从设备中的可移动存储卡上运行我们的 SQLCE 3.5 数据库，让模拟器也模拟这种情况会很巧妙。我们查看了模拟器配置设置并没有遇到此选项。

我们将移动设备放在桌面上，所以我们总是可以直接部署到它们来解决这个问题，但我认为无论如何都值得对小组进行投票。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-02T15:23:41.217

是的，可以为模拟器设置存储卡。

在模拟器窗口中，转到文件/配置。在常规选项卡上有共享文件夹的设置。您可以将其指向主机上的目录。该目录将显示为 em 上的存储线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-03T04:48:52.573

如前所述，是的，存储卡是模拟的。认为在发布之前始终在真实的硬件设备上进行测试是件好事。我发现有时模拟器上的存储卡与硬件访问不是 100% 一致的。实际上，模拟器在这方面可能有点问题。

例如，我在 PDA 应用程序中广泛使用 SQLITE。有时我无法让模拟器创建一个新的数据库文件，即使相同的代码在设备上完美运行。

要点：它非常适合测试，但偶尔会失败，如果某些代码没有执行你认为应该的......在硬件设备上运行它，然后在模拟器上浪费数小时进行故障排除。

# c++ - 了解dll依赖

> ID：334277
> 
> 赞同：2
> 
> 时间：2008-12-02T15:13:51.597
> 
> 标签：c++, dll

我正在 Visual Studio 2008 中构建一个 C++ DLL。

出于某种原因，即使我在发布模式下构建，我的 dll 仍然依赖于 msvcr90d.dll。我可以看到使用depends.exe

有没有办法找出导致这种依赖的原因？我的运行时库设置是 /MD

谢谢，丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T16:03:47.407

在项目属性中转到`"Configuration Properties"/Linker/General`面板。`"Show Progress"`将属性更改为`"Display All Progress Messages (/VERBOSE)"`。

链接器现在将准确地告诉您它为什么要拉入`msvcr90d.dll`

如果您从命令行构建，请使用`/VERBOSE`链接器选项（显然）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T16:55:43.980

可能是一个非常愚蠢的答案..但是没有探索depends.exe中显示的树结构显示哪个dll导致msvcr90d.dll链接？

# xml - 命名空间和特定的 xpath

> ID：334279
> 
> 赞同：2
> 
> 时间：2008-12-02T15:14:41.970
> 
> 标签：xml, xpath, nant, xmlpoke

谁能告诉我如何从该文件中获取名称属性的 xpath：

```
<asmv1:assembly xmlns:asmv1="urn:schemas-microsoft-com:asm.v1">
  <assemblyIdentity name="MyName"/>
</asmv1:assembly> 
```

我正在尝试为 nant xmlpoke 任务获取它，但没有成功。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T15:26:34.143

这应该可以解决问题：

```
//asmv1:assembly/asmv1:assemblyIdentity/@name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T15:26:19.747

试试这个 XPath

```
/*[local-name()='assembly']/assemblyIdentity/@name 
```

# mysql - MySQL - 如何仅使用当前用户的进程显示 PROCESSLIST？

> ID：334280
> 
> 赞同：14
> 
> 时间：2008-12-02T15:14:51.797
> 
> 标签：mysql

MySQL 5 中有没有办法只显示当前用户的进程（查询）？

用户拥有`PROCESS`权限，因此`SHOW PROCESSLIST`显示所有用户的运行进程。根据文档，`SHOW PROCESSLIST`不允许任何类型的`WHERE`语法，我也没有设法将其变成子查询。

当然，我可以简单地发送查询，例如在 PHP 脚本中，然后循环检查结果，丢弃不属于我的所有内容，但这似乎效率很低。更改用户权限是不可行的。

还有其他方法吗？提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-02T15:26:55.313

如果您使用 MySQL 5.1.7 或更新版本，则可以使用 INFORMATION_SCHEMA 中的[PROCESSLIST](http://dev.mysql.com/doc/refman/5.1/en/processlist-table.html)表。因此，您可以使用普通查询对其进行查询，并在子句`SELECT`中应用过滤条件。`WHERE`

这个特性在 MySQL 5.0 和之前的版本中没有实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-03T05:52:34.990

如果用户没有`PROCESS`，则`SHOW PROCESSLIST`只会显示自己的线程。

# c++ - Symbian C++ - 描述符上的子字符串操作

> ID：334292
> 
> 赞同：2
> 
> 时间：2008-12-02T15:19:40.133
> 
> 标签：c++, symbian, substring, s60

操作 TDesC 字符串的首选/最简单方法是什么，例如获取子字符串。

我会给你一个我的场景的例子。

```
RBuf16 buf;
...
CEikLabel label;
...
label->SetTextL(buf); // (SetTextL takes a const TDesC&) 
```

我想从 buf 中获取一个子字符串。那么我是否想直接操作 RBuf16，如果是，最好的方法是什么？

有没有办法转换为 const char* 所以我可以使用标准的 C 字符串操作。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T15:42:43.130

阅读 descriptors.blogspot.com（加载后向下滚动）。

您可以使用 TDes::LeftTPtr、TDes::RightTPtr 或 TDes::MidTPtr，它们将为您提供一个子字符串作为 TPtr（即操作原始数据的描述符）。

如果要创建子字符串的副本，可以使用 TDes::Copy 函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T15:45:40.440

最好与否，我无法评论，但我使用以下方法从描述符中提取子字符串：

```
TDes::LeftTPtr()
TDes::MidTPtr()
TDes::RightTPtr() 
```

或者

```
TDesC::Left()
TDesC::Mid()
TDesC::Right() 
```

两组的区别在于前者返回一个新的可修改描述符，后者返回一个新的不可修改描述符，包含子字符串。

当您在 Symbian 平台上进行开发时，我强烈建议您遵循 Symbian 约定，不要一直从标准 C 或 C++ 的角度来考虑 Symbian C++。使用 Symbian 专门提供的库，而不是 Symbian 可能直接支持或不支持的标准 C/C++ 库。由于在 Symbian 上开发的应用程序的最终目标是在应用程序的可靠性和稳健性最重要的移动设备上运行，因此您应该坚持 Symbian 的偏好和建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T15:45:40.457

如果您想要来自 RBuf16 的子字符串，这很简单——只需使用`TDes16::MidTPtr`

您可以通过执行以下操作转换 const char*：

```
TPtr8 narrowBuf;

// Create a buffer with enough space to store every character, plus one for 
// a null terminator
narrowBuf.AllocL( buf.Length() + 1);

// TPtr8::Copy accepts a TDesC16 
narrowBuf.Copy( buf );

// Append a null terminator and return a pointer to the resultant data
const char* ptr = (const char*)narrowBuf.PtrZ(); 
```

但是，您现在拥有的是原始数据的缩小副本。如果您现在想再次设置标签，则需要在使用前将其加宽 (TDes16::Copy(const TDesC8&))。试图使 Symbian 看起来像带有 char* 和 wchar_t* 的“普通”C++ 并没有真正起作用——描述符的使用在操作系统中过于根深蒂固。

# java - 可以持久保存收集到的信息的 JMX 客户端

> ID：334298
> 
> 赞同：1
> 
> 时间：2008-12-02T15:23:33.947
> 
> 标签：java, performance, jmx

我们已经向我们的应用程序添加了性能度量，并正在使用 JMX 公开它们。现在我们想在文件或数据库中收集和存储性能数据以供分析。

有谁知道可以保存收集到的信息的 JMX 客户端、开源或商业客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T23:26:33.673

[JRockit Mission Control](http://www.oracle.com/technology/products/jrockit/missioncontrol/index.html)可以将 JMX 数据保存到日志旋转的 XML 文件中，您可以在 gui 中打开和查看这些文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T15:28:53.937

您可以将日志记录功能附加到 jconsole 本身并记录 mbean 输出等。

# c# - DataGridView SelectLine 颜色为无？

> ID：334301
> 
> 赞同：2
> 
> 时间：2008-12-02T15:24:42.323
> 
> 标签：c#, winforms, datagridview

网格正确显示所有信息，在事件 dataGridView1cellFormatting 中，我根据行值下的对象更改背景色。这也有效。我在网格上的最后一个事件是 dataGridView1_CellPainting 检查它是否是添加图标的标题。

一切都很好，直到我尝试取出所选行的颜色（或它做同样事情的单元格）。我想要的是取出所选线条的颜色。我尝试将其设置为“透明”，但是当控件绑定数据时，该行是灰色的，并且当我们调整列大小时，文本不可读。

如何在不突出显示所选行的情况下显示 DataGridView 内的数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T15:31:40.670

您可以将`SelectionForeColor`and`SelectionBackColor`属性设置为您想要更改突出显示颜色的任何颜色。这可以`DefaultCellStyle`在 DataGridView 的属性上设置，也可以在单个单元格本身上设置。This way the colors will not change when the row is selected.

```
Private Sub dgv_CellFormatting(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellFormattingEventArgs) Handles dgv.CellFormatting
    If e.RowIndex < 0 Then Exit Sub

    If e.RowIndex Mod 2 = 0 Then
        e.CellStyle.BackColor = Color.Orange
    Else
        e.CellStyle.BackColor = Color.Red
    End If

    'Make the selected cell the same color
    e.CellStyle.SelectionBackColor = e.CellStyle.BackColor
    e.CellStyle.SelectionForeColor = e.CellStyle.ForeColor
End Sub 
```

# delphi - 用delphi播放mp3

> ID：334302
> 
> 赞同：12
> 
> 时间：2008-12-02T15:24:56.770
> 
> 标签：delphi, audio, mp3

使用哪个组件来播放流/文件中的 mp3 文件，并知道该 mp3 流的长度（以秒为单位）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T16:25:29.987

您可以使用低音音频库。

[http://www.un4seen.com/](http://www.un4seen.com/)

在 3D Buzz 网站上搜索“MP3”。他们有一系列视频教程，引导您使用这个库在 Delphi 中创建自己的 MP3 播放器。需要免费会员。

[http://www.3dbuzz.com](http://www.3dbuzz.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-03T11:14:32.000

试试[DSPack](http://www.progdigy.com/?page_id=4)，它是一组组件来编写多媒体应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-03T19:56:33.040

您还可以使用[www.mitov.com](http://www.mitov.com)上的组件，该组件具有可以处理此类文件的音频套件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-15T21:34:07.640

我使用[NewAc](http://symmetrica.net/newac/)组件进行音频转换和过滤，它可以播放 MP3 和其他几种格式。

# java - 如何在 JTable 中返回实际的单元格组件边界？

> ID：334305
> 
> 赞同：1
> 
> 时间：2008-12-02T15:25:37.390
> 
> 标签：java, swing, jtable

我在 a 中有一个自定义渲染器来为s`JTable`显示`JCheckbox`es 。`boolean`但是，这会导致一个小问题，因为当用户单击表格单元格而不是复选框时，复选框仍处于选中状态。

有没有办法可以返回`JCheckbox`由特定点呈现的实际边界，`JTable`以便确定点击是否在边界内`JCheckbox`？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T15:29:53.793

更改复选框的状态是编辑器的责任，而不是渲染器。如果使用[`DefaultCellEditor`](http://java.sun.com/javase/6/docs/api/javax/swing/DefaultCellEditor.html)，则无需编写自己的代码。

我可能错了，但我认为这是任何类型为`Boolean.class`（由 确定`TableModel`）的列的默认行为。因此您不需要编写任何渲染/编辑代码，只需确保您的模型返回正确的列类型，并且该列将呈现为复选框并使用复选框进行编辑。

**编辑：**也许我对你的要求感到困惑。看到 Paul 对这个问题的评论后，我必须同意，如果您单击表格单元格中的任何位置，则*应该切换复选框。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T19:10:48.450

如果您将`JCheckBox`用作从 返回的组件`TableCellEditor`，那么它将被拉伸以适合或其他东西（它似乎没有被指定）。所以，显而易见的事情就是把它放在 a`JPanel`中，让它被拉伸，留下如何分配空间给`LayoutManager`你选择的 a 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T15:38:52.060

实际上，我今天下午刚刚做了类似的事情。

这是我的把戏，对于`JTree`. 我的复选框在最右边或最右边。

```
public void mouseClicked(MouseEvent e) {

int x = e.getX();
int y = e.getY();
int row = getRowForLocation(x, y);

Rectangle rect = getRowBounds(row);
Rectangle rect2 = new Rectangle(rect.x, rect.y, rect.height + 2, rect.height);
if (rect2.contains(x, y)) ....  // The click is on the checkbox 
```

# asp.net - 在 .NET 中“重新引发”自定义事件（在本例中为 ASP.NET）

> ID：334317
> 
> 赞同：3
> 
> 时间：2008-12-02T15:27:56.233
> 
> 标签：asp.net, vb.net, events

我正在使用 VB.NET 处理 ASP.NET 页面，并且我有这个层次结构：

页面 A
  - Web 用户控件 1
    - Web 用户控件 A
    - Web 用户控件 B
    - Web 用户控件 C

我需要从 Web 用户控件 B 引发页面 A 将收到的事件（事件流将是 Web 用户控件 B -> Web 用户控件 1 -> 页面 A）。

到目前为止，我唯一的方法是：1）向 Web 用户控件 B 和 Web 用户控件 1 添加自定义事件声明，然后简单地 RaiseEvent 两次，直到它到达页面 A（这看起来很难看，我不是特别喜欢它） .

我的另一个想法是创建一个自定义事件类，该类继承自一些神奇的事件基类，并在 Web 用户控件 B 和 Web 用户控件 1 中创建它的实例，但这证明是徒劳的，因为我找不到任何事件库类（也许 b/c 它们不是，因为它似乎是一个关键字，而不是类名）。

任何帮助，将不胜感激！感谢和快乐的编码！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T17:38:26.623

您可以使用[BubbleEvent](http://msdn.microsoft.com/en-us/library/system.web.ui.control.raisebubbleevent.aspx) [概念](http://msdn.microsoft.com/en-us/library/system.web.ui.control.onbubbleevent.aspx)来执行此操作。一个 BubbleEvent 沿着控制层次上升，直到有人处理它。GridView 和Repeater 控件通过它们的Row/ItemCommand 事件来执行此操作。

您可以将其实现为 WebUserControl1，将其转换为页面的标准事件（就像 GridView 一样）：

```
Class UserControl1 ' Parent
   Protected Override Function OnBubbleEvent(sender as Object, e as EventArgs) as Boolean
       Dim c as CommandEventArgs = TryCast(e, CommandEventArgs)
       If c IsNot Nothing Then
           RaiseEvent ItemEvent(sender, c)
           Return True ' Cancel the bubbling, so it doesn't go up any further in the hierarchy
       End If
       Return False ' Couldn't handle, so let it bubble
   End Function

   Public Event ItemEvent as EventHandler(Of CommandEventArgs)
End Class

Class UserControlB ' Child
    Protected Sub OnClicked(e as EventArgs)
        ' Raise a direct event for any handlers attached directly
        RaiseEvent Clicked(Me, e)
        ' And raise a bubble event for parent control
        RaiseBubbleEvent(Me, New CommandEventArgs("Clicked", Nothing))
    End Sub

    Protected Sub OnMoved(e as EventArgs)
        ' Raise a direct event for any handlers attached directly
        RaiseEvent Moved(Me, e)
        ' And raise a bubble event for parent control
        RaiseBubbleEvent(Me, New CommandEventArgs("Moved", Nothing))
    End Sub
End Class

Class PageA
    Sub UserControl1_ItemEvent(sender as Object, e as CommandEventArgs) Handles UserControl1.ItemEvent
        Response.Write(sender.GetType().Name & " was " & e.CommandName)
    End Sub
End Class 
```

或者，直接在页面中进行。UserControlB (Child) 和上面一样，UserControl1 (Parent) 不需要做任何特殊的事情——OnBubbleEvent 默认返回 False，所以事件冒泡了：

```
Class PageA
   Protected Override Function OnBubbleEvent(sender as Object, e as EventArgs) as Boolean
       If sender Is UserControlB Then
           Dim c as CommandEventArgs = TryCast(e, CommandEventArgs)
           If c IsNot Nothing Then
               Response.Write(sender.GetType().Name & " was " & c.CommandName)
           Else
               Response.Write(sender.GetType().Name & " raised an event, with " & e.GetType().Name & " args)
           End If
           Return True ' Cancel the bubbling, so it doesn't go up any further in the hierarchy
       End If
       Return False ' Not handled
   End Function
End Class 
```

如果您的初始事件来自服务器控件（如 Button.Click），那么它将被编码为已经引发气泡事件 - 因此 UserControlB（Child）也不需要做任何事情来将其传递给父级。您只需为任何自定义事件调用 RaiseBubbleEvent，或者如果您想以某种方式转换 EventArgs。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T15:57:16.767

这里真正的问题是 Web UserControl B 中的实际操作应该通知两者，或者，WebUserControl1 是否在通知页面之前负责一些处理。

如果链条的每一步都有特定的动作，那么你提出两个事件的方法是正确的。如果它是以事件只需要通知每个人的方式，您将希望查看不同的订阅方法进行通信。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T16:59:07.563

创建一个被所有东西引用的程序集（或命名空间）。使用您需要的方法创建一个接口。创建一个管理实现接口的对象的类。

让页面 A 实现接口 让页面 A 在第 3 步中完成的管理器类中注册自身 现在 Web UserControl B 可以通过从管理器中检索页面并在引发您需要的事件的接口上调用方法来引发事件。

您避免将页面紧密耦合到 web 控件，因为您使用的是接口。

您可能会发现项目的不同区域会有多个界面。例如，在我的 CAM 项目中，我有一个用于设置参数 UI、形状输入 UI 和剪切输入 UI 的界面。在我们的网站上，我们有使用不同界面的不同产品类别。（软件、机械、服务等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T15:59:52.797

您可以创建一个`Page A`从其中调用的公共方法，`Web User Control B`而不是在整个控件树中引发事件。

这不是我的首选，因为这会导致这些类之间的紧密耦合，但我希望它可以解决您的问题。

示例页面：

```
Public Partial Class TestPage
    Inherits Page

    Public Sub PerformAction()
        'Whatever needs to be done on Page A
    End Sub
End Class 
```

示例用户控件：

```
Public Partial Class TestControl
    Inherits UserControl

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        'This will call the Page, obviously this will only
        'work when the control is on TestPage
        CType(Page, TestPage).PerformAction()
    End Sub
End Class 
```

# exception-handling - 将所有内容包装在 try/catch 块中是否构成防御性编程？

> ID：334319
> 
> 赞同：33
> 
> 时间：2008-12-02T15:28:50.660
> 
> 标签：exception-handling, defensive-programming

在过去的 3 年里，我一直在编程。当我编程时，我习惯于处理所有已知的异常并优雅地提醒用户。我最近看到了一些代码，其中几乎所有方法都包含在 try/catch 块中。作者说它是防御性编程的一部分。我想知道，这真的是防御性编程吗？您是否建议将所有代码放在 try 块中？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-12-02T15:31:47.770

我的基本规则是：除非你能**解决**导致异常的问题，否则不要抓住它，让它冒泡到可以处理的水平。

根据我的经验，95% 的 catch 块要么只是忽略异常 ( `catch {}`)，要么只是记录错误并重新抛出异常。后者可能看起来是正确的做法，但实际上，当在每个级别都这样做时，您最终只会让您的日志杂乱无章地出现五个相同错误消息的副本。通常这些应用程序在最顶层有一个“忽略捕获”（因为“我们在所有较低级别都有尝试/捕获”），导致应用程序非常慢，有很多错过的异常，以及一个太长的错误日志任何人都愿意看透它。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-02T16:55:14.870

Try...Catch 的广泛使用不是防御性编程，它只是**将尸体钉在一个直立的位置**。

Try...Final 可广泛用于面对意外异常时的恢复。只有当您期望出现异常并且现在如何处理它时，您才应该使用 Try..Catch 代替。

有时我会看到 Try..Catch System.Exception，其中 catch 块只记录异常并重新抛出。这种方法至少存在 3 个问题：

*   Rethrow 假定一个未处理的异常，因此程序应该终止，因为它处于未知状态。但是 catch 会导致 Catch 块下面的 finally 块运行。在未定义的情况下，这些 finally 块中的代码可能会使问题变得更糟。
*   那些 finally 块中的代码将改变程序状态。因此，最初抛出异常时，任何日志记录都不会捕获实际的程序状态。而且由于状态发生了变化，调查会更加困难。
*   它给您带来了痛苦的调试体验，因为调试器在重新抛出时停止，而不是在原始抛出时停止。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-02T15:50:12.070

不，这不是“防御性编程”。你的同事正试图通过使用流行词来为他的坏习惯合理化一个好习惯。

他的所作所为应该被称为“扫地出门”。这就像统一地`(void)`从方法调用中获取错误状态返回值。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-02T15:39:40.327

术语“防御性编程”代表以这样一种方式编写代码，即它可以从错误情况中恢复或完全避免错误情况。例如：

```
private String name;

public void setName(String name) {
} 
```

你如何处理name == null？你抛出异常还是接受它？如果没有名称的对象没有意义，那么您应该抛出异常。那么名称==“”呢？

但是……以后你写一个编辑器。在设置 UI 时，您会发现在某些情况下，用户可以决定取消名称，或者在用户编辑名称时名称可能变为空。

另一个例子：

```
public boolean isXXX (String s) {
} 
```

在这里，防御策略通常是在 s == null 时返回 false（尽可能避免 NPE）。

或者：

```
public String getName() {
} 
```

如果 name == null ，防御性程序员可能会返回 "" 以避免调用代码时出现 NPE。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-02T15:45:26.853

如果您要处理随机异常，请仅在一个地方处理它们 - 应用程序的最顶部，目的是：

*   向用户呈现友好的消息，以及
*   保存诊断。

对于其他所有事情，您都希望尽可能立即发生特定于位置的崩溃，以便尽早捕获这些事情 - 否则异常处理将成为隐藏草率设计和代码的一种方式。

在异常是可预测的大多数情况下，可以提前测试异常处理程序将捕获的条件。

一般来说，If...Else 比 Try...Catch 要好得多。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-12-02T15:34:07.857

捕获随机异常是不好的。然后怎样呢？

*   别理他们？出色的。让我知道这对他们有什么作用。
*   记录它们并继续运行？我想不是。
*   作为崩溃的一部分抛出不同的异常？祝你调试好运。

捕获您实际上可以做一些有意义的事情的异常是很好的。这些案例很容易识别和维护。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-02T15:41:19.560

我可以在这里顺便说一句，每次我的一个同事写一个带有“抛出异常”的方法签名而不是列出该方法真正抛出的异常类型时，我想过去并把它们射在头上？问题是，过了一段时间，你得到了 14 个级别的调用，所有这些调用都说“抛出异常”，因此重构以使它们声明它们真正抛出的内容是一项重大练习。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-12-02T15:32:01.480

有“太多”处理这样的事情，并且捕获所有异常有点失败。特别是对于 C++，catch(...) 语句确实捕获了所有异常，但您无法处理该异常的内容，因为您不知道异常的类型（它可能是任何东西）。

您应该捕获可以完全或部分处理的异常，重新抛出部分异常。您不应该捕获任何您无法处理的异常，因为这只会混淆以后可能（或者更确切地说，将会）咬到您的错误。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-02T15:33:39.263

我建议反对这种做法。当您知道可以抛出的异常类型时，将代码放入 try-catch 块中是一回事。正如您所说，它允许您优雅地恢复和/或提醒用户注意错误。但是，将所有代码放在您不知道可能发生什么错误的块中是使用异常来控制程序流，这是一个很大的禁忌。

如果您正在编写结构良好的代码，您将了解可能发生的每个异常，并且可以专门捕获这些异常。如果您不知道如何抛出特定异常，请不要捕获它，以防万一。当它发生时，您可以找出异常、导致它的原因，然后捕获它。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-02T20:29:16.763

在 C++ 中，编写大量 try/catch 块的一个原因是为了获取引发异常的位置的堆栈跟踪。你所做的是到处写一个 try/catch，并且（假设你不在正确的位置来处理异常）让 catch 记录一些跟踪信息，然后重新抛出异常。这样，如果一个异常一直冒泡并导致程序终止，您将获得所有开始出错的完整堆栈跟踪（如果您不这样做，那么未处理的 C++ 异常将有助于解开堆栈并消除您弄清楚它来自哪里的任何可能性）。

我想在任何具有更好异常处理的语言中（即未捕获的异常会告诉您它们来自哪里），您只想捕获异常，如果您可以对它们做点什么。否则，你只是让你的程序难以阅读。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-02T15:32:45.350

我想真正的答案是“这取决于”。如果 try-catch 块捕获非常通用的异常，那么我会说它是防御性编程，就像从不开车离开你的社区就是防御性驾驶一样。try-catch (imo) 应该针对特定的异常进行定制。

同样，这只是我的观点，但我对防御性编程的概念是你需要更少/更小的 try-catch 块而不是更多/更大的块。您的代码应该尽其所能确保从一开始就永远不会存在异常条件。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-02T20:07:33.873

我发现“try”“catch”块非常有用，尤其是在使用任何实时（例如访问数据库）时。

太多？旁观者之眼。

我发现将日志复制到 Word 并使用“find”进行搜索——如果日志阅读器没有将“find”或“search”作为其包含的工具的一部分——是一种简单但极好的方式来通过详细的日志。

从这个词的普通意义上来说，它当然看起来是“防御性的”。

根据经验，我发现无论你的经理、团队领导或同事做什么，我都可以追随。如果您只是为自己编程，请使用它们直到代码“稳定”或在调试版本中，然后在完成后将其删除。

# javascript - 如何使用预加载器和多个图像显示加载状态？

> ID：334325
> 
> 赞同：2
> 
> 时间：2008-12-02T15:30:04.747
> 
> 标签：javascript, html, prototypejs

我正在构建一个包含几百张图片的幻灯片，并希望构建一个漂亮的加载栏，所以我的想法是使用 JavaScript 预加载图片，然后初始化 UI 的其余部分。

预加载图像不是问题，但让浏览器在加载时更新状态。我已经尝试了一些事情，但浏览器只会在完成后重新绘制显示。

我什至尝试过[这个问题](https://stackoverflow.com/questions/280049/javascript-callback-for-knowing-when-an-image-is-loading#280087)的脚本，但我得到了相同的结果。

这是我到目前为止所得到的（imgList 是一个文件名数组。我正在使用[Prototype](http://prototypejs.org)。）

```
var imageBuf = []
var loadCount = 0
$('loadStatus').update("0/"+imgList.length)

function init() {
    imgList.each(function(element){
        imageBuf[element] = new Image()
        //imageBuf[element].onload = window.setTimeout("count()",0) // gives "not implemented" error in IE
        imageBuf[element].onload = function(){count()}
        imageBuf[element].src = "thumbs/"+element
    })
}

function count() {
    loadCount++
    $('loadStatus').update(loadCount+"/"+imgList.length)
}

init() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T15:54:43.153

尝试使用[**我对这个问题的回答中**](https://stackoverflow.com/questions/210821/#210994)的函数：

```
function incrementallyProcess(workerCallback, data, chunkSize, timeout, completionCallback) {
  var itemIndex = 0;
  (function() {
    var remainingDataLength = (data.length - itemIndex);
    var currentChunkSize = (remainingDataLength >= chunkSize) ? chunkSize : remainingDataLength;
    if(itemIndex < data.length) {
      while(currentChunkSize--) {
        workerCallback(data[itemIndex++]);
      }
      setTimeout(arguments.callee, timeout);
    } else if(completionCallback) {
      completionCallback();
    }
  })();
}

// here we are using the above function to take 
// a short break every time we load an image
function init() {
  incrementallyProcess(function(element) {
    imageBuf[element] = new Image();
    imageBuf[element].onload = function(){count()};
    imageBuf[element].src = "thumbs/"+element;
  }, imgList, 1, 250, function() { 
    alert("done loading"); 
  });
} 
```

You may want to modify the chunk size parameter as well as the length of the timeout to get it to behave just like you want it to. I am not 100% sure this will work for you, but it is worth a try...

# c# - 什么是编程中的托管或非托管代码？

> ID：334326
> 
> 赞同：170
> 
> 时间：2008-12-02T15:31:37.443
> 
> 标签：c#, .net, unmanaged, definition, managed

我在我的 C# 代码中使用了一个特定的命令，效果很好。但是，据说它在“非托管”代码中行为不端。

什么是托管或非托管代码？

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2008-12-02T15:39:10.250

[这](http://www.developer.com/net/cplus/article.php/2197621/Managed-Unmanaged-Native-What-Kind-of-Code-Is-This.htm)是一篇关于这个主题的好文章。

总结一下，

1.  **托管代码**不会编译为机器代码，而是编译为一种中间语言，该语言由机器上的某些服务解释和执行，因此在（希望如此！）安全框架内运行，该框架为您处理内存和线程等危险事物。在现代用法中，这通常意味着 .NET，但并非必须如此。

> 在安装在同一台机器上的运行时引擎中执行的应用程序。没有它，应用程序将无法运行。运行时环境提供程序使用的通用软件例程库，并且通常执行内存管理。它还可以提供从源代码到可执行代码或从中间语言到可执行代码的即时 (JIT) 转换。Java、Visual Basic 和 .NET 的公共语言运行时 (CLR) 是运行时引擎的示例。（[阅读更多](https://web.archive.org/web/20080804071505/http://www.pcmag.com/encyclopedia_term/0,2542,t=managed+code&i=46560,00.asp)）

2.  **非托管代码**被编译为机器代码，因此由操作系统直接执行。因此，它有能力做托管代码没有的破坏性/强大的事情。这就是过去一切的工作方式，因此通常它与 .dll 之类的旧东西相关联。

> 自行运行的可执行程序。该程序从操作系统启动，调用和使用操作系统中的软件例程，但不需要使用另一个软件系统。已汇编成机器语言的汇编语言程序和针对特定平台编译成机器语言的 C/C++ 程序是非托管代码的示例。（[阅读更多](https://web.archive.org/web/20100227034155/http://www.pcmag.com/encyclopedia_term/0,2542,t=unmanaged+code&i=53477,00.asp)）

3.  **本机**代码通常是非托管的同义词，但并不完全相同。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2008-12-02T15:32:34.290

[这是来自 MSDN 的一些关于非托管代码](http://msdn.microsoft.com/en-us/library/0e91td57.aspx)的文本。

> 一些库代码需要调用非托管代码（例如，本机代码 API，如 Win32）。因为这意味着要超出托管代码的安全边界，所以需要格外小心。

以下是有关托管代码的其他一些补充说明：

*   由 CLR 执行的代码。
*   面向公共语言运行时（.NET Framework 的基础）的代码称为托管代码。
*   托管代码提供 CLR 所需的元数据，以提供诸如内存管理、跨语言集成、代码访问安全和对象的自动生命周期控制等服务。所有基于 IL 的代码都作为托管代码执行。
*   在 CLI 执行环境下执行的代码。

对于您的问题：

我认为这是因为 NUnit 为 UnitTesting 执行您的代码，并且可能有一部分是非托管的。但我不确定，所以不要把它当作黄金。我相信有人可以给你更多关于它的信息。希望能帮助到你！

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2011-09-04T06:57:34.467

当您想到**unmanaged**时，请考虑特定于机器的机器级代码。就像 x86 汇编语言一样。非托管（本机）代码被编译和链接以直接在其设计的处理器上运行，目前不包括所有操作系统内容。它不是便携式的，但速度很快。非常简单，精简的代码。

**托管**代码是从 Java 到旧的 Interpretive BASIC 的所有内容，或者在 .NET 下运行的任何内容。托管代码通常被编译为中间级别的 P 代码或字节代码指令集。这些不是特定于机器的指令，尽管它们看起来类似于汇编语言。托管代码将程序与运行它的机器隔离开来，并创建一个安全边界，其中所有内存都是间接分配的，一般来说，您无法直接访问机器资源，如端口、内存地址空间、堆栈等. 这个想法是在更安全的环境中运行。

例如，要将托管变量转换为非托管变量，您必须获得实际对象本身。它可能被包裹或装在一些额外的包装中。非托管变量（比如'int'）——在 32 位机器上——正好占用 4 个字节。没有开销或额外的包装。从托管代码到非托管代码——然后再返回——的过程称为“**编组**”。它允许您的程序跨越边界。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-12-02T15:42:11.743

用尽可能少的词：

*   托管代码 = .NET 程序
*   非托管代码=“正常”程序

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-12-22T09:04:10.747

**托管**代码是 C#.Net、VB.Net、F#.Net 等编译器创建的。它在 CLR 上运行，其中包括提供垃圾收集、引用检查等服务。**所以可以把它想象成，我的代码是由 CLR 管理的。**

另一方面，**非托管**代码直接编译为机器代码。它不由 CLR 管理。

![](https://i.imgur.com/uuWbVAb.png)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-02T15:36:52.610

基本上非托管代码是不在 .NET CLR 下运行的代码（也不是 VB.NET、C# 等）。我的猜测是 NUnit 有一个不是 .NET 代码（又名 C++）的运行器/包装器。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-05-28T19:43:27.037

> 托管代码：
> 根据与公共语言运行时的“合作合同”运行的代码。托管代码必须提供运行时所需的元数据，以提供诸如内存管理、跨语言集成、代码访问安全性和对象的自动生命周期控制等服务。所有基于 Microsoft 中间语言 (MSIL) 的代码都作为托管代码执行。
> 
> 非托管代码：
> 在不考虑公共语言运行时的约定和要求的情况下创建的代码。非托管代码在公共语言运行时环境中以最少的服务执行（例如，没有垃圾收集、有限的调试等）。

参考： http: [//www.dotnetspider.com/forum/11612-difference-between-managed-and-unmanaged-code.aspx](http://www.dotnetspider.com/forum/11612-difference-between-managed-and-unmanaged-code.aspx)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-02T15:40:26.487

NUnit 在单独的 AppDomain 中加载单元测试，我假设入口点没有被调用（可能不需要），因此入口程序集为空。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-10-09T06:09:37.557

托管代码在 CLR 环境中运行，即 .NET 运行时。简而言之，所有 IL 都是托管代码。但是如果您使用一些第三方软件示例 VB6 或 VC++ 组件，它们是非托管代码，因为 .NET 运行时 (CLR) 没有控制权在语言的源代码执行上。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-12-19T02:01:10.300

*   **托管**代码：使用 .NET 语言（如 C#、VB.NET）编写的代码。
*   **UnManaged** Code：非.NET语言编写的代码，MSIL不理解它是什么，不能在CLR下运行；就像我们在 .NET 应用程序中使用的第三方控件，它们不是用 .NET 语言创建的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-07-24T14:46:38.460

托管代码：- MSIL（中间语言）形式的代码是在语言编译器编译后开发的，并由`CLR`调用的托管代码直接执行。例如：- .net 框架支持的所有 61 种语言代码

非托管代码：- 之前开发`.net`的 MSIL 表单不可用且`CLR`直接执行的`CLR`代码将重定向到操作系统，这称为非托管代码。

eg:-COM,Win32 APIs

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-08-24T06:08:01.057

首先要明白这一点，之前`.NET framework`，`Microsoft`都是提供单机产品之类的`MFC (Visual C++), VB, FoxPro`。

2002年，微软结合其产品，制作了.NET框架。现在，之前代码的执行方式与 .NET 框架中代码的管理和执行方式之间存在差异。Microsoft 引入了`CLR`with .NET 框架的概念，它编译来自任何受支持的 .NET 框架语言的代码，并提供诸如此类的附加功能`memory mangement, garbage collection`。但是，此类 CLR 功能以前无法直接使用。

> 因此，如果您在 .NET 框架（使用 CLR 编译）中创建库/代码，则称为`Managed code`. 您可以在其他 .NET 应用程序/项目中进一步使用此库，CLR 也将了解它之前的编译方式，这就是为什么它仍然是您的管理代码的原因。

OTOH，如果您想使用在 .NET 框架之前编写的库，那么您可以做一些限制，但请记住，由于当时 CLR 不存在，所以现在，CLR 不会再次理解和编译此代码. 这将被称为`unmanaged code`. 请注意，某些第三方为提供某些功能/工具而创建的库/程序集如果不兼容 CLR，也可能被视为非管理代码。

用外行的话来说，**管理代码**是您的 CLR 可以理解并可以自行编译以供进一步执行的东西。在 .NET 框架中，（来自在 .NET 框架上工作的任何语言）当代码转到 CLR 时，代码会提供一些元数据信息，以便 CLR 可以为您提供[此处](https://msdn.microsoft.com/en-us/library/8bs2ecf4(v=vs.110).aspx)指定的功能。他们很少是`Garbage collection, Performance improvements, cross-language integration, memory management`等等。

OTOH，**未管理的代码**是特定于机器并且可以使用的东西，无需进一步处理。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-11T09:36:33.697

从 Pro C# 5 和 .NET 4.5 框架：

> **托管代码与非托管代码：** 了解 C# 语言的最重要一点可能是它可以生成只能在 .NET 运行时执行的代码（您永远不能使用 C# 构建本机 COM 服务器或非托管 C/C++应用）。正式来说，用于描述面向 .NET 运行时的代码的术语是托管代码。包含托管代码的二进制单元称为程序集（稍后会详细介绍程序集）。相反，不能由 .NET 运行时直接托管的代码称为非托管代码。

# asp.net - 如何创建包含多个 VEVENT 的 .ICS 文件以导入现有 Outlook 日历

> ID：334334
> 
> 赞同：16
> 
> 时间：2008-12-02T15:32:34.523
> 
> 标签：asp.net, outlook, calendar, icalendar

我需要允许用户下载具有多个会议日期的活动。为此，我创建了一个要下载的内存流，它会生成一个 .ics 文件。例如：

```
开始：VCALENDAR
PRODID:-//公司//产品//EN
版本：2.0
方法：发布
开始：事件
摘要：事件主题
地点：活动地点
UID：1227559810-8527e2c-20847@domain.com
描述：一些描述
DTEND:20081101T200000Z
DTSTART:20081101T200000Z
优先级：3
结束：事件
开始：事件
  ...
结束：事件
结束：VCALENDAR

```

如果我在这个文件中只包含一个 VEVENT，它会将它保存到我现有的 Outlook 日历中。但是，当我有多个 VEVENT 时，它想将其作为新日历打开并将其归档在“其他日历”下。

有没有办法（不使用文件 - 从 Outlook 中导入）指定日历在打开时应自动导入现有日历？

更新：澄清一下，每个 VEVENT 都与一个“约会”有关。然而，可能有也可能没有重复的模式。

-麦克风

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T19:21:46.090

我认为这行不通。Outlook 在导入这些“开放”规范方面受到限制。我在尝试导入具有多个联系人的 vCard 文件时遇到了类似的问题。我最终拆分了文件并在 Outlook 中编写了一个脚本来导入目录中的所有文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T18:02:53.943

这是可能的，使用互联网日历（如来自谷歌）。Outlook 2007 具有订阅 Internet 日历（在帐户设置下）的功能，并且 Outlook 2003 具有可用的开源插件。您可以创建一个“只读”的可访问提要。格式就像

```
BEGIN:VCALENDAR  
PRODID:-//XYZ Corp//My Product//EN  
VERSION:2.0  
CALSCALE:GREGORIAN  
METHOD:PUBLISH  
X-WR-CALNAME:My Calendar  
X-WR-TIMEZONE:(GMT-05:00) Eastern Time (US & Canada)  
BEGIN:VEVENT  
DTSTART:20061021T100000Z  
DTEND:20061021T130000Z  
DTSTAMP:20090211T175526Z  
UID:5f98dfd5-ac72-4ae1-b3c2-799a4e7c91f9  
CLASS:PUBLIC  
CREATED:20071104T183833Z  
DESCRIPTION: My description text.  
LAST-MODIFIED:20071104T183833Z  
LOCATION: 123 Anywhere Street\; Anyplace, NJ 12345\; US  
SEQUENCE:0  
STATUS:CONFIRMED  
SUMMARY: My summary text.  
TRANSP:OPAQUE  
END:VEVENT  
BEGIN:VEVENT  
DTSTART:20061101T170000Z  
DTEND:20061101T180000Z  
DTSTAMP:20090211T175526Z  
UID:6eaef015-eb90-4e94-8e6c-0003b928969a  
CLASS:PUBLIC  
CREATED:20071104T183833Z  
DESCRIPTION: My description for number 2\.  
LAST-MODIFIED:20071104T183833Z  
LOCATION: 123 Anywhere Street\; Anyplace, NJ 12345\; US  
SEQUENCE:0  
STATUS:CONFIRMED  
SUMMARY: My summary for #2\.  
TRANSP:OPAQUE  
END:VEVENT  
END:VCALENDAR 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-28T04:45:51.617

确保为每个 VEVENT 使用唯一的 UID。如果您对每个 VEVENT 使用相同的 UID，您将看到您所描述的行为，因为只有唯一的 UID 被处理并添加到日历中。

HTH。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-09T14:26:06.350

这是关于前景的三场 FIFA 2010 比赛的示例，我猜这就是您要寻找的...

```
BEGIN:VCALENDAR

PRODID:-//Microsoft Corporation//Outlook 12.0 MIMEDIR//EN

VERSION:2.0

METHOD:PUBLISH

X-CALSTART:20100611T140000Z

X-CALEND:20100711T201500Z

X-WR-RELCALID:{0000002E-5A22-AA75-713B-5C3715764495}

X-WR-CALNAME: World Cup Football Complete Match Schedule 2010 South Africa

BEGIN:VEVENT

CATEGORIES:World Cup Football Complete Match Schedule 2010 South Africa

CLASS:PUBLIC

CREATED:20100608T231102Z

DESCRIPTION:Group A\nFollow MarkThisDate on Twitter

    markthisdate 

DTEND:20100611T154500Z

DTSTAMP:20100513T100200Z

DTSTART:20100611T140000Z

LAST-MODIFIED:20100608T231102Z

LOCATION:Johannesburg 

PRIORITY:5

SEQUENCE:0

SUMMARY:South Africa - Mexico

TRANSP:TRANSPARENT

UID:005ef5a170ab453276aad021756e5fde@markthisdate.com

X-MICROSOFT-CDO-BUSYSTATUS:FREE

X-MICROSOFT-CDO-IMPORTANCE:1

END:VEVENT

BEGIN:VEVENT

CATEGORIES:World Cup Football Complete Match Schedule 2010 South Africa

CLASS:PUBLIC

CREATED:20100608T231102Z

DESCRIPTION:Group A\nFollow MarkThisDate on Twitter

    markthisdate 

DTEND:20100611T201500Z

DTSTAMP:20100513T100200Z

DTSTART:20100611T183000Z

LAST-MODIFIED:20100608T231102Z

LOCATION:Cape Town 

PRIORITY:5

SEQUENCE:0

SUMMARY:Uruguay - France

TRANSP:TRANSPARENT

UID:9660590c514358c5bceed9e75bed0222@markthisdate.com

X-MICROSOFT-CDO-BUSYSTATUS:FREE

X-MICROSOFT-CDO-IMPORTANCE:1

END:VEVENT

BEGIN:VEVENT

CATEGORIES:World Cup Football Complete Match Schedule 2010 South Africa

CLASS:PUBLIC

CREATED:20100608T231102Z

DESCRIPTION:Group B\nFollow MarkThisDate on Twitter

    markthisdate 

DTEND:20100612T131500Z

DTSTAMP:20100513T100200Z

DTSTART:20100612T113000Z

LAST-MODIFIED:20100608T231102Z

LOCATION:Nelson Mandela Bay/Port Elizabeth 

PRIORITY:5

SEQUENCE:0

SUMMARY:Korea Republic - Greece

TRANSP:TRANSPARENT

UID:5a9eaca2435fb52e1c95ddb786f82efa@markthisdate.com

X-MICROSOFT-CDO-BUSYSTATUS:FREE

X-MICROSOFT-CDO-IMPORTANCE:1

END:VEVENT

END:VCALENDAR 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-22T00:48:30.150

这应该是可能的：/以下适用于谷歌，并且可以很好地加载到随行人员中。Outlook 似乎有一些问题，但会继续寻找。

注意 - 当您使用文件>导入等时，这确实会正确导入到 Outlook 中，只是双击会导致它只加载第一个事件。

```
BEGIN:VCALENDAR
PRODID:-//Google Inc//Google Calendar 70.9054//EN
VERSION:2.0
CALSCALE:GREGORIAN
METHOD:PUBLISH
X-WR-CALNAME:Insert something
X-WR-TIMEZONE:Insert something
X-WR-CALDESC:

BEGIN:VEVENT
DTSTART:20110909T180000Z
DTEND:20110909T200000Z
DTSTAMP:20110722T004312Z
UID:et53m4on1ii70en7uuv1thjr58@google.com
CREATED:20110721T105553Z
DESCRIPTION:
LAST-MODIFIED:20110721T105554Z
LOCATION:Insert something
SEQUENCE:0
STATUS:CONFIRMED
SUMMARY:Insert something
TRANSP:OPAQUE
BEGIN:VALARM
ACTION:DISPLAY
DESCRIPTION:This is an event reminder
TRIGGER:-P0DT0H10M0S
END:VALARM
END:VEVENT

BEGIN:VEVENT
DTSTART:20110909T083000Z
DTEND:20110909T103000Z
DTSTAMP:20110722T004312Z
UID:e5fhdjff6vakjftnl3l9vjs64k@google.com
CREATED:20110721T105410Z
DESCRIPTION:
LAST-MODIFIED:20110721T111008Z
LOCATION:Auckland
SEQUENCE:1
STATUS:CONFIRMED
SUMMARY:Insert something
TRANSP:OPAQUE
BEGIN:VALARM
ACTION:DISPLAY
DESCRIPTION:Insert something
TRIGGER:-P0DT0H10M0S
END:VALARM
END:VEVENT

END:VCALENDAR 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-18T19:09:04.500

确保文件的 VCALENDAR 部分中有“X-MS-OLK-FORCEINSPECTOROPEN:TRUE”。这允许将具有多个 VEVENT 的 ICS 文件导入 Outlook 中的默认日历。未创建新日历。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-17T13:31:58.957

这有效：获取 ICS 文件，拖放到 Outlook 中的日历按钮（我的左下角）。这会在默认日历中添加多个条目，而当 ICS 文件包含多个事件时，不会出现任何提示。更新和删除倍数是我的下一个挑战。

双击同一个文件有非常不同的结果：创建一个新日历，忙碌指示符被忽略。我描述的拖放保持忙碌指示器完好无损，就像它在 ICS 文件中一样

X-MS-OLK-FORCEINSPECTOROPEN：TRUE 打开了第一个条目，因此它可以被批准和添加。随后的 vevents 将被忽略。

X-MS-OLK-FORCEINSPECTOROPEN:FALSE 或完全删除该行在 Outlook 365 上对我来说具有相同的结果。

此外，当双击具有多个 vevents 的 ICS 文件时，我看到的是： Outlook 不完全兼容，因为创建了一个名为“无标题”的新日历。Windows 10 附带的邮件应用程序兼容并且所有条目都正确添加到日历中（可能是因为 Win 10 邮件应用程序只有 1 个日历？我不知道 - 我只为 Outlook 编写）

# .net - 如何以编程方式在 COM+ 应用程序中检查“允许 IIS 固有属性”？

> ID：334341
> 
> 赞同：1
> 
> 时间：2008-12-02T15:34:38.667
> 
> 标签：.net, components, com+

组件服务 -> 计算机 -> 我的电脑 -> COM+ 应用程序

打开一个 COM+ 应用程序对象。

打开组件。

右键单击一个类并选择属性。

在“高级”下有一个“允许 IIS 固有属性”复选框。

如何以编程方式选中此复选框？

我可以通过编程方式创建和删除 COM+ 应用程序，但 ComApplication 类似乎无法更改创建的应用程序中的设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T17:14:40.790

我发现了如何做到这一点。

显然我必须得到一个 COM+ 应用程序的集合，找到我想要的（按名称），然后在应用程序中获取一个组件的集合，然后遍历集合并设置属性：

```
 //get collection of applications
        COMAdminCatalog catalog = new COMAdminCatalog();

        catalog.Connect("127.0.0.1");

        COMAdminCatalogCollection applications = (COMAdminCatalogCollection)catalog.GetCollection("Applications");

        applications.Populate(); //no idea why that is necessary, seems to be

        // appId for the application we are looking for
        object appId = new object();

        int count = applications.Count;
        ICatalogObject item;

        if (count == 0) return;

        //search collection for item with name we are looking for
        for (int i = 0; i < count; i++)
        {

            item = (ICatalogObject)applications.get_Item(i);

            if (applicationName == (string)item.get_Value("Name"))
            {

                appId = item.Key;

                Console.WriteLine("appId found for " + applicationName + ": " + appId.ToString());

            }

        }

        // get all components for the application
        COMAdminCatalogCollection components;

        components = (COMAdminCatalogCollection)applications.GetCollection("Components", appId);
        components.Populate(); // again, no idea why this is necessary

        // set the attribute in all components

        foreach (COMAdminCatalogObject component in components)
        {

            Console.WriteLine("Setting IISIntrinsics attribute in " + component.Name + ".");
            component.set_Value("IISIntrinsics", true);
            components.SaveChanges();

        } 
```

我认为这可以做得更好，用更少的铸件。但我不知道怎么做。

这会做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T15:49:45.423

我对这个特殊属性没有经验，但它似乎记录在[MSDN](http://msdn.microsoft.com/en-us/library/ms688285(VS.85).aspx#_cos_components_iisintrinsics)中。

# eclipse - Eclipse 有什么好的 ssh 控制台吗？

> ID：334342
> 
> 赞同：12
> 
> 时间：2008-12-02T15:34:58.230
> 
> 标签：eclipse, plugins, eclipse-plugin, ssh

我正在为 Eclipse 寻找一个好的 ssh 控制台插件，但根本找不到。有人会有一些好的线索吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-04-20T19:01:05.783

如果您不喜欢 Eclipse RSE 中的 ssh.shells 或 ssh.terminals 子系统，请尝试改用终端视图。

*   打开窗口 -> 显示视图 -> 其他（或按`Shift+Alt+Q`then `Q`）
*   *`Terminal`*在搜索框中输入
*   选择文件夹*`Terminal`*下列出的视图*`Terminal`*

您将看到一个看起来类似于 RSE 的 ssh.terminals 子系统的窗口......但右上角有一些额外的按钮。

## 如何使用它：

*   要解决滚动问题（即：对于类似的程序`top`），请单击*`Scroll Lock`*右侧的按钮。
*   对于额外的终端窗口选项卡，单击*`New Terminal Connection`*按钮上的向下箭头
*   要更改当前终端窗口的设置，请使用*`Settings`*按钮。
*   如果您真的喜欢底部烦人的命令输入框，您可以使用相应的按钮将其打开和关闭。

## 更改背景颜色：

出于某种原因，默认设置是使用非常难以看到的白色背景。要改变这一点：

*   转到窗口-> 首选项
*   *`Terminal`*在左上角的搜索框中输入，或在*`Terminal`*左侧选择。
*   选中显示的框*`Invert terminal colors`*
*   您还可以在此处配置更大的终端缓冲区或连接超时
*   点击*`Apply`*

现在终端应该有黑色背景了！如果你想要一个本地终端，你可以在本地机器上启用 ssh，然后连接到`localhost`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-20T18:05:32.080

在 Eclipse 3.4.1 中，有一个 Remote Systems Explorer 透视图，允许您创建和连接到 SSH 终端（[这里](http://www.eclipse.org/dsdp/tm/tutorial/)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T15:38:40.687

存在允许您从 Eclipse 中打开 WinSCP 或 Putty 的插件。

我建议也许搜索“putty eclipse plugin”或类似的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-01T21:28:09.313

你也可以试试[Eclipse 的 Terminal 插件](https://code.google.com/p/elt/)

> 该插件为 Eclipse 3.7 或更高版本（是的，甚至 4.2！）提供了一个功能齐全的命令行终端，它仅适用于 Linux 和 MacOS。

更多信息请访问：[http ://alexruiz.developerblogs.com/?p=2428](http://alexruiz.developerblogs.com/?p=2428)

# sql - 如何使用存储在字段中的视图名称进行 sql 查询？

> ID：334345
> 
> 赞同：1
> 
> 时间：2008-12-02T15:35:29.383
> 
> 标签：sql, sql-server

我有一个带有 view_name 字段 (varchar(256)) 的表，我想在 sql 查询中使用该字段。

例子 ：

表 university_members

**编号 | 类型 | 视图名称 | 数数**

1 | 教授 | view_professors | 0

2 | 学生 | view_students2 | 0

3 | 员工 | view_staff4 | 0

我想用在相应视图上计算的一些聚合更新所有行（例如`..SET count = SELECT count(*) FROM view_professors`）。

这可能是一个新手问题，我猜这显然是不可能的或微不足道的。对设计的评论，即这里处理元数据的方式（将数据库对象名称显式存储为字符串）将不胜感激。尽管我无法控制该设计（因此无论如何我都必须找到答案），但我猜它并不是那么干净，尽管一些外部限制决定了它，所以我非常感谢社区对此的看法，以我个人的利益.

我使用 SQL Server 2005，但欢迎跨平台回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T15:41:00.060

为此，您必须将其作为一些动态 SQL 来执行，这样的事情可能会起作用，显然您需要进行编辑以实际匹配您正在尝试执行的操作。

```
DECLARE @ViewName VARCHAR(500)

SELECT @ViewName = view_name
FROM University_Members
WHERE Id = 1

DECLARE @SQL VARCHAR(MAX)

SET @SQL = '
UPDATE YOURTABLE
SET YOURVALUE = SELECT COUNT(*) FROM ' + @ViewName + '
WHERE yourCriteria = YourValue'

EXEC(@SQL) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T15:45:24.637

在我看来，您可以在 VARCHAR(MAX) 变量中生成 SQL 代码，然后使用 EXEC 关键字执行它。正如你所尝试的，我不知道有什么方法可以直接做到这一点。

例子：

```
DECLARE @SQL VARCHAR(MAX)
SET @SQL = ''
SELECT @SQL = @SQL + 'UPDATE university_members SET count = (SELECT COUNT(*) FROM ' + view_name + ') WHERE id = ' + id + CHAR(10) + CHAR(13) FROM university_members

EXEC @SQL 
```

警告！此代码未经测试。这只是一个提示...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T16:19:01.310

动态 SQl 是这样做的唯一方法，这就是为什么这是一个糟糕的设计选择。如果您必须使用动态 SQL 来保护您的数据，请阅读以下文章。 [http://www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T17:43:37.143

正如 HLGEM 所写，您被迫使用动态 SQL 的事实表明设计本身存在问题。我还要指出，将聚合存储在这样的表中很可能是另一个糟糕的设计选择。

如果您需要在某个时候确定一个值，请在需要时执行此操作。试图保持与您的数据同步的计算值几乎总是充满问题 - 不准确、额外开销等。

在极少数情况下，存储这样的值是必要的或具有优势的，并且通常在非常大的数据仓库或具有极高吞吐量的系统中。这不是一所学校或大学可能遇到的事情。

# xml - 文本属性作为另一个元素的值

> ID：334354
> 
> 赞同：3
> 
> 时间：2008-12-02T15:39:05.523
> 
> 标签：xml, xslt, xslt-1.0

使用下面的 XML，我想知道如何获取 case_id 节点中文本的值作为下面 xsl 表中隐藏输入标记的属性。这可能吗？

```
<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="data.xsl"?>
<NewDataSet>
<Cases>
<Case>
<case_id>30</case_id>
...
...
</Case>
</Cases>
</NewDataset>
<?xml version="1.0" encoding="iso-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
<input type="hidden" name="case_num" value="?"/>
</xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T15:48:18.517

试试这个

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="/">
    <input type="hidden" name="case_num">
      <xsl:attribute name="value">
        <xsl:value-of select="/NewDataSet/Cases/Case/case_id/text()"/>
      </xsl:attribute>
    </input>
  </xsl:template>
</xsl:stylesheet> 
```

或者你可以像这样内联

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="/">
    <input type="hidden" name="case_num" value="{/NewDataSet/Cases/Case/case_id/text()}"/>
  </xsl:template> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T15:47:51.637

只需将您的 XSLT 更改为此，这假定您只有 1 个 case_id，否则，您将需要使用更具体的模板匹配，并删除我用作示例的 XPATH 值中的一些路径。

```
<input type="hidden" name="case-num">
    <xsl:attribute name="value">
        <xsl:value-of select="/NewDataSet/Cases/Case/case_id" />
    </xsl:attribute>
</input> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T15:47:47.957

您需要使用一些更具体的匹配来扩展您的 XSLT。

以下应输出`input`包含`case_id`每个`Case`. 我假设`case_id`每个`Case`. 我已经尽量使 XSLT 尽可能明确，但如果您不想这样做，则不需要在实现中如此精确。

```
 <xsl:template match="/">
   <xsl:apply-templates />
 </xsl:template>

 <xsl:template match="Case">
    <xsl:element name="input">
       <xsl:attribute name="type">
          <xsl:text>hidden</xsl:text>
       </xsl:attribute>
       <xsl:attribute name="name">
          <xsl:text>case_num</xsl:text>
       </xsl:attribute>
       <xsl:attribute name="value">
          <xsl:value-of select="case_id"/>
       </xsl:attribute>
    </xsl:element>
 </xsl:template> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T21:42:08.973

**[只需像这样使用 AVT](http://www.w3.org/TR/xslt#attribute-value-templates)**（属性值模板）：

```
<input type="hidden" name="case_num" value="{*/*/*/case_id}"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T17:25:13.873

我将其更改为：

```
<input type="hidden" name="case-num">
    <xsl:attribute name="value">
        <xsl:value-of select="case_id" />
    </xsl:attribute>
</input> 
```

因为它在 foreach 循环中。谢谢大家，这很管用！

# c# - 上下文切换死锁

> ID：334360
> 
> 赞同：3
> 
> 时间：2008-12-02T15:40:09.157
> 
> 标签：c#, multithreading, debugging, contextswitchdeadlock

在 VS 2008 中调试我的程序时，我遇到了以下错误：

CLR 在 60 秒内无法从 COM 上下文 0x34fc1a0 转换到 COM 上下文 0x34fc258。拥有目标上下文/单元的线程很可能要么进行非泵送等待，要么处理非常长时间运行的操作而不泵送 Windows 消息。这种情况通常会对性能产生负面影响，甚至可能导致应用程序变得无响应或内存使用量随着时间的推移不断累积。为了避免这种情况

即使代码仅包含一个简单的 C# 计时器，它似乎也出现了死锁：请参见下面的代码段：

```
 private void RequestWork()
    {
        // The timer will be re-intialised if there are still no wating jobs in the database
        StopTimer();

        // assign all the threads some work
        InitialiseTimer();

    }

    /// <summary>
    /// Initialise a timer with a timer interval configured from app.config. Enable the timer and 
    /// register an appropriate event handler
    /// </summary>
    private void InitialiseTimer()
    {

        if (m_Timer == null)
        {
            // look up the default backoff time from the config
            string backOffInt = ConfigurationSettings.AppSettings["BackOffInterval"];

            int backoffInterval = 1000;

            m_Timer = new System.Timers.Timer();

            // set the timer interval to 5 seconds
            m_Timer.Interval = backoffInterval;

            m_Timer.Elapsed += new ElapsedEventHandler(m_Timer_Elapsed);
        }

        m_Timer.Enabled = true;
    }

    private void StopTimer()
    {

        if (m_Timer != null)
        {
            m_Timer.Enabled = false;
        }
    }

    void m_Timer_Elapsed(object p_Sender, ElapsedEventArgs p_E)
    {

        RequestWork();
    } 
```

据我所知，计时器应该运行，经过然后再次初始化，我看不到死锁的本地原因。

我知道如何关闭此错误消息，但觉得这不是解决方案，而是掩盖了问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T16:48:13.200

如果您认为您绝对*没有*遇到死锁情况，您可以将其关闭：

Visual Studio 中的 Debug->Exceptions->Managed Debug Assistants 菜单并取消选中 ContextSwitchDeadlock

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T22:34:53.537

这是一个无限循环。您需要让您的应用程序至少每 60 秒发送一次消息，以防止发生此异常。尝试不时调用 System.Threading.Thread.CurrentThread.Join(10)。您还可以执行其他调用来让消息激增。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T16:34:30.060

每次调用 InitialiseTimer 时，您似乎都在添加一个新的事件处理程序。这样， m_Timer_Elapsed 将被调用的次数与添加的次数一样多。您应该只添加一次事件处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-09T06:29:30.207

如果您的应用程序挂起或即使在您取消选中 contextswitchdeadlock 框后也没有响应。将以下行放在方法或 for 循环调用之前。

在 C# 中

```
System.Windows.Forms.Application.DoEvents(); 
```

和 VB.NET / VB / ASP.NET

```
DoEvents() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T22:54:34.417

几个想法/问题：

1）代码片段看起来像你的间隔是每 1 秒（不是评论中提到的 5 秒）。2）最大的问题是在`RequestWork()`做什么？

在不知道`RequestWork()`在做什么的情况下，我们无法真正评论您看到 ContextSwitchDeadlock 的原因。

关于这种方法需要考虑的事情 a) 需要多长时间？b) 它是否在访问 GUI 元素？

MSDN 对 Elapsed 的一些评论：

> 如果将 Timer 与用户界面元素（例如窗体或控件）一起使用，请将包含 Timer 的窗体或控件分配给 SynchronizingObject 属性，以便将事件封送至用户界面线程。

-和-

> Elapsed 事件在 ThreadPool 线程上引发。如果 Elapsed 事件的处理持续时间超过 Interval，则该事件可能会在另一个 ThreadPool 线程上再次引发。因此，事件处理程序应该是可重入的。

我在想，既然你有一个 1 秒的计时器，你可能想看看 RequestWork 中发生了什么，看看它需要多长时间。

# .net - 何时使用“嵌套诊断上下文”（NDC）？

> ID：334367
> 
> 赞同：63
> 
> 时间：2008-12-02T15:41:36.267
> 
> 标签：.net, logging, log4net, ndc

使用 log4net，我看到了使用称为 NDC 的每个线程的上下文标签堆栈的可能性。

`%x`通过指定或`%ndc`格式参数，压入此堆栈的标签显示在 PatternLayout 中。

用法类似于：

```
ILog log = log4net.LogManager.GetLogger(...) ;

//pattern layout format: "[%ndc] - %message%newline"

log.Info("message 1"); 
using(log4net.NDC.Push("context")
{
    using(log4net.NDC.Push("inner_context")
    {
      log.Info("message 2"); 
    }
    log.Info("message 3"); 
}
log.Info("message 4"); 
```

输出类似于：

```
null - message 1
context inner_context - message 2
context - message 3
null - message 4 
```

在您使用 log4net 的编程经验中，您什么时候发现此功能很有用？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-06-27T13:07:05.120

想要一个例子吗？

采用以下使用 ASP.NET MVC4 编写的 Web API：

```
// GET api/HypervResource
public string Get()
{
    logger.Debug("Start of service test");
    System.Threading.Thread.Sleep(5000); // simulate work
    logger.Debug("End of service test");
    return "HypervResource controller running, use POST to send JSON encoded RPCs";
} 
```

当服务器并发 HTTP 请求时，日志记录可以交错。例如

```
2013-06-27 13:28:11,967 [10] DEBUG HypervResource.WmiCalls [(null)] - Start of service test
2013-06-27 13:28:12,976 [12] DEBUG HypervResource.WmiCalls [(null)] - Start of service test
2013-06-27 13:28:14,116 [13] DEBUG HypervResource.WmiCalls [(null)] - Start of service test
2013-06-27 13:28:16,971 [10] DEBUG HypervResource.WmiCalls [(null)] - End of service test
2013-06-27 13:28:17,979 [12] DEBUG HypervResource.WmiCalls [(null)] - End of service test
2013-06-27 13:28:19,119 [13] DEBUG HypervResource.WmiCalls [(null)] - End of service test 
```

在这个简单的示例中，您可以使用线程 id 来区分请求，但是随着日志文件的复杂性增加，这可能会变得很棘手。

更好的选择是提供唯一标识符，将同一请求的日志消息组合在一起。我们可以将代码更新为以下内容：

```
// GET api/HypervResource
public string Get()
{
    using(log4net.NDC.Push(Guid.NewGuid().ToString()))
    {
        logger.Debug("Start of service test");
        System.Threading.Thread.Sleep(5000); // simulate work
        logger.Debug("End of service test");
        return "HypervResource controller running, use POST to send JSON encoded RPCs";
    }
} 
```

这会生成一个日志，您可以使用 grep 来查看与特定请求相关的问题。例如

```
2013-06-27 14:04:31,431 [11] DEBUG HypervResource.WmiCalls [525943cb-226a-43c2-8bd5-03c258d58a79] - Start of service test
2013-06-27 14:04:32,322 [12] DEBUG HypervResource.WmiCalls [5a8941ee-6e26-4c1d-a1dc-b4d9b776630d] - Start of service test
2013-06-27 14:04:34,450 [13] DEBUG HypervResource.WmiCalls [ff2246f1-04bc-4451-9e40-6aa1efb94073] - Start of service test
2013-06-27 14:04:36,434 [11] DEBUG HypervResource.WmiCalls [525943cb-226a-43c2-8bd5-03c258d58a79] - End of service test
2013-06-27 14:04:37,325 [12] DEBUG HypervResource.WmiCalls [5a8941ee-6e26-4c1d-a1dc-b4d9b776630d] - End of service test
2013-06-27 14:04:39,453 [13] DEBUG HypervResource.WmiCalls [ff2246f1-04bc-4451-9e40-6aa1efb94073] - End of service test 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-02T16:51:12.740

在 ASP.NET 等服务器应用程序中。

例如，您可以将有关当前请求的信息推送到 NDC。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-12-02T16:02:52.853

当您需要查看大量日志时，这些功能会派上用场。你什么时候会有很多日志？在具有交错输出的生产系统上诊断奇怪的错误。拥有更多上下文可以让您过滤输出或不输出不需要的日志。

嵌套上下文的另一种情况可能很有用，如果一个方法或某个特性在不同的上下文中被多次调用，并且您需要一种方法来区分它们。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-01-11T08:59:32.967

`NDC.Push`已被弃用。现在（`ThreadContext.Stacks["NDC"]`）的首选方式是：

```
var disposable = ThreadContext.Stacks["NDC"].Push("context");
try
{
  Log.Info("begin"); // optional, but nice
  ...
}
finally
{
  Log.Info("end"); // optional, but nice
  disposable.Dispose();
} 
```

请记住检查您的转换模式，使其包括`%property{NDC}`：

```
<layout type="log4net.Layout.PatternLayout">
  <conversionPattern
    value="%date [%2thread] %-5level [%property{NDC}] - %.10240message%newline" />
</layout> 
```

# javascript - 使用锚点作为 javascript 动作，链接应该是什么？

> ID：334370
> 
> 赞同：4
> 
> 时间：2008-12-02T15:42:13.113
> 
> 标签：javascript, html

在我的生活中，我已经多次看到（并使用过）链接生成 javascript 操作的代码，但我从未对 href 属性是否应该为空白或 # 得出明确的结论。你有任何偏好，如果有，为什么？

```
<a href="" onclick="javascript: DoSomething();">linky</a> 
```

或者

```
<a href="#" onclick="javascript: DoSomething();">linky</a> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-02T15:56:51.790

您**必须**为该属性提供*一些*`href`内容，否则浏览器不会将其视为链接（例如，使其具有焦点或给它下划线） - 这就是使用“#”变得普遍的原因。

此外，事件属性 ( `onclick`, `onmouseover`, `on...`) 的内容已被视为 javascript：您无需在其前面加上`javascript:`

*因此，鉴于您的示例，内联的最佳方法（它本身可能*不是最好的方法）是这样的：

```
<a href="#" onclick="DoSomething(); return false">linky</a> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-02T15:47:42.090

在[Href 上查看关于 Javascript 链接的讨论：“#”还是“javascript:void(0)”？](https://stackoverflow.com/questions/134845/href-for-javascript-links-or-javascriptvoid0).

此外，`href`留空会导致浏览器在用户鼠标悬停时不使用指针光标，但您可以使用 CSS 修复它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T15:50:25.283

我总是使用 # 作为 javascript: inside 的 html 属性似乎通常被认为是糟糕的做法。

这么说，你应该尽量避免使用 onclick= 属性，而是在外部 .js 文件中使用 javascript 侦听器。

例如你使用 jQuery..

```
$(".link").click(function(e) {
    e.preventDefault();
    DoSomething();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T17:41:09.363

为什么不让 href 指向一个页面，说明他们关闭了 JavaScript，他们需要打开它才能获得缺失的功能？

由于只有在他们关闭 javascript 时才会关注该链接，所以让它提供一些信息！

还要记住人们有时会在此类链接上单击鼠标中键，并且不会触发 OnClick 事件，因此如果您可以让他们获得一个无需 javascript 即可工作的页面，那将是理想的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T17:45:50.977

在这种情况下，您不打算提供非 JavaScript 选项，我更喜欢：

```
<a href="javascript:// open xxx widget" onclick="DoSomething();">linky</a> 
```

这样，您至少可以提供计划文本描述作为 JavaScript 注释。

# c - 目的：#define、#include、#undef

> ID：334371
> 
> 赞同：3
> 
> 时间：2008-12-02T15:42:23.020
> 
> 标签：c, embedded, include

ac 文件中此构造的目的是什么？：

```
#define _TIMERC  
#include "timer.h"  
#undef _TIMERC 
```

我知道防止多次包含头文件的防护措施。但这似乎不是正在发生的事情。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T16:10:23.620

这里有一个场景来说明......

假设 timer.h 提供了一个宏 tick_count() ，它返回发生的定时器中断的数量。

一个模块 (rpm_reader.h) 使用计时器 A 进行间隔计时：

```
#define _TIMERA   
#include "timer.h"   
#undef _TIMERA 
```

在另一个模块 (lap_time.h) 中使用计时器 C 进行间隔计时

```
#define _TIMERC  
#include "timer.h"  
#undef _TIMERC 
```

rpm_reader 会在调用 tick_count() 时从计时器 A 返回滴答计数，而 lap_time 将从计时器 C 获取其计数。

（我很抱歉回答我自己的问题，但问这个问题帮助我得到了这个启示。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T15:48:58.390

通常，一个库头文件会有多个选项，由宏定义启用和禁用。这将启用这样的选项。

更典型的是，通过配置您的构建系统以将 -D_TIMERC 添加（例如使用 gcc）**-D_TIMERC**到编译器命令行，这些设置在全局范围内。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T15:45:26.073

我想知道它是否可能是这样的：

在这种情况下，头文件旨在允许在每个#include 之前建立具有不同定义的多个包含。

如果在 timer.h 中有一个用于微控制器中每个定时器的定时器 A、B 和 C 的代码块（中断代码）。在某些情况下，一个模块需要定时器 A，而另一个模块需要定时器 C。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T15:47:26.693

我认为您的自我回答是正确的。包含的标头中很可能有条件的东西，“调用”文件知道它想要包含哪一组特定的条件“东西”。

它不一定与多个包含有关 - 它可能只是特殊情况，具体取决于“调用”上下文。

我不确定为什么要取消定义。我想不出我会混合和匹配的情况，所以不确定为什么需要取消定义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T15:48:31.200

冒着明显的风险，“timer.h”期望有 _TIMERC 而你的其余代码没有。

在一般情况下显然不是好的做法，但我在包含第三方代码时看到了类似的情况。当你有冲突的#defs时会变得讨厌......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T17:25:49.380

作为记录，避免多个包含同一头文件的常见做法是将保护放在文件本身中，而不是依赖于一些外部定义...... ^_^

标题以：

```
#ifndef header_name_h
#define header_name_h 
```

并以：

```
#endif 
```

当然，def 样式可能会有所不同。

因此，在第一次包含时，我们经过#ifndef（尚未定义）并设置宏。在第二次包含时，如果有的话，我们只是跳转到文件末尾，什么都不包含。

# visual-studio - 调试时是否可以从目标目录启动外部程序？

> ID：334373
> 
> 赞同：4
> 
> 时间：2008-12-02T15:42:55.233
> 
> 标签：visual-studio, debugging

调试时，我需要从构建的目标目录启动一个外部程序，并且想知道是否可以使用相对路径来完成。

作为构建后事件，我有以下内容：

```
IF NOT "$(ConfigurationName)"=="Debug" GOTO End
:复制可执行文件
复制 "$(SolutionDir)\Source\Lib\MyExecutable.exe" "$(TargetDir)"
：结尾

```

我在调试时需要运行 MyExecutable.exe，因此在项目属性的调试选项卡中，我将“启动外部程序”设置为 MyExecutable.exe，但在运行调试时失败。看来我需要为此工作的完整路径。

有没有办法使用相对路径来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-17T04:47:01.443

“启动外部程序”路径与您的解决方案目录相关（无论如何在 VS2005 中）。所以你可以放：

```
Source\Lib\MyExecutable.exe 
```

我看到你前段时间问过这个问题，但我遇到了同样的问题，这就是我解决它的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T13:01:46.303

（_免责声明：所有方向均基于VS08。之前或将来的版本中的东西可能在不同的地方）

我觉得您的其他程序*不是*您在调试之前需要运行的构建后步骤，而是*在*您调试时也需要运行（服务器或其他东西）的程序。

使用一个空的 C++ Make-File 项目（您可以使用其他项目类型，但默认情况下这个项目并没有实际构建，所以我发现它是最简单的），并将其启动属性（项目/属性 -> 调试）更改为运行您的其他应用程序。然后，将您的解决方案设置为启动多个项目（解决方案/属性 -> 通用属性 -> 启动项目）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-29T02:36:49.763

您是否尝试过类似 $(TargetDir)\..\Lib 的方法？

# c# - UserControl 的 RenderControl 要求（C# .NET）中的表单标记

> ID：334382
> 
> 赞同：13
> 
> 时间：2008-12-02T15:45:28.240
> 
> 标签：c#, html, .net, user-controls

我询问[了如何呈现 UserControl 的 HTML](https://stackoverflow.com/questions/288409/how-do-i-get-the-html-output-of-a-usercontrol-in-net-c)并让代码为动态生成的 UserControl 工作。

现在我正在尝试使用 LoadControl 加载以前生成的控件并吐出它的 HTML，但它给了我这个：

*'TextBox' 类型的控件必须放在带有 runat=server 的表单标记内。*

我实际上并没有将控件添加到页面，我只是想获取它的 HTML。有任何想法吗？

这是我正在玩的一些代码：

```
TextWriter myTextWriter = new StringWriter();
HtmlTextWriter myWriter = new HtmlTextWriter(myTextWriter);

UserControl myControl = (UserControl)LoadControl("newUserControl.ascx");
myControl.RenderControl(myWriter);

return myTextWriter.ToString(); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-03T17:46:00.820

或者，您可以在将控件呈现为字符串的页面上禁用 ServerForm/Event-validation。

以下示例说明了如何执行此操作。

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string rawHtml = RenderUserControlToString();
    }

    private string RenderUserControlToString()
    {
        UserControl myControl = (UserControl)LoadControl("WebUserControl1.ascx");

        using (TextWriter myTextWriter = new StringWriter())
        using (HtmlTextWriter myWriter = new HtmlTextWriter(myTextWriter))
        {
            myControl.RenderControl(myWriter);

            return myTextWriter.ToString();
        }
    }

    public override void VerifyRenderingInServerForm(Control control)
    { /* Do nothing */ }

    public override bool EnableEventValidation
    {
        get { return false; }
        set { /* Do nothing */}
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T15:57:25.737

您可以将控件添加到页面中，呈现 html，然后从页面中删除控件。

或者试试这个：

```
Page tmpPage = new TempPage(); // temporary page
Control tmpCtl = tmpPage.LoadControl( "~/UDynamicLogin.ascx" );
//the Form is null that's throws an exception
tmpPage.Form.Controls.Add( tmpCtl );

StringBuilder html = new StringBuilder();
using ( System.IO.StringWriter swr = new System.IO.StringWriter( html ) ) {
    using ( HtmlTextWriter writer = new HtmlTextWriter( swr ) ) {
        tmpPage.RenderControl( writer );
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-03T14:12:28.583

这是我目前使用的一个肮脏的解决方案（让它工作然后做对，对吧？）。

我已经创建了一个继承 UserControl 类的新类，并且我创建的所有其他“UserControls”都是从该类派生的。我称它为 formPartial（向 Rails 致敬），这是在公共字符串 renderMyHTML() 方法中进行的：

```
TextWriter myTextWriter = new StringWriter();
HtmlTextWriter myWriter = new HtmlTextWriter(myTextWriter);

UserControl myDuplicate = new UserControl();
TextBox blankTextBox;

foreach (Control tmpControl in this.Controls)
{
    switch (tmpControl.GetType().ToString())
    {
        case "System.Web.UI.LiteralControl":
            blankLiteral = new LiteralControl();
            blankLiteral.Text = ((LiteralControl)tmpControl).Text;
            myDuplicate.Controls.Add(blankLiteral);
            break;
        case "System.Web.UI.WebControls.TextBox":
            blankTextBox = new TextBox();
            blankTextBox.ID = ((TextBox)tmpControl).ID;
            blankTextBox.Text = ((TextBox)tmpControl).Text;
            myDuplicate.Controls.Add(blankTextBox);
            break;

            // ...other types of controls (ddls, checkboxes, etc.)

    }
}

myDuplicate.RenderControl(myWriter);
return myTextWriter.ToString(); 
```

我头顶的缺点：

1.  您需要一个包含所有可能控制（或您期望的控制）的 case 语句。
2.  您需要将所有重要属性从现有控件（文本框等）转移到新的空白控件。
3.  没有充分利用 Controls 的 RenderControl 方法。

搞砸 1 或 2 很容易。不过，希望这有助于其他人提出更优雅的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T15:48:59.513

您可以向用户控件添加表单，也可以使用常规的 html 输入框

```
 <input type="text" /> 
```

编辑：如果你正在尝试做一些 AJAXy，也许你想要这样的东西 [http://aspadvice.com/blogs/ssmith/archive/2007/10/19/Render-User-Control-as-String-Template.aspx](http://aspadvice.com/blogs/ssmith/archive/2007/10/19/Render-User-Control-as-String-Template.aspx)

```
 public static string RenderView<D>(string path, D dataToBind)
    {
        Page pageHolder = new Page();
        UserControl viewControl = (UserControl) pageHolder.LoadControl(path);
        if(viewControl is IRenderable<D>)
        {
            if (dataToBind != null)
            {
                ((IRenderable<D>) viewControl).PopulateData(dataToBind);
            }
        }
        pageHolder.Controls.Add(viewControl);
        StringWriter output = new StringWriter();
        HttpContext.Current.Server.Execute(pageHolder, output, false);

        return output.ToString();
    } 
```

如果不需要，您可以删除数据绑定部分。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-04-03T11:49:20.000

我在使用与@TcKs 类似的代码时遇到了同样的问题，并且无法使这些示例中的任何一个对我有用。我通过使用a这样的`LoadControl`方法让它工作：`UserControl`

```
UserControl uc = new UserControl();
Control c = uc.LoadControl("newUserControl.ascx");
c.RenderControl(myWriter); 
```

# visual-studio-2008 - Visual Studio 2008（和 VSTS）的最佳功能？

> ID：334383
> 
> 赞同：0
> 
> 时间：2008-12-02T15:45:33.980
> 
> 标签：visual-studio-2008

自从不起眼的 Visual Studio 6（和以前的版本）以来，Visual Studio 肯定会不断发展壮大。Visual Studio 2010 中似乎还有更多功能（基于博客、PDC 和更新的 CTP 虚拟机）。

最近的 Service Pack 1 似乎引入了一些非常有趣的新功能和增强功能。

就目前的情况来看，即在 Visual Studio 2008 (SP 1) 中，您认为 Visual Studio（包括 Team Suite 版本）中最出色的、不能没有它的功能是什么？它是你每天使用的东西吗？

或者，Visual Studio 2008 中的哪些功能可以真正使用升级/改造/错误修复？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T16:13:34.300

智能感知

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T18:54:21.870

迄今为止发布的大部分内容都已在 Visual Studio 中保存了相当长的一段时间。我最喜欢的新功能是；

**重构**

最好的功能虽然不在 Visual Studio 中，但最好的是在**Resharper**中！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T19:57:29.870

*   单元测试。虽然我会使用 xUnit.NET 或 NUnit，但它在 Pro 产品中的事实很重要
*   圈复杂度。真的很多代码分析功能真的很有趣
*   分析 - 能够看到诸如您的对象在各个世代中花费了多少时间之类的事情会非常有帮助
*   DBPro 很棒。我只希望它适用于 SQL Server 以外的其他东西
*   性能向导。
*   重构。正如其他人指出的那样，它并没有击败像 Resharper 这样的东西，但它仍然更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T18:43:23.217

智能感知。

编辑并继续。

即时窗口。

看窗户。

能够将黄色的“下一条指令”小箭头拖动到“下一条”指令的任意位置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-02T18:51:29.550

*   智能感知
*   观看窗口
*   线程窗口（在快速版本中不可用）
*   Immed（即时测试东西）
*   条件调试（在快速版本中不可用）
*   转到定义/查找用法
*   可扩展性

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T18:55:24.910

对我来说，VS 2008 中最好的一点是可以在此基础上构建像 VS.PHP 这样的工具。这样您就可以在 VS 中编写一个 PHP 网站，其中包含所有这些好东西，例如智能感知等。

最糟糕的功能是“按设计”充满错误和其他肮脏东西的数据集设计器。使用它只是一种痛苦。所以 - 我不推荐 DataSet Designer。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T19:50:08.387

蓝色指南可帮助您在设计视图中排列控件。

不支持 .net 1.1，不幸的是，这是我工作的地方需要的。回到 Visual Studio 2003 很痛苦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-02T20:10:45.333

*   重构
*   智能感知
*   自动格式化
*   捷径：
    *   CTRL + .
    *   CTRL + ALT + P
    *   F10 , F11
    *   ALT + Enter
    *   CTRL + K + C
    *   CTRL + K + U
*   调试功能：
    *   在异常抛出之前中断
    *   即时窗口
    *   看窗
*   单元测试
*   在文件中查找
*   剖析
*   模块窗口

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-11T00:01:05.083

如果您右键单击一个选项卡并点击打开包含文件夹，它会在资源管理器中打开该文件夹并选择该文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-11T00:27:47.243

就 VSTS 而言，我喜欢下面的项目。

*   工作项/错误跟踪
*   敏捷流程支持
*   代码分析和签入策略
*   错误/工作项相关的签入

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-11T00:40:37.297

拆分视图，除了设计和源视图。我认为 VS 2008 是第一个具有此功能的版本，它允许您查看设计和源代码水平拆分。如果你有两台显示器（我们不是全部），你可以垂直分割它，一个屏幕用于源，一个用于设计。许多其他 HTML 编辑器多年来一直具有此功能。

有时，当我将焦点从源代码更改为设计视图时，它会弄乱我的一小部分 HTML，我还没有弄清楚为什么。这让我在上传之前花更多时间查看我的页面。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-14T14:58:40.593

VSTS 测试版中的负载测试代理很棒。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-14T15:01:41.287

IntelliSense 是最好的。将 IntelliSense 与 JavaDocs 进行比较，您会看到它有多好。

最好的祝福！

# sql - 在 SQL 数据库中更快地访问拆分表和 JOIN 或保留几个单片表更好吗？

> ID：334387
> 
> 赞同：2
> 
> 时间：2008-12-02T15:46:10.987
> 
> 标签：sql, database-design, optimization

我知道这可能不是构建数据库的正确方法，但是如果将数据放在一个巨大的表中而不是在其他表中进行逻辑分解，数据库的执行速度会更快吗？

我想使用键正确设计和创建数据库以创建跨表的关系完整性，但是在查询时，加入是否比从一个表中读取所需数据慢？我想让数据库查询尽可能快。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-02T15:51:54.670

许多其他方面会影响您问题的答案。桌子的尺寸是多少？宽度？多少行？什么是使用模式？表中列的不同子集是否有不同的使用模式？（即，是否有两列每秒命中 1000 次，而其他 50 列每天仅命中一次或两次？）这种情况将是垂直拆分（分区）表的主要候选者（一个表中的两列，其余列另外一个）

通常，将模式标准化到最大程度，然后使用典型或预测的负载和使用模式运行性能测试，然后将非标准化和分区到性能变得可以接受的程度，然后就不再...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T15:49:52.600

当然，这取决于 dbms 风格和您的实际数据。但*通常*更小（更窄）的表比更少的更大（更宽）表更快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T15:54:21.560

当必须执行连接时，访问速度会慢一些。慢多少很大程度上取决于特定 DBMS 提供的功能、物理数据库设计如何利用这些功能以及最频繁的访问模式。有一些访问模式在一行中存储大量数据会浪费时间，因为检索了整行，但只使用了行中的一小部分。这取决于。

当数据存储在单个表中并且偏离规范化规则时，更新通常较慢。更新速度与查询速度的重要性取决于您使用此数据库的特定方式。

一般来说，许多新手数据库设计人员往往比这些问题更重视速度问题。如果您的数据模型不灵活且难以理解，但您获得了 10% 的速度提升，那么您可能弊大于利。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T15:56:22.807

您是否正在构建像数据仓库这样的“只读”数据库？如果是这样，存储“预先加入”的数据可能是有意义的。对于日常 OLTP 数据库，您还需要考虑插入、更新和删除的性能和易用性。此外，如果查询只需要一两个较小表中的数据，该怎么办？现在，他们不得不在一张满是他们不关心的东西的大桌子上苦苦挣扎。

值得记住的是，连接表对于一个体面的 DBMS 来说是必不可少的东西——它们非常擅长。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-02T16:05:17.360

查询单个表通常比查询多个连接表要快，这是事实。但是规范化设计允许您以多种方式查询数据，并且在多种查询类型中具有足够的性能。

如果对表进行非规范化，您可能会提高一个特定查询的性能，同时牺牲针对该数据的其他查询的性能。当然，您必须手动管理参照完整性和冗余。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T15:55:38.750

您要问的是非规范化 - 如果以正确的方式完成，并且您能够确保不会因此而将异常引入数据库，它可以加快读取速度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T16:22:45.107

还要记住，一条记录中可以存储的数据量是有硬性限制的。（不知道你有哪个数据库，我不能说它是什么。）列太多，你会达到这个限制。此外，如果您有诸如 phone1、phone2、phone3 之类的列，那么您需要进行规范化。如果您需要在要插入的关于记录的项目数量发生变化时添加一列（例如，如果您需要 4 个而不是 3 个电话号码），则需要进行规范化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T19:33:38.140

优化 SELECTS 的正确方法在优化 INSERTS、UPDATES 和 DELETES 时通常不是很好，因此使用这种方法也是如此。将数据分解为适当规范化的表可减少更改数据的开销。

虽然在数据仓库或决策支持系统中我们经常存储预先连接的数据（正如 Tony 所说），但它通常只发生在预先计算的摘要（例如物化视图）的上下文中，而不是用于原子级别的粒度。这样做的原因是，将重复的较长字符串（例如“供应商名称”）推入维度表会减少所需的总存储空间和检索数据所需的物理读取次数。连接通常是等连接，对于大型数据集，这些连接几乎是免费的。

# c# - 设计模式：解析文本文件中相似但不同的模式

> ID：334388
> 
> 赞同：8
> 
> 时间：2008-12-02T15:46:24.137
> 
> 标签：c#, .net, design-patterns, architecture, poker

在此先感谢您的帮助。我想知道是否有（设计）模式可以应用于这个问题。

**我希望从具有相似但不同格式的文本文件中解析、处理和提取值。**

更具体地说，我正在构建一个处理引擎，它接受来自众多不同网站的在线扑克手牌历史文件，并解析出特定的数据字段（手牌#、日期时间、玩家）。我需要将文件解析为每种格式略有不同的逻辑，但提取值的处理将是相同的。

我的第一个想法是只创建一个接受每种文件类型的“模式”并相应地解析/处理的类。我确信有更好的解决方案。

谢谢！

**奖励点：** C# 中的任何特定实现提示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T16:01:08.863

这听起来像是策略模式的候选者。可以在[此处找到 C# 中的示例，并](http://www.dofactory.com/Patterns/PatternStrategy.aspx)[在此处](http://www.c-sharpcorner.com/UploadFile/rmcochran/strategyPattern08072006095804AM/strategyPattern.aspx)找到另一个示例。[维基百科](http://en.wikipedia.org/wiki/Strategy_pattern)上提供了简要说明。

更完整的描述可在[Fowler](http://www.amazon.co.uk/Refactoring-Improving-Design-Existing-Technology/dp/0201485672/ref=sr_1_1?ie=UTF8&s=books&qid=1228233270&sr=8-1)和[Kerievsky](http://www.amazon.co.uk/Refactoring-Patterns-Addison-Wesley-Signature-Kerievsky/dp/0321213351/ref=pd_sim_b_5)的书中找到。

它也可从 GoF 书中获得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T15:56:31.807

“提供者”模式是您正在寻找的模式......它是在 ADO.Net 中使用的模式。每个数据库供应商都有一个单独的数据“提供者”，它“知道”如何从其特定的数据库供应商产品中读取数据，但以标准格式（接口）将其交付给下游系统......您将编写一个小型“提供者”组件（单个类就足够了）“知道”每个不同网站扑克历史数据提供者的格式，并以完全相同的方式将该数据公开给读取它的上游系统......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T15:59:42.923

首先，创建您的“在线扑克手牌历史”**模型**。该模型将表示数据，并且能够独立于源处理这些数据。然后为必须能够将文件信息转换为模型的每种不同源格式创建**提供程序。**

编辑：例如

```
public interface IDataProvider
{
    IOnlinePokerInfo ParseFileInformation(FileInfo input);
}

public interface IOnlinePokerInfo
{
    int Hand { get; set; }
    DateTime DateInfo { get; set; }
    List<IPlayer> Players { get; set; }
    void ProcessInformation();
}

public interface IPlayer
{
    string Name { get; set; }
}

public class MyOnlinePokerInfo : IOnlinePokerInfo
{
    private int hand;
    private DateTime date;
    private List<IPlayer> players;

    public int Hand { get { return hand; } set { hand = value; } }
    public DateTime DateInfo { get { return date; } set { date = value; } }
    public List<IPlayer> Players { get { return players; } set { players = value; } }

    public MyOnlinePokerInfo(int hand, DateTime date)
    {
        this.hand = hand;
        this.date = date;
        players = new List<IPlayer>();
    }

    public MyOnlinePokerInfo(int hand, DateTime date, List<IPlayer> players)
        : this(hand, date)
    {
        this.players = players;
    }

    public void AddPlayer(IPlayer player)
    {
        players.Add(player);
    }

    public void ProcessInformation()
    {
        Console.WriteLine(ToString());
    }

    public override string ToString()
    {
        StringBuilder info = new StringBuilder("Hand #: " + hand + " Date: " + date.ToLongDateString());
        info.Append("\nPlayers:");
        foreach (var s in players)
        {
            info.Append("\n"); 
            info.Append(s.Name);
        }
        return info.ToString();
    }
}

public class MySampleProvider1 : IDataProvider
{
    public IOnlinePokerInfo ParseFileInformation(FileInfo input)
    {
        MyOnlinePokerInfo info = new MyOnlinePokerInfo(1, DateTime.Now);
        IPlayer p = new MyPlayer("me");
        info.AddPlayer(p);
        return info;
    }
}

public class MySampleProvider2 : IDataProvider
{
    public IOnlinePokerInfo ParseFileInformation(FileInfo input)
    {
        MyOnlinePokerInfo info = new MyOnlinePokerInfo(2, DateTime.Now);
        IPlayer p = new MyPlayer("you");
        info.AddPlayer(p);
        return info;
    }
}

public class MyPlayer : IPlayer
{
    private string name;
    public string Name { get { return name; } set { name = value; } }

    public MyPlayer(string name)
    {
        this.name = name;
    }
}

public class OnlinePokerInfoManager
{
    static void Main(string[] args)
    {
        List<IOnlinePokerInfo> infos = new List<IOnlinePokerInfo>();

        MySampleProvider1 prov1 = new MySampleProvider1();
        infos.Add(prov1.ParseFileInformation(new FileInfo(@"c:\file1.txt")));

        MySampleProvider2 prov2 = new MySampleProvider2();
        infos.Add(prov2.ParseFileInformation(new FileInfo(@"c:\file2.log")));

        foreach (var m in infos)
        {
            m.ProcessInformation();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T16:02:54.803

听起来您需要策略模式，它允许您以多种不同的方式实现算法：

[http://en.wikipedia.org/wiki/Strategy_pattern](http://en.wikipedia.org/wiki/Strategy_pattern)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T01:39:09.057

您还可以考虑使用[命令模式](http://en.wikipedia.org/wiki/Command_pattern)，您可以在其中对需要处理的文件类型的到达时间进行操作。通过这种方式，您可以灵活地使用所有格式，并遵守您的流程所需的一致参数。

另一个好处是您可以为每种新文件格式创建新的操作，而无需为其他格式重构代码。

# java - 检测组件的 FocusEvent 是否丢失或获得

> ID：334397
> 
> 赞同：2
> 
> 时间：2008-12-02T15:47:59.750
> 
> 标签：java, swing, events, awt

我实现了一个 EventQueue 并在发送 AWTEvents 时收到通知。我等到 FocusEvent 的实例被发送到 dispatchEvent 方法。

FocusEvent 本身没有方法来询问组件的焦点是获得还是丢失。方法 paramString 返回一个放置信息的字符串，但我不想破解或解析字符串。一个 contains 调用可以给我答案，但返回的 String 不是常数，所以它将来可能会改变。

FocusEvent 的 paramString 方法如下：

```
 switch(id) {
      case FOCUS_GAINED:
          typeStr = "FOCUS_GAINED";
          break;
      case FOCUS_LOST:
          typeStr = "FOCUS_LOST";
          break;
      default:
          typeStr = "unknown type";
    }
    return typeStr + (temporary ? ",temporary" : ",permanent") +
        ",opposite=" + getOppositeComponent(); 
```

你知道这个问题的另一种解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T15:58:06.077

“evt.getID()”有什么问题？它返回`FOCUS_LOST`或`FOCUS_GAINED`？

# powershell - 交换 powershell：get-user 没有描述属性？

> ID：334404
> 
> 赞同：3
> 
> 时间：2008-12-02T15:48:58.483
> 
> 标签：powershell, active-directory, exchange-server-2007

当我`get-user|get-member`在带有交换插件的 powershell 中运行时，我注意到没有描述属性。

有谁知道它是否已重命名为其他名称或其他访问方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T17:45:23.913

如果您不想更改描述，这应该可以：

```
[PS] C:\>$ANR = "testuser@example.com"
[PS] C:\>$foo = [adsi]("LDAP://" + (get-user $ANR).DistinguishedName)
[PS] C:\>$foo.description
My Description 
```

如果您想编辑，您需要进一步进入 System.DirectoryServices 并查看如何将对象写回 AD。使用 quest 进行一些包装的另一个包可能会更简单。如果你想自己动手，有大量关于 Powershell 中的 AD 编程的博客。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T17:58:28.800

Exchange 本身提供了与 AD 的最小交互 - 本质上，它为您提供了一些 AD 内容，因为 AD 和 Exchange 是如此连接，但它不会尝试公开 AD 的所有功能。

查看 quest.com/powershell；那是一个加载项库（它是免费的），它有一个名为 Get-QADUser 的 cmdlet，它可以为您提供所需的东西 - 比使用 ADSI（这也是完全合法的你所追求的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T16:03:41.387

获取用户？你是说 quest cmdlet 套件中的 get-qaduser 吗？

如果是这样，我相信默认情况下不会检索所有属性。有一个 -Include 参数可让您指定要从 AD、IIRC 检索的其他属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-03T14:36:28.347

它在控制台上工作；但是在 CSV 文件中，它一直在附加

System.DirectoryServices.PropertyValueCollection

到每行的末尾而不是值

> $tmp =adsi $tmp.description bill

有任何想法吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-03T18:05:06.133

解决了..它只是 $tmp.description.value

# asp.net-mvc - 从哪里获得 Microsoft.Web.Mvc.dll

> ID：334408
> 
> 赞同：31
> 
> 时间：2008-12-02T15:49:40.697
> 
> 标签：asp.net-mvc

您从哪里获得 Microsoft.Web.Mvc.dll？我看到它包含在很多 ASP.NET MVC 开源项目中，但在安装了 ASP.NET MVC Beta 和 .NET 3.5 SP1 后它不在我的系统上。

在 codeplex.com 的 ASP.NET MVC Beta 源代码中，Microsoft.Web.Mvc.dll 由 MvcFutures 项目生成。每个人都在自己编译这个模块吗？

**编辑：**现在我知道它叫什么，我看到 Scott Gu 在他的发行说明中提到它的地方：[ASP.NET MVC Futures Assembly](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx#ten)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-02T15:56:22.337

这就是 MVC 期货项目。

MVC 1.0 期货：
[http ://aspnet.codeplex.com/releases/view/24471](http://aspnet.codeplex.com/releases/view/24471)

MVC 2 期货：
[http ://aspnet.codeplex.com/releases/view/41742](http://aspnet.codeplex.com/releases/view/41742)

MVC 3 期货：
[http ://aspnet.codeplex.com/releases/view/58781](http://aspnet.codeplex.com/releases/view/58781)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T09:49:27.210

看起来这是最终的 1.0 版本！

[ASP.NET MVC v1.0 期货](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)

应用程序，104K，3 月 12 日上传

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-13T13:17:21.520

以上页面已移至[http://aspnet.codeplex.com/releases/view/24471](http://aspnet.codeplex.com/releases/view/24471)。从那里下载 Data Annotations Model Binder 示例。然后编译它并构建它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-23T22:15:46.877

对于多年后可能仍在寻找这个的任何人（例如，像我一样恢复旧的源代码），现在有适用于各种版本的 MVC Futures 的 Nuget 包（它使您可以访问 Microsoft .Web.Mvc 命名空间）。

它们被富有想象力地命名，以它们所属的 MVC 版本命名：

*   Mvc2期货

*   Mvc3期货

*   Mvc4期货

...除了 MVC 5 一个，它被称为

*   Microsoft.AspNet.Mvc.Futures

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T15:51:36.200

IIRC，它已经构建并包含在内。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T03:21:19.583

对于 ASP.NET MVC RC1，新地址是 [http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=22359](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=22359)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-01T11:02:53.407

看看这个博客。它突出了 MVC 未来的领域

[http://msmvps.com/blogs/luisabreu/archive/tags/MVC/default.aspx](http://msmvps.com/blogs/luisabreu/archive/tags/MVC/default.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-12T16:32:42.020

您必须在[http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)下载 Data Annotations Model Binder Sample 。然后编译并构建项目。

# c# - C# decimal.compare 与 > 或 <

> ID：334415
> 
> 赞同：8
> 
> 时间：2008-12-02T15:51:17.247
> 
> 标签：c#, comparison

使用 decimal.compare 与仅使用 > 或 < 比较变量有什么好处？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T15:59:34.873

一方面，它使构建[`Comparison<decimal>`](http://msdn.microsoft.com/en-us/library/tfakywbh.aspx)委托实例变得非常容易：

```
Comparison<decimal> foo = decimal.Compare; 
```

这很方便传递给需要任意比较委托的东西。

如果您使用的语言不支持重载运算符，它也可能很有用。这就是建议您不要公开*仅*由运营商支持的功能的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T16:47:02.953

Decimal.Compare 返回一个有符号数，指示两个十进制值的相对值。一个典型的用途是排序。

>、>=、< 等运算符返回布尔值。

因此它们用于不同的场景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T15:58:47.123

在 CLI 中，十进制不是像 Int32、String 和其他类型那样的本机类型。我猜 C# 在幕后使用 Compare 来实现比较运算符。

此外，您可以将比较作为参数传递给排序例程，而无需创建委托，从而减少排序中的方法嵌套级别。

这是我头顶上的几件事。

# asp.net - 多个 ASP.Net 应用程序使用的通用代码

> ID：334418
> 
> 赞同：0
> 
> 时间：2008-12-02T15:52:15.420
> 
> 标签：asp.net, .net-2.0, code-reuse

设想：

假设我有四个非常相似的应用程序（即大部分功能是相同的，但它们的差异足以证明每个应用程序都是单独的应用程序）。

在它们之间重用通用功能代码的最佳方法是什么？COM+？网页服务？

一般来说，我通常只将代码放在一个单独的项目 (dll) 中，但无论何时更新，都必须为每个 ASP.Net 应用程序更新该文件，并且不确定是否有更好的方法它。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T15:59:54.670

如果可能，您可以创建一个包含 DLL 项目和许多 Web 应用程序或网站项目的 Visual Studio 解决方案。Web 项目将具有对 DLL 项目的“项目”类型引用，并且所有内容都将同时构建。然后，您可以根据需要为每个 Web 项目使用“发布”工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T15:58:58.090

如果所有应用程序都在同一个虚拟服务器上，请考虑将共享程序集放在 GAC 中。这使您可以在需要时区分版本，并将所有内容放在同一个地方作为奖励。缺点：此程序集在完全信任的情况下运行，您应该使用策略和 CAS 来确保外部不受信任程序集的信任杠杆点没有提升。您还需要了解 [AllowPartiallyTrustedCallers] 属性。

至于其他的选择，COM+，嗯，有点重量级。适合交易的东西。Web 服务对于数据量大的服务来说不是很好，但如果做得好，可以相当可维护。分享的越多，回报就越好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T16:00:42.390

您可以拥有您的项目，但不要将公共 dll 添加到项目引用中，而是将公共项目添加到所有解决方案中，然后添加对公共项目的引用。

这样，您可以在任意数量的解决方案上拥有一个项目，并且您的问题已解决；）

# java - 不同的WAR文件，共享资源

> ID：334425
> 
> 赞同：8
> 
> 时间：2008-12-02T15:54:36.240
> 
> 标签：java, javascript, css, deployment

假设您有几个应用程序共享相同的代码和大多数其他资源，但外观和感觉有些不同，一些标签发生了变化，等等（想想品牌）。如果每个 Web 应用程序都放在自己的 WAR 文件中，那么您将共享资源放在哪里？

我已经使用类路径来共享类和属性文件。但是 javascript 和 css 文件呢？最好的方法是创建和部署一个额外的 WAR 文件，将这些共享文件提供给任何其他需要它们的应用程序？

我还想到了一个构建脚本，它可以发挥一些魔力，并且从一个共同的来源喷出（稍微）不同的 WAR，但我不喜欢它，因为当您需要构建/测试/运行单个应用程序时，它只会使事情变得不必要地复杂化.

任何其他提示和技巧将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T15:57:56.280

您可以在同一个 EAR 中部署两个 WAR，并将公共资源放在 EAR 中。然后将适当的依赖项放在 web 应用程序的清单中，以链接到 ear 中的 jar 文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-17T18:11:36.567

我见过的用于此类产品线配置的策略是在使用[maven](http://maven.apache.org/)构建时使用 WAR[覆盖](http://maven.apache.org/plugins/maven-war-plugin/examples/war-overlay.html)。您定义一个包含通用内容的通用 WAR，并将其与包含特定内容的其他 WAR 覆盖，以便为每个应用程序生成不同的 WAR。如果您在不同的机器上部署 WAR 变体，此方法可能最有用。但我不确定我是否真的可以推荐这个。

如果您实际上覆盖了东西，请记住指定覆盖配置，因为否则覆盖顺序是不确定的。它甚至可能会随着 maven-war-plugin 升级而改变。（在我们的案例中确实如此。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T21:12:07.550

如果你不想走EAR路线，使用tomcat等；还有其他几种方法可以实现您想要的一致性。

如果您只想共享 js 和 css，请查看[pack:tag](http://sourceforge.net/projects/packtag)。您可以从 apache 服务器托管 .js 和 css，设置您的 httpd.conf 以便您的 webapps 可以调用它，然后使用您的应用程序战争中的 pack:tag - 一步完成 DRY 和压缩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T16:01:09.623

**更新**

是的，又是我。我实际上已经改变了主意（再次:)）。我目前正在尝试（在这里更谨慎）：

*   (Common)WAR：包含应用程序，常见的（大部分）+一些特定的东西
*   EAR1：CommonWAR + env1 的特定配置文件
*   EAR2：CommonWAR + env2 的特定配置文件

配置文件由 WAR 获取。它位于 EAR 类路径中，并且仅包含一个具有值的属性“应用程序”。然后，单个 WAR 将在适当的情况下使用此信息来区分两个应用程序（配置、样式表……）。

使用我的 EAR1 = CommonWAR + WAR1，EAR2 = CommonWAR + WAR2 的解决方案，如果不使用 Web url（例如使用 iText 生成的 PDF 文档中的图像），在 CommonWAR 中查找静态资源太困难或不可能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-03T08:53:53.750

感谢到目前为止的回复，但恐怕我忘了提到 WAR 将部署在彼此完全隔离的不同环境中。

因此，也许在实际应用程序旁边部署一个通用 WAR 是唯一的选择。我想我会选择以下内容：

*   WAR1, WAR2 包含特定于应用程序的内容
*   CommonWAR 包含常见的东西（不开玩笑）
*   EAR1：WAR1 + CommonWAR，部署在env1中
*   EAR2：WAR2 + CommonWAR，部署在env2中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-13T22:03:00.503

将你的 css 和 js 放在类路径中并使用 servlet 为它们提供服务怎么样？然后，您可以将公共资源构建为 jar，该 jar 甚至可以包含 servlet（如果您愿意，可以使用资源调度程序），war 文件可以包含 WEB-INF/lib 文件夹中的 jar 文件。

# language-agnostic - 文本中单词的自动拼写检查

> ID：334426
> 
> 赞同：2
> 
> 时间：2008-12-02T15:54:40.717
> 
> 标签：language-agnostic, text-editor, puzzle, spell-checking, text-processing

[编辑]简而言之：您将如何编写自动拼写检查器？这个想法是检查器从已知的良好来源（字典）构建一个单词列表，并在足够频繁使用时自动添加新单词。一段时间未使用的词应逐步淘汰。因此，如果我删除包含“Mungrohyperiofier”的场景的一部分，检查器应该记住它一段时间，当我在另一个场景中输入“Mung<Ctrl+Space>”时，它应该再次提供它。如果我不使用这个词，比如说，几天，它应该忘记它。

同时，我想避免在字典中添加拼写错误。[/EDIT]

我想为科幻故事写一个文本编辑器。编辑应该为当前故事中任何地方使用的任何单词提供单词补全。它只会提供故事的单个场景进行编辑（因此您可以轻松地移动场景）。

这意味着我有三套：

1.  所有其他场景中所有单词的集合
2.  在我开始编辑*之前*当前场景中的一组词
3.  当前编辑器中的单词集

我需要将这些集合存储在某个地方，因为每次都从头开始构建列表太昂贵了。我认为一个每行一个单词的简单纯文本文件就足够了。

当用户编辑场景时，我们有这些情况：

1.  她删了一个字。这个词在当前场景中的其他任何地方都没有使用。
2.  她打出一个新词
3.  她输入了一个已经存在的单词
4.  她输入了一个已经存在但打错字的单词
5.  她更正了第 2 组中一个单词的错字。
6.  她更正了第 1 组单词中的错字（即错字也在别处）。
7.  她删除了一个她打算再次使用的词。但是，删除后，该单词不再位于集合#1 和#3 中。

显而易见的策略是在保存场景时重建单词集，并从每个场景的单词列表文件中构建集#1。

所以我的问题是：是否有一个聪明的策略来保留不再使用的单词但仍然能够逐步淘汰拼写错误？如果可能的话，这个策略应该在后台运行，用户甚至不会注意到发生了什么（即我想避免必须抓住鼠标从菜单中选择“将单词添加到字典”）。

[编辑] 基于[悲伤的评论](https://stackoverflow.com/users/34329/grieve)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-03T08:49:53.150

所以你想写一个拼写检查器。这是[Peter Norvig 关于编写拼写校正器的论文](http://norvig.com/spell-correct.html)。它描述了一个简单而强大的拼写校正器。您可以使用本书已经写好的部分，以及语言模型的参考列表（比如来自免费词典）。我也会去现有的开源拼写检查器，例如[aspell](http://aspell.net/)和[hunspell](http://hunspell.sourceforge.net/)来获得一些想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T16:00:31.363

您应该使用的结构是 trie。尾部/后缀压缩将有助于记忆。您可以使用伪引用计数 GC 来跟踪使用情况。

对于实际节点，您可能只需要一个 32 位整数，21 位用于 unicode，其余用于各种其他标记和信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T21:20:52.463

Reminds me of what I have been told about garbage collecting in modern LISP implementations :

data when created is put in "pool 1",

when there is a need to garbage collect the garbage collector look in pool 1 for unused entries and remove them.

Then any remaining entry is moved to pool 2.

Pool 2 is examined only when there is a need to more memory than pool 1 can release.

Data from pool 2 that survive a garbage collection is put in pool 3 and ... so on.

The idea is to put dynamically the data in a pool corresponding to its lifetime...

# lotus-notes - 如何以编程方式确定 Domino 数据库的创建者？

> ID：334429
> 
> 赞同：1
> 
> 时间：2008-12-02T15:54:51.717
> 
> 标签：lotus-notes, lotus-domino

我正在使用内置的域目录数据库来列出特定 Domino 服务器上的所有数据库。我正在创建一个自定义视图来显示有关每个数据库的某些信息。我想要的是一个显示每个数据库的创建者的列。但是，如果域目录跟踪此信息，我找不到它。

域目录中是否有提供我无法找到的信息的字段？有没有其他方法可以找到这些信息并将其放入这个视图中？@DBlookup 和相关函数在列公式中不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T17:10:53.153

该信息不存储在目录中，也可能不存储在数据库中（它没有显示在任何属性选项卡上）。

您可能需要获取/编写服务器插件来监控数据库创建并将该数据存储在某处。然后，您需要考虑由 adminp/replication 创建的数据库 - 您的加载项可能会将它们视为由服务器创建的。

这个问题[在 1998 年的 R4/R5 论坛上](http://www-10.lotus.com/ldd/46dom.nsf/55c38d716d632d9b8525689b005ba1c0/bed18751bdad2d248525660a00716c2a?OpenDocument)也有人问过，没有得到答复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-28T22:17:31.037

有趣的问题。数据库没有这样的属性，但你可以挖掘一些线索。

新数据库：使用 NotesNoteCollection 并查找一些特定的设计元素（例如图标）并在 $UpdatedBy 字段中查找第一个元素。

新副本/来自模板：上述方法不起作用。它将从原始/模板返回信息，而不是当前数据库。在这种情况下，尝试使用 DB 的 Created 属性并在该日期之后检查用户足迹 - 在 ACL 日志中（他可能在复制后立即更改了 ACL）、新的设计元素（可能是新的视图、文件夹、代理......）或配置文件.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-10T03:31:42.803

弗兰蒂塞克所说的。查看日志存档（啊！）可能会告诉您是谁部署了它，但在运行良好的环境中，它不会是谁开发的。所有设计说明的 $UpdatedBy(0) 列表应该会给您一个好主意。问题在于，可能是几年前离开公司的人。:)

# spring - 集成 Spring Webflow 2 和 Apache Tiles

> ID：334431
> 
> 赞同：6
> 
> 时间：2008-12-02T15:55:14.070
> 
> 标签：spring, tiles, spring-webflow, tiles2

我最近开始升级一些应用程序以使用 Spring Webflow 2，并且我想利用 Webflow 2 附带的新 Ajax 功能。有人可以指导我学习将 Tiles 2 与 Spring Webflow 集成的教程（因为这显然是他们推荐什么）。我发现 Webflow 2 附带的文档在这方面完全没用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T04:28:58.190

这并不完全是指 ajax 功能，但它帮助我为常规流程设置了 apache tile 2：

[http://jee-bpel-soa.blogspot.com/2008/12/spring-web-flows-2-and-tiles.html](http://jee-bpel-soa.blogspot.com/2008/12/spring-web-flows-2-and-tiles.html)

链接上有更多详细信息，但您需要的核心是一个新的视图解析器：

```
<bean id="tilesViewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView" />
</bean>
<bean class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <property name="definitions" value="/WEB-INF/flows/main/main-tiles.xml" />
</bean> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-09T01:02:31.760

这就是我为使其与 webflow 2 和 tiles 2.0 一起工作所做的工作

```
<bean id="tilesConfigurer"
    class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <property name="definitions">
        <list>
            <value>/WEB-INF/tiles-defs/templates.xml</value>
        </list>
    </property>
</bean>

<bean id="urlMapping"
    class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="mappings">
        <props>
            <prop key="/flow/**/*.html">
                flowController
            </prop>
            <prop key="/**/*.html">viewController</prop>
        </props>
    </property>
    <property name="order" value="1" />
</bean>

<bean id="tilesViewResolver"
    class="org.springframework.web.servlet.view.UrlBasedViewResolver">
    <property name="viewClass"
        value="org.springframework.web.servlet.view.tiles2.TilesView" />
</bean>

<bean id="flowController"
    class="org.springframework.webflow.mvc.servlet.FlowController">
    <property name="flowExecutor" ref="flowExecutor" />
</bean>

<webflow:flow-executor id="flowExecutor"
    flow-registry="flowRegistry" />

<webflow:flow-registry id="flowRegistry" flow-builder-services="flowBuilderServices"
    base-path="/WEB-INF/flow/user">
    <webflow:flow-location path="/manage-users.xml" />
</webflow:flow-registry>

<webflow:flow-builder-services id="flowBuilderServices"
    view-factory-creator="viewFactoryCreator" />

<bean id="viewFactoryCreator"
    class="org.springframework.webflow.mvc.builder.MvcViewFactoryCreator">
    <property name="viewResolvers" ref="tilesViewResolver" />
</bean> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-23T15:45:21.400

它在文档中得到了完美的解释。所以，请不要再说它不是。

[http://static.springsource.org/spring-webflow/docs/2.0.x/reference/htmlsingle/spring-webflow-reference.html](http://static.springsource.org/spring-webflow/docs/2.0.x/reference/htmlsingle/spring-webflow-reference.html)

如何在春季使用瓷砖：10.5 查看分辨率（链接 + #spring-mvc-config-spring-view-resolution）

如何在春季使用 Ajax 与瓷砖：11.5：处理 Ajax 请求（链接 + #spring-js-ajax）

从这些链接中复制代码，您最终会得到如下内容：

使用 Tiles 的 webflow 配置：

```
 <!-- Plugs in a custom creator for Web Flow views -->
<webflow:flow-builder-services id="flowBuilderServices" view-factory-creator="mvcViewFactoryCreator" />

<!-- Configures Web Flow to use Tiles to create views for rendering; Tiles allows for applying consistent layouts to your views -->
<bean id="mvcViewFactoryCreator" class="org.springframework.webflow.mvc.builder.MvcViewFactoryCreator">
    <property name="viewResolvers" ref="tilesViewResolver" />
</bean> 
```

瓷砖的配置：

```
 <!-- Configures the Tiles layout system -->
<bean class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">
    <property name="definitions">
        <list>
            <value>/WEB-INF/views/layouts/page.xml</value>
            <value>/WEB-INF/views/layouts/table.xml</value>
            <value>/WEB-INF/views/globalViews.xml</value>
            <value>/WEB-INF/views/userViews.xml</value>
        </list>
    </property>
</bean> 
```

Tiles + Ajax 的配置：

```
 <!--
  - This bean configures the UrlBasedViewResolver, which resolves logical view names 
  - by delegating to the Tiles layout system. A view name to resolve is treated as
  - the name of a tiles definition.
  -->
<bean id="tilesViewResolver" class="org.springframework.js.ajax.AjaxUrlBasedViewResolver">
    <property name="viewClass" value="org.springframework.webflow.mvc.view.FlowAjaxTilesView" />
</bean> 
```

# c++ - C++ 构造函数中的异常消除

> ID：334439
> 
> 赞同：12
> 
> 时间：2008-12-02T15:57:15.440
> 
> 标签：c++, exception

我们最近遇到了将我们的 C++ 框架移植到运行 uClinux 的 ARM 平台的问题，该平台唯一支持供应商的编译器是 GCC 2.95.3。我们遇到的问题是异常非常不可靠，导致从根本没有被捕获到被不相关的线程（！）捕获。这似乎是一个记录在案的错误，即[here](http://gcc.gnu.org/ml/gcc/2003-08/msg01013.html)和[here](http://osdir.com/ml/lib.uclibc.general/2003-05/msg00121.html)。

经过深思熟虑，我们决定完全消除异常，因为我们已经到了异常对正在运行的应用程序造成很大损害的地步。现在主要关心的是如何管理构造函数失败的情况。

我们尝试过[惰性求值](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=264)，其中每个方法都能够实例化动态资源并返回一个状态值，但这意味着每个类方法都必须返回一个返回值，这会在代码中产生**很多**ifs 并且在方法中非常烦人这通常不会导致错误。

我们研究了添加一个静态*创建*方法，该方法返回一个指向已创建对象的指针，如果创建失败则返回 NULL，但这意味着我们不能再将对象存储在堆栈上，如果需要，仍然需要传递对状态值的引用对实际错误采取行动。

根据 Google 的 C++ Style Guide，他们[不使用异常](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Exceptions)，只在构造函数中做一些琐碎的工作，使用 init 方法进行非琐碎的工作（[在构造函数中做工作](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Doing_Work_in_Constructors)）。但是，我找不到任何关于他们在使用这种方法时如何处理构造错误的信息。

这里有没有人尝试过消除异常并想出一个很好的解决方案来处理施工失败？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-02T16:07:46.793

通常，对于堆栈上的对象，您最终会得到如下代码：

```
MyClassWithNoThrowConstructor foo;
if (foo.init(bar, baz, etc) != 0) {
    // error-handling code
} else {
    // phew, we got away with it. Now for the next object...
} 
```

这适用于堆上的对象。我假设您使用返回 NULL 而不是抛出的东西覆盖全局运算符 new，以节省您记住在任何地方都使用 nothrow new ：

```
MyClassWithNoThrowConstructor *foo = new MyClassWithNoThrowConstructor();
if (foo == NULL) {
    // out of memory handling code
} else if (foo->init(bar, baz, etc) != 0) {
    delete foo;
    // error-handling code
} else {
    // success, we can use foo
} 
```

显然，如果可能的话，使用智能指针来避免记住删除，但如果你的编译器不能正确支持异常，那么你可能无法获得 Boost 或 TR1。我不知道。

您还可能希望以不同的方式构造逻辑，或抽象组合的 new 和 init，以避免在处理多个对象时深度嵌套的“箭头代码”，并在两个失败案例之间共享错误处理。以上只是其最艰苦形式的基本逻辑。

在这两种情况下，构造函数都将所有内容设置为默认值（它可以接受一些参数，前提是它对这些参数所做的操作不可能失败，例如，如果它只是存储它们）。然后 init 方法可以完成真正的工作，这可能会失败，在这种情况下返回 0 成功或任何其他失败值。

您可能需要强制整个代码库中的每个 init 方法都以相同的方式报告错误：您*不*希望一些返回 0 成功或负错误代码，一些返回 0 成功或正错误代码，一些返回 bool，一些返回一个按值的对象，它具有解释故障的字段、一些设置全局 errno 等。

您或许可以快速查看一些在线 Symbian 类 API 文档。Symbian 无一例外地使用 C++：它确实有一种称为“离开”的机制，可以部分弥补这一点，但从构造函数中离开是无效的，因此在设计非失败构造函数和推迟失败方面存在相同的基本问题初始化例程的操作。当然，对于 Symbian，init 例程是允许离开的，因此调用者不需要我上面指出的错误处理代码，但在 C++ 构造函数和额外的 init 调用之间的拆分工作方面，它是相同的。

一般原则包括：

*   如果您的构造函数想要以可能失败的方式从某处获取值，请将其推迟到 init 并将值默认初始化在 ctor 中。
*   如果您的对象包含一个指针，请在 ctor 中将其设置为 null 并在 init 中“正确”设置它。
*   如果您的对象包含引用，请将其更改为（智能）指针，以便它可以以 null 开头，或者让调用者将值作为参数传递给构造函数，而不是在 ctor 中生成它。
*   如果你的构造函数有对象类型的成员，那么你很好。他们的ctors也不会抛出，所以以通常的方式在初始化列表中构造你的成员（和基类）是完全可以的。
*   确保跟踪设置的内容和未设置的内容，以便在 init 失败时析构函数起作用。
*   除了构造函数、析构函数和 init 之外的所有函数都可以假定 init 已成功，前提是您为您的类记录在 init 被调用并成功之前调用除 init 之外的任何方法是无效的。
*   您可以提供多个 init 函数，与构造函数不同，它们可以相互调用，就像为某些类提供多个构造函数一样。
*   您不能提供可能失败的隐式转换，因此如果您的代码当前依赖于引发异常的隐式转换，那么您必须重新设计。大多数运算符重载也是如此，因为它们的返回类型受到限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T17:43:27.020

您可以使用标志来跟踪构造函数是否失败。您可能已经有一个仅在构造函数成功时才有效的成员变量，例如

```
class MyClass
{
public:
    MyClass() : m_resource(NULL)
    {
        m_resource = GetResource();
    }
    bool IsValid() const
    {
        return m_resource != NULL;
    }
private:
    Resource * m_resource;
};

MyClass myobj;
if (!myobj.IsValid())
{
    // error handling goes here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T16:01:15.573

关于谷歌参考（你找不到他们如何处理构造函数中的错误）：

那部分的答案是，如果他们只在构造函数中做一些琐碎的工作，那么就没有错误。因为这项工作是微不足道的，所以他们非常有信心（我敢肯定，有彻底的测试支持）不会抛出异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T16:06:30.710

我想在很大程度上，这取决于通常发生什么类型的异常。我的假设是它们主要与资源相关。如果是这种情况，我以前在嵌入式 C 系统上使用的解决方案是在程序开始时分配/提交所有可能需要的资源。因此，我知道所有必需的资源在执行时而不是在运行期间都可用。这是一个贪婪的解决方案，可能会干扰与其他软件的互操作性，但对我来说效果很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T16:43:44.147

如果你真的不能使用异常，你也可以写一个构造宏来做 onebyone 一直建议的事情。所以你不会一直陷入*创建/初始化/if*循环的麻烦中，最重要的是，你永远不会忘记初始化一个对象。

```
struct error_type {
    explicit error_type(int code):code(code) { }

    operator bool() const {
        return code == 0;
    }

    int get_code() { return code; }
    int const code;
};

#define checked_construction(T, N, A) \
   T N; \
   if(error_type const& error = error_type(N.init A)) 
```

error_type 结构将反转条件，以便在 if 部分检查错误`else`。现在编写一个 init 函数，该函数`0`在成功或任何其他指示错误代码的值时返回。

```
struct i_can_fail {
    i_can_fail() {
        // constructor cannot fail
    } 

    int init(std::string p1, bool p2) {
        // init using the given parameters
        return 0; // successful
    } 
};

void do_something() {
    checked_construction(i_can_fail, name, ("hello", true)) {
        // alright. use it
        name.do_other_thing();
    } else {
        // handle failure
        std::cerr << "failure. error: " << error.get_code() << std::endl;
    }

    // name is still in scope. here is the common code
} 
```

您可以向 中添加其他功能`error_type`，例如查找代码含义的内容。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-12-02T16:07:08.727

如果构造函数只做一些琐碎的事情，比如初始化 POD 变量（并隐式调用其他琐碎的构造函数），那么它不可能失败。请参阅[C++ 常见问题解答](http://yosefk.com/c++fqa/ctors.html#fqa-10.17)；另请参阅[为什么不应该使用 C++ 异常](http://yosefk.com/c++fqa/exceptions.html#fqa-17.10)。

# version-control - Sourcesafe 从 Visual Studio 按标签获取

> ID：334452
> 
> 赞同：3
> 
> 时间：2008-12-02T15:59:38.773
> 
> 标签：version-control, visual-sourcesafe

我有一个 Visual Source Safe 存储库，我的一些（不是全部，唉！）我的版本是由标签标识的。我知道如何从命令行获取标签，但是：

我可以**从 Visual Studio 中**按标签获取吗？

我正在使用 Visual Studio 2003（在其他版本的 Visual Studio 中答案会有所不同吗？）。

谢谢。

PS。我希望尽快迁移到 Team Server。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T16:03:22.637

查看相关 sourcesafe 项目的历史记录，并包含标签。突出显示您想要的标签，然后单击“获取”。设置选项，点击确定，你就完成了！

编辑：请原谅我 AJ，我指的是从 Visual Source Safe 界面中对标签进行“获取”。

但是，假设您已在与 Visual Studio 相同的计算机上安装了 Visual Source Safe，那么这些相同的功能应该可用。转到工具 -> 选项 > 源代码管理并确保源代码管理插件设置为 Microsoft Visual SourceSafe。

有了它，您应该能够在解决方案资源管理器中右键单击项目或解决方案，选择查看历史记录，然后按照我之前的说明进行操作。

# java - 需要一种以编程方式检查 Windows 服务状态的方法

> ID：334471
> 
> 赞同：13
> 
> 时间：2008-12-02T16:04:19.887
> 
> 标签：java, command-line, windows-services

情况如下：

我被要求使用 InstallAnywhere 8，这是一种基于 Java 的安装程序 IDE，它允许启动和停止 Windows 服务，但没有内置方法来查询它们的状态。幸运的是，它允许您在 Java 中创建可以在安装过程中随时调用的自定义操作（通过我认为是相当复杂的 API）。

我只需要一些可以告诉我特定服务是启动还是停止的东西。

IDE 还允许调用批处理脚本，所以这也是一个选项，虽然一旦脚本运行，几乎没有办法验证它是否成功，所以我试图避免这种情况。

欢迎任何建议或批评。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-02T16:42:25.647

这就是我必须做的。它很丑陋，但效果很好。

```
String STATE_PREFIX = "STATE              : ";

String s = runProcess("sc query \""+serviceName+"\"");
// check that the temp string contains the status prefix
int ix = s.indexOf(STATE_PREFIX);
if (ix >= 0) {
  // compare status number to one of the states
  String stateStr = s.substring(ix+STATE_PREFIX.length(), ix+STATE_PREFIX.length() + 1);
  int state = Integer.parseInt(stateStr);
  switch(state) {
    case (1): // service stopped
      break;
    case (4): // service started
      break;
   }
} 
```

`runProcess`是一个私有方法，它将给定的字符串作为命令行进程运行并返回结果输出。正如我所说，丑陋，但有效。希望这可以帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-03T12:22:16.980

您可以即时创建一个小型 VBS，启动它并捕获它的返回码。

```
import java.io.File;
import java.io.FileWriter;

public class VBSUtils {
  private VBSUtils() {  }

  public static boolean isServiceRunning(String serviceName) {
    try {
        File file = File.createTempFile("realhowto",".vbs");
        file.deleteOnExit();
        FileWriter fw = new java.io.FileWriter(file);

        String vbs = "Set sh = CreateObject(\"Shell.Application\") \n"
                   + "If sh.IsServiceRunning(\""+ serviceName +"\") Then \n"
                   + "   wscript.Quit(1) \n"
                   + "End If \n"
                   + "wscript.Quit(0) \n";
        fw.write(vbs);
        fw.close();
        Process p = Runtime.getRuntime().exec("wscript " + file.getPath());
        p.waitFor();
        return (p.exitValue() == 1);
    }
    catch(Exception e){
        e.printStackTrace();
    }
    return false;
  }

  public static void main(String[] args){
    //
    // DEMO
    //
    String result = "";
    msgBox("Check if service 'Themes' is running (should be yes)");
    result = isServiceRunning("Themes") ? "" : " NOT ";
    msgBox("service 'Themes' is " + result + " running ");

    msgBox("Check if service 'foo' is running (should be no)");
    result = isServiceRunning("foo") ? "" : " NOT ";
    msgBox("service 'foo' is " + result + " running ");
  }

  public static void msgBox(String msg) {
    javax.swing.JOptionPane.showConfirmDialog((java.awt.Component)
       null, msg, "VBSUtils", javax.swing.JOptionPane.DEFAULT_OPTION);
  }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-22T11:23:50.067

根据其他答案，我构建了以下代码来检查 Windows 服务状态：

```
public void checkService() {
  String serviceName = "myService";  

  try {
    Process process = new ProcessBuilder("C:\\Windows\\System32\\sc.exe", "query" , serviceName ).start();
    InputStream is = process.getInputStream();
    InputStreamReader isr = new InputStreamReader(is);
    BufferedReader br = new BufferedReader(isr);

    String line;
    String scOutput = "";

    // Append the buffer lines into one string
    while ((line = br.readLine()) != null) {
        scOutput +=  line + "\n" ;
    }

    if (scOutput.contains("STATE")) {
        if (scOutput.contains("RUNNING")) {
            System.out.println("Service running");
        } else {
            System.out.println("Service stopped");
        }       
    } else {
        System.out.println("Unknown service");
    }
  } catch (IOException e) {
    e.printStackTrace();
  } 
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T16:24:48.537

我多年来一直在与安装程序打交道，诀窍是创建自己的 EXE 并在安装时调用它。这提供了很好的灵活性，例如在发生错误时显示精确的错误消息，并具有基于成功的返回值，以便您的安装程序知道发生了什么。

下面介绍如何启动、停止和查询 Windows 服务 (C++) 的状态：http: [//msdn.microsoft.com/en-us/library/ms684941](http://msdn.microsoft.com/en-us/library/ms684941(VS.85).aspx) (VS.85).aspx （VB 和 C# 提供类似的功能）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T17:47:03.127

过去我在 Java Service Wrapper 上遇到过一些运气。根据您的情况，您可能需要付费才能使用它。但它提供了一个干净的解决方案，支持 Java 并且可以在 InstallAnywhere 环境中使用（我认为）没有什么麻烦。这也将允许您在 Unix 机器上支持服务。

[http://wrapper.tanukisoftware.org/doc/english/download.jsp](http://wrapper.tanukisoftware.org/doc/english/download.jsp)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T19:12:57.260

在黑暗中拍摄，但请查看您的 Install Anywhere java 文档。

具体来说，

/javadoc/com/installshield/wizard/platform/win32/Win32Service.html

班上：

```
com.installshield.wizard.platform.win32
Interface Win32Service

All Superinterfaces:
    Service 
```

方法：

```
public NTServiceStatus queryNTServiceStatus(String name)
                                     throws ServiceException

    Calls the Win32 QueryServiceStatus to retrieve the status of the specified service. See the Win32 documentation for this API for more information.

    Parameters:
        name - The internal name of the service. 
    Throws:
        ServiceException 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-21T23:58:01.777

这是一个严格的 C#/P/Invoke 解决方案。

```
 /// <summary>
    /// Returns true if the specified service is running, or false if it is not present or not running.
    /// </summary>
    /// <param name="serviceName">Name of the service to check.</param>
    /// <returns>Returns true if the specified service is running, or false if it is not present or not running.</returns>
    static bool IsServiceRunning(string serviceName)
    {
        bool rVal = false;
        try
        {
            IntPtr smHandle = NativeMethods.OpenSCManager(null, null, NativeMethods.ServiceAccess.ENUMERATE_SERVICE);
            if (smHandle != IntPtr.Zero)
            {
                IntPtr svHandle = NativeMethods.OpenService(smHandle, serviceName, NativeMethods.ServiceAccess.ENUMERATE_SERVICE);
                if (svHandle != IntPtr.Zero)
                {
                    NativeMethods.SERVICE_STATUS servStat = new NativeMethods.SERVICE_STATUS();
                    if (NativeMethods.QueryServiceStatus(svHandle, servStat))
                    {
                        rVal = servStat.dwCurrentState == NativeMethods.ServiceState.Running;
                    }
                    NativeMethods.CloseServiceHandle(svHandle);
                }
                NativeMethods.CloseServiceHandle(smHandle);
            }
        }
        catch (System.Exception )
        {

        }
        return rVal;
    }

public static class NativeMethods
{
    [DllImport("AdvApi32")]
    public static extern IntPtr OpenSCManager(string machineName, string databaseName, ServiceAccess access);
    [DllImport("AdvApi32")]
    public static extern IntPtr OpenService(IntPtr serviceManagerHandle, string serviceName, ServiceAccess access);
    [DllImport("AdvApi32")]
    public static extern bool CloseServiceHandle(IntPtr serviceHandle);
    [DllImport("AdvApi32")]
    public static extern bool QueryServiceStatus(IntPtr serviceHandle, [Out] SERVICE_STATUS status);

    [Flags]
    public enum ServiceAccess : uint
    {
        ALL_ACCESS = 0xF003F,
        CREATE_SERVICE = 0x2,
        CONNECT = 0x1,
        ENUMERATE_SERVICE = 0x4,
        LOCK = 0x8,
        MODIFY_BOOT_CONFIG = 0x20,
        QUERY_LOCK_STATUS = 0x10,
        GENERIC_READ = 0x80000000,
        GENERIC_WRITE = 0x40000000,
        GENERIC_EXECUTE = 0x20000000,
        GENERIC_ALL = 0x10000000
    }

    public enum ServiceState
    {
        Stopped = 1,
        StopPending = 3,
        StartPending = 2,
        Running = 4,
        Paused = 7,
        PausePending =6,
        ContinuePending=5
    }

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    public class SERVICE_STATUS
    {
        public int dwServiceType;
        public ServiceState dwCurrentState;
        public int dwControlsAccepted;
        public int dwWin32ExitCode;
        public int dwServiceSpecificExitCode;
        public int dwCheckPoint;
        public int dwWaitHint;
    };
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-12-08T15:47:12.343

我对给定的解决方案进行了即兴创作，使其独立于语言环境。[正如Alejandro González 正确指出的那样，](https://stackoverflow.com/questions/334471/need-a-way-to-check-status-of-windows-service-programmatically/70277801#comment105877673_334632)比较字符串“RUNNING”在非英语语言环境的系统中不起作用。

我使用了**sc interrogate**并查找它返回的状态码。

主要是，服务可以有 3 种状态：-

1 - 不可用

```
[SC] OpenService FAILED 1060: The specified service does not exist as an installed service. 
```

2 - 不运行

```
([SC] ControlService FAILED 1062: The service has not been started) 
```

3 - 跑步

```
 TYPE               : 10  WIN32_OWN_PROCESS
    STATE              : 2  START_PENDING
                            (NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)
    WIN32_EXIT_CODE    : 0  (0x0)
    SERVICE_EXIT_CODE  : 0  (0x0)
    CHECKPOINT         : 0x0
    WAIT_HINT          : 0x7d0
    PID                : 21100code here 
```

所以在下面的代码中使用它们，给了我们想要的结果：-

```
public static void checkBackgroundService(String serviceName) {
    Process process;
    try {
        process = Runtime.getRuntime().exec("sc interrogate " + serviceName);
        Scanner reader = new Scanner(process.getInputStream(), "UTF-8");
        StringBuffer buffer = new StringBuffer();
        while (reader.hasNextLine()) {
            buffer.append(reader.nextLine());
        }
        System.out.println(buffer.toString());
            if (buffer.toString().contains("1060:")) {
                System.out.println("Specified Service does not exist");
            } else if (buffer.toString().contains("1062:")) {
                System.out.println("Specified Service is not started (not running)");
            } else {
                System.out.println("Specified Service is running");
            }
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-02T16:23:04.653

[在启动期间，使用File.deleteOnExit()](http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html#deleteOnExit())创建一个文件。

检查脚本中是否存在该文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-12T14:58:53.237

只需调用此方法即可检查服务的状态是否正在运行。

```
public boolean checkIfServiceRunning(String serviceName) {
    Process process;
    try {
      process = Runtime.getRuntime().exec("sc query " + serviceName);
      Scanner reader = new Scanner(process.getInputStream(), "UTF-8");
      while(reader.hasNextLine()) {
         if(reader.nextLine().contains("RUNNING")) {
           return true;
         }
      }
     } catch (IOException e) {
         e.printStackTrace();
     }            
     return false;
} 
```

# wcf - 使用多个合同运行 WCF ServiceHost

> ID：334472
> 
> 赞同：51
> 
> 时间：2008-12-02T16:04:21.900
> 
> 标签：wcf, self-hosting

使用单个合同运行 ServiceHost 可以正常工作，如下所示：

```
servicehost = new ServiceHost(typeof(MyService1));
servicehost.AddServiceEndpoint(typeof(IMyService1), new NetTcpBinding(), "net.tcp://127.0.0.1:800/MyApp/MyService1");
servicehost.Open(); 
```

现在我想添加第二份（第 3、第 4、...）合同。我的第一个猜测是添加更多这样的端点：

```
servicehost = new ServiceHost(typeof(MyService1));
servicehost.AddServiceEndpoint(typeof(IMyService1), new NetTcpBinding(), "net.tcp://127.0.0.1:800/MyApp/MyService1");
servicehost.AddServiceEndpoint(typeof(IMyService2), new NetTcpBinding(), "net.tcp://127.0.0.1:800/MyApp/MyService2");
servicehost.Open(); 
```

但是当然这不起作用，因为在创建 ServiceHost 时我可以将 MyService1 作为参数或 MyService2 传递 - 所以我可以向我的服务添加很多端点，但都必须使用相同的合同，因为我只能提供一种实现？
我觉得我错过了重点，在这里。当然必须有某种方法为我添加的每个端点合同提供实现，或者不？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-12-02T16:22:32.503

您需要在同一个类中实现这两个服务（接口）。

```
servicehost = new ServiceHost(typeof(WcfEntryPoint));
servicehost.Open(); 

public class WcfEntryPoint : IMyService1, IMyService2
{
    #region IMyService1
    #endregion

    #region IMyService2
    #endregion
} 
```

* * *

仅供参考：我经常使用部分类来使我的主机类代码更易于阅读：

```
// WcfEntryPoint.IMyService1.cs
public partial class WcfEntryPoint : IMyService1
{
    // IMyService1 methods
}

// WcfEntryPoint.IMyService2.cs
public partial class WcfEntryPoint : IMyService2
{
    // IMyService2 methods
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-08-17T16:39:37.370

我目前面临同样的问题，并决定使用下面的实现。我不确定拥有这么多服务合同是否存在任何性能问题，但在我的最终实施中，我可能会有大约 10-15 个服务合同，因此大约有 10-15 个 ServiceHost。

我将所有 WCF 服务托管在一个 Windows 服务中。

```
private void PublishWcfEndpoints()
{
    var mappings = new Dictionary<Type, Type>
    {
       {typeof (IAuthenticationService), typeof (AuthenticationService)},
       {typeof(IUserService), typeof(UserService)},
       {typeof(IClientService), typeof(ClientService)}
    };

    foreach (var type in mappings)
    {
        Type contractType = type.Key;
        Type implementationType = type.Value;

        ServiceHost serviceHost = new ServiceHost(implementationType);
        ServiceEndpoint endpoint = serviceHost.AddServiceEndpoint(contractType, ServiceHelper.GetDefaultBinding(),
                                                                  Properties.Settings.Default.ServiceUrl  + "/" + contractType.Name);
        endpoint.Behaviors.Add(new ServerSessionBehavior());

        ServiceDebugBehavior serviceDebugBehaviour =
            serviceHost.Description.Behaviors.Find<ServiceDebugBehavior>();
        serviceDebugBehaviour.IncludeExceptionDetailInFaults = true;

        log.DebugFormat("Published Service endpoint: {0}", Properties.Settings.Default.ServiceUrl);

        serviceHost.Open();
        serviceHosts.Add(serviceHost);
    }

} 
```

随意评论这种类型的设置，如果有任何问题，尤其是与性能相关的问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-03T17:37:34.113

该答案是对来自chilltemp的已接受答案中的评论的进一步回应。

山姆，你真的应该确定为什么你需要 10-50 份合同，并尝试找到另一种解决方案。我查看了 Juval Lowy 的 WCF 编码标准（可在[http://www.idesign.net/](http://www.idesign.net/)上找到）并找到以下参考资料：

> **3 服务合同** ... 4\. 避免与一名成员签订合同。5\. 争取每份服务合同有三到五名成员。6\. 每个服务合同的成员不得超过二十人。十二可能是实际极限。

他没有提到合同实施的限制（我可以找到），但我无法想象他将服务上的 50 份合同视为类似于最佳实践的任何东西。我发现一种行之有效的解决方案是将成员共享用于类似功能。

例如，如果您使用 WCF 服务对 2 个值执行数学运算，则服务端可能有 4 个成员：Add(x,y)、Subtract(x,y)、Multiply(x,y)、Divide(x ,y)。如果您将这些组合成一个更通用的成员并使用一个对象来传递所需的数据，您可以轻松地减少您的成员数量并提高可伸缩性。示例：PeformCalculation(obj) 其中 obj 具有 x、y 和操作（加、减、乘、除）属性。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-02-29T23:46:19.130

[我通过使用RoutingService](http://msdn.microsoft.com/en-us/library/system.servicemodel.routing.routingservice.aspx)类找到了解决此问题的另一种方法。每个合约仍然必须托管在它自己的`ServiceHost`，但可以有一个`RoutingService`坐在所有合约之上 - 并将它们呈现在一个统一的“端点”上。我还写了[一篇](http://www.codeproject.com/Articles/338174/Aggregating-Services-with-a-RoutingService)关于它的代码项目文章。示例代码也可以在[Bitbucket](https://bitbucket.org/m0sa/serviceaggregation)上找到。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-02T16:44:41.833

如果您对服务共享的合同感到满意，辣椒的答案将起作用。如果您希望将它们分开，请尝试以下操作：

```
host1 = new ServiceHost(typeof(MyService1));
host2 = new ServiceHost(typeof(MyService2));

host1.Open();
host2.Open();

public class MyService1 : IMyService1
{
    #region IMyService1
    #endregion
}

public class MyService2 : IMyService2
{
    #region IMyService2
    #endregion
} 
```

编辑：正如马特所发布的，这将需要每个服务/合同的多个端点

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-19T08:05:43.447

没有人记录端点。当使用多个（作为一个组，来自公共 url，例如 http）必须使用相同的绑定实例（而不是更多），即

您的样品：

```
servicehost = new ServiceHost(typeof(MyService1));
servicehost.AddServiceEndpoint(typeof(IMyService1), new NetTcpBinding(), "net.tcp://127.0.0.1:800/MyApp/MyService1");
servicehost.AddServiceEndpoint(typeof(IMyService2), new NetTcpBinding(), "net.tcp://127.0.0.1:800/MyApp/MyService2");
servicehost.Open(); 
```

应该只有一个 new Binding()，我在 http 上测试过。

```
servicehost = new ServiceHost(typeof(MyService1));
 BasicHttpBinding binding = new BasicHttpBinding();
servicehost.AddServiceEndpoint(typeof(IMyService1),binding , "http://127.0.0.1:800/MyApp/MyService1");
servicehost.AddServiceEndpoint(typeof(IMyService2), binding, "http://127.0.0.1:800/MyApp/MyService2");
servicehost.Open(); 
```

我完全同意部分类在少数文件中实现少数合同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-19T09:49:24.293

将其与基地址和下面的多个服务/合同分开呢？我现在不在开发机器后面，而是像：

[http://myserver/myservices/serviceA](http://myserver/myservices/serviceA)
[http://myserver/myservices/serviceB](http://myserver/myservices/serviceB)
[http://myserver/myservices/serviceC](http://myserver/myservices/serviceC)

每个服务都实现自己的 ServiceContract。

您可以更改
`public class WcfEntryPoint : IMyService1, IMyService2`
为
`public partial class WcfEntryPoint : IMyService1`
`public partial class WcfEntryPoint : IMyService2`

[例子](http://www.meineck.net/2008/04/wcf-hosting-multiple-wcf-services-as.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-15T16:38:26.800

我错过了什么，还是这里没有提到最简单的解决方案？最简单的解决方案是：不要为 Web 服务使用多个接口。

但这并不意味着您仍然可以将接口分开。这就是我们有接口继承的原因。

```
[ServiceContract]
public interface IMetaSomeObjectService : ISomeObjectService1, ISomeObjectService2
{
} 
```

Meta 接口继承自所有其他接口。

```
[ServiceContract]
public interface ISomeOjectService1
{
    [OperationContract]
    List<SomeOject> GetSomeObjects();
}

[ServiceContract]
public interface ISomeOjectService2
{
    [OperationContract]
    void DoSomethingElse();
} 
```

然后服务只有 Meta 接口。

```
public class SomeObjectService : IMetaSomeObjectService
{
   public List<SomeOject> GetSomeObjects()
   {
       // code here
   }

   public void DoSomethingElse()
   {
       // code here
   }
} 
```

# c# - 向 configsections 提供智能感知/xsd 验证

> ID：334473
> 
> 赞同：5
> 
> 时间：2008-12-02T16:04:25.690
> 
> 标签：c#, configuration, configsection

在一个小型 c# 项目中，我正在尝试创建一个简单的自定义配置部分。我按照[CodeProject: Unraveling the Mysteries of .NET 2.0 Configuration](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration.aspx)中的说明进行操作，一切运行良好……除了我没有在配置上获得 xsd 验证和智能感知这一事实。

我的配置如下所示。

```
<configuration>
 <configSections>
    <section name="pizza" type="TestConfig.Configuration.PizzaConfigurationSection, TestConfig.Configuration"/>
 </configSections>

 <pizza name="Margherita" timeToCook="00:10:00" price="15.12">
   <cook firstName="Nicola" lastName="Carrer" rank="7" />
   <toppings>
     <add name="Mozzarella" percentage="0.6" />
     <add name="Tomato sauce" percentage="0.28" />
     <add name="Oregano" percentage="0.02" />
     <add name="Mushrooms" percentage="0.1" />
   </toppings>
 </pizza>
</configuration> 
```

在这篇文章 ( [XSDExtractor](http://www.codeproject.com/KB/dotnet/extractxsdfromconfigsect.aspx) ) 中，我找到了一个为配置部分创建 xsd 文件的工具。它工作正常，即它为主要属性（例如“价格”）和单个元素（“厨师”）提供智能感知和验证。但是，我无法使其适用于收藏品（“浇头”）。

我的问题：

1.  是否有任何其他工具可以提供 xsd 生成 ConfigurationSection 类？
2.  有人在具有集合属性的 ConfigurationSection 上成功运行 XSDExtractor 吗？

非常感谢，尼古拉

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-13T12:51:37.720

我没有使用 XSDExtractor，但我强烈推荐的一种工具是[Configuration Section Designer](http://www.codeplex.com/csd)。它是一个 Visual Studio 插件，允许您以图形方式设计 .NET 配置部分并自动为它们生成所有必需的代码和架构定义 (XSD)。

# mysql - BNF 语法库？

> ID：334479
> 
> 赞同：26
> 
> 时间：2008-12-02T16:06:04.563
> 
> 标签：mysql, objective-c, grammar, bnf

有没有地方可以找到流行语言的 Backus–Naur 形式或 BNF 语法？每当我进行搜索时，我很少出现，但我认为它们必须在某个地方发布。我最感兴趣的是看到一个用于 Objective-C 和 MySQL 的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-02T16:20:00.293

您必须搜索用于创建语法的工具：“lex/yacc 语法”、“antlr 语法”“铁路图”

[http://www.antlr3.org/grammar/list.html](http://www.antlr3.org/grammar/list.html)

这是一些语法文件

## 目标-c

*   [http://www.omnigroup.com/mailman/archive/macosx-dev/2001-March/022979.html](http://www.omnigroup.com/mailman/archive/macosx-dev/2001-March/022979.html)

*   [http://www.cilinder.be/docs/next/NeXTStep/3.3/nd/Concepts/ObjectiveC/B_Grammar/Grammar.htmld/index.html](http://www.cilinder.be/docs/next/NeXTStep/3.3/nd/Concepts/ObjectiveC/B_Grammar/Grammar.htmld/index.html)

*   [https://github.com/pornel/objc2grammar](https://github.com/pornel/objc2grammar)

## Python

*   [http://www.python.org/dev/summary/2006-04-16_2006-04-30/#the-grammar-file-and-syntaxerrors](http://www.python.org/dev/summary/2006-04-16_2006-04-30/#the-grammar-file-and-syntaxerrors)

## javascript

*   [http://tomcopeland.blogs.com/EcmaScript.html](http://tomcopeland.blogs.com/EcmaScript.html)

*   [http://www.ccs.neu.edu/home/dherman/javascript/](http://www.ccs.neu.edu/home/dherman/javascript/)

## 红宝石

*   [http://www.ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/yacc.html](http://www.ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/yacc.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-02T16:11:52.680

[w:BNF#Language Grammars](http://en.wikipedia.org/wiki/Backus-Naur_form#Language_Grammers)有一些链接。

*   [SQL-92、SQL-99 和 SQL-2003 的 BNF 语法](http://savage.net.au/SQL/index.html)

我还找到了一个列出 Objective C 语法的[页面。](http://www.cocoadev.com/index.pl?TheMethodDefinitionAndTheSemicolon)

*   [Lex/Yacc Flex/Bison 的 Objective-C 语法](http://www.wodeveloper.com/omniLists/macosx-dev/2001/March/msg00807.html)
*   [Objective-C 语言参考手册](http://objc.toodarkpark.net/grammar.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-02T16:17:28.690

`mysql-server/sql/sql_yacc.y`FWIW ，MySQL 语法文件（

[此外，可以从dev.mysql.com](http://dev.mysql.com/downloads/mysql/5.1.html#source)下载整个 MySQL 服务器源的快照。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T16:39:48.927

IIRC，BNF 语法与 yacc/bison 想要作为真正烦人的输入的语法有足够的不同 :) 如果您打算将这些文件输入解析器生成器，您可能需要查找适当格式的文件。我记得曾一度看到过用于 Java、JavaScript 和 C++ 的此类文件。可能分别作为 Eclipse、Firefox 和 GCC 的一部分，但我无法确定。我假设您可以通过查找使用该语言的开源项目来找到几乎任何解析器输入文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-08-15T08:27:39.397

我也搜索了这个并收集了这个存储库

[http://slps.github.io/zoo/](http://slps.github.io/zoo/)

# sharepoint - SharePoint (MOSS 2007) 成功的表单身份验证重定向到计算机名称

> ID：334485
> 
> 赞同：2
> 
> 时间：2008-12-02T16:08:07.103
> 
> 标签：sharepoint, forms-authentication

我有一个为表单身份验证扩展的 SharePoint 网站。Active Directory 站点是`example.com`，表单身份验证站点是`forms.example.com`. 当我输入我的（表单）用户名/密码时，我被重定向（302）到机器名称（`moss-01`），如下所示：`http://moss-01/`. 如果我`http://forms.example.com/`在地址栏中输入，我会再次被重定向到`http://moss-01/`.

预期的行为是成功验证到表单站点：`http://forms.example.com/Pages/Default.aspx`

为什么我被重定向到机器名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T16:22:37.497

听起来您的区域和备用访问映射 (AAM) 有问题。

从这里开始：http: [//blogs.msdn.com/sharepoint/archive/2007/03/06/what-every-sharepoint-administrator-needs-to-know-about-alternate-access-mappings-part-1.aspx](http://blogs.msdn.com/sharepoint/archive/2007/03/06/what-every-sharepoint-administrator-needs-to-know-about-alternate-access-mappings-part-1.aspx)

# c# - 将 IHTMLDocument2.Script.InvokeMember() 返回的 COM 对象转换为有用的东西

> ID：334486
> 
> 赞同：3
> 
> 时间：2008-12-02T16:08:12.843
> 
> 标签：c#, .net, javascript, internet-explorer, pinvoke

我正在为 Internet Explorer 扩展使用 C#.NET 中的一些代码，该扩展在浏览器中调用 Javascript 并从 Javascript 调用中获取返回值。当 Javascript 返回一个原始类型或原始类型数组时，我得到了一些我可以处理的东西，但是当 Javascript 返回一个对象时，我得到一个不透明的 COM 对象。

如何获取 COM 对象的内容，或者有更好的方法从 C#.NET 调用 IE？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T02:57:10.070

[查看InvokeMember 文档](http://msdn.microsoft.com/en-us/library/be9zzz62.aspx)底部的注释。如果返回值是一个 javascript 对象，您将收到一个围绕 javascript 对象的 .NET 对象包装器。您将不得不使用反射来检查/调用底层 javascript 对象的成员。这很有意义，因为 javascript 是一种动态语言，而 C# 不是。

# javascript - jQuery .focus 实际上并不关注新创建的元素

> ID：334489
> 
> 赞同：13
> 
> 时间：2008-12-02T16:09:04.357
> 
> 标签：javascript, jquery, html, focus

假设我有这个标记：

```
<div id="content">
  <div id="firstP"><p>First paragraph</p></div>
  <div id="secondP"><p>Second paragraph</p></div>
  <div id="thirdP"><p>Third paragraph</p></div>
  <div id="fourthP"><p>Fourth paragraph</p></div>
</div> 
```

我想`<div>`用 jQuery 添加一个新元素并专注于这个新元素。`.focus`不做任何事情。

```
function addParagraph() {
  var html = "<div id=\"newP\"><p>New paragraph</p></div>";

  $("#content").append(html);
  $("#newP").focus();    
} 
```

知道为什么吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-08-31T21:38:50.010

我认为主要答案是不正确的。DIV 和 P 标签可以接收焦点，只要您为它们指定 tabindex 属性。IE

```
<div class="someclass" tabindex="100"> 
```

指定 tabindex 后，您可以使用选项卡切换到这些元素或使用*.focus()*转移焦点。

在这里使用 scrollTo 插件似乎有点矫枉过正。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-02T16:10:09.797

您的代码没有问题，只是**段落或div标签无法获得焦点**。只能将焦点放在您可以与之交互的事物上，例如链接、输入元素、文本区域等。

要将窗口滚动到这个新添加的元素，您可以使用[ScrollTo](http://plugins.jquery.com/project/ScrollTo)之类的插件。

附带说明一下，您的代码可以简化一点：

```
var html = "<div id=\"newP\"><p>New paragraph</p></div>";
$("#content").append(html);
$("#newP p").focus();

var html = "<div id=\"newP\"><p>New paragraph</p></div>";
$(html)
    .appendTo('#content')
    .focus()   // or scrollTo(), now...
; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-07-04T00:48:52.153

此代码将避免对其他插件的依赖，并允许您在任何元素上使用它。

```
$('html, body').animate({ scrollTop: $("#newP").offset().top }, 500); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-02T16:15:12.067

您需要使用 HTML 页面锚点而不是焦点。例子：

```
http://localhost/mypage.html#fourthP 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T16:11:22.010

我认为您正在寻找的是在 jQuery 中使用“ScrollTo”插件。你可以[在这里查看](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)。

您可以指定要滚动的内容...

```
$('div.pane').scrollTo(...);//all divs w/class pane 
```

或者只是滚动窗口：

```
$.scrollTo(...);//the plugin will take care of this 
```

有许多不同的方法来指定目标位置。这些是：

*   一个原始数字
*   一个字符串（'44'、'100px'、'+=30px'等）
*   一个 DOM 元素（逻辑上是可滚动元素的子元素）
*   一个选择器，将相对于可滚动元素
*   哈希 { top:x, left:y }, x 和 y 可以是任何类型的数字/字符串，如上。

**奖励：** 在挖掘这些信息时，我还发现[了 LocalScroll](http://flesler.blogspot.com/2007/10/jquerylocalscroll-10.html)和[SerialScroll](http://flesler.blogspot.com/2008/02/jqueryserialscroll.html)（动画从一个项目滚动到下一个项目）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T16:16:18.100

只有表单元素等才能获得焦点。如果您希望浏览器向下滚动到该特定段落，则使用 jQuery 没有“默认”方式，但在[jQuery.ScrollTo有一个插件，并且在](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)[Animated scroll with](http://www.learningjquery.com/2007/09/animated-scrolling-with-jquery-12)中解释了如何手动执行此操作的博客[jQuery](http://www.learningjquery.com/2007/09/animated-scrolling-with-jquery-12)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-02T16:18:18.330

代替

```
$("#newP").focus(); 
```

应该使用它：

```
window.location.href=window.location.href + "#newP"; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-04T10:21:31.217

您可以分配 tabidex，然后您可以将焦点设置到该元素

```
$('#table').attr("tabindex",1).focus(); 
```

这适用于无法自行获得焦点的 Div Table 等。

# windows - 在没有 MSI 文件的情况下卸载

> ID：334490
> 
> 赞同：52
> 
> 时间：2008-12-02T16:09:13.060
> 
> 标签：windows, windows-installer

我经常在尝试卸载软件包时遇到 Windows Installer 问题，但它抱怨说：

> 您尝试使用的功能位于不可用的网络资源上。

当原始 MSI 根本不可用时，是否有卸载此类软件包的已知方法？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-06-15T21:24:56.820

请注意，微软现在已经发布了一个官方工具来解决这些问题，而没有以前在 MSIZAP 中存在的问题。

*   Microsoft Fixit：[修复无法安装或卸载的程序问题](http://support.microsoft.com/mats/Program_Install_and_Uninstall)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-02T16:38:31.457

看一个名为的工具~~[MSIZap](http://support.microsoft.com/kb/290301)~~微软发布的。

* * *

**更新**：

**MsiZap.exe**已经被弃用了一段时间。所有最新版本的 Windows 都不支持它的使用，并且它被认为是使用非常**不安全的工具**。

我添加了一个指向更新的 Microsoft 支持工具的链接，该工具旨在清理安装，但此时此工具似乎已被弃用。我已经从评论部分删除了链接。

也许尝试在下面**[saschabeaumont 的](https://stackoverflow.com/questions/334490/uninstall-without-an-msi-file/11058378#11058378)**答案中链接到的工具。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-12T20:06:09.547

仅供参考，这篇文章解释了根本问题 [https://superuser.com/q/293542/245923](https://superuser.com/q/293542/245923)

您可以使用产品代码卸载它：

```
msiexec.exe /x {your-product-code-guid} 
```

您可以从 MSI 本身或您用于构建 MSI 的任何工具获取此代码。

请注意，当您卸载产品时，它使用缓存的 MSI，因为只有原始 MSI 知道如何自行卸载。当您使用产品代码时，它使用来自 C:\WINDOWS\Installer 的缓存 MSI。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-30T03:24:08.227

> ***更新，Stein Åsmul***：[**这里有一个完整的清理方法列表**](https://stackoverflow.com/questions/53876550/wix-custom-action-dialogbox-on-silent-uninstall-of-application/53876981#53876981)（推荐）。

* * *

**更新**：

~~[**这个更新的支持工具**](http://support2.microsoft.com/default.aspx?scid=kb;en-us;290301)~~**如果您有需要卸载的失效 MSI 软件包**，可以在最近的 Windows 版本上试用。*这个新工具似乎也已被弃用。*

也许尝试在**[saschabeaumont 的](https://stackoverflow.com/questions/334490/uninstall-without-an-msi-file/11058378#11058378)**答案中链接到的工具。

* * *

**请求原始源媒体不是正常或标准的 MSI 行为 - 它表明 MSI 包设计不当。**如果您在供应商 MSI 处遇到此问题，强烈建议您将问题报告给他们的支持团队。以下是对该问题的**更全面解释**：**[为什么 MSI 需要原始 .msi 文件才能继续卸载？](https://stackoverflow.com/questions/208530/why-does-msi-require-the-original-msi-file-to-proceed-with-an-uninstall/1189524#1189524)**

在大多数情况下，即使您没有 MSI 的原始安装数据库，也可以从**控制面板的****添加/删除程序中卸载 MSI 软件包 - 卸载是从系统文件夹****%SystemRoot中原始 MSI 的缓存副本运行的****%\Windows\Installer**（在某些情况下，此缓存的 MSI 可能会丢失，[**请参阅此处的第 12 节**](https://stackoverflow.com/questions/450027/uninstalling-an-msi-file-from-the-command-line-without-using-msiexec/1055933#1055933)了解潜在原因）。****[](https://stackoverflow.com/questions/450027/uninstalling-an-msi-file-from-the-command-line-without-using-msiexec/1055933#1055933)****

 ******较早版本的 MSI 往往会更频繁地触发此问题（要求原始安装介质）（当时的 Office），而旧版 MSI 文件仍然会导致只能使用~~**msizap.exe**工具~~（此工具已**弃用**、**过时**且不**再受支持**）。这个命令行工具（~~msizap.exe~~) 还有一个可用的 GUI (~~MSICUU2.exe~~)，这两个工具都已弃用（尝试上面列出的新清理工具的链接）。

仅作记录：如果您有权访问实际用于安装产品的**原始 MSI**，则可以使用它来运行卸载。它必须是**所使用的确切 MSI，**而不仅仅是一个类似的。每个 MSI 文件都有一个**唯一的包 guid**，因此 Windows 会知道它是否是正确的。

相关答案：

*   [wix - 静默卸载应用程序的自定义操作对话框](https://stackoverflow.com/questions/53876550/wix-custom-action-dialogbox-on-silent-uninstall-of-application/53876981#53876981)
*   [从命令行卸载 MSI 文件而不使用 msiexec](https://stackoverflow.com/questions/450027/uninstalling-an-msi-file-from-the-command-line-without-using-msiexec/1055933#1055933)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-02T16:36:08.950

你没有做一些疯狂的事情，比如去 C:\Windows\Installer\ 并删除那里的文件是吗？

MSI 文件的一个缺点是您需要完整的 MSI 文件才能卸载或修复应用程序。Windows 喜欢存储 MSI 的副本。它还将 MSI 文件从通用名称重命名为没有表（我可以找到）的 GUID，以将原始名称（例如：）映射`Office2010.msi`到新的 GUID，这样您的 PC 就会浪费很多 GB 的空间，而您不能删除。一台不到 1 年的机器可以轻松达到 8 GB（例如：我的）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T16:42:06.427

Microsoft 有一个 MSI 清理实用程序，~~*[Windows 安装程序清理实用程序](http://support.microsoft.com/kb/290301)*~~（**不推荐使用**的工具，**不受支持**且使用**不安全**- 也许可以尝试这个答案：[Uninstall without a MSI file](https://stackoverflow.com/questions/334490/uninstall-without-an-msi-file/11058378#11058378)）。

或者[CCleaner](http://www.ccleaner.com/)通常可以做到这一点

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-12-02T16:20:43.037

控制面板 --> 添加/删除程序？

**编辑：** 您的帖子没有提到使用添加删除程序来卸载应用程序，您说的是“Windows Installer”（MSIEXEC - 请参阅下面的链接），这不是一回事。

[http://msdn.microsoft.com/en-us/library/aa367988(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa367988(VS.85).aspx)

# .net - .NET 中非 CLS 兼容代码的后果是什么？

> ID：334496
> 
> 赞同：13
> 
> 时间：2008-12-02T16:11:06.957
> 
> 标签：.net, compiler-warnings, cls-compliant

对于我从 VB6 移植的应用程序，我有几个关于 CLS-Compliance 的令人讨厌的编译器警告，包括：

```
Name '_AnIdentifier' is not CLS-Compliant.
Type of parameter 'myType' is not CLS-Compliant. 
```

尽管如此，我的应用程序似乎在 COM 和托管客户端上运行良好。我已经看过几篇描述如何使代码符合 CLS 的文章，我可能会继续这样做以摆脱烦人的警告，但我很好奇不符合 CLS 的代码在实际中的缺点是什么条款？我还没有发现这种强加的限制是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-02T16:19:30.793

基本上，当与某些 .NET 语言一起使用时，您的类可能无法访问（或者可能表现得很奇怪，例如大的正数被视为负数）。我不能说它们可能是什么语言。

例如，我不认为需要一种语言来识别以下划线开头的标识符。C# 允许这样做，因此您在那里很安全，但对于其他语言，“_AnIdentifier”可能会被隐藏，或者具有系统生成的名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T16:44:39.510

当不符合 CLS 的代码被混淆时，我遇到了混淆工具生成不正确的混淆代码的问题。

# .net - 您是否使用 TestInitialize 或测试类构造函数来准备每个测试？为什么？

> ID：334515
> 
> 赞同：71
> 
> 时间：2008-12-02T16:15:26.590
> 
> 标签：.net, unit-testing, constructor

这个问题与使用 MSTest 在 Visual Studio 中进行单元测试有关（这很重要，因为 MSTest 的[执行顺序](http://blogs.msdn.com/nnaderi/archive/2007/02/17/explaining-execution-order.aspx)）。标记为 [TestInitialize] 的方法和测试类构造函数都将在每个测试方法之前运行。

所以，问题是，你倾向于在这些领域做什么？您是否避免在其中任何一个中进行某些活动？你的理由是什么：风格、技术、迷信？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2011-08-16T14:15:59.137

构造函数只是语言提供的一种结构。每个测试框架似乎都有自己的受控生命周期“初始化”。您可能只会在使用构造函数来改变您的本地人时遇到麻烦。

**MSTest：**您会为每个`TestMethod`. 这可能是唯一可以在构造函数、初始化程序或测试方法中改变本地变量而不影响其他测试方法的情况。

```
public class TestsForWhatever
{
    public TestsForWhatever()
    {
        // You get one of these per test method, yay!
    }

    [TestInitialize] 
    public void Initialize() 
    {
        // and one of these too! 
    }

    [TestMethod]
    public void AssertItDoesSomething() { }

    [TestMethod]
    public void AssertItDoesSomethingElse() { }
} 
```

**MSpec：**你只会得到一个你所有`Establish`的`Because`断言（`It`）。所以，不要在你的断言中改变你的本地人。并且不要依赖于基础上下文中本地人的突变（如果你使用它们）。

```
[Subject(typeof(Whatever))]
public class When_doing_whatever
{
    Establish context = () => 
    { 
        // one of these for all your Its
    };

    Because of = () => _subject.DoWhatever();

    It should_do_something;
    It should_do_something_else;
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-12-31T17:07:36.003

以下是我在 TestInitialize 中发现的一些优点。

*   一些环境变量（例如TestContext）在测试类被实例化之前是不可访问的。
*   可以通过标记基本 TestInitialize 方法抽象来要求使用派生类实现。
*   可以轻松地覆盖基本的 TestInitialize 方法，并确定是在派生的 impl 之前、之后还是根本不调用基本 impl。相反，如果您从基测试类派生测试类，则在无参数构造函数的情况下，无论您是否有意，都会调用基 ctor。
*   它的明确定义使意图清晰，并补充了 TestCleanup 方法。您可能会争辩说您可以为每个构造函数创建一个[析构](http://msdn.microsoft.com/en-us/library/66x5fx1b.aspx)函数，但不能保证 MS Test 会按您的预期处理析构函数。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-02-11T14:22:20.083

使用 TestInitialize() 或 ClassInitialize() 而不是测试类实例或静态构造函数的主要优点是其显式性质。它清楚地表明您正在测试之前进行一些设置。从长远来看，始终如一地这样做应该会提高可维护性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T21:06:47.050

我更喜欢使用该`[TestInitialize]`方法来执行被测试对象及其参数的实例化。如果需要实例化测试基类（通常是我创建或刷新存储库等的地方），我只在构造函数中执行工作。这有助于我将测试框架代码和测试代码在逻辑上和物理上分开。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-06-25T19:23:42.633

这个问题也被问到（稍后）[在 VS 测试框架中使用构造函数与 TestInitialize() 属性有什么区别？](https://stackoverflow.com/questions/3087028/whats-the-difference-between-using-the-constructor-in-vs-testing-framework-vs-t)

FWIW 我假设“类构造函数”是指[实例构造函数](http://msdn.microsoft.com/en-us/library/k6sa6h87(v=VS.71).aspx)（而不是[静态构造函数](http://msdn.microsoft.com/en-us/library/k9x6w0hc%28v=VS.71%29.aspx)）。

[我相信关于静态构造函数与ClassInitialize](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.classinitializeattribute.aspx)的问题同样可以问到您提出的相同问题...

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-07-23T21:46:05.250

我说除非你需要，否则使用构造函数`TestContext`。

1.  如果你能保持简单，为什么不呢。构造函数比魔法属性更简单。
2.  您可以`readonly`在测试初始化​​中使用 which 是一件大事，您想为测试准备不应该更改的东西（理想情况下，您准备的东西也是不可变的）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-02T16:18:16.397

您测试的对象不需要在 [TestInitialize] 方法中实例化。您可以在测试方法 [Test] 中测试对象的构造函数。

[TestInitialize] 中的对象可以是设置您的持久性存储或准备测试对象将在测试中使用的值。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-13T09:21:12.483

还有`async`另一个原因（在提出这个问题时不存在）`[TestInitialize]`。它允许您进行`async`设置操作（例如加载文件），这在构造函数中是不可能的：

```
 private string approver;        

        [TestInitialize]
        public async Task Initialize()
        {
            approver = await File.ReadAllTextAsync("approver.json");
        } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-10T15:38:42.467

这取决于场景。如果您有一个测试类，并且出于某种奇怪的原因需要在另一个测试类上创建它的实例，则需要使用构造函数。

否则测试初始化​​更适合这个概念。首先，与上面写的原因相同，第二个 MS 可以在该属性上引入更多功能，您将受益于它们，使用构造函数您将坚持下去。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-27T16:15:45.993

我希望有人仍然需要它。这是我的解决方案，如何对类构造函数进行单元测试。如果debuggingService 为空，我正在对类服务进行单元测试并抛出异常。

DebuggingStepTests 类构造函数

```
private readonly IDebuggingService debuggingService;

public string StepName { get; set; }

public DebuggingStep(IDebuggingService _debuggingService)
{
    _log.Starting();
    StepName = "DebuggingStep";

    debuggingService = _debuggingService 
        ?? throw new ArgumentException("DebuggingStep init failure due to => IDebuggingService null");
} 
```

单元测试看起来像这样

```
 [Fact]
public void TestDebuggingStepConstructorWhen_InitServiceIsNull_ResultArgumentException() 
{
    //Arrange
    var arrange = new Action(() => 
    {
        new DebuggingStep(null);
    });

    //Act

    //Arrange
    Assert.Throws<ArgumentException>(arrange);
} 
```

和实际结果： [![在此处输入图像描述](https://i.stack.imgur.com/ZAQJu.png)](https://i.stack.imgur.com/ZAQJu.png)

希望这对某人有帮助

# java - Java 字符串："String s = new String("silly");"

> ID：334518
> 
> 赞同：87
> 
> 时间：2008-12-02T16:16:24.060
> 
> 标签：java, string

我是一个学习 Java 的 C++ 人。我正在阅读有效的 Java，有些东西让我很困惑。它说永远不要写这样的代码：

```
String s = new String("silly"); 
```

因为它创建了不必要`String`的对象。但它应该这样写：

```
String s = "No longer silly"; 
```

到目前为止还不错......但是，鉴于这个类：

```
public final class CaseInsensitiveString {
    private String s;
    public CaseInsensitiveString(String s) {
        if (s == null) {
            throw new NullPointerException();
        }
        this.s = s;
    }
    :
    :
}

CaseInsensitiveString cis = new CaseInsensitiveString("Polish");
String s = "polish"; 
```

1.  为什么第一个语句没问题？难道不应该

    `CaseInsensitiveString cis = "Polish";`

2.  我该如何`CaseInsensitiveString`表现得像`String`上面的语句是可以的（有和没有扩展`String`）？是什么让 String 能够像这样传递文字是可以的？据我了解，Java 中没有“复制构造函数”的概念吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-12-02T16:21:18.073

`String`是语言的一个特殊的内置类。它只**适用**于你应该避免说的`String`班级

 **```
String s = new String("Polish"); 
```

因为文字`"Polish"`已经是 type `String`，并且您正在创建一个额外的不必要的对象。对于任何其他课程，说

```
CaseInsensitiveString cis = new CaseInsensitiveString("Polish"); 
```

是正确的（在这种情况下也是唯一的）要做的事情。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-12-02T16:26:05.273

我相信使用文字形式（即“foo”而不是 new String(“foo”)）的主要好处是所有字符串文字都被 VM 'interned'。换句话说，它被添加到池中，这样创建相同字符串的任何其他代码都将使用池化字符串，而不是创建新实例。

为了说明，下面的代码将打印第一行为 true，但为第二行打印 false：

```
System.out.println("foo" == "foo");
System.out.println(new String("bar") == new String("bar")); 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-12-02T16:36:23.613

字符串在 Java 中被特殊对待，它们是不可变的，因此通过引用计数来处理它们是安全的。

如果你写

```
String s = "Polish";
String t = "Polish"; 
```

那么 s 和 t 实际上是指同一个对象，并且 s==t 将返回 true，因为“==”表示对象读取“是同一个对象”（或者可以，无论如何，我不确定这是否是实际的语言规范或只是编译器实现的细节 - 所以依赖这个可能不安全）。

如果你写

```
String s = new String("Polish");
String t = new String("Polish"); 
```

然后 s!=t （因为您已经明确创建了一个新字符串）虽然 s.equals(t) 将返回 true （因为 string 将此行为添加到 equals ）。

你想写的东西，

```
CaseInsensitiveString cis = "Polish"; 
```

无法工作，因为您认为引号是对象的某种短路构造函数，而实际上这仅适用于普通的旧 java.lang.Strings。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2014-01-18T18:33:36.590

```
String s1="foo"; 
```

文字将进入池中， s1 将引用。

```
String s2="foo"; 
```

这次它将检查“foo”文字是否已在 StringPool 中可用或不存在，因此 s2 将引用相同的文字。

```
String s3=new String("foo"); 
```

“foo”字面量将首先在 StringPool 中创建，然后通过字符串 arg 构造函数创建字符串对象，即由于通过 new 运算符创建对象而在堆中创建“foo”，然后 s3 将引用它。

```
String s4=new String("foo"); 
```

和s3一样

所以`System.out.println(s1==s2);// **true** due to literal comparison.`

和`System.out.println(s3==s4);// **false** due to object`

比较（s3 和 s4 在堆的不同位置创建）

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-12-02T16:19:48.577

`String`s 在 Java 中是特殊的——它们是不可变的，并且字符串常量会自动转换为`String`对象。

您的`SomeStringClass cis = "value"`示例无法应用于任何其他类。

你也不能 extend `String`，因为它被声明为`final`，这意味着不允许子类化。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-05-10T05:33:17.033

回答您的问题的最佳方法是让您熟悉“字符串常量池”。在java中字符串对象是不可变的（即它们的值一旦被初始化就不能改变），所以当编辑一个字符串对象时，你最终会创建一个新的编辑字符串对象，而旧对象只是漂浮在一个特殊的内存中，称为“字符串”恒定池”。创建一个新的字符串对象

```
String s = "Hello"; 
```

只会在池中创建一个字符串对象，并且引用 s 将引用它，但是通过使用

```
String s = new String("Hello"); 
```

您创建了两个字符串对象：一个在池中，另一个在堆中。引用将引用堆中的对象。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-12-02T17:15:59.447

Java 字符串很有趣。看起来回复已经涵盖了一些有趣的观点。这是我的两分钱。

**字符串是不可变的（你永远不能改变它们）**

```
String x = "x";
x = "Y"; 
```

*   第一行将创建一个变量 x，其中包含字符串值“x”。JVM 会在它的字符串值池中查看“x”是否存在，如果存在，它会将变量 x 指向它，如果不存在，它将创建它然后进行赋值
*   第二行将删除对“x”的引用，并查看字符串值池中是否存在“Y”。如果它确实存在，它将分配它，如果它不存在，它将首先创建它然后分配。无论是否使用字符串值，都会回收字符串值池中的内存空间。

**字符串比较取决于您要比较的内容**

```
String a1 = new String("A");

String a2 = new String("A"); 
```

*   `a1`不等于`a2`
*   `a1`并且`a2`是对象引用
*   当显式声明字符串时，会创建新实例并且它们的引用将不同。

我认为你在尝试使用不区分大小写的类时走错了路。别管弦了。您真正关心的是如何显示或比较这些值。使用另一个类来格式化字符串或进行比较。

IE

```
TextUtility.compare(string 1, string 2) 
TextUtility.compareIgnoreCase(string 1, string 2)
TextUtility.camelHump(string 1) 
```

由于您正在组成课程，因此您可以让比较做您想做的事情 - 比较文本值。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-12-02T16:20:00.713

你不能。Java中双引号中的东西被编译器特别识别为字符串，不幸的是你不能覆盖它（或扩展`java.lang.String`- 它已声明`final`）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-03T05:24:46.183

> *- 我如何使 CaseInsensitiveString 表现得像 String 一样，所以上面的语句是好的（有和没有扩展 String）？是什么让 String 可以像这样传递文字？据我了解，Java 中没有“复制构造函数”的概念，对吧？*

从第一点就已经说得够多了。"Polish" 是字符串文字，不能分配给 CaseInsentiviveString 类。

现在关于**第二点**

尽管您无法创建新的文字，但您可以按照该书的第一项“类似”方法，因此以下陈述是正确的：

```
 // Lets test the insensitiveness
    CaseInsensitiveString cis5 = CaseInsensitiveString.valueOf("sOmEtHiNg");
    CaseInsensitiveString cis6 = CaseInsensitiveString.valueOf("SoMeThInG");

    assert cis5 == cis6;
    assert cis5.equals(cis6); 
```

这是代码。

```
C:\oreyes\samples\java\insensitive>type CaseInsensitiveString.java
import java.util.Map;
import java.util.HashMap;

public final class CaseInsensitiveString  {

    private static final Map<String,CaseInsensitiveString> innerPool 
                                = new HashMap<String,CaseInsensitiveString>();

    private final String s;

    // Effective Java Item 1: Consider providing static factory methods instead of constructors
    public static CaseInsensitiveString valueOf( String s ) {

        if ( s == null ) {
            return null;
        }
        String value = s.toLowerCase();

        if ( !CaseInsensitiveString.innerPool.containsKey( value ) ) {
             CaseInsensitiveString.innerPool.put( value , new CaseInsensitiveString( value ) );
         }

         return CaseInsensitiveString.innerPool.get( value );   
    }

    // Class constructor: This creates a new instance each time it is invoked.
    public CaseInsensitiveString(String s){
        if (s == null) {
            throw new NullPointerException();
         }         
         this.s = s.toLowerCase();
    }

    public boolean equals( Object other ) {
         if ( other instanceof CaseInsensitiveString ) {
              CaseInsensitiveString otherInstance = ( CaseInsensitiveString ) other;
             return this.s.equals( otherInstance.s );
         }

         return false;
    }

    public int hashCode(){
         return this.s.hashCode();
    } 
```

// 使用“assert”关键字测试类

```
 public static void main( String [] args ) {

        // Creating two different objects as in new String("Polish") == new String("Polish") is false
        CaseInsensitiveString cis1 = new CaseInsensitiveString("Polish");
        CaseInsensitiveString cis2 = new CaseInsensitiveString("Polish");

        // references cis1 and cis2 points to differents objects.
        // so the following is true
        assert cis1 !=  cis2;      // Yes they're different
        assert cis1.equals(cis2);  // Yes they're equals thanks to the equals method

        // Now let's try the valueOf idiom
        CaseInsensitiveString cis3 = CaseInsensitiveString.valueOf("Polish");
        CaseInsensitiveString cis4 = CaseInsensitiveString.valueOf("Polish");

        // References cis3 and cis4 points to same  object.
        // so the following is true
        assert cis3 == cis4;      // Yes they point to the same object
        assert cis3.equals(cis4); // and still equals.

        // Lets test the insensitiveness
        CaseInsensitiveString cis5 = CaseInsensitiveString.valueOf("sOmEtHiNg");
        CaseInsensitiveString cis6 = CaseInsensitiveString.valueOf("SoMeThInG");

        assert cis5 == cis6;
        assert cis5.equals(cis6);

        // Futhermore
        CaseInsensitiveString cis7 = CaseInsensitiveString.valueOf("SomethinG");
        CaseInsensitiveString cis8 = CaseInsensitiveString.valueOf("someThing");

        assert cis8 == cis5 && cis7 == cis6;
        assert cis7.equals(cis5) && cis6.equals(cis8);
    }

}

C:\oreyes\samples\java\insensitive>javac CaseInsensitiveString.java

C:\oreyes\samples\java\insensitive>java -ea CaseInsensitiveString

C:\oreyes\samples\java\insensitive> 
```

也就是说，创建一个 CaseInsensitiveString 对象的内部池，并从那里返回相应的实例。

这样，“==”操作符对于表示**相同值**的两个对象引用返回**true**。

 **当类似的对象被频繁使用并且创建成本昂贵时，这很有用。

字符串类文档指出该类使用[内部池](http://java.sun.com/javase/6/docs/api/java/lang/String.html#intern())

该类不完整，当我们尝试在实现 CharSequence 接口时遍历对象的内容时会出现一些有趣的问题，但这段代码足以说明如何应用 Book 中的项目。

重要的是要注意，通过使用*internalPool*对象，引用不会被释放，因此不会被垃圾回收，如果创建了很多对象，这可能会成为一个问题。

它适用于 String 类，因为它被密集使用并且池仅由“interned”对象组成。

它也适用于 Boolean 类，因为只有两个可能的值。

最后，这也是Integer 类中的*[valueOf(int)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Integer.html#valueOf%28int%29)*限制为 -128 到 127 个 int 值的原因。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-02T16:29:11.583

在您的第一个示例中，您正在创建一个“愚蠢”的字符串，然后将其作为参数传递给另一个字符串的复制构造函数，这会生成与第一个字符串相同的第二个字符串。由于 Java 字符串是不可变的（这经常会刺痛习惯 C 字符串的人），这是对资源的不必要浪费。您应该改用第二个示例，因为它跳过了几个不必要的步骤。

但是，字符串文字不是 CaseInsensitiveString ，因此您无法在上一个示例中执行您想要的操作。此外，没有办法像在 C++ 中那样重载强制转换运算符，因此实际上没有办法做你想做的事。您必须改为将其作为参数传递给您的类的构造函数。当然，我可能只是使用 String.toLowerCase() 并完成它。

此外，您的 CaseInsensitiveString 应该实现 CharSequence 接口以及可能的 Serializable 和 Comparable 接口。当然，如果你实现了 Comparable，你也应该重写 equals() 和 hashCode()。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-12-14T03:54:52.767

`CaseInsensitiveString`不是 a`String`虽然它包含一个`String`. 文字（`String`例如“示例”）只能分配给`String`.

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-05-04T21:08:53.970

仅仅因为你`String`的类中有这个词，并不意味着你得到了内置`String`类的所有特殊功能。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-02T16:21:36.810

CaseInsensitiveString 和 String 是不同的对象。你不能这样做：

```
CaseInsensitiveString cis = "Polish"; 
```

因为“波兰语”是一个字符串，而不是一个不区分大小写的字符串。如果 String 扩展了 CaseInsensitiveString String 那么你就可以了，但显然不是。

不要担心这里的结构，你不会制造不必要的物体。如果您查看构造函数的代码，它所做的只是存储对您传入的字符串的引用。没有创建任何额外的内容。

在 String s = new String("foobar") 的情况下，它正在做一些不同的事情。您首先创建文字字符串“foobar”，然后通过从中构造一个新字符串来创建它的副本。无需创建该副本。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-05-19T04:27:39.297

当他们说要写

```
String s = "Silly"; 
```

代替

```
String s = new String("Silly"); 
```

它们在创建 String 对象时是这样的，因为上述两个语句都创建了一个 String 对象，但是 new String() 版本创建了两个 String 对象：一个在堆中，另一个在字符串常量池中。因此使用更多的内存。

但是当你写

```
CaseInsensitiveString cis = new CaseInsensitiveString("Polish"); 
```

您不是在创建字符串，而是在创建 CaseInsensitiveString 类的对象。因此，您需要使用 new 运算符。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-05-24T18:12:23.277

If I understood it correctly, your question means why we cannot create an object by directly assigning it a value, lets not restrict it to a Wrapper of String class in java.

To answer that I would just say, purely Object Oriented Programming languages have some constructs and it says, that all the literals when written alone can be directly transformed into an object of the given type.

That precisely means, if the interpreter sees 3 it will be converted into an Integer object because integer is the type defined for such literals.

If the interpreter sees any thing in single quotes like 'a' it will directly create an object of type character, you do not need to specify it as the language defines the default object of type character for it.

Similarly if the interpreter sees something in "" it will be considered as an object of its default type i.e. string. This is some native code working in the background.

Thanks to MIT video lecture course 6.00 where I got the hint for this answer.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-02T16:22:56.933

在 Java 中，语法“text”创建类 java.lang.String 的实例。那作业：

```
String foo = "text"; 
```

是一个简单的赋值，不需要复制构造函数。

```
MyString bar = "text"; 
```

无论您做什么都是非法的，因为 MyString 类既不是 java.lang.String 也不是 java.lang.String 的超类。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-02T16:23:55.853

首先，您不能创建从 String 扩展的类，因为 String 是最终类。Java 管理字符串的方式与其他类不同，因此只有使用 String 才能做到

```
String s = "Polish"; 
```

但是对于你的类，你必须调用构造函数。所以，那个代码很好。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-02T16:51:10.963

在 JDK 的大多数版本中，这两个版本是相同的：

String s = new String("傻");

String s = "不再傻";

因为字符串是不可变的，编译器会维护一个字符串常量列表，如果你尝试创建一个新的，首先会检查字符串是否已经定义。如果是，则返回对现有不可变字符串的引用。

澄清一下-当您说“String s =”时，您正在定义一个占用堆栈空间的新变量-然后无论您说“不再愚蠢”还是 new String("silly") 都会发生完全相同的事情-一个新的常量字符串被编译到您的应用程序中，并且引用指向它。

我没有看到这里的区别。但是，对于您自己的类，它不是不可变的，这种行为是无关紧要的，您必须调用您的构造函数。

更新：我错了！基于否决票和附上的评论，我对此进行了测试并意识到我的理解是错误的 - new String("Silly") 确实创建了一个新字符串而不是重用现有字符串。我不清楚为什么会这样（有什么好处？）但代码胜于雄辩！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-07-14T21:00:12.923

String 是特殊类之一，您可以在其中创建它们而无需新的 Sring 部分

和

诠释 x = y;

或者

字符 c;

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-02T17:15:14.130

我只想补充一点，Java 有[Copy 构造函数](http://www.javapractices.com/topic/TopicAction.do?Id=12 "复制构造函数")......

嗯，这是一个普通的构造函数，其对象与参数类型相同。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-12-27T08:29:38.030

```
 String str1 = "foo"; 
 String str2 = "foo"; 
```

str1 和 str2 都属于同一个字符串对象，“foo”，b'coz Java 在 StringPool 中管理字符串，因此如果一个新变量引用同一个字符串，它不会创建另一个变量，而是分配存在于 StringPool 中的相同 alerady .

```
 String str1 = new String("foo"); 
 String str2 = new String("foo"); 
```

这里 str1 和 str2 都属于不同的对象，b'coz new String() 强制创建一个新的字符串对象。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-01-06T18:48:43.023

Java中的字符串是不可变的和区分大小写的，这是一个基本规律。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2015-06-15T22:29:45.953

Java 为您在代码中使用的每个字符串文字创建一个 String 对象。使用任何时间`""`，它与调用相同`new String()`。

字符串是复杂的数据，就像原始数据一样“行动”。字符串字面量实际上是对象，即使我们假装它们是原始字面量，`6, 6.0, 'c',`等等。所以字符串“字面量”`"text"`返回一个带有 value 的新 String 对象`char[] value = {'t','e','x','t}`。因此，调用

```
new String("text"); 
```

实际上类似于调用

```
new String(new String(new char[]{'t','e','x','t'})); 
```

希望从这里，您可以了解为什么您的教科书认为这是多余的。

作为参考，这里是String的实现：http: [//www.docjar.com/html/api/java/lang/String.java.html](http://www.docjar.com/html/api/java/lang/String.java.html)

这是一个有趣的阅读，可能会激发一些洞察力。对于初学者来说阅读和尝试理解也很棒，因为代码演示了非常专业且符合约定的代码。

另一个很好的参考是关于字符串的 Java 教程：http: [//docs.oracle.com/javase/tutorial/java/data/strings.html](http://docs.oracle.com/javase/tutorial/java/data/strings.html)

# ruby-on-rails - 通过 Ruby 或 Rails 的 LDAP

> ID：334519
> 
> 赞同：45
> 
> 时间：2008-12-02T16:17:00.313
> 
> 标签：ruby-on-rails, ruby, active-directory, ldap

我一直在尝试将 Rails 应用程序连接到 ActiveDirectory。我将在 AD 和数据库之间同步有关用户的数据，目前是 MySQL（但可能会变成 SQL Server 或 PostgreSQL）。

我已经检查了 activedirectory-ruby，它看起来确实有问题（对于 1.0 版本！？）。它包装了 Net::LDAP，所以我尝试使用它，但它非常接近 LDAP 的实际语法，而且我喜欢 ActiveDirectory-Ruby 的抽象，因为它的语法类似于 ActiveRecord。

目录服务器是否有优雅的 ORM 类型工具？更好的是，如果有某种用于 LDAP 的脚手架工具（用于用户、组、组织单位等的 CRUD）。然后我可以通过 Authlogic 快速将其与我现有的身份验证代码集成，并保持所有数据同步。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2011-04-16T03:46:21.777

[这是我与net-ldap](http://net-ldap.rubyforge.org/) gem 一起使用的示例代码，用于在我的工作中验证来自 ActiveDirectory 服务器的用户登录：

```
require 'net/ldap' # gem install net-ldap

def name_for_login( email, password )
  email = email[/\A\w+/].downcase  # Throw out the domain, if it was there
  email << "@mycompany.com"        # I only check people in my company
  ldap = Net::LDAP.new(
    host: 'ldap.mycompany.com',    # Thankfully this is a standard name
    auth: { method: :simple, email: email, password:password }
  )
  if ldap.bind
    # Yay, the login credentials were valid!
    # Get the user's full name and return it
    ldap.search(
      base:         "OU=Users,OU=Accounts,DC=mycompany,DC=com",
      filter:       Net::LDAP::Filter.eq( "mail", email ),
      attributes:   %w[ displayName ],
      return_result:true
    ).first.displayName.first
  end
end 
```

最后的`first.displayName.first`代码看起来有点傻，所以可能会从一些解释中受益：

*   [`Net::LDAP#search`](http://net-ldap.rubyforge.org/Net/LDAP.html#method-i-search)总是返回一个结果数组，即使你最终只匹配一个条目。第一次调用`first`查找与电子邮件地址匹配的第一个（并且可能是唯一的）条目。

*   搜索返回的返回值[`Net::LDAP::Entry`](http://net-ldap.rubyforge.org/Net/LDAP/Entry.html)方便您通过方法名访问属性，因此`some_entry.displayName`与`some_entry['displayName']`.

*   a 中的每个属性`Net::LDAP::Entry`始终是一个值数组，即使只有一个值存在。尽管让用户具有多个“displayName”值可能很愚蠢，但 LDAP 的通用性意味着它是可能的。最后的`first`调用将单字符串数组转换为用户全名的字符串。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-19T02:20:51.213

您是否尝试过查看这些：

[http://saush.wordpress.com/2006/07/18/rubyrails-user-authentication-with-microsoft-active-directory/](http://saush.wordpress.com/2006/07/18/rubyrails-user-authentication-with-microsoft-active-directory/)

[http://xaop.com/blog/2008/06/17/simple-windows-active-directory-ldap-authentication-with-rails/](http://xaop.com/blog/2008/06/17/simple-windows-active-directory-ldap-authentication-with-rails/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-22T20:43:20.950

这比真实的答案更轶事......

我在使用 Samba 和 OpenLDAP 服务器时也有类似的经历。我找不到真正做我想做的事的图书馆，所以我推出了自己的帮助类。

当我以“官方”方式创建用户时，我使用[ldapbrowser](http://www.mcs.anl.gov/~gawor/ldap/index.html)查看 Samba 填写了哪些字段，并且基本上复制了该字段。

唯一棘手/非标准的 LDAP 是我们拥有的疯狂密码加密：

用户密码：

```
"{MD5}" + Base64.encode64(Digest::MD5.digest(pass)) 
```

sambaNT密码：

```
OpenSSL::Digest::MD4.hexdigest(Iconv.iconv("UCS-2", "UTF-8", pass).join).upcase 
```

对于该`def authenticate(user, pass)`功能，我尝试使用他们的凭据让 LDAP 绑定到域，如果我发现异常则登录失败，否则让他们进入。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-01-20T19:09:21.893

抱歉，还不能发表评论……也许有人可以适当地重新定位。

@Phrogz's solution works well, but bind_simple (inside bind) raises an Net::LDAP::LdapError exception due to auth[:username] not being set as shown here:

[https://github.com/ruby-ldap/ruby-net-ldap/blob/master/lib/net/ldap.rb](https://github.com/ruby-ldap/ruby-net-ldap/blob/master/lib/net/ldap.rb)

The corrected replaces:

```
auth: { method: :simple, email: email, password:password } 
```

with:

```
auth: { method: :simple, username: email, password:password } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T21:16:03.030

我开始使用 ruby​​-activedirectory，甚至扩展/修复了一些东西，在 Github 中托管 judy-activedirectory。

在进行下一次迭代时，我发现 ActiveLdap 具有更好的代码库，我正在认真考虑切换到它。有没有人有这方面的亲身经历？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T21:20:47.143

你检查过thinkbot 的ldap-activerecord-gateway 吗？这可能是你需要考虑的事情......

[http://github.com/thoughtbot/ldap-activerecord-gateway/tree/master](http://github.com/thoughtbot/ldap-activerecord-gateway/tree/master)

# java - 你推荐哪个 JavaScript 库与 Java EE + Struts + iBatis 一起使用？

> ID：334520
> 
> 赞同：0
> 
> 时间：2008-12-02T16:17:02.217
> 
> 标签：java, javascript, struts, javascript-framework

您推荐哪个 JavaScript 库与 Java EE + Struts + iBatis 一起使用？诸如 Ext JS、Dojo 之类的可以轻松与 Struts 集成的框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T16:30:46.340

有一个框架应该与 Java 服务器/中间件很好地结合在一起，称为[JSON-RPC](http://oss.metaparadigm.com/jsonrpc/)

但是我从来没有使用过它，也不能保证它.. 除此之外我最喜欢的框架是*咳嗽* [jQuery](http://jquery.com/)

**仔细阅读后进行编辑**，JSON-RPC 并不是您正在寻找的东西.. 但它仍然可能对您有用；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T16:32:17.443

这是一篇关于[Dojo for Java Developers](http://www.ibm.com/developerworks/web/library/wa-aj-dojo/index.html?ca=dgr-lnxw16wa-aj-dojo&S_TACT=105AGX59&S_CMP=GRsitelnxw16)的好文章。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T17:24:09.493

您必须根据您对库的期望来选择 Javascript 库，而不是基于服务器库。典型的 JS 库（Ext JS、JQuery、Prototype、Dojo、YUI 等）在浏览器上工作，并且不依赖于服务器技术。

如果您正在寻找一种从 javascript 使用服务器 POJO 的方法，请查看[DWR](http://directwebremoting.org/)。这个库现在是 dojo 基础的一部分，但我已经轻松地将它与 jQuery 和 Prototype 一起使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T09:06:15.953

建议你选择 Struts 2。它内置了 dojo，还可以选择插入其他库，如原型、jquery、gwt、yui 等。

应该非常方便，因为您使用 Struts 作为 Web 层..

# exception - 有没有办法在 Java ME 中将堆栈跟踪打印到屏幕上？

> ID：334527
> 
> 赞同：4
> 
> 时间：2008-12-02T16:18:09.673
> 
> 标签：exception, exception-handling, java-me, mobile

我的代码如下所示，可以很好地显示消息，但无法找出任何方法来获取堆栈跟踪。

```
try {
    throw new RuntimeException("This is bad stuff!");
} catch (Exception e ) {
    mainForm.append("Exception: " + e.getMessage());
} 
```

调用 e.printStackTrace() 会将它发送到我找不到的地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T16:47:14.077

看到这篇文章： http: [//lwuit.blogspot.com/2008/12/redirecting-output-on-s60-devices.html](http://lwuit.blogspot.com/2008/12/redirecting-output-on-s60-devices.html)

太糟糕了，没有 System.setErr(PrintWriter) 或 Thread.getStackTrace()

我认为这个问题没有（通用）解决方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T11:35:00.880

不，你不能。堆栈跟踪总是打印到 System.err 并且在 CLDC 中没有办法将 System.err 重定向到其他地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-31T06:45:18.203

即使在 CLDC 1.1 中也不存在。希望 Sun 在未来的版本中包含错误重定向和输出流。日志记录/调试非常重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-06T14:13:49.880

我创建了一个工具，可用于在 CLDC 中记录正确的堆栈跟踪。[在http://jarrut.sourceforge.net](http://jarrut.sourceforge.net)上查看。它仍然很新，可能有一些粗糙的边缘，但它对我有用，我无法想象没有它来开发 MIDlet。使用它的最佳方法是将其与 microlog 结合使用。

# c# - 将 HTML 渲染为图像

> ID：334532
> 
> 赞同：11
> 
> 时间：2008-12-02T16:19:00.653
> 
> 标签：c#, asp.net, image

我正在根据动态输入和裁剪图像生成优惠券，我现在正在使用 ntml 和 css 显示优惠券，问题是，打印这已成为一个问题，因为打印时背景如何消失和其他问题，所以我认为最好的解决方案是能够基于 html 生成图像，或者设置某种接受字符串和图像的模板，并使用输入的图像作为背景生成图像并将优惠券信息在上面。

有什么可以做到这一点的吗？

这是针对 ASP.NET 3.5 C# 网站的！

提前致谢。

编辑：如果输出可以基于 HTML 输入，那就太好了，因为优惠券是通过使用 jQuery 操纵 DOM 并拖动东西来设计的，一切正常，只是在打印时（纸) 它有 z 索引问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-02T16:28:09.077

您可以做的是创建一个 aspx 页面，将响应类型更改为您想要的格式，然后将图像放入流中。我创建了一个执行类似操作的条形码生成器。排除生成图像的所有手续，您的 Page_Load 将如下所示：

```
Bitmap FinalBitmap = new Bitmap();
MemoryStream msStream = new MemoryStream();

strInputParameter == Request.Params("MagicParm").ToString()

// Magic code goes here to generate your bitmap image.
FinalBitmap.Save(msStream, ImageFormat.Png);

Response.Clear();
Response.ContentType = "image/png";

msStream.WriteTo(Response.OutputStream);

if ((FinalBitmap != null)) FinalBitmap.Dispose(); 
```

就是这样！然后，您在图像中要做的就是将 URL 设置为 RenderImage.aspx?MagicParm=WooHoo 或您需要的任何内容。这样你就可以让它渲染你想要指定的任何东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-04T00:23:09.583

您可以在 winforms 或控制台应用程序中使用 WebBrowser 控件将 html 呈现为位图。

这方面的一个例子可以在这里找到：http: [//www.wincustomize.com/articles.aspx?aid=136426 &c=1](http://www.wincustomize.com/articles.aspx?aid=136426&c=1)

上面的示例可以修改为在 ASP.Net 中运行，方法是创建一个新的 STAThread 并在其上执行 Application.Run 以启动一个新的消息循环。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-29T11:17:12.497

# PHP/Ruby 替代方案

如果您已经访问了这个问题并且实际上正在寻找可以在没有 Windows 的情况下运行的东西，您可以尝试使用 KHTML 库：[http ://wiki.goatpr0n.de/projects/khtmld](http://wiki.goatpr0n.de/projects/khtmld)

我承认该网站的名称很荒谬，但我可以向您保证它是真实的。其他相关页面有：sourceforge 页面[http://khtml2png.sourceforge.net/](http://khtml2png.sourceforge.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T16:27:34.100

试试[PDFSharp](http://www.pdfsharp.com) ...它不完全是“获取此 HTML 并制作 PDF”，但只需稍作改动，您就可以轻松地根据您用于制作 HTML 的信息制作 PDF。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-22T04:53:14.107

**仅标记的替代解决方案**

使用 SVG 和 XSLT 将 html 数据转换为可以渲染/保存/等的图像。

我承认，由于所有的坐标，起初让它工作很乏味，但一旦运行，就值得付出努力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T16:21:36.763

有一个非常强大的图像创建库，叫做[GD](http://www.boutell.com/gd/)，我经常在 PHP 中使用它。

我被引导相信这个库有一个 ASP 程序员可以使用的包装器。[试试这个](http://www.codeproject.com/KB/asp/GDLibraryWrapper.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-02T16:24:05.947

除非“其他问题”非常严重，否则您不能指示用户在打印时打开背景图像吗？

在任何情况下，我都会默认提供 PDF 而不是图像，因为它是用于打印的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-29T11:36:31.603

只需正确设置您的 css，以便您拥有一个针对打印介质的 css 文件。很容易保证优惠券始终清晰易读，而不必担心他们是否有背景图片。不必要地移动到图像没有任何意义，除非出于某种原因您不希望它是机器可读的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-05T17:19:10.173

我自己没有尝试过，但是您应该能够使用 WebBrowser 控件和从基本 Control 类继承的 DrawToBitmap() 方法将 HTML 呈现为图像。

更新：我自己试过这个，有一些警告。在显示控件之前，WebBrowser 控件似乎不会呈现网页，因此 WebBrowser 需要位于表单中，并且必须显示表单才能呈现 HTML 并引发 DocumentCompleted 事件。

# asp.net - 使用 Visual Studio 2005 调试 .asp 页面

> ID：334535
> 
> 赞同：1
> 
> 时间：2008-12-02T16:19:22.620
> 
> 标签：asp.net, asp-classic, migration

我正在将一个用经典 asp 制作的网站迁移到 asp.net，但 asp.net 开发服务器不处理 .asp 页面。

是否可以让它运行 .asp 页面？也许是.asp 的自定义httphandler？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T16:42:13.273

您是否在安装了 IIS 的情况下运行 Winxp？如果是这样，这就是我要做的：使用本地 IIS 在浏览器中点击 asp 页面，然后在 VS 中打开 ASP 页面所在的文件夹作为网站项目。转到“调试”菜单，选择“附加到进程”，然后查找在 IWAM_MACHINENAME 用户下运行的 dllhost.exe 进程。您还必须确保已设置虚拟目录以允许 ASP 服务器端调试。附加到该进程后，您可以像往常一样设置断点等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T16:22:28.430

上次我不得不调试 asp 页面时，我发现插入一堆 Response.Write() 更容易。如果您找不到在 VS 中执行此操作的方法，那么这可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T16:22:55.730

不幸的是，您将不得不使用传统的（或神秘的！）方法在 VS2005 中调试您的 asp 页面（即 alert()、response.write() 等）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T16:23:58.443

可能不是你想听的，但是vs2005不支持这个。它被重新添加到vs2008中。也许免费的 vs2008 express edtions 之一可能会让你摆脱这个困境？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-05T18:03:59.020

除了[patmortech](https://stackoverflow.com/users/19090/patmortech)提供的答案之外，我建议如果您正在测试一个混合技术站点，请附加到 aspnet_wp 以调试应用程序的 .NET 部分。如果您的应用程序使用第三方 ISAPI 过滤器，这也是如此。

Cassini 服务器仅适用于纯 .NET。

# java - 从 Taglet 访问 Java 注释

> ID：334551
> 
> 赞同：6
> 
> 时间：2008-12-02T16:21:37.607
> 
> 标签：java, annotations, javadoc, taglet

我正在做一个项目，我们有一些自定义 Taglet 类用于修改 Javadocs（例如链接到 SVN 中的源代码，添加引用）等等。我们想做的一件事是能够获取源中使用的注释并从中操作信息。

Taglet 接口似乎没有提供一种简单的方法来访问 Java 源代码中的注释。有人知道这是否可能吗？

我正在使用 JDK 1.5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T16:56:33.417

如果您的 taglet 是从标准 doclet 调用的，您可以访问其内部状态：

```
import com.sun.tools.doclets.standard.Standard;

ClassDoc currentcd = Standard.htmlDoclet.configuration.currentcd; 
```

我写了一个使用这种技术的 Taglet，但它肯定不漂亮 ;-)

# sql - 如何在 MS Access 2007 或 MS SQL Server 2005 中通过 SQL 将字段转换为行

> ID：334571
> 
> 赞同：3
> 
> 时间：2008-12-02T16:24:02.780
> 
> 标签：sql, sql-server, ms-access, pivot

我有一个旧版 MS Access 2007 表，其中包含 52 个字段（一年中的每周 1 个字段）代表历史销售数据（实际上加上一个字段）。我想将此数据库转换为更传统的时间/值列表。

有谁知道如何在不使用 52+ 显式参数编写查询的情况下做到这一点？

（如果MS SQL Server 2005下存在解决方案，我也可以导出/导入表）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T16:27:16.923

[使用 PIVOT 和 UNPIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28SQL.90%29.aspx)。

> `UNPIVOT``PIVOT`通过将列旋转为行来执行 的几乎相反的操作. 假设上一个示例中生成的表在数据库中存储为`pvt`，并且您希望将列标识符 `Emp1`、`Emp2`、`Emp3`、`Emp4`和轮换为`Emp5`与特定供应商对应的行值。这意味着您必须确定另外两个列。将包含您正在旋转的列值 ( `Emp1`, `Emp2`,...) `Employee`的列将被称为 ，而将保存当前位于正在旋转的列下的值的列将被称为 Orders。这些列对应于*pivot_column*和 *value_column*，分别在 Transact-SQL 定义中。这是查询。

```
--Create the table and insert values as portrayed in the previous example.
CREATE TABLE pvt (VendorID int, Emp1 int, Emp2 int,
Emp3 int, Emp4 int, Emp5 int)
GO
INSERT INTO pvt VALUES (1,4,3,5,4,4)
INSERT INTO pvt VALUES (2,4,1,5,5,5)
INSERT INTO pvt VALUES (3,4,3,5,4,4)
INSERT INTO pvt VALUES (4,4,2,5,5,4)
INSERT INTO pvt VALUES (5,5,1,5,5,5)
GO
--Unpivot the table.
SELECT VendorID, Employee, Orders
FROM 
   (SELECT VendorID, Emp1, Emp2, Emp3, Emp4, Emp5
   FROM pvt) p
UNPIVOT
   (Orders FOR Employee IN 
      (Emp1, Emp2, Emp3, Emp4, Emp5)
)AS unpvt
GO 
```

> 这是部分结果集。

```
VendorID   Employee   Orders
1      Emp1         4
1      Emp2         3
1      Emp3         5
1      Emp4         4
1      Emp5         4
2      Emp1         4
2      Emp2         1
2      Emp3         5
2      Emp4         5
2      Emp5         5
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T16:28:27.390

如上所述，UNPIVOT 运算符（如果可用）将执行此操作...如果此操作不可用，则 std SQL 方法是：

联合多个选择语句（每周一个），使用相同的列名别名为特定周的列别名

```
 Select 1 as week, Week1Val as value from Table
    UNION
  Select 2 as week, Week2Val as value from Table
    UNION
  Select 3 as week, Week3Val as value from Table
    UNION
 ... 
    UNION
  Select 52 as week, Week52Val as value from Table 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T16:36:13.787

无需导出到 SQL Server。在 Access 中，尝试 /View/PivotTable View 子菜单。（无论如何，它在我的 Access 2003 中。）我比 Excel 中的更喜欢它。

# linq - 你 ToList() 吗？

> ID：334579
> 
> 赞同：25
> 
> 时间：2008-12-02T16:26:02.043
> 
> 标签：linq, linq-to-sql

您是否有喜欢在处理 LINQ 查询结果时使用的默认类型？

默认情况下，LINQ 将返回一个`IEnumerable<>`或者可能是一个`IOrderedEnumerable<>`. 我们发现 a`List<>`通常对我们更有用，因此养成了在`ToList()`大多数时间查询我们的习惯，并且肯定`List<>`在我们的函数参数和返回值中使用。

唯一的例外是在 LINQ to SQL 中，调用`.ToList()`会`IEnumerable`过早地枚举。

我们也在广泛使用 WCF，它的默认集合类型是`System.Array`. 我们总是`System.Collections.Generic.List`在 VS2008 的服务参考设置对话框中将其更改为与我们代码库的其余部分保持一致。

你做什么工作？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-02T16:31:35.357

`ToList` *总是*立即评估序列 - 不仅仅是在 LINQ to SQL 中。如果你想要，那很好 - 但它并不总是合适的。

就个人而言，我会尽量避免声明您`List<T>`直接返回 - 通常`IList<T>`更合适，并允许您稍后更改为不同的实现。当然，有些操作只对`List<T>`自身指定……这种决定总是很棘手。

编辑：（我会把它放在评论中，但它太庞大了。）延迟执行允许您处理太大而无法放入内存的数据源。例如，如果您正在处理日志文件 - 将它们从一种格式转换为另一种格式，将它们上传到数据库中，计算一些统计数据或类似的东西 - 您很可能能够通过流式处理任意数量的数据，但你真的*不想*把所有的东西都吸进内存。对于您的特定应用程序，这可能不是问题，但需要牢记。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-03T14:48:32.740

我们有相同的场景 - WCF 与服务器通信，服务器使用 LINQtoSQL。

我们在从服务器请求对象时使用 .ToArray() ，因为客户端更改列表是“非法的”。（意思是，没有目的支持“.Add”、“.Remove”等）。

但是，虽然仍在服务器上，但我建议您将其保留为默认值（不是 IEnumerable，而是 IQueryable）。这样，如果您想根据某些条件进行更多过滤，则过滤**仍然**在 SQL 端，直到评估。

这是非常重要的一点，因为这意味着难以置信的性能增益或损失取决于您所做的事情。

例子：

```
// This is just an example... imagine this is on the server only. It's the
// basic method that gets the list of clients.
private IEnumerable<Client> GetClients()
{
    var result = MyDataContext.Clients;  

    return result.AsEnumerable();
}

// This method here is actually called by the user...
public Client[] GetClientsForLoggedInUser()
{
    var clients = GetClients().Where(client=> client.Owner == currentUser);

    return clients.ToArray();
} 
```

你看到那里发生了什么吗？“GetClients”方法将强制从数据库中下载所有“客户端”......然后在 GetClientsForLoogedInUser 方法中将发生 Where 子句以将其过滤掉。

现在，请注意细微的变化：

```
private IQueryable<Client> GetClients()
{
    var result = MyDataContext.Clients;  

    return result.AsQueryable();
} 
```

现在，在调用“.ToArray”之前不会进行实际的评估......并且 SQL 将进行过滤。好多了！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-03T15:11:41.523

正如 THE VENERABLE SKEET 所指出的，在 Linq-to-Objects 的情况下，`List<T>`从函数返回不如返回好。`IList<T>`但通常你仍然可以做得更好。如果您要返回的东西应该是不可变的，那么 IList 是一个糟糕的选择，因为它会邀请调用者添加或删除东西。

例如，有时您有一个返回 Linq 查询结果或用于`yield return`延迟生成列表的方法或属性，然后您意识到最好在第一次调用时将结果缓存在a`List<T>`然后返回缓存的版本。那时返回`IList`可能不是一个好主意，因为调用者可能会出于自己的目的修改列表，这将破坏您的缓存，使所有其他调用者都可以看到他们的更改。

最好返回`IEnumerable<T>`，所以他们所拥有的只是前向迭代。如果调用者想要快速随机访问，即他们希望他们可以使用 [] 通过索引访问，他们可以使用`ElementAt`Linq 定义的 ，以便它安静地嗅探`IList`并使用它（如果可用），如果没有，它会执行愚蠢的线性查找.

我用过`ToList`的一件事是当我有一个复杂的 Linq 表达式系统与`yield return`用于过滤或转换列表的自定义运算符混合时。在调试器中单步执行可能会非常混乱，因为它会跳来跳去进行延迟评估，所以我有时会临时将 ToList() 添加到几个地方，以便我可以更轻松地跟踪执行路径。（尽管如果您正在执行的事情有副作用，这可能会改变程序的含义。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T16:29:52.800

这取决于您是否需要修改集合。当我知道没有人会添加/删除项目时，我喜欢使用数组。当我需要排序/添加/删除项目时，我会使用列表。但是，通常我会尽可能地将其保留为 IEnumerable。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-04T04:09:50.063

如果您不需要 List<> 的附加功能，为什么不坚持使用 IQueryable<> ?!?!?! 最小公分母是最好的解决方案（尤其是当您看到蒂莫西的答案时）。

# registry - 是否存在与 HKey_Classes_Root\Record 等效的 HKEY_Current_User？

> ID：334603
> 
> 赞同：6
> 
> 时间：2008-12-02T16:33:12.730
> 
> 标签：registry

因为`HKey_Class_Root\CLSID`我找到了等价物，`HKey_Current_User\Software\Classes\CLSID`但在注册表中我没有在同一位置看到“记录”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-02T16:37:55.733

怎么样

> HKEY_CURRENT_USER\软件\类？

和

> HKEY_LOCAL_MACHINE\SOFTWARE\Classes

您在 HKEY_CLASSES_ROOT 中看到的实际上是这两个键的合并（这取决于您的权限，将创建在 HKEY_CLASSES_ROOT 下创建的这两个分支中的哪个新条目）。

# javascript - 谷歌赞助链接上的 Javascript URL 替换

> ID：334606
> 
> 赞同：2
> 
> 时间：2008-12-02T16:34:33.040
> 
> 标签：javascript, url

**谷歌 SERP“赞助商链接**”上的 URL 替换如何工作？

一些结果有一个附加到 onmousedown 事件的函数 rwt，但据我所知，赞助链接没有任何事件处理程序。它如何实现替换 href 的行为，并且仍然将您发送到长 /aclk?sa= 链接？

保存到本地文件后，javascript 神奇地破坏了我自己尝试将其分开的尝试。希望有人能给我一个攻击的起点。

只是其他一些观察。有一个正则表达式将 q= 部分从 URL 中截断，但我无法终生看到他们如何“重置” URL，以便对其进行跟踪。此外，替换只能在 Firefox 下正常工作。IE7 显示空白状态栏。Safari 和 Opera 显示了丑陋的 URL。

**- 更新 -**

谢谢你去卡尔，但我认为你第一次更接近。我想我根本没有解释清楚。我试图弄清楚 SERP 页面上的 javascript 是如何工作的。不是服务器端逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T16:43:50.057

我想我明白你在问什么，如果我不在基地，我很抱歉：

您确定您正在查看生成的源代码吗？我发现 Google 有时会呈现链接，然后在页面加载后添加一个 onclick 事件，该事件会在 onclick 事件期间重写 url。如果您单击一个链接（看起来未重写）然后返回搜索结果（通过单击浏览器上的“返回”）并将鼠标悬停在同一链接上，您可能会发现该链接现在在状态栏中被重写。

那有意义吗？

- 更新 -

我想我误解了你的问题......读完它，加上你的评论，我想我明白你在问什么。

所以我在 Google.com 上搜索了“java”，然后将鼠标悬停在顶部的“赞助商链接”上，就是这样： [http://www.google.com/aclk?sa=l&ai=C4qCHuoY1SYynAqSCM9C4_H7uvNYk_[snipped]](http://www.google.com/aclk?sa=l&ai=C4qCHuoY1SYynAqSCM9C4_H7uvNYk_[snipped]) 所以您想知道之后他们如何将您转移到正确的网址？如果这确实是问题，那么答案将是他们将有关该赞助链接的信息存储在他们的数据库中，并将该信息传递到搜索结果页面。当您单击链接时，您将被发送到“赞助链接”处理程序，该处理程序会查找在上面看到的长 url 中传递给它的信息，并将其跟踪为点击，然后查找生成的 URL 应该是，并将您重定向到那里。如果您要使用 Fiddler（用于 IE）之类的工具，您可能会更清楚地看到您所发生的事情。它类似于 TinyURL.com 的工作方式。我去那里，给它一个长网址，它吐出一个较短的网址。然后它将那个小代码与我输入的网址相关联。因此，例如，我输入了 google.com，它吐出了tinyurl.com/2tx。“2tx”将用于将我重定向到 google.com。

这一次我离目标更近了吗？我觉得好像我可能不是：-/

# java - 尝试使用 getBinaryStream() 从 DB 获取 blob 时出现“会话关闭”错误

> ID：334625
> 
> 赞同：1
> 
> 时间：2008-12-02T16:41:48.143
> 
> 标签：java, oracle, hibernate

我正在使用 Hibernate 3.1 和 Oracle 10 DB。blob 在 Hibernate 实体中定义为 @Lob @Basic @Column，对应于相关的 DB 表。错误 -java.sql.SQLException: Closed Connection- 似乎偶尔出现一次，而不是每次尝试从数据库中获取 blob。这似乎是一个休眠获取问题，所以我想指定要使用的获取类型 - 在这种情况下，EAGER 似乎是正确的 - 但是找不到任何方法来指定对象的 @Column 类型的获取类型（有为集合/“一对多”关系等做到这一点的方法）

非常感谢您的帮助，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T20:05:31.197

这是针对 Oracle 数据库的吗？

我不得不求助于 Hibernate 中的用户数据类型才能让它工作，但那是使用 Hibernate 3.0 对抗 Oracle 9 db。

有关此主题（包括用户数据类型）的详细讨论，请参见[http://www.hibernate.org/56.html](http://www.hibernate.org/56.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-09T21:55:51.653

我最近在使用 blob 的 Oracle 11g 数据库之上实现了一个休眠系统。它没有任何真正的魔力。

“会话关闭”休眠错误的标准原因是（不指出明显的）您的实体所附加的会话确实已关闭。

明确确定会话在何时何地被打开和关闭。如果您使用 AOP 或 spring 为您管理它，这可能并不完全明显。

此外，我很确定您需要一个打开的事务，或者至少需要一个关闭自动提交的数据库连接。

加雷斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-17T09:58:58.517

如果要指定获取策略，请使用：

```
@Basic(fetch = FetchType.LAZY) 
```

为您的会员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-08T22:20:25.910

设置系统属性 hibernate.jdbc.use_streams_for_binary=true 可能会有所帮助。

# c# - 如何摆脱checkedlistbox选择高亮效果？

> ID：334626
> 
> 赞同：15
> 
> 时间：2008-12-02T16:42:01.357
> 
> 标签：c#, winforms, checkedlistbox

当在选中列表框中单击一个项目时，它会突出显示。如何防止这种突出显示效果？

我可以连接到 SelectedIndexChanged 事件并清除选择，但突出显示仍然发生并且您会看到一个光点。事实上，如果您按住鼠标单击，在单击复选框区域后从不释放它，则选择会保持突出显示，直到您释放鼠标按钮。我基本上想完全摆脱这种突出效果。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-08T10:19:24.200

使用以下内容：

```
private void checkedListBox1__SelectedIndexChanged(object sender, EventArgs e)
        {
            checkedListBox1.ClearSelected();
        } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-02T16:54:51.970

除了你仍然得到虚线位之外，这将做到这一点。

```
this.checkedListBox1.SelectionMode = System.Windows.Forms.SelectionMode.None; 
```

尽管现在您无法单击复选框...所以您必须执行以下操作：

```
 private void checkedListBox1_Click(object sender, EventArgs e)
    {
        for (int i = 0; i < checkedListBox1.Items.Count; i++)
        {

          if (checkedListBox1.GetItemRectangle(i).Contains(checkedListBox1.PointToClient(MousePosition)))
          {
              switch (checkedListBox1.GetItemCheckState(i))
              {
                  case CheckState.Checked:
                      checkedListBox1.SetItemCheckState(i, CheckState.Unchecked);
                      break;
                  case CheckState.Indeterminate:
                  case CheckState.Unchecked:
                      checkedListBox1.SetItemCheckState(i, CheckState.Checked);
                       break;
              } 

          }

        }
    } 
```

如果这一切都不是你所追求的……你总是可以自己做一个。它是一个相当简单的控件。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-02-04T21:49:05.473

将 SelectionMode 设置为 None 有一些奇怪的问题，例如必须实现 Click 事件。您可以将 SelectionMode 设置为 single，然后创建一个仅使用 OnDrawItem 覆盖 CheckedListBox 的类。请注意，为了关闭选定的外观，您必须关闭 Selected 状态并将颜色设置为您想要的颜色。您可以像我在这里所做的那样从控件中获取原始颜色。这就是我想出的，应该让你开始让它看起来像你想要的那样。

```
public partial class EnhancedCheckedListBox : CheckedListBox
{
    /// <summary>Overrides the OnDrawItem for the CheckedListBox so that we can customize how the items are drawn.</summary>
    /// <param name="e">The System.Windows.Forms.DrawItemEventArgs object with the details</param>
    /// <remarks>A CheckedListBox can only have one item selected at a time and it's always the item in focus.
    /// So, don't draw an item as selected since the selection colors are hideous.  
    /// Just use the focus rect to indicate the selected item.</remarks>
    protected override void OnDrawItem(DrawItemEventArgs e)
    {
        Color foreColor = this.ForeColor;
        Color backColor = this.BackColor;

        DrawItemState s2 = e.State;

        //If the item is in focus, then it should always have the focus rect.
        //Sometimes it comes in with Focus and NoFocusRect.
        //This is annoying and the user can't tell where their focus is, so give it the rect.
        if ((s2 & DrawItemState.Focus) == DrawItemState.Focus)
        {
            s2 &= ~DrawItemState.NoFocusRect;
        }

        //Turn off the selected state.  Note that the color has to be overridden as well, but I just did that for all drawing since I want them to match.
        if ((s2 & DrawItemState.Selected) == DrawItemState.Selected)
        {
            s2 &= ~DrawItemState.Selected;

        }

        //Console.WriteLine("Draw " + e.Bounds + e.State + " --> " + s2);

        //Compile the new drawing args and let the base draw the item.
        DrawItemEventArgs e2 = new DrawItemEventArgs(e.Graphics, e.Font, e.Bounds, e.Index, s2, foreColor, backColor);
        base.OnDrawItem(e2);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-04T10:42:23.597

哦，酷添加将来自Hath的答案中的所有代码放在一个

```
 checkedListBox1_MouseMove(object sender, MouseEventArgs e) 
```

如果鼠标按钮位在开关中，则添加

```
case CheckState.Checked:
   if (e.Button == MouseButtons.Right)
   {
       checkedListBox1.SetItemCheckState(i, CheckState.Unchecked);
   }                     
   break; 
```

和

```
case CheckState.Unchecked:
   if (e.Button == MouseButtons.Left)
   {
       checkedListBox1.SetItemCheckState(i, CheckState.Checked);
   }
   break; 
```

它会在您按下左键移动鼠标时检查突出显示的项目，并用右键取消突出显示它们

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-19T12:54:10.223

我在这里给出答案有点晚了。无论如何，这将**取消选中所有**复选框并删除**突出显示**效果：

```
foreach (int i in clb.CheckedIndices)  //clb is your checkListBox
    clb.SetItemCheckState(i, CheckState.Unchecked);
clb.SelectionMode = System.Windows.Forms.SelectionMode.None;
clb.SelectionMode = System.Windows.Forms.SelectionMode.One; 
```

*   取消选中所有复选框
*   禁用 checkListBox 的选择
*   启用 checkListBox 的选择

# asp.net-mvc - 使用 jQuery 验证插件将多个值发送到 ASP.NET MVC 控制器操作？

> ID：334628
> 
> 赞同：2
> 
> 时间：2008-12-02T16:42:09.843
> 
> 标签：asp.net-mvc, jquery-plugins, jquery, jquery-validate

使用[jQuery Validation](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)插件和 AJAX，我如何验证输入（文本框）的内容，但将多个参数传递给控制器​​操作？

可以在[此处](http://weblogs.asp.net/cibrax/archive/2008/08/01/combining-jquery-validation-with-asp-net-mvc.aspx)找到使用插件通过 AJAX 传递单个值的绝妙示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T21:41:43.013

查看 jQuery Validation 的代码，似乎无法自定义发布数据。所以你必须坚持使用查询参数：

```
 <script type="text/javascript">
$(document).ready(function(){
  $("#form-sign-up").validate(
  {
    var param1 = $('#mytextbox').val();

    rules:
    {
        login:
        {
          required: true,
          remote: '<%=Url.Action("IsLoginAvailable", "Accounts") %>?param1=' + param1
        }
      }  
    });

});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T16:50:03.367

像这样的东西？

```
$(document).ready(function(){
  $("#form-sign-up").validate( {
    rules: {
      email: {
        required: true,
        email: true
      },
      surname: {
        required: true,
        surname: true
      }
    },
    messages: {
      email: {
        required: "Please provide an email",
        email: "Please provide a valid email"
      },
      surname: {
        required: "Please provide a surname",
        surname: "Please provide a valid surname"
      }
    }
  });
}); 
```

**编辑在**[这里](http://jquery.bassistance.de/validate/demo/)找到了一个大型演示

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T17:56:47.833

正确的脚本将是

远程：function() { var p = $j('#productName').val(); 返回 "../Product/LookupRevision?p=" + p; } 代替

远程：“../Product/LookupRevision”

# c# - 在资源管理器中打开文件夹并选择文件

> ID：334630
> 
> 赞同：168
> 
> 时间：2008-12-02T16:42:24.477
> 
> 标签：c#, explorer

我正在尝试在资源管理器中打开一个文件夹并选择一个文件。

以下代码产生一个文件未找到异常：

```
System.Diagnostics.Process.Start(
    "explorer.exe /select," 
    + listView1.SelectedItems[0].SubItems[1].Text + "\\" 
    + listView1.SelectedItems[0].Text); 
```

如何让这个命令在 C# 中执行？

* * *

## 回答 #1

> 赞同：370
> 
> 时间：2009-03-30T06:09:57.400

```
// suppose that we have a test.txt at E:\
string filePath = @"E:\test.txt";
if (!File.Exists(filePath))
{
    return;
}

// combine the arguments together
// it doesn't matter if there is a space after ','
string argument = "/select, \"" + filePath +"\"";

System.Diagnostics.Process.Start("explorer.exe", argument); 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-12-02T16:46:29.723

使用[此方法](http://msdn.microsoft.com/en-us/library/h6ak8zt5.aspx)：

```
Process.Start(String, String) 
```

第一个参数是应用程序（explorer.exe），第二个方法参数是您运行的应用程序的参数。

例如：

在 CMD 中：

```
explorer.exe -p 
```

在 C# 中：

```
Process.Start("explorer.exe", "-p") 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-03-28T09:38:45.323

如果您的路径包含逗号，则在使用 Process.Start(ProcessStartInfo) 时，在路径周围加上引号将起作用。

但是，在使用 Process.Start(string, string) 时它将不起作用。看起来 Process.Start(string, string) 实际上删除了参数中的引号。

这是一个对我有用的简单示例。

```
string p = @"C:\tmp\this path contains spaces, and,commas\target.txt";
string args = string.Format("/e, /select, \"{0}\"", p);

ProcessStartInfo info = new ProcessStartInfo();
info.FileName = "explorer";
info.Arguments = args;
Process.Start(info); 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2010-10-03T23:05:36.990

只是我的 2 美分，如果你的文件名包含空格，即“c:\My File Contains Spaces.txt”，你需要用引号将文件名括起来，否则资源管理器会认为其他词是不同的参数......

```
string argument = "/select, \"" + filePath +"\""; 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2016-09-10T15:08:39.387

奇怪的是，与参数一起使用`Process.Start`on仅适用于长度小于 120 个字符的路径。`explorer.exe``/select`

我必须使用本机 Windows 方法才能使其在所有情况下都能正常工作：

```
[DllImport("shell32.dll", SetLastError = true)]
public static extern int SHOpenFolderAndSelectItems(IntPtr pidlFolder, uint cidl, [In, MarshalAs(UnmanagedType.LPArray)] IntPtr[] apidl, uint dwFlags);

[DllImport("shell32.dll", SetLastError = true)]
public static extern void SHParseDisplayName([MarshalAs(UnmanagedType.LPWStr)] string name, IntPtr bindingContext, [Out] out IntPtr pidl, uint sfgaoIn, [Out] out uint psfgaoOut);

public static void OpenFolderAndSelectItem(string folderPath, string file)
{
    IntPtr nativeFolder;
    uint psfgaoOut;
    SHParseDisplayName(folderPath, IntPtr.Zero, out nativeFolder, 0, out psfgaoOut);

    if (nativeFolder == IntPtr.Zero)
    {
        // Log error, can't find folder
        return;
    }

    IntPtr nativeFile;
    SHParseDisplayName(Path.Combine(folderPath, file), IntPtr.Zero, out nativeFile, 0, out psfgaoOut);

    IntPtr[] fileArray;
    if (nativeFile == IntPtr.Zero)
    {
        // Open the folder without the file selected if we can't find the file
        fileArray = new IntPtr[0];
    }
    else
    {
        fileArray = new IntPtr[] { nativeFile };
    }

    SHOpenFolderAndSelectItems(nativeFolder, (uint)fileArray.Length, fileArray, 0);

    Marshal.FreeCoTaskMem(nativeFolder);
    if (nativeFile != IntPtr.Zero)
    {
        Marshal.FreeCoTaskMem(nativeFile);
    }
} 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2012-01-30T05:41:29.587

Samuel Yang 的回答让我大吃一惊，这是我的 3 美分。

Adrian Hum 是对的，请确保在文件名周围加上引号。不是因为它不能像 zourtney 指出的那样处理空格，而是因为它将文件名中的逗号（可能还有其他字符）识别为单独的参数。所以它应该看起来像 Adrian Hum 建议的那样。

```
string argument = "/select, \"" + filePath +"\""; 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-02-13T06:28:52.560

使用“/select,c:\file.txt”

注意 /select 后面应该有一个逗号而不是空格。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-11-08T14:55:03.427

它找不到文件的最可能原因是路径中有空格。例如，它不会找到“explorer /select,c:\space space\space.txt”。

只需在路径前后添加双引号，例如；

```
explorer /select,"c:\space space\space.txt" 
```

或在 C# 中使用

```
System.Diagnostics.Process.Start("explorer.exe","/select,\"c:\space space\space.txt\""); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-12-02T16:46:25.577

您需要将要传递的参数（“/select 等”）放在 Start 方法的第二个参数中。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-03-05T17:21:18.487

```
string windir = Environment.GetEnvironmentVariable("windir");
if (string.IsNullOrEmpty(windir.Trim())) {
    windir = "C:\\Windows\\";
}
if (!windir.EndsWith("\\")) {
    windir += "\\";
}    

FileInfo fileToLocate = null;
fileToLocate = new FileInfo("C:\\Temp\\myfile.txt");

ProcessStartInfo pi = new ProcessStartInfo(windir + "explorer.exe");
pi.Arguments = "/select, \"" + fileToLocate.FullName + "\"";
pi.WindowStyle = ProcessWindowStyle.Normal;
pi.WorkingDirectory = windir;

//Start Process
Process.Start(pi) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-04-23T17:45:01.237

这可能有点矫枉过正，但我​​喜欢便利功能，所以拿这个：

```
 public static void ShowFileInExplorer(FileInfo file) {
        StartProcess("explorer.exe", null, "/select, "+file.FullName.Quote());
    }
    public static Process StartProcess(FileInfo file, params string[] args) => StartProcess(file.FullName, file.DirectoryName, args);
    public static Process StartProcess(string file, string workDir = null, params string[] args) {
        ProcessStartInfo proc = new ProcessStartInfo();
        proc.FileName = file;
        proc.Arguments = string.Join(" ", args);
        Logger.Debug(proc.FileName, proc.Arguments); // Replace with your logging function
        if (workDir != null) {
            proc.WorkingDirectory = workDir;
            Logger.Debug("WorkingDirectory:", proc.WorkingDirectory); // Replace with your logging function
        }
        return Process.Start(proc);
    } 
```

这是我用作 <string>.Quote() 的扩展函数：

```
static class Extensions
{
    public static string Quote(this string text)
    {
        return SurroundWith(text, "\"");
    }
    public static string SurroundWith(this string text, string surrounds)
    {
        return surrounds + text + surrounds;
    }
} 
```

# .net - 来自映射共享上的应用程序的 SEHException

> ID：334634
> 
> 赞同：3
> 
> 时间：2008-12-02T16:43:09.093
> 
> 标签：.net, winforms

**背景**

我们从本地映射到用户 W 驱动器的 Windows 共享 (UNC) 运行所有 Windows 窗体应用程序。过去几天我们遇到了连接问题，并且在它们运行了几分钟到几个小时后，我们的程序中有些随机的地方收到了 System.Runtime.InteropServices.SEHException。

即使在重新建立连接后也会引发这些异常。它们似乎在显示对话框或其他形式时出现。没有任何程序在用户代码中执行任何磁盘/网络 i/o。

**问题**

Windows 窗体应用程序的延迟是否从 exe 文件中加载资源？

如果是这样，是否有强制这些提前加载？还是在失败后重新加载它们？

关于从网络共享运行 Windows 窗体应用程序的任何见解或建议？除了老板明显的“将文件复制到本地机器”之外，不喜欢这个想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-03T02:17:38.870

我对此没有令人信服的证据，但使用内存映射文件是标准的 MSFT 做法。在转子中有很多 CreateFileMapping() 调用。对于像程序集这样的只读文件非常有效，内存页面不必由分页文件支持。

但是，当 Windows 内存管理器需要将页面换回并且文件变得不可访问时，它会引起人们的注意。它非常适合您的观察。除了你的老板承诺他的偏好并购买更可靠的网络硬件之外，没有任何解决方法。几个小时的 MTBF 非常差。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-03T02:29:42.043

如果您有权访问客户端计算机，则可以打开管理工具并转到 Microsoft .NET Framework 配置为您的应用程序定义自定义权限集。有关详细信息，请参阅ID 自动化上的[这篇文章](http://www.idautomation.com/kb/label_software_from_server.html)。

从理论上讲，如果需要，您应该能够使用组策略或类似的方法在整个网络中推送此更改，但我自己还没有尝试过。

另一种选择是在 Internet Explorer 中打开安全区域设置，并将共享的 file:// 路径添加到本地 Intranet 区域，以便它具有更大的权限，例如：将 file://servername/sharename 添加到本地内网区域。

# ms-word - 清除 RTF 中的 \listlevel 状态

> ID：334635
> 
> 赞同：1
> 
> 时间：2008-12-02T16:43:28.623
> 
> 标签：ms-word, rtf, richtext

我正在从文字处理器组件输出 RTF。这运行良好，但有一种特定情况失败，因为它会导致 Word 2000 损坏文档。不过，Word 2007 对 RTF 很好，这意味着他们修复了一些问题。但是，我需要能够输出适用于任何 Word 版本的 RTF。

想要的文本如下：

```
1\. Title
blah blah blah 
```

这里的关键是这是在表格单元格中输出的。正在输出的 RTF 提取如下。设置一个列表以输出用于标题的编号文本。然后有一个 \pard 重置它（下面用两颗星突出显示）并输出纯文本。如果在单元格中使用了 \pard，则 Word 2000 会崩溃。如果省略，它工作正常。但随后 Word 2007 也显示了带有编号序列的下一行。

```
\trowd \clvertalt\cellx4300\clvertalt\cellx8600\intbl
{\ql\fi-432\li432\sb240\sa0\tx432\plain\s71\f1\fs20 
{\listtext 1.\tab 
}\ls1\ilvl0 title
\par**\pard**\ql\sa120\plain\s24\f1\fs20 blah blah blah
\par\cell\ql\fi0\li0\ri0\sb0\sa0\plain\s23\f12\fs20 \cell 
}\intbl
{\row 
}\trowd \clvertalt\cellx4300\clvertalt\cellx8600\intbl
{\ql\fi0\li0\ri0\sb0\sa0\plain\s23\f12\fs20\cell\ql\fi0\li0\ri0\sb0\sa0\plain\s23\f12\fs20 
\par\cell 
}\intbl
{\row 
}\pard 
{\ql\fi0\li0\ri0\sb0\sa0\plain\s23\f12\fs20 
\par
} 
```

如果有人可以建议如何从 blah blah blah 行中清除列表级别 \ls1，或者 \pard 可能存在什么问题，那么我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-18T12:18:33.503

好的，经过更多调查，一位同事发现答案是在导致问题的 \pard 之后添加一个 '\intbl'。可能需要在 Word 构建数据时重新设置标志。

# wcf - WCF REST 与 ADO.NET 数据服务

> ID：334639
> 
> 赞同：11
> 
> 时间：2008-12-02T16:44:34.657
> 
> 标签：wcf, rest, wcf-data-services

有人可以比较和对比 WCF Rest 服务与 ADO.NET 数据服务吗？有什么区别以及何时使用哪个？

谢谢，

射线。

**编辑**：感谢第一个答案，只是为了提供一些关于我想要做的事情的背景知识：我有一个我计划放在云中的网络应用程序（有一天），DAL 是用 ADO.NET Entity Framework 构建的。而且，我需要确定哪种 Web 服务数据访问技术最适合我的情况。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-02T17:27:39.237

不确定我可以在这里给出一个完整的答案，但我在 PDC 花了很多时间试图自己解决这个问题，所以这是一个尝试......

简短的回答是，ADO.Net 数据服务旨在提供与 Web 无缝集成的 ADO.Net 框架（DataContext、Datasets、DataTables 等）的接口，使用 URI 和众所周知的数据指向您的数据。ADO.Net 数据服务也适用于在云中对 ADO.Net 进行编程。微软的云服务“Azure”是一个新的云编程平台，将在不久的将来发布。有关云服务的更多信息，请访问[此处](http://msdn.microsoft.com/en-us/azure/default.aspx)。

我发现关于 ADO.Net 数据服务和云的一件很酷的事情是，作为数据源提供者的底层 DataContext 可以轻松配置为将您的资源指向云***或***本地数据库。这允许您在不更改任何代码的情况下切换 DataContext ！！！（如果你不能告诉我，我对此印象深刻）

WCF Rest 服务只是普通的 WCF 服务，它们添加了功能，因此可以以 RESTful 方式使用它们（URI 与 URL、HTTP 动词的使用、JSON、YAML 等不同数据传输格式的使用......）。因此，例如，如果您有一个在 WCF 中构建的股票行情 Web 服务，而不是要求调用者使用繁重的 WSDL 实现和 ASMX，您可以只使用 WCF Rest 功能将该服务发布为 JSON 服务，然后无需指向 ASMX 资源即可通过 AJAX 使用它。有关使用休息的 WCF 的更多信息，请查看[PDC 演示文稿](http://channel9.msdn.com/pdc2008/TL35/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T17:35:31.093

非常感谢您的洞察力！对于我的应用程序，我确实计划将它放在云中，并且我还使用 ADO.NET Entity Framework 来构建我的 DAL，所以听起来 ADO.NET 数据服务是我可以选择的。

> 我发现关于 ADO.Net 数据服务和云的一件很酷的事情是，作为数据源提供者的底层 DataContext 可以轻松配置为将您的资源指向云或本地数据库。这允许您在不更改任何代码的情况下切换 DataContext ！！！（如果你不能告诉我，我对此印象深刻）

关于 ADO.NET 数据服务 + EF 如何在云中工作，您能否就这一点多说一些？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-21T15:25:21.663

如果您想开发和交付以数据为中心的服务，在某些情况下，WCF REST 入门工具包和 WCF 数据服务都可以实现很多功能，因为 WCF 的这两种技术都可以以 RESTful 方式交付您的数据（例如，具有 URL 和标准数据格式（如 xml 和 json）的可寻址内容。它们还配备了一系列 .NET 类，用于处理和处理大量网络和 Web 请求，例如 HTTP 拦截器和缓存。

但是，WCF 数据服务拥有而非 REST 入门工具包的一个优势是 WCF 数据服务可以以 .NET 实体对象的形式**和**标准格式（这是通过 OData 协议实现的）公开其数据。所以我猜想 WCF 数据服务会在很多现实世界的场景中为您提供更通用的性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-26T20:28:26.550

ADO.Net 数据服务和 WCF 休息服务之间的主要区别之一是 REST 服务是轻量级的，您可以通过编写单独的方法/函数来自定义要获得的内容，而 ADO.Net 数据服务更像是一个转储，您可以获得所有内容...因此，对于 Web 和 RIA 应用程序，在我看来，WCF Rest 服务是最佳和优化的选择...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-24T16:49:24.530

WCF 数据服务（以前称为 ADO.NET 数据服务）， http: [//msdn.microsoft.com/en-us/data/aa937697.aspx](http://msdn.microsoft.com/en-us/data/aa937697.aspx)

# nhibernate - NHibernate 未在集合 CollectionMappings 中公开列

> ID：334647
> 
> 赞同：2
> 
> 时间：2008-12-02T16:46:39.863
> 
> 标签：nhibernate

我们正在编写代码以使用我们的枚举映射中的所有有效值生成检查约束。我们的一些枚举通过映射集合在复合元素内部（见下文）：

```
<set name="Addresses" table="[Addresses$]" access="field.camelcase-underscore">
    <key column="Person" />
    <composite-element class="Address">
        <property name="StreetAddress1" column="[Street Address 1]" />
        <property name="Country" type="Import.DataAccess.Mappings.UserTypes.EnumerationDisplayNameType`1[[Core.Domain.Model.Enumerations.Country, Core]], Import" />
        <property name="State"  type="Import.DataAccess.Mappings.UserTypes.EnumerationDisplayNameType`1[[Core.Domain.Model.Enumerations.State, Core]], Import" />
        <property name="ZipCode" column="[Zip Code]" length="10" />
    </composite-element>
</set> 
```

当枚举被简单地映射为属性或内部组件时，我们*可以*使用反射成功地获取特定枚举的所有有效值。我们通过获取 NHibernate.Mapping.Table 并遍历列来寻找我们的枚举类型来做到这一点。我们的问题在于集合类型。对于集合类型，ColumnsIterator 计数始终为零。

有没有人成功地从代码中的映射集（碰巧是值对象，如果这很重要）中获取列信息？

不确定我们正在尝试做什么。让我知道是否需要更多信息来更好地理解该问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T07:53:07.783

**[最初由 OP 回答]**：原来我们在错误的地方寻找解决方案。最初我们只使用 Configuration.ClassMappings 和 Configuration.CollectionMappings，正如我原来的评论所指出的，列没有从 CollectionMappings 中暴露出来。

当我们处理每个 ClassMapping 的 PropertyIterator 并根据属性是 Collection 还是 Component 以不同的方式获取枚举信息时，我们发现了成功（以及我们想要的枚举），因为有几种方法可以使用 Components 映射事物，这是通过最棘手的部分。我想在博客中更详细地介绍我们的解决方案。如果/当这种情况发生时，我会尝试发布一个链接。

# sql-server - SQL Server 警报 - 最佳实践

> ID：334650
> 
> 赞同：6
> 
> 时间：2008-12-02T16:47:53.217
> 
> 标签：sql-server, alerts

您总是为每个数据库设置哪些 SQL Server 警报？无论数据库如何，您始终监控什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-02T17:40:30.520

您应该监控严重级别 17 到 25 并收到警报。

从 17 到 19 的严重级别需要 DBA 的干预，它们没有 20-25 严重，但需要提醒 DBA。
17 资源不足
18 检测到非致命内部错误
19 资源错误

这些严重错误意味着 SQL Server 不再工作
20 当前进程中的 SQL 错误
21 数据库 dbid 进程中的
SQL 致命错误 22 SQL 致命错误表完整性可疑
23 SQL 致命错误: 数据库完整性怀疑
24,25 硬件错误

有关严重级别的更多信息，请参阅[http://msdn.microsoft.com/en-us/library/aa937483(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa937483(SQL.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:14:02.237

我还会在错误 823、824 和 832 上添加警报，因为这些错误表明已损坏。

有关更多信息，请参阅[http://www.sqlservercentral.com/articles/Memory+Corruption/93424/](http://www.sqlservercentral.com/articles/Memory+Corruption/93424/)和[http://www.sqlskills.com/BLOGS/PAUL/post/Dont-confuse-error-823-and-error -832.aspx](http://www.sqlskills.com/BLOGS/PAUL/post/Dont-confuse-error-823-and-error-832.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-27T20:22:53.570

> 无论数据库如何，您始终监控什么？

除了日志警报之外，我们始终为所有服务器打开硬件警报。例如，硬件错误（例如 inode 错误）可以像 5xx 错误一样快速关闭服务器。当服务器上的代码无法删除旧的导出时，我们已经看到客户的 PDF 导出功能失败，从而填满了磁盘空间，直到导出完全失败。常规日志警报不会警告您这些事情，直到为时已晚。但是监控磁盘空间就得了。

不幸的是，日志管理解决方案不会自动为您设置这些警报，因此有时您会发现自己需要这些警报是很困难的：当您已经遇到问题时。

我们写了一篇关于为什么将硬件指标警报与标准日志警报配对很重要的博客文章：[https ://blog.bluematador.com/posts/how-essential-alerts-could-have-saved-the-millennium-falcon/](https://blog.bluematador.com/posts/how-essential-alerts-could-have-saved-the-millennium-falcon/?utm_source=stackoverflow)

# c - 新的 C 代码动态工具分析

> ID：334653
> 
> 赞同：2
> 
> 时间：2008-12-02T16:48:55.117
> 
> 标签：c, dynamic, analysis, for-loop

有人能告诉我有哪些新的 C 代码动态工具分析，比如 valdgrind 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-03T08:00:00.397

您可以查看以下两个： [夹板](http://www.splint.org/)和 [Frama-C](http://frama-c.cea.fr/)（Frama-C 是静态工具而不是动态工具）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T18:21:13.840

看看[芬里斯](http://lcamtuf.coredump.cx/fenris/whatis.shtml)。也许不是 valgrind 的替代品，但仍然非常酷 :) 事实上，几乎所有[Michal Zalewski](http://lcamtuf.coredump.cx/)创建的工具都是真正的……创意（抱歉）。

# java - 测试线性类关系

> ID：334654
> 
> 赞同：0
> 
> 时间：2008-12-02T16:48:57.740
> 
> 标签：java, class

我称这种*线性类关系*，但如果我错了，请纠正我。我正在寻找测试 object 类是否是 object 类`A`的祖先或后代`B`。

例如，与和`AbstractCollection`都线性相关。但是，与*不是*线性相关的。`Object``ArrayList``ArrayList`*`Vector`*

 *我的第一个刺是：

```
// ...Assume objects A and B were declared...

Class<? extends Object> Aclass = A.getClass();
if (Aclass.isAssignableFrom(B.getClass()) || Aclass.isInstance(B)) {
    // Their types are linearly related, at the least
} 
```

这是适当的检查吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T16:54:27.087

你的测试有效。我更喜欢对称检查：

```
if (a.getClass().isInstance(b) || b.getClass().isInstance(a)) { 
} 
```

# python - 将字典作为关键字参数传递给函数

> ID：334655
> 
> 赞同：422
> 
> 时间：2008-12-02T16:49:11.247
> 
> 标签：python, function, dictionary, parameters, keyword

我想使用字典在 python 中调用一个函数。

这是一些代码：

```
d = dict(param='test')

def f(param):
    print(param)

f(d) 
```

这会打印`{'param': 'test'}`，但我希望它只是 print `test`。

我希望它对更多参数有类似的工作：

```
d = dict(p1=1, p2=2)
def f2(p1, p2):
    print(p1, p2)
f2(d) 
```

这可能吗？

* * *

## 回答 #1

> 赞同：636
> 
> 时间：2008-12-02T16:53:34.640

最后自己想通了。很简单，我只是缺少 ** 运算符来解包字典

所以我的例子变成了：

```
d = dict(p1=1, p2=2)
def f2(p1,p2):
    print p1, p2
f2(**d) 
```

* * *

## 回答 #2

> 赞同：179
> 
> 时间：2017-04-05T18:29:25.693

```
In[1]: def myfunc(a=1, b=2):
In[2]:    print(a, b)

In[3]: mydict = {'a': 100, 'b': 200}

In[4]: myfunc(**mydict)
100 200 
```

一些可能有助于了解的额外细节（我在阅读本文并进行测试后遇到的问题）：

1.  该函数**可以**具有字典中*未包含的参数*
2.  您**不能**覆盖字典中已经存在的函数参数
3.  字典**不能**包含不在函数中的值。

**例子：**

***数字 1：**函数可以有字典中没有的参数*

```
In[5]: mydict = {'a': 100}
In[6]: myfunc(**mydict)
100 2 
```

***数字 2：**您不能覆盖字典中已经存在的函数参数*

```
In[7]: mydict = {'a': 100, 'b': 200}
In[8]: myfunc(a=3, **mydict)

TypeError: myfunc() got multiple values for keyword argument 'a' 
```

***数字 3：**字典不能包含不在函数中的值。*

```
In[9]:  mydict = {'a': 100, 'b': 200, 'c': 300}
In[10]: myfunc(**mydict)

TypeError: myfunc() got an unexpected keyword argument 'c' 
```

* * *

**如何使用键多于函数参数的字典：**

上面 #3 的解决方案是在你的函数中接受（并忽略）额外的 kwargs（注意，按照惯例`_`，变量名用于被丢弃的东西，尽管从技术上讲，它只是 Python 的有效变量名）：

```
In[11]: def myfunc2(a=None, **_):
In[12]:    print(a)

In[13]: mydict = {'a': 100, 'b': 200, 'c': 300}

In[14]: myfunc2(**mydict)
100 
```

另一种选择是根据函数中可用的关键字参数过滤字典：

```
In[15]: import inspect
In[16]: mydict = {'a': 100, 'b': 200, 'c': 300}
In[17]: filtered_mydict = {k: v for k, v in mydict.items() if k in [p.name for p in inspect.signature(myfunc).parameters.values()]}
In[18]: myfunc(**filtered_mydict)
100 200 
```

* * *

**具有位置和关键字参数的示例：**

请注意，您可以像使用 kwargs 一样有效地使用位置参数和列表或元组，这是一个更高级的示例，它结合了位置参数和关键字参数：

```
In[19]: def myfunc3(a, *posargs, b=2, **kwargs):
In[20]:    print(a, b)
In[21]:    print(posargs)
In[22]:    print(kwargs)

In[23]: mylist = [10, 20, 30]
In[24]: mydict = {'b': 200, 'c': 300}

In[25]: myfunc3(*mylist, **mydict)
10 200
(20, 30)
{'c': 300} 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-12-02T22:03:11.240

在 python 中，这称为“解包”，您可以在[教程](https://docs.python.org/3.8/tutorial/controlflow.html#unpacking-argument-lists)中找到一些相关信息。我同意它的文档很烂，尤其是因为它非常有用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-02T16:52:20.227

在这里你去 - 适用于任何其他可迭代：

```
d = {'param' : 'test'}

def f(dictionary):
    for key in dictionary:
        print key

f(d) 
```

# .net - 填充数据表时，datareader 比 dataset 快吗？

> ID：334658
> 
> 赞同：9
> 
> 时间：2008-12-02T16:51:03.040
> 
> 标签：.net, performance, datatable, datareader, dataadapter

哪个会更快。

1）循环数据读取器并创建基于自定义行和列的填充数据表

2）或创建一个dataAdapter对象并只是（.Fill）一个数据表。

在动态创建数据表时，数据读取器的性能是否仍然适用？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-02T16:53:43.203

DataAdapter 在后台使用 DataReader，因此您的体验可能是相同的。

DataAdapter 的好处是您删减了大量需要维护的代码。

这场辩论有点宗教问题，所以一定要环顾四周，决定什么最适合你的情况：

*   [http://blogs.msdn.com/memilavi/archive/2008/02/18/datareader-vs-dataset-the-real-question.aspx](http://blogs.msdn.com/memilavi/archive/2008/02/18/datareader-vs-dataset-the-real-question.aspx)
*   [http://xcskiwinn.org/community/blogs/panmanphil/archive/2004/09/21/281.aspx](http://xcskiwinn.org/community/blogs/panmanphil/archive/2004/09/21/281.aspx)
*   [http://weblogs.asp.net/joelevi/archive/2008/02/12/asp-net-datareader-vs-dataset.aspx](http://weblogs.asp.net/joelevi/archive/2008/02/12/asp-net-datareader-vs-dataset.aspx)
*   [http://weblogs.asp.net/dreilly/archive/2003/09/27/29411.aspx](http://weblogs.asp.net/dreilly/archive/2003/09/27/29411.aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-02T17:05:51.620

假设您实际上想要从数据库返回所有数据，那么在数据库和网络上花费的时间几乎肯定会使进程内在内存中填充数据结构所花费的时间相形见绌。

是的，在某些情况下，您可能会通过使用 DataReader 节省少量费用 - 特别是如果您想流式传输数据，它可能很有用 - 但如果您确实需要它，我会坚持使用最简单的代码。如果您认为 DataSet 人口正在导致严重的性能问题，请对其进行分析，*然后*尝试对其进行改进。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-02T16:58:08.780

您的选项＃1会更慢。但是，与手动添加自定义行相比，将数据读取器转换为数据表有更好的方法：

```
DataTable dt = new DataTable();

using (SqlConnection conn = GetOpenSqlConnection())
using (SqlCommand cmd = new SqlCommand("SQL Query here", conn)
using (IDataReader rdr = cmd.ExecuteReader())
{
    dt.Load(rdr);
} 
```

我无法评论 this 和 using 之间的区别`.Fill()`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T16:57:09.157

我不能说填充数据表本身，但使用数据阅读器是最有效的阅读方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T17:04:01.110

数据读取器更快。如果您使用的是 2.0+，您可能甚至不必使用数据表。您可以使用对象的通用列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T16:58:44.847

当您需要显示加载数据的进度时，使用 DataReader 非常好。在 DataSet 中，您不能在加载数据的过程中做某事。

另一方面，DataSet 是一体式对象。所以 DataSet 慢得多。DataReader 可以在代码中数据操作非常缓慢的地方为您提供额外的提升。在这些地方将其从 DataSet 更改为 DataReader。DataReader 还占用更少的内存空间。

哦，当然，编写好的 DataReader 需要更多时间，但这是值得的。例如，当您播放从数据库中获取的图像或音乐时。

[MSDN 杂志中有关此主题的更多信息](http://msdn.microsoft.com/pl-pl/magazine/cc188717(en-us).aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-02T17:10:48.630

与许多这样的问题一样，答案是：取决于。

如果您事先不知道数据的结构并且正在动态创建 TableAdapter，那么动态 DataTable 会更有效。创建 TableAdapter 涉及大量代码生成。

但是，如果您事先知道数据的结构，那么问题就变成了，我需要多少功能？

如果您需要完整的 CRUD 实现，那么使用 TableAdapter 可以获得一些效率，而不是自己编写所有的 CRUD 代码。此外，TableAdapter 实现还可以（不是很好）。如果您需要更高效的东西，那么使用 nHibernate 或其他一些 ORM 可能会更好。

如果您不需要完整的 CRUD 实现（即这是一个只读解决方案）并且预先知道您的数据结构，那么您必须针对动态生成的 DataTable 测试 TableAdapter 只读实现的效率. 如果我是一个赌徒，我会把钱放在 TableAdapter 实现上，因为您绑定数据一次并多次读取它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-14T07:10:18.677

采用`DataReader`'s`Read`是一种只进、一次一行的方法，它按顺序读取数据，以便在连接时立即读取记录，这将是内存和性能的最佳选择。

也就是说，在这两种方法之间，我发现`IDataAdapter.Fill`比`DataTable.Load`. 当然，这取决于实现。这是我在[此处](https://stackoverflow.com/a/14807940/661933)发布的两者之间的基准：

```
public DataTable Read1<T>(string query) where T : IDbConnection, new()
{
    using (var conn = new T())
    {
        using (var cmd = conn.CreateCommand())
        {
            cmd.CommandText = query;
            cmd.Connection.ConnectionString = _connectionString;
            cmd.Connection.Open();
            var table = new DataTable();
            table.Load(cmd.ExecuteReader());
            return table;
        }
    }
}

public DataTable Read2<S, T>(string query) where S : IDbConnection, new() 
                                           where T : IDbDataAdapter, IDisposable, new()
{
    using (var conn = new S())
    {
        using (var da = new T())
        {
            using (da.SelectCommand = conn.CreateCommand())
            {
                da.SelectCommand.CommandText = query;
                da.SelectCommand.Connection.ConnectionString = _connectionString;
                DataSet ds = new DataSet(); //conn is opened by dataadapter
                da.Fill(ds);
                return ds.Tables[0];
            }
        }
    }
} 
```

第二种方法总是优于第一种。

```
Stopwatch sw = Stopwatch.StartNew();
DataTable dt = null;
for (int i = 0; i < 100; i++)
{
    dt = Read1<MySqlConnection>(query); // ~9800ms
    dt = Read2<MySqlConnection, MySqlDataAdapter>(query); // ~2300ms

    dt = Read1<SQLiteConnection>(query); // ~4000ms
    dt = Read2<SQLiteConnection, SQLiteDataAdapter>(query); // ~2000ms

    dt = Read1<SqlCeConnection>(query); // ~5700ms
    dt = Read2<SqlCeConnection, SqlCeDataAdapter>(query); // ~5700ms

    dt = Read1<SqlConnection>(query); // ~850ms
    dt = Read2<SqlConnection, SqlDataAdapter>(query); // ~600ms

    dt = Read1<VistaDBConnection>(query); // ~3900ms
    dt = Read2<VistaDBConnection, VistaDBDataAdapter>(query); // ~3700ms
}
sw.Stop();
MessageBox.Show(sw.Elapsed.TotalMilliseconds.ToString()); 
```

`Read1`看起来更好，但数据适配器性能更好（不要混淆一个数据库优于另一个，查询都是不同的）。两者之间的差异取决于查询。原因可能是在添加行时需要[从文档](http://msdn.microsoft.com/en-us/library/7x8ccbsb.aspx)`Load`中逐行检查各种约束（它是一种方法），而在 DataAdapters 上是专门为此而设计的 - 快速创建 DataTables。`DataTable``Fill`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-03-03T10:47:46.947

依靠。如果您希望一次获取所有记录，DataAdapter 可以快 2 到 25 倍。当您只需要一列或两列并希望一次更改一个时，数据读取器非常好，但是执行时间如预期的那样很慢。DA 最大的问题是缺乏异步方法——然而，MS 没有计划使 DA 异步。虽然 DA 在后台使用 DR，但它已经被磨练到完美，并且在 C# 中使用 DR 编写自己的循环肯定会更慢。

# windows - 有没有办法查看刚刚关闭的 Windows 命令提示符？

> ID：334669
> 
> 赞同：2
> 
> 时间：2008-12-02T16:54:20.753
> 
> 标签：windows, command-window

当命令提示符打开然后很快关闭时（因为没有暂停线），有没有办法查看它刚刚向您显示的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T16:58:27.237

您可以将输出通过管道传输到文件。

```
something.exe > c:\temp\output.txt 
```

这适用于提示和 Windows 运行对话框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T17:27:05.603

不是事后，不是。一旦它消失了，它就消失了。如果您有幸再次运行它（即，您知道执行了什么程序或命令），那么您可以使用此处提到的其他一些建议，然后依靠运行的*输出*与这是在上*一次*运行中。建议包括在已经打开的控制台窗口中运行命令，将输出通过管道传输到文件以便稍后阅读，然后在包含`pause`命令的批处理文件中运行程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T16:59:18.730

从命令行运行控制台应用程序，这样控制台窗口在执行后不会关闭。

打开cmd提示符，

键入要运行的程序 例如：

```
c:\> ipconfig /all 
```

在回答之前，我应该在我的系统中获得更多的咖啡。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T16:59:21.697

为所有命令提示启用“快速编辑模式”（使用右键单击窗口手柄栏时获得的属性菜单）。

现在，您可以用鼠标单击窗口，它会被阻止。

[编辑] 这对于停止长时间运行的进程更有用，因此您可以浏览输出，因为即使您可以在窗口关闭之前点击它，也可能是错误尚未打印并且您的反应太慢而无法做第二次。

# sql - 在 2005 实例上的每个数据库中创建 DDL 触发器

> ID：334671
> 
> 赞同：1
> 
> 时间：2008-12-02T16:54:28.757
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我需要在我的 sql 2005 实例上的每个数据库中创建一个触发器。我正在设置一些审核 ddl 触发器。

我创建了一个包含所有数据库名称的游标并尝试执行 USE 语句。这似乎并没有改变数据库 - CREATE TRIGGER 语句只是在 Adventureworks 中反复触发。另一种选择是使用 databasename.dbo.triggername 作为触发器对象的前缀。这也不起作用 - 创建触发器的某种限制。当然，我可以手动执行此操作，但我更喜欢编写脚本以便于应用和删除。如果我不能在 1 个 sql 脚本中执行此操作，我还有其他选择，但我想保持简单:)

这是我到目前为止所拥有的——希望你能找到一个愚蠢的错误！

```
--setup stuff...    
CREATE DATABASE DBA_AUDIT
GO 
USE DBA_AUDIT
GO
CREATE TABLE AuditLog
(ID        INT PRIMARY KEY IDENTITY(1,1),
Command    NVARCHAR(1000),
PostTime   DATETIME,
HostName   NVARCHAR(100),
LoginName  NVARCHAR(100)
)
GO

CREATE ROLE AUDITROLE
GO

sp_adduser 'guest','guest','AUDITROLE'
GO

GRANT INSERT ON SCHEMA::[dbo]
TO AUDITROLE

--CREATE TRIGGER IN ALL NON SYSTEM DATABASES

DECLARE @dataname varchar(255),
@dataname_header varchar(255),
@command VARCHAR(MAX),
@usecommand VARCHAR(100)
SET @command = '';

--get the list of database names

DECLARE datanames_cursor CURSOR FOR SELECT name FROM sys.databases 
WHERE name not in ('master', 'pubs', 'tempdb', 'model','msdb')

OPEN datanames_cursor

FETCH NEXT FROM datanames_cursor INTO @dataname
WHILE (@@fetch_status = 0)
BEGIN

PRINT '----------BEGIN---------'

PRINT 'DATANAME variable: ' + @dataname;

EXEC ('USE ' + @dataname);

PRINT 'CURRENT db: ' + db_name();

SELECT @command = 'CREATE TRIGGER DBA_Audit ON DATABASE
FOR DDL_DATABASE_LEVEL_EVENTS
AS
DECLARE @data XML
DECLARE @cmd NVARCHAR(1000)
DECLARE @posttime NVARCHAR(24)
DECLARE @spid NVARCHAR(6)
DECLARE @loginname NVARCHAR(100)
DECLARE @hostname NVARCHAR(100)
SET @data = EVENTDATA()
SET @cmd = @data.value(''(/EVENT_INSTANCE/TSQLCommand/CommandText)[1]'', ''NVARCHAR(1000)'')
SET @cmd = LTRIM(RTRIM(REPLACE(@cmd,'''','''')))
SET @posttime = @data.value(''(/EVENT_INSTANCE/PostTime)[1]'', ''DATETIME'')
SET @spid = @data.value(''(/EVENT_INSTANCE/SPID)[1]'', ''nvarchar(6)'')
SET @loginname = @data.value(''(/EVENT_INSTANCE/LoginName)[1]'',
    ''NVARCHAR(100)'')
SET @hostname = HOST_NAME()
INSERT INTO [DBA_AUDIT].dbo.AuditLog(Command, PostTime,HostName,LoginName)
 VALUES(@cmd, @posttime, @hostname, @loginname);'

 EXEC (@command);
 FETCH NEXT FROM datanames_cursor INTO @dataname;

PRINT '----------END---------'

END
CLOSE datanames_cursor
DEALLOCATE datanames_cursor

OUTPUT:
----------BEGIN---------
DATANAME variable: adventureworks
CURRENT db: master
Msg 2714, Level 16, State 2, Procedure DBA_Audit, Line 18
There is already an object named 'DBA_Audit' in the database.
----------END---------
----------BEGIN---------
DATANAME variable: SQL_DBA
CURRENT db: master
Msg 2714, Level 16, State 2, Procedure DBA_Audit, Line 18
There is already an object named 'DBA_Audit' in the database.
----------END--------- 
```

编辑：我已经尝试过 sp_msforeachdb 方法

```
Msg 111, Level 15, State 1, Line 1
'CREATE TRIGGER' must be the first statement in a query batch. 
```

编辑：

这是我的最终代码 - 这个确切的脚本尚未经过测试，但它已在大约 100 个左右的数据库上投入生产。干杯!

**一个警告**- 您的数据库需要处于 90 的兼容模式（在每个 db 的选项中），否则您可能会开始出错。语句的 EXECUTE AS 部分中的帐户也需要访问权限才能插入到您的管理表中。

```
USE [SQL_DBA]
GO
/****** Object:  Table [dbo].[DDL_Login_Log]    Script Date: 03/03/2009 17:28:10 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DDL_Login_Log](
    [DDL_Id] [int] IDENTITY(1,1) NOT NULL,
    [PostTime] [datetime] NOT NULL,
    [DB_User] [nvarchar](100) NULL,
    [DBName] [nvarchar](100) NULL,
    [Event] [nvarchar](100) NULL,
    [TSQL] [nvarchar](2000) NULL,
    [Object] [nvarchar](1000) NULL,
 CONSTRAINT [PK_DDL_Login_Log] PRIMARY KEY CLUSTERED 
(
    [DDL_Id] ASC,
    [PostTime] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--This creates the trigger on the model database so all new DBs get it
USE [model]
GO
/****** Object:  DdlTrigger [ddl_DB_User]    Script Date: 03/03/2009 17:26:13 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TRIGGER [ddl_DB_User] 
ON DATABASE
FOR DDL_DATABASE_SECURITY_EVENTS
AS 

DECLARE @data XML
declare @user nvarchar(100)

SET @data = EVENTDATA()
select @user = convert(nvarchar(100), SYSTEM_USER)

execute as login='domain\sqlagent'
INSERT sql_dba.dbo.DDL_Login_Log 
   (PostTime, DB_User, DBName, Event, TSQL,Object) 
   VALUES 
   (@data.value('(/EVENT_INSTANCE/PostTime)[1]', 'nvarchar(100)'), 
   @user,
    db_name(),
    @data.value('(/EVENT_INSTANCE/EventType)[1]', 'nvarchar(100)'), 
   @data.value('(/EVENT_INSTANCE/TSQLCommand/CommandText)[1]','nvarchar(max)'),
    @data.value('(/EVENT_INSTANCE/ObjectName)[1]', 'nvarchar(1000)')
)

GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
--CREATE TRIGGER IN ALL NON SYSTEM DATABASES

DECLARE @dataname varchar(255),
@dataname_header varchar(255),
@command VARCHAR(MAX),
@usecommand VARCHAR(100)
SET @command = '';
DECLARE datanames_cursor CURSOR FOR SELECT name FROM sys.databases 
WHERE name not in ('master', 'pubs', 'tempdb', 'model','msdb')
OPEN datanames_cursor
FETCH NEXT FROM datanames_cursor INTO @dataname
WHILE (@@fetch_status = 0)
BEGIN

PRINT '----------BEGIN---------'

PRINT 'DATANAME variable: ' + @dataname;

EXEC ('USE ' + @dataname);

PRINT 'CURRENT db: ' + db_name();

SELECT @command = 'CREATE TRIGGER DBA_Audit ON DATABASE
FOR DDL_DATABASE_LEVEL_EVENTS
AS
DECLARE @data XML
DECLARE @cmd NVARCHAR(1000)
DECLARE @posttime NVARCHAR(24)
DECLARE @spid NVARCHAR(6)
DECLARE @loginname NVARCHAR(100)
DECLARE @hostname NVARCHAR(100)
SET @data = EVENTDATA()
SET @cmd = @data.value(''(/EVENT_INSTANCE/TSQLCommand/CommandText)[1]'', ''NVARCHAR(1000)'')
SET @cmd = LTRIM(RTRIM(REPLACE(@cmd,'''','''')))
SET @posttime = @data.value(''(/EVENT_INSTANCE/PostTime)[1]'', ''DATETIME'')
SET @spid = @data.value(''(/EVENT_INSTANCE/SPID)[1]'', ''nvarchar(6)'')
SET @loginname = @data.value(''(/EVENT_INSTANCE/LoginName)[1]'',
    ''NVARCHAR(100)'')
SET @hostname = HOST_NAME()
INSERT INTO [DBA_AUDIT].dbo.AuditLog(Command, PostTime,HostName,LoginName)
 VALUES(@cmd, @posttime, @hostname, @loginname);'

 EXEC (@command);
 FETCH NEXT FROM datanames_cursor INTO @dataname;
PRINT '----------END---------'
END
CLOSE datanames_cursor
DEALLOCATE datanames_cursor

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

----Disable all triggers when things go haywire
sp_msforeachdb @command1='use [?]; IF  EXISTS (SELECT * FROM sys.triggers WHERE name = N''ddl_DB_User'' AND parent_class=0)disable TRIGGER [ddl_DB_User] ON DATABASE' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T17:32:13.890

当您使用 EXEC() 时，每次使用都在其自己的上下文中。因此，当您执行 EXEC('USE MyDB') 时，它会针对该上下文切换到 MyDB，然后命令结束，您又回到了开始的地方。有几个可能的解决方案...

您可以使用数据库名称（例如，MyDB..sp_executesql）调用 sp_executesql，它将在该数据库中运行。诀窍是让您动态地执行此操作，因此您基本上像这样将其包装两次：

```
DECLARE @cmd NVARCHAR(2000), @my_db VARCHAR(255)

SET @my_db = 'MyDatabaseName'

SET @cmd = 'DECLARE @my_cmd NVARCHAR(2000); SET @my_cmd = ''CREATE TRIGGER DBA_Audit ON DATABASE
FOR DDL_DATABASE_LEVEL_EVENTS
AS
DECLARE @data XML
DECLARE @cmd NVARCHAR(1000)
DECLARE @posttime NVARCHAR(24)
DECLARE @spid NVARCHAR(6)
DECLARE @loginname NVARCHAR(100)
DECLARE @hostname NVARCHAR(100)
SET @data = EVENTDATA()
SET @cmd = @data.value(''''(/EVENT_INSTANCE/TSQLCommand/CommandText)[1]'''', ''''NVARCHAR(1000)'''')
SET @cmd = LTRIM(RTRIM(REPLACE(@cmd,'''''''','''''''')))
SET @posttime = @data.value(''''(/EVENT_INSTANCE/PostTime)[1]'''', ''''DATETIME'''')
SET @spid = @data.value(''''(/EVENT_INSTANCE/SPID)[1]'''', ''''nvarchar(6)'''')
SET @loginname = @data.value(''''(/EVENT_INSTANCE/LoginName)[1]'''',
    ''''NVARCHAR(100)'''')
SET @hostname = HOST_NAME()
INSERT INTO [DBA_AUDIT].dbo.AuditLog(Command, PostTime,HostName,LoginName)
 VALUES(@cmd, @posttime, @hostname, @loginname);''; EXEC ' + @my_db + '..sp_executesql @my_cmd'

EXEC (@cmd) 
```

另一种选择是将此作为一个两步过程来执行，其中第一步生成并打印出带有 USE 语句和所有语句的实际代码，然后运行该生成的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T17:05:58.953

您不必创建 CURSOR ...

```
sp_msforeachdb 'USE ?; PRINT ''Hello ?''' 
```

编辑：“使用？” 部分是切换到指定的数据库...您可能需要放置一个 IF 语句以确保数据库名称是您想要的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T17:39:33.813

我会尝试的第一件事是将“USE”命令放在你的@command 字符串中，尽管如果它抱怨触发器 ddl 必须是批处理中的第一个，那是不可能的。

您可以访问 Visual Studio 吗？这将像 C# 控制台应用程序一样快速编写代码，为您留下一个可以随时运行的 exe 文件。不像 sql 脚本那么透明，但您可以将源代码存储在它旁边。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-03T20:32:20.983

另一种可能的解决方案是在模型数据库中创建触发器，这样所有数据库都将*继承*它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T05:50:57.527

感谢这篇很棒的帖子。我只是徘徊你能以这种方式采取更简单的方法吗：

在所有服务器上为 OBJECT_ACTION 创建触发器 trgMonitorNewDB

另见[链接文本](http://www.databasejournal.com/features/mssql/article.php/3685661/Monitoring-Changes-to-your-Database-Schema.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-10T19:27:57.160

这有点蛮力，但你可以做一个基本的循环并打印出你想要执行的代码，然后在单独的步骤中执行代码。无需不必要地跳过箍来使用 sp_msforeachdb ......当然，正在处理的数据库数量可能存在限制，这将使这种方法不切实际，但它可能有助于使用较小数据库集的人：

`--首先获取您的数据库名称列表，在 WHERE 子句中过滤掉您不需要的任何内容：

```
select name 
into #d 
from sys.databases 
```

--然后，使用上面的列表，循环并打印每个数据库的 CREATE TRIGGER CODE：

```
DECLARE @dbname varchar(100)
DECLARE @Trig VARCHAR(max)
select @dbname = (select top 1 name FROM #d order by name asc)

WHILE @dbname IS NOT NULL
BEGIN 
SET @Trig = 'USE ' + @dbname +'; 
GO

CREATE TRIGGER [DBA_KillerTrigger]
ON DATABASE
AFTER DDL_DATABASE_LEVEL_EVENTS
AS
/*...Trigger magic goes here...*/
GO

ENABLE TRIGGER [DBA_KillerTrigger] ON DATABASE
GO

PRINT @Trig

SELECT @dbname = (select top 1 name FROM #d where name > @dbname order by name asc)

END 
```

# c++ - 在 pre-NT 系统上调用 NT 函数

> ID：334674
> 
> 赞同：6
> 
> 时间：2008-12-02T16:55:03.513
> 
> 标签：c++, windows, winapi, dll

所以我不做很多Win32调用，但最近我不得不使用[`GetFileTime()`](http://msdn.microsoft.com/en-us/library/ms724320(VS.85).aspx)and[`SetFileTime()`](http://msdn.microsoft.com/en-us/library/ms724933(VS.85).aspx)函数。现在虽然我的程序没有正式支持 Win98 及以下版本，但人们还是在那里使用它，我尽量保持它尽可能可用。我只是想知道会发生什么，因为这些功能在 NT 之前的系统中不存在，它们是否会收到某种错误消息，例如，因为在这种情况下我将添加操作系统检查？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-02T16:59:39.027

如果你直接调用这些函数，那么你的程序将不会在 Win98 上加载。

您可以做的是使用`LoadLibrary()`/`GetProcAddress()`获取指向`GetFileTime()`/的指针`SetFileTime()`。在 Win98 上，这将失败，给你一个空指针，你可以测试并忽略它。在 2000 及更高版本上，您将获得一个可以使用的指针。

这很痛苦，但这是我所知道的唯一解决方案。

以下是获取 UpdateLayeredWindow 函数（如果存在）的示例：

```
typedef BOOL (WINAPI* UpdateLayeredWinFunc) (HWND, HDC, POINT*, SIZE*, HDC, POINT*, COLORREF, BLENDFUNCTION*, DWORD);

UpdateLayeredWinFunc updateLayeredWindow = 0;
HMODULE user32Mod = GetModuleHandle (_T("user32.dll"));
updateLayeredWindow = (UpdateLayeredWinFunc) GetProcAddress (user32Mod, "UpdateLayeredWindow"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T17:00:59.960

我相信您会收到一条错误消息，类似于“过程入口点（名称）无法位于（dll）中”，类似于所示的：

[例如 http://img266.imageshack.us/img266/3762/error2pm1.png](http://img266.imageshack.us/img266/3762/error2pm1.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-03T14:38:17.690

你可以打电话`FindFirstFile()`而不是`GetFileTime()`. 不过，我不知道 的替代方案`SetFileTime()`。

# perl - 如何在 Perl 中检测操作系统？

> ID：334686
> 
> 赞同：59
> 
> 时间：2008-12-02T16:59:00.137
> 
> 标签：perl, cross-platform

我在 Mac、Windows 和 Ubuntu 上有 Perl。我如何从脚本中分辨出哪个是哪个？提前致谢。

**编辑：**有人问我在做什么。它是一个脚本，是我们跨平台构建系统的一部分。该脚本递归目录并确定要构建的文件。有些文件是特定于平台的，因此，在 Linux 上，我不想构建以 _win.cpp 等结尾的文件。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-12-02T17:03:07.833

检查[`$^O`](http://perldoc.perl.org/perlvar.html#%24OSNAME)将包含操作系统名称的变量：

```
print "$^O\n"; 
```

`linux`在 Linux 和`MSWin32`Windows 上打印。

[`$OSNAME`](http://perldoc.perl.org/perlvar.html#%24OSNAME)如果你使用[英文](http://perldoc.perl.org/English.html)模块，你也可以通过名字来引用这个变量：

```
use English qw' -no_match_vars ';
print "$OSNAME\n"; 
```

根据[perlport](http://perldoc.perl.org/perlport.html)，[`$^O`](http://perldoc.perl.org/perlvar.html#%24OSNAME)将`darwin`在 Mac OS X 上。

* * *

您还可以使用[Config](http://perldoc.perl.org/Config.html)核心模块，它可以提供相同的信息（以及更多信息）：

```
use Config;

print "$Config{osname}\n";
print "$Config{archname}\n"; 
```

在我的 Ubuntu 机器上打印：

```
linux
i486-linux-gnu-thread-multi 
```

请注意，此信息基于*构建*Perl 的系统，不一定是 Perl 当前运行的系统（对于[`$^O`](http://perldoc.perl.org/perlvar.html#%24OSNAME)和也是如此[`$OSNAME`](http://perldoc.perl.org/perlvar.html#%24OSNAME)）；操作系统可能不会有所不同，但某些信息（例如架构名称）可能会有所不同。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-03T15:50:16.467

如果您需要有关 Windows 的更多具体信息，这可能会有所帮助。

```
my $osname = $^O;

if( $osname eq 'MSWin32' ){{
  eval { require Win32; } or last;
  $osname = Win32::GetOSName();

  # work around for historical reasons
  $osname = 'WinXP' if $osname =~ /^WinXP/;
}} 
```

*源自[sysinfo.t](https://github.com/parrot/parrot/blob/master/t/dynoplibs/sysinfo.t)，我编写了原始版本。*

如果您需要更详细的信息：

```
my ( $osvername, $major, $minor, $id ) = Win32::GetOSVersion(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-02T17:29:52.197

[Sys::Info::OS](http://p3rl.org/Sys::Info::OS)看起来是一个相对干净的潜在解决方案，但目前似乎不支持 Mac。不过，添加它不应该是太多的工作。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-03T03:55:55.520

查看源代码[`File::Spec`](http://search.cpan.org/perldoc?File::Spec)以了解它如何根据操作系统加载正确的委托。:)

`File::Spec`每个操作系统都有一个单独的 Perl 模块文件。`File::Spec::Win32`, `File::Spec::OS2`, 等等...

它检查操作系统并`.pm`在运行时根据操作系统加载适当的文件。

```
# From the source code of File::Spec
my %module = (
      MSWin32 => 'Win32',
      os2     => 'OS2',
      VMS     => 'VMS',
      NetWare => 'Win32', # Yes, File::Spec::Win32 works on NetWare.
      symbian => 'Win32', # Yes, File::Spec::Win32 works on symbian.
      dos     => 'OS2',   # Yes, File::Spec::OS2 works on DJGPP.
      cygwin  => 'Cygwin',
      amigaos => 'AmigaOS');

my $module = $module{$^O} || 'Unix';

require "File/Spec/$module.pm";
our @ISA = ("File::Spec::$module"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-02T17:10:07.073

变量 $^O（大写的“O”，而不是零）包含操作系统的名称。

取决于你想要什么，它可能会也可能不会给出你想要的答案——在我的系统上，它给出了“linux”而不说是哪个发行版。我不太确定它在 Windows 或 MacOS 上的含义。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-02T17:06:04.553

[这是](http://www.rocketaware.com/perl/perlfaq8/How_do_I_find_out_which_operatin.htm)有关如何从 Perl 查找本地计算机正在运行的操作系统的快速参考。

> $^O 变量（如果使用英语，则为 $OSTYPE）包含构建 perl 二进制文件的操作系统。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-29T19:27:35.787

经典的单线：

```
my $windows=($^O=~/Win/)?1:0;# Are we running on windows? 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-08T17:09:59.717

Mac 计算机上的仅供参考 $^O 现在为 10.13.6 (High Sierra) 和 10.15.4 (Catalina) 返回 'darwin'。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-23T15:34:07.843

```
#Assign the $home_directory variable the path of the user's home directory
my $home_directory = ($^O eq /Win/) ? $ENV{HOMEPATH} : $ENV{HOME};
#Then you can read/write to files in the home directory
open(FILE, ">$home_directory/my_tmp_file");
print FILE "This is a test\n";
close FILE;
#And/or read the contents of the file
open(FILE, "<$home_directory/my_tmp_file");
while (<FILE>){
    print $_;
}
close FILE; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-10-17T21:29:13.470

有关预打包 perl 模块中的通用映射，请查看[`Perl::OSType`](https://metacpan.org/pod/Perl::OSType).

它被`Module::Build`.

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2013-09-02T09:16:01.233

是的，使用 Config 模块可能是一件好事。另一种可能性是从 /etc/*release 文件中获取信息

例如..

猫 /etc/os-release

```
NAME="UBUNTU"
VERSION="12.0.2 LTS, Precise Pangolin"
ID="UBUNTU"
ID_LIKE=debian
PRETTY_NAME="Ubuntu precise (12.0.2 LTS)"
VERSION_ID="12.04" 
```

# lisp - 可视化编程工具

> ID：334691
> 
> 赞同：4
> 
> 时间：2008-12-02T16:59:39.417
> 
> 标签：lisp, visual-programming, graphical-programming

我需要用于图形表示程序中工作流程的工具（例如用图形表示描述电子电路）。表示必须如下所示：函数是框，框之间的箭头是“消息”。像这样：

[替代文字 http://img372.imageshack.us/img372/8471/functionsqv0.png](http://img372.imageshack.us/img372/8471/functionsqv0.png)

此图显示如下： (c (a) (b))
其中 c() 的参数命名为 d 和 e。在 C 上它将是

```
void c( someType1 d, someType2 e );
someType1 a( void );
someType2 b( void );
....
c( a(), b() ); 
```

所以我认为我需要这样的工具来操作和视觉表示 s 表达式：

```
(a (b c d) e) 
```

或者

```
f(g(z(x,y))+5) 
```

它不是关于链表，而是关于函数之间的逻辑连接。
该工具只需从图形生成文本表示。
好吧，我在 Wiki 页面上找到了很多关于“可视化编程”和“图形编程”等的内容。大多数描述的工具都很酷，但有些复杂。而且这个列表很长，所以要花很多时间来测试所有这些。所以我需要一个真实的，活着的人的意见。

要求是：

*   自由
*   简单的
*   可以导出到至少一种真实语言，如 XML 或 C++ 或 LISP 或任何其他语言。

如果这个工具是可配置的，那就太好了。

我喜欢 FlowDesigner 工具：它似乎几乎是我需要的东西，但它无法导出到任何语言……唉。

**UPD**：我提到的 wiki 页面：[图形编程](http://en.wikipedia.org/wiki/Graphical_programming)
**UPD2**：好吧，我决定编写自己的工具...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T09:43:19.313

查看 Microsoft DSL 工具 - [http://msdn.microsoft.com/en-us/library/bb126259.aspx](http://msdn.microsoft.com/en-us/library/bb126259.aspx)

它是一个“设计器生成器”——允许您定义自己的图表格式、指定形状、箭头、颜色等，并为您生成能够编辑此类图表并导出有关图表的任何文本工件的设计器（例如 XML或代码）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T10:03:35.653

[使用类似Graphviz](http://www.graphviz.org/)的东西怎么样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T14:09:00.837

*警告：无耻的插头*

见过[Memention Designer](http://www.memention.com/designer)吗？

它是围绕可配置引擎构建的，几乎可以输出任何语言。

但我很抱歉。它并不是真正免费的。

[![替代文字](https://i.stack.imgur.com/YRaQp.jpg)](https://i.stack.imgur.com/YRaQp.jpg)
[（来源：[memention.com](http://www.memention.com/designer/desscreen.jpg)）]

上面的示例按照 c 代码导出，但可以通过一些重新配置生成其他语言。

```
#include <stdio.h>

/* there are 8 blocks */
int running;
/* there are 1 out blocks */
int state_curr_1;
int state_next_1;

int main(int argc, char *argv[]) {
  running = 1;
  state_curr_1 = 0;
  while (running) {
    state_next_1 = (state_curr_1 + 19);
    running = (state_curr_1 != (19 * 12));
    state_curr_1 = state_next_1;
    printf("out = %d\n", state_curr_1);
  }
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-04T13:55:23.750

[http://www.graphviz.org/](http://www.graphviz.org/)

高温高压

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-14T11:13:19.707

使用基于 .net 和 WPF 的库[TUM.CMS.VPLControl](https://github.com/tumcms/TUM.CMS.VPLControl)怎么样？

[![在此处输入图像描述](https://i.stack.imgur.com/Hl2k7.png)](https://i.stack.imgur.com/Hl2k7.png)

# sql - 比较'where'语句中'as'表达式的结果

> ID：334698
> 
> 赞同：4
> 
> 时间：2008-12-02T17:02:38.943
> 
> 标签：sql, mysql

是否可以创建一个使用表达式作为 x 然后检查 x 的值是否低于一定数量的 MySQL 选择语句？

```
SELECT (mytable.field1 + 10) AS x FROM `mytable` WHERE x < 50; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T17:04:36.850

不，您必须实际执行此操作

```
SELECT (mytable.field1 + 10) AS x FROM `mytable` WHERE (mytable.field1 + 10) < 50; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T17:08:01.553

你也可以这样做：

```
SELECT *
FROM (
    SELECT (mytable.field1 + 10) AS X
    FROM `MyTable`
) t
WHERE X < 50 
```

在大多数情况下，使用 Nick 的解决方案可能会更好，因为它允许服务器在流程的早期应用 where 子句。但是，有时为了在其他因素驱动性能的复杂查询中清晰起见，您会希望这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-03T06:51:53.420

为此，我将表达式存储在变量中并将它们插入多个位置：

```
$x_sql = '(mytable.field1 + 10)';
$SQL = "SELECT $x_sql AS x FROM mytable WHERE $x_sql < 50"; 
```

或者，如果您不因效率低下而烦恼，请使用 HAVING 子句：

```
SELECT (mytable.field1 + 10) as x FROM mytable HAVING x < 50; 
```

（可能与另一个答案中建议的子选择同样低效）。

# javascript - IE6 无法使用 getElementById() 找到 Object 元素？

> ID：334702
> 
> 赞同：1
> 
> 时间：2008-12-02T17:03:46.960
> 
> 标签：javascript, internet-explorer, internet-explorer-6, getelementbyid

我正在尝试使用 getElementById 从我的网页中获取一个对象元素（最终我可以用动态创建的对象元素替换它），但它`null`在 IE6 中返回。

在下面的代码中，`byId()`函数`null`在 IE 中返回，但`[object HTMLObjectElement]`在 Firefox 3 中`lengthOfByTagName()`返回，函数`0`在 IE 中返回，但`1`在 Firefox 中返回。

有什么我做错了吗？

```
<html>
<head>
<title>IE doesn't see Object element?</title>
<script type="text/javascript">
function byId()
{
    var video = document.getElementById("VideoPlayer");
    alert(video);

}
function lengthOfByTagName()
{
    var length = document.getElementsByTagName("object").length;
    alert(length);

}
</script>

</head>
<body>
    <object type="" id="VideoPlayer">
        <param name="allowScriptAcess" value="always" />
        <param name="allowfullscreen" value="true" />
        VideoPlayer element
    </object>
    <br>
    <br>
    <a href="#" onclick="javascript:byId()">getElementById("VideoPlayer")</a>
    <br>
    <a href="#" onclick="javascript:lengthOfByTagName()">getElementsByTagName("object").length</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T17:35:47.550

这是因为 IE 对待 <object> 节点相对于 DOM 的方式。

由于无论如何您都在动态替换，我建议您改为在需要的地方创建一个 <div> 并将 innerHTML 更改为您需要的对象的 HTML。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-02T17:37:32.040

我刚刚在 IE 7 上进行了测试，并看到了所描述的行为

Internet Explorer 不希望`<object>`标签中有自由文本。在您的示例上使用 Debugbar 证明 IE 没有构建正确的 DOM 树。

请改用此代码

```
<object type="" id="VideoPlayer">
    <param name="allowScriptAcess" value="always" />
    <param name="allowfullscreen" value="true" />
</object> 
```

它将按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-11T09:18:55.157

在 IE6 中，它可能不起作用。参考：[https ://msdn.microsoft.com/en-us/library/ie/ms536437%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396](https://msdn.microsoft.com/en-us/library/ie/ms536437%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396)[杂志](http://note.taable.com)

建议使用**jQuery**处理大部分情况

```
jQuery

var video = $("#VideoPlayer");

alert(video); 
```

在你的编码中试试这个。

# css - 仅为 DOM 的一部分创建样式重置的最佳方法是什么？

> ID：334705
> 
> 赞同：1
> 
> 时间：2008-12-02T17:04:43.667
> 
> 标签：css, css-reset, css-specificity

我正在尝试创建一个仅针对我的控件的 CSS 重置。所以 HTML 看起来像这样：

```
<body>
  <img class="outterImg" src="sadkitty.gif" />
  <div id="container" class="container">
    <img class="innerImg" src="sadkitty.gif" />
    <div class="subContainer">
      <img class="innerImg" src="sadkitty.gif" />
    </div>
  </div>
  <img class="outterImg" src="sadkitty.gif" />
</body> 
```

CSS是我遇到的麻烦，但我目前正在处理这个：

```
img 
{
  // Bad style declarations for the entire page
  border: solid 3px red;  
  width: 50px;
}

.container img, .container div, .container etc.
{
  // Style reset for specific elements within my control "container"
  border: solid 3px blue;
  width: 100px;
}

.innerImg img
{
  // The target style for the specific class/element within the control
  border: solid 3px green;
  width: 200px;
} 
```

问题是“.innerImg img”没有像我期望的那样覆盖“.container img”。那么，重置“容器”元素中所有元素的样式，然后在该元素中的类上放置样式的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-02T17:33:27.650

选择器 引用类为 innerImg 的元素*内*`.innerImg img` 的 img 元素。您的文档中没有类似的内容。

 *你可能想要的是`img.innerImg`.

除此之外，还有一个用于确定遵循哪个规则的[选择器特异性的简短计算。](http://www.w3.org/TR/css3-selectors/#specificity)（该链接在任何文档中都包含我最喜欢的新限定词：“in a number system with a large base”）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T17:28:50.280

我怀疑这会导致接近您想要的结果。

```
img  
{  
  border: solid 3px red;  
  width: 50px;  
}  
.container .innerImg, .container div  
{  
  border: solid 3px blue;  
  width: 100px;  
}  
.container .subContainer  
{  
  border: none;  
}  
.subContainer .innerImg  
{  
  border: solid 3px green;  
  width: 200px;  
} 
```

# c# - 致命的执行引擎错误 (79FFEE24) (80131506)

> ID：334706
> 
> 赞同：19
> 
> 时间：2008-12-02T17:05:08.300
> 
> 标签：c#, com, clr

我的 .NET Framework 3.0 SP1 应用程序遇到问题。它是一个与 COM exe 通信的 C# winforms 应用程序。winforms 应用程序或 COM exe 随机崩溃而没有任何错误消息，并且事件日志包含以下条目：

[1958] .NET 运行时类型：错误计算机：CWP-OSL029-01 时间：2008 年 11 月 25 日下午 3:14:10 ID：1023 .NET 运行时版本 2.0.50727.1433 - 致命的执行引擎错误 (79FFEE24) (80131506)

我在 MS 网站上找不到任何有用的信息。有人知道我应该从哪里开始调查吗？

蒂亚

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-19T18:42:01.957

微软发布了一个修补程序

[https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=16827&wa=wsignin1.0)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-13T10:46:02.373

它可以是很多东西。有些人修复 .NET Framework 3.5，其他人一起重新安装 .NET。有人说它与 PowerCommands 等有关。如果一切都失败了，试试对我有用的方法：
- 在安全模式下启动 VS
- 创建一个新的 Windows 窗体应用程序
- 打开你的工具箱并删除任何特殊选项卡（对我来说，这是一个 SQLite 选项卡） - 关闭并以正常模式重新启动

如果这不起作用，祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T17:45:39.840

我遇到了这个错误，它（幸运的是）通过安装 3.5 SP1 消失了，这会将您的运行时撞到版本 2.0.50727.3053（[这](http://blogs.msdn.com/dougste/archive/2007/09/06/version-history-of-the-clr-2-0.aspx)是一个很好的版本摘要）。

在寻找解决方案时，我发现了这个错误的大量嫌疑人。有些人甚至声称它是防病毒软件（！）

YMMV，祝你好运。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-07T02:51:36.377

我在使用 asp.net mvc rc1 的 vs 2008 sp1 上遇到问题，打开 aspx 页面会使 Visual Studio 崩溃。

我的解决方法是在崩溃后重新打开解决方案/项目，设置项目 | 显示所有文件，并删除 system.web.mvc、system.web.abstractions 和 system.web.routing 的 mvc 引用。然后我就可以打开文件了。

问题稍后再次出现，但我可以按照上述操作，之后我可以打开 aspx 文件。

谢谢

埃里克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T18:16:18.250

这些似乎主要是由于框架安装不当造成的。看看你是否可以在另一台机器上重现错误，或者卸载/重新安装框架位。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T08:52:24.503

从不指向托管对象的 IntPtr 创建 GCHandle 时，我有相同的行为。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T20:26:34.997

上面的修补程序对我有用！

在我的 ASP.NET MVC (RC1) 项目中的 VS 中打开任何 *.aspx 页面时，会出现所描述的问题。

# html - 使用 CodeIgniter 获取 URL 中的参数

> ID：334708
> 
> 赞同：49
> 
> 时间：2008-12-02T17:05:36.660
> 
> 标签：html, codeigniter, post, get

我知道 codeIgniter 默认关闭 GET 参数。

但是，通过在 POST 中完成所有操作，如果您在表单提交后按回，您不会对重新发送数据请求感到恼火吗？

这让我很恼火，但我不确定我是否想纯粹出于这个原因允许 GET。

允许 GET 参数也有这么大的安全问题吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-12-02T17:36:36.223

当我第一次开始使用 CodeIgniter 时，不使用 GET 真的让我很失望。但后来我意识到你可以通过使用内置的[URI Class](http://codeigniter.com/user_guide/libraries/uri.html)操作 URI 来模拟 GET 参数。这太棒了，它使您的 URL 看起来更好。

或者，如果您真的需要 GET 工作，您可以将其放入您的控制器中：

```
parse_str($_SERVER['QUERY_STRING'], $_GET); 
```

这会将变量放回 GET 数组中。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-07-05T14:27:17.450

此函数与 post 函数相同，只是它获取 get 数据：

```
$this->input->get() 
```

[https://www.codeigniter.com/user_guide/libraries/input.html](https://www.codeigniter.com/user_guide/libraries/input.html)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-10-20T13:25:32.207

这对我有用：

```
<?php
$url = parse_url($_SERVER['REQUEST_URI']);
parse_str($url['query'], $params);
?> 
```

`$params`数组包含在 ? 之后传递的参数 特点

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-08-01T18:49:52.073

现在从 CodeIgniter 2.1.0 可以正常工作了

```
 //By default CodeIgniter enables access to the $_GET array.  If for some
    //reason you would like to disable it, set 'allow_get_array' to FALSE.

$config['allow_get_array']      = TRUE; 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-11-09T07:00:50.900

您只需要在 config.php 中启用它，您就可以使用它`$this->input->get('param_name');`来获取参数。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-06-01T09:53:28.220

如果您需要第一个参数，请使用它。

```
$this->uri->segment('3'); 
```

你需要第二个参数使用它

```
$this->uri->segment('4'); 
```

有你的许多参数增强参数

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-06-24T18:33:26.113

`parse_str($_SERVER['QUERY_STRING'],$_GET);` 仅在我将以下行添加到 applications/config/config.php 后才为我工作：

`$config['uri_protocol'] = "PATH_INFO";`

我发现 $_GET 参数在 CI 中并不是真正需要的，但是 Facebook 和其他网站将 GET 参数转储到链接的末尾，这对于我的 CI 站点来说是 404！通过在 config.php 中添加上面的行，这些页面就可以工作了。我希望这对人们有帮助！

（来自[https://web.archive.org/web/20101227060818/http://www.maheshchari.com/work-to-get-method-on-codeigniter/](https://web.archive.org/web/20101227060818/http://www.maheshchari.com/work-to-get-method-on-codeigniter/)）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-11-27T21:43:11.713

如果您真的坚持，您可以启用查询字符串。在您的 config.php 中，您可以启用查询字符串：

```
$config['enable_query_strings'] = TRUE; 
```

有关更多信息，您可以查看此 Wiki 页面的底部： http: [//codeigniter.com/user_guide/general/urls.html](http://codeigniter.com/user_guide/general/urls.html)

不过，学习使用干净的 url 是一个更好的建议。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-08-13T09:12:20.387

“如果您在提交表单后回击，您不会对重新发送数据请求感到恼火”

您可以通过从处理表单提交的页面重定向到成功页面来解决此问题。最后一个“动作”是加载成功页面，而不是表单提交，这意味着如果用户执行 F5，它只会重新加载该页面而不会再次提交表单。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-18T16:55:10.020

allesklar：这有点误导，因为脚本和机器人可以像发送普通请求一样轻松地发布数据。这不是秘密，它是 HTTP 的一部分。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-01-03T03:00:28.293

有点跑题了，但我一直在 CodeIgniter 中寻找一个 get 函数，只是为了在控制器之间传递一些变量并遇到 Flashdata。
请参阅：[http](http://codeigniter.com/user_guide/libraries/sessions.html)
: //codeigniter.com/user_guide/libraries/sessions.html Flashdata 允许您创建仅可用于下一个服务器请求的快速会话数据，然后自动清除。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-07-31T18:02:33.603

MY_Input.php：

```
<?php
// this class extension allows for $_GET access
class MY_Input extends CI_input {

    function _sanitize_globals()
    {
        // setting allow_get_array to true is the only real modification
        $this->allow_get_array = TRUE;

        parent::_sanitize_globals();
    }

}
/* End of file MY_Input.php */
/* Location: .application/libraries/MY_Input.php */ 
```

MY_URI.php：

```
<?php
/*
 | this class extension allows for $_GET access by retaining the
 | standard functionality of allowing query strings to build the 
 | URI String, but checks if enable_query_strings is TRUE
*/
class MY_URI extends CI_URI{

    function _fetch_uri_string()
    {
        if (strtoupper($this->config->item('uri_protocol')) == 'AUTO')
        {
            // If the URL has a question mark then it's simplest to just
            // build the URI string from the zero index of the $_GET array.
            // This avoids having to deal with $_SERVER variables, which
            // can be unreliable in some environments
            //
            //  *** THE ONLY MODIFICATION (EXTENSION) TO THIS METHOD IS TO CHECK 
            //      IF enable_query_strings IS TRUE IN THE LINE BELOW ***
            if ($this->config->item('enable_query_strings') === TRUE && is_array($_GET) && count($_GET) == 1 && trim(key($_GET), '/') != '')
            {
                $this->uri_string = key($_GET);
                return;
            }

            // Is there a PATH_INFO variable?
            // Note: some servers seem to have trouble with getenv() so we'll test it two ways
            $path = (isset($_SERVER['PATH_INFO'])) ? $_SERVER['PATH_INFO'] : @getenv('PATH_INFO');
            if (trim($path, '/') != '' && $path != "/".SELF)
            {
                $this->uri_string = $path;
                return;
            }

            // No PATH_INFO?... What about QUERY_STRING?
            $path =  (isset($_SERVER['QUERY_STRING'])) ? $_SERVER['QUERY_STRING'] : @getenv('QUERY_STRING');
            if (trim($path, '/') != '')
            {
                $this->uri_string = $path;
                return;
            }

            // No QUERY_STRING?... Maybe the ORIG_PATH_INFO variable exists?
            $path = str_replace($_SERVER['SCRIPT_NAME'], '', (isset($_SERVER['ORIG_PATH_INFO'])) ? $_SERVER['ORIG_PATH_INFO'] : @getenv('ORIG_PATH_INFO'));
            if (trim($path, '/') != '' && $path != "/".SELF)
            {
                // remove path and script information so we have good URI data
                $this->uri_string = $path;
                return;
            }

            // We've exhausted all our options...
            $this->uri_string = '';
        }
        else
        {
            $uri = strtoupper($this->config->item('uri_protocol'));

            if ($uri == 'REQUEST_URI')
            {
                $this->uri_string = $this->_parse_request_uri();
                return;
            }

            $this->uri_string = (isset($_SERVER[$uri])) ? $_SERVER[$uri] : @getenv($uri);
        }

        // If the URI contains only a slash we'll kill it
        if ($this->uri_string == '/')
        {
            $this->uri_string = '';
        }
    }

}
/* End of file MY_URI.php */
/* Location: .application/libraries/MY_URI.php */ 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-05-23T19:03:37.420

我的参数是 ?uid=4 并通过以下方式获取：

```
$this->uid = $this->input->get('uid', TRUE);
  echo $this->uid; 
```

威斯

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-02T17:08:13.613

GET 参数由 Web 浏览器缓存，POST 不是。因此，使用 POST 您不必担心缓存，这就是通常首选它的原因。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-09T03:46:04.377

更容易：

```
curl -X POST -d "param=value&param2=value" http://example.com/form.cgi 
```

不过那个插件很酷。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-09-30T15:47:30.823

你可以试试这个

```
$this->uri->segment(''); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-06-17T07:19:03.033

在下面执行此操作。为我工作。我从一个选择框和另一个文本框中获取值。然后在按钮单击时，我在 Javascript 函数中获取了整个数据并使用 javascript 进行了重定向。

```
//Search Form
$(document).ready (function($){
    $("#searchbtn").click(function showAlert(e){
        e.preventDefault();
        var cat = $('#category').val();
        var srch = $('#srch').val();

        if(srch==""){
            alert("Search is empty :(");
        }
        else{
            var url = baseurl+'categories/search/'+cat+'/'+srch;            
            window.location.href=url;
        }
    });
}); 
```

上面的代码对我有用。

# c# - 创建一个 Rich Repeater，DataBind 清除自定义添加的控件

> ID：334723
> 
> 赞同：2
> 
> 时间：2008-12-02T17:14:00.217
> 
> 标签：c#, asp.net, custom-server-controls

所以...我有一个聪明的想法，我会创建自己的 Repeater 控件，通过继承 Repeater 并扩展它的功能来实现分页和排序。我找到了一些关于如何解决这个问题的信息和点点滴滴，一切似乎都很好......

我创建了一个 WebControlLibrary 来存放我的自定义控件。除了丰富的转发器，我还创建了一个复合控件，它可以充当“分页栏”，具有前进、后退和页面选择。我的寻呼栏 100% 自己工作，当用户与之交互时正确触发分页更改事件。丰富的转发器数据绑定没有问题，但是当数据绑定触发时（当我调用 base.databind() 时），控件集合被清除并且我的寻呼栏被移除。这搞砸了寻呼栏的视图状态，使它们无法正确触发事件或维持其状态。

我尝试在 base.databind() 触发后将控件添加回集合，但这并不能解决问题。我开始得到非常奇怪的结果，包括更改控制树层次结构的问题（通过添加 [ViewStateModeById] 解决）。

在我回到绘图板并创建第二个复合控件之前，它包含一个中继器和寻呼栏（这样中继器不负责寻呼栏的视图状态），有没有关于如何解决问题的想法？

为了共享和共享的利益，转发器本身的代码如下，分页栏并不重要，因为问题实际上是维护任何其他子控件的状态。（原谅一些代码的粗糙......它仍在进行中）

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Text;
using System.Data;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

[ViewStateModeById]
public class SortablePagedRepeater : Repeater, INamingContainer {

    private SuperRepeaterPagerBar topBar = new SuperRepeaterPagerBar();
    private SuperRepeaterPagerBar btmBar = new SuperRepeaterPagerBar();

    protected override void OnInit(EventArgs e) {
        Page.RegisterRequiresControlState(this);

        InitializeControls();
        base.OnInit(e);
        EnsureChildControls();
    }

    protected void InitializeControls() {
        topBar.ID = this.ID + "__topPagerBar";
        topBar.NumberOfPages = this._currentProperties.numOfPages;
        topBar.CurrentPage = this.CurrentPageNumber;
        topBar.PageChanged +=
            new SuperRepeaterPagerBar.PageChangedEventHandler(PageChanged);

        btmBar.ID = this.ID + "__btmPagerBar";
        btmBar.NumberOfPages = this._currentProperties.numOfPages;
        btmBar.CurrentPage = this.CurrentPageNumber;
        btmBar.PageChanged +=
            new SuperRepeaterPagerBar.PageChangedEventHandler(PageChanged);
    }

    protected override void CreateChildControls() {
        EnsureDataBound();

        this.Controls.Add(topBar);
        this.Controls.Add(btmBar);
        //base.CreateChildControls();
    }

    private void PageChanged(object sender, int newPage) {
        this.CurrentPageNumber = newPage;
    }

    public override void DataBind() {
        //pageDataSource();

        //DataBind removes all controls from control collection...
        base.DataBind();
        Controls.Add(topBar);
        Controls.Add(btmBar);
    }

    private void pageDataSource() {
        //Create paged data source
        PagedDataSource pds = new PagedDataSource();

        pds.PageSize = this.ItemsPerPage;
        pds.AllowPaging = true;

        // first get a PagedDataSource going and perform sort if possible...
        if (base.DataSource is System.Collections.IEnumerable) {
            pds.DataSource = (System.Collections.IEnumerable)base.DataSource;
        } else if (base.DataSource is System.Data.DataView) {
            DataView data = (DataView)DataSource;
            if (this.SortBy != null && data.Table.Columns.Contains(this.SortBy)) {
                data.Sort = this.SortBy;
            }
            pds.DataSource = data.Table.Rows;
        } else if (base.DataSource is System.Data.DataTable) {
            DataTable data = (DataTable)DataSource;
            if (this.SortBy != null && data.Columns.Contains(this.SortBy)) {
                data.DefaultView.Sort = this.SortBy;
            }
            pds.DataSource = data.DefaultView;
        } else if (base.DataSource is System.Data.DataSet) {
            DataSet data = (DataSet)DataSource;
            if (base.DataMember != null && data.Tables.Contains(base.DataMember)) {
                if (this.SortBy != null && data.Tables[base.DataMember].Columns.Contains(this.SortBy)) {
                    data.Tables[base.DataMember].DefaultView.Sort = this.SortBy;
                }
                pds.DataSource = data.Tables[base.DataMember].DefaultView;
            } else if (data.Tables.Count > 0) {
                if (this.SortBy != null && data.Tables[0].Columns.Contains(this.SortBy)) {
                    data.Tables[0].DefaultView.Sort = this.SortBy;
                }
                pds.DataSource = data.Tables[0].DefaultView;
            } else {
                throw new Exception("DataSet doesn't have any tables.");
            }
        } else if (base.DataSource == null) {
            // don't do anything?
        } else {
            throw new Exception("DataSource must be of type System.Collections.IEnumerable.  The DataSource you provided is of type " + base.DataSource.GetType().ToString());
        }

        if (pds != null && base.DataSource != null) {
            //Make sure that the page doesn't exceed the maximum number of pages 
            //available
            if (this.CurrentPageNumber >= pds.PageCount) {
                this.CurrentPageNumber = pds.PageCount - 1;
            }

            //Set up paging values...
            btmBar.CurrentPage = topBar.CurrentPage = pds.CurrentPageIndex = this.CurrentPageNumber;
            this._currentProperties.numOfPages = btmBar.NumberOfPages = topBar.NumberOfPages = pds.PageCount;

            base.DataSource = pds;
        }
    }

    public override object DataSource {
        get {
            return base.DataSource;
        }
        set {
            //init();  //reset paging/sorting values since we've potentially changed data sources.
            base.DataSource = value;
            pageDataSource();
        }
    }

    protected override void Render(HtmlTextWriter writer) {
        topBar.RenderControl(writer);
        base.Render(writer);
        btmBar.RenderControl(writer);
    }

    [Serializable]
    protected struct CurrentProperties {
        public int pageNum;
        public int itemsPerPage;
        public int numOfPages;
        public string sortBy;
        public bool sortDir;
    }

    protected CurrentProperties _currentProperties = new CurrentProperties();

    protected override object SaveControlState() {
        return this._currentProperties;
    }

    protected override void LoadControlState(object savedState) {
        this._currentProperties = (CurrentProperties)savedState;
    }

    [Category("Status")]
    [Browsable(true)]
    [NotifyParentProperty(true)]
    [DefaultValue("")]
    [Localizable(false)]
    public string SortBy {
        get { return this._currentProperties.sortBy; }
        set {
            //If sorting by the same column, swap the sort direction.
            if (this._currentProperties.sortBy == value) {
                this.SortAscending = !this.SortAscending;
            } else {
                this.SortAscending = true;
            }
            this._currentProperties.sortBy = value;
        }
    }

    [Category("Status")]
    [Browsable(true)]
    [NotifyParentProperty(true)]
    [DefaultValue(true)]
    [Localizable(false)]
    public bool SortAscending {
        get { return this._currentProperties.sortDir; }
        set { this._currentProperties.sortDir = value; }
    }

    [Category("Status")]
    [Browsable(true)]
    [NotifyParentProperty(true)]
    [DefaultValue(25)]
    [Localizable(false)]
    public int ItemsPerPage {
        get { return this._currentProperties.itemsPerPage; }
        set { this._currentProperties.itemsPerPage = value; }
    }

    [Category("Status")]
    [Browsable(true)]
    [NotifyParentProperty(true)]
    [DefaultValue(1)]
    [Localizable(false)]
    public int CurrentPageNumber {
        get { return this._currentProperties.pageNum; }
        set { 
            this._currentProperties.pageNum = value;
            pageDataSource();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-14T07:30:20.150

您还可以使用新的[ASP.NET ListView 控件](http://msdn.microsoft.com/en-us/library/bb398790.aspx)（从 .Net 3.5 开始）它具有分页/排序数据绑定和模板，这意味着您可以将其用作中继器或非常轻松地执行复杂的操作，例如带有内联编辑的网格等显示。

# c# - 创建一个新列表

> ID：334725
> 
> 赞同：3
> 
> 时间：2008-12-02T17:14:31.820
> 
> 标签：c#, .net, performance, collections

创建新列表时，您是指定初始大小还是将其留空？我知道，通过指定初始大小，您可以避免每次添加 x 个项目时列表都重新分配底层数组，但您也会在代码中添加详细程度。最小的性能提升是否值得为您的代码增加冗长和复杂性。当该列表需要多一项而您忘记在初始化中添加一项时会发生什么情况，您仍然会遭受重新分配的性能开销，现在这个数字对新开发人员可能没有意义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T17:14:50.433

如果您知道如何使用它，则应始终指定初始大小，因为 C# 以四 (!) 的大小开始列表，并且随着列表的增长其大小翻倍。这不是一个微优化，因为给 .Net 提示只需付出很少的努力。可读性不是问题，特别是如果您可以避免使用[幻数](http://en.wikipedia.org/wiki/Magic_number_(programming))。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T18:58:31.550

如果您真的不能准确（并且轻松）预测列表的大小，请不要打扰。

不要围绕提前确定它构建任何代码（更少的代码==更好的代码）。

此外，就性能而言，加倍是增加列表的一种非常有效的方法。

4 8 16 32 64 128 256 512 1024 ......你明白了。

# .net - ASP.NET/ADO.NET：在 .NET 对象中处理许多数据库连接？

> ID：334729
> 
> 赞同：3
> 
> 时间：2008-12-02T17:15:08.137
> 
> 标签：.net, asp.net, ado.net, oop, database-connection

我们有一个 .NET 对象，它对数据库进行大量读/写操作。在此对象（或使用它的 asp 页面）的整个生命周期中，它可能会通过查询/更新访问数据库 1 到 10 次。

不是每次对象需要访问数据库时打开和关闭数据库连接，它只是在实例化期间打开到数据库的连接，然后在对象的终止事件期间关闭连接。这是一个坏习惯吗？

假设是，由于对象每次实例化（通常是多次）都会访问数据库，所以最好在对象生命的开始时打开一个连接，然后在结束时关闭它。

另一种选择是在每次查询/操作之前和之后打开和关闭数据库连接。

为了最大限度地提高性能，这里的最佳做法是什么？

****更新****感谢您的提示。谁能更多地谈论在对象的实例化/终止事件中打开/关闭连接的方法以及这样做的后果？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-02T17:20:22.807

根据需要打开关闭连接。ADO.NET 内置了可以工作的连接池。除非您在数千个打开/关闭的循环中执行此操作，否则您不会注意到任何性能问题。

*编辑* 请参阅[我应该在我的数据访问层中保留一个 sqlconnection 吗？](https://stackoverflow.com/questions/247247/should-i-persist-a-sqlconnection-in-my-data-access-layer)有关连接持久性陷阱的更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T17:20:40.793

每次打开和关闭...在实际执行数据库操作的代码行之前立即打开（尽可能关闭），之后立即关闭。当您以这种方式执行此操作时，ADO.net 实际上并没有关闭连接，它只是将其释放回 ADO.net 连接池，它坐在那里等待下一个具有相同连接字符串的连接请求。您不会每次都实际重新创建连接的开销...

唯一的问题是，如果您异步执行的连接尝试次数超过池中的最大连接数......并且使用 System.Threading.ThreadPool 类也有解决此问题的方法......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T17:57:58.660

为了增加对连接池参数的信任 - 保持连接打开的时间超过需要实际上*会降低*整体性能，因为连接池无法将该连接共享给需要数据库连接的其他组件。

所以，是的，根据需要打开和关闭连接。但是，如果您可以将查询批处理到单个 exec 调用中，它会更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T15:23:08.263

即使 ado.net 实际上没有关闭连接，当您这样做时： Conn.Close() 它会在服务器上执行“sp_reset_connection”，即使 sp_reset_connection 是轻量级存储过程，它也会产生一些网络流量。因此，例如，我不建议在循环内关闭和打开连接。

# windows - 即时修改/替换 Exe

> ID：334733
> 
> 赞同：1
> 
> 时间：2008-12-02T17:16:37.463
> 
> 标签：windows, executable

每当我下载 Firefox 更新并应用它时，卡巴斯基杀毒软件都会提醒我文件 FIREFOX.EXE 已被修改。我想知道他们是怎么做到的。是否可以做一个简单的程序来演示这个技巧。就像可执行文件最初会显示“Hello, World!”一样 在提示符下，当我替换/修改示例可执行文件时，它必须显示“Hello，World！Mod”。

## 谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T17:30:42.210

我的印象是 Firefox 在有更新时会运行另一个应用程序并自行退出。然后，帮助应用程序会替换 .exe。这样，它就不会在运行时修改自己。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T17:24:05.453

简单的方法是使用[FindFirstChangeNotification](http://msdn.microsoft.com/en-us/library/aa364417(VS.85).aspx)方法。但我的猜测是，防病毒软件正在使用[系统挂钩](http://msdn.microsoft.com/en-us/library/ms997537.aspx)或其他机制在某个较低级别进行挂钩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T17:27:07.583

我不具体知道 Firefox 是如何进行升级的，但有一些常见的方法：

*   在允许它的文件系统（如 NTFS）上，然后重命名当前运行的 .exe，写入其替换，然后链接到新的

*   有一个小的启动程序，它在切换到它之前对主 exe 进行任何更新。

*   各种技巧，包括让临时前任跳到他们身边，然后跳回来等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T12:06:56.860

我正在寻找 C++ 中的自我修改代码。我认为程序可以通过将它们与窗口分离来修改自己

# php - 使用 Zend Lucene 搜索 PDF 文件

> ID：334745
> 
> 赞同：1
> 
> 时间：2008-12-02T17:24:21.007
> 
> 标签：php, zend-framework, lucene

有没有办法使用 Zend_Search_Lucene 来搜索/索引 PDF 文档？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T17:31:42.987

[http://www.kapustabrothers.com/2008/01/20/indexing-pdf-documents-with-zend_search_lucene/](http://www.kapustabrothers.com/2008/01/20/indexing-pdf-documents-with-zend_search_lucene/)

# c++ - 在 C++ 状态机中实现事件条件

> ID：334746
> 
> 赞同：3
> 
> 时间：2008-12-02T17:24:25.793
> 
> 标签：c++, interface, lambda, state-machine, fsm

我将分层 FSM 用于嵌入式 C++ 应用程序接口。我想使用小函数来确定是否可以触发某些状态间事件，以及使用它们来影响数据库中的更改：但是，为每个状态创建一个具有不同事件函数的新类也令人生畏将指向它们的指针设置为回调。（我们在这里谈论 300 个函数。）

如果 C++ 支持 lambda 函数，我会使用它们，但我对项目架构没有太大的权重，所以我不愿意使用需要大量库集成（如 boost）或包含的第三方解决方案额外的预处理器步骤。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T18:14:25.240

实际上，如果您使用 Boost/TR1 库，则支持[Lambda 函数](http://www.boost.org/doc/libs/1_37_0/doc/html/lambda.html)。详情可在[Boost 网站上](http://www.boost.org/)找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-23T13:33:40.350

你看过 Qt 的[QStateMachine](http://doc.qt.nokia.com/latest/statemachine-api.html)吗？它可能会提供一些灵感。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T18:58:38.070

新的[C++0x 标准](http://en.wikipedia.org/wiki/C%2B%2B0x)即将完成并被接受。明年推出时，它最终应该是 C++09。该标准将直接在语言中包含[Lambda 函数](http://en.wikipedia.org/wiki/C%2B%2B0x#Lambda_functions_and_expressions)，并且不再需要类似的 boost 库。[Visual Studio 2010 技术预览版中的 C++ 编译器已经支持Visual C++ 团队博客](http://blogs.msdn.com/vcblog/archive/2008/10/28/lambdas-auto-and-static-assert-c-0x-features-in-vc10-part-1.aspx)中的 Lambda 函数。

或者，您可以为您的逻辑创建[Lua](http://www.lua.org/)绑定并使用表来处理 FSM，[如本 wiki 所示](http://lua-users.org/wiki/FiniteStateMachine)。这是一个非常灵活的解决方案，允许在不重新编译 C++ 项目的情况下调整 FSM。此外，Lambda 函数（以及[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))）在 Lua 下是原生且稳定的。[Lua 协程](http://lua-users.org/wiki/CoroutinesTutorial)也值得研究以简化您的 FSM 实现。

# text - 仅在文本框中显示唯一字符

> ID：334748
> 
> 赞同：-3
> 
> 时间：2008-12-02T17:24:51.097
> 
> 标签：text, webforms

如果我从文本框输入

> AaBbcdCDEb

输出应该是

> ABCDE 或 abcde

只有唯一的字符应该在那里，没有重复的字符。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T17:27:53.650

对字符数组使用 Distinct 扩展方法，然后将它们重新组合成一个字符串。

```
new string("AaBbcdCDEb".ToLower().Distinct().ToArray()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T18:40:32.803

```
string input = "AABBCCDD";
string output = string.empty; 
foreach(char c in input)
    if (!output.Contains(c))
        output += c; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T17:30:49.493

foreach 字符在文本框中，如果文本框/新字符串包含字符则返回，否则添加到新字符串？

# version-control - darcs 修改记录工作流程

> ID：334753
> 
> 赞同：4
> 
> 时间：2008-12-02T17:26:37.333
> 
> 标签：version-control, darcs

录制补丁，将其拉入我的暂存分支，然后意识到我做了一些小而愚蠢的事情，比如日志消息中的拼写错误，或者类似的琐碎的事情并不罕见，这并不罕见（在我看来）全新的补丁。

在这些情况下，我一直在使用：

```
darcs amend-record 
```

更新补丁。但是当我重新拉动 darcs 时会将补丁视为冲突，因此我最终不得不取消记录并恢复暂存分支中的补丁，然后再次拉动它。

是否有 darcs 命令或选项可以让我更简单地拉出修改后的补丁？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-23T20:33:34.550

并不真地。修改补丁使其成为不同的补丁，即使名称与以前相同。amend-record 通常只在本地 repo 中使用，在补丁被推送/拉到其他地方之前。如果补丁已被推送到其他存储库，您需要在其中删除它，然后重新提取修改后的版本。（obliterate 是“unpull”的现代拼写）。

或者，使用回滚命令；当有问题的存储库是公开的并被多个开发人员使用时，这会更加友好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T22:09:47.930

您可以尝试首先在暂存分支上运行 darcs unpull，然后拉入修改后的补丁。

# python - PyS60 会生成原生的 sis 文件吗？

> ID：334765
> 
> 赞同：9
> 
> 时间：2008-12-02T17:30:18.653
> 
> 标签：python, symbian, s60, pys60

我目前正在考虑为 S60 平台开发移动应用程序，并且特别关注 PyS60。似乎表明它可以编译为本机 .sis 文件，而无需嵌入式 python 解释器。通读文档，我找不到任何明确提到这一点的陈述。虽然我现在正在下载 SDK、仿真器和在 Linux 上测试开发所需的一整套工具链，但我想在此期间我会在这里问一下。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-22T13:59:10.377

在 python 中编写代码后，您可以使用 ensymble 将其转换为 .sis 文件。

[http://code.google.com/p/ensymble/](http://code.google.com/p/ensymble/)

该软件允许您使用 py2sis 选项将 .py 文件转换为 .sis 文件 - 但是，它在没有安装 python 的任何手机上都没有多大用处，因此您可能还需要使用 ensymble 来合并新创建的.sis 和 python 的 .sis 文件，命令如下

./ensymble.py mergesis --verbose your-script-name.sis PythonForS60-1-4-5-3rdEd.sis final-app-name.sis

生成的 final-app-name.sis 文件将安装您的文件和 python。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-03T14:33:34.953

Linux 尚未正式支持 Series60 开发。奇怪的是，使用 Windows 会为您省去很多麻烦。

就 Python 而言，我认为开发的应用程序被打包成一个 .sis 文件，但仍然需要 PyS60 解释器在安装后运行。

# c# - 在另一个表单上设置标签文本的问题

> ID：334770
> 
> 赞同：2
> 
> 时间：2008-12-02T17:31:02.973
> 
> 标签：c#, winforms

我正在尝试通过增加字体大小来使 Kiosk 应用程序更易于访问。
主窗体上没有问题。
我在用具有相同消息的小表单替换 MessageBoxes（我认为无法增加字体大小）时遇到问题。

这就是我遇到问题的地方。主窗体*看不到*错误窗体及其设置文本的标签。我尝试在错误表单上为私有标签设置一个属性，但它仍然无法正常工作。

我将非常感谢任何帮助。我一直在尝试应用我在阅读来自各种 C# 源的多个线程时学到的知识。

我注意到了两件奇怪的事情：

1.  在 MainForm 中，当我键入 ErrorForm 时，会弹出 Intellisense 建议代码列表，但该变量`LblNotCheckedInBecause`未出现在列表中。
2.  编译器错误说明了`LBlNotCheckedInBecause`.get 语句，在我看来它应该引用 set 语句，因为我正在尝试设置该值。

以下是我认为涉及的代码部分：

来自`ErrorForm.Designer.cs`：

```
private System.Windows.Forms.Panel panel1;
private System.Windows.Forms.Label lblNotCheckedInBecause;

// property I created to try to be able to change the label
public string LblNotCheckedInBecause  
{
    get { return this.lblNotCheckedInBecause.Text; }
    set { this.lblNotCheckedInBecause.Text = value; }
} 
```

来自`MainForm.cs`：

```
// this is what I'm trying to replace
MessageBox.Show("You were not checked in because of the following reasons:" + sErrors);

// this line is causing a compiler error
ErrorForm.LblNotCheckInBecause = "You were not checked in because of the following reasons:" + sErrors; 
```

编译器错误：

> 错误 1 ​​非静态字段、方法或属性需要对象引用 'LogisticsKiosk.ErrorForm.LblNotCheckInBecause.get' C:\Documents and Settings\My Documents\Visual Studio 2005\Projects\LogisticsKiosk\Forms\MainForm.cs 107 17物流亭

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T17:35:57.410

您不能像访问静态的一样访问 ErrorForm。这只是类定义，您需要在 ErrorForm 的实例上设置属性。

在您的应用程序的某个地方，您创建了一个新的 ErrorForm。您需要获取该变量并在其上设置您的 LblNotCheckedInBecause 属性。

寻找这样的代码；

```
ErrorForm errorFrm = new ErrorForm();
errorFrm.Show(); 
```

然后，如果您有对该变量的引用，则可以执行此操作；

```
errorFrm.LblNotCheckedInBecause = "Some Reason"; 
```

以下内容不起作用，因为您的 Property 不是静态的（并且如果不创建您可能不想做的单例就不能使其成为静态）

```
// Doesn't work
ErrorForm.LblNotCheckedInBecause = "Some Reason"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T21:21:51.633

One other quick thing to beware of: You mentioned you edited the code in: ErrorForm.Designer.cs.

I'd suggest putting your added code in ErrorForm.cs instead. The compiler likes to think that it has exclusive rights to XXXXXX.Designer.cs, and has been known to blow away changes when it makes an autoedit to the file.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T17:38:22.227

您需要在使用前实例化 ErrorForm 类。你不能像静态的那样使用你的表单。

```
ErrorForm ef = new ErrorForm();
ef.LblNotCheckedInBecause   = "Your error text";
ef.Show(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T17:59:23.307

**感谢大家的帮助。实例化表单后，我能够使代码正常工作。有趣的是，Intellisense 花了几分钟才赶上。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T21:09:54.450

要始终牢记的一件事是，其他开发人员阅读和理解您的代码是多么容易。我看到的最好的选择是这个

ErrorForm 表单 = 新的 ErrorForm(); form.SetErrorLableMessageTo("错误文本"); form.Show();

这是非常可读的。在构造函数中传递参数并没有显示意图，直到我们去看看构造函数中发生了什么。另外，并非在所有情况下您都想这样做，如果您选择构造函数方式，那么您将受到约束（不是灵活的设计）。

# c - Microsoft Visual C++ Express 编译器是否编译 C 代码？

> ID：334774
> 
> 赞同：2
> 
> 时间：2008-12-02T17:31:53.923
> 
> 标签：c, compiler-construction

我不确定，visual c++ compiler express edition是否可以用于编译c，如果没有，有人可以将我链接到一个易于使用的c编译器。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T17:36:43.023

添加到[Bill The Lizard 的答案](https://stackoverflow.com/questions/334774/c-compiler#334778)- 如果文件具有`.c`扩展名，任何 C++ 编译器都将使用 C 语言规则编译文件。这可以被覆盖以强制使用命令行选项将文件编译为 C 或 C++。

这是使用 MSVC 完成的，使用`/Tc`or`/TC`选项编译为 C，使用`/Tp`or`/TP`选项编译为 C++。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T17:33:40.143

是的，它会起作用。C 是 C++ 的一个子集（除了极少数例外情况）。任何 C++ 编译器都应该使用有效的 C 代码。

[请参阅此问题](https://stackoverflow.com/questions/304088/is-c-code-still-considered-c)的答案，了解一些罕见的非有效 C++ 的 C 代码示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-04T19:52:08.443

[您可以下载Digital Mars C](http://www.digitalmars.com/download/freecompiler.html)编译器的免费副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T17:43:24.040

[http://www.bloodshed.net/compilers/index.html](http://www.bloodshed.net/compilers/index.html)

也许那里有你喜欢的东西。

也总是有 gcc： http: [//gcc.gnu.org/](http://gcc.gnu.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T18:01:47.467

部分取决于你在说什么 C。Visual C++ 将愉快地编译 C 程序（确保它们具有 .c 扩展名，并确保“C/C++”属性页的“高级”部分中的“编译为”选项未设置为仅 C++） ，但在 C99 标准中缺少很多东西。如果您对原始标准 C 感兴趣，Visual C++ 会很好地工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T19:41:38.887

只是一个小小的说明——Visual C++ 不是编译器，而是 IDE。编译器将是 cl.exe 并且很遗憾用 cl 编译 C 代码没有问题。
但是还有其他选项，例如[gcc 的 Windows 端口](http://www.mingw.org/)或[Watcom 编译器](http://www.openwatcom.org/index.php/Main_Page)

# php - 保护数据库连接字符串的最佳方法是什么？

> ID：334776
> 
> 赞同：11
> 
> 时间：2008-12-02T17:33:10.193
> 
> 标签：php, database, linux, security, connection-string

我正在用 PHP 编写一组数据库驱动的应用程序。这些应用程序将以自己的用户身份在 Linux 服务器上运行。其他用户有时可能会在系统上，但具有非常受控制的访问权限。他们根本无法访问的其他服务器。我还将向需要编写 Perl 脚本的开发人员公开一个限制存储过程 API，这些脚本使用 DBI 和我编写的一组函数来访问数据库。

我的问题是保护其中包含连接字符串的配置文件的最佳方法是什么？

对文件具有 [4+]00 权限的其他用户是否足够？我应该加密它们吗？这似乎只是将问题转移到其他地方，所以我担心在哪里存储加密密钥。我意识到 Perl 开发人员需要有自己的连接字符串，因为他们只有执行数据库权限。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-02T18:12:57.023

如果机器真的以传统的 Unix 方式进行管理，其中 J. Random 用户不会一直使用 root，我会说文件系统权限是你最好的选择。如果有人获得未经授权的 root 访问权限，那么再多的愚蠢加密也不会“保护”连接字符串。

我会将带有连接字符串的文件标记为“脚本用户”拥有，并按照您的描述授予他们访问权限。

（在这个例子中，意识到加密连接字符串不会给你带来任何好处，真是太棒了。通过默默无闻的安全性会适得其反。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T18:21:00.220

这是一个免费 Apache 模块的链接，该模块有助于管理对密码存储的访问：

[http://uranus.it.swin.edu.au/~jn/linux/php/passwords.htm](http://uranus.it.swin.edu.au/~jn/linux/php/passwords.htm)

这对我来说似乎有点复杂，并且需要您在 mod_php 下运行 PHP。而且它仍然没有解决有权访问服务器的未经授权的人只能读取您的密码文件的可能性。

我认为您必须依赖文件权限，并相信未经授权的人无法`sudo`访问您的 PHP 应用程序 UID 或 root。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T18:18:13.393

到目前为止，我最好的解决方案是将配置文件存储在加密分区中，这样可以直接访问机器的人无法通过将驱动器连接到另一台 PC 来获取密码，并且具有文件系统权限，因此人们无法读取来自操作系统本身的文件。

但是，您需要了解，对于直接访问机器的攻击者，您无能为力。如果它在运行数据库服务器本身，那么如果他可以修改数据库本身，那么保护配置文件不会有太大的影响。只要确保一切都尽可能安全，您可能会没事的。

# testing - TDD 和测试优先开发（或测试优先编程）之间有区别吗？

> ID：334779
> 
> 赞同：55
> 
> 时间：2008-12-02T17:33:42.063
> 
> 标签：testing, tdd, testing-strategies, test-first

这两个想法听起来与我非常相似，但可能存在细微的差异或完全相同的东西，以不同的方式解释。TDD 和测试优先开发/编程之间有什么关系？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-12-02T17:43:57.673

在驱动因素是什么方面存在差异。

您是否对类（或系统——当然，这可以在不同的尺度上发生）应该是什么样子有一个模糊的概念，然后想出一些测试来赋予它实际的形状？这就是TDD。

您是否确切知道该类的公共 API 应该是什么，并且只是在实现之前编写测试？那是测试优先的开发。

我的风格往往是两者的混合。有时，在编写任何测试之前，API 应该是什么是显而易见的——在其他情况下，可测试性真正推动了设计。

换句话说，TDD 从“我想问什么问题？”开始。而非 TDD（无论是否先测试）以“我想给出什么答案？”开头

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-12-02T20:03:01.903

它们基本上是描述同一事物的不同名称 - 实际上是五个名称，因为最后一个 D 可以代表设计和开发。

测试优先是最初使用的术语，特别是在极限编程的上下文中，用于测试-代码-重构周期。测试驱动开发这个名称后来被提出 - 并很快被采用 - 强调 TFD 是 - 并且一直是 - 更多的设计策略而不是测试策略。

显然今天有些人对这两个术语有不同的含义，但这不是他们存在的意图，我不会依赖它是常识（因为它不是）。实际上，我宁愿将 TFD 一词视为已弃用。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-07-17T18:13:50.197

有很多类似的术语，例如测试优先编程、测试优先开发、测试驱动开发甚至测试驱动设计。澄清几点很重要：

**1\. 测试优先编程（TFP）**

术语测试优先编程是一种编程最佳实践。Kent Beck 在他的《Extreme Programming Explained》一书中重新引入（如果不是创造的话）：“在编程之前编写单元测试并保持所有测试始终运行”。因此，在谈论测试优先编程时，我们谈论的是由将编写代码以满足这些测试的开发人员编写自动化单元测试。单元测试堆积起来并构建了一个可以定期运行的自动化回归测试套件。

**2\. 测试驱动开发（TDD）**

测试驱动开发 (TDD) 是 Kent Beck 在其“示例测试驱动开发”一书中介绍的一种方法的名称。这是一个软件开发过程，不仅仅是在代码之前编写测试。整本书试图通过模式、工作流程、文化等来解释它。它的一个重要方面是强调重构。

有些人使用测试优先开发、测试驱动设计或测试驱动编程等术语……有一点是肯定的：完善的方法论是测试驱动开发，而编程技术是测试优先编程。其余的要么通常是指在代码之前编写测试的想法，要么是错误地指代测试驱动开发或测试优先编程。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-02T17:42:20.673

TDD = TFD + 重构。

当您执行 TFD 时，您会应用一些重构以使代码更加通用和健壮。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-02-19T22:01:12.693

# 从历史上看是正确的：测试优先编程和测试驱动开发意味着相同的东西，但名称有所改进

在 XP（Extreme Programming）的上下文中，这是使测试优先编程和测试驱动开发流行的软件开发过程，测试优先编程被重命名为测试驱动开发，然后是测试驱动设计，因为认识到首先编写测试对软件体系结构和软件系统的设计具有极大的积极影响。

这种对建筑和设计的影响是或多或少令人惊讶的同义词的结果：

*   可测试
*   解耦
*   可重复使用的
*   可独立部署
*   可独立开发
*   独立合理

软件实体只有在解耦的情况下才能容易地重用、测试、独立部署、独立开发或容易单独推理。在实际实现之前编写测试几乎是一种确保持续解耦的万无一失的方法。

除了其他积极影响之外，这种对软件设计和架构的影响变得如此重要，以至于创建者发现值得将其从测试优先编程重命名为测试驱动开发。

测试驱动开发这个名称还有助于在接受度和正确理解方面更好地营销该方法，因为测试驱动开发这个名称比测试优先编程更强调方法的整体方面。

# 历史上不正确但有用

虽然从历史上看不正确，但我发现以下区别非常有用：

## 测试优先编程……</h2>

…是在被测代码之前编写被测代码测试的任何方法。

## 测试驱动开发……</h2>

…是测试优先编程的一个特定子集，它遵循 Robert C. Martin 所描述的测试驱动开发的 3 条法则：

> 1.  在您首先编写失败的单元测试之前，您不能编写任何生产代码。
> 2.  您不能编写超过足以失败的单元测试，并且不编译是失败的。
> 3.  您编写的生产代码不能超过足以通过当前失败的单元测试的数量。— Robert C. Martin，[测试驱动开发的三定律](http://programmer.97things.oreilly.com/wiki/index.php/The_Three_Laws_of_Test-Driven_Development "测试驱动开发的三大法则")

遵循这三个规则将使您进入所谓的红-绿-重构循环。1\. 你写了一个失败的测试。2\. 你让它通过。3\. 现在它通过了，你可以在编写下一个失败的测试之前毫不留情地重构。

请注意，安全地重构需要测试。重构意味着在不改变重要行为的情况下改变源代码的结构。但是我们怎么知道我们没有意外改变重要的行为呢？什么定义了重要的行为？这是测试有用的许多事情之一。

顺便说一句，如果你的测试妨碍了重构，那么你的测试太低级了，耦合太紧了，也许你使用了太多的模拟。

# 极限编程中其他有趣的重命名

*   持续集成 -> 持续交付 -> 持续部署；严格来说，它们的含义不同，但是，在 XP 的精神中，它从一开始就意味着持续部署，当人们赶上潮流时，人们意识到集成过于字面意思，人们在完成之前就停止了。
*   持续重构 -> 持续设计改进；重构本身并不是达到目的的手段，而是遵循更高的目的。
*   每周 40 小时 -> 可持续步伐（城市传奇：这个更名是在法国软件开发商的抗议之后发生的。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-02T17:43:22.997

TDD（测试驱动开发）是测试优先开发/编程虽然我曾经看到和听说过 TDD 意味着创建持久的、可重复的单元测试（即使在代码之后），但实际上它意味着测试是在他们正在测试的代码之前编写的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-02-02T10:06:33.627

在*Test Driven Development: By Example*中，作者*Kent Beck*明确指出“测试优先”（TF）是规则。所以TF是支配TDD的原则。后一个是过程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-02T17:38:42.567

它们是完全一样的。两者都先参考编写测试，然后编写将通过测试的代码

# c++ - goto 和析构函数兼容吗？

> ID：334780
> 
> 赞同：18
> 
> 时间：2008-12-02T17:33:54.840
> 
> 标签：c++, goto

此代码导致未定义的行为：

```
 void some_func() {
  goto undefined;
  {
    T x = T();
    undefined:
  }
} 
```

构造函数没有被调用。

但是这段代码呢？x 的析构函数会被调用吗？我想会的，但我想确定一下。:)

```
 void some_func() {
  {
    T x = T();
    goto out;
  }
  out:
} 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-02T17:35:21.217

是的，析构函数将按预期调用，就像您因异常而提前退出范围一样。

标准 6.6/2（跳转语句）：

> 在退出作用域时（无论如何完成），对于在该作用域中声明的所有具有自动存储持续时间的构造对象，将按照其声明的相反顺序调用析构函数。

# events - 埃斯珀对珊瑚8。. .事件流处理

> ID：334782
> 
> 赞同：3
> 
> 时间：2008-12-02T17:35:24.570
> 
> 标签：events, stream, esper

有没有人做过比较coral8和esper的事件流处理分析？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T21:54:24.280

我想您需要将“Esper Enterprise Edition + EsperHA”与 Coral8 进行比较，以说明 GUI + 高可用性选项。EsperTech 产品的核心是开源的（Esper / GPL 许可），而 Coral8 不是，这也可能导致不同的定价范围和策略。

我认为 Coral8 CQL 和 Esper EPL 大致相当，而且都是可扩展的。这两种产品的所有软件、文档和示例都可以在线获取。Esper 已经发布了性能基准测试结果以及运行它们的代码，尽管仅适用于相当简单的场景。比较性能的最佳方法是在我猜这两家供应商的帮助下通过概念验证。

这两家公司似乎在各个行业都获得了合理的吸引力，无论是直接客户还是通过 OEM 与 ISV 的广告客户参考。

[http://www.coral8.com](http://www.coral8.com) | [http://www.espertech.com](http://www.espertech.com)

# java - 速度：$display.list() 和对象集合

> ID：334786
> 
> 赞同：2
> 
> 时间：2008-12-02T17:36:18.157
> 
> 标签：java, velocity

Velocity DisplayTool 有一个有用的方法：

```
$display.list($list) 
```

这会将集合或数组格式化为“A、B 和 C”的形式。

问题是假设我有一个对象的 ArrayList，我如何输出特定的对象字段而不是整个对象？例如，常规循环如下所示：

```
#foreach($obj in $list)
   ${obj.title}
#end 
```

现在我只是让 obj.toString() 返回 obj.title，但是如果我需要另一个字段怎么办？

谢谢。

**更新**最终自己实现了这个方法并将其提交给 DisplayTools。所以它现在是 Tools 2.0 的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T23:51:12.907

所以你想得到一个像“title1，title2 and title3”这样的格式化字符串，其中每个元素都是一个列表的标题属性，比如说，Book对象？想到了两种方法：

1) 自己手动构建标题列表，然后将其交给 $display.list()。例如，：

```
#set($titles = [])
#foreach($obj in $list)
  $titles.add($obj.title)
#end
$display.list($titles) 
```

2) 创建一个 Velocity 宏以从列表中检索给定的属性，在您的书单上使用 title 属性调用该宏，然后将其交给 $display.list()。例如：

```
#macro(retrieveProperty $list $property $newList)
  #foreach($obj in $list)
    $newList.add(${obj.${property}})
  #end
#end

#set($titles = [])
retrieveProperty($list 'title' $titles)
$display.list($titles) 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T23:04:03.080

您可以考虑扩展 DisplayTool 以支持此功能。看看SortTool，它允许您对属性进行排序。从那里复制代码应该为您将其添加到 DisplayTool 提供了一个良好的开端。如果你这样做并且想要分享，请在 dev@velocity.apache.org 列表上告诉我们。哎呀，如果有一天我感到无聊，我可能会自己做这个。

# sharepoint - SharePoint Web 部件

> ID：334791
> 
> 赞同：1
> 
> 时间：2008-12-02T17:37:47.280
> 
> 标签：sharepoint

我想为 MOSS 发布 Intranet 门户创建一个带有安全修剪链接的 Web 部件。这个想法是根据自定义提供程序检查他们的登录用户名，以确定他们对特定链接的权限，并且将基于此呈现超链接。

对于这样的事情有什么好的方法？特别是，是否可以从“摘要链接”Web 部件继承来实现此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T18:13:12.560

如果您不必让自定义提供程序来检查权限，则可以将 SharePoint 权限应用于列表中的各个项目。然后，列表视图将被自动修剪。此外，如果您想编写自己的 Web 部件来显示它们，您可以使用 CAML 查询来检索项目，结果也将根据当前用户的权限自动修剪。

如果您确实必须使用自定义提供程序来获得权限，那么我帮不上什么忙。;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-06T23:15:10.333

对此的解决方案是创建一个自定义 xml 文件，其中包含一个属性，该属性指示是否为特定应用程序链接应用了角色 - 如果是，则另一个包含角色名称的属性。然后，该代码将使用登录用户网络身份检查自定义成员存储以进行授权检查。

# asp.net - 如何在通过分页列表向前/向后浏览时阻止 ASP.Net 网站抛出 HttpUnhandledException 异常？

> ID：334807
> 
> 赞同：5
> 
> 时间：2008-12-02T17:42:51.017
> 
> 标签：asp.net, exception, httpunhandledexception

我有一个 ASP.Net 托管网站，它将结果列表显示为 DataGrid 或 ASP.Net 中继器，并带有结果分页。

如果通过按上一个/下一个选项卡快速滚动页面，有时会引发 HttpUnhandledException 并呈现调试页面而不是下一个结果列表。

调试画面如下：

```
System.Web.HttpUnhandledException: Exception of type 'System.Web.HttpUnhandledException' was thrown. ---> System.ArgumentException: Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.
  at System.Web.UI.ClientScriptManager.ValidateEvent(String uniqueId, String argument)
  at System.Web.UI.Control.ValidateEvent(String uniqueID, String eventArgument)
  at System.Web.UI.WebControls.LinkButton.RaisePostBackEvent(String eventArgument)
  at System.Web.UI.WebControls.LinkButton.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument)
  at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument)
  at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)
  at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
  --- End of inner exception stack trace ---
  at System.Web.UI.Page.HandleError(Exception e)
  at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
  at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
  at System.Web.UI.Page.ProcessRequest()
  at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
  at System.Web.UI.Page.ProcessRequest(HttpContext context)
  at ASP.contacts_default_aspx.ProcessRequest(HttpContext context)
  at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
  at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

[我在http://blogs.msdn.com/amitsh/archive/2007/07/31/why-i-get-invalid-postback-or-callback-argument-errors.aspx](http://blogs.msdn.com/amitsh/archive/2007/07/31/why-i-get-invalid-postback-or-callback-argument-errors.aspx)找到了对此类错误的引用

但建议的解决方案是设置为 false，但这似乎会造成安全漏洞。评论推荐了几种替代方案，但似乎都相当复杂，因为它们需要向我整个站点中使用的每个 DataGrid 或 Repeater 控件添加代码。

有没有更通用的解决方案可以在不牺牲安全性的情况下完成？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-02T18:55:24.957

回发时未提供页面上的隐藏字段。其中有几个字段，它们通常是 ASP.Net 提供的“魔法”所必需的。

在您的页面指令中，您可以将 enableEventValidation=false 放在您的页面指令中以将其关闭，[但这可能是不可取的](http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableeventvalidation.aspx)。

[您可以移动编写代码以将元素移动到页面顶部](http://blogs.msdn.com/tom/archive/2008/03/14/validation-of-viewstate-mac-failed-error.aspx)

最后，我相当肯定这个确切的问题最近在 Service Pack 或 3.5 中得到修复。

- 编辑 -

我刚刚找到了设置：[RenderAllHiddenFieldsAtTopOfForm](http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.renderallhiddenfieldsattopofform.aspx)

根据 MSDN，以下版本支持：3.5 SP1、3.0 SP2、2.0 SP2

# ruby-on-rails - 使用 Apache Tiles 实现 Rails 的布局功能

> ID：334810
> 
> 赞同：0
> 
> 时间：2008-12-02T17:43:24.400
> 
> 标签：ruby-on-rails, spring, tiles, layout

有没有人尝试使用 Apache Tiles 2 复制 Ruby on Rails 的布局功能？我正在尝试将 Tiles 2 与 Spring 集成。我有一个以前为 Spring 框架编写的自定义视图解析器，它做得很好，但我正在升级到 Spring Webflow 2，我需要能够集成 Tiles 2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-01T19:47:44.380

我确实做到了这一点。这是该 Java 应用程序的一些片段。

```
<definition name="registration" template="/tiles/layouts/defaultLayout.jsp">
  <put-attribute name="body" value="undefined" />
  <put-attribute name="footer" value="/tiles/footer.jsp?alt=true" />
</definition>

<definition name="site.signup" extends="registration">
  <put-attribute name="page" value="Signup" />
  <put-attribute name="body" value="/jsp/common/signup.jsp" />
</definition> 
```

类似的东西对我们有用。已经有一段时间了（我已经逃到了 Ruby 世界），所以我无法诚实地解释这实际上意味着什么。

# c++ - 参数或返回类型隐式转换在 C++ 中是否优先？

> ID：334813
> 
> 赞同：2
> 
> 时间：2008-12-02T17:43:32.543
> 
> 标签：c++, implicit

如果我有代码：

```
int f(int a) { return a; }
double f(double g) { return g; }

int main()
{
    int which = f(1.0f);
} 
```

*调用f*的哪个重载，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-02T17:44:56.673

根本不考虑返回类型用于重载目的，因此您将获得双重版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-03T14:14:21.030

要了解为什么会这样，请考虑以下调用：

```
int bar = f(g(h(foo))); 
```

由于重载决议只涉及参数，您可以独立地推导出 h，然后是 g，最后是 f。如果涉及返回值，则需要同时推导它们。如果每个都有 10 个重载，则在第一种情况下，您将检查 30 个可能的重载，在第二种情况下检查 1000 个可能的组合。如果您认为这种嵌套代码很少见，请考虑

```
std::cout << "int i = " << i << std::endl; 
```

# java - 如何在 Java EE 容器中设置 LDAP 连接池？

> ID：334816
> 
> 赞同：5
> 
> 时间：2008-12-02T17:44:15.910
> 
> 标签：java, spring, jakarta-ee, ldap, jndi

我需要将 LDAP contextSource 放入我的 Java EE 容器的 JNDI 树中，以便容器内的应用程序可以使用它。

我正在使用 Spring-LDAP 对 ORACLE OVD 执行查询。对于开发，我只是在 Spring xml 配置文件中设置了 contextSource。但是，对于生产，我需要能够使用 JNDI 查找来从容器中获取连接/上下文（如此处建议：http: [//forum.springframework.org/showthread.php?t=35122](http://forum.springframework.org/showthread.php?t=35122&highlight=jndi) &highlight=jndi ）。我不允许访问生产 OVD 实例的 URL/用户名/密码，因此这似乎排除了将其放入 jndi.properties 文件的可能性。

理想情况下，我希望有一个连接池（就像 JDBC 一样），因为我的应用程序可能同时执行许多 LDAP 查询。从 JNDI 查找中获取对象并将其注入到我的 SimpleLdapTemplate 中似乎非常简单，但我不知道如何将连接/上下文/池放入 JNDI 树中。我需要构建它并将其打包成 RAR 吗？如果是这样，有哪些选项可以让运营团队以开发人员无法访问的方式指定 URL/用户名/密码？

我正在使用的特定容器是 OAS/OC4J，尽管我也欢迎其他容器上的策略。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T02:44:10.123

具体参考 LDAP 连接的实际池，如果您使用内置的 JNDI LDAP 提供程序，则连接已经使用类似于 JDBC 数据源的语义进行池化，其中为不同的 LDAP URL 和安全属性维护单独的池。

创建 JNDI`DirContext`时，将属性 com.sun.jndi.ldap.connect.pool 配置为**true**并启用池化。

[这里](http://java.sun.com/products/jndi/tutorial/ldap/connect/pool.html)有更多关于 LDAP 池的信息。

有关配置 LDAP 池的详细信息，请参见[此处](http://java.sun.com/products/jndi/tutorial/ldap/connect/config.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T18:10:36.233

您是否有机会设置 LDAP 的开发版本并使用它？然后您可以使用 jndi.properties 文件，该文件将是特定于环境的，但与您的系统无关。

编辑：这里的区别在于，当您构建应用程序时，您的管理员可以将其部署到生产系统，从而保护宝贵的 ldap 密码，因为它只存在于生产箱的属性文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:09:40.487

使用 jboss，您可以将外部 JNDI 上下文联合到 JBoss 服务器 JNDI 命名空间中。您所要做的就是在 MBean 配置文件中描述 LDAP 访问。您还可以启用缓存。

我们正在使用此解决方案来访问 Ative Directory 服务器。

[http://www.jboss.org/community/docs/DOC-9726](http://www.jboss.org/community/docs/DOC-9726)

# python - 如何从图像文件夹在python中生成幻灯片图像？

> ID：334827
> 
> 赞同：3
> 
> 时间：2008-12-02T17:47:49.397
> 
> 标签：python, django, image, python-imaging-library

我想在 python 中为我正在处理的 Django 项目做同样的[事情（ruby 代码）。](http://www.bigdumbdev.com/2007/08/build-better-skimmer-part-2.html)我想在一个文件夹中制作 X 个图像的[幻灯片图像](http://designvigilante.com/files/photoSkim/filmStrip.jpg)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T18:03:27.667

你有这样的想法吗？ [使用 PIL 制作图像的“联系表”](http://code.activestate.com/recipes/412982/)？

也许这里还有其他更接近你想要的东西： http: [//code.activestate.com/recipes/tags/graphics/](http://code.activestate.com/recipes/tags/graphics/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T20:29:31.570

这是一个包装提到**的联系表**函数[S.Lott](https://stackoverflow.com/users/10661/slott)的函数。

```
#!/usr/bin/env python

import os, os.path
from contactsheet import make_contact_sheet

def make_film_strip(fnames,
                   (photow,photoh),
                   (marl,mart,marr,marb),
                   padding):
    return make_contact_sheet(fnames,
                              (1, len(fnames)),
                              (photow,photoh),
                              (marl,mart,marr,marb),
                              padding) 
```

假设[配方](http://code.activestate.com/recipes/412982/)保存为`contactsheet.py`. 用法是：

```
fstrip = filmstrip.make_film_strip(filmstrip.fnames, (120, 120), (0,0,0,0), 0)
fstrip.save('/path/to/file.format') 
```

经测试。

# mysql - MySQL 组合 PK 与可为空的 FK

> ID：334830
> 
> 赞同：2
> 
> 时间：2008-12-02T17:48:27.213
> 
> 标签：mysql, database-design, foreign-keys, data-modeling, nullable

首先，让我先声明一下我真的是一个非常糟糕的数据建模师。我只知道危险。

我正在构建的表有四个外键，其中两个引用同一个表。这是该表的创建语句。

```
CREATE  TABLE IF NOT EXISTS `abnr`.`reputation_event_log` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `reputation_event_id` INT NULL ,
  `giver_user_id` INT NULL ,
  `receiver_user_id` INT NULL ,
  `review_id` INT NULL ,
  `giver_point_value` SMALLINT NULL DEFAULT 0 ,
  `receiver_point_value` SMALLINT NULL DEFAULT 0 ,
  `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ,
  PRIMARY KEY (`id`) ,
  INDEX `fk_reputation_log_user` (`giver_user_id` ASC) ,
  INDEX `fk_reputation_log_user1` (`receiver_user_id` ASC) ,
  INDEX `fk_reputation_log_review` (`review_id` ASC) ,
  INDEX `fk_reputation_log_reputation_event` (`reputation_event_id` ASC) ,
  CONSTRAINT `fk_reputation_log_user`
    FOREIGN KEY (`giver_user_id` )
    REFERENCES `abnr`.`user` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_reputation_log_user1`
    FOREIGN KEY (`receiver_user_id` )
    REFERENCES `abnr`.`user` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_reputation_log_review`
    FOREIGN KEY (`review_id` )
    REFERENCES `abnr`.`review` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_reputation_log_reputation_event`
    FOREIGN KEY (`reputation_event_id` )
    REFERENCES `abnr`.`reputation_event` (`id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_general_ci; 
```

我在这篇文章中关注的索引是`fk_reputation_log_user`和`fk_reputation_log_user1`。每个声誉事件都有一个给予者，但只有一些有接收者。我希望*这个*FK 可以为空，但我不知道该怎么做，或者它是否被“允许”。

我还玩弄了将所有 FK 列作为主键的一部分以对重复日志条目进行数据库级保护的想法——但这不会起作用，因为 PK 列必须为 NOT NULL。

如果您需要更多详细信息，请在评论中说明。谢谢！

（是的，这是针对与 SO 没有太大不同的声誉系统）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T18:33:54.953

```
CREATE  TABLE IF NOT EXISTS `abnr`.`reputation_event_log` (
  `id`                  INT NOT NULL AUTO_INCREMENT ,
  `reputation_event_id` INT NULL ,
  `giver_user_id`       INT NOT NULL , -- mandatory giver_user_id
  `receiver_user_id`    INT NULL ,     -- optional receiver_user_id
  . . . 
```

是的，您可以`NULL`在一个列中声明一个外键约束。列上的`NOT NULL`约束独立于该列上的任何外键约束。

外键意味着*如果*列具有非 NULL 值，则该值必须存在于外键约束引用的表的主键中。

**编辑：**至于您的`UNIQUE`要求，您是否知道您可以在可为`UNIQUE`空的列上声明一个约束。该列*可能*包含`NULL`s（与主键约束不同）。这是标准的 SQL 行为，并且受 MySQL 支持。

```
 . . .
  PRIMARY KEY (`id`),
  CONSTRAINT UNIQUE (`giver_user_id`, `receiver_user_id`, 
                     `review_id`, `reputation_event_id`),
  . . . 
```

# jquery - 使用 jQuery 测试 JSON 中的空数组对象

> ID：334836
> 
> 赞同：22
> 
> 时间：2008-12-02T17:52:35.147
> 
> 标签：jquery, ajax, json

我有一个请求，它返回一个带有单个属性的 JSON 对象，该属性是一个数组。如何测试数组是否为空？

使用 jQuery 代码，例如：

```
 $.getJSON(
            jsonUrl,
            function(data) {
                if (data.RoleOwners == [ ]) {
                    $('<tr><td>' + noRoleOwnersText + '</td></tr>').appendTo("#roleOwnersTable tbody");
                    return;
                }
                $.each(data.RoleOwners, function(i, roleOwner) {
                    var tblRow =
                    "<tr>"
                    + "<td>" + roleOwner.FirstName + "</td>"
                    + "<td>" + roleOwner.LastName + "</td>"
                    + "</tr>"
                    $(tblRow).appendTo("#roleOwnersTable tbody");
                }); 
```

我可以用什么代替 if(data.RoleOwners == [ ]) 来测试 RoleOwners 是否为空数组？

谢谢，马特

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-02T17:59:36.300

```
(data.RoleOwners.length === 0) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-08-02T11:31:47.920

你也可以做`jQuery.isEmptyObject(data.RoleOwners)`

查看[http://api.jquery.com/jQuery.isEmptyObject/](http://api.jquery.com/jQuery.isEmptyObject/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-18T12:17:14.993

下面的代码工作得很好，无需自己编写。

```
 // anyObjectIncludingJSON i tried for JSON object.

         if(jQuery.isEmptyObject(anyObjectIncludingJSON))
            {
                return;
            } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-23T07:03:46.750

检查这个

```
JSON.parse(data).length > 0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T03:54:25.043

数组（也是一个对象）可以具有非数字属性，这些属性不会通过测试零长度来获取。您需要像测试空对象一样遍历属性。如果没有属性，则数组为空。

```
function isEmptyObject(obj) {
   // This works for arrays too.
   for(var name in obj) {
       return false
   }
   return true
} 
```

# internet-explorer - 使用 AutoIT 屏蔽 IE 中的导航声音？

> ID：334842
> 
> 赞同：-1
> 
> 时间：2008-12-02T17:53:58.450
> 
> 标签：internet-explorer, automation, audio

我使用 AutoIT 编写了一个程序，使用 Internet Explorer 从多个网站获取信息。AutoIT 能够隐藏窗口以使其不可见，但是当我在该隐藏窗口上导航到新网站时，我仍然会听到 IE 导航声音（按钮单击声音等）。

如何使用 AutoIT 禁用声音播放？（将计算机静音或更改控制面板中的设置并不理想）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T18:00:31.837

您可以暂时将点击声音更改为空声音，然后在导航后恢复。它存储在此处的注册表中：

HKEY_CURRENT_USER\AppEvents\Schemes\Apps\Explorer\Navigating.current

只需创建一个新的字符串值或将现有（默认）修改为空字符串值即可静音。

但首先读取密钥，以便您可以将其放回之前的任何文件名。

它不是一个完美的解决方案，但它有效。这样做的明显缺点是，如果用户在您读取值然后将其放回之间精确更改声音，您可能会覆盖新值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T18:07:25.317

我认为您也可以使用此变体。只需拥有隐藏的资源管理器窗口并访问 DOM 并创建一个 iframe，如本示例中所述： [http ://www.julienlecomte.net/blog/2007/11/30/](http://www.julienlecomte.net/blog/2007/11/30/)

# asp.net - 向 Web.config 中创建的用户添加角色

> ID：334844
> 
> 赞同：9
> 
> 时间：2008-12-02T17:54:24.720
> 
> 标签：asp.net, roles

我在 asp.net 站点的 web.config 中设置了一些用户来处理身份验证。在不深入细节的情况下，我没有使用完整的会员/角色提供者，并且宁愿现在不必实施它，因为时间限制。但是，我确实需要能够为用户分配角色，以便 securityTrimming 在站点地图关联菜单上工作。

现在我只在 web.config 中设置了几个用户（我在真实配置中使用 SHA1）

```
<authentication mode="Forms">
    <forms name="Auth" loginUrl="~/login.aspx" defaultUrl="~/admin/default.aspx" requireSSL="true">
        <credentials passwordFormat="Clear">
            <user name="admin" password="test"/>                
        </credentials>
    </forms>
</authentication> 
```

是否也可以在不设置实际角色提供者的情况下为凭据部分或其他地方的用户之一分配角色？类似于我在上面设置用户的方式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-02T18:41:40.583

这无法通过 web.config 完成，您需要设置会员提供程序，但使用 .exe 创建数据库表，整个过程实际上需要不到 5 分钟才能完成！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-18T02:04:33.073

我现在有几次同样的“问题”，所以我终于实现了一个使用 web.config 的简单 iRoleProvider 实现。[在 Codeplex、 Web.Config Role Provider](http://webconfigroles.codeplex.com/)上查看。

# java - 有什么好的 Java Swing 时间线小部件吗？

> ID：334845
> 
> 赞同：15
> 
> 时间：2008-12-02T17:54:55.187
> 
> 标签：java, swing, widget, timeline

是否有人知道具有与 Janus Winforms 时间线组件相当的功能的良好 Java Swing 时间线小部件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-10T15:01:47.760

最后我找到了一个满足我要求的 Java 时间线小部件：

[Jaret 时间栏组件](http://jaret.de/timebars/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T12:47:15.273

[一个相当不错的组件是http://www.dlsc.com](http://www.dlsc.com)上提供的 FlexGantt

我会试一下

# apache-flex - Flex/Actionscript 中的连接线（拖动时）

> ID：334846
> 
> 赞同：2
> 
> 时间：2008-12-02T17:55:12.473
> 
> 标签：apache-flex, actionscript-3, air, flex3

我有一个 mx:Canvas 元素，其中包含多个 mx:Panel 元素。我希望能够绘制一条连接两个这样的 mx:Panel 的线，这样当一个或两个 mx:Panel 被拖动时，该线继续连接两个 mx:Panel。这似乎是一件微不足道的事情，但我一直无法弄清楚。

实际上，这就是问题所在。

[替代文字 http://img150.imageshack.us/img150/5656/ishot1eu3.jpg](http://img150.imageshack.us/img150/5656/ishot1eu3.jpg)

由于更新仅在面板到达其最终位置时发生，所以一旦您开始拖动“B”面板，就会留下一条悬空线：

[替代文字 http://img212.imageshack.us/img212/4296/ishot2qi6.jpg](http://img212.imageshack.us/img212/4296/ishot2qi6.jpg)

如下所示，一个可能的解决方案是覆盖 mx:Canvas 组件的 updateDisplayList() 方法。不幸的是，这只会在拖动后更新绘图，而不是在运动时更新。在 Panel 中侦听“xChanged”和“yChanged”事件会产生与覆盖 updateDisplayList() 相同的结果。

如下所述，最终解决方案需要将移动事件从移动的 Panel 分派到它正在移动的 Canvas 上。这会迫使线条在整个运动中重新绘制。

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-03T00:25:26.740

> *“我尝试过覆盖 mx:Canvas 组件的 updateDisplayList() 方法，但这似乎只会在拖动后更新绘图。我希望​​线条在拖动时跟随 mx:Panel。”*

您可以在面板中监听[`MoveEvent.MOVE`](http://livedocs.adobe.com/flex/3/langref/mx/events/MoveEvent.html#MOVE)事件并让处理程序调用重新绘制线条，然后让面板在它们被拖动时通过监听`MouseEvent.MOUSE_MOVE`舞台中的`MOVE`事件并在处理程序中调度事件来调度这些事件（附上这个处理程序到面板的`MouseEvent.MOUSE_DOWN`事件处理程序中的阶段，以及处理程序`MouseEvent.MOUSE_UP`（也附加到阶段）- 然后从处理程序中的阶段删除这两个事件侦听器`MOUSE_UP`。）

这是一个示例（这将在 Panel 子类中：）

```
private function attachListeners():void
{
    this.addEventListener(MouseEvent.MOUSE_DOWN, selfMouseDownHandler, false,0,true);
    this.addEventListener(MoveEvent.MOVE, selfMoveHandler, false,0,true);
}

private function selfMoveHandler(event:MoveEvent):void
{
    redrawConnectedLinks();
}

private function selfMouseDownHandler(event:MouseEvent):void
{
    stage.addEventListener(MouseEvent.MOUSE_UP, stageMouseUpHandler, false,0,true);
    stage.addEventListener(MouseEvent.MOUSE_MOVE, stageMouseMoveHandler, false,0,true);
}

private function stageMouseUpHandler(event:MouseEvent):void
{
    stage.removeEventListener(MouseEvent.MOUSE_UP, stageMouseUpHandler, false);
    stage.removeEventListener(MouseEvent.MOUSE_MOVE, stageMouseMoveHandler, false);
}

private function stageMouseMoveHandler(event:MouseEvent):void
{
    dispatchEvent(new MoveEvent(MoveEvent.MOVE));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T23:06:51.197

[flexwires](http://code.google.com/p/flexwires/)是一个开源项目，用于在 Flex 中实现这种类型的“连接线”UI 范例。它可能正好适合您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T18:06:46.927

您想覆盖 Canvas 上的 UIComponent 方法 updateDisplayList() 并在其中进行绘图。

这是假设您通常熟悉 AS3 中的线图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T15:38:20.953

你不能在这里使用绑定功能吗？绑定到圆心的线的终点？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-19T13:44:39.970

flash/flex 的新手，遇到了类似的问题。我通过将事件侦听器附加到 Enter_Frame 事件来解决它。我不确定这是否是最有效的解决方案，因为即使对象没有移动它也会重绘，但它对我有用：

```
 import flash.display.DisplayObject;
import flash.display.Sprite;
import flash.events.Event;

public class Association extends Sprite
{
    private var t1:DisplayObject;
    private var t2:DisplayObject;
    //Connects two objects
    public function Association(t1:DisplayObject, t2:DisplayObject)
    {
        this.t1=t1;
        this.t2=t2;
        this.addEventListener(Event.ENTER_FRAME, redraw)
        super();
    }

    public function redraw(event:Event):void
    {
        graphics.clear();
        graphics.lineStyle(2,0x000000);
        graphics.moveTo(t1.x,t1.y);
        graphics.lineTo(t2.x,t2.y);
    }

} 
```

# c# - C#如何用直引号替换微软的Smart Quotes？

> ID：334850
> 
> 赞同：29
> 
> 时间：2008-12-02T17:57:09.147
> 
> 标签：c#, smart-quotes

我在下面的帖子询问了弯引号是什么以及为什么我的应用程序无法使用它们，我现在的问题是当我的程序遇到它们时如何替换它们，我如何在 C# 中做到这一点？它们是特殊字符吗？

[卷曲引号与方形引号 - 给出了什么](https://stackoverflow.com/questions/334119/curly-quotation-marks-vs-square-quotation-marks-what-gives)

谢谢

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2010-02-05T08:18:36.153

有问题的单词字符的更广泛列表

```
if (buffer.IndexOf('\u2013') > -1) buffer = buffer.Replace('\u2013', '-');
if (buffer.IndexOf('\u2014') > -1) buffer = buffer.Replace('\u2014', '-');
if (buffer.IndexOf('\u2015') > -1) buffer = buffer.Replace('\u2015', '-');
if (buffer.IndexOf('\u2017') > -1) buffer = buffer.Replace('\u2017', '_');
if (buffer.IndexOf('\u2018') > -1) buffer = buffer.Replace('\u2018', '\'');
if (buffer.IndexOf('\u2019') > -1) buffer = buffer.Replace('\u2019', '\'');
if (buffer.IndexOf('\u201a') > -1) buffer = buffer.Replace('\u201a', ',');
if (buffer.IndexOf('\u201b') > -1) buffer = buffer.Replace('\u201b', '\'');
if (buffer.IndexOf('\u201c') > -1) buffer = buffer.Replace('\u201c', '\"');
if (buffer.IndexOf('\u201d') > -1) buffer = buffer.Replace('\u201d', '\"');
if (buffer.IndexOf('\u201e') > -1) buffer = buffer.Replace('\u201e', '\"');
if (buffer.IndexOf('\u2026') > -1) buffer = buffer.Replace("\u2026", "...");
if (buffer.IndexOf('\u2032') > -1) buffer = buffer.Replace('\u2032', '\'');
if (buffer.IndexOf('\u2033') > -1) buffer = buffer.Replace('\u2033', '\"'); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-02T19:13:14.640

当我遇到这个问题时，我在 C# 中为 String 类编写了一个扩展方法。

```
public static class StringExtensions
{
    public static string StripIncompatableQuotes(this string s)
    {
        if (!string.IsNullOrEmpty(s))
            return s.Replace('\u2018', '\'').Replace('\u2019', '\'').Replace('\u201c', '\"').Replace('\u201d', '\"');
        else
            return s;
    }
} 
```

这只是用普通引号替换了愚蠢的“智能引号”。

**[编辑] 修复了也支持替换“双智能引号”。**

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-05-15T14:55:47.567

为了扩展 Nick van Esch 的流行答案，这里是注释中包含字符名称的代码。

```
if (buffer.IndexOf('\u2013') > -1) buffer = buffer.Replace('\u2013', '-'); // en dash
if (buffer.IndexOf('\u2014') > -1) buffer = buffer.Replace('\u2014', '-'); // em dash
if (buffer.IndexOf('\u2015') > -1) buffer = buffer.Replace('\u2015', '-'); // horizontal bar
if (buffer.IndexOf('\u2017') > -1) buffer = buffer.Replace('\u2017', '_'); // double low line
if (buffer.IndexOf('\u2018') > -1) buffer = buffer.Replace('\u2018', '\''); // left single quotation mark
if (buffer.IndexOf('\u2019') > -1) buffer = buffer.Replace('\u2019', '\''); // right single quotation mark
if (buffer.IndexOf('\u201a') > -1) buffer = buffer.Replace('\u201a', ','); // single low-9 quotation mark
if (buffer.IndexOf('\u201b') > -1) buffer = buffer.Replace('\u201b', '\''); // single high-reversed-9 quotation mark
if (buffer.IndexOf('\u201c') > -1) buffer = buffer.Replace('\u201c', '\"'); // left double quotation mark
if (buffer.IndexOf('\u201d') > -1) buffer = buffer.Replace('\u201d', '\"'); // right double quotation mark
if (buffer.IndexOf('\u201e') > -1) buffer = buffer.Replace('\u201e', '\"'); // double low-9 quotation mark
if (buffer.IndexOf('\u2026') > -1) buffer = buffer.Replace("\u2026", "..."); // horizontal ellipsis
if (buffer.IndexOf('\u2032') > -1) buffer = buffer.Replace('\u2032', '\''); // prime
if (buffer.IndexOf('\u2033') > -1) buffer = buffer.Replace('\u2033', '\"'); // double prime 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-02T18:40:29.213

请注意，您所拥有的本质上是一个损坏的 CSV 文件。不加选择地用直引号替换所有印刷者的引号不一定会修复您的文件。如您所知，作为字段值的一部分，一些排版员的引用应该在那里。用直引号替换它们可能也不会给您留下有效的 CSV 文件。

我认为没有一种算法方法可以修复按照您描述的方式损坏的文件。您最好先花时间调查一下您是如何获得此类无效文件的，然后再制止它。例如，有人使用 Word 来编辑您的数据文件吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-02T23:51:42.673

我有一个很棒的大...程序...正是这样做的。您可以撕下脚本并随意使用它。它进行各种替换，位于[http://bitbucket.org/nesteruk/typografix](http://bitbucket.org/nesteruk/typografix)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-02T18:09:17.967

根据 Windows 附带的 Character Map 应用程序，大括号的 Unicode 值是 0x201c 和 0x201d。用直引号 0x0022 替换这些值，你应该很高兴。

```
String.Replace(0x201c, '"');
String.Replace(0x201d, '"'); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-04-19T16:22:27.373

VB 相当于@Matthew 所写的内容：

```
Public Module StringExtensions

    <Extension()>
    Public Function StripIncompatableQuotes(BadString As String) As String
        If Not String.IsNullOrEmpty(BadString) Then
            Return BadString.Replace(ChrW(&H2018), "'").Replace(ChrW(&H2019), "'").Replace(ChrW(&H201C), """").Replace(ChrW(&H201D), """")
        Else
            Return BadString
        End If
    End Function
End Module 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-05T04:36:46.700

如果上述方法不起作用，请尝试使用智能单引号：

```
string.Replace("\342\200\230", "'")
string.Replace("\342\200\231", "'") 
```

也可以试试这个智能双引号：

```
string.Replace("\342\200\234", '"')
string.Replace("\342\200\235", '"') 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-04-15T08:36:51.093

我也有一个程序可以做到这一点，源代码在[这个](https://github.com/pospi/cp1252fixer/blob/master/frmMain.cs)[CP-1252 Fixer](https://github.com/pospi/cp1252fixer)文件中。它还定义了一些映射，用于在 RTF 字符串中转换字符，同时保留所有格式，这可能对某些人有用。

它也是*所有*“智能引用”字符到它们的低 ascii 对应物、实体代码和字符引用的完整映射。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-11-14T23:07:04.517

只是插话，我用 Regex replace 完成了这个，只是为了根据我替换它们的内容一次处理几个：

```
 public static string ReplaceWordChars(this string text)
        {
            var s = text;
            // smart single quotes and apostrophe,  single low-9 quotation mark, single high-reversed-9 quotation mark, prime
            s = Regex.Replace(s, "[\u2018\u2019\u201A\u201B\u2032]", "'");
            // smart double quotes, double prime
            s = Regex.Replace(s, "[\u201C\u201D\u201E\u2033]", "\"");
            // ellipsis
            s = Regex.Replace(s, "\u2026", "...");
            // em dashes
            s = Regex.Replace(s, "[\u2013\u2014]", "-");
            // horizontal bar
            s = Regex.Replace(s, "\u2015", "-");
            // double low line
            s = Regex.Replace(s, "\u2017", "-");
            // circumflex
            s = Regex.Replace(s, "\u02C6", "^");
            // open angle bracket
            s = Regex.Replace(s, "\u2039", "<");
            // close angle bracket
            s = Regex.Replace(s, "\u203A", ">");
            // weird tilde and nonblocking space
            s = Regex.Replace(s, "[\u02DC\u00A0]", " ");
            // half
            s = Regex.Replace(s, "[\u00BD]", "1/2");
            // quarter
            s = Regex.Replace(s, "[\u00BC]", "1/4");
            // dot
            s = Regex.Replace(s, "[\u2022]", "*");
            // degrees 
            s = Regex.Replace(s, "[\u00B0]", " degrees");

            return s;
        } 
```

那里还有一些替代品。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-07-06T16:10:08.413

使用尼克和芭芭拉的答案，这里是我的机器上 1,000,000 次循环的性能统计的示例代码：

```
input = "shmB6BhLe0gdGU8OxYykZ21vuxLjBo5I1ZTJjxWfyRTTlqQlgz0yUtPu8iNCCcsx78EPsObiPkCpRT8nqRtvM3Bku1f9nStmigaw";
input.Replace('\u2013', '-'); // en dash
input.Replace('\u2014', '-'); // em dash
input.Replace('\u2015', '-'); // horizontal bar
input.Replace('\u2017', '_'); // double low line
input.Replace('\u2018', '\''); // left single quotation mark
input.Replace('\u2019', '\''); // right single quotation mark
input.Replace('\u201a', ','); // single low-9 quotation mark
input.Replace('\u201b', '\''); // single high-reversed-9 quotation mark
input.Replace('\u201c', '\"'); // left double quotation mark
input.Replace('\u201d', '\"'); // right double quotation mark
input.Replace('\u201e', '\"'); // double low-9 quotation mark
input.Replace("\u2026", "..."); // horizontal ellipsis
input.Replace('\u2032', '\''); // prime
input.Replace('\u2033', '\"'); // double prime 
```

时间：958.1011 毫秒

```
input = "shmB6BhLe0gdGU8OxYykZ21vuxLjBo5I1ZTJjxWfyRTTlqQlgz0yUtPu8iNCCcsx78EPsObiPkCpRT8nqRtvM3Bku1f9nStmigaw";
var inputArray = input.ToCharArray();
for (int i = 0; i < inputArray.Length; i++)
{
    switch (inputArray[i])
    {
        case '\u2013':
            inputArray[i] = '-';
            break;
        // en dash
        case '\u2014':
            inputArray[i] = '-';
            break;
        // em dash
        case '\u2015':
            inputArray[i] = '-';
            break;
        // horizontal bar
        case '\u2017':
            inputArray[i] = '_';
            break;
        // double low line
        case '\u2018':
            inputArray[i] = '\'';
            break;
        // left single quotation mark
        case '\u2019':
            inputArray[i] = '\'';
            break;
        // right single quotation mark
        case '\u201a':
            inputArray[i] = ',';
            break;
        // single low-9 quotation mark
        case '\u201b':
            inputArray[i] = '\'';
            break;
        // single high-reversed-9 quotation mark
        case '\u201c':
            inputArray[i] = '\"';
            break;
        // left double quotation mark
        case '\u201d':
            inputArray[i] = '\"';
            break;
        // right double quotation mark
        case '\u201e':
            inputArray[i] = '\"';
            break;
        // double low-9 quotation mark
        case '\u2026':
            inputArray[i] = '.';
            break;
        // horizontal ellipsis
        case '\u2032':
            inputArray[i] = '\'';
            break;
        // prime
        case '\u2033':
            inputArray[i] = '\"';
            break;
        // double prime
    }
}
input = new string(inputArray); 
```

时间：362.0858 毫秒

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-20T07:04:39.333

它对我有用，你可以试试下面的代码

```
string replacedstring = ("your string with smart quotes").Replace('\u201d', '\''); 
```

谢谢！

# python - 打印定义 lambda 函数的代码

> ID：334851
> 
> 赞同：61
> 
> 时间：2008-12-02T17:57:22.937
> 
> 标签：python

我希望能够打印 lambda 函数的定义代码。

例如，如果我通过 lambda 语法定义此函数：

```
>>>myfunction = lambda x: x==2
>>>print_code(myfunction) 
```

我想得到这个输出：

```
x==2 
```

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-12-02T19:36:48.990

*只要您将代码保存到源文件*，您就可以使用检查模块检索对象的源代码。

示例：打开编辑器类型：

```
myfunction = lambda x: x==2 
```

另存为lamtest.py

打开 shell 类型 python 以进入交互式 python 类型以下：

```
>>>from lamtest import myfunc
>>>import inspect
>>>inspect.getsource(myfunc) 
```

结果：

```
'myfunc = lambda x: x==2\n' 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-06-21T00:05:01.030

它仅适用于基于数学的运算，但您可能会查看[SymPy](http://code.google.com/p/sympy/)的`Lambda()`对象。它正是为此目的而设计的：

```
>>> from sympy import *
>>> x = Symbol('x')
>>> l = Lambda(x, x**2)
>>> l
Lambda(_x, _x**2)
>>> l(3)
9 
```

它甚至支持漂亮的打印：

```
>>> pprint(l)
 ⎛    2⎞
Λ⎝x, x ⎠ 
```

为了做你的 equals 例子，我们使用 SymPy Eq() 对象：

```
>>> l1 = Lambda(x, Eq(x, 2))
>>> l1
Lambda(_x, _x == 2)
>>> l1(2)
True 
```

它支持部分参数扩展：

```
>>> y = Symbol('y')
>>> l2 = Lambda((x, y), x*y + x)
>>> l2(1)
Lambda(_y, 1 + _y)
>>> l2(1, 2)
3 
```

当然，您还可以获得 SymPy 的所有计算机代数的优势：

```
>>> l3 = Lambda(x, sin(x*pi/3))
>>> pprint(l3(1))
  ⎽⎽⎽
╲╱ 3 
─────
  2 
```

顺便说一句，如果这听起来像一个无耻的插件，那是因为它是。我是 SymPy 的开发者之一。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-01-24T17:54:43.367

虽然我通常同意这`inspect`是一个很好的答案，但我不同意您无法获得解释器中定义的对象的源代码。如果您使用`dill.source.getsource`from [`dill`](https://github.com/uqfoundation/dill)，您可以获得函数和 lambda 的来源，即使它们是交互式定义的。它还可以从 curries 中定义的绑定或未绑定的类方法和函数中获取代码……但是，如果没有封闭对象的代码，您可能无法编译该代码。

```
>>> from dill.source import getsource
>>> 
>>> def add(x,y):
...   return x+y
... 
>>> squared = lambda x:x**2
>>> 
>>> print getsource(add)
def add(x,y):
  return x+y

>>> print getsource(squared)
squared = lambda x:x**2

>>> 
>>> class Foo(object):
...   def bar(self, x):
...     return x*x+x
... 
>>> f = Foo()
>>> 
>>> print getsource(f.bar)
def bar(self, x):
    return x*x+x

>>> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-02T19:10:28.327

这将非常困难，因为您的 lambda 函数将被编译为字节码，而您的 myfunction 对象将只指向字节码，而不是您编写的人类可读代码。

例如，如果您定义 2 个函数，一个使用 lambda 语法，一个使用 def 语句，如下所示：

```
>>> lambda_func = lambda x: x==2
>>> def def_func(x): return x == 2
... 
```

就 python 而言，这两个对象（lambda_func 和 def_func）是等价的。事实上，如果你继续使用[dis 模块](https://docs.python.org/library/dis.html)（如 rebra 建议的那样）反汇编它们，你将得到相同的结果：

```
>>> import dis
>>> dis.dis(lambda_func)
  1           0 LOAD_FAST                0 (x)
              3 LOAD_CONST               1 (2)
              6 COMPARE_OP               2 (==)
              9 RETURN_VALUE
>>> dis.dis(def_func)
  1           0 LOAD_FAST                0 (x)
              3 LOAD_CONST               1 (2)
              6 COMPARE_OP               2 (==)
              9 RETURN_VALUE 
```

既然如此，您可以看到当它是多对一关系时，获取原始代码是多么困难

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-02T19:12:56.730

这个怎么样？

```
class MyLambda( object ):
    def __init__( self, body ):
        self.body= body
    def __call__( self, arg ):
        x = arg
        return eval( self.body )
    def __str__( self ):
        return self.body

f= MyLambda( "x == 2" )
print f(1)
print f(2)
print f 
```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2008-12-02T18:31:32.837

你为什么要这样做？

我猜你可以使用“dis”模块将你的代码反汇编为 python 字节码，但这可能不是你想要的。

[http://www.python.org/doc/2.5.2/lib/module-dis.html](http://www.python.org/doc/2.5.2/lib/module-dis.html)

同样，我看不到这个用例。也许 eval() 更适合您的问题。它是内置的，然后您可以使用字符串在代码中传递代码。

# sql - SQL JOIN 查询编写

> ID：334852
> 
> 赞同：4
> 
> 时间：2008-12-02T17:57:24.480
> 
> 标签：sql, join

我正在尝试编写一个涉及两个表的简单查询。"person" 表有一个唯一的`person_id`和 a `name`，而 "friends" 表有 a`person_id`和 a ，它们是person 表中`friend_id`a 的 FK 。`person_id`

```
person:
<PK> int person_id 
varchar[45] name

friends: 
<PK> int person_id
<PK> int friend_id 
```

我想选择人 1 的所有朋友的名字。

我可以使用以下`IN`语句轻松做到这一点：

```
SELECT p.name FROM person p WHERE p.person_id IN (SELECT f.friend_id FROM friends f WHERE f.person_id = 1); 
```

但是，我不擅长写`JOIN`陈述。有人可以帮我写等效的加入吗？

显然这是一个人为的例子，但我已经尝试使用我的真实数据并且在概念上遗漏了一些东西。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-02T18:01:48.043

你想要这样的东西：

```
SELECT p.name, f.friend_id
FROM person AS p
INNER JOIN friends AS f ON p.person_id = f.person_id
WHERE p.person_id = 1 
```

这将两个表连接在一起使用`p.person_id = f.person_id`

如果一个人没有朋友，你将不会得到任何行回来 - 如果你不想要这个然后使用 LEFT JOIN 你会得到一个 NULL 行`friend_id`。

编辑：如果您想将朋友重新加入个人：

```
SELECT p.name AS person_name, friend.name AS friend_name
FROM person AS p                                         -- Our person
INNER JOIN friends AS f ON p.person_id = f.person_id     -- the join table
INNER JOIN person AS friend on f.friend_id = friend.id   -- Join back on person again
WHERE p.person_id = 1 
```

也许您的应用程序需要像这样的 3-way join，但通常您只需要上述的 2-way 连接，或者像这样：

```
SELECT p.name, f.friend_id
FROM person AS p
INNER JOIN friends AS f ON p.person_id = f.friend_id
WHERE f.person_id = 1 
```

这将为您提供与 person_id 1 成为朋友的所有人的姓名（但不是 person_id 1 的姓名）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-02T18:06:27.363

```
select 
    p.name,
    p2.name as friend_name,
from
    person p 
    inner join friends f on p.person_id = f.person_id
    inner join person p2 on f.friend_id = p2.person_id -- friends
where
    p.person_id = <your criteria> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T18:02:07.327

```
SELECT p.name FROM person p 
INNER JOIN friends f ON f.friend_id = p.person_id
WHERE f.person_id = 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T18:07:05.303

```
选择 p.name
来自人 p，朋友 f
其中 f.friend_id = p.person_id
和 f.person_id = 1
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T18:13:22.560

我很确定托尼·安德鲁斯是对的，除了我认为正确的语法将源表放在左边，连接表放在右边......

```
SELECT p.name FROM person p 
INNER JOIN friends f ON p.person_id = f.friend_id
WHERE f.person_id = 1 
```

这将返回在字段中找到值且字段等于 1`[person.name]`的所有记录的字段......当 [1] 的每个朋友被连接在一起并限制为`[person.person_id]``[friends.friend_id]``[friends.person_id]``friends.person_id=[1]`

# tdd - IoC 和接口最佳实践

> ID：334854
> 
> 赞同：0
> 
> 时间：2008-12-02T17:57:57.380
> 
> 标签：tdd, inversion-of-control, interface

我正在通过摆弄现有项目来尝试使用 IoC 来实现 TDD。简而言之，我的问题是：当对公共和非公共方法感兴趣时，围绕 IoC 的最佳实践是什么？

有两个类：

```
public abstract class ThisThingBase
{
    public virtual void Method1() {}
    public virtual void Method2() {}

    public ThatThing GetThat()
    {
        return new ThatThing(this);
    }
    internal virtual void Method3() {}
    internal virtual void Method4() {}
}

public class Thathing
{
    public ThatThing(ThisThingBase thing)
    {
        m_thing = thing;
    }
    ...
} 
```

ThatThing 使用它的 ThisThingBase 引用来调用经常被 ThisThingBase 的后代重载的方法。

Method1 和 Method2 是公开的。Method3 和 Method4 是内部的，仅由 ThatThings 使用。

我想在没有 ThisThing 的情况下测试 ThatThing，反之亦然。

学习 IoC 我的第一个想法是我应该定义一个 IThing 接口，通过 ThisThingBase 实现它并将它传递给 ThatThing 构造函数。IThing 将是客户端可以调用的公共接口，但它不包括 ThatThing 也需要的 Method3 或 Method4。

我是否应该为这两种方法定义第二个接口 - IThingInternal 并将两个接口都传递给 ThatThing？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-02T18:22:34.337

IoC 容器的问题在于它们无法控制对象的生命周期。为什么使用 ThisThingBase 上的工厂方法？如果有可能让 IoC 容器构造 Thatthing 它将增加可测试性。

根据示例很难说，但您可能在 Thatthing 和 ThisThingBase 之间存在不必要的耦合。

接口可能很好，但有时使用您所依赖的类上的虚拟方法来启用测试就足够了。

# c++ - 在 C++ 中通过指针传递比通过引用传递有好处吗？

> ID：334856
> 
> 赞同：259
> 
> 时间：2008-12-02T17:58:00.640
> 
> 标签：c++, pointers, parameter-passing, pass-by-reference

在 C++ 中通过指针传递比通过引用传递有什么好处？

最近，我看到了许多选择通过指针传递函数参数而不是通过引用传递的示例。这样做有好处吗？

例子：

```
func(SPRITE *x); 
```

打电话给

```
func(&mySprite); 
```

对比

```
func(SPRITE &x); 
```

打电话给

```
func(mySprite); 
```

* * *

## 回答 #1

> 赞同：260
> 
> 时间：2008-12-02T18:00:26.220

### 通过指针

*   来电者必须取地址 -> 不透明
*   可以提供 0 值来表示`nothing`. 这可用于提供可选参数。

### 通过引用传递

*   调用者只是传递对象-> 透明。必须用于运算符重载，因为指针类型的重载是不可能的（指针是内置类型）。所以你不能 `string s = &str1 + &str2;`使用指针。
*   不可能有 0 值 -> 调用函数不必检查它们
*   对 const 的引用也接受 temporaries: `void f(const T& t); ... f(T(a, b, c));`，不能像那样使用指针，因为您不能获取临时地址。
*   最后但同样重要的是，引用更容易使用 -> 出现错误的机会更少。

* * *

## 回答 #2

> 赞同：241
> 
> 时间：2008-12-02T18:02:27.263

指针可以接收 NULL 参数，引用参数不能。如果您有可能想要传递“无对象”，请使用指针而不是引用。

此外，通过指针传递允许您在调用站点显式查看对象是通过值传递还是通过引用传递：

```
// Is mySprite passed by value or by reference?  You can't tell 
// without looking at the definition of func()
func(mySprite);

// func2 passes "by pointer" - no need to look up function definition
func2(&mySprite); 
```

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2015-10-06T00:24:59.963

我喜欢来自“cplusplus.com”的一篇文章的推理：

> 1.  当函数不想修改参数且值易于复制时按值传递（ints、doubles、char、bool 等...简单类型。std::string、std::vector 和所有其他 STL容器不是简单的类型。）
>     
>     
> 2.  当值复制成本高且函数不想修改指向的值且 NULL 是函数处理的有效预期值时，通过 const 指针传递。
>     
>     
> 3.  当值复制成本很高并且函数想要修改指向的值并且 NULL 是函数处理的有效预期值时，通过非常量指针传递。
>     
>     
> 4.  当值复制成本高且函数不想修改引用的值时，通过 const 引用传递，如果使用指针代替，NULL 将不是有效值。
>     
>     
> 5.  当值复制成本高且函数想要修改引用的值时，通过非连续引用传递，如果使用指针代替，NULL 将不是有效值。
>     
>     
> 6.  在编写模板函数时，没有一个明确的答案，因为有一些权衡需要考虑，这超出了本讨论的范围，但可以说大多数模板函数通过值或 (const) 引用来获取参数, 但是因为迭代器语法类似于指针的语法（星号表示“取消引用”），任何期望迭代器作为参数的模板函数也将默认接受指针（并且不检查 NULL，因为 NULL 迭代器概念具有不同的语法）。
>     
>     
> 
> [http://www.cplusplus.com/articles/z6vU7k9E/](http://www.cplusplus.com/articles/z6vU7k9E/)

我从中得到的是，选择使用指针或引用参数之间的主要区别在于 NULL 是否是可接受的值。就是这样。

毕竟，值是输入、输出、可修改等都应该在有关函数的文档/注释中。

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2008-12-02T18:26:03.080

Allen Holub 的“足够的绳子射中自己的脚”列出了以下 2 条规则：

```
120\. Reference arguments should always be `const`
121\. Never use references as outputs, use pointers 
```

他列出了向 C++ 添加引用的几个原因：

*   它们是定义复制构造函数所必需的
*   它们对于运算符重载是必需的
*   `const`引用允许您在避免复制的同时具有按值传递的语义

他的主要观点是不应将引用用作“输出”参数，因为在调用站点没有指示参数是引用参数还是值参数。所以他的规则是只使用`const`引用作为参数。

就个人而言，我认为这是一个很好的经验法则，因为它可以更清楚地说明参数是否为输出参数。然而，虽然我个人总体上同意这一点，但我确实允许自己被团队中其他人的意见所左右，如果他们主张将输出参数作为参考（一些开发人员非常喜欢它们）。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-03T00:22:36.217

对前面帖子的澄清：

* * *

引用**不能**保证获得非空指针。（尽管我们经常这样对待它们。）

虽然糟糕的代码很糟糕，比如把你带到木棚*糟糕*的代码后面，但下面的代码将编译并运行：（至少在我的编译器下。）

```
bool test( int & a)
{
  return (&a) == (int *) NULL;
}

int
main()
{
  int * i = (int *)NULL;
  cout << ( test(*i) ) << endl;
}; 
```

* * *

我对引用的真正问题在于其他程序员，以下称为***IDIOTS***，他们在构造函数中分配，在析构函数中释放，***并且无法提供复制构造函数或 operator=()。***

*突然之间foo(BAR bar)*和*foo(BAR **&** bar)*之间有了天壤之别。（自动按位复制操作被调用。析构函数中的释放被调用两次。）

值得庆幸的是，现代编译器将采用相同指针的这种双重释放。15年前，他们没有。（在 gcc/g++ 下，使用*setenv MALLOC_CHECK_ 0*重新访问旧方法。）结果，在 DEC UNIX 下，相同的内存被分配给两个不同的对象。那里有很多调试乐趣......

* * *

更实际：

*   引用隐藏了您正在更改存储在其他地方的数据。
*   很容易将引用与复制对象混淆。
*   指针让它很明显！

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-05-13T20:37:17.203

就表达意图而言，这里的大多数答案都未能解决在函数签名中具有原始指针的固有歧义。问题如下：

*   调用者不知道指针是指向单个对象，还是指向对象“数组”的开头。

*   调用者不知道指针是否“拥有”它指向的内存。IE，该功能是否应该释放内存。（`foo(new int)`- 这是内存泄漏吗？）。

*   调用者不知道是否`nullptr`可以安全地传递给函数。

所有这些问题都通过引用解决：

*   引用总是指向单个对象。

*   引用从不拥有它们所引用的内存，它们只是对内存的一种看法。

*   引用不能为空。

这使得参考文献成为更好的一般用途候选者。然而，参考并不完美——有几个主要问题需要考虑。

*   没有显式间接。这不是原始指针的问题，因为我们必须使用`&`运算符来表明我们确实在传递一个指针。例如，`int a = 5; foo(a);`这里根本不清楚 a 是通过引用传递的并且可以修改。
*   可空性。*当我们实际上希望*我们的引用可以为空时，指针的这种弱点也可以成为一种优势。认为 as`std::optional<T&>`无效（有充分的理由），指针为我们提供了您想要的可空性。

因此，似乎当我们想要一个具有显式间接性的可为空引用时，我们应该争取`T*`权利吗？错误的！

## 抽象

在我们对可空性绝望的情况下，我们可能会伸手去拿`T*`，然后简单地忽略前面列出的所有缺点和语义歧义。相反，我们应该追求 C++ 最擅长的：抽象。如果我们简单地编写一个包装指针的类，我们将获得表现力，以及可空性和显式间接性。

```
template <typename T>
struct optional_ref {
  optional_ref() : ptr(nullptr) {}
  optional_ref(T* t) : ptr(t) {}
  optional_ref(std::nullptr_t) : ptr(nullptr) {}

  T& get() const {
    return *ptr;
  }

  explicit operator bool() const {
    return bool(ptr);
  }

private:
  T* ptr;
}; 
```

这是我能想到的最简单的界面，但它可以有效地完成工作。它允许初始化引用、检查值是否存在以及访问该值。我们可以这样使用它：

```
void foo(optional_ref<int> x) {
  if (x) {
    auto y = x.get();
    // use y here
  }
}

int x = 5;
foo(&x); // explicit indirection here
foo(nullptr); // nullability 
```

我们已经实现了我们的目标！现在让我们看看与原始指针相比的好处。

*   该接口清楚地表明该引用应该只引用一个对象。
*   显然它不拥有它所指的内存，因为它没有用户定义的析构函数，也没有删除内存的方法。
*   调用者知道`nullptr`可以传入，因为函数作者明确要求`optional_ref`

我们可以从这里使接口变得更复杂，例如添加相等运算符、单子`get_or`和`map`接口、获取值或抛出异常的方法、`constexpr`支持。这可以由你来完成。

总之，不要使用原始指针，而是推理这些指针在您的代码中的实际含义，并利用标准库抽象或编写您自己的抽象。这将显着改进您的代码。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-02T18:03:10.257

并不真地。在内部，通过引用传递实际上是通过传递被引用对象的地址来执行的。因此，通过指针传递确实没有任何效率提升。

但是，通过引用传递确实有一个好处。保证您有一个正在传入的任何对象/类型的实例。如果您传入一个指针，那么您将面临收到 NULL 指针的风险。通过使用传递引用，您将隐式 NULL 检查向上推到函数的调用者。

# c# - 在 C# 中，在 2 个线程之间传递数据的推荐方式是什么？

> ID：334860
> 
> 赞同：26
> 
> 时间：2008-12-02T17:58:44.370
> 
> 标签：c#, multithreading

我有我的主 GUI 线程，以及在它自己的 ApplicationContext 中运行的第二个线程（即使没有工作要做，也要让它保持活力）。我想从我的 GUI 线程调用我的第二个线程上的一个方法，但是如果我只是调用 thread.Method(); 它似乎在我的主 GUI 线程上运行并导致我的 GUI 变得无响应。在不同线程上调用方法的最佳方式是什么？

**更新：** 我真正想做的是在 2 个线程之间进行通信，而不是与 GUI 进行通信。GUI 恰好是需要与我的第二个线程通信的线程之一。

**更新#2：** 好的，我一定真的错过了一些东西。我创建了一个事件和一个委托，并让我的工作线程订阅了该事件。但是当我调用 Invoke(MyEvent); 从我的 GUI 线程中，工作线程所做的工作最终在 GUI 线程上并挂起 GUI 线程，直到它完成处理。在不轮询静态对象的情况下，我正在尝试做的事情是否可行？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-03T07:50:44.220

哇，我不敢相信人们怎么可能不打扰阅读这个问题。

无论如何，这就是我所做的。

1.  创建你的“消息”类。这存储了您要共享的所有信息。
2.  为每个线程创建一个 Queue<T>。使用 SyncLock（C# 锁）对其进行读/写。
3.  当你想与一个线程交谈时，通过将消息添加到队列中，向它发送一个消息对象，其中包含它需要的所有信息的**副本。**
4.  然后工作线程可以从队列中读取，按顺序读取和处理每条消息。当没有消息时，只需睡觉。

确保您不在两个线程之间共享对象。一旦您的 GUI 线程将消息粘贴到队列中，GUI 线程就不再拥有该消息。它不能包含对消息的引用，否则您将陷入困境。

这不会为您提供最佳性能，但对于大多数应用程序来说已经足够了。更重要的是，这将使犯错变得更加困难。

更新：不要使用 SyncLock 和队列。而是使用 ConcurrentQueue，它将自动为您处理任何锁定。您将获得更好的性能并且不太可能犯错误。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-02T18:17:51.443

.Net 已经附带了一个`[System.ComponentModel.BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)`专门用于处理执行后台任务和与 GUI 通信的类。用它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-04-24T22:07:09.693

伙计，阅读 Albahari 的 .Net 线程免费电子书。我以任何方式连接到它，所以这不是插头。我读过它，让我的同事读过它，我已经用过很多次了。

我建议创建一个生产者/消费者类，您可以在其中启动一个等待（非阻塞）的单个线程，将任务排入其队列，并发出信号开始工作。

只是谷歌它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-02T18:07:07.550

实际上，您已经创建了一个穷人版本的线程池。您的第二个线程只是坐在那里无所事事，如果您没有大量工作，您就不能让它为您工作。您必须将委托传递到队列中，然后您的线程起飞并执行。

你最好的选择是做你想做的事，只使用 .NET ThreadPool 并让它工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-02T20:37:43.300

我假设 GUI 中的某些事件需要一些长时间运行的任务才能启动，这些任务在后台运行 - 有两种主要方法可以做到这一点。如果您只是想在不同的线程上调用方法，那么您可以通过[异步调用同步方法](http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx)来实现。我通常会这样做：

```
 //delegate with same prototype as the method to call asynchrously
delegate void ProcessItemDelegate(object item);

//method to call asynchronously
private void ProcessItem(object item) { ... }

//method in the GUI thread
private void DoWork(object itemToProcess)
{
    //create delegate to call asynchronously...
    ProcessItemDelegate d = new ProcessItemDelegate(this.ProcessItem);
    IAsyncResult result = d.BeginInvoke(itemToProcess,
                                        new AsyncCallback(this.CallBackMethod),
                                        d); 
}

//method called when the async operation has completed
private void CallbackMethod(IAsyncResult ar)
{
    ProcessItemDelegate d = (ProcessItemDelegate)ar.AsyncState;
    //EndInvoke must be called on any delegate called asynchronously!
    d.EndInvoke(ar);
} 
```

请注意，使用此方法时，回调是在后台线程上执行的，因此对 GUI 的任何更新都必须使用 Invoke 完成。

或者，您可以使用共享状态在线程之间进行通信，并使用[EventWaitHandle](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.aspx)来发出对共享状态的更新的信号 - 在此示例中，GUI 中的一个方法将工作项添加到队列中以在后台处理。当工作可用时，工作线程处理队列中的项目。

```
 //shared state
private Queue workQueue;
private EventWaitHandle eventHandle;

//method running in gui thread
private void DoWork(Item itemToProcess)
{
   //use a private lock object instead of lock...
   lock(this.workQueue)
   {
       this.workQueue.Add(itemToProcess);
       this.eventHandle.Set();
   }
}

//method that runs on the background thread
private void QueueMonitor()
{
   while(keepRunning)
   {
       //if the event handle is not signalled the processing thread will sleep here until it is signalled or the timeout expires
       if(this.eventHandle.WaitOne(optionalTimeout))
       {
           lock(this.workQueue)
           {
              while(this.workQueue.Count > 0)
              {
                 Item itemToProcess = this.workQueue.Dequeue();
                 //do something with item...
              }
           }
           //reset wait handle - note that AutoResetEvent resets automatically
           this.eventHandle.Reset();
       }
   }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-02T23:06:30.707

Control.BeginInvoke() 的便利性很难被忽略。你不必。在您的项目中添加一个新类并粘贴以下代码：

```
using System;
using System.Threading;
using System.Windows.Forms;

public partial class frmWorker : Form {
  public frmWorker() {
    // Start the worker thread
    Thread t = new Thread(new ParameterizedThreadStart(WorkerThread));
    t.IsBackground = true;
    t.Start(this);
  }
  public void Stop() {
    // Synchronous thread stop
    this.Invoke(new MethodInvoker(stopWorker), null);
  }
  private void stopWorker() {
    this.Close();
  }
  private static void WorkerThread(object frm) {
    // Start the message loop
    frmWorker f = frm as frmWorker;
    f.CreateHandle();
    Application.Run(f);
  }
  protected override void SetVisibleCore(bool value) {
    // Shouldn't become visible
    value = false;
    base.SetVisibleCore(value);
  }
} 
```

这里有一些示例代码来测试它：

```
 public partial class Form1 : Form {
    private frmWorker mWorker;
    public Form1() {
      InitializeComponent();
      mWorker = new frmWorker();
    }

    private void button1_Click(object sender, EventArgs e) {
      Console.WriteLine(System.Threading.Thread.CurrentThread.ManagedThreadId);
      mWorker.BeginInvoke(new MethodInvoker(RunThisOnThread));
    }
    private void RunThisOnThread() {
      Console.WriteLine(System.Threading.Thread.CurrentThread.ManagedThreadId);
    }

    private void button2_Click(object sender, EventArgs e) {
      mWorker.Stop();
    }
  } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-02T18:08:22.243

使用同步对象来通知线程它需要处理新数据（或 GUI 的新状态）。一种相对简单的方法是使用事件对象。以下是其工作原理的简要说明：

1.  GUI线程第二个线程共享一个事件对象（所以他们都知道）
2.  第二个线程通常在某种循环中运行，并且每次它等待事件发出信号
3.  GUI 线程在需要第二个线程做某事时发出事件信号
4.  当第二个线程完成时，它会重置事件并再次等待（或退出）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-02T18:30:26.067

在您的第二个线程中放置一个循环，该循环大部分时间都在休眠，但是每个 [Interval] 它都会唤醒并检查一个共享变量，该变量告诉它是否运行您的方法，如果该共享布尔值设置为 true，那么它运行一个方法来执行您尝试执行的任何任务...在该方法中，让该方法从另一个共享变量中收集所需的数据。

在主 GUI 线程中，将数据放入方法参数共享变量中，然后将布尔“运行”共享变量设置为 true...

在 worker 方法中，记住在完成后将共享布尔“run”变量重置为 false，这样循环就不会一遍又一遍地运行同一个实例......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-12T18:10:33.863

您可以使用事件或 Grauenwolf 所说的 - 消息提示。我将我的每个线程都包装为一个管理单例，从那里您可以轻松实现。你甚至可以做穷人的公共财产来翻转比特。

你也可以实现一个状态机，而不是传递消息，每个线程可以互相监控

# windows - 如何从 Windows 命令行获取应用程序退出代码？

> ID：334879
> 
> 赞同：893
> 
> 时间：2008-12-02T18:04:17.773
> 
> 标签：windows, command-line, process, cmd, exit-code

我正在运行一个程序，想看看它的返回码是什么（因为它会根据不同的错误返回不同的代码）。

我知道在 Bash 中我可以通过运行来做到这一点

> 回声$？

在 Windows 上使用 cmd.exe 时我该怎么办？

* * *

## 回答 #1

> 赞同：1093
> 
> 时间：2008-12-02T18:07:58.780

一个名为的伪环境变量`errorlevel`存储退出代码：

```
echo Exit Code is %errorlevel% 
```

此外，该`if`命令有一个特殊的语法：

```
if errorlevel 
```

详情请参阅`if /?`。

# 例子

```
@echo off
my_nify_exe.exe
if errorlevel 1 (
   echo Failure Reason Given is %errorlevel%
   exit /b %errorlevel%
) 
```

*警告：如果您设置环境变量 name `errorlevel`，`%errorlevel%`将返回该值而不是退出代码。使用 ( ) 清除环境变量，允许通过`set errorlevel=`环境变量访问真实值。`errorlevel``%errorlevel%`*

* * *

## 回答 #2

> 赞同：298
> 
> 时间：2012-07-13T18:57:54.333

测试`ErrorLevel`适用于*控制台*应用程序，但正如[dmihailescu](https://stackoverflow.com/a/3119934/4518341)所暗示的，如果您尝试从命令提示符运行*窗口应用程序（例如基于 Win32 的），这将不起作用。*一个窗口应用程序将在后台运行，并且控制将立即返回到命令提示符（很可能用一个`ErrorLevel`零表示该进程已成功*创建*）。当窗口应用程序最终退出时，它的退出状态将丢失。

不过，不使用其他地方提到的基于控制台的 C++ 启动器，更简单的替代方法是使用命令提示符的`START /WAIT`命令启动窗口应用程序。这将启动窗口应用程序，等待它退出，然后将控制权返回到命令提示符，进程的退出状态设置为`ErrorLevel`.

```
start /wait something.exe
echo %errorlevel% 
```

* * *

## 回答 #3

> 赞同：117
> 
> 时间：2008-12-02T18:09:03.240

使用内置的 ERRORLEVEL 变量：

```
echo %ERRORLEVEL% 
```

但[请注意，如果应用程序定义了一个名为 ERRORLEVEL 的环境变量](https://web.archive.org/web/20190109201338/https://blogs.msdn.microsoft.com/oldnewthing/20080926-00/?p=20743/)！

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2014-07-29T16:08:20.903

如果您想完全匹配错误代码（例如等于 0），请使用：

```
@echo off
my_nify_exe.exe
if %ERRORLEVEL% EQU 0 (
   echo Success
) else (
   echo Failure Reason Given is %errorlevel%
   exit /b %errorlevel%
) 
```

`if errorlevel 0`匹配`errorlevel`>= 0。请参阅`if /?`。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-06-25T17:05:45.520

使用未附加到控制台的程序时，它可能无法正常工作，因为当您认为您拥有退出代码时，该应用程序可能仍在运行。在 C++ 中执行此操作的解决方案如下所示：

```
#include "stdafx.h"
#include "windows.h"
#include "stdio.h"
#include "tchar.h"
#include "stdio.h"
#include "shellapi.h"

int _tmain( int argc, TCHAR *argv[] )
{

    CString cmdline(GetCommandLineW());
    cmdline.TrimLeft('\"');
    CString self(argv[0]);
    self.Trim('\"');
    CString args = cmdline.Mid(self.GetLength()+1);
    args.TrimLeft(_T("\" "));
    printf("Arguments passed: '%ws'\n",args);
    STARTUPINFO si;
    PROCESS_INFORMATION pi;

    ZeroMemory( &si, sizeof(si) );
    si.cb = sizeof(si);
    ZeroMemory( &pi, sizeof(pi) );

    if( argc < 2 )
    {
        printf("Usage: %s arg1,arg2....\n", argv[0]);
        return -1;
    }

    CString strCmd(args);
    // Start the child process. 
    if( !CreateProcess( NULL,   // No module name (use command line)
        (LPTSTR)(strCmd.GetString()),        // Command line
        NULL,           // Process handle not inheritable
        NULL,           // Thread handle not inheritable
        FALSE,          // Set handle inheritance to FALSE
        0,              // No creation flags
        NULL,           // Use parent's environment block
        NULL,           // Use parent's starting directory 
        &si,            // Pointer to STARTUPINFO structure
        &pi )           // Pointer to PROCESS_INFORMATION structure
    ) 
    {
        printf( "CreateProcess failed (%d)\n", GetLastError() );
        return GetLastError();
    }
    else
        printf( "Waiting for \"%ws\" to exit.....\n", strCmd );

    // Wait until child process exits.
    WaitForSingleObject( pi.hProcess, INFINITE );
    int result = -1;
    if(!GetExitCodeProcess(pi.hProcess,(LPDWORD)&result))
    { 
        printf("GetExitCodeProcess() failed (%d)\n", GetLastError() );
    }
    else
        printf("The exit code for '%ws' is %d\n",(LPTSTR)(strCmd.GetString()), result );
    // Close process and thread handles. 
    CloseHandle( pi.hProcess );
    CloseHandle( pi.hThread );
    return result;
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2018-09-18T06:13:09.710

值得注意的是 .BAT 和 .CMD 文件的操作方式不同。

阅读[https://ss64.com/nt/errorlevel.html](https://ss64.com/nt/errorlevel.html)它注意到以下内容：

> .CMD 和 .BAT 批处理文件设置错误级别的方式有一个关键区别：
> 
> 运行“新”内部命令的旧 .BAT 批处理脚本：APPEND、ASSOC、PATH、PROMPT、FTYPE 和 SET 只会在发生错误时设置 ERRORLEVEL。因此，如果批处理脚本中有两个命令并且第一个命令失败，则即使第二个命令成功，ERRORLEVEL 仍将保持设置。
> 
> 这会使调试问题 BAT 脚本更加困难，CMD 批处理脚本更加一致，并且会在您运行的每个命令后设置 ERRORLEVEL [来源]。

当我执行连续的命令时，这让我感到无限的悲痛，但即使发生故障，ERRORLEVEL 也将保持不变。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-28T19:33:25.587

有一次，我需要将日志事件从 Cygwin 准确推送到 Windows 事件日志。我希望 WEVL 中的消息是自定义的，具有正确的退出代码、详细信息、优先级、消息等。所以我创建了一个小 Bash 脚本来处理这个问题。它在 GitHub 上，[logit.sh](https://github.com/jonretting/geforce-driver-check/blob/master/logit.sh)。

部分摘录：

```
usage: logit.sh [-h] [-p] [-i=n] [-s] <description>
example: logit.sh -p error -i 501 -s myscript.sh "failed to run the mount command" 
```

这是临时文件内容部分：

```
LGT_TEMP_FILE="$(mktemp --suffix .cmd)"
cat<<EOF>$LGT_TEMP_FILE
    @echo off
    set LGT_EXITCODE="$LGT_ID"
    exit /b %LGT_ID%
EOF
unix2dos "$LGT_TEMP_FILE" 
```

这是在 WEVL 中创建事件的函数：

```
__create_event () {
    local cmd="eventcreate /ID $LGT_ID /L Application /SO $LGT_SOURCE /T $LGT_PRIORITY /D "
    if [[ "$1" == *';'* ]]; then
        local IFS=';'
        for i in "$1"; do
            $cmd "$i" &>/dev/null
        done
    else
        $cmd "$LGT_DESC" &>/dev/null
    fi
} 
```

执行批处理脚本并调用 __create_event：

```
cmd /c "$(cygpath -wa "$LGT_TEMP_FILE")"
__create_event 
```

# c++ - C++ 中的默认函数参数必须保持不变吗？

> ID：334882
> 
> 赞同：47
> 
> 时间：2008-12-02T18:04:42.717
> 
> 标签：c++

```
void some_func(int param = get_default_param_value()); 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-12-02T20:21:46.653

默认参数可以是完整表达式集的子集。它必须在编译时和默认参数的声明处绑定。这意味着它可以是函数调用或静态方法调用，并且可以采用任意数量的参数，只要它们是常量和/或全局变量或静态类变量，但不能是成员属性。

它在编译时和函数被声明的地方绑定的事实也意味着，如果它使用一个变量，即使在函数调用的地方有一个不同的变量遮蔽了原始变量，也会使用该变量。

```
// Code 1: Valid and invalid default parameters
int global = 0;
int free_function( int x );

class Test
{
public:
   static int static_member_function();
   int member_function();

   // Valid default parameters
   void valid1( int x = free_function( 5 ) );
   void valid2( int x = free_function( global ) );
   void valid3( int x = free_function( static_int ) );
   void valid4( int x = static_member_function() );

   // Invalid default parameters
   void invalid1( int x = free_function( member_attribute ) ); 
   void invalid2( int x = member_function() );
private:
   int member_attribute;
   static int static_int;
};

int Test::static_int = 0;

// Code 2: Variable scope
int x = 5;
void f( int a );
void g( int a = f( x ) ); // x is bound to the previously defined x
void h()
{
   int x = 10; // shadows ::x
   g(); // g( 5 ) is called: even if local x values 10, global x is 5.
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-02T18:05:09.597

他们不必是！默认参数可以是特定限制内的任何表达式。每次调用该函数时都会对其进行评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-20T12:16:52.527

`David Rodríguez - dribeas`answear 很棒，但没有提供解决方案。
看起来似乎没有解决方案。

解决方案很简单：用**函数/方法重载**替换默认参数。

```
void some_func(int param);
void some_func() {
    some_func(get_default_param_value());
} 
```

# c++ - Clrdump (C++) 错误 LNK2019：函数 _main 中引用的未解析的外部符号 __imp__RegisterFilter@8

> ID：334896
> 
> 赞同：5
> 
> 时间：2008-12-02T18:09:43.240
> 
> 标签：c++, visual-studio, makefile, clrdump

我正在使用带有 pvcs 编译器的 makefile 系统（使用 Microsoft Visual C++，2008 编译器）并且我收到了以下形式的几个链接错误：

> `error LNK2019: unresolved external symbol __imp__RegisterFilter@8 referenced in function _main`

尽管使用`extern "C"`声明，即发生这种情况，即：

```
extern "C" int CLRDUMP_API RegisterFilter( LPCWSTR pDumpFileName, unsigned long DumpType ); 
```

此外，在 makeexe.mak 中，该库被链接为：

$(编译库)\lib\clrdump.lib\

老实说，我不是 makefile 方面的专家，我正在将系统从 Microsoft Visual C++ 6.0 转换到 2008。这种转换可能与链接错误有关，因为系统以前可以正常工作。

任何帮助将不胜感激。

提前致谢，

真诚的，约瑟夫

**-- 编辑 1 --**

有谁知道如何在 pvcs 的 makefile 系统中打开详细信息？

请注意，上面的函数已经是编译器修饰的版本，具有

```
__imp__RegisterFilter@8 
```

而 C++ 函数只是

```
RegisterFilter 
```

感谢您的帮助，但如果有人可以发布更完整的解决方案，那也将不胜感激。

真诚的，约瑟夫

**-- 编辑 2 --**

某个好心人发布了这个，但是当我登录时它消失了：

imp 前缀表示该函数是从 DLL 导入的。检查`CLRDUMP_API`- 的定义是`__declspec(dllimport)`吗？有关更多信息，请参阅本文。

有一个工作链接，但我失去了它，但我想人们总是可以搜索这个主题。

谢谢，不管你是谁！

**-- 编辑 3 --**

谢谢 ChrisN（我还不能投票）。尽管使用了刷新按钮，但您的答案消失了，但在我发布剪切粘贴后又重新出现。

这是我的定义：

```
define CLRDUMP_API __declspec(dllimport) __stdcall 
```

我假设 __stdcall 没问题？

**-- 编辑 4 --**

虽然我感谢那些回答的人，尤其是 ChrisN，至少在我的特定系统上所做的努力，但链接错误仍然存​​在。因此，如果有人有任何进一步的见解，我将不胜感激。再次感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-02T21:16:07.077

`__imp_`前缀表示链接器希望从 DLL 导入此函数。

是[这个页面](http://www.debuginfo.com/tools/clrdump.html)的 clrdump 库吗？如果是这样，请注意`extern "C"`在随库提供的头文件中未使用。我使用以下命令确认了这一点：

```
dumpbin /exports clrdump.lib 
```

它产生以下输出`RegisterFilter`- 这是一个损坏的 C++ 函数名称：

> `?RegisterFilter@@YGHPBGK@Z (int __stdcall RegisterFilter(unsigned short const *,unsigned long))`

我尝试使用 Visual Studio 2008 使用 clrdump.lib 创建示例程序。这是我的代码：

```
#include <windows.h>
#include "ClrDump.h"

int _tmain(int argc, _TCHAR* argv[])
{
    RegisterFilter(L"", 0);
    return 0;
} 
```

构建它会产生以下链接器错误：

> `LNK2019: unresolved external symbol "__declspec(dllimport) int __stdcall RegisterFilter(wchar_t const *,unsigned long)" (__imp_?RegisterFilter@@YGHPB_WK@Z)`

代码可以使用 Visual C++ 6.0 构建。

请注意，`dumpbin`输出显示第一个参数`RegisterFilter`as`unsigned short const *`但链接器错误显示`wchar_t const *`。在 Visual C++ 6.0 中，`wchar_t`通常是 的 typedef `unsigned short`，而在更高版本中，它是不同的内置类型。

为了解决 Visual Studio 2008 中的问题，我将“将 wchar_t 视为内置类型”选项设置为“否”（`/Zc:wchar_t-`在编译器命令行中指定），现在代码构建正常。

很抱歉与我之前的回答混淆。我希望这更有帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-09-30T19:50:25.863

我最近遇到了同样的问题。我排除了一个库以避免冲突，所有的错误都消失了，除了 LINK 错误（正如你所描述的）。当我将库换成另一个库时（我排除（忽略）MSVCRT.lib，现在我排除（忽略）LIBCMT.lib）问题消失了。确保您没有在某处混淆库。就我而言，链接器因“找不到**imp** _aligned_malloc”而失败。当然，我的任何代码中都没有该名称的方法。**编译器在imp**前面。究竟为什么我不知道，除了当我如上所述交换排除（忽略）时问题消失了。

尝试从一个新项目开始，重新添加您的源文件和头文件，并跟踪您排除（忽略）的库。尝试各种组合。希望有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-02T18:11:58.337

尝试打开链接器的详细输出（通常是命令行开关）。这将向您准确显示链接器如何尝试解析符号，因此您可以查看是否：

*   符号的签名是您所期望的
*   链接器正在为您的库寻找正确的位置

我希望这有帮助！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-31T10:54:34.130

我在 VS2005 中创建了一个简单的 Win32 c++ 应用程序，我收到了这个错误：

```
LNK2019: unresolved external symbol __imp__somefunction 
```

此应用程序正在使用属性表，因此它需要此标头 (prsht.h)。

我的问题的解决方案如下：在程序**Properties→Configuration Properties→Linker→General**中，我将**Additional Library Directories**设置为`"C:\Program Files\Microsoft Visual Studio 8\VC\PlatformSDK\Lib"`.

同样在程序**属性→配置属性→链接器→****附加选项**的命令行中，我添加了`ComCtl32.Lib ComDlg32.Lib`.

我的程序现在正在编译，没有任何问题。我的两分钱：您需要确定程序所需的所有库。提示：检查您包含的所有标题，您需要确保您的链接器可以看到它们。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-05-05T08:31:08.987

不知道是不是你的情况，但是**imp**前缀可能意味着你正在 Win32 项目中编译 x64 库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-05T21:26:39.277

**使用 .DEF 文件**

如果您选择将 __declspec(dllimport) 与 .DEF 文件一起使用，则应将 .DEF 文件更改为使用 DATA 或 CONSTANT 以减少错误编码导致问题的可能性：

```
// project.def
LIBRARY project
EXPORTS
   ulDataInDll   CONSTANT 
```

下表显示了原因：

```
Keyword      Emits in the import library   Exports
CONSTANT     _imp_ulDataInDll              _ulDataInDll
             _ulDataInDll                  

DATA         _imp_ulDataInDll              _ulDataInDll 
```

[http://msdn.microsoft.com/en-us/library/aa271769(v=vs.60).aspx](http://msdn.microsoft.com/en-us/library/aa271769(v=vs.60).aspx)

# .net - AppDomain 创建速度有多快？

> ID：334899
> 
> 赞同：1
> 
> 时间：2008-12-02T18:10:58.213
> 
> 标签：.net, appdomain, reflection.emit

我刚刚发现，如果通过 Reflection.Emit 生成程序集，.NET 框架会将引用保存在一个静态成员中，以防止 Reflection.Emit 类不被 GC'ed。

由于限制，我无法使用 DynamicMethod。我还在程序过程中生成了很多程序集（IronScheme 的增量编译器）（可能是 1000+）。

因此，我想只在一个单独的域中处理代码生成，然后再将其卸载（尚未决定如何处理）。

有没有人有任何经验这会有多贵？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-10T15:37:48.220

我会根据您的具体情况对其进行基准测试。

如果结果很昂贵，只需预先创建一些，然后根据需要使用并在后台重新创建新的，以确保您始终有足够的未使用的等待（有点像线程池，但您重新创建它们每次释放内存）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T18:18:38.230

据我了解，它只是比产生一个线程慢一点。

* * *

一直在做一些研究，试图找到一个真正的参考。到目前为止，这是我能想到的最好的：http:
[//msdn.microsoft.com/en-us/library/aa159887.aspx](http://msdn.microsoft.com/en-us/library/aa159887.aspx)

大约有 2/3 的方法称创建 AppDomains “昂贵”，但是您可能会在某些上下文中对线程说同样的话——这实际上取决于特定线程在创建时所做的事情。

再说一遍：我的理解是，AppDomain 本质上是一个进程中的一个线程（或多个线程）——一个逻辑分隔符，如果你愿意的话——这样运行时保证某些额外的保护是有效的，可以防止单独的 AppDomain 干扰每个其他。要在现有进程（应用程序）中创建新的 AppDomain，框架必须完成与创建新线程相关的所有工作，以及在应用程序的其余部分中设置它的一些额外开销（可能还涉及加载一个或多个汇编到内存中）。最后，AppDomain 位于线程和进程之间。

# regex - 在 rlike 正则表达式中否定特定的行结束序列

> ID：334907
> 
> 赞同：1
> 
> 时间：2008-12-02T18:12:48.473
> 
> 标签：regex, rlike

我想匹配任何不以“CA”或“CA[任何数字]”结尾的行。如何在 MySQL 中使用 rlike 来做到这一点？（注意它不支持？！等）。

这是正则匹配的正则表达式，我只需要一种方法来否定它： `'^.*[C][A][0-9]?$'`

（由于尴尬的架构限制，我不想使用`not rlike ...`）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-03T06:10:45.717

诀窍是把它变成你想要匹配的内容的*描述*。在以下情况下，某些内容不会以 CA 或 CA(digit) 结尾：

它以 A 或数字以外的内容结尾，或

它以 A 以外的东西结尾，然后是一个数字，或者

它以 C 以外的东西结尾，然后是 A，然后是数字，或者

它以 C 以外的东西结尾，然后是 A，或

它等于 A 后跟一个数字，或

它等于 A 或一个数字，或

它是空的。

所以：

```
rlike '[^A0-9]$|[^A][0-9]$|[^C]A[0-9]$|[^C]A$|^A[0-9]$|^[A0-9]$|^$' 
```

未经测试，未经“优化”，可能在上述某处至少出现一个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T19:01:09.593

> 那么正则表达式来自表格中的一列，并且那里的大多数模式已经起作用。因此，如果我可以使这种模式在现有结构中工作，那将是最简单的。

我曾经做过类似的事情，我所做的是创建另一个列（我想我使用了一个位域），其中包含正则表达式的选项（不区分大小写、锚定、否定等）。类似的方法可能对您有用。

# c - 用日语打印出另一个 C 程序的 C 程序

> ID：334913
> 
> 赞同：4
> 
> 时间：2008-12-02T18:15:22.167
> 
> 标签：c, quine

有一个为比赛编写的 C 程序，它以 ASCII 艺术格式被格式化为日语字符。编译并运行后，它打印出另一个以不同日文字符格式化的程序，然后是另一个，最后它再次打印出第一个。

我正在寻找它的代码，但在互联网上找不到。我不记得是什么比赛，也不记得节目的名称是什么。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T18:27:12.190

国际混淆 C 代码竞赛：[http ://www1.us.ioccc.org/main.html](http://www1.us.ioccc.org/main.html)

我找不到那个特定的程序，但我会继续寻找。当我找到它时，我将编辑我的答案。

**编辑：**

我想你可能指的是这个页面上的 dhyang 条目：[http ://www1.us.ioccc.org/years-spoiler.html](http://www1.us.ioccc.org/years-spoiler.html)

**编辑：** 以上网站已关闭。这里又是：

dhyang.c 2000 唐杨
[http://www.uguu.org/src_saitou_c.html](http://www.uguu.org/src_saitou_c.html)

# sql-server - 在客户端计算机上配置 SQL Native Client ODBC？

> ID：334916
> 
> 赞同：3
> 
> 时间：2008-12-02T18:16:03.630
> 
> 标签：sql-server, odbc, named-pipes, odbc-sql-server-driver

我们有一个应用程序，我们的客户端通过 SQL Native Client ODBC 数据源连接到 SQL Server 2005 数据库。我们在程序执行期间 ODBC 连接被切断时遇到了一些困难。在询问技术支持人员后，他说他以前见过这种类型的错误，但他们通过将客户端配置为使用命名管道（主要）而不是 TCP/IP 连接来解决问题。

所以我做了一些研究，找到了在服务器上配置客户端访问的位置——通过 SQL Server 配置管理器。但是，似乎没有办法在客户端机器上配置 SQL Native Client ODBC 数据源。较旧的 SQL Server ODBC 驱动程序允许您将其配置为使用命名管道或 TCP/IP，但 SQL Native Client 不允许。

SQL Native Client 数据源是否自动决定使用哪种方法连接数据库？有没有办法配置它？......有没有办法找出特定客户端机器正在使用哪种方法进行连接？

任何帮助，将不胜感激。

——谢谢迈克 C。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-10T22:35:41.743

注意你可以设置连接字符串中使用的协议，不需要配置机器。我建议不要使用 cliconfg 更改机器配置，因为这会影响机器上运行的所有应用程序。

所以有两种方法来设置网络协议。

1.  使用协议前缀：

    `Server=tcp:myserver`
    `Server=np:myserver`

    `tcp:`前缀表示使用 tcp 协议。 `np:`前缀表示使用命名管道协议。只需将其粘贴在您要连接的服务器名称的前面。

2.  第二种方法是在连接字符串中设置 Network 关键字：

    `Network=dbmssocn`
    `Network=dbnmpntw`

我更喜欢协议前缀，因为我永远记不住这些网络类型的缩写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T20:38:41.940

也许这会让你继续：

4) 如果您使用 SQL Native Client ODBC/OLEDB 提供程序（{SQL Native Client} 或 SQLNCLI），请转到 SQL 配置管理器，单击客户端协议，确保 NP 和 TCP 都已启用。右键单击NP的属性，确保客户端使用与服务器相同的管道名称进行连接。

该节点实际上是“SQL Native Client Configuration”，您可以从那里更改优先级并禁用。

来自 [http://blogs.msdn.com/sql_protocols/archive/2007/03/31/named-pipes-provider-error-40-could-not-open-a-connection-to-sql-server.aspx](http://blogs.msdn.com/sql_protocols/archive/2007/03/31/named-pipes-provider-error-40-could-not-open-a-connection-to-sql-server.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T21:46:09.863

1.  不确定命名管道是否能解决 ODBC 连接中断问题。如果没有首先确定问题的根源，我不会指望命名管道。不过我可能是错的。你能看到任何可以解释这个问题的错误吗？这可能与网络有关。

2.  否则，我认为在客户端机器上配置它应该很容易：只需运行 cliconfg（SQL Server 客户端网络实用程序）。在 General 选项卡中确保启用了 Named Pipes 协议，然后导航到 Alias 选项卡并使用 Named Pipes 为您的服务器创建一个别名。

祝你好运。

# sql-server - 批量插入 Sql Server

> ID：334919
> 
> 赞同：17
> 
> 时间：2008-12-02T18:17:23.783
> 
> 标签：sql-server, vb.net, performance

我正在尝试从 Vb.Net 将大量记录插入 SQL Server 2005。尽管插入工作正常，但我正在尽最大努力使其尽可能快。目前，100,000 条记录大约需要 11 分钟。将大量记录从应用程序插入 SQL Server 的建议方法是什么？

我目前的方法基本上是打开连接，遍历我的信息列表并触发单个 sql 插入语句，然后关闭连接。有人对如何做到这一点有更好的建议吗？

当前功能：

```
Public Sub BatchInsert(ByVal ParamCollections As List(Of SqlParameter()))

    Dim Conn As SqlConnection = New SqlConnection(DBHelper.DatabaseConnection)
    Using scope As TransactionScope = New TransactionScope()
    Using Conn

        Dim cmd As SqlCommand = New SqlCommand("sproc_name", Conn)

        Conn.Open()
        cmd.CommandType = CommandType.StoredProcedure

        For i = 0 To ParamCollections.Count - 1

            cmd.Parameters.Clear()
            cmd.Parameters.AddRange(ParamCollections(i))
            cmd.ExecuteNonQuery()

        Next

        Conn.Close()
        scope.Complete()
    End Using
    End Using

End Sub 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-02T18:19:38.007

使用[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)类，它将能够比单个插入快得多地运行这 100K 行。

哦，如果可以的话，我会敦促您实现一个支持[IDataReader](http://msdn.microsoft.com/en-us/library/system.data.idatareader.aspx)的类，以提供[SqlBulkCopy.WriteToServer(IDataReader)](http://msdn.microsoft.com/en-us/library/434atets.aspx)方法，这将允许您按顺序生成数据，一次一行。例如，如果您从文本文件导入，构建一些`IEnumerable<T>`使用方法`yield return`并将其转换为[IDataReader](http://msdn.microsoft.com/en-us/library/system.data.idatareader.aspx)对象将允许您非常自然地向服务器提供数据。

为了对抗 BCP 回滚能力的丧失，您可以将数据转移到临时表中，然后`INSERT INTO`在服务器上执行正常的语句，将数据从临时表批量转移到生产表中，这样您就可以使用最后一个传输部分的事务，并且仍然比您原来的单个插入语句运行得快很多。

编辑：[这是一个使用批量加载 API 的示例](https://stackoverflow.com/questions/287708/best-practices-for-uploading-files-to-database#287749)（C#，但应该很容易转换为 VB.Net）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-02T19:20:13.860

感谢大家的帮助，我能够完成我的任务。SQLBulkCopy 完全符合我的需求（尽管还有其他一些很好的建议）。使用 SqlBulkcopy，时间从 11 分钟缩短到 45 秒。我无法相信差异！

为了将来参考，这里有一些信息：

*   要使用 SQL 大容量复制，您的数据必须采用 DataSet、DataReader 或 DataTable 的形式。一些 XML 也是允许的。

基本实现代码：

```
 Public Sub PerformBulkCopy(ByVal dt As DataTable)

    Using Conn As SqlConnection = New SqlConnection(DBHelper.DatabaseConnection)
        Conn.Open()

        Using s As SqlBulkCopy = New SqlBulkCopy(Conn)

            s.DestinationTableName = "TableName"
            s.WriteToServer(dt)
            s.Close()

        End Using

        Conn.Close()
    End Using
End Sub 
```

我发现非常有用的链接：

[使用 Sql 批量复制](http://www.sqlteam.com/article/use-sqlbulkcopy-to-quickly-load-data-from-your-client-to-sql-server)

感谢大家的帮助！我真诚地感谢它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T18:55:15.487

将要导入的数据放入 csv 文件并在数据上运行 bcp 实用程序。一次插入单行的顺序调用无法获得更快的速度，如果您想要性能，您当然需要一个批量实用程序。

SQLBulkCopy 类将允许您传输集合中的所有数据，以便服务器可以一次处理所有内容，从而消除来回。因此，如果您想避免创建临时文件（我会这样做），请查看该类。

让连接保持打开是一个好的开始，但是您仍然需要发送一行、让 SQL 存储它、返回结果，然后您必须迭代到下一行的开销。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T18:42:42.890

还有一个存储过程（称为批量插入）可以为您解决问题。它在幕后使用 bcp。

查看此链接以查看语法

[链接文本](http://msdn.microsoft.com/en-us/library/aa225968.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T18:31:37.203

这取决于如何实现大容量复制类。但是 SQL Server 的安装中包含一个命令行工具，它完全可以做到这一点（它可能是相同的）。它被称为“bcp”。我现在正在使用它，它应该能够在几秒钟内冲过 100k 行。

MSDN 文档将其称为“批量导入”实用程序。

# c# - 如何确定我的 winform 在哪个监视器中？

> ID：334928
> 
> 赞同：11
> 
> 时间：2008-12-02T18:19:48.680
> 
> 标签：c#, .net, winforms, .net-3.5, .net-2.0

我一直在这个网站上上下下，发现了很多关于 Screen 类的信息以及如何计算监视器的数量等等，但是我如何确定表单当前在哪个监视器中？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-03T02:07:55.893

比使用边界更简单的方法是使用 Screen.FromControl() 方法。这与 Windows 使用的功能相同。

```
Screen.FromControl(this) 
```

将返回包含您调用它的大部分表单的屏幕的屏幕对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T19:05:12.847

这应该为您解决问题：

```
private Screen FindCurrentMonitor(Form form) 
{ 
    return Windows.Forms.Screen.FromRectangle(new Rectangle( _
        form.Location, form.Size)); 
} 
```

它将返回包含大部分表单的屏幕。Alternativley，您可以使用

```
return Windows.Forms.Screen.FromPoint(Form.Location); 
```

返回包含表单左上角的屏幕。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T19:01:31.060

我确实注意到了这一点，但我希望有更多的东西（来自.net而不是你。）所以根据你的建议，我这样做了：

```
 foreach (Screen screen in System.Windows.Forms.Screen.AllScreens)
    {
        if (screen.Bounds.Contains(this.Location))
        {
            this.textBox1.Text = screen.DeviceName;
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T18:23:23.337

每个 Screen 对象都有一个[Bounds](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.bounds.aspx)属性，您可以使用它来查找屏幕占据的坐标，只需检查表单的位置即可。

# c# - LINQ 与 FoxPro？

> ID：334930
> 
> 赞同：7
> 
> 时间：2008-12-02T18:21:04.980
> 
> 标签：c#, .net, linq, foxpro

有没有一种合理的方法可以使用 LINQ 访问 FoxPro 数据库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-28T12:02:31.937

我刚刚完成了实施工作。 [http://linqtovfp.codeplex.com/](http://linqtovfp.codeplex.com/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-02T18:46:21.887

.NET 的一个祝福/诅咒之一是任何 .NET 编程问题的答案很少是“否”。

例如，这个人（感谢 Sergey 和 Larry）展示了一种使用 LINQ 访问 FoxPro 类型 DB 的方法：http: [//blogs.msdn.com/calvin_hsia/archive/2007/11/30/6620133.aspx](http://blogs.msdn.com/calvin_hsia/archive/2007/11/30/6620133.aspx)

一个更好的问题可能是，你不能，但你应该！？

如果您坚持这样的选择，实体框架可能是一个更好的地方：http: [//msdn.microsoft.com/en-us/library/aa697427 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T18:43:49.783

Linq2Sql只支持Sql Server，Entity框架支持一堆，但foxpro不是其中之一。

NHibernate 有一个[刚刚发布 1.0](http://ayende.com/Blog/archive/2009/07/26/nhibernate-linq-1.0-released.aspx)的 Linq 提供程序，稍加调整就可以让它与 Foxpro 一起使用。

IMO NHibernate.Linq 是您最好的选择，但这完全取决于您如何定义“合理”；-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-14T11:58:46.823

我目前正在这个一般领域工作 - 尝试将 Silverlight 连接到 VFP9 表中的旧数据等等。

您可能会发现采用 Web 服务方法更容易。这将涉及使用 Visual FoxPro 创建一个 COM 服务器 DLL，该 DLL 具有访问 VFP 数据的方法，并使用 CursorToXML() 以 .NET 可以加载到 DataSet 或 DataTable 的格式返回它们。CursorToXML 可以自行完成。然后，您将在 .NET 中创建一个 WCF Web 服务项目，并将 VFP 创建的 COM DLL 添加到该项目中 - 您在这里使用的是 COM Interop。然后，您在 WCF 服务中创建 WebMethods，该服务映射到 VFP DLL 上的方法调用。一旦它在 WCF 服务中，您就可以将该服务用作数据源。也许不是最快的做事方式，但它确实有效。

Rick Strahl 在[Code Magazine](http://www.code-magazine.com/Article.aspx?quickid=0703062)中发表了一篇出色的文章，展示了这一切。

# c# - ReSharper 一次运行项目或解决方案中的所有单元测试

> ID：334933
> 
> 赞同：25
> 
> 时间：2008-12-02T18:21:18.957
> 
> 标签：c#, resharper

我在 IDE 中，可以在一个文件中运行所有单元测试，但是有没有办法一次在项目或解决方案中运行所有测试？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-02T18:46:43.337

右键单击 VS 解决方案资源管理器中的项目或解决方案并选择“运行单元测试”或转到 Resharper 菜单，选择单元测试并从中选择一个选项。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-12-02T20:21:42.550

如果您学习使用 Alt-Letters 执行菜单命令，您可以快速执行许多命令，即使它们没有直接的快捷方式。特别是，如果快捷键是两键组合。

至于在解决方案中**运行**所有测试，命令是Alt- **RUN**，即 Alt-R 用于 ReSharper 菜单，U 用于单元测试，N 用于解决方案中的所有测试。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-06-29T00:21:39.637

我很惊讶这里没有人提到它，但是几乎所有的 resharper 命令都可以分配给特定的自定义键盘快捷键。转到`Tools --> Options --> Keyboard`，找到您感兴趣的命令（只需在“显示包含的命令”文本字段中输入“resharper”即可找到所有命令）。在此特定实例中，“从解决方案运行所有测试”命令是“ **ReSharper.UnitTest_RunSolution** ”。

在 ReSharper 9.x 中，命令名称为**ReSharper.ReSharper_UnitTestRunSolution**。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-02T18:38:55.567

打开 ReSharper->Windows->Unit Test Explorer 并选择所有内容，然后点击运行按钮

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-02-13T10:12:29.203

有时，Resharper 将无法看到测试，直到您手动重建它们。因此，如果您在 resharper 中看不到测试，或者 resharper 没有运行解决方案中的所有测试，请先重建它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-17T14:00:31.403

[Resharper 7 默认快捷方式：](http://www.jetbrains.com/resharper/docs/ReSharper70DefaultKeymap_VS_scheme.pdf)

从解决方案运行所有测试：`Ctrl+U`,`L`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-23T13:28:58.970

可能是在单元测试资源管理器中未完全检测到您的单元测试。在这种情况下，重新启动 Visual Studio 有助于解决该问题。

# c# - 如何使用 C# 创建 ODBC DSN 条目？

> ID：334939
> 
> 赞同：27
> 
> 时间：2008-12-02T18:23:11.137
> 
> 标签：c#, odbc

我正在开发一个具有 C++ 扩展存储过程的遗留应用程序。此 xsproc 使用 ODBC 连接到数据库，这意味着它需要配置 DSN。

我正在更新安装程序（使用 Visual Studio 2008 安装项目创建），并希望有一个可以创建 ODBC DSN 条目的自定义操作，但我很难在 Google 上找到有用的信息。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-03T10:58:28.960

我最终通过操纵注册表自己解决了这个问题。我创建了一个包含功能的类，我在这里包含了它的内容：

```
///<summary>
/// Class to assist with creation and removal of ODBC DSN entries
///</summary>
public static class ODBCManager
{
    private const string ODBC_INI_REG_PATH = "SOFTWARE\\ODBC\\ODBC.INI\\";
    private const string ODBCINST_INI_REG_PATH = "SOFTWARE\\ODBC\\ODBCINST.INI\\";

    /// <summary>
    /// Creates a new DSN entry with the specified values. If the DSN exists, the values are updated.
    /// </summary>
    /// <param name="dsnName">Name of the DSN for use by client applications</param>
    /// <param name="description">Description of the DSN that appears in the ODBC control panel applet</param>
    /// <param name="server">Network name or IP address of database server</param>
    /// <param name="driverName">Name of the driver to use</param>
    /// <param name="trustedConnection">True to use NT authentication, false to require applications to supply username/password in the connection string</param>
    /// <param name="database">Name of the datbase to connect to</param>
    public static void CreateDSN(string dsnName, string description, string server, string driverName, bool trustedConnection, string database)
    {
        // Lookup driver path from driver name
        var driverKey = Registry.LocalMachine.CreateSubKey(ODBCINST_INI_REG_PATH + driverName);
        if (driverKey == null) throw new Exception(string.Format("ODBC Registry key for driver '{0}' does not exist", driverName));
        string driverPath = driverKey.GetValue("Driver").ToString();

        // Add value to odbc data sources
        var datasourcesKey = Registry.LocalMachine.CreateSubKey(ODBC_INI_REG_PATH + "ODBC Data Sources");
        if (datasourcesKey == null) throw new Exception("ODBC Registry key for datasources does not exist");
        datasourcesKey.SetValue(dsnName, driverName);

        // Create new key in odbc.ini with dsn name and add values
        var dsnKey = Registry.LocalMachine.CreateSubKey(ODBC_INI_REG_PATH + dsnName);
        if (dsnKey == null) throw new Exception("ODBC Registry key for DSN was not created");
        dsnKey.SetValue("Database", database);
        dsnKey.SetValue("Description", description);
        dsnKey.SetValue("Driver", driverPath);
        dsnKey.SetValue("LastUser", Environment.UserName);
        dsnKey.SetValue("Server", server);
        dsnKey.SetValue("Database", database);
        dsnKey.SetValue("Trusted_Connection", trustedConnection ? "Yes" : "No");
    }

    /// <summary>
    /// Removes a DSN entry
    /// </summary>
    /// <param name="dsnName">Name of the DSN to remove.</param>
    public static void RemoveDSN(string dsnName)
    {
        // Remove DSN key
        Registry.LocalMachine.DeleteSubKeyTree(ODBC_INI_REG_PATH + dsnName);

        // Remove DSN name from values list in ODBC Data Sources key
        var datasourcesKey = Registry.LocalMachine.CreateSubKey(ODBC_INI_REG_PATH + "ODBC Data Sources");
        if (datasourcesKey == null) throw new Exception("ODBC Registry key for datasources does not exist");
        datasourcesKey.DeleteValue(dsnName);
    }

    ///<summary>
    /// Checks the registry to see if a DSN exists with the specified name
    ///</summary>
    ///<param name="dsnName"></param>
    ///<returns></returns>
    public static bool DSNExists(string dsnName)
    {
        var driversKey = Registry.LocalMachine.CreateSubKey(ODBCINST_INI_REG_PATH + "ODBC Drivers");
        if (driversKey == null) throw new Exception("ODBC Registry key for drivers does not exist");

        return driversKey.GetValue(dsnName) != null;
    }

    ///<summary>
    /// Returns an array of driver names installed on the system
    ///</summary>
    ///<returns></returns>
    public static string[] GetInstalledDrivers()
    {
        var driversKey = Registry.LocalMachine.CreateSubKey(ODBCINST_INI_REG_PATH + "ODBC Drivers");
        if (driversKey == null) throw new Exception("ODBC Registry key for drivers does not exist");

        var driverNames = driversKey.GetValueNames();

        var ret = new List<string>();

        foreach (var driverName in driverNames)
        {
            if (driverName != "(Default)")
            {
                ret.Add(driverName);
            }
        }

        return ret.ToArray();
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-06-29T15:44:11.213

在[chrfalch 的帖子之后](https://stackoverflow.com/questions/334939/how-do-i-create-an-odbc-dsn-entry-using-c/2336287#2336287)，这里是一些用于更新 DSN 的示例代码（我知道 OP 要求创建，但是此代码很容易转换为您需要做的任何事情），使用 API 调用而不是通过注册表直接（使用来自[pinvoke.net 页面](http://www.pinvoke.net/default.aspx/odbccp32.sqlconfigdatasource)的信息）：-

```
[DllImport("ODBCCP32.DLL", CharSet = CharSet.Unicode, SetLastError = true)]
static extern bool SQLConfigDataSourceW(UInt32 hwndParent, RequestFlags fRequest, string lpszDriver, string lpszAttributes);

enum RequestFlags : int
{
    ODBC_ADD_DSN = 1,
    ODBC_CONFIG_DSN = 2,
    ODBC_REMOVE_DSN = 3,
    ODBC_ADD_SYS_DSN = 4,
    ODBC_CONFIG_SYS_DSN = 5,
    ODBC_REMOVE_SYS_DSN = 6,
    ODBC_REMOVE_DEFAULT_DSN = 7
}

bool UpdateDsnServer(string name, string server)
{
    var flag = RequestFlags.ODBC_CONFIG_SYS_DSN;
    string dsnNameLine = "DSN=" + name;
    string serverLine = "Server=" + server;

    string configString = new[] { dsnNameLine, serverLine }.Aggregate("", (str, line) => str + line + "\0");

    return SQLConfigDataSourceW(0, flag, "SQL Server", configString);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-02-25T17:48:34.457

有一个 API 可以做这样的事情。使用 API 还将确保您的应用程序与较新版本的 Windows 保持兼容。API 可以在这里找到：

[http://msdn.microsoft.com/en-us/library/ms716476(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms716476(VS.85).aspx)

可以在 PInvoke.net 上找到在 c# 中调用此函数的 PInvoke。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T18:30:26.473

有一个[关于读取 ODBC 信息的 CodeProject 页面](http://www.codeproject.com/Articles/5862/An-ODBC-DSN-Driver-Manager-DLL-written-in-Csharp-V)。

阅读它应该为您提供逆向工程编写所需的注册表项所需的信息。

从那个代码；

```
 private const string ODBC_LOC_IN_REGISTRY = "SOFTWARE\\ODBC\\";
  private const string ODBC_INI_LOC_IN_REGISTRY =
          ODBC_LOC_IN_REGISTRY + "ODBC.INI\\";

  private const string DSN_LOC_IN_REGISTRY =
          ODBC_INI_LOC_IN_REGISTRY + "ODBC Data Sources\\";

  private const string ODBCINST_INI_LOC_IN_REGISTRY =
          ODBC_LOC_IN_REGISTRY + "ODBCINST.INI\\";

  private const string ODBC_DRIVERS_LOC_IN_REGISTRY =
          ODBCINST_INI_LOC_IN_REGISTRY + "ODBC Drivers\\"; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-14T18:53:42.790

为 Barnwell 的代码 +1！

但是，我*认为*他的 DSNExists() 正在查询错误的键。我*认为*应该是这样的：

```
public static bool DSNExists(string dsnName) 
{ 
    var sourcesKey = Registry.LocalMachine.CreateSubKey(ODBC_INI_REG_PATH + "ODBC Data Sources"); 
    if (sourcesKey == null) throw new Exception("ODBC Registry key for sources does not exist"); 

    return sourcesKey.GetValue(dsnName) != null; 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-15T18:00:33.350

感谢您提供此代码，我自己使用过。我不得不改变两件艰难的事情：

为了获得`driverName`我必须使用`OpenSubKey`而不是`CreateSubKey`获取值：

```
// Lookup driver path from driver name
var driverKey = Microsoft.Win32.Registry.LocalMachine.OpenSubKey(
        ODBCINST_INI_REG_PATH + driverName); 
```

由于我运行的是 Vista，我必须使用应用程序清单并将其设置`requestedPrivileges`为：

```
<requestedExecutionLevel level="requireAdministrator" uiAccess="false"/> 
```

以下文章帮助我找到了`OpenSubKey`问题：[http ://www.daveoncsharp.com/2009/08/read-write-delete-from-windows-registry-with-csharp/](http://www.daveoncsharp.com/2009/08/read-write-delete-from-windows-registry-with-csharp/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-10T20:53:53.067

谢谢，如果你正在制作一个 dsn 到 excel，这是一个很大的帮助，也许需要添加这样的东西

```
 var dsnKeyEng = Microsoft.Win32.Registry.LocalMachine.CreateSubKey(ODBC_INI_REG_PATH + dsnName + "\\Engines");
 var dsnKeyExl = Microsoft.Win32.Registry.LocalMachine.CreateSubKey(ODBC_INI_REG_PATH + dsnName + "\\Engines\\Excel");

 dsnKeyExl.SetValue("FirstRowHasNames", 01);
 dsnKeyExl.SetValue("MaxScanRows", 8);
 dsnKeyExl.SetValue("Threads",3);
 dsnKeyExl.SetValue("UserCommitSync", "Yes") 
```

# nhibernate - 托管网站上的 nHibernate 性能缓慢

> ID：334940
> 
> 赞同：3
> 
> 时间：2008-12-02T18:23:11.683
> 
> 标签：nhibernate, castle-windsor, web-hosting, public

我有一个由公共托管公司托管的 web 应用程序，该站点尚未上线，我仍在对其进行一些测试。我正在使用 nHibernate 和 Windsor Castle Container 进行依赖注入，并且该站点似乎不时响应非常缓慢。我已经联系了支持人员，但他们说这是我的应用程序而不是他们的服务器。在公共托管公司托管时，是否有人在基于 ORM 的网站上遇到过类似的性能问题？

另外，您会推荐哪些托管公司来托管网站？我尝试了godaddy，但无法使用它们，因为它们不允许以完全信任的方式运行网站，这显然是nHibernate 所必需的。

* * *

我使用 xml 配置文件配置了 nHibernate，以下列方式打开会话：

```
using (ISession session = _sessionManager.OpenSession())
{         
ICriteria crit = session.CreateCriteria(typeof(Content));
   return crit.List();
} 
```

同样在`Application_Start`我有以下代码：

```
private static WindsorContainer container;
if (container == null)
   {
     container = new WindsorContainer(new XmlInterpreter(filePath));
      Application[Constant.CastleWindsorAppKey] = container;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T20:03:18.783

不测量时，您不知道您的应用程序有多慢。我在开发过程中使用了一个[计时 http 模块](http://haacked.com/archive/2008/07/02/httpmodule-for-timing-requests.aspx)来快速发现大的性能问题。当您的一个页面加载缓慢时，您应该使用分析器来找到确切的瓶颈。我正在为我当前的项目使用 NHibernate，并且我没有任何性能问题。我最复杂的查询涉及 10 个不同类的复杂对象图，它们的 NHibernate 映射需要 0.082 秒才能执行。该应用程序的主要瓶颈是将 html aspx 模板渲染到响应中（这需要 0.5 秒）。性能问题通常存在于数据访问中，但除非您对其进行衡量，否则您无法确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T18:56:07.543

没有做任何仪器，你只是在猜测。您需要在您的数据库调用周围包装一个计时代理。然后记录每次通话需要多长时间。如果这是您花费时间的地方，那么您拥有继续进行所需的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T18:39:20.153

假设您使用的是共享托管环境，它可能不是您的应用程序。我已经看到完美的代码在共享主机上停止运行。对于共享托管问题，我知道的唯一解决方案是某种托管应用程序主机，获取虚拟专用服务器（托管或非托管）或专用服务器盒。这种类型的服务比共享主机更昂贵。

至于 Windows 的托管建议，很抱歉我没有。

# jquery - 动画结束前调用的 JQuery 动画回调

> ID：334948
> 
> 赞同：5
> 
> 时间：2008-12-02T18:27:54.200
> 
> 标签：jquery

我正在使用 slideDown 动画在新添加的表格行中显示一些 div：

```
$("div", newRow).slideDown(10000, UpdateHours(response.d.Hours)); 
```

但是，在 div 完成动画之前很久就会调用 UpdateHours() 函数。这给我带来了一个问题，因为更新的时间会被滑动的 div 覆盖。

为了更好地说明问题，我把幻灯片放得很慢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-02T18:39:34.130

我认为它试图将调用 UpdateHours(response.d.Hours) 的结果作为回调函数传递，这可以解释为什么这么快就调用它。一种解决方案是创建一个调用 UpdateHours 的匿名函数。

```
$("div", newRow).slideDown(10000, function () { UpdateHours(response.d.Hours) }); 
```

在 jQuery 站点上有一个以这种方式调用 slideDown 的演示。[http://docs.jquery.com/Effects/slideDown](http://docs.jquery.com/Effects/slideDown)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-02T18:40:24.080

我想你想要这个：

`$("div", newRow).slideDown(10000, function() { UpdateHours(response.d.Hours); });`

这将创建一个匿名函数，该函数将作为回调调用 - 您正在做的是将回调设置为`UpdateHours`

# java - 以编程方式计算值类型的大小

> ID：334951
> 
> 赞同：2
> 
> 时间：2008-12-02T18:28:42.780
> 
> 标签：java, unit-testing, sizeof, bitmask, memory-size

我正在为将布尔值打包成一个字节的方法编写单元测试。不同的位位置由枚举的值决定，目前只有 5 个值，但可以想象（尽管极不可能）这个数字可以达到 9。

我想要一个简单的测试：

私有字节 m_myNum；枚举 MyEnum {...}

断言(sizeof(m_myNum) <= MyEnum.values().length);

我的印象是 Java 中没有 sizeof 函数。最优雅的解决方法是什么？

- -编辑

我不认为我很清楚。我不关心正常的运行时间。我的问题是我现在可以使用存储所有信息的字节编写此代码，但是随着 Enum 在代码的不相关部分中增长，我可能会达到我的位掩码代码中断的地步。我不想在已部署的应用程序中使用它，而是希望有一个单元测试在枚举中的状态数超过存储变量中的位数时失败，因此当程序员添加第九个枚举时，他们可以调整变量的类型为多于八位的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-02T19:14:19.770

我认为这个测试可以满足您的要求。获得比这更通用的内容可能是在浪费您的时间。

```
public void testEnumSizeLessThanOneByte() throws Exception 
{ 
    assertTrue("MyEnum must have 8 or less values.", 
                MyEnum.values().length <= 8);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T21:37:25.723

如果这是一个真正的问题并且性能不是那么重要，你总是可以使用[bitset](http://java.sun.com/j2se/1.4.2/docs/api/java/util/BitSet.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T18:42:46.650

在 Java 中，字节具有固定大小（8 位），因此不需要 sizeof。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T18:43:07.960

首先，是的，Java 中没有 sizeof 运算符。但是 sizeof(byte) 无论如何总是1。这真的是你想说的吗？

其次，您打算如何将 9 个布尔值放入一个字节中？我希望不要使用位掩码。

如果您只想找到设置的最高位，您可以使用（请参阅[此处](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html#highestOneBit(int))`Integer.highestOneBit(m_myNum & 0xFF)`的文档）。

* * *

编辑：当枚举中有太多值时，您谈到将存储更改为更大的类型。根据[这个问题](https://stackoverflow.com/questions/229886/size-of-a-byte-in-memory-java)，除非你有一个数组，否则没有理由不使用 a`byte`而不是a 。`int`所以我会说`int`至少使用 a，`long`如果大小超过 32，则升级到 a。够简单吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T18:50:36.277

我发现[这个问题](https://stackoverflow.com/questions/52353/in-java-what-is-the-best-way-to-determine-the-size-of-an-object)可以帮助你:-)

不幸的是，Java 中没有 sizeof()，但是看看这个问题的答案。我发现有趣的是[这篇](http://www.javaworld.com/javaworld/javaqa/2003-12/02-qa-1226-sizeof.html)来自 JavaWorld 的文章。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-02T19:19:30.837

我知道您正在尝试提出一个通用的解决方案，但是在这种情况下，我会采取懒惰的方式并硬编码大小并添加一些注释。

```
静态最终 int MAX_BITS_IN_MY_NUM = 8；// 当前设置为字节大小。  
                                         // 如果数据类型从字节更改为大于字节的类型，则更新。
...
assertTrue(MAX_BITS_IN_MY_NUM >= MyEnum.values().length);

```

# c++ - 如何在 QTreeWidget 中找到所选项目？

> ID：334952
> 
> 赞同：7
> 
> 时间：2008-12-02T18:29:10.453
> 
> 标签：c++, qt, events, kde, treewidget

我有一个继承 QTreeWidget 的类。如何找到当前选定的行？通常我以这种方式将信号连接到插槽：

```
connect(myButton, SIGNAL(triggered(bool)), this, SLOT(myClick())); 
```

但是，我找不到类似的东西`QTreeWidget->QTreeWidgetItem`。我发现的唯一方法是重新定义 QTreeWidget 类的 mousePressEvent ，如下所示：

```
void MyQTreeWidget::mousePressEvent(QMouseEvent *e){
    QTreeView::mousePressEvent(e);
    const QModelIndex index = indexAt(e->pos());
    if (!index.isValid())
    {
    const Qt::KeyboardModifiers modifiers = QApplication::keyboardModifiers();
    if (!(modifiers & Qt::ShiftModifier) && !(modifiers & Qt::ControlModifier))
    clearSelection();
    }
 } 
```

我还没试过。是唯一的解决方案还是有更简单的方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-02T19:44:46.293

尘土飞扬的几乎是正确的。但是 itemSelectionChanged 信号不会告诉您选择了哪个项目。

```
QList<QTreeWidgetItem *> QTreeWidget::selectedItems() const 
```

将为您提供所选项目。

因此，将插槽连接到 itemSelectionChanged 信号，然后在树小部件上调用 selectedItems() 以获取所选项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-05T15:55:22.103

使用 itemClicked() 信号将错过使用键盘所做的任何选择更改。我假设在你的情况下这是一件坏事。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-06T14:57:28.427

你可以简单地使用这个：

```
QString word = treeWidget->currentItem()->text(treeWidget->currentColumn()); 
```

在变量词中获取您的文本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T19:37:43.123

根据[此处](http://doc.trolltech.com/4.4/qtreewidget.html)的文档，您似乎应该将*QTreeWidget* *[itemSelectionChanged()](http://doc.trolltech.com/4.4/qtreewidget.html#itemSelectionChanged)*信号连接到类中的插槽。这将告诉您选择了哪个*QTreeWidgetItem*，这是我认为您想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T19:56:40.637

哎呀，我已经解决了简单地使用这个：

```
connect(this,SIGNAL(itemClicked(QTreeWidgetItem*, int)), SLOT(mySlot())); 
```

但是感谢您的回复：D

# visio - 为什么我的 Visio 文件的大小会增加？

> ID：334976
> 
> 赞同：2
> 
> 时间：2008-12-02T18:38:16.193
> 
> 标签：visio

这是给同事的：

> 我们的其中一个线框集（Visio 文件）有问题。基本上，该文件的大小继续增加，目前为 43 MB（是的，四十三个！），而我们其他集合的平均大小约为 5-10 MB。当我将副本保存到桌面并删除所有页面时，它基本上是一个空白文件，大小仍为 2 MB。此文件导致问题：
> 
> 1.  保存需要 3-4 分钟
> 2.  [另一个同事] 试图保存，它基本上决定删除她所有的更新
> 3.  我们非常担心文件会损坏到我们需要从头开始重新创建它的地步（一种非常昂贵的可能性）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T18:56:08.293

我怀疑您可能已经从绘图页中删除了一些未使用的形状，但仍在模具中。[这篇 MS 支持文章](http://support.microsoft.com/kb/305025)提供了一些有关解决此问题和其他 Visio 大小问题的提示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-03T16:46:55.543

他们找到了答案……

> 碰巧 Visio 正在将我们的图标转换为更大的文件，并且每次我们复制/粘贴它时，它都会增加很多大小（即使图标是 idddddy biddddy）。[另一位同事] 正在重新格式化图像，以便我们可以将其用作模板。如果没有所有页面上的图像，文件只有 4 MB！

# msbuild - 将 MSBuild 与 RAD Studio 2009 一起使用时出现 MSB4057 错误

> ID：334978
> 
> 赞同：2
> 
> 时间：2008-12-02T18:38:23.570
> 
> 标签：msbuild, c++builder, auto-build, c++builder-2009

摘要：我能够使用 RAD Studio 命令提示符在构建服务器上使用 MSBuild 编译 RAD Studio 2009 项目，但不能使用批处理文件。但是，这个相同的批处理文件在我的工作站上可以成功运行。在服务器上返回的错误是：MSB4057。

我只是在学习如何将 MSBuild 与 RAD Studio 一起使用，并试图让 MSBuild 的东西与它一起工作。我已经生成了一个批处理程序，它将适当地设置环境变量，然后为我编译项目。这在我的工作站上运行良好。

但是，当我将所有内容移至构建服务器时，它不起作用。

我想我已经接近为什么会发生这种情况的答案了。我可以通过在服务器上键入以下命令从 RAD Studio 命令提示符编译我的项目：

```
msbuild C:\MyProject\Group\Project.groupproj 
```

这是我试图运行的命令文件：

```
@SET BDS=C:\RS\
@SET BDSCOMMONDIR=C:\Users\Public\Documents\RAD Studio\6.0
@SET FrameworkDir=C:\Windows\Microsoft.NET\Framework\
@SET FrameworkVersion=v2.0.50727
@SET FrameworkSDKDir=
@SET PATH=%FrameworkDir%%FrameworkVersion%;%FrameworkSDKDir%;%PATH%

msbuild C:\MyProject\Group\Project.groupproj /t:Clean;Build /p:"Config=Release" 
```

这是命令提示符的输出：

```
C:\>msbuild C:\MyProject\Group\Project.groupproj /t:Clean;Build /p:"Config
=Release"
Microsoft (R) Build Engine Version 2.0.50727.1434
[Microsoft .NET Framework, Version 2.0.50727.1434]
Copyright (C) Microsoft Corporation 2005\. All rights reserved.

Build started 12/2/2008 12:24:26 PM.
__________________________________________________
Project "C:\MyProject\Group\Project.groupproj" (Clean;Build target(s)):

Target Clean:
    Target Project1:Clean:
        __________________________________________________
        Project "C:\MyProject\Group\Project.groupproj" is building "C:\MyProject\Project1\Project1.cbproj" (Clean target(s)):

        C:\MyProject\Project1\Project1.cbproj : error MSB4057: The target "Clean" does not exist in the project.

        Done building project "Project1.cbproj" -- FAILED.

Build FAILED.
C:\MyProject\Project1\Project1.cbproj : error MSB4057: The target "Clean" does not
 exist in the project.
    0 Warning(s)
    1 Error(s)

Time Elapsed 00:00:00.01 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T19:19:38.683

我想到了。在跟踪谷歌搜索结果页面试图找出一种方法让我的自动构建服务器处理这个之后，我查看了批处理程序中的路径，发现它与安装路径不同。

```
@SET BDS=C:\RS\ 
```

本来应该

```
@SET BDS=C:\RS\6.0\ 
```

经验教训：MSBUILD 在无法***解析 BDS 路径时会返回 MSB4057 错误。***

旁注：如果这个简单的修复对您不起作用，请确保您的项目文件中有正确的跟踪说明。[在 msdn 上看到这篇文章](http://social.msdn.microsoft.com/forums/en-US/tfsbuild/thread/969f34e9-3c48-4262-a369-81f9b88ce3cd/)

# c# - 在不使用 odbc 的情况下使用 c# 和 mysql 的最佳方法是什么

> ID：334981
> 
> 赞同：1
> 
> 时间：2008-12-02T18:39:32.103
> 
> 标签：c#, mysql

我需要从 c# 代码访问 mysql 数据库，但出于以下原因，我不希望使用 ODBC。

我必须创建一个演示，并且我在 USB 驱动器上使用 xampp。我的代码（数据库读/写代码）是用 C# 编写的。因此，为了使 USB 驱动器与运行演示的计算机隔离，由于设置原因，我将远离 ODBC。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-02T18:41:39.353

[http://dev.mysql.com/downloads/connector/net/5.2.html](http://dev.mysql.com/downloads/connector/net/5.2.html)

上次我尝试它工作正常，但如果您需要连接到，例如，MySQL 和 SQL Server，您需要使用 SqlConnection 复制代码一次，另一个使用 MysqlConnection。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-02T18:43:12.843

您可能想要使用[MySQL .Net 连接器](http://dev.mysql.com/downloads/connector/net/5.2.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-02T19:15:12.623

在[Object Relational Mappers](http://en.wikipedia.org/wiki/Object-relational_mapping)的脉络中，您可以使用[NHibernate](http://www.hibernate.org/343.html)和[MyGeneration Code Generator](http://www.mygenerationsoftware.com/)来生成您需要拥有数据访问层的映射和类。有[无数](http://www.google.com/search?hl=en&q=Nhibernate+mySql&btnG=Google+Search&aq=f&oq=)[可用](http://geekswithblogs.net/pariam/archive/2006/07/26/86352.aspx)的示例。

FWIW，除非您有速度绝对关键的特定部分，否则像 NHibernate 这样的 ORM 会为您处理[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete)内容，您所需要担心的只是优化您真正需要速度的部分。

这有助于您解决问题，因为您可以轻松创建 DAL（MyGeneration 可以查看您的数据库并生成您需要的所有内容），并且您可以担心应用程序的业务逻辑。它解决了您的问题，甚至无需担心是否正在使用 ODBC。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-02T18:56:55.670

根据您的需要，您还可以查看像[SubSonic](http://subsonicproject.com/)这样的 ORM 。它可与 MySQL 一起使用，并为您提供数据库独立性和易于开发。

# websphere - 有没有可以生成友好 URL 的 Portal 产品？

> ID：334987
> 
> 赞同：4
> 
> 时间：2008-12-02T18:40:37.700
> 
> 标签：websphere, friendly-url, portal

目前，我们正在使用 WebSphere Portal v5.1，并且 URL 与 URL 一样不友好。例如：

[http://www.foo.com/wsps/portal/!ml/QjzQ0IhyR0UAkc39Aw!!/delta/base64xml/L3dJ82XzBfQ1A](http://www.foo.com/wsps/portal/!ml/QjzQ0IhyR0UAkc39Aw!!/delta/base64xml/L3dJ82XzBfQ1A)！

我已经删除了一堆字符，但你明白了。我们的挫败感之一是 URL 通常以标点符号结尾。门户的用户尝试从地址栏剪切/粘贴到电子邮件或 word 文档中，并且结尾的感叹号不会成为生成的超链接的一部分（Microsoft 产品的一项功能，Outlook、Word、Powerpoint 等会发生这种情况）。

至于解决方案，我们被告知 WPS 的 URL 映射功能不能很好地扩展，我认为随着最近的版本变化不大。

所以，回到问题。是否有其他门户产品可以更好地管理 URL？还是这仅仅是传送兽的本性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-03T12:12:32.587

WebSphere Portal 在其 URL 中保持导航状态。剪切此网址将破坏该信息。从 Portal 6.1 开始，有一种方法可以为页面定义一个“友好名称”=url，这样就可以将它们发送出去，而不会冒着被复制和粘贴操作破坏它们的风险。WebSphere 门户当然支持 JSR286 portlet，因为我相信版本 6.0。不幸的是，我没有其他门户实现的经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T12:27:40.363

Liferay Portal 可以为每个门户页面生成FriendlyURLs，管理员可以在站点内进行书签和轻松定义。未指定的 URL 也没有那么糟糕，没有特殊字符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T19:07:08.973

您的门户要求是什么？

我猜它需要面向 Java，我猜当您说门户网站时，您的意思是 JSR-168？还是 JSR-286？（WPS 5.1 是 168 + IBM 混乱，286 是较新的，我认为是 Java5+）。

还值得一提的是，如果您已经在 WAS 5.1 中构建了一整套 portlet，您可能需要与您的开发人员核实以确保您没有使用 IBM 特定的扩展。如果是，那么您需要将它们重构出来，否则您无法将它们放入另一个 Portal 实现中。

# python - 如何在 Django 模型中创建简单的自定义字段类型？

> ID：334992
> 
> 赞同：3
> 
> 时间：2008-12-02T18:41:44.423
> 
> 标签：python, django, django-models

我正在尝试在 Django 中创建一些映射到标准 Django 类型的类型。自[定义模型字段文档](http://docs.djangoproject.com/en/dev/howto/custom-model-fields/#howto-custom-model-fields)进入复杂案例；我只想用一堆方便的方法从一个类中存储一个基本的 Django 类型。

例如，如果我要存储扑克牌，我想要这样的东西：

```
class Card(object):
    """ A playing card.  """
    def as_number(self):
        """ returns a number from 1 (Ace of Clubs) and 52 (King of Spades)."""
        return self.number + self.suit_rank() * 13
    def __unicode(self): ...
    def is_highest(self, other_cards, trump=None):...
    def __init__(self, number, suit):  ...
     ... 
```

我希望我的模型具有以下内容：

```
class my_game(models.Model):
    ante = models.IntegerField()
    bonus_card = Card()   # Really stored as an models.IntegerField()
    .... 
```

我期待答案看起来像从正确的类型继承，为卡添加一些特别命名的 get/store 字段，并重命名**init** ()。有没有人有示例代码或更好的文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T20:27:56.563

我会用 Django 的 PositiveIntegerField 的子类来做到这一点：

```
from django.db import models

class Card(object):
    """The ``Card`` class you described."""
    ...

class CardField(models.PositiveIntegerField):
    __metaclass__ = models.SubfieldBase

    def get_db_prep_value(self, value):
        """Return the ``int`` equivalent of ``value``."""
        if value is None: return None
        try:
            int_value = value.as_number()
        except AttributeError:
            int_value = int(value)
        return int_value

    def to_python(self, value):
        """Return the ``Card`` equivalent of ``value``."""
        if value is None or isinstance(value, Card):
            return value
        return Card(int(value)) 
```

该`get_db_prep_value`方法负责转换`value`为适合与数据库交互的东西，在本例中为 an`int`或`None`.

该`to_python`方法执行相反的操作，转换`value`为`Card`. 就像以前一样，您需要处理`None`作为值的可能性。使用`SubfieldBase`确保`to_python`每次将值分配给字段时都会调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T19:55:40.733

为什么您不能执行以下操作？

```
class Card(models.Model):
    """ A playing card.  """
    self.suit = models.PositiveIntegerField()
    self.rank = models.PositiveIntegerField( choices=SUIT_CHOICES )
    def as_number(self):
        """ returns a number from 1 (Ace of Clubs) and 52 (King of Spades)."""
        return self.number + self.suit * 13
    def __unicode__(self):
        return ...
    def is_highest(self, other_cards, trump=None):... 
```

当然，这很简单，并且很适合 Django 自然地做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-02T20:14:58.960

不要害怕根据自己的需要调整 Django 中的模型类。他们没有什么神奇之处。我想这是这段代码的正确位置：在模型中。

# active-directory - 查找有权访问此共享 Exchange 服务器邮箱的人员

> ID：334998
> 
> 赞同：0
> 
> 时间：2008-12-02T18:42:44.013
> 
> 标签：active-directory, exchange-server

如何找到所有有权访问共享邮箱的用户？

我们在我们的应用程序中使用了一个共享邮箱，这会很有用。

一个简单的解决方案会更有用。

在 C# 中执行此操作的代码也可以。

microsoft 的工具也将很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T00:33:37.770

好吧，您并没有说“有权访问”是什么意思，所以：

```
$mailbox = "foo@example.com"
Get-Mailbox $mailbox | Get-AdPermission 
```**********************